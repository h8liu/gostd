<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3888404">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3888459">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3888513">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3888564">package</span>&nbsp;<span class="ident" id="3888572">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3888577">import</span>&nbsp;<span class="string" id="3888584">&#34;bytes&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3888593">type</span>&nbsp;<span class="ident" id="3888598">clientHelloMsg</span>&nbsp;<span class="keyword" id="3888613">struct</span>&nbsp;<span class="op" id="3888620">{</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3888623">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3888643">[</span><span class="op" id="3888644">]</span><span class="builtintype" id="3888645">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3888651">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3888671">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3888679">random</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3888699">[</span><span class="op" id="3888700">]</span><span class="builtintype" id="3888701">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3888707">sessionId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3888727">[</span><span class="op" id="3888728">]</span><span class="builtintype" id="3888729">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3888735">cipherSuites</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3888755">[</span><span class="op" id="3888756">]</span><span class="builtintype" id="3888757">uint16</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3888765">compressionMethods</span>&nbsp;&nbsp;<span class="op" id="3888785">[</span><span class="op" id="3888786">]</span><span class="builtintype" id="3888787">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3888794">nextProtoNeg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3888814">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3888820">serverName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3888840">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3888848">ocspStapling</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3888868">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3888874">supportedCurves</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3888894">[</span><span class="op" id="3888895">]</span><span class="ident" id="3888896"><a href="/crypto/tls/common.go.html#3824673">CurveID</a></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3888905">supportedPoints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3888925">[</span><span class="op" id="3888926">]</span><span class="builtintype" id="3888927">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3888934">ticketSupported</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3888954">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3888960">sessionTicket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3888980">[</span><span class="op" id="3888981">]</span><span class="builtintype" id="3888982">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3888989">signatureAndHashes</span>&nbsp;&nbsp;<span class="op" id="3889009">[</span><span class="op" id="3889010">]</span><span class="ident" id="3889011"><a href="/crypto/tls/common.go.html#3826090">signatureAndHash</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889029">secureRenegotiation</span>&nbsp;<span class="builtintype" id="3889049">bool</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889055">alpnProtocols</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3889075">[</span><span class="op" id="3889076">]</span><span class="builtintype" id="3889077">string</span><br>
<span class="lineno"></span><span class="op" id="3889084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3889087">func</span>&nbsp;<span class="op" id="3889092">(</span><span class="ident" id="3889093">m</span>&nbsp;<span class="op" id="3889095">*</span><span class="ident" id="3889096"><a href="/crypto/tls/handshake_messages.go.html#3888598">clientHelloMsg</a></span><span class="op" id="3889110">)</span>&nbsp;<span class="ident" id="3889112">equal</span><span class="op" id="3889117">(</span><span class="ident" id="3889118">i</span>&nbsp;<span class="keyword" id="3889120">interface</span><span class="op" id="3889129">{</span><span class="op" id="3889130">}</span><span class="op" id="3889131">)</span>&nbsp;<span class="builtintype" id="3889133">bool</span>&nbsp;<span class="op" id="3889138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889141">m1</span><span class="op" id="3889143">,</span>&nbsp;<span class="ident" id="3889145">ok</span>&nbsp;<span class="op" id="3889148">:=</span>&nbsp;<span class="ident" id="3889151"><a href="/crypto/tls/handshake_messages.go.html#3889118">i</a></span><span class="op" id="3889152">.</span><span class="op" id="3889153">(</span><span class="op" id="3889154">*</span><span class="ident" id="3889155"><a href="/crypto/tls/handshake_messages.go.html#3888598">clientHelloMsg</a></span><span class="op" id="3889169">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3889172">if</span>&nbsp;<span class="op" id="3889175">!</span><span class="ident" id="3889176"><a href="/crypto/tls/handshake_messages.go.html#3889145">ok</a></span>&nbsp;<span class="op" id="3889179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3889183">return</span>&nbsp;<span class="builtintype" id="3889190">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3889197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3889201">return</span>&nbsp;<span class="ident" id="3889208"><a href="/crypto/tls/handshake_messages.go.html#3888584">bytes</a></span><span class="op" id="3889213">.</span><span class="ident" id="3889214">Equal</span><span class="op" id="3889219">(</span><span class="ident" id="3889220"><a href="/crypto/tls/handshake_messages.go.html#3889093">m</a></span><span class="op" id="3889221">.</span><span class="ident" id="3889222">raw</span><span class="op" id="3889225">,</span>&nbsp;<span class="ident" id="3889227"><a href="/crypto/tls/handshake_messages.go.html#3889141">m1</a></span><span class="op" id="3889229">.</span><span class="ident" id="3889230">raw</span><span class="op" id="3889233">)</span>&nbsp;<span class="op" id="3889235">&amp;&amp;</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889240"><a href="/crypto/tls/handshake_messages.go.html#3889093">m</a></span><span class="op" id="3889241">.</span><span class="ident" id="3889242">vers</span>&nbsp;<span class="op" id="3889247">==</span>&nbsp;<span class="ident" id="3889250"><a href="/crypto/tls/handshake_messages.go.html#3889141">m1</a></span><span class="op" id="3889252">.</span><span class="ident" id="3889253">vers</span>&nbsp;<span class="op" id="3889258">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889263"><a href="/crypto/tls/handshake_messages.go.html#3888584">bytes</a></span><span class="op" id="3889268">.</span><span class="ident" id="3889269">Equal</span><span class="op" id="3889274">(</span><span class="ident" id="3889275"><a href="/crypto/tls/handshake_messages.go.html#3889093">m</a></span><span class="op" id="3889276">.</span><span class="ident" id="3889277">random</span><span class="op" id="3889283">,</span>&nbsp;<span class="ident" id="3889285"><a href="/crypto/tls/handshake_messages.go.html#3889141">m1</a></span><span class="op" id="3889287">.</span><span class="ident" id="3889288">random</span><span class="op" id="3889294">)</span>&nbsp;<span class="op" id="3889296">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889301"><a href="/crypto/tls/handshake_messages.go.html#3888584">bytes</a></span><span class="op" id="3889306">.</span><span class="ident" id="3889307">Equal</span><span class="op" id="3889312">(</span><span class="ident" id="3889313"><a href="/crypto/tls/handshake_messages.go.html#3889093">m</a></span><span class="op" id="3889314">.</span><span class="ident" id="3889315">sessionId</span><span class="op" id="3889324">,</span>&nbsp;<span class="ident" id="3889326"><a href="/crypto/tls/handshake_messages.go.html#3889141">m1</a></span><span class="op" id="3889328">.</span><span class="ident" id="3889329">sessionId</span><span class="op" id="3889338">)</span>&nbsp;<span class="op" id="3889340">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889345"><a href="/crypto/tls/handshake_messages.go.html#3917870">eqUint16s</a></span><span class="op" id="3889354">(</span><span class="ident" id="3889355"><a href="/crypto/tls/handshake_messages.go.html#3889093">m</a></span><span class="op" id="3889356">.</span><span class="ident" id="3889357">cipherSuites</span><span class="op" id="3889369">,</span>&nbsp;<span class="ident" id="3889371"><a href="/crypto/tls/handshake_messages.go.html#3889141">m1</a></span><span class="op" id="3889373">.</span><span class="ident" id="3889374">cipherSuites</span><span class="op" id="3889386">)</span>&nbsp;<span class="op" id="3889388">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889393"><a href="/crypto/tls/handshake_messages.go.html#3888584">bytes</a></span><span class="op" id="3889398">.</span><span class="ident" id="3889399">Equal</span><span class="op" id="3889404">(</span><span class="ident" id="3889405"><a href="/crypto/tls/handshake_messages.go.html#3889093">m</a></span><span class="op" id="3889406">.</span><span class="ident" id="3889407">compressionMethods</span><span class="op" id="3889425">,</span>&nbsp;<span class="ident" id="3889427"><a href="/crypto/tls/handshake_messages.go.html#3889141">m1</a></span><span class="op" id="3889429">.</span><span class="ident" id="3889430">compressionMethods</span><span class="op" id="3889448">)</span>&nbsp;<span class="op" id="3889450">&amp;&amp;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889455"><a href="/crypto/tls/handshake_messages.go.html#3889093">m</a></span><span class="op" id="3889456">.</span><span class="ident" id="3889457">nextProtoNeg</span>&nbsp;<span class="op" id="3889470">==</span>&nbsp;<span class="ident" id="3889473"><a href="/crypto/tls/handshake_messages.go.html#3889141">m1</a></span><span class="op" id="3889475">.</span><span class="ident" id="3889476">nextProtoNeg</span>&nbsp;<span class="op" id="3889489">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889494"><a href="/crypto/tls/handshake_messages.go.html#3889093">m</a></span><span class="op" id="3889495">.</span><span class="ident" id="3889496">serverName</span>&nbsp;<span class="op" id="3889507">==</span>&nbsp;<span class="ident" id="3889510"><a href="/crypto/tls/handshake_messages.go.html#3889141">m1</a></span><span class="op" id="3889512">.</span><span class="ident" id="3889513">serverName</span>&nbsp;<span class="op" id="3889524">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889529"><a href="/crypto/tls/handshake_messages.go.html#3889093">m</a></span><span class="op" id="3889530">.</span><span class="ident" id="3889531">ocspStapling</span>&nbsp;<span class="op" id="3889544">==</span>&nbsp;<span class="ident" id="3889547"><a href="/crypto/tls/handshake_messages.go.html#3889141">m1</a></span><span class="op" id="3889549">.</span><span class="ident" id="3889550">ocspStapling</span>&nbsp;<span class="op" id="3889563">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889568"><a href="/crypto/tls/handshake_messages.go.html#3918027">eqCurveIDs</a></span><span class="op" id="3889578">(</span><span class="ident" id="3889579"><a href="/crypto/tls/handshake_messages.go.html#3889093">m</a></span><span class="op" id="3889580">.</span><span class="ident" id="3889581">supportedCurves</span><span class="op" id="3889596">,</span>&nbsp;<span class="ident" id="3889598"><a href="/crypto/tls/handshake_messages.go.html#3889141">m1</a></span><span class="op" id="3889600">.</span><span class="ident" id="3889601">supportedCurves</span><span class="op" id="3889616">)</span>&nbsp;<span class="op" id="3889618">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889623"><a href="/crypto/tls/handshake_messages.go.html#3888584">bytes</a></span><span class="op" id="3889628">.</span><span class="ident" id="3889629">Equal</span><span class="op" id="3889634">(</span><span class="ident" id="3889635"><a href="/crypto/tls/handshake_messages.go.html#3889093">m</a></span><span class="op" id="3889636">.</span><span class="ident" id="3889637">supportedPoints</span><span class="op" id="3889652">,</span>&nbsp;<span class="ident" id="3889654"><a href="/crypto/tls/handshake_messages.go.html#3889141">m1</a></span><span class="op" id="3889656">.</span><span class="ident" id="3889657">supportedPoints</span><span class="op" id="3889672">)</span>&nbsp;<span class="op" id="3889674">&amp;&amp;</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889679"><a href="/crypto/tls/handshake_messages.go.html#3889093">m</a></span><span class="op" id="3889680">.</span><span class="ident" id="3889681">ticketSupported</span>&nbsp;<span class="op" id="3889697">==</span>&nbsp;<span class="ident" id="3889700"><a href="/crypto/tls/handshake_messages.go.html#3889141">m1</a></span><span class="op" id="3889702">.</span><span class="ident" id="3889703">ticketSupported</span>&nbsp;<span class="op" id="3889719">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889724"><a href="/crypto/tls/handshake_messages.go.html#3888584">bytes</a></span><span class="op" id="3889729">.</span><span class="ident" id="3889730">Equal</span><span class="op" id="3889735">(</span><span class="ident" id="3889736"><a href="/crypto/tls/handshake_messages.go.html#3889093">m</a></span><span class="op" id="3889737">.</span><span class="ident" id="3889738">sessionTicket</span><span class="op" id="3889751">,</span>&nbsp;<span class="ident" id="3889753"><a href="/crypto/tls/handshake_messages.go.html#3889141">m1</a></span><span class="op" id="3889755">.</span><span class="ident" id="3889756">sessionTicket</span><span class="op" id="3889769">)</span>&nbsp;<span class="op" id="3889771">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889776"><a href="/crypto/tls/handshake_messages.go.html#3918515">eqSignatureAndHashes</a></span><span class="op" id="3889796">(</span><span class="ident" id="3889797"><a href="/crypto/tls/handshake_messages.go.html#3889093">m</a></span><span class="op" id="3889798">.</span><span class="ident" id="3889799">signatureAndHashes</span><span class="op" id="3889817">,</span>&nbsp;<span class="ident" id="3889819"><a href="/crypto/tls/handshake_messages.go.html#3889141">m1</a></span><span class="op" id="3889821">.</span><span class="ident" id="3889822">signatureAndHashes</span><span class="op" id="3889840">)</span>&nbsp;<span class="op" id="3889842">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889847"><a href="/crypto/tls/handshake_messages.go.html#3889093">m</a></span><span class="op" id="3889848">.</span><span class="ident" id="3889849">secureRenegotiation</span>&nbsp;<span class="op" id="3889869">==</span>&nbsp;<span class="ident" id="3889872"><a href="/crypto/tls/handshake_messages.go.html#3889141">m1</a></span><span class="op" id="3889874">.</span><span class="ident" id="3889875">secureRenegotiation</span>&nbsp;<span class="op" id="3889895">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3889900"><a href="/crypto/tls/handshake_messages.go.html#3918186">eqStrings</a></span><span class="op" id="3889909">(</span><span class="ident" id="3889910"><a href="/crypto/tls/handshake_messages.go.html#3889093">m</a></span><span class="op" id="3889911">.</span><span class="ident" id="3889912">alpnProtocols</span><span class="op" id="3889925">,</span>&nbsp;<span class="ident" id="3889927"><a href="/crypto/tls/handshake_messages.go.html#3889141">m1</a></span><span class="op" id="3889929">.</span><span class="ident" id="3889930">alpnProtocols</span><span class="op" id="3889943">)</span><br>
<span class="lineno">50</span><span class="op" id="3889945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3889948">func</span>&nbsp;<span class="op" id="3889953">(</span><span class="ident" id="3889954">m</span>&nbsp;<span class="op" id="3889956">*</span><span class="ident" id="3889957"><a href="/crypto/tls/handshake_messages.go.html#3888598">clientHelloMsg</a></span><span class="op" id="3889971">)</span>&nbsp;<span class="ident" id="3889973">marshal</span><span class="op" id="3889980">(</span><span class="op" id="3889981">)</span>&nbsp;<span class="op" id="3889983">[</span><span class="op" id="3889984">]</span><span class="builtintype" id="3889985">byte</span>&nbsp;<span class="op" id="3889990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3889993">if</span>&nbsp;<span class="ident" id="3889996"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3889997">.</span><span class="ident" id="3889998">raw</span>&nbsp;<span class="op" id="3890002">!=</span>&nbsp;<span class="ident" id="3890005">nil</span>&nbsp;<span class="op" id="3890009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890013">return</span>&nbsp;<span class="ident" id="3890020"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3890021">.</span><span class="ident" id="3890022">raw</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3890027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3890031">length</span>&nbsp;<span class="op" id="3890038">:=</span>&nbsp;<span class="num" id="3890041">2</span>&nbsp;<span class="op" id="3890043">+</span>&nbsp;<span class="num" id="3890045">32</span>&nbsp;<span class="op" id="3890048">+</span>&nbsp;<span class="num" id="3890050">1</span>&nbsp;<span class="op" id="3890052">+</span>&nbsp;<span class="builtinfunc" id="3890054">len</span><span class="op" id="3890057">(</span><span class="ident" id="3890058"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3890059">.</span><span class="ident" id="3890060">sessionId</span><span class="op" id="3890069">)</span>&nbsp;<span class="op" id="3890071">+</span>&nbsp;<span class="num" id="3890073">2</span>&nbsp;<span class="op" id="3890075">+</span>&nbsp;<span class="builtinfunc" id="3890077">len</span><span class="op" id="3890080">(</span><span class="ident" id="3890081"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3890082">.</span><span class="ident" id="3890083">cipherSuites</span><span class="op" id="3890095">)</span><span class="op" id="3890096">*</span><span class="num" id="3890097">2</span>&nbsp;<span class="op" id="3890099">+</span>&nbsp;<span class="num" id="3890101">1</span>&nbsp;<span class="op" id="3890103">+</span>&nbsp;<span class="builtinfunc" id="3890105">len</span><span class="op" id="3890108">(</span><span class="ident" id="3890109"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3890110">.</span><span class="ident" id="3890111">compressionMethods</span><span class="op" id="3890129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3890132">numExtensions</span>&nbsp;<span class="op" id="3890146">:=</span>&nbsp;<span class="num" id="3890149">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3890152">extensionsLength</span>&nbsp;<span class="op" id="3890169">:=</span>&nbsp;<span class="num" id="3890172">0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890175">if</span>&nbsp;<span class="ident" id="3890178"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3890179">.</span><span class="ident" id="3890180">nextProtoNeg</span>&nbsp;<span class="op" id="3890193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3890197"><a href="/crypto/tls/handshake_messages.go.html#3890132">numExtensions</a></span><span class="op" id="3890210">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3890214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890217">if</span>&nbsp;<span class="ident" id="3890220"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3890221">.</span><span class="ident" id="3890222">ocspStapling</span>&nbsp;<span class="op" id="3890235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3890239"><a href="/crypto/tls/handshake_messages.go.html#3890152">extensionsLength</a></span>&nbsp;<span class="op" id="3890256">+=</span>&nbsp;<span class="num" id="3890259">1</span>&nbsp;<span class="op" id="3890261">+</span>&nbsp;<span class="num" id="3890263">2</span>&nbsp;<span class="op" id="3890265">+</span>&nbsp;<span class="num" id="3890267">2</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3890271"><a href="/crypto/tls/handshake_messages.go.html#3890132">numExtensions</a></span><span class="op" id="3890284">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3890288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890291">if</span>&nbsp;<span class="builtinfunc" id="3890294">len</span><span class="op" id="3890297">(</span><span class="ident" id="3890298"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3890299">.</span><span class="ident" id="3890300">serverName</span><span class="op" id="3890310">)</span>&nbsp;<span class="op" id="3890312">&gt;</span>&nbsp;<span class="num" id="3890314">0</span>&nbsp;<span class="op" id="3890316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3890320"><a href="/crypto/tls/handshake_messages.go.html#3890152">extensionsLength</a></span>&nbsp;<span class="op" id="3890337">+=</span>&nbsp;<span class="num" id="3890340">5</span>&nbsp;<span class="op" id="3890342">+</span>&nbsp;<span class="builtinfunc" id="3890344">len</span><span class="op" id="3890347">(</span><span class="ident" id="3890348"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3890349">.</span><span class="ident" id="3890350">serverName</span><span class="op" id="3890360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3890364"><a href="/crypto/tls/handshake_messages.go.html#3890132">numExtensions</a></span><span class="op" id="3890377">++</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3890381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890384">if</span>&nbsp;<span class="builtinfunc" id="3890387">len</span><span class="op" id="3890390">(</span><span class="ident" id="3890391"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3890392">.</span><span class="ident" id="3890393">supportedCurves</span><span class="op" id="3890408">)</span>&nbsp;<span class="op" id="3890410">&gt;</span>&nbsp;<span class="num" id="3890412">0</span>&nbsp;<span class="op" id="3890414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3890418"><a href="/crypto/tls/handshake_messages.go.html#3890152">extensionsLength</a></span>&nbsp;<span class="op" id="3890435">+=</span>&nbsp;<span class="num" id="3890438">2</span>&nbsp;<span class="op" id="3890440">+</span>&nbsp;<span class="num" id="3890442">2</span><span class="op" id="3890443">*</span><span class="builtinfunc" id="3890444">len</span><span class="op" id="3890447">(</span><span class="ident" id="3890448"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3890449">.</span><span class="ident" id="3890450">supportedCurves</span><span class="op" id="3890465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3890469"><a href="/crypto/tls/handshake_messages.go.html#3890132">numExtensions</a></span><span class="op" id="3890482">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3890486">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890489">if</span>&nbsp;<span class="builtinfunc" id="3890492">len</span><span class="op" id="3890495">(</span><span class="ident" id="3890496"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3890497">.</span><span class="ident" id="3890498">supportedPoints</span><span class="op" id="3890513">)</span>&nbsp;<span class="op" id="3890515">&gt;</span>&nbsp;<span class="num" id="3890517">0</span>&nbsp;<span class="op" id="3890519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3890523"><a href="/crypto/tls/handshake_messages.go.html#3890152">extensionsLength</a></span>&nbsp;<span class="op" id="3890540">+=</span>&nbsp;<span class="num" id="3890543">1</span>&nbsp;<span class="op" id="3890545">+</span>&nbsp;<span class="builtinfunc" id="3890547">len</span><span class="op" id="3890550">(</span><span class="ident" id="3890551"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3890552">.</span><span class="ident" id="3890553">supportedPoints</span><span class="op" id="3890568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3890572"><a href="/crypto/tls/handshake_messages.go.html#3890132">numExtensions</a></span><span class="op" id="3890585">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3890589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890592">if</span>&nbsp;<span class="ident" id="3890595"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3890596">.</span><span class="ident" id="3890597">ticketSupported</span>&nbsp;<span class="op" id="3890613">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3890617"><a href="/crypto/tls/handshake_messages.go.html#3890152">extensionsLength</a></span>&nbsp;<span class="op" id="3890634">+=</span>&nbsp;<span class="builtinfunc" id="3890637">len</span><span class="op" id="3890640">(</span><span class="ident" id="3890641"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3890642">.</span><span class="ident" id="3890643">sessionTicket</span><span class="op" id="3890656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3890660"><a href="/crypto/tls/handshake_messages.go.html#3890132">numExtensions</a></span><span class="op" id="3890673">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3890677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890680">if</span>&nbsp;<span class="builtinfunc" id="3890683">len</span><span class="op" id="3890686">(</span><span class="ident" id="3890687"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3890688">.</span><span class="ident" id="3890689">signatureAndHashes</span><span class="op" id="3890707">)</span>&nbsp;<span class="op" id="3890709">&gt;</span>&nbsp;<span class="num" id="3890711">0</span>&nbsp;<span class="op" id="3890713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3890717"><a href="/crypto/tls/handshake_messages.go.html#3890152">extensionsLength</a></span>&nbsp;<span class="op" id="3890734">+=</span>&nbsp;<span class="num" id="3890737">2</span>&nbsp;<span class="op" id="3890739">+</span>&nbsp;<span class="num" id="3890741">2</span><span class="op" id="3890742">*</span><span class="builtinfunc" id="3890743">len</span><span class="op" id="3890746">(</span><span class="ident" id="3890747"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3890748">.</span><span class="ident" id="3890749">signatureAndHashes</span><span class="op" id="3890767">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3890771"><a href="/crypto/tls/handshake_messages.go.html#3890132">numExtensions</a></span><span class="op" id="3890784">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3890788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890791">if</span>&nbsp;<span class="ident" id="3890794"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3890795">.</span><span class="ident" id="3890796">secureRenegotiation</span>&nbsp;<span class="op" id="3890816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3890820"><a href="/crypto/tls/handshake_messages.go.html#3890152">extensionsLength</a></span>&nbsp;<span class="op" id="3890837">+=</span>&nbsp;<span class="num" id="3890840">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3890844"><a href="/crypto/tls/handshake_messages.go.html#3890132">numExtensions</a></span><span class="op" id="3890857">++</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3890861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890864">if</span>&nbsp;<span class="builtinfunc" id="3890867">len</span><span class="op" id="3890870">(</span><span class="ident" id="3890871"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3890872">.</span><span class="ident" id="3890873">alpnProtocols</span><span class="op" id="3890886">)</span>&nbsp;<span class="op" id="3890888">&gt;</span>&nbsp;<span class="num" id="3890890">0</span>&nbsp;<span class="op" id="3890892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3890896"><a href="/crypto/tls/handshake_messages.go.html#3890152">extensionsLength</a></span>&nbsp;<span class="op" id="3890913">+=</span>&nbsp;<span class="num" id="3890916">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890920">for</span>&nbsp;<span class="ident" id="3890924">_</span><span class="op" id="3890925">,</span>&nbsp;<span class="ident" id="3890927">s</span>&nbsp;<span class="op" id="3890929">:=</span>&nbsp;<span class="keyword" id="3890932">range</span>&nbsp;<span class="ident" id="3890938"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3890939">.</span><span class="ident" id="3890940">alpnProtocols</span>&nbsp;<span class="op" id="3890954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3890959">if</span>&nbsp;<span class="ident" id="3890962">l</span>&nbsp;<span class="op" id="3890964">:=</span>&nbsp;<span class="builtinfunc" id="3890967">len</span><span class="op" id="3890970">(</span><span class="ident" id="3890971"><a href="/crypto/tls/handshake_messages.go.html#3890927">s</a></span><span class="op" id="3890972">)</span><span class="op" id="3890973">;</span>&nbsp;<span class="ident" id="3890975"><a href="/crypto/tls/handshake_messages.go.html#3890962">l</a></span>&nbsp;<span class="op" id="3890977">==</span>&nbsp;<span class="num" id="3890980">0</span>&nbsp;<span class="op" id="3890982">||</span>&nbsp;<span class="ident" id="3890985"><a href="/crypto/tls/handshake_messages.go.html#3890962">l</a></span>&nbsp;<span class="op" id="3890987">&gt;</span>&nbsp;<span class="num" id="3890989">255</span>&nbsp;<span class="op" id="3890993">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3890999">panic</span><span class="op" id="3891004">(</span><span class="string" id="3891005">&#34;invalid&nbsp;ALPN&nbsp;protocol&#34;</span><span class="op" id="3891028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3891033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3891038"><a href="/crypto/tls/handshake_messages.go.html#3890152">extensionsLength</a></span><span class="op" id="3891054">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3891060"><a href="/crypto/tls/handshake_messages.go.html#3890152">extensionsLength</a></span>&nbsp;<span class="op" id="3891077">+=</span>&nbsp;<span class="builtinfunc" id="3891080">len</span><span class="op" id="3891083">(</span><span class="ident" id="3891084"><a href="/crypto/tls/handshake_messages.go.html#3890927">s</a></span><span class="op" id="3891085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3891089">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3891093"><a href="/crypto/tls/handshake_messages.go.html#3890132">numExtensions</a></span><span class="op" id="3891106">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3891110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3891113">if</span>&nbsp;<span class="ident" id="3891116"><a href="/crypto/tls/handshake_messages.go.html#3890132">numExtensions</a></span>&nbsp;<span class="op" id="3891130">&gt;</span>&nbsp;<span class="num" id="3891132">0</span>&nbsp;<span class="op" id="3891134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3891138"><a href="/crypto/tls/handshake_messages.go.html#3890152">extensionsLength</a></span>&nbsp;<span class="op" id="3891155">+=</span>&nbsp;<span class="num" id="3891158">4</span>&nbsp;<span class="op" id="3891160">*</span>&nbsp;<span class="ident" id="3891162"><a href="/crypto/tls/handshake_messages.go.html#3890132">numExtensions</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3891178"><a href="/crypto/tls/handshake_messages.go.html#3890031">length</a></span>&nbsp;<span class="op" id="3891185">+=</span>&nbsp;<span class="num" id="3891188">2</span>&nbsp;<span class="op" id="3891190">+</span>&nbsp;<span class="ident" id="3891192"><a href="/crypto/tls/handshake_messages.go.html#3890152">extensionsLength</a></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3891210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3891214">x</span>&nbsp;<span class="op" id="3891216">:=</span>&nbsp;<span class="builtinfunc" id="3891219">make</span><span class="op" id="3891223">(</span><span class="op" id="3891224">[</span><span class="op" id="3891225">]</span><span class="builtintype" id="3891226">byte</span><span class="op" id="3891230">,</span>&nbsp;<span class="num" id="3891232">4</span><span class="op" id="3891233">+</span><span class="ident" id="3891234"><a href="/crypto/tls/handshake_messages.go.html#3890031">length</a></span><span class="op" id="3891240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3891243"><a href="/crypto/tls/handshake_messages.go.html#3891214">x</a></span><span class="op" id="3891244">[</span><span class="num" id="3891245">0</span><span class="op" id="3891246">]</span>&nbsp;<span class="op" id="3891248">=</span>&nbsp;<span class="ident" id="3891250"><a href="/crypto/tls/common.go.html#3823485">typeClientHello</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3891267"><a href="/crypto/tls/handshake_messages.go.html#3891214">x</a></span><span class="op" id="3891268">[</span><span class="num" id="3891269">1</span><span class="op" id="3891270">]</span>&nbsp;<span class="op" id="3891272">=</span>&nbsp;<span class="builtintype" id="3891274">uint8</span><span class="op" id="3891279">(</span><span class="ident" id="3891280"><a href="/crypto/tls/handshake_messages.go.html#3890031">length</a></span>&nbsp;<span class="op" id="3891287">&gt;&gt;</span>&nbsp;<span class="num" id="3891290">16</span><span class="op" id="3891292">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3891295"><a href="/crypto/tls/handshake_messages.go.html#3891214">x</a></span><span class="op" id="3891296">[</span><span class="num" id="3891297">2</span><span class="op" id="3891298">]</span>&nbsp;<span class="op" id="3891300">=</span>&nbsp;<span class="builtintype" id="3891302">uint8</span><span class="op" id="3891307">(</span><span class="ident" id="3891308"><a href="/crypto/tls/handshake_messages.go.html#3890031">length</a></span>&nbsp;<span class="op" id="3891315">&gt;&gt;</span>&nbsp;<span class="num" id="3891318">8</span><span class="op" id="3891319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3891322"><a href="/crypto/tls/handshake_messages.go.html#3891214">x</a></span><span class="op" id="3891323">[</span><span class="num" id="3891324">3</span><span class="op" id="3891325">]</span>&nbsp;<span class="op" id="3891327">=</span>&nbsp;<span class="builtintype" id="3891329">uint8</span><span class="op" id="3891334">(</span><span class="ident" id="3891335"><a href="/crypto/tls/handshake_messages.go.html#3890031">length</a></span><span class="op" id="3891341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3891344"><a href="/crypto/tls/handshake_messages.go.html#3891214">x</a></span><span class="op" id="3891345">[</span><span class="num" id="3891346">4</span><span class="op" id="3891347">]</span>&nbsp;<span class="op" id="3891349">=</span>&nbsp;<span class="builtintype" id="3891351">uint8</span><span class="op" id="3891356">(</span><span class="ident" id="3891357"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3891358">.</span><span class="ident" id="3891359">vers</span>&nbsp;<span class="op" id="3891364">&gt;&gt;</span>&nbsp;<span class="num" id="3891367">8</span><span class="op" id="3891368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3891371"><a href="/crypto/tls/handshake_messages.go.html#3891214">x</a></span><span class="op" id="3891372">[</span><span class="num" id="3891373">5</span><span class="op" id="3891374">]</span>&nbsp;<span class="op" id="3891376">=</span>&nbsp;<span class="builtintype" id="3891378">uint8</span><span class="op" id="3891383">(</span><span class="ident" id="3891384"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3891385">.</span><span class="ident" id="3891386">vers</span><span class="op" id="3891390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3891393">copy</span><span class="op" id="3891397">(</span><span class="ident" id="3891398"><a href="/crypto/tls/handshake_messages.go.html#3891214">x</a></span><span class="op" id="3891399">[</span><span class="num" id="3891400">6</span><span class="op" id="3891401">:</span><span class="num" id="3891402">38</span><span class="op" id="3891404">]</span><span class="op" id="3891405">,</span>&nbsp;<span class="ident" id="3891407"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3891408">.</span><span class="ident" id="3891409">random</span><span class="op" id="3891415">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3891418"><a href="/crypto/tls/handshake_messages.go.html#3891214">x</a></span><span class="op" id="3891419">[</span><span class="num" id="3891420">38</span><span class="op" id="3891422">]</span>&nbsp;<span class="op" id="3891424">=</span>&nbsp;<span class="builtintype" id="3891426">uint8</span><span class="op" id="3891431">(</span><span class="builtinfunc" id="3891432">len</span><span class="op" id="3891435">(</span><span class="ident" id="3891436"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3891437">.</span><span class="ident" id="3891438">sessionId</span><span class="op" id="3891447">)</span><span class="op" id="3891448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3891451">copy</span><span class="op" id="3891455">(</span><span class="ident" id="3891456"><a href="/crypto/tls/handshake_messages.go.html#3891214">x</a></span><span class="op" id="3891457">[</span><span class="num" id="3891458">39</span><span class="op" id="3891460">:</span><span class="num" id="3891461">39</span><span class="op" id="3891463">+</span><span class="builtinfunc" id="3891464">len</span><span class="op" id="3891467">(</span><span class="ident" id="3891468"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3891469">.</span><span class="ident" id="3891470">sessionId</span><span class="op" id="3891479">)</span><span class="op" id="3891480">]</span><span class="op" id="3891481">,</span>&nbsp;<span class="ident" id="3891483"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3891484">.</span><span class="ident" id="3891485">sessionId</span><span class="op" id="3891494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3891497">y</span>&nbsp;<span class="op" id="3891499">:=</span>&nbsp;<span class="ident" id="3891502"><a href="/crypto/tls/handshake_messages.go.html#3891214">x</a></span><span class="op" id="3891503">[</span><span class="num" id="3891504">39</span><span class="op" id="3891506">+</span><span class="builtinfunc" id="3891507">len</span><span class="op" id="3891510">(</span><span class="ident" id="3891511"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3891512">.</span><span class="ident" id="3891513">sessionId</span><span class="op" id="3891522">)</span><span class="op" id="3891523">:</span><span class="op" id="3891524">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3891527"><a href="/crypto/tls/handshake_messages.go.html#3891497">y</a></span><span class="op" id="3891528">[</span><span class="num" id="3891529">0</span><span class="op" id="3891530">]</span>&nbsp;<span class="op" id="3891532">=</span>&nbsp;<span class="builtintype" id="3891534">uint8</span><span class="op" id="3891539">(</span><span class="builtinfunc" id="3891540">len</span><span class="op" id="3891543">(</span><span class="ident" id="3891544"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3891545">.</span><span class="ident" id="3891546">cipherSuites</span><span class="op" id="3891558">)</span>&nbsp;<span class="op" id="3891560">&gt;&gt;</span>&nbsp;<span class="num" id="3891563">7</span><span class="op" id="3891564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3891567"><a href="/crypto/tls/handshake_messages.go.html#3891497">y</a></span><span class="op" id="3891568">[</span><span class="num" id="3891569">1</span><span class="op" id="3891570">]</span>&nbsp;<span class="op" id="3891572">=</span>&nbsp;<span class="builtintype" id="3891574">uint8</span><span class="op" id="3891579">(</span><span class="builtinfunc" id="3891580">len</span><span class="op" id="3891583">(</span><span class="ident" id="3891584"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3891585">.</span><span class="ident" id="3891586">cipherSuites</span><span class="op" id="3891598">)</span>&nbsp;<span class="op" id="3891600">&lt;&lt;</span>&nbsp;<span class="num" id="3891603">1</span><span class="op" id="3891604">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3891607">for</span>&nbsp;<span class="ident" id="3891611">i</span><span class="op" id="3891612">,</span>&nbsp;<span class="ident" id="3891614">suite</span>&nbsp;<span class="op" id="3891620">:=</span>&nbsp;<span class="keyword" id="3891623">range</span>&nbsp;<span class="ident" id="3891629"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3891630">.</span><span class="ident" id="3891631">cipherSuites</span>&nbsp;<span class="op" id="3891644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3891648"><a href="/crypto/tls/handshake_messages.go.html#3891497">y</a></span><span class="op" id="3891649">[</span><span class="num" id="3891650">2</span><span class="op" id="3891651">+</span><span class="ident" id="3891652"><a href="/crypto/tls/handshake_messages.go.html#3891611">i</a></span><span class="op" id="3891653">*</span><span class="num" id="3891654">2</span><span class="op" id="3891655">]</span>&nbsp;<span class="op" id="3891657">=</span>&nbsp;<span class="builtintype" id="3891659">uint8</span><span class="op" id="3891664">(</span><span class="ident" id="3891665"><a href="/crypto/tls/handshake_messages.go.html#3891614">suite</a></span>&nbsp;<span class="op" id="3891671">&gt;&gt;</span>&nbsp;<span class="num" id="3891674">8</span><span class="op" id="3891675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3891679"><a href="/crypto/tls/handshake_messages.go.html#3891497">y</a></span><span class="op" id="3891680">[</span><span class="num" id="3891681">3</span><span class="op" id="3891682">+</span><span class="ident" id="3891683"><a href="/crypto/tls/handshake_messages.go.html#3891611">i</a></span><span class="op" id="3891684">*</span><span class="num" id="3891685">2</span><span class="op" id="3891686">]</span>&nbsp;<span class="op" id="3891688">=</span>&nbsp;<span class="builtintype" id="3891690">uint8</span><span class="op" id="3891695">(</span><span class="ident" id="3891696"><a href="/crypto/tls/handshake_messages.go.html#3891614">suite</a></span><span class="op" id="3891701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3891704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3891707">z</span>&nbsp;<span class="op" id="3891709">:=</span>&nbsp;<span class="ident" id="3891712"><a href="/crypto/tls/handshake_messages.go.html#3891497">y</a></span><span class="op" id="3891713">[</span><span class="num" id="3891714">2</span><span class="op" id="3891715">+</span><span class="builtinfunc" id="3891716">len</span><span class="op" id="3891719">(</span><span class="ident" id="3891720"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3891721">.</span><span class="ident" id="3891722">cipherSuites</span><span class="op" id="3891734">)</span><span class="op" id="3891735">*</span><span class="num" id="3891736">2</span><span class="op" id="3891737">:</span><span class="op" id="3891738">]</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3891741"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3891742">[</span><span class="num" id="3891743">0</span><span class="op" id="3891744">]</span>&nbsp;<span class="op" id="3891746">=</span>&nbsp;<span class="builtintype" id="3891748">uint8</span><span class="op" id="3891753">(</span><span class="builtinfunc" id="3891754">len</span><span class="op" id="3891757">(</span><span class="ident" id="3891758"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3891759">.</span><span class="ident" id="3891760">compressionMethods</span><span class="op" id="3891778">)</span><span class="op" id="3891779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3891782">copy</span><span class="op" id="3891786">(</span><span class="ident" id="3891787"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3891788">[</span><span class="num" id="3891789">1</span><span class="op" id="3891790">:</span><span class="op" id="3891791">]</span><span class="op" id="3891792">,</span>&nbsp;<span class="ident" id="3891794"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3891795">.</span><span class="ident" id="3891796">compressionMethods</span><span class="op" id="3891814">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3891818"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span>&nbsp;<span class="op" id="3891820">=</span>&nbsp;<span class="ident" id="3891822"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3891823">[</span><span class="num" id="3891824">1</span><span class="op" id="3891825">+</span><span class="builtinfunc" id="3891826">len</span><span class="op" id="3891829">(</span><span class="ident" id="3891830"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3891831">.</span><span class="ident" id="3891832">compressionMethods</span><span class="op" id="3891850">)</span><span class="op" id="3891851">:</span><span class="op" id="3891852">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3891855">if</span>&nbsp;<span class="ident" id="3891858"><a href="/crypto/tls/handshake_messages.go.html#3890132">numExtensions</a></span>&nbsp;<span class="op" id="3891872">&gt;</span>&nbsp;<span class="num" id="3891874">0</span>&nbsp;<span class="op" id="3891876">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3891880"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3891881">[</span><span class="num" id="3891882">0</span><span class="op" id="3891883">]</span>&nbsp;<span class="op" id="3891885">=</span>&nbsp;<span class="builtintype" id="3891887">byte</span><span class="op" id="3891891">(</span><span class="ident" id="3891892"><a href="/crypto/tls/handshake_messages.go.html#3890152">extensionsLength</a></span>&nbsp;<span class="op" id="3891909">&gt;&gt;</span>&nbsp;<span class="num" id="3891912">8</span><span class="op" id="3891913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3891917"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3891918">[</span><span class="num" id="3891919">1</span><span class="op" id="3891920">]</span>&nbsp;<span class="op" id="3891922">=</span>&nbsp;<span class="builtintype" id="3891924">byte</span><span class="op" id="3891928">(</span><span class="ident" id="3891929"><a href="/crypto/tls/handshake_messages.go.html#3890152">extensionsLength</a></span><span class="op" id="3891945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3891949"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span>&nbsp;<span class="op" id="3891951">=</span>&nbsp;<span class="ident" id="3891953"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3891954">[</span><span class="num" id="3891955">2</span><span class="op" id="3891956">:</span><span class="op" id="3891957">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3891960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3891963">if</span>&nbsp;<span class="ident" id="3891966"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3891967">.</span><span class="ident" id="3891968">nextProtoNeg</span>&nbsp;<span class="op" id="3891981">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3891985"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3891986">[</span><span class="num" id="3891987">0</span><span class="op" id="3891988">]</span>&nbsp;<span class="op" id="3891990">=</span>&nbsp;<span class="builtintype" id="3891992">byte</span><span class="op" id="3891996">(</span><span class="ident" id="3891997"><a href="/crypto/tls/common.go.html#3824315">extensionNextProtoNeg</a></span>&nbsp;<span class="op" id="3892019">&gt;&gt;</span>&nbsp;<span class="num" id="3892022">8</span><span class="op" id="3892023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3892027"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3892028">[</span><span class="num" id="3892029">1</span><span class="op" id="3892030">]</span>&nbsp;<span class="op" id="3892032">=</span>&nbsp;<span class="builtintype" id="3892034">byte</span><span class="op" id="3892038">(</span><span class="ident" id="3892039"><a href="/crypto/tls/common.go.html#3824315">extensionNextProtoNeg</a></span>&nbsp;<span class="op" id="3892061">&amp;</span>&nbsp;<span class="num" id="3892063">0xff</span><span class="op" id="3892067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3892071">//&nbsp;The&nbsp;length&nbsp;is&nbsp;always&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3892099"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span>&nbsp;<span class="op" id="3892101">=</span>&nbsp;<span class="ident" id="3892103"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3892104">[</span><span class="num" id="3892105">4</span><span class="op" id="3892106">:</span><span class="op" id="3892107">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3892110">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3892113">if</span>&nbsp;<span class="builtinfunc" id="3892116">len</span><span class="op" id="3892119">(</span><span class="ident" id="3892120"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3892121">.</span><span class="ident" id="3892122">serverName</span><span class="op" id="3892132">)</span>&nbsp;<span class="op" id="3892134">&gt;</span>&nbsp;<span class="num" id="3892136">0</span>&nbsp;<span class="op" id="3892138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3892142"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3892143">[</span><span class="num" id="3892144">0</span><span class="op" id="3892145">]</span>&nbsp;<span class="op" id="3892147">=</span>&nbsp;<span class="builtintype" id="3892149">byte</span><span class="op" id="3892153">(</span><span class="ident" id="3892154"><a href="/crypto/tls/common.go.html#3824023">extensionServerName</a></span>&nbsp;<span class="op" id="3892174">&gt;&gt;</span>&nbsp;<span class="num" id="3892177">8</span><span class="op" id="3892178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3892182"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3892183">[</span><span class="num" id="3892184">1</span><span class="op" id="3892185">]</span>&nbsp;<span class="op" id="3892187">=</span>&nbsp;<span class="builtintype" id="3892189">byte</span><span class="op" id="3892193">(</span><span class="ident" id="3892194"><a href="/crypto/tls/common.go.html#3824023">extensionServerName</a></span>&nbsp;<span class="op" id="3892214">&amp;</span>&nbsp;<span class="num" id="3892216">0xff</span><span class="op" id="3892220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3892224">l</span>&nbsp;<span class="op" id="3892226">:=</span>&nbsp;<span class="builtinfunc" id="3892229">len</span><span class="op" id="3892232">(</span><span class="ident" id="3892233"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3892234">.</span><span class="ident" id="3892235">serverName</span><span class="op" id="3892245">)</span>&nbsp;<span class="op" id="3892247">+</span>&nbsp;<span class="num" id="3892249">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3892253"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3892254">[</span><span class="num" id="3892255">2</span><span class="op" id="3892256">]</span>&nbsp;<span class="op" id="3892258">=</span>&nbsp;<span class="builtintype" id="3892260">byte</span><span class="op" id="3892264">(</span><span class="ident" id="3892265"><a href="/crypto/tls/handshake_messages.go.html#3892224">l</a></span>&nbsp;<span class="op" id="3892267">&gt;&gt;</span>&nbsp;<span class="num" id="3892270">8</span><span class="op" id="3892271">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3892275"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3892276">[</span><span class="num" id="3892277">3</span><span class="op" id="3892278">]</span>&nbsp;<span class="op" id="3892280">=</span>&nbsp;<span class="builtintype" id="3892282">byte</span><span class="op" id="3892286">(</span><span class="ident" id="3892287"><a href="/crypto/tls/handshake_messages.go.html#3892224">l</a></span><span class="op" id="3892288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3892292"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span>&nbsp;<span class="op" id="3892294">=</span>&nbsp;<span class="ident" id="3892296"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3892297">[</span><span class="num" id="3892298">4</span><span class="op" id="3892299">:</span><span class="op" id="3892300">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3892305">//&nbsp;RFC&nbsp;3546,&nbsp;section&nbsp;3.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3892332">//</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3892337">//&nbsp;struct&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3892351">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NameType&nbsp;name_type;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3892380">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;(name_type)&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3892410">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;host_name:&nbsp;HostName;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3892449">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;name;</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3892466">//&nbsp;}&nbsp;ServerName;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3892485">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3892490">//&nbsp;enum&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3892502">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;host_name(0),&nbsp;(255)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3892531">//&nbsp;}&nbsp;NameType;</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3892548">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3892553">//&nbsp;opaque&nbsp;HostName&lt;1..2^16-1&gt;;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3892586">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3892591">//&nbsp;struct&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3892605">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ServerName&nbsp;server_name_list&lt;1..2^16-1&gt;</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3892653">//&nbsp;}&nbsp;ServerNameList;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3892677"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3892678">[</span><span class="num" id="3892679">0</span><span class="op" id="3892680">]</span>&nbsp;<span class="op" id="3892682">=</span>&nbsp;<span class="builtintype" id="3892684">byte</span><span class="op" id="3892688">(</span><span class="op" id="3892689">(</span><span class="builtinfunc" id="3892690">len</span><span class="op" id="3892693">(</span><span class="ident" id="3892694"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3892695">.</span><span class="ident" id="3892696">serverName</span><span class="op" id="3892706">)</span>&nbsp;<span class="op" id="3892708">+</span>&nbsp;<span class="num" id="3892710">3</span><span class="op" id="3892711">)</span>&nbsp;<span class="op" id="3892713">&gt;&gt;</span>&nbsp;<span class="num" id="3892716">8</span><span class="op" id="3892717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3892721"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3892722">[</span><span class="num" id="3892723">1</span><span class="op" id="3892724">]</span>&nbsp;<span class="op" id="3892726">=</span>&nbsp;<span class="builtintype" id="3892728">byte</span><span class="op" id="3892732">(</span><span class="builtinfunc" id="3892733">len</span><span class="op" id="3892736">(</span><span class="ident" id="3892737"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3892738">.</span><span class="ident" id="3892739">serverName</span><span class="op" id="3892749">)</span>&nbsp;<span class="op" id="3892751">+</span>&nbsp;<span class="num" id="3892753">3</span><span class="op" id="3892754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3892758"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3892759">[</span><span class="num" id="3892760">3</span><span class="op" id="3892761">]</span>&nbsp;<span class="op" id="3892763">=</span>&nbsp;<span class="builtintype" id="3892765">byte</span><span class="op" id="3892769">(</span><span class="builtinfunc" id="3892770">len</span><span class="op" id="3892773">(</span><span class="ident" id="3892774"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3892775">.</span><span class="ident" id="3892776">serverName</span><span class="op" id="3892786">)</span>&nbsp;<span class="op" id="3892788">&gt;&gt;</span>&nbsp;<span class="num" id="3892791">8</span><span class="op" id="3892792">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3892796"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3892797">[</span><span class="num" id="3892798">4</span><span class="op" id="3892799">]</span>&nbsp;<span class="op" id="3892801">=</span>&nbsp;<span class="builtintype" id="3892803">byte</span><span class="op" id="3892807">(</span><span class="builtinfunc" id="3892808">len</span><span class="op" id="3892811">(</span><span class="ident" id="3892812"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3892813">.</span><span class="ident" id="3892814">serverName</span><span class="op" id="3892824">)</span><span class="op" id="3892825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3892829">copy</span><span class="op" id="3892833">(</span><span class="ident" id="3892834"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3892835">[</span><span class="num" id="3892836">5</span><span class="op" id="3892837">:</span><span class="op" id="3892838">]</span><span class="op" id="3892839">,</span>&nbsp;<span class="op" id="3892841">[</span><span class="op" id="3892842">]</span><span class="builtintype" id="3892843">byte</span><span class="op" id="3892847">(</span><span class="ident" id="3892848"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3892849">.</span><span class="ident" id="3892850">serverName</span><span class="op" id="3892860">)</span><span class="op" id="3892861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3892865"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span>&nbsp;<span class="op" id="3892867">=</span>&nbsp;<span class="ident" id="3892869"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3892870">[</span><span class="ident" id="3892871"><a href="/crypto/tls/handshake_messages.go.html#3892224">l</a></span><span class="op" id="3892872">:</span><span class="op" id="3892873">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3892876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3892879">if</span>&nbsp;<span class="ident" id="3892882"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3892883">.</span><span class="ident" id="3892884">ocspStapling</span>&nbsp;<span class="op" id="3892897">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3892901">//&nbsp;RFC&nbsp;4366,&nbsp;section&nbsp;3.6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3892928"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3892929">[</span><span class="num" id="3892930">0</span><span class="op" id="3892931">]</span>&nbsp;<span class="op" id="3892933">=</span>&nbsp;<span class="builtintype" id="3892935">byte</span><span class="op" id="3892939">(</span><span class="ident" id="3892940"><a href="/crypto/tls/common.go.html#3824064">extensionStatusRequest</a></span>&nbsp;<span class="op" id="3892963">&gt;&gt;</span>&nbsp;<span class="num" id="3892966">8</span><span class="op" id="3892967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3892971"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3892972">[</span><span class="num" id="3892973">1</span><span class="op" id="3892974">]</span>&nbsp;<span class="op" id="3892976">=</span>&nbsp;<span class="builtintype" id="3892978">byte</span><span class="op" id="3892982">(</span><span class="ident" id="3892983"><a href="/crypto/tls/common.go.html#3824064">extensionStatusRequest</a></span><span class="op" id="3893005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3893009"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3893010">[</span><span class="num" id="3893011">2</span><span class="op" id="3893012">]</span>&nbsp;<span class="op" id="3893014">=</span>&nbsp;<span class="num" id="3893016">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3893020"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3893021">[</span><span class="num" id="3893022">3</span><span class="op" id="3893023">]</span>&nbsp;<span class="op" id="3893025">=</span>&nbsp;<span class="num" id="3893027">5</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3893031"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3893032">[</span><span class="num" id="3893033">4</span><span class="op" id="3893034">]</span>&nbsp;<span class="op" id="3893036">=</span>&nbsp;<span class="num" id="3893038">1</span>&nbsp;<span class="comment" id="3893040">//&nbsp;OCSP&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3893055">//&nbsp;Two&nbsp;zero&nbsp;valued&nbsp;uint16s&nbsp;for&nbsp;the&nbsp;two&nbsp;lengths.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3893105"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span>&nbsp;<span class="op" id="3893107">=</span>&nbsp;<span class="ident" id="3893109"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3893110">[</span><span class="num" id="3893111">9</span><span class="op" id="3893112">:</span><span class="op" id="3893113">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3893116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3893119">if</span>&nbsp;<span class="builtinfunc" id="3893122">len</span><span class="op" id="3893125">(</span><span class="ident" id="3893126"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3893127">.</span><span class="ident" id="3893128">supportedCurves</span><span class="op" id="3893143">)</span>&nbsp;<span class="op" id="3893145">&gt;</span>&nbsp;<span class="num" id="3893147">0</span>&nbsp;<span class="op" id="3893149">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3893153">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3893207"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3893208">[</span><span class="num" id="3893209">0</span><span class="op" id="3893210">]</span>&nbsp;<span class="op" id="3893212">=</span>&nbsp;<span class="builtintype" id="3893214">byte</span><span class="op" id="3893218">(</span><span class="ident" id="3893219"><a href="/crypto/tls/common.go.html#3824105">extensionSupportedCurves</a></span>&nbsp;<span class="op" id="3893244">&gt;&gt;</span>&nbsp;<span class="num" id="3893247">8</span><span class="op" id="3893248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3893252"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3893253">[</span><span class="num" id="3893254">1</span><span class="op" id="3893255">]</span>&nbsp;<span class="op" id="3893257">=</span>&nbsp;<span class="builtintype" id="3893259">byte</span><span class="op" id="3893263">(</span><span class="ident" id="3893264"><a href="/crypto/tls/common.go.html#3824105">extensionSupportedCurves</a></span><span class="op" id="3893288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3893292">l</span>&nbsp;<span class="op" id="3893294">:=</span>&nbsp;<span class="num" id="3893297">2</span>&nbsp;<span class="op" id="3893299">+</span>&nbsp;<span class="num" id="3893301">2</span><span class="op" id="3893302">*</span><span class="builtinfunc" id="3893303">len</span><span class="op" id="3893306">(</span><span class="ident" id="3893307"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3893308">.</span><span class="ident" id="3893309">supportedCurves</span><span class="op" id="3893324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3893328"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3893329">[</span><span class="num" id="3893330">2</span><span class="op" id="3893331">]</span>&nbsp;<span class="op" id="3893333">=</span>&nbsp;<span class="builtintype" id="3893335">byte</span><span class="op" id="3893339">(</span><span class="ident" id="3893340"><a href="/crypto/tls/handshake_messages.go.html#3893292">l</a></span>&nbsp;<span class="op" id="3893342">&gt;&gt;</span>&nbsp;<span class="num" id="3893345">8</span><span class="op" id="3893346">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3893350"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3893351">[</span><span class="num" id="3893352">3</span><span class="op" id="3893353">]</span>&nbsp;<span class="op" id="3893355">=</span>&nbsp;<span class="builtintype" id="3893357">byte</span><span class="op" id="3893361">(</span><span class="ident" id="3893362"><a href="/crypto/tls/handshake_messages.go.html#3893292">l</a></span><span class="op" id="3893363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3893367"><a href="/crypto/tls/handshake_messages.go.html#3893292">l</a></span>&nbsp;<span class="op" id="3893369">-=</span>&nbsp;<span class="num" id="3893372">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3893376"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3893377">[</span><span class="num" id="3893378">4</span><span class="op" id="3893379">]</span>&nbsp;<span class="op" id="3893381">=</span>&nbsp;<span class="builtintype" id="3893383">byte</span><span class="op" id="3893387">(</span><span class="ident" id="3893388"><a href="/crypto/tls/handshake_messages.go.html#3893292">l</a></span>&nbsp;<span class="op" id="3893390">&gt;&gt;</span>&nbsp;<span class="num" id="3893393">8</span><span class="op" id="3893394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3893398"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3893399">[</span><span class="num" id="3893400">5</span><span class="op" id="3893401">]</span>&nbsp;<span class="op" id="3893403">=</span>&nbsp;<span class="builtintype" id="3893405">byte</span><span class="op" id="3893409">(</span><span class="ident" id="3893410"><a href="/crypto/tls/handshake_messages.go.html#3893292">l</a></span><span class="op" id="3893411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3893415"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span>&nbsp;<span class="op" id="3893417">=</span>&nbsp;<span class="ident" id="3893419"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3893420">[</span><span class="num" id="3893421">6</span><span class="op" id="3893422">:</span><span class="op" id="3893423">]</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3893427">for</span>&nbsp;<span class="ident" id="3893431">_</span><span class="op" id="3893432">,</span>&nbsp;<span class="ident" id="3893434">curve</span>&nbsp;<span class="op" id="3893440">:=</span>&nbsp;<span class="keyword" id="3893443">range</span>&nbsp;<span class="ident" id="3893449"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3893450">.</span><span class="ident" id="3893451">supportedCurves</span>&nbsp;<span class="op" id="3893467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3893472"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3893473">[</span><span class="num" id="3893474">0</span><span class="op" id="3893475">]</span>&nbsp;<span class="op" id="3893477">=</span>&nbsp;<span class="builtintype" id="3893479">byte</span><span class="op" id="3893483">(</span><span class="ident" id="3893484"><a href="/crypto/tls/handshake_messages.go.html#3893434">curve</a></span>&nbsp;<span class="op" id="3893490">&gt;&gt;</span>&nbsp;<span class="num" id="3893493">8</span><span class="op" id="3893494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3893499"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3893500">[</span><span class="num" id="3893501">1</span><span class="op" id="3893502">]</span>&nbsp;<span class="op" id="3893504">=</span>&nbsp;<span class="builtintype" id="3893506">byte</span><span class="op" id="3893510">(</span><span class="ident" id="3893511"><a href="/crypto/tls/handshake_messages.go.html#3893434">curve</a></span><span class="op" id="3893516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3893521"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span>&nbsp;<span class="op" id="3893523">=</span>&nbsp;<span class="ident" id="3893525"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3893526">[</span><span class="num" id="3893527">2</span><span class="op" id="3893528">:</span><span class="op" id="3893529">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3893533">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3893536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3893539">if</span>&nbsp;<span class="builtinfunc" id="3893542">len</span><span class="op" id="3893545">(</span><span class="ident" id="3893546"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3893547">.</span><span class="ident" id="3893548">supportedPoints</span><span class="op" id="3893563">)</span>&nbsp;<span class="op" id="3893565">&gt;</span>&nbsp;<span class="num" id="3893567">0</span>&nbsp;<span class="op" id="3893569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3893573">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3893627"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3893628">[</span><span class="num" id="3893629">0</span><span class="op" id="3893630">]</span>&nbsp;<span class="op" id="3893632">=</span>&nbsp;<span class="builtintype" id="3893634">byte</span><span class="op" id="3893638">(</span><span class="ident" id="3893639"><a href="/crypto/tls/common.go.html#3824147">extensionSupportedPoints</a></span>&nbsp;<span class="op" id="3893664">&gt;&gt;</span>&nbsp;<span class="num" id="3893667">8</span><span class="op" id="3893668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3893672"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3893673">[</span><span class="num" id="3893674">1</span><span class="op" id="3893675">]</span>&nbsp;<span class="op" id="3893677">=</span>&nbsp;<span class="builtintype" id="3893679">byte</span><span class="op" id="3893683">(</span><span class="ident" id="3893684"><a href="/crypto/tls/common.go.html#3824147">extensionSupportedPoints</a></span><span class="op" id="3893708">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3893712">l</span>&nbsp;<span class="op" id="3893714">:=</span>&nbsp;<span class="num" id="3893717">1</span>&nbsp;<span class="op" id="3893719">+</span>&nbsp;<span class="builtinfunc" id="3893721">len</span><span class="op" id="3893724">(</span><span class="ident" id="3893725"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3893726">.</span><span class="ident" id="3893727">supportedPoints</span><span class="op" id="3893742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3893746"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3893747">[</span><span class="num" id="3893748">2</span><span class="op" id="3893749">]</span>&nbsp;<span class="op" id="3893751">=</span>&nbsp;<span class="builtintype" id="3893753">byte</span><span class="op" id="3893757">(</span><span class="ident" id="3893758"><a href="/crypto/tls/handshake_messages.go.html#3893712">l</a></span>&nbsp;<span class="op" id="3893760">&gt;&gt;</span>&nbsp;<span class="num" id="3893763">8</span><span class="op" id="3893764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3893768"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3893769">[</span><span class="num" id="3893770">3</span><span class="op" id="3893771">]</span>&nbsp;<span class="op" id="3893773">=</span>&nbsp;<span class="builtintype" id="3893775">byte</span><span class="op" id="3893779">(</span><span class="ident" id="3893780"><a href="/crypto/tls/handshake_messages.go.html#3893712">l</a></span><span class="op" id="3893781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3893785"><a href="/crypto/tls/handshake_messages.go.html#3893712">l</a></span><span class="op" id="3893786">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3893791"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3893792">[</span><span class="num" id="3893793">4</span><span class="op" id="3893794">]</span>&nbsp;<span class="op" id="3893796">=</span>&nbsp;<span class="builtintype" id="3893798">byte</span><span class="op" id="3893802">(</span><span class="ident" id="3893803"><a href="/crypto/tls/handshake_messages.go.html#3893712">l</a></span><span class="op" id="3893804">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3893808"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span>&nbsp;<span class="op" id="3893810">=</span>&nbsp;<span class="ident" id="3893812"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3893813">[</span><span class="num" id="3893814">5</span><span class="op" id="3893815">:</span><span class="op" id="3893816">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3893820">for</span>&nbsp;<span class="ident" id="3893824">_</span><span class="op" id="3893825">,</span>&nbsp;<span class="ident" id="3893827">pointFormat</span>&nbsp;<span class="op" id="3893839">:=</span>&nbsp;<span class="keyword" id="3893842">range</span>&nbsp;<span class="ident" id="3893848"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3893849">.</span><span class="ident" id="3893850">supportedPoints</span>&nbsp;<span class="op" id="3893866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3893871"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3893872">[</span><span class="num" id="3893873">0</span><span class="op" id="3893874">]</span>&nbsp;<span class="op" id="3893876">=</span>&nbsp;<span class="builtintype" id="3893878">byte</span><span class="op" id="3893882">(</span><span class="ident" id="3893883"><a href="/crypto/tls/handshake_messages.go.html#3893827">pointFormat</a></span><span class="op" id="3893894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3893899"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span>&nbsp;<span class="op" id="3893901">=</span>&nbsp;<span class="ident" id="3893903"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3893904">[</span><span class="num" id="3893905">1</span><span class="op" id="3893906">:</span><span class="op" id="3893907">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3893911">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3893914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3893917">if</span>&nbsp;<span class="ident" id="3893920"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3893921">.</span><span class="ident" id="3893922">ticketSupported</span>&nbsp;<span class="op" id="3893938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3893942">//&nbsp;http://tools.ietf.org/html/rfc5077#section-3.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3893994"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3893995">[</span><span class="num" id="3893996">0</span><span class="op" id="3893997">]</span>&nbsp;<span class="op" id="3893999">=</span>&nbsp;<span class="builtintype" id="3894001">byte</span><span class="op" id="3894005">(</span><span class="ident" id="3894006"><a href="/crypto/tls/common.go.html#3824273">extensionSessionTicket</a></span>&nbsp;<span class="op" id="3894029">&gt;&gt;</span>&nbsp;<span class="num" id="3894032">8</span><span class="op" id="3894033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3894037"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3894038">[</span><span class="num" id="3894039">1</span><span class="op" id="3894040">]</span>&nbsp;<span class="op" id="3894042">=</span>&nbsp;<span class="builtintype" id="3894044">byte</span><span class="op" id="3894048">(</span><span class="ident" id="3894049"><a href="/crypto/tls/common.go.html#3824273">extensionSessionTicket</a></span><span class="op" id="3894071">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3894075">l</span>&nbsp;<span class="op" id="3894077">:=</span>&nbsp;<span class="builtinfunc" id="3894080">len</span><span class="op" id="3894083">(</span><span class="ident" id="3894084"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3894085">.</span><span class="ident" id="3894086">sessionTicket</span><span class="op" id="3894099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3894103"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3894104">[</span><span class="num" id="3894105">2</span><span class="op" id="3894106">]</span>&nbsp;<span class="op" id="3894108">=</span>&nbsp;<span class="builtintype" id="3894110">byte</span><span class="op" id="3894114">(</span><span class="ident" id="3894115"><a href="/crypto/tls/handshake_messages.go.html#3894075">l</a></span>&nbsp;<span class="op" id="3894117">&gt;&gt;</span>&nbsp;<span class="num" id="3894120">8</span><span class="op" id="3894121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3894125"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3894126">[</span><span class="num" id="3894127">3</span><span class="op" id="3894128">]</span>&nbsp;<span class="op" id="3894130">=</span>&nbsp;<span class="builtintype" id="3894132">byte</span><span class="op" id="3894136">(</span><span class="ident" id="3894137"><a href="/crypto/tls/handshake_messages.go.html#3894075">l</a></span><span class="op" id="3894138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3894142"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span>&nbsp;<span class="op" id="3894144">=</span>&nbsp;<span class="ident" id="3894146"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3894147">[</span><span class="num" id="3894148">4</span><span class="op" id="3894149">:</span><span class="op" id="3894150">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3894154">copy</span><span class="op" id="3894158">(</span><span class="ident" id="3894159"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3894160">,</span>&nbsp;<span class="ident" id="3894162"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3894163">.</span><span class="ident" id="3894164">sessionTicket</span><span class="op" id="3894177">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3894181"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span>&nbsp;<span class="op" id="3894183">=</span>&nbsp;<span class="ident" id="3894185"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3894186">[</span><span class="builtinfunc" id="3894187">len</span><span class="op" id="3894190">(</span><span class="ident" id="3894191"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3894192">.</span><span class="ident" id="3894193">sessionTicket</span><span class="op" id="3894206">)</span><span class="op" id="3894207">:</span><span class="op" id="3894208">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3894211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3894214">if</span>&nbsp;<span class="builtinfunc" id="3894217">len</span><span class="op" id="3894220">(</span><span class="ident" id="3894221"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3894222">.</span><span class="ident" id="3894223">signatureAndHashes</span><span class="op" id="3894241">)</span>&nbsp;<span class="op" id="3894243">&gt;</span>&nbsp;<span class="num" id="3894245">0</span>&nbsp;<span class="op" id="3894247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3894251">//&nbsp;https://tools.ietf.org/html/rfc5246#section-7.4.1.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3894310"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3894311">[</span><span class="num" id="3894312">0</span><span class="op" id="3894313">]</span>&nbsp;<span class="op" id="3894315">=</span>&nbsp;<span class="builtintype" id="3894317">byte</span><span class="op" id="3894321">(</span><span class="ident" id="3894322"><a href="/crypto/tls/common.go.html#3824189">extensionSignatureAlgorithms</a></span>&nbsp;<span class="op" id="3894351">&gt;&gt;</span>&nbsp;<span class="num" id="3894354">8</span><span class="op" id="3894355">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3894359"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3894360">[</span><span class="num" id="3894361">1</span><span class="op" id="3894362">]</span>&nbsp;<span class="op" id="3894364">=</span>&nbsp;<span class="builtintype" id="3894366">byte</span><span class="op" id="3894370">(</span><span class="ident" id="3894371"><a href="/crypto/tls/common.go.html#3824189">extensionSignatureAlgorithms</a></span><span class="op" id="3894399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3894403">l</span>&nbsp;<span class="op" id="3894405">:=</span>&nbsp;<span class="num" id="3894408">2</span>&nbsp;<span class="op" id="3894410">+</span>&nbsp;<span class="num" id="3894412">2</span><span class="op" id="3894413">*</span><span class="builtinfunc" id="3894414">len</span><span class="op" id="3894417">(</span><span class="ident" id="3894418"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3894419">.</span><span class="ident" id="3894420">signatureAndHashes</span><span class="op" id="3894438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3894442"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3894443">[</span><span class="num" id="3894444">2</span><span class="op" id="3894445">]</span>&nbsp;<span class="op" id="3894447">=</span>&nbsp;<span class="builtintype" id="3894449">byte</span><span class="op" id="3894453">(</span><span class="ident" id="3894454"><a href="/crypto/tls/handshake_messages.go.html#3894403">l</a></span>&nbsp;<span class="op" id="3894456">&gt;&gt;</span>&nbsp;<span class="num" id="3894459">8</span><span class="op" id="3894460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3894464"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3894465">[</span><span class="num" id="3894466">3</span><span class="op" id="3894467">]</span>&nbsp;<span class="op" id="3894469">=</span>&nbsp;<span class="builtintype" id="3894471">byte</span><span class="op" id="3894475">(</span><span class="ident" id="3894476"><a href="/crypto/tls/handshake_messages.go.html#3894403">l</a></span><span class="op" id="3894477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3894481"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span>&nbsp;<span class="op" id="3894483">=</span>&nbsp;<span class="ident" id="3894485"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3894486">[</span><span class="num" id="3894487">4</span><span class="op" id="3894488">:</span><span class="op" id="3894489">]</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3894494"><a href="/crypto/tls/handshake_messages.go.html#3894403">l</a></span>&nbsp;<span class="op" id="3894496">-=</span>&nbsp;<span class="num" id="3894499">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3894503"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3894504">[</span><span class="num" id="3894505">0</span><span class="op" id="3894506">]</span>&nbsp;<span class="op" id="3894508">=</span>&nbsp;<span class="builtintype" id="3894510">byte</span><span class="op" id="3894514">(</span><span class="ident" id="3894515"><a href="/crypto/tls/handshake_messages.go.html#3894403">l</a></span>&nbsp;<span class="op" id="3894517">&gt;&gt;</span>&nbsp;<span class="num" id="3894520">8</span><span class="op" id="3894521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3894525"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3894526">[</span><span class="num" id="3894527">1</span><span class="op" id="3894528">]</span>&nbsp;<span class="op" id="3894530">=</span>&nbsp;<span class="builtintype" id="3894532">byte</span><span class="op" id="3894536">(</span><span class="ident" id="3894537"><a href="/crypto/tls/handshake_messages.go.html#3894403">l</a></span><span class="op" id="3894538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3894542"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span>&nbsp;<span class="op" id="3894544">=</span>&nbsp;<span class="ident" id="3894546"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3894547">[</span><span class="num" id="3894548">2</span><span class="op" id="3894549">:</span><span class="op" id="3894550">]</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3894554">for</span>&nbsp;<span class="ident" id="3894558">_</span><span class="op" id="3894559">,</span>&nbsp;<span class="ident" id="3894561">sigAndHash</span>&nbsp;<span class="op" id="3894572">:=</span>&nbsp;<span class="keyword" id="3894575">range</span>&nbsp;<span class="ident" id="3894581"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3894582">.</span><span class="ident" id="3894583">signatureAndHashes</span>&nbsp;<span class="op" id="3894602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3894607"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3894608">[</span><span class="num" id="3894609">0</span><span class="op" id="3894610">]</span>&nbsp;<span class="op" id="3894612">=</span>&nbsp;<span class="ident" id="3894614"><a href="/crypto/tls/handshake_messages.go.html#3894561">sigAndHash</a></span><span class="op" id="3894624">.</span><span class="ident" id="3894625">hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3894633"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3894634">[</span><span class="num" id="3894635">1</span><span class="op" id="3894636">]</span>&nbsp;<span class="op" id="3894638">=</span>&nbsp;<span class="ident" id="3894640"><a href="/crypto/tls/handshake_messages.go.html#3894561">sigAndHash</a></span><span class="op" id="3894650">.</span><span class="ident" id="3894651">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3894664"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span>&nbsp;<span class="op" id="3894666">=</span>&nbsp;<span class="ident" id="3894668"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3894669">[</span><span class="num" id="3894670">2</span><span class="op" id="3894671">:</span><span class="op" id="3894672">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3894676">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3894679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3894682">if</span>&nbsp;<span class="ident" id="3894685"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3894686">.</span><span class="ident" id="3894687">secureRenegotiation</span>&nbsp;<span class="op" id="3894707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3894711"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3894712">[</span><span class="num" id="3894713">0</span><span class="op" id="3894714">]</span>&nbsp;<span class="op" id="3894716">=</span>&nbsp;<span class="builtintype" id="3894718">byte</span><span class="op" id="3894722">(</span><span class="ident" id="3894723"><a href="/crypto/tls/common.go.html#3824381">extensionRenegotiationInfo</a></span>&nbsp;<span class="op" id="3894750">&gt;&gt;</span>&nbsp;<span class="num" id="3894753">8</span><span class="op" id="3894754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3894758"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3894759">[</span><span class="num" id="3894760">1</span><span class="op" id="3894761">]</span>&nbsp;<span class="op" id="3894763">=</span>&nbsp;<span class="builtintype" id="3894765">byte</span><span class="op" id="3894769">(</span><span class="ident" id="3894770"><a href="/crypto/tls/common.go.html#3824381">extensionRenegotiationInfo</a></span>&nbsp;<span class="op" id="3894797">&amp;</span>&nbsp;<span class="num" id="3894799">0xff</span><span class="op" id="3894803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3894807"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3894808">[</span><span class="num" id="3894809">2</span><span class="op" id="3894810">]</span>&nbsp;<span class="op" id="3894812">=</span>&nbsp;<span class="num" id="3894814">0</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3894818"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3894819">[</span><span class="num" id="3894820">3</span><span class="op" id="3894821">]</span>&nbsp;<span class="op" id="3894823">=</span>&nbsp;<span class="num" id="3894825">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3894829"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span>&nbsp;<span class="op" id="3894831">=</span>&nbsp;<span class="ident" id="3894833"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3894834">[</span><span class="num" id="3894835">5</span><span class="op" id="3894836">:</span><span class="op" id="3894837">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3894840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3894843">if</span>&nbsp;<span class="builtinfunc" id="3894846">len</span><span class="op" id="3894849">(</span><span class="ident" id="3894850"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3894851">.</span><span class="ident" id="3894852">alpnProtocols</span><span class="op" id="3894865">)</span>&nbsp;<span class="op" id="3894867">&gt;</span>&nbsp;<span class="num" id="3894869">0</span>&nbsp;<span class="op" id="3894871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3894875"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3894876">[</span><span class="num" id="3894877">0</span><span class="op" id="3894878">]</span>&nbsp;<span class="op" id="3894880">=</span>&nbsp;<span class="builtintype" id="3894882">byte</span><span class="op" id="3894886">(</span><span class="ident" id="3894887"><a href="/crypto/tls/common.go.html#3824231">extensionALPN</a></span>&nbsp;<span class="op" id="3894901">&gt;&gt;</span>&nbsp;<span class="num" id="3894904">8</span><span class="op" id="3894905">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3894909"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3894910">[</span><span class="num" id="3894911">1</span><span class="op" id="3894912">]</span>&nbsp;<span class="op" id="3894914">=</span>&nbsp;<span class="builtintype" id="3894916">byte</span><span class="op" id="3894920">(</span><span class="ident" id="3894921"><a href="/crypto/tls/common.go.html#3824231">extensionALPN</a></span>&nbsp;<span class="op" id="3894935">&amp;</span>&nbsp;<span class="num" id="3894937">0xff</span><span class="op" id="3894941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3894945">lengths</span>&nbsp;<span class="op" id="3894953">:=</span>&nbsp;<span class="ident" id="3894956"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3894957">[</span><span class="num" id="3894958">2</span><span class="op" id="3894959">:</span><span class="op" id="3894960">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3894964"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span>&nbsp;<span class="op" id="3894966">=</span>&nbsp;<span class="ident" id="3894968"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3894969">[</span><span class="num" id="3894970">6</span><span class="op" id="3894971">:</span><span class="op" id="3894972">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3894977">stringsLength</span>&nbsp;<span class="op" id="3894991">:=</span>&nbsp;<span class="num" id="3894994">0</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3894998">for</span>&nbsp;<span class="ident" id="3895002">_</span><span class="op" id="3895003">,</span>&nbsp;<span class="ident" id="3895005">s</span>&nbsp;<span class="op" id="3895007">:=</span>&nbsp;<span class="keyword" id="3895010">range</span>&nbsp;<span class="ident" id="3895016"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3895017">.</span><span class="ident" id="3895018">alpnProtocols</span>&nbsp;<span class="op" id="3895032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895037">l</span>&nbsp;<span class="op" id="3895039">:=</span>&nbsp;<span class="builtinfunc" id="3895042">len</span><span class="op" id="3895045">(</span><span class="ident" id="3895046"><a href="/crypto/tls/handshake_messages.go.html#3895005">s</a></span><span class="op" id="3895047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895052"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3895053">[</span><span class="num" id="3895054">0</span><span class="op" id="3895055">]</span>&nbsp;<span class="op" id="3895057">=</span>&nbsp;<span class="builtintype" id="3895059">byte</span><span class="op" id="3895063">(</span><span class="ident" id="3895064"><a href="/crypto/tls/handshake_messages.go.html#3895037">l</a></span><span class="op" id="3895065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3895070">copy</span><span class="op" id="3895074">(</span><span class="ident" id="3895075"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3895076">[</span><span class="num" id="3895077">1</span><span class="op" id="3895078">:</span><span class="op" id="3895079">]</span><span class="op" id="3895080">,</span>&nbsp;<span class="ident" id="3895082"><a href="/crypto/tls/handshake_messages.go.html#3895005">s</a></span><span class="op" id="3895083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895088"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span>&nbsp;<span class="op" id="3895090">=</span>&nbsp;<span class="ident" id="3895092"><a href="/crypto/tls/handshake_messages.go.html#3891707">z</a></span><span class="op" id="3895093">[</span><span class="num" id="3895094">1</span><span class="op" id="3895095">+</span><span class="ident" id="3895096"><a href="/crypto/tls/handshake_messages.go.html#3895037">l</a></span><span class="op" id="3895097">:</span><span class="op" id="3895098">]</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895103"><a href="/crypto/tls/handshake_messages.go.html#3894977">stringsLength</a></span>&nbsp;<span class="op" id="3895117">+=</span>&nbsp;<span class="num" id="3895120">1</span>&nbsp;<span class="op" id="3895122">+</span>&nbsp;<span class="ident" id="3895124"><a href="/crypto/tls/handshake_messages.go.html#3895037">l</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3895128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895133"><a href="/crypto/tls/handshake_messages.go.html#3894945">lengths</a></span><span class="op" id="3895140">[</span><span class="num" id="3895141">2</span><span class="op" id="3895142">]</span>&nbsp;<span class="op" id="3895144">=</span>&nbsp;<span class="builtintype" id="3895146">byte</span><span class="op" id="3895150">(</span><span class="ident" id="3895151"><a href="/crypto/tls/handshake_messages.go.html#3894977">stringsLength</a></span>&nbsp;<span class="op" id="3895165">&gt;&gt;</span>&nbsp;<span class="num" id="3895168">8</span><span class="op" id="3895169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895173"><a href="/crypto/tls/handshake_messages.go.html#3894945">lengths</a></span><span class="op" id="3895180">[</span><span class="num" id="3895181">3</span><span class="op" id="3895182">]</span>&nbsp;<span class="op" id="3895184">=</span>&nbsp;<span class="builtintype" id="3895186">byte</span><span class="op" id="3895190">(</span><span class="ident" id="3895191"><a href="/crypto/tls/handshake_messages.go.html#3894977">stringsLength</a></span><span class="op" id="3895204">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895208"><a href="/crypto/tls/handshake_messages.go.html#3894977">stringsLength</a></span>&nbsp;<span class="op" id="3895222">+=</span>&nbsp;<span class="num" id="3895225">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895229"><a href="/crypto/tls/handshake_messages.go.html#3894945">lengths</a></span><span class="op" id="3895236">[</span><span class="num" id="3895237">0</span><span class="op" id="3895238">]</span>&nbsp;<span class="op" id="3895240">=</span>&nbsp;<span class="builtintype" id="3895242">byte</span><span class="op" id="3895246">(</span><span class="ident" id="3895247"><a href="/crypto/tls/handshake_messages.go.html#3894977">stringsLength</a></span>&nbsp;<span class="op" id="3895261">&gt;&gt;</span>&nbsp;<span class="num" id="3895264">8</span><span class="op" id="3895265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895269"><a href="/crypto/tls/handshake_messages.go.html#3894945">lengths</a></span><span class="op" id="3895276">[</span><span class="num" id="3895277">1</span><span class="op" id="3895278">]</span>&nbsp;<span class="op" id="3895280">=</span>&nbsp;<span class="builtintype" id="3895282">byte</span><span class="op" id="3895286">(</span><span class="ident" id="3895287"><a href="/crypto/tls/handshake_messages.go.html#3894977">stringsLength</a></span><span class="op" id="3895300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3895303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895307"><a href="/crypto/tls/handshake_messages.go.html#3889954">m</a></span><span class="op" id="3895308">.</span><span class="ident" id="3895309">raw</span>&nbsp;<span class="op" id="3895313">=</span>&nbsp;<span class="ident" id="3895315"><a href="/crypto/tls/handshake_messages.go.html#3891214">x</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3895319">return</span>&nbsp;<span class="ident" id="3895326"><a href="/crypto/tls/handshake_messages.go.html#3891214">x</a></span><br>
<span class="lineno"></span><span class="op" id="3895328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="3895331">func</span>&nbsp;<span class="op" id="3895336">(</span><span class="ident" id="3895337">m</span>&nbsp;<span class="op" id="3895339">*</span><span class="ident" id="3895340"><a href="/crypto/tls/handshake_messages.go.html#3888598">clientHelloMsg</a></span><span class="op" id="3895354">)</span>&nbsp;<span class="ident" id="3895356">unmarshal</span><span class="op" id="3895365">(</span><span class="ident" id="3895366">data</span>&nbsp;<span class="op" id="3895371">[</span><span class="op" id="3895372">]</span><span class="builtintype" id="3895373">byte</span><span class="op" id="3895377">)</span>&nbsp;<span class="builtintype" id="3895379">bool</span>&nbsp;<span class="op" id="3895384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3895387">if</span>&nbsp;<span class="builtinfunc" id="3895390">len</span><span class="op" id="3895393">(</span><span class="ident" id="3895394"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3895398">)</span>&nbsp;<span class="op" id="3895400">&lt;</span>&nbsp;<span class="num" id="3895402">42</span>&nbsp;<span class="op" id="3895405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3895409">return</span>&nbsp;<span class="builtintype" id="3895416">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3895423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895426"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3895427">.</span><span class="ident" id="3895428">raw</span>&nbsp;<span class="op" id="3895432">=</span>&nbsp;<span class="ident" id="3895434"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895440"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3895441">.</span><span class="ident" id="3895442">vers</span>&nbsp;<span class="op" id="3895447">=</span>&nbsp;<span class="builtintype" id="3895449">uint16</span><span class="op" id="3895455">(</span><span class="ident" id="3895456"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3895460">[</span><span class="num" id="3895461">4</span><span class="op" id="3895462">]</span><span class="op" id="3895463">)</span><span class="op" id="3895464">&lt;&lt;</span><span class="num" id="3895466">8</span>&nbsp;<span class="op" id="3895468">|</span>&nbsp;<span class="builtintype" id="3895470">uint16</span><span class="op" id="3895476">(</span><span class="ident" id="3895477"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3895481">[</span><span class="num" id="3895482">5</span><span class="op" id="3895483">]</span><span class="op" id="3895484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895487"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3895488">.</span><span class="ident" id="3895489">random</span>&nbsp;<span class="op" id="3895496">=</span>&nbsp;<span class="ident" id="3895498"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3895502">[</span><span class="num" id="3895503">6</span><span class="op" id="3895504">:</span><span class="num" id="3895505">38</span><span class="op" id="3895507">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895510">sessionIdLen</span>&nbsp;<span class="op" id="3895523">:=</span>&nbsp;<span class="builtintype" id="3895526">int</span><span class="op" id="3895529">(</span><span class="ident" id="3895530"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3895534">[</span><span class="num" id="3895535">38</span><span class="op" id="3895537">]</span><span class="op" id="3895538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3895541">if</span>&nbsp;<span class="ident" id="3895544"><a href="/crypto/tls/handshake_messages.go.html#3895510">sessionIdLen</a></span>&nbsp;<span class="op" id="3895557">&gt;</span>&nbsp;<span class="num" id="3895559">32</span>&nbsp;<span class="op" id="3895562">||</span>&nbsp;<span class="builtinfunc" id="3895565">len</span><span class="op" id="3895568">(</span><span class="ident" id="3895569"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3895573">)</span>&nbsp;<span class="op" id="3895575">&lt;</span>&nbsp;<span class="num" id="3895577">39</span><span class="op" id="3895579">+</span><span class="ident" id="3895580"><a href="/crypto/tls/handshake_messages.go.html#3895510">sessionIdLen</a></span>&nbsp;<span class="op" id="3895593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3895597">return</span>&nbsp;<span class="builtintype" id="3895604">false</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3895611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895614"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3895615">.</span><span class="ident" id="3895616">sessionId</span>&nbsp;<span class="op" id="3895626">=</span>&nbsp;<span class="ident" id="3895628"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3895632">[</span><span class="num" id="3895633">39</span>&nbsp;<span class="op" id="3895636">:</span>&nbsp;<span class="num" id="3895638">39</span><span class="op" id="3895640">+</span><span class="ident" id="3895641"><a href="/crypto/tls/handshake_messages.go.html#3895510">sessionIdLen</a></span><span class="op" id="3895653">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895656"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span>&nbsp;<span class="op" id="3895661">=</span>&nbsp;<span class="ident" id="3895663"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3895667">[</span><span class="num" id="3895668">39</span><span class="op" id="3895670">+</span><span class="ident" id="3895671"><a href="/crypto/tls/handshake_messages.go.html#3895510">sessionIdLen</a></span><span class="op" id="3895683">:</span><span class="op" id="3895684">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3895687">if</span>&nbsp;<span class="builtinfunc" id="3895690">len</span><span class="op" id="3895693">(</span><span class="ident" id="3895694"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3895698">)</span>&nbsp;<span class="op" id="3895700">&lt;</span>&nbsp;<span class="num" id="3895702">2</span>&nbsp;<span class="op" id="3895704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3895708">return</span>&nbsp;<span class="builtintype" id="3895715">false</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3895722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3895725">//&nbsp;cipherSuiteLen&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;of&nbsp;cipher&nbsp;suite&nbsp;numbers.&nbsp;Since</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3895798">//&nbsp;they&nbsp;are&nbsp;uint16s,&nbsp;the&nbsp;number&nbsp;must&nbsp;be&nbsp;even.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895845">cipherSuiteLen</span>&nbsp;<span class="op" id="3895860">:=</span>&nbsp;<span class="builtintype" id="3895863">int</span><span class="op" id="3895866">(</span><span class="ident" id="3895867"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3895871">[</span><span class="num" id="3895872">0</span><span class="op" id="3895873">]</span><span class="op" id="3895874">)</span><span class="op" id="3895875">&lt;&lt;</span><span class="num" id="3895877">8</span>&nbsp;<span class="op" id="3895879">|</span>&nbsp;<span class="builtintype" id="3895881">int</span><span class="op" id="3895884">(</span><span class="ident" id="3895885"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3895889">[</span><span class="num" id="3895890">1</span><span class="op" id="3895891">]</span><span class="op" id="3895892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3895895">if</span>&nbsp;<span class="ident" id="3895898"><a href="/crypto/tls/handshake_messages.go.html#3895845">cipherSuiteLen</a></span><span class="op" id="3895912">%</span><span class="num" id="3895913">2</span>&nbsp;<span class="op" id="3895915">==</span>&nbsp;<span class="num" id="3895918">1</span>&nbsp;<span class="op" id="3895920">||</span>&nbsp;<span class="builtinfunc" id="3895923">len</span><span class="op" id="3895926">(</span><span class="ident" id="3895927"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3895931">)</span>&nbsp;<span class="op" id="3895933">&lt;</span>&nbsp;<span class="num" id="3895935">2</span><span class="op" id="3895936">+</span><span class="ident" id="3895937"><a href="/crypto/tls/handshake_messages.go.html#3895845">cipherSuiteLen</a></span>&nbsp;<span class="op" id="3895952">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3895956">return</span>&nbsp;<span class="builtintype" id="3895963">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3895970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3895973">numCipherSuites</span>&nbsp;<span class="op" id="3895989">:=</span>&nbsp;<span class="ident" id="3895992"><a href="/crypto/tls/handshake_messages.go.html#3895845">cipherSuiteLen</a></span>&nbsp;<span class="op" id="3896007">/</span>&nbsp;<span class="num" id="3896009">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3896012"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3896013">.</span><span class="ident" id="3896014">cipherSuites</span>&nbsp;<span class="op" id="3896027">=</span>&nbsp;<span class="builtinfunc" id="3896029">make</span><span class="op" id="3896033">(</span><span class="op" id="3896034">[</span><span class="op" id="3896035">]</span><span class="builtintype" id="3896036">uint16</span><span class="op" id="3896042">,</span>&nbsp;<span class="ident" id="3896044"><a href="/crypto/tls/handshake_messages.go.html#3895973">numCipherSuites</a></span><span class="op" id="3896059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3896062">for</span>&nbsp;<span class="ident" id="3896066">i</span>&nbsp;<span class="op" id="3896068">:=</span>&nbsp;<span class="num" id="3896071">0</span><span class="op" id="3896072">;</span>&nbsp;<span class="ident" id="3896074"><a href="/crypto/tls/handshake_messages.go.html#3896066">i</a></span>&nbsp;<span class="op" id="3896076">&lt;</span>&nbsp;<span class="ident" id="3896078"><a href="/crypto/tls/handshake_messages.go.html#3895973">numCipherSuites</a></span><span class="op" id="3896093">;</span>&nbsp;<span class="ident" id="3896095"><a href="/crypto/tls/handshake_messages.go.html#3896066">i</a></span><span class="op" id="3896096">++</span>&nbsp;<span class="op" id="3896099">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3896103"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3896104">.</span><span class="ident" id="3896105">cipherSuites</span><span class="op" id="3896117">[</span><span class="ident" id="3896118"><a href="/crypto/tls/handshake_messages.go.html#3896066">i</a></span><span class="op" id="3896119">]</span>&nbsp;<span class="op" id="3896121">=</span>&nbsp;<span class="builtintype" id="3896123">uint16</span><span class="op" id="3896129">(</span><span class="ident" id="3896130"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3896134">[</span><span class="num" id="3896135">2</span><span class="op" id="3896136">+</span><span class="num" id="3896137">2</span><span class="op" id="3896138">*</span><span class="ident" id="3896139"><a href="/crypto/tls/handshake_messages.go.html#3896066">i</a></span><span class="op" id="3896140">]</span><span class="op" id="3896141">)</span><span class="op" id="3896142">&lt;&lt;</span><span class="num" id="3896144">8</span>&nbsp;<span class="op" id="3896146">|</span>&nbsp;<span class="builtintype" id="3896148">uint16</span><span class="op" id="3896154">(</span><span class="ident" id="3896155"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3896159">[</span><span class="num" id="3896160">3</span><span class="op" id="3896161">+</span><span class="num" id="3896162">2</span><span class="op" id="3896163">*</span><span class="ident" id="3896164"><a href="/crypto/tls/handshake_messages.go.html#3896066">i</a></span><span class="op" id="3896165">]</span><span class="op" id="3896166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3896170">if</span>&nbsp;<span class="ident" id="3896173"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3896174">.</span><span class="ident" id="3896175">cipherSuites</span><span class="op" id="3896187">[</span><span class="ident" id="3896188"><a href="/crypto/tls/handshake_messages.go.html#3896066">i</a></span><span class="op" id="3896189">]</span>&nbsp;<span class="op" id="3896191">==</span>&nbsp;<span class="ident" id="3896194"><a href="/crypto/tls/common.go.html#3824475">scsvRenegotiation</a></span>&nbsp;<span class="op" id="3896212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3896217"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3896218">.</span><span class="ident" id="3896219">secureRenegotiation</span>&nbsp;<span class="op" id="3896239">=</span>&nbsp;<span class="builtintype" id="3896241">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3896248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3896251">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3896254"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span>&nbsp;<span class="op" id="3896259">=</span>&nbsp;<span class="ident" id="3896261"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3896265">[</span><span class="num" id="3896266">2</span><span class="op" id="3896267">+</span><span class="ident" id="3896268"><a href="/crypto/tls/handshake_messages.go.html#3895845">cipherSuiteLen</a></span><span class="op" id="3896282">:</span><span class="op" id="3896283">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3896286">if</span>&nbsp;<span class="builtinfunc" id="3896289">len</span><span class="op" id="3896292">(</span><span class="ident" id="3896293"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3896297">)</span>&nbsp;<span class="op" id="3896299">&lt;</span>&nbsp;<span class="num" id="3896301">1</span>&nbsp;<span class="op" id="3896303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3896307">return</span>&nbsp;<span class="builtintype" id="3896314">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3896321">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3896324">compressionMethodsLen</span>&nbsp;<span class="op" id="3896346">:=</span>&nbsp;<span class="builtintype" id="3896349">int</span><span class="op" id="3896352">(</span><span class="ident" id="3896353"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3896357">[</span><span class="num" id="3896358">0</span><span class="op" id="3896359">]</span><span class="op" id="3896360">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3896363">if</span>&nbsp;<span class="builtinfunc" id="3896366">len</span><span class="op" id="3896369">(</span><span class="ident" id="3896370"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3896374">)</span>&nbsp;<span class="op" id="3896376">&lt;</span>&nbsp;<span class="num" id="3896378">1</span><span class="op" id="3896379">+</span><span class="ident" id="3896380"><a href="/crypto/tls/handshake_messages.go.html#3896324">compressionMethodsLen</a></span>&nbsp;<span class="op" id="3896402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3896406">return</span>&nbsp;<span class="builtintype" id="3896413">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3896420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3896423"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3896424">.</span><span class="ident" id="3896425">compressionMethods</span>&nbsp;<span class="op" id="3896444">=</span>&nbsp;<span class="ident" id="3896446"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3896450">[</span><span class="num" id="3896451">1</span>&nbsp;<span class="op" id="3896453">:</span>&nbsp;<span class="num" id="3896455">1</span><span class="op" id="3896456">+</span><span class="ident" id="3896457"><a href="/crypto/tls/handshake_messages.go.html#3896324">compressionMethodsLen</a></span><span class="op" id="3896478">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3896482"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span>&nbsp;<span class="op" id="3896487">=</span>&nbsp;<span class="ident" id="3896489"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3896493">[</span><span class="num" id="3896494">1</span><span class="op" id="3896495">+</span><span class="ident" id="3896496"><a href="/crypto/tls/handshake_messages.go.html#3896324">compressionMethodsLen</a></span><span class="op" id="3896517">:</span><span class="op" id="3896518">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3896522"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3896523">.</span><span class="ident" id="3896524">nextProtoNeg</span>&nbsp;<span class="op" id="3896537">=</span>&nbsp;<span class="builtintype" id="3896539">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3896546"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3896547">.</span><span class="ident" id="3896548">serverName</span>&nbsp;<span class="op" id="3896559">=</span>&nbsp;<span class="string" id="3896561">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3896565"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3896566">.</span><span class="ident" id="3896567">ocspStapling</span>&nbsp;<span class="op" id="3896580">=</span>&nbsp;<span class="builtintype" id="3896582">false</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3896589"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3896590">.</span><span class="ident" id="3896591">ticketSupported</span>&nbsp;<span class="op" id="3896607">=</span>&nbsp;<span class="builtintype" id="3896609">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3896616"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3896617">.</span><span class="ident" id="3896618">sessionTicket</span>&nbsp;<span class="op" id="3896632">=</span>&nbsp;<span class="ident" id="3896634">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3896639"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3896640">.</span><span class="ident" id="3896641">signatureAndHashes</span>&nbsp;<span class="op" id="3896660">=</span>&nbsp;<span class="ident" id="3896662">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3896667"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3896668">.</span><span class="ident" id="3896669">alpnProtocols</span>&nbsp;<span class="op" id="3896683">=</span>&nbsp;<span class="ident" id="3896685">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3896691">if</span>&nbsp;<span class="builtinfunc" id="3896694">len</span><span class="op" id="3896697">(</span><span class="ident" id="3896698"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3896702">)</span>&nbsp;<span class="op" id="3896704">==</span>&nbsp;<span class="num" id="3896707">0</span>&nbsp;<span class="op" id="3896709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3896713">//&nbsp;ClientHello&nbsp;is&nbsp;optionally&nbsp;followed&nbsp;by&nbsp;extension&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3896771">return</span>&nbsp;<span class="builtintype" id="3896778">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3896784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3896787">if</span>&nbsp;<span class="builtinfunc" id="3896790">len</span><span class="op" id="3896793">(</span><span class="ident" id="3896794"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3896798">)</span>&nbsp;<span class="op" id="3896800">&lt;</span>&nbsp;<span class="num" id="3896802">2</span>&nbsp;<span class="op" id="3896804">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3896808">return</span>&nbsp;<span class="builtintype" id="3896815">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3896822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3896826">extensionsLength</span>&nbsp;<span class="op" id="3896843">:=</span>&nbsp;<span class="builtintype" id="3896846">int</span><span class="op" id="3896849">(</span><span class="ident" id="3896850"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3896854">[</span><span class="num" id="3896855">0</span><span class="op" id="3896856">]</span><span class="op" id="3896857">)</span><span class="op" id="3896858">&lt;&lt;</span><span class="num" id="3896860">8</span>&nbsp;<span class="op" id="3896862">|</span>&nbsp;<span class="builtintype" id="3896864">int</span><span class="op" id="3896867">(</span><span class="ident" id="3896868"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3896872">[</span><span class="num" id="3896873">1</span><span class="op" id="3896874">]</span><span class="op" id="3896875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3896878"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span>&nbsp;<span class="op" id="3896883">=</span>&nbsp;<span class="ident" id="3896885"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3896889">[</span><span class="num" id="3896890">2</span><span class="op" id="3896891">:</span><span class="op" id="3896892">]</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3896895">if</span>&nbsp;<span class="ident" id="3896898"><a href="/crypto/tls/handshake_messages.go.html#3896826">extensionsLength</a></span>&nbsp;<span class="op" id="3896915">!=</span>&nbsp;<span class="builtinfunc" id="3896918">len</span><span class="op" id="3896921">(</span><span class="ident" id="3896922"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3896926">)</span>&nbsp;<span class="op" id="3896928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3896932">return</span>&nbsp;<span class="builtintype" id="3896939">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3896946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3896950">for</span>&nbsp;<span class="builtinfunc" id="3896954">len</span><span class="op" id="3896957">(</span><span class="ident" id="3896958"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3896962">)</span>&nbsp;<span class="op" id="3896964">!=</span>&nbsp;<span class="num" id="3896967">0</span>&nbsp;<span class="op" id="3896969">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3896973">if</span>&nbsp;<span class="builtinfunc" id="3896976">len</span><span class="op" id="3896979">(</span><span class="ident" id="3896980"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3896984">)</span>&nbsp;<span class="op" id="3896986">&lt;</span>&nbsp;<span class="num" id="3896988">4</span>&nbsp;<span class="op" id="3896990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3896995">return</span>&nbsp;<span class="builtintype" id="3897002">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3897010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3897014">extension</span>&nbsp;<span class="op" id="3897024">:=</span>&nbsp;<span class="builtintype" id="3897027">uint16</span><span class="op" id="3897033">(</span><span class="ident" id="3897034"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3897038">[</span><span class="num" id="3897039">0</span><span class="op" id="3897040">]</span><span class="op" id="3897041">)</span><span class="op" id="3897042">&lt;&lt;</span><span class="num" id="3897044">8</span>&nbsp;<span class="op" id="3897046">|</span>&nbsp;<span class="builtintype" id="3897048">uint16</span><span class="op" id="3897054">(</span><span class="ident" id="3897055"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3897059">[</span><span class="num" id="3897060">1</span><span class="op" id="3897061">]</span><span class="op" id="3897062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3897066">length</span>&nbsp;<span class="op" id="3897073">:=</span>&nbsp;<span class="builtintype" id="3897076">int</span><span class="op" id="3897079">(</span><span class="ident" id="3897080"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3897084">[</span><span class="num" id="3897085">2</span><span class="op" id="3897086">]</span><span class="op" id="3897087">)</span><span class="op" id="3897088">&lt;&lt;</span><span class="num" id="3897090">8</span>&nbsp;<span class="op" id="3897092">|</span>&nbsp;<span class="builtintype" id="3897094">int</span><span class="op" id="3897097">(</span><span class="ident" id="3897098"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3897102">[</span><span class="num" id="3897103">3</span><span class="op" id="3897104">]</span><span class="op" id="3897105">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3897109"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span>&nbsp;<span class="op" id="3897114">=</span>&nbsp;<span class="ident" id="3897116"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3897120">[</span><span class="num" id="3897121">4</span><span class="op" id="3897122">:</span><span class="op" id="3897123">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3897127">if</span>&nbsp;<span class="builtinfunc" id="3897130">len</span><span class="op" id="3897133">(</span><span class="ident" id="3897134"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3897138">)</span>&nbsp;<span class="op" id="3897140">&lt;</span>&nbsp;<span class="ident" id="3897142"><a href="/crypto/tls/handshake_messages.go.html#3897066">length</a></span>&nbsp;<span class="op" id="3897149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3897154">return</span>&nbsp;<span class="builtintype" id="3897161">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3897169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3897174">switch</span>&nbsp;<span class="ident" id="3897181"><a href="/crypto/tls/handshake_messages.go.html#3897014">extension</a></span>&nbsp;<span class="op" id="3897191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3897195">case</span>&nbsp;<span class="ident" id="3897200"><a href="/crypto/tls/common.go.html#3824023">extensionServerName</a></span><span class="op" id="3897219">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3897224">if</span>&nbsp;<span class="ident" id="3897227"><a href="/crypto/tls/handshake_messages.go.html#3897066">length</a></span>&nbsp;<span class="op" id="3897234">&lt;</span>&nbsp;<span class="num" id="3897236">2</span>&nbsp;<span class="op" id="3897238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3897244">return</span>&nbsp;<span class="builtintype" id="3897251">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3897260">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3897265">numNames</span>&nbsp;<span class="op" id="3897274">:=</span>&nbsp;<span class="builtintype" id="3897277">int</span><span class="op" id="3897280">(</span><span class="ident" id="3897281"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3897285">[</span><span class="num" id="3897286">0</span><span class="op" id="3897287">]</span><span class="op" id="3897288">)</span><span class="op" id="3897289">&lt;&lt;</span><span class="num" id="3897291">8</span>&nbsp;<span class="op" id="3897293">|</span>&nbsp;<span class="builtintype" id="3897295">int</span><span class="op" id="3897298">(</span><span class="ident" id="3897299"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3897303">[</span><span class="num" id="3897304">1</span><span class="op" id="3897305">]</span><span class="op" id="3897306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3897311">d</span>&nbsp;<span class="op" id="3897313">:=</span>&nbsp;<span class="ident" id="3897316"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3897320">[</span><span class="num" id="3897321">2</span><span class="op" id="3897322">:</span><span class="op" id="3897323">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3897328">for</span>&nbsp;<span class="ident" id="3897332">i</span>&nbsp;<span class="op" id="3897334">:=</span>&nbsp;<span class="num" id="3897337">0</span><span class="op" id="3897338">;</span>&nbsp;<span class="ident" id="3897340"><a href="/crypto/tls/handshake_messages.go.html#3897332">i</a></span>&nbsp;<span class="op" id="3897342">&lt;</span>&nbsp;<span class="ident" id="3897344"><a href="/crypto/tls/handshake_messages.go.html#3897265">numNames</a></span><span class="op" id="3897352">;</span>&nbsp;<span class="ident" id="3897354"><a href="/crypto/tls/handshake_messages.go.html#3897332">i</a></span><span class="op" id="3897355">++</span>&nbsp;<span class="op" id="3897358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3897364">if</span>&nbsp;<span class="builtinfunc" id="3897367">len</span><span class="op" id="3897370">(</span><span class="ident" id="3897371"><a href="/crypto/tls/handshake_messages.go.html#3897311">d</a></span><span class="op" id="3897372">)</span>&nbsp;<span class="op" id="3897374">&lt;</span>&nbsp;<span class="num" id="3897376">3</span>&nbsp;<span class="op" id="3897378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3897385">return</span>&nbsp;<span class="builtintype" id="3897392">false</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3897402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3897408">nameType</span>&nbsp;<span class="op" id="3897417">:=</span>&nbsp;<span class="ident" id="3897420"><a href="/crypto/tls/handshake_messages.go.html#3897311">d</a></span><span class="op" id="3897421">[</span><span class="num" id="3897422">0</span><span class="op" id="3897423">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3897429">nameLen</span>&nbsp;<span class="op" id="3897437">:=</span>&nbsp;<span class="builtintype" id="3897440">int</span><span class="op" id="3897443">(</span><span class="ident" id="3897444"><a href="/crypto/tls/handshake_messages.go.html#3897311">d</a></span><span class="op" id="3897445">[</span><span class="num" id="3897446">1</span><span class="op" id="3897447">]</span><span class="op" id="3897448">)</span><span class="op" id="3897449">&lt;&lt;</span><span class="num" id="3897451">8</span>&nbsp;<span class="op" id="3897453">|</span>&nbsp;<span class="builtintype" id="3897455">int</span><span class="op" id="3897458">(</span><span class="ident" id="3897459"><a href="/crypto/tls/handshake_messages.go.html#3897311">d</a></span><span class="op" id="3897460">[</span><span class="num" id="3897461">2</span><span class="op" id="3897462">]</span><span class="op" id="3897463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3897469"><a href="/crypto/tls/handshake_messages.go.html#3897311">d</a></span>&nbsp;<span class="op" id="3897471">=</span>&nbsp;<span class="ident" id="3897473"><a href="/crypto/tls/handshake_messages.go.html#3897311">d</a></span><span class="op" id="3897474">[</span><span class="num" id="3897475">3</span><span class="op" id="3897476">:</span><span class="op" id="3897477">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3897483">if</span>&nbsp;<span class="builtinfunc" id="3897486">len</span><span class="op" id="3897489">(</span><span class="ident" id="3897490"><a href="/crypto/tls/handshake_messages.go.html#3897311">d</a></span><span class="op" id="3897491">)</span>&nbsp;<span class="op" id="3897493">&lt;</span>&nbsp;<span class="ident" id="3897495"><a href="/crypto/tls/handshake_messages.go.html#3897429">nameLen</a></span>&nbsp;<span class="op" id="3897503">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3897510">return</span>&nbsp;<span class="builtintype" id="3897517">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3897527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3897533">if</span>&nbsp;<span class="ident" id="3897536"><a href="/crypto/tls/handshake_messages.go.html#3897408">nameType</a></span>&nbsp;<span class="op" id="3897545">==</span>&nbsp;<span class="num" id="3897548">0</span>&nbsp;<span class="op" id="3897550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3897557"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3897558">.</span><span class="ident" id="3897559">serverName</span>&nbsp;<span class="op" id="3897570">=</span>&nbsp;<span class="builtintype" id="3897572">string</span><span class="op" id="3897578">(</span><span class="ident" id="3897579"><a href="/crypto/tls/handshake_messages.go.html#3897311">d</a></span><span class="op" id="3897580">[</span><span class="num" id="3897581">0</span><span class="op" id="3897582">:</span><span class="ident" id="3897583"><a href="/crypto/tls/handshake_messages.go.html#3897429">nameLen</a></span><span class="op" id="3897590">]</span><span class="op" id="3897591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3897598">break</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3897608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3897614"><a href="/crypto/tls/handshake_messages.go.html#3897311">d</a></span>&nbsp;<span class="op" id="3897616">=</span>&nbsp;<span class="ident" id="3897618"><a href="/crypto/tls/handshake_messages.go.html#3897311">d</a></span><span class="op" id="3897619">[</span><span class="ident" id="3897620"><a href="/crypto/tls/handshake_messages.go.html#3897429">nameLen</a></span><span class="op" id="3897627">:</span><span class="op" id="3897628">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3897633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3897637">case</span>&nbsp;<span class="ident" id="3897642"><a href="/crypto/tls/common.go.html#3824315">extensionNextProtoNeg</a></span><span class="op" id="3897663">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3897668">if</span>&nbsp;<span class="ident" id="3897671"><a href="/crypto/tls/handshake_messages.go.html#3897066">length</a></span>&nbsp;<span class="op" id="3897678">&gt;</span>&nbsp;<span class="num" id="3897680">0</span>&nbsp;<span class="op" id="3897682">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3897688">return</span>&nbsp;<span class="builtintype" id="3897695">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3897704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3897709"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3897710">.</span><span class="ident" id="3897711">nextProtoNeg</span>&nbsp;<span class="op" id="3897724">=</span>&nbsp;<span class="builtintype" id="3897726">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3897733">case</span>&nbsp;<span class="ident" id="3897738"><a href="/crypto/tls/common.go.html#3824064">extensionStatusRequest</a></span><span class="op" id="3897760">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3897765"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3897766">.</span><span class="ident" id="3897767">ocspStapling</span>&nbsp;<span class="op" id="3897780">=</span>&nbsp;<span class="ident" id="3897782"><a href="/crypto/tls/handshake_messages.go.html#3897066">length</a></span>&nbsp;<span class="op" id="3897789">&gt;</span>&nbsp;<span class="num" id="3897791">0</span>&nbsp;<span class="op" id="3897793">&amp;&amp;</span>&nbsp;<span class="ident" id="3897796"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3897800">[</span><span class="num" id="3897801">0</span><span class="op" id="3897802">]</span>&nbsp;<span class="op" id="3897804">==</span>&nbsp;<span class="ident" id="3897807"><a href="/crypto/tls/common.go.html#3824989">statusTypeOCSP</a></span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3897824">case</span>&nbsp;<span class="ident" id="3897829"><a href="/crypto/tls/common.go.html#3824105">extensionSupportedCurves</a></span><span class="op" id="3897853">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3897858">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3897913">if</span>&nbsp;<span class="ident" id="3897916"><a href="/crypto/tls/handshake_messages.go.html#3897066">length</a></span>&nbsp;<span class="op" id="3897923">&lt;</span>&nbsp;<span class="num" id="3897925">2</span>&nbsp;<span class="op" id="3897927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3897933">return</span>&nbsp;<span class="builtintype" id="3897940">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3897949">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3897954">l</span>&nbsp;<span class="op" id="3897956">:=</span>&nbsp;<span class="builtintype" id="3897959">int</span><span class="op" id="3897962">(</span><span class="ident" id="3897963"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3897967">[</span><span class="num" id="3897968">0</span><span class="op" id="3897969">]</span><span class="op" id="3897970">)</span><span class="op" id="3897971">&lt;&lt;</span><span class="num" id="3897973">8</span>&nbsp;<span class="op" id="3897975">|</span>&nbsp;<span class="builtintype" id="3897977">int</span><span class="op" id="3897980">(</span><span class="ident" id="3897981"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3897985">[</span><span class="num" id="3897986">1</span><span class="op" id="3897987">]</span><span class="op" id="3897988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3897993">if</span>&nbsp;<span class="ident" id="3897996"><a href="/crypto/tls/handshake_messages.go.html#3897954">l</a></span><span class="op" id="3897997">%</span><span class="num" id="3897998">2</span>&nbsp;<span class="op" id="3898000">==</span>&nbsp;<span class="num" id="3898003">1</span>&nbsp;<span class="op" id="3898005">||</span>&nbsp;<span class="ident" id="3898008"><a href="/crypto/tls/handshake_messages.go.html#3897066">length</a></span>&nbsp;<span class="op" id="3898015">!=</span>&nbsp;<span class="ident" id="3898018"><a href="/crypto/tls/handshake_messages.go.html#3897954">l</a></span><span class="op" id="3898019">+</span><span class="num" id="3898020">2</span>&nbsp;<span class="op" id="3898022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3898028">return</span>&nbsp;<span class="builtintype" id="3898035">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3898044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3898049">numCurves</span>&nbsp;<span class="op" id="3898059">:=</span>&nbsp;<span class="ident" id="3898062"><a href="/crypto/tls/handshake_messages.go.html#3897954">l</a></span>&nbsp;<span class="op" id="3898064">/</span>&nbsp;<span class="num" id="3898066">2</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3898071"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3898072">.</span><span class="ident" id="3898073">supportedCurves</span>&nbsp;<span class="op" id="3898089">=</span>&nbsp;<span class="builtinfunc" id="3898091">make</span><span class="op" id="3898095">(</span><span class="op" id="3898096">[</span><span class="op" id="3898097">]</span><span class="ident" id="3898098"><a href="/crypto/tls/common.go.html#3824673">CurveID</a></span><span class="op" id="3898105">,</span>&nbsp;<span class="ident" id="3898107"><a href="/crypto/tls/handshake_messages.go.html#3898049">numCurves</a></span><span class="op" id="3898116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3898121">d</span>&nbsp;<span class="op" id="3898123">:=</span>&nbsp;<span class="ident" id="3898126"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3898130">[</span><span class="num" id="3898131">2</span><span class="op" id="3898132">:</span><span class="op" id="3898133">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3898138">for</span>&nbsp;<span class="ident" id="3898142">i</span>&nbsp;<span class="op" id="3898144">:=</span>&nbsp;<span class="num" id="3898147">0</span><span class="op" id="3898148">;</span>&nbsp;<span class="ident" id="3898150"><a href="/crypto/tls/handshake_messages.go.html#3898142">i</a></span>&nbsp;<span class="op" id="3898152">&lt;</span>&nbsp;<span class="ident" id="3898154"><a href="/crypto/tls/handshake_messages.go.html#3898049">numCurves</a></span><span class="op" id="3898163">;</span>&nbsp;<span class="ident" id="3898165"><a href="/crypto/tls/handshake_messages.go.html#3898142">i</a></span><span class="op" id="3898166">++</span>&nbsp;<span class="op" id="3898169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3898175"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3898176">.</span><span class="ident" id="3898177">supportedCurves</span><span class="op" id="3898192">[</span><span class="ident" id="3898193"><a href="/crypto/tls/handshake_messages.go.html#3898142">i</a></span><span class="op" id="3898194">]</span>&nbsp;<span class="op" id="3898196">=</span>&nbsp;<span class="ident" id="3898198"><a href="/crypto/tls/common.go.html#3824673">CurveID</a></span><span class="op" id="3898205">(</span><span class="ident" id="3898206"><a href="/crypto/tls/handshake_messages.go.html#3898121">d</a></span><span class="op" id="3898207">[</span><span class="num" id="3898208">0</span><span class="op" id="3898209">]</span><span class="op" id="3898210">)</span><span class="op" id="3898211">&lt;&lt;</span><span class="num" id="3898213">8</span>&nbsp;<span class="op" id="3898215">|</span>&nbsp;<span class="ident" id="3898217"><a href="/crypto/tls/common.go.html#3824673">CurveID</a></span><span class="op" id="3898224">(</span><span class="ident" id="3898225"><a href="/crypto/tls/handshake_messages.go.html#3898121">d</a></span><span class="op" id="3898226">[</span><span class="num" id="3898227">1</span><span class="op" id="3898228">]</span><span class="op" id="3898229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3898235"><a href="/crypto/tls/handshake_messages.go.html#3898121">d</a></span>&nbsp;<span class="op" id="3898237">=</span>&nbsp;<span class="ident" id="3898239"><a href="/crypto/tls/handshake_messages.go.html#3898121">d</a></span><span class="op" id="3898240">[</span><span class="num" id="3898241">2</span><span class="op" id="3898242">:</span><span class="op" id="3898243">]</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3898248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3898252">case</span>&nbsp;<span class="ident" id="3898257"><a href="/crypto/tls/common.go.html#3824147">extensionSupportedPoints</a></span><span class="op" id="3898281">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3898286">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3898341">if</span>&nbsp;<span class="ident" id="3898344"><a href="/crypto/tls/handshake_messages.go.html#3897066">length</a></span>&nbsp;<span class="op" id="3898351">&lt;</span>&nbsp;<span class="num" id="3898353">1</span>&nbsp;<span class="op" id="3898355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3898361">return</span>&nbsp;<span class="builtintype" id="3898368">false</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3898377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3898382">l</span>&nbsp;<span class="op" id="3898384">:=</span>&nbsp;<span class="builtintype" id="3898387">int</span><span class="op" id="3898390">(</span><span class="ident" id="3898391"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3898395">[</span><span class="num" id="3898396">0</span><span class="op" id="3898397">]</span><span class="op" id="3898398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3898403">if</span>&nbsp;<span class="ident" id="3898406"><a href="/crypto/tls/handshake_messages.go.html#3897066">length</a></span>&nbsp;<span class="op" id="3898413">!=</span>&nbsp;<span class="ident" id="3898416"><a href="/crypto/tls/handshake_messages.go.html#3898382">l</a></span><span class="op" id="3898417">+</span><span class="num" id="3898418">1</span>&nbsp;<span class="op" id="3898420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3898426">return</span>&nbsp;<span class="builtintype" id="3898433">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3898442">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3898447"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3898448">.</span><span class="ident" id="3898449">supportedPoints</span>&nbsp;<span class="op" id="3898465">=</span>&nbsp;<span class="builtinfunc" id="3898467">make</span><span class="op" id="3898471">(</span><span class="op" id="3898472">[</span><span class="op" id="3898473">]</span><span class="builtintype" id="3898474">uint8</span><span class="op" id="3898479">,</span>&nbsp;<span class="ident" id="3898481"><a href="/crypto/tls/handshake_messages.go.html#3898382">l</a></span><span class="op" id="3898482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3898487">copy</span><span class="op" id="3898491">(</span><span class="ident" id="3898492"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3898493">.</span><span class="ident" id="3898494">supportedPoints</span><span class="op" id="3898509">,</span>&nbsp;<span class="ident" id="3898511"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3898515">[</span><span class="num" id="3898516">1</span><span class="op" id="3898517">:</span><span class="op" id="3898518">]</span><span class="op" id="3898519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3898523">case</span>&nbsp;<span class="ident" id="3898528"><a href="/crypto/tls/common.go.html#3824273">extensionSessionTicket</a></span><span class="op" id="3898550">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3898555">//&nbsp;http://tools.ietf.org/html/rfc5077#section-3.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3898608"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3898609">.</span><span class="ident" id="3898610">ticketSupported</span>&nbsp;<span class="op" id="3898626">=</span>&nbsp;<span class="builtintype" id="3898628">true</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3898636"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3898637">.</span><span class="ident" id="3898638">sessionTicket</span>&nbsp;<span class="op" id="3898652">=</span>&nbsp;<span class="ident" id="3898654"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3898658">[</span><span class="op" id="3898659">:</span><span class="ident" id="3898660"><a href="/crypto/tls/handshake_messages.go.html#3897066">length</a></span><span class="op" id="3898666">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3898670">case</span>&nbsp;<span class="ident" id="3898675"><a href="/crypto/tls/common.go.html#3824189">extensionSignatureAlgorithms</a></span><span class="op" id="3898703">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3898708">//&nbsp;https://tools.ietf.org/html/rfc5246#section-7.4.1.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3898768">if</span>&nbsp;<span class="ident" id="3898771"><a href="/crypto/tls/handshake_messages.go.html#3897066">length</a></span>&nbsp;<span class="op" id="3898778">&lt;</span>&nbsp;<span class="num" id="3898780">2</span>&nbsp;<span class="op" id="3898782">||</span>&nbsp;<span class="ident" id="3898785"><a href="/crypto/tls/handshake_messages.go.html#3897066">length</a></span><span class="op" id="3898791">&amp;</span><span class="num" id="3898792">1</span>&nbsp;<span class="op" id="3898794">!=</span>&nbsp;<span class="num" id="3898797">0</span>&nbsp;<span class="op" id="3898799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3898805">return</span>&nbsp;<span class="builtintype" id="3898812">false</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3898821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3898826">l</span>&nbsp;<span class="op" id="3898828">:=</span>&nbsp;<span class="builtintype" id="3898831">int</span><span class="op" id="3898834">(</span><span class="ident" id="3898835"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3898839">[</span><span class="num" id="3898840">0</span><span class="op" id="3898841">]</span><span class="op" id="3898842">)</span><span class="op" id="3898843">&lt;&lt;</span><span class="num" id="3898845">8</span>&nbsp;<span class="op" id="3898847">|</span>&nbsp;<span class="builtintype" id="3898849">int</span><span class="op" id="3898852">(</span><span class="ident" id="3898853"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3898857">[</span><span class="num" id="3898858">1</span><span class="op" id="3898859">]</span><span class="op" id="3898860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3898865">if</span>&nbsp;<span class="ident" id="3898868"><a href="/crypto/tls/handshake_messages.go.html#3898826">l</a></span>&nbsp;<span class="op" id="3898870">!=</span>&nbsp;<span class="ident" id="3898873"><a href="/crypto/tls/handshake_messages.go.html#3897066">length</a></span><span class="op" id="3898879">-</span><span class="num" id="3898880">2</span>&nbsp;<span class="op" id="3898882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3898888">return</span>&nbsp;<span class="builtintype" id="3898895">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3898904">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3898909">n</span>&nbsp;<span class="op" id="3898911">:=</span>&nbsp;<span class="ident" id="3898914"><a href="/crypto/tls/handshake_messages.go.html#3898826">l</a></span>&nbsp;<span class="op" id="3898916">/</span>&nbsp;<span class="num" id="3898918">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3898923">d</span>&nbsp;<span class="op" id="3898925">:=</span>&nbsp;<span class="ident" id="3898928"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3898932">[</span><span class="num" id="3898933">2</span><span class="op" id="3898934">:</span><span class="op" id="3898935">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3898940"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3898941">.</span><span class="ident" id="3898942">signatureAndHashes</span>&nbsp;<span class="op" id="3898961">=</span>&nbsp;<span class="builtinfunc" id="3898963">make</span><span class="op" id="3898967">(</span><span class="op" id="3898968">[</span><span class="op" id="3898969">]</span><span class="ident" id="3898970"><a href="/crypto/tls/common.go.html#3826090">signatureAndHash</a></span><span class="op" id="3898986">,</span>&nbsp;<span class="ident" id="3898988"><a href="/crypto/tls/handshake_messages.go.html#3898909">n</a></span><span class="op" id="3898989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3898994">for</span>&nbsp;<span class="ident" id="3898998">i</span>&nbsp;<span class="op" id="3899000">:=</span>&nbsp;<span class="keyword" id="3899003">range</span>&nbsp;<span class="ident" id="3899009"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3899010">.</span><span class="ident" id="3899011">signatureAndHashes</span>&nbsp;<span class="op" id="3899030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3899036"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3899037">.</span><span class="ident" id="3899038">signatureAndHashes</span><span class="op" id="3899056">[</span><span class="ident" id="3899057"><a href="/crypto/tls/handshake_messages.go.html#3898998">i</a></span><span class="op" id="3899058">]</span><span class="op" id="3899059">.</span><span class="ident" id="3899060">hash</span>&nbsp;<span class="op" id="3899065">=</span>&nbsp;<span class="ident" id="3899067"><a href="/crypto/tls/handshake_messages.go.html#3898923">d</a></span><span class="op" id="3899068">[</span><span class="num" id="3899069">0</span><span class="op" id="3899070">]</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3899076"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3899077">.</span><span class="ident" id="3899078">signatureAndHashes</span><span class="op" id="3899096">[</span><span class="ident" id="3899097"><a href="/crypto/tls/handshake_messages.go.html#3898998">i</a></span><span class="op" id="3899098">]</span><span class="op" id="3899099">.</span><span class="ident" id="3899100">signature</span>&nbsp;<span class="op" id="3899110">=</span>&nbsp;<span class="ident" id="3899112"><a href="/crypto/tls/handshake_messages.go.html#3898923">d</a></span><span class="op" id="3899113">[</span><span class="num" id="3899114">1</span><span class="op" id="3899115">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3899121"><a href="/crypto/tls/handshake_messages.go.html#3898923">d</a></span>&nbsp;<span class="op" id="3899123">=</span>&nbsp;<span class="ident" id="3899125"><a href="/crypto/tls/handshake_messages.go.html#3898923">d</a></span><span class="op" id="3899126">[</span><span class="num" id="3899127">2</span><span class="op" id="3899128">:</span><span class="op" id="3899129">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3899134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3899138">case</span>&nbsp;<span class="ident" id="3899143"><a href="/crypto/tls/common.go.html#3824381">extensionRenegotiationInfo</a></span>&nbsp;<span class="op" id="3899170">+</span>&nbsp;<span class="num" id="3899172">1</span><span class="op" id="3899173">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3899178">if</span>&nbsp;<span class="ident" id="3899181"><a href="/crypto/tls/handshake_messages.go.html#3897066">length</a></span>&nbsp;<span class="op" id="3899188">!=</span>&nbsp;<span class="num" id="3899191">1</span>&nbsp;<span class="op" id="3899193">||</span>&nbsp;<span class="ident" id="3899196"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3899200">[</span><span class="num" id="3899201">0</span><span class="op" id="3899202">]</span>&nbsp;<span class="op" id="3899204">!=</span>&nbsp;<span class="num" id="3899207">0</span>&nbsp;<span class="op" id="3899209">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3899215">return</span>&nbsp;<span class="builtintype" id="3899222">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3899231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3899236"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3899237">.</span><span class="ident" id="3899238">secureRenegotiation</span>&nbsp;<span class="op" id="3899258">=</span>&nbsp;<span class="builtintype" id="3899260">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3899267">case</span>&nbsp;<span class="ident" id="3899272"><a href="/crypto/tls/common.go.html#3824231">extensionALPN</a></span><span class="op" id="3899285">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3899290">if</span>&nbsp;<span class="ident" id="3899293"><a href="/crypto/tls/handshake_messages.go.html#3897066">length</a></span>&nbsp;<span class="op" id="3899300">&lt;</span>&nbsp;<span class="num" id="3899302">2</span>&nbsp;<span class="op" id="3899304">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3899310">return</span>&nbsp;<span class="builtintype" id="3899317">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3899326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3899331">l</span>&nbsp;<span class="op" id="3899333">:=</span>&nbsp;<span class="builtintype" id="3899336">int</span><span class="op" id="3899339">(</span><span class="ident" id="3899340"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3899344">[</span><span class="num" id="3899345">0</span><span class="op" id="3899346">]</span><span class="op" id="3899347">)</span><span class="op" id="3899348">&lt;&lt;</span><span class="num" id="3899350">8</span>&nbsp;<span class="op" id="3899352">|</span>&nbsp;<span class="builtintype" id="3899354">int</span><span class="op" id="3899357">(</span><span class="ident" id="3899358"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3899362">[</span><span class="num" id="3899363">1</span><span class="op" id="3899364">]</span><span class="op" id="3899365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3899370">if</span>&nbsp;<span class="ident" id="3899373"><a href="/crypto/tls/handshake_messages.go.html#3899331">l</a></span>&nbsp;<span class="op" id="3899375">!=</span>&nbsp;<span class="ident" id="3899378"><a href="/crypto/tls/handshake_messages.go.html#3897066">length</a></span><span class="op" id="3899384">-</span><span class="num" id="3899385">2</span>&nbsp;<span class="op" id="3899387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3899393">return</span>&nbsp;<span class="builtintype" id="3899400">false</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3899409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3899414">d</span>&nbsp;<span class="op" id="3899416">:=</span>&nbsp;<span class="ident" id="3899419"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3899423">[</span><span class="num" id="3899424">2</span><span class="op" id="3899425">:</span><span class="ident" id="3899426"><a href="/crypto/tls/handshake_messages.go.html#3897066">length</a></span><span class="op" id="3899432">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3899437">for</span>&nbsp;<span class="builtinfunc" id="3899441">len</span><span class="op" id="3899444">(</span><span class="ident" id="3899445"><a href="/crypto/tls/handshake_messages.go.html#3899414">d</a></span><span class="op" id="3899446">)</span>&nbsp;<span class="op" id="3899448">!=</span>&nbsp;<span class="num" id="3899451">0</span>&nbsp;<span class="op" id="3899453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3899459">stringLen</span>&nbsp;<span class="op" id="3899469">:=</span>&nbsp;<span class="builtintype" id="3899472">int</span><span class="op" id="3899475">(</span><span class="ident" id="3899476"><a href="/crypto/tls/handshake_messages.go.html#3899414">d</a></span><span class="op" id="3899477">[</span><span class="num" id="3899478">0</span><span class="op" id="3899479">]</span><span class="op" id="3899480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3899486"><a href="/crypto/tls/handshake_messages.go.html#3899414">d</a></span>&nbsp;<span class="op" id="3899488">=</span>&nbsp;<span class="ident" id="3899490"><a href="/crypto/tls/handshake_messages.go.html#3899414">d</a></span><span class="op" id="3899491">[</span><span class="num" id="3899492">1</span><span class="op" id="3899493">:</span><span class="op" id="3899494">]</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3899500">if</span>&nbsp;<span class="ident" id="3899503"><a href="/crypto/tls/handshake_messages.go.html#3899459">stringLen</a></span>&nbsp;<span class="op" id="3899513">==</span>&nbsp;<span class="num" id="3899516">0</span>&nbsp;<span class="op" id="3899518">||</span>&nbsp;<span class="ident" id="3899521"><a href="/crypto/tls/handshake_messages.go.html#3899459">stringLen</a></span>&nbsp;<span class="op" id="3899531">&gt;</span>&nbsp;<span class="builtinfunc" id="3899533">len</span><span class="op" id="3899536">(</span><span class="ident" id="3899537"><a href="/crypto/tls/handshake_messages.go.html#3899414">d</a></span><span class="op" id="3899538">)</span>&nbsp;<span class="op" id="3899540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3899547">return</span>&nbsp;<span class="builtintype" id="3899554">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3899564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3899570"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3899571">.</span><span class="ident" id="3899572">alpnProtocols</span>&nbsp;<span class="op" id="3899586">=</span>&nbsp;<span class="builtinfunc" id="3899588">append</span><span class="op" id="3899594">(</span><span class="ident" id="3899595"><a href="/crypto/tls/handshake_messages.go.html#3895337">m</a></span><span class="op" id="3899596">.</span><span class="ident" id="3899597">alpnProtocols</span><span class="op" id="3899610">,</span>&nbsp;<span class="builtintype" id="3899612">string</span><span class="op" id="3899618">(</span><span class="ident" id="3899619"><a href="/crypto/tls/handshake_messages.go.html#3899414">d</a></span><span class="op" id="3899620">[</span><span class="op" id="3899621">:</span><span class="ident" id="3899622"><a href="/crypto/tls/handshake_messages.go.html#3899459">stringLen</a></span><span class="op" id="3899631">]</span><span class="op" id="3899632">)</span><span class="op" id="3899633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3899639"><a href="/crypto/tls/handshake_messages.go.html#3899414">d</a></span>&nbsp;<span class="op" id="3899641">=</span>&nbsp;<span class="ident" id="3899643"><a href="/crypto/tls/handshake_messages.go.html#3899414">d</a></span><span class="op" id="3899644">[</span><span class="ident" id="3899645"><a href="/crypto/tls/handshake_messages.go.html#3899459">stringLen</a></span><span class="op" id="3899654">:</span><span class="op" id="3899655">]</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3899660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3899664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3899668"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span>&nbsp;<span class="op" id="3899673">=</span>&nbsp;<span class="ident" id="3899675"><a href="/crypto/tls/handshake_messages.go.html#3895366">data</a></span><span class="op" id="3899679">[</span><span class="ident" id="3899680"><a href="/crypto/tls/handshake_messages.go.html#3897066">length</a></span><span class="op" id="3899686">:</span><span class="op" id="3899687">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3899690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3899694">return</span>&nbsp;<span class="builtintype" id="3899701">true</span><br>
<span class="lineno"></span><span class="op" id="3899706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3899709">type</span>&nbsp;<span class="ident" id="3899714">serverHelloMsg</span>&nbsp;<span class="keyword" id="3899729">struct</span>&nbsp;<span class="op" id="3899736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3899739">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3899759">[</span><span class="op" id="3899760">]</span><span class="builtintype" id="3899761">byte</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3899767">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3899787">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3899795">random</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3899815">[</span><span class="op" id="3899816">]</span><span class="builtintype" id="3899817">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3899823">sessionId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3899843">[</span><span class="op" id="3899844">]</span><span class="builtintype" id="3899845">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3899851">cipherSuite</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3899871">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3899879">compressionMethod</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3899899">uint8</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3899906">nextProtoNeg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3899926">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3899932">nextProtos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3899952">[</span><span class="op" id="3899953">]</span><span class="builtintype" id="3899954">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3899962">ocspStapling</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3899982">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3899988">ticketSupported</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3900008">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3900014">secureRenegotiation</span>&nbsp;<span class="builtintype" id="3900034">bool</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3900040">alpnProtocol</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3900060">string</span><br>
<span class="lineno"></span><span class="op" id="3900067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3900070">func</span>&nbsp;<span class="op" id="3900075">(</span><span class="ident" id="3900076">m</span>&nbsp;<span class="op" id="3900078">*</span><span class="ident" id="3900079"><a href="/crypto/tls/handshake_messages.go.html#3899714">serverHelloMsg</a></span><span class="op" id="3900093">)</span>&nbsp;<span class="ident" id="3900095">equal</span><span class="op" id="3900100">(</span><span class="ident" id="3900101">i</span>&nbsp;<span class="keyword" id="3900103">interface</span><span class="op" id="3900112">{</span><span class="op" id="3900113">}</span><span class="op" id="3900114">)</span>&nbsp;<span class="builtintype" id="3900116">bool</span>&nbsp;<span class="op" id="3900121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3900124">m1</span><span class="op" id="3900126">,</span>&nbsp;<span class="ident" id="3900128">ok</span>&nbsp;<span class="op" id="3900131">:=</span>&nbsp;<span class="ident" id="3900134"><a href="/crypto/tls/handshake_messages.go.html#3900101">i</a></span><span class="op" id="3900135">.</span><span class="op" id="3900136">(</span><span class="op" id="3900137">*</span><span class="ident" id="3900138"><a href="/crypto/tls/handshake_messages.go.html#3899714">serverHelloMsg</a></span><span class="op" id="3900152">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3900155">if</span>&nbsp;<span class="op" id="3900158">!</span><span class="ident" id="3900159"><a href="/crypto/tls/handshake_messages.go.html#3900128">ok</a></span>&nbsp;<span class="op" id="3900162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3900166">return</span>&nbsp;<span class="builtintype" id="3900173">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3900180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3900184">return</span>&nbsp;<span class="ident" id="3900191"><a href="/crypto/tls/handshake_messages.go.html#3888584">bytes</a></span><span class="op" id="3900196">.</span><span class="ident" id="3900197">Equal</span><span class="op" id="3900202">(</span><span class="ident" id="3900203"><a href="/crypto/tls/handshake_messages.go.html#3900076">m</a></span><span class="op" id="3900204">.</span><span class="ident" id="3900205">raw</span><span class="op" id="3900208">,</span>&nbsp;<span class="ident" id="3900210"><a href="/crypto/tls/handshake_messages.go.html#3900124">m1</a></span><span class="op" id="3900212">.</span><span class="ident" id="3900213">raw</span><span class="op" id="3900216">)</span>&nbsp;<span class="op" id="3900218">&amp;&amp;</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3900223"><a href="/crypto/tls/handshake_messages.go.html#3900076">m</a></span><span class="op" id="3900224">.</span><span class="ident" id="3900225">vers</span>&nbsp;<span class="op" id="3900230">==</span>&nbsp;<span class="ident" id="3900233"><a href="/crypto/tls/handshake_messages.go.html#3900124">m1</a></span><span class="op" id="3900235">.</span><span class="ident" id="3900236">vers</span>&nbsp;<span class="op" id="3900241">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3900246"><a href="/crypto/tls/handshake_messages.go.html#3888584">bytes</a></span><span class="op" id="3900251">.</span><span class="ident" id="3900252">Equal</span><span class="op" id="3900257">(</span><span class="ident" id="3900258"><a href="/crypto/tls/handshake_messages.go.html#3900076">m</a></span><span class="op" id="3900259">.</span><span class="ident" id="3900260">random</span><span class="op" id="3900266">,</span>&nbsp;<span class="ident" id="3900268"><a href="/crypto/tls/handshake_messages.go.html#3900124">m1</a></span><span class="op" id="3900270">.</span><span class="ident" id="3900271">random</span><span class="op" id="3900277">)</span>&nbsp;<span class="op" id="3900279">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3900284"><a href="/crypto/tls/handshake_messages.go.html#3888584">bytes</a></span><span class="op" id="3900289">.</span><span class="ident" id="3900290">Equal</span><span class="op" id="3900295">(</span><span class="ident" id="3900296"><a href="/crypto/tls/handshake_messages.go.html#3900076">m</a></span><span class="op" id="3900297">.</span><span class="ident" id="3900298">sessionId</span><span class="op" id="3900307">,</span>&nbsp;<span class="ident" id="3900309"><a href="/crypto/tls/handshake_messages.go.html#3900124">m1</a></span><span class="op" id="3900311">.</span><span class="ident" id="3900312">sessionId</span><span class="op" id="3900321">)</span>&nbsp;<span class="op" id="3900323">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3900328"><a href="/crypto/tls/handshake_messages.go.html#3900076">m</a></span><span class="op" id="3900329">.</span><span class="ident" id="3900330">cipherSuite</span>&nbsp;<span class="op" id="3900342">==</span>&nbsp;<span class="ident" id="3900345"><a href="/crypto/tls/handshake_messages.go.html#3900124">m1</a></span><span class="op" id="3900347">.</span><span class="ident" id="3900348">cipherSuite</span>&nbsp;<span class="op" id="3900360">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3900365"><a href="/crypto/tls/handshake_messages.go.html#3900076">m</a></span><span class="op" id="3900366">.</span><span class="ident" id="3900367">compressionMethod</span>&nbsp;<span class="op" id="3900385">==</span>&nbsp;<span class="ident" id="3900388"><a href="/crypto/tls/handshake_messages.go.html#3900124">m1</a></span><span class="op" id="3900390">.</span><span class="ident" id="3900391">compressionMethod</span>&nbsp;<span class="op" id="3900409">&amp;&amp;</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3900414"><a href="/crypto/tls/handshake_messages.go.html#3900076">m</a></span><span class="op" id="3900415">.</span><span class="ident" id="3900416">nextProtoNeg</span>&nbsp;<span class="op" id="3900429">==</span>&nbsp;<span class="ident" id="3900432"><a href="/crypto/tls/handshake_messages.go.html#3900124">m1</a></span><span class="op" id="3900434">.</span><span class="ident" id="3900435">nextProtoNeg</span>&nbsp;<span class="op" id="3900448">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3900453"><a href="/crypto/tls/handshake_messages.go.html#3918186">eqStrings</a></span><span class="op" id="3900462">(</span><span class="ident" id="3900463"><a href="/crypto/tls/handshake_messages.go.html#3900076">m</a></span><span class="op" id="3900464">.</span><span class="ident" id="3900465">nextProtos</span><span class="op" id="3900475">,</span>&nbsp;<span class="ident" id="3900477"><a href="/crypto/tls/handshake_messages.go.html#3900124">m1</a></span><span class="op" id="3900479">.</span><span class="ident" id="3900480">nextProtos</span><span class="op" id="3900490">)</span>&nbsp;<span class="op" id="3900492">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3900497"><a href="/crypto/tls/handshake_messages.go.html#3900076">m</a></span><span class="op" id="3900498">.</span><span class="ident" id="3900499">ocspStapling</span>&nbsp;<span class="op" id="3900512">==</span>&nbsp;<span class="ident" id="3900515"><a href="/crypto/tls/handshake_messages.go.html#3900124">m1</a></span><span class="op" id="3900517">.</span><span class="ident" id="3900518">ocspStapling</span>&nbsp;<span class="op" id="3900531">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3900536"><a href="/crypto/tls/handshake_messages.go.html#3900076">m</a></span><span class="op" id="3900537">.</span><span class="ident" id="3900538">ticketSupported</span>&nbsp;<span class="op" id="3900554">==</span>&nbsp;<span class="ident" id="3900557"><a href="/crypto/tls/handshake_messages.go.html#3900124">m1</a></span><span class="op" id="3900559">.</span><span class="ident" id="3900560">ticketSupported</span>&nbsp;<span class="op" id="3900576">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3900581"><a href="/crypto/tls/handshake_messages.go.html#3900076">m</a></span><span class="op" id="3900582">.</span><span class="ident" id="3900583">secureRenegotiation</span>&nbsp;<span class="op" id="3900603">==</span>&nbsp;<span class="ident" id="3900606"><a href="/crypto/tls/handshake_messages.go.html#3900124">m1</a></span><span class="op" id="3900608">.</span><span class="ident" id="3900609">secureRenegotiation</span>&nbsp;<span class="op" id="3900629">&amp;&amp;</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3900634"><a href="/crypto/tls/handshake_messages.go.html#3900076">m</a></span><span class="op" id="3900635">.</span><span class="ident" id="3900636">alpnProtocol</span>&nbsp;<span class="op" id="3900649">==</span>&nbsp;<span class="ident" id="3900652"><a href="/crypto/tls/handshake_messages.go.html#3900124">m1</a></span><span class="op" id="3900654">.</span><span class="ident" id="3900655">alpnProtocol</span><br>
<span class="lineno"></span><span class="op" id="3900668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3900671">func</span>&nbsp;<span class="op" id="3900676">(</span><span class="ident" id="3900677">m</span>&nbsp;<span class="op" id="3900679">*</span><span class="ident" id="3900680"><a href="/crypto/tls/handshake_messages.go.html#3899714">serverHelloMsg</a></span><span class="op" id="3900694">)</span>&nbsp;<span class="ident" id="3900696">marshal</span><span class="op" id="3900703">(</span><span class="op" id="3900704">)</span>&nbsp;<span class="op" id="3900706">[</span><span class="op" id="3900707">]</span><span class="builtintype" id="3900708">byte</span>&nbsp;<span class="op" id="3900713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3900716">if</span>&nbsp;<span class="ident" id="3900719"><a href="/crypto/tls/handshake_messages.go.html#3900677">m</a></span><span class="op" id="3900720">.</span><span class="ident" id="3900721">raw</span>&nbsp;<span class="op" id="3900725">!=</span>&nbsp;<span class="ident" id="3900728">nil</span>&nbsp;<span class="op" id="3900732">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3900736">return</span>&nbsp;<span class="ident" id="3900743"><a href="/crypto/tls/handshake_messages.go.html#3900677">m</a></span><span class="op" id="3900744">.</span><span class="ident" id="3900745">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3900750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3900754">length</span>&nbsp;<span class="op" id="3900761">:=</span>&nbsp;<span class="num" id="3900764">38</span>&nbsp;<span class="op" id="3900767">+</span>&nbsp;<span class="builtinfunc" id="3900769">len</span><span class="op" id="3900772">(</span><span class="ident" id="3900773"><a href="/crypto/tls/handshake_messages.go.html#3900677">m</a></span><span class="op" id="3900774">.</span><span class="ident" id="3900775">sessionId</span><span class="op" id="3900784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3900787">numExtensions</span>&nbsp;<span class="op" id="3900801">:=</span>&nbsp;<span class="num" id="3900804">0</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3900807">extensionsLength</span>&nbsp;<span class="op" id="3900824">:=</span>&nbsp;<span class="num" id="3900827">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3900831">nextProtoLen</span>&nbsp;<span class="op" id="3900844">:=</span>&nbsp;<span class="num" id="3900847">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3900850">if</span>&nbsp;<span class="ident" id="3900853"><a href="/crypto/tls/handshake_messages.go.html#3900677">m</a></span><span class="op" id="3900854">.</span><span class="ident" id="3900855">nextProtoNeg</span>&nbsp;<span class="op" id="3900868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3900872"><a href="/crypto/tls/handshake_messages.go.html#3900787">numExtensions</a></span><span class="op" id="3900885">++</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3900890">for</span>&nbsp;<span class="ident" id="3900894">_</span><span class="op" id="3900895">,</span>&nbsp;<span class="ident" id="3900897">v</span>&nbsp;<span class="op" id="3900899">:=</span>&nbsp;<span class="keyword" id="3900902">range</span>&nbsp;<span class="ident" id="3900908"><a href="/crypto/tls/handshake_messages.go.html#3900677">m</a></span><span class="op" id="3900909">.</span><span class="ident" id="3900910">nextProtos</span>&nbsp;<span class="op" id="3900921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3900926"><a href="/crypto/tls/handshake_messages.go.html#3900831">nextProtoLen</a></span>&nbsp;<span class="op" id="3900939">+=</span>&nbsp;<span class="builtinfunc" id="3900942">len</span><span class="op" id="3900945">(</span><span class="ident" id="3900946"><a href="/crypto/tls/handshake_messages.go.html#3900897">v</a></span><span class="op" id="3900947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3900951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3900955"><a href="/crypto/tls/handshake_messages.go.html#3900831">nextProtoLen</a></span>&nbsp;<span class="op" id="3900968">+=</span>&nbsp;<span class="builtinfunc" id="3900971">len</span><span class="op" id="3900974">(</span><span class="ident" id="3900975"><a href="/crypto/tls/handshake_messages.go.html#3900677">m</a></span><span class="op" id="3900976">.</span><span class="ident" id="3900977">nextProtos</span><span class="op" id="3900987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3900991"><a href="/crypto/tls/handshake_messages.go.html#3900807">extensionsLength</a></span>&nbsp;<span class="op" id="3901008">+=</span>&nbsp;<span class="ident" id="3901011"><a href="/crypto/tls/handshake_messages.go.html#3900831">nextProtoLen</a></span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3901025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3901028">if</span>&nbsp;<span class="ident" id="3901031"><a href="/crypto/tls/handshake_messages.go.html#3900677">m</a></span><span class="op" id="3901032">.</span><span class="ident" id="3901033">ocspStapling</span>&nbsp;<span class="op" id="3901046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3901050"><a href="/crypto/tls/handshake_messages.go.html#3900787">numExtensions</a></span><span class="op" id="3901063">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3901067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3901070">if</span>&nbsp;<span class="ident" id="3901073"><a href="/crypto/tls/handshake_messages.go.html#3900677">m</a></span><span class="op" id="3901074">.</span><span class="ident" id="3901075">ticketSupported</span>&nbsp;<span class="op" id="3901091">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3901095"><a href="/crypto/tls/handshake_messages.go.html#3900787">numExtensions</a></span><span class="op" id="3901108">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3901112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3901115">if</span>&nbsp;<span class="ident" id="3901118"><a href="/crypto/tls/handshake_messages.go.html#3900677">m</a></span><span class="op" id="3901119">.</span><span class="ident" id="3901120">secureRenegotiation</span>&nbsp;<span class="op" id="3901140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3901144"><a href="/crypto/tls/handshake_messages.go.html#3900807">extensionsLength</a></span>&nbsp;<span class="op" id="3901161">+=</span>&nbsp;<span class="num" id="3901164">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3901168"><a href="/crypto/tls/handshake_messages.go.html#3900787">numExtensions</a></span><span class="op" id="3901181">++</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3901185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3901188">if</span>&nbsp;<span class="ident" id="3901191">alpnLen</span>&nbsp;<span class="op" id="3901199">:=</span>&nbsp;<span class="builtinfunc" id="3901202">len</span><span class="op" id="3901205">(</span><span class="ident" id="3901206"><a href="/crypto/tls/handshake_messages.go.html#3900677">m</a></span><span class="op" id="3901207">.</span><span class="ident" id="3901208">alpnProtocol</span><span class="op" id="3901220">)</span><span class="op" id="3901221">;</span>&nbsp;<span class="ident" id="3901223"><a href="/crypto/tls/handshake_messages.go.html#3901191">alpnLen</a></span>&nbsp;<span class="op" id="3901231">&gt;</span>&nbsp;<span class="num" id="3901233">0</span>&nbsp;<span class="op" id="3901235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3901239">if</span>&nbsp;<span class="ident" id="3901242"><a href="/crypto/tls/handshake_messages.go.html#3901191">alpnLen</a></span>&nbsp;<span class="op" id="3901250">&gt;=</span>&nbsp;<span class="num" id="3901253">256</span>&nbsp;<span class="op" id="3901257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3901262">panic</span><span class="op" id="3901267">(</span><span class="string" id="3901268">&#34;invalid&nbsp;ALPN&nbsp;protocol&#34;</span><span class="op" id="3901291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3901295">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3901299"><a href="/crypto/tls/handshake_messages.go.html#3900807">extensionsLength</a></span>&nbsp;<span class="op" id="3901316">+=</span>&nbsp;<span class="num" id="3901319">2</span>&nbsp;<span class="op" id="3901321">+</span>&nbsp;<span class="num" id="3901323">1</span>&nbsp;<span class="op" id="3901325">+</span>&nbsp;<span class="ident" id="3901327"><a href="/crypto/tls/handshake_messages.go.html#3901191">alpnLen</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3901337"><a href="/crypto/tls/handshake_messages.go.html#3900787">numExtensions</a></span><span class="op" id="3901350">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3901354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3901358">if</span>&nbsp;<span class="ident" id="3901361"><a href="/crypto/tls/handshake_messages.go.html#3900787">numExtensions</a></span>&nbsp;<span class="op" id="3901375">&gt;</span>&nbsp;<span class="num" id="3901377">0</span>&nbsp;<span class="op" id="3901379">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3901383"><a href="/crypto/tls/handshake_messages.go.html#3900807">extensionsLength</a></span>&nbsp;<span class="op" id="3901400">+=</span>&nbsp;<span class="num" id="3901403">4</span>&nbsp;<span class="op" id="3901405">*</span>&nbsp;<span class="ident" id="3901407"><a href="/crypto/tls/handshake_messages.go.html#3900787">numExtensions</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3901423"><a href="/crypto/tls/handshake_messages.go.html#3900754">length</a></span>&nbsp;<span class="op" id="3901430">+=</span>&nbsp;<span class="num" id="3901433">2</span>&nbsp;<span class="op" id="3901435">+</span>&nbsp;<span class="ident" id="3901437"><a href="/crypto/tls/handshake_messages.go.html#3900807">extensionsLength</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3901455">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3901459">x</span>&nbsp;<span class="op" id="3901461">:=</span>&nbsp;<span class="builtinfunc" id="3901464">make</span><span class="op" id="3901468">(</span><span class="op" id="3901469">[</span><span class="op" id="3901470">]</span><span class="builtintype" id="3901471">byte</span><span class="op" id="3901475">,</span>&nbsp;<span class="num" id="3901477">4</span><span class="op" id="3901478">+</span><span class="ident" id="3901479"><a href="/crypto/tls/handshake_messages.go.html#3900754">length</a></span><span class="op" id="3901485">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3901488"><a href="/crypto/tls/handshake_messages.go.html#3901459">x</a></span><span class="op" id="3901489">[</span><span class="num" id="3901490">0</span><span class="op" id="3901491">]</span>&nbsp;<span class="op" id="3901493">=</span>&nbsp;<span class="ident" id="3901495"><a href="/crypto/tls/common.go.html#3823519">typeServerHello</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3901512"><a href="/crypto/tls/handshake_messages.go.html#3901459">x</a></span><span class="op" id="3901513">[</span><span class="num" id="3901514">1</span><span class="op" id="3901515">]</span>&nbsp;<span class="op" id="3901517">=</span>&nbsp;<span class="builtintype" id="3901519">uint8</span><span class="op" id="3901524">(</span><span class="ident" id="3901525"><a href="/crypto/tls/handshake_messages.go.html#3900754">length</a></span>&nbsp;<span class="op" id="3901532">&gt;&gt;</span>&nbsp;<span class="num" id="3901535">16</span><span class="op" id="3901537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3901540"><a href="/crypto/tls/handshake_messages.go.html#3901459">x</a></span><span class="op" id="3901541">[</span><span class="num" id="3901542">2</span><span class="op" id="3901543">]</span>&nbsp;<span class="op" id="3901545">=</span>&nbsp;<span class="builtintype" id="3901547">uint8</span><span class="op" id="3901552">(</span><span class="ident" id="3901553"><a href="/crypto/tls/handshake_messages.go.html#3900754">length</a></span>&nbsp;<span class="op" id="3901560">&gt;&gt;</span>&nbsp;<span class="num" id="3901563">8</span><span class="op" id="3901564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3901567"><a href="/crypto/tls/handshake_messages.go.html#3901459">x</a></span><span class="op" id="3901568">[</span><span class="num" id="3901569">3</span><span class="op" id="3901570">]</span>&nbsp;<span class="op" id="3901572">=</span>&nbsp;<span class="builtintype" id="3901574">uint8</span><span class="op" id="3901579">(</span><span class="ident" id="3901580"><a href="/crypto/tls/handshake_messages.go.html#3900754">length</a></span><span class="op" id="3901586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3901589"><a href="/crypto/tls/handshake_messages.go.html#3901459">x</a></span><span class="op" id="3901590">[</span><span class="num" id="3901591">4</span><span class="op" id="3901592">]</span>&nbsp;<span class="op" id="3901594">=</span>&nbsp;<span class="builtintype" id="3901596">uint8</span><span class="op" id="3901601">(</span><span class="ident" id="3901602"><a href="/crypto/tls/handshake_messages.go.html#3900677">m</a></span><span class="op" id="3901603">.</span><span class="ident" id="3901604">vers</span>&nbsp;<span class="op" id="3901609">&gt;&gt;</span>&nbsp;<span class="num" id="3901612">8</span><span class="op" id="3901613">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3901616"><a href="/crypto/tls/handshake_messages.go.html#3901459">x</a></span><span class="op" id="3901617">[</span><span class="num" id="3901618">5</span><span class="op" id="3901619">]</span>&nbsp;<span class="op" id="3901621">=</span>&nbsp;<span class="builtintype" id="3901623">uint8</span><span class="op" id="3901628">(</span><span class="ident" id="3901629"><a href="/crypto/tls/handshake_messages.go.html#3900677">m</a></span><span class="op" id="3901630">.</span><span class="ident" id="3901631">vers</span><span class="op" id="3901635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3901638">copy</span><span class="op" id="3901642">(</span><span class="ident" id="3901643"><a href="/crypto/tls/handshake_messages.go.html#3901459">x</a></span><span class="op" id="3901644">[</span><span class="num" id="3901645">6</span><span class="op" id="3901646">:</span><span class="num" id="3901647">38</span><span class="op" id="3901649">]</span><span class="op" id="3901650">,</span>&nbsp;<span class="ident" id="3901652"><a href="/crypto/tls/handshake_messages.go.html#3900677">m</a></span><span class="op" id="3901653">.</span><span class="ident" id="3901654">random</span><span class="op" id="3901660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3901663"><a href="/crypto/tls/handshake_messages.go.html#3901459">x</a></span><span class="op" id="3901664">[</span><span class="num" id="3901665">38</span><span class="op" id="3901667">]</span>&nbsp;<span class="op" id="3901669">=</span>&nbsp;<span class="builtintype" id="3901671">uint8</span><span class="op" id="3901676">(</span><span class="builtinfunc" id="3901677">len</span><span class="op" id="3901680">(</span><span class="ident" id="3901681"><a href="/crypto/tls/handshake_messages.go.html#3900677">m</a></span><span class="op" id="3901682">.</span><span class="ident" id="3901683">sessionId</span><span class="op" id="3901692">)</span><span class="op" id="3901693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3901696">copy</span><span class="op" id="3901700">(</span><span class="ident" id="3901701"><a href="/crypto/tls/handshake_messages.go.html#3901459">x</a></span><span class="op" id="3901702">[</span><span class="num" id="3901703">39</span><span class="op" id="3901705">:</span><span class="num" id="3901706">39</span><span class="op" id="3901708">+</span><span class="builtinfunc" id="3901709">len</span><span class="op" id="3901712">(</span><span class="ident" id="3901713"><a href="/crypto/tls/handshake_messages.go.html#3900677">m</a></span><span class="op" id="3901714">.</span><span class="ident" id="3901715">sessionId</span><span class="op" id="3901724">)</span><span class="op" id="3901725">]</span><span class="op" id="3901726">,</span>&nbsp;<span class="ident" id="3901728"><a href="/crypto/tls/handshake_messages.go.html#3900677">m</a></span><span class="op" id="3901729">.</span><span class="ident" id="3901730">sessionId</span><span class="op" id="3901739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3901742">z</span>&nbsp;<span class="op" id="3901744">:=</span>&nbsp;<span class="ident" id="3901747"><a href="/crypto/tls/handshake_messages.go.html#3901459">x</a></span><span class="op" id="3901748">[</span><span class="num" id="3901749">39</span><span class="op" id="3901751">+</span><span class="builtinfunc" id="3901752">len</span><span class="op" id="3901755">(</span><span class="ident" id="3901756"><a href="/crypto/tls/handshake_messages.go.html#3900677">m</a></span><span class="op" id="3901757">.</span><span class="ident" id="3901758">sessionId</span><span class="op" id="3901767">)</span><span class="op" id="3901768">:</span><span class="op" id="3901769">]</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3901772"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3901773">[</span><span class="num" id="3901774">0</span><span class="op" id="3901775">]</span>&nbsp;<span class="op" id="3901777">=</span>&nbsp;<span class="builtintype" id="3901779">uint8</span><span class="op" id="3901784">(</span><span class="ident" id="3901785"><a href="/crypto/tls/handshake_messages.go.html#3900677">m</a></span><span class="op" id="3901786">.</span><span class="ident" id="3901787">cipherSuite</span>&nbsp;<span class="op" id="3901799">&gt;&gt;</span>&nbsp;<span class="num" id="3901802">8</span><span class="op" id="3901803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3901806"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3901807">[</span><span class="num" id="3901808">1</span><span class="op" id="3901809">]</span>&nbsp;<span class="op" id="3901811">=</span>&nbsp;<span class="builtintype" id="3901813">uint8</span><span class="op" id="3901818">(</span><span class="ident" id="3901819"><a href="/crypto/tls/handshake_messages.go.html#3900677">m</a></span><span class="op" id="3901820">.</span><span class="ident" id="3901821">cipherSuite</span><span class="op" id="3901832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3901835"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3901836">[</span><span class="num" id="3901837">2</span><span class="op" id="3901838">]</span>&nbsp;<span class="op" id="3901840">=</span>&nbsp;<span class="builtintype" id="3901842">uint8</span><span class="op" id="3901847">(</span><span class="ident" id="3901848"><a href="/crypto/tls/handshake_messages.go.html#3900677">m</a></span><span class="op" id="3901849">.</span><span class="ident" id="3901850">compressionMethod</span><span class="op" id="3901867">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3901871"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span>&nbsp;<span class="op" id="3901873">=</span>&nbsp;<span class="ident" id="3901875"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3901876">[</span><span class="num" id="3901877">3</span><span class="op" id="3901878">:</span><span class="op" id="3901879">]</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3901882">if</span>&nbsp;<span class="ident" id="3901885"><a href="/crypto/tls/handshake_messages.go.html#3900787">numExtensions</a></span>&nbsp;<span class="op" id="3901899">&gt;</span>&nbsp;<span class="num" id="3901901">0</span>&nbsp;<span class="op" id="3901903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3901907"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3901908">[</span><span class="num" id="3901909">0</span><span class="op" id="3901910">]</span>&nbsp;<span class="op" id="3901912">=</span>&nbsp;<span class="builtintype" id="3901914">byte</span><span class="op" id="3901918">(</span><span class="ident" id="3901919"><a href="/crypto/tls/handshake_messages.go.html#3900807">extensionsLength</a></span>&nbsp;<span class="op" id="3901936">&gt;&gt;</span>&nbsp;<span class="num" id="3901939">8</span><span class="op" id="3901940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3901944"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3901945">[</span><span class="num" id="3901946">1</span><span class="op" id="3901947">]</span>&nbsp;<span class="op" id="3901949">=</span>&nbsp;<span class="builtintype" id="3901951">byte</span><span class="op" id="3901955">(</span><span class="ident" id="3901956"><a href="/crypto/tls/handshake_messages.go.html#3900807">extensionsLength</a></span><span class="op" id="3901972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3901976"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span>&nbsp;<span class="op" id="3901978">=</span>&nbsp;<span class="ident" id="3901980"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3901981">[</span><span class="num" id="3901982">2</span><span class="op" id="3901983">:</span><span class="op" id="3901984">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3901987">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3901990">if</span>&nbsp;<span class="ident" id="3901993"><a href="/crypto/tls/handshake_messages.go.html#3900677">m</a></span><span class="op" id="3901994">.</span><span class="ident" id="3901995">nextProtoNeg</span>&nbsp;<span class="op" id="3902008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3902012"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3902013">[</span><span class="num" id="3902014">0</span><span class="op" id="3902015">]</span>&nbsp;<span class="op" id="3902017">=</span>&nbsp;<span class="builtintype" id="3902019">byte</span><span class="op" id="3902023">(</span><span class="ident" id="3902024"><a href="/crypto/tls/common.go.html#3824315">extensionNextProtoNeg</a></span>&nbsp;<span class="op" id="3902046">&gt;&gt;</span>&nbsp;<span class="num" id="3902049">8</span><span class="op" id="3902050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3902054"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3902055">[</span><span class="num" id="3902056">1</span><span class="op" id="3902057">]</span>&nbsp;<span class="op" id="3902059">=</span>&nbsp;<span class="builtintype" id="3902061">byte</span><span class="op" id="3902065">(</span><span class="ident" id="3902066"><a href="/crypto/tls/common.go.html#3824315">extensionNextProtoNeg</a></span>&nbsp;<span class="op" id="3902088">&amp;</span>&nbsp;<span class="num" id="3902090">0xff</span><span class="op" id="3902094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3902098"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3902099">[</span><span class="num" id="3902100">2</span><span class="op" id="3902101">]</span>&nbsp;<span class="op" id="3902103">=</span>&nbsp;<span class="builtintype" id="3902105">byte</span><span class="op" id="3902109">(</span><span class="ident" id="3902110"><a href="/crypto/tls/handshake_messages.go.html#3900831">nextProtoLen</a></span>&nbsp;<span class="op" id="3902123">&gt;&gt;</span>&nbsp;<span class="num" id="3902126">8</span><span class="op" id="3902127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3902131"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3902132">[</span><span class="num" id="3902133">3</span><span class="op" id="3902134">]</span>&nbsp;<span class="op" id="3902136">=</span>&nbsp;<span class="builtintype" id="3902138">byte</span><span class="op" id="3902142">(</span><span class="ident" id="3902143"><a href="/crypto/tls/handshake_messages.go.html#3900831">nextProtoLen</a></span><span class="op" id="3902155">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3902159"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span>&nbsp;<span class="op" id="3902161">=</span>&nbsp;<span class="ident" id="3902163"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3902164">[</span><span class="num" id="3902165">4</span><span class="op" id="3902166">:</span><span class="op" id="3902167">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3902172">for</span>&nbsp;<span class="ident" id="3902176">_</span><span class="op" id="3902177">,</span>&nbsp;<span class="ident" id="3902179">v</span>&nbsp;<span class="op" id="3902181">:=</span>&nbsp;<span class="keyword" id="3902184">range</span>&nbsp;<span class="ident" id="3902190"><a href="/crypto/tls/handshake_messages.go.html#3900677">m</a></span><span class="op" id="3902191">.</span><span class="ident" id="3902192">nextProtos</span>&nbsp;<span class="op" id="3902203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3902208">l</span>&nbsp;<span class="op" id="3902210">:=</span>&nbsp;<span class="builtinfunc" id="3902213">len</span><span class="op" id="3902216">(</span><span class="ident" id="3902217"><a href="/crypto/tls/handshake_messages.go.html#3902179">v</a></span><span class="op" id="3902218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3902223">if</span>&nbsp;<span class="ident" id="3902226"><a href="/crypto/tls/handshake_messages.go.html#3902208">l</a></span>&nbsp;<span class="op" id="3902228">&gt;</span>&nbsp;<span class="num" id="3902230">255</span>&nbsp;<span class="op" id="3902234">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3902240"><a href="/crypto/tls/handshake_messages.go.html#3902208">l</a></span>&nbsp;<span class="op" id="3902242">=</span>&nbsp;<span class="num" id="3902244">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3902251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3902256"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3902257">[</span><span class="num" id="3902258">0</span><span class="op" id="3902259">]</span>&nbsp;<span class="op" id="3902261">=</span>&nbsp;<span class="builtintype" id="3902263">byte</span><span class="op" id="3902267">(</span><span class="ident" id="3902268"><a href="/crypto/tls/handshake_messages.go.html#3902208">l</a></span><span class="op" id="3902269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3902274">copy</span><span class="op" id="3902278">(</span><span class="ident" id="3902279"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3902280">[</span><span class="num" id="3902281">1</span><span class="op" id="3902282">:</span><span class="op" id="3902283">]</span><span class="op" id="3902284">,</span>&nbsp;<span class="op" id="3902286">[</span><span class="op" id="3902287">]</span><span class="builtintype" id="3902288">byte</span><span class="op" id="3902292">(</span><span class="ident" id="3902293"><a href="/crypto/tls/handshake_messages.go.html#3902179">v</a></span><span class="op" id="3902294">[</span><span class="num" id="3902295">0</span><span class="op" id="3902296">:</span><span class="ident" id="3902297"><a href="/crypto/tls/handshake_messages.go.html#3902208">l</a></span><span class="op" id="3902298">]</span><span class="op" id="3902299">)</span><span class="op" id="3902300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3902305"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span>&nbsp;<span class="op" id="3902307">=</span>&nbsp;<span class="ident" id="3902309"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3902310">[</span><span class="num" id="3902311">1</span><span class="op" id="3902312">+</span><span class="ident" id="3902313"><a href="/crypto/tls/handshake_messages.go.html#3902208">l</a></span><span class="op" id="3902314">:</span><span class="op" id="3902315">]</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3902319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3902322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3902325">if</span>&nbsp;<span class="ident" id="3902328"><a href="/crypto/tls/handshake_messages.go.html#3900677">m</a></span><span class="op" id="3902329">.</span><span class="ident" id="3902330">ocspStapling</span>&nbsp;<span class="op" id="3902343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3902347"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3902348">[</span><span class="num" id="3902349">0</span><span class="op" id="3902350">]</span>&nbsp;<span class="op" id="3902352">=</span>&nbsp;<span class="builtintype" id="3902354">byte</span><span class="op" id="3902358">(</span><span class="ident" id="3902359"><a href="/crypto/tls/common.go.html#3824064">extensionStatusRequest</a></span>&nbsp;<span class="op" id="3902382">&gt;&gt;</span>&nbsp;<span class="num" id="3902385">8</span><span class="op" id="3902386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3902390"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3902391">[</span><span class="num" id="3902392">1</span><span class="op" id="3902393">]</span>&nbsp;<span class="op" id="3902395">=</span>&nbsp;<span class="builtintype" id="3902397">byte</span><span class="op" id="3902401">(</span><span class="ident" id="3902402"><a href="/crypto/tls/common.go.html#3824064">extensionStatusRequest</a></span><span class="op" id="3902424">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3902428"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span>&nbsp;<span class="op" id="3902430">=</span>&nbsp;<span class="ident" id="3902432"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3902433">[</span><span class="num" id="3902434">4</span><span class="op" id="3902435">:</span><span class="op" id="3902436">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3902439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3902442">if</span>&nbsp;<span class="ident" id="3902445"><a href="/crypto/tls/handshake_messages.go.html#3900677">m</a></span><span class="op" id="3902446">.</span><span class="ident" id="3902447">ticketSupported</span>&nbsp;<span class="op" id="3902463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3902467"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3902468">[</span><span class="num" id="3902469">0</span><span class="op" id="3902470">]</span>&nbsp;<span class="op" id="3902472">=</span>&nbsp;<span class="builtintype" id="3902474">byte</span><span class="op" id="3902478">(</span><span class="ident" id="3902479"><a href="/crypto/tls/common.go.html#3824273">extensionSessionTicket</a></span>&nbsp;<span class="op" id="3902502">&gt;&gt;</span>&nbsp;<span class="num" id="3902505">8</span><span class="op" id="3902506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3902510"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3902511">[</span><span class="num" id="3902512">1</span><span class="op" id="3902513">]</span>&nbsp;<span class="op" id="3902515">=</span>&nbsp;<span class="builtintype" id="3902517">byte</span><span class="op" id="3902521">(</span><span class="ident" id="3902522"><a href="/crypto/tls/common.go.html#3824273">extensionSessionTicket</a></span><span class="op" id="3902544">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3902548"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span>&nbsp;<span class="op" id="3902550">=</span>&nbsp;<span class="ident" id="3902552"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3902553">[</span><span class="num" id="3902554">4</span><span class="op" id="3902555">:</span><span class="op" id="3902556">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3902559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3902562">if</span>&nbsp;<span class="ident" id="3902565"><a href="/crypto/tls/handshake_messages.go.html#3900677">m</a></span><span class="op" id="3902566">.</span><span class="ident" id="3902567">secureRenegotiation</span>&nbsp;<span class="op" id="3902587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3902591"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3902592">[</span><span class="num" id="3902593">0</span><span class="op" id="3902594">]</span>&nbsp;<span class="op" id="3902596">=</span>&nbsp;<span class="builtintype" id="3902598">byte</span><span class="op" id="3902602">(</span><span class="ident" id="3902603"><a href="/crypto/tls/common.go.html#3824381">extensionRenegotiationInfo</a></span>&nbsp;<span class="op" id="3902630">&gt;&gt;</span>&nbsp;<span class="num" id="3902633">8</span><span class="op" id="3902634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3902638"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3902639">[</span><span class="num" id="3902640">1</span><span class="op" id="3902641">]</span>&nbsp;<span class="op" id="3902643">=</span>&nbsp;<span class="builtintype" id="3902645">byte</span><span class="op" id="3902649">(</span><span class="ident" id="3902650"><a href="/crypto/tls/common.go.html#3824381">extensionRenegotiationInfo</a></span>&nbsp;<span class="op" id="3902677">&amp;</span>&nbsp;<span class="num" id="3902679">0xff</span><span class="op" id="3902683">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3902687"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3902688">[</span><span class="num" id="3902689">2</span><span class="op" id="3902690">]</span>&nbsp;<span class="op" id="3902692">=</span>&nbsp;<span class="num" id="3902694">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3902698"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3902699">[</span><span class="num" id="3902700">3</span><span class="op" id="3902701">]</span>&nbsp;<span class="op" id="3902703">=</span>&nbsp;<span class="num" id="3902705">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3902709"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span>&nbsp;<span class="op" id="3902711">=</span>&nbsp;<span class="ident" id="3902713"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3902714">[</span><span class="num" id="3902715">5</span><span class="op" id="3902716">:</span><span class="op" id="3902717">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3902720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3902723">if</span>&nbsp;<span class="ident" id="3902726">alpnLen</span>&nbsp;<span class="op" id="3902734">:=</span>&nbsp;<span class="builtinfunc" id="3902737">len</span><span class="op" id="3902740">(</span><span class="ident" id="3902741"><a href="/crypto/tls/handshake_messages.go.html#3900677">m</a></span><span class="op" id="3902742">.</span><span class="ident" id="3902743">alpnProtocol</span><span class="op" id="3902755">)</span><span class="op" id="3902756">;</span>&nbsp;<span class="ident" id="3902758"><a href="/crypto/tls/handshake_messages.go.html#3902726">alpnLen</a></span>&nbsp;<span class="op" id="3902766">&gt;</span>&nbsp;<span class="num" id="3902768">0</span>&nbsp;<span class="op" id="3902770">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3902774"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3902775">[</span><span class="num" id="3902776">0</span><span class="op" id="3902777">]</span>&nbsp;<span class="op" id="3902779">=</span>&nbsp;<span class="builtintype" id="3902781">byte</span><span class="op" id="3902785">(</span><span class="ident" id="3902786"><a href="/crypto/tls/common.go.html#3824231">extensionALPN</a></span>&nbsp;<span class="op" id="3902800">&gt;&gt;</span>&nbsp;<span class="num" id="3902803">8</span><span class="op" id="3902804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3902808"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3902809">[</span><span class="num" id="3902810">1</span><span class="op" id="3902811">]</span>&nbsp;<span class="op" id="3902813">=</span>&nbsp;<span class="builtintype" id="3902815">byte</span><span class="op" id="3902819">(</span><span class="ident" id="3902820"><a href="/crypto/tls/common.go.html#3824231">extensionALPN</a></span>&nbsp;<span class="op" id="3902834">&amp;</span>&nbsp;<span class="num" id="3902836">0xff</span><span class="op" id="3902840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3902844">l</span>&nbsp;<span class="op" id="3902846">:=</span>&nbsp;<span class="num" id="3902849">2</span>&nbsp;<span class="op" id="3902851">+</span>&nbsp;<span class="num" id="3902853">1</span>&nbsp;<span class="op" id="3902855">+</span>&nbsp;<span class="ident" id="3902857"><a href="/crypto/tls/handshake_messages.go.html#3902726">alpnLen</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3902867"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3902868">[</span><span class="num" id="3902869">2</span><span class="op" id="3902870">]</span>&nbsp;<span class="op" id="3902872">=</span>&nbsp;<span class="builtintype" id="3902874">byte</span><span class="op" id="3902878">(</span><span class="ident" id="3902879"><a href="/crypto/tls/handshake_messages.go.html#3902844">l</a></span>&nbsp;<span class="op" id="3902881">&gt;&gt;</span>&nbsp;<span class="num" id="3902884">8</span><span class="op" id="3902885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3902889"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3902890">[</span><span class="num" id="3902891">3</span><span class="op" id="3902892">]</span>&nbsp;<span class="op" id="3902894">=</span>&nbsp;<span class="builtintype" id="3902896">byte</span><span class="op" id="3902900">(</span><span class="ident" id="3902901"><a href="/crypto/tls/handshake_messages.go.html#3902844">l</a></span><span class="op" id="3902902">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3902906"><a href="/crypto/tls/handshake_messages.go.html#3902844">l</a></span>&nbsp;<span class="op" id="3902908">-=</span>&nbsp;<span class="num" id="3902911">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3902915"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3902916">[</span><span class="num" id="3902917">4</span><span class="op" id="3902918">]</span>&nbsp;<span class="op" id="3902920">=</span>&nbsp;<span class="builtintype" id="3902922">byte</span><span class="op" id="3902926">(</span><span class="ident" id="3902927"><a href="/crypto/tls/handshake_messages.go.html#3902844">l</a></span>&nbsp;<span class="op" id="3902929">&gt;&gt;</span>&nbsp;<span class="num" id="3902932">8</span><span class="op" id="3902933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3902937"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3902938">[</span><span class="num" id="3902939">5</span><span class="op" id="3902940">]</span>&nbsp;<span class="op" id="3902942">=</span>&nbsp;<span class="builtintype" id="3902944">byte</span><span class="op" id="3902948">(</span><span class="ident" id="3902949"><a href="/crypto/tls/handshake_messages.go.html#3902844">l</a></span><span class="op" id="3902950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3902954"><a href="/crypto/tls/handshake_messages.go.html#3902844">l</a></span>&nbsp;<span class="op" id="3902956">-=</span>&nbsp;<span class="num" id="3902959">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3902963"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3902964">[</span><span class="num" id="3902965">6</span><span class="op" id="3902966">]</span>&nbsp;<span class="op" id="3902968">=</span>&nbsp;<span class="builtintype" id="3902970">byte</span><span class="op" id="3902974">(</span><span class="ident" id="3902975"><a href="/crypto/tls/handshake_messages.go.html#3902844">l</a></span><span class="op" id="3902976">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3902980">copy</span><span class="op" id="3902984">(</span><span class="ident" id="3902985"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3902986">[</span><span class="num" id="3902987">7</span><span class="op" id="3902988">:</span><span class="op" id="3902989">]</span><span class="op" id="3902990">,</span>&nbsp;<span class="op" id="3902992">[</span><span class="op" id="3902993">]</span><span class="builtintype" id="3902994">byte</span><span class="op" id="3902998">(</span><span class="ident" id="3902999"><a href="/crypto/tls/handshake_messages.go.html#3900677">m</a></span><span class="op" id="3903000">.</span><span class="ident" id="3903001">alpnProtocol</span><span class="op" id="3903013">)</span><span class="op" id="3903014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3903018"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span>&nbsp;<span class="op" id="3903020">=</span>&nbsp;<span class="ident" id="3903022"><a href="/crypto/tls/handshake_messages.go.html#3901742">z</a></span><span class="op" id="3903023">[</span><span class="num" id="3903024">7</span><span class="op" id="3903025">+</span><span class="ident" id="3903026"><a href="/crypto/tls/handshake_messages.go.html#3902726">alpnLen</a></span><span class="op" id="3903033">:</span><span class="op" id="3903034">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3903037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3903041"><a href="/crypto/tls/handshake_messages.go.html#3900677">m</a></span><span class="op" id="3903042">.</span><span class="ident" id="3903043">raw</span>&nbsp;<span class="op" id="3903047">=</span>&nbsp;<span class="ident" id="3903049"><a href="/crypto/tls/handshake_messages.go.html#3901459">x</a></span><br>
<span class="lineno">610</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3903053">return</span>&nbsp;<span class="ident" id="3903060"><a href="/crypto/tls/handshake_messages.go.html#3901459">x</a></span><br>
<span class="lineno"></span><span class="op" id="3903062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3903065">func</span>&nbsp;<span class="op" id="3903070">(</span><span class="ident" id="3903071">m</span>&nbsp;<span class="op" id="3903073">*</span><span class="ident" id="3903074"><a href="/crypto/tls/handshake_messages.go.html#3899714">serverHelloMsg</a></span><span class="op" id="3903088">)</span>&nbsp;<span class="ident" id="3903090">unmarshal</span><span class="op" id="3903099">(</span><span class="ident" id="3903100">data</span>&nbsp;<span class="op" id="3903105">[</span><span class="op" id="3903106">]</span><span class="builtintype" id="3903107">byte</span><span class="op" id="3903111">)</span>&nbsp;<span class="builtintype" id="3903113">bool</span>&nbsp;<span class="op" id="3903118">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3903121">if</span>&nbsp;<span class="builtinfunc" id="3903124">len</span><span class="op" id="3903127">(</span><span class="ident" id="3903128"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3903132">)</span>&nbsp;<span class="op" id="3903134">&lt;</span>&nbsp;<span class="num" id="3903136">42</span>&nbsp;<span class="op" id="3903139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3903143">return</span>&nbsp;<span class="builtintype" id="3903150">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3903157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3903160"><a href="/crypto/tls/handshake_messages.go.html#3903071">m</a></span><span class="op" id="3903161">.</span><span class="ident" id="3903162">raw</span>&nbsp;<span class="op" id="3903166">=</span>&nbsp;<span class="ident" id="3903168"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3903174"><a href="/crypto/tls/handshake_messages.go.html#3903071">m</a></span><span class="op" id="3903175">.</span><span class="ident" id="3903176">vers</span>&nbsp;<span class="op" id="3903181">=</span>&nbsp;<span class="builtintype" id="3903183">uint16</span><span class="op" id="3903189">(</span><span class="ident" id="3903190"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3903194">[</span><span class="num" id="3903195">4</span><span class="op" id="3903196">]</span><span class="op" id="3903197">)</span><span class="op" id="3903198">&lt;&lt;</span><span class="num" id="3903200">8</span>&nbsp;<span class="op" id="3903202">|</span>&nbsp;<span class="builtintype" id="3903204">uint16</span><span class="op" id="3903210">(</span><span class="ident" id="3903211"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3903215">[</span><span class="num" id="3903216">5</span><span class="op" id="3903217">]</span><span class="op" id="3903218">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3903221"><a href="/crypto/tls/handshake_messages.go.html#3903071">m</a></span><span class="op" id="3903222">.</span><span class="ident" id="3903223">random</span>&nbsp;<span class="op" id="3903230">=</span>&nbsp;<span class="ident" id="3903232"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3903236">[</span><span class="num" id="3903237">6</span><span class="op" id="3903238">:</span><span class="num" id="3903239">38</span><span class="op" id="3903241">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3903244">sessionIdLen</span>&nbsp;<span class="op" id="3903257">:=</span>&nbsp;<span class="builtintype" id="3903260">int</span><span class="op" id="3903263">(</span><span class="ident" id="3903264"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3903268">[</span><span class="num" id="3903269">38</span><span class="op" id="3903271">]</span><span class="op" id="3903272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3903275">if</span>&nbsp;<span class="ident" id="3903278"><a href="/crypto/tls/handshake_messages.go.html#3903244">sessionIdLen</a></span>&nbsp;<span class="op" id="3903291">&gt;</span>&nbsp;<span class="num" id="3903293">32</span>&nbsp;<span class="op" id="3903296">||</span>&nbsp;<span class="builtinfunc" id="3903299">len</span><span class="op" id="3903302">(</span><span class="ident" id="3903303"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3903307">)</span>&nbsp;<span class="op" id="3903309">&lt;</span>&nbsp;<span class="num" id="3903311">39</span><span class="op" id="3903313">+</span><span class="ident" id="3903314"><a href="/crypto/tls/handshake_messages.go.html#3903244">sessionIdLen</a></span>&nbsp;<span class="op" id="3903327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3903331">return</span>&nbsp;<span class="builtintype" id="3903338">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3903345">}</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3903348"><a href="/crypto/tls/handshake_messages.go.html#3903071">m</a></span><span class="op" id="3903349">.</span><span class="ident" id="3903350">sessionId</span>&nbsp;<span class="op" id="3903360">=</span>&nbsp;<span class="ident" id="3903362"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3903366">[</span><span class="num" id="3903367">39</span>&nbsp;<span class="op" id="3903370">:</span>&nbsp;<span class="num" id="3903372">39</span><span class="op" id="3903374">+</span><span class="ident" id="3903375"><a href="/crypto/tls/handshake_messages.go.html#3903244">sessionIdLen</a></span><span class="op" id="3903387">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3903390"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span>&nbsp;<span class="op" id="3903395">=</span>&nbsp;<span class="ident" id="3903397"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3903401">[</span><span class="num" id="3903402">39</span><span class="op" id="3903404">+</span><span class="ident" id="3903405"><a href="/crypto/tls/handshake_messages.go.html#3903244">sessionIdLen</a></span><span class="op" id="3903417">:</span><span class="op" id="3903418">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3903421">if</span>&nbsp;<span class="builtinfunc" id="3903424">len</span><span class="op" id="3903427">(</span><span class="ident" id="3903428"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3903432">)</span>&nbsp;<span class="op" id="3903434">&lt;</span>&nbsp;<span class="num" id="3903436">3</span>&nbsp;<span class="op" id="3903438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3903442">return</span>&nbsp;<span class="builtintype" id="3903449">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3903456">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3903459"><a href="/crypto/tls/handshake_messages.go.html#3903071">m</a></span><span class="op" id="3903460">.</span><span class="ident" id="3903461">cipherSuite</span>&nbsp;<span class="op" id="3903473">=</span>&nbsp;<span class="builtintype" id="3903475">uint16</span><span class="op" id="3903481">(</span><span class="ident" id="3903482"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3903486">[</span><span class="num" id="3903487">0</span><span class="op" id="3903488">]</span><span class="op" id="3903489">)</span><span class="op" id="3903490">&lt;&lt;</span><span class="num" id="3903492">8</span>&nbsp;<span class="op" id="3903494">|</span>&nbsp;<span class="builtintype" id="3903496">uint16</span><span class="op" id="3903502">(</span><span class="ident" id="3903503"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3903507">[</span><span class="num" id="3903508">1</span><span class="op" id="3903509">]</span><span class="op" id="3903510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3903513"><a href="/crypto/tls/handshake_messages.go.html#3903071">m</a></span><span class="op" id="3903514">.</span><span class="ident" id="3903515">compressionMethod</span>&nbsp;<span class="op" id="3903533">=</span>&nbsp;<span class="ident" id="3903535"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3903539">[</span><span class="num" id="3903540">2</span><span class="op" id="3903541">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3903544"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span>&nbsp;<span class="op" id="3903549">=</span>&nbsp;<span class="ident" id="3903551"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3903555">[</span><span class="num" id="3903556">3</span><span class="op" id="3903557">:</span><span class="op" id="3903558">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3903562"><a href="/crypto/tls/handshake_messages.go.html#3903071">m</a></span><span class="op" id="3903563">.</span><span class="ident" id="3903564">nextProtoNeg</span>&nbsp;<span class="op" id="3903577">=</span>&nbsp;<span class="builtintype" id="3903579">false</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3903586"><a href="/crypto/tls/handshake_messages.go.html#3903071">m</a></span><span class="op" id="3903587">.</span><span class="ident" id="3903588">nextProtos</span>&nbsp;<span class="op" id="3903599">=</span>&nbsp;<span class="ident" id="3903601">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3903606"><a href="/crypto/tls/handshake_messages.go.html#3903071">m</a></span><span class="op" id="3903607">.</span><span class="ident" id="3903608">ocspStapling</span>&nbsp;<span class="op" id="3903621">=</span>&nbsp;<span class="builtintype" id="3903623">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3903630"><a href="/crypto/tls/handshake_messages.go.html#3903071">m</a></span><span class="op" id="3903631">.</span><span class="ident" id="3903632">ticketSupported</span>&nbsp;<span class="op" id="3903648">=</span>&nbsp;<span class="builtintype" id="3903650">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3903657"><a href="/crypto/tls/handshake_messages.go.html#3903071">m</a></span><span class="op" id="3903658">.</span><span class="ident" id="3903659">alpnProtocol</span>&nbsp;<span class="op" id="3903672">=</span>&nbsp;<span class="string" id="3903674">&#34;&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3903679">if</span>&nbsp;<span class="builtinfunc" id="3903682">len</span><span class="op" id="3903685">(</span><span class="ident" id="3903686"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3903690">)</span>&nbsp;<span class="op" id="3903692">==</span>&nbsp;<span class="num" id="3903695">0</span>&nbsp;<span class="op" id="3903697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3903701">//&nbsp;ServerHello&nbsp;is&nbsp;optionally&nbsp;followed&nbsp;by&nbsp;extension&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3903759">return</span>&nbsp;<span class="builtintype" id="3903766">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3903772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3903775">if</span>&nbsp;<span class="builtinfunc" id="3903778">len</span><span class="op" id="3903781">(</span><span class="ident" id="3903782"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3903786">)</span>&nbsp;<span class="op" id="3903788">&lt;</span>&nbsp;<span class="num" id="3903790">2</span>&nbsp;<span class="op" id="3903792">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3903796">return</span>&nbsp;<span class="builtintype" id="3903803">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3903810">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3903814">extensionsLength</span>&nbsp;<span class="op" id="3903831">:=</span>&nbsp;<span class="builtintype" id="3903834">int</span><span class="op" id="3903837">(</span><span class="ident" id="3903838"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3903842">[</span><span class="num" id="3903843">0</span><span class="op" id="3903844">]</span><span class="op" id="3903845">)</span><span class="op" id="3903846">&lt;&lt;</span><span class="num" id="3903848">8</span>&nbsp;<span class="op" id="3903850">|</span>&nbsp;<span class="builtintype" id="3903852">int</span><span class="op" id="3903855">(</span><span class="ident" id="3903856"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3903860">[</span><span class="num" id="3903861">1</span><span class="op" id="3903862">]</span><span class="op" id="3903863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3903866"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span>&nbsp;<span class="op" id="3903871">=</span>&nbsp;<span class="ident" id="3903873"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3903877">[</span><span class="num" id="3903878">2</span><span class="op" id="3903879">:</span><span class="op" id="3903880">]</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3903883">if</span>&nbsp;<span class="builtinfunc" id="3903886">len</span><span class="op" id="3903889">(</span><span class="ident" id="3903890"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3903894">)</span>&nbsp;<span class="op" id="3903896">!=</span>&nbsp;<span class="ident" id="3903899"><a href="/crypto/tls/handshake_messages.go.html#3903814">extensionsLength</a></span>&nbsp;<span class="op" id="3903916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3903920">return</span>&nbsp;<span class="builtintype" id="3903927">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3903934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3903938">for</span>&nbsp;<span class="builtinfunc" id="3903942">len</span><span class="op" id="3903945">(</span><span class="ident" id="3903946"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3903950">)</span>&nbsp;<span class="op" id="3903952">!=</span>&nbsp;<span class="num" id="3903955">0</span>&nbsp;<span class="op" id="3903957">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3903961">if</span>&nbsp;<span class="builtinfunc" id="3903964">len</span><span class="op" id="3903967">(</span><span class="ident" id="3903968"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3903972">)</span>&nbsp;<span class="op" id="3903974">&lt;</span>&nbsp;<span class="num" id="3903976">4</span>&nbsp;<span class="op" id="3903978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3903983">return</span>&nbsp;<span class="builtintype" id="3903990">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3903998">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3904002">extension</span>&nbsp;<span class="op" id="3904012">:=</span>&nbsp;<span class="builtintype" id="3904015">uint16</span><span class="op" id="3904021">(</span><span class="ident" id="3904022"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3904026">[</span><span class="num" id="3904027">0</span><span class="op" id="3904028">]</span><span class="op" id="3904029">)</span><span class="op" id="3904030">&lt;&lt;</span><span class="num" id="3904032">8</span>&nbsp;<span class="op" id="3904034">|</span>&nbsp;<span class="builtintype" id="3904036">uint16</span><span class="op" id="3904042">(</span><span class="ident" id="3904043"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3904047">[</span><span class="num" id="3904048">1</span><span class="op" id="3904049">]</span><span class="op" id="3904050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3904054">length</span>&nbsp;<span class="op" id="3904061">:=</span>&nbsp;<span class="builtintype" id="3904064">int</span><span class="op" id="3904067">(</span><span class="ident" id="3904068"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3904072">[</span><span class="num" id="3904073">2</span><span class="op" id="3904074">]</span><span class="op" id="3904075">)</span><span class="op" id="3904076">&lt;&lt;</span><span class="num" id="3904078">8</span>&nbsp;<span class="op" id="3904080">|</span>&nbsp;<span class="builtintype" id="3904082">int</span><span class="op" id="3904085">(</span><span class="ident" id="3904086"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3904090">[</span><span class="num" id="3904091">3</span><span class="op" id="3904092">]</span><span class="op" id="3904093">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3904097"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span>&nbsp;<span class="op" id="3904102">=</span>&nbsp;<span class="ident" id="3904104"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3904108">[</span><span class="num" id="3904109">4</span><span class="op" id="3904110">:</span><span class="op" id="3904111">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3904115">if</span>&nbsp;<span class="builtinfunc" id="3904118">len</span><span class="op" id="3904121">(</span><span class="ident" id="3904122"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3904126">)</span>&nbsp;<span class="op" id="3904128">&lt;</span>&nbsp;<span class="ident" id="3904130"><a href="/crypto/tls/handshake_messages.go.html#3904054">length</a></span>&nbsp;<span class="op" id="3904137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3904142">return</span>&nbsp;<span class="builtintype" id="3904149">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3904157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3904162">switch</span>&nbsp;<span class="ident" id="3904169"><a href="/crypto/tls/handshake_messages.go.html#3904002">extension</a></span>&nbsp;<span class="op" id="3904179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3904183">case</span>&nbsp;<span class="ident" id="3904188"><a href="/crypto/tls/common.go.html#3824315">extensionNextProtoNeg</a></span><span class="op" id="3904209">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3904214"><a href="/crypto/tls/handshake_messages.go.html#3903071">m</a></span><span class="op" id="3904215">.</span><span class="ident" id="3904216">nextProtoNeg</span>&nbsp;<span class="op" id="3904229">=</span>&nbsp;<span class="builtintype" id="3904231">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3904239">d</span>&nbsp;<span class="op" id="3904241">:=</span>&nbsp;<span class="ident" id="3904244"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3904248">[</span><span class="op" id="3904249">:</span><span class="ident" id="3904250"><a href="/crypto/tls/handshake_messages.go.html#3904054">length</a></span><span class="op" id="3904256">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3904261">for</span>&nbsp;<span class="builtinfunc" id="3904265">len</span><span class="op" id="3904268">(</span><span class="ident" id="3904269"><a href="/crypto/tls/handshake_messages.go.html#3904239">d</a></span><span class="op" id="3904270">)</span>&nbsp;<span class="op" id="3904272">&gt;</span>&nbsp;<span class="num" id="3904274">0</span>&nbsp;<span class="op" id="3904276">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3904282">l</span>&nbsp;<span class="op" id="3904284">:=</span>&nbsp;<span class="builtintype" id="3904287">int</span><span class="op" id="3904290">(</span><span class="ident" id="3904291"><a href="/crypto/tls/handshake_messages.go.html#3904239">d</a></span><span class="op" id="3904292">[</span><span class="num" id="3904293">0</span><span class="op" id="3904294">]</span><span class="op" id="3904295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3904301"><a href="/crypto/tls/handshake_messages.go.html#3904239">d</a></span>&nbsp;<span class="op" id="3904303">=</span>&nbsp;<span class="ident" id="3904305"><a href="/crypto/tls/handshake_messages.go.html#3904239">d</a></span><span class="op" id="3904306">[</span><span class="num" id="3904307">1</span><span class="op" id="3904308">:</span><span class="op" id="3904309">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3904315">if</span>&nbsp;<span class="ident" id="3904318"><a href="/crypto/tls/handshake_messages.go.html#3904282">l</a></span>&nbsp;<span class="op" id="3904320">==</span>&nbsp;<span class="num" id="3904323">0</span>&nbsp;<span class="op" id="3904325">||</span>&nbsp;<span class="ident" id="3904328"><a href="/crypto/tls/handshake_messages.go.html#3904282">l</a></span>&nbsp;<span class="op" id="3904330">&gt;</span>&nbsp;<span class="builtinfunc" id="3904332">len</span><span class="op" id="3904335">(</span><span class="ident" id="3904336"><a href="/crypto/tls/handshake_messages.go.html#3904239">d</a></span><span class="op" id="3904337">)</span>&nbsp;<span class="op" id="3904339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3904346">return</span>&nbsp;<span class="builtintype" id="3904353">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3904363">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3904369"><a href="/crypto/tls/handshake_messages.go.html#3903071">m</a></span><span class="op" id="3904370">.</span><span class="ident" id="3904371">nextProtos</span>&nbsp;<span class="op" id="3904382">=</span>&nbsp;<span class="builtinfunc" id="3904384">append</span><span class="op" id="3904390">(</span><span class="ident" id="3904391"><a href="/crypto/tls/handshake_messages.go.html#3903071">m</a></span><span class="op" id="3904392">.</span><span class="ident" id="3904393">nextProtos</span><span class="op" id="3904403">,</span>&nbsp;<span class="builtintype" id="3904405">string</span><span class="op" id="3904411">(</span><span class="ident" id="3904412"><a href="/crypto/tls/handshake_messages.go.html#3904239">d</a></span><span class="op" id="3904413">[</span><span class="op" id="3904414">:</span><span class="ident" id="3904415"><a href="/crypto/tls/handshake_messages.go.html#3904282">l</a></span><span class="op" id="3904416">]</span><span class="op" id="3904417">)</span><span class="op" id="3904418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3904424"><a href="/crypto/tls/handshake_messages.go.html#3904239">d</a></span>&nbsp;<span class="op" id="3904426">=</span>&nbsp;<span class="ident" id="3904428"><a href="/crypto/tls/handshake_messages.go.html#3904239">d</a></span><span class="op" id="3904429">[</span><span class="ident" id="3904430"><a href="/crypto/tls/handshake_messages.go.html#3904282">l</a></span><span class="op" id="3904431">:</span><span class="op" id="3904432">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3904437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3904441">case</span>&nbsp;<span class="ident" id="3904446"><a href="/crypto/tls/common.go.html#3824064">extensionStatusRequest</a></span><span class="op" id="3904468">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3904473">if</span>&nbsp;<span class="ident" id="3904476"><a href="/crypto/tls/handshake_messages.go.html#3904054">length</a></span>&nbsp;<span class="op" id="3904483">&gt;</span>&nbsp;<span class="num" id="3904485">0</span>&nbsp;<span class="op" id="3904487">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3904493">return</span>&nbsp;<span class="builtintype" id="3904500">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3904509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3904514"><a href="/crypto/tls/handshake_messages.go.html#3903071">m</a></span><span class="op" id="3904515">.</span><span class="ident" id="3904516">ocspStapling</span>&nbsp;<span class="op" id="3904529">=</span>&nbsp;<span class="builtintype" id="3904531">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3904538">case</span>&nbsp;<span class="ident" id="3904543"><a href="/crypto/tls/common.go.html#3824273">extensionSessionTicket</a></span><span class="op" id="3904565">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3904570">if</span>&nbsp;<span class="ident" id="3904573"><a href="/crypto/tls/handshake_messages.go.html#3904054">length</a></span>&nbsp;<span class="op" id="3904580">&gt;</span>&nbsp;<span class="num" id="3904582">0</span>&nbsp;<span class="op" id="3904584">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3904590">return</span>&nbsp;<span class="builtintype" id="3904597">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3904606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3904611"><a href="/crypto/tls/handshake_messages.go.html#3903071">m</a></span><span class="op" id="3904612">.</span><span class="ident" id="3904613">ticketSupported</span>&nbsp;<span class="op" id="3904629">=</span>&nbsp;<span class="builtintype" id="3904631">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3904638">case</span>&nbsp;<span class="ident" id="3904643"><a href="/crypto/tls/common.go.html#3824381">extensionRenegotiationInfo</a></span><span class="op" id="3904669">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3904674">if</span>&nbsp;<span class="ident" id="3904677"><a href="/crypto/tls/handshake_messages.go.html#3904054">length</a></span>&nbsp;<span class="op" id="3904684">!=</span>&nbsp;<span class="num" id="3904687">1</span>&nbsp;<span class="op" id="3904689">||</span>&nbsp;<span class="ident" id="3904692"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3904696">[</span><span class="num" id="3904697">0</span><span class="op" id="3904698">]</span>&nbsp;<span class="op" id="3904700">!=</span>&nbsp;<span class="num" id="3904703">0</span>&nbsp;<span class="op" id="3904705">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3904711">return</span>&nbsp;<span class="builtintype" id="3904718">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3904727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3904732"><a href="/crypto/tls/handshake_messages.go.html#3903071">m</a></span><span class="op" id="3904733">.</span><span class="ident" id="3904734">secureRenegotiation</span>&nbsp;<span class="op" id="3904754">=</span>&nbsp;<span class="builtintype" id="3904756">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3904763">case</span>&nbsp;<span class="ident" id="3904768"><a href="/crypto/tls/common.go.html#3824231">extensionALPN</a></span><span class="op" id="3904781">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3904786">d</span>&nbsp;<span class="op" id="3904788">:=</span>&nbsp;<span class="ident" id="3904791"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3904795">[</span><span class="op" id="3904796">:</span><span class="ident" id="3904797"><a href="/crypto/tls/handshake_messages.go.html#3904054">length</a></span><span class="op" id="3904803">]</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3904808">if</span>&nbsp;<span class="builtinfunc" id="3904811">len</span><span class="op" id="3904814">(</span><span class="ident" id="3904815"><a href="/crypto/tls/handshake_messages.go.html#3904786">d</a></span><span class="op" id="3904816">)</span>&nbsp;<span class="op" id="3904818">&lt;</span>&nbsp;<span class="num" id="3904820">3</span>&nbsp;<span class="op" id="3904822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3904828">return</span>&nbsp;<span class="builtintype" id="3904835">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3904844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3904849">l</span>&nbsp;<span class="op" id="3904851">:=</span>&nbsp;<span class="builtintype" id="3904854">int</span><span class="op" id="3904857">(</span><span class="ident" id="3904858"><a href="/crypto/tls/handshake_messages.go.html#3904786">d</a></span><span class="op" id="3904859">[</span><span class="num" id="3904860">0</span><span class="op" id="3904861">]</span><span class="op" id="3904862">)</span><span class="op" id="3904863">&lt;&lt;</span><span class="num" id="3904865">8</span>&nbsp;<span class="op" id="3904867">|</span>&nbsp;<span class="builtintype" id="3904869">int</span><span class="op" id="3904872">(</span><span class="ident" id="3904873"><a href="/crypto/tls/handshake_messages.go.html#3904786">d</a></span><span class="op" id="3904874">[</span><span class="num" id="3904875">1</span><span class="op" id="3904876">]</span><span class="op" id="3904877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3904882">if</span>&nbsp;<span class="ident" id="3904885"><a href="/crypto/tls/handshake_messages.go.html#3904849">l</a></span>&nbsp;<span class="op" id="3904887">!=</span>&nbsp;<span class="builtinfunc" id="3904890">len</span><span class="op" id="3904893">(</span><span class="ident" id="3904894"><a href="/crypto/tls/handshake_messages.go.html#3904786">d</a></span><span class="op" id="3904895">)</span><span class="op" id="3904896">-</span><span class="num" id="3904897">2</span>&nbsp;<span class="op" id="3904899">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3904905">return</span>&nbsp;<span class="builtintype" id="3904912">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3904921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3904926"><a href="/crypto/tls/handshake_messages.go.html#3904786">d</a></span>&nbsp;<span class="op" id="3904928">=</span>&nbsp;<span class="ident" id="3904930"><a href="/crypto/tls/handshake_messages.go.html#3904786">d</a></span><span class="op" id="3904931">[</span><span class="num" id="3904932">2</span><span class="op" id="3904933">:</span><span class="op" id="3904934">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3904939"><a href="/crypto/tls/handshake_messages.go.html#3904849">l</a></span>&nbsp;<span class="op" id="3904941">=</span>&nbsp;<span class="builtintype" id="3904943">int</span><span class="op" id="3904946">(</span><span class="ident" id="3904947"><a href="/crypto/tls/handshake_messages.go.html#3904786">d</a></span><span class="op" id="3904948">[</span><span class="num" id="3904949">0</span><span class="op" id="3904950">]</span><span class="op" id="3904951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3904956">if</span>&nbsp;<span class="ident" id="3904959"><a href="/crypto/tls/handshake_messages.go.html#3904849">l</a></span>&nbsp;<span class="op" id="3904961">!=</span>&nbsp;<span class="builtinfunc" id="3904964">len</span><span class="op" id="3904967">(</span><span class="ident" id="3904968"><a href="/crypto/tls/handshake_messages.go.html#3904786">d</a></span><span class="op" id="3904969">)</span><span class="op" id="3904970">-</span><span class="num" id="3904971">1</span>&nbsp;<span class="op" id="3904973">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3904979">return</span>&nbsp;<span class="builtintype" id="3904986">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3904995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3905000"><a href="/crypto/tls/handshake_messages.go.html#3904786">d</a></span>&nbsp;<span class="op" id="3905002">=</span>&nbsp;<span class="ident" id="3905004"><a href="/crypto/tls/handshake_messages.go.html#3904786">d</a></span><span class="op" id="3905005">[</span><span class="num" id="3905006">1</span><span class="op" id="3905007">:</span><span class="op" id="3905008">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3905013"><a href="/crypto/tls/handshake_messages.go.html#3903071">m</a></span><span class="op" id="3905014">.</span><span class="ident" id="3905015">alpnProtocol</span>&nbsp;<span class="op" id="3905028">=</span>&nbsp;<span class="builtintype" id="3905030">string</span><span class="op" id="3905036">(</span><span class="ident" id="3905037"><a href="/crypto/tls/handshake_messages.go.html#3904786">d</a></span><span class="op" id="3905038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3905042">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3905046"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span>&nbsp;<span class="op" id="3905051">=</span>&nbsp;<span class="ident" id="3905053"><a href="/crypto/tls/handshake_messages.go.html#3903100">data</a></span><span class="op" id="3905057">[</span><span class="ident" id="3905058"><a href="/crypto/tls/handshake_messages.go.html#3904054">length</a></span><span class="op" id="3905064">:</span><span class="op" id="3905065">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3905068">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3905072">return</span>&nbsp;<span class="builtintype" id="3905079">true</span><br>
<span class="lineno"></span><span class="op" id="3905084">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="3905087">type</span>&nbsp;<span class="ident" id="3905092">certificateMsg</span>&nbsp;<span class="keyword" id="3905107">struct</span>&nbsp;<span class="op" id="3905114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3905117">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3905130">[</span><span class="op" id="3905131">]</span><span class="builtintype" id="3905132">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3905138">certificates</span>&nbsp;<span class="op" id="3905151">[</span><span class="op" id="3905152">]</span><span class="op" id="3905153">[</span><span class="op" id="3905154">]</span><span class="builtintype" id="3905155">byte</span><br>
<span class="lineno"></span><span class="op" id="3905160">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="3905163">func</span>&nbsp;<span class="op" id="3905168">(</span><span class="ident" id="3905169">m</span>&nbsp;<span class="op" id="3905171">*</span><span class="ident" id="3905172"><a href="/crypto/tls/handshake_messages.go.html#3905092">certificateMsg</a></span><span class="op" id="3905186">)</span>&nbsp;<span class="ident" id="3905188">equal</span><span class="op" id="3905193">(</span><span class="ident" id="3905194">i</span>&nbsp;<span class="keyword" id="3905196">interface</span><span class="op" id="3905205">{</span><span class="op" id="3905206">}</span><span class="op" id="3905207">)</span>&nbsp;<span class="builtintype" id="3905209">bool</span>&nbsp;<span class="op" id="3905214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3905217">m1</span><span class="op" id="3905219">,</span>&nbsp;<span class="ident" id="3905221">ok</span>&nbsp;<span class="op" id="3905224">:=</span>&nbsp;<span class="ident" id="3905227"><a href="/crypto/tls/handshake_messages.go.html#3905194">i</a></span><span class="op" id="3905228">.</span><span class="op" id="3905229">(</span><span class="op" id="3905230">*</span><span class="ident" id="3905231"><a href="/crypto/tls/handshake_messages.go.html#3905092">certificateMsg</a></span><span class="op" id="3905245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3905248">if</span>&nbsp;<span class="op" id="3905251">!</span><span class="ident" id="3905252"><a href="/crypto/tls/handshake_messages.go.html#3905221">ok</a></span>&nbsp;<span class="op" id="3905255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3905259">return</span>&nbsp;<span class="builtintype" id="3905266">false</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3905273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3905277">return</span>&nbsp;<span class="ident" id="3905284"><a href="/crypto/tls/handshake_messages.go.html#3888584">bytes</a></span><span class="op" id="3905289">.</span><span class="ident" id="3905290">Equal</span><span class="op" id="3905295">(</span><span class="ident" id="3905296"><a href="/crypto/tls/handshake_messages.go.html#3905169">m</a></span><span class="op" id="3905297">.</span><span class="ident" id="3905298">raw</span><span class="op" id="3905301">,</span>&nbsp;<span class="ident" id="3905303"><a href="/crypto/tls/handshake_messages.go.html#3905217">m1</a></span><span class="op" id="3905305">.</span><span class="ident" id="3905306">raw</span><span class="op" id="3905309">)</span>&nbsp;<span class="op" id="3905311">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3905316"><a href="/crypto/tls/handshake_messages.go.html#3918343">eqByteSlices</a></span><span class="op" id="3905328">(</span><span class="ident" id="3905329"><a href="/crypto/tls/handshake_messages.go.html#3905169">m</a></span><span class="op" id="3905330">.</span><span class="ident" id="3905331">certificates</span><span class="op" id="3905343">,</span>&nbsp;<span class="ident" id="3905345"><a href="/crypto/tls/handshake_messages.go.html#3905217">m1</a></span><span class="op" id="3905347">.</span><span class="ident" id="3905348">certificates</span><span class="op" id="3905360">)</span><br>
<span class="lineno"></span><span class="op" id="3905362">}</span><br>
<span class="lineno">730</span><br>
<span class="lineno"></span><span class="keyword" id="3905365">func</span>&nbsp;<span class="op" id="3905370">(</span><span class="ident" id="3905371">m</span>&nbsp;<span class="op" id="3905373">*</span><span class="ident" id="3905374"><a href="/crypto/tls/handshake_messages.go.html#3905092">certificateMsg</a></span><span class="op" id="3905388">)</span>&nbsp;<span class="ident" id="3905390">marshal</span><span class="op" id="3905397">(</span><span class="op" id="3905398">)</span>&nbsp;<span class="op" id="3905400">(</span><span class="ident" id="3905401">x</span>&nbsp;<span class="op" id="3905403">[</span><span class="op" id="3905404">]</span><span class="builtintype" id="3905405">byte</span><span class="op" id="3905409">)</span>&nbsp;<span class="op" id="3905411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3905414">if</span>&nbsp;<span class="ident" id="3905417"><a href="/crypto/tls/handshake_messages.go.html#3905371">m</a></span><span class="op" id="3905418">.</span><span class="ident" id="3905419">raw</span>&nbsp;<span class="op" id="3905423">!=</span>&nbsp;<span class="ident" id="3905426">nil</span>&nbsp;<span class="op" id="3905430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3905434">return</span>&nbsp;<span class="ident" id="3905441"><a href="/crypto/tls/handshake_messages.go.html#3905371">m</a></span><span class="op" id="3905442">.</span><span class="ident" id="3905443">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3905448">}</span><br>
<span class="lineno">735</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3905452">var</span>&nbsp;<span class="ident" id="3905456">i</span>&nbsp;<span class="builtintype" id="3905458">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3905463">for</span>&nbsp;<span class="ident" id="3905467">_</span><span class="op" id="3905468">,</span>&nbsp;<span class="ident" id="3905470">slice</span>&nbsp;<span class="op" id="3905476">:=</span>&nbsp;<span class="keyword" id="3905479">range</span>&nbsp;<span class="ident" id="3905485"><a href="/crypto/tls/handshake_messages.go.html#3905371">m</a></span><span class="op" id="3905486">.</span><span class="ident" id="3905487">certificates</span>&nbsp;<span class="op" id="3905500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3905504"><a href="/crypto/tls/handshake_messages.go.html#3905456">i</a></span>&nbsp;<span class="op" id="3905506">+=</span>&nbsp;<span class="builtinfunc" id="3905509">len</span><span class="op" id="3905512">(</span><span class="ident" id="3905513"><a href="/crypto/tls/handshake_messages.go.html#3905470">slice</a></span><span class="op" id="3905518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3905521">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3905525">length</span>&nbsp;<span class="op" id="3905532">:=</span>&nbsp;<span class="num" id="3905535">3</span>&nbsp;<span class="op" id="3905537">+</span>&nbsp;<span class="num" id="3905539">3</span><span class="op" id="3905540">*</span><span class="builtinfunc" id="3905541">len</span><span class="op" id="3905544">(</span><span class="ident" id="3905545"><a href="/crypto/tls/handshake_messages.go.html#3905371">m</a></span><span class="op" id="3905546">.</span><span class="ident" id="3905547">certificates</span><span class="op" id="3905559">)</span>&nbsp;<span class="op" id="3905561">+</span>&nbsp;<span class="ident" id="3905563"><a href="/crypto/tls/handshake_messages.go.html#3905456">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3905566"><a href="/crypto/tls/handshake_messages.go.html#3905401">x</a></span>&nbsp;<span class="op" id="3905568">=</span>&nbsp;<span class="builtinfunc" id="3905570">make</span><span class="op" id="3905574">(</span><span class="op" id="3905575">[</span><span class="op" id="3905576">]</span><span class="builtintype" id="3905577">byte</span><span class="op" id="3905581">,</span>&nbsp;<span class="num" id="3905583">4</span><span class="op" id="3905584">+</span><span class="ident" id="3905585"><a href="/crypto/tls/handshake_messages.go.html#3905525">length</a></span><span class="op" id="3905591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3905594"><a href="/crypto/tls/handshake_messages.go.html#3905401">x</a></span><span class="op" id="3905595">[</span><span class="num" id="3905596">0</span><span class="op" id="3905597">]</span>&nbsp;<span class="op" id="3905599">=</span>&nbsp;<span class="ident" id="3905601"><a href="/crypto/tls/common.go.html#3823587">typeCertificate</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3905618"><a href="/crypto/tls/handshake_messages.go.html#3905401">x</a></span><span class="op" id="3905619">[</span><span class="num" id="3905620">1</span><span class="op" id="3905621">]</span>&nbsp;<span class="op" id="3905623">=</span>&nbsp;<span class="builtintype" id="3905625">uint8</span><span class="op" id="3905630">(</span><span class="ident" id="3905631"><a href="/crypto/tls/handshake_messages.go.html#3905525">length</a></span>&nbsp;<span class="op" id="3905638">&gt;&gt;</span>&nbsp;<span class="num" id="3905641">16</span><span class="op" id="3905643">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3905646"><a href="/crypto/tls/handshake_messages.go.html#3905401">x</a></span><span class="op" id="3905647">[</span><span class="num" id="3905648">2</span><span class="op" id="3905649">]</span>&nbsp;<span class="op" id="3905651">=</span>&nbsp;<span class="builtintype" id="3905653">uint8</span><span class="op" id="3905658">(</span><span class="ident" id="3905659"><a href="/crypto/tls/handshake_messages.go.html#3905525">length</a></span>&nbsp;<span class="op" id="3905666">&gt;&gt;</span>&nbsp;<span class="num" id="3905669">8</span><span class="op" id="3905670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3905673"><a href="/crypto/tls/handshake_messages.go.html#3905401">x</a></span><span class="op" id="3905674">[</span><span class="num" id="3905675">3</span><span class="op" id="3905676">]</span>&nbsp;<span class="op" id="3905678">=</span>&nbsp;<span class="builtintype" id="3905680">uint8</span><span class="op" id="3905685">(</span><span class="ident" id="3905686"><a href="/crypto/tls/handshake_messages.go.html#3905525">length</a></span><span class="op" id="3905692">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3905696">certificateOctets</span>&nbsp;<span class="op" id="3905714">:=</span>&nbsp;<span class="ident" id="3905717"><a href="/crypto/tls/handshake_messages.go.html#3905525">length</a></span>&nbsp;<span class="op" id="3905724">-</span>&nbsp;<span class="num" id="3905726">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3905729"><a href="/crypto/tls/handshake_messages.go.html#3905401">x</a></span><span class="op" id="3905730">[</span><span class="num" id="3905731">4</span><span class="op" id="3905732">]</span>&nbsp;<span class="op" id="3905734">=</span>&nbsp;<span class="builtintype" id="3905736">uint8</span><span class="op" id="3905741">(</span><span class="ident" id="3905742"><a href="/crypto/tls/handshake_messages.go.html#3905696">certificateOctets</a></span>&nbsp;<span class="op" id="3905760">&gt;&gt;</span>&nbsp;<span class="num" id="3905763">16</span><span class="op" id="3905765">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3905768"><a href="/crypto/tls/handshake_messages.go.html#3905401">x</a></span><span class="op" id="3905769">[</span><span class="num" id="3905770">5</span><span class="op" id="3905771">]</span>&nbsp;<span class="op" id="3905773">=</span>&nbsp;<span class="builtintype" id="3905775">uint8</span><span class="op" id="3905780">(</span><span class="ident" id="3905781"><a href="/crypto/tls/handshake_messages.go.html#3905696">certificateOctets</a></span>&nbsp;<span class="op" id="3905799">&gt;&gt;</span>&nbsp;<span class="num" id="3905802">8</span><span class="op" id="3905803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3905806"><a href="/crypto/tls/handshake_messages.go.html#3905401">x</a></span><span class="op" id="3905807">[</span><span class="num" id="3905808">6</span><span class="op" id="3905809">]</span>&nbsp;<span class="op" id="3905811">=</span>&nbsp;<span class="builtintype" id="3905813">uint8</span><span class="op" id="3905818">(</span><span class="ident" id="3905819"><a href="/crypto/tls/handshake_messages.go.html#3905696">certificateOctets</a></span><span class="op" id="3905836">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3905840">y</span>&nbsp;<span class="op" id="3905842">:=</span>&nbsp;<span class="ident" id="3905845"><a href="/crypto/tls/handshake_messages.go.html#3905401">x</a></span><span class="op" id="3905846">[</span><span class="num" id="3905847">7</span><span class="op" id="3905848">:</span><span class="op" id="3905849">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3905852">for</span>&nbsp;<span class="ident" id="3905856">_</span><span class="op" id="3905857">,</span>&nbsp;<span class="ident" id="3905859">slice</span>&nbsp;<span class="op" id="3905865">:=</span>&nbsp;<span class="keyword" id="3905868">range</span>&nbsp;<span class="ident" id="3905874"><a href="/crypto/tls/handshake_messages.go.html#3905371">m</a></span><span class="op" id="3905875">.</span><span class="ident" id="3905876">certificates</span>&nbsp;<span class="op" id="3905889">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3905893"><a href="/crypto/tls/handshake_messages.go.html#3905840">y</a></span><span class="op" id="3905894">[</span><span class="num" id="3905895">0</span><span class="op" id="3905896">]</span>&nbsp;<span class="op" id="3905898">=</span>&nbsp;<span class="builtintype" id="3905900">uint8</span><span class="op" id="3905905">(</span><span class="builtinfunc" id="3905906">len</span><span class="op" id="3905909">(</span><span class="ident" id="3905910"><a href="/crypto/tls/handshake_messages.go.html#3905859">slice</a></span><span class="op" id="3905915">)</span>&nbsp;<span class="op" id="3905917">&gt;&gt;</span>&nbsp;<span class="num" id="3905920">16</span><span class="op" id="3905922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3905926"><a href="/crypto/tls/handshake_messages.go.html#3905840">y</a></span><span class="op" id="3905927">[</span><span class="num" id="3905928">1</span><span class="op" id="3905929">]</span>&nbsp;<span class="op" id="3905931">=</span>&nbsp;<span class="builtintype" id="3905933">uint8</span><span class="op" id="3905938">(</span><span class="builtinfunc" id="3905939">len</span><span class="op" id="3905942">(</span><span class="ident" id="3905943"><a href="/crypto/tls/handshake_messages.go.html#3905859">slice</a></span><span class="op" id="3905948">)</span>&nbsp;<span class="op" id="3905950">&gt;&gt;</span>&nbsp;<span class="num" id="3905953">8</span><span class="op" id="3905954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3905958"><a href="/crypto/tls/handshake_messages.go.html#3905840">y</a></span><span class="op" id="3905959">[</span><span class="num" id="3905960">2</span><span class="op" id="3905961">]</span>&nbsp;<span class="op" id="3905963">=</span>&nbsp;<span class="builtintype" id="3905965">uint8</span><span class="op" id="3905970">(</span><span class="builtinfunc" id="3905971">len</span><span class="op" id="3905974">(</span><span class="ident" id="3905975"><a href="/crypto/tls/handshake_messages.go.html#3905859">slice</a></span><span class="op" id="3905980">)</span><span class="op" id="3905981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3905985">copy</span><span class="op" id="3905989">(</span><span class="ident" id="3905990"><a href="/crypto/tls/handshake_messages.go.html#3905840">y</a></span><span class="op" id="3905991">[</span><span class="num" id="3905992">3</span><span class="op" id="3905993">:</span><span class="op" id="3905994">]</span><span class="op" id="3905995">,</span>&nbsp;<span class="ident" id="3905997"><a href="/crypto/tls/handshake_messages.go.html#3905859">slice</a></span><span class="op" id="3906002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3906006"><a href="/crypto/tls/handshake_messages.go.html#3905840">y</a></span>&nbsp;<span class="op" id="3906008">=</span>&nbsp;<span class="ident" id="3906010"><a href="/crypto/tls/handshake_messages.go.html#3905840">y</a></span><span class="op" id="3906011">[</span><span class="num" id="3906012">3</span><span class="op" id="3906013">+</span><span class="builtinfunc" id="3906014">len</span><span class="op" id="3906017">(</span><span class="ident" id="3906018"><a href="/crypto/tls/handshake_messages.go.html#3905859">slice</a></span><span class="op" id="3906023">)</span><span class="op" id="3906024">:</span><span class="op" id="3906025">]</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3906028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3906032"><a href="/crypto/tls/handshake_messages.go.html#3905371">m</a></span><span class="op" id="3906033">.</span><span class="ident" id="3906034">raw</span>&nbsp;<span class="op" id="3906038">=</span>&nbsp;<span class="ident" id="3906040"><a href="/crypto/tls/handshake_messages.go.html#3905401">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3906043">return</span><br>
<span class="lineno"></span><span class="op" id="3906050">}</span><br>
<span class="lineno">765</span><br>
<span class="lineno"></span><span class="keyword" id="3906053">func</span>&nbsp;<span class="op" id="3906058">(</span><span class="ident" id="3906059">m</span>&nbsp;<span class="op" id="3906061">*</span><span class="ident" id="3906062"><a href="/crypto/tls/handshake_messages.go.html#3905092">certificateMsg</a></span><span class="op" id="3906076">)</span>&nbsp;<span class="ident" id="3906078">unmarshal</span><span class="op" id="3906087">(</span><span class="ident" id="3906088">data</span>&nbsp;<span class="op" id="3906093">[</span><span class="op" id="3906094">]</span><span class="builtintype" id="3906095">byte</span><span class="op" id="3906099">)</span>&nbsp;<span class="builtintype" id="3906101">bool</span>&nbsp;<span class="op" id="3906106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3906109">if</span>&nbsp;<span class="builtinfunc" id="3906112">len</span><span class="op" id="3906115">(</span><span class="ident" id="3906116"><a href="/crypto/tls/handshake_messages.go.html#3906088">data</a></span><span class="op" id="3906120">)</span>&nbsp;<span class="op" id="3906122">&lt;</span>&nbsp;<span class="num" id="3906124">7</span>&nbsp;<span class="op" id="3906126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3906130">return</span>&nbsp;<span class="builtintype" id="3906137">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3906144">}</span><br>
<span class="lineno">770</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3906148"><a href="/crypto/tls/handshake_messages.go.html#3906059">m</a></span><span class="op" id="3906149">.</span><span class="ident" id="3906150">raw</span>&nbsp;<span class="op" id="3906154">=</span>&nbsp;<span class="ident" id="3906156"><a href="/crypto/tls/handshake_messages.go.html#3906088">data</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3906162">certsLen</span>&nbsp;<span class="op" id="3906171">:=</span>&nbsp;<span class="builtintype" id="3906174">uint32</span><span class="op" id="3906180">(</span><span class="ident" id="3906181"><a href="/crypto/tls/handshake_messages.go.html#3906088">data</a></span><span class="op" id="3906185">[</span><span class="num" id="3906186">4</span><span class="op" id="3906187">]</span><span class="op" id="3906188">)</span><span class="op" id="3906189">&lt;&lt;</span><span class="num" id="3906191">16</span>&nbsp;<span class="op" id="3906194">|</span>&nbsp;<span class="builtintype" id="3906196">uint32</span><span class="op" id="3906202">(</span><span class="ident" id="3906203"><a href="/crypto/tls/handshake_messages.go.html#3906088">data</a></span><span class="op" id="3906207">[</span><span class="num" id="3906208">5</span><span class="op" id="3906209">]</span><span class="op" id="3906210">)</span><span class="op" id="3906211">&lt;&lt;</span><span class="num" id="3906213">8</span>&nbsp;<span class="op" id="3906215">|</span>&nbsp;<span class="builtintype" id="3906217">uint32</span><span class="op" id="3906223">(</span><span class="ident" id="3906224"><a href="/crypto/tls/handshake_messages.go.html#3906088">data</a></span><span class="op" id="3906228">[</span><span class="num" id="3906229">6</span><span class="op" id="3906230">]</span><span class="op" id="3906231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3906234">if</span>&nbsp;<span class="builtintype" id="3906237">uint32</span><span class="op" id="3906243">(</span><span class="builtinfunc" id="3906244">len</span><span class="op" id="3906247">(</span><span class="ident" id="3906248"><a href="/crypto/tls/handshake_messages.go.html#3906088">data</a></span><span class="op" id="3906252">)</span><span class="op" id="3906253">)</span>&nbsp;<span class="op" id="3906255">!=</span>&nbsp;<span class="ident" id="3906258"><a href="/crypto/tls/handshake_messages.go.html#3906162">certsLen</a></span><span class="op" id="3906266">+</span><span class="num" id="3906267">7</span>&nbsp;<span class="op" id="3906269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3906273">return</span>&nbsp;<span class="builtintype" id="3906280">false</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3906287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3906291">numCerts</span>&nbsp;<span class="op" id="3906300">:=</span>&nbsp;<span class="num" id="3906303">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3906306">d</span>&nbsp;<span class="op" id="3906308">:=</span>&nbsp;<span class="ident" id="3906311"><a href="/crypto/tls/handshake_messages.go.html#3906088">data</a></span><span class="op" id="3906315">[</span><span class="num" id="3906316">7</span><span class="op" id="3906317">:</span><span class="op" id="3906318">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3906321">for</span>&nbsp;<span class="ident" id="3906325"><a href="/crypto/tls/handshake_messages.go.html#3906162">certsLen</a></span>&nbsp;<span class="op" id="3906334">&gt;</span>&nbsp;<span class="num" id="3906336">0</span>&nbsp;<span class="op" id="3906338">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3906342">if</span>&nbsp;<span class="builtinfunc" id="3906345">len</span><span class="op" id="3906348">(</span><span class="ident" id="3906349"><a href="/crypto/tls/handshake_messages.go.html#3906306">d</a></span><span class="op" id="3906350">)</span>&nbsp;<span class="op" id="3906352">&lt;</span>&nbsp;<span class="num" id="3906354">4</span>&nbsp;<span class="op" id="3906356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3906361">return</span>&nbsp;<span class="builtintype" id="3906368">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3906376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3906380">certLen</span>&nbsp;<span class="op" id="3906388">:=</span>&nbsp;<span class="builtintype" id="3906391">uint32</span><span class="op" id="3906397">(</span><span class="ident" id="3906398"><a href="/crypto/tls/handshake_messages.go.html#3906306">d</a></span><span class="op" id="3906399">[</span><span class="num" id="3906400">0</span><span class="op" id="3906401">]</span><span class="op" id="3906402">)</span><span class="op" id="3906403">&lt;&lt;</span><span class="num" id="3906405">16</span>&nbsp;<span class="op" id="3906408">|</span>&nbsp;<span class="builtintype" id="3906410">uint32</span><span class="op" id="3906416">(</span><span class="ident" id="3906417"><a href="/crypto/tls/handshake_messages.go.html#3906306">d</a></span><span class="op" id="3906418">[</span><span class="num" id="3906419">1</span><span class="op" id="3906420">]</span><span class="op" id="3906421">)</span><span class="op" id="3906422">&lt;&lt;</span><span class="num" id="3906424">8</span>&nbsp;<span class="op" id="3906426">|</span>&nbsp;<span class="builtintype" id="3906428">uint32</span><span class="op" id="3906434">(</span><span class="ident" id="3906435"><a href="/crypto/tls/handshake_messages.go.html#3906306">d</a></span><span class="op" id="3906436">[</span><span class="num" id="3906437">2</span><span class="op" id="3906438">]</span><span class="op" id="3906439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3906443">if</span>&nbsp;<span class="builtintype" id="3906446">uint32</span><span class="op" id="3906452">(</span><span class="builtinfunc" id="3906453">len</span><span class="op" id="3906456">(</span><span class="ident" id="3906457"><a href="/crypto/tls/handshake_messages.go.html#3906306">d</a></span><span class="op" id="3906458">)</span><span class="op" id="3906459">)</span>&nbsp;<span class="op" id="3906461">&lt;</span>&nbsp;<span class="num" id="3906463">3</span><span class="op" id="3906464">+</span><span class="ident" id="3906465"><a href="/crypto/tls/handshake_messages.go.html#3906380">certLen</a></span>&nbsp;<span class="op" id="3906473">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3906478">return</span>&nbsp;<span class="builtintype" id="3906485">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3906493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3906497"><a href="/crypto/tls/handshake_messages.go.html#3906306">d</a></span>&nbsp;<span class="op" id="3906499">=</span>&nbsp;<span class="ident" id="3906501"><a href="/crypto/tls/handshake_messages.go.html#3906306">d</a></span><span class="op" id="3906502">[</span><span class="num" id="3906503">3</span><span class="op" id="3906504">+</span><span class="ident" id="3906505"><a href="/crypto/tls/handshake_messages.go.html#3906380">certLen</a></span><span class="op" id="3906512">:</span><span class="op" id="3906513">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3906517"><a href="/crypto/tls/handshake_messages.go.html#3906162">certsLen</a></span>&nbsp;<span class="op" id="3906526">-=</span>&nbsp;<span class="num" id="3906529">3</span>&nbsp;<span class="op" id="3906531">+</span>&nbsp;<span class="ident" id="3906533"><a href="/crypto/tls/handshake_messages.go.html#3906380">certLen</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3906543"><a href="/crypto/tls/handshake_messages.go.html#3906291">numCerts</a></span><span class="op" id="3906551">++</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3906555">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3906559"><a href="/crypto/tls/handshake_messages.go.html#3906059">m</a></span><span class="op" id="3906560">.</span><span class="ident" id="3906561">certificates</span>&nbsp;<span class="op" id="3906574">=</span>&nbsp;<span class="builtinfunc" id="3906576">make</span><span class="op" id="3906580">(</span><span class="op" id="3906581">[</span><span class="op" id="3906582">]</span><span class="op" id="3906583">[</span><span class="op" id="3906584">]</span><span class="builtintype" id="3906585">byte</span><span class="op" id="3906589">,</span>&nbsp;<span class="ident" id="3906591"><a href="/crypto/tls/handshake_messages.go.html#3906291">numCerts</a></span><span class="op" id="3906599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3906602"><a href="/crypto/tls/handshake_messages.go.html#3906306">d</a></span>&nbsp;<span class="op" id="3906604">=</span>&nbsp;<span class="ident" id="3906606"><a href="/crypto/tls/handshake_messages.go.html#3906088">data</a></span><span class="op" id="3906610">[</span><span class="num" id="3906611">7</span><span class="op" id="3906612">:</span><span class="op" id="3906613">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3906616">for</span>&nbsp;<span class="ident" id="3906620">i</span>&nbsp;<span class="op" id="3906622">:=</span>&nbsp;<span class="num" id="3906625">0</span><span class="op" id="3906626">;</span>&nbsp;<span class="ident" id="3906628"><a href="/crypto/tls/handshake_messages.go.html#3906620">i</a></span>&nbsp;<span class="op" id="3906630">&lt;</span>&nbsp;<span class="ident" id="3906632"><a href="/crypto/tls/handshake_messages.go.html#3906291">numCerts</a></span><span class="op" id="3906640">;</span>&nbsp;<span class="ident" id="3906642"><a href="/crypto/tls/handshake_messages.go.html#3906620">i</a></span><span class="op" id="3906643">++</span>&nbsp;<span class="op" id="3906646">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3906650">certLen</span>&nbsp;<span class="op" id="3906658">:=</span>&nbsp;<span class="builtintype" id="3906661">uint32</span><span class="op" id="3906667">(</span><span class="ident" id="3906668"><a href="/crypto/tls/handshake_messages.go.html#3906306">d</a></span><span class="op" id="3906669">[</span><span class="num" id="3906670">0</span><span class="op" id="3906671">]</span><span class="op" id="3906672">)</span><span class="op" id="3906673">&lt;&lt;</span><span class="num" id="3906675">16</span>&nbsp;<span class="op" id="3906678">|</span>&nbsp;<span class="builtintype" id="3906680">uint32</span><span class="op" id="3906686">(</span><span class="ident" id="3906687"><a href="/crypto/tls/handshake_messages.go.html#3906306">d</a></span><span class="op" id="3906688">[</span><span class="num" id="3906689">1</span><span class="op" id="3906690">]</span><span class="op" id="3906691">)</span><span class="op" id="3906692">&lt;&lt;</span><span class="num" id="3906694">8</span>&nbsp;<span class="op" id="3906696">|</span>&nbsp;<span class="builtintype" id="3906698">uint32</span><span class="op" id="3906704">(</span><span class="ident" id="3906705"><a href="/crypto/tls/handshake_messages.go.html#3906306">d</a></span><span class="op" id="3906706">[</span><span class="num" id="3906707">2</span><span class="op" id="3906708">]</span><span class="op" id="3906709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3906713"><a href="/crypto/tls/handshake_messages.go.html#3906059">m</a></span><span class="op" id="3906714">.</span><span class="ident" id="3906715">certificates</span><span class="op" id="3906727">[</span><span class="ident" id="3906728"><a href="/crypto/tls/handshake_messages.go.html#3906620">i</a></span><span class="op" id="3906729">]</span>&nbsp;<span class="op" id="3906731">=</span>&nbsp;<span class="ident" id="3906733"><a href="/crypto/tls/handshake_messages.go.html#3906306">d</a></span><span class="op" id="3906734">[</span><span class="num" id="3906735">3</span>&nbsp;<span class="op" id="3906737">:</span>&nbsp;<span class="num" id="3906739">3</span><span class="op" id="3906740">+</span><span class="ident" id="3906741"><a href="/crypto/tls/handshake_messages.go.html#3906650">certLen</a></span><span class="op" id="3906748">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3906752"><a href="/crypto/tls/handshake_messages.go.html#3906306">d</a></span>&nbsp;<span class="op" id="3906754">=</span>&nbsp;<span class="ident" id="3906756"><a href="/crypto/tls/handshake_messages.go.html#3906306">d</a></span><span class="op" id="3906757">[</span><span class="num" id="3906758">3</span><span class="op" id="3906759">+</span><span class="ident" id="3906760"><a href="/crypto/tls/handshake_messages.go.html#3906650">certLen</a></span><span class="op" id="3906767">:</span><span class="op" id="3906768">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3906771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3906775">return</span>&nbsp;<span class="builtintype" id="3906782">true</span><br>
<span class="lineno"></span><span class="op" id="3906787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3906790">type</span>&nbsp;<span class="ident" id="3906795">serverKeyExchangeMsg</span>&nbsp;<span class="keyword" id="3906816">struct</span>&nbsp;<span class="op" id="3906823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3906826">raw</span>&nbsp;<span class="op" id="3906830">[</span><span class="op" id="3906831">]</span><span class="builtintype" id="3906832">byte</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3906838">key</span>&nbsp;<span class="op" id="3906842">[</span><span class="op" id="3906843">]</span><span class="builtintype" id="3906844">byte</span><br>
<span class="lineno"></span><span class="op" id="3906849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3906852">func</span>&nbsp;<span class="op" id="3906857">(</span><span class="ident" id="3906858">m</span>&nbsp;<span class="op" id="3906860">*</span><span class="ident" id="3906861"><a href="/crypto/tls/handshake_messages.go.html#3906795">serverKeyExchangeMsg</a></span><span class="op" id="3906881">)</span>&nbsp;<span class="ident" id="3906883">equal</span><span class="op" id="3906888">(</span><span class="ident" id="3906889">i</span>&nbsp;<span class="keyword" id="3906891">interface</span><span class="op" id="3906900">{</span><span class="op" id="3906901">}</span><span class="op" id="3906902">)</span>&nbsp;<span class="builtintype" id="3906904">bool</span>&nbsp;<span class="op" id="3906909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3906912">m1</span><span class="op" id="3906914">,</span>&nbsp;<span class="ident" id="3906916">ok</span>&nbsp;<span class="op" id="3906919">:=</span>&nbsp;<span class="ident" id="3906922"><a href="/crypto/tls/handshake_messages.go.html#3906889">i</a></span><span class="op" id="3906923">.</span><span class="op" id="3906924">(</span><span class="op" id="3906925">*</span><span class="ident" id="3906926"><a href="/crypto/tls/handshake_messages.go.html#3906795">serverKeyExchangeMsg</a></span><span class="op" id="3906946">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3906949">if</span>&nbsp;<span class="op" id="3906952">!</span><span class="ident" id="3906953"><a href="/crypto/tls/handshake_messages.go.html#3906916">ok</a></span>&nbsp;<span class="op" id="3906956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3906960">return</span>&nbsp;<span class="builtintype" id="3906967">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3906974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3906978">return</span>&nbsp;<span class="ident" id="3906985"><a href="/crypto/tls/handshake_messages.go.html#3888584">bytes</a></span><span class="op" id="3906990">.</span><span class="ident" id="3906991">Equal</span><span class="op" id="3906996">(</span><span class="ident" id="3906997"><a href="/crypto/tls/handshake_messages.go.html#3906858">m</a></span><span class="op" id="3906998">.</span><span class="ident" id="3906999">raw</span><span class="op" id="3907002">,</span>&nbsp;<span class="ident" id="3907004"><a href="/crypto/tls/handshake_messages.go.html#3906912">m1</a></span><span class="op" id="3907006">.</span><span class="ident" id="3907007">raw</span><span class="op" id="3907010">)</span>&nbsp;<span class="op" id="3907012">&amp;&amp;</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3907017"><a href="/crypto/tls/handshake_messages.go.html#3888584">bytes</a></span><span class="op" id="3907022">.</span><span class="ident" id="3907023">Equal</span><span class="op" id="3907028">(</span><span class="ident" id="3907029"><a href="/crypto/tls/handshake_messages.go.html#3906858">m</a></span><span class="op" id="3907030">.</span><span class="ident" id="3907031">key</span><span class="op" id="3907034">,</span>&nbsp;<span class="ident" id="3907036"><a href="/crypto/tls/handshake_messages.go.html#3906912">m1</a></span><span class="op" id="3907038">.</span><span class="ident" id="3907039">key</span><span class="op" id="3907042">)</span><br>
<span class="lineno"></span><span class="op" id="3907044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3907047">func</span>&nbsp;<span class="op" id="3907052">(</span><span class="ident" id="3907053">m</span>&nbsp;<span class="op" id="3907055">*</span><span class="ident" id="3907056"><a href="/crypto/tls/handshake_messages.go.html#3906795">serverKeyExchangeMsg</a></span><span class="op" id="3907076">)</span>&nbsp;<span class="ident" id="3907078">marshal</span><span class="op" id="3907085">(</span><span class="op" id="3907086">)</span>&nbsp;<span class="op" id="3907088">[</span><span class="op" id="3907089">]</span><span class="builtintype" id="3907090">byte</span>&nbsp;<span class="op" id="3907095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3907098">if</span>&nbsp;<span class="ident" id="3907101"><a href="/crypto/tls/handshake_messages.go.html#3907053">m</a></span><span class="op" id="3907102">.</span><span class="ident" id="3907103">raw</span>&nbsp;<span class="op" id="3907107">!=</span>&nbsp;<span class="ident" id="3907110">nil</span>&nbsp;<span class="op" id="3907114">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3907118">return</span>&nbsp;<span class="ident" id="3907125"><a href="/crypto/tls/handshake_messages.go.html#3907053">m</a></span><span class="op" id="3907126">.</span><span class="ident" id="3907127">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3907132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3907135">length</span>&nbsp;<span class="op" id="3907142">:=</span>&nbsp;<span class="builtinfunc" id="3907145">len</span><span class="op" id="3907148">(</span><span class="ident" id="3907149"><a href="/crypto/tls/handshake_messages.go.html#3907053">m</a></span><span class="op" id="3907150">.</span><span class="ident" id="3907151">key</span><span class="op" id="3907154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3907157">x</span>&nbsp;<span class="op" id="3907159">:=</span>&nbsp;<span class="builtinfunc" id="3907162">make</span><span class="op" id="3907166">(</span><span class="op" id="3907167">[</span><span class="op" id="3907168">]</span><span class="builtintype" id="3907169">byte</span><span class="op" id="3907173">,</span>&nbsp;<span class="ident" id="3907175"><a href="/crypto/tls/handshake_messages.go.html#3907135">length</a></span><span class="op" id="3907181">+</span><span class="num" id="3907182">4</span><span class="op" id="3907183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3907186"><a href="/crypto/tls/handshake_messages.go.html#3907157">x</a></span><span class="op" id="3907187">[</span><span class="num" id="3907188">0</span><span class="op" id="3907189">]</span>&nbsp;<span class="op" id="3907191">=</span>&nbsp;<span class="ident" id="3907193"><a href="/crypto/tls/common.go.html#3823622">typeServerKeyExchange</a></span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3907216"><a href="/crypto/tls/handshake_messages.go.html#3907157">x</a></span><span class="op" id="3907217">[</span><span class="num" id="3907218">1</span><span class="op" id="3907219">]</span>&nbsp;<span class="op" id="3907221">=</span>&nbsp;<span class="builtintype" id="3907223">uint8</span><span class="op" id="3907228">(</span><span class="ident" id="3907229"><a href="/crypto/tls/handshake_messages.go.html#3907135">length</a></span>&nbsp;<span class="op" id="3907236">&gt;&gt;</span>&nbsp;<span class="num" id="3907239">16</span><span class="op" id="3907241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3907244"><a href="/crypto/tls/handshake_messages.go.html#3907157">x</a></span><span class="op" id="3907245">[</span><span class="num" id="3907246">2</span><span class="op" id="3907247">]</span>&nbsp;<span class="op" id="3907249">=</span>&nbsp;<span class="builtintype" id="3907251">uint8</span><span class="op" id="3907256">(</span><span class="ident" id="3907257"><a href="/crypto/tls/handshake_messages.go.html#3907135">length</a></span>&nbsp;<span class="op" id="3907264">&gt;&gt;</span>&nbsp;<span class="num" id="3907267">8</span><span class="op" id="3907268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3907271"><a href="/crypto/tls/handshake_messages.go.html#3907157">x</a></span><span class="op" id="3907272">[</span><span class="num" id="3907273">3</span><span class="op" id="3907274">]</span>&nbsp;<span class="op" id="3907276">=</span>&nbsp;<span class="builtintype" id="3907278">uint8</span><span class="op" id="3907283">(</span><span class="ident" id="3907284"><a href="/crypto/tls/handshake_messages.go.html#3907135">length</a></span><span class="op" id="3907290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3907293">copy</span><span class="op" id="3907297">(</span><span class="ident" id="3907298"><a href="/crypto/tls/handshake_messages.go.html#3907157">x</a></span><span class="op" id="3907299">[</span><span class="num" id="3907300">4</span><span class="op" id="3907301">:</span><span class="op" id="3907302">]</span><span class="op" id="3907303">,</span>&nbsp;<span class="ident" id="3907305"><a href="/crypto/tls/handshake_messages.go.html#3907053">m</a></span><span class="op" id="3907306">.</span><span class="ident" id="3907307">key</span><span class="op" id="3907310">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3907314"><a href="/crypto/tls/handshake_messages.go.html#3907053">m</a></span><span class="op" id="3907315">.</span><span class="ident" id="3907316">raw</span>&nbsp;<span class="op" id="3907320">=</span>&nbsp;<span class="ident" id="3907322"><a href="/crypto/tls/handshake_messages.go.html#3907157">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3907325">return</span>&nbsp;<span class="ident" id="3907332"><a href="/crypto/tls/handshake_messages.go.html#3907157">x</a></span><br>
<span class="lineno"></span><span class="op" id="3907334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3907337">func</span>&nbsp;<span class="op" id="3907342">(</span><span class="ident" id="3907343">m</span>&nbsp;<span class="op" id="3907345">*</span><span class="ident" id="3907346"><a href="/crypto/tls/handshake_messages.go.html#3906795">serverKeyExchangeMsg</a></span><span class="op" id="3907366">)</span>&nbsp;<span class="ident" id="3907368">unmarshal</span><span class="op" id="3907377">(</span><span class="ident" id="3907378">data</span>&nbsp;<span class="op" id="3907383">[</span><span class="op" id="3907384">]</span><span class="builtintype" id="3907385">byte</span><span class="op" id="3907389">)</span>&nbsp;<span class="builtintype" id="3907391">bool</span>&nbsp;<span class="op" id="3907396">{</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3907399"><a href="/crypto/tls/handshake_messages.go.html#3907343">m</a></span><span class="op" id="3907400">.</span><span class="ident" id="3907401">raw</span>&nbsp;<span class="op" id="3907405">=</span>&nbsp;<span class="ident" id="3907407"><a href="/crypto/tls/handshake_messages.go.html#3907378">data</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3907413">if</span>&nbsp;<span class="builtinfunc" id="3907416">len</span><span class="op" id="3907419">(</span><span class="ident" id="3907420"><a href="/crypto/tls/handshake_messages.go.html#3907378">data</a></span><span class="op" id="3907424">)</span>&nbsp;<span class="op" id="3907426">&lt;</span>&nbsp;<span class="num" id="3907428">4</span>&nbsp;<span class="op" id="3907430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3907434">return</span>&nbsp;<span class="builtintype" id="3907441">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3907448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3907451"><a href="/crypto/tls/handshake_messages.go.html#3907343">m</a></span><span class="op" id="3907452">.</span><span class="ident" id="3907453">key</span>&nbsp;<span class="op" id="3907457">=</span>&nbsp;<span class="ident" id="3907459"><a href="/crypto/tls/handshake_messages.go.html#3907378">data</a></span><span class="op" id="3907463">[</span><span class="num" id="3907464">4</span><span class="op" id="3907465">:</span><span class="op" id="3907466">]</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3907469">return</span>&nbsp;<span class="builtintype" id="3907476">true</span><br>
<span class="lineno"></span><span class="op" id="3907481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3907484">type</span>&nbsp;<span class="ident" id="3907489">certificateStatusMsg</span>&nbsp;<span class="keyword" id="3907510">struct</span>&nbsp;<span class="op" id="3907517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3907520">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3907531">[</span><span class="op" id="3907532">]</span><span class="builtintype" id="3907533">byte</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3907539">statusType</span>&nbsp;<span class="builtintype" id="3907550">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3907557">response</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3907568">[</span><span class="op" id="3907569">]</span><span class="builtintype" id="3907570">byte</span><br>
<span class="lineno"></span><span class="op" id="3907575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3907578">func</span>&nbsp;<span class="op" id="3907583">(</span><span class="ident" id="3907584">m</span>&nbsp;<span class="op" id="3907586">*</span><span class="ident" id="3907587"><a href="/crypto/tls/handshake_messages.go.html#3907489">certificateStatusMsg</a></span><span class="op" id="3907607">)</span>&nbsp;<span class="ident" id="3907609">equal</span><span class="op" id="3907614">(</span><span class="ident" id="3907615">i</span>&nbsp;<span class="keyword" id="3907617">interface</span><span class="op" id="3907626">{</span><span class="op" id="3907627">}</span><span class="op" id="3907628">)</span>&nbsp;<span class="builtintype" id="3907630">bool</span>&nbsp;<span class="op" id="3907635">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3907638">m1</span><span class="op" id="3907640">,</span>&nbsp;<span class="ident" id="3907642">ok</span>&nbsp;<span class="op" id="3907645">:=</span>&nbsp;<span class="ident" id="3907648"><a href="/crypto/tls/handshake_messages.go.html#3907615">i</a></span><span class="op" id="3907649">.</span><span class="op" id="3907650">(</span><span class="op" id="3907651">*</span><span class="ident" id="3907652"><a href="/crypto/tls/handshake_messages.go.html#3907489">certificateStatusMsg</a></span><span class="op" id="3907672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3907675">if</span>&nbsp;<span class="op" id="3907678">!</span><span class="ident" id="3907679"><a href="/crypto/tls/handshake_messages.go.html#3907642">ok</a></span>&nbsp;<span class="op" id="3907682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3907686">return</span>&nbsp;<span class="builtintype" id="3907693">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3907700">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3907704">return</span>&nbsp;<span class="ident" id="3907711"><a href="/crypto/tls/handshake_messages.go.html#3888584">bytes</a></span><span class="op" id="3907716">.</span><span class="ident" id="3907717">Equal</span><span class="op" id="3907722">(</span><span class="ident" id="3907723"><a href="/crypto/tls/handshake_messages.go.html#3907584">m</a></span><span class="op" id="3907724">.</span><span class="ident" id="3907725">raw</span><span class="op" id="3907728">,</span>&nbsp;<span class="ident" id="3907730"><a href="/crypto/tls/handshake_messages.go.html#3907638">m1</a></span><span class="op" id="3907732">.</span><span class="ident" id="3907733">raw</span><span class="op" id="3907736">)</span>&nbsp;<span class="op" id="3907738">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3907743"><a href="/crypto/tls/handshake_messages.go.html#3907584">m</a></span><span class="op" id="3907744">.</span><span class="ident" id="3907745">statusType</span>&nbsp;<span class="op" id="3907756">==</span>&nbsp;<span class="ident" id="3907759"><a href="/crypto/tls/handshake_messages.go.html#3907638">m1</a></span><span class="op" id="3907761">.</span><span class="ident" id="3907762">statusType</span>&nbsp;<span class="op" id="3907773">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3907778"><a href="/crypto/tls/handshake_messages.go.html#3888584">bytes</a></span><span class="op" id="3907783">.</span><span class="ident" id="3907784">Equal</span><span class="op" id="3907789">(</span><span class="ident" id="3907790"><a href="/crypto/tls/handshake_messages.go.html#3907584">m</a></span><span class="op" id="3907791">.</span><span class="ident" id="3907792">response</span><span class="op" id="3907800">,</span>&nbsp;<span class="ident" id="3907802"><a href="/crypto/tls/handshake_messages.go.html#3907638">m1</a></span><span class="op" id="3907804">.</span><span class="ident" id="3907805">response</span><span class="op" id="3907813">)</span><br>
<span class="lineno"></span><span class="op" id="3907815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="keyword" id="3907818">func</span>&nbsp;<span class="op" id="3907823">(</span><span class="ident" id="3907824">m</span>&nbsp;<span class="op" id="3907826">*</span><span class="ident" id="3907827"><a href="/crypto/tls/handshake_messages.go.html#3907489">certificateStatusMsg</a></span><span class="op" id="3907847">)</span>&nbsp;<span class="ident" id="3907849">marshal</span><span class="op" id="3907856">(</span><span class="op" id="3907857">)</span>&nbsp;<span class="op" id="3907859">[</span><span class="op" id="3907860">]</span><span class="builtintype" id="3907861">byte</span>&nbsp;<span class="op" id="3907866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3907869">if</span>&nbsp;<span class="ident" id="3907872"><a href="/crypto/tls/handshake_messages.go.html#3907824">m</a></span><span class="op" id="3907873">.</span><span class="ident" id="3907874">raw</span>&nbsp;<span class="op" id="3907878">!=</span>&nbsp;<span class="ident" id="3907881">nil</span>&nbsp;<span class="op" id="3907885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3907889">return</span>&nbsp;<span class="ident" id="3907896"><a href="/crypto/tls/handshake_messages.go.html#3907824">m</a></span><span class="op" id="3907897">.</span><span class="ident" id="3907898">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3907903">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3907907">var</span>&nbsp;<span class="ident" id="3907911">x</span>&nbsp;<span class="op" id="3907913">[</span><span class="op" id="3907914">]</span><span class="builtintype" id="3907915">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3907921">if</span>&nbsp;<span class="ident" id="3907924"><a href="/crypto/tls/handshake_messages.go.html#3907824">m</a></span><span class="op" id="3907925">.</span><span class="ident" id="3907926">statusType</span>&nbsp;<span class="op" id="3907937">==</span>&nbsp;<span class="ident" id="3907940"><a href="/crypto/tls/common.go.html#3824989">statusTypeOCSP</a></span>&nbsp;<span class="op" id="3907955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3907959"><a href="/crypto/tls/handshake_messages.go.html#3907911">x</a></span>&nbsp;<span class="op" id="3907961">=</span>&nbsp;<span class="builtinfunc" id="3907963">make</span><span class="op" id="3907967">(</span><span class="op" id="3907968">[</span><span class="op" id="3907969">]</span><span class="builtintype" id="3907970">byte</span><span class="op" id="3907974">,</span>&nbsp;<span class="num" id="3907976">4</span><span class="op" id="3907977">+</span><span class="num" id="3907978">4</span><span class="op" id="3907979">+</span><span class="builtinfunc" id="3907980">len</span><span class="op" id="3907983">(</span><span class="ident" id="3907984"><a href="/crypto/tls/handshake_messages.go.html#3907824">m</a></span><span class="op" id="3907985">.</span><span class="ident" id="3907986">response</span><span class="op" id="3907994">)</span><span class="op" id="3907995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3907999"><a href="/crypto/tls/handshake_messages.go.html#3907911">x</a></span><span class="op" id="3908000">[</span><span class="num" id="3908001">0</span><span class="op" id="3908002">]</span>&nbsp;<span class="op" id="3908004">=</span>&nbsp;<span class="ident" id="3908006"><a href="/crypto/tls/common.go.html#3823832">typeCertificateStatus</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3908030">l</span>&nbsp;<span class="op" id="3908032">:=</span>&nbsp;<span class="builtinfunc" id="3908035">len</span><span class="op" id="3908038">(</span><span class="ident" id="3908039"><a href="/crypto/tls/handshake_messages.go.html#3907824">m</a></span><span class="op" id="3908040">.</span><span class="ident" id="3908041">response</span><span class="op" id="3908049">)</span>&nbsp;<span class="op" id="3908051">+</span>&nbsp;<span class="num" id="3908053">4</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3908057"><a href="/crypto/tls/handshake_messages.go.html#3907911">x</a></span><span class="op" id="3908058">[</span><span class="num" id="3908059">1</span><span class="op" id="3908060">]</span>&nbsp;<span class="op" id="3908062">=</span>&nbsp;<span class="builtintype" id="3908064">byte</span><span class="op" id="3908068">(</span><span class="ident" id="3908069"><a href="/crypto/tls/handshake_messages.go.html#3908030">l</a></span>&nbsp;<span class="op" id="3908071">&gt;&gt;</span>&nbsp;<span class="num" id="3908074">16</span><span class="op" id="3908076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3908080"><a href="/crypto/tls/handshake_messages.go.html#3907911">x</a></span><span class="op" id="3908081">[</span><span class="num" id="3908082">2</span><span class="op" id="3908083">]</span>&nbsp;<span class="op" id="3908085">=</span>&nbsp;<span class="builtintype" id="3908087">byte</span><span class="op" id="3908091">(</span><span class="ident" id="3908092"><a href="/crypto/tls/handshake_messages.go.html#3908030">l</a></span>&nbsp;<span class="op" id="3908094">&gt;&gt;</span>&nbsp;<span class="num" id="3908097">8</span><span class="op" id="3908098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3908102"><a href="/crypto/tls/handshake_messages.go.html#3907911">x</a></span><span class="op" id="3908103">[</span><span class="num" id="3908104">3</span><span class="op" id="3908105">]</span>&nbsp;<span class="op" id="3908107">=</span>&nbsp;<span class="builtintype" id="3908109">byte</span><span class="op" id="3908113">(</span><span class="ident" id="3908114"><a href="/crypto/tls/handshake_messages.go.html#3908030">l</a></span><span class="op" id="3908115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3908119"><a href="/crypto/tls/handshake_messages.go.html#3907911">x</a></span><span class="op" id="3908120">[</span><span class="num" id="3908121">4</span><span class="op" id="3908122">]</span>&nbsp;<span class="op" id="3908124">=</span>&nbsp;<span class="ident" id="3908126"><a href="/crypto/tls/common.go.html#3824989">statusTypeOCSP</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3908144"><a href="/crypto/tls/handshake_messages.go.html#3908030">l</a></span>&nbsp;<span class="op" id="3908146">-=</span>&nbsp;<span class="num" id="3908149">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3908153"><a href="/crypto/tls/handshake_messages.go.html#3907911">x</a></span><span class="op" id="3908154">[</span><span class="num" id="3908155">5</span><span class="op" id="3908156">]</span>&nbsp;<span class="op" id="3908158">=</span>&nbsp;<span class="builtintype" id="3908160">byte</span><span class="op" id="3908164">(</span><span class="ident" id="3908165"><a href="/crypto/tls/handshake_messages.go.html#3908030">l</a></span>&nbsp;<span class="op" id="3908167">&gt;&gt;</span>&nbsp;<span class="num" id="3908170">16</span><span class="op" id="3908172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3908176"><a href="/crypto/tls/handshake_messages.go.html#3907911">x</a></span><span class="op" id="3908177">[</span><span class="num" id="3908178">6</span><span class="op" id="3908179">]</span>&nbsp;<span class="op" id="3908181">=</span>&nbsp;<span class="builtintype" id="3908183">byte</span><span class="op" id="3908187">(</span><span class="ident" id="3908188"><a href="/crypto/tls/handshake_messages.go.html#3908030">l</a></span>&nbsp;<span class="op" id="3908190">&gt;&gt;</span>&nbsp;<span class="num" id="3908193">8</span><span class="op" id="3908194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3908198"><a href="/crypto/tls/handshake_messages.go.html#3907911">x</a></span><span class="op" id="3908199">[</span><span class="num" id="3908200">7</span><span class="op" id="3908201">]</span>&nbsp;<span class="op" id="3908203">=</span>&nbsp;<span class="builtintype" id="3908205">byte</span><span class="op" id="3908209">(</span><span class="ident" id="3908210"><a href="/crypto/tls/handshake_messages.go.html#3908030">l</a></span><span class="op" id="3908211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3908215">copy</span><span class="op" id="3908219">(</span><span class="ident" id="3908220"><a href="/crypto/tls/handshake_messages.go.html#3907911">x</a></span><span class="op" id="3908221">[</span><span class="num" id="3908222">8</span><span class="op" id="3908223">:</span><span class="op" id="3908224">]</span><span class="op" id="3908225">,</span>&nbsp;<span class="ident" id="3908227"><a href="/crypto/tls/handshake_messages.go.html#3907824">m</a></span><span class="op" id="3908228">.</span><span class="ident" id="3908229">response</span><span class="op" id="3908237">)</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3908240">}</span>&nbsp;<span class="keyword" id="3908242">else</span>&nbsp;<span class="op" id="3908247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3908251"><a href="/crypto/tls/handshake_messages.go.html#3907911">x</a></span>&nbsp;<span class="op" id="3908253">=</span>&nbsp;<span class="op" id="3908255">[</span><span class="op" id="3908256">]</span><span class="builtintype" id="3908257">byte</span><span class="op" id="3908261">{</span><span class="ident" id="3908262"><a href="/crypto/tls/common.go.html#3823832">typeCertificateStatus</a></span><span class="op" id="3908283">,</span>&nbsp;<span class="num" id="3908285">0</span><span class="op" id="3908286">,</span>&nbsp;<span class="num" id="3908288">0</span><span class="op" id="3908289">,</span>&nbsp;<span class="num" id="3908291">1</span><span class="op" id="3908292">,</span>&nbsp;<span class="ident" id="3908294"><a href="/crypto/tls/handshake_messages.go.html#3907824">m</a></span><span class="op" id="3908295">.</span><span class="ident" id="3908296">statusType</span><span class="op" id="3908306">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3908309">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3908313"><a href="/crypto/tls/handshake_messages.go.html#3907824">m</a></span><span class="op" id="3908314">.</span><span class="ident" id="3908315">raw</span>&nbsp;<span class="op" id="3908319">=</span>&nbsp;<span class="ident" id="3908321"><a href="/crypto/tls/handshake_messages.go.html#3907911">x</a></span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3908324">return</span>&nbsp;<span class="ident" id="3908331"><a href="/crypto/tls/handshake_messages.go.html#3907911">x</a></span><br>
<span class="lineno"></span><span class="op" id="3908333">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3908336">func</span>&nbsp;<span class="op" id="3908341">(</span><span class="ident" id="3908342">m</span>&nbsp;<span class="op" id="3908344">*</span><span class="ident" id="3908345"><a href="/crypto/tls/handshake_messages.go.html#3907489">certificateStatusMsg</a></span><span class="op" id="3908365">)</span>&nbsp;<span class="ident" id="3908367">unmarshal</span><span class="op" id="3908376">(</span><span class="ident" id="3908377">data</span>&nbsp;<span class="op" id="3908382">[</span><span class="op" id="3908383">]</span><span class="builtintype" id="3908384">byte</span><span class="op" id="3908388">)</span>&nbsp;<span class="builtintype" id="3908390">bool</span>&nbsp;<span class="op" id="3908395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3908398"><a href="/crypto/tls/handshake_messages.go.html#3908342">m</a></span><span class="op" id="3908399">.</span><span class="ident" id="3908400">raw</span>&nbsp;<span class="op" id="3908404">=</span>&nbsp;<span class="ident" id="3908406"><a href="/crypto/tls/handshake_messages.go.html#3908377">data</a></span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3908412">if</span>&nbsp;<span class="builtinfunc" id="3908415">len</span><span class="op" id="3908418">(</span><span class="ident" id="3908419"><a href="/crypto/tls/handshake_messages.go.html#3908377">data</a></span><span class="op" id="3908423">)</span>&nbsp;<span class="op" id="3908425">&lt;</span>&nbsp;<span class="num" id="3908427">5</span>&nbsp;<span class="op" id="3908429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3908433">return</span>&nbsp;<span class="builtintype" id="3908440">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3908447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3908450"><a href="/crypto/tls/handshake_messages.go.html#3908342">m</a></span><span class="op" id="3908451">.</span><span class="ident" id="3908452">statusType</span>&nbsp;<span class="op" id="3908463">=</span>&nbsp;<span class="ident" id="3908465"><a href="/crypto/tls/handshake_messages.go.html#3908377">data</a></span><span class="op" id="3908469">[</span><span class="num" id="3908470">4</span><span class="op" id="3908471">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3908475"><a href="/crypto/tls/handshake_messages.go.html#3908342">m</a></span><span class="op" id="3908476">.</span><span class="ident" id="3908477">response</span>&nbsp;<span class="op" id="3908486">=</span>&nbsp;<span class="ident" id="3908488">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3908493">if</span>&nbsp;<span class="ident" id="3908496"><a href="/crypto/tls/handshake_messages.go.html#3908342">m</a></span><span class="op" id="3908497">.</span><span class="ident" id="3908498">statusType</span>&nbsp;<span class="op" id="3908509">==</span>&nbsp;<span class="ident" id="3908512"><a href="/crypto/tls/common.go.html#3824989">statusTypeOCSP</a></span>&nbsp;<span class="op" id="3908527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3908531">if</span>&nbsp;<span class="builtinfunc" id="3908534">len</span><span class="op" id="3908537">(</span><span class="ident" id="3908538"><a href="/crypto/tls/handshake_messages.go.html#3908377">data</a></span><span class="op" id="3908542">)</span>&nbsp;<span class="op" id="3908544">&lt;</span>&nbsp;<span class="num" id="3908546">8</span>&nbsp;<span class="op" id="3908548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3908553">return</span>&nbsp;<span class="builtintype" id="3908560">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3908568">}</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3908572">respLen</span>&nbsp;<span class="op" id="3908580">:=</span>&nbsp;<span class="builtintype" id="3908583">uint32</span><span class="op" id="3908589">(</span><span class="ident" id="3908590"><a href="/crypto/tls/handshake_messages.go.html#3908377">data</a></span><span class="op" id="3908594">[</span><span class="num" id="3908595">5</span><span class="op" id="3908596">]</span><span class="op" id="3908597">)</span><span class="op" id="3908598">&lt;&lt;</span><span class="num" id="3908600">16</span>&nbsp;<span class="op" id="3908603">|</span>&nbsp;<span class="builtintype" id="3908605">uint32</span><span class="op" id="3908611">(</span><span class="ident" id="3908612"><a href="/crypto/tls/handshake_messages.go.html#3908377">data</a></span><span class="op" id="3908616">[</span><span class="num" id="3908617">6</span><span class="op" id="3908618">]</span><span class="op" id="3908619">)</span><span class="op" id="3908620">&lt;&lt;</span><span class="num" id="3908622">8</span>&nbsp;<span class="op" id="3908624">|</span>&nbsp;<span class="builtintype" id="3908626">uint32</span><span class="op" id="3908632">(</span><span class="ident" id="3908633"><a href="/crypto/tls/handshake_messages.go.html#3908377">data</a></span><span class="op" id="3908637">[</span><span class="num" id="3908638">7</span><span class="op" id="3908639">]</span><span class="op" id="3908640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3908644">if</span>&nbsp;<span class="builtintype" id="3908647">uint32</span><span class="op" id="3908653">(</span><span class="builtinfunc" id="3908654">len</span><span class="op" id="3908657">(</span><span class="ident" id="3908658"><a href="/crypto/tls/handshake_messages.go.html#3908377">data</a></span><span class="op" id="3908662">)</span><span class="op" id="3908663">)</span>&nbsp;<span class="op" id="3908665">!=</span>&nbsp;<span class="num" id="3908668">4</span><span class="op" id="3908669">+</span><span class="num" id="3908670">4</span><span class="op" id="3908671">+</span><span class="ident" id="3908672"><a href="/crypto/tls/handshake_messages.go.html#3908572">respLen</a></span>&nbsp;<span class="op" id="3908680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3908685">return</span>&nbsp;<span class="builtintype" id="3908692">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3908700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3908704"><a href="/crypto/tls/handshake_messages.go.html#3908342">m</a></span><span class="op" id="3908705">.</span><span class="ident" id="3908706">response</span>&nbsp;<span class="op" id="3908715">=</span>&nbsp;<span class="ident" id="3908717"><a href="/crypto/tls/handshake_messages.go.html#3908377">data</a></span><span class="op" id="3908721">[</span><span class="num" id="3908722">8</span><span class="op" id="3908723">:</span><span class="op" id="3908724">]</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3908727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3908730">return</span>&nbsp;<span class="builtintype" id="3908737">true</span><br>
<span class="lineno"></span><span class="op" id="3908742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3908745">type</span>&nbsp;<span class="ident" id="3908750">serverHelloDoneMsg</span>&nbsp;<span class="keyword" id="3908769">struct</span><span class="op" id="3908775">{</span><span class="op" id="3908776">}</span><br>
<span class="lineno">910</span><br>
<span class="lineno"></span><span class="keyword" id="3908779">func</span>&nbsp;<span class="op" id="3908784">(</span><span class="ident" id="3908785">m</span>&nbsp;<span class="op" id="3908787">*</span><span class="ident" id="3908788"><a href="/crypto/tls/handshake_messages.go.html#3908750">serverHelloDoneMsg</a></span><span class="op" id="3908806">)</span>&nbsp;<span class="ident" id="3908808">equal</span><span class="op" id="3908813">(</span><span class="ident" id="3908814">i</span>&nbsp;<span class="keyword" id="3908816">interface</span><span class="op" id="3908825">{</span><span class="op" id="3908826">}</span><span class="op" id="3908827">)</span>&nbsp;<span class="builtintype" id="3908829">bool</span>&nbsp;<span class="op" id="3908834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3908837">_</span><span class="op" id="3908838">,</span>&nbsp;<span class="ident" id="3908840">ok</span>&nbsp;<span class="op" id="3908843">:=</span>&nbsp;<span class="ident" id="3908846"><a href="/crypto/tls/handshake_messages.go.html#3908814">i</a></span><span class="op" id="3908847">.</span><span class="op" id="3908848">(</span><span class="op" id="3908849">*</span><span class="ident" id="3908850"><a href="/crypto/tls/handshake_messages.go.html#3908750">serverHelloDoneMsg</a></span><span class="op" id="3908868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3908871">return</span>&nbsp;<span class="ident" id="3908878"><a href="/crypto/tls/handshake_messages.go.html#3908840">ok</a></span><br>
<span class="lineno"></span><span class="op" id="3908881">}</span><br>
<span class="lineno">915</span><br>
<span class="lineno"></span><span class="keyword" id="3908884">func</span>&nbsp;<span class="op" id="3908889">(</span><span class="ident" id="3908890">m</span>&nbsp;<span class="op" id="3908892">*</span><span class="ident" id="3908893"><a href="/crypto/tls/handshake_messages.go.html#3908750">serverHelloDoneMsg</a></span><span class="op" id="3908911">)</span>&nbsp;<span class="ident" id="3908913">marshal</span><span class="op" id="3908920">(</span><span class="op" id="3908921">)</span>&nbsp;<span class="op" id="3908923">[</span><span class="op" id="3908924">]</span><span class="builtintype" id="3908925">byte</span>&nbsp;<span class="op" id="3908930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3908933">x</span>&nbsp;<span class="op" id="3908935">:=</span>&nbsp;<span class="builtinfunc" id="3908938">make</span><span class="op" id="3908942">(</span><span class="op" id="3908943">[</span><span class="op" id="3908944">]</span><span class="builtintype" id="3908945">byte</span><span class="op" id="3908949">,</span>&nbsp;<span class="num" id="3908951">4</span><span class="op" id="3908952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3908955"><a href="/crypto/tls/handshake_messages.go.html#3908933">x</a></span><span class="op" id="3908956">[</span><span class="num" id="3908957">0</span><span class="op" id="3908958">]</span>&nbsp;<span class="op" id="3908960">=</span>&nbsp;<span class="ident" id="3908962"><a href="/crypto/tls/common.go.html#3823692">typeServerHelloDone</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3908983">return</span>&nbsp;<span class="ident" id="3908990"><a href="/crypto/tls/handshake_messages.go.html#3908933">x</a></span><br>
<span class="lineno">920</span><span class="op" id="3908992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3908995">func</span>&nbsp;<span class="op" id="3909000">(</span><span class="ident" id="3909001">m</span>&nbsp;<span class="op" id="3909003">*</span><span class="ident" id="3909004"><a href="/crypto/tls/handshake_messages.go.html#3908750">serverHelloDoneMsg</a></span><span class="op" id="3909022">)</span>&nbsp;<span class="ident" id="3909024">unmarshal</span><span class="op" id="3909033">(</span><span class="ident" id="3909034">data</span>&nbsp;<span class="op" id="3909039">[</span><span class="op" id="3909040">]</span><span class="builtintype" id="3909041">byte</span><span class="op" id="3909045">)</span>&nbsp;<span class="builtintype" id="3909047">bool</span>&nbsp;<span class="op" id="3909052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3909055">return</span>&nbsp;<span class="builtinfunc" id="3909062">len</span><span class="op" id="3909065">(</span><span class="ident" id="3909066"><a href="/crypto/tls/handshake_messages.go.html#3909034">data</a></span><span class="op" id="3909070">)</span>&nbsp;<span class="op" id="3909072">==</span>&nbsp;<span class="num" id="3909075">4</span><br>
<span class="lineno"></span><span class="op" id="3909077">}</span><br>
<span class="lineno">925</span><br>
<span class="lineno"></span><span class="keyword" id="3909080">type</span>&nbsp;<span class="ident" id="3909085">clientKeyExchangeMsg</span>&nbsp;<span class="keyword" id="3909106">struct</span>&nbsp;<span class="op" id="3909113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909116">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3909127">[</span><span class="op" id="3909128">]</span><span class="builtintype" id="3909129">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909135">ciphertext</span>&nbsp;<span class="op" id="3909146">[</span><span class="op" id="3909147">]</span><span class="builtintype" id="3909148">byte</span><br>
<span class="lineno"></span><span class="op" id="3909153">}</span><br>
<span class="lineno">930</span><br>
<span class="lineno"></span><span class="keyword" id="3909156">func</span>&nbsp;<span class="op" id="3909161">(</span><span class="ident" id="3909162">m</span>&nbsp;<span class="op" id="3909164">*</span><span class="ident" id="3909165"><a href="/crypto/tls/handshake_messages.go.html#3909085">clientKeyExchangeMsg</a></span><span class="op" id="3909185">)</span>&nbsp;<span class="ident" id="3909187">equal</span><span class="op" id="3909192">(</span><span class="ident" id="3909193">i</span>&nbsp;<span class="keyword" id="3909195">interface</span><span class="op" id="3909204">{</span><span class="op" id="3909205">}</span><span class="op" id="3909206">)</span>&nbsp;<span class="builtintype" id="3909208">bool</span>&nbsp;<span class="op" id="3909213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909216">m1</span><span class="op" id="3909218">,</span>&nbsp;<span class="ident" id="3909220">ok</span>&nbsp;<span class="op" id="3909223">:=</span>&nbsp;<span class="ident" id="3909226"><a href="/crypto/tls/handshake_messages.go.html#3909193">i</a></span><span class="op" id="3909227">.</span><span class="op" id="3909228">(</span><span class="op" id="3909229">*</span><span class="ident" id="3909230"><a href="/crypto/tls/handshake_messages.go.html#3909085">clientKeyExchangeMsg</a></span><span class="op" id="3909250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3909253">if</span>&nbsp;<span class="op" id="3909256">!</span><span class="ident" id="3909257"><a href="/crypto/tls/handshake_messages.go.html#3909220">ok</a></span>&nbsp;<span class="op" id="3909260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3909264">return</span>&nbsp;<span class="builtintype" id="3909271">false</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3909278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3909282">return</span>&nbsp;<span class="ident" id="3909289"><a href="/crypto/tls/handshake_messages.go.html#3888584">bytes</a></span><span class="op" id="3909294">.</span><span class="ident" id="3909295">Equal</span><span class="op" id="3909300">(</span><span class="ident" id="3909301"><a href="/crypto/tls/handshake_messages.go.html#3909162">m</a></span><span class="op" id="3909302">.</span><span class="ident" id="3909303">raw</span><span class="op" id="3909306">,</span>&nbsp;<span class="ident" id="3909308"><a href="/crypto/tls/handshake_messages.go.html#3909216">m1</a></span><span class="op" id="3909310">.</span><span class="ident" id="3909311">raw</span><span class="op" id="3909314">)</span>&nbsp;<span class="op" id="3909316">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909321"><a href="/crypto/tls/handshake_messages.go.html#3888584">bytes</a></span><span class="op" id="3909326">.</span><span class="ident" id="3909327">Equal</span><span class="op" id="3909332">(</span><span class="ident" id="3909333"><a href="/crypto/tls/handshake_messages.go.html#3909162">m</a></span><span class="op" id="3909334">.</span><span class="ident" id="3909335">ciphertext</span><span class="op" id="3909345">,</span>&nbsp;<span class="ident" id="3909347"><a href="/crypto/tls/handshake_messages.go.html#3909216">m1</a></span><span class="op" id="3909349">.</span><span class="ident" id="3909350">ciphertext</span><span class="op" id="3909360">)</span><br>
<span class="lineno"></span><span class="op" id="3909362">}</span><br>
<span class="lineno">940</span><br>
<span class="lineno"></span><span class="keyword" id="3909365">func</span>&nbsp;<span class="op" id="3909370">(</span><span class="ident" id="3909371">m</span>&nbsp;<span class="op" id="3909373">*</span><span class="ident" id="3909374"><a href="/crypto/tls/handshake_messages.go.html#3909085">clientKeyExchangeMsg</a></span><span class="op" id="3909394">)</span>&nbsp;<span class="ident" id="3909396">marshal</span><span class="op" id="3909403">(</span><span class="op" id="3909404">)</span>&nbsp;<span class="op" id="3909406">[</span><span class="op" id="3909407">]</span><span class="builtintype" id="3909408">byte</span>&nbsp;<span class="op" id="3909413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3909416">if</span>&nbsp;<span class="ident" id="3909419"><a href="/crypto/tls/handshake_messages.go.html#3909371">m</a></span><span class="op" id="3909420">.</span><span class="ident" id="3909421">raw</span>&nbsp;<span class="op" id="3909425">!=</span>&nbsp;<span class="ident" id="3909428">nil</span>&nbsp;<span class="op" id="3909432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3909436">return</span>&nbsp;<span class="ident" id="3909443"><a href="/crypto/tls/handshake_messages.go.html#3909371">m</a></span><span class="op" id="3909444">.</span><span class="ident" id="3909445">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3909450">}</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909453">length</span>&nbsp;<span class="op" id="3909460">:=</span>&nbsp;<span class="builtinfunc" id="3909463">len</span><span class="op" id="3909466">(</span><span class="ident" id="3909467"><a href="/crypto/tls/handshake_messages.go.html#3909371">m</a></span><span class="op" id="3909468">.</span><span class="ident" id="3909469">ciphertext</span><span class="op" id="3909479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909482">x</span>&nbsp;<span class="op" id="3909484">:=</span>&nbsp;<span class="builtinfunc" id="3909487">make</span><span class="op" id="3909491">(</span><span class="op" id="3909492">[</span><span class="op" id="3909493">]</span><span class="builtintype" id="3909494">byte</span><span class="op" id="3909498">,</span>&nbsp;<span class="ident" id="3909500"><a href="/crypto/tls/handshake_messages.go.html#3909453">length</a></span><span class="op" id="3909506">+</span><span class="num" id="3909507">4</span><span class="op" id="3909508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909511"><a href="/crypto/tls/handshake_messages.go.html#3909482">x</a></span><span class="op" id="3909512">[</span><span class="num" id="3909513">0</span><span class="op" id="3909514">]</span>&nbsp;<span class="op" id="3909516">=</span>&nbsp;<span class="ident" id="3909518"><a href="/crypto/tls/common.go.html#3823762">typeClientKeyExchange</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909541"><a href="/crypto/tls/handshake_messages.go.html#3909482">x</a></span><span class="op" id="3909542">[</span><span class="num" id="3909543">1</span><span class="op" id="3909544">]</span>&nbsp;<span class="op" id="3909546">=</span>&nbsp;<span class="builtintype" id="3909548">uint8</span><span class="op" id="3909553">(</span><span class="ident" id="3909554"><a href="/crypto/tls/handshake_messages.go.html#3909453">length</a></span>&nbsp;<span class="op" id="3909561">&gt;&gt;</span>&nbsp;<span class="num" id="3909564">16</span><span class="op" id="3909566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909569"><a href="/crypto/tls/handshake_messages.go.html#3909482">x</a></span><span class="op" id="3909570">[</span><span class="num" id="3909571">2</span><span class="op" id="3909572">]</span>&nbsp;<span class="op" id="3909574">=</span>&nbsp;<span class="builtintype" id="3909576">uint8</span><span class="op" id="3909581">(</span><span class="ident" id="3909582"><a href="/crypto/tls/handshake_messages.go.html#3909453">length</a></span>&nbsp;<span class="op" id="3909589">&gt;&gt;</span>&nbsp;<span class="num" id="3909592">8</span><span class="op" id="3909593">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909596"><a href="/crypto/tls/handshake_messages.go.html#3909482">x</a></span><span class="op" id="3909597">[</span><span class="num" id="3909598">3</span><span class="op" id="3909599">]</span>&nbsp;<span class="op" id="3909601">=</span>&nbsp;<span class="builtintype" id="3909603">uint8</span><span class="op" id="3909608">(</span><span class="ident" id="3909609"><a href="/crypto/tls/handshake_messages.go.html#3909453">length</a></span><span class="op" id="3909615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3909618">copy</span><span class="op" id="3909622">(</span><span class="ident" id="3909623"><a href="/crypto/tls/handshake_messages.go.html#3909482">x</a></span><span class="op" id="3909624">[</span><span class="num" id="3909625">4</span><span class="op" id="3909626">:</span><span class="op" id="3909627">]</span><span class="op" id="3909628">,</span>&nbsp;<span class="ident" id="3909630"><a href="/crypto/tls/handshake_messages.go.html#3909371">m</a></span><span class="op" id="3909631">.</span><span class="ident" id="3909632">ciphertext</span><span class="op" id="3909642">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909646"><a href="/crypto/tls/handshake_messages.go.html#3909371">m</a></span><span class="op" id="3909647">.</span><span class="ident" id="3909648">raw</span>&nbsp;<span class="op" id="3909652">=</span>&nbsp;<span class="ident" id="3909654"><a href="/crypto/tls/handshake_messages.go.html#3909482">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3909657">return</span>&nbsp;<span class="ident" id="3909664"><a href="/crypto/tls/handshake_messages.go.html#3909482">x</a></span><br>
<span class="lineno">955</span><span class="op" id="3909666">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3909669">func</span>&nbsp;<span class="op" id="3909674">(</span><span class="ident" id="3909675">m</span>&nbsp;<span class="op" id="3909677">*</span><span class="ident" id="3909678"><a href="/crypto/tls/handshake_messages.go.html#3909085">clientKeyExchangeMsg</a></span><span class="op" id="3909698">)</span>&nbsp;<span class="ident" id="3909700">unmarshal</span><span class="op" id="3909709">(</span><span class="ident" id="3909710">data</span>&nbsp;<span class="op" id="3909715">[</span><span class="op" id="3909716">]</span><span class="builtintype" id="3909717">byte</span><span class="op" id="3909721">)</span>&nbsp;<span class="builtintype" id="3909723">bool</span>&nbsp;<span class="op" id="3909728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909731"><a href="/crypto/tls/handshake_messages.go.html#3909675">m</a></span><span class="op" id="3909732">.</span><span class="ident" id="3909733">raw</span>&nbsp;<span class="op" id="3909737">=</span>&nbsp;<span class="ident" id="3909739"><a href="/crypto/tls/handshake_messages.go.html#3909710">data</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3909745">if</span>&nbsp;<span class="builtinfunc" id="3909748">len</span><span class="op" id="3909751">(</span><span class="ident" id="3909752"><a href="/crypto/tls/handshake_messages.go.html#3909710">data</a></span><span class="op" id="3909756">)</span>&nbsp;<span class="op" id="3909758">&lt;</span>&nbsp;<span class="num" id="3909760">4</span>&nbsp;<span class="op" id="3909762">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3909766">return</span>&nbsp;<span class="builtintype" id="3909773">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3909780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909783">l</span>&nbsp;<span class="op" id="3909785">:=</span>&nbsp;<span class="builtintype" id="3909788">int</span><span class="op" id="3909791">(</span><span class="ident" id="3909792"><a href="/crypto/tls/handshake_messages.go.html#3909710">data</a></span><span class="op" id="3909796">[</span><span class="num" id="3909797">1</span><span class="op" id="3909798">]</span><span class="op" id="3909799">)</span><span class="op" id="3909800">&lt;&lt;</span><span class="num" id="3909802">16</span>&nbsp;<span class="op" id="3909805">|</span>&nbsp;<span class="builtintype" id="3909807">int</span><span class="op" id="3909810">(</span><span class="ident" id="3909811"><a href="/crypto/tls/handshake_messages.go.html#3909710">data</a></span><span class="op" id="3909815">[</span><span class="num" id="3909816">2</span><span class="op" id="3909817">]</span><span class="op" id="3909818">)</span><span class="op" id="3909819">&lt;&lt;</span><span class="num" id="3909821">8</span>&nbsp;<span class="op" id="3909823">|</span>&nbsp;<span class="builtintype" id="3909825">int</span><span class="op" id="3909828">(</span><span class="ident" id="3909829"><a href="/crypto/tls/handshake_messages.go.html#3909710">data</a></span><span class="op" id="3909833">[</span><span class="num" id="3909834">3</span><span class="op" id="3909835">]</span><span class="op" id="3909836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3909839">if</span>&nbsp;<span class="ident" id="3909842"><a href="/crypto/tls/handshake_messages.go.html#3909783">l</a></span>&nbsp;<span class="op" id="3909844">!=</span>&nbsp;<span class="builtinfunc" id="3909847">len</span><span class="op" id="3909850">(</span><span class="ident" id="3909851"><a href="/crypto/tls/handshake_messages.go.html#3909710">data</a></span><span class="op" id="3909855">)</span><span class="op" id="3909856">-</span><span class="num" id="3909857">4</span>&nbsp;<span class="op" id="3909859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3909863">return</span>&nbsp;<span class="builtintype" id="3909870">false</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3909877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909880"><a href="/crypto/tls/handshake_messages.go.html#3909675">m</a></span><span class="op" id="3909881">.</span><span class="ident" id="3909882">ciphertext</span>&nbsp;<span class="op" id="3909893">=</span>&nbsp;<span class="ident" id="3909895"><a href="/crypto/tls/handshake_messages.go.html#3909710">data</a></span><span class="op" id="3909899">[</span><span class="num" id="3909900">4</span><span class="op" id="3909901">:</span><span class="op" id="3909902">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3909905">return</span>&nbsp;<span class="builtintype" id="3909912">true</span><br>
<span class="lineno"></span><span class="op" id="3909917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">970</span><span class="keyword" id="3909920">type</span>&nbsp;<span class="ident" id="3909925">finishedMsg</span>&nbsp;<span class="keyword" id="3909937">struct</span>&nbsp;<span class="op" id="3909944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909947">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3909958">[</span><span class="op" id="3909959">]</span><span class="builtintype" id="3909960">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3909966">verifyData</span>&nbsp;<span class="op" id="3909977">[</span><span class="op" id="3909978">]</span><span class="builtintype" id="3909979">byte</span><br>
<span class="lineno"></span><span class="op" id="3909984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">975</span><span class="keyword" id="3909987">func</span>&nbsp;<span class="op" id="3909992">(</span><span class="ident" id="3909993">m</span>&nbsp;<span class="op" id="3909995">*</span><span class="ident" id="3909996"><a href="/crypto/tls/handshake_messages.go.html#3909925">finishedMsg</a></span><span class="op" id="3910007">)</span>&nbsp;<span class="ident" id="3910009">equal</span><span class="op" id="3910014">(</span><span class="ident" id="3910015">i</span>&nbsp;<span class="keyword" id="3910017">interface</span><span class="op" id="3910026">{</span><span class="op" id="3910027">}</span><span class="op" id="3910028">)</span>&nbsp;<span class="builtintype" id="3910030">bool</span>&nbsp;<span class="op" id="3910035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3910038">m1</span><span class="op" id="3910040">,</span>&nbsp;<span class="ident" id="3910042">ok</span>&nbsp;<span class="op" id="3910045">:=</span>&nbsp;<span class="ident" id="3910048"><a href="/crypto/tls/handshake_messages.go.html#3910015">i</a></span><span class="op" id="3910049">.</span><span class="op" id="3910050">(</span><span class="op" id="3910051">*</span><span class="ident" id="3910052"><a href="/crypto/tls/handshake_messages.go.html#3909925">finishedMsg</a></span><span class="op" id="3910063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3910066">if</span>&nbsp;<span class="op" id="3910069">!</span><span class="ident" id="3910070"><a href="/crypto/tls/handshake_messages.go.html#3910042">ok</a></span>&nbsp;<span class="op" id="3910073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3910077">return</span>&nbsp;<span class="builtintype" id="3910084">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3910091">}</span><br>
<span class="lineno">980</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3910095">return</span>&nbsp;<span class="ident" id="3910102"><a href="/crypto/tls/handshake_messages.go.html#3888584">bytes</a></span><span class="op" id="3910107">.</span><span class="ident" id="3910108">Equal</span><span class="op" id="3910113">(</span><span class="ident" id="3910114"><a href="/crypto/tls/handshake_messages.go.html#3909993">m</a></span><span class="op" id="3910115">.</span><span class="ident" id="3910116">raw</span><span class="op" id="3910119">,</span>&nbsp;<span class="ident" id="3910121"><a href="/crypto/tls/handshake_messages.go.html#3910038">m1</a></span><span class="op" id="3910123">.</span><span class="ident" id="3910124">raw</span><span class="op" id="3910127">)</span>&nbsp;<span class="op" id="3910129">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3910134"><a href="/crypto/tls/handshake_messages.go.html#3888584">bytes</a></span><span class="op" id="3910139">.</span><span class="ident" id="3910140">Equal</span><span class="op" id="3910145">(</span><span class="ident" id="3910146"><a href="/crypto/tls/handshake_messages.go.html#3909993">m</a></span><span class="op" id="3910147">.</span><span class="ident" id="3910148">verifyData</span><span class="op" id="3910158">,</span>&nbsp;<span class="ident" id="3910160"><a href="/crypto/tls/handshake_messages.go.html#3910038">m1</a></span><span class="op" id="3910162">.</span><span class="ident" id="3910163">verifyData</span><span class="op" id="3910173">)</span><br>
<span class="lineno"></span><span class="op" id="3910175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">985</span><span class="keyword" id="3910178">func</span>&nbsp;<span class="op" id="3910183">(</span><span class="ident" id="3910184">m</span>&nbsp;<span class="op" id="3910186">*</span><span class="ident" id="3910187"><a href="/crypto/tls/handshake_messages.go.html#3909925">finishedMsg</a></span><span class="op" id="3910198">)</span>&nbsp;<span class="ident" id="3910200">marshal</span><span class="op" id="3910207">(</span><span class="op" id="3910208">)</span>&nbsp;<span class="op" id="3910210">(</span><span class="ident" id="3910211">x</span>&nbsp;<span class="op" id="3910213">[</span><span class="op" id="3910214">]</span><span class="builtintype" id="3910215">byte</span><span class="op" id="3910219">)</span>&nbsp;<span class="op" id="3910221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3910224">if</span>&nbsp;<span class="ident" id="3910227"><a href="/crypto/tls/handshake_messages.go.html#3910184">m</a></span><span class="op" id="3910228">.</span><span class="ident" id="3910229">raw</span>&nbsp;<span class="op" id="3910233">!=</span>&nbsp;<span class="ident" id="3910236">nil</span>&nbsp;<span class="op" id="3910240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3910244">return</span>&nbsp;<span class="ident" id="3910251"><a href="/crypto/tls/handshake_messages.go.html#3910184">m</a></span><span class="op" id="3910252">.</span><span class="ident" id="3910253">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3910258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3910262"><a href="/crypto/tls/handshake_messages.go.html#3910211">x</a></span>&nbsp;<span class="op" id="3910264">=</span>&nbsp;<span class="builtinfunc" id="3910266">make</span><span class="op" id="3910270">(</span><span class="op" id="3910271">[</span><span class="op" id="3910272">]</span><span class="builtintype" id="3910273">byte</span><span class="op" id="3910277">,</span>&nbsp;<span class="num" id="3910279">4</span><span class="op" id="3910280">+</span><span class="builtinfunc" id="3910281">len</span><span class="op" id="3910284">(</span><span class="ident" id="3910285"><a href="/crypto/tls/handshake_messages.go.html#3910184">m</a></span><span class="op" id="3910286">.</span><span class="ident" id="3910287">verifyData</span><span class="op" id="3910297">)</span><span class="op" id="3910298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3910301"><a href="/crypto/tls/handshake_messages.go.html#3910211">x</a></span><span class="op" id="3910302">[</span><span class="num" id="3910303">0</span><span class="op" id="3910304">]</span>&nbsp;<span class="op" id="3910306">=</span>&nbsp;<span class="ident" id="3910308"><a href="/crypto/tls/common.go.html#3823797">typeFinished</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3910322"><a href="/crypto/tls/handshake_messages.go.html#3910211">x</a></span><span class="op" id="3910323">[</span><span class="num" id="3910324">3</span><span class="op" id="3910325">]</span>&nbsp;<span class="op" id="3910327">=</span>&nbsp;<span class="builtintype" id="3910329">byte</span><span class="op" id="3910333">(</span><span class="builtinfunc" id="3910334">len</span><span class="op" id="3910337">(</span><span class="ident" id="3910338"><a href="/crypto/tls/handshake_messages.go.html#3910184">m</a></span><span class="op" id="3910339">.</span><span class="ident" id="3910340">verifyData</span><span class="op" id="3910350">)</span><span class="op" id="3910351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3910354">copy</span><span class="op" id="3910358">(</span><span class="ident" id="3910359"><a href="/crypto/tls/handshake_messages.go.html#3910211">x</a></span><span class="op" id="3910360">[</span><span class="num" id="3910361">4</span><span class="op" id="3910362">:</span><span class="op" id="3910363">]</span><span class="op" id="3910364">,</span>&nbsp;<span class="ident" id="3910366"><a href="/crypto/tls/handshake_messages.go.html#3910184">m</a></span><span class="op" id="3910367">.</span><span class="ident" id="3910368">verifyData</span><span class="op" id="3910378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3910381"><a href="/crypto/tls/handshake_messages.go.html#3910184">m</a></span><span class="op" id="3910382">.</span><span class="ident" id="3910383">raw</span>&nbsp;<span class="op" id="3910387">=</span>&nbsp;<span class="ident" id="3910389"><a href="/crypto/tls/handshake_messages.go.html#3910211">x</a></span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3910392">return</span><br>
<span class="lineno"></span><span class="op" id="3910399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3910402">func</span>&nbsp;<span class="op" id="3910407">(</span><span class="ident" id="3910408">m</span>&nbsp;<span class="op" id="3910410">*</span><span class="ident" id="3910411"><a href="/crypto/tls/handshake_messages.go.html#3909925">finishedMsg</a></span><span class="op" id="3910422">)</span>&nbsp;<span class="ident" id="3910424">unmarshal</span><span class="op" id="3910433">(</span><span class="ident" id="3910434">data</span>&nbsp;<span class="op" id="3910439">[</span><span class="op" id="3910440">]</span><span class="builtintype" id="3910441">byte</span><span class="op" id="3910445">)</span>&nbsp;<span class="builtintype" id="3910447">bool</span>&nbsp;<span class="op" id="3910452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3910455"><a href="/crypto/tls/handshake_messages.go.html#3910408">m</a></span><span class="op" id="3910456">.</span><span class="ident" id="3910457">raw</span>&nbsp;<span class="op" id="3910461">=</span>&nbsp;<span class="ident" id="3910463"><a href="/crypto/tls/handshake_messages.go.html#3910434">data</a></span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3910469">if</span>&nbsp;<span class="builtinfunc" id="3910472">len</span><span class="op" id="3910475">(</span><span class="ident" id="3910476"><a href="/crypto/tls/handshake_messages.go.html#3910434">data</a></span><span class="op" id="3910480">)</span>&nbsp;<span class="op" id="3910482">&lt;</span>&nbsp;<span class="num" id="3910484">4</span>&nbsp;<span class="op" id="3910486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3910490">return</span>&nbsp;<span class="builtintype" id="3910497">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3910504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3910507"><a href="/crypto/tls/handshake_messages.go.html#3910408">m</a></span><span class="op" id="3910508">.</span><span class="ident" id="3910509">verifyData</span>&nbsp;<span class="op" id="3910520">=</span>&nbsp;<span class="ident" id="3910522"><a href="/crypto/tls/handshake_messages.go.html#3910434">data</a></span><span class="op" id="3910526">[</span><span class="num" id="3910527">4</span><span class="op" id="3910528">:</span><span class="op" id="3910529">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3910532">return</span>&nbsp;<span class="builtintype" id="3910539">true</span><br>
<span class="lineno">1005</span><span class="op" id="3910544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3910547">type</span>&nbsp;<span class="ident" id="3910552">nextProtoMsg</span>&nbsp;<span class="keyword" id="3910565">struct</span>&nbsp;<span class="op" id="3910572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3910575">raw</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3910581">[</span><span class="op" id="3910582">]</span><span class="builtintype" id="3910583">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3910589">proto</span>&nbsp;<span class="builtintype" id="3910595">string</span><br>
<span class="lineno">1010</span><span class="op" id="3910602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3910605">func</span>&nbsp;<span class="op" id="3910610">(</span><span class="ident" id="3910611">m</span>&nbsp;<span class="op" id="3910613">*</span><span class="ident" id="3910614"><a href="/crypto/tls/handshake_messages.go.html#3910552">nextProtoMsg</a></span><span class="op" id="3910626">)</span>&nbsp;<span class="ident" id="3910628">equal</span><span class="op" id="3910633">(</span><span class="ident" id="3910634">i</span>&nbsp;<span class="keyword" id="3910636">interface</span><span class="op" id="3910645">{</span><span class="op" id="3910646">}</span><span class="op" id="3910647">)</span>&nbsp;<span class="builtintype" id="3910649">bool</span>&nbsp;<span class="op" id="3910654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3910657">m1</span><span class="op" id="3910659">,</span>&nbsp;<span class="ident" id="3910661">ok</span>&nbsp;<span class="op" id="3910664">:=</span>&nbsp;<span class="ident" id="3910667"><a href="/crypto/tls/handshake_messages.go.html#3910634">i</a></span><span class="op" id="3910668">.</span><span class="op" id="3910669">(</span><span class="op" id="3910670">*</span><span class="ident" id="3910671"><a href="/crypto/tls/handshake_messages.go.html#3910552">nextProtoMsg</a></span><span class="op" id="3910683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3910686">if</span>&nbsp;<span class="op" id="3910689">!</span><span class="ident" id="3910690"><a href="/crypto/tls/handshake_messages.go.html#3910661">ok</a></span>&nbsp;<span class="op" id="3910693">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3910697">return</span>&nbsp;<span class="builtintype" id="3910704">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3910711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3910715">return</span>&nbsp;<span class="ident" id="3910722"><a href="/crypto/tls/handshake_messages.go.html#3888584">bytes</a></span><span class="op" id="3910727">.</span><span class="ident" id="3910728">Equal</span><span class="op" id="3910733">(</span><span class="ident" id="3910734"><a href="/crypto/tls/handshake_messages.go.html#3910611">m</a></span><span class="op" id="3910735">.</span><span class="ident" id="3910736">raw</span><span class="op" id="3910739">,</span>&nbsp;<span class="ident" id="3910741"><a href="/crypto/tls/handshake_messages.go.html#3910657">m1</a></span><span class="op" id="3910743">.</span><span class="ident" id="3910744">raw</span><span class="op" id="3910747">)</span>&nbsp;<span class="op" id="3910749">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3910754"><a href="/crypto/tls/handshake_messages.go.html#3910611">m</a></span><span class="op" id="3910755">.</span><span class="ident" id="3910756">proto</span>&nbsp;<span class="op" id="3910762">==</span>&nbsp;<span class="ident" id="3910765"><a href="/crypto/tls/handshake_messages.go.html#3910657">m1</a></span><span class="op" id="3910767">.</span><span class="ident" id="3910768">proto</span><br>
<span class="lineno">1020</span><span class="op" id="3910774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3910777">func</span>&nbsp;<span class="op" id="3910782">(</span><span class="ident" id="3910783">m</span>&nbsp;<span class="op" id="3910785">*</span><span class="ident" id="3910786"><a href="/crypto/tls/handshake_messages.go.html#3910552">nextProtoMsg</a></span><span class="op" id="3910798">)</span>&nbsp;<span class="ident" id="3910800">marshal</span><span class="op" id="3910807">(</span><span class="op" id="3910808">)</span>&nbsp;<span class="op" id="3910810">[</span><span class="op" id="3910811">]</span><span class="builtintype" id="3910812">byte</span>&nbsp;<span class="op" id="3910817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3910820">if</span>&nbsp;<span class="ident" id="3910823"><a href="/crypto/tls/handshake_messages.go.html#3910783">m</a></span><span class="op" id="3910824">.</span><span class="ident" id="3910825">raw</span>&nbsp;<span class="op" id="3910829">!=</span>&nbsp;<span class="ident" id="3910832">nil</span>&nbsp;<span class="op" id="3910836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3910840">return</span>&nbsp;<span class="ident" id="3910847"><a href="/crypto/tls/handshake_messages.go.html#3910783">m</a></span><span class="op" id="3910848">.</span><span class="ident" id="3910849">raw</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3910854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3910857">l</span>&nbsp;<span class="op" id="3910859">:=</span>&nbsp;<span class="builtinfunc" id="3910862">len</span><span class="op" id="3910865">(</span><span class="ident" id="3910866"><a href="/crypto/tls/handshake_messages.go.html#3910783">m</a></span><span class="op" id="3910867">.</span><span class="ident" id="3910868">proto</span><span class="op" id="3910873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3910876">if</span>&nbsp;<span class="ident" id="3910879"><a href="/crypto/tls/handshake_messages.go.html#3910857">l</a></span>&nbsp;<span class="op" id="3910881">&gt;</span>&nbsp;<span class="num" id="3910883">255</span>&nbsp;<span class="op" id="3910887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3910891"><a href="/crypto/tls/handshake_messages.go.html#3910857">l</a></span>&nbsp;<span class="op" id="3910893">=</span>&nbsp;<span class="num" id="3910895">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3910900">}</span><br>
<span class="lineno">1030</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3910904">padding</span>&nbsp;<span class="op" id="3910912">:=</span>&nbsp;<span class="num" id="3910915">32</span>&nbsp;<span class="op" id="3910918">-</span>&nbsp;<span class="op" id="3910920">(</span><span class="ident" id="3910921"><a href="/crypto/tls/handshake_messages.go.html#3910857">l</a></span><span class="op" id="3910922">+</span><span class="num" id="3910923">2</span><span class="op" id="3910924">)</span><span class="op" id="3910925">%</span><span class="num" id="3910926">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3910930">length</span>&nbsp;<span class="op" id="3910937">:=</span>&nbsp;<span class="ident" id="3910940"><a href="/crypto/tls/handshake_messages.go.html#3910857">l</a></span>&nbsp;<span class="op" id="3910942">+</span>&nbsp;<span class="ident" id="3910944"><a href="/crypto/tls/handshake_messages.go.html#3910904">padding</a></span>&nbsp;<span class="op" id="3910952">+</span>&nbsp;<span class="num" id="3910954">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3910957">x</span>&nbsp;<span class="op" id="3910959">:=</span>&nbsp;<span class="builtinfunc" id="3910962">make</span><span class="op" id="3910966">(</span><span class="op" id="3910967">[</span><span class="op" id="3910968">]</span><span class="builtintype" id="3910969">byte</span><span class="op" id="3910973">,</span>&nbsp;<span class="ident" id="3910975"><a href="/crypto/tls/handshake_messages.go.html#3910930">length</a></span><span class="op" id="3910981">+</span><span class="num" id="3910982">4</span><span class="op" id="3910983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3910986"><a href="/crypto/tls/handshake_messages.go.html#3910957">x</a></span><span class="op" id="3910987">[</span><span class="num" id="3910988">0</span><span class="op" id="3910989">]</span>&nbsp;<span class="op" id="3910991">=</span>&nbsp;<span class="ident" id="3910993"><a href="/crypto/tls/common.go.html#3823867">typeNextProtocol</a></span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911011"><a href="/crypto/tls/handshake_messages.go.html#3910957">x</a></span><span class="op" id="3911012">[</span><span class="num" id="3911013">1</span><span class="op" id="3911014">]</span>&nbsp;<span class="op" id="3911016">=</span>&nbsp;<span class="builtintype" id="3911018">uint8</span><span class="op" id="3911023">(</span><span class="ident" id="3911024"><a href="/crypto/tls/handshake_messages.go.html#3910930">length</a></span>&nbsp;<span class="op" id="3911031">&gt;&gt;</span>&nbsp;<span class="num" id="3911034">16</span><span class="op" id="3911036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911039"><a href="/crypto/tls/handshake_messages.go.html#3910957">x</a></span><span class="op" id="3911040">[</span><span class="num" id="3911041">2</span><span class="op" id="3911042">]</span>&nbsp;<span class="op" id="3911044">=</span>&nbsp;<span class="builtintype" id="3911046">uint8</span><span class="op" id="3911051">(</span><span class="ident" id="3911052"><a href="/crypto/tls/handshake_messages.go.html#3910930">length</a></span>&nbsp;<span class="op" id="3911059">&gt;&gt;</span>&nbsp;<span class="num" id="3911062">8</span><span class="op" id="3911063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911066"><a href="/crypto/tls/handshake_messages.go.html#3910957">x</a></span><span class="op" id="3911067">[</span><span class="num" id="3911068">3</span><span class="op" id="3911069">]</span>&nbsp;<span class="op" id="3911071">=</span>&nbsp;<span class="builtintype" id="3911073">uint8</span><span class="op" id="3911078">(</span><span class="ident" id="3911079"><a href="/crypto/tls/handshake_messages.go.html#3910930">length</a></span><span class="op" id="3911085">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911089">y</span>&nbsp;<span class="op" id="3911091">:=</span>&nbsp;<span class="ident" id="3911094"><a href="/crypto/tls/handshake_messages.go.html#3910957">x</a></span><span class="op" id="3911095">[</span><span class="num" id="3911096">4</span><span class="op" id="3911097">:</span><span class="op" id="3911098">]</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911101"><a href="/crypto/tls/handshake_messages.go.html#3911089">y</a></span><span class="op" id="3911102">[</span><span class="num" id="3911103">0</span><span class="op" id="3911104">]</span>&nbsp;<span class="op" id="3911106">=</span>&nbsp;<span class="builtintype" id="3911108">byte</span><span class="op" id="3911112">(</span><span class="ident" id="3911113"><a href="/crypto/tls/handshake_messages.go.html#3910857">l</a></span><span class="op" id="3911114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3911117">copy</span><span class="op" id="3911121">(</span><span class="ident" id="3911122"><a href="/crypto/tls/handshake_messages.go.html#3911089">y</a></span><span class="op" id="3911123">[</span><span class="num" id="3911124">1</span><span class="op" id="3911125">:</span><span class="op" id="3911126">]</span><span class="op" id="3911127">,</span>&nbsp;<span class="op" id="3911129">[</span><span class="op" id="3911130">]</span><span class="builtintype" id="3911131">byte</span><span class="op" id="3911135">(</span><span class="ident" id="3911136"><a href="/crypto/tls/handshake_messages.go.html#3910783">m</a></span><span class="op" id="3911137">.</span><span class="ident" id="3911138">proto</span><span class="op" id="3911143">[</span><span class="num" id="3911144">0</span><span class="op" id="3911145">:</span><span class="ident" id="3911146"><a href="/crypto/tls/handshake_messages.go.html#3910857">l</a></span><span class="op" id="3911147">]</span><span class="op" id="3911148">)</span><span class="op" id="3911149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911152"><a href="/crypto/tls/handshake_messages.go.html#3911089">y</a></span>&nbsp;<span class="op" id="3911154">=</span>&nbsp;<span class="ident" id="3911156"><a href="/crypto/tls/handshake_messages.go.html#3911089">y</a></span><span class="op" id="3911157">[</span><span class="num" id="3911158">1</span><span class="op" id="3911159">+</span><span class="ident" id="3911160"><a href="/crypto/tls/handshake_messages.go.html#3910857">l</a></span><span class="op" id="3911161">:</span><span class="op" id="3911162">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911165"><a href="/crypto/tls/handshake_messages.go.html#3911089">y</a></span><span class="op" id="3911166">[</span><span class="num" id="3911167">0</span><span class="op" id="3911168">]</span>&nbsp;<span class="op" id="3911170">=</span>&nbsp;<span class="builtintype" id="3911172">byte</span><span class="op" id="3911176">(</span><span class="ident" id="3911177"><a href="/crypto/tls/handshake_messages.go.html#3910904">padding</a></span><span class="op" id="3911184">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911188"><a href="/crypto/tls/handshake_messages.go.html#3910783">m</a></span><span class="op" id="3911189">.</span><span class="ident" id="3911190">raw</span>&nbsp;<span class="op" id="3911194">=</span>&nbsp;<span class="ident" id="3911196"><a href="/crypto/tls/handshake_messages.go.html#3910957">x</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3911200">return</span>&nbsp;<span class="ident" id="3911207"><a href="/crypto/tls/handshake_messages.go.html#3910957">x</a></span><br>
<span class="lineno"></span><span class="op" id="3911209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1050</span><span class="keyword" id="3911212">func</span>&nbsp;<span class="op" id="3911217">(</span><span class="ident" id="3911218">m</span>&nbsp;<span class="op" id="3911220">*</span><span class="ident" id="3911221"><a href="/crypto/tls/handshake_messages.go.html#3910552">nextProtoMsg</a></span><span class="op" id="3911233">)</span>&nbsp;<span class="ident" id="3911235">unmarshal</span><span class="op" id="3911244">(</span><span class="ident" id="3911245">data</span>&nbsp;<span class="op" id="3911250">[</span><span class="op" id="3911251">]</span><span class="builtintype" id="3911252">byte</span><span class="op" id="3911256">)</span>&nbsp;<span class="builtintype" id="3911258">bool</span>&nbsp;<span class="op" id="3911263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911266"><a href="/crypto/tls/handshake_messages.go.html#3911218">m</a></span><span class="op" id="3911267">.</span><span class="ident" id="3911268">raw</span>&nbsp;<span class="op" id="3911272">=</span>&nbsp;<span class="ident" id="3911274"><a href="/crypto/tls/handshake_messages.go.html#3911245">data</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3911281">if</span>&nbsp;<span class="builtinfunc" id="3911284">len</span><span class="op" id="3911287">(</span><span class="ident" id="3911288"><a href="/crypto/tls/handshake_messages.go.html#3911245">data</a></span><span class="op" id="3911292">)</span>&nbsp;<span class="op" id="3911294">&lt;</span>&nbsp;<span class="num" id="3911296">5</span>&nbsp;<span class="op" id="3911298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3911302">return</span>&nbsp;<span class="builtintype" id="3911309">false</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3911316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911319"><a href="/crypto/tls/handshake_messages.go.html#3911245">data</a></span>&nbsp;<span class="op" id="3911324">=</span>&nbsp;<span class="ident" id="3911326"><a href="/crypto/tls/handshake_messages.go.html#3911245">data</a></span><span class="op" id="3911330">[</span><span class="num" id="3911331">4</span><span class="op" id="3911332">:</span><span class="op" id="3911333">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911336">protoLen</span>&nbsp;<span class="op" id="3911345">:=</span>&nbsp;<span class="builtintype" id="3911348">int</span><span class="op" id="3911351">(</span><span class="ident" id="3911352"><a href="/crypto/tls/handshake_messages.go.html#3911245">data</a></span><span class="op" id="3911356">[</span><span class="num" id="3911357">0</span><span class="op" id="3911358">]</span><span class="op" id="3911359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911362"><a href="/crypto/tls/handshake_messages.go.html#3911245">data</a></span>&nbsp;<span class="op" id="3911367">=</span>&nbsp;<span class="ident" id="3911369"><a href="/crypto/tls/handshake_messages.go.html#3911245">data</a></span><span class="op" id="3911373">[</span><span class="num" id="3911374">1</span><span class="op" id="3911375">:</span><span class="op" id="3911376">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3911379">if</span>&nbsp;<span class="builtinfunc" id="3911382">len</span><span class="op" id="3911385">(</span><span class="ident" id="3911386"><a href="/crypto/tls/handshake_messages.go.html#3911245">data</a></span><span class="op" id="3911390">)</span>&nbsp;<span class="op" id="3911392">&lt;</span>&nbsp;<span class="ident" id="3911394"><a href="/crypto/tls/handshake_messages.go.html#3911336">protoLen</a></span>&nbsp;<span class="op" id="3911403">{</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3911407">return</span>&nbsp;<span class="builtintype" id="3911414">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3911421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911424"><a href="/crypto/tls/handshake_messages.go.html#3911218">m</a></span><span class="op" id="3911425">.</span><span class="ident" id="3911426">proto</span>&nbsp;<span class="op" id="3911432">=</span>&nbsp;<span class="builtintype" id="3911434">string</span><span class="op" id="3911440">(</span><span class="ident" id="3911441"><a href="/crypto/tls/handshake_messages.go.html#3911245">data</a></span><span class="op" id="3911445">[</span><span class="num" id="3911446">0</span><span class="op" id="3911447">:</span><span class="ident" id="3911448"><a href="/crypto/tls/handshake_messages.go.html#3911336">protoLen</a></span><span class="op" id="3911456">]</span><span class="op" id="3911457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911460"><a href="/crypto/tls/handshake_messages.go.html#3911245">data</a></span>&nbsp;<span class="op" id="3911465">=</span>&nbsp;<span class="ident" id="3911467"><a href="/crypto/tls/handshake_messages.go.html#3911245">data</a></span><span class="op" id="3911471">[</span><span class="ident" id="3911472"><a href="/crypto/tls/handshake_messages.go.html#3911336">protoLen</a></span><span class="op" id="3911480">:</span><span class="op" id="3911481">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3911485">if</span>&nbsp;<span class="builtinfunc" id="3911488">len</span><span class="op" id="3911491">(</span><span class="ident" id="3911492"><a href="/crypto/tls/handshake_messages.go.html#3911245">data</a></span><span class="op" id="3911496">)</span>&nbsp;<span class="op" id="3911498">&lt;</span>&nbsp;<span class="num" id="3911500">1</span>&nbsp;<span class="op" id="3911502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3911506">return</span>&nbsp;<span class="builtintype" id="3911513">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3911520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911523">paddingLen</span>&nbsp;<span class="op" id="3911534">:=</span>&nbsp;<span class="builtintype" id="3911537">int</span><span class="op" id="3911540">(</span><span class="ident" id="3911541"><a href="/crypto/tls/handshake_messages.go.html#3911245">data</a></span><span class="op" id="3911545">[</span><span class="num" id="3911546">0</span><span class="op" id="3911547">]</span><span class="op" id="3911548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911551"><a href="/crypto/tls/handshake_messages.go.html#3911245">data</a></span>&nbsp;<span class="op" id="3911556">=</span>&nbsp;<span class="ident" id="3911558"><a href="/crypto/tls/handshake_messages.go.html#3911245">data</a></span><span class="op" id="3911562">[</span><span class="num" id="3911563">1</span><span class="op" id="3911564">:</span><span class="op" id="3911565">]</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3911568">if</span>&nbsp;<span class="builtinfunc" id="3911571">len</span><span class="op" id="3911574">(</span><span class="ident" id="3911575"><a href="/crypto/tls/handshake_messages.go.html#3911245">data</a></span><span class="op" id="3911579">)</span>&nbsp;<span class="op" id="3911581">!=</span>&nbsp;<span class="ident" id="3911584"><a href="/crypto/tls/handshake_messages.go.html#3911523">paddingLen</a></span>&nbsp;<span class="op" id="3911595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3911599">return</span>&nbsp;<span class="builtintype" id="3911606">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3911613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3911617">return</span>&nbsp;<span class="builtintype" id="3911624">true</span><br>
<span class="lineno">1075</span><span class="op" id="3911629">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3911632">type</span>&nbsp;<span class="ident" id="3911637">certificateRequestMsg</span>&nbsp;<span class="keyword" id="3911659">struct</span>&nbsp;<span class="op" id="3911666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911669">raw</span>&nbsp;<span class="op" id="3911673">[</span><span class="op" id="3911674">]</span><span class="builtintype" id="3911675">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3911681">//&nbsp;hasSignatureAndHash&nbsp;indicates&nbsp;whether&nbsp;this&nbsp;message&nbsp;includes&nbsp;a&nbsp;list</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3911752">//&nbsp;of&nbsp;signature&nbsp;and&nbsp;hash&nbsp;functions.&nbsp;This&nbsp;change&nbsp;was&nbsp;introduced&nbsp;with&nbsp;TLS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3911825">//&nbsp;1.2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911834">hasSignatureAndHash</span>&nbsp;<span class="builtintype" id="3911854">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911861">certificateTypes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3911884">[</span><span class="op" id="3911885">]</span><span class="builtintype" id="3911886">byte</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911892">signatureAndHashes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3911915">[</span><span class="op" id="3911916">]</span><span class="ident" id="3911917"><a href="/crypto/tls/common.go.html#3826090">signatureAndHash</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3911935">certificateAuthorities</span>&nbsp;<span class="op" id="3911958">[</span><span class="op" id="3911959">]</span><span class="op" id="3911960">[</span><span class="op" id="3911961">]</span><span class="builtintype" id="3911962">byte</span><br>
<span class="lineno"></span><span class="op" id="3911967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3911970">func</span>&nbsp;<span class="op" id="3911975">(</span><span class="ident" id="3911976">m</span>&nbsp;<span class="op" id="3911978">*</span><span class="ident" id="3911979"><a href="/crypto/tls/handshake_messages.go.html#3911637">certificateRequestMsg</a></span><span class="op" id="3912000">)</span>&nbsp;<span class="ident" id="3912002">equal</span><span class="op" id="3912007">(</span><span class="ident" id="3912008">i</span>&nbsp;<span class="keyword" id="3912010">interface</span><span class="op" id="3912019">{</span><span class="op" id="3912020">}</span><span class="op" id="3912021">)</span>&nbsp;<span class="builtintype" id="3912023">bool</span>&nbsp;<span class="op" id="3912028">{</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912031">m1</span><span class="op" id="3912033">,</span>&nbsp;<span class="ident" id="3912035">ok</span>&nbsp;<span class="op" id="3912038">:=</span>&nbsp;<span class="ident" id="3912041"><a href="/crypto/tls/handshake_messages.go.html#3912008">i</a></span><span class="op" id="3912042">.</span><span class="op" id="3912043">(</span><span class="op" id="3912044">*</span><span class="ident" id="3912045"><a href="/crypto/tls/handshake_messages.go.html#3911637">certificateRequestMsg</a></span><span class="op" id="3912066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3912069">if</span>&nbsp;<span class="op" id="3912072">!</span><span class="ident" id="3912073"><a href="/crypto/tls/handshake_messages.go.html#3912035">ok</a></span>&nbsp;<span class="op" id="3912076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3912080">return</span>&nbsp;<span class="builtintype" id="3912087">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3912094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3912098">return</span>&nbsp;<span class="ident" id="3912105"><a href="/crypto/tls/handshake_messages.go.html#3888584">bytes</a></span><span class="op" id="3912110">.</span><span class="ident" id="3912111">Equal</span><span class="op" id="3912116">(</span><span class="ident" id="3912117"><a href="/crypto/tls/handshake_messages.go.html#3911976">m</a></span><span class="op" id="3912118">.</span><span class="ident" id="3912119">raw</span><span class="op" id="3912122">,</span>&nbsp;<span class="ident" id="3912124"><a href="/crypto/tls/handshake_messages.go.html#3912031">m1</a></span><span class="op" id="3912126">.</span><span class="ident" id="3912127">raw</span><span class="op" id="3912130">)</span>&nbsp;<span class="op" id="3912132">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912137"><a href="/crypto/tls/handshake_messages.go.html#3888584">bytes</a></span><span class="op" id="3912142">.</span><span class="ident" id="3912143">Equal</span><span class="op" id="3912148">(</span><span class="ident" id="3912149"><a href="/crypto/tls/handshake_messages.go.html#3911976">m</a></span><span class="op" id="3912150">.</span><span class="ident" id="3912151">certificateTypes</span><span class="op" id="3912167">,</span>&nbsp;<span class="ident" id="3912169"><a href="/crypto/tls/handshake_messages.go.html#3912031">m1</a></span><span class="op" id="3912171">.</span><span class="ident" id="3912172">certificateTypes</span><span class="op" id="3912188">)</span>&nbsp;<span class="op" id="3912190">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912195"><a href="/crypto/tls/handshake_messages.go.html#3918343">eqByteSlices</a></span><span class="op" id="3912207">(</span><span class="ident" id="3912208"><a href="/crypto/tls/handshake_messages.go.html#3911976">m</a></span><span class="op" id="3912209">.</span><span class="ident" id="3912210">certificateAuthorities</span><span class="op" id="3912232">,</span>&nbsp;<span class="ident" id="3912234"><a href="/crypto/tls/handshake_messages.go.html#3912031">m1</a></span><span class="op" id="3912236">.</span><span class="ident" id="3912237">certificateAuthorities</span><span class="op" id="3912259">)</span>&nbsp;<span class="op" id="3912261">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912266"><a href="/crypto/tls/handshake_messages.go.html#3918515">eqSignatureAndHashes</a></span><span class="op" id="3912286">(</span><span class="ident" id="3912287"><a href="/crypto/tls/handshake_messages.go.html#3911976">m</a></span><span class="op" id="3912288">.</span><span class="ident" id="3912289">signatureAndHashes</span><span class="op" id="3912307">,</span>&nbsp;<span class="ident" id="3912309"><a href="/crypto/tls/handshake_messages.go.html#3912031">m1</a></span><span class="op" id="3912311">.</span><span class="ident" id="3912312">signatureAndHashes</span><span class="op" id="3912330">)</span><br>
<span class="lineno"></span><span class="op" id="3912332">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span><span class="keyword" id="3912335">func</span>&nbsp;<span class="op" id="3912340">(</span><span class="ident" id="3912341">m</span>&nbsp;<span class="op" id="3912343">*</span><span class="ident" id="3912344"><a href="/crypto/tls/handshake_messages.go.html#3911637">certificateRequestMsg</a></span><span class="op" id="3912365">)</span>&nbsp;<span class="ident" id="3912367">marshal</span><span class="op" id="3912374">(</span><span class="op" id="3912375">)</span>&nbsp;<span class="op" id="3912377">(</span><span class="ident" id="3912378">x</span>&nbsp;<span class="op" id="3912380">[</span><span class="op" id="3912381">]</span><span class="builtintype" id="3912382">byte</span><span class="op" id="3912386">)</span>&nbsp;<span class="op" id="3912388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3912391">if</span>&nbsp;<span class="ident" id="3912394"><a href="/crypto/tls/handshake_messages.go.html#3912341">m</a></span><span class="op" id="3912395">.</span><span class="ident" id="3912396">raw</span>&nbsp;<span class="op" id="3912400">!=</span>&nbsp;<span class="ident" id="3912403">nil</span>&nbsp;<span class="op" id="3912407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3912411">return</span>&nbsp;<span class="ident" id="3912418"><a href="/crypto/tls/handshake_messages.go.html#3912341">m</a></span><span class="op" id="3912419">.</span><span class="ident" id="3912420">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3912425">}</span><br>
<span class="lineno">1105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3912429">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc4346#section-7.4.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912486">length</span>&nbsp;<span class="op" id="3912493">:=</span>&nbsp;<span class="num" id="3912496">1</span>&nbsp;<span class="op" id="3912498">+</span>&nbsp;<span class="builtinfunc" id="3912500">len</span><span class="op" id="3912503">(</span><span class="ident" id="3912504"><a href="/crypto/tls/handshake_messages.go.html#3912341">m</a></span><span class="op" id="3912505">.</span><span class="ident" id="3912506">certificateTypes</span><span class="op" id="3912522">)</span>&nbsp;<span class="op" id="3912524">+</span>&nbsp;<span class="num" id="3912526">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912529">casLength</span>&nbsp;<span class="op" id="3912539">:=</span>&nbsp;<span class="num" id="3912542">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3912545">for</span>&nbsp;<span class="ident" id="3912549">_</span><span class="op" id="3912550">,</span>&nbsp;<span class="ident" id="3912552">ca</span>&nbsp;<span class="op" id="3912555">:=</span>&nbsp;<span class="keyword" id="3912558">range</span>&nbsp;<span class="ident" id="3912564"><a href="/crypto/tls/handshake_messages.go.html#3912341">m</a></span><span class="op" id="3912565">.</span><span class="ident" id="3912566">certificateAuthorities</span>&nbsp;<span class="op" id="3912589">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912593"><a href="/crypto/tls/handshake_messages.go.html#3912529">casLength</a></span>&nbsp;<span class="op" id="3912603">+=</span>&nbsp;<span class="num" id="3912606">2</span>&nbsp;<span class="op" id="3912608">+</span>&nbsp;<span class="builtinfunc" id="3912610">len</span><span class="op" id="3912613">(</span><span class="ident" id="3912614"><a href="/crypto/tls/handshake_messages.go.html#3912552">ca</a></span><span class="op" id="3912616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3912619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912622"><a href="/crypto/tls/handshake_messages.go.html#3912486">length</a></span>&nbsp;<span class="op" id="3912629">+=</span>&nbsp;<span class="ident" id="3912632"><a href="/crypto/tls/handshake_messages.go.html#3912529">casLength</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3912644">if</span>&nbsp;<span class="ident" id="3912647"><a href="/crypto/tls/handshake_messages.go.html#3912341">m</a></span><span class="op" id="3912648">.</span><span class="ident" id="3912649">hasSignatureAndHash</span>&nbsp;<span class="op" id="3912669">{</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912673"><a href="/crypto/tls/handshake_messages.go.html#3912486">length</a></span>&nbsp;<span class="op" id="3912680">+=</span>&nbsp;<span class="num" id="3912683">2</span>&nbsp;<span class="op" id="3912685">+</span>&nbsp;<span class="num" id="3912687">2</span><span class="op" id="3912688">*</span><span class="builtinfunc" id="3912689">len</span><span class="op" id="3912692">(</span><span class="ident" id="3912693"><a href="/crypto/tls/handshake_messages.go.html#3912341">m</a></span><span class="op" id="3912694">.</span><span class="ident" id="3912695">signatureAndHashes</span><span class="op" id="3912713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3912716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912720"><a href="/crypto/tls/handshake_messages.go.html#3912378">x</a></span>&nbsp;<span class="op" id="3912722">=</span>&nbsp;<span class="builtinfunc" id="3912724">make</span><span class="op" id="3912728">(</span><span class="op" id="3912729">[</span><span class="op" id="3912730">]</span><span class="builtintype" id="3912731">byte</span><span class="op" id="3912735">,</span>&nbsp;<span class="num" id="3912737">4</span><span class="op" id="3912738">+</span><span class="ident" id="3912739"><a href="/crypto/tls/handshake_messages.go.html#3912486">length</a></span><span class="op" id="3912745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912748"><a href="/crypto/tls/handshake_messages.go.html#3912378">x</a></span><span class="op" id="3912749">[</span><span class="num" id="3912750">0</span><span class="op" id="3912751">]</span>&nbsp;<span class="op" id="3912753">=</span>&nbsp;<span class="ident" id="3912755"><a href="/crypto/tls/common.go.html#3823657">typeCertificateRequest</a></span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912779"><a href="/crypto/tls/handshake_messages.go.html#3912378">x</a></span><span class="op" id="3912780">[</span><span class="num" id="3912781">1</span><span class="op" id="3912782">]</span>&nbsp;<span class="op" id="3912784">=</span>&nbsp;<span class="builtintype" id="3912786">uint8</span><span class="op" id="3912791">(</span><span class="ident" id="3912792"><a href="/crypto/tls/handshake_messages.go.html#3912486">length</a></span>&nbsp;<span class="op" id="3912799">&gt;&gt;</span>&nbsp;<span class="num" id="3912802">16</span><span class="op" id="3912804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912807"><a href="/crypto/tls/handshake_messages.go.html#3912378">x</a></span><span class="op" id="3912808">[</span><span class="num" id="3912809">2</span><span class="op" id="3912810">]</span>&nbsp;<span class="op" id="3912812">=</span>&nbsp;<span class="builtintype" id="3912814">uint8</span><span class="op" id="3912819">(</span><span class="ident" id="3912820"><a href="/crypto/tls/handshake_messages.go.html#3912486">length</a></span>&nbsp;<span class="op" id="3912827">&gt;&gt;</span>&nbsp;<span class="num" id="3912830">8</span><span class="op" id="3912831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912834"><a href="/crypto/tls/handshake_messages.go.html#3912378">x</a></span><span class="op" id="3912835">[</span><span class="num" id="3912836">3</span><span class="op" id="3912837">]</span>&nbsp;<span class="op" id="3912839">=</span>&nbsp;<span class="builtintype" id="3912841">uint8</span><span class="op" id="3912846">(</span><span class="ident" id="3912847"><a href="/crypto/tls/handshake_messages.go.html#3912486">length</a></span><span class="op" id="3912853">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912857"><a href="/crypto/tls/handshake_messages.go.html#3912378">x</a></span><span class="op" id="3912858">[</span><span class="num" id="3912859">4</span><span class="op" id="3912860">]</span>&nbsp;<span class="op" id="3912862">=</span>&nbsp;<span class="builtintype" id="3912864">uint8</span><span class="op" id="3912869">(</span><span class="builtinfunc" id="3912870">len</span><span class="op" id="3912873">(</span><span class="ident" id="3912874"><a href="/crypto/tls/handshake_messages.go.html#3912341">m</a></span><span class="op" id="3912875">.</span><span class="ident" id="3912876">certificateTypes</span><span class="op" id="3912892">)</span><span class="op" id="3912893">)</span><br>
<span class="lineno">1125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3912897">copy</span><span class="op" id="3912901">(</span><span class="ident" id="3912902"><a href="/crypto/tls/handshake_messages.go.html#3912378">x</a></span><span class="op" id="3912903">[</span><span class="num" id="3912904">5</span><span class="op" id="3912905">:</span><span class="op" id="3912906">]</span><span class="op" id="3912907">,</span>&nbsp;<span class="ident" id="3912909"><a href="/crypto/tls/handshake_messages.go.html#3912341">m</a></span><span class="op" id="3912910">.</span><span class="ident" id="3912911">certificateTypes</span><span class="op" id="3912927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912930">y</span>&nbsp;<span class="op" id="3912932">:=</span>&nbsp;<span class="ident" id="3912935"><a href="/crypto/tls/handshake_messages.go.html#3912378">x</a></span><span class="op" id="3912936">[</span><span class="num" id="3912937">5</span><span class="op" id="3912938">+</span><span class="builtinfunc" id="3912939">len</span><span class="op" id="3912942">(</span><span class="ident" id="3912943"><a href="/crypto/tls/handshake_messages.go.html#3912341">m</a></span><span class="op" id="3912944">.</span><span class="ident" id="3912945">certificateTypes</span><span class="op" id="3912961">)</span><span class="op" id="3912962">:</span><span class="op" id="3912963">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3912967">if</span>&nbsp;<span class="ident" id="3912970"><a href="/crypto/tls/handshake_messages.go.html#3912341">m</a></span><span class="op" id="3912971">.</span><span class="ident" id="3912972">hasSignatureAndHash</span>&nbsp;<span class="op" id="3912992">{</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3912996">n</span>&nbsp;<span class="op" id="3912998">:=</span>&nbsp;<span class="builtinfunc" id="3913001">len</span><span class="op" id="3913004">(</span><span class="ident" id="3913005"><a href="/crypto/tls/handshake_messages.go.html#3912341">m</a></span><span class="op" id="3913006">.</span><span class="ident" id="3913007">signatureAndHashes</span><span class="op" id="3913025">)</span>&nbsp;<span class="op" id="3913027">*</span>&nbsp;<span class="num" id="3913029">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913033"><a href="/crypto/tls/handshake_messages.go.html#3912930">y</a></span><span class="op" id="3913034">[</span><span class="num" id="3913035">0</span><span class="op" id="3913036">]</span>&nbsp;<span class="op" id="3913038">=</span>&nbsp;<span class="builtintype" id="3913040">uint8</span><span class="op" id="3913045">(</span><span class="ident" id="3913046"><a href="/crypto/tls/handshake_messages.go.html#3912996">n</a></span>&nbsp;<span class="op" id="3913048">&gt;&gt;</span>&nbsp;<span class="num" id="3913051">8</span><span class="op" id="3913052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913056"><a href="/crypto/tls/handshake_messages.go.html#3912930">y</a></span><span class="op" id="3913057">[</span><span class="num" id="3913058">1</span><span class="op" id="3913059">]</span>&nbsp;<span class="op" id="3913061">=</span>&nbsp;<span class="builtintype" id="3913063">uint8</span><span class="op" id="3913068">(</span><span class="ident" id="3913069"><a href="/crypto/tls/handshake_messages.go.html#3912996">n</a></span><span class="op" id="3913070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913074"><a href="/crypto/tls/handshake_messages.go.html#3912930">y</a></span>&nbsp;<span class="op" id="3913076">=</span>&nbsp;<span class="ident" id="3913078"><a href="/crypto/tls/handshake_messages.go.html#3912930">y</a></span><span class="op" id="3913079">[</span><span class="num" id="3913080">2</span><span class="op" id="3913081">:</span><span class="op" id="3913082">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3913086">for</span>&nbsp;<span class="ident" id="3913090">_</span><span class="op" id="3913091">,</span>&nbsp;<span class="ident" id="3913093">sigAndHash</span>&nbsp;<span class="op" id="3913104">:=</span>&nbsp;<span class="keyword" id="3913107">range</span>&nbsp;<span class="ident" id="3913113"><a href="/crypto/tls/handshake_messages.go.html#3912341">m</a></span><span class="op" id="3913114">.</span><span class="ident" id="3913115">signatureAndHashes</span>&nbsp;<span class="op" id="3913134">{</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913139"><a href="/crypto/tls/handshake_messages.go.html#3912930">y</a></span><span class="op" id="3913140">[</span><span class="num" id="3913141">0</span><span class="op" id="3913142">]</span>&nbsp;<span class="op" id="3913144">=</span>&nbsp;<span class="ident" id="3913146"><a href="/crypto/tls/handshake_messages.go.html#3913093">sigAndHash</a></span><span class="op" id="3913156">.</span><span class="ident" id="3913157">hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913165"><a href="/crypto/tls/handshake_messages.go.html#3912930">y</a></span><span class="op" id="3913166">[</span><span class="num" id="3913167">1</span><span class="op" id="3913168">]</span>&nbsp;<span class="op" id="3913170">=</span>&nbsp;<span class="ident" id="3913172"><a href="/crypto/tls/handshake_messages.go.html#3913093">sigAndHash</a></span><span class="op" id="3913182">.</span><span class="ident" id="3913183">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913196"><a href="/crypto/tls/handshake_messages.go.html#3912930">y</a></span>&nbsp;<span class="op" id="3913198">=</span>&nbsp;<span class="ident" id="3913200"><a href="/crypto/tls/handshake_messages.go.html#3912930">y</a></span><span class="op" id="3913201">[</span><span class="num" id="3913202">2</span><span class="op" id="3913203">:</span><span class="op" id="3913204">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3913208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3913211">}</span><br>
<span class="lineno">1140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913215"><a href="/crypto/tls/handshake_messages.go.html#3912930">y</a></span><span class="op" id="3913216">[</span><span class="num" id="3913217">0</span><span class="op" id="3913218">]</span>&nbsp;<span class="op" id="3913220">=</span>&nbsp;<span class="builtintype" id="3913222">uint8</span><span class="op" id="3913227">(</span><span class="ident" id="3913228"><a href="/crypto/tls/handshake_messages.go.html#3912529">casLength</a></span>&nbsp;<span class="op" id="3913238">&gt;&gt;</span>&nbsp;<span class="num" id="3913241">8</span><span class="op" id="3913242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913245"><a href="/crypto/tls/handshake_messages.go.html#3912930">y</a></span><span class="op" id="3913246">[</span><span class="num" id="3913247">1</span><span class="op" id="3913248">]</span>&nbsp;<span class="op" id="3913250">=</span>&nbsp;<span class="builtintype" id="3913252">uint8</span><span class="op" id="3913257">(</span><span class="ident" id="3913258"><a href="/crypto/tls/handshake_messages.go.html#3912529">casLength</a></span><span class="op" id="3913267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913270"><a href="/crypto/tls/handshake_messages.go.html#3912930">y</a></span>&nbsp;<span class="op" id="3913272">=</span>&nbsp;<span class="ident" id="3913274"><a href="/crypto/tls/handshake_messages.go.html#3912930">y</a></span><span class="op" id="3913275">[</span><span class="num" id="3913276">2</span><span class="op" id="3913277">:</span><span class="op" id="3913278">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3913281">for</span>&nbsp;<span class="ident" id="3913285">_</span><span class="op" id="3913286">,</span>&nbsp;<span class="ident" id="3913288">ca</span>&nbsp;<span class="op" id="3913291">:=</span>&nbsp;<span class="keyword" id="3913294">range</span>&nbsp;<span class="ident" id="3913300"><a href="/crypto/tls/handshake_messages.go.html#3912341">m</a></span><span class="op" id="3913301">.</span><span class="ident" id="3913302">certificateAuthorities</span>&nbsp;<span class="op" id="3913325">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913329"><a href="/crypto/tls/handshake_messages.go.html#3912930">y</a></span><span class="op" id="3913330">[</span><span class="num" id="3913331">0</span><span class="op" id="3913332">]</span>&nbsp;<span class="op" id="3913334">=</span>&nbsp;<span class="builtintype" id="3913336">uint8</span><span class="op" id="3913341">(</span><span class="builtinfunc" id="3913342">len</span><span class="op" id="3913345">(</span><span class="ident" id="3913346"><a href="/crypto/tls/handshake_messages.go.html#3913288">ca</a></span><span class="op" id="3913348">)</span>&nbsp;<span class="op" id="3913350">&gt;&gt;</span>&nbsp;<span class="num" id="3913353">8</span><span class="op" id="3913354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913358"><a href="/crypto/tls/handshake_messages.go.html#3912930">y</a></span><span class="op" id="3913359">[</span><span class="num" id="3913360">1</span><span class="op" id="3913361">]</span>&nbsp;<span class="op" id="3913363">=</span>&nbsp;<span class="builtintype" id="3913365">uint8</span><span class="op" id="3913370">(</span><span class="builtinfunc" id="3913371">len</span><span class="op" id="3913374">(</span><span class="ident" id="3913375"><a href="/crypto/tls/handshake_messages.go.html#3913288">ca</a></span><span class="op" id="3913377">)</span><span class="op" id="3913378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913382"><a href="/crypto/tls/handshake_messages.go.html#3912930">y</a></span>&nbsp;<span class="op" id="3913384">=</span>&nbsp;<span class="ident" id="3913386"><a href="/crypto/tls/handshake_messages.go.html#3912930">y</a></span><span class="op" id="3913387">[</span><span class="num" id="3913388">2</span><span class="op" id="3913389">:</span><span class="op" id="3913390">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3913394">copy</span><span class="op" id="3913398">(</span><span class="ident" id="3913399"><a href="/crypto/tls/handshake_messages.go.html#3912930">y</a></span><span class="op" id="3913400">,</span>&nbsp;<span class="ident" id="3913402"><a href="/crypto/tls/handshake_messages.go.html#3913288">ca</a></span><span class="op" id="3913404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913408"><a href="/crypto/tls/handshake_messages.go.html#3912930">y</a></span>&nbsp;<span class="op" id="3913410">=</span>&nbsp;<span class="ident" id="3913412"><a href="/crypto/tls/handshake_messages.go.html#3912930">y</a></span><span class="op" id="3913413">[</span><span class="builtinfunc" id="3913414">len</span><span class="op" id="3913417">(</span><span class="ident" id="3913418"><a href="/crypto/tls/handshake_messages.go.html#3913288">ca</a></span><span class="op" id="3913420">)</span><span class="op" id="3913421">:</span><span class="op" id="3913422">]</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3913425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913429"><a href="/crypto/tls/handshake_messages.go.html#3912341">m</a></span><span class="op" id="3913430">.</span><span class="ident" id="3913431">raw</span>&nbsp;<span class="op" id="3913435">=</span>&nbsp;<span class="ident" id="3913437"><a href="/crypto/tls/handshake_messages.go.html#3912378">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3913440">return</span><br>
<span class="lineno"></span><span class="op" id="3913447">}</span><br>
<span class="lineno">1155</span><br>
<span class="lineno"></span><span class="keyword" id="3913450">func</span>&nbsp;<span class="op" id="3913455">(</span><span class="ident" id="3913456">m</span>&nbsp;<span class="op" id="3913458">*</span><span class="ident" id="3913459"><a href="/crypto/tls/handshake_messages.go.html#3911637">certificateRequestMsg</a></span><span class="op" id="3913480">)</span>&nbsp;<span class="ident" id="3913482">unmarshal</span><span class="op" id="3913491">(</span><span class="ident" id="3913492">data</span>&nbsp;<span class="op" id="3913497">[</span><span class="op" id="3913498">]</span><span class="builtintype" id="3913499">byte</span><span class="op" id="3913503">)</span>&nbsp;<span class="builtintype" id="3913505">bool</span>&nbsp;<span class="op" id="3913510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913513"><a href="/crypto/tls/handshake_messages.go.html#3913456">m</a></span><span class="op" id="3913514">.</span><span class="ident" id="3913515">raw</span>&nbsp;<span class="op" id="3913519">=</span>&nbsp;<span class="ident" id="3913521"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3913528">if</span>&nbsp;<span class="builtinfunc" id="3913531">len</span><span class="op" id="3913534">(</span><span class="ident" id="3913535"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span><span class="op" id="3913539">)</span>&nbsp;<span class="op" id="3913541">&lt;</span>&nbsp;<span class="num" id="3913543">5</span>&nbsp;<span class="op" id="3913545">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3913549">return</span>&nbsp;<span class="builtintype" id="3913556">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3913563">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913567">length</span>&nbsp;<span class="op" id="3913574">:=</span>&nbsp;<span class="builtintype" id="3913577">uint32</span><span class="op" id="3913583">(</span><span class="ident" id="3913584"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span><span class="op" id="3913588">[</span><span class="num" id="3913589">1</span><span class="op" id="3913590">]</span><span class="op" id="3913591">)</span><span class="op" id="3913592">&lt;&lt;</span><span class="num" id="3913594">16</span>&nbsp;<span class="op" id="3913597">|</span>&nbsp;<span class="builtintype" id="3913599">uint32</span><span class="op" id="3913605">(</span><span class="ident" id="3913606"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span><span class="op" id="3913610">[</span><span class="num" id="3913611">2</span><span class="op" id="3913612">]</span><span class="op" id="3913613">)</span><span class="op" id="3913614">&lt;&lt;</span><span class="num" id="3913616">8</span>&nbsp;<span class="op" id="3913618">|</span>&nbsp;<span class="builtintype" id="3913620">uint32</span><span class="op" id="3913626">(</span><span class="ident" id="3913627"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span><span class="op" id="3913631">[</span><span class="num" id="3913632">3</span><span class="op" id="3913633">]</span><span class="op" id="3913634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3913637">if</span>&nbsp;<span class="builtintype" id="3913640">uint32</span><span class="op" id="3913646">(</span><span class="builtinfunc" id="3913647">len</span><span class="op" id="3913650">(</span><span class="ident" id="3913651"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span><span class="op" id="3913655">)</span><span class="op" id="3913656">)</span><span class="op" id="3913657">-</span><span class="num" id="3913658">4</span>&nbsp;<span class="op" id="3913660">!=</span>&nbsp;<span class="ident" id="3913663"><a href="/crypto/tls/handshake_messages.go.html#3913567">length</a></span>&nbsp;<span class="op" id="3913670">{</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3913674">return</span>&nbsp;<span class="builtintype" id="3913681">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3913688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913692">numCertTypes</span>&nbsp;<span class="op" id="3913705">:=</span>&nbsp;<span class="builtintype" id="3913708">int</span><span class="op" id="3913711">(</span><span class="ident" id="3913712"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span><span class="op" id="3913716">[</span><span class="num" id="3913717">4</span><span class="op" id="3913718">]</span><span class="op" id="3913719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913722"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span>&nbsp;<span class="op" id="3913727">=</span>&nbsp;<span class="ident" id="3913729"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span><span class="op" id="3913733">[</span><span class="num" id="3913734">5</span><span class="op" id="3913735">:</span><span class="op" id="3913736">]</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3913739">if</span>&nbsp;<span class="ident" id="3913742"><a href="/crypto/tls/handshake_messages.go.html#3913692">numCertTypes</a></span>&nbsp;<span class="op" id="3913755">==</span>&nbsp;<span class="num" id="3913758">0</span>&nbsp;<span class="op" id="3913760">||</span>&nbsp;<span class="builtinfunc" id="3913763">len</span><span class="op" id="3913766">(</span><span class="ident" id="3913767"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span><span class="op" id="3913771">)</span>&nbsp;<span class="op" id="3913773">&lt;=</span>&nbsp;<span class="ident" id="3913776"><a href="/crypto/tls/handshake_messages.go.html#3913692">numCertTypes</a></span>&nbsp;<span class="op" id="3913789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3913793">return</span>&nbsp;<span class="builtintype" id="3913800">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3913807">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913811"><a href="/crypto/tls/handshake_messages.go.html#3913456">m</a></span><span class="op" id="3913812">.</span><span class="ident" id="3913813">certificateTypes</span>&nbsp;<span class="op" id="3913830">=</span>&nbsp;<span class="builtinfunc" id="3913832">make</span><span class="op" id="3913836">(</span><span class="op" id="3913837">[</span><span class="op" id="3913838">]</span><span class="builtintype" id="3913839">byte</span><span class="op" id="3913843">,</span>&nbsp;<span class="ident" id="3913845"><a href="/crypto/tls/handshake_messages.go.html#3913692">numCertTypes</a></span><span class="op" id="3913857">)</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3913860">if</span>&nbsp;<span class="builtinfunc" id="3913863">copy</span><span class="op" id="3913867">(</span><span class="ident" id="3913868"><a href="/crypto/tls/handshake_messages.go.html#3913456">m</a></span><span class="op" id="3913869">.</span><span class="ident" id="3913870">certificateTypes</span><span class="op" id="3913886">,</span>&nbsp;<span class="ident" id="3913888"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span><span class="op" id="3913892">)</span>&nbsp;<span class="op" id="3913894">!=</span>&nbsp;<span class="ident" id="3913897"><a href="/crypto/tls/handshake_messages.go.html#3913692">numCertTypes</a></span>&nbsp;<span class="op" id="3913910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3913914">return</span>&nbsp;<span class="builtintype" id="3913921">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3913928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3913932"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span>&nbsp;<span class="op" id="3913937">=</span>&nbsp;<span class="ident" id="3913939"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span><span class="op" id="3913943">[</span><span class="ident" id="3913944"><a href="/crypto/tls/handshake_messages.go.html#3913692">numCertTypes</a></span><span class="op" id="3913956">:</span><span class="op" id="3913957">]</span><br>
<span class="lineno">1180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3913961">if</span>&nbsp;<span class="ident" id="3913964"><a href="/crypto/tls/handshake_messages.go.html#3913456">m</a></span><span class="op" id="3913965">.</span><span class="ident" id="3913966">hasSignatureAndHash</span>&nbsp;<span class="op" id="3913986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3913990">if</span>&nbsp;<span class="builtinfunc" id="3913993">len</span><span class="op" id="3913996">(</span><span class="ident" id="3913997"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span><span class="op" id="3914001">)</span>&nbsp;<span class="op" id="3914003">&lt;</span>&nbsp;<span class="num" id="3914005">2</span>&nbsp;<span class="op" id="3914007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3914012">return</span>&nbsp;<span class="builtintype" id="3914019">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3914027">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914031">sigAndHashLen</span>&nbsp;<span class="op" id="3914045">:=</span>&nbsp;<span class="builtintype" id="3914048">uint16</span><span class="op" id="3914054">(</span><span class="ident" id="3914055"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span><span class="op" id="3914059">[</span><span class="num" id="3914060">0</span><span class="op" id="3914061">]</span><span class="op" id="3914062">)</span><span class="op" id="3914063">&lt;&lt;</span><span class="num" id="3914065">8</span>&nbsp;<span class="op" id="3914067">|</span>&nbsp;<span class="builtintype" id="3914069">uint16</span><span class="op" id="3914075">(</span><span class="ident" id="3914076"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span><span class="op" id="3914080">[</span><span class="num" id="3914081">1</span><span class="op" id="3914082">]</span><span class="op" id="3914083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914087"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span>&nbsp;<span class="op" id="3914092">=</span>&nbsp;<span class="ident" id="3914094"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span><span class="op" id="3914098">[</span><span class="num" id="3914099">2</span><span class="op" id="3914100">:</span><span class="op" id="3914101">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3914105">if</span>&nbsp;<span class="ident" id="3914108"><a href="/crypto/tls/handshake_messages.go.html#3914031">sigAndHashLen</a></span><span class="op" id="3914121">&amp;</span><span class="num" id="3914122">1</span>&nbsp;<span class="op" id="3914124">!=</span>&nbsp;<span class="num" id="3914127">0</span>&nbsp;<span class="op" id="3914129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3914134">return</span>&nbsp;<span class="builtintype" id="3914141">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3914149">}</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3914153">if</span>&nbsp;<span class="builtinfunc" id="3914156">len</span><span class="op" id="3914159">(</span><span class="ident" id="3914160"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span><span class="op" id="3914164">)</span>&nbsp;<span class="op" id="3914166">&lt;</span>&nbsp;<span class="builtintype" id="3914168">int</span><span class="op" id="3914171">(</span><span class="ident" id="3914172"><a href="/crypto/tls/handshake_messages.go.html#3914031">sigAndHashLen</a></span><span class="op" id="3914185">)</span>&nbsp;<span class="op" id="3914187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3914192">return</span>&nbsp;<span class="builtintype" id="3914199">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3914207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914211">numSigAndHash</span>&nbsp;<span class="op" id="3914225">:=</span>&nbsp;<span class="ident" id="3914228"><a href="/crypto/tls/handshake_messages.go.html#3914031">sigAndHashLen</a></span>&nbsp;<span class="op" id="3914242">/</span>&nbsp;<span class="num" id="3914244">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914248"><a href="/crypto/tls/handshake_messages.go.html#3913456">m</a></span><span class="op" id="3914249">.</span><span class="ident" id="3914250">signatureAndHashes</span>&nbsp;<span class="op" id="3914269">=</span>&nbsp;<span class="builtinfunc" id="3914271">make</span><span class="op" id="3914275">(</span><span class="op" id="3914276">[</span><span class="op" id="3914277">]</span><span class="ident" id="3914278"><a href="/crypto/tls/common.go.html#3826090">signatureAndHash</a></span><span class="op" id="3914294">,</span>&nbsp;<span class="ident" id="3914296"><a href="/crypto/tls/handshake_messages.go.html#3914211">numSigAndHash</a></span><span class="op" id="3914309">)</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3914313">for</span>&nbsp;<span class="ident" id="3914317">i</span>&nbsp;<span class="op" id="3914319">:=</span>&nbsp;<span class="keyword" id="3914322">range</span>&nbsp;<span class="ident" id="3914328"><a href="/crypto/tls/handshake_messages.go.html#3913456">m</a></span><span class="op" id="3914329">.</span><span class="ident" id="3914330">signatureAndHashes</span>&nbsp;<span class="op" id="3914349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914354"><a href="/crypto/tls/handshake_messages.go.html#3913456">m</a></span><span class="op" id="3914355">.</span><span class="ident" id="3914356">signatureAndHashes</span><span class="op" id="3914374">[</span><span class="ident" id="3914375"><a href="/crypto/tls/handshake_messages.go.html#3914317">i</a></span><span class="op" id="3914376">]</span><span class="op" id="3914377">.</span><span class="ident" id="3914378">hash</span>&nbsp;<span class="op" id="3914383">=</span>&nbsp;<span class="ident" id="3914385"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span><span class="op" id="3914389">[</span><span class="num" id="3914390">0</span><span class="op" id="3914391">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914396"><a href="/crypto/tls/handshake_messages.go.html#3913456">m</a></span><span class="op" id="3914397">.</span><span class="ident" id="3914398">signatureAndHashes</span><span class="op" id="3914416">[</span><span class="ident" id="3914417"><a href="/crypto/tls/handshake_messages.go.html#3914317">i</a></span><span class="op" id="3914418">]</span><span class="op" id="3914419">.</span><span class="ident" id="3914420">signature</span>&nbsp;<span class="op" id="3914430">=</span>&nbsp;<span class="ident" id="3914432"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span><span class="op" id="3914436">[</span><span class="num" id="3914437">1</span><span class="op" id="3914438">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914443"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span>&nbsp;<span class="op" id="3914448">=</span>&nbsp;<span class="ident" id="3914450"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span><span class="op" id="3914454">[</span><span class="num" id="3914455">2</span><span class="op" id="3914456">:</span><span class="op" id="3914457">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3914461">}</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3914464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3914468">if</span>&nbsp;<span class="builtinfunc" id="3914471">len</span><span class="op" id="3914474">(</span><span class="ident" id="3914475"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span><span class="op" id="3914479">)</span>&nbsp;<span class="op" id="3914481">&lt;</span>&nbsp;<span class="num" id="3914483">2</span>&nbsp;<span class="op" id="3914485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3914489">return</span>&nbsp;<span class="builtintype" id="3914496">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3914503">}</span><br>
<span class="lineno">1205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914506">casLength</span>&nbsp;<span class="op" id="3914516">:=</span>&nbsp;<span class="builtintype" id="3914519">uint16</span><span class="op" id="3914525">(</span><span class="ident" id="3914526"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span><span class="op" id="3914530">[</span><span class="num" id="3914531">0</span><span class="op" id="3914532">]</span><span class="op" id="3914533">)</span><span class="op" id="3914534">&lt;&lt;</span><span class="num" id="3914536">8</span>&nbsp;<span class="op" id="3914538">|</span>&nbsp;<span class="builtintype" id="3914540">uint16</span><span class="op" id="3914546">(</span><span class="ident" id="3914547"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span><span class="op" id="3914551">[</span><span class="num" id="3914552">1</span><span class="op" id="3914553">]</span><span class="op" id="3914554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914557"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span>&nbsp;<span class="op" id="3914562">=</span>&nbsp;<span class="ident" id="3914564"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span><span class="op" id="3914568">[</span><span class="num" id="3914569">2</span><span class="op" id="3914570">:</span><span class="op" id="3914571">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3914574">if</span>&nbsp;<span class="builtinfunc" id="3914577">len</span><span class="op" id="3914580">(</span><span class="ident" id="3914581"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span><span class="op" id="3914585">)</span>&nbsp;<span class="op" id="3914587">&lt;</span>&nbsp;<span class="builtintype" id="3914589">int</span><span class="op" id="3914592">(</span><span class="ident" id="3914593"><a href="/crypto/tls/handshake_messages.go.html#3914506">casLength</a></span><span class="op" id="3914602">)</span>&nbsp;<span class="op" id="3914604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3914608">return</span>&nbsp;<span class="builtintype" id="3914615">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3914622">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914625">cas</span>&nbsp;<span class="op" id="3914629">:=</span>&nbsp;<span class="builtinfunc" id="3914632">make</span><span class="op" id="3914636">(</span><span class="op" id="3914637">[</span><span class="op" id="3914638">]</span><span class="builtintype" id="3914639">byte</span><span class="op" id="3914643">,</span>&nbsp;<span class="ident" id="3914645"><a href="/crypto/tls/handshake_messages.go.html#3914506">casLength</a></span><span class="op" id="3914654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3914657">copy</span><span class="op" id="3914661">(</span><span class="ident" id="3914662"><a href="/crypto/tls/handshake_messages.go.html#3914625">cas</a></span><span class="op" id="3914665">,</span>&nbsp;<span class="ident" id="3914667"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span><span class="op" id="3914671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914674"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span>&nbsp;<span class="op" id="3914679">=</span>&nbsp;<span class="ident" id="3914681"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span><span class="op" id="3914685">[</span><span class="ident" id="3914686"><a href="/crypto/tls/handshake_messages.go.html#3914506">casLength</a></span><span class="op" id="3914695">:</span><span class="op" id="3914696">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914700"><a href="/crypto/tls/handshake_messages.go.html#3913456">m</a></span><span class="op" id="3914701">.</span><span class="ident" id="3914702">certificateAuthorities</span>&nbsp;<span class="op" id="3914725">=</span>&nbsp;<span class="ident" id="3914727">nil</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3914732">for</span>&nbsp;<span class="builtinfunc" id="3914736">len</span><span class="op" id="3914739">(</span><span class="ident" id="3914740"><a href="/crypto/tls/handshake_messages.go.html#3914625">cas</a></span><span class="op" id="3914743">)</span>&nbsp;<span class="op" id="3914745">&gt;</span>&nbsp;<span class="num" id="3914747">0</span>&nbsp;<span class="op" id="3914749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3914753">if</span>&nbsp;<span class="builtinfunc" id="3914756">len</span><span class="op" id="3914759">(</span><span class="ident" id="3914760"><a href="/crypto/tls/handshake_messages.go.html#3914625">cas</a></span><span class="op" id="3914763">)</span>&nbsp;<span class="op" id="3914765">&lt;</span>&nbsp;<span class="num" id="3914767">2</span>&nbsp;<span class="op" id="3914769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3914774">return</span>&nbsp;<span class="builtintype" id="3914781">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3914789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914793">caLen</span>&nbsp;<span class="op" id="3914799">:=</span>&nbsp;<span class="builtintype" id="3914802">uint16</span><span class="op" id="3914808">(</span><span class="ident" id="3914809"><a href="/crypto/tls/handshake_messages.go.html#3914625">cas</a></span><span class="op" id="3914812">[</span><span class="num" id="3914813">0</span><span class="op" id="3914814">]</span><span class="op" id="3914815">)</span><span class="op" id="3914816">&lt;&lt;</span><span class="num" id="3914818">8</span>&nbsp;<span class="op" id="3914820">|</span>&nbsp;<span class="builtintype" id="3914822">uint16</span><span class="op" id="3914828">(</span><span class="ident" id="3914829"><a href="/crypto/tls/handshake_messages.go.html#3914625">cas</a></span><span class="op" id="3914832">[</span><span class="num" id="3914833">1</span><span class="op" id="3914834">]</span><span class="op" id="3914835">)</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914839"><a href="/crypto/tls/handshake_messages.go.html#3914625">cas</a></span>&nbsp;<span class="op" id="3914843">=</span>&nbsp;<span class="ident" id="3914845"><a href="/crypto/tls/handshake_messages.go.html#3914625">cas</a></span><span class="op" id="3914848">[</span><span class="num" id="3914849">2</span><span class="op" id="3914850">:</span><span class="op" id="3914851">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3914856">if</span>&nbsp;<span class="builtinfunc" id="3914859">len</span><span class="op" id="3914862">(</span><span class="ident" id="3914863"><a href="/crypto/tls/handshake_messages.go.html#3914625">cas</a></span><span class="op" id="3914866">)</span>&nbsp;<span class="op" id="3914868">&lt;</span>&nbsp;<span class="builtintype" id="3914870">int</span><span class="op" id="3914873">(</span><span class="ident" id="3914874"><a href="/crypto/tls/handshake_messages.go.html#3914793">caLen</a></span><span class="op" id="3914879">)</span>&nbsp;<span class="op" id="3914881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3914886">return</span>&nbsp;<span class="builtintype" id="3914893">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3914901">}</span><br>
<span class="lineno">1225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914906"><a href="/crypto/tls/handshake_messages.go.html#3913456">m</a></span><span class="op" id="3914907">.</span><span class="ident" id="3914908">certificateAuthorities</span>&nbsp;<span class="op" id="3914931">=</span>&nbsp;<span class="builtinfunc" id="3914933">append</span><span class="op" id="3914939">(</span><span class="ident" id="3914940"><a href="/crypto/tls/handshake_messages.go.html#3913456">m</a></span><span class="op" id="3914941">.</span><span class="ident" id="3914942">certificateAuthorities</span><span class="op" id="3914964">,</span>&nbsp;<span class="ident" id="3914966"><a href="/crypto/tls/handshake_messages.go.html#3914625">cas</a></span><span class="op" id="3914969">[</span><span class="op" id="3914970">:</span><span class="ident" id="3914971"><a href="/crypto/tls/handshake_messages.go.html#3914793">caLen</a></span><span class="op" id="3914976">]</span><span class="op" id="3914977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3914981"><a href="/crypto/tls/handshake_messages.go.html#3914625">cas</a></span>&nbsp;<span class="op" id="3914985">=</span>&nbsp;<span class="ident" id="3914987"><a href="/crypto/tls/handshake_messages.go.html#3914625">cas</a></span><span class="op" id="3914990">[</span><span class="ident" id="3914991"><a href="/crypto/tls/handshake_messages.go.html#3914793">caLen</a></span><span class="op" id="3914996">:</span><span class="op" id="3914997">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3915000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3915003">if</span>&nbsp;<span class="builtinfunc" id="3915006">len</span><span class="op" id="3915009">(</span><span class="ident" id="3915010"><a href="/crypto/tls/handshake_messages.go.html#3913492">data</a></span><span class="op" id="3915014">)</span>&nbsp;<span class="op" id="3915016">&gt;</span>&nbsp;<span class="num" id="3915018">0</span>&nbsp;<span class="op" id="3915020">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3915024">return</span>&nbsp;<span class="builtintype" id="3915031">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3915038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3915042">return</span>&nbsp;<span class="builtintype" id="3915049">true</span><br>
<span class="lineno"></span><span class="op" id="3915054">}</span><br>
<span class="lineno">1235</span><br>
<span class="lineno"></span><span class="keyword" id="3915057">type</span>&nbsp;<span class="ident" id="3915062">certificateVerifyMsg</span>&nbsp;<span class="keyword" id="3915083">struct</span>&nbsp;<span class="op" id="3915090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3915093">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3915113">[</span><span class="op" id="3915114">]</span><span class="builtintype" id="3915115">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3915121">hasSignatureAndHash</span>&nbsp;<span class="builtintype" id="3915141">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3915147">signatureAndHash</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3915167"><a href="/crypto/tls/common.go.html#3826090">signatureAndHash</a></span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3915185">signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3915205">[</span><span class="op" id="3915206">]</span><span class="builtintype" id="3915207">byte</span><br>
<span class="lineno"></span><span class="op" id="3915212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3915215">func</span>&nbsp;<span class="op" id="3915220">(</span><span class="ident" id="3915221">m</span>&nbsp;<span class="op" id="3915223">*</span><span class="ident" id="3915224"><a href="/crypto/tls/handshake_messages.go.html#3915062">certificateVerifyMsg</a></span><span class="op" id="3915244">)</span>&nbsp;<span class="ident" id="3915246">equal</span><span class="op" id="3915251">(</span><span class="ident" id="3915252">i</span>&nbsp;<span class="keyword" id="3915254">interface</span><span class="op" id="3915263">{</span><span class="op" id="3915264">}</span><span class="op" id="3915265">)</span>&nbsp;<span class="builtintype" id="3915267">bool</span>&nbsp;<span class="op" id="3915272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3915275">m1</span><span class="op" id="3915277">,</span>&nbsp;<span class="ident" id="3915279">ok</span>&nbsp;<span class="op" id="3915282">:=</span>&nbsp;<span class="ident" id="3915285"><a href="/crypto/tls/handshake_messages.go.html#3915252">i</a></span><span class="op" id="3915286">.</span><span class="op" id="3915287">(</span><span class="op" id="3915288">*</span><span class="ident" id="3915289"><a href="/crypto/tls/handshake_messages.go.html#3915062">certificateVerifyMsg</a></span><span class="op" id="3915309">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3915312">if</span>&nbsp;<span class="op" id="3915315">!</span><span class="ident" id="3915316"><a href="/crypto/tls/handshake_messages.go.html#3915279">ok</a></span>&nbsp;<span class="op" id="3915319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3915323">return</span>&nbsp;<span class="builtintype" id="3915330">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3915337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3915341">return</span>&nbsp;<span class="ident" id="3915348"><a href="/crypto/tls/handshake_messages.go.html#3888584">bytes</a></span><span class="op" id="3915353">.</span><span class="ident" id="3915354">Equal</span><span class="op" id="3915359">(</span><span class="ident" id="3915360"><a href="/crypto/tls/handshake_messages.go.html#3915221">m</a></span><span class="op" id="3915361">.</span><span class="ident" id="3915362">raw</span><span class="op" id="3915365">,</span>&nbsp;<span class="ident" id="3915367"><a href="/crypto/tls/handshake_messages.go.html#3915275">m1</a></span><span class="op" id="3915369">.</span><span class="ident" id="3915370">raw</span><span class="op" id="3915373">)</span>&nbsp;<span class="op" id="3915375">&amp;&amp;</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3915380"><a href="/crypto/tls/handshake_messages.go.html#3915221">m</a></span><span class="op" id="3915381">.</span><span class="ident" id="3915382">hasSignatureAndHash</span>&nbsp;<span class="op" id="3915402">==</span>&nbsp;<span class="ident" id="3915405"><a href="/crypto/tls/handshake_messages.go.html#3915275">m1</a></span><span class="op" id="3915407">.</span><span class="ident" id="3915408">hasSignatureAndHash</span>&nbsp;<span class="op" id="3915428">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3915433"><a href="/crypto/tls/handshake_messages.go.html#3915221">m</a></span><span class="op" id="3915434">.</span><span class="ident" id="3915435">signatureAndHash</span><span class="op" id="3915451">.</span><span class="ident" id="3915452">hash</span>&nbsp;<span class="op" id="3915457">==</span>&nbsp;<span class="ident" id="3915460"><a href="/crypto/tls/handshake_messages.go.html#3915275">m1</a></span><span class="op" id="3915462">.</span><span class="ident" id="3915463">signatureAndHash</span><span class="op" id="3915479">.</span><span class="ident" id="3915480">hash</span>&nbsp;<span class="op" id="3915485">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3915490"><a href="/crypto/tls/handshake_messages.go.html#3915221">m</a></span><span class="op" id="3915491">.</span><span class="ident" id="3915492">signatureAndHash</span><span class="op" id="3915508">.</span><span class="ident" id="3915509">signature</span>&nbsp;<span class="op" id="3915519">==</span>&nbsp;<span class="ident" id="3915522"><a href="/crypto/tls/handshake_messages.go.html#3915275">m1</a></span><span class="op" id="3915524">.</span><span class="ident" id="3915525">signatureAndHash</span><span class="op" id="3915541">.</span><span class="ident" id="3915542">signature</span>&nbsp;<span class="op" id="3915552">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3915557"><a href="/crypto/tls/handshake_messages.go.html#3888584">bytes</a></span><span class="op" id="3915562">.</span><span class="ident" id="3915563">Equal</span><span class="op" id="3915568">(</span><span class="ident" id="3915569"><a href="/crypto/tls/handshake_messages.go.html#3915221">m</a></span><span class="op" id="3915570">.</span><span class="ident" id="3915571">signature</span><span class="op" id="3915580">,</span>&nbsp;<span class="ident" id="3915582"><a href="/crypto/tls/handshake_messages.go.html#3915275">m1</a></span><span class="op" id="3915584">.</span><span class="ident" id="3915585">signature</span><span class="op" id="3915594">)</span><br>
<span class="lineno"></span><span class="op" id="3915596">}</span><br>
<span class="lineno">1255</span><br>
<span class="lineno"></span><span class="keyword" id="3915599">func</span>&nbsp;<span class="op" id="3915604">(</span><span class="ident" id="3915605">m</span>&nbsp;<span class="op" id="3915607">*</span><span class="ident" id="3915608"><a href="/crypto/tls/handshake_messages.go.html#3915062">certificateVerifyMsg</a></span><span class="op" id="3915628">)</span>&nbsp;<span class="ident" id="3915630">marshal</span><span class="op" id="3915637">(</span><span class="op" id="3915638">)</span>&nbsp;<span class="op" id="3915640">(</span><span class="ident" id="3915641">x</span>&nbsp;<span class="op" id="3915643">[</span><span class="op" id="3915644">]</span><span class="builtintype" id="3915645">byte</span><span class="op" id="3915649">)</span>&nbsp;<span class="op" id="3915651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3915654">if</span>&nbsp;<span class="ident" id="3915657"><a href="/crypto/tls/handshake_messages.go.html#3915605">m</a></span><span class="op" id="3915658">.</span><span class="ident" id="3915659">raw</span>&nbsp;<span class="op" id="3915663">!=</span>&nbsp;<span class="ident" id="3915666">nil</span>&nbsp;<span class="op" id="3915670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3915674">return</span>&nbsp;<span class="ident" id="3915681"><a href="/crypto/tls/handshake_messages.go.html#3915605">m</a></span><span class="op" id="3915682">.</span><span class="ident" id="3915683">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3915688">}</span><br>
<span class="lineno">1260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3915692">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc4346#section-7.4.8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3915749">siglength</span>&nbsp;<span class="op" id="3915759">:=</span>&nbsp;<span class="builtinfunc" id="3915762">len</span><span class="op" id="3915765">(</span><span class="ident" id="3915766"><a href="/crypto/tls/handshake_messages.go.html#3915605">m</a></span><span class="op" id="3915767">.</span><span class="ident" id="3915768">signature</span><span class="op" id="3915777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3915780">length</span>&nbsp;<span class="op" id="3915787">:=</span>&nbsp;<span class="num" id="3915790">2</span>&nbsp;<span class="op" id="3915792">+</span>&nbsp;<span class="ident" id="3915794"><a href="/crypto/tls/handshake_messages.go.html#3915749">siglength</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3915805">if</span>&nbsp;<span class="ident" id="3915808"><a href="/crypto/tls/handshake_messages.go.html#3915605">m</a></span><span class="op" id="3915809">.</span><span class="ident" id="3915810">hasSignatureAndHash</span>&nbsp;<span class="op" id="3915830">{</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3915834"><a href="/crypto/tls/handshake_messages.go.html#3915780">length</a></span>&nbsp;<span class="op" id="3915841">+=</span>&nbsp;<span class="num" id="3915844">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3915847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3915850"><a href="/crypto/tls/handshake_messages.go.html#3915641">x</a></span>&nbsp;<span class="op" id="3915852">=</span>&nbsp;<span class="builtinfunc" id="3915854">make</span><span class="op" id="3915858">(</span><span class="op" id="3915859">[</span><span class="op" id="3915860">]</span><span class="builtintype" id="3915861">byte</span><span class="op" id="3915865">,</span>&nbsp;<span class="num" id="3915867">4</span><span class="op" id="3915868">+</span><span class="ident" id="3915869"><a href="/crypto/tls/handshake_messages.go.html#3915780">length</a></span><span class="op" id="3915875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3915878"><a href="/crypto/tls/handshake_messages.go.html#3915641">x</a></span><span class="op" id="3915879">[</span><span class="num" id="3915880">0</span><span class="op" id="3915881">]</span>&nbsp;<span class="op" id="3915883">=</span>&nbsp;<span class="ident" id="3915885"><a href="/crypto/tls/common.go.html#3823727">typeCertificateVerify</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3915908"><a href="/crypto/tls/handshake_messages.go.html#3915641">x</a></span><span class="op" id="3915909">[</span><span class="num" id="3915910">1</span><span class="op" id="3915911">]</span>&nbsp;<span class="op" id="3915913">=</span>&nbsp;<span class="builtintype" id="3915915">uint8</span><span class="op" id="3915920">(</span><span class="ident" id="3915921"><a href="/crypto/tls/handshake_messages.go.html#3915780">length</a></span>&nbsp;<span class="op" id="3915928">&gt;&gt;</span>&nbsp;<span class="num" id="3915931">16</span><span class="op" id="3915933">)</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3915936"><a href="/crypto/tls/handshake_messages.go.html#3915641">x</a></span><span class="op" id="3915937">[</span><span class="num" id="3915938">2</span><span class="op" id="3915939">]</span>&nbsp;<span class="op" id="3915941">=</span>&nbsp;<span class="builtintype" id="3915943">uint8</span><span class="op" id="3915948">(</span><span class="ident" id="3915949"><a href="/crypto/tls/handshake_messages.go.html#3915780">length</a></span>&nbsp;<span class="op" id="3915956">&gt;&gt;</span>&nbsp;<span class="num" id="3915959">8</span><span class="op" id="3915960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3915963"><a href="/crypto/tls/handshake_messages.go.html#3915641">x</a></span><span class="op" id="3915964">[</span><span class="num" id="3915965">3</span><span class="op" id="3915966">]</span>&nbsp;<span class="op" id="3915968">=</span>&nbsp;<span class="builtintype" id="3915970">uint8</span><span class="op" id="3915975">(</span><span class="ident" id="3915976"><a href="/crypto/tls/handshake_messages.go.html#3915780">length</a></span><span class="op" id="3915982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3915985">y</span>&nbsp;<span class="op" id="3915987">:=</span>&nbsp;<span class="ident" id="3915990"><a href="/crypto/tls/handshake_messages.go.html#3915641">x</a></span><span class="op" id="3915991">[</span><span class="num" id="3915992">4</span><span class="op" id="3915993">:</span><span class="op" id="3915994">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3915997">if</span>&nbsp;<span class="ident" id="3916000"><a href="/crypto/tls/handshake_messages.go.html#3915605">m</a></span><span class="op" id="3916001">.</span><span class="ident" id="3916002">hasSignatureAndHash</span>&nbsp;<span class="op" id="3916022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916026"><a href="/crypto/tls/handshake_messages.go.html#3915985">y</a></span><span class="op" id="3916027">[</span><span class="num" id="3916028">0</span><span class="op" id="3916029">]</span>&nbsp;<span class="op" id="3916031">=</span>&nbsp;<span class="ident" id="3916033"><a href="/crypto/tls/handshake_messages.go.html#3915605">m</a></span><span class="op" id="3916034">.</span><span class="ident" id="3916035">signatureAndHash</span><span class="op" id="3916051">.</span><span class="ident" id="3916052">hash</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916059"><a href="/crypto/tls/handshake_messages.go.html#3915985">y</a></span><span class="op" id="3916060">[</span><span class="num" id="3916061">1</span><span class="op" id="3916062">]</span>&nbsp;<span class="op" id="3916064">=</span>&nbsp;<span class="ident" id="3916066"><a href="/crypto/tls/handshake_messages.go.html#3915605">m</a></span><span class="op" id="3916067">.</span><span class="ident" id="3916068">signatureAndHash</span><span class="op" id="3916084">.</span><span class="ident" id="3916085">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916097"><a href="/crypto/tls/handshake_messages.go.html#3915985">y</a></span>&nbsp;<span class="op" id="3916099">=</span>&nbsp;<span class="ident" id="3916101"><a href="/crypto/tls/handshake_messages.go.html#3915985">y</a></span><span class="op" id="3916102">[</span><span class="num" id="3916103">2</span><span class="op" id="3916104">:</span><span class="op" id="3916105">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3916108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916111"><a href="/crypto/tls/handshake_messages.go.html#3915985">y</a></span><span class="op" id="3916112">[</span><span class="num" id="3916113">0</span><span class="op" id="3916114">]</span>&nbsp;<span class="op" id="3916116">=</span>&nbsp;<span class="builtintype" id="3916118">uint8</span><span class="op" id="3916123">(</span><span class="ident" id="3916124"><a href="/crypto/tls/handshake_messages.go.html#3915749">siglength</a></span>&nbsp;<span class="op" id="3916134">&gt;&gt;</span>&nbsp;<span class="num" id="3916137">8</span><span class="op" id="3916138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916141"><a href="/crypto/tls/handshake_messages.go.html#3915985">y</a></span><span class="op" id="3916142">[</span><span class="num" id="3916143">1</span><span class="op" id="3916144">]</span>&nbsp;<span class="op" id="3916146">=</span>&nbsp;<span class="builtintype" id="3916148">uint8</span><span class="op" id="3916153">(</span><span class="ident" id="3916154"><a href="/crypto/tls/handshake_messages.go.html#3915749">siglength</a></span><span class="op" id="3916163">)</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3916166">copy</span><span class="op" id="3916170">(</span><span class="ident" id="3916171"><a href="/crypto/tls/handshake_messages.go.html#3915985">y</a></span><span class="op" id="3916172">[</span><span class="num" id="3916173">2</span><span class="op" id="3916174">:</span><span class="op" id="3916175">]</span><span class="op" id="3916176">,</span>&nbsp;<span class="ident" id="3916178"><a href="/crypto/tls/handshake_messages.go.html#3915605">m</a></span><span class="op" id="3916179">.</span><span class="ident" id="3916180">signature</span><span class="op" id="3916189">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916193"><a href="/crypto/tls/handshake_messages.go.html#3915605">m</a></span><span class="op" id="3916194">.</span><span class="ident" id="3916195">raw</span>&nbsp;<span class="op" id="3916199">=</span>&nbsp;<span class="ident" id="3916201"><a href="/crypto/tls/handshake_messages.go.html#3915641">x</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3916205">return</span><br>
<span class="lineno">1285</span><span class="op" id="3916212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3916215">func</span>&nbsp;<span class="op" id="3916220">(</span><span class="ident" id="3916221">m</span>&nbsp;<span class="op" id="3916223">*</span><span class="ident" id="3916224"><a href="/crypto/tls/handshake_messages.go.html#3915062">certificateVerifyMsg</a></span><span class="op" id="3916244">)</span>&nbsp;<span class="ident" id="3916246">unmarshal</span><span class="op" id="3916255">(</span><span class="ident" id="3916256">data</span>&nbsp;<span class="op" id="3916261">[</span><span class="op" id="3916262">]</span><span class="builtintype" id="3916263">byte</span><span class="op" id="3916267">)</span>&nbsp;<span class="builtintype" id="3916269">bool</span>&nbsp;<span class="op" id="3916274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916277"><a href="/crypto/tls/handshake_messages.go.html#3916221">m</a></span><span class="op" id="3916278">.</span><span class="ident" id="3916279">raw</span>&nbsp;<span class="op" id="3916283">=</span>&nbsp;<span class="ident" id="3916285"><a href="/crypto/tls/handshake_messages.go.html#3916256">data</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3916292">if</span>&nbsp;<span class="builtinfunc" id="3916295">len</span><span class="op" id="3916298">(</span><span class="ident" id="3916299"><a href="/crypto/tls/handshake_messages.go.html#3916256">data</a></span><span class="op" id="3916303">)</span>&nbsp;<span class="op" id="3916305">&lt;</span>&nbsp;<span class="num" id="3916307">6</span>&nbsp;<span class="op" id="3916309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3916313">return</span>&nbsp;<span class="builtintype" id="3916320">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3916327">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916331">length</span>&nbsp;<span class="op" id="3916338">:=</span>&nbsp;<span class="builtintype" id="3916341">uint32</span><span class="op" id="3916347">(</span><span class="ident" id="3916348"><a href="/crypto/tls/handshake_messages.go.html#3916256">data</a></span><span class="op" id="3916352">[</span><span class="num" id="3916353">1</span><span class="op" id="3916354">]</span><span class="op" id="3916355">)</span><span class="op" id="3916356">&lt;&lt;</span><span class="num" id="3916358">16</span>&nbsp;<span class="op" id="3916361">|</span>&nbsp;<span class="builtintype" id="3916363">uint32</span><span class="op" id="3916369">(</span><span class="ident" id="3916370"><a href="/crypto/tls/handshake_messages.go.html#3916256">data</a></span><span class="op" id="3916374">[</span><span class="num" id="3916375">2</span><span class="op" id="3916376">]</span><span class="op" id="3916377">)</span><span class="op" id="3916378">&lt;&lt;</span><span class="num" id="3916380">8</span>&nbsp;<span class="op" id="3916382">|</span>&nbsp;<span class="builtintype" id="3916384">uint32</span><span class="op" id="3916390">(</span><span class="ident" id="3916391"><a href="/crypto/tls/handshake_messages.go.html#3916256">data</a></span><span class="op" id="3916395">[</span><span class="num" id="3916396">3</span><span class="op" id="3916397">]</span><span class="op" id="3916398">)</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3916401">if</span>&nbsp;<span class="builtintype" id="3916404">uint32</span><span class="op" id="3916410">(</span><span class="builtinfunc" id="3916411">len</span><span class="op" id="3916414">(</span><span class="ident" id="3916415"><a href="/crypto/tls/handshake_messages.go.html#3916256">data</a></span><span class="op" id="3916419">)</span><span class="op" id="3916420">)</span><span class="op" id="3916421">-</span><span class="num" id="3916422">4</span>&nbsp;<span class="op" id="3916424">!=</span>&nbsp;<span class="ident" id="3916427"><a href="/crypto/tls/handshake_messages.go.html#3916331">length</a></span>&nbsp;<span class="op" id="3916434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3916438">return</span>&nbsp;<span class="builtintype" id="3916445">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3916452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916456"><a href="/crypto/tls/handshake_messages.go.html#3916256">data</a></span>&nbsp;<span class="op" id="3916461">=</span>&nbsp;<span class="ident" id="3916463"><a href="/crypto/tls/handshake_messages.go.html#3916256">data</a></span><span class="op" id="3916467">[</span><span class="num" id="3916468">4</span><span class="op" id="3916469">:</span><span class="op" id="3916470">]</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3916473">if</span>&nbsp;<span class="ident" id="3916476"><a href="/crypto/tls/handshake_messages.go.html#3916221">m</a></span><span class="op" id="3916477">.</span><span class="ident" id="3916478">hasSignatureAndHash</span>&nbsp;<span class="op" id="3916498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916502"><a href="/crypto/tls/handshake_messages.go.html#3916221">m</a></span><span class="op" id="3916503">.</span><span class="ident" id="3916504">signatureAndHash</span><span class="op" id="3916520">.</span><span class="ident" id="3916521">hash</span>&nbsp;<span class="op" id="3916526">=</span>&nbsp;<span class="ident" id="3916528"><a href="/crypto/tls/handshake_messages.go.html#3916256">data</a></span><span class="op" id="3916532">[</span><span class="num" id="3916533">0</span><span class="op" id="3916534">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916538"><a href="/crypto/tls/handshake_messages.go.html#3916221">m</a></span><span class="op" id="3916539">.</span><span class="ident" id="3916540">signatureAndHash</span><span class="op" id="3916556">.</span><span class="ident" id="3916557">signature</span>&nbsp;<span class="op" id="3916567">=</span>&nbsp;<span class="ident" id="3916569"><a href="/crypto/tls/handshake_messages.go.html#3916256">data</a></span><span class="op" id="3916573">[</span><span class="num" id="3916574">1</span><span class="op" id="3916575">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916579"><a href="/crypto/tls/handshake_messages.go.html#3916256">data</a></span>&nbsp;<span class="op" id="3916584">=</span>&nbsp;<span class="ident" id="3916586"><a href="/crypto/tls/handshake_messages.go.html#3916256">data</a></span><span class="op" id="3916590">[</span><span class="num" id="3916591">2</span><span class="op" id="3916592">:</span><span class="op" id="3916593">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3916596">}</span><br>
<span class="lineno">1305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3916600">if</span>&nbsp;<span class="builtinfunc" id="3916603">len</span><span class="op" id="3916606">(</span><span class="ident" id="3916607"><a href="/crypto/tls/handshake_messages.go.html#3916256">data</a></span><span class="op" id="3916611">)</span>&nbsp;<span class="op" id="3916613">&lt;</span>&nbsp;<span class="num" id="3916615">2</span>&nbsp;<span class="op" id="3916617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3916621">return</span>&nbsp;<span class="builtintype" id="3916628">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3916635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916638">siglength</span>&nbsp;<span class="op" id="3916648">:=</span>&nbsp;<span class="builtintype" id="3916651">int</span><span class="op" id="3916654">(</span><span class="ident" id="3916655"><a href="/crypto/tls/handshake_messages.go.html#3916256">data</a></span><span class="op" id="3916659">[</span><span class="num" id="3916660">0</span><span class="op" id="3916661">]</span><span class="op" id="3916662">)</span><span class="op" id="3916663">&lt;&lt;</span><span class="num" id="3916665">8</span>&nbsp;<span class="op" id="3916667">+</span>&nbsp;<span class="builtintype" id="3916669">int</span><span class="op" id="3916672">(</span><span class="ident" id="3916673"><a href="/crypto/tls/handshake_messages.go.html#3916256">data</a></span><span class="op" id="3916677">[</span><span class="num" id="3916678">1</span><span class="op" id="3916679">]</span><span class="op" id="3916680">)</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916683"><a href="/crypto/tls/handshake_messages.go.html#3916256">data</a></span>&nbsp;<span class="op" id="3916688">=</span>&nbsp;<span class="ident" id="3916690"><a href="/crypto/tls/handshake_messages.go.html#3916256">data</a></span><span class="op" id="3916694">[</span><span class="num" id="3916695">2</span><span class="op" id="3916696">:</span><span class="op" id="3916697">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3916700">if</span>&nbsp;<span class="builtinfunc" id="3916703">len</span><span class="op" id="3916706">(</span><span class="ident" id="3916707"><a href="/crypto/tls/handshake_messages.go.html#3916256">data</a></span><span class="op" id="3916711">)</span>&nbsp;<span class="op" id="3916713">!=</span>&nbsp;<span class="ident" id="3916716"><a href="/crypto/tls/handshake_messages.go.html#3916638">siglength</a></span>&nbsp;<span class="op" id="3916726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3916730">return</span>&nbsp;<span class="builtintype" id="3916737">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3916744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916748"><a href="/crypto/tls/handshake_messages.go.html#3916221">m</a></span><span class="op" id="3916749">.</span><span class="ident" id="3916750">signature</span>&nbsp;<span class="op" id="3916760">=</span>&nbsp;<span class="ident" id="3916762"><a href="/crypto/tls/handshake_messages.go.html#3916256">data</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3916769">return</span>&nbsp;<span class="builtintype" id="3916776">true</span><br>
<span class="lineno"></span><span class="op" id="3916781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1320</span><span class="keyword" id="3916784">type</span>&nbsp;<span class="ident" id="3916789">newSessionTicketMsg</span>&nbsp;<span class="keyword" id="3916809">struct</span>&nbsp;<span class="op" id="3916816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916819">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3916826">[</span><span class="op" id="3916827">]</span><span class="builtintype" id="3916828">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916834">ticket</span>&nbsp;<span class="op" id="3916841">[</span><span class="op" id="3916842">]</span><span class="builtintype" id="3916843">byte</span><br>
<span class="lineno"></span><span class="op" id="3916848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1325</span><span class="keyword" id="3916851">func</span>&nbsp;<span class="op" id="3916856">(</span><span class="ident" id="3916857">m</span>&nbsp;<span class="op" id="3916859">*</span><span class="ident" id="3916860"><a href="/crypto/tls/handshake_messages.go.html#3916789">newSessionTicketMsg</a></span><span class="op" id="3916879">)</span>&nbsp;<span class="ident" id="3916881">equal</span><span class="op" id="3916886">(</span><span class="ident" id="3916887">i</span>&nbsp;<span class="keyword" id="3916889">interface</span><span class="op" id="3916898">{</span><span class="op" id="3916899">}</span><span class="op" id="3916900">)</span>&nbsp;<span class="builtintype" id="3916902">bool</span>&nbsp;<span class="op" id="3916907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3916910">m1</span><span class="op" id="3916912">,</span>&nbsp;<span class="ident" id="3916914">ok</span>&nbsp;<span class="op" id="3916917">:=</span>&nbsp;<span class="ident" id="3916920"><a href="/crypto/tls/handshake_messages.go.html#3916887">i</a></span><span class="op" id="3916921">.</span><span class="op" id="3916922">(</span><span class="op" id="3916923">*</span><span class="ident" id="3916924"><a href="/crypto/tls/handshake_messages.go.html#3916789">newSessionTicketMsg</a></span><span class="op" id="3916943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3916946">if</span>&nbsp;<span class="op" id="3916949">!</span><span class="ident" id="3916950"><a href="/crypto/tls/handshake_messages.go.html#3916914">ok</a></span>&nbsp;<span class="op" id="3916953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3916957">return</span>&nbsp;<span class="builtintype" id="3916964">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3916971">}</span><br>
<span class="lineno">1330</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3916975">return</span>&nbsp;<span class="ident" id="3916982"><a href="/crypto/tls/handshake_messages.go.html#3888584">bytes</a></span><span class="op" id="3916987">.</span><span class="ident" id="3916988">Equal</span><span class="op" id="3916993">(</span><span class="ident" id="3916994"><a href="/crypto/tls/handshake_messages.go.html#3916857">m</a></span><span class="op" id="3916995">.</span><span class="ident" id="3916996">raw</span><span class="op" id="3916999">,</span>&nbsp;<span class="ident" id="3917001"><a href="/crypto/tls/handshake_messages.go.html#3916910">m1</a></span><span class="op" id="3917003">.</span><span class="ident" id="3917004">raw</span><span class="op" id="3917007">)</span>&nbsp;<span class="op" id="3917009">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3917014"><a href="/crypto/tls/handshake_messages.go.html#3888584">bytes</a></span><span class="op" id="3917019">.</span><span class="ident" id="3917020">Equal</span><span class="op" id="3917025">(</span><span class="ident" id="3917026"><a href="/crypto/tls/handshake_messages.go.html#3916857">m</a></span><span class="op" id="3917027">.</span><span class="ident" id="3917028">ticket</span><span class="op" id="3917034">,</span>&nbsp;<span class="ident" id="3917036"><a href="/crypto/tls/handshake_messages.go.html#3916910">m1</a></span><span class="op" id="3917038">.</span><span class="ident" id="3917039">ticket</span><span class="op" id="3917045">)</span><br>
<span class="lineno"></span><span class="op" id="3917047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1335</span><span class="keyword" id="3917050">func</span>&nbsp;<span class="op" id="3917055">(</span><span class="ident" id="3917056">m</span>&nbsp;<span class="op" id="3917058">*</span><span class="ident" id="3917059"><a href="/crypto/tls/handshake_messages.go.html#3916789">newSessionTicketMsg</a></span><span class="op" id="3917078">)</span>&nbsp;<span class="ident" id="3917080">marshal</span><span class="op" id="3917087">(</span><span class="op" id="3917088">)</span>&nbsp;<span class="op" id="3917090">(</span><span class="ident" id="3917091">x</span>&nbsp;<span class="op" id="3917093">[</span><span class="op" id="3917094">]</span><span class="builtintype" id="3917095">byte</span><span class="op" id="3917099">)</span>&nbsp;<span class="op" id="3917101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3917104">if</span>&nbsp;<span class="ident" id="3917107"><a href="/crypto/tls/handshake_messages.go.html#3917056">m</a></span><span class="op" id="3917108">.</span><span class="ident" id="3917109">raw</span>&nbsp;<span class="op" id="3917113">!=</span>&nbsp;<span class="ident" id="3917116">nil</span>&nbsp;<span class="op" id="3917120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3917124">return</span>&nbsp;<span class="ident" id="3917131"><a href="/crypto/tls/handshake_messages.go.html#3917056">m</a></span><span class="op" id="3917132">.</span><span class="ident" id="3917133">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3917138">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3917142">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc5077#section-3.3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3917197">ticketLen</span>&nbsp;<span class="op" id="3917207">:=</span>&nbsp;<span class="builtinfunc" id="3917210">len</span><span class="op" id="3917213">(</span><span class="ident" id="3917214"><a href="/crypto/tls/handshake_messages.go.html#3917056">m</a></span><span class="op" id="3917215">.</span><span class="ident" id="3917216">ticket</span><span class="op" id="3917222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3917225">length</span>&nbsp;<span class="op" id="3917232">:=</span>&nbsp;<span class="num" id="3917235">2</span>&nbsp;<span class="op" id="3917237">+</span>&nbsp;<span class="num" id="3917239">4</span>&nbsp;<span class="op" id="3917241">+</span>&nbsp;<span class="ident" id="3917243"><a href="/crypto/tls/handshake_messages.go.html#3917197">ticketLen</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3917254"><a href="/crypto/tls/handshake_messages.go.html#3917091">x</a></span>&nbsp;<span class="op" id="3917256">=</span>&nbsp;<span class="builtinfunc" id="3917258">make</span><span class="op" id="3917262">(</span><span class="op" id="3917263">[</span><span class="op" id="3917264">]</span><span class="builtintype" id="3917265">byte</span><span class="op" id="3917269">,</span>&nbsp;<span class="num" id="3917271">4</span><span class="op" id="3917272">+</span><span class="ident" id="3917273"><a href="/crypto/tls/handshake_messages.go.html#3917225">length</a></span><span class="op" id="3917279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3917282"><a href="/crypto/tls/handshake_messages.go.html#3917091">x</a></span><span class="op" id="3917283">[</span><span class="num" id="3917284">0</span><span class="op" id="3917285">]</span>&nbsp;<span class="op" id="3917287">=</span>&nbsp;<span class="ident" id="3917289"><a href="/crypto/tls/common.go.html#3823553">typeNewSessionTicket</a></span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3917311"><a href="/crypto/tls/handshake_messages.go.html#3917091">x</a></span><span class="op" id="3917312">[</span><span class="num" id="3917313">1</span><span class="op" id="3917314">]</span>&nbsp;<span class="op" id="3917316">=</span>&nbsp;<span class="builtintype" id="3917318">uint8</span><span class="op" id="3917323">(</span><span class="ident" id="3917324"><a href="/crypto/tls/handshake_messages.go.html#3917225">length</a></span>&nbsp;<span class="op" id="3917331">&gt;&gt;</span>&nbsp;<span class="num" id="3917334">16</span><span class="op" id="3917336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3917339"><a href="/crypto/tls/handshake_messages.go.html#3917091">x</a></span><span class="op" id="3917340">[</span><span class="num" id="3917341">2</span><span class="op" id="3917342">]</span>&nbsp;<span class="op" id="3917344">=</span>&nbsp;<span class="builtintype" id="3917346">uint8</span><span class="op" id="3917351">(</span><span class="ident" id="3917352"><a href="/crypto/tls/handshake_messages.go.html#3917225">length</a></span>&nbsp;<span class="op" id="3917359">&gt;&gt;</span>&nbsp;<span class="num" id="3917362">8</span><span class="op" id="3917363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3917366"><a href="/crypto/tls/handshake_messages.go.html#3917091">x</a></span><span class="op" id="3917367">[</span><span class="num" id="3917368">3</span><span class="op" id="3917369">]</span>&nbsp;<span class="op" id="3917371">=</span>&nbsp;<span class="builtintype" id="3917373">uint8</span><span class="op" id="3917378">(</span><span class="ident" id="3917379"><a href="/crypto/tls/handshake_messages.go.html#3917225">length</a></span><span class="op" id="3917385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3917388"><a href="/crypto/tls/handshake_messages.go.html#3917091">x</a></span><span class="op" id="3917389">[</span><span class="num" id="3917390">8</span><span class="op" id="3917391">]</span>&nbsp;<span class="op" id="3917393">=</span>&nbsp;<span class="builtintype" id="3917395">uint8</span><span class="op" id="3917400">(</span><span class="ident" id="3917401"><a href="/crypto/tls/handshake_messages.go.html#3917197">ticketLen</a></span>&nbsp;<span class="op" id="3917411">&gt;&gt;</span>&nbsp;<span class="num" id="3917414">8</span><span class="op" id="3917415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3917418"><a href="/crypto/tls/handshake_messages.go.html#3917091">x</a></span><span class="op" id="3917419">[</span><span class="num" id="3917420">9</span><span class="op" id="3917421">]</span>&nbsp;<span class="op" id="3917423">=</span>&nbsp;<span class="builtintype" id="3917425">uint8</span><span class="op" id="3917430">(</span><span class="ident" id="3917431"><a href="/crypto/tls/handshake_messages.go.html#3917197">ticketLen</a></span><span class="op" id="3917440">)</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3917443">copy</span><span class="op" id="3917447">(</span><span class="ident" id="3917448"><a href="/crypto/tls/handshake_messages.go.html#3917091">x</a></span><span class="op" id="3917449">[</span><span class="num" id="3917450">10</span><span class="op" id="3917452">:</span><span class="op" id="3917453">]</span><span class="op" id="3917454">,</span>&nbsp;<span class="ident" id="3917456"><a href="/crypto/tls/handshake_messages.go.html#3917056">m</a></span><span class="op" id="3917457">.</span><span class="ident" id="3917458">ticket</span><span class="op" id="3917464">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3917468"><a href="/crypto/tls/handshake_messages.go.html#3917056">m</a></span><span class="op" id="3917469">.</span><span class="ident" id="3917470">raw</span>&nbsp;<span class="op" id="3917474">=</span>&nbsp;<span class="ident" id="3917476"><a href="/crypto/tls/handshake_messages.go.html#3917091">x</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3917480">return</span><br>
<span class="lineno">1355</span><span class="op" id="3917487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3917490">func</span>&nbsp;<span class="op" id="3917495">(</span><span class="ident" id="3917496">m</span>&nbsp;<span class="op" id="3917498">*</span><span class="ident" id="3917499"><a href="/crypto/tls/handshake_messages.go.html#3916789">newSessionTicketMsg</a></span><span class="op" id="3917518">)</span>&nbsp;<span class="ident" id="3917520">unmarshal</span><span class="op" id="3917529">(</span><span class="ident" id="3917530">data</span>&nbsp;<span class="op" id="3917535">[</span><span class="op" id="3917536">]</span><span class="builtintype" id="3917537">byte</span><span class="op" id="3917541">)</span>&nbsp;<span class="builtintype" id="3917543">bool</span>&nbsp;<span class="op" id="3917548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3917551"><a href="/crypto/tls/handshake_messages.go.html#3917496">m</a></span><span class="op" id="3917552">.</span><span class="ident" id="3917553">raw</span>&nbsp;<span class="op" id="3917557">=</span>&nbsp;<span class="ident" id="3917559"><a href="/crypto/tls/handshake_messages.go.html#3917530">data</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3917566">if</span>&nbsp;<span class="builtinfunc" id="3917569">len</span><span class="op" id="3917572">(</span><span class="ident" id="3917573"><a href="/crypto/tls/handshake_messages.go.html#3917530">data</a></span><span class="op" id="3917577">)</span>&nbsp;<span class="op" id="3917579">&lt;</span>&nbsp;<span class="num" id="3917581">10</span>&nbsp;<span class="op" id="3917584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3917588">return</span>&nbsp;<span class="builtintype" id="3917595">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3917602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3917606">length</span>&nbsp;<span class="op" id="3917613">:=</span>&nbsp;<span class="builtintype" id="3917616">uint32</span><span class="op" id="3917622">(</span><span class="ident" id="3917623"><a href="/crypto/tls/handshake_messages.go.html#3917530">data</a></span><span class="op" id="3917627">[</span><span class="num" id="3917628">1</span><span class="op" id="3917629">]</span><span class="op" id="3917630">)</span><span class="op" id="3917631">&lt;&lt;</span><span class="num" id="3917633">16</span>&nbsp;<span class="op" id="3917636">|</span>&nbsp;<span class="builtintype" id="3917638">uint32</span><span class="op" id="3917644">(</span><span class="ident" id="3917645"><a href="/crypto/tls/handshake_messages.go.html#3917530">data</a></span><span class="op" id="3917649">[</span><span class="num" id="3917650">2</span><span class="op" id="3917651">]</span><span class="op" id="3917652">)</span><span class="op" id="3917653">&lt;&lt;</span><span class="num" id="3917655">8</span>&nbsp;<span class="op" id="3917657">|</span>&nbsp;<span class="builtintype" id="3917659">uint32</span><span class="op" id="3917665">(</span><span class="ident" id="3917666"><a href="/crypto/tls/handshake_messages.go.html#3917530">data</a></span><span class="op" id="3917670">[</span><span class="num" id="3917671">3</span><span class="op" id="3917672">]</span><span class="op" id="3917673">)</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3917676">if</span>&nbsp;<span class="builtintype" id="3917679">uint32</span><span class="op" id="3917685">(</span><span class="builtinfunc" id="3917686">len</span><span class="op" id="3917689">(</span><span class="ident" id="3917690"><a href="/crypto/tls/handshake_messages.go.html#3917530">data</a></span><span class="op" id="3917694">)</span><span class="op" id="3917695">)</span><span class="op" id="3917696">-</span><span class="num" id="3917697">4</span>&nbsp;<span class="op" id="3917699">!=</span>&nbsp;<span class="ident" id="3917702"><a href="/crypto/tls/handshake_messages.go.html#3917606">length</a></span>&nbsp;<span class="op" id="3917709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3917713">return</span>&nbsp;<span class="builtintype" id="3917720">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3917727">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3917731">ticketLen</span>&nbsp;<span class="op" id="3917741">:=</span>&nbsp;<span class="builtintype" id="3917744">int</span><span class="op" id="3917747">(</span><span class="ident" id="3917748"><a href="/crypto/tls/handshake_messages.go.html#3917530">data</a></span><span class="op" id="3917752">[</span><span class="num" id="3917753">8</span><span class="op" id="3917754">]</span><span class="op" id="3917755">)</span><span class="op" id="3917756">&lt;&lt;</span><span class="num" id="3917758">8</span>&nbsp;<span class="op" id="3917760">+</span>&nbsp;<span class="builtintype" id="3917762">int</span><span class="op" id="3917765">(</span><span class="ident" id="3917766"><a href="/crypto/tls/handshake_messages.go.html#3917530">data</a></span><span class="op" id="3917770">[</span><span class="num" id="3917771">9</span><span class="op" id="3917772">]</span><span class="op" id="3917773">)</span><br>
<span class="lineno">1370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3917776">if</span>&nbsp;<span class="builtinfunc" id="3917779">len</span><span class="op" id="3917782">(</span><span class="ident" id="3917783"><a href="/crypto/tls/handshake_messages.go.html#3917530">data</a></span><span class="op" id="3917787">)</span><span class="op" id="3917788">-</span><span class="num" id="3917789">10</span>&nbsp;<span class="op" id="3917792">!=</span>&nbsp;<span class="ident" id="3917795"><a href="/crypto/tls/handshake_messages.go.html#3917731">ticketLen</a></span>&nbsp;<span class="op" id="3917805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3917809">return</span>&nbsp;<span class="builtintype" id="3917816">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3917823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3917827"><a href="/crypto/tls/handshake_messages.go.html#3917496">m</a></span><span class="op" id="3917828">.</span><span class="ident" id="3917829">ticket</span>&nbsp;<span class="op" id="3917836">=</span>&nbsp;<span class="ident" id="3917838"><a href="/crypto/tls/handshake_messages.go.html#3917530">data</a></span><span class="op" id="3917842">[</span><span class="num" id="3917843">10</span><span class="op" id="3917845">:</span><span class="op" id="3917846">]</span><br>
<span class="lineno">1375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3917850">return</span>&nbsp;<span class="builtintype" id="3917857">true</span><br>
<span class="lineno"></span><span class="op" id="3917862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3917865">func</span>&nbsp;<span class="ident" id="3917870">eqUint16s</span><span class="op" id="3917879">(</span><span class="ident" id="3917880">x</span><span class="op" id="3917881">,</span>&nbsp;<span class="ident" id="3917883">y</span>&nbsp;<span class="op" id="3917885">[</span><span class="op" id="3917886">]</span><span class="builtintype" id="3917887">uint16</span><span class="op" id="3917893">)</span>&nbsp;<span class="builtintype" id="3917895">bool</span>&nbsp;<span class="op" id="3917900">{</span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3917903">if</span>&nbsp;<span class="builtinfunc" id="3917906">len</span><span class="op" id="3917909">(</span><span class="ident" id="3917910"><a href="/crypto/tls/handshake_messages.go.html#3917880">x</a></span><span class="op" id="3917911">)</span>&nbsp;<span class="op" id="3917913">!=</span>&nbsp;<span class="builtinfunc" id="3917916">len</span><span class="op" id="3917919">(</span><span class="ident" id="3917920"><a href="/crypto/tls/handshake_messages.go.html#3917883">y</a></span><span class="op" id="3917921">)</span>&nbsp;<span class="op" id="3917923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3917927">return</span>&nbsp;<span class="builtintype" id="3917934">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3917941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3917944">for</span>&nbsp;<span class="ident" id="3917948">i</span><span class="op" id="3917949">,</span>&nbsp;<span class="ident" id="3917951">v</span>&nbsp;<span class="op" id="3917953">:=</span>&nbsp;<span class="keyword" id="3917956">range</span>&nbsp;<span class="ident" id="3917962"><a href="/crypto/tls/handshake_messages.go.html#3917880">x</a></span>&nbsp;<span class="op" id="3917964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3917968">if</span>&nbsp;<span class="ident" id="3917971"><a href="/crypto/tls/handshake_messages.go.html#3917883">y</a></span><span class="op" id="3917972">[</span><span class="ident" id="3917973"><a href="/crypto/tls/handshake_messages.go.html#3917948">i</a></span><span class="op" id="3917974">]</span>&nbsp;<span class="op" id="3917976">!=</span>&nbsp;<span class="ident" id="3917979"><a href="/crypto/tls/handshake_messages.go.html#3917951">v</a></span>&nbsp;<span class="op" id="3917981">{</span><br>
<span class="lineno">1385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3917986">return</span>&nbsp;<span class="builtintype" id="3917993">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3918001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3918004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918007">return</span>&nbsp;<span class="builtintype" id="3918014">true</span><br>
<span class="lineno"></span><span class="op" id="3918019">}</span><br>
<span class="lineno">1390</span><br>
<span class="lineno"></span><span class="keyword" id="3918022">func</span>&nbsp;<span class="ident" id="3918027">eqCurveIDs</span><span class="op" id="3918037">(</span><span class="ident" id="3918038">x</span><span class="op" id="3918039">,</span>&nbsp;<span class="ident" id="3918041">y</span>&nbsp;<span class="op" id="3918043">[</span><span class="op" id="3918044">]</span><span class="ident" id="3918045"><a href="/crypto/tls/common.go.html#3824673">CurveID</a></span><span class="op" id="3918052">)</span>&nbsp;<span class="builtintype" id="3918054">bool</span>&nbsp;<span class="op" id="3918059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918062">if</span>&nbsp;<span class="builtinfunc" id="3918065">len</span><span class="op" id="3918068">(</span><span class="ident" id="3918069"><a href="/crypto/tls/handshake_messages.go.html#3918038">x</a></span><span class="op" id="3918070">)</span>&nbsp;<span class="op" id="3918072">!=</span>&nbsp;<span class="builtinfunc" id="3918075">len</span><span class="op" id="3918078">(</span><span class="ident" id="3918079"><a href="/crypto/tls/handshake_messages.go.html#3918041">y</a></span><span class="op" id="3918080">)</span>&nbsp;<span class="op" id="3918082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918086">return</span>&nbsp;<span class="builtintype" id="3918093">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3918100">}</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918103">for</span>&nbsp;<span class="ident" id="3918107">i</span><span class="op" id="3918108">,</span>&nbsp;<span class="ident" id="3918110">v</span>&nbsp;<span class="op" id="3918112">:=</span>&nbsp;<span class="keyword" id="3918115">range</span>&nbsp;<span class="ident" id="3918121"><a href="/crypto/tls/handshake_messages.go.html#3918038">x</a></span>&nbsp;<span class="op" id="3918123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918127">if</span>&nbsp;<span class="ident" id="3918130"><a href="/crypto/tls/handshake_messages.go.html#3918041">y</a></span><span class="op" id="3918131">[</span><span class="ident" id="3918132"><a href="/crypto/tls/handshake_messages.go.html#3918107">i</a></span><span class="op" id="3918133">]</span>&nbsp;<span class="op" id="3918135">!=</span>&nbsp;<span class="ident" id="3918138"><a href="/crypto/tls/handshake_messages.go.html#3918110">v</a></span>&nbsp;<span class="op" id="3918140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918145">return</span>&nbsp;<span class="builtintype" id="3918152">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3918160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3918163">}</span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918166">return</span>&nbsp;<span class="builtintype" id="3918173">true</span><br>
<span class="lineno"></span><span class="op" id="3918178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3918181">func</span>&nbsp;<span class="ident" id="3918186">eqStrings</span><span class="op" id="3918195">(</span><span class="ident" id="3918196">x</span><span class="op" id="3918197">,</span>&nbsp;<span class="ident" id="3918199">y</span>&nbsp;<span class="op" id="3918201">[</span><span class="op" id="3918202">]</span><span class="builtintype" id="3918203">string</span><span class="op" id="3918209">)</span>&nbsp;<span class="builtintype" id="3918211">bool</span>&nbsp;<span class="op" id="3918216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918219">if</span>&nbsp;<span class="builtinfunc" id="3918222">len</span><span class="op" id="3918225">(</span><span class="ident" id="3918226"><a href="/crypto/tls/handshake_messages.go.html#3918196">x</a></span><span class="op" id="3918227">)</span>&nbsp;<span class="op" id="3918229">!=</span>&nbsp;<span class="builtinfunc" id="3918232">len</span><span class="op" id="3918235">(</span><span class="ident" id="3918236"><a href="/crypto/tls/handshake_messages.go.html#3918199">y</a></span><span class="op" id="3918237">)</span>&nbsp;<span class="op" id="3918239">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918243">return</span>&nbsp;<span class="builtintype" id="3918250">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3918257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918260">for</span>&nbsp;<span class="ident" id="3918264">i</span><span class="op" id="3918265">,</span>&nbsp;<span class="ident" id="3918267">v</span>&nbsp;<span class="op" id="3918269">:=</span>&nbsp;<span class="keyword" id="3918272">range</span>&nbsp;<span class="ident" id="3918278"><a href="/crypto/tls/handshake_messages.go.html#3918196">x</a></span>&nbsp;<span class="op" id="3918280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918284">if</span>&nbsp;<span class="ident" id="3918287"><a href="/crypto/tls/handshake_messages.go.html#3918199">y</a></span><span class="op" id="3918288">[</span><span class="ident" id="3918289"><a href="/crypto/tls/handshake_messages.go.html#3918264">i</a></span><span class="op" id="3918290">]</span>&nbsp;<span class="op" id="3918292">!=</span>&nbsp;<span class="ident" id="3918295"><a href="/crypto/tls/handshake_messages.go.html#3918267">v</a></span>&nbsp;<span class="op" id="3918297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918302">return</span>&nbsp;<span class="builtintype" id="3918309">false</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3918317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3918320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918323">return</span>&nbsp;<span class="builtintype" id="3918330">true</span><br>
<span class="lineno"></span><span class="op" id="3918335">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1415</span><span class="keyword" id="3918338">func</span>&nbsp;<span class="ident" id="3918343">eqByteSlices</span><span class="op" id="3918355">(</span><span class="ident" id="3918356">x</span><span class="op" id="3918357">,</span>&nbsp;<span class="ident" id="3918359">y</span>&nbsp;<span class="op" id="3918361">[</span><span class="op" id="3918362">]</span><span class="op" id="3918363">[</span><span class="op" id="3918364">]</span><span class="builtintype" id="3918365">byte</span><span class="op" id="3918369">)</span>&nbsp;<span class="builtintype" id="3918371">bool</span>&nbsp;<span class="op" id="3918376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918379">if</span>&nbsp;<span class="builtinfunc" id="3918382">len</span><span class="op" id="3918385">(</span><span class="ident" id="3918386"><a href="/crypto/tls/handshake_messages.go.html#3918356">x</a></span><span class="op" id="3918387">)</span>&nbsp;<span class="op" id="3918389">!=</span>&nbsp;<span class="builtinfunc" id="3918392">len</span><span class="op" id="3918395">(</span><span class="ident" id="3918396"><a href="/crypto/tls/handshake_messages.go.html#3918359">y</a></span><span class="op" id="3918397">)</span>&nbsp;<span class="op" id="3918399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918403">return</span>&nbsp;<span class="builtintype" id="3918410">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3918417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918420">for</span>&nbsp;<span class="ident" id="3918424">i</span><span class="op" id="3918425">,</span>&nbsp;<span class="ident" id="3918427">v</span>&nbsp;<span class="op" id="3918429">:=</span>&nbsp;<span class="keyword" id="3918432">range</span>&nbsp;<span class="ident" id="3918438"><a href="/crypto/tls/handshake_messages.go.html#3918356">x</a></span>&nbsp;<span class="op" id="3918440">{</span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918444">if</span>&nbsp;<span class="op" id="3918447">!</span><span class="ident" id="3918448"><a href="/crypto/tls/handshake_messages.go.html#3888584">bytes</a></span><span class="op" id="3918453">.</span><span class="ident" id="3918454">Equal</span><span class="op" id="3918459">(</span><span class="ident" id="3918460"><a href="/crypto/tls/handshake_messages.go.html#3918427">v</a></span><span class="op" id="3918461">,</span>&nbsp;<span class="ident" id="3918463"><a href="/crypto/tls/handshake_messages.go.html#3918359">y</a></span><span class="op" id="3918464">[</span><span class="ident" id="3918465"><a href="/crypto/tls/handshake_messages.go.html#3918424">i</a></span><span class="op" id="3918466">]</span><span class="op" id="3918467">)</span>&nbsp;<span class="op" id="3918469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918474">return</span>&nbsp;<span class="builtintype" id="3918481">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3918489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3918492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918495">return</span>&nbsp;<span class="builtintype" id="3918502">true</span><br>
<span class="lineno">1425</span><span class="op" id="3918507">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3918510">func</span>&nbsp;<span class="ident" id="3918515">eqSignatureAndHashes</span><span class="op" id="3918535">(</span><span class="ident" id="3918536">x</span><span class="op" id="3918537">,</span>&nbsp;<span class="ident" id="3918539">y</span>&nbsp;<span class="op" id="3918541">[</span><span class="op" id="3918542">]</span><span class="ident" id="3918543"><a href="/crypto/tls/common.go.html#3826090">signatureAndHash</a></span><span class="op" id="3918559">)</span>&nbsp;<span class="builtintype" id="3918561">bool</span>&nbsp;<span class="op" id="3918566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918569">if</span>&nbsp;<span class="builtinfunc" id="3918572">len</span><span class="op" id="3918575">(</span><span class="ident" id="3918576"><a href="/crypto/tls/handshake_messages.go.html#3918536">x</a></span><span class="op" id="3918577">)</span>&nbsp;<span class="op" id="3918579">!=</span>&nbsp;<span class="builtinfunc" id="3918582">len</span><span class="op" id="3918585">(</span><span class="ident" id="3918586"><a href="/crypto/tls/handshake_messages.go.html#3918539">y</a></span><span class="op" id="3918587">)</span>&nbsp;<span class="op" id="3918589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918593">return</span>&nbsp;<span class="builtintype" id="3918600">false</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3918607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918610">for</span>&nbsp;<span class="ident" id="3918614">i</span><span class="op" id="3918615">,</span>&nbsp;<span class="ident" id="3918617">v</span>&nbsp;<span class="op" id="3918619">:=</span>&nbsp;<span class="keyword" id="3918622">range</span>&nbsp;<span class="ident" id="3918628"><a href="/crypto/tls/handshake_messages.go.html#3918536">x</a></span>&nbsp;<span class="op" id="3918630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3918634">v2</span>&nbsp;<span class="op" id="3918637">:=</span>&nbsp;<span class="ident" id="3918640"><a href="/crypto/tls/handshake_messages.go.html#3918539">y</a></span><span class="op" id="3918641">[</span><span class="ident" id="3918642"><a href="/crypto/tls/handshake_messages.go.html#3918614">i</a></span><span class="op" id="3918643">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918647">if</span>&nbsp;<span class="ident" id="3918650"><a href="/crypto/tls/handshake_messages.go.html#3918617">v</a></span><span class="op" id="3918651">.</span><span class="ident" id="3918652">hash</span>&nbsp;<span class="op" id="3918657">!=</span>&nbsp;<span class="ident" id="3918660"><a href="/crypto/tls/handshake_messages.go.html#3918634">v2</a></span><span class="op" id="3918662">.</span><span class="ident" id="3918663">hash</span>&nbsp;<span class="op" id="3918668">||</span>&nbsp;<span class="ident" id="3918671"><a href="/crypto/tls/handshake_messages.go.html#3918617">v</a></span><span class="op" id="3918672">.</span><span class="ident" id="3918673">signature</span>&nbsp;<span class="op" id="3918683">!=</span>&nbsp;<span class="ident" id="3918686"><a href="/crypto/tls/handshake_messages.go.html#3918634">v2</a></span><span class="op" id="3918688">.</span><span class="ident" id="3918689">signature</span>&nbsp;<span class="op" id="3918699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918704">return</span>&nbsp;<span class="builtintype" id="3918711">false</span><br>
<span class="lineno">1435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3918719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3918722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3918725">return</span>&nbsp;<span class="builtintype" id="3918732">true</span><br>
<span class="lineno"></span><span class="op" id="3918737">}</span>
</div>
</body>
</html>
