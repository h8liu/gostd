<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime/multipart</h2>
<ul>
<li><a href="/gostd/mime/multipart/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/mime/multipart/formdata.go.html">formdata.go</a></li>
<li><a href="/gostd/mime/multipart/formdata_test.go.html">formdata_test.go</a></li>
<li><a href="/gostd/mime/multipart/multipart.go.html" class="current">multipart.go</a></li>
<li><a href="/gostd/mime/multipart/multipart_test.go.html">multipart_test.go</a></li>
<li><a href="/gostd/mime/multipart/quotedprintable.go.html">quotedprintable.go</a></li>
<li><a href="/gostd/mime/multipart/quotedprintable_test.go.html">quotedprintable_test.go</a></li>
<li><a href="/gostd/mime/multipart/writer.go.html">writer.go</a></li>
<li><a href="/gostd/mime/multipart/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4310915">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4310970">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4311024">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="4311074">//</span><br>
<span class="lineno">5</span><br>
<span class="lineno"></span><span class="comment" id="4311078">/*<br>
<span class="lineno"></span>Package&nbsp;multipart&nbsp;implements&nbsp;MIME&nbsp;multipart&nbsp;parsing,&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC<br>
<span class="lineno"></span>2046.<br>
<span class="lineno"></span><br>
<span class="lineno">10</span>The&nbsp;implementation&nbsp;is&nbsp;sufficient&nbsp;for&nbsp;HTTP&nbsp;(RFC&nbsp;2388)&nbsp;and&nbsp;the&nbsp;multipart<br>
<span class="lineno"></span>bodies&nbsp;generated&nbsp;by&nbsp;popular&nbsp;browsers.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno"></span><span class="keyword" id="4311271">package</span>&nbsp;<span class="ident" id="4311279">multipart</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="4311290">import</span>&nbsp;<span class="op" id="4311297">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4311300">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4311309">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4311318">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4311325">&#34;io&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4311331">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4311344">&#34;mime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4311352">&#34;net/textproto&#34;</span><br>
<span class="lineno"></span><span class="op" id="4311368">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="4311371">var</span>&nbsp;<span class="ident" id="4311375">emptyParams</span>&nbsp;<span class="op" id="4311387">=</span>&nbsp;<span class="builtinfunc" id="4311389">make</span><span class="op" id="4311393">(</span><span class="keyword" id="4311394">map</span><span class="op" id="4311397">[</span><span class="builtintype" id="4311398">string</span><span class="op" id="4311404">]</span><span class="builtintype" id="4311405">string</span><span class="op" id="4311411">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4311414">//&nbsp;A&nbsp;Part&nbsp;represents&nbsp;a&nbsp;single&nbsp;part&nbsp;in&nbsp;a&nbsp;multipart&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="4311470">type</span>&nbsp;<span class="ident" id="4311475">Part</span>&nbsp;<span class="keyword" id="4311480">struct</span>&nbsp;<span class="op" id="4311487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4311490">//&nbsp;The&nbsp;headers&nbsp;of&nbsp;the&nbsp;body,&nbsp;if&nbsp;any,&nbsp;with&nbsp;the&nbsp;keys&nbsp;canonicalized</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4311555">//&nbsp;in&nbsp;the&nbsp;same&nbsp;fashion&nbsp;that&nbsp;the&nbsp;Go&nbsp;http.Request&nbsp;headers&nbsp;are.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4311617">//&nbsp;For&nbsp;example,&nbsp;&#34;foo-bar&#34;&nbsp;changes&nbsp;case&nbsp;to&nbsp;&#34;Foo-Bar&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4311670">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4311674">//&nbsp;As&nbsp;a&nbsp;special&nbsp;case,&nbsp;if&nbsp;the&nbsp;&#34;Content-Transfer-Encoding&#34;&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4311739">//&nbsp;has&nbsp;a&nbsp;value&nbsp;of&nbsp;&#34;quoted-printable&#34;,&nbsp;that&nbsp;header&nbsp;is&nbsp;instead</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4311801">//&nbsp;hidden&nbsp;from&nbsp;this&nbsp;map&nbsp;and&nbsp;the&nbsp;body&nbsp;is&nbsp;transparently&nbsp;decoded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4311864">//&nbsp;during&nbsp;Read&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4311887">Header</span>&nbsp;<span class="ident" id="4311894"><a href="/gostd/mime/multipart/multipart.go.html#4311352">textproto</a></span><span class="op" id="4311903">.</span><span class="ident" id="4311904"><a href="/gostd/net/textproto/header.go.html#4328626">MIMEHeader</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4311917">buffer</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4311927">*</span><span class="ident" id="4311928"><a href="/gostd/mime/multipart/multipart.go.html#4311309">bytes</a></span><span class="op" id="4311933">.</span><span class="ident" id="4311934"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4311942">mr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4311952">*</span><span class="ident" id="4311953"><a href="/gostd/mime/multipart/multipart.go.html#4316630">Reader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4311961">bytesRead</span>&nbsp;<span class="builtintype" id="4311971">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4311977">disposition</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4311995">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4312003">dispositionParams</span>&nbsp;<span class="keyword" id="4312021">map</span><span class="op" id="4312024">[</span><span class="builtintype" id="4312025">string</span><span class="op" id="4312031">]</span><span class="builtintype" id="4312032">string</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4312041">//&nbsp;r&nbsp;is&nbsp;either&nbsp;a&nbsp;reader&nbsp;directly&nbsp;reading&nbsp;from&nbsp;mr,&nbsp;or&nbsp;it&#39;s&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4312102">//&nbsp;wrapper&nbsp;around&nbsp;such&nbsp;a&nbsp;reader,&nbsp;decoding&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4312149">//&nbsp;Content-Transfer-Encoding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4312179">r</span>&nbsp;<span class="ident" id="4312181"><a href="/gostd/mime/multipart/multipart.go.html#4311325">io</a></span><span class="op" id="4312183">.</span><span class="ident" id="4312184"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><br>
<span class="lineno">50</span><span class="op" id="4312191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4312194">//&nbsp;FormName&nbsp;returns&nbsp;the&nbsp;name&nbsp;parameter&nbsp;if&nbsp;p&nbsp;has&nbsp;a&nbsp;Content-Disposition</span><br>
<span class="lineno"></span><span class="comment" id="4312264">//&nbsp;of&nbsp;type&nbsp;&#34;form-data&#34;.&nbsp;&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="4312328">func</span>&nbsp;<span class="op" id="4312333">(</span><span class="ident" id="4312334">p</span>&nbsp;<span class="op" id="4312336">*</span><span class="ident" id="4312337"><a href="/gostd/mime/multipart/multipart.go.html#4311475">Part</a></span><span class="op" id="4312341">)</span>&nbsp;<span class="ident" id="4312343">FormName</span><span class="op" id="4312351">(</span><span class="op" id="4312352">)</span>&nbsp;<span class="builtintype" id="4312354">string</span>&nbsp;<span class="op" id="4312361">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4312364">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc2183&nbsp;section&nbsp;2&nbsp;for&nbsp;EBNF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4312426">//&nbsp;of&nbsp;Content-Disposition&nbsp;value&nbsp;format.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4312467">if</span>&nbsp;<span class="ident" id="4312470"><a href="/gostd/mime/multipart/multipart.go.html#4312334">p</a></span><span class="op" id="4312471">.</span><span class="ident" id="4312472"><a href="/gostd/mime/multipart/multipart.go.html#4312003">dispositionParams</a></span>&nbsp;<span class="op" id="4312490">==</span>&nbsp;<span class="builtintype" id="4312493">nil</span>&nbsp;<span class="op" id="4312497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4312501"><a href="/gostd/mime/multipart/multipart.go.html#4312334">p</a></span><span class="op" id="4312502">.</span><span class="ident" id="4312503"><a href="/gostd/mime/multipart/multipart.go.html#4312868">parseContentDisposition</a></span><span class="op" id="4312526">(</span><span class="op" id="4312527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4312530">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4312533">if</span>&nbsp;<span class="ident" id="4312536"><a href="/gostd/mime/multipart/multipart.go.html#4312334">p</a></span><span class="op" id="4312537">.</span><span class="ident" id="4312538"><a href="/gostd/mime/multipart/multipart.go.html#4311977">disposition</a></span>&nbsp;<span class="op" id="4312550">!=</span>&nbsp;<span class="string" id="4312553">&#34;form-data&#34;</span>&nbsp;<span class="op" id="4312565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4312569">return</span>&nbsp;<span class="string" id="4312576">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4312580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4312583">return</span>&nbsp;<span class="ident" id="4312590"><a href="/gostd/mime/multipart/multipart.go.html#4312334">p</a></span><span class="op" id="4312591">.</span><span class="ident" id="4312592"><a href="/gostd/mime/multipart/multipart.go.html#4312003">dispositionParams</a></span><span class="op" id="4312609">[</span><span class="string" id="4312610">&#34;name&#34;</span><span class="op" id="4312616">]</span><br>
<span class="lineno"></span><span class="op" id="4312618">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="4312621">//&nbsp;FileName&nbsp;returns&nbsp;the&nbsp;filename&nbsp;parameter&nbsp;of&nbsp;the&nbsp;Part&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="4312678">//&nbsp;Content-Disposition&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="4312709">func</span>&nbsp;<span class="op" id="4312714">(</span><span class="ident" id="4312715">p</span>&nbsp;<span class="op" id="4312717">*</span><span class="ident" id="4312718"><a href="/gostd/mime/multipart/multipart.go.html#4311475">Part</a></span><span class="op" id="4312722">)</span>&nbsp;<span class="ident" id="4312724">FileName</span><span class="op" id="4312732">(</span><span class="op" id="4312733">)</span>&nbsp;<span class="builtintype" id="4312735">string</span>&nbsp;<span class="op" id="4312742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4312745">if</span>&nbsp;<span class="ident" id="4312748"><a href="/gostd/mime/multipart/multipart.go.html#4312715">p</a></span><span class="op" id="4312749">.</span><span class="ident" id="4312750"><a href="/gostd/mime/multipart/multipart.go.html#4312003">dispositionParams</a></span>&nbsp;<span class="op" id="4312768">==</span>&nbsp;<span class="builtintype" id="4312771">nil</span>&nbsp;<span class="op" id="4312775">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4312779"><a href="/gostd/mime/multipart/multipart.go.html#4312715">p</a></span><span class="op" id="4312780">.</span><span class="ident" id="4312781"><a href="/gostd/mime/multipart/multipart.go.html#4312868">parseContentDisposition</a></span><span class="op" id="4312804">(</span><span class="op" id="4312805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4312808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4312811">return</span>&nbsp;<span class="ident" id="4312818"><a href="/gostd/mime/multipart/multipart.go.html#4312715">p</a></span><span class="op" id="4312819">.</span><span class="ident" id="4312820"><a href="/gostd/mime/multipart/multipart.go.html#4312003">dispositionParams</a></span><span class="op" id="4312837">[</span><span class="string" id="4312838">&#34;filename&#34;</span><span class="op" id="4312848">]</span><br>
<span class="lineno"></span><span class="op" id="4312850">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="4312853">func</span>&nbsp;<span class="op" id="4312858">(</span><span class="ident" id="4312859">p</span>&nbsp;<span class="op" id="4312861">*</span><span class="ident" id="4312862"><a href="/gostd/mime/multipart/multipart.go.html#4311475">Part</a></span><span class="op" id="4312866">)</span>&nbsp;<span class="ident" id="4312868">parseContentDisposition</span><span class="op" id="4312891">(</span><span class="op" id="4312892">)</span>&nbsp;<span class="op" id="4312894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4312897">v</span>&nbsp;<span class="op" id="4312899">:=</span>&nbsp;<span class="ident" id="4312902"><a href="/gostd/mime/multipart/multipart.go.html#4312859">p</a></span><span class="op" id="4312903">.</span><span class="ident" id="4312904"><a href="/gostd/mime/multipart/multipart.go.html#4311887">Header</a></span><span class="op" id="4312910">.</span><span class="ident" id="4312911"><a href="/gostd/net/textproto/header.go.html#4329349">Get</a></span><span class="op" id="4312914">(</span><span class="string" id="4312915">&#34;Content-Disposition&#34;</span><span class="op" id="4312936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4312939">var</span>&nbsp;<span class="ident" id="4312943">err</span>&nbsp;<span class="builtintype" id="4312947">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4312954"><a href="/gostd/mime/multipart/multipart.go.html#4312859">p</a></span><span class="op" id="4312955">.</span><span class="ident" id="4312956"><a href="/gostd/mime/multipart/multipart.go.html#4311977">disposition</a></span><span class="op" id="4312967">,</span>&nbsp;<span class="ident" id="4312969"><a href="/gostd/mime/multipart/multipart.go.html#4312859">p</a></span><span class="op" id="4312970">.</span><span class="ident" id="4312971"><a href="/gostd/mime/multipart/multipart.go.html#4312003">dispositionParams</a></span><span class="op" id="4312988">,</span>&nbsp;<span class="ident" id="4312990"><a href="/gostd/mime/multipart/multipart.go.html#4312943">err</a></span>&nbsp;<span class="op" id="4312994">=</span>&nbsp;<span class="ident" id="4312996"><a href="/gostd/mime/multipart/multipart.go.html#4311344">mime</a></span><span class="op" id="4313000">.</span><span class="ident" id="4313001"><a href="/gostd/mime/mediatype.go.html#4297159">ParseMediaType</a></span><span class="op" id="4313015">(</span><span class="ident" id="4313016"><a href="/gostd/mime/multipart/multipart.go.html#4312897">v</a></span><span class="op" id="4313017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4313020">if</span>&nbsp;<span class="ident" id="4313023"><a href="/gostd/mime/multipart/multipart.go.html#4312943">err</a></span>&nbsp;<span class="op" id="4313027">!=</span>&nbsp;<span class="builtintype" id="4313030">nil</span>&nbsp;<span class="op" id="4313034">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4313038"><a href="/gostd/mime/multipart/multipart.go.html#4312859">p</a></span><span class="op" id="4313039">.</span><span class="ident" id="4313040"><a href="/gostd/mime/multipart/multipart.go.html#4312003">dispositionParams</a></span>&nbsp;<span class="op" id="4313058">=</span>&nbsp;<span class="ident" id="4313060"><a href="/gostd/mime/multipart/multipart.go.html#4311375">emptyParams</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4313073">}</span><br>
<span class="lineno"></span><span class="op" id="4313075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4313078">//&nbsp;NewReader&nbsp;creates&nbsp;a&nbsp;new&nbsp;multipart&nbsp;Reader&nbsp;reading&nbsp;from&nbsp;r&nbsp;using&nbsp;the</span><br>
<span class="lineno">85</span><span class="comment" id="4313147">//&nbsp;given&nbsp;MIME&nbsp;boundary.</span><br>
<span class="lineno"></span><span class="comment" id="4313171">//</span><br>
<span class="lineno"></span><span class="comment" id="4313174">//&nbsp;The&nbsp;boundary&nbsp;is&nbsp;usually&nbsp;obtained&nbsp;from&nbsp;the&nbsp;&#34;boundary&#34;&nbsp;parameter&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4313243">//&nbsp;the&nbsp;message&#39;s&nbsp;&#34;Content-Type&#34;&nbsp;header.&nbsp;Use&nbsp;mime.ParseMediaType&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4313310">//&nbsp;parse&nbsp;such&nbsp;headers.</span><br>
<span class="lineno">90</span><span class="keyword" id="4313333">func</span>&nbsp;<span class="ident" id="4313338">NewReader</span><span class="op" id="4313347">(</span><span class="ident" id="4313348">r</span>&nbsp;<span class="ident" id="4313350"><a href="/gostd/mime/multipart/multipart.go.html#4311325">io</a></span><span class="op" id="4313352">.</span><span class="ident" id="4313353"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="4313359">,</span>&nbsp;<span class="ident" id="4313361">boundary</span>&nbsp;<span class="builtintype" id="4313370">string</span><span class="op" id="4313376">)</span>&nbsp;<span class="op" id="4313378">*</span><span class="ident" id="4313379"><a href="/gostd/mime/multipart/multipart.go.html#4316630">Reader</a></span>&nbsp;<span class="op" id="4313386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4313389">b</span>&nbsp;<span class="op" id="4313391">:=</span>&nbsp;<span class="op" id="4313394">[</span><span class="op" id="4313395">]</span><span class="builtintype" id="4313396">byte</span><span class="op" id="4313400">(</span><span class="string" id="4313401">&#34;\r\n--&#34;</span>&nbsp;<span class="op" id="4313410">+</span>&nbsp;<span class="ident" id="4313412"><a href="/gostd/mime/multipart/multipart.go.html#4313361">boundary</a></span>&nbsp;<span class="op" id="4313421">+</span>&nbsp;<span class="string" id="4313423">&#34;--&#34;</span><span class="op" id="4313427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4313430">return</span>&nbsp;<span class="op" id="4313437">&amp;</span><span class="ident" id="4313438"><a href="/gostd/mime/multipart/multipart.go.html#4316630">Reader</a></span><span class="op" id="4313444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4313448"><a href="/gostd/mime/multipart/multipart.go.html#4316647">bufReader</a></span><span class="op" id="4313457">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4313466"><a href="/gostd/mime/multipart/multipart.go.html#4311300">bufio</a></span><span class="op" id="4313471">.</span><span class="ident" id="4313472"><a href="/gostd/bufio/bufio.go.html#1355792">NewReader</a></span><span class="op" id="4313481">(</span><span class="ident" id="4313482"><a href="/gostd/mime/multipart/multipart.go.html#4313348">r</a></span><span class="op" id="4313483">)</span><span class="op" id="4313484">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4313488"><a href="/gostd/mime/multipart/multipart.go.html#4316710">nl</a></span><span class="op" id="4313490">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4313506"><a href="/gostd/mime/multipart/multipart.go.html#4313389">b</a></span><span class="op" id="4313507">[</span><span class="op" id="4313508">:</span><span class="num" id="4313509">2</span><span class="op" id="4313510">]</span><span class="op" id="4313511">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4313515"><a href="/gostd/mime/multipart/multipart.go.html#4316792">nlDashBoundary</a></span><span class="op" id="4313529">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4313533"><a href="/gostd/mime/multipart/multipart.go.html#4313389">b</a></span><span class="op" id="4313534">[</span><span class="op" id="4313535">:</span><span class="builtinfunc" id="4313536">len</span><span class="op" id="4313539">(</span><span class="ident" id="4313540"><a href="/gostd/mime/multipart/multipart.go.html#4313389">b</a></span><span class="op" id="4313541">)</span><span class="op" id="4313542">-</span><span class="num" id="4313543">2</span><span class="op" id="4313544">]</span><span class="op" id="4313545">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4313549"><a href="/gostd/mime/multipart/multipart.go.html#4316838">dashBoundaryDash</a></span><span class="op" id="4313565">:</span>&nbsp;<span class="ident" id="4313567"><a href="/gostd/mime/multipart/multipart.go.html#4313389">b</a></span><span class="op" id="4313568">[</span><span class="num" id="4313569">2</span><span class="op" id="4313570">:</span><span class="op" id="4313571">]</span><span class="op" id="4313572">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4313576"><a href="/gostd/mime/multipart/multipart.go.html#4316881">dashBoundary</a></span><span class="op" id="4313588">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4313594"><a href="/gostd/mime/multipart/multipart.go.html#4313389">b</a></span><span class="op" id="4313595">[</span><span class="num" id="4313596">2</span>&nbsp;<span class="op" id="4313598">:</span>&nbsp;<span class="builtinfunc" id="4313600">len</span><span class="op" id="4313603">(</span><span class="ident" id="4313604"><a href="/gostd/mime/multipart/multipart.go.html#4313389">b</a></span><span class="op" id="4313605">)</span><span class="op" id="4313606">-</span><span class="num" id="4313607">2</span><span class="op" id="4313608">]</span><span class="op" id="4313609">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4313612">}</span><br>
<span class="lineno"></span><span class="op" id="4313614">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="4313617">func</span>&nbsp;<span class="ident" id="4313622">newPart</span><span class="op" id="4313629">(</span><span class="ident" id="4313630">mr</span>&nbsp;<span class="op" id="4313633">*</span><span class="ident" id="4313634"><a href="/gostd/mime/multipart/multipart.go.html#4316630">Reader</a></span><span class="op" id="4313640">)</span>&nbsp;<span class="op" id="4313642">(</span><span class="op" id="4313643">*</span><span class="ident" id="4313644"><a href="/gostd/mime/multipart/multipart.go.html#4311475">Part</a></span><span class="op" id="4313648">,</span>&nbsp;<span class="builtintype" id="4313650">error</span><span class="op" id="4313655">)</span>&nbsp;<span class="op" id="4313657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4313660">bp</span>&nbsp;<span class="op" id="4313663">:=</span>&nbsp;<span class="op" id="4313666">&amp;</span><span class="ident" id="4313667"><a href="/gostd/mime/multipart/multipart.go.html#4311475">Part</a></span><span class="op" id="4313671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4313675"><a href="/gostd/mime/multipart/multipart.go.html#4311887">Header</a></span><span class="op" id="4313681">:</span>&nbsp;<span class="builtinfunc" id="4313683">make</span><span class="op" id="4313687">(</span><span class="keyword" id="4313688">map</span><span class="op" id="4313691">[</span><span class="builtintype" id="4313692">string</span><span class="op" id="4313698">]</span><span class="op" id="4313699">[</span><span class="op" id="4313700">]</span><span class="builtintype" id="4313701">string</span><span class="op" id="4313707">)</span><span class="op" id="4313708">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4313712"><a href="/gostd/mime/multipart/multipart.go.html#4311942">mr</a></span><span class="op" id="4313714">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4313720"><a href="/gostd/mime/multipart/multipart.go.html#4313630">mr</a></span><span class="op" id="4313722">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4313726"><a href="/gostd/mime/multipart/multipart.go.html#4311917">buffer</a></span><span class="op" id="4313732">:</span>&nbsp;<span class="builtinfunc" id="4313734">new</span><span class="op" id="4313737">(</span><span class="ident" id="4313738"><a href="/gostd/mime/multipart/multipart.go.html#4311309">bytes</a></span><span class="op" id="4313743">.</span><span class="ident" id="4313744"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="4313750">)</span><span class="op" id="4313751">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4313754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4313757">if</span>&nbsp;<span class="ident" id="4313760">err</span>&nbsp;<span class="op" id="4313764">:=</span>&nbsp;<span class="ident" id="4313767"><a href="/gostd/mime/multipart/multipart.go.html#4313660">bp</a></span><span class="op" id="4313769">.</span><span class="ident" id="4313770"><a href="/gostd/mime/multipart/multipart.go.html#4314033">populateHeaders</a></span><span class="op" id="4313785">(</span><span class="op" id="4313786">)</span><span class="op" id="4313787">;</span>&nbsp;<span class="ident" id="4313789"><a href="/gostd/mime/multipart/multipart.go.html#4313760">err</a></span>&nbsp;<span class="op" id="4313793">!=</span>&nbsp;<span class="builtintype" id="4313796">nil</span>&nbsp;<span class="op" id="4313800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4313804">return</span>&nbsp;<span class="builtintype" id="4313811">nil</span><span class="op" id="4313814">,</span>&nbsp;<span class="ident" id="4313816"><a href="/gostd/mime/multipart/multipart.go.html#4313760">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4313821">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4313824"><a href="/gostd/mime/multipart/multipart.go.html#4313660">bp</a></span><span class="op" id="4313826">.</span><span class="ident" id="4313827"><a href="/gostd/mime/multipart/multipart.go.html#4312179">r</a></span>&nbsp;<span class="op" id="4313829">=</span>&nbsp;<span class="ident" id="4313831"><a href="/gostd/mime/multipart/multipart.go.html#4314507">partReader</a></span><span class="op" id="4313841">{</span><span class="ident" id="4313842"><a href="/gostd/mime/multipart/multipart.go.html#4313660">bp</a></span><span class="op" id="4313844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4313847">const</span>&nbsp;<span class="ident" id="4313853">cte</span>&nbsp;<span class="op" id="4313857">=</span>&nbsp;<span class="string" id="4313859">&#34;Content-Transfer-Encoding&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4313888">if</span>&nbsp;<span class="ident" id="4313891"><a href="/gostd/mime/multipart/multipart.go.html#4313660">bp</a></span><span class="op" id="4313893">.</span><span class="ident" id="4313894"><a href="/gostd/mime/multipart/multipart.go.html#4311887">Header</a></span><span class="op" id="4313900">.</span><span class="ident" id="4313901"><a href="/gostd/net/textproto/header.go.html#4329349">Get</a></span><span class="op" id="4313904">(</span><span class="ident" id="4313905"><a href="/gostd/mime/multipart/multipart.go.html#4313853">cte</a></span><span class="op" id="4313908">)</span>&nbsp;<span class="op" id="4313910">==</span>&nbsp;<span class="string" id="4313913">&#34;quoted-printable&#34;</span>&nbsp;<span class="op" id="4313932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4313936"><a href="/gostd/mime/multipart/multipart.go.html#4313660">bp</a></span><span class="op" id="4313938">.</span><span class="ident" id="4313939"><a href="/gostd/mime/multipart/multipart.go.html#4311887">Header</a></span><span class="op" id="4313945">.</span><span class="ident" id="4313946"><a href="/gostd/net/textproto/header.go.html#4329557">Del</a></span><span class="op" id="4313949">(</span><span class="ident" id="4313950"><a href="/gostd/mime/multipart/multipart.go.html#4313853">cte</a></span><span class="op" id="4313953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4313957"><a href="/gostd/mime/multipart/multipart.go.html#4313660">bp</a></span><span class="op" id="4313959">.</span><span class="ident" id="4313960"><a href="/gostd/mime/multipart/multipart.go.html#4312179">r</a></span>&nbsp;<span class="op" id="4313962">=</span>&nbsp;<span class="ident" id="4313964"><a href="/gostd/mime/multipart/quotedprintable.go.html#4321579">newQuotedPrintableReader</a></span><span class="op" id="4313988">(</span><span class="ident" id="4313989"><a href="/gostd/mime/multipart/multipart.go.html#4313660">bp</a></span><span class="op" id="4313991">.</span><span class="ident" id="4313992"><a href="/gostd/mime/multipart/multipart.go.html#4312179">r</a></span><span class="op" id="4313993">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4313996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4313999">return</span>&nbsp;<span class="ident" id="4314006"><a href="/gostd/mime/multipart/multipart.go.html#4313660">bp</a></span><span class="op" id="4314008">,</span>&nbsp;<span class="builtintype" id="4314010">nil</span><br>
<span class="lineno"></span><span class="op" id="4314014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4314017">func</span>&nbsp;<span class="op" id="4314022">(</span><span class="ident" id="4314023">bp</span>&nbsp;<span class="op" id="4314026">*</span><span class="ident" id="4314027"><a href="/gostd/mime/multipart/multipart.go.html#4311475">Part</a></span><span class="op" id="4314031">)</span>&nbsp;<span class="ident" id="4314033">populateHeaders</span><span class="op" id="4314048">(</span><span class="op" id="4314049">)</span>&nbsp;<span class="builtintype" id="4314051">error</span>&nbsp;<span class="op" id="4314057">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4314060">r</span>&nbsp;<span class="op" id="4314062">:=</span>&nbsp;<span class="ident" id="4314065"><a href="/gostd/mime/multipart/multipart.go.html#4311352">textproto</a></span><span class="op" id="4314074">.</span><span class="ident" id="4314075"><a href="/gostd/net/textproto/reader.go.html#4333349">NewReader</a></span><span class="op" id="4314084">(</span><span class="ident" id="4314085"><a href="/gostd/mime/multipart/multipart.go.html#4314023">bp</a></span><span class="op" id="4314087">.</span><span class="ident" id="4314088"><a href="/gostd/mime/multipart/multipart.go.html#4311942">mr</a></span><span class="op" id="4314090">.</span><span class="ident" id="4314091"><a href="/gostd/mime/multipart/multipart.go.html#4316647">bufReader</a></span><span class="op" id="4314100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4314103">header</span><span class="op" id="4314109">,</span>&nbsp;<span class="ident" id="4314111">err</span>&nbsp;<span class="op" id="4314115">:=</span>&nbsp;<span class="ident" id="4314118"><a href="/gostd/mime/multipart/multipart.go.html#4314060">r</a></span><span class="op" id="4314119">.</span><span class="ident" id="4314120"><a href="/gostd/net/textproto/reader.go.html#4344573">ReadMIMEHeader</a></span><span class="op" id="4314134">(</span><span class="op" id="4314135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4314138">if</span>&nbsp;<span class="ident" id="4314141"><a href="/gostd/mime/multipart/multipart.go.html#4314111">err</a></span>&nbsp;<span class="op" id="4314145">==</span>&nbsp;<span class="builtintype" id="4314148">nil</span>&nbsp;<span class="op" id="4314152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4314156"><a href="/gostd/mime/multipart/multipart.go.html#4314023">bp</a></span><span class="op" id="4314158">.</span><span class="ident" id="4314159"><a href="/gostd/mime/multipart/multipart.go.html#4311887">Header</a></span>&nbsp;<span class="op" id="4314166">=</span>&nbsp;<span class="ident" id="4314168"><a href="/gostd/mime/multipart/multipart.go.html#4314103">header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4314176">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4314179">return</span>&nbsp;<span class="ident" id="4314186"><a href="/gostd/mime/multipart/multipart.go.html#4314111">err</a></span><br>
<span class="lineno"></span><span class="op" id="4314190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4314193">//&nbsp;Read&nbsp;reads&nbsp;the&nbsp;body&nbsp;of&nbsp;a&nbsp;part,&nbsp;after&nbsp;its&nbsp;headers&nbsp;and&nbsp;before&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4314260">//&nbsp;next&nbsp;part&nbsp;(if&nbsp;any)&nbsp;begins.</span><br>
<span class="lineno">130</span><span class="keyword" id="4314290">func</span>&nbsp;<span class="op" id="4314295">(</span><span class="ident" id="4314296">p</span>&nbsp;<span class="op" id="4314298">*</span><span class="ident" id="4314299"><a href="/gostd/mime/multipart/multipart.go.html#4311475">Part</a></span><span class="op" id="4314303">)</span>&nbsp;<span class="ident" id="4314305">Read</span><span class="op" id="4314309">(</span><span class="ident" id="4314310">d</span>&nbsp;<span class="op" id="4314312">[</span><span class="op" id="4314313">]</span><span class="builtintype" id="4314314">byte</span><span class="op" id="4314318">)</span>&nbsp;<span class="op" id="4314320">(</span><span class="ident" id="4314321">n</span>&nbsp;<span class="builtintype" id="4314323">int</span><span class="op" id="4314326">,</span>&nbsp;<span class="ident" id="4314328">err</span>&nbsp;<span class="builtintype" id="4314332">error</span><span class="op" id="4314337">)</span>&nbsp;<span class="op" id="4314339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4314342">return</span>&nbsp;<span class="ident" id="4314349"><a href="/gostd/mime/multipart/multipart.go.html#4314296">p</a></span><span class="op" id="4314350">.</span><span class="ident" id="4314351"><a href="/gostd/mime/multipart/multipart.go.html#4312179">r</a></span><span class="op" id="4314352">.</span><span class="ident" id="4314353"><a href="/gostd/io/io.go.html#1421843">Read</a></span><span class="op" id="4314357">(</span><span class="ident" id="4314358"><a href="/gostd/mime/multipart/multipart.go.html#4314310">d</a></span><span class="op" id="4314359">)</span><br>
<span class="lineno"></span><span class="op" id="4314361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4314364">//&nbsp;partReader&nbsp;implements&nbsp;io.Reader&nbsp;by&nbsp;reading&nbsp;raw&nbsp;bytes&nbsp;directly&nbsp;from&nbsp;the</span><br>
<span class="lineno">135</span><span class="comment" id="4314438">//&nbsp;wrapped&nbsp;*Part,&nbsp;without&nbsp;doing&nbsp;any&nbsp;Transfer-Encoding&nbsp;decoding.</span><br>
<span class="lineno"></span><span class="keyword" id="4314502">type</span>&nbsp;<span class="ident" id="4314507">partReader</span>&nbsp;<span class="keyword" id="4314518">struct</span>&nbsp;<span class="op" id="4314525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4314528">p</span>&nbsp;<span class="op" id="4314530">*</span><span class="ident" id="4314531"><a href="/gostd/mime/multipart/multipart.go.html#4311475">Part</a></span><br>
<span class="lineno"></span><span class="op" id="4314536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="keyword" id="4314539">func</span>&nbsp;<span class="op" id="4314544">(</span><span class="ident" id="4314545">pr</span>&nbsp;<span class="ident" id="4314548"><a href="/gostd/mime/multipart/multipart.go.html#4314507">partReader</a></span><span class="op" id="4314558">)</span>&nbsp;<span class="ident" id="4314560">Read</span><span class="op" id="4314564">(</span><span class="ident" id="4314565">d</span>&nbsp;<span class="op" id="4314567">[</span><span class="op" id="4314568">]</span><span class="builtintype" id="4314569">byte</span><span class="op" id="4314573">)</span>&nbsp;<span class="op" id="4314575">(</span><span class="ident" id="4314576">n</span>&nbsp;<span class="builtintype" id="4314578">int</span><span class="op" id="4314581">,</span>&nbsp;<span class="ident" id="4314583">err</span>&nbsp;<span class="builtintype" id="4314587">error</span><span class="op" id="4314592">)</span>&nbsp;<span class="op" id="4314594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4314597">p</span>&nbsp;<span class="op" id="4314599">:=</span>&nbsp;<span class="ident" id="4314602"><a href="/gostd/mime/multipart/multipart.go.html#4314545">pr</a></span><span class="op" id="4314604">.</span><span class="ident" id="4314605"><a href="/gostd/mime/multipart/multipart.go.html#4314528">p</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4314608">defer</span>&nbsp;<span class="keyword" id="4314614">func</span><span class="op" id="4314618">(</span><span class="op" id="4314619">)</span>&nbsp;<span class="op" id="4314621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4314625"><a href="/gostd/mime/multipart/multipart.go.html#4314597">p</a></span><span class="op" id="4314626">.</span><span class="ident" id="4314627"><a href="/gostd/mime/multipart/multipart.go.html#4311961">bytesRead</a></span>&nbsp;<span class="op" id="4314637">+=</span>&nbsp;<span class="ident" id="4314640"><a href="/gostd/mime/multipart/multipart.go.html#4314576">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4314643">}</span><span class="op" id="4314644">(</span><span class="op" id="4314645">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4314648">if</span>&nbsp;<span class="ident" id="4314651"><a href="/gostd/mime/multipart/multipart.go.html#4314597">p</a></span><span class="op" id="4314652">.</span><span class="ident" id="4314653"><a href="/gostd/mime/multipart/multipart.go.html#4311917">buffer</a></span><span class="op" id="4314659">.</span><span class="ident" id="4314660"><a href="/gostd/bytes/buffer.go.html#1384893">Len</a></span><span class="op" id="4314663">(</span><span class="op" id="4314664">)</span>&nbsp;<span class="op" id="4314666">&gt;=</span>&nbsp;<span class="builtinfunc" id="4314669">len</span><span class="op" id="4314672">(</span><span class="ident" id="4314673"><a href="/gostd/mime/multipart/multipart.go.html#4314565">d</a></span><span class="op" id="4314674">)</span>&nbsp;<span class="op" id="4314676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4314680">//&nbsp;Internal&nbsp;buffer&nbsp;of&nbsp;unconsumed&nbsp;data&nbsp;is&nbsp;large&nbsp;enough&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4314740">//&nbsp;the&nbsp;read&nbsp;request.&nbsp;&nbsp;No&nbsp;need&nbsp;to&nbsp;parse&nbsp;more&nbsp;at&nbsp;the&nbsp;moment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4314801">return</span>&nbsp;<span class="ident" id="4314808"><a href="/gostd/mime/multipart/multipart.go.html#4314597">p</a></span><span class="op" id="4314809">.</span><span class="ident" id="4314810"><a href="/gostd/mime/multipart/multipart.go.html#4311917">buffer</a></span><span class="op" id="4314816">.</span><span class="ident" id="4314817"><a href="/gostd/bytes/buffer.go.html#1390970">Read</a></span><span class="op" id="4314821">(</span><span class="ident" id="4314822"><a href="/gostd/mime/multipart/multipart.go.html#4314565">d</a></span><span class="op" id="4314823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4314826">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4314829">peek</span><span class="op" id="4314833">,</span>&nbsp;<span class="ident" id="4314835"><a href="/gostd/mime/multipart/multipart.go.html#4314583">err</a></span>&nbsp;<span class="op" id="4314839">:=</span>&nbsp;<span class="ident" id="4314842"><a href="/gostd/mime/multipart/multipart.go.html#4314597">p</a></span><span class="op" id="4314843">.</span><span class="ident" id="4314844"><a href="/gostd/mime/multipart/multipart.go.html#4311942">mr</a></span><span class="op" id="4314846">.</span><span class="ident" id="4314847"><a href="/gostd/mime/multipart/multipart.go.html#4316647">bufReader</a></span><span class="op" id="4314856">.</span><span class="ident" id="4314857"><a href="/gostd/bufio/bufio.go.html#1357192">Peek</a></span><span class="op" id="4314861">(</span><span class="num" id="4314862">4096</span><span class="op" id="4314866">)</span>&nbsp;<span class="comment" id="4314868">//&nbsp;TODO(bradfitz):&nbsp;add&nbsp;buffer&nbsp;size&nbsp;accessor</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4314914">//&nbsp;Look&nbsp;for&nbsp;an&nbsp;immediate&nbsp;empty&nbsp;part&nbsp;without&nbsp;a&nbsp;leading&nbsp;\r\n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4314974">//&nbsp;before&nbsp;the&nbsp;boundary&nbsp;separator.&nbsp;&nbsp;Some&nbsp;MIME&nbsp;code&nbsp;makes&nbsp;empty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4315037">//&nbsp;parts&nbsp;like&nbsp;this.&nbsp;Most&nbsp;browsers,&nbsp;however,&nbsp;write&nbsp;the&nbsp;\r\n</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4315097">//&nbsp;before&nbsp;the&nbsp;subsequent&nbsp;boundary&nbsp;even&nbsp;for&nbsp;empty&nbsp;parts&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4315157">//&nbsp;won&#39;t&nbsp;hit&nbsp;this&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4315182">if</span>&nbsp;<span class="ident" id="4315185"><a href="/gostd/mime/multipart/multipart.go.html#4314597">p</a></span><span class="op" id="4315186">.</span><span class="ident" id="4315187"><a href="/gostd/mime/multipart/multipart.go.html#4311961">bytesRead</a></span>&nbsp;<span class="op" id="4315197">==</span>&nbsp;<span class="num" id="4315200">0</span>&nbsp;<span class="op" id="4315202">&amp;&amp;</span>&nbsp;<span class="ident" id="4315205"><a href="/gostd/mime/multipart/multipart.go.html#4314597">p</a></span><span class="op" id="4315206">.</span><span class="ident" id="4315207"><a href="/gostd/mime/multipart/multipart.go.html#4311942">mr</a></span><span class="op" id="4315209">.</span><span class="ident" id="4315210"><a href="/gostd/mime/multipart/multipart.go.html#4320193">peekBufferIsEmptyPart</a></span><span class="op" id="4315231">(</span><span class="ident" id="4315232"><a href="/gostd/mime/multipart/multipart.go.html#4314829">peek</a></span><span class="op" id="4315236">)</span>&nbsp;<span class="op" id="4315238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4315242">return</span>&nbsp;<span class="num" id="4315249">0</span><span class="op" id="4315250">,</span>&nbsp;<span class="ident" id="4315252"><a href="/gostd/mime/multipart/multipart.go.html#4311325">io</a></span><span class="op" id="4315254">.</span><span class="ident" id="4315255"><a href="/gostd/io/io.go.html#1419950">EOF</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4315260">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4315263">unexpectedEOF</span>&nbsp;<span class="op" id="4315277">:=</span>&nbsp;<span class="ident" id="4315280"><a href="/gostd/mime/multipart/multipart.go.html#4314583">err</a></span>&nbsp;<span class="op" id="4315284">==</span>&nbsp;<span class="ident" id="4315287"><a href="/gostd/mime/multipart/multipart.go.html#4311325">io</a></span><span class="op" id="4315289">.</span><span class="ident" id="4315290"><a href="/gostd/io/io.go.html#1419950">EOF</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4315295">if</span>&nbsp;<span class="ident" id="4315298"><a href="/gostd/mime/multipart/multipart.go.html#4314583">err</a></span>&nbsp;<span class="op" id="4315302">!=</span>&nbsp;<span class="builtintype" id="4315305">nil</span>&nbsp;<span class="op" id="4315309">&amp;&amp;</span>&nbsp;<span class="op" id="4315312">!</span><span class="ident" id="4315313"><a href="/gostd/mime/multipart/multipart.go.html#4315263">unexpectedEOF</a></span>&nbsp;<span class="op" id="4315327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4315331">return</span>&nbsp;<span class="num" id="4315338">0</span><span class="op" id="4315339">,</span>&nbsp;<span class="ident" id="4315341"><a href="/gostd/mime/multipart/multipart.go.html#4311318">fmt</a></span><span class="op" id="4315344">.</span><span class="ident" id="4315345"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="4315351">(</span><span class="string" id="4315352">&#34;multipart:&nbsp;Part&nbsp;Read:&nbsp;%v&#34;</span><span class="op" id="4315378">,</span>&nbsp;<span class="ident" id="4315380"><a href="/gostd/mime/multipart/multipart.go.html#4314583">err</a></span><span class="op" id="4315383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4315386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4315389">if</span>&nbsp;<span class="ident" id="4315392"><a href="/gostd/mime/multipart/multipart.go.html#4314829">peek</a></span>&nbsp;<span class="op" id="4315397">==</span>&nbsp;<span class="builtintype" id="4315400">nil</span>&nbsp;<span class="op" id="4315404">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4315408">panic</span><span class="op" id="4315413">(</span><span class="string" id="4315414">&#34;nil&nbsp;peek&nbsp;buf&#34;</span><span class="op" id="4315428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4315431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4315435">//&nbsp;Search&nbsp;the&nbsp;peek&nbsp;buffer&nbsp;for&nbsp;&#34;\r\n--boundary&#34;.&nbsp;If&nbsp;found,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4315494">//&nbsp;consume&nbsp;everything&nbsp;up&nbsp;to&nbsp;the&nbsp;boundary.&nbsp;If&nbsp;not,&nbsp;consume&nbsp;only</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4315558">//&nbsp;as&nbsp;much&nbsp;of&nbsp;the&nbsp;peek&nbsp;buffer&nbsp;as&nbsp;cannot&nbsp;hold&nbsp;the&nbsp;boundary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4315617">//&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4315629">nCopy</span>&nbsp;<span class="op" id="4315635">:=</span>&nbsp;<span class="num" id="4315638">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4315641">foundBoundary</span>&nbsp;<span class="op" id="4315655">:=</span>&nbsp;<span class="builtintype" id="4315658">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4315665">if</span>&nbsp;<span class="ident" id="4315668">idx</span>&nbsp;<span class="op" id="4315672">:=</span>&nbsp;<span class="ident" id="4315675"><a href="/gostd/mime/multipart/multipart.go.html#4311309">bytes</a></span><span class="op" id="4315680">.</span><span class="ident" id="4315681"><a href="/gostd/bytes/bytes.go.html#1397659">Index</a></span><span class="op" id="4315686">(</span><span class="ident" id="4315687"><a href="/gostd/mime/multipart/multipart.go.html#4314829">peek</a></span><span class="op" id="4315691">,</span>&nbsp;<span class="ident" id="4315693"><a href="/gostd/mime/multipart/multipart.go.html#4314597">p</a></span><span class="op" id="4315694">.</span><span class="ident" id="4315695"><a href="/gostd/mime/multipart/multipart.go.html#4311942">mr</a></span><span class="op" id="4315697">.</span><span class="ident" id="4315698"><a href="/gostd/mime/multipart/multipart.go.html#4316792">nlDashBoundary</a></span><span class="op" id="4315712">)</span><span class="op" id="4315713">;</span>&nbsp;<span class="ident" id="4315715"><a href="/gostd/mime/multipart/multipart.go.html#4315668">idx</a></span>&nbsp;<span class="op" id="4315719">!=</span>&nbsp;<span class="op" id="4315722">-</span><span class="num" id="4315723">1</span>&nbsp;<span class="op" id="4315725">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4315729"><a href="/gostd/mime/multipart/multipart.go.html#4315629">nCopy</a></span>&nbsp;<span class="op" id="4315735">=</span>&nbsp;<span class="ident" id="4315737"><a href="/gostd/mime/multipart/multipart.go.html#4315668">idx</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4315743"><a href="/gostd/mime/multipart/multipart.go.html#4315641">foundBoundary</a></span>&nbsp;<span class="op" id="4315757">=</span>&nbsp;<span class="builtintype" id="4315759">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4315765">}</span>&nbsp;<span class="keyword" id="4315767">else</span>&nbsp;<span class="keyword" id="4315772">if</span>&nbsp;<span class="ident" id="4315775">safeCount</span>&nbsp;<span class="op" id="4315785">:=</span>&nbsp;<span class="builtinfunc" id="4315788">len</span><span class="op" id="4315791">(</span><span class="ident" id="4315792"><a href="/gostd/mime/multipart/multipart.go.html#4314829">peek</a></span><span class="op" id="4315796">)</span>&nbsp;<span class="op" id="4315798">-</span>&nbsp;<span class="builtinfunc" id="4315800">len</span><span class="op" id="4315803">(</span><span class="ident" id="4315804"><a href="/gostd/mime/multipart/multipart.go.html#4314597">p</a></span><span class="op" id="4315805">.</span><span class="ident" id="4315806"><a href="/gostd/mime/multipart/multipart.go.html#4311942">mr</a></span><span class="op" id="4315808">.</span><span class="ident" id="4315809"><a href="/gostd/mime/multipart/multipart.go.html#4316792">nlDashBoundary</a></span><span class="op" id="4315823">)</span><span class="op" id="4315824">;</span>&nbsp;<span class="ident" id="4315826"><a href="/gostd/mime/multipart/multipart.go.html#4315775">safeCount</a></span>&nbsp;<span class="op" id="4315836">&gt;</span>&nbsp;<span class="num" id="4315838">0</span>&nbsp;<span class="op" id="4315840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4315844"><a href="/gostd/mime/multipart/multipart.go.html#4315629">nCopy</a></span>&nbsp;<span class="op" id="4315850">=</span>&nbsp;<span class="ident" id="4315852"><a href="/gostd/mime/multipart/multipart.go.html#4315775">safeCount</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4315863">}</span>&nbsp;<span class="keyword" id="4315865">else</span>&nbsp;<span class="keyword" id="4315870">if</span>&nbsp;<span class="ident" id="4315873"><a href="/gostd/mime/multipart/multipart.go.html#4315263">unexpectedEOF</a></span>&nbsp;<span class="op" id="4315887">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4315891">//&nbsp;If&nbsp;we&#39;ve&nbsp;run&nbsp;out&nbsp;of&nbsp;peek&nbsp;buffer&nbsp;and&nbsp;the&nbsp;boundary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4315945">//&nbsp;wasn&#39;t&nbsp;found&nbsp;(and&nbsp;can&#39;t&nbsp;possibly&nbsp;fit),&nbsp;we&nbsp;must&nbsp;have</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4316002">//&nbsp;hit&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;file&nbsp;unexpectedly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4316045">return</span>&nbsp;<span class="num" id="4316052">0</span><span class="op" id="4316053">,</span>&nbsp;<span class="ident" id="4316055"><a href="/gostd/mime/multipart/multipart.go.html#4311325">io</a></span><span class="op" id="4316057">.</span><span class="ident" id="4316058"><a href="/gostd/io/io.go.html#1420096">ErrUnexpectedEOF</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4316076">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4316079">if</span>&nbsp;<span class="ident" id="4316082"><a href="/gostd/mime/multipart/multipart.go.html#4315629">nCopy</a></span>&nbsp;<span class="op" id="4316088">&gt;</span>&nbsp;<span class="num" id="4316090">0</span>&nbsp;<span class="op" id="4316092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4316096">if</span>&nbsp;<span class="ident" id="4316099">_</span><span class="op" id="4316100">,</span>&nbsp;<span class="ident" id="4316102">err</span>&nbsp;<span class="op" id="4316106">:=</span>&nbsp;<span class="ident" id="4316109"><a href="/gostd/mime/multipart/multipart.go.html#4311325">io</a></span><span class="op" id="4316111">.</span><span class="ident" id="4316112"><a href="/gostd/io/io.go.html#1430100">CopyN</a></span><span class="op" id="4316117">(</span><span class="ident" id="4316118"><a href="/gostd/mime/multipart/multipart.go.html#4314597">p</a></span><span class="op" id="4316119">.</span><span class="ident" id="4316120"><a href="/gostd/mime/multipart/multipart.go.html#4311917">buffer</a></span><span class="op" id="4316126">,</span>&nbsp;<span class="ident" id="4316128"><a href="/gostd/mime/multipart/multipart.go.html#4314597">p</a></span><span class="op" id="4316129">.</span><span class="ident" id="4316130"><a href="/gostd/mime/multipart/multipart.go.html#4311942">mr</a></span><span class="op" id="4316132">.</span><span class="ident" id="4316133"><a href="/gostd/mime/multipart/multipart.go.html#4316647">bufReader</a></span><span class="op" id="4316142">,</span>&nbsp;<span class="builtintype" id="4316144">int64</span><span class="op" id="4316149">(</span><span class="ident" id="4316150"><a href="/gostd/mime/multipart/multipart.go.html#4315629">nCopy</a></span><span class="op" id="4316155">)</span><span class="op" id="4316156">)</span><span class="op" id="4316157">;</span>&nbsp;<span class="ident" id="4316159"><a href="/gostd/mime/multipart/multipart.go.html#4316102">err</a></span>&nbsp;<span class="op" id="4316163">!=</span>&nbsp;<span class="builtintype" id="4316166">nil</span>&nbsp;<span class="op" id="4316170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4316175">return</span>&nbsp;<span class="num" id="4316182">0</span><span class="op" id="4316183">,</span>&nbsp;<span class="ident" id="4316185"><a href="/gostd/mime/multipart/multipart.go.html#4316102">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4316191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4316194">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4316197"><a href="/gostd/mime/multipart/multipart.go.html#4314576">n</a></span><span class="op" id="4316198">,</span>&nbsp;<span class="ident" id="4316200"><a href="/gostd/mime/multipart/multipart.go.html#4314583">err</a></span>&nbsp;<span class="op" id="4316204">=</span>&nbsp;<span class="ident" id="4316206"><a href="/gostd/mime/multipart/multipart.go.html#4314597">p</a></span><span class="op" id="4316207">.</span><span class="ident" id="4316208"><a href="/gostd/mime/multipart/multipart.go.html#4311917">buffer</a></span><span class="op" id="4316214">.</span><span class="ident" id="4316215"><a href="/gostd/bytes/buffer.go.html#1390970">Read</a></span><span class="op" id="4316219">(</span><span class="ident" id="4316220"><a href="/gostd/mime/multipart/multipart.go.html#4314565">d</a></span><span class="op" id="4316221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4316224">if</span>&nbsp;<span class="ident" id="4316227"><a href="/gostd/mime/multipart/multipart.go.html#4314583">err</a></span>&nbsp;<span class="op" id="4316231">==</span>&nbsp;<span class="ident" id="4316234"><a href="/gostd/mime/multipart/multipart.go.html#4311325">io</a></span><span class="op" id="4316236">.</span><span class="ident" id="4316237"><a href="/gostd/io/io.go.html#1419950">EOF</a></span>&nbsp;<span class="op" id="4316241">&amp;&amp;</span>&nbsp;<span class="op" id="4316244">!</span><span class="ident" id="4316245"><a href="/gostd/mime/multipart/multipart.go.html#4315641">foundBoundary</a></span>&nbsp;<span class="op" id="4316259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4316263">//&nbsp;If&nbsp;the&nbsp;boundary&nbsp;hasn&#39;t&nbsp;been&nbsp;reached&nbsp;there&#39;s&nbsp;more&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4316320">//&nbsp;read,&nbsp;so&nbsp;don&#39;t&nbsp;pass&nbsp;through&nbsp;an&nbsp;EOF&nbsp;from&nbsp;the&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4316376"><a href="/gostd/mime/multipart/multipart.go.html#4314583">err</a></span>&nbsp;<span class="op" id="4316380">=</span>&nbsp;<span class="builtintype" id="4316382">nil</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4316387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4316390">return</span><br>
<span class="lineno"></span><span class="op" id="4316397">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4316400">func</span>&nbsp;<span class="op" id="4316405">(</span><span class="ident" id="4316406">p</span>&nbsp;<span class="op" id="4316408">*</span><span class="ident" id="4316409"><a href="/gostd/mime/multipart/multipart.go.html#4311475">Part</a></span><span class="op" id="4316413">)</span>&nbsp;<span class="ident" id="4316415">Close</span><span class="op" id="4316420">(</span><span class="op" id="4316421">)</span>&nbsp;<span class="builtintype" id="4316423">error</span>&nbsp;<span class="op" id="4316429">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4316432"><a href="/gostd/mime/multipart/multipart.go.html#4311325">io</a></span><span class="op" id="4316434">.</span><span class="ident" id="4316435"><a href="/gostd/io/io.go.html#1430946">Copy</a></span><span class="op" id="4316439">(</span><span class="ident" id="4316440"><a href="/gostd/mime/multipart/multipart.go.html#4311331">ioutil</a></span><span class="op" id="4316446">.</span><span class="ident" id="4316447"><a href="/gostd/io/ioutil/ioutil.go.html#3768458">Discard</a></span><span class="op" id="4316454">,</span>&nbsp;<span class="ident" id="4316456"><a href="/gostd/mime/multipart/multipart.go.html#4316406">p</a></span><span class="op" id="4316457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4316460">return</span>&nbsp;<span class="builtintype" id="4316467">nil</span><br>
<span class="lineno"></span><span class="op" id="4316471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4316474">//&nbsp;Reader&nbsp;is&nbsp;an&nbsp;iterator&nbsp;over&nbsp;parts&nbsp;in&nbsp;a&nbsp;MIME&nbsp;multipart&nbsp;body.</span><br>
<span class="lineno">205</span><span class="comment" id="4316536">//&nbsp;Reader&#39;s&nbsp;underlying&nbsp;parser&nbsp;consumes&nbsp;its&nbsp;input&nbsp;as&nbsp;needed.&nbsp;&nbsp;Seeking</span><br>
<span class="lineno"></span><span class="comment" id="4316605">//&nbsp;isn&#39;t&nbsp;supported.</span><br>
<span class="lineno"></span><span class="keyword" id="4316625">type</span>&nbsp;<span class="ident" id="4316630">Reader</span>&nbsp;<span class="keyword" id="4316637">struct</span>&nbsp;<span class="op" id="4316644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4316647">bufReader</span>&nbsp;<span class="op" id="4316657">*</span><span class="ident" id="4316658"><a href="/gostd/mime/multipart/multipart.go.html#4311300">bufio</a></span><span class="op" id="4316663">.</span><span class="ident" id="4316664"><a href="/gostd/bufio/bufio.go.html#1354974">Reader</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4316673">currentPart</span>&nbsp;<span class="op" id="4316685">*</span><span class="ident" id="4316686"><a href="/gostd/mime/multipart/multipart.go.html#4311475">Part</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4316692">partsRead</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4316704">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4316710">nl</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4316727">[</span><span class="op" id="4316728">]</span><span class="builtintype" id="4316729">byte</span>&nbsp;<span class="comment" id="4316734">//&nbsp;&#34;\r\n&#34;&nbsp;or&nbsp;&#34;\n&#34;&nbsp;(set&nbsp;after&nbsp;seeing&nbsp;first&nbsp;boundary&nbsp;line)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4316792">nlDashBoundary</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4316809">[</span><span class="op" id="4316810">]</span><span class="builtintype" id="4316811">byte</span>&nbsp;<span class="comment" id="4316816">//&nbsp;nl&nbsp;+&nbsp;&#34;--boundary&#34;</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4316838">dashBoundaryDash</span>&nbsp;<span class="op" id="4316855">[</span><span class="op" id="4316856">]</span><span class="builtintype" id="4316857">byte</span>&nbsp;<span class="comment" id="4316862">//&nbsp;&#34;--boundary--&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4316881">dashBoundary</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4316898">[</span><span class="op" id="4316899">]</span><span class="builtintype" id="4316900">byte</span>&nbsp;<span class="comment" id="4316905">//&nbsp;&#34;--boundary&#34;</span><br>
<span class="lineno"></span><span class="op" id="4316921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4316924">//&nbsp;NextPart&nbsp;returns&nbsp;the&nbsp;next&nbsp;part&nbsp;in&nbsp;the&nbsp;multipart&nbsp;or&nbsp;an&nbsp;error.</span><br>
<span class="lineno">220</span><span class="comment" id="4316988">//&nbsp;When&nbsp;there&nbsp;are&nbsp;no&nbsp;more&nbsp;parts,&nbsp;the&nbsp;error&nbsp;io.EOF&nbsp;is&nbsp;returned.</span><br>
<span class="lineno"></span><span class="keyword" id="4317051">func</span>&nbsp;<span class="op" id="4317056">(</span><span class="ident" id="4317057">r</span>&nbsp;<span class="op" id="4317059">*</span><span class="ident" id="4317060"><a href="/gostd/mime/multipart/multipart.go.html#4316630">Reader</a></span><span class="op" id="4317066">)</span>&nbsp;<span class="ident" id="4317068">NextPart</span><span class="op" id="4317076">(</span><span class="op" id="4317077">)</span>&nbsp;<span class="op" id="4317079">(</span><span class="op" id="4317080">*</span><span class="ident" id="4317081"><a href="/gostd/mime/multipart/multipart.go.html#4311475">Part</a></span><span class="op" id="4317085">,</span>&nbsp;<span class="builtintype" id="4317087">error</span><span class="op" id="4317092">)</span>&nbsp;<span class="op" id="4317094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4317097">if</span>&nbsp;<span class="ident" id="4317100"><a href="/gostd/mime/multipart/multipart.go.html#4317057">r</a></span><span class="op" id="4317101">.</span><span class="ident" id="4317102"><a href="/gostd/mime/multipart/multipart.go.html#4316673">currentPart</a></span>&nbsp;<span class="op" id="4317114">!=</span>&nbsp;<span class="builtintype" id="4317117">nil</span>&nbsp;<span class="op" id="4317121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317125"><a href="/gostd/mime/multipart/multipart.go.html#4317057">r</a></span><span class="op" id="4317126">.</span><span class="ident" id="4317127"><a href="/gostd/mime/multipart/multipart.go.html#4316673">currentPart</a></span><span class="op" id="4317138">.</span><span class="ident" id="4317139"><a href="/gostd/mime/multipart/multipart.go.html#4316415">Close</a></span><span class="op" id="4317144">(</span><span class="op" id="4317145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4317148">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317152">expectNewPart</span>&nbsp;<span class="op" id="4317166">:=</span>&nbsp;<span class="builtintype" id="4317169">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4317176">for</span>&nbsp;<span class="op" id="4317180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317184">line</span><span class="op" id="4317188">,</span>&nbsp;<span class="ident" id="4317190">err</span>&nbsp;<span class="op" id="4317194">:=</span>&nbsp;<span class="ident" id="4317197"><a href="/gostd/mime/multipart/multipart.go.html#4317057">r</a></span><span class="op" id="4317198">.</span><span class="ident" id="4317199"><a href="/gostd/mime/multipart/multipart.go.html#4316647">bufReader</a></span><span class="op" id="4317208">.</span><span class="ident" id="4317209"><a href="/gostd/bufio/bufio.go.html#1361158">ReadSlice</a></span><span class="op" id="4317218">(</span><span class="string" id="4317219">&#39;\n&#39;</span><span class="op" id="4317223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4317227">if</span>&nbsp;<span class="ident" id="4317230"><a href="/gostd/mime/multipart/multipart.go.html#4317190">err</a></span>&nbsp;<span class="op" id="4317234">==</span>&nbsp;<span class="ident" id="4317237"><a href="/gostd/mime/multipart/multipart.go.html#4311325">io</a></span><span class="op" id="4317239">.</span><span class="ident" id="4317240"><a href="/gostd/io/io.go.html#1419950">EOF</a></span>&nbsp;<span class="op" id="4317244">&amp;&amp;</span>&nbsp;<span class="ident" id="4317247"><a href="/gostd/mime/multipart/multipart.go.html#4317057">r</a></span><span class="op" id="4317248">.</span><span class="ident" id="4317249"><a href="/gostd/mime/multipart/multipart.go.html#4318553">isFinalBoundary</a></span><span class="op" id="4317264">(</span><span class="ident" id="4317265"><a href="/gostd/mime/multipart/multipart.go.html#4317184">line</a></span><span class="op" id="4317269">)</span>&nbsp;<span class="op" id="4317271">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4317276">//&nbsp;If&nbsp;the&nbsp;buffer&nbsp;ends&nbsp;in&nbsp;&#34;--boundary--&#34;&nbsp;without&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4317331">//&nbsp;trailing&nbsp;&#34;\r\n&#34;,&nbsp;ReadSlice&nbsp;will&nbsp;return&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4317385">//&nbsp;(since&nbsp;it&#39;s&nbsp;missing&nbsp;the&nbsp;&#39;\n&#39;),&nbsp;but&nbsp;this&nbsp;is&nbsp;a&nbsp;valid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4317442">//&nbsp;multipart&nbsp;EOF&nbsp;so&nbsp;we&nbsp;need&nbsp;to&nbsp;return&nbsp;io.EOF&nbsp;instead&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4317501">//&nbsp;a&nbsp;fmt-wrapped&nbsp;one.</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4317526">return</span>&nbsp;<span class="builtintype" id="4317533">nil</span><span class="op" id="4317536">,</span>&nbsp;<span class="ident" id="4317538"><a href="/gostd/mime/multipart/multipart.go.html#4311325">io</a></span><span class="op" id="4317540">.</span><span class="ident" id="4317541"><a href="/gostd/io/io.go.html#1419950">EOF</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4317547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4317551">if</span>&nbsp;<span class="ident" id="4317554"><a href="/gostd/mime/multipart/multipart.go.html#4317190">err</a></span>&nbsp;<span class="op" id="4317558">!=</span>&nbsp;<span class="builtintype" id="4317561">nil</span>&nbsp;<span class="op" id="4317565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4317570">return</span>&nbsp;<span class="builtintype" id="4317577">nil</span><span class="op" id="4317580">,</span>&nbsp;<span class="ident" id="4317582"><a href="/gostd/mime/multipart/multipart.go.html#4311318">fmt</a></span><span class="op" id="4317585">.</span><span class="ident" id="4317586"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="4317592">(</span><span class="string" id="4317593">&#34;multipart:&nbsp;NextPart:&nbsp;%v&#34;</span><span class="op" id="4317618">,</span>&nbsp;<span class="ident" id="4317620"><a href="/gostd/mime/multipart/multipart.go.html#4317190">err</a></span><span class="op" id="4317623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4317627">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4317632">if</span>&nbsp;<span class="ident" id="4317635"><a href="/gostd/mime/multipart/multipart.go.html#4317057">r</a></span><span class="op" id="4317636">.</span><span class="ident" id="4317637"><a href="/gostd/mime/multipart/multipart.go.html#4318797">isBoundaryDelimiterLine</a></span><span class="op" id="4317660">(</span><span class="ident" id="4317661"><a href="/gostd/mime/multipart/multipart.go.html#4317184">line</a></span><span class="op" id="4317665">)</span>&nbsp;<span class="op" id="4317667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317672"><a href="/gostd/mime/multipart/multipart.go.html#4317057">r</a></span><span class="op" id="4317673">.</span><span class="ident" id="4317674"><a href="/gostd/mime/multipart/multipart.go.html#4316692">partsRead</a></span><span class="op" id="4317683">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317689">bp</span><span class="op" id="4317691">,</span>&nbsp;<span class="ident" id="4317693">err</span>&nbsp;<span class="op" id="4317697">:=</span>&nbsp;<span class="ident" id="4317700"><a href="/gostd/mime/multipart/multipart.go.html#4313622">newPart</a></span><span class="op" id="4317707">(</span><span class="ident" id="4317708"><a href="/gostd/mime/multipart/multipart.go.html#4317057">r</a></span><span class="op" id="4317709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4317714">if</span>&nbsp;<span class="ident" id="4317717"><a href="/gostd/mime/multipart/multipart.go.html#4317693">err</a></span>&nbsp;<span class="op" id="4317721">!=</span>&nbsp;<span class="builtintype" id="4317724">nil</span>&nbsp;<span class="op" id="4317728">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4317734">return</span>&nbsp;<span class="builtintype" id="4317741">nil</span><span class="op" id="4317744">,</span>&nbsp;<span class="ident" id="4317746"><a href="/gostd/mime/multipart/multipart.go.html#4317693">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4317753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4317758"><a href="/gostd/mime/multipart/multipart.go.html#4317057">r</a></span><span class="op" id="4317759">.</span><span class="ident" id="4317760"><a href="/gostd/mime/multipart/multipart.go.html#4316673">currentPart</a></span>&nbsp;<span class="op" id="4317772">=</span>&nbsp;<span class="ident" id="4317774"><a href="/gostd/mime/multipart/multipart.go.html#4317689">bp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4317780">return</span>&nbsp;<span class="ident" id="4317787"><a href="/gostd/mime/multipart/multipart.go.html#4317689">bp</a></span><span class="op" id="4317789">,</span>&nbsp;<span class="builtintype" id="4317791">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4317797">}</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4317802">if</span>&nbsp;<span class="ident" id="4317805"><a href="/gostd/mime/multipart/multipart.go.html#4317057">r</a></span><span class="op" id="4317806">.</span><span class="ident" id="4317807"><a href="/gostd/mime/multipart/multipart.go.html#4318553">isFinalBoundary</a></span><span class="op" id="4317822">(</span><span class="ident" id="4317823"><a href="/gostd/mime/multipart/multipart.go.html#4317184">line</a></span><span class="op" id="4317827">)</span>&nbsp;<span class="op" id="4317829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4317834">//&nbsp;Expected&nbsp;EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4317853">return</span>&nbsp;<span class="builtintype" id="4317860">nil</span><span class="op" id="4317863">,</span>&nbsp;<span class="ident" id="4317865"><a href="/gostd/mime/multipart/multipart.go.html#4311325">io</a></span><span class="op" id="4317867">.</span><span class="ident" id="4317868"><a href="/gostd/io/io.go.html#1419950">EOF</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4317874">}</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4317879">if</span>&nbsp;<span class="ident" id="4317882"><a href="/gostd/mime/multipart/multipart.go.html#4317152">expectNewPart</a></span>&nbsp;<span class="op" id="4317896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4317901">return</span>&nbsp;<span class="builtintype" id="4317908">nil</span><span class="op" id="4317911">,</span>&nbsp;<span class="ident" id="4317913"><a href="/gostd/mime/multipart/multipart.go.html#4311318">fmt</a></span><span class="op" id="4317916">.</span><span class="ident" id="4317917"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="4317923">(</span><span class="string" id="4317924">&#34;multipart:&nbsp;expecting&nbsp;a&nbsp;new&nbsp;Part;&nbsp;got&nbsp;line&nbsp;%q&#34;</span><span class="op" id="4317970">,</span>&nbsp;<span class="builtintype" id="4317972">string</span><span class="op" id="4317978">(</span><span class="ident" id="4317979"><a href="/gostd/mime/multipart/multipart.go.html#4317184">line</a></span><span class="op" id="4317983">)</span><span class="op" id="4317984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4317988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4317993">if</span>&nbsp;<span class="ident" id="4317996"><a href="/gostd/mime/multipart/multipart.go.html#4317057">r</a></span><span class="op" id="4317997">.</span><span class="ident" id="4317998"><a href="/gostd/mime/multipart/multipart.go.html#4316692">partsRead</a></span>&nbsp;<span class="op" id="4318008">==</span>&nbsp;<span class="num" id="4318011">0</span>&nbsp;<span class="op" id="4318013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4318018">//&nbsp;skip&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4318034">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4318045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4318050">//&nbsp;Consume&nbsp;the&nbsp;&#34;\n&#34;&nbsp;or&nbsp;&#34;\r\n&#34;&nbsp;separator&nbsp;between&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4318104">//&nbsp;body&nbsp;of&nbsp;the&nbsp;previous&nbsp;part&nbsp;and&nbsp;the&nbsp;boundary&nbsp;line&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4318160">//&nbsp;now&nbsp;expect&nbsp;will&nbsp;follow.&nbsp;(either&nbsp;a&nbsp;new&nbsp;part&nbsp;or&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4318215">//&nbsp;end&nbsp;boundary)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4318234">if</span>&nbsp;<span class="ident" id="4318237"><a href="/gostd/mime/multipart/multipart.go.html#4311309">bytes</a></span><span class="op" id="4318242">.</span><span class="ident" id="4318243"><a href="/gostd/bytes/bytes_decl.go.html#1414806">Equal</a></span><span class="op" id="4318248">(</span><span class="ident" id="4318249"><a href="/gostd/mime/multipart/multipart.go.html#4317184">line</a></span><span class="op" id="4318253">,</span>&nbsp;<span class="ident" id="4318255"><a href="/gostd/mime/multipart/multipart.go.html#4317057">r</a></span><span class="op" id="4318256">.</span><span class="ident" id="4318257"><a href="/gostd/mime/multipart/multipart.go.html#4316710">nl</a></span><span class="op" id="4318259">)</span>&nbsp;<span class="op" id="4318261">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318266"><a href="/gostd/mime/multipart/multipart.go.html#4317152">expectNewPart</a></span>&nbsp;<span class="op" id="4318280">=</span>&nbsp;<span class="builtintype" id="4318282">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4318290">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4318301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4318306">return</span>&nbsp;<span class="builtintype" id="4318313">nil</span><span class="op" id="4318316">,</span>&nbsp;<span class="ident" id="4318318"><a href="/gostd/mime/multipart/multipart.go.html#4311318">fmt</a></span><span class="op" id="4318321">.</span><span class="ident" id="4318322"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="4318328">(</span><span class="string" id="4318329">&#34;multipart:&nbsp;unexpected&nbsp;line&nbsp;in&nbsp;Next():&nbsp;%q&#34;</span><span class="op" id="4318371">,</span>&nbsp;<span class="ident" id="4318373"><a href="/gostd/mime/multipart/multipart.go.html#4317184">line</a></span><span class="op" id="4318377">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4318380">}</span><br>
<span class="lineno"></span><span class="op" id="4318382">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4318385">//&nbsp;isFinalBoundary&nbsp;reports&nbsp;whether&nbsp;line&nbsp;is&nbsp;the&nbsp;final&nbsp;boundary&nbsp;line</span><br>
<span class="lineno"></span><span class="comment" id="4318452">//&nbsp;indicating&nbsp;that&nbsp;all&nbsp;parts&nbsp;are&nbsp;over.</span><br>
<span class="lineno">280</span><span class="comment" id="4318491">//&nbsp;It&nbsp;matches&nbsp;`^--boundary--[&nbsp;\t]*(\r\n)?$`</span><br>
<span class="lineno"></span><span class="keyword" id="4318535">func</span>&nbsp;<span class="op" id="4318540">(</span><span class="ident" id="4318541">mr</span>&nbsp;<span class="op" id="4318544">*</span><span class="ident" id="4318545"><a href="/gostd/mime/multipart/multipart.go.html#4316630">Reader</a></span><span class="op" id="4318551">)</span>&nbsp;<span class="ident" id="4318553">isFinalBoundary</span><span class="op" id="4318568">(</span><span class="ident" id="4318569">line</span>&nbsp;<span class="op" id="4318574">[</span><span class="op" id="4318575">]</span><span class="builtintype" id="4318576">byte</span><span class="op" id="4318580">)</span>&nbsp;<span class="builtintype" id="4318582">bool</span>&nbsp;<span class="op" id="4318587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4318590">if</span>&nbsp;<span class="op" id="4318593">!</span><span class="ident" id="4318594"><a href="/gostd/mime/multipart/multipart.go.html#4311309">bytes</a></span><span class="op" id="4318599">.</span><span class="ident" id="4318600"><a href="/gostd/bytes/bytes.go.html#1403977">HasPrefix</a></span><span class="op" id="4318609">(</span><span class="ident" id="4318610"><a href="/gostd/mime/multipart/multipart.go.html#4318569">line</a></span><span class="op" id="4318614">,</span>&nbsp;<span class="ident" id="4318616"><a href="/gostd/mime/multipart/multipart.go.html#4318541">mr</a></span><span class="op" id="4318618">.</span><span class="ident" id="4318619"><a href="/gostd/mime/multipart/multipart.go.html#4316838">dashBoundaryDash</a></span><span class="op" id="4318635">)</span>&nbsp;<span class="op" id="4318637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4318641">return</span>&nbsp;<span class="builtintype" id="4318648">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4318655">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318658">rest</span>&nbsp;<span class="op" id="4318663">:=</span>&nbsp;<span class="ident" id="4318666"><a href="/gostd/mime/multipart/multipart.go.html#4318569">line</a></span><span class="op" id="4318670">[</span><span class="builtinfunc" id="4318671">len</span><span class="op" id="4318674">(</span><span class="ident" id="4318675"><a href="/gostd/mime/multipart/multipart.go.html#4318541">mr</a></span><span class="op" id="4318677">.</span><span class="ident" id="4318678"><a href="/gostd/mime/multipart/multipart.go.html#4316838">dashBoundaryDash</a></span><span class="op" id="4318694">)</span><span class="op" id="4318695">:</span><span class="op" id="4318696">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4318699"><a href="/gostd/mime/multipart/multipart.go.html#4318658">rest</a></span>&nbsp;<span class="op" id="4318704">=</span>&nbsp;<span class="ident" id="4318706"><a href="/gostd/mime/multipart/multipart.go.html#4320831">skipLWSPChar</a></span><span class="op" id="4318718">(</span><span class="ident" id="4318719"><a href="/gostd/mime/multipart/multipart.go.html#4318658">rest</a></span><span class="op" id="4318723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4318726">return</span>&nbsp;<span class="builtinfunc" id="4318733">len</span><span class="op" id="4318736">(</span><span class="ident" id="4318737"><a href="/gostd/mime/multipart/multipart.go.html#4318658">rest</a></span><span class="op" id="4318741">)</span>&nbsp;<span class="op" id="4318743">==</span>&nbsp;<span class="num" id="4318746">0</span>&nbsp;<span class="op" id="4318748">||</span>&nbsp;<span class="ident" id="4318751"><a href="/gostd/mime/multipart/multipart.go.html#4311309">bytes</a></span><span class="op" id="4318756">.</span><span class="ident" id="4318757"><a href="/gostd/bytes/bytes_decl.go.html#1414806">Equal</a></span><span class="op" id="4318762">(</span><span class="ident" id="4318763"><a href="/gostd/mime/multipart/multipart.go.html#4318658">rest</a></span><span class="op" id="4318767">,</span>&nbsp;<span class="ident" id="4318769"><a href="/gostd/mime/multipart/multipart.go.html#4318541">mr</a></span><span class="op" id="4318771">.</span><span class="ident" id="4318772"><a href="/gostd/mime/multipart/multipart.go.html#4316710">nl</a></span><span class="op" id="4318774">)</span><br>
<span class="lineno"></span><span class="op" id="4318776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span><span class="keyword" id="4318779">func</span>&nbsp;<span class="op" id="4318784">(</span><span class="ident" id="4318785">mr</span>&nbsp;<span class="op" id="4318788">*</span><span class="ident" id="4318789"><a href="/gostd/mime/multipart/multipart.go.html#4316630">Reader</a></span><span class="op" id="4318795">)</span>&nbsp;<span class="ident" id="4318797">isBoundaryDelimiterLine</span><span class="op" id="4318820">(</span><span class="ident" id="4318821">line</span>&nbsp;<span class="op" id="4318826">[</span><span class="op" id="4318827">]</span><span class="builtintype" id="4318828">byte</span><span class="op" id="4318832">)</span>&nbsp;<span class="op" id="4318834">(</span><span class="ident" id="4318835">ret</span>&nbsp;<span class="builtintype" id="4318839">bool</span><span class="op" id="4318843">)</span>&nbsp;<span class="op" id="4318845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4318848">//&nbsp;http://tools.ietf.org/html/rfc2046#section-5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4318899">//&nbsp;&nbsp;&nbsp;The&nbsp;boundary&nbsp;delimiter&nbsp;line&nbsp;is&nbsp;then&nbsp;defined&nbsp;as&nbsp;a&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4318959">//&nbsp;&nbsp;&nbsp;consisting&nbsp;entirely&nbsp;of&nbsp;two&nbsp;hyphen&nbsp;characters&nbsp;(&#34;-&#34;,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4319016">//&nbsp;&nbsp;&nbsp;decimal&nbsp;value&nbsp;45)&nbsp;followed&nbsp;by&nbsp;the&nbsp;boundary&nbsp;parameter</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4319075">//&nbsp;&nbsp;&nbsp;value&nbsp;from&nbsp;the&nbsp;Content-Type&nbsp;header&nbsp;field,&nbsp;optional&nbsp;linear</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4319139">//&nbsp;&nbsp;&nbsp;whitespace,&nbsp;and&nbsp;a&nbsp;terminating&nbsp;CRLF.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4319181">if</span>&nbsp;<span class="op" id="4319184">!</span><span class="ident" id="4319185"><a href="/gostd/mime/multipart/multipart.go.html#4311309">bytes</a></span><span class="op" id="4319190">.</span><span class="ident" id="4319191"><a href="/gostd/bytes/bytes.go.html#1403977">HasPrefix</a></span><span class="op" id="4319200">(</span><span class="ident" id="4319201"><a href="/gostd/mime/multipart/multipart.go.html#4318821">line</a></span><span class="op" id="4319205">,</span>&nbsp;<span class="ident" id="4319207"><a href="/gostd/mime/multipart/multipart.go.html#4318785">mr</a></span><span class="op" id="4319209">.</span><span class="ident" id="4319210"><a href="/gostd/mime/multipart/multipart.go.html#4316881">dashBoundary</a></span><span class="op" id="4319222">)</span>&nbsp;<span class="op" id="4319224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4319228">return</span>&nbsp;<span class="builtintype" id="4319235">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4319242">}</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319245">rest</span>&nbsp;<span class="op" id="4319250">:=</span>&nbsp;<span class="ident" id="4319253"><a href="/gostd/mime/multipart/multipart.go.html#4318821">line</a></span><span class="op" id="4319257">[</span><span class="builtinfunc" id="4319258">len</span><span class="op" id="4319261">(</span><span class="ident" id="4319262"><a href="/gostd/mime/multipart/multipart.go.html#4318785">mr</a></span><span class="op" id="4319264">.</span><span class="ident" id="4319265"><a href="/gostd/mime/multipart/multipart.go.html#4316881">dashBoundary</a></span><span class="op" id="4319277">)</span><span class="op" id="4319278">:</span><span class="op" id="4319279">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319282"><a href="/gostd/mime/multipart/multipart.go.html#4319245">rest</a></span>&nbsp;<span class="op" id="4319287">=</span>&nbsp;<span class="ident" id="4319289"><a href="/gostd/mime/multipart/multipart.go.html#4320831">skipLWSPChar</a></span><span class="op" id="4319301">(</span><span class="ident" id="4319302"><a href="/gostd/mime/multipart/multipart.go.html#4319245">rest</a></span><span class="op" id="4319306">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4319310">//&nbsp;On&nbsp;the&nbsp;first&nbsp;part,&nbsp;see&nbsp;our&nbsp;lines&nbsp;are&nbsp;ending&nbsp;in&nbsp;\n&nbsp;instead&nbsp;of&nbsp;\r\n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4319380">//&nbsp;and&nbsp;switch&nbsp;into&nbsp;that&nbsp;mode&nbsp;if&nbsp;so.&nbsp;&nbsp;This&nbsp;is&nbsp;a&nbsp;violation&nbsp;of&nbsp;the&nbsp;spec,</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4319451">//&nbsp;but&nbsp;occurs&nbsp;in&nbsp;practice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4319479">if</span>&nbsp;<span class="ident" id="4319482"><a href="/gostd/mime/multipart/multipart.go.html#4318785">mr</a></span><span class="op" id="4319484">.</span><span class="ident" id="4319485"><a href="/gostd/mime/multipart/multipart.go.html#4316692">partsRead</a></span>&nbsp;<span class="op" id="4319495">==</span>&nbsp;<span class="num" id="4319498">0</span>&nbsp;<span class="op" id="4319500">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4319503">len</span><span class="op" id="4319506">(</span><span class="ident" id="4319507"><a href="/gostd/mime/multipart/multipart.go.html#4319245">rest</a></span><span class="op" id="4319511">)</span>&nbsp;<span class="op" id="4319513">==</span>&nbsp;<span class="num" id="4319516">1</span>&nbsp;<span class="op" id="4319518">&amp;&amp;</span>&nbsp;<span class="ident" id="4319521"><a href="/gostd/mime/multipart/multipart.go.html#4319245">rest</a></span><span class="op" id="4319525">[</span><span class="num" id="4319526">0</span><span class="op" id="4319527">]</span>&nbsp;<span class="op" id="4319529">==</span>&nbsp;<span class="string" id="4319532">&#39;\n&#39;</span>&nbsp;<span class="op" id="4319537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319541"><a href="/gostd/mime/multipart/multipart.go.html#4318785">mr</a></span><span class="op" id="4319543">.</span><span class="ident" id="4319544"><a href="/gostd/mime/multipart/multipart.go.html#4316710">nl</a></span>&nbsp;<span class="op" id="4319547">=</span>&nbsp;<span class="ident" id="4319549"><a href="/gostd/mime/multipart/multipart.go.html#4318785">mr</a></span><span class="op" id="4319551">.</span><span class="ident" id="4319552"><a href="/gostd/mime/multipart/multipart.go.html#4316710">nl</a></span><span class="op" id="4319554">[</span><span class="num" id="4319555">1</span><span class="op" id="4319556">:</span><span class="op" id="4319557">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4319561"><a href="/gostd/mime/multipart/multipart.go.html#4318785">mr</a></span><span class="op" id="4319563">.</span><span class="ident" id="4319564"><a href="/gostd/mime/multipart/multipart.go.html#4316792">nlDashBoundary</a></span>&nbsp;<span class="op" id="4319579">=</span>&nbsp;<span class="ident" id="4319581"><a href="/gostd/mime/multipart/multipart.go.html#4318785">mr</a></span><span class="op" id="4319583">.</span><span class="ident" id="4319584"><a href="/gostd/mime/multipart/multipart.go.html#4316792">nlDashBoundary</a></span><span class="op" id="4319598">[</span><span class="num" id="4319599">1</span><span class="op" id="4319600">:</span><span class="op" id="4319601">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4319604">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4319607">return</span>&nbsp;<span class="ident" id="4319614"><a href="/gostd/mime/multipart/multipart.go.html#4311309">bytes</a></span><span class="op" id="4319619">.</span><span class="ident" id="4319620"><a href="/gostd/bytes/bytes_decl.go.html#1414806">Equal</a></span><span class="op" id="4319625">(</span><span class="ident" id="4319626"><a href="/gostd/mime/multipart/multipart.go.html#4319245">rest</a></span><span class="op" id="4319630">,</span>&nbsp;<span class="ident" id="4319632"><a href="/gostd/mime/multipart/multipart.go.html#4318785">mr</a></span><span class="op" id="4319634">.</span><span class="ident" id="4319635"><a href="/gostd/mime/multipart/multipart.go.html#4316710">nl</a></span><span class="op" id="4319637">)</span><br>
<span class="lineno"></span><span class="op" id="4319639">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4319642">//&nbsp;peekBufferIsEmptyPart&nbsp;reports&nbsp;whether&nbsp;the&nbsp;provided&nbsp;peek-ahead</span><br>
<span class="lineno"></span><span class="comment" id="4319707">//&nbsp;buffer&nbsp;represents&nbsp;an&nbsp;empty&nbsp;part.&nbsp;It&nbsp;is&nbsp;called&nbsp;only&nbsp;if&nbsp;we&#39;ve&nbsp;not</span><br>
<span class="lineno">315</span><span class="comment" id="4319774">//&nbsp;already&nbsp;read&nbsp;any&nbsp;bytes&nbsp;in&nbsp;this&nbsp;part&nbsp;and&nbsp;checks&nbsp;for&nbsp;the&nbsp;case&nbsp;of&nbsp;MIME</span><br>
<span class="lineno"></span><span class="comment" id="4319845">//&nbsp;software&nbsp;not&nbsp;writing&nbsp;the&nbsp;\r\n&nbsp;on&nbsp;empty&nbsp;parts.&nbsp;Some&nbsp;does,&nbsp;some</span><br>
<span class="lineno"></span><span class="comment" id="4319910">//&nbsp;doesn&#39;t.</span><br>
<span class="lineno"></span><span class="comment" id="4319922">//</span><br>
<span class="lineno"></span><span class="comment" id="4319925">//&nbsp;This&nbsp;checks&nbsp;that&nbsp;what&nbsp;follows&nbsp;the&nbsp;&#34;--boundary&#34;&nbsp;is&nbsp;actually&nbsp;the&nbsp;end</span><br>
<span class="lineno">320</span><span class="comment" id="4319995">//&nbsp;(&#34;--boundary--&#34;&nbsp;with&nbsp;optional&nbsp;whitespace)&nbsp;or&nbsp;optional&nbsp;whitespace</span><br>
<span class="lineno"></span><span class="comment" id="4320063">//&nbsp;and&nbsp;then&nbsp;a&nbsp;newline,&nbsp;so&nbsp;we&nbsp;don&#39;t&nbsp;catch&nbsp;&#34;--boundaryFAKE&#34;,&nbsp;in&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="4320131">//&nbsp;case&nbsp;the&nbsp;whole&nbsp;line&nbsp;is&nbsp;part&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4320175">func</span>&nbsp;<span class="op" id="4320180">(</span><span class="ident" id="4320181">mr</span>&nbsp;<span class="op" id="4320184">*</span><span class="ident" id="4320185"><a href="/gostd/mime/multipart/multipart.go.html#4316630">Reader</a></span><span class="op" id="4320191">)</span>&nbsp;<span class="ident" id="4320193">peekBufferIsEmptyPart</span><span class="op" id="4320214">(</span><span class="ident" id="4320215">peek</span>&nbsp;<span class="op" id="4320220">[</span><span class="op" id="4320221">]</span><span class="builtintype" id="4320222">byte</span><span class="op" id="4320226">)</span>&nbsp;<span class="builtintype" id="4320228">bool</span>&nbsp;<span class="op" id="4320233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4320236">//&nbsp;End&nbsp;of&nbsp;parts&nbsp;case.</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4320259">//&nbsp;Test&nbsp;whether&nbsp;peek&nbsp;matches&nbsp;`^--boundary--[&nbsp;\t]*(?:\r\n|$)`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4320321">if</span>&nbsp;<span class="ident" id="4320324"><a href="/gostd/mime/multipart/multipart.go.html#4311309">bytes</a></span><span class="op" id="4320329">.</span><span class="ident" id="4320330"><a href="/gostd/bytes/bytes.go.html#1403977">HasPrefix</a></span><span class="op" id="4320339">(</span><span class="ident" id="4320340"><a href="/gostd/mime/multipart/multipart.go.html#4320215">peek</a></span><span class="op" id="4320344">,</span>&nbsp;<span class="ident" id="4320346"><a href="/gostd/mime/multipart/multipart.go.html#4320181">mr</a></span><span class="op" id="4320348">.</span><span class="ident" id="4320349"><a href="/gostd/mime/multipart/multipart.go.html#4316838">dashBoundaryDash</a></span><span class="op" id="4320365">)</span>&nbsp;<span class="op" id="4320367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4320371">rest</span>&nbsp;<span class="op" id="4320376">:=</span>&nbsp;<span class="ident" id="4320379"><a href="/gostd/mime/multipart/multipart.go.html#4320215">peek</a></span><span class="op" id="4320383">[</span><span class="builtinfunc" id="4320384">len</span><span class="op" id="4320387">(</span><span class="ident" id="4320388"><a href="/gostd/mime/multipart/multipart.go.html#4320181">mr</a></span><span class="op" id="4320390">.</span><span class="ident" id="4320391"><a href="/gostd/mime/multipart/multipart.go.html#4316838">dashBoundaryDash</a></span><span class="op" id="4320407">)</span><span class="op" id="4320408">:</span><span class="op" id="4320409">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4320413"><a href="/gostd/mime/multipart/multipart.go.html#4320371">rest</a></span>&nbsp;<span class="op" id="4320418">=</span>&nbsp;<span class="ident" id="4320420"><a href="/gostd/mime/multipart/multipart.go.html#4320831">skipLWSPChar</a></span><span class="op" id="4320432">(</span><span class="ident" id="4320433"><a href="/gostd/mime/multipart/multipart.go.html#4320371">rest</a></span><span class="op" id="4320437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4320441">return</span>&nbsp;<span class="ident" id="4320448"><a href="/gostd/mime/multipart/multipart.go.html#4311309">bytes</a></span><span class="op" id="4320453">.</span><span class="ident" id="4320454"><a href="/gostd/bytes/bytes.go.html#1403977">HasPrefix</a></span><span class="op" id="4320463">(</span><span class="ident" id="4320464"><a href="/gostd/mime/multipart/multipart.go.html#4320371">rest</a></span><span class="op" id="4320468">,</span>&nbsp;<span class="ident" id="4320470"><a href="/gostd/mime/multipart/multipart.go.html#4320181">mr</a></span><span class="op" id="4320472">.</span><span class="ident" id="4320473"><a href="/gostd/mime/multipart/multipart.go.html#4316710">nl</a></span><span class="op" id="4320475">)</span>&nbsp;<span class="op" id="4320477">||</span>&nbsp;<span class="builtinfunc" id="4320480">len</span><span class="op" id="4320483">(</span><span class="ident" id="4320484"><a href="/gostd/mime/multipart/multipart.go.html#4320371">rest</a></span><span class="op" id="4320488">)</span>&nbsp;<span class="op" id="4320490">==</span>&nbsp;<span class="num" id="4320493">0</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4320496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4320499">if</span>&nbsp;<span class="op" id="4320502">!</span><span class="ident" id="4320503"><a href="/gostd/mime/multipart/multipart.go.html#4311309">bytes</a></span><span class="op" id="4320508">.</span><span class="ident" id="4320509"><a href="/gostd/bytes/bytes.go.html#1403977">HasPrefix</a></span><span class="op" id="4320518">(</span><span class="ident" id="4320519"><a href="/gostd/mime/multipart/multipart.go.html#4320215">peek</a></span><span class="op" id="4320523">,</span>&nbsp;<span class="ident" id="4320525"><a href="/gostd/mime/multipart/multipart.go.html#4320181">mr</a></span><span class="op" id="4320527">.</span><span class="ident" id="4320528"><a href="/gostd/mime/multipart/multipart.go.html#4316881">dashBoundary</a></span><span class="op" id="4320540">)</span>&nbsp;<span class="op" id="4320542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4320546">return</span>&nbsp;<span class="builtintype" id="4320553">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4320560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4320563">//&nbsp;Test&nbsp;whether&nbsp;rest&nbsp;matches&nbsp;`^[&nbsp;\t]*\r\n`)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4320608">rest</span>&nbsp;<span class="op" id="4320613">:=</span>&nbsp;<span class="ident" id="4320616"><a href="/gostd/mime/multipart/multipart.go.html#4320215">peek</a></span><span class="op" id="4320620">[</span><span class="builtinfunc" id="4320621">len</span><span class="op" id="4320624">(</span><span class="ident" id="4320625"><a href="/gostd/mime/multipart/multipart.go.html#4320181">mr</a></span><span class="op" id="4320627">.</span><span class="ident" id="4320628"><a href="/gostd/mime/multipart/multipart.go.html#4316881">dashBoundary</a></span><span class="op" id="4320640">)</span><span class="op" id="4320641">:</span><span class="op" id="4320642">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4320645"><a href="/gostd/mime/multipart/multipart.go.html#4320608">rest</a></span>&nbsp;<span class="op" id="4320650">=</span>&nbsp;<span class="ident" id="4320652"><a href="/gostd/mime/multipart/multipart.go.html#4320831">skipLWSPChar</a></span><span class="op" id="4320664">(</span><span class="ident" id="4320665"><a href="/gostd/mime/multipart/multipart.go.html#4320608">rest</a></span><span class="op" id="4320669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4320672">return</span>&nbsp;<span class="ident" id="4320679"><a href="/gostd/mime/multipart/multipart.go.html#4311309">bytes</a></span><span class="op" id="4320684">.</span><span class="ident" id="4320685"><a href="/gostd/bytes/bytes.go.html#1403977">HasPrefix</a></span><span class="op" id="4320694">(</span><span class="ident" id="4320695"><a href="/gostd/mime/multipart/multipart.go.html#4320608">rest</a></span><span class="op" id="4320699">,</span>&nbsp;<span class="ident" id="4320701"><a href="/gostd/mime/multipart/multipart.go.html#4320181">mr</a></span><span class="op" id="4320703">.</span><span class="ident" id="4320704"><a href="/gostd/mime/multipart/multipart.go.html#4316710">nl</a></span><span class="op" id="4320706">)</span><br>
<span class="lineno"></span><span class="op" id="4320708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="comment" id="4320711">//&nbsp;skipLWSPChar&nbsp;returns&nbsp;b&nbsp;with&nbsp;leading&nbsp;spaces&nbsp;and&nbsp;tabs&nbsp;removed.</span><br>
<span class="lineno"></span><span class="comment" id="4320775">//&nbsp;RFC&nbsp;822&nbsp;defines:</span><br>
<span class="lineno"></span><span class="comment" id="4320795">//&nbsp;&nbsp;&nbsp;&nbsp;LWSP-char&nbsp;=&nbsp;SPACE&nbsp;/&nbsp;HTAB</span><br>
<span class="lineno"></span><span class="keyword" id="4320826">func</span>&nbsp;<span class="ident" id="4320831">skipLWSPChar</span><span class="op" id="4320843">(</span><span class="ident" id="4320844">b</span>&nbsp;<span class="op" id="4320846">[</span><span class="op" id="4320847">]</span><span class="builtintype" id="4320848">byte</span><span class="op" id="4320852">)</span>&nbsp;<span class="op" id="4320854">[</span><span class="op" id="4320855">]</span><span class="builtintype" id="4320856">byte</span>&nbsp;<span class="op" id="4320861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4320864">for</span>&nbsp;<span class="builtinfunc" id="4320868">len</span><span class="op" id="4320871">(</span><span class="ident" id="4320872"><a href="/gostd/mime/multipart/multipart.go.html#4320844">b</a></span><span class="op" id="4320873">)</span>&nbsp;<span class="op" id="4320875">&gt;</span>&nbsp;<span class="num" id="4320877">0</span>&nbsp;<span class="op" id="4320879">&amp;&amp;</span>&nbsp;<span class="op" id="4320882">(</span><span class="ident" id="4320883"><a href="/gostd/mime/multipart/multipart.go.html#4320844">b</a></span><span class="op" id="4320884">[</span><span class="num" id="4320885">0</span><span class="op" id="4320886">]</span>&nbsp;<span class="op" id="4320888">==</span>&nbsp;<span class="string" id="4320891">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4320895">||</span>&nbsp;<span class="ident" id="4320898"><a href="/gostd/mime/multipart/multipart.go.html#4320844">b</a></span><span class="op" id="4320899">[</span><span class="num" id="4320900">0</span><span class="op" id="4320901">]</span>&nbsp;<span class="op" id="4320903">==</span>&nbsp;<span class="string" id="4320906">&#39;\t&#39;</span><span class="op" id="4320910">)</span>&nbsp;<span class="op" id="4320912">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4320916"><a href="/gostd/mime/multipart/multipart.go.html#4320844">b</a></span>&nbsp;<span class="op" id="4320918">=</span>&nbsp;<span class="ident" id="4320920"><a href="/gostd/mime/multipart/multipart.go.html#4320844">b</a></span><span class="op" id="4320921">[</span><span class="num" id="4320922">1</span><span class="op" id="4320923">:</span><span class="op" id="4320924">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4320927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4320930">return</span>&nbsp;<span class="ident" id="4320937"><a href="/gostd/mime/multipart/multipart.go.html#4320844">b</a></span><br>
<span class="lineno"></span><span class="op" id="4320939">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
