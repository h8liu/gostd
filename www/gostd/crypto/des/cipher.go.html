<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/des</h2>
<ul>
<li><a href="/gostd/crypto/des/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/des/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/des/const.go.html">const.go</a></li>
<li><a href="/gostd/crypto/des/des_test.go.html">des_test.go</a></li>
<li><a href="/gostd/crypto/des/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4224263">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4224318">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4224372">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4224423">package</span>&nbsp;<span class="ident" id="4224431">des</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4224436">import</span>&nbsp;<span class="op" id="4224443">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4224446">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4224463">&#34;strconv&#34;</span><br>
<span class="lineno">10</span><span class="op" id="4224473">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4224476">//&nbsp;The&nbsp;DES&nbsp;block&nbsp;size&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4224508">const</span>&nbsp;<span class="ident" id="4224514">BlockSize</span>&nbsp;<span class="op" id="4224524">=</span>&nbsp;<span class="num" id="4224526">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="4224529">type</span>&nbsp;<span class="ident" id="4224534">KeySizeError</span>&nbsp;<span class="builtintype" id="4224547">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4224552">func</span>&nbsp;<span class="op" id="4224557">(</span><span class="ident" id="4224558">k</span>&nbsp;<span class="ident" id="4224560">KeySizeError</span><span class="op" id="4224572">)</span>&nbsp;<span class="ident" id="4224574">Error</span><span class="op" id="4224579">(</span><span class="op" id="4224580">)</span>&nbsp;<span class="builtintype" id="4224582">string</span>&nbsp;<span class="op" id="4224589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224592">return</span>&nbsp;<span class="string" id="4224599">&#34;crypto/des:&nbsp;invalid&nbsp;key&nbsp;size&nbsp;&#34;</span>&nbsp;<span class="op" id="4224631">+</span>&nbsp;<span class="ident" id="4224633">strconv</span><span class="op" id="4224640">.</span><span class="ident" id="4224641">Itoa</span><span class="op" id="4224645">(</span><span class="builtintype" id="4224646">int</span><span class="op" id="4224649">(</span><span class="ident" id="4224650">k</span><span class="op" id="4224651">)</span><span class="op" id="4224652">)</span><br>
<span class="lineno"></span><span class="op" id="4224654">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="4224657">//&nbsp;desCipher&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;DES&nbsp;encryption.</span><br>
<span class="lineno"></span><span class="keyword" id="4224704">type</span>&nbsp;<span class="ident" id="4224709">desCipher</span>&nbsp;<span class="keyword" id="4224719">struct</span>&nbsp;<span class="op" id="4224726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224729">subkeys</span>&nbsp;<span class="op" id="4224737">[</span><span class="num" id="4224738">16</span><span class="op" id="4224740">]</span><span class="ident" id="4224741">uint64</span><br>
<span class="lineno"></span><span class="op" id="4224748">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="4224751">//&nbsp;NewCipher&nbsp;creates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;cipher.Block.</span><br>
<span class="lineno"></span><span class="keyword" id="4224804">func</span>&nbsp;<span class="ident" id="4224809">NewCipher</span><span class="op" id="4224818">(</span><span class="ident" id="4224819">key</span>&nbsp;<span class="op" id="4224823">[</span><span class="op" id="4224824">]</span><span class="builtintype" id="4224825">byte</span><span class="op" id="4224829">)</span>&nbsp;<span class="op" id="4224831">(</span><span class="ident" id="4224832">cipher</span><span class="op" id="4224838">.</span><span class="ident" id="4224839">Block</span><span class="op" id="4224844">,</span>&nbsp;<span class="builtintype" id="4224846">error</span><span class="op" id="4224851">)</span>&nbsp;<span class="op" id="4224853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224856">if</span>&nbsp;<span class="builtinfunc" id="4224859">len</span><span class="op" id="4224862">(</span><span class="ident" id="4224863">key</span><span class="op" id="4224866">)</span>&nbsp;<span class="op" id="4224868">!=</span>&nbsp;<span class="num" id="4224871">8</span>&nbsp;<span class="op" id="4224873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224877">return</span>&nbsp;<span class="ident" id="4224884">nil</span><span class="op" id="4224887">,</span>&nbsp;<span class="ident" id="4224889">KeySizeError</span><span class="op" id="4224901">(</span><span class="builtinfunc" id="4224902">len</span><span class="op" id="4224905">(</span><span class="ident" id="4224906">key</span><span class="op" id="4224909">)</span><span class="op" id="4224910">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4224913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224917">c</span>&nbsp;<span class="op" id="4224919">:=</span>&nbsp;<span class="builtinfunc" id="4224922">new</span><span class="op" id="4224925">(</span><span class="ident" id="4224926">desCipher</span><span class="op" id="4224935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224938">c</span><span class="op" id="4224939">.</span><span class="ident" id="4224940">generateSubkeys</span><span class="op" id="4224955">(</span><span class="ident" id="4224956">key</span><span class="op" id="4224959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224962">return</span>&nbsp;<span class="ident" id="4224969">c</span><span class="op" id="4224970">,</span>&nbsp;<span class="ident" id="4224972">nil</span><br>
<span class="lineno">35</span><span class="op" id="4224976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4224979">func</span>&nbsp;<span class="op" id="4224984">(</span><span class="ident" id="4224985">c</span>&nbsp;<span class="op" id="4224987">*</span><span class="ident" id="4224988">desCipher</span><span class="op" id="4224997">)</span>&nbsp;<span class="ident" id="4224999">BlockSize</span><span class="op" id="4225008">(</span><span class="op" id="4225009">)</span>&nbsp;<span class="builtintype" id="4225011">int</span>&nbsp;<span class="op" id="4225015">{</span>&nbsp;<span class="keyword" id="4225017">return</span>&nbsp;<span class="ident" id="4225024">BlockSize</span>&nbsp;<span class="op" id="4225034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4225037">func</span>&nbsp;<span class="op" id="4225042">(</span><span class="ident" id="4225043">c</span>&nbsp;<span class="op" id="4225045">*</span><span class="ident" id="4225046">desCipher</span><span class="op" id="4225055">)</span>&nbsp;<span class="ident" id="4225057">Encrypt</span><span class="op" id="4225064">(</span><span class="ident" id="4225065">dst</span><span class="op" id="4225068">,</span>&nbsp;<span class="ident" id="4225070">src</span>&nbsp;<span class="op" id="4225074">[</span><span class="op" id="4225075">]</span><span class="builtintype" id="4225076">byte</span><span class="op" id="4225080">)</span>&nbsp;<span class="op" id="4225082">{</span>&nbsp;<span class="ident" id="4225084">encryptBlock</span><span class="op" id="4225096">(</span><span class="ident" id="4225097">c</span><span class="op" id="4225098">.</span><span class="ident" id="4225099">subkeys</span><span class="op" id="4225106">[</span><span class="op" id="4225107">:</span><span class="op" id="4225108">]</span><span class="op" id="4225109">,</span>&nbsp;<span class="ident" id="4225111">dst</span><span class="op" id="4225114">,</span>&nbsp;<span class="ident" id="4225116">src</span><span class="op" id="4225119">)</span>&nbsp;<span class="op" id="4225121">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="4225124">func</span>&nbsp;<span class="op" id="4225129">(</span><span class="ident" id="4225130">c</span>&nbsp;<span class="op" id="4225132">*</span><span class="ident" id="4225133">desCipher</span><span class="op" id="4225142">)</span>&nbsp;<span class="ident" id="4225144">Decrypt</span><span class="op" id="4225151">(</span><span class="ident" id="4225152">dst</span><span class="op" id="4225155">,</span>&nbsp;<span class="ident" id="4225157">src</span>&nbsp;<span class="op" id="4225161">[</span><span class="op" id="4225162">]</span><span class="builtintype" id="4225163">byte</span><span class="op" id="4225167">)</span>&nbsp;<span class="op" id="4225169">{</span>&nbsp;<span class="ident" id="4225171">decryptBlock</span><span class="op" id="4225183">(</span><span class="ident" id="4225184">c</span><span class="op" id="4225185">.</span><span class="ident" id="4225186">subkeys</span><span class="op" id="4225193">[</span><span class="op" id="4225194">:</span><span class="op" id="4225195">]</span><span class="op" id="4225196">,</span>&nbsp;<span class="ident" id="4225198">dst</span><span class="op" id="4225201">,</span>&nbsp;<span class="ident" id="4225203">src</span><span class="op" id="4225206">)</span>&nbsp;<span class="op" id="4225208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4225211">//&nbsp;A&nbsp;tripleDESCipher&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;TripleDES&nbsp;encryption.</span><br>
<span class="lineno"></span><span class="keyword" id="4225272">type</span>&nbsp;<span class="ident" id="4225277">tripleDESCipher</span>&nbsp;<span class="keyword" id="4225293">struct</span>&nbsp;<span class="op" id="4225300">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225303">cipher1</span><span class="op" id="4225310">,</span>&nbsp;<span class="ident" id="4225312">cipher2</span><span class="op" id="4225319">,</span>&nbsp;<span class="ident" id="4225321">cipher3</span>&nbsp;<span class="ident" id="4225329">desCipher</span><br>
<span class="lineno"></span><span class="op" id="4225339">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4225342">//&nbsp;NewTripleDESCipher&nbsp;creates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;cipher.Block.</span><br>
<span class="lineno"></span><span class="keyword" id="4225404">func</span>&nbsp;<span class="ident" id="4225409">NewTripleDESCipher</span><span class="op" id="4225427">(</span><span class="ident" id="4225428">key</span>&nbsp;<span class="op" id="4225432">[</span><span class="op" id="4225433">]</span><span class="builtintype" id="4225434">byte</span><span class="op" id="4225438">)</span>&nbsp;<span class="op" id="4225440">(</span><span class="ident" id="4225441">cipher</span><span class="op" id="4225447">.</span><span class="ident" id="4225448">Block</span><span class="op" id="4225453">,</span>&nbsp;<span class="builtintype" id="4225455">error</span><span class="op" id="4225460">)</span>&nbsp;<span class="op" id="4225462">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225465">if</span>&nbsp;<span class="builtinfunc" id="4225468">len</span><span class="op" id="4225471">(</span><span class="ident" id="4225472">key</span><span class="op" id="4225475">)</span>&nbsp;<span class="op" id="4225477">!=</span>&nbsp;<span class="num" id="4225480">24</span>&nbsp;<span class="op" id="4225483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225487">return</span>&nbsp;<span class="ident" id="4225494">nil</span><span class="op" id="4225497">,</span>&nbsp;<span class="ident" id="4225499">KeySizeError</span><span class="op" id="4225511">(</span><span class="builtinfunc" id="4225512">len</span><span class="op" id="4225515">(</span><span class="ident" id="4225516">key</span><span class="op" id="4225519">)</span><span class="op" id="4225520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4225523">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225527">c</span>&nbsp;<span class="op" id="4225529">:=</span>&nbsp;<span class="builtinfunc" id="4225532">new</span><span class="op" id="4225535">(</span><span class="ident" id="4225536">tripleDESCipher</span><span class="op" id="4225551">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225554">c</span><span class="op" id="4225555">.</span><span class="ident" id="4225556">cipher1</span><span class="op" id="4225563">.</span><span class="ident" id="4225564">generateSubkeys</span><span class="op" id="4225579">(</span><span class="ident" id="4225580">key</span><span class="op" id="4225583">[</span><span class="op" id="4225584">:</span><span class="num" id="4225585">8</span><span class="op" id="4225586">]</span><span class="op" id="4225587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225590">c</span><span class="op" id="4225591">.</span><span class="ident" id="4225592">cipher2</span><span class="op" id="4225599">.</span><span class="ident" id="4225600">generateSubkeys</span><span class="op" id="4225615">(</span><span class="ident" id="4225616">key</span><span class="op" id="4225619">[</span><span class="num" id="4225620">8</span><span class="op" id="4225621">:</span><span class="num" id="4225622">16</span><span class="op" id="4225624">]</span><span class="op" id="4225625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225628">c</span><span class="op" id="4225629">.</span><span class="ident" id="4225630">cipher3</span><span class="op" id="4225637">.</span><span class="ident" id="4225638">generateSubkeys</span><span class="op" id="4225653">(</span><span class="ident" id="4225654">key</span><span class="op" id="4225657">[</span><span class="num" id="4225658">16</span><span class="op" id="4225660">:</span><span class="op" id="4225661">]</span><span class="op" id="4225662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225665">return</span>&nbsp;<span class="ident" id="4225672">c</span><span class="op" id="4225673">,</span>&nbsp;<span class="ident" id="4225675">nil</span><br>
<span class="lineno"></span><span class="op" id="4225679">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="4225682">func</span>&nbsp;<span class="op" id="4225687">(</span><span class="ident" id="4225688">c</span>&nbsp;<span class="op" id="4225690">*</span><span class="ident" id="4225691">tripleDESCipher</span><span class="op" id="4225706">)</span>&nbsp;<span class="ident" id="4225708">BlockSize</span><span class="op" id="4225717">(</span><span class="op" id="4225718">)</span>&nbsp;<span class="builtintype" id="4225720">int</span>&nbsp;<span class="op" id="4225724">{</span>&nbsp;<span class="keyword" id="4225726">return</span>&nbsp;<span class="ident" id="4225733">BlockSize</span>&nbsp;<span class="op" id="4225743">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4225746">func</span>&nbsp;<span class="op" id="4225751">(</span><span class="ident" id="4225752">c</span>&nbsp;<span class="op" id="4225754">*</span><span class="ident" id="4225755">tripleDESCipher</span><span class="op" id="4225770">)</span>&nbsp;<span class="ident" id="4225772">Encrypt</span><span class="op" id="4225779">(</span><span class="ident" id="4225780">dst</span><span class="op" id="4225783">,</span>&nbsp;<span class="ident" id="4225785">src</span>&nbsp;<span class="op" id="4225789">[</span><span class="op" id="4225790">]</span><span class="builtintype" id="4225791">byte</span><span class="op" id="4225795">)</span>&nbsp;<span class="op" id="4225797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225800">c</span><span class="op" id="4225801">.</span><span class="ident" id="4225802">cipher1</span><span class="op" id="4225809">.</span><span class="ident" id="4225810">Encrypt</span><span class="op" id="4225817">(</span><span class="ident" id="4225818">dst</span><span class="op" id="4225821">,</span>&nbsp;<span class="ident" id="4225823">src</span><span class="op" id="4225826">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225829">c</span><span class="op" id="4225830">.</span><span class="ident" id="4225831">cipher2</span><span class="op" id="4225838">.</span><span class="ident" id="4225839">Decrypt</span><span class="op" id="4225846">(</span><span class="ident" id="4225847">dst</span><span class="op" id="4225850">,</span>&nbsp;<span class="ident" id="4225852">dst</span><span class="op" id="4225855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225858">c</span><span class="op" id="4225859">.</span><span class="ident" id="4225860">cipher3</span><span class="op" id="4225867">.</span><span class="ident" id="4225868">Encrypt</span><span class="op" id="4225875">(</span><span class="ident" id="4225876">dst</span><span class="op" id="4225879">,</span>&nbsp;<span class="ident" id="4225881">dst</span><span class="op" id="4225884">)</span><br>
<span class="lineno"></span><span class="op" id="4225886">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4225889">func</span>&nbsp;<span class="op" id="4225894">(</span><span class="ident" id="4225895">c</span>&nbsp;<span class="op" id="4225897">*</span><span class="ident" id="4225898">tripleDESCipher</span><span class="op" id="4225913">)</span>&nbsp;<span class="ident" id="4225915">Decrypt</span><span class="op" id="4225922">(</span><span class="ident" id="4225923">dst</span><span class="op" id="4225926">,</span>&nbsp;<span class="ident" id="4225928">src</span>&nbsp;<span class="op" id="4225932">[</span><span class="op" id="4225933">]</span><span class="builtintype" id="4225934">byte</span><span class="op" id="4225938">)</span>&nbsp;<span class="op" id="4225940">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225943">c</span><span class="op" id="4225944">.</span><span class="ident" id="4225945">cipher3</span><span class="op" id="4225952">.</span><span class="ident" id="4225953">Decrypt</span><span class="op" id="4225960">(</span><span class="ident" id="4225961">dst</span><span class="op" id="4225964">,</span>&nbsp;<span class="ident" id="4225966">src</span><span class="op" id="4225969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225972">c</span><span class="op" id="4225973">.</span><span class="ident" id="4225974">cipher2</span><span class="op" id="4225981">.</span><span class="ident" id="4225982">Encrypt</span><span class="op" id="4225989">(</span><span class="ident" id="4225990">dst</span><span class="op" id="4225993">,</span>&nbsp;<span class="ident" id="4225995">dst</span><span class="op" id="4225998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4226001">c</span><span class="op" id="4226002">.</span><span class="ident" id="4226003">cipher1</span><span class="op" id="4226010">.</span><span class="ident" id="4226011">Decrypt</span><span class="op" id="4226018">(</span><span class="ident" id="4226019">dst</span><span class="op" id="4226022">,</span>&nbsp;<span class="ident" id="4226024">dst</span><span class="op" id="4226027">)</span><br>
<span class="lineno"></span><span class="op" id="4226029">}</span>
</div>
</body>
</html>
