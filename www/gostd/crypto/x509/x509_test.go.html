<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6978788">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6978843">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6978897">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6978948">package</span>&nbsp;<span class="ident" id="6978956">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6978962">import</span>&nbsp;<span class="op" id="6978969">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6978972">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6978981">&#34;crypto/dsa&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6978995">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6979011">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6979030">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6979045">&#34;crypto/rsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6979059">_</span>&nbsp;<span class="string" id="6979061">&#34;crypto/sha256&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6979078">_</span>&nbsp;<span class="string" id="6979080">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6979097">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6979117">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6979134">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6979153">&#34;encoding/hex&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6979169">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6979185">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6979197">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6979204">&#34;os/exec&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6979215">&#34;reflect&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6979226">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6979237">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6979248">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6979255">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="6979258">func</span>&nbsp;<span class="ident" id="6979263">TestParsePKCS1PrivateKey</span><span class="op" id="6979287">(</span><span class="ident" id="6979288">t</span>&nbsp;<span class="op" id="6979290">*</span><span class="ident" id="6979291">testing</span><span class="op" id="6979298">.</span><span class="ident" id="6979299">T</span><span class="op" id="6979300">)</span>&nbsp;<span class="op" id="6979302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6979305">block</span><span class="op" id="6979310">,</span>&nbsp;<span class="ident" id="6979312">_</span>&nbsp;<span class="op" id="6979314">:=</span>&nbsp;<span class="ident" id="6979317">pem</span><span class="op" id="6979320">.</span><span class="ident" id="6979321">Decode</span><span class="op" id="6979327">(</span><span class="op" id="6979328">[</span><span class="op" id="6979329">]</span><span class="builtintype" id="6979330">byte</span><span class="op" id="6979334">(</span><span class="ident" id="6979335">pemPrivateKey</span><span class="op" id="6979348">)</span><span class="op" id="6979349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6979352">priv</span><span class="op" id="6979356">,</span>&nbsp;<span class="ident" id="6979358">err</span>&nbsp;<span class="op" id="6979362">:=</span>&nbsp;<span class="ident" id="6979365">ParsePKCS1PrivateKey</span><span class="op" id="6979385">(</span><span class="ident" id="6979386">block</span><span class="op" id="6979391">.</span><span class="ident" id="6979392">Bytes</span><span class="op" id="6979397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6979400">if</span>&nbsp;<span class="ident" id="6979403">err</span>&nbsp;<span class="op" id="6979407">!=</span>&nbsp;<span class="ident" id="6979410">nil</span>&nbsp;<span class="op" id="6979414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6979418">t</span><span class="op" id="6979419">.</span><span class="ident" id="6979420">Errorf</span><span class="op" id="6979426">(</span><span class="string" id="6979427">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6979460">,</span>&nbsp;<span class="ident" id="6979462">err</span><span class="op" id="6979465">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6979469">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6979477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6979480">if</span>&nbsp;<span class="ident" id="6979483">priv</span><span class="op" id="6979487">.</span><span class="ident" id="6979488">PublicKey</span><span class="op" id="6979497">.</span><span class="ident" id="6979498">N</span><span class="op" id="6979499">.</span><span class="ident" id="6979500">Cmp</span><span class="op" id="6979503">(</span><span class="ident" id="6979504">rsaPrivateKey</span><span class="op" id="6979517">.</span><span class="ident" id="6979518">PublicKey</span><span class="op" id="6979527">.</span><span class="ident" id="6979528">N</span><span class="op" id="6979529">)</span>&nbsp;<span class="op" id="6979531">!=</span>&nbsp;<span class="num" id="6979534">0</span>&nbsp;<span class="op" id="6979536">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6979541">priv</span><span class="op" id="6979545">.</span><span class="ident" id="6979546">PublicKey</span><span class="op" id="6979555">.</span><span class="ident" id="6979556">E</span>&nbsp;<span class="op" id="6979558">!=</span>&nbsp;<span class="ident" id="6979561">rsaPrivateKey</span><span class="op" id="6979574">.</span><span class="ident" id="6979575">PublicKey</span><span class="op" id="6979584">.</span><span class="ident" id="6979585">E</span>&nbsp;<span class="op" id="6979587">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6979592">priv</span><span class="op" id="6979596">.</span><span class="ident" id="6979597">D</span><span class="op" id="6979598">.</span><span class="ident" id="6979599">Cmp</span><span class="op" id="6979602">(</span><span class="ident" id="6979603">rsaPrivateKey</span><span class="op" id="6979616">.</span><span class="ident" id="6979617">D</span><span class="op" id="6979618">)</span>&nbsp;<span class="op" id="6979620">!=</span>&nbsp;<span class="num" id="6979623">0</span>&nbsp;<span class="op" id="6979625">||</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6979630">priv</span><span class="op" id="6979634">.</span><span class="ident" id="6979635">Primes</span><span class="op" id="6979641">[</span><span class="num" id="6979642">0</span><span class="op" id="6979643">]</span><span class="op" id="6979644">.</span><span class="ident" id="6979645">Cmp</span><span class="op" id="6979648">(</span><span class="ident" id="6979649">rsaPrivateKey</span><span class="op" id="6979662">.</span><span class="ident" id="6979663">Primes</span><span class="op" id="6979669">[</span><span class="num" id="6979670">0</span><span class="op" id="6979671">]</span><span class="op" id="6979672">)</span>&nbsp;<span class="op" id="6979674">!=</span>&nbsp;<span class="num" id="6979677">0</span>&nbsp;<span class="op" id="6979679">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6979684">priv</span><span class="op" id="6979688">.</span><span class="ident" id="6979689">Primes</span><span class="op" id="6979695">[</span><span class="num" id="6979696">1</span><span class="op" id="6979697">]</span><span class="op" id="6979698">.</span><span class="ident" id="6979699">Cmp</span><span class="op" id="6979702">(</span><span class="ident" id="6979703">rsaPrivateKey</span><span class="op" id="6979716">.</span><span class="ident" id="6979717">Primes</span><span class="op" id="6979723">[</span><span class="num" id="6979724">1</span><span class="op" id="6979725">]</span><span class="op" id="6979726">)</span>&nbsp;<span class="op" id="6979728">!=</span>&nbsp;<span class="num" id="6979731">0</span>&nbsp;<span class="op" id="6979733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6979737">t</span><span class="op" id="6979738">.</span><span class="ident" id="6979739">Errorf</span><span class="op" id="6979745">(</span><span class="string" id="6979746">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="6979764">,</span>&nbsp;<span class="ident" id="6979766">priv</span><span class="op" id="6979770">,</span>&nbsp;<span class="ident" id="6979772">rsaPrivateKey</span><span class="op" id="6979785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6979788">}</span><br>
<span class="lineno"></span><span class="op" id="6979790">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="6979793">func</span>&nbsp;<span class="ident" id="6979798">TestParsePKIXPublicKey</span><span class="op" id="6979820">(</span><span class="ident" id="6979821">t</span>&nbsp;<span class="op" id="6979823">*</span><span class="ident" id="6979824">testing</span><span class="op" id="6979831">.</span><span class="ident" id="6979832">T</span><span class="op" id="6979833">)</span>&nbsp;<span class="op" id="6979835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6979838">block</span><span class="op" id="6979843">,</span>&nbsp;<span class="ident" id="6979845">_</span>&nbsp;<span class="op" id="6979847">:=</span>&nbsp;<span class="ident" id="6979850">pem</span><span class="op" id="6979853">.</span><span class="ident" id="6979854">Decode</span><span class="op" id="6979860">(</span><span class="op" id="6979861">[</span><span class="op" id="6979862">]</span><span class="builtintype" id="6979863">byte</span><span class="op" id="6979867">(</span><span class="ident" id="6979868">pemPublicKey</span><span class="op" id="6979880">)</span><span class="op" id="6979881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6979884">pub</span><span class="op" id="6979887">,</span>&nbsp;<span class="ident" id="6979889">err</span>&nbsp;<span class="op" id="6979893">:=</span>&nbsp;<span class="ident" id="6979896">ParsePKIXPublicKey</span><span class="op" id="6979914">(</span><span class="ident" id="6979915">block</span><span class="op" id="6979920">.</span><span class="ident" id="6979921">Bytes</span><span class="op" id="6979926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6979929">if</span>&nbsp;<span class="ident" id="6979932">err</span>&nbsp;<span class="op" id="6979936">!=</span>&nbsp;<span class="ident" id="6979939">nil</span>&nbsp;<span class="op" id="6979943">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6979947">t</span><span class="op" id="6979948">.</span><span class="ident" id="6979949">Errorf</span><span class="op" id="6979955">(</span><span class="string" id="6979956">&#34;Failed&nbsp;to&nbsp;parse&nbsp;RSA&nbsp;public&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6979992">,</span>&nbsp;<span class="ident" id="6979994">err</span><span class="op" id="6979997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6980001">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6980009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6980012">rsaPub</span><span class="op" id="6980018">,</span>&nbsp;<span class="ident" id="6980020">ok</span>&nbsp;<span class="op" id="6980023">:=</span>&nbsp;<span class="ident" id="6980026">pub</span><span class="op" id="6980029">.</span><span class="op" id="6980030">(</span><span class="op" id="6980031">*</span><span class="ident" id="6980032">rsa</span><span class="op" id="6980035">.</span><span class="ident" id="6980036">PublicKey</span><span class="op" id="6980045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6980048">if</span>&nbsp;<span class="op" id="6980051">!</span><span class="ident" id="6980052">ok</span>&nbsp;<span class="op" id="6980055">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6980059">t</span><span class="op" id="6980060">.</span><span class="ident" id="6980061">Errorf</span><span class="op" id="6980067">(</span><span class="string" id="6980068">&#34;Value&nbsp;returned&nbsp;from&nbsp;ParsePKIXPublicKey&nbsp;was&nbsp;not&nbsp;an&nbsp;RSA&nbsp;public&nbsp;key&#34;</span><span class="op" id="6980134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6980138">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6980146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6980150">pubBytes2</span><span class="op" id="6980159">,</span>&nbsp;<span class="ident" id="6980161">err</span>&nbsp;<span class="op" id="6980165">:=</span>&nbsp;<span class="ident" id="6980168">MarshalPKIXPublicKey</span><span class="op" id="6980188">(</span><span class="ident" id="6980189">rsaPub</span><span class="op" id="6980195">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6980198">if</span>&nbsp;<span class="ident" id="6980201">err</span>&nbsp;<span class="op" id="6980205">!=</span>&nbsp;<span class="ident" id="6980208">nil</span>&nbsp;<span class="op" id="6980212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6980216">t</span><span class="op" id="6980217">.</span><span class="ident" id="6980218">Errorf</span><span class="op" id="6980224">(</span><span class="string" id="6980225">&#34;Failed&nbsp;to&nbsp;marshal&nbsp;RSA&nbsp;public&nbsp;key&nbsp;for&nbsp;the&nbsp;second&nbsp;time:&nbsp;%s&#34;</span><span class="op" id="6980283">,</span>&nbsp;<span class="ident" id="6980285">err</span><span class="op" id="6980288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6980292">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6980300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6980303">if</span>&nbsp;<span class="op" id="6980306">!</span><span class="ident" id="6980307">bytes</span><span class="op" id="6980312">.</span><span class="ident" id="6980313">Equal</span><span class="op" id="6980318">(</span><span class="ident" id="6980319">pubBytes2</span><span class="op" id="6980328">,</span>&nbsp;<span class="ident" id="6980330">block</span><span class="op" id="6980335">.</span><span class="ident" id="6980336">Bytes</span><span class="op" id="6980341">)</span>&nbsp;<span class="op" id="6980343">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6980347">t</span><span class="op" id="6980348">.</span><span class="ident" id="6980349">Errorf</span><span class="op" id="6980355">(</span><span class="string" id="6980356">&#34;Reserialization&nbsp;of&nbsp;public&nbsp;key&nbsp;didn&#39;t&nbsp;match.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="6980417">,</span>&nbsp;<span class="ident" id="6980419">pubBytes2</span><span class="op" id="6980428">,</span>&nbsp;<span class="ident" id="6980430">block</span><span class="op" id="6980435">.</span><span class="ident" id="6980436">Bytes</span><span class="op" id="6980441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6980444">}</span><br>
<span class="lineno"></span><span class="op" id="6980446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6980449">var</span>&nbsp;<span class="ident" id="6980453">pemPublicKey</span>&nbsp;<span class="op" id="6980466">=</span>&nbsp;<span class="string" id="6980468">`-----BEGIN&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno">70</span>MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA3VoPN9PKUjKFLMwOge6+<br>
<span class="lineno"></span>wnDi8sbETGIx2FKXGgqtAKpzmem53kRGEQg8WeqRmp12wgp74TGpkEXsGae7RS1k<br>
<span class="lineno"></span>enJCnma4fii+noGH7R0qKgHvPrI2Bwa9hzsH8tHxpyM3qrXslOmD45EH9SxIDUBJ<br>
<span class="lineno"></span>FehNdaPbLP1gFyahKMsdfxFJLUvbUycuZSJ2ZnIgeVxwm4qbSvZInL9Iu4FzuPtg<br>
<span class="lineno"></span>fINKcbbovy1qq4KvPIrXzhbY3PWDc6btxCf3SE0JdE1MCPThntB62/bLMSQ7xdDR<br>
<span class="lineno">75</span>FF53oIpvxe/SCOymfWq/LW849Ytv3Xwod0+wzAP8STXG4HSELS4UedPYeHJJJYcZ<br>
<span class="lineno"></span>+QIDAQAB<br>
<span class="lineno"></span>-----END&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="6980923">var</span>&nbsp;<span class="ident" id="6980927">pemPrivateKey</span>&nbsp;<span class="op" id="6980941">=</span>&nbsp;<span class="string" id="6980943">`-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>MIIBOgIBAAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0<br>
<span class="lineno"></span>fd7Ai2KW5ToIwzFofvJcS/STa6HA5gQenRUCAwEAAQJBAIq9amn00aS0h/CrjXqu<br>
<span class="lineno"></span>/ThglAXJmZhOMPVn4eiu7/ROixi9sex436MaVeMqSNf7Ex9a8fRNfWss7Sqd9eWu<br>
<span class="lineno"></span>RTUCIQDasvGASLqmjeffBNLTXV2A5g4t+kLVCpsEIZAycV5GswIhANEPLmax0ME/<br>
<span class="lineno">85</span>EO+ZJ79TJKN5yiGBRsv5yvx5UiHxajEXAiAhAol5N4EUyq6I9w1rYdhPMGpLfk7A<br>
<span class="lineno"></span>IU2snfRJ6Nq2CQIgFrPsWRCkV+gOYcajD17rEqmuLrdIRexpg8N1DOSXoJ8CIGlS<br>
<span class="lineno"></span>tAboUGBxTDq3ZroNism3DaMIbKPyYrAqhKov1h5V<br>
<span class="lineno"></span>-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="6981440">func</span>&nbsp;<span class="ident" id="6981445">bigFromString</span><span class="op" id="6981458">(</span><span class="ident" id="6981459">s</span>&nbsp;<span class="builtintype" id="6981461">string</span><span class="op" id="6981467">)</span>&nbsp;<span class="op" id="6981469">*</span><span class="ident" id="6981470">big</span><span class="op" id="6981473">.</span><span class="ident" id="6981474">Int</span>&nbsp;<span class="op" id="6981478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6981481">ret</span>&nbsp;<span class="op" id="6981485">:=</span>&nbsp;<span class="builtinfunc" id="6981488">new</span><span class="op" id="6981491">(</span><span class="ident" id="6981492">big</span><span class="op" id="6981495">.</span><span class="ident" id="6981496">Int</span><span class="op" id="6981499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6981502">ret</span><span class="op" id="6981505">.</span><span class="ident" id="6981506">SetString</span><span class="op" id="6981515">(</span><span class="ident" id="6981516">s</span><span class="op" id="6981517">,</span>&nbsp;<span class="num" id="6981519">10</span><span class="op" id="6981521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6981524">return</span>&nbsp;<span class="ident" id="6981531">ret</span><br>
<span class="lineno">95</span><span class="op" id="6981535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6981538">func</span>&nbsp;<span class="ident" id="6981543">fromBase10</span><span class="op" id="6981553">(</span><span class="ident" id="6981554">base10</span>&nbsp;<span class="builtintype" id="6981561">string</span><span class="op" id="6981567">)</span>&nbsp;<span class="op" id="6981569">*</span><span class="ident" id="6981570">big</span><span class="op" id="6981573">.</span><span class="ident" id="6981574">Int</span>&nbsp;<span class="op" id="6981578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6981581">i</span>&nbsp;<span class="op" id="6981583">:=</span>&nbsp;<span class="builtinfunc" id="6981586">new</span><span class="op" id="6981589">(</span><span class="ident" id="6981590">big</span><span class="op" id="6981593">.</span><span class="ident" id="6981594">Int</span><span class="op" id="6981597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6981600">i</span><span class="op" id="6981601">.</span><span class="ident" id="6981602">SetString</span><span class="op" id="6981611">(</span><span class="ident" id="6981612">base10</span><span class="op" id="6981618">,</span>&nbsp;<span class="num" id="6981620">10</span><span class="op" id="6981622">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6981625">return</span>&nbsp;<span class="ident" id="6981632">i</span><br>
<span class="lineno"></span><span class="op" id="6981634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6981637">func</span>&nbsp;<span class="ident" id="6981642">bigFromHexString</span><span class="op" id="6981658">(</span><span class="ident" id="6981659">s</span>&nbsp;<span class="builtintype" id="6981661">string</span><span class="op" id="6981667">)</span>&nbsp;<span class="op" id="6981669">*</span><span class="ident" id="6981670">big</span><span class="op" id="6981673">.</span><span class="ident" id="6981674">Int</span>&nbsp;<span class="op" id="6981678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6981681">ret</span>&nbsp;<span class="op" id="6981685">:=</span>&nbsp;<span class="builtinfunc" id="6981688">new</span><span class="op" id="6981691">(</span><span class="ident" id="6981692">big</span><span class="op" id="6981695">.</span><span class="ident" id="6981696">Int</span><span class="op" id="6981699">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6981702">ret</span><span class="op" id="6981705">.</span><span class="ident" id="6981706">SetString</span><span class="op" id="6981715">(</span><span class="ident" id="6981716">s</span><span class="op" id="6981717">,</span>&nbsp;<span class="num" id="6981719">16</span><span class="op" id="6981721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6981724">return</span>&nbsp;<span class="ident" id="6981731">ret</span><br>
<span class="lineno"></span><span class="op" id="6981735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6981738">var</span>&nbsp;<span class="ident" id="6981742">rsaPrivateKey</span>&nbsp;<span class="op" id="6981756">=</span>&nbsp;<span class="op" id="6981758">&amp;</span><span class="ident" id="6981759">rsa</span><span class="op" id="6981762">.</span><span class="ident" id="6981763">PrivateKey</span><span class="op" id="6981773">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6981776">PublicKey</span><span class="op" id="6981785">:</span>&nbsp;<span class="ident" id="6981787">rsa</span><span class="op" id="6981790">.</span><span class="ident" id="6981791">PublicKey</span><span class="op" id="6981800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6981804">N</span><span class="op" id="6981805">:</span>&nbsp;<span class="ident" id="6981807">bigFromString</span><span class="op" id="6981820">(</span><span class="string" id="6981821">&#34;9353930466774385905609975137998169297361893554149986716853295022578535724979677252958524466350471210367835187480748268864277464700638583474144061408845077&#34;</span><span class="op" id="6981977">)</span><span class="op" id="6981978">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6981982">E</span><span class="op" id="6981983">:</span>&nbsp;<span class="num" id="6981985">65537</span><span class="op" id="6981990">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6981993">}</span><span class="op" id="6981994">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6981997">D</span><span class="op" id="6981998">:</span>&nbsp;<span class="ident" id="6982000">bigFromString</span><span class="op" id="6982013">(</span><span class="string" id="6982014">&#34;7266398431328116344057699379749222532279343923819063639497049039389899328538543087657733766554155839834519529439851673014800261285757759040931985506583861&#34;</span><span class="op" id="6982170">)</span><span class="op" id="6982171">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6982174">Primes</span><span class="op" id="6982180">:</span>&nbsp;<span class="op" id="6982182">[</span><span class="op" id="6982183">]</span><span class="op" id="6982184">*</span><span class="ident" id="6982185">big</span><span class="op" id="6982188">.</span><span class="ident" id="6982189">Int</span><span class="op" id="6982192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6982196">bigFromString</span><span class="op" id="6982209">(</span><span class="string" id="6982210">&#34;98920366548084643601728869055592650835572950932266967461790948584315647051443&#34;</span><span class="op" id="6982289">)</span><span class="op" id="6982290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6982294">bigFromString</span><span class="op" id="6982307">(</span><span class="string" id="6982308">&#34;94560208308847015747498523884063394671606671904944666360068158221458669711639&#34;</span><span class="op" id="6982387">)</span><span class="op" id="6982388">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6982391">}</span><span class="op" id="6982392">,</span><br>
<span class="lineno"></span><span class="op" id="6982394">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="6982397">func</span>&nbsp;<span class="ident" id="6982402">TestMarshalRSAPrivateKey</span><span class="op" id="6982426">(</span><span class="ident" id="6982427">t</span>&nbsp;<span class="op" id="6982429">*</span><span class="ident" id="6982430">testing</span><span class="op" id="6982437">.</span><span class="ident" id="6982438">T</span><span class="op" id="6982439">)</span>&nbsp;<span class="op" id="6982441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6982444">priv</span>&nbsp;<span class="op" id="6982449">:=</span>&nbsp;<span class="op" id="6982452">&amp;</span><span class="ident" id="6982453">rsa</span><span class="op" id="6982456">.</span><span class="ident" id="6982457">PrivateKey</span><span class="op" id="6982467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6982471">PublicKey</span><span class="op" id="6982480">:</span>&nbsp;<span class="ident" id="6982482">rsa</span><span class="op" id="6982485">.</span><span class="ident" id="6982486">PublicKey</span><span class="op" id="6982495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6982500">N</span><span class="op" id="6982501">:</span>&nbsp;<span class="ident" id="6982503">fromBase10</span><span class="op" id="6982513">(</span><span class="string" id="6982514">&#34;16346378922382193400538269749936049106320265317511766357599732575277382844051791096569333808598921852351577762718529818072849191122419410612033592401403764925096136759934497687765453905884149505175426053037420486697072448609022753683683718057795566811401938833367954642951433473337066311978821180526439641496973296037000052546108507805269279414789035461158073156772151892452251106173507240488993608650881929629163465099476849643165682709047462010581308719577053905787496296934240246311806555924593059995202856826239801816771116902778517096212527979497399966526283516447337775509777558018145573127308919204297111496233&#34;</span><span class="op" id="6983133">)</span><span class="op" id="6983134">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6983139">E</span><span class="op" id="6983140">:</span>&nbsp;<span class="num" id="6983142">3</span><span class="op" id="6983143">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6983147">}</span><span class="op" id="6983148">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6983152">D</span><span class="op" id="6983153">:</span>&nbsp;<span class="ident" id="6983155">fromBase10</span><span class="op" id="6983165">(</span><span class="string" id="6983166">&#34;10897585948254795600358846499957366070880176878341177571733155050184921896034527397712889205732614568234385175145686545381899460748279607074689061600935843283397424506622998458510302603922766336783617368686090042765718290914099334449154829375179958369993407724946186243249568928237086215759259909861748642124071874879861299389874230489928271621259294894142840428407196932444474088857746123104978617098858619445675532587787023228852383149557470077802718705420275739737958953794088728369933811184572620857678792001136676902250566845618813972833750098806496641114644760255910789397593428910198080271317419213080834885003&#34;</span><span class="op" id="6983785">)</span><span class="op" id="6983786">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6983790">Primes</span><span class="op" id="6983796">:</span>&nbsp;<span class="op" id="6983798">[</span><span class="op" id="6983799">]</span><span class="op" id="6983800">*</span><span class="ident" id="6983801">big</span><span class="op" id="6983804">.</span><span class="ident" id="6983805">Int</span><span class="op" id="6983808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6983813">fromBase10</span><span class="op" id="6983823">(</span><span class="string" id="6983824">&#34;1025363189502892836833747188838978207017355117492483312747347695538428729137306368764177201532277413433182799108299960196606011786562992097313508180436744488171474690412562218914213688661311117337381958560443&#34;</span><span class="op" id="6984034">)</span><span class="op" id="6984035">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6984040">fromBase10</span><span class="op" id="6984050">(</span><span class="string" id="6984051">&#34;3467903426626310123395340254094941045497208049900750380025518552334536945536837294961497712862519984786362199788654739924501424784631315081391467293694361474867825728031147665777546570788493758372218019373&#34;</span><span class="op" id="6984258">)</span><span class="op" id="6984259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6984264">fromBase10</span><span class="op" id="6984274">(</span><span class="string" id="6984275">&#34;4597024781409332673052708605078359346966325141767460991205742124888960305710298765592730135879076084498363772408626791576005136245060321874472727132746643162385746062759369754202494417496879741537284589047&#34;</span><span class="op" id="6984482">)</span><span class="op" id="6984483">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6984487">}</span><span class="op" id="6984488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6984491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6984495">derBytes</span>&nbsp;<span class="op" id="6984504">:=</span>&nbsp;<span class="ident" id="6984507">MarshalPKCS1PrivateKey</span><span class="op" id="6984529">(</span><span class="ident" id="6984530">priv</span><span class="op" id="6984534">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6984538">priv2</span><span class="op" id="6984543">,</span>&nbsp;<span class="ident" id="6984545">err</span>&nbsp;<span class="op" id="6984549">:=</span>&nbsp;<span class="ident" id="6984552">ParsePKCS1PrivateKey</span><span class="op" id="6984572">(</span><span class="ident" id="6984573">derBytes</span><span class="op" id="6984581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6984584">if</span>&nbsp;<span class="ident" id="6984587">err</span>&nbsp;<span class="op" id="6984591">!=</span>&nbsp;<span class="ident" id="6984594">nil</span>&nbsp;<span class="op" id="6984598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6984602">t</span><span class="op" id="6984603">.</span><span class="ident" id="6984604">Errorf</span><span class="op" id="6984610">(</span><span class="string" id="6984611">&#34;error&nbsp;parsing&nbsp;serialized&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6984645">,</span>&nbsp;<span class="ident" id="6984647">err</span><span class="op" id="6984650">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6984654">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6984662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6984665">if</span>&nbsp;<span class="ident" id="6984668">priv</span><span class="op" id="6984672">.</span><span class="ident" id="6984673">PublicKey</span><span class="op" id="6984682">.</span><span class="ident" id="6984683">N</span><span class="op" id="6984684">.</span><span class="ident" id="6984685">Cmp</span><span class="op" id="6984688">(</span><span class="ident" id="6984689">priv2</span><span class="op" id="6984694">.</span><span class="ident" id="6984695">PublicKey</span><span class="op" id="6984704">.</span><span class="ident" id="6984705">N</span><span class="op" id="6984706">)</span>&nbsp;<span class="op" id="6984708">!=</span>&nbsp;<span class="num" id="6984711">0</span>&nbsp;<span class="op" id="6984713">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6984718">priv</span><span class="op" id="6984722">.</span><span class="ident" id="6984723">PublicKey</span><span class="op" id="6984732">.</span><span class="ident" id="6984733">E</span>&nbsp;<span class="op" id="6984735">!=</span>&nbsp;<span class="ident" id="6984738">priv2</span><span class="op" id="6984743">.</span><span class="ident" id="6984744">PublicKey</span><span class="op" id="6984753">.</span><span class="ident" id="6984754">E</span>&nbsp;<span class="op" id="6984756">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6984761">priv</span><span class="op" id="6984765">.</span><span class="ident" id="6984766">D</span><span class="op" id="6984767">.</span><span class="ident" id="6984768">Cmp</span><span class="op" id="6984771">(</span><span class="ident" id="6984772">priv2</span><span class="op" id="6984777">.</span><span class="ident" id="6984778">D</span><span class="op" id="6984779">)</span>&nbsp;<span class="op" id="6984781">!=</span>&nbsp;<span class="num" id="6984784">0</span>&nbsp;<span class="op" id="6984786">||</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6984791">len</span><span class="op" id="6984794">(</span><span class="ident" id="6984795">priv2</span><span class="op" id="6984800">.</span><span class="ident" id="6984801">Primes</span><span class="op" id="6984807">)</span>&nbsp;<span class="op" id="6984809">!=</span>&nbsp;<span class="num" id="6984812">3</span>&nbsp;<span class="op" id="6984814">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6984819">priv</span><span class="op" id="6984823">.</span><span class="ident" id="6984824">Primes</span><span class="op" id="6984830">[</span><span class="num" id="6984831">0</span><span class="op" id="6984832">]</span><span class="op" id="6984833">.</span><span class="ident" id="6984834">Cmp</span><span class="op" id="6984837">(</span><span class="ident" id="6984838">priv2</span><span class="op" id="6984843">.</span><span class="ident" id="6984844">Primes</span><span class="op" id="6984850">[</span><span class="num" id="6984851">0</span><span class="op" id="6984852">]</span><span class="op" id="6984853">)</span>&nbsp;<span class="op" id="6984855">!=</span>&nbsp;<span class="num" id="6984858">0</span>&nbsp;<span class="op" id="6984860">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6984865">priv</span><span class="op" id="6984869">.</span><span class="ident" id="6984870">Primes</span><span class="op" id="6984876">[</span><span class="num" id="6984877">1</span><span class="op" id="6984878">]</span><span class="op" id="6984879">.</span><span class="ident" id="6984880">Cmp</span><span class="op" id="6984883">(</span><span class="ident" id="6984884">priv2</span><span class="op" id="6984889">.</span><span class="ident" id="6984890">Primes</span><span class="op" id="6984896">[</span><span class="num" id="6984897">1</span><span class="op" id="6984898">]</span><span class="op" id="6984899">)</span>&nbsp;<span class="op" id="6984901">!=</span>&nbsp;<span class="num" id="6984904">0</span>&nbsp;<span class="op" id="6984906">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6984911">priv</span><span class="op" id="6984915">.</span><span class="ident" id="6984916">Primes</span><span class="op" id="6984922">[</span><span class="num" id="6984923">2</span><span class="op" id="6984924">]</span><span class="op" id="6984925">.</span><span class="ident" id="6984926">Cmp</span><span class="op" id="6984929">(</span><span class="ident" id="6984930">priv2</span><span class="op" id="6984935">.</span><span class="ident" id="6984936">Primes</span><span class="op" id="6984942">[</span><span class="num" id="6984943">2</span><span class="op" id="6984944">]</span><span class="op" id="6984945">)</span>&nbsp;<span class="op" id="6984947">!=</span>&nbsp;<span class="num" id="6984950">0</span>&nbsp;<span class="op" id="6984952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6984956">t</span><span class="op" id="6984957">.</span><span class="ident" id="6984958">Errorf</span><span class="op" id="6984964">(</span><span class="string" id="6984965">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="6984983">,</span>&nbsp;<span class="ident" id="6984985">priv</span><span class="op" id="6984989">,</span>&nbsp;<span class="ident" id="6984991">priv2</span><span class="op" id="6984996">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6984999">}</span><br>
<span class="lineno"></span><span class="op" id="6985001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6985004">type</span>&nbsp;<span class="ident" id="6985009">matchHostnamesTest</span>&nbsp;<span class="keyword" id="6985028">struct</span>&nbsp;<span class="op" id="6985035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6985038">pattern</span><span class="op" id="6985045">,</span>&nbsp;<span class="ident" id="6985047">host</span>&nbsp;<span class="builtintype" id="6985052">string</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6985060">ok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6985074">bool</span><br>
<span class="lineno"></span><span class="op" id="6985079">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6985082">var</span>&nbsp;<span class="ident" id="6985086">matchHostnamesTests</span>&nbsp;<span class="op" id="6985106">=</span>&nbsp;<span class="op" id="6985108">[</span><span class="op" id="6985109">]</span><span class="ident" id="6985110">matchHostnamesTest</span><span class="op" id="6985128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6985131">{</span><span class="string" id="6985132">&#34;a.b.c&#34;</span><span class="op" id="6985139">,</span>&nbsp;<span class="string" id="6985141">&#34;a.b.c&#34;</span><span class="op" id="6985148">,</span>&nbsp;<span class="builtintype" id="6985150">true</span><span class="op" id="6985154">}</span><span class="op" id="6985155">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6985158">{</span><span class="string" id="6985159">&#34;a.b.c&#34;</span><span class="op" id="6985166">,</span>&nbsp;<span class="string" id="6985168">&#34;b.b.c&#34;</span><span class="op" id="6985175">,</span>&nbsp;<span class="builtintype" id="6985177">false</span><span class="op" id="6985182">}</span><span class="op" id="6985183">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6985186">{</span><span class="string" id="6985187">&#34;&#34;</span><span class="op" id="6985189">,</span>&nbsp;<span class="string" id="6985191">&#34;b.b.c&#34;</span><span class="op" id="6985198">,</span>&nbsp;<span class="builtintype" id="6985200">false</span><span class="op" id="6985205">}</span><span class="op" id="6985206">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6985209">{</span><span class="string" id="6985210">&#34;a.b.c&#34;</span><span class="op" id="6985217">,</span>&nbsp;<span class="string" id="6985219">&#34;&#34;</span><span class="op" id="6985221">,</span>&nbsp;<span class="builtintype" id="6985223">false</span><span class="op" id="6985228">}</span><span class="op" id="6985229">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6985232">{</span><span class="string" id="6985233">&#34;example.com&#34;</span><span class="op" id="6985246">,</span>&nbsp;<span class="string" id="6985248">&#34;example.com&#34;</span><span class="op" id="6985261">,</span>&nbsp;<span class="builtintype" id="6985263">true</span><span class="op" id="6985267">}</span><span class="op" id="6985268">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6985271">{</span><span class="string" id="6985272">&#34;example.com&#34;</span><span class="op" id="6985285">,</span>&nbsp;<span class="string" id="6985287">&#34;www.example.com&#34;</span><span class="op" id="6985304">,</span>&nbsp;<span class="builtintype" id="6985306">false</span><span class="op" id="6985311">}</span><span class="op" id="6985312">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6985315">{</span><span class="string" id="6985316">&#34;*.example.com&#34;</span><span class="op" id="6985331">,</span>&nbsp;<span class="string" id="6985333">&#34;www.example.com&#34;</span><span class="op" id="6985350">,</span>&nbsp;<span class="builtintype" id="6985352">true</span><span class="op" id="6985356">}</span><span class="op" id="6985357">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6985360">{</span><span class="string" id="6985361">&#34;*.example.com&#34;</span><span class="op" id="6985376">,</span>&nbsp;<span class="string" id="6985378">&#34;xyz.www.example.com&#34;</span><span class="op" id="6985399">,</span>&nbsp;<span class="builtintype" id="6985401">false</span><span class="op" id="6985406">}</span><span class="op" id="6985407">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6985410">{</span><span class="string" id="6985411">&#34;*.*.example.com&#34;</span><span class="op" id="6985428">,</span>&nbsp;<span class="string" id="6985430">&#34;xyz.www.example.com&#34;</span><span class="op" id="6985451">,</span>&nbsp;<span class="builtintype" id="6985453">true</span><span class="op" id="6985457">}</span><span class="op" id="6985458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6985461">{</span><span class="string" id="6985462">&#34;*.www.*.com&#34;</span><span class="op" id="6985475">,</span>&nbsp;<span class="string" id="6985477">&#34;xyz.www.example.com&#34;</span><span class="op" id="6985498">,</span>&nbsp;<span class="builtintype" id="6985500">true</span><span class="op" id="6985504">}</span><span class="op" id="6985505">,</span><br>
<span class="lineno"></span><span class="op" id="6985507">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="6985510">func</span>&nbsp;<span class="ident" id="6985515">TestMatchHostnames</span><span class="op" id="6985533">(</span><span class="ident" id="6985534">t</span>&nbsp;<span class="op" id="6985536">*</span><span class="ident" id="6985537">testing</span><span class="op" id="6985544">.</span><span class="ident" id="6985545">T</span><span class="op" id="6985546">)</span>&nbsp;<span class="op" id="6985548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6985551">for</span>&nbsp;<span class="ident" id="6985555">i</span><span class="op" id="6985556">,</span>&nbsp;<span class="ident" id="6985558">test</span>&nbsp;<span class="op" id="6985563">:=</span>&nbsp;<span class="keyword" id="6985566">range</span>&nbsp;<span class="ident" id="6985572">matchHostnamesTests</span>&nbsp;<span class="op" id="6985592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6985596">r</span>&nbsp;<span class="op" id="6985598">:=</span>&nbsp;<span class="ident" id="6985601">matchHostnames</span><span class="op" id="6985615">(</span><span class="ident" id="6985616">test</span><span class="op" id="6985620">.</span><span class="ident" id="6985621">pattern</span><span class="op" id="6985628">,</span>&nbsp;<span class="ident" id="6985630">test</span><span class="op" id="6985634">.</span><span class="ident" id="6985635">host</span><span class="op" id="6985639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6985643">if</span>&nbsp;<span class="ident" id="6985646">r</span>&nbsp;<span class="op" id="6985648">!=</span>&nbsp;<span class="ident" id="6985651">test</span><span class="op" id="6985655">.</span><span class="ident" id="6985656">ok</span>&nbsp;<span class="op" id="6985659">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6985664">t</span><span class="op" id="6985665">.</span><span class="ident" id="6985666">Errorf</span><span class="op" id="6985672">(</span><span class="string" id="6985673">&#34;#%d&nbsp;mismatch&nbsp;got:&nbsp;%t&nbsp;want:&nbsp;%t&#34;</span><span class="op" id="6985704">,</span>&nbsp;<span class="ident" id="6985706">i</span><span class="op" id="6985707">,</span>&nbsp;<span class="ident" id="6985709">r</span><span class="op" id="6985710">,</span>&nbsp;<span class="ident" id="6985712">test</span><span class="op" id="6985716">.</span><span class="ident" id="6985717">ok</span><span class="op" id="6985719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6985723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6985726">}</span><br>
<span class="lineno"></span><span class="op" id="6985728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="6985731">func</span>&nbsp;<span class="ident" id="6985736">TestMatchIP</span><span class="op" id="6985747">(</span><span class="ident" id="6985748">t</span>&nbsp;<span class="op" id="6985750">*</span><span class="ident" id="6985751">testing</span><span class="op" id="6985758">.</span><span class="ident" id="6985759">T</span><span class="op" id="6985760">)</span>&nbsp;<span class="op" id="6985762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6985765">//&nbsp;Check&nbsp;that&nbsp;pattern&nbsp;matching&nbsp;is&nbsp;working.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6985809">c</span>&nbsp;<span class="op" id="6985811">:=</span>&nbsp;<span class="op" id="6985814">&amp;</span><span class="ident" id="6985815">Certificate</span><span class="op" id="6985826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6985830">DNSNames</span><span class="op" id="6985838">:</span>&nbsp;<span class="op" id="6985840">[</span><span class="op" id="6985841">]</span><span class="builtintype" id="6985842">string</span><span class="op" id="6985848">{</span><span class="string" id="6985849">&#34;*.foo.bar.baz&#34;</span><span class="op" id="6985864">}</span><span class="op" id="6985865">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6985869">Subject</span><span class="op" id="6985876">:</span>&nbsp;<span class="ident" id="6985878">pkix</span><span class="op" id="6985882">.</span><span class="ident" id="6985883">Name</span><span class="op" id="6985887">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6985892">CommonName</span><span class="op" id="6985902">:</span>&nbsp;<span class="string" id="6985904">&#34;*.foo.bar.baz&#34;</span><span class="op" id="6985919">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6985923">}</span><span class="op" id="6985924">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6985927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6985930">err</span>&nbsp;<span class="op" id="6985934">:=</span>&nbsp;<span class="ident" id="6985937">c</span><span class="op" id="6985938">.</span><span class="ident" id="6985939">VerifyHostname</span><span class="op" id="6985953">(</span><span class="string" id="6985954">&#34;quux.foo.bar.baz&#34;</span><span class="op" id="6985972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6985975">if</span>&nbsp;<span class="ident" id="6985978">err</span>&nbsp;<span class="op" id="6985982">!=</span>&nbsp;<span class="ident" id="6985985">nil</span>&nbsp;<span class="op" id="6985989">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6985993">t</span><span class="op" id="6985994">.</span><span class="ident" id="6985995">Fatalf</span><span class="op" id="6986001">(</span><span class="string" id="6986002">&#34;VerifyHostname(quux.foo.bar.baz):&nbsp;%v&#34;</span><span class="op" id="6986040">,</span>&nbsp;<span class="ident" id="6986042">err</span><span class="op" id="6986045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6986048">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6986052">//&nbsp;But&nbsp;check&nbsp;that&nbsp;if&nbsp;we&nbsp;change&nbsp;it&nbsp;to&nbsp;be&nbsp;matching&nbsp;against&nbsp;an&nbsp;IP&nbsp;address,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6986125">//&nbsp;it&nbsp;is&nbsp;rejected.</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6986145">c</span>&nbsp;<span class="op" id="6986147">=</span>&nbsp;<span class="op" id="6986149">&amp;</span><span class="ident" id="6986150">Certificate</span><span class="op" id="6986161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6986165">DNSNames</span><span class="op" id="6986173">:</span>&nbsp;<span class="op" id="6986175">[</span><span class="op" id="6986176">]</span><span class="builtintype" id="6986177">string</span><span class="op" id="6986183">{</span><span class="string" id="6986184">&#34;*.2.3.4&#34;</span><span class="op" id="6986193">}</span><span class="op" id="6986194">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6986198">Subject</span><span class="op" id="6986205">:</span>&nbsp;<span class="ident" id="6986207">pkix</span><span class="op" id="6986211">.</span><span class="ident" id="6986212">Name</span><span class="op" id="6986216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6986221">CommonName</span><span class="op" id="6986231">:</span>&nbsp;<span class="string" id="6986233">&#34;*.2.3.4&#34;</span><span class="op" id="6986242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6986246">}</span><span class="op" id="6986247">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6986250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6986253">err</span>&nbsp;<span class="op" id="6986257">=</span>&nbsp;<span class="ident" id="6986259">c</span><span class="op" id="6986260">.</span><span class="ident" id="6986261">VerifyHostname</span><span class="op" id="6986275">(</span><span class="string" id="6986276">&#34;1.2.3.4&#34;</span><span class="op" id="6986285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6986288">if</span>&nbsp;<span class="ident" id="6986291">err</span>&nbsp;<span class="op" id="6986295">==</span>&nbsp;<span class="ident" id="6986298">nil</span>&nbsp;<span class="op" id="6986302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6986306">t</span><span class="op" id="6986307">.</span><span class="ident" id="6986308">Fatalf</span><span class="op" id="6986314">(</span><span class="string" id="6986315">&#34;VerifyHostname(1.2.3.4)&nbsp;should&nbsp;have&nbsp;failed,&nbsp;did&nbsp;not&#34;</span><span class="op" id="6986368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6986371">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6986375">c</span>&nbsp;<span class="op" id="6986377">=</span>&nbsp;<span class="op" id="6986379">&amp;</span><span class="ident" id="6986380">Certificate</span><span class="op" id="6986391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6986395">IPAddresses</span><span class="op" id="6986406">:</span>&nbsp;<span class="op" id="6986408">[</span><span class="op" id="6986409">]</span><span class="ident" id="6986410">net</span><span class="op" id="6986413">.</span><span class="ident" id="6986414">IP</span><span class="op" id="6986416">{</span><span class="ident" id="6986417">net</span><span class="op" id="6986420">.</span><span class="ident" id="6986421">ParseIP</span><span class="op" id="6986428">(</span><span class="string" id="6986429">&#34;127.0.0.1&#34;</span><span class="op" id="6986440">)</span><span class="op" id="6986441">,</span>&nbsp;<span class="ident" id="6986443">net</span><span class="op" id="6986446">.</span><span class="ident" id="6986447">ParseIP</span><span class="op" id="6986454">(</span><span class="string" id="6986455">&#34;::1&#34;</span><span class="op" id="6986460">)</span><span class="op" id="6986461">}</span><span class="op" id="6986462">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6986465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6986468">err</span>&nbsp;<span class="op" id="6986472">=</span>&nbsp;<span class="ident" id="6986474">c</span><span class="op" id="6986475">.</span><span class="ident" id="6986476">VerifyHostname</span><span class="op" id="6986490">(</span><span class="string" id="6986491">&#34;127.0.0.1&#34;</span><span class="op" id="6986502">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6986505">if</span>&nbsp;<span class="ident" id="6986508">err</span>&nbsp;<span class="op" id="6986512">!=</span>&nbsp;<span class="ident" id="6986515">nil</span>&nbsp;<span class="op" id="6986519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6986523">t</span><span class="op" id="6986524">.</span><span class="ident" id="6986525">Fatalf</span><span class="op" id="6986531">(</span><span class="string" id="6986532">&#34;VerifyHostname(127.0.0.1):&nbsp;%v&#34;</span><span class="op" id="6986563">,</span>&nbsp;<span class="ident" id="6986565">err</span><span class="op" id="6986568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6986571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6986574">err</span>&nbsp;<span class="op" id="6986578">=</span>&nbsp;<span class="ident" id="6986580">c</span><span class="op" id="6986581">.</span><span class="ident" id="6986582">VerifyHostname</span><span class="op" id="6986596">(</span><span class="string" id="6986597">&#34;::1&#34;</span><span class="op" id="6986602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6986605">if</span>&nbsp;<span class="ident" id="6986608">err</span>&nbsp;<span class="op" id="6986612">!=</span>&nbsp;<span class="ident" id="6986615">nil</span>&nbsp;<span class="op" id="6986619">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6986623">t</span><span class="op" id="6986624">.</span><span class="ident" id="6986625">Fatalf</span><span class="op" id="6986631">(</span><span class="string" id="6986632">&#34;VerifyHostname(::1):&nbsp;%v&#34;</span><span class="op" id="6986657">,</span>&nbsp;<span class="ident" id="6986659">err</span><span class="op" id="6986662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6986665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6986668">err</span>&nbsp;<span class="op" id="6986672">=</span>&nbsp;<span class="ident" id="6986674">c</span><span class="op" id="6986675">.</span><span class="ident" id="6986676">VerifyHostname</span><span class="op" id="6986690">(</span><span class="string" id="6986691">&#34;[::1]&#34;</span><span class="op" id="6986698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6986701">if</span>&nbsp;<span class="ident" id="6986704">err</span>&nbsp;<span class="op" id="6986708">!=</span>&nbsp;<span class="ident" id="6986711">nil</span>&nbsp;<span class="op" id="6986715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6986719">t</span><span class="op" id="6986720">.</span><span class="ident" id="6986721">Fatalf</span><span class="op" id="6986727">(</span><span class="string" id="6986728">&#34;VerifyHostname([::1]):&nbsp;%v&#34;</span><span class="op" id="6986755">,</span>&nbsp;<span class="ident" id="6986757">err</span><span class="op" id="6986760">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6986763">}</span><br>
<span class="lineno"></span><span class="op" id="6986765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6986768">func</span>&nbsp;<span class="ident" id="6986773">TestCertificateParse</span><span class="op" id="6986793">(</span><span class="ident" id="6986794">t</span>&nbsp;<span class="op" id="6986796">*</span><span class="ident" id="6986797">testing</span><span class="op" id="6986804">.</span><span class="ident" id="6986805">T</span><span class="op" id="6986806">)</span>&nbsp;<span class="op" id="6986808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6986811">s</span><span class="op" id="6986812">,</span>&nbsp;<span class="ident" id="6986814">_</span>&nbsp;<span class="op" id="6986816">:=</span>&nbsp;<span class="ident" id="6986819">hex</span><span class="op" id="6986822">.</span><span class="ident" id="6986823">DecodeString</span><span class="op" id="6986835">(</span><span class="ident" id="6986836">certBytes</span><span class="op" id="6986845">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6986848">certs</span><span class="op" id="6986853">,</span>&nbsp;<span class="ident" id="6986855">err</span>&nbsp;<span class="op" id="6986859">:=</span>&nbsp;<span class="ident" id="6986862">ParseCertificates</span><span class="op" id="6986879">(</span><span class="ident" id="6986880">s</span><span class="op" id="6986881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6986884">if</span>&nbsp;<span class="ident" id="6986887">err</span>&nbsp;<span class="op" id="6986891">!=</span>&nbsp;<span class="ident" id="6986894">nil</span>&nbsp;<span class="op" id="6986898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6986902">t</span><span class="op" id="6986903">.</span><span class="ident" id="6986904">Error</span><span class="op" id="6986909">(</span><span class="ident" id="6986910">err</span><span class="op" id="6986913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6986916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6986919">if</span>&nbsp;<span class="builtinfunc" id="6986922">len</span><span class="op" id="6986925">(</span><span class="ident" id="6986926">certs</span><span class="op" id="6986931">)</span>&nbsp;<span class="op" id="6986933">!=</span>&nbsp;<span class="num" id="6986936">2</span>&nbsp;<span class="op" id="6986938">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6986942">t</span><span class="op" id="6986943">.</span><span class="ident" id="6986944">Errorf</span><span class="op" id="6986950">(</span><span class="string" id="6986951">&#34;Wrong&nbsp;number&nbsp;of&nbsp;certs:&nbsp;got&nbsp;%d&nbsp;want&nbsp;2&#34;</span><span class="op" id="6986989">,</span>&nbsp;<span class="builtinfunc" id="6986991">len</span><span class="op" id="6986994">(</span><span class="ident" id="6986995">certs</span><span class="op" id="6987000">)</span><span class="op" id="6987001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6987005">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6987013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6987017">err</span>&nbsp;<span class="op" id="6987021">=</span>&nbsp;<span class="ident" id="6987023">certs</span><span class="op" id="6987028">[</span><span class="num" id="6987029">0</span><span class="op" id="6987030">]</span><span class="op" id="6987031">.</span><span class="ident" id="6987032">CheckSignatureFrom</span><span class="op" id="6987050">(</span><span class="ident" id="6987051">certs</span><span class="op" id="6987056">[</span><span class="num" id="6987057">1</span><span class="op" id="6987058">]</span><span class="op" id="6987059">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6987062">if</span>&nbsp;<span class="ident" id="6987065">err</span>&nbsp;<span class="op" id="6987069">!=</span>&nbsp;<span class="ident" id="6987072">nil</span>&nbsp;<span class="op" id="6987076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6987080">t</span><span class="op" id="6987081">.</span><span class="ident" id="6987082">Error</span><span class="op" id="6987087">(</span><span class="ident" id="6987088">err</span><span class="op" id="6987091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6987094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6987098">if</span>&nbsp;<span class="ident" id="6987101">err</span>&nbsp;<span class="op" id="6987105">:=</span>&nbsp;<span class="ident" id="6987108">certs</span><span class="op" id="6987113">[</span><span class="num" id="6987114">0</span><span class="op" id="6987115">]</span><span class="op" id="6987116">.</span><span class="ident" id="6987117">VerifyHostname</span><span class="op" id="6987131">(</span><span class="string" id="6987132">&#34;mail.google.com&#34;</span><span class="op" id="6987149">)</span><span class="op" id="6987150">;</span>&nbsp;<span class="ident" id="6987152">err</span>&nbsp;<span class="op" id="6987156">!=</span>&nbsp;<span class="ident" id="6987159">nil</span>&nbsp;<span class="op" id="6987163">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6987167">t</span><span class="op" id="6987168">.</span><span class="ident" id="6987169">Error</span><span class="op" id="6987174">(</span><span class="ident" id="6987175">err</span><span class="op" id="6987178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6987181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6987185">const</span>&nbsp;<span class="ident" id="6987191">expectedExtensions</span>&nbsp;<span class="op" id="6987210">=</span>&nbsp;<span class="num" id="6987212">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6987215">if</span>&nbsp;<span class="ident" id="6987218">n</span>&nbsp;<span class="op" id="6987220">:=</span>&nbsp;<span class="builtinfunc" id="6987223">len</span><span class="op" id="6987226">(</span><span class="ident" id="6987227">certs</span><span class="op" id="6987232">[</span><span class="num" id="6987233">0</span><span class="op" id="6987234">]</span><span class="op" id="6987235">.</span><span class="ident" id="6987236">Extensions</span><span class="op" id="6987246">)</span><span class="op" id="6987247">;</span>&nbsp;<span class="ident" id="6987249">n</span>&nbsp;<span class="op" id="6987251">!=</span>&nbsp;<span class="ident" id="6987254">expectedExtensions</span>&nbsp;<span class="op" id="6987273">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6987277">t</span><span class="op" id="6987278">.</span><span class="ident" id="6987279">Errorf</span><span class="op" id="6987285">(</span><span class="string" id="6987286">&#34;want&nbsp;%d&nbsp;extensions,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="6987314">,</span>&nbsp;<span class="ident" id="6987316">expectedExtensions</span><span class="op" id="6987334">,</span>&nbsp;<span class="ident" id="6987336">n</span><span class="op" id="6987337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6987340">}</span><br>
<span class="lineno"></span><span class="op" id="6987342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6987345">var</span>&nbsp;<span class="ident" id="6987349">certBytes</span>&nbsp;<span class="op" id="6987359">=</span>&nbsp;<span class="string" id="6987361">&#34;308203223082028ba00302010202106edf0d9499fd4533dd1297fc42a93be1300d06092a864886&#34;</span>&nbsp;<span class="op" id="6987442">+</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6987445">&#34;f70d0101050500304c310b3009060355040613025a4131253023060355040a131c546861777465&#34;</span>&nbsp;<span class="op" id="6987526">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6987529">&#34;20436f6e73756c74696e67202850747929204c74642e311630140603550403130d546861777465&#34;</span>&nbsp;<span class="op" id="6987610">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6987613">&#34;20534743204341301e170d3039303332353136343932395a170d3130303332353136343932395a&#34;</span>&nbsp;<span class="op" id="6987694">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6987697">&#34;3069310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630&#34;</span>&nbsp;<span class="op" id="6987778">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6987781">&#34;140603550407130d4d6f756e7461696e205669657731133011060355040a130a476f6f676c6520&#34;</span>&nbsp;<span class="op" id="6987862">+</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6987865">&#34;496e63311830160603550403130f6d61696c2e676f6f676c652e636f6d30819f300d06092a8648&#34;</span>&nbsp;<span class="op" id="6987946">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6987949">&#34;86f70d010101050003818d0030818902818100c5d6f892fccaf5614b064149e80a2c9581a218ef&#34;</span>&nbsp;<span class="op" id="6988030">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6988033">&#34;41ec35bd7a58125ae76f9ea54ddc893abbeb029f6b73616bf0ffd868791fba7af9c4aebf3706ba&#34;</span>&nbsp;<span class="op" id="6988114">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6988117">&#34;3eeaeed27435b4ddcfb157c05f351d66aa87fee0de072d66d773affbd36ab78bef090e0cc861a9&#34;</span>&nbsp;<span class="op" id="6988198">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6988201">&#34;03ac90dd98b51c9c41566c017f0beec3bff391051ffba0f5cc6850ad2a590203010001a381e730&#34;</span>&nbsp;<span class="op" id="6988282">+</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6988285">&#34;81e430280603551d250421301f06082b0601050507030106082b06010505070302060960864801&#34;</span>&nbsp;<span class="op" id="6988366">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6988369">&#34;86f842040130360603551d1f042f302d302ba029a0278625687474703a2f2f63726c2e74686177&#34;</span>&nbsp;<span class="op" id="6988450">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6988453">&#34;74652e636f6d2f54686177746553474343412e63726c307206082b060105050701010466306430&#34;</span>&nbsp;<span class="op" id="6988534">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6988537">&#34;2206082b060105050730018616687474703a2f2f6f6373702e7468617774652e636f6d303e0608&#34;</span>&nbsp;<span class="op" id="6988618">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6988621">&#34;2b060105050730028632687474703a2f2f7777772e7468617774652e636f6d2f7265706f736974&#34;</span>&nbsp;<span class="op" id="6988702">+</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6988705">&#34;6f72792f5468617774655f5347435f43412e637274300c0603551d130101ff04023000300d0609&#34;</span>&nbsp;<span class="op" id="6988786">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6988789">&#34;2a864886f70d01010505000381810062f1f3050ebc105e497c7aedf87e24d2f4a986bb3b837bd1&#34;</span>&nbsp;<span class="op" id="6988870">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6988873">&#34;9b91ebcad98b065992f6bd2b49b7d6d3cb2e427a99d606c7b1d46352527fac39e6a8b6726de5bf&#34;</span>&nbsp;<span class="op" id="6988954">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6988957">&#34;70212a52cba07634a5e332011bd1868e78eb5e3c93cf03072276786f207494feaa0ed9d53b2110&#34;</span>&nbsp;<span class="op" id="6989038">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6989041">&#34;a76571f90209cdae884385c882587030ee15f33d761e2e45a6bc308203233082028ca003020102&#34;</span>&nbsp;<span class="op" id="6989122">+</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6989125">&#34;020430000002300d06092a864886f70d0101050500305f310b3009060355040613025553311730&#34;</span>&nbsp;<span class="op" id="6989206">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6989209">&#34;15060355040a130e566572695369676e2c20496e632e31373035060355040b132e436c61737320&#34;</span>&nbsp;<span class="op" id="6989290">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6989293">&#34;33205075626c6963205072696d6172792043657274696669636174696f6e20417574686f726974&#34;</span>&nbsp;<span class="op" id="6989374">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6989377">&#34;79301e170d3034303531333030303030305a170d3134303531323233353935395a304c310b3009&#34;</span>&nbsp;<span class="op" id="6989458">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6989461">&#34;060355040613025a4131253023060355040a131c54686177746520436f6e73756c74696e672028&#34;</span>&nbsp;<span class="op" id="6989542">+</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6989545">&#34;50747929204c74642e311630140603550403130d5468617774652053474320434130819f300d06&#34;</span>&nbsp;<span class="op" id="6989626">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6989629">&#34;092a864886f70d010101050003818d0030818902818100d4d367d08d157faecd31fe7d1d91a13f&#34;</span>&nbsp;<span class="op" id="6989710">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6989713">&#34;0b713cacccc864fb63fc324b0794bd6f80ba2fe10493c033fc093323e90b742b71c403c6d2cde2&#34;</span>&nbsp;<span class="op" id="6989794">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6989797">&#34;2ff50963cdff48a500bfe0e7f388b72d32de9836e60aad007bc4644a3b847503f270927d0e62f5&#34;</span>&nbsp;<span class="op" id="6989878">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6989881">&#34;21ab693684317590f8bfc76c881b06957cc9e5a8de75a12c7a68dfd5ca1c875860190203010001&#34;</span>&nbsp;<span class="op" id="6989962">+</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6989965">&#34;a381fe3081fb30120603551d130101ff040830060101ff020100300b0603551d0f040403020106&#34;</span>&nbsp;<span class="op" id="6990046">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6990049">&#34;301106096086480186f842010104040302010630280603551d110421301fa41d301b3119301706&#34;</span>&nbsp;<span class="op" id="6990130">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6990133">&#34;035504031310507269766174654c6162656c332d313530310603551d1f042a30283026a024a022&#34;</span>&nbsp;<span class="op" id="6990214">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6990217">&#34;8620687474703a2f2f63726c2e766572697369676e2e636f6d2f706361332e63726c303206082b&#34;</span>&nbsp;<span class="op" id="6990298">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6990301">&#34;0601050507010104263024302206082b060105050730018616687474703a2f2f6f6373702e7468&#34;</span>&nbsp;<span class="op" id="6990382">+</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6990385">&#34;617774652e636f6d30340603551d25042d302b06082b0601050507030106082b06010505070302&#34;</span>&nbsp;<span class="op" id="6990466">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6990469">&#34;06096086480186f8420401060a6086480186f845010801300d06092a864886f70d010105050003&#34;</span>&nbsp;<span class="op" id="6990550">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6990553">&#34;81810055ac63eadea1ddd2905f9f0bce76be13518f93d9052bc81b774bad6950a1eededcfddb07&#34;</span>&nbsp;<span class="op" id="6990634">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6990637">&#34;e9e83994dcab72792f06bfab8170c4a8edea5334edef1e53d906c7562bd15cf4d18a8eb42bb137&#34;</span>&nbsp;<span class="op" id="6990718">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6990721">&#34;9048084225c53e8acb7feb6f04d16dc574a2f7a27c7b603c77cd0ece48027f012fb69b37e02a2a&#34;</span>&nbsp;<span class="op" id="6990802">+</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6990805">&#34;36dcd585d6ace53f546f961e05af&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6990837">func</span>&nbsp;<span class="ident" id="6990842">TestCreateSelfSignedCertificate</span><span class="op" id="6990873">(</span><span class="ident" id="6990874">t</span>&nbsp;<span class="op" id="6990876">*</span><span class="ident" id="6990877">testing</span><span class="op" id="6990884">.</span><span class="ident" id="6990885">T</span><span class="op" id="6990886">)</span>&nbsp;<span class="op" id="6990888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6990891">random</span>&nbsp;<span class="op" id="6990898">:=</span>&nbsp;<span class="ident" id="6990901">rand</span><span class="op" id="6990905">.</span><span class="ident" id="6990906">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6990915">block</span><span class="op" id="6990920">,</span>&nbsp;<span class="ident" id="6990922">_</span>&nbsp;<span class="op" id="6990924">:=</span>&nbsp;<span class="ident" id="6990927">pem</span><span class="op" id="6990930">.</span><span class="ident" id="6990931">Decode</span><span class="op" id="6990937">(</span><span class="op" id="6990938">[</span><span class="op" id="6990939">]</span><span class="builtintype" id="6990940">byte</span><span class="op" id="6990944">(</span><span class="ident" id="6990945">pemPrivateKey</span><span class="op" id="6990958">)</span><span class="op" id="6990959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6990962">rsaPriv</span><span class="op" id="6990969">,</span>&nbsp;<span class="ident" id="6990971">err</span>&nbsp;<span class="op" id="6990975">:=</span>&nbsp;<span class="ident" id="6990978">ParsePKCS1PrivateKey</span><span class="op" id="6990998">(</span><span class="ident" id="6990999">block</span><span class="op" id="6991004">.</span><span class="ident" id="6991005">Bytes</span><span class="op" id="6991010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6991013">if</span>&nbsp;<span class="ident" id="6991016">err</span>&nbsp;<span class="op" id="6991020">!=</span>&nbsp;<span class="ident" id="6991023">nil</span>&nbsp;<span class="op" id="6991027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6991031">t</span><span class="op" id="6991032">.</span><span class="ident" id="6991033">Fatalf</span><span class="op" id="6991039">(</span><span class="string" id="6991040">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6991073">,</span>&nbsp;<span class="ident" id="6991075">err</span><span class="op" id="6991078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6991081">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6991085">ecdsaPriv</span><span class="op" id="6991094">,</span>&nbsp;<span class="ident" id="6991096">err</span>&nbsp;<span class="op" id="6991100">:=</span>&nbsp;<span class="ident" id="6991103">ecdsa</span><span class="op" id="6991108">.</span><span class="ident" id="6991109">GenerateKey</span><span class="op" id="6991120">(</span><span class="ident" id="6991121">elliptic</span><span class="op" id="6991129">.</span><span class="ident" id="6991130">P256</span><span class="op" id="6991134">(</span><span class="op" id="6991135">)</span><span class="op" id="6991136">,</span>&nbsp;<span class="ident" id="6991138">rand</span><span class="op" id="6991142">.</span><span class="ident" id="6991143">Reader</span><span class="op" id="6991149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6991152">if</span>&nbsp;<span class="ident" id="6991155">err</span>&nbsp;<span class="op" id="6991159">!=</span>&nbsp;<span class="ident" id="6991162">nil</span>&nbsp;<span class="op" id="6991166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6991170">t</span><span class="op" id="6991171">.</span><span class="ident" id="6991172">Fatalf</span><span class="op" id="6991178">(</span><span class="string" id="6991179">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6991213">,</span>&nbsp;<span class="ident" id="6991215">err</span><span class="op" id="6991218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6991221">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6991225">tests</span>&nbsp;<span class="op" id="6991231">:=</span>&nbsp;<span class="op" id="6991234">[</span><span class="op" id="6991235">]</span><span class="keyword" id="6991236">struct</span>&nbsp;<span class="op" id="6991243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6991247">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6991257">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6991266">pub</span><span class="op" id="6991269">,</span>&nbsp;<span class="ident" id="6991271">priv</span>&nbsp;<span class="keyword" id="6991276">interface</span><span class="op" id="6991285">{</span><span class="op" id="6991286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6991290">checkSig</span>&nbsp;&nbsp;<span class="builtintype" id="6991300">bool</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6991307">sigAlgo</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6991317">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6991337">}</span><span class="op" id="6991338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6991342">{</span><span class="string" id="6991343">&#34;RSA/RSA&#34;</span><span class="op" id="6991352">,</span>&nbsp;<span class="op" id="6991354">&amp;</span><span class="ident" id="6991355">rsaPriv</span><span class="op" id="6991362">.</span><span class="ident" id="6991363">PublicKey</span><span class="op" id="6991372">,</span>&nbsp;<span class="ident" id="6991374">rsaPriv</span><span class="op" id="6991381">,</span>&nbsp;<span class="builtintype" id="6991383">true</span><span class="op" id="6991387">,</span>&nbsp;<span class="ident" id="6991389">SHA1WithRSA</span><span class="op" id="6991400">}</span><span class="op" id="6991401">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6991405">{</span><span class="string" id="6991406">&#34;RSA/ECDSA&#34;</span><span class="op" id="6991417">,</span>&nbsp;<span class="op" id="6991419">&amp;</span><span class="ident" id="6991420">rsaPriv</span><span class="op" id="6991427">.</span><span class="ident" id="6991428">PublicKey</span><span class="op" id="6991437">,</span>&nbsp;<span class="ident" id="6991439">ecdsaPriv</span><span class="op" id="6991448">,</span>&nbsp;<span class="builtintype" id="6991450">false</span><span class="op" id="6991455">,</span>&nbsp;<span class="ident" id="6991457">ECDSAWithSHA384</span><span class="op" id="6991472">}</span><span class="op" id="6991473">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6991477">{</span><span class="string" id="6991478">&#34;ECDSA/RSA&#34;</span><span class="op" id="6991489">,</span>&nbsp;<span class="op" id="6991491">&amp;</span><span class="ident" id="6991492">ecdsaPriv</span><span class="op" id="6991501">.</span><span class="ident" id="6991502">PublicKey</span><span class="op" id="6991511">,</span>&nbsp;<span class="ident" id="6991513">rsaPriv</span><span class="op" id="6991520">,</span>&nbsp;<span class="builtintype" id="6991522">false</span><span class="op" id="6991527">,</span>&nbsp;<span class="ident" id="6991529">SHA256WithRSA</span><span class="op" id="6991542">}</span><span class="op" id="6991543">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6991547">{</span><span class="string" id="6991548">&#34;ECDSA/ECDSA&#34;</span><span class="op" id="6991561">,</span>&nbsp;<span class="op" id="6991563">&amp;</span><span class="ident" id="6991564">ecdsaPriv</span><span class="op" id="6991573">.</span><span class="ident" id="6991574">PublicKey</span><span class="op" id="6991583">,</span>&nbsp;<span class="ident" id="6991585">ecdsaPriv</span><span class="op" id="6991594">,</span>&nbsp;<span class="builtintype" id="6991596">true</span><span class="op" id="6991600">,</span>&nbsp;<span class="ident" id="6991602">ECDSAWithSHA1</span><span class="op" id="6991615">}</span><span class="op" id="6991616">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6991619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6991623">testExtKeyUsage</span>&nbsp;<span class="op" id="6991639">:=</span>&nbsp;<span class="op" id="6991642">[</span><span class="op" id="6991643">]</span><span class="ident" id="6991644">ExtKeyUsage</span><span class="op" id="6991655">{</span><span class="ident" id="6991656">ExtKeyUsageClientAuth</span><span class="op" id="6991677">,</span>&nbsp;<span class="ident" id="6991679">ExtKeyUsageServerAuth</span><span class="op" id="6991700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6991703">testUnknownExtKeyUsage</span>&nbsp;<span class="op" id="6991726">:=</span>&nbsp;<span class="op" id="6991729">[</span><span class="op" id="6991730">]</span><span class="ident" id="6991731">asn1</span><span class="op" id="6991735">.</span><span class="ident" id="6991736">ObjectIdentifier</span><span class="op" id="6991752">{</span><span class="op" id="6991753">[</span><span class="op" id="6991754">]</span><span class="builtintype" id="6991755">int</span><span class="op" id="6991758">{</span><span class="num" id="6991759">1</span><span class="op" id="6991760">,</span>&nbsp;<span class="num" id="6991762">2</span><span class="op" id="6991763">,</span>&nbsp;<span class="num" id="6991765">3</span><span class="op" id="6991766">}</span><span class="op" id="6991767">,</span>&nbsp;<span class="op" id="6991769">[</span><span class="op" id="6991770">]</span><span class="builtintype" id="6991771">int</span><span class="op" id="6991774">{</span><span class="num" id="6991775">2</span><span class="op" id="6991776">,</span>&nbsp;<span class="num" id="6991778">59</span><span class="op" id="6991780">,</span>&nbsp;<span class="num" id="6991782">1</span><span class="op" id="6991783">}</span><span class="op" id="6991784">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6991787">extraExtensionData</span>&nbsp;<span class="op" id="6991806">:=</span>&nbsp;<span class="op" id="6991809">[</span><span class="op" id="6991810">]</span><span class="builtintype" id="6991811">byte</span><span class="op" id="6991815">(</span><span class="string" id="6991816">&#34;extra&nbsp;extension&#34;</span><span class="op" id="6991833">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6991837">for</span>&nbsp;<span class="ident" id="6991841">_</span><span class="op" id="6991842">,</span>&nbsp;<span class="ident" id="6991844">test</span>&nbsp;<span class="op" id="6991849">:=</span>&nbsp;<span class="keyword" id="6991852">range</span>&nbsp;<span class="ident" id="6991858">tests</span>&nbsp;<span class="op" id="6991864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6991868">commonName</span>&nbsp;<span class="op" id="6991879">:=</span>&nbsp;<span class="string" id="6991882">&#34;test.example.com&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6991903">template</span>&nbsp;<span class="op" id="6991912">:=</span>&nbsp;<span class="ident" id="6991915">Certificate</span><span class="op" id="6991926">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6991931">SerialNumber</span><span class="op" id="6991943">:</span>&nbsp;<span class="ident" id="6991945">big</span><span class="op" id="6991948">.</span><span class="ident" id="6991949">NewInt</span><span class="op" id="6991955">(</span><span class="num" id="6991956">1</span><span class="op" id="6991957">)</span><span class="op" id="6991958">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6991963">Subject</span><span class="op" id="6991970">:</span>&nbsp;<span class="ident" id="6991972">pkix</span><span class="op" id="6991976">.</span><span class="ident" id="6991977">Name</span><span class="op" id="6991981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6991987">CommonName</span><span class="op" id="6991997">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6992001">commonName</span><span class="op" id="6992011">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6992017">Organization</span><span class="op" id="6992029">:</span>&nbsp;<span class="op" id="6992031">[</span><span class="op" id="6992032">]</span><span class="builtintype" id="6992033">string</span><span class="op" id="6992039">{</span><span class="string" id="6992040">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="6992052">}</span><span class="op" id="6992053">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6992058">}</span><span class="op" id="6992059">,</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6992064">NotBefore</span><span class="op" id="6992073">:</span>&nbsp;<span class="ident" id="6992075">time</span><span class="op" id="6992079">.</span><span class="ident" id="6992080">Unix</span><span class="op" id="6992084">(</span><span class="num" id="6992085">1000</span><span class="op" id="6992089">,</span>&nbsp;<span class="num" id="6992091">0</span><span class="op" id="6992092">)</span><span class="op" id="6992093">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6992098">NotAfter</span><span class="op" id="6992106">:</span>&nbsp;&nbsp;<span class="ident" id="6992109">time</span><span class="op" id="6992113">.</span><span class="ident" id="6992114">Unix</span><span class="op" id="6992118">(</span><span class="num" id="6992119">100000</span><span class="op" id="6992125">,</span>&nbsp;<span class="num" id="6992127">0</span><span class="op" id="6992128">)</span><span class="op" id="6992129">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6992135">SignatureAlgorithm</span><span class="op" id="6992153">:</span>&nbsp;<span class="ident" id="6992155">test</span><span class="op" id="6992159">.</span><span class="ident" id="6992160">sigAlgo</span><span class="op" id="6992167">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6992173">SubjectKeyId</span><span class="op" id="6992185">:</span>&nbsp;<span class="op" id="6992187">[</span><span class="op" id="6992188">]</span><span class="builtintype" id="6992189">byte</span><span class="op" id="6992193">{</span><span class="num" id="6992194">1</span><span class="op" id="6992195">,</span>&nbsp;<span class="num" id="6992197">2</span><span class="op" id="6992198">,</span>&nbsp;<span class="num" id="6992200">3</span><span class="op" id="6992201">,</span>&nbsp;<span class="num" id="6992203">4</span><span class="op" id="6992204">}</span><span class="op" id="6992205">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6992210">KeyUsage</span><span class="op" id="6992218">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6992224">KeyUsageCertSign</span><span class="op" id="6992240">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6992246">ExtKeyUsage</span><span class="op" id="6992257">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6992266">testExtKeyUsage</span><span class="op" id="6992281">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6992286">UnknownExtKeyUsage</span><span class="op" id="6992304">:</span>&nbsp;<span class="ident" id="6992306">testUnknownExtKeyUsage</span><span class="op" id="6992328">,</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6992334">BasicConstraintsValid</span><span class="op" id="6992355">:</span>&nbsp;<span class="builtintype" id="6992357">true</span><span class="op" id="6992361">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6992366">IsCA</span><span class="op" id="6992370">:</span>&nbsp;<span class="builtintype" id="6992372">true</span><span class="op" id="6992376">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6992382">OCSPServer</span><span class="op" id="6992392">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6992405">[</span><span class="op" id="6992406">]</span><span class="builtintype" id="6992407">string</span><span class="op" id="6992413">{</span><span class="string" id="6992414">&#34;http://ocsp.example.com&#34;</span><span class="op" id="6992439">}</span><span class="op" id="6992440">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6992445">IssuingCertificateURL</span><span class="op" id="6992466">:</span>&nbsp;<span class="op" id="6992468">[</span><span class="op" id="6992469">]</span><span class="builtintype" id="6992470">string</span><span class="op" id="6992476">{</span><span class="string" id="6992477">&#34;http://crt.example.com/ca1.crt&#34;</span><span class="op" id="6992509">}</span><span class="op" id="6992510">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6992516">DNSNames</span><span class="op" id="6992524">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6992532">[</span><span class="op" id="6992533">]</span><span class="builtintype" id="6992534">string</span><span class="op" id="6992540">{</span><span class="string" id="6992541">&#34;test.example.com&#34;</span><span class="op" id="6992559">}</span><span class="op" id="6992560">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6992565">EmailAddresses</span><span class="op" id="6992579">:</span>&nbsp;<span class="op" id="6992581">[</span><span class="op" id="6992582">]</span><span class="builtintype" id="6992583">string</span><span class="op" id="6992589">{</span><span class="string" id="6992590">&#34;gopher@golang.org&#34;</span><span class="op" id="6992609">}</span><span class="op" id="6992610">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6992615">IPAddresses</span><span class="op" id="6992626">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6992631">[</span><span class="op" id="6992632">]</span><span class="ident" id="6992633">net</span><span class="op" id="6992636">.</span><span class="ident" id="6992637">IP</span><span class="op" id="6992639">{</span><span class="ident" id="6992640">net</span><span class="op" id="6992643">.</span><span class="ident" id="6992644">IPv4</span><span class="op" id="6992648">(</span><span class="num" id="6992649">127</span><span class="op" id="6992652">,</span>&nbsp;<span class="num" id="6992654">0</span><span class="op" id="6992655">,</span>&nbsp;<span class="num" id="6992657">0</span><span class="op" id="6992658">,</span>&nbsp;<span class="num" id="6992660">1</span><span class="op" id="6992661">)</span><span class="op" id="6992662">.</span><span class="ident" id="6992663">To4</span><span class="op" id="6992666">(</span><span class="op" id="6992667">)</span><span class="op" id="6992668">,</span>&nbsp;<span class="ident" id="6992670">net</span><span class="op" id="6992673">.</span><span class="ident" id="6992674">ParseIP</span><span class="op" id="6992681">(</span><span class="string" id="6992682">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="6992704">)</span><span class="op" id="6992705">}</span><span class="op" id="6992706">,</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6992712">PolicyIdentifiers</span><span class="op" id="6992729">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6992733">[</span><span class="op" id="6992734">]</span><span class="ident" id="6992735">asn1</span><span class="op" id="6992739">.</span><span class="ident" id="6992740">ObjectIdentifier</span><span class="op" id="6992756">{</span><span class="op" id="6992757">[</span><span class="op" id="6992758">]</span><span class="builtintype" id="6992759">int</span><span class="op" id="6992762">{</span><span class="num" id="6992763">1</span><span class="op" id="6992764">,</span>&nbsp;<span class="num" id="6992766">2</span><span class="op" id="6992767">,</span>&nbsp;<span class="num" id="6992769">3</span><span class="op" id="6992770">}</span><span class="op" id="6992771">}</span><span class="op" id="6992772">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6992777">PermittedDNSDomains</span><span class="op" id="6992796">:</span>&nbsp;<span class="op" id="6992798">[</span><span class="op" id="6992799">]</span><span class="builtintype" id="6992800">string</span><span class="op" id="6992806">{</span><span class="string" id="6992807">&#34;.example.com&#34;</span><span class="op" id="6992821">,</span>&nbsp;<span class="string" id="6992823">&#34;example.com&#34;</span><span class="op" id="6992836">}</span><span class="op" id="6992837">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6992843">CRLDistributionPoints</span><span class="op" id="6992864">:</span>&nbsp;<span class="op" id="6992866">[</span><span class="op" id="6992867">]</span><span class="builtintype" id="6992868">string</span><span class="op" id="6992874">{</span><span class="string" id="6992875">&#34;http://crl1.example.com/ca1.crl&#34;</span><span class="op" id="6992908">,</span>&nbsp;<span class="string" id="6992910">&#34;http://crl2.example.com/ca1.crl&#34;</span><span class="op" id="6992943">}</span><span class="op" id="6992944">,</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6992950">ExtraExtensions</span><span class="op" id="6992965">:</span>&nbsp;<span class="op" id="6992967">[</span><span class="op" id="6992968">]</span><span class="ident" id="6992969">pkix</span><span class="op" id="6992973">.</span><span class="ident" id="6992974">Extension</span><span class="op" id="6992983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6992989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6992996">Id</span><span class="op" id="6992998">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6993003">[</span><span class="op" id="6993004">]</span><span class="builtintype" id="6993005">int</span><span class="op" id="6993008">{</span><span class="num" id="6993009">1</span><span class="op" id="6993010">,</span>&nbsp;<span class="num" id="6993012">2</span><span class="op" id="6993013">,</span>&nbsp;<span class="num" id="6993015">3</span><span class="op" id="6993016">,</span>&nbsp;<span class="num" id="6993018">4</span><span class="op" id="6993019">}</span><span class="op" id="6993020">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6993027">Value</span><span class="op" id="6993032">:</span>&nbsp;<span class="ident" id="6993034">extraExtensionData</span><span class="op" id="6993052">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6993058">}</span><span class="op" id="6993059">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6993065">//&nbsp;This&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;SubjectKeyId,&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6993128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6993135">Id</span><span class="op" id="6993137">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6993145">oidExtensionSubjectKeyId</span><span class="op" id="6993169">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6993176">Critical</span><span class="op" id="6993184">:</span>&nbsp;<span class="builtintype" id="6993186">false</span><span class="op" id="6993191">,</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6993198">Value</span><span class="op" id="6993203">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6993208">[</span><span class="op" id="6993209">]</span><span class="builtintype" id="6993210">byte</span><span class="op" id="6993214">{</span><span class="num" id="6993215">0x04</span><span class="op" id="6993219">,</span>&nbsp;<span class="num" id="6993221">0x04</span><span class="op" id="6993225">,</span>&nbsp;<span class="num" id="6993227">4</span><span class="op" id="6993228">,</span>&nbsp;<span class="num" id="6993230">3</span><span class="op" id="6993231">,</span>&nbsp;<span class="num" id="6993233">2</span><span class="op" id="6993234">,</span>&nbsp;<span class="num" id="6993236">1</span><span class="op" id="6993237">}</span><span class="op" id="6993238">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6993244">}</span><span class="op" id="6993245">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6993250">}</span><span class="op" id="6993251">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6993255">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6993260">derBytes</span><span class="op" id="6993268">,</span>&nbsp;<span class="ident" id="6993270">err</span>&nbsp;<span class="op" id="6993274">:=</span>&nbsp;<span class="ident" id="6993277">CreateCertificate</span><span class="op" id="6993294">(</span><span class="ident" id="6993295">random</span><span class="op" id="6993301">,</span>&nbsp;<span class="op" id="6993303">&amp;</span><span class="ident" id="6993304">template</span><span class="op" id="6993312">,</span>&nbsp;<span class="op" id="6993314">&amp;</span><span class="ident" id="6993315">template</span><span class="op" id="6993323">,</span>&nbsp;<span class="ident" id="6993325">test</span><span class="op" id="6993329">.</span><span class="ident" id="6993330">pub</span><span class="op" id="6993333">,</span>&nbsp;<span class="ident" id="6993335">test</span><span class="op" id="6993339">.</span><span class="ident" id="6993340">priv</span><span class="op" id="6993344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6993348">if</span>&nbsp;<span class="ident" id="6993351">err</span>&nbsp;<span class="op" id="6993355">!=</span>&nbsp;<span class="ident" id="6993358">nil</span>&nbsp;<span class="op" id="6993362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6993367">t</span><span class="op" id="6993368">.</span><span class="ident" id="6993369">Errorf</span><span class="op" id="6993375">(</span><span class="string" id="6993376">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="6993414">,</span>&nbsp;<span class="ident" id="6993416">test</span><span class="op" id="6993420">.</span><span class="ident" id="6993421">name</span><span class="op" id="6993425">,</span>&nbsp;<span class="ident" id="6993427">err</span><span class="op" id="6993430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6993435">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6993446">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6993451">cert</span><span class="op" id="6993455">,</span>&nbsp;<span class="ident" id="6993457">err</span>&nbsp;<span class="op" id="6993461">:=</span>&nbsp;<span class="ident" id="6993464">ParseCertificate</span><span class="op" id="6993480">(</span><span class="ident" id="6993481">derBytes</span><span class="op" id="6993489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6993493">if</span>&nbsp;<span class="ident" id="6993496">err</span>&nbsp;<span class="op" id="6993500">!=</span>&nbsp;<span class="ident" id="6993503">nil</span>&nbsp;<span class="op" id="6993507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6993512">t</span><span class="op" id="6993513">.</span><span class="ident" id="6993514">Errorf</span><span class="op" id="6993520">(</span><span class="string" id="6993521">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="6993558">,</span>&nbsp;<span class="ident" id="6993560">test</span><span class="op" id="6993564">.</span><span class="ident" id="6993565">name</span><span class="op" id="6993569">,</span>&nbsp;<span class="ident" id="6993571">err</span><span class="op" id="6993574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6993579">continue</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6993590">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6993595">if</span>&nbsp;<span class="builtinfunc" id="6993598">len</span><span class="op" id="6993601">(</span><span class="ident" id="6993602">cert</span><span class="op" id="6993606">.</span><span class="ident" id="6993607">PolicyIdentifiers</span><span class="op" id="6993624">)</span>&nbsp;<span class="op" id="6993626">!=</span>&nbsp;<span class="num" id="6993629">1</span>&nbsp;<span class="op" id="6993631">||</span>&nbsp;<span class="op" id="6993634">!</span><span class="ident" id="6993635">cert</span><span class="op" id="6993639">.</span><span class="ident" id="6993640">PolicyIdentifiers</span><span class="op" id="6993657">[</span><span class="num" id="6993658">0</span><span class="op" id="6993659">]</span><span class="op" id="6993660">.</span><span class="ident" id="6993661">Equal</span><span class="op" id="6993666">(</span><span class="ident" id="6993667">template</span><span class="op" id="6993675">.</span><span class="ident" id="6993676">PolicyIdentifiers</span><span class="op" id="6993693">[</span><span class="num" id="6993694">0</span><span class="op" id="6993695">]</span><span class="op" id="6993696">)</span>&nbsp;<span class="op" id="6993698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6993703">t</span><span class="op" id="6993704">.</span><span class="ident" id="6993705">Errorf</span><span class="op" id="6993711">(</span><span class="string" id="6993712">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;policy&nbsp;identifiers:&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="6993770">,</span>&nbsp;<span class="ident" id="6993772">test</span><span class="op" id="6993776">.</span><span class="ident" id="6993777">name</span><span class="op" id="6993781">,</span>&nbsp;<span class="ident" id="6993783">cert</span><span class="op" id="6993787">.</span><span class="ident" id="6993788">PolicyIdentifiers</span><span class="op" id="6993805">,</span>&nbsp;<span class="ident" id="6993807">template</span><span class="op" id="6993815">.</span><span class="ident" id="6993816">PolicyIdentifiers</span><span class="op" id="6993833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6993837">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6993842">if</span>&nbsp;<span class="builtinfunc" id="6993845">len</span><span class="op" id="6993848">(</span><span class="ident" id="6993849">cert</span><span class="op" id="6993853">.</span><span class="ident" id="6993854">PermittedDNSDomains</span><span class="op" id="6993873">)</span>&nbsp;<span class="op" id="6993875">!=</span>&nbsp;<span class="num" id="6993878">2</span>&nbsp;<span class="op" id="6993880">||</span>&nbsp;<span class="ident" id="6993883">cert</span><span class="op" id="6993887">.</span><span class="ident" id="6993888">PermittedDNSDomains</span><span class="op" id="6993907">[</span><span class="num" id="6993908">0</span><span class="op" id="6993909">]</span>&nbsp;<span class="op" id="6993911">!=</span>&nbsp;<span class="string" id="6993914">&#34;.example.com&#34;</span>&nbsp;<span class="op" id="6993929">||</span>&nbsp;<span class="ident" id="6993932">cert</span><span class="op" id="6993936">.</span><span class="ident" id="6993937">PermittedDNSDomains</span><span class="op" id="6993956">[</span><span class="num" id="6993957">1</span><span class="op" id="6993958">]</span>&nbsp;<span class="op" id="6993960">!=</span>&nbsp;<span class="string" id="6993963">&#34;example.com&#34;</span>&nbsp;<span class="op" id="6993977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6993982">t</span><span class="op" id="6993983">.</span><span class="ident" id="6993984">Errorf</span><span class="op" id="6993990">(</span><span class="string" id="6993991">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;name&nbsp;constraints:&nbsp;%#v&#34;</span><span class="op" id="6994034">,</span>&nbsp;<span class="ident" id="6994036">test</span><span class="op" id="6994040">.</span><span class="ident" id="6994041">name</span><span class="op" id="6994045">,</span>&nbsp;<span class="ident" id="6994047">cert</span><span class="op" id="6994051">.</span><span class="ident" id="6994052">PermittedDNSDomains</span><span class="op" id="6994071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6994075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6994080">if</span>&nbsp;<span class="ident" id="6994083">cert</span><span class="op" id="6994087">.</span><span class="ident" id="6994088">Subject</span><span class="op" id="6994095">.</span><span class="ident" id="6994096">CommonName</span>&nbsp;<span class="op" id="6994107">!=</span>&nbsp;<span class="ident" id="6994110">commonName</span>&nbsp;<span class="op" id="6994121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6994126">t</span><span class="op" id="6994127">.</span><span class="ident" id="6994128">Errorf</span><span class="op" id="6994134">(</span><span class="string" id="6994135">&#34;%s:&nbsp;subject&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="6994207">,</span>&nbsp;<span class="ident" id="6994209">test</span><span class="op" id="6994213">.</span><span class="ident" id="6994214">name</span><span class="op" id="6994218">,</span>&nbsp;<span class="ident" id="6994220">cert</span><span class="op" id="6994224">.</span><span class="ident" id="6994225">Subject</span><span class="op" id="6994232">.</span><span class="ident" id="6994233">CommonName</span><span class="op" id="6994243">,</span>&nbsp;<span class="ident" id="6994245">commonName</span><span class="op" id="6994255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6994259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6994264">if</span>&nbsp;<span class="ident" id="6994267">cert</span><span class="op" id="6994271">.</span><span class="ident" id="6994272">Issuer</span><span class="op" id="6994278">.</span><span class="ident" id="6994279">CommonName</span>&nbsp;<span class="op" id="6994290">!=</span>&nbsp;<span class="ident" id="6994293">commonName</span>&nbsp;<span class="op" id="6994304">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6994309">t</span><span class="op" id="6994310">.</span><span class="ident" id="6994311">Errorf</span><span class="op" id="6994317">(</span><span class="string" id="6994318">&#34;%s:&nbsp;issuer&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="6994389">,</span>&nbsp;<span class="ident" id="6994391">test</span><span class="op" id="6994395">.</span><span class="ident" id="6994396">name</span><span class="op" id="6994400">,</span>&nbsp;<span class="ident" id="6994402">cert</span><span class="op" id="6994406">.</span><span class="ident" id="6994407">Issuer</span><span class="op" id="6994413">.</span><span class="ident" id="6994414">CommonName</span><span class="op" id="6994424">,</span>&nbsp;<span class="ident" id="6994426">commonName</span><span class="op" id="6994436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6994440">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6994445">if</span>&nbsp;<span class="ident" id="6994448">cert</span><span class="op" id="6994452">.</span><span class="ident" id="6994453">SignatureAlgorithm</span>&nbsp;<span class="op" id="6994472">!=</span>&nbsp;<span class="ident" id="6994475">test</span><span class="op" id="6994479">.</span><span class="ident" id="6994480">sigAlgo</span>&nbsp;<span class="op" id="6994488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6994493">t</span><span class="op" id="6994494">.</span><span class="ident" id="6994495">Errorf</span><span class="op" id="6994501">(</span><span class="string" id="6994502">&#34;%s:&nbsp;SignatureAlgorithm&nbsp;wasn&#39;t&nbsp;copied&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6994571">,</span>&nbsp;<span class="ident" id="6994573">test</span><span class="op" id="6994577">.</span><span class="ident" id="6994578">name</span><span class="op" id="6994582">,</span>&nbsp;<span class="ident" id="6994584">cert</span><span class="op" id="6994588">.</span><span class="ident" id="6994589">SignatureAlgorithm</span><span class="op" id="6994607">,</span>&nbsp;<span class="ident" id="6994609">test</span><span class="op" id="6994613">.</span><span class="ident" id="6994614">sigAlgo</span><span class="op" id="6994621">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6994625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6994630">if</span>&nbsp;<span class="op" id="6994633">!</span><span class="ident" id="6994634">reflect</span><span class="op" id="6994641">.</span><span class="ident" id="6994642">DeepEqual</span><span class="op" id="6994651">(</span><span class="ident" id="6994652">cert</span><span class="op" id="6994656">.</span><span class="ident" id="6994657">ExtKeyUsage</span><span class="op" id="6994668">,</span>&nbsp;<span class="ident" id="6994670">testExtKeyUsage</span><span class="op" id="6994685">)</span>&nbsp;<span class="op" id="6994687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6994692">t</span><span class="op" id="6994693">.</span><span class="ident" id="6994694">Errorf</span><span class="op" id="6994700">(</span><span class="string" id="6994701">&#34;%s:&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6994777">,</span>&nbsp;<span class="ident" id="6994779">test</span><span class="op" id="6994783">.</span><span class="ident" id="6994784">name</span><span class="op" id="6994788">,</span>&nbsp;<span class="ident" id="6994790">cert</span><span class="op" id="6994794">.</span><span class="ident" id="6994795">ExtKeyUsage</span><span class="op" id="6994806">,</span>&nbsp;<span class="ident" id="6994808">testExtKeyUsage</span><span class="op" id="6994823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6994827">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6994832">if</span>&nbsp;<span class="op" id="6994835">!</span><span class="ident" id="6994836">reflect</span><span class="op" id="6994843">.</span><span class="ident" id="6994844">DeepEqual</span><span class="op" id="6994853">(</span><span class="ident" id="6994854">cert</span><span class="op" id="6994858">.</span><span class="ident" id="6994859">UnknownExtKeyUsage</span><span class="op" id="6994877">,</span>&nbsp;<span class="ident" id="6994879">testUnknownExtKeyUsage</span><span class="op" id="6994901">)</span>&nbsp;<span class="op" id="6994903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6994908">t</span><span class="op" id="6994909">.</span><span class="ident" id="6994910">Errorf</span><span class="op" id="6994916">(</span><span class="string" id="6994917">&#34;%s:&nbsp;unknown&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6995001">,</span>&nbsp;<span class="ident" id="6995003">test</span><span class="op" id="6995007">.</span><span class="ident" id="6995008">name</span><span class="op" id="6995012">,</span>&nbsp;<span class="ident" id="6995014">cert</span><span class="op" id="6995018">.</span><span class="ident" id="6995019">UnknownExtKeyUsage</span><span class="op" id="6995037">,</span>&nbsp;<span class="ident" id="6995039">testUnknownExtKeyUsage</span><span class="op" id="6995061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6995065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6995070">if</span>&nbsp;<span class="op" id="6995073">!</span><span class="ident" id="6995074">reflect</span><span class="op" id="6995081">.</span><span class="ident" id="6995082">DeepEqual</span><span class="op" id="6995091">(</span><span class="ident" id="6995092">cert</span><span class="op" id="6995096">.</span><span class="ident" id="6995097">OCSPServer</span><span class="op" id="6995107">,</span>&nbsp;<span class="ident" id="6995109">template</span><span class="op" id="6995117">.</span><span class="ident" id="6995118">OCSPServer</span><span class="op" id="6995128">)</span>&nbsp;<span class="op" id="6995130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6995135">t</span><span class="op" id="6995136">.</span><span class="ident" id="6995137">Errorf</span><span class="op" id="6995143">(</span><span class="string" id="6995144">&#34;%s:&nbsp;OCSP&nbsp;servers&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6995200">,</span>&nbsp;<span class="ident" id="6995202">test</span><span class="op" id="6995206">.</span><span class="ident" id="6995207">name</span><span class="op" id="6995211">,</span>&nbsp;<span class="ident" id="6995213">cert</span><span class="op" id="6995217">.</span><span class="ident" id="6995218">OCSPServer</span><span class="op" id="6995228">,</span>&nbsp;<span class="ident" id="6995230">template</span><span class="op" id="6995238">.</span><span class="ident" id="6995239">OCSPServer</span><span class="op" id="6995249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6995253">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6995258">if</span>&nbsp;<span class="op" id="6995261">!</span><span class="ident" id="6995262">reflect</span><span class="op" id="6995269">.</span><span class="ident" id="6995270">DeepEqual</span><span class="op" id="6995279">(</span><span class="ident" id="6995280">cert</span><span class="op" id="6995284">.</span><span class="ident" id="6995285">IssuingCertificateURL</span><span class="op" id="6995306">,</span>&nbsp;<span class="ident" id="6995308">template</span><span class="op" id="6995316">.</span><span class="ident" id="6995317">IssuingCertificateURL</span><span class="op" id="6995338">)</span>&nbsp;<span class="op" id="6995340">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6995345">t</span><span class="op" id="6995346">.</span><span class="ident" id="6995347">Errorf</span><span class="op" id="6995353">(</span><span class="string" id="6995354">&#34;%s:&nbsp;Issuing&nbsp;certificate&nbsp;URLs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6995422">,</span>&nbsp;<span class="ident" id="6995424">test</span><span class="op" id="6995428">.</span><span class="ident" id="6995429">name</span><span class="op" id="6995433">,</span>&nbsp;<span class="ident" id="6995435">cert</span><span class="op" id="6995439">.</span><span class="ident" id="6995440">IssuingCertificateURL</span><span class="op" id="6995461">,</span>&nbsp;<span class="ident" id="6995463">template</span><span class="op" id="6995471">.</span><span class="ident" id="6995472">IssuingCertificateURL</span><span class="op" id="6995493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6995497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6995502">if</span>&nbsp;<span class="op" id="6995505">!</span><span class="ident" id="6995506">reflect</span><span class="op" id="6995513">.</span><span class="ident" id="6995514">DeepEqual</span><span class="op" id="6995523">(</span><span class="ident" id="6995524">cert</span><span class="op" id="6995528">.</span><span class="ident" id="6995529">DNSNames</span><span class="op" id="6995537">,</span>&nbsp;<span class="ident" id="6995539">template</span><span class="op" id="6995547">.</span><span class="ident" id="6995548">DNSNames</span><span class="op" id="6995556">)</span>&nbsp;<span class="op" id="6995558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6995563">t</span><span class="op" id="6995564">.</span><span class="ident" id="6995565">Errorf</span><span class="op" id="6995571">(</span><span class="string" id="6995572">&#34;%s:&nbsp;SAN&nbsp;DNS&nbsp;names&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6995629">,</span>&nbsp;<span class="ident" id="6995631">test</span><span class="op" id="6995635">.</span><span class="ident" id="6995636">name</span><span class="op" id="6995640">,</span>&nbsp;<span class="ident" id="6995642">cert</span><span class="op" id="6995646">.</span><span class="ident" id="6995647">DNSNames</span><span class="op" id="6995655">,</span>&nbsp;<span class="ident" id="6995657">template</span><span class="op" id="6995665">.</span><span class="ident" id="6995666">DNSNames</span><span class="op" id="6995674">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6995678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6995683">if</span>&nbsp;<span class="op" id="6995686">!</span><span class="ident" id="6995687">reflect</span><span class="op" id="6995694">.</span><span class="ident" id="6995695">DeepEqual</span><span class="op" id="6995704">(</span><span class="ident" id="6995705">cert</span><span class="op" id="6995709">.</span><span class="ident" id="6995710">EmailAddresses</span><span class="op" id="6995724">,</span>&nbsp;<span class="ident" id="6995726">template</span><span class="op" id="6995734">.</span><span class="ident" id="6995735">EmailAddresses</span><span class="op" id="6995749">)</span>&nbsp;<span class="op" id="6995751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6995756">t</span><span class="op" id="6995757">.</span><span class="ident" id="6995758">Errorf</span><span class="op" id="6995764">(</span><span class="string" id="6995765">&#34;%s:&nbsp;SAN&nbsp;emails&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6995819">,</span>&nbsp;<span class="ident" id="6995821">test</span><span class="op" id="6995825">.</span><span class="ident" id="6995826">name</span><span class="op" id="6995830">,</span>&nbsp;<span class="ident" id="6995832">cert</span><span class="op" id="6995836">.</span><span class="ident" id="6995837">EmailAddresses</span><span class="op" id="6995851">,</span>&nbsp;<span class="ident" id="6995853">template</span><span class="op" id="6995861">.</span><span class="ident" id="6995862">EmailAddresses</span><span class="op" id="6995876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6995880">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6995885">if</span>&nbsp;<span class="op" id="6995888">!</span><span class="ident" id="6995889">reflect</span><span class="op" id="6995896">.</span><span class="ident" id="6995897">DeepEqual</span><span class="op" id="6995906">(</span><span class="ident" id="6995907">cert</span><span class="op" id="6995911">.</span><span class="ident" id="6995912">IPAddresses</span><span class="op" id="6995923">,</span>&nbsp;<span class="ident" id="6995925">template</span><span class="op" id="6995933">.</span><span class="ident" id="6995934">IPAddresses</span><span class="op" id="6995945">)</span>&nbsp;<span class="op" id="6995947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6995952">t</span><span class="op" id="6995953">.</span><span class="ident" id="6995954">Errorf</span><span class="op" id="6995960">(</span><span class="string" id="6995961">&#34;%s:&nbsp;SAN&nbsp;IPs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6996012">,</span>&nbsp;<span class="ident" id="6996014">test</span><span class="op" id="6996018">.</span><span class="ident" id="6996019">name</span><span class="op" id="6996023">,</span>&nbsp;<span class="ident" id="6996025">cert</span><span class="op" id="6996029">.</span><span class="ident" id="6996030">IPAddresses</span><span class="op" id="6996041">,</span>&nbsp;<span class="ident" id="6996043">template</span><span class="op" id="6996051">.</span><span class="ident" id="6996052">IPAddresses</span><span class="op" id="6996063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6996067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6996072">if</span>&nbsp;<span class="op" id="6996075">!</span><span class="ident" id="6996076">reflect</span><span class="op" id="6996083">.</span><span class="ident" id="6996084">DeepEqual</span><span class="op" id="6996093">(</span><span class="ident" id="6996094">cert</span><span class="op" id="6996098">.</span><span class="ident" id="6996099">CRLDistributionPoints</span><span class="op" id="6996120">,</span>&nbsp;<span class="ident" id="6996122">template</span><span class="op" id="6996130">.</span><span class="ident" id="6996131">CRLDistributionPoints</span><span class="op" id="6996152">)</span>&nbsp;<span class="op" id="6996154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6996159">t</span><span class="op" id="6996160">.</span><span class="ident" id="6996161">Errorf</span><span class="op" id="6996167">(</span><span class="string" id="6996168">&#34;%s:&nbsp;CRL&nbsp;distribution&nbsp;points&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6996235">,</span>&nbsp;<span class="ident" id="6996237">test</span><span class="op" id="6996241">.</span><span class="ident" id="6996242">name</span><span class="op" id="6996246">,</span>&nbsp;<span class="ident" id="6996248">cert</span><span class="op" id="6996252">.</span><span class="ident" id="6996253">CRLDistributionPoints</span><span class="op" id="6996274">,</span>&nbsp;<span class="ident" id="6996276">template</span><span class="op" id="6996284">.</span><span class="ident" id="6996285">CRLDistributionPoints</span><span class="op" id="6996306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6996310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6996315">if</span>&nbsp;<span class="op" id="6996318">!</span><span class="ident" id="6996319">bytes</span><span class="op" id="6996324">.</span><span class="ident" id="6996325">Equal</span><span class="op" id="6996330">(</span><span class="ident" id="6996331">cert</span><span class="op" id="6996335">.</span><span class="ident" id="6996336">SubjectKeyId</span><span class="op" id="6996348">,</span>&nbsp;<span class="op" id="6996350">[</span><span class="op" id="6996351">]</span><span class="builtintype" id="6996352">byte</span><span class="op" id="6996356">{</span><span class="num" id="6996357">4</span><span class="op" id="6996358">,</span>&nbsp;<span class="num" id="6996360">3</span><span class="op" id="6996361">,</span>&nbsp;<span class="num" id="6996363">2</span><span class="op" id="6996364">,</span>&nbsp;<span class="num" id="6996366">1</span><span class="op" id="6996367">}</span><span class="op" id="6996368">)</span>&nbsp;<span class="op" id="6996370">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6996375">t</span><span class="op" id="6996376">.</span><span class="ident" id="6996377">Errorf</span><span class="op" id="6996383">(</span><span class="string" id="6996384">&#34;%s:&nbsp;ExtraExtensions&nbsp;didn&#39;t&nbsp;override&nbsp;SubjectKeyId&#34;</span><span class="op" id="6996434">,</span>&nbsp;<span class="ident" id="6996436">test</span><span class="op" id="6996440">.</span><span class="ident" id="6996441">name</span><span class="op" id="6996445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6996449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6996454">if</span>&nbsp;<span class="ident" id="6996457">bytes</span><span class="op" id="6996462">.</span><span class="ident" id="6996463">Index</span><span class="op" id="6996468">(</span><span class="ident" id="6996469">derBytes</span><span class="op" id="6996477">,</span>&nbsp;<span class="ident" id="6996479">extraExtensionData</span><span class="op" id="6996497">)</span>&nbsp;<span class="op" id="6996499">==</span>&nbsp;<span class="op" id="6996502">-</span><span class="num" id="6996503">1</span>&nbsp;<span class="op" id="6996505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6996510">t</span><span class="op" id="6996511">.</span><span class="ident" id="6996512">Errorf</span><span class="op" id="6996518">(</span><span class="string" id="6996519">&#34;%s:&nbsp;didn&#39;t&nbsp;find&nbsp;extra&nbsp;extension&nbsp;in&nbsp;DER&nbsp;output&#34;</span><span class="op" id="6996566">,</span>&nbsp;<span class="ident" id="6996568">test</span><span class="op" id="6996572">.</span><span class="ident" id="6996573">name</span><span class="op" id="6996577">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6996581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6996586">if</span>&nbsp;<span class="ident" id="6996589">test</span><span class="op" id="6996593">.</span><span class="ident" id="6996594">checkSig</span>&nbsp;<span class="op" id="6996603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6996608">err</span>&nbsp;<span class="op" id="6996612">=</span>&nbsp;<span class="ident" id="6996614">cert</span><span class="op" id="6996618">.</span><span class="ident" id="6996619">CheckSignatureFrom</span><span class="op" id="6996637">(</span><span class="ident" id="6996638">cert</span><span class="op" id="6996642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6996647">if</span>&nbsp;<span class="ident" id="6996650">err</span>&nbsp;<span class="op" id="6996654">!=</span>&nbsp;<span class="ident" id="6996657">nil</span>&nbsp;<span class="op" id="6996661">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6996667">t</span><span class="op" id="6996668">.</span><span class="ident" id="6996669">Errorf</span><span class="op" id="6996675">(</span><span class="string" id="6996676">&#34;%s:&nbsp;signature&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="6996715">,</span>&nbsp;<span class="ident" id="6996717">test</span><span class="op" id="6996721">.</span><span class="ident" id="6996722">name</span><span class="op" id="6996726">,</span>&nbsp;<span class="ident" id="6996728">err</span><span class="op" id="6996731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6996736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6996740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6996743">}</span><br>
<span class="lineno"></span><span class="op" id="6996745">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="comment" id="6996748">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA1&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno"></span><span class="keyword" id="6996809">var</span>&nbsp;<span class="ident" id="6996813">ecdsaSHA1CertPem</span>&nbsp;<span class="op" id="6996830">=</span>&nbsp;<span class="string" id="6996832">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDjCCAbUCCQDF6SfN0nsnrjAJBgcqhkjOPQQBMIGPMQswCQYDVQQGEwJVUzET<br>
<span class="lineno">455</span>MBEGA1UECAwKQ2FsaWZvcm5pYTEWMBQGA1UEBwwNTW91bnRhaW4gVmlldzEVMBMG<br>
<span class="lineno"></span>A1UECgwMR29vZ2xlLCBJbmMuMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIwMjAyMDUw<br>
<span class="lineno"></span>WhcNMjIwNTE4MjAyMDUwWjCBjzELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTATBgNVBAoMDEdvb2dsZSwg<br>
<span class="lineno">460</span>SW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAhBgkqhkiG9w0BCQEWFGdv<br>
<span class="lineno"></span>bGFuZy1kZXZAZ21haWwuY29tMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE/Wgn<br>
<span class="lineno"></span>WQDo5+bz71T0327ERgd5SDDXFbXLpzIZDXTkjpe8QTEbsF+ezsQfrekrpDPC4Cd3<br>
<span class="lineno"></span>P9LY0tG+aI8IyVKdUjAJBgcqhkjOPQQBA0gAMEUCIGlsqMcRqWVIWTD6wXwe6Jk2<br>
<span class="lineno"></span>DKxL46r/FLgJYnzBEH99AiEA3fBouObsvV1R3oVkb4BQYnD4/4LeId6lAT43YvyV<br>
<span class="lineno">465</span>a/A=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6997611">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno">470</span><span class="keyword" id="6997674">var</span>&nbsp;<span class="ident" id="6997678">ecdsaSHA256p256CertPem</span>&nbsp;<span class="op" id="6997701">=</span>&nbsp;<span class="string" id="6997703">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDzCCAbYCCQDlsuMWvgQzhTAKBggqhkjOPQQDAjCBjzELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTAT<br>
<span class="lineno"></span>BgNVBAoMDEdvb2dsZSwgSW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAh<br>
<span class="lineno">475</span>BgkqhkiG9w0BCQEWFGdvbGFuZy1kZXZAZ21haWwuY29tMB4XDTEyMDUyMTAwMTkx<br>
<span class="lineno"></span>NloXDTIyMDUxOTAwMTkxNlowgY8xCzAJBgNVBAYTAlVTMRMwEQYDVQQIDApDYWxp<br>
<span class="lineno"></span>Zm9ybmlhMRYwFAYDVQQHDA1Nb3VudGFpbiBWaWV3MRUwEwYDVQQKDAxHb29nbGUs<br>
<span class="lineno"></span>IEluYy4xFzAVBgNVBAMMDnd3dy5nb29nbGUuY29tMSMwIQYJKoZIhvcNAQkBFhRn<br>
<span class="lineno"></span>b2xhbmctZGV2QGdtYWlsLmNvbTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABPMt<br>
<span class="lineno">480</span>2ErhxAty5EJRu9yM+MTy+hUXm3pdW1ensAv382KoGExSXAFWP7pjJnNtHO+XSwVm<br>
<span class="lineno"></span>YNtqjcAGFKpweoN//kQwCgYIKoZIzj0EAwIDRwAwRAIgIYSaUA/IB81gjbIw/hUV<br>
<span class="lineno"></span>70twxJr5EcgOo0hLp3Jm+EYCIFDO3NNcgmURbJ1kfoS3N/0O+irUtoPw38YoNkqJ<br>
<span class="lineno"></span>h5wi<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno">485</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6998482">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp384r1</span><br>
<span class="lineno"></span><span class="keyword" id="6998545">var</span>&nbsp;<span class="ident" id="6998549">ecdsaSHA256p384CertPem</span>&nbsp;<span class="op" id="6998572">=</span>&nbsp;<span class="string" id="6998574">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno">490</span>MIICSjCCAdECCQDje/no7mXkVzAKBggqhkjOPQQDAjCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMDYxMDM0<br>
<span class="lineno"></span>WhcNMjIwNTE5MDYxMDM0WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno">495</span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno"></span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wdjAQBgcqhkjOPQIBBgUrgQQAIgNiAARRuzRNIKRK<br>
<span class="lineno"></span>jIktEmXanNmrTR/q/FaHXLhWRZ6nHWe26Fw7Rsrbk+VjGy4vfWtNn7xSFKrOu5ze<br>
<span class="lineno"></span>qxKnmE0h5E480MNgrUiRkaGO2GMJJVmxx20aqkXOk59U8yGA4CghE6MwCgYIKoZI<br>
<span class="lineno">500</span>zj0EAwIDZwAwZAIwBZEN8gvmRmfeP/9C1PRLzODIY4JqWub2PLRT4mv9GU+yw3Gr<br>
<span class="lineno"></span>PU9A3CHMdEcdw/MEAjBBO1lId8KOCh9UZunsSMfqXiVurpzmhWd6VYZ/32G+M+Mh<br>
<span class="lineno"></span>3yILeYQzllt/g0rKVRk=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="comment" id="6999434">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA384&nbsp;&amp;&nbsp;secp521r1</span><br>
<span class="lineno"></span><span class="keyword" id="6999497">var</span>&nbsp;<span class="ident" id="6999501">ecdsaSHA384p521CertPem</span>&nbsp;<span class="op" id="6999524">=</span>&nbsp;<span class="string" id="6999526">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICljCCAfcCCQDhp1AFD/ahKjAKBggqhkjOPQQDAzCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno">510</span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMTUwNDI5<br>
<span class="lineno"></span>WhcNMjIwNTE5MTUwNDI5WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno">515</span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wgZswEAYHKoZIzj0CAQYFK4EEACMDgYYABACqx9Rv<br>
<span class="lineno"></span>IssRs1LWYcNN+WffwlHw4Tv3y8/LIAA9MF1ZScIonU9nRMxt4a2uGJVCPDw6JHpz<br>
<span class="lineno"></span>PaYc0E9puLoE9AfKpwFr59Jkot7dBg55SKPEFkddoip/rvmN7NPAWjMBirOwjOkm<br>
<span class="lineno"></span>8FPthvPhGPqsu9AvgVuHu3PosWiHGNrhh379pva8MzAKBggqhkjOPQQDAwOBjAAw<br>
<span class="lineno">520</span>gYgCQgEHNmswkUdPpHqrVxp9PvLVl+xxPuHBkT+75z9JizyxtqykHQo9Uh6SWCYH<br>
<span class="lineno"></span>BF9KLolo01wMt8DjoYP5Fb3j5MH7xwJCAbWZzTOp4l4DPkIvAh4LeC4VWbwPPyqh<br>
<span class="lineno"></span>kBg71w/iEcSY3wUKgHGcJJrObZw7wys91I5kENljqw/Samdr3ka+jBJa<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span><span class="keyword" id="7000487">var</span>&nbsp;<span class="ident" id="7000491">ecdsaTests</span>&nbsp;<span class="op" id="7000502">=</span>&nbsp;<span class="op" id="7000504">[</span><span class="op" id="7000505">]</span><span class="keyword" id="7000506">struct</span>&nbsp;<span class="op" id="7000513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7000516">sigAlgo</span>&nbsp;<span class="ident" id="7000524">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7000544">pemCert</span>&nbsp;<span class="builtintype" id="7000552">string</span><br>
<span class="lineno"></span><span class="op" id="7000559">}</span><span class="op" id="7000560">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7000563">{</span><span class="ident" id="7000564">ECDSAWithSHA1</span><span class="op" id="7000577">,</span>&nbsp;<span class="ident" id="7000579">ecdsaSHA1CertPem</span><span class="op" id="7000595">}</span><span class="op" id="7000596">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7000599">{</span><span class="ident" id="7000600">ECDSAWithSHA256</span><span class="op" id="7000615">,</span>&nbsp;<span class="ident" id="7000617">ecdsaSHA256p256CertPem</span><span class="op" id="7000639">}</span><span class="op" id="7000640">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7000643">{</span><span class="ident" id="7000644">ECDSAWithSHA256</span><span class="op" id="7000659">,</span>&nbsp;<span class="ident" id="7000661">ecdsaSHA256p384CertPem</span><span class="op" id="7000683">}</span><span class="op" id="7000684">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7000687">{</span><span class="ident" id="7000688">ECDSAWithSHA384</span><span class="op" id="7000703">,</span>&nbsp;<span class="ident" id="7000705">ecdsaSHA384p521CertPem</span><span class="op" id="7000727">}</span><span class="op" id="7000728">,</span><br>
<span class="lineno"></span><span class="op" id="7000730">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="keyword" id="7000733">func</span>&nbsp;<span class="ident" id="7000738">TestECDSA</span><span class="op" id="7000747">(</span><span class="ident" id="7000748">t</span>&nbsp;<span class="op" id="7000750">*</span><span class="ident" id="7000751">testing</span><span class="op" id="7000758">.</span><span class="ident" id="7000759">T</span><span class="op" id="7000760">)</span>&nbsp;<span class="op" id="7000762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7000765">for</span>&nbsp;<span class="ident" id="7000769">i</span><span class="op" id="7000770">,</span>&nbsp;<span class="ident" id="7000772">test</span>&nbsp;<span class="op" id="7000777">:=</span>&nbsp;<span class="keyword" id="7000780">range</span>&nbsp;<span class="ident" id="7000786">ecdsaTests</span>&nbsp;<span class="op" id="7000797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7000801">pemBlock</span><span class="op" id="7000809">,</span>&nbsp;<span class="ident" id="7000811">_</span>&nbsp;<span class="op" id="7000813">:=</span>&nbsp;<span class="ident" id="7000816">pem</span><span class="op" id="7000819">.</span><span class="ident" id="7000820">Decode</span><span class="op" id="7000826">(</span><span class="op" id="7000827">[</span><span class="op" id="7000828">]</span><span class="builtintype" id="7000829">byte</span><span class="op" id="7000833">(</span><span class="ident" id="7000834">test</span><span class="op" id="7000838">.</span><span class="ident" id="7000839">pemCert</span><span class="op" id="7000846">)</span><span class="op" id="7000847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7000851">cert</span><span class="op" id="7000855">,</span>&nbsp;<span class="ident" id="7000857">err</span>&nbsp;<span class="op" id="7000861">:=</span>&nbsp;<span class="ident" id="7000864">ParseCertificate</span><span class="op" id="7000880">(</span><span class="ident" id="7000881">pemBlock</span><span class="op" id="7000889">.</span><span class="ident" id="7000890">Bytes</span><span class="op" id="7000895">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7000899">if</span>&nbsp;<span class="ident" id="7000902">err</span>&nbsp;<span class="op" id="7000906">!=</span>&nbsp;<span class="ident" id="7000909">nil</span>&nbsp;<span class="op" id="7000913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7000918">t</span><span class="op" id="7000919">.</span><span class="ident" id="7000920">Errorf</span><span class="op" id="7000926">(</span><span class="string" id="7000927">&#34;%d:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7000964">,</span>&nbsp;<span class="ident" id="7000966">i</span><span class="op" id="7000967">,</span>&nbsp;<span class="ident" id="7000969">err</span><span class="op" id="7000972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7000977">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7000988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7000992">if</span>&nbsp;<span class="ident" id="7000995">sa</span>&nbsp;<span class="op" id="7000998">:=</span>&nbsp;<span class="ident" id="7001001">cert</span><span class="op" id="7001005">.</span><span class="ident" id="7001006">SignatureAlgorithm</span><span class="op" id="7001024">;</span>&nbsp;<span class="ident" id="7001026">sa</span>&nbsp;<span class="op" id="7001029">!=</span>&nbsp;<span class="ident" id="7001032">test</span><span class="op" id="7001036">.</span><span class="ident" id="7001037">sigAlgo</span>&nbsp;<span class="op" id="7001045">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7001050">t</span><span class="op" id="7001051">.</span><span class="ident" id="7001052">Errorf</span><span class="op" id="7001058">(</span><span class="string" id="7001059">&#34;%d:&nbsp;signature&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7001099">,</span>&nbsp;<span class="ident" id="7001101">i</span><span class="op" id="7001102">,</span>&nbsp;<span class="ident" id="7001104">sa</span><span class="op" id="7001106">,</span>&nbsp;<span class="ident" id="7001108">test</span><span class="op" id="7001112">.</span><span class="ident" id="7001113">sigAlgo</span><span class="op" id="7001120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7001124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7001128">if</span>&nbsp;<span class="ident" id="7001131">parsedKey</span><span class="op" id="7001140">,</span>&nbsp;<span class="ident" id="7001142">ok</span>&nbsp;<span class="op" id="7001145">:=</span>&nbsp;<span class="ident" id="7001148">cert</span><span class="op" id="7001152">.</span><span class="ident" id="7001153">PublicKey</span><span class="op" id="7001162">.</span><span class="op" id="7001163">(</span><span class="op" id="7001164">*</span><span class="ident" id="7001165">ecdsa</span><span class="op" id="7001170">.</span><span class="ident" id="7001171">PublicKey</span><span class="op" id="7001180">)</span><span class="op" id="7001181">;</span>&nbsp;<span class="op" id="7001183">!</span><span class="ident" id="7001184">ok</span>&nbsp;<span class="op" id="7001187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7001192">t</span><span class="op" id="7001193">.</span><span class="ident" id="7001194">Errorf</span><span class="op" id="7001200">(</span><span class="string" id="7001201">&#34;%d:&nbsp;wanted&nbsp;an&nbsp;ECDSA&nbsp;public&nbsp;key&nbsp;but&nbsp;found:&nbsp;%#v&#34;</span><span class="op" id="7001248">,</span>&nbsp;<span class="ident" id="7001250">i</span><span class="op" id="7001251">,</span>&nbsp;<span class="ident" id="7001253">parsedKey</span><span class="op" id="7001262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7001266">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7001270">if</span>&nbsp;<span class="ident" id="7001273">pka</span>&nbsp;<span class="op" id="7001277">:=</span>&nbsp;<span class="ident" id="7001280">cert</span><span class="op" id="7001284">.</span><span class="ident" id="7001285">PublicKeyAlgorithm</span><span class="op" id="7001303">;</span>&nbsp;<span class="ident" id="7001305">pka</span>&nbsp;<span class="op" id="7001309">!=</span>&nbsp;<span class="ident" id="7001312">ECDSA</span>&nbsp;<span class="op" id="7001318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7001323">t</span><span class="op" id="7001324">.</span><span class="ident" id="7001325">Errorf</span><span class="op" id="7001331">(</span><span class="string" id="7001332">&#34;%d:&nbsp;public&nbsp;key&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;ECDSA&#34;</span><span class="op" id="7001376">,</span>&nbsp;<span class="ident" id="7001378">i</span><span class="op" id="7001379">,</span>&nbsp;<span class="ident" id="7001381">pka</span><span class="op" id="7001384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7001388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7001392">if</span>&nbsp;<span class="ident" id="7001395">err</span>&nbsp;<span class="op" id="7001399">=</span>&nbsp;<span class="ident" id="7001401">cert</span><span class="op" id="7001405">.</span><span class="ident" id="7001406">CheckSignatureFrom</span><span class="op" id="7001424">(</span><span class="ident" id="7001425">cert</span><span class="op" id="7001429">)</span><span class="op" id="7001430">;</span>&nbsp;<span class="ident" id="7001432">err</span>&nbsp;<span class="op" id="7001436">!=</span>&nbsp;<span class="ident" id="7001439">nil</span>&nbsp;<span class="op" id="7001443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7001448">t</span><span class="op" id="7001449">.</span><span class="ident" id="7001450">Errorf</span><span class="op" id="7001456">(</span><span class="string" id="7001457">&#34;%d:&nbsp;certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="7001498">,</span>&nbsp;<span class="ident" id="7001500">i</span><span class="op" id="7001501">,</span>&nbsp;<span class="ident" id="7001503">err</span><span class="op" id="7001506">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7001510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7001513">}</span><br>
<span class="lineno"></span><span class="op" id="7001515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7001518">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;DSA&nbsp;with&nbsp;SHA1</span><br>
<span class="lineno">560</span><span class="keyword" id="7001565">var</span>&nbsp;<span class="ident" id="7001569">dsaCertPem</span>&nbsp;<span class="op" id="7001580">=</span>&nbsp;<span class="string" id="7001582">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIEDTCCA82gAwIBAgIJALHPghaoxeDhMAkGByqGSM44BAMweTELMAkGA1UEBhMC<br>
<span class="lineno"></span>VVMxCzAJBgNVBAgTAk5DMQ8wDQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2ds<br>
<span class="lineno"></span>ZSwgSW5jMRIwEAYDVQQDEwlKb24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFs<br>
<span class="lineno"></span>bGllQGdvb2dsZS5jb20wHhcNMTEwNTE0MDMwMTQ1WhcNMTEwNjEzMDMwMTQ1WjB5<br>
<span class="lineno">565</span>MQswCQYDVQQGEwJVUzELMAkGA1UECBMCTkMxDzANBgNVBAcTBk5ld3RvbjEUMBIG<br>
<span class="lineno"></span>A1UEChMLR29vZ2xlLCBJbmMxEjAQBgNVBAMTCUpvbiBBbGxpZTEiMCAGCSqGSIb3<br>
<span class="lineno"></span>DQEJARYTam9uYWxsaWVAZ29vZ2xlLmNvbTCCAbcwggEsBgcqhkjOOAQBMIIBHwKB<br>
<span class="lineno"></span>gQC8hLUnQ7FpFYu4WXTj6DKvXvz8QrJkNJCVMTpKAT7uBpobk32S5RrPKXocd4gN<br>
<span class="lineno"></span>8lyGB9ggS03EVlEwXvSmO0DH2MQtke2jl9j1HLydClMf4sbx5V6TV9IFw505U1iW<br>
<span class="lineno">570</span>jL7awRMgxge+FsudtJK254FjMFo03ZnOQ8ZJJ9E6AEDrlwIVAJpnBn9moyP11Ox5<br>
<span class="lineno"></span>Asc/5dnjb6dPAoGBAJFHd4KVv1iTVCvEG6gGiYop5DJh28hUQcN9kul+2A0yPUSC<br>
<span class="lineno"></span>X93oN00P8Vh3eYgSaCWZsha7zDG53MrVJ0Zf6v/X/CoZNhLldeNOepivTRAzn+Rz<br>
<span class="lineno"></span>kKUYy5l1sxYLHQKF0UGNCXfFKZT0PCmgU+PWhYNBBMn6/cIh44vp85ideo5CA4GE<br>
<span class="lineno"></span>AAKBgFmifCafzeRaohYKXJgMGSEaggCVCRq5xdyDCat+wbOkjC4mfG01/um3G8u5<br>
<span class="lineno">575</span>LxasjlWRKTR/tcAL7t0QuokVyQaYdVypZXNaMtx1db7YBuHjj3aP+8JOQRI9xz8c<br>
<span class="lineno"></span>bp5NDJ5pISiFOv4p3GZfqZPcqckDt78AtkQrmnal2txhhjF6o4HeMIHbMB0GA1Ud<br>
<span class="lineno"></span>DgQWBBQVyyr7hO11ZFFpWX50298Sa3V+rzCBqwYDVR0jBIGjMIGggBQVyyr7hO11<br>
<span class="lineno"></span>ZFFpWX50298Sa3V+r6F9pHsweTELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAk5DMQ8w<br>
<span class="lineno"></span>DQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2dsZSwgSW5jMRIwEAYDVQQDEwlK<br>
<span class="lineno">580</span>b24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFsbGllQGdvb2dsZS5jb22CCQCx<br>
<span class="lineno"></span>z4IWqMXg4TAMBgNVHRMEBTADAQH/MAkGByqGSM44BAMDLwAwLAIUPtn/5j8Q1jJI<br>
<span class="lineno"></span>7ggOIsgrhgUdjGQCFCsmDq1H11q9+9Wp9IMeGrTSKHIM<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span><span class="keyword" id="7003050">func</span>&nbsp;<span class="ident" id="7003055">TestParseCertificateWithDsaPublicKey</span><span class="op" id="7003091">(</span><span class="ident" id="7003092">t</span>&nbsp;<span class="op" id="7003094">*</span><span class="ident" id="7003095">testing</span><span class="op" id="7003102">.</span><span class="ident" id="7003103">T</span><span class="op" id="7003104">)</span>&nbsp;<span class="op" id="7003106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7003109">expectedKey</span>&nbsp;<span class="op" id="7003121">:=</span>&nbsp;<span class="op" id="7003124">&amp;</span><span class="ident" id="7003125">dsa</span><span class="op" id="7003128">.</span><span class="ident" id="7003129">PublicKey</span><span class="op" id="7003138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7003142">Parameters</span><span class="op" id="7003152">:</span>&nbsp;<span class="ident" id="7003154">dsa</span><span class="op" id="7003157">.</span><span class="ident" id="7003158">Parameters</span><span class="op" id="7003168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7003173">P</span><span class="op" id="7003174">:</span>&nbsp;<span class="ident" id="7003176">bigFromHexString</span><span class="op" id="7003192">(</span><span class="string" id="7003193">&#34;00BC84B52743B169158BB85974E3E832AF5EFCFC42B264349095313A4A013EEE069A1B937D92E51ACF297A1C77880DF25C8607D8204B4DC45651305EF4A63B40C7D8C42D91EDA397D8F51CBC9D0A531FE2C6F1E55E9357D205C39D395358968CBEDAC11320C607BE16CB9DB492B6E78163305A34DD99CE43C64927D13A0040EB97&#34;</span><span class="op" id="7003453">)</span><span class="op" id="7003454">,</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7003459">Q</span><span class="op" id="7003460">:</span>&nbsp;<span class="ident" id="7003462">bigFromHexString</span><span class="op" id="7003478">(</span><span class="string" id="7003479">&#34;009A67067F66A323F5D4EC7902C73FE5D9E36FA74F&#34;</span><span class="op" id="7003523">)</span><span class="op" id="7003524">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7003529">G</span><span class="op" id="7003530">:</span>&nbsp;<span class="ident" id="7003532">bigFromHexString</span><span class="op" id="7003548">(</span><span class="string" id="7003549">&#34;009147778295BF5893542BC41BA806898A29E43261DBC85441C37D92E97ED80D323D44825FDDE8374D0FF15877798812682599B216BBCC31B9DCCAD527465FEAFFD7FC2A193612E575E34E7A98AF4D10339FE47390A518CB9975B3160B1D0285D1418D0977C52994F43C29A053E3D685834104C9FAFDC221E38BE9F3989D7A8E42&#34;</span><span class="op" id="7003809">)</span><span class="op" id="7003810">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7003814">}</span><span class="op" id="7003815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7003819">Y</span><span class="op" id="7003820">:</span>&nbsp;<span class="ident" id="7003822">bigFromHexString</span><span class="op" id="7003838">(</span><span class="string" id="7003839">&#34;59A27C269FCDE45AA2160A5C980C19211A820095091AB9C5DC8309AB7EC1B3A48C2E267C6D35FEE9B71BCBB92F16AC8E559129347FB5C00BEEDD10BA8915C90698755CA965735A32DC7575BED806E1E38F768FFBC24E41123DC73F1C6E9E4D0C9E692128853AFE29DC665FA993DCA9C903B7BF00B6442B9A76A5DADC6186317A&#34;</span><span class="op" id="7004097">)</span><span class="op" id="7004098">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7004101">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7004104">pemBlock</span><span class="op" id="7004112">,</span>&nbsp;<span class="ident" id="7004114">_</span>&nbsp;<span class="op" id="7004116">:=</span>&nbsp;<span class="ident" id="7004119">pem</span><span class="op" id="7004122">.</span><span class="ident" id="7004123">Decode</span><span class="op" id="7004129">(</span><span class="op" id="7004130">[</span><span class="op" id="7004131">]</span><span class="builtintype" id="7004132">byte</span><span class="op" id="7004136">(</span><span class="ident" id="7004137">dsaCertPem</span><span class="op" id="7004147">)</span><span class="op" id="7004148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7004151">cert</span><span class="op" id="7004155">,</span>&nbsp;<span class="ident" id="7004157">err</span>&nbsp;<span class="op" id="7004161">:=</span>&nbsp;<span class="ident" id="7004164">ParseCertificate</span><span class="op" id="7004180">(</span><span class="ident" id="7004181">pemBlock</span><span class="op" id="7004189">.</span><span class="ident" id="7004190">Bytes</span><span class="op" id="7004195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7004198">if</span>&nbsp;<span class="ident" id="7004201">err</span>&nbsp;<span class="op" id="7004205">!=</span>&nbsp;<span class="ident" id="7004208">nil</span>&nbsp;<span class="op" id="7004212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7004216">t</span><span class="op" id="7004217">.</span><span class="ident" id="7004218">Fatalf</span><span class="op" id="7004224">(</span><span class="string" id="7004225">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7004258">,</span>&nbsp;<span class="ident" id="7004260">err</span><span class="op" id="7004263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7004266">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7004269">if</span>&nbsp;<span class="ident" id="7004272">cert</span><span class="op" id="7004276">.</span><span class="ident" id="7004277">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="7004296">!=</span>&nbsp;<span class="ident" id="7004299">DSA</span>&nbsp;<span class="op" id="7004303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7004307">t</span><span class="op" id="7004308">.</span><span class="ident" id="7004309">Errorf</span><span class="op" id="7004315">(</span><span class="string" id="7004316">&#34;Parsed&nbsp;key&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSA&#34;</span><span class="op" id="7004350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7004353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7004356">parsedKey</span><span class="op" id="7004365">,</span>&nbsp;<span class="ident" id="7004367">ok</span>&nbsp;<span class="op" id="7004370">:=</span>&nbsp;<span class="ident" id="7004373">cert</span><span class="op" id="7004377">.</span><span class="ident" id="7004378">PublicKey</span><span class="op" id="7004387">.</span><span class="op" id="7004388">(</span><span class="op" id="7004389">*</span><span class="ident" id="7004390">dsa</span><span class="op" id="7004393">.</span><span class="ident" id="7004394">PublicKey</span><span class="op" id="7004403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7004406">if</span>&nbsp;<span class="op" id="7004409">!</span><span class="ident" id="7004410">ok</span>&nbsp;<span class="op" id="7004413">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7004417">t</span><span class="op" id="7004418">.</span><span class="ident" id="7004419">Fatalf</span><span class="op" id="7004425">(</span><span class="string" id="7004426">&#34;Parsed&nbsp;key&nbsp;was&nbsp;not&nbsp;a&nbsp;DSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7004460">,</span>&nbsp;<span class="ident" id="7004462">err</span><span class="op" id="7004465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7004468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7004471">if</span>&nbsp;<span class="ident" id="7004474">expectedKey</span><span class="op" id="7004485">.</span><span class="ident" id="7004486">Y</span><span class="op" id="7004487">.</span><span class="ident" id="7004488">Cmp</span><span class="op" id="7004491">(</span><span class="ident" id="7004492">parsedKey</span><span class="op" id="7004501">.</span><span class="ident" id="7004502">Y</span><span class="op" id="7004503">)</span>&nbsp;<span class="op" id="7004505">!=</span>&nbsp;<span class="num" id="7004508">0</span>&nbsp;<span class="op" id="7004510">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7004515">expectedKey</span><span class="op" id="7004526">.</span><span class="ident" id="7004527">P</span><span class="op" id="7004528">.</span><span class="ident" id="7004529">Cmp</span><span class="op" id="7004532">(</span><span class="ident" id="7004533">parsedKey</span><span class="op" id="7004542">.</span><span class="ident" id="7004543">P</span><span class="op" id="7004544">)</span>&nbsp;<span class="op" id="7004546">!=</span>&nbsp;<span class="num" id="7004549">0</span>&nbsp;<span class="op" id="7004551">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7004556">expectedKey</span><span class="op" id="7004567">.</span><span class="ident" id="7004568">Q</span><span class="op" id="7004569">.</span><span class="ident" id="7004570">Cmp</span><span class="op" id="7004573">(</span><span class="ident" id="7004574">parsedKey</span><span class="op" id="7004583">.</span><span class="ident" id="7004584">Q</span><span class="op" id="7004585">)</span>&nbsp;<span class="op" id="7004587">!=</span>&nbsp;<span class="num" id="7004590">0</span>&nbsp;<span class="op" id="7004592">||</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7004597">expectedKey</span><span class="op" id="7004608">.</span><span class="ident" id="7004609">G</span><span class="op" id="7004610">.</span><span class="ident" id="7004611">Cmp</span><span class="op" id="7004614">(</span><span class="ident" id="7004615">parsedKey</span><span class="op" id="7004624">.</span><span class="ident" id="7004625">G</span><span class="op" id="7004626">)</span>&nbsp;<span class="op" id="7004628">!=</span>&nbsp;<span class="num" id="7004631">0</span>&nbsp;<span class="op" id="7004633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7004637">t</span><span class="op" id="7004638">.</span><span class="ident" id="7004639">Fatal</span><span class="op" id="7004644">(</span><span class="string" id="7004645">&#34;Parsed&nbsp;key&nbsp;differs&nbsp;from&nbsp;expected&nbsp;key&#34;</span><span class="op" id="7004683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7004686">}</span><br>
<span class="lineno"></span><span class="op" id="7004688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="7004691">func</span>&nbsp;<span class="ident" id="7004696">TestParseCertificateWithDSASignatureAlgorithm</span><span class="op" id="7004741">(</span><span class="ident" id="7004742">t</span>&nbsp;<span class="op" id="7004744">*</span><span class="ident" id="7004745">testing</span><span class="op" id="7004752">.</span><span class="ident" id="7004753">T</span><span class="op" id="7004754">)</span>&nbsp;<span class="op" id="7004756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7004759">pemBlock</span><span class="op" id="7004767">,</span>&nbsp;<span class="ident" id="7004769">_</span>&nbsp;<span class="op" id="7004771">:=</span>&nbsp;<span class="ident" id="7004774">pem</span><span class="op" id="7004777">.</span><span class="ident" id="7004778">Decode</span><span class="op" id="7004784">(</span><span class="op" id="7004785">[</span><span class="op" id="7004786">]</span><span class="builtintype" id="7004787">byte</span><span class="op" id="7004791">(</span><span class="ident" id="7004792">dsaCertPem</span><span class="op" id="7004802">)</span><span class="op" id="7004803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7004806">cert</span><span class="op" id="7004810">,</span>&nbsp;<span class="ident" id="7004812">err</span>&nbsp;<span class="op" id="7004816">:=</span>&nbsp;<span class="ident" id="7004819">ParseCertificate</span><span class="op" id="7004835">(</span><span class="ident" id="7004836">pemBlock</span><span class="op" id="7004844">.</span><span class="ident" id="7004845">Bytes</span><span class="op" id="7004850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7004853">if</span>&nbsp;<span class="ident" id="7004856">err</span>&nbsp;<span class="op" id="7004860">!=</span>&nbsp;<span class="ident" id="7004863">nil</span>&nbsp;<span class="op" id="7004867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7004871">t</span><span class="op" id="7004872">.</span><span class="ident" id="7004873">Fatalf</span><span class="op" id="7004879">(</span><span class="string" id="7004880">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7004913">,</span>&nbsp;<span class="ident" id="7004915">err</span><span class="op" id="7004918">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7004921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7004924">if</span>&nbsp;<span class="ident" id="7004927">cert</span><span class="op" id="7004931">.</span><span class="ident" id="7004932">SignatureAlgorithm</span>&nbsp;<span class="op" id="7004951">!=</span>&nbsp;<span class="ident" id="7004954">DSAWithSHA1</span>&nbsp;<span class="op" id="7004966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7004970">t</span><span class="op" id="7004971">.</span><span class="ident" id="7004972">Errorf</span><span class="op" id="7004978">(</span><span class="string" id="7004979">&#34;Parsed&nbsp;signature&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSAWithSHA1&#34;</span><span class="op" id="7005027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7005030">}</span><br>
<span class="lineno"></span><span class="op" id="7005032">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="7005035">func</span>&nbsp;<span class="ident" id="7005040">TestVerifyCertificateWithDSASignature</span><span class="op" id="7005077">(</span><span class="ident" id="7005078">t</span>&nbsp;<span class="op" id="7005080">*</span><span class="ident" id="7005081">testing</span><span class="op" id="7005088">.</span><span class="ident" id="7005089">T</span><span class="op" id="7005090">)</span>&nbsp;<span class="op" id="7005092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7005095">pemBlock</span><span class="op" id="7005103">,</span>&nbsp;<span class="ident" id="7005105">_</span>&nbsp;<span class="op" id="7005107">:=</span>&nbsp;<span class="ident" id="7005110">pem</span><span class="op" id="7005113">.</span><span class="ident" id="7005114">Decode</span><span class="op" id="7005120">(</span><span class="op" id="7005121">[</span><span class="op" id="7005122">]</span><span class="builtintype" id="7005123">byte</span><span class="op" id="7005127">(</span><span class="ident" id="7005128">dsaCertPem</span><span class="op" id="7005138">)</span><span class="op" id="7005139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7005142">cert</span><span class="op" id="7005146">,</span>&nbsp;<span class="ident" id="7005148">err</span>&nbsp;<span class="op" id="7005152">:=</span>&nbsp;<span class="ident" id="7005155">ParseCertificate</span><span class="op" id="7005171">(</span><span class="ident" id="7005172">pemBlock</span><span class="op" id="7005180">.</span><span class="ident" id="7005181">Bytes</span><span class="op" id="7005186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7005189">if</span>&nbsp;<span class="ident" id="7005192">err</span>&nbsp;<span class="op" id="7005196">!=</span>&nbsp;<span class="ident" id="7005199">nil</span>&nbsp;<span class="op" id="7005203">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7005207">t</span><span class="op" id="7005208">.</span><span class="ident" id="7005209">Fatalf</span><span class="op" id="7005215">(</span><span class="string" id="7005216">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7005249">,</span>&nbsp;<span class="ident" id="7005251">err</span><span class="op" id="7005254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7005257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7005260">//&nbsp;test&nbsp;cert&nbsp;is&nbsp;self-signed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7005289">if</span>&nbsp;<span class="ident" id="7005292">err</span>&nbsp;<span class="op" id="7005296">=</span>&nbsp;<span class="ident" id="7005298">cert</span><span class="op" id="7005302">.</span><span class="ident" id="7005303">CheckSignatureFrom</span><span class="op" id="7005321">(</span><span class="ident" id="7005322">cert</span><span class="op" id="7005326">)</span><span class="op" id="7005327">;</span>&nbsp;<span class="ident" id="7005329">err</span>&nbsp;<span class="op" id="7005333">!=</span>&nbsp;<span class="ident" id="7005336">nil</span>&nbsp;<span class="op" id="7005340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7005344">t</span><span class="op" id="7005345">.</span><span class="ident" id="7005346">Fatalf</span><span class="op" id="7005352">(</span><span class="string" id="7005353">&#34;DSA&nbsp;Certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="7005394">,</span>&nbsp;<span class="ident" id="7005396">err</span><span class="op" id="7005399">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7005402">}</span><br>
<span class="lineno"></span><span class="op" id="7005404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7005407">const</span>&nbsp;<span class="ident" id="7005413">pemCertificate</span>&nbsp;<span class="op" id="7005428">=</span>&nbsp;<span class="string" id="7005430">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIB5DCCAZCgAwIBAgIBATALBgkqhkiG9w0BAQUwLTEQMA4GA1UEChMHQWNtZSBDbzEZMBcGA1UE<br>
<span class="lineno">640</span>AxMQdGVzdC5leGFtcGxlLmNvbTAeFw03MDAxMDEwMDE2NDBaFw03MDAxMDIwMzQ2NDBaMC0xEDAO<br>
<span class="lineno"></span>BgNVBAoTB0FjbWUgQ28xGTAXBgNVBAMTEHRlc3QuZXhhbXBsZS5jb20wWjALBgkqhkiG9w0BAQED<br>
<span class="lineno"></span>SwAwSAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0fd7Ai2KW5ToIwzFo<br>
<span class="lineno"></span>fvJcS/STa6HA5gQenRUCAwEAAaOBnjCBmzAOBgNVHQ8BAf8EBAMCAAQwDwYDVR0TAQH/BAUwAwEB<br>
<span class="lineno"></span>/zANBgNVHQ4EBgQEAQIDBDAPBgNVHSMECDAGgAQBAgMEMBsGA1UdEQQUMBKCEHRlc3QuZXhhbXBs<br>
<span class="lineno">645</span>ZS5jb20wDwYDVR0gBAgwBjAEBgIqAzAqBgNVHR4EIzAhoB8wDoIMLmV4YW1wbGUuY29tMA2CC2V4<br>
<span class="lineno"></span>YW1wbGUuY29tMAsGCSqGSIb3DQEBBQNBAHKZKoS1wEQOGhgklx4+/yFYQlnqwKXvar/ZecQvJwui<br>
<span class="lineno"></span>0seMQnwBhwdBkHfVIU2Fu5VUMRyxlf0ZNaDXcpU581k=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----`</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="keyword" id="7006148">func</span>&nbsp;<span class="ident" id="7006153">TestCRLCreation</span><span class="op" id="7006168">(</span><span class="ident" id="7006169">t</span>&nbsp;<span class="op" id="7006171">*</span><span class="ident" id="7006172">testing</span><span class="op" id="7006179">.</span><span class="ident" id="7006180">T</span><span class="op" id="7006181">)</span>&nbsp;<span class="op" id="7006183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006186">block</span><span class="op" id="7006191">,</span>&nbsp;<span class="ident" id="7006193">_</span>&nbsp;<span class="op" id="7006195">:=</span>&nbsp;<span class="ident" id="7006198">pem</span><span class="op" id="7006201">.</span><span class="ident" id="7006202">Decode</span><span class="op" id="7006208">(</span><span class="op" id="7006209">[</span><span class="op" id="7006210">]</span><span class="builtintype" id="7006211">byte</span><span class="op" id="7006215">(</span><span class="ident" id="7006216">pemPrivateKey</span><span class="op" id="7006229">)</span><span class="op" id="7006230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006233">priv</span><span class="op" id="7006237">,</span>&nbsp;<span class="ident" id="7006239">_</span>&nbsp;<span class="op" id="7006241">:=</span>&nbsp;<span class="ident" id="7006244">ParsePKCS1PrivateKey</span><span class="op" id="7006264">(</span><span class="ident" id="7006265">block</span><span class="op" id="7006270">.</span><span class="ident" id="7006271">Bytes</span><span class="op" id="7006276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006279">block</span><span class="op" id="7006284">,</span>&nbsp;<span class="ident" id="7006286">_</span>&nbsp;<span class="op" id="7006288">=</span>&nbsp;<span class="ident" id="7006290">pem</span><span class="op" id="7006293">.</span><span class="ident" id="7006294">Decode</span><span class="op" id="7006300">(</span><span class="op" id="7006301">[</span><span class="op" id="7006302">]</span><span class="builtintype" id="7006303">byte</span><span class="op" id="7006307">(</span><span class="ident" id="7006308">pemCertificate</span><span class="op" id="7006322">)</span><span class="op" id="7006323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006326">cert</span><span class="op" id="7006330">,</span>&nbsp;<span class="ident" id="7006332">_</span>&nbsp;<span class="op" id="7006334">:=</span>&nbsp;<span class="ident" id="7006337">ParseCertificate</span><span class="op" id="7006353">(</span><span class="ident" id="7006354">block</span><span class="op" id="7006359">.</span><span class="ident" id="7006360">Bytes</span><span class="op" id="7006365">)</span><br>
<span class="lineno">655</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006369">now</span>&nbsp;<span class="op" id="7006373">:=</span>&nbsp;<span class="ident" id="7006376">time</span><span class="op" id="7006380">.</span><span class="ident" id="7006381">Unix</span><span class="op" id="7006385">(</span><span class="num" id="7006386">1000</span><span class="op" id="7006390">,</span>&nbsp;<span class="num" id="7006392">0</span><span class="op" id="7006393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006396">expiry</span>&nbsp;<span class="op" id="7006403">:=</span>&nbsp;<span class="ident" id="7006406">time</span><span class="op" id="7006410">.</span><span class="ident" id="7006411">Unix</span><span class="op" id="7006415">(</span><span class="num" id="7006416">10000</span><span class="op" id="7006421">,</span>&nbsp;<span class="num" id="7006423">0</span><span class="op" id="7006424">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006428">revokedCerts</span>&nbsp;<span class="op" id="7006441">:=</span>&nbsp;<span class="op" id="7006444">[</span><span class="op" id="7006445">]</span><span class="ident" id="7006446">pkix</span><span class="op" id="7006450">.</span><span class="ident" id="7006451">RevokedCertificate</span><span class="op" id="7006469">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7006473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006478">SerialNumber</span><span class="op" id="7006490">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7006494">big</span><span class="op" id="7006497">.</span><span class="ident" id="7006498">NewInt</span><span class="op" id="7006504">(</span><span class="num" id="7006505">1</span><span class="op" id="7006506">)</span><span class="op" id="7006507">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006512">RevocationTime</span><span class="op" id="7006526">:</span>&nbsp;<span class="ident" id="7006528">now</span><span class="op" id="7006531">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7006535">}</span><span class="op" id="7006536">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7006540">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006545">SerialNumber</span><span class="op" id="7006557">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7006561">big</span><span class="op" id="7006564">.</span><span class="ident" id="7006565">NewInt</span><span class="op" id="7006571">(</span><span class="num" id="7006572">42</span><span class="op" id="7006574">)</span><span class="op" id="7006575">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006580">RevocationTime</span><span class="op" id="7006594">:</span>&nbsp;<span class="ident" id="7006596">now</span><span class="op" id="7006599">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7006603">}</span><span class="op" id="7006604">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7006607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006611">crlBytes</span><span class="op" id="7006619">,</span>&nbsp;<span class="ident" id="7006621">err</span>&nbsp;<span class="op" id="7006625">:=</span>&nbsp;<span class="ident" id="7006628">cert</span><span class="op" id="7006632">.</span><span class="ident" id="7006633">CreateCRL</span><span class="op" id="7006642">(</span><span class="ident" id="7006643">rand</span><span class="op" id="7006647">.</span><span class="ident" id="7006648">Reader</span><span class="op" id="7006654">,</span>&nbsp;<span class="ident" id="7006656">priv</span><span class="op" id="7006660">,</span>&nbsp;<span class="ident" id="7006662">revokedCerts</span><span class="op" id="7006674">,</span>&nbsp;<span class="ident" id="7006676">now</span><span class="op" id="7006679">,</span>&nbsp;<span class="ident" id="7006681">expiry</span><span class="op" id="7006687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7006690">if</span>&nbsp;<span class="ident" id="7006693">err</span>&nbsp;<span class="op" id="7006697">!=</span>&nbsp;<span class="ident" id="7006700">nil</span>&nbsp;<span class="op" id="7006704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006708">t</span><span class="op" id="7006709">.</span><span class="ident" id="7006710">Errorf</span><span class="op" id="7006716">(</span><span class="string" id="7006717">&#34;error&nbsp;creating&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="7006741">,</span>&nbsp;<span class="ident" id="7006743">err</span><span class="op" id="7006746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7006749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006753">_</span><span class="op" id="7006754">,</span>&nbsp;<span class="ident" id="7006756">err</span>&nbsp;<span class="op" id="7006760">=</span>&nbsp;<span class="ident" id="7006762">ParseDERCRL</span><span class="op" id="7006773">(</span><span class="ident" id="7006774">crlBytes</span><span class="op" id="7006782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7006785">if</span>&nbsp;<span class="ident" id="7006788">err</span>&nbsp;<span class="op" id="7006792">!=</span>&nbsp;<span class="ident" id="7006795">nil</span>&nbsp;<span class="op" id="7006799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006803">t</span><span class="op" id="7006804">.</span><span class="ident" id="7006805">Errorf</span><span class="op" id="7006811">(</span><span class="string" id="7006812">&#34;error&nbsp;reparsing&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="7006837">,</span>&nbsp;<span class="ident" id="7006839">err</span><span class="op" id="7006842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7006845">}</span><br>
<span class="lineno"></span><span class="op" id="7006847">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="7006850">func</span>&nbsp;<span class="ident" id="7006855">fromBase64</span><span class="op" id="7006865">(</span><span class="ident" id="7006866">in</span>&nbsp;<span class="builtintype" id="7006869">string</span><span class="op" id="7006875">)</span>&nbsp;<span class="op" id="7006877">[</span><span class="op" id="7006878">]</span><span class="builtintype" id="7006879">byte</span>&nbsp;<span class="op" id="7006884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006887">out</span>&nbsp;<span class="op" id="7006891">:=</span>&nbsp;<span class="builtinfunc" id="7006894">make</span><span class="op" id="7006898">(</span><span class="op" id="7006899">[</span><span class="op" id="7006900">]</span><span class="builtintype" id="7006901">byte</span><span class="op" id="7006905">,</span>&nbsp;<span class="ident" id="7006907">base64</span><span class="op" id="7006913">.</span><span class="ident" id="7006914">StdEncoding</span><span class="op" id="7006925">.</span><span class="ident" id="7006926">DecodedLen</span><span class="op" id="7006936">(</span><span class="builtinfunc" id="7006937">len</span><span class="op" id="7006940">(</span><span class="ident" id="7006941">in</span><span class="op" id="7006943">)</span><span class="op" id="7006944">)</span><span class="op" id="7006945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006948">n</span><span class="op" id="7006949">,</span>&nbsp;<span class="ident" id="7006951">err</span>&nbsp;<span class="op" id="7006955">:=</span>&nbsp;<span class="ident" id="7006958">base64</span><span class="op" id="7006964">.</span><span class="ident" id="7006965">StdEncoding</span><span class="op" id="7006976">.</span><span class="ident" id="7006977">Decode</span><span class="op" id="7006983">(</span><span class="ident" id="7006984">out</span><span class="op" id="7006987">,</span>&nbsp;<span class="op" id="7006989">[</span><span class="op" id="7006990">]</span><span class="builtintype" id="7006991">byte</span><span class="op" id="7006995">(</span><span class="ident" id="7006996">in</span><span class="op" id="7006998">)</span><span class="op" id="7006999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7007002">if</span>&nbsp;<span class="ident" id="7007005">err</span>&nbsp;<span class="op" id="7007009">!=</span>&nbsp;<span class="ident" id="7007012">nil</span>&nbsp;<span class="op" id="7007016">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7007020">panic</span><span class="op" id="7007025">(</span><span class="string" id="7007026">&#34;failed&nbsp;to&nbsp;base64&nbsp;decode&#34;</span><span class="op" id="7007051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7007054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7007057">return</span>&nbsp;<span class="ident" id="7007064">out</span><span class="op" id="7007067">[</span><span class="op" id="7007068">:</span><span class="ident" id="7007069">n</span><span class="op" id="7007070">]</span><br>
<span class="lineno"></span><span class="op" id="7007072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="7007075">func</span>&nbsp;<span class="ident" id="7007080">TestParseDERCRL</span><span class="op" id="7007095">(</span><span class="ident" id="7007096">t</span>&nbsp;<span class="op" id="7007098">*</span><span class="ident" id="7007099">testing</span><span class="op" id="7007106">.</span><span class="ident" id="7007107">T</span><span class="op" id="7007108">)</span>&nbsp;<span class="op" id="7007110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7007113">derBytes</span>&nbsp;<span class="op" id="7007122">:=</span>&nbsp;<span class="ident" id="7007125">fromBase64</span><span class="op" id="7007135">(</span><span class="ident" id="7007136">derCRLBase64</span><span class="op" id="7007148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7007151">certList</span><span class="op" id="7007159">,</span>&nbsp;<span class="ident" id="7007161">err</span>&nbsp;<span class="op" id="7007165">:=</span>&nbsp;<span class="ident" id="7007168">ParseDERCRL</span><span class="op" id="7007179">(</span><span class="ident" id="7007180">derBytes</span><span class="op" id="7007188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7007191">if</span>&nbsp;<span class="ident" id="7007194">err</span>&nbsp;<span class="op" id="7007198">!=</span>&nbsp;<span class="ident" id="7007201">nil</span>&nbsp;<span class="op" id="7007205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7007209">t</span><span class="op" id="7007210">.</span><span class="ident" id="7007211">Errorf</span><span class="op" id="7007217">(</span><span class="string" id="7007218">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="7007237">,</span>&nbsp;<span class="ident" id="7007239">err</span><span class="op" id="7007242">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7007246">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7007254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7007257">numCerts</span>&nbsp;<span class="op" id="7007266">:=</span>&nbsp;<span class="builtinfunc" id="7007269">len</span><span class="op" id="7007272">(</span><span class="ident" id="7007273">certList</span><span class="op" id="7007281">.</span><span class="ident" id="7007282">TBSCertList</span><span class="op" id="7007293">.</span><span class="ident" id="7007294">RevokedCertificates</span><span class="op" id="7007313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7007316">expected</span>&nbsp;<span class="op" id="7007325">:=</span>&nbsp;<span class="num" id="7007328">88</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7007332">if</span>&nbsp;<span class="ident" id="7007335">numCerts</span>&nbsp;<span class="op" id="7007344">!=</span>&nbsp;<span class="ident" id="7007347">expected</span>&nbsp;<span class="op" id="7007356">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7007360">t</span><span class="op" id="7007361">.</span><span class="ident" id="7007362">Errorf</span><span class="op" id="7007368">(</span><span class="string" id="7007369">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="7007423">,</span>&nbsp;<span class="ident" id="7007425">numCerts</span><span class="op" id="7007433">,</span>&nbsp;<span class="ident" id="7007435">expected</span><span class="op" id="7007443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7007446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7007450">if</span>&nbsp;<span class="ident" id="7007453">certList</span><span class="op" id="7007461">.</span><span class="ident" id="7007462">HasExpired</span><span class="op" id="7007472">(</span><span class="ident" id="7007473">time</span><span class="op" id="7007477">.</span><span class="ident" id="7007478">Unix</span><span class="op" id="7007482">(</span><span class="num" id="7007483">1302517272</span><span class="op" id="7007493">,</span>&nbsp;<span class="num" id="7007495">0</span><span class="op" id="7007496">)</span><span class="op" id="7007497">)</span>&nbsp;<span class="op" id="7007499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7007503">t</span><span class="op" id="7007504">.</span><span class="ident" id="7007505">Errorf</span><span class="op" id="7007511">(</span><span class="string" id="7007512">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="7007550">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7007553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7007557">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="7007616">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">710</span><span class="keyword" id="7007619">func</span>&nbsp;<span class="ident" id="7007624">TestCRLWithoutExpiry</span><span class="op" id="7007644">(</span><span class="ident" id="7007645">t</span>&nbsp;<span class="op" id="7007647">*</span><span class="ident" id="7007648">testing</span><span class="op" id="7007655">.</span><span class="ident" id="7007656">T</span><span class="op" id="7007657">)</span>&nbsp;<span class="op" id="7007659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7007662">derBytes</span>&nbsp;<span class="op" id="7007671">:=</span>&nbsp;<span class="ident" id="7007674">fromBase64</span><span class="op" id="7007684">(</span><span class="string" id="7007685">&#34;MIHYMIGZMAkGByqGSM44BAMwEjEQMA4GA1UEAxMHQ2FybERTUxcNOTkwODI3MDcwMDAwWjBpMBMCAgDIFw05OTA4MjIwNzAwMDBaMBMCAgDJFw05OTA4MjIwNzAwMDBaMBMCAgDTFw05OTA4MjIwNzAwMDBaMBMCAgDSFw05OTA4MjIwNzAwMDBaMBMCAgDUFw05OTA4MjQwNzAwMDBaMAkGByqGSM44BAMDLwAwLAIUfmVSdjP+NHMX0feW+aDU2G1cfT0CFAJ6W7fVWxjBz4fvftok8yqDnDWh&#34;</span><span class="op" id="7007979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7007982">certList</span><span class="op" id="7007990">,</span>&nbsp;<span class="ident" id="7007992">err</span>&nbsp;<span class="op" id="7007996">:=</span>&nbsp;<span class="ident" id="7007999">ParseDERCRL</span><span class="op" id="7008010">(</span><span class="ident" id="7008011">derBytes</span><span class="op" id="7008019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7008022">if</span>&nbsp;<span class="ident" id="7008025">err</span>&nbsp;<span class="op" id="7008029">!=</span>&nbsp;<span class="ident" id="7008032">nil</span>&nbsp;<span class="op" id="7008036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7008040">t</span><span class="op" id="7008041">.</span><span class="ident" id="7008042">Fatal</span><span class="op" id="7008047">(</span><span class="ident" id="7008048">err</span><span class="op" id="7008051">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7008057">if</span>&nbsp;<span class="op" id="7008060">!</span><span class="ident" id="7008061">certList</span><span class="op" id="7008069">.</span><span class="ident" id="7008070">TBSCertList</span><span class="op" id="7008081">.</span><span class="ident" id="7008082">NextUpdate</span><span class="op" id="7008092">.</span><span class="ident" id="7008093">IsZero</span><span class="op" id="7008099">(</span><span class="op" id="7008100">)</span>&nbsp;<span class="op" id="7008102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7008106">t</span><span class="op" id="7008107">.</span><span class="ident" id="7008108">Errorf</span><span class="op" id="7008114">(</span><span class="string" id="7008115">&#34;NextUpdate&nbsp;is&nbsp;not&nbsp;the&nbsp;zero&nbsp;value&#34;</span><span class="op" id="7008149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008152">}</span><br>
<span class="lineno"></span><span class="op" id="7008154">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="7008157">func</span>&nbsp;<span class="ident" id="7008162">TestParsePEMCRL</span><span class="op" id="7008177">(</span><span class="ident" id="7008178">t</span>&nbsp;<span class="op" id="7008180">*</span><span class="ident" id="7008181">testing</span><span class="op" id="7008188">.</span><span class="ident" id="7008189">T</span><span class="op" id="7008190">)</span>&nbsp;<span class="op" id="7008192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7008195">pemBytes</span>&nbsp;<span class="op" id="7008204">:=</span>&nbsp;<span class="ident" id="7008207">fromBase64</span><span class="op" id="7008217">(</span><span class="ident" id="7008218">pemCRLBase64</span><span class="op" id="7008230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7008233">certList</span><span class="op" id="7008241">,</span>&nbsp;<span class="ident" id="7008243">err</span>&nbsp;<span class="op" id="7008247">:=</span>&nbsp;<span class="ident" id="7008250">ParseCRL</span><span class="op" id="7008258">(</span><span class="ident" id="7008259">pemBytes</span><span class="op" id="7008267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7008270">if</span>&nbsp;<span class="ident" id="7008273">err</span>&nbsp;<span class="op" id="7008277">!=</span>&nbsp;<span class="ident" id="7008280">nil</span>&nbsp;<span class="op" id="7008284">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7008288">t</span><span class="op" id="7008289">.</span><span class="ident" id="7008290">Errorf</span><span class="op" id="7008296">(</span><span class="string" id="7008297">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="7008316">,</span>&nbsp;<span class="ident" id="7008318">err</span><span class="op" id="7008321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7008325">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7008336">numCerts</span>&nbsp;<span class="op" id="7008345">:=</span>&nbsp;<span class="builtinfunc" id="7008348">len</span><span class="op" id="7008351">(</span><span class="ident" id="7008352">certList</span><span class="op" id="7008360">.</span><span class="ident" id="7008361">TBSCertList</span><span class="op" id="7008372">.</span><span class="ident" id="7008373">RevokedCertificates</span><span class="op" id="7008392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7008395">expected</span>&nbsp;<span class="op" id="7008404">:=</span>&nbsp;<span class="num" id="7008407">2</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7008410">if</span>&nbsp;<span class="ident" id="7008413">numCerts</span>&nbsp;<span class="op" id="7008422">!=</span>&nbsp;<span class="ident" id="7008425">expected</span>&nbsp;<span class="op" id="7008434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7008438">t</span><span class="op" id="7008439">.</span><span class="ident" id="7008440">Errorf</span><span class="op" id="7008446">(</span><span class="string" id="7008447">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="7008501">,</span>&nbsp;<span class="ident" id="7008503">numCerts</span><span class="op" id="7008511">,</span>&nbsp;<span class="ident" id="7008513">expected</span><span class="op" id="7008521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7008528">if</span>&nbsp;<span class="ident" id="7008531">certList</span><span class="op" id="7008539">.</span><span class="ident" id="7008540">HasExpired</span><span class="op" id="7008550">(</span><span class="ident" id="7008551">time</span><span class="op" id="7008555">.</span><span class="ident" id="7008556">Unix</span><span class="op" id="7008560">(</span><span class="num" id="7008561">1302517272</span><span class="op" id="7008571">,</span>&nbsp;<span class="num" id="7008573">0</span><span class="op" id="7008574">)</span><span class="op" id="7008575">)</span>&nbsp;<span class="op" id="7008577">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7008581">t</span><span class="op" id="7008582">.</span><span class="ident" id="7008583">Errorf</span><span class="op" id="7008589">(</span><span class="string" id="7008590">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="7008628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7008635">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="7008694">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span><span class="keyword" id="7008697">func</span>&nbsp;<span class="ident" id="7008702">TestImports</span><span class="op" id="7008713">(</span><span class="ident" id="7008714">t</span>&nbsp;<span class="op" id="7008716">*</span><span class="ident" id="7008717">testing</span><span class="op" id="7008724">.</span><span class="ident" id="7008725">T</span><span class="op" id="7008726">)</span>&nbsp;<span class="op" id="7008728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7008731">switch</span>&nbsp;<span class="ident" id="7008738">runtime</span><span class="op" id="7008745">.</span><span class="ident" id="7008746">GOOS</span>&nbsp;<span class="op" id="7008751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7008754">case</span>&nbsp;<span class="string" id="7008759">&#34;android&#34;</span><span class="op" id="7008768">,</span>&nbsp;<span class="string" id="7008770">&#34;nacl&#34;</span><span class="op" id="7008776">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7008780">t</span><span class="op" id="7008781">.</span><span class="ident" id="7008782">Skipf</span><span class="op" id="7008787">(</span><span class="string" id="7008788">&#34;skipping&nbsp;on&nbsp;%s&#34;</span><span class="op" id="7008804">,</span>&nbsp;<span class="ident" id="7008806">runtime</span><span class="op" id="7008813">.</span><span class="ident" id="7008814">GOOS</span><span class="op" id="7008818">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7008825">if</span>&nbsp;<span class="ident" id="7008828">err</span>&nbsp;<span class="op" id="7008832">:=</span>&nbsp;<span class="ident" id="7008835">exec</span><span class="op" id="7008839">.</span><span class="ident" id="7008840">Command</span><span class="op" id="7008847">(</span><span class="string" id="7008848">&#34;go&#34;</span><span class="op" id="7008852">,</span>&nbsp;<span class="string" id="7008854">&#34;run&#34;</span><span class="op" id="7008859">,</span>&nbsp;<span class="string" id="7008861">&#34;x509_test_import.go&#34;</span><span class="op" id="7008882">)</span><span class="op" id="7008883">.</span><span class="ident" id="7008884">Run</span><span class="op" id="7008887">(</span><span class="op" id="7008888">)</span><span class="op" id="7008889">;</span>&nbsp;<span class="ident" id="7008891">err</span>&nbsp;<span class="op" id="7008895">!=</span>&nbsp;<span class="ident" id="7008898">nil</span>&nbsp;<span class="op" id="7008902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7008906">t</span><span class="op" id="7008907">.</span><span class="ident" id="7008908">Errorf</span><span class="op" id="7008914">(</span><span class="string" id="7008915">&#34;failed&nbsp;to&nbsp;run&nbsp;x509_test_import.go:&nbsp;%s&#34;</span><span class="op" id="7008954">,</span>&nbsp;<span class="ident" id="7008956">err</span><span class="op" id="7008959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008962">}</span><br>
<span class="lineno">750</span><span class="op" id="7008964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7008967">const</span>&nbsp;<span class="ident" id="7008973">derCRLBase64</span>&nbsp;<span class="op" id="7008986">=</span>&nbsp;<span class="string" id="7008988">&#34;MIINqzCCDJMCAQEwDQYJKoZIhvcNAQEFBQAwVjEZMBcGA1UEAxMQUEtJIEZJTk1FQ0NBTklDQTEVMBMGA1UEChMMRklOTUVDQ0FOSUNBMRUwEwYDVQQLEwxGSU5NRUNDQU5JQ0ExCzAJBgNVBAYTAklUFw0xMTA1MDQxNjU3NDJaFw0xMTA1MDQyMDU3NDJaMIIMBzAhAg4Ze1od49Lt1qIXBydAzhcNMDkwNzE2MDg0MzIyWjAAMCECDl0HSL9bcZ1Ci/UHJ0DPFw0wOTA3MTYwODQzMTNaMAAwIQIOESB9tVAmX3cY7QcnQNAXDTA5MDcxNjA4NDUyMlowADAhAg4S1tGAQ3mHt8uVBydA1RcNMDkwODA0MTUyNTIyWjAAMCECDlQ249Y7vtC25ScHJ0DWFw0wOTA4MDQxNTI1MzdaMAAwIQIOISMop3NkA4PfYwcnQNkXDTA5MDgwNDExMDAzNFowADAhAg56/BMoS29KEShTBydA2hcNMDkwODA0MTEwMTAzWjAAMCECDnBp/22HPH5CSWoHJ0DbFw0wOTA4MDQxMDU0NDlaMAAwIQIOV9IP+8CD8bK+XAcnQNwXDTA5MDgwNDEwNTcxN1owADAhAg4v5aRz0IxWqYiXBydA3RcNMDkwODA0MTA1NzQ1WjAAMCECDlOU34VzvZAybQwHJ0DeFw0wOTA4MDQxMDU4MjFaMAAwIAINO4CD9lluIxcwBydBAxcNMDkwNzIyMTUzMTU5WjAAMCECDgOllfO8Y1QA7/wHJ0ExFw0wOTA3MjQxMTQxNDNaMAAwIQIOJBX7jbiCdRdyjgcnQUQXDTA5MDkxNjA5MzAwOFowADAhAg5iYSAgmDrlH/RZBydBRRcNMDkwOTE2MDkzMDE3WjAAMCECDmu6k6srP3jcMaQHJ0FRFw0wOTA4MDQxMDU2NDBaMAAwIQIOX8aHlO0V+WVH4QcnQVMXDTA5MDgwNDEwNTcyOVowADAhAg5flK2rg3NnsRgDBydBzhcNMTEwMjAxMTUzMzQ2WjAAMCECDg35yJDL1jOPTgoHJ0HPFw0xMTAyMDExNTM0MjZaMAAwIQIOMyFJ6+e9iiGVBQcnQdAXDTA5MDkxODEzMjAwNVowADAhAg5Emb/Oykucmn8fBydB1xcNMDkwOTIxMTAxMDQ3WjAAMCECDjQKCncV+MnUavMHJ0HaFw0wOTA5MjIwODE1MjZaMAAwIQIOaxiFUt3dpd+tPwcnQfQXDTEwMDYxODA4NDI1MVowADAhAg5G7P8nO0tkrMt7BydB9RcNMTAwNjE4MDg0MjMwWjAAMCECDmTCC3SXhmDRst4HJ0H2Fw0wOTA5MjgxMjA3MjBaMAAwIQIOHoGhUr/pRwzTKgcnQfcXDTA5MDkyODEyMDcyNFowADAhAg50wrcrCiw8mQmPBydCBBcNMTAwMjE2MTMwMTA2WjAAMCECDifWmkvwyhEqwEcHJ0IFFw0xMDAyMTYxMzAxMjBaMAAwIQIOfgPmlW9fg+osNgcnQhwXDTEwMDQxMzA5NTIwMFowADAhAg4YHAGuA6LgCk7tBydCHRcNMTAwNDEzMDk1MTM4WjAAMCECDi1zH1bxkNJhokAHJ0IsFw0xMDA0MTMwOTU5MzBaMAAwIQIOMipNccsb/wo2fwcnQi0XDTEwMDQxMzA5NTkwMFowADAhAg46lCmvPl4GpP6ABydCShcNMTAwMTE5MDk1MjE3WjAAMCECDjaTcaj+wBpcGAsHJ0JLFw0xMDAxMTkwOTUyMzRaMAAwIQIOOMC13EOrBuxIOQcnQloXDTEwMDIwMTA5NDcwNVowADAhAg5KmZl+krz4RsmrBydCWxcNMTAwMjAxMDk0NjQwWjAAMCECDmLG3zQJ/fzdSsUHJ0JiFw0xMDAzMDEwOTUxNDBaMAAwIQIOP39ksgHdojf4owcnQmMXDTEwMDMwMTA5NTExN1owADAhAg4LDQzvWNRlD6v9BydCZBcNMTAwMzAxMDk0NjIyWjAAMCECDkmNfeclaFhIaaUHJ0JlFw0xMDAzMDEwOTQ2MDVaMAAwIQIOT/qWWfpH/m8NTwcnQpQXDTEwMDUxMTA5MTgyMVowADAhAg5m/ksYxvCEgJSvBydClRcNMTAwNTExMDkxODAxWjAAMCECDgvf3Ohq6JOPU9AHJ0KWFw0xMDA1MTEwOTIxMjNaMAAwIQIOKSPas10z4jNVIQcnQpcXDTEwMDUxMTA5MjEwMlowADAhAg4mCWmhoZ3lyKCDBydCohcNMTEwNDI4MTEwMjI1WjAAMCECDkeiyRsBMK0Gvr4HJ0KjFw0xMTA0MjgxMTAyMDdaMAAwIQIOa09b/nH2+55SSwcnQq4XDTExMDQwMTA4Mjk0NlowADAhAg5O7M7iq7gGplr1BydCrxcNMTEwNDAxMDgzMDE3WjAAMCECDjlT6mJxUjTvyogHJ0K1Fw0xMTAxMjcxNTQ4NTJaMAAwIQIODS/l4UUFLe21NAcnQrYXDTExMDEyNzE1NDgyOFowADAhAg5lPRA0XdOUF6lSBydDHhcNMTEwMTI4MTQzNTA1WjAAMCECDixKX4fFGGpENwgHJ0MfFw0xMTAxMjgxNDM1MzBaMAAwIQIORNBkqsPnpKTtbAcnQ08XDTEwMDkwOTA4NDg0MlowADAhAg5QL+EMM3lohedEBydDUBcNMTAwOTA5MDg0ODE5WjAAMCECDlhDnHK+HiTRAXcHJ0NUFw0xMDEwMTkxNjIxNDBaMAAwIQIOdBFqAzq/INz53gcnQ1UXDTEwMTAxOTE2MjA0NFowADAhAg4OjR7s8MgKles1BydDWhcNMTEwMTI3MTY1MzM2WjAAMCECDmfR/elHee+d0SoHJ0NbFw0xMTAxMjcxNjUzNTZaMAAwIQIOBTKv2ui+KFMI+wcnQ5YXDTEwMDkxNTEwMjE1N1owADAhAg49F3c/GSah+oRUBydDmxcNMTEwMTI3MTczMjMzWjAAMCECDggv4I61WwpKFMMHJ0OcFw0xMTAxMjcxNzMyNTVaMAAwIQIOXx/Y8sEvwS10LAcnQ6UXDTExMDEyODExMjkzN1owADAhAg5LSLbnVrSKaw/9BydDphcNMTEwMTI4MTEyOTIwWjAAMCECDmFFoCuhKUeACQQHJ0PfFw0xMTAxMTExMDE3MzdaMAAwIQIOQTDdFh2fSPF6AAcnQ+AXDTExMDExMTEwMTcxMFowADAhAg5B8AOXX61FpvbbBydD5RcNMTAxMDA2MTAxNDM2WjAAMCECDh41P2Gmi7PkwI4HJ0PmFw0xMDEwMDYxMDE2MjVaMAAwIQIOWUHGLQCd+Ale9gcnQ/0XDTExMDUwMjA3NTYxMFowADAhAg5Z2c9AYkikmgWOBydD/hcNMTEwNTAyMDc1NjM0WjAAMCECDmf/UD+/h8nf+74HJ0QVFw0xMTA0MTUwNzI4MzNaMAAwIQIOICvj4epy3MrqfwcnRBYXDTExMDQxNTA3Mjg1NlowADAhAg4bouRMfOYqgv4xBydEHxcNMTEwMzA4MTYyNDI1WjAAMCECDhebWHGoKiTp7pEHJ0QgFw0xMTAzMDgxNjI0NDhaMAAwIQIOX+qnxxAqJ8LtawcnRDcXDTExMDEzMTE1MTIyOFowADAhAg4j0fICqZ+wkOdqBydEOBcNMTEwMTMxMTUxMTQxWjAAMCECDhmXjsV4SUpWtAMHJ0RLFw0xMTAxMjgxMTI0MTJaMAAwIQIODno/w+zG43kkTwcnREwXDTExMDEyODExMjM1MlowADAhAg4b1gc88767Fr+LBydETxcNMTEwMTI4MTEwMjA4WjAAMCECDn+M3Pa1w2nyFeUHJ0RQFw0xMTAxMjgxMDU4NDVaMAAwIQIOaduoyIH61tqybAcnRJUXDTEwMTIxNTA5NDMyMlowADAhAg4nLqQPkyi3ESAKBydElhcNMTAxMjE1MDk0MzM2WjAAMCECDi504NIMH8578gQHJ0SbFw0xMTAyMTQxNDA1NDFaMAAwIQIOGuaM8PDaC5u1egcnRJwXDTExMDIxNDE0MDYwNFowADAhAg4ehYq/BXGnB5PWBydEnxcNMTEwMjA0MDgwOTUxWjAAMCECDkSD4eS4FxW5H20HJ0SgFw0xMTAyMDQwODA5MjVaMAAwIQIOOCcb6ilYObt1egcnRKEXDTExMDEyNjEwNDEyOVowADAhAg58tISWCCwFnKGnBydEohcNMTEwMjA0MDgxMzQyWjAAMCECDn5rjtabY/L/WL0HJ0TJFw0xMTAyMDQxMTAzNDFaMAAwDQYJKoZIhvcNAQEFBQADggEBAGnF2Gs0+LNiYCW1Ipm83OXQYP/bd5tFFRzyz3iepFqNfYs4D68/QihjFoRHQoXEB0OEe1tvaVnnPGnEOpi6krwekquMxo4H88B5SlyiFIqemCOIss0SxlCFs69LmfRYvPPvPEhoXtQ3ZThe0UvKG83GOklhvGl6OaiRf4Mt+m8zOT4Wox/j6aOBK6cw6qKCdmD+Yj1rrNqFGg1CnSWMoD6S6mwNgkzwdBUJZ22BwrzAAo4RHa2Uy3ef1FjwD0XtU5N3uDSxGGBEDvOe5z82rps3E22FpAA8eYl8kaXtmWqyvYU0epp4brGuTxCuBMCAsxt/OjIjeNNQbBGkwxgfYA0=&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7013664">const</span>&nbsp;<span class="ident" id="7013670">pemCRLBase64</span>&nbsp;<span class="op" id="7013683">=</span>&nbsp;<span class="string" id="7013685">&#34;LS0tLS1CRUdJTiBYNTA5IENSTC0tLS0tDQpNSUlCOWpDQ0FWOENBUUV3RFFZSktvWklodmNOQVFFRkJRQXdiREVhTUJnR0ExVUVDaE1SVWxOQklGTmxZM1Z5DQphWFI1SUVsdVl5NHhIakFjQmdOVkJBTVRGVkpUUVNCUWRXSnNhV01nVW05dmRDQkRRU0IyTVRFdU1Dd0dDU3FHDQpTSWIzRFFFSkFSWWZjbk5oYTJWdmJuSnZiM1J6YVdkdVFISnpZWE5sWTNWeWFYUjVMbU52YlJjTk1URXdNakl6DQpNVGt5T0RNd1doY05NVEV3T0RJeU1Ua3lPRE13V2pDQmpEQktBaEVBckRxb2g5RkhKSFhUN09QZ3V1bjQrQmNODQpNRGt4TVRBeU1UUXlOekE1V2pBbU1Bb0dBMVVkRlFRRENnRUpNQmdHQTFVZEdBUVJHQTh5TURBNU1URXdNakUwDQpNalExTlZvd1BnSVJBTEd6blowOTVQQjVhQU9MUGc1N2ZNTVhEVEF5TVRBeU16RTBOVEF4TkZvd0dqQVlCZ05WDQpIUmdFRVJnUE1qQXdNakV3TWpNeE5EVXdNVFJhb0RBd0xqQWZCZ05WSFNNRUdEQVdnQlQxVERGNlVRTS9MTmVMDQpsNWx2cUhHUXEzZzltekFMQmdOVkhSUUVCQUlDQUlRd0RRWUpLb1pJaHZjTkFRRUZCUUFEZ1lFQUZVNUFzNk16DQpxNVBSc2lmYW9iUVBHaDFhSkx5QytNczVBZ2MwYld5QTNHQWR4dXI1U3BQWmVSV0NCamlQL01FSEJXSkNsQkhQDQpHUmNxNXlJZDNFakRrYUV5eFJhK2k2N0x6dmhJNmMyOUVlNks5cFNZd2ppLzdSVWhtbW5Qclh0VHhsTDBsckxyDQptUVFKNnhoRFJhNUczUUE0Q21VZHNITnZicnpnbUNZcHZWRT0NCi0tLS0tRU5EIFg1MDkgQ1JMLS0tLS0NCg0K&#34;</span><br>
<span class="lineno">755</span><br>
<span class="lineno"></span><span class="keyword" id="7014689">func</span>&nbsp;<span class="ident" id="7014694">TestCreateCertificateRequest</span><span class="op" id="7014722">(</span><span class="ident" id="7014723">t</span>&nbsp;<span class="op" id="7014725">*</span><span class="ident" id="7014726">testing</span><span class="op" id="7014733">.</span><span class="ident" id="7014734">T</span><span class="op" id="7014735">)</span>&nbsp;<span class="op" id="7014737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7014740">random</span>&nbsp;<span class="op" id="7014747">:=</span>&nbsp;<span class="ident" id="7014750">rand</span><span class="op" id="7014754">.</span><span class="ident" id="7014755">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7014764">block</span><span class="op" id="7014769">,</span>&nbsp;<span class="ident" id="7014771">_</span>&nbsp;<span class="op" id="7014773">:=</span>&nbsp;<span class="ident" id="7014776">pem</span><span class="op" id="7014779">.</span><span class="ident" id="7014780">Decode</span><span class="op" id="7014786">(</span><span class="op" id="7014787">[</span><span class="op" id="7014788">]</span><span class="builtintype" id="7014789">byte</span><span class="op" id="7014793">(</span><span class="ident" id="7014794">pemPrivateKey</span><span class="op" id="7014807">)</span><span class="op" id="7014808">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7014811">rsaPriv</span><span class="op" id="7014818">,</span>&nbsp;<span class="ident" id="7014820">err</span>&nbsp;<span class="op" id="7014824">:=</span>&nbsp;<span class="ident" id="7014827">ParsePKCS1PrivateKey</span><span class="op" id="7014847">(</span><span class="ident" id="7014848">block</span><span class="op" id="7014853">.</span><span class="ident" id="7014854">Bytes</span><span class="op" id="7014859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7014862">if</span>&nbsp;<span class="ident" id="7014865">err</span>&nbsp;<span class="op" id="7014869">!=</span>&nbsp;<span class="ident" id="7014872">nil</span>&nbsp;<span class="op" id="7014876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7014880">t</span><span class="op" id="7014881">.</span><span class="ident" id="7014882">Fatalf</span><span class="op" id="7014888">(</span><span class="string" id="7014889">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7014922">,</span>&nbsp;<span class="ident" id="7014924">err</span><span class="op" id="7014927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7014930">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7014934">ecdsa256Priv</span><span class="op" id="7014946">,</span>&nbsp;<span class="ident" id="7014948">err</span>&nbsp;<span class="op" id="7014952">:=</span>&nbsp;<span class="ident" id="7014955">ecdsa</span><span class="op" id="7014960">.</span><span class="ident" id="7014961">GenerateKey</span><span class="op" id="7014972">(</span><span class="ident" id="7014973">elliptic</span><span class="op" id="7014981">.</span><span class="ident" id="7014982">P256</span><span class="op" id="7014986">(</span><span class="op" id="7014987">)</span><span class="op" id="7014988">,</span>&nbsp;<span class="ident" id="7014990">rand</span><span class="op" id="7014994">.</span><span class="ident" id="7014995">Reader</span><span class="op" id="7015001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7015004">if</span>&nbsp;<span class="ident" id="7015007">err</span>&nbsp;<span class="op" id="7015011">!=</span>&nbsp;<span class="ident" id="7015014">nil</span>&nbsp;<span class="op" id="7015018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015022">t</span><span class="op" id="7015023">.</span><span class="ident" id="7015024">Fatalf</span><span class="op" id="7015030">(</span><span class="string" id="7015031">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7015065">,</span>&nbsp;<span class="ident" id="7015067">err</span><span class="op" id="7015070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7015073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015077">ecdsa384Priv</span><span class="op" id="7015089">,</span>&nbsp;<span class="ident" id="7015091">err</span>&nbsp;<span class="op" id="7015095">:=</span>&nbsp;<span class="ident" id="7015098">ecdsa</span><span class="op" id="7015103">.</span><span class="ident" id="7015104">GenerateKey</span><span class="op" id="7015115">(</span><span class="ident" id="7015116">elliptic</span><span class="op" id="7015124">.</span><span class="ident" id="7015125">P384</span><span class="op" id="7015129">(</span><span class="op" id="7015130">)</span><span class="op" id="7015131">,</span>&nbsp;<span class="ident" id="7015133">rand</span><span class="op" id="7015137">.</span><span class="ident" id="7015138">Reader</span><span class="op" id="7015144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7015147">if</span>&nbsp;<span class="ident" id="7015150">err</span>&nbsp;<span class="op" id="7015154">!=</span>&nbsp;<span class="ident" id="7015157">nil</span>&nbsp;<span class="op" id="7015161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015165">t</span><span class="op" id="7015166">.</span><span class="ident" id="7015167">Fatalf</span><span class="op" id="7015173">(</span><span class="string" id="7015174">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7015208">,</span>&nbsp;<span class="ident" id="7015210">err</span><span class="op" id="7015213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7015216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015220">ecdsa521Priv</span><span class="op" id="7015232">,</span>&nbsp;<span class="ident" id="7015234">err</span>&nbsp;<span class="op" id="7015238">:=</span>&nbsp;<span class="ident" id="7015241">ecdsa</span><span class="op" id="7015246">.</span><span class="ident" id="7015247">GenerateKey</span><span class="op" id="7015258">(</span><span class="ident" id="7015259">elliptic</span><span class="op" id="7015267">.</span><span class="ident" id="7015268">P521</span><span class="op" id="7015272">(</span><span class="op" id="7015273">)</span><span class="op" id="7015274">,</span>&nbsp;<span class="ident" id="7015276">rand</span><span class="op" id="7015280">.</span><span class="ident" id="7015281">Reader</span><span class="op" id="7015287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7015290">if</span>&nbsp;<span class="ident" id="7015293">err</span>&nbsp;<span class="op" id="7015297">!=</span>&nbsp;<span class="ident" id="7015300">nil</span>&nbsp;<span class="op" id="7015304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015308">t</span><span class="op" id="7015309">.</span><span class="ident" id="7015310">Fatalf</span><span class="op" id="7015316">(</span><span class="string" id="7015317">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7015351">,</span>&nbsp;<span class="ident" id="7015353">err</span><span class="op" id="7015356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7015359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015363">tests</span>&nbsp;<span class="op" id="7015369">:=</span>&nbsp;<span class="op" id="7015372">[</span><span class="op" id="7015373">]</span><span class="keyword" id="7015374">struct</span>&nbsp;<span class="op" id="7015381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015385">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7015393">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015402">priv</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7015410">interface</span><span class="op" id="7015419">{</span><span class="op" id="7015420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015424">sigAlgo</span>&nbsp;<span class="ident" id="7015432">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7015452">}</span><span class="op" id="7015453">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7015457">{</span><span class="string" id="7015458">&#34;RSA&#34;</span><span class="op" id="7015463">,</span>&nbsp;<span class="ident" id="7015465">rsaPriv</span><span class="op" id="7015472">,</span>&nbsp;<span class="ident" id="7015474">SHA1WithRSA</span><span class="op" id="7015485">}</span><span class="op" id="7015486">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7015490">{</span><span class="string" id="7015491">&#34;ECDSA-256&#34;</span><span class="op" id="7015502">,</span>&nbsp;<span class="ident" id="7015504">ecdsa256Priv</span><span class="op" id="7015516">,</span>&nbsp;<span class="ident" id="7015518">ECDSAWithSHA1</span><span class="op" id="7015531">}</span><span class="op" id="7015532">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7015536">{</span><span class="string" id="7015537">&#34;ECDSA-384&#34;</span><span class="op" id="7015548">,</span>&nbsp;<span class="ident" id="7015550">ecdsa384Priv</span><span class="op" id="7015562">,</span>&nbsp;<span class="ident" id="7015564">ECDSAWithSHA1</span><span class="op" id="7015577">}</span><span class="op" id="7015578">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7015582">{</span><span class="string" id="7015583">&#34;ECDSA-521&#34;</span><span class="op" id="7015594">,</span>&nbsp;<span class="ident" id="7015596">ecdsa521Priv</span><span class="op" id="7015608">,</span>&nbsp;<span class="ident" id="7015610">ECDSAWithSHA1</span><span class="op" id="7015623">}</span><span class="op" id="7015624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7015627">}</span><br>
<span class="lineno">790</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7015631">for</span>&nbsp;<span class="ident" id="7015635">_</span><span class="op" id="7015636">,</span>&nbsp;<span class="ident" id="7015638">test</span>&nbsp;<span class="op" id="7015643">:=</span>&nbsp;<span class="keyword" id="7015646">range</span>&nbsp;<span class="ident" id="7015652">tests</span>&nbsp;<span class="op" id="7015658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015662">template</span>&nbsp;<span class="op" id="7015671">:=</span>&nbsp;<span class="ident" id="7015674">CertificateRequest</span><span class="op" id="7015692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015697">Subject</span><span class="op" id="7015704">:</span>&nbsp;<span class="ident" id="7015706">pkix</span><span class="op" id="7015710">.</span><span class="ident" id="7015711">Name</span><span class="op" id="7015715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015721">CommonName</span><span class="op" id="7015731">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7015735">&#34;test.example.com&#34;</span><span class="op" id="7015753">,</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015759">Organization</span><span class="op" id="7015771">:</span>&nbsp;<span class="op" id="7015773">[</span><span class="op" id="7015774">]</span><span class="builtintype" id="7015775">string</span><span class="op" id="7015781">{</span><span class="string" id="7015782">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7015794">}</span><span class="op" id="7015795">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7015800">}</span><span class="op" id="7015801">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015806">SignatureAlgorithm</span><span class="op" id="7015824">:</span>&nbsp;<span class="ident" id="7015826">test</span><span class="op" id="7015830">.</span><span class="ident" id="7015831">sigAlgo</span><span class="op" id="7015838">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015843">DNSNames</span><span class="op" id="7015851">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7015863">[</span><span class="op" id="7015864">]</span><span class="builtintype" id="7015865">string</span><span class="op" id="7015871">{</span><span class="string" id="7015872">&#34;test.example.com&#34;</span><span class="op" id="7015890">}</span><span class="op" id="7015891">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015896">EmailAddresses</span><span class="op" id="7015910">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7015916">[</span><span class="op" id="7015917">]</span><span class="builtintype" id="7015918">string</span><span class="op" id="7015924">{</span><span class="string" id="7015925">&#34;gopher@golang.org&#34;</span><span class="op" id="7015944">}</span><span class="op" id="7015945">,</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015950">IPAddresses</span><span class="op" id="7015961">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7015970">[</span><span class="op" id="7015971">]</span><span class="ident" id="7015972">net</span><span class="op" id="7015975">.</span><span class="ident" id="7015976">IP</span><span class="op" id="7015978">{</span><span class="ident" id="7015979">net</span><span class="op" id="7015982">.</span><span class="ident" id="7015983">IPv4</span><span class="op" id="7015987">(</span><span class="num" id="7015988">127</span><span class="op" id="7015991">,</span>&nbsp;<span class="num" id="7015993">0</span><span class="op" id="7015994">,</span>&nbsp;<span class="num" id="7015996">0</span><span class="op" id="7015997">,</span>&nbsp;<span class="num" id="7015999">1</span><span class="op" id="7016000">)</span><span class="op" id="7016001">.</span><span class="ident" id="7016002">To4</span><span class="op" id="7016005">(</span><span class="op" id="7016006">)</span><span class="op" id="7016007">,</span>&nbsp;<span class="ident" id="7016009">net</span><span class="op" id="7016012">.</span><span class="ident" id="7016013">ParseIP</span><span class="op" id="7016020">(</span><span class="string" id="7016021">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="7016043">)</span><span class="op" id="7016044">}</span><span class="op" id="7016045">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7016049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7016054">derBytes</span><span class="op" id="7016062">,</span>&nbsp;<span class="ident" id="7016064">err</span>&nbsp;<span class="op" id="7016068">:=</span>&nbsp;<span class="ident" id="7016071">CreateCertificateRequest</span><span class="op" id="7016095">(</span><span class="ident" id="7016096">random</span><span class="op" id="7016102">,</span>&nbsp;<span class="op" id="7016104">&amp;</span><span class="ident" id="7016105">template</span><span class="op" id="7016113">,</span>&nbsp;<span class="ident" id="7016115">test</span><span class="op" id="7016119">.</span><span class="ident" id="7016120">priv</span><span class="op" id="7016124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7016128">if</span>&nbsp;<span class="ident" id="7016131">err</span>&nbsp;<span class="op" id="7016135">!=</span>&nbsp;<span class="ident" id="7016138">nil</span>&nbsp;<span class="op" id="7016142">{</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7016147">t</span><span class="op" id="7016148">.</span><span class="ident" id="7016149">Errorf</span><span class="op" id="7016155">(</span><span class="string" id="7016156">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="7016202">,</span>&nbsp;<span class="ident" id="7016204">test</span><span class="op" id="7016208">.</span><span class="ident" id="7016209">name</span><span class="op" id="7016213">,</span>&nbsp;<span class="ident" id="7016215">err</span><span class="op" id="7016218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7016223">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7016234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7016239">out</span><span class="op" id="7016242">,</span>&nbsp;<span class="ident" id="7016244">err</span>&nbsp;<span class="op" id="7016248">:=</span>&nbsp;<span class="ident" id="7016251">ParseCertificateRequest</span><span class="op" id="7016274">(</span><span class="ident" id="7016275">derBytes</span><span class="op" id="7016283">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7016287">if</span>&nbsp;<span class="ident" id="7016290">err</span>&nbsp;<span class="op" id="7016294">!=</span>&nbsp;<span class="ident" id="7016297">nil</span>&nbsp;<span class="op" id="7016301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7016306">t</span><span class="op" id="7016307">.</span><span class="ident" id="7016308">Errorf</span><span class="op" id="7016314">(</span><span class="string" id="7016315">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="7016361">,</span>&nbsp;<span class="ident" id="7016363">test</span><span class="op" id="7016367">.</span><span class="ident" id="7016368">name</span><span class="op" id="7016372">,</span>&nbsp;<span class="ident" id="7016374">err</span><span class="op" id="7016377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7016382">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7016393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7016398">if</span>&nbsp;<span class="ident" id="7016401">out</span><span class="op" id="7016404">.</span><span class="ident" id="7016405">Subject</span><span class="op" id="7016412">.</span><span class="ident" id="7016413">CommonName</span>&nbsp;<span class="op" id="7016424">!=</span>&nbsp;<span class="ident" id="7016427">template</span><span class="op" id="7016435">.</span><span class="ident" id="7016436">Subject</span><span class="op" id="7016443">.</span><span class="ident" id="7016444">CommonName</span>&nbsp;<span class="op" id="7016455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7016460">t</span><span class="op" id="7016461">.</span><span class="ident" id="7016462">Errorf</span><span class="op" id="7016468">(</span><span class="string" id="7016469">&#34;%s:&nbsp;output&nbsp;subject&nbsp;common&nbsp;name&nbsp;and&nbsp;template&nbsp;subject&nbsp;common&nbsp;name&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7016546">,</span>&nbsp;<span class="ident" id="7016548">test</span><span class="op" id="7016552">.</span><span class="ident" id="7016553">name</span><span class="op" id="7016557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7016561">}</span>&nbsp;<span class="keyword" id="7016563">else</span>&nbsp;<span class="keyword" id="7016568">if</span>&nbsp;<span class="builtinfunc" id="7016571">len</span><span class="op" id="7016574">(</span><span class="ident" id="7016575">out</span><span class="op" id="7016578">.</span><span class="ident" id="7016579">Subject</span><span class="op" id="7016586">.</span><span class="ident" id="7016587">Organization</span><span class="op" id="7016599">)</span>&nbsp;<span class="op" id="7016601">!=</span>&nbsp;<span class="builtinfunc" id="7016604">len</span><span class="op" id="7016607">(</span><span class="ident" id="7016608">template</span><span class="op" id="7016616">.</span><span class="ident" id="7016617">Subject</span><span class="op" id="7016624">.</span><span class="ident" id="7016625">Organization</span><span class="op" id="7016637">)</span>&nbsp;<span class="op" id="7016639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7016644">t</span><span class="op" id="7016645">.</span><span class="ident" id="7016646">Errorf</span><span class="op" id="7016652">(</span><span class="string" id="7016653">&#34;%s:&nbsp;output&nbsp;subject&nbsp;organisation&nbsp;and&nbsp;template&nbsp;subject&nbsp;organisation&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7016732">,</span>&nbsp;<span class="ident" id="7016734">test</span><span class="op" id="7016738">.</span><span class="ident" id="7016739">name</span><span class="op" id="7016743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7016747">}</span>&nbsp;<span class="keyword" id="7016749">else</span>&nbsp;<span class="keyword" id="7016754">if</span>&nbsp;<span class="builtinfunc" id="7016757">len</span><span class="op" id="7016760">(</span><span class="ident" id="7016761">out</span><span class="op" id="7016764">.</span><span class="ident" id="7016765">DNSNames</span><span class="op" id="7016773">)</span>&nbsp;<span class="op" id="7016775">!=</span>&nbsp;<span class="builtinfunc" id="7016778">len</span><span class="op" id="7016781">(</span><span class="ident" id="7016782">template</span><span class="op" id="7016790">.</span><span class="ident" id="7016791">DNSNames</span><span class="op" id="7016799">)</span>&nbsp;<span class="op" id="7016801">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7016806">t</span><span class="op" id="7016807">.</span><span class="ident" id="7016808">Errorf</span><span class="op" id="7016814">(</span><span class="string" id="7016815">&#34;%s:&nbsp;output&nbsp;DNS&nbsp;names&nbsp;and&nbsp;template&nbsp;DNS&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7016872">,</span>&nbsp;<span class="ident" id="7016874">test</span><span class="op" id="7016878">.</span><span class="ident" id="7016879">name</span><span class="op" id="7016883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7016887">}</span>&nbsp;<span class="keyword" id="7016889">else</span>&nbsp;<span class="keyword" id="7016894">if</span>&nbsp;<span class="builtinfunc" id="7016897">len</span><span class="op" id="7016900">(</span><span class="ident" id="7016901">out</span><span class="op" id="7016904">.</span><span class="ident" id="7016905">EmailAddresses</span><span class="op" id="7016919">)</span>&nbsp;<span class="op" id="7016921">!=</span>&nbsp;<span class="builtinfunc" id="7016924">len</span><span class="op" id="7016927">(</span><span class="ident" id="7016928">template</span><span class="op" id="7016936">.</span><span class="ident" id="7016937">EmailAddresses</span><span class="op" id="7016951">)</span>&nbsp;<span class="op" id="7016953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7016958">t</span><span class="op" id="7016959">.</span><span class="ident" id="7016960">Errorf</span><span class="op" id="7016966">(</span><span class="string" id="7016967">&#34;%s:&nbsp;output&nbsp;email&nbsp;addresses&nbsp;and&nbsp;template&nbsp;email&nbsp;addresses&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7017036">,</span>&nbsp;<span class="ident" id="7017038">test</span><span class="op" id="7017042">.</span><span class="ident" id="7017043">name</span><span class="op" id="7017047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7017051">}</span>&nbsp;<span class="keyword" id="7017053">else</span>&nbsp;<span class="keyword" id="7017058">if</span>&nbsp;<span class="builtinfunc" id="7017061">len</span><span class="op" id="7017064">(</span><span class="ident" id="7017065">out</span><span class="op" id="7017068">.</span><span class="ident" id="7017069">IPAddresses</span><span class="op" id="7017080">)</span>&nbsp;<span class="op" id="7017082">!=</span>&nbsp;<span class="builtinfunc" id="7017085">len</span><span class="op" id="7017088">(</span><span class="ident" id="7017089">template</span><span class="op" id="7017097">.</span><span class="ident" id="7017098">IPAddresses</span><span class="op" id="7017109">)</span>&nbsp;<span class="op" id="7017111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017116">t</span><span class="op" id="7017117">.</span><span class="ident" id="7017118">Errorf</span><span class="op" id="7017124">(</span><span class="string" id="7017125">&#34;%s:&nbsp;output&nbsp;IP&nbsp;addresses&nbsp;and&nbsp;template&nbsp;IP&nbsp;addresses&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7017194">,</span>&nbsp;<span class="ident" id="7017196">test</span><span class="op" id="7017200">.</span><span class="ident" id="7017201">name</span><span class="op" id="7017205">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7017209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7017212">}</span><br>
<span class="lineno"></span><span class="op" id="7017214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7017217">func</span>&nbsp;<span class="ident" id="7017222">marshalAndParseCSR</span><span class="op" id="7017240">(</span><span class="ident" id="7017241">t</span>&nbsp;<span class="op" id="7017243">*</span><span class="ident" id="7017244">testing</span><span class="op" id="7017251">.</span><span class="ident" id="7017252">T</span><span class="op" id="7017253">,</span>&nbsp;<span class="ident" id="7017255">template</span>&nbsp;<span class="op" id="7017264">*</span><span class="ident" id="7017265">CertificateRequest</span><span class="op" id="7017283">)</span>&nbsp;<span class="op" id="7017285">*</span><span class="ident" id="7017286">CertificateRequest</span>&nbsp;<span class="op" id="7017305">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017308">block</span><span class="op" id="7017313">,</span>&nbsp;<span class="ident" id="7017315">_</span>&nbsp;<span class="op" id="7017317">:=</span>&nbsp;<span class="ident" id="7017320">pem</span><span class="op" id="7017323">.</span><span class="ident" id="7017324">Decode</span><span class="op" id="7017330">(</span><span class="op" id="7017331">[</span><span class="op" id="7017332">]</span><span class="builtintype" id="7017333">byte</span><span class="op" id="7017337">(</span><span class="ident" id="7017338">pemPrivateKey</span><span class="op" id="7017351">)</span><span class="op" id="7017352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017355">rsaPriv</span><span class="op" id="7017362">,</span>&nbsp;<span class="ident" id="7017364">err</span>&nbsp;<span class="op" id="7017368">:=</span>&nbsp;<span class="ident" id="7017371">ParsePKCS1PrivateKey</span><span class="op" id="7017391">(</span><span class="ident" id="7017392">block</span><span class="op" id="7017397">.</span><span class="ident" id="7017398">Bytes</span><span class="op" id="7017403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7017406">if</span>&nbsp;<span class="ident" id="7017409">err</span>&nbsp;<span class="op" id="7017413">!=</span>&nbsp;<span class="ident" id="7017416">nil</span>&nbsp;<span class="op" id="7017420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017424">t</span><span class="op" id="7017425">.</span><span class="ident" id="7017426">Fatal</span><span class="op" id="7017431">(</span><span class="ident" id="7017432">err</span><span class="op" id="7017435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7017438">}</span><br>
<span class="lineno">835</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017442">derBytes</span><span class="op" id="7017450">,</span>&nbsp;<span class="ident" id="7017452">err</span>&nbsp;<span class="op" id="7017456">:=</span>&nbsp;<span class="ident" id="7017459">CreateCertificateRequest</span><span class="op" id="7017483">(</span><span class="ident" id="7017484">rand</span><span class="op" id="7017488">.</span><span class="ident" id="7017489">Reader</span><span class="op" id="7017495">,</span>&nbsp;<span class="ident" id="7017497">template</span><span class="op" id="7017505">,</span>&nbsp;<span class="ident" id="7017507">rsaPriv</span><span class="op" id="7017514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7017517">if</span>&nbsp;<span class="ident" id="7017520">err</span>&nbsp;<span class="op" id="7017524">!=</span>&nbsp;<span class="ident" id="7017527">nil</span>&nbsp;<span class="op" id="7017531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017535">t</span><span class="op" id="7017536">.</span><span class="ident" id="7017537">Fatal</span><span class="op" id="7017542">(</span><span class="ident" id="7017543">err</span><span class="op" id="7017546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7017549">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017553">csr</span><span class="op" id="7017556">,</span>&nbsp;<span class="ident" id="7017558">err</span>&nbsp;<span class="op" id="7017562">:=</span>&nbsp;<span class="ident" id="7017565">ParseCertificateRequest</span><span class="op" id="7017588">(</span><span class="ident" id="7017589">derBytes</span><span class="op" id="7017597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7017600">if</span>&nbsp;<span class="ident" id="7017603">err</span>&nbsp;<span class="op" id="7017607">!=</span>&nbsp;<span class="ident" id="7017610">nil</span>&nbsp;<span class="op" id="7017614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017618">t</span><span class="op" id="7017619">.</span><span class="ident" id="7017620">Fatal</span><span class="op" id="7017625">(</span><span class="ident" id="7017626">err</span><span class="op" id="7017629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7017632">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7017636">return</span>&nbsp;<span class="ident" id="7017643">csr</span><br>
<span class="lineno"></span><span class="op" id="7017647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7017650">func</span>&nbsp;<span class="ident" id="7017655">TestCertificateRequestOverrides</span><span class="op" id="7017686">(</span><span class="ident" id="7017687">t</span>&nbsp;<span class="op" id="7017689">*</span><span class="ident" id="7017690">testing</span><span class="op" id="7017697">.</span><span class="ident" id="7017698">T</span><span class="op" id="7017699">)</span>&nbsp;<span class="op" id="7017701">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017704">sanContents</span><span class="op" id="7017715">,</span>&nbsp;<span class="ident" id="7017717">err</span>&nbsp;<span class="op" id="7017721">:=</span>&nbsp;<span class="ident" id="7017724">marshalSANs</span><span class="op" id="7017735">(</span><span class="op" id="7017736">[</span><span class="op" id="7017737">]</span><span class="builtintype" id="7017738">string</span><span class="op" id="7017744">{</span><span class="string" id="7017745">&#34;foo.example.com&#34;</span><span class="op" id="7017762">}</span><span class="op" id="7017763">,</span>&nbsp;<span class="ident" id="7017765">nil</span><span class="op" id="7017768">,</span>&nbsp;<span class="ident" id="7017770">nil</span><span class="op" id="7017773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7017776">if</span>&nbsp;<span class="ident" id="7017779">err</span>&nbsp;<span class="op" id="7017783">!=</span>&nbsp;<span class="ident" id="7017786">nil</span>&nbsp;<span class="op" id="7017790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017794">t</span><span class="op" id="7017795">.</span><span class="ident" id="7017796">Fatal</span><span class="op" id="7017801">(</span><span class="ident" id="7017802">err</span><span class="op" id="7017805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7017808">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017812">template</span>&nbsp;<span class="op" id="7017821">:=</span>&nbsp;<span class="ident" id="7017824">CertificateRequest</span><span class="op" id="7017842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017846">Subject</span><span class="op" id="7017853">:</span>&nbsp;<span class="ident" id="7017855">pkix</span><span class="op" id="7017859">.</span><span class="ident" id="7017860">Name</span><span class="op" id="7017864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017869">CommonName</span><span class="op" id="7017879">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7017883">&#34;test.example.com&#34;</span><span class="op" id="7017901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017906">Organization</span><span class="op" id="7017918">:</span>&nbsp;<span class="op" id="7017920">[</span><span class="op" id="7017921">]</span><span class="builtintype" id="7017922">string</span><span class="op" id="7017928">{</span><span class="string" id="7017929">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7017941">}</span><span class="op" id="7017942">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7017946">}</span><span class="op" id="7017947">,</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017951">DNSNames</span><span class="op" id="7017959">:</span>&nbsp;<span class="op" id="7017961">[</span><span class="op" id="7017962">]</span><span class="builtintype" id="7017963">string</span><span class="op" id="7017969">{</span><span class="string" id="7017970">&#34;test.example.com&#34;</span><span class="op" id="7017988">}</span><span class="op" id="7017989">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7017994">//&nbsp;An&nbsp;explicit&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;DNSNames&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7018059">//&nbsp;template.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7018074">ExtraExtensions</span><span class="op" id="7018089">:</span>&nbsp;<span class="op" id="7018091">[</span><span class="op" id="7018092">]</span><span class="ident" id="7018093">pkix</span><span class="op" id="7018097">.</span><span class="ident" id="7018098">Extension</span><span class="op" id="7018107">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7018112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7018118">Id</span><span class="op" id="7018120">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7018125">oidExtensionSubjectAltName</span><span class="op" id="7018151">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7018157">Value</span><span class="op" id="7018162">:</span>&nbsp;<span class="ident" id="7018164">sanContents</span><span class="op" id="7018175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7018180">}</span><span class="op" id="7018181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7018185">}</span><span class="op" id="7018186">,</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7018189">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7018193">csr</span>&nbsp;<span class="op" id="7018197">:=</span>&nbsp;<span class="ident" id="7018200">marshalAndParseCSR</span><span class="op" id="7018218">(</span><span class="ident" id="7018219">t</span><span class="op" id="7018220">,</span>&nbsp;<span class="op" id="7018222">&amp;</span><span class="ident" id="7018223">template</span><span class="op" id="7018231">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7018235">if</span>&nbsp;<span class="builtinfunc" id="7018238">len</span><span class="op" id="7018241">(</span><span class="ident" id="7018242">csr</span><span class="op" id="7018245">.</span><span class="ident" id="7018246">DNSNames</span><span class="op" id="7018254">)</span>&nbsp;<span class="op" id="7018256">!=</span>&nbsp;<span class="num" id="7018259">1</span>&nbsp;<span class="op" id="7018261">||</span>&nbsp;<span class="ident" id="7018264">csr</span><span class="op" id="7018267">.</span><span class="ident" id="7018268">DNSNames</span><span class="op" id="7018276">[</span><span class="num" id="7018277">0</span><span class="op" id="7018278">]</span>&nbsp;<span class="op" id="7018280">!=</span>&nbsp;<span class="string" id="7018283">&#34;foo.example.com&#34;</span>&nbsp;<span class="op" id="7018301">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7018305">t</span><span class="op" id="7018306">.</span><span class="ident" id="7018307">Errorf</span><span class="op" id="7018313">(</span><span class="string" id="7018314">&#34;Extension&nbsp;did&nbsp;not&nbsp;override&nbsp;template.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="7018361">,</span>&nbsp;<span class="ident" id="7018363">csr</span><span class="op" id="7018366">.</span><span class="ident" id="7018367">DNSNames</span><span class="op" id="7018375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7018378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7018382">//&nbsp;If&nbsp;there&nbsp;is&nbsp;already&nbsp;an&nbsp;attribute&nbsp;with&nbsp;X.509&nbsp;extensions&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7018450">//&nbsp;extra&nbsp;extensions&nbsp;should&nbsp;be&nbsp;added&nbsp;to&nbsp;it&nbsp;rather&nbsp;than&nbsp;creating&nbsp;a&nbsp;CSR</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7018520">//&nbsp;with&nbsp;two&nbsp;extension&nbsp;attributes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7018556">template</span><span class="op" id="7018564">.</span><span class="ident" id="7018565">Attributes</span>&nbsp;<span class="op" id="7018576">=</span>&nbsp;<span class="op" id="7018578">[</span><span class="op" id="7018579">]</span><span class="ident" id="7018580">pkix</span><span class="op" id="7018584">.</span><span class="ident" id="7018585">AttributeTypeAndValueSET</span><span class="op" id="7018609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7018613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7018618">Type</span><span class="op" id="7018622">:</span>&nbsp;<span class="ident" id="7018624">oidExtensionRequest</span><span class="op" id="7018643">,</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7018648">Value</span><span class="op" id="7018653">:</span>&nbsp;<span class="op" id="7018655">[</span><span class="op" id="7018656">]</span><span class="op" id="7018657">[</span><span class="op" id="7018658">]</span><span class="ident" id="7018659">pkix</span><span class="op" id="7018663">.</span><span class="ident" id="7018664">AttributeTypeAndValue</span><span class="op" id="7018685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7018691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7018698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7018706">Type</span><span class="op" id="7018710">:</span>&nbsp;&nbsp;<span class="ident" id="7018713">oidExtensionAuthorityInfoAccess</span><span class="op" id="7018744">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7018752">Value</span><span class="op" id="7018757">:</span>&nbsp;<span class="op" id="7018759">[</span><span class="op" id="7018760">]</span><span class="builtintype" id="7018761">byte</span><span class="op" id="7018765">(</span><span class="string" id="7018766">&#34;foo&#34;</span><span class="op" id="7018771">)</span><span class="op" id="7018772">,</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7018779">}</span><span class="op" id="7018780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7018786">}</span><span class="op" id="7018787">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7018792">}</span><span class="op" id="7018793">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7018797">}</span><span class="op" id="7018798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7018801">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7018805">csr</span>&nbsp;<span class="op" id="7018809">=</span>&nbsp;<span class="ident" id="7018811">marshalAndParseCSR</span><span class="op" id="7018829">(</span><span class="ident" id="7018830">t</span><span class="op" id="7018831">,</span>&nbsp;<span class="op" id="7018833">&amp;</span><span class="ident" id="7018834">template</span><span class="op" id="7018842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7018845">if</span>&nbsp;<span class="ident" id="7018848">l</span>&nbsp;<span class="op" id="7018850">:=</span>&nbsp;<span class="builtinfunc" id="7018853">len</span><span class="op" id="7018856">(</span><span class="ident" id="7018857">csr</span><span class="op" id="7018860">.</span><span class="ident" id="7018861">Attributes</span><span class="op" id="7018871">)</span><span class="op" id="7018872">;</span>&nbsp;<span class="ident" id="7018874">l</span>&nbsp;<span class="op" id="7018876">!=</span>&nbsp;<span class="num" id="7018879">1</span>&nbsp;<span class="op" id="7018881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7018885">t</span><span class="op" id="7018886">.</span><span class="ident" id="7018887">Errorf</span><span class="op" id="7018893">(</span><span class="string" id="7018894">&#34;incorrect&nbsp;number&nbsp;of&nbsp;attributes:&nbsp;%d\n&#34;</span><span class="op" id="7018932">,</span>&nbsp;<span class="ident" id="7018934">l</span><span class="op" id="7018935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7018938">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7018942">if</span>&nbsp;<span class="op" id="7018945">!</span><span class="ident" id="7018946">csr</span><span class="op" id="7018949">.</span><span class="ident" id="7018950">Attributes</span><span class="op" id="7018960">[</span><span class="num" id="7018961">0</span><span class="op" id="7018962">]</span><span class="op" id="7018963">.</span><span class="ident" id="7018964">Type</span><span class="op" id="7018968">.</span><span class="ident" id="7018969">Equal</span><span class="op" id="7018974">(</span><span class="ident" id="7018975">oidExtensionRequest</span><span class="op" id="7018994">)</span>&nbsp;<span class="op" id="7018996">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7019001">len</span><span class="op" id="7019004">(</span><span class="ident" id="7019005">csr</span><span class="op" id="7019008">.</span><span class="ident" id="7019009">Attributes</span><span class="op" id="7019019">[</span><span class="num" id="7019020">0</span><span class="op" id="7019021">]</span><span class="op" id="7019022">.</span><span class="ident" id="7019023">Value</span><span class="op" id="7019028">)</span>&nbsp;<span class="op" id="7019030">!=</span>&nbsp;<span class="num" id="7019033">1</span>&nbsp;<span class="op" id="7019035">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7019040">len</span><span class="op" id="7019043">(</span><span class="ident" id="7019044">csr</span><span class="op" id="7019047">.</span><span class="ident" id="7019048">Attributes</span><span class="op" id="7019058">[</span><span class="num" id="7019059">0</span><span class="op" id="7019060">]</span><span class="op" id="7019061">.</span><span class="ident" id="7019062">Value</span><span class="op" id="7019067">[</span><span class="num" id="7019068">0</span><span class="op" id="7019069">]</span><span class="op" id="7019070">)</span>&nbsp;<span class="op" id="7019072">!=</span>&nbsp;<span class="num" id="7019075">2</span>&nbsp;<span class="op" id="7019077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7019081">t</span><span class="op" id="7019082">.</span><span class="ident" id="7019083">Errorf</span><span class="op" id="7019089">(</span><span class="string" id="7019090">&#34;bad&nbsp;attributes:&nbsp;%#v\n&#34;</span><span class="op" id="7019113">,</span>&nbsp;<span class="ident" id="7019115">csr</span><span class="op" id="7019118">.</span><span class="ident" id="7019119">Attributes</span><span class="op" id="7019129">)</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7019132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7019136">sanContents2</span><span class="op" id="7019148">,</span>&nbsp;<span class="ident" id="7019150">err</span>&nbsp;<span class="op" id="7019154">:=</span>&nbsp;<span class="ident" id="7019157">marshalSANs</span><span class="op" id="7019168">(</span><span class="op" id="7019169">[</span><span class="op" id="7019170">]</span><span class="builtintype" id="7019171">string</span><span class="op" id="7019177">{</span><span class="string" id="7019178">&#34;foo2.example.com&#34;</span><span class="op" id="7019196">}</span><span class="op" id="7019197">,</span>&nbsp;<span class="ident" id="7019199">nil</span><span class="op" id="7019202">,</span>&nbsp;<span class="ident" id="7019204">nil</span><span class="op" id="7019207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7019210">if</span>&nbsp;<span class="ident" id="7019213">err</span>&nbsp;<span class="op" id="7019217">!=</span>&nbsp;<span class="ident" id="7019220">nil</span>&nbsp;<span class="op" id="7019224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7019228">t</span><span class="op" id="7019229">.</span><span class="ident" id="7019230">Fatal</span><span class="op" id="7019235">(</span><span class="ident" id="7019236">err</span><span class="op" id="7019239">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7019242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7019246">//&nbsp;Extensions&nbsp;in&nbsp;Attributes&nbsp;should&nbsp;override&nbsp;those&nbsp;in&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7019317">template</span><span class="op" id="7019325">.</span><span class="ident" id="7019326">Attributes</span><span class="op" id="7019336">[</span><span class="num" id="7019337">0</span><span class="op" id="7019338">]</span><span class="op" id="7019339">.</span><span class="ident" id="7019340">Value</span><span class="op" id="7019345">[</span><span class="num" id="7019346">0</span><span class="op" id="7019347">]</span>&nbsp;<span class="op" id="7019349">=</span>&nbsp;<span class="builtinfunc" id="7019351">append</span><span class="op" id="7019357">(</span><span class="ident" id="7019358">template</span><span class="op" id="7019366">.</span><span class="ident" id="7019367">Attributes</span><span class="op" id="7019377">[</span><span class="num" id="7019378">0</span><span class="op" id="7019379">]</span><span class="op" id="7019380">.</span><span class="ident" id="7019381">Value</span><span class="op" id="7019386">[</span><span class="num" id="7019387">0</span><span class="op" id="7019388">]</span><span class="op" id="7019389">,</span>&nbsp;<span class="ident" id="7019391">pkix</span><span class="op" id="7019395">.</span><span class="ident" id="7019396">AttributeTypeAndValue</span><span class="op" id="7019417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7019421">Type</span><span class="op" id="7019425">:</span>&nbsp;&nbsp;<span class="ident" id="7019428">oidExtensionSubjectAltName</span><span class="op" id="7019454">,</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7019458">Value</span><span class="op" id="7019463">:</span>&nbsp;<span class="ident" id="7019465">sanContents2</span><span class="op" id="7019477">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7019480">}</span><span class="op" id="7019481">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7019485">csr</span>&nbsp;<span class="op" id="7019489">=</span>&nbsp;<span class="ident" id="7019491">marshalAndParseCSR</span><span class="op" id="7019509">(</span><span class="ident" id="7019510">t</span><span class="op" id="7019511">,</span>&nbsp;<span class="op" id="7019513">&amp;</span><span class="ident" id="7019514">template</span><span class="op" id="7019522">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7019526">if</span>&nbsp;<span class="builtinfunc" id="7019529">len</span><span class="op" id="7019532">(</span><span class="ident" id="7019533">csr</span><span class="op" id="7019536">.</span><span class="ident" id="7019537">DNSNames</span><span class="op" id="7019545">)</span>&nbsp;<span class="op" id="7019547">!=</span>&nbsp;<span class="num" id="7019550">1</span>&nbsp;<span class="op" id="7019552">||</span>&nbsp;<span class="ident" id="7019555">csr</span><span class="op" id="7019558">.</span><span class="ident" id="7019559">DNSNames</span><span class="op" id="7019567">[</span><span class="num" id="7019568">0</span><span class="op" id="7019569">]</span>&nbsp;<span class="op" id="7019571">!=</span>&nbsp;<span class="string" id="7019574">&#34;foo2.example.com&#34;</span>&nbsp;<span class="op" id="7019593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7019597">t</span><span class="op" id="7019598">.</span><span class="ident" id="7019599">Errorf</span><span class="op" id="7019605">(</span><span class="string" id="7019606">&#34;Attributes&nbsp;did&nbsp;not&nbsp;override&nbsp;ExtraExtensions.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="7019661">,</span>&nbsp;<span class="ident" id="7019663">csr</span><span class="op" id="7019666">.</span><span class="ident" id="7019667">DNSNames</span><span class="op" id="7019675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7019678">}</span><br>
<span class="lineno"></span><span class="op" id="7019680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="keyword" id="7019683">func</span>&nbsp;<span class="ident" id="7019688">TestParseCertificateRequest</span><span class="op" id="7019715">(</span><span class="ident" id="7019716">t</span>&nbsp;<span class="op" id="7019718">*</span><span class="ident" id="7019719">testing</span><span class="op" id="7019726">.</span><span class="ident" id="7019727">T</span><span class="op" id="7019728">)</span>&nbsp;<span class="op" id="7019730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7019733">csrBytes</span>&nbsp;<span class="op" id="7019742">:=</span>&nbsp;<span class="ident" id="7019745">fromBase64</span><span class="op" id="7019755">(</span><span class="ident" id="7019756">csrBase64</span><span class="op" id="7019765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7019768">csr</span><span class="op" id="7019771">,</span>&nbsp;<span class="ident" id="7019773">err</span>&nbsp;<span class="op" id="7019777">:=</span>&nbsp;<span class="ident" id="7019780">ParseCertificateRequest</span><span class="op" id="7019803">(</span><span class="ident" id="7019804">csrBytes</span><span class="op" id="7019812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7019815">if</span>&nbsp;<span class="ident" id="7019818">err</span>&nbsp;<span class="op" id="7019822">!=</span>&nbsp;<span class="ident" id="7019825">nil</span>&nbsp;<span class="op" id="7019829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7019833">t</span><span class="op" id="7019834">.</span><span class="ident" id="7019835">Fatalf</span><span class="op" id="7019841">(</span><span class="string" id="7019842">&#34;failed&nbsp;to&nbsp;parse&nbsp;CSR:&nbsp;%s&#34;</span><span class="op" id="7019867">,</span>&nbsp;<span class="ident" id="7019869">err</span><span class="op" id="7019872">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7019875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7019879">if</span>&nbsp;<span class="builtinfunc" id="7019882">len</span><span class="op" id="7019885">(</span><span class="ident" id="7019886">csr</span><span class="op" id="7019889">.</span><span class="ident" id="7019890">EmailAddresses</span><span class="op" id="7019904">)</span>&nbsp;<span class="op" id="7019906">!=</span>&nbsp;<span class="num" id="7019909">1</span>&nbsp;<span class="op" id="7019911">||</span>&nbsp;<span class="ident" id="7019914">csr</span><span class="op" id="7019917">.</span><span class="ident" id="7019918">EmailAddresses</span><span class="op" id="7019932">[</span><span class="num" id="7019933">0</span><span class="op" id="7019934">]</span>&nbsp;<span class="op" id="7019936">!=</span>&nbsp;<span class="string" id="7019939">&#34;gopher@golang.org&#34;</span>&nbsp;<span class="op" id="7019959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7019963">t</span><span class="op" id="7019964">.</span><span class="ident" id="7019965">Errorf</span><span class="op" id="7019971">(</span><span class="string" id="7019972">&#34;incorrect&nbsp;email&nbsp;addresses&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="7020009">,</span>&nbsp;<span class="ident" id="7020011">csr</span><span class="op" id="7020014">.</span><span class="ident" id="7020015">EmailAddresses</span><span class="op" id="7020029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7020032">}</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7020036">if</span>&nbsp;<span class="builtinfunc" id="7020039">len</span><span class="op" id="7020042">(</span><span class="ident" id="7020043">csr</span><span class="op" id="7020046">.</span><span class="ident" id="7020047">DNSNames</span><span class="op" id="7020055">)</span>&nbsp;<span class="op" id="7020057">!=</span>&nbsp;<span class="num" id="7020060">1</span>&nbsp;<span class="op" id="7020062">||</span>&nbsp;<span class="ident" id="7020065">csr</span><span class="op" id="7020068">.</span><span class="ident" id="7020069">DNSNames</span><span class="op" id="7020077">[</span><span class="num" id="7020078">0</span><span class="op" id="7020079">]</span>&nbsp;<span class="op" id="7020081">!=</span>&nbsp;<span class="string" id="7020084">&#34;test.example.com&#34;</span>&nbsp;<span class="op" id="7020103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7020107">t</span><span class="op" id="7020108">.</span><span class="ident" id="7020109">Errorf</span><span class="op" id="7020115">(</span><span class="string" id="7020116">&#34;incorrect&nbsp;DNS&nbsp;names&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="7020147">,</span>&nbsp;<span class="ident" id="7020149">csr</span><span class="op" id="7020152">.</span><span class="ident" id="7020153">DNSNames</span><span class="op" id="7020161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7020164">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7020168">if</span>&nbsp;<span class="builtinfunc" id="7020171">len</span><span class="op" id="7020174">(</span><span class="ident" id="7020175">csr</span><span class="op" id="7020178">.</span><span class="ident" id="7020179">Subject</span><span class="op" id="7020186">.</span><span class="ident" id="7020187">Country</span><span class="op" id="7020194">)</span>&nbsp;<span class="op" id="7020196">!=</span>&nbsp;<span class="num" id="7020199">1</span>&nbsp;<span class="op" id="7020201">||</span>&nbsp;<span class="ident" id="7020204">csr</span><span class="op" id="7020207">.</span><span class="ident" id="7020208">Subject</span><span class="op" id="7020215">.</span><span class="ident" id="7020216">Country</span><span class="op" id="7020223">[</span><span class="num" id="7020224">0</span><span class="op" id="7020225">]</span>&nbsp;<span class="op" id="7020227">!=</span>&nbsp;<span class="string" id="7020230">&#34;AU&#34;</span>&nbsp;<span class="op" id="7020235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7020239">t</span><span class="op" id="7020240">.</span><span class="ident" id="7020241">Errorf</span><span class="op" id="7020247">(</span><span class="string" id="7020248">&#34;incorrect&nbsp;Subject&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="7020276">,</span>&nbsp;<span class="ident" id="7020278">csr</span><span class="op" id="7020281">.</span><span class="ident" id="7020282">Subject</span><span class="op" id="7020289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7020292">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7020296">found</span>&nbsp;<span class="op" id="7020302">:=</span>&nbsp;<span class="builtintype" id="7020305">false</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7020312">for</span>&nbsp;<span class="ident" id="7020316">_</span><span class="op" id="7020317">,</span>&nbsp;<span class="ident" id="7020319">e</span>&nbsp;<span class="op" id="7020321">:=</span>&nbsp;<span class="keyword" id="7020324">range</span>&nbsp;<span class="ident" id="7020330">csr</span><span class="op" id="7020333">.</span><span class="ident" id="7020334">Extensions</span>&nbsp;<span class="op" id="7020345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7020349">if</span>&nbsp;<span class="ident" id="7020352">e</span><span class="op" id="7020353">.</span><span class="ident" id="7020354">Id</span><span class="op" id="7020356">.</span><span class="ident" id="7020357">Equal</span><span class="op" id="7020362">(</span><span class="ident" id="7020363">oidExtensionBasicConstraints</span><span class="op" id="7020391">)</span>&nbsp;<span class="op" id="7020393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7020398">found</span>&nbsp;<span class="op" id="7020404">=</span>&nbsp;<span class="builtintype" id="7020406">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7020414">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7020422">}</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7020425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7020428">if</span>&nbsp;<span class="op" id="7020431">!</span><span class="ident" id="7020432">found</span>&nbsp;<span class="op" id="7020438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7020442">t</span><span class="op" id="7020443">.</span><span class="ident" id="7020444">Errorf</span><span class="op" id="7020450">(</span><span class="string" id="7020451">&#34;basic&nbsp;constraints&nbsp;extension&nbsp;not&nbsp;found&nbsp;in&nbsp;CSR&#34;</span><span class="op" id="7020497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7020500">}</span><br>
<span class="lineno"></span><span class="op" id="7020502">}</span><br>
<span class="lineno">955</span><br>
<span class="lineno"></span><span class="keyword" id="7020505">func</span>&nbsp;<span class="ident" id="7020510">TestMaxPathLen</span><span class="op" id="7020524">(</span><span class="ident" id="7020525">t</span>&nbsp;<span class="op" id="7020527">*</span><span class="ident" id="7020528">testing</span><span class="op" id="7020535">.</span><span class="ident" id="7020536">T</span><span class="op" id="7020537">)</span>&nbsp;<span class="op" id="7020539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7020542">block</span><span class="op" id="7020547">,</span>&nbsp;<span class="ident" id="7020549">_</span>&nbsp;<span class="op" id="7020551">:=</span>&nbsp;<span class="ident" id="7020554">pem</span><span class="op" id="7020557">.</span><span class="ident" id="7020558">Decode</span><span class="op" id="7020564">(</span><span class="op" id="7020565">[</span><span class="op" id="7020566">]</span><span class="builtintype" id="7020567">byte</span><span class="op" id="7020571">(</span><span class="ident" id="7020572">pemPrivateKey</span><span class="op" id="7020585">)</span><span class="op" id="7020586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7020589">rsaPriv</span><span class="op" id="7020596">,</span>&nbsp;<span class="ident" id="7020598">err</span>&nbsp;<span class="op" id="7020602">:=</span>&nbsp;<span class="ident" id="7020605">ParsePKCS1PrivateKey</span><span class="op" id="7020625">(</span><span class="ident" id="7020626">block</span><span class="op" id="7020631">.</span><span class="ident" id="7020632">Bytes</span><span class="op" id="7020637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7020640">if</span>&nbsp;<span class="ident" id="7020643">err</span>&nbsp;<span class="op" id="7020647">!=</span>&nbsp;<span class="ident" id="7020650">nil</span>&nbsp;<span class="op" id="7020654">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7020658">t</span><span class="op" id="7020659">.</span><span class="ident" id="7020660">Fatalf</span><span class="op" id="7020666">(</span><span class="string" id="7020667">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7020700">,</span>&nbsp;<span class="ident" id="7020702">err</span><span class="op" id="7020705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7020708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7020712">template</span>&nbsp;<span class="op" id="7020721">:=</span>&nbsp;<span class="op" id="7020724">&amp;</span><span class="ident" id="7020725">Certificate</span><span class="op" id="7020736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7020740">SerialNumber</span><span class="op" id="7020752">:</span>&nbsp;<span class="ident" id="7020754">big</span><span class="op" id="7020757">.</span><span class="ident" id="7020758">NewInt</span><span class="op" id="7020764">(</span><span class="num" id="7020765">1</span><span class="op" id="7020766">)</span><span class="op" id="7020767">,</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7020771">Subject</span><span class="op" id="7020778">:</span>&nbsp;<span class="ident" id="7020780">pkix</span><span class="op" id="7020784">.</span><span class="ident" id="7020785">Name</span><span class="op" id="7020789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7020794">CommonName</span><span class="op" id="7020804">:</span>&nbsp;<span class="string" id="7020806">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7020818">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7020822">}</span><span class="op" id="7020823">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7020827">NotBefore</span><span class="op" id="7020836">:</span>&nbsp;<span class="ident" id="7020838">time</span><span class="op" id="7020842">.</span><span class="ident" id="7020843">Unix</span><span class="op" id="7020847">(</span><span class="num" id="7020848">1000</span><span class="op" id="7020852">,</span>&nbsp;<span class="num" id="7020854">0</span><span class="op" id="7020855">)</span><span class="op" id="7020856">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7020860">NotAfter</span><span class="op" id="7020868">:</span>&nbsp;&nbsp;<span class="ident" id="7020871">time</span><span class="op" id="7020875">.</span><span class="ident" id="7020876">Unix</span><span class="op" id="7020880">(</span><span class="num" id="7020881">100000</span><span class="op" id="7020887">,</span>&nbsp;<span class="num" id="7020889">0</span><span class="op" id="7020890">)</span><span class="op" id="7020891">,</span><br>
<span class="lineno">970</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7020896">BasicConstraintsValid</span><span class="op" id="7020917">:</span>&nbsp;<span class="builtintype" id="7020919">true</span><span class="op" id="7020923">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7020927">IsCA</span><span class="op" id="7020931">:</span>&nbsp;<span class="builtintype" id="7020933">true</span><span class="op" id="7020937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7020940">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7020944">serialiseAndParse</span>&nbsp;<span class="op" id="7020962">:=</span>&nbsp;<span class="keyword" id="7020965">func</span><span class="op" id="7020969">(</span><span class="ident" id="7020970">template</span>&nbsp;<span class="op" id="7020979">*</span><span class="ident" id="7020980">Certificate</span><span class="op" id="7020991">)</span>&nbsp;<span class="op" id="7020993">*</span><span class="ident" id="7020994">Certificate</span>&nbsp;<span class="op" id="7021006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7021010">derBytes</span><span class="op" id="7021018">,</span>&nbsp;<span class="ident" id="7021020">err</span>&nbsp;<span class="op" id="7021024">:=</span>&nbsp;<span class="ident" id="7021027">CreateCertificate</span><span class="op" id="7021044">(</span><span class="ident" id="7021045">rand</span><span class="op" id="7021049">.</span><span class="ident" id="7021050">Reader</span><span class="op" id="7021056">,</span>&nbsp;<span class="ident" id="7021058">template</span><span class="op" id="7021066">,</span>&nbsp;<span class="ident" id="7021068">template</span><span class="op" id="7021076">,</span>&nbsp;<span class="op" id="7021078">&amp;</span><span class="ident" id="7021079">rsaPriv</span><span class="op" id="7021086">.</span><span class="ident" id="7021087">PublicKey</span><span class="op" id="7021096">,</span>&nbsp;<span class="ident" id="7021098">rsaPriv</span><span class="op" id="7021105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7021109">if</span>&nbsp;<span class="ident" id="7021112">err</span>&nbsp;<span class="op" id="7021116">!=</span>&nbsp;<span class="ident" id="7021119">nil</span>&nbsp;<span class="op" id="7021123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7021128">t</span><span class="op" id="7021129">.</span><span class="ident" id="7021130">Fatalf</span><span class="op" id="7021136">(</span><span class="string" id="7021137">&#34;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7021171">,</span>&nbsp;<span class="ident" id="7021173">err</span><span class="op" id="7021176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7021181">return</span>&nbsp;<span class="ident" id="7021188">nil</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7021194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7021199">cert</span><span class="op" id="7021203">,</span>&nbsp;<span class="ident" id="7021205">err</span>&nbsp;<span class="op" id="7021209">:=</span>&nbsp;<span class="ident" id="7021212">ParseCertificate</span><span class="op" id="7021228">(</span><span class="ident" id="7021229">derBytes</span><span class="op" id="7021237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7021241">if</span>&nbsp;<span class="ident" id="7021244">err</span>&nbsp;<span class="op" id="7021248">!=</span>&nbsp;<span class="ident" id="7021251">nil</span>&nbsp;<span class="op" id="7021255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7021260">t</span><span class="op" id="7021261">.</span><span class="ident" id="7021262">Fatalf</span><span class="op" id="7021268">(</span><span class="string" id="7021269">&#34;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7021302">,</span>&nbsp;<span class="ident" id="7021304">err</span><span class="op" id="7021307">)</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7021312">return</span>&nbsp;<span class="ident" id="7021319">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7021325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7021330">return</span>&nbsp;<span class="ident" id="7021337">cert</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7021343">}</span><br>
<span class="lineno">990</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7021347">cert1</span>&nbsp;<span class="op" id="7021353">:=</span>&nbsp;<span class="ident" id="7021356">serialiseAndParse</span><span class="op" id="7021373">(</span><span class="ident" id="7021374">template</span><span class="op" id="7021382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7021385">if</span>&nbsp;<span class="ident" id="7021388">m</span>&nbsp;<span class="op" id="7021390">:=</span>&nbsp;<span class="ident" id="7021393">cert1</span><span class="op" id="7021398">.</span><span class="ident" id="7021399">MaxPathLen</span><span class="op" id="7021409">;</span>&nbsp;<span class="ident" id="7021411">m</span>&nbsp;<span class="op" id="7021413">!=</span>&nbsp;<span class="op" id="7021416">-</span><span class="num" id="7021417">1</span>&nbsp;<span class="op" id="7021419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7021423">t</span><span class="op" id="7021424">.</span><span class="ident" id="7021425">Errorf</span><span class="op" id="7021431">(</span><span class="string" id="7021432">&#34;Omitting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;turn&nbsp;into&nbsp;-1,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7021481">,</span>&nbsp;<span class="ident" id="7021483">m</span><span class="op" id="7021484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7021487">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7021490">if</span>&nbsp;<span class="ident" id="7021493">cert1</span><span class="op" id="7021498">.</span><span class="ident" id="7021499">MaxPathLenZero</span>&nbsp;<span class="op" id="7021514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7021518">t</span><span class="op" id="7021519">.</span><span class="ident" id="7021520">Errorf</span><span class="op" id="7021526">(</span><span class="string" id="7021527">&#34;Omitting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="7021575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7021578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7021582">template</span><span class="op" id="7021590">.</span><span class="ident" id="7021591">MaxPathLen</span>&nbsp;<span class="op" id="7021602">=</span>&nbsp;<span class="num" id="7021604">1</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7021607">cert2</span>&nbsp;<span class="op" id="7021613">:=</span>&nbsp;<span class="ident" id="7021616">serialiseAndParse</span><span class="op" id="7021633">(</span><span class="ident" id="7021634">template</span><span class="op" id="7021642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7021645">if</span>&nbsp;<span class="ident" id="7021648">m</span>&nbsp;<span class="op" id="7021650">:=</span>&nbsp;<span class="ident" id="7021653">cert2</span><span class="op" id="7021658">.</span><span class="ident" id="7021659">MaxPathLen</span><span class="op" id="7021669">;</span>&nbsp;<span class="ident" id="7021671">m</span>&nbsp;<span class="op" id="7021673">!=</span>&nbsp;<span class="num" id="7021676">1</span>&nbsp;<span class="op" id="7021678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7021682">t</span><span class="op" id="7021683">.</span><span class="ident" id="7021684">Errorf</span><span class="op" id="7021690">(</span><span class="string" id="7021691">&#34;Setting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;work.&nbsp;Got&nbsp;%d&nbsp;but&nbsp;set&nbsp;1&#34;</span><span class="op" id="7021741">,</span>&nbsp;<span class="ident" id="7021743">m</span><span class="op" id="7021744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7021747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7021750">if</span>&nbsp;<span class="ident" id="7021753">cert2</span><span class="op" id="7021758">.</span><span class="ident" id="7021759">MaxPathLenZero</span>&nbsp;<span class="op" id="7021774">{</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7021778">t</span><span class="op" id="7021779">.</span><span class="ident" id="7021780">Errorf</span><span class="op" id="7021786">(</span><span class="string" id="7021787">&#34;Setting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="7021834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7021837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7021841">template</span><span class="op" id="7021849">.</span><span class="ident" id="7021850">MaxPathLen</span>&nbsp;<span class="op" id="7021861">=</span>&nbsp;<span class="num" id="7021863">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7021866">template</span><span class="op" id="7021874">.</span><span class="ident" id="7021875">MaxPathLenZero</span>&nbsp;<span class="op" id="7021890">=</span>&nbsp;<span class="builtintype" id="7021892">true</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7021898">cert3</span>&nbsp;<span class="op" id="7021904">:=</span>&nbsp;<span class="ident" id="7021907">serialiseAndParse</span><span class="op" id="7021924">(</span><span class="ident" id="7021925">template</span><span class="op" id="7021933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7021936">if</span>&nbsp;<span class="ident" id="7021939">m</span>&nbsp;<span class="op" id="7021941">:=</span>&nbsp;<span class="ident" id="7021944">cert3</span><span class="op" id="7021949">.</span><span class="ident" id="7021950">MaxPathLen</span><span class="op" id="7021960">;</span>&nbsp;<span class="ident" id="7021962">m</span>&nbsp;<span class="op" id="7021964">!=</span>&nbsp;<span class="num" id="7021967">0</span>&nbsp;<span class="op" id="7021969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7021973">t</span><span class="op" id="7021974">.</span><span class="ident" id="7021975">Errorf</span><span class="op" id="7021981">(</span><span class="string" id="7021982">&#34;Setting&nbsp;MaxPathLenZero&nbsp;didn&#39;t&nbsp;work,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7022026">,</span>&nbsp;<span class="ident" id="7022028">m</span><span class="op" id="7022029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7022032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7022035">if</span>&nbsp;<span class="op" id="7022038">!</span><span class="ident" id="7022039">cert3</span><span class="op" id="7022044">.</span><span class="ident" id="7022045">MaxPathLenZero</span>&nbsp;<span class="op" id="7022060">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7022064">t</span><span class="op" id="7022065">.</span><span class="ident" id="7022066">Errorf</span><span class="op" id="7022072">(</span><span class="string" id="7022073">&#34;Setting&nbsp;MaxPathLen&nbsp;to&nbsp;zero&nbsp;didn&#39;t&nbsp;result&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="7022133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7022136">}</span><br>
<span class="lineno"></span><span class="op" id="7022138">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7022141">//&nbsp;This&nbsp;CSR&nbsp;was&nbsp;generated&nbsp;with&nbsp;OpenSSL:</span><br>
<span class="lineno">1020</span><span class="comment" id="7022181">//&nbsp;&nbsp;openssl&nbsp;req&nbsp;-out&nbsp;CSR.csr&nbsp;-new&nbsp;-newkey&nbsp;rsa:2048&nbsp;-nodes&nbsp;-keyout&nbsp;privateKey.key&nbsp;-config&nbsp;openssl.cnf</span><br>
<span class="lineno"></span><span class="comment" id="7022282">//</span><br>
<span class="lineno"></span><span class="comment" id="7022285">//&nbsp;The&nbsp;openssl.cnf&nbsp;needs&nbsp;to&nbsp;include&nbsp;this&nbsp;section:</span><br>
<span class="lineno"></span><span class="comment" id="7022335">//&nbsp;&nbsp;&nbsp;[&nbsp;v3_req&nbsp;]</span><br>
<span class="lineno"></span><span class="comment" id="7022351">//&nbsp;&nbsp;&nbsp;basicConstraints&nbsp;=&nbsp;CA:FALSE</span><br>
<span class="lineno">1025</span><span class="comment" id="7022384">//&nbsp;&nbsp;&nbsp;keyUsage&nbsp;=&nbsp;nonRepudiation,&nbsp;digitalSignature,&nbsp;keyEncipherment</span><br>
<span class="lineno"></span><span class="comment" id="7022450">//&nbsp;&nbsp;&nbsp;subjectAltName&nbsp;=&nbsp;email:gopher@golang.org,DNS:test.example.com</span><br>
<span class="lineno"></span><span class="keyword" id="7022517">const</span>&nbsp;<span class="ident" id="7022523">csrBase64</span>&nbsp;<span class="op" id="7022533">=</span>&nbsp;<span class="string" id="7022535">&#34;MIIC4zCCAcsCAQAwRTELMAkGA1UEBhMCQVUxEzARBgNVBAgMClNvbWUtU3RhdGUxITAfBgNVBAoMGEludGVybmV0IFdpZGdpdHMgUHR5IEx0ZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAOY+MVedRg2JEnyeLcSzcsMv2VcsTfkB5+Etd6hihAh6MrGezNyASMMKuQN6YhCX1icQDiQtGsDLTtheNnSXK06tAhHjAP/hGlszRJp+5+rP2M58fDBAkUBEhskbCUWwpY14jFtVuGNJ8vF8h8IeczdolvQhX9lVai9G0EUXJMliMKdjA899H0mRs9PzHyidyrXFNiZlQXfD8Kg7gETn2Ny965iyI6ujAIYSCvam6TnxRHYH2MBKyVGvsYGbPYUQJCsgdgyajEg6ekihvQY3SzO1HSAlZAd7d1QYO4VeWJ2mY6Wu3Jpmh+AmG19S9CcHqGjd0bhuAX9cpPOKgnEmqn0CAwEAAaBZMFcGCSqGSIb3DQEJDjFKMEgwCQYDVR0TBAIwADALBgNVHQ8EBAMCBeAwLgYDVR0RBCcwJYERZ29waGVyQGdvbGFuZy5vcmeCEHRlc3QuZXhhbXBsZS5jb20wDQYJKoZIhvcNAQEFBQADggEBAC9+QpKfdabxwCWwf4IEe1cKjdXLS1ScSuw27a3kZzQiPV78WJMa6dB8dqhdH5BRwGZ/qsgLrO6ZHlNeIv2Ib41Ccq71ecHW/nXc94A1BzJ/bVdI9LZcmTUvR1/m1jCpN7UqQ0ml1u9VihK7Pe762hEYxuWDQzYEU0l15S/bXmqeq3eF1A59XT/2jwe5+NV0Wwf4UQlkTXsAQMsJ+KzrQafd8Qv2A49o048uRvmjeJDrXLawGVianZ7D5A6Fpd1rZh6XcjqBpmgLw41DRQWENOdzhy+HyphKRv1MlY8OLkNqpGMhu8DdgJVGoT16DGiickoEa7Z3UCPVNgdTkT9jq7U=&#34;</span>
</div>
</body>
</html>
