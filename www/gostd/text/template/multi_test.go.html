<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template</h2>
<ul>
<li><a href="/gostd/text/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/text/template/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/text/template/examplefiles_test.go.html">examplefiles_test.go</a></li>
<li><a href="/gostd/text/template/examplefunc_test.go.html">examplefunc_test.go</a></li>
<li><a href="/gostd/text/template/exec.go.html">exec.go</a></li>
<li><a href="/gostd/text/template/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/text/template/funcs.go.html">funcs.go</a></li>
<li><a href="/gostd/text/template/helper.go.html">helper.go</a></li>
<li><a href="/gostd/text/template/multi_test.go.html" class="current">multi_test.go</a></li>
<li><a href="/gostd/text/template/template.go.html">template.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7594944">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7594999">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7595053">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7595104">package</span>&nbsp;<span class="ident" id="7595112">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7595122">//&nbsp;Tests&nbsp;for&nbsp;mulitple-template&nbsp;parsing&nbsp;and&nbsp;execution.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7595177">import</span>&nbsp;<span class="op" id="7595184">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7595187">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7595196">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7595203">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7595214">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7595225">&#34;text/template/parse&#34;</span><br>
<span class="lineno">15</span><span class="op" id="7595247">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7595250">const</span>&nbsp;<span class="op" id="7595256">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7595259">noError</span>&nbsp;&nbsp;<span class="op" id="7595268">=</span>&nbsp;<span class="builtintype" id="7595270">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7595276">hasError</span>&nbsp;<span class="op" id="7595285">=</span>&nbsp;<span class="builtintype" id="7595287">false</span><br>
<span class="lineno">20</span><span class="op" id="7595293">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7595296">type</span>&nbsp;<span class="ident" id="7595301">multiParseTest</span>&nbsp;<span class="keyword" id="7595316">struct</span>&nbsp;<span class="op" id="7595323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7595326">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7595334">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7595342">input</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7595350">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7595358">ok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7595366">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7595372">names</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7595380">[</span><span class="op" id="7595381">]</span><span class="builtintype" id="7595382">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7595390">results</span>&nbsp;<span class="op" id="7595398">[</span><span class="op" id="7595399">]</span><span class="builtintype" id="7595400">string</span><br>
<span class="lineno"></span><span class="op" id="7595407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="7595410">var</span>&nbsp;<span class="ident" id="7595414">multiParseTests</span>&nbsp;<span class="op" id="7595430">=</span>&nbsp;<span class="op" id="7595432">[</span><span class="op" id="7595433">]</span><span class="ident" id="7595434">multiParseTest</span><span class="op" id="7595448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7595451">{</span><span class="string" id="7595452">&#34;empty&#34;</span><span class="op" id="7595459">,</span>&nbsp;<span class="string" id="7595461">&#34;&#34;</span><span class="op" id="7595463">,</span>&nbsp;<span class="ident" id="7595465">noError</span><span class="op" id="7595472">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7595476">nil</span><span class="op" id="7595479">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7595483">nil</span><span class="op" id="7595486">}</span><span class="op" id="7595487">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7595490">{</span><span class="string" id="7595491">&#34;one&#34;</span><span class="op" id="7595496">,</span>&nbsp;<span class="string" id="7595498">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;{{end}}`</span><span class="op" id="7595528">,</span>&nbsp;<span class="ident" id="7595530">noError</span><span class="op" id="7595537">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7595541">[</span><span class="op" id="7595542">]</span><span class="builtintype" id="7595543">string</span><span class="op" id="7595549">{</span><span class="string" id="7595550">&#34;foo&#34;</span><span class="op" id="7595555">}</span><span class="op" id="7595556">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7595560">[</span><span class="op" id="7595561">]</span><span class="builtintype" id="7595562">string</span><span class="op" id="7595568">{</span><span class="string" id="7595569">&#34;&nbsp;FOO&nbsp;&#34;</span><span class="op" id="7595576">}</span><span class="op" id="7595577">}</span><span class="op" id="7595578">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7595581">{</span><span class="string" id="7595582">&#34;two&#34;</span><span class="op" id="7595587">,</span>&nbsp;<span class="string" id="7595589">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;{{end}}{{define&nbsp;&#34;bar&#34;}}&nbsp;BAR&nbsp;{{end}}`</span><span class="op" id="7595647">,</span>&nbsp;<span class="ident" id="7595649">noError</span><span class="op" id="7595656">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7595660">[</span><span class="op" id="7595661">]</span><span class="builtintype" id="7595662">string</span><span class="op" id="7595668">{</span><span class="string" id="7595669">&#34;foo&#34;</span><span class="op" id="7595674">,</span>&nbsp;<span class="string" id="7595676">&#34;bar&#34;</span><span class="op" id="7595681">}</span><span class="op" id="7595682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7595686">[</span><span class="op" id="7595687">]</span><span class="builtintype" id="7595688">string</span><span class="op" id="7595694">{</span><span class="string" id="7595695">&#34;&nbsp;FOO&nbsp;&#34;</span><span class="op" id="7595702">,</span>&nbsp;<span class="string" id="7595704">&#34;&nbsp;BAR&nbsp;&#34;</span><span class="op" id="7595711">}</span><span class="op" id="7595712">}</span><span class="op" id="7595713">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7595716">//&nbsp;errors</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7595727">{</span><span class="string" id="7595728">&#34;missing&nbsp;end&#34;</span><span class="op" id="7595741">,</span>&nbsp;<span class="string" id="7595743">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;`</span><span class="op" id="7595766">,</span>&nbsp;<span class="ident" id="7595768">hasError</span><span class="op" id="7595776">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7595780">nil</span><span class="op" id="7595783">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7595787">nil</span><span class="op" id="7595790">}</span><span class="op" id="7595791">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7595794">{</span><span class="string" id="7595795">&#34;malformed&nbsp;name&#34;</span><span class="op" id="7595811">,</span>&nbsp;<span class="string" id="7595813">`{{define&nbsp;&#34;foo}}&nbsp;FOO&nbsp;`</span><span class="op" id="7595835">,</span>&nbsp;<span class="ident" id="7595837">hasError</span><span class="op" id="7595845">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7595849">nil</span><span class="op" id="7595852">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7595856">nil</span><span class="op" id="7595859">}</span><span class="op" id="7595860">,</span><br>
<span class="lineno"></span><span class="op" id="7595862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7595865">func</span>&nbsp;<span class="ident" id="7595870">TestMultiParse</span><span class="op" id="7595884">(</span><span class="ident" id="7595885">t</span>&nbsp;<span class="op" id="7595887">*</span><span class="ident" id="7595888">testing</span><span class="op" id="7595895">.</span><span class="ident" id="7595896">T</span><span class="op" id="7595897">)</span>&nbsp;<span class="op" id="7595899">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7595902">for</span>&nbsp;<span class="ident" id="7595906">_</span><span class="op" id="7595907">,</span>&nbsp;<span class="ident" id="7595909">test</span>&nbsp;<span class="op" id="7595914">:=</span>&nbsp;<span class="keyword" id="7595917">range</span>&nbsp;<span class="ident" id="7595923">multiParseTests</span>&nbsp;<span class="op" id="7595939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7595943">template</span><span class="op" id="7595951">,</span>&nbsp;<span class="ident" id="7595953">err</span>&nbsp;<span class="op" id="7595957">:=</span>&nbsp;<span class="ident" id="7595960">New</span><span class="op" id="7595963">(</span><span class="string" id="7595964">&#34;root&#34;</span><span class="op" id="7595970">)</span><span class="op" id="7595971">.</span><span class="ident" id="7595972">Parse</span><span class="op" id="7595977">(</span><span class="ident" id="7595978">test</span><span class="op" id="7595982">.</span><span class="ident" id="7595983">input</span><span class="op" id="7595988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7595992">switch</span>&nbsp;<span class="op" id="7595999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7596003">case</span>&nbsp;<span class="ident" id="7596008">err</span>&nbsp;<span class="op" id="7596012">==</span>&nbsp;<span class="builtintype" id="7596015">nil</span>&nbsp;<span class="op" id="7596019">&amp;&amp;</span>&nbsp;<span class="op" id="7596022">!</span><span class="ident" id="7596023">test</span><span class="op" id="7596027">.</span><span class="ident" id="7596028">ok</span><span class="op" id="7596030">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7596035">t</span><span class="op" id="7596036">.</span><span class="ident" id="7596037">Errorf</span><span class="op" id="7596043">(</span><span class="string" id="7596044">&#34;%q:&nbsp;expected&nbsp;error;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7596074">,</span>&nbsp;<span class="ident" id="7596076">test</span><span class="op" id="7596080">.</span><span class="ident" id="7596081">name</span><span class="op" id="7596085">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7596090">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7596101">case</span>&nbsp;<span class="ident" id="7596106">err</span>&nbsp;<span class="op" id="7596110">!=</span>&nbsp;<span class="builtintype" id="7596113">nil</span>&nbsp;<span class="op" id="7596117">&amp;&amp;</span>&nbsp;<span class="ident" id="7596120">test</span><span class="op" id="7596124">.</span><span class="ident" id="7596125">ok</span><span class="op" id="7596127">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7596132">t</span><span class="op" id="7596133">.</span><span class="ident" id="7596134">Errorf</span><span class="op" id="7596140">(</span><span class="string" id="7596141">&#34;%q:&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7596167">,</span>&nbsp;<span class="ident" id="7596169">test</span><span class="op" id="7596173">.</span><span class="ident" id="7596174">name</span><span class="op" id="7596178">,</span>&nbsp;<span class="ident" id="7596180">err</span><span class="op" id="7596183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7596188">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7596199">case</span>&nbsp;<span class="ident" id="7596204">err</span>&nbsp;<span class="op" id="7596208">!=</span>&nbsp;<span class="builtintype" id="7596211">nil</span>&nbsp;<span class="op" id="7596215">&amp;&amp;</span>&nbsp;<span class="op" id="7596218">!</span><span class="ident" id="7596219">test</span><span class="op" id="7596223">.</span><span class="ident" id="7596224">ok</span><span class="op" id="7596226">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7596231">//&nbsp;expected&nbsp;error,&nbsp;got&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7596261">if</span>&nbsp;<span class="op" id="7596264">*</span><span class="ident" id="7596265">debug</span>&nbsp;<span class="op" id="7596271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7596277">fmt</span><span class="op" id="7596280">.</span><span class="ident" id="7596281">Printf</span><span class="op" id="7596287">(</span><span class="string" id="7596288">&#34;%s:&nbsp;%s\n\t%s\n&#34;</span><span class="op" id="7596304">,</span>&nbsp;<span class="ident" id="7596306">test</span><span class="op" id="7596310">.</span><span class="ident" id="7596311">name</span><span class="op" id="7596315">,</span>&nbsp;<span class="ident" id="7596317">test</span><span class="op" id="7596321">.</span><span class="ident" id="7596322">input</span><span class="op" id="7596327">,</span>&nbsp;<span class="ident" id="7596329">err</span><span class="op" id="7596332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7596337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7596342">continue</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7596353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7596357">if</span>&nbsp;<span class="ident" id="7596360">template</span>&nbsp;<span class="op" id="7596369">==</span>&nbsp;<span class="builtintype" id="7596372">nil</span>&nbsp;<span class="op" id="7596376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7596381">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7596392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7596396">if</span>&nbsp;<span class="builtinfunc" id="7596399">len</span><span class="op" id="7596402">(</span><span class="ident" id="7596403">template</span><span class="op" id="7596411">.</span><span class="ident" id="7596412">tmpl</span><span class="op" id="7596416">)</span>&nbsp;<span class="op" id="7596418">!=</span>&nbsp;<span class="builtinfunc" id="7596421">len</span><span class="op" id="7596424">(</span><span class="ident" id="7596425">test</span><span class="op" id="7596429">.</span><span class="ident" id="7596430">names</span><span class="op" id="7596435">)</span><span class="op" id="7596436">+</span><span class="num" id="7596437">1</span>&nbsp;<span class="op" id="7596439">{</span>&nbsp;<span class="comment" id="7596441">//&nbsp;+1&nbsp;for&nbsp;root</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7596459">t</span><span class="op" id="7596460">.</span><span class="ident" id="7596461">Errorf</span><span class="op" id="7596467">(</span><span class="string" id="7596468">&#34;%s:&nbsp;wrong&nbsp;number&nbsp;of&nbsp;templates;&nbsp;wanted&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7596517">,</span>&nbsp;<span class="ident" id="7596519">test</span><span class="op" id="7596523">.</span><span class="ident" id="7596524">name</span><span class="op" id="7596528">,</span>&nbsp;<span class="builtinfunc" id="7596530">len</span><span class="op" id="7596533">(</span><span class="ident" id="7596534">test</span><span class="op" id="7596538">.</span><span class="ident" id="7596539">names</span><span class="op" id="7596544">)</span><span class="op" id="7596545">,</span>&nbsp;<span class="builtinfunc" id="7596547">len</span><span class="op" id="7596550">(</span><span class="ident" id="7596551">template</span><span class="op" id="7596559">.</span><span class="ident" id="7596560">tmpl</span><span class="op" id="7596564">)</span><span class="op" id="7596565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7596570">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7596581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7596585">for</span>&nbsp;<span class="ident" id="7596589">i</span><span class="op" id="7596590">,</span>&nbsp;<span class="ident" id="7596592">name</span>&nbsp;<span class="op" id="7596597">:=</span>&nbsp;<span class="keyword" id="7596600">range</span>&nbsp;<span class="ident" id="7596606">test</span><span class="op" id="7596610">.</span><span class="ident" id="7596611">names</span>&nbsp;<span class="op" id="7596617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7596622">tmpl</span><span class="op" id="7596626">,</span>&nbsp;<span class="ident" id="7596628">ok</span>&nbsp;<span class="op" id="7596631">:=</span>&nbsp;<span class="ident" id="7596634">template</span><span class="op" id="7596642">.</span><span class="ident" id="7596643">tmpl</span><span class="op" id="7596647">[</span><span class="ident" id="7596648">name</span><span class="op" id="7596652">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7596657">if</span>&nbsp;<span class="op" id="7596660">!</span><span class="ident" id="7596661">ok</span>&nbsp;<span class="op" id="7596664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7596670">t</span><span class="op" id="7596671">.</span><span class="ident" id="7596672">Errorf</span><span class="op" id="7596678">(</span><span class="string" id="7596679">&#34;%s:&nbsp;can&#39;t&nbsp;find&nbsp;template&nbsp;%q&#34;</span><span class="op" id="7596707">,</span>&nbsp;<span class="ident" id="7596709">test</span><span class="op" id="7596713">.</span><span class="ident" id="7596714">name</span><span class="op" id="7596718">,</span>&nbsp;<span class="ident" id="7596720">name</span><span class="op" id="7596724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7596730">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7596742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7596747">result</span>&nbsp;<span class="op" id="7596754">:=</span>&nbsp;<span class="ident" id="7596757">tmpl</span><span class="op" id="7596761">.</span><span class="ident" id="7596762">Root</span><span class="op" id="7596766">.</span><span class="ident" id="7596767">String</span><span class="op" id="7596773">(</span><span class="op" id="7596774">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7596779">if</span>&nbsp;<span class="ident" id="7596782">result</span>&nbsp;<span class="op" id="7596789">!=</span>&nbsp;<span class="ident" id="7596792">test</span><span class="op" id="7596796">.</span><span class="ident" id="7596797">results</span><span class="op" id="7596804">[</span><span class="ident" id="7596805">i</span><span class="op" id="7596806">]</span>&nbsp;<span class="op" id="7596808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7596814">t</span><span class="op" id="7596815">.</span><span class="ident" id="7596816">Errorf</span><span class="op" id="7596822">(</span><span class="string" id="7596823">&#34;%s=(%q):&nbsp;got\n\t%v\nexpected\n\t%v&#34;</span><span class="op" id="7596859">,</span>&nbsp;<span class="ident" id="7596861">test</span><span class="op" id="7596865">.</span><span class="ident" id="7596866">name</span><span class="op" id="7596870">,</span>&nbsp;<span class="ident" id="7596872">test</span><span class="op" id="7596876">.</span><span class="ident" id="7596877">input</span><span class="op" id="7596882">,</span>&nbsp;<span class="ident" id="7596884">result</span><span class="op" id="7596890">,</span>&nbsp;<span class="ident" id="7596892">test</span><span class="op" id="7596896">.</span><span class="ident" id="7596897">results</span><span class="op" id="7596904">[</span><span class="ident" id="7596905">i</span><span class="op" id="7596906">]</span><span class="op" id="7596907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7596912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7596916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7596919">}</span><br>
<span class="lineno">85</span><span class="op" id="7596921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7596924">var</span>&nbsp;<span class="ident" id="7596928">multiExecTests</span>&nbsp;<span class="op" id="7596943">=</span>&nbsp;<span class="op" id="7596945">[</span><span class="op" id="7596946">]</span><span class="ident" id="7596947">execTest</span><span class="op" id="7596955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7596958">{</span><span class="string" id="7596959">&#34;empty&#34;</span><span class="op" id="7596966">,</span>&nbsp;<span class="string" id="7596968">&#34;&#34;</span><span class="op" id="7596970">,</span>&nbsp;<span class="string" id="7596972">&#34;&#34;</span><span class="op" id="7596974">,</span>&nbsp;<span class="builtintype" id="7596976">nil</span><span class="op" id="7596979">,</span>&nbsp;<span class="builtintype" id="7596981">true</span><span class="op" id="7596985">}</span><span class="op" id="7596986">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7596989">{</span><span class="string" id="7596990">&#34;text&#34;</span><span class="op" id="7596996">,</span>&nbsp;<span class="string" id="7596998">&#34;some&nbsp;text&#34;</span><span class="op" id="7597009">,</span>&nbsp;<span class="string" id="7597011">&#34;some&nbsp;text&#34;</span><span class="op" id="7597022">,</span>&nbsp;<span class="builtintype" id="7597024">nil</span><span class="op" id="7597027">,</span>&nbsp;<span class="builtintype" id="7597029">true</span><span class="op" id="7597033">}</span><span class="op" id="7597034">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7597037">{</span><span class="string" id="7597038">&#34;invoke&nbsp;x&#34;</span><span class="op" id="7597048">,</span>&nbsp;<span class="string" id="7597050">`{{template&nbsp;&#34;x&#34;&nbsp;.SI}}`</span><span class="op" id="7597072">,</span>&nbsp;<span class="string" id="7597074">&#34;TEXT&#34;</span><span class="op" id="7597080">,</span>&nbsp;<span class="ident" id="7597082">tVal</span><span class="op" id="7597086">,</span>&nbsp;<span class="builtintype" id="7597088">true</span><span class="op" id="7597092">}</span><span class="op" id="7597093">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7597096">{</span><span class="string" id="7597097">&#34;invoke&nbsp;x&nbsp;no&nbsp;args&#34;</span><span class="op" id="7597115">,</span>&nbsp;<span class="string" id="7597117">`{{template&nbsp;&#34;x&#34;}}`</span><span class="op" id="7597135">,</span>&nbsp;<span class="string" id="7597137">&#34;TEXT&#34;</span><span class="op" id="7597143">,</span>&nbsp;<span class="ident" id="7597145">tVal</span><span class="op" id="7597149">,</span>&nbsp;<span class="builtintype" id="7597151">true</span><span class="op" id="7597155">}</span><span class="op" id="7597156">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7597159">{</span><span class="string" id="7597160">&#34;invoke&nbsp;dot&nbsp;int&#34;</span><span class="op" id="7597176">,</span>&nbsp;<span class="string" id="7597178">`{{template&nbsp;&#34;dot&#34;&nbsp;.I}}`</span><span class="op" id="7597201">,</span>&nbsp;<span class="string" id="7597203">&#34;17&#34;</span><span class="op" id="7597207">,</span>&nbsp;<span class="ident" id="7597209">tVal</span><span class="op" id="7597213">,</span>&nbsp;<span class="builtintype" id="7597215">true</span><span class="op" id="7597219">}</span><span class="op" id="7597220">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7597223">{</span><span class="string" id="7597224">&#34;invoke&nbsp;dot&nbsp;[]int&#34;</span><span class="op" id="7597242">,</span>&nbsp;<span class="string" id="7597244">`{{template&nbsp;&#34;dot&#34;&nbsp;.SI}}`</span><span class="op" id="7597268">,</span>&nbsp;<span class="string" id="7597270">&#34;[3&nbsp;4&nbsp;5]&#34;</span><span class="op" id="7597279">,</span>&nbsp;<span class="ident" id="7597281">tVal</span><span class="op" id="7597285">,</span>&nbsp;<span class="builtintype" id="7597287">true</span><span class="op" id="7597291">}</span><span class="op" id="7597292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7597295">{</span><span class="string" id="7597296">&#34;invoke&nbsp;dotV&#34;</span><span class="op" id="7597309">,</span>&nbsp;<span class="string" id="7597311">`{{template&nbsp;&#34;dotV&#34;&nbsp;.U}}`</span><span class="op" id="7597335">,</span>&nbsp;<span class="string" id="7597337">&#34;v&#34;</span><span class="op" id="7597340">,</span>&nbsp;<span class="ident" id="7597342">tVal</span><span class="op" id="7597346">,</span>&nbsp;<span class="builtintype" id="7597348">true</span><span class="op" id="7597352">}</span><span class="op" id="7597353">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7597356">{</span><span class="string" id="7597357">&#34;invoke&nbsp;nested&nbsp;int&#34;</span><span class="op" id="7597376">,</span>&nbsp;<span class="string" id="7597378">`{{template&nbsp;&#34;nested&#34;&nbsp;.I}}`</span><span class="op" id="7597404">,</span>&nbsp;<span class="string" id="7597406">&#34;17&#34;</span><span class="op" id="7597410">,</span>&nbsp;<span class="ident" id="7597412">tVal</span><span class="op" id="7597416">,</span>&nbsp;<span class="builtintype" id="7597418">true</span><span class="op" id="7597422">}</span><span class="op" id="7597423">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7597426">{</span><span class="string" id="7597427">&#34;variable&nbsp;declared&nbsp;by&nbsp;template&#34;</span><span class="op" id="7597458">,</span>&nbsp;<span class="string" id="7597460">`{{template&nbsp;&#34;nested&#34;&nbsp;$x:=.SI}},{{index&nbsp;$x&nbsp;1}}`</span><span class="op" id="7597506">,</span>&nbsp;<span class="string" id="7597508">&#34;[3&nbsp;4&nbsp;5],4&#34;</span><span class="op" id="7597519">,</span>&nbsp;<span class="ident" id="7597521">tVal</span><span class="op" id="7597525">,</span>&nbsp;<span class="builtintype" id="7597527">true</span><span class="op" id="7597531">}</span><span class="op" id="7597532">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7597536">//&nbsp;User-defined&nbsp;function:&nbsp;test&nbsp;argument&nbsp;evaluator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7597588">{</span><span class="string" id="7597589">&#34;testFunc&nbsp;literal&#34;</span><span class="op" id="7597607">,</span>&nbsp;<span class="string" id="7597609">`{{oneArg&nbsp;&#34;joe&#34;}}`</span><span class="op" id="7597627">,</span>&nbsp;<span class="string" id="7597629">&#34;oneArg=joe&#34;</span><span class="op" id="7597641">,</span>&nbsp;<span class="ident" id="7597643">tVal</span><span class="op" id="7597647">,</span>&nbsp;<span class="builtintype" id="7597649">true</span><span class="op" id="7597653">}</span><span class="op" id="7597654">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7597657">{</span><span class="string" id="7597658">&#34;testFunc&nbsp;.&#34;</span><span class="op" id="7597670">,</span>&nbsp;<span class="string" id="7597672">`{{oneArg&nbsp;.}}`</span><span class="op" id="7597686">,</span>&nbsp;<span class="string" id="7597688">&#34;oneArg=joe&#34;</span><span class="op" id="7597700">,</span>&nbsp;<span class="string" id="7597702">&#34;joe&#34;</span><span class="op" id="7597707">,</span>&nbsp;<span class="builtintype" id="7597709">true</span><span class="op" id="7597713">}</span><span class="op" id="7597714">,</span><br>
<span class="lineno"></span><span class="op" id="7597716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7597719">//&nbsp;These&nbsp;strings&nbsp;are&nbsp;also&nbsp;in&nbsp;testdata/*.</span><br>
<span class="lineno"></span><span class="keyword" id="7597760">const</span>&nbsp;<span class="ident" id="7597766">multiText1</span>&nbsp;<span class="op" id="7597777">=</span>&nbsp;<span class="string" id="7597779">`<br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;{{define&nbsp;&#34;x&#34;}}TEXT{{end}}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;{{define&nbsp;&#34;dotV&#34;}}{{.V}}{{end}}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7597843">const</span>&nbsp;<span class="ident" id="7597849">multiText2</span>&nbsp;<span class="op" id="7597860">=</span>&nbsp;<span class="string" id="7597862">`<br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;{{define&nbsp;&#34;dot&#34;}}{{.}}{{end}}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;{{define&nbsp;&#34;nested&#34;}}{{template&nbsp;&#34;dot&#34;&nbsp;.}}{{end}}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7597945">func</span>&nbsp;<span class="ident" id="7597950">TestMultiExecute</span><span class="op" id="7597966">(</span><span class="ident" id="7597967">t</span>&nbsp;<span class="op" id="7597969">*</span><span class="ident" id="7597970">testing</span><span class="op" id="7597977">.</span><span class="ident" id="7597978">T</span><span class="op" id="7597979">)</span>&nbsp;<span class="op" id="7597981">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7597984">//&nbsp;Declare&nbsp;a&nbsp;couple&nbsp;of&nbsp;templates&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7598025">template</span><span class="op" id="7598033">,</span>&nbsp;<span class="ident" id="7598035">err</span>&nbsp;<span class="op" id="7598039">:=</span>&nbsp;<span class="ident" id="7598042">New</span><span class="op" id="7598045">(</span><span class="string" id="7598046">&#34;root&#34;</span><span class="op" id="7598052">)</span><span class="op" id="7598053">.</span><span class="ident" id="7598054">Parse</span><span class="op" id="7598059">(</span><span class="ident" id="7598060">multiText1</span><span class="op" id="7598070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7598073">if</span>&nbsp;<span class="ident" id="7598076">err</span>&nbsp;<span class="op" id="7598080">!=</span>&nbsp;<span class="builtintype" id="7598083">nil</span>&nbsp;<span class="op" id="7598087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7598091">t</span><span class="op" id="7598092">.</span><span class="ident" id="7598093">Fatalf</span><span class="op" id="7598099">(</span><span class="string" id="7598100">&#34;parse&nbsp;error&nbsp;for&nbsp;1:&nbsp;%s&#34;</span><span class="op" id="7598123">,</span>&nbsp;<span class="ident" id="7598125">err</span><span class="op" id="7598128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7598131">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7598134">_</span><span class="op" id="7598135">,</span>&nbsp;<span class="ident" id="7598137">err</span>&nbsp;<span class="op" id="7598141">=</span>&nbsp;<span class="ident" id="7598143">template</span><span class="op" id="7598151">.</span><span class="ident" id="7598152">Parse</span><span class="op" id="7598157">(</span><span class="ident" id="7598158">multiText2</span><span class="op" id="7598168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7598171">if</span>&nbsp;<span class="ident" id="7598174">err</span>&nbsp;<span class="op" id="7598178">!=</span>&nbsp;<span class="builtintype" id="7598181">nil</span>&nbsp;<span class="op" id="7598185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7598189">t</span><span class="op" id="7598190">.</span><span class="ident" id="7598191">Fatalf</span><span class="op" id="7598197">(</span><span class="string" id="7598198">&#34;parse&nbsp;error&nbsp;for&nbsp;2:&nbsp;%s&#34;</span><span class="op" id="7598221">,</span>&nbsp;<span class="ident" id="7598223">err</span><span class="op" id="7598226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7598229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7598232">testExecute</span><span class="op" id="7598243">(</span><span class="ident" id="7598244">multiExecTests</span><span class="op" id="7598258">,</span>&nbsp;<span class="ident" id="7598260">template</span><span class="op" id="7598268">,</span>&nbsp;<span class="ident" id="7598270">t</span><span class="op" id="7598271">)</span><br>
<span class="lineno">125</span><span class="op" id="7598273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7598276">func</span>&nbsp;<span class="ident" id="7598281">TestParseFiles</span><span class="op" id="7598295">(</span><span class="ident" id="7598296">t</span>&nbsp;<span class="op" id="7598298">*</span><span class="ident" id="7598299">testing</span><span class="op" id="7598306">.</span><span class="ident" id="7598307">T</span><span class="op" id="7598308">)</span>&nbsp;<span class="op" id="7598310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7598313">_</span><span class="op" id="7598314">,</span>&nbsp;<span class="ident" id="7598316">err</span>&nbsp;<span class="op" id="7598320">:=</span>&nbsp;<span class="ident" id="7598323">ParseFiles</span><span class="op" id="7598333">(</span><span class="string" id="7598334">&#34;DOES&nbsp;NOT&nbsp;EXIST&#34;</span><span class="op" id="7598350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7598353">if</span>&nbsp;<span class="ident" id="7598356">err</span>&nbsp;<span class="op" id="7598360">==</span>&nbsp;<span class="builtintype" id="7598363">nil</span>&nbsp;<span class="op" id="7598367">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7598371">t</span><span class="op" id="7598372">.</span><span class="ident" id="7598373">Error</span><span class="op" id="7598378">(</span><span class="string" id="7598379">&#34;expected&nbsp;error&nbsp;for&nbsp;non-existent&nbsp;file;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7598427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7598430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7598433">template</span>&nbsp;<span class="op" id="7598442">:=</span>&nbsp;<span class="ident" id="7598445">New</span><span class="op" id="7598448">(</span><span class="string" id="7598449">&#34;root&#34;</span><span class="op" id="7598455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7598458">_</span><span class="op" id="7598459">,</span>&nbsp;<span class="ident" id="7598461">err</span>&nbsp;<span class="op" id="7598465">=</span>&nbsp;<span class="ident" id="7598467">template</span><span class="op" id="7598475">.</span><span class="ident" id="7598476">ParseFiles</span><span class="op" id="7598486">(</span><span class="string" id="7598487">&#34;testdata/file1.tmpl&#34;</span><span class="op" id="7598508">,</span>&nbsp;<span class="string" id="7598510">&#34;testdata/file2.tmpl&#34;</span><span class="op" id="7598531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7598534">if</span>&nbsp;<span class="ident" id="7598537">err</span>&nbsp;<span class="op" id="7598541">!=</span>&nbsp;<span class="builtintype" id="7598544">nil</span>&nbsp;<span class="op" id="7598548">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7598552">t</span><span class="op" id="7598553">.</span><span class="ident" id="7598554">Fatalf</span><span class="op" id="7598560">(</span><span class="string" id="7598561">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="7598586">,</span>&nbsp;<span class="ident" id="7598588">err</span><span class="op" id="7598591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7598594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7598597">testExecute</span><span class="op" id="7598608">(</span><span class="ident" id="7598609">multiExecTests</span><span class="op" id="7598623">,</span>&nbsp;<span class="ident" id="7598625">template</span><span class="op" id="7598633">,</span>&nbsp;<span class="ident" id="7598635">t</span><span class="op" id="7598636">)</span><br>
<span class="lineno"></span><span class="op" id="7598638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="keyword" id="7598641">func</span>&nbsp;<span class="ident" id="7598646">TestParseGlob</span><span class="op" id="7598659">(</span><span class="ident" id="7598660">t</span>&nbsp;<span class="op" id="7598662">*</span><span class="ident" id="7598663">testing</span><span class="op" id="7598670">.</span><span class="ident" id="7598671">T</span><span class="op" id="7598672">)</span>&nbsp;<span class="op" id="7598674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7598677">_</span><span class="op" id="7598678">,</span>&nbsp;<span class="ident" id="7598680">err</span>&nbsp;<span class="op" id="7598684">:=</span>&nbsp;<span class="ident" id="7598687">ParseGlob</span><span class="op" id="7598696">(</span><span class="string" id="7598697">&#34;DOES&nbsp;NOT&nbsp;EXIST&#34;</span><span class="op" id="7598713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7598716">if</span>&nbsp;<span class="ident" id="7598719">err</span>&nbsp;<span class="op" id="7598723">==</span>&nbsp;<span class="builtintype" id="7598726">nil</span>&nbsp;<span class="op" id="7598730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7598734">t</span><span class="op" id="7598735">.</span><span class="ident" id="7598736">Error</span><span class="op" id="7598741">(</span><span class="string" id="7598742">&#34;expected&nbsp;error&nbsp;for&nbsp;non-existent&nbsp;file;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7598790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7598793">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7598796">_</span><span class="op" id="7598797">,</span>&nbsp;<span class="ident" id="7598799">err</span>&nbsp;<span class="op" id="7598803">=</span>&nbsp;<span class="ident" id="7598805">New</span><span class="op" id="7598808">(</span><span class="string" id="7598809">&#34;error&#34;</span><span class="op" id="7598816">)</span><span class="op" id="7598817">.</span><span class="ident" id="7598818">ParseGlob</span><span class="op" id="7598827">(</span><span class="string" id="7598828">&#34;[x&#34;</span><span class="op" id="7598832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7598835">if</span>&nbsp;<span class="ident" id="7598838">err</span>&nbsp;<span class="op" id="7598842">==</span>&nbsp;<span class="builtintype" id="7598845">nil</span>&nbsp;<span class="op" id="7598849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7598853">t</span><span class="op" id="7598854">.</span><span class="ident" id="7598855">Error</span><span class="op" id="7598860">(</span><span class="string" id="7598861">&#34;expected&nbsp;error&nbsp;for&nbsp;bad&nbsp;pattern;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7598903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7598906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7598909">template</span>&nbsp;<span class="op" id="7598918">:=</span>&nbsp;<span class="ident" id="7598921">New</span><span class="op" id="7598924">(</span><span class="string" id="7598925">&#34;root&#34;</span><span class="op" id="7598931">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7598934">_</span><span class="op" id="7598935">,</span>&nbsp;<span class="ident" id="7598937">err</span>&nbsp;<span class="op" id="7598941">=</span>&nbsp;<span class="ident" id="7598943">template</span><span class="op" id="7598951">.</span><span class="ident" id="7598952">ParseGlob</span><span class="op" id="7598961">(</span><span class="string" id="7598962">&#34;testdata/file*.tmpl&#34;</span><span class="op" id="7598983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7598986">if</span>&nbsp;<span class="ident" id="7598989">err</span>&nbsp;<span class="op" id="7598993">!=</span>&nbsp;<span class="builtintype" id="7598996">nil</span>&nbsp;<span class="op" id="7599000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7599004">t</span><span class="op" id="7599005">.</span><span class="ident" id="7599006">Fatalf</span><span class="op" id="7599012">(</span><span class="string" id="7599013">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="7599038">,</span>&nbsp;<span class="ident" id="7599040">err</span><span class="op" id="7599043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7599046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7599049">testExecute</span><span class="op" id="7599060">(</span><span class="ident" id="7599061">multiExecTests</span><span class="op" id="7599075">,</span>&nbsp;<span class="ident" id="7599077">template</span><span class="op" id="7599085">,</span>&nbsp;<span class="ident" id="7599087">t</span><span class="op" id="7599088">)</span><br>
<span class="lineno">155</span><span class="op" id="7599090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7599093">//&nbsp;In&nbsp;these&nbsp;tests,&nbsp;actual&nbsp;content&nbsp;(not&nbsp;just&nbsp;template&nbsp;definitions)&nbsp;comes&nbsp;from&nbsp;the&nbsp;parsed&nbsp;files.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7599189">var</span>&nbsp;<span class="ident" id="7599193">templateFileExecTests</span>&nbsp;<span class="op" id="7599215">=</span>&nbsp;<span class="op" id="7599217">[</span><span class="op" id="7599218">]</span><span class="ident" id="7599219">execTest</span><span class="op" id="7599227">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7599230">{</span><span class="string" id="7599231">&#34;test&#34;</span><span class="op" id="7599237">,</span>&nbsp;<span class="string" id="7599239">`{{template&nbsp;&#34;tmpl1.tmpl&#34;}}{{template&nbsp;&#34;tmpl2.tmpl&#34;}}`</span><span class="op" id="7599291">,</span>&nbsp;<span class="string" id="7599293">&#34;template1\n\ny\ntemplate2\n\nx\n&#34;</span><span class="op" id="7599327">,</span>&nbsp;<span class="num" id="7599329">0</span><span class="op" id="7599330">,</span>&nbsp;<span class="builtintype" id="7599332">true</span><span class="op" id="7599336">}</span><span class="op" id="7599337">,</span><br>
<span class="lineno"></span><span class="op" id="7599339">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7599342">func</span>&nbsp;<span class="ident" id="7599347">TestParseFilesWithData</span><span class="op" id="7599369">(</span><span class="ident" id="7599370">t</span>&nbsp;<span class="op" id="7599372">*</span><span class="ident" id="7599373">testing</span><span class="op" id="7599380">.</span><span class="ident" id="7599381">T</span><span class="op" id="7599382">)</span>&nbsp;<span class="op" id="7599384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7599387">template</span><span class="op" id="7599395">,</span>&nbsp;<span class="ident" id="7599397">err</span>&nbsp;<span class="op" id="7599401">:=</span>&nbsp;<span class="ident" id="7599404">New</span><span class="op" id="7599407">(</span><span class="string" id="7599408">&#34;root&#34;</span><span class="op" id="7599414">)</span><span class="op" id="7599415">.</span><span class="ident" id="7599416">ParseFiles</span><span class="op" id="7599426">(</span><span class="string" id="7599427">&#34;testdata/tmpl1.tmpl&#34;</span><span class="op" id="7599448">,</span>&nbsp;<span class="string" id="7599450">&#34;testdata/tmpl2.tmpl&#34;</span><span class="op" id="7599471">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7599474">if</span>&nbsp;<span class="ident" id="7599477">err</span>&nbsp;<span class="op" id="7599481">!=</span>&nbsp;<span class="builtintype" id="7599484">nil</span>&nbsp;<span class="op" id="7599488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7599492">t</span><span class="op" id="7599493">.</span><span class="ident" id="7599494">Fatalf</span><span class="op" id="7599500">(</span><span class="string" id="7599501">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="7599526">,</span>&nbsp;<span class="ident" id="7599528">err</span><span class="op" id="7599531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7599534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7599537">testExecute</span><span class="op" id="7599548">(</span><span class="ident" id="7599549">templateFileExecTests</span><span class="op" id="7599570">,</span>&nbsp;<span class="ident" id="7599572">template</span><span class="op" id="7599580">,</span>&nbsp;<span class="ident" id="7599582">t</span><span class="op" id="7599583">)</span><br>
<span class="lineno"></span><span class="op" id="7599585">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="7599588">func</span>&nbsp;<span class="ident" id="7599593">TestParseGlobWithData</span><span class="op" id="7599614">(</span><span class="ident" id="7599615">t</span>&nbsp;<span class="op" id="7599617">*</span><span class="ident" id="7599618">testing</span><span class="op" id="7599625">.</span><span class="ident" id="7599626">T</span><span class="op" id="7599627">)</span>&nbsp;<span class="op" id="7599629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7599632">template</span><span class="op" id="7599640">,</span>&nbsp;<span class="ident" id="7599642">err</span>&nbsp;<span class="op" id="7599646">:=</span>&nbsp;<span class="ident" id="7599649">New</span><span class="op" id="7599652">(</span><span class="string" id="7599653">&#34;root&#34;</span><span class="op" id="7599659">)</span><span class="op" id="7599660">.</span><span class="ident" id="7599661">ParseGlob</span><span class="op" id="7599670">(</span><span class="string" id="7599671">&#34;testdata/tmpl*.tmpl&#34;</span><span class="op" id="7599692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7599695">if</span>&nbsp;<span class="ident" id="7599698">err</span>&nbsp;<span class="op" id="7599702">!=</span>&nbsp;<span class="builtintype" id="7599705">nil</span>&nbsp;<span class="op" id="7599709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7599713">t</span><span class="op" id="7599714">.</span><span class="ident" id="7599715">Fatalf</span><span class="op" id="7599721">(</span><span class="string" id="7599722">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="7599747">,</span>&nbsp;<span class="ident" id="7599749">err</span><span class="op" id="7599752">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7599755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7599758">testExecute</span><span class="op" id="7599769">(</span><span class="ident" id="7599770">templateFileExecTests</span><span class="op" id="7599791">,</span>&nbsp;<span class="ident" id="7599793">template</span><span class="op" id="7599801">,</span>&nbsp;<span class="ident" id="7599803">t</span><span class="op" id="7599804">)</span><br>
<span class="lineno"></span><span class="op" id="7599806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7599809">const</span>&nbsp;<span class="op" id="7599815">(</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7599818">cloneText1</span>&nbsp;<span class="op" id="7599829">=</span>&nbsp;<span class="string" id="7599831">`{{define&nbsp;&#34;a&#34;}}{{template&nbsp;&#34;b&#34;}}{{template&nbsp;&#34;c&#34;}}{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7599888">cloneText2</span>&nbsp;<span class="op" id="7599899">=</span>&nbsp;<span class="string" id="7599901">`{{define&nbsp;&#34;b&#34;}}b{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7599927">cloneText3</span>&nbsp;<span class="op" id="7599938">=</span>&nbsp;<span class="string" id="7599940">`{{define&nbsp;&#34;c&#34;}}root{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7599969">cloneText4</span>&nbsp;<span class="op" id="7599980">=</span>&nbsp;<span class="string" id="7599982">`{{define&nbsp;&#34;c&#34;}}clone{{end}}`</span><br>
<span class="lineno"></span><span class="op" id="7600011">)</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="7600014">func</span>&nbsp;<span class="ident" id="7600019">TestClone</span><span class="op" id="7600028">(</span><span class="ident" id="7600029">t</span>&nbsp;<span class="op" id="7600031">*</span><span class="ident" id="7600032">testing</span><span class="op" id="7600039">.</span><span class="ident" id="7600040">T</span><span class="op" id="7600041">)</span>&nbsp;<span class="op" id="7600043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7600046">//&nbsp;Create&nbsp;some&nbsp;templates&nbsp;and&nbsp;clone&nbsp;the&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7600092">root</span><span class="op" id="7600096">,</span>&nbsp;<span class="ident" id="7600098">err</span>&nbsp;<span class="op" id="7600102">:=</span>&nbsp;<span class="ident" id="7600105">New</span><span class="op" id="7600108">(</span><span class="string" id="7600109">&#34;root&#34;</span><span class="op" id="7600115">)</span><span class="op" id="7600116">.</span><span class="ident" id="7600117">Parse</span><span class="op" id="7600122">(</span><span class="ident" id="7600123">cloneText1</span><span class="op" id="7600133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7600136">if</span>&nbsp;<span class="ident" id="7600139">err</span>&nbsp;<span class="op" id="7600143">!=</span>&nbsp;<span class="builtintype" id="7600146">nil</span>&nbsp;<span class="op" id="7600150">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7600154">t</span><span class="op" id="7600155">.</span><span class="ident" id="7600156">Fatal</span><span class="op" id="7600161">(</span><span class="ident" id="7600162">err</span><span class="op" id="7600165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7600168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7600171">_</span><span class="op" id="7600172">,</span>&nbsp;<span class="ident" id="7600174">err</span>&nbsp;<span class="op" id="7600178">=</span>&nbsp;<span class="ident" id="7600180">root</span><span class="op" id="7600184">.</span><span class="ident" id="7600185">Parse</span><span class="op" id="7600190">(</span><span class="ident" id="7600191">cloneText2</span><span class="op" id="7600201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7600204">if</span>&nbsp;<span class="ident" id="7600207">err</span>&nbsp;<span class="op" id="7600211">!=</span>&nbsp;<span class="builtintype" id="7600214">nil</span>&nbsp;<span class="op" id="7600218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7600222">t</span><span class="op" id="7600223">.</span><span class="ident" id="7600224">Fatal</span><span class="op" id="7600229">(</span><span class="ident" id="7600230">err</span><span class="op" id="7600233">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7600236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7600239">clone</span>&nbsp;<span class="op" id="7600245">:=</span>&nbsp;<span class="ident" id="7600248">Must</span><span class="op" id="7600252">(</span><span class="ident" id="7600253">root</span><span class="op" id="7600257">.</span><span class="ident" id="7600258">Clone</span><span class="op" id="7600263">(</span><span class="op" id="7600264">)</span><span class="op" id="7600265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7600268">//&nbsp;Add&nbsp;variants&nbsp;to&nbsp;both.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7600294">_</span><span class="op" id="7600295">,</span>&nbsp;<span class="ident" id="7600297">err</span>&nbsp;<span class="op" id="7600301">=</span>&nbsp;<span class="ident" id="7600303">root</span><span class="op" id="7600307">.</span><span class="ident" id="7600308">Parse</span><span class="op" id="7600313">(</span><span class="ident" id="7600314">cloneText3</span><span class="op" id="7600324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7600327">if</span>&nbsp;<span class="ident" id="7600330">err</span>&nbsp;<span class="op" id="7600334">!=</span>&nbsp;<span class="builtintype" id="7600337">nil</span>&nbsp;<span class="op" id="7600341">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7600345">t</span><span class="op" id="7600346">.</span><span class="ident" id="7600347">Fatal</span><span class="op" id="7600352">(</span><span class="ident" id="7600353">err</span><span class="op" id="7600356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7600359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7600362">_</span><span class="op" id="7600363">,</span>&nbsp;<span class="ident" id="7600365">err</span>&nbsp;<span class="op" id="7600369">=</span>&nbsp;<span class="ident" id="7600371">clone</span><span class="op" id="7600376">.</span><span class="ident" id="7600377">Parse</span><span class="op" id="7600382">(</span><span class="ident" id="7600383">cloneText4</span><span class="op" id="7600393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7600396">if</span>&nbsp;<span class="ident" id="7600399">err</span>&nbsp;<span class="op" id="7600403">!=</span>&nbsp;<span class="builtintype" id="7600406">nil</span>&nbsp;<span class="op" id="7600410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7600414">t</span><span class="op" id="7600415">.</span><span class="ident" id="7600416">Fatal</span><span class="op" id="7600421">(</span><span class="ident" id="7600422">err</span><span class="op" id="7600425">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7600428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7600431">//&nbsp;Verify&nbsp;that&nbsp;the&nbsp;clone&nbsp;is&nbsp;self-consistent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7600477">for</span>&nbsp;<span class="ident" id="7600481">k</span><span class="op" id="7600482">,</span>&nbsp;<span class="ident" id="7600484">v</span>&nbsp;<span class="op" id="7600486">:=</span>&nbsp;<span class="keyword" id="7600489">range</span>&nbsp;<span class="ident" id="7600495">clone</span><span class="op" id="7600500">.</span><span class="ident" id="7600501">tmpl</span>&nbsp;<span class="op" id="7600506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7600510">if</span>&nbsp;<span class="ident" id="7600513">k</span>&nbsp;<span class="op" id="7600515">==</span>&nbsp;<span class="ident" id="7600518">clone</span><span class="op" id="7600523">.</span><span class="ident" id="7600524">name</span>&nbsp;<span class="op" id="7600529">&amp;&amp;</span>&nbsp;<span class="ident" id="7600532">v</span><span class="op" id="7600533">.</span><span class="ident" id="7600534">tmpl</span><span class="op" id="7600538">[</span><span class="ident" id="7600539">k</span><span class="op" id="7600540">]</span>&nbsp;<span class="op" id="7600542">!=</span>&nbsp;<span class="ident" id="7600545">clone</span>&nbsp;<span class="op" id="7600551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7600556">t</span><span class="op" id="7600557">.</span><span class="ident" id="7600558">Error</span><span class="op" id="7600563">(</span><span class="string" id="7600564">&#34;clone&nbsp;does&nbsp;not&nbsp;contain&nbsp;root&#34;</span><span class="op" id="7600593">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7600597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7600601">if</span>&nbsp;<span class="ident" id="7600604">v</span>&nbsp;<span class="op" id="7600606">!=</span>&nbsp;<span class="ident" id="7600609">v</span><span class="op" id="7600610">.</span><span class="ident" id="7600611">tmpl</span><span class="op" id="7600615">[</span><span class="ident" id="7600616">v</span><span class="op" id="7600617">.</span><span class="ident" id="7600618">name</span><span class="op" id="7600622">]</span>&nbsp;<span class="op" id="7600624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7600629">t</span><span class="op" id="7600630">.</span><span class="ident" id="7600631">Errorf</span><span class="op" id="7600637">(</span><span class="string" id="7600638">&#34;clone&nbsp;does&nbsp;not&nbsp;contain&nbsp;self&nbsp;for&nbsp;%q&#34;</span><span class="op" id="7600674">,</span>&nbsp;<span class="ident" id="7600676">k</span><span class="op" id="7600677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7600681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7600684">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7600687">//&nbsp;Execute&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7600705">var</span>&nbsp;<span class="ident" id="7600709">b</span>&nbsp;<span class="ident" id="7600711">bytes</span><span class="op" id="7600716">.</span><span class="ident" id="7600717">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7600725">err</span>&nbsp;<span class="op" id="7600729">=</span>&nbsp;<span class="ident" id="7600731">root</span><span class="op" id="7600735">.</span><span class="ident" id="7600736">ExecuteTemplate</span><span class="op" id="7600751">(</span><span class="op" id="7600752">&amp;</span><span class="ident" id="7600753">b</span><span class="op" id="7600754">,</span>&nbsp;<span class="string" id="7600756">&#34;a&#34;</span><span class="op" id="7600759">,</span>&nbsp;<span class="num" id="7600761">0</span><span class="op" id="7600762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7600765">if</span>&nbsp;<span class="ident" id="7600768">err</span>&nbsp;<span class="op" id="7600772">!=</span>&nbsp;<span class="builtintype" id="7600775">nil</span>&nbsp;<span class="op" id="7600779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7600783">t</span><span class="op" id="7600784">.</span><span class="ident" id="7600785">Fatal</span><span class="op" id="7600790">(</span><span class="ident" id="7600791">err</span><span class="op" id="7600794">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7600797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7600800">if</span>&nbsp;<span class="ident" id="7600803">b</span><span class="op" id="7600804">.</span><span class="ident" id="7600805">String</span><span class="op" id="7600811">(</span><span class="op" id="7600812">)</span>&nbsp;<span class="op" id="7600814">!=</span>&nbsp;<span class="string" id="7600817">&#34;broot&#34;</span>&nbsp;<span class="op" id="7600825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7600829">t</span><span class="op" id="7600830">.</span><span class="ident" id="7600831">Errorf</span><span class="op" id="7600837">(</span><span class="string" id="7600838">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7600858">,</span>&nbsp;<span class="string" id="7600860">&#34;broot&#34;</span><span class="op" id="7600867">,</span>&nbsp;<span class="ident" id="7600869">b</span><span class="op" id="7600870">.</span><span class="ident" id="7600871">String</span><span class="op" id="7600877">(</span><span class="op" id="7600878">)</span><span class="op" id="7600879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7600882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7600885">//&nbsp;Execute&nbsp;copy.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7600903">b</span><span class="op" id="7600904">.</span><span class="ident" id="7600905">Reset</span><span class="op" id="7600910">(</span><span class="op" id="7600911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7600914">err</span>&nbsp;<span class="op" id="7600918">=</span>&nbsp;<span class="ident" id="7600920">clone</span><span class="op" id="7600925">.</span><span class="ident" id="7600926">ExecuteTemplate</span><span class="op" id="7600941">(</span><span class="op" id="7600942">&amp;</span><span class="ident" id="7600943">b</span><span class="op" id="7600944">,</span>&nbsp;<span class="string" id="7600946">&#34;a&#34;</span><span class="op" id="7600949">,</span>&nbsp;<span class="num" id="7600951">0</span><span class="op" id="7600952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7600955">if</span>&nbsp;<span class="ident" id="7600958">err</span>&nbsp;<span class="op" id="7600962">!=</span>&nbsp;<span class="builtintype" id="7600965">nil</span>&nbsp;<span class="op" id="7600969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7600973">t</span><span class="op" id="7600974">.</span><span class="ident" id="7600975">Fatal</span><span class="op" id="7600980">(</span><span class="ident" id="7600981">err</span><span class="op" id="7600984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7600987">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7600990">if</span>&nbsp;<span class="ident" id="7600993">b</span><span class="op" id="7600994">.</span><span class="ident" id="7600995">String</span><span class="op" id="7601001">(</span><span class="op" id="7601002">)</span>&nbsp;<span class="op" id="7601004">!=</span>&nbsp;<span class="string" id="7601007">&#34;bclone&#34;</span>&nbsp;<span class="op" id="7601016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7601020">t</span><span class="op" id="7601021">.</span><span class="ident" id="7601022">Errorf</span><span class="op" id="7601028">(</span><span class="string" id="7601029">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7601049">,</span>&nbsp;<span class="string" id="7601051">&#34;bclone&#34;</span><span class="op" id="7601059">,</span>&nbsp;<span class="ident" id="7601061">b</span><span class="op" id="7601062">.</span><span class="ident" id="7601063">String</span><span class="op" id="7601069">(</span><span class="op" id="7601070">)</span><span class="op" id="7601071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7601074">}</span><br>
<span class="lineno"></span><span class="op" id="7601076">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="7601079">func</span>&nbsp;<span class="ident" id="7601084">TestAddParseTree</span><span class="op" id="7601100">(</span><span class="ident" id="7601101">t</span>&nbsp;<span class="op" id="7601103">*</span><span class="ident" id="7601104">testing</span><span class="op" id="7601111">.</span><span class="ident" id="7601112">T</span><span class="op" id="7601113">)</span>&nbsp;<span class="op" id="7601115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7601118">//&nbsp;Create&nbsp;some&nbsp;templates.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7601145">root</span><span class="op" id="7601149">,</span>&nbsp;<span class="ident" id="7601151">err</span>&nbsp;<span class="op" id="7601155">:=</span>&nbsp;<span class="ident" id="7601158">New</span><span class="op" id="7601161">(</span><span class="string" id="7601162">&#34;root&#34;</span><span class="op" id="7601168">)</span><span class="op" id="7601169">.</span><span class="ident" id="7601170">Parse</span><span class="op" id="7601175">(</span><span class="ident" id="7601176">cloneText1</span><span class="op" id="7601186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7601189">if</span>&nbsp;<span class="ident" id="7601192">err</span>&nbsp;<span class="op" id="7601196">!=</span>&nbsp;<span class="builtintype" id="7601199">nil</span>&nbsp;<span class="op" id="7601203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7601207">t</span><span class="op" id="7601208">.</span><span class="ident" id="7601209">Fatal</span><span class="op" id="7601214">(</span><span class="ident" id="7601215">err</span><span class="op" id="7601218">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7601221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7601224">_</span><span class="op" id="7601225">,</span>&nbsp;<span class="ident" id="7601227">err</span>&nbsp;<span class="op" id="7601231">=</span>&nbsp;<span class="ident" id="7601233">root</span><span class="op" id="7601237">.</span><span class="ident" id="7601238">Parse</span><span class="op" id="7601243">(</span><span class="ident" id="7601244">cloneText2</span><span class="op" id="7601254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7601257">if</span>&nbsp;<span class="ident" id="7601260">err</span>&nbsp;<span class="op" id="7601264">!=</span>&nbsp;<span class="builtintype" id="7601267">nil</span>&nbsp;<span class="op" id="7601271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7601275">t</span><span class="op" id="7601276">.</span><span class="ident" id="7601277">Fatal</span><span class="op" id="7601282">(</span><span class="ident" id="7601283">err</span><span class="op" id="7601286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7601289">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7601292">//&nbsp;Add&nbsp;a&nbsp;new&nbsp;parse&nbsp;tree.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7601318">tree</span><span class="op" id="7601322">,</span>&nbsp;<span class="ident" id="7601324">err</span>&nbsp;<span class="op" id="7601328">:=</span>&nbsp;<span class="ident" id="7601331">parse</span><span class="op" id="7601336">.</span><span class="ident" id="7601337">Parse</span><span class="op" id="7601342">(</span><span class="string" id="7601343">&#34;cloneText3&#34;</span><span class="op" id="7601355">,</span>&nbsp;<span class="ident" id="7601357">cloneText3</span><span class="op" id="7601367">,</span>&nbsp;<span class="string" id="7601369">&#34;&#34;</span><span class="op" id="7601371">,</span>&nbsp;<span class="string" id="7601373">&#34;&#34;</span><span class="op" id="7601375">,</span>&nbsp;<span class="builtintype" id="7601377">nil</span><span class="op" id="7601380">,</span>&nbsp;<span class="ident" id="7601382">builtins</span><span class="op" id="7601390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7601393">if</span>&nbsp;<span class="ident" id="7601396">err</span>&nbsp;<span class="op" id="7601400">!=</span>&nbsp;<span class="builtintype" id="7601403">nil</span>&nbsp;<span class="op" id="7601407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7601411">t</span><span class="op" id="7601412">.</span><span class="ident" id="7601413">Fatal</span><span class="op" id="7601418">(</span><span class="ident" id="7601419">err</span><span class="op" id="7601422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7601425">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7601428">added</span><span class="op" id="7601433">,</span>&nbsp;<span class="ident" id="7601435">err</span>&nbsp;<span class="op" id="7601439">:=</span>&nbsp;<span class="ident" id="7601442">root</span><span class="op" id="7601446">.</span><span class="ident" id="7601447">AddParseTree</span><span class="op" id="7601459">(</span><span class="string" id="7601460">&#34;c&#34;</span><span class="op" id="7601463">,</span>&nbsp;<span class="ident" id="7601465">tree</span><span class="op" id="7601469">[</span><span class="string" id="7601470">&#34;c&#34;</span><span class="op" id="7601473">]</span><span class="op" id="7601474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7601477">//&nbsp;Execute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7601490">var</span>&nbsp;<span class="ident" id="7601494">b</span>&nbsp;<span class="ident" id="7601496">bytes</span><span class="op" id="7601501">.</span><span class="ident" id="7601502">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7601510">err</span>&nbsp;<span class="op" id="7601514">=</span>&nbsp;<span class="ident" id="7601516">added</span><span class="op" id="7601521">.</span><span class="ident" id="7601522">ExecuteTemplate</span><span class="op" id="7601537">(</span><span class="op" id="7601538">&amp;</span><span class="ident" id="7601539">b</span><span class="op" id="7601540">,</span>&nbsp;<span class="string" id="7601542">&#34;a&#34;</span><span class="op" id="7601545">,</span>&nbsp;<span class="num" id="7601547">0</span><span class="op" id="7601548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7601551">if</span>&nbsp;<span class="ident" id="7601554">err</span>&nbsp;<span class="op" id="7601558">!=</span>&nbsp;<span class="builtintype" id="7601561">nil</span>&nbsp;<span class="op" id="7601565">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7601569">t</span><span class="op" id="7601570">.</span><span class="ident" id="7601571">Fatal</span><span class="op" id="7601576">(</span><span class="ident" id="7601577">err</span><span class="op" id="7601580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7601583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7601586">if</span>&nbsp;<span class="ident" id="7601589">b</span><span class="op" id="7601590">.</span><span class="ident" id="7601591">String</span><span class="op" id="7601597">(</span><span class="op" id="7601598">)</span>&nbsp;<span class="op" id="7601600">!=</span>&nbsp;<span class="string" id="7601603">&#34;broot&#34;</span>&nbsp;<span class="op" id="7601611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7601615">t</span><span class="op" id="7601616">.</span><span class="ident" id="7601617">Errorf</span><span class="op" id="7601623">(</span><span class="string" id="7601624">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7601644">,</span>&nbsp;<span class="string" id="7601646">&#34;broot&#34;</span><span class="op" id="7601653">,</span>&nbsp;<span class="ident" id="7601655">b</span><span class="op" id="7601656">.</span><span class="ident" id="7601657">String</span><span class="op" id="7601663">(</span><span class="op" id="7601664">)</span><span class="op" id="7601665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7601668">}</span><br>
<span class="lineno">260</span><span class="op" id="7601670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7601673">//&nbsp;Issue&nbsp;7032</span><br>
<span class="lineno"></span><span class="keyword" id="7601687">func</span>&nbsp;<span class="ident" id="7601692">TestAddParseTreeToUnparsedTemplate</span><span class="op" id="7601726">(</span><span class="ident" id="7601727">t</span>&nbsp;<span class="op" id="7601729">*</span><span class="ident" id="7601730">testing</span><span class="op" id="7601737">.</span><span class="ident" id="7601738">T</span><span class="op" id="7601739">)</span>&nbsp;<span class="op" id="7601741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7601744">master</span>&nbsp;<span class="op" id="7601751">:=</span>&nbsp;<span class="string" id="7601754">&#34;{{define&nbsp;\&#34;master\&#34;}}{{end}}&#34;</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7601786">tmpl</span>&nbsp;<span class="op" id="7601791">:=</span>&nbsp;<span class="ident" id="7601794">New</span><span class="op" id="7601797">(</span><span class="string" id="7601798">&#34;master&#34;</span><span class="op" id="7601806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7601809">tree</span><span class="op" id="7601813">,</span>&nbsp;<span class="ident" id="7601815">err</span>&nbsp;<span class="op" id="7601819">:=</span>&nbsp;<span class="ident" id="7601822">parse</span><span class="op" id="7601827">.</span><span class="ident" id="7601828">Parse</span><span class="op" id="7601833">(</span><span class="string" id="7601834">&#34;master&#34;</span><span class="op" id="7601842">,</span>&nbsp;<span class="ident" id="7601844">master</span><span class="op" id="7601850">,</span>&nbsp;<span class="string" id="7601852">&#34;&#34;</span><span class="op" id="7601854">,</span>&nbsp;<span class="string" id="7601856">&#34;&#34;</span><span class="op" id="7601858">,</span>&nbsp;<span class="builtintype" id="7601860">nil</span><span class="op" id="7601863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7601866">if</span>&nbsp;<span class="ident" id="7601869">err</span>&nbsp;<span class="op" id="7601873">!=</span>&nbsp;<span class="builtintype" id="7601876">nil</span>&nbsp;<span class="op" id="7601880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7601884">t</span><span class="op" id="7601885">.</span><span class="ident" id="7601886">Fatalf</span><span class="op" id="7601892">(</span><span class="string" id="7601893">&#34;unexpected&nbsp;parse&nbsp;err:&nbsp;%v&#34;</span><span class="op" id="7601919">,</span>&nbsp;<span class="ident" id="7601921">err</span><span class="op" id="7601924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7601927">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7601930">masterTree</span>&nbsp;<span class="op" id="7601941">:=</span>&nbsp;<span class="ident" id="7601944">tree</span><span class="op" id="7601948">[</span><span class="string" id="7601949">&#34;master&#34;</span><span class="op" id="7601957">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7601960">tmpl</span><span class="op" id="7601964">.</span><span class="ident" id="7601965">AddParseTree</span><span class="op" id="7601977">(</span><span class="string" id="7601978">&#34;master&#34;</span><span class="op" id="7601986">,</span>&nbsp;<span class="ident" id="7601988">masterTree</span><span class="op" id="7601998">)</span>&nbsp;<span class="comment" id="7602000">//&nbsp;used&nbsp;to&nbsp;panic</span><br>
<span class="lineno"></span><span class="op" id="7602017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7602020">func</span>&nbsp;<span class="ident" id="7602025">TestRedefinition</span><span class="op" id="7602041">(</span><span class="ident" id="7602042">t</span>&nbsp;<span class="op" id="7602044">*</span><span class="ident" id="7602045">testing</span><span class="op" id="7602052">.</span><span class="ident" id="7602053">T</span><span class="op" id="7602054">)</span>&nbsp;<span class="op" id="7602056">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7602059">var</span>&nbsp;<span class="ident" id="7602063">tmpl</span>&nbsp;<span class="op" id="7602068">*</span><span class="ident" id="7602069">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7602079">var</span>&nbsp;<span class="ident" id="7602083">err</span>&nbsp;<span class="builtintype" id="7602087">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7602094">if</span>&nbsp;<span class="ident" id="7602097">tmpl</span><span class="op" id="7602101">,</span>&nbsp;<span class="ident" id="7602103">err</span>&nbsp;<span class="op" id="7602107">=</span>&nbsp;<span class="ident" id="7602109">New</span><span class="op" id="7602112">(</span><span class="string" id="7602113">&#34;tmpl1&#34;</span><span class="op" id="7602120">)</span><span class="op" id="7602121">.</span><span class="ident" id="7602122">Parse</span><span class="op" id="7602127">(</span><span class="string" id="7602128">`{{define&nbsp;&#34;test&#34;}}foo{{end}}`</span><span class="op" id="7602157">)</span><span class="op" id="7602158">;</span>&nbsp;<span class="ident" id="7602160">err</span>&nbsp;<span class="op" id="7602164">!=</span>&nbsp;<span class="builtintype" id="7602167">nil</span>&nbsp;<span class="op" id="7602171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7602175">t</span><span class="op" id="7602176">.</span><span class="ident" id="7602177">Fatalf</span><span class="op" id="7602183">(</span><span class="string" id="7602184">&#34;parse&nbsp;1:&nbsp;%v&#34;</span><span class="op" id="7602197">,</span>&nbsp;<span class="ident" id="7602199">err</span><span class="op" id="7602202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7602205">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7602208">if</span>&nbsp;<span class="ident" id="7602211">_</span><span class="op" id="7602212">,</span>&nbsp;<span class="ident" id="7602214">err</span>&nbsp;<span class="op" id="7602218">=</span>&nbsp;<span class="ident" id="7602220">tmpl</span><span class="op" id="7602224">.</span><span class="ident" id="7602225">Parse</span><span class="op" id="7602230">(</span><span class="string" id="7602231">`{{define&nbsp;&#34;test&#34;}}bar{{end}}`</span><span class="op" id="7602260">)</span><span class="op" id="7602261">;</span>&nbsp;<span class="ident" id="7602263">err</span>&nbsp;<span class="op" id="7602267">==</span>&nbsp;<span class="builtintype" id="7602270">nil</span>&nbsp;<span class="op" id="7602274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7602278">t</span><span class="op" id="7602279">.</span><span class="ident" id="7602280">Fatal</span><span class="op" id="7602285">(</span><span class="string" id="7602286">&#34;expected&nbsp;error&#34;</span><span class="op" id="7602302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7602305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7602308">if</span>&nbsp;<span class="op" id="7602311">!</span><span class="ident" id="7602312">strings</span><span class="op" id="7602319">.</span><span class="ident" id="7602320">Contains</span><span class="op" id="7602328">(</span><span class="ident" id="7602329">err</span><span class="op" id="7602332">.</span><span class="ident" id="7602333">Error</span><span class="op" id="7602338">(</span><span class="op" id="7602339">)</span><span class="op" id="7602340">,</span>&nbsp;<span class="string" id="7602342">&#34;redefinition&#34;</span><span class="op" id="7602356">)</span>&nbsp;<span class="op" id="7602358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7602362">t</span><span class="op" id="7602363">.</span><span class="ident" id="7602364">Fatalf</span><span class="op" id="7602370">(</span><span class="string" id="7602371">&#34;expected&nbsp;redefinition&nbsp;error;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7602408">,</span>&nbsp;<span class="ident" id="7602410">err</span><span class="op" id="7602413">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7602416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7602419">if</span>&nbsp;<span class="ident" id="7602422">_</span><span class="op" id="7602423">,</span>&nbsp;<span class="ident" id="7602425">err</span>&nbsp;<span class="op" id="7602429">=</span>&nbsp;<span class="ident" id="7602431">tmpl</span><span class="op" id="7602435">.</span><span class="ident" id="7602436">New</span><span class="op" id="7602439">(</span><span class="string" id="7602440">&#34;tmpl2&#34;</span><span class="op" id="7602447">)</span><span class="op" id="7602448">.</span><span class="ident" id="7602449">Parse</span><span class="op" id="7602454">(</span><span class="string" id="7602455">`{{define&nbsp;&#34;test&#34;}}bar{{end}}`</span><span class="op" id="7602484">)</span><span class="op" id="7602485">;</span>&nbsp;<span class="ident" id="7602487">err</span>&nbsp;<span class="op" id="7602491">==</span>&nbsp;<span class="builtintype" id="7602494">nil</span>&nbsp;<span class="op" id="7602498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7602502">t</span><span class="op" id="7602503">.</span><span class="ident" id="7602504">Fatal</span><span class="op" id="7602509">(</span><span class="string" id="7602510">&#34;expected&nbsp;error&#34;</span><span class="op" id="7602526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7602529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7602532">if</span>&nbsp;<span class="op" id="7602535">!</span><span class="ident" id="7602536">strings</span><span class="op" id="7602543">.</span><span class="ident" id="7602544">Contains</span><span class="op" id="7602552">(</span><span class="ident" id="7602553">err</span><span class="op" id="7602556">.</span><span class="ident" id="7602557">Error</span><span class="op" id="7602562">(</span><span class="op" id="7602563">)</span><span class="op" id="7602564">,</span>&nbsp;<span class="string" id="7602566">&#34;redefinition&#34;</span><span class="op" id="7602580">)</span>&nbsp;<span class="op" id="7602582">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7602586">t</span><span class="op" id="7602587">.</span><span class="ident" id="7602588">Fatalf</span><span class="op" id="7602594">(</span><span class="string" id="7602595">&#34;expected&nbsp;redefinition&nbsp;error;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7602632">,</span>&nbsp;<span class="ident" id="7602634">err</span><span class="op" id="7602637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7602640">}</span><br>
<span class="lineno"></span><span class="op" id="7602642">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
