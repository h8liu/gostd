<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>regexp/syntax</h2>
<ul>
<li><a href="/gostd/regexp/syntax/compile.go.html">compile.go</a></li>
<li><a href="/gostd/regexp/syntax/doc.go.html">doc.go</a></li>
<li><a href="/gostd/regexp/syntax/parse.go.html">parse.go</a></li>
<li><a href="/gostd/regexp/syntax/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/regexp/syntax/perl_groups.go.html">perl_groups.go</a></li>
<li><a href="/gostd/regexp/syntax/prog.go.html">prog.go</a></li>
<li><a href="/gostd/regexp/syntax/prog_test.go.html">prog_test.go</a></li>
<li><a href="/gostd/regexp/syntax/regexp.go.html">regexp.go</a></li>
<li><a href="/gostd/regexp/syntax/simplify.go.html">simplify.go</a></li>
<li><a href="/gostd/regexp/syntax/simplify_test.go.html">simplify_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3487238">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3487293">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3487347">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3487398">package</span>&nbsp;<span class="ident" id="3487406">syntax</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3487414">import</span>&nbsp;<span class="op" id="3487421">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3487424">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3487433">&#34;strconv&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3487444">&#34;unicode&#34;</span><br>
<span class="lineno"></span><span class="op" id="3487454">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3487457">//&nbsp;Compiled&nbsp;program.</span><br>
<span class="lineno"></span><span class="comment" id="3487478">//&nbsp;May&nbsp;not&nbsp;belong&nbsp;in&nbsp;this&nbsp;package,&nbsp;but&nbsp;convenient&nbsp;for&nbsp;now.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="3487538">//&nbsp;A&nbsp;Prog&nbsp;is&nbsp;a&nbsp;compiled&nbsp;regular&nbsp;expression&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="3487590">type</span>&nbsp;<span class="ident" id="3487595">Prog</span>&nbsp;<span class="keyword" id="3487600">struct</span>&nbsp;<span class="op" id="3487607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487610">Inst</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3487617">[</span><span class="op" id="3487618">]</span><span class="ident" id="3487619">Inst</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487625">Start</span>&nbsp;&nbsp;<span class="builtintype" id="3487632">int</span>&nbsp;<span class="comment" id="3487636">//&nbsp;index&nbsp;of&nbsp;start&nbsp;instruction</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487667">NumCap</span>&nbsp;<span class="builtintype" id="3487674">int</span>&nbsp;<span class="comment" id="3487678">//&nbsp;number&nbsp;of&nbsp;InstCapture&nbsp;insts&nbsp;in&nbsp;re</span><br>
<span class="lineno"></span><span class="op" id="3487715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3487718">//&nbsp;An&nbsp;InstOp&nbsp;is&nbsp;an&nbsp;instruction&nbsp;opcode.</span><br>
<span class="lineno"></span><span class="keyword" id="3487757">type</span>&nbsp;<span class="ident" id="3487762">InstOp</span>&nbsp;<span class="builtintype" id="3487769">uint8</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="3487776">const</span>&nbsp;<span class="op" id="3487782">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487785">InstAlt</span>&nbsp;<span class="ident" id="3487793">InstOp</span>&nbsp;<span class="op" id="3487800">=</span>&nbsp;<span class="ident" id="3487802">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487808">InstAltMatch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487822">InstCapture</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487835">InstEmptyWidth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487851">InstMatch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487862">InstFail</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487872">InstNop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487881">InstRune</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487891">InstRune1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487902">InstRuneAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487915">InstRuneAnyNotNL</span><br>
<span class="lineno"></span><span class="op" id="3487932">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="3487935">var</span>&nbsp;<span class="ident" id="3487939">instOpNames</span>&nbsp;<span class="op" id="3487951">=</span>&nbsp;<span class="op" id="3487953">[</span><span class="op" id="3487954">]</span><span class="builtintype" id="3487955">string</span><span class="op" id="3487961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3487964">&#34;InstAlt&#34;</span><span class="op" id="3487973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3487976">&#34;InstAltMatch&#34;</span><span class="op" id="3487990">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3487993">&#34;InstCapture&#34;</span><span class="op" id="3488006">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3488009">&#34;InstEmptyWidth&#34;</span><span class="op" id="3488025">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3488028">&#34;InstMatch&#34;</span><span class="op" id="3488039">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3488042">&#34;InstFail&#34;</span><span class="op" id="3488052">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3488055">&#34;InstNop&#34;</span><span class="op" id="3488064">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3488067">&#34;InstRune&#34;</span><span class="op" id="3488077">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3488080">&#34;InstRune1&#34;</span><span class="op" id="3488091">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3488094">&#34;InstRuneAny&#34;</span><span class="op" id="3488107">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3488110">&#34;InstRuneAnyNotNL&#34;</span><span class="op" id="3488128">,</span><br>
<span class="lineno"></span><span class="op" id="3488130">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3488133">func</span>&nbsp;<span class="op" id="3488138">(</span><span class="ident" id="3488139">i</span>&nbsp;<span class="ident" id="3488141">InstOp</span><span class="op" id="3488147">)</span>&nbsp;<span class="ident" id="3488149">String</span><span class="op" id="3488155">(</span><span class="op" id="3488156">)</span>&nbsp;<span class="builtintype" id="3488158">string</span>&nbsp;<span class="op" id="3488165">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3488168">if</span>&nbsp;<span class="builtintype" id="3488171">uint</span><span class="op" id="3488175">(</span><span class="ident" id="3488176">i</span><span class="op" id="3488177">)</span>&nbsp;<span class="op" id="3488179">&gt;=</span>&nbsp;<span class="builtintype" id="3488182">uint</span><span class="op" id="3488186">(</span><span class="builtinfunc" id="3488187">len</span><span class="op" id="3488190">(</span><span class="ident" id="3488191">instOpNames</span><span class="op" id="3488202">)</span><span class="op" id="3488203">)</span>&nbsp;<span class="op" id="3488205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3488209">return</span>&nbsp;<span class="string" id="3488216">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3488220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3488223">return</span>&nbsp;<span class="ident" id="3488230">instOpNames</span><span class="op" id="3488241">[</span><span class="ident" id="3488242">i</span><span class="op" id="3488243">]</span><br>
<span class="lineno"></span><span class="op" id="3488245">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="3488248">//&nbsp;An&nbsp;EmptyOp&nbsp;specifies&nbsp;a&nbsp;kind&nbsp;or&nbsp;mixture&nbsp;of&nbsp;zero-width&nbsp;assertions.</span><br>
<span class="lineno"></span><span class="keyword" id="3488316">type</span>&nbsp;<span class="ident" id="3488321">EmptyOp</span>&nbsp;<span class="builtintype" id="3488329">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3488336">const</span>&nbsp;<span class="op" id="3488342">(</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488345">EmptyBeginLine</span>&nbsp;<span class="ident" id="3488360">EmptyOp</span>&nbsp;<span class="op" id="3488368">=</span>&nbsp;<span class="num" id="3488370">1</span>&nbsp;<span class="op" id="3488372">&lt;&lt;</span>&nbsp;<span class="ident" id="3488375">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488381">EmptyEndLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488395">EmptyBeginText</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488411">EmptyEndText</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488425">EmptyWordBoundary</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488444">EmptyNoWordBoundary</span><br>
<span class="lineno"></span><span class="op" id="3488464">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3488467">//&nbsp;EmptyOpContext&nbsp;returns&nbsp;the&nbsp;zero-width&nbsp;assertions</span><br>
<span class="lineno"></span><span class="comment" id="3488519">//&nbsp;satisfied&nbsp;at&nbsp;the&nbsp;position&nbsp;between&nbsp;the&nbsp;runes&nbsp;r1&nbsp;and&nbsp;r2.</span><br>
<span class="lineno">75</span><span class="comment" id="3488577">//&nbsp;Passing&nbsp;r1&nbsp;==&nbsp;-1&nbsp;indicates&nbsp;that&nbsp;the&nbsp;position&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3488628">//&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;text.</span><br>
<span class="lineno"></span><span class="comment" id="3488661">//&nbsp;Passing&nbsp;r2&nbsp;==&nbsp;-1&nbsp;indicates&nbsp;that&nbsp;the&nbsp;position&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3488712">//&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;text.</span><br>
<span class="lineno"></span><span class="keyword" id="3488739">func</span>&nbsp;<span class="ident" id="3488744">EmptyOpContext</span><span class="op" id="3488758">(</span><span class="ident" id="3488759">r1</span><span class="op" id="3488761">,</span>&nbsp;<span class="ident" id="3488763">r2</span>&nbsp;<span class="builtintype" id="3488766">rune</span><span class="op" id="3488770">)</span>&nbsp;<span class="ident" id="3488772">EmptyOp</span>&nbsp;<span class="op" id="3488780">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3488783">var</span>&nbsp;<span class="ident" id="3488787">op</span>&nbsp;<span class="ident" id="3488790">EmptyOp</span>&nbsp;<span class="op" id="3488798">=</span>&nbsp;<span class="ident" id="3488800">EmptyNoWordBoundary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3488821">var</span>&nbsp;<span class="ident" id="3488825">boundary</span>&nbsp;<span class="builtintype" id="3488834">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3488840">switch</span>&nbsp;<span class="op" id="3488847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3488850">case</span>&nbsp;<span class="ident" id="3488855">IsWordChar</span><span class="op" id="3488865">(</span><span class="ident" id="3488866">r1</span><span class="op" id="3488868">)</span><span class="op" id="3488869">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488873">boundary</span>&nbsp;<span class="op" id="3488882">=</span>&nbsp;<span class="num" id="3488884">1</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3488887">case</span>&nbsp;<span class="ident" id="3488892">r1</span>&nbsp;<span class="op" id="3488895">==</span>&nbsp;<span class="string" id="3488898">&#39;\n&#39;</span><span class="op" id="3488902">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488906">op</span>&nbsp;<span class="op" id="3488909">|=</span>&nbsp;<span class="ident" id="3488912">EmptyBeginLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3488928">case</span>&nbsp;<span class="ident" id="3488933">r1</span>&nbsp;<span class="op" id="3488936">&lt;</span>&nbsp;<span class="num" id="3488938">0</span><span class="op" id="3488939">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488943">op</span>&nbsp;<span class="op" id="3488946">|=</span>&nbsp;<span class="ident" id="3488949">EmptyBeginText</span>&nbsp;<span class="op" id="3488964">|</span>&nbsp;<span class="ident" id="3488966">EmptyBeginLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3488982">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3488985">switch</span>&nbsp;<span class="op" id="3488992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3488995">case</span>&nbsp;<span class="ident" id="3489000">IsWordChar</span><span class="op" id="3489010">(</span><span class="ident" id="3489011">r2</span><span class="op" id="3489013">)</span><span class="op" id="3489014">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3489018">boundary</span>&nbsp;<span class="op" id="3489027">^=</span>&nbsp;<span class="num" id="3489030">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3489033">case</span>&nbsp;<span class="ident" id="3489038">r2</span>&nbsp;<span class="op" id="3489041">==</span>&nbsp;<span class="string" id="3489044">&#39;\n&#39;</span><span class="op" id="3489048">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3489052">op</span>&nbsp;<span class="op" id="3489055">|=</span>&nbsp;<span class="ident" id="3489058">EmptyEndLine</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3489072">case</span>&nbsp;<span class="ident" id="3489077">r2</span>&nbsp;<span class="op" id="3489080">&lt;</span>&nbsp;<span class="num" id="3489082">0</span><span class="op" id="3489083">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3489087">op</span>&nbsp;<span class="op" id="3489090">|=</span>&nbsp;<span class="ident" id="3489093">EmptyEndText</span>&nbsp;<span class="op" id="3489106">|</span>&nbsp;<span class="ident" id="3489108">EmptyEndLine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3489122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3489125">if</span>&nbsp;<span class="ident" id="3489128">boundary</span>&nbsp;<span class="op" id="3489137">!=</span>&nbsp;<span class="num" id="3489140">0</span>&nbsp;<span class="op" id="3489142">{</span>&nbsp;<span class="comment" id="3489144">//&nbsp;IsWordChar(r1)&nbsp;!=&nbsp;IsWordChar(r2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3489182">op</span>&nbsp;<span class="op" id="3489185">^=</span>&nbsp;<span class="op" id="3489188">(</span><span class="ident" id="3489189">EmptyWordBoundary</span>&nbsp;<span class="op" id="3489207">|</span>&nbsp;<span class="ident" id="3489209">EmptyNoWordBoundary</span><span class="op" id="3489228">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3489231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3489234">return</span>&nbsp;<span class="ident" id="3489241">op</span><br>
<span class="lineno"></span><span class="op" id="3489244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3489247">//&nbsp;IsWordChar&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;consider&nbsp;a&nbsp;``word&nbsp;character&#39;&#39;</span><br>
<span class="lineno">105</span><span class="comment" id="3489312">//&nbsp;during&nbsp;the&nbsp;evaluation&nbsp;of&nbsp;the&nbsp;\b&nbsp;and&nbsp;\B&nbsp;zero-width&nbsp;assertions.</span><br>
<span class="lineno"></span><span class="comment" id="3489377">//&nbsp;These&nbsp;assertions&nbsp;are&nbsp;ASCII-only:&nbsp;the&nbsp;word&nbsp;characters&nbsp;are&nbsp;[A-Za-z0-9_].</span><br>
<span class="lineno"></span><span class="keyword" id="3489451">func</span>&nbsp;<span class="ident" id="3489456">IsWordChar</span><span class="op" id="3489466">(</span><span class="ident" id="3489467">r</span>&nbsp;<span class="builtintype" id="3489469">rune</span><span class="op" id="3489473">)</span>&nbsp;<span class="builtintype" id="3489475">bool</span>&nbsp;<span class="op" id="3489480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3489483">return</span>&nbsp;<span class="string" id="3489490">&#39;A&#39;</span>&nbsp;<span class="op" id="3489494">&lt;=</span>&nbsp;<span class="ident" id="3489497">r</span>&nbsp;<span class="op" id="3489499">&amp;&amp;</span>&nbsp;<span class="ident" id="3489502">r</span>&nbsp;<span class="op" id="3489504">&lt;=</span>&nbsp;<span class="string" id="3489507">&#39;Z&#39;</span>&nbsp;<span class="op" id="3489511">||</span>&nbsp;<span class="string" id="3489514">&#39;a&#39;</span>&nbsp;<span class="op" id="3489518">&lt;=</span>&nbsp;<span class="ident" id="3489521">r</span>&nbsp;<span class="op" id="3489523">&amp;&amp;</span>&nbsp;<span class="ident" id="3489526">r</span>&nbsp;<span class="op" id="3489528">&lt;=</span>&nbsp;<span class="string" id="3489531">&#39;z&#39;</span>&nbsp;<span class="op" id="3489535">||</span>&nbsp;<span class="string" id="3489538">&#39;0&#39;</span>&nbsp;<span class="op" id="3489542">&lt;=</span>&nbsp;<span class="ident" id="3489545">r</span>&nbsp;<span class="op" id="3489547">&amp;&amp;</span>&nbsp;<span class="ident" id="3489550">r</span>&nbsp;<span class="op" id="3489552">&lt;=</span>&nbsp;<span class="string" id="3489555">&#39;9&#39;</span>&nbsp;<span class="op" id="3489559">||</span>&nbsp;<span class="ident" id="3489562">r</span>&nbsp;<span class="op" id="3489564">==</span>&nbsp;<span class="string" id="3489567">&#39;_&#39;</span><br>
<span class="lineno"></span><span class="op" id="3489571">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="3489574">//&nbsp;An&nbsp;Inst&nbsp;is&nbsp;a&nbsp;single&nbsp;instruction&nbsp;in&nbsp;a&nbsp;regular&nbsp;expression&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="3489642">type</span>&nbsp;<span class="ident" id="3489647">Inst</span>&nbsp;<span class="keyword" id="3489652">struct</span>&nbsp;<span class="op" id="3489659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3489662">Op</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3489667">InstOp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3489675">Out</span>&nbsp;&nbsp;<span class="builtintype" id="3489680">uint32</span>&nbsp;<span class="comment" id="3489687">//&nbsp;all&nbsp;but&nbsp;InstMatch,&nbsp;InstFail</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3489719">Arg</span>&nbsp;&nbsp;<span class="builtintype" id="3489724">uint32</span>&nbsp;<span class="comment" id="3489731">//&nbsp;InstAlt,&nbsp;InstAltMatch,&nbsp;InstCapture,&nbsp;InstEmptyWidth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3489786">Rune</span>&nbsp;<span class="op" id="3489791">[</span><span class="op" id="3489792">]</span><span class="builtintype" id="3489793">rune</span><br>
<span class="lineno"></span><span class="op" id="3489798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3489801">func</span>&nbsp;<span class="op" id="3489806">(</span><span class="ident" id="3489807">p</span>&nbsp;<span class="op" id="3489809">*</span><span class="ident" id="3489810">Prog</span><span class="op" id="3489814">)</span>&nbsp;<span class="ident" id="3489816">String</span><span class="op" id="3489822">(</span><span class="op" id="3489823">)</span>&nbsp;<span class="builtintype" id="3489825">string</span>&nbsp;<span class="op" id="3489832">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3489835">var</span>&nbsp;<span class="ident" id="3489839">b</span>&nbsp;<span class="ident" id="3489841">bytes</span><span class="op" id="3489846">.</span><span class="ident" id="3489847">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3489855">dumpProg</span><span class="op" id="3489863">(</span><span class="op" id="3489864">&amp;</span><span class="ident" id="3489865">b</span><span class="op" id="3489866">,</span>&nbsp;<span class="ident" id="3489868">p</span><span class="op" id="3489869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3489872">return</span>&nbsp;<span class="ident" id="3489879">b</span><span class="op" id="3489880">.</span><span class="ident" id="3489881">String</span><span class="op" id="3489887">(</span><span class="op" id="3489888">)</span><br>
<span class="lineno"></span><span class="op" id="3489890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="3489893">//&nbsp;skipNop&nbsp;follows&nbsp;any&nbsp;no-op&nbsp;or&nbsp;capturing&nbsp;instructions</span><br>
<span class="lineno"></span><span class="comment" id="3489948">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;resulting&nbsp;pc.</span><br>
<span class="lineno"></span><span class="keyword" id="3489981">func</span>&nbsp;<span class="op" id="3489986">(</span><span class="ident" id="3489987">p</span>&nbsp;<span class="op" id="3489989">*</span><span class="ident" id="3489990">Prog</span><span class="op" id="3489994">)</span>&nbsp;<span class="ident" id="3489996">skipNop</span><span class="op" id="3490003">(</span><span class="ident" id="3490004">pc</span>&nbsp;<span class="builtintype" id="3490007">uint32</span><span class="op" id="3490013">)</span>&nbsp;<span class="op" id="3490015">(</span><span class="op" id="3490016">*</span><span class="ident" id="3490017">Inst</span><span class="op" id="3490021">,</span>&nbsp;<span class="builtintype" id="3490023">uint32</span><span class="op" id="3490029">)</span>&nbsp;<span class="op" id="3490031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3490034">i</span>&nbsp;<span class="op" id="3490036">:=</span>&nbsp;<span class="op" id="3490039">&amp;</span><span class="ident" id="3490040">p</span><span class="op" id="3490041">.</span><span class="ident" id="3490042">Inst</span><span class="op" id="3490046">[</span><span class="ident" id="3490047">pc</span><span class="op" id="3490049">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490052">for</span>&nbsp;<span class="ident" id="3490056">i</span><span class="op" id="3490057">.</span><span class="ident" id="3490058">Op</span>&nbsp;<span class="op" id="3490061">==</span>&nbsp;<span class="ident" id="3490064">InstNop</span>&nbsp;<span class="op" id="3490072">||</span>&nbsp;<span class="ident" id="3490075">i</span><span class="op" id="3490076">.</span><span class="ident" id="3490077">Op</span>&nbsp;<span class="op" id="3490080">==</span>&nbsp;<span class="ident" id="3490083">InstCapture</span>&nbsp;<span class="op" id="3490095">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3490099">pc</span>&nbsp;<span class="op" id="3490102">=</span>&nbsp;<span class="ident" id="3490104">i</span><span class="op" id="3490105">.</span><span class="ident" id="3490106">Out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3490112">i</span>&nbsp;<span class="op" id="3490114">=</span>&nbsp;<span class="op" id="3490116">&amp;</span><span class="ident" id="3490117">p</span><span class="op" id="3490118">.</span><span class="ident" id="3490119">Inst</span><span class="op" id="3490123">[</span><span class="ident" id="3490124">pc</span><span class="op" id="3490126">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3490129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490132">return</span>&nbsp;<span class="ident" id="3490139">i</span><span class="op" id="3490140">,</span>&nbsp;<span class="ident" id="3490142">pc</span><br>
<span class="lineno"></span><span class="op" id="3490145">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="comment" id="3490148">//&nbsp;op&nbsp;returns&nbsp;i.Op&nbsp;but&nbsp;merges&nbsp;all&nbsp;the&nbsp;Rune&nbsp;special&nbsp;cases&nbsp;into&nbsp;InstRune</span><br>
<span class="lineno"></span><span class="keyword" id="3490219">func</span>&nbsp;<span class="op" id="3490224">(</span><span class="ident" id="3490225">i</span>&nbsp;<span class="op" id="3490227">*</span><span class="ident" id="3490228">Inst</span><span class="op" id="3490232">)</span>&nbsp;<span class="ident" id="3490234">op</span><span class="op" id="3490236">(</span><span class="op" id="3490237">)</span>&nbsp;<span class="ident" id="3490239">InstOp</span>&nbsp;<span class="op" id="3490246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3490249">op</span>&nbsp;<span class="op" id="3490252">:=</span>&nbsp;<span class="ident" id="3490255">i</span><span class="op" id="3490256">.</span><span class="ident" id="3490257">Op</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490261">switch</span>&nbsp;<span class="ident" id="3490268">op</span>&nbsp;<span class="op" id="3490271">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490274">case</span>&nbsp;<span class="ident" id="3490279">InstRune1</span><span class="op" id="3490288">,</span>&nbsp;<span class="ident" id="3490290">InstRuneAny</span><span class="op" id="3490301">,</span>&nbsp;<span class="ident" id="3490303">InstRuneAnyNotNL</span><span class="op" id="3490319">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3490323">op</span>&nbsp;<span class="op" id="3490326">=</span>&nbsp;<span class="ident" id="3490328">InstRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3490338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490341">return</span>&nbsp;<span class="ident" id="3490348">op</span><br>
<span class="lineno"></span><span class="op" id="3490351">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="3490354">//&nbsp;Prefix&nbsp;returns&nbsp;a&nbsp;literal&nbsp;string&nbsp;that&nbsp;all&nbsp;matches&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3490414">//&nbsp;regexp&nbsp;must&nbsp;start&nbsp;with.&nbsp;&nbsp;Complete&nbsp;is&nbsp;true&nbsp;if&nbsp;the&nbsp;prefix</span><br>
<span class="lineno"></span><span class="comment" id="3490473">//&nbsp;is&nbsp;the&nbsp;entire&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="3490497">func</span>&nbsp;<span class="op" id="3490502">(</span><span class="ident" id="3490503">p</span>&nbsp;<span class="op" id="3490505">*</span><span class="ident" id="3490506">Prog</span><span class="op" id="3490510">)</span>&nbsp;<span class="ident" id="3490512">Prefix</span><span class="op" id="3490518">(</span><span class="op" id="3490519">)</span>&nbsp;<span class="op" id="3490521">(</span><span class="ident" id="3490522">prefix</span>&nbsp;<span class="builtintype" id="3490529">string</span><span class="op" id="3490535">,</span>&nbsp;<span class="ident" id="3490537">complete</span>&nbsp;<span class="builtintype" id="3490546">bool</span><span class="op" id="3490550">)</span>&nbsp;<span class="op" id="3490552">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3490555">i</span><span class="op" id="3490556">,</span>&nbsp;<span class="ident" id="3490558">_</span>&nbsp;<span class="op" id="3490560">:=</span>&nbsp;<span class="ident" id="3490563">p</span><span class="op" id="3490564">.</span><span class="ident" id="3490565">skipNop</span><span class="op" id="3490572">(</span><span class="builtintype" id="3490573">uint32</span><span class="op" id="3490579">(</span><span class="ident" id="3490580">p</span><span class="op" id="3490581">.</span><span class="ident" id="3490582">Start</span><span class="op" id="3490587">)</span><span class="op" id="3490588">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3490592">//&nbsp;Avoid&nbsp;allocation&nbsp;of&nbsp;buffer&nbsp;if&nbsp;prefix&nbsp;is&nbsp;empty.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490643">if</span>&nbsp;<span class="ident" id="3490646">i</span><span class="op" id="3490647">.</span><span class="ident" id="3490648">op</span><span class="op" id="3490650">(</span><span class="op" id="3490651">)</span>&nbsp;<span class="op" id="3490653">!=</span>&nbsp;<span class="ident" id="3490656">InstRune</span>&nbsp;<span class="op" id="3490665">||</span>&nbsp;<span class="builtinfunc" id="3490668">len</span><span class="op" id="3490671">(</span><span class="ident" id="3490672">i</span><span class="op" id="3490673">.</span><span class="ident" id="3490674">Rune</span><span class="op" id="3490678">)</span>&nbsp;<span class="op" id="3490680">!=</span>&nbsp;<span class="num" id="3490683">1</span>&nbsp;<span class="op" id="3490685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490689">return</span>&nbsp;<span class="string" id="3490696">&#34;&#34;</span><span class="op" id="3490698">,</span>&nbsp;<span class="ident" id="3490700">i</span><span class="op" id="3490701">.</span><span class="ident" id="3490702">Op</span>&nbsp;<span class="op" id="3490705">==</span>&nbsp;<span class="ident" id="3490708">InstMatch</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3490719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3490723">//&nbsp;Have&nbsp;prefix;&nbsp;gather&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490759">var</span>&nbsp;<span class="ident" id="3490763">buf</span>&nbsp;<span class="ident" id="3490767">bytes</span><span class="op" id="3490772">.</span><span class="ident" id="3490773">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490781">for</span>&nbsp;<span class="ident" id="3490785">i</span><span class="op" id="3490786">.</span><span class="ident" id="3490787">op</span><span class="op" id="3490789">(</span><span class="op" id="3490790">)</span>&nbsp;<span class="op" id="3490792">==</span>&nbsp;<span class="ident" id="3490795">InstRune</span>&nbsp;<span class="op" id="3490804">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3490807">len</span><span class="op" id="3490810">(</span><span class="ident" id="3490811">i</span><span class="op" id="3490812">.</span><span class="ident" id="3490813">Rune</span><span class="op" id="3490817">)</span>&nbsp;<span class="op" id="3490819">==</span>&nbsp;<span class="num" id="3490822">1</span>&nbsp;<span class="op" id="3490824">&amp;&amp;</span>&nbsp;<span class="ident" id="3490827">Flags</span><span class="op" id="3490832">(</span><span class="ident" id="3490833">i</span><span class="op" id="3490834">.</span><span class="ident" id="3490835">Arg</span><span class="op" id="3490838">)</span><span class="op" id="3490839">&amp;</span><span class="ident" id="3490840">FoldCase</span>&nbsp;<span class="op" id="3490849">==</span>&nbsp;<span class="num" id="3490852">0</span>&nbsp;<span class="op" id="3490854">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3490858">buf</span><span class="op" id="3490861">.</span><span class="ident" id="3490862">WriteRune</span><span class="op" id="3490871">(</span><span class="ident" id="3490872">i</span><span class="op" id="3490873">.</span><span class="ident" id="3490874">Rune</span><span class="op" id="3490878">[</span><span class="num" id="3490879">0</span><span class="op" id="3490880">]</span><span class="op" id="3490881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3490885">i</span><span class="op" id="3490886">,</span>&nbsp;<span class="ident" id="3490888">_</span>&nbsp;<span class="op" id="3490890">=</span>&nbsp;<span class="ident" id="3490892">p</span><span class="op" id="3490893">.</span><span class="ident" id="3490894">skipNop</span><span class="op" id="3490901">(</span><span class="ident" id="3490902">i</span><span class="op" id="3490903">.</span><span class="ident" id="3490904">Out</span><span class="op" id="3490907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3490910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490913">return</span>&nbsp;<span class="ident" id="3490920">buf</span><span class="op" id="3490923">.</span><span class="ident" id="3490924">String</span><span class="op" id="3490930">(</span><span class="op" id="3490931">)</span><span class="op" id="3490932">,</span>&nbsp;<span class="ident" id="3490934">i</span><span class="op" id="3490935">.</span><span class="ident" id="3490936">Op</span>&nbsp;<span class="op" id="3490939">==</span>&nbsp;<span class="ident" id="3490942">InstMatch</span><br>
<span class="lineno"></span><span class="op" id="3490952">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="3490955">//&nbsp;StartCond&nbsp;returns&nbsp;the&nbsp;leading&nbsp;empty-width&nbsp;conditions&nbsp;that&nbsp;must</span><br>
<span class="lineno"></span><span class="comment" id="3491021">//&nbsp;be&nbsp;true&nbsp;in&nbsp;any&nbsp;match.&nbsp;&nbsp;It&nbsp;returns&nbsp;^EmptyOp(0)&nbsp;if&nbsp;no&nbsp;matches&nbsp;are&nbsp;possible.</span><br>
<span class="lineno"></span><span class="keyword" id="3491098">func</span>&nbsp;<span class="op" id="3491103">(</span><span class="ident" id="3491104">p</span>&nbsp;<span class="op" id="3491106">*</span><span class="ident" id="3491107">Prog</span><span class="op" id="3491111">)</span>&nbsp;<span class="ident" id="3491113">StartCond</span><span class="op" id="3491122">(</span><span class="op" id="3491123">)</span>&nbsp;<span class="ident" id="3491125">EmptyOp</span>&nbsp;<span class="op" id="3491133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3491136">var</span>&nbsp;<span class="ident" id="3491140">flag</span>&nbsp;<span class="ident" id="3491145">EmptyOp</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3491154">pc</span>&nbsp;<span class="op" id="3491157">:=</span>&nbsp;<span class="builtintype" id="3491160">uint32</span><span class="op" id="3491166">(</span><span class="ident" id="3491167">p</span><span class="op" id="3491168">.</span><span class="ident" id="3491169">Start</span><span class="op" id="3491174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3491177">i</span>&nbsp;<span class="op" id="3491179">:=</span>&nbsp;<span class="op" id="3491182">&amp;</span><span class="ident" id="3491183">p</span><span class="op" id="3491184">.</span><span class="ident" id="3491185">Inst</span><span class="op" id="3491189">[</span><span class="ident" id="3491190">pc</span><span class="op" id="3491192">]</span><br>
<span class="lineno"></span><span class="ident" id="3491194">Loop</span><span class="op" id="3491198">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3491201">for</span>&nbsp;<span class="op" id="3491205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3491209">switch</span>&nbsp;<span class="ident" id="3491216">i</span><span class="op" id="3491217">.</span><span class="ident" id="3491218">Op</span>&nbsp;<span class="op" id="3491221">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3491225">case</span>&nbsp;<span class="ident" id="3491230">InstEmptyWidth</span><span class="op" id="3491244">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3491249">flag</span>&nbsp;<span class="op" id="3491254">|=</span>&nbsp;<span class="ident" id="3491257">EmptyOp</span><span class="op" id="3491264">(</span><span class="ident" id="3491265">i</span><span class="op" id="3491266">.</span><span class="ident" id="3491267">Arg</span><span class="op" id="3491270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3491274">case</span>&nbsp;<span class="ident" id="3491279">InstFail</span><span class="op" id="3491287">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3491292">return</span>&nbsp;<span class="op" id="3491299">^</span><span class="ident" id="3491300">EmptyOp</span><span class="op" id="3491307">(</span><span class="num" id="3491308">0</span><span class="op" id="3491309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3491313">case</span>&nbsp;<span class="ident" id="3491318">InstCapture</span><span class="op" id="3491329">,</span>&nbsp;<span class="ident" id="3491331">InstNop</span><span class="op" id="3491338">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3491343">//&nbsp;skip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3491353">default</span><span class="op" id="3491360">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3491365">break</span>&nbsp;<span class="ident" id="3491371">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3491378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3491382">pc</span>&nbsp;<span class="op" id="3491385">=</span>&nbsp;<span class="ident" id="3491387">i</span><span class="op" id="3491388">.</span><span class="ident" id="3491389">Out</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3491395">i</span>&nbsp;<span class="op" id="3491397">=</span>&nbsp;<span class="op" id="3491399">&amp;</span><span class="ident" id="3491400">p</span><span class="op" id="3491401">.</span><span class="ident" id="3491402">Inst</span><span class="op" id="3491406">[</span><span class="ident" id="3491407">pc</span><span class="op" id="3491409">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3491412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3491415">return</span>&nbsp;<span class="ident" id="3491422">flag</span><br>
<span class="lineno"></span><span class="op" id="3491427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="3491430">const</span>&nbsp;<span class="ident" id="3491436">noMatch</span>&nbsp;<span class="op" id="3491444">=</span>&nbsp;<span class="op" id="3491446">-</span><span class="num" id="3491447">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3491450">//&nbsp;MatchRune&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;instruction&nbsp;matches&nbsp;(and&nbsp;consumes)&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="3491521">//&nbsp;It&nbsp;should&nbsp;only&nbsp;be&nbsp;called&nbsp;when&nbsp;i.Op&nbsp;==&nbsp;InstRune.</span><br>
<span class="lineno"></span><span class="keyword" id="3491572">func</span>&nbsp;<span class="op" id="3491577">(</span><span class="ident" id="3491578">i</span>&nbsp;<span class="op" id="3491580">*</span><span class="ident" id="3491581">Inst</span><span class="op" id="3491585">)</span>&nbsp;<span class="ident" id="3491587">MatchRune</span><span class="op" id="3491596">(</span><span class="ident" id="3491597">r</span>&nbsp;<span class="builtintype" id="3491599">rune</span><span class="op" id="3491603">)</span>&nbsp;<span class="builtintype" id="3491605">bool</span>&nbsp;<span class="op" id="3491610">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3491613">return</span>&nbsp;<span class="ident" id="3491620">i</span><span class="op" id="3491621">.</span><span class="ident" id="3491622">MatchRunePos</span><span class="op" id="3491634">(</span><span class="ident" id="3491635">r</span><span class="op" id="3491636">)</span>&nbsp;<span class="op" id="3491638">!=</span>&nbsp;<span class="ident" id="3491641">noMatch</span><br>
<span class="lineno"></span><span class="op" id="3491649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3491652">//&nbsp;MatchRunePos&nbsp;checks&nbsp;whether&nbsp;the&nbsp;instruction&nbsp;matches&nbsp;(and&nbsp;consumes)&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="3491725">//&nbsp;If&nbsp;so,&nbsp;MatchRunePos&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;matching&nbsp;rune&nbsp;pair</span><br>
<span class="lineno">200</span><span class="comment" id="3491792">//&nbsp;(or,&nbsp;when&nbsp;len(i.Rune)&nbsp;==&nbsp;1,&nbsp;rune&nbsp;singleton).</span><br>
<span class="lineno"></span><span class="comment" id="3491840">//&nbsp;If&nbsp;not,&nbsp;MatchRunePos&nbsp;returns&nbsp;-1.</span><br>
<span class="lineno"></span><span class="comment" id="3491876">//&nbsp;MatchRunePos&nbsp;should&nbsp;only&nbsp;be&nbsp;called&nbsp;when&nbsp;i.Op&nbsp;==&nbsp;InstRune.</span><br>
<span class="lineno"></span><span class="keyword" id="3491937">func</span>&nbsp;<span class="op" id="3491942">(</span><span class="ident" id="3491943">i</span>&nbsp;<span class="op" id="3491945">*</span><span class="ident" id="3491946">Inst</span><span class="op" id="3491950">)</span>&nbsp;<span class="ident" id="3491952">MatchRunePos</span><span class="op" id="3491964">(</span><span class="ident" id="3491965">r</span>&nbsp;<span class="builtintype" id="3491967">rune</span><span class="op" id="3491971">)</span>&nbsp;<span class="builtintype" id="3491973">int</span>&nbsp;<span class="op" id="3491977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="3491980">rune</span>&nbsp;<span class="op" id="3491985">:=</span>&nbsp;<span class="ident" id="3491988">i</span><span class="op" id="3491989">.</span><span class="ident" id="3491990">Rune</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3491997">//&nbsp;Special&nbsp;case:&nbsp;single-rune&nbsp;slice&nbsp;is&nbsp;from&nbsp;literal&nbsp;string,&nbsp;not&nbsp;char&nbsp;class.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3492073">if</span>&nbsp;<span class="builtinfunc" id="3492076">len</span><span class="op" id="3492079">(</span><span class="builtintype" id="3492080">rune</span><span class="op" id="3492084">)</span>&nbsp;<span class="op" id="3492086">==</span>&nbsp;<span class="num" id="3492089">1</span>&nbsp;<span class="op" id="3492091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3492095">r0</span>&nbsp;<span class="op" id="3492098">:=</span>&nbsp;<span class="builtintype" id="3492101">rune</span><span class="op" id="3492105">[</span><span class="num" id="3492106">0</span><span class="op" id="3492107">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3492111">if</span>&nbsp;<span class="ident" id="3492114">r</span>&nbsp;<span class="op" id="3492116">==</span>&nbsp;<span class="ident" id="3492119">r0</span>&nbsp;<span class="op" id="3492122">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3492127">return</span>&nbsp;<span class="num" id="3492134">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3492138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3492142">if</span>&nbsp;<span class="ident" id="3492145">Flags</span><span class="op" id="3492150">(</span><span class="ident" id="3492151">i</span><span class="op" id="3492152">.</span><span class="ident" id="3492153">Arg</span><span class="op" id="3492156">)</span><span class="op" id="3492157">&amp;</span><span class="ident" id="3492158">FoldCase</span>&nbsp;<span class="op" id="3492167">!=</span>&nbsp;<span class="num" id="3492170">0</span>&nbsp;<span class="op" id="3492172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3492177">for</span>&nbsp;<span class="ident" id="3492181">r1</span>&nbsp;<span class="op" id="3492184">:=</span>&nbsp;<span class="ident" id="3492187">unicode</span><span class="op" id="3492194">.</span><span class="ident" id="3492195">SimpleFold</span><span class="op" id="3492205">(</span><span class="ident" id="3492206">r0</span><span class="op" id="3492208">)</span><span class="op" id="3492209">;</span>&nbsp;<span class="ident" id="3492211">r1</span>&nbsp;<span class="op" id="3492214">!=</span>&nbsp;<span class="ident" id="3492217">r0</span><span class="op" id="3492219">;</span>&nbsp;<span class="ident" id="3492221">r1</span>&nbsp;<span class="op" id="3492224">=</span>&nbsp;<span class="ident" id="3492226">unicode</span><span class="op" id="3492233">.</span><span class="ident" id="3492234">SimpleFold</span><span class="op" id="3492244">(</span><span class="ident" id="3492245">r1</span><span class="op" id="3492247">)</span>&nbsp;<span class="op" id="3492249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3492255">if</span>&nbsp;<span class="ident" id="3492258">r</span>&nbsp;<span class="op" id="3492260">==</span>&nbsp;<span class="ident" id="3492263">r1</span>&nbsp;<span class="op" id="3492266">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3492273">return</span>&nbsp;<span class="num" id="3492280">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3492286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3492291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3492295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3492299">return</span>&nbsp;<span class="ident" id="3492306">noMatch</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3492315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3492319">//&nbsp;Peek&nbsp;at&nbsp;the&nbsp;first&nbsp;few&nbsp;pairs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3492352">//&nbsp;Should&nbsp;handle&nbsp;ASCII&nbsp;well.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3492382">for</span>&nbsp;<span class="ident" id="3492386">j</span>&nbsp;<span class="op" id="3492388">:=</span>&nbsp;<span class="num" id="3492391">0</span><span class="op" id="3492392">;</span>&nbsp;<span class="ident" id="3492394">j</span>&nbsp;<span class="op" id="3492396">&lt;</span>&nbsp;<span class="builtinfunc" id="3492398">len</span><span class="op" id="3492401">(</span><span class="builtintype" id="3492402">rune</span><span class="op" id="3492406">)</span>&nbsp;<span class="op" id="3492408">&amp;&amp;</span>&nbsp;<span class="ident" id="3492411">j</span>&nbsp;<span class="op" id="3492413">&lt;=</span>&nbsp;<span class="num" id="3492416">8</span><span class="op" id="3492417">;</span>&nbsp;<span class="ident" id="3492419">j</span>&nbsp;<span class="op" id="3492421">+=</span>&nbsp;<span class="num" id="3492424">2</span>&nbsp;<span class="op" id="3492426">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3492430">if</span>&nbsp;<span class="ident" id="3492433">r</span>&nbsp;<span class="op" id="3492435">&lt;</span>&nbsp;<span class="builtintype" id="3492437">rune</span><span class="op" id="3492441">[</span><span class="ident" id="3492442">j</span><span class="op" id="3492443">]</span>&nbsp;<span class="op" id="3492445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3492450">return</span>&nbsp;<span class="ident" id="3492457">noMatch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3492467">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3492471">if</span>&nbsp;<span class="ident" id="3492474">r</span>&nbsp;<span class="op" id="3492476">&lt;=</span>&nbsp;<span class="builtintype" id="3492479">rune</span><span class="op" id="3492483">[</span><span class="ident" id="3492484">j</span><span class="op" id="3492485">+</span><span class="num" id="3492486">1</span><span class="op" id="3492487">]</span>&nbsp;<span class="op" id="3492489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3492494">return</span>&nbsp;<span class="ident" id="3492501">j</span>&nbsp;<span class="op" id="3492503">/</span>&nbsp;<span class="num" id="3492505">2</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3492509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3492512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3492516">//&nbsp;Otherwise&nbsp;binary&nbsp;search.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3492545">lo</span>&nbsp;<span class="op" id="3492548">:=</span>&nbsp;<span class="num" id="3492551">0</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3492554">hi</span>&nbsp;<span class="op" id="3492557">:=</span>&nbsp;<span class="builtinfunc" id="3492560">len</span><span class="op" id="3492563">(</span><span class="builtintype" id="3492564">rune</span><span class="op" id="3492568">)</span>&nbsp;<span class="op" id="3492570">/</span>&nbsp;<span class="num" id="3492572">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3492575">for</span>&nbsp;<span class="ident" id="3492579">lo</span>&nbsp;<span class="op" id="3492582">&lt;</span>&nbsp;<span class="ident" id="3492584">hi</span>&nbsp;<span class="op" id="3492587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3492591">m</span>&nbsp;<span class="op" id="3492593">:=</span>&nbsp;<span class="ident" id="3492596">lo</span>&nbsp;<span class="op" id="3492599">+</span>&nbsp;<span class="op" id="3492601">(</span><span class="ident" id="3492602">hi</span><span class="op" id="3492604">-</span><span class="ident" id="3492605">lo</span><span class="op" id="3492607">)</span><span class="op" id="3492608">/</span><span class="num" id="3492609">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3492613">if</span>&nbsp;<span class="ident" id="3492616">c</span>&nbsp;<span class="op" id="3492618">:=</span>&nbsp;<span class="builtintype" id="3492621">rune</span><span class="op" id="3492625">[</span><span class="num" id="3492626">2</span><span class="op" id="3492627">*</span><span class="ident" id="3492628">m</span><span class="op" id="3492629">]</span><span class="op" id="3492630">;</span>&nbsp;<span class="ident" id="3492632">c</span>&nbsp;<span class="op" id="3492634">&lt;=</span>&nbsp;<span class="ident" id="3492637">r</span>&nbsp;<span class="op" id="3492639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3492644">if</span>&nbsp;<span class="ident" id="3492647">r</span>&nbsp;<span class="op" id="3492649">&lt;=</span>&nbsp;<span class="builtintype" id="3492652">rune</span><span class="op" id="3492656">[</span><span class="num" id="3492657">2</span><span class="op" id="3492658">*</span><span class="ident" id="3492659">m</span><span class="op" id="3492660">+</span><span class="num" id="3492661">1</span><span class="op" id="3492662">]</span>&nbsp;<span class="op" id="3492664">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3492670">return</span>&nbsp;<span class="ident" id="3492677">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3492682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3492687">lo</span>&nbsp;<span class="op" id="3492690">=</span>&nbsp;<span class="ident" id="3492692">m</span>&nbsp;<span class="op" id="3492694">+</span>&nbsp;<span class="num" id="3492696">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3492700">}</span>&nbsp;<span class="keyword" id="3492702">else</span>&nbsp;<span class="op" id="3492707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3492712">hi</span>&nbsp;<span class="op" id="3492715">=</span>&nbsp;<span class="ident" id="3492717">m</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3492721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3492724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3492727">return</span>&nbsp;<span class="ident" id="3492734">noMatch</span><br>
<span class="lineno"></span><span class="op" id="3492742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="3492745">//&nbsp;As&nbsp;per&nbsp;re2&#39;s&nbsp;Prog::IsWordChar.&nbsp;Determines&nbsp;whether&nbsp;rune&nbsp;is&nbsp;an&nbsp;ASCII&nbsp;word&nbsp;char.</span><br>
<span class="lineno"></span><span class="comment" id="3492826">//&nbsp;Since&nbsp;we&nbsp;act&nbsp;on&nbsp;runes,&nbsp;it&nbsp;would&nbsp;be&nbsp;easy&nbsp;to&nbsp;support&nbsp;Unicode&nbsp;here.</span><br>
<span class="lineno"></span><span class="keyword" id="3492894">func</span>&nbsp;<span class="ident" id="3492899">wordRune</span><span class="op" id="3492907">(</span><span class="ident" id="3492908">r</span>&nbsp;<span class="builtintype" id="3492910">rune</span><span class="op" id="3492914">)</span>&nbsp;<span class="builtintype" id="3492916">bool</span>&nbsp;<span class="op" id="3492921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3492924">return</span>&nbsp;<span class="ident" id="3492931">r</span>&nbsp;<span class="op" id="3492933">==</span>&nbsp;<span class="string" id="3492936">&#39;_&#39;</span>&nbsp;<span class="op" id="3492940">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3492945">(</span><span class="string" id="3492946">&#39;A&#39;</span>&nbsp;<span class="op" id="3492950">&lt;=</span>&nbsp;<span class="ident" id="3492953">r</span>&nbsp;<span class="op" id="3492955">&amp;&amp;</span>&nbsp;<span class="ident" id="3492958">r</span>&nbsp;<span class="op" id="3492960">&lt;=</span>&nbsp;<span class="string" id="3492963">&#39;Z&#39;</span><span class="op" id="3492966">)</span>&nbsp;<span class="op" id="3492968">||</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3492973">(</span><span class="string" id="3492974">&#39;a&#39;</span>&nbsp;<span class="op" id="3492978">&lt;=</span>&nbsp;<span class="ident" id="3492981">r</span>&nbsp;<span class="op" id="3492983">&amp;&amp;</span>&nbsp;<span class="ident" id="3492986">r</span>&nbsp;<span class="op" id="3492988">&lt;=</span>&nbsp;<span class="string" id="3492991">&#39;z&#39;</span><span class="op" id="3492994">)</span>&nbsp;<span class="op" id="3492996">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3493001">(</span><span class="string" id="3493002">&#39;0&#39;</span>&nbsp;<span class="op" id="3493006">&lt;=</span>&nbsp;<span class="ident" id="3493009">r</span>&nbsp;<span class="op" id="3493011">&amp;&amp;</span>&nbsp;<span class="ident" id="3493014">r</span>&nbsp;<span class="op" id="3493016">&lt;=</span>&nbsp;<span class="string" id="3493019">&#39;9&#39;</span><span class="op" id="3493022">)</span><br>
<span class="lineno"></span><span class="op" id="3493024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3493027">//&nbsp;MatchEmptyWidth&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;instruction&nbsp;matches</span><br>
<span class="lineno">260</span><span class="comment" id="3493086">//&nbsp;an&nbsp;empty&nbsp;string&nbsp;between&nbsp;the&nbsp;runes&nbsp;before&nbsp;and&nbsp;after.</span><br>
<span class="lineno"></span><span class="comment" id="3493141">//&nbsp;It&nbsp;should&nbsp;only&nbsp;be&nbsp;called&nbsp;when&nbsp;i.Op&nbsp;==&nbsp;InstEmptyWidth.</span><br>
<span class="lineno"></span><span class="keyword" id="3493198">func</span>&nbsp;<span class="op" id="3493203">(</span><span class="ident" id="3493204">i</span>&nbsp;<span class="op" id="3493206">*</span><span class="ident" id="3493207">Inst</span><span class="op" id="3493211">)</span>&nbsp;<span class="ident" id="3493213">MatchEmptyWidth</span><span class="op" id="3493228">(</span><span class="ident" id="3493229">before</span>&nbsp;<span class="builtintype" id="3493236">rune</span><span class="op" id="3493240">,</span>&nbsp;<span class="ident" id="3493242">after</span>&nbsp;<span class="builtintype" id="3493248">rune</span><span class="op" id="3493252">)</span>&nbsp;<span class="builtintype" id="3493254">bool</span>&nbsp;<span class="op" id="3493259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493262">switch</span>&nbsp;<span class="ident" id="3493269">EmptyOp</span><span class="op" id="3493276">(</span><span class="ident" id="3493277">i</span><span class="op" id="3493278">.</span><span class="ident" id="3493279">Arg</span><span class="op" id="3493282">)</span>&nbsp;<span class="op" id="3493284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493287">case</span>&nbsp;<span class="ident" id="3493292">EmptyBeginLine</span><span class="op" id="3493306">:</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493310">return</span>&nbsp;<span class="ident" id="3493317">before</span>&nbsp;<span class="op" id="3493324">==</span>&nbsp;<span class="string" id="3493327">&#39;\n&#39;</span>&nbsp;<span class="op" id="3493332">||</span>&nbsp;<span class="ident" id="3493335">before</span>&nbsp;<span class="op" id="3493342">==</span>&nbsp;<span class="op" id="3493345">-</span><span class="num" id="3493346">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493349">case</span>&nbsp;<span class="ident" id="3493354">EmptyEndLine</span><span class="op" id="3493366">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493370">return</span>&nbsp;<span class="ident" id="3493377">after</span>&nbsp;<span class="op" id="3493383">==</span>&nbsp;<span class="string" id="3493386">&#39;\n&#39;</span>&nbsp;<span class="op" id="3493391">||</span>&nbsp;<span class="ident" id="3493394">after</span>&nbsp;<span class="op" id="3493400">==</span>&nbsp;<span class="op" id="3493403">-</span><span class="num" id="3493404">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493407">case</span>&nbsp;<span class="ident" id="3493412">EmptyBeginText</span><span class="op" id="3493426">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493430">return</span>&nbsp;<span class="ident" id="3493437">before</span>&nbsp;<span class="op" id="3493444">==</span>&nbsp;<span class="op" id="3493447">-</span><span class="num" id="3493448">1</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493451">case</span>&nbsp;<span class="ident" id="3493456">EmptyEndText</span><span class="op" id="3493468">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493472">return</span>&nbsp;<span class="ident" id="3493479">after</span>&nbsp;<span class="op" id="3493485">==</span>&nbsp;<span class="op" id="3493488">-</span><span class="num" id="3493489">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493492">case</span>&nbsp;<span class="ident" id="3493497">EmptyWordBoundary</span><span class="op" id="3493514">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493518">return</span>&nbsp;<span class="ident" id="3493525">wordRune</span><span class="op" id="3493533">(</span><span class="ident" id="3493534">before</span><span class="op" id="3493540">)</span>&nbsp;<span class="op" id="3493542">!=</span>&nbsp;<span class="ident" id="3493545">wordRune</span><span class="op" id="3493553">(</span><span class="ident" id="3493554">after</span><span class="op" id="3493559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493562">case</span>&nbsp;<span class="ident" id="3493567">EmptyNoWordBoundary</span><span class="op" id="3493586">:</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493590">return</span>&nbsp;<span class="ident" id="3493597">wordRune</span><span class="op" id="3493605">(</span><span class="ident" id="3493606">before</span><span class="op" id="3493612">)</span>&nbsp;<span class="op" id="3493614">==</span>&nbsp;<span class="ident" id="3493617">wordRune</span><span class="op" id="3493625">(</span><span class="ident" id="3493626">after</span><span class="op" id="3493631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3493634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3493637">panic</span><span class="op" id="3493642">(</span><span class="string" id="3493643">&#34;unknown&nbsp;empty&nbsp;width&nbsp;arg&#34;</span><span class="op" id="3493668">)</span><br>
<span class="lineno"></span><span class="op" id="3493670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="3493673">func</span>&nbsp;<span class="op" id="3493678">(</span><span class="ident" id="3493679">i</span>&nbsp;<span class="op" id="3493681">*</span><span class="ident" id="3493682">Inst</span><span class="op" id="3493686">)</span>&nbsp;<span class="ident" id="3493688">String</span><span class="op" id="3493694">(</span><span class="op" id="3493695">)</span>&nbsp;<span class="builtintype" id="3493697">string</span>&nbsp;<span class="op" id="3493704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493707">var</span>&nbsp;<span class="ident" id="3493711">b</span>&nbsp;<span class="ident" id="3493713">bytes</span><span class="op" id="3493718">.</span><span class="ident" id="3493719">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3493727">dumpInst</span><span class="op" id="3493735">(</span><span class="op" id="3493736">&amp;</span><span class="ident" id="3493737">b</span><span class="op" id="3493738">,</span>&nbsp;<span class="ident" id="3493740">i</span><span class="op" id="3493741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493744">return</span>&nbsp;<span class="ident" id="3493751">b</span><span class="op" id="3493752">.</span><span class="ident" id="3493753">String</span><span class="op" id="3493759">(</span><span class="op" id="3493760">)</span><br>
<span class="lineno"></span><span class="op" id="3493762">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="keyword" id="3493765">func</span>&nbsp;<span class="ident" id="3493770">bw</span><span class="op" id="3493772">(</span><span class="ident" id="3493773">b</span>&nbsp;<span class="op" id="3493775">*</span><span class="ident" id="3493776">bytes</span><span class="op" id="3493781">.</span><span class="ident" id="3493782">Buffer</span><span class="op" id="3493788">,</span>&nbsp;<span class="ident" id="3493790">args</span>&nbsp;<span class="op" id="3493795">...</span><span class="builtintype" id="3493798">string</span><span class="op" id="3493804">)</span>&nbsp;<span class="op" id="3493806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493809">for</span>&nbsp;<span class="ident" id="3493813">_</span><span class="op" id="3493814">,</span>&nbsp;<span class="ident" id="3493816">s</span>&nbsp;<span class="op" id="3493818">:=</span>&nbsp;<span class="keyword" id="3493821">range</span>&nbsp;<span class="ident" id="3493827">args</span>&nbsp;<span class="op" id="3493832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3493836">b</span><span class="op" id="3493837">.</span><span class="ident" id="3493838">WriteString</span><span class="op" id="3493849">(</span><span class="ident" id="3493850">s</span><span class="op" id="3493851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3493854">}</span><br>
<span class="lineno">290</span><span class="op" id="3493856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3493859">func</span>&nbsp;<span class="ident" id="3493864">dumpProg</span><span class="op" id="3493872">(</span><span class="ident" id="3493873">b</span>&nbsp;<span class="op" id="3493875">*</span><span class="ident" id="3493876">bytes</span><span class="op" id="3493881">.</span><span class="ident" id="3493882">Buffer</span><span class="op" id="3493888">,</span>&nbsp;<span class="ident" id="3493890">p</span>&nbsp;<span class="op" id="3493892">*</span><span class="ident" id="3493893">Prog</span><span class="op" id="3493897">)</span>&nbsp;<span class="op" id="3493899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493902">for</span>&nbsp;<span class="ident" id="3493906">j</span>&nbsp;<span class="op" id="3493908">:=</span>&nbsp;<span class="keyword" id="3493911">range</span>&nbsp;<span class="ident" id="3493917">p</span><span class="op" id="3493918">.</span><span class="ident" id="3493919">Inst</span>&nbsp;<span class="op" id="3493924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3493928">i</span>&nbsp;<span class="op" id="3493930">:=</span>&nbsp;<span class="op" id="3493933">&amp;</span><span class="ident" id="3493934">p</span><span class="op" id="3493935">.</span><span class="ident" id="3493936">Inst</span><span class="op" id="3493940">[</span><span class="ident" id="3493941">j</span><span class="op" id="3493942">]</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3493946">pc</span>&nbsp;<span class="op" id="3493949">:=</span>&nbsp;<span class="ident" id="3493952">strconv</span><span class="op" id="3493959">.</span><span class="ident" id="3493960">Itoa</span><span class="op" id="3493964">(</span><span class="ident" id="3493965">j</span><span class="op" id="3493966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493970">if</span>&nbsp;<span class="builtinfunc" id="3493973">len</span><span class="op" id="3493976">(</span><span class="ident" id="3493977">pc</span><span class="op" id="3493979">)</span>&nbsp;<span class="op" id="3493981">&lt;</span>&nbsp;<span class="num" id="3493983">3</span>&nbsp;<span class="op" id="3493985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3493990">b</span><span class="op" id="3493991">.</span><span class="ident" id="3493992">WriteString</span><span class="op" id="3494003">(</span><span class="string" id="3494004">&#34;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="3494009">[</span><span class="builtinfunc" id="3494010">len</span><span class="op" id="3494013">(</span><span class="ident" id="3494014">pc</span><span class="op" id="3494016">)</span><span class="op" id="3494017">:</span><span class="op" id="3494018">]</span><span class="op" id="3494019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3494023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3494027">if</span>&nbsp;<span class="ident" id="3494030">j</span>&nbsp;<span class="op" id="3494032">==</span>&nbsp;<span class="ident" id="3494035">p</span><span class="op" id="3494036">.</span><span class="ident" id="3494037">Start</span>&nbsp;<span class="op" id="3494043">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3494048">pc</span>&nbsp;<span class="op" id="3494051">+=</span>&nbsp;<span class="string" id="3494054">&#34;*&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3494060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3494064">bw</span><span class="op" id="3494066">(</span><span class="ident" id="3494067">b</span><span class="op" id="3494068">,</span>&nbsp;<span class="ident" id="3494070">pc</span><span class="op" id="3494072">,</span>&nbsp;<span class="string" id="3494074">&#34;\t&#34;</span><span class="op" id="3494078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3494082">dumpInst</span><span class="op" id="3494090">(</span><span class="ident" id="3494091">b</span><span class="op" id="3494092">,</span>&nbsp;<span class="ident" id="3494094">i</span><span class="op" id="3494095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3494099">bw</span><span class="op" id="3494101">(</span><span class="ident" id="3494102">b</span><span class="op" id="3494103">,</span>&nbsp;<span class="string" id="3494105">&#34;\n&#34;</span><span class="op" id="3494109">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3494112">}</span><br>
<span class="lineno"></span><span class="op" id="3494114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3494117">func</span>&nbsp;<span class="ident" id="3494122">u32</span><span class="op" id="3494125">(</span><span class="ident" id="3494126">i</span>&nbsp;<span class="builtintype" id="3494128">uint32</span><span class="op" id="3494134">)</span>&nbsp;<span class="builtintype" id="3494136">string</span>&nbsp;<span class="op" id="3494143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3494146">return</span>&nbsp;<span class="ident" id="3494153">strconv</span><span class="op" id="3494160">.</span><span class="ident" id="3494161">FormatUint</span><span class="op" id="3494171">(</span><span class="ident" id="3494172">uint64</span><span class="op" id="3494178">(</span><span class="ident" id="3494179">i</span><span class="op" id="3494180">)</span><span class="op" id="3494181">,</span>&nbsp;<span class="num" id="3494183">10</span><span class="op" id="3494185">)</span><br>
<span class="lineno">310</span><span class="op" id="3494187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3494190">func</span>&nbsp;<span class="ident" id="3494195">dumpInst</span><span class="op" id="3494203">(</span><span class="ident" id="3494204">b</span>&nbsp;<span class="op" id="3494206">*</span><span class="ident" id="3494207">bytes</span><span class="op" id="3494212">.</span><span class="ident" id="3494213">Buffer</span><span class="op" id="3494219">,</span>&nbsp;<span class="ident" id="3494221">i</span>&nbsp;<span class="op" id="3494223">*</span><span class="ident" id="3494224">Inst</span><span class="op" id="3494228">)</span>&nbsp;<span class="op" id="3494230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3494233">switch</span>&nbsp;<span class="ident" id="3494240">i</span><span class="op" id="3494241">.</span><span class="ident" id="3494242">Op</span>&nbsp;<span class="op" id="3494245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3494248">case</span>&nbsp;<span class="ident" id="3494253">InstAlt</span><span class="op" id="3494260">:</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3494264">bw</span><span class="op" id="3494266">(</span><span class="ident" id="3494267">b</span><span class="op" id="3494268">,</span>&nbsp;<span class="string" id="3494270">&#34;alt&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="3494279">,</span>&nbsp;<span class="ident" id="3494281">u32</span><span class="op" id="3494284">(</span><span class="ident" id="3494285">i</span><span class="op" id="3494286">.</span><span class="ident" id="3494287">Out</span><span class="op" id="3494290">)</span><span class="op" id="3494291">,</span>&nbsp;<span class="string" id="3494293">&#34;,&nbsp;&#34;</span><span class="op" id="3494297">,</span>&nbsp;<span class="ident" id="3494299">u32</span><span class="op" id="3494302">(</span><span class="ident" id="3494303">i</span><span class="op" id="3494304">.</span><span class="ident" id="3494305">Arg</span><span class="op" id="3494308">)</span><span class="op" id="3494309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3494312">case</span>&nbsp;<span class="ident" id="3494317">InstAltMatch</span><span class="op" id="3494329">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3494333">bw</span><span class="op" id="3494335">(</span><span class="ident" id="3494336">b</span><span class="op" id="3494337">,</span>&nbsp;<span class="string" id="3494339">&#34;altmatch&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="3494353">,</span>&nbsp;<span class="ident" id="3494355">u32</span><span class="op" id="3494358">(</span><span class="ident" id="3494359">i</span><span class="op" id="3494360">.</span><span class="ident" id="3494361">Out</span><span class="op" id="3494364">)</span><span class="op" id="3494365">,</span>&nbsp;<span class="string" id="3494367">&#34;,&nbsp;&#34;</span><span class="op" id="3494371">,</span>&nbsp;<span class="ident" id="3494373">u32</span><span class="op" id="3494376">(</span><span class="ident" id="3494377">i</span><span class="op" id="3494378">.</span><span class="ident" id="3494379">Arg</span><span class="op" id="3494382">)</span><span class="op" id="3494383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3494386">case</span>&nbsp;<span class="ident" id="3494391">InstCapture</span><span class="op" id="3494402">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3494406">bw</span><span class="op" id="3494408">(</span><span class="ident" id="3494409">b</span><span class="op" id="3494410">,</span>&nbsp;<span class="string" id="3494412">&#34;cap&nbsp;&#34;</span><span class="op" id="3494418">,</span>&nbsp;<span class="ident" id="3494420">u32</span><span class="op" id="3494423">(</span><span class="ident" id="3494424">i</span><span class="op" id="3494425">.</span><span class="ident" id="3494426">Arg</span><span class="op" id="3494429">)</span><span class="op" id="3494430">,</span>&nbsp;<span class="string" id="3494432">&#34;&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="3494438">,</span>&nbsp;<span class="ident" id="3494440">u32</span><span class="op" id="3494443">(</span><span class="ident" id="3494444">i</span><span class="op" id="3494445">.</span><span class="ident" id="3494446">Out</span><span class="op" id="3494449">)</span><span class="op" id="3494450">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3494453">case</span>&nbsp;<span class="ident" id="3494458">InstEmptyWidth</span><span class="op" id="3494472">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3494476">bw</span><span class="op" id="3494478">(</span><span class="ident" id="3494479">b</span><span class="op" id="3494480">,</span>&nbsp;<span class="string" id="3494482">&#34;empty&nbsp;&#34;</span><span class="op" id="3494490">,</span>&nbsp;<span class="ident" id="3494492">u32</span><span class="op" id="3494495">(</span><span class="ident" id="3494496">i</span><span class="op" id="3494497">.</span><span class="ident" id="3494498">Arg</span><span class="op" id="3494501">)</span><span class="op" id="3494502">,</span>&nbsp;<span class="string" id="3494504">&#34;&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="3494510">,</span>&nbsp;<span class="ident" id="3494512">u32</span><span class="op" id="3494515">(</span><span class="ident" id="3494516">i</span><span class="op" id="3494517">.</span><span class="ident" id="3494518">Out</span><span class="op" id="3494521">)</span><span class="op" id="3494522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3494525">case</span>&nbsp;<span class="ident" id="3494530">InstMatch</span><span class="op" id="3494539">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3494543">bw</span><span class="op" id="3494545">(</span><span class="ident" id="3494546">b</span><span class="op" id="3494547">,</span>&nbsp;<span class="string" id="3494549">&#34;match&#34;</span><span class="op" id="3494556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3494559">case</span>&nbsp;<span class="ident" id="3494564">InstFail</span><span class="op" id="3494572">:</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3494576">bw</span><span class="op" id="3494578">(</span><span class="ident" id="3494579">b</span><span class="op" id="3494580">,</span>&nbsp;<span class="string" id="3494582">&#34;fail&#34;</span><span class="op" id="3494588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3494591">case</span>&nbsp;<span class="ident" id="3494596">InstNop</span><span class="op" id="3494603">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3494607">bw</span><span class="op" id="3494609">(</span><span class="ident" id="3494610">b</span><span class="op" id="3494611">,</span>&nbsp;<span class="string" id="3494613">&#34;nop&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="3494622">,</span>&nbsp;<span class="ident" id="3494624">u32</span><span class="op" id="3494627">(</span><span class="ident" id="3494628">i</span><span class="op" id="3494629">.</span><span class="ident" id="3494630">Out</span><span class="op" id="3494633">)</span><span class="op" id="3494634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3494637">case</span>&nbsp;<span class="ident" id="3494642">InstRune</span><span class="op" id="3494650">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3494654">if</span>&nbsp;<span class="ident" id="3494657">i</span><span class="op" id="3494658">.</span><span class="ident" id="3494659">Rune</span>&nbsp;<span class="op" id="3494664">==</span>&nbsp;<span class="ident" id="3494667">nil</span>&nbsp;<span class="op" id="3494671">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3494676">//&nbsp;shouldn&#39;t&nbsp;happen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3494699">bw</span><span class="op" id="3494701">(</span><span class="ident" id="3494702">b</span><span class="op" id="3494703">,</span>&nbsp;<span class="string" id="3494705">&#34;rune&nbsp;&lt;nil&gt;&#34;</span><span class="op" id="3494717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3494721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3494725">bw</span><span class="op" id="3494727">(</span><span class="ident" id="3494728">b</span><span class="op" id="3494729">,</span>&nbsp;<span class="string" id="3494731">&#34;rune&nbsp;&#34;</span><span class="op" id="3494738">,</span>&nbsp;<span class="ident" id="3494740">strconv</span><span class="op" id="3494747">.</span><span class="ident" id="3494748">QuoteToASCII</span><span class="op" id="3494760">(</span><span class="builtintype" id="3494761">string</span><span class="op" id="3494767">(</span><span class="ident" id="3494768">i</span><span class="op" id="3494769">.</span><span class="ident" id="3494770">Rune</span><span class="op" id="3494774">)</span><span class="op" id="3494775">)</span><span class="op" id="3494776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3494780">if</span>&nbsp;<span class="ident" id="3494783">Flags</span><span class="op" id="3494788">(</span><span class="ident" id="3494789">i</span><span class="op" id="3494790">.</span><span class="ident" id="3494791">Arg</span><span class="op" id="3494794">)</span><span class="op" id="3494795">&amp;</span><span class="ident" id="3494796">FoldCase</span>&nbsp;<span class="op" id="3494805">!=</span>&nbsp;<span class="num" id="3494808">0</span>&nbsp;<span class="op" id="3494810">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3494815">bw</span><span class="op" id="3494817">(</span><span class="ident" id="3494818">b</span><span class="op" id="3494819">,</span>&nbsp;<span class="string" id="3494821">&#34;/i&#34;</span><span class="op" id="3494825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3494829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3494833">bw</span><span class="op" id="3494835">(</span><span class="ident" id="3494836">b</span><span class="op" id="3494837">,</span>&nbsp;<span class="string" id="3494839">&#34;&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="3494845">,</span>&nbsp;<span class="ident" id="3494847">u32</span><span class="op" id="3494850">(</span><span class="ident" id="3494851">i</span><span class="op" id="3494852">.</span><span class="ident" id="3494853">Out</span><span class="op" id="3494856">)</span><span class="op" id="3494857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3494860">case</span>&nbsp;<span class="ident" id="3494865">InstRune1</span><span class="op" id="3494874">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3494878">bw</span><span class="op" id="3494880">(</span><span class="ident" id="3494881">b</span><span class="op" id="3494882">,</span>&nbsp;<span class="string" id="3494884">&#34;rune1&nbsp;&#34;</span><span class="op" id="3494892">,</span>&nbsp;<span class="ident" id="3494894">strconv</span><span class="op" id="3494901">.</span><span class="ident" id="3494902">QuoteToASCII</span><span class="op" id="3494914">(</span><span class="builtintype" id="3494915">string</span><span class="op" id="3494921">(</span><span class="ident" id="3494922">i</span><span class="op" id="3494923">.</span><span class="ident" id="3494924">Rune</span><span class="op" id="3494928">)</span><span class="op" id="3494929">)</span><span class="op" id="3494930">,</span>&nbsp;<span class="string" id="3494932">&#34;&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="3494938">,</span>&nbsp;<span class="ident" id="3494940">u32</span><span class="op" id="3494943">(</span><span class="ident" id="3494944">i</span><span class="op" id="3494945">.</span><span class="ident" id="3494946">Out</span><span class="op" id="3494949">)</span><span class="op" id="3494950">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3494953">case</span>&nbsp;<span class="ident" id="3494958">InstRuneAny</span><span class="op" id="3494969">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3494973">bw</span><span class="op" id="3494975">(</span><span class="ident" id="3494976">b</span><span class="op" id="3494977">,</span>&nbsp;<span class="string" id="3494979">&#34;any&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="3494988">,</span>&nbsp;<span class="ident" id="3494990">u32</span><span class="op" id="3494993">(</span><span class="ident" id="3494994">i</span><span class="op" id="3494995">.</span><span class="ident" id="3494996">Out</span><span class="op" id="3494999">)</span><span class="op" id="3495000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3495003">case</span>&nbsp;<span class="ident" id="3495008">InstRuneAnyNotNL</span><span class="op" id="3495024">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3495028">bw</span><span class="op" id="3495030">(</span><span class="ident" id="3495031">b</span><span class="op" id="3495032">,</span>&nbsp;<span class="string" id="3495034">&#34;anynotnl&nbsp;-&gt;&nbsp;&#34;</span><span class="op" id="3495048">,</span>&nbsp;<span class="ident" id="3495050">u32</span><span class="op" id="3495053">(</span><span class="ident" id="3495054">i</span><span class="op" id="3495055">.</span><span class="ident" id="3495056">Out</span><span class="op" id="3495059">)</span><span class="op" id="3495060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3495063">}</span><br>
<span class="lineno">345</span><span class="op" id="3495065">}</span>
</div>
</body>
</html>
