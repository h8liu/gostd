<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html" class="current">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2171903">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2171958">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2172012">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2172063">package</span>&nbsp;<span class="ident" id="2172071">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2172077">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;first&nbsp;and&nbsp;second&nbsp;kinds&nbsp;of&nbsp;order&nbsp;n.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2172143">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2172197">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_jn.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2172248">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2172303">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2172333">//</span><br>
<span class="lineno"></span><span class="comment" id="2172336">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2172392">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2172461">//</span><br>
<span class="lineno"></span><span class="comment" id="2172464">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="2172523">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2172579">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2172636">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2172653">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2172709">//</span><br>
<span class="lineno">25</span><span class="comment" id="2172712">//&nbsp;__ieee754_jn(n,&nbsp;x),&nbsp;__ieee754_yn(n,&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="2172754">//&nbsp;floating&nbsp;point&nbsp;Bessel&#39;s&nbsp;function&nbsp;of&nbsp;the&nbsp;1st&nbsp;and&nbsp;2nd&nbsp;kind</span><br>
<span class="lineno"></span><span class="comment" id="2172814">//&nbsp;of&nbsp;order&nbsp;n</span><br>
<span class="lineno"></span><span class="comment" id="2172828">//</span><br>
<span class="lineno"></span><span class="comment" id="2172831">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno">30</span><span class="comment" id="2172849">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y0(0)=y1(0)=yn(n,0)&nbsp;=&nbsp;-inf&nbsp;with&nbsp;division&nbsp;by&nbsp;zero&nbsp;signal;</span><br>
<span class="lineno"></span><span class="comment" id="2172914">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y0(-ve)=y1(-ve)=yn(n,-ve)&nbsp;are&nbsp;NaN&nbsp;with&nbsp;invalid&nbsp;signal.</span><br>
<span class="lineno"></span><span class="comment" id="2172977">//&nbsp;Note&nbsp;2.&nbsp;About&nbsp;jn(n,x),&nbsp;yn(n,x)</span><br>
<span class="lineno"></span><span class="comment" id="2173011">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;n=0,&nbsp;j0(x)&nbsp;is&nbsp;called,</span><br>
<span class="lineno"></span><span class="comment" id="2173045">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n=1,&nbsp;j1(x)&nbsp;is&nbsp;called,</span><br>
<span class="lineno">35</span><span class="comment" id="2173079">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n&lt;x,&nbsp;forward&nbsp;recursion&nbsp;is&nbsp;used&nbsp;starting</span><br>
<span class="lineno"></span><span class="comment" id="2173131">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;values&nbsp;of&nbsp;j0(x)&nbsp;and&nbsp;j1(x).</span><br>
<span class="lineno"></span><span class="comment" id="2173171">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;n&gt;x,&nbsp;a&nbsp;continued&nbsp;fraction&nbsp;approximation&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2173226">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j(n,x)/j(n-1,x)&nbsp;is&nbsp;evaluated&nbsp;and&nbsp;then&nbsp;backward</span><br>
<span class="lineno"></span><span class="comment" id="2173281">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recursion&nbsp;is&nbsp;used&nbsp;starting&nbsp;from&nbsp;a&nbsp;supposed&nbsp;value</span><br>
<span class="lineno">40</span><span class="comment" id="2173338">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j(n,x).&nbsp;The&nbsp;resulting&nbsp;value&nbsp;of&nbsp;j(0,x)&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2173391">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compared&nbsp;with&nbsp;the&nbsp;actual&nbsp;value&nbsp;to&nbsp;correct&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2173445">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;supposed&nbsp;value&nbsp;of&nbsp;j(n,x).</span><br>
<span class="lineno"></span><span class="comment" id="2173479">//</span><br>
<span class="lineno"></span><span class="comment" id="2173482">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yn(n,x)&nbsp;is&nbsp;similar&nbsp;in&nbsp;all&nbsp;respects,&nbsp;except</span><br>
<span class="lineno">45</span><span class="comment" id="2173533">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;forward&nbsp;recursion&nbsp;is&nbsp;used&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2173580">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values&nbsp;of&nbsp;n&gt;1.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2173604">//&nbsp;Jn&nbsp;returns&nbsp;the&nbsp;order-n&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;first&nbsp;kind.</span><br>
<span class="lineno"></span><span class="comment" id="2173665">//</span><br>
<span class="lineno">50</span><span class="comment" id="2173668">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2173690">//&nbsp;&nbsp;&nbsp;&nbsp;Jn(n,&nbsp;Â±Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2173710">//&nbsp;&nbsp;&nbsp;&nbsp;Jn(n,&nbsp;NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2173730">func</span>&nbsp;<span class="ident" id="2173735">Jn</span><span class="op" id="2173737">(</span><span class="ident" id="2173738">n</span>&nbsp;<span class="builtintype" id="2173740">int</span><span class="op" id="2173743">,</span>&nbsp;<span class="ident" id="2173745">x</span>&nbsp;<span class="builtintype" id="2173747">float64</span><span class="op" id="2173754">)</span>&nbsp;<span class="builtintype" id="2173756">float64</span>&nbsp;<span class="op" id="2173764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2173767">const</span>&nbsp;<span class="op" id="2173773">(</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2173777">TwoM29</span>&nbsp;<span class="op" id="2173784">=</span>&nbsp;<span class="num" id="2173786">1.0</span>&nbsp;<span class="op" id="2173790">/</span>&nbsp;<span class="op" id="2173792">(</span><span class="num" id="2173793">1</span>&nbsp;<span class="op" id="2173795">&lt;&lt;</span>&nbsp;<span class="num" id="2173798">29</span><span class="op" id="2173800">)</span>&nbsp;<span class="comment" id="2173802">//&nbsp;2**-29&nbsp;0x3e10000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2173833">Two302</span>&nbsp;<span class="op" id="2173840">=</span>&nbsp;<span class="num" id="2173842">1</span>&nbsp;<span class="op" id="2173844">&lt;&lt;</span>&nbsp;<span class="num" id="2173847">302</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2173858">//&nbsp;2**302&nbsp;0x52D0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2173888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2173891">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2173909">switch</span>&nbsp;<span class="op" id="2173916">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2173919">case</span>&nbsp;<span class="ident" id="2173924">IsNaN</span><span class="op" id="2173929">(</span><span class="ident" id="2173930">x</span><span class="op" id="2173931">)</span><span class="op" id="2173932">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2173936">return</span>&nbsp;<span class="ident" id="2173943">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2173946">case</span>&nbsp;<span class="ident" id="2173951">IsInf</span><span class="op" id="2173956">(</span><span class="ident" id="2173957">x</span><span class="op" id="2173958">,</span>&nbsp;<span class="num" id="2173960">0</span><span class="op" id="2173961">)</span><span class="op" id="2173962">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2173966">return</span>&nbsp;<span class="num" id="2173973">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2173976">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2173979">//&nbsp;J(-n,&nbsp;x)&nbsp;=&nbsp;(-1)**n&nbsp;*&nbsp;J(n,&nbsp;x),&nbsp;J(n,&nbsp;-x)&nbsp;=&nbsp;(-1)**n&nbsp;*&nbsp;J(n,&nbsp;x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2174042">//&nbsp;Thus,&nbsp;J(-n,&nbsp;x)&nbsp;=&nbsp;J(n,&nbsp;-x)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174073">if</span>&nbsp;<span class="ident" id="2174076">n</span>&nbsp;<span class="op" id="2174078">==</span>&nbsp;<span class="num" id="2174081">0</span>&nbsp;<span class="op" id="2174083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174087">return</span>&nbsp;<span class="ident" id="2174094">J0</span><span class="op" id="2174096">(</span><span class="ident" id="2174097">x</span><span class="op" id="2174098">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2174101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174104">if</span>&nbsp;<span class="ident" id="2174107">x</span>&nbsp;<span class="op" id="2174109">==</span>&nbsp;<span class="num" id="2174112">0</span>&nbsp;<span class="op" id="2174114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174118">return</span>&nbsp;<span class="num" id="2174125">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2174128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174131">if</span>&nbsp;<span class="ident" id="2174134">n</span>&nbsp;<span class="op" id="2174136">&lt;</span>&nbsp;<span class="num" id="2174138">0</span>&nbsp;<span class="op" id="2174140">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2174144">n</span><span class="op" id="2174145">,</span>&nbsp;<span class="ident" id="2174147">x</span>&nbsp;<span class="op" id="2174149">=</span>&nbsp;<span class="op" id="2174151">-</span><span class="ident" id="2174152">n</span><span class="op" id="2174153">,</span>&nbsp;<span class="op" id="2174155">-</span><span class="ident" id="2174156">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2174159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174162">if</span>&nbsp;<span class="ident" id="2174165">n</span>&nbsp;<span class="op" id="2174167">==</span>&nbsp;<span class="num" id="2174170">1</span>&nbsp;<span class="op" id="2174172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174176">return</span>&nbsp;<span class="ident" id="2174183">J1</span><span class="op" id="2174185">(</span><span class="ident" id="2174186">x</span><span class="op" id="2174187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2174190">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2174193">sign</span>&nbsp;<span class="op" id="2174198">:=</span>&nbsp;<span class="builtintype" id="2174201">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174208">if</span>&nbsp;<span class="ident" id="2174211">x</span>&nbsp;<span class="op" id="2174213">&lt;</span>&nbsp;<span class="num" id="2174215">0</span>&nbsp;<span class="op" id="2174217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2174221">x</span>&nbsp;<span class="op" id="2174223">=</span>&nbsp;<span class="op" id="2174225">-</span><span class="ident" id="2174226">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174230">if</span>&nbsp;<span class="ident" id="2174233">n</span><span class="op" id="2174234">&amp;</span><span class="num" id="2174235">1</span>&nbsp;<span class="op" id="2174237">==</span>&nbsp;<span class="num" id="2174240">1</span>&nbsp;<span class="op" id="2174242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2174247">sign</span>&nbsp;<span class="op" id="2174252">=</span>&nbsp;<span class="builtintype" id="2174254">true</span>&nbsp;<span class="comment" id="2174259">//&nbsp;odd&nbsp;n&nbsp;and&nbsp;negative&nbsp;x</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2174285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2174288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174291">var</span>&nbsp;<span class="ident" id="2174295">b</span>&nbsp;<span class="builtintype" id="2174297">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174306">if</span>&nbsp;<span class="builtintype" id="2174309">float64</span><span class="op" id="2174316">(</span><span class="ident" id="2174317">n</span><span class="op" id="2174318">)</span>&nbsp;<span class="op" id="2174320">&lt;=</span>&nbsp;<span class="ident" id="2174323">x</span>&nbsp;<span class="op" id="2174325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2174329">//&nbsp;Safe&nbsp;to&nbsp;use&nbsp;J(n+1,x)=2n/x&nbsp;*J(n,x)-J(n-1,x)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174377">if</span>&nbsp;<span class="ident" id="2174380">x</span>&nbsp;<span class="op" id="2174382">&gt;=</span>&nbsp;<span class="ident" id="2174385">Two302</span>&nbsp;<span class="op" id="2174392">{</span>&nbsp;<span class="comment" id="2174394">//&nbsp;x&nbsp;&gt;&nbsp;2**302</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2174412">//&nbsp;(x&nbsp;&gt;&gt;&nbsp;n**2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2174430">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jn(x)&nbsp;=&nbsp;cos(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2174485">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Yn(x)&nbsp;=&nbsp;sin(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2174540">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;s=sin(x),&nbsp;c=cos(x),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2174579">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xn=x-(2n+1)*pi/4,&nbsp;sqt2&nbsp;=&nbsp;sqrt(2),then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2174636">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2174642">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbsp;sin(xn)*sqt2&nbsp;&nbsp;&nbsp;&nbsp;cos(xn)*sqt2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2174698">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------------------------------</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2174752">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2174800">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;-s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2174848">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;-s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c-s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2174896">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c-s</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174945">var</span>&nbsp;<span class="ident" id="2174949">temp</span>&nbsp;<span class="builtintype" id="2174954">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174965">switch</span>&nbsp;<span class="ident" id="2174972">n</span>&nbsp;<span class="op" id="2174974">&amp;</span>&nbsp;<span class="num" id="2174976">3</span>&nbsp;<span class="op" id="2174978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2174983">case</span>&nbsp;<span class="num" id="2174988">0</span><span class="op" id="2174989">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2174995">temp</span>&nbsp;<span class="op" id="2175000">=</span>&nbsp;<span class="ident" id="2175002">Cos</span><span class="op" id="2175005">(</span><span class="ident" id="2175006">x</span><span class="op" id="2175007">)</span>&nbsp;<span class="op" id="2175009">+</span>&nbsp;<span class="ident" id="2175011">Sin</span><span class="op" id="2175014">(</span><span class="ident" id="2175015">x</span><span class="op" id="2175016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2175021">case</span>&nbsp;<span class="num" id="2175026">1</span><span class="op" id="2175027">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2175033">temp</span>&nbsp;<span class="op" id="2175038">=</span>&nbsp;<span class="op" id="2175040">-</span><span class="ident" id="2175041">Cos</span><span class="op" id="2175044">(</span><span class="ident" id="2175045">x</span><span class="op" id="2175046">)</span>&nbsp;<span class="op" id="2175048">+</span>&nbsp;<span class="ident" id="2175050">Sin</span><span class="op" id="2175053">(</span><span class="ident" id="2175054">x</span><span class="op" id="2175055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2175060">case</span>&nbsp;<span class="num" id="2175065">2</span><span class="op" id="2175066">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2175072">temp</span>&nbsp;<span class="op" id="2175077">=</span>&nbsp;<span class="op" id="2175079">-</span><span class="ident" id="2175080">Cos</span><span class="op" id="2175083">(</span><span class="ident" id="2175084">x</span><span class="op" id="2175085">)</span>&nbsp;<span class="op" id="2175087">-</span>&nbsp;<span class="ident" id="2175089">Sin</span><span class="op" id="2175092">(</span><span class="ident" id="2175093">x</span><span class="op" id="2175094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2175099">case</span>&nbsp;<span class="num" id="2175104">3</span><span class="op" id="2175105">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2175111">temp</span>&nbsp;<span class="op" id="2175116">=</span>&nbsp;<span class="ident" id="2175118">Cos</span><span class="op" id="2175121">(</span><span class="ident" id="2175122">x</span><span class="op" id="2175123">)</span>&nbsp;<span class="op" id="2175125">-</span>&nbsp;<span class="ident" id="2175127">Sin</span><span class="op" id="2175130">(</span><span class="ident" id="2175131">x</span><span class="op" id="2175132">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2175137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2175142">b</span>&nbsp;<span class="op" id="2175144">=</span>&nbsp;<span class="op" id="2175146">(</span><span class="num" id="2175147">1</span>&nbsp;<span class="op" id="2175149">/</span>&nbsp;<span class="ident" id="2175151">SqrtPi</span><span class="op" id="2175157">)</span>&nbsp;<span class="op" id="2175159">*</span>&nbsp;<span class="ident" id="2175161">temp</span>&nbsp;<span class="op" id="2175166">/</span>&nbsp;<span class="ident" id="2175168">Sqrt</span><span class="op" id="2175172">(</span><span class="ident" id="2175173">x</span><span class="op" id="2175174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2175178">}</span>&nbsp;<span class="keyword" id="2175180">else</span>&nbsp;<span class="op" id="2175185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2175190">b</span>&nbsp;<span class="op" id="2175192">=</span>&nbsp;<span class="ident" id="2175194">J1</span><span class="op" id="2175196">(</span><span class="ident" id="2175197">x</span><span class="op" id="2175198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2175203">for</span>&nbsp;<span class="ident" id="2175207">i</span><span class="op" id="2175208">,</span>&nbsp;<span class="ident" id="2175210">a</span>&nbsp;<span class="op" id="2175212">:=</span>&nbsp;<span class="num" id="2175215">1</span><span class="op" id="2175216">,</span>&nbsp;<span class="ident" id="2175218">J0</span><span class="op" id="2175220">(</span><span class="ident" id="2175221">x</span><span class="op" id="2175222">)</span><span class="op" id="2175223">;</span>&nbsp;<span class="ident" id="2175225">i</span>&nbsp;<span class="op" id="2175227">&lt;</span>&nbsp;<span class="ident" id="2175229">n</span><span class="op" id="2175230">;</span>&nbsp;<span class="ident" id="2175232">i</span><span class="op" id="2175233">++</span>&nbsp;<span class="op" id="2175236">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2175242">a</span><span class="op" id="2175243">,</span>&nbsp;<span class="ident" id="2175245">b</span>&nbsp;<span class="op" id="2175247">=</span>&nbsp;<span class="ident" id="2175249">b</span><span class="op" id="2175250">,</span>&nbsp;<span class="ident" id="2175252">b</span><span class="op" id="2175253">*</span><span class="op" id="2175254">(</span><span class="builtintype" id="2175255">float64</span><span class="op" id="2175262">(</span><span class="ident" id="2175263">i</span><span class="op" id="2175264">+</span><span class="ident" id="2175265">i</span><span class="op" id="2175266">)</span><span class="op" id="2175267">/</span><span class="ident" id="2175268">x</span><span class="op" id="2175269">)</span><span class="op" id="2175270">-</span><span class="ident" id="2175271">a</span>&nbsp;<span class="comment" id="2175273">//&nbsp;avoid&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2175295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2175299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2175302">}</span>&nbsp;<span class="keyword" id="2175304">else</span>&nbsp;<span class="op" id="2175309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2175313">if</span>&nbsp;<span class="ident" id="2175316">x</span>&nbsp;<span class="op" id="2175318">&lt;</span>&nbsp;<span class="ident" id="2175320">TwoM29</span>&nbsp;<span class="op" id="2175327">{</span>&nbsp;<span class="comment" id="2175329">//&nbsp;x&nbsp;&lt;&nbsp;2**-29</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2175346">//&nbsp;x&nbsp;is&nbsp;tiny,&nbsp;return&nbsp;the&nbsp;first&nbsp;Taylor&nbsp;expansion&nbsp;of&nbsp;J(n,x)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2175407">//&nbsp;J(n,x)&nbsp;=&nbsp;1/n!*(x/2)**n&nbsp;&nbsp;-&nbsp;...</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2175444">if</span>&nbsp;<span class="ident" id="2175447">n</span>&nbsp;<span class="op" id="2175449">&gt;</span>&nbsp;<span class="num" id="2175451">33</span>&nbsp;<span class="op" id="2175454">{</span>&nbsp;<span class="comment" id="2175456">//&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2175473">b</span>&nbsp;<span class="op" id="2175475">=</span>&nbsp;<span class="num" id="2175477">0</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2175482">}</span>&nbsp;<span class="keyword" id="2175484">else</span>&nbsp;<span class="op" id="2175489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2175495">temp</span>&nbsp;<span class="op" id="2175500">:=</span>&nbsp;<span class="ident" id="2175503">x</span>&nbsp;<span class="op" id="2175505">*</span>&nbsp;<span class="num" id="2175507">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2175515">b</span>&nbsp;<span class="op" id="2175517">=</span>&nbsp;<span class="ident" id="2175519">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2175528">a</span>&nbsp;<span class="op" id="2175530">:=</span>&nbsp;<span class="num" id="2175533">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2175541">for</span>&nbsp;<span class="ident" id="2175545">i</span>&nbsp;<span class="op" id="2175547">:=</span>&nbsp;<span class="num" id="2175550">2</span><span class="op" id="2175551">;</span>&nbsp;<span class="ident" id="2175553">i</span>&nbsp;<span class="op" id="2175555">&lt;=</span>&nbsp;<span class="ident" id="2175558">n</span><span class="op" id="2175559">;</span>&nbsp;<span class="ident" id="2175561">i</span><span class="op" id="2175562">++</span>&nbsp;<span class="op" id="2175565">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2175572">a</span>&nbsp;<span class="op" id="2175574">*=</span>&nbsp;<span class="builtintype" id="2175577">float64</span><span class="op" id="2175584">(</span><span class="ident" id="2175585">i</span><span class="op" id="2175586">)</span>&nbsp;<span class="comment" id="2175588">//&nbsp;a&nbsp;=&nbsp;n!</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2175603">b</span>&nbsp;<span class="op" id="2175605">*=</span>&nbsp;<span class="ident" id="2175608">temp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2175619">//&nbsp;b&nbsp;=&nbsp;(x/2)**n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2175639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2175645">b</span>&nbsp;<span class="op" id="2175647">/=</span>&nbsp;<span class="ident" id="2175650">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2175655">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2175659">}</span>&nbsp;<span class="keyword" id="2175661">else</span>&nbsp;<span class="op" id="2175666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2175671">//&nbsp;use&nbsp;backward&nbsp;recurrence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2175701">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x**2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x**2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2175750">//&nbsp;&nbsp;J(n,x)/J(n-1,x)&nbsp;=&nbsp;&nbsp;----&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;.....</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2175807">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2n&nbsp;&nbsp;-&nbsp;2(n+1)&nbsp;-&nbsp;2(n+2)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2175856">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2175862">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2175907">//&nbsp;&nbsp;(for&nbsp;large&nbsp;x)&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;----&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;.....</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2175963">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2n&nbsp;&nbsp;&nbsp;2(n+1)&nbsp;&nbsp;&nbsp;2(n+2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2176011">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;-&nbsp;------&nbsp;-&nbsp;------&nbsp;-</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2176061">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2176107">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2176113">//&nbsp;Let&nbsp;w&nbsp;=&nbsp;2n/x&nbsp;and&nbsp;h=2/x,&nbsp;then&nbsp;the&nbsp;above&nbsp;quotient</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2176167">//&nbsp;is&nbsp;equal&nbsp;to&nbsp;the&nbsp;continued&nbsp;fraction:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2176209">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2176234">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;-----------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2176271">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2176299">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;-&nbsp;-----------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2176335">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2176366">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w+h&nbsp;-&nbsp;---------</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2176401">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w+2h&nbsp;-&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2176438">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2176444">//&nbsp;To&nbsp;determine&nbsp;how&nbsp;many&nbsp;terms&nbsp;needed,&nbsp;let</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2176490">//&nbsp;Q(0)&nbsp;=&nbsp;w,&nbsp;Q(1)&nbsp;=&nbsp;w(w+h)&nbsp;-&nbsp;1,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2176525">//&nbsp;Q(k)&nbsp;=&nbsp;(w+k*h)*Q(k-1)&nbsp;-&nbsp;Q(k-2),</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2176563">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e4&nbsp;&nbsp;&nbsp;&nbsp;good&nbsp;for&nbsp;single</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2176601">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e9&nbsp;&nbsp;&nbsp;&nbsp;good&nbsp;for&nbsp;double</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2176639">//&nbsp;When&nbsp;Q(k)&nbsp;&gt;&nbsp;1e17&nbsp;&nbsp;&nbsp;&nbsp;good&nbsp;for&nbsp;quadruple</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2176682">//&nbsp;determine&nbsp;k</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2176700">w</span>&nbsp;<span class="op" id="2176702">:=</span>&nbsp;<span class="builtintype" id="2176705">float64</span><span class="op" id="2176712">(</span><span class="ident" id="2176713">n</span><span class="op" id="2176714">+</span><span class="ident" id="2176715">n</span><span class="op" id="2176716">)</span>&nbsp;<span class="op" id="2176718">/</span>&nbsp;<span class="ident" id="2176720">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2176725">h</span>&nbsp;<span class="op" id="2176727">:=</span>&nbsp;<span class="num" id="2176730">2</span>&nbsp;<span class="op" id="2176732">/</span>&nbsp;<span class="ident" id="2176734">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2176739">q0</span>&nbsp;<span class="op" id="2176742">:=</span>&nbsp;<span class="ident" id="2176745">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2176750">z</span>&nbsp;<span class="op" id="2176752">:=</span>&nbsp;<span class="ident" id="2176755">w</span>&nbsp;<span class="op" id="2176757">+</span>&nbsp;<span class="ident" id="2176759">h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2176764">q1</span>&nbsp;<span class="op" id="2176767">:=</span>&nbsp;<span class="ident" id="2176770">w</span><span class="op" id="2176771">*</span><span class="ident" id="2176772">z</span>&nbsp;<span class="op" id="2176774">-</span>&nbsp;<span class="num" id="2176776">1</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2176781">k</span>&nbsp;<span class="op" id="2176783">:=</span>&nbsp;<span class="num" id="2176786">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2176791">for</span>&nbsp;<span class="ident" id="2176795">q1</span>&nbsp;<span class="op" id="2176798">&lt;</span>&nbsp;<span class="num" id="2176800">1e9</span>&nbsp;<span class="op" id="2176804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2176810">k</span>&nbsp;<span class="op" id="2176812">+=</span>&nbsp;<span class="num" id="2176815">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2176821">z</span>&nbsp;<span class="op" id="2176823">+=</span>&nbsp;<span class="ident" id="2176826">h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2176832">q0</span><span class="op" id="2176834">,</span>&nbsp;<span class="ident" id="2176836">q1</span>&nbsp;<span class="op" id="2176839">=</span>&nbsp;<span class="ident" id="2176841">q1</span><span class="op" id="2176843">,</span>&nbsp;<span class="ident" id="2176845">z</span><span class="op" id="2176846">*</span><span class="ident" id="2176847">q1</span><span class="op" id="2176849">-</span><span class="ident" id="2176850">q0</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2176856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2176861">m</span>&nbsp;<span class="op" id="2176863">:=</span>&nbsp;<span class="ident" id="2176866">n</span>&nbsp;<span class="op" id="2176868">+</span>&nbsp;<span class="ident" id="2176870">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2176875">t</span>&nbsp;<span class="op" id="2176877">:=</span>&nbsp;<span class="num" id="2176880">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2176887">for</span>&nbsp;<span class="ident" id="2176891">i</span>&nbsp;<span class="op" id="2176893">:=</span>&nbsp;<span class="num" id="2176896">2</span>&nbsp;<span class="op" id="2176898">*</span>&nbsp;<span class="op" id="2176900">(</span><span class="ident" id="2176901">n</span>&nbsp;<span class="op" id="2176903">+</span>&nbsp;<span class="ident" id="2176905">k</span><span class="op" id="2176906">)</span><span class="op" id="2176907">;</span>&nbsp;<span class="ident" id="2176909">i</span>&nbsp;<span class="op" id="2176911">&gt;=</span>&nbsp;<span class="ident" id="2176914">m</span><span class="op" id="2176915">;</span>&nbsp;<span class="ident" id="2176917">i</span>&nbsp;<span class="op" id="2176919">-=</span>&nbsp;<span class="num" id="2176922">2</span>&nbsp;<span class="op" id="2176924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2176930">t</span>&nbsp;<span class="op" id="2176932">=</span>&nbsp;<span class="num" id="2176934">1</span>&nbsp;<span class="op" id="2176936">/</span>&nbsp;<span class="op" id="2176938">(</span><span class="builtintype" id="2176939">float64</span><span class="op" id="2176946">(</span><span class="ident" id="2176947">i</span><span class="op" id="2176948">)</span><span class="op" id="2176949">/</span><span class="ident" id="2176950">x</span>&nbsp;<span class="op" id="2176952">-</span>&nbsp;<span class="ident" id="2176954">t</span><span class="op" id="2176955">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2176960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2176965">a</span>&nbsp;<span class="op" id="2176967">:=</span>&nbsp;<span class="ident" id="2176970">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2176975">b</span>&nbsp;<span class="op" id="2176977">=</span>&nbsp;<span class="num" id="2176979">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2176984">//&nbsp;&nbsp;estimate&nbsp;log((2/x)**n*n!)&nbsp;=&nbsp;n*log(2/x)+n*ln(n)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2177038">//&nbsp;&nbsp;Hence,&nbsp;if&nbsp;n*(log(2n/x))&nbsp;&gt;&nbsp;...</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2177075">//&nbsp;&nbsp;single&nbsp;8.8722839355e+01</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2177106">//&nbsp;&nbsp;double&nbsp;7.09782712893383973096e+02</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2177147">//&nbsp;&nbsp;long&nbsp;double&nbsp;1.1356523406294143949491931077970765006170e+04</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2177213">//&nbsp;&nbsp;then&nbsp;recurrent&nbsp;value&nbsp;may&nbsp;overflow&nbsp;and&nbsp;the&nbsp;result&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2177272">//&nbsp;&nbsp;likely&nbsp;underflow&nbsp;to&nbsp;zero</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2177305">tmp</span>&nbsp;<span class="op" id="2177309">:=</span>&nbsp;<span class="builtintype" id="2177312">float64</span><span class="op" id="2177319">(</span><span class="ident" id="2177320">n</span><span class="op" id="2177321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2177326">v</span>&nbsp;<span class="op" id="2177328">:=</span>&nbsp;<span class="num" id="2177331">2</span>&nbsp;<span class="op" id="2177333">/</span>&nbsp;<span class="ident" id="2177335">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2177340">tmp</span>&nbsp;<span class="op" id="2177344">=</span>&nbsp;<span class="ident" id="2177346">tmp</span>&nbsp;<span class="op" id="2177350">*</span>&nbsp;<span class="ident" id="2177352">Log</span><span class="op" id="2177355">(</span><span class="ident" id="2177356">Abs</span><span class="op" id="2177359">(</span><span class="ident" id="2177360">v</span><span class="op" id="2177361">*</span><span class="ident" id="2177362">tmp</span><span class="op" id="2177365">)</span><span class="op" id="2177366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2177371">if</span>&nbsp;<span class="ident" id="2177374">tmp</span>&nbsp;<span class="op" id="2177378">&lt;</span>&nbsp;<span class="num" id="2177380">7.09782712893383973096e+02</span>&nbsp;<span class="op" id="2177407">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2177413">for</span>&nbsp;<span class="ident" id="2177417">i</span>&nbsp;<span class="op" id="2177419">:=</span>&nbsp;<span class="ident" id="2177422">n</span>&nbsp;<span class="op" id="2177424">-</span>&nbsp;<span class="num" id="2177426">1</span><span class="op" id="2177427">;</span>&nbsp;<span class="ident" id="2177429">i</span>&nbsp;<span class="op" id="2177431">&gt;</span>&nbsp;<span class="num" id="2177433">0</span><span class="op" id="2177434">;</span>&nbsp;<span class="ident" id="2177436">i</span><span class="op" id="2177437">--</span>&nbsp;<span class="op" id="2177440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2177447">di</span>&nbsp;<span class="op" id="2177450">:=</span>&nbsp;<span class="builtintype" id="2177453">float64</span><span class="op" id="2177460">(</span><span class="ident" id="2177461">i</span>&nbsp;<span class="op" id="2177463">+</span>&nbsp;<span class="ident" id="2177465">i</span><span class="op" id="2177466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2177473">a</span><span class="op" id="2177474">,</span>&nbsp;<span class="ident" id="2177476">b</span>&nbsp;<span class="op" id="2177478">=</span>&nbsp;<span class="ident" id="2177480">b</span><span class="op" id="2177481">,</span>&nbsp;<span class="ident" id="2177483">b</span><span class="op" id="2177484">*</span><span class="ident" id="2177485">di</span><span class="op" id="2177487">/</span><span class="ident" id="2177488">x</span><span class="op" id="2177489">-</span><span class="ident" id="2177490">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2177497">di</span>&nbsp;<span class="op" id="2177500">-=</span>&nbsp;<span class="num" id="2177503">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2177509">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2177514">}</span>&nbsp;<span class="keyword" id="2177516">else</span>&nbsp;<span class="op" id="2177521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2177527">for</span>&nbsp;<span class="ident" id="2177531">i</span>&nbsp;<span class="op" id="2177533">:=</span>&nbsp;<span class="ident" id="2177536">n</span>&nbsp;<span class="op" id="2177538">-</span>&nbsp;<span class="num" id="2177540">1</span><span class="op" id="2177541">;</span>&nbsp;<span class="ident" id="2177543">i</span>&nbsp;<span class="op" id="2177545">&gt;</span>&nbsp;<span class="num" id="2177547">0</span><span class="op" id="2177548">;</span>&nbsp;<span class="ident" id="2177550">i</span><span class="op" id="2177551">--</span>&nbsp;<span class="op" id="2177554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2177561">di</span>&nbsp;<span class="op" id="2177564">:=</span>&nbsp;<span class="builtintype" id="2177567">float64</span><span class="op" id="2177574">(</span><span class="ident" id="2177575">i</span>&nbsp;<span class="op" id="2177577">+</span>&nbsp;<span class="ident" id="2177579">i</span><span class="op" id="2177580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2177587">a</span><span class="op" id="2177588">,</span>&nbsp;<span class="ident" id="2177590">b</span>&nbsp;<span class="op" id="2177592">=</span>&nbsp;<span class="ident" id="2177594">b</span><span class="op" id="2177595">,</span>&nbsp;<span class="ident" id="2177597">b</span><span class="op" id="2177598">*</span><span class="ident" id="2177599">di</span><span class="op" id="2177601">/</span><span class="ident" id="2177602">x</span><span class="op" id="2177603">-</span><span class="ident" id="2177604">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2177611">di</span>&nbsp;<span class="op" id="2177614">-=</span>&nbsp;<span class="num" id="2177617">2</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2177624">//&nbsp;scale&nbsp;b&nbsp;to&nbsp;avoid&nbsp;spurious&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2177667">if</span>&nbsp;<span class="ident" id="2177670">b</span>&nbsp;<span class="op" id="2177672">&gt;</span>&nbsp;<span class="num" id="2177674">1e100</span>&nbsp;<span class="op" id="2177680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2177688">a</span>&nbsp;<span class="op" id="2177690">/=</span>&nbsp;<span class="ident" id="2177693">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2177701">t</span>&nbsp;<span class="op" id="2177703">/=</span>&nbsp;<span class="ident" id="2177706">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2177714">b</span>&nbsp;<span class="op" id="2177716">=</span>&nbsp;<span class="num" id="2177718">1</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2177725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2177731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2177736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2177741">b</span>&nbsp;<span class="op" id="2177743">=</span>&nbsp;<span class="ident" id="2177745">t</span>&nbsp;<span class="op" id="2177747">*</span>&nbsp;<span class="ident" id="2177749">J0</span><span class="op" id="2177751">(</span><span class="ident" id="2177752">x</span><span class="op" id="2177753">)</span>&nbsp;<span class="op" id="2177755">/</span>&nbsp;<span class="ident" id="2177757">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2177761">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2177764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2177767">if</span>&nbsp;<span class="ident" id="2177770">sign</span>&nbsp;<span class="op" id="2177775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2177779">return</span>&nbsp;<span class="op" id="2177786">-</span><span class="ident" id="2177787">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2177790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2177793">return</span>&nbsp;<span class="ident" id="2177800">b</span><br>
<span class="lineno">225</span><span class="op" id="2177802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2177805">//&nbsp;Yn&nbsp;returns&nbsp;the&nbsp;order-n&nbsp;Bessel&nbsp;function&nbsp;of&nbsp;the&nbsp;second&nbsp;kind.</span><br>
<span class="lineno"></span><span class="comment" id="2177867">//</span><br>
<span class="lineno"></span><span class="comment" id="2177870">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">230</span><span class="comment" id="2177892">//&nbsp;&nbsp;&nbsp;&nbsp;Yn(n,&nbsp;+Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2177911">//&nbsp;&nbsp;&nbsp;&nbsp;Yn(n&nbsp;&gt;&nbsp;0,&nbsp;0)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2177934">//&nbsp;&nbsp;&nbsp;&nbsp;Yn(n&nbsp;&lt;&nbsp;0,&nbsp;0)&nbsp;=&nbsp;+Inf&nbsp;if&nbsp;n&nbsp;is&nbsp;odd,&nbsp;-Inf&nbsp;if&nbsp;n&nbsp;is&nbsp;even</span><br>
<span class="lineno"></span><span class="comment" id="2177988">//&nbsp;&nbsp;&nbsp;&nbsp;Y1(n,&nbsp;x&nbsp;&lt;&nbsp;0)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2178010">//&nbsp;&nbsp;&nbsp;&nbsp;Y1(n,&nbsp;NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">235</span><span class="keyword" id="2178030">func</span>&nbsp;<span class="ident" id="2178035">Yn</span><span class="op" id="2178037">(</span><span class="ident" id="2178038">n</span>&nbsp;<span class="builtintype" id="2178040">int</span><span class="op" id="2178043">,</span>&nbsp;<span class="ident" id="2178045">x</span>&nbsp;<span class="builtintype" id="2178047">float64</span><span class="op" id="2178054">)</span>&nbsp;<span class="builtintype" id="2178056">float64</span>&nbsp;<span class="op" id="2178064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2178067">const</span>&nbsp;<span class="ident" id="2178073">Two302</span>&nbsp;<span class="op" id="2178080">=</span>&nbsp;<span class="num" id="2178082">1</span>&nbsp;<span class="op" id="2178084">&lt;&lt;</span>&nbsp;<span class="num" id="2178087">302</span>&nbsp;<span class="comment" id="2178091">//&nbsp;2**302&nbsp;0x52D0000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2178121">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2178139">switch</span>&nbsp;<span class="op" id="2178146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2178149">case</span>&nbsp;<span class="ident" id="2178154">x</span>&nbsp;<span class="op" id="2178156">&lt;</span>&nbsp;<span class="num" id="2178158">0</span>&nbsp;<span class="op" id="2178160">||</span>&nbsp;<span class="ident" id="2178163">IsNaN</span><span class="op" id="2178168">(</span><span class="ident" id="2178169">x</span><span class="op" id="2178170">)</span><span class="op" id="2178171">:</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2178175">return</span>&nbsp;<span class="ident" id="2178182">NaN</span><span class="op" id="2178185">(</span><span class="op" id="2178186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2178189">case</span>&nbsp;<span class="ident" id="2178194">IsInf</span><span class="op" id="2178199">(</span><span class="ident" id="2178200">x</span><span class="op" id="2178201">,</span>&nbsp;<span class="num" id="2178203">1</span><span class="op" id="2178204">)</span><span class="op" id="2178205">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2178209">return</span>&nbsp;<span class="num" id="2178216">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2178219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2178223">if</span>&nbsp;<span class="ident" id="2178226">n</span>&nbsp;<span class="op" id="2178228">==</span>&nbsp;<span class="num" id="2178231">0</span>&nbsp;<span class="op" id="2178233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2178237">return</span>&nbsp;<span class="ident" id="2178244">Y0</span><span class="op" id="2178246">(</span><span class="ident" id="2178247">x</span><span class="op" id="2178248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2178251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2178254">if</span>&nbsp;<span class="ident" id="2178257">x</span>&nbsp;<span class="op" id="2178259">==</span>&nbsp;<span class="num" id="2178262">0</span>&nbsp;<span class="op" id="2178264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2178268">if</span>&nbsp;<span class="ident" id="2178271">n</span>&nbsp;<span class="op" id="2178273">&lt;</span>&nbsp;<span class="num" id="2178275">0</span>&nbsp;<span class="op" id="2178277">&amp;&amp;</span>&nbsp;<span class="ident" id="2178280">n</span><span class="op" id="2178281">&amp;</span><span class="num" id="2178282">1</span>&nbsp;<span class="op" id="2178284">==</span>&nbsp;<span class="num" id="2178287">1</span>&nbsp;<span class="op" id="2178289">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2178294">return</span>&nbsp;<span class="ident" id="2178301">Inf</span><span class="op" id="2178304">(</span><span class="num" id="2178305">1</span><span class="op" id="2178306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2178310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2178314">return</span>&nbsp;<span class="ident" id="2178321">Inf</span><span class="op" id="2178324">(</span><span class="op" id="2178325">-</span><span class="num" id="2178326">1</span><span class="op" id="2178327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2178330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2178333">sign</span>&nbsp;<span class="op" id="2178338">:=</span>&nbsp;<span class="builtintype" id="2178341">false</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2178348">if</span>&nbsp;<span class="ident" id="2178351">n</span>&nbsp;<span class="op" id="2178353">&lt;</span>&nbsp;<span class="num" id="2178355">0</span>&nbsp;<span class="op" id="2178357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2178361">n</span>&nbsp;<span class="op" id="2178363">=</span>&nbsp;<span class="op" id="2178365">-</span><span class="ident" id="2178366">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2178370">if</span>&nbsp;<span class="ident" id="2178373">n</span><span class="op" id="2178374">&amp;</span><span class="num" id="2178375">1</span>&nbsp;<span class="op" id="2178377">==</span>&nbsp;<span class="num" id="2178380">1</span>&nbsp;<span class="op" id="2178382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2178387">sign</span>&nbsp;<span class="op" id="2178392">=</span>&nbsp;<span class="builtintype" id="2178394">true</span>&nbsp;<span class="comment" id="2178399">//&nbsp;sign&nbsp;true&nbsp;if&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;&amp;&amp;&nbsp;|n|&nbsp;odd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2178434">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2178437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2178440">if</span>&nbsp;<span class="ident" id="2178443">n</span>&nbsp;<span class="op" id="2178445">==</span>&nbsp;<span class="num" id="2178448">1</span>&nbsp;<span class="op" id="2178450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2178454">if</span>&nbsp;<span class="ident" id="2178457">sign</span>&nbsp;<span class="op" id="2178462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2178467">return</span>&nbsp;<span class="op" id="2178474">-</span><span class="ident" id="2178475">Y1</span><span class="op" id="2178477">(</span><span class="ident" id="2178478">x</span><span class="op" id="2178479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2178483">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2178487">return</span>&nbsp;<span class="ident" id="2178494">Y1</span><span class="op" id="2178496">(</span><span class="ident" id="2178497">x</span><span class="op" id="2178498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2178501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2178504">var</span>&nbsp;<span class="ident" id="2178508">b</span>&nbsp;<span class="builtintype" id="2178510">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2178519">if</span>&nbsp;<span class="ident" id="2178522">x</span>&nbsp;<span class="op" id="2178524">&gt;=</span>&nbsp;<span class="ident" id="2178527">Two302</span>&nbsp;<span class="op" id="2178534">{</span>&nbsp;<span class="comment" id="2178536">//&nbsp;x&nbsp;&gt;&nbsp;2**302</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2178552">//&nbsp;(x&nbsp;&gt;&gt;&nbsp;n**2)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2178569">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jn(x)&nbsp;=&nbsp;cos(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2178618">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Yn(x)&nbsp;=&nbsp;sin(x-(2n+1)*pi/4)*sqrt(2/x*pi)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2178667">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;s=sin(x),&nbsp;c=cos(x),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2178700">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xn=x-(2n+1)*pi/4,&nbsp;sqt2&nbsp;=&nbsp;sqrt(2),then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2178744">//</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2178749">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;&nbsp;sin(xn)*sqt2&nbsp;&nbsp;&nbsp;&nbsp;cos(xn)*sqt2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2178786">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------------------------------</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2178827">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2178849">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;-s-c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c+s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2178872">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;-s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-c-s</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2178894">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s+c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c-s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2178917">var</span>&nbsp;<span class="ident" id="2178921">temp</span>&nbsp;<span class="builtintype" id="2178926">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2178936">switch</span>&nbsp;<span class="ident" id="2178943">n</span>&nbsp;<span class="op" id="2178945">&amp;</span>&nbsp;<span class="num" id="2178947">3</span>&nbsp;<span class="op" id="2178949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2178953">case</span>&nbsp;<span class="num" id="2178958">0</span><span class="op" id="2178959">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2178964">temp</span>&nbsp;<span class="op" id="2178969">=</span>&nbsp;<span class="ident" id="2178971">Sin</span><span class="op" id="2178974">(</span><span class="ident" id="2178975">x</span><span class="op" id="2178976">)</span>&nbsp;<span class="op" id="2178978">-</span>&nbsp;<span class="ident" id="2178980">Cos</span><span class="op" id="2178983">(</span><span class="ident" id="2178984">x</span><span class="op" id="2178985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2178989">case</span>&nbsp;<span class="num" id="2178994">1</span><span class="op" id="2178995">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2179000">temp</span>&nbsp;<span class="op" id="2179005">=</span>&nbsp;<span class="op" id="2179007">-</span><span class="ident" id="2179008">Sin</span><span class="op" id="2179011">(</span><span class="ident" id="2179012">x</span><span class="op" id="2179013">)</span>&nbsp;<span class="op" id="2179015">-</span>&nbsp;<span class="ident" id="2179017">Cos</span><span class="op" id="2179020">(</span><span class="ident" id="2179021">x</span><span class="op" id="2179022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179026">case</span>&nbsp;<span class="num" id="2179031">2</span><span class="op" id="2179032">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2179037">temp</span>&nbsp;<span class="op" id="2179042">=</span>&nbsp;<span class="op" id="2179044">-</span><span class="ident" id="2179045">Sin</span><span class="op" id="2179048">(</span><span class="ident" id="2179049">x</span><span class="op" id="2179050">)</span>&nbsp;<span class="op" id="2179052">+</span>&nbsp;<span class="ident" id="2179054">Cos</span><span class="op" id="2179057">(</span><span class="ident" id="2179058">x</span><span class="op" id="2179059">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179063">case</span>&nbsp;<span class="num" id="2179068">3</span><span class="op" id="2179069">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2179074">temp</span>&nbsp;<span class="op" id="2179079">=</span>&nbsp;<span class="ident" id="2179081">Sin</span><span class="op" id="2179084">(</span><span class="ident" id="2179085">x</span><span class="op" id="2179086">)</span>&nbsp;<span class="op" id="2179088">+</span>&nbsp;<span class="ident" id="2179090">Cos</span><span class="op" id="2179093">(</span><span class="ident" id="2179094">x</span><span class="op" id="2179095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2179099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2179103">b</span>&nbsp;<span class="op" id="2179105">=</span>&nbsp;<span class="op" id="2179107">(</span><span class="num" id="2179108">1</span>&nbsp;<span class="op" id="2179110">/</span>&nbsp;<span class="ident" id="2179112">SqrtPi</span><span class="op" id="2179118">)</span>&nbsp;<span class="op" id="2179120">*</span>&nbsp;<span class="ident" id="2179122">temp</span>&nbsp;<span class="op" id="2179127">/</span>&nbsp;<span class="ident" id="2179129">Sqrt</span><span class="op" id="2179133">(</span><span class="ident" id="2179134">x</span><span class="op" id="2179135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2179138">}</span>&nbsp;<span class="keyword" id="2179140">else</span>&nbsp;<span class="op" id="2179145">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2179149">a</span>&nbsp;<span class="op" id="2179151">:=</span>&nbsp;<span class="ident" id="2179154">Y0</span><span class="op" id="2179156">(</span><span class="ident" id="2179157">x</span><span class="op" id="2179158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2179162">b</span>&nbsp;<span class="op" id="2179164">=</span>&nbsp;<span class="ident" id="2179166">Y1</span><span class="op" id="2179168">(</span><span class="ident" id="2179169">x</span><span class="op" id="2179170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2179174">//&nbsp;quit&nbsp;if&nbsp;b&nbsp;is&nbsp;-inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179197">for</span>&nbsp;<span class="ident" id="2179201">i</span>&nbsp;<span class="op" id="2179203">:=</span>&nbsp;<span class="num" id="2179206">1</span><span class="op" id="2179207">;</span>&nbsp;<span class="ident" id="2179209">i</span>&nbsp;<span class="op" id="2179211">&lt;</span>&nbsp;<span class="ident" id="2179213">n</span>&nbsp;<span class="op" id="2179215">&amp;&amp;</span>&nbsp;<span class="op" id="2179218">!</span><span class="ident" id="2179219">IsInf</span><span class="op" id="2179224">(</span><span class="ident" id="2179225">b</span><span class="op" id="2179226">,</span>&nbsp;<span class="op" id="2179228">-</span><span class="num" id="2179229">1</span><span class="op" id="2179230">)</span><span class="op" id="2179231">;</span>&nbsp;<span class="ident" id="2179233">i</span><span class="op" id="2179234">++</span>&nbsp;<span class="op" id="2179237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2179242">a</span><span class="op" id="2179243">,</span>&nbsp;<span class="ident" id="2179245">b</span>&nbsp;<span class="op" id="2179247">=</span>&nbsp;<span class="ident" id="2179249">b</span><span class="op" id="2179250">,</span>&nbsp;<span class="op" id="2179252">(</span><span class="builtintype" id="2179253">float64</span><span class="op" id="2179260">(</span><span class="ident" id="2179261">i</span><span class="op" id="2179262">+</span><span class="ident" id="2179263">i</span><span class="op" id="2179264">)</span><span class="op" id="2179265">/</span><span class="ident" id="2179266">x</span><span class="op" id="2179267">)</span><span class="op" id="2179268">*</span><span class="ident" id="2179269">b</span><span class="op" id="2179270">-</span><span class="ident" id="2179271">a</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2179275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2179278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179281">if</span>&nbsp;<span class="ident" id="2179284">sign</span>&nbsp;<span class="op" id="2179289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179293">return</span>&nbsp;<span class="op" id="2179300">-</span><span class="ident" id="2179301">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2179304">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2179307">return</span>&nbsp;<span class="ident" id="2179314">b</span><br>
<span class="lineno"></span><span class="op" id="2179316">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
