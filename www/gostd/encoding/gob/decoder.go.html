<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/gob</h2>
<ul>
<li><a href="/gostd/encoding/gob/codec_test.go.html">codec_test.go</a></li>
<li><a href="/gostd/encoding/gob/dec_helpers.go.html">dec_helpers.go</a></li>
<li><a href="/gostd/encoding/gob/decode.go.html">decode.go</a></li>
<li><a href="/gostd/encoding/gob/decoder.go.html" class="current">decoder.go</a></li>
<li><a href="/gostd/encoding/gob/doc.go.html">doc.go</a></li>
<li><a href="/gostd/encoding/gob/enc_helpers.go.html">enc_helpers.go</a></li>
<li><a href="/gostd/encoding/gob/encode.go.html">encode.go</a></li>
<li><a href="/gostd/encoding/gob/encoder.go.html">encoder.go</a></li>
<li><a href="/gostd/encoding/gob/encoder_test.go.html">encoder_test.go</a></li>
<li><a href="/gostd/encoding/gob/error.go.html">error.go</a></li>
<li><a href="/gostd/encoding/gob/example_encdec_test.go.html">example_encdec_test.go</a></li>
<li><a href="/gostd/encoding/gob/example_interface_test.go.html">example_interface_test.go</a></li>
<li><a href="/gostd/encoding/gob/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/gob/gobencdec_test.go.html">gobencdec_test.go</a></li>
<li><a href="/gostd/encoding/gob/timing_test.go.html">timing_test.go</a></li>
<li><a href="/gostd/encoding/gob/type.go.html">type.go</a></li>
<li><a href="/gostd/encoding/gob/type_test.go.html">type_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5512175">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5512230">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5512284">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5512335">package</span>&nbsp;<span class="ident" id="5512343">gob</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5512348">import</span>&nbsp;<span class="op" id="5512355">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5512358">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5512367">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5512377">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5512383">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5512394">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="5512401">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="5512404">//&nbsp;tooBig&nbsp;provides&nbsp;a&nbsp;sanity&nbsp;check&nbsp;for&nbsp;sizes;&nbsp;used&nbsp;in&nbsp;several&nbsp;places.</span><br>
<span class="lineno"></span><span class="comment" id="5512473">//&nbsp;Upper&nbsp;limit&nbsp;of&nbsp;1GB,&nbsp;allowing&nbsp;room&nbsp;to&nbsp;grow&nbsp;a&nbsp;little&nbsp;without&nbsp;overflow.</span><br>
<span class="lineno"></span><span class="comment" id="5512545">//&nbsp;TODO:&nbsp;make&nbsp;this&nbsp;adjustable?</span><br>
<span class="lineno"></span><span class="keyword" id="5512576">const</span>&nbsp;<span class="ident" id="5512582">tooBig</span>&nbsp;<span class="op" id="5512589">=</span>&nbsp;<span class="num" id="5512591">1</span>&nbsp;<span class="op" id="5512593">&lt;&lt;</span>&nbsp;<span class="num" id="5512596">30</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="5512600">//&nbsp;A&nbsp;Decoder&nbsp;manages&nbsp;the&nbsp;receipt&nbsp;of&nbsp;type&nbsp;and&nbsp;data&nbsp;information&nbsp;read&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5512676">//&nbsp;remote&nbsp;side&nbsp;of&nbsp;a&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="5512708">type</span>&nbsp;<span class="ident" id="5512713">Decoder</span>&nbsp;<span class="keyword" id="5512721">struct</span>&nbsp;<span class="op" id="5512728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5512731">mutex</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5512744">sync</span><span class="op" id="5512748">.</span><span class="ident" id="5512749">Mutex</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5512784">//&nbsp;each&nbsp;item&nbsp;must&nbsp;be&nbsp;received&nbsp;atomically</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5512826">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5512839">io</span><span class="op" id="5512841">.</span><span class="ident" id="5512842">Reader</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5512879">//&nbsp;source&nbsp;of&nbsp;the&nbsp;data</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5512902">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5512915">decBuffer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5512955">//&nbsp;buffer&nbsp;for&nbsp;more&nbsp;efficient&nbsp;i/o&nbsp;from&nbsp;r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5512996">wireType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5513009">map</span><span class="op" id="5513012">[</span><span class="ident" id="5513013">typeId</span><span class="op" id="5513019">]</span><span class="op" id="5513020">*</span><span class="ident" id="5513021">wireType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5513049">//&nbsp;map&nbsp;from&nbsp;remote&nbsp;ID&nbsp;to&nbsp;local&nbsp;description</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5513093">decoderCache</span>&nbsp;<span class="keyword" id="5513106">map</span><span class="op" id="5513109">[</span><span class="ident" id="5513110">reflect</span><span class="op" id="5513117">.</span><span class="ident" id="5513118">Type</span><span class="op" id="5513122">]</span><span class="keyword" id="5513123">map</span><span class="op" id="5513126">[</span><span class="ident" id="5513127">typeId</span><span class="op" id="5513133">]</span><span class="op" id="5513134">*</span><span class="op" id="5513135">*</span><span class="ident" id="5513136">decEngine</span>&nbsp;<span class="comment" id="5513146">//&nbsp;cache&nbsp;of&nbsp;compiled&nbsp;engines</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5513176">ignorerCache</span>&nbsp;<span class="keyword" id="5513189">map</span><span class="op" id="5513192">[</span><span class="ident" id="5513193">typeId</span><span class="op" id="5513199">]</span><span class="op" id="5513200">*</span><span class="op" id="5513201">*</span><span class="ident" id="5513202">decEngine</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5513229">//&nbsp;ditto&nbsp;for&nbsp;ignored&nbsp;objects</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5513259">freeList</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5513272">*</span><span class="ident" id="5513273">decoderState</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5513312">//&nbsp;list&nbsp;of&nbsp;free&nbsp;decoderStates;&nbsp;avoids&nbsp;reallocation</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5513364">countBuf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5513377">[</span><span class="op" id="5513378">]</span><span class="builtintype" id="5513379">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5513417">//&nbsp;used&nbsp;for&nbsp;decoding&nbsp;integers&nbsp;while&nbsp;parsing&nbsp;messages</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5513471">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5513484">error</span><br>
<span class="lineno"></span><span class="op" id="5513490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5513493">//&nbsp;NewDecoder&nbsp;returns&nbsp;a&nbsp;new&nbsp;decoder&nbsp;that&nbsp;reads&nbsp;from&nbsp;the&nbsp;io.Reader.</span><br>
<span class="lineno">35</span><span class="comment" id="5513560">//&nbsp;If&nbsp;r&nbsp;does&nbsp;not&nbsp;also&nbsp;implement&nbsp;io.ByteReader,&nbsp;it&nbsp;will&nbsp;be&nbsp;wrapped&nbsp;in&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5513631">//&nbsp;bufio.Reader.</span><br>
<span class="lineno"></span><span class="keyword" id="5513648">func</span>&nbsp;<span class="ident" id="5513653">NewDecoder</span><span class="op" id="5513663">(</span><span class="ident" id="5513664">r</span>&nbsp;<span class="ident" id="5513666">io</span><span class="op" id="5513668">.</span><span class="ident" id="5513669">Reader</span><span class="op" id="5513675">)</span>&nbsp;<span class="op" id="5513677">*</span><span class="ident" id="5513678">Decoder</span>&nbsp;<span class="op" id="5513686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5513689">dec</span>&nbsp;<span class="op" id="5513693">:=</span>&nbsp;<span class="builtinfunc" id="5513696">new</span><span class="op" id="5513699">(</span><span class="ident" id="5513700">Decoder</span><span class="op" id="5513707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5513710">//&nbsp;We&nbsp;use&nbsp;the&nbsp;ability&nbsp;to&nbsp;read&nbsp;bytes&nbsp;as&nbsp;a&nbsp;plausible&nbsp;surrogate&nbsp;for&nbsp;buffering.</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5513787">if</span>&nbsp;<span class="ident" id="5513790">_</span><span class="op" id="5513791">,</span>&nbsp;<span class="ident" id="5513793">ok</span>&nbsp;<span class="op" id="5513796">:=</span>&nbsp;<span class="ident" id="5513799">r</span><span class="op" id="5513800">.</span><span class="op" id="5513801">(</span><span class="ident" id="5513802">io</span><span class="op" id="5513804">.</span><span class="ident" id="5513805">ByteReader</span><span class="op" id="5513815">)</span><span class="op" id="5513816">;</span>&nbsp;<span class="op" id="5513818">!</span><span class="ident" id="5513819">ok</span>&nbsp;<span class="op" id="5513822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5513826">r</span>&nbsp;<span class="op" id="5513828">=</span>&nbsp;<span class="ident" id="5513830">bufio</span><span class="op" id="5513835">.</span><span class="ident" id="5513836">NewReader</span><span class="op" id="5513845">(</span><span class="ident" id="5513846">r</span><span class="op" id="5513847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5513850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5513853">dec</span><span class="op" id="5513856">.</span><span class="ident" id="5513857">r</span>&nbsp;<span class="op" id="5513859">=</span>&nbsp;<span class="ident" id="5513861">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5513864">dec</span><span class="op" id="5513867">.</span><span class="ident" id="5513868">wireType</span>&nbsp;<span class="op" id="5513877">=</span>&nbsp;<span class="builtinfunc" id="5513879">make</span><span class="op" id="5513883">(</span><span class="keyword" id="5513884">map</span><span class="op" id="5513887">[</span><span class="ident" id="5513888">typeId</span><span class="op" id="5513894">]</span><span class="op" id="5513895">*</span><span class="ident" id="5513896">wireType</span><span class="op" id="5513904">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5513907">dec</span><span class="op" id="5513910">.</span><span class="ident" id="5513911">decoderCache</span>&nbsp;<span class="op" id="5513924">=</span>&nbsp;<span class="builtinfunc" id="5513926">make</span><span class="op" id="5513930">(</span><span class="keyword" id="5513931">map</span><span class="op" id="5513934">[</span><span class="ident" id="5513935">reflect</span><span class="op" id="5513942">.</span><span class="ident" id="5513943">Type</span><span class="op" id="5513947">]</span><span class="keyword" id="5513948">map</span><span class="op" id="5513951">[</span><span class="ident" id="5513952">typeId</span><span class="op" id="5513958">]</span><span class="op" id="5513959">*</span><span class="op" id="5513960">*</span><span class="ident" id="5513961">decEngine</span><span class="op" id="5513970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5513973">dec</span><span class="op" id="5513976">.</span><span class="ident" id="5513977">ignorerCache</span>&nbsp;<span class="op" id="5513990">=</span>&nbsp;<span class="builtinfunc" id="5513992">make</span><span class="op" id="5513996">(</span><span class="keyword" id="5513997">map</span><span class="op" id="5514000">[</span><span class="ident" id="5514001">typeId</span><span class="op" id="5514007">]</span><span class="op" id="5514008">*</span><span class="op" id="5514009">*</span><span class="ident" id="5514010">decEngine</span><span class="op" id="5514019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5514022">dec</span><span class="op" id="5514025">.</span><span class="ident" id="5514026">countBuf</span>&nbsp;<span class="op" id="5514035">=</span>&nbsp;<span class="builtinfunc" id="5514037">make</span><span class="op" id="5514041">(</span><span class="op" id="5514042">[</span><span class="op" id="5514043">]</span><span class="builtintype" id="5514044">byte</span><span class="op" id="5514048">,</span>&nbsp;<span class="num" id="5514050">9</span><span class="op" id="5514051">)</span>&nbsp;<span class="comment" id="5514053">//&nbsp;counts&nbsp;may&nbsp;be&nbsp;uint64s&nbsp;(unlikely!),&nbsp;require&nbsp;9&nbsp;bytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5514109">return</span>&nbsp;<span class="ident" id="5514116">dec</span><br>
<span class="lineno">50</span><span class="op" id="5514120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5514123">//&nbsp;recvType&nbsp;loads&nbsp;the&nbsp;definition&nbsp;of&nbsp;a&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="5514167">func</span>&nbsp;<span class="op" id="5514172">(</span><span class="ident" id="5514173">dec</span>&nbsp;<span class="op" id="5514177">*</span><span class="ident" id="5514178">Decoder</span><span class="op" id="5514185">)</span>&nbsp;<span class="ident" id="5514187">recvType</span><span class="op" id="5514195">(</span><span class="ident" id="5514196">id</span>&nbsp;<span class="ident" id="5514199">typeId</span><span class="op" id="5514205">)</span>&nbsp;<span class="op" id="5514207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5514210">//&nbsp;Have&nbsp;we&nbsp;already&nbsp;seen&nbsp;this&nbsp;type?&nbsp;&nbsp;That&#39;s&nbsp;an&nbsp;error</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5514263">if</span>&nbsp;<span class="ident" id="5514266">id</span>&nbsp;<span class="op" id="5514269">&lt;</span>&nbsp;<span class="ident" id="5514271">firstUserId</span>&nbsp;<span class="op" id="5514283">||</span>&nbsp;<span class="ident" id="5514286">dec</span><span class="op" id="5514289">.</span><span class="ident" id="5514290">wireType</span><span class="op" id="5514298">[</span><span class="ident" id="5514299">id</span><span class="op" id="5514301">]</span>&nbsp;<span class="op" id="5514303">!=</span>&nbsp;<span class="builtintype" id="5514306">nil</span>&nbsp;<span class="op" id="5514310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5514314">dec</span><span class="op" id="5514317">.</span><span class="ident" id="5514318">err</span>&nbsp;<span class="op" id="5514322">=</span>&nbsp;<span class="ident" id="5514324">errors</span><span class="op" id="5514330">.</span><span class="ident" id="5514331">New</span><span class="op" id="5514334">(</span><span class="string" id="5514335">&#34;gob:&nbsp;duplicate&nbsp;type&nbsp;received&#34;</span><span class="op" id="5514365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5514369">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5514377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5514381">//&nbsp;Type:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5514391">wire</span>&nbsp;<span class="op" id="5514396">:=</span>&nbsp;<span class="builtinfunc" id="5514399">new</span><span class="op" id="5514402">(</span><span class="ident" id="5514403">wireType</span><span class="op" id="5514411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5514414">dec</span><span class="op" id="5514417">.</span><span class="ident" id="5514418">decodeValue</span><span class="op" id="5514429">(</span><span class="ident" id="5514430">tWireType</span><span class="op" id="5514439">,</span>&nbsp;<span class="ident" id="5514441">reflect</span><span class="op" id="5514448">.</span><span class="ident" id="5514449">ValueOf</span><span class="op" id="5514456">(</span><span class="ident" id="5514457">wire</span><span class="op" id="5514461">)</span><span class="op" id="5514462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5514465">if</span>&nbsp;<span class="ident" id="5514468">dec</span><span class="op" id="5514471">.</span><span class="ident" id="5514472">err</span>&nbsp;<span class="op" id="5514476">!=</span>&nbsp;<span class="builtintype" id="5514479">nil</span>&nbsp;<span class="op" id="5514483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5514487">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5514495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5514498">//&nbsp;Remember&nbsp;we&#39;ve&nbsp;seen&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5514533">dec</span><span class="op" id="5514536">.</span><span class="ident" id="5514537">wireType</span><span class="op" id="5514545">[</span><span class="ident" id="5514546">id</span><span class="op" id="5514548">]</span>&nbsp;<span class="op" id="5514550">=</span>&nbsp;<span class="ident" id="5514552">wire</span><br>
<span class="lineno"></span><span class="op" id="5514557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="5514560">var</span>&nbsp;<span class="ident" id="5514564">errBadCount</span>&nbsp;<span class="op" id="5514576">=</span>&nbsp;<span class="ident" id="5514578">errors</span><span class="op" id="5514584">.</span><span class="ident" id="5514585">New</span><span class="op" id="5514588">(</span><span class="string" id="5514589">&#34;invalid&nbsp;message&nbsp;length&#34;</span><span class="op" id="5514613">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5514616">//&nbsp;recvMessage&nbsp;reads&nbsp;the&nbsp;next&nbsp;count-delimited&nbsp;item&nbsp;from&nbsp;the&nbsp;input.&nbsp;It&nbsp;is&nbsp;the&nbsp;converse</span><br>
<span class="lineno"></span><span class="comment" id="5514702">//&nbsp;of&nbsp;Encoder.writeMessage.&nbsp;It&nbsp;returns&nbsp;false&nbsp;on&nbsp;EOF&nbsp;or&nbsp;other&nbsp;error&nbsp;reading&nbsp;the&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="5514790">func</span>&nbsp;<span class="op" id="5514795">(</span><span class="ident" id="5514796">dec</span>&nbsp;<span class="op" id="5514800">*</span><span class="ident" id="5514801">Decoder</span><span class="op" id="5514808">)</span>&nbsp;<span class="ident" id="5514810">recvMessage</span><span class="op" id="5514821">(</span><span class="op" id="5514822">)</span>&nbsp;<span class="builtintype" id="5514824">bool</span>&nbsp;<span class="op" id="5514829">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5514832">//&nbsp;Read&nbsp;a&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5514850">nbytes</span><span class="op" id="5514856">,</span>&nbsp;<span class="ident" id="5514858">_</span><span class="op" id="5514859">,</span>&nbsp;<span class="ident" id="5514861">err</span>&nbsp;<span class="op" id="5514865">:=</span>&nbsp;<span class="ident" id="5514868">decodeUintReader</span><span class="op" id="5514884">(</span><span class="ident" id="5514885">dec</span><span class="op" id="5514888">.</span><span class="ident" id="5514889">r</span><span class="op" id="5514890">,</span>&nbsp;<span class="ident" id="5514892">dec</span><span class="op" id="5514895">.</span><span class="ident" id="5514896">countBuf</span><span class="op" id="5514904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5514907">if</span>&nbsp;<span class="ident" id="5514910">err</span>&nbsp;<span class="op" id="5514914">!=</span>&nbsp;<span class="builtintype" id="5514917">nil</span>&nbsp;<span class="op" id="5514921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5514925">dec</span><span class="op" id="5514928">.</span><span class="ident" id="5514929">err</span>&nbsp;<span class="op" id="5514933">=</span>&nbsp;<span class="ident" id="5514935">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5514941">return</span>&nbsp;<span class="builtintype" id="5514948">false</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5514955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5514958">if</span>&nbsp;<span class="ident" id="5514961">nbytes</span>&nbsp;<span class="op" id="5514968">&gt;=</span>&nbsp;<span class="ident" id="5514971">tooBig</span>&nbsp;<span class="op" id="5514978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5514982">dec</span><span class="op" id="5514985">.</span><span class="ident" id="5514986">err</span>&nbsp;<span class="op" id="5514990">=</span>&nbsp;<span class="ident" id="5514992">errBadCount</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5515006">return</span>&nbsp;<span class="builtintype" id="5515013">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5515020">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5515023">dec</span><span class="op" id="5515026">.</span><span class="ident" id="5515027">readMessage</span><span class="op" id="5515038">(</span><span class="builtintype" id="5515039">int</span><span class="op" id="5515042">(</span><span class="ident" id="5515043">nbytes</span><span class="op" id="5515049">)</span><span class="op" id="5515050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5515053">return</span>&nbsp;<span class="ident" id="5515060">dec</span><span class="op" id="5515063">.</span><span class="ident" id="5515064">err</span>&nbsp;<span class="op" id="5515068">==</span>&nbsp;<span class="builtintype" id="5515071">nil</span><br>
<span class="lineno"></span><span class="op" id="5515075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5515078">//&nbsp;readMessage&nbsp;reads&nbsp;the&nbsp;next&nbsp;nbytes&nbsp;bytes&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno">90</span><span class="keyword" id="5515137">func</span>&nbsp;<span class="op" id="5515142">(</span><span class="ident" id="5515143">dec</span>&nbsp;<span class="op" id="5515147">*</span><span class="ident" id="5515148">Decoder</span><span class="op" id="5515155">)</span>&nbsp;<span class="ident" id="5515157">readMessage</span><span class="op" id="5515168">(</span><span class="ident" id="5515169">nbytes</span>&nbsp;<span class="builtintype" id="5515176">int</span><span class="op" id="5515179">)</span>&nbsp;<span class="op" id="5515181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5515184">if</span>&nbsp;<span class="ident" id="5515187">dec</span><span class="op" id="5515190">.</span><span class="ident" id="5515191">buf</span><span class="op" id="5515194">.</span><span class="ident" id="5515195">Len</span><span class="op" id="5515198">(</span><span class="op" id="5515199">)</span>&nbsp;<span class="op" id="5515201">!=</span>&nbsp;<span class="num" id="5515204">0</span>&nbsp;<span class="op" id="5515206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5515210">//&nbsp;The&nbsp;buffer&nbsp;should&nbsp;always&nbsp;be&nbsp;empty&nbsp;now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5515254">panic</span><span class="op" id="5515259">(</span><span class="string" id="5515260">&#34;non-empty&nbsp;decoder&nbsp;buffer&#34;</span><span class="op" id="5515286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5515289">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5515292">//&nbsp;Read&nbsp;the&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5515310">dec</span><span class="op" id="5515313">.</span><span class="ident" id="5515314">buf</span><span class="op" id="5515317">.</span><span class="ident" id="5515318">Size</span><span class="op" id="5515322">(</span><span class="ident" id="5515323">nbytes</span><span class="op" id="5515329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5515332">_</span><span class="op" id="5515333">,</span>&nbsp;<span class="ident" id="5515335">dec</span><span class="op" id="5515338">.</span><span class="ident" id="5515339">err</span>&nbsp;<span class="op" id="5515343">=</span>&nbsp;<span class="ident" id="5515345">io</span><span class="op" id="5515347">.</span><span class="ident" id="5515348">ReadFull</span><span class="op" id="5515356">(</span><span class="ident" id="5515357">dec</span><span class="op" id="5515360">.</span><span class="ident" id="5515361">r</span><span class="op" id="5515362">,</span>&nbsp;<span class="ident" id="5515364">dec</span><span class="op" id="5515367">.</span><span class="ident" id="5515368">buf</span><span class="op" id="5515371">.</span><span class="ident" id="5515372">Bytes</span><span class="op" id="5515377">(</span><span class="op" id="5515378">)</span><span class="op" id="5515379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5515382">if</span>&nbsp;<span class="ident" id="5515385">dec</span><span class="op" id="5515388">.</span><span class="ident" id="5515389">err</span>&nbsp;<span class="op" id="5515393">!=</span>&nbsp;<span class="builtintype" id="5515396">nil</span>&nbsp;<span class="op" id="5515400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5515404">if</span>&nbsp;<span class="ident" id="5515407">dec</span><span class="op" id="5515410">.</span><span class="ident" id="5515411">err</span>&nbsp;<span class="op" id="5515415">==</span>&nbsp;<span class="ident" id="5515418">io</span><span class="op" id="5515420">.</span><span class="ident" id="5515421">EOF</span>&nbsp;<span class="op" id="5515425">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5515430">dec</span><span class="op" id="5515433">.</span><span class="ident" id="5515434">err</span>&nbsp;<span class="op" id="5515438">=</span>&nbsp;<span class="ident" id="5515440">io</span><span class="op" id="5515442">.</span><span class="ident" id="5515443">ErrUnexpectedEOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5515462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5515465">}</span><br>
<span class="lineno"></span><span class="op" id="5515467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="5515470">//&nbsp;toInt&nbsp;turns&nbsp;an&nbsp;encoded&nbsp;uint64&nbsp;into&nbsp;an&nbsp;int,&nbsp;according&nbsp;to&nbsp;the&nbsp;marshaling&nbsp;rules.</span><br>
<span class="lineno"></span><span class="keyword" id="5515551">func</span>&nbsp;<span class="ident" id="5515556">toInt</span><span class="op" id="5515561">(</span><span class="ident" id="5515562">x</span>&nbsp;<span class="ident" id="5515564">uint64</span><span class="op" id="5515570">)</span>&nbsp;<span class="ident" id="5515572">int64</span>&nbsp;<span class="op" id="5515578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5515581">i</span>&nbsp;<span class="op" id="5515583">:=</span>&nbsp;<span class="ident" id="5515586">int64</span><span class="op" id="5515591">(</span><span class="ident" id="5515592">x</span>&nbsp;<span class="op" id="5515594">&gt;&gt;</span>&nbsp;<span class="num" id="5515597">1</span><span class="op" id="5515598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5515601">if</span>&nbsp;<span class="ident" id="5515604">x</span><span class="op" id="5515605">&amp;</span><span class="num" id="5515606">1</span>&nbsp;<span class="op" id="5515608">!=</span>&nbsp;<span class="num" id="5515611">0</span>&nbsp;<span class="op" id="5515613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5515617">i</span>&nbsp;<span class="op" id="5515619">=</span>&nbsp;<span class="op" id="5515621">^</span><span class="ident" id="5515622">i</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5515625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5515628">return</span>&nbsp;<span class="ident" id="5515635">i</span><br>
<span class="lineno"></span><span class="op" id="5515637">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5515640">func</span>&nbsp;<span class="op" id="5515645">(</span><span class="ident" id="5515646">dec</span>&nbsp;<span class="op" id="5515650">*</span><span class="ident" id="5515651">Decoder</span><span class="op" id="5515658">)</span>&nbsp;<span class="ident" id="5515660">nextInt</span><span class="op" id="5515667">(</span><span class="op" id="5515668">)</span>&nbsp;<span class="ident" id="5515670">int64</span>&nbsp;<span class="op" id="5515676">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5515679">n</span><span class="op" id="5515680">,</span>&nbsp;<span class="ident" id="5515682">_</span><span class="op" id="5515683">,</span>&nbsp;<span class="ident" id="5515685">err</span>&nbsp;<span class="op" id="5515689">:=</span>&nbsp;<span class="ident" id="5515692">decodeUintReader</span><span class="op" id="5515708">(</span><span class="op" id="5515709">&amp;</span><span class="ident" id="5515710">dec</span><span class="op" id="5515713">.</span><span class="ident" id="5515714">buf</span><span class="op" id="5515717">,</span>&nbsp;<span class="ident" id="5515719">dec</span><span class="op" id="5515722">.</span><span class="ident" id="5515723">countBuf</span><span class="op" id="5515731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5515734">if</span>&nbsp;<span class="ident" id="5515737">err</span>&nbsp;<span class="op" id="5515741">!=</span>&nbsp;<span class="builtintype" id="5515744">nil</span>&nbsp;<span class="op" id="5515748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5515752">dec</span><span class="op" id="5515755">.</span><span class="ident" id="5515756">err</span>&nbsp;<span class="op" id="5515760">=</span>&nbsp;<span class="ident" id="5515762">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5515767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5515770">return</span>&nbsp;<span class="ident" id="5515777">toInt</span><span class="op" id="5515782">(</span><span class="ident" id="5515783">n</span><span class="op" id="5515784">)</span><br>
<span class="lineno">120</span><span class="op" id="5515786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5515789">func</span>&nbsp;<span class="op" id="5515794">(</span><span class="ident" id="5515795">dec</span>&nbsp;<span class="op" id="5515799">*</span><span class="ident" id="5515800">Decoder</span><span class="op" id="5515807">)</span>&nbsp;<span class="ident" id="5515809">nextUint</span><span class="op" id="5515817">(</span><span class="op" id="5515818">)</span>&nbsp;<span class="ident" id="5515820">uint64</span>&nbsp;<span class="op" id="5515827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5515830">n</span><span class="op" id="5515831">,</span>&nbsp;<span class="ident" id="5515833">_</span><span class="op" id="5515834">,</span>&nbsp;<span class="ident" id="5515836">err</span>&nbsp;<span class="op" id="5515840">:=</span>&nbsp;<span class="ident" id="5515843">decodeUintReader</span><span class="op" id="5515859">(</span><span class="op" id="5515860">&amp;</span><span class="ident" id="5515861">dec</span><span class="op" id="5515864">.</span><span class="ident" id="5515865">buf</span><span class="op" id="5515868">,</span>&nbsp;<span class="ident" id="5515870">dec</span><span class="op" id="5515873">.</span><span class="ident" id="5515874">countBuf</span><span class="op" id="5515882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5515885">if</span>&nbsp;<span class="ident" id="5515888">err</span>&nbsp;<span class="op" id="5515892">!=</span>&nbsp;<span class="builtintype" id="5515895">nil</span>&nbsp;<span class="op" id="5515899">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5515903">dec</span><span class="op" id="5515906">.</span><span class="ident" id="5515907">err</span>&nbsp;<span class="op" id="5515911">=</span>&nbsp;<span class="ident" id="5515913">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5515918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5515921">return</span>&nbsp;<span class="ident" id="5515928">n</span><br>
<span class="lineno"></span><span class="op" id="5515930">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="comment" id="5515933">//&nbsp;decodeTypeSequence&nbsp;parses:</span><br>
<span class="lineno"></span><span class="comment" id="5515963">//&nbsp;TypeSequence</span><br>
<span class="lineno"></span><span class="comment" id="5515979">//&nbsp;&nbsp;&nbsp;&nbsp;(TypeDefinition&nbsp;DelimitedTypeDefinition*)?</span><br>
<span class="lineno"></span><span class="comment" id="5516025">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;type&nbsp;id&nbsp;of&nbsp;the&nbsp;next&nbsp;value.&nbsp;&nbsp;It&nbsp;returns&nbsp;-1&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="5516089">//&nbsp;EOF.&nbsp;&nbsp;Upon&nbsp;return,&nbsp;the&nbsp;remainder&nbsp;of&nbsp;dec.buf&nbsp;is&nbsp;the&nbsp;value&nbsp;to&nbsp;be</span><br>
<span class="lineno">135</span><span class="comment" id="5516155">//&nbsp;decoded.&nbsp;&nbsp;If&nbsp;this&nbsp;is&nbsp;an&nbsp;interface&nbsp;value,&nbsp;it&nbsp;can&nbsp;be&nbsp;ignored&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5516220">//&nbsp;resetting&nbsp;that&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="keyword" id="5516246">func</span>&nbsp;<span class="op" id="5516251">(</span><span class="ident" id="5516252">dec</span>&nbsp;<span class="op" id="5516256">*</span><span class="ident" id="5516257">Decoder</span><span class="op" id="5516264">)</span>&nbsp;<span class="ident" id="5516266">decodeTypeSequence</span><span class="op" id="5516284">(</span><span class="ident" id="5516285">isInterface</span>&nbsp;<span class="builtintype" id="5516297">bool</span><span class="op" id="5516301">)</span>&nbsp;<span class="ident" id="5516303">typeId</span>&nbsp;<span class="op" id="5516310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5516313">for</span>&nbsp;<span class="ident" id="5516317">dec</span><span class="op" id="5516320">.</span><span class="ident" id="5516321">err</span>&nbsp;<span class="op" id="5516325">==</span>&nbsp;<span class="builtintype" id="5516328">nil</span>&nbsp;<span class="op" id="5516332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5516336">if</span>&nbsp;<span class="ident" id="5516339">dec</span><span class="op" id="5516342">.</span><span class="ident" id="5516343">buf</span><span class="op" id="5516346">.</span><span class="ident" id="5516347">Len</span><span class="op" id="5516350">(</span><span class="op" id="5516351">)</span>&nbsp;<span class="op" id="5516353">==</span>&nbsp;<span class="num" id="5516356">0</span>&nbsp;<span class="op" id="5516358">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5516363">if</span>&nbsp;<span class="op" id="5516366">!</span><span class="ident" id="5516367">dec</span><span class="op" id="5516370">.</span><span class="ident" id="5516371">recvMessage</span><span class="op" id="5516382">(</span><span class="op" id="5516383">)</span>&nbsp;<span class="op" id="5516385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5516391">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5516400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5516404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5516408">//&nbsp;Receive&nbsp;a&nbsp;type&nbsp;id.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5516432">id</span>&nbsp;<span class="op" id="5516435">:=</span>&nbsp;<span class="ident" id="5516438">typeId</span><span class="op" id="5516444">(</span><span class="ident" id="5516445">dec</span><span class="op" id="5516448">.</span><span class="ident" id="5516449">nextInt</span><span class="op" id="5516456">(</span><span class="op" id="5516457">)</span><span class="op" id="5516458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5516462">if</span>&nbsp;<span class="ident" id="5516465">id</span>&nbsp;<span class="op" id="5516468">&gt;=</span>&nbsp;<span class="num" id="5516471">0</span>&nbsp;<span class="op" id="5516473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5516478">//&nbsp;Value&nbsp;follows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5516499">return</span>&nbsp;<span class="ident" id="5516506">id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5516511">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5516515">//&nbsp;Type&nbsp;definition&nbsp;for&nbsp;(-id)&nbsp;follows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5516555">dec</span><span class="op" id="5516558">.</span><span class="ident" id="5516559">recvType</span><span class="op" id="5516567">(</span><span class="op" id="5516568">-</span><span class="ident" id="5516569">id</span><span class="op" id="5516571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5516575">//&nbsp;When&nbsp;decoding&nbsp;an&nbsp;interface,&nbsp;after&nbsp;a&nbsp;type&nbsp;there&nbsp;may&nbsp;be&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5516636">//&nbsp;DelimitedValue&nbsp;still&nbsp;in&nbsp;the&nbsp;buffer.&nbsp;&nbsp;Skip&nbsp;its&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5516694">//&nbsp;(Alternatively,&nbsp;the&nbsp;buffer&nbsp;is&nbsp;empty&nbsp;and&nbsp;the&nbsp;byte&nbsp;count</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5516754">//&nbsp;will&nbsp;be&nbsp;absorbed&nbsp;by&nbsp;recvMessage.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5516793">if</span>&nbsp;<span class="ident" id="5516796">dec</span><span class="op" id="5516799">.</span><span class="ident" id="5516800">buf</span><span class="op" id="5516803">.</span><span class="ident" id="5516804">Len</span><span class="op" id="5516807">(</span><span class="op" id="5516808">)</span>&nbsp;<span class="op" id="5516810">&gt;</span>&nbsp;<span class="num" id="5516812">0</span>&nbsp;<span class="op" id="5516814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5516819">if</span>&nbsp;<span class="op" id="5516822">!</span><span class="ident" id="5516823">isInterface</span>&nbsp;<span class="op" id="5516835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5516841">dec</span><span class="op" id="5516844">.</span><span class="ident" id="5516845">err</span>&nbsp;<span class="op" id="5516849">=</span>&nbsp;<span class="ident" id="5516851">errors</span><span class="op" id="5516857">.</span><span class="ident" id="5516858">New</span><span class="op" id="5516861">(</span><span class="string" id="5516862">&#34;extra&nbsp;data&nbsp;in&nbsp;buffer&#34;</span><span class="op" id="5516884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5516890">break</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5516899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5516904">dec</span><span class="op" id="5516907">.</span><span class="ident" id="5516908">nextUint</span><span class="op" id="5516916">(</span><span class="op" id="5516917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5516921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5516924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5516927">return</span>&nbsp;<span class="op" id="5516934">-</span><span class="num" id="5516935">1</span><br>
<span class="lineno">165</span><span class="op" id="5516937">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5516940">//&nbsp;Decode&nbsp;reads&nbsp;the&nbsp;next&nbsp;value&nbsp;from&nbsp;the&nbsp;input&nbsp;stream&nbsp;and&nbsp;stores</span><br>
<span class="lineno"></span><span class="comment" id="5517004">//&nbsp;it&nbsp;in&nbsp;the&nbsp;data&nbsp;represented&nbsp;by&nbsp;the&nbsp;empty&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="5517064">//&nbsp;If&nbsp;e&nbsp;is&nbsp;nil,&nbsp;the&nbsp;value&nbsp;will&nbsp;be&nbsp;discarded.&nbsp;Otherwise,</span><br>
<span class="lineno">170</span><span class="comment" id="5517120">//&nbsp;the&nbsp;value&nbsp;underlying&nbsp;e&nbsp;must&nbsp;be&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5517171">//&nbsp;correct&nbsp;type&nbsp;for&nbsp;the&nbsp;next&nbsp;data&nbsp;item&nbsp;received.</span><br>
<span class="lineno"></span><span class="comment" id="5517220">//&nbsp;If&nbsp;the&nbsp;input&nbsp;is&nbsp;at&nbsp;EOF,&nbsp;Decode&nbsp;returns&nbsp;io.EOF&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5517273">//&nbsp;does&nbsp;not&nbsp;modify&nbsp;e.</span><br>
<span class="lineno"></span><span class="keyword" id="5517295">func</span>&nbsp;<span class="op" id="5517300">(</span><span class="ident" id="5517301">dec</span>&nbsp;<span class="op" id="5517305">*</span><span class="ident" id="5517306">Decoder</span><span class="op" id="5517313">)</span>&nbsp;<span class="ident" id="5517315">Decode</span><span class="op" id="5517321">(</span><span class="ident" id="5517322">e</span>&nbsp;<span class="keyword" id="5517324">interface</span><span class="op" id="5517333">{</span><span class="op" id="5517334">}</span><span class="op" id="5517335">)</span>&nbsp;<span class="builtintype" id="5517337">error</span>&nbsp;<span class="op" id="5517343">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5517346">if</span>&nbsp;<span class="ident" id="5517349">e</span>&nbsp;<span class="op" id="5517351">==</span>&nbsp;<span class="builtintype" id="5517354">nil</span>&nbsp;<span class="op" id="5517358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5517362">return</span>&nbsp;<span class="ident" id="5517369">dec</span><span class="op" id="5517372">.</span><span class="ident" id="5517373">DecodeValue</span><span class="op" id="5517384">(</span><span class="ident" id="5517385">reflect</span><span class="op" id="5517392">.</span><span class="ident" id="5517393">Value</span><span class="op" id="5517398">{</span><span class="op" id="5517399">}</span><span class="op" id="5517400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5517403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5517406">value</span>&nbsp;<span class="op" id="5517412">:=</span>&nbsp;<span class="ident" id="5517415">reflect</span><span class="op" id="5517422">.</span><span class="ident" id="5517423">ValueOf</span><span class="op" id="5517430">(</span><span class="ident" id="5517431">e</span><span class="op" id="5517432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5517435">//&nbsp;If&nbsp;e&nbsp;represents&nbsp;a&nbsp;value&nbsp;as&nbsp;opposed&nbsp;to&nbsp;a&nbsp;pointer,&nbsp;the&nbsp;answer&nbsp;won&#39;t</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5517505">//&nbsp;get&nbsp;back&nbsp;to&nbsp;the&nbsp;caller.&nbsp;&nbsp;Make&nbsp;sure&nbsp;it&#39;s&nbsp;a&nbsp;pointer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5517560">if</span>&nbsp;<span class="ident" id="5517563">value</span><span class="op" id="5517568">.</span><span class="ident" id="5517569">Type</span><span class="op" id="5517573">(</span><span class="op" id="5517574">)</span><span class="op" id="5517575">.</span><span class="ident" id="5517576">Kind</span><span class="op" id="5517580">(</span><span class="op" id="5517581">)</span>&nbsp;<span class="op" id="5517583">!=</span>&nbsp;<span class="ident" id="5517586">reflect</span><span class="op" id="5517593">.</span><span class="ident" id="5517594">Ptr</span>&nbsp;<span class="op" id="5517598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5517602">dec</span><span class="op" id="5517605">.</span><span class="ident" id="5517606">err</span>&nbsp;<span class="op" id="5517610">=</span>&nbsp;<span class="ident" id="5517612">errors</span><span class="op" id="5517618">.</span><span class="ident" id="5517619">New</span><span class="op" id="5517622">(</span><span class="string" id="5517623">&#34;gob:&nbsp;attempt&nbsp;to&nbsp;decode&nbsp;into&nbsp;a&nbsp;non-pointer&#34;</span><span class="op" id="5517666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5517670">return</span>&nbsp;<span class="ident" id="5517677">dec</span><span class="op" id="5517680">.</span><span class="ident" id="5517681">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5517686">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5517689">return</span>&nbsp;<span class="ident" id="5517696">dec</span><span class="op" id="5517699">.</span><span class="ident" id="5517700">DecodeValue</span><span class="op" id="5517711">(</span><span class="ident" id="5517712">value</span><span class="op" id="5517717">)</span><br>
<span class="lineno"></span><span class="op" id="5517719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5517722">//&nbsp;DecodeValue&nbsp;reads&nbsp;the&nbsp;next&nbsp;value&nbsp;from&nbsp;the&nbsp;input&nbsp;stream.</span><br>
<span class="lineno"></span><span class="comment" id="5517781">//&nbsp;If&nbsp;v&nbsp;is&nbsp;the&nbsp;zero&nbsp;reflect.Value&nbsp;(v.Kind()&nbsp;==&nbsp;Invalid),&nbsp;DecodeValue&nbsp;discards&nbsp;the&nbsp;value.</span><br>
<span class="lineno">190</span><span class="comment" id="5517870">//&nbsp;Otherwise,&nbsp;it&nbsp;stores&nbsp;the&nbsp;value&nbsp;into&nbsp;v.&nbsp;&nbsp;In&nbsp;that&nbsp;case,&nbsp;v&nbsp;must&nbsp;represent</span><br>
<span class="lineno"></span><span class="comment" id="5517944">//&nbsp;a&nbsp;non-nil&nbsp;pointer&nbsp;to&nbsp;data&nbsp;or&nbsp;be&nbsp;an&nbsp;assignable&nbsp;reflect.Value&nbsp;(v.CanSet())</span><br>
<span class="lineno"></span><span class="comment" id="5518020">//&nbsp;If&nbsp;the&nbsp;input&nbsp;is&nbsp;at&nbsp;EOF,&nbsp;DecodeValue&nbsp;returns&nbsp;io.EOF&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5518078">//&nbsp;does&nbsp;not&nbsp;modify&nbsp;v.</span><br>
<span class="lineno"></span><span class="keyword" id="5518100">func</span>&nbsp;<span class="op" id="5518105">(</span><span class="ident" id="5518106">dec</span>&nbsp;<span class="op" id="5518110">*</span><span class="ident" id="5518111">Decoder</span><span class="op" id="5518118">)</span>&nbsp;<span class="ident" id="5518120">DecodeValue</span><span class="op" id="5518131">(</span><span class="ident" id="5518132">v</span>&nbsp;<span class="ident" id="5518134">reflect</span><span class="op" id="5518141">.</span><span class="ident" id="5518142">Value</span><span class="op" id="5518147">)</span>&nbsp;<span class="builtintype" id="5518149">error</span>&nbsp;<span class="op" id="5518155">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5518158">if</span>&nbsp;<span class="ident" id="5518161">v</span><span class="op" id="5518162">.</span><span class="ident" id="5518163">IsValid</span><span class="op" id="5518170">(</span><span class="op" id="5518171">)</span>&nbsp;<span class="op" id="5518173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5518177">if</span>&nbsp;<span class="ident" id="5518180">v</span><span class="op" id="5518181">.</span><span class="ident" id="5518182">Kind</span><span class="op" id="5518186">(</span><span class="op" id="5518187">)</span>&nbsp;<span class="op" id="5518189">==</span>&nbsp;<span class="ident" id="5518192">reflect</span><span class="op" id="5518199">.</span><span class="ident" id="5518200">Ptr</span>&nbsp;<span class="op" id="5518204">&amp;&amp;</span>&nbsp;<span class="op" id="5518207">!</span><span class="ident" id="5518208">v</span><span class="op" id="5518209">.</span><span class="ident" id="5518210">IsNil</span><span class="op" id="5518215">(</span><span class="op" id="5518216">)</span>&nbsp;<span class="op" id="5518218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5518223">//&nbsp;That&#39;s&nbsp;okay,&nbsp;we&#39;ll&nbsp;store&nbsp;through&nbsp;the&nbsp;pointer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5518274">}</span>&nbsp;<span class="keyword" id="5518276">else</span>&nbsp;<span class="keyword" id="5518281">if</span>&nbsp;<span class="op" id="5518284">!</span><span class="ident" id="5518285">v</span><span class="op" id="5518286">.</span><span class="ident" id="5518287">CanSet</span><span class="op" id="5518293">(</span><span class="op" id="5518294">)</span>&nbsp;<span class="op" id="5518296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5518301">return</span>&nbsp;<span class="ident" id="5518308">errors</span><span class="op" id="5518314">.</span><span class="ident" id="5518315">New</span><span class="op" id="5518318">(</span><span class="string" id="5518319">&#34;gob:&nbsp;DecodeValue&nbsp;of&nbsp;unassignable&nbsp;value&#34;</span><span class="op" id="5518359">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5518363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5518366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5518369">//&nbsp;Make&nbsp;sure&nbsp;we&#39;re&nbsp;single-threaded&nbsp;through&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5518419">dec</span><span class="op" id="5518422">.</span><span class="ident" id="5518423">mutex</span><span class="op" id="5518428">.</span><span class="ident" id="5518429">Lock</span><span class="op" id="5518433">(</span><span class="op" id="5518434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5518437">defer</span>&nbsp;<span class="ident" id="5518443">dec</span><span class="op" id="5518446">.</span><span class="ident" id="5518447">mutex</span><span class="op" id="5518452">.</span><span class="ident" id="5518453">Unlock</span><span class="op" id="5518459">(</span><span class="op" id="5518460">)</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5518464">dec</span><span class="op" id="5518467">.</span><span class="ident" id="5518468">buf</span><span class="op" id="5518471">.</span><span class="ident" id="5518472">Reset</span><span class="op" id="5518477">(</span><span class="op" id="5518478">)</span>&nbsp;<span class="comment" id="5518480">//&nbsp;In&nbsp;case&nbsp;data&nbsp;lingers&nbsp;from&nbsp;previous&nbsp;invocation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5518531">dec</span><span class="op" id="5518534">.</span><span class="ident" id="5518535">err</span>&nbsp;<span class="op" id="5518539">=</span>&nbsp;<span class="builtintype" id="5518541">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5518546">id</span>&nbsp;<span class="op" id="5518549">:=</span>&nbsp;<span class="ident" id="5518552">dec</span><span class="op" id="5518555">.</span><span class="ident" id="5518556">decodeTypeSequence</span><span class="op" id="5518574">(</span><span class="builtintype" id="5518575">false</span><span class="op" id="5518580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5518583">if</span>&nbsp;<span class="ident" id="5518586">dec</span><span class="op" id="5518589">.</span><span class="ident" id="5518590">err</span>&nbsp;<span class="op" id="5518594">==</span>&nbsp;<span class="builtintype" id="5518597">nil</span>&nbsp;<span class="op" id="5518601">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5518605">dec</span><span class="op" id="5518608">.</span><span class="ident" id="5518609">decodeValue</span><span class="op" id="5518620">(</span><span class="ident" id="5518621">id</span><span class="op" id="5518623">,</span>&nbsp;<span class="ident" id="5518625">v</span><span class="op" id="5518626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5518629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5518632">return</span>&nbsp;<span class="ident" id="5518639">dec</span><span class="op" id="5518642">.</span><span class="ident" id="5518643">err</span><br>
<span class="lineno"></span><span class="op" id="5518647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="comment" id="5518650">//&nbsp;If&nbsp;debug.go&nbsp;is&nbsp;compiled&nbsp;into&nbsp;the&nbsp;program&nbsp;,&nbsp;debugFunc&nbsp;prints&nbsp;a&nbsp;human-readable</span><br>
<span class="lineno"></span><span class="comment" id="5518730">//&nbsp;representation&nbsp;of&nbsp;the&nbsp;gob&nbsp;data&nbsp;read&nbsp;from&nbsp;r&nbsp;by&nbsp;calling&nbsp;that&nbsp;file&#39;s&nbsp;Debug&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="5518815">//&nbsp;Otherwise&nbsp;it&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="5518839">var</span>&nbsp;<span class="ident" id="5518843">debugFunc</span>&nbsp;<span class="keyword" id="5518853">func</span><span class="op" id="5518857">(</span><span class="ident" id="5518858">io</span><span class="op" id="5518860">.</span><span class="ident" id="5518861">Reader</span><span class="op" id="5518867">)</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
