<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3027752">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3027807">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3027861">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3027912">package</span>&nbsp;<span class="ident" id="3027920">bytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3027927">import</span>&nbsp;<span class="op" id="3027934">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3027937">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3027947">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3027953">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3027968">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3027971">//&nbsp;A&nbsp;Reader&nbsp;implements&nbsp;the&nbsp;io.Reader,&nbsp;io.ReaderAt,&nbsp;io.WriterTo,&nbsp;io.Seeker,</span><br>
<span class="lineno"></span><span class="comment" id="3028046">//&nbsp;io.ByteScanner,&nbsp;and&nbsp;io.RuneScanner&nbsp;interfaces&nbsp;by&nbsp;reading&nbsp;from</span><br>
<span class="lineno">15</span><span class="comment" id="3028111">//&nbsp;a&nbsp;byte&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="3028128">//&nbsp;Unlike&nbsp;a&nbsp;Buffer,&nbsp;a&nbsp;Reader&nbsp;is&nbsp;read-only&nbsp;and&nbsp;supports&nbsp;seeking.</span><br>
<span class="lineno"></span><span class="keyword" id="3028192">type</span>&nbsp;<span class="ident" id="3028197">Reader</span>&nbsp;<span class="keyword" id="3028204">struct</span>&nbsp;<span class="op" id="3028211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3028214">s</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3028223">[</span><span class="op" id="3028224">]</span><span class="builtintype" id="3028225">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3028231">i</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3028240">int64</span>&nbsp;<span class="comment" id="3028246">//&nbsp;current&nbsp;reading&nbsp;index</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3028272">prevRune</span>&nbsp;<span class="builtintype" id="3028281">int</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3028287">//&nbsp;index&nbsp;of&nbsp;previous&nbsp;rune;&nbsp;or&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno"></span><span class="op" id="3028321">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3028324">//&nbsp;Len&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;of&nbsp;the&nbsp;unread&nbsp;portion&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3028388">//&nbsp;slice.</span><br>
<span class="lineno">25</span><span class="keyword" id="3028398">func</span>&nbsp;<span class="op" id="3028403">(</span><span class="ident" id="3028404">r</span>&nbsp;<span class="op" id="3028406">*</span><span class="ident" id="3028407">Reader</span><span class="op" id="3028413">)</span>&nbsp;<span class="ident" id="3028415">Len</span><span class="op" id="3028418">(</span><span class="op" id="3028419">)</span>&nbsp;<span class="builtintype" id="3028421">int</span>&nbsp;<span class="op" id="3028425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3028428">if</span>&nbsp;<span class="ident" id="3028431">r</span><span class="op" id="3028432">.</span><span class="ident" id="3028433">i</span>&nbsp;<span class="op" id="3028435">&gt;=</span>&nbsp;<span class="ident" id="3028438">int64</span><span class="op" id="3028443">(</span><span class="builtinfunc" id="3028444">len</span><span class="op" id="3028447">(</span><span class="ident" id="3028448">r</span><span class="op" id="3028449">.</span><span class="ident" id="3028450">s</span><span class="op" id="3028451">)</span><span class="op" id="3028452">)</span>&nbsp;<span class="op" id="3028454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3028458">return</span>&nbsp;<span class="num" id="3028465">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3028468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3028471">return</span>&nbsp;<span class="builtintype" id="3028478">int</span><span class="op" id="3028481">(</span><span class="ident" id="3028482">int64</span><span class="op" id="3028487">(</span><span class="builtinfunc" id="3028488">len</span><span class="op" id="3028491">(</span><span class="ident" id="3028492">r</span><span class="op" id="3028493">.</span><span class="ident" id="3028494">s</span><span class="op" id="3028495">)</span><span class="op" id="3028496">)</span>&nbsp;<span class="op" id="3028498">-</span>&nbsp;<span class="ident" id="3028500">r</span><span class="op" id="3028501">.</span><span class="ident" id="3028502">i</span><span class="op" id="3028503">)</span><br>
<span class="lineno">30</span><span class="op" id="3028505">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3028508">func</span>&nbsp;<span class="op" id="3028513">(</span><span class="ident" id="3028514">r</span>&nbsp;<span class="op" id="3028516">*</span><span class="ident" id="3028517">Reader</span><span class="op" id="3028523">)</span>&nbsp;<span class="ident" id="3028525">Read</span><span class="op" id="3028529">(</span><span class="ident" id="3028530">b</span>&nbsp;<span class="op" id="3028532">[</span><span class="op" id="3028533">]</span><span class="builtintype" id="3028534">byte</span><span class="op" id="3028538">)</span>&nbsp;<span class="op" id="3028540">(</span><span class="ident" id="3028541">n</span>&nbsp;<span class="builtintype" id="3028543">int</span><span class="op" id="3028546">,</span>&nbsp;<span class="ident" id="3028548">err</span>&nbsp;<span class="builtintype" id="3028552">error</span><span class="op" id="3028557">)</span>&nbsp;<span class="op" id="3028559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3028562">if</span>&nbsp;<span class="builtinfunc" id="3028565">len</span><span class="op" id="3028568">(</span><span class="ident" id="3028569">b</span><span class="op" id="3028570">)</span>&nbsp;<span class="op" id="3028572">==</span>&nbsp;<span class="num" id="3028575">0</span>&nbsp;<span class="op" id="3028577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3028581">return</span>&nbsp;<span class="num" id="3028588">0</span><span class="op" id="3028589">,</span>&nbsp;<span class="ident" id="3028591">nil</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3028596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3028599">if</span>&nbsp;<span class="ident" id="3028602">r</span><span class="op" id="3028603">.</span><span class="ident" id="3028604">i</span>&nbsp;<span class="op" id="3028606">&gt;=</span>&nbsp;<span class="ident" id="3028609">int64</span><span class="op" id="3028614">(</span><span class="builtinfunc" id="3028615">len</span><span class="op" id="3028618">(</span><span class="ident" id="3028619">r</span><span class="op" id="3028620">.</span><span class="ident" id="3028621">s</span><span class="op" id="3028622">)</span><span class="op" id="3028623">)</span>&nbsp;<span class="op" id="3028625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3028629">return</span>&nbsp;<span class="num" id="3028636">0</span><span class="op" id="3028637">,</span>&nbsp;<span class="ident" id="3028639">io</span><span class="op" id="3028641">.</span><span class="ident" id="3028642">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3028647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3028650">r</span><span class="op" id="3028651">.</span><span class="ident" id="3028652">prevRune</span>&nbsp;<span class="op" id="3028661">=</span>&nbsp;<span class="op" id="3028663">-</span><span class="num" id="3028664">1</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3028667">n</span>&nbsp;<span class="op" id="3028669">=</span>&nbsp;<span class="builtinfunc" id="3028671">copy</span><span class="op" id="3028675">(</span><span class="ident" id="3028676">b</span><span class="op" id="3028677">,</span>&nbsp;<span class="ident" id="3028679">r</span><span class="op" id="3028680">.</span><span class="ident" id="3028681">s</span><span class="op" id="3028682">[</span><span class="ident" id="3028683">r</span><span class="op" id="3028684">.</span><span class="ident" id="3028685">i</span><span class="op" id="3028686">:</span><span class="op" id="3028687">]</span><span class="op" id="3028688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3028691">r</span><span class="op" id="3028692">.</span><span class="ident" id="3028693">i</span>&nbsp;<span class="op" id="3028695">+=</span>&nbsp;<span class="ident" id="3028698">int64</span><span class="op" id="3028703">(</span><span class="ident" id="3028704">n</span><span class="op" id="3028705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3028708">return</span><br>
<span class="lineno"></span><span class="op" id="3028715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="3028718">func</span>&nbsp;<span class="op" id="3028723">(</span><span class="ident" id="3028724">r</span>&nbsp;<span class="op" id="3028726">*</span><span class="ident" id="3028727">Reader</span><span class="op" id="3028733">)</span>&nbsp;<span class="ident" id="3028735">ReadAt</span><span class="op" id="3028741">(</span><span class="ident" id="3028742">b</span>&nbsp;<span class="op" id="3028744">[</span><span class="op" id="3028745">]</span><span class="builtintype" id="3028746">byte</span><span class="op" id="3028750">,</span>&nbsp;<span class="ident" id="3028752">off</span>&nbsp;<span class="ident" id="3028756">int64</span><span class="op" id="3028761">)</span>&nbsp;<span class="op" id="3028763">(</span><span class="ident" id="3028764">n</span>&nbsp;<span class="builtintype" id="3028766">int</span><span class="op" id="3028769">,</span>&nbsp;<span class="ident" id="3028771">err</span>&nbsp;<span class="builtintype" id="3028775">error</span><span class="op" id="3028780">)</span>&nbsp;<span class="op" id="3028782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3028785">//&nbsp;cannot&nbsp;modify&nbsp;state&nbsp;-&nbsp;see&nbsp;io.ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3028827">if</span>&nbsp;<span class="ident" id="3028830">off</span>&nbsp;<span class="op" id="3028834">&lt;</span>&nbsp;<span class="num" id="3028836">0</span>&nbsp;<span class="op" id="3028838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3028842">return</span>&nbsp;<span class="num" id="3028849">0</span><span class="op" id="3028850">,</span>&nbsp;<span class="ident" id="3028852">errors</span><span class="op" id="3028858">.</span><span class="ident" id="3028859">New</span><span class="op" id="3028862">(</span><span class="string" id="3028863">&#34;bytes.Reader.ReadAt:&nbsp;negative&nbsp;offset&#34;</span><span class="op" id="3028901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3028904">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3028907">if</span>&nbsp;<span class="ident" id="3028910">off</span>&nbsp;<span class="op" id="3028914">&gt;=</span>&nbsp;<span class="ident" id="3028917">int64</span><span class="op" id="3028922">(</span><span class="builtinfunc" id="3028923">len</span><span class="op" id="3028926">(</span><span class="ident" id="3028927">r</span><span class="op" id="3028928">.</span><span class="ident" id="3028929">s</span><span class="op" id="3028930">)</span><span class="op" id="3028931">)</span>&nbsp;<span class="op" id="3028933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3028937">return</span>&nbsp;<span class="num" id="3028944">0</span><span class="op" id="3028945">,</span>&nbsp;<span class="ident" id="3028947">io</span><span class="op" id="3028949">.</span><span class="ident" id="3028950">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3028955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3028958">n</span>&nbsp;<span class="op" id="3028960">=</span>&nbsp;<span class="builtinfunc" id="3028962">copy</span><span class="op" id="3028966">(</span><span class="ident" id="3028967">b</span><span class="op" id="3028968">,</span>&nbsp;<span class="ident" id="3028970">r</span><span class="op" id="3028971">.</span><span class="ident" id="3028972">s</span><span class="op" id="3028973">[</span><span class="ident" id="3028974">off</span><span class="op" id="3028977">:</span><span class="op" id="3028978">]</span><span class="op" id="3028979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3028982">if</span>&nbsp;<span class="ident" id="3028985">n</span>&nbsp;<span class="op" id="3028987">&lt;</span>&nbsp;<span class="builtinfunc" id="3028989">len</span><span class="op" id="3028992">(</span><span class="ident" id="3028993">b</span><span class="op" id="3028994">)</span>&nbsp;<span class="op" id="3028996">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3029000">err</span>&nbsp;<span class="op" id="3029004">=</span>&nbsp;<span class="ident" id="3029006">io</span><span class="op" id="3029008">.</span><span class="ident" id="3029009">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3029014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3029017">return</span><br>
<span class="lineno"></span><span class="op" id="3029024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="3029027">func</span>&nbsp;<span class="op" id="3029032">(</span><span class="ident" id="3029033">r</span>&nbsp;<span class="op" id="3029035">*</span><span class="ident" id="3029036">Reader</span><span class="op" id="3029042">)</span>&nbsp;<span class="ident" id="3029044">ReadByte</span><span class="op" id="3029052">(</span><span class="op" id="3029053">)</span>&nbsp;<span class="op" id="3029055">(</span><span class="ident" id="3029056">b</span>&nbsp;<span class="builtintype" id="3029058">byte</span><span class="op" id="3029062">,</span>&nbsp;<span class="ident" id="3029064">err</span>&nbsp;<span class="builtintype" id="3029068">error</span><span class="op" id="3029073">)</span>&nbsp;<span class="op" id="3029075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3029078">r</span><span class="op" id="3029079">.</span><span class="ident" id="3029080">prevRune</span>&nbsp;<span class="op" id="3029089">=</span>&nbsp;<span class="op" id="3029091">-</span><span class="num" id="3029092">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3029095">if</span>&nbsp;<span class="ident" id="3029098">r</span><span class="op" id="3029099">.</span><span class="ident" id="3029100">i</span>&nbsp;<span class="op" id="3029102">&gt;=</span>&nbsp;<span class="ident" id="3029105">int64</span><span class="op" id="3029110">(</span><span class="builtinfunc" id="3029111">len</span><span class="op" id="3029114">(</span><span class="ident" id="3029115">r</span><span class="op" id="3029116">.</span><span class="ident" id="3029117">s</span><span class="op" id="3029118">)</span><span class="op" id="3029119">)</span>&nbsp;<span class="op" id="3029121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3029125">return</span>&nbsp;<span class="num" id="3029132">0</span><span class="op" id="3029133">,</span>&nbsp;<span class="ident" id="3029135">io</span><span class="op" id="3029137">.</span><span class="ident" id="3029138">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3029143">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3029146">b</span>&nbsp;<span class="op" id="3029148">=</span>&nbsp;<span class="ident" id="3029150">r</span><span class="op" id="3029151">.</span><span class="ident" id="3029152">s</span><span class="op" id="3029153">[</span><span class="ident" id="3029154">r</span><span class="op" id="3029155">.</span><span class="ident" id="3029156">i</span><span class="op" id="3029157">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3029160">r</span><span class="op" id="3029161">.</span><span class="ident" id="3029162">i</span><span class="op" id="3029163">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3029167">return</span><br>
<span class="lineno"></span><span class="op" id="3029174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="3029177">func</span>&nbsp;<span class="op" id="3029182">(</span><span class="ident" id="3029183">r</span>&nbsp;<span class="op" id="3029185">*</span><span class="ident" id="3029186">Reader</span><span class="op" id="3029192">)</span>&nbsp;<span class="ident" id="3029194">UnreadByte</span><span class="op" id="3029204">(</span><span class="op" id="3029205">)</span>&nbsp;<span class="builtintype" id="3029207">error</span>&nbsp;<span class="op" id="3029213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3029216">r</span><span class="op" id="3029217">.</span><span class="ident" id="3029218">prevRune</span>&nbsp;<span class="op" id="3029227">=</span>&nbsp;<span class="op" id="3029229">-</span><span class="num" id="3029230">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3029233">if</span>&nbsp;<span class="ident" id="3029236">r</span><span class="op" id="3029237">.</span><span class="ident" id="3029238">i</span>&nbsp;<span class="op" id="3029240">&lt;=</span>&nbsp;<span class="num" id="3029243">0</span>&nbsp;<span class="op" id="3029245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3029249">return</span>&nbsp;<span class="ident" id="3029256">errors</span><span class="op" id="3029262">.</span><span class="ident" id="3029263">New</span><span class="op" id="3029266">(</span><span class="string" id="3029267">&#34;bytes.Reader.UnreadByte:&nbsp;at&nbsp;beginning&nbsp;of&nbsp;slice&#34;</span><span class="op" id="3029315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3029318">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3029321">r</span><span class="op" id="3029322">.</span><span class="ident" id="3029323">i</span><span class="op" id="3029324">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3029328">return</span>&nbsp;<span class="ident" id="3029335">nil</span><br>
<span class="lineno"></span><span class="op" id="3029339">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3029342">func</span>&nbsp;<span class="op" id="3029347">(</span><span class="ident" id="3029348">r</span>&nbsp;<span class="op" id="3029350">*</span><span class="ident" id="3029351">Reader</span><span class="op" id="3029357">)</span>&nbsp;<span class="ident" id="3029359">ReadRune</span><span class="op" id="3029367">(</span><span class="op" id="3029368">)</span>&nbsp;<span class="op" id="3029370">(</span><span class="ident" id="3029371">ch</span>&nbsp;<span class="builtintype" id="3029374">rune</span><span class="op" id="3029378">,</span>&nbsp;<span class="ident" id="3029380">size</span>&nbsp;<span class="builtintype" id="3029385">int</span><span class="op" id="3029388">,</span>&nbsp;<span class="ident" id="3029390">err</span>&nbsp;<span class="builtintype" id="3029394">error</span><span class="op" id="3029399">)</span>&nbsp;<span class="op" id="3029401">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3029404">if</span>&nbsp;<span class="ident" id="3029407">r</span><span class="op" id="3029408">.</span><span class="ident" id="3029409">i</span>&nbsp;<span class="op" id="3029411">&gt;=</span>&nbsp;<span class="ident" id="3029414">int64</span><span class="op" id="3029419">(</span><span class="builtinfunc" id="3029420">len</span><span class="op" id="3029423">(</span><span class="ident" id="3029424">r</span><span class="op" id="3029425">.</span><span class="ident" id="3029426">s</span><span class="op" id="3029427">)</span><span class="op" id="3029428">)</span>&nbsp;<span class="op" id="3029430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3029434">r</span><span class="op" id="3029435">.</span><span class="ident" id="3029436">prevRune</span>&nbsp;<span class="op" id="3029445">=</span>&nbsp;<span class="op" id="3029447">-</span><span class="num" id="3029448">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3029452">return</span>&nbsp;<span class="num" id="3029459">0</span><span class="op" id="3029460">,</span>&nbsp;<span class="num" id="3029462">0</span><span class="op" id="3029463">,</span>&nbsp;<span class="ident" id="3029465">io</span><span class="op" id="3029467">.</span><span class="ident" id="3029468">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3029473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3029476">r</span><span class="op" id="3029477">.</span><span class="ident" id="3029478">prevRune</span>&nbsp;<span class="op" id="3029487">=</span>&nbsp;<span class="builtintype" id="3029489">int</span><span class="op" id="3029492">(</span><span class="ident" id="3029493">r</span><span class="op" id="3029494">.</span><span class="ident" id="3029495">i</span><span class="op" id="3029496">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3029499">if</span>&nbsp;<span class="ident" id="3029502">c</span>&nbsp;<span class="op" id="3029504">:=</span>&nbsp;<span class="ident" id="3029507">r</span><span class="op" id="3029508">.</span><span class="ident" id="3029509">s</span><span class="op" id="3029510">[</span><span class="ident" id="3029511">r</span><span class="op" id="3029512">.</span><span class="ident" id="3029513">i</span><span class="op" id="3029514">]</span><span class="op" id="3029515">;</span>&nbsp;<span class="ident" id="3029517">c</span>&nbsp;<span class="op" id="3029519">&lt;</span>&nbsp;<span class="ident" id="3029521">utf8</span><span class="op" id="3029525">.</span><span class="ident" id="3029526">RuneSelf</span>&nbsp;<span class="op" id="3029535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3029539">r</span><span class="op" id="3029540">.</span><span class="ident" id="3029541">i</span><span class="op" id="3029542">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3029547">return</span>&nbsp;<span class="builtintype" id="3029554">rune</span><span class="op" id="3029558">(</span><span class="ident" id="3029559">c</span><span class="op" id="3029560">)</span><span class="op" id="3029561">,</span>&nbsp;<span class="num" id="3029563">1</span><span class="op" id="3029564">,</span>&nbsp;<span class="ident" id="3029566">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3029571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3029574">ch</span><span class="op" id="3029576">,</span>&nbsp;<span class="ident" id="3029578">size</span>&nbsp;<span class="op" id="3029583">=</span>&nbsp;<span class="ident" id="3029585">utf8</span><span class="op" id="3029589">.</span><span class="ident" id="3029590">DecodeRune</span><span class="op" id="3029600">(</span><span class="ident" id="3029601">r</span><span class="op" id="3029602">.</span><span class="ident" id="3029603">s</span><span class="op" id="3029604">[</span><span class="ident" id="3029605">r</span><span class="op" id="3029606">.</span><span class="ident" id="3029607">i</span><span class="op" id="3029608">:</span><span class="op" id="3029609">]</span><span class="op" id="3029610">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3029613">r</span><span class="op" id="3029614">.</span><span class="ident" id="3029615">i</span>&nbsp;<span class="op" id="3029617">+=</span>&nbsp;<span class="ident" id="3029620">int64</span><span class="op" id="3029625">(</span><span class="ident" id="3029626">size</span><span class="op" id="3029630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3029633">return</span><br>
<span class="lineno"></span><span class="op" id="3029640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3029643">func</span>&nbsp;<span class="op" id="3029648">(</span><span class="ident" id="3029649">r</span>&nbsp;<span class="op" id="3029651">*</span><span class="ident" id="3029652">Reader</span><span class="op" id="3029658">)</span>&nbsp;<span class="ident" id="3029660">UnreadRune</span><span class="op" id="3029670">(</span><span class="op" id="3029671">)</span>&nbsp;<span class="builtintype" id="3029673">error</span>&nbsp;<span class="op" id="3029679">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3029682">if</span>&nbsp;<span class="ident" id="3029685">r</span><span class="op" id="3029686">.</span><span class="ident" id="3029687">prevRune</span>&nbsp;<span class="op" id="3029696">&lt;</span>&nbsp;<span class="num" id="3029698">0</span>&nbsp;<span class="op" id="3029700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3029704">return</span>&nbsp;<span class="ident" id="3029711">errors</span><span class="op" id="3029717">.</span><span class="ident" id="3029718">New</span><span class="op" id="3029721">(</span><span class="string" id="3029722">&#34;bytes.Reader.UnreadRune:&nbsp;previous&nbsp;operation&nbsp;was&nbsp;not&nbsp;ReadRune&#34;</span><span class="op" id="3029784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3029787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3029790">r</span><span class="op" id="3029791">.</span><span class="ident" id="3029792">i</span>&nbsp;<span class="op" id="3029794">=</span>&nbsp;<span class="ident" id="3029796">int64</span><span class="op" id="3029801">(</span><span class="ident" id="3029802">r</span><span class="op" id="3029803">.</span><span class="ident" id="3029804">prevRune</span><span class="op" id="3029812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3029815">r</span><span class="op" id="3029816">.</span><span class="ident" id="3029817">prevRune</span>&nbsp;<span class="op" id="3029826">=</span>&nbsp;<span class="op" id="3029828">-</span><span class="num" id="3029829">1</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3029832">return</span>&nbsp;<span class="ident" id="3029839">nil</span><br>
<span class="lineno"></span><span class="op" id="3029843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3029846">//&nbsp;Seek&nbsp;implements&nbsp;the&nbsp;io.Seeker&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="3029890">func</span>&nbsp;<span class="op" id="3029895">(</span><span class="ident" id="3029896">r</span>&nbsp;<span class="op" id="3029898">*</span><span class="ident" id="3029899">Reader</span><span class="op" id="3029905">)</span>&nbsp;<span class="ident" id="3029907">Seek</span><span class="op" id="3029911">(</span><span class="ident" id="3029912">offset</span>&nbsp;<span class="ident" id="3029919">int64</span><span class="op" id="3029924">,</span>&nbsp;<span class="ident" id="3029926">whence</span>&nbsp;<span class="builtintype" id="3029933">int</span><span class="op" id="3029936">)</span>&nbsp;<span class="op" id="3029938">(</span><span class="ident" id="3029939">int64</span><span class="op" id="3029944">,</span>&nbsp;<span class="builtintype" id="3029946">error</span><span class="op" id="3029951">)</span>&nbsp;<span class="op" id="3029953">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3029956">r</span><span class="op" id="3029957">.</span><span class="ident" id="3029958">prevRune</span>&nbsp;<span class="op" id="3029967">=</span>&nbsp;<span class="op" id="3029969">-</span><span class="num" id="3029970">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3029973">var</span>&nbsp;<span class="ident" id="3029977">abs</span>&nbsp;<span class="ident" id="3029981">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3029988">switch</span>&nbsp;<span class="ident" id="3029995">whence</span>&nbsp;<span class="op" id="3030002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3030005">case</span>&nbsp;<span class="num" id="3030010">0</span><span class="op" id="3030011">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3030015">abs</span>&nbsp;<span class="op" id="3030019">=</span>&nbsp;<span class="ident" id="3030021">offset</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3030029">case</span>&nbsp;<span class="num" id="3030034">1</span><span class="op" id="3030035">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3030039">abs</span>&nbsp;<span class="op" id="3030043">=</span>&nbsp;<span class="ident" id="3030045">int64</span><span class="op" id="3030050">(</span><span class="ident" id="3030051">r</span><span class="op" id="3030052">.</span><span class="ident" id="3030053">i</span><span class="op" id="3030054">)</span>&nbsp;<span class="op" id="3030056">+</span>&nbsp;<span class="ident" id="3030058">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3030066">case</span>&nbsp;<span class="num" id="3030071">2</span><span class="op" id="3030072">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3030076">abs</span>&nbsp;<span class="op" id="3030080">=</span>&nbsp;<span class="ident" id="3030082">int64</span><span class="op" id="3030087">(</span><span class="builtinfunc" id="3030088">len</span><span class="op" id="3030091">(</span><span class="ident" id="3030092">r</span><span class="op" id="3030093">.</span><span class="ident" id="3030094">s</span><span class="op" id="3030095">)</span><span class="op" id="3030096">)</span>&nbsp;<span class="op" id="3030098">+</span>&nbsp;<span class="ident" id="3030100">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3030108">default</span><span class="op" id="3030115">:</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3030119">return</span>&nbsp;<span class="num" id="3030126">0</span><span class="op" id="3030127">,</span>&nbsp;<span class="ident" id="3030129">errors</span><span class="op" id="3030135">.</span><span class="ident" id="3030136">New</span><span class="op" id="3030139">(</span><span class="string" id="3030140">&#34;bytes.Reader.Seek:&nbsp;invalid&nbsp;whence&#34;</span><span class="op" id="3030175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3030178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3030181">if</span>&nbsp;<span class="ident" id="3030184">abs</span>&nbsp;<span class="op" id="3030188">&lt;</span>&nbsp;<span class="num" id="3030190">0</span>&nbsp;<span class="op" id="3030192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3030196">return</span>&nbsp;<span class="num" id="3030203">0</span><span class="op" id="3030204">,</span>&nbsp;<span class="ident" id="3030206">errors</span><span class="op" id="3030212">.</span><span class="ident" id="3030213">New</span><span class="op" id="3030216">(</span><span class="string" id="3030217">&#34;bytes.Reader.Seek:&nbsp;negative&nbsp;position&#34;</span><span class="op" id="3030255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3030258">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3030261">r</span><span class="op" id="3030262">.</span><span class="ident" id="3030263">i</span>&nbsp;<span class="op" id="3030265">=</span>&nbsp;<span class="ident" id="3030267">abs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3030272">return</span>&nbsp;<span class="ident" id="3030279">abs</span><span class="op" id="3030282">,</span>&nbsp;<span class="ident" id="3030284">nil</span><br>
<span class="lineno"></span><span class="op" id="3030288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3030291">//&nbsp;WriteTo&nbsp;implements&nbsp;the&nbsp;io.WriterTo&nbsp;interface.</span><br>
<span class="lineno">125</span><span class="keyword" id="3030340">func</span>&nbsp;<span class="op" id="3030345">(</span><span class="ident" id="3030346">r</span>&nbsp;<span class="op" id="3030348">*</span><span class="ident" id="3030349">Reader</span><span class="op" id="3030355">)</span>&nbsp;<span class="ident" id="3030357">WriteTo</span><span class="op" id="3030364">(</span><span class="ident" id="3030365">w</span>&nbsp;<span class="ident" id="3030367">io</span><span class="op" id="3030369">.</span><span class="ident" id="3030370">Writer</span><span class="op" id="3030376">)</span>&nbsp;<span class="op" id="3030378">(</span><span class="ident" id="3030379">n</span>&nbsp;<span class="ident" id="3030381">int64</span><span class="op" id="3030386">,</span>&nbsp;<span class="ident" id="3030388">err</span>&nbsp;<span class="builtintype" id="3030392">error</span><span class="op" id="3030397">)</span>&nbsp;<span class="op" id="3030399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3030402">r</span><span class="op" id="3030403">.</span><span class="ident" id="3030404">prevRune</span>&nbsp;<span class="op" id="3030413">=</span>&nbsp;<span class="op" id="3030415">-</span><span class="num" id="3030416">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3030419">if</span>&nbsp;<span class="ident" id="3030422">r</span><span class="op" id="3030423">.</span><span class="ident" id="3030424">i</span>&nbsp;<span class="op" id="3030426">&gt;=</span>&nbsp;<span class="ident" id="3030429">int64</span><span class="op" id="3030434">(</span><span class="builtinfunc" id="3030435">len</span><span class="op" id="3030438">(</span><span class="ident" id="3030439">r</span><span class="op" id="3030440">.</span><span class="ident" id="3030441">s</span><span class="op" id="3030442">)</span><span class="op" id="3030443">)</span>&nbsp;<span class="op" id="3030445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3030449">return</span>&nbsp;<span class="num" id="3030456">0</span><span class="op" id="3030457">,</span>&nbsp;<span class="ident" id="3030459">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3030464">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3030467">b</span>&nbsp;<span class="op" id="3030469">:=</span>&nbsp;<span class="ident" id="3030472">r</span><span class="op" id="3030473">.</span><span class="ident" id="3030474">s</span><span class="op" id="3030475">[</span><span class="ident" id="3030476">r</span><span class="op" id="3030477">.</span><span class="ident" id="3030478">i</span><span class="op" id="3030479">:</span><span class="op" id="3030480">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3030483">m</span><span class="op" id="3030484">,</span>&nbsp;<span class="ident" id="3030486">err</span>&nbsp;<span class="op" id="3030490">:=</span>&nbsp;<span class="ident" id="3030493">w</span><span class="op" id="3030494">.</span><span class="ident" id="3030495">Write</span><span class="op" id="3030500">(</span><span class="ident" id="3030501">b</span><span class="op" id="3030502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3030505">if</span>&nbsp;<span class="ident" id="3030508">m</span>&nbsp;<span class="op" id="3030510">&gt;</span>&nbsp;<span class="builtinfunc" id="3030512">len</span><span class="op" id="3030515">(</span><span class="ident" id="3030516">b</span><span class="op" id="3030517">)</span>&nbsp;<span class="op" id="3030519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3030523">panic</span><span class="op" id="3030528">(</span><span class="string" id="3030529">&#34;bytes.Reader.WriteTo:&nbsp;invalid&nbsp;Write&nbsp;count&#34;</span><span class="op" id="3030572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3030575">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3030578">r</span><span class="op" id="3030579">.</span><span class="ident" id="3030580">i</span>&nbsp;<span class="op" id="3030582">+=</span>&nbsp;<span class="ident" id="3030585">int64</span><span class="op" id="3030590">(</span><span class="ident" id="3030591">m</span><span class="op" id="3030592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3030595">n</span>&nbsp;<span class="op" id="3030597">=</span>&nbsp;<span class="ident" id="3030599">int64</span><span class="op" id="3030604">(</span><span class="ident" id="3030605">m</span><span class="op" id="3030606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3030609">if</span>&nbsp;<span class="ident" id="3030612">m</span>&nbsp;<span class="op" id="3030614">!=</span>&nbsp;<span class="builtinfunc" id="3030617">len</span><span class="op" id="3030620">(</span><span class="ident" id="3030621">b</span><span class="op" id="3030622">)</span>&nbsp;<span class="op" id="3030624">&amp;&amp;</span>&nbsp;<span class="ident" id="3030627">err</span>&nbsp;<span class="op" id="3030631">==</span>&nbsp;<span class="ident" id="3030634">nil</span>&nbsp;<span class="op" id="3030638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3030642">err</span>&nbsp;<span class="op" id="3030646">=</span>&nbsp;<span class="ident" id="3030648">io</span><span class="op" id="3030650">.</span><span class="ident" id="3030651">ErrShortWrite</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3030666">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3030669">return</span><br>
<span class="lineno"></span><span class="op" id="3030676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3030679">//&nbsp;NewReader&nbsp;returns&nbsp;a&nbsp;new&nbsp;Reader&nbsp;reading&nbsp;from&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3030729">func</span>&nbsp;<span class="ident" id="3030734">NewReader</span><span class="op" id="3030743">(</span><span class="ident" id="3030744">b</span>&nbsp;<span class="op" id="3030746">[</span><span class="op" id="3030747">]</span><span class="builtintype" id="3030748">byte</span><span class="op" id="3030752">)</span>&nbsp;<span class="op" id="3030754">*</span><span class="ident" id="3030755">Reader</span>&nbsp;<span class="op" id="3030762">{</span>&nbsp;<span class="keyword" id="3030764">return</span>&nbsp;<span class="op" id="3030771">&amp;</span><span class="ident" id="3030772">Reader</span><span class="op" id="3030778">{</span><span class="ident" id="3030779">b</span><span class="op" id="3030780">,</span>&nbsp;<span class="num" id="3030782">0</span><span class="op" id="3030783">,</span>&nbsp;<span class="op" id="3030785">-</span><span class="num" id="3030786">1</span><span class="op" id="3030787">}</span>&nbsp;<span class="op" id="3030789">}</span>
</div>
</body>
</html>
