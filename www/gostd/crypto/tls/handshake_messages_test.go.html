<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html" class="current">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8468321">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8468376">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8468430">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8468481">package</span>&nbsp;<span class="ident" id="8468489">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8468494">import</span>&nbsp;<span class="op" id="8468501">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8468504">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8468517">&#34;reflect&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8468528">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8468539">&#34;testing/quick&#34;</span><br>
<span class="lineno"></span><span class="op" id="8468555">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8468558">var</span>&nbsp;<span class="ident" id="8468562">tests</span>&nbsp;<span class="op" id="8468568">=</span>&nbsp;<span class="op" id="8468570">[</span><span class="op" id="8468571">]</span><span class="keyword" id="8468572">interface</span><span class="op" id="8468581">{</span><span class="op" id="8468582">}</span><span class="op" id="8468583">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8468586">&amp;</span><span class="ident" id="8468587">clientHelloMsg</span><span class="op" id="8468601">{</span><span class="op" id="8468602">}</span><span class="op" id="8468603">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8468606">&amp;</span><span class="ident" id="8468607">serverHelloMsg</span><span class="op" id="8468621">{</span><span class="op" id="8468622">}</span><span class="op" id="8468623">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8468626">&amp;</span><span class="ident" id="8468627">finishedMsg</span><span class="op" id="8468638">{</span><span class="op" id="8468639">}</span><span class="op" id="8468640">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8468644">&amp;</span><span class="ident" id="8468645">certificateMsg</span><span class="op" id="8468659">{</span><span class="op" id="8468660">}</span><span class="op" id="8468661">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8468664">&amp;</span><span class="ident" id="8468665">certificateRequestMsg</span><span class="op" id="8468686">{</span><span class="op" id="8468687">}</span><span class="op" id="8468688">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8468691">&amp;</span><span class="ident" id="8468692">certificateVerifyMsg</span><span class="op" id="8468712">{</span><span class="op" id="8468713">}</span><span class="op" id="8468714">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8468717">&amp;</span><span class="ident" id="8468718">certificateStatusMsg</span><span class="op" id="8468738">{</span><span class="op" id="8468739">}</span><span class="op" id="8468740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8468743">&amp;</span><span class="ident" id="8468744">clientKeyExchangeMsg</span><span class="op" id="8468764">{</span><span class="op" id="8468765">}</span><span class="op" id="8468766">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8468769">&amp;</span><span class="ident" id="8468770">nextProtoMsg</span><span class="op" id="8468782">{</span><span class="op" id="8468783">}</span><span class="op" id="8468784">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8468787">&amp;</span><span class="ident" id="8468788">newSessionTicketMsg</span><span class="op" id="8468807">{</span><span class="op" id="8468808">}</span><span class="op" id="8468809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8468812">&amp;</span><span class="ident" id="8468813">sessionState</span><span class="op" id="8468825">{</span><span class="op" id="8468826">}</span><span class="op" id="8468827">,</span><br>
<span class="lineno"></span><span class="op" id="8468829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8468832">type</span>&nbsp;<span class="ident" id="8468837">testMessage</span>&nbsp;<span class="keyword" id="8468849">interface</span>&nbsp;<span class="op" id="8468859">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8468862">marshal</span><span class="op" id="8468869">(</span><span class="op" id="8468870">)</span>&nbsp;<span class="op" id="8468872">[</span><span class="op" id="8468873">]</span><span class="builtintype" id="8468874">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8468880">unmarshal</span><span class="op" id="8468889">(</span><span class="op" id="8468890">[</span><span class="op" id="8468891">]</span><span class="builtintype" id="8468892">byte</span><span class="op" id="8468896">)</span>&nbsp;<span class="builtintype" id="8468898">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8468904">equal</span><span class="op" id="8468909">(</span><span class="keyword" id="8468910">interface</span><span class="op" id="8468919">{</span><span class="op" id="8468920">}</span><span class="op" id="8468921">)</span>&nbsp;<span class="builtintype" id="8468923">bool</span><br>
<span class="lineno"></span><span class="op" id="8468928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="8468931">func</span>&nbsp;<span class="ident" id="8468936">TestMarshalUnmarshal</span><span class="op" id="8468956">(</span><span class="ident" id="8468957">t</span>&nbsp;<span class="op" id="8468959">*</span><span class="ident" id="8468960">testing</span><span class="op" id="8468967">.</span><span class="ident" id="8468968">T</span><span class="op" id="8468969">)</span>&nbsp;<span class="op" id="8468971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8468974">rand</span>&nbsp;<span class="op" id="8468979">:=</span>&nbsp;<span class="ident" id="8468982">rand</span><span class="op" id="8468986">.</span><span class="ident" id="8468987">New</span><span class="op" id="8468990">(</span><span class="ident" id="8468991">rand</span><span class="op" id="8468995">.</span><span class="ident" id="8468996">NewSource</span><span class="op" id="8469005">(</span><span class="num" id="8469006">0</span><span class="op" id="8469007">)</span><span class="op" id="8469008">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8469012">for</span>&nbsp;<span class="ident" id="8469016">i</span><span class="op" id="8469017">,</span>&nbsp;<span class="ident" id="8469019">iface</span>&nbsp;<span class="op" id="8469025">:=</span>&nbsp;<span class="keyword" id="8469028">range</span>&nbsp;<span class="ident" id="8469034">tests</span>&nbsp;<span class="op" id="8469040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8469044">ty</span>&nbsp;<span class="op" id="8469047">:=</span>&nbsp;<span class="ident" id="8469050">reflect</span><span class="op" id="8469057">.</span><span class="ident" id="8469058">ValueOf</span><span class="op" id="8469065">(</span><span class="ident" id="8469066">iface</span><span class="op" id="8469071">)</span><span class="op" id="8469072">.</span><span class="ident" id="8469073">Type</span><span class="op" id="8469077">(</span><span class="op" id="8469078">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8469083">n</span>&nbsp;<span class="op" id="8469085">:=</span>&nbsp;<span class="num" id="8469088">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8469094">if</span>&nbsp;<span class="ident" id="8469097">testing</span><span class="op" id="8469104">.</span><span class="ident" id="8469105">Short</span><span class="op" id="8469110">(</span><span class="op" id="8469111">)</span>&nbsp;<span class="op" id="8469113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8469118">n</span>&nbsp;<span class="op" id="8469120">=</span>&nbsp;<span class="num" id="8469122">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8469126">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8469130">for</span>&nbsp;<span class="ident" id="8469134">j</span>&nbsp;<span class="op" id="8469136">:=</span>&nbsp;<span class="num" id="8469139">0</span><span class="op" id="8469140">;</span>&nbsp;<span class="ident" id="8469142">j</span>&nbsp;<span class="op" id="8469144">&lt;</span>&nbsp;<span class="ident" id="8469146">n</span><span class="op" id="8469147">;</span>&nbsp;<span class="ident" id="8469149">j</span><span class="op" id="8469150">++</span>&nbsp;<span class="op" id="8469153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8469158">v</span><span class="op" id="8469159">,</span>&nbsp;<span class="ident" id="8469161">ok</span>&nbsp;<span class="op" id="8469164">:=</span>&nbsp;<span class="ident" id="8469167">quick</span><span class="op" id="8469172">.</span><span class="ident" id="8469173">Value</span><span class="op" id="8469178">(</span><span class="ident" id="8469179">ty</span><span class="op" id="8469181">,</span>&nbsp;<span class="ident" id="8469183">rand</span><span class="op" id="8469187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8469192">if</span>&nbsp;<span class="op" id="8469195">!</span><span class="ident" id="8469196">ok</span>&nbsp;<span class="op" id="8469199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8469205">t</span><span class="op" id="8469206">.</span><span class="ident" id="8469207">Errorf</span><span class="op" id="8469213">(</span><span class="string" id="8469214">&#34;#%d:&nbsp;failed&nbsp;to&nbsp;create&nbsp;value&#34;</span><span class="op" id="8469243">,</span>&nbsp;<span class="ident" id="8469245">i</span><span class="op" id="8469246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8469252">break</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8469261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8469267">m1</span>&nbsp;<span class="op" id="8469270">:=</span>&nbsp;<span class="ident" id="8469273">v</span><span class="op" id="8469274">.</span><span class="ident" id="8469275">Interface</span><span class="op" id="8469284">(</span><span class="op" id="8469285">)</span><span class="op" id="8469286">.</span><span class="op" id="8469287">(</span><span class="ident" id="8469288">testMessage</span><span class="op" id="8469299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8469304">marshaled</span>&nbsp;<span class="op" id="8469314">:=</span>&nbsp;<span class="ident" id="8469317">m1</span><span class="op" id="8469319">.</span><span class="ident" id="8469320">marshal</span><span class="op" id="8469327">(</span><span class="op" id="8469328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8469333">m2</span>&nbsp;<span class="op" id="8469336">:=</span>&nbsp;<span class="ident" id="8469339">iface</span><span class="op" id="8469344">.</span><span class="op" id="8469345">(</span><span class="ident" id="8469346">testMessage</span><span class="op" id="8469357">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8469362">if</span>&nbsp;<span class="op" id="8469365">!</span><span class="ident" id="8469366">m2</span><span class="op" id="8469368">.</span><span class="ident" id="8469369">unmarshal</span><span class="op" id="8469378">(</span><span class="ident" id="8469379">marshaled</span><span class="op" id="8469388">)</span>&nbsp;<span class="op" id="8469390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8469396">t</span><span class="op" id="8469397">.</span><span class="ident" id="8469398">Errorf</span><span class="op" id="8469404">(</span><span class="string" id="8469405">&#34;#%d&nbsp;failed&nbsp;to&nbsp;unmarshal&nbsp;%#v&nbsp;%x&#34;</span><span class="op" id="8469437">,</span>&nbsp;<span class="ident" id="8469439">i</span><span class="op" id="8469440">,</span>&nbsp;<span class="ident" id="8469442">m1</span><span class="op" id="8469444">,</span>&nbsp;<span class="ident" id="8469446">marshaled</span><span class="op" id="8469455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8469461">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8469470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8469475">m2</span><span class="op" id="8469477">.</span><span class="ident" id="8469478">marshal</span><span class="op" id="8469485">(</span><span class="op" id="8469486">)</span>&nbsp;<span class="comment" id="8469488">//&nbsp;to&nbsp;fill&nbsp;any&nbsp;marshal&nbsp;cache&nbsp;in&nbsp;the&nbsp;message</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8469536">if</span>&nbsp;<span class="op" id="8469539">!</span><span class="ident" id="8469540">m1</span><span class="op" id="8469542">.</span><span class="ident" id="8469543">equal</span><span class="op" id="8469548">(</span><span class="ident" id="8469549">m2</span><span class="op" id="8469551">)</span>&nbsp;<span class="op" id="8469553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8469559">t</span><span class="op" id="8469560">.</span><span class="ident" id="8469561">Errorf</span><span class="op" id="8469567">(</span><span class="string" id="8469568">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&nbsp;%x&#34;</span><span class="op" id="8469593">,</span>&nbsp;<span class="ident" id="8469595">i</span><span class="op" id="8469596">,</span>&nbsp;<span class="ident" id="8469598">m2</span><span class="op" id="8469600">,</span>&nbsp;<span class="ident" id="8469602">m1</span><span class="op" id="8469604">,</span>&nbsp;<span class="ident" id="8469606">marshaled</span><span class="op" id="8469615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8469621">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8469630">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8469636">if</span>&nbsp;<span class="ident" id="8469639">i</span>&nbsp;<span class="op" id="8469641">&gt;=</span>&nbsp;<span class="num" id="8469644">3</span>&nbsp;<span class="op" id="8469646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8469652">//&nbsp;The&nbsp;first&nbsp;three&nbsp;message&nbsp;types&nbsp;(ClientHello,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8469703">//&nbsp;ServerHello&nbsp;and&nbsp;Finished)&nbsp;are&nbsp;allowed&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8469751">//&nbsp;have&nbsp;parsable&nbsp;prefixes&nbsp;because&nbsp;the&nbsp;extension</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8469803">//&nbsp;data&nbsp;is&nbsp;optional&nbsp;and&nbsp;the&nbsp;length&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8469849">//&nbsp;Finished&nbsp;varies&nbsp;across&nbsp;versions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8469889">for</span>&nbsp;<span class="ident" id="8469893">j</span>&nbsp;<span class="op" id="8469895">:=</span>&nbsp;<span class="num" id="8469898">0</span><span class="op" id="8469899">;</span>&nbsp;<span class="ident" id="8469901">j</span>&nbsp;<span class="op" id="8469903">&lt;</span>&nbsp;<span class="builtinfunc" id="8469905">len</span><span class="op" id="8469908">(</span><span class="ident" id="8469909">marshaled</span><span class="op" id="8469918">)</span><span class="op" id="8469919">;</span>&nbsp;<span class="ident" id="8469921">j</span><span class="op" id="8469922">++</span>&nbsp;<span class="op" id="8469925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8469932">if</span>&nbsp;<span class="ident" id="8469935">m2</span><span class="op" id="8469937">.</span><span class="ident" id="8469938">unmarshal</span><span class="op" id="8469947">(</span><span class="ident" id="8469948">marshaled</span><span class="op" id="8469957">[</span><span class="num" id="8469958">0</span><span class="op" id="8469959">:</span><span class="ident" id="8469960">j</span><span class="op" id="8469961">]</span><span class="op" id="8469962">)</span>&nbsp;<span class="op" id="8469964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8469972">t</span><span class="op" id="8469973">.</span><span class="ident" id="8469974">Errorf</span><span class="op" id="8469980">(</span><span class="string" id="8469981">&#34;#%d&nbsp;unmarshaled&nbsp;a&nbsp;prefix&nbsp;of&nbsp;length&nbsp;%d&nbsp;of&nbsp;%#v&#34;</span><span class="op" id="8470027">,</span>&nbsp;<span class="ident" id="8470029">i</span><span class="op" id="8470030">,</span>&nbsp;<span class="ident" id="8470032">j</span><span class="op" id="8470033">,</span>&nbsp;<span class="ident" id="8470035">m1</span><span class="op" id="8470037">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8470045">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8470056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8470062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8470067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8470071">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8470074">}</span><br>
<span class="lineno"></span><span class="op" id="8470076">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8470079">func</span>&nbsp;<span class="ident" id="8470084">TestFuzz</span><span class="op" id="8470092">(</span><span class="ident" id="8470093">t</span>&nbsp;<span class="op" id="8470095">*</span><span class="ident" id="8470096">testing</span><span class="op" id="8470103">.</span><span class="ident" id="8470104">T</span><span class="op" id="8470105">)</span>&nbsp;<span class="op" id="8470107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8470110">rand</span>&nbsp;<span class="op" id="8470115">:=</span>&nbsp;<span class="ident" id="8470118">rand</span><span class="op" id="8470122">.</span><span class="ident" id="8470123">New</span><span class="op" id="8470126">(</span><span class="ident" id="8470127">rand</span><span class="op" id="8470131">.</span><span class="ident" id="8470132">NewSource</span><span class="op" id="8470141">(</span><span class="num" id="8470142">0</span><span class="op" id="8470143">)</span><span class="op" id="8470144">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8470147">for</span>&nbsp;<span class="ident" id="8470151">_</span><span class="op" id="8470152">,</span>&nbsp;<span class="ident" id="8470154">iface</span>&nbsp;<span class="op" id="8470160">:=</span>&nbsp;<span class="keyword" id="8470163">range</span>&nbsp;<span class="ident" id="8470169">tests</span>&nbsp;<span class="op" id="8470175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8470179">m</span>&nbsp;<span class="op" id="8470181">:=</span>&nbsp;<span class="ident" id="8470184">iface</span><span class="op" id="8470189">.</span><span class="op" id="8470190">(</span><span class="ident" id="8470191">testMessage</span><span class="op" id="8470202">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8470207">for</span>&nbsp;<span class="ident" id="8470211">j</span>&nbsp;<span class="op" id="8470213">:=</span>&nbsp;<span class="num" id="8470216">0</span><span class="op" id="8470217">;</span>&nbsp;<span class="ident" id="8470219">j</span>&nbsp;<span class="op" id="8470221">&lt;</span>&nbsp;<span class="num" id="8470223">1000</span><span class="op" id="8470227">;</span>&nbsp;<span class="ident" id="8470229">j</span><span class="op" id="8470230">++</span>&nbsp;<span class="op" id="8470233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8470238">len</span>&nbsp;<span class="op" id="8470242">:=</span>&nbsp;<span class="ident" id="8470245">rand</span><span class="op" id="8470249">.</span><span class="ident" id="8470250">Intn</span><span class="op" id="8470254">(</span><span class="num" id="8470255">100</span><span class="op" id="8470258">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8470263">bytes</span>&nbsp;<span class="op" id="8470269">:=</span>&nbsp;<span class="ident" id="8470272">randomBytes</span><span class="op" id="8470283">(</span><span class="builtinfunc" id="8470284">len</span><span class="op" id="8470287">,</span>&nbsp;<span class="ident" id="8470289">rand</span><span class="op" id="8470293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8470298">//&nbsp;This&nbsp;just&nbsp;looks&nbsp;for&nbsp;crashes&nbsp;due&nbsp;to&nbsp;bounds&nbsp;errors&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8470358">m</span><span class="op" id="8470359">.</span><span class="ident" id="8470360">unmarshal</span><span class="op" id="8470369">(</span><span class="ident" id="8470370">bytes</span><span class="op" id="8470375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8470379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8470382">}</span><br>
<span class="lineno">95</span><span class="op" id="8470384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8470387">func</span>&nbsp;<span class="ident" id="8470392">randomBytes</span><span class="op" id="8470403">(</span><span class="ident" id="8470404">n</span>&nbsp;<span class="builtintype" id="8470406">int</span><span class="op" id="8470409">,</span>&nbsp;<span class="ident" id="8470411">rand</span>&nbsp;<span class="op" id="8470416">*</span><span class="ident" id="8470417">rand</span><span class="op" id="8470421">.</span><span class="ident" id="8470422">Rand</span><span class="op" id="8470426">)</span>&nbsp;<span class="op" id="8470428">[</span><span class="op" id="8470429">]</span><span class="builtintype" id="8470430">byte</span>&nbsp;<span class="op" id="8470435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8470438">r</span>&nbsp;<span class="op" id="8470440">:=</span>&nbsp;<span class="builtinfunc" id="8470443">make</span><span class="op" id="8470447">(</span><span class="op" id="8470448">[</span><span class="op" id="8470449">]</span><span class="builtintype" id="8470450">byte</span><span class="op" id="8470454">,</span>&nbsp;<span class="ident" id="8470456">n</span><span class="op" id="8470457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8470460">for</span>&nbsp;<span class="ident" id="8470464">i</span>&nbsp;<span class="op" id="8470466">:=</span>&nbsp;<span class="num" id="8470469">0</span><span class="op" id="8470470">;</span>&nbsp;<span class="ident" id="8470472">i</span>&nbsp;<span class="op" id="8470474">&lt;</span>&nbsp;<span class="ident" id="8470476">n</span><span class="op" id="8470477">;</span>&nbsp;<span class="ident" id="8470479">i</span><span class="op" id="8470480">++</span>&nbsp;<span class="op" id="8470483">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8470487">r</span><span class="op" id="8470488">[</span><span class="ident" id="8470489">i</span><span class="op" id="8470490">]</span>&nbsp;<span class="op" id="8470492">=</span>&nbsp;<span class="builtintype" id="8470494">byte</span><span class="op" id="8470498">(</span><span class="ident" id="8470499">rand</span><span class="op" id="8470503">.</span><span class="ident" id="8470504">Int31</span><span class="op" id="8470509">(</span><span class="op" id="8470510">)</span><span class="op" id="8470511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8470514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8470517">return</span>&nbsp;<span class="ident" id="8470524">r</span><br>
<span class="lineno"></span><span class="op" id="8470526">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="8470529">func</span>&nbsp;<span class="ident" id="8470534">randomString</span><span class="op" id="8470546">(</span><span class="ident" id="8470547">n</span>&nbsp;<span class="builtintype" id="8470549">int</span><span class="op" id="8470552">,</span>&nbsp;<span class="ident" id="8470554">rand</span>&nbsp;<span class="op" id="8470559">*</span><span class="ident" id="8470560">rand</span><span class="op" id="8470564">.</span><span class="ident" id="8470565">Rand</span><span class="op" id="8470569">)</span>&nbsp;<span class="builtintype" id="8470571">string</span>&nbsp;<span class="op" id="8470578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8470581">b</span>&nbsp;<span class="op" id="8470583">:=</span>&nbsp;<span class="ident" id="8470586">randomBytes</span><span class="op" id="8470597">(</span><span class="ident" id="8470598">n</span><span class="op" id="8470599">,</span>&nbsp;<span class="ident" id="8470601">rand</span><span class="op" id="8470605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8470608">return</span>&nbsp;<span class="builtintype" id="8470615">string</span><span class="op" id="8470621">(</span><span class="ident" id="8470622">b</span><span class="op" id="8470623">)</span><br>
<span class="lineno"></span><span class="op" id="8470625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="8470628">func</span>&nbsp;<span class="op" id="8470633">(</span><span class="op" id="8470634">*</span><span class="ident" id="8470635">clientHelloMsg</span><span class="op" id="8470649">)</span>&nbsp;<span class="ident" id="8470651">Generate</span><span class="op" id="8470659">(</span><span class="ident" id="8470660">rand</span>&nbsp;<span class="op" id="8470665">*</span><span class="ident" id="8470666">rand</span><span class="op" id="8470670">.</span><span class="ident" id="8470671">Rand</span><span class="op" id="8470675">,</span>&nbsp;<span class="ident" id="8470677">size</span>&nbsp;<span class="builtintype" id="8470682">int</span><span class="op" id="8470685">)</span>&nbsp;<span class="ident" id="8470687">reflect</span><span class="op" id="8470694">.</span><span class="ident" id="8470695">Value</span>&nbsp;<span class="op" id="8470701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8470704">m</span>&nbsp;<span class="op" id="8470706">:=</span>&nbsp;<span class="op" id="8470709">&amp;</span><span class="ident" id="8470710">clientHelloMsg</span><span class="op" id="8470724">{</span><span class="op" id="8470725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8470728">m</span><span class="op" id="8470729">.</span><span class="ident" id="8470730">vers</span>&nbsp;<span class="op" id="8470735">=</span>&nbsp;<span class="builtintype" id="8470737">uint16</span><span class="op" id="8470743">(</span><span class="ident" id="8470744">rand</span><span class="op" id="8470748">.</span><span class="ident" id="8470749">Intn</span><span class="op" id="8470753">(</span><span class="num" id="8470754">65536</span><span class="op" id="8470759">)</span><span class="op" id="8470760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8470763">m</span><span class="op" id="8470764">.</span><span class="ident" id="8470765">random</span>&nbsp;<span class="op" id="8470772">=</span>&nbsp;<span class="ident" id="8470774">randomBytes</span><span class="op" id="8470785">(</span><span class="num" id="8470786">32</span><span class="op" id="8470788">,</span>&nbsp;<span class="ident" id="8470790">rand</span><span class="op" id="8470794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8470797">m</span><span class="op" id="8470798">.</span><span class="ident" id="8470799">sessionId</span>&nbsp;<span class="op" id="8470809">=</span>&nbsp;<span class="ident" id="8470811">randomBytes</span><span class="op" id="8470822">(</span><span class="ident" id="8470823">rand</span><span class="op" id="8470827">.</span><span class="ident" id="8470828">Intn</span><span class="op" id="8470832">(</span><span class="num" id="8470833">32</span><span class="op" id="8470835">)</span><span class="op" id="8470836">,</span>&nbsp;<span class="ident" id="8470838">rand</span><span class="op" id="8470842">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8470845">m</span><span class="op" id="8470846">.</span><span class="ident" id="8470847">cipherSuites</span>&nbsp;<span class="op" id="8470860">=</span>&nbsp;<span class="builtinfunc" id="8470862">make</span><span class="op" id="8470866">(</span><span class="op" id="8470867">[</span><span class="op" id="8470868">]</span><span class="builtintype" id="8470869">uint16</span><span class="op" id="8470875">,</span>&nbsp;<span class="ident" id="8470877">rand</span><span class="op" id="8470881">.</span><span class="ident" id="8470882">Intn</span><span class="op" id="8470886">(</span><span class="num" id="8470887">63</span><span class="op" id="8470889">)</span><span class="op" id="8470890">+</span><span class="num" id="8470891">1</span><span class="op" id="8470892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8470895">for</span>&nbsp;<span class="ident" id="8470899">i</span>&nbsp;<span class="op" id="8470901">:=</span>&nbsp;<span class="num" id="8470904">0</span><span class="op" id="8470905">;</span>&nbsp;<span class="ident" id="8470907">i</span>&nbsp;<span class="op" id="8470909">&lt;</span>&nbsp;<span class="builtinfunc" id="8470911">len</span><span class="op" id="8470914">(</span><span class="ident" id="8470915">m</span><span class="op" id="8470916">.</span><span class="ident" id="8470917">cipherSuites</span><span class="op" id="8470929">)</span><span class="op" id="8470930">;</span>&nbsp;<span class="ident" id="8470932">i</span><span class="op" id="8470933">++</span>&nbsp;<span class="op" id="8470936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8470940">m</span><span class="op" id="8470941">.</span><span class="ident" id="8470942">cipherSuites</span><span class="op" id="8470954">[</span><span class="ident" id="8470955">i</span><span class="op" id="8470956">]</span>&nbsp;<span class="op" id="8470958">=</span>&nbsp;<span class="builtintype" id="8470960">uint16</span><span class="op" id="8470966">(</span><span class="ident" id="8470967">rand</span><span class="op" id="8470971">.</span><span class="ident" id="8470972">Int31</span><span class="op" id="8470977">(</span><span class="op" id="8470978">)</span><span class="op" id="8470979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8470982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8470985">m</span><span class="op" id="8470986">.</span><span class="ident" id="8470987">compressionMethods</span>&nbsp;<span class="op" id="8471006">=</span>&nbsp;<span class="ident" id="8471008">randomBytes</span><span class="op" id="8471019">(</span><span class="ident" id="8471020">rand</span><span class="op" id="8471024">.</span><span class="ident" id="8471025">Intn</span><span class="op" id="8471029">(</span><span class="num" id="8471030">63</span><span class="op" id="8471032">)</span><span class="op" id="8471033">+</span><span class="num" id="8471034">1</span><span class="op" id="8471035">,</span>&nbsp;<span class="ident" id="8471037">rand</span><span class="op" id="8471041">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8471044">if</span>&nbsp;<span class="ident" id="8471047">rand</span><span class="op" id="8471051">.</span><span class="ident" id="8471052">Intn</span><span class="op" id="8471056">(</span><span class="num" id="8471057">10</span><span class="op" id="8471059">)</span>&nbsp;<span class="op" id="8471061">&gt;</span>&nbsp;<span class="num" id="8471063">5</span>&nbsp;<span class="op" id="8471065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8471069">m</span><span class="op" id="8471070">.</span><span class="ident" id="8471071">nextProtoNeg</span>&nbsp;<span class="op" id="8471084">=</span>&nbsp;<span class="builtintype" id="8471086">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8471092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8471095">if</span>&nbsp;<span class="ident" id="8471098">rand</span><span class="op" id="8471102">.</span><span class="ident" id="8471103">Intn</span><span class="op" id="8471107">(</span><span class="num" id="8471108">10</span><span class="op" id="8471110">)</span>&nbsp;<span class="op" id="8471112">&gt;</span>&nbsp;<span class="num" id="8471114">5</span>&nbsp;<span class="op" id="8471116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8471120">m</span><span class="op" id="8471121">.</span><span class="ident" id="8471122">serverName</span>&nbsp;<span class="op" id="8471133">=</span>&nbsp;<span class="ident" id="8471135">randomString</span><span class="op" id="8471147">(</span><span class="ident" id="8471148">rand</span><span class="op" id="8471152">.</span><span class="ident" id="8471153">Intn</span><span class="op" id="8471157">(</span><span class="num" id="8471158">255</span><span class="op" id="8471161">)</span><span class="op" id="8471162">,</span>&nbsp;<span class="ident" id="8471164">rand</span><span class="op" id="8471168">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8471171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8471174">m</span><span class="op" id="8471175">.</span><span class="ident" id="8471176">ocspStapling</span>&nbsp;<span class="op" id="8471189">=</span>&nbsp;<span class="ident" id="8471191">rand</span><span class="op" id="8471195">.</span><span class="ident" id="8471196">Intn</span><span class="op" id="8471200">(</span><span class="num" id="8471201">10</span><span class="op" id="8471203">)</span>&nbsp;<span class="op" id="8471205">&gt;</span>&nbsp;<span class="num" id="8471207">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8471210">m</span><span class="op" id="8471211">.</span><span class="ident" id="8471212">supportedPoints</span>&nbsp;<span class="op" id="8471228">=</span>&nbsp;<span class="ident" id="8471230">randomBytes</span><span class="op" id="8471241">(</span><span class="ident" id="8471242">rand</span><span class="op" id="8471246">.</span><span class="ident" id="8471247">Intn</span><span class="op" id="8471251">(</span><span class="num" id="8471252">5</span><span class="op" id="8471253">)</span><span class="op" id="8471254">+</span><span class="num" id="8471255">1</span><span class="op" id="8471256">,</span>&nbsp;<span class="ident" id="8471258">rand</span><span class="op" id="8471262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8471265">m</span><span class="op" id="8471266">.</span><span class="ident" id="8471267">supportedCurves</span>&nbsp;<span class="op" id="8471283">=</span>&nbsp;<span class="builtinfunc" id="8471285">make</span><span class="op" id="8471289">(</span><span class="op" id="8471290">[</span><span class="op" id="8471291">]</span><span class="ident" id="8471292">CurveID</span><span class="op" id="8471299">,</span>&nbsp;<span class="ident" id="8471301">rand</span><span class="op" id="8471305">.</span><span class="ident" id="8471306">Intn</span><span class="op" id="8471310">(</span><span class="num" id="8471311">5</span><span class="op" id="8471312">)</span><span class="op" id="8471313">+</span><span class="num" id="8471314">1</span><span class="op" id="8471315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8471318">for</span>&nbsp;<span class="ident" id="8471322">i</span>&nbsp;<span class="op" id="8471324">:=</span>&nbsp;<span class="keyword" id="8471327">range</span>&nbsp;<span class="ident" id="8471333">m</span><span class="op" id="8471334">.</span><span class="ident" id="8471335">supportedCurves</span>&nbsp;<span class="op" id="8471351">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8471355">m</span><span class="op" id="8471356">.</span><span class="ident" id="8471357">supportedCurves</span><span class="op" id="8471372">[</span><span class="ident" id="8471373">i</span><span class="op" id="8471374">]</span>&nbsp;<span class="op" id="8471376">=</span>&nbsp;<span class="ident" id="8471378">CurveID</span><span class="op" id="8471385">(</span><span class="ident" id="8471386">rand</span><span class="op" id="8471390">.</span><span class="ident" id="8471391">Intn</span><span class="op" id="8471395">(</span><span class="num" id="8471396">30000</span><span class="op" id="8471401">)</span><span class="op" id="8471402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8471405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8471408">if</span>&nbsp;<span class="ident" id="8471411">rand</span><span class="op" id="8471415">.</span><span class="ident" id="8471416">Intn</span><span class="op" id="8471420">(</span><span class="num" id="8471421">10</span><span class="op" id="8471423">)</span>&nbsp;<span class="op" id="8471425">&gt;</span>&nbsp;<span class="num" id="8471427">5</span>&nbsp;<span class="op" id="8471429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8471433">m</span><span class="op" id="8471434">.</span><span class="ident" id="8471435">ticketSupported</span>&nbsp;<span class="op" id="8471451">=</span>&nbsp;<span class="builtintype" id="8471453">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8471460">if</span>&nbsp;<span class="ident" id="8471463">rand</span><span class="op" id="8471467">.</span><span class="ident" id="8471468">Intn</span><span class="op" id="8471472">(</span><span class="num" id="8471473">10</span><span class="op" id="8471475">)</span>&nbsp;<span class="op" id="8471477">&gt;</span>&nbsp;<span class="num" id="8471479">5</span>&nbsp;<span class="op" id="8471481">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8471486">m</span><span class="op" id="8471487">.</span><span class="ident" id="8471488">sessionTicket</span>&nbsp;<span class="op" id="8471502">=</span>&nbsp;<span class="ident" id="8471504">randomBytes</span><span class="op" id="8471515">(</span><span class="ident" id="8471516">rand</span><span class="op" id="8471520">.</span><span class="ident" id="8471521">Intn</span><span class="op" id="8471525">(</span><span class="num" id="8471526">300</span><span class="op" id="8471529">)</span><span class="op" id="8471530">,</span>&nbsp;<span class="ident" id="8471532">rand</span><span class="op" id="8471536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8471540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8471543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8471546">if</span>&nbsp;<span class="ident" id="8471549">rand</span><span class="op" id="8471553">.</span><span class="ident" id="8471554">Intn</span><span class="op" id="8471558">(</span><span class="num" id="8471559">10</span><span class="op" id="8471561">)</span>&nbsp;<span class="op" id="8471563">&gt;</span>&nbsp;<span class="num" id="8471565">5</span>&nbsp;<span class="op" id="8471567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8471571">m</span><span class="op" id="8471572">.</span><span class="ident" id="8471573">signatureAndHashes</span>&nbsp;<span class="op" id="8471592">=</span>&nbsp;<span class="ident" id="8471594">supportedSKXSignatureAlgorithms</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8471627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8471630">m</span><span class="op" id="8471631">.</span><span class="ident" id="8471632">alpnProtocols</span>&nbsp;<span class="op" id="8471646">=</span>&nbsp;<span class="builtinfunc" id="8471648">make</span><span class="op" id="8471652">(</span><span class="op" id="8471653">[</span><span class="op" id="8471654">]</span><span class="builtintype" id="8471655">string</span><span class="op" id="8471661">,</span>&nbsp;<span class="ident" id="8471663">rand</span><span class="op" id="8471667">.</span><span class="ident" id="8471668">Intn</span><span class="op" id="8471672">(</span><span class="num" id="8471673">5</span><span class="op" id="8471674">)</span><span class="op" id="8471675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8471678">for</span>&nbsp;<span class="ident" id="8471682">i</span>&nbsp;<span class="op" id="8471684">:=</span>&nbsp;<span class="keyword" id="8471687">range</span>&nbsp;<span class="ident" id="8471693">m</span><span class="op" id="8471694">.</span><span class="ident" id="8471695">alpnProtocols</span>&nbsp;<span class="op" id="8471709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8471713">m</span><span class="op" id="8471714">.</span><span class="ident" id="8471715">alpnProtocols</span><span class="op" id="8471728">[</span><span class="ident" id="8471729">i</span><span class="op" id="8471730">]</span>&nbsp;<span class="op" id="8471732">=</span>&nbsp;<span class="ident" id="8471734">randomString</span><span class="op" id="8471746">(</span><span class="ident" id="8471747">rand</span><span class="op" id="8471751">.</span><span class="ident" id="8471752">Intn</span><span class="op" id="8471756">(</span><span class="num" id="8471757">20</span><span class="op" id="8471759">)</span><span class="op" id="8471760">+</span><span class="num" id="8471761">1</span><span class="op" id="8471762">,</span>&nbsp;<span class="ident" id="8471764">rand</span><span class="op" id="8471768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8471771">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8471775">return</span>&nbsp;<span class="ident" id="8471782">reflect</span><span class="op" id="8471789">.</span><span class="ident" id="8471790">ValueOf</span><span class="op" id="8471797">(</span><span class="ident" id="8471798">m</span><span class="op" id="8471799">)</span><br>
<span class="lineno"></span><span class="op" id="8471801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8471804">func</span>&nbsp;<span class="op" id="8471809">(</span><span class="op" id="8471810">*</span><span class="ident" id="8471811">serverHelloMsg</span><span class="op" id="8471825">)</span>&nbsp;<span class="ident" id="8471827">Generate</span><span class="op" id="8471835">(</span><span class="ident" id="8471836">rand</span>&nbsp;<span class="op" id="8471841">*</span><span class="ident" id="8471842">rand</span><span class="op" id="8471846">.</span><span class="ident" id="8471847">Rand</span><span class="op" id="8471851">,</span>&nbsp;<span class="ident" id="8471853">size</span>&nbsp;<span class="builtintype" id="8471858">int</span><span class="op" id="8471861">)</span>&nbsp;<span class="ident" id="8471863">reflect</span><span class="op" id="8471870">.</span><span class="ident" id="8471871">Value</span>&nbsp;<span class="op" id="8471877">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8471880">m</span>&nbsp;<span class="op" id="8471882">:=</span>&nbsp;<span class="op" id="8471885">&amp;</span><span class="ident" id="8471886">serverHelloMsg</span><span class="op" id="8471900">{</span><span class="op" id="8471901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8471904">m</span><span class="op" id="8471905">.</span><span class="ident" id="8471906">vers</span>&nbsp;<span class="op" id="8471911">=</span>&nbsp;<span class="builtintype" id="8471913">uint16</span><span class="op" id="8471919">(</span><span class="ident" id="8471920">rand</span><span class="op" id="8471924">.</span><span class="ident" id="8471925">Intn</span><span class="op" id="8471929">(</span><span class="num" id="8471930">65536</span><span class="op" id="8471935">)</span><span class="op" id="8471936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8471939">m</span><span class="op" id="8471940">.</span><span class="ident" id="8471941">random</span>&nbsp;<span class="op" id="8471948">=</span>&nbsp;<span class="ident" id="8471950">randomBytes</span><span class="op" id="8471961">(</span><span class="num" id="8471962">32</span><span class="op" id="8471964">,</span>&nbsp;<span class="ident" id="8471966">rand</span><span class="op" id="8471970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8471973">m</span><span class="op" id="8471974">.</span><span class="ident" id="8471975">sessionId</span>&nbsp;<span class="op" id="8471985">=</span>&nbsp;<span class="ident" id="8471987">randomBytes</span><span class="op" id="8471998">(</span><span class="ident" id="8471999">rand</span><span class="op" id="8472003">.</span><span class="ident" id="8472004">Intn</span><span class="op" id="8472008">(</span><span class="num" id="8472009">32</span><span class="op" id="8472011">)</span><span class="op" id="8472012">,</span>&nbsp;<span class="ident" id="8472014">rand</span><span class="op" id="8472018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472021">m</span><span class="op" id="8472022">.</span><span class="ident" id="8472023">cipherSuite</span>&nbsp;<span class="op" id="8472035">=</span>&nbsp;<span class="builtintype" id="8472037">uint16</span><span class="op" id="8472043">(</span><span class="ident" id="8472044">rand</span><span class="op" id="8472048">.</span><span class="ident" id="8472049">Int31</span><span class="op" id="8472054">(</span><span class="op" id="8472055">)</span><span class="op" id="8472056">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472059">m</span><span class="op" id="8472060">.</span><span class="ident" id="8472061">compressionMethod</span>&nbsp;<span class="op" id="8472079">=</span>&nbsp;<span class="builtintype" id="8472081">uint8</span><span class="op" id="8472086">(</span><span class="ident" id="8472087">rand</span><span class="op" id="8472091">.</span><span class="ident" id="8472092">Intn</span><span class="op" id="8472096">(</span><span class="num" id="8472097">256</span><span class="op" id="8472100">)</span><span class="op" id="8472101">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8472105">if</span>&nbsp;<span class="ident" id="8472108">rand</span><span class="op" id="8472112">.</span><span class="ident" id="8472113">Intn</span><span class="op" id="8472117">(</span><span class="num" id="8472118">10</span><span class="op" id="8472120">)</span>&nbsp;<span class="op" id="8472122">&gt;</span>&nbsp;<span class="num" id="8472124">5</span>&nbsp;<span class="op" id="8472126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472130">m</span><span class="op" id="8472131">.</span><span class="ident" id="8472132">nextProtoNeg</span>&nbsp;<span class="op" id="8472145">=</span>&nbsp;<span class="builtintype" id="8472147">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472155">n</span>&nbsp;<span class="op" id="8472157">:=</span>&nbsp;<span class="ident" id="8472160">rand</span><span class="op" id="8472164">.</span><span class="ident" id="8472165">Intn</span><span class="op" id="8472169">(</span><span class="num" id="8472170">10</span><span class="op" id="8472172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472176">m</span><span class="op" id="8472177">.</span><span class="ident" id="8472178">nextProtos</span>&nbsp;<span class="op" id="8472189">=</span>&nbsp;<span class="builtinfunc" id="8472191">make</span><span class="op" id="8472195">(</span><span class="op" id="8472196">[</span><span class="op" id="8472197">]</span><span class="builtintype" id="8472198">string</span><span class="op" id="8472204">,</span>&nbsp;<span class="ident" id="8472206">n</span><span class="op" id="8472207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8472211">for</span>&nbsp;<span class="ident" id="8472215">i</span>&nbsp;<span class="op" id="8472217">:=</span>&nbsp;<span class="num" id="8472220">0</span><span class="op" id="8472221">;</span>&nbsp;<span class="ident" id="8472223">i</span>&nbsp;<span class="op" id="8472225">&lt;</span>&nbsp;<span class="ident" id="8472227">n</span><span class="op" id="8472228">;</span>&nbsp;<span class="ident" id="8472230">i</span><span class="op" id="8472231">++</span>&nbsp;<span class="op" id="8472234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472239">m</span><span class="op" id="8472240">.</span><span class="ident" id="8472241">nextProtos</span><span class="op" id="8472251">[</span><span class="ident" id="8472252">i</span><span class="op" id="8472253">]</span>&nbsp;<span class="op" id="8472255">=</span>&nbsp;<span class="ident" id="8472257">randomString</span><span class="op" id="8472269">(</span><span class="num" id="8472270">20</span><span class="op" id="8472272">,</span>&nbsp;<span class="ident" id="8472274">rand</span><span class="op" id="8472278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8472282">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8472285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8472289">if</span>&nbsp;<span class="ident" id="8472292">rand</span><span class="op" id="8472296">.</span><span class="ident" id="8472297">Intn</span><span class="op" id="8472301">(</span><span class="num" id="8472302">10</span><span class="op" id="8472304">)</span>&nbsp;<span class="op" id="8472306">&gt;</span>&nbsp;<span class="num" id="8472308">5</span>&nbsp;<span class="op" id="8472310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472314">m</span><span class="op" id="8472315">.</span><span class="ident" id="8472316">ocspStapling</span>&nbsp;<span class="op" id="8472329">=</span>&nbsp;<span class="builtintype" id="8472331">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8472337">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8472340">if</span>&nbsp;<span class="ident" id="8472343">rand</span><span class="op" id="8472347">.</span><span class="ident" id="8472348">Intn</span><span class="op" id="8472352">(</span><span class="num" id="8472353">10</span><span class="op" id="8472355">)</span>&nbsp;<span class="op" id="8472357">&gt;</span>&nbsp;<span class="num" id="8472359">5</span>&nbsp;<span class="op" id="8472361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472365">m</span><span class="op" id="8472366">.</span><span class="ident" id="8472367">ticketSupported</span>&nbsp;<span class="op" id="8472383">=</span>&nbsp;<span class="builtintype" id="8472385">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8472391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472394">m</span><span class="op" id="8472395">.</span><span class="ident" id="8472396">alpnProtocol</span>&nbsp;<span class="op" id="8472409">=</span>&nbsp;<span class="ident" id="8472411">randomString</span><span class="op" id="8472423">(</span><span class="ident" id="8472424">rand</span><span class="op" id="8472428">.</span><span class="ident" id="8472429">Intn</span><span class="op" id="8472433">(</span><span class="num" id="8472434">32</span><span class="op" id="8472436">)</span><span class="op" id="8472437">+</span><span class="num" id="8472438">1</span><span class="op" id="8472439">,</span>&nbsp;<span class="ident" id="8472441">rand</span><span class="op" id="8472445">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8472449">return</span>&nbsp;<span class="ident" id="8472456">reflect</span><span class="op" id="8472463">.</span><span class="ident" id="8472464">ValueOf</span><span class="op" id="8472471">(</span><span class="ident" id="8472472">m</span><span class="op" id="8472473">)</span><br>
<span class="lineno"></span><span class="op" id="8472475">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8472478">func</span>&nbsp;<span class="op" id="8472483">(</span><span class="op" id="8472484">*</span><span class="ident" id="8472485">certificateMsg</span><span class="op" id="8472499">)</span>&nbsp;<span class="ident" id="8472501">Generate</span><span class="op" id="8472509">(</span><span class="ident" id="8472510">rand</span>&nbsp;<span class="op" id="8472515">*</span><span class="ident" id="8472516">rand</span><span class="op" id="8472520">.</span><span class="ident" id="8472521">Rand</span><span class="op" id="8472525">,</span>&nbsp;<span class="ident" id="8472527">size</span>&nbsp;<span class="builtintype" id="8472532">int</span><span class="op" id="8472535">)</span>&nbsp;<span class="ident" id="8472537">reflect</span><span class="op" id="8472544">.</span><span class="ident" id="8472545">Value</span>&nbsp;<span class="op" id="8472551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472554">m</span>&nbsp;<span class="op" id="8472556">:=</span>&nbsp;<span class="op" id="8472559">&amp;</span><span class="ident" id="8472560">certificateMsg</span><span class="op" id="8472574">{</span><span class="op" id="8472575">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472578">numCerts</span>&nbsp;<span class="op" id="8472587">:=</span>&nbsp;<span class="ident" id="8472590">rand</span><span class="op" id="8472594">.</span><span class="ident" id="8472595">Intn</span><span class="op" id="8472599">(</span><span class="num" id="8472600">20</span><span class="op" id="8472602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472605">m</span><span class="op" id="8472606">.</span><span class="ident" id="8472607">certificates</span>&nbsp;<span class="op" id="8472620">=</span>&nbsp;<span class="builtinfunc" id="8472622">make</span><span class="op" id="8472626">(</span><span class="op" id="8472627">[</span><span class="op" id="8472628">]</span><span class="op" id="8472629">[</span><span class="op" id="8472630">]</span><span class="builtintype" id="8472631">byte</span><span class="op" id="8472635">,</span>&nbsp;<span class="ident" id="8472637">numCerts</span><span class="op" id="8472645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8472648">for</span>&nbsp;<span class="ident" id="8472652">i</span>&nbsp;<span class="op" id="8472654">:=</span>&nbsp;<span class="num" id="8472657">0</span><span class="op" id="8472658">;</span>&nbsp;<span class="ident" id="8472660">i</span>&nbsp;<span class="op" id="8472662">&lt;</span>&nbsp;<span class="ident" id="8472664">numCerts</span><span class="op" id="8472672">;</span>&nbsp;<span class="ident" id="8472674">i</span><span class="op" id="8472675">++</span>&nbsp;<span class="op" id="8472678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472682">m</span><span class="op" id="8472683">.</span><span class="ident" id="8472684">certificates</span><span class="op" id="8472696">[</span><span class="ident" id="8472697">i</span><span class="op" id="8472698">]</span>&nbsp;<span class="op" id="8472700">=</span>&nbsp;<span class="ident" id="8472702">randomBytes</span><span class="op" id="8472713">(</span><span class="ident" id="8472714">rand</span><span class="op" id="8472718">.</span><span class="ident" id="8472719">Intn</span><span class="op" id="8472723">(</span><span class="num" id="8472724">10</span><span class="op" id="8472726">)</span><span class="op" id="8472727">+</span><span class="num" id="8472728">1</span><span class="op" id="8472729">,</span>&nbsp;<span class="ident" id="8472731">rand</span><span class="op" id="8472735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8472738">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8472741">return</span>&nbsp;<span class="ident" id="8472748">reflect</span><span class="op" id="8472755">.</span><span class="ident" id="8472756">ValueOf</span><span class="op" id="8472763">(</span><span class="ident" id="8472764">m</span><span class="op" id="8472765">)</span><br>
<span class="lineno"></span><span class="op" id="8472767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8472770">func</span>&nbsp;<span class="op" id="8472775">(</span><span class="op" id="8472776">*</span><span class="ident" id="8472777">certificateRequestMsg</span><span class="op" id="8472798">)</span>&nbsp;<span class="ident" id="8472800">Generate</span><span class="op" id="8472808">(</span><span class="ident" id="8472809">rand</span>&nbsp;<span class="op" id="8472814">*</span><span class="ident" id="8472815">rand</span><span class="op" id="8472819">.</span><span class="ident" id="8472820">Rand</span><span class="op" id="8472824">,</span>&nbsp;<span class="ident" id="8472826">size</span>&nbsp;<span class="builtintype" id="8472831">int</span><span class="op" id="8472834">)</span>&nbsp;<span class="ident" id="8472836">reflect</span><span class="op" id="8472843">.</span><span class="ident" id="8472844">Value</span>&nbsp;<span class="op" id="8472850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472853">m</span>&nbsp;<span class="op" id="8472855">:=</span>&nbsp;<span class="op" id="8472858">&amp;</span><span class="ident" id="8472859">certificateRequestMsg</span><span class="op" id="8472880">{</span><span class="op" id="8472881">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472884">m</span><span class="op" id="8472885">.</span><span class="ident" id="8472886">certificateTypes</span>&nbsp;<span class="op" id="8472903">=</span>&nbsp;<span class="ident" id="8472905">randomBytes</span><span class="op" id="8472916">(</span><span class="ident" id="8472917">rand</span><span class="op" id="8472921">.</span><span class="ident" id="8472922">Intn</span><span class="op" id="8472926">(</span><span class="num" id="8472927">5</span><span class="op" id="8472928">)</span><span class="op" id="8472929">+</span><span class="num" id="8472930">1</span><span class="op" id="8472931">,</span>&nbsp;<span class="ident" id="8472933">rand</span><span class="op" id="8472937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472940">numCAs</span>&nbsp;<span class="op" id="8472947">:=</span>&nbsp;<span class="ident" id="8472950">rand</span><span class="op" id="8472954">.</span><span class="ident" id="8472955">Intn</span><span class="op" id="8472959">(</span><span class="num" id="8472960">100</span><span class="op" id="8472963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472966">m</span><span class="op" id="8472967">.</span><span class="ident" id="8472968">certificateAuthorities</span>&nbsp;<span class="op" id="8472991">=</span>&nbsp;<span class="builtinfunc" id="8472993">make</span><span class="op" id="8472997">(</span><span class="op" id="8472998">[</span><span class="op" id="8472999">]</span><span class="op" id="8473000">[</span><span class="op" id="8473001">]</span><span class="builtintype" id="8473002">byte</span><span class="op" id="8473006">,</span>&nbsp;<span class="ident" id="8473008">numCAs</span><span class="op" id="8473014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8473017">for</span>&nbsp;<span class="ident" id="8473021">i</span>&nbsp;<span class="op" id="8473023">:=</span>&nbsp;<span class="num" id="8473026">0</span><span class="op" id="8473027">;</span>&nbsp;<span class="ident" id="8473029">i</span>&nbsp;<span class="op" id="8473031">&lt;</span>&nbsp;<span class="ident" id="8473033">numCAs</span><span class="op" id="8473039">;</span>&nbsp;<span class="ident" id="8473041">i</span><span class="op" id="8473042">++</span>&nbsp;<span class="op" id="8473045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8473049">m</span><span class="op" id="8473050">.</span><span class="ident" id="8473051">certificateAuthorities</span><span class="op" id="8473073">[</span><span class="ident" id="8473074">i</span><span class="op" id="8473075">]</span>&nbsp;<span class="op" id="8473077">=</span>&nbsp;<span class="ident" id="8473079">randomBytes</span><span class="op" id="8473090">(</span><span class="ident" id="8473091">rand</span><span class="op" id="8473095">.</span><span class="ident" id="8473096">Intn</span><span class="op" id="8473100">(</span><span class="num" id="8473101">15</span><span class="op" id="8473103">)</span><span class="op" id="8473104">+</span><span class="num" id="8473105">1</span><span class="op" id="8473106">,</span>&nbsp;<span class="ident" id="8473108">rand</span><span class="op" id="8473112">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8473115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8473118">return</span>&nbsp;<span class="ident" id="8473125">reflect</span><span class="op" id="8473132">.</span><span class="ident" id="8473133">ValueOf</span><span class="op" id="8473140">(</span><span class="ident" id="8473141">m</span><span class="op" id="8473142">)</span><br>
<span class="lineno"></span><span class="op" id="8473144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8473147">func</span>&nbsp;<span class="op" id="8473152">(</span><span class="op" id="8473153">*</span><span class="ident" id="8473154">certificateVerifyMsg</span><span class="op" id="8473174">)</span>&nbsp;<span class="ident" id="8473176">Generate</span><span class="op" id="8473184">(</span><span class="ident" id="8473185">rand</span>&nbsp;<span class="op" id="8473190">*</span><span class="ident" id="8473191">rand</span><span class="op" id="8473195">.</span><span class="ident" id="8473196">Rand</span><span class="op" id="8473200">,</span>&nbsp;<span class="ident" id="8473202">size</span>&nbsp;<span class="builtintype" id="8473207">int</span><span class="op" id="8473210">)</span>&nbsp;<span class="ident" id="8473212">reflect</span><span class="op" id="8473219">.</span><span class="ident" id="8473220">Value</span>&nbsp;<span class="op" id="8473226">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8473229">m</span>&nbsp;<span class="op" id="8473231">:=</span>&nbsp;<span class="op" id="8473234">&amp;</span><span class="ident" id="8473235">certificateVerifyMsg</span><span class="op" id="8473255">{</span><span class="op" id="8473256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8473259">m</span><span class="op" id="8473260">.</span><span class="ident" id="8473261">signature</span>&nbsp;<span class="op" id="8473271">=</span>&nbsp;<span class="ident" id="8473273">randomBytes</span><span class="op" id="8473284">(</span><span class="ident" id="8473285">rand</span><span class="op" id="8473289">.</span><span class="ident" id="8473290">Intn</span><span class="op" id="8473294">(</span><span class="num" id="8473295">15</span><span class="op" id="8473297">)</span><span class="op" id="8473298">+</span><span class="num" id="8473299">1</span><span class="op" id="8473300">,</span>&nbsp;<span class="ident" id="8473302">rand</span><span class="op" id="8473306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8473309">return</span>&nbsp;<span class="ident" id="8473316">reflect</span><span class="op" id="8473323">.</span><span class="ident" id="8473324">ValueOf</span><span class="op" id="8473331">(</span><span class="ident" id="8473332">m</span><span class="op" id="8473333">)</span><br>
<span class="lineno"></span><span class="op" id="8473335">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="keyword" id="8473338">func</span>&nbsp;<span class="op" id="8473343">(</span><span class="op" id="8473344">*</span><span class="ident" id="8473345">certificateStatusMsg</span><span class="op" id="8473365">)</span>&nbsp;<span class="ident" id="8473367">Generate</span><span class="op" id="8473375">(</span><span class="ident" id="8473376">rand</span>&nbsp;<span class="op" id="8473381">*</span><span class="ident" id="8473382">rand</span><span class="op" id="8473386">.</span><span class="ident" id="8473387">Rand</span><span class="op" id="8473391">,</span>&nbsp;<span class="ident" id="8473393">size</span>&nbsp;<span class="builtintype" id="8473398">int</span><span class="op" id="8473401">)</span>&nbsp;<span class="ident" id="8473403">reflect</span><span class="op" id="8473410">.</span><span class="ident" id="8473411">Value</span>&nbsp;<span class="op" id="8473417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8473420">m</span>&nbsp;<span class="op" id="8473422">:=</span>&nbsp;<span class="op" id="8473425">&amp;</span><span class="ident" id="8473426">certificateStatusMsg</span><span class="op" id="8473446">{</span><span class="op" id="8473447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8473450">if</span>&nbsp;<span class="ident" id="8473453">rand</span><span class="op" id="8473457">.</span><span class="ident" id="8473458">Intn</span><span class="op" id="8473462">(</span><span class="num" id="8473463">10</span><span class="op" id="8473465">)</span>&nbsp;<span class="op" id="8473467">&gt;</span>&nbsp;<span class="num" id="8473469">5</span>&nbsp;<span class="op" id="8473471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8473475">m</span><span class="op" id="8473476">.</span><span class="ident" id="8473477">statusType</span>&nbsp;<span class="op" id="8473488">=</span>&nbsp;<span class="ident" id="8473490">statusTypeOCSP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8473507">m</span><span class="op" id="8473508">.</span><span class="ident" id="8473509">response</span>&nbsp;<span class="op" id="8473518">=</span>&nbsp;<span class="ident" id="8473520">randomBytes</span><span class="op" id="8473531">(</span><span class="ident" id="8473532">rand</span><span class="op" id="8473536">.</span><span class="ident" id="8473537">Intn</span><span class="op" id="8473541">(</span><span class="num" id="8473542">10</span><span class="op" id="8473544">)</span><span class="op" id="8473545">+</span><span class="num" id="8473546">1</span><span class="op" id="8473547">,</span>&nbsp;<span class="ident" id="8473549">rand</span><span class="op" id="8473553">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8473556">}</span>&nbsp;<span class="keyword" id="8473558">else</span>&nbsp;<span class="op" id="8473563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8473567">m</span><span class="op" id="8473568">.</span><span class="ident" id="8473569">statusType</span>&nbsp;<span class="op" id="8473580">=</span>&nbsp;<span class="num" id="8473582">42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8473586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8473589">return</span>&nbsp;<span class="ident" id="8473596">reflect</span><span class="op" id="8473603">.</span><span class="ident" id="8473604">ValueOf</span><span class="op" id="8473611">(</span><span class="ident" id="8473612">m</span><span class="op" id="8473613">)</span><br>
<span class="lineno"></span><span class="op" id="8473615">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="8473618">func</span>&nbsp;<span class="op" id="8473623">(</span><span class="op" id="8473624">*</span><span class="ident" id="8473625">clientKeyExchangeMsg</span><span class="op" id="8473645">)</span>&nbsp;<span class="ident" id="8473647">Generate</span><span class="op" id="8473655">(</span><span class="ident" id="8473656">rand</span>&nbsp;<span class="op" id="8473661">*</span><span class="ident" id="8473662">rand</span><span class="op" id="8473666">.</span><span class="ident" id="8473667">Rand</span><span class="op" id="8473671">,</span>&nbsp;<span class="ident" id="8473673">size</span>&nbsp;<span class="builtintype" id="8473678">int</span><span class="op" id="8473681">)</span>&nbsp;<span class="ident" id="8473683">reflect</span><span class="op" id="8473690">.</span><span class="ident" id="8473691">Value</span>&nbsp;<span class="op" id="8473697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8473700">m</span>&nbsp;<span class="op" id="8473702">:=</span>&nbsp;<span class="op" id="8473705">&amp;</span><span class="ident" id="8473706">clientKeyExchangeMsg</span><span class="op" id="8473726">{</span><span class="op" id="8473727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8473730">m</span><span class="op" id="8473731">.</span><span class="ident" id="8473732">ciphertext</span>&nbsp;<span class="op" id="8473743">=</span>&nbsp;<span class="ident" id="8473745">randomBytes</span><span class="op" id="8473756">(</span><span class="ident" id="8473757">rand</span><span class="op" id="8473761">.</span><span class="ident" id="8473762">Intn</span><span class="op" id="8473766">(</span><span class="num" id="8473767">1000</span><span class="op" id="8473771">)</span><span class="op" id="8473772">+</span><span class="num" id="8473773">1</span><span class="op" id="8473774">,</span>&nbsp;<span class="ident" id="8473776">rand</span><span class="op" id="8473780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8473783">return</span>&nbsp;<span class="ident" id="8473790">reflect</span><span class="op" id="8473797">.</span><span class="ident" id="8473798">ValueOf</span><span class="op" id="8473805">(</span><span class="ident" id="8473806">m</span><span class="op" id="8473807">)</span><br>
<span class="lineno">220</span><span class="op" id="8473809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8473812">func</span>&nbsp;<span class="op" id="8473817">(</span><span class="op" id="8473818">*</span><span class="ident" id="8473819">finishedMsg</span><span class="op" id="8473830">)</span>&nbsp;<span class="ident" id="8473832">Generate</span><span class="op" id="8473840">(</span><span class="ident" id="8473841">rand</span>&nbsp;<span class="op" id="8473846">*</span><span class="ident" id="8473847">rand</span><span class="op" id="8473851">.</span><span class="ident" id="8473852">Rand</span><span class="op" id="8473856">,</span>&nbsp;<span class="ident" id="8473858">size</span>&nbsp;<span class="builtintype" id="8473863">int</span><span class="op" id="8473866">)</span>&nbsp;<span class="ident" id="8473868">reflect</span><span class="op" id="8473875">.</span><span class="ident" id="8473876">Value</span>&nbsp;<span class="op" id="8473882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8473885">m</span>&nbsp;<span class="op" id="8473887">:=</span>&nbsp;<span class="op" id="8473890">&amp;</span><span class="ident" id="8473891">finishedMsg</span><span class="op" id="8473902">{</span><span class="op" id="8473903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8473906">m</span><span class="op" id="8473907">.</span><span class="ident" id="8473908">verifyData</span>&nbsp;<span class="op" id="8473919">=</span>&nbsp;<span class="ident" id="8473921">randomBytes</span><span class="op" id="8473932">(</span><span class="num" id="8473933">12</span><span class="op" id="8473935">,</span>&nbsp;<span class="ident" id="8473937">rand</span><span class="op" id="8473941">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8473944">return</span>&nbsp;<span class="ident" id="8473951">reflect</span><span class="op" id="8473958">.</span><span class="ident" id="8473959">ValueOf</span><span class="op" id="8473966">(</span><span class="ident" id="8473967">m</span><span class="op" id="8473968">)</span><br>
<span class="lineno"></span><span class="op" id="8473970">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8473973">func</span>&nbsp;<span class="op" id="8473978">(</span><span class="op" id="8473979">*</span><span class="ident" id="8473980">nextProtoMsg</span><span class="op" id="8473992">)</span>&nbsp;<span class="ident" id="8473994">Generate</span><span class="op" id="8474002">(</span><span class="ident" id="8474003">rand</span>&nbsp;<span class="op" id="8474008">*</span><span class="ident" id="8474009">rand</span><span class="op" id="8474013">.</span><span class="ident" id="8474014">Rand</span><span class="op" id="8474018">,</span>&nbsp;<span class="ident" id="8474020">size</span>&nbsp;<span class="builtintype" id="8474025">int</span><span class="op" id="8474028">)</span>&nbsp;<span class="ident" id="8474030">reflect</span><span class="op" id="8474037">.</span><span class="ident" id="8474038">Value</span>&nbsp;<span class="op" id="8474044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474047">m</span>&nbsp;<span class="op" id="8474049">:=</span>&nbsp;<span class="op" id="8474052">&amp;</span><span class="ident" id="8474053">nextProtoMsg</span><span class="op" id="8474065">{</span><span class="op" id="8474066">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474069">m</span><span class="op" id="8474070">.</span><span class="ident" id="8474071">proto</span>&nbsp;<span class="op" id="8474077">=</span>&nbsp;<span class="ident" id="8474079">randomString</span><span class="op" id="8474091">(</span><span class="ident" id="8474092">rand</span><span class="op" id="8474096">.</span><span class="ident" id="8474097">Intn</span><span class="op" id="8474101">(</span><span class="num" id="8474102">255</span><span class="op" id="8474105">)</span><span class="op" id="8474106">,</span>&nbsp;<span class="ident" id="8474108">rand</span><span class="op" id="8474112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8474115">return</span>&nbsp;<span class="ident" id="8474122">reflect</span><span class="op" id="8474129">.</span><span class="ident" id="8474130">ValueOf</span><span class="op" id="8474137">(</span><span class="ident" id="8474138">m</span><span class="op" id="8474139">)</span><br>
<span class="lineno"></span><span class="op" id="8474141">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8474144">func</span>&nbsp;<span class="op" id="8474149">(</span><span class="op" id="8474150">*</span><span class="ident" id="8474151">newSessionTicketMsg</span><span class="op" id="8474170">)</span>&nbsp;<span class="ident" id="8474172">Generate</span><span class="op" id="8474180">(</span><span class="ident" id="8474181">rand</span>&nbsp;<span class="op" id="8474186">*</span><span class="ident" id="8474187">rand</span><span class="op" id="8474191">.</span><span class="ident" id="8474192">Rand</span><span class="op" id="8474196">,</span>&nbsp;<span class="ident" id="8474198">size</span>&nbsp;<span class="builtintype" id="8474203">int</span><span class="op" id="8474206">)</span>&nbsp;<span class="ident" id="8474208">reflect</span><span class="op" id="8474215">.</span><span class="ident" id="8474216">Value</span>&nbsp;<span class="op" id="8474222">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474225">m</span>&nbsp;<span class="op" id="8474227">:=</span>&nbsp;<span class="op" id="8474230">&amp;</span><span class="ident" id="8474231">newSessionTicketMsg</span><span class="op" id="8474250">{</span><span class="op" id="8474251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474254">m</span><span class="op" id="8474255">.</span><span class="ident" id="8474256">ticket</span>&nbsp;<span class="op" id="8474263">=</span>&nbsp;<span class="ident" id="8474265">randomBytes</span><span class="op" id="8474276">(</span><span class="ident" id="8474277">rand</span><span class="op" id="8474281">.</span><span class="ident" id="8474282">Intn</span><span class="op" id="8474286">(</span><span class="num" id="8474287">4</span><span class="op" id="8474288">)</span><span class="op" id="8474289">,</span>&nbsp;<span class="ident" id="8474291">rand</span><span class="op" id="8474295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8474298">return</span>&nbsp;<span class="ident" id="8474305">reflect</span><span class="op" id="8474312">.</span><span class="ident" id="8474313">ValueOf</span><span class="op" id="8474320">(</span><span class="ident" id="8474321">m</span><span class="op" id="8474322">)</span><br>
<span class="lineno"></span><span class="op" id="8474324">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="8474327">func</span>&nbsp;<span class="op" id="8474332">(</span><span class="op" id="8474333">*</span><span class="ident" id="8474334">sessionState</span><span class="op" id="8474346">)</span>&nbsp;<span class="ident" id="8474348">Generate</span><span class="op" id="8474356">(</span><span class="ident" id="8474357">rand</span>&nbsp;<span class="op" id="8474362">*</span><span class="ident" id="8474363">rand</span><span class="op" id="8474367">.</span><span class="ident" id="8474368">Rand</span><span class="op" id="8474372">,</span>&nbsp;<span class="ident" id="8474374">size</span>&nbsp;<span class="builtintype" id="8474379">int</span><span class="op" id="8474382">)</span>&nbsp;<span class="ident" id="8474384">reflect</span><span class="op" id="8474391">.</span><span class="ident" id="8474392">Value</span>&nbsp;<span class="op" id="8474398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474401">s</span>&nbsp;<span class="op" id="8474403">:=</span>&nbsp;<span class="op" id="8474406">&amp;</span><span class="ident" id="8474407">sessionState</span><span class="op" id="8474419">{</span><span class="op" id="8474420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474423">s</span><span class="op" id="8474424">.</span><span class="ident" id="8474425">vers</span>&nbsp;<span class="op" id="8474430">=</span>&nbsp;<span class="builtintype" id="8474432">uint16</span><span class="op" id="8474438">(</span><span class="ident" id="8474439">rand</span><span class="op" id="8474443">.</span><span class="ident" id="8474444">Intn</span><span class="op" id="8474448">(</span><span class="num" id="8474449">10000</span><span class="op" id="8474454">)</span><span class="op" id="8474455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474458">s</span><span class="op" id="8474459">.</span><span class="ident" id="8474460">cipherSuite</span>&nbsp;<span class="op" id="8474472">=</span>&nbsp;<span class="builtintype" id="8474474">uint16</span><span class="op" id="8474480">(</span><span class="ident" id="8474481">rand</span><span class="op" id="8474485">.</span><span class="ident" id="8474486">Intn</span><span class="op" id="8474490">(</span><span class="num" id="8474491">10000</span><span class="op" id="8474496">)</span><span class="op" id="8474497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474500">s</span><span class="op" id="8474501">.</span><span class="ident" id="8474502">masterSecret</span>&nbsp;<span class="op" id="8474515">=</span>&nbsp;<span class="ident" id="8474517">randomBytes</span><span class="op" id="8474528">(</span><span class="ident" id="8474529">rand</span><span class="op" id="8474533">.</span><span class="ident" id="8474534">Intn</span><span class="op" id="8474538">(</span><span class="num" id="8474539">100</span><span class="op" id="8474542">)</span><span class="op" id="8474543">,</span>&nbsp;<span class="ident" id="8474545">rand</span><span class="op" id="8474549">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474552">numCerts</span>&nbsp;<span class="op" id="8474561">:=</span>&nbsp;<span class="ident" id="8474564">rand</span><span class="op" id="8474568">.</span><span class="ident" id="8474569">Intn</span><span class="op" id="8474573">(</span><span class="num" id="8474574">20</span><span class="op" id="8474576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474579">s</span><span class="op" id="8474580">.</span><span class="ident" id="8474581">certificates</span>&nbsp;<span class="op" id="8474594">=</span>&nbsp;<span class="builtinfunc" id="8474596">make</span><span class="op" id="8474600">(</span><span class="op" id="8474601">[</span><span class="op" id="8474602">]</span><span class="op" id="8474603">[</span><span class="op" id="8474604">]</span><span class="builtintype" id="8474605">byte</span><span class="op" id="8474609">,</span>&nbsp;<span class="ident" id="8474611">numCerts</span><span class="op" id="8474619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8474622">for</span>&nbsp;<span class="ident" id="8474626">i</span>&nbsp;<span class="op" id="8474628">:=</span>&nbsp;<span class="num" id="8474631">0</span><span class="op" id="8474632">;</span>&nbsp;<span class="ident" id="8474634">i</span>&nbsp;<span class="op" id="8474636">&lt;</span>&nbsp;<span class="ident" id="8474638">numCerts</span><span class="op" id="8474646">;</span>&nbsp;<span class="ident" id="8474648">i</span><span class="op" id="8474649">++</span>&nbsp;<span class="op" id="8474652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474656">s</span><span class="op" id="8474657">.</span><span class="ident" id="8474658">certificates</span><span class="op" id="8474670">[</span><span class="ident" id="8474671">i</span><span class="op" id="8474672">]</span>&nbsp;<span class="op" id="8474674">=</span>&nbsp;<span class="ident" id="8474676">randomBytes</span><span class="op" id="8474687">(</span><span class="ident" id="8474688">rand</span><span class="op" id="8474692">.</span><span class="ident" id="8474693">Intn</span><span class="op" id="8474697">(</span><span class="num" id="8474698">10</span><span class="op" id="8474700">)</span><span class="op" id="8474701">+</span><span class="num" id="8474702">1</span><span class="op" id="8474703">,</span>&nbsp;<span class="ident" id="8474705">rand</span><span class="op" id="8474709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8474712">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8474715">return</span>&nbsp;<span class="ident" id="8474722">reflect</span><span class="op" id="8474729">.</span><span class="ident" id="8474730">ValueOf</span><span class="op" id="8474737">(</span><span class="ident" id="8474738">s</span><span class="op" id="8474739">)</span><br>
<span class="lineno"></span><span class="op" id="8474741">}</span>
</div>
</body>
</html>
