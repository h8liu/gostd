<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rsa</h2>
<ul>
<li><a href="/gostd/crypto/rsa/pkcs1v15.go.html">pkcs1v15.go</a></li>
<li><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html" class="current">pkcs1v15_test.go</a></li>
<li><a href="/gostd/crypto/rsa/pss.go.html">pss.go</a></li>
<li><a href="/gostd/crypto/rsa/pss_test.go.html">pss_test.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa.go.html">rsa.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa_test.go.html">rsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7263626">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7263681">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7263735">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7263786">package</span>&nbsp;<span class="ident" id="7263794">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7263799">import</span>&nbsp;<span class="op" id="7263806">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7263809">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7263818">&#34;crypto&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7263828">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7263843">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7263858">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7263877">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7263893">&#34;io&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7263899">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7263911">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7263922">&#34;testing/quick&#34;</span><br>
<span class="lineno"></span><span class="op" id="7263938">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="7263941">func</span>&nbsp;<span class="ident" id="7263946">decodeBase64</span><span class="op" id="7263958">(</span><span class="ident" id="7263959">in</span>&nbsp;<span class="builtintype" id="7263962">string</span><span class="op" id="7263968">)</span>&nbsp;<span class="op" id="7263970">[</span><span class="op" id="7263971">]</span><span class="builtintype" id="7263972">byte</span>&nbsp;<span class="op" id="7263977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7263980">out</span>&nbsp;<span class="op" id="7263984">:=</span>&nbsp;<span class="builtinfunc" id="7263987">make</span><span class="op" id="7263991">(</span><span class="op" id="7263992">[</span><span class="op" id="7263993">]</span><span class="builtintype" id="7263994">byte</span><span class="op" id="7263998">,</span>&nbsp;<span class="ident" id="7264000"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263858">base64</a></span><span class="op" id="7264006">.</span><span class="ident" id="7264007"><a href="/gostd/encoding/base64/base64.go.html#4053069">StdEncoding</a></span><span class="op" id="7264018">.</span><span class="ident" id="7264019"><a href="/gostd/encoding/base64/base64.go.html#4061047">DecodedLen</a></span><span class="op" id="7264029">(</span><span class="builtinfunc" id="7264030">len</span><span class="op" id="7264033">(</span><span class="ident" id="7264034"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263959">in</a></span><span class="op" id="7264036">)</span><span class="op" id="7264037">)</span><span class="op" id="7264038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264041">n</span><span class="op" id="7264042">,</span>&nbsp;<span class="ident" id="7264044">err</span>&nbsp;<span class="op" id="7264048">:=</span>&nbsp;<span class="ident" id="7264051"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263858">base64</a></span><span class="op" id="7264057">.</span><span class="ident" id="7264058"><a href="/gostd/encoding/base64/base64.go.html#4053069">StdEncoding</a></span><span class="op" id="7264069">.</span><span class="ident" id="7264070"><a href="/gostd/encoding/base64/base64.go.html#4058717">Decode</a></span><span class="op" id="7264076">(</span><span class="ident" id="7264077"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263980">out</a></span><span class="op" id="7264080">,</span>&nbsp;<span class="op" id="7264082">[</span><span class="op" id="7264083">]</span><span class="builtintype" id="7264084">byte</span><span class="op" id="7264088">(</span><span class="ident" id="7264089"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263959">in</a></span><span class="op" id="7264091">)</span><span class="op" id="7264092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7264095">if</span>&nbsp;<span class="ident" id="7264098"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7264044">err</a></span>&nbsp;<span class="op" id="7264102">!=</span>&nbsp;<span class="builtintype" id="7264105">nil</span>&nbsp;<span class="op" id="7264109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7264113">return</span>&nbsp;<span class="builtintype" id="7264120">nil</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7264125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7264128">return</span>&nbsp;<span class="ident" id="7264135"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263980">out</a></span><span class="op" id="7264138">[</span><span class="num" id="7264139">0</span><span class="op" id="7264140">:</span><span class="ident" id="7264141"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7264041">n</a></span><span class="op" id="7264142">]</span><br>
<span class="lineno"></span><span class="op" id="7264144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7264147">type</span>&nbsp;<span class="ident" id="7264152">DecryptPKCS1v15Test</span>&nbsp;<span class="keyword" id="7264172">struct</span>&nbsp;<span class="op" id="7264179">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264182">in</span><span class="op" id="7264184">,</span>&nbsp;<span class="ident" id="7264186">out</span>&nbsp;<span class="builtintype" id="7264190">string</span><br>
<span class="lineno"></span><span class="op" id="7264197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7264200">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;with&nbsp;`openssl&nbsp;rsautl&nbsp;-pkcs&nbsp;-encrypt`</span><br>
<span class="lineno"></span><span class="keyword" id="7264274">var</span>&nbsp;<span class="ident" id="7264278">decryptPKCS1v15Tests</span>&nbsp;<span class="op" id="7264299">=</span>&nbsp;<span class="op" id="7264301">[</span><span class="op" id="7264302">]</span><span class="ident" id="7264303"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7264152">DecryptPKCS1v15Test</a></span><span class="op" id="7264322">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7264325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7264329">&#34;gIcUIoVkD6ATMBk/u/nlCZCCWRKdkfjCgFdo35VpRXLduiKXhNz1XupLLzTXAybEq15juc+EgY5o0DHv/nt3yg==&#34;</span><span class="op" id="7264419">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7264423">&#34;x&#34;</span><span class="op" id="7264426">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7264429">}</span><span class="op" id="7264430">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7264433">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7264437">&#34;Y7TOCSqofGhkRb+jaVRLzK8xw2cSo1IVES19utzv6hwvx+M8kFsoWQm5DzBeJCZTCVDPkTpavUuEbgp8hnUGDw==&#34;</span><span class="op" id="7264527">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7264531">&#34;testing.&#34;</span><span class="op" id="7264541">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7264544">}</span><span class="op" id="7264545">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7264548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7264552">&#34;arReP9DJtEVyV2Dg3dDp4c/PSk1O6lxkoJ8HcFupoRorBZG+7+1fDAwT1olNddFnQMjmkb8vxwmNMoTAT/BFjQ==&#34;</span><span class="op" id="7264642">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7264646">&#34;testing.\n&#34;</span><span class="op" id="7264658">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7264661">}</span><span class="op" id="7264662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7264665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7264669">&#34;WtaBXIoGC54+vH0NH0CHHE+dRDOsMc/6BrfFu2lEqcKL9+uDuWaf+Xj9mrbQCjjZcpQuX733zyok/jsnqe/Ftw==&#34;</span><span class="op" id="7264759">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7264763">&#34;01234567890123456789012345678901234567890123456789012&#34;</span><span class="op" id="7264818">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7264821">}</span><span class="op" id="7264822">,</span><br>
<span class="lineno"></span><span class="op" id="7264824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7264827">func</span>&nbsp;<span class="ident" id="7264832">TestDecryptPKCS1v15</span><span class="op" id="7264851">(</span><span class="ident" id="7264852">t</span>&nbsp;<span class="op" id="7264854">*</span><span class="ident" id="7264855"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263911">testing</a></span><span class="op" id="7264862">.</span><span class="ident" id="7264863"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7264864">)</span>&nbsp;<span class="op" id="7264866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7264869">for</span>&nbsp;<span class="ident" id="7264873">i</span><span class="op" id="7264874">,</span>&nbsp;<span class="ident" id="7264876">test</span>&nbsp;<span class="op" id="7264881">:=</span>&nbsp;<span class="keyword" id="7264884">range</span>&nbsp;<span class="ident" id="7264890"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7264278">decryptPKCS1v15Tests</a></span>&nbsp;<span class="op" id="7264911">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7264915">out</span><span class="op" id="7264918">,</span>&nbsp;<span class="ident" id="7264920">err</span>&nbsp;<span class="op" id="7264924">:=</span>&nbsp;<span class="ident" id="7264927"><a href="/gostd/crypto/rsa/pkcs1v15.go.html#4725738">DecryptPKCS1v15</a></span><span class="op" id="7264942">(</span><span class="builtintype" id="7264943">nil</span><span class="op" id="7264946">,</span>&nbsp;<span class="ident" id="7264948"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7270722">rsaPrivateKey</a></span><span class="op" id="7264961">,</span>&nbsp;<span class="ident" id="7264963"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263946">decodeBase64</a></span><span class="op" id="7264975">(</span><span class="ident" id="7264976"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7264876">test</a></span><span class="op" id="7264980">.</span><span class="ident" id="7264981"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7264182">in</a></span><span class="op" id="7264983">)</span><span class="op" id="7264984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7264988">if</span>&nbsp;<span class="ident" id="7264991"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7264920">err</a></span>&nbsp;<span class="op" id="7264995">!=</span>&nbsp;<span class="builtintype" id="7264998">nil</span>&nbsp;<span class="op" id="7265002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265007"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7264852">t</a></span><span class="op" id="7265008">.</span><span class="ident" id="7265009"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7265015">(</span><span class="string" id="7265016">&#34;#%d&nbsp;error&nbsp;decrypting&#34;</span><span class="op" id="7265038">,</span>&nbsp;<span class="ident" id="7265040"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7264873">i</a></span><span class="op" id="7265041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7265045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265049">want</span>&nbsp;<span class="op" id="7265054">:=</span>&nbsp;<span class="op" id="7265057">[</span><span class="op" id="7265058">]</span><span class="builtintype" id="7265059">byte</span><span class="op" id="7265063">(</span><span class="ident" id="7265064"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7264876">test</a></span><span class="op" id="7265068">.</span><span class="ident" id="7265069"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7264186">out</a></span><span class="op" id="7265072">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7265076">if</span>&nbsp;<span class="op" id="7265079">!</span><span class="ident" id="7265080"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263809">bytes</a></span><span class="op" id="7265085">.</span><span class="ident" id="7265086"><a href="/gostd/bytes/bytes_decl.go.html#1414806">Equal</a></span><span class="op" id="7265091">(</span><span class="ident" id="7265092"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7264915">out</a></span><span class="op" id="7265095">,</span>&nbsp;<span class="ident" id="7265097"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7265049">want</a></span><span class="op" id="7265101">)</span>&nbsp;<span class="op" id="7265103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265108"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7264852">t</a></span><span class="op" id="7265109">.</span><span class="ident" id="7265110"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7265116">(</span><span class="string" id="7265117">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="7265139">,</span>&nbsp;<span class="ident" id="7265141"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7264873">i</a></span><span class="op" id="7265142">,</span>&nbsp;<span class="ident" id="7265144"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7264915">out</a></span><span class="op" id="7265147">,</span>&nbsp;<span class="ident" id="7265149"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7265049">want</a></span><span class="op" id="7265153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7265157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7265160">}</span><br>
<span class="lineno"></span><span class="op" id="7265162">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="7265165">func</span>&nbsp;<span class="ident" id="7265170">TestEncryptPKCS1v15</span><span class="op" id="7265189">(</span><span class="ident" id="7265190">t</span>&nbsp;<span class="op" id="7265192">*</span><span class="ident" id="7265193"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263911">testing</a></span><span class="op" id="7265200">.</span><span class="ident" id="7265201"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7265202">)</span>&nbsp;<span class="op" id="7265204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265207">random</span>&nbsp;<span class="op" id="7265214">:=</span>&nbsp;<span class="ident" id="7265217"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263828">rand</a></span><span class="op" id="7265221">.</span><span class="ident" id="7265222"><a href="/gostd/crypto/rand/rand.go.html#4355686">Reader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265230">k</span>&nbsp;<span class="op" id="7265232">:=</span>&nbsp;<span class="op" id="7265235">(</span><span class="ident" id="7265236"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7270722">rsaPrivateKey</a></span><span class="op" id="7265249">.</span><span class="ident" id="7265250"><a href="/gostd/crypto/rsa/rsa.go.html#4742963">N</a></span><span class="op" id="7265251">.</span><span class="ident" id="7265252"><a href="/gostd/math/big/int.go.html#2050389">BitLen</a></span><span class="op" id="7265258">(</span><span class="op" id="7265259">)</span>&nbsp;<span class="op" id="7265261">+</span>&nbsp;<span class="num" id="7265263">7</span><span class="op" id="7265264">)</span>&nbsp;<span class="op" id="7265266">/</span>&nbsp;<span class="num" id="7265268">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265272">tryEncryptDecrypt</span>&nbsp;<span class="op" id="7265290">:=</span>&nbsp;<span class="keyword" id="7265293">func</span><span class="op" id="7265297">(</span><span class="ident" id="7265298">in</span>&nbsp;<span class="op" id="7265301">[</span><span class="op" id="7265302">]</span><span class="builtintype" id="7265303">byte</span><span class="op" id="7265307">,</span>&nbsp;<span class="ident" id="7265309">blind</span>&nbsp;<span class="builtintype" id="7265315">bool</span><span class="op" id="7265319">)</span>&nbsp;<span class="builtintype" id="7265321">bool</span>&nbsp;<span class="op" id="7265326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7265330">if</span>&nbsp;<span class="builtinfunc" id="7265333">len</span><span class="op" id="7265336">(</span><span class="ident" id="7265337"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7265298">in</a></span><span class="op" id="7265339">)</span>&nbsp;<span class="op" id="7265341">&gt;</span>&nbsp;<span class="ident" id="7265343"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7265230">k</a></span><span class="op" id="7265344">-</span><span class="num" id="7265345">11</span>&nbsp;<span class="op" id="7265348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265353"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7265298">in</a></span>&nbsp;<span class="op" id="7265356">=</span>&nbsp;<span class="ident" id="7265358"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7265298">in</a></span><span class="op" id="7265360">[</span><span class="num" id="7265361">0</span>&nbsp;<span class="op" id="7265363">:</span>&nbsp;<span class="ident" id="7265365"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7265230">k</a></span><span class="op" id="7265366">-</span><span class="num" id="7265367">11</span><span class="op" id="7265369">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7265373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265378">ciphertext</span><span class="op" id="7265388">,</span>&nbsp;<span class="ident" id="7265390">err</span>&nbsp;<span class="op" id="7265394">:=</span>&nbsp;<span class="ident" id="7265397"><a href="/gostd/crypto/rsa/pkcs1v15.go.html#4724961">EncryptPKCS1v15</a></span><span class="op" id="7265412">(</span><span class="ident" id="7265413"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7265207">random</a></span><span class="op" id="7265419">,</span>&nbsp;<span class="op" id="7265421">&amp;</span><span class="ident" id="7265422"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7270722">rsaPrivateKey</a></span><span class="op" id="7265435">.</span><span class="ident" id="7265436"><a href="/gostd/crypto/rsa/rsa.go.html#4743795">PublicKey</a></span><span class="op" id="7265445">,</span>&nbsp;<span class="ident" id="7265447"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7265298">in</a></span><span class="op" id="7265449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7265453">if</span>&nbsp;<span class="ident" id="7265456"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7265390">err</a></span>&nbsp;<span class="op" id="7265460">!=</span>&nbsp;<span class="builtintype" id="7265463">nil</span>&nbsp;<span class="op" id="7265467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265472"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7265190">t</a></span><span class="op" id="7265473">.</span><span class="ident" id="7265474"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7265480">(</span><span class="string" id="7265481">&#34;error&nbsp;encrypting:&nbsp;%s&#34;</span><span class="op" id="7265503">,</span>&nbsp;<span class="ident" id="7265505"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7265390">err</a></span><span class="op" id="7265508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7265513">return</span>&nbsp;<span class="builtintype" id="7265520">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7265528">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7265533">var</span>&nbsp;<span class="ident" id="7265537">rand</span>&nbsp;<span class="ident" id="7265542"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263893">io</a></span><span class="op" id="7265544">.</span><span class="ident" id="7265545"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7265554">if</span>&nbsp;<span class="op" id="7265557">!</span><span class="ident" id="7265558"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7265309">blind</a></span>&nbsp;<span class="op" id="7265564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265569"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7265537">rand</a></span>&nbsp;<span class="op" id="7265574">=</span>&nbsp;<span class="builtintype" id="7265576">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7265582">}</span>&nbsp;<span class="keyword" id="7265584">else</span>&nbsp;<span class="op" id="7265589">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265594"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7265537">rand</a></span>&nbsp;<span class="op" id="7265599">=</span>&nbsp;<span class="ident" id="7265601"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7265207">random</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7265610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265614">plaintext</span><span class="op" id="7265623">,</span>&nbsp;<span class="ident" id="7265625"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7265390">err</a></span>&nbsp;<span class="op" id="7265629">:=</span>&nbsp;<span class="ident" id="7265632"><a href="/gostd/crypto/rsa/pkcs1v15.go.html#4725738">DecryptPKCS1v15</a></span><span class="op" id="7265647">(</span><span class="ident" id="7265648"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7265537">rand</a></span><span class="op" id="7265652">,</span>&nbsp;<span class="ident" id="7265654"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7270722">rsaPrivateKey</a></span><span class="op" id="7265667">,</span>&nbsp;<span class="ident" id="7265669"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7265378">ciphertext</a></span><span class="op" id="7265679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7265683">if</span>&nbsp;<span class="ident" id="7265686"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7265390">err</a></span>&nbsp;<span class="op" id="7265690">!=</span>&nbsp;<span class="builtintype" id="7265693">nil</span>&nbsp;<span class="op" id="7265697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265702"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7265190">t</a></span><span class="op" id="7265703">.</span><span class="ident" id="7265704"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7265710">(</span><span class="string" id="7265711">&#34;error&nbsp;decrypting:&nbsp;%s&#34;</span><span class="op" id="7265733">,</span>&nbsp;<span class="ident" id="7265735"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7265390">err</a></span><span class="op" id="7265738">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7265743">return</span>&nbsp;<span class="builtintype" id="7265750">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7265758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7265763">if</span>&nbsp;<span class="op" id="7265766">!</span><span class="ident" id="7265767"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263809">bytes</a></span><span class="op" id="7265772">.</span><span class="ident" id="7265773"><a href="/gostd/bytes/bytes_decl.go.html#1414806">Equal</a></span><span class="op" id="7265778">(</span><span class="ident" id="7265779"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7265614">plaintext</a></span><span class="op" id="7265788">,</span>&nbsp;<span class="ident" id="7265790"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7265298">in</a></span><span class="op" id="7265792">)</span>&nbsp;<span class="op" id="7265794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265799"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7265190">t</a></span><span class="op" id="7265800">.</span><span class="ident" id="7265801"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7265807">(</span><span class="string" id="7265808">&#34;output&nbsp;mismatch:&nbsp;%#v&nbsp;%#v&#34;</span><span class="op" id="7265834">,</span>&nbsp;<span class="ident" id="7265836"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7265614">plaintext</a></span><span class="op" id="7265845">,</span>&nbsp;<span class="ident" id="7265847"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7265298">in</a></span><span class="op" id="7265849">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7265854">return</span>&nbsp;<span class="builtintype" id="7265861">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7265869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7265873">return</span>&nbsp;<span class="builtintype" id="7265880">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7265886">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265890">config</span>&nbsp;<span class="op" id="7265897">:=</span>&nbsp;<span class="builtinfunc" id="7265900">new</span><span class="op" id="7265903">(</span><span class="ident" id="7265904"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263922">quick</a></span><span class="op" id="7265909">.</span><span class="ident" id="7265910"><a href="/gostd/testing/quick/quick.go.html#3929672">Config</a></span><span class="op" id="7265916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7265919">if</span>&nbsp;<span class="ident" id="7265922"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263911">testing</a></span><span class="op" id="7265929">.</span><span class="ident" id="7265930"><a href="/gostd/testing/testing.go.html#5475359">Short</a></span><span class="op" id="7265935">(</span><span class="op" id="7265936">)</span>&nbsp;<span class="op" id="7265938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265942"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7265890">config</a></span><span class="op" id="7265948">.</span><span class="ident" id="7265949"><a href="/gostd/testing/quick/quick.go.html#3929777">MaxCount</a></span>&nbsp;<span class="op" id="7265958">=</span>&nbsp;<span class="num" id="7265960">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7265964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7265967"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263922">quick</a></span><span class="op" id="7265972">.</span><span class="ident" id="7265973"><a href="/gostd/testing/quick/quick.go.html#3932140">Check</a></span><span class="op" id="7265978">(</span><span class="ident" id="7265979"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7265272">tryEncryptDecrypt</a></span><span class="op" id="7265996">,</span>&nbsp;<span class="ident" id="7265998"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7265890">config</a></span><span class="op" id="7266004">)</span><br>
<span class="lineno">105</span><span class="op" id="7266006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7266009">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;with&nbsp;`openssl&nbsp;rsautl&nbsp;-pkcs&nbsp;-encrypt`</span><br>
<span class="lineno"></span><span class="keyword" id="7266083">var</span>&nbsp;<span class="ident" id="7266087">decryptPKCS1v15SessionKeyTests</span>&nbsp;<span class="op" id="7266118">=</span>&nbsp;<span class="op" id="7266120">[</span><span class="op" id="7266121">]</span><span class="ident" id="7266122"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7264152">DecryptPKCS1v15Test</a></span><span class="op" id="7266141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7266144">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7266148">&#34;e6ukkae6Gykq0fKzYwULpZehX+UPXYzMoB5mHQUDEiclRbOTqas4Y0E6nwns1BBpdvEJcilhl5zsox/6DtGsYg==&#34;</span><span class="op" id="7266238">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7266242">&#34;1234&#34;</span><span class="op" id="7266248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7266251">}</span><span class="op" id="7266252">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7266255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7266259">&#34;Dtis4uk/q/LQGGqGk97P59K03hkCIVFMEFZRgVWOAAhxgYpCRG0MX2adptt92l67IqMki6iVQyyt0TtX3IdtEw==&#34;</span><span class="op" id="7266349">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7266353">&#34;FAIL&#34;</span><span class="op" id="7266359">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7266362">}</span><span class="op" id="7266363">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7266366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7266370">&#34;LIyFyCYCptPxrvTxpol8F3M7ZivlMsf53zs0vHRAv+rDIh2YsHS69ePMoPMe3TkOMZ3NupiL3takPxIs1sK+dw==&#34;</span><span class="op" id="7266460">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7266464">&#34;abcd&#34;</span><span class="op" id="7266470">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7266473">}</span><span class="op" id="7266474">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7266477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7266481">&#34;bafnobel46bKy76JzqU/RIVOH0uAYvzUtauKmIidKgM0sMlvobYVAVQPeUQ/oTGjbIZ1v/6Gyi5AO4DtHruGdw==&#34;</span><span class="op" id="7266571">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7266575">&#34;FAIL&#34;</span><span class="op" id="7266581">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7266584">}</span><span class="op" id="7266585">,</span><br>
<span class="lineno">125</span><span class="op" id="7266587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7266590">func</span>&nbsp;<span class="ident" id="7266595">TestEncryptPKCS1v15SessionKey</span><span class="op" id="7266624">(</span><span class="ident" id="7266625">t</span>&nbsp;<span class="op" id="7266627">*</span><span class="ident" id="7266628"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263911">testing</a></span><span class="op" id="7266635">.</span><span class="ident" id="7266636"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7266637">)</span>&nbsp;<span class="op" id="7266639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7266642">for</span>&nbsp;<span class="ident" id="7266646">i</span><span class="op" id="7266647">,</span>&nbsp;<span class="ident" id="7266649">test</span>&nbsp;<span class="op" id="7266654">:=</span>&nbsp;<span class="keyword" id="7266657">range</span>&nbsp;<span class="ident" id="7266663"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7266087">decryptPKCS1v15SessionKeyTests</a></span>&nbsp;<span class="op" id="7266694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266698">key</span>&nbsp;<span class="op" id="7266702">:=</span>&nbsp;<span class="op" id="7266705">[</span><span class="op" id="7266706">]</span><span class="builtintype" id="7266707">byte</span><span class="op" id="7266711">(</span><span class="string" id="7266712">&#34;FAIL&#34;</span><span class="op" id="7266718">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266722">err</span>&nbsp;<span class="op" id="7266726">:=</span>&nbsp;<span class="ident" id="7266729"><a href="/gostd/crypto/rsa/pkcs1v15.go.html#4726989">DecryptPKCS1v15SessionKey</a></span><span class="op" id="7266754">(</span><span class="builtintype" id="7266755">nil</span><span class="op" id="7266758">,</span>&nbsp;<span class="ident" id="7266760"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7270722">rsaPrivateKey</a></span><span class="op" id="7266773">,</span>&nbsp;<span class="ident" id="7266775"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263946">decodeBase64</a></span><span class="op" id="7266787">(</span><span class="ident" id="7266788"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7266649">test</a></span><span class="op" id="7266792">.</span><span class="ident" id="7266793"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7264182">in</a></span><span class="op" id="7266795">)</span><span class="op" id="7266796">,</span>&nbsp;<span class="ident" id="7266798"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7266698">key</a></span><span class="op" id="7266801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7266805">if</span>&nbsp;<span class="ident" id="7266808"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7266722">err</a></span>&nbsp;<span class="op" id="7266812">!=</span>&nbsp;<span class="builtintype" id="7266815">nil</span>&nbsp;<span class="op" id="7266819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266824"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7266625">t</a></span><span class="op" id="7266825">.</span><span class="ident" id="7266826"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7266832">(</span><span class="string" id="7266833">&#34;#%d&nbsp;error&nbsp;decrypting&#34;</span><span class="op" id="7266855">,</span>&nbsp;<span class="ident" id="7266857"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7266646">i</a></span><span class="op" id="7266858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7266862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266866">want</span>&nbsp;<span class="op" id="7266871">:=</span>&nbsp;<span class="op" id="7266874">[</span><span class="op" id="7266875">]</span><span class="builtintype" id="7266876">byte</span><span class="op" id="7266880">(</span><span class="ident" id="7266881"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7266649">test</a></span><span class="op" id="7266885">.</span><span class="ident" id="7266886"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7264186">out</a></span><span class="op" id="7266889">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7266893">if</span>&nbsp;<span class="op" id="7266896">!</span><span class="ident" id="7266897"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263809">bytes</a></span><span class="op" id="7266902">.</span><span class="ident" id="7266903"><a href="/gostd/bytes/bytes_decl.go.html#1414806">Equal</a></span><span class="op" id="7266908">(</span><span class="ident" id="7266909"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7266698">key</a></span><span class="op" id="7266912">,</span>&nbsp;<span class="ident" id="7266914"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7266866">want</a></span><span class="op" id="7266918">)</span>&nbsp;<span class="op" id="7266920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7266925"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7266625">t</a></span><span class="op" id="7266926">.</span><span class="ident" id="7266927"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7266933">(</span><span class="string" id="7266934">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="7266956">,</span>&nbsp;<span class="ident" id="7266958"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7266646">i</a></span><span class="op" id="7266959">,</span>&nbsp;<span class="ident" id="7266961"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7266698">key</a></span><span class="op" id="7266964">,</span>&nbsp;<span class="ident" id="7266966"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7266866">want</a></span><span class="op" id="7266970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7266974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7266977">}</span><br>
<span class="lineno"></span><span class="op" id="7266979">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="7266982">func</span>&nbsp;<span class="ident" id="7266987">TestNonZeroRandomBytes</span><span class="op" id="7267009">(</span><span class="ident" id="7267010">t</span>&nbsp;<span class="op" id="7267012">*</span><span class="ident" id="7267013"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263911">testing</a></span><span class="op" id="7267020">.</span><span class="ident" id="7267021"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7267022">)</span>&nbsp;<span class="op" id="7267024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267027">random</span>&nbsp;<span class="op" id="7267034">:=</span>&nbsp;<span class="ident" id="7267037"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263828">rand</a></span><span class="op" id="7267041">.</span><span class="ident" id="7267042"><a href="/gostd/crypto/rand/rand.go.html#4355686">Reader</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267051">b</span>&nbsp;<span class="op" id="7267053">:=</span>&nbsp;<span class="builtinfunc" id="7267056">make</span><span class="op" id="7267060">(</span><span class="op" id="7267061">[</span><span class="op" id="7267062">]</span><span class="builtintype" id="7267063">byte</span><span class="op" id="7267067">,</span>&nbsp;<span class="num" id="7267069">512</span><span class="op" id="7267072">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267075">err</span>&nbsp;<span class="op" id="7267079">:=</span>&nbsp;<span class="ident" id="7267082"><a href="/gostd/crypto/rsa/pkcs1v15.go.html#4729398">nonZeroRandomBytes</a></span><span class="op" id="7267100">(</span><span class="ident" id="7267101"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7267051">b</a></span><span class="op" id="7267102">,</span>&nbsp;<span class="ident" id="7267104"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7267027">random</a></span><span class="op" id="7267110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7267113">if</span>&nbsp;<span class="ident" id="7267116"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7267075">err</a></span>&nbsp;<span class="op" id="7267120">!=</span>&nbsp;<span class="builtintype" id="7267123">nil</span>&nbsp;<span class="op" id="7267127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267131"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7267010">t</a></span><span class="op" id="7267132">.</span><span class="ident" id="7267133"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7267139">(</span><span class="string" id="7267140">&#34;returned&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7267160">,</span>&nbsp;<span class="ident" id="7267162"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7267075">err</a></span><span class="op" id="7267165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7267168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7267171">for</span>&nbsp;<span class="ident" id="7267175">_</span><span class="op" id="7267176">,</span>&nbsp;<span class="ident" id="7267178">b</span>&nbsp;<span class="op" id="7267180">:=</span>&nbsp;<span class="keyword" id="7267183">range</span>&nbsp;<span class="ident" id="7267189"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7267051">b</a></span>&nbsp;<span class="op" id="7267191">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7267195">if</span>&nbsp;<span class="ident" id="7267198"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7267178">b</a></span>&nbsp;<span class="op" id="7267200">==</span>&nbsp;<span class="num" id="7267203">0</span>&nbsp;<span class="op" id="7267205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267210"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7267010">t</a></span><span class="op" id="7267211">.</span><span class="ident" id="7267212"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7267218">(</span><span class="string" id="7267219">&#34;Zero&nbsp;octet&nbsp;found&#34;</span><span class="op" id="7267237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7267242">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7267251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7267254">}</span><br>
<span class="lineno">155</span><span class="op" id="7267256">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7267259">type</span>&nbsp;<span class="ident" id="7267264">signPKCS1v15Test</span>&nbsp;<span class="keyword" id="7267281">struct</span>&nbsp;<span class="op" id="7267288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267291">in</span><span class="op" id="7267293">,</span>&nbsp;<span class="ident" id="7267295">out</span>&nbsp;<span class="builtintype" id="7267299">string</span><br>
<span class="lineno"></span><span class="op" id="7267306">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="comment" id="7267309">//&nbsp;These&nbsp;vectors&nbsp;have&nbsp;been&nbsp;tested&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="7267348">//&nbsp;&nbsp;&nbsp;`openssl&nbsp;rsautl&nbsp;-verify&nbsp;-inkey&nbsp;pk&nbsp;-in&nbsp;signature&nbsp;|&nbsp;hexdump&nbsp;-C`</span><br>
<span class="lineno"></span><span class="keyword" id="7267415">var</span>&nbsp;<span class="ident" id="7267419">signPKCS1v15Tests</span>&nbsp;<span class="op" id="7267437">=</span>&nbsp;<span class="op" id="7267439">[</span><span class="op" id="7267440">]</span><span class="ident" id="7267441"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7267264">signPKCS1v15Test</a></span><span class="op" id="7267457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7267460">{</span><span class="string" id="7267461">&#34;Test.\n&#34;</span><span class="op" id="7267470">,</span>&nbsp;<span class="string" id="7267472">&#34;a4f3fa6ea93bcdd0c57be020c1193ecbfd6f200a3d95c409769b029578fa0e336ad9a347600e40d3ae823b8c7e6bad88cc07c1d54c3a1523cbbb6d58efc362ae&#34;</span><span class="op" id="7267602">}</span><span class="op" id="7267603">,</span><br>
<span class="lineno">165</span><span class="op" id="7267605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7267608">func</span>&nbsp;<span class="ident" id="7267613">TestSignPKCS1v15</span><span class="op" id="7267629">(</span><span class="ident" id="7267630">t</span>&nbsp;<span class="op" id="7267632">*</span><span class="ident" id="7267633"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263911">testing</a></span><span class="op" id="7267640">.</span><span class="ident" id="7267641"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7267642">)</span>&nbsp;<span class="op" id="7267644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7267647">for</span>&nbsp;<span class="ident" id="7267651">i</span><span class="op" id="7267652">,</span>&nbsp;<span class="ident" id="7267654">test</span>&nbsp;<span class="op" id="7267659">:=</span>&nbsp;<span class="keyword" id="7267662">range</span>&nbsp;<span class="ident" id="7267668"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7267419">signPKCS1v15Tests</a></span>&nbsp;<span class="op" id="7267686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267690">h</span>&nbsp;<span class="op" id="7267692">:=</span>&nbsp;<span class="ident" id="7267695"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263843">sha1</a></span><span class="op" id="7267699">.</span><span class="ident" id="7267700"><a href="/gostd/crypto/sha1/sha1.go.html#4609140">New</a></span><span class="op" id="7267703">(</span><span class="op" id="7267704">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267708"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7267690">h</a></span><span class="op" id="7267709">.</span><span class="ident" id="7267710"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="7267715">(</span><span class="op" id="7267716">[</span><span class="op" id="7267717">]</span><span class="builtintype" id="7267718">byte</span><span class="op" id="7267722">(</span><span class="ident" id="7267723"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7267654">test</a></span><span class="op" id="7267727">.</span><span class="ident" id="7267728"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7267291">in</a></span><span class="op" id="7267730">)</span><span class="op" id="7267731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267735">digest</span>&nbsp;<span class="op" id="7267742">:=</span>&nbsp;<span class="ident" id="7267745"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7267690">h</a></span><span class="op" id="7267746">.</span><span class="ident" id="7267747"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="7267750">(</span><span class="builtintype" id="7267751">nil</span><span class="op" id="7267754">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267759">s</span><span class="op" id="7267760">,</span>&nbsp;<span class="ident" id="7267762">err</span>&nbsp;<span class="op" id="7267766">:=</span>&nbsp;<span class="ident" id="7267769"><a href="/gostd/crypto/rsa/pkcs1v15.go.html#4731399">SignPKCS1v15</a></span><span class="op" id="7267781">(</span><span class="builtintype" id="7267782">nil</span><span class="op" id="7267785">,</span>&nbsp;<span class="ident" id="7267787"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7270722">rsaPrivateKey</a></span><span class="op" id="7267800">,</span>&nbsp;<span class="ident" id="7267802"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263818">crypto</a></span><span class="op" id="7267808">.</span><span class="ident" id="7267809"><a href="/gostd/crypto/crypto.go.html#3010309">SHA1</a></span><span class="op" id="7267813">,</span>&nbsp;<span class="ident" id="7267815"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7267735">digest</a></span><span class="op" id="7267821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7267825">if</span>&nbsp;<span class="ident" id="7267828"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7267762">err</a></span>&nbsp;<span class="op" id="7267832">!=</span>&nbsp;<span class="builtintype" id="7267835">nil</span>&nbsp;<span class="op" id="7267839">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267844"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7267630">t</a></span><span class="op" id="7267845">.</span><span class="ident" id="7267846"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7267852">(</span><span class="string" id="7267853">&#34;#%d&nbsp;%s&#34;</span><span class="op" id="7267861">,</span>&nbsp;<span class="ident" id="7267863"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7267651">i</a></span><span class="op" id="7267864">,</span>&nbsp;<span class="ident" id="7267866"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7267762">err</a></span><span class="op" id="7267869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7267873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267878">expected</span><span class="op" id="7267886">,</span>&nbsp;<span class="ident" id="7267888">_</span>&nbsp;<span class="op" id="7267890">:=</span>&nbsp;<span class="ident" id="7267893"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263877">hex</a></span><span class="op" id="7267896">.</span><span class="ident" id="7267897"><a href="/gostd/encoding/hex/hex.go.html#4721563">DecodeString</a></span><span class="op" id="7267909">(</span><span class="ident" id="7267910"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7267654">test</a></span><span class="op" id="7267914">.</span><span class="ident" id="7267915"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7267295">out</a></span><span class="op" id="7267918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7267922">if</span>&nbsp;<span class="op" id="7267925">!</span><span class="ident" id="7267926"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263809">bytes</a></span><span class="op" id="7267931">.</span><span class="ident" id="7267932"><a href="/gostd/bytes/bytes_decl.go.html#1414806">Equal</a></span><span class="op" id="7267937">(</span><span class="ident" id="7267938"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7267759">s</a></span><span class="op" id="7267939">,</span>&nbsp;<span class="ident" id="7267941"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7267878">expected</a></span><span class="op" id="7267949">)</span>&nbsp;<span class="op" id="7267951">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7267956"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7267630">t</a></span><span class="op" id="7267957">.</span><span class="ident" id="7267958"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7267964">(</span><span class="string" id="7267965">&#34;#%d&nbsp;got:&nbsp;%x&nbsp;want:&nbsp;%x&#34;</span><span class="op" id="7267987">,</span>&nbsp;<span class="ident" id="7267989"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7267651">i</a></span><span class="op" id="7267990">,</span>&nbsp;<span class="ident" id="7267992"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7267759">s</a></span><span class="op" id="7267993">,</span>&nbsp;<span class="ident" id="7267995"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7267878">expected</a></span><span class="op" id="7268003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7268007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7268010">}</span><br>
<span class="lineno"></span><span class="op" id="7268012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="7268015">func</span>&nbsp;<span class="ident" id="7268020">TestVerifyPKCS1v15</span><span class="op" id="7268038">(</span><span class="ident" id="7268039">t</span>&nbsp;<span class="op" id="7268041">*</span><span class="ident" id="7268042"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263911">testing</a></span><span class="op" id="7268049">.</span><span class="ident" id="7268050"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7268051">)</span>&nbsp;<span class="op" id="7268053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7268056">for</span>&nbsp;<span class="ident" id="7268060">i</span><span class="op" id="7268061">,</span>&nbsp;<span class="ident" id="7268063">test</span>&nbsp;<span class="op" id="7268068">:=</span>&nbsp;<span class="keyword" id="7268071">range</span>&nbsp;<span class="ident" id="7268077"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7267419">signPKCS1v15Tests</a></span>&nbsp;<span class="op" id="7268095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268099">h</span>&nbsp;<span class="op" id="7268101">:=</span>&nbsp;<span class="ident" id="7268104"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263843">sha1</a></span><span class="op" id="7268108">.</span><span class="ident" id="7268109"><a href="/gostd/crypto/sha1/sha1.go.html#4609140">New</a></span><span class="op" id="7268112">(</span><span class="op" id="7268113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268117"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7268099">h</a></span><span class="op" id="7268118">.</span><span class="ident" id="7268119"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="7268124">(</span><span class="op" id="7268125">[</span><span class="op" id="7268126">]</span><span class="builtintype" id="7268127">byte</span><span class="op" id="7268131">(</span><span class="ident" id="7268132"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7268063">test</a></span><span class="op" id="7268136">.</span><span class="ident" id="7268137"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7267291">in</a></span><span class="op" id="7268139">)</span><span class="op" id="7268140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268144">digest</span>&nbsp;<span class="op" id="7268151">:=</span>&nbsp;<span class="ident" id="7268154"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7268099">h</a></span><span class="op" id="7268155">.</span><span class="ident" id="7268156"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="7268159">(</span><span class="builtintype" id="7268160">nil</span><span class="op" id="7268163">)</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268168">sig</span><span class="op" id="7268171">,</span>&nbsp;<span class="ident" id="7268173">_</span>&nbsp;<span class="op" id="7268175">:=</span>&nbsp;<span class="ident" id="7268178"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263877">hex</a></span><span class="op" id="7268181">.</span><span class="ident" id="7268182"><a href="/gostd/encoding/hex/hex.go.html#4721563">DecodeString</a></span><span class="op" id="7268194">(</span><span class="ident" id="7268195"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7268063">test</a></span><span class="op" id="7268199">.</span><span class="ident" id="7268200"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7267295">out</a></span><span class="op" id="7268203">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268208">err</span>&nbsp;<span class="op" id="7268212">:=</span>&nbsp;<span class="ident" id="7268215"><a href="/gostd/crypto/rsa/pkcs1v15.go.html#4732385">VerifyPKCS1v15</a></span><span class="op" id="7268229">(</span><span class="op" id="7268230">&amp;</span><span class="ident" id="7268231"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7270722">rsaPrivateKey</a></span><span class="op" id="7268244">.</span><span class="ident" id="7268245"><a href="/gostd/crypto/rsa/rsa.go.html#4743795">PublicKey</a></span><span class="op" id="7268254">,</span>&nbsp;<span class="ident" id="7268256"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263818">crypto</a></span><span class="op" id="7268262">.</span><span class="ident" id="7268263"><a href="/gostd/crypto/crypto.go.html#3010309">SHA1</a></span><span class="op" id="7268267">,</span>&nbsp;<span class="ident" id="7268269"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7268144">digest</a></span><span class="op" id="7268275">,</span>&nbsp;<span class="ident" id="7268277"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7268168">sig</a></span><span class="op" id="7268280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7268284">if</span>&nbsp;<span class="ident" id="7268287"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7268208">err</a></span>&nbsp;<span class="op" id="7268291">!=</span>&nbsp;<span class="builtintype" id="7268294">nil</span>&nbsp;<span class="op" id="7268298">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268303"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7268039">t</a></span><span class="op" id="7268304">.</span><span class="ident" id="7268305"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7268311">(</span><span class="string" id="7268312">&#34;#%d&nbsp;%s&#34;</span><span class="op" id="7268320">,</span>&nbsp;<span class="ident" id="7268322"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7268060">i</a></span><span class="op" id="7268323">,</span>&nbsp;<span class="ident" id="7268325"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7268208">err</a></span><span class="op" id="7268328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7268332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7268335">}</span><br>
<span class="lineno"></span><span class="op" id="7268337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="7268340">func</span>&nbsp;<span class="ident" id="7268345">TestOverlongMessagePKCS1v15</span><span class="op" id="7268372">(</span><span class="ident" id="7268373">t</span>&nbsp;<span class="op" id="7268375">*</span><span class="ident" id="7268376"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263911">testing</a></span><span class="op" id="7268383">.</span><span class="ident" id="7268384"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7268385">)</span>&nbsp;<span class="op" id="7268387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268390">ciphertext</span>&nbsp;<span class="op" id="7268401">:=</span>&nbsp;<span class="ident" id="7268404"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263946">decodeBase64</a></span><span class="op" id="7268416">(</span><span class="string" id="7268417">&#34;fjOVdirUzFoLlukv80dBllMLjXythIf22feqPrNo0YoIjzyzyoMFiLjAc/Y4krkeZ11XFThIrEvw\nkRiZcCq5ng==&#34;</span><span class="op" id="7268509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268512">_</span><span class="op" id="7268513">,</span>&nbsp;<span class="ident" id="7268515">err</span>&nbsp;<span class="op" id="7268519">:=</span>&nbsp;<span class="ident" id="7268522"><a href="/gostd/crypto/rsa/pkcs1v15.go.html#4725738">DecryptPKCS1v15</a></span><span class="op" id="7268537">(</span><span class="builtintype" id="7268538">nil</span><span class="op" id="7268541">,</span>&nbsp;<span class="ident" id="7268543"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7270722">rsaPrivateKey</a></span><span class="op" id="7268556">,</span>&nbsp;<span class="ident" id="7268558"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7268390">ciphertext</a></span><span class="op" id="7268568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7268571">if</span>&nbsp;<span class="ident" id="7268574"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7268515">err</a></span>&nbsp;<span class="op" id="7268578">==</span>&nbsp;<span class="builtintype" id="7268581">nil</span>&nbsp;<span class="op" id="7268585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268589"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7268373">t</a></span><span class="op" id="7268590">.</span><span class="ident" id="7268591"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7268596">(</span><span class="string" id="7268597">&#34;RSA&nbsp;decrypted&nbsp;a&nbsp;message&nbsp;that&nbsp;was&nbsp;too&nbsp;long.&#34;</span><span class="op" id="7268641">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7268644">}</span><br>
<span class="lineno"></span><span class="op" id="7268646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7268649">func</span>&nbsp;<span class="ident" id="7268654">TestUnpaddedSignature</span><span class="op" id="7268675">(</span><span class="ident" id="7268676">t</span>&nbsp;<span class="op" id="7268678">*</span><span class="ident" id="7268679"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263911">testing</a></span><span class="op" id="7268686">.</span><span class="ident" id="7268687"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7268688">)</span>&nbsp;<span class="op" id="7268690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268693">msg</span>&nbsp;<span class="op" id="7268697">:=</span>&nbsp;<span class="op" id="7268700">[</span><span class="op" id="7268701">]</span><span class="builtintype" id="7268702">byte</span><span class="op" id="7268706">(</span><span class="string" id="7268707">&#34;Thu&nbsp;Dec&nbsp;19&nbsp;18:06:16&nbsp;EST&nbsp;2013\n&#34;</span><span class="op" id="7268739">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7268742">//&nbsp;This&nbsp;base64&nbsp;value&nbsp;was&nbsp;generated&nbsp;with:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7268784">//&nbsp;%&nbsp;echo&nbsp;Thu&nbsp;Dec&nbsp;19&nbsp;18:06:16&nbsp;EST&nbsp;2013&nbsp;&gt;&nbsp;/tmp/msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7268835">//&nbsp;%&nbsp;openssl&nbsp;rsautl&nbsp;-sign&nbsp;-inkey&nbsp;key&nbsp;-out&nbsp;/tmp/sig&nbsp;-in&nbsp;/tmp/msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7268900">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7268904">//&nbsp;Where&nbsp;&#34;key&#34;&nbsp;contains&nbsp;the&nbsp;RSA&nbsp;private&nbsp;key&nbsp;given&nbsp;at&nbsp;the&nbsp;bottom&nbsp;of&nbsp;this</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7268977">//&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7268987">expectedSig</span>&nbsp;<span class="op" id="7268999">:=</span>&nbsp;<span class="ident" id="7269002"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263946">decodeBase64</a></span><span class="op" id="7269014">(</span><span class="string" id="7269015">&#34;pX4DR8azytjdQ1rtUiC040FjkepuQut5q2ZFX1pTjBrOVKNjgsCDyiJDGZTCNoh9qpXYbhl7iEym30BWWwuiZg==&#34;</span><span class="op" id="7269105">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269109">sig</span><span class="op" id="7269112">,</span>&nbsp;<span class="ident" id="7269114">err</span>&nbsp;<span class="op" id="7269118">:=</span>&nbsp;<span class="ident" id="7269121"><a href="/gostd/crypto/rsa/pkcs1v15.go.html#4731399">SignPKCS1v15</a></span><span class="op" id="7269133">(</span><span class="builtintype" id="7269134">nil</span><span class="op" id="7269137">,</span>&nbsp;<span class="ident" id="7269139"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7270722">rsaPrivateKey</a></span><span class="op" id="7269152">,</span>&nbsp;<span class="ident" id="7269154"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263818">crypto</a></span><span class="op" id="7269160">.</span><span class="ident" id="7269161"><a href="/gostd/crypto/crypto.go.html#3010057">Hash</a></span><span class="op" id="7269165">(</span><span class="num" id="7269166">0</span><span class="op" id="7269167">)</span><span class="op" id="7269168">,</span>&nbsp;<span class="ident" id="7269170"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7268693">msg</a></span><span class="op" id="7269173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7269176">if</span>&nbsp;<span class="ident" id="7269179"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7269114">err</a></span>&nbsp;<span class="op" id="7269183">!=</span>&nbsp;<span class="builtintype" id="7269186">nil</span>&nbsp;<span class="op" id="7269190">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269194"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7268676">t</a></span><span class="op" id="7269195">.</span><span class="ident" id="7269196"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7269202">(</span><span class="string" id="7269203">&#34;SignPKCS1v15&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="7269228">,</span>&nbsp;<span class="ident" id="7269230"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7269114">err</a></span><span class="op" id="7269233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7269236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7269239">if</span>&nbsp;<span class="op" id="7269242">!</span><span class="ident" id="7269243"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263809">bytes</a></span><span class="op" id="7269248">.</span><span class="ident" id="7269249"><a href="/gostd/bytes/bytes_decl.go.html#1414806">Equal</a></span><span class="op" id="7269254">(</span><span class="ident" id="7269255"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7269109">sig</a></span><span class="op" id="7269258">,</span>&nbsp;<span class="ident" id="7269260"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7268987">expectedSig</a></span><span class="op" id="7269271">)</span>&nbsp;<span class="op" id="7269273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269277"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7268676">t</a></span><span class="op" id="7269278">.</span><span class="ident" id="7269279"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7269285">(</span><span class="string" id="7269286">&#34;signature&nbsp;is&nbsp;not&nbsp;expected&nbsp;value:&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="7269336">,</span>&nbsp;<span class="ident" id="7269338"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7269109">sig</a></span><span class="op" id="7269341">,</span>&nbsp;<span class="ident" id="7269343"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7268987">expectedSig</a></span><span class="op" id="7269354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7269357">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7269360">if</span>&nbsp;<span class="ident" id="7269363">err</span>&nbsp;<span class="op" id="7269367">:=</span>&nbsp;<span class="ident" id="7269370"><a href="/gostd/crypto/rsa/pkcs1v15.go.html#4732385">VerifyPKCS1v15</a></span><span class="op" id="7269384">(</span><span class="op" id="7269385">&amp;</span><span class="ident" id="7269386"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7270722">rsaPrivateKey</a></span><span class="op" id="7269399">.</span><span class="ident" id="7269400"><a href="/gostd/crypto/rsa/rsa.go.html#4743795">PublicKey</a></span><span class="op" id="7269409">,</span>&nbsp;<span class="ident" id="7269411"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263818">crypto</a></span><span class="op" id="7269417">.</span><span class="ident" id="7269418"><a href="/gostd/crypto/crypto.go.html#3010057">Hash</a></span><span class="op" id="7269422">(</span><span class="num" id="7269423">0</span><span class="op" id="7269424">)</span><span class="op" id="7269425">,</span>&nbsp;<span class="ident" id="7269427"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7268693">msg</a></span><span class="op" id="7269430">,</span>&nbsp;<span class="ident" id="7269432"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7269109">sig</a></span><span class="op" id="7269435">)</span><span class="op" id="7269436">;</span>&nbsp;<span class="ident" id="7269438"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7269363">err</a></span>&nbsp;<span class="op" id="7269442">!=</span>&nbsp;<span class="builtintype" id="7269445">nil</span>&nbsp;<span class="op" id="7269449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269453"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7268676">t</a></span><span class="op" id="7269454">.</span><span class="ident" id="7269455"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7269461">(</span><span class="string" id="7269462">&#34;signature&nbsp;failed&nbsp;to&nbsp;verify:&nbsp;%s&#34;</span><span class="op" id="7269494">,</span>&nbsp;<span class="ident" id="7269496"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7269363">err</a></span><span class="op" id="7269499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7269502">}</span><br>
<span class="lineno"></span><span class="op" id="7269504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="keyword" id="7269507">func</span>&nbsp;<span class="ident" id="7269512">TestShortSessionKey</span><span class="op" id="7269531">(</span><span class="ident" id="7269532">t</span>&nbsp;<span class="op" id="7269534">*</span><span class="ident" id="7269535"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263911">testing</a></span><span class="op" id="7269542">.</span><span class="ident" id="7269543"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7269544">)</span>&nbsp;<span class="op" id="7269546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7269549">//&nbsp;This&nbsp;tests&nbsp;that&nbsp;attempting&nbsp;to&nbsp;decrypt&nbsp;a&nbsp;session&nbsp;key&nbsp;where&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7269615">//&nbsp;ciphertext&nbsp;is&nbsp;too&nbsp;small&nbsp;doesn&#39;t&nbsp;run&nbsp;outside&nbsp;the&nbsp;array&nbsp;bounds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269681">ciphertext</span><span class="op" id="7269691">,</span>&nbsp;<span class="ident" id="7269693">err</span>&nbsp;<span class="op" id="7269697">:=</span>&nbsp;<span class="ident" id="7269700"><a href="/gostd/crypto/rsa/pkcs1v15.go.html#4724961">EncryptPKCS1v15</a></span><span class="op" id="7269715">(</span><span class="ident" id="7269716"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263828">rand</a></span><span class="op" id="7269720">.</span><span class="ident" id="7269721"><a href="/gostd/crypto/rand/rand.go.html#4355686">Reader</a></span><span class="op" id="7269727">,</span>&nbsp;<span class="op" id="7269729">&amp;</span><span class="ident" id="7269730"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7270722">rsaPrivateKey</a></span><span class="op" id="7269743">.</span><span class="ident" id="7269744"><a href="/gostd/crypto/rsa/rsa.go.html#4743795">PublicKey</a></span><span class="op" id="7269753">,</span>&nbsp;<span class="op" id="7269755">[</span><span class="op" id="7269756">]</span><span class="builtintype" id="7269757">byte</span><span class="op" id="7269761">{</span><span class="num" id="7269762">1</span><span class="op" id="7269763">}</span><span class="op" id="7269764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7269767">if</span>&nbsp;<span class="ident" id="7269770"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7269693">err</a></span>&nbsp;<span class="op" id="7269774">!=</span>&nbsp;<span class="builtintype" id="7269777">nil</span>&nbsp;<span class="op" id="7269781">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269785"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7269532">t</a></span><span class="op" id="7269786">.</span><span class="ident" id="7269787"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7269793">(</span><span class="string" id="7269794">&#34;Failed&nbsp;to&nbsp;encrypt&nbsp;short&nbsp;message:&nbsp;%s&#34;</span><span class="op" id="7269831">,</span>&nbsp;<span class="ident" id="7269833"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7269693">err</a></span><span class="op" id="7269836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7269839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7269843">var</span>&nbsp;<span class="ident" id="7269847">key</span>&nbsp;<span class="op" id="7269851">[</span><span class="num" id="7269852">32</span><span class="op" id="7269854">]</span><span class="builtintype" id="7269855">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7269861">if</span>&nbsp;<span class="ident" id="7269864">err</span>&nbsp;<span class="op" id="7269868">:=</span>&nbsp;<span class="ident" id="7269871"><a href="/gostd/crypto/rsa/pkcs1v15.go.html#4726989">DecryptPKCS1v15SessionKey</a></span><span class="op" id="7269896">(</span><span class="builtintype" id="7269897">nil</span><span class="op" id="7269900">,</span>&nbsp;<span class="ident" id="7269902"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7270722">rsaPrivateKey</a></span><span class="op" id="7269915">,</span>&nbsp;<span class="ident" id="7269917"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7269681">ciphertext</a></span><span class="op" id="7269927">,</span>&nbsp;<span class="ident" id="7269929"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7269847">key</a></span><span class="op" id="7269932">[</span><span class="op" id="7269933">:</span><span class="op" id="7269934">]</span><span class="op" id="7269935">)</span><span class="op" id="7269936">;</span>&nbsp;<span class="ident" id="7269938"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7269864">err</a></span>&nbsp;<span class="op" id="7269942">!=</span>&nbsp;<span class="builtintype" id="7269945">nil</span>&nbsp;<span class="op" id="7269949">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7269953"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7269532">t</a></span><span class="op" id="7269954">.</span><span class="ident" id="7269955"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7269961">(</span><span class="string" id="7269962">&#34;Failed&nbsp;to&nbsp;decrypt&nbsp;short&nbsp;message:&nbsp;%s&#34;</span><span class="op" id="7269999">,</span>&nbsp;<span class="ident" id="7270001"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7269864">err</a></span><span class="op" id="7270004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7270007">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7270011">for</span>&nbsp;<span class="ident" id="7270015">_</span><span class="op" id="7270016">,</span>&nbsp;<span class="ident" id="7270018">v</span>&nbsp;<span class="op" id="7270020">:=</span>&nbsp;<span class="keyword" id="7270023">range</span>&nbsp;<span class="ident" id="7270029"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7269847">key</a></span>&nbsp;<span class="op" id="7270033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7270037">if</span>&nbsp;<span class="ident" id="7270040"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7270018">v</a></span>&nbsp;<span class="op" id="7270042">!=</span>&nbsp;<span class="num" id="7270045">0</span>&nbsp;<span class="op" id="7270047">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7270052"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7269532">t</a></span><span class="op" id="7270053">.</span><span class="ident" id="7270054"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7270059">(</span><span class="string" id="7270060">&#34;key&nbsp;was&nbsp;modified&nbsp;when&nbsp;ciphertext&nbsp;was&nbsp;invalid&#34;</span><span class="op" id="7270106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7270110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7270113">}</span><br>
<span class="lineno"></span><span class="op" id="7270115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="7270118">//&nbsp;In&nbsp;order&nbsp;to&nbsp;generate&nbsp;new&nbsp;test&nbsp;vectors&nbsp;you&#39;ll&nbsp;need&nbsp;the&nbsp;PEM&nbsp;form&nbsp;of&nbsp;this&nbsp;key:</span><br>
<span class="lineno"></span><span class="comment" id="7270197">//&nbsp;-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----</span><br>
<span class="lineno"></span><span class="comment" id="7270232">//&nbsp;MIIBOgIBAAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0</span><br>
<span class="lineno"></span><span class="comment" id="7270300">//&nbsp;fd7Ai2KW5ToIwzFofvJcS/STa6HA5gQenRUCAwEAAQJBAIq9amn00aS0h/CrjXqu</span><br>
<span class="lineno"></span><span class="comment" id="7270368">//&nbsp;/ThglAXJmZhOMPVn4eiu7/ROixi9sex436MaVeMqSNf7Ex9a8fRNfWss7Sqd9eWu</span><br>
<span class="lineno">255</span><span class="comment" id="7270436">//&nbsp;RTUCIQDasvGASLqmjeffBNLTXV2A5g4t+kLVCpsEIZAycV5GswIhANEPLmax0ME/</span><br>
<span class="lineno"></span><span class="comment" id="7270504">//&nbsp;EO+ZJ79TJKN5yiGBRsv5yvx5UiHxajEXAiAhAol5N4EUyq6I9w1rYdhPMGpLfk7A</span><br>
<span class="lineno"></span><span class="comment" id="7270572">//&nbsp;IU2snfRJ6Nq2CQIgFrPsWRCkV+gOYcajD17rEqmuLrdIRexpg8N1DOSXoJ8CIGlS</span><br>
<span class="lineno"></span><span class="comment" id="7270640">//&nbsp;tAboUGBxTDq3ZroNism3DaMIbKPyYrAqhKov1h5V</span><br>
<span class="lineno"></span><span class="comment" id="7270684">//&nbsp;-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="7270718">var</span>&nbsp;<span class="ident" id="7270722">rsaPrivateKey</span>&nbsp;<span class="op" id="7270736">=</span>&nbsp;<span class="op" id="7270738">&amp;</span><span class="ident" id="7270739"><a href="/gostd/crypto/rsa/rsa.go.html#4743774">PrivateKey</a></span><span class="op" id="7270749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7270752"><a href="/gostd/crypto/rsa/rsa.go.html#4743795">PublicKey</a></span><span class="op" id="7270761">:</span>&nbsp;<span class="ident" id="7270763"><a href="/gostd/crypto/rsa/rsa.go.html#4742943">PublicKey</a></span><span class="op" id="7270772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7270776"><a href="/gostd/crypto/rsa/rsa.go.html#4742963">N</a></span><span class="op" id="7270777">:</span>&nbsp;<span class="ident" id="7270779"><a href="/gostd/crypto/rsa/rsa_test.go.html#7281125">fromBase10</a></span><span class="op" id="7270789">(</span><span class="string" id="7270790">&#34;9353930466774385905609975137998169297361893554149986716853295022578535724979677252958524466350471210367835187480748268864277464700638583474144061408845077&#34;</span><span class="op" id="7270946">)</span><span class="op" id="7270947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7270951"><a href="/gostd/crypto/rsa/rsa.go.html#4742986">E</a></span><span class="op" id="7270952">:</span>&nbsp;<span class="num" id="7270954">65537</span><span class="op" id="7270959">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7270962">}</span><span class="op" id="7270963">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7270966"><a href="/gostd/crypto/rsa/rsa.go.html#4743833">D</a></span><span class="op" id="7270967">:</span>&nbsp;<span class="ident" id="7270969"><a href="/gostd/crypto/rsa/rsa_test.go.html#7281125">fromBase10</a></span><span class="op" id="7270979">(</span><span class="string" id="7270980">&#34;7266398431328116344057699379749222532279343923819063639497049039389899328538543087657733766554155839834519529439851673014800261285757759040931985506583861&#34;</span><span class="op" id="7271136">)</span><span class="op" id="7271137">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7271140"><a href="/gostd/crypto/rsa/rsa.go.html#4743875">Primes</a></span><span class="op" id="7271146">:</span>&nbsp;<span class="op" id="7271148">[</span><span class="op" id="7271149">]</span><span class="op" id="7271150">*</span><span class="ident" id="7271151"><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html#7263899">big</a></span><span class="op" id="7271154">.</span><span class="ident" id="7271155"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="7271158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7271162"><a href="/gostd/crypto/rsa/rsa_test.go.html#7281125">fromBase10</a></span><span class="op" id="7271172">(</span><span class="string" id="7271173">&#34;98920366548084643601728869055592650835572950932266967461790948584315647051443&#34;</span><span class="op" id="7271252">)</span><span class="op" id="7271253">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7271257"><a href="/gostd/crypto/rsa/rsa_test.go.html#7281125">fromBase10</a></span><span class="op" id="7271267">(</span><span class="string" id="7271268">&#34;94560208308847015747498523884063394671606671904944666360068158221458669711639&#34;</span><span class="op" id="7271347">)</span><span class="op" id="7271348">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7271351">}</span><span class="op" id="7271352">,</span><br>
<span class="lineno"></span><span class="op" id="7271354">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
