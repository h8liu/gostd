<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os</h2>
<ul>
<li><a href="/gostd/os/dir_unix.go.html">dir_unix.go</a></li>
<li><a href="/gostd/os/doc.go.html">doc.go</a></li>
<li><a href="/gostd/os/env.go.html">env.go</a></li>
<li><a href="/gostd/os/env_test.go.html">env_test.go</a></li>
<li><a href="/gostd/os/env_unix_test.go.html">env_unix_test.go</a></li>
<li><a href="/gostd/os/error.go.html">error.go</a></li>
<li><a href="/gostd/os/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/os/error_unix.go.html">error_unix.go</a></li>
<li><a href="/gostd/os/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec_posix.go.html">exec_posix.go</a></li>
<li><a href="/gostd/os/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/os/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/os/file.go.html">file.go</a></li>
<li><a href="/gostd/os/file_posix.go.html">file_posix.go</a></li>
<li><a href="/gostd/os/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/os/getwd.go.html">getwd.go</a></li>
<li><a href="/gostd/os/os_test.go.html">os_test.go</a></li>
<li><a href="/gostd/os/os_unix_test.go.html">os_unix_test.go</a></li>
<li><a href="/gostd/os/path.go.html">path.go</a></li>
<li><a href="/gostd/os/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/os/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/os/pipe_linux.go.html">pipe_linux.go</a></li>
<li><a href="/gostd/os/proc.go.html">proc.go</a></li>
<li><a href="/gostd/os/stat_linux.go.html" class="current">stat_linux.go</a></li>
<li><a href="/gostd/os/sys_linux.go.html">sys_linux.go</a></li>
<li><a href="/gostd/os/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/os/types.go.html">types.go</a></li>
<li><a href="/gostd/os/types_notwin.go.html">types_notwin.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2460614">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2460669">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2460723">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2460774">package</span>&nbsp;<span class="ident" id="2460782">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2460786">import</span>&nbsp;<span class="op" id="2460793">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2460796">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2460807">&#34;time&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2460814">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2460817">func</span>&nbsp;<span class="ident" id="2460822">sameFile</span><span class="op" id="2460830">(</span><span class="ident" id="2460831">fs1</span><span class="op" id="2460834">,</span>&nbsp;<span class="ident" id="2460836">fs2</span>&nbsp;<span class="op" id="2460840">*</span><span class="ident" id="2460841">fileStat</span><span class="op" id="2460849">)</span>&nbsp;<span class="builtintype" id="2460851">bool</span>&nbsp;<span class="op" id="2460856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2460859">stat1</span>&nbsp;<span class="op" id="2460865">:=</span>&nbsp;<span class="ident" id="2460868">fs1</span><span class="op" id="2460871">.</span><span class="ident" id="2460872">sys</span><span class="op" id="2460875">.</span><span class="op" id="2460876">(</span><span class="op" id="2460877">*</span><span class="ident" id="2460878">syscall</span><span class="op" id="2460885">.</span><span class="ident" id="2460886">Stat_t</span><span class="op" id="2460892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2460895">stat2</span>&nbsp;<span class="op" id="2460901">:=</span>&nbsp;<span class="ident" id="2460904">fs2</span><span class="op" id="2460907">.</span><span class="ident" id="2460908">sys</span><span class="op" id="2460911">.</span><span class="op" id="2460912">(</span><span class="op" id="2460913">*</span><span class="ident" id="2460914">syscall</span><span class="op" id="2460921">.</span><span class="ident" id="2460922">Stat_t</span><span class="op" id="2460928">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2460931">return</span>&nbsp;<span class="ident" id="2460938">stat1</span><span class="op" id="2460943">.</span><span class="ident" id="2460944">Dev</span>&nbsp;<span class="op" id="2460948">==</span>&nbsp;<span class="ident" id="2460951">stat2</span><span class="op" id="2460956">.</span><span class="ident" id="2460957">Dev</span>&nbsp;<span class="op" id="2460961">&amp;&amp;</span>&nbsp;<span class="ident" id="2460964">stat1</span><span class="op" id="2460969">.</span><span class="ident" id="2460970">Ino</span>&nbsp;<span class="op" id="2460974">==</span>&nbsp;<span class="ident" id="2460977">stat2</span><span class="op" id="2460982">.</span><span class="ident" id="2460983">Ino</span><br>
<span class="lineno"></span><span class="op" id="2460987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2460990">func</span>&nbsp;<span class="ident" id="2460995">fileInfoFromStat</span><span class="op" id="2461011">(</span><span class="ident" id="2461012">st</span>&nbsp;<span class="op" id="2461015">*</span><span class="ident" id="2461016">syscall</span><span class="op" id="2461023">.</span><span class="ident" id="2461024">Stat_t</span><span class="op" id="2461030">,</span>&nbsp;<span class="ident" id="2461032">name</span>&nbsp;<span class="builtintype" id="2461037">string</span><span class="op" id="2461043">)</span>&nbsp;<span class="ident" id="2461045">FileInfo</span>&nbsp;<span class="op" id="2461054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2461057">fs</span>&nbsp;<span class="op" id="2461060">:=</span>&nbsp;<span class="op" id="2461063">&amp;</span><span class="ident" id="2461064">fileStat</span><span class="op" id="2461072">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2461076">name</span><span class="op" id="2461080">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2461085">basename</span><span class="op" id="2461093">(</span><span class="ident" id="2461094">name</span><span class="op" id="2461098">)</span><span class="op" id="2461099">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2461103">size</span><span class="op" id="2461107">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2461112">int64</span><span class="op" id="2461117">(</span><span class="ident" id="2461118">st</span><span class="op" id="2461120">.</span><span class="ident" id="2461121">Size</span><span class="op" id="2461125">)</span><span class="op" id="2461126">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2461130">modTime</span><span class="op" id="2461137">:</span>&nbsp;<span class="ident" id="2461139">timespecToTime</span><span class="op" id="2461153">(</span><span class="ident" id="2461154">st</span><span class="op" id="2461156">.</span><span class="ident" id="2461157">Mtim</span><span class="op" id="2461161">)</span><span class="op" id="2461162">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2461166">sys</span><span class="op" id="2461169">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2461175">st</span><span class="op" id="2461177">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2461180">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2461183">fs</span><span class="op" id="2461185">.</span><span class="ident" id="2461186">mode</span>&nbsp;<span class="op" id="2461191">=</span>&nbsp;<span class="ident" id="2461193">FileMode</span><span class="op" id="2461201">(</span><span class="ident" id="2461202">st</span><span class="op" id="2461204">.</span><span class="ident" id="2461205">Mode</span>&nbsp;<span class="op" id="2461210">&amp;</span>&nbsp;<span class="num" id="2461212">0777</span><span class="op" id="2461216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2461219">switch</span>&nbsp;<span class="ident" id="2461226">st</span><span class="op" id="2461228">.</span><span class="ident" id="2461229">Mode</span>&nbsp;<span class="op" id="2461234">&amp;</span>&nbsp;<span class="ident" id="2461236">syscall</span><span class="op" id="2461243">.</span><span class="ident" id="2461244">S_IFMT</span>&nbsp;<span class="op" id="2461251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2461254">case</span>&nbsp;<span class="ident" id="2461259">syscall</span><span class="op" id="2461266">.</span><span class="ident" id="2461267">S_IFBLK</span><span class="op" id="2461274">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2461278">fs</span><span class="op" id="2461280">.</span><span class="ident" id="2461281">mode</span>&nbsp;<span class="op" id="2461286">|=</span>&nbsp;<span class="ident" id="2461289">ModeDevice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2461301">case</span>&nbsp;<span class="ident" id="2461306">syscall</span><span class="op" id="2461313">.</span><span class="ident" id="2461314">S_IFCHR</span><span class="op" id="2461321">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2461325">fs</span><span class="op" id="2461327">.</span><span class="ident" id="2461328">mode</span>&nbsp;<span class="op" id="2461333">|=</span>&nbsp;<span class="ident" id="2461336">ModeDevice</span>&nbsp;<span class="op" id="2461347">|</span>&nbsp;<span class="ident" id="2461349">ModeCharDevice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2461365">case</span>&nbsp;<span class="ident" id="2461370">syscall</span><span class="op" id="2461377">.</span><span class="ident" id="2461378">S_IFDIR</span><span class="op" id="2461385">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2461389">fs</span><span class="op" id="2461391">.</span><span class="ident" id="2461392">mode</span>&nbsp;<span class="op" id="2461397">|=</span>&nbsp;<span class="ident" id="2461400">ModeDir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2461409">case</span>&nbsp;<span class="ident" id="2461414">syscall</span><span class="op" id="2461421">.</span><span class="ident" id="2461422">S_IFIFO</span><span class="op" id="2461429">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2461433">fs</span><span class="op" id="2461435">.</span><span class="ident" id="2461436">mode</span>&nbsp;<span class="op" id="2461441">|=</span>&nbsp;<span class="ident" id="2461444">ModeNamedPipe</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2461459">case</span>&nbsp;<span class="ident" id="2461464">syscall</span><span class="op" id="2461471">.</span><span class="ident" id="2461472">S_IFLNK</span><span class="op" id="2461479">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2461483">fs</span><span class="op" id="2461485">.</span><span class="ident" id="2461486">mode</span>&nbsp;<span class="op" id="2461491">|=</span>&nbsp;<span class="ident" id="2461494">ModeSymlink</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2461507">case</span>&nbsp;<span class="ident" id="2461512">syscall</span><span class="op" id="2461519">.</span><span class="ident" id="2461520">S_IFREG</span><span class="op" id="2461527">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2461531">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2461549">case</span>&nbsp;<span class="ident" id="2461554">syscall</span><span class="op" id="2461561">.</span><span class="ident" id="2461562">S_IFSOCK</span><span class="op" id="2461570">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2461574">fs</span><span class="op" id="2461576">.</span><span class="ident" id="2461577">mode</span>&nbsp;<span class="op" id="2461582">|=</span>&nbsp;<span class="ident" id="2461585">ModeSocket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2461597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2461600">if</span>&nbsp;<span class="ident" id="2461603">st</span><span class="op" id="2461605">.</span><span class="ident" id="2461606">Mode</span><span class="op" id="2461610">&amp;</span><span class="ident" id="2461611">syscall</span><span class="op" id="2461618">.</span><span class="ident" id="2461619">S_ISGID</span>&nbsp;<span class="op" id="2461627">!=</span>&nbsp;<span class="num" id="2461630">0</span>&nbsp;<span class="op" id="2461632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2461636">fs</span><span class="op" id="2461638">.</span><span class="ident" id="2461639">mode</span>&nbsp;<span class="op" id="2461644">|=</span>&nbsp;<span class="ident" id="2461647">ModeSetgid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2461659">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2461662">if</span>&nbsp;<span class="ident" id="2461665">st</span><span class="op" id="2461667">.</span><span class="ident" id="2461668">Mode</span><span class="op" id="2461672">&amp;</span><span class="ident" id="2461673">syscall</span><span class="op" id="2461680">.</span><span class="ident" id="2461681">S_ISUID</span>&nbsp;<span class="op" id="2461689">!=</span>&nbsp;<span class="num" id="2461692">0</span>&nbsp;<span class="op" id="2461694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2461698">fs</span><span class="op" id="2461700">.</span><span class="ident" id="2461701">mode</span>&nbsp;<span class="op" id="2461706">|=</span>&nbsp;<span class="ident" id="2461709">ModeSetuid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2461721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2461724">if</span>&nbsp;<span class="ident" id="2461727">st</span><span class="op" id="2461729">.</span><span class="ident" id="2461730">Mode</span><span class="op" id="2461734">&amp;</span><span class="ident" id="2461735">syscall</span><span class="op" id="2461742">.</span><span class="ident" id="2461743">S_ISVTX</span>&nbsp;<span class="op" id="2461751">!=</span>&nbsp;<span class="num" id="2461754">0</span>&nbsp;<span class="op" id="2461756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2461760">fs</span><span class="op" id="2461762">.</span><span class="ident" id="2461763">mode</span>&nbsp;<span class="op" id="2461768">|=</span>&nbsp;<span class="ident" id="2461771">ModeSticky</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2461783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2461786">return</span>&nbsp;<span class="ident" id="2461793">fs</span><br>
<span class="lineno"></span><span class="op" id="2461796">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2461799">func</span>&nbsp;<span class="ident" id="2461804">timespecToTime</span><span class="op" id="2461818">(</span><span class="ident" id="2461819">ts</span>&nbsp;<span class="ident" id="2461822">syscall</span><span class="op" id="2461829">.</span><span class="ident" id="2461830">Timespec</span><span class="op" id="2461838">)</span>&nbsp;<span class="ident" id="2461840">time</span><span class="op" id="2461844">.</span><span class="ident" id="2461845">Time</span>&nbsp;<span class="op" id="2461850">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2461853">return</span>&nbsp;<span class="ident" id="2461860">time</span><span class="op" id="2461864">.</span><span class="ident" id="2461865">Unix</span><span class="op" id="2461869">(</span><span class="ident" id="2461870">int64</span><span class="op" id="2461875">(</span><span class="ident" id="2461876">ts</span><span class="op" id="2461878">.</span><span class="ident" id="2461879">Sec</span><span class="op" id="2461882">)</span><span class="op" id="2461883">,</span>&nbsp;<span class="ident" id="2461885">int64</span><span class="op" id="2461890">(</span><span class="ident" id="2461891">ts</span><span class="op" id="2461893">.</span><span class="ident" id="2461894">Nsec</span><span class="op" id="2461898">)</span><span class="op" id="2461899">)</span><br>
<span class="lineno"></span><span class="op" id="2461901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2461904">//&nbsp;For&nbsp;testing.</span><br>
<span class="lineno"></span><span class="keyword" id="2461920">func</span>&nbsp;<span class="ident" id="2461925">atime</span><span class="op" id="2461930">(</span><span class="ident" id="2461931">fi</span>&nbsp;<span class="ident" id="2461934">FileInfo</span><span class="op" id="2461942">)</span>&nbsp;<span class="ident" id="2461944">time</span><span class="op" id="2461948">.</span><span class="ident" id="2461949">Time</span>&nbsp;<span class="op" id="2461954">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2461957">return</span>&nbsp;<span class="ident" id="2461964">timespecToTime</span><span class="op" id="2461978">(</span><span class="ident" id="2461979">fi</span><span class="op" id="2461981">.</span><span class="ident" id="2461982">Sys</span><span class="op" id="2461985">(</span><span class="op" id="2461986">)</span><span class="op" id="2461987">.</span><span class="op" id="2461988">(</span><span class="op" id="2461989">*</span><span class="ident" id="2461990">syscall</span><span class="op" id="2461997">.</span><span class="ident" id="2461998">Stat_t</span><span class="op" id="2462004">)</span><span class="op" id="2462005">.</span><span class="ident" id="2462006">Atim</span><span class="op" id="2462010">)</span><br>
<span class="lineno"></span><span class="op" id="2462012">}</span>
</div>
</body>
</html>
