<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http/cgi</h2>
<ul>
<li><a href="/gostd/net/http/cgi/child.go.html">child.go</a></li>
<li><a href="/gostd/net/http/cgi/child_test.go.html">child_test.go</a></li>
<li><a href="/gostd/net/http/cgi/host.go.html" class="current">host.go</a></li>
<li><a href="/gostd/net/http/cgi/host_test.go.html">host_test.go</a></li>
<li><a href="/gostd/net/http/cgi/matryoshka_test.go.html">matryoshka_test.go</a></li>
<li><a href="/gostd/net/http/cgi/posix_test.go.html">posix_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5694620">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5694675">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5694729">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5694780">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;the&nbsp;host&nbsp;side&nbsp;of&nbsp;CGI&nbsp;(being&nbsp;the&nbsp;webserver</span><br>
<span class="lineno"></span><span class="comment" id="5694846">//&nbsp;parent&nbsp;process).</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5694867">//&nbsp;Package&nbsp;cgi&nbsp;implements&nbsp;CGI&nbsp;(Common&nbsp;Gateway&nbsp;Interface)&nbsp;as&nbsp;specified</span><br>
<span class="lineno"></span><span class="comment" id="5694937">//&nbsp;in&nbsp;RFC&nbsp;3875.</span><br>
<span class="lineno">10</span><span class="comment" id="5694953">//</span><br>
<span class="lineno"></span><span class="comment" id="5694956">//&nbsp;Note&nbsp;that&nbsp;using&nbsp;CGI&nbsp;means&nbsp;starting&nbsp;a&nbsp;new&nbsp;process&nbsp;to&nbsp;handle&nbsp;each</span><br>
<span class="lineno"></span><span class="comment" id="5695023">//&nbsp;request,&nbsp;which&nbsp;is&nbsp;typically&nbsp;less&nbsp;efficient&nbsp;than&nbsp;using&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5695082">//&nbsp;long-running&nbsp;server.&nbsp;&nbsp;This&nbsp;package&nbsp;is&nbsp;intended&nbsp;primarily&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="5695146">//&nbsp;compatibility&nbsp;with&nbsp;existing&nbsp;systems.</span><br>
<span class="lineno">15</span><span class="keyword" id="5695186">package</span>&nbsp;<span class="ident" id="5695194">cgi</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5695199">import</span>&nbsp;<span class="op" id="5695206">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5695209">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5695218">&#34;fmt&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5695225">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5695231">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5695238">&#34;net/http&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5695250">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5695256">&#34;os/exec&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5695267">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5695284">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5695294">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5695305">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5695316">&#34;strings&#34;</span><br>
<span class="lineno">30</span><span class="op" id="5695326">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5695329">var</span>&nbsp;<span class="ident" id="5695333">trailingPort</span>&nbsp;<span class="op" id="5695346">=</span>&nbsp;<span class="ident" id="5695348"><a href="/gostd/net/http/cgi/host.go.html#5695284">regexp</a></span><span class="op" id="5695354">.</span><span class="ident" id="5695355"><a href="/gostd/regexp/regexp.go.html#3571892">MustCompile</a></span><span class="op" id="5695366">(</span><span class="string" id="5695367">`:([0-9]+)$`</span><span class="op" id="5695379">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5695382">var</span>&nbsp;<span class="ident" id="5695386">osDefaultInheritEnv</span>&nbsp;<span class="op" id="5695406">=</span>&nbsp;<span class="keyword" id="5695408">map</span><span class="op" id="5695411">[</span><span class="builtintype" id="5695412">string</span><span class="op" id="5695418">]</span><span class="op" id="5695419">[</span><span class="op" id="5695420">]</span><span class="builtintype" id="5695421">string</span><span class="op" id="5695427">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5695430">&#34;darwin&#34;</span><span class="op" id="5695438">:</span>&nbsp;&nbsp;<span class="op" id="5695441">{</span><span class="string" id="5695442">&#34;DYLD_LIBRARY_PATH&#34;</span><span class="op" id="5695461">}</span><span class="op" id="5695462">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5695465">&#34;freebsd&#34;</span><span class="op" id="5695474">:</span>&nbsp;<span class="op" id="5695476">{</span><span class="string" id="5695477">&#34;LD_LIBRARY_PATH&#34;</span><span class="op" id="5695494">}</span><span class="op" id="5695495">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5695498">&#34;hpux&#34;</span><span class="op" id="5695504">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5695509">{</span><span class="string" id="5695510">&#34;LD_LIBRARY_PATH&#34;</span><span class="op" id="5695527">,</span>&nbsp;<span class="string" id="5695529">&#34;SHLIB_PATH&#34;</span><span class="op" id="5695541">}</span><span class="op" id="5695542">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5695545">&#34;irix&#34;</span><span class="op" id="5695551">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5695556">{</span><span class="string" id="5695557">&#34;LD_LIBRARY_PATH&#34;</span><span class="op" id="5695574">,</span>&nbsp;<span class="string" id="5695576">&#34;LD_LIBRARYN32_PATH&#34;</span><span class="op" id="5695596">,</span>&nbsp;<span class="string" id="5695598">&#34;LD_LIBRARY64_PATH&#34;</span><span class="op" id="5695617">}</span><span class="op" id="5695618">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5695621">&#34;linux&#34;</span><span class="op" id="5695628">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5695632">{</span><span class="string" id="5695633">&#34;LD_LIBRARY_PATH&#34;</span><span class="op" id="5695650">}</span><span class="op" id="5695651">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5695654">&#34;openbsd&#34;</span><span class="op" id="5695663">:</span>&nbsp;<span class="op" id="5695665">{</span><span class="string" id="5695666">&#34;LD_LIBRARY_PATH&#34;</span><span class="op" id="5695683">}</span><span class="op" id="5695684">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5695687">&#34;solaris&#34;</span><span class="op" id="5695696">:</span>&nbsp;<span class="op" id="5695698">{</span><span class="string" id="5695699">&#34;LD_LIBRARY_PATH&#34;</span><span class="op" id="5695716">,</span>&nbsp;<span class="string" id="5695718">&#34;LD_LIBRARY_PATH_32&#34;</span><span class="op" id="5695738">,</span>&nbsp;<span class="string" id="5695740">&#34;LD_LIBRARY_PATH_64&#34;</span><span class="op" id="5695760">}</span><span class="op" id="5695761">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5695764">&#34;windows&#34;</span><span class="op" id="5695773">:</span>&nbsp;<span class="op" id="5695775">{</span><span class="string" id="5695776">&#34;SystemRoot&#34;</span><span class="op" id="5695788">,</span>&nbsp;<span class="string" id="5695790">&#34;COMSPEC&#34;</span><span class="op" id="5695799">,</span>&nbsp;<span class="string" id="5695801">&#34;PATHEXT&#34;</span><span class="op" id="5695810">,</span>&nbsp;<span class="string" id="5695812">&#34;WINDIR&#34;</span><span class="op" id="5695820">}</span><span class="op" id="5695821">,</span><br>
<span class="lineno"></span><span class="op" id="5695823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="5695826">//&nbsp;Handler&nbsp;runs&nbsp;an&nbsp;executable&nbsp;in&nbsp;a&nbsp;subprocess&nbsp;with&nbsp;a&nbsp;CGI&nbsp;environment.</span><br>
<span class="lineno"></span><span class="keyword" id="5695896">type</span>&nbsp;<span class="ident" id="5695901">Handler</span>&nbsp;<span class="keyword" id="5695909">struct</span>&nbsp;<span class="op" id="5695916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5695919">Path</span>&nbsp;<span class="builtintype" id="5695924">string</span>&nbsp;<span class="comment" id="5695931">//&nbsp;path&nbsp;to&nbsp;the&nbsp;CGI&nbsp;executable</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5695962">Root</span>&nbsp;<span class="builtintype" id="5695967">string</span>&nbsp;<span class="comment" id="5695974">//&nbsp;root&nbsp;URI&nbsp;prefix&nbsp;of&nbsp;handler&nbsp;or&nbsp;empty&nbsp;for&nbsp;&#34;/&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5696023">//&nbsp;Dir&nbsp;specifies&nbsp;the&nbsp;CGI&nbsp;executable&#39;s&nbsp;working&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5696081">//&nbsp;If&nbsp;Dir&nbsp;is&nbsp;empty,&nbsp;the&nbsp;base&nbsp;directory&nbsp;of&nbsp;Path&nbsp;is&nbsp;used.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5696138">//&nbsp;If&nbsp;Path&nbsp;has&nbsp;no&nbsp;base&nbsp;directory,&nbsp;the&nbsp;current&nbsp;working</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5696193">//&nbsp;directory&nbsp;is&nbsp;used.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696216">Dir</span>&nbsp;<span class="builtintype" id="5696220">string</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696229">Env</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5696240">[</span><span class="op" id="5696241">]</span><span class="builtintype" id="5696242">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5696252">//&nbsp;extra&nbsp;environment&nbsp;variables&nbsp;to&nbsp;set,&nbsp;if&nbsp;any,&nbsp;as&nbsp;&#34;key=value&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696315">InheritEnv</span>&nbsp;<span class="op" id="5696326">[</span><span class="op" id="5696327">]</span><span class="builtintype" id="5696328">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5696338">//&nbsp;environment&nbsp;variables&nbsp;to&nbsp;inherit&nbsp;from&nbsp;host,&nbsp;as&nbsp;&#34;key&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696395">Logger</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5696406">*</span><span class="ident" id="5696407"><a href="/gostd/net/http/cgi/host.go.html#5695231">log</a></span><span class="op" id="5696410">.</span><span class="ident" id="5696411"><a href="/gostd/log/log.go.html#4072441">Logger</a></span>&nbsp;<span class="comment" id="5696418">//&nbsp;optional&nbsp;log&nbsp;for&nbsp;errors&nbsp;or&nbsp;nil&nbsp;to&nbsp;use&nbsp;log.Print</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696470">Args</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5696481">[</span><span class="op" id="5696482">]</span><span class="builtintype" id="5696483">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5696493">//&nbsp;optional&nbsp;arguments&nbsp;to&nbsp;pass&nbsp;to&nbsp;child&nbsp;process</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5696542">//&nbsp;PathLocationHandler&nbsp;specifies&nbsp;the&nbsp;root&nbsp;http&nbsp;Handler&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5696603">//&nbsp;should&nbsp;handle&nbsp;internal&nbsp;redirects&nbsp;when&nbsp;the&nbsp;CGI&nbsp;process</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5696661">//&nbsp;returns&nbsp;a&nbsp;Location&nbsp;header&nbsp;value&nbsp;starting&nbsp;with&nbsp;a&nbsp;&#34;/&#34;,&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5696721">//&nbsp;specified&nbsp;in&nbsp;RFC&nbsp;3875&nbsp;§&nbsp;6.3.2.&nbsp;This&nbsp;will&nbsp;likely&nbsp;be</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5696777">//&nbsp;http.DefaultServeMux.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5696803">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5696807">//&nbsp;If&nbsp;nil,&nbsp;a&nbsp;CGI&nbsp;response&nbsp;with&nbsp;a&nbsp;local&nbsp;URI&nbsp;path&nbsp;is&nbsp;instead&nbsp;sent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5696872">//&nbsp;back&nbsp;to&nbsp;the&nbsp;client&nbsp;and&nbsp;not&nbsp;redirected&nbsp;internally.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5696926">PathLocationHandler</span>&nbsp;<span class="ident" id="5696946"><a href="/gostd/net/http/cgi/host.go.html#5695238">http</a></span><span class="op" id="5696950">.</span><span class="ident" id="5696951"><a href="/gostd/net/http/server.go.html#4170413">Handler</a></span><br>
<span class="lineno">70</span><span class="op" id="5696959">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5696962">//&nbsp;removeLeadingDuplicates&nbsp;remove&nbsp;leading&nbsp;duplicate&nbsp;in&nbsp;environments.</span><br>
<span class="lineno"></span><span class="comment" id="5697031">//&nbsp;It&#39;s&nbsp;possible&nbsp;to&nbsp;override&nbsp;environment&nbsp;like&nbsp;following.</span><br>
<span class="lineno"></span><span class="comment" id="5697088">//&nbsp;&nbsp;&nbsp;&nbsp;cgi.Handler{</span><br>
<span class="lineno">75</span><span class="comment" id="5697107">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="5697119">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Env:&nbsp;[]string{&#34;SCRIPT_FILENAME=foo.php&#34;},</span><br>
<span class="lineno"></span><span class="comment" id="5697169">//&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="5697177">func</span>&nbsp;<span class="ident" id="5697182">removeLeadingDuplicates</span><span class="op" id="5697205">(</span><span class="ident" id="5697206">env</span>&nbsp;<span class="op" id="5697210">[</span><span class="op" id="5697211">]</span><span class="builtintype" id="5697212">string</span><span class="op" id="5697218">)</span>&nbsp;<span class="op" id="5697220">(</span><span class="ident" id="5697221">ret</span>&nbsp;<span class="op" id="5697225">[</span><span class="op" id="5697226">]</span><span class="builtintype" id="5697227">string</span><span class="op" id="5697233">)</span>&nbsp;<span class="op" id="5697235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5697238">n</span>&nbsp;<span class="op" id="5697240">:=</span>&nbsp;<span class="builtinfunc" id="5697243">len</span><span class="op" id="5697246">(</span><span class="ident" id="5697247"><a href="/gostd/net/http/cgi/host.go.html#5697206">env</a></span><span class="op" id="5697250">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5697253">for</span>&nbsp;<span class="ident" id="5697257">i</span>&nbsp;<span class="op" id="5697259">:=</span>&nbsp;<span class="num" id="5697262">0</span><span class="op" id="5697263">;</span>&nbsp;<span class="ident" id="5697265"><a href="/gostd/net/http/cgi/host.go.html#5697257">i</a></span>&nbsp;<span class="op" id="5697267">&lt;</span>&nbsp;<span class="ident" id="5697269"><a href="/gostd/net/http/cgi/host.go.html#5697238">n</a></span><span class="op" id="5697270">;</span>&nbsp;<span class="ident" id="5697272"><a href="/gostd/net/http/cgi/host.go.html#5697257">i</a></span><span class="op" id="5697273">++</span>&nbsp;<span class="op" id="5697276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5697280">e</span>&nbsp;<span class="op" id="5697282">:=</span>&nbsp;<span class="ident" id="5697285"><a href="/gostd/net/http/cgi/host.go.html#5697206">env</a></span><span class="op" id="5697288">[</span><span class="ident" id="5697289"><a href="/gostd/net/http/cgi/host.go.html#5697257">i</a></span><span class="op" id="5697290">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5697294">s</span>&nbsp;<span class="op" id="5697296">:=</span>&nbsp;<span class="ident" id="5697299"><a href="/gostd/net/http/cgi/host.go.html#5695316">strings</a></span><span class="op" id="5697306">.</span><span class="ident" id="5697307"><a href="/gostd/strings/strings.go.html#2972338">SplitN</a></span><span class="op" id="5697313">(</span><span class="ident" id="5697314"><a href="/gostd/net/http/cgi/host.go.html#5697280">e</a></span><span class="op" id="5697315">,</span>&nbsp;<span class="string" id="5697317">&#34;=&#34;</span><span class="op" id="5697320">,</span>&nbsp;<span class="num" id="5697322">2</span><span class="op" id="5697323">)</span><span class="op" id="5697324">[</span><span class="num" id="5697325">0</span><span class="op" id="5697326">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5697330">found</span>&nbsp;<span class="op" id="5697336">:=</span>&nbsp;<span class="builtintype" id="5697339">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5697347">for</span>&nbsp;<span class="ident" id="5697351">j</span>&nbsp;<span class="op" id="5697353">:=</span>&nbsp;<span class="ident" id="5697356"><a href="/gostd/net/http/cgi/host.go.html#5697257">i</a></span>&nbsp;<span class="op" id="5697358">+</span>&nbsp;<span class="num" id="5697360">1</span><span class="op" id="5697361">;</span>&nbsp;<span class="ident" id="5697363"><a href="/gostd/net/http/cgi/host.go.html#5697351">j</a></span>&nbsp;<span class="op" id="5697365">&lt;</span>&nbsp;<span class="ident" id="5697367"><a href="/gostd/net/http/cgi/host.go.html#5697238">n</a></span><span class="op" id="5697368">;</span>&nbsp;<span class="ident" id="5697370"><a href="/gostd/net/http/cgi/host.go.html#5697351">j</a></span><span class="op" id="5697371">++</span>&nbsp;<span class="op" id="5697374">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5697379">if</span>&nbsp;<span class="ident" id="5697382"><a href="/gostd/net/http/cgi/host.go.html#5697294">s</a></span>&nbsp;<span class="op" id="5697384">==</span>&nbsp;<span class="ident" id="5697387"><a href="/gostd/net/http/cgi/host.go.html#5695316">strings</a></span><span class="op" id="5697394">.</span><span class="ident" id="5697395"><a href="/gostd/strings/strings.go.html#2972338">SplitN</a></span><span class="op" id="5697401">(</span><span class="ident" id="5697402"><a href="/gostd/net/http/cgi/host.go.html#5697206">env</a></span><span class="op" id="5697405">[</span><span class="ident" id="5697406"><a href="/gostd/net/http/cgi/host.go.html#5697351">j</a></span><span class="op" id="5697407">]</span><span class="op" id="5697408">,</span>&nbsp;<span class="string" id="5697410">&#34;=&#34;</span><span class="op" id="5697413">,</span>&nbsp;<span class="num" id="5697415">2</span><span class="op" id="5697416">)</span><span class="op" id="5697417">[</span><span class="num" id="5697418">0</span><span class="op" id="5697419">]</span>&nbsp;<span class="op" id="5697421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5697427"><a href="/gostd/net/http/cgi/host.go.html#5697330">found</a></span>&nbsp;<span class="op" id="5697433">=</span>&nbsp;<span class="builtintype" id="5697435">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5697444">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5697453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5697457">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5697461">if</span>&nbsp;<span class="op" id="5697464">!</span><span class="ident" id="5697465"><a href="/gostd/net/http/cgi/host.go.html#5697330">found</a></span>&nbsp;<span class="op" id="5697471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5697476"><a href="/gostd/net/http/cgi/host.go.html#5697221">ret</a></span>&nbsp;<span class="op" id="5697480">=</span>&nbsp;<span class="builtinfunc" id="5697482">append</span><span class="op" id="5697488">(</span><span class="ident" id="5697489"><a href="/gostd/net/http/cgi/host.go.html#5697221">ret</a></span><span class="op" id="5697492">,</span>&nbsp;<span class="ident" id="5697494"><a href="/gostd/net/http/cgi/host.go.html#5697280">e</a></span><span class="op" id="5697495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5697499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5697502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5697505">return</span><br>
<span class="lineno">95</span><span class="op" id="5697512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5697515">func</span>&nbsp;<span class="op" id="5697520">(</span><span class="ident" id="5697521">h</span>&nbsp;<span class="op" id="5697523">*</span><span class="ident" id="5697524"><a href="/gostd/net/http/cgi/host.go.html#5695901">Handler</a></span><span class="op" id="5697531">)</span>&nbsp;<span class="ident" id="5697533">ServeHTTP</span><span class="op" id="5697542">(</span><span class="ident" id="5697543">rw</span>&nbsp;<span class="ident" id="5697546"><a href="/gostd/net/http/cgi/host.go.html#5695238">http</a></span><span class="op" id="5697550">.</span><span class="ident" id="5697551"><a href="/gostd/net/http/server.go.html#4170569">ResponseWriter</a></span><span class="op" id="5697565">,</span>&nbsp;<span class="ident" id="5697567">req</span>&nbsp;<span class="op" id="5697571">*</span><span class="ident" id="5697572"><a href="/gostd/net/http/cgi/host.go.html#5695238">http</a></span><span class="op" id="5697576">.</span><span class="ident" id="5697577"><a href="/gostd/net/http/request.go.html#4135954">Request</a></span><span class="op" id="5697584">)</span>&nbsp;<span class="op" id="5697586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5697589">root</span>&nbsp;<span class="op" id="5697594">:=</span>&nbsp;<span class="ident" id="5697597"><a href="/gostd/net/http/cgi/host.go.html#5697521">h</a></span><span class="op" id="5697598">.</span><span class="ident" id="5697599"><a href="/gostd/net/http/cgi/host.go.html#5695962">Root</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5697605">if</span>&nbsp;<span class="ident" id="5697608"><a href="/gostd/net/http/cgi/host.go.html#5697589">root</a></span>&nbsp;<span class="op" id="5697613">==</span>&nbsp;<span class="string" id="5697616">&#34;&#34;</span>&nbsp;<span class="op" id="5697619">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5697623"><a href="/gostd/net/http/cgi/host.go.html#5697589">root</a></span>&nbsp;<span class="op" id="5697628">=</span>&nbsp;<span class="string" id="5697630">&#34;/&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5697635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5697639">if</span>&nbsp;<span class="builtinfunc" id="5697642">len</span><span class="op" id="5697645">(</span><span class="ident" id="5697646"><a href="/gostd/net/http/cgi/host.go.html#5697567">req</a></span><span class="op" id="5697649">.</span><span class="ident" id="5697650"><a href="/gostd/net/http/request.go.html#4138599">TransferEncoding</a></span><span class="op" id="5697666">)</span>&nbsp;<span class="op" id="5697668">&gt;</span>&nbsp;<span class="num" id="5697670">0</span>&nbsp;<span class="op" id="5697672">&amp;&amp;</span>&nbsp;<span class="ident" id="5697675"><a href="/gostd/net/http/cgi/host.go.html#5697567">req</a></span><span class="op" id="5697678">.</span><span class="ident" id="5697679"><a href="/gostd/net/http/request.go.html#4138599">TransferEncoding</a></span><span class="op" id="5697695">[</span><span class="num" id="5697696">0</span><span class="op" id="5697697">]</span>&nbsp;<span class="op" id="5697699">==</span>&nbsp;<span class="string" id="5697702">&#34;chunked&#34;</span>&nbsp;<span class="op" id="5697712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5697716"><a href="/gostd/net/http/cgi/host.go.html#5697543">rw</a></span><span class="op" id="5697718">.</span><span class="ident" id="5697719"><a href="/gostd/net/http/server.go.html#4171422">WriteHeader</a></span><span class="op" id="5697730">(</span><span class="ident" id="5697731"><a href="/gostd/net/http/cgi/host.go.html#5695238">http</a></span><span class="op" id="5697735">.</span><span class="ident" id="5697736"><a href="/gostd/net/http/status.go.html#4236667">StatusBadRequest</a></span><span class="op" id="5697752">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5697756"><a href="/gostd/net/http/cgi/host.go.html#5697543">rw</a></span><span class="op" id="5697758">.</span><span class="ident" id="5697759"><a href="/gostd/net/http/server.go.html#4171123">Write</a></span><span class="op" id="5697764">(</span><span class="op" id="5697765">[</span><span class="op" id="5697766">]</span><span class="builtintype" id="5697767">byte</span><span class="op" id="5697771">(</span><span class="string" id="5697772">&#34;Chunked&nbsp;request&nbsp;bodies&nbsp;are&nbsp;not&nbsp;supported&nbsp;by&nbsp;CGI.&#34;</span><span class="op" id="5697822">)</span><span class="op" id="5697823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5697827">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5697835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5697839">pathInfo</span>&nbsp;<span class="op" id="5697848">:=</span>&nbsp;<span class="ident" id="5697851"><a href="/gostd/net/http/cgi/host.go.html#5697567">req</a></span><span class="op" id="5697854">.</span><span class="ident" id="5697855"><a href="/gostd/net/http/request.go.html#4136640">URL</a></span><span class="op" id="5697858">.</span><span class="ident" id="5697859"><a href="/gostd/net/url/url.go.html#3751366">Path</a></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5697865">if</span>&nbsp;<span class="ident" id="5697868"><a href="/gostd/net/http/cgi/host.go.html#5697589">root</a></span>&nbsp;<span class="op" id="5697873">!=</span>&nbsp;<span class="string" id="5697876">&#34;/&#34;</span>&nbsp;<span class="op" id="5697880">&amp;&amp;</span>&nbsp;<span class="ident" id="5697883"><a href="/gostd/net/http/cgi/host.go.html#5695316">strings</a></span><span class="op" id="5697890">.</span><span class="ident" id="5697891"><a href="/gostd/strings/strings.go.html#2975366">HasPrefix</a></span><span class="op" id="5697900">(</span><span class="ident" id="5697901"><a href="/gostd/net/http/cgi/host.go.html#5697839">pathInfo</a></span><span class="op" id="5697909">,</span>&nbsp;<span class="ident" id="5697911"><a href="/gostd/net/http/cgi/host.go.html#5697589">root</a></span><span class="op" id="5697915">)</span>&nbsp;<span class="op" id="5697917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5697921"><a href="/gostd/net/http/cgi/host.go.html#5697839">pathInfo</a></span>&nbsp;<span class="op" id="5697930">=</span>&nbsp;<span class="ident" id="5697932"><a href="/gostd/net/http/cgi/host.go.html#5697839">pathInfo</a></span><span class="op" id="5697940">[</span><span class="builtinfunc" id="5697941">len</span><span class="op" id="5697944">(</span><span class="ident" id="5697945"><a href="/gostd/net/http/cgi/host.go.html#5697589">root</a></span><span class="op" id="5697949">)</span><span class="op" id="5697950">:</span><span class="op" id="5697951">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5697954">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5697958">port</span>&nbsp;<span class="op" id="5697963">:=</span>&nbsp;<span class="string" id="5697966">&#34;80&#34;</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5697972">if</span>&nbsp;<span class="ident" id="5697975">matches</span>&nbsp;<span class="op" id="5697983">:=</span>&nbsp;<span class="ident" id="5697986"><a href="/gostd/net/http/cgi/host.go.html#5695333">trailingPort</a></span><span class="op" id="5697998">.</span><span class="ident" id="5697999"><a href="/gostd/regexp/regexp.go.html#3590884">FindStringSubmatch</a></span><span class="op" id="5698017">(</span><span class="ident" id="5698018"><a href="/gostd/net/http/cgi/host.go.html#5697567">req</a></span><span class="op" id="5698021">.</span><span class="ident" id="5698022"><a href="/gostd/net/http/request.go.html#4139164">Host</a></span><span class="op" id="5698026">)</span><span class="op" id="5698027">;</span>&nbsp;<span class="builtinfunc" id="5698029">len</span><span class="op" id="5698032">(</span><span class="ident" id="5698033"><a href="/gostd/net/http/cgi/host.go.html#5697975">matches</a></span><span class="op" id="5698040">)</span>&nbsp;<span class="op" id="5698042">!=</span>&nbsp;<span class="num" id="5698045">0</span>&nbsp;<span class="op" id="5698047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5698051"><a href="/gostd/net/http/cgi/host.go.html#5697958">port</a></span>&nbsp;<span class="op" id="5698056">=</span>&nbsp;<span class="ident" id="5698058"><a href="/gostd/net/http/cgi/host.go.html#5697975">matches</a></span><span class="op" id="5698065">[</span><span class="num" id="5698066">1</span><span class="op" id="5698067">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5698070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5698074">env</span>&nbsp;<span class="op" id="5698078">:=</span>&nbsp;<span class="op" id="5698081">[</span><span class="op" id="5698082">]</span><span class="builtintype" id="5698083">string</span><span class="op" id="5698089">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5698093">&#34;SERVER_SOFTWARE=go&#34;</span><span class="op" id="5698113">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5698117">&#34;SERVER_NAME=&#34;</span>&nbsp;<span class="op" id="5698132">+</span>&nbsp;<span class="ident" id="5698134"><a href="/gostd/net/http/cgi/host.go.html#5697567">req</a></span><span class="op" id="5698137">.</span><span class="ident" id="5698138"><a href="/gostd/net/http/request.go.html#4139164">Host</a></span><span class="op" id="5698142">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5698146">&#34;SERVER_PROTOCOL=HTTP/1.1&#34;</span><span class="op" id="5698172">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5698176">&#34;HTTP_HOST=&#34;</span>&nbsp;<span class="op" id="5698189">+</span>&nbsp;<span class="ident" id="5698191"><a href="/gostd/net/http/cgi/host.go.html#5697567">req</a></span><span class="op" id="5698194">.</span><span class="ident" id="5698195"><a href="/gostd/net/http/request.go.html#4139164">Host</a></span><span class="op" id="5698199">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5698203">&#34;GATEWAY_INTERFACE=CGI/1.1&#34;</span><span class="op" id="5698230">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5698234">&#34;REQUEST_METHOD=&#34;</span>&nbsp;<span class="op" id="5698252">+</span>&nbsp;<span class="ident" id="5698254"><a href="/gostd/net/http/cgi/host.go.html#5697567">req</a></span><span class="op" id="5698257">.</span><span class="ident" id="5698258"><a href="/gostd/net/http/request.go.html#4136084">Method</a></span><span class="op" id="5698264">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5698268">&#34;QUERY_STRING=&#34;</span>&nbsp;<span class="op" id="5698284">+</span>&nbsp;<span class="ident" id="5698286"><a href="/gostd/net/http/cgi/host.go.html#5697567">req</a></span><span class="op" id="5698289">.</span><span class="ident" id="5698290"><a href="/gostd/net/http/request.go.html#4136640">URL</a></span><span class="op" id="5698293">.</span><span class="ident" id="5698294"><a href="/gostd/net/url/url.go.html#3751383">RawQuery</a></span><span class="op" id="5698302">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5698306">&#34;REQUEST_URI=&#34;</span>&nbsp;<span class="op" id="5698321">+</span>&nbsp;<span class="ident" id="5698323"><a href="/gostd/net/http/cgi/host.go.html#5697567">req</a></span><span class="op" id="5698326">.</span><span class="ident" id="5698327"><a href="/gostd/net/http/request.go.html#4136640">URL</a></span><span class="op" id="5698330">.</span><span class="ident" id="5698331"><a href="/gostd/net/url/url.go.html#3763661">RequestURI</a></span><span class="op" id="5698341">(</span><span class="op" id="5698342">)</span><span class="op" id="5698343">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5698347">&#34;PATH_INFO=&#34;</span>&nbsp;<span class="op" id="5698360">+</span>&nbsp;<span class="ident" id="5698362"><a href="/gostd/net/http/cgi/host.go.html#5697839">pathInfo</a></span><span class="op" id="5698370">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5698374">&#34;SCRIPT_NAME=&#34;</span>&nbsp;<span class="op" id="5698389">+</span>&nbsp;<span class="ident" id="5698391"><a href="/gostd/net/http/cgi/host.go.html#5697589">root</a></span><span class="op" id="5698395">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5698399">&#34;SCRIPT_FILENAME=&#34;</span>&nbsp;<span class="op" id="5698418">+</span>&nbsp;<span class="ident" id="5698420"><a href="/gostd/net/http/cgi/host.go.html#5697521">h</a></span><span class="op" id="5698421">.</span><span class="ident" id="5698422"><a href="/gostd/net/http/cgi/host.go.html#5695919">Path</a></span><span class="op" id="5698426">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5698430">&#34;REMOTE_ADDR=&#34;</span>&nbsp;<span class="op" id="5698445">+</span>&nbsp;<span class="ident" id="5698447"><a href="/gostd/net/http/cgi/host.go.html#5697567">req</a></span><span class="op" id="5698450">.</span><span class="ident" id="5698451"><a href="/gostd/net/http/request.go.html#4141200">RemoteAddr</a></span><span class="op" id="5698461">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5698465">&#34;REMOTE_HOST=&#34;</span>&nbsp;<span class="op" id="5698480">+</span>&nbsp;<span class="ident" id="5698482"><a href="/gostd/net/http/cgi/host.go.html#5697567">req</a></span><span class="op" id="5698485">.</span><span class="ident" id="5698486"><a href="/gostd/net/http/request.go.html#4141200">RemoteAddr</a></span><span class="op" id="5698496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5698500">&#34;SERVER_PORT=&#34;</span>&nbsp;<span class="op" id="5698515">+</span>&nbsp;<span class="ident" id="5698517"><a href="/gostd/net/http/cgi/host.go.html#5697958">port</a></span><span class="op" id="5698521">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5698524">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5698528">if</span>&nbsp;<span class="ident" id="5698531"><a href="/gostd/net/http/cgi/host.go.html#5697567">req</a></span><span class="op" id="5698534">.</span><span class="ident" id="5698535"><a href="/gostd/net/http/request.go.html#4141858">TLS</a></span>&nbsp;<span class="op" id="5698539">!=</span>&nbsp;<span class="builtintype" id="5698542">nil</span>&nbsp;<span class="op" id="5698546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5698550"><a href="/gostd/net/http/cgi/host.go.html#5698074">env</a></span>&nbsp;<span class="op" id="5698554">=</span>&nbsp;<span class="builtinfunc" id="5698556">append</span><span class="op" id="5698562">(</span><span class="ident" id="5698563"><a href="/gostd/net/http/cgi/host.go.html#5698074">env</a></span><span class="op" id="5698566">,</span>&nbsp;<span class="string" id="5698568">&#34;HTTPS=on&#34;</span><span class="op" id="5698578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5698581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5698585">for</span>&nbsp;<span class="ident" id="5698589">k</span><span class="op" id="5698590">,</span>&nbsp;<span class="ident" id="5698592">v</span>&nbsp;<span class="op" id="5698594">:=</span>&nbsp;<span class="keyword" id="5698597">range</span>&nbsp;<span class="ident" id="5698603"><a href="/gostd/net/http/cgi/host.go.html#5697567">req</a></span><span class="op" id="5698606">.</span><span class="ident" id="5698607"><a href="/gostd/net/http/request.go.html#4137563">Header</a></span>&nbsp;<span class="op" id="5698614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5698618"><a href="/gostd/net/http/cgi/host.go.html#5698589">k</a></span>&nbsp;<span class="op" id="5698620">=</span>&nbsp;<span class="ident" id="5698622"><a href="/gostd/net/http/cgi/host.go.html#5695316">strings</a></span><span class="op" id="5698629">.</span><span class="ident" id="5698630"><a href="/gostd/strings/strings.go.html#2975847">Map</a></span><span class="op" id="5698633">(</span><span class="ident" id="5698634"><a href="/gostd/net/http/cgi/host.go.html#5703925">upperCaseAndUnderscore</a></span><span class="op" id="5698656">,</span>&nbsp;<span class="ident" id="5698658"><a href="/gostd/net/http/cgi/host.go.html#5698589">k</a></span><span class="op" id="5698659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5698663">joinStr</span>&nbsp;<span class="op" id="5698671">:=</span>&nbsp;<span class="string" id="5698674">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5698681">if</span>&nbsp;<span class="ident" id="5698684"><a href="/gostd/net/http/cgi/host.go.html#5698589">k</a></span>&nbsp;<span class="op" id="5698686">==</span>&nbsp;<span class="string" id="5698689">&#34;COOKIE&#34;</span>&nbsp;<span class="op" id="5698698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5698703"><a href="/gostd/net/http/cgi/host.go.html#5698663">joinStr</a></span>&nbsp;<span class="op" id="5698711">=</span>&nbsp;<span class="string" id="5698713">&#34;;&nbsp;&#34;</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5698720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5698724"><a href="/gostd/net/http/cgi/host.go.html#5698074">env</a></span>&nbsp;<span class="op" id="5698728">=</span>&nbsp;<span class="builtinfunc" id="5698730">append</span><span class="op" id="5698736">(</span><span class="ident" id="5698737"><a href="/gostd/net/http/cgi/host.go.html#5698074">env</a></span><span class="op" id="5698740">,</span>&nbsp;<span class="string" id="5698742">&#34;HTTP_&#34;</span><span class="op" id="5698749">+</span><span class="ident" id="5698750"><a href="/gostd/net/http/cgi/host.go.html#5698589">k</a></span><span class="op" id="5698751">+</span><span class="string" id="5698752">&#34;=&#34;</span><span class="op" id="5698755">+</span><span class="ident" id="5698756"><a href="/gostd/net/http/cgi/host.go.html#5695316">strings</a></span><span class="op" id="5698763">.</span><span class="ident" id="5698764"><a href="/gostd/strings/strings.go.html#2974969">Join</a></span><span class="op" id="5698768">(</span><span class="ident" id="5698769"><a href="/gostd/net/http/cgi/host.go.html#5698592">v</a></span><span class="op" id="5698770">,</span>&nbsp;<span class="ident" id="5698772"><a href="/gostd/net/http/cgi/host.go.html#5698663">joinStr</a></span><span class="op" id="5698779">)</span><span class="op" id="5698780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5698783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5698787">if</span>&nbsp;<span class="ident" id="5698790"><a href="/gostd/net/http/cgi/host.go.html#5697567">req</a></span><span class="op" id="5698793">.</span><span class="ident" id="5698794"><a href="/gostd/net/http/request.go.html#4138292">ContentLength</a></span>&nbsp;<span class="op" id="5698808">&gt;</span>&nbsp;<span class="num" id="5698810">0</span>&nbsp;<span class="op" id="5698812">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5698816"><a href="/gostd/net/http/cgi/host.go.html#5698074">env</a></span>&nbsp;<span class="op" id="5698820">=</span>&nbsp;<span class="builtinfunc" id="5698822">append</span><span class="op" id="5698828">(</span><span class="ident" id="5698829"><a href="/gostd/net/http/cgi/host.go.html#5698074">env</a></span><span class="op" id="5698832">,</span>&nbsp;<span class="ident" id="5698834"><a href="/gostd/net/http/cgi/host.go.html#5695218">fmt</a></span><span class="op" id="5698837">.</span><span class="ident" id="5698838"><a href="/gostd/fmt/print.go.html#2143637">Sprintf</a></span><span class="op" id="5698845">(</span><span class="string" id="5698846">&#34;CONTENT_LENGTH=%d&#34;</span><span class="op" id="5698865">,</span>&nbsp;<span class="ident" id="5698867"><a href="/gostd/net/http/cgi/host.go.html#5697567">req</a></span><span class="op" id="5698870">.</span><span class="ident" id="5698871"><a href="/gostd/net/http/request.go.html#4138292">ContentLength</a></span><span class="op" id="5698884">)</span><span class="op" id="5698885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5698888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5698891">if</span>&nbsp;<span class="ident" id="5698894">ctype</span>&nbsp;<span class="op" id="5698900">:=</span>&nbsp;<span class="ident" id="5698903"><a href="/gostd/net/http/cgi/host.go.html#5697567">req</a></span><span class="op" id="5698906">.</span><span class="ident" id="5698907"><a href="/gostd/net/http/request.go.html#4137563">Header</a></span><span class="op" id="5698913">.</span><span class="ident" id="5698914"><a href="/gostd/net/http/header.go.html#4126793">Get</a></span><span class="op" id="5698917">(</span><span class="string" id="5698918">&#34;Content-Type&#34;</span><span class="op" id="5698932">)</span><span class="op" id="5698933">;</span>&nbsp;<span class="ident" id="5698935"><a href="/gostd/net/http/cgi/host.go.html#5698894">ctype</a></span>&nbsp;<span class="op" id="5698941">!=</span>&nbsp;<span class="string" id="5698944">&#34;&#34;</span>&nbsp;<span class="op" id="5698947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5698951"><a href="/gostd/net/http/cgi/host.go.html#5698074">env</a></span>&nbsp;<span class="op" id="5698955">=</span>&nbsp;<span class="builtinfunc" id="5698957">append</span><span class="op" id="5698963">(</span><span class="ident" id="5698964"><a href="/gostd/net/http/cgi/host.go.html#5698074">env</a></span><span class="op" id="5698967">,</span>&nbsp;<span class="string" id="5698969">&#34;CONTENT_TYPE=&#34;</span><span class="op" id="5698984">+</span><span class="ident" id="5698985"><a href="/gostd/net/http/cgi/host.go.html#5698894">ctype</a></span><span class="op" id="5698990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5698993">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5698997">if</span>&nbsp;<span class="ident" id="5699000"><a href="/gostd/net/http/cgi/host.go.html#5697521">h</a></span><span class="op" id="5699001">.</span><span class="ident" id="5699002"><a href="/gostd/net/http/cgi/host.go.html#5696229">Env</a></span>&nbsp;<span class="op" id="5699006">!=</span>&nbsp;<span class="builtintype" id="5699009">nil</span>&nbsp;<span class="op" id="5699013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5699017"><a href="/gostd/net/http/cgi/host.go.html#5698074">env</a></span>&nbsp;<span class="op" id="5699021">=</span>&nbsp;<span class="builtinfunc" id="5699023">append</span><span class="op" id="5699029">(</span><span class="ident" id="5699030"><a href="/gostd/net/http/cgi/host.go.html#5698074">env</a></span><span class="op" id="5699033">,</span>&nbsp;<span class="ident" id="5699035"><a href="/gostd/net/http/cgi/host.go.html#5697521">h</a></span><span class="op" id="5699036">.</span><span class="ident" id="5699037"><a href="/gostd/net/http/cgi/host.go.html#5696229">Env</a></span><span class="op" id="5699040">...</span><span class="op" id="5699043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5699046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5699050">envPath</span>&nbsp;<span class="op" id="5699058">:=</span>&nbsp;<span class="ident" id="5699061"><a href="/gostd/net/http/cgi/host.go.html#5695250">os</a></span><span class="op" id="5699063">.</span><span class="ident" id="5699064"><a href="/gostd/os/env.go.html#2429715">Getenv</a></span><span class="op" id="5699070">(</span><span class="string" id="5699071">&#34;PATH&#34;</span><span class="op" id="5699077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5699080">if</span>&nbsp;<span class="ident" id="5699083"><a href="/gostd/net/http/cgi/host.go.html#5699050">envPath</a></span>&nbsp;<span class="op" id="5699091">==</span>&nbsp;<span class="string" id="5699094">&#34;&#34;</span>&nbsp;<span class="op" id="5699097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5699101"><a href="/gostd/net/http/cgi/host.go.html#5699050">envPath</a></span>&nbsp;<span class="op" id="5699109">=</span>&nbsp;<span class="string" id="5699111">&#34;/bin:/usr/bin:/usr/ucb:/usr/bsd:/usr/local/bin&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5699161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5699164"><a href="/gostd/net/http/cgi/host.go.html#5698074">env</a></span>&nbsp;<span class="op" id="5699168">=</span>&nbsp;<span class="builtinfunc" id="5699170">append</span><span class="op" id="5699176">(</span><span class="ident" id="5699177"><a href="/gostd/net/http/cgi/host.go.html#5698074">env</a></span><span class="op" id="5699180">,</span>&nbsp;<span class="string" id="5699182">&#34;PATH=&#34;</span><span class="op" id="5699189">+</span><span class="ident" id="5699190"><a href="/gostd/net/http/cgi/host.go.html#5699050">envPath</a></span><span class="op" id="5699197">)</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5699201">for</span>&nbsp;<span class="ident" id="5699205">_</span><span class="op" id="5699206">,</span>&nbsp;<span class="ident" id="5699208">e</span>&nbsp;<span class="op" id="5699210">:=</span>&nbsp;<span class="keyword" id="5699213">range</span>&nbsp;<span class="ident" id="5699219"><a href="/gostd/net/http/cgi/host.go.html#5697521">h</a></span><span class="op" id="5699220">.</span><span class="ident" id="5699221"><a href="/gostd/net/http/cgi/host.go.html#5696315">InheritEnv</a></span>&nbsp;<span class="op" id="5699232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5699236">if</span>&nbsp;<span class="ident" id="5699239">v</span>&nbsp;<span class="op" id="5699241">:=</span>&nbsp;<span class="ident" id="5699244"><a href="/gostd/net/http/cgi/host.go.html#5695250">os</a></span><span class="op" id="5699246">.</span><span class="ident" id="5699247"><a href="/gostd/os/env.go.html#2429715">Getenv</a></span><span class="op" id="5699253">(</span><span class="ident" id="5699254"><a href="/gostd/net/http/cgi/host.go.html#5699208">e</a></span><span class="op" id="5699255">)</span><span class="op" id="5699256">;</span>&nbsp;<span class="ident" id="5699258"><a href="/gostd/net/http/cgi/host.go.html#5699239">v</a></span>&nbsp;<span class="op" id="5699260">!=</span>&nbsp;<span class="string" id="5699263">&#34;&#34;</span>&nbsp;<span class="op" id="5699266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5699271"><a href="/gostd/net/http/cgi/host.go.html#5698074">env</a></span>&nbsp;<span class="op" id="5699275">=</span>&nbsp;<span class="builtinfunc" id="5699277">append</span><span class="op" id="5699283">(</span><span class="ident" id="5699284"><a href="/gostd/net/http/cgi/host.go.html#5698074">env</a></span><span class="op" id="5699287">,</span>&nbsp;<span class="ident" id="5699289"><a href="/gostd/net/http/cgi/host.go.html#5699208">e</a></span><span class="op" id="5699290">+</span><span class="string" id="5699291">&#34;=&#34;</span><span class="op" id="5699294">+</span><span class="ident" id="5699295"><a href="/gostd/net/http/cgi/host.go.html#5699239">v</a></span><span class="op" id="5699296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5699300">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5699303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5699307">for</span>&nbsp;<span class="ident" id="5699311">_</span><span class="op" id="5699312">,</span>&nbsp;<span class="ident" id="5699314">e</span>&nbsp;<span class="op" id="5699316">:=</span>&nbsp;<span class="keyword" id="5699319">range</span>&nbsp;<span class="ident" id="5699325"><a href="/gostd/net/http/cgi/host.go.html#5695386">osDefaultInheritEnv</a></span><span class="op" id="5699344">[</span><span class="ident" id="5699345"><a href="/gostd/net/http/cgi/host.go.html#5695294">runtime</a></span><span class="op" id="5699352">.</span><span class="ident" id="5699353"><a href="/gostd/runtime/extern.go.html#1533673">GOOS</a></span><span class="op" id="5699357">]</span>&nbsp;<span class="op" id="5699359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5699363">if</span>&nbsp;<span class="ident" id="5699366">v</span>&nbsp;<span class="op" id="5699368">:=</span>&nbsp;<span class="ident" id="5699371"><a href="/gostd/net/http/cgi/host.go.html#5695250">os</a></span><span class="op" id="5699373">.</span><span class="ident" id="5699374"><a href="/gostd/os/env.go.html#2429715">Getenv</a></span><span class="op" id="5699380">(</span><span class="ident" id="5699381"><a href="/gostd/net/http/cgi/host.go.html#5699314">e</a></span><span class="op" id="5699382">)</span><span class="op" id="5699383">;</span>&nbsp;<span class="ident" id="5699385"><a href="/gostd/net/http/cgi/host.go.html#5699366">v</a></span>&nbsp;<span class="op" id="5699387">!=</span>&nbsp;<span class="string" id="5699390">&#34;&#34;</span>&nbsp;<span class="op" id="5699393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5699398"><a href="/gostd/net/http/cgi/host.go.html#5698074">env</a></span>&nbsp;<span class="op" id="5699402">=</span>&nbsp;<span class="builtinfunc" id="5699404">append</span><span class="op" id="5699410">(</span><span class="ident" id="5699411"><a href="/gostd/net/http/cgi/host.go.html#5698074">env</a></span><span class="op" id="5699414">,</span>&nbsp;<span class="ident" id="5699416"><a href="/gostd/net/http/cgi/host.go.html#5699314">e</a></span><span class="op" id="5699417">+</span><span class="string" id="5699418">&#34;=&#34;</span><span class="op" id="5699421">+</span><span class="ident" id="5699422"><a href="/gostd/net/http/cgi/host.go.html#5699366">v</a></span><span class="op" id="5699423">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5699427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5699430">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5699434"><a href="/gostd/net/http/cgi/host.go.html#5698074">env</a></span>&nbsp;<span class="op" id="5699438">=</span>&nbsp;<span class="ident" id="5699440"><a href="/gostd/net/http/cgi/host.go.html#5697182">removeLeadingDuplicates</a></span><span class="op" id="5699463">(</span><span class="ident" id="5699464"><a href="/gostd/net/http/cgi/host.go.html#5698074">env</a></span><span class="op" id="5699467">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5699471">var</span>&nbsp;<span class="ident" id="5699475">cwd</span><span class="op" id="5699478">,</span>&nbsp;<span class="ident" id="5699480">path</span>&nbsp;<span class="builtintype" id="5699485">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5699493">if</span>&nbsp;<span class="ident" id="5699496"><a href="/gostd/net/http/cgi/host.go.html#5697521">h</a></span><span class="op" id="5699497">.</span><span class="ident" id="5699498"><a href="/gostd/net/http/cgi/host.go.html#5696216">Dir</a></span>&nbsp;<span class="op" id="5699502">!=</span>&nbsp;<span class="string" id="5699505">&#34;&#34;</span>&nbsp;<span class="op" id="5699508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5699512"><a href="/gostd/net/http/cgi/host.go.html#5699480">path</a></span>&nbsp;<span class="op" id="5699517">=</span>&nbsp;<span class="ident" id="5699519"><a href="/gostd/net/http/cgi/host.go.html#5697521">h</a></span><span class="op" id="5699520">.</span><span class="ident" id="5699521"><a href="/gostd/net/http/cgi/host.go.html#5695919">Path</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5699528"><a href="/gostd/net/http/cgi/host.go.html#5699475">cwd</a></span>&nbsp;<span class="op" id="5699532">=</span>&nbsp;<span class="ident" id="5699534"><a href="/gostd/net/http/cgi/host.go.html#5697521">h</a></span><span class="op" id="5699535">.</span><span class="ident" id="5699536"><a href="/gostd/net/http/cgi/host.go.html#5696216">Dir</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5699541">}</span>&nbsp;<span class="keyword" id="5699543">else</span>&nbsp;<span class="op" id="5699548">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5699552"><a href="/gostd/net/http/cgi/host.go.html#5699475">cwd</a></span><span class="op" id="5699555">,</span>&nbsp;<span class="ident" id="5699557"><a href="/gostd/net/http/cgi/host.go.html#5699480">path</a></span>&nbsp;<span class="op" id="5699562">=</span>&nbsp;<span class="ident" id="5699564"><a href="/gostd/net/http/cgi/host.go.html#5695267">filepath</a></span><span class="op" id="5699572">.</span><span class="ident" id="5699573"><a href="/gostd/path/filepath/path.go.html#3783242">Split</a></span><span class="op" id="5699578">(</span><span class="ident" id="5699579"><a href="/gostd/net/http/cgi/host.go.html#5697521">h</a></span><span class="op" id="5699580">.</span><span class="ident" id="5699581"><a href="/gostd/net/http/cgi/host.go.html#5695919">Path</a></span><span class="op" id="5699585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5699588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5699591">if</span>&nbsp;<span class="ident" id="5699594"><a href="/gostd/net/http/cgi/host.go.html#5699475">cwd</a></span>&nbsp;<span class="op" id="5699598">==</span>&nbsp;<span class="string" id="5699601">&#34;&#34;</span>&nbsp;<span class="op" id="5699604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5699608"><a href="/gostd/net/http/cgi/host.go.html#5699475">cwd</a></span>&nbsp;<span class="op" id="5699612">=</span>&nbsp;<span class="string" id="5699614">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5699619">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5699623">internalError</span>&nbsp;<span class="op" id="5699637">:=</span>&nbsp;<span class="keyword" id="5699640">func</span><span class="op" id="5699644">(</span><span class="ident" id="5699645">err</span>&nbsp;<span class="builtintype" id="5699649">error</span><span class="op" id="5699654">)</span>&nbsp;<span class="op" id="5699656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5699660"><a href="/gostd/net/http/cgi/host.go.html#5697543">rw</a></span><span class="op" id="5699662">.</span><span class="ident" id="5699663"><a href="/gostd/net/http/server.go.html#4171422">WriteHeader</a></span><span class="op" id="5699674">(</span><span class="ident" id="5699675"><a href="/gostd/net/http/cgi/host.go.html#5695238">http</a></span><span class="op" id="5699679">.</span><span class="ident" id="5699680"><a href="/gostd/net/http/status.go.html#4237466">StatusInternalServerError</a></span><span class="op" id="5699705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5699709"><a href="/gostd/net/http/cgi/host.go.html#5697521">h</a></span><span class="op" id="5699710">.</span><span class="ident" id="5699711"><a href="/gostd/net/http/cgi/host.go.html#5702710">printf</a></span><span class="op" id="5699717">(</span><span class="string" id="5699718">&#34;CGI&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="5699733">,</span>&nbsp;<span class="ident" id="5699735"><a href="/gostd/net/http/cgi/host.go.html#5699645">err</a></span><span class="op" id="5699738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5699741">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5699745">cmd</span>&nbsp;<span class="op" id="5699749">:=</span>&nbsp;<span class="op" id="5699752">&amp;</span><span class="ident" id="5699753"><a href="/gostd/net/http/cgi/host.go.html#5695256">exec</a></span><span class="op" id="5699757">.</span><span class="ident" id="5699758"><a href="/gostd/os/exec/exec.go.html#5578012">Cmd</a></span><span class="op" id="5699761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5699765"><a href="/gostd/os/exec/exec.go.html#5578201">Path</a></span><span class="op" id="5699769">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5699773"><a href="/gostd/net/http/cgi/host.go.html#5699480">path</a></span><span class="op" id="5699777">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5699781"><a href="/gostd/os/exec/exec.go.html#5578415">Args</a></span><span class="op" id="5699785">:</span>&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5699789">append</span><span class="op" id="5699795">(</span><span class="op" id="5699796">[</span><span class="op" id="5699797">]</span><span class="builtintype" id="5699798">string</span><span class="op" id="5699804">{</span><span class="ident" id="5699805"><a href="/gostd/net/http/cgi/host.go.html#5697521">h</a></span><span class="op" id="5699806">.</span><span class="ident" id="5699807"><a href="/gostd/net/http/cgi/host.go.html#5695919">Path</a></span><span class="op" id="5699811">}</span><span class="op" id="5699812">,</span>&nbsp;<span class="ident" id="5699814"><a href="/gostd/net/http/cgi/host.go.html#5697521">h</a></span><span class="op" id="5699815">.</span><span class="ident" id="5699816"><a href="/gostd/net/http/cgi/host.go.html#5696470">Args</a></span><span class="op" id="5699820">...</span><span class="op" id="5699823">)</span><span class="op" id="5699824">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5699828"><a href="/gostd/os/exec/exec.go.html#5578716">Dir</a></span><span class="op" id="5699831">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5699836"><a href="/gostd/net/http/cgi/host.go.html#5699475">cwd</a></span><span class="op" id="5699839">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5699843"><a href="/gostd/os/exec/exec.go.html#5578544">Env</a></span><span class="op" id="5699846">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5699851"><a href="/gostd/net/http/cgi/host.go.html#5698074">env</a></span><span class="op" id="5699854">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5699858"><a href="/gostd/os/exec/exec.go.html#5579618">Stderr</a></span><span class="op" id="5699864">:</span>&nbsp;<span class="ident" id="5699866"><a href="/gostd/net/http/cgi/host.go.html#5695250">os</a></span><span class="op" id="5699868">.</span><span class="ident" id="5699869"><a href="/gostd/os/file.go.html#2441872">Stderr</a></span><span class="op" id="5699875">,</span>&nbsp;<span class="comment" id="5699877">//&nbsp;for&nbsp;now</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5699889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5699892">if</span>&nbsp;<span class="ident" id="5699895"><a href="/gostd/net/http/cgi/host.go.html#5697567">req</a></span><span class="op" id="5699898">.</span><span class="ident" id="5699899"><a href="/gostd/net/http/request.go.html#4138292">ContentLength</a></span>&nbsp;<span class="op" id="5699913">!=</span>&nbsp;<span class="num" id="5699916">0</span>&nbsp;<span class="op" id="5699918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5699922"><a href="/gostd/net/http/cgi/host.go.html#5699745">cmd</a></span><span class="op" id="5699925">.</span><span class="ident" id="5699926"><a href="/gostd/os/exec/exec.go.html#5579298">Stdin</a></span>&nbsp;<span class="op" id="5699932">=</span>&nbsp;<span class="ident" id="5699934"><a href="/gostd/net/http/cgi/host.go.html#5697567">req</a></span><span class="op" id="5699937">.</span><span class="ident" id="5699938"><a href="/gostd/net/http/request.go.html#4137997">Body</a></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5699944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5699947">stdoutRead</span><span class="op" id="5699957">,</span>&nbsp;<span class="ident" id="5699959">err</span>&nbsp;<span class="op" id="5699963">:=</span>&nbsp;<span class="ident" id="5699966"><a href="/gostd/net/http/cgi/host.go.html#5699745">cmd</a></span><span class="op" id="5699969">.</span><span class="ident" id="5699970"><a href="/gostd/os/exec/exec.go.html#5589311">StdoutPipe</a></span><span class="op" id="5699980">(</span><span class="op" id="5699981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5699984">if</span>&nbsp;<span class="ident" id="5699987"><a href="/gostd/net/http/cgi/host.go.html#5699959">err</a></span>&nbsp;<span class="op" id="5699991">!=</span>&nbsp;<span class="builtintype" id="5699994">nil</span>&nbsp;<span class="op" id="5699998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700002"><a href="/gostd/net/http/cgi/host.go.html#5699623">internalError</a></span><span class="op" id="5700015">(</span><span class="ident" id="5700016"><a href="/gostd/net/http/cgi/host.go.html#5699959">err</a></span><span class="op" id="5700019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5700023">return</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5700031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700035"><a href="/gostd/net/http/cgi/host.go.html#5699959">err</a></span>&nbsp;<span class="op" id="5700039">=</span>&nbsp;<span class="ident" id="5700041"><a href="/gostd/net/http/cgi/host.go.html#5699745">cmd</a></span><span class="op" id="5700044">.</span><span class="ident" id="5700045"><a href="/gostd/os/exec/exec.go.html#5584773">Start</a></span><span class="op" id="5700050">(</span><span class="op" id="5700051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5700054">if</span>&nbsp;<span class="ident" id="5700057"><a href="/gostd/net/http/cgi/host.go.html#5699959">err</a></span>&nbsp;<span class="op" id="5700061">!=</span>&nbsp;<span class="builtintype" id="5700064">nil</span>&nbsp;<span class="op" id="5700068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700072"><a href="/gostd/net/http/cgi/host.go.html#5699623">internalError</a></span><span class="op" id="5700085">(</span><span class="ident" id="5700086"><a href="/gostd/net/http/cgi/host.go.html#5699959">err</a></span><span class="op" id="5700089">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5700093">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5700101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5700104">if</span>&nbsp;<span class="ident" id="5700107">hook</span>&nbsp;<span class="op" id="5700112">:=</span>&nbsp;<span class="ident" id="5700115"><a href="/gostd/net/http/cgi/host.go.html#5704320">testHookStartProcess</a></span><span class="op" id="5700135">;</span>&nbsp;<span class="ident" id="5700137"><a href="/gostd/net/http/cgi/host.go.html#5700107">hook</a></span>&nbsp;<span class="op" id="5700142">!=</span>&nbsp;<span class="builtintype" id="5700145">nil</span>&nbsp;<span class="op" id="5700149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700153"><a href="/gostd/net/http/cgi/host.go.html#5700107">hook</a></span><span class="op" id="5700157">(</span><span class="ident" id="5700158"><a href="/gostd/net/http/cgi/host.go.html#5699745">cmd</a></span><span class="op" id="5700161">.</span><span class="ident" id="5700162"><a href="/gostd/os/exec/exec.go.html#5580212">Process</a></span><span class="op" id="5700169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5700172">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5700175">defer</span>&nbsp;<span class="ident" id="5700181"><a href="/gostd/net/http/cgi/host.go.html#5699745">cmd</a></span><span class="op" id="5700184">.</span><span class="ident" id="5700185"><a href="/gostd/os/exec/exec.go.html#5586661">Wait</a></span><span class="op" id="5700189">(</span><span class="op" id="5700190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5700193">defer</span>&nbsp;<span class="ident" id="5700199"><a href="/gostd/net/http/cgi/host.go.html#5699947">stdoutRead</a></span><span class="op" id="5700209">.</span><span class="ident" id="5700210"><a href="/gostd/io/io.go.html#1422583">Close</a></span><span class="op" id="5700215">(</span><span class="op" id="5700216">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700220">linebody</span>&nbsp;<span class="op" id="5700229">:=</span>&nbsp;<span class="ident" id="5700232"><a href="/gostd/net/http/cgi/host.go.html#5695209">bufio</a></span><span class="op" id="5700237">.</span><span class="ident" id="5700238"><a href="/gostd/bufio/bufio.go.html#1355449">NewReaderSize</a></span><span class="op" id="5700251">(</span><span class="ident" id="5700252"><a href="/gostd/net/http/cgi/host.go.html#5699947">stdoutRead</a></span><span class="op" id="5700262">,</span>&nbsp;<span class="num" id="5700264">1024</span><span class="op" id="5700268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700271">headers</span>&nbsp;<span class="op" id="5700279">:=</span>&nbsp;<span class="builtinfunc" id="5700282">make</span><span class="op" id="5700286">(</span><span class="ident" id="5700287"><a href="/gostd/net/http/cgi/host.go.html#5695238">http</a></span><span class="op" id="5700291">.</span><span class="ident" id="5700292"><a href="/gostd/net/http/header.go.html#4126117">Header</a></span><span class="op" id="5700298">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700301">statusCode</span>&nbsp;<span class="op" id="5700312">:=</span>&nbsp;<span class="num" id="5700315">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700318">headerLines</span>&nbsp;<span class="op" id="5700330">:=</span>&nbsp;<span class="num" id="5700333">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700336">sawBlankLine</span>&nbsp;<span class="op" id="5700349">:=</span>&nbsp;<span class="builtintype" id="5700352">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5700359">for</span>&nbsp;<span class="op" id="5700363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700367">line</span><span class="op" id="5700371">,</span>&nbsp;<span class="ident" id="5700373">isPrefix</span><span class="op" id="5700381">,</span>&nbsp;<span class="ident" id="5700383">err</span>&nbsp;<span class="op" id="5700387">:=</span>&nbsp;<span class="ident" id="5700390"><a href="/gostd/net/http/cgi/host.go.html#5700220">linebody</a></span><span class="op" id="5700398">.</span><span class="ident" id="5700399"><a href="/gostd/bufio/bufio.go.html#1362739">ReadLine</a></span><span class="op" id="5700407">(</span><span class="op" id="5700408">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5700412">if</span>&nbsp;<span class="ident" id="5700415"><a href="/gostd/net/http/cgi/host.go.html#5700373">isPrefix</a></span>&nbsp;<span class="op" id="5700424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700429"><a href="/gostd/net/http/cgi/host.go.html#5697543">rw</a></span><span class="op" id="5700431">.</span><span class="ident" id="5700432"><a href="/gostd/net/http/server.go.html#4171422">WriteHeader</a></span><span class="op" id="5700443">(</span><span class="ident" id="5700444"><a href="/gostd/net/http/cgi/host.go.html#5695238">http</a></span><span class="op" id="5700448">.</span><span class="ident" id="5700449"><a href="/gostd/net/http/status.go.html#4237466">StatusInternalServerError</a></span><span class="op" id="5700474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700479"><a href="/gostd/net/http/cgi/host.go.html#5697521">h</a></span><span class="op" id="5700480">.</span><span class="ident" id="5700481"><a href="/gostd/net/http/cgi/host.go.html#5702710">printf</a></span><span class="op" id="5700487">(</span><span class="string" id="5700488">&#34;cgi:&nbsp;long&nbsp;header&nbsp;line&nbsp;from&nbsp;subprocess.&#34;</span><span class="op" id="5700528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5700533">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5700542">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5700546">if</span>&nbsp;<span class="ident" id="5700549"><a href="/gostd/net/http/cgi/host.go.html#5700383">err</a></span>&nbsp;<span class="op" id="5700553">==</span>&nbsp;<span class="ident" id="5700556"><a href="/gostd/net/http/cgi/host.go.html#5695225">io</a></span><span class="op" id="5700558">.</span><span class="ident" id="5700559"><a href="/gostd/io/io.go.html#1419950">EOF</a></span>&nbsp;<span class="op" id="5700563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5700568">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5700576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5700580">if</span>&nbsp;<span class="ident" id="5700583"><a href="/gostd/net/http/cgi/host.go.html#5700383">err</a></span>&nbsp;<span class="op" id="5700587">!=</span>&nbsp;<span class="builtintype" id="5700590">nil</span>&nbsp;<span class="op" id="5700594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700599"><a href="/gostd/net/http/cgi/host.go.html#5697543">rw</a></span><span class="op" id="5700601">.</span><span class="ident" id="5700602"><a href="/gostd/net/http/server.go.html#4171422">WriteHeader</a></span><span class="op" id="5700613">(</span><span class="ident" id="5700614"><a href="/gostd/net/http/cgi/host.go.html#5695238">http</a></span><span class="op" id="5700618">.</span><span class="ident" id="5700619"><a href="/gostd/net/http/status.go.html#4237466">StatusInternalServerError</a></span><span class="op" id="5700644">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700649"><a href="/gostd/net/http/cgi/host.go.html#5697521">h</a></span><span class="op" id="5700650">.</span><span class="ident" id="5700651"><a href="/gostd/net/http/cgi/host.go.html#5702710">printf</a></span><span class="op" id="5700657">(</span><span class="string" id="5700658">&#34;cgi:&nbsp;error&nbsp;reading&nbsp;headers:&nbsp;%v&#34;</span><span class="op" id="5700690">,</span>&nbsp;<span class="ident" id="5700692"><a href="/gostd/net/http/cgi/host.go.html#5700383">err</a></span><span class="op" id="5700695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5700700">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5700709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5700713">if</span>&nbsp;<span class="builtinfunc" id="5700716">len</span><span class="op" id="5700719">(</span><span class="ident" id="5700720"><a href="/gostd/net/http/cgi/host.go.html#5700367">line</a></span><span class="op" id="5700724">)</span>&nbsp;<span class="op" id="5700726">==</span>&nbsp;<span class="num" id="5700729">0</span>&nbsp;<span class="op" id="5700731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700736"><a href="/gostd/net/http/cgi/host.go.html#5700336">sawBlankLine</a></span>&nbsp;<span class="op" id="5700749">=</span>&nbsp;<span class="builtintype" id="5700751">true</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5700759">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5700767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700771"><a href="/gostd/net/http/cgi/host.go.html#5700318">headerLines</a></span><span class="op" id="5700782">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700787">parts</span>&nbsp;<span class="op" id="5700793">:=</span>&nbsp;<span class="ident" id="5700796"><a href="/gostd/net/http/cgi/host.go.html#5695316">strings</a></span><span class="op" id="5700803">.</span><span class="ident" id="5700804"><a href="/gostd/strings/strings.go.html#2972338">SplitN</a></span><span class="op" id="5700810">(</span><span class="builtintype" id="5700811">string</span><span class="op" id="5700817">(</span><span class="ident" id="5700818"><a href="/gostd/net/http/cgi/host.go.html#5700367">line</a></span><span class="op" id="5700822">)</span><span class="op" id="5700823">,</span>&nbsp;<span class="string" id="5700825">&#34;:&#34;</span><span class="op" id="5700828">,</span>&nbsp;<span class="num" id="5700830">2</span><span class="op" id="5700831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5700835">if</span>&nbsp;<span class="builtinfunc" id="5700838">len</span><span class="op" id="5700841">(</span><span class="ident" id="5700842"><a href="/gostd/net/http/cgi/host.go.html#5700787">parts</a></span><span class="op" id="5700847">)</span>&nbsp;<span class="op" id="5700849">&lt;</span>&nbsp;<span class="num" id="5700851">2</span>&nbsp;<span class="op" id="5700853">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700858"><a href="/gostd/net/http/cgi/host.go.html#5697521">h</a></span><span class="op" id="5700859">.</span><span class="ident" id="5700860"><a href="/gostd/net/http/cgi/host.go.html#5702710">printf</a></span><span class="op" id="5700866">(</span><span class="string" id="5700867">&#34;cgi:&nbsp;bogus&nbsp;header&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="5700895">,</span>&nbsp;<span class="builtintype" id="5700897">string</span><span class="op" id="5700903">(</span><span class="ident" id="5700904"><a href="/gostd/net/http/cgi/host.go.html#5700367">line</a></span><span class="op" id="5700908">)</span><span class="op" id="5700909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5700914">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5700925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700929">header</span><span class="op" id="5700935">,</span>&nbsp;<span class="ident" id="5700937">val</span>&nbsp;<span class="op" id="5700941">:=</span>&nbsp;<span class="ident" id="5700944"><a href="/gostd/net/http/cgi/host.go.html#5700787">parts</a></span><span class="op" id="5700949">[</span><span class="num" id="5700950">0</span><span class="op" id="5700951">]</span><span class="op" id="5700952">,</span>&nbsp;<span class="ident" id="5700954"><a href="/gostd/net/http/cgi/host.go.html#5700787">parts</a></span><span class="op" id="5700959">[</span><span class="num" id="5700960">1</span><span class="op" id="5700961">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5700965"><a href="/gostd/net/http/cgi/host.go.html#5700929">header</a></span>&nbsp;<span class="op" id="5700972">=</span>&nbsp;<span class="ident" id="5700974"><a href="/gostd/net/http/cgi/host.go.html#5695316">strings</a></span><span class="op" id="5700981">.</span><span class="ident" id="5700982"><a href="/gostd/strings/strings.go.html#2982525">TrimSpace</a></span><span class="op" id="5700991">(</span><span class="ident" id="5700992"><a href="/gostd/net/http/cgi/host.go.html#5700929">header</a></span><span class="op" id="5700998">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5701002"><a href="/gostd/net/http/cgi/host.go.html#5700937">val</a></span>&nbsp;<span class="op" id="5701006">=</span>&nbsp;<span class="ident" id="5701008"><a href="/gostd/net/http/cgi/host.go.html#5695316">strings</a></span><span class="op" id="5701015">.</span><span class="ident" id="5701016"><a href="/gostd/strings/strings.go.html#2982525">TrimSpace</a></span><span class="op" id="5701025">(</span><span class="ident" id="5701026"><a href="/gostd/net/http/cgi/host.go.html#5700937">val</a></span><span class="op" id="5701029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5701033">switch</span>&nbsp;<span class="op" id="5701040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5701044">case</span>&nbsp;<span class="ident" id="5701049"><a href="/gostd/net/http/cgi/host.go.html#5700929">header</a></span>&nbsp;<span class="op" id="5701056">==</span>&nbsp;<span class="string" id="5701059">&#34;Status&#34;</span><span class="op" id="5701067">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5701072">if</span>&nbsp;<span class="builtinfunc" id="5701075">len</span><span class="op" id="5701078">(</span><span class="ident" id="5701079"><a href="/gostd/net/http/cgi/host.go.html#5700937">val</a></span><span class="op" id="5701082">)</span>&nbsp;<span class="op" id="5701084">&lt;</span>&nbsp;<span class="num" id="5701086">3</span>&nbsp;<span class="op" id="5701088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5701094"><a href="/gostd/net/http/cgi/host.go.html#5697521">h</a></span><span class="op" id="5701095">.</span><span class="ident" id="5701096"><a href="/gostd/net/http/cgi/host.go.html#5702710">printf</a></span><span class="op" id="5701102">(</span><span class="string" id="5701103">&#34;cgi:&nbsp;bogus&nbsp;status&nbsp;(short):&nbsp;%q&#34;</span><span class="op" id="5701134">,</span>&nbsp;<span class="ident" id="5701136"><a href="/gostd/net/http/cgi/host.go.html#5700937">val</a></span><span class="op" id="5701139">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5701145">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5701155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5701160">code</span><span class="op" id="5701164">,</span>&nbsp;<span class="ident" id="5701166">err</span>&nbsp;<span class="op" id="5701170">:=</span>&nbsp;<span class="ident" id="5701173"><a href="/gostd/net/http/cgi/host.go.html#5695305">strconv</a></span><span class="op" id="5701180">.</span><span class="ident" id="5701181"><a href="/gostd/strconv/atoi.go.html#2357032">Atoi</a></span><span class="op" id="5701185">(</span><span class="ident" id="5701186"><a href="/gostd/net/http/cgi/host.go.html#5700937">val</a></span><span class="op" id="5701189">[</span><span class="num" id="5701190">0</span><span class="op" id="5701191">:</span><span class="num" id="5701192">3</span><span class="op" id="5701193">]</span><span class="op" id="5701194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5701199">if</span>&nbsp;<span class="ident" id="5701202"><a href="/gostd/net/http/cgi/host.go.html#5701166">err</a></span>&nbsp;<span class="op" id="5701206">!=</span>&nbsp;<span class="builtintype" id="5701209">nil</span>&nbsp;<span class="op" id="5701213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5701219"><a href="/gostd/net/http/cgi/host.go.html#5697521">h</a></span><span class="op" id="5701220">.</span><span class="ident" id="5701221"><a href="/gostd/net/http/cgi/host.go.html#5702710">printf</a></span><span class="op" id="5701227">(</span><span class="string" id="5701228">&#34;cgi:&nbsp;bogus&nbsp;status:&nbsp;%q&#34;</span><span class="op" id="5701251">,</span>&nbsp;<span class="ident" id="5701253"><a href="/gostd/net/http/cgi/host.go.html#5700937">val</a></span><span class="op" id="5701256">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5701262"><a href="/gostd/net/http/cgi/host.go.html#5697521">h</a></span><span class="op" id="5701263">.</span><span class="ident" id="5701264"><a href="/gostd/net/http/cgi/host.go.html#5702710">printf</a></span><span class="op" id="5701270">(</span><span class="string" id="5701271">&#34;cgi:&nbsp;line&nbsp;was&nbsp;%q&#34;</span><span class="op" id="5701289">,</span>&nbsp;<span class="ident" id="5701291"><a href="/gostd/net/http/cgi/host.go.html#5700367">line</a></span><span class="op" id="5701295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5701301">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5701311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5701316"><a href="/gostd/net/http/cgi/host.go.html#5700301">statusCode</a></span>&nbsp;<span class="op" id="5701327">=</span>&nbsp;<span class="ident" id="5701329"><a href="/gostd/net/http/cgi/host.go.html#5701160">code</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5701336">default</span><span class="op" id="5701343">:</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5701348"><a href="/gostd/net/http/cgi/host.go.html#5700271">headers</a></span><span class="op" id="5701355">.</span><span class="ident" id="5701356"><a href="/gostd/net/http/header.go.html#4126266">Add</a></span><span class="op" id="5701359">(</span><span class="ident" id="5701360"><a href="/gostd/net/http/cgi/host.go.html#5700929">header</a></span><span class="op" id="5701366">,</span>&nbsp;<span class="ident" id="5701368"><a href="/gostd/net/http/cgi/host.go.html#5700937">val</a></span><span class="op" id="5701371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5701375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5701378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5701381">if</span>&nbsp;<span class="ident" id="5701384"><a href="/gostd/net/http/cgi/host.go.html#5700318">headerLines</a></span>&nbsp;<span class="op" id="5701396">==</span>&nbsp;<span class="num" id="5701399">0</span>&nbsp;<span class="op" id="5701401">||</span>&nbsp;<span class="op" id="5701404">!</span><span class="ident" id="5701405"><a href="/gostd/net/http/cgi/host.go.html#5700336">sawBlankLine</a></span>&nbsp;<span class="op" id="5701418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5701422"><a href="/gostd/net/http/cgi/host.go.html#5697543">rw</a></span><span class="op" id="5701424">.</span><span class="ident" id="5701425"><a href="/gostd/net/http/server.go.html#4171422">WriteHeader</a></span><span class="op" id="5701436">(</span><span class="ident" id="5701437"><a href="/gostd/net/http/cgi/host.go.html#5695238">http</a></span><span class="op" id="5701441">.</span><span class="ident" id="5701442"><a href="/gostd/net/http/status.go.html#4237466">StatusInternalServerError</a></span><span class="op" id="5701467">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5701471"><a href="/gostd/net/http/cgi/host.go.html#5697521">h</a></span><span class="op" id="5701472">.</span><span class="ident" id="5701473"><a href="/gostd/net/http/cgi/host.go.html#5702710">printf</a></span><span class="op" id="5701479">(</span><span class="string" id="5701480">&#34;cgi:&nbsp;no&nbsp;headers&#34;</span><span class="op" id="5701497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5701501">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5701509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5701513">if</span>&nbsp;<span class="ident" id="5701516">loc</span>&nbsp;<span class="op" id="5701520">:=</span>&nbsp;<span class="ident" id="5701523"><a href="/gostd/net/http/cgi/host.go.html#5700271">headers</a></span><span class="op" id="5701530">.</span><span class="ident" id="5701531"><a href="/gostd/net/http/header.go.html#4126793">Get</a></span><span class="op" id="5701534">(</span><span class="string" id="5701535">&#34;Location&#34;</span><span class="op" id="5701545">)</span><span class="op" id="5701546">;</span>&nbsp;<span class="ident" id="5701548"><a href="/gostd/net/http/cgi/host.go.html#5701516">loc</a></span>&nbsp;<span class="op" id="5701552">!=</span>&nbsp;<span class="string" id="5701555">&#34;&#34;</span>&nbsp;<span class="op" id="5701558">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5701562">if</span>&nbsp;<span class="ident" id="5701565"><a href="/gostd/net/http/cgi/host.go.html#5695316">strings</a></span><span class="op" id="5701572">.</span><span class="ident" id="5701573"><a href="/gostd/strings/strings.go.html#2975366">HasPrefix</a></span><span class="op" id="5701582">(</span><span class="ident" id="5701583"><a href="/gostd/net/http/cgi/host.go.html#5701516">loc</a></span><span class="op" id="5701586">,</span>&nbsp;<span class="string" id="5701588">&#34;/&#34;</span><span class="op" id="5701591">)</span>&nbsp;<span class="op" id="5701593">&amp;&amp;</span>&nbsp;<span class="ident" id="5701596"><a href="/gostd/net/http/cgi/host.go.html#5697521">h</a></span><span class="op" id="5701597">.</span><span class="ident" id="5701598"><a href="/gostd/net/http/cgi/host.go.html#5696926">PathLocationHandler</a></span>&nbsp;<span class="op" id="5701618">!=</span>&nbsp;<span class="builtintype" id="5701621">nil</span>&nbsp;<span class="op" id="5701625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5701630"><a href="/gostd/net/http/cgi/host.go.html#5697521">h</a></span><span class="op" id="5701631">.</span><span class="ident" id="5701632"><a href="/gostd/net/http/cgi/host.go.html#5702867">handleInternalRedirect</a></span><span class="op" id="5701654">(</span><span class="ident" id="5701655"><a href="/gostd/net/http/cgi/host.go.html#5697543">rw</a></span><span class="op" id="5701657">,</span>&nbsp;<span class="ident" id="5701659"><a href="/gostd/net/http/cgi/host.go.html#5697567">req</a></span><span class="op" id="5701662">,</span>&nbsp;<span class="ident" id="5701664"><a href="/gostd/net/http/cgi/host.go.html#5701516">loc</a></span><span class="op" id="5701667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5701672">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5701681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5701685">if</span>&nbsp;<span class="ident" id="5701688"><a href="/gostd/net/http/cgi/host.go.html#5700301">statusCode</a></span>&nbsp;<span class="op" id="5701699">==</span>&nbsp;<span class="num" id="5701702">0</span>&nbsp;<span class="op" id="5701704">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5701709"><a href="/gostd/net/http/cgi/host.go.html#5700301">statusCode</a></span>&nbsp;<span class="op" id="5701720">=</span>&nbsp;<span class="ident" id="5701722"><a href="/gostd/net/http/cgi/host.go.html#5695238">http</a></span><span class="op" id="5701726">.</span><span class="ident" id="5701727"><a href="/gostd/net/http/status.go.html#4236511">StatusFound</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5701741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5701744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5701748">if</span>&nbsp;<span class="ident" id="5701751"><a href="/gostd/net/http/cgi/host.go.html#5700301">statusCode</a></span>&nbsp;<span class="op" id="5701762">==</span>&nbsp;<span class="num" id="5701765">0</span>&nbsp;<span class="op" id="5701767">&amp;&amp;</span>&nbsp;<span class="ident" id="5701770"><a href="/gostd/net/http/cgi/host.go.html#5700271">headers</a></span><span class="op" id="5701777">.</span><span class="ident" id="5701778"><a href="/gostd/net/http/header.go.html#4126793">Get</a></span><span class="op" id="5701781">(</span><span class="string" id="5701782">&#34;Content-Type&#34;</span><span class="op" id="5701796">)</span>&nbsp;<span class="op" id="5701798">==</span>&nbsp;<span class="string" id="5701801">&#34;&#34;</span>&nbsp;<span class="op" id="5701804">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5701808"><a href="/gostd/net/http/cgi/host.go.html#5697543">rw</a></span><span class="op" id="5701810">.</span><span class="ident" id="5701811"><a href="/gostd/net/http/server.go.html#4171422">WriteHeader</a></span><span class="op" id="5701822">(</span><span class="ident" id="5701823"><a href="/gostd/net/http/cgi/host.go.html#5695238">http</a></span><span class="op" id="5701827">.</span><span class="ident" id="5701828"><a href="/gostd/net/http/status.go.html#4237466">StatusInternalServerError</a></span><span class="op" id="5701853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5701857"><a href="/gostd/net/http/cgi/host.go.html#5697521">h</a></span><span class="op" id="5701858">.</span><span class="ident" id="5701859"><a href="/gostd/net/http/cgi/host.go.html#5702710">printf</a></span><span class="op" id="5701865">(</span><span class="string" id="5701866">&#34;cgi:&nbsp;missing&nbsp;required&nbsp;Content-Type&nbsp;in&nbsp;headers&#34;</span><span class="op" id="5701913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5701917">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5701925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5701929">if</span>&nbsp;<span class="ident" id="5701932"><a href="/gostd/net/http/cgi/host.go.html#5700301">statusCode</a></span>&nbsp;<span class="op" id="5701943">==</span>&nbsp;<span class="num" id="5701946">0</span>&nbsp;<span class="op" id="5701948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5701952"><a href="/gostd/net/http/cgi/host.go.html#5700301">statusCode</a></span>&nbsp;<span class="op" id="5701963">=</span>&nbsp;<span class="ident" id="5701965"><a href="/gostd/net/http/cgi/host.go.html#5695238">http</a></span><span class="op" id="5701969">.</span><span class="ident" id="5701970"><a href="/gostd/net/http/status.go.html#4236210">StatusOK</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5701980">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5701984">//&nbsp;Copy&nbsp;headers&nbsp;to&nbsp;rw&#39;s&nbsp;headers,&nbsp;after&nbsp;we&#39;ve&nbsp;decided&nbsp;not&nbsp;to</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5702045">//&nbsp;go&nbsp;into&nbsp;handleInternalRedirect,&nbsp;which&nbsp;won&#39;t&nbsp;want&nbsp;its&nbsp;rw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5702105">//&nbsp;headers&nbsp;to&nbsp;have&nbsp;been&nbsp;touched.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5702139">for</span>&nbsp;<span class="ident" id="5702143">k</span><span class="op" id="5702144">,</span>&nbsp;<span class="ident" id="5702146">vv</span>&nbsp;<span class="op" id="5702149">:=</span>&nbsp;<span class="keyword" id="5702152">range</span>&nbsp;<span class="ident" id="5702158"><a href="/gostd/net/http/cgi/host.go.html#5700271">headers</a></span>&nbsp;<span class="op" id="5702166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5702170">for</span>&nbsp;<span class="ident" id="5702174">_</span><span class="op" id="5702175">,</span>&nbsp;<span class="ident" id="5702177">v</span>&nbsp;<span class="op" id="5702179">:=</span>&nbsp;<span class="keyword" id="5702182">range</span>&nbsp;<span class="ident" id="5702188"><a href="/gostd/net/http/cgi/host.go.html#5702146">vv</a></span>&nbsp;<span class="op" id="5702191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5702196"><a href="/gostd/net/http/cgi/host.go.html#5697543">rw</a></span><span class="op" id="5702198">.</span><span class="ident" id="5702199"><a href="/gostd/net/http/server.go.html#4170747">Header</a></span><span class="op" id="5702205">(</span><span class="op" id="5702206">)</span><span class="op" id="5702207">.</span><span class="ident" id="5702208"><a href="/gostd/net/http/header.go.html#4126266">Add</a></span><span class="op" id="5702211">(</span><span class="ident" id="5702212"><a href="/gostd/net/http/cgi/host.go.html#5702143">k</a></span><span class="op" id="5702213">,</span>&nbsp;<span class="ident" id="5702215"><a href="/gostd/net/http/cgi/host.go.html#5702177">v</a></span><span class="op" id="5702216">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5702220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5702223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5702227"><a href="/gostd/net/http/cgi/host.go.html#5697543">rw</a></span><span class="op" id="5702229">.</span><span class="ident" id="5702230"><a href="/gostd/net/http/server.go.html#4171422">WriteHeader</a></span><span class="op" id="5702241">(</span><span class="ident" id="5702242"><a href="/gostd/net/http/cgi/host.go.html#5700301">statusCode</a></span><span class="op" id="5702252">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5702256">_</span><span class="op" id="5702257">,</span>&nbsp;<span class="ident" id="5702259"><a href="/gostd/net/http/cgi/host.go.html#5699959">err</a></span>&nbsp;<span class="op" id="5702263">=</span>&nbsp;<span class="ident" id="5702265"><a href="/gostd/net/http/cgi/host.go.html#5695225">io</a></span><span class="op" id="5702267">.</span><span class="ident" id="5702268"><a href="/gostd/io/io.go.html#1430946">Copy</a></span><span class="op" id="5702272">(</span><span class="ident" id="5702273"><a href="/gostd/net/http/cgi/host.go.html#5697543">rw</a></span><span class="op" id="5702275">,</span>&nbsp;<span class="ident" id="5702277"><a href="/gostd/net/http/cgi/host.go.html#5700220">linebody</a></span><span class="op" id="5702285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5702288">if</span>&nbsp;<span class="ident" id="5702291"><a href="/gostd/net/http/cgi/host.go.html#5699959">err</a></span>&nbsp;<span class="op" id="5702295">!=</span>&nbsp;<span class="builtintype" id="5702298">nil</span>&nbsp;<span class="op" id="5702302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5702306"><a href="/gostd/net/http/cgi/host.go.html#5697521">h</a></span><span class="op" id="5702307">.</span><span class="ident" id="5702308"><a href="/gostd/net/http/cgi/host.go.html#5702710">printf</a></span><span class="op" id="5702314">(</span><span class="string" id="5702315">&#34;cgi:&nbsp;copy&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="5702336">,</span>&nbsp;<span class="ident" id="5702338"><a href="/gostd/net/http/cgi/host.go.html#5699959">err</a></span><span class="op" id="5702341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5702345">//&nbsp;And&nbsp;kill&nbsp;the&nbsp;child&nbsp;CGI&nbsp;process&nbsp;so&nbsp;we&nbsp;don&#39;t&nbsp;hang&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5702401">//&nbsp;the&nbsp;deferred&nbsp;cmd.Wait&nbsp;above&nbsp;if&nbsp;the&nbsp;error&nbsp;was&nbsp;just</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5702456">//&nbsp;the&nbsp;client&nbsp;(rw)&nbsp;going&nbsp;away.&nbsp;If&nbsp;it&nbsp;was&nbsp;a&nbsp;read&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5702512">//&nbsp;(because&nbsp;the&nbsp;child&nbsp;died&nbsp;itself),&nbsp;then&nbsp;the&nbsp;extra</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5702565">//&nbsp;kill&nbsp;of&nbsp;an&nbsp;already-dead&nbsp;process&nbsp;is&nbsp;harmless&nbsp;(the&nbsp;PID</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5702623">//&nbsp;won&#39;t&nbsp;be&nbsp;reused&nbsp;until&nbsp;the&nbsp;Wait&nbsp;above).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5702667"><a href="/gostd/net/http/cgi/host.go.html#5699745">cmd</a></span><span class="op" id="5702670">.</span><span class="ident" id="5702671"><a href="/gostd/os/exec/exec.go.html#5580212">Process</a></span><span class="op" id="5702678">.</span><span class="ident" id="5702679"><a href="/gostd/os/doc.go.html#2423746">Kill</a></span><span class="op" id="5702683">(</span><span class="op" id="5702684">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5702687">}</span><br>
<span class="lineno"></span><span class="op" id="5702689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5702692">func</span>&nbsp;<span class="op" id="5702697">(</span><span class="ident" id="5702698">h</span>&nbsp;<span class="op" id="5702700">*</span><span class="ident" id="5702701"><a href="/gostd/net/http/cgi/host.go.html#5695901">Handler</a></span><span class="op" id="5702708">)</span>&nbsp;<span class="ident" id="5702710">printf</span><span class="op" id="5702716">(</span><span class="ident" id="5702717">format</span>&nbsp;<span class="builtintype" id="5702724">string</span><span class="op" id="5702730">,</span>&nbsp;<span class="ident" id="5702732">v</span>&nbsp;<span class="op" id="5702734">...</span><span class="keyword" id="5702737">interface</span><span class="op" id="5702746">{</span><span class="op" id="5702747">}</span><span class="op" id="5702748">)</span>&nbsp;<span class="op" id="5702750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5702753">if</span>&nbsp;<span class="ident" id="5702756"><a href="/gostd/net/http/cgi/host.go.html#5702698">h</a></span><span class="op" id="5702757">.</span><span class="ident" id="5702758"><a href="/gostd/net/http/cgi/host.go.html#5696395">Logger</a></span>&nbsp;<span class="op" id="5702765">!=</span>&nbsp;<span class="builtintype" id="5702768">nil</span>&nbsp;<span class="op" id="5702772">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5702776"><a href="/gostd/net/http/cgi/host.go.html#5702698">h</a></span><span class="op" id="5702777">.</span><span class="ident" id="5702778"><a href="/gostd/net/http/cgi/host.go.html#5696395">Logger</a></span><span class="op" id="5702784">.</span><span class="ident" id="5702785"><a href="/gostd/log/log.go.html#4075692">Printf</a></span><span class="op" id="5702791">(</span><span class="ident" id="5702792"><a href="/gostd/net/http/cgi/host.go.html#5702717">format</a></span><span class="op" id="5702798">,</span>&nbsp;<span class="ident" id="5702800"><a href="/gostd/net/http/cgi/host.go.html#5702732">v</a></span><span class="op" id="5702801">...</span><span class="op" id="5702804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5702807">}</span>&nbsp;<span class="keyword" id="5702809">else</span>&nbsp;<span class="op" id="5702814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5702818"><a href="/gostd/net/http/cgi/host.go.html#5695231">log</a></span><span class="op" id="5702821">.</span><span class="ident" id="5702822"><a href="/gostd/log/log.go.html#4078664">Printf</a></span><span class="op" id="5702828">(</span><span class="ident" id="5702829"><a href="/gostd/net/http/cgi/host.go.html#5702717">format</a></span><span class="op" id="5702835">,</span>&nbsp;<span class="ident" id="5702837"><a href="/gostd/net/http/cgi/host.go.html#5702732">v</a></span><span class="op" id="5702838">...</span><span class="op" id="5702841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5702844">}</span><br>
<span class="lineno"></span><span class="op" id="5702846">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="keyword" id="5702849">func</span>&nbsp;<span class="op" id="5702854">(</span><span class="ident" id="5702855">h</span>&nbsp;<span class="op" id="5702857">*</span><span class="ident" id="5702858"><a href="/gostd/net/http/cgi/host.go.html#5695901">Handler</a></span><span class="op" id="5702865">)</span>&nbsp;<span class="ident" id="5702867">handleInternalRedirect</span><span class="op" id="5702889">(</span><span class="ident" id="5702890">rw</span>&nbsp;<span class="ident" id="5702893"><a href="/gostd/net/http/cgi/host.go.html#5695238">http</a></span><span class="op" id="5702897">.</span><span class="ident" id="5702898"><a href="/gostd/net/http/server.go.html#4170569">ResponseWriter</a></span><span class="op" id="5702912">,</span>&nbsp;<span class="ident" id="5702914">req</span>&nbsp;<span class="op" id="5702918">*</span><span class="ident" id="5702919"><a href="/gostd/net/http/cgi/host.go.html#5695238">http</a></span><span class="op" id="5702923">.</span><span class="ident" id="5702924"><a href="/gostd/net/http/request.go.html#4135954">Request</a></span><span class="op" id="5702931">,</span>&nbsp;<span class="ident" id="5702933">path</span>&nbsp;<span class="builtintype" id="5702938">string</span><span class="op" id="5702944">)</span>&nbsp;<span class="op" id="5702946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5702949">url</span><span class="op" id="5702952">,</span>&nbsp;<span class="ident" id="5702954">err</span>&nbsp;<span class="op" id="5702958">:=</span>&nbsp;<span class="ident" id="5702961"><a href="/gostd/net/http/cgi/host.go.html#5702914">req</a></span><span class="op" id="5702964">.</span><span class="ident" id="5702965"><a href="/gostd/net/http/request.go.html#4136640">URL</a></span><span class="op" id="5702968">.</span><span class="ident" id="5702969"><a href="/gostd/net/url/url.go.html#3762216">Parse</a></span><span class="op" id="5702974">(</span><span class="ident" id="5702975"><a href="/gostd/net/http/cgi/host.go.html#5702933">path</a></span><span class="op" id="5702979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5702982">if</span>&nbsp;<span class="ident" id="5702985"><a href="/gostd/net/http/cgi/host.go.html#5702954">err</a></span>&nbsp;<span class="op" id="5702989">!=</span>&nbsp;<span class="builtintype" id="5702992">nil</span>&nbsp;<span class="op" id="5702996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5703000"><a href="/gostd/net/http/cgi/host.go.html#5702890">rw</a></span><span class="op" id="5703002">.</span><span class="ident" id="5703003"><a href="/gostd/net/http/server.go.html#4171422">WriteHeader</a></span><span class="op" id="5703014">(</span><span class="ident" id="5703015"><a href="/gostd/net/http/cgi/host.go.html#5695238">http</a></span><span class="op" id="5703019">.</span><span class="ident" id="5703020"><a href="/gostd/net/http/status.go.html#4237466">StatusInternalServerError</a></span><span class="op" id="5703045">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5703049"><a href="/gostd/net/http/cgi/host.go.html#5702855">h</a></span><span class="op" id="5703050">.</span><span class="ident" id="5703051"><a href="/gostd/net/http/cgi/host.go.html#5702710">printf</a></span><span class="op" id="5703057">(</span><span class="string" id="5703058">&#34;cgi:&nbsp;error&nbsp;resolving&nbsp;local&nbsp;URI&nbsp;path&nbsp;%q:&nbsp;%v&#34;</span><span class="op" id="5703102">,</span>&nbsp;<span class="ident" id="5703104"><a href="/gostd/net/http/cgi/host.go.html#5702933">path</a></span><span class="op" id="5703108">,</span>&nbsp;<span class="ident" id="5703110"><a href="/gostd/net/http/cgi/host.go.html#5702954">err</a></span><span class="op" id="5703113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5703117">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5703125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5703128">//&nbsp;TODO:&nbsp;RFC&nbsp;3875&nbsp;isn&#39;t&nbsp;clear&nbsp;if&nbsp;only&nbsp;GET&nbsp;is&nbsp;supported,&nbsp;but&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5703192">//&nbsp;suggests&nbsp;so:&nbsp;&#34;Note&nbsp;that&nbsp;any&nbsp;message-body&nbsp;attached&nbsp;to&nbsp;the</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5703253">//&nbsp;request&nbsp;(such&nbsp;as&nbsp;for&nbsp;a&nbsp;POST&nbsp;request)&nbsp;may&nbsp;not&nbsp;be&nbsp;available</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5703315">//&nbsp;to&nbsp;the&nbsp;resource&nbsp;that&nbsp;is&nbsp;the&nbsp;target&nbsp;of&nbsp;the&nbsp;redirect.&#34;&nbsp;&nbsp;We</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5703376">//&nbsp;should&nbsp;do&nbsp;some&nbsp;tests&nbsp;against&nbsp;Apache&nbsp;to&nbsp;see&nbsp;how&nbsp;it&nbsp;handles</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5703438">//&nbsp;POST,&nbsp;HEAD,&nbsp;etc.&nbsp;Does&nbsp;the&nbsp;internal&nbsp;redirect&nbsp;get&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5703499">//&nbsp;method&nbsp;or&nbsp;just&nbsp;GET?&nbsp;What&nbsp;about&nbsp;incoming&nbsp;headers?</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5703552">//&nbsp;(e.g.&nbsp;Cookies)&nbsp;Which&nbsp;headers,&nbsp;if&nbsp;any,&nbsp;are&nbsp;copied&nbsp;into&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5703614">//&nbsp;second&nbsp;request?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5703634">newReq</span>&nbsp;<span class="op" id="5703641">:=</span>&nbsp;<span class="op" id="5703644">&amp;</span><span class="ident" id="5703645"><a href="/gostd/net/http/cgi/host.go.html#5695238">http</a></span><span class="op" id="5703649">.</span><span class="ident" id="5703650"><a href="/gostd/net/http/request.go.html#4135954">Request</a></span><span class="op" id="5703657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5703661"><a href="/gostd/net/http/request.go.html#4136084">Method</a></span><span class="op" id="5703667">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5703673">&#34;GET&#34;</span><span class="op" id="5703678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5703682"><a href="/gostd/net/http/request.go.html#4136640">URL</a></span><span class="op" id="5703685">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5703694"><a href="/gostd/net/http/cgi/host.go.html#5702949">url</a></span><span class="op" id="5703697">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5703701"><a href="/gostd/net/http/request.go.html#4136744">Proto</a></span><span class="op" id="5703706">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5703713">&#34;HTTP/1.1&#34;</span><span class="op" id="5703723">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5703727"><a href="/gostd/net/http/request.go.html#4136777">ProtoMajor</a></span><span class="op" id="5703737">:</span>&nbsp;<span class="num" id="5703739">1</span><span class="op" id="5703740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5703744"><a href="/gostd/net/http/request.go.html#4136801">ProtoMinor</a></span><span class="op" id="5703754">:</span>&nbsp;<span class="num" id="5703756">1</span><span class="op" id="5703757">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5703761"><a href="/gostd/net/http/request.go.html#4137563">Header</a></span><span class="op" id="5703767">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5703773">make</span><span class="op" id="5703777">(</span><span class="ident" id="5703778"><a href="/gostd/net/http/cgi/host.go.html#5695238">http</a></span><span class="op" id="5703782">.</span><span class="ident" id="5703783"><a href="/gostd/net/http/header.go.html#4126117">Header</a></span><span class="op" id="5703789">)</span><span class="op" id="5703790">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5703794"><a href="/gostd/net/http/request.go.html#4139164">Host</a></span><span class="op" id="5703798">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5703806"><a href="/gostd/net/http/cgi/host.go.html#5702949">url</a></span><span class="op" id="5703809">.</span><span class="ident" id="5703810"><a href="/gostd/net/url/url.go.html#3751325">Host</a></span><span class="op" id="5703814">,</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5703818"><a href="/gostd/net/http/request.go.html#4141200">RemoteAddr</a></span><span class="op" id="5703828">:</span>&nbsp;<span class="ident" id="5703830"><a href="/gostd/net/http/cgi/host.go.html#5702914">req</a></span><span class="op" id="5703833">.</span><span class="ident" id="5703834"><a href="/gostd/net/http/request.go.html#4141200">RemoteAddr</a></span><span class="op" id="5703844">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5703848"><a href="/gostd/net/http/request.go.html#4141858">TLS</a></span><span class="op" id="5703851">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5703860"><a href="/gostd/net/http/cgi/host.go.html#5702914">req</a></span><span class="op" id="5703863">.</span><span class="ident" id="5703864"><a href="/gostd/net/http/request.go.html#4141858">TLS</a></span><span class="op" id="5703867">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5703870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5703873"><a href="/gostd/net/http/cgi/host.go.html#5702855">h</a></span><span class="op" id="5703874">.</span><span class="ident" id="5703875"><a href="/gostd/net/http/cgi/host.go.html#5696926">PathLocationHandler</a></span><span class="op" id="5703894">.</span><span class="ident" id="5703895"><a href="/gostd/net/http/server.go.html#4170434">ServeHTTP</a></span><span class="op" id="5703904">(</span><span class="ident" id="5703905"><a href="/gostd/net/http/cgi/host.go.html#5702890">rw</a></span><span class="op" id="5703907">,</span>&nbsp;<span class="ident" id="5703909"><a href="/gostd/net/http/cgi/host.go.html#5703634">newReq</a></span><span class="op" id="5703915">)</span><br>
<span class="lineno"></span><span class="op" id="5703917">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="keyword" id="5703920">func</span>&nbsp;<span class="ident" id="5703925">upperCaseAndUnderscore</span><span class="op" id="5703947">(</span><span class="ident" id="5703948">r</span>&nbsp;<span class="builtintype" id="5703950">rune</span><span class="op" id="5703954">)</span>&nbsp;<span class="builtintype" id="5703956">rune</span>&nbsp;<span class="op" id="5703961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5703964">switch</span>&nbsp;<span class="op" id="5703971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5703974">case</span>&nbsp;<span class="ident" id="5703979"><a href="/gostd/net/http/cgi/host.go.html#5703948">r</a></span>&nbsp;<span class="op" id="5703981">&gt;=</span>&nbsp;<span class="string" id="5703984">&#39;a&#39;</span>&nbsp;<span class="op" id="5703988">&amp;&amp;</span>&nbsp;<span class="ident" id="5703991"><a href="/gostd/net/http/cgi/host.go.html#5703948">r</a></span>&nbsp;<span class="op" id="5703993">&lt;=</span>&nbsp;<span class="string" id="5703996">&#39;z&#39;</span><span class="op" id="5703999">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5704003">return</span>&nbsp;<span class="ident" id="5704010"><a href="/gostd/net/http/cgi/host.go.html#5703948">r</a></span>&nbsp;<span class="op" id="5704012">-</span>&nbsp;<span class="op" id="5704014">(</span><span class="string" id="5704015">&#39;a&#39;</span>&nbsp;<span class="op" id="5704019">-</span>&nbsp;<span class="string" id="5704021">&#39;A&#39;</span><span class="op" id="5704024">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5704027">case</span>&nbsp;<span class="ident" id="5704032"><a href="/gostd/net/http/cgi/host.go.html#5703948">r</a></span>&nbsp;<span class="op" id="5704034">==</span>&nbsp;<span class="string" id="5704037">&#39;-&#39;</span><span class="op" id="5704040">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5704044">return</span>&nbsp;<span class="string" id="5704051">&#39;_&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5704056">case</span>&nbsp;<span class="ident" id="5704061"><a href="/gostd/net/http/cgi/host.go.html#5703948">r</a></span>&nbsp;<span class="op" id="5704063">==</span>&nbsp;<span class="string" id="5704066">&#39;=&#39;</span><span class="op" id="5704069">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5704073">//&nbsp;Maybe&nbsp;not&nbsp;part&nbsp;of&nbsp;the&nbsp;CGI&nbsp;&#39;spec&#39;&nbsp;but&nbsp;would&nbsp;mess&nbsp;up</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5704129">//&nbsp;the&nbsp;environment&nbsp;in&nbsp;any&nbsp;case,&nbsp;as&nbsp;Go&nbsp;represents&nbsp;the</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5704184">//&nbsp;environment&nbsp;as&nbsp;a&nbsp;slice&nbsp;of&nbsp;&#34;key=value&#34;&nbsp;strings.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5704236">return</span>&nbsp;<span class="string" id="5704243">&#39;_&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5704248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5704251">//&nbsp;TODO:&nbsp;other&nbsp;transformations&nbsp;in&nbsp;spec&nbsp;or&nbsp;practice?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5704304">return</span>&nbsp;<span class="ident" id="5704311"><a href="/gostd/net/http/cgi/host.go.html#5703948">r</a></span><br>
<span class="lineno">375</span><span class="op" id="5704313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5704316">var</span>&nbsp;<span class="ident" id="5704320">testHookStartProcess</span>&nbsp;<span class="keyword" id="5704341">func</span><span class="op" id="5704345">(</span><span class="op" id="5704346">*</span><span class="ident" id="5704347"><a href="/gostd/net/http/cgi/host.go.html#5695250">os</a></span><span class="op" id="5704349">.</span><span class="ident" id="5704350"><a href="/gostd/os/exec.go.html#2433546">Process</a></span><span class="op" id="5704357">)</span>&nbsp;<span class="comment" id="5704359">//&nbsp;nil&nbsp;except&nbsp;for&nbsp;some&nbsp;tests</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
