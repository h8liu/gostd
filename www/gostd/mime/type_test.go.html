<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime</h2>
<ul>
<li><a href="/gostd/mime/grammar.go.html">grammar.go</a></li>
<li><a href="/gostd/mime/mediatype.go.html">mediatype.go</a></li>
<li><a href="/gostd/mime/mediatype_test.go.html">mediatype_test.go</a></li>
<li><a href="/gostd/mime/type.go.html">type.go</a></li>
<li><a href="/gostd/mime/type_test.go.html" class="current">type_test.go</a></li>
<li><a href="/gostd/mime/type_unix.go.html">type_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8222437">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8222492">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8222546">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8222597">package</span>&nbsp;<span class="ident" id="8222605">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8222611">import</span>&nbsp;<span class="op" id="8222618">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8222621">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8222631">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="8222634">var</span>&nbsp;<span class="ident" id="8222638">typeTests</span>&nbsp;<span class="op" id="8222648">=</span>&nbsp;<span class="ident" id="8222650">initMimeForTests</span><span class="op" id="8222666">(</span><span class="op" id="8222667">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8222670">func</span>&nbsp;<span class="ident" id="8222675">TestTypeByExtension</span><span class="op" id="8222694">(</span><span class="ident" id="8222695">t</span>&nbsp;<span class="op" id="8222697">*</span><span class="ident" id="8222698">testing</span><span class="op" id="8222705">.</span><span class="ident" id="8222706">T</span><span class="op" id="8222707">)</span>&nbsp;<span class="op" id="8222709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8222712">for</span>&nbsp;<span class="ident" id="8222716">ext</span><span class="op" id="8222719">,</span>&nbsp;<span class="ident" id="8222721">want</span>&nbsp;<span class="op" id="8222726">:=</span>&nbsp;<span class="keyword" id="8222729">range</span>&nbsp;<span class="ident" id="8222735">typeTests</span>&nbsp;<span class="op" id="8222745">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8222749">val</span>&nbsp;<span class="op" id="8222753">:=</span>&nbsp;<span class="ident" id="8222756">TypeByExtension</span><span class="op" id="8222771">(</span><span class="ident" id="8222772">ext</span><span class="op" id="8222775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8222779">if</span>&nbsp;<span class="ident" id="8222782">val</span>&nbsp;<span class="op" id="8222786">!=</span>&nbsp;<span class="ident" id="8222789">want</span>&nbsp;<span class="op" id="8222794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8222799">t</span><span class="op" id="8222800">.</span><span class="ident" id="8222801">Errorf</span><span class="op" id="8222807">(</span><span class="string" id="8222808">&#34;TypeByExtension(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8222843">,</span>&nbsp;<span class="ident" id="8222845">ext</span><span class="op" id="8222848">,</span>&nbsp;<span class="ident" id="8222850">val</span><span class="op" id="8222853">,</span>&nbsp;<span class="ident" id="8222855">want</span><span class="op" id="8222859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8222863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8222866">}</span><br>
<span class="lineno">20</span><span class="op" id="8222868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8222871">func</span>&nbsp;<span class="ident" id="8222876">TestTypeByExtensionCase</span><span class="op" id="8222899">(</span><span class="ident" id="8222900">t</span>&nbsp;<span class="op" id="8222902">*</span><span class="ident" id="8222903">testing</span><span class="op" id="8222910">.</span><span class="ident" id="8222911">T</span><span class="op" id="8222912">)</span>&nbsp;<span class="op" id="8222914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8222917">const</span>&nbsp;<span class="ident" id="8222923">custom</span>&nbsp;<span class="op" id="8222930">=</span>&nbsp;<span class="string" id="8222932">&#34;test/test;&nbsp;charset=iso-8859-1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8222965">const</span>&nbsp;<span class="ident" id="8222971">caps</span>&nbsp;<span class="op" id="8222976">=</span>&nbsp;<span class="string" id="8222978">&#34;test/test;&nbsp;WAS=ALLCAPS&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8223004">if</span>&nbsp;<span class="ident" id="8223007">err</span>&nbsp;<span class="op" id="8223011">:=</span>&nbsp;<span class="ident" id="8223014">AddExtensionType</span><span class="op" id="8223030">(</span><span class="string" id="8223031">&#34;.TEST&#34;</span><span class="op" id="8223038">,</span>&nbsp;<span class="ident" id="8223040">caps</span><span class="op" id="8223044">)</span><span class="op" id="8223045">;</span>&nbsp;<span class="ident" id="8223047">err</span>&nbsp;<span class="op" id="8223051">!=</span>&nbsp;<span class="ident" id="8223054">nil</span>&nbsp;<span class="op" id="8223058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8223062">t</span><span class="op" id="8223063">.</span><span class="ident" id="8223064">Fatalf</span><span class="op" id="8223070">(</span><span class="string" id="8223071">&#34;error&nbsp;%s&nbsp;for&nbsp;AddExtension(%s)&#34;</span><span class="op" id="8223102">,</span>&nbsp;<span class="ident" id="8223104">err</span><span class="op" id="8223107">,</span>&nbsp;<span class="ident" id="8223109">custom</span><span class="op" id="8223115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8223118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8223121">if</span>&nbsp;<span class="ident" id="8223124">err</span>&nbsp;<span class="op" id="8223128">:=</span>&nbsp;<span class="ident" id="8223131">AddExtensionType</span><span class="op" id="8223147">(</span><span class="string" id="8223148">&#34;.tesT&#34;</span><span class="op" id="8223155">,</span>&nbsp;<span class="ident" id="8223157">custom</span><span class="op" id="8223163">)</span><span class="op" id="8223164">;</span>&nbsp;<span class="ident" id="8223166">err</span>&nbsp;<span class="op" id="8223170">!=</span>&nbsp;<span class="ident" id="8223173">nil</span>&nbsp;<span class="op" id="8223177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8223181">t</span><span class="op" id="8223182">.</span><span class="ident" id="8223183">Fatalf</span><span class="op" id="8223189">(</span><span class="string" id="8223190">&#34;error&nbsp;%s&nbsp;for&nbsp;AddExtension(%s)&#34;</span><span class="op" id="8223221">,</span>&nbsp;<span class="ident" id="8223223">err</span><span class="op" id="8223226">,</span>&nbsp;<span class="ident" id="8223228">custom</span><span class="op" id="8223234">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8223237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8223241">//&nbsp;case-sensitive&nbsp;lookup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8223267">if</span>&nbsp;<span class="ident" id="8223270">got</span>&nbsp;<span class="op" id="8223274">:=</span>&nbsp;<span class="ident" id="8223277">TypeByExtension</span><span class="op" id="8223292">(</span><span class="string" id="8223293">&#34;.tesT&#34;</span><span class="op" id="8223300">)</span><span class="op" id="8223301">;</span>&nbsp;<span class="ident" id="8223303">got</span>&nbsp;<span class="op" id="8223307">!=</span>&nbsp;<span class="ident" id="8223310">custom</span>&nbsp;<span class="op" id="8223317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8223321">t</span><span class="op" id="8223322">.</span><span class="ident" id="8223323">Fatalf</span><span class="op" id="8223329">(</span><span class="string" id="8223330">&#34;for&nbsp;.tesT,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8223358">,</span>&nbsp;<span class="ident" id="8223360">got</span><span class="op" id="8223363">,</span>&nbsp;<span class="ident" id="8223365">custom</span><span class="op" id="8223371">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8223374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8223377">if</span>&nbsp;<span class="ident" id="8223380">got</span>&nbsp;<span class="op" id="8223384">:=</span>&nbsp;<span class="ident" id="8223387">TypeByExtension</span><span class="op" id="8223402">(</span><span class="string" id="8223403">&#34;.TEST&#34;</span><span class="op" id="8223410">)</span><span class="op" id="8223411">;</span>&nbsp;<span class="ident" id="8223413">got</span>&nbsp;<span class="op" id="8223417">!=</span>&nbsp;<span class="ident" id="8223420">caps</span>&nbsp;<span class="op" id="8223425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8223429">t</span><span class="op" id="8223430">.</span><span class="ident" id="8223431">Fatalf</span><span class="op" id="8223437">(</span><span class="string" id="8223438">&#34;for&nbsp;.TEST,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8223466">,</span>&nbsp;<span class="ident" id="8223468">got</span><span class="op" id="8223471">,</span>&nbsp;<span class="ident" id="8223473">caps</span><span class="op" id="8223477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8223480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8223484">//&nbsp;case-insensitive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8223505">if</span>&nbsp;<span class="ident" id="8223508">got</span>&nbsp;<span class="op" id="8223512">:=</span>&nbsp;<span class="ident" id="8223515">TypeByExtension</span><span class="op" id="8223530">(</span><span class="string" id="8223531">&#34;.TesT&#34;</span><span class="op" id="8223538">)</span><span class="op" id="8223539">;</span>&nbsp;<span class="ident" id="8223541">got</span>&nbsp;<span class="op" id="8223545">!=</span>&nbsp;<span class="ident" id="8223548">custom</span>&nbsp;<span class="op" id="8223555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8223559">t</span><span class="op" id="8223560">.</span><span class="ident" id="8223561">Fatalf</span><span class="op" id="8223567">(</span><span class="string" id="8223568">&#34;for&nbsp;.TesT,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8223596">,</span>&nbsp;<span class="ident" id="8223598">got</span><span class="op" id="8223601">,</span>&nbsp;<span class="ident" id="8223603">custom</span><span class="op" id="8223609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8223612">}</span><br>
<span class="lineno"></span><span class="op" id="8223614">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="8223617">func</span>&nbsp;<span class="ident" id="8223622">TestLookupMallocs</span><span class="op" id="8223639">(</span><span class="ident" id="8223640">t</span>&nbsp;<span class="op" id="8223642">*</span><span class="ident" id="8223643">testing</span><span class="op" id="8223650">.</span><span class="ident" id="8223651">T</span><span class="op" id="8223652">)</span>&nbsp;<span class="op" id="8223654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8223657">n</span>&nbsp;<span class="op" id="8223659">:=</span>&nbsp;<span class="ident" id="8223662">testing</span><span class="op" id="8223669">.</span><span class="ident" id="8223670">AllocsPerRun</span><span class="op" id="8223682">(</span><span class="num" id="8223683">10000</span><span class="op" id="8223688">,</span>&nbsp;<span class="keyword" id="8223690">func</span><span class="op" id="8223694">(</span><span class="op" id="8223695">)</span>&nbsp;<span class="op" id="8223697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8223701">TypeByExtension</span><span class="op" id="8223716">(</span><span class="string" id="8223717">&#34;.html&#34;</span><span class="op" id="8223724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8223728">TypeByExtension</span><span class="op" id="8223743">(</span><span class="string" id="8223744">&#34;.HtML&#34;</span><span class="op" id="8223751">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8223754">}</span><span class="op" id="8223755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8223758">if</span>&nbsp;<span class="ident" id="8223761">n</span>&nbsp;<span class="op" id="8223763">&gt;</span>&nbsp;<span class="num" id="8223765">0</span>&nbsp;<span class="op" id="8223767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8223771">t</span><span class="op" id="8223772">.</span><span class="ident" id="8223773">Errorf</span><span class="op" id="8223779">(</span><span class="string" id="8223780">&#34;allocs&nbsp;=&nbsp;%v;&nbsp;want&nbsp;0&#34;</span><span class="op" id="8223801">,</span>&nbsp;<span class="ident" id="8223803">n</span><span class="op" id="8223804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8223807">}</span><br>
<span class="lineno"></span><span class="op" id="8223809">}</span>
</div>
</body>
</html>
