<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html" class="current">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2950685">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2950740">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2950794">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2950845">package</span>&nbsp;<span class="ident" id="2950853">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2950859">import</span>&nbsp;<span class="op" id="2950866">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2950869">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2950876">&#34;io&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2950881">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2950884">//&nbsp;fileTransport&nbsp;implements&nbsp;RoundTripper&nbsp;for&nbsp;the&nbsp;&#39;file&#39;&nbsp;protocol.</span><br>
<span class="lineno"></span><span class="keyword" id="2950950">type</span>&nbsp;<span class="ident" id="2950955">fileTransport</span>&nbsp;<span class="keyword" id="2950969">struct</span>&nbsp;<span class="op" id="2950976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2950979">fh</span>&nbsp;<span class="ident" id="2950982">fileHandler</span><br>
<span class="lineno">15</span><span class="op" id="2950994">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2950997">//&nbsp;NewFileTransport&nbsp;returns&nbsp;a&nbsp;new&nbsp;RoundTripper,&nbsp;serving&nbsp;the&nbsp;provided</span><br>
<span class="lineno"></span><span class="comment" id="2951066">//&nbsp;FileSystem.&nbsp;The&nbsp;returned&nbsp;RoundTripper&nbsp;ignores&nbsp;the&nbsp;URL&nbsp;host&nbsp;in&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="2951135">//&nbsp;incoming&nbsp;requests,&nbsp;as&nbsp;well&nbsp;as&nbsp;most&nbsp;other&nbsp;properties&nbsp;of&nbsp;the</span><br>
<span class="lineno">20</span><span class="comment" id="2951197">//&nbsp;request.</span><br>
<span class="lineno"></span><span class="comment" id="2951209">//</span><br>
<span class="lineno"></span><span class="comment" id="2951212">//&nbsp;The&nbsp;typical&nbsp;use&nbsp;case&nbsp;for&nbsp;NewFileTransport&nbsp;is&nbsp;to&nbsp;register&nbsp;the&nbsp;&#34;file&#34;</span><br>
<span class="lineno"></span><span class="comment" id="2951283">//&nbsp;protocol&nbsp;with&nbsp;a&nbsp;Transport,&nbsp;as&nbsp;in:</span><br>
<span class="lineno"></span><span class="comment" id="2951320">//</span><br>
<span class="lineno">25</span><span class="comment" id="2951323">//&nbsp;&nbsp;&nbsp;t&nbsp;:=&nbsp;&amp;http.Transport{}</span><br>
<span class="lineno"></span><span class="comment" id="2951351">//&nbsp;&nbsp;&nbsp;t.RegisterProtocol(&#34;file&#34;,&nbsp;http.NewFileTransport(http.Dir(&#34;/&#34;)))</span><br>
<span class="lineno"></span><span class="comment" id="2951421">//&nbsp;&nbsp;&nbsp;c&nbsp;:=&nbsp;&amp;http.Client{Transport:&nbsp;t}</span><br>
<span class="lineno"></span><span class="comment" id="2951458">//&nbsp;&nbsp;&nbsp;res,&nbsp;err&nbsp;:=&nbsp;c.Get(&#34;file:///etc/passwd&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="2951503">//&nbsp;&nbsp;&nbsp;...</span><br>
<span class="lineno">30</span><span class="keyword" id="2951512">func</span>&nbsp;<span class="ident" id="2951517">NewFileTransport</span><span class="op" id="2951533">(</span><span class="ident" id="2951534">fs</span>&nbsp;<span class="ident" id="2951537">FileSystem</span><span class="op" id="2951547">)</span>&nbsp;<span class="ident" id="2951549">RoundTripper</span>&nbsp;<span class="op" id="2951562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2951565">return</span>&nbsp;<span class="ident" id="2951572">fileTransport</span><span class="op" id="2951585">{</span><span class="ident" id="2951586">fileHandler</span><span class="op" id="2951597">{</span><span class="ident" id="2951598">fs</span><span class="op" id="2951600">}</span><span class="op" id="2951601">}</span><br>
<span class="lineno"></span><span class="op" id="2951603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2951606">func</span>&nbsp;<span class="op" id="2951611">(</span><span class="ident" id="2951612">t</span>&nbsp;<span class="ident" id="2951614">fileTransport</span><span class="op" id="2951627">)</span>&nbsp;<span class="ident" id="2951629">RoundTrip</span><span class="op" id="2951638">(</span><span class="ident" id="2951639">req</span>&nbsp;<span class="op" id="2951643">*</span><span class="ident" id="2951644">Request</span><span class="op" id="2951651">)</span>&nbsp;<span class="op" id="2951653">(</span><span class="ident" id="2951654">resp</span>&nbsp;<span class="op" id="2951659">*</span><span class="ident" id="2951660">Response</span><span class="op" id="2951668">,</span>&nbsp;<span class="ident" id="2951670">err</span>&nbsp;<span class="builtintype" id="2951674">error</span><span class="op" id="2951679">)</span>&nbsp;<span class="op" id="2951681">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2951684">//&nbsp;We&nbsp;start&nbsp;ServeHTTP&nbsp;in&nbsp;a&nbsp;goroutine,&nbsp;which&nbsp;may&nbsp;take&nbsp;a&nbsp;long</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2951745">//&nbsp;time&nbsp;if&nbsp;the&nbsp;file&nbsp;is&nbsp;large.&nbsp;&nbsp;The&nbsp;newPopulateResponseWriter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2951807">//&nbsp;call&nbsp;returns&nbsp;a&nbsp;channel&nbsp;which&nbsp;either&nbsp;ServeHTTP&nbsp;or&nbsp;finish()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2951869">//&nbsp;sends&nbsp;our&nbsp;*Response&nbsp;on,&nbsp;once&nbsp;the&nbsp;*Response&nbsp;itself&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2951932">//&nbsp;populated&nbsp;(even&nbsp;if&nbsp;the&nbsp;body&nbsp;itself&nbsp;is&nbsp;still&nbsp;being</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2951986">//&nbsp;written&nbsp;to&nbsp;the&nbsp;res.Body,&nbsp;a&nbsp;pipe)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2952023">rw</span><span class="op" id="2952025">,</span>&nbsp;<span class="ident" id="2952027">resc</span>&nbsp;<span class="op" id="2952032">:=</span>&nbsp;<span class="ident" id="2952035">newPopulateResponseWriter</span><span class="op" id="2952060">(</span><span class="op" id="2952061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2952064">go</span>&nbsp;<span class="keyword" id="2952067">func</span><span class="op" id="2952071">(</span><span class="op" id="2952072">)</span>&nbsp;<span class="op" id="2952074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2952078">t</span><span class="op" id="2952079">.</span><span class="ident" id="2952080">fh</span><span class="op" id="2952082">.</span><span class="ident" id="2952083">ServeHTTP</span><span class="op" id="2952092">(</span><span class="ident" id="2952093">rw</span><span class="op" id="2952095">,</span>&nbsp;<span class="ident" id="2952097">req</span><span class="op" id="2952100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2952104">rw</span><span class="op" id="2952106">.</span><span class="ident" id="2952107">finish</span><span class="op" id="2952113">(</span><span class="op" id="2952114">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2952117">}</span><span class="op" id="2952118">(</span><span class="op" id="2952119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2952122">return</span>&nbsp;<span class="op" id="2952129">&lt;-</span><span class="ident" id="2952131">resc</span><span class="op" id="2952135">,</span>&nbsp;<span class="builtintype" id="2952137">nil</span><br>
<span class="lineno"></span><span class="op" id="2952141">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2952144">func</span>&nbsp;<span class="ident" id="2952149">newPopulateResponseWriter</span><span class="op" id="2952174">(</span><span class="op" id="2952175">)</span>&nbsp;<span class="op" id="2952177">(</span><span class="op" id="2952178">*</span><span class="ident" id="2952179">populateResponse</span><span class="op" id="2952195">,</span>&nbsp;<span class="op" id="2952197">&lt;-</span><span class="keyword" id="2952199">chan</span>&nbsp;<span class="op" id="2952204">*</span><span class="ident" id="2952205">Response</span><span class="op" id="2952213">)</span>&nbsp;<span class="op" id="2952215">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2952218">pr</span><span class="op" id="2952220">,</span>&nbsp;<span class="ident" id="2952222">pw</span>&nbsp;<span class="op" id="2952225">:=</span>&nbsp;<span class="ident" id="2952228">io</span><span class="op" id="2952230">.</span><span class="ident" id="2952231">Pipe</span><span class="op" id="2952235">(</span><span class="op" id="2952236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2952239">rw</span>&nbsp;<span class="op" id="2952242">:=</span>&nbsp;<span class="op" id="2952245">&amp;</span><span class="ident" id="2952246">populateResponse</span><span class="op" id="2952262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2952266">ch</span><span class="op" id="2952268">:</span>&nbsp;<span class="builtinfunc" id="2952270">make</span><span class="op" id="2952274">(</span><span class="keyword" id="2952275">chan</span>&nbsp;<span class="op" id="2952280">*</span><span class="ident" id="2952281">Response</span><span class="op" id="2952289">)</span><span class="op" id="2952290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2952294">pw</span><span class="op" id="2952296">:</span>&nbsp;<span class="ident" id="2952298">pw</span><span class="op" id="2952300">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2952304">res</span><span class="op" id="2952307">:</span>&nbsp;<span class="op" id="2952309">&amp;</span><span class="ident" id="2952310">Response</span><span class="op" id="2952318">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2952323">Proto</span><span class="op" id="2952328">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2952335">&#34;HTTP/1.0&#34;</span><span class="op" id="2952345">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2952350">ProtoMajor</span><span class="op" id="2952360">:</span>&nbsp;<span class="num" id="2952362">1</span><span class="op" id="2952363">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2952368">Header</span><span class="op" id="2952374">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2952380">make</span><span class="op" id="2952384">(</span><span class="ident" id="2952385">Header</span><span class="op" id="2952391">)</span><span class="op" id="2952392">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2952397">Close</span><span class="op" id="2952402">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2952409">true</span><span class="op" id="2952413">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2952418">Body</span><span class="op" id="2952422">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2952430">pr</span><span class="op" id="2952432">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2952436">}</span><span class="op" id="2952437">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2952440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2952443">return</span>&nbsp;<span class="ident" id="2952450">rw</span><span class="op" id="2952452">,</span>&nbsp;<span class="ident" id="2952454">rw</span><span class="op" id="2952456">.</span><span class="ident" id="2952457">ch</span><br>
<span class="lineno"></span><span class="op" id="2952460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="comment" id="2952463">//&nbsp;populateResponse&nbsp;is&nbsp;a&nbsp;ResponseWriter&nbsp;that&nbsp;populates&nbsp;the&nbsp;*Response</span><br>
<span class="lineno"></span><span class="comment" id="2952532">//&nbsp;in&nbsp;res,&nbsp;and&nbsp;writes&nbsp;its&nbsp;body&nbsp;to&nbsp;a&nbsp;pipe&nbsp;connected&nbsp;to&nbsp;the&nbsp;response</span><br>
<span class="lineno"></span><span class="comment" id="2952599">//&nbsp;body.&nbsp;Once&nbsp;writes&nbsp;begin&nbsp;or&nbsp;finish()&nbsp;is&nbsp;called,&nbsp;the&nbsp;response&nbsp;is&nbsp;sent</span><br>
<span class="lineno"></span><span class="comment" id="2952670">//&nbsp;on&nbsp;ch.</span><br>
<span class="lineno"></span><span class="keyword" id="2952680">type</span>&nbsp;<span class="ident" id="2952685">populateResponse</span>&nbsp;<span class="keyword" id="2952702">struct</span>&nbsp;<span class="op" id="2952709">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2952712">res</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2952725">*</span><span class="ident" id="2952726">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2952736">ch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2952749">chan</span>&nbsp;<span class="op" id="2952754">*</span><span class="ident" id="2952755">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2952765">wroteHeader</span>&nbsp;&nbsp;<span class="builtintype" id="2952778">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2952784">hasContent</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2952797">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2952803">sentResponse</span>&nbsp;<span class="builtintype" id="2952816">bool</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2952822">pw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2952835">*</span><span class="ident" id="2952836">io</span><span class="op" id="2952838">.</span><span class="ident" id="2952839">PipeWriter</span><br>
<span class="lineno"></span><span class="op" id="2952850">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2952853">func</span>&nbsp;<span class="op" id="2952858">(</span><span class="ident" id="2952859">pr</span>&nbsp;<span class="op" id="2952862">*</span><span class="ident" id="2952863">populateResponse</span><span class="op" id="2952879">)</span>&nbsp;<span class="ident" id="2952881">finish</span><span class="op" id="2952887">(</span><span class="op" id="2952888">)</span>&nbsp;<span class="op" id="2952890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2952893">if</span>&nbsp;<span class="op" id="2952896">!</span><span class="ident" id="2952897">pr</span><span class="op" id="2952899">.</span><span class="ident" id="2952900">wroteHeader</span>&nbsp;<span class="op" id="2952912">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2952916">pr</span><span class="op" id="2952918">.</span><span class="ident" id="2952919">WriteHeader</span><span class="op" id="2952930">(</span><span class="num" id="2952931">500</span><span class="op" id="2952934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2952937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2952940">if</span>&nbsp;<span class="op" id="2952943">!</span><span class="ident" id="2952944">pr</span><span class="op" id="2952946">.</span><span class="ident" id="2952947">sentResponse</span>&nbsp;<span class="op" id="2952960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2952964">pr</span><span class="op" id="2952966">.</span><span class="ident" id="2952967">sendResponse</span><span class="op" id="2952979">(</span><span class="op" id="2952980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2952983">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2952986">pr</span><span class="op" id="2952988">.</span><span class="ident" id="2952989">pw</span><span class="op" id="2952991">.</span><span class="ident" id="2952992">Close</span><span class="op" id="2952997">(</span><span class="op" id="2952998">)</span><br>
<span class="lineno"></span><span class="op" id="2953000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2953003">func</span>&nbsp;<span class="op" id="2953008">(</span><span class="ident" id="2953009">pr</span>&nbsp;<span class="op" id="2953012">*</span><span class="ident" id="2953013">populateResponse</span><span class="op" id="2953029">)</span>&nbsp;<span class="ident" id="2953031">sendResponse</span><span class="op" id="2953043">(</span><span class="op" id="2953044">)</span>&nbsp;<span class="op" id="2953046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2953049">if</span>&nbsp;<span class="ident" id="2953052">pr</span><span class="op" id="2953054">.</span><span class="ident" id="2953055">sentResponse</span>&nbsp;<span class="op" id="2953068">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2953072">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2953080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2953083">pr</span><span class="op" id="2953085">.</span><span class="ident" id="2953086">sentResponse</span>&nbsp;<span class="op" id="2953099">=</span>&nbsp;<span class="builtintype" id="2953101">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2953108">if</span>&nbsp;<span class="ident" id="2953111">pr</span><span class="op" id="2953113">.</span><span class="ident" id="2953114">hasContent</span>&nbsp;<span class="op" id="2953125">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2953129">pr</span><span class="op" id="2953131">.</span><span class="ident" id="2953132">res</span><span class="op" id="2953135">.</span><span class="ident" id="2953136">ContentLength</span>&nbsp;<span class="op" id="2953150">=</span>&nbsp;<span class="op" id="2953152">-</span><span class="num" id="2953153">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2953156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2953159">pr</span><span class="op" id="2953161">.</span><span class="ident" id="2953162">ch</span>&nbsp;<span class="op" id="2953165">&lt;-</span>&nbsp;<span class="ident" id="2953168">pr</span><span class="op" id="2953170">.</span><span class="ident" id="2953171">res</span><br>
<span class="lineno"></span><span class="op" id="2953175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="2953178">func</span>&nbsp;<span class="op" id="2953183">(</span><span class="ident" id="2953184">pr</span>&nbsp;<span class="op" id="2953187">*</span><span class="ident" id="2953188">populateResponse</span><span class="op" id="2953204">)</span>&nbsp;<span class="ident" id="2953206">Header</span><span class="op" id="2953212">(</span><span class="op" id="2953213">)</span>&nbsp;<span class="ident" id="2953215">Header</span>&nbsp;<span class="op" id="2953222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2953225">return</span>&nbsp;<span class="ident" id="2953232">pr</span><span class="op" id="2953234">.</span><span class="ident" id="2953235">res</span><span class="op" id="2953238">.</span><span class="ident" id="2953239">Header</span><br>
<span class="lineno"></span><span class="op" id="2953246">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2953249">func</span>&nbsp;<span class="op" id="2953254">(</span><span class="ident" id="2953255">pr</span>&nbsp;<span class="op" id="2953258">*</span><span class="ident" id="2953259">populateResponse</span><span class="op" id="2953275">)</span>&nbsp;<span class="ident" id="2953277">WriteHeader</span><span class="op" id="2953288">(</span><span class="ident" id="2953289">code</span>&nbsp;<span class="builtintype" id="2953294">int</span><span class="op" id="2953297">)</span>&nbsp;<span class="op" id="2953299">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2953302">if</span>&nbsp;<span class="ident" id="2953305">pr</span><span class="op" id="2953307">.</span><span class="ident" id="2953308">wroteHeader</span>&nbsp;<span class="op" id="2953320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2953324">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2953332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2953335">pr</span><span class="op" id="2953337">.</span><span class="ident" id="2953338">wroteHeader</span>&nbsp;<span class="op" id="2953350">=</span>&nbsp;<span class="builtintype" id="2953352">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2953359">pr</span><span class="op" id="2953361">.</span><span class="ident" id="2953362">res</span><span class="op" id="2953365">.</span><span class="ident" id="2953366">StatusCode</span>&nbsp;<span class="op" id="2953377">=</span>&nbsp;<span class="ident" id="2953379">code</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2953385">pr</span><span class="op" id="2953387">.</span><span class="ident" id="2953388">res</span><span class="op" id="2953391">.</span><span class="ident" id="2953392">Status</span>&nbsp;<span class="op" id="2953399">=</span>&nbsp;<span class="ident" id="2953401">fmt</span><span class="op" id="2953404">.</span><span class="ident" id="2953405">Sprintf</span><span class="op" id="2953412">(</span><span class="string" id="2953413">&#34;%d&nbsp;%s&#34;</span><span class="op" id="2953420">,</span>&nbsp;<span class="ident" id="2953422">code</span><span class="op" id="2953426">,</span>&nbsp;<span class="ident" id="2953428">StatusText</span><span class="op" id="2953438">(</span><span class="ident" id="2953439">code</span><span class="op" id="2953443">)</span><span class="op" id="2953444">)</span><br>
<span class="lineno"></span><span class="op" id="2953446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2953449">func</span>&nbsp;<span class="op" id="2953454">(</span><span class="ident" id="2953455">pr</span>&nbsp;<span class="op" id="2953458">*</span><span class="ident" id="2953459">populateResponse</span><span class="op" id="2953475">)</span>&nbsp;<span class="ident" id="2953477">Write</span><span class="op" id="2953482">(</span><span class="ident" id="2953483">p</span>&nbsp;<span class="op" id="2953485">[</span><span class="op" id="2953486">]</span><span class="builtintype" id="2953487">byte</span><span class="op" id="2953491">)</span>&nbsp;<span class="op" id="2953493">(</span><span class="ident" id="2953494">n</span>&nbsp;<span class="builtintype" id="2953496">int</span><span class="op" id="2953499">,</span>&nbsp;<span class="ident" id="2953501">err</span>&nbsp;<span class="builtintype" id="2953505">error</span><span class="op" id="2953510">)</span>&nbsp;<span class="op" id="2953512">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2953515">if</span>&nbsp;<span class="op" id="2953518">!</span><span class="ident" id="2953519">pr</span><span class="op" id="2953521">.</span><span class="ident" id="2953522">wroteHeader</span>&nbsp;<span class="op" id="2953534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2953538">pr</span><span class="op" id="2953540">.</span><span class="ident" id="2953541">WriteHeader</span><span class="op" id="2953552">(</span><span class="ident" id="2953553">StatusOK</span><span class="op" id="2953561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2953564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2953567">pr</span><span class="op" id="2953569">.</span><span class="ident" id="2953570">hasContent</span>&nbsp;<span class="op" id="2953581">=</span>&nbsp;<span class="builtintype" id="2953583">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2953589">if</span>&nbsp;<span class="op" id="2953592">!</span><span class="ident" id="2953593">pr</span><span class="op" id="2953595">.</span><span class="ident" id="2953596">sentResponse</span>&nbsp;<span class="op" id="2953609">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2953613">pr</span><span class="op" id="2953615">.</span><span class="ident" id="2953616">sendResponse</span><span class="op" id="2953628">(</span><span class="op" id="2953629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2953632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2953635">return</span>&nbsp;<span class="ident" id="2953642">pr</span><span class="op" id="2953644">.</span><span class="ident" id="2953645">pw</span><span class="op" id="2953647">.</span><span class="ident" id="2953648">Write</span><span class="op" id="2953653">(</span><span class="ident" id="2953654">p</span><span class="op" id="2953655">)</span><br>
<span class="lineno"></span><span class="op" id="2953657">}</span>
</div>
</body>
</html>
