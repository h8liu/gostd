<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6446598">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6446653">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6446707">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6446758">//&nbsp;Package&nbsp;scanner&nbsp;provides&nbsp;a&nbsp;scanner&nbsp;and&nbsp;tokenizer&nbsp;for&nbsp;UTF-8-encoded&nbsp;text.</span><br>
<span class="lineno"></span><span class="comment" id="6446834">//&nbsp;It&nbsp;takes&nbsp;an&nbsp;io.Reader&nbsp;providing&nbsp;the&nbsp;source,&nbsp;which&nbsp;then&nbsp;can&nbsp;be&nbsp;tokenized</span><br>
<span class="lineno"></span><span class="comment" id="6446909">//&nbsp;through&nbsp;repeated&nbsp;calls&nbsp;to&nbsp;the&nbsp;Scan&nbsp;function.&nbsp;&nbsp;For&nbsp;compatibility&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="6446981">//&nbsp;existing&nbsp;tools,&nbsp;the&nbsp;NUL&nbsp;character&nbsp;is&nbsp;not&nbsp;allowed.&nbsp;If&nbsp;the&nbsp;first&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="6447057">//&nbsp;in&nbsp;the&nbsp;source&nbsp;is&nbsp;a&nbsp;UTF-8&nbsp;encoded&nbsp;byte&nbsp;order&nbsp;mark&nbsp;(BOM),&nbsp;it&nbsp;is&nbsp;discarded.</span><br>
<span class="lineno">10</span><span class="comment" id="6447133">//</span><br>
<span class="lineno"></span><span class="comment" id="6447136">//&nbsp;By&nbsp;default,&nbsp;a&nbsp;Scanner&nbsp;skips&nbsp;white&nbsp;space&nbsp;and&nbsp;Go&nbsp;comments&nbsp;and&nbsp;recognizes&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="6447214">//&nbsp;literals&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;Go&nbsp;language&nbsp;specification.&nbsp;&nbsp;It&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="6447282">//&nbsp;customized&nbsp;to&nbsp;recognize&nbsp;only&nbsp;a&nbsp;subset&nbsp;of&nbsp;those&nbsp;literals&nbsp;and&nbsp;to&nbsp;recognize</span><br>
<span class="lineno"></span><span class="comment" id="6447358">//&nbsp;different&nbsp;identifier&nbsp;and&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno">15</span><span class="comment" id="6447410">//</span><br>
<span class="lineno"></span><span class="comment" id="6447413">//&nbsp;Basic&nbsp;usage&nbsp;pattern:</span><br>
<span class="lineno"></span><span class="comment" id="6447437">//</span><br>
<span class="lineno"></span><span class="comment" id="6447440">//&nbsp;&nbsp;&nbsp;&nbspvar&nbsp;s&nbsp;scanner.Scanner</span><br>
<span class="lineno"></span><span class="comment" id="6447465">//&nbsp;&nbsp;&nbsp;&nbsps.Init(src)</span><br>
<span class="lineno">20</span><span class="comment" id="6447480">//&nbsp;&nbsp;&nbsp;&nbsptok&nbsp;:=&nbsp;s.Scan()</span><br>
<span class="lineno"></span><span class="comment" id="6447499">//&nbsp;&nbsp;&nbsp;&nbspfor&nbsp;tok&nbsp;!=&nbsp;scanner.EOF&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="6447527">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;do&nbsp;something&nbsp;with&nbsp;tok</span><br>
<span class="lineno"></span><span class="comment" id="6447556">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsptok&nbsp;=&nbsp;s.Scan()</span><br>
<span class="lineno"></span><span class="comment" id="6447575">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno">25</span><span class="comment" id="6447580">//</span><br>
<span class="lineno"></span><span class="keyword" id="6447583">package</span>&nbsp;<span class="ident" id="6447591">scanner</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6447600">import</span>&nbsp;<span class="op" id="6447607">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6447610">&#34;bytes&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6447619">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6447626">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6447632">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6447638">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6447649">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">35</span><span class="op" id="6447664">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6447667">//&nbsp;A&nbsp;source&nbsp;position&nbsp;is&nbsp;represented&nbsp;by&nbsp;a&nbsp;Position&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="6447724">//&nbsp;A&nbsp;position&nbsp;is&nbsp;valid&nbsp;if&nbsp;Line&nbsp;&gt;&nbsp;0.</span><br>
<span class="lineno"></span><span class="keyword" id="6447760">type</span>&nbsp;<span class="ident" id="6447765">Position</span>&nbsp;<span class="keyword" id="6447774">struct</span>&nbsp;<span class="op" id="6447781">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6447784">Filename</span>&nbsp;<span class="builtintype" id="6447793">string</span>&nbsp;<span class="comment" id="6447800">//&nbsp;filename,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6447821">Offset</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6447830">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6447837">//&nbsp;byte&nbsp;offset,&nbsp;starting&nbsp;at&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6447868">Line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6447877">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6447884">//&nbsp;line&nbsp;number,&nbsp;starting&nbsp;at&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6447915">Column</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6447924">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6447931">//&nbsp;column&nbsp;number,&nbsp;starting&nbsp;at&nbsp;1&nbsp;(character&nbsp;count&nbsp;per&nbsp;line)</span><br>
<span class="lineno"></span><span class="op" id="6447990">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="6447993">//&nbsp;IsValid&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;position&nbsp;is&nbsp;valid.</span><br>
<span class="lineno"></span><span class="keyword" id="6448043">func</span>&nbsp;<span class="op" id="6448048">(</span><span class="ident" id="6448049">pos</span>&nbsp;<span class="op" id="6448053">*</span><span class="ident" id="6448054">Position</span><span class="op" id="6448062">)</span>&nbsp;<span class="ident" id="6448064">IsValid</span><span class="op" id="6448071">(</span><span class="op" id="6448072">)</span>&nbsp;<span class="builtintype" id="6448074">bool</span>&nbsp;<span class="op" id="6448079">{</span>&nbsp;<span class="keyword" id="6448081">return</span>&nbsp;<span class="ident" id="6448088">pos</span><span class="op" id="6448091">.</span><span class="ident" id="6448092">Line</span>&nbsp;<span class="op" id="6448097">&gt;</span>&nbsp;<span class="num" id="6448099">0</span>&nbsp;<span class="op" id="6448101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6448104">func</span>&nbsp;<span class="op" id="6448109">(</span><span class="ident" id="6448110">pos</span>&nbsp;<span class="ident" id="6448114">Position</span><span class="op" id="6448122">)</span>&nbsp;<span class="ident" id="6448124">String</span><span class="op" id="6448130">(</span><span class="op" id="6448131">)</span>&nbsp;<span class="builtintype" id="6448133">string</span>&nbsp;<span class="op" id="6448140">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6448143">s</span>&nbsp;<span class="op" id="6448145">:=</span>&nbsp;<span class="ident" id="6448148">pos</span><span class="op" id="6448151">.</span><span class="ident" id="6448152">Filename</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6448162">if</span>&nbsp;<span class="ident" id="6448165">pos</span><span class="op" id="6448168">.</span><span class="ident" id="6448169">IsValid</span><span class="op" id="6448176">(</span><span class="op" id="6448177">)</span>&nbsp;<span class="op" id="6448179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6448183">if</span>&nbsp;<span class="ident" id="6448186">s</span>&nbsp;<span class="op" id="6448188">!=</span>&nbsp;<span class="string" id="6448191">&#34;&#34;</span>&nbsp;<span class="op" id="6448194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6448199">s</span>&nbsp;<span class="op" id="6448201">+=</span>&nbsp;<span class="string" id="6448204">&#34;:&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6448210">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6448214">s</span>&nbsp;<span class="op" id="6448216">+=</span>&nbsp;<span class="ident" id="6448219">fmt</span><span class="op" id="6448222">.</span><span class="ident" id="6448223">Sprintf</span><span class="op" id="6448230">(</span><span class="string" id="6448231">&#34;%d:%d&#34;</span><span class="op" id="6448238">,</span>&nbsp;<span class="ident" id="6448240">pos</span><span class="op" id="6448243">.</span><span class="ident" id="6448244">Line</span><span class="op" id="6448248">,</span>&nbsp;<span class="ident" id="6448250">pos</span><span class="op" id="6448253">.</span><span class="ident" id="6448254">Column</span><span class="op" id="6448260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6448263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6448266">if</span>&nbsp;<span class="ident" id="6448269">s</span>&nbsp;<span class="op" id="6448271">==</span>&nbsp;<span class="string" id="6448274">&#34;&#34;</span>&nbsp;<span class="op" id="6448277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6448281">s</span>&nbsp;<span class="op" id="6448283">=</span>&nbsp;<span class="string" id="6448285">&#34;???&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6448292">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6448295">return</span>&nbsp;<span class="ident" id="6448302">s</span><br>
<span class="lineno"></span><span class="op" id="6448304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6448307">//&nbsp;Predefined&nbsp;mode&nbsp;bits&nbsp;to&nbsp;control&nbsp;recognition&nbsp;of&nbsp;tokens.&nbsp;For&nbsp;instance,</span><br>
<span class="lineno"></span><span class="comment" id="6448379">//&nbsp;to&nbsp;configure&nbsp;a&nbsp;Scanner&nbsp;such&nbsp;that&nbsp;it&nbsp;only&nbsp;recognizes&nbsp;(Go)&nbsp;identifiers,</span><br>
<span class="lineno">65</span><span class="comment" id="6448452">//&nbsp;integers,&nbsp;and&nbsp;skips&nbsp;comments,&nbsp;set&nbsp;the&nbsp;Scanner&#39;s&nbsp;Mode&nbsp;field&nbsp;to:</span><br>
<span class="lineno"></span><span class="comment" id="6448518">//</span><br>
<span class="lineno"></span><span class="comment" id="6448521">//&nbsp;&nbsp;&nbsp;&nbspScanIdents&nbsp;|&nbsp;ScanInts&nbsp;|&nbsp;SkipComments</span><br>
<span class="lineno"></span><span class="comment" id="6448561">//</span><br>
<span class="lineno"></span><span class="comment" id="6448564">//&nbsp;With&nbsp;the&nbsp;exceptions&nbsp;of&nbsp;comments,&nbsp;which&nbsp;are&nbsp;skipped&nbsp;if&nbsp;SkipComments&nbsp;is</span><br>
<span class="lineno">70</span><span class="comment" id="6448637">//&nbsp;set,&nbsp;unrecognized&nbsp;tokens&nbsp;are&nbsp;not&nbsp;ignored.&nbsp;Instead,&nbsp;the&nbsp;scanner&nbsp;simply</span><br>
<span class="lineno"></span><span class="comment" id="6448710">//&nbsp;returns&nbsp;the&nbsp;respective&nbsp;individual&nbsp;characters&nbsp;(or&nbsp;possibly&nbsp;sub-tokens).</span><br>
<span class="lineno"></span><span class="comment" id="6448784">//&nbsp;For&nbsp;instance,&nbsp;if&nbsp;the&nbsp;mode&nbsp;is&nbsp;ScanIdents&nbsp;(not&nbsp;ScanStrings),&nbsp;the&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="6448857">//&nbsp;&#34;foo&#34;&nbsp;is&nbsp;scanned&nbsp;as&nbsp;the&nbsp;token&nbsp;sequence&nbsp;&#39;&#34;&#39;&nbsp;Ident&nbsp;&#39;&#34;&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="6448914">//</span><br>
<span class="lineno">75</span><span class="keyword" id="6448917">const</span>&nbsp;<span class="op" id="6448923">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6448926">ScanIdents</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6448941">=</span>&nbsp;<span class="num" id="6448943">1</span>&nbsp;<span class="op" id="6448945">&lt;&lt;</span>&nbsp;<span class="op" id="6448948">-</span><span class="ident" id="6448949">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6448956">ScanInts</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6448971">=</span>&nbsp;<span class="num" id="6448973">1</span>&nbsp;<span class="op" id="6448975">&lt;&lt;</span>&nbsp;<span class="op" id="6448978">-</span><span class="ident" id="6448979">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6448984">ScanFloats</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6448999">=</span>&nbsp;<span class="num" id="6449001">1</span>&nbsp;<span class="op" id="6449003">&lt;&lt;</span>&nbsp;<span class="op" id="6449006">-</span><span class="ident" id="6449007">Float</span>&nbsp;<span class="comment" id="6449013">//&nbsp;includes&nbsp;Ints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6449031">ScanChars</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6449046">=</span>&nbsp;<span class="num" id="6449048">1</span>&nbsp;<span class="op" id="6449050">&lt;&lt;</span>&nbsp;<span class="op" id="6449053">-</span><span class="ident" id="6449054">Char</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6449060">ScanStrings</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6449075">=</span>&nbsp;<span class="num" id="6449077">1</span>&nbsp;<span class="op" id="6449079">&lt;&lt;</span>&nbsp;<span class="op" id="6449082">-</span><span class="ident" id="6449083">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6449091">ScanRawStrings</span>&nbsp;<span class="op" id="6449106">=</span>&nbsp;<span class="num" id="6449108">1</span>&nbsp;<span class="op" id="6449110">&lt;&lt;</span>&nbsp;<span class="op" id="6449113">-</span><span class="ident" id="6449114">RawString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6449125">ScanComments</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6449140">=</span>&nbsp;<span class="num" id="6449142">1</span>&nbsp;<span class="op" id="6449144">&lt;&lt;</span>&nbsp;<span class="op" id="6449147">-</span><span class="ident" id="6449148">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6449157">SkipComments</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6449172">=</span>&nbsp;<span class="num" id="6449174">1</span>&nbsp;<span class="op" id="6449176">&lt;&lt;</span>&nbsp;<span class="op" id="6449179">-</span><span class="ident" id="6449180">skipComment</span>&nbsp;<span class="comment" id="6449192">//&nbsp;if&nbsp;set&nbsp;with&nbsp;ScanComments,&nbsp;comments&nbsp;become&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6449250">GoTokens</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6449265">=</span>&nbsp;<span class="ident" id="6449267">ScanIdents</span>&nbsp;<span class="op" id="6449278">|</span>&nbsp;<span class="ident" id="6449280">ScanFloats</span>&nbsp;<span class="op" id="6449291">|</span>&nbsp;<span class="ident" id="6449293">ScanChars</span>&nbsp;<span class="op" id="6449303">|</span>&nbsp;<span class="ident" id="6449305">ScanStrings</span>&nbsp;<span class="op" id="6449317">|</span>&nbsp;<span class="ident" id="6449319">ScanRawStrings</span>&nbsp;<span class="op" id="6449334">|</span>&nbsp;<span class="ident" id="6449336">ScanComments</span>&nbsp;<span class="op" id="6449349">|</span>&nbsp;<span class="ident" id="6449351">SkipComments</span><br>
<span class="lineno">85</span><span class="op" id="6449364">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6449367">//&nbsp;The&nbsp;result&nbsp;of&nbsp;Scan&nbsp;is&nbsp;one&nbsp;of&nbsp;the&nbsp;following&nbsp;tokens&nbsp;or&nbsp;a&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="6449444">const</span>&nbsp;<span class="op" id="6449450">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6449453">EOF</span>&nbsp;<span class="op" id="6449457">=</span>&nbsp;<span class="op" id="6449459">-</span><span class="op" id="6449460">(</span><span class="ident" id="6449461">iota</span>&nbsp;<span class="op" id="6449466">+</span>&nbsp;<span class="num" id="6449468">1</span><span class="op" id="6449469">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6449472">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6449479">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6449484">Float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6449491">Char</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6449497">String</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6449505">RawString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6449516">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6449525">skipComment</span><br>
<span class="lineno"></span><span class="op" id="6449537">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="6449540">var</span>&nbsp;<span class="ident" id="6449544">tokenString</span>&nbsp;<span class="op" id="6449556">=</span>&nbsp;<span class="keyword" id="6449558">map</span><span class="op" id="6449561">[</span><span class="builtintype" id="6449562">rune</span><span class="op" id="6449566">]</span><span class="builtintype" id="6449567">string</span><span class="op" id="6449573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6449576">EOF</span><span class="op" id="6449579">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6449587">&#34;EOF&#34;</span><span class="op" id="6449592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6449595">Ident</span><span class="op" id="6449600">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6449606">&#34;Ident&#34;</span><span class="op" id="6449613">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6449616">Int</span><span class="op" id="6449619">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6449627">&#34;Int&#34;</span><span class="op" id="6449632">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6449635">Float</span><span class="op" id="6449640">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6449646">&#34;Float&#34;</span><span class="op" id="6449653">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6449656">Char</span><span class="op" id="6449660">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6449667">&#34;Char&#34;</span><span class="op" id="6449673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6449676">String</span><span class="op" id="6449682">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6449687">&#34;String&#34;</span><span class="op" id="6449695">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6449698">RawString</span><span class="op" id="6449707">:</span>&nbsp;<span class="string" id="6449709">&#34;RawString&#34;</span><span class="op" id="6449720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6449723">Comment</span><span class="op" id="6449730">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6449734">&#34;Comment&#34;</span><span class="op" id="6449743">,</span><br>
<span class="lineno"></span><span class="op" id="6449745">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="6449748">//&nbsp;TokenString&nbsp;returns&nbsp;a&nbsp;printable&nbsp;string&nbsp;for&nbsp;a&nbsp;token&nbsp;or&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="6449824">func</span>&nbsp;<span class="ident" id="6449829">TokenString</span><span class="op" id="6449840">(</span><span class="ident" id="6449841">tok</span>&nbsp;<span class="builtintype" id="6449845">rune</span><span class="op" id="6449849">)</span>&nbsp;<span class="builtintype" id="6449851">string</span>&nbsp;<span class="op" id="6449858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6449861">if</span>&nbsp;<span class="ident" id="6449864">s</span><span class="op" id="6449865">,</span>&nbsp;<span class="ident" id="6449867">found</span>&nbsp;<span class="op" id="6449873">:=</span>&nbsp;<span class="ident" id="6449876">tokenString</span><span class="op" id="6449887">[</span><span class="ident" id="6449888">tok</span><span class="op" id="6449891">]</span><span class="op" id="6449892">;</span>&nbsp;<span class="ident" id="6449894">found</span>&nbsp;<span class="op" id="6449900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6449904">return</span>&nbsp;<span class="ident" id="6449911">s</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6449914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6449917">return</span>&nbsp;<span class="ident" id="6449924">fmt</span><span class="op" id="6449927">.</span><span class="ident" id="6449928">Sprintf</span><span class="op" id="6449935">(</span><span class="string" id="6449936">&#34;%q&#34;</span><span class="op" id="6449940">,</span>&nbsp;<span class="builtintype" id="6449942">string</span><span class="op" id="6449948">(</span><span class="ident" id="6449949">tok</span><span class="op" id="6449952">)</span><span class="op" id="6449953">)</span><br>
<span class="lineno"></span><span class="op" id="6449955">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6449958">//&nbsp;GoWhitespace&nbsp;is&nbsp;the&nbsp;default&nbsp;value&nbsp;for&nbsp;the&nbsp;Scanner&#39;s&nbsp;Whitespace&nbsp;field.</span><br>
<span class="lineno">120</span><span class="comment" id="6450031">//&nbsp;Its&nbsp;value&nbsp;selects&nbsp;Go&#39;s&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno"></span><span class="keyword" id="6450081">const</span>&nbsp;<span class="ident" id="6450087">GoWhitespace</span>&nbsp;<span class="op" id="6450100">=</span>&nbsp;<span class="num" id="6450102">1</span><span class="op" id="6450103">&lt;&lt;</span><span class="string" id="6450105">&#39;\t&#39;</span>&nbsp;<span class="op" id="6450110">|</span>&nbsp;<span class="num" id="6450112">1</span><span class="op" id="6450113">&lt;&lt;</span><span class="string" id="6450115">&#39;\n&#39;</span>&nbsp;<span class="op" id="6450120">|</span>&nbsp;<span class="num" id="6450122">1</span><span class="op" id="6450123">&lt;&lt;</span><span class="string" id="6450125">&#39;\r&#39;</span>&nbsp;<span class="op" id="6450130">|</span>&nbsp;<span class="num" id="6450132">1</span><span class="op" id="6450133">&lt;&lt;</span><span class="string" id="6450135">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6450140">const</span>&nbsp;<span class="ident" id="6450146">bufLen</span>&nbsp;<span class="op" id="6450153">=</span>&nbsp;<span class="num" id="6450155">1024</span>&nbsp;<span class="comment" id="6450160">//&nbsp;at&nbsp;least&nbsp;utf8.UTFMax</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="6450185">//&nbsp;A&nbsp;Scanner&nbsp;implements&nbsp;reading&nbsp;of&nbsp;Unicode&nbsp;characters&nbsp;and&nbsp;tokens&nbsp;from&nbsp;an&nbsp;io.Reader.</span><br>
<span class="lineno"></span><span class="keyword" id="6450269">type</span>&nbsp;<span class="ident" id="6450274">Scanner</span>&nbsp;<span class="keyword" id="6450282">struct</span>&nbsp;<span class="op" id="6450289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6450292">//&nbsp;Input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6450302">src</span>&nbsp;<span class="ident" id="6450306">io</span><span class="op" id="6450308">.</span><span class="ident" id="6450309">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6450318">//&nbsp;Source&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6450336">srcBuf</span>&nbsp;<span class="op" id="6450343">[</span><span class="ident" id="6450344">bufLen</span>&nbsp;<span class="op" id="6450351">+</span>&nbsp;<span class="num" id="6450353">1</span><span class="op" id="6450354">]</span><span class="builtintype" id="6450355">byte</span>&nbsp;<span class="comment" id="6450360">//&nbsp;+1&nbsp;for&nbsp;sentinel&nbsp;for&nbsp;common&nbsp;case&nbsp;of&nbsp;s.next()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6450408">srcPos</span>&nbsp;<span class="builtintype" id="6450415">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6450432">//&nbsp;reading&nbsp;position&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6450468">srcEnd</span>&nbsp;<span class="builtintype" id="6450475">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6450492">//&nbsp;source&nbsp;end&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6450523">//&nbsp;Source&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6450543">srcBufOffset</span>&nbsp;<span class="builtintype" id="6450556">int</span>&nbsp;<span class="comment" id="6450560">//&nbsp;byte&nbsp;offset&nbsp;of&nbsp;srcBuf[0]&nbsp;in&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6450599">line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6450612">int</span>&nbsp;<span class="comment" id="6450616">//&nbsp;line&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6450631">column</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6450644">int</span>&nbsp;<span class="comment" id="6450648">//&nbsp;character&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6450668">lastLineLen</span>&nbsp;&nbsp;<span class="builtintype" id="6450681">int</span>&nbsp;<span class="comment" id="6450685">//&nbsp;length&nbsp;of&nbsp;last&nbsp;line&nbsp;in&nbsp;characters&nbsp;(for&nbsp;correct&nbsp;column&nbsp;reporting)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6450754">lastCharLen</span>&nbsp;&nbsp;<span class="builtintype" id="6450767">int</span>&nbsp;<span class="comment" id="6450771">//&nbsp;length&nbsp;of&nbsp;last&nbsp;character&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6450810">//&nbsp;Token&nbsp;text&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6450832">//&nbsp;Typically,&nbsp;token&nbsp;text&nbsp;is&nbsp;stored&nbsp;completely&nbsp;in&nbsp;srcBuf,&nbsp;but&nbsp;in&nbsp;general</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6450905">//&nbsp;the&nbsp;token&nbsp;text&#39;s&nbsp;head&nbsp;may&nbsp;be&nbsp;buffered&nbsp;in&nbsp;tokBuf&nbsp;while&nbsp;the&nbsp;token&nbsp;text&#39;s</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6450980">//&nbsp;tail&nbsp;is&nbsp;stored&nbsp;in&nbsp;srcBuf.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6451010">tokBuf</span>&nbsp;<span class="ident" id="6451017">bytes</span><span class="op" id="6451022">.</span><span class="ident" id="6451023">Buffer</span>&nbsp;<span class="comment" id="6451030">//&nbsp;token&nbsp;text&nbsp;head&nbsp;that&nbsp;is&nbsp;not&nbsp;in&nbsp;srcBuf&nbsp;anymore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6451080">tokPos</span>&nbsp;<span class="builtintype" id="6451087">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6451100">//&nbsp;token&nbsp;text&nbsp;tail&nbsp;position&nbsp;(srcBuf&nbsp;index);&nbsp;valid&nbsp;if&nbsp;&gt;=&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6451159">tokEnd</span>&nbsp;<span class="builtintype" id="6451166">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6451179">//&nbsp;token&nbsp;text&nbsp;tail&nbsp;end&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6451219">//&nbsp;One&nbsp;character&nbsp;look-ahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6451248">ch</span>&nbsp;<span class="builtintype" id="6451251">rune</span>&nbsp;<span class="comment" id="6451256">//&nbsp;character&nbsp;before&nbsp;current&nbsp;srcPos</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6451293">//&nbsp;Error&nbsp;is&nbsp;called&nbsp;for&nbsp;each&nbsp;error&nbsp;encountered.&nbsp;If&nbsp;no&nbsp;Error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6451353">//&nbsp;function&nbsp;is&nbsp;set,&nbsp;the&nbsp;error&nbsp;is&nbsp;reported&nbsp;to&nbsp;os.Stderr.</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6451410">Error</span>&nbsp;<span class="keyword" id="6451416">func</span><span class="op" id="6451420">(</span><span class="ident" id="6451421">s</span>&nbsp;<span class="op" id="6451423">*</span><span class="ident" id="6451424">Scanner</span><span class="op" id="6451431">,</span>&nbsp;<span class="ident" id="6451433">msg</span>&nbsp;<span class="builtintype" id="6451437">string</span><span class="op" id="6451443">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6451447">//&nbsp;ErrorCount&nbsp;is&nbsp;incremented&nbsp;by&nbsp;one&nbsp;for&nbsp;each&nbsp;error&nbsp;encountered.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6451512">ErrorCount</span>&nbsp;<span class="builtintype" id="6451523">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6451529">//&nbsp;The&nbsp;Mode&nbsp;field&nbsp;controls&nbsp;which&nbsp;tokens&nbsp;are&nbsp;recognized.&nbsp;For&nbsp;instance,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6451600">//&nbsp;to&nbsp;recognize&nbsp;Ints,&nbsp;set&nbsp;the&nbsp;ScanInts&nbsp;bit&nbsp;in&nbsp;Mode.&nbsp;The&nbsp;field&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6451670">//&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6451695">Mode</span>&nbsp;<span class="builtintype" id="6451700">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6451707">//&nbsp;The&nbsp;Whitespace&nbsp;field&nbsp;controls&nbsp;which&nbsp;characters&nbsp;are&nbsp;recognized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6451773">//&nbsp;as&nbsp;white&nbsp;space.&nbsp;To&nbsp;recognize&nbsp;a&nbsp;character&nbsp;ch&nbsp;&lt;=&nbsp;&#39;&nbsp;&#39;&nbsp;as&nbsp;white&nbsp;space,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6451844">//&nbsp;set&nbsp;the&nbsp;ch&#39;th&nbsp;bit&nbsp;in&nbsp;Whitespace&nbsp;(the&nbsp;Scanner&#39;s&nbsp;behavior&nbsp;is&nbsp;undefined</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6451917">//&nbsp;for&nbsp;values&nbsp;ch&nbsp;&gt;&nbsp;&#39;&nbsp;&#39;).&nbsp;The&nbsp;field&nbsp;may&nbsp;be&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6451981">Whitespace</span>&nbsp;<span class="ident" id="6451992">uint64</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6452001">//&nbsp;IsIdentRune&nbsp;is&nbsp;a&nbsp;predicate&nbsp;controlling&nbsp;the&nbsp;characters&nbsp;accepted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6452068">//&nbsp;as&nbsp;the&nbsp;ith&nbsp;rune&nbsp;in&nbsp;an&nbsp;identifier.&nbsp;The&nbsp;set&nbsp;of&nbsp;valid&nbsp;characters</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6452134">//&nbsp;must&nbsp;not&nbsp;intersect&nbsp;with&nbsp;the&nbsp;set&nbsp;of&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6452197">//&nbsp;If&nbsp;no&nbsp;IsIdentRune&nbsp;function&nbsp;is&nbsp;set,&nbsp;regular&nbsp;Go&nbsp;identifiers&nbsp;are</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6452263">//&nbsp;accepted&nbsp;instead.&nbsp;The&nbsp;field&nbsp;may&nbsp;be&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6452323">IsIdentRune</span>&nbsp;<span class="keyword" id="6452335">func</span><span class="op" id="6452339">(</span><span class="ident" id="6452340">ch</span>&nbsp;<span class="builtintype" id="6452343">rune</span><span class="op" id="6452347">,</span>&nbsp;<span class="ident" id="6452349">i</span>&nbsp;<span class="builtintype" id="6452351">int</span><span class="op" id="6452354">)</span>&nbsp;<span class="builtintype" id="6452356">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6452363">//&nbsp;Start&nbsp;position&nbsp;of&nbsp;most&nbsp;recently&nbsp;scanned&nbsp;token;&nbsp;set&nbsp;by&nbsp;Scan.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6452427">//&nbsp;Calling&nbsp;Init&nbsp;or&nbsp;Next&nbsp;invalidates&nbsp;the&nbsp;position&nbsp;(Line&nbsp;==&nbsp;0).</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6452490">//&nbsp;The&nbsp;Filename&nbsp;field&nbsp;is&nbsp;always&nbsp;left&nbsp;untouched&nbsp;by&nbsp;the&nbsp;Scanner.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6452554">//&nbsp;If&nbsp;an&nbsp;error&nbsp;is&nbsp;reported&nbsp;(via&nbsp;Error)&nbsp;and&nbsp;Position&nbsp;is&nbsp;invalid,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6452619">//&nbsp;the&nbsp;scanner&nbsp;is&nbsp;not&nbsp;inside&nbsp;a&nbsp;token.&nbsp;Call&nbsp;Pos&nbsp;to&nbsp;obtain&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6452686">//&nbsp;position&nbsp;in&nbsp;that&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6452713">Position</span><br>
<span class="lineno">185</span><span class="op" id="6452722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6452725">//&nbsp;Init&nbsp;initializes&nbsp;a&nbsp;Scanner&nbsp;with&nbsp;a&nbsp;new&nbsp;source&nbsp;and&nbsp;returns&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="6452788">//&nbsp;Error&nbsp;is&nbsp;set&nbsp;to&nbsp;nil,&nbsp;ErrorCount&nbsp;is&nbsp;set&nbsp;to&nbsp;0,&nbsp;Mode&nbsp;is&nbsp;set&nbsp;to&nbsp;GoTokens,</span><br>
<span class="lineno"></span><span class="comment" id="6452861">//&nbsp;and&nbsp;Whitespace&nbsp;is&nbsp;set&nbsp;to&nbsp;GoWhitespace.</span><br>
<span class="lineno">190</span><span class="keyword" id="6452903">func</span>&nbsp;<span class="op" id="6452908">(</span><span class="ident" id="6452909">s</span>&nbsp;<span class="op" id="6452911">*</span><span class="ident" id="6452912">Scanner</span><span class="op" id="6452919">)</span>&nbsp;<span class="ident" id="6452921">Init</span><span class="op" id="6452925">(</span><span class="ident" id="6452926">src</span>&nbsp;<span class="ident" id="6452930">io</span><span class="op" id="6452932">.</span><span class="ident" id="6452933">Reader</span><span class="op" id="6452939">)</span>&nbsp;<span class="op" id="6452941">*</span><span class="ident" id="6452942">Scanner</span>&nbsp;<span class="op" id="6452950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6452953">s</span><span class="op" id="6452954">.</span><span class="ident" id="6452955">src</span>&nbsp;<span class="op" id="6452959">=</span>&nbsp;<span class="ident" id="6452961">src</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6452967">//&nbsp;initialize&nbsp;source&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6452996">//&nbsp;(the&nbsp;first&nbsp;call&nbsp;to&nbsp;next()&nbsp;will&nbsp;fill&nbsp;it&nbsp;by&nbsp;calling&nbsp;src.Read)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6453060">s</span><span class="op" id="6453061">.</span><span class="ident" id="6453062">srcBuf</span><span class="op" id="6453068">[</span><span class="num" id="6453069">0</span><span class="op" id="6453070">]</span>&nbsp;<span class="op" id="6453072">=</span>&nbsp;<span class="ident" id="6453074">utf8</span><span class="op" id="6453078">.</span><span class="ident" id="6453079">RuneSelf</span>&nbsp;<span class="comment" id="6453088">//&nbsp;sentinel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6453101">s</span><span class="op" id="6453102">.</span><span class="ident" id="6453103">srcPos</span>&nbsp;<span class="op" id="6453110">=</span>&nbsp;<span class="num" id="6453112">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6453115">s</span><span class="op" id="6453116">.</span><span class="ident" id="6453117">srcEnd</span>&nbsp;<span class="op" id="6453124">=</span>&nbsp;<span class="num" id="6453126">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6453130">//&nbsp;initialize&nbsp;source&nbsp;position</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6453161">s</span><span class="op" id="6453162">.</span><span class="ident" id="6453163">srcBufOffset</span>&nbsp;<span class="op" id="6453176">=</span>&nbsp;<span class="num" id="6453178">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6453181">s</span><span class="op" id="6453182">.</span><span class="ident" id="6453183">line</span>&nbsp;<span class="op" id="6453188">=</span>&nbsp;<span class="num" id="6453190">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6453193">s</span><span class="op" id="6453194">.</span><span class="ident" id="6453195">column</span>&nbsp;<span class="op" id="6453202">=</span>&nbsp;<span class="num" id="6453204">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6453207">s</span><span class="op" id="6453208">.</span><span class="ident" id="6453209">lastLineLen</span>&nbsp;<span class="op" id="6453221">=</span>&nbsp;<span class="num" id="6453223">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6453226">s</span><span class="op" id="6453227">.</span><span class="ident" id="6453228">lastCharLen</span>&nbsp;<span class="op" id="6453240">=</span>&nbsp;<span class="num" id="6453242">0</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6453246">//&nbsp;initialize&nbsp;token&nbsp;text&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6453279">//&nbsp;(required&nbsp;for&nbsp;first&nbsp;call&nbsp;to&nbsp;next()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6453320">s</span><span class="op" id="6453321">.</span><span class="ident" id="6453322">tokPos</span>&nbsp;<span class="op" id="6453329">=</span>&nbsp;<span class="op" id="6453331">-</span><span class="num" id="6453332">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6453336">//&nbsp;initialize&nbsp;one&nbsp;character&nbsp;look-ahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6453376">s</span><span class="op" id="6453377">.</span><span class="ident" id="6453378">ch</span>&nbsp;<span class="op" id="6453381">=</span>&nbsp;<span class="op" id="6453383">-</span><span class="num" id="6453384">1</span>&nbsp;<span class="comment" id="6453386">//&nbsp;no&nbsp;char&nbsp;read&nbsp;yet</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6453408">//&nbsp;initialize&nbsp;public&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6453437">s</span><span class="op" id="6453438">.</span><span class="ident" id="6453439">Error</span>&nbsp;<span class="op" id="6453445">=</span>&nbsp;<span class="ident" id="6453447">nil</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6453452">s</span><span class="op" id="6453453">.</span><span class="ident" id="6453454">ErrorCount</span>&nbsp;<span class="op" id="6453465">=</span>&nbsp;<span class="num" id="6453467">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6453470">s</span><span class="op" id="6453471">.</span><span class="ident" id="6453472">Mode</span>&nbsp;<span class="op" id="6453477">=</span>&nbsp;<span class="ident" id="6453479">GoTokens</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6453489">s</span><span class="op" id="6453490">.</span><span class="ident" id="6453491">Whitespace</span>&nbsp;<span class="op" id="6453502">=</span>&nbsp;<span class="ident" id="6453504">GoWhitespace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6453518">s</span><span class="op" id="6453519">.</span><span class="ident" id="6453520">Line</span>&nbsp;<span class="op" id="6453525">=</span>&nbsp;<span class="num" id="6453527">0</span>&nbsp;<span class="comment" id="6453529">//&nbsp;invalidate&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6453560">return</span>&nbsp;<span class="ident" id="6453567">s</span><br>
<span class="lineno"></span><span class="op" id="6453569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6453572">//&nbsp;next&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character.&nbsp;It&nbsp;is&nbsp;designed&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="6453646">//&nbsp;that&nbsp;only&nbsp;a&nbsp;minimal&nbsp;amount&nbsp;of&nbsp;work&nbsp;needs&nbsp;to&nbsp;be&nbsp;done&nbsp;in&nbsp;the&nbsp;common&nbsp;ASCII</span><br>
<span class="lineno">225</span><span class="comment" id="6453721">//&nbsp;case&nbsp;(one&nbsp;test&nbsp;to&nbsp;check&nbsp;for&nbsp;both&nbsp;ASCII&nbsp;and&nbsp;end-of-buffer,&nbsp;and&nbsp;one&nbsp;test</span><br>
<span class="lineno"></span><span class="comment" id="6453795">//&nbsp;to&nbsp;check&nbsp;for&nbsp;newlines).</span><br>
<span class="lineno"></span><span class="keyword" id="6453822">func</span>&nbsp;<span class="op" id="6453827">(</span><span class="ident" id="6453828">s</span>&nbsp;<span class="op" id="6453830">*</span><span class="ident" id="6453831">Scanner</span><span class="op" id="6453838">)</span>&nbsp;<span class="ident" id="6453840">next</span><span class="op" id="6453844">(</span><span class="op" id="6453845">)</span>&nbsp;<span class="builtintype" id="6453847">rune</span>&nbsp;<span class="op" id="6453852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6453855">ch</span><span class="op" id="6453857">,</span>&nbsp;<span class="ident" id="6453859">width</span>&nbsp;<span class="op" id="6453865">:=</span>&nbsp;<span class="builtintype" id="6453868">rune</span><span class="op" id="6453872">(</span><span class="ident" id="6453873">s</span><span class="op" id="6453874">.</span><span class="ident" id="6453875">srcBuf</span><span class="op" id="6453881">[</span><span class="ident" id="6453882">s</span><span class="op" id="6453883">.</span><span class="ident" id="6453884">srcPos</span><span class="op" id="6453890">]</span><span class="op" id="6453891">)</span><span class="op" id="6453892">,</span>&nbsp;<span class="num" id="6453894">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6453898">if</span>&nbsp;<span class="ident" id="6453901">ch</span>&nbsp;<span class="op" id="6453904">&gt;=</span>&nbsp;<span class="ident" id="6453907">utf8</span><span class="op" id="6453911">.</span><span class="ident" id="6453912">RuneSelf</span>&nbsp;<span class="op" id="6453921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6453925">//&nbsp;uncommon&nbsp;case:&nbsp;not&nbsp;ASCII&nbsp;or&nbsp;not&nbsp;enough&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6453975">for</span>&nbsp;<span class="ident" id="6453979">s</span><span class="op" id="6453980">.</span><span class="ident" id="6453981">srcPos</span><span class="op" id="6453987">+</span><span class="ident" id="6453988">utf8</span><span class="op" id="6453992">.</span><span class="ident" id="6453993">UTFMax</span>&nbsp;<span class="op" id="6454000">&gt;</span>&nbsp;<span class="ident" id="6454002">s</span><span class="op" id="6454003">.</span><span class="ident" id="6454004">srcEnd</span>&nbsp;<span class="op" id="6454011">&amp;&amp;</span>&nbsp;<span class="op" id="6454014">!</span><span class="ident" id="6454015">utf8</span><span class="op" id="6454019">.</span><span class="ident" id="6454020">FullRune</span><span class="op" id="6454028">(</span><span class="ident" id="6454029">s</span><span class="op" id="6454030">.</span><span class="ident" id="6454031">srcBuf</span><span class="op" id="6454037">[</span><span class="ident" id="6454038">s</span><span class="op" id="6454039">.</span><span class="ident" id="6454040">srcPos</span><span class="op" id="6454046">:</span><span class="ident" id="6454047">s</span><span class="op" id="6454048">.</span><span class="ident" id="6454049">srcEnd</span><span class="op" id="6454055">]</span><span class="op" id="6454056">)</span>&nbsp;<span class="op" id="6454058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6454063">//&nbsp;not&nbsp;enough&nbsp;bytes:&nbsp;read&nbsp;some&nbsp;more,&nbsp;but&nbsp;first</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6454113">//&nbsp;save&nbsp;away&nbsp;token&nbsp;text&nbsp;if&nbsp;any</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6454147">if</span>&nbsp;<span class="ident" id="6454150">s</span><span class="op" id="6454151">.</span><span class="ident" id="6454152">tokPos</span>&nbsp;<span class="op" id="6454159">&gt;=</span>&nbsp;<span class="num" id="6454162">0</span>&nbsp;<span class="op" id="6454164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6454170">s</span><span class="op" id="6454171">.</span><span class="ident" id="6454172">tokBuf</span><span class="op" id="6454178">.</span><span class="ident" id="6454179">Write</span><span class="op" id="6454184">(</span><span class="ident" id="6454185">s</span><span class="op" id="6454186">.</span><span class="ident" id="6454187">srcBuf</span><span class="op" id="6454193">[</span><span class="ident" id="6454194">s</span><span class="op" id="6454195">.</span><span class="ident" id="6454196">tokPos</span><span class="op" id="6454202">:</span><span class="ident" id="6454203">s</span><span class="op" id="6454204">.</span><span class="ident" id="6454205">srcPos</span><span class="op" id="6454211">]</span><span class="op" id="6454212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6454218">s</span><span class="op" id="6454219">.</span><span class="ident" id="6454220">tokPos</span>&nbsp;<span class="op" id="6454227">=</span>&nbsp;<span class="num" id="6454229">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6454235">//&nbsp;s.tokEnd&nbsp;is&nbsp;set&nbsp;by&nbsp;Scan()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6454267">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6454272">//&nbsp;move&nbsp;unread&nbsp;bytes&nbsp;to&nbsp;beginning&nbsp;of&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6454319">copy</span><span class="op" id="6454323">(</span><span class="ident" id="6454324">s</span><span class="op" id="6454325">.</span><span class="ident" id="6454326">srcBuf</span><span class="op" id="6454332">[</span><span class="num" id="6454333">0</span><span class="op" id="6454334">:</span><span class="op" id="6454335">]</span><span class="op" id="6454336">,</span>&nbsp;<span class="ident" id="6454338">s</span><span class="op" id="6454339">.</span><span class="ident" id="6454340">srcBuf</span><span class="op" id="6454346">[</span><span class="ident" id="6454347">s</span><span class="op" id="6454348">.</span><span class="ident" id="6454349">srcPos</span><span class="op" id="6454355">:</span><span class="ident" id="6454356">s</span><span class="op" id="6454357">.</span><span class="ident" id="6454358">srcEnd</span><span class="op" id="6454364">]</span><span class="op" id="6454365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6454370">s</span><span class="op" id="6454371">.</span><span class="ident" id="6454372">srcBufOffset</span>&nbsp;<span class="op" id="6454385">+=</span>&nbsp;<span class="ident" id="6454388">s</span><span class="op" id="6454389">.</span><span class="ident" id="6454390">srcPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6454400">//&nbsp;read&nbsp;more&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6454422">//&nbsp;(an&nbsp;io.Reader&nbsp;must&nbsp;return&nbsp;io.EOF&nbsp;when&nbsp;it&nbsp;reaches</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6454477">//&nbsp;the&nbsp;end&nbsp;of&nbsp;what&nbsp;it&nbsp;is&nbsp;reading&nbsp;-&nbsp;simply&nbsp;returning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6454532">//&nbsp;n&nbsp;==&nbsp;0&nbsp;will&nbsp;make&nbsp;this&nbsp;loop&nbsp;retry&nbsp;forever;&nbsp;but&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6454588">//&nbsp;error&nbsp;is&nbsp;in&nbsp;the&nbsp;reader&nbsp;implementation&nbsp;in&nbsp;that&nbsp;case)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6454646">i</span>&nbsp;<span class="op" id="6454648">:=</span>&nbsp;<span class="ident" id="6454651">s</span><span class="op" id="6454652">.</span><span class="ident" id="6454653">srcEnd</span>&nbsp;<span class="op" id="6454660">-</span>&nbsp;<span class="ident" id="6454662">s</span><span class="op" id="6454663">.</span><span class="ident" id="6454664">srcPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6454674">n</span><span class="op" id="6454675">,</span>&nbsp;<span class="ident" id="6454677">err</span>&nbsp;<span class="op" id="6454681">:=</span>&nbsp;<span class="ident" id="6454684">s</span><span class="op" id="6454685">.</span><span class="ident" id="6454686">src</span><span class="op" id="6454689">.</span><span class="ident" id="6454690">Read</span><span class="op" id="6454694">(</span><span class="ident" id="6454695">s</span><span class="op" id="6454696">.</span><span class="ident" id="6454697">srcBuf</span><span class="op" id="6454703">[</span><span class="ident" id="6454704">i</span><span class="op" id="6454705">:</span><span class="ident" id="6454706">bufLen</span><span class="op" id="6454712">]</span><span class="op" id="6454713">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6454718">s</span><span class="op" id="6454719">.</span><span class="ident" id="6454720">srcPos</span>&nbsp;<span class="op" id="6454727">=</span>&nbsp;<span class="num" id="6454729">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6454734">s</span><span class="op" id="6454735">.</span><span class="ident" id="6454736">srcEnd</span>&nbsp;<span class="op" id="6454743">=</span>&nbsp;<span class="ident" id="6454745">i</span>&nbsp;<span class="op" id="6454747">+</span>&nbsp;<span class="ident" id="6454749">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6454754">s</span><span class="op" id="6454755">.</span><span class="ident" id="6454756">srcBuf</span><span class="op" id="6454762">[</span><span class="ident" id="6454763">s</span><span class="op" id="6454764">.</span><span class="ident" id="6454765">srcEnd</span><span class="op" id="6454771">]</span>&nbsp;<span class="op" id="6454773">=</span>&nbsp;<span class="ident" id="6454775">utf8</span><span class="op" id="6454779">.</span><span class="ident" id="6454780">RuneSelf</span>&nbsp;<span class="comment" id="6454789">//&nbsp;sentinel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6454804">if</span>&nbsp;<span class="ident" id="6454807">err</span>&nbsp;<span class="op" id="6454811">!=</span>&nbsp;<span class="ident" id="6454814">nil</span>&nbsp;<span class="op" id="6454818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6454824">if</span>&nbsp;<span class="ident" id="6454827">err</span>&nbsp;<span class="op" id="6454831">!=</span>&nbsp;<span class="ident" id="6454834">io</span><span class="op" id="6454836">.</span><span class="ident" id="6454837">EOF</span>&nbsp;<span class="op" id="6454841">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6454848">s</span><span class="op" id="6454849">.</span><span class="builtintype" id="6454850">error</span><span class="op" id="6454855">(</span><span class="ident" id="6454856">err</span><span class="op" id="6454859">.</span><span class="ident" id="6454860">Error</span><span class="op" id="6454865">(</span><span class="op" id="6454866">)</span><span class="op" id="6454867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6454873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6454879">if</span>&nbsp;<span class="ident" id="6454882">s</span><span class="op" id="6454883">.</span><span class="ident" id="6454884">srcEnd</span>&nbsp;<span class="op" id="6454891">==</span>&nbsp;<span class="num" id="6454894">0</span>&nbsp;<span class="op" id="6454896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6454903">if</span>&nbsp;<span class="ident" id="6454906">s</span><span class="op" id="6454907">.</span><span class="ident" id="6454908">lastCharLen</span>&nbsp;<span class="op" id="6454920">&gt;</span>&nbsp;<span class="num" id="6454922">0</span>&nbsp;<span class="op" id="6454924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6454932">//&nbsp;previous&nbsp;character&nbsp;was&nbsp;not&nbsp;EOF</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6454972">s</span><span class="op" id="6454973">.</span><span class="ident" id="6454974">column</span><span class="op" id="6454980">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6454988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6454995">s</span><span class="op" id="6454996">.</span><span class="ident" id="6454997">lastCharLen</span>&nbsp;<span class="op" id="6455009">=</span>&nbsp;<span class="num" id="6455011">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6455018">return</span>&nbsp;<span class="ident" id="6455025">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6455033">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6455039">//&nbsp;If&nbsp;err&nbsp;==&nbsp;EOF,&nbsp;we&nbsp;won&#39;t&nbsp;be&nbsp;getting&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6455086">//&nbsp;bytes;&nbsp;break&nbsp;to&nbsp;avoid&nbsp;infinite&nbsp;loop.&nbsp;If</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6455133">//&nbsp;err&nbsp;is&nbsp;something&nbsp;else,&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6455180">//&nbsp;we&nbsp;can&nbsp;get&nbsp;more&nbsp;bytes;&nbsp;thus&nbsp;also&nbsp;break.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6455227">break</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6455236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6455240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6455244">//&nbsp;at&nbsp;least&nbsp;one&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6455267">ch</span>&nbsp;<span class="op" id="6455270">=</span>&nbsp;<span class="builtintype" id="6455272">rune</span><span class="op" id="6455276">(</span><span class="ident" id="6455277">s</span><span class="op" id="6455278">.</span><span class="ident" id="6455279">srcBuf</span><span class="op" id="6455285">[</span><span class="ident" id="6455286">s</span><span class="op" id="6455287">.</span><span class="ident" id="6455288">srcPos</span><span class="op" id="6455294">]</span><span class="op" id="6455295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6455299">if</span>&nbsp;<span class="ident" id="6455302">ch</span>&nbsp;<span class="op" id="6455305">&gt;=</span>&nbsp;<span class="ident" id="6455308">utf8</span><span class="op" id="6455312">.</span><span class="ident" id="6455313">RuneSelf</span>&nbsp;<span class="op" id="6455322">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6455327">//&nbsp;uncommon&nbsp;case:&nbsp;not&nbsp;ASCII</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6455358">ch</span><span class="op" id="6455360">,</span>&nbsp;<span class="ident" id="6455362">width</span>&nbsp;<span class="op" id="6455368">=</span>&nbsp;<span class="ident" id="6455370">utf8</span><span class="op" id="6455374">.</span><span class="ident" id="6455375">DecodeRune</span><span class="op" id="6455385">(</span><span class="ident" id="6455386">s</span><span class="op" id="6455387">.</span><span class="ident" id="6455388">srcBuf</span><span class="op" id="6455394">[</span><span class="ident" id="6455395">s</span><span class="op" id="6455396">.</span><span class="ident" id="6455397">srcPos</span><span class="op" id="6455403">:</span><span class="ident" id="6455404">s</span><span class="op" id="6455405">.</span><span class="ident" id="6455406">srcEnd</span><span class="op" id="6455412">]</span><span class="op" id="6455413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6455418">if</span>&nbsp;<span class="ident" id="6455421">ch</span>&nbsp;<span class="op" id="6455424">==</span>&nbsp;<span class="ident" id="6455427">utf8</span><span class="op" id="6455431">.</span><span class="ident" id="6455432">RuneError</span>&nbsp;<span class="op" id="6455442">&amp;&amp;</span>&nbsp;<span class="ident" id="6455445">width</span>&nbsp;<span class="op" id="6455451">==</span>&nbsp;<span class="num" id="6455454">1</span>&nbsp;<span class="op" id="6455456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6455462">//&nbsp;advance&nbsp;for&nbsp;correct&nbsp;error&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6455504">s</span><span class="op" id="6455505">.</span><span class="ident" id="6455506">srcPos</span>&nbsp;<span class="op" id="6455513">+=</span>&nbsp;<span class="ident" id="6455516">width</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6455526">s</span><span class="op" id="6455527">.</span><span class="ident" id="6455528">lastCharLen</span>&nbsp;<span class="op" id="6455540">=</span>&nbsp;<span class="ident" id="6455542">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6455552">s</span><span class="op" id="6455553">.</span><span class="ident" id="6455554">column</span><span class="op" id="6455560">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6455567">s</span><span class="op" id="6455568">.</span><span class="builtintype" id="6455569">error</span><span class="op" id="6455574">(</span><span class="string" id="6455575">&#34;illegal&nbsp;UTF-8&nbsp;encoding&#34;</span><span class="op" id="6455599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6455605">return</span>&nbsp;<span class="ident" id="6455612">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6455618">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6455622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6455625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6455629">//&nbsp;advance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6455641">s</span><span class="op" id="6455642">.</span><span class="ident" id="6455643">srcPos</span>&nbsp;<span class="op" id="6455650">+=</span>&nbsp;<span class="ident" id="6455653">width</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6455660">s</span><span class="op" id="6455661">.</span><span class="ident" id="6455662">lastCharLen</span>&nbsp;<span class="op" id="6455674">=</span>&nbsp;<span class="ident" id="6455676">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6455683">s</span><span class="op" id="6455684">.</span><span class="ident" id="6455685">column</span><span class="op" id="6455691">++</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6455696">//&nbsp;special&nbsp;situations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6455719">switch</span>&nbsp;<span class="ident" id="6455726">ch</span>&nbsp;<span class="op" id="6455729">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6455732">case</span>&nbsp;<span class="num" id="6455737">0</span><span class="op" id="6455738">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6455742">//&nbsp;for&nbsp;compatibility&nbsp;with&nbsp;other&nbsp;tools</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6455782">s</span><span class="op" id="6455783">.</span><span class="builtintype" id="6455784">error</span><span class="op" id="6455789">(</span><span class="string" id="6455790">&#34;illegal&nbsp;character&nbsp;NUL&#34;</span><span class="op" id="6455813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6455816">case</span>&nbsp;<span class="string" id="6455821">&#39;\n&#39;</span><span class="op" id="6455825">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6455829">s</span><span class="op" id="6455830">.</span><span class="ident" id="6455831">line</span><span class="op" id="6455835">++</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6455840">s</span><span class="op" id="6455841">.</span><span class="ident" id="6455842">lastLineLen</span>&nbsp;<span class="op" id="6455854">=</span>&nbsp;<span class="ident" id="6455856">s</span><span class="op" id="6455857">.</span><span class="ident" id="6455858">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6455867">s</span><span class="op" id="6455868">.</span><span class="ident" id="6455869">column</span>&nbsp;<span class="op" id="6455876">=</span>&nbsp;<span class="num" id="6455878">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6455881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6455885">return</span>&nbsp;<span class="ident" id="6455892">ch</span><br>
<span class="lineno">305</span><span class="op" id="6455895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6455898">//&nbsp;Next&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="comment" id="6455952">//&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;source.&nbsp;It&nbsp;reports</span><br>
<span class="lineno"></span><span class="comment" id="6456007">//&nbsp;a&nbsp;read&nbsp;error&nbsp;by&nbsp;calling&nbsp;s.Error,&nbsp;if&nbsp;not&nbsp;nil;&nbsp;otherwise</span><br>
<span class="lineno">310</span><span class="comment" id="6456065">//&nbsp;it&nbsp;prints&nbsp;an&nbsp;error&nbsp;message&nbsp;to&nbsp;os.Stderr.&nbsp;Next&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="6456123">//&nbsp;update&nbsp;the&nbsp;Scanner&#39;s&nbsp;Position&nbsp;field;&nbsp;use&nbsp;Pos()&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="6456176">//&nbsp;get&nbsp;the&nbsp;current&nbsp;position.</span><br>
<span class="lineno"></span><span class="keyword" id="6456205">func</span>&nbsp;<span class="op" id="6456210">(</span><span class="ident" id="6456211">s</span>&nbsp;<span class="op" id="6456213">*</span><span class="ident" id="6456214">Scanner</span><span class="op" id="6456221">)</span>&nbsp;<span class="ident" id="6456223">Next</span><span class="op" id="6456227">(</span><span class="op" id="6456228">)</span>&nbsp;<span class="builtintype" id="6456230">rune</span>&nbsp;<span class="op" id="6456235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6456238">s</span><span class="op" id="6456239">.</span><span class="ident" id="6456240">tokPos</span>&nbsp;<span class="op" id="6456247">=</span>&nbsp;<span class="op" id="6456249">-</span><span class="num" id="6456250">1</span>&nbsp;<span class="comment" id="6456252">//&nbsp;don&#39;t&nbsp;collect&nbsp;token&nbsp;text</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6456281">s</span><span class="op" id="6456282">.</span><span class="ident" id="6456283">Line</span>&nbsp;<span class="op" id="6456288">=</span>&nbsp;<span class="num" id="6456290">0</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6456295">//&nbsp;invalidate&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6456325">ch</span>&nbsp;<span class="op" id="6456328">:=</span>&nbsp;<span class="ident" id="6456331">s</span><span class="op" id="6456332">.</span><span class="ident" id="6456333">Peek</span><span class="op" id="6456337">(</span><span class="op" id="6456338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6456341">s</span><span class="op" id="6456342">.</span><span class="ident" id="6456343">ch</span>&nbsp;<span class="op" id="6456346">=</span>&nbsp;<span class="ident" id="6456348">s</span><span class="op" id="6456349">.</span><span class="ident" id="6456350">next</span><span class="op" id="6456354">(</span><span class="op" id="6456355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6456358">return</span>&nbsp;<span class="ident" id="6456365">ch</span><br>
<span class="lineno"></span><span class="op" id="6456368">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="6456371">//&nbsp;Peek&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character&nbsp;in&nbsp;the&nbsp;source&nbsp;without&nbsp;advancing</span><br>
<span class="lineno"></span><span class="comment" id="6456446">//&nbsp;the&nbsp;scanner.&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;if&nbsp;the&nbsp;scanner&#39;s&nbsp;position&nbsp;is&nbsp;at&nbsp;the&nbsp;last</span><br>
<span class="lineno"></span><span class="comment" id="6456518">//&nbsp;character&nbsp;of&nbsp;the&nbsp;source.</span><br>
<span class="lineno"></span><span class="keyword" id="6456546">func</span>&nbsp;<span class="op" id="6456551">(</span><span class="ident" id="6456552">s</span>&nbsp;<span class="op" id="6456554">*</span><span class="ident" id="6456555">Scanner</span><span class="op" id="6456562">)</span>&nbsp;<span class="ident" id="6456564">Peek</span><span class="op" id="6456568">(</span><span class="op" id="6456569">)</span>&nbsp;<span class="builtintype" id="6456571">rune</span>&nbsp;<span class="op" id="6456576">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6456579">if</span>&nbsp;<span class="ident" id="6456582">s</span><span class="op" id="6456583">.</span><span class="ident" id="6456584">ch</span>&nbsp;<span class="op" id="6456587">&lt;</span>&nbsp;<span class="num" id="6456589">0</span>&nbsp;<span class="op" id="6456591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6456595">//&nbsp;this&nbsp;code&nbsp;is&nbsp;only&nbsp;run&nbsp;for&nbsp;the&nbsp;very&nbsp;first&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6456651">s</span><span class="op" id="6456652">.</span><span class="ident" id="6456653">ch</span>&nbsp;<span class="op" id="6456656">=</span>&nbsp;<span class="ident" id="6456658">s</span><span class="op" id="6456659">.</span><span class="ident" id="6456660">next</span><span class="op" id="6456664">(</span><span class="op" id="6456665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6456669">if</span>&nbsp;<span class="ident" id="6456672">s</span><span class="op" id="6456673">.</span><span class="ident" id="6456674">ch</span>&nbsp;<span class="op" id="6456677">==</span>&nbsp;<span class="string" id="6456680">&#39;\uFEFF&#39;</span>&nbsp;<span class="op" id="6456689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6456694">s</span><span class="op" id="6456695">.</span><span class="ident" id="6456696">ch</span>&nbsp;<span class="op" id="6456699">=</span>&nbsp;<span class="ident" id="6456701">s</span><span class="op" id="6456702">.</span><span class="ident" id="6456703">next</span><span class="op" id="6456707">(</span><span class="op" id="6456708">)</span>&nbsp;<span class="comment" id="6456710">//&nbsp;ignore&nbsp;BOM</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6456726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6456729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6456732">return</span>&nbsp;<span class="ident" id="6456739">s</span><span class="op" id="6456740">.</span><span class="ident" id="6456741">ch</span><br>
<span class="lineno"></span><span class="op" id="6456744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="6456747">func</span>&nbsp;<span class="op" id="6456752">(</span><span class="ident" id="6456753">s</span>&nbsp;<span class="op" id="6456755">*</span><span class="ident" id="6456756">Scanner</span><span class="op" id="6456763">)</span>&nbsp;<span class="builtintype" id="6456765">error</span><span class="op" id="6456770">(</span><span class="ident" id="6456771">msg</span>&nbsp;<span class="builtintype" id="6456775">string</span><span class="op" id="6456781">)</span>&nbsp;<span class="op" id="6456783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6456786">s</span><span class="op" id="6456787">.</span><span class="ident" id="6456788">ErrorCount</span><span class="op" id="6456798">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6456802">if</span>&nbsp;<span class="ident" id="6456805">s</span><span class="op" id="6456806">.</span><span class="ident" id="6456807">Error</span>&nbsp;<span class="op" id="6456813">!=</span>&nbsp;<span class="ident" id="6456816">nil</span>&nbsp;<span class="op" id="6456820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6456824">s</span><span class="op" id="6456825">.</span><span class="ident" id="6456826">Error</span><span class="op" id="6456831">(</span><span class="ident" id="6456832">s</span><span class="op" id="6456833">,</span>&nbsp;<span class="ident" id="6456835">msg</span><span class="op" id="6456838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6456842">return</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6456850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6456853">pos</span>&nbsp;<span class="op" id="6456857">:=</span>&nbsp;<span class="ident" id="6456860">s</span><span class="op" id="6456861">.</span><span class="ident" id="6456862">Position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6456872">if</span>&nbsp;<span class="op" id="6456875">!</span><span class="ident" id="6456876">pos</span><span class="op" id="6456879">.</span><span class="ident" id="6456880">IsValid</span><span class="op" id="6456887">(</span><span class="op" id="6456888">)</span>&nbsp;<span class="op" id="6456890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6456894">pos</span>&nbsp;<span class="op" id="6456898">=</span>&nbsp;<span class="ident" id="6456900">s</span><span class="op" id="6456901">.</span><span class="ident" id="6456902">Pos</span><span class="op" id="6456905">(</span><span class="op" id="6456906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6456909">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6456912">fmt</span><span class="op" id="6456915">.</span><span class="ident" id="6456916">Fprintf</span><span class="op" id="6456923">(</span><span class="ident" id="6456924">os</span><span class="op" id="6456926">.</span><span class="ident" id="6456927">Stderr</span><span class="op" id="6456933">,</span>&nbsp;<span class="string" id="6456935">&#34;%s:&nbsp;%s\n&#34;</span><span class="op" id="6456945">,</span>&nbsp;<span class="ident" id="6456947">pos</span><span class="op" id="6456950">,</span>&nbsp;<span class="ident" id="6456952">msg</span><span class="op" id="6456955">)</span><br>
<span class="lineno"></span><span class="op" id="6456957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6456960">func</span>&nbsp;<span class="op" id="6456965">(</span><span class="ident" id="6456966">s</span>&nbsp;<span class="op" id="6456968">*</span><span class="ident" id="6456969">Scanner</span><span class="op" id="6456976">)</span>&nbsp;<span class="ident" id="6456978">isIdentRune</span><span class="op" id="6456989">(</span><span class="ident" id="6456990">ch</span>&nbsp;<span class="builtintype" id="6456993">rune</span><span class="op" id="6456997">,</span>&nbsp;<span class="ident" id="6456999">i</span>&nbsp;<span class="builtintype" id="6457001">int</span><span class="op" id="6457004">)</span>&nbsp;<span class="builtintype" id="6457006">bool</span>&nbsp;<span class="op" id="6457011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457014">if</span>&nbsp;<span class="ident" id="6457017">s</span><span class="op" id="6457018">.</span><span class="ident" id="6457019">IsIdentRune</span>&nbsp;<span class="op" id="6457031">!=</span>&nbsp;<span class="ident" id="6457034">nil</span>&nbsp;<span class="op" id="6457038">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457042">return</span>&nbsp;<span class="ident" id="6457049">s</span><span class="op" id="6457050">.</span><span class="ident" id="6457051">IsIdentRune</span><span class="op" id="6457062">(</span><span class="ident" id="6457063">ch</span><span class="op" id="6457065">,</span>&nbsp;<span class="ident" id="6457067">i</span><span class="op" id="6457068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6457071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457074">return</span>&nbsp;<span class="ident" id="6457081">ch</span>&nbsp;<span class="op" id="6457084">==</span>&nbsp;<span class="string" id="6457087">&#39;_&#39;</span>&nbsp;<span class="op" id="6457091">||</span>&nbsp;<span class="ident" id="6457094">unicode</span><span class="op" id="6457101">.</span><span class="ident" id="6457102">IsLetter</span><span class="op" id="6457110">(</span><span class="ident" id="6457111">ch</span><span class="op" id="6457113">)</span>&nbsp;<span class="op" id="6457115">||</span>&nbsp;<span class="ident" id="6457118">unicode</span><span class="op" id="6457125">.</span><span class="ident" id="6457126">IsDigit</span><span class="op" id="6457133">(</span><span class="ident" id="6457134">ch</span><span class="op" id="6457136">)</span>&nbsp;<span class="op" id="6457138">&amp;&amp;</span>&nbsp;<span class="ident" id="6457141">i</span>&nbsp;<span class="op" id="6457143">&gt;</span>&nbsp;<span class="num" id="6457145">0</span><br>
<span class="lineno"></span><span class="op" id="6457147">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="keyword" id="6457150">func</span>&nbsp;<span class="op" id="6457155">(</span><span class="ident" id="6457156">s</span>&nbsp;<span class="op" id="6457158">*</span><span class="ident" id="6457159">Scanner</span><span class="op" id="6457166">)</span>&nbsp;<span class="ident" id="6457168">scanIdentifier</span><span class="op" id="6457182">(</span><span class="op" id="6457183">)</span>&nbsp;<span class="builtintype" id="6457185">rune</span>&nbsp;<span class="op" id="6457190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6457193">//&nbsp;we&nbsp;know&nbsp;the&nbsp;zero&#39;th&nbsp;rune&nbsp;is&nbsp;OK;&nbsp;start&nbsp;scanning&nbsp;at&nbsp;the&nbsp;next&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6457260">ch</span>&nbsp;<span class="op" id="6457263">:=</span>&nbsp;<span class="ident" id="6457266">s</span><span class="op" id="6457267">.</span><span class="ident" id="6457268">next</span><span class="op" id="6457272">(</span><span class="op" id="6457273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457276">for</span>&nbsp;<span class="ident" id="6457280">i</span>&nbsp;<span class="op" id="6457282">:=</span>&nbsp;<span class="num" id="6457285">1</span><span class="op" id="6457286">;</span>&nbsp;<span class="ident" id="6457288">s</span><span class="op" id="6457289">.</span><span class="ident" id="6457290">isIdentRune</span><span class="op" id="6457301">(</span><span class="ident" id="6457302">ch</span><span class="op" id="6457304">,</span>&nbsp;<span class="ident" id="6457306">i</span><span class="op" id="6457307">)</span><span class="op" id="6457308">;</span>&nbsp;<span class="ident" id="6457310">i</span><span class="op" id="6457311">++</span>&nbsp;<span class="op" id="6457314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6457318">ch</span>&nbsp;<span class="op" id="6457321">=</span>&nbsp;<span class="ident" id="6457323">s</span><span class="op" id="6457324">.</span><span class="ident" id="6457325">next</span><span class="op" id="6457329">(</span><span class="op" id="6457330">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6457333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457336">return</span>&nbsp;<span class="ident" id="6457343">ch</span><br>
<span class="lineno"></span><span class="op" id="6457346">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6457349">func</span>&nbsp;<span class="ident" id="6457354">digitVal</span><span class="op" id="6457362">(</span><span class="ident" id="6457363">ch</span>&nbsp;<span class="builtintype" id="6457366">rune</span><span class="op" id="6457370">)</span>&nbsp;<span class="builtintype" id="6457372">int</span>&nbsp;<span class="op" id="6457376">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457379">switch</span>&nbsp;<span class="op" id="6457386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457389">case</span>&nbsp;<span class="string" id="6457394">&#39;0&#39;</span>&nbsp;<span class="op" id="6457398">&lt;=</span>&nbsp;<span class="ident" id="6457401">ch</span>&nbsp;<span class="op" id="6457404">&amp;&amp;</span>&nbsp;<span class="ident" id="6457407">ch</span>&nbsp;<span class="op" id="6457410">&lt;=</span>&nbsp;<span class="string" id="6457413">&#39;9&#39;</span><span class="op" id="6457416">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457420">return</span>&nbsp;<span class="builtintype" id="6457427">int</span><span class="op" id="6457430">(</span><span class="ident" id="6457431">ch</span>&nbsp;<span class="op" id="6457434">-</span>&nbsp;<span class="string" id="6457436">&#39;0&#39;</span><span class="op" id="6457439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457442">case</span>&nbsp;<span class="string" id="6457447">&#39;a&#39;</span>&nbsp;<span class="op" id="6457451">&lt;=</span>&nbsp;<span class="ident" id="6457454">ch</span>&nbsp;<span class="op" id="6457457">&amp;&amp;</span>&nbsp;<span class="ident" id="6457460">ch</span>&nbsp;<span class="op" id="6457463">&lt;=</span>&nbsp;<span class="string" id="6457466">&#39;f&#39;</span><span class="op" id="6457469">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457473">return</span>&nbsp;<span class="builtintype" id="6457480">int</span><span class="op" id="6457483">(</span><span class="ident" id="6457484">ch</span>&nbsp;<span class="op" id="6457487">-</span>&nbsp;<span class="string" id="6457489">&#39;a&#39;</span>&nbsp;<span class="op" id="6457493">+</span>&nbsp;<span class="num" id="6457495">10</span><span class="op" id="6457497">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457500">case</span>&nbsp;<span class="string" id="6457505">&#39;A&#39;</span>&nbsp;<span class="op" id="6457509">&lt;=</span>&nbsp;<span class="ident" id="6457512">ch</span>&nbsp;<span class="op" id="6457515">&amp;&amp;</span>&nbsp;<span class="ident" id="6457518">ch</span>&nbsp;<span class="op" id="6457521">&lt;=</span>&nbsp;<span class="string" id="6457524">&#39;F&#39;</span><span class="op" id="6457527">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457531">return</span>&nbsp;<span class="builtintype" id="6457538">int</span><span class="op" id="6457541">(</span><span class="ident" id="6457542">ch</span>&nbsp;<span class="op" id="6457545">-</span>&nbsp;<span class="string" id="6457547">&#39;A&#39;</span>&nbsp;<span class="op" id="6457551">+</span>&nbsp;<span class="num" id="6457553">10</span><span class="op" id="6457555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6457558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457561">return</span>&nbsp;<span class="num" id="6457568">16</span>&nbsp;<span class="comment" id="6457571">//&nbsp;larger&nbsp;than&nbsp;any&nbsp;legal&nbsp;digit&nbsp;val</span><br>
<span class="lineno"></span><span class="op" id="6457606">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span><span class="keyword" id="6457609">func</span>&nbsp;<span class="ident" id="6457614">isDecimal</span><span class="op" id="6457623">(</span><span class="ident" id="6457624">ch</span>&nbsp;<span class="builtintype" id="6457627">rune</span><span class="op" id="6457631">)</span>&nbsp;<span class="builtintype" id="6457633">bool</span>&nbsp;<span class="op" id="6457638">{</span>&nbsp;<span class="keyword" id="6457640">return</span>&nbsp;<span class="string" id="6457647">&#39;0&#39;</span>&nbsp;<span class="op" id="6457651">&lt;=</span>&nbsp;<span class="ident" id="6457654">ch</span>&nbsp;<span class="op" id="6457657">&amp;&amp;</span>&nbsp;<span class="ident" id="6457660">ch</span>&nbsp;<span class="op" id="6457663">&lt;=</span>&nbsp;<span class="string" id="6457666">&#39;9&#39;</span>&nbsp;<span class="op" id="6457670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6457673">func</span>&nbsp;<span class="op" id="6457678">(</span><span class="ident" id="6457679">s</span>&nbsp;<span class="op" id="6457681">*</span><span class="ident" id="6457682">Scanner</span><span class="op" id="6457689">)</span>&nbsp;<span class="ident" id="6457691">scanMantissa</span><span class="op" id="6457703">(</span><span class="ident" id="6457704">ch</span>&nbsp;<span class="builtintype" id="6457707">rune</span><span class="op" id="6457711">)</span>&nbsp;<span class="builtintype" id="6457713">rune</span>&nbsp;<span class="op" id="6457718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457721">for</span>&nbsp;<span class="ident" id="6457725">isDecimal</span><span class="op" id="6457734">(</span><span class="ident" id="6457735">ch</span><span class="op" id="6457737">)</span>&nbsp;<span class="op" id="6457739">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6457743">ch</span>&nbsp;<span class="op" id="6457746">=</span>&nbsp;<span class="ident" id="6457748">s</span><span class="op" id="6457749">.</span><span class="ident" id="6457750">next</span><span class="op" id="6457754">(</span><span class="op" id="6457755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6457758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457761">return</span>&nbsp;<span class="ident" id="6457768">ch</span><br>
<span class="lineno"></span><span class="op" id="6457771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="6457774">func</span>&nbsp;<span class="op" id="6457779">(</span><span class="ident" id="6457780">s</span>&nbsp;<span class="op" id="6457782">*</span><span class="ident" id="6457783">Scanner</span><span class="op" id="6457790">)</span>&nbsp;<span class="ident" id="6457792">scanFraction</span><span class="op" id="6457804">(</span><span class="ident" id="6457805">ch</span>&nbsp;<span class="builtintype" id="6457808">rune</span><span class="op" id="6457812">)</span>&nbsp;<span class="builtintype" id="6457814">rune</span>&nbsp;<span class="op" id="6457819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457822">if</span>&nbsp;<span class="ident" id="6457825">ch</span>&nbsp;<span class="op" id="6457828">==</span>&nbsp;<span class="string" id="6457831">&#39;.&#39;</span>&nbsp;<span class="op" id="6457835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6457839">ch</span>&nbsp;<span class="op" id="6457842">=</span>&nbsp;<span class="ident" id="6457844">s</span><span class="op" id="6457845">.</span><span class="ident" id="6457846">scanMantissa</span><span class="op" id="6457858">(</span><span class="ident" id="6457859">s</span><span class="op" id="6457860">.</span><span class="ident" id="6457861">next</span><span class="op" id="6457865">(</span><span class="op" id="6457866">)</span><span class="op" id="6457867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6457870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457873">return</span>&nbsp;<span class="ident" id="6457880">ch</span><br>
<span class="lineno">390</span><span class="op" id="6457883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6457886">func</span>&nbsp;<span class="op" id="6457891">(</span><span class="ident" id="6457892">s</span>&nbsp;<span class="op" id="6457894">*</span><span class="ident" id="6457895">Scanner</span><span class="op" id="6457902">)</span>&nbsp;<span class="ident" id="6457904">scanExponent</span><span class="op" id="6457916">(</span><span class="ident" id="6457917">ch</span>&nbsp;<span class="builtintype" id="6457920">rune</span><span class="op" id="6457924">)</span>&nbsp;<span class="builtintype" id="6457926">rune</span>&nbsp;<span class="op" id="6457931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457934">if</span>&nbsp;<span class="ident" id="6457937">ch</span>&nbsp;<span class="op" id="6457940">==</span>&nbsp;<span class="string" id="6457943">&#39;e&#39;</span>&nbsp;<span class="op" id="6457947">||</span>&nbsp;<span class="ident" id="6457950">ch</span>&nbsp;<span class="op" id="6457953">==</span>&nbsp;<span class="string" id="6457956">&#39;E&#39;</span>&nbsp;<span class="op" id="6457960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6457964">ch</span>&nbsp;<span class="op" id="6457967">=</span>&nbsp;<span class="ident" id="6457969">s</span><span class="op" id="6457970">.</span><span class="ident" id="6457971">next</span><span class="op" id="6457975">(</span><span class="op" id="6457976">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6457980">if</span>&nbsp;<span class="ident" id="6457983">ch</span>&nbsp;<span class="op" id="6457986">==</span>&nbsp;<span class="string" id="6457989">&#39;-&#39;</span>&nbsp;<span class="op" id="6457993">||</span>&nbsp;<span class="ident" id="6457996">ch</span>&nbsp;<span class="op" id="6457999">==</span>&nbsp;<span class="string" id="6458002">&#39;+&#39;</span>&nbsp;<span class="op" id="6458006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6458011">ch</span>&nbsp;<span class="op" id="6458014">=</span>&nbsp;<span class="ident" id="6458016">s</span><span class="op" id="6458017">.</span><span class="ident" id="6458018">next</span><span class="op" id="6458022">(</span><span class="op" id="6458023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6458027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6458031">ch</span>&nbsp;<span class="op" id="6458034">=</span>&nbsp;<span class="ident" id="6458036">s</span><span class="op" id="6458037">.</span><span class="ident" id="6458038">scanMantissa</span><span class="op" id="6458050">(</span><span class="ident" id="6458051">ch</span><span class="op" id="6458053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6458056">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6458059">return</span>&nbsp;<span class="ident" id="6458066">ch</span><br>
<span class="lineno"></span><span class="op" id="6458069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6458072">func</span>&nbsp;<span class="op" id="6458077">(</span><span class="ident" id="6458078">s</span>&nbsp;<span class="op" id="6458080">*</span><span class="ident" id="6458081">Scanner</span><span class="op" id="6458088">)</span>&nbsp;<span class="ident" id="6458090">scanNumber</span><span class="op" id="6458100">(</span><span class="ident" id="6458101">ch</span>&nbsp;<span class="builtintype" id="6458104">rune</span><span class="op" id="6458108">)</span>&nbsp;<span class="op" id="6458110">(</span><span class="builtintype" id="6458111">rune</span><span class="op" id="6458115">,</span>&nbsp;<span class="builtintype" id="6458117">rune</span><span class="op" id="6458121">)</span>&nbsp;<span class="op" id="6458123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6458126">//&nbsp;isDecimal(ch)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6458144">if</span>&nbsp;<span class="ident" id="6458147">ch</span>&nbsp;<span class="op" id="6458150">==</span>&nbsp;<span class="string" id="6458153">&#39;0&#39;</span>&nbsp;<span class="op" id="6458157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6458161">//&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6458179">ch</span>&nbsp;<span class="op" id="6458182">=</span>&nbsp;<span class="ident" id="6458184">s</span><span class="op" id="6458185">.</span><span class="ident" id="6458186">next</span><span class="op" id="6458190">(</span><span class="op" id="6458191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6458195">if</span>&nbsp;<span class="ident" id="6458198">ch</span>&nbsp;<span class="op" id="6458201">==</span>&nbsp;<span class="string" id="6458204">&#39;x&#39;</span>&nbsp;<span class="op" id="6458208">||</span>&nbsp;<span class="ident" id="6458211">ch</span>&nbsp;<span class="op" id="6458214">==</span>&nbsp;<span class="string" id="6458217">&#39;X&#39;</span>&nbsp;<span class="op" id="6458221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6458226">//&nbsp;hexadecimal&nbsp;int</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6458248">ch</span>&nbsp;<span class="op" id="6458251">=</span>&nbsp;<span class="ident" id="6458253">s</span><span class="op" id="6458254">.</span><span class="ident" id="6458255">next</span><span class="op" id="6458259">(</span><span class="op" id="6458260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6458265">hasMantissa</span>&nbsp;<span class="op" id="6458277">:=</span>&nbsp;<span class="builtintype" id="6458280">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6458289">for</span>&nbsp;<span class="ident" id="6458293">digitVal</span><span class="op" id="6458301">(</span><span class="ident" id="6458302">ch</span><span class="op" id="6458304">)</span>&nbsp;<span class="op" id="6458306">&lt;</span>&nbsp;<span class="num" id="6458308">16</span>&nbsp;<span class="op" id="6458311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6458317">ch</span>&nbsp;<span class="op" id="6458320">=</span>&nbsp;<span class="ident" id="6458322">s</span><span class="op" id="6458323">.</span><span class="ident" id="6458324">next</span><span class="op" id="6458328">(</span><span class="op" id="6458329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6458335">hasMantissa</span>&nbsp;<span class="op" id="6458347">=</span>&nbsp;<span class="builtintype" id="6458349">true</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6458357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6458362">if</span>&nbsp;<span class="op" id="6458365">!</span><span class="ident" id="6458366">hasMantissa</span>&nbsp;<span class="op" id="6458378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6458384">s</span><span class="op" id="6458385">.</span><span class="builtintype" id="6458386">error</span><span class="op" id="6458391">(</span><span class="string" id="6458392">&#34;illegal&nbsp;hexadecimal&nbsp;number&#34;</span><span class="op" id="6458420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6458425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6458429">}</span>&nbsp;<span class="keyword" id="6458431">else</span>&nbsp;<span class="op" id="6458436">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6458441">//&nbsp;octal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6458466">has8or9</span>&nbsp;<span class="op" id="6458474">:=</span>&nbsp;<span class="builtintype" id="6458477">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6458486">for</span>&nbsp;<span class="ident" id="6458490">isDecimal</span><span class="op" id="6458499">(</span><span class="ident" id="6458500">ch</span><span class="op" id="6458502">)</span>&nbsp;<span class="op" id="6458504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6458510">if</span>&nbsp;<span class="ident" id="6458513">ch</span>&nbsp;<span class="op" id="6458516">&gt;</span>&nbsp;<span class="string" id="6458518">&#39;7&#39;</span>&nbsp;<span class="op" id="6458522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6458529">has8or9</span>&nbsp;<span class="op" id="6458537">=</span>&nbsp;<span class="builtintype" id="6458539">true</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6458548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6458554">ch</span>&nbsp;<span class="op" id="6458557">=</span>&nbsp;<span class="ident" id="6458559">s</span><span class="op" id="6458560">.</span><span class="ident" id="6458561">next</span><span class="op" id="6458565">(</span><span class="op" id="6458566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6458571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6458576">if</span>&nbsp;<span class="ident" id="6458579">s</span><span class="op" id="6458580">.</span><span class="ident" id="6458581">Mode</span><span class="op" id="6458585">&amp;</span><span class="ident" id="6458586">ScanFloats</span>&nbsp;<span class="op" id="6458597">!=</span>&nbsp;<span class="num" id="6458600">0</span>&nbsp;<span class="op" id="6458602">&amp;&amp;</span>&nbsp;<span class="op" id="6458605">(</span><span class="ident" id="6458606">ch</span>&nbsp;<span class="op" id="6458609">==</span>&nbsp;<span class="string" id="6458612">&#39;.&#39;</span>&nbsp;<span class="op" id="6458616">||</span>&nbsp;<span class="ident" id="6458619">ch</span>&nbsp;<span class="op" id="6458622">==</span>&nbsp;<span class="string" id="6458625">&#39;e&#39;</span>&nbsp;<span class="op" id="6458629">||</span>&nbsp;<span class="ident" id="6458632">ch</span>&nbsp;<span class="op" id="6458635">==</span>&nbsp;<span class="string" id="6458638">&#39;E&#39;</span><span class="op" id="6458641">)</span>&nbsp;<span class="op" id="6458643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6458649">//&nbsp;float</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6458662">ch</span>&nbsp;<span class="op" id="6458665">=</span>&nbsp;<span class="ident" id="6458667">s</span><span class="op" id="6458668">.</span><span class="ident" id="6458669">scanFraction</span><span class="op" id="6458681">(</span><span class="ident" id="6458682">ch</span><span class="op" id="6458684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6458690">ch</span>&nbsp;<span class="op" id="6458693">=</span>&nbsp;<span class="ident" id="6458695">s</span><span class="op" id="6458696">.</span><span class="ident" id="6458697">scanExponent</span><span class="op" id="6458709">(</span><span class="ident" id="6458710">ch</span><span class="op" id="6458712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6458718">return</span>&nbsp;<span class="ident" id="6458725">Float</span><span class="op" id="6458730">,</span>&nbsp;<span class="ident" id="6458732">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6458738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6458743">//&nbsp;octal&nbsp;int</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6458759">if</span>&nbsp;<span class="ident" id="6458762">has8or9</span>&nbsp;<span class="op" id="6458770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6458776">s</span><span class="op" id="6458777">.</span><span class="builtintype" id="6458778">error</span><span class="op" id="6458783">(</span><span class="string" id="6458784">&#34;illegal&nbsp;octal&nbsp;number&#34;</span><span class="op" id="6458806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6458811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6458815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6458819">return</span>&nbsp;<span class="ident" id="6458826">Int</span><span class="op" id="6458829">,</span>&nbsp;<span class="ident" id="6458831">ch</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6458835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6458838">//&nbsp;decimal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6458863">ch</span>&nbsp;<span class="op" id="6458866">=</span>&nbsp;<span class="ident" id="6458868">s</span><span class="op" id="6458869">.</span><span class="ident" id="6458870">scanMantissa</span><span class="op" id="6458882">(</span><span class="ident" id="6458883">ch</span><span class="op" id="6458885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6458888">if</span>&nbsp;<span class="ident" id="6458891">s</span><span class="op" id="6458892">.</span><span class="ident" id="6458893">Mode</span><span class="op" id="6458897">&amp;</span><span class="ident" id="6458898">ScanFloats</span>&nbsp;<span class="op" id="6458909">!=</span>&nbsp;<span class="num" id="6458912">0</span>&nbsp;<span class="op" id="6458914">&amp;&amp;</span>&nbsp;<span class="op" id="6458917">(</span><span class="ident" id="6458918">ch</span>&nbsp;<span class="op" id="6458921">==</span>&nbsp;<span class="string" id="6458924">&#39;.&#39;</span>&nbsp;<span class="op" id="6458928">||</span>&nbsp;<span class="ident" id="6458931">ch</span>&nbsp;<span class="op" id="6458934">==</span>&nbsp;<span class="string" id="6458937">&#39;e&#39;</span>&nbsp;<span class="op" id="6458941">||</span>&nbsp;<span class="ident" id="6458944">ch</span>&nbsp;<span class="op" id="6458947">==</span>&nbsp;<span class="string" id="6458950">&#39;E&#39;</span><span class="op" id="6458953">)</span>&nbsp;<span class="op" id="6458955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6458959">//&nbsp;float</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6458970">ch</span>&nbsp;<span class="op" id="6458973">=</span>&nbsp;<span class="ident" id="6458975">s</span><span class="op" id="6458976">.</span><span class="ident" id="6458977">scanFraction</span><span class="op" id="6458989">(</span><span class="ident" id="6458990">ch</span><span class="op" id="6458992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6458996">ch</span>&nbsp;<span class="op" id="6458999">=</span>&nbsp;<span class="ident" id="6459001">s</span><span class="op" id="6459002">.</span><span class="ident" id="6459003">scanExponent</span><span class="op" id="6459015">(</span><span class="ident" id="6459016">ch</span><span class="op" id="6459018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6459022">return</span>&nbsp;<span class="ident" id="6459029">Float</span><span class="op" id="6459034">,</span>&nbsp;<span class="ident" id="6459036">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6459040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6459043">return</span>&nbsp;<span class="ident" id="6459050">Int</span><span class="op" id="6459053">,</span>&nbsp;<span class="ident" id="6459055">ch</span><br>
<span class="lineno">450</span><span class="op" id="6459058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6459061">func</span>&nbsp;<span class="op" id="6459066">(</span><span class="ident" id="6459067">s</span>&nbsp;<span class="op" id="6459069">*</span><span class="ident" id="6459070">Scanner</span><span class="op" id="6459077">)</span>&nbsp;<span class="ident" id="6459079">scanDigits</span><span class="op" id="6459089">(</span><span class="ident" id="6459090">ch</span>&nbsp;<span class="builtintype" id="6459093">rune</span><span class="op" id="6459097">,</span>&nbsp;<span class="ident" id="6459099">base</span><span class="op" id="6459103">,</span>&nbsp;<span class="ident" id="6459105">n</span>&nbsp;<span class="builtintype" id="6459107">int</span><span class="op" id="6459110">)</span>&nbsp;<span class="builtintype" id="6459112">rune</span>&nbsp;<span class="op" id="6459117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6459120">for</span>&nbsp;<span class="ident" id="6459124">n</span>&nbsp;<span class="op" id="6459126">&gt;</span>&nbsp;<span class="num" id="6459128">0</span>&nbsp;<span class="op" id="6459130">&amp;&amp;</span>&nbsp;<span class="ident" id="6459133">digitVal</span><span class="op" id="6459141">(</span><span class="ident" id="6459142">ch</span><span class="op" id="6459144">)</span>&nbsp;<span class="op" id="6459146">&lt;</span>&nbsp;<span class="ident" id="6459148">base</span>&nbsp;<span class="op" id="6459153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6459157">ch</span>&nbsp;<span class="op" id="6459160">=</span>&nbsp;<span class="ident" id="6459162">s</span><span class="op" id="6459163">.</span><span class="ident" id="6459164">next</span><span class="op" id="6459168">(</span><span class="op" id="6459169">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6459173">n</span><span class="op" id="6459174">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6459178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6459181">if</span>&nbsp;<span class="ident" id="6459184">n</span>&nbsp;<span class="op" id="6459186">&gt;</span>&nbsp;<span class="num" id="6459188">0</span>&nbsp;<span class="op" id="6459190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6459194">s</span><span class="op" id="6459195">.</span><span class="builtintype" id="6459196">error</span><span class="op" id="6459201">(</span><span class="string" id="6459202">&#34;illegal&nbsp;char&nbsp;escape&#34;</span><span class="op" id="6459223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6459226">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6459229">return</span>&nbsp;<span class="ident" id="6459236">ch</span><br>
<span class="lineno"></span><span class="op" id="6459239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6459242">func</span>&nbsp;<span class="op" id="6459247">(</span><span class="ident" id="6459248">s</span>&nbsp;<span class="op" id="6459250">*</span><span class="ident" id="6459251">Scanner</span><span class="op" id="6459258">)</span>&nbsp;<span class="ident" id="6459260">scanEscape</span><span class="op" id="6459270">(</span><span class="ident" id="6459271">quote</span>&nbsp;<span class="builtintype" id="6459277">rune</span><span class="op" id="6459281">)</span>&nbsp;<span class="builtintype" id="6459283">rune</span>&nbsp;<span class="op" id="6459288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6459291">ch</span>&nbsp;<span class="op" id="6459294">:=</span>&nbsp;<span class="ident" id="6459297">s</span><span class="op" id="6459298">.</span><span class="ident" id="6459299">next</span><span class="op" id="6459303">(</span><span class="op" id="6459304">)</span>&nbsp;<span class="comment" id="6459306">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#39;/&#39;</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6459335">switch</span>&nbsp;<span class="ident" id="6459342">ch</span>&nbsp;<span class="op" id="6459345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6459348">case</span>&nbsp;<span class="string" id="6459353">&#39;a&#39;</span><span class="op" id="6459356">,</span>&nbsp;<span class="string" id="6459358">&#39;b&#39;</span><span class="op" id="6459361">,</span>&nbsp;<span class="string" id="6459363">&#39;f&#39;</span><span class="op" id="6459366">,</span>&nbsp;<span class="string" id="6459368">&#39;n&#39;</span><span class="op" id="6459371">,</span>&nbsp;<span class="string" id="6459373">&#39;r&#39;</span><span class="op" id="6459376">,</span>&nbsp;<span class="string" id="6459378">&#39;t&#39;</span><span class="op" id="6459381">,</span>&nbsp;<span class="string" id="6459383">&#39;v&#39;</span><span class="op" id="6459386">,</span>&nbsp;<span class="string" id="6459388">&#39;\\&#39;</span><span class="op" id="6459392">,</span>&nbsp;<span class="ident" id="6459394">quote</span><span class="op" id="6459399">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6459403">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6459422">ch</span>&nbsp;<span class="op" id="6459425">=</span>&nbsp;<span class="ident" id="6459427">s</span><span class="op" id="6459428">.</span><span class="ident" id="6459429">next</span><span class="op" id="6459433">(</span><span class="op" id="6459434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6459437">case</span>&nbsp;<span class="string" id="6459442">&#39;0&#39;</span><span class="op" id="6459445">,</span>&nbsp;<span class="string" id="6459447">&#39;1&#39;</span><span class="op" id="6459450">,</span>&nbsp;<span class="string" id="6459452">&#39;2&#39;</span><span class="op" id="6459455">,</span>&nbsp;<span class="string" id="6459457">&#39;3&#39;</span><span class="op" id="6459460">,</span>&nbsp;<span class="string" id="6459462">&#39;4&#39;</span><span class="op" id="6459465">,</span>&nbsp;<span class="string" id="6459467">&#39;5&#39;</span><span class="op" id="6459470">,</span>&nbsp;<span class="string" id="6459472">&#39;6&#39;</span><span class="op" id="6459475">,</span>&nbsp;<span class="string" id="6459477">&#39;7&#39;</span><span class="op" id="6459480">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6459484">ch</span>&nbsp;<span class="op" id="6459487">=</span>&nbsp;<span class="ident" id="6459489">s</span><span class="op" id="6459490">.</span><span class="ident" id="6459491">scanDigits</span><span class="op" id="6459501">(</span><span class="ident" id="6459502">ch</span><span class="op" id="6459504">,</span>&nbsp;<span class="num" id="6459506">8</span><span class="op" id="6459507">,</span>&nbsp;<span class="num" id="6459509">3</span><span class="op" id="6459510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6459513">case</span>&nbsp;<span class="string" id="6459518">&#39;x&#39;</span><span class="op" id="6459521">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6459525">ch</span>&nbsp;<span class="op" id="6459528">=</span>&nbsp;<span class="ident" id="6459530">s</span><span class="op" id="6459531">.</span><span class="ident" id="6459532">scanDigits</span><span class="op" id="6459542">(</span><span class="ident" id="6459543">s</span><span class="op" id="6459544">.</span><span class="ident" id="6459545">next</span><span class="op" id="6459549">(</span><span class="op" id="6459550">)</span><span class="op" id="6459551">,</span>&nbsp;<span class="num" id="6459553">16</span><span class="op" id="6459555">,</span>&nbsp;<span class="num" id="6459557">2</span><span class="op" id="6459558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6459561">case</span>&nbsp;<span class="string" id="6459566">&#39;u&#39;</span><span class="op" id="6459569">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6459573">ch</span>&nbsp;<span class="op" id="6459576">=</span>&nbsp;<span class="ident" id="6459578">s</span><span class="op" id="6459579">.</span><span class="ident" id="6459580">scanDigits</span><span class="op" id="6459590">(</span><span class="ident" id="6459591">s</span><span class="op" id="6459592">.</span><span class="ident" id="6459593">next</span><span class="op" id="6459597">(</span><span class="op" id="6459598">)</span><span class="op" id="6459599">,</span>&nbsp;<span class="num" id="6459601">16</span><span class="op" id="6459603">,</span>&nbsp;<span class="num" id="6459605">4</span><span class="op" id="6459606">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6459609">case</span>&nbsp;<span class="string" id="6459614">&#39;U&#39;</span><span class="op" id="6459617">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6459621">ch</span>&nbsp;<span class="op" id="6459624">=</span>&nbsp;<span class="ident" id="6459626">s</span><span class="op" id="6459627">.</span><span class="ident" id="6459628">scanDigits</span><span class="op" id="6459638">(</span><span class="ident" id="6459639">s</span><span class="op" id="6459640">.</span><span class="ident" id="6459641">next</span><span class="op" id="6459645">(</span><span class="op" id="6459646">)</span><span class="op" id="6459647">,</span>&nbsp;<span class="num" id="6459649">16</span><span class="op" id="6459651">,</span>&nbsp;<span class="num" id="6459653">8</span><span class="op" id="6459654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6459657">default</span><span class="op" id="6459664">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6459668">s</span><span class="op" id="6459669">.</span><span class="builtintype" id="6459670">error</span><span class="op" id="6459675">(</span><span class="string" id="6459676">&#34;illegal&nbsp;char&nbsp;escape&#34;</span><span class="op" id="6459697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6459700">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6459703">return</span>&nbsp;<span class="ident" id="6459710">ch</span><br>
<span class="lineno"></span><span class="op" id="6459713">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6459716">func</span>&nbsp;<span class="op" id="6459721">(</span><span class="ident" id="6459722">s</span>&nbsp;<span class="op" id="6459724">*</span><span class="ident" id="6459725">Scanner</span><span class="op" id="6459732">)</span>&nbsp;<span class="ident" id="6459734">scanString</span><span class="op" id="6459744">(</span><span class="ident" id="6459745">quote</span>&nbsp;<span class="builtintype" id="6459751">rune</span><span class="op" id="6459755">)</span>&nbsp;<span class="op" id="6459757">(</span><span class="ident" id="6459758">n</span>&nbsp;<span class="builtintype" id="6459760">int</span><span class="op" id="6459763">)</span>&nbsp;<span class="op" id="6459765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6459768">ch</span>&nbsp;<span class="op" id="6459771">:=</span>&nbsp;<span class="ident" id="6459774">s</span><span class="op" id="6459775">.</span><span class="ident" id="6459776">next</span><span class="op" id="6459780">(</span><span class="op" id="6459781">)</span>&nbsp;<span class="comment" id="6459783">//&nbsp;read&nbsp;character&nbsp;after&nbsp;quote</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6459814">for</span>&nbsp;<span class="ident" id="6459818">ch</span>&nbsp;<span class="op" id="6459821">!=</span>&nbsp;<span class="ident" id="6459824">quote</span>&nbsp;<span class="op" id="6459830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6459834">if</span>&nbsp;<span class="ident" id="6459837">ch</span>&nbsp;<span class="op" id="6459840">==</span>&nbsp;<span class="string" id="6459843">&#39;\n&#39;</span>&nbsp;<span class="op" id="6459848">||</span>&nbsp;<span class="ident" id="6459851">ch</span>&nbsp;<span class="op" id="6459854">&lt;</span>&nbsp;<span class="num" id="6459856">0</span>&nbsp;<span class="op" id="6459858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6459863">s</span><span class="op" id="6459864">.</span><span class="builtintype" id="6459865">error</span><span class="op" id="6459870">(</span><span class="string" id="6459871">&#34;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="6459895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6459900">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6459909">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6459913">if</span>&nbsp;<span class="ident" id="6459916">ch</span>&nbsp;<span class="op" id="6459919">==</span>&nbsp;<span class="string" id="6459922">&#39;\\&#39;</span>&nbsp;<span class="op" id="6459927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6459932">ch</span>&nbsp;<span class="op" id="6459935">=</span>&nbsp;<span class="ident" id="6459937">s</span><span class="op" id="6459938">.</span><span class="ident" id="6459939">scanEscape</span><span class="op" id="6459949">(</span><span class="ident" id="6459950">quote</span><span class="op" id="6459955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6459959">}</span>&nbsp;<span class="keyword" id="6459961">else</span>&nbsp;<span class="op" id="6459966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6459971">ch</span>&nbsp;<span class="op" id="6459974">=</span>&nbsp;<span class="ident" id="6459976">s</span><span class="op" id="6459977">.</span><span class="ident" id="6459978">next</span><span class="op" id="6459982">(</span><span class="op" id="6459983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6459987">}</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6459991">n</span><span class="op" id="6459992">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6459996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6459999">return</span><br>
<span class="lineno"></span><span class="op" id="6460006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span><span class="keyword" id="6460009">func</span>&nbsp;<span class="op" id="6460014">(</span><span class="ident" id="6460015">s</span>&nbsp;<span class="op" id="6460017">*</span><span class="ident" id="6460018">Scanner</span><span class="op" id="6460025">)</span>&nbsp;<span class="ident" id="6460027">scanRawString</span><span class="op" id="6460040">(</span><span class="op" id="6460041">)</span>&nbsp;<span class="op" id="6460043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6460046">ch</span>&nbsp;<span class="op" id="6460049">:=</span>&nbsp;<span class="ident" id="6460052">s</span><span class="op" id="6460053">.</span><span class="ident" id="6460054">next</span><span class="op" id="6460058">(</span><span class="op" id="6460059">)</span>&nbsp;<span class="comment" id="6460061">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#39;`&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6460090">for</span>&nbsp;<span class="ident" id="6460094">ch</span>&nbsp;<span class="op" id="6460097">!=</span>&nbsp;<span class="string" id="6460100">&#39;`&#39;</span>&nbsp;<span class="op" id="6460104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6460108">if</span>&nbsp;<span class="ident" id="6460111">ch</span>&nbsp;<span class="op" id="6460114">&lt;</span>&nbsp;<span class="num" id="6460116">0</span>&nbsp;<span class="op" id="6460118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6460123">s</span><span class="op" id="6460124">.</span><span class="builtintype" id="6460125">error</span><span class="op" id="6460130">(</span><span class="string" id="6460131">&#34;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="6460155">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6460160">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6460169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6460173">ch</span>&nbsp;<span class="op" id="6460176">=</span>&nbsp;<span class="ident" id="6460178">s</span><span class="op" id="6460179">.</span><span class="ident" id="6460180">next</span><span class="op" id="6460184">(</span><span class="op" id="6460185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6460188">}</span><br>
<span class="lineno"></span><span class="op" id="6460190">}</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span><span class="keyword" id="6460193">func</span>&nbsp;<span class="op" id="6460198">(</span><span class="ident" id="6460199">s</span>&nbsp;<span class="op" id="6460201">*</span><span class="ident" id="6460202">Scanner</span><span class="op" id="6460209">)</span>&nbsp;<span class="ident" id="6460211">scanChar</span><span class="op" id="6460219">(</span><span class="op" id="6460220">)</span>&nbsp;<span class="op" id="6460222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6460225">if</span>&nbsp;<span class="ident" id="6460228">s</span><span class="op" id="6460229">.</span><span class="ident" id="6460230">scanString</span><span class="op" id="6460240">(</span><span class="string" id="6460241">&#39;\&#39;&#39;</span><span class="op" id="6460245">)</span>&nbsp;<span class="op" id="6460247">!=</span>&nbsp;<span class="num" id="6460250">1</span>&nbsp;<span class="op" id="6460252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6460256">s</span><span class="op" id="6460257">.</span><span class="builtintype" id="6460258">error</span><span class="op" id="6460263">(</span><span class="string" id="6460264">&#34;illegal&nbsp;char&nbsp;literal&#34;</span><span class="op" id="6460286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6460289">}</span><br>
<span class="lineno">515</span><span class="op" id="6460291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6460294">func</span>&nbsp;<span class="op" id="6460299">(</span><span class="ident" id="6460300">s</span>&nbsp;<span class="op" id="6460302">*</span><span class="ident" id="6460303">Scanner</span><span class="op" id="6460310">)</span>&nbsp;<span class="ident" id="6460312">scanComment</span><span class="op" id="6460323">(</span><span class="ident" id="6460324">ch</span>&nbsp;<span class="builtintype" id="6460327">rune</span><span class="op" id="6460331">)</span>&nbsp;<span class="builtintype" id="6460333">rune</span>&nbsp;<span class="op" id="6460338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6460341">//&nbsp;ch&nbsp;==&nbsp;&#39;/&#39;&nbsp;||&nbsp;ch&nbsp;==&nbsp;&#39;*&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6460368">if</span>&nbsp;<span class="ident" id="6460371">ch</span>&nbsp;<span class="op" id="6460374">==</span>&nbsp;<span class="string" id="6460377">&#39;/&#39;</span>&nbsp;<span class="op" id="6460381">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6460385">//&nbsp;line&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6460403">ch</span>&nbsp;<span class="op" id="6460406">=</span>&nbsp;<span class="ident" id="6460408">s</span><span class="op" id="6460409">.</span><span class="ident" id="6460410">next</span><span class="op" id="6460414">(</span><span class="op" id="6460415">)</span>&nbsp;<span class="comment" id="6460417">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#34;//&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6460448">for</span>&nbsp;<span class="ident" id="6460452">ch</span>&nbsp;<span class="op" id="6460455">!=</span>&nbsp;<span class="string" id="6460458">&#39;\n&#39;</span>&nbsp;<span class="op" id="6460463">&amp;&amp;</span>&nbsp;<span class="ident" id="6460466">ch</span>&nbsp;<span class="op" id="6460469">&gt;=</span>&nbsp;<span class="num" id="6460472">0</span>&nbsp;<span class="op" id="6460474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6460479">ch</span>&nbsp;<span class="op" id="6460482">=</span>&nbsp;<span class="ident" id="6460484">s</span><span class="op" id="6460485">.</span><span class="ident" id="6460486">next</span><span class="op" id="6460490">(</span><span class="op" id="6460491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6460495">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6460499">return</span>&nbsp;<span class="ident" id="6460506">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6460510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6460514">//&nbsp;general&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6460534">ch</span>&nbsp;<span class="op" id="6460537">=</span>&nbsp;<span class="ident" id="6460539">s</span><span class="op" id="6460540">.</span><span class="ident" id="6460541">next</span><span class="op" id="6460545">(</span><span class="op" id="6460546">)</span>&nbsp;<span class="comment" id="6460548">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#34;/*&#34;</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6460578">for</span>&nbsp;<span class="op" id="6460582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6460586">if</span>&nbsp;<span class="ident" id="6460589">ch</span>&nbsp;<span class="op" id="6460592">&lt;</span>&nbsp;<span class="num" id="6460594">0</span>&nbsp;<span class="op" id="6460596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6460601">s</span><span class="op" id="6460602">.</span><span class="builtintype" id="6460603">error</span><span class="op" id="6460608">(</span><span class="string" id="6460609">&#34;comment&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="6460633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6460638">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6460646">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6460650">ch0</span>&nbsp;<span class="op" id="6460654">:=</span>&nbsp;<span class="ident" id="6460657">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6460662">ch</span>&nbsp;<span class="op" id="6460665">=</span>&nbsp;<span class="ident" id="6460667">s</span><span class="op" id="6460668">.</span><span class="ident" id="6460669">next</span><span class="op" id="6460673">(</span><span class="op" id="6460674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6460678">if</span>&nbsp;<span class="ident" id="6460681">ch0</span>&nbsp;<span class="op" id="6460685">==</span>&nbsp;<span class="string" id="6460688">&#39;*&#39;</span>&nbsp;<span class="op" id="6460692">&amp;&amp;</span>&nbsp;<span class="ident" id="6460695">ch</span>&nbsp;<span class="op" id="6460698">==</span>&nbsp;<span class="string" id="6460701">&#39;/&#39;</span>&nbsp;<span class="op" id="6460705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6460710">ch</span>&nbsp;<span class="op" id="6460713">=</span>&nbsp;<span class="ident" id="6460715">s</span><span class="op" id="6460716">.</span><span class="ident" id="6460717">next</span><span class="op" id="6460721">(</span><span class="op" id="6460722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6460727">break</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6460735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6460738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6460741">return</span>&nbsp;<span class="ident" id="6460748">ch</span><br>
<span class="lineno"></span><span class="op" id="6460751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span><span class="comment" id="6460754">//&nbsp;Scan&nbsp;reads&nbsp;the&nbsp;next&nbsp;token&nbsp;or&nbsp;Unicode&nbsp;character&nbsp;from&nbsp;source&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="6460832">//&nbsp;It&nbsp;only&nbsp;recognizes&nbsp;tokens&nbsp;t&nbsp;for&nbsp;which&nbsp;the&nbsp;respective&nbsp;Mode&nbsp;bit&nbsp;(1&lt;&lt;-t)&nbsp;is&nbsp;set.</span><br>
<span class="lineno"></span><span class="comment" id="6460913">//&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;source.&nbsp;It&nbsp;reports&nbsp;scanner&nbsp;errors&nbsp;(read&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6460993">//&nbsp;token&nbsp;errors)&nbsp;by&nbsp;calling&nbsp;s.Error,&nbsp;if&nbsp;not&nbsp;nil;&nbsp;otherwise&nbsp;it&nbsp;prints&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="6461071">//&nbsp;message&nbsp;to&nbsp;os.Stderr.</span><br>
<span class="lineno">550</span><span class="keyword" id="6461096">func</span>&nbsp;<span class="op" id="6461101">(</span><span class="ident" id="6461102">s</span>&nbsp;<span class="op" id="6461104">*</span><span class="ident" id="6461105">Scanner</span><span class="op" id="6461112">)</span>&nbsp;<span class="ident" id="6461114">Scan</span><span class="op" id="6461118">(</span><span class="op" id="6461119">)</span>&nbsp;<span class="builtintype" id="6461121">rune</span>&nbsp;<span class="op" id="6461126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6461129">ch</span>&nbsp;<span class="op" id="6461132">:=</span>&nbsp;<span class="ident" id="6461135">s</span><span class="op" id="6461136">.</span><span class="ident" id="6461137">Peek</span><span class="op" id="6461141">(</span><span class="op" id="6461142">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6461146">//&nbsp;reset&nbsp;token&nbsp;text&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6461176">s</span><span class="op" id="6461177">.</span><span class="ident" id="6461178">tokPos</span>&nbsp;<span class="op" id="6461185">=</span>&nbsp;<span class="op" id="6461187">-</span><span class="num" id="6461188">1</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6461191">s</span><span class="op" id="6461192">.</span><span class="ident" id="6461193">Line</span>&nbsp;<span class="op" id="6461198">=</span>&nbsp;<span class="num" id="6461200">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="6461203">redo</span><span class="op" id="6461207">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6461210">//&nbsp;skip&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6461231">for</span>&nbsp;<span class="ident" id="6461235">s</span><span class="op" id="6461236">.</span><span class="ident" id="6461237">Whitespace</span><span class="op" id="6461247">&amp;</span><span class="op" id="6461248">(</span><span class="num" id="6461249">1</span><span class="op" id="6461250">&lt;&lt;</span><span class="builtintype" id="6461252">uint</span><span class="op" id="6461256">(</span><span class="ident" id="6461257">ch</span><span class="op" id="6461259">)</span><span class="op" id="6461260">)</span>&nbsp;<span class="op" id="6461262">!=</span>&nbsp;<span class="num" id="6461265">0</span>&nbsp;<span class="op" id="6461267">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6461271">ch</span>&nbsp;<span class="op" id="6461274">=</span>&nbsp;<span class="ident" id="6461276">s</span><span class="op" id="6461277">.</span><span class="ident" id="6461278">next</span><span class="op" id="6461282">(</span><span class="op" id="6461283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6461286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6461290">//&nbsp;start&nbsp;collecting&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6461322">s</span><span class="op" id="6461323">.</span><span class="ident" id="6461324">tokBuf</span><span class="op" id="6461330">.</span><span class="ident" id="6461331">Reset</span><span class="op" id="6461336">(</span><span class="op" id="6461337">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6461340">s</span><span class="op" id="6461341">.</span><span class="ident" id="6461342">tokPos</span>&nbsp;<span class="op" id="6461349">=</span>&nbsp;<span class="ident" id="6461351">s</span><span class="op" id="6461352">.</span><span class="ident" id="6461353">srcPos</span>&nbsp;<span class="op" id="6461360">-</span>&nbsp;<span class="ident" id="6461362">s</span><span class="op" id="6461363">.</span><span class="ident" id="6461364">lastCharLen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6461378">//&nbsp;set&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6461401">//&nbsp;(this&nbsp;is&nbsp;a&nbsp;slightly&nbsp;optimized&nbsp;version&nbsp;of&nbsp;the&nbsp;code&nbsp;in&nbsp;Pos())</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6461465">s</span><span class="op" id="6461466">.</span><span class="ident" id="6461467">Offset</span>&nbsp;<span class="op" id="6461474">=</span>&nbsp;<span class="ident" id="6461476">s</span><span class="op" id="6461477">.</span><span class="ident" id="6461478">srcBufOffset</span>&nbsp;<span class="op" id="6461491">+</span>&nbsp;<span class="ident" id="6461493">s</span><span class="op" id="6461494">.</span><span class="ident" id="6461495">tokPos</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6461503">if</span>&nbsp;<span class="ident" id="6461506">s</span><span class="op" id="6461507">.</span><span class="ident" id="6461508">column</span>&nbsp;<span class="op" id="6461515">&gt;</span>&nbsp;<span class="num" id="6461517">0</span>&nbsp;<span class="op" id="6461519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6461523">//&nbsp;common&nbsp;case:&nbsp;last&nbsp;character&nbsp;was&nbsp;not&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6461571">s</span><span class="op" id="6461572">.</span><span class="ident" id="6461573">Line</span>&nbsp;<span class="op" id="6461578">=</span>&nbsp;<span class="ident" id="6461580">s</span><span class="op" id="6461581">.</span><span class="ident" id="6461582">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6461589">s</span><span class="op" id="6461590">.</span><span class="ident" id="6461591">Column</span>&nbsp;<span class="op" id="6461598">=</span>&nbsp;<span class="ident" id="6461600">s</span><span class="op" id="6461601">.</span><span class="ident" id="6461602">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6461610">}</span>&nbsp;<span class="keyword" id="6461612">else</span>&nbsp;<span class="op" id="6461617">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6461621">//&nbsp;last&nbsp;character&nbsp;was&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6461652">//&nbsp;(we&nbsp;cannot&nbsp;be&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6461702">//&nbsp;since&nbsp;we&nbsp;have&nbsp;called&nbsp;next()&nbsp;at&nbsp;least&nbsp;once)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6461750">s</span><span class="op" id="6461751">.</span><span class="ident" id="6461752">Line</span>&nbsp;<span class="op" id="6461757">=</span>&nbsp;<span class="ident" id="6461759">s</span><span class="op" id="6461760">.</span><span class="ident" id="6461761">line</span>&nbsp;<span class="op" id="6461766">-</span>&nbsp;<span class="num" id="6461768">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6461772">s</span><span class="op" id="6461773">.</span><span class="ident" id="6461774">Column</span>&nbsp;<span class="op" id="6461781">=</span>&nbsp;<span class="ident" id="6461783">s</span><span class="op" id="6461784">.</span><span class="ident" id="6461785">lastLineLen</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6461798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6461802">//&nbsp;determine&nbsp;token&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6461828">tok</span>&nbsp;<span class="op" id="6461832">:=</span>&nbsp;<span class="ident" id="6461835">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6461839">switch</span>&nbsp;<span class="op" id="6461846">{</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6461849">case</span>&nbsp;<span class="ident" id="6461854">s</span><span class="op" id="6461855">.</span><span class="ident" id="6461856">isIdentRune</span><span class="op" id="6461867">(</span><span class="ident" id="6461868">ch</span><span class="op" id="6461870">,</span>&nbsp;<span class="num" id="6461872">0</span><span class="op" id="6461873">)</span><span class="op" id="6461874">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6461878">if</span>&nbsp;<span class="ident" id="6461881">s</span><span class="op" id="6461882">.</span><span class="ident" id="6461883">Mode</span><span class="op" id="6461887">&amp;</span><span class="ident" id="6461888">ScanIdents</span>&nbsp;<span class="op" id="6461899">!=</span>&nbsp;<span class="num" id="6461902">0</span>&nbsp;<span class="op" id="6461904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6461909">tok</span>&nbsp;<span class="op" id="6461913">=</span>&nbsp;<span class="ident" id="6461915">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6461924">ch</span>&nbsp;<span class="op" id="6461927">=</span>&nbsp;<span class="ident" id="6461929">s</span><span class="op" id="6461930">.</span><span class="ident" id="6461931">scanIdentifier</span><span class="op" id="6461945">(</span><span class="op" id="6461946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6461950">}</span>&nbsp;<span class="keyword" id="6461952">else</span>&nbsp;<span class="op" id="6461957">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6461962">ch</span>&nbsp;<span class="op" id="6461965">=</span>&nbsp;<span class="ident" id="6461967">s</span><span class="op" id="6461968">.</span><span class="ident" id="6461969">next</span><span class="op" id="6461973">(</span><span class="op" id="6461974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6461978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6461981">case</span>&nbsp;<span class="ident" id="6461986">isDecimal</span><span class="op" id="6461995">(</span><span class="ident" id="6461996">ch</span><span class="op" id="6461998">)</span><span class="op" id="6461999">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6462003">if</span>&nbsp;<span class="ident" id="6462006">s</span><span class="op" id="6462007">.</span><span class="ident" id="6462008">Mode</span><span class="op" id="6462012">&amp;</span><span class="op" id="6462013">(</span><span class="ident" id="6462014">ScanInts</span><span class="op" id="6462022">|</span><span class="ident" id="6462023">ScanFloats</span><span class="op" id="6462033">)</span>&nbsp;<span class="op" id="6462035">!=</span>&nbsp;<span class="num" id="6462038">0</span>&nbsp;<span class="op" id="6462040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6462045">tok</span><span class="op" id="6462048">,</span>&nbsp;<span class="ident" id="6462050">ch</span>&nbsp;<span class="op" id="6462053">=</span>&nbsp;<span class="ident" id="6462055">s</span><span class="op" id="6462056">.</span><span class="ident" id="6462057">scanNumber</span><span class="op" id="6462067">(</span><span class="ident" id="6462068">ch</span><span class="op" id="6462070">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6462074">}</span>&nbsp;<span class="keyword" id="6462076">else</span>&nbsp;<span class="op" id="6462081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6462086">ch</span>&nbsp;<span class="op" id="6462089">=</span>&nbsp;<span class="ident" id="6462091">s</span><span class="op" id="6462092">.</span><span class="ident" id="6462093">next</span><span class="op" id="6462097">(</span><span class="op" id="6462098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6462102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6462105">default</span><span class="op" id="6462112">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6462116">switch</span>&nbsp;<span class="ident" id="6462123">ch</span>&nbsp;<span class="op" id="6462126">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6462130">case</span>&nbsp;<span class="string" id="6462135">&#39;&#34;&#39;</span><span class="op" id="6462138">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6462143">if</span>&nbsp;<span class="ident" id="6462146">s</span><span class="op" id="6462147">.</span><span class="ident" id="6462148">Mode</span><span class="op" id="6462152">&amp;</span><span class="ident" id="6462153">ScanStrings</span>&nbsp;<span class="op" id="6462165">!=</span>&nbsp;<span class="num" id="6462168">0</span>&nbsp;<span class="op" id="6462170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6462176">s</span><span class="op" id="6462177">.</span><span class="ident" id="6462178">scanString</span><span class="op" id="6462188">(</span><span class="string" id="6462189">&#39;&#34;&#39;</span><span class="op" id="6462192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6462198">tok</span>&nbsp;<span class="op" id="6462202">=</span>&nbsp;<span class="ident" id="6462204">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6462214">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6462219">ch</span>&nbsp;<span class="op" id="6462222">=</span>&nbsp;<span class="ident" id="6462224">s</span><span class="op" id="6462225">.</span><span class="ident" id="6462226">next</span><span class="op" id="6462230">(</span><span class="op" id="6462231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6462235">case</span>&nbsp;<span class="string" id="6462240">&#39;\&#39;&#39;</span><span class="op" id="6462244">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6462249">if</span>&nbsp;<span class="ident" id="6462252">s</span><span class="op" id="6462253">.</span><span class="ident" id="6462254">Mode</span><span class="op" id="6462258">&amp;</span><span class="ident" id="6462259">ScanChars</span>&nbsp;<span class="op" id="6462269">!=</span>&nbsp;<span class="num" id="6462272">0</span>&nbsp;<span class="op" id="6462274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6462280">s</span><span class="op" id="6462281">.</span><span class="ident" id="6462282">scanChar</span><span class="op" id="6462290">(</span><span class="op" id="6462291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6462297">tok</span>&nbsp;<span class="op" id="6462301">=</span>&nbsp;<span class="ident" id="6462303">Char</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6462311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6462316">ch</span>&nbsp;<span class="op" id="6462319">=</span>&nbsp;<span class="ident" id="6462321">s</span><span class="op" id="6462322">.</span><span class="ident" id="6462323">next</span><span class="op" id="6462327">(</span><span class="op" id="6462328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6462332">case</span>&nbsp;<span class="string" id="6462337">&#39;.&#39;</span><span class="op" id="6462340">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6462345">ch</span>&nbsp;<span class="op" id="6462348">=</span>&nbsp;<span class="ident" id="6462350">s</span><span class="op" id="6462351">.</span><span class="ident" id="6462352">next</span><span class="op" id="6462356">(</span><span class="op" id="6462357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6462362">if</span>&nbsp;<span class="ident" id="6462365">isDecimal</span><span class="op" id="6462374">(</span><span class="ident" id="6462375">ch</span><span class="op" id="6462377">)</span>&nbsp;<span class="op" id="6462379">&amp;&amp;</span>&nbsp;<span class="ident" id="6462382">s</span><span class="op" id="6462383">.</span><span class="ident" id="6462384">Mode</span><span class="op" id="6462388">&amp;</span><span class="ident" id="6462389">ScanFloats</span>&nbsp;<span class="op" id="6462400">!=</span>&nbsp;<span class="num" id="6462403">0</span>&nbsp;<span class="op" id="6462405">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6462411">tok</span>&nbsp;<span class="op" id="6462415">=</span>&nbsp;<span class="ident" id="6462417">Float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6462427">ch</span>&nbsp;<span class="op" id="6462430">=</span>&nbsp;<span class="ident" id="6462432">s</span><span class="op" id="6462433">.</span><span class="ident" id="6462434">scanMantissa</span><span class="op" id="6462446">(</span><span class="ident" id="6462447">ch</span><span class="op" id="6462449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6462455">ch</span>&nbsp;<span class="op" id="6462458">=</span>&nbsp;<span class="ident" id="6462460">s</span><span class="op" id="6462461">.</span><span class="ident" id="6462462">scanExponent</span><span class="op" id="6462474">(</span><span class="ident" id="6462475">ch</span><span class="op" id="6462477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6462482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6462486">case</span>&nbsp;<span class="string" id="6462491">&#39;/&#39;</span><span class="op" id="6462494">:</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6462499">ch</span>&nbsp;<span class="op" id="6462502">=</span>&nbsp;<span class="ident" id="6462504">s</span><span class="op" id="6462505">.</span><span class="ident" id="6462506">next</span><span class="op" id="6462510">(</span><span class="op" id="6462511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6462516">if</span>&nbsp;<span class="op" id="6462519">(</span><span class="ident" id="6462520">ch</span>&nbsp;<span class="op" id="6462523">==</span>&nbsp;<span class="string" id="6462526">&#39;/&#39;</span>&nbsp;<span class="op" id="6462530">||</span>&nbsp;<span class="ident" id="6462533">ch</span>&nbsp;<span class="op" id="6462536">==</span>&nbsp;<span class="string" id="6462539">&#39;*&#39;</span><span class="op" id="6462542">)</span>&nbsp;<span class="op" id="6462544">&amp;&amp;</span>&nbsp;<span class="ident" id="6462547">s</span><span class="op" id="6462548">.</span><span class="ident" id="6462549">Mode</span><span class="op" id="6462553">&amp;</span><span class="ident" id="6462554">ScanComments</span>&nbsp;<span class="op" id="6462567">!=</span>&nbsp;<span class="num" id="6462570">0</span>&nbsp;<span class="op" id="6462572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6462578">if</span>&nbsp;<span class="ident" id="6462581">s</span><span class="op" id="6462582">.</span><span class="ident" id="6462583">Mode</span><span class="op" id="6462587">&amp;</span><span class="ident" id="6462588">SkipComments</span>&nbsp;<span class="op" id="6462601">!=</span>&nbsp;<span class="num" id="6462604">0</span>&nbsp;<span class="op" id="6462606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6462613">s</span><span class="op" id="6462614">.</span><span class="ident" id="6462615">tokPos</span>&nbsp;<span class="op" id="6462622">=</span>&nbsp;<span class="op" id="6462624">-</span><span class="num" id="6462625">1</span>&nbsp;<span class="comment" id="6462627">//&nbsp;don&#39;t&nbsp;collect&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6462660">ch</span>&nbsp;<span class="op" id="6462663">=</span>&nbsp;<span class="ident" id="6462665">s</span><span class="op" id="6462666">.</span><span class="ident" id="6462667">scanComment</span><span class="op" id="6462678">(</span><span class="ident" id="6462679">ch</span><span class="op" id="6462681">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6462688">goto</span>&nbsp;<span class="ident" id="6462693">redo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6462702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6462708">ch</span>&nbsp;<span class="op" id="6462711">=</span>&nbsp;<span class="ident" id="6462713">s</span><span class="op" id="6462714">.</span><span class="ident" id="6462715">scanComment</span><span class="op" id="6462726">(</span><span class="ident" id="6462727">ch</span><span class="op" id="6462729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6462735">tok</span>&nbsp;<span class="op" id="6462739">=</span>&nbsp;<span class="ident" id="6462741">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6462752">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6462756">case</span>&nbsp;<span class="string" id="6462761">&#39;`&#39;</span><span class="op" id="6462764">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6462769">if</span>&nbsp;<span class="ident" id="6462772">s</span><span class="op" id="6462773">.</span><span class="ident" id="6462774">Mode</span><span class="op" id="6462778">&amp;</span><span class="ident" id="6462779">ScanRawStrings</span>&nbsp;<span class="op" id="6462794">!=</span>&nbsp;<span class="num" id="6462797">0</span>&nbsp;<span class="op" id="6462799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6462805">s</span><span class="op" id="6462806">.</span><span class="ident" id="6462807">scanRawString</span><span class="op" id="6462820">(</span><span class="op" id="6462821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6462827">tok</span>&nbsp;<span class="op" id="6462831">=</span>&nbsp;<span class="ident" id="6462833">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6462843">}</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6462848">ch</span>&nbsp;<span class="op" id="6462851">=</span>&nbsp;<span class="ident" id="6462853">s</span><span class="op" id="6462854">.</span><span class="ident" id="6462855">next</span><span class="op" id="6462859">(</span><span class="op" id="6462860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6462864">default</span><span class="op" id="6462871">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6462876">ch</span>&nbsp;<span class="op" id="6462879">=</span>&nbsp;<span class="ident" id="6462881">s</span><span class="op" id="6462882">.</span><span class="ident" id="6462883">next</span><span class="op" id="6462887">(</span><span class="op" id="6462888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6462892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6462895">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6462899">//&nbsp;end&nbsp;of&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6462921">s</span><span class="op" id="6462922">.</span><span class="ident" id="6462923">tokEnd</span>&nbsp;<span class="op" id="6462930">=</span>&nbsp;<span class="ident" id="6462932">s</span><span class="op" id="6462933">.</span><span class="ident" id="6462934">srcPos</span>&nbsp;<span class="op" id="6462941">-</span>&nbsp;<span class="ident" id="6462943">s</span><span class="op" id="6462944">.</span><span class="ident" id="6462945">lastCharLen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6462959">s</span><span class="op" id="6462960">.</span><span class="ident" id="6462961">ch</span>&nbsp;<span class="op" id="6462964">=</span>&nbsp;<span class="ident" id="6462966">ch</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6462970">return</span>&nbsp;<span class="ident" id="6462977">tok</span><br>
<span class="lineno"></span><span class="op" id="6462981">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6462984">//&nbsp;Pos&nbsp;returns&nbsp;the&nbsp;position&nbsp;of&nbsp;the&nbsp;character&nbsp;immediately&nbsp;after</span><br>
<span class="lineno"></span><span class="comment" id="6463047">//&nbsp;the&nbsp;character&nbsp;or&nbsp;token&nbsp;returned&nbsp;by&nbsp;the&nbsp;last&nbsp;call&nbsp;to&nbsp;Next&nbsp;or&nbsp;Scan.</span><br>
<span class="lineno">650</span><span class="keyword" id="6463116">func</span>&nbsp;<span class="op" id="6463121">(</span><span class="ident" id="6463122">s</span>&nbsp;<span class="op" id="6463124">*</span><span class="ident" id="6463125">Scanner</span><span class="op" id="6463132">)</span>&nbsp;<span class="ident" id="6463134">Pos</span><span class="op" id="6463137">(</span><span class="op" id="6463138">)</span>&nbsp;<span class="op" id="6463140">(</span><span class="ident" id="6463141">pos</span>&nbsp;<span class="ident" id="6463145">Position</span><span class="op" id="6463153">)</span>&nbsp;<span class="op" id="6463155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6463158">pos</span><span class="op" id="6463161">.</span><span class="ident" id="6463162">Filename</span>&nbsp;<span class="op" id="6463171">=</span>&nbsp;<span class="ident" id="6463173">s</span><span class="op" id="6463174">.</span><span class="ident" id="6463175">Filename</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6463185">pos</span><span class="op" id="6463188">.</span><span class="ident" id="6463189">Offset</span>&nbsp;<span class="op" id="6463196">=</span>&nbsp;<span class="ident" id="6463198">s</span><span class="op" id="6463199">.</span><span class="ident" id="6463200">srcBufOffset</span>&nbsp;<span class="op" id="6463213">+</span>&nbsp;<span class="ident" id="6463215">s</span><span class="op" id="6463216">.</span><span class="ident" id="6463217">srcPos</span>&nbsp;<span class="op" id="6463224">-</span>&nbsp;<span class="ident" id="6463226">s</span><span class="op" id="6463227">.</span><span class="ident" id="6463228">lastCharLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6463241">switch</span>&nbsp;<span class="op" id="6463248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6463251">case</span>&nbsp;<span class="ident" id="6463256">s</span><span class="op" id="6463257">.</span><span class="ident" id="6463258">column</span>&nbsp;<span class="op" id="6463265">&gt;</span>&nbsp;<span class="num" id="6463267">0</span><span class="op" id="6463268">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6463272">//&nbsp;common&nbsp;case:&nbsp;last&nbsp;character&nbsp;was&nbsp;not&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6463320">pos</span><span class="op" id="6463323">.</span><span class="ident" id="6463324">Line</span>&nbsp;<span class="op" id="6463329">=</span>&nbsp;<span class="ident" id="6463331">s</span><span class="op" id="6463332">.</span><span class="ident" id="6463333">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6463340">pos</span><span class="op" id="6463343">.</span><span class="ident" id="6463344">Column</span>&nbsp;<span class="op" id="6463351">=</span>&nbsp;<span class="ident" id="6463353">s</span><span class="op" id="6463354">.</span><span class="ident" id="6463355">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6463363">case</span>&nbsp;<span class="ident" id="6463368">s</span><span class="op" id="6463369">.</span><span class="ident" id="6463370">lastLineLen</span>&nbsp;<span class="op" id="6463382">&gt;</span>&nbsp;<span class="num" id="6463384">0</span><span class="op" id="6463385">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6463389">//&nbsp;last&nbsp;character&nbsp;was&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6463420">pos</span><span class="op" id="6463423">.</span><span class="ident" id="6463424">Line</span>&nbsp;<span class="op" id="6463429">=</span>&nbsp;<span class="ident" id="6463431">s</span><span class="op" id="6463432">.</span><span class="ident" id="6463433">line</span>&nbsp;<span class="op" id="6463438">-</span>&nbsp;<span class="num" id="6463440">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6463444">pos</span><span class="op" id="6463447">.</span><span class="ident" id="6463448">Column</span>&nbsp;<span class="op" id="6463455">=</span>&nbsp;<span class="ident" id="6463457">s</span><span class="op" id="6463458">.</span><span class="ident" id="6463459">lastLineLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6463472">default</span><span class="op" id="6463479">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6463483">//&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6463519">pos</span><span class="op" id="6463522">.</span><span class="ident" id="6463523">Line</span>&nbsp;<span class="op" id="6463528">=</span>&nbsp;<span class="num" id="6463530">1</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6463534">pos</span><span class="op" id="6463537">.</span><span class="ident" id="6463538">Column</span>&nbsp;<span class="op" id="6463545">=</span>&nbsp;<span class="num" id="6463547">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6463550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6463553">return</span><br>
<span class="lineno"></span><span class="op" id="6463560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="comment" id="6463563">//&nbsp;TokenText&nbsp;returns&nbsp;the&nbsp;string&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;most&nbsp;recently&nbsp;scanned&nbsp;token.</span><br>
<span class="lineno"></span><span class="comment" id="6463645">//&nbsp;Valid&nbsp;after&nbsp;calling&nbsp;Scan().</span><br>
<span class="lineno"></span><span class="keyword" id="6463676">func</span>&nbsp;<span class="op" id="6463681">(</span><span class="ident" id="6463682">s</span>&nbsp;<span class="op" id="6463684">*</span><span class="ident" id="6463685">Scanner</span><span class="op" id="6463692">)</span>&nbsp;<span class="ident" id="6463694">TokenText</span><span class="op" id="6463703">(</span><span class="op" id="6463704">)</span>&nbsp;<span class="builtintype" id="6463706">string</span>&nbsp;<span class="op" id="6463713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6463716">if</span>&nbsp;<span class="ident" id="6463719">s</span><span class="op" id="6463720">.</span><span class="ident" id="6463721">tokPos</span>&nbsp;<span class="op" id="6463728">&lt;</span>&nbsp;<span class="num" id="6463730">0</span>&nbsp;<span class="op" id="6463732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6463736">//&nbsp;no&nbsp;token&nbsp;text</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6463755">return</span>&nbsp;<span class="string" id="6463762">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6463766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6463770">if</span>&nbsp;<span class="ident" id="6463773">s</span><span class="op" id="6463774">.</span><span class="ident" id="6463775">tokEnd</span>&nbsp;<span class="op" id="6463782">&lt;</span>&nbsp;<span class="num" id="6463784">0</span>&nbsp;<span class="op" id="6463786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6463790">//&nbsp;if&nbsp;EOF&nbsp;was&nbsp;reached,&nbsp;s.tokEnd&nbsp;is&nbsp;set&nbsp;to&nbsp;-1&nbsp;(s.srcPos&nbsp;==&nbsp;0)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6463853">s</span><span class="op" id="6463854">.</span><span class="ident" id="6463855">tokEnd</span>&nbsp;<span class="op" id="6463862">=</span>&nbsp;<span class="ident" id="6463864">s</span><span class="op" id="6463865">.</span><span class="ident" id="6463866">tokPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6463874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6463878">if</span>&nbsp;<span class="ident" id="6463881">s</span><span class="op" id="6463882">.</span><span class="ident" id="6463883">tokBuf</span><span class="op" id="6463889">.</span><span class="ident" id="6463890">Len</span><span class="op" id="6463893">(</span><span class="op" id="6463894">)</span>&nbsp;<span class="op" id="6463896">==</span>&nbsp;<span class="num" id="6463899">0</span>&nbsp;<span class="op" id="6463901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6463905">//&nbsp;common&nbsp;case:&nbsp;the&nbsp;entire&nbsp;token&nbsp;text&nbsp;is&nbsp;still&nbsp;in&nbsp;srcBuf</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6463964">return</span>&nbsp;<span class="builtintype" id="6463971">string</span><span class="op" id="6463977">(</span><span class="ident" id="6463978">s</span><span class="op" id="6463979">.</span><span class="ident" id="6463980">srcBuf</span><span class="op" id="6463986">[</span><span class="ident" id="6463987">s</span><span class="op" id="6463988">.</span><span class="ident" id="6463989">tokPos</span><span class="op" id="6463995">:</span><span class="ident" id="6463996">s</span><span class="op" id="6463997">.</span><span class="ident" id="6463998">tokEnd</span><span class="op" id="6464004">]</span><span class="op" id="6464005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6464008">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6464012">//&nbsp;part&nbsp;of&nbsp;the&nbsp;token&nbsp;text&nbsp;was&nbsp;saved&nbsp;in&nbsp;tokBuf:&nbsp;save&nbsp;the&nbsp;rest&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6464077">//&nbsp;tokBuf&nbsp;as&nbsp;well&nbsp;and&nbsp;return&nbsp;its&nbsp;content</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6464119">s</span><span class="op" id="6464120">.</span><span class="ident" id="6464121">tokBuf</span><span class="op" id="6464127">.</span><span class="ident" id="6464128">Write</span><span class="op" id="6464133">(</span><span class="ident" id="6464134">s</span><span class="op" id="6464135">.</span><span class="ident" id="6464136">srcBuf</span><span class="op" id="6464142">[</span><span class="ident" id="6464143">s</span><span class="op" id="6464144">.</span><span class="ident" id="6464145">tokPos</span><span class="op" id="6464151">:</span><span class="ident" id="6464152">s</span><span class="op" id="6464153">.</span><span class="ident" id="6464154">tokEnd</span><span class="op" id="6464160">]</span><span class="op" id="6464161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6464164">s</span><span class="op" id="6464165">.</span><span class="ident" id="6464166">tokPos</span>&nbsp;<span class="op" id="6464173">=</span>&nbsp;<span class="ident" id="6464175">s</span><span class="op" id="6464176">.</span><span class="ident" id="6464177">tokEnd</span>&nbsp;<span class="comment" id="6464184">//&nbsp;ensure&nbsp;idempotency&nbsp;of&nbsp;TokenText()&nbsp;call</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6464227">return</span>&nbsp;<span class="ident" id="6464234">s</span><span class="op" id="6464235">.</span><span class="ident" id="6464236">tokBuf</span><span class="op" id="6464242">.</span><span class="ident" id="6464243">String</span><span class="op" id="6464249">(</span><span class="op" id="6464250">)</span><br>
<span class="lineno"></span><span class="op" id="6464252">}</span>
</div>
</body>
</html>
