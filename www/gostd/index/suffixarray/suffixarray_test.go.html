<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>index/suffixarray</h2>
<ul>
<li><a href="/gostd/index/suffixarray/qsufsort.go.html">qsufsort.go</a></li>
<li><a href="/gostd/index/suffixarray/suffixarray.go.html">suffixarray.go</a></li>
<li><a href="/gostd/index/suffixarray/suffixarray_test.go.html">suffixarray_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8475822">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8475877">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8475931">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8475982">package</span>&nbsp;<span class="ident" id="8475990">suffixarray</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8476003">import</span>&nbsp;<span class="op" id="8476010">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476013">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476022">&#34;math/rand&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476035">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476045">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476053">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476064">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8476074">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="8476077">type</span>&nbsp;<span class="ident" id="8476082">testCase</span>&nbsp;<span class="keyword" id="8476091">struct</span>&nbsp;<span class="op" id="8476098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8476101">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8476110">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="8476119">//&nbsp;name&nbsp;of&nbsp;test&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8476141">source</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8476150">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="8476159">//&nbsp;source&nbsp;to&nbsp;index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8476179">patterns</span>&nbsp;<span class="op" id="8476188">[</span><span class="op" id="8476189">]</span><span class="builtintype" id="8476190">string</span>&nbsp;<span class="comment" id="8476197">//&nbsp;patterns&nbsp;to&nbsp;lookup</span><br>
<span class="lineno">20</span><span class="op" id="8476219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8476222">var</span>&nbsp;<span class="ident" id="8476226">testCases</span>&nbsp;<span class="op" id="8476236">=</span>&nbsp;<span class="op" id="8476238">[</span><span class="op" id="8476239">]</span><span class="ident" id="8476240">testCase</span><span class="op" id="8476248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8476251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476255">&#34;empty&nbsp;string&#34;</span><span class="op" id="8476269">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476273">&#34;&#34;</span><span class="op" id="8476275">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8476279">[</span><span class="op" id="8476280">]</span><span class="builtintype" id="8476281">string</span><span class="op" id="8476287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476292">&#34;&#34;</span><span class="op" id="8476294">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476299">&#34;foo&#34;</span><span class="op" id="8476304">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476309">&#34;(foo)&#34;</span><span class="op" id="8476316">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476321">&#34;.*&#34;</span><span class="op" id="8476325">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476330">&#34;a*&#34;</span><span class="op" id="8476334">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8476338">}</span><span class="op" id="8476339">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8476342">}</span><span class="op" id="8476343">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8476347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476351">&#34;all&nbsp;a&#39;s&#34;</span><span class="op" id="8476360">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476364">&#34;aaaaaaaaaa&#34;</span><span class="op" id="8476376">,</span>&nbsp;<span class="comment" id="8476378">//&nbsp;10&nbsp;a&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8476390">[</span><span class="op" id="8476391">]</span><span class="builtintype" id="8476392">string</span><span class="op" id="8476398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476403">&#34;&#34;</span><span class="op" id="8476405">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476410">&#34;a&#34;</span><span class="op" id="8476413">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476418">&#34;aa&#34;</span><span class="op" id="8476422">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476427">&#34;aaa&#34;</span><span class="op" id="8476432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476437">&#34;aaaa&#34;</span><span class="op" id="8476443">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476448">&#34;aaaaa&#34;</span><span class="op" id="8476455">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476460">&#34;aaaaaa&#34;</span><span class="op" id="8476468">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476473">&#34;aaaaaaa&#34;</span><span class="op" id="8476482">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476487">&#34;aaaaaaaa&#34;</span><span class="op" id="8476497">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476502">&#34;aaaaaaaaa&#34;</span><span class="op" id="8476513">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476518">&#34;aaaaaaaaaa&#34;</span><span class="op" id="8476530">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476535">&#34;aaaaaaaaaaa&#34;</span><span class="op" id="8476548">,</span>&nbsp;<span class="comment" id="8476550">//&nbsp;11&nbsp;a&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476563">&#34;.&#34;</span><span class="op" id="8476566">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476571">&#34;.*&#34;</span><span class="op" id="8476575">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476580">&#34;a+&#34;</span><span class="op" id="8476584">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476589">&#34;aa+&#34;</span><span class="op" id="8476594">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476599">&#34;aaaa[b]?&#34;</span><span class="op" id="8476609">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476614">&#34;aaa*&#34;</span><span class="op" id="8476620">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8476624">}</span><span class="op" id="8476625">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8476628">}</span><span class="op" id="8476629">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8476633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476637">&#34;abc&#34;</span><span class="op" id="8476642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476646">&#34;abc&#34;</span><span class="op" id="8476651">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8476655">[</span><span class="op" id="8476656">]</span><span class="builtintype" id="8476657">string</span><span class="op" id="8476663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476668">&#34;a&#34;</span><span class="op" id="8476671">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476676">&#34;b&#34;</span><span class="op" id="8476679">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476684">&#34;c&#34;</span><span class="op" id="8476687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476692">&#34;ab&#34;</span><span class="op" id="8476696">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476701">&#34;bc&#34;</span><span class="op" id="8476705">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476710">&#34;abc&#34;</span><span class="op" id="8476715">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476720">&#34;a.c&#34;</span><span class="op" id="8476725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476730">&#34;a(b|c)&#34;</span><span class="op" id="8476738">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476743">&#34;abc?&#34;</span><span class="op" id="8476749">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8476753">}</span><span class="op" id="8476754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8476757">}</span><span class="op" id="8476758">,</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8476762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476766">&#34;barbara*3&#34;</span><span class="op" id="8476777">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476781">&#34;barbarabarbarabarbara&#34;</span><span class="op" id="8476804">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8476808">[</span><span class="op" id="8476809">]</span><span class="builtintype" id="8476810">string</span><span class="op" id="8476816">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476821">&#34;a&#34;</span><span class="op" id="8476824">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476829">&#34;bar&#34;</span><span class="op" id="8476834">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476839">&#34;rab&#34;</span><span class="op" id="8476844">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476849">&#34;arab&#34;</span><span class="op" id="8476855">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476860">&#34;barbar&#34;</span><span class="op" id="8476868">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476873">&#34;bara?bar&#34;</span><span class="op" id="8476883">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8476887">}</span><span class="op" id="8476888">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8476891">}</span><span class="op" id="8476892">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8476896">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476900">&#34;typing&nbsp;drill&#34;</span><span class="op" id="8476914">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8476918">&#34;Now&nbsp;is&nbsp;the&nbsp;time&nbsp;for&nbsp;all&nbsp;good&nbsp;men&nbsp;to&nbsp;come&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&nbsp;country.&#34;</span><span class="op" id="8476989">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8476993">[</span><span class="op" id="8476994">]</span><span class="builtintype" id="8476995">string</span><span class="op" id="8477001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8477006">&#34;Now&#34;</span><span class="op" id="8477011">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8477016">&#34;the&nbsp;time&#34;</span><span class="op" id="8477026">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8477031">&#34;to&nbsp;come&nbsp;the&nbsp;aid&#34;</span><span class="op" id="8477048">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8477053">&#34;is&nbsp;the&nbsp;time&nbsp;for&nbsp;all&nbsp;good&nbsp;men&nbsp;to&nbsp;come&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&#34;</span><span class="op" id="8477111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8477116">&#34;to&nbsp;(come|the)?&#34;</span><span class="op" id="8477132">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8477136">}</span><span class="op" id="8477137">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8477140">}</span><span class="op" id="8477141">,</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8477145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8477149">&#34;godoc&nbsp;simulation&#34;</span><span class="op" id="8477167">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8477171">&#34;package&nbsp;main\n\nimport(\n&nbsp;&nbsp;&nbsp;&nbsp;\&#34;rand\&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="8477216">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8477220">[</span><span class="op" id="8477221">]</span><span class="builtintype" id="8477222">string</span><span class="op" id="8477228">{</span><span class="op" id="8477229">}</span><span class="op" id="8477230">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8477233">}</span><span class="op" id="8477234">,</span><br>
<span class="lineno"></span><span class="op" id="8477236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8477239">//&nbsp;find&nbsp;all&nbsp;occurrences&nbsp;of&nbsp;s&nbsp;in&nbsp;source;&nbsp;report&nbsp;at&nbsp;most&nbsp;n&nbsp;occurrences</span><br>
<span class="lineno"></span><span class="keyword" id="8477308">func</span>&nbsp;<span class="ident" id="8477313">find</span><span class="op" id="8477317">(</span><span class="ident" id="8477318">src</span><span class="op" id="8477321">,</span>&nbsp;<span class="ident" id="8477323">s</span>&nbsp;<span class="builtintype" id="8477325">string</span><span class="op" id="8477331">,</span>&nbsp;<span class="ident" id="8477333">n</span>&nbsp;<span class="builtintype" id="8477335">int</span><span class="op" id="8477338">)</span>&nbsp;<span class="op" id="8477340">[</span><span class="op" id="8477341">]</span><span class="builtintype" id="8477342">int</span>&nbsp;<span class="op" id="8477346">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8477349">var</span>&nbsp;<span class="ident" id="8477353">res</span>&nbsp;<span class="op" id="8477357">[</span><span class="op" id="8477358">]</span><span class="builtintype" id="8477359">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8477364">if</span>&nbsp;<span class="ident" id="8477367">s</span>&nbsp;<span class="op" id="8477369">!=</span>&nbsp;<span class="string" id="8477372">&#34;&#34;</span>&nbsp;<span class="op" id="8477375">&amp;&amp;</span>&nbsp;<span class="ident" id="8477378">n</span>&nbsp;<span class="op" id="8477380">!=</span>&nbsp;<span class="num" id="8477383">0</span>&nbsp;<span class="op" id="8477385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8477389">//&nbsp;find&nbsp;at&nbsp;most&nbsp;n&nbsp;occurrences&nbsp;of&nbsp;s&nbsp;in&nbsp;src</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8477433">for</span>&nbsp;<span class="ident" id="8477437">i</span>&nbsp;<span class="op" id="8477439">:=</span>&nbsp;<span class="op" id="8477442">-</span><span class="num" id="8477443">1</span><span class="op" id="8477444">;</span>&nbsp;<span class="ident" id="8477446">n</span>&nbsp;<span class="op" id="8477448">&lt;</span>&nbsp;<span class="num" id="8477450">0</span>&nbsp;<span class="op" id="8477452">||</span>&nbsp;<span class="builtinfunc" id="8477455">len</span><span class="op" id="8477458">(</span><span class="ident" id="8477459">res</span><span class="op" id="8477462">)</span>&nbsp;<span class="op" id="8477464">&lt;</span>&nbsp;<span class="ident" id="8477466">n</span><span class="op" id="8477467">;</span>&nbsp;<span class="op" id="8477469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8477474">j</span>&nbsp;<span class="op" id="8477476">:=</span>&nbsp;<span class="ident" id="8477479">strings</span><span class="op" id="8477486">.</span><span class="ident" id="8477487">Index</span><span class="op" id="8477492">(</span><span class="ident" id="8477493">src</span><span class="op" id="8477496">[</span><span class="ident" id="8477497">i</span><span class="op" id="8477498">+</span><span class="num" id="8477499">1</span><span class="op" id="8477500">:</span><span class="op" id="8477501">]</span><span class="op" id="8477502">,</span>&nbsp;<span class="ident" id="8477504">s</span><span class="op" id="8477505">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8477510">if</span>&nbsp;<span class="ident" id="8477513">j</span>&nbsp;<span class="op" id="8477515">&lt;</span>&nbsp;<span class="num" id="8477517">0</span>&nbsp;<span class="op" id="8477519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8477525">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8477534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8477539">i</span>&nbsp;<span class="op" id="8477541">+=</span>&nbsp;<span class="ident" id="8477544">j</span>&nbsp;<span class="op" id="8477546">+</span>&nbsp;<span class="num" id="8477548">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8477553">res</span>&nbsp;<span class="op" id="8477557">=</span>&nbsp;<span class="builtinfunc" id="8477559">append</span><span class="op" id="8477565">(</span><span class="ident" id="8477566">res</span><span class="op" id="8477569">,</span>&nbsp;<span class="ident" id="8477571">i</span><span class="op" id="8477572">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8477576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8477579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8477582">return</span>&nbsp;<span class="ident" id="8477589">res</span><br>
<span class="lineno"></span><span class="op" id="8477593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="8477596">func</span>&nbsp;<span class="ident" id="8477601">testLookup</span><span class="op" id="8477611">(</span><span class="ident" id="8477612">t</span>&nbsp;<span class="op" id="8477614">*</span><span class="ident" id="8477615">testing</span><span class="op" id="8477622">.</span><span class="ident" id="8477623">T</span><span class="op" id="8477624">,</span>&nbsp;<span class="ident" id="8477626">tc</span>&nbsp;<span class="op" id="8477629">*</span><span class="ident" id="8477630">testCase</span><span class="op" id="8477638">,</span>&nbsp;<span class="ident" id="8477640">x</span>&nbsp;<span class="op" id="8477642">*</span><span class="ident" id="8477643">Index</span><span class="op" id="8477648">,</span>&nbsp;<span class="ident" id="8477650">s</span>&nbsp;<span class="builtintype" id="8477652">string</span><span class="op" id="8477658">,</span>&nbsp;<span class="ident" id="8477660">n</span>&nbsp;<span class="builtintype" id="8477662">int</span><span class="op" id="8477665">)</span>&nbsp;<span class="op" id="8477667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8477670">res</span>&nbsp;<span class="op" id="8477674">:=</span>&nbsp;<span class="ident" id="8477677">x</span><span class="op" id="8477678">.</span><span class="ident" id="8477679">Lookup</span><span class="op" id="8477685">(</span><span class="op" id="8477686">[</span><span class="op" id="8477687">]</span><span class="builtintype" id="8477688">byte</span><span class="op" id="8477692">(</span><span class="ident" id="8477693">s</span><span class="op" id="8477694">)</span><span class="op" id="8477695">,</span>&nbsp;<span class="ident" id="8477697">n</span><span class="op" id="8477698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8477701">exp</span>&nbsp;<span class="op" id="8477705">:=</span>&nbsp;<span class="ident" id="8477708">find</span><span class="op" id="8477712">(</span><span class="ident" id="8477713">tc</span><span class="op" id="8477715">.</span><span class="ident" id="8477716">source</span><span class="op" id="8477722">,</span>&nbsp;<span class="ident" id="8477724">s</span><span class="op" id="8477725">,</span>&nbsp;<span class="ident" id="8477727">n</span><span class="op" id="8477728">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8477732">//&nbsp;check&nbsp;that&nbsp;the&nbsp;lengths&nbsp;match</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8477765">if</span>&nbsp;<span class="builtinfunc" id="8477768">len</span><span class="op" id="8477771">(</span><span class="ident" id="8477772">res</span><span class="op" id="8477775">)</span>&nbsp;<span class="op" id="8477777">!=</span>&nbsp;<span class="builtinfunc" id="8477780">len</span><span class="op" id="8477783">(</span><span class="ident" id="8477784">exp</span><span class="op" id="8477787">)</span>&nbsp;<span class="op" id="8477789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8477793">t</span><span class="op" id="8477794">.</span><span class="ident" id="8477795">Errorf</span><span class="op" id="8477801">(</span><span class="string" id="8477802">&#34;test&nbsp;%q,&nbsp;lookup&nbsp;%q&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;expected&nbsp;%d&nbsp;results;&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8477860">,</span>&nbsp;<span class="ident" id="8477862">tc</span><span class="op" id="8477864">.</span><span class="ident" id="8477865">name</span><span class="op" id="8477869">,</span>&nbsp;<span class="ident" id="8477871">s</span><span class="op" id="8477872">,</span>&nbsp;<span class="ident" id="8477874">n</span><span class="op" id="8477875">,</span>&nbsp;<span class="builtinfunc" id="8477877">len</span><span class="op" id="8477880">(</span><span class="ident" id="8477881">exp</span><span class="op" id="8477884">)</span><span class="op" id="8477885">,</span>&nbsp;<span class="builtinfunc" id="8477887">len</span><span class="op" id="8477890">(</span><span class="ident" id="8477891">res</span><span class="op" id="8477894">)</span><span class="op" id="8477895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8477898">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8477902">//&nbsp;if&nbsp;n&nbsp;&gt;=&nbsp;0&nbsp;the&nbsp;number&nbsp;of&nbsp;results&nbsp;is&nbsp;limited&nbsp;---&nbsp;unless&nbsp;n&nbsp;&gt;=&nbsp;all&nbsp;results,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8477978">//&nbsp;we&nbsp;may&nbsp;obtain&nbsp;different&nbsp;positions&nbsp;from&nbsp;the&nbsp;Index&nbsp;and&nbsp;from&nbsp;find&nbsp;(because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8478054">//&nbsp;Index&nbsp;may&nbsp;not&nbsp;find&nbsp;the&nbsp;results&nbsp;in&nbsp;the&nbsp;same&nbsp;order&nbsp;as&nbsp;find)&nbsp;=&gt;&nbsp;in&nbsp;general</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8478130">//&nbsp;we&nbsp;cannot&nbsp;simply&nbsp;check&nbsp;that&nbsp;the&nbsp;res&nbsp;and&nbsp;exp&nbsp;lists&nbsp;are&nbsp;equal</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8478195">//&nbsp;check&nbsp;that&nbsp;each&nbsp;result&nbsp;is&nbsp;in&nbsp;fact&nbsp;a&nbsp;correct&nbsp;match&nbsp;and&nbsp;there&nbsp;are&nbsp;no&nbsp;duplicates</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8478277">sort</span><span class="op" id="8478281">.</span><span class="ident" id="8478282">Ints</span><span class="op" id="8478286">(</span><span class="ident" id="8478287">res</span><span class="op" id="8478290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8478293">for</span>&nbsp;<span class="ident" id="8478297">i</span><span class="op" id="8478298">,</span>&nbsp;<span class="ident" id="8478300">r</span>&nbsp;<span class="op" id="8478302">:=</span>&nbsp;<span class="keyword" id="8478305">range</span>&nbsp;<span class="ident" id="8478311">res</span>&nbsp;<span class="op" id="8478315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8478319">if</span>&nbsp;<span class="ident" id="8478322">r</span>&nbsp;<span class="op" id="8478324">&lt;</span>&nbsp;<span class="num" id="8478326">0</span>&nbsp;<span class="op" id="8478328">||</span>&nbsp;<span class="builtinfunc" id="8478331">len</span><span class="op" id="8478334">(</span><span class="ident" id="8478335">tc</span><span class="op" id="8478337">.</span><span class="ident" id="8478338">source</span><span class="op" id="8478344">)</span>&nbsp;<span class="op" id="8478346">&lt;=</span>&nbsp;<span class="ident" id="8478349">r</span>&nbsp;<span class="op" id="8478351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8478356">t</span><span class="op" id="8478357">.</span><span class="ident" id="8478358">Errorf</span><span class="op" id="8478364">(</span><span class="string" id="8478365">&#34;test&nbsp;%q,&nbsp;lookup&nbsp;%q,&nbsp;result&nbsp;%d&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;index&nbsp;%d&nbsp;out&nbsp;of&nbsp;range&nbsp;[0,&nbsp;%d[&#34;</span><span class="op" id="8478436">,</span>&nbsp;<span class="ident" id="8478438">tc</span><span class="op" id="8478440">.</span><span class="ident" id="8478441">name</span><span class="op" id="8478445">,</span>&nbsp;<span class="ident" id="8478447">s</span><span class="op" id="8478448">,</span>&nbsp;<span class="ident" id="8478450">i</span><span class="op" id="8478451">,</span>&nbsp;<span class="ident" id="8478453">n</span><span class="op" id="8478454">,</span>&nbsp;<span class="ident" id="8478456">r</span><span class="op" id="8478457">,</span>&nbsp;<span class="builtinfunc" id="8478459">len</span><span class="op" id="8478462">(</span><span class="ident" id="8478463">tc</span><span class="op" id="8478465">.</span><span class="ident" id="8478466">source</span><span class="op" id="8478472">)</span><span class="op" id="8478473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8478477">}</span>&nbsp;<span class="keyword" id="8478479">else</span>&nbsp;<span class="keyword" id="8478484">if</span>&nbsp;<span class="op" id="8478487">!</span><span class="ident" id="8478488">strings</span><span class="op" id="8478495">.</span><span class="ident" id="8478496">HasPrefix</span><span class="op" id="8478505">(</span><span class="ident" id="8478506">tc</span><span class="op" id="8478508">.</span><span class="ident" id="8478509">source</span><span class="op" id="8478515">[</span><span class="ident" id="8478516">r</span><span class="op" id="8478517">:</span><span class="op" id="8478518">]</span><span class="op" id="8478519">,</span>&nbsp;<span class="ident" id="8478521">s</span><span class="op" id="8478522">)</span>&nbsp;<span class="op" id="8478524">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8478529">t</span><span class="op" id="8478530">.</span><span class="ident" id="8478531">Errorf</span><span class="op" id="8478537">(</span><span class="string" id="8478538">&#34;test&nbsp;%q,&nbsp;lookup&nbsp;%q,&nbsp;result&nbsp;%d&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;index&nbsp;%d&nbsp;not&nbsp;a&nbsp;match&#34;</span><span class="op" id="8478600">,</span>&nbsp;<span class="ident" id="8478602">tc</span><span class="op" id="8478604">.</span><span class="ident" id="8478605">name</span><span class="op" id="8478609">,</span>&nbsp;<span class="ident" id="8478611">s</span><span class="op" id="8478612">,</span>&nbsp;<span class="ident" id="8478614">i</span><span class="op" id="8478615">,</span>&nbsp;<span class="ident" id="8478617">n</span><span class="op" id="8478618">,</span>&nbsp;<span class="ident" id="8478620">r</span><span class="op" id="8478621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8478625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8478629">if</span>&nbsp;<span class="ident" id="8478632">i</span>&nbsp;<span class="op" id="8478634">&gt;</span>&nbsp;<span class="num" id="8478636">0</span>&nbsp;<span class="op" id="8478638">&amp;&amp;</span>&nbsp;<span class="ident" id="8478641">res</span><span class="op" id="8478644">[</span><span class="ident" id="8478645">i</span><span class="op" id="8478646">-</span><span class="num" id="8478647">1</span><span class="op" id="8478648">]</span>&nbsp;<span class="op" id="8478650">==</span>&nbsp;<span class="ident" id="8478653">r</span>&nbsp;<span class="op" id="8478655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8478660">t</span><span class="op" id="8478661">.</span><span class="ident" id="8478662">Errorf</span><span class="op" id="8478668">(</span><span class="string" id="8478669">&#34;test&nbsp;%q,&nbsp;lookup&nbsp;%q,&nbsp;result&nbsp;%d&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;found&nbsp;duplicate&nbsp;index&nbsp;%d&#34;</span><span class="op" id="8478735">,</span>&nbsp;<span class="ident" id="8478737">tc</span><span class="op" id="8478739">.</span><span class="ident" id="8478740">name</span><span class="op" id="8478744">,</span>&nbsp;<span class="ident" id="8478746">s</span><span class="op" id="8478747">,</span>&nbsp;<span class="ident" id="8478749">i</span><span class="op" id="8478750">,</span>&nbsp;<span class="ident" id="8478752">n</span><span class="op" id="8478753">,</span>&nbsp;<span class="ident" id="8478755">r</span><span class="op" id="8478756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8478760">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8478763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8478767">if</span>&nbsp;<span class="ident" id="8478770">n</span>&nbsp;<span class="op" id="8478772">&lt;</span>&nbsp;<span class="num" id="8478774">0</span>&nbsp;<span class="op" id="8478776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8478780">//&nbsp;all&nbsp;results&nbsp;computed&nbsp;-&nbsp;sorted&nbsp;res&nbsp;and&nbsp;exp&nbsp;must&nbsp;be&nbsp;equal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8478841">for</span>&nbsp;<span class="ident" id="8478845">i</span><span class="op" id="8478846">,</span>&nbsp;<span class="ident" id="8478848">r</span>&nbsp;<span class="op" id="8478850">:=</span>&nbsp;<span class="keyword" id="8478853">range</span>&nbsp;<span class="ident" id="8478859">res</span>&nbsp;<span class="op" id="8478863">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8478868">e</span>&nbsp;<span class="op" id="8478870">:=</span>&nbsp;<span class="ident" id="8478873">exp</span><span class="op" id="8478876">[</span><span class="ident" id="8478877">i</span><span class="op" id="8478878">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8478883">if</span>&nbsp;<span class="ident" id="8478886">r</span>&nbsp;<span class="op" id="8478888">!=</span>&nbsp;<span class="ident" id="8478891">e</span>&nbsp;<span class="op" id="8478893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8478899">t</span><span class="op" id="8478900">.</span><span class="ident" id="8478901">Errorf</span><span class="op" id="8478907">(</span><span class="string" id="8478908">&#34;test&nbsp;%q,&nbsp;lookup&nbsp;%q,&nbsp;result&nbsp;%d:&nbsp;expected&nbsp;index&nbsp;%d;&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8478966">,</span>&nbsp;<span class="ident" id="8478968">tc</span><span class="op" id="8478970">.</span><span class="ident" id="8478971">name</span><span class="op" id="8478975">,</span>&nbsp;<span class="ident" id="8478977">s</span><span class="op" id="8478978">,</span>&nbsp;<span class="ident" id="8478980">i</span><span class="op" id="8478981">,</span>&nbsp;<span class="ident" id="8478983">e</span><span class="op" id="8478984">,</span>&nbsp;<span class="ident" id="8478986">r</span><span class="op" id="8478987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8478992">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8478996">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8478999">}</span><br>
<span class="lineno"></span><span class="op" id="8479001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8479004">func</span>&nbsp;<span class="ident" id="8479009">testFindAllIndex</span><span class="op" id="8479025">(</span><span class="ident" id="8479026">t</span>&nbsp;<span class="op" id="8479028">*</span><span class="ident" id="8479029">testing</span><span class="op" id="8479036">.</span><span class="ident" id="8479037">T</span><span class="op" id="8479038">,</span>&nbsp;<span class="ident" id="8479040">tc</span>&nbsp;<span class="op" id="8479043">*</span><span class="ident" id="8479044">testCase</span><span class="op" id="8479052">,</span>&nbsp;<span class="ident" id="8479054">x</span>&nbsp;<span class="op" id="8479056">*</span><span class="ident" id="8479057">Index</span><span class="op" id="8479062">,</span>&nbsp;<span class="ident" id="8479064">rx</span>&nbsp;<span class="op" id="8479067">*</span><span class="ident" id="8479068">regexp</span><span class="op" id="8479074">.</span><span class="ident" id="8479075">Regexp</span><span class="op" id="8479081">,</span>&nbsp;<span class="ident" id="8479083">n</span>&nbsp;<span class="builtintype" id="8479085">int</span><span class="op" id="8479088">)</span>&nbsp;<span class="op" id="8479090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8479093">res</span>&nbsp;<span class="op" id="8479097">:=</span>&nbsp;<span class="ident" id="8479100">x</span><span class="op" id="8479101">.</span><span class="ident" id="8479102">FindAllIndex</span><span class="op" id="8479114">(</span><span class="ident" id="8479115">rx</span><span class="op" id="8479117">,</span>&nbsp;<span class="ident" id="8479119">n</span><span class="op" id="8479120">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8479123">exp</span>&nbsp;<span class="op" id="8479127">:=</span>&nbsp;<span class="ident" id="8479130">rx</span><span class="op" id="8479132">.</span><span class="ident" id="8479133">FindAllStringIndex</span><span class="op" id="8479151">(</span><span class="ident" id="8479152">tc</span><span class="op" id="8479154">.</span><span class="ident" id="8479155">source</span><span class="op" id="8479161">,</span>&nbsp;<span class="ident" id="8479163">n</span><span class="op" id="8479164">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8479168">//&nbsp;check&nbsp;that&nbsp;the&nbsp;lengths&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8479201">if</span>&nbsp;<span class="builtinfunc" id="8479204">len</span><span class="op" id="8479207">(</span><span class="ident" id="8479208">res</span><span class="op" id="8479211">)</span>&nbsp;<span class="op" id="8479213">!=</span>&nbsp;<span class="builtinfunc" id="8479216">len</span><span class="op" id="8479219">(</span><span class="ident" id="8479220">exp</span><span class="op" id="8479223">)</span>&nbsp;<span class="op" id="8479225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8479229">t</span><span class="op" id="8479230">.</span><span class="ident" id="8479231">Errorf</span><span class="op" id="8479237">(</span><span class="string" id="8479238">&#34;test&nbsp;%q,&nbsp;FindAllIndex&nbsp;%q&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;expected&nbsp;%d&nbsp;results;&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8479302">,</span>&nbsp;<span class="ident" id="8479304">tc</span><span class="op" id="8479306">.</span><span class="ident" id="8479307">name</span><span class="op" id="8479311">,</span>&nbsp;<span class="ident" id="8479313">rx</span><span class="op" id="8479315">,</span>&nbsp;<span class="ident" id="8479317">n</span><span class="op" id="8479318">,</span>&nbsp;<span class="builtinfunc" id="8479320">len</span><span class="op" id="8479323">(</span><span class="ident" id="8479324">exp</span><span class="op" id="8479327">)</span><span class="op" id="8479328">,</span>&nbsp;<span class="builtinfunc" id="8479330">len</span><span class="op" id="8479333">(</span><span class="ident" id="8479334">res</span><span class="op" id="8479337">)</span><span class="op" id="8479338">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8479341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8479345">//&nbsp;if&nbsp;n&nbsp;&gt;=&nbsp;0&nbsp;the&nbsp;number&nbsp;of&nbsp;results&nbsp;is&nbsp;limited&nbsp;---&nbsp;unless&nbsp;n&nbsp;&gt;=&nbsp;all&nbsp;results,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8479421">//&nbsp;we&nbsp;may&nbsp;obtain&nbsp;different&nbsp;positions&nbsp;from&nbsp;the&nbsp;Index&nbsp;and&nbsp;from&nbsp;regexp&nbsp;(because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8479499">//&nbsp;Index&nbsp;may&nbsp;not&nbsp;find&nbsp;the&nbsp;results&nbsp;in&nbsp;the&nbsp;same&nbsp;order&nbsp;as&nbsp;regexp)&nbsp;=&gt;&nbsp;in&nbsp;general</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8479577">//&nbsp;we&nbsp;cannot&nbsp;simply&nbsp;check&nbsp;that&nbsp;the&nbsp;res&nbsp;and&nbsp;exp&nbsp;lists&nbsp;are&nbsp;equal</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8479642">//&nbsp;check&nbsp;that&nbsp;each&nbsp;result&nbsp;is&nbsp;in&nbsp;fact&nbsp;a&nbsp;correct&nbsp;match&nbsp;and&nbsp;the&nbsp;result&nbsp;is&nbsp;sorted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8479721">for</span>&nbsp;<span class="ident" id="8479725">i</span><span class="op" id="8479726">,</span>&nbsp;<span class="ident" id="8479728">r</span>&nbsp;<span class="op" id="8479730">:=</span>&nbsp;<span class="keyword" id="8479733">range</span>&nbsp;<span class="ident" id="8479739">res</span>&nbsp;<span class="op" id="8479743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8479747">if</span>&nbsp;<span class="ident" id="8479750">r</span><span class="op" id="8479751">[</span><span class="num" id="8479752">0</span><span class="op" id="8479753">]</span>&nbsp;<span class="op" id="8479755">&lt;</span>&nbsp;<span class="num" id="8479757">0</span>&nbsp;<span class="op" id="8479759">||</span>&nbsp;<span class="ident" id="8479762">r</span><span class="op" id="8479763">[</span><span class="num" id="8479764">0</span><span class="op" id="8479765">]</span>&nbsp;<span class="op" id="8479767">&gt;</span>&nbsp;<span class="ident" id="8479769">r</span><span class="op" id="8479770">[</span><span class="num" id="8479771">1</span><span class="op" id="8479772">]</span>&nbsp;<span class="op" id="8479774">||</span>&nbsp;<span class="builtinfunc" id="8479777">len</span><span class="op" id="8479780">(</span><span class="ident" id="8479781">tc</span><span class="op" id="8479783">.</span><span class="ident" id="8479784">source</span><span class="op" id="8479790">)</span>&nbsp;<span class="op" id="8479792">&lt;</span>&nbsp;<span class="ident" id="8479794">r</span><span class="op" id="8479795">[</span><span class="num" id="8479796">1</span><span class="op" id="8479797">]</span>&nbsp;<span class="op" id="8479799">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8479804">t</span><span class="op" id="8479805">.</span><span class="ident" id="8479806">Errorf</span><span class="op" id="8479812">(</span><span class="string" id="8479813">&#34;test&nbsp;%q,&nbsp;FindAllIndex&nbsp;%q,&nbsp;result&nbsp;%d&nbsp;(n&nbsp;==&nbsp;%d):&nbsp;illegal&nbsp;match&nbsp;[%d,&nbsp;%d]&#34;</span><span class="op" id="8479884">,</span>&nbsp;<span class="ident" id="8479886">tc</span><span class="op" id="8479888">.</span><span class="ident" id="8479889">name</span><span class="op" id="8479893">,</span>&nbsp;<span class="ident" id="8479895">rx</span><span class="op" id="8479897">,</span>&nbsp;<span class="ident" id="8479899">i</span><span class="op" id="8479900">,</span>&nbsp;<span class="ident" id="8479902">n</span><span class="op" id="8479903">,</span>&nbsp;<span class="ident" id="8479905">r</span><span class="op" id="8479906">[</span><span class="num" id="8479907">0</span><span class="op" id="8479908">]</span><span class="op" id="8479909">,</span>&nbsp;<span class="ident" id="8479911">r</span><span class="op" id="8479912">[</span><span class="num" id="8479913">1</span><span class="op" id="8479914">]</span><span class="op" id="8479915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8479919">}</span>&nbsp;<span class="keyword" id="8479921">else</span>&nbsp;<span class="keyword" id="8479926">if</span>&nbsp;<span class="op" id="8479929">!</span><span class="ident" id="8479930">rx</span><span class="op" id="8479932">.</span><span class="ident" id="8479933">MatchString</span><span class="op" id="8479944">(</span><span class="ident" id="8479945">tc</span><span class="op" id="8479947">.</span><span class="ident" id="8479948">source</span><span class="op" id="8479954">[</span><span class="ident" id="8479955">r</span><span class="op" id="8479956">[</span><span class="num" id="8479957">0</span><span class="op" id="8479958">]</span><span class="op" id="8479959">:</span><span class="ident" id="8479960">r</span><span class="op" id="8479961">[</span><span class="num" id="8479962">1</span><span class="op" id="8479963">]</span><span class="op" id="8479964">]</span><span class="op" id="8479965">)</span>&nbsp;<span class="op" id="8479967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8479972">t</span><span class="op" id="8479973">.</span><span class="ident" id="8479974">Errorf</span><span class="op" id="8479980">(</span><span class="string" id="8479981">&#34;test&nbsp;%q,&nbsp;FindAllIndex&nbsp;%q,&nbsp;result&nbsp;%d&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;[%d,&nbsp;%d]&nbsp;not&nbsp;a&nbsp;match&#34;</span><span class="op" id="8480049">,</span>&nbsp;<span class="ident" id="8480051">tc</span><span class="op" id="8480053">.</span><span class="ident" id="8480054">name</span><span class="op" id="8480058">,</span>&nbsp;<span class="ident" id="8480060">rx</span><span class="op" id="8480062">,</span>&nbsp;<span class="ident" id="8480064">i</span><span class="op" id="8480065">,</span>&nbsp;<span class="ident" id="8480067">n</span><span class="op" id="8480068">,</span>&nbsp;<span class="ident" id="8480070">r</span><span class="op" id="8480071">[</span><span class="num" id="8480072">0</span><span class="op" id="8480073">]</span><span class="op" id="8480074">,</span>&nbsp;<span class="ident" id="8480076">r</span><span class="op" id="8480077">[</span><span class="num" id="8480078">1</span><span class="op" id="8480079">]</span><span class="op" id="8480080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8480084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8480087">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8480091">if</span>&nbsp;<span class="ident" id="8480094">n</span>&nbsp;<span class="op" id="8480096">&lt;</span>&nbsp;<span class="num" id="8480098">0</span>&nbsp;<span class="op" id="8480100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8480104">//&nbsp;all&nbsp;results&nbsp;computed&nbsp;-&nbsp;sorted&nbsp;res&nbsp;and&nbsp;exp&nbsp;must&nbsp;be&nbsp;equal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8480165">for</span>&nbsp;<span class="ident" id="8480169">i</span><span class="op" id="8480170">,</span>&nbsp;<span class="ident" id="8480172">r</span>&nbsp;<span class="op" id="8480174">:=</span>&nbsp;<span class="keyword" id="8480177">range</span>&nbsp;<span class="ident" id="8480183">res</span>&nbsp;<span class="op" id="8480187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8480192">e</span>&nbsp;<span class="op" id="8480194">:=</span>&nbsp;<span class="ident" id="8480197">exp</span><span class="op" id="8480200">[</span><span class="ident" id="8480201">i</span><span class="op" id="8480202">]</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8480207">if</span>&nbsp;<span class="ident" id="8480210">r</span><span class="op" id="8480211">[</span><span class="num" id="8480212">0</span><span class="op" id="8480213">]</span>&nbsp;<span class="op" id="8480215">!=</span>&nbsp;<span class="ident" id="8480218">e</span><span class="op" id="8480219">[</span><span class="num" id="8480220">0</span><span class="op" id="8480221">]</span>&nbsp;<span class="op" id="8480223">||</span>&nbsp;<span class="ident" id="8480226">r</span><span class="op" id="8480227">[</span><span class="num" id="8480228">1</span><span class="op" id="8480229">]</span>&nbsp;<span class="op" id="8480231">!=</span>&nbsp;<span class="ident" id="8480234">e</span><span class="op" id="8480235">[</span><span class="num" id="8480236">1</span><span class="op" id="8480237">]</span>&nbsp;<span class="op" id="8480239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8480245">t</span><span class="op" id="8480246">.</span><span class="ident" id="8480247">Errorf</span><span class="op" id="8480253">(</span><span class="string" id="8480254">&#34;test&nbsp;%q,&nbsp;FindAllIndex&nbsp;%q,&nbsp;result&nbsp;%d:&nbsp;expected&nbsp;match&nbsp;[%d,&nbsp;%d];&nbsp;got&nbsp;[%d,&nbsp;%d]&#34;</span><span class="op" id="8480330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8480337">tc</span><span class="op" id="8480339">.</span><span class="ident" id="8480340">name</span><span class="op" id="8480344">,</span>&nbsp;<span class="ident" id="8480346">rx</span><span class="op" id="8480348">,</span>&nbsp;<span class="ident" id="8480350">i</span><span class="op" id="8480351">,</span>&nbsp;<span class="ident" id="8480353">e</span><span class="op" id="8480354">[</span><span class="num" id="8480355">0</span><span class="op" id="8480356">]</span><span class="op" id="8480357">,</span>&nbsp;<span class="ident" id="8480359">e</span><span class="op" id="8480360">[</span><span class="num" id="8480361">1</span><span class="op" id="8480362">]</span><span class="op" id="8480363">,</span>&nbsp;<span class="ident" id="8480365">r</span><span class="op" id="8480366">[</span><span class="num" id="8480367">0</span><span class="op" id="8480368">]</span><span class="op" id="8480369">,</span>&nbsp;<span class="ident" id="8480371">r</span><span class="op" id="8480372">[</span><span class="num" id="8480373">1</span><span class="op" id="8480374">]</span><span class="op" id="8480375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8480380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8480384">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8480387">}</span><br>
<span class="lineno"></span><span class="op" id="8480389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8480392">func</span>&nbsp;<span class="ident" id="8480397">testLookups</span><span class="op" id="8480408">(</span><span class="ident" id="8480409">t</span>&nbsp;<span class="op" id="8480411">*</span><span class="ident" id="8480412">testing</span><span class="op" id="8480419">.</span><span class="ident" id="8480420">T</span><span class="op" id="8480421">,</span>&nbsp;<span class="ident" id="8480423">tc</span>&nbsp;<span class="op" id="8480426">*</span><span class="ident" id="8480427">testCase</span><span class="op" id="8480435">,</span>&nbsp;<span class="ident" id="8480437">x</span>&nbsp;<span class="op" id="8480439">*</span><span class="ident" id="8480440">Index</span><span class="op" id="8480445">,</span>&nbsp;<span class="ident" id="8480447">n</span>&nbsp;<span class="builtintype" id="8480449">int</span><span class="op" id="8480452">)</span>&nbsp;<span class="op" id="8480454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8480457">for</span>&nbsp;<span class="ident" id="8480461">_</span><span class="op" id="8480462">,</span>&nbsp;<span class="ident" id="8480464">pat</span>&nbsp;<span class="op" id="8480468">:=</span>&nbsp;<span class="keyword" id="8480471">range</span>&nbsp;<span class="ident" id="8480477">tc</span><span class="op" id="8480479">.</span><span class="ident" id="8480480">patterns</span>&nbsp;<span class="op" id="8480489">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8480493">testLookup</span><span class="op" id="8480503">(</span><span class="ident" id="8480504">t</span><span class="op" id="8480505">,</span>&nbsp;<span class="ident" id="8480507">tc</span><span class="op" id="8480509">,</span>&nbsp;<span class="ident" id="8480511">x</span><span class="op" id="8480512">,</span>&nbsp;<span class="ident" id="8480514">pat</span><span class="op" id="8480517">,</span>&nbsp;<span class="ident" id="8480519">n</span><span class="op" id="8480520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8480524">if</span>&nbsp;<span class="ident" id="8480527">rx</span><span class="op" id="8480529">,</span>&nbsp;<span class="ident" id="8480531">err</span>&nbsp;<span class="op" id="8480535">:=</span>&nbsp;<span class="ident" id="8480538">regexp</span><span class="op" id="8480544">.</span><span class="ident" id="8480545">Compile</span><span class="op" id="8480552">(</span><span class="ident" id="8480553">pat</span><span class="op" id="8480556">)</span><span class="op" id="8480557">;</span>&nbsp;<span class="ident" id="8480559">err</span>&nbsp;<span class="op" id="8480563">==</span>&nbsp;<span class="ident" id="8480566">nil</span>&nbsp;<span class="op" id="8480570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8480575">testFindAllIndex</span><span class="op" id="8480591">(</span><span class="ident" id="8480592">t</span><span class="op" id="8480593">,</span>&nbsp;<span class="ident" id="8480595">tc</span><span class="op" id="8480597">,</span>&nbsp;<span class="ident" id="8480599">x</span><span class="op" id="8480600">,</span>&nbsp;<span class="ident" id="8480602">rx</span><span class="op" id="8480604">,</span>&nbsp;<span class="ident" id="8480606">n</span><span class="op" id="8480607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8480611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8480614">}</span><br>
<span class="lineno">205</span><span class="op" id="8480616">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8480619">//&nbsp;index&nbsp;is&nbsp;used&nbsp;to&nbsp;hide&nbsp;the&nbsp;sort.Interface</span><br>
<span class="lineno"></span><span class="keyword" id="8480663">type</span>&nbsp;<span class="ident" id="8480668">index</span>&nbsp;<span class="ident" id="8480674">Index</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span><span class="keyword" id="8480681">func</span>&nbsp;<span class="op" id="8480686">(</span><span class="ident" id="8480687">x</span>&nbsp;<span class="op" id="8480689">*</span><span class="ident" id="8480690">index</span><span class="op" id="8480695">)</span>&nbsp;<span class="ident" id="8480697">Len</span><span class="op" id="8480700">(</span><span class="op" id="8480701">)</span>&nbsp;<span class="builtintype" id="8480703">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8480717">{</span>&nbsp;<span class="keyword" id="8480719">return</span>&nbsp;<span class="builtinfunc" id="8480726">len</span><span class="op" id="8480729">(</span><span class="ident" id="8480730">x</span><span class="op" id="8480731">.</span><span class="ident" id="8480732">sa</span><span class="op" id="8480734">)</span>&nbsp;<span class="op" id="8480736">}</span><br>
<span class="lineno"></span><span class="keyword" id="8480738">func</span>&nbsp;<span class="op" id="8480743">(</span><span class="ident" id="8480744">x</span>&nbsp;<span class="op" id="8480746">*</span><span class="ident" id="8480747">index</span><span class="op" id="8480752">)</span>&nbsp;<span class="ident" id="8480754">Less</span><span class="op" id="8480758">(</span><span class="ident" id="8480759">i</span><span class="op" id="8480760">,</span>&nbsp;<span class="ident" id="8480762">j</span>&nbsp;<span class="builtintype" id="8480764">int</span><span class="op" id="8480767">)</span>&nbsp;<span class="builtintype" id="8480769">bool</span>&nbsp;<span class="op" id="8480774">{</span>&nbsp;<span class="keyword" id="8480776">return</span>&nbsp;<span class="ident" id="8480783">bytes</span><span class="op" id="8480788">.</span><span class="ident" id="8480789">Compare</span><span class="op" id="8480796">(</span><span class="ident" id="8480797">x</span><span class="op" id="8480798">.</span><span class="ident" id="8480799">at</span><span class="op" id="8480801">(</span><span class="ident" id="8480802">i</span><span class="op" id="8480803">)</span><span class="op" id="8480804">,</span>&nbsp;<span class="ident" id="8480806">x</span><span class="op" id="8480807">.</span><span class="ident" id="8480808">at</span><span class="op" id="8480810">(</span><span class="ident" id="8480811">j</span><span class="op" id="8480812">)</span><span class="op" id="8480813">)</span>&nbsp;<span class="op" id="8480815">&lt;</span>&nbsp;<span class="num" id="8480817">0</span>&nbsp;<span class="op" id="8480819">}</span><br>
<span class="lineno"></span><span class="keyword" id="8480821">func</span>&nbsp;<span class="op" id="8480826">(</span><span class="ident" id="8480827">x</span>&nbsp;<span class="op" id="8480829">*</span><span class="ident" id="8480830">index</span><span class="op" id="8480835">)</span>&nbsp;<span class="ident" id="8480837">Swap</span><span class="op" id="8480841">(</span><span class="ident" id="8480842">i</span><span class="op" id="8480843">,</span>&nbsp;<span class="ident" id="8480845">j</span>&nbsp;<span class="builtintype" id="8480847">int</span><span class="op" id="8480850">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8480857">{</span>&nbsp;<span class="ident" id="8480859">x</span><span class="op" id="8480860">.</span><span class="ident" id="8480861">sa</span><span class="op" id="8480863">[</span><span class="ident" id="8480864">i</span><span class="op" id="8480865">]</span><span class="op" id="8480866">,</span>&nbsp;<span class="ident" id="8480868">x</span><span class="op" id="8480869">.</span><span class="ident" id="8480870">sa</span><span class="op" id="8480872">[</span><span class="ident" id="8480873">j</span><span class="op" id="8480874">]</span>&nbsp;<span class="op" id="8480876">=</span>&nbsp;<span class="ident" id="8480878">x</span><span class="op" id="8480879">.</span><span class="ident" id="8480880">sa</span><span class="op" id="8480882">[</span><span class="ident" id="8480883">j</span><span class="op" id="8480884">]</span><span class="op" id="8480885">,</span>&nbsp;<span class="ident" id="8480887">x</span><span class="op" id="8480888">.</span><span class="ident" id="8480889">sa</span><span class="op" id="8480891">[</span><span class="ident" id="8480892">i</span><span class="op" id="8480893">]</span>&nbsp;<span class="op" id="8480895">}</span><br>
<span class="lineno"></span><span class="keyword" id="8480897">func</span>&nbsp;<span class="op" id="8480902">(</span><span class="ident" id="8480903">a</span>&nbsp;<span class="op" id="8480905">*</span><span class="ident" id="8480906">index</span><span class="op" id="8480911">)</span>&nbsp;<span class="ident" id="8480913">at</span><span class="op" id="8480915">(</span><span class="ident" id="8480916">i</span>&nbsp;<span class="builtintype" id="8480918">int</span><span class="op" id="8480921">)</span>&nbsp;<span class="op" id="8480923">[</span><span class="op" id="8480924">]</span><span class="builtintype" id="8480925">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8480933">{</span>&nbsp;<span class="keyword" id="8480935">return</span>&nbsp;<span class="ident" id="8480942">a</span><span class="op" id="8480943">.</span><span class="ident" id="8480944">data</span><span class="op" id="8480948">[</span><span class="ident" id="8480949">a</span><span class="op" id="8480950">.</span><span class="ident" id="8480951">sa</span><span class="op" id="8480953">[</span><span class="ident" id="8480954">i</span><span class="op" id="8480955">]</span><span class="op" id="8480956">:</span><span class="op" id="8480957">]</span>&nbsp;<span class="op" id="8480959">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="8480962">func</span>&nbsp;<span class="ident" id="8480967">testConstruction</span><span class="op" id="8480983">(</span><span class="ident" id="8480984">t</span>&nbsp;<span class="op" id="8480986">*</span><span class="ident" id="8480987">testing</span><span class="op" id="8480994">.</span><span class="ident" id="8480995">T</span><span class="op" id="8480996">,</span>&nbsp;<span class="ident" id="8480998">tc</span>&nbsp;<span class="op" id="8481001">*</span><span class="ident" id="8481002">testCase</span><span class="op" id="8481010">,</span>&nbsp;<span class="ident" id="8481012">x</span>&nbsp;<span class="op" id="8481014">*</span><span class="ident" id="8481015">Index</span><span class="op" id="8481020">)</span>&nbsp;<span class="op" id="8481022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8481025">if</span>&nbsp;<span class="op" id="8481028">!</span><span class="ident" id="8481029">sort</span><span class="op" id="8481033">.</span><span class="ident" id="8481034">IsSorted</span><span class="op" id="8481042">(</span><span class="op" id="8481043">(</span><span class="op" id="8481044">*</span><span class="ident" id="8481045">index</span><span class="op" id="8481050">)</span><span class="op" id="8481051">(</span><span class="ident" id="8481052">x</span><span class="op" id="8481053">)</span><span class="op" id="8481054">)</span>&nbsp;<span class="op" id="8481056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8481060">t</span><span class="op" id="8481061">.</span><span class="ident" id="8481062">Errorf</span><span class="op" id="8481068">(</span><span class="string" id="8481069">&#34;failed&nbsp;testConstruction&nbsp;%s&#34;</span><span class="op" id="8481097">,</span>&nbsp;<span class="ident" id="8481099">tc</span><span class="op" id="8481101">.</span><span class="ident" id="8481102">name</span><span class="op" id="8481106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8481109">}</span><br>
<span class="lineno"></span><span class="op" id="8481111">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="keyword" id="8481114">func</span>&nbsp;<span class="ident" id="8481119">equal</span><span class="op" id="8481124">(</span><span class="ident" id="8481125">x</span><span class="op" id="8481126">,</span>&nbsp;<span class="ident" id="8481128">y</span>&nbsp;<span class="op" id="8481130">*</span><span class="ident" id="8481131">Index</span><span class="op" id="8481136">)</span>&nbsp;<span class="builtintype" id="8481138">bool</span>&nbsp;<span class="op" id="8481143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8481146">if</span>&nbsp;<span class="op" id="8481149">!</span><span class="ident" id="8481150">bytes</span><span class="op" id="8481155">.</span><span class="ident" id="8481156">Equal</span><span class="op" id="8481161">(</span><span class="ident" id="8481162">x</span><span class="op" id="8481163">.</span><span class="ident" id="8481164">data</span><span class="op" id="8481168">,</span>&nbsp;<span class="ident" id="8481170">y</span><span class="op" id="8481171">.</span><span class="ident" id="8481172">data</span><span class="op" id="8481176">)</span>&nbsp;<span class="op" id="8481178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8481182">return</span>&nbsp;<span class="builtintype" id="8481189">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8481196">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8481199">for</span>&nbsp;<span class="ident" id="8481203">i</span><span class="op" id="8481204">,</span>&nbsp;<span class="ident" id="8481206">j</span>&nbsp;<span class="op" id="8481208">:=</span>&nbsp;<span class="keyword" id="8481211">range</span>&nbsp;<span class="ident" id="8481217">x</span><span class="op" id="8481218">.</span><span class="ident" id="8481219">sa</span>&nbsp;<span class="op" id="8481222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8481226">if</span>&nbsp;<span class="ident" id="8481229">j</span>&nbsp;<span class="op" id="8481231">!=</span>&nbsp;<span class="ident" id="8481234">y</span><span class="op" id="8481235">.</span><span class="ident" id="8481236">sa</span><span class="op" id="8481238">[</span><span class="ident" id="8481239">i</span><span class="op" id="8481240">]</span>&nbsp;<span class="op" id="8481242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8481247">return</span>&nbsp;<span class="builtintype" id="8481254">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8481262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8481265">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8481268">return</span>&nbsp;<span class="builtintype" id="8481275">true</span><br>
<span class="lineno"></span><span class="op" id="8481280">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8481283">//&nbsp;returns&nbsp;the&nbsp;serialized&nbsp;index&nbsp;size</span><br>
<span class="lineno"></span><span class="keyword" id="8481320">func</span>&nbsp;<span class="ident" id="8481325">testSaveRestore</span><span class="op" id="8481340">(</span><span class="ident" id="8481341">t</span>&nbsp;<span class="op" id="8481343">*</span><span class="ident" id="8481344">testing</span><span class="op" id="8481351">.</span><span class="ident" id="8481352">T</span><span class="op" id="8481353">,</span>&nbsp;<span class="ident" id="8481355">tc</span>&nbsp;<span class="op" id="8481358">*</span><span class="ident" id="8481359">testCase</span><span class="op" id="8481367">,</span>&nbsp;<span class="ident" id="8481369">x</span>&nbsp;<span class="op" id="8481371">*</span><span class="ident" id="8481372">Index</span><span class="op" id="8481377">)</span>&nbsp;<span class="builtintype" id="8481379">int</span>&nbsp;<span class="op" id="8481383">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8481386">var</span>&nbsp;<span class="ident" id="8481390">buf</span>&nbsp;<span class="ident" id="8481394">bytes</span><span class="op" id="8481399">.</span><span class="ident" id="8481400">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8481408">if</span>&nbsp;<span class="ident" id="8481411">err</span>&nbsp;<span class="op" id="8481415">:=</span>&nbsp;<span class="ident" id="8481418">x</span><span class="op" id="8481419">.</span><span class="ident" id="8481420">Write</span><span class="op" id="8481425">(</span><span class="op" id="8481426">&amp;</span><span class="ident" id="8481427">buf</span><span class="op" id="8481430">)</span><span class="op" id="8481431">;</span>&nbsp;<span class="ident" id="8481433">err</span>&nbsp;<span class="op" id="8481437">!=</span>&nbsp;<span class="ident" id="8481440">nil</span>&nbsp;<span class="op" id="8481444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8481448">t</span><span class="op" id="8481449">.</span><span class="ident" id="8481450">Errorf</span><span class="op" id="8481456">(</span><span class="string" id="8481457">&#34;failed&nbsp;writing&nbsp;index&nbsp;%s&nbsp;(%s)&#34;</span><span class="op" id="8481487">,</span>&nbsp;<span class="ident" id="8481489">tc</span><span class="op" id="8481491">.</span><span class="ident" id="8481492">name</span><span class="op" id="8481496">,</span>&nbsp;<span class="ident" id="8481498">err</span><span class="op" id="8481501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8481504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8481507">size</span>&nbsp;<span class="op" id="8481512">:=</span>&nbsp;<span class="ident" id="8481515">buf</span><span class="op" id="8481518">.</span><span class="ident" id="8481519">Len</span><span class="op" id="8481522">(</span><span class="op" id="8481523">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8481526">var</span>&nbsp;<span class="ident" id="8481530">y</span>&nbsp;<span class="ident" id="8481532">Index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8481539">if</span>&nbsp;<span class="ident" id="8481542">err</span>&nbsp;<span class="op" id="8481546">:=</span>&nbsp;<span class="ident" id="8481549">y</span><span class="op" id="8481550">.</span><span class="ident" id="8481551">Read</span><span class="op" id="8481555">(</span><span class="op" id="8481556">&amp;</span><span class="ident" id="8481557">buf</span><span class="op" id="8481560">)</span><span class="op" id="8481561">;</span>&nbsp;<span class="ident" id="8481563">err</span>&nbsp;<span class="op" id="8481567">!=</span>&nbsp;<span class="ident" id="8481570">nil</span>&nbsp;<span class="op" id="8481574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8481578">t</span><span class="op" id="8481579">.</span><span class="ident" id="8481580">Errorf</span><span class="op" id="8481586">(</span><span class="string" id="8481587">&#34;failed&nbsp;reading&nbsp;index&nbsp;%s&nbsp;(%s)&#34;</span><span class="op" id="8481617">,</span>&nbsp;<span class="ident" id="8481619">tc</span><span class="op" id="8481621">.</span><span class="ident" id="8481622">name</span><span class="op" id="8481626">,</span>&nbsp;<span class="ident" id="8481628">err</span><span class="op" id="8481631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8481634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8481637">if</span>&nbsp;<span class="op" id="8481640">!</span><span class="ident" id="8481641">equal</span><span class="op" id="8481646">(</span><span class="ident" id="8481647">x</span><span class="op" id="8481648">,</span>&nbsp;<span class="op" id="8481650">&amp;</span><span class="ident" id="8481651">y</span><span class="op" id="8481652">)</span>&nbsp;<span class="op" id="8481654">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8481658">t</span><span class="op" id="8481659">.</span><span class="ident" id="8481660">Errorf</span><span class="op" id="8481666">(</span><span class="string" id="8481667">&#34;restored&nbsp;index&nbsp;doesn&#39;t&nbsp;match&nbsp;saved&nbsp;index&nbsp;%s&#34;</span><span class="op" id="8481712">,</span>&nbsp;<span class="ident" id="8481714">tc</span><span class="op" id="8481716">.</span><span class="ident" id="8481717">name</span><span class="op" id="8481721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8481724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8481727">return</span>&nbsp;<span class="ident" id="8481734">size</span><br>
<span class="lineno"></span><span class="op" id="8481739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="8481742">func</span>&nbsp;<span class="ident" id="8481747">TestIndex</span><span class="op" id="8481756">(</span><span class="ident" id="8481757">t</span>&nbsp;<span class="op" id="8481759">*</span><span class="ident" id="8481760">testing</span><span class="op" id="8481767">.</span><span class="ident" id="8481768">T</span><span class="op" id="8481769">)</span>&nbsp;<span class="op" id="8481771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8481774">for</span>&nbsp;<span class="ident" id="8481778">_</span><span class="op" id="8481779">,</span>&nbsp;<span class="ident" id="8481781">tc</span>&nbsp;<span class="op" id="8481784">:=</span>&nbsp;<span class="keyword" id="8481787">range</span>&nbsp;<span class="ident" id="8481793">testCases</span>&nbsp;<span class="op" id="8481803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8481807">x</span>&nbsp;<span class="op" id="8481809">:=</span>&nbsp;<span class="ident" id="8481812">New</span><span class="op" id="8481815">(</span><span class="op" id="8481816">[</span><span class="op" id="8481817">]</span><span class="builtintype" id="8481818">byte</span><span class="op" id="8481822">(</span><span class="ident" id="8481823">tc</span><span class="op" id="8481825">.</span><span class="ident" id="8481826">source</span><span class="op" id="8481832">)</span><span class="op" id="8481833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8481837">testConstruction</span><span class="op" id="8481853">(</span><span class="ident" id="8481854">t</span><span class="op" id="8481855">,</span>&nbsp;<span class="op" id="8481857">&amp;</span><span class="ident" id="8481858">tc</span><span class="op" id="8481860">,</span>&nbsp;<span class="ident" id="8481862">x</span><span class="op" id="8481863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8481867">testSaveRestore</span><span class="op" id="8481882">(</span><span class="ident" id="8481883">t</span><span class="op" id="8481884">,</span>&nbsp;<span class="op" id="8481886">&amp;</span><span class="ident" id="8481887">tc</span><span class="op" id="8481889">,</span>&nbsp;<span class="ident" id="8481891">x</span><span class="op" id="8481892">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8481896">testLookups</span><span class="op" id="8481907">(</span><span class="ident" id="8481908">t</span><span class="op" id="8481909">,</span>&nbsp;<span class="op" id="8481911">&amp;</span><span class="ident" id="8481912">tc</span><span class="op" id="8481914">,</span>&nbsp;<span class="ident" id="8481916">x</span><span class="op" id="8481917">,</span>&nbsp;<span class="num" id="8481919">0</span><span class="op" id="8481920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8481924">testLookups</span><span class="op" id="8481935">(</span><span class="ident" id="8481936">t</span><span class="op" id="8481937">,</span>&nbsp;<span class="op" id="8481939">&amp;</span><span class="ident" id="8481940">tc</span><span class="op" id="8481942">,</span>&nbsp;<span class="ident" id="8481944">x</span><span class="op" id="8481945">,</span>&nbsp;<span class="num" id="8481947">1</span><span class="op" id="8481948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8481952">testLookups</span><span class="op" id="8481963">(</span><span class="ident" id="8481964">t</span><span class="op" id="8481965">,</span>&nbsp;<span class="op" id="8481967">&amp;</span><span class="ident" id="8481968">tc</span><span class="op" id="8481970">,</span>&nbsp;<span class="ident" id="8481972">x</span><span class="op" id="8481973">,</span>&nbsp;<span class="num" id="8481975">10</span><span class="op" id="8481977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8481981">testLookups</span><span class="op" id="8481992">(</span><span class="ident" id="8481993">t</span><span class="op" id="8481994">,</span>&nbsp;<span class="op" id="8481996">&amp;</span><span class="ident" id="8481997">tc</span><span class="op" id="8481999">,</span>&nbsp;<span class="ident" id="8482001">x</span><span class="op" id="8482002">,</span>&nbsp;<span class="num" id="8482004">2e9</span><span class="op" id="8482007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8482011">testLookups</span><span class="op" id="8482022">(</span><span class="ident" id="8482023">t</span><span class="op" id="8482024">,</span>&nbsp;<span class="op" id="8482026">&amp;</span><span class="ident" id="8482027">tc</span><span class="op" id="8482029">,</span>&nbsp;<span class="ident" id="8482031">x</span><span class="op" id="8482032">,</span>&nbsp;<span class="op" id="8482034">-</span><span class="num" id="8482035">1</span><span class="op" id="8482036">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8482039">}</span><br>
<span class="lineno"></span><span class="op" id="8482041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8482044">//&nbsp;Of&nbsp;all&nbsp;possible&nbsp;inputs,&nbsp;the&nbsp;random&nbsp;bytes&nbsp;have&nbsp;the&nbsp;least&nbsp;amount&nbsp;of&nbsp;substring</span><br>
<span class="lineno"></span><span class="comment" id="8482123">//&nbsp;repetition,&nbsp;and&nbsp;the&nbsp;repeated&nbsp;bytes&nbsp;have&nbsp;the&nbsp;most.&nbsp;For&nbsp;most&nbsp;algorithms,</span><br>
<span class="lineno">265</span><span class="comment" id="8482197">//&nbsp;the&nbsp;running&nbsp;time&nbsp;of&nbsp;every&nbsp;input&nbsp;will&nbsp;be&nbsp;between&nbsp;these&nbsp;two.</span><br>
<span class="lineno"></span><span class="keyword" id="8482259">func</span>&nbsp;<span class="ident" id="8482264">benchmarkNew</span><span class="op" id="8482276">(</span><span class="ident" id="8482277">b</span>&nbsp;<span class="op" id="8482279">*</span><span class="ident" id="8482280">testing</span><span class="op" id="8482287">.</span><span class="ident" id="8482288">B</span><span class="op" id="8482289">,</span>&nbsp;<span class="ident" id="8482291">random</span>&nbsp;<span class="builtintype" id="8482298">bool</span><span class="op" id="8482302">)</span>&nbsp;<span class="op" id="8482304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8482307">b</span><span class="op" id="8482308">.</span><span class="ident" id="8482309">StopTimer</span><span class="op" id="8482318">(</span><span class="op" id="8482319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8482322">data</span>&nbsp;<span class="op" id="8482327">:=</span>&nbsp;<span class="builtinfunc" id="8482330">make</span><span class="op" id="8482334">(</span><span class="op" id="8482335">[</span><span class="op" id="8482336">]</span><span class="builtintype" id="8482337">byte</span><span class="op" id="8482341">,</span>&nbsp;<span class="num" id="8482343">1e6</span><span class="op" id="8482346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8482349">if</span>&nbsp;<span class="ident" id="8482352">random</span>&nbsp;<span class="op" id="8482359">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8482363">for</span>&nbsp;<span class="ident" id="8482367">i</span>&nbsp;<span class="op" id="8482369">:=</span>&nbsp;<span class="keyword" id="8482372">range</span>&nbsp;<span class="ident" id="8482378">data</span>&nbsp;<span class="op" id="8482383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8482388">data</span><span class="op" id="8482392">[</span><span class="ident" id="8482393">i</span><span class="op" id="8482394">]</span>&nbsp;<span class="op" id="8482396">=</span>&nbsp;<span class="builtintype" id="8482398">byte</span><span class="op" id="8482402">(</span><span class="ident" id="8482403">rand</span><span class="op" id="8482407">.</span><span class="ident" id="8482408">Intn</span><span class="op" id="8482412">(</span><span class="num" id="8482413">256</span><span class="op" id="8482416">)</span><span class="op" id="8482417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8482421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8482424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8482427">b</span><span class="op" id="8482428">.</span><span class="ident" id="8482429">StartTimer</span><span class="op" id="8482439">(</span><span class="op" id="8482440">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8482443">for</span>&nbsp;<span class="ident" id="8482447">i</span>&nbsp;<span class="op" id="8482449">:=</span>&nbsp;<span class="num" id="8482452">0</span><span class="op" id="8482453">;</span>&nbsp;<span class="ident" id="8482455">i</span>&nbsp;<span class="op" id="8482457">&lt;</span>&nbsp;<span class="ident" id="8482459">b</span><span class="op" id="8482460">.</span><span class="ident" id="8482461">N</span><span class="op" id="8482462">;</span>&nbsp;<span class="ident" id="8482464">i</span><span class="op" id="8482465">++</span>&nbsp;<span class="op" id="8482468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8482472">New</span><span class="op" id="8482475">(</span><span class="ident" id="8482476">data</span><span class="op" id="8482480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8482483">}</span><br>
<span class="lineno"></span><span class="op" id="8482485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="8482488">func</span>&nbsp;<span class="ident" id="8482493">BenchmarkNewIndexRandom</span><span class="op" id="8482516">(</span><span class="ident" id="8482517">b</span>&nbsp;<span class="op" id="8482519">*</span><span class="ident" id="8482520">testing</span><span class="op" id="8482527">.</span><span class="ident" id="8482528">B</span><span class="op" id="8482529">)</span>&nbsp;<span class="op" id="8482531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8482534">benchmarkNew</span><span class="op" id="8482546">(</span><span class="ident" id="8482547">b</span><span class="op" id="8482548">,</span>&nbsp;<span class="builtintype" id="8482550">true</span><span class="op" id="8482554">)</span><br>
<span class="lineno"></span><span class="op" id="8482556">}</span><br>
<span class="lineno"></span><span class="keyword" id="8482558">func</span>&nbsp;<span class="ident" id="8482563">BenchmarkNewIndexRepeat</span><span class="op" id="8482586">(</span><span class="ident" id="8482587">b</span>&nbsp;<span class="op" id="8482589">*</span><span class="ident" id="8482590">testing</span><span class="op" id="8482597">.</span><span class="ident" id="8482598">B</span><span class="op" id="8482599">)</span>&nbsp;<span class="op" id="8482601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8482604">benchmarkNew</span><span class="op" id="8482616">(</span><span class="ident" id="8482617">b</span><span class="op" id="8482618">,</span>&nbsp;<span class="builtintype" id="8482620">false</span><span class="op" id="8482625">)</span><br>
<span class="lineno">285</span><span class="op" id="8482627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8482630">func</span>&nbsp;<span class="ident" id="8482635">BenchmarkSaveRestore</span><span class="op" id="8482655">(</span><span class="ident" id="8482656">b</span>&nbsp;<span class="op" id="8482658">*</span><span class="ident" id="8482659">testing</span><span class="op" id="8482666">.</span><span class="ident" id="8482667">B</span><span class="op" id="8482668">)</span>&nbsp;<span class="op" id="8482670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8482673">b</span><span class="op" id="8482674">.</span><span class="ident" id="8482675">StopTimer</span><span class="op" id="8482684">(</span><span class="op" id="8482685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8482688">r</span>&nbsp;<span class="op" id="8482690">:=</span>&nbsp;<span class="ident" id="8482693">rand</span><span class="op" id="8482697">.</span><span class="ident" id="8482698">New</span><span class="op" id="8482701">(</span><span class="ident" id="8482702">rand</span><span class="op" id="8482706">.</span><span class="ident" id="8482707">NewSource</span><span class="op" id="8482716">(</span><span class="num" id="8482717">0x5a77a1</span><span class="op" id="8482725">)</span><span class="op" id="8482726">)</span>&nbsp;<span class="comment" id="8482728">//&nbsp;guarantee&nbsp;always&nbsp;same&nbsp;sequence</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8482763">data</span>&nbsp;<span class="op" id="8482768">:=</span>&nbsp;<span class="builtinfunc" id="8482771">make</span><span class="op" id="8482775">(</span><span class="op" id="8482776">[</span><span class="op" id="8482777">]</span><span class="builtintype" id="8482778">byte</span><span class="op" id="8482782">,</span>&nbsp;<span class="num" id="8482784">1</span><span class="op" id="8482785">&lt;&lt;</span><span class="num" id="8482787">20</span><span class="op" id="8482789">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8482803">//&nbsp;1MB&nbsp;of&nbsp;data&nbsp;to&nbsp;index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8482828">for</span>&nbsp;<span class="ident" id="8482832">i</span>&nbsp;<span class="op" id="8482834">:=</span>&nbsp;<span class="keyword" id="8482837">range</span>&nbsp;<span class="ident" id="8482843">data</span>&nbsp;<span class="op" id="8482848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8482852">data</span><span class="op" id="8482856">[</span><span class="ident" id="8482857">i</span><span class="op" id="8482858">]</span>&nbsp;<span class="op" id="8482860">=</span>&nbsp;<span class="builtintype" id="8482862">byte</span><span class="op" id="8482866">(</span><span class="ident" id="8482867">r</span><span class="op" id="8482868">.</span><span class="ident" id="8482869">Intn</span><span class="op" id="8482873">(</span><span class="num" id="8482874">256</span><span class="op" id="8482877">)</span><span class="op" id="8482878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8482881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8482884">x</span>&nbsp;<span class="op" id="8482886">:=</span>&nbsp;<span class="ident" id="8482889">New</span><span class="op" id="8482892">(</span><span class="ident" id="8482893">data</span><span class="op" id="8482897">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8482900">size</span>&nbsp;<span class="op" id="8482905">:=</span>&nbsp;<span class="ident" id="8482908">testSaveRestore</span><span class="op" id="8482923">(</span><span class="ident" id="8482924">nil</span><span class="op" id="8482927">,</span>&nbsp;<span class="ident" id="8482929">nil</span><span class="op" id="8482932">,</span>&nbsp;<span class="ident" id="8482934">x</span><span class="op" id="8482935">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8482943">//&nbsp;verify&nbsp;correctness</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8482966">buf</span>&nbsp;<span class="op" id="8482970">:=</span>&nbsp;<span class="ident" id="8482973">bytes</span><span class="op" id="8482978">.</span><span class="ident" id="8482979">NewBuffer</span><span class="op" id="8482988">(</span><span class="builtinfunc" id="8482989">make</span><span class="op" id="8482993">(</span><span class="op" id="8482994">[</span><span class="op" id="8482995">]</span><span class="builtintype" id="8482996">byte</span><span class="op" id="8483000">,</span>&nbsp;<span class="ident" id="8483002">size</span><span class="op" id="8483006">)</span><span class="op" id="8483007">)</span>&nbsp;<span class="comment" id="8483009">//&nbsp;avoid&nbsp;growing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8483027">b</span><span class="op" id="8483028">.</span><span class="ident" id="8483029">SetBytes</span><span class="op" id="8483037">(</span><span class="ident" id="8483038">int64</span><span class="op" id="8483043">(</span><span class="ident" id="8483044">size</span><span class="op" id="8483048">)</span><span class="op" id="8483049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8483052">b</span><span class="op" id="8483053">.</span><span class="ident" id="8483054">StartTimer</span><span class="op" id="8483064">(</span><span class="op" id="8483065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8483068">for</span>&nbsp;<span class="ident" id="8483072">i</span>&nbsp;<span class="op" id="8483074">:=</span>&nbsp;<span class="num" id="8483077">0</span><span class="op" id="8483078">;</span>&nbsp;<span class="ident" id="8483080">i</span>&nbsp;<span class="op" id="8483082">&lt;</span>&nbsp;<span class="ident" id="8483084">b</span><span class="op" id="8483085">.</span><span class="ident" id="8483086">N</span><span class="op" id="8483087">;</span>&nbsp;<span class="ident" id="8483089">i</span><span class="op" id="8483090">++</span>&nbsp;<span class="op" id="8483093">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8483097">x</span><span class="op" id="8483098">.</span><span class="ident" id="8483099">Write</span><span class="op" id="8483104">(</span><span class="ident" id="8483105">buf</span><span class="op" id="8483108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8483112">var</span>&nbsp;<span class="ident" id="8483116">y</span>&nbsp;<span class="ident" id="8483118">Index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8483126">y</span><span class="op" id="8483127">.</span><span class="ident" id="8483128">Read</span><span class="op" id="8483132">(</span><span class="ident" id="8483133">buf</span><span class="op" id="8483136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8483139">}</span><br>
<span class="lineno"></span><span class="op" id="8483141">}</span>
</div>
</body>
</html>
