<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3687353">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3687408">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3687462">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3687513">package</span>&nbsp;<span class="ident" id="3687521">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3687526">import</span>&nbsp;<span class="string" id="3687533">&#34;bytes&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3687542">type</span>&nbsp;<span class="ident" id="3687547">clientHelloMsg</span>&nbsp;<span class="keyword" id="3687562">struct</span>&nbsp;<span class="op" id="3687569">{</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3687572">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3687592">[</span><span class="op" id="3687593">]</span><span class="builtintype" id="3687594">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3687600">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3687620">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3687628">random</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3687648">[</span><span class="op" id="3687649">]</span><span class="builtintype" id="3687650">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3687656">sessionId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3687676">[</span><span class="op" id="3687677">]</span><span class="builtintype" id="3687678">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3687684">cipherSuites</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3687704">[</span><span class="op" id="3687705">]</span><span class="builtintype" id="3687706">uint16</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3687714">compressionMethods</span>&nbsp;&nbsp;<span class="op" id="3687734">[</span><span class="op" id="3687735">]</span><span class="builtintype" id="3687736">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3687743">nextProtoNeg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3687763">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3687769">serverName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3687789">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3687797">ocspStapling</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3687817">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3687823">supportedCurves</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3687843">[</span><span class="op" id="3687844">]</span><span class="ident" id="3687845">CurveID</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3687854">supportedPoints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3687874">[</span><span class="op" id="3687875">]</span><span class="builtintype" id="3687876">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3687883">ticketSupported</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3687903">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3687909">sessionTicket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3687929">[</span><span class="op" id="3687930">]</span><span class="builtintype" id="3687931">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3687938">signatureAndHashes</span>&nbsp;&nbsp;<span class="op" id="3687958">[</span><span class="op" id="3687959">]</span><span class="ident" id="3687960">signatureAndHash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3687978">secureRenegotiation</span>&nbsp;<span class="builtintype" id="3687998">bool</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688004">alpnProtocols</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3688024">[</span><span class="op" id="3688025">]</span><span class="builtintype" id="3688026">string</span><br>
<span class="lineno"></span><span class="op" id="3688033">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3688036">func</span>&nbsp;<span class="op" id="3688041">(</span><span class="ident" id="3688042">m</span>&nbsp;<span class="op" id="3688044">*</span><span class="ident" id="3688045">clientHelloMsg</span><span class="op" id="3688059">)</span>&nbsp;<span class="ident" id="3688061">equal</span><span class="op" id="3688066">(</span><span class="ident" id="3688067">i</span>&nbsp;<span class="keyword" id="3688069">interface</span><span class="op" id="3688078">{</span><span class="op" id="3688079">}</span><span class="op" id="3688080">)</span>&nbsp;<span class="builtintype" id="3688082">bool</span>&nbsp;<span class="op" id="3688087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688090">m1</span><span class="op" id="3688092">,</span>&nbsp;<span class="ident" id="3688094">ok</span>&nbsp;<span class="op" id="3688097">:=</span>&nbsp;<span class="ident" id="3688100">i</span><span class="op" id="3688101">.</span><span class="op" id="3688102">(</span><span class="op" id="3688103">*</span><span class="ident" id="3688104">clientHelloMsg</span><span class="op" id="3688118">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3688121">if</span>&nbsp;<span class="op" id="3688124">!</span><span class="ident" id="3688125">ok</span>&nbsp;<span class="op" id="3688128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3688132">return</span>&nbsp;<span class="builtintype" id="3688139">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3688146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3688150">return</span>&nbsp;<span class="ident" id="3688157">bytes</span><span class="op" id="3688162">.</span><span class="ident" id="3688163">Equal</span><span class="op" id="3688168">(</span><span class="ident" id="3688169">m</span><span class="op" id="3688170">.</span><span class="ident" id="3688171">raw</span><span class="op" id="3688174">,</span>&nbsp;<span class="ident" id="3688176">m1</span><span class="op" id="3688178">.</span><span class="ident" id="3688179">raw</span><span class="op" id="3688182">)</span>&nbsp;<span class="op" id="3688184">&amp;&amp;</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688189">m</span><span class="op" id="3688190">.</span><span class="ident" id="3688191">vers</span>&nbsp;<span class="op" id="3688196">==</span>&nbsp;<span class="ident" id="3688199">m1</span><span class="op" id="3688201">.</span><span class="ident" id="3688202">vers</span>&nbsp;<span class="op" id="3688207">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688212">bytes</span><span class="op" id="3688217">.</span><span class="ident" id="3688218">Equal</span><span class="op" id="3688223">(</span><span class="ident" id="3688224">m</span><span class="op" id="3688225">.</span><span class="ident" id="3688226">random</span><span class="op" id="3688232">,</span>&nbsp;<span class="ident" id="3688234">m1</span><span class="op" id="3688236">.</span><span class="ident" id="3688237">random</span><span class="op" id="3688243">)</span>&nbsp;<span class="op" id="3688245">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688250">bytes</span><span class="op" id="3688255">.</span><span class="ident" id="3688256">Equal</span><span class="op" id="3688261">(</span><span class="ident" id="3688262">m</span><span class="op" id="3688263">.</span><span class="ident" id="3688264">sessionId</span><span class="op" id="3688273">,</span>&nbsp;<span class="ident" id="3688275">m1</span><span class="op" id="3688277">.</span><span class="ident" id="3688278">sessionId</span><span class="op" id="3688287">)</span>&nbsp;<span class="op" id="3688289">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688294">eqUint16s</span><span class="op" id="3688303">(</span><span class="ident" id="3688304">m</span><span class="op" id="3688305">.</span><span class="ident" id="3688306">cipherSuites</span><span class="op" id="3688318">,</span>&nbsp;<span class="ident" id="3688320">m1</span><span class="op" id="3688322">.</span><span class="ident" id="3688323">cipherSuites</span><span class="op" id="3688335">)</span>&nbsp;<span class="op" id="3688337">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688342">bytes</span><span class="op" id="3688347">.</span><span class="ident" id="3688348">Equal</span><span class="op" id="3688353">(</span><span class="ident" id="3688354">m</span><span class="op" id="3688355">.</span><span class="ident" id="3688356">compressionMethods</span><span class="op" id="3688374">,</span>&nbsp;<span class="ident" id="3688376">m1</span><span class="op" id="3688378">.</span><span class="ident" id="3688379">compressionMethods</span><span class="op" id="3688397">)</span>&nbsp;<span class="op" id="3688399">&amp;&amp;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688404">m</span><span class="op" id="3688405">.</span><span class="ident" id="3688406">nextProtoNeg</span>&nbsp;<span class="op" id="3688419">==</span>&nbsp;<span class="ident" id="3688422">m1</span><span class="op" id="3688424">.</span><span class="ident" id="3688425">nextProtoNeg</span>&nbsp;<span class="op" id="3688438">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688443">m</span><span class="op" id="3688444">.</span><span class="ident" id="3688445">serverName</span>&nbsp;<span class="op" id="3688456">==</span>&nbsp;<span class="ident" id="3688459">m1</span><span class="op" id="3688461">.</span><span class="ident" id="3688462">serverName</span>&nbsp;<span class="op" id="3688473">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688478">m</span><span class="op" id="3688479">.</span><span class="ident" id="3688480">ocspStapling</span>&nbsp;<span class="op" id="3688493">==</span>&nbsp;<span class="ident" id="3688496">m1</span><span class="op" id="3688498">.</span><span class="ident" id="3688499">ocspStapling</span>&nbsp;<span class="op" id="3688512">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688517">eqCurveIDs</span><span class="op" id="3688527">(</span><span class="ident" id="3688528">m</span><span class="op" id="3688529">.</span><span class="ident" id="3688530">supportedCurves</span><span class="op" id="3688545">,</span>&nbsp;<span class="ident" id="3688547">m1</span><span class="op" id="3688549">.</span><span class="ident" id="3688550">supportedCurves</span><span class="op" id="3688565">)</span>&nbsp;<span class="op" id="3688567">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688572">bytes</span><span class="op" id="3688577">.</span><span class="ident" id="3688578">Equal</span><span class="op" id="3688583">(</span><span class="ident" id="3688584">m</span><span class="op" id="3688585">.</span><span class="ident" id="3688586">supportedPoints</span><span class="op" id="3688601">,</span>&nbsp;<span class="ident" id="3688603">m1</span><span class="op" id="3688605">.</span><span class="ident" id="3688606">supportedPoints</span><span class="op" id="3688621">)</span>&nbsp;<span class="op" id="3688623">&amp;&amp;</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688628">m</span><span class="op" id="3688629">.</span><span class="ident" id="3688630">ticketSupported</span>&nbsp;<span class="op" id="3688646">==</span>&nbsp;<span class="ident" id="3688649">m1</span><span class="op" id="3688651">.</span><span class="ident" id="3688652">ticketSupported</span>&nbsp;<span class="op" id="3688668">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688673">bytes</span><span class="op" id="3688678">.</span><span class="ident" id="3688679">Equal</span><span class="op" id="3688684">(</span><span class="ident" id="3688685">m</span><span class="op" id="3688686">.</span><span class="ident" id="3688687">sessionTicket</span><span class="op" id="3688700">,</span>&nbsp;<span class="ident" id="3688702">m1</span><span class="op" id="3688704">.</span><span class="ident" id="3688705">sessionTicket</span><span class="op" id="3688718">)</span>&nbsp;<span class="op" id="3688720">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688725">eqSignatureAndHashes</span><span class="op" id="3688745">(</span><span class="ident" id="3688746">m</span><span class="op" id="3688747">.</span><span class="ident" id="3688748">signatureAndHashes</span><span class="op" id="3688766">,</span>&nbsp;<span class="ident" id="3688768">m1</span><span class="op" id="3688770">.</span><span class="ident" id="3688771">signatureAndHashes</span><span class="op" id="3688789">)</span>&nbsp;<span class="op" id="3688791">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688796">m</span><span class="op" id="3688797">.</span><span class="ident" id="3688798">secureRenegotiation</span>&nbsp;<span class="op" id="3688818">==</span>&nbsp;<span class="ident" id="3688821">m1</span><span class="op" id="3688823">.</span><span class="ident" id="3688824">secureRenegotiation</span>&nbsp;<span class="op" id="3688844">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688849">eqStrings</span><span class="op" id="3688858">(</span><span class="ident" id="3688859">m</span><span class="op" id="3688860">.</span><span class="ident" id="3688861">alpnProtocols</span><span class="op" id="3688874">,</span>&nbsp;<span class="ident" id="3688876">m1</span><span class="op" id="3688878">.</span><span class="ident" id="3688879">alpnProtocols</span><span class="op" id="3688892">)</span><br>
<span class="lineno">50</span><span class="op" id="3688894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3688897">func</span>&nbsp;<span class="op" id="3688902">(</span><span class="ident" id="3688903">m</span>&nbsp;<span class="op" id="3688905">*</span><span class="ident" id="3688906">clientHelloMsg</span><span class="op" id="3688920">)</span>&nbsp;<span class="ident" id="3688922">marshal</span><span class="op" id="3688929">(</span><span class="op" id="3688930">)</span>&nbsp;<span class="op" id="3688932">[</span><span class="op" id="3688933">]</span><span class="builtintype" id="3688934">byte</span>&nbsp;<span class="op" id="3688939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3688942">if</span>&nbsp;<span class="ident" id="3688945">m</span><span class="op" id="3688946">.</span><span class="ident" id="3688947">raw</span>&nbsp;<span class="op" id="3688951">!=</span>&nbsp;<span class="ident" id="3688954">nil</span>&nbsp;<span class="op" id="3688958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3688962">return</span>&nbsp;<span class="ident" id="3688969">m</span><span class="op" id="3688970">.</span><span class="ident" id="3688971">raw</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3688976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3688980">length</span>&nbsp;<span class="op" id="3688987">:=</span>&nbsp;<span class="num" id="3688990">2</span>&nbsp;<span class="op" id="3688992">+</span>&nbsp;<span class="num" id="3688994">32</span>&nbsp;<span class="op" id="3688997">+</span>&nbsp;<span class="num" id="3688999">1</span>&nbsp;<span class="op" id="3689001">+</span>&nbsp;<span class="builtinfunc" id="3689003">len</span><span class="op" id="3689006">(</span><span class="ident" id="3689007">m</span><span class="op" id="3689008">.</span><span class="ident" id="3689009">sessionId</span><span class="op" id="3689018">)</span>&nbsp;<span class="op" id="3689020">+</span>&nbsp;<span class="num" id="3689022">2</span>&nbsp;<span class="op" id="3689024">+</span>&nbsp;<span class="builtinfunc" id="3689026">len</span><span class="op" id="3689029">(</span><span class="ident" id="3689030">m</span><span class="op" id="3689031">.</span><span class="ident" id="3689032">cipherSuites</span><span class="op" id="3689044">)</span><span class="op" id="3689045">*</span><span class="num" id="3689046">2</span>&nbsp;<span class="op" id="3689048">+</span>&nbsp;<span class="num" id="3689050">1</span>&nbsp;<span class="op" id="3689052">+</span>&nbsp;<span class="builtinfunc" id="3689054">len</span><span class="op" id="3689057">(</span><span class="ident" id="3689058">m</span><span class="op" id="3689059">.</span><span class="ident" id="3689060">compressionMethods</span><span class="op" id="3689078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689081">numExtensions</span>&nbsp;<span class="op" id="3689095">:=</span>&nbsp;<span class="num" id="3689098">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689101">extensionsLength</span>&nbsp;<span class="op" id="3689118">:=</span>&nbsp;<span class="num" id="3689121">0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689124">if</span>&nbsp;<span class="ident" id="3689127">m</span><span class="op" id="3689128">.</span><span class="ident" id="3689129">nextProtoNeg</span>&nbsp;<span class="op" id="3689142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689146">numExtensions</span><span class="op" id="3689159">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3689163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689166">if</span>&nbsp;<span class="ident" id="3689169">m</span><span class="op" id="3689170">.</span><span class="ident" id="3689171">ocspStapling</span>&nbsp;<span class="op" id="3689184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689188">extensionsLength</span>&nbsp;<span class="op" id="3689205">+=</span>&nbsp;<span class="num" id="3689208">1</span>&nbsp;<span class="op" id="3689210">+</span>&nbsp;<span class="num" id="3689212">2</span>&nbsp;<span class="op" id="3689214">+</span>&nbsp;<span class="num" id="3689216">2</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689220">numExtensions</span><span class="op" id="3689233">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3689237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689240">if</span>&nbsp;<span class="builtinfunc" id="3689243">len</span><span class="op" id="3689246">(</span><span class="ident" id="3689247">m</span><span class="op" id="3689248">.</span><span class="ident" id="3689249">serverName</span><span class="op" id="3689259">)</span>&nbsp;<span class="op" id="3689261">&gt;</span>&nbsp;<span class="num" id="3689263">0</span>&nbsp;<span class="op" id="3689265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689269">extensionsLength</span>&nbsp;<span class="op" id="3689286">+=</span>&nbsp;<span class="num" id="3689289">5</span>&nbsp;<span class="op" id="3689291">+</span>&nbsp;<span class="builtinfunc" id="3689293">len</span><span class="op" id="3689296">(</span><span class="ident" id="3689297">m</span><span class="op" id="3689298">.</span><span class="ident" id="3689299">serverName</span><span class="op" id="3689309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689313">numExtensions</span><span class="op" id="3689326">++</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3689330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689333">if</span>&nbsp;<span class="builtinfunc" id="3689336">len</span><span class="op" id="3689339">(</span><span class="ident" id="3689340">m</span><span class="op" id="3689341">.</span><span class="ident" id="3689342">supportedCurves</span><span class="op" id="3689357">)</span>&nbsp;<span class="op" id="3689359">&gt;</span>&nbsp;<span class="num" id="3689361">0</span>&nbsp;<span class="op" id="3689363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689367">extensionsLength</span>&nbsp;<span class="op" id="3689384">+=</span>&nbsp;<span class="num" id="3689387">2</span>&nbsp;<span class="op" id="3689389">+</span>&nbsp;<span class="num" id="3689391">2</span><span class="op" id="3689392">*</span><span class="builtinfunc" id="3689393">len</span><span class="op" id="3689396">(</span><span class="ident" id="3689397">m</span><span class="op" id="3689398">.</span><span class="ident" id="3689399">supportedCurves</span><span class="op" id="3689414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689418">numExtensions</span><span class="op" id="3689431">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3689435">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689438">if</span>&nbsp;<span class="builtinfunc" id="3689441">len</span><span class="op" id="3689444">(</span><span class="ident" id="3689445">m</span><span class="op" id="3689446">.</span><span class="ident" id="3689447">supportedPoints</span><span class="op" id="3689462">)</span>&nbsp;<span class="op" id="3689464">&gt;</span>&nbsp;<span class="num" id="3689466">0</span>&nbsp;<span class="op" id="3689468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689472">extensionsLength</span>&nbsp;<span class="op" id="3689489">+=</span>&nbsp;<span class="num" id="3689492">1</span>&nbsp;<span class="op" id="3689494">+</span>&nbsp;<span class="builtinfunc" id="3689496">len</span><span class="op" id="3689499">(</span><span class="ident" id="3689500">m</span><span class="op" id="3689501">.</span><span class="ident" id="3689502">supportedPoints</span><span class="op" id="3689517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689521">numExtensions</span><span class="op" id="3689534">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3689538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689541">if</span>&nbsp;<span class="ident" id="3689544">m</span><span class="op" id="3689545">.</span><span class="ident" id="3689546">ticketSupported</span>&nbsp;<span class="op" id="3689562">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689566">extensionsLength</span>&nbsp;<span class="op" id="3689583">+=</span>&nbsp;<span class="builtinfunc" id="3689586">len</span><span class="op" id="3689589">(</span><span class="ident" id="3689590">m</span><span class="op" id="3689591">.</span><span class="ident" id="3689592">sessionTicket</span><span class="op" id="3689605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689609">numExtensions</span><span class="op" id="3689622">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3689626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689629">if</span>&nbsp;<span class="builtinfunc" id="3689632">len</span><span class="op" id="3689635">(</span><span class="ident" id="3689636">m</span><span class="op" id="3689637">.</span><span class="ident" id="3689638">signatureAndHashes</span><span class="op" id="3689656">)</span>&nbsp;<span class="op" id="3689658">&gt;</span>&nbsp;<span class="num" id="3689660">0</span>&nbsp;<span class="op" id="3689662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689666">extensionsLength</span>&nbsp;<span class="op" id="3689683">+=</span>&nbsp;<span class="num" id="3689686">2</span>&nbsp;<span class="op" id="3689688">+</span>&nbsp;<span class="num" id="3689690">2</span><span class="op" id="3689691">*</span><span class="builtinfunc" id="3689692">len</span><span class="op" id="3689695">(</span><span class="ident" id="3689696">m</span><span class="op" id="3689697">.</span><span class="ident" id="3689698">signatureAndHashes</span><span class="op" id="3689716">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689720">numExtensions</span><span class="op" id="3689733">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3689737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689740">if</span>&nbsp;<span class="ident" id="3689743">m</span><span class="op" id="3689744">.</span><span class="ident" id="3689745">secureRenegotiation</span>&nbsp;<span class="op" id="3689765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689769">extensionsLength</span>&nbsp;<span class="op" id="3689786">+=</span>&nbsp;<span class="num" id="3689789">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689793">numExtensions</span><span class="op" id="3689806">++</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3689810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689813">if</span>&nbsp;<span class="builtinfunc" id="3689816">len</span><span class="op" id="3689819">(</span><span class="ident" id="3689820">m</span><span class="op" id="3689821">.</span><span class="ident" id="3689822">alpnProtocols</span><span class="op" id="3689835">)</span>&nbsp;<span class="op" id="3689837">&gt;</span>&nbsp;<span class="num" id="3689839">0</span>&nbsp;<span class="op" id="3689841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689845">extensionsLength</span>&nbsp;<span class="op" id="3689862">+=</span>&nbsp;<span class="num" id="3689865">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689869">for</span>&nbsp;<span class="ident" id="3689873">_</span><span class="op" id="3689874">,</span>&nbsp;<span class="ident" id="3689876">s</span>&nbsp;<span class="op" id="3689878">:=</span>&nbsp;<span class="keyword" id="3689881">range</span>&nbsp;<span class="ident" id="3689887">m</span><span class="op" id="3689888">.</span><span class="ident" id="3689889">alpnProtocols</span>&nbsp;<span class="op" id="3689903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689908">if</span>&nbsp;<span class="ident" id="3689911">l</span>&nbsp;<span class="op" id="3689913">:=</span>&nbsp;<span class="builtinfunc" id="3689916">len</span><span class="op" id="3689919">(</span><span class="ident" id="3689920">s</span><span class="op" id="3689921">)</span><span class="op" id="3689922">;</span>&nbsp;<span class="ident" id="3689924">l</span>&nbsp;<span class="op" id="3689926">==</span>&nbsp;<span class="num" id="3689929">0</span>&nbsp;<span class="op" id="3689931">||</span>&nbsp;<span class="ident" id="3689934">l</span>&nbsp;<span class="op" id="3689936">&gt;</span>&nbsp;<span class="num" id="3689938">255</span>&nbsp;<span class="op" id="3689942">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3689948">panic</span><span class="op" id="3689953">(</span><span class="string" id="3689954">&#34;invalid&nbsp;ALPN&nbsp;protocol&#34;</span><span class="op" id="3689977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3689982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689987">extensionsLength</span><span class="op" id="3690003">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690009">extensionsLength</span>&nbsp;<span class="op" id="3690026">+=</span>&nbsp;<span class="builtinfunc" id="3690029">len</span><span class="op" id="3690032">(</span><span class="ident" id="3690033">s</span><span class="op" id="3690034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3690038">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690042">numExtensions</span><span class="op" id="3690055">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3690059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3690062">if</span>&nbsp;<span class="ident" id="3690065">numExtensions</span>&nbsp;<span class="op" id="3690079">&gt;</span>&nbsp;<span class="num" id="3690081">0</span>&nbsp;<span class="op" id="3690083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690087">extensionsLength</span>&nbsp;<span class="op" id="3690104">+=</span>&nbsp;<span class="num" id="3690107">4</span>&nbsp;<span class="op" id="3690109">*</span>&nbsp;<span class="ident" id="3690111">numExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690127">length</span>&nbsp;<span class="op" id="3690134">+=</span>&nbsp;<span class="num" id="3690137">2</span>&nbsp;<span class="op" id="3690139">+</span>&nbsp;<span class="ident" id="3690141">extensionsLength</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3690159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690163">x</span>&nbsp;<span class="op" id="3690165">:=</span>&nbsp;<span class="builtinfunc" id="3690168">make</span><span class="op" id="3690172">(</span><span class="op" id="3690173">[</span><span class="op" id="3690174">]</span><span class="builtintype" id="3690175">byte</span><span class="op" id="3690179">,</span>&nbsp;<span class="num" id="3690181">4</span><span class="op" id="3690182">+</span><span class="ident" id="3690183">length</span><span class="op" id="3690189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690192">x</span><span class="op" id="3690193">[</span><span class="num" id="3690194">0</span><span class="op" id="3690195">]</span>&nbsp;<span class="op" id="3690197">=</span>&nbsp;<span class="ident" id="3690199">typeClientHello</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690216">x</span><span class="op" id="3690217">[</span><span class="num" id="3690218">1</span><span class="op" id="3690219">]</span>&nbsp;<span class="op" id="3690221">=</span>&nbsp;<span class="builtintype" id="3690223">uint8</span><span class="op" id="3690228">(</span><span class="ident" id="3690229">length</span>&nbsp;<span class="op" id="3690236">&gt;&gt;</span>&nbsp;<span class="num" id="3690239">16</span><span class="op" id="3690241">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690244">x</span><span class="op" id="3690245">[</span><span class="num" id="3690246">2</span><span class="op" id="3690247">]</span>&nbsp;<span class="op" id="3690249">=</span>&nbsp;<span class="builtintype" id="3690251">uint8</span><span class="op" id="3690256">(</span><span class="ident" id="3690257">length</span>&nbsp;<span class="op" id="3690264">&gt;&gt;</span>&nbsp;<span class="num" id="3690267">8</span><span class="op" id="3690268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690271">x</span><span class="op" id="3690272">[</span><span class="num" id="3690273">3</span><span class="op" id="3690274">]</span>&nbsp;<span class="op" id="3690276">=</span>&nbsp;<span class="builtintype" id="3690278">uint8</span><span class="op" id="3690283">(</span><span class="ident" id="3690284">length</span><span class="op" id="3690290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690293">x</span><span class="op" id="3690294">[</span><span class="num" id="3690295">4</span><span class="op" id="3690296">]</span>&nbsp;<span class="op" id="3690298">=</span>&nbsp;<span class="builtintype" id="3690300">uint8</span><span class="op" id="3690305">(</span><span class="ident" id="3690306">m</span><span class="op" id="3690307">.</span><span class="ident" id="3690308">vers</span>&nbsp;<span class="op" id="3690313">&gt;&gt;</span>&nbsp;<span class="num" id="3690316">8</span><span class="op" id="3690317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690320">x</span><span class="op" id="3690321">[</span><span class="num" id="3690322">5</span><span class="op" id="3690323">]</span>&nbsp;<span class="op" id="3690325">=</span>&nbsp;<span class="builtintype" id="3690327">uint8</span><span class="op" id="3690332">(</span><span class="ident" id="3690333">m</span><span class="op" id="3690334">.</span><span class="ident" id="3690335">vers</span><span class="op" id="3690339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3690342">copy</span><span class="op" id="3690346">(</span><span class="ident" id="3690347">x</span><span class="op" id="3690348">[</span><span class="num" id="3690349">6</span><span class="op" id="3690350">:</span><span class="num" id="3690351">38</span><span class="op" id="3690353">]</span><span class="op" id="3690354">,</span>&nbsp;<span class="ident" id="3690356">m</span><span class="op" id="3690357">.</span><span class="ident" id="3690358">random</span><span class="op" id="3690364">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690367">x</span><span class="op" id="3690368">[</span><span class="num" id="3690369">38</span><span class="op" id="3690371">]</span>&nbsp;<span class="op" id="3690373">=</span>&nbsp;<span class="builtintype" id="3690375">uint8</span><span class="op" id="3690380">(</span><span class="builtinfunc" id="3690381">len</span><span class="op" id="3690384">(</span><span class="ident" id="3690385">m</span><span class="op" id="3690386">.</span><span class="ident" id="3690387">sessionId</span><span class="op" id="3690396">)</span><span class="op" id="3690397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3690400">copy</span><span class="op" id="3690404">(</span><span class="ident" id="3690405">x</span><span class="op" id="3690406">[</span><span class="num" id="3690407">39</span><span class="op" id="3690409">:</span><span class="num" id="3690410">39</span><span class="op" id="3690412">+</span><span class="builtinfunc" id="3690413">len</span><span class="op" id="3690416">(</span><span class="ident" id="3690417">m</span><span class="op" id="3690418">.</span><span class="ident" id="3690419">sessionId</span><span class="op" id="3690428">)</span><span class="op" id="3690429">]</span><span class="op" id="3690430">,</span>&nbsp;<span class="ident" id="3690432">m</span><span class="op" id="3690433">.</span><span class="ident" id="3690434">sessionId</span><span class="op" id="3690443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690446">y</span>&nbsp;<span class="op" id="3690448">:=</span>&nbsp;<span class="ident" id="3690451">x</span><span class="op" id="3690452">[</span><span class="num" id="3690453">39</span><span class="op" id="3690455">+</span><span class="builtinfunc" id="3690456">len</span><span class="op" id="3690459">(</span><span class="ident" id="3690460">m</span><span class="op" id="3690461">.</span><span class="ident" id="3690462">sessionId</span><span class="op" id="3690471">)</span><span class="op" id="3690472">:</span><span class="op" id="3690473">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690476">y</span><span class="op" id="3690477">[</span><span class="num" id="3690478">0</span><span class="op" id="3690479">]</span>&nbsp;<span class="op" id="3690481">=</span>&nbsp;<span class="builtintype" id="3690483">uint8</span><span class="op" id="3690488">(</span><span class="builtinfunc" id="3690489">len</span><span class="op" id="3690492">(</span><span class="ident" id="3690493">m</span><span class="op" id="3690494">.</span><span class="ident" id="3690495">cipherSuites</span><span class="op" id="3690507">)</span>&nbsp;<span class="op" id="3690509">&gt;&gt;</span>&nbsp;<span class="num" id="3690512">7</span><span class="op" id="3690513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690516">y</span><span class="op" id="3690517">[</span><span class="num" id="3690518">1</span><span class="op" id="3690519">]</span>&nbsp;<span class="op" id="3690521">=</span>&nbsp;<span class="builtintype" id="3690523">uint8</span><span class="op" id="3690528">(</span><span class="builtinfunc" id="3690529">len</span><span class="op" id="3690532">(</span><span class="ident" id="3690533">m</span><span class="op" id="3690534">.</span><span class="ident" id="3690535">cipherSuites</span><span class="op" id="3690547">)</span>&nbsp;<span class="op" id="3690549">&lt;&lt;</span>&nbsp;<span class="num" id="3690552">1</span><span class="op" id="3690553">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3690556">for</span>&nbsp;<span class="ident" id="3690560">i</span><span class="op" id="3690561">,</span>&nbsp;<span class="ident" id="3690563">suite</span>&nbsp;<span class="op" id="3690569">:=</span>&nbsp;<span class="keyword" id="3690572">range</span>&nbsp;<span class="ident" id="3690578">m</span><span class="op" id="3690579">.</span><span class="ident" id="3690580">cipherSuites</span>&nbsp;<span class="op" id="3690593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690597">y</span><span class="op" id="3690598">[</span><span class="num" id="3690599">2</span><span class="op" id="3690600">+</span><span class="ident" id="3690601">i</span><span class="op" id="3690602">*</span><span class="num" id="3690603">2</span><span class="op" id="3690604">]</span>&nbsp;<span class="op" id="3690606">=</span>&nbsp;<span class="builtintype" id="3690608">uint8</span><span class="op" id="3690613">(</span><span class="ident" id="3690614">suite</span>&nbsp;<span class="op" id="3690620">&gt;&gt;</span>&nbsp;<span class="num" id="3690623">8</span><span class="op" id="3690624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690628">y</span><span class="op" id="3690629">[</span><span class="num" id="3690630">3</span><span class="op" id="3690631">+</span><span class="ident" id="3690632">i</span><span class="op" id="3690633">*</span><span class="num" id="3690634">2</span><span class="op" id="3690635">]</span>&nbsp;<span class="op" id="3690637">=</span>&nbsp;<span class="builtintype" id="3690639">uint8</span><span class="op" id="3690644">(</span><span class="ident" id="3690645">suite</span><span class="op" id="3690650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3690653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690656">z</span>&nbsp;<span class="op" id="3690658">:=</span>&nbsp;<span class="ident" id="3690661">y</span><span class="op" id="3690662">[</span><span class="num" id="3690663">2</span><span class="op" id="3690664">+</span><span class="builtinfunc" id="3690665">len</span><span class="op" id="3690668">(</span><span class="ident" id="3690669">m</span><span class="op" id="3690670">.</span><span class="ident" id="3690671">cipherSuites</span><span class="op" id="3690683">)</span><span class="op" id="3690684">*</span><span class="num" id="3690685">2</span><span class="op" id="3690686">:</span><span class="op" id="3690687">]</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690690">z</span><span class="op" id="3690691">[</span><span class="num" id="3690692">0</span><span class="op" id="3690693">]</span>&nbsp;<span class="op" id="3690695">=</span>&nbsp;<span class="builtintype" id="3690697">uint8</span><span class="op" id="3690702">(</span><span class="builtinfunc" id="3690703">len</span><span class="op" id="3690706">(</span><span class="ident" id="3690707">m</span><span class="op" id="3690708">.</span><span class="ident" id="3690709">compressionMethods</span><span class="op" id="3690727">)</span><span class="op" id="3690728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3690731">copy</span><span class="op" id="3690735">(</span><span class="ident" id="3690736">z</span><span class="op" id="3690737">[</span><span class="num" id="3690738">1</span><span class="op" id="3690739">:</span><span class="op" id="3690740">]</span><span class="op" id="3690741">,</span>&nbsp;<span class="ident" id="3690743">m</span><span class="op" id="3690744">.</span><span class="ident" id="3690745">compressionMethods</span><span class="op" id="3690763">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690767">z</span>&nbsp;<span class="op" id="3690769">=</span>&nbsp;<span class="ident" id="3690771">z</span><span class="op" id="3690772">[</span><span class="num" id="3690773">1</span><span class="op" id="3690774">+</span><span class="builtinfunc" id="3690775">len</span><span class="op" id="3690778">(</span><span class="ident" id="3690779">m</span><span class="op" id="3690780">.</span><span class="ident" id="3690781">compressionMethods</span><span class="op" id="3690799">)</span><span class="op" id="3690800">:</span><span class="op" id="3690801">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3690804">if</span>&nbsp;<span class="ident" id="3690807">numExtensions</span>&nbsp;<span class="op" id="3690821">&gt;</span>&nbsp;<span class="num" id="3690823">0</span>&nbsp;<span class="op" id="3690825">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690829">z</span><span class="op" id="3690830">[</span><span class="num" id="3690831">0</span><span class="op" id="3690832">]</span>&nbsp;<span class="op" id="3690834">=</span>&nbsp;<span class="builtintype" id="3690836">byte</span><span class="op" id="3690840">(</span><span class="ident" id="3690841">extensionsLength</span>&nbsp;<span class="op" id="3690858">&gt;&gt;</span>&nbsp;<span class="num" id="3690861">8</span><span class="op" id="3690862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690866">z</span><span class="op" id="3690867">[</span><span class="num" id="3690868">1</span><span class="op" id="3690869">]</span>&nbsp;<span class="op" id="3690871">=</span>&nbsp;<span class="builtintype" id="3690873">byte</span><span class="op" id="3690877">(</span><span class="ident" id="3690878">extensionsLength</span><span class="op" id="3690894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690898">z</span>&nbsp;<span class="op" id="3690900">=</span>&nbsp;<span class="ident" id="3690902">z</span><span class="op" id="3690903">[</span><span class="num" id="3690904">2</span><span class="op" id="3690905">:</span><span class="op" id="3690906">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3690909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3690912">if</span>&nbsp;<span class="ident" id="3690915">m</span><span class="op" id="3690916">.</span><span class="ident" id="3690917">nextProtoNeg</span>&nbsp;<span class="op" id="3690930">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690934">z</span><span class="op" id="3690935">[</span><span class="num" id="3690936">0</span><span class="op" id="3690937">]</span>&nbsp;<span class="op" id="3690939">=</span>&nbsp;<span class="builtintype" id="3690941">byte</span><span class="op" id="3690945">(</span><span class="ident" id="3690946">extensionNextProtoNeg</span>&nbsp;<span class="op" id="3690968">&gt;&gt;</span>&nbsp;<span class="num" id="3690971">8</span><span class="op" id="3690972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690976">z</span><span class="op" id="3690977">[</span><span class="num" id="3690978">1</span><span class="op" id="3690979">]</span>&nbsp;<span class="op" id="3690981">=</span>&nbsp;<span class="builtintype" id="3690983">byte</span><span class="op" id="3690987">(</span><span class="ident" id="3690988">extensionNextProtoNeg</span>&nbsp;<span class="op" id="3691010">&amp;</span>&nbsp;<span class="num" id="3691012">0xff</span><span class="op" id="3691016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691020">//&nbsp;The&nbsp;length&nbsp;is&nbsp;always&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691048">z</span>&nbsp;<span class="op" id="3691050">=</span>&nbsp;<span class="ident" id="3691052">z</span><span class="op" id="3691053">[</span><span class="num" id="3691054">4</span><span class="op" id="3691055">:</span><span class="op" id="3691056">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3691059">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691062">if</span>&nbsp;<span class="builtinfunc" id="3691065">len</span><span class="op" id="3691068">(</span><span class="ident" id="3691069">m</span><span class="op" id="3691070">.</span><span class="ident" id="3691071">serverName</span><span class="op" id="3691081">)</span>&nbsp;<span class="op" id="3691083">&gt;</span>&nbsp;<span class="num" id="3691085">0</span>&nbsp;<span class="op" id="3691087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691091">z</span><span class="op" id="3691092">[</span><span class="num" id="3691093">0</span><span class="op" id="3691094">]</span>&nbsp;<span class="op" id="3691096">=</span>&nbsp;<span class="builtintype" id="3691098">byte</span><span class="op" id="3691102">(</span><span class="ident" id="3691103">extensionServerName</span>&nbsp;<span class="op" id="3691123">&gt;&gt;</span>&nbsp;<span class="num" id="3691126">8</span><span class="op" id="3691127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691131">z</span><span class="op" id="3691132">[</span><span class="num" id="3691133">1</span><span class="op" id="3691134">]</span>&nbsp;<span class="op" id="3691136">=</span>&nbsp;<span class="builtintype" id="3691138">byte</span><span class="op" id="3691142">(</span><span class="ident" id="3691143">extensionServerName</span>&nbsp;<span class="op" id="3691163">&amp;</span>&nbsp;<span class="num" id="3691165">0xff</span><span class="op" id="3691169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691173">l</span>&nbsp;<span class="op" id="3691175">:=</span>&nbsp;<span class="builtinfunc" id="3691178">len</span><span class="op" id="3691181">(</span><span class="ident" id="3691182">m</span><span class="op" id="3691183">.</span><span class="ident" id="3691184">serverName</span><span class="op" id="3691194">)</span>&nbsp;<span class="op" id="3691196">+</span>&nbsp;<span class="num" id="3691198">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691202">z</span><span class="op" id="3691203">[</span><span class="num" id="3691204">2</span><span class="op" id="3691205">]</span>&nbsp;<span class="op" id="3691207">=</span>&nbsp;<span class="builtintype" id="3691209">byte</span><span class="op" id="3691213">(</span><span class="ident" id="3691214">l</span>&nbsp;<span class="op" id="3691216">&gt;&gt;</span>&nbsp;<span class="num" id="3691219">8</span><span class="op" id="3691220">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691224">z</span><span class="op" id="3691225">[</span><span class="num" id="3691226">3</span><span class="op" id="3691227">]</span>&nbsp;<span class="op" id="3691229">=</span>&nbsp;<span class="builtintype" id="3691231">byte</span><span class="op" id="3691235">(</span><span class="ident" id="3691236">l</span><span class="op" id="3691237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691241">z</span>&nbsp;<span class="op" id="3691243">=</span>&nbsp;<span class="ident" id="3691245">z</span><span class="op" id="3691246">[</span><span class="num" id="3691247">4</span><span class="op" id="3691248">:</span><span class="op" id="3691249">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691254">//&nbsp;RFC&nbsp;3546,&nbsp;section&nbsp;3.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691281">//</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691286">//&nbsp;struct&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691300">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NameType&nbsp;name_type;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691329">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;(name_type)&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691359">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;host_name:&nbsp;HostName;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691398">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;name;</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691415">//&nbsp;}&nbsp;ServerName;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691434">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691439">//&nbsp;enum&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691451">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;host_name(0),&nbsp;(255)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691480">//&nbsp;}&nbsp;NameType;</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691497">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691502">//&nbsp;opaque&nbsp;HostName&lt;1..2^16-1&gt;;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691535">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691540">//&nbsp;struct&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691554">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ServerName&nbsp;server_name_list&lt;1..2^16-1&gt;</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691602">//&nbsp;}&nbsp;ServerNameList;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691626">z</span><span class="op" id="3691627">[</span><span class="num" id="3691628">0</span><span class="op" id="3691629">]</span>&nbsp;<span class="op" id="3691631">=</span>&nbsp;<span class="builtintype" id="3691633">byte</span><span class="op" id="3691637">(</span><span class="op" id="3691638">(</span><span class="builtinfunc" id="3691639">len</span><span class="op" id="3691642">(</span><span class="ident" id="3691643">m</span><span class="op" id="3691644">.</span><span class="ident" id="3691645">serverName</span><span class="op" id="3691655">)</span>&nbsp;<span class="op" id="3691657">+</span>&nbsp;<span class="num" id="3691659">3</span><span class="op" id="3691660">)</span>&nbsp;<span class="op" id="3691662">&gt;&gt;</span>&nbsp;<span class="num" id="3691665">8</span><span class="op" id="3691666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691670">z</span><span class="op" id="3691671">[</span><span class="num" id="3691672">1</span><span class="op" id="3691673">]</span>&nbsp;<span class="op" id="3691675">=</span>&nbsp;<span class="builtintype" id="3691677">byte</span><span class="op" id="3691681">(</span><span class="builtinfunc" id="3691682">len</span><span class="op" id="3691685">(</span><span class="ident" id="3691686">m</span><span class="op" id="3691687">.</span><span class="ident" id="3691688">serverName</span><span class="op" id="3691698">)</span>&nbsp;<span class="op" id="3691700">+</span>&nbsp;<span class="num" id="3691702">3</span><span class="op" id="3691703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691707">z</span><span class="op" id="3691708">[</span><span class="num" id="3691709">3</span><span class="op" id="3691710">]</span>&nbsp;<span class="op" id="3691712">=</span>&nbsp;<span class="builtintype" id="3691714">byte</span><span class="op" id="3691718">(</span><span class="builtinfunc" id="3691719">len</span><span class="op" id="3691722">(</span><span class="ident" id="3691723">m</span><span class="op" id="3691724">.</span><span class="ident" id="3691725">serverName</span><span class="op" id="3691735">)</span>&nbsp;<span class="op" id="3691737">&gt;&gt;</span>&nbsp;<span class="num" id="3691740">8</span><span class="op" id="3691741">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691745">z</span><span class="op" id="3691746">[</span><span class="num" id="3691747">4</span><span class="op" id="3691748">]</span>&nbsp;<span class="op" id="3691750">=</span>&nbsp;<span class="builtintype" id="3691752">byte</span><span class="op" id="3691756">(</span><span class="builtinfunc" id="3691757">len</span><span class="op" id="3691760">(</span><span class="ident" id="3691761">m</span><span class="op" id="3691762">.</span><span class="ident" id="3691763">serverName</span><span class="op" id="3691773">)</span><span class="op" id="3691774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3691778">copy</span><span class="op" id="3691782">(</span><span class="ident" id="3691783">z</span><span class="op" id="3691784">[</span><span class="num" id="3691785">5</span><span class="op" id="3691786">:</span><span class="op" id="3691787">]</span><span class="op" id="3691788">,</span>&nbsp;<span class="op" id="3691790">[</span><span class="op" id="3691791">]</span><span class="builtintype" id="3691792">byte</span><span class="op" id="3691796">(</span><span class="ident" id="3691797">m</span><span class="op" id="3691798">.</span><span class="ident" id="3691799">serverName</span><span class="op" id="3691809">)</span><span class="op" id="3691810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691814">z</span>&nbsp;<span class="op" id="3691816">=</span>&nbsp;<span class="ident" id="3691818">z</span><span class="op" id="3691819">[</span><span class="ident" id="3691820">l</span><span class="op" id="3691821">:</span><span class="op" id="3691822">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3691825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691828">if</span>&nbsp;<span class="ident" id="3691831">m</span><span class="op" id="3691832">.</span><span class="ident" id="3691833">ocspStapling</span>&nbsp;<span class="op" id="3691846">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691850">//&nbsp;RFC&nbsp;4366,&nbsp;section&nbsp;3.6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691877">z</span><span class="op" id="3691878">[</span><span class="num" id="3691879">0</span><span class="op" id="3691880">]</span>&nbsp;<span class="op" id="3691882">=</span>&nbsp;<span class="builtintype" id="3691884">byte</span><span class="op" id="3691888">(</span><span class="ident" id="3691889">extensionStatusRequest</span>&nbsp;<span class="op" id="3691912">&gt;&gt;</span>&nbsp;<span class="num" id="3691915">8</span><span class="op" id="3691916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691920">z</span><span class="op" id="3691921">[</span><span class="num" id="3691922">1</span><span class="op" id="3691923">]</span>&nbsp;<span class="op" id="3691925">=</span>&nbsp;<span class="builtintype" id="3691927">byte</span><span class="op" id="3691931">(</span><span class="ident" id="3691932">extensionStatusRequest</span><span class="op" id="3691954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691958">z</span><span class="op" id="3691959">[</span><span class="num" id="3691960">2</span><span class="op" id="3691961">]</span>&nbsp;<span class="op" id="3691963">=</span>&nbsp;<span class="num" id="3691965">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691969">z</span><span class="op" id="3691970">[</span><span class="num" id="3691971">3</span><span class="op" id="3691972">]</span>&nbsp;<span class="op" id="3691974">=</span>&nbsp;<span class="num" id="3691976">5</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691980">z</span><span class="op" id="3691981">[</span><span class="num" id="3691982">4</span><span class="op" id="3691983">]</span>&nbsp;<span class="op" id="3691985">=</span>&nbsp;<span class="num" id="3691987">1</span>&nbsp;<span class="comment" id="3691989">//&nbsp;OCSP&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3692004">//&nbsp;Two&nbsp;zero&nbsp;valued&nbsp;uint16s&nbsp;for&nbsp;the&nbsp;two&nbsp;lengths.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692054">z</span>&nbsp;<span class="op" id="3692056">=</span>&nbsp;<span class="ident" id="3692058">z</span><span class="op" id="3692059">[</span><span class="num" id="3692060">9</span><span class="op" id="3692061">:</span><span class="op" id="3692062">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3692065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3692068">if</span>&nbsp;<span class="builtinfunc" id="3692071">len</span><span class="op" id="3692074">(</span><span class="ident" id="3692075">m</span><span class="op" id="3692076">.</span><span class="ident" id="3692077">supportedCurves</span><span class="op" id="3692092">)</span>&nbsp;<span class="op" id="3692094">&gt;</span>&nbsp;<span class="num" id="3692096">0</span>&nbsp;<span class="op" id="3692098">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3692102">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692156">z</span><span class="op" id="3692157">[</span><span class="num" id="3692158">0</span><span class="op" id="3692159">]</span>&nbsp;<span class="op" id="3692161">=</span>&nbsp;<span class="builtintype" id="3692163">byte</span><span class="op" id="3692167">(</span><span class="ident" id="3692168">extensionSupportedCurves</span>&nbsp;<span class="op" id="3692193">&gt;&gt;</span>&nbsp;<span class="num" id="3692196">8</span><span class="op" id="3692197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692201">z</span><span class="op" id="3692202">[</span><span class="num" id="3692203">1</span><span class="op" id="3692204">]</span>&nbsp;<span class="op" id="3692206">=</span>&nbsp;<span class="builtintype" id="3692208">byte</span><span class="op" id="3692212">(</span><span class="ident" id="3692213">extensionSupportedCurves</span><span class="op" id="3692237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692241">l</span>&nbsp;<span class="op" id="3692243">:=</span>&nbsp;<span class="num" id="3692246">2</span>&nbsp;<span class="op" id="3692248">+</span>&nbsp;<span class="num" id="3692250">2</span><span class="op" id="3692251">*</span><span class="builtinfunc" id="3692252">len</span><span class="op" id="3692255">(</span><span class="ident" id="3692256">m</span><span class="op" id="3692257">.</span><span class="ident" id="3692258">supportedCurves</span><span class="op" id="3692273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692277">z</span><span class="op" id="3692278">[</span><span class="num" id="3692279">2</span><span class="op" id="3692280">]</span>&nbsp;<span class="op" id="3692282">=</span>&nbsp;<span class="builtintype" id="3692284">byte</span><span class="op" id="3692288">(</span><span class="ident" id="3692289">l</span>&nbsp;<span class="op" id="3692291">&gt;&gt;</span>&nbsp;<span class="num" id="3692294">8</span><span class="op" id="3692295">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692299">z</span><span class="op" id="3692300">[</span><span class="num" id="3692301">3</span><span class="op" id="3692302">]</span>&nbsp;<span class="op" id="3692304">=</span>&nbsp;<span class="builtintype" id="3692306">byte</span><span class="op" id="3692310">(</span><span class="ident" id="3692311">l</span><span class="op" id="3692312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692316">l</span>&nbsp;<span class="op" id="3692318">-=</span>&nbsp;<span class="num" id="3692321">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692325">z</span><span class="op" id="3692326">[</span><span class="num" id="3692327">4</span><span class="op" id="3692328">]</span>&nbsp;<span class="op" id="3692330">=</span>&nbsp;<span class="builtintype" id="3692332">byte</span><span class="op" id="3692336">(</span><span class="ident" id="3692337">l</span>&nbsp;<span class="op" id="3692339">&gt;&gt;</span>&nbsp;<span class="num" id="3692342">8</span><span class="op" id="3692343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692347">z</span><span class="op" id="3692348">[</span><span class="num" id="3692349">5</span><span class="op" id="3692350">]</span>&nbsp;<span class="op" id="3692352">=</span>&nbsp;<span class="builtintype" id="3692354">byte</span><span class="op" id="3692358">(</span><span class="ident" id="3692359">l</span><span class="op" id="3692360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692364">z</span>&nbsp;<span class="op" id="3692366">=</span>&nbsp;<span class="ident" id="3692368">z</span><span class="op" id="3692369">[</span><span class="num" id="3692370">6</span><span class="op" id="3692371">:</span><span class="op" id="3692372">]</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3692376">for</span>&nbsp;<span class="ident" id="3692380">_</span><span class="op" id="3692381">,</span>&nbsp;<span class="ident" id="3692383">curve</span>&nbsp;<span class="op" id="3692389">:=</span>&nbsp;<span class="keyword" id="3692392">range</span>&nbsp;<span class="ident" id="3692398">m</span><span class="op" id="3692399">.</span><span class="ident" id="3692400">supportedCurves</span>&nbsp;<span class="op" id="3692416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692421">z</span><span class="op" id="3692422">[</span><span class="num" id="3692423">0</span><span class="op" id="3692424">]</span>&nbsp;<span class="op" id="3692426">=</span>&nbsp;<span class="builtintype" id="3692428">byte</span><span class="op" id="3692432">(</span><span class="ident" id="3692433">curve</span>&nbsp;<span class="op" id="3692439">&gt;&gt;</span>&nbsp;<span class="num" id="3692442">8</span><span class="op" id="3692443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692448">z</span><span class="op" id="3692449">[</span><span class="num" id="3692450">1</span><span class="op" id="3692451">]</span>&nbsp;<span class="op" id="3692453">=</span>&nbsp;<span class="builtintype" id="3692455">byte</span><span class="op" id="3692459">(</span><span class="ident" id="3692460">curve</span><span class="op" id="3692465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692470">z</span>&nbsp;<span class="op" id="3692472">=</span>&nbsp;<span class="ident" id="3692474">z</span><span class="op" id="3692475">[</span><span class="num" id="3692476">2</span><span class="op" id="3692477">:</span><span class="op" id="3692478">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3692482">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3692485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3692488">if</span>&nbsp;<span class="builtinfunc" id="3692491">len</span><span class="op" id="3692494">(</span><span class="ident" id="3692495">m</span><span class="op" id="3692496">.</span><span class="ident" id="3692497">supportedPoints</span><span class="op" id="3692512">)</span>&nbsp;<span class="op" id="3692514">&gt;</span>&nbsp;<span class="num" id="3692516">0</span>&nbsp;<span class="op" id="3692518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3692522">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692576">z</span><span class="op" id="3692577">[</span><span class="num" id="3692578">0</span><span class="op" id="3692579">]</span>&nbsp;<span class="op" id="3692581">=</span>&nbsp;<span class="builtintype" id="3692583">byte</span><span class="op" id="3692587">(</span><span class="ident" id="3692588">extensionSupportedPoints</span>&nbsp;<span class="op" id="3692613">&gt;&gt;</span>&nbsp;<span class="num" id="3692616">8</span><span class="op" id="3692617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692621">z</span><span class="op" id="3692622">[</span><span class="num" id="3692623">1</span><span class="op" id="3692624">]</span>&nbsp;<span class="op" id="3692626">=</span>&nbsp;<span class="builtintype" id="3692628">byte</span><span class="op" id="3692632">(</span><span class="ident" id="3692633">extensionSupportedPoints</span><span class="op" id="3692657">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692661">l</span>&nbsp;<span class="op" id="3692663">:=</span>&nbsp;<span class="num" id="3692666">1</span>&nbsp;<span class="op" id="3692668">+</span>&nbsp;<span class="builtinfunc" id="3692670">len</span><span class="op" id="3692673">(</span><span class="ident" id="3692674">m</span><span class="op" id="3692675">.</span><span class="ident" id="3692676">supportedPoints</span><span class="op" id="3692691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692695">z</span><span class="op" id="3692696">[</span><span class="num" id="3692697">2</span><span class="op" id="3692698">]</span>&nbsp;<span class="op" id="3692700">=</span>&nbsp;<span class="builtintype" id="3692702">byte</span><span class="op" id="3692706">(</span><span class="ident" id="3692707">l</span>&nbsp;<span class="op" id="3692709">&gt;&gt;</span>&nbsp;<span class="num" id="3692712">8</span><span class="op" id="3692713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692717">z</span><span class="op" id="3692718">[</span><span class="num" id="3692719">3</span><span class="op" id="3692720">]</span>&nbsp;<span class="op" id="3692722">=</span>&nbsp;<span class="builtintype" id="3692724">byte</span><span class="op" id="3692728">(</span><span class="ident" id="3692729">l</span><span class="op" id="3692730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692734">l</span><span class="op" id="3692735">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692740">z</span><span class="op" id="3692741">[</span><span class="num" id="3692742">4</span><span class="op" id="3692743">]</span>&nbsp;<span class="op" id="3692745">=</span>&nbsp;<span class="builtintype" id="3692747">byte</span><span class="op" id="3692751">(</span><span class="ident" id="3692752">l</span><span class="op" id="3692753">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692757">z</span>&nbsp;<span class="op" id="3692759">=</span>&nbsp;<span class="ident" id="3692761">z</span><span class="op" id="3692762">[</span><span class="num" id="3692763">5</span><span class="op" id="3692764">:</span><span class="op" id="3692765">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3692769">for</span>&nbsp;<span class="ident" id="3692773">_</span><span class="op" id="3692774">,</span>&nbsp;<span class="ident" id="3692776">pointFormat</span>&nbsp;<span class="op" id="3692788">:=</span>&nbsp;<span class="keyword" id="3692791">range</span>&nbsp;<span class="ident" id="3692797">m</span><span class="op" id="3692798">.</span><span class="ident" id="3692799">supportedPoints</span>&nbsp;<span class="op" id="3692815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692820">z</span><span class="op" id="3692821">[</span><span class="num" id="3692822">0</span><span class="op" id="3692823">]</span>&nbsp;<span class="op" id="3692825">=</span>&nbsp;<span class="builtintype" id="3692827">byte</span><span class="op" id="3692831">(</span><span class="ident" id="3692832">pointFormat</span><span class="op" id="3692843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692848">z</span>&nbsp;<span class="op" id="3692850">=</span>&nbsp;<span class="ident" id="3692852">z</span><span class="op" id="3692853">[</span><span class="num" id="3692854">1</span><span class="op" id="3692855">:</span><span class="op" id="3692856">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3692860">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3692863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3692866">if</span>&nbsp;<span class="ident" id="3692869">m</span><span class="op" id="3692870">.</span><span class="ident" id="3692871">ticketSupported</span>&nbsp;<span class="op" id="3692887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3692891">//&nbsp;http://tools.ietf.org/html/rfc5077#section-3.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692943">z</span><span class="op" id="3692944">[</span><span class="num" id="3692945">0</span><span class="op" id="3692946">]</span>&nbsp;<span class="op" id="3692948">=</span>&nbsp;<span class="builtintype" id="3692950">byte</span><span class="op" id="3692954">(</span><span class="ident" id="3692955">extensionSessionTicket</span>&nbsp;<span class="op" id="3692978">&gt;&gt;</span>&nbsp;<span class="num" id="3692981">8</span><span class="op" id="3692982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692986">z</span><span class="op" id="3692987">[</span><span class="num" id="3692988">1</span><span class="op" id="3692989">]</span>&nbsp;<span class="op" id="3692991">=</span>&nbsp;<span class="builtintype" id="3692993">byte</span><span class="op" id="3692997">(</span><span class="ident" id="3692998">extensionSessionTicket</span><span class="op" id="3693020">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693024">l</span>&nbsp;<span class="op" id="3693026">:=</span>&nbsp;<span class="builtinfunc" id="3693029">len</span><span class="op" id="3693032">(</span><span class="ident" id="3693033">m</span><span class="op" id="3693034">.</span><span class="ident" id="3693035">sessionTicket</span><span class="op" id="3693048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693052">z</span><span class="op" id="3693053">[</span><span class="num" id="3693054">2</span><span class="op" id="3693055">]</span>&nbsp;<span class="op" id="3693057">=</span>&nbsp;<span class="builtintype" id="3693059">byte</span><span class="op" id="3693063">(</span><span class="ident" id="3693064">l</span>&nbsp;<span class="op" id="3693066">&gt;&gt;</span>&nbsp;<span class="num" id="3693069">8</span><span class="op" id="3693070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693074">z</span><span class="op" id="3693075">[</span><span class="num" id="3693076">3</span><span class="op" id="3693077">]</span>&nbsp;<span class="op" id="3693079">=</span>&nbsp;<span class="builtintype" id="3693081">byte</span><span class="op" id="3693085">(</span><span class="ident" id="3693086">l</span><span class="op" id="3693087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693091">z</span>&nbsp;<span class="op" id="3693093">=</span>&nbsp;<span class="ident" id="3693095">z</span><span class="op" id="3693096">[</span><span class="num" id="3693097">4</span><span class="op" id="3693098">:</span><span class="op" id="3693099">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3693103">copy</span><span class="op" id="3693107">(</span><span class="ident" id="3693108">z</span><span class="op" id="3693109">,</span>&nbsp;<span class="ident" id="3693111">m</span><span class="op" id="3693112">.</span><span class="ident" id="3693113">sessionTicket</span><span class="op" id="3693126">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693130">z</span>&nbsp;<span class="op" id="3693132">=</span>&nbsp;<span class="ident" id="3693134">z</span><span class="op" id="3693135">[</span><span class="builtinfunc" id="3693136">len</span><span class="op" id="3693139">(</span><span class="ident" id="3693140">m</span><span class="op" id="3693141">.</span><span class="ident" id="3693142">sessionTicket</span><span class="op" id="3693155">)</span><span class="op" id="3693156">:</span><span class="op" id="3693157">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3693160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3693163">if</span>&nbsp;<span class="builtinfunc" id="3693166">len</span><span class="op" id="3693169">(</span><span class="ident" id="3693170">m</span><span class="op" id="3693171">.</span><span class="ident" id="3693172">signatureAndHashes</span><span class="op" id="3693190">)</span>&nbsp;<span class="op" id="3693192">&gt;</span>&nbsp;<span class="num" id="3693194">0</span>&nbsp;<span class="op" id="3693196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3693200">//&nbsp;https://tools.ietf.org/html/rfc5246#section-7.4.1.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693259">z</span><span class="op" id="3693260">[</span><span class="num" id="3693261">0</span><span class="op" id="3693262">]</span>&nbsp;<span class="op" id="3693264">=</span>&nbsp;<span class="builtintype" id="3693266">byte</span><span class="op" id="3693270">(</span><span class="ident" id="3693271">extensionSignatureAlgorithms</span>&nbsp;<span class="op" id="3693300">&gt;&gt;</span>&nbsp;<span class="num" id="3693303">8</span><span class="op" id="3693304">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693308">z</span><span class="op" id="3693309">[</span><span class="num" id="3693310">1</span><span class="op" id="3693311">]</span>&nbsp;<span class="op" id="3693313">=</span>&nbsp;<span class="builtintype" id="3693315">byte</span><span class="op" id="3693319">(</span><span class="ident" id="3693320">extensionSignatureAlgorithms</span><span class="op" id="3693348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693352">l</span>&nbsp;<span class="op" id="3693354">:=</span>&nbsp;<span class="num" id="3693357">2</span>&nbsp;<span class="op" id="3693359">+</span>&nbsp;<span class="num" id="3693361">2</span><span class="op" id="3693362">*</span><span class="builtinfunc" id="3693363">len</span><span class="op" id="3693366">(</span><span class="ident" id="3693367">m</span><span class="op" id="3693368">.</span><span class="ident" id="3693369">signatureAndHashes</span><span class="op" id="3693387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693391">z</span><span class="op" id="3693392">[</span><span class="num" id="3693393">2</span><span class="op" id="3693394">]</span>&nbsp;<span class="op" id="3693396">=</span>&nbsp;<span class="builtintype" id="3693398">byte</span><span class="op" id="3693402">(</span><span class="ident" id="3693403">l</span>&nbsp;<span class="op" id="3693405">&gt;&gt;</span>&nbsp;<span class="num" id="3693408">8</span><span class="op" id="3693409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693413">z</span><span class="op" id="3693414">[</span><span class="num" id="3693415">3</span><span class="op" id="3693416">]</span>&nbsp;<span class="op" id="3693418">=</span>&nbsp;<span class="builtintype" id="3693420">byte</span><span class="op" id="3693424">(</span><span class="ident" id="3693425">l</span><span class="op" id="3693426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693430">z</span>&nbsp;<span class="op" id="3693432">=</span>&nbsp;<span class="ident" id="3693434">z</span><span class="op" id="3693435">[</span><span class="num" id="3693436">4</span><span class="op" id="3693437">:</span><span class="op" id="3693438">]</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693443">l</span>&nbsp;<span class="op" id="3693445">-=</span>&nbsp;<span class="num" id="3693448">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693452">z</span><span class="op" id="3693453">[</span><span class="num" id="3693454">0</span><span class="op" id="3693455">]</span>&nbsp;<span class="op" id="3693457">=</span>&nbsp;<span class="builtintype" id="3693459">byte</span><span class="op" id="3693463">(</span><span class="ident" id="3693464">l</span>&nbsp;<span class="op" id="3693466">&gt;&gt;</span>&nbsp;<span class="num" id="3693469">8</span><span class="op" id="3693470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693474">z</span><span class="op" id="3693475">[</span><span class="num" id="3693476">1</span><span class="op" id="3693477">]</span>&nbsp;<span class="op" id="3693479">=</span>&nbsp;<span class="builtintype" id="3693481">byte</span><span class="op" id="3693485">(</span><span class="ident" id="3693486">l</span><span class="op" id="3693487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693491">z</span>&nbsp;<span class="op" id="3693493">=</span>&nbsp;<span class="ident" id="3693495">z</span><span class="op" id="3693496">[</span><span class="num" id="3693497">2</span><span class="op" id="3693498">:</span><span class="op" id="3693499">]</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3693503">for</span>&nbsp;<span class="ident" id="3693507">_</span><span class="op" id="3693508">,</span>&nbsp;<span class="ident" id="3693510">sigAndHash</span>&nbsp;<span class="op" id="3693521">:=</span>&nbsp;<span class="keyword" id="3693524">range</span>&nbsp;<span class="ident" id="3693530">m</span><span class="op" id="3693531">.</span><span class="ident" id="3693532">signatureAndHashes</span>&nbsp;<span class="op" id="3693551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693556">z</span><span class="op" id="3693557">[</span><span class="num" id="3693558">0</span><span class="op" id="3693559">]</span>&nbsp;<span class="op" id="3693561">=</span>&nbsp;<span class="ident" id="3693563">sigAndHash</span><span class="op" id="3693573">.</span><span class="ident" id="3693574">hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693582">z</span><span class="op" id="3693583">[</span><span class="num" id="3693584">1</span><span class="op" id="3693585">]</span>&nbsp;<span class="op" id="3693587">=</span>&nbsp;<span class="ident" id="3693589">sigAndHash</span><span class="op" id="3693599">.</span><span class="ident" id="3693600">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693613">z</span>&nbsp;<span class="op" id="3693615">=</span>&nbsp;<span class="ident" id="3693617">z</span><span class="op" id="3693618">[</span><span class="num" id="3693619">2</span><span class="op" id="3693620">:</span><span class="op" id="3693621">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3693625">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3693628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3693631">if</span>&nbsp;<span class="ident" id="3693634">m</span><span class="op" id="3693635">.</span><span class="ident" id="3693636">secureRenegotiation</span>&nbsp;<span class="op" id="3693656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693660">z</span><span class="op" id="3693661">[</span><span class="num" id="3693662">0</span><span class="op" id="3693663">]</span>&nbsp;<span class="op" id="3693665">=</span>&nbsp;<span class="builtintype" id="3693667">byte</span><span class="op" id="3693671">(</span><span class="ident" id="3693672">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="3693699">&gt;&gt;</span>&nbsp;<span class="num" id="3693702">8</span><span class="op" id="3693703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693707">z</span><span class="op" id="3693708">[</span><span class="num" id="3693709">1</span><span class="op" id="3693710">]</span>&nbsp;<span class="op" id="3693712">=</span>&nbsp;<span class="builtintype" id="3693714">byte</span><span class="op" id="3693718">(</span><span class="ident" id="3693719">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="3693746">&amp;</span>&nbsp;<span class="num" id="3693748">0xff</span><span class="op" id="3693752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693756">z</span><span class="op" id="3693757">[</span><span class="num" id="3693758">2</span><span class="op" id="3693759">]</span>&nbsp;<span class="op" id="3693761">=</span>&nbsp;<span class="num" id="3693763">0</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693767">z</span><span class="op" id="3693768">[</span><span class="num" id="3693769">3</span><span class="op" id="3693770">]</span>&nbsp;<span class="op" id="3693772">=</span>&nbsp;<span class="num" id="3693774">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693778">z</span>&nbsp;<span class="op" id="3693780">=</span>&nbsp;<span class="ident" id="3693782">z</span><span class="op" id="3693783">[</span><span class="num" id="3693784">5</span><span class="op" id="3693785">:</span><span class="op" id="3693786">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3693789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3693792">if</span>&nbsp;<span class="builtinfunc" id="3693795">len</span><span class="op" id="3693798">(</span><span class="ident" id="3693799">m</span><span class="op" id="3693800">.</span><span class="ident" id="3693801">alpnProtocols</span><span class="op" id="3693814">)</span>&nbsp;<span class="op" id="3693816">&gt;</span>&nbsp;<span class="num" id="3693818">0</span>&nbsp;<span class="op" id="3693820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693824">z</span><span class="op" id="3693825">[</span><span class="num" id="3693826">0</span><span class="op" id="3693827">]</span>&nbsp;<span class="op" id="3693829">=</span>&nbsp;<span class="builtintype" id="3693831">byte</span><span class="op" id="3693835">(</span><span class="ident" id="3693836">extensionALPN</span>&nbsp;<span class="op" id="3693850">&gt;&gt;</span>&nbsp;<span class="num" id="3693853">8</span><span class="op" id="3693854">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693858">z</span><span class="op" id="3693859">[</span><span class="num" id="3693860">1</span><span class="op" id="3693861">]</span>&nbsp;<span class="op" id="3693863">=</span>&nbsp;<span class="builtintype" id="3693865">byte</span><span class="op" id="3693869">(</span><span class="ident" id="3693870">extensionALPN</span>&nbsp;<span class="op" id="3693884">&amp;</span>&nbsp;<span class="num" id="3693886">0xff</span><span class="op" id="3693890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693894">lengths</span>&nbsp;<span class="op" id="3693902">:=</span>&nbsp;<span class="ident" id="3693905">z</span><span class="op" id="3693906">[</span><span class="num" id="3693907">2</span><span class="op" id="3693908">:</span><span class="op" id="3693909">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693913">z</span>&nbsp;<span class="op" id="3693915">=</span>&nbsp;<span class="ident" id="3693917">z</span><span class="op" id="3693918">[</span><span class="num" id="3693919">6</span><span class="op" id="3693920">:</span><span class="op" id="3693921">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693926">stringsLength</span>&nbsp;<span class="op" id="3693940">:=</span>&nbsp;<span class="num" id="3693943">0</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3693947">for</span>&nbsp;<span class="ident" id="3693951">_</span><span class="op" id="3693952">,</span>&nbsp;<span class="ident" id="3693954">s</span>&nbsp;<span class="op" id="3693956">:=</span>&nbsp;<span class="keyword" id="3693959">range</span>&nbsp;<span class="ident" id="3693965">m</span><span class="op" id="3693966">.</span><span class="ident" id="3693967">alpnProtocols</span>&nbsp;<span class="op" id="3693981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693986">l</span>&nbsp;<span class="op" id="3693988">:=</span>&nbsp;<span class="builtinfunc" id="3693991">len</span><span class="op" id="3693994">(</span><span class="ident" id="3693995">s</span><span class="op" id="3693996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3694001">z</span><span class="op" id="3694002">[</span><span class="num" id="3694003">0</span><span class="op" id="3694004">]</span>&nbsp;<span class="op" id="3694006">=</span>&nbsp;<span class="builtintype" id="3694008">byte</span><span class="op" id="3694012">(</span><span class="ident" id="3694013">l</span><span class="op" id="3694014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3694019">copy</span><span class="op" id="3694023">(</span><span class="ident" id="3694024">z</span><span class="op" id="3694025">[</span><span class="num" id="3694026">1</span><span class="op" id="3694027">:</span><span class="op" id="3694028">]</span><span class="op" id="3694029">,</span>&nbsp;<span class="ident" id="3694031">s</span><span class="op" id="3694032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3694037">z</span>&nbsp;<span class="op" id="3694039">=</span>&nbsp;<span class="ident" id="3694041">z</span><span class="op" id="3694042">[</span><span class="num" id="3694043">1</span><span class="op" id="3694044">+</span><span class="ident" id="3694045">l</span><span class="op" id="3694046">:</span><span class="op" id="3694047">]</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3694052">stringsLength</span>&nbsp;<span class="op" id="3694066">+=</span>&nbsp;<span class="num" id="3694069">1</span>&nbsp;<span class="op" id="3694071">+</span>&nbsp;<span class="ident" id="3694073">l</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3694077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3694082">lengths</span><span class="op" id="3694089">[</span><span class="num" id="3694090">2</span><span class="op" id="3694091">]</span>&nbsp;<span class="op" id="3694093">=</span>&nbsp;<span class="builtintype" id="3694095">byte</span><span class="op" id="3694099">(</span><span class="ident" id="3694100">stringsLength</span>&nbsp;<span class="op" id="3694114">&gt;&gt;</span>&nbsp;<span class="num" id="3694117">8</span><span class="op" id="3694118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3694122">lengths</span><span class="op" id="3694129">[</span><span class="num" id="3694130">3</span><span class="op" id="3694131">]</span>&nbsp;<span class="op" id="3694133">=</span>&nbsp;<span class="builtintype" id="3694135">byte</span><span class="op" id="3694139">(</span><span class="ident" id="3694140">stringsLength</span><span class="op" id="3694153">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3694157">stringsLength</span>&nbsp;<span class="op" id="3694171">+=</span>&nbsp;<span class="num" id="3694174">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3694178">lengths</span><span class="op" id="3694185">[</span><span class="num" id="3694186">0</span><span class="op" id="3694187">]</span>&nbsp;<span class="op" id="3694189">=</span>&nbsp;<span class="builtintype" id="3694191">byte</span><span class="op" id="3694195">(</span><span class="ident" id="3694196">stringsLength</span>&nbsp;<span class="op" id="3694210">&gt;&gt;</span>&nbsp;<span class="num" id="3694213">8</span><span class="op" id="3694214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3694218">lengths</span><span class="op" id="3694225">[</span><span class="num" id="3694226">1</span><span class="op" id="3694227">]</span>&nbsp;<span class="op" id="3694229">=</span>&nbsp;<span class="builtintype" id="3694231">byte</span><span class="op" id="3694235">(</span><span class="ident" id="3694236">stringsLength</span><span class="op" id="3694249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3694252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3694256">m</span><span class="op" id="3694257">.</span><span class="ident" id="3694258">raw</span>&nbsp;<span class="op" id="3694262">=</span>&nbsp;<span class="ident" id="3694264">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3694268">return</span>&nbsp;<span class="ident" id="3694275">x</span><br>
<span class="lineno"></span><span class="op" id="3694277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="3694280">func</span>&nbsp;<span class="op" id="3694285">(</span><span class="ident" id="3694286">m</span>&nbsp;<span class="op" id="3694288">*</span><span class="ident" id="3694289">clientHelloMsg</span><span class="op" id="3694303">)</span>&nbsp;<span class="ident" id="3694305">unmarshal</span><span class="op" id="3694314">(</span><span class="ident" id="3694315">data</span>&nbsp;<span class="op" id="3694320">[</span><span class="op" id="3694321">]</span><span class="builtintype" id="3694322">byte</span><span class="op" id="3694326">)</span>&nbsp;<span class="builtintype" id="3694328">bool</span>&nbsp;<span class="op" id="3694333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3694336">if</span>&nbsp;<span class="builtinfunc" id="3694339">len</span><span class="op" id="3694342">(</span><span class="ident" id="3694343">data</span><span class="op" id="3694347">)</span>&nbsp;<span class="op" id="3694349">&lt;</span>&nbsp;<span class="num" id="3694351">42</span>&nbsp;<span class="op" id="3694354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3694358">return</span>&nbsp;<span class="builtintype" id="3694365">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3694372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3694375">m</span><span class="op" id="3694376">.</span><span class="ident" id="3694377">raw</span>&nbsp;<span class="op" id="3694381">=</span>&nbsp;<span class="ident" id="3694383">data</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3694389">m</span><span class="op" id="3694390">.</span><span class="ident" id="3694391">vers</span>&nbsp;<span class="op" id="3694396">=</span>&nbsp;<span class="builtintype" id="3694398">uint16</span><span class="op" id="3694404">(</span><span class="ident" id="3694405">data</span><span class="op" id="3694409">[</span><span class="num" id="3694410">4</span><span class="op" id="3694411">]</span><span class="op" id="3694412">)</span><span class="op" id="3694413">&lt;&lt;</span><span class="num" id="3694415">8</span>&nbsp;<span class="op" id="3694417">|</span>&nbsp;<span class="builtintype" id="3694419">uint16</span><span class="op" id="3694425">(</span><span class="ident" id="3694426">data</span><span class="op" id="3694430">[</span><span class="num" id="3694431">5</span><span class="op" id="3694432">]</span><span class="op" id="3694433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3694436">m</span><span class="op" id="3694437">.</span><span class="ident" id="3694438">random</span>&nbsp;<span class="op" id="3694445">=</span>&nbsp;<span class="ident" id="3694447">data</span><span class="op" id="3694451">[</span><span class="num" id="3694452">6</span><span class="op" id="3694453">:</span><span class="num" id="3694454">38</span><span class="op" id="3694456">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3694459">sessionIdLen</span>&nbsp;<span class="op" id="3694472">:=</span>&nbsp;<span class="builtintype" id="3694475">int</span><span class="op" id="3694478">(</span><span class="ident" id="3694479">data</span><span class="op" id="3694483">[</span><span class="num" id="3694484">38</span><span class="op" id="3694486">]</span><span class="op" id="3694487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3694490">if</span>&nbsp;<span class="ident" id="3694493">sessionIdLen</span>&nbsp;<span class="op" id="3694506">&gt;</span>&nbsp;<span class="num" id="3694508">32</span>&nbsp;<span class="op" id="3694511">||</span>&nbsp;<span class="builtinfunc" id="3694514">len</span><span class="op" id="3694517">(</span><span class="ident" id="3694518">data</span><span class="op" id="3694522">)</span>&nbsp;<span class="op" id="3694524">&lt;</span>&nbsp;<span class="num" id="3694526">39</span><span class="op" id="3694528">+</span><span class="ident" id="3694529">sessionIdLen</span>&nbsp;<span class="op" id="3694542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3694546">return</span>&nbsp;<span class="builtintype" id="3694553">false</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3694560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3694563">m</span><span class="op" id="3694564">.</span><span class="ident" id="3694565">sessionId</span>&nbsp;<span class="op" id="3694575">=</span>&nbsp;<span class="ident" id="3694577">data</span><span class="op" id="3694581">[</span><span class="num" id="3694582">39</span>&nbsp;<span class="op" id="3694585">:</span>&nbsp;<span class="num" id="3694587">39</span><span class="op" id="3694589">+</span><span class="ident" id="3694590">sessionIdLen</span><span class="op" id="3694602">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3694605">data</span>&nbsp;<span class="op" id="3694610">=</span>&nbsp;<span class="ident" id="3694612">data</span><span class="op" id="3694616">[</span><span class="num" id="3694617">39</span><span class="op" id="3694619">+</span><span class="ident" id="3694620">sessionIdLen</span><span class="op" id="3694632">:</span><span class="op" id="3694633">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3694636">if</span>&nbsp;<span class="builtinfunc" id="3694639">len</span><span class="op" id="3694642">(</span><span class="ident" id="3694643">data</span><span class="op" id="3694647">)</span>&nbsp;<span class="op" id="3694649">&lt;</span>&nbsp;<span class="num" id="3694651">2</span>&nbsp;<span class="op" id="3694653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3694657">return</span>&nbsp;<span class="builtintype" id="3694664">false</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3694671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3694674">//&nbsp;cipherSuiteLen&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;of&nbsp;cipher&nbsp;suite&nbsp;numbers.&nbsp;Since</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3694747">//&nbsp;they&nbsp;are&nbsp;uint16s,&nbsp;the&nbsp;number&nbsp;must&nbsp;be&nbsp;even.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3694794">cipherSuiteLen</span>&nbsp;<span class="op" id="3694809">:=</span>&nbsp;<span class="builtintype" id="3694812">int</span><span class="op" id="3694815">(</span><span class="ident" id="3694816">data</span><span class="op" id="3694820">[</span><span class="num" id="3694821">0</span><span class="op" id="3694822">]</span><span class="op" id="3694823">)</span><span class="op" id="3694824">&lt;&lt;</span><span class="num" id="3694826">8</span>&nbsp;<span class="op" id="3694828">|</span>&nbsp;<span class="builtintype" id="3694830">int</span><span class="op" id="3694833">(</span><span class="ident" id="3694834">data</span><span class="op" id="3694838">[</span><span class="num" id="3694839">1</span><span class="op" id="3694840">]</span><span class="op" id="3694841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3694844">if</span>&nbsp;<span class="ident" id="3694847">cipherSuiteLen</span><span class="op" id="3694861">%</span><span class="num" id="3694862">2</span>&nbsp;<span class="op" id="3694864">==</span>&nbsp;<span class="num" id="3694867">1</span>&nbsp;<span class="op" id="3694869">||</span>&nbsp;<span class="builtinfunc" id="3694872">len</span><span class="op" id="3694875">(</span><span class="ident" id="3694876">data</span><span class="op" id="3694880">)</span>&nbsp;<span class="op" id="3694882">&lt;</span>&nbsp;<span class="num" id="3694884">2</span><span class="op" id="3694885">+</span><span class="ident" id="3694886">cipherSuiteLen</span>&nbsp;<span class="op" id="3694901">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3694905">return</span>&nbsp;<span class="builtintype" id="3694912">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3694919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3694922">numCipherSuites</span>&nbsp;<span class="op" id="3694938">:=</span>&nbsp;<span class="ident" id="3694941">cipherSuiteLen</span>&nbsp;<span class="op" id="3694956">/</span>&nbsp;<span class="num" id="3694958">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3694961">m</span><span class="op" id="3694962">.</span><span class="ident" id="3694963">cipherSuites</span>&nbsp;<span class="op" id="3694976">=</span>&nbsp;<span class="builtinfunc" id="3694978">make</span><span class="op" id="3694982">(</span><span class="op" id="3694983">[</span><span class="op" id="3694984">]</span><span class="builtintype" id="3694985">uint16</span><span class="op" id="3694991">,</span>&nbsp;<span class="ident" id="3694993">numCipherSuites</span><span class="op" id="3695008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3695011">for</span>&nbsp;<span class="ident" id="3695015">i</span>&nbsp;<span class="op" id="3695017">:=</span>&nbsp;<span class="num" id="3695020">0</span><span class="op" id="3695021">;</span>&nbsp;<span class="ident" id="3695023">i</span>&nbsp;<span class="op" id="3695025">&lt;</span>&nbsp;<span class="ident" id="3695027">numCipherSuites</span><span class="op" id="3695042">;</span>&nbsp;<span class="ident" id="3695044">i</span><span class="op" id="3695045">++</span>&nbsp;<span class="op" id="3695048">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3695052">m</span><span class="op" id="3695053">.</span><span class="ident" id="3695054">cipherSuites</span><span class="op" id="3695066">[</span><span class="ident" id="3695067">i</span><span class="op" id="3695068">]</span>&nbsp;<span class="op" id="3695070">=</span>&nbsp;<span class="builtintype" id="3695072">uint16</span><span class="op" id="3695078">(</span><span class="ident" id="3695079">data</span><span class="op" id="3695083">[</span><span class="num" id="3695084">2</span><span class="op" id="3695085">+</span><span class="num" id="3695086">2</span><span class="op" id="3695087">*</span><span class="ident" id="3695088">i</span><span class="op" id="3695089">]</span><span class="op" id="3695090">)</span><span class="op" id="3695091">&lt;&lt;</span><span class="num" id="3695093">8</span>&nbsp;<span class="op" id="3695095">|</span>&nbsp;<span class="builtintype" id="3695097">uint16</span><span class="op" id="3695103">(</span><span class="ident" id="3695104">data</span><span class="op" id="3695108">[</span><span class="num" id="3695109">3</span><span class="op" id="3695110">+</span><span class="num" id="3695111">2</span><span class="op" id="3695112">*</span><span class="ident" id="3695113">i</span><span class="op" id="3695114">]</span><span class="op" id="3695115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3695119">if</span>&nbsp;<span class="ident" id="3695122">m</span><span class="op" id="3695123">.</span><span class="ident" id="3695124">cipherSuites</span><span class="op" id="3695136">[</span><span class="ident" id="3695137">i</span><span class="op" id="3695138">]</span>&nbsp;<span class="op" id="3695140">==</span>&nbsp;<span class="ident" id="3695143">scsvRenegotiation</span>&nbsp;<span class="op" id="3695161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3695166">m</span><span class="op" id="3695167">.</span><span class="ident" id="3695168">secureRenegotiation</span>&nbsp;<span class="op" id="3695188">=</span>&nbsp;<span class="builtintype" id="3695190">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3695197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3695200">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3695203">data</span>&nbsp;<span class="op" id="3695208">=</span>&nbsp;<span class="ident" id="3695210">data</span><span class="op" id="3695214">[</span><span class="num" id="3695215">2</span><span class="op" id="3695216">+</span><span class="ident" id="3695217">cipherSuiteLen</span><span class="op" id="3695231">:</span><span class="op" id="3695232">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3695235">if</span>&nbsp;<span class="builtinfunc" id="3695238">len</span><span class="op" id="3695241">(</span><span class="ident" id="3695242">data</span><span class="op" id="3695246">)</span>&nbsp;<span class="op" id="3695248">&lt;</span>&nbsp;<span class="num" id="3695250">1</span>&nbsp;<span class="op" id="3695252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3695256">return</span>&nbsp;<span class="builtintype" id="3695263">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3695270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3695273">compressionMethodsLen</span>&nbsp;<span class="op" id="3695295">:=</span>&nbsp;<span class="builtintype" id="3695298">int</span><span class="op" id="3695301">(</span><span class="ident" id="3695302">data</span><span class="op" id="3695306">[</span><span class="num" id="3695307">0</span><span class="op" id="3695308">]</span><span class="op" id="3695309">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3695312">if</span>&nbsp;<span class="builtinfunc" id="3695315">len</span><span class="op" id="3695318">(</span><span class="ident" id="3695319">data</span><span class="op" id="3695323">)</span>&nbsp;<span class="op" id="3695325">&lt;</span>&nbsp;<span class="num" id="3695327">1</span><span class="op" id="3695328">+</span><span class="ident" id="3695329">compressionMethodsLen</span>&nbsp;<span class="op" id="3695351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3695355">return</span>&nbsp;<span class="builtintype" id="3695362">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3695369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3695372">m</span><span class="op" id="3695373">.</span><span class="ident" id="3695374">compressionMethods</span>&nbsp;<span class="op" id="3695393">=</span>&nbsp;<span class="ident" id="3695395">data</span><span class="op" id="3695399">[</span><span class="num" id="3695400">1</span>&nbsp;<span class="op" id="3695402">:</span>&nbsp;<span class="num" id="3695404">1</span><span class="op" id="3695405">+</span><span class="ident" id="3695406">compressionMethodsLen</span><span class="op" id="3695427">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3695431">data</span>&nbsp;<span class="op" id="3695436">=</span>&nbsp;<span class="ident" id="3695438">data</span><span class="op" id="3695442">[</span><span class="num" id="3695443">1</span><span class="op" id="3695444">+</span><span class="ident" id="3695445">compressionMethodsLen</span><span class="op" id="3695466">:</span><span class="op" id="3695467">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3695471">m</span><span class="op" id="3695472">.</span><span class="ident" id="3695473">nextProtoNeg</span>&nbsp;<span class="op" id="3695486">=</span>&nbsp;<span class="builtintype" id="3695488">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3695495">m</span><span class="op" id="3695496">.</span><span class="ident" id="3695497">serverName</span>&nbsp;<span class="op" id="3695508">=</span>&nbsp;<span class="string" id="3695510">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3695514">m</span><span class="op" id="3695515">.</span><span class="ident" id="3695516">ocspStapling</span>&nbsp;<span class="op" id="3695529">=</span>&nbsp;<span class="builtintype" id="3695531">false</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3695538">m</span><span class="op" id="3695539">.</span><span class="ident" id="3695540">ticketSupported</span>&nbsp;<span class="op" id="3695556">=</span>&nbsp;<span class="builtintype" id="3695558">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3695565">m</span><span class="op" id="3695566">.</span><span class="ident" id="3695567">sessionTicket</span>&nbsp;<span class="op" id="3695581">=</span>&nbsp;<span class="ident" id="3695583">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3695588">m</span><span class="op" id="3695589">.</span><span class="ident" id="3695590">signatureAndHashes</span>&nbsp;<span class="op" id="3695609">=</span>&nbsp;<span class="ident" id="3695611">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3695616">m</span><span class="op" id="3695617">.</span><span class="ident" id="3695618">alpnProtocols</span>&nbsp;<span class="op" id="3695632">=</span>&nbsp;<span class="ident" id="3695634">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3695640">if</span>&nbsp;<span class="builtinfunc" id="3695643">len</span><span class="op" id="3695646">(</span><span class="ident" id="3695647">data</span><span class="op" id="3695651">)</span>&nbsp;<span class="op" id="3695653">==</span>&nbsp;<span class="num" id="3695656">0</span>&nbsp;<span class="op" id="3695658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3695662">//&nbsp;ClientHello&nbsp;is&nbsp;optionally&nbsp;followed&nbsp;by&nbsp;extension&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3695720">return</span>&nbsp;<span class="builtintype" id="3695727">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3695733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3695736">if</span>&nbsp;<span class="builtinfunc" id="3695739">len</span><span class="op" id="3695742">(</span><span class="ident" id="3695743">data</span><span class="op" id="3695747">)</span>&nbsp;<span class="op" id="3695749">&lt;</span>&nbsp;<span class="num" id="3695751">2</span>&nbsp;<span class="op" id="3695753">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3695757">return</span>&nbsp;<span class="builtintype" id="3695764">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3695771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3695775">extensionsLength</span>&nbsp;<span class="op" id="3695792">:=</span>&nbsp;<span class="builtintype" id="3695795">int</span><span class="op" id="3695798">(</span><span class="ident" id="3695799">data</span><span class="op" id="3695803">[</span><span class="num" id="3695804">0</span><span class="op" id="3695805">]</span><span class="op" id="3695806">)</span><span class="op" id="3695807">&lt;&lt;</span><span class="num" id="3695809">8</span>&nbsp;<span class="op" id="3695811">|</span>&nbsp;<span class="builtintype" id="3695813">int</span><span class="op" id="3695816">(</span><span class="ident" id="3695817">data</span><span class="op" id="3695821">[</span><span class="num" id="3695822">1</span><span class="op" id="3695823">]</span><span class="op" id="3695824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3695827">data</span>&nbsp;<span class="op" id="3695832">=</span>&nbsp;<span class="ident" id="3695834">data</span><span class="op" id="3695838">[</span><span class="num" id="3695839">2</span><span class="op" id="3695840">:</span><span class="op" id="3695841">]</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3695844">if</span>&nbsp;<span class="ident" id="3695847">extensionsLength</span>&nbsp;<span class="op" id="3695864">!=</span>&nbsp;<span class="builtinfunc" id="3695867">len</span><span class="op" id="3695870">(</span><span class="ident" id="3695871">data</span><span class="op" id="3695875">)</span>&nbsp;<span class="op" id="3695877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3695881">return</span>&nbsp;<span class="builtintype" id="3695888">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3695895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3695899">for</span>&nbsp;<span class="builtinfunc" id="3695903">len</span><span class="op" id="3695906">(</span><span class="ident" id="3695907">data</span><span class="op" id="3695911">)</span>&nbsp;<span class="op" id="3695913">!=</span>&nbsp;<span class="num" id="3695916">0</span>&nbsp;<span class="op" id="3695918">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3695922">if</span>&nbsp;<span class="builtinfunc" id="3695925">len</span><span class="op" id="3695928">(</span><span class="ident" id="3695929">data</span><span class="op" id="3695933">)</span>&nbsp;<span class="op" id="3695935">&lt;</span>&nbsp;<span class="num" id="3695937">4</span>&nbsp;<span class="op" id="3695939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3695944">return</span>&nbsp;<span class="builtintype" id="3695951">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3695959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3695963">extension</span>&nbsp;<span class="op" id="3695973">:=</span>&nbsp;<span class="builtintype" id="3695976">uint16</span><span class="op" id="3695982">(</span><span class="ident" id="3695983">data</span><span class="op" id="3695987">[</span><span class="num" id="3695988">0</span><span class="op" id="3695989">]</span><span class="op" id="3695990">)</span><span class="op" id="3695991">&lt;&lt;</span><span class="num" id="3695993">8</span>&nbsp;<span class="op" id="3695995">|</span>&nbsp;<span class="builtintype" id="3695997">uint16</span><span class="op" id="3696003">(</span><span class="ident" id="3696004">data</span><span class="op" id="3696008">[</span><span class="num" id="3696009">1</span><span class="op" id="3696010">]</span><span class="op" id="3696011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3696015">length</span>&nbsp;<span class="op" id="3696022">:=</span>&nbsp;<span class="builtintype" id="3696025">int</span><span class="op" id="3696028">(</span><span class="ident" id="3696029">data</span><span class="op" id="3696033">[</span><span class="num" id="3696034">2</span><span class="op" id="3696035">]</span><span class="op" id="3696036">)</span><span class="op" id="3696037">&lt;&lt;</span><span class="num" id="3696039">8</span>&nbsp;<span class="op" id="3696041">|</span>&nbsp;<span class="builtintype" id="3696043">int</span><span class="op" id="3696046">(</span><span class="ident" id="3696047">data</span><span class="op" id="3696051">[</span><span class="num" id="3696052">3</span><span class="op" id="3696053">]</span><span class="op" id="3696054">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3696058">data</span>&nbsp;<span class="op" id="3696063">=</span>&nbsp;<span class="ident" id="3696065">data</span><span class="op" id="3696069">[</span><span class="num" id="3696070">4</span><span class="op" id="3696071">:</span><span class="op" id="3696072">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696076">if</span>&nbsp;<span class="builtinfunc" id="3696079">len</span><span class="op" id="3696082">(</span><span class="ident" id="3696083">data</span><span class="op" id="3696087">)</span>&nbsp;<span class="op" id="3696089">&lt;</span>&nbsp;<span class="ident" id="3696091">length</span>&nbsp;<span class="op" id="3696098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696103">return</span>&nbsp;<span class="builtintype" id="3696110">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3696118">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696123">switch</span>&nbsp;<span class="ident" id="3696130">extension</span>&nbsp;<span class="op" id="3696140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696144">case</span>&nbsp;<span class="ident" id="3696149">extensionServerName</span><span class="op" id="3696168">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696173">if</span>&nbsp;<span class="ident" id="3696176">length</span>&nbsp;<span class="op" id="3696183">&lt;</span>&nbsp;<span class="num" id="3696185">2</span>&nbsp;<span class="op" id="3696187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696193">return</span>&nbsp;<span class="builtintype" id="3696200">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3696209">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3696214">numNames</span>&nbsp;<span class="op" id="3696223">:=</span>&nbsp;<span class="builtintype" id="3696226">int</span><span class="op" id="3696229">(</span><span class="ident" id="3696230">data</span><span class="op" id="3696234">[</span><span class="num" id="3696235">0</span><span class="op" id="3696236">]</span><span class="op" id="3696237">)</span><span class="op" id="3696238">&lt;&lt;</span><span class="num" id="3696240">8</span>&nbsp;<span class="op" id="3696242">|</span>&nbsp;<span class="builtintype" id="3696244">int</span><span class="op" id="3696247">(</span><span class="ident" id="3696248">data</span><span class="op" id="3696252">[</span><span class="num" id="3696253">1</span><span class="op" id="3696254">]</span><span class="op" id="3696255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3696260">d</span>&nbsp;<span class="op" id="3696262">:=</span>&nbsp;<span class="ident" id="3696265">data</span><span class="op" id="3696269">[</span><span class="num" id="3696270">2</span><span class="op" id="3696271">:</span><span class="op" id="3696272">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696277">for</span>&nbsp;<span class="ident" id="3696281">i</span>&nbsp;<span class="op" id="3696283">:=</span>&nbsp;<span class="num" id="3696286">0</span><span class="op" id="3696287">;</span>&nbsp;<span class="ident" id="3696289">i</span>&nbsp;<span class="op" id="3696291">&lt;</span>&nbsp;<span class="ident" id="3696293">numNames</span><span class="op" id="3696301">;</span>&nbsp;<span class="ident" id="3696303">i</span><span class="op" id="3696304">++</span>&nbsp;<span class="op" id="3696307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696313">if</span>&nbsp;<span class="builtinfunc" id="3696316">len</span><span class="op" id="3696319">(</span><span class="ident" id="3696320">d</span><span class="op" id="3696321">)</span>&nbsp;<span class="op" id="3696323">&lt;</span>&nbsp;<span class="num" id="3696325">3</span>&nbsp;<span class="op" id="3696327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696334">return</span>&nbsp;<span class="builtintype" id="3696341">false</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3696351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3696357">nameType</span>&nbsp;<span class="op" id="3696366">:=</span>&nbsp;<span class="ident" id="3696369">d</span><span class="op" id="3696370">[</span><span class="num" id="3696371">0</span><span class="op" id="3696372">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3696378">nameLen</span>&nbsp;<span class="op" id="3696386">:=</span>&nbsp;<span class="builtintype" id="3696389">int</span><span class="op" id="3696392">(</span><span class="ident" id="3696393">d</span><span class="op" id="3696394">[</span><span class="num" id="3696395">1</span><span class="op" id="3696396">]</span><span class="op" id="3696397">)</span><span class="op" id="3696398">&lt;&lt;</span><span class="num" id="3696400">8</span>&nbsp;<span class="op" id="3696402">|</span>&nbsp;<span class="builtintype" id="3696404">int</span><span class="op" id="3696407">(</span><span class="ident" id="3696408">d</span><span class="op" id="3696409">[</span><span class="num" id="3696410">2</span><span class="op" id="3696411">]</span><span class="op" id="3696412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3696418">d</span>&nbsp;<span class="op" id="3696420">=</span>&nbsp;<span class="ident" id="3696422">d</span><span class="op" id="3696423">[</span><span class="num" id="3696424">3</span><span class="op" id="3696425">:</span><span class="op" id="3696426">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696432">if</span>&nbsp;<span class="builtinfunc" id="3696435">len</span><span class="op" id="3696438">(</span><span class="ident" id="3696439">d</span><span class="op" id="3696440">)</span>&nbsp;<span class="op" id="3696442">&lt;</span>&nbsp;<span class="ident" id="3696444">nameLen</span>&nbsp;<span class="op" id="3696452">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696459">return</span>&nbsp;<span class="builtintype" id="3696466">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3696476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696482">if</span>&nbsp;<span class="ident" id="3696485">nameType</span>&nbsp;<span class="op" id="3696494">==</span>&nbsp;<span class="num" id="3696497">0</span>&nbsp;<span class="op" id="3696499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3696506">m</span><span class="op" id="3696507">.</span><span class="ident" id="3696508">serverName</span>&nbsp;<span class="op" id="3696519">=</span>&nbsp;<span class="builtintype" id="3696521">string</span><span class="op" id="3696527">(</span><span class="ident" id="3696528">d</span><span class="op" id="3696529">[</span><span class="num" id="3696530">0</span><span class="op" id="3696531">:</span><span class="ident" id="3696532">nameLen</span><span class="op" id="3696539">]</span><span class="op" id="3696540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696547">break</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3696557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3696563">d</span>&nbsp;<span class="op" id="3696565">=</span>&nbsp;<span class="ident" id="3696567">d</span><span class="op" id="3696568">[</span><span class="ident" id="3696569">nameLen</span><span class="op" id="3696576">:</span><span class="op" id="3696577">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3696582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696586">case</span>&nbsp;<span class="ident" id="3696591">extensionNextProtoNeg</span><span class="op" id="3696612">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696617">if</span>&nbsp;<span class="ident" id="3696620">length</span>&nbsp;<span class="op" id="3696627">&gt;</span>&nbsp;<span class="num" id="3696629">0</span>&nbsp;<span class="op" id="3696631">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696637">return</span>&nbsp;<span class="builtintype" id="3696644">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3696653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3696658">m</span><span class="op" id="3696659">.</span><span class="ident" id="3696660">nextProtoNeg</span>&nbsp;<span class="op" id="3696673">=</span>&nbsp;<span class="builtintype" id="3696675">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696682">case</span>&nbsp;<span class="ident" id="3696687">extensionStatusRequest</span><span class="op" id="3696709">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3696714">m</span><span class="op" id="3696715">.</span><span class="ident" id="3696716">ocspStapling</span>&nbsp;<span class="op" id="3696729">=</span>&nbsp;<span class="ident" id="3696731">length</span>&nbsp;<span class="op" id="3696738">&gt;</span>&nbsp;<span class="num" id="3696740">0</span>&nbsp;<span class="op" id="3696742">&amp;&amp;</span>&nbsp;<span class="ident" id="3696745">data</span><span class="op" id="3696749">[</span><span class="num" id="3696750">0</span><span class="op" id="3696751">]</span>&nbsp;<span class="op" id="3696753">==</span>&nbsp;<span class="ident" id="3696756">statusTypeOCSP</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696773">case</span>&nbsp;<span class="ident" id="3696778">extensionSupportedCurves</span><span class="op" id="3696802">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3696807">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696862">if</span>&nbsp;<span class="ident" id="3696865">length</span>&nbsp;<span class="op" id="3696872">&lt;</span>&nbsp;<span class="num" id="3696874">2</span>&nbsp;<span class="op" id="3696876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696882">return</span>&nbsp;<span class="builtintype" id="3696889">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3696898">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3696903">l</span>&nbsp;<span class="op" id="3696905">:=</span>&nbsp;<span class="builtintype" id="3696908">int</span><span class="op" id="3696911">(</span><span class="ident" id="3696912">data</span><span class="op" id="3696916">[</span><span class="num" id="3696917">0</span><span class="op" id="3696918">]</span><span class="op" id="3696919">)</span><span class="op" id="3696920">&lt;&lt;</span><span class="num" id="3696922">8</span>&nbsp;<span class="op" id="3696924">|</span>&nbsp;<span class="builtintype" id="3696926">int</span><span class="op" id="3696929">(</span><span class="ident" id="3696930">data</span><span class="op" id="3696934">[</span><span class="num" id="3696935">1</span><span class="op" id="3696936">]</span><span class="op" id="3696937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696942">if</span>&nbsp;<span class="ident" id="3696945">l</span><span class="op" id="3696946">%</span><span class="num" id="3696947">2</span>&nbsp;<span class="op" id="3696949">==</span>&nbsp;<span class="num" id="3696952">1</span>&nbsp;<span class="op" id="3696954">||</span>&nbsp;<span class="ident" id="3696957">length</span>&nbsp;<span class="op" id="3696964">!=</span>&nbsp;<span class="ident" id="3696967">l</span><span class="op" id="3696968">+</span><span class="num" id="3696969">2</span>&nbsp;<span class="op" id="3696971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3696977">return</span>&nbsp;<span class="builtintype" id="3696984">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3696993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3696998">numCurves</span>&nbsp;<span class="op" id="3697008">:=</span>&nbsp;<span class="ident" id="3697011">l</span>&nbsp;<span class="op" id="3697013">/</span>&nbsp;<span class="num" id="3697015">2</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3697020">m</span><span class="op" id="3697021">.</span><span class="ident" id="3697022">supportedCurves</span>&nbsp;<span class="op" id="3697038">=</span>&nbsp;<span class="builtinfunc" id="3697040">make</span><span class="op" id="3697044">(</span><span class="op" id="3697045">[</span><span class="op" id="3697046">]</span><span class="ident" id="3697047">CurveID</span><span class="op" id="3697054">,</span>&nbsp;<span class="ident" id="3697056">numCurves</span><span class="op" id="3697065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3697070">d</span>&nbsp;<span class="op" id="3697072">:=</span>&nbsp;<span class="ident" id="3697075">data</span><span class="op" id="3697079">[</span><span class="num" id="3697080">2</span><span class="op" id="3697081">:</span><span class="op" id="3697082">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3697087">for</span>&nbsp;<span class="ident" id="3697091">i</span>&nbsp;<span class="op" id="3697093">:=</span>&nbsp;<span class="num" id="3697096">0</span><span class="op" id="3697097">;</span>&nbsp;<span class="ident" id="3697099">i</span>&nbsp;<span class="op" id="3697101">&lt;</span>&nbsp;<span class="ident" id="3697103">numCurves</span><span class="op" id="3697112">;</span>&nbsp;<span class="ident" id="3697114">i</span><span class="op" id="3697115">++</span>&nbsp;<span class="op" id="3697118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3697124">m</span><span class="op" id="3697125">.</span><span class="ident" id="3697126">supportedCurves</span><span class="op" id="3697141">[</span><span class="ident" id="3697142">i</span><span class="op" id="3697143">]</span>&nbsp;<span class="op" id="3697145">=</span>&nbsp;<span class="ident" id="3697147">CurveID</span><span class="op" id="3697154">(</span><span class="ident" id="3697155">d</span><span class="op" id="3697156">[</span><span class="num" id="3697157">0</span><span class="op" id="3697158">]</span><span class="op" id="3697159">)</span><span class="op" id="3697160">&lt;&lt;</span><span class="num" id="3697162">8</span>&nbsp;<span class="op" id="3697164">|</span>&nbsp;<span class="ident" id="3697166">CurveID</span><span class="op" id="3697173">(</span><span class="ident" id="3697174">d</span><span class="op" id="3697175">[</span><span class="num" id="3697176">1</span><span class="op" id="3697177">]</span><span class="op" id="3697178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3697184">d</span>&nbsp;<span class="op" id="3697186">=</span>&nbsp;<span class="ident" id="3697188">d</span><span class="op" id="3697189">[</span><span class="num" id="3697190">2</span><span class="op" id="3697191">:</span><span class="op" id="3697192">]</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3697197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3697201">case</span>&nbsp;<span class="ident" id="3697206">extensionSupportedPoints</span><span class="op" id="3697230">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3697235">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3697290">if</span>&nbsp;<span class="ident" id="3697293">length</span>&nbsp;<span class="op" id="3697300">&lt;</span>&nbsp;<span class="num" id="3697302">1</span>&nbsp;<span class="op" id="3697304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3697310">return</span>&nbsp;<span class="builtintype" id="3697317">false</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3697326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3697331">l</span>&nbsp;<span class="op" id="3697333">:=</span>&nbsp;<span class="builtintype" id="3697336">int</span><span class="op" id="3697339">(</span><span class="ident" id="3697340">data</span><span class="op" id="3697344">[</span><span class="num" id="3697345">0</span><span class="op" id="3697346">]</span><span class="op" id="3697347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3697352">if</span>&nbsp;<span class="ident" id="3697355">length</span>&nbsp;<span class="op" id="3697362">!=</span>&nbsp;<span class="ident" id="3697365">l</span><span class="op" id="3697366">+</span><span class="num" id="3697367">1</span>&nbsp;<span class="op" id="3697369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3697375">return</span>&nbsp;<span class="builtintype" id="3697382">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3697391">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3697396">m</span><span class="op" id="3697397">.</span><span class="ident" id="3697398">supportedPoints</span>&nbsp;<span class="op" id="3697414">=</span>&nbsp;<span class="builtinfunc" id="3697416">make</span><span class="op" id="3697420">(</span><span class="op" id="3697421">[</span><span class="op" id="3697422">]</span><span class="builtintype" id="3697423">uint8</span><span class="op" id="3697428">,</span>&nbsp;<span class="ident" id="3697430">l</span><span class="op" id="3697431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3697436">copy</span><span class="op" id="3697440">(</span><span class="ident" id="3697441">m</span><span class="op" id="3697442">.</span><span class="ident" id="3697443">supportedPoints</span><span class="op" id="3697458">,</span>&nbsp;<span class="ident" id="3697460">data</span><span class="op" id="3697464">[</span><span class="num" id="3697465">1</span><span class="op" id="3697466">:</span><span class="op" id="3697467">]</span><span class="op" id="3697468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3697472">case</span>&nbsp;<span class="ident" id="3697477">extensionSessionTicket</span><span class="op" id="3697499">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3697504">//&nbsp;http://tools.ietf.org/html/rfc5077#section-3.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3697557">m</span><span class="op" id="3697558">.</span><span class="ident" id="3697559">ticketSupported</span>&nbsp;<span class="op" id="3697575">=</span>&nbsp;<span class="builtintype" id="3697577">true</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3697585">m</span><span class="op" id="3697586">.</span><span class="ident" id="3697587">sessionTicket</span>&nbsp;<span class="op" id="3697601">=</span>&nbsp;<span class="ident" id="3697603">data</span><span class="op" id="3697607">[</span><span class="op" id="3697608">:</span><span class="ident" id="3697609">length</span><span class="op" id="3697615">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3697619">case</span>&nbsp;<span class="ident" id="3697624">extensionSignatureAlgorithms</span><span class="op" id="3697652">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3697657">//&nbsp;https://tools.ietf.org/html/rfc5246#section-7.4.1.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3697717">if</span>&nbsp;<span class="ident" id="3697720">length</span>&nbsp;<span class="op" id="3697727">&lt;</span>&nbsp;<span class="num" id="3697729">2</span>&nbsp;<span class="op" id="3697731">||</span>&nbsp;<span class="ident" id="3697734">length</span><span class="op" id="3697740">&amp;</span><span class="num" id="3697741">1</span>&nbsp;<span class="op" id="3697743">!=</span>&nbsp;<span class="num" id="3697746">0</span>&nbsp;<span class="op" id="3697748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3697754">return</span>&nbsp;<span class="builtintype" id="3697761">false</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3697770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3697775">l</span>&nbsp;<span class="op" id="3697777">:=</span>&nbsp;<span class="builtintype" id="3697780">int</span><span class="op" id="3697783">(</span><span class="ident" id="3697784">data</span><span class="op" id="3697788">[</span><span class="num" id="3697789">0</span><span class="op" id="3697790">]</span><span class="op" id="3697791">)</span><span class="op" id="3697792">&lt;&lt;</span><span class="num" id="3697794">8</span>&nbsp;<span class="op" id="3697796">|</span>&nbsp;<span class="builtintype" id="3697798">int</span><span class="op" id="3697801">(</span><span class="ident" id="3697802">data</span><span class="op" id="3697806">[</span><span class="num" id="3697807">1</span><span class="op" id="3697808">]</span><span class="op" id="3697809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3697814">if</span>&nbsp;<span class="ident" id="3697817">l</span>&nbsp;<span class="op" id="3697819">!=</span>&nbsp;<span class="ident" id="3697822">length</span><span class="op" id="3697828">-</span><span class="num" id="3697829">2</span>&nbsp;<span class="op" id="3697831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3697837">return</span>&nbsp;<span class="builtintype" id="3697844">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3697853">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3697858">n</span>&nbsp;<span class="op" id="3697860">:=</span>&nbsp;<span class="ident" id="3697863">l</span>&nbsp;<span class="op" id="3697865">/</span>&nbsp;<span class="num" id="3697867">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3697872">d</span>&nbsp;<span class="op" id="3697874">:=</span>&nbsp;<span class="ident" id="3697877">data</span><span class="op" id="3697881">[</span><span class="num" id="3697882">2</span><span class="op" id="3697883">:</span><span class="op" id="3697884">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3697889">m</span><span class="op" id="3697890">.</span><span class="ident" id="3697891">signatureAndHashes</span>&nbsp;<span class="op" id="3697910">=</span>&nbsp;<span class="builtinfunc" id="3697912">make</span><span class="op" id="3697916">(</span><span class="op" id="3697917">[</span><span class="op" id="3697918">]</span><span class="ident" id="3697919">signatureAndHash</span><span class="op" id="3697935">,</span>&nbsp;<span class="ident" id="3697937">n</span><span class="op" id="3697938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3697943">for</span>&nbsp;<span class="ident" id="3697947">i</span>&nbsp;<span class="op" id="3697949">:=</span>&nbsp;<span class="keyword" id="3697952">range</span>&nbsp;<span class="ident" id="3697958">m</span><span class="op" id="3697959">.</span><span class="ident" id="3697960">signatureAndHashes</span>&nbsp;<span class="op" id="3697979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3697985">m</span><span class="op" id="3697986">.</span><span class="ident" id="3697987">signatureAndHashes</span><span class="op" id="3698005">[</span><span class="ident" id="3698006">i</span><span class="op" id="3698007">]</span><span class="op" id="3698008">.</span><span class="ident" id="3698009">hash</span>&nbsp;<span class="op" id="3698014">=</span>&nbsp;<span class="ident" id="3698016">d</span><span class="op" id="3698017">[</span><span class="num" id="3698018">0</span><span class="op" id="3698019">]</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3698025">m</span><span class="op" id="3698026">.</span><span class="ident" id="3698027">signatureAndHashes</span><span class="op" id="3698045">[</span><span class="ident" id="3698046">i</span><span class="op" id="3698047">]</span><span class="op" id="3698048">.</span><span class="ident" id="3698049">signature</span>&nbsp;<span class="op" id="3698059">=</span>&nbsp;<span class="ident" id="3698061">d</span><span class="op" id="3698062">[</span><span class="num" id="3698063">1</span><span class="op" id="3698064">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3698070">d</span>&nbsp;<span class="op" id="3698072">=</span>&nbsp;<span class="ident" id="3698074">d</span><span class="op" id="3698075">[</span><span class="num" id="3698076">2</span><span class="op" id="3698077">:</span><span class="op" id="3698078">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3698083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3698087">case</span>&nbsp;<span class="ident" id="3698092">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="3698119">+</span>&nbsp;<span class="num" id="3698121">1</span><span class="op" id="3698122">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3698127">if</span>&nbsp;<span class="ident" id="3698130">length</span>&nbsp;<span class="op" id="3698137">!=</span>&nbsp;<span class="num" id="3698140">1</span>&nbsp;<span class="op" id="3698142">||</span>&nbsp;<span class="ident" id="3698145">data</span><span class="op" id="3698149">[</span><span class="num" id="3698150">0</span><span class="op" id="3698151">]</span>&nbsp;<span class="op" id="3698153">!=</span>&nbsp;<span class="num" id="3698156">0</span>&nbsp;<span class="op" id="3698158">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3698164">return</span>&nbsp;<span class="builtintype" id="3698171">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3698180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3698185">m</span><span class="op" id="3698186">.</span><span class="ident" id="3698187">secureRenegotiation</span>&nbsp;<span class="op" id="3698207">=</span>&nbsp;<span class="builtintype" id="3698209">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3698216">case</span>&nbsp;<span class="ident" id="3698221">extensionALPN</span><span class="op" id="3698234">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3698239">if</span>&nbsp;<span class="ident" id="3698242">length</span>&nbsp;<span class="op" id="3698249">&lt;</span>&nbsp;<span class="num" id="3698251">2</span>&nbsp;<span class="op" id="3698253">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3698259">return</span>&nbsp;<span class="builtintype" id="3698266">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3698275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3698280">l</span>&nbsp;<span class="op" id="3698282">:=</span>&nbsp;<span class="builtintype" id="3698285">int</span><span class="op" id="3698288">(</span><span class="ident" id="3698289">data</span><span class="op" id="3698293">[</span><span class="num" id="3698294">0</span><span class="op" id="3698295">]</span><span class="op" id="3698296">)</span><span class="op" id="3698297">&lt;&lt;</span><span class="num" id="3698299">8</span>&nbsp;<span class="op" id="3698301">|</span>&nbsp;<span class="builtintype" id="3698303">int</span><span class="op" id="3698306">(</span><span class="ident" id="3698307">data</span><span class="op" id="3698311">[</span><span class="num" id="3698312">1</span><span class="op" id="3698313">]</span><span class="op" id="3698314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3698319">if</span>&nbsp;<span class="ident" id="3698322">l</span>&nbsp;<span class="op" id="3698324">!=</span>&nbsp;<span class="ident" id="3698327">length</span><span class="op" id="3698333">-</span><span class="num" id="3698334">2</span>&nbsp;<span class="op" id="3698336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3698342">return</span>&nbsp;<span class="builtintype" id="3698349">false</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3698358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3698363">d</span>&nbsp;<span class="op" id="3698365">:=</span>&nbsp;<span class="ident" id="3698368">data</span><span class="op" id="3698372">[</span><span class="num" id="3698373">2</span><span class="op" id="3698374">:</span><span class="ident" id="3698375">length</span><span class="op" id="3698381">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3698386">for</span>&nbsp;<span class="builtinfunc" id="3698390">len</span><span class="op" id="3698393">(</span><span class="ident" id="3698394">d</span><span class="op" id="3698395">)</span>&nbsp;<span class="op" id="3698397">!=</span>&nbsp;<span class="num" id="3698400">0</span>&nbsp;<span class="op" id="3698402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3698408">stringLen</span>&nbsp;<span class="op" id="3698418">:=</span>&nbsp;<span class="builtintype" id="3698421">int</span><span class="op" id="3698424">(</span><span class="ident" id="3698425">d</span><span class="op" id="3698426">[</span><span class="num" id="3698427">0</span><span class="op" id="3698428">]</span><span class="op" id="3698429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3698435">d</span>&nbsp;<span class="op" id="3698437">=</span>&nbsp;<span class="ident" id="3698439">d</span><span class="op" id="3698440">[</span><span class="num" id="3698441">1</span><span class="op" id="3698442">:</span><span class="op" id="3698443">]</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3698449">if</span>&nbsp;<span class="ident" id="3698452">stringLen</span>&nbsp;<span class="op" id="3698462">==</span>&nbsp;<span class="num" id="3698465">0</span>&nbsp;<span class="op" id="3698467">||</span>&nbsp;<span class="ident" id="3698470">stringLen</span>&nbsp;<span class="op" id="3698480">&gt;</span>&nbsp;<span class="builtinfunc" id="3698482">len</span><span class="op" id="3698485">(</span><span class="ident" id="3698486">d</span><span class="op" id="3698487">)</span>&nbsp;<span class="op" id="3698489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3698496">return</span>&nbsp;<span class="builtintype" id="3698503">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3698513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3698519">m</span><span class="op" id="3698520">.</span><span class="ident" id="3698521">alpnProtocols</span>&nbsp;<span class="op" id="3698535">=</span>&nbsp;<span class="builtinfunc" id="3698537">append</span><span class="op" id="3698543">(</span><span class="ident" id="3698544">m</span><span class="op" id="3698545">.</span><span class="ident" id="3698546">alpnProtocols</span><span class="op" id="3698559">,</span>&nbsp;<span class="builtintype" id="3698561">string</span><span class="op" id="3698567">(</span><span class="ident" id="3698568">d</span><span class="op" id="3698569">[</span><span class="op" id="3698570">:</span><span class="ident" id="3698571">stringLen</span><span class="op" id="3698580">]</span><span class="op" id="3698581">)</span><span class="op" id="3698582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3698588">d</span>&nbsp;<span class="op" id="3698590">=</span>&nbsp;<span class="ident" id="3698592">d</span><span class="op" id="3698593">[</span><span class="ident" id="3698594">stringLen</span><span class="op" id="3698603">:</span><span class="op" id="3698604">]</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3698609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3698613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3698617">data</span>&nbsp;<span class="op" id="3698622">=</span>&nbsp;<span class="ident" id="3698624">data</span><span class="op" id="3698628">[</span><span class="ident" id="3698629">length</span><span class="op" id="3698635">:</span><span class="op" id="3698636">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3698639">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3698643">return</span>&nbsp;<span class="builtintype" id="3698650">true</span><br>
<span class="lineno"></span><span class="op" id="3698655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3698658">type</span>&nbsp;<span class="ident" id="3698663">serverHelloMsg</span>&nbsp;<span class="keyword" id="3698678">struct</span>&nbsp;<span class="op" id="3698685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3698688">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3698708">[</span><span class="op" id="3698709">]</span><span class="builtintype" id="3698710">byte</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3698716">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3698736">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3698744">random</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3698764">[</span><span class="op" id="3698765">]</span><span class="builtintype" id="3698766">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3698772">sessionId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3698792">[</span><span class="op" id="3698793">]</span><span class="builtintype" id="3698794">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3698800">cipherSuite</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3698820">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3698828">compressionMethod</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3698848">uint8</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3698855">nextProtoNeg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3698875">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3698881">nextProtos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3698901">[</span><span class="op" id="3698902">]</span><span class="builtintype" id="3698903">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3698911">ocspStapling</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3698931">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3698937">ticketSupported</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3698957">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3698963">secureRenegotiation</span>&nbsp;<span class="builtintype" id="3698983">bool</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3698989">alpnProtocol</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3699009">string</span><br>
<span class="lineno"></span><span class="op" id="3699016">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3699019">func</span>&nbsp;<span class="op" id="3699024">(</span><span class="ident" id="3699025">m</span>&nbsp;<span class="op" id="3699027">*</span><span class="ident" id="3699028">serverHelloMsg</span><span class="op" id="3699042">)</span>&nbsp;<span class="ident" id="3699044">equal</span><span class="op" id="3699049">(</span><span class="ident" id="3699050">i</span>&nbsp;<span class="keyword" id="3699052">interface</span><span class="op" id="3699061">{</span><span class="op" id="3699062">}</span><span class="op" id="3699063">)</span>&nbsp;<span class="builtintype" id="3699065">bool</span>&nbsp;<span class="op" id="3699070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3699073">m1</span><span class="op" id="3699075">,</span>&nbsp;<span class="ident" id="3699077">ok</span>&nbsp;<span class="op" id="3699080">:=</span>&nbsp;<span class="ident" id="3699083">i</span><span class="op" id="3699084">.</span><span class="op" id="3699085">(</span><span class="op" id="3699086">*</span><span class="ident" id="3699087">serverHelloMsg</span><span class="op" id="3699101">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3699104">if</span>&nbsp;<span class="op" id="3699107">!</span><span class="ident" id="3699108">ok</span>&nbsp;<span class="op" id="3699111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3699115">return</span>&nbsp;<span class="builtintype" id="3699122">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3699129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3699133">return</span>&nbsp;<span class="ident" id="3699140">bytes</span><span class="op" id="3699145">.</span><span class="ident" id="3699146">Equal</span><span class="op" id="3699151">(</span><span class="ident" id="3699152">m</span><span class="op" id="3699153">.</span><span class="ident" id="3699154">raw</span><span class="op" id="3699157">,</span>&nbsp;<span class="ident" id="3699159">m1</span><span class="op" id="3699161">.</span><span class="ident" id="3699162">raw</span><span class="op" id="3699165">)</span>&nbsp;<span class="op" id="3699167">&amp;&amp;</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3699172">m</span><span class="op" id="3699173">.</span><span class="ident" id="3699174">vers</span>&nbsp;<span class="op" id="3699179">==</span>&nbsp;<span class="ident" id="3699182">m1</span><span class="op" id="3699184">.</span><span class="ident" id="3699185">vers</span>&nbsp;<span class="op" id="3699190">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3699195">bytes</span><span class="op" id="3699200">.</span><span class="ident" id="3699201">Equal</span><span class="op" id="3699206">(</span><span class="ident" id="3699207">m</span><span class="op" id="3699208">.</span><span class="ident" id="3699209">random</span><span class="op" id="3699215">,</span>&nbsp;<span class="ident" id="3699217">m1</span><span class="op" id="3699219">.</span><span class="ident" id="3699220">random</span><span class="op" id="3699226">)</span>&nbsp;<span class="op" id="3699228">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3699233">bytes</span><span class="op" id="3699238">.</span><span class="ident" id="3699239">Equal</span><span class="op" id="3699244">(</span><span class="ident" id="3699245">m</span><span class="op" id="3699246">.</span><span class="ident" id="3699247">sessionId</span><span class="op" id="3699256">,</span>&nbsp;<span class="ident" id="3699258">m1</span><span class="op" id="3699260">.</span><span class="ident" id="3699261">sessionId</span><span class="op" id="3699270">)</span>&nbsp;<span class="op" id="3699272">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3699277">m</span><span class="op" id="3699278">.</span><span class="ident" id="3699279">cipherSuite</span>&nbsp;<span class="op" id="3699291">==</span>&nbsp;<span class="ident" id="3699294">m1</span><span class="op" id="3699296">.</span><span class="ident" id="3699297">cipherSuite</span>&nbsp;<span class="op" id="3699309">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3699314">m</span><span class="op" id="3699315">.</span><span class="ident" id="3699316">compressionMethod</span>&nbsp;<span class="op" id="3699334">==</span>&nbsp;<span class="ident" id="3699337">m1</span><span class="op" id="3699339">.</span><span class="ident" id="3699340">compressionMethod</span>&nbsp;<span class="op" id="3699358">&amp;&amp;</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3699363">m</span><span class="op" id="3699364">.</span><span class="ident" id="3699365">nextProtoNeg</span>&nbsp;<span class="op" id="3699378">==</span>&nbsp;<span class="ident" id="3699381">m1</span><span class="op" id="3699383">.</span><span class="ident" id="3699384">nextProtoNeg</span>&nbsp;<span class="op" id="3699397">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3699402">eqStrings</span><span class="op" id="3699411">(</span><span class="ident" id="3699412">m</span><span class="op" id="3699413">.</span><span class="ident" id="3699414">nextProtos</span><span class="op" id="3699424">,</span>&nbsp;<span class="ident" id="3699426">m1</span><span class="op" id="3699428">.</span><span class="ident" id="3699429">nextProtos</span><span class="op" id="3699439">)</span>&nbsp;<span class="op" id="3699441">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3699446">m</span><span class="op" id="3699447">.</span><span class="ident" id="3699448">ocspStapling</span>&nbsp;<span class="op" id="3699461">==</span>&nbsp;<span class="ident" id="3699464">m1</span><span class="op" id="3699466">.</span><span class="ident" id="3699467">ocspStapling</span>&nbsp;<span class="op" id="3699480">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3699485">m</span><span class="op" id="3699486">.</span><span class="ident" id="3699487">ticketSupported</span>&nbsp;<span class="op" id="3699503">==</span>&nbsp;<span class="ident" id="3699506">m1</span><span class="op" id="3699508">.</span><span class="ident" id="3699509">ticketSupported</span>&nbsp;<span class="op" id="3699525">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3699530">m</span><span class="op" id="3699531">.</span><span class="ident" id="3699532">secureRenegotiation</span>&nbsp;<span class="op" id="3699552">==</span>&nbsp;<span class="ident" id="3699555">m1</span><span class="op" id="3699557">.</span><span class="ident" id="3699558">secureRenegotiation</span>&nbsp;<span class="op" id="3699578">&amp;&amp;</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3699583">m</span><span class="op" id="3699584">.</span><span class="ident" id="3699585">alpnProtocol</span>&nbsp;<span class="op" id="3699598">==</span>&nbsp;<span class="ident" id="3699601">m1</span><span class="op" id="3699603">.</span><span class="ident" id="3699604">alpnProtocol</span><br>
<span class="lineno"></span><span class="op" id="3699617">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3699620">func</span>&nbsp;<span class="op" id="3699625">(</span><span class="ident" id="3699626">m</span>&nbsp;<span class="op" id="3699628">*</span><span class="ident" id="3699629">serverHelloMsg</span><span class="op" id="3699643">)</span>&nbsp;<span class="ident" id="3699645">marshal</span><span class="op" id="3699652">(</span><span class="op" id="3699653">)</span>&nbsp;<span class="op" id="3699655">[</span><span class="op" id="3699656">]</span><span class="builtintype" id="3699657">byte</span>&nbsp;<span class="op" id="3699662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3699665">if</span>&nbsp;<span class="ident" id="3699668">m</span><span class="op" id="3699669">.</span><span class="ident" id="3699670">raw</span>&nbsp;<span class="op" id="3699674">!=</span>&nbsp;<span class="ident" id="3699677">nil</span>&nbsp;<span class="op" id="3699681">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3699685">return</span>&nbsp;<span class="ident" id="3699692">m</span><span class="op" id="3699693">.</span><span class="ident" id="3699694">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3699699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3699703">length</span>&nbsp;<span class="op" id="3699710">:=</span>&nbsp;<span class="num" id="3699713">38</span>&nbsp;<span class="op" id="3699716">+</span>&nbsp;<span class="builtinfunc" id="3699718">len</span><span class="op" id="3699721">(</span><span class="ident" id="3699722">m</span><span class="op" id="3699723">.</span><span class="ident" id="3699724">sessionId</span><span class="op" id="3699733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3699736">numExtensions</span>&nbsp;<span class="op" id="3699750">:=</span>&nbsp;<span class="num" id="3699753">0</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3699756">extensionsLength</span>&nbsp;<span class="op" id="3699773">:=</span>&nbsp;<span class="num" id="3699776">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3699780">nextProtoLen</span>&nbsp;<span class="op" id="3699793">:=</span>&nbsp;<span class="num" id="3699796">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3699799">if</span>&nbsp;<span class="ident" id="3699802">m</span><span class="op" id="3699803">.</span><span class="ident" id="3699804">nextProtoNeg</span>&nbsp;<span class="op" id="3699817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3699821">numExtensions</span><span class="op" id="3699834">++</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3699839">for</span>&nbsp;<span class="ident" id="3699843">_</span><span class="op" id="3699844">,</span>&nbsp;<span class="ident" id="3699846">v</span>&nbsp;<span class="op" id="3699848">:=</span>&nbsp;<span class="keyword" id="3699851">range</span>&nbsp;<span class="ident" id="3699857">m</span><span class="op" id="3699858">.</span><span class="ident" id="3699859">nextProtos</span>&nbsp;<span class="op" id="3699870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3699875">nextProtoLen</span>&nbsp;<span class="op" id="3699888">+=</span>&nbsp;<span class="builtinfunc" id="3699891">len</span><span class="op" id="3699894">(</span><span class="ident" id="3699895">v</span><span class="op" id="3699896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3699900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3699904">nextProtoLen</span>&nbsp;<span class="op" id="3699917">+=</span>&nbsp;<span class="builtinfunc" id="3699920">len</span><span class="op" id="3699923">(</span><span class="ident" id="3699924">m</span><span class="op" id="3699925">.</span><span class="ident" id="3699926">nextProtos</span><span class="op" id="3699936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3699940">extensionsLength</span>&nbsp;<span class="op" id="3699957">+=</span>&nbsp;<span class="ident" id="3699960">nextProtoLen</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3699974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3699977">if</span>&nbsp;<span class="ident" id="3699980">m</span><span class="op" id="3699981">.</span><span class="ident" id="3699982">ocspStapling</span>&nbsp;<span class="op" id="3699995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3699999">numExtensions</span><span class="op" id="3700012">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3700016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3700019">if</span>&nbsp;<span class="ident" id="3700022">m</span><span class="op" id="3700023">.</span><span class="ident" id="3700024">ticketSupported</span>&nbsp;<span class="op" id="3700040">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3700044">numExtensions</span><span class="op" id="3700057">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3700061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3700064">if</span>&nbsp;<span class="ident" id="3700067">m</span><span class="op" id="3700068">.</span><span class="ident" id="3700069">secureRenegotiation</span>&nbsp;<span class="op" id="3700089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3700093">extensionsLength</span>&nbsp;<span class="op" id="3700110">+=</span>&nbsp;<span class="num" id="3700113">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3700117">numExtensions</span><span class="op" id="3700130">++</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3700134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3700137">if</span>&nbsp;<span class="ident" id="3700140">alpnLen</span>&nbsp;<span class="op" id="3700148">:=</span>&nbsp;<span class="builtinfunc" id="3700151">len</span><span class="op" id="3700154">(</span><span class="ident" id="3700155">m</span><span class="op" id="3700156">.</span><span class="ident" id="3700157">alpnProtocol</span><span class="op" id="3700169">)</span><span class="op" id="3700170">;</span>&nbsp;<span class="ident" id="3700172">alpnLen</span>&nbsp;<span class="op" id="3700180">&gt;</span>&nbsp;<span class="num" id="3700182">0</span>&nbsp;<span class="op" id="3700184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3700188">if</span>&nbsp;<span class="ident" id="3700191">alpnLen</span>&nbsp;<span class="op" id="3700199">&gt;=</span>&nbsp;<span class="num" id="3700202">256</span>&nbsp;<span class="op" id="3700206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3700211">panic</span><span class="op" id="3700216">(</span><span class="string" id="3700217">&#34;invalid&nbsp;ALPN&nbsp;protocol&#34;</span><span class="op" id="3700240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3700244">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3700248">extensionsLength</span>&nbsp;<span class="op" id="3700265">+=</span>&nbsp;<span class="num" id="3700268">2</span>&nbsp;<span class="op" id="3700270">+</span>&nbsp;<span class="num" id="3700272">1</span>&nbsp;<span class="op" id="3700274">+</span>&nbsp;<span class="ident" id="3700276">alpnLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3700286">numExtensions</span><span class="op" id="3700299">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3700303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3700307">if</span>&nbsp;<span class="ident" id="3700310">numExtensions</span>&nbsp;<span class="op" id="3700324">&gt;</span>&nbsp;<span class="num" id="3700326">0</span>&nbsp;<span class="op" id="3700328">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3700332">extensionsLength</span>&nbsp;<span class="op" id="3700349">+=</span>&nbsp;<span class="num" id="3700352">4</span>&nbsp;<span class="op" id="3700354">*</span>&nbsp;<span class="ident" id="3700356">numExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3700372">length</span>&nbsp;<span class="op" id="3700379">+=</span>&nbsp;<span class="num" id="3700382">2</span>&nbsp;<span class="op" id="3700384">+</span>&nbsp;<span class="ident" id="3700386">extensionsLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3700404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3700408">x</span>&nbsp;<span class="op" id="3700410">:=</span>&nbsp;<span class="builtinfunc" id="3700413">make</span><span class="op" id="3700417">(</span><span class="op" id="3700418">[</span><span class="op" id="3700419">]</span><span class="builtintype" id="3700420">byte</span><span class="op" id="3700424">,</span>&nbsp;<span class="num" id="3700426">4</span><span class="op" id="3700427">+</span><span class="ident" id="3700428">length</span><span class="op" id="3700434">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3700437">x</span><span class="op" id="3700438">[</span><span class="num" id="3700439">0</span><span class="op" id="3700440">]</span>&nbsp;<span class="op" id="3700442">=</span>&nbsp;<span class="ident" id="3700444">typeServerHello</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3700461">x</span><span class="op" id="3700462">[</span><span class="num" id="3700463">1</span><span class="op" id="3700464">]</span>&nbsp;<span class="op" id="3700466">=</span>&nbsp;<span class="builtintype" id="3700468">uint8</span><span class="op" id="3700473">(</span><span class="ident" id="3700474">length</span>&nbsp;<span class="op" id="3700481">&gt;&gt;</span>&nbsp;<span class="num" id="3700484">16</span><span class="op" id="3700486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3700489">x</span><span class="op" id="3700490">[</span><span class="num" id="3700491">2</span><span class="op" id="3700492">]</span>&nbsp;<span class="op" id="3700494">=</span>&nbsp;<span class="builtintype" id="3700496">uint8</span><span class="op" id="3700501">(</span><span class="ident" id="3700502">length</span>&nbsp;<span class="op" id="3700509">&gt;&gt;</span>&nbsp;<span class="num" id="3700512">8</span><span class="op" id="3700513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3700516">x</span><span class="op" id="3700517">[</span><span class="num" id="3700518">3</span><span class="op" id="3700519">]</span>&nbsp;<span class="op" id="3700521">=</span>&nbsp;<span class="builtintype" id="3700523">uint8</span><span class="op" id="3700528">(</span><span class="ident" id="3700529">length</span><span class="op" id="3700535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3700538">x</span><span class="op" id="3700539">[</span><span class="num" id="3700540">4</span><span class="op" id="3700541">]</span>&nbsp;<span class="op" id="3700543">=</span>&nbsp;<span class="builtintype" id="3700545">uint8</span><span class="op" id="3700550">(</span><span class="ident" id="3700551">m</span><span class="op" id="3700552">.</span><span class="ident" id="3700553">vers</span>&nbsp;<span class="op" id="3700558">&gt;&gt;</span>&nbsp;<span class="num" id="3700561">8</span><span class="op" id="3700562">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3700565">x</span><span class="op" id="3700566">[</span><span class="num" id="3700567">5</span><span class="op" id="3700568">]</span>&nbsp;<span class="op" id="3700570">=</span>&nbsp;<span class="builtintype" id="3700572">uint8</span><span class="op" id="3700577">(</span><span class="ident" id="3700578">m</span><span class="op" id="3700579">.</span><span class="ident" id="3700580">vers</span><span class="op" id="3700584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3700587">copy</span><span class="op" id="3700591">(</span><span class="ident" id="3700592">x</span><span class="op" id="3700593">[</span><span class="num" id="3700594">6</span><span class="op" id="3700595">:</span><span class="num" id="3700596">38</span><span class="op" id="3700598">]</span><span class="op" id="3700599">,</span>&nbsp;<span class="ident" id="3700601">m</span><span class="op" id="3700602">.</span><span class="ident" id="3700603">random</span><span class="op" id="3700609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3700612">x</span><span class="op" id="3700613">[</span><span class="num" id="3700614">38</span><span class="op" id="3700616">]</span>&nbsp;<span class="op" id="3700618">=</span>&nbsp;<span class="builtintype" id="3700620">uint8</span><span class="op" id="3700625">(</span><span class="builtinfunc" id="3700626">len</span><span class="op" id="3700629">(</span><span class="ident" id="3700630">m</span><span class="op" id="3700631">.</span><span class="ident" id="3700632">sessionId</span><span class="op" id="3700641">)</span><span class="op" id="3700642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3700645">copy</span><span class="op" id="3700649">(</span><span class="ident" id="3700650">x</span><span class="op" id="3700651">[</span><span class="num" id="3700652">39</span><span class="op" id="3700654">:</span><span class="num" id="3700655">39</span><span class="op" id="3700657">+</span><span class="builtinfunc" id="3700658">len</span><span class="op" id="3700661">(</span><span class="ident" id="3700662">m</span><span class="op" id="3700663">.</span><span class="ident" id="3700664">sessionId</span><span class="op" id="3700673">)</span><span class="op" id="3700674">]</span><span class="op" id="3700675">,</span>&nbsp;<span class="ident" id="3700677">m</span><span class="op" id="3700678">.</span><span class="ident" id="3700679">sessionId</span><span class="op" id="3700688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3700691">z</span>&nbsp;<span class="op" id="3700693">:=</span>&nbsp;<span class="ident" id="3700696">x</span><span class="op" id="3700697">[</span><span class="num" id="3700698">39</span><span class="op" id="3700700">+</span><span class="builtinfunc" id="3700701">len</span><span class="op" id="3700704">(</span><span class="ident" id="3700705">m</span><span class="op" id="3700706">.</span><span class="ident" id="3700707">sessionId</span><span class="op" id="3700716">)</span><span class="op" id="3700717">:</span><span class="op" id="3700718">]</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3700721">z</span><span class="op" id="3700722">[</span><span class="num" id="3700723">0</span><span class="op" id="3700724">]</span>&nbsp;<span class="op" id="3700726">=</span>&nbsp;<span class="builtintype" id="3700728">uint8</span><span class="op" id="3700733">(</span><span class="ident" id="3700734">m</span><span class="op" id="3700735">.</span><span class="ident" id="3700736">cipherSuite</span>&nbsp;<span class="op" id="3700748">&gt;&gt;</span>&nbsp;<span class="num" id="3700751">8</span><span class="op" id="3700752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3700755">z</span><span class="op" id="3700756">[</span><span class="num" id="3700757">1</span><span class="op" id="3700758">]</span>&nbsp;<span class="op" id="3700760">=</span>&nbsp;<span class="builtintype" id="3700762">uint8</span><span class="op" id="3700767">(</span><span class="ident" id="3700768">m</span><span class="op" id="3700769">.</span><span class="ident" id="3700770">cipherSuite</span><span class="op" id="3700781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3700784">z</span><span class="op" id="3700785">[</span><span class="num" id="3700786">2</span><span class="op" id="3700787">]</span>&nbsp;<span class="op" id="3700789">=</span>&nbsp;<span class="builtintype" id="3700791">uint8</span><span class="op" id="3700796">(</span><span class="ident" id="3700797">m</span><span class="op" id="3700798">.</span><span class="ident" id="3700799">compressionMethod</span><span class="op" id="3700816">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3700820">z</span>&nbsp;<span class="op" id="3700822">=</span>&nbsp;<span class="ident" id="3700824">z</span><span class="op" id="3700825">[</span><span class="num" id="3700826">3</span><span class="op" id="3700827">:</span><span class="op" id="3700828">]</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3700831">if</span>&nbsp;<span class="ident" id="3700834">numExtensions</span>&nbsp;<span class="op" id="3700848">&gt;</span>&nbsp;<span class="num" id="3700850">0</span>&nbsp;<span class="op" id="3700852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3700856">z</span><span class="op" id="3700857">[</span><span class="num" id="3700858">0</span><span class="op" id="3700859">]</span>&nbsp;<span class="op" id="3700861">=</span>&nbsp;<span class="builtintype" id="3700863">byte</span><span class="op" id="3700867">(</span><span class="ident" id="3700868">extensionsLength</span>&nbsp;<span class="op" id="3700885">&gt;&gt;</span>&nbsp;<span class="num" id="3700888">8</span><span class="op" id="3700889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3700893">z</span><span class="op" id="3700894">[</span><span class="num" id="3700895">1</span><span class="op" id="3700896">]</span>&nbsp;<span class="op" id="3700898">=</span>&nbsp;<span class="builtintype" id="3700900">byte</span><span class="op" id="3700904">(</span><span class="ident" id="3700905">extensionsLength</span><span class="op" id="3700921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3700925">z</span>&nbsp;<span class="op" id="3700927">=</span>&nbsp;<span class="ident" id="3700929">z</span><span class="op" id="3700930">[</span><span class="num" id="3700931">2</span><span class="op" id="3700932">:</span><span class="op" id="3700933">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3700936">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3700939">if</span>&nbsp;<span class="ident" id="3700942">m</span><span class="op" id="3700943">.</span><span class="ident" id="3700944">nextProtoNeg</span>&nbsp;<span class="op" id="3700957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3700961">z</span><span class="op" id="3700962">[</span><span class="num" id="3700963">0</span><span class="op" id="3700964">]</span>&nbsp;<span class="op" id="3700966">=</span>&nbsp;<span class="builtintype" id="3700968">byte</span><span class="op" id="3700972">(</span><span class="ident" id="3700973">extensionNextProtoNeg</span>&nbsp;<span class="op" id="3700995">&gt;&gt;</span>&nbsp;<span class="num" id="3700998">8</span><span class="op" id="3700999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701003">z</span><span class="op" id="3701004">[</span><span class="num" id="3701005">1</span><span class="op" id="3701006">]</span>&nbsp;<span class="op" id="3701008">=</span>&nbsp;<span class="builtintype" id="3701010">byte</span><span class="op" id="3701014">(</span><span class="ident" id="3701015">extensionNextProtoNeg</span>&nbsp;<span class="op" id="3701037">&amp;</span>&nbsp;<span class="num" id="3701039">0xff</span><span class="op" id="3701043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701047">z</span><span class="op" id="3701048">[</span><span class="num" id="3701049">2</span><span class="op" id="3701050">]</span>&nbsp;<span class="op" id="3701052">=</span>&nbsp;<span class="builtintype" id="3701054">byte</span><span class="op" id="3701058">(</span><span class="ident" id="3701059">nextProtoLen</span>&nbsp;<span class="op" id="3701072">&gt;&gt;</span>&nbsp;<span class="num" id="3701075">8</span><span class="op" id="3701076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701080">z</span><span class="op" id="3701081">[</span><span class="num" id="3701082">3</span><span class="op" id="3701083">]</span>&nbsp;<span class="op" id="3701085">=</span>&nbsp;<span class="builtintype" id="3701087">byte</span><span class="op" id="3701091">(</span><span class="ident" id="3701092">nextProtoLen</span><span class="op" id="3701104">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701108">z</span>&nbsp;<span class="op" id="3701110">=</span>&nbsp;<span class="ident" id="3701112">z</span><span class="op" id="3701113">[</span><span class="num" id="3701114">4</span><span class="op" id="3701115">:</span><span class="op" id="3701116">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3701121">for</span>&nbsp;<span class="ident" id="3701125">_</span><span class="op" id="3701126">,</span>&nbsp;<span class="ident" id="3701128">v</span>&nbsp;<span class="op" id="3701130">:=</span>&nbsp;<span class="keyword" id="3701133">range</span>&nbsp;<span class="ident" id="3701139">m</span><span class="op" id="3701140">.</span><span class="ident" id="3701141">nextProtos</span>&nbsp;<span class="op" id="3701152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701157">l</span>&nbsp;<span class="op" id="3701159">:=</span>&nbsp;<span class="builtinfunc" id="3701162">len</span><span class="op" id="3701165">(</span><span class="ident" id="3701166">v</span><span class="op" id="3701167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3701172">if</span>&nbsp;<span class="ident" id="3701175">l</span>&nbsp;<span class="op" id="3701177">&gt;</span>&nbsp;<span class="num" id="3701179">255</span>&nbsp;<span class="op" id="3701183">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701189">l</span>&nbsp;<span class="op" id="3701191">=</span>&nbsp;<span class="num" id="3701193">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3701200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701205">z</span><span class="op" id="3701206">[</span><span class="num" id="3701207">0</span><span class="op" id="3701208">]</span>&nbsp;<span class="op" id="3701210">=</span>&nbsp;<span class="builtintype" id="3701212">byte</span><span class="op" id="3701216">(</span><span class="ident" id="3701217">l</span><span class="op" id="3701218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3701223">copy</span><span class="op" id="3701227">(</span><span class="ident" id="3701228">z</span><span class="op" id="3701229">[</span><span class="num" id="3701230">1</span><span class="op" id="3701231">:</span><span class="op" id="3701232">]</span><span class="op" id="3701233">,</span>&nbsp;<span class="op" id="3701235">[</span><span class="op" id="3701236">]</span><span class="builtintype" id="3701237">byte</span><span class="op" id="3701241">(</span><span class="ident" id="3701242">v</span><span class="op" id="3701243">[</span><span class="num" id="3701244">0</span><span class="op" id="3701245">:</span><span class="ident" id="3701246">l</span><span class="op" id="3701247">]</span><span class="op" id="3701248">)</span><span class="op" id="3701249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701254">z</span>&nbsp;<span class="op" id="3701256">=</span>&nbsp;<span class="ident" id="3701258">z</span><span class="op" id="3701259">[</span><span class="num" id="3701260">1</span><span class="op" id="3701261">+</span><span class="ident" id="3701262">l</span><span class="op" id="3701263">:</span><span class="op" id="3701264">]</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3701268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3701271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3701274">if</span>&nbsp;<span class="ident" id="3701277">m</span><span class="op" id="3701278">.</span><span class="ident" id="3701279">ocspStapling</span>&nbsp;<span class="op" id="3701292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701296">z</span><span class="op" id="3701297">[</span><span class="num" id="3701298">0</span><span class="op" id="3701299">]</span>&nbsp;<span class="op" id="3701301">=</span>&nbsp;<span class="builtintype" id="3701303">byte</span><span class="op" id="3701307">(</span><span class="ident" id="3701308">extensionStatusRequest</span>&nbsp;<span class="op" id="3701331">&gt;&gt;</span>&nbsp;<span class="num" id="3701334">8</span><span class="op" id="3701335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701339">z</span><span class="op" id="3701340">[</span><span class="num" id="3701341">1</span><span class="op" id="3701342">]</span>&nbsp;<span class="op" id="3701344">=</span>&nbsp;<span class="builtintype" id="3701346">byte</span><span class="op" id="3701350">(</span><span class="ident" id="3701351">extensionStatusRequest</span><span class="op" id="3701373">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701377">z</span>&nbsp;<span class="op" id="3701379">=</span>&nbsp;<span class="ident" id="3701381">z</span><span class="op" id="3701382">[</span><span class="num" id="3701383">4</span><span class="op" id="3701384">:</span><span class="op" id="3701385">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3701388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3701391">if</span>&nbsp;<span class="ident" id="3701394">m</span><span class="op" id="3701395">.</span><span class="ident" id="3701396">ticketSupported</span>&nbsp;<span class="op" id="3701412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701416">z</span><span class="op" id="3701417">[</span><span class="num" id="3701418">0</span><span class="op" id="3701419">]</span>&nbsp;<span class="op" id="3701421">=</span>&nbsp;<span class="builtintype" id="3701423">byte</span><span class="op" id="3701427">(</span><span class="ident" id="3701428">extensionSessionTicket</span>&nbsp;<span class="op" id="3701451">&gt;&gt;</span>&nbsp;<span class="num" id="3701454">8</span><span class="op" id="3701455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701459">z</span><span class="op" id="3701460">[</span><span class="num" id="3701461">1</span><span class="op" id="3701462">]</span>&nbsp;<span class="op" id="3701464">=</span>&nbsp;<span class="builtintype" id="3701466">byte</span><span class="op" id="3701470">(</span><span class="ident" id="3701471">extensionSessionTicket</span><span class="op" id="3701493">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701497">z</span>&nbsp;<span class="op" id="3701499">=</span>&nbsp;<span class="ident" id="3701501">z</span><span class="op" id="3701502">[</span><span class="num" id="3701503">4</span><span class="op" id="3701504">:</span><span class="op" id="3701505">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3701508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3701511">if</span>&nbsp;<span class="ident" id="3701514">m</span><span class="op" id="3701515">.</span><span class="ident" id="3701516">secureRenegotiation</span>&nbsp;<span class="op" id="3701536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701540">z</span><span class="op" id="3701541">[</span><span class="num" id="3701542">0</span><span class="op" id="3701543">]</span>&nbsp;<span class="op" id="3701545">=</span>&nbsp;<span class="builtintype" id="3701547">byte</span><span class="op" id="3701551">(</span><span class="ident" id="3701552">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="3701579">&gt;&gt;</span>&nbsp;<span class="num" id="3701582">8</span><span class="op" id="3701583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701587">z</span><span class="op" id="3701588">[</span><span class="num" id="3701589">1</span><span class="op" id="3701590">]</span>&nbsp;<span class="op" id="3701592">=</span>&nbsp;<span class="builtintype" id="3701594">byte</span><span class="op" id="3701598">(</span><span class="ident" id="3701599">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="3701626">&amp;</span>&nbsp;<span class="num" id="3701628">0xff</span><span class="op" id="3701632">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701636">z</span><span class="op" id="3701637">[</span><span class="num" id="3701638">2</span><span class="op" id="3701639">]</span>&nbsp;<span class="op" id="3701641">=</span>&nbsp;<span class="num" id="3701643">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701647">z</span><span class="op" id="3701648">[</span><span class="num" id="3701649">3</span><span class="op" id="3701650">]</span>&nbsp;<span class="op" id="3701652">=</span>&nbsp;<span class="num" id="3701654">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701658">z</span>&nbsp;<span class="op" id="3701660">=</span>&nbsp;<span class="ident" id="3701662">z</span><span class="op" id="3701663">[</span><span class="num" id="3701664">5</span><span class="op" id="3701665">:</span><span class="op" id="3701666">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3701669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3701672">if</span>&nbsp;<span class="ident" id="3701675">alpnLen</span>&nbsp;<span class="op" id="3701683">:=</span>&nbsp;<span class="builtinfunc" id="3701686">len</span><span class="op" id="3701689">(</span><span class="ident" id="3701690">m</span><span class="op" id="3701691">.</span><span class="ident" id="3701692">alpnProtocol</span><span class="op" id="3701704">)</span><span class="op" id="3701705">;</span>&nbsp;<span class="ident" id="3701707">alpnLen</span>&nbsp;<span class="op" id="3701715">&gt;</span>&nbsp;<span class="num" id="3701717">0</span>&nbsp;<span class="op" id="3701719">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701723">z</span><span class="op" id="3701724">[</span><span class="num" id="3701725">0</span><span class="op" id="3701726">]</span>&nbsp;<span class="op" id="3701728">=</span>&nbsp;<span class="builtintype" id="3701730">byte</span><span class="op" id="3701734">(</span><span class="ident" id="3701735">extensionALPN</span>&nbsp;<span class="op" id="3701749">&gt;&gt;</span>&nbsp;<span class="num" id="3701752">8</span><span class="op" id="3701753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701757">z</span><span class="op" id="3701758">[</span><span class="num" id="3701759">1</span><span class="op" id="3701760">]</span>&nbsp;<span class="op" id="3701762">=</span>&nbsp;<span class="builtintype" id="3701764">byte</span><span class="op" id="3701768">(</span><span class="ident" id="3701769">extensionALPN</span>&nbsp;<span class="op" id="3701783">&amp;</span>&nbsp;<span class="num" id="3701785">0xff</span><span class="op" id="3701789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701793">l</span>&nbsp;<span class="op" id="3701795">:=</span>&nbsp;<span class="num" id="3701798">2</span>&nbsp;<span class="op" id="3701800">+</span>&nbsp;<span class="num" id="3701802">1</span>&nbsp;<span class="op" id="3701804">+</span>&nbsp;<span class="ident" id="3701806">alpnLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701816">z</span><span class="op" id="3701817">[</span><span class="num" id="3701818">2</span><span class="op" id="3701819">]</span>&nbsp;<span class="op" id="3701821">=</span>&nbsp;<span class="builtintype" id="3701823">byte</span><span class="op" id="3701827">(</span><span class="ident" id="3701828">l</span>&nbsp;<span class="op" id="3701830">&gt;&gt;</span>&nbsp;<span class="num" id="3701833">8</span><span class="op" id="3701834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701838">z</span><span class="op" id="3701839">[</span><span class="num" id="3701840">3</span><span class="op" id="3701841">]</span>&nbsp;<span class="op" id="3701843">=</span>&nbsp;<span class="builtintype" id="3701845">byte</span><span class="op" id="3701849">(</span><span class="ident" id="3701850">l</span><span class="op" id="3701851">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701855">l</span>&nbsp;<span class="op" id="3701857">-=</span>&nbsp;<span class="num" id="3701860">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701864">z</span><span class="op" id="3701865">[</span><span class="num" id="3701866">4</span><span class="op" id="3701867">]</span>&nbsp;<span class="op" id="3701869">=</span>&nbsp;<span class="builtintype" id="3701871">byte</span><span class="op" id="3701875">(</span><span class="ident" id="3701876">l</span>&nbsp;<span class="op" id="3701878">&gt;&gt;</span>&nbsp;<span class="num" id="3701881">8</span><span class="op" id="3701882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701886">z</span><span class="op" id="3701887">[</span><span class="num" id="3701888">5</span><span class="op" id="3701889">]</span>&nbsp;<span class="op" id="3701891">=</span>&nbsp;<span class="builtintype" id="3701893">byte</span><span class="op" id="3701897">(</span><span class="ident" id="3701898">l</span><span class="op" id="3701899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701903">l</span>&nbsp;<span class="op" id="3701905">-=</span>&nbsp;<span class="num" id="3701908">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701912">z</span><span class="op" id="3701913">[</span><span class="num" id="3701914">6</span><span class="op" id="3701915">]</span>&nbsp;<span class="op" id="3701917">=</span>&nbsp;<span class="builtintype" id="3701919">byte</span><span class="op" id="3701923">(</span><span class="ident" id="3701924">l</span><span class="op" id="3701925">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3701929">copy</span><span class="op" id="3701933">(</span><span class="ident" id="3701934">z</span><span class="op" id="3701935">[</span><span class="num" id="3701936">7</span><span class="op" id="3701937">:</span><span class="op" id="3701938">]</span><span class="op" id="3701939">,</span>&nbsp;<span class="op" id="3701941">[</span><span class="op" id="3701942">]</span><span class="builtintype" id="3701943">byte</span><span class="op" id="3701947">(</span><span class="ident" id="3701948">m</span><span class="op" id="3701949">.</span><span class="ident" id="3701950">alpnProtocol</span><span class="op" id="3701962">)</span><span class="op" id="3701963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701967">z</span>&nbsp;<span class="op" id="3701969">=</span>&nbsp;<span class="ident" id="3701971">z</span><span class="op" id="3701972">[</span><span class="num" id="3701973">7</span><span class="op" id="3701974">+</span><span class="ident" id="3701975">alpnLen</span><span class="op" id="3701982">:</span><span class="op" id="3701983">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3701986">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3701990">m</span><span class="op" id="3701991">.</span><span class="ident" id="3701992">raw</span>&nbsp;<span class="op" id="3701996">=</span>&nbsp;<span class="ident" id="3701998">x</span><br>
<span class="lineno">610</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702002">return</span>&nbsp;<span class="ident" id="3702009">x</span><br>
<span class="lineno"></span><span class="op" id="3702011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3702014">func</span>&nbsp;<span class="op" id="3702019">(</span><span class="ident" id="3702020">m</span>&nbsp;<span class="op" id="3702022">*</span><span class="ident" id="3702023">serverHelloMsg</span><span class="op" id="3702037">)</span>&nbsp;<span class="ident" id="3702039">unmarshal</span><span class="op" id="3702048">(</span><span class="ident" id="3702049">data</span>&nbsp;<span class="op" id="3702054">[</span><span class="op" id="3702055">]</span><span class="builtintype" id="3702056">byte</span><span class="op" id="3702060">)</span>&nbsp;<span class="builtintype" id="3702062">bool</span>&nbsp;<span class="op" id="3702067">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702070">if</span>&nbsp;<span class="builtinfunc" id="3702073">len</span><span class="op" id="3702076">(</span><span class="ident" id="3702077">data</span><span class="op" id="3702081">)</span>&nbsp;<span class="op" id="3702083">&lt;</span>&nbsp;<span class="num" id="3702085">42</span>&nbsp;<span class="op" id="3702088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702092">return</span>&nbsp;<span class="builtintype" id="3702099">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3702106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702109">m</span><span class="op" id="3702110">.</span><span class="ident" id="3702111">raw</span>&nbsp;<span class="op" id="3702115">=</span>&nbsp;<span class="ident" id="3702117">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702123">m</span><span class="op" id="3702124">.</span><span class="ident" id="3702125">vers</span>&nbsp;<span class="op" id="3702130">=</span>&nbsp;<span class="builtintype" id="3702132">uint16</span><span class="op" id="3702138">(</span><span class="ident" id="3702139">data</span><span class="op" id="3702143">[</span><span class="num" id="3702144">4</span><span class="op" id="3702145">]</span><span class="op" id="3702146">)</span><span class="op" id="3702147">&lt;&lt;</span><span class="num" id="3702149">8</span>&nbsp;<span class="op" id="3702151">|</span>&nbsp;<span class="builtintype" id="3702153">uint16</span><span class="op" id="3702159">(</span><span class="ident" id="3702160">data</span><span class="op" id="3702164">[</span><span class="num" id="3702165">5</span><span class="op" id="3702166">]</span><span class="op" id="3702167">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702170">m</span><span class="op" id="3702171">.</span><span class="ident" id="3702172">random</span>&nbsp;<span class="op" id="3702179">=</span>&nbsp;<span class="ident" id="3702181">data</span><span class="op" id="3702185">[</span><span class="num" id="3702186">6</span><span class="op" id="3702187">:</span><span class="num" id="3702188">38</span><span class="op" id="3702190">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702193">sessionIdLen</span>&nbsp;<span class="op" id="3702206">:=</span>&nbsp;<span class="builtintype" id="3702209">int</span><span class="op" id="3702212">(</span><span class="ident" id="3702213">data</span><span class="op" id="3702217">[</span><span class="num" id="3702218">38</span><span class="op" id="3702220">]</span><span class="op" id="3702221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702224">if</span>&nbsp;<span class="ident" id="3702227">sessionIdLen</span>&nbsp;<span class="op" id="3702240">&gt;</span>&nbsp;<span class="num" id="3702242">32</span>&nbsp;<span class="op" id="3702245">||</span>&nbsp;<span class="builtinfunc" id="3702248">len</span><span class="op" id="3702251">(</span><span class="ident" id="3702252">data</span><span class="op" id="3702256">)</span>&nbsp;<span class="op" id="3702258">&lt;</span>&nbsp;<span class="num" id="3702260">39</span><span class="op" id="3702262">+</span><span class="ident" id="3702263">sessionIdLen</span>&nbsp;<span class="op" id="3702276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702280">return</span>&nbsp;<span class="builtintype" id="3702287">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3702294">}</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702297">m</span><span class="op" id="3702298">.</span><span class="ident" id="3702299">sessionId</span>&nbsp;<span class="op" id="3702309">=</span>&nbsp;<span class="ident" id="3702311">data</span><span class="op" id="3702315">[</span><span class="num" id="3702316">39</span>&nbsp;<span class="op" id="3702319">:</span>&nbsp;<span class="num" id="3702321">39</span><span class="op" id="3702323">+</span><span class="ident" id="3702324">sessionIdLen</span><span class="op" id="3702336">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702339">data</span>&nbsp;<span class="op" id="3702344">=</span>&nbsp;<span class="ident" id="3702346">data</span><span class="op" id="3702350">[</span><span class="num" id="3702351">39</span><span class="op" id="3702353">+</span><span class="ident" id="3702354">sessionIdLen</span><span class="op" id="3702366">:</span><span class="op" id="3702367">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702370">if</span>&nbsp;<span class="builtinfunc" id="3702373">len</span><span class="op" id="3702376">(</span><span class="ident" id="3702377">data</span><span class="op" id="3702381">)</span>&nbsp;<span class="op" id="3702383">&lt;</span>&nbsp;<span class="num" id="3702385">3</span>&nbsp;<span class="op" id="3702387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702391">return</span>&nbsp;<span class="builtintype" id="3702398">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3702405">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702408">m</span><span class="op" id="3702409">.</span><span class="ident" id="3702410">cipherSuite</span>&nbsp;<span class="op" id="3702422">=</span>&nbsp;<span class="builtintype" id="3702424">uint16</span><span class="op" id="3702430">(</span><span class="ident" id="3702431">data</span><span class="op" id="3702435">[</span><span class="num" id="3702436">0</span><span class="op" id="3702437">]</span><span class="op" id="3702438">)</span><span class="op" id="3702439">&lt;&lt;</span><span class="num" id="3702441">8</span>&nbsp;<span class="op" id="3702443">|</span>&nbsp;<span class="builtintype" id="3702445">uint16</span><span class="op" id="3702451">(</span><span class="ident" id="3702452">data</span><span class="op" id="3702456">[</span><span class="num" id="3702457">1</span><span class="op" id="3702458">]</span><span class="op" id="3702459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702462">m</span><span class="op" id="3702463">.</span><span class="ident" id="3702464">compressionMethod</span>&nbsp;<span class="op" id="3702482">=</span>&nbsp;<span class="ident" id="3702484">data</span><span class="op" id="3702488">[</span><span class="num" id="3702489">2</span><span class="op" id="3702490">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702493">data</span>&nbsp;<span class="op" id="3702498">=</span>&nbsp;<span class="ident" id="3702500">data</span><span class="op" id="3702504">[</span><span class="num" id="3702505">3</span><span class="op" id="3702506">:</span><span class="op" id="3702507">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702511">m</span><span class="op" id="3702512">.</span><span class="ident" id="3702513">nextProtoNeg</span>&nbsp;<span class="op" id="3702526">=</span>&nbsp;<span class="builtintype" id="3702528">false</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702535">m</span><span class="op" id="3702536">.</span><span class="ident" id="3702537">nextProtos</span>&nbsp;<span class="op" id="3702548">=</span>&nbsp;<span class="ident" id="3702550">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702555">m</span><span class="op" id="3702556">.</span><span class="ident" id="3702557">ocspStapling</span>&nbsp;<span class="op" id="3702570">=</span>&nbsp;<span class="builtintype" id="3702572">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702579">m</span><span class="op" id="3702580">.</span><span class="ident" id="3702581">ticketSupported</span>&nbsp;<span class="op" id="3702597">=</span>&nbsp;<span class="builtintype" id="3702599">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702606">m</span><span class="op" id="3702607">.</span><span class="ident" id="3702608">alpnProtocol</span>&nbsp;<span class="op" id="3702621">=</span>&nbsp;<span class="string" id="3702623">&#34;&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702628">if</span>&nbsp;<span class="builtinfunc" id="3702631">len</span><span class="op" id="3702634">(</span><span class="ident" id="3702635">data</span><span class="op" id="3702639">)</span>&nbsp;<span class="op" id="3702641">==</span>&nbsp;<span class="num" id="3702644">0</span>&nbsp;<span class="op" id="3702646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3702650">//&nbsp;ServerHello&nbsp;is&nbsp;optionally&nbsp;followed&nbsp;by&nbsp;extension&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702708">return</span>&nbsp;<span class="builtintype" id="3702715">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3702721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702724">if</span>&nbsp;<span class="builtinfunc" id="3702727">len</span><span class="op" id="3702730">(</span><span class="ident" id="3702731">data</span><span class="op" id="3702735">)</span>&nbsp;<span class="op" id="3702737">&lt;</span>&nbsp;<span class="num" id="3702739">2</span>&nbsp;<span class="op" id="3702741">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702745">return</span>&nbsp;<span class="builtintype" id="3702752">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3702759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702763">extensionsLength</span>&nbsp;<span class="op" id="3702780">:=</span>&nbsp;<span class="builtintype" id="3702783">int</span><span class="op" id="3702786">(</span><span class="ident" id="3702787">data</span><span class="op" id="3702791">[</span><span class="num" id="3702792">0</span><span class="op" id="3702793">]</span><span class="op" id="3702794">)</span><span class="op" id="3702795">&lt;&lt;</span><span class="num" id="3702797">8</span>&nbsp;<span class="op" id="3702799">|</span>&nbsp;<span class="builtintype" id="3702801">int</span><span class="op" id="3702804">(</span><span class="ident" id="3702805">data</span><span class="op" id="3702809">[</span><span class="num" id="3702810">1</span><span class="op" id="3702811">]</span><span class="op" id="3702812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702815">data</span>&nbsp;<span class="op" id="3702820">=</span>&nbsp;<span class="ident" id="3702822">data</span><span class="op" id="3702826">[</span><span class="num" id="3702827">2</span><span class="op" id="3702828">:</span><span class="op" id="3702829">]</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702832">if</span>&nbsp;<span class="builtinfunc" id="3702835">len</span><span class="op" id="3702838">(</span><span class="ident" id="3702839">data</span><span class="op" id="3702843">)</span>&nbsp;<span class="op" id="3702845">!=</span>&nbsp;<span class="ident" id="3702848">extensionsLength</span>&nbsp;<span class="op" id="3702865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702869">return</span>&nbsp;<span class="builtintype" id="3702876">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3702883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702887">for</span>&nbsp;<span class="builtinfunc" id="3702891">len</span><span class="op" id="3702894">(</span><span class="ident" id="3702895">data</span><span class="op" id="3702899">)</span>&nbsp;<span class="op" id="3702901">!=</span>&nbsp;<span class="num" id="3702904">0</span>&nbsp;<span class="op" id="3702906">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702910">if</span>&nbsp;<span class="builtinfunc" id="3702913">len</span><span class="op" id="3702916">(</span><span class="ident" id="3702917">data</span><span class="op" id="3702921">)</span>&nbsp;<span class="op" id="3702923">&lt;</span>&nbsp;<span class="num" id="3702925">4</span>&nbsp;<span class="op" id="3702927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3702932">return</span>&nbsp;<span class="builtintype" id="3702939">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3702947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3702951">extension</span>&nbsp;<span class="op" id="3702961">:=</span>&nbsp;<span class="builtintype" id="3702964">uint16</span><span class="op" id="3702970">(</span><span class="ident" id="3702971">data</span><span class="op" id="3702975">[</span><span class="num" id="3702976">0</span><span class="op" id="3702977">]</span><span class="op" id="3702978">)</span><span class="op" id="3702979">&lt;&lt;</span><span class="num" id="3702981">8</span>&nbsp;<span class="op" id="3702983">|</span>&nbsp;<span class="builtintype" id="3702985">uint16</span><span class="op" id="3702991">(</span><span class="ident" id="3702992">data</span><span class="op" id="3702996">[</span><span class="num" id="3702997">1</span><span class="op" id="3702998">]</span><span class="op" id="3702999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703003">length</span>&nbsp;<span class="op" id="3703010">:=</span>&nbsp;<span class="builtintype" id="3703013">int</span><span class="op" id="3703016">(</span><span class="ident" id="3703017">data</span><span class="op" id="3703021">[</span><span class="num" id="3703022">2</span><span class="op" id="3703023">]</span><span class="op" id="3703024">)</span><span class="op" id="3703025">&lt;&lt;</span><span class="num" id="3703027">8</span>&nbsp;<span class="op" id="3703029">|</span>&nbsp;<span class="builtintype" id="3703031">int</span><span class="op" id="3703034">(</span><span class="ident" id="3703035">data</span><span class="op" id="3703039">[</span><span class="num" id="3703040">3</span><span class="op" id="3703041">]</span><span class="op" id="3703042">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703046">data</span>&nbsp;<span class="op" id="3703051">=</span>&nbsp;<span class="ident" id="3703053">data</span><span class="op" id="3703057">[</span><span class="num" id="3703058">4</span><span class="op" id="3703059">:</span><span class="op" id="3703060">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703064">if</span>&nbsp;<span class="builtinfunc" id="3703067">len</span><span class="op" id="3703070">(</span><span class="ident" id="3703071">data</span><span class="op" id="3703075">)</span>&nbsp;<span class="op" id="3703077">&lt;</span>&nbsp;<span class="ident" id="3703079">length</span>&nbsp;<span class="op" id="3703086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703091">return</span>&nbsp;<span class="builtintype" id="3703098">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3703106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703111">switch</span>&nbsp;<span class="ident" id="3703118">extension</span>&nbsp;<span class="op" id="3703128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703132">case</span>&nbsp;<span class="ident" id="3703137">extensionNextProtoNeg</span><span class="op" id="3703158">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703163">m</span><span class="op" id="3703164">.</span><span class="ident" id="3703165">nextProtoNeg</span>&nbsp;<span class="op" id="3703178">=</span>&nbsp;<span class="builtintype" id="3703180">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703188">d</span>&nbsp;<span class="op" id="3703190">:=</span>&nbsp;<span class="ident" id="3703193">data</span><span class="op" id="3703197">[</span><span class="op" id="3703198">:</span><span class="ident" id="3703199">length</span><span class="op" id="3703205">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703210">for</span>&nbsp;<span class="builtinfunc" id="3703214">len</span><span class="op" id="3703217">(</span><span class="ident" id="3703218">d</span><span class="op" id="3703219">)</span>&nbsp;<span class="op" id="3703221">&gt;</span>&nbsp;<span class="num" id="3703223">0</span>&nbsp;<span class="op" id="3703225">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703231">l</span>&nbsp;<span class="op" id="3703233">:=</span>&nbsp;<span class="builtintype" id="3703236">int</span><span class="op" id="3703239">(</span><span class="ident" id="3703240">d</span><span class="op" id="3703241">[</span><span class="num" id="3703242">0</span><span class="op" id="3703243">]</span><span class="op" id="3703244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703250">d</span>&nbsp;<span class="op" id="3703252">=</span>&nbsp;<span class="ident" id="3703254">d</span><span class="op" id="3703255">[</span><span class="num" id="3703256">1</span><span class="op" id="3703257">:</span><span class="op" id="3703258">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703264">if</span>&nbsp;<span class="ident" id="3703267">l</span>&nbsp;<span class="op" id="3703269">==</span>&nbsp;<span class="num" id="3703272">0</span>&nbsp;<span class="op" id="3703274">||</span>&nbsp;<span class="ident" id="3703277">l</span>&nbsp;<span class="op" id="3703279">&gt;</span>&nbsp;<span class="builtinfunc" id="3703281">len</span><span class="op" id="3703284">(</span><span class="ident" id="3703285">d</span><span class="op" id="3703286">)</span>&nbsp;<span class="op" id="3703288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703295">return</span>&nbsp;<span class="builtintype" id="3703302">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3703312">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703318">m</span><span class="op" id="3703319">.</span><span class="ident" id="3703320">nextProtos</span>&nbsp;<span class="op" id="3703331">=</span>&nbsp;<span class="builtinfunc" id="3703333">append</span><span class="op" id="3703339">(</span><span class="ident" id="3703340">m</span><span class="op" id="3703341">.</span><span class="ident" id="3703342">nextProtos</span><span class="op" id="3703352">,</span>&nbsp;<span class="builtintype" id="3703354">string</span><span class="op" id="3703360">(</span><span class="ident" id="3703361">d</span><span class="op" id="3703362">[</span><span class="op" id="3703363">:</span><span class="ident" id="3703364">l</span><span class="op" id="3703365">]</span><span class="op" id="3703366">)</span><span class="op" id="3703367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703373">d</span>&nbsp;<span class="op" id="3703375">=</span>&nbsp;<span class="ident" id="3703377">d</span><span class="op" id="3703378">[</span><span class="ident" id="3703379">l</span><span class="op" id="3703380">:</span><span class="op" id="3703381">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3703386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703390">case</span>&nbsp;<span class="ident" id="3703395">extensionStatusRequest</span><span class="op" id="3703417">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703422">if</span>&nbsp;<span class="ident" id="3703425">length</span>&nbsp;<span class="op" id="3703432">&gt;</span>&nbsp;<span class="num" id="3703434">0</span>&nbsp;<span class="op" id="3703436">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703442">return</span>&nbsp;<span class="builtintype" id="3703449">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3703458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703463">m</span><span class="op" id="3703464">.</span><span class="ident" id="3703465">ocspStapling</span>&nbsp;<span class="op" id="3703478">=</span>&nbsp;<span class="builtintype" id="3703480">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703487">case</span>&nbsp;<span class="ident" id="3703492">extensionSessionTicket</span><span class="op" id="3703514">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703519">if</span>&nbsp;<span class="ident" id="3703522">length</span>&nbsp;<span class="op" id="3703529">&gt;</span>&nbsp;<span class="num" id="3703531">0</span>&nbsp;<span class="op" id="3703533">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703539">return</span>&nbsp;<span class="builtintype" id="3703546">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3703555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703560">m</span><span class="op" id="3703561">.</span><span class="ident" id="3703562">ticketSupported</span>&nbsp;<span class="op" id="3703578">=</span>&nbsp;<span class="builtintype" id="3703580">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703587">case</span>&nbsp;<span class="ident" id="3703592">extensionRenegotiationInfo</span><span class="op" id="3703618">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703623">if</span>&nbsp;<span class="ident" id="3703626">length</span>&nbsp;<span class="op" id="3703633">!=</span>&nbsp;<span class="num" id="3703636">1</span>&nbsp;<span class="op" id="3703638">||</span>&nbsp;<span class="ident" id="3703641">data</span><span class="op" id="3703645">[</span><span class="num" id="3703646">0</span><span class="op" id="3703647">]</span>&nbsp;<span class="op" id="3703649">!=</span>&nbsp;<span class="num" id="3703652">0</span>&nbsp;<span class="op" id="3703654">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703660">return</span>&nbsp;<span class="builtintype" id="3703667">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3703676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703681">m</span><span class="op" id="3703682">.</span><span class="ident" id="3703683">secureRenegotiation</span>&nbsp;<span class="op" id="3703703">=</span>&nbsp;<span class="builtintype" id="3703705">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703712">case</span>&nbsp;<span class="ident" id="3703717">extensionALPN</span><span class="op" id="3703730">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703735">d</span>&nbsp;<span class="op" id="3703737">:=</span>&nbsp;<span class="ident" id="3703740">data</span><span class="op" id="3703744">[</span><span class="op" id="3703745">:</span><span class="ident" id="3703746">length</span><span class="op" id="3703752">]</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703757">if</span>&nbsp;<span class="builtinfunc" id="3703760">len</span><span class="op" id="3703763">(</span><span class="ident" id="3703764">d</span><span class="op" id="3703765">)</span>&nbsp;<span class="op" id="3703767">&lt;</span>&nbsp;<span class="num" id="3703769">3</span>&nbsp;<span class="op" id="3703771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703777">return</span>&nbsp;<span class="builtintype" id="3703784">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3703793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703798">l</span>&nbsp;<span class="op" id="3703800">:=</span>&nbsp;<span class="builtintype" id="3703803">int</span><span class="op" id="3703806">(</span><span class="ident" id="3703807">d</span><span class="op" id="3703808">[</span><span class="num" id="3703809">0</span><span class="op" id="3703810">]</span><span class="op" id="3703811">)</span><span class="op" id="3703812">&lt;&lt;</span><span class="num" id="3703814">8</span>&nbsp;<span class="op" id="3703816">|</span>&nbsp;<span class="builtintype" id="3703818">int</span><span class="op" id="3703821">(</span><span class="ident" id="3703822">d</span><span class="op" id="3703823">[</span><span class="num" id="3703824">1</span><span class="op" id="3703825">]</span><span class="op" id="3703826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703831">if</span>&nbsp;<span class="ident" id="3703834">l</span>&nbsp;<span class="op" id="3703836">!=</span>&nbsp;<span class="builtinfunc" id="3703839">len</span><span class="op" id="3703842">(</span><span class="ident" id="3703843">d</span><span class="op" id="3703844">)</span><span class="op" id="3703845">-</span><span class="num" id="3703846">2</span>&nbsp;<span class="op" id="3703848">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703854">return</span>&nbsp;<span class="builtintype" id="3703861">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3703870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703875">d</span>&nbsp;<span class="op" id="3703877">=</span>&nbsp;<span class="ident" id="3703879">d</span><span class="op" id="3703880">[</span><span class="num" id="3703881">2</span><span class="op" id="3703882">:</span><span class="op" id="3703883">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703888">l</span>&nbsp;<span class="op" id="3703890">=</span>&nbsp;<span class="builtintype" id="3703892">int</span><span class="op" id="3703895">(</span><span class="ident" id="3703896">d</span><span class="op" id="3703897">[</span><span class="num" id="3703898">0</span><span class="op" id="3703899">]</span><span class="op" id="3703900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703905">if</span>&nbsp;<span class="ident" id="3703908">l</span>&nbsp;<span class="op" id="3703910">!=</span>&nbsp;<span class="builtinfunc" id="3703913">len</span><span class="op" id="3703916">(</span><span class="ident" id="3703917">d</span><span class="op" id="3703918">)</span><span class="op" id="3703919">-</span><span class="num" id="3703920">1</span>&nbsp;<span class="op" id="3703922">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3703928">return</span>&nbsp;<span class="builtintype" id="3703935">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3703944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703949">d</span>&nbsp;<span class="op" id="3703951">=</span>&nbsp;<span class="ident" id="3703953">d</span><span class="op" id="3703954">[</span><span class="num" id="3703955">1</span><span class="op" id="3703956">:</span><span class="op" id="3703957">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703962">m</span><span class="op" id="3703963">.</span><span class="ident" id="3703964">alpnProtocol</span>&nbsp;<span class="op" id="3703977">=</span>&nbsp;<span class="builtintype" id="3703979">string</span><span class="op" id="3703985">(</span><span class="ident" id="3703986">d</span><span class="op" id="3703987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3703991">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3703995">data</span>&nbsp;<span class="op" id="3704000">=</span>&nbsp;<span class="ident" id="3704002">data</span><span class="op" id="3704006">[</span><span class="ident" id="3704007">length</span><span class="op" id="3704013">:</span><span class="op" id="3704014">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3704017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3704021">return</span>&nbsp;<span class="builtintype" id="3704028">true</span><br>
<span class="lineno"></span><span class="op" id="3704033">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="3704036">type</span>&nbsp;<span class="ident" id="3704041">certificateMsg</span>&nbsp;<span class="keyword" id="3704056">struct</span>&nbsp;<span class="op" id="3704063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704066">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3704079">[</span><span class="op" id="3704080">]</span><span class="builtintype" id="3704081">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704087">certificates</span>&nbsp;<span class="op" id="3704100">[</span><span class="op" id="3704101">]</span><span class="op" id="3704102">[</span><span class="op" id="3704103">]</span><span class="builtintype" id="3704104">byte</span><br>
<span class="lineno"></span><span class="op" id="3704109">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="3704112">func</span>&nbsp;<span class="op" id="3704117">(</span><span class="ident" id="3704118">m</span>&nbsp;<span class="op" id="3704120">*</span><span class="ident" id="3704121">certificateMsg</span><span class="op" id="3704135">)</span>&nbsp;<span class="ident" id="3704137">equal</span><span class="op" id="3704142">(</span><span class="ident" id="3704143">i</span>&nbsp;<span class="keyword" id="3704145">interface</span><span class="op" id="3704154">{</span><span class="op" id="3704155">}</span><span class="op" id="3704156">)</span>&nbsp;<span class="builtintype" id="3704158">bool</span>&nbsp;<span class="op" id="3704163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704166">m1</span><span class="op" id="3704168">,</span>&nbsp;<span class="ident" id="3704170">ok</span>&nbsp;<span class="op" id="3704173">:=</span>&nbsp;<span class="ident" id="3704176">i</span><span class="op" id="3704177">.</span><span class="op" id="3704178">(</span><span class="op" id="3704179">*</span><span class="ident" id="3704180">certificateMsg</span><span class="op" id="3704194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3704197">if</span>&nbsp;<span class="op" id="3704200">!</span><span class="ident" id="3704201">ok</span>&nbsp;<span class="op" id="3704204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3704208">return</span>&nbsp;<span class="builtintype" id="3704215">false</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3704222">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3704226">return</span>&nbsp;<span class="ident" id="3704233">bytes</span><span class="op" id="3704238">.</span><span class="ident" id="3704239">Equal</span><span class="op" id="3704244">(</span><span class="ident" id="3704245">m</span><span class="op" id="3704246">.</span><span class="ident" id="3704247">raw</span><span class="op" id="3704250">,</span>&nbsp;<span class="ident" id="3704252">m1</span><span class="op" id="3704254">.</span><span class="ident" id="3704255">raw</span><span class="op" id="3704258">)</span>&nbsp;<span class="op" id="3704260">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704265">eqByteSlices</span><span class="op" id="3704277">(</span><span class="ident" id="3704278">m</span><span class="op" id="3704279">.</span><span class="ident" id="3704280">certificates</span><span class="op" id="3704292">,</span>&nbsp;<span class="ident" id="3704294">m1</span><span class="op" id="3704296">.</span><span class="ident" id="3704297">certificates</span><span class="op" id="3704309">)</span><br>
<span class="lineno"></span><span class="op" id="3704311">}</span><br>
<span class="lineno">730</span><br>
<span class="lineno"></span><span class="keyword" id="3704314">func</span>&nbsp;<span class="op" id="3704319">(</span><span class="ident" id="3704320">m</span>&nbsp;<span class="op" id="3704322">*</span><span class="ident" id="3704323">certificateMsg</span><span class="op" id="3704337">)</span>&nbsp;<span class="ident" id="3704339">marshal</span><span class="op" id="3704346">(</span><span class="op" id="3704347">)</span>&nbsp;<span class="op" id="3704349">(</span><span class="ident" id="3704350">x</span>&nbsp;<span class="op" id="3704352">[</span><span class="op" id="3704353">]</span><span class="builtintype" id="3704354">byte</span><span class="op" id="3704358">)</span>&nbsp;<span class="op" id="3704360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3704363">if</span>&nbsp;<span class="ident" id="3704366">m</span><span class="op" id="3704367">.</span><span class="ident" id="3704368">raw</span>&nbsp;<span class="op" id="3704372">!=</span>&nbsp;<span class="ident" id="3704375">nil</span>&nbsp;<span class="op" id="3704379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3704383">return</span>&nbsp;<span class="ident" id="3704390">m</span><span class="op" id="3704391">.</span><span class="ident" id="3704392">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3704397">}</span><br>
<span class="lineno">735</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3704401">var</span>&nbsp;<span class="ident" id="3704405">i</span>&nbsp;<span class="builtintype" id="3704407">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3704412">for</span>&nbsp;<span class="ident" id="3704416">_</span><span class="op" id="3704417">,</span>&nbsp;<span class="ident" id="3704419">slice</span>&nbsp;<span class="op" id="3704425">:=</span>&nbsp;<span class="keyword" id="3704428">range</span>&nbsp;<span class="ident" id="3704434">m</span><span class="op" id="3704435">.</span><span class="ident" id="3704436">certificates</span>&nbsp;<span class="op" id="3704449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704453">i</span>&nbsp;<span class="op" id="3704455">+=</span>&nbsp;<span class="builtinfunc" id="3704458">len</span><span class="op" id="3704461">(</span><span class="ident" id="3704462">slice</span><span class="op" id="3704467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3704470">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704474">length</span>&nbsp;<span class="op" id="3704481">:=</span>&nbsp;<span class="num" id="3704484">3</span>&nbsp;<span class="op" id="3704486">+</span>&nbsp;<span class="num" id="3704488">3</span><span class="op" id="3704489">*</span><span class="builtinfunc" id="3704490">len</span><span class="op" id="3704493">(</span><span class="ident" id="3704494">m</span><span class="op" id="3704495">.</span><span class="ident" id="3704496">certificates</span><span class="op" id="3704508">)</span>&nbsp;<span class="op" id="3704510">+</span>&nbsp;<span class="ident" id="3704512">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704515">x</span>&nbsp;<span class="op" id="3704517">=</span>&nbsp;<span class="builtinfunc" id="3704519">make</span><span class="op" id="3704523">(</span><span class="op" id="3704524">[</span><span class="op" id="3704525">]</span><span class="builtintype" id="3704526">byte</span><span class="op" id="3704530">,</span>&nbsp;<span class="num" id="3704532">4</span><span class="op" id="3704533">+</span><span class="ident" id="3704534">length</span><span class="op" id="3704540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704543">x</span><span class="op" id="3704544">[</span><span class="num" id="3704545">0</span><span class="op" id="3704546">]</span>&nbsp;<span class="op" id="3704548">=</span>&nbsp;<span class="ident" id="3704550">typeCertificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704567">x</span><span class="op" id="3704568">[</span><span class="num" id="3704569">1</span><span class="op" id="3704570">]</span>&nbsp;<span class="op" id="3704572">=</span>&nbsp;<span class="builtintype" id="3704574">uint8</span><span class="op" id="3704579">(</span><span class="ident" id="3704580">length</span>&nbsp;<span class="op" id="3704587">&gt;&gt;</span>&nbsp;<span class="num" id="3704590">16</span><span class="op" id="3704592">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704595">x</span><span class="op" id="3704596">[</span><span class="num" id="3704597">2</span><span class="op" id="3704598">]</span>&nbsp;<span class="op" id="3704600">=</span>&nbsp;<span class="builtintype" id="3704602">uint8</span><span class="op" id="3704607">(</span><span class="ident" id="3704608">length</span>&nbsp;<span class="op" id="3704615">&gt;&gt;</span>&nbsp;<span class="num" id="3704618">8</span><span class="op" id="3704619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704622">x</span><span class="op" id="3704623">[</span><span class="num" id="3704624">3</span><span class="op" id="3704625">]</span>&nbsp;<span class="op" id="3704627">=</span>&nbsp;<span class="builtintype" id="3704629">uint8</span><span class="op" id="3704634">(</span><span class="ident" id="3704635">length</span><span class="op" id="3704641">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704645">certificateOctets</span>&nbsp;<span class="op" id="3704663">:=</span>&nbsp;<span class="ident" id="3704666">length</span>&nbsp;<span class="op" id="3704673">-</span>&nbsp;<span class="num" id="3704675">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704678">x</span><span class="op" id="3704679">[</span><span class="num" id="3704680">4</span><span class="op" id="3704681">]</span>&nbsp;<span class="op" id="3704683">=</span>&nbsp;<span class="builtintype" id="3704685">uint8</span><span class="op" id="3704690">(</span><span class="ident" id="3704691">certificateOctets</span>&nbsp;<span class="op" id="3704709">&gt;&gt;</span>&nbsp;<span class="num" id="3704712">16</span><span class="op" id="3704714">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704717">x</span><span class="op" id="3704718">[</span><span class="num" id="3704719">5</span><span class="op" id="3704720">]</span>&nbsp;<span class="op" id="3704722">=</span>&nbsp;<span class="builtintype" id="3704724">uint8</span><span class="op" id="3704729">(</span><span class="ident" id="3704730">certificateOctets</span>&nbsp;<span class="op" id="3704748">&gt;&gt;</span>&nbsp;<span class="num" id="3704751">8</span><span class="op" id="3704752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704755">x</span><span class="op" id="3704756">[</span><span class="num" id="3704757">6</span><span class="op" id="3704758">]</span>&nbsp;<span class="op" id="3704760">=</span>&nbsp;<span class="builtintype" id="3704762">uint8</span><span class="op" id="3704767">(</span><span class="ident" id="3704768">certificateOctets</span><span class="op" id="3704785">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704789">y</span>&nbsp;<span class="op" id="3704791">:=</span>&nbsp;<span class="ident" id="3704794">x</span><span class="op" id="3704795">[</span><span class="num" id="3704796">7</span><span class="op" id="3704797">:</span><span class="op" id="3704798">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3704801">for</span>&nbsp;<span class="ident" id="3704805">_</span><span class="op" id="3704806">,</span>&nbsp;<span class="ident" id="3704808">slice</span>&nbsp;<span class="op" id="3704814">:=</span>&nbsp;<span class="keyword" id="3704817">range</span>&nbsp;<span class="ident" id="3704823">m</span><span class="op" id="3704824">.</span><span class="ident" id="3704825">certificates</span>&nbsp;<span class="op" id="3704838">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704842">y</span><span class="op" id="3704843">[</span><span class="num" id="3704844">0</span><span class="op" id="3704845">]</span>&nbsp;<span class="op" id="3704847">=</span>&nbsp;<span class="builtintype" id="3704849">uint8</span><span class="op" id="3704854">(</span><span class="builtinfunc" id="3704855">len</span><span class="op" id="3704858">(</span><span class="ident" id="3704859">slice</span><span class="op" id="3704864">)</span>&nbsp;<span class="op" id="3704866">&gt;&gt;</span>&nbsp;<span class="num" id="3704869">16</span><span class="op" id="3704871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704875">y</span><span class="op" id="3704876">[</span><span class="num" id="3704877">1</span><span class="op" id="3704878">]</span>&nbsp;<span class="op" id="3704880">=</span>&nbsp;<span class="builtintype" id="3704882">uint8</span><span class="op" id="3704887">(</span><span class="builtinfunc" id="3704888">len</span><span class="op" id="3704891">(</span><span class="ident" id="3704892">slice</span><span class="op" id="3704897">)</span>&nbsp;<span class="op" id="3704899">&gt;&gt;</span>&nbsp;<span class="num" id="3704902">8</span><span class="op" id="3704903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704907">y</span><span class="op" id="3704908">[</span><span class="num" id="3704909">2</span><span class="op" id="3704910">]</span>&nbsp;<span class="op" id="3704912">=</span>&nbsp;<span class="builtintype" id="3704914">uint8</span><span class="op" id="3704919">(</span><span class="builtinfunc" id="3704920">len</span><span class="op" id="3704923">(</span><span class="ident" id="3704924">slice</span><span class="op" id="3704929">)</span><span class="op" id="3704930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3704934">copy</span><span class="op" id="3704938">(</span><span class="ident" id="3704939">y</span><span class="op" id="3704940">[</span><span class="num" id="3704941">3</span><span class="op" id="3704942">:</span><span class="op" id="3704943">]</span><span class="op" id="3704944">,</span>&nbsp;<span class="ident" id="3704946">slice</span><span class="op" id="3704951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704955">y</span>&nbsp;<span class="op" id="3704957">=</span>&nbsp;<span class="ident" id="3704959">y</span><span class="op" id="3704960">[</span><span class="num" id="3704961">3</span><span class="op" id="3704962">+</span><span class="builtinfunc" id="3704963">len</span><span class="op" id="3704966">(</span><span class="ident" id="3704967">slice</span><span class="op" id="3704972">)</span><span class="op" id="3704973">:</span><span class="op" id="3704974">]</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3704977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3704981">m</span><span class="op" id="3704982">.</span><span class="ident" id="3704983">raw</span>&nbsp;<span class="op" id="3704987">=</span>&nbsp;<span class="ident" id="3704989">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3704992">return</span><br>
<span class="lineno"></span><span class="op" id="3704999">}</span><br>
<span class="lineno">765</span><br>
<span class="lineno"></span><span class="keyword" id="3705002">func</span>&nbsp;<span class="op" id="3705007">(</span><span class="ident" id="3705008">m</span>&nbsp;<span class="op" id="3705010">*</span><span class="ident" id="3705011">certificateMsg</span><span class="op" id="3705025">)</span>&nbsp;<span class="ident" id="3705027">unmarshal</span><span class="op" id="3705036">(</span><span class="ident" id="3705037">data</span>&nbsp;<span class="op" id="3705042">[</span><span class="op" id="3705043">]</span><span class="builtintype" id="3705044">byte</span><span class="op" id="3705048">)</span>&nbsp;<span class="builtintype" id="3705050">bool</span>&nbsp;<span class="op" id="3705055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3705058">if</span>&nbsp;<span class="builtinfunc" id="3705061">len</span><span class="op" id="3705064">(</span><span class="ident" id="3705065">data</span><span class="op" id="3705069">)</span>&nbsp;<span class="op" id="3705071">&lt;</span>&nbsp;<span class="num" id="3705073">7</span>&nbsp;<span class="op" id="3705075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3705079">return</span>&nbsp;<span class="builtintype" id="3705086">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3705093">}</span><br>
<span class="lineno">770</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3705097">m</span><span class="op" id="3705098">.</span><span class="ident" id="3705099">raw</span>&nbsp;<span class="op" id="3705103">=</span>&nbsp;<span class="ident" id="3705105">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3705111">certsLen</span>&nbsp;<span class="op" id="3705120">:=</span>&nbsp;<span class="builtintype" id="3705123">uint32</span><span class="op" id="3705129">(</span><span class="ident" id="3705130">data</span><span class="op" id="3705134">[</span><span class="num" id="3705135">4</span><span class="op" id="3705136">]</span><span class="op" id="3705137">)</span><span class="op" id="3705138">&lt;&lt;</span><span class="num" id="3705140">16</span>&nbsp;<span class="op" id="3705143">|</span>&nbsp;<span class="builtintype" id="3705145">uint32</span><span class="op" id="3705151">(</span><span class="ident" id="3705152">data</span><span class="op" id="3705156">[</span><span class="num" id="3705157">5</span><span class="op" id="3705158">]</span><span class="op" id="3705159">)</span><span class="op" id="3705160">&lt;&lt;</span><span class="num" id="3705162">8</span>&nbsp;<span class="op" id="3705164">|</span>&nbsp;<span class="builtintype" id="3705166">uint32</span><span class="op" id="3705172">(</span><span class="ident" id="3705173">data</span><span class="op" id="3705177">[</span><span class="num" id="3705178">6</span><span class="op" id="3705179">]</span><span class="op" id="3705180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3705183">if</span>&nbsp;<span class="builtintype" id="3705186">uint32</span><span class="op" id="3705192">(</span><span class="builtinfunc" id="3705193">len</span><span class="op" id="3705196">(</span><span class="ident" id="3705197">data</span><span class="op" id="3705201">)</span><span class="op" id="3705202">)</span>&nbsp;<span class="op" id="3705204">!=</span>&nbsp;<span class="ident" id="3705207">certsLen</span><span class="op" id="3705215">+</span><span class="num" id="3705216">7</span>&nbsp;<span class="op" id="3705218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3705222">return</span>&nbsp;<span class="builtintype" id="3705229">false</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3705236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3705240">numCerts</span>&nbsp;<span class="op" id="3705249">:=</span>&nbsp;<span class="num" id="3705252">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3705255">d</span>&nbsp;<span class="op" id="3705257">:=</span>&nbsp;<span class="ident" id="3705260">data</span><span class="op" id="3705264">[</span><span class="num" id="3705265">7</span><span class="op" id="3705266">:</span><span class="op" id="3705267">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3705270">for</span>&nbsp;<span class="ident" id="3705274">certsLen</span>&nbsp;<span class="op" id="3705283">&gt;</span>&nbsp;<span class="num" id="3705285">0</span>&nbsp;<span class="op" id="3705287">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3705291">if</span>&nbsp;<span class="builtinfunc" id="3705294">len</span><span class="op" id="3705297">(</span><span class="ident" id="3705298">d</span><span class="op" id="3705299">)</span>&nbsp;<span class="op" id="3705301">&lt;</span>&nbsp;<span class="num" id="3705303">4</span>&nbsp;<span class="op" id="3705305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3705310">return</span>&nbsp;<span class="builtintype" id="3705317">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3705325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3705329">certLen</span>&nbsp;<span class="op" id="3705337">:=</span>&nbsp;<span class="builtintype" id="3705340">uint32</span><span class="op" id="3705346">(</span><span class="ident" id="3705347">d</span><span class="op" id="3705348">[</span><span class="num" id="3705349">0</span><span class="op" id="3705350">]</span><span class="op" id="3705351">)</span><span class="op" id="3705352">&lt;&lt;</span><span class="num" id="3705354">16</span>&nbsp;<span class="op" id="3705357">|</span>&nbsp;<span class="builtintype" id="3705359">uint32</span><span class="op" id="3705365">(</span><span class="ident" id="3705366">d</span><span class="op" id="3705367">[</span><span class="num" id="3705368">1</span><span class="op" id="3705369">]</span><span class="op" id="3705370">)</span><span class="op" id="3705371">&lt;&lt;</span><span class="num" id="3705373">8</span>&nbsp;<span class="op" id="3705375">|</span>&nbsp;<span class="builtintype" id="3705377">uint32</span><span class="op" id="3705383">(</span><span class="ident" id="3705384">d</span><span class="op" id="3705385">[</span><span class="num" id="3705386">2</span><span class="op" id="3705387">]</span><span class="op" id="3705388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3705392">if</span>&nbsp;<span class="builtintype" id="3705395">uint32</span><span class="op" id="3705401">(</span><span class="builtinfunc" id="3705402">len</span><span class="op" id="3705405">(</span><span class="ident" id="3705406">d</span><span class="op" id="3705407">)</span><span class="op" id="3705408">)</span>&nbsp;<span class="op" id="3705410">&lt;</span>&nbsp;<span class="num" id="3705412">3</span><span class="op" id="3705413">+</span><span class="ident" id="3705414">certLen</span>&nbsp;<span class="op" id="3705422">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3705427">return</span>&nbsp;<span class="builtintype" id="3705434">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3705442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3705446">d</span>&nbsp;<span class="op" id="3705448">=</span>&nbsp;<span class="ident" id="3705450">d</span><span class="op" id="3705451">[</span><span class="num" id="3705452">3</span><span class="op" id="3705453">+</span><span class="ident" id="3705454">certLen</span><span class="op" id="3705461">:</span><span class="op" id="3705462">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3705466">certsLen</span>&nbsp;<span class="op" id="3705475">-=</span>&nbsp;<span class="num" id="3705478">3</span>&nbsp;<span class="op" id="3705480">+</span>&nbsp;<span class="ident" id="3705482">certLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3705492">numCerts</span><span class="op" id="3705500">++</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3705504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3705508">m</span><span class="op" id="3705509">.</span><span class="ident" id="3705510">certificates</span>&nbsp;<span class="op" id="3705523">=</span>&nbsp;<span class="builtinfunc" id="3705525">make</span><span class="op" id="3705529">(</span><span class="op" id="3705530">[</span><span class="op" id="3705531">]</span><span class="op" id="3705532">[</span><span class="op" id="3705533">]</span><span class="builtintype" id="3705534">byte</span><span class="op" id="3705538">,</span>&nbsp;<span class="ident" id="3705540">numCerts</span><span class="op" id="3705548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3705551">d</span>&nbsp;<span class="op" id="3705553">=</span>&nbsp;<span class="ident" id="3705555">data</span><span class="op" id="3705559">[</span><span class="num" id="3705560">7</span><span class="op" id="3705561">:</span><span class="op" id="3705562">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3705565">for</span>&nbsp;<span class="ident" id="3705569">i</span>&nbsp;<span class="op" id="3705571">:=</span>&nbsp;<span class="num" id="3705574">0</span><span class="op" id="3705575">;</span>&nbsp;<span class="ident" id="3705577">i</span>&nbsp;<span class="op" id="3705579">&lt;</span>&nbsp;<span class="ident" id="3705581">numCerts</span><span class="op" id="3705589">;</span>&nbsp;<span class="ident" id="3705591">i</span><span class="op" id="3705592">++</span>&nbsp;<span class="op" id="3705595">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3705599">certLen</span>&nbsp;<span class="op" id="3705607">:=</span>&nbsp;<span class="builtintype" id="3705610">uint32</span><span class="op" id="3705616">(</span><span class="ident" id="3705617">d</span><span class="op" id="3705618">[</span><span class="num" id="3705619">0</span><span class="op" id="3705620">]</span><span class="op" id="3705621">)</span><span class="op" id="3705622">&lt;&lt;</span><span class="num" id="3705624">16</span>&nbsp;<span class="op" id="3705627">|</span>&nbsp;<span class="builtintype" id="3705629">uint32</span><span class="op" id="3705635">(</span><span class="ident" id="3705636">d</span><span class="op" id="3705637">[</span><span class="num" id="3705638">1</span><span class="op" id="3705639">]</span><span class="op" id="3705640">)</span><span class="op" id="3705641">&lt;&lt;</span><span class="num" id="3705643">8</span>&nbsp;<span class="op" id="3705645">|</span>&nbsp;<span class="builtintype" id="3705647">uint32</span><span class="op" id="3705653">(</span><span class="ident" id="3705654">d</span><span class="op" id="3705655">[</span><span class="num" id="3705656">2</span><span class="op" id="3705657">]</span><span class="op" id="3705658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3705662">m</span><span class="op" id="3705663">.</span><span class="ident" id="3705664">certificates</span><span class="op" id="3705676">[</span><span class="ident" id="3705677">i</span><span class="op" id="3705678">]</span>&nbsp;<span class="op" id="3705680">=</span>&nbsp;<span class="ident" id="3705682">d</span><span class="op" id="3705683">[</span><span class="num" id="3705684">3</span>&nbsp;<span class="op" id="3705686">:</span>&nbsp;<span class="num" id="3705688">3</span><span class="op" id="3705689">+</span><span class="ident" id="3705690">certLen</span><span class="op" id="3705697">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3705701">d</span>&nbsp;<span class="op" id="3705703">=</span>&nbsp;<span class="ident" id="3705705">d</span><span class="op" id="3705706">[</span><span class="num" id="3705707">3</span><span class="op" id="3705708">+</span><span class="ident" id="3705709">certLen</span><span class="op" id="3705716">:</span><span class="op" id="3705717">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3705720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3705724">return</span>&nbsp;<span class="builtintype" id="3705731">true</span><br>
<span class="lineno"></span><span class="op" id="3705736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3705739">type</span>&nbsp;<span class="ident" id="3705744">serverKeyExchangeMsg</span>&nbsp;<span class="keyword" id="3705765">struct</span>&nbsp;<span class="op" id="3705772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3705775">raw</span>&nbsp;<span class="op" id="3705779">[</span><span class="op" id="3705780">]</span><span class="builtintype" id="3705781">byte</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3705787">key</span>&nbsp;<span class="op" id="3705791">[</span><span class="op" id="3705792">]</span><span class="builtintype" id="3705793">byte</span><br>
<span class="lineno"></span><span class="op" id="3705798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3705801">func</span>&nbsp;<span class="op" id="3705806">(</span><span class="ident" id="3705807">m</span>&nbsp;<span class="op" id="3705809">*</span><span class="ident" id="3705810">serverKeyExchangeMsg</span><span class="op" id="3705830">)</span>&nbsp;<span class="ident" id="3705832">equal</span><span class="op" id="3705837">(</span><span class="ident" id="3705838">i</span>&nbsp;<span class="keyword" id="3705840">interface</span><span class="op" id="3705849">{</span><span class="op" id="3705850">}</span><span class="op" id="3705851">)</span>&nbsp;<span class="builtintype" id="3705853">bool</span>&nbsp;<span class="op" id="3705858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3705861">m1</span><span class="op" id="3705863">,</span>&nbsp;<span class="ident" id="3705865">ok</span>&nbsp;<span class="op" id="3705868">:=</span>&nbsp;<span class="ident" id="3705871">i</span><span class="op" id="3705872">.</span><span class="op" id="3705873">(</span><span class="op" id="3705874">*</span><span class="ident" id="3705875">serverKeyExchangeMsg</span><span class="op" id="3705895">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3705898">if</span>&nbsp;<span class="op" id="3705901">!</span><span class="ident" id="3705902">ok</span>&nbsp;<span class="op" id="3705905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3705909">return</span>&nbsp;<span class="builtintype" id="3705916">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3705923">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3705927">return</span>&nbsp;<span class="ident" id="3705934">bytes</span><span class="op" id="3705939">.</span><span class="ident" id="3705940">Equal</span><span class="op" id="3705945">(</span><span class="ident" id="3705946">m</span><span class="op" id="3705947">.</span><span class="ident" id="3705948">raw</span><span class="op" id="3705951">,</span>&nbsp;<span class="ident" id="3705953">m1</span><span class="op" id="3705955">.</span><span class="ident" id="3705956">raw</span><span class="op" id="3705959">)</span>&nbsp;<span class="op" id="3705961">&amp;&amp;</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3705966">bytes</span><span class="op" id="3705971">.</span><span class="ident" id="3705972">Equal</span><span class="op" id="3705977">(</span><span class="ident" id="3705978">m</span><span class="op" id="3705979">.</span><span class="ident" id="3705980">key</span><span class="op" id="3705983">,</span>&nbsp;<span class="ident" id="3705985">m1</span><span class="op" id="3705987">.</span><span class="ident" id="3705988">key</span><span class="op" id="3705991">)</span><br>
<span class="lineno"></span><span class="op" id="3705993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3705996">func</span>&nbsp;<span class="op" id="3706001">(</span><span class="ident" id="3706002">m</span>&nbsp;<span class="op" id="3706004">*</span><span class="ident" id="3706005">serverKeyExchangeMsg</span><span class="op" id="3706025">)</span>&nbsp;<span class="ident" id="3706027">marshal</span><span class="op" id="3706034">(</span><span class="op" id="3706035">)</span>&nbsp;<span class="op" id="3706037">[</span><span class="op" id="3706038">]</span><span class="builtintype" id="3706039">byte</span>&nbsp;<span class="op" id="3706044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3706047">if</span>&nbsp;<span class="ident" id="3706050">m</span><span class="op" id="3706051">.</span><span class="ident" id="3706052">raw</span>&nbsp;<span class="op" id="3706056">!=</span>&nbsp;<span class="ident" id="3706059">nil</span>&nbsp;<span class="op" id="3706063">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3706067">return</span>&nbsp;<span class="ident" id="3706074">m</span><span class="op" id="3706075">.</span><span class="ident" id="3706076">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3706081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3706084">length</span>&nbsp;<span class="op" id="3706091">:=</span>&nbsp;<span class="builtinfunc" id="3706094">len</span><span class="op" id="3706097">(</span><span class="ident" id="3706098">m</span><span class="op" id="3706099">.</span><span class="ident" id="3706100">key</span><span class="op" id="3706103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3706106">x</span>&nbsp;<span class="op" id="3706108">:=</span>&nbsp;<span class="builtinfunc" id="3706111">make</span><span class="op" id="3706115">(</span><span class="op" id="3706116">[</span><span class="op" id="3706117">]</span><span class="builtintype" id="3706118">byte</span><span class="op" id="3706122">,</span>&nbsp;<span class="ident" id="3706124">length</span><span class="op" id="3706130">+</span><span class="num" id="3706131">4</span><span class="op" id="3706132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3706135">x</span><span class="op" id="3706136">[</span><span class="num" id="3706137">0</span><span class="op" id="3706138">]</span>&nbsp;<span class="op" id="3706140">=</span>&nbsp;<span class="ident" id="3706142">typeServerKeyExchange</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3706165">x</span><span class="op" id="3706166">[</span><span class="num" id="3706167">1</span><span class="op" id="3706168">]</span>&nbsp;<span class="op" id="3706170">=</span>&nbsp;<span class="builtintype" id="3706172">uint8</span><span class="op" id="3706177">(</span><span class="ident" id="3706178">length</span>&nbsp;<span class="op" id="3706185">&gt;&gt;</span>&nbsp;<span class="num" id="3706188">16</span><span class="op" id="3706190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3706193">x</span><span class="op" id="3706194">[</span><span class="num" id="3706195">2</span><span class="op" id="3706196">]</span>&nbsp;<span class="op" id="3706198">=</span>&nbsp;<span class="builtintype" id="3706200">uint8</span><span class="op" id="3706205">(</span><span class="ident" id="3706206">length</span>&nbsp;<span class="op" id="3706213">&gt;&gt;</span>&nbsp;<span class="num" id="3706216">8</span><span class="op" id="3706217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3706220">x</span><span class="op" id="3706221">[</span><span class="num" id="3706222">3</span><span class="op" id="3706223">]</span>&nbsp;<span class="op" id="3706225">=</span>&nbsp;<span class="builtintype" id="3706227">uint8</span><span class="op" id="3706232">(</span><span class="ident" id="3706233">length</span><span class="op" id="3706239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3706242">copy</span><span class="op" id="3706246">(</span><span class="ident" id="3706247">x</span><span class="op" id="3706248">[</span><span class="num" id="3706249">4</span><span class="op" id="3706250">:</span><span class="op" id="3706251">]</span><span class="op" id="3706252">,</span>&nbsp;<span class="ident" id="3706254">m</span><span class="op" id="3706255">.</span><span class="ident" id="3706256">key</span><span class="op" id="3706259">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3706263">m</span><span class="op" id="3706264">.</span><span class="ident" id="3706265">raw</span>&nbsp;<span class="op" id="3706269">=</span>&nbsp;<span class="ident" id="3706271">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3706274">return</span>&nbsp;<span class="ident" id="3706281">x</span><br>
<span class="lineno"></span><span class="op" id="3706283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3706286">func</span>&nbsp;<span class="op" id="3706291">(</span><span class="ident" id="3706292">m</span>&nbsp;<span class="op" id="3706294">*</span><span class="ident" id="3706295">serverKeyExchangeMsg</span><span class="op" id="3706315">)</span>&nbsp;<span class="ident" id="3706317">unmarshal</span><span class="op" id="3706326">(</span><span class="ident" id="3706327">data</span>&nbsp;<span class="op" id="3706332">[</span><span class="op" id="3706333">]</span><span class="builtintype" id="3706334">byte</span><span class="op" id="3706338">)</span>&nbsp;<span class="builtintype" id="3706340">bool</span>&nbsp;<span class="op" id="3706345">{</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3706348">m</span><span class="op" id="3706349">.</span><span class="ident" id="3706350">raw</span>&nbsp;<span class="op" id="3706354">=</span>&nbsp;<span class="ident" id="3706356">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3706362">if</span>&nbsp;<span class="builtinfunc" id="3706365">len</span><span class="op" id="3706368">(</span><span class="ident" id="3706369">data</span><span class="op" id="3706373">)</span>&nbsp;<span class="op" id="3706375">&lt;</span>&nbsp;<span class="num" id="3706377">4</span>&nbsp;<span class="op" id="3706379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3706383">return</span>&nbsp;<span class="builtintype" id="3706390">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3706397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3706400">m</span><span class="op" id="3706401">.</span><span class="ident" id="3706402">key</span>&nbsp;<span class="op" id="3706406">=</span>&nbsp;<span class="ident" id="3706408">data</span><span class="op" id="3706412">[</span><span class="num" id="3706413">4</span><span class="op" id="3706414">:</span><span class="op" id="3706415">]</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3706418">return</span>&nbsp;<span class="builtintype" id="3706425">true</span><br>
<span class="lineno"></span><span class="op" id="3706430">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3706433">type</span>&nbsp;<span class="ident" id="3706438">certificateStatusMsg</span>&nbsp;<span class="keyword" id="3706459">struct</span>&nbsp;<span class="op" id="3706466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3706469">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3706480">[</span><span class="op" id="3706481">]</span><span class="builtintype" id="3706482">byte</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3706488">statusType</span>&nbsp;<span class="builtintype" id="3706499">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3706506">response</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3706517">[</span><span class="op" id="3706518">]</span><span class="builtintype" id="3706519">byte</span><br>
<span class="lineno"></span><span class="op" id="3706524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3706527">func</span>&nbsp;<span class="op" id="3706532">(</span><span class="ident" id="3706533">m</span>&nbsp;<span class="op" id="3706535">*</span><span class="ident" id="3706536">certificateStatusMsg</span><span class="op" id="3706556">)</span>&nbsp;<span class="ident" id="3706558">equal</span><span class="op" id="3706563">(</span><span class="ident" id="3706564">i</span>&nbsp;<span class="keyword" id="3706566">interface</span><span class="op" id="3706575">{</span><span class="op" id="3706576">}</span><span class="op" id="3706577">)</span>&nbsp;<span class="builtintype" id="3706579">bool</span>&nbsp;<span class="op" id="3706584">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3706587">m1</span><span class="op" id="3706589">,</span>&nbsp;<span class="ident" id="3706591">ok</span>&nbsp;<span class="op" id="3706594">:=</span>&nbsp;<span class="ident" id="3706597">i</span><span class="op" id="3706598">.</span><span class="op" id="3706599">(</span><span class="op" id="3706600">*</span><span class="ident" id="3706601">certificateStatusMsg</span><span class="op" id="3706621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3706624">if</span>&nbsp;<span class="op" id="3706627">!</span><span class="ident" id="3706628">ok</span>&nbsp;<span class="op" id="3706631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3706635">return</span>&nbsp;<span class="builtintype" id="3706642">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3706649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3706653">return</span>&nbsp;<span class="ident" id="3706660">bytes</span><span class="op" id="3706665">.</span><span class="ident" id="3706666">Equal</span><span class="op" id="3706671">(</span><span class="ident" id="3706672">m</span><span class="op" id="3706673">.</span><span class="ident" id="3706674">raw</span><span class="op" id="3706677">,</span>&nbsp;<span class="ident" id="3706679">m1</span><span class="op" id="3706681">.</span><span class="ident" id="3706682">raw</span><span class="op" id="3706685">)</span>&nbsp;<span class="op" id="3706687">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3706692">m</span><span class="op" id="3706693">.</span><span class="ident" id="3706694">statusType</span>&nbsp;<span class="op" id="3706705">==</span>&nbsp;<span class="ident" id="3706708">m1</span><span class="op" id="3706710">.</span><span class="ident" id="3706711">statusType</span>&nbsp;<span class="op" id="3706722">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3706727">bytes</span><span class="op" id="3706732">.</span><span class="ident" id="3706733">Equal</span><span class="op" id="3706738">(</span><span class="ident" id="3706739">m</span><span class="op" id="3706740">.</span><span class="ident" id="3706741">response</span><span class="op" id="3706749">,</span>&nbsp;<span class="ident" id="3706751">m1</span><span class="op" id="3706753">.</span><span class="ident" id="3706754">response</span><span class="op" id="3706762">)</span><br>
<span class="lineno"></span><span class="op" id="3706764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="keyword" id="3706767">func</span>&nbsp;<span class="op" id="3706772">(</span><span class="ident" id="3706773">m</span>&nbsp;<span class="op" id="3706775">*</span><span class="ident" id="3706776">certificateStatusMsg</span><span class="op" id="3706796">)</span>&nbsp;<span class="ident" id="3706798">marshal</span><span class="op" id="3706805">(</span><span class="op" id="3706806">)</span>&nbsp;<span class="op" id="3706808">[</span><span class="op" id="3706809">]</span><span class="builtintype" id="3706810">byte</span>&nbsp;<span class="op" id="3706815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3706818">if</span>&nbsp;<span class="ident" id="3706821">m</span><span class="op" id="3706822">.</span><span class="ident" id="3706823">raw</span>&nbsp;<span class="op" id="3706827">!=</span>&nbsp;<span class="ident" id="3706830">nil</span>&nbsp;<span class="op" id="3706834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3706838">return</span>&nbsp;<span class="ident" id="3706845">m</span><span class="op" id="3706846">.</span><span class="ident" id="3706847">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3706852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3706856">var</span>&nbsp;<span class="ident" id="3706860">x</span>&nbsp;<span class="op" id="3706862">[</span><span class="op" id="3706863">]</span><span class="builtintype" id="3706864">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3706870">if</span>&nbsp;<span class="ident" id="3706873">m</span><span class="op" id="3706874">.</span><span class="ident" id="3706875">statusType</span>&nbsp;<span class="op" id="3706886">==</span>&nbsp;<span class="ident" id="3706889">statusTypeOCSP</span>&nbsp;<span class="op" id="3706904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3706908">x</span>&nbsp;<span class="op" id="3706910">=</span>&nbsp;<span class="builtinfunc" id="3706912">make</span><span class="op" id="3706916">(</span><span class="op" id="3706917">[</span><span class="op" id="3706918">]</span><span class="builtintype" id="3706919">byte</span><span class="op" id="3706923">,</span>&nbsp;<span class="num" id="3706925">4</span><span class="op" id="3706926">+</span><span class="num" id="3706927">4</span><span class="op" id="3706928">+</span><span class="builtinfunc" id="3706929">len</span><span class="op" id="3706932">(</span><span class="ident" id="3706933">m</span><span class="op" id="3706934">.</span><span class="ident" id="3706935">response</span><span class="op" id="3706943">)</span><span class="op" id="3706944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3706948">x</span><span class="op" id="3706949">[</span><span class="num" id="3706950">0</span><span class="op" id="3706951">]</span>&nbsp;<span class="op" id="3706953">=</span>&nbsp;<span class="ident" id="3706955">typeCertificateStatus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3706979">l</span>&nbsp;<span class="op" id="3706981">:=</span>&nbsp;<span class="builtinfunc" id="3706984">len</span><span class="op" id="3706987">(</span><span class="ident" id="3706988">m</span><span class="op" id="3706989">.</span><span class="ident" id="3706990">response</span><span class="op" id="3706998">)</span>&nbsp;<span class="op" id="3707000">+</span>&nbsp;<span class="num" id="3707002">4</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3707006">x</span><span class="op" id="3707007">[</span><span class="num" id="3707008">1</span><span class="op" id="3707009">]</span>&nbsp;<span class="op" id="3707011">=</span>&nbsp;<span class="builtintype" id="3707013">byte</span><span class="op" id="3707017">(</span><span class="ident" id="3707018">l</span>&nbsp;<span class="op" id="3707020">&gt;&gt;</span>&nbsp;<span class="num" id="3707023">16</span><span class="op" id="3707025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3707029">x</span><span class="op" id="3707030">[</span><span class="num" id="3707031">2</span><span class="op" id="3707032">]</span>&nbsp;<span class="op" id="3707034">=</span>&nbsp;<span class="builtintype" id="3707036">byte</span><span class="op" id="3707040">(</span><span class="ident" id="3707041">l</span>&nbsp;<span class="op" id="3707043">&gt;&gt;</span>&nbsp;<span class="num" id="3707046">8</span><span class="op" id="3707047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3707051">x</span><span class="op" id="3707052">[</span><span class="num" id="3707053">3</span><span class="op" id="3707054">]</span>&nbsp;<span class="op" id="3707056">=</span>&nbsp;<span class="builtintype" id="3707058">byte</span><span class="op" id="3707062">(</span><span class="ident" id="3707063">l</span><span class="op" id="3707064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3707068">x</span><span class="op" id="3707069">[</span><span class="num" id="3707070">4</span><span class="op" id="3707071">]</span>&nbsp;<span class="op" id="3707073">=</span>&nbsp;<span class="ident" id="3707075">statusTypeOCSP</span><br>
<span class="lineno"></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3707093">l</span>&nbsp;<span class="op" id="3707095">-=</span>&nbsp;<span class="num" id="3707098">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3707102">x</span><span class="op" id="3707103">[</span><span class="num" id="3707104">5</span><span class="op" id="3707105">]</span>&nbsp;<span class="op" id="3707107">=</span>&nbsp;<span class="builtintype" id="3707109">byte</span><span class="op" id="3707113">(</span><span class="ident" id="3707114">l</span>&nbsp;<span class="op" id="3707116">&gt;&gt;</span>&nbsp;<span class="num" id="3707119">16</span><span class="op" id="3707121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3707125">x</span><span class="op" id="3707126">[</span><span class="num" id="3707127">6</span><span class="op" id="3707128">]</span>&nbsp;<span class="op" id="3707130">=</span>&nbsp;<span class="builtintype" id="3707132">byte</span><span class="op" id="3707136">(</span><span class="ident" id="3707137">l</span>&nbsp;<span class="op" id="3707139">&gt;&gt;</span>&nbsp;<span class="num" id="3707142">8</span><span class="op" id="3707143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3707147">x</span><span class="op" id="3707148">[</span><span class="num" id="3707149">7</span><span class="op" id="3707150">]</span>&nbsp;<span class="op" id="3707152">=</span>&nbsp;<span class="builtintype" id="3707154">byte</span><span class="op" id="3707158">(</span><span class="ident" id="3707159">l</span><span class="op" id="3707160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3707164">copy</span><span class="op" id="3707168">(</span><span class="ident" id="3707169">x</span><span class="op" id="3707170">[</span><span class="num" id="3707171">8</span><span class="op" id="3707172">:</span><span class="op" id="3707173">]</span><span class="op" id="3707174">,</span>&nbsp;<span class="ident" id="3707176">m</span><span class="op" id="3707177">.</span><span class="ident" id="3707178">response</span><span class="op" id="3707186">)</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3707189">}</span>&nbsp;<span class="keyword" id="3707191">else</span>&nbsp;<span class="op" id="3707196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3707200">x</span>&nbsp;<span class="op" id="3707202">=</span>&nbsp;<span class="op" id="3707204">[</span><span class="op" id="3707205">]</span><span class="builtintype" id="3707206">byte</span><span class="op" id="3707210">{</span><span class="ident" id="3707211">typeCertificateStatus</span><span class="op" id="3707232">,</span>&nbsp;<span class="num" id="3707234">0</span><span class="op" id="3707235">,</span>&nbsp;<span class="num" id="3707237">0</span><span class="op" id="3707238">,</span>&nbsp;<span class="num" id="3707240">1</span><span class="op" id="3707241">,</span>&nbsp;<span class="ident" id="3707243">m</span><span class="op" id="3707244">.</span><span class="ident" id="3707245">statusType</span><span class="op" id="3707255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3707258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3707262">m</span><span class="op" id="3707263">.</span><span class="ident" id="3707264">raw</span>&nbsp;<span class="op" id="3707268">=</span>&nbsp;<span class="ident" id="3707270">x</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3707273">return</span>&nbsp;<span class="ident" id="3707280">x</span><br>
<span class="lineno"></span><span class="op" id="3707282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3707285">func</span>&nbsp;<span class="op" id="3707290">(</span><span class="ident" id="3707291">m</span>&nbsp;<span class="op" id="3707293">*</span><span class="ident" id="3707294">certificateStatusMsg</span><span class="op" id="3707314">)</span>&nbsp;<span class="ident" id="3707316">unmarshal</span><span class="op" id="3707325">(</span><span class="ident" id="3707326">data</span>&nbsp;<span class="op" id="3707331">[</span><span class="op" id="3707332">]</span><span class="builtintype" id="3707333">byte</span><span class="op" id="3707337">)</span>&nbsp;<span class="builtintype" id="3707339">bool</span>&nbsp;<span class="op" id="3707344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3707347">m</span><span class="op" id="3707348">.</span><span class="ident" id="3707349">raw</span>&nbsp;<span class="op" id="3707353">=</span>&nbsp;<span class="ident" id="3707355">data</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3707361">if</span>&nbsp;<span class="builtinfunc" id="3707364">len</span><span class="op" id="3707367">(</span><span class="ident" id="3707368">data</span><span class="op" id="3707372">)</span>&nbsp;<span class="op" id="3707374">&lt;</span>&nbsp;<span class="num" id="3707376">5</span>&nbsp;<span class="op" id="3707378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3707382">return</span>&nbsp;<span class="builtintype" id="3707389">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3707396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3707399">m</span><span class="op" id="3707400">.</span><span class="ident" id="3707401">statusType</span>&nbsp;<span class="op" id="3707412">=</span>&nbsp;<span class="ident" id="3707414">data</span><span class="op" id="3707418">[</span><span class="num" id="3707419">4</span><span class="op" id="3707420">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3707424">m</span><span class="op" id="3707425">.</span><span class="ident" id="3707426">response</span>&nbsp;<span class="op" id="3707435">=</span>&nbsp;<span class="ident" id="3707437">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3707442">if</span>&nbsp;<span class="ident" id="3707445">m</span><span class="op" id="3707446">.</span><span class="ident" id="3707447">statusType</span>&nbsp;<span class="op" id="3707458">==</span>&nbsp;<span class="ident" id="3707461">statusTypeOCSP</span>&nbsp;<span class="op" id="3707476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3707480">if</span>&nbsp;<span class="builtinfunc" id="3707483">len</span><span class="op" id="3707486">(</span><span class="ident" id="3707487">data</span><span class="op" id="3707491">)</span>&nbsp;<span class="op" id="3707493">&lt;</span>&nbsp;<span class="num" id="3707495">8</span>&nbsp;<span class="op" id="3707497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3707502">return</span>&nbsp;<span class="builtintype" id="3707509">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3707517">}</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3707521">respLen</span>&nbsp;<span class="op" id="3707529">:=</span>&nbsp;<span class="builtintype" id="3707532">uint32</span><span class="op" id="3707538">(</span><span class="ident" id="3707539">data</span><span class="op" id="3707543">[</span><span class="num" id="3707544">5</span><span class="op" id="3707545">]</span><span class="op" id="3707546">)</span><span class="op" id="3707547">&lt;&lt;</span><span class="num" id="3707549">16</span>&nbsp;<span class="op" id="3707552">|</span>&nbsp;<span class="builtintype" id="3707554">uint32</span><span class="op" id="3707560">(</span><span class="ident" id="3707561">data</span><span class="op" id="3707565">[</span><span class="num" id="3707566">6</span><span class="op" id="3707567">]</span><span class="op" id="3707568">)</span><span class="op" id="3707569">&lt;&lt;</span><span class="num" id="3707571">8</span>&nbsp;<span class="op" id="3707573">|</span>&nbsp;<span class="builtintype" id="3707575">uint32</span><span class="op" id="3707581">(</span><span class="ident" id="3707582">data</span><span class="op" id="3707586">[</span><span class="num" id="3707587">7</span><span class="op" id="3707588">]</span><span class="op" id="3707589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3707593">if</span>&nbsp;<span class="builtintype" id="3707596">uint32</span><span class="op" id="3707602">(</span><span class="builtinfunc" id="3707603">len</span><span class="op" id="3707606">(</span><span class="ident" id="3707607">data</span><span class="op" id="3707611">)</span><span class="op" id="3707612">)</span>&nbsp;<span class="op" id="3707614">!=</span>&nbsp;<span class="num" id="3707617">4</span><span class="op" id="3707618">+</span><span class="num" id="3707619">4</span><span class="op" id="3707620">+</span><span class="ident" id="3707621">respLen</span>&nbsp;<span class="op" id="3707629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3707634">return</span>&nbsp;<span class="builtintype" id="3707641">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3707649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3707653">m</span><span class="op" id="3707654">.</span><span class="ident" id="3707655">response</span>&nbsp;<span class="op" id="3707664">=</span>&nbsp;<span class="ident" id="3707666">data</span><span class="op" id="3707670">[</span><span class="num" id="3707671">8</span><span class="op" id="3707672">:</span><span class="op" id="3707673">]</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3707676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3707679">return</span>&nbsp;<span class="builtintype" id="3707686">true</span><br>
<span class="lineno"></span><span class="op" id="3707691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3707694">type</span>&nbsp;<span class="ident" id="3707699">serverHelloDoneMsg</span>&nbsp;<span class="keyword" id="3707718">struct</span><span class="op" id="3707724">{</span><span class="op" id="3707725">}</span><br>
<span class="lineno">910</span><br>
<span class="lineno"></span><span class="keyword" id="3707728">func</span>&nbsp;<span class="op" id="3707733">(</span><span class="ident" id="3707734">m</span>&nbsp;<span class="op" id="3707736">*</span><span class="ident" id="3707737">serverHelloDoneMsg</span><span class="op" id="3707755">)</span>&nbsp;<span class="ident" id="3707757">equal</span><span class="op" id="3707762">(</span><span class="ident" id="3707763">i</span>&nbsp;<span class="keyword" id="3707765">interface</span><span class="op" id="3707774">{</span><span class="op" id="3707775">}</span><span class="op" id="3707776">)</span>&nbsp;<span class="builtintype" id="3707778">bool</span>&nbsp;<span class="op" id="3707783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3707786">_</span><span class="op" id="3707787">,</span>&nbsp;<span class="ident" id="3707789">ok</span>&nbsp;<span class="op" id="3707792">:=</span>&nbsp;<span class="ident" id="3707795">i</span><span class="op" id="3707796">.</span><span class="op" id="3707797">(</span><span class="op" id="3707798">*</span><span class="ident" id="3707799">serverHelloDoneMsg</span><span class="op" id="3707817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3707820">return</span>&nbsp;<span class="ident" id="3707827">ok</span><br>
<span class="lineno"></span><span class="op" id="3707830">}</span><br>
<span class="lineno">915</span><br>
<span class="lineno"></span><span class="keyword" id="3707833">func</span>&nbsp;<span class="op" id="3707838">(</span><span class="ident" id="3707839">m</span>&nbsp;<span class="op" id="3707841">*</span><span class="ident" id="3707842">serverHelloDoneMsg</span><span class="op" id="3707860">)</span>&nbsp;<span class="ident" id="3707862">marshal</span><span class="op" id="3707869">(</span><span class="op" id="3707870">)</span>&nbsp;<span class="op" id="3707872">[</span><span class="op" id="3707873">]</span><span class="builtintype" id="3707874">byte</span>&nbsp;<span class="op" id="3707879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3707882">x</span>&nbsp;<span class="op" id="3707884">:=</span>&nbsp;<span class="builtinfunc" id="3707887">make</span><span class="op" id="3707891">(</span><span class="op" id="3707892">[</span><span class="op" id="3707893">]</span><span class="builtintype" id="3707894">byte</span><span class="op" id="3707898">,</span>&nbsp;<span class="num" id="3707900">4</span><span class="op" id="3707901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3707904">x</span><span class="op" id="3707905">[</span><span class="num" id="3707906">0</span><span class="op" id="3707907">]</span>&nbsp;<span class="op" id="3707909">=</span>&nbsp;<span class="ident" id="3707911">typeServerHelloDone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3707932">return</span>&nbsp;<span class="ident" id="3707939">x</span><br>
<span class="lineno">920</span><span class="op" id="3707941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3707944">func</span>&nbsp;<span class="op" id="3707949">(</span><span class="ident" id="3707950">m</span>&nbsp;<span class="op" id="3707952">*</span><span class="ident" id="3707953">serverHelloDoneMsg</span><span class="op" id="3707971">)</span>&nbsp;<span class="ident" id="3707973">unmarshal</span><span class="op" id="3707982">(</span><span class="ident" id="3707983">data</span>&nbsp;<span class="op" id="3707988">[</span><span class="op" id="3707989">]</span><span class="builtintype" id="3707990">byte</span><span class="op" id="3707994">)</span>&nbsp;<span class="builtintype" id="3707996">bool</span>&nbsp;<span class="op" id="3708001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3708004">return</span>&nbsp;<span class="builtinfunc" id="3708011">len</span><span class="op" id="3708014">(</span><span class="ident" id="3708015">data</span><span class="op" id="3708019">)</span>&nbsp;<span class="op" id="3708021">==</span>&nbsp;<span class="num" id="3708024">4</span><br>
<span class="lineno"></span><span class="op" id="3708026">}</span><br>
<span class="lineno">925</span><br>
<span class="lineno"></span><span class="keyword" id="3708029">type</span>&nbsp;<span class="ident" id="3708034">clientKeyExchangeMsg</span>&nbsp;<span class="keyword" id="3708055">struct</span>&nbsp;<span class="op" id="3708062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3708065">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3708076">[</span><span class="op" id="3708077">]</span><span class="builtintype" id="3708078">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3708084">ciphertext</span>&nbsp;<span class="op" id="3708095">[</span><span class="op" id="3708096">]</span><span class="builtintype" id="3708097">byte</span><br>
<span class="lineno"></span><span class="op" id="3708102">}</span><br>
<span class="lineno">930</span><br>
<span class="lineno"></span><span class="keyword" id="3708105">func</span>&nbsp;<span class="op" id="3708110">(</span><span class="ident" id="3708111">m</span>&nbsp;<span class="op" id="3708113">*</span><span class="ident" id="3708114">clientKeyExchangeMsg</span><span class="op" id="3708134">)</span>&nbsp;<span class="ident" id="3708136">equal</span><span class="op" id="3708141">(</span><span class="ident" id="3708142">i</span>&nbsp;<span class="keyword" id="3708144">interface</span><span class="op" id="3708153">{</span><span class="op" id="3708154">}</span><span class="op" id="3708155">)</span>&nbsp;<span class="builtintype" id="3708157">bool</span>&nbsp;<span class="op" id="3708162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3708165">m1</span><span class="op" id="3708167">,</span>&nbsp;<span class="ident" id="3708169">ok</span>&nbsp;<span class="op" id="3708172">:=</span>&nbsp;<span class="ident" id="3708175">i</span><span class="op" id="3708176">.</span><span class="op" id="3708177">(</span><span class="op" id="3708178">*</span><span class="ident" id="3708179">clientKeyExchangeMsg</span><span class="op" id="3708199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3708202">if</span>&nbsp;<span class="op" id="3708205">!</span><span class="ident" id="3708206">ok</span>&nbsp;<span class="op" id="3708209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3708213">return</span>&nbsp;<span class="builtintype" id="3708220">false</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3708227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3708231">return</span>&nbsp;<span class="ident" id="3708238">bytes</span><span class="op" id="3708243">.</span><span class="ident" id="3708244">Equal</span><span class="op" id="3708249">(</span><span class="ident" id="3708250">m</span><span class="op" id="3708251">.</span><span class="ident" id="3708252">raw</span><span class="op" id="3708255">,</span>&nbsp;<span class="ident" id="3708257">m1</span><span class="op" id="3708259">.</span><span class="ident" id="3708260">raw</span><span class="op" id="3708263">)</span>&nbsp;<span class="op" id="3708265">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3708270">bytes</span><span class="op" id="3708275">.</span><span class="ident" id="3708276">Equal</span><span class="op" id="3708281">(</span><span class="ident" id="3708282">m</span><span class="op" id="3708283">.</span><span class="ident" id="3708284">ciphertext</span><span class="op" id="3708294">,</span>&nbsp;<span class="ident" id="3708296">m1</span><span class="op" id="3708298">.</span><span class="ident" id="3708299">ciphertext</span><span class="op" id="3708309">)</span><br>
<span class="lineno"></span><span class="op" id="3708311">}</span><br>
<span class="lineno">940</span><br>
<span class="lineno"></span><span class="keyword" id="3708314">func</span>&nbsp;<span class="op" id="3708319">(</span><span class="ident" id="3708320">m</span>&nbsp;<span class="op" id="3708322">*</span><span class="ident" id="3708323">clientKeyExchangeMsg</span><span class="op" id="3708343">)</span>&nbsp;<span class="ident" id="3708345">marshal</span><span class="op" id="3708352">(</span><span class="op" id="3708353">)</span>&nbsp;<span class="op" id="3708355">[</span><span class="op" id="3708356">]</span><span class="builtintype" id="3708357">byte</span>&nbsp;<span class="op" id="3708362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3708365">if</span>&nbsp;<span class="ident" id="3708368">m</span><span class="op" id="3708369">.</span><span class="ident" id="3708370">raw</span>&nbsp;<span class="op" id="3708374">!=</span>&nbsp;<span class="ident" id="3708377">nil</span>&nbsp;<span class="op" id="3708381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3708385">return</span>&nbsp;<span class="ident" id="3708392">m</span><span class="op" id="3708393">.</span><span class="ident" id="3708394">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3708399">}</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3708402">length</span>&nbsp;<span class="op" id="3708409">:=</span>&nbsp;<span class="builtinfunc" id="3708412">len</span><span class="op" id="3708415">(</span><span class="ident" id="3708416">m</span><span class="op" id="3708417">.</span><span class="ident" id="3708418">ciphertext</span><span class="op" id="3708428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3708431">x</span>&nbsp;<span class="op" id="3708433">:=</span>&nbsp;<span class="builtinfunc" id="3708436">make</span><span class="op" id="3708440">(</span><span class="op" id="3708441">[</span><span class="op" id="3708442">]</span><span class="builtintype" id="3708443">byte</span><span class="op" id="3708447">,</span>&nbsp;<span class="ident" id="3708449">length</span><span class="op" id="3708455">+</span><span class="num" id="3708456">4</span><span class="op" id="3708457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3708460">x</span><span class="op" id="3708461">[</span><span class="num" id="3708462">0</span><span class="op" id="3708463">]</span>&nbsp;<span class="op" id="3708465">=</span>&nbsp;<span class="ident" id="3708467">typeClientKeyExchange</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3708490">x</span><span class="op" id="3708491">[</span><span class="num" id="3708492">1</span><span class="op" id="3708493">]</span>&nbsp;<span class="op" id="3708495">=</span>&nbsp;<span class="builtintype" id="3708497">uint8</span><span class="op" id="3708502">(</span><span class="ident" id="3708503">length</span>&nbsp;<span class="op" id="3708510">&gt;&gt;</span>&nbsp;<span class="num" id="3708513">16</span><span class="op" id="3708515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3708518">x</span><span class="op" id="3708519">[</span><span class="num" id="3708520">2</span><span class="op" id="3708521">]</span>&nbsp;<span class="op" id="3708523">=</span>&nbsp;<span class="builtintype" id="3708525">uint8</span><span class="op" id="3708530">(</span><span class="ident" id="3708531">length</span>&nbsp;<span class="op" id="3708538">&gt;&gt;</span>&nbsp;<span class="num" id="3708541">8</span><span class="op" id="3708542">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3708545">x</span><span class="op" id="3708546">[</span><span class="num" id="3708547">3</span><span class="op" id="3708548">]</span>&nbsp;<span class="op" id="3708550">=</span>&nbsp;<span class="builtintype" id="3708552">uint8</span><span class="op" id="3708557">(</span><span class="ident" id="3708558">length</span><span class="op" id="3708564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3708567">copy</span><span class="op" id="3708571">(</span><span class="ident" id="3708572">x</span><span class="op" id="3708573">[</span><span class="num" id="3708574">4</span><span class="op" id="3708575">:</span><span class="op" id="3708576">]</span><span class="op" id="3708577">,</span>&nbsp;<span class="ident" id="3708579">m</span><span class="op" id="3708580">.</span><span class="ident" id="3708581">ciphertext</span><span class="op" id="3708591">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3708595">m</span><span class="op" id="3708596">.</span><span class="ident" id="3708597">raw</span>&nbsp;<span class="op" id="3708601">=</span>&nbsp;<span class="ident" id="3708603">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3708606">return</span>&nbsp;<span class="ident" id="3708613">x</span><br>
<span class="lineno">955</span><span class="op" id="3708615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3708618">func</span>&nbsp;<span class="op" id="3708623">(</span><span class="ident" id="3708624">m</span>&nbsp;<span class="op" id="3708626">*</span><span class="ident" id="3708627">clientKeyExchangeMsg</span><span class="op" id="3708647">)</span>&nbsp;<span class="ident" id="3708649">unmarshal</span><span class="op" id="3708658">(</span><span class="ident" id="3708659">data</span>&nbsp;<span class="op" id="3708664">[</span><span class="op" id="3708665">]</span><span class="builtintype" id="3708666">byte</span><span class="op" id="3708670">)</span>&nbsp;<span class="builtintype" id="3708672">bool</span>&nbsp;<span class="op" id="3708677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3708680">m</span><span class="op" id="3708681">.</span><span class="ident" id="3708682">raw</span>&nbsp;<span class="op" id="3708686">=</span>&nbsp;<span class="ident" id="3708688">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3708694">if</span>&nbsp;<span class="builtinfunc" id="3708697">len</span><span class="op" id="3708700">(</span><span class="ident" id="3708701">data</span><span class="op" id="3708705">)</span>&nbsp;<span class="op" id="3708707">&lt;</span>&nbsp;<span class="num" id="3708709">4</span>&nbsp;<span class="op" id="3708711">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3708715">return</span>&nbsp;<span class="builtintype" id="3708722">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3708729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3708732">l</span>&nbsp;<span class="op" id="3708734">:=</span>&nbsp;<span class="builtintype" id="3708737">int</span><span class="op" id="3708740">(</span><span class="ident" id="3708741">data</span><span class="op" id="3708745">[</span><span class="num" id="3708746">1</span><span class="op" id="3708747">]</span><span class="op" id="3708748">)</span><span class="op" id="3708749">&lt;&lt;</span><span class="num" id="3708751">16</span>&nbsp;<span class="op" id="3708754">|</span>&nbsp;<span class="builtintype" id="3708756">int</span><span class="op" id="3708759">(</span><span class="ident" id="3708760">data</span><span class="op" id="3708764">[</span><span class="num" id="3708765">2</span><span class="op" id="3708766">]</span><span class="op" id="3708767">)</span><span class="op" id="3708768">&lt;&lt;</span><span class="num" id="3708770">8</span>&nbsp;<span class="op" id="3708772">|</span>&nbsp;<span class="builtintype" id="3708774">int</span><span class="op" id="3708777">(</span><span class="ident" id="3708778">data</span><span class="op" id="3708782">[</span><span class="num" id="3708783">3</span><span class="op" id="3708784">]</span><span class="op" id="3708785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3708788">if</span>&nbsp;<span class="ident" id="3708791">l</span>&nbsp;<span class="op" id="3708793">!=</span>&nbsp;<span class="builtinfunc" id="3708796">len</span><span class="op" id="3708799">(</span><span class="ident" id="3708800">data</span><span class="op" id="3708804">)</span><span class="op" id="3708805">-</span><span class="num" id="3708806">4</span>&nbsp;<span class="op" id="3708808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3708812">return</span>&nbsp;<span class="builtintype" id="3708819">false</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3708826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3708829">m</span><span class="op" id="3708830">.</span><span class="ident" id="3708831">ciphertext</span>&nbsp;<span class="op" id="3708842">=</span>&nbsp;<span class="ident" id="3708844">data</span><span class="op" id="3708848">[</span><span class="num" id="3708849">4</span><span class="op" id="3708850">:</span><span class="op" id="3708851">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3708854">return</span>&nbsp;<span class="builtintype" id="3708861">true</span><br>
<span class="lineno"></span><span class="op" id="3708866">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">970</span><span class="keyword" id="3708869">type</span>&nbsp;<span class="ident" id="3708874">finishedMsg</span>&nbsp;<span class="keyword" id="3708886">struct</span>&nbsp;<span class="op" id="3708893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3708896">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3708907">[</span><span class="op" id="3708908">]</span><span class="builtintype" id="3708909">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3708915">verifyData</span>&nbsp;<span class="op" id="3708926">[</span><span class="op" id="3708927">]</span><span class="builtintype" id="3708928">byte</span><br>
<span class="lineno"></span><span class="op" id="3708933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">975</span><span class="keyword" id="3708936">func</span>&nbsp;<span class="op" id="3708941">(</span><span class="ident" id="3708942">m</span>&nbsp;<span class="op" id="3708944">*</span><span class="ident" id="3708945">finishedMsg</span><span class="op" id="3708956">)</span>&nbsp;<span class="ident" id="3708958">equal</span><span class="op" id="3708963">(</span><span class="ident" id="3708964">i</span>&nbsp;<span class="keyword" id="3708966">interface</span><span class="op" id="3708975">{</span><span class="op" id="3708976">}</span><span class="op" id="3708977">)</span>&nbsp;<span class="builtintype" id="3708979">bool</span>&nbsp;<span class="op" id="3708984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3708987">m1</span><span class="op" id="3708989">,</span>&nbsp;<span class="ident" id="3708991">ok</span>&nbsp;<span class="op" id="3708994">:=</span>&nbsp;<span class="ident" id="3708997">i</span><span class="op" id="3708998">.</span><span class="op" id="3708999">(</span><span class="op" id="3709000">*</span><span class="ident" id="3709001">finishedMsg</span><span class="op" id="3709012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3709015">if</span>&nbsp;<span class="op" id="3709018">!</span><span class="ident" id="3709019">ok</span>&nbsp;<span class="op" id="3709022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3709026">return</span>&nbsp;<span class="builtintype" id="3709033">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3709040">}</span><br>
<span class="lineno">980</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3709044">return</span>&nbsp;<span class="ident" id="3709051">bytes</span><span class="op" id="3709056">.</span><span class="ident" id="3709057">Equal</span><span class="op" id="3709062">(</span><span class="ident" id="3709063">m</span><span class="op" id="3709064">.</span><span class="ident" id="3709065">raw</span><span class="op" id="3709068">,</span>&nbsp;<span class="ident" id="3709070">m1</span><span class="op" id="3709072">.</span><span class="ident" id="3709073">raw</span><span class="op" id="3709076">)</span>&nbsp;<span class="op" id="3709078">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3709083">bytes</span><span class="op" id="3709088">.</span><span class="ident" id="3709089">Equal</span><span class="op" id="3709094">(</span><span class="ident" id="3709095">m</span><span class="op" id="3709096">.</span><span class="ident" id="3709097">verifyData</span><span class="op" id="3709107">,</span>&nbsp;<span class="ident" id="3709109">m1</span><span class="op" id="3709111">.</span><span class="ident" id="3709112">verifyData</span><span class="op" id="3709122">)</span><br>
<span class="lineno"></span><span class="op" id="3709124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">985</span><span class="keyword" id="3709127">func</span>&nbsp;<span class="op" id="3709132">(</span><span class="ident" id="3709133">m</span>&nbsp;<span class="op" id="3709135">*</span><span class="ident" id="3709136">finishedMsg</span><span class="op" id="3709147">)</span>&nbsp;<span class="ident" id="3709149">marshal</span><span class="op" id="3709156">(</span><span class="op" id="3709157">)</span>&nbsp;<span class="op" id="3709159">(</span><span class="ident" id="3709160">x</span>&nbsp;<span class="op" id="3709162">[</span><span class="op" id="3709163">]</span><span class="builtintype" id="3709164">byte</span><span class="op" id="3709168">)</span>&nbsp;<span class="op" id="3709170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3709173">if</span>&nbsp;<span class="ident" id="3709176">m</span><span class="op" id="3709177">.</span><span class="ident" id="3709178">raw</span>&nbsp;<span class="op" id="3709182">!=</span>&nbsp;<span class="ident" id="3709185">nil</span>&nbsp;<span class="op" id="3709189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3709193">return</span>&nbsp;<span class="ident" id="3709200">m</span><span class="op" id="3709201">.</span><span class="ident" id="3709202">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3709207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3709211">x</span>&nbsp;<span class="op" id="3709213">=</span>&nbsp;<span class="builtinfunc" id="3709215">make</span><span class="op" id="3709219">(</span><span class="op" id="3709220">[</span><span class="op" id="3709221">]</span><span class="builtintype" id="3709222">byte</span><span class="op" id="3709226">,</span>&nbsp;<span class="num" id="3709228">4</span><span class="op" id="3709229">+</span><span class="builtinfunc" id="3709230">len</span><span class="op" id="3709233">(</span><span class="ident" id="3709234">m</span><span class="op" id="3709235">.</span><span class="ident" id="3709236">verifyData</span><span class="op" id="3709246">)</span><span class="op" id="3709247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3709250">x</span><span class="op" id="3709251">[</span><span class="num" id="3709252">0</span><span class="op" id="3709253">]</span>&nbsp;<span class="op" id="3709255">=</span>&nbsp;<span class="ident" id="3709257">typeFinished</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3709271">x</span><span class="op" id="3709272">[</span><span class="num" id="3709273">3</span><span class="op" id="3709274">]</span>&nbsp;<span class="op" id="3709276">=</span>&nbsp;<span class="builtintype" id="3709278">byte</span><span class="op" id="3709282">(</span><span class="builtinfunc" id="3709283">len</span><span class="op" id="3709286">(</span><span class="ident" id="3709287">m</span><span class="op" id="3709288">.</span><span class="ident" id="3709289">verifyData</span><span class="op" id="3709299">)</span><span class="op" id="3709300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3709303">copy</span><span class="op" id="3709307">(</span><span class="ident" id="3709308">x</span><span class="op" id="3709309">[</span><span class="num" id="3709310">4</span><span class="op" id="3709311">:</span><span class="op" id="3709312">]</span><span class="op" id="3709313">,</span>&nbsp;<span class="ident" id="3709315">m</span><span class="op" id="3709316">.</span><span class="ident" id="3709317">verifyData</span><span class="op" id="3709327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3709330">m</span><span class="op" id="3709331">.</span><span class="ident" id="3709332">raw</span>&nbsp;<span class="op" id="3709336">=</span>&nbsp;<span class="ident" id="3709338">x</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3709341">return</span><br>
<span class="lineno"></span><span class="op" id="3709348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3709351">func</span>&nbsp;<span class="op" id="3709356">(</span><span class="ident" id="3709357">m</span>&nbsp;<span class="op" id="3709359">*</span><span class="ident" id="3709360">finishedMsg</span><span class="op" id="3709371">)</span>&nbsp;<span class="ident" id="3709373">unmarshal</span><span class="op" id="3709382">(</span><span class="ident" id="3709383">data</span>&nbsp;<span class="op" id="3709388">[</span><span class="op" id="3709389">]</span><span class="builtintype" id="3709390">byte</span><span class="op" id="3709394">)</span>&nbsp;<span class="builtintype" id="3709396">bool</span>&nbsp;<span class="op" id="3709401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3709404">m</span><span class="op" id="3709405">.</span><span class="ident" id="3709406">raw</span>&nbsp;<span class="op" id="3709410">=</span>&nbsp;<span class="ident" id="3709412">data</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3709418">if</span>&nbsp;<span class="builtinfunc" id="3709421">len</span><span class="op" id="3709424">(</span><span class="ident" id="3709425">data</span><span class="op" id="3709429">)</span>&nbsp;<span class="op" id="3709431">&lt;</span>&nbsp;<span class="num" id="3709433">4</span>&nbsp;<span class="op" id="3709435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3709439">return</span>&nbsp;<span class="builtintype" id="3709446">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3709453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3709456">m</span><span class="op" id="3709457">.</span><span class="ident" id="3709458">verifyData</span>&nbsp;<span class="op" id="3709469">=</span>&nbsp;<span class="ident" id="3709471">data</span><span class="op" id="3709475">[</span><span class="num" id="3709476">4</span><span class="op" id="3709477">:</span><span class="op" id="3709478">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3709481">return</span>&nbsp;<span class="builtintype" id="3709488">true</span><br>
<span class="lineno">1005</span><span class="op" id="3709493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3709496">type</span>&nbsp;<span class="ident" id="3709501">nextProtoMsg</span>&nbsp;<span class="keyword" id="3709514">struct</span>&nbsp;<span class="op" id="3709521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3709524">raw</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3709530">[</span><span class="op" id="3709531">]</span><span class="builtintype" id="3709532">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3709538">proto</span>&nbsp;<span class="builtintype" id="3709544">string</span><br>
<span class="lineno">1010</span><span class="op" id="3709551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3709554">func</span>&nbsp;<span class="op" id="3709559">(</span><span class="ident" id="3709560">m</span>&nbsp;<span class="op" id="3709562">*</span><span class="ident" id="3709563">nextProtoMsg</span><span class="op" id="3709575">)</span>&nbsp;<span class="ident" id="3709577">equal</span><span class="op" id="3709582">(</span><span class="ident" id="3709583">i</span>&nbsp;<span class="keyword" id="3709585">interface</span><span class="op" id="3709594">{</span><span class="op" id="3709595">}</span><span class="op" id="3709596">)</span>&nbsp;<span class="builtintype" id="3709598">bool</span>&nbsp;<span class="op" id="3709603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3709606">m1</span><span class="op" id="3709608">,</span>&nbsp;<span class="ident" id="3709610">ok</span>&nbsp;<span class="op" id="3709613">:=</span>&nbsp;<span class="ident" id="3709616">i</span><span class="op" id="3709617">.</span><span class="op" id="3709618">(</span><span class="op" id="3709619">*</span><span class="ident" id="3709620">nextProtoMsg</span><span class="op" id="3709632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3709635">if</span>&nbsp;<span class="op" id="3709638">!</span><span class="ident" id="3709639">ok</span>&nbsp;<span class="op" id="3709642">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3709646">return</span>&nbsp;<span class="builtintype" id="3709653">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3709660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3709664">return</span>&nbsp;<span class="ident" id="3709671">bytes</span><span class="op" id="3709676">.</span><span class="ident" id="3709677">Equal</span><span class="op" id="3709682">(</span><span class="ident" id="3709683">m</span><span class="op" id="3709684">.</span><span class="ident" id="3709685">raw</span><span class="op" id="3709688">,</span>&nbsp;<span class="ident" id="3709690">m1</span><span class="op" id="3709692">.</span><span class="ident" id="3709693">raw</span><span class="op" id="3709696">)</span>&nbsp;<span class="op" id="3709698">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3709703">m</span><span class="op" id="3709704">.</span><span class="ident" id="3709705">proto</span>&nbsp;<span class="op" id="3709711">==</span>&nbsp;<span class="ident" id="3709714">m1</span><span class="op" id="3709716">.</span><span class="ident" id="3709717">proto</span><br>
<span class="lineno">1020</span><span class="op" id="3709723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3709726">func</span>&nbsp;<span class="op" id="3709731">(</span><span class="ident" id="3709732">m</span>&nbsp;<span class="op" id="3709734">*</span><span class="ident" id="3709735">nextProtoMsg</span><span class="op" id="3709747">)</span>&nbsp;<span class="ident" id="3709749">marshal</span><span class="op" id="3709756">(</span><span class="op" id="3709757">)</span>&nbsp;<span class="op" id="3709759">[</span><span class="op" id="3709760">]</span><span class="builtintype" id="3709761">byte</span>&nbsp;<span class="op" id="3709766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3709769">if</span>&nbsp;<span class="ident" id="3709772">m</span><span class="op" id="3709773">.</span><span class="ident" id="3709774">raw</span>&nbsp;<span class="op" id="3709778">!=</span>&nbsp;<span class="ident" id="3709781">nil</span>&nbsp;<span class="op" id="3709785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3709789">return</span>&nbsp;<span class="ident" id="3709796">m</span><span class="op" id="3709797">.</span><span class="ident" id="3709798">raw</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3709803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3709806">l</span>&nbsp;<span class="op" id="3709808">:=</span>&nbsp;<span class="builtinfunc" id="3709811">len</span><span class="op" id="3709814">(</span><span class="ident" id="3709815">m</span><span class="op" id="3709816">.</span><span class="ident" id="3709817">proto</span><span class="op" id="3709822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3709825">if</span>&nbsp;<span class="ident" id="3709828">l</span>&nbsp;<span class="op" id="3709830">&gt;</span>&nbsp;<span class="num" id="3709832">255</span>&nbsp;<span class="op" id="3709836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3709840">l</span>&nbsp;<span class="op" id="3709842">=</span>&nbsp;<span class="num" id="3709844">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3709849">}</span><br>
<span class="lineno">1030</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3709853">padding</span>&nbsp;<span class="op" id="3709861">:=</span>&nbsp;<span class="num" id="3709864">32</span>&nbsp;<span class="op" id="3709867">-</span>&nbsp;<span class="op" id="3709869">(</span><span class="ident" id="3709870">l</span><span class="op" id="3709871">+</span><span class="num" id="3709872">2</span><span class="op" id="3709873">)</span><span class="op" id="3709874">%</span><span class="num" id="3709875">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3709879">length</span>&nbsp;<span class="op" id="3709886">:=</span>&nbsp;<span class="ident" id="3709889">l</span>&nbsp;<span class="op" id="3709891">+</span>&nbsp;<span class="ident" id="3709893">padding</span>&nbsp;<span class="op" id="3709901">+</span>&nbsp;<span class="num" id="3709903">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3709906">x</span>&nbsp;<span class="op" id="3709908">:=</span>&nbsp;<span class="builtinfunc" id="3709911">make</span><span class="op" id="3709915">(</span><span class="op" id="3709916">[</span><span class="op" id="3709917">]</span><span class="builtintype" id="3709918">byte</span><span class="op" id="3709922">,</span>&nbsp;<span class="ident" id="3709924">length</span><span class="op" id="3709930">+</span><span class="num" id="3709931">4</span><span class="op" id="3709932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3709935">x</span><span class="op" id="3709936">[</span><span class="num" id="3709937">0</span><span class="op" id="3709938">]</span>&nbsp;<span class="op" id="3709940">=</span>&nbsp;<span class="ident" id="3709942">typeNextProtocol</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3709960">x</span><span class="op" id="3709961">[</span><span class="num" id="3709962">1</span><span class="op" id="3709963">]</span>&nbsp;<span class="op" id="3709965">=</span>&nbsp;<span class="builtintype" id="3709967">uint8</span><span class="op" id="3709972">(</span><span class="ident" id="3709973">length</span>&nbsp;<span class="op" id="3709980">&gt;&gt;</span>&nbsp;<span class="num" id="3709983">16</span><span class="op" id="3709985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3709988">x</span><span class="op" id="3709989">[</span><span class="num" id="3709990">2</span><span class="op" id="3709991">]</span>&nbsp;<span class="op" id="3709993">=</span>&nbsp;<span class="builtintype" id="3709995">uint8</span><span class="op" id="3710000">(</span><span class="ident" id="3710001">length</span>&nbsp;<span class="op" id="3710008">&gt;&gt;</span>&nbsp;<span class="num" id="3710011">8</span><span class="op" id="3710012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710015">x</span><span class="op" id="3710016">[</span><span class="num" id="3710017">3</span><span class="op" id="3710018">]</span>&nbsp;<span class="op" id="3710020">=</span>&nbsp;<span class="builtintype" id="3710022">uint8</span><span class="op" id="3710027">(</span><span class="ident" id="3710028">length</span><span class="op" id="3710034">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710038">y</span>&nbsp;<span class="op" id="3710040">:=</span>&nbsp;<span class="ident" id="3710043">x</span><span class="op" id="3710044">[</span><span class="num" id="3710045">4</span><span class="op" id="3710046">:</span><span class="op" id="3710047">]</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710050">y</span><span class="op" id="3710051">[</span><span class="num" id="3710052">0</span><span class="op" id="3710053">]</span>&nbsp;<span class="op" id="3710055">=</span>&nbsp;<span class="builtintype" id="3710057">byte</span><span class="op" id="3710061">(</span><span class="ident" id="3710062">l</span><span class="op" id="3710063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3710066">copy</span><span class="op" id="3710070">(</span><span class="ident" id="3710071">y</span><span class="op" id="3710072">[</span><span class="num" id="3710073">1</span><span class="op" id="3710074">:</span><span class="op" id="3710075">]</span><span class="op" id="3710076">,</span>&nbsp;<span class="op" id="3710078">[</span><span class="op" id="3710079">]</span><span class="builtintype" id="3710080">byte</span><span class="op" id="3710084">(</span><span class="ident" id="3710085">m</span><span class="op" id="3710086">.</span><span class="ident" id="3710087">proto</span><span class="op" id="3710092">[</span><span class="num" id="3710093">0</span><span class="op" id="3710094">:</span><span class="ident" id="3710095">l</span><span class="op" id="3710096">]</span><span class="op" id="3710097">)</span><span class="op" id="3710098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710101">y</span>&nbsp;<span class="op" id="3710103">=</span>&nbsp;<span class="ident" id="3710105">y</span><span class="op" id="3710106">[</span><span class="num" id="3710107">1</span><span class="op" id="3710108">+</span><span class="ident" id="3710109">l</span><span class="op" id="3710110">:</span><span class="op" id="3710111">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710114">y</span><span class="op" id="3710115">[</span><span class="num" id="3710116">0</span><span class="op" id="3710117">]</span>&nbsp;<span class="op" id="3710119">=</span>&nbsp;<span class="builtintype" id="3710121">byte</span><span class="op" id="3710125">(</span><span class="ident" id="3710126">padding</span><span class="op" id="3710133">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710137">m</span><span class="op" id="3710138">.</span><span class="ident" id="3710139">raw</span>&nbsp;<span class="op" id="3710143">=</span>&nbsp;<span class="ident" id="3710145">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3710149">return</span>&nbsp;<span class="ident" id="3710156">x</span><br>
<span class="lineno"></span><span class="op" id="3710158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1050</span><span class="keyword" id="3710161">func</span>&nbsp;<span class="op" id="3710166">(</span><span class="ident" id="3710167">m</span>&nbsp;<span class="op" id="3710169">*</span><span class="ident" id="3710170">nextProtoMsg</span><span class="op" id="3710182">)</span>&nbsp;<span class="ident" id="3710184">unmarshal</span><span class="op" id="3710193">(</span><span class="ident" id="3710194">data</span>&nbsp;<span class="op" id="3710199">[</span><span class="op" id="3710200">]</span><span class="builtintype" id="3710201">byte</span><span class="op" id="3710205">)</span>&nbsp;<span class="builtintype" id="3710207">bool</span>&nbsp;<span class="op" id="3710212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710215">m</span><span class="op" id="3710216">.</span><span class="ident" id="3710217">raw</span>&nbsp;<span class="op" id="3710221">=</span>&nbsp;<span class="ident" id="3710223">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3710230">if</span>&nbsp;<span class="builtinfunc" id="3710233">len</span><span class="op" id="3710236">(</span><span class="ident" id="3710237">data</span><span class="op" id="3710241">)</span>&nbsp;<span class="op" id="3710243">&lt;</span>&nbsp;<span class="num" id="3710245">5</span>&nbsp;<span class="op" id="3710247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3710251">return</span>&nbsp;<span class="builtintype" id="3710258">false</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3710265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710268">data</span>&nbsp;<span class="op" id="3710273">=</span>&nbsp;<span class="ident" id="3710275">data</span><span class="op" id="3710279">[</span><span class="num" id="3710280">4</span><span class="op" id="3710281">:</span><span class="op" id="3710282">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710285">protoLen</span>&nbsp;<span class="op" id="3710294">:=</span>&nbsp;<span class="builtintype" id="3710297">int</span><span class="op" id="3710300">(</span><span class="ident" id="3710301">data</span><span class="op" id="3710305">[</span><span class="num" id="3710306">0</span><span class="op" id="3710307">]</span><span class="op" id="3710308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710311">data</span>&nbsp;<span class="op" id="3710316">=</span>&nbsp;<span class="ident" id="3710318">data</span><span class="op" id="3710322">[</span><span class="num" id="3710323">1</span><span class="op" id="3710324">:</span><span class="op" id="3710325">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3710328">if</span>&nbsp;<span class="builtinfunc" id="3710331">len</span><span class="op" id="3710334">(</span><span class="ident" id="3710335">data</span><span class="op" id="3710339">)</span>&nbsp;<span class="op" id="3710341">&lt;</span>&nbsp;<span class="ident" id="3710343">protoLen</span>&nbsp;<span class="op" id="3710352">{</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3710356">return</span>&nbsp;<span class="builtintype" id="3710363">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3710370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710373">m</span><span class="op" id="3710374">.</span><span class="ident" id="3710375">proto</span>&nbsp;<span class="op" id="3710381">=</span>&nbsp;<span class="builtintype" id="3710383">string</span><span class="op" id="3710389">(</span><span class="ident" id="3710390">data</span><span class="op" id="3710394">[</span><span class="num" id="3710395">0</span><span class="op" id="3710396">:</span><span class="ident" id="3710397">protoLen</span><span class="op" id="3710405">]</span><span class="op" id="3710406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710409">data</span>&nbsp;<span class="op" id="3710414">=</span>&nbsp;<span class="ident" id="3710416">data</span><span class="op" id="3710420">[</span><span class="ident" id="3710421">protoLen</span><span class="op" id="3710429">:</span><span class="op" id="3710430">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3710434">if</span>&nbsp;<span class="builtinfunc" id="3710437">len</span><span class="op" id="3710440">(</span><span class="ident" id="3710441">data</span><span class="op" id="3710445">)</span>&nbsp;<span class="op" id="3710447">&lt;</span>&nbsp;<span class="num" id="3710449">1</span>&nbsp;<span class="op" id="3710451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3710455">return</span>&nbsp;<span class="builtintype" id="3710462">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3710469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710472">paddingLen</span>&nbsp;<span class="op" id="3710483">:=</span>&nbsp;<span class="builtintype" id="3710486">int</span><span class="op" id="3710489">(</span><span class="ident" id="3710490">data</span><span class="op" id="3710494">[</span><span class="num" id="3710495">0</span><span class="op" id="3710496">]</span><span class="op" id="3710497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710500">data</span>&nbsp;<span class="op" id="3710505">=</span>&nbsp;<span class="ident" id="3710507">data</span><span class="op" id="3710511">[</span><span class="num" id="3710512">1</span><span class="op" id="3710513">:</span><span class="op" id="3710514">]</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3710517">if</span>&nbsp;<span class="builtinfunc" id="3710520">len</span><span class="op" id="3710523">(</span><span class="ident" id="3710524">data</span><span class="op" id="3710528">)</span>&nbsp;<span class="op" id="3710530">!=</span>&nbsp;<span class="ident" id="3710533">paddingLen</span>&nbsp;<span class="op" id="3710544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3710548">return</span>&nbsp;<span class="builtintype" id="3710555">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3710562">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3710566">return</span>&nbsp;<span class="builtintype" id="3710573">true</span><br>
<span class="lineno">1075</span><span class="op" id="3710578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3710581">type</span>&nbsp;<span class="ident" id="3710586">certificateRequestMsg</span>&nbsp;<span class="keyword" id="3710608">struct</span>&nbsp;<span class="op" id="3710615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710618">raw</span>&nbsp;<span class="op" id="3710622">[</span><span class="op" id="3710623">]</span><span class="builtintype" id="3710624">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3710630">//&nbsp;hasSignatureAndHash&nbsp;indicates&nbsp;whether&nbsp;this&nbsp;message&nbsp;includes&nbsp;a&nbsp;list</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3710701">//&nbsp;of&nbsp;signature&nbsp;and&nbsp;hash&nbsp;functions.&nbsp;This&nbsp;change&nbsp;was&nbsp;introduced&nbsp;with&nbsp;TLS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3710774">//&nbsp;1.2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710783">hasSignatureAndHash</span>&nbsp;<span class="builtintype" id="3710803">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710810">certificateTypes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3710833">[</span><span class="op" id="3710834">]</span><span class="builtintype" id="3710835">byte</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710841">signatureAndHashes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3710864">[</span><span class="op" id="3710865">]</span><span class="ident" id="3710866">signatureAndHash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710884">certificateAuthorities</span>&nbsp;<span class="op" id="3710907">[</span><span class="op" id="3710908">]</span><span class="op" id="3710909">[</span><span class="op" id="3710910">]</span><span class="builtintype" id="3710911">byte</span><br>
<span class="lineno"></span><span class="op" id="3710916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3710919">func</span>&nbsp;<span class="op" id="3710924">(</span><span class="ident" id="3710925">m</span>&nbsp;<span class="op" id="3710927">*</span><span class="ident" id="3710928">certificateRequestMsg</span><span class="op" id="3710949">)</span>&nbsp;<span class="ident" id="3710951">equal</span><span class="op" id="3710956">(</span><span class="ident" id="3710957">i</span>&nbsp;<span class="keyword" id="3710959">interface</span><span class="op" id="3710968">{</span><span class="op" id="3710969">}</span><span class="op" id="3710970">)</span>&nbsp;<span class="builtintype" id="3710972">bool</span>&nbsp;<span class="op" id="3710977">{</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3710980">m1</span><span class="op" id="3710982">,</span>&nbsp;<span class="ident" id="3710984">ok</span>&nbsp;<span class="op" id="3710987">:=</span>&nbsp;<span class="ident" id="3710990">i</span><span class="op" id="3710991">.</span><span class="op" id="3710992">(</span><span class="op" id="3710993">*</span><span class="ident" id="3710994">certificateRequestMsg</span><span class="op" id="3711015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3711018">if</span>&nbsp;<span class="op" id="3711021">!</span><span class="ident" id="3711022">ok</span>&nbsp;<span class="op" id="3711025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3711029">return</span>&nbsp;<span class="builtintype" id="3711036">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3711043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3711047">return</span>&nbsp;<span class="ident" id="3711054">bytes</span><span class="op" id="3711059">.</span><span class="ident" id="3711060">Equal</span><span class="op" id="3711065">(</span><span class="ident" id="3711066">m</span><span class="op" id="3711067">.</span><span class="ident" id="3711068">raw</span><span class="op" id="3711071">,</span>&nbsp;<span class="ident" id="3711073">m1</span><span class="op" id="3711075">.</span><span class="ident" id="3711076">raw</span><span class="op" id="3711079">)</span>&nbsp;<span class="op" id="3711081">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3711086">bytes</span><span class="op" id="3711091">.</span><span class="ident" id="3711092">Equal</span><span class="op" id="3711097">(</span><span class="ident" id="3711098">m</span><span class="op" id="3711099">.</span><span class="ident" id="3711100">certificateTypes</span><span class="op" id="3711116">,</span>&nbsp;<span class="ident" id="3711118">m1</span><span class="op" id="3711120">.</span><span class="ident" id="3711121">certificateTypes</span><span class="op" id="3711137">)</span>&nbsp;<span class="op" id="3711139">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3711144">eqByteSlices</span><span class="op" id="3711156">(</span><span class="ident" id="3711157">m</span><span class="op" id="3711158">.</span><span class="ident" id="3711159">certificateAuthorities</span><span class="op" id="3711181">,</span>&nbsp;<span class="ident" id="3711183">m1</span><span class="op" id="3711185">.</span><span class="ident" id="3711186">certificateAuthorities</span><span class="op" id="3711208">)</span>&nbsp;<span class="op" id="3711210">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3711215">eqSignatureAndHashes</span><span class="op" id="3711235">(</span><span class="ident" id="3711236">m</span><span class="op" id="3711237">.</span><span class="ident" id="3711238">signatureAndHashes</span><span class="op" id="3711256">,</span>&nbsp;<span class="ident" id="3711258">m1</span><span class="op" id="3711260">.</span><span class="ident" id="3711261">signatureAndHashes</span><span class="op" id="3711279">)</span><br>
<span class="lineno"></span><span class="op" id="3711281">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span><span class="keyword" id="3711284">func</span>&nbsp;<span class="op" id="3711289">(</span><span class="ident" id="3711290">m</span>&nbsp;<span class="op" id="3711292">*</span><span class="ident" id="3711293">certificateRequestMsg</span><span class="op" id="3711314">)</span>&nbsp;<span class="ident" id="3711316">marshal</span><span class="op" id="3711323">(</span><span class="op" id="3711324">)</span>&nbsp;<span class="op" id="3711326">(</span><span class="ident" id="3711327">x</span>&nbsp;<span class="op" id="3711329">[</span><span class="op" id="3711330">]</span><span class="builtintype" id="3711331">byte</span><span class="op" id="3711335">)</span>&nbsp;<span class="op" id="3711337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3711340">if</span>&nbsp;<span class="ident" id="3711343">m</span><span class="op" id="3711344">.</span><span class="ident" id="3711345">raw</span>&nbsp;<span class="op" id="3711349">!=</span>&nbsp;<span class="ident" id="3711352">nil</span>&nbsp;<span class="op" id="3711356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3711360">return</span>&nbsp;<span class="ident" id="3711367">m</span><span class="op" id="3711368">.</span><span class="ident" id="3711369">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3711374">}</span><br>
<span class="lineno">1105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3711378">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc4346#section-7.4.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3711435">length</span>&nbsp;<span class="op" id="3711442">:=</span>&nbsp;<span class="num" id="3711445">1</span>&nbsp;<span class="op" id="3711447">+</span>&nbsp;<span class="builtinfunc" id="3711449">len</span><span class="op" id="3711452">(</span><span class="ident" id="3711453">m</span><span class="op" id="3711454">.</span><span class="ident" id="3711455">certificateTypes</span><span class="op" id="3711471">)</span>&nbsp;<span class="op" id="3711473">+</span>&nbsp;<span class="num" id="3711475">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3711478">casLength</span>&nbsp;<span class="op" id="3711488">:=</span>&nbsp;<span class="num" id="3711491">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3711494">for</span>&nbsp;<span class="ident" id="3711498">_</span><span class="op" id="3711499">,</span>&nbsp;<span class="ident" id="3711501">ca</span>&nbsp;<span class="op" id="3711504">:=</span>&nbsp;<span class="keyword" id="3711507">range</span>&nbsp;<span class="ident" id="3711513">m</span><span class="op" id="3711514">.</span><span class="ident" id="3711515">certificateAuthorities</span>&nbsp;<span class="op" id="3711538">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3711542">casLength</span>&nbsp;<span class="op" id="3711552">+=</span>&nbsp;<span class="num" id="3711555">2</span>&nbsp;<span class="op" id="3711557">+</span>&nbsp;<span class="builtinfunc" id="3711559">len</span><span class="op" id="3711562">(</span><span class="ident" id="3711563">ca</span><span class="op" id="3711565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3711568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3711571">length</span>&nbsp;<span class="op" id="3711578">+=</span>&nbsp;<span class="ident" id="3711581">casLength</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3711593">if</span>&nbsp;<span class="ident" id="3711596">m</span><span class="op" id="3711597">.</span><span class="ident" id="3711598">hasSignatureAndHash</span>&nbsp;<span class="op" id="3711618">{</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3711622">length</span>&nbsp;<span class="op" id="3711629">+=</span>&nbsp;<span class="num" id="3711632">2</span>&nbsp;<span class="op" id="3711634">+</span>&nbsp;<span class="num" id="3711636">2</span><span class="op" id="3711637">*</span><span class="builtinfunc" id="3711638">len</span><span class="op" id="3711641">(</span><span class="ident" id="3711642">m</span><span class="op" id="3711643">.</span><span class="ident" id="3711644">signatureAndHashes</span><span class="op" id="3711662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3711665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3711669">x</span>&nbsp;<span class="op" id="3711671">=</span>&nbsp;<span class="builtinfunc" id="3711673">make</span><span class="op" id="3711677">(</span><span class="op" id="3711678">[</span><span class="op" id="3711679">]</span><span class="builtintype" id="3711680">byte</span><span class="op" id="3711684">,</span>&nbsp;<span class="num" id="3711686">4</span><span class="op" id="3711687">+</span><span class="ident" id="3711688">length</span><span class="op" id="3711694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3711697">x</span><span class="op" id="3711698">[</span><span class="num" id="3711699">0</span><span class="op" id="3711700">]</span>&nbsp;<span class="op" id="3711702">=</span>&nbsp;<span class="ident" id="3711704">typeCertificateRequest</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3711728">x</span><span class="op" id="3711729">[</span><span class="num" id="3711730">1</span><span class="op" id="3711731">]</span>&nbsp;<span class="op" id="3711733">=</span>&nbsp;<span class="builtintype" id="3711735">uint8</span><span class="op" id="3711740">(</span><span class="ident" id="3711741">length</span>&nbsp;<span class="op" id="3711748">&gt;&gt;</span>&nbsp;<span class="num" id="3711751">16</span><span class="op" id="3711753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3711756">x</span><span class="op" id="3711757">[</span><span class="num" id="3711758">2</span><span class="op" id="3711759">]</span>&nbsp;<span class="op" id="3711761">=</span>&nbsp;<span class="builtintype" id="3711763">uint8</span><span class="op" id="3711768">(</span><span class="ident" id="3711769">length</span>&nbsp;<span class="op" id="3711776">&gt;&gt;</span>&nbsp;<span class="num" id="3711779">8</span><span class="op" id="3711780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3711783">x</span><span class="op" id="3711784">[</span><span class="num" id="3711785">3</span><span class="op" id="3711786">]</span>&nbsp;<span class="op" id="3711788">=</span>&nbsp;<span class="builtintype" id="3711790">uint8</span><span class="op" id="3711795">(</span><span class="ident" id="3711796">length</span><span class="op" id="3711802">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3711806">x</span><span class="op" id="3711807">[</span><span class="num" id="3711808">4</span><span class="op" id="3711809">]</span>&nbsp;<span class="op" id="3711811">=</span>&nbsp;<span class="builtintype" id="3711813">uint8</span><span class="op" id="3711818">(</span><span class="builtinfunc" id="3711819">len</span><span class="op" id="3711822">(</span><span class="ident" id="3711823">m</span><span class="op" id="3711824">.</span><span class="ident" id="3711825">certificateTypes</span><span class="op" id="3711841">)</span><span class="op" id="3711842">)</span><br>
<span class="lineno">1125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3711846">copy</span><span class="op" id="3711850">(</span><span class="ident" id="3711851">x</span><span class="op" id="3711852">[</span><span class="num" id="3711853">5</span><span class="op" id="3711854">:</span><span class="op" id="3711855">]</span><span class="op" id="3711856">,</span>&nbsp;<span class="ident" id="3711858">m</span><span class="op" id="3711859">.</span><span class="ident" id="3711860">certificateTypes</span><span class="op" id="3711876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3711879">y</span>&nbsp;<span class="op" id="3711881">:=</span>&nbsp;<span class="ident" id="3711884">x</span><span class="op" id="3711885">[</span><span class="num" id="3711886">5</span><span class="op" id="3711887">+</span><span class="builtinfunc" id="3711888">len</span><span class="op" id="3711891">(</span><span class="ident" id="3711892">m</span><span class="op" id="3711893">.</span><span class="ident" id="3711894">certificateTypes</span><span class="op" id="3711910">)</span><span class="op" id="3711911">:</span><span class="op" id="3711912">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3711916">if</span>&nbsp;<span class="ident" id="3711919">m</span><span class="op" id="3711920">.</span><span class="ident" id="3711921">hasSignatureAndHash</span>&nbsp;<span class="op" id="3711941">{</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3711945">n</span>&nbsp;<span class="op" id="3711947">:=</span>&nbsp;<span class="builtinfunc" id="3711950">len</span><span class="op" id="3711953">(</span><span class="ident" id="3711954">m</span><span class="op" id="3711955">.</span><span class="ident" id="3711956">signatureAndHashes</span><span class="op" id="3711974">)</span>&nbsp;<span class="op" id="3711976">*</span>&nbsp;<span class="num" id="3711978">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3711982">y</span><span class="op" id="3711983">[</span><span class="num" id="3711984">0</span><span class="op" id="3711985">]</span>&nbsp;<span class="op" id="3711987">=</span>&nbsp;<span class="builtintype" id="3711989">uint8</span><span class="op" id="3711994">(</span><span class="ident" id="3711995">n</span>&nbsp;<span class="op" id="3711997">&gt;&gt;</span>&nbsp;<span class="num" id="3712000">8</span><span class="op" id="3712001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3712005">y</span><span class="op" id="3712006">[</span><span class="num" id="3712007">1</span><span class="op" id="3712008">]</span>&nbsp;<span class="op" id="3712010">=</span>&nbsp;<span class="builtintype" id="3712012">uint8</span><span class="op" id="3712017">(</span><span class="ident" id="3712018">n</span><span class="op" id="3712019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3712023">y</span>&nbsp;<span class="op" id="3712025">=</span>&nbsp;<span class="ident" id="3712027">y</span><span class="op" id="3712028">[</span><span class="num" id="3712029">2</span><span class="op" id="3712030">:</span><span class="op" id="3712031">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3712035">for</span>&nbsp;<span class="ident" id="3712039">_</span><span class="op" id="3712040">,</span>&nbsp;<span class="ident" id="3712042">sigAndHash</span>&nbsp;<span class="op" id="3712053">:=</span>&nbsp;<span class="keyword" id="3712056">range</span>&nbsp;<span class="ident" id="3712062">m</span><span class="op" id="3712063">.</span><span class="ident" id="3712064">signatureAndHashes</span>&nbsp;<span class="op" id="3712083">{</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3712088">y</span><span class="op" id="3712089">[</span><span class="num" id="3712090">0</span><span class="op" id="3712091">]</span>&nbsp;<span class="op" id="3712093">=</span>&nbsp;<span class="ident" id="3712095">sigAndHash</span><span class="op" id="3712105">.</span><span class="ident" id="3712106">hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3712114">y</span><span class="op" id="3712115">[</span><span class="num" id="3712116">1</span><span class="op" id="3712117">]</span>&nbsp;<span class="op" id="3712119">=</span>&nbsp;<span class="ident" id="3712121">sigAndHash</span><span class="op" id="3712131">.</span><span class="ident" id="3712132">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3712145">y</span>&nbsp;<span class="op" id="3712147">=</span>&nbsp;<span class="ident" id="3712149">y</span><span class="op" id="3712150">[</span><span class="num" id="3712151">2</span><span class="op" id="3712152">:</span><span class="op" id="3712153">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3712157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3712160">}</span><br>
<span class="lineno">1140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3712164">y</span><span class="op" id="3712165">[</span><span class="num" id="3712166">0</span><span class="op" id="3712167">]</span>&nbsp;<span class="op" id="3712169">=</span>&nbsp;<span class="builtintype" id="3712171">uint8</span><span class="op" id="3712176">(</span><span class="ident" id="3712177">casLength</span>&nbsp;<span class="op" id="3712187">&gt;&gt;</span>&nbsp;<span class="num" id="3712190">8</span><span class="op" id="3712191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3712194">y</span><span class="op" id="3712195">[</span><span class="num" id="3712196">1</span><span class="op" id="3712197">]</span>&nbsp;<span class="op" id="3712199">=</span>&nbsp;<span class="builtintype" id="3712201">uint8</span><span class="op" id="3712206">(</span><span class="ident" id="3712207">casLength</span><span class="op" id="3712216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3712219">y</span>&nbsp;<span class="op" id="3712221">=</span>&nbsp;<span class="ident" id="3712223">y</span><span class="op" id="3712224">[</span><span class="num" id="3712225">2</span><span class="op" id="3712226">:</span><span class="op" id="3712227">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3712230">for</span>&nbsp;<span class="ident" id="3712234">_</span><span class="op" id="3712235">,</span>&nbsp;<span class="ident" id="3712237">ca</span>&nbsp;<span class="op" id="3712240">:=</span>&nbsp;<span class="keyword" id="3712243">range</span>&nbsp;<span class="ident" id="3712249">m</span><span class="op" id="3712250">.</span><span class="ident" id="3712251">certificateAuthorities</span>&nbsp;<span class="op" id="3712274">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3712278">y</span><span class="op" id="3712279">[</span><span class="num" id="3712280">0</span><span class="op" id="3712281">]</span>&nbsp;<span class="op" id="3712283">=</span>&nbsp;<span class="builtintype" id="3712285">uint8</span><span class="op" id="3712290">(</span><span class="builtinfunc" id="3712291">len</span><span class="op" id="3712294">(</span><span class="ident" id="3712295">ca</span><span class="op" id="3712297">)</span>&nbsp;<span class="op" id="3712299">&gt;&gt;</span>&nbsp;<span class="num" id="3712302">8</span><span class="op" id="3712303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3712307">y</span><span class="op" id="3712308">[</span><span class="num" id="3712309">1</span><span class="op" id="3712310">]</span>&nbsp;<span class="op" id="3712312">=</span>&nbsp;<span class="builtintype" id="3712314">uint8</span><span class="op" id="3712319">(</span><span class="builtinfunc" id="3712320">len</span><span class="op" id="3712323">(</span><span class="ident" id="3712324">ca</span><span class="op" id="3712326">)</span><span class="op" id="3712327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3712331">y</span>&nbsp;<span class="op" id="3712333">=</span>&nbsp;<span class="ident" id="3712335">y</span><span class="op" id="3712336">[</span><span class="num" id="3712337">2</span><span class="op" id="3712338">:</span><span class="op" id="3712339">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3712343">copy</span><span class="op" id="3712347">(</span><span class="ident" id="3712348">y</span><span class="op" id="3712349">,</span>&nbsp;<span class="ident" id="3712351">ca</span><span class="op" id="3712353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3712357">y</span>&nbsp;<span class="op" id="3712359">=</span>&nbsp;<span class="ident" id="3712361">y</span><span class="op" id="3712362">[</span><span class="builtinfunc" id="3712363">len</span><span class="op" id="3712366">(</span><span class="ident" id="3712367">ca</span><span class="op" id="3712369">)</span><span class="op" id="3712370">:</span><span class="op" id="3712371">]</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3712374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3712378">m</span><span class="op" id="3712379">.</span><span class="ident" id="3712380">raw</span>&nbsp;<span class="op" id="3712384">=</span>&nbsp;<span class="ident" id="3712386">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3712389">return</span><br>
<span class="lineno"></span><span class="op" id="3712396">}</span><br>
<span class="lineno">1155</span><br>
<span class="lineno"></span><span class="keyword" id="3712399">func</span>&nbsp;<span class="op" id="3712404">(</span><span class="ident" id="3712405">m</span>&nbsp;<span class="op" id="3712407">*</span><span class="ident" id="3712408">certificateRequestMsg</span><span class="op" id="3712429">)</span>&nbsp;<span class="ident" id="3712431">unmarshal</span><span class="op" id="3712440">(</span><span class="ident" id="3712441">data</span>&nbsp;<span class="op" id="3712446">[</span><span class="op" id="3712447">]</span><span class="builtintype" id="3712448">byte</span><span class="op" id="3712452">)</span>&nbsp;<span class="builtintype" id="3712454">bool</span>&nbsp;<span class="op" id="3712459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3712462">m</span><span class="op" id="3712463">.</span><span class="ident" id="3712464">raw</span>&nbsp;<span class="op" id="3712468">=</span>&nbsp;<span class="ident" id="3712470">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3712477">if</span>&nbsp;<span class="builtinfunc" id="3712480">len</span><span class="op" id="3712483">(</span><span class="ident" id="3712484">data</span><span class="op" id="3712488">)</span>&nbsp;<span class="op" id="3712490">&lt;</span>&nbsp;<span class="num" id="3712492">5</span>&nbsp;<span class="op" id="3712494">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3712498">return</span>&nbsp;<span class="builtintype" id="3712505">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3712512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3712516">length</span>&nbsp;<span class="op" id="3712523">:=</span>&nbsp;<span class="builtintype" id="3712526">uint32</span><span class="op" id="3712532">(</span><span class="ident" id="3712533">data</span><span class="op" id="3712537">[</span><span class="num" id="3712538">1</span><span class="op" id="3712539">]</span><span class="op" id="3712540">)</span><span class="op" id="3712541">&lt;&lt;</span><span class="num" id="3712543">16</span>&nbsp;<span class="op" id="3712546">|</span>&nbsp;<span class="builtintype" id="3712548">uint32</span><span class="op" id="3712554">(</span><span class="ident" id="3712555">data</span><span class="op" id="3712559">[</span><span class="num" id="3712560">2</span><span class="op" id="3712561">]</span><span class="op" id="3712562">)</span><span class="op" id="3712563">&lt;&lt;</span><span class="num" id="3712565">8</span>&nbsp;<span class="op" id="3712567">|</span>&nbsp;<span class="builtintype" id="3712569">uint32</span><span class="op" id="3712575">(</span><span class="ident" id="3712576">data</span><span class="op" id="3712580">[</span><span class="num" id="3712581">3</span><span class="op" id="3712582">]</span><span class="op" id="3712583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3712586">if</span>&nbsp;<span class="builtintype" id="3712589">uint32</span><span class="op" id="3712595">(</span><span class="builtinfunc" id="3712596">len</span><span class="op" id="3712599">(</span><span class="ident" id="3712600">data</span><span class="op" id="3712604">)</span><span class="op" id="3712605">)</span><span class="op" id="3712606">-</span><span class="num" id="3712607">4</span>&nbsp;<span class="op" id="3712609">!=</span>&nbsp;<span class="ident" id="3712612">length</span>&nbsp;<span class="op" id="3712619">{</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3712623">return</span>&nbsp;<span class="builtintype" id="3712630">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3712637">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3712641">numCertTypes</span>&nbsp;<span class="op" id="3712654">:=</span>&nbsp;<span class="builtintype" id="3712657">int</span><span class="op" id="3712660">(</span><span class="ident" id="3712661">data</span><span class="op" id="3712665">[</span><span class="num" id="3712666">4</span><span class="op" id="3712667">]</span><span class="op" id="3712668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3712671">data</span>&nbsp;<span class="op" id="3712676">=</span>&nbsp;<span class="ident" id="3712678">data</span><span class="op" id="3712682">[</span><span class="num" id="3712683">5</span><span class="op" id="3712684">:</span><span class="op" id="3712685">]</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3712688">if</span>&nbsp;<span class="ident" id="3712691">numCertTypes</span>&nbsp;<span class="op" id="3712704">==</span>&nbsp;<span class="num" id="3712707">0</span>&nbsp;<span class="op" id="3712709">||</span>&nbsp;<span class="builtinfunc" id="3712712">len</span><span class="op" id="3712715">(</span><span class="ident" id="3712716">data</span><span class="op" id="3712720">)</span>&nbsp;<span class="op" id="3712722">&lt;=</span>&nbsp;<span class="ident" id="3712725">numCertTypes</span>&nbsp;<span class="op" id="3712738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3712742">return</span>&nbsp;<span class="builtintype" id="3712749">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3712756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3712760">m</span><span class="op" id="3712761">.</span><span class="ident" id="3712762">certificateTypes</span>&nbsp;<span class="op" id="3712779">=</span>&nbsp;<span class="builtinfunc" id="3712781">make</span><span class="op" id="3712785">(</span><span class="op" id="3712786">[</span><span class="op" id="3712787">]</span><span class="builtintype" id="3712788">byte</span><span class="op" id="3712792">,</span>&nbsp;<span class="ident" id="3712794">numCertTypes</span><span class="op" id="3712806">)</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3712809">if</span>&nbsp;<span class="builtinfunc" id="3712812">copy</span><span class="op" id="3712816">(</span><span class="ident" id="3712817">m</span><span class="op" id="3712818">.</span><span class="ident" id="3712819">certificateTypes</span><span class="op" id="3712835">,</span>&nbsp;<span class="ident" id="3712837">data</span><span class="op" id="3712841">)</span>&nbsp;<span class="op" id="3712843">!=</span>&nbsp;<span class="ident" id="3712846">numCertTypes</span>&nbsp;<span class="op" id="3712859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3712863">return</span>&nbsp;<span class="builtintype" id="3712870">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3712877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3712881">data</span>&nbsp;<span class="op" id="3712886">=</span>&nbsp;<span class="ident" id="3712888">data</span><span class="op" id="3712892">[</span><span class="ident" id="3712893">numCertTypes</span><span class="op" id="3712905">:</span><span class="op" id="3712906">]</span><br>
<span class="lineno">1180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3712910">if</span>&nbsp;<span class="ident" id="3712913">m</span><span class="op" id="3712914">.</span><span class="ident" id="3712915">hasSignatureAndHash</span>&nbsp;<span class="op" id="3712935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3712939">if</span>&nbsp;<span class="builtinfunc" id="3712942">len</span><span class="op" id="3712945">(</span><span class="ident" id="3712946">data</span><span class="op" id="3712950">)</span>&nbsp;<span class="op" id="3712952">&lt;</span>&nbsp;<span class="num" id="3712954">2</span>&nbsp;<span class="op" id="3712956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3712961">return</span>&nbsp;<span class="builtintype" id="3712968">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3712976">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3712980">sigAndHashLen</span>&nbsp;<span class="op" id="3712994">:=</span>&nbsp;<span class="builtintype" id="3712997">uint16</span><span class="op" id="3713003">(</span><span class="ident" id="3713004">data</span><span class="op" id="3713008">[</span><span class="num" id="3713009">0</span><span class="op" id="3713010">]</span><span class="op" id="3713011">)</span><span class="op" id="3713012">&lt;&lt;</span><span class="num" id="3713014">8</span>&nbsp;<span class="op" id="3713016">|</span>&nbsp;<span class="builtintype" id="3713018">uint16</span><span class="op" id="3713024">(</span><span class="ident" id="3713025">data</span><span class="op" id="3713029">[</span><span class="num" id="3713030">1</span><span class="op" id="3713031">]</span><span class="op" id="3713032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3713036">data</span>&nbsp;<span class="op" id="3713041">=</span>&nbsp;<span class="ident" id="3713043">data</span><span class="op" id="3713047">[</span><span class="num" id="3713048">2</span><span class="op" id="3713049">:</span><span class="op" id="3713050">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3713054">if</span>&nbsp;<span class="ident" id="3713057">sigAndHashLen</span><span class="op" id="3713070">&amp;</span><span class="num" id="3713071">1</span>&nbsp;<span class="op" id="3713073">!=</span>&nbsp;<span class="num" id="3713076">0</span>&nbsp;<span class="op" id="3713078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3713083">return</span>&nbsp;<span class="builtintype" id="3713090">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3713098">}</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3713102">if</span>&nbsp;<span class="builtinfunc" id="3713105">len</span><span class="op" id="3713108">(</span><span class="ident" id="3713109">data</span><span class="op" id="3713113">)</span>&nbsp;<span class="op" id="3713115">&lt;</span>&nbsp;<span class="builtintype" id="3713117">int</span><span class="op" id="3713120">(</span><span class="ident" id="3713121">sigAndHashLen</span><span class="op" id="3713134">)</span>&nbsp;<span class="op" id="3713136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3713141">return</span>&nbsp;<span class="builtintype" id="3713148">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3713156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3713160">numSigAndHash</span>&nbsp;<span class="op" id="3713174">:=</span>&nbsp;<span class="ident" id="3713177">sigAndHashLen</span>&nbsp;<span class="op" id="3713191">/</span>&nbsp;<span class="num" id="3713193">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3713197">m</span><span class="op" id="3713198">.</span><span class="ident" id="3713199">signatureAndHashes</span>&nbsp;<span class="op" id="3713218">=</span>&nbsp;<span class="builtinfunc" id="3713220">make</span><span class="op" id="3713224">(</span><span class="op" id="3713225">[</span><span class="op" id="3713226">]</span><span class="ident" id="3713227">signatureAndHash</span><span class="op" id="3713243">,</span>&nbsp;<span class="ident" id="3713245">numSigAndHash</span><span class="op" id="3713258">)</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3713262">for</span>&nbsp;<span class="ident" id="3713266">i</span>&nbsp;<span class="op" id="3713268">:=</span>&nbsp;<span class="keyword" id="3713271">range</span>&nbsp;<span class="ident" id="3713277">m</span><span class="op" id="3713278">.</span><span class="ident" id="3713279">signatureAndHashes</span>&nbsp;<span class="op" id="3713298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3713303">m</span><span class="op" id="3713304">.</span><span class="ident" id="3713305">signatureAndHashes</span><span class="op" id="3713323">[</span><span class="ident" id="3713324">i</span><span class="op" id="3713325">]</span><span class="op" id="3713326">.</span><span class="ident" id="3713327">hash</span>&nbsp;<span class="op" id="3713332">=</span>&nbsp;<span class="ident" id="3713334">data</span><span class="op" id="3713338">[</span><span class="num" id="3713339">0</span><span class="op" id="3713340">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3713345">m</span><span class="op" id="3713346">.</span><span class="ident" id="3713347">signatureAndHashes</span><span class="op" id="3713365">[</span><span class="ident" id="3713366">i</span><span class="op" id="3713367">]</span><span class="op" id="3713368">.</span><span class="ident" id="3713369">signature</span>&nbsp;<span class="op" id="3713379">=</span>&nbsp;<span class="ident" id="3713381">data</span><span class="op" id="3713385">[</span><span class="num" id="3713386">1</span><span class="op" id="3713387">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3713392">data</span>&nbsp;<span class="op" id="3713397">=</span>&nbsp;<span class="ident" id="3713399">data</span><span class="op" id="3713403">[</span><span class="num" id="3713404">2</span><span class="op" id="3713405">:</span><span class="op" id="3713406">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3713410">}</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3713413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3713417">if</span>&nbsp;<span class="builtinfunc" id="3713420">len</span><span class="op" id="3713423">(</span><span class="ident" id="3713424">data</span><span class="op" id="3713428">)</span>&nbsp;<span class="op" id="3713430">&lt;</span>&nbsp;<span class="num" id="3713432">2</span>&nbsp;<span class="op" id="3713434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3713438">return</span>&nbsp;<span class="builtintype" id="3713445">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3713452">}</span><br>
<span class="lineno">1205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3713455">casLength</span>&nbsp;<span class="op" id="3713465">:=</span>&nbsp;<span class="builtintype" id="3713468">uint16</span><span class="op" id="3713474">(</span><span class="ident" id="3713475">data</span><span class="op" id="3713479">[</span><span class="num" id="3713480">0</span><span class="op" id="3713481">]</span><span class="op" id="3713482">)</span><span class="op" id="3713483">&lt;&lt;</span><span class="num" id="3713485">8</span>&nbsp;<span class="op" id="3713487">|</span>&nbsp;<span class="builtintype" id="3713489">uint16</span><span class="op" id="3713495">(</span><span class="ident" id="3713496">data</span><span class="op" id="3713500">[</span><span class="num" id="3713501">1</span><span class="op" id="3713502">]</span><span class="op" id="3713503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3713506">data</span>&nbsp;<span class="op" id="3713511">=</span>&nbsp;<span class="ident" id="3713513">data</span><span class="op" id="3713517">[</span><span class="num" id="3713518">2</span><span class="op" id="3713519">:</span><span class="op" id="3713520">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3713523">if</span>&nbsp;<span class="builtinfunc" id="3713526">len</span><span class="op" id="3713529">(</span><span class="ident" id="3713530">data</span><span class="op" id="3713534">)</span>&nbsp;<span class="op" id="3713536">&lt;</span>&nbsp;<span class="builtintype" id="3713538">int</span><span class="op" id="3713541">(</span><span class="ident" id="3713542">casLength</span><span class="op" id="3713551">)</span>&nbsp;<span class="op" id="3713553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3713557">return</span>&nbsp;<span class="builtintype" id="3713564">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3713571">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3713574">cas</span>&nbsp;<span class="op" id="3713578">:=</span>&nbsp;<span class="builtinfunc" id="3713581">make</span><span class="op" id="3713585">(</span><span class="op" id="3713586">[</span><span class="op" id="3713587">]</span><span class="builtintype" id="3713588">byte</span><span class="op" id="3713592">,</span>&nbsp;<span class="ident" id="3713594">casLength</span><span class="op" id="3713603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3713606">copy</span><span class="op" id="3713610">(</span><span class="ident" id="3713611">cas</span><span class="op" id="3713614">,</span>&nbsp;<span class="ident" id="3713616">data</span><span class="op" id="3713620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3713623">data</span>&nbsp;<span class="op" id="3713628">=</span>&nbsp;<span class="ident" id="3713630">data</span><span class="op" id="3713634">[</span><span class="ident" id="3713635">casLength</span><span class="op" id="3713644">:</span><span class="op" id="3713645">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3713649">m</span><span class="op" id="3713650">.</span><span class="ident" id="3713651">certificateAuthorities</span>&nbsp;<span class="op" id="3713674">=</span>&nbsp;<span class="ident" id="3713676">nil</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3713681">for</span>&nbsp;<span class="builtinfunc" id="3713685">len</span><span class="op" id="3713688">(</span><span class="ident" id="3713689">cas</span><span class="op" id="3713692">)</span>&nbsp;<span class="op" id="3713694">&gt;</span>&nbsp;<span class="num" id="3713696">0</span>&nbsp;<span class="op" id="3713698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3713702">if</span>&nbsp;<span class="builtinfunc" id="3713705">len</span><span class="op" id="3713708">(</span><span class="ident" id="3713709">cas</span><span class="op" id="3713712">)</span>&nbsp;<span class="op" id="3713714">&lt;</span>&nbsp;<span class="num" id="3713716">2</span>&nbsp;<span class="op" id="3713718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3713723">return</span>&nbsp;<span class="builtintype" id="3713730">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3713738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3713742">caLen</span>&nbsp;<span class="op" id="3713748">:=</span>&nbsp;<span class="builtintype" id="3713751">uint16</span><span class="op" id="3713757">(</span><span class="ident" id="3713758">cas</span><span class="op" id="3713761">[</span><span class="num" id="3713762">0</span><span class="op" id="3713763">]</span><span class="op" id="3713764">)</span><span class="op" id="3713765">&lt;&lt;</span><span class="num" id="3713767">8</span>&nbsp;<span class="op" id="3713769">|</span>&nbsp;<span class="builtintype" id="3713771">uint16</span><span class="op" id="3713777">(</span><span class="ident" id="3713778">cas</span><span class="op" id="3713781">[</span><span class="num" id="3713782">1</span><span class="op" id="3713783">]</span><span class="op" id="3713784">)</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3713788">cas</span>&nbsp;<span class="op" id="3713792">=</span>&nbsp;<span class="ident" id="3713794">cas</span><span class="op" id="3713797">[</span><span class="num" id="3713798">2</span><span class="op" id="3713799">:</span><span class="op" id="3713800">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3713805">if</span>&nbsp;<span class="builtinfunc" id="3713808">len</span><span class="op" id="3713811">(</span><span class="ident" id="3713812">cas</span><span class="op" id="3713815">)</span>&nbsp;<span class="op" id="3713817">&lt;</span>&nbsp;<span class="builtintype" id="3713819">int</span><span class="op" id="3713822">(</span><span class="ident" id="3713823">caLen</span><span class="op" id="3713828">)</span>&nbsp;<span class="op" id="3713830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3713835">return</span>&nbsp;<span class="builtintype" id="3713842">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3713850">}</span><br>
<span class="lineno">1225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3713855">m</span><span class="op" id="3713856">.</span><span class="ident" id="3713857">certificateAuthorities</span>&nbsp;<span class="op" id="3713880">=</span>&nbsp;<span class="builtinfunc" id="3713882">append</span><span class="op" id="3713888">(</span><span class="ident" id="3713889">m</span><span class="op" id="3713890">.</span><span class="ident" id="3713891">certificateAuthorities</span><span class="op" id="3713913">,</span>&nbsp;<span class="ident" id="3713915">cas</span><span class="op" id="3713918">[</span><span class="op" id="3713919">:</span><span class="ident" id="3713920">caLen</span><span class="op" id="3713925">]</span><span class="op" id="3713926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3713930">cas</span>&nbsp;<span class="op" id="3713934">=</span>&nbsp;<span class="ident" id="3713936">cas</span><span class="op" id="3713939">[</span><span class="ident" id="3713940">caLen</span><span class="op" id="3713945">:</span><span class="op" id="3713946">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3713949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3713952">if</span>&nbsp;<span class="builtinfunc" id="3713955">len</span><span class="op" id="3713958">(</span><span class="ident" id="3713959">data</span><span class="op" id="3713963">)</span>&nbsp;<span class="op" id="3713965">&gt;</span>&nbsp;<span class="num" id="3713967">0</span>&nbsp;<span class="op" id="3713969">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3713973">return</span>&nbsp;<span class="builtintype" id="3713980">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3713987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3713991">return</span>&nbsp;<span class="builtintype" id="3713998">true</span><br>
<span class="lineno"></span><span class="op" id="3714003">}</span><br>
<span class="lineno">1235</span><br>
<span class="lineno"></span><span class="keyword" id="3714006">type</span>&nbsp;<span class="ident" id="3714011">certificateVerifyMsg</span>&nbsp;<span class="keyword" id="3714032">struct</span>&nbsp;<span class="op" id="3714039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3714042">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3714062">[</span><span class="op" id="3714063">]</span><span class="builtintype" id="3714064">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3714070">hasSignatureAndHash</span>&nbsp;<span class="builtintype" id="3714090">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3714096">signatureAndHash</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3714116">signatureAndHash</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3714134">signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3714154">[</span><span class="op" id="3714155">]</span><span class="builtintype" id="3714156">byte</span><br>
<span class="lineno"></span><span class="op" id="3714161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3714164">func</span>&nbsp;<span class="op" id="3714169">(</span><span class="ident" id="3714170">m</span>&nbsp;<span class="op" id="3714172">*</span><span class="ident" id="3714173">certificateVerifyMsg</span><span class="op" id="3714193">)</span>&nbsp;<span class="ident" id="3714195">equal</span><span class="op" id="3714200">(</span><span class="ident" id="3714201">i</span>&nbsp;<span class="keyword" id="3714203">interface</span><span class="op" id="3714212">{</span><span class="op" id="3714213">}</span><span class="op" id="3714214">)</span>&nbsp;<span class="builtintype" id="3714216">bool</span>&nbsp;<span class="op" id="3714221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3714224">m1</span><span class="op" id="3714226">,</span>&nbsp;<span class="ident" id="3714228">ok</span>&nbsp;<span class="op" id="3714231">:=</span>&nbsp;<span class="ident" id="3714234">i</span><span class="op" id="3714235">.</span><span class="op" id="3714236">(</span><span class="op" id="3714237">*</span><span class="ident" id="3714238">certificateVerifyMsg</span><span class="op" id="3714258">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3714261">if</span>&nbsp;<span class="op" id="3714264">!</span><span class="ident" id="3714265">ok</span>&nbsp;<span class="op" id="3714268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3714272">return</span>&nbsp;<span class="builtintype" id="3714279">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3714286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3714290">return</span>&nbsp;<span class="ident" id="3714297">bytes</span><span class="op" id="3714302">.</span><span class="ident" id="3714303">Equal</span><span class="op" id="3714308">(</span><span class="ident" id="3714309">m</span><span class="op" id="3714310">.</span><span class="ident" id="3714311">raw</span><span class="op" id="3714314">,</span>&nbsp;<span class="ident" id="3714316">m1</span><span class="op" id="3714318">.</span><span class="ident" id="3714319">raw</span><span class="op" id="3714322">)</span>&nbsp;<span class="op" id="3714324">&amp;&amp;</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3714329">m</span><span class="op" id="3714330">.</span><span class="ident" id="3714331">hasSignatureAndHash</span>&nbsp;<span class="op" id="3714351">==</span>&nbsp;<span class="ident" id="3714354">m1</span><span class="op" id="3714356">.</span><span class="ident" id="3714357">hasSignatureAndHash</span>&nbsp;<span class="op" id="3714377">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3714382">m</span><span class="op" id="3714383">.</span><span class="ident" id="3714384">signatureAndHash</span><span class="op" id="3714400">.</span><span class="ident" id="3714401">hash</span>&nbsp;<span class="op" id="3714406">==</span>&nbsp;<span class="ident" id="3714409">m1</span><span class="op" id="3714411">.</span><span class="ident" id="3714412">signatureAndHash</span><span class="op" id="3714428">.</span><span class="ident" id="3714429">hash</span>&nbsp;<span class="op" id="3714434">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3714439">m</span><span class="op" id="3714440">.</span><span class="ident" id="3714441">signatureAndHash</span><span class="op" id="3714457">.</span><span class="ident" id="3714458">signature</span>&nbsp;<span class="op" id="3714468">==</span>&nbsp;<span class="ident" id="3714471">m1</span><span class="op" id="3714473">.</span><span class="ident" id="3714474">signatureAndHash</span><span class="op" id="3714490">.</span><span class="ident" id="3714491">signature</span>&nbsp;<span class="op" id="3714501">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3714506">bytes</span><span class="op" id="3714511">.</span><span class="ident" id="3714512">Equal</span><span class="op" id="3714517">(</span><span class="ident" id="3714518">m</span><span class="op" id="3714519">.</span><span class="ident" id="3714520">signature</span><span class="op" id="3714529">,</span>&nbsp;<span class="ident" id="3714531">m1</span><span class="op" id="3714533">.</span><span class="ident" id="3714534">signature</span><span class="op" id="3714543">)</span><br>
<span class="lineno"></span><span class="op" id="3714545">}</span><br>
<span class="lineno">1255</span><br>
<span class="lineno"></span><span class="keyword" id="3714548">func</span>&nbsp;<span class="op" id="3714553">(</span><span class="ident" id="3714554">m</span>&nbsp;<span class="op" id="3714556">*</span><span class="ident" id="3714557">certificateVerifyMsg</span><span class="op" id="3714577">)</span>&nbsp;<span class="ident" id="3714579">marshal</span><span class="op" id="3714586">(</span><span class="op" id="3714587">)</span>&nbsp;<span class="op" id="3714589">(</span><span class="ident" id="3714590">x</span>&nbsp;<span class="op" id="3714592">[</span><span class="op" id="3714593">]</span><span class="builtintype" id="3714594">byte</span><span class="op" id="3714598">)</span>&nbsp;<span class="op" id="3714600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3714603">if</span>&nbsp;<span class="ident" id="3714606">m</span><span class="op" id="3714607">.</span><span class="ident" id="3714608">raw</span>&nbsp;<span class="op" id="3714612">!=</span>&nbsp;<span class="ident" id="3714615">nil</span>&nbsp;<span class="op" id="3714619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3714623">return</span>&nbsp;<span class="ident" id="3714630">m</span><span class="op" id="3714631">.</span><span class="ident" id="3714632">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3714637">}</span><br>
<span class="lineno">1260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3714641">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc4346#section-7.4.8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3714698">siglength</span>&nbsp;<span class="op" id="3714708">:=</span>&nbsp;<span class="builtinfunc" id="3714711">len</span><span class="op" id="3714714">(</span><span class="ident" id="3714715">m</span><span class="op" id="3714716">.</span><span class="ident" id="3714717">signature</span><span class="op" id="3714726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3714729">length</span>&nbsp;<span class="op" id="3714736">:=</span>&nbsp;<span class="num" id="3714739">2</span>&nbsp;<span class="op" id="3714741">+</span>&nbsp;<span class="ident" id="3714743">siglength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3714754">if</span>&nbsp;<span class="ident" id="3714757">m</span><span class="op" id="3714758">.</span><span class="ident" id="3714759">hasSignatureAndHash</span>&nbsp;<span class="op" id="3714779">{</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3714783">length</span>&nbsp;<span class="op" id="3714790">+=</span>&nbsp;<span class="num" id="3714793">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3714796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3714799">x</span>&nbsp;<span class="op" id="3714801">=</span>&nbsp;<span class="builtinfunc" id="3714803">make</span><span class="op" id="3714807">(</span><span class="op" id="3714808">[</span><span class="op" id="3714809">]</span><span class="builtintype" id="3714810">byte</span><span class="op" id="3714814">,</span>&nbsp;<span class="num" id="3714816">4</span><span class="op" id="3714817">+</span><span class="ident" id="3714818">length</span><span class="op" id="3714824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3714827">x</span><span class="op" id="3714828">[</span><span class="num" id="3714829">0</span><span class="op" id="3714830">]</span>&nbsp;<span class="op" id="3714832">=</span>&nbsp;<span class="ident" id="3714834">typeCertificateVerify</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3714857">x</span><span class="op" id="3714858">[</span><span class="num" id="3714859">1</span><span class="op" id="3714860">]</span>&nbsp;<span class="op" id="3714862">=</span>&nbsp;<span class="builtintype" id="3714864">uint8</span><span class="op" id="3714869">(</span><span class="ident" id="3714870">length</span>&nbsp;<span class="op" id="3714877">&gt;&gt;</span>&nbsp;<span class="num" id="3714880">16</span><span class="op" id="3714882">)</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3714885">x</span><span class="op" id="3714886">[</span><span class="num" id="3714887">2</span><span class="op" id="3714888">]</span>&nbsp;<span class="op" id="3714890">=</span>&nbsp;<span class="builtintype" id="3714892">uint8</span><span class="op" id="3714897">(</span><span class="ident" id="3714898">length</span>&nbsp;<span class="op" id="3714905">&gt;&gt;</span>&nbsp;<span class="num" id="3714908">8</span><span class="op" id="3714909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3714912">x</span><span class="op" id="3714913">[</span><span class="num" id="3714914">3</span><span class="op" id="3714915">]</span>&nbsp;<span class="op" id="3714917">=</span>&nbsp;<span class="builtintype" id="3714919">uint8</span><span class="op" id="3714924">(</span><span class="ident" id="3714925">length</span><span class="op" id="3714931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3714934">y</span>&nbsp;<span class="op" id="3714936">:=</span>&nbsp;<span class="ident" id="3714939">x</span><span class="op" id="3714940">[</span><span class="num" id="3714941">4</span><span class="op" id="3714942">:</span><span class="op" id="3714943">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3714946">if</span>&nbsp;<span class="ident" id="3714949">m</span><span class="op" id="3714950">.</span><span class="ident" id="3714951">hasSignatureAndHash</span>&nbsp;<span class="op" id="3714971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3714975">y</span><span class="op" id="3714976">[</span><span class="num" id="3714977">0</span><span class="op" id="3714978">]</span>&nbsp;<span class="op" id="3714980">=</span>&nbsp;<span class="ident" id="3714982">m</span><span class="op" id="3714983">.</span><span class="ident" id="3714984">signatureAndHash</span><span class="op" id="3715000">.</span><span class="ident" id="3715001">hash</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715008">y</span><span class="op" id="3715009">[</span><span class="num" id="3715010">1</span><span class="op" id="3715011">]</span>&nbsp;<span class="op" id="3715013">=</span>&nbsp;<span class="ident" id="3715015">m</span><span class="op" id="3715016">.</span><span class="ident" id="3715017">signatureAndHash</span><span class="op" id="3715033">.</span><span class="ident" id="3715034">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715046">y</span>&nbsp;<span class="op" id="3715048">=</span>&nbsp;<span class="ident" id="3715050">y</span><span class="op" id="3715051">[</span><span class="num" id="3715052">2</span><span class="op" id="3715053">:</span><span class="op" id="3715054">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3715057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715060">y</span><span class="op" id="3715061">[</span><span class="num" id="3715062">0</span><span class="op" id="3715063">]</span>&nbsp;<span class="op" id="3715065">=</span>&nbsp;<span class="builtintype" id="3715067">uint8</span><span class="op" id="3715072">(</span><span class="ident" id="3715073">siglength</span>&nbsp;<span class="op" id="3715083">&gt;&gt;</span>&nbsp;<span class="num" id="3715086">8</span><span class="op" id="3715087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715090">y</span><span class="op" id="3715091">[</span><span class="num" id="3715092">1</span><span class="op" id="3715093">]</span>&nbsp;<span class="op" id="3715095">=</span>&nbsp;<span class="builtintype" id="3715097">uint8</span><span class="op" id="3715102">(</span><span class="ident" id="3715103">siglength</span><span class="op" id="3715112">)</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3715115">copy</span><span class="op" id="3715119">(</span><span class="ident" id="3715120">y</span><span class="op" id="3715121">[</span><span class="num" id="3715122">2</span><span class="op" id="3715123">:</span><span class="op" id="3715124">]</span><span class="op" id="3715125">,</span>&nbsp;<span class="ident" id="3715127">m</span><span class="op" id="3715128">.</span><span class="ident" id="3715129">signature</span><span class="op" id="3715138">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715142">m</span><span class="op" id="3715143">.</span><span class="ident" id="3715144">raw</span>&nbsp;<span class="op" id="3715148">=</span>&nbsp;<span class="ident" id="3715150">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3715154">return</span><br>
<span class="lineno">1285</span><span class="op" id="3715161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3715164">func</span>&nbsp;<span class="op" id="3715169">(</span><span class="ident" id="3715170">m</span>&nbsp;<span class="op" id="3715172">*</span><span class="ident" id="3715173">certificateVerifyMsg</span><span class="op" id="3715193">)</span>&nbsp;<span class="ident" id="3715195">unmarshal</span><span class="op" id="3715204">(</span><span class="ident" id="3715205">data</span>&nbsp;<span class="op" id="3715210">[</span><span class="op" id="3715211">]</span><span class="builtintype" id="3715212">byte</span><span class="op" id="3715216">)</span>&nbsp;<span class="builtintype" id="3715218">bool</span>&nbsp;<span class="op" id="3715223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715226">m</span><span class="op" id="3715227">.</span><span class="ident" id="3715228">raw</span>&nbsp;<span class="op" id="3715232">=</span>&nbsp;<span class="ident" id="3715234">data</span><br>
<span class="lineno"></span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3715241">if</span>&nbsp;<span class="builtinfunc" id="3715244">len</span><span class="op" id="3715247">(</span><span class="ident" id="3715248">data</span><span class="op" id="3715252">)</span>&nbsp;<span class="op" id="3715254">&lt;</span>&nbsp;<span class="num" id="3715256">6</span>&nbsp;<span class="op" id="3715258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3715262">return</span>&nbsp;<span class="builtintype" id="3715269">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3715276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715280">length</span>&nbsp;<span class="op" id="3715287">:=</span>&nbsp;<span class="builtintype" id="3715290">uint32</span><span class="op" id="3715296">(</span><span class="ident" id="3715297">data</span><span class="op" id="3715301">[</span><span class="num" id="3715302">1</span><span class="op" id="3715303">]</span><span class="op" id="3715304">)</span><span class="op" id="3715305">&lt;&lt;</span><span class="num" id="3715307">16</span>&nbsp;<span class="op" id="3715310">|</span>&nbsp;<span class="builtintype" id="3715312">uint32</span><span class="op" id="3715318">(</span><span class="ident" id="3715319">data</span><span class="op" id="3715323">[</span><span class="num" id="3715324">2</span><span class="op" id="3715325">]</span><span class="op" id="3715326">)</span><span class="op" id="3715327">&lt;&lt;</span><span class="num" id="3715329">8</span>&nbsp;<span class="op" id="3715331">|</span>&nbsp;<span class="builtintype" id="3715333">uint32</span><span class="op" id="3715339">(</span><span class="ident" id="3715340">data</span><span class="op" id="3715344">[</span><span class="num" id="3715345">3</span><span class="op" id="3715346">]</span><span class="op" id="3715347">)</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3715350">if</span>&nbsp;<span class="builtintype" id="3715353">uint32</span><span class="op" id="3715359">(</span><span class="builtinfunc" id="3715360">len</span><span class="op" id="3715363">(</span><span class="ident" id="3715364">data</span><span class="op" id="3715368">)</span><span class="op" id="3715369">)</span><span class="op" id="3715370">-</span><span class="num" id="3715371">4</span>&nbsp;<span class="op" id="3715373">!=</span>&nbsp;<span class="ident" id="3715376">length</span>&nbsp;<span class="op" id="3715383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3715387">return</span>&nbsp;<span class="builtintype" id="3715394">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3715401">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715405">data</span>&nbsp;<span class="op" id="3715410">=</span>&nbsp;<span class="ident" id="3715412">data</span><span class="op" id="3715416">[</span><span class="num" id="3715417">4</span><span class="op" id="3715418">:</span><span class="op" id="3715419">]</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3715422">if</span>&nbsp;<span class="ident" id="3715425">m</span><span class="op" id="3715426">.</span><span class="ident" id="3715427">hasSignatureAndHash</span>&nbsp;<span class="op" id="3715447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715451">m</span><span class="op" id="3715452">.</span><span class="ident" id="3715453">signatureAndHash</span><span class="op" id="3715469">.</span><span class="ident" id="3715470">hash</span>&nbsp;<span class="op" id="3715475">=</span>&nbsp;<span class="ident" id="3715477">data</span><span class="op" id="3715481">[</span><span class="num" id="3715482">0</span><span class="op" id="3715483">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715487">m</span><span class="op" id="3715488">.</span><span class="ident" id="3715489">signatureAndHash</span><span class="op" id="3715505">.</span><span class="ident" id="3715506">signature</span>&nbsp;<span class="op" id="3715516">=</span>&nbsp;<span class="ident" id="3715518">data</span><span class="op" id="3715522">[</span><span class="num" id="3715523">1</span><span class="op" id="3715524">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715528">data</span>&nbsp;<span class="op" id="3715533">=</span>&nbsp;<span class="ident" id="3715535">data</span><span class="op" id="3715539">[</span><span class="num" id="3715540">2</span><span class="op" id="3715541">:</span><span class="op" id="3715542">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3715545">}</span><br>
<span class="lineno">1305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3715549">if</span>&nbsp;<span class="builtinfunc" id="3715552">len</span><span class="op" id="3715555">(</span><span class="ident" id="3715556">data</span><span class="op" id="3715560">)</span>&nbsp;<span class="op" id="3715562">&lt;</span>&nbsp;<span class="num" id="3715564">2</span>&nbsp;<span class="op" id="3715566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3715570">return</span>&nbsp;<span class="builtintype" id="3715577">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3715584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715587">siglength</span>&nbsp;<span class="op" id="3715597">:=</span>&nbsp;<span class="builtintype" id="3715600">int</span><span class="op" id="3715603">(</span><span class="ident" id="3715604">data</span><span class="op" id="3715608">[</span><span class="num" id="3715609">0</span><span class="op" id="3715610">]</span><span class="op" id="3715611">)</span><span class="op" id="3715612">&lt;&lt;</span><span class="num" id="3715614">8</span>&nbsp;<span class="op" id="3715616">+</span>&nbsp;<span class="builtintype" id="3715618">int</span><span class="op" id="3715621">(</span><span class="ident" id="3715622">data</span><span class="op" id="3715626">[</span><span class="num" id="3715627">1</span><span class="op" id="3715628">]</span><span class="op" id="3715629">)</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715632">data</span>&nbsp;<span class="op" id="3715637">=</span>&nbsp;<span class="ident" id="3715639">data</span><span class="op" id="3715643">[</span><span class="num" id="3715644">2</span><span class="op" id="3715645">:</span><span class="op" id="3715646">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3715649">if</span>&nbsp;<span class="builtinfunc" id="3715652">len</span><span class="op" id="3715655">(</span><span class="ident" id="3715656">data</span><span class="op" id="3715660">)</span>&nbsp;<span class="op" id="3715662">!=</span>&nbsp;<span class="ident" id="3715665">siglength</span>&nbsp;<span class="op" id="3715675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3715679">return</span>&nbsp;<span class="builtintype" id="3715686">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3715693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715697">m</span><span class="op" id="3715698">.</span><span class="ident" id="3715699">signature</span>&nbsp;<span class="op" id="3715709">=</span>&nbsp;<span class="ident" id="3715711">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3715718">return</span>&nbsp;<span class="builtintype" id="3715725">true</span><br>
<span class="lineno"></span><span class="op" id="3715730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1320</span><span class="keyword" id="3715733">type</span>&nbsp;<span class="ident" id="3715738">newSessionTicketMsg</span>&nbsp;<span class="keyword" id="3715758">struct</span>&nbsp;<span class="op" id="3715765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715768">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3715775">[</span><span class="op" id="3715776">]</span><span class="builtintype" id="3715777">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715783">ticket</span>&nbsp;<span class="op" id="3715790">[</span><span class="op" id="3715791">]</span><span class="builtintype" id="3715792">byte</span><br>
<span class="lineno"></span><span class="op" id="3715797">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1325</span><span class="keyword" id="3715800">func</span>&nbsp;<span class="op" id="3715805">(</span><span class="ident" id="3715806">m</span>&nbsp;<span class="op" id="3715808">*</span><span class="ident" id="3715809">newSessionTicketMsg</span><span class="op" id="3715828">)</span>&nbsp;<span class="ident" id="3715830">equal</span><span class="op" id="3715835">(</span><span class="ident" id="3715836">i</span>&nbsp;<span class="keyword" id="3715838">interface</span><span class="op" id="3715847">{</span><span class="op" id="3715848">}</span><span class="op" id="3715849">)</span>&nbsp;<span class="builtintype" id="3715851">bool</span>&nbsp;<span class="op" id="3715856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715859">m1</span><span class="op" id="3715861">,</span>&nbsp;<span class="ident" id="3715863">ok</span>&nbsp;<span class="op" id="3715866">:=</span>&nbsp;<span class="ident" id="3715869">i</span><span class="op" id="3715870">.</span><span class="op" id="3715871">(</span><span class="op" id="3715872">*</span><span class="ident" id="3715873">newSessionTicketMsg</span><span class="op" id="3715892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3715895">if</span>&nbsp;<span class="op" id="3715898">!</span><span class="ident" id="3715899">ok</span>&nbsp;<span class="op" id="3715902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3715906">return</span>&nbsp;<span class="builtintype" id="3715913">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3715920">}</span><br>
<span class="lineno">1330</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3715924">return</span>&nbsp;<span class="ident" id="3715931">bytes</span><span class="op" id="3715936">.</span><span class="ident" id="3715937">Equal</span><span class="op" id="3715942">(</span><span class="ident" id="3715943">m</span><span class="op" id="3715944">.</span><span class="ident" id="3715945">raw</span><span class="op" id="3715948">,</span>&nbsp;<span class="ident" id="3715950">m1</span><span class="op" id="3715952">.</span><span class="ident" id="3715953">raw</span><span class="op" id="3715956">)</span>&nbsp;<span class="op" id="3715958">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3715963">bytes</span><span class="op" id="3715968">.</span><span class="ident" id="3715969">Equal</span><span class="op" id="3715974">(</span><span class="ident" id="3715975">m</span><span class="op" id="3715976">.</span><span class="ident" id="3715977">ticket</span><span class="op" id="3715983">,</span>&nbsp;<span class="ident" id="3715985">m1</span><span class="op" id="3715987">.</span><span class="ident" id="3715988">ticket</span><span class="op" id="3715994">)</span><br>
<span class="lineno"></span><span class="op" id="3715996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1335</span><span class="keyword" id="3715999">func</span>&nbsp;<span class="op" id="3716004">(</span><span class="ident" id="3716005">m</span>&nbsp;<span class="op" id="3716007">*</span><span class="ident" id="3716008">newSessionTicketMsg</span><span class="op" id="3716027">)</span>&nbsp;<span class="ident" id="3716029">marshal</span><span class="op" id="3716036">(</span><span class="op" id="3716037">)</span>&nbsp;<span class="op" id="3716039">(</span><span class="ident" id="3716040">x</span>&nbsp;<span class="op" id="3716042">[</span><span class="op" id="3716043">]</span><span class="builtintype" id="3716044">byte</span><span class="op" id="3716048">)</span>&nbsp;<span class="op" id="3716050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3716053">if</span>&nbsp;<span class="ident" id="3716056">m</span><span class="op" id="3716057">.</span><span class="ident" id="3716058">raw</span>&nbsp;<span class="op" id="3716062">!=</span>&nbsp;<span class="ident" id="3716065">nil</span>&nbsp;<span class="op" id="3716069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3716073">return</span>&nbsp;<span class="ident" id="3716080">m</span><span class="op" id="3716081">.</span><span class="ident" id="3716082">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3716087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3716091">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc5077#section-3.3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3716146">ticketLen</span>&nbsp;<span class="op" id="3716156">:=</span>&nbsp;<span class="builtinfunc" id="3716159">len</span><span class="op" id="3716162">(</span><span class="ident" id="3716163">m</span><span class="op" id="3716164">.</span><span class="ident" id="3716165">ticket</span><span class="op" id="3716171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3716174">length</span>&nbsp;<span class="op" id="3716181">:=</span>&nbsp;<span class="num" id="3716184">2</span>&nbsp;<span class="op" id="3716186">+</span>&nbsp;<span class="num" id="3716188">4</span>&nbsp;<span class="op" id="3716190">+</span>&nbsp;<span class="ident" id="3716192">ticketLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3716203">x</span>&nbsp;<span class="op" id="3716205">=</span>&nbsp;<span class="builtinfunc" id="3716207">make</span><span class="op" id="3716211">(</span><span class="op" id="3716212">[</span><span class="op" id="3716213">]</span><span class="builtintype" id="3716214">byte</span><span class="op" id="3716218">,</span>&nbsp;<span class="num" id="3716220">4</span><span class="op" id="3716221">+</span><span class="ident" id="3716222">length</span><span class="op" id="3716228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3716231">x</span><span class="op" id="3716232">[</span><span class="num" id="3716233">0</span><span class="op" id="3716234">]</span>&nbsp;<span class="op" id="3716236">=</span>&nbsp;<span class="ident" id="3716238">typeNewSessionTicket</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3716260">x</span><span class="op" id="3716261">[</span><span class="num" id="3716262">1</span><span class="op" id="3716263">]</span>&nbsp;<span class="op" id="3716265">=</span>&nbsp;<span class="builtintype" id="3716267">uint8</span><span class="op" id="3716272">(</span><span class="ident" id="3716273">length</span>&nbsp;<span class="op" id="3716280">&gt;&gt;</span>&nbsp;<span class="num" id="3716283">16</span><span class="op" id="3716285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3716288">x</span><span class="op" id="3716289">[</span><span class="num" id="3716290">2</span><span class="op" id="3716291">]</span>&nbsp;<span class="op" id="3716293">=</span>&nbsp;<span class="builtintype" id="3716295">uint8</span><span class="op" id="3716300">(</span><span class="ident" id="3716301">length</span>&nbsp;<span class="op" id="3716308">&gt;&gt;</span>&nbsp;<span class="num" id="3716311">8</span><span class="op" id="3716312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3716315">x</span><span class="op" id="3716316">[</span><span class="num" id="3716317">3</span><span class="op" id="3716318">]</span>&nbsp;<span class="op" id="3716320">=</span>&nbsp;<span class="builtintype" id="3716322">uint8</span><span class="op" id="3716327">(</span><span class="ident" id="3716328">length</span><span class="op" id="3716334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3716337">x</span><span class="op" id="3716338">[</span><span class="num" id="3716339">8</span><span class="op" id="3716340">]</span>&nbsp;<span class="op" id="3716342">=</span>&nbsp;<span class="builtintype" id="3716344">uint8</span><span class="op" id="3716349">(</span><span class="ident" id="3716350">ticketLen</span>&nbsp;<span class="op" id="3716360">&gt;&gt;</span>&nbsp;<span class="num" id="3716363">8</span><span class="op" id="3716364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3716367">x</span><span class="op" id="3716368">[</span><span class="num" id="3716369">9</span><span class="op" id="3716370">]</span>&nbsp;<span class="op" id="3716372">=</span>&nbsp;<span class="builtintype" id="3716374">uint8</span><span class="op" id="3716379">(</span><span class="ident" id="3716380">ticketLen</span><span class="op" id="3716389">)</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3716392">copy</span><span class="op" id="3716396">(</span><span class="ident" id="3716397">x</span><span class="op" id="3716398">[</span><span class="num" id="3716399">10</span><span class="op" id="3716401">:</span><span class="op" id="3716402">]</span><span class="op" id="3716403">,</span>&nbsp;<span class="ident" id="3716405">m</span><span class="op" id="3716406">.</span><span class="ident" id="3716407">ticket</span><span class="op" id="3716413">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3716417">m</span><span class="op" id="3716418">.</span><span class="ident" id="3716419">raw</span>&nbsp;<span class="op" id="3716423">=</span>&nbsp;<span class="ident" id="3716425">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3716429">return</span><br>
<span class="lineno">1355</span><span class="op" id="3716436">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3716439">func</span>&nbsp;<span class="op" id="3716444">(</span><span class="ident" id="3716445">m</span>&nbsp;<span class="op" id="3716447">*</span><span class="ident" id="3716448">newSessionTicketMsg</span><span class="op" id="3716467">)</span>&nbsp;<span class="ident" id="3716469">unmarshal</span><span class="op" id="3716478">(</span><span class="ident" id="3716479">data</span>&nbsp;<span class="op" id="3716484">[</span><span class="op" id="3716485">]</span><span class="builtintype" id="3716486">byte</span><span class="op" id="3716490">)</span>&nbsp;<span class="builtintype" id="3716492">bool</span>&nbsp;<span class="op" id="3716497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3716500">m</span><span class="op" id="3716501">.</span><span class="ident" id="3716502">raw</span>&nbsp;<span class="op" id="3716506">=</span>&nbsp;<span class="ident" id="3716508">data</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3716515">if</span>&nbsp;<span class="builtinfunc" id="3716518">len</span><span class="op" id="3716521">(</span><span class="ident" id="3716522">data</span><span class="op" id="3716526">)</span>&nbsp;<span class="op" id="3716528">&lt;</span>&nbsp;<span class="num" id="3716530">10</span>&nbsp;<span class="op" id="3716533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3716537">return</span>&nbsp;<span class="builtintype" id="3716544">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3716551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3716555">length</span>&nbsp;<span class="op" id="3716562">:=</span>&nbsp;<span class="builtintype" id="3716565">uint32</span><span class="op" id="3716571">(</span><span class="ident" id="3716572">data</span><span class="op" id="3716576">[</span><span class="num" id="3716577">1</span><span class="op" id="3716578">]</span><span class="op" id="3716579">)</span><span class="op" id="3716580">&lt;&lt;</span><span class="num" id="3716582">16</span>&nbsp;<span class="op" id="3716585">|</span>&nbsp;<span class="builtintype" id="3716587">uint32</span><span class="op" id="3716593">(</span><span class="ident" id="3716594">data</span><span class="op" id="3716598">[</span><span class="num" id="3716599">2</span><span class="op" id="3716600">]</span><span class="op" id="3716601">)</span><span class="op" id="3716602">&lt;&lt;</span><span class="num" id="3716604">8</span>&nbsp;<span class="op" id="3716606">|</span>&nbsp;<span class="builtintype" id="3716608">uint32</span><span class="op" id="3716614">(</span><span class="ident" id="3716615">data</span><span class="op" id="3716619">[</span><span class="num" id="3716620">3</span><span class="op" id="3716621">]</span><span class="op" id="3716622">)</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3716625">if</span>&nbsp;<span class="builtintype" id="3716628">uint32</span><span class="op" id="3716634">(</span><span class="builtinfunc" id="3716635">len</span><span class="op" id="3716638">(</span><span class="ident" id="3716639">data</span><span class="op" id="3716643">)</span><span class="op" id="3716644">)</span><span class="op" id="3716645">-</span><span class="num" id="3716646">4</span>&nbsp;<span class="op" id="3716648">!=</span>&nbsp;<span class="ident" id="3716651">length</span>&nbsp;<span class="op" id="3716658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3716662">return</span>&nbsp;<span class="builtintype" id="3716669">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3716676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3716680">ticketLen</span>&nbsp;<span class="op" id="3716690">:=</span>&nbsp;<span class="builtintype" id="3716693">int</span><span class="op" id="3716696">(</span><span class="ident" id="3716697">data</span><span class="op" id="3716701">[</span><span class="num" id="3716702">8</span><span class="op" id="3716703">]</span><span class="op" id="3716704">)</span><span class="op" id="3716705">&lt;&lt;</span><span class="num" id="3716707">8</span>&nbsp;<span class="op" id="3716709">+</span>&nbsp;<span class="builtintype" id="3716711">int</span><span class="op" id="3716714">(</span><span class="ident" id="3716715">data</span><span class="op" id="3716719">[</span><span class="num" id="3716720">9</span><span class="op" id="3716721">]</span><span class="op" id="3716722">)</span><br>
<span class="lineno">1370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3716725">if</span>&nbsp;<span class="builtinfunc" id="3716728">len</span><span class="op" id="3716731">(</span><span class="ident" id="3716732">data</span><span class="op" id="3716736">)</span><span class="op" id="3716737">-</span><span class="num" id="3716738">10</span>&nbsp;<span class="op" id="3716741">!=</span>&nbsp;<span class="ident" id="3716744">ticketLen</span>&nbsp;<span class="op" id="3716754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3716758">return</span>&nbsp;<span class="builtintype" id="3716765">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3716772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3716776">m</span><span class="op" id="3716777">.</span><span class="ident" id="3716778">ticket</span>&nbsp;<span class="op" id="3716785">=</span>&nbsp;<span class="ident" id="3716787">data</span><span class="op" id="3716791">[</span><span class="num" id="3716792">10</span><span class="op" id="3716794">:</span><span class="op" id="3716795">]</span><br>
<span class="lineno">1375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3716799">return</span>&nbsp;<span class="builtintype" id="3716806">true</span><br>
<span class="lineno"></span><span class="op" id="3716811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3716814">func</span>&nbsp;<span class="ident" id="3716819">eqUint16s</span><span class="op" id="3716828">(</span><span class="ident" id="3716829">x</span><span class="op" id="3716830">,</span>&nbsp;<span class="ident" id="3716832">y</span>&nbsp;<span class="op" id="3716834">[</span><span class="op" id="3716835">]</span><span class="builtintype" id="3716836">uint16</span><span class="op" id="3716842">)</span>&nbsp;<span class="builtintype" id="3716844">bool</span>&nbsp;<span class="op" id="3716849">{</span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3716852">if</span>&nbsp;<span class="builtinfunc" id="3716855">len</span><span class="op" id="3716858">(</span><span class="ident" id="3716859">x</span><span class="op" id="3716860">)</span>&nbsp;<span class="op" id="3716862">!=</span>&nbsp;<span class="builtinfunc" id="3716865">len</span><span class="op" id="3716868">(</span><span class="ident" id="3716869">y</span><span class="op" id="3716870">)</span>&nbsp;<span class="op" id="3716872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3716876">return</span>&nbsp;<span class="builtintype" id="3716883">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3716890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3716893">for</span>&nbsp;<span class="ident" id="3716897">i</span><span class="op" id="3716898">,</span>&nbsp;<span class="ident" id="3716900">v</span>&nbsp;<span class="op" id="3716902">:=</span>&nbsp;<span class="keyword" id="3716905">range</span>&nbsp;<span class="ident" id="3716911">x</span>&nbsp;<span class="op" id="3716913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3716917">if</span>&nbsp;<span class="ident" id="3716920">y</span><span class="op" id="3716921">[</span><span class="ident" id="3716922">i</span><span class="op" id="3716923">]</span>&nbsp;<span class="op" id="3716925">!=</span>&nbsp;<span class="ident" id="3716928">v</span>&nbsp;<span class="op" id="3716930">{</span><br>
<span class="lineno">1385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3716935">return</span>&nbsp;<span class="builtintype" id="3716942">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3716950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3716953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3716956">return</span>&nbsp;<span class="builtintype" id="3716963">true</span><br>
<span class="lineno"></span><span class="op" id="3716968">}</span><br>
<span class="lineno">1390</span><br>
<span class="lineno"></span><span class="keyword" id="3716971">func</span>&nbsp;<span class="ident" id="3716976">eqCurveIDs</span><span class="op" id="3716986">(</span><span class="ident" id="3716987">x</span><span class="op" id="3716988">,</span>&nbsp;<span class="ident" id="3716990">y</span>&nbsp;<span class="op" id="3716992">[</span><span class="op" id="3716993">]</span><span class="ident" id="3716994">CurveID</span><span class="op" id="3717001">)</span>&nbsp;<span class="builtintype" id="3717003">bool</span>&nbsp;<span class="op" id="3717008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717011">if</span>&nbsp;<span class="builtinfunc" id="3717014">len</span><span class="op" id="3717017">(</span><span class="ident" id="3717018">x</span><span class="op" id="3717019">)</span>&nbsp;<span class="op" id="3717021">!=</span>&nbsp;<span class="builtinfunc" id="3717024">len</span><span class="op" id="3717027">(</span><span class="ident" id="3717028">y</span><span class="op" id="3717029">)</span>&nbsp;<span class="op" id="3717031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717035">return</span>&nbsp;<span class="builtintype" id="3717042">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3717049">}</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717052">for</span>&nbsp;<span class="ident" id="3717056">i</span><span class="op" id="3717057">,</span>&nbsp;<span class="ident" id="3717059">v</span>&nbsp;<span class="op" id="3717061">:=</span>&nbsp;<span class="keyword" id="3717064">range</span>&nbsp;<span class="ident" id="3717070">x</span>&nbsp;<span class="op" id="3717072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717076">if</span>&nbsp;<span class="ident" id="3717079">y</span><span class="op" id="3717080">[</span><span class="ident" id="3717081">i</span><span class="op" id="3717082">]</span>&nbsp;<span class="op" id="3717084">!=</span>&nbsp;<span class="ident" id="3717087">v</span>&nbsp;<span class="op" id="3717089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717094">return</span>&nbsp;<span class="builtintype" id="3717101">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3717109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3717112">}</span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717115">return</span>&nbsp;<span class="builtintype" id="3717122">true</span><br>
<span class="lineno"></span><span class="op" id="3717127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3717130">func</span>&nbsp;<span class="ident" id="3717135">eqStrings</span><span class="op" id="3717144">(</span><span class="ident" id="3717145">x</span><span class="op" id="3717146">,</span>&nbsp;<span class="ident" id="3717148">y</span>&nbsp;<span class="op" id="3717150">[</span><span class="op" id="3717151">]</span><span class="builtintype" id="3717152">string</span><span class="op" id="3717158">)</span>&nbsp;<span class="builtintype" id="3717160">bool</span>&nbsp;<span class="op" id="3717165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717168">if</span>&nbsp;<span class="builtinfunc" id="3717171">len</span><span class="op" id="3717174">(</span><span class="ident" id="3717175">x</span><span class="op" id="3717176">)</span>&nbsp;<span class="op" id="3717178">!=</span>&nbsp;<span class="builtinfunc" id="3717181">len</span><span class="op" id="3717184">(</span><span class="ident" id="3717185">y</span><span class="op" id="3717186">)</span>&nbsp;<span class="op" id="3717188">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717192">return</span>&nbsp;<span class="builtintype" id="3717199">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3717206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717209">for</span>&nbsp;<span class="ident" id="3717213">i</span><span class="op" id="3717214">,</span>&nbsp;<span class="ident" id="3717216">v</span>&nbsp;<span class="op" id="3717218">:=</span>&nbsp;<span class="keyword" id="3717221">range</span>&nbsp;<span class="ident" id="3717227">x</span>&nbsp;<span class="op" id="3717229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717233">if</span>&nbsp;<span class="ident" id="3717236">y</span><span class="op" id="3717237">[</span><span class="ident" id="3717238">i</span><span class="op" id="3717239">]</span>&nbsp;<span class="op" id="3717241">!=</span>&nbsp;<span class="ident" id="3717244">v</span>&nbsp;<span class="op" id="3717246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717251">return</span>&nbsp;<span class="builtintype" id="3717258">false</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3717266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3717269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717272">return</span>&nbsp;<span class="builtintype" id="3717279">true</span><br>
<span class="lineno"></span><span class="op" id="3717284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1415</span><span class="keyword" id="3717287">func</span>&nbsp;<span class="ident" id="3717292">eqByteSlices</span><span class="op" id="3717304">(</span><span class="ident" id="3717305">x</span><span class="op" id="3717306">,</span>&nbsp;<span class="ident" id="3717308">y</span>&nbsp;<span class="op" id="3717310">[</span><span class="op" id="3717311">]</span><span class="op" id="3717312">[</span><span class="op" id="3717313">]</span><span class="builtintype" id="3717314">byte</span><span class="op" id="3717318">)</span>&nbsp;<span class="builtintype" id="3717320">bool</span>&nbsp;<span class="op" id="3717325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717328">if</span>&nbsp;<span class="builtinfunc" id="3717331">len</span><span class="op" id="3717334">(</span><span class="ident" id="3717335">x</span><span class="op" id="3717336">)</span>&nbsp;<span class="op" id="3717338">!=</span>&nbsp;<span class="builtinfunc" id="3717341">len</span><span class="op" id="3717344">(</span><span class="ident" id="3717345">y</span><span class="op" id="3717346">)</span>&nbsp;<span class="op" id="3717348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717352">return</span>&nbsp;<span class="builtintype" id="3717359">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3717366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717369">for</span>&nbsp;<span class="ident" id="3717373">i</span><span class="op" id="3717374">,</span>&nbsp;<span class="ident" id="3717376">v</span>&nbsp;<span class="op" id="3717378">:=</span>&nbsp;<span class="keyword" id="3717381">range</span>&nbsp;<span class="ident" id="3717387">x</span>&nbsp;<span class="op" id="3717389">{</span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717393">if</span>&nbsp;<span class="op" id="3717396">!</span><span class="ident" id="3717397">bytes</span><span class="op" id="3717402">.</span><span class="ident" id="3717403">Equal</span><span class="op" id="3717408">(</span><span class="ident" id="3717409">v</span><span class="op" id="3717410">,</span>&nbsp;<span class="ident" id="3717412">y</span><span class="op" id="3717413">[</span><span class="ident" id="3717414">i</span><span class="op" id="3717415">]</span><span class="op" id="3717416">)</span>&nbsp;<span class="op" id="3717418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717423">return</span>&nbsp;<span class="builtintype" id="3717430">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3717438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3717441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717444">return</span>&nbsp;<span class="builtintype" id="3717451">true</span><br>
<span class="lineno">1425</span><span class="op" id="3717456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3717459">func</span>&nbsp;<span class="ident" id="3717464">eqSignatureAndHashes</span><span class="op" id="3717484">(</span><span class="ident" id="3717485">x</span><span class="op" id="3717486">,</span>&nbsp;<span class="ident" id="3717488">y</span>&nbsp;<span class="op" id="3717490">[</span><span class="op" id="3717491">]</span><span class="ident" id="3717492">signatureAndHash</span><span class="op" id="3717508">)</span>&nbsp;<span class="builtintype" id="3717510">bool</span>&nbsp;<span class="op" id="3717515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717518">if</span>&nbsp;<span class="builtinfunc" id="3717521">len</span><span class="op" id="3717524">(</span><span class="ident" id="3717525">x</span><span class="op" id="3717526">)</span>&nbsp;<span class="op" id="3717528">!=</span>&nbsp;<span class="builtinfunc" id="3717531">len</span><span class="op" id="3717534">(</span><span class="ident" id="3717535">y</span><span class="op" id="3717536">)</span>&nbsp;<span class="op" id="3717538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717542">return</span>&nbsp;<span class="builtintype" id="3717549">false</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3717556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717559">for</span>&nbsp;<span class="ident" id="3717563">i</span><span class="op" id="3717564">,</span>&nbsp;<span class="ident" id="3717566">v</span>&nbsp;<span class="op" id="3717568">:=</span>&nbsp;<span class="keyword" id="3717571">range</span>&nbsp;<span class="ident" id="3717577">x</span>&nbsp;<span class="op" id="3717579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3717583">v2</span>&nbsp;<span class="op" id="3717586">:=</span>&nbsp;<span class="ident" id="3717589">y</span><span class="op" id="3717590">[</span><span class="ident" id="3717591">i</span><span class="op" id="3717592">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717596">if</span>&nbsp;<span class="ident" id="3717599">v</span><span class="op" id="3717600">.</span><span class="ident" id="3717601">hash</span>&nbsp;<span class="op" id="3717606">!=</span>&nbsp;<span class="ident" id="3717609">v2</span><span class="op" id="3717611">.</span><span class="ident" id="3717612">hash</span>&nbsp;<span class="op" id="3717617">||</span>&nbsp;<span class="ident" id="3717620">v</span><span class="op" id="3717621">.</span><span class="ident" id="3717622">signature</span>&nbsp;<span class="op" id="3717632">!=</span>&nbsp;<span class="ident" id="3717635">v2</span><span class="op" id="3717637">.</span><span class="ident" id="3717638">signature</span>&nbsp;<span class="op" id="3717648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717653">return</span>&nbsp;<span class="builtintype" id="3717660">false</span><br>
<span class="lineno">1435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3717668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3717671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3717674">return</span>&nbsp;<span class="builtintype" id="3717681">true</span><br>
<span class="lineno"></span><span class="op" id="3717686">}</span>
</div>
</body>
</html>
