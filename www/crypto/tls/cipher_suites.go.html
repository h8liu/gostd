<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4098312">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4098367">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4098421">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4098472">package</span>&nbsp;<span class="ident" id="4098480">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4098485">import</span>&nbsp;<span class="op" id="4098492">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4098495">&#34;crypto/aes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4098509">&#34;crypto/cipher&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4098526">&#34;crypto/des&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4098540">&#34;crypto/hmac&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4098555">&#34;crypto/rc4&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4098569">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4098584">&#34;crypto/x509&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4098599">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4098606">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4098609">//&nbsp;a&nbsp;keyAgreement&nbsp;implements&nbsp;the&nbsp;client&nbsp;and&nbsp;server&nbsp;side&nbsp;of&nbsp;a&nbsp;TLS&nbsp;key&nbsp;agreement</span><br>
<span class="lineno"></span><span class="comment" id="4098688">//&nbsp;protocol&nbsp;by&nbsp;generating&nbsp;and&nbsp;processing&nbsp;key&nbsp;exchange&nbsp;messages.</span><br>
<span class="lineno">20</span><span class="keyword" id="4098752">type</span>&nbsp;<span class="ident" id="4098757">keyAgreement</span>&nbsp;<span class="keyword" id="4098770">interface</span>&nbsp;<span class="op" id="4098780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4098783">//&nbsp;On&nbsp;the&nbsp;server&nbsp;side,&nbsp;the&nbsp;first&nbsp;two&nbsp;methods&nbsp;are&nbsp;called&nbsp;in&nbsp;order.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4098851">//&nbsp;In&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;key&nbsp;agreement&nbsp;protocol&nbsp;doesn&#39;t&nbsp;use&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4098913">//&nbsp;ServerKeyExchange&nbsp;message,&nbsp;generateServerKeyExchange&nbsp;can&nbsp;return&nbsp;nil,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4098986">//&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4098995">generateServerKeyExchange</span><span class="op" id="4099020">(</span><span class="op" id="4099021">*</span><span class="ident" id="4099022"><a href="/crypto/tls/common.go.html#4116177">Config</a></span><span class="op" id="4099028">,</span>&nbsp;<span class="op" id="4099030">*</span><span class="ident" id="4099031"><a href="/crypto/tls/common.go.html#4123683">Certificate</a></span><span class="op" id="4099042">,</span>&nbsp;<span class="op" id="4099044">*</span><span class="ident" id="4099045"><a href="/crypto/tls/handshake_messages.go.html#4173962">clientHelloMsg</a></span><span class="op" id="4099059">,</span>&nbsp;<span class="op" id="4099061">*</span><span class="ident" id="4099062"><a href="/crypto/tls/handshake_messages.go.html#4185078">serverHelloMsg</a></span><span class="op" id="4099076">)</span>&nbsp;<span class="op" id="4099078">(</span><span class="op" id="4099079">*</span><span class="ident" id="4099080"><a href="/crypto/tls/handshake_messages.go.html#4192159">serverKeyExchangeMsg</a></span><span class="op" id="4099100">,</span>&nbsp;<span class="builtintype" id="4099102">error</span><span class="op" id="4099107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4099110">processClientKeyExchange</span><span class="op" id="4099134">(</span><span class="op" id="4099135">*</span><span class="ident" id="4099136"><a href="/crypto/tls/common.go.html#4116177">Config</a></span><span class="op" id="4099142">,</span>&nbsp;<span class="op" id="4099144">*</span><span class="ident" id="4099145"><a href="/crypto/tls/common.go.html#4123683">Certificate</a></span><span class="op" id="4099156">,</span>&nbsp;<span class="op" id="4099158">*</span><span class="ident" id="4099159"><a href="/crypto/tls/handshake_messages.go.html#4194449">clientKeyExchangeMsg</a></span><span class="op" id="4099179">,</span>&nbsp;<span class="builtintype" id="4099181">uint16</span><span class="op" id="4099187">)</span>&nbsp;<span class="op" id="4099189">(</span><span class="op" id="4099190">[</span><span class="op" id="4099191">]</span><span class="builtintype" id="4099192">byte</span><span class="op" id="4099196">,</span>&nbsp;<span class="builtintype" id="4099198">error</span><span class="op" id="4099203">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4099207">//&nbsp;On&nbsp;the&nbsp;client&nbsp;side,&nbsp;the&nbsp;next&nbsp;two&nbsp;methods&nbsp;are&nbsp;called&nbsp;in&nbsp;order.</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4099274">//&nbsp;This&nbsp;method&nbsp;may&nbsp;not&nbsp;be&nbsp;called&nbsp;if&nbsp;the&nbsp;server&nbsp;doesn&#39;t&nbsp;send&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4099337">//&nbsp;ServerKeyExchange&nbsp;message.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4099368">processServerKeyExchange</span><span class="op" id="4099392">(</span><span class="op" id="4099393">*</span><span class="ident" id="4099394"><a href="/crypto/tls/common.go.html#4116177">Config</a></span><span class="op" id="4099400">,</span>&nbsp;<span class="op" id="4099402">*</span><span class="ident" id="4099403"><a href="/crypto/tls/handshake_messages.go.html#4173962">clientHelloMsg</a></span><span class="op" id="4099417">,</span>&nbsp;<span class="op" id="4099419">*</span><span class="ident" id="4099420"><a href="/crypto/tls/handshake_messages.go.html#4185078">serverHelloMsg</a></span><span class="op" id="4099434">,</span>&nbsp;<span class="op" id="4099436">*</span><span class="ident" id="4099437"><a href="/crypto/tls/cipher_suites.go.html#4098584">x509</a></span><span class="op" id="4099441">.</span><span class="ident" id="4099442">Certificate</span><span class="op" id="4099453">,</span>&nbsp;<span class="op" id="4099455">*</span><span class="ident" id="4099456"><a href="/crypto/tls/handshake_messages.go.html#4192159">serverKeyExchangeMsg</a></span><span class="op" id="4099476">)</span>&nbsp;<span class="builtintype" id="4099478">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4099485">generateClientKeyExchange</span><span class="op" id="4099510">(</span><span class="op" id="4099511">*</span><span class="ident" id="4099512"><a href="/crypto/tls/common.go.html#4116177">Config</a></span><span class="op" id="4099518">,</span>&nbsp;<span class="op" id="4099520">*</span><span class="ident" id="4099521"><a href="/crypto/tls/handshake_messages.go.html#4173962">clientHelloMsg</a></span><span class="op" id="4099535">,</span>&nbsp;<span class="op" id="4099537">*</span><span class="ident" id="4099538"><a href="/crypto/tls/cipher_suites.go.html#4098584">x509</a></span><span class="op" id="4099542">.</span><span class="ident" id="4099543">Certificate</span><span class="op" id="4099554">)</span>&nbsp;<span class="op" id="4099556">(</span><span class="op" id="4099557">[</span><span class="op" id="4099558">]</span><span class="builtintype" id="4099559">byte</span><span class="op" id="4099563">,</span>&nbsp;<span class="op" id="4099565">*</span><span class="ident" id="4099566"><a href="/crypto/tls/handshake_messages.go.html#4194449">clientKeyExchangeMsg</a></span><span class="op" id="4099586">,</span>&nbsp;<span class="builtintype" id="4099588">error</span><span class="op" id="4099593">)</span><br>
<span class="lineno">35</span><span class="op" id="4099595">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4099598">const</span>&nbsp;<span class="op" id="4099604">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4099607">//&nbsp;suiteECDH&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;involves&nbsp;elliptic&nbsp;curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4099677">//&nbsp;Diffie-Hellman.&nbsp;This&nbsp;means&nbsp;that&nbsp;it&nbsp;should&nbsp;only&nbsp;be&nbsp;selected&nbsp;when&nbsp;the</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4099749">//&nbsp;client&nbsp;indicates&nbsp;that&nbsp;it&nbsp;supports&nbsp;ECC&nbsp;with&nbsp;a&nbsp;curve&nbsp;and&nbsp;point&nbsp;format</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4099821">//&nbsp;that&nbsp;we&#39;re&nbsp;happy&nbsp;with.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4099848">suiteECDHE</span>&nbsp;<span class="op" id="4099859">=</span>&nbsp;<span class="num" id="4099861">1</span>&nbsp;<span class="op" id="4099863">&lt;&lt;</span>&nbsp;<span class="ident" id="4099866">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4099872">//&nbsp;suiteECDSA&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;involves&nbsp;an&nbsp;ECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4099937">//&nbsp;signature&nbsp;and&nbsp;therefore&nbsp;may&nbsp;only&nbsp;be&nbsp;selected&nbsp;when&nbsp;the&nbsp;server&#39;s</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4100004">//&nbsp;certificate&nbsp;is&nbsp;ECDSA.&nbsp;If&nbsp;this&nbsp;is&nbsp;not&nbsp;set&nbsp;then&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4100074">//&nbsp;RSA&nbsp;based.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100089">suiteECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4100101">//&nbsp;suiteTLS12&nbsp;indicates&nbsp;that&nbsp;the&nbsp;cipher&nbsp;suite&nbsp;should&nbsp;only&nbsp;be&nbsp;advertised</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4100174">//&nbsp;and&nbsp;accepted&nbsp;when&nbsp;using&nbsp;TLS&nbsp;1.2.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100211">suiteTLS12</span><br>
<span class="lineno"></span><span class="op" id="4100222">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4100225">//&nbsp;A&nbsp;cipherSuite&nbsp;is&nbsp;a&nbsp;specific&nbsp;combination&nbsp;of&nbsp;key&nbsp;agreement,&nbsp;cipher&nbsp;and&nbsp;MAC</span><br>
<span class="lineno"></span><span class="comment" id="4100301">//&nbsp;function.&nbsp;All&nbsp;cipher&nbsp;suites&nbsp;currently&nbsp;assume&nbsp;RSA&nbsp;key&nbsp;agreement.</span><br>
<span class="lineno">55</span><span class="keyword" id="4100368">type</span>&nbsp;<span class="ident" id="4100373">cipherSuite</span>&nbsp;<span class="keyword" id="4100385">struct</span>&nbsp;<span class="op" id="4100392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100395">id</span>&nbsp;<span class="builtintype" id="4100398">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4100406">//&nbsp;the&nbsp;lengths,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;the&nbsp;key&nbsp;material&nbsp;needed&nbsp;for&nbsp;each&nbsp;component.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100480">keyLen</span>&nbsp;<span class="builtintype" id="4100487">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100492">macLen</span>&nbsp;<span class="builtintype" id="4100499">int</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100504">ivLen</span>&nbsp;&nbsp;<span class="builtintype" id="4100511">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100516">ka</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100523">func</span><span class="op" id="4100527">(</span><span class="ident" id="4100528">version</span>&nbsp;<span class="builtintype" id="4100536">uint16</span><span class="op" id="4100542">)</span>&nbsp;<span class="ident" id="4100544"><a href="/crypto/tls/cipher_suites.go.html#4098757">keyAgreement</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4100558">//&nbsp;flags&nbsp;is&nbsp;a&nbsp;bitmask&nbsp;of&nbsp;the&nbsp;suite*&nbsp;values,&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100610">flags</span>&nbsp;&nbsp;<span class="builtintype" id="4100617">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100622">cipher</span>&nbsp;<span class="keyword" id="4100629">func</span><span class="op" id="4100633">(</span><span class="ident" id="4100634">key</span><span class="op" id="4100637">,</span>&nbsp;<span class="ident" id="4100639">iv</span>&nbsp;<span class="op" id="4100642">[</span><span class="op" id="4100643">]</span><span class="builtintype" id="4100644">byte</span><span class="op" id="4100648">,</span>&nbsp;<span class="ident" id="4100650">isRead</span>&nbsp;<span class="builtintype" id="4100657">bool</span><span class="op" id="4100661">)</span>&nbsp;<span class="keyword" id="4100663">interface</span><span class="op" id="4100672">{</span><span class="op" id="4100673">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100676">mac</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100683">func</span><span class="op" id="4100687">(</span><span class="ident" id="4100688">version</span>&nbsp;<span class="builtintype" id="4100696">uint16</span><span class="op" id="4100702">,</span>&nbsp;<span class="ident" id="4100704">macKey</span>&nbsp;<span class="op" id="4100711">[</span><span class="op" id="4100712">]</span><span class="builtintype" id="4100713">byte</span><span class="op" id="4100717">)</span>&nbsp;<span class="ident" id="4100719"><a href="/crypto/tls/cipher_suites.go.html#4103068">macFunction</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100732">aead</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="4100739">func</span><span class="op" id="4100743">(</span><span class="ident" id="4100744">key</span><span class="op" id="4100747">,</span>&nbsp;<span class="ident" id="4100749">fixedNonce</span>&nbsp;<span class="op" id="4100760">[</span><span class="op" id="4100761">]</span><span class="builtintype" id="4100762">byte</span><span class="op" id="4100766">)</span>&nbsp;<span class="ident" id="4100768"><a href="/crypto/tls/cipher_suites.go.html#4098509">cipher</a></span><span class="op" id="4100774">.</span><span class="ident" id="4100775">AEAD</span><br>
<span class="lineno"></span><span class="op" id="4100780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4100783">var</span>&nbsp;<span class="ident" id="4100787">cipherSuites</span>&nbsp;<span class="op" id="4100800">=</span>&nbsp;<span class="op" id="4100802">[</span><span class="op" id="4100803">]</span><span class="op" id="4100804">*</span><span class="ident" id="4100805"><a href="/crypto/tls/cipher_suites.go.html#4100373">cipherSuite</a></span><span class="op" id="4100816">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4100819">//&nbsp;Ciphersuite&nbsp;order&nbsp;is&nbsp;chosen&nbsp;so&nbsp;that&nbsp;ECDHE&nbsp;comes&nbsp;before&nbsp;plain&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4100888">//&nbsp;and&nbsp;RC4&nbsp;comes&nbsp;before&nbsp;AES&nbsp;(because&nbsp;of&nbsp;the&nbsp;Lucky13&nbsp;attack).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4100950">{</span><span class="ident" id="4100951"><a href="/crypto/tls/cipher_suites.go.html#4107494">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</a></span><span class="op" id="4100988">,</span>&nbsp;<span class="num" id="4100990">16</span><span class="op" id="4100992">,</span>&nbsp;<span class="num" id="4100994">0</span><span class="op" id="4100995">,</span>&nbsp;<span class="num" id="4100997">4</span><span class="op" id="4100998">,</span>&nbsp;<span class="ident" id="4101000"><a href="/crypto/tls/cipher_suites.go.html#4106252">ecdheRSAKA</a></span><span class="op" id="4101010">,</span>&nbsp;<span class="ident" id="4101012"><a href="/crypto/tls/cipher_suites.go.html#4099848">suiteECDHE</a></span>&nbsp;<span class="op" id="4101023">|</span>&nbsp;<span class="ident" id="4101025"><a href="/crypto/tls/cipher_suites.go.html#4100211">suiteTLS12</a></span><span class="op" id="4101035">,</span>&nbsp;<span class="ident" id="4101037">nil</span><span class="op" id="4101040">,</span>&nbsp;<span class="ident" id="4101042">nil</span><span class="op" id="4101045">,</span>&nbsp;<span class="ident" id="4101047"><a href="/crypto/tls/cipher_suites.go.html#4104071">aeadAESGCM</a></span><span class="op" id="4101057">}</span><span class="op" id="4101058">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101061">{</span><span class="ident" id="4101062"><a href="/crypto/tls/cipher_suites.go.html#4107551">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</a></span><span class="op" id="4101101">,</span>&nbsp;<span class="num" id="4101103">16</span><span class="op" id="4101105">,</span>&nbsp;<span class="num" id="4101107">0</span><span class="op" id="4101108">,</span>&nbsp;<span class="num" id="4101110">4</span><span class="op" id="4101111">,</span>&nbsp;<span class="ident" id="4101113"><a href="/crypto/tls/cipher_suites.go.html#4106122">ecdheECDSAKA</a></span><span class="op" id="4101125">,</span>&nbsp;<span class="ident" id="4101127"><a href="/crypto/tls/cipher_suites.go.html#4099848">suiteECDHE</a></span>&nbsp;<span class="op" id="4101138">|</span>&nbsp;<span class="ident" id="4101140"><a href="/crypto/tls/cipher_suites.go.html#4100089">suiteECDSA</a></span>&nbsp;<span class="op" id="4101151">|</span>&nbsp;<span class="ident" id="4101153"><a href="/crypto/tls/cipher_suites.go.html#4100211">suiteTLS12</a></span><span class="op" id="4101163">,</span>&nbsp;<span class="ident" id="4101165">nil</span><span class="op" id="4101168">,</span>&nbsp;<span class="ident" id="4101170">nil</span><span class="op" id="4101173">,</span>&nbsp;<span class="ident" id="4101175"><a href="/crypto/tls/cipher_suites.go.html#4104071">aeadAESGCM</a></span><span class="op" id="4101185">}</span><span class="op" id="4101186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101189">{</span><span class="ident" id="4101190"><a href="/crypto/tls/cipher_suites.go.html#4107266">TLS_ECDHE_RSA_WITH_RC4_128_SHA</a></span><span class="op" id="4101220">,</span>&nbsp;<span class="num" id="4101222">16</span><span class="op" id="4101224">,</span>&nbsp;<span class="num" id="4101226">20</span><span class="op" id="4101228">,</span>&nbsp;<span class="num" id="4101230">0</span><span class="op" id="4101231">,</span>&nbsp;<span class="ident" id="4101233"><a href="/crypto/tls/cipher_suites.go.html#4106252">ecdheRSAKA</a></span><span class="op" id="4101243">,</span>&nbsp;<span class="ident" id="4101245"><a href="/crypto/tls/cipher_suites.go.html#4099848">suiteECDHE</a></span><span class="op" id="4101255">,</span>&nbsp;<span class="ident" id="4101257"><a href="/crypto/tls/cipher_suites.go.html#4102254">cipherRC4</a></span><span class="op" id="4101266">,</span>&nbsp;<span class="ident" id="4101268"><a href="/crypto/tls/cipher_suites.go.html#4102826">macSHA1</a></span><span class="op" id="4101275">,</span>&nbsp;<span class="ident" id="4101277">nil</span><span class="op" id="4101280">}</span><span class="op" id="4101281">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101284">{</span><span class="ident" id="4101285"><a href="/crypto/tls/cipher_suites.go.html#4107095">TLS_ECDHE_ECDSA_WITH_RC4_128_SHA</a></span><span class="op" id="4101317">,</span>&nbsp;<span class="num" id="4101319">16</span><span class="op" id="4101321">,</span>&nbsp;<span class="num" id="4101323">20</span><span class="op" id="4101325">,</span>&nbsp;<span class="num" id="4101327">0</span><span class="op" id="4101328">,</span>&nbsp;<span class="ident" id="4101330"><a href="/crypto/tls/cipher_suites.go.html#4106122">ecdheECDSAKA</a></span><span class="op" id="4101342">,</span>&nbsp;<span class="ident" id="4101344"><a href="/crypto/tls/cipher_suites.go.html#4099848">suiteECDHE</a></span>&nbsp;<span class="op" id="4101355">|</span>&nbsp;<span class="ident" id="4101357"><a href="/crypto/tls/cipher_suites.go.html#4100089">suiteECDSA</a></span><span class="op" id="4101367">,</span>&nbsp;<span class="ident" id="4101369"><a href="/crypto/tls/cipher_suites.go.html#4102254">cipherRC4</a></span><span class="op" id="4101378">,</span>&nbsp;<span class="ident" id="4101380"><a href="/crypto/tls/cipher_suites.go.html#4102826">macSHA1</a></span><span class="op" id="4101387">,</span>&nbsp;<span class="ident" id="4101389">nil</span><span class="op" id="4101392">}</span><span class="op" id="4101393">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101396">{</span><span class="ident" id="4101397"><a href="/crypto/tls/cipher_suites.go.html#4107380">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</a></span><span class="op" id="4101431">,</span>&nbsp;<span class="num" id="4101433">16</span><span class="op" id="4101435">,</span>&nbsp;<span class="num" id="4101437">20</span><span class="op" id="4101439">,</span>&nbsp;<span class="num" id="4101441">16</span><span class="op" id="4101443">,</span>&nbsp;<span class="ident" id="4101445"><a href="/crypto/tls/cipher_suites.go.html#4106252">ecdheRSAKA</a></span><span class="op" id="4101455">,</span>&nbsp;<span class="ident" id="4101457"><a href="/crypto/tls/cipher_suites.go.html#4099848">suiteECDHE</a></span><span class="op" id="4101467">,</span>&nbsp;<span class="ident" id="4101469"><a href="/crypto/tls/cipher_suites.go.html#4102567">cipherAES</a></span><span class="op" id="4101478">,</span>&nbsp;<span class="ident" id="4101480"><a href="/crypto/tls/cipher_suites.go.html#4102826">macSHA1</a></span><span class="op" id="4101487">,</span>&nbsp;<span class="ident" id="4101489">nil</span><span class="op" id="4101492">}</span><span class="op" id="4101493">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101496">{</span><span class="ident" id="4101497"><a href="/crypto/tls/cipher_suites.go.html#4107152">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</a></span><span class="op" id="4101533">,</span>&nbsp;<span class="num" id="4101535">16</span><span class="op" id="4101537">,</span>&nbsp;<span class="num" id="4101539">20</span><span class="op" id="4101541">,</span>&nbsp;<span class="num" id="4101543">16</span><span class="op" id="4101545">,</span>&nbsp;<span class="ident" id="4101547"><a href="/crypto/tls/cipher_suites.go.html#4106122">ecdheECDSAKA</a></span><span class="op" id="4101559">,</span>&nbsp;<span class="ident" id="4101561"><a href="/crypto/tls/cipher_suites.go.html#4099848">suiteECDHE</a></span>&nbsp;<span class="op" id="4101572">|</span>&nbsp;<span class="ident" id="4101574"><a href="/crypto/tls/cipher_suites.go.html#4100089">suiteECDSA</a></span><span class="op" id="4101584">,</span>&nbsp;<span class="ident" id="4101586"><a href="/crypto/tls/cipher_suites.go.html#4102567">cipherAES</a></span><span class="op" id="4101595">,</span>&nbsp;<span class="ident" id="4101597"><a href="/crypto/tls/cipher_suites.go.html#4102826">macSHA1</a></span><span class="op" id="4101604">,</span>&nbsp;<span class="ident" id="4101606">nil</span><span class="op" id="4101609">}</span><span class="op" id="4101610">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101613">{</span><span class="ident" id="4101614"><a href="/crypto/tls/cipher_suites.go.html#4107437">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</a></span><span class="op" id="4101648">,</span>&nbsp;<span class="num" id="4101650">32</span><span class="op" id="4101652">,</span>&nbsp;<span class="num" id="4101654">20</span><span class="op" id="4101656">,</span>&nbsp;<span class="num" id="4101658">16</span><span class="op" id="4101660">,</span>&nbsp;<span class="ident" id="4101662"><a href="/crypto/tls/cipher_suites.go.html#4106252">ecdheRSAKA</a></span><span class="op" id="4101672">,</span>&nbsp;<span class="ident" id="4101674"><a href="/crypto/tls/cipher_suites.go.html#4099848">suiteECDHE</a></span><span class="op" id="4101684">,</span>&nbsp;<span class="ident" id="4101686"><a href="/crypto/tls/cipher_suites.go.html#4102567">cipherAES</a></span><span class="op" id="4101695">,</span>&nbsp;<span class="ident" id="4101697"><a href="/crypto/tls/cipher_suites.go.html#4102826">macSHA1</a></span><span class="op" id="4101704">,</span>&nbsp;<span class="ident" id="4101706">nil</span><span class="op" id="4101709">}</span><span class="op" id="4101710">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101713">{</span><span class="ident" id="4101714"><a href="/crypto/tls/cipher_suites.go.html#4107209">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</a></span><span class="op" id="4101750">,</span>&nbsp;<span class="num" id="4101752">32</span><span class="op" id="4101754">,</span>&nbsp;<span class="num" id="4101756">20</span><span class="op" id="4101758">,</span>&nbsp;<span class="num" id="4101760">16</span><span class="op" id="4101762">,</span>&nbsp;<span class="ident" id="4101764"><a href="/crypto/tls/cipher_suites.go.html#4106122">ecdheECDSAKA</a></span><span class="op" id="4101776">,</span>&nbsp;<span class="ident" id="4101778"><a href="/crypto/tls/cipher_suites.go.html#4099848">suiteECDHE</a></span>&nbsp;<span class="op" id="4101789">|</span>&nbsp;<span class="ident" id="4101791"><a href="/crypto/tls/cipher_suites.go.html#4100089">suiteECDSA</a></span><span class="op" id="4101801">,</span>&nbsp;<span class="ident" id="4101803"><a href="/crypto/tls/cipher_suites.go.html#4102567">cipherAES</a></span><span class="op" id="4101812">,</span>&nbsp;<span class="ident" id="4101814"><a href="/crypto/tls/cipher_suites.go.html#4102826">macSHA1</a></span><span class="op" id="4101821">,</span>&nbsp;<span class="ident" id="4101823">nil</span><span class="op" id="4101826">}</span><span class="op" id="4101827">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101830">{</span><span class="ident" id="4101831"><a href="/crypto/tls/cipher_suites.go.html#4106867">TLS_RSA_WITH_RC4_128_SHA</a></span><span class="op" id="4101855">,</span>&nbsp;<span class="num" id="4101857">16</span><span class="op" id="4101859">,</span>&nbsp;<span class="num" id="4101861">20</span><span class="op" id="4101863">,</span>&nbsp;<span class="num" id="4101865">0</span><span class="op" id="4101866">,</span>&nbsp;<span class="ident" id="4101868"><a href="/crypto/tls/cipher_suites.go.html#4106051">rsaKA</a></span><span class="op" id="4101873">,</span>&nbsp;<span class="num" id="4101875">0</span><span class="op" id="4101876">,</span>&nbsp;<span class="ident" id="4101878"><a href="/crypto/tls/cipher_suites.go.html#4102254">cipherRC4</a></span><span class="op" id="4101887">,</span>&nbsp;<span class="ident" id="4101889"><a href="/crypto/tls/cipher_suites.go.html#4102826">macSHA1</a></span><span class="op" id="4101896">,</span>&nbsp;<span class="ident" id="4101898">nil</span><span class="op" id="4101901">}</span><span class="op" id="4101902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101905">{</span><span class="ident" id="4101906"><a href="/crypto/tls/cipher_suites.go.html#4106981">TLS_RSA_WITH_AES_128_CBC_SHA</a></span><span class="op" id="4101934">,</span>&nbsp;<span class="num" id="4101936">16</span><span class="op" id="4101938">,</span>&nbsp;<span class="num" id="4101940">20</span><span class="op" id="4101942">,</span>&nbsp;<span class="num" id="4101944">16</span><span class="op" id="4101946">,</span>&nbsp;<span class="ident" id="4101948"><a href="/crypto/tls/cipher_suites.go.html#4106051">rsaKA</a></span><span class="op" id="4101953">,</span>&nbsp;<span class="num" id="4101955">0</span><span class="op" id="4101956">,</span>&nbsp;<span class="ident" id="4101958"><a href="/crypto/tls/cipher_suites.go.html#4102567">cipherAES</a></span><span class="op" id="4101967">,</span>&nbsp;<span class="ident" id="4101969"><a href="/crypto/tls/cipher_suites.go.html#4102826">macSHA1</a></span><span class="op" id="4101976">,</span>&nbsp;<span class="ident" id="4101978">nil</span><span class="op" id="4101981">}</span><span class="op" id="4101982">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101985">{</span><span class="ident" id="4101986"><a href="/crypto/tls/cipher_suites.go.html#4107038">TLS_RSA_WITH_AES_256_CBC_SHA</a></span><span class="op" id="4102014">,</span>&nbsp;<span class="num" id="4102016">32</span><span class="op" id="4102018">,</span>&nbsp;<span class="num" id="4102020">20</span><span class="op" id="4102022">,</span>&nbsp;<span class="num" id="4102024">16</span><span class="op" id="4102026">,</span>&nbsp;<span class="ident" id="4102028"><a href="/crypto/tls/cipher_suites.go.html#4106051">rsaKA</a></span><span class="op" id="4102033">,</span>&nbsp;<span class="num" id="4102035">0</span><span class="op" id="4102036">,</span>&nbsp;<span class="ident" id="4102038"><a href="/crypto/tls/cipher_suites.go.html#4102567">cipherAES</a></span><span class="op" id="4102047">,</span>&nbsp;<span class="ident" id="4102049"><a href="/crypto/tls/cipher_suites.go.html#4102826">macSHA1</a></span><span class="op" id="4102056">,</span>&nbsp;<span class="ident" id="4102058">nil</span><span class="op" id="4102061">}</span><span class="op" id="4102062">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4102065">{</span><span class="ident" id="4102066"><a href="/crypto/tls/cipher_suites.go.html#4107323">TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</a></span><span class="op" id="4102101">,</span>&nbsp;<span class="num" id="4102103">24</span><span class="op" id="4102105">,</span>&nbsp;<span class="num" id="4102107">20</span><span class="op" id="4102109">,</span>&nbsp;<span class="num" id="4102111">8</span><span class="op" id="4102112">,</span>&nbsp;<span class="ident" id="4102114"><a href="/crypto/tls/cipher_suites.go.html#4106252">ecdheRSAKA</a></span><span class="op" id="4102124">,</span>&nbsp;<span class="ident" id="4102126"><a href="/crypto/tls/cipher_suites.go.html#4099848">suiteECDHE</a></span><span class="op" id="4102136">,</span>&nbsp;<span class="ident" id="4102138"><a href="/crypto/tls/cipher_suites.go.html#4102363">cipher3DES</a></span><span class="op" id="4102148">,</span>&nbsp;<span class="ident" id="4102150"><a href="/crypto/tls/cipher_suites.go.html#4102826">macSHA1</a></span><span class="op" id="4102157">,</span>&nbsp;<span class="ident" id="4102159">nil</span><span class="op" id="4102162">}</span><span class="op" id="4102163">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4102166">{</span><span class="ident" id="4102167"><a href="/crypto/tls/cipher_suites.go.html#4106924">TLS_RSA_WITH_3DES_EDE_CBC_SHA</a></span><span class="op" id="4102196">,</span>&nbsp;<span class="num" id="4102198">24</span><span class="op" id="4102200">,</span>&nbsp;<span class="num" id="4102202">20</span><span class="op" id="4102204">,</span>&nbsp;<span class="num" id="4102206">8</span><span class="op" id="4102207">,</span>&nbsp;<span class="ident" id="4102209"><a href="/crypto/tls/cipher_suites.go.html#4106051">rsaKA</a></span><span class="op" id="4102214">,</span>&nbsp;<span class="num" id="4102216">0</span><span class="op" id="4102217">,</span>&nbsp;<span class="ident" id="4102219"><a href="/crypto/tls/cipher_suites.go.html#4102363">cipher3DES</a></span><span class="op" id="4102229">,</span>&nbsp;<span class="ident" id="4102231"><a href="/crypto/tls/cipher_suites.go.html#4102826">macSHA1</a></span><span class="op" id="4102238">,</span>&nbsp;<span class="ident" id="4102240">nil</span><span class="op" id="4102243">}</span><span class="op" id="4102244">,</span><br>
<span class="lineno">85</span><span class="op" id="4102246">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4102249">func</span>&nbsp;<span class="ident" id="4102254">cipherRC4</span><span class="op" id="4102263">(</span><span class="ident" id="4102264">key</span><span class="op" id="4102267">,</span>&nbsp;<span class="ident" id="4102269">iv</span>&nbsp;<span class="op" id="4102272">[</span><span class="op" id="4102273">]</span><span class="builtintype" id="4102274">byte</span><span class="op" id="4102278">,</span>&nbsp;<span class="ident" id="4102280">isRead</span>&nbsp;<span class="builtintype" id="4102287">bool</span><span class="op" id="4102291">)</span>&nbsp;<span class="keyword" id="4102293">interface</span><span class="op" id="4102302">{</span><span class="op" id="4102303">}</span>&nbsp;<span class="op" id="4102305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102308">cipher</span><span class="op" id="4102314">,</span>&nbsp;<span class="ident" id="4102316">_</span>&nbsp;<span class="op" id="4102318">:=</span>&nbsp;<span class="ident" id="4102321"><a href="/crypto/tls/cipher_suites.go.html#4098555">rc4</a></span><span class="op" id="4102324">.</span><span class="ident" id="4102325">NewCipher</span><span class="op" id="4102334">(</span><span class="ident" id="4102335"><a href="/crypto/tls/cipher_suites.go.html#4102264">key</a></span><span class="op" id="4102338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4102341">return</span>&nbsp;<span class="ident" id="4102348"><a href="/crypto/tls/cipher_suites.go.html#4102308">cipher</a></span><br>
<span class="lineno">90</span><span class="op" id="4102355">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4102358">func</span>&nbsp;<span class="ident" id="4102363">cipher3DES</span><span class="op" id="4102373">(</span><span class="ident" id="4102374">key</span><span class="op" id="4102377">,</span>&nbsp;<span class="ident" id="4102379">iv</span>&nbsp;<span class="op" id="4102382">[</span><span class="op" id="4102383">]</span><span class="builtintype" id="4102384">byte</span><span class="op" id="4102388">,</span>&nbsp;<span class="ident" id="4102390">isRead</span>&nbsp;<span class="builtintype" id="4102397">bool</span><span class="op" id="4102401">)</span>&nbsp;<span class="keyword" id="4102403">interface</span><span class="op" id="4102412">{</span><span class="op" id="4102413">}</span>&nbsp;<span class="op" id="4102415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102418">block</span><span class="op" id="4102423">,</span>&nbsp;<span class="ident" id="4102425">_</span>&nbsp;<span class="op" id="4102427">:=</span>&nbsp;<span class="ident" id="4102430"><a href="/crypto/tls/cipher_suites.go.html#4098526">des</a></span><span class="op" id="4102433">.</span><span class="ident" id="4102434">NewTripleDESCipher</span><span class="op" id="4102452">(</span><span class="ident" id="4102453"><a href="/crypto/tls/cipher_suites.go.html#4102374">key</a></span><span class="op" id="4102456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4102459">if</span>&nbsp;<span class="ident" id="4102462"><a href="/crypto/tls/cipher_suites.go.html#4102390">isRead</a></span>&nbsp;<span class="op" id="4102469">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4102473">return</span>&nbsp;<span class="ident" id="4102480"><a href="/crypto/tls/cipher_suites.go.html#4098509">cipher</a></span><span class="op" id="4102486">.</span><span class="ident" id="4102487">NewCBCDecrypter</span><span class="op" id="4102502">(</span><span class="ident" id="4102503"><a href="/crypto/tls/cipher_suites.go.html#4102418">block</a></span><span class="op" id="4102508">,</span>&nbsp;<span class="ident" id="4102510"><a href="/crypto/tls/cipher_suites.go.html#4102379">iv</a></span><span class="op" id="4102512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4102515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4102518">return</span>&nbsp;<span class="ident" id="4102525"><a href="/crypto/tls/cipher_suites.go.html#4098509">cipher</a></span><span class="op" id="4102531">.</span><span class="ident" id="4102532">NewCBCEncrypter</span><span class="op" id="4102547">(</span><span class="ident" id="4102548"><a href="/crypto/tls/cipher_suites.go.html#4102418">block</a></span><span class="op" id="4102553">,</span>&nbsp;<span class="ident" id="4102555"><a href="/crypto/tls/cipher_suites.go.html#4102379">iv</a></span><span class="op" id="4102557">)</span><br>
<span class="lineno"></span><span class="op" id="4102559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="4102562">func</span>&nbsp;<span class="ident" id="4102567">cipherAES</span><span class="op" id="4102576">(</span><span class="ident" id="4102577">key</span><span class="op" id="4102580">,</span>&nbsp;<span class="ident" id="4102582">iv</span>&nbsp;<span class="op" id="4102585">[</span><span class="op" id="4102586">]</span><span class="builtintype" id="4102587">byte</span><span class="op" id="4102591">,</span>&nbsp;<span class="ident" id="4102593">isRead</span>&nbsp;<span class="builtintype" id="4102600">bool</span><span class="op" id="4102604">)</span>&nbsp;<span class="keyword" id="4102606">interface</span><span class="op" id="4102615">{</span><span class="op" id="4102616">}</span>&nbsp;<span class="op" id="4102618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102621">block</span><span class="op" id="4102626">,</span>&nbsp;<span class="ident" id="4102628">_</span>&nbsp;<span class="op" id="4102630">:=</span>&nbsp;<span class="ident" id="4102633"><a href="/crypto/tls/cipher_suites.go.html#4098495">aes</a></span><span class="op" id="4102636">.</span><span class="ident" id="4102637">NewCipher</span><span class="op" id="4102646">(</span><span class="ident" id="4102647"><a href="/crypto/tls/cipher_suites.go.html#4102577">key</a></span><span class="op" id="4102650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4102653">if</span>&nbsp;<span class="ident" id="4102656"><a href="/crypto/tls/cipher_suites.go.html#4102593">isRead</a></span>&nbsp;<span class="op" id="4102663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4102667">return</span>&nbsp;<span class="ident" id="4102674"><a href="/crypto/tls/cipher_suites.go.html#4098509">cipher</a></span><span class="op" id="4102680">.</span><span class="ident" id="4102681">NewCBCDecrypter</span><span class="op" id="4102696">(</span><span class="ident" id="4102697"><a href="/crypto/tls/cipher_suites.go.html#4102621">block</a></span><span class="op" id="4102702">,</span>&nbsp;<span class="ident" id="4102704"><a href="/crypto/tls/cipher_suites.go.html#4102582">iv</a></span><span class="op" id="4102706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4102709">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4102712">return</span>&nbsp;<span class="ident" id="4102719"><a href="/crypto/tls/cipher_suites.go.html#4098509">cipher</a></span><span class="op" id="4102725">.</span><span class="ident" id="4102726">NewCBCEncrypter</span><span class="op" id="4102741">(</span><span class="ident" id="4102742"><a href="/crypto/tls/cipher_suites.go.html#4102621">block</a></span><span class="op" id="4102747">,</span>&nbsp;<span class="ident" id="4102749"><a href="/crypto/tls/cipher_suites.go.html#4102582">iv</a></span><span class="op" id="4102751">)</span><br>
<span class="lineno"></span><span class="op" id="4102753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4102756">//&nbsp;macSHA1&nbsp;returns&nbsp;a&nbsp;macFunction&nbsp;for&nbsp;the&nbsp;given&nbsp;protocol&nbsp;version.</span><br>
<span class="lineno"></span><span class="keyword" id="4102821">func</span>&nbsp;<span class="ident" id="4102826">macSHA1</span><span class="op" id="4102833">(</span><span class="ident" id="4102834">version</span>&nbsp;<span class="builtintype" id="4102842">uint16</span><span class="op" id="4102848">,</span>&nbsp;<span class="ident" id="4102850">key</span>&nbsp;<span class="op" id="4102854">[</span><span class="op" id="4102855">]</span><span class="builtintype" id="4102856">byte</span><span class="op" id="4102860">)</span>&nbsp;<span class="ident" id="4102862"><a href="/crypto/tls/cipher_suites.go.html#4103068">macFunction</a></span>&nbsp;<span class="op" id="4102874">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4102877">if</span>&nbsp;<span class="ident" id="4102880"><a href="/crypto/tls/cipher_suites.go.html#4102834">version</a></span>&nbsp;<span class="op" id="4102888">==</span>&nbsp;<span class="ident" id="4102891"><a href="/crypto/tls/common.go.html#4108136">VersionSSL30</a></span>&nbsp;<span class="op" id="4102904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102908">mac</span>&nbsp;<span class="op" id="4102912">:=</span>&nbsp;<span class="ident" id="4102915"><a href="/crypto/tls/cipher_suites.go.html#4104552">ssl30MAC</a></span><span class="op" id="4102923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102928">h</span><span class="op" id="4102929">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4102933"><a href="/crypto/tls/cipher_suites.go.html#4098569">sha1</a></span><span class="op" id="4102937">.</span><span class="ident" id="4102938">New</span><span class="op" id="4102941">(</span><span class="op" id="4102942">)</span><span class="op" id="4102943">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102948">key</span><span class="op" id="4102951">:</span>&nbsp;<span class="builtinfunc" id="4102953">make</span><span class="op" id="4102957">(</span><span class="op" id="4102958">[</span><span class="op" id="4102959">]</span><span class="builtintype" id="4102960">byte</span><span class="op" id="4102964">,</span>&nbsp;<span class="builtinfunc" id="4102966">len</span><span class="op" id="4102969">(</span><span class="ident" id="4102970"><a href="/crypto/tls/cipher_suites.go.html#4102850">key</a></span><span class="op" id="4102973">)</span><span class="op" id="4102974">)</span><span class="op" id="4102975">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4102979">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4102983">copy</span><span class="op" id="4102987">(</span><span class="ident" id="4102988"><a href="/crypto/tls/cipher_suites.go.html#4102908">mac</a></span><span class="op" id="4102991">.</span><span class="ident" id="4102992">key</span><span class="op" id="4102995">,</span>&nbsp;<span class="ident" id="4102997"><a href="/crypto/tls/cipher_suites.go.html#4102850">key</a></span><span class="op" id="4103000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4103004">return</span>&nbsp;<span class="ident" id="4103011"><a href="/crypto/tls/cipher_suites.go.html#4102908">mac</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4103016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4103019">return</span>&nbsp;<span class="ident" id="4103026"><a href="/crypto/tls/cipher_suites.go.html#4105792">tls10MAC</a></span><span class="op" id="4103034">{</span><span class="ident" id="4103035"><a href="/crypto/tls/cipher_suites.go.html#4098540">hmac</a></span><span class="op" id="4103039">.</span><span class="ident" id="4103040">New</span><span class="op" id="4103043">(</span><span class="ident" id="4103044"><a href="/crypto/tls/cipher_suites.go.html#4098569">sha1</a></span><span class="op" id="4103048">.</span><span class="ident" id="4103049">New</span><span class="op" id="4103052">,</span>&nbsp;<span class="ident" id="4103054"><a href="/crypto/tls/cipher_suites.go.html#4102850">key</a></span><span class="op" id="4103057">)</span><span class="op" id="4103058">}</span><br>
<span class="lineno"></span><span class="op" id="4103060">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="4103063">type</span>&nbsp;<span class="ident" id="4103068">macFunction</span>&nbsp;<span class="keyword" id="4103080">interface</span>&nbsp;<span class="op" id="4103090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103093">Size</span><span class="op" id="4103097">(</span><span class="op" id="4103098">)</span>&nbsp;<span class="builtintype" id="4103100">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103105">MAC</span><span class="op" id="4103108">(</span><span class="ident" id="4103109">digestBuf</span><span class="op" id="4103118">,</span>&nbsp;<span class="ident" id="4103120">seq</span><span class="op" id="4103123">,</span>&nbsp;<span class="ident" id="4103125">header</span><span class="op" id="4103131">,</span>&nbsp;<span class="ident" id="4103133">data</span>&nbsp;<span class="op" id="4103138">[</span><span class="op" id="4103139">]</span><span class="builtintype" id="4103140">byte</span><span class="op" id="4103144">)</span>&nbsp;<span class="op" id="4103146">[</span><span class="op" id="4103147">]</span><span class="builtintype" id="4103148">byte</span><br>
<span class="lineno"></span><span class="op" id="4103153">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="4103156">//&nbsp;fixedNonceAEAD&nbsp;wraps&nbsp;an&nbsp;AEAD&nbsp;and&nbsp;prefixes&nbsp;a&nbsp;fixed&nbsp;portion&nbsp;of&nbsp;the&nbsp;nonce&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4103233">//&nbsp;each&nbsp;call.</span><br>
<span class="lineno"></span><span class="keyword" id="4103247">type</span>&nbsp;<span class="ident" id="4103252">fixedNonceAEAD</span>&nbsp;<span class="keyword" id="4103267">struct</span>&nbsp;<span class="op" id="4103274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4103277">//&nbsp;sealNonce&nbsp;and&nbsp;openNonce&nbsp;are&nbsp;buffers&nbsp;where&nbsp;the&nbsp;larger&nbsp;nonce&nbsp;will&nbsp;be</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4103348">//&nbsp;constructed.&nbsp;Since&nbsp;a&nbsp;seal&nbsp;and&nbsp;open&nbsp;operation&nbsp;may&nbsp;be&nbsp;running</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4103412">//&nbsp;concurrently,&nbsp;there&nbsp;is&nbsp;a&nbsp;separate&nbsp;buffer&nbsp;for&nbsp;each.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103467">sealNonce</span><span class="op" id="4103476">,</span>&nbsp;<span class="ident" id="4103478">openNonce</span>&nbsp;<span class="op" id="4103488">[</span><span class="op" id="4103489">]</span><span class="builtintype" id="4103490">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103496">aead</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4103517"><a href="/crypto/tls/cipher_suites.go.html#4098509">cipher</a></span><span class="op" id="4103523">.</span><span class="ident" id="4103524">AEAD</span><br>
<span class="lineno"></span><span class="op" id="4103529">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="keyword" id="4103532">func</span>&nbsp;<span class="op" id="4103537">(</span><span class="ident" id="4103538">f</span>&nbsp;<span class="op" id="4103540">*</span><span class="ident" id="4103541"><a href="/crypto/tls/cipher_suites.go.html#4103252">fixedNonceAEAD</a></span><span class="op" id="4103555">)</span>&nbsp;<span class="ident" id="4103557">NonceSize</span><span class="op" id="4103566">(</span><span class="op" id="4103567">)</span>&nbsp;<span class="builtintype" id="4103569">int</span>&nbsp;<span class="op" id="4103573">{</span>&nbsp;<span class="keyword" id="4103575">return</span>&nbsp;<span class="num" id="4103582">8</span>&nbsp;<span class="op" id="4103584">}</span><br>
<span class="lineno"></span><span class="keyword" id="4103586">func</span>&nbsp;<span class="op" id="4103591">(</span><span class="ident" id="4103592">f</span>&nbsp;<span class="op" id="4103594">*</span><span class="ident" id="4103595"><a href="/crypto/tls/cipher_suites.go.html#4103252">fixedNonceAEAD</a></span><span class="op" id="4103609">)</span>&nbsp;<span class="ident" id="4103611">Overhead</span><span class="op" id="4103619">(</span><span class="op" id="4103620">)</span>&nbsp;<span class="builtintype" id="4103622">int</span>&nbsp;&nbsp;<span class="op" id="4103627">{</span>&nbsp;<span class="keyword" id="4103629">return</span>&nbsp;<span class="ident" id="4103636"><a href="/crypto/tls/cipher_suites.go.html#4103592">f</a></span><span class="op" id="4103637">.</span><span class="ident" id="4103638">aead</span><span class="op" id="4103642">.</span><span class="ident" id="4103643">Overhead</span><span class="op" id="4103651">(</span><span class="op" id="4103652">)</span>&nbsp;<span class="op" id="4103654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4103657">func</span>&nbsp;<span class="op" id="4103662">(</span><span class="ident" id="4103663">f</span>&nbsp;<span class="op" id="4103665">*</span><span class="ident" id="4103666"><a href="/crypto/tls/cipher_suites.go.html#4103252">fixedNonceAEAD</a></span><span class="op" id="4103680">)</span>&nbsp;<span class="ident" id="4103682">Seal</span><span class="op" id="4103686">(</span><span class="ident" id="4103687">out</span><span class="op" id="4103690">,</span>&nbsp;<span class="ident" id="4103692">nonce</span><span class="op" id="4103697">,</span>&nbsp;<span class="ident" id="4103699">plaintext</span><span class="op" id="4103708">,</span>&nbsp;<span class="ident" id="4103710">additionalData</span>&nbsp;<span class="op" id="4103725">[</span><span class="op" id="4103726">]</span><span class="builtintype" id="4103727">byte</span><span class="op" id="4103731">)</span>&nbsp;<span class="op" id="4103733">[</span><span class="op" id="4103734">]</span><span class="builtintype" id="4103735">byte</span>&nbsp;<span class="op" id="4103740">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4103743">copy</span><span class="op" id="4103747">(</span><span class="ident" id="4103748"><a href="/crypto/tls/cipher_suites.go.html#4103663">f</a></span><span class="op" id="4103749">.</span><span class="ident" id="4103750">sealNonce</span><span class="op" id="4103759">[</span><span class="builtinfunc" id="4103760">len</span><span class="op" id="4103763">(</span><span class="ident" id="4103764"><a href="/crypto/tls/cipher_suites.go.html#4103663">f</a></span><span class="op" id="4103765">.</span><span class="ident" id="4103766">sealNonce</span><span class="op" id="4103775">)</span><span class="op" id="4103776">-</span><span class="num" id="4103777">8</span><span class="op" id="4103778">:</span><span class="op" id="4103779">]</span><span class="op" id="4103780">,</span>&nbsp;<span class="ident" id="4103782"><a href="/crypto/tls/cipher_suites.go.html#4103692">nonce</a></span><span class="op" id="4103787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4103790">return</span>&nbsp;<span class="ident" id="4103797"><a href="/crypto/tls/cipher_suites.go.html#4103663">f</a></span><span class="op" id="4103798">.</span><span class="ident" id="4103799">aead</span><span class="op" id="4103803">.</span><span class="ident" id="4103804">Seal</span><span class="op" id="4103808">(</span><span class="ident" id="4103809"><a href="/crypto/tls/cipher_suites.go.html#4103687">out</a></span><span class="op" id="4103812">,</span>&nbsp;<span class="ident" id="4103814"><a href="/crypto/tls/cipher_suites.go.html#4103663">f</a></span><span class="op" id="4103815">.</span><span class="ident" id="4103816">sealNonce</span><span class="op" id="4103825">,</span>&nbsp;<span class="ident" id="4103827"><a href="/crypto/tls/cipher_suites.go.html#4103699">plaintext</a></span><span class="op" id="4103836">,</span>&nbsp;<span class="ident" id="4103838"><a href="/crypto/tls/cipher_suites.go.html#4103710">additionalData</a></span><span class="op" id="4103852">)</span><br>
<span class="lineno"></span><span class="op" id="4103854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4103857">func</span>&nbsp;<span class="op" id="4103862">(</span><span class="ident" id="4103863">f</span>&nbsp;<span class="op" id="4103865">*</span><span class="ident" id="4103866"><a href="/crypto/tls/cipher_suites.go.html#4103252">fixedNonceAEAD</a></span><span class="op" id="4103880">)</span>&nbsp;<span class="ident" id="4103882">Open</span><span class="op" id="4103886">(</span><span class="ident" id="4103887">out</span><span class="op" id="4103890">,</span>&nbsp;<span class="ident" id="4103892">nonce</span><span class="op" id="4103897">,</span>&nbsp;<span class="ident" id="4103899">plaintext</span><span class="op" id="4103908">,</span>&nbsp;<span class="ident" id="4103910">additionalData</span>&nbsp;<span class="op" id="4103925">[</span><span class="op" id="4103926">]</span><span class="builtintype" id="4103927">byte</span><span class="op" id="4103931">)</span>&nbsp;<span class="op" id="4103933">(</span><span class="op" id="4103934">[</span><span class="op" id="4103935">]</span><span class="builtintype" id="4103936">byte</span><span class="op" id="4103940">,</span>&nbsp;<span class="builtintype" id="4103942">error</span><span class="op" id="4103947">)</span>&nbsp;<span class="op" id="4103949">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4103952">copy</span><span class="op" id="4103956">(</span><span class="ident" id="4103957"><a href="/crypto/tls/cipher_suites.go.html#4103863">f</a></span><span class="op" id="4103958">.</span><span class="ident" id="4103959">openNonce</span><span class="op" id="4103968">[</span><span class="builtinfunc" id="4103969">len</span><span class="op" id="4103972">(</span><span class="ident" id="4103973"><a href="/crypto/tls/cipher_suites.go.html#4103863">f</a></span><span class="op" id="4103974">.</span><span class="ident" id="4103975">openNonce</span><span class="op" id="4103984">)</span><span class="op" id="4103985">-</span><span class="num" id="4103986">8</span><span class="op" id="4103987">:</span><span class="op" id="4103988">]</span><span class="op" id="4103989">,</span>&nbsp;<span class="ident" id="4103991"><a href="/crypto/tls/cipher_suites.go.html#4103892">nonce</a></span><span class="op" id="4103996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4103999">return</span>&nbsp;<span class="ident" id="4104006"><a href="/crypto/tls/cipher_suites.go.html#4103863">f</a></span><span class="op" id="4104007">.</span><span class="ident" id="4104008">aead</span><span class="op" id="4104012">.</span><span class="ident" id="4104013">Open</span><span class="op" id="4104017">(</span><span class="ident" id="4104018"><a href="/crypto/tls/cipher_suites.go.html#4103887">out</a></span><span class="op" id="4104021">,</span>&nbsp;<span class="ident" id="4104023"><a href="/crypto/tls/cipher_suites.go.html#4103863">f</a></span><span class="op" id="4104024">.</span><span class="ident" id="4104025">openNonce</span><span class="op" id="4104034">,</span>&nbsp;<span class="ident" id="4104036"><a href="/crypto/tls/cipher_suites.go.html#4103899">plaintext</a></span><span class="op" id="4104045">,</span>&nbsp;<span class="ident" id="4104047"><a href="/crypto/tls/cipher_suites.go.html#4103910">additionalData</a></span><span class="op" id="4104061">)</span><br>
<span class="lineno"></span><span class="op" id="4104063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4104066">func</span>&nbsp;<span class="ident" id="4104071">aeadAESGCM</span><span class="op" id="4104081">(</span><span class="ident" id="4104082">key</span><span class="op" id="4104085">,</span>&nbsp;<span class="ident" id="4104087">fixedNonce</span>&nbsp;<span class="op" id="4104098">[</span><span class="op" id="4104099">]</span><span class="builtintype" id="4104100">byte</span><span class="op" id="4104104">)</span>&nbsp;<span class="ident" id="4104106"><a href="/crypto/tls/cipher_suites.go.html#4098509">cipher</a></span><span class="op" id="4104112">.</span><span class="ident" id="4104113">AEAD</span>&nbsp;<span class="op" id="4104118">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104121">aes</span><span class="op" id="4104124">,</span>&nbsp;<span class="ident" id="4104126">err</span>&nbsp;<span class="op" id="4104130">:=</span>&nbsp;<span class="ident" id="4104133"><a href="/crypto/tls/cipher_suites.go.html#4098495">aes</a></span><span class="op" id="4104136">.</span><span class="ident" id="4104137">NewCipher</span><span class="op" id="4104146">(</span><span class="ident" id="4104147"><a href="/crypto/tls/cipher_suites.go.html#4104082">key</a></span><span class="op" id="4104150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4104153">if</span>&nbsp;<span class="ident" id="4104156"><a href="/crypto/tls/cipher_suites.go.html#4104126">err</a></span>&nbsp;<span class="op" id="4104160">!=</span>&nbsp;<span class="ident" id="4104163">nil</span>&nbsp;<span class="op" id="4104167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4104171">panic</span><span class="op" id="4104176">(</span><span class="ident" id="4104177"><a href="/crypto/tls/cipher_suites.go.html#4104126">err</a></span><span class="op" id="4104180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4104183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104186">aead</span><span class="op" id="4104190">,</span>&nbsp;<span class="ident" id="4104192"><a href="/crypto/tls/cipher_suites.go.html#4104126">err</a></span>&nbsp;<span class="op" id="4104196">:=</span>&nbsp;<span class="ident" id="4104199"><a href="/crypto/tls/cipher_suites.go.html#4098509">cipher</a></span><span class="op" id="4104205">.</span><span class="ident" id="4104206">NewGCM</span><span class="op" id="4104212">(</span><span class="ident" id="4104213"><a href="/crypto/tls/cipher_suites.go.html#4104121">aes</a></span><span class="op" id="4104216">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4104219">if</span>&nbsp;<span class="ident" id="4104222"><a href="/crypto/tls/cipher_suites.go.html#4104126">err</a></span>&nbsp;<span class="op" id="4104226">!=</span>&nbsp;<span class="ident" id="4104229">nil</span>&nbsp;<span class="op" id="4104233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4104237">panic</span><span class="op" id="4104242">(</span><span class="ident" id="4104243"><a href="/crypto/tls/cipher_suites.go.html#4104126">err</a></span><span class="op" id="4104246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4104249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104253">nonce1</span><span class="op" id="4104259">,</span>&nbsp;<span class="ident" id="4104261">nonce2</span>&nbsp;<span class="op" id="4104268">:=</span>&nbsp;<span class="builtinfunc" id="4104271">make</span><span class="op" id="4104275">(</span><span class="op" id="4104276">[</span><span class="op" id="4104277">]</span><span class="builtintype" id="4104278">byte</span><span class="op" id="4104282">,</span>&nbsp;<span class="num" id="4104284">12</span><span class="op" id="4104286">)</span><span class="op" id="4104287">,</span>&nbsp;<span class="builtinfunc" id="4104289">make</span><span class="op" id="4104293">(</span><span class="op" id="4104294">[</span><span class="op" id="4104295">]</span><span class="builtintype" id="4104296">byte</span><span class="op" id="4104300">,</span>&nbsp;<span class="num" id="4104302">12</span><span class="op" id="4104304">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4104307">copy</span><span class="op" id="4104311">(</span><span class="ident" id="4104312"><a href="/crypto/tls/cipher_suites.go.html#4104253">nonce1</a></span><span class="op" id="4104318">,</span>&nbsp;<span class="ident" id="4104320"><a href="/crypto/tls/cipher_suites.go.html#4104087">fixedNonce</a></span><span class="op" id="4104330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4104333">copy</span><span class="op" id="4104337">(</span><span class="ident" id="4104338"><a href="/crypto/tls/cipher_suites.go.html#4104261">nonce2</a></span><span class="op" id="4104344">,</span>&nbsp;<span class="ident" id="4104346"><a href="/crypto/tls/cipher_suites.go.html#4104087">fixedNonce</a></span><span class="op" id="4104356">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4104360">return</span>&nbsp;<span class="op" id="4104367">&amp;</span><span class="ident" id="4104368"><a href="/crypto/tls/cipher_suites.go.html#4103252">fixedNonceAEAD</a></span><span class="op" id="4104382">{</span><span class="ident" id="4104383"><a href="/crypto/tls/cipher_suites.go.html#4104253">nonce1</a></span><span class="op" id="4104389">,</span>&nbsp;<span class="ident" id="4104391"><a href="/crypto/tls/cipher_suites.go.html#4104261">nonce2</a></span><span class="op" id="4104397">,</span>&nbsp;<span class="ident" id="4104399"><a href="/crypto/tls/cipher_suites.go.html#4104186">aead</a></span><span class="op" id="4104403">}</span><br>
<span class="lineno"></span><span class="op" id="4104405">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="4104408">//&nbsp;ssl30MAC&nbsp;implements&nbsp;the&nbsp;SSLv3&nbsp;MAC&nbsp;function,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4104469">//&nbsp;www.mozilla.org/projects/security/pki/nss/ssl/draft302.txt&nbsp;section&nbsp;5.2.3.1</span><br>
<span class="lineno"></span><span class="keyword" id="4104547">type</span>&nbsp;<span class="ident" id="4104552">ssl30MAC</span>&nbsp;<span class="keyword" id="4104561">struct</span>&nbsp;<span class="op" id="4104568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104571">h</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4104575"><a href="/crypto/tls/cipher_suites.go.html#4098599">hash</a></span><span class="op" id="4104579">.</span><span class="ident" id="4104580">Hash</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104586">key</span>&nbsp;<span class="op" id="4104590">[</span><span class="op" id="4104591">]</span><span class="builtintype" id="4104592">byte</span><br>
<span class="lineno"></span><span class="op" id="4104597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4104600">func</span>&nbsp;<span class="op" id="4104605">(</span><span class="ident" id="4104606">s</span>&nbsp;<span class="ident" id="4104608"><a href="/crypto/tls/cipher_suites.go.html#4104552">ssl30MAC</a></span><span class="op" id="4104616">)</span>&nbsp;<span class="ident" id="4104618">Size</span><span class="op" id="4104622">(</span><span class="op" id="4104623">)</span>&nbsp;<span class="builtintype" id="4104625">int</span>&nbsp;<span class="op" id="4104629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4104632">return</span>&nbsp;<span class="ident" id="4104639"><a href="/crypto/tls/cipher_suites.go.html#4104606">s</a></span><span class="op" id="4104640">.</span><span class="ident" id="4104641">h</span><span class="op" id="4104642">.</span><span class="ident" id="4104643">Size</span><span class="op" id="4104647">(</span><span class="op" id="4104648">)</span><br>
<span class="lineno">175</span><span class="op" id="4104650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4104653">var</span>&nbsp;<span class="ident" id="4104657">ssl30Pad1</span>&nbsp;<span class="op" id="4104667">=</span>&nbsp;<span class="op" id="4104669">[</span><span class="num" id="4104670">48</span><span class="op" id="4104672">]</span><span class="builtintype" id="4104673">byte</span><span class="op" id="4104677">{</span><span class="num" id="4104678">0x36</span><span class="op" id="4104682">,</span>&nbsp;<span class="num" id="4104684">0x36</span><span class="op" id="4104688">,</span>&nbsp;<span class="num" id="4104690">0x36</span><span class="op" id="4104694">,</span>&nbsp;<span class="num" id="4104696">0x36</span><span class="op" id="4104700">,</span>&nbsp;<span class="num" id="4104702">0x36</span><span class="op" id="4104706">,</span>&nbsp;<span class="num" id="4104708">0x36</span><span class="op" id="4104712">,</span>&nbsp;<span class="num" id="4104714">0x36</span><span class="op" id="4104718">,</span>&nbsp;<span class="num" id="4104720">0x36</span><span class="op" id="4104724">,</span>&nbsp;<span class="num" id="4104726">0x36</span><span class="op" id="4104730">,</span>&nbsp;<span class="num" id="4104732">0x36</span><span class="op" id="4104736">,</span>&nbsp;<span class="num" id="4104738">0x36</span><span class="op" id="4104742">,</span>&nbsp;<span class="num" id="4104744">0x36</span><span class="op" id="4104748">,</span>&nbsp;<span class="num" id="4104750">0x36</span><span class="op" id="4104754">,</span>&nbsp;<span class="num" id="4104756">0x36</span><span class="op" id="4104760">,</span>&nbsp;<span class="num" id="4104762">0x36</span><span class="op" id="4104766">,</span>&nbsp;<span class="num" id="4104768">0x36</span><span class="op" id="4104772">,</span>&nbsp;<span class="num" id="4104774">0x36</span><span class="op" id="4104778">,</span>&nbsp;<span class="num" id="4104780">0x36</span><span class="op" id="4104784">,</span>&nbsp;<span class="num" id="4104786">0x36</span><span class="op" id="4104790">,</span>&nbsp;<span class="num" id="4104792">0x36</span><span class="op" id="4104796">,</span>&nbsp;<span class="num" id="4104798">0x36</span><span class="op" id="4104802">,</span>&nbsp;<span class="num" id="4104804">0x36</span><span class="op" id="4104808">,</span>&nbsp;<span class="num" id="4104810">0x36</span><span class="op" id="4104814">,</span>&nbsp;<span class="num" id="4104816">0x36</span><span class="op" id="4104820">,</span>&nbsp;<span class="num" id="4104822">0x36</span><span class="op" id="4104826">,</span>&nbsp;<span class="num" id="4104828">0x36</span><span class="op" id="4104832">,</span>&nbsp;<span class="num" id="4104834">0x36</span><span class="op" id="4104838">,</span>&nbsp;<span class="num" id="4104840">0x36</span><span class="op" id="4104844">,</span>&nbsp;<span class="num" id="4104846">0x36</span><span class="op" id="4104850">,</span>&nbsp;<span class="num" id="4104852">0x36</span><span class="op" id="4104856">,</span>&nbsp;<span class="num" id="4104858">0x36</span><span class="op" id="4104862">,</span>&nbsp;<span class="num" id="4104864">0x36</span><span class="op" id="4104868">,</span>&nbsp;<span class="num" id="4104870">0x36</span><span class="op" id="4104874">,</span>&nbsp;<span class="num" id="4104876">0x36</span><span class="op" id="4104880">,</span>&nbsp;<span class="num" id="4104882">0x36</span><span class="op" id="4104886">,</span>&nbsp;<span class="num" id="4104888">0x36</span><span class="op" id="4104892">,</span>&nbsp;<span class="num" id="4104894">0x36</span><span class="op" id="4104898">,</span>&nbsp;<span class="num" id="4104900">0x36</span><span class="op" id="4104904">,</span>&nbsp;<span class="num" id="4104906">0x36</span><span class="op" id="4104910">,</span>&nbsp;<span class="num" id="4104912">0x36</span><span class="op" id="4104916">,</span>&nbsp;<span class="num" id="4104918">0x36</span><span class="op" id="4104922">,</span>&nbsp;<span class="num" id="4104924">0x36</span><span class="op" id="4104928">,</span>&nbsp;<span class="num" id="4104930">0x36</span><span class="op" id="4104934">,</span>&nbsp;<span class="num" id="4104936">0x36</span><span class="op" id="4104940">,</span>&nbsp;<span class="num" id="4104942">0x36</span><span class="op" id="4104946">,</span>&nbsp;<span class="num" id="4104948">0x36</span><span class="op" id="4104952">,</span>&nbsp;<span class="num" id="4104954">0x36</span><span class="op" id="4104958">,</span>&nbsp;<span class="num" id="4104960">0x36</span><span class="op" id="4104964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4104967">var</span>&nbsp;<span class="ident" id="4104971">ssl30Pad2</span>&nbsp;<span class="op" id="4104981">=</span>&nbsp;<span class="op" id="4104983">[</span><span class="num" id="4104984">48</span><span class="op" id="4104986">]</span><span class="builtintype" id="4104987">byte</span><span class="op" id="4104991">{</span><span class="num" id="4104992">0x5c</span><span class="op" id="4104996">,</span>&nbsp;<span class="num" id="4104998">0x5c</span><span class="op" id="4105002">,</span>&nbsp;<span class="num" id="4105004">0x5c</span><span class="op" id="4105008">,</span>&nbsp;<span class="num" id="4105010">0x5c</span><span class="op" id="4105014">,</span>&nbsp;<span class="num" id="4105016">0x5c</span><span class="op" id="4105020">,</span>&nbsp;<span class="num" id="4105022">0x5c</span><span class="op" id="4105026">,</span>&nbsp;<span class="num" id="4105028">0x5c</span><span class="op" id="4105032">,</span>&nbsp;<span class="num" id="4105034">0x5c</span><span class="op" id="4105038">,</span>&nbsp;<span class="num" id="4105040">0x5c</span><span class="op" id="4105044">,</span>&nbsp;<span class="num" id="4105046">0x5c</span><span class="op" id="4105050">,</span>&nbsp;<span class="num" id="4105052">0x5c</span><span class="op" id="4105056">,</span>&nbsp;<span class="num" id="4105058">0x5c</span><span class="op" id="4105062">,</span>&nbsp;<span class="num" id="4105064">0x5c</span><span class="op" id="4105068">,</span>&nbsp;<span class="num" id="4105070">0x5c</span><span class="op" id="4105074">,</span>&nbsp;<span class="num" id="4105076">0x5c</span><span class="op" id="4105080">,</span>&nbsp;<span class="num" id="4105082">0x5c</span><span class="op" id="4105086">,</span>&nbsp;<span class="num" id="4105088">0x5c</span><span class="op" id="4105092">,</span>&nbsp;<span class="num" id="4105094">0x5c</span><span class="op" id="4105098">,</span>&nbsp;<span class="num" id="4105100">0x5c</span><span class="op" id="4105104">,</span>&nbsp;<span class="num" id="4105106">0x5c</span><span class="op" id="4105110">,</span>&nbsp;<span class="num" id="4105112">0x5c</span><span class="op" id="4105116">,</span>&nbsp;<span class="num" id="4105118">0x5c</span><span class="op" id="4105122">,</span>&nbsp;<span class="num" id="4105124">0x5c</span><span class="op" id="4105128">,</span>&nbsp;<span class="num" id="4105130">0x5c</span><span class="op" id="4105134">,</span>&nbsp;<span class="num" id="4105136">0x5c</span><span class="op" id="4105140">,</span>&nbsp;<span class="num" id="4105142">0x5c</span><span class="op" id="4105146">,</span>&nbsp;<span class="num" id="4105148">0x5c</span><span class="op" id="4105152">,</span>&nbsp;<span class="num" id="4105154">0x5c</span><span class="op" id="4105158">,</span>&nbsp;<span class="num" id="4105160">0x5c</span><span class="op" id="4105164">,</span>&nbsp;<span class="num" id="4105166">0x5c</span><span class="op" id="4105170">,</span>&nbsp;<span class="num" id="4105172">0x5c</span><span class="op" id="4105176">,</span>&nbsp;<span class="num" id="4105178">0x5c</span><span class="op" id="4105182">,</span>&nbsp;<span class="num" id="4105184">0x5c</span><span class="op" id="4105188">,</span>&nbsp;<span class="num" id="4105190">0x5c</span><span class="op" id="4105194">,</span>&nbsp;<span class="num" id="4105196">0x5c</span><span class="op" id="4105200">,</span>&nbsp;<span class="num" id="4105202">0x5c</span><span class="op" id="4105206">,</span>&nbsp;<span class="num" id="4105208">0x5c</span><span class="op" id="4105212">,</span>&nbsp;<span class="num" id="4105214">0x5c</span><span class="op" id="4105218">,</span>&nbsp;<span class="num" id="4105220">0x5c</span><span class="op" id="4105224">,</span>&nbsp;<span class="num" id="4105226">0x5c</span><span class="op" id="4105230">,</span>&nbsp;<span class="num" id="4105232">0x5c</span><span class="op" id="4105236">,</span>&nbsp;<span class="num" id="4105238">0x5c</span><span class="op" id="4105242">,</span>&nbsp;<span class="num" id="4105244">0x5c</span><span class="op" id="4105248">,</span>&nbsp;<span class="num" id="4105250">0x5c</span><span class="op" id="4105254">,</span>&nbsp;<span class="num" id="4105256">0x5c</span><span class="op" id="4105260">,</span>&nbsp;<span class="num" id="4105262">0x5c</span><span class="op" id="4105266">,</span>&nbsp;<span class="num" id="4105268">0x5c</span><span class="op" id="4105272">,</span>&nbsp;<span class="num" id="4105274">0x5c</span><span class="op" id="4105278">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="keyword" id="4105281">func</span>&nbsp;<span class="op" id="4105286">(</span><span class="ident" id="4105287">s</span>&nbsp;<span class="ident" id="4105289"><a href="/crypto/tls/cipher_suites.go.html#4104552">ssl30MAC</a></span><span class="op" id="4105297">)</span>&nbsp;<span class="ident" id="4105299">MAC</span><span class="op" id="4105302">(</span><span class="ident" id="4105303">digestBuf</span><span class="op" id="4105312">,</span>&nbsp;<span class="ident" id="4105314">seq</span><span class="op" id="4105317">,</span>&nbsp;<span class="ident" id="4105319">header</span><span class="op" id="4105325">,</span>&nbsp;<span class="ident" id="4105327">data</span>&nbsp;<span class="op" id="4105332">[</span><span class="op" id="4105333">]</span><span class="builtintype" id="4105334">byte</span><span class="op" id="4105338">)</span>&nbsp;<span class="op" id="4105340">[</span><span class="op" id="4105341">]</span><span class="builtintype" id="4105342">byte</span>&nbsp;<span class="op" id="4105347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105350">padLength</span>&nbsp;<span class="op" id="4105360">:=</span>&nbsp;<span class="num" id="4105363">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4105367">if</span>&nbsp;<span class="ident" id="4105370"><a href="/crypto/tls/cipher_suites.go.html#4105287">s</a></span><span class="op" id="4105371">.</span><span class="ident" id="4105372">h</span><span class="op" id="4105373">.</span><span class="ident" id="4105374">Size</span><span class="op" id="4105378">(</span><span class="op" id="4105379">)</span>&nbsp;<span class="op" id="4105381">==</span>&nbsp;<span class="num" id="4105384">20</span>&nbsp;<span class="op" id="4105387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105391"><a href="/crypto/tls/cipher_suites.go.html#4105350">padLength</a></span>&nbsp;<span class="op" id="4105401">=</span>&nbsp;<span class="num" id="4105403">40</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4105407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105411"><a href="/crypto/tls/cipher_suites.go.html#4105287">s</a></span><span class="op" id="4105412">.</span><span class="ident" id="4105413">h</span><span class="op" id="4105414">.</span><span class="ident" id="4105415">Reset</span><span class="op" id="4105420">(</span><span class="op" id="4105421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105424"><a href="/crypto/tls/cipher_suites.go.html#4105287">s</a></span><span class="op" id="4105425">.</span><span class="ident" id="4105426">h</span><span class="op" id="4105427">.</span><span class="ident" id="4105428">Write</span><span class="op" id="4105433">(</span><span class="ident" id="4105434"><a href="/crypto/tls/cipher_suites.go.html#4105287">s</a></span><span class="op" id="4105435">.</span><span class="ident" id="4105436">key</span><span class="op" id="4105439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105442"><a href="/crypto/tls/cipher_suites.go.html#4105287">s</a></span><span class="op" id="4105443">.</span><span class="ident" id="4105444">h</span><span class="op" id="4105445">.</span><span class="ident" id="4105446">Write</span><span class="op" id="4105451">(</span><span class="ident" id="4105452"><a href="/crypto/tls/cipher_suites.go.html#4104657">ssl30Pad1</a></span><span class="op" id="4105461">[</span><span class="op" id="4105462">:</span><span class="ident" id="4105463"><a href="/crypto/tls/cipher_suites.go.html#4105350">padLength</a></span><span class="op" id="4105472">]</span><span class="op" id="4105473">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105476"><a href="/crypto/tls/cipher_suites.go.html#4105287">s</a></span><span class="op" id="4105477">.</span><span class="ident" id="4105478">h</span><span class="op" id="4105479">.</span><span class="ident" id="4105480">Write</span><span class="op" id="4105485">(</span><span class="ident" id="4105486"><a href="/crypto/tls/cipher_suites.go.html#4105314">seq</a></span><span class="op" id="4105489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105492"><a href="/crypto/tls/cipher_suites.go.html#4105287">s</a></span><span class="op" id="4105493">.</span><span class="ident" id="4105494">h</span><span class="op" id="4105495">.</span><span class="ident" id="4105496">Write</span><span class="op" id="4105501">(</span><span class="ident" id="4105502"><a href="/crypto/tls/cipher_suites.go.html#4105319">header</a></span><span class="op" id="4105508">[</span><span class="op" id="4105509">:</span><span class="num" id="4105510">1</span><span class="op" id="4105511">]</span><span class="op" id="4105512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105515"><a href="/crypto/tls/cipher_suites.go.html#4105287">s</a></span><span class="op" id="4105516">.</span><span class="ident" id="4105517">h</span><span class="op" id="4105518">.</span><span class="ident" id="4105519">Write</span><span class="op" id="4105524">(</span><span class="ident" id="4105525"><a href="/crypto/tls/cipher_suites.go.html#4105319">header</a></span><span class="op" id="4105531">[</span><span class="num" id="4105532">3</span><span class="op" id="4105533">:</span><span class="num" id="4105534">5</span><span class="op" id="4105535">]</span><span class="op" id="4105536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105539"><a href="/crypto/tls/cipher_suites.go.html#4105287">s</a></span><span class="op" id="4105540">.</span><span class="ident" id="4105541">h</span><span class="op" id="4105542">.</span><span class="ident" id="4105543">Write</span><span class="op" id="4105548">(</span><span class="ident" id="4105549"><a href="/crypto/tls/cipher_suites.go.html#4105327">data</a></span><span class="op" id="4105553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105556"><a href="/crypto/tls/cipher_suites.go.html#4105303">digestBuf</a></span>&nbsp;<span class="op" id="4105566">=</span>&nbsp;<span class="ident" id="4105568"><a href="/crypto/tls/cipher_suites.go.html#4105287">s</a></span><span class="op" id="4105569">.</span><span class="ident" id="4105570">h</span><span class="op" id="4105571">.</span><span class="ident" id="4105572">Sum</span><span class="op" id="4105575">(</span><span class="ident" id="4105576"><a href="/crypto/tls/cipher_suites.go.html#4105303">digestBuf</a></span><span class="op" id="4105585">[</span><span class="op" id="4105586">:</span><span class="num" id="4105587">0</span><span class="op" id="4105588">]</span><span class="op" id="4105589">)</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105593"><a href="/crypto/tls/cipher_suites.go.html#4105287">s</a></span><span class="op" id="4105594">.</span><span class="ident" id="4105595">h</span><span class="op" id="4105596">.</span><span class="ident" id="4105597">Reset</span><span class="op" id="4105602">(</span><span class="op" id="4105603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105606"><a href="/crypto/tls/cipher_suites.go.html#4105287">s</a></span><span class="op" id="4105607">.</span><span class="ident" id="4105608">h</span><span class="op" id="4105609">.</span><span class="ident" id="4105610">Write</span><span class="op" id="4105615">(</span><span class="ident" id="4105616"><a href="/crypto/tls/cipher_suites.go.html#4105287">s</a></span><span class="op" id="4105617">.</span><span class="ident" id="4105618">key</span><span class="op" id="4105621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105624"><a href="/crypto/tls/cipher_suites.go.html#4105287">s</a></span><span class="op" id="4105625">.</span><span class="ident" id="4105626">h</span><span class="op" id="4105627">.</span><span class="ident" id="4105628">Write</span><span class="op" id="4105633">(</span><span class="ident" id="4105634"><a href="/crypto/tls/cipher_suites.go.html#4104971">ssl30Pad2</a></span><span class="op" id="4105643">[</span><span class="op" id="4105644">:</span><span class="ident" id="4105645"><a href="/crypto/tls/cipher_suites.go.html#4105350">padLength</a></span><span class="op" id="4105654">]</span><span class="op" id="4105655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105658"><a href="/crypto/tls/cipher_suites.go.html#4105287">s</a></span><span class="op" id="4105659">.</span><span class="ident" id="4105660">h</span><span class="op" id="4105661">.</span><span class="ident" id="4105662">Write</span><span class="op" id="4105667">(</span><span class="ident" id="4105668"><a href="/crypto/tls/cipher_suites.go.html#4105303">digestBuf</a></span><span class="op" id="4105677">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4105680">return</span>&nbsp;<span class="ident" id="4105687"><a href="/crypto/tls/cipher_suites.go.html#4105287">s</a></span><span class="op" id="4105688">.</span><span class="ident" id="4105689">h</span><span class="op" id="4105690">.</span><span class="ident" id="4105691">Sum</span><span class="op" id="4105694">(</span><span class="ident" id="4105695"><a href="/crypto/tls/cipher_suites.go.html#4105303">digestBuf</a></span><span class="op" id="4105704">[</span><span class="op" id="4105705">:</span><span class="num" id="4105706">0</span><span class="op" id="4105707">]</span><span class="op" id="4105708">)</span><br>
<span class="lineno"></span><span class="op" id="4105710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4105713">//&nbsp;tls10MAC&nbsp;implements&nbsp;the&nbsp;TLS&nbsp;1.0&nbsp;MAC&nbsp;function.&nbsp;RFC&nbsp;2246,&nbsp;section&nbsp;6.2.3.</span><br>
<span class="lineno"></span><span class="keyword" id="4105787">type</span>&nbsp;<span class="ident" id="4105792">tls10MAC</span>&nbsp;<span class="keyword" id="4105801">struct</span>&nbsp;<span class="op" id="4105808">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105811">h</span>&nbsp;<span class="ident" id="4105813"><a href="/crypto/tls/cipher_suites.go.html#4098599">hash</a></span><span class="op" id="4105817">.</span><span class="ident" id="4105818">Hash</span><br>
<span class="lineno"></span><span class="op" id="4105823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4105826">func</span>&nbsp;<span class="op" id="4105831">(</span><span class="ident" id="4105832">s</span>&nbsp;<span class="ident" id="4105834"><a href="/crypto/tls/cipher_suites.go.html#4105792">tls10MAC</a></span><span class="op" id="4105842">)</span>&nbsp;<span class="ident" id="4105844">Size</span><span class="op" id="4105848">(</span><span class="op" id="4105849">)</span>&nbsp;<span class="builtintype" id="4105851">int</span>&nbsp;<span class="op" id="4105855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4105858">return</span>&nbsp;<span class="ident" id="4105865"><a href="/crypto/tls/cipher_suites.go.html#4105832">s</a></span><span class="op" id="4105866">.</span><span class="ident" id="4105867">h</span><span class="op" id="4105868">.</span><span class="ident" id="4105869">Size</span><span class="op" id="4105873">(</span><span class="op" id="4105874">)</span><br>
<span class="lineno">210</span><span class="op" id="4105876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4105879">func</span>&nbsp;<span class="op" id="4105884">(</span><span class="ident" id="4105885">s</span>&nbsp;<span class="ident" id="4105887"><a href="/crypto/tls/cipher_suites.go.html#4105792">tls10MAC</a></span><span class="op" id="4105895">)</span>&nbsp;<span class="ident" id="4105897">MAC</span><span class="op" id="4105900">(</span><span class="ident" id="4105901">digestBuf</span><span class="op" id="4105910">,</span>&nbsp;<span class="ident" id="4105912">seq</span><span class="op" id="4105915">,</span>&nbsp;<span class="ident" id="4105917">header</span><span class="op" id="4105923">,</span>&nbsp;<span class="ident" id="4105925">data</span>&nbsp;<span class="op" id="4105930">[</span><span class="op" id="4105931">]</span><span class="builtintype" id="4105932">byte</span><span class="op" id="4105936">)</span>&nbsp;<span class="op" id="4105938">[</span><span class="op" id="4105939">]</span><span class="builtintype" id="4105940">byte</span>&nbsp;<span class="op" id="4105945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105948"><a href="/crypto/tls/cipher_suites.go.html#4105885">s</a></span><span class="op" id="4105949">.</span><span class="ident" id="4105950">h</span><span class="op" id="4105951">.</span><span class="ident" id="4105952">Reset</span><span class="op" id="4105957">(</span><span class="op" id="4105958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105961"><a href="/crypto/tls/cipher_suites.go.html#4105885">s</a></span><span class="op" id="4105962">.</span><span class="ident" id="4105963">h</span><span class="op" id="4105964">.</span><span class="ident" id="4105965">Write</span><span class="op" id="4105970">(</span><span class="ident" id="4105971"><a href="/crypto/tls/cipher_suites.go.html#4105912">seq</a></span><span class="op" id="4105974">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105977"><a href="/crypto/tls/cipher_suites.go.html#4105885">s</a></span><span class="op" id="4105978">.</span><span class="ident" id="4105979">h</span><span class="op" id="4105980">.</span><span class="ident" id="4105981">Write</span><span class="op" id="4105986">(</span><span class="ident" id="4105987"><a href="/crypto/tls/cipher_suites.go.html#4105917">header</a></span><span class="op" id="4105993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105996"><a href="/crypto/tls/cipher_suites.go.html#4105885">s</a></span><span class="op" id="4105997">.</span><span class="ident" id="4105998">h</span><span class="op" id="4105999">.</span><span class="ident" id="4106000">Write</span><span class="op" id="4106005">(</span><span class="ident" id="4106006"><a href="/crypto/tls/cipher_suites.go.html#4105925">data</a></span><span class="op" id="4106010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4106013">return</span>&nbsp;<span class="ident" id="4106020"><a href="/crypto/tls/cipher_suites.go.html#4105885">s</a></span><span class="op" id="4106021">.</span><span class="ident" id="4106022">h</span><span class="op" id="4106023">.</span><span class="ident" id="4106024">Sum</span><span class="op" id="4106027">(</span><span class="ident" id="4106028"><a href="/crypto/tls/cipher_suites.go.html#4105901">digestBuf</a></span><span class="op" id="4106037">[</span><span class="op" id="4106038">:</span><span class="num" id="4106039">0</span><span class="op" id="4106040">]</span><span class="op" id="4106041">)</span><br>
<span class="lineno"></span><span class="op" id="4106043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="4106046">func</span>&nbsp;<span class="ident" id="4106051">rsaKA</span><span class="op" id="4106056">(</span><span class="ident" id="4106057">version</span>&nbsp;<span class="builtintype" id="4106065">uint16</span><span class="op" id="4106071">)</span>&nbsp;<span class="ident" id="4106073"><a href="/crypto/tls/cipher_suites.go.html#4098757">keyAgreement</a></span>&nbsp;<span class="op" id="4106086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4106089">return</span>&nbsp;<span class="ident" id="4106096"><a href="/crypto/tls/key_agreement.go.html#4224107">rsaKeyAgreement</a></span><span class="op" id="4106111">{</span><span class="op" id="4106112">}</span><br>
<span class="lineno"></span><span class="op" id="4106114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4106117">func</span>&nbsp;<span class="ident" id="4106122">ecdheECDSAKA</span><span class="op" id="4106134">(</span><span class="ident" id="4106135">version</span>&nbsp;<span class="builtintype" id="4106143">uint16</span><span class="op" id="4106149">)</span>&nbsp;<span class="ident" id="4106151"><a href="/crypto/tls/cipher_suites.go.html#4098757">keyAgreement</a></span>&nbsp;<span class="op" id="4106164">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4106167">return</span>&nbsp;<span class="op" id="4106174">&amp;</span><span class="ident" id="4106175"><a href="/crypto/tls/key_agreement.go.html#4229411">ecdheKeyAgreement</a></span><span class="op" id="4106192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4106196">sigType</span><span class="op" id="4106203">:</span>&nbsp;<span class="ident" id="4106205"><a href="/crypto/tls/common.go.html#4111314">signatureECDSA</a></span><span class="op" id="4106219">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4106223">version</span><span class="op" id="4106230">:</span>&nbsp;<span class="ident" id="4106232"><a href="/crypto/tls/cipher_suites.go.html#4106135">version</a></span><span class="op" id="4106239">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4106242">}</span><br>
<span class="lineno"></span><span class="op" id="4106244">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="4106247">func</span>&nbsp;<span class="ident" id="4106252">ecdheRSAKA</span><span class="op" id="4106262">(</span><span class="ident" id="4106263">version</span>&nbsp;<span class="builtintype" id="4106271">uint16</span><span class="op" id="4106277">)</span>&nbsp;<span class="ident" id="4106279"><a href="/crypto/tls/cipher_suites.go.html#4098757">keyAgreement</a></span>&nbsp;<span class="op" id="4106292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4106295">return</span>&nbsp;<span class="op" id="4106302">&amp;</span><span class="ident" id="4106303"><a href="/crypto/tls/key_agreement.go.html#4229411">ecdheKeyAgreement</a></span><span class="op" id="4106320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4106324">sigType</span><span class="op" id="4106331">:</span>&nbsp;<span class="ident" id="4106333"><a href="/crypto/tls/common.go.html#4111288">signatureRSA</a></span><span class="op" id="4106345">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4106349">version</span><span class="op" id="4106356">:</span>&nbsp;<span class="ident" id="4106358"><a href="/crypto/tls/cipher_suites.go.html#4106263">version</a></span><span class="op" id="4106365">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4106368">}</span><br>
<span class="lineno"></span><span class="op" id="4106370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4106373">//&nbsp;mutualCipherSuite&nbsp;returns&nbsp;a&nbsp;cipherSuite&nbsp;given&nbsp;a&nbsp;list&nbsp;of&nbsp;supported</span><br>
<span class="lineno"></span><span class="comment" id="4106442">//&nbsp;ciphersuites&nbsp;and&nbsp;the&nbsp;id&nbsp;requested&nbsp;by&nbsp;the&nbsp;peer.</span><br>
<span class="lineno">240</span><span class="keyword" id="4106492">func</span>&nbsp;<span class="ident" id="4106497">mutualCipherSuite</span><span class="op" id="4106514">(</span><span class="ident" id="4106515">have</span>&nbsp;<span class="op" id="4106520">[</span><span class="op" id="4106521">]</span><span class="builtintype" id="4106522">uint16</span><span class="op" id="4106528">,</span>&nbsp;<span class="ident" id="4106530">want</span>&nbsp;<span class="builtintype" id="4106535">uint16</span><span class="op" id="4106541">)</span>&nbsp;<span class="op" id="4106543">*</span><span class="ident" id="4106544"><a href="/crypto/tls/cipher_suites.go.html#4100373">cipherSuite</a></span>&nbsp;<span class="op" id="4106556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4106559">for</span>&nbsp;<span class="ident" id="4106563">_</span><span class="op" id="4106564">,</span>&nbsp;<span class="ident" id="4106566">id</span>&nbsp;<span class="op" id="4106569">:=</span>&nbsp;<span class="keyword" id="4106572">range</span>&nbsp;<span class="ident" id="4106578"><a href="/crypto/tls/cipher_suites.go.html#4106515">have</a></span>&nbsp;<span class="op" id="4106583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4106587">if</span>&nbsp;<span class="ident" id="4106590"><a href="/crypto/tls/cipher_suites.go.html#4106566">id</a></span>&nbsp;<span class="op" id="4106593">==</span>&nbsp;<span class="ident" id="4106596"><a href="/crypto/tls/cipher_suites.go.html#4106530">want</a></span>&nbsp;<span class="op" id="4106601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4106606">for</span>&nbsp;<span class="ident" id="4106610">_</span><span class="op" id="4106611">,</span>&nbsp;<span class="ident" id="4106613">suite</span>&nbsp;<span class="op" id="4106619">:=</span>&nbsp;<span class="keyword" id="4106622">range</span>&nbsp;<span class="ident" id="4106628"><a href="/crypto/tls/cipher_suites.go.html#4100787">cipherSuites</a></span>&nbsp;<span class="op" id="4106641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4106647">if</span>&nbsp;<span class="ident" id="4106650"><a href="/crypto/tls/cipher_suites.go.html#4106613">suite</a></span><span class="op" id="4106655">.</span><span class="ident" id="4106656">id</span>&nbsp;<span class="op" id="4106659">==</span>&nbsp;<span class="ident" id="4106662"><a href="/crypto/tls/cipher_suites.go.html#4106530">want</a></span>&nbsp;<span class="op" id="4106667">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4106674">return</span>&nbsp;<span class="ident" id="4106681"><a href="/crypto/tls/cipher_suites.go.html#4106613">suite</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4106691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4106696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4106701">return</span>&nbsp;<span class="ident" id="4106708">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4106714">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4106717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4106720">return</span>&nbsp;<span class="ident" id="4106727">nil</span><br>
<span class="lineno"></span><span class="op" id="4106731">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4106734">//&nbsp;A&nbsp;list&nbsp;of&nbsp;the&nbsp;possible&nbsp;cipher&nbsp;suite&nbsp;ids.&nbsp;Taken&nbsp;from</span><br>
<span class="lineno">255</span><span class="comment" id="4106789">//&nbsp;http://www.iana.org/assignments/tls-parameters/tls-parameters.xml</span><br>
<span class="lineno"></span><span class="keyword" id="4106858">const</span>&nbsp;<span class="op" id="4106864">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4106867">TLS_RSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4106907">uint16</span>&nbsp;<span class="op" id="4106914">=</span>&nbsp;<span class="num" id="4106916">0x0005</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4106924">TLS_RSA_WITH_3DES_EDE_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4106964">uint16</span>&nbsp;<span class="op" id="4106971">=</span>&nbsp;<span class="num" id="4106973">0x000a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4106981">TLS_RSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4107021">uint16</span>&nbsp;<span class="op" id="4107028">=</span>&nbsp;<span class="num" id="4107030">0x002f</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107038">TLS_RSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4107078">uint16</span>&nbsp;<span class="op" id="4107085">=</span>&nbsp;<span class="num" id="4107087">0x0035</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107095">TLS_ECDHE_ECDSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4107135">uint16</span>&nbsp;<span class="op" id="4107142">=</span>&nbsp;<span class="num" id="4107144">0xc007</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107152">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4107192">uint16</span>&nbsp;<span class="op" id="4107199">=</span>&nbsp;<span class="num" id="4107201">0xc009</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107209">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4107249">uint16</span>&nbsp;<span class="op" id="4107256">=</span>&nbsp;<span class="num" id="4107258">0xc00a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107266">TLS_ECDHE_RSA_WITH_RC4_128_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4107306">uint16</span>&nbsp;<span class="op" id="4107313">=</span>&nbsp;<span class="num" id="4107315">0xc011</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107323">TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4107363">uint16</span>&nbsp;<span class="op" id="4107370">=</span>&nbsp;<span class="num" id="4107372">0xc012</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107380">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4107420">uint16</span>&nbsp;<span class="op" id="4107427">=</span>&nbsp;<span class="num" id="4107429">0xc013</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107437">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4107477">uint16</span>&nbsp;<span class="op" id="4107484">=</span>&nbsp;<span class="num" id="4107486">0xc014</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107494">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4107534">uint16</span>&nbsp;<span class="op" id="4107541">=</span>&nbsp;<span class="num" id="4107543">0xc02f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107551">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span>&nbsp;<span class="builtintype" id="4107591">uint16</span>&nbsp;<span class="op" id="4107598">=</span>&nbsp;<span class="num" id="4107600">0xc02b</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4107609">//&nbsp;TLS_FALLBACK_SCSV&nbsp;isn&#39;t&nbsp;a&nbsp;standard&nbsp;cipher&nbsp;suite&nbsp;but&nbsp;an&nbsp;indicator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4107678">//&nbsp;that&nbsp;the&nbsp;client&nbsp;is&nbsp;doing&nbsp;version&nbsp;fallback.&nbsp;See</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4107729">//&nbsp;https://tools.ietf.org/html/draft-ietf-tls-downgrade-scsv-00.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107795">TLS_FALLBACK_SCSV</span>&nbsp;<span class="builtintype" id="4107813">uint16</span>&nbsp;<span class="op" id="4107820">=</span>&nbsp;<span class="num" id="4107822">0x5600</span><br>
<span class="lineno">275</span><span class="op" id="4107829">)</span>
</div>
</body>
</html>
