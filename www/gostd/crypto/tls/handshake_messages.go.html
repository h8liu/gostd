<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html" class="current">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4568177">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4568232">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4568286">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4568337">package</span>&nbsp;<span class="ident" id="4568345">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4568350">import</span>&nbsp;<span class="string" id="4568357">&#34;bytes&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4568366">type</span>&nbsp;<span class="ident" id="4568371">clientHelloMsg</span>&nbsp;<span class="keyword" id="4568386">struct</span>&nbsp;<span class="op" id="4568393">{</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568396">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4568416">[</span><span class="op" id="4568417">]</span><span class="builtintype" id="4568418">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568424">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4568444">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568452">random</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4568472">[</span><span class="op" id="4568473">]</span><span class="builtintype" id="4568474">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568480">sessionId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4568500">[</span><span class="op" id="4568501">]</span><span class="builtintype" id="4568502">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568508">cipherSuites</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4568528">[</span><span class="op" id="4568529">]</span><span class="builtintype" id="4568530">uint16</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568538">compressionMethods</span>&nbsp;&nbsp;<span class="op" id="4568558">[</span><span class="op" id="4568559">]</span><span class="builtintype" id="4568560">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568567">nextProtoNeg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4568587">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568593">serverName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4568613">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568621">ocspStapling</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4568641">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568647">supportedCurves</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4568667">[</span><span class="op" id="4568668">]</span><span class="ident" id="4568669">CurveID</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568678">supportedPoints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4568698">[</span><span class="op" id="4568699">]</span><span class="builtintype" id="4568700">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568707">ticketSupported</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4568727">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568733">sessionTicket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4568753">[</span><span class="op" id="4568754">]</span><span class="builtintype" id="4568755">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568762">signatureAndHashes</span>&nbsp;&nbsp;<span class="op" id="4568782">[</span><span class="op" id="4568783">]</span><span class="ident" id="4568784">signatureAndHash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568802">secureRenegotiation</span>&nbsp;<span class="builtintype" id="4568822">bool</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568828">alpnProtocols</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4568848">[</span><span class="op" id="4568849">]</span><span class="builtintype" id="4568850">string</span><br>
<span class="lineno"></span><span class="op" id="4568857">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4568860">func</span>&nbsp;<span class="op" id="4568865">(</span><span class="ident" id="4568866">m</span>&nbsp;<span class="op" id="4568868">*</span><span class="ident" id="4568869">clientHelloMsg</span><span class="op" id="4568883">)</span>&nbsp;<span class="ident" id="4568885">equal</span><span class="op" id="4568890">(</span><span class="ident" id="4568891">i</span>&nbsp;<span class="keyword" id="4568893">interface</span><span class="op" id="4568902">{</span><span class="op" id="4568903">}</span><span class="op" id="4568904">)</span>&nbsp;<span class="builtintype" id="4568906">bool</span>&nbsp;<span class="op" id="4568911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568914">m1</span><span class="op" id="4568916">,</span>&nbsp;<span class="ident" id="4568918">ok</span>&nbsp;<span class="op" id="4568921">:=</span>&nbsp;<span class="ident" id="4568924">i</span><span class="op" id="4568925">.</span><span class="op" id="4568926">(</span><span class="op" id="4568927">*</span><span class="ident" id="4568928">clientHelloMsg</span><span class="op" id="4568942">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4568945">if</span>&nbsp;<span class="op" id="4568948">!</span><span class="ident" id="4568949">ok</span>&nbsp;<span class="op" id="4568952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4568956">return</span>&nbsp;<span class="builtintype" id="4568963">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4568970">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4568974">return</span>&nbsp;<span class="ident" id="4568981">bytes</span><span class="op" id="4568986">.</span><span class="ident" id="4568987">Equal</span><span class="op" id="4568992">(</span><span class="ident" id="4568993">m</span><span class="op" id="4568994">.</span><span class="ident" id="4568995">raw</span><span class="op" id="4568998">,</span>&nbsp;<span class="ident" id="4569000">m1</span><span class="op" id="4569002">.</span><span class="ident" id="4569003">raw</span><span class="op" id="4569006">)</span>&nbsp;<span class="op" id="4569008">&amp;&amp;</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4569013">m</span><span class="op" id="4569014">.</span><span class="ident" id="4569015">vers</span>&nbsp;<span class="op" id="4569020">==</span>&nbsp;<span class="ident" id="4569023">m1</span><span class="op" id="4569025">.</span><span class="ident" id="4569026">vers</span>&nbsp;<span class="op" id="4569031">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4569036">bytes</span><span class="op" id="4569041">.</span><span class="ident" id="4569042">Equal</span><span class="op" id="4569047">(</span><span class="ident" id="4569048">m</span><span class="op" id="4569049">.</span><span class="ident" id="4569050">random</span><span class="op" id="4569056">,</span>&nbsp;<span class="ident" id="4569058">m1</span><span class="op" id="4569060">.</span><span class="ident" id="4569061">random</span><span class="op" id="4569067">)</span>&nbsp;<span class="op" id="4569069">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4569074">bytes</span><span class="op" id="4569079">.</span><span class="ident" id="4569080">Equal</span><span class="op" id="4569085">(</span><span class="ident" id="4569086">m</span><span class="op" id="4569087">.</span><span class="ident" id="4569088">sessionId</span><span class="op" id="4569097">,</span>&nbsp;<span class="ident" id="4569099">m1</span><span class="op" id="4569101">.</span><span class="ident" id="4569102">sessionId</span><span class="op" id="4569111">)</span>&nbsp;<span class="op" id="4569113">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4569118">eqUint16s</span><span class="op" id="4569127">(</span><span class="ident" id="4569128">m</span><span class="op" id="4569129">.</span><span class="ident" id="4569130">cipherSuites</span><span class="op" id="4569142">,</span>&nbsp;<span class="ident" id="4569144">m1</span><span class="op" id="4569146">.</span><span class="ident" id="4569147">cipherSuites</span><span class="op" id="4569159">)</span>&nbsp;<span class="op" id="4569161">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4569166">bytes</span><span class="op" id="4569171">.</span><span class="ident" id="4569172">Equal</span><span class="op" id="4569177">(</span><span class="ident" id="4569178">m</span><span class="op" id="4569179">.</span><span class="ident" id="4569180">compressionMethods</span><span class="op" id="4569198">,</span>&nbsp;<span class="ident" id="4569200">m1</span><span class="op" id="4569202">.</span><span class="ident" id="4569203">compressionMethods</span><span class="op" id="4569221">)</span>&nbsp;<span class="op" id="4569223">&amp;&amp;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4569228">m</span><span class="op" id="4569229">.</span><span class="ident" id="4569230">nextProtoNeg</span>&nbsp;<span class="op" id="4569243">==</span>&nbsp;<span class="ident" id="4569246">m1</span><span class="op" id="4569248">.</span><span class="ident" id="4569249">nextProtoNeg</span>&nbsp;<span class="op" id="4569262">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4569267">m</span><span class="op" id="4569268">.</span><span class="ident" id="4569269">serverName</span>&nbsp;<span class="op" id="4569280">==</span>&nbsp;<span class="ident" id="4569283">m1</span><span class="op" id="4569285">.</span><span class="ident" id="4569286">serverName</span>&nbsp;<span class="op" id="4569297">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4569302">m</span><span class="op" id="4569303">.</span><span class="ident" id="4569304">ocspStapling</span>&nbsp;<span class="op" id="4569317">==</span>&nbsp;<span class="ident" id="4569320">m1</span><span class="op" id="4569322">.</span><span class="ident" id="4569323">ocspStapling</span>&nbsp;<span class="op" id="4569336">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4569341">eqCurveIDs</span><span class="op" id="4569351">(</span><span class="ident" id="4569352">m</span><span class="op" id="4569353">.</span><span class="ident" id="4569354">supportedCurves</span><span class="op" id="4569369">,</span>&nbsp;<span class="ident" id="4569371">m1</span><span class="op" id="4569373">.</span><span class="ident" id="4569374">supportedCurves</span><span class="op" id="4569389">)</span>&nbsp;<span class="op" id="4569391">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4569396">bytes</span><span class="op" id="4569401">.</span><span class="ident" id="4569402">Equal</span><span class="op" id="4569407">(</span><span class="ident" id="4569408">m</span><span class="op" id="4569409">.</span><span class="ident" id="4569410">supportedPoints</span><span class="op" id="4569425">,</span>&nbsp;<span class="ident" id="4569427">m1</span><span class="op" id="4569429">.</span><span class="ident" id="4569430">supportedPoints</span><span class="op" id="4569445">)</span>&nbsp;<span class="op" id="4569447">&amp;&amp;</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4569452">m</span><span class="op" id="4569453">.</span><span class="ident" id="4569454">ticketSupported</span>&nbsp;<span class="op" id="4569470">==</span>&nbsp;<span class="ident" id="4569473">m1</span><span class="op" id="4569475">.</span><span class="ident" id="4569476">ticketSupported</span>&nbsp;<span class="op" id="4569492">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4569497">bytes</span><span class="op" id="4569502">.</span><span class="ident" id="4569503">Equal</span><span class="op" id="4569508">(</span><span class="ident" id="4569509">m</span><span class="op" id="4569510">.</span><span class="ident" id="4569511">sessionTicket</span><span class="op" id="4569524">,</span>&nbsp;<span class="ident" id="4569526">m1</span><span class="op" id="4569528">.</span><span class="ident" id="4569529">sessionTicket</span><span class="op" id="4569542">)</span>&nbsp;<span class="op" id="4569544">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4569549">eqSignatureAndHashes</span><span class="op" id="4569569">(</span><span class="ident" id="4569570">m</span><span class="op" id="4569571">.</span><span class="ident" id="4569572">signatureAndHashes</span><span class="op" id="4569590">,</span>&nbsp;<span class="ident" id="4569592">m1</span><span class="op" id="4569594">.</span><span class="ident" id="4569595">signatureAndHashes</span><span class="op" id="4569613">)</span>&nbsp;<span class="op" id="4569615">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4569620">m</span><span class="op" id="4569621">.</span><span class="ident" id="4569622">secureRenegotiation</span>&nbsp;<span class="op" id="4569642">==</span>&nbsp;<span class="ident" id="4569645">m1</span><span class="op" id="4569647">.</span><span class="ident" id="4569648">secureRenegotiation</span>&nbsp;<span class="op" id="4569668">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4569673">eqStrings</span><span class="op" id="4569682">(</span><span class="ident" id="4569683">m</span><span class="op" id="4569684">.</span><span class="ident" id="4569685">alpnProtocols</span><span class="op" id="4569698">,</span>&nbsp;<span class="ident" id="4569700">m1</span><span class="op" id="4569702">.</span><span class="ident" id="4569703">alpnProtocols</span><span class="op" id="4569716">)</span><br>
<span class="lineno">50</span><span class="op" id="4569718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4569721">func</span>&nbsp;<span class="op" id="4569726">(</span><span class="ident" id="4569727">m</span>&nbsp;<span class="op" id="4569729">*</span><span class="ident" id="4569730">clientHelloMsg</span><span class="op" id="4569744">)</span>&nbsp;<span class="ident" id="4569746">marshal</span><span class="op" id="4569753">(</span><span class="op" id="4569754">)</span>&nbsp;<span class="op" id="4569756">[</span><span class="op" id="4569757">]</span><span class="builtintype" id="4569758">byte</span>&nbsp;<span class="op" id="4569763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4569766">if</span>&nbsp;<span class="ident" id="4569769">m</span><span class="op" id="4569770">.</span><span class="ident" id="4569771">raw</span>&nbsp;<span class="op" id="4569775">!=</span>&nbsp;<span class="ident" id="4569778">nil</span>&nbsp;<span class="op" id="4569782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4569786">return</span>&nbsp;<span class="ident" id="4569793">m</span><span class="op" id="4569794">.</span><span class="ident" id="4569795">raw</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4569800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4569804">length</span>&nbsp;<span class="op" id="4569811">:=</span>&nbsp;<span class="num" id="4569814">2</span>&nbsp;<span class="op" id="4569816">+</span>&nbsp;<span class="num" id="4569818">32</span>&nbsp;<span class="op" id="4569821">+</span>&nbsp;<span class="num" id="4569823">1</span>&nbsp;<span class="op" id="4569825">+</span>&nbsp;<span class="builtinfunc" id="4569827">len</span><span class="op" id="4569830">(</span><span class="ident" id="4569831">m</span><span class="op" id="4569832">.</span><span class="ident" id="4569833">sessionId</span><span class="op" id="4569842">)</span>&nbsp;<span class="op" id="4569844">+</span>&nbsp;<span class="num" id="4569846">2</span>&nbsp;<span class="op" id="4569848">+</span>&nbsp;<span class="builtinfunc" id="4569850">len</span><span class="op" id="4569853">(</span><span class="ident" id="4569854">m</span><span class="op" id="4569855">.</span><span class="ident" id="4569856">cipherSuites</span><span class="op" id="4569868">)</span><span class="op" id="4569869">*</span><span class="num" id="4569870">2</span>&nbsp;<span class="op" id="4569872">+</span>&nbsp;<span class="num" id="4569874">1</span>&nbsp;<span class="op" id="4569876">+</span>&nbsp;<span class="builtinfunc" id="4569878">len</span><span class="op" id="4569881">(</span><span class="ident" id="4569882">m</span><span class="op" id="4569883">.</span><span class="ident" id="4569884">compressionMethods</span><span class="op" id="4569902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4569905">numExtensions</span>&nbsp;<span class="op" id="4569919">:=</span>&nbsp;<span class="num" id="4569922">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4569925">extensionsLength</span>&nbsp;<span class="op" id="4569942">:=</span>&nbsp;<span class="num" id="4569945">0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4569948">if</span>&nbsp;<span class="ident" id="4569951">m</span><span class="op" id="4569952">.</span><span class="ident" id="4569953">nextProtoNeg</span>&nbsp;<span class="op" id="4569966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4569970">numExtensions</span><span class="op" id="4569983">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4569987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4569990">if</span>&nbsp;<span class="ident" id="4569993">m</span><span class="op" id="4569994">.</span><span class="ident" id="4569995">ocspStapling</span>&nbsp;<span class="op" id="4570008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570012">extensionsLength</span>&nbsp;<span class="op" id="4570029">+=</span>&nbsp;<span class="num" id="4570032">1</span>&nbsp;<span class="op" id="4570034">+</span>&nbsp;<span class="num" id="4570036">2</span>&nbsp;<span class="op" id="4570038">+</span>&nbsp;<span class="num" id="4570040">2</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570044">numExtensions</span><span class="op" id="4570057">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4570061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570064">if</span>&nbsp;<span class="builtinfunc" id="4570067">len</span><span class="op" id="4570070">(</span><span class="ident" id="4570071">m</span><span class="op" id="4570072">.</span><span class="ident" id="4570073">serverName</span><span class="op" id="4570083">)</span>&nbsp;<span class="op" id="4570085">&gt;</span>&nbsp;<span class="num" id="4570087">0</span>&nbsp;<span class="op" id="4570089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570093">extensionsLength</span>&nbsp;<span class="op" id="4570110">+=</span>&nbsp;<span class="num" id="4570113">5</span>&nbsp;<span class="op" id="4570115">+</span>&nbsp;<span class="builtinfunc" id="4570117">len</span><span class="op" id="4570120">(</span><span class="ident" id="4570121">m</span><span class="op" id="4570122">.</span><span class="ident" id="4570123">serverName</span><span class="op" id="4570133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570137">numExtensions</span><span class="op" id="4570150">++</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4570154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570157">if</span>&nbsp;<span class="builtinfunc" id="4570160">len</span><span class="op" id="4570163">(</span><span class="ident" id="4570164">m</span><span class="op" id="4570165">.</span><span class="ident" id="4570166">supportedCurves</span><span class="op" id="4570181">)</span>&nbsp;<span class="op" id="4570183">&gt;</span>&nbsp;<span class="num" id="4570185">0</span>&nbsp;<span class="op" id="4570187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570191">extensionsLength</span>&nbsp;<span class="op" id="4570208">+=</span>&nbsp;<span class="num" id="4570211">2</span>&nbsp;<span class="op" id="4570213">+</span>&nbsp;<span class="num" id="4570215">2</span><span class="op" id="4570216">*</span><span class="builtinfunc" id="4570217">len</span><span class="op" id="4570220">(</span><span class="ident" id="4570221">m</span><span class="op" id="4570222">.</span><span class="ident" id="4570223">supportedCurves</span><span class="op" id="4570238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570242">numExtensions</span><span class="op" id="4570255">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4570259">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570262">if</span>&nbsp;<span class="builtinfunc" id="4570265">len</span><span class="op" id="4570268">(</span><span class="ident" id="4570269">m</span><span class="op" id="4570270">.</span><span class="ident" id="4570271">supportedPoints</span><span class="op" id="4570286">)</span>&nbsp;<span class="op" id="4570288">&gt;</span>&nbsp;<span class="num" id="4570290">0</span>&nbsp;<span class="op" id="4570292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570296">extensionsLength</span>&nbsp;<span class="op" id="4570313">+=</span>&nbsp;<span class="num" id="4570316">1</span>&nbsp;<span class="op" id="4570318">+</span>&nbsp;<span class="builtinfunc" id="4570320">len</span><span class="op" id="4570323">(</span><span class="ident" id="4570324">m</span><span class="op" id="4570325">.</span><span class="ident" id="4570326">supportedPoints</span><span class="op" id="4570341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570345">numExtensions</span><span class="op" id="4570358">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4570362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570365">if</span>&nbsp;<span class="ident" id="4570368">m</span><span class="op" id="4570369">.</span><span class="ident" id="4570370">ticketSupported</span>&nbsp;<span class="op" id="4570386">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570390">extensionsLength</span>&nbsp;<span class="op" id="4570407">+=</span>&nbsp;<span class="builtinfunc" id="4570410">len</span><span class="op" id="4570413">(</span><span class="ident" id="4570414">m</span><span class="op" id="4570415">.</span><span class="ident" id="4570416">sessionTicket</span><span class="op" id="4570429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570433">numExtensions</span><span class="op" id="4570446">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4570450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570453">if</span>&nbsp;<span class="builtinfunc" id="4570456">len</span><span class="op" id="4570459">(</span><span class="ident" id="4570460">m</span><span class="op" id="4570461">.</span><span class="ident" id="4570462">signatureAndHashes</span><span class="op" id="4570480">)</span>&nbsp;<span class="op" id="4570482">&gt;</span>&nbsp;<span class="num" id="4570484">0</span>&nbsp;<span class="op" id="4570486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570490">extensionsLength</span>&nbsp;<span class="op" id="4570507">+=</span>&nbsp;<span class="num" id="4570510">2</span>&nbsp;<span class="op" id="4570512">+</span>&nbsp;<span class="num" id="4570514">2</span><span class="op" id="4570515">*</span><span class="builtinfunc" id="4570516">len</span><span class="op" id="4570519">(</span><span class="ident" id="4570520">m</span><span class="op" id="4570521">.</span><span class="ident" id="4570522">signatureAndHashes</span><span class="op" id="4570540">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570544">numExtensions</span><span class="op" id="4570557">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4570561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570564">if</span>&nbsp;<span class="ident" id="4570567">m</span><span class="op" id="4570568">.</span><span class="ident" id="4570569">secureRenegotiation</span>&nbsp;<span class="op" id="4570589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570593">extensionsLength</span>&nbsp;<span class="op" id="4570610">+=</span>&nbsp;<span class="num" id="4570613">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570617">numExtensions</span><span class="op" id="4570630">++</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4570634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570637">if</span>&nbsp;<span class="builtinfunc" id="4570640">len</span><span class="op" id="4570643">(</span><span class="ident" id="4570644">m</span><span class="op" id="4570645">.</span><span class="ident" id="4570646">alpnProtocols</span><span class="op" id="4570659">)</span>&nbsp;<span class="op" id="4570661">&gt;</span>&nbsp;<span class="num" id="4570663">0</span>&nbsp;<span class="op" id="4570665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570669">extensionsLength</span>&nbsp;<span class="op" id="4570686">+=</span>&nbsp;<span class="num" id="4570689">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570693">for</span>&nbsp;<span class="ident" id="4570697">_</span><span class="op" id="4570698">,</span>&nbsp;<span class="ident" id="4570700">s</span>&nbsp;<span class="op" id="4570702">:=</span>&nbsp;<span class="keyword" id="4570705">range</span>&nbsp;<span class="ident" id="4570711">m</span><span class="op" id="4570712">.</span><span class="ident" id="4570713">alpnProtocols</span>&nbsp;<span class="op" id="4570727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570732">if</span>&nbsp;<span class="ident" id="4570735">l</span>&nbsp;<span class="op" id="4570737">:=</span>&nbsp;<span class="builtinfunc" id="4570740">len</span><span class="op" id="4570743">(</span><span class="ident" id="4570744">s</span><span class="op" id="4570745">)</span><span class="op" id="4570746">;</span>&nbsp;<span class="ident" id="4570748">l</span>&nbsp;<span class="op" id="4570750">==</span>&nbsp;<span class="num" id="4570753">0</span>&nbsp;<span class="op" id="4570755">||</span>&nbsp;<span class="ident" id="4570758">l</span>&nbsp;<span class="op" id="4570760">&gt;</span>&nbsp;<span class="num" id="4570762">255</span>&nbsp;<span class="op" id="4570766">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4570772">panic</span><span class="op" id="4570777">(</span><span class="string" id="4570778">&#34;invalid&nbsp;ALPN&nbsp;protocol&#34;</span><span class="op" id="4570801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4570806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570811">extensionsLength</span><span class="op" id="4570827">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570833">extensionsLength</span>&nbsp;<span class="op" id="4570850">+=</span>&nbsp;<span class="builtinfunc" id="4570853">len</span><span class="op" id="4570856">(</span><span class="ident" id="4570857">s</span><span class="op" id="4570858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4570862">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570866">numExtensions</span><span class="op" id="4570879">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4570883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570886">if</span>&nbsp;<span class="ident" id="4570889">numExtensions</span>&nbsp;<span class="op" id="4570903">&gt;</span>&nbsp;<span class="num" id="4570905">0</span>&nbsp;<span class="op" id="4570907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570911">extensionsLength</span>&nbsp;<span class="op" id="4570928">+=</span>&nbsp;<span class="num" id="4570931">4</span>&nbsp;<span class="op" id="4570933">*</span>&nbsp;<span class="ident" id="4570935">numExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570951">length</span>&nbsp;<span class="op" id="4570958">+=</span>&nbsp;<span class="num" id="4570961">2</span>&nbsp;<span class="op" id="4570963">+</span>&nbsp;<span class="ident" id="4570965">extensionsLength</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4570983">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570987">x</span>&nbsp;<span class="op" id="4570989">:=</span>&nbsp;<span class="builtinfunc" id="4570992">make</span><span class="op" id="4570996">(</span><span class="op" id="4570997">[</span><span class="op" id="4570998">]</span><span class="builtintype" id="4570999">byte</span><span class="op" id="4571003">,</span>&nbsp;<span class="num" id="4571005">4</span><span class="op" id="4571006">+</span><span class="ident" id="4571007">length</span><span class="op" id="4571013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4571016">x</span><span class="op" id="4571017">[</span><span class="num" id="4571018">0</span><span class="op" id="4571019">]</span>&nbsp;<span class="op" id="4571021">=</span>&nbsp;<span class="ident" id="4571023">typeClientHello</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4571040">x</span><span class="op" id="4571041">[</span><span class="num" id="4571042">1</span><span class="op" id="4571043">]</span>&nbsp;<span class="op" id="4571045">=</span>&nbsp;<span class="builtintype" id="4571047">uint8</span><span class="op" id="4571052">(</span><span class="ident" id="4571053">length</span>&nbsp;<span class="op" id="4571060">&gt;&gt;</span>&nbsp;<span class="num" id="4571063">16</span><span class="op" id="4571065">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4571068">x</span><span class="op" id="4571069">[</span><span class="num" id="4571070">2</span><span class="op" id="4571071">]</span>&nbsp;<span class="op" id="4571073">=</span>&nbsp;<span class="builtintype" id="4571075">uint8</span><span class="op" id="4571080">(</span><span class="ident" id="4571081">length</span>&nbsp;<span class="op" id="4571088">&gt;&gt;</span>&nbsp;<span class="num" id="4571091">8</span><span class="op" id="4571092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4571095">x</span><span class="op" id="4571096">[</span><span class="num" id="4571097">3</span><span class="op" id="4571098">]</span>&nbsp;<span class="op" id="4571100">=</span>&nbsp;<span class="builtintype" id="4571102">uint8</span><span class="op" id="4571107">(</span><span class="ident" id="4571108">length</span><span class="op" id="4571114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4571117">x</span><span class="op" id="4571118">[</span><span class="num" id="4571119">4</span><span class="op" id="4571120">]</span>&nbsp;<span class="op" id="4571122">=</span>&nbsp;<span class="builtintype" id="4571124">uint8</span><span class="op" id="4571129">(</span><span class="ident" id="4571130">m</span><span class="op" id="4571131">.</span><span class="ident" id="4571132">vers</span>&nbsp;<span class="op" id="4571137">&gt;&gt;</span>&nbsp;<span class="num" id="4571140">8</span><span class="op" id="4571141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4571144">x</span><span class="op" id="4571145">[</span><span class="num" id="4571146">5</span><span class="op" id="4571147">]</span>&nbsp;<span class="op" id="4571149">=</span>&nbsp;<span class="builtintype" id="4571151">uint8</span><span class="op" id="4571156">(</span><span class="ident" id="4571157">m</span><span class="op" id="4571158">.</span><span class="ident" id="4571159">vers</span><span class="op" id="4571163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4571166">copy</span><span class="op" id="4571170">(</span><span class="ident" id="4571171">x</span><span class="op" id="4571172">[</span><span class="num" id="4571173">6</span><span class="op" id="4571174">:</span><span class="num" id="4571175">38</span><span class="op" id="4571177">]</span><span class="op" id="4571178">,</span>&nbsp;<span class="ident" id="4571180">m</span><span class="op" id="4571181">.</span><span class="ident" id="4571182">random</span><span class="op" id="4571188">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4571191">x</span><span class="op" id="4571192">[</span><span class="num" id="4571193">38</span><span class="op" id="4571195">]</span>&nbsp;<span class="op" id="4571197">=</span>&nbsp;<span class="builtintype" id="4571199">uint8</span><span class="op" id="4571204">(</span><span class="builtinfunc" id="4571205">len</span><span class="op" id="4571208">(</span><span class="ident" id="4571209">m</span><span class="op" id="4571210">.</span><span class="ident" id="4571211">sessionId</span><span class="op" id="4571220">)</span><span class="op" id="4571221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4571224">copy</span><span class="op" id="4571228">(</span><span class="ident" id="4571229">x</span><span class="op" id="4571230">[</span><span class="num" id="4571231">39</span><span class="op" id="4571233">:</span><span class="num" id="4571234">39</span><span class="op" id="4571236">+</span><span class="builtinfunc" id="4571237">len</span><span class="op" id="4571240">(</span><span class="ident" id="4571241">m</span><span class="op" id="4571242">.</span><span class="ident" id="4571243">sessionId</span><span class="op" id="4571252">)</span><span class="op" id="4571253">]</span><span class="op" id="4571254">,</span>&nbsp;<span class="ident" id="4571256">m</span><span class="op" id="4571257">.</span><span class="ident" id="4571258">sessionId</span><span class="op" id="4571267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4571270">y</span>&nbsp;<span class="op" id="4571272">:=</span>&nbsp;<span class="ident" id="4571275">x</span><span class="op" id="4571276">[</span><span class="num" id="4571277">39</span><span class="op" id="4571279">+</span><span class="builtinfunc" id="4571280">len</span><span class="op" id="4571283">(</span><span class="ident" id="4571284">m</span><span class="op" id="4571285">.</span><span class="ident" id="4571286">sessionId</span><span class="op" id="4571295">)</span><span class="op" id="4571296">:</span><span class="op" id="4571297">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4571300">y</span><span class="op" id="4571301">[</span><span class="num" id="4571302">0</span><span class="op" id="4571303">]</span>&nbsp;<span class="op" id="4571305">=</span>&nbsp;<span class="builtintype" id="4571307">uint8</span><span class="op" id="4571312">(</span><span class="builtinfunc" id="4571313">len</span><span class="op" id="4571316">(</span><span class="ident" id="4571317">m</span><span class="op" id="4571318">.</span><span class="ident" id="4571319">cipherSuites</span><span class="op" id="4571331">)</span>&nbsp;<span class="op" id="4571333">&gt;&gt;</span>&nbsp;<span class="num" id="4571336">7</span><span class="op" id="4571337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4571340">y</span><span class="op" id="4571341">[</span><span class="num" id="4571342">1</span><span class="op" id="4571343">]</span>&nbsp;<span class="op" id="4571345">=</span>&nbsp;<span class="builtintype" id="4571347">uint8</span><span class="op" id="4571352">(</span><span class="builtinfunc" id="4571353">len</span><span class="op" id="4571356">(</span><span class="ident" id="4571357">m</span><span class="op" id="4571358">.</span><span class="ident" id="4571359">cipherSuites</span><span class="op" id="4571371">)</span>&nbsp;<span class="op" id="4571373">&lt;&lt;</span>&nbsp;<span class="num" id="4571376">1</span><span class="op" id="4571377">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4571380">for</span>&nbsp;<span class="ident" id="4571384">i</span><span class="op" id="4571385">,</span>&nbsp;<span class="ident" id="4571387">suite</span>&nbsp;<span class="op" id="4571393">:=</span>&nbsp;<span class="keyword" id="4571396">range</span>&nbsp;<span class="ident" id="4571402">m</span><span class="op" id="4571403">.</span><span class="ident" id="4571404">cipherSuites</span>&nbsp;<span class="op" id="4571417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4571421">y</span><span class="op" id="4571422">[</span><span class="num" id="4571423">2</span><span class="op" id="4571424">+</span><span class="ident" id="4571425">i</span><span class="op" id="4571426">*</span><span class="num" id="4571427">2</span><span class="op" id="4571428">]</span>&nbsp;<span class="op" id="4571430">=</span>&nbsp;<span class="builtintype" id="4571432">uint8</span><span class="op" id="4571437">(</span><span class="ident" id="4571438">suite</span>&nbsp;<span class="op" id="4571444">&gt;&gt;</span>&nbsp;<span class="num" id="4571447">8</span><span class="op" id="4571448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4571452">y</span><span class="op" id="4571453">[</span><span class="num" id="4571454">3</span><span class="op" id="4571455">+</span><span class="ident" id="4571456">i</span><span class="op" id="4571457">*</span><span class="num" id="4571458">2</span><span class="op" id="4571459">]</span>&nbsp;<span class="op" id="4571461">=</span>&nbsp;<span class="builtintype" id="4571463">uint8</span><span class="op" id="4571468">(</span><span class="ident" id="4571469">suite</span><span class="op" id="4571474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4571477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4571480">z</span>&nbsp;<span class="op" id="4571482">:=</span>&nbsp;<span class="ident" id="4571485">y</span><span class="op" id="4571486">[</span><span class="num" id="4571487">2</span><span class="op" id="4571488">+</span><span class="builtinfunc" id="4571489">len</span><span class="op" id="4571492">(</span><span class="ident" id="4571493">m</span><span class="op" id="4571494">.</span><span class="ident" id="4571495">cipherSuites</span><span class="op" id="4571507">)</span><span class="op" id="4571508">*</span><span class="num" id="4571509">2</span><span class="op" id="4571510">:</span><span class="op" id="4571511">]</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4571514">z</span><span class="op" id="4571515">[</span><span class="num" id="4571516">0</span><span class="op" id="4571517">]</span>&nbsp;<span class="op" id="4571519">=</span>&nbsp;<span class="builtintype" id="4571521">uint8</span><span class="op" id="4571526">(</span><span class="builtinfunc" id="4571527">len</span><span class="op" id="4571530">(</span><span class="ident" id="4571531">m</span><span class="op" id="4571532">.</span><span class="ident" id="4571533">compressionMethods</span><span class="op" id="4571551">)</span><span class="op" id="4571552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4571555">copy</span><span class="op" id="4571559">(</span><span class="ident" id="4571560">z</span><span class="op" id="4571561">[</span><span class="num" id="4571562">1</span><span class="op" id="4571563">:</span><span class="op" id="4571564">]</span><span class="op" id="4571565">,</span>&nbsp;<span class="ident" id="4571567">m</span><span class="op" id="4571568">.</span><span class="ident" id="4571569">compressionMethods</span><span class="op" id="4571587">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4571591">z</span>&nbsp;<span class="op" id="4571593">=</span>&nbsp;<span class="ident" id="4571595">z</span><span class="op" id="4571596">[</span><span class="num" id="4571597">1</span><span class="op" id="4571598">+</span><span class="builtinfunc" id="4571599">len</span><span class="op" id="4571602">(</span><span class="ident" id="4571603">m</span><span class="op" id="4571604">.</span><span class="ident" id="4571605">compressionMethods</span><span class="op" id="4571623">)</span><span class="op" id="4571624">:</span><span class="op" id="4571625">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4571628">if</span>&nbsp;<span class="ident" id="4571631">numExtensions</span>&nbsp;<span class="op" id="4571645">&gt;</span>&nbsp;<span class="num" id="4571647">0</span>&nbsp;<span class="op" id="4571649">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4571653">z</span><span class="op" id="4571654">[</span><span class="num" id="4571655">0</span><span class="op" id="4571656">]</span>&nbsp;<span class="op" id="4571658">=</span>&nbsp;<span class="builtintype" id="4571660">byte</span><span class="op" id="4571664">(</span><span class="ident" id="4571665">extensionsLength</span>&nbsp;<span class="op" id="4571682">&gt;&gt;</span>&nbsp;<span class="num" id="4571685">8</span><span class="op" id="4571686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4571690">z</span><span class="op" id="4571691">[</span><span class="num" id="4571692">1</span><span class="op" id="4571693">]</span>&nbsp;<span class="op" id="4571695">=</span>&nbsp;<span class="builtintype" id="4571697">byte</span><span class="op" id="4571701">(</span><span class="ident" id="4571702">extensionsLength</span><span class="op" id="4571718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4571722">z</span>&nbsp;<span class="op" id="4571724">=</span>&nbsp;<span class="ident" id="4571726">z</span><span class="op" id="4571727">[</span><span class="num" id="4571728">2</span><span class="op" id="4571729">:</span><span class="op" id="4571730">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4571733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4571736">if</span>&nbsp;<span class="ident" id="4571739">m</span><span class="op" id="4571740">.</span><span class="ident" id="4571741">nextProtoNeg</span>&nbsp;<span class="op" id="4571754">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4571758">z</span><span class="op" id="4571759">[</span><span class="num" id="4571760">0</span><span class="op" id="4571761">]</span>&nbsp;<span class="op" id="4571763">=</span>&nbsp;<span class="builtintype" id="4571765">byte</span><span class="op" id="4571769">(</span><span class="ident" id="4571770">extensionNextProtoNeg</span>&nbsp;<span class="op" id="4571792">&gt;&gt;</span>&nbsp;<span class="num" id="4571795">8</span><span class="op" id="4571796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4571800">z</span><span class="op" id="4571801">[</span><span class="num" id="4571802">1</span><span class="op" id="4571803">]</span>&nbsp;<span class="op" id="4571805">=</span>&nbsp;<span class="builtintype" id="4571807">byte</span><span class="op" id="4571811">(</span><span class="ident" id="4571812">extensionNextProtoNeg</span>&nbsp;<span class="op" id="4571834">&amp;</span>&nbsp;<span class="num" id="4571836">0xff</span><span class="op" id="4571840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4571844">//&nbsp;The&nbsp;length&nbsp;is&nbsp;always&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4571872">z</span>&nbsp;<span class="op" id="4571874">=</span>&nbsp;<span class="ident" id="4571876">z</span><span class="op" id="4571877">[</span><span class="num" id="4571878">4</span><span class="op" id="4571879">:</span><span class="op" id="4571880">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4571883">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4571886">if</span>&nbsp;<span class="builtinfunc" id="4571889">len</span><span class="op" id="4571892">(</span><span class="ident" id="4571893">m</span><span class="op" id="4571894">.</span><span class="ident" id="4571895">serverName</span><span class="op" id="4571905">)</span>&nbsp;<span class="op" id="4571907">&gt;</span>&nbsp;<span class="num" id="4571909">0</span>&nbsp;<span class="op" id="4571911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4571915">z</span><span class="op" id="4571916">[</span><span class="num" id="4571917">0</span><span class="op" id="4571918">]</span>&nbsp;<span class="op" id="4571920">=</span>&nbsp;<span class="builtintype" id="4571922">byte</span><span class="op" id="4571926">(</span><span class="ident" id="4571927">extensionServerName</span>&nbsp;<span class="op" id="4571947">&gt;&gt;</span>&nbsp;<span class="num" id="4571950">8</span><span class="op" id="4571951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4571955">z</span><span class="op" id="4571956">[</span><span class="num" id="4571957">1</span><span class="op" id="4571958">]</span>&nbsp;<span class="op" id="4571960">=</span>&nbsp;<span class="builtintype" id="4571962">byte</span><span class="op" id="4571966">(</span><span class="ident" id="4571967">extensionServerName</span>&nbsp;<span class="op" id="4571987">&amp;</span>&nbsp;<span class="num" id="4571989">0xff</span><span class="op" id="4571993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4571997">l</span>&nbsp;<span class="op" id="4571999">:=</span>&nbsp;<span class="builtinfunc" id="4572002">len</span><span class="op" id="4572005">(</span><span class="ident" id="4572006">m</span><span class="op" id="4572007">.</span><span class="ident" id="4572008">serverName</span><span class="op" id="4572018">)</span>&nbsp;<span class="op" id="4572020">+</span>&nbsp;<span class="num" id="4572022">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4572026">z</span><span class="op" id="4572027">[</span><span class="num" id="4572028">2</span><span class="op" id="4572029">]</span>&nbsp;<span class="op" id="4572031">=</span>&nbsp;<span class="builtintype" id="4572033">byte</span><span class="op" id="4572037">(</span><span class="ident" id="4572038">l</span>&nbsp;<span class="op" id="4572040">&gt;&gt;</span>&nbsp;<span class="num" id="4572043">8</span><span class="op" id="4572044">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4572048">z</span><span class="op" id="4572049">[</span><span class="num" id="4572050">3</span><span class="op" id="4572051">]</span>&nbsp;<span class="op" id="4572053">=</span>&nbsp;<span class="builtintype" id="4572055">byte</span><span class="op" id="4572059">(</span><span class="ident" id="4572060">l</span><span class="op" id="4572061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4572065">z</span>&nbsp;<span class="op" id="4572067">=</span>&nbsp;<span class="ident" id="4572069">z</span><span class="op" id="4572070">[</span><span class="num" id="4572071">4</span><span class="op" id="4572072">:</span><span class="op" id="4572073">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4572078">//&nbsp;RFC&nbsp;3546,&nbsp;section&nbsp;3.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4572105">//</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4572110">//&nbsp;struct&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4572124">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NameType&nbsp;name_type;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4572153">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;(name_type)&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4572183">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;host_name:&nbsp;HostName;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4572222">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;name;</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4572239">//&nbsp;}&nbsp;ServerName;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4572258">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4572263">//&nbsp;enum&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4572275">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;host_name(0),&nbsp;(255)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4572304">//&nbsp;}&nbsp;NameType;</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4572321">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4572326">//&nbsp;opaque&nbsp;HostName&lt;1..2^16-1&gt;;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4572359">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4572364">//&nbsp;struct&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4572378">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ServerName&nbsp;server_name_list&lt;1..2^16-1&gt;</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4572426">//&nbsp;}&nbsp;ServerNameList;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4572450">z</span><span class="op" id="4572451">[</span><span class="num" id="4572452">0</span><span class="op" id="4572453">]</span>&nbsp;<span class="op" id="4572455">=</span>&nbsp;<span class="builtintype" id="4572457">byte</span><span class="op" id="4572461">(</span><span class="op" id="4572462">(</span><span class="builtinfunc" id="4572463">len</span><span class="op" id="4572466">(</span><span class="ident" id="4572467">m</span><span class="op" id="4572468">.</span><span class="ident" id="4572469">serverName</span><span class="op" id="4572479">)</span>&nbsp;<span class="op" id="4572481">+</span>&nbsp;<span class="num" id="4572483">3</span><span class="op" id="4572484">)</span>&nbsp;<span class="op" id="4572486">&gt;&gt;</span>&nbsp;<span class="num" id="4572489">8</span><span class="op" id="4572490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4572494">z</span><span class="op" id="4572495">[</span><span class="num" id="4572496">1</span><span class="op" id="4572497">]</span>&nbsp;<span class="op" id="4572499">=</span>&nbsp;<span class="builtintype" id="4572501">byte</span><span class="op" id="4572505">(</span><span class="builtinfunc" id="4572506">len</span><span class="op" id="4572509">(</span><span class="ident" id="4572510">m</span><span class="op" id="4572511">.</span><span class="ident" id="4572512">serverName</span><span class="op" id="4572522">)</span>&nbsp;<span class="op" id="4572524">+</span>&nbsp;<span class="num" id="4572526">3</span><span class="op" id="4572527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4572531">z</span><span class="op" id="4572532">[</span><span class="num" id="4572533">3</span><span class="op" id="4572534">]</span>&nbsp;<span class="op" id="4572536">=</span>&nbsp;<span class="builtintype" id="4572538">byte</span><span class="op" id="4572542">(</span><span class="builtinfunc" id="4572543">len</span><span class="op" id="4572546">(</span><span class="ident" id="4572547">m</span><span class="op" id="4572548">.</span><span class="ident" id="4572549">serverName</span><span class="op" id="4572559">)</span>&nbsp;<span class="op" id="4572561">&gt;&gt;</span>&nbsp;<span class="num" id="4572564">8</span><span class="op" id="4572565">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4572569">z</span><span class="op" id="4572570">[</span><span class="num" id="4572571">4</span><span class="op" id="4572572">]</span>&nbsp;<span class="op" id="4572574">=</span>&nbsp;<span class="builtintype" id="4572576">byte</span><span class="op" id="4572580">(</span><span class="builtinfunc" id="4572581">len</span><span class="op" id="4572584">(</span><span class="ident" id="4572585">m</span><span class="op" id="4572586">.</span><span class="ident" id="4572587">serverName</span><span class="op" id="4572597">)</span><span class="op" id="4572598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4572602">copy</span><span class="op" id="4572606">(</span><span class="ident" id="4572607">z</span><span class="op" id="4572608">[</span><span class="num" id="4572609">5</span><span class="op" id="4572610">:</span><span class="op" id="4572611">]</span><span class="op" id="4572612">,</span>&nbsp;<span class="op" id="4572614">[</span><span class="op" id="4572615">]</span><span class="builtintype" id="4572616">byte</span><span class="op" id="4572620">(</span><span class="ident" id="4572621">m</span><span class="op" id="4572622">.</span><span class="ident" id="4572623">serverName</span><span class="op" id="4572633">)</span><span class="op" id="4572634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4572638">z</span>&nbsp;<span class="op" id="4572640">=</span>&nbsp;<span class="ident" id="4572642">z</span><span class="op" id="4572643">[</span><span class="ident" id="4572644">l</span><span class="op" id="4572645">:</span><span class="op" id="4572646">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4572649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4572652">if</span>&nbsp;<span class="ident" id="4572655">m</span><span class="op" id="4572656">.</span><span class="ident" id="4572657">ocspStapling</span>&nbsp;<span class="op" id="4572670">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4572674">//&nbsp;RFC&nbsp;4366,&nbsp;section&nbsp;3.6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4572701">z</span><span class="op" id="4572702">[</span><span class="num" id="4572703">0</span><span class="op" id="4572704">]</span>&nbsp;<span class="op" id="4572706">=</span>&nbsp;<span class="builtintype" id="4572708">byte</span><span class="op" id="4572712">(</span><span class="ident" id="4572713">extensionStatusRequest</span>&nbsp;<span class="op" id="4572736">&gt;&gt;</span>&nbsp;<span class="num" id="4572739">8</span><span class="op" id="4572740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4572744">z</span><span class="op" id="4572745">[</span><span class="num" id="4572746">1</span><span class="op" id="4572747">]</span>&nbsp;<span class="op" id="4572749">=</span>&nbsp;<span class="builtintype" id="4572751">byte</span><span class="op" id="4572755">(</span><span class="ident" id="4572756">extensionStatusRequest</span><span class="op" id="4572778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4572782">z</span><span class="op" id="4572783">[</span><span class="num" id="4572784">2</span><span class="op" id="4572785">]</span>&nbsp;<span class="op" id="4572787">=</span>&nbsp;<span class="num" id="4572789">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4572793">z</span><span class="op" id="4572794">[</span><span class="num" id="4572795">3</span><span class="op" id="4572796">]</span>&nbsp;<span class="op" id="4572798">=</span>&nbsp;<span class="num" id="4572800">5</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4572804">z</span><span class="op" id="4572805">[</span><span class="num" id="4572806">4</span><span class="op" id="4572807">]</span>&nbsp;<span class="op" id="4572809">=</span>&nbsp;<span class="num" id="4572811">1</span>&nbsp;<span class="comment" id="4572813">//&nbsp;OCSP&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4572828">//&nbsp;Two&nbsp;zero&nbsp;valued&nbsp;uint16s&nbsp;for&nbsp;the&nbsp;two&nbsp;lengths.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4572878">z</span>&nbsp;<span class="op" id="4572880">=</span>&nbsp;<span class="ident" id="4572882">z</span><span class="op" id="4572883">[</span><span class="num" id="4572884">9</span><span class="op" id="4572885">:</span><span class="op" id="4572886">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4572889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4572892">if</span>&nbsp;<span class="builtinfunc" id="4572895">len</span><span class="op" id="4572898">(</span><span class="ident" id="4572899">m</span><span class="op" id="4572900">.</span><span class="ident" id="4572901">supportedCurves</span><span class="op" id="4572916">)</span>&nbsp;<span class="op" id="4572918">&gt;</span>&nbsp;<span class="num" id="4572920">0</span>&nbsp;<span class="op" id="4572922">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4572926">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4572980">z</span><span class="op" id="4572981">[</span><span class="num" id="4572982">0</span><span class="op" id="4572983">]</span>&nbsp;<span class="op" id="4572985">=</span>&nbsp;<span class="builtintype" id="4572987">byte</span><span class="op" id="4572991">(</span><span class="ident" id="4572992">extensionSupportedCurves</span>&nbsp;<span class="op" id="4573017">&gt;&gt;</span>&nbsp;<span class="num" id="4573020">8</span><span class="op" id="4573021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573025">z</span><span class="op" id="4573026">[</span><span class="num" id="4573027">1</span><span class="op" id="4573028">]</span>&nbsp;<span class="op" id="4573030">=</span>&nbsp;<span class="builtintype" id="4573032">byte</span><span class="op" id="4573036">(</span><span class="ident" id="4573037">extensionSupportedCurves</span><span class="op" id="4573061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573065">l</span>&nbsp;<span class="op" id="4573067">:=</span>&nbsp;<span class="num" id="4573070">2</span>&nbsp;<span class="op" id="4573072">+</span>&nbsp;<span class="num" id="4573074">2</span><span class="op" id="4573075">*</span><span class="builtinfunc" id="4573076">len</span><span class="op" id="4573079">(</span><span class="ident" id="4573080">m</span><span class="op" id="4573081">.</span><span class="ident" id="4573082">supportedCurves</span><span class="op" id="4573097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573101">z</span><span class="op" id="4573102">[</span><span class="num" id="4573103">2</span><span class="op" id="4573104">]</span>&nbsp;<span class="op" id="4573106">=</span>&nbsp;<span class="builtintype" id="4573108">byte</span><span class="op" id="4573112">(</span><span class="ident" id="4573113">l</span>&nbsp;<span class="op" id="4573115">&gt;&gt;</span>&nbsp;<span class="num" id="4573118">8</span><span class="op" id="4573119">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573123">z</span><span class="op" id="4573124">[</span><span class="num" id="4573125">3</span><span class="op" id="4573126">]</span>&nbsp;<span class="op" id="4573128">=</span>&nbsp;<span class="builtintype" id="4573130">byte</span><span class="op" id="4573134">(</span><span class="ident" id="4573135">l</span><span class="op" id="4573136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573140">l</span>&nbsp;<span class="op" id="4573142">-=</span>&nbsp;<span class="num" id="4573145">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573149">z</span><span class="op" id="4573150">[</span><span class="num" id="4573151">4</span><span class="op" id="4573152">]</span>&nbsp;<span class="op" id="4573154">=</span>&nbsp;<span class="builtintype" id="4573156">byte</span><span class="op" id="4573160">(</span><span class="ident" id="4573161">l</span>&nbsp;<span class="op" id="4573163">&gt;&gt;</span>&nbsp;<span class="num" id="4573166">8</span><span class="op" id="4573167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573171">z</span><span class="op" id="4573172">[</span><span class="num" id="4573173">5</span><span class="op" id="4573174">]</span>&nbsp;<span class="op" id="4573176">=</span>&nbsp;<span class="builtintype" id="4573178">byte</span><span class="op" id="4573182">(</span><span class="ident" id="4573183">l</span><span class="op" id="4573184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573188">z</span>&nbsp;<span class="op" id="4573190">=</span>&nbsp;<span class="ident" id="4573192">z</span><span class="op" id="4573193">[</span><span class="num" id="4573194">6</span><span class="op" id="4573195">:</span><span class="op" id="4573196">]</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4573200">for</span>&nbsp;<span class="ident" id="4573204">_</span><span class="op" id="4573205">,</span>&nbsp;<span class="ident" id="4573207">curve</span>&nbsp;<span class="op" id="4573213">:=</span>&nbsp;<span class="keyword" id="4573216">range</span>&nbsp;<span class="ident" id="4573222">m</span><span class="op" id="4573223">.</span><span class="ident" id="4573224">supportedCurves</span>&nbsp;<span class="op" id="4573240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573245">z</span><span class="op" id="4573246">[</span><span class="num" id="4573247">0</span><span class="op" id="4573248">]</span>&nbsp;<span class="op" id="4573250">=</span>&nbsp;<span class="builtintype" id="4573252">byte</span><span class="op" id="4573256">(</span><span class="ident" id="4573257">curve</span>&nbsp;<span class="op" id="4573263">&gt;&gt;</span>&nbsp;<span class="num" id="4573266">8</span><span class="op" id="4573267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573272">z</span><span class="op" id="4573273">[</span><span class="num" id="4573274">1</span><span class="op" id="4573275">]</span>&nbsp;<span class="op" id="4573277">=</span>&nbsp;<span class="builtintype" id="4573279">byte</span><span class="op" id="4573283">(</span><span class="ident" id="4573284">curve</span><span class="op" id="4573289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573294">z</span>&nbsp;<span class="op" id="4573296">=</span>&nbsp;<span class="ident" id="4573298">z</span><span class="op" id="4573299">[</span><span class="num" id="4573300">2</span><span class="op" id="4573301">:</span><span class="op" id="4573302">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4573306">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4573309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4573312">if</span>&nbsp;<span class="builtinfunc" id="4573315">len</span><span class="op" id="4573318">(</span><span class="ident" id="4573319">m</span><span class="op" id="4573320">.</span><span class="ident" id="4573321">supportedPoints</span><span class="op" id="4573336">)</span>&nbsp;<span class="op" id="4573338">&gt;</span>&nbsp;<span class="num" id="4573340">0</span>&nbsp;<span class="op" id="4573342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4573346">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573400">z</span><span class="op" id="4573401">[</span><span class="num" id="4573402">0</span><span class="op" id="4573403">]</span>&nbsp;<span class="op" id="4573405">=</span>&nbsp;<span class="builtintype" id="4573407">byte</span><span class="op" id="4573411">(</span><span class="ident" id="4573412">extensionSupportedPoints</span>&nbsp;<span class="op" id="4573437">&gt;&gt;</span>&nbsp;<span class="num" id="4573440">8</span><span class="op" id="4573441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573445">z</span><span class="op" id="4573446">[</span><span class="num" id="4573447">1</span><span class="op" id="4573448">]</span>&nbsp;<span class="op" id="4573450">=</span>&nbsp;<span class="builtintype" id="4573452">byte</span><span class="op" id="4573456">(</span><span class="ident" id="4573457">extensionSupportedPoints</span><span class="op" id="4573481">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573485">l</span>&nbsp;<span class="op" id="4573487">:=</span>&nbsp;<span class="num" id="4573490">1</span>&nbsp;<span class="op" id="4573492">+</span>&nbsp;<span class="builtinfunc" id="4573494">len</span><span class="op" id="4573497">(</span><span class="ident" id="4573498">m</span><span class="op" id="4573499">.</span><span class="ident" id="4573500">supportedPoints</span><span class="op" id="4573515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573519">z</span><span class="op" id="4573520">[</span><span class="num" id="4573521">2</span><span class="op" id="4573522">]</span>&nbsp;<span class="op" id="4573524">=</span>&nbsp;<span class="builtintype" id="4573526">byte</span><span class="op" id="4573530">(</span><span class="ident" id="4573531">l</span>&nbsp;<span class="op" id="4573533">&gt;&gt;</span>&nbsp;<span class="num" id="4573536">8</span><span class="op" id="4573537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573541">z</span><span class="op" id="4573542">[</span><span class="num" id="4573543">3</span><span class="op" id="4573544">]</span>&nbsp;<span class="op" id="4573546">=</span>&nbsp;<span class="builtintype" id="4573548">byte</span><span class="op" id="4573552">(</span><span class="ident" id="4573553">l</span><span class="op" id="4573554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573558">l</span><span class="op" id="4573559">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573564">z</span><span class="op" id="4573565">[</span><span class="num" id="4573566">4</span><span class="op" id="4573567">]</span>&nbsp;<span class="op" id="4573569">=</span>&nbsp;<span class="builtintype" id="4573571">byte</span><span class="op" id="4573575">(</span><span class="ident" id="4573576">l</span><span class="op" id="4573577">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573581">z</span>&nbsp;<span class="op" id="4573583">=</span>&nbsp;<span class="ident" id="4573585">z</span><span class="op" id="4573586">[</span><span class="num" id="4573587">5</span><span class="op" id="4573588">:</span><span class="op" id="4573589">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4573593">for</span>&nbsp;<span class="ident" id="4573597">_</span><span class="op" id="4573598">,</span>&nbsp;<span class="ident" id="4573600">pointFormat</span>&nbsp;<span class="op" id="4573612">:=</span>&nbsp;<span class="keyword" id="4573615">range</span>&nbsp;<span class="ident" id="4573621">m</span><span class="op" id="4573622">.</span><span class="ident" id="4573623">supportedPoints</span>&nbsp;<span class="op" id="4573639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573644">z</span><span class="op" id="4573645">[</span><span class="num" id="4573646">0</span><span class="op" id="4573647">]</span>&nbsp;<span class="op" id="4573649">=</span>&nbsp;<span class="builtintype" id="4573651">byte</span><span class="op" id="4573655">(</span><span class="ident" id="4573656">pointFormat</span><span class="op" id="4573667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573672">z</span>&nbsp;<span class="op" id="4573674">=</span>&nbsp;<span class="ident" id="4573676">z</span><span class="op" id="4573677">[</span><span class="num" id="4573678">1</span><span class="op" id="4573679">:</span><span class="op" id="4573680">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4573684">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4573687">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4573690">if</span>&nbsp;<span class="ident" id="4573693">m</span><span class="op" id="4573694">.</span><span class="ident" id="4573695">ticketSupported</span>&nbsp;<span class="op" id="4573711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4573715">//&nbsp;http://tools.ietf.org/html/rfc5077#section-3.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573767">z</span><span class="op" id="4573768">[</span><span class="num" id="4573769">0</span><span class="op" id="4573770">]</span>&nbsp;<span class="op" id="4573772">=</span>&nbsp;<span class="builtintype" id="4573774">byte</span><span class="op" id="4573778">(</span><span class="ident" id="4573779">extensionSessionTicket</span>&nbsp;<span class="op" id="4573802">&gt;&gt;</span>&nbsp;<span class="num" id="4573805">8</span><span class="op" id="4573806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573810">z</span><span class="op" id="4573811">[</span><span class="num" id="4573812">1</span><span class="op" id="4573813">]</span>&nbsp;<span class="op" id="4573815">=</span>&nbsp;<span class="builtintype" id="4573817">byte</span><span class="op" id="4573821">(</span><span class="ident" id="4573822">extensionSessionTicket</span><span class="op" id="4573844">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573848">l</span>&nbsp;<span class="op" id="4573850">:=</span>&nbsp;<span class="builtinfunc" id="4573853">len</span><span class="op" id="4573856">(</span><span class="ident" id="4573857">m</span><span class="op" id="4573858">.</span><span class="ident" id="4573859">sessionTicket</span><span class="op" id="4573872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573876">z</span><span class="op" id="4573877">[</span><span class="num" id="4573878">2</span><span class="op" id="4573879">]</span>&nbsp;<span class="op" id="4573881">=</span>&nbsp;<span class="builtintype" id="4573883">byte</span><span class="op" id="4573887">(</span><span class="ident" id="4573888">l</span>&nbsp;<span class="op" id="4573890">&gt;&gt;</span>&nbsp;<span class="num" id="4573893">8</span><span class="op" id="4573894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573898">z</span><span class="op" id="4573899">[</span><span class="num" id="4573900">3</span><span class="op" id="4573901">]</span>&nbsp;<span class="op" id="4573903">=</span>&nbsp;<span class="builtintype" id="4573905">byte</span><span class="op" id="4573909">(</span><span class="ident" id="4573910">l</span><span class="op" id="4573911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573915">z</span>&nbsp;<span class="op" id="4573917">=</span>&nbsp;<span class="ident" id="4573919">z</span><span class="op" id="4573920">[</span><span class="num" id="4573921">4</span><span class="op" id="4573922">:</span><span class="op" id="4573923">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4573927">copy</span><span class="op" id="4573931">(</span><span class="ident" id="4573932">z</span><span class="op" id="4573933">,</span>&nbsp;<span class="ident" id="4573935">m</span><span class="op" id="4573936">.</span><span class="ident" id="4573937">sessionTicket</span><span class="op" id="4573950">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573954">z</span>&nbsp;<span class="op" id="4573956">=</span>&nbsp;<span class="ident" id="4573958">z</span><span class="op" id="4573959">[</span><span class="builtinfunc" id="4573960">len</span><span class="op" id="4573963">(</span><span class="ident" id="4573964">m</span><span class="op" id="4573965">.</span><span class="ident" id="4573966">sessionTicket</span><span class="op" id="4573979">)</span><span class="op" id="4573980">:</span><span class="op" id="4573981">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4573984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4573987">if</span>&nbsp;<span class="builtinfunc" id="4573990">len</span><span class="op" id="4573993">(</span><span class="ident" id="4573994">m</span><span class="op" id="4573995">.</span><span class="ident" id="4573996">signatureAndHashes</span><span class="op" id="4574014">)</span>&nbsp;<span class="op" id="4574016">&gt;</span>&nbsp;<span class="num" id="4574018">0</span>&nbsp;<span class="op" id="4574020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4574024">//&nbsp;https://tools.ietf.org/html/rfc5246#section-7.4.1.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574083">z</span><span class="op" id="4574084">[</span><span class="num" id="4574085">0</span><span class="op" id="4574086">]</span>&nbsp;<span class="op" id="4574088">=</span>&nbsp;<span class="builtintype" id="4574090">byte</span><span class="op" id="4574094">(</span><span class="ident" id="4574095">extensionSignatureAlgorithms</span>&nbsp;<span class="op" id="4574124">&gt;&gt;</span>&nbsp;<span class="num" id="4574127">8</span><span class="op" id="4574128">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574132">z</span><span class="op" id="4574133">[</span><span class="num" id="4574134">1</span><span class="op" id="4574135">]</span>&nbsp;<span class="op" id="4574137">=</span>&nbsp;<span class="builtintype" id="4574139">byte</span><span class="op" id="4574143">(</span><span class="ident" id="4574144">extensionSignatureAlgorithms</span><span class="op" id="4574172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574176">l</span>&nbsp;<span class="op" id="4574178">:=</span>&nbsp;<span class="num" id="4574181">2</span>&nbsp;<span class="op" id="4574183">+</span>&nbsp;<span class="num" id="4574185">2</span><span class="op" id="4574186">*</span><span class="builtinfunc" id="4574187">len</span><span class="op" id="4574190">(</span><span class="ident" id="4574191">m</span><span class="op" id="4574192">.</span><span class="ident" id="4574193">signatureAndHashes</span><span class="op" id="4574211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574215">z</span><span class="op" id="4574216">[</span><span class="num" id="4574217">2</span><span class="op" id="4574218">]</span>&nbsp;<span class="op" id="4574220">=</span>&nbsp;<span class="builtintype" id="4574222">byte</span><span class="op" id="4574226">(</span><span class="ident" id="4574227">l</span>&nbsp;<span class="op" id="4574229">&gt;&gt;</span>&nbsp;<span class="num" id="4574232">8</span><span class="op" id="4574233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574237">z</span><span class="op" id="4574238">[</span><span class="num" id="4574239">3</span><span class="op" id="4574240">]</span>&nbsp;<span class="op" id="4574242">=</span>&nbsp;<span class="builtintype" id="4574244">byte</span><span class="op" id="4574248">(</span><span class="ident" id="4574249">l</span><span class="op" id="4574250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574254">z</span>&nbsp;<span class="op" id="4574256">=</span>&nbsp;<span class="ident" id="4574258">z</span><span class="op" id="4574259">[</span><span class="num" id="4574260">4</span><span class="op" id="4574261">:</span><span class="op" id="4574262">]</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574267">l</span>&nbsp;<span class="op" id="4574269">-=</span>&nbsp;<span class="num" id="4574272">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574276">z</span><span class="op" id="4574277">[</span><span class="num" id="4574278">0</span><span class="op" id="4574279">]</span>&nbsp;<span class="op" id="4574281">=</span>&nbsp;<span class="builtintype" id="4574283">byte</span><span class="op" id="4574287">(</span><span class="ident" id="4574288">l</span>&nbsp;<span class="op" id="4574290">&gt;&gt;</span>&nbsp;<span class="num" id="4574293">8</span><span class="op" id="4574294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574298">z</span><span class="op" id="4574299">[</span><span class="num" id="4574300">1</span><span class="op" id="4574301">]</span>&nbsp;<span class="op" id="4574303">=</span>&nbsp;<span class="builtintype" id="4574305">byte</span><span class="op" id="4574309">(</span><span class="ident" id="4574310">l</span><span class="op" id="4574311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574315">z</span>&nbsp;<span class="op" id="4574317">=</span>&nbsp;<span class="ident" id="4574319">z</span><span class="op" id="4574320">[</span><span class="num" id="4574321">2</span><span class="op" id="4574322">:</span><span class="op" id="4574323">]</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4574327">for</span>&nbsp;<span class="ident" id="4574331">_</span><span class="op" id="4574332">,</span>&nbsp;<span class="ident" id="4574334">sigAndHash</span>&nbsp;<span class="op" id="4574345">:=</span>&nbsp;<span class="keyword" id="4574348">range</span>&nbsp;<span class="ident" id="4574354">m</span><span class="op" id="4574355">.</span><span class="ident" id="4574356">signatureAndHashes</span>&nbsp;<span class="op" id="4574375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574380">z</span><span class="op" id="4574381">[</span><span class="num" id="4574382">0</span><span class="op" id="4574383">]</span>&nbsp;<span class="op" id="4574385">=</span>&nbsp;<span class="ident" id="4574387">sigAndHash</span><span class="op" id="4574397">.</span><span class="ident" id="4574398">hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574406">z</span><span class="op" id="4574407">[</span><span class="num" id="4574408">1</span><span class="op" id="4574409">]</span>&nbsp;<span class="op" id="4574411">=</span>&nbsp;<span class="ident" id="4574413">sigAndHash</span><span class="op" id="4574423">.</span><span class="ident" id="4574424">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574437">z</span>&nbsp;<span class="op" id="4574439">=</span>&nbsp;<span class="ident" id="4574441">z</span><span class="op" id="4574442">[</span><span class="num" id="4574443">2</span><span class="op" id="4574444">:</span><span class="op" id="4574445">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4574449">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4574452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4574455">if</span>&nbsp;<span class="ident" id="4574458">m</span><span class="op" id="4574459">.</span><span class="ident" id="4574460">secureRenegotiation</span>&nbsp;<span class="op" id="4574480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574484">z</span><span class="op" id="4574485">[</span><span class="num" id="4574486">0</span><span class="op" id="4574487">]</span>&nbsp;<span class="op" id="4574489">=</span>&nbsp;<span class="builtintype" id="4574491">byte</span><span class="op" id="4574495">(</span><span class="ident" id="4574496">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="4574523">&gt;&gt;</span>&nbsp;<span class="num" id="4574526">8</span><span class="op" id="4574527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574531">z</span><span class="op" id="4574532">[</span><span class="num" id="4574533">1</span><span class="op" id="4574534">]</span>&nbsp;<span class="op" id="4574536">=</span>&nbsp;<span class="builtintype" id="4574538">byte</span><span class="op" id="4574542">(</span><span class="ident" id="4574543">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="4574570">&amp;</span>&nbsp;<span class="num" id="4574572">0xff</span><span class="op" id="4574576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574580">z</span><span class="op" id="4574581">[</span><span class="num" id="4574582">2</span><span class="op" id="4574583">]</span>&nbsp;<span class="op" id="4574585">=</span>&nbsp;<span class="num" id="4574587">0</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574591">z</span><span class="op" id="4574592">[</span><span class="num" id="4574593">3</span><span class="op" id="4574594">]</span>&nbsp;<span class="op" id="4574596">=</span>&nbsp;<span class="num" id="4574598">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574602">z</span>&nbsp;<span class="op" id="4574604">=</span>&nbsp;<span class="ident" id="4574606">z</span><span class="op" id="4574607">[</span><span class="num" id="4574608">5</span><span class="op" id="4574609">:</span><span class="op" id="4574610">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4574613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4574616">if</span>&nbsp;<span class="builtinfunc" id="4574619">len</span><span class="op" id="4574622">(</span><span class="ident" id="4574623">m</span><span class="op" id="4574624">.</span><span class="ident" id="4574625">alpnProtocols</span><span class="op" id="4574638">)</span>&nbsp;<span class="op" id="4574640">&gt;</span>&nbsp;<span class="num" id="4574642">0</span>&nbsp;<span class="op" id="4574644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574648">z</span><span class="op" id="4574649">[</span><span class="num" id="4574650">0</span><span class="op" id="4574651">]</span>&nbsp;<span class="op" id="4574653">=</span>&nbsp;<span class="builtintype" id="4574655">byte</span><span class="op" id="4574659">(</span><span class="ident" id="4574660">extensionALPN</span>&nbsp;<span class="op" id="4574674">&gt;&gt;</span>&nbsp;<span class="num" id="4574677">8</span><span class="op" id="4574678">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574682">z</span><span class="op" id="4574683">[</span><span class="num" id="4574684">1</span><span class="op" id="4574685">]</span>&nbsp;<span class="op" id="4574687">=</span>&nbsp;<span class="builtintype" id="4574689">byte</span><span class="op" id="4574693">(</span><span class="ident" id="4574694">extensionALPN</span>&nbsp;<span class="op" id="4574708">&amp;</span>&nbsp;<span class="num" id="4574710">0xff</span><span class="op" id="4574714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574718">lengths</span>&nbsp;<span class="op" id="4574726">:=</span>&nbsp;<span class="ident" id="4574729">z</span><span class="op" id="4574730">[</span><span class="num" id="4574731">2</span><span class="op" id="4574732">:</span><span class="op" id="4574733">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574737">z</span>&nbsp;<span class="op" id="4574739">=</span>&nbsp;<span class="ident" id="4574741">z</span><span class="op" id="4574742">[</span><span class="num" id="4574743">6</span><span class="op" id="4574744">:</span><span class="op" id="4574745">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574750">stringsLength</span>&nbsp;<span class="op" id="4574764">:=</span>&nbsp;<span class="num" id="4574767">0</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4574771">for</span>&nbsp;<span class="ident" id="4574775">_</span><span class="op" id="4574776">,</span>&nbsp;<span class="ident" id="4574778">s</span>&nbsp;<span class="op" id="4574780">:=</span>&nbsp;<span class="keyword" id="4574783">range</span>&nbsp;<span class="ident" id="4574789">m</span><span class="op" id="4574790">.</span><span class="ident" id="4574791">alpnProtocols</span>&nbsp;<span class="op" id="4574805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574810">l</span>&nbsp;<span class="op" id="4574812">:=</span>&nbsp;<span class="builtinfunc" id="4574815">len</span><span class="op" id="4574818">(</span><span class="ident" id="4574819">s</span><span class="op" id="4574820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574825">z</span><span class="op" id="4574826">[</span><span class="num" id="4574827">0</span><span class="op" id="4574828">]</span>&nbsp;<span class="op" id="4574830">=</span>&nbsp;<span class="builtintype" id="4574832">byte</span><span class="op" id="4574836">(</span><span class="ident" id="4574837">l</span><span class="op" id="4574838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4574843">copy</span><span class="op" id="4574847">(</span><span class="ident" id="4574848">z</span><span class="op" id="4574849">[</span><span class="num" id="4574850">1</span><span class="op" id="4574851">:</span><span class="op" id="4574852">]</span><span class="op" id="4574853">,</span>&nbsp;<span class="ident" id="4574855">s</span><span class="op" id="4574856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574861">z</span>&nbsp;<span class="op" id="4574863">=</span>&nbsp;<span class="ident" id="4574865">z</span><span class="op" id="4574866">[</span><span class="num" id="4574867">1</span><span class="op" id="4574868">+</span><span class="ident" id="4574869">l</span><span class="op" id="4574870">:</span><span class="op" id="4574871">]</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574876">stringsLength</span>&nbsp;<span class="op" id="4574890">+=</span>&nbsp;<span class="num" id="4574893">1</span>&nbsp;<span class="op" id="4574895">+</span>&nbsp;<span class="ident" id="4574897">l</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4574901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574906">lengths</span><span class="op" id="4574913">[</span><span class="num" id="4574914">2</span><span class="op" id="4574915">]</span>&nbsp;<span class="op" id="4574917">=</span>&nbsp;<span class="builtintype" id="4574919">byte</span><span class="op" id="4574923">(</span><span class="ident" id="4574924">stringsLength</span>&nbsp;<span class="op" id="4574938">&gt;&gt;</span>&nbsp;<span class="num" id="4574941">8</span><span class="op" id="4574942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574946">lengths</span><span class="op" id="4574953">[</span><span class="num" id="4574954">3</span><span class="op" id="4574955">]</span>&nbsp;<span class="op" id="4574957">=</span>&nbsp;<span class="builtintype" id="4574959">byte</span><span class="op" id="4574963">(</span><span class="ident" id="4574964">stringsLength</span><span class="op" id="4574977">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574981">stringsLength</span>&nbsp;<span class="op" id="4574995">+=</span>&nbsp;<span class="num" id="4574998">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4575002">lengths</span><span class="op" id="4575009">[</span><span class="num" id="4575010">0</span><span class="op" id="4575011">]</span>&nbsp;<span class="op" id="4575013">=</span>&nbsp;<span class="builtintype" id="4575015">byte</span><span class="op" id="4575019">(</span><span class="ident" id="4575020">stringsLength</span>&nbsp;<span class="op" id="4575034">&gt;&gt;</span>&nbsp;<span class="num" id="4575037">8</span><span class="op" id="4575038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4575042">lengths</span><span class="op" id="4575049">[</span><span class="num" id="4575050">1</span><span class="op" id="4575051">]</span>&nbsp;<span class="op" id="4575053">=</span>&nbsp;<span class="builtintype" id="4575055">byte</span><span class="op" id="4575059">(</span><span class="ident" id="4575060">stringsLength</span><span class="op" id="4575073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4575076">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4575080">m</span><span class="op" id="4575081">.</span><span class="ident" id="4575082">raw</span>&nbsp;<span class="op" id="4575086">=</span>&nbsp;<span class="ident" id="4575088">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4575092">return</span>&nbsp;<span class="ident" id="4575099">x</span><br>
<span class="lineno"></span><span class="op" id="4575101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="4575104">func</span>&nbsp;<span class="op" id="4575109">(</span><span class="ident" id="4575110">m</span>&nbsp;<span class="op" id="4575112">*</span><span class="ident" id="4575113">clientHelloMsg</span><span class="op" id="4575127">)</span>&nbsp;<span class="ident" id="4575129">unmarshal</span><span class="op" id="4575138">(</span><span class="ident" id="4575139">data</span>&nbsp;<span class="op" id="4575144">[</span><span class="op" id="4575145">]</span><span class="builtintype" id="4575146">byte</span><span class="op" id="4575150">)</span>&nbsp;<span class="builtintype" id="4575152">bool</span>&nbsp;<span class="op" id="4575157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4575160">if</span>&nbsp;<span class="builtinfunc" id="4575163">len</span><span class="op" id="4575166">(</span><span class="ident" id="4575167">data</span><span class="op" id="4575171">)</span>&nbsp;<span class="op" id="4575173">&lt;</span>&nbsp;<span class="num" id="4575175">42</span>&nbsp;<span class="op" id="4575178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4575182">return</span>&nbsp;<span class="builtintype" id="4575189">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4575196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4575199">m</span><span class="op" id="4575200">.</span><span class="ident" id="4575201">raw</span>&nbsp;<span class="op" id="4575205">=</span>&nbsp;<span class="ident" id="4575207">data</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4575213">m</span><span class="op" id="4575214">.</span><span class="ident" id="4575215">vers</span>&nbsp;<span class="op" id="4575220">=</span>&nbsp;<span class="builtintype" id="4575222">uint16</span><span class="op" id="4575228">(</span><span class="ident" id="4575229">data</span><span class="op" id="4575233">[</span><span class="num" id="4575234">4</span><span class="op" id="4575235">]</span><span class="op" id="4575236">)</span><span class="op" id="4575237">&lt;&lt;</span><span class="num" id="4575239">8</span>&nbsp;<span class="op" id="4575241">|</span>&nbsp;<span class="builtintype" id="4575243">uint16</span><span class="op" id="4575249">(</span><span class="ident" id="4575250">data</span><span class="op" id="4575254">[</span><span class="num" id="4575255">5</span><span class="op" id="4575256">]</span><span class="op" id="4575257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4575260">m</span><span class="op" id="4575261">.</span><span class="ident" id="4575262">random</span>&nbsp;<span class="op" id="4575269">=</span>&nbsp;<span class="ident" id="4575271">data</span><span class="op" id="4575275">[</span><span class="num" id="4575276">6</span><span class="op" id="4575277">:</span><span class="num" id="4575278">38</span><span class="op" id="4575280">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4575283">sessionIdLen</span>&nbsp;<span class="op" id="4575296">:=</span>&nbsp;<span class="builtintype" id="4575299">int</span><span class="op" id="4575302">(</span><span class="ident" id="4575303">data</span><span class="op" id="4575307">[</span><span class="num" id="4575308">38</span><span class="op" id="4575310">]</span><span class="op" id="4575311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4575314">if</span>&nbsp;<span class="ident" id="4575317">sessionIdLen</span>&nbsp;<span class="op" id="4575330">&gt;</span>&nbsp;<span class="num" id="4575332">32</span>&nbsp;<span class="op" id="4575335">||</span>&nbsp;<span class="builtinfunc" id="4575338">len</span><span class="op" id="4575341">(</span><span class="ident" id="4575342">data</span><span class="op" id="4575346">)</span>&nbsp;<span class="op" id="4575348">&lt;</span>&nbsp;<span class="num" id="4575350">39</span><span class="op" id="4575352">+</span><span class="ident" id="4575353">sessionIdLen</span>&nbsp;<span class="op" id="4575366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4575370">return</span>&nbsp;<span class="builtintype" id="4575377">false</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4575384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4575387">m</span><span class="op" id="4575388">.</span><span class="ident" id="4575389">sessionId</span>&nbsp;<span class="op" id="4575399">=</span>&nbsp;<span class="ident" id="4575401">data</span><span class="op" id="4575405">[</span><span class="num" id="4575406">39</span>&nbsp;<span class="op" id="4575409">:</span>&nbsp;<span class="num" id="4575411">39</span><span class="op" id="4575413">+</span><span class="ident" id="4575414">sessionIdLen</span><span class="op" id="4575426">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4575429">data</span>&nbsp;<span class="op" id="4575434">=</span>&nbsp;<span class="ident" id="4575436">data</span><span class="op" id="4575440">[</span><span class="num" id="4575441">39</span><span class="op" id="4575443">+</span><span class="ident" id="4575444">sessionIdLen</span><span class="op" id="4575456">:</span><span class="op" id="4575457">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4575460">if</span>&nbsp;<span class="builtinfunc" id="4575463">len</span><span class="op" id="4575466">(</span><span class="ident" id="4575467">data</span><span class="op" id="4575471">)</span>&nbsp;<span class="op" id="4575473">&lt;</span>&nbsp;<span class="num" id="4575475">2</span>&nbsp;<span class="op" id="4575477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4575481">return</span>&nbsp;<span class="builtintype" id="4575488">false</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4575495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4575498">//&nbsp;cipherSuiteLen&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;of&nbsp;cipher&nbsp;suite&nbsp;numbers.&nbsp;Since</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4575571">//&nbsp;they&nbsp;are&nbsp;uint16s,&nbsp;the&nbsp;number&nbsp;must&nbsp;be&nbsp;even.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4575618">cipherSuiteLen</span>&nbsp;<span class="op" id="4575633">:=</span>&nbsp;<span class="builtintype" id="4575636">int</span><span class="op" id="4575639">(</span><span class="ident" id="4575640">data</span><span class="op" id="4575644">[</span><span class="num" id="4575645">0</span><span class="op" id="4575646">]</span><span class="op" id="4575647">)</span><span class="op" id="4575648">&lt;&lt;</span><span class="num" id="4575650">8</span>&nbsp;<span class="op" id="4575652">|</span>&nbsp;<span class="builtintype" id="4575654">int</span><span class="op" id="4575657">(</span><span class="ident" id="4575658">data</span><span class="op" id="4575662">[</span><span class="num" id="4575663">1</span><span class="op" id="4575664">]</span><span class="op" id="4575665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4575668">if</span>&nbsp;<span class="ident" id="4575671">cipherSuiteLen</span><span class="op" id="4575685">%</span><span class="num" id="4575686">2</span>&nbsp;<span class="op" id="4575688">==</span>&nbsp;<span class="num" id="4575691">1</span>&nbsp;<span class="op" id="4575693">||</span>&nbsp;<span class="builtinfunc" id="4575696">len</span><span class="op" id="4575699">(</span><span class="ident" id="4575700">data</span><span class="op" id="4575704">)</span>&nbsp;<span class="op" id="4575706">&lt;</span>&nbsp;<span class="num" id="4575708">2</span><span class="op" id="4575709">+</span><span class="ident" id="4575710">cipherSuiteLen</span>&nbsp;<span class="op" id="4575725">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4575729">return</span>&nbsp;<span class="builtintype" id="4575736">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4575743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4575746">numCipherSuites</span>&nbsp;<span class="op" id="4575762">:=</span>&nbsp;<span class="ident" id="4575765">cipherSuiteLen</span>&nbsp;<span class="op" id="4575780">/</span>&nbsp;<span class="num" id="4575782">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4575785">m</span><span class="op" id="4575786">.</span><span class="ident" id="4575787">cipherSuites</span>&nbsp;<span class="op" id="4575800">=</span>&nbsp;<span class="builtinfunc" id="4575802">make</span><span class="op" id="4575806">(</span><span class="op" id="4575807">[</span><span class="op" id="4575808">]</span><span class="builtintype" id="4575809">uint16</span><span class="op" id="4575815">,</span>&nbsp;<span class="ident" id="4575817">numCipherSuites</span><span class="op" id="4575832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4575835">for</span>&nbsp;<span class="ident" id="4575839">i</span>&nbsp;<span class="op" id="4575841">:=</span>&nbsp;<span class="num" id="4575844">0</span><span class="op" id="4575845">;</span>&nbsp;<span class="ident" id="4575847">i</span>&nbsp;<span class="op" id="4575849">&lt;</span>&nbsp;<span class="ident" id="4575851">numCipherSuites</span><span class="op" id="4575866">;</span>&nbsp;<span class="ident" id="4575868">i</span><span class="op" id="4575869">++</span>&nbsp;<span class="op" id="4575872">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4575876">m</span><span class="op" id="4575877">.</span><span class="ident" id="4575878">cipherSuites</span><span class="op" id="4575890">[</span><span class="ident" id="4575891">i</span><span class="op" id="4575892">]</span>&nbsp;<span class="op" id="4575894">=</span>&nbsp;<span class="builtintype" id="4575896">uint16</span><span class="op" id="4575902">(</span><span class="ident" id="4575903">data</span><span class="op" id="4575907">[</span><span class="num" id="4575908">2</span><span class="op" id="4575909">+</span><span class="num" id="4575910">2</span><span class="op" id="4575911">*</span><span class="ident" id="4575912">i</span><span class="op" id="4575913">]</span><span class="op" id="4575914">)</span><span class="op" id="4575915">&lt;&lt;</span><span class="num" id="4575917">8</span>&nbsp;<span class="op" id="4575919">|</span>&nbsp;<span class="builtintype" id="4575921">uint16</span><span class="op" id="4575927">(</span><span class="ident" id="4575928">data</span><span class="op" id="4575932">[</span><span class="num" id="4575933">3</span><span class="op" id="4575934">+</span><span class="num" id="4575935">2</span><span class="op" id="4575936">*</span><span class="ident" id="4575937">i</span><span class="op" id="4575938">]</span><span class="op" id="4575939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4575943">if</span>&nbsp;<span class="ident" id="4575946">m</span><span class="op" id="4575947">.</span><span class="ident" id="4575948">cipherSuites</span><span class="op" id="4575960">[</span><span class="ident" id="4575961">i</span><span class="op" id="4575962">]</span>&nbsp;<span class="op" id="4575964">==</span>&nbsp;<span class="ident" id="4575967">scsvRenegotiation</span>&nbsp;<span class="op" id="4575985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4575990">m</span><span class="op" id="4575991">.</span><span class="ident" id="4575992">secureRenegotiation</span>&nbsp;<span class="op" id="4576012">=</span>&nbsp;<span class="builtintype" id="4576014">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4576021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4576024">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4576027">data</span>&nbsp;<span class="op" id="4576032">=</span>&nbsp;<span class="ident" id="4576034">data</span><span class="op" id="4576038">[</span><span class="num" id="4576039">2</span><span class="op" id="4576040">+</span><span class="ident" id="4576041">cipherSuiteLen</span><span class="op" id="4576055">:</span><span class="op" id="4576056">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4576059">if</span>&nbsp;<span class="builtinfunc" id="4576062">len</span><span class="op" id="4576065">(</span><span class="ident" id="4576066">data</span><span class="op" id="4576070">)</span>&nbsp;<span class="op" id="4576072">&lt;</span>&nbsp;<span class="num" id="4576074">1</span>&nbsp;<span class="op" id="4576076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4576080">return</span>&nbsp;<span class="builtintype" id="4576087">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4576094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4576097">compressionMethodsLen</span>&nbsp;<span class="op" id="4576119">:=</span>&nbsp;<span class="builtintype" id="4576122">int</span><span class="op" id="4576125">(</span><span class="ident" id="4576126">data</span><span class="op" id="4576130">[</span><span class="num" id="4576131">0</span><span class="op" id="4576132">]</span><span class="op" id="4576133">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4576136">if</span>&nbsp;<span class="builtinfunc" id="4576139">len</span><span class="op" id="4576142">(</span><span class="ident" id="4576143">data</span><span class="op" id="4576147">)</span>&nbsp;<span class="op" id="4576149">&lt;</span>&nbsp;<span class="num" id="4576151">1</span><span class="op" id="4576152">+</span><span class="ident" id="4576153">compressionMethodsLen</span>&nbsp;<span class="op" id="4576175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4576179">return</span>&nbsp;<span class="builtintype" id="4576186">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4576193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4576196">m</span><span class="op" id="4576197">.</span><span class="ident" id="4576198">compressionMethods</span>&nbsp;<span class="op" id="4576217">=</span>&nbsp;<span class="ident" id="4576219">data</span><span class="op" id="4576223">[</span><span class="num" id="4576224">1</span>&nbsp;<span class="op" id="4576226">:</span>&nbsp;<span class="num" id="4576228">1</span><span class="op" id="4576229">+</span><span class="ident" id="4576230">compressionMethodsLen</span><span class="op" id="4576251">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4576255">data</span>&nbsp;<span class="op" id="4576260">=</span>&nbsp;<span class="ident" id="4576262">data</span><span class="op" id="4576266">[</span><span class="num" id="4576267">1</span><span class="op" id="4576268">+</span><span class="ident" id="4576269">compressionMethodsLen</span><span class="op" id="4576290">:</span><span class="op" id="4576291">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4576295">m</span><span class="op" id="4576296">.</span><span class="ident" id="4576297">nextProtoNeg</span>&nbsp;<span class="op" id="4576310">=</span>&nbsp;<span class="builtintype" id="4576312">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4576319">m</span><span class="op" id="4576320">.</span><span class="ident" id="4576321">serverName</span>&nbsp;<span class="op" id="4576332">=</span>&nbsp;<span class="string" id="4576334">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4576338">m</span><span class="op" id="4576339">.</span><span class="ident" id="4576340">ocspStapling</span>&nbsp;<span class="op" id="4576353">=</span>&nbsp;<span class="builtintype" id="4576355">false</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4576362">m</span><span class="op" id="4576363">.</span><span class="ident" id="4576364">ticketSupported</span>&nbsp;<span class="op" id="4576380">=</span>&nbsp;<span class="builtintype" id="4576382">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4576389">m</span><span class="op" id="4576390">.</span><span class="ident" id="4576391">sessionTicket</span>&nbsp;<span class="op" id="4576405">=</span>&nbsp;<span class="ident" id="4576407">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4576412">m</span><span class="op" id="4576413">.</span><span class="ident" id="4576414">signatureAndHashes</span>&nbsp;<span class="op" id="4576433">=</span>&nbsp;<span class="ident" id="4576435">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4576440">m</span><span class="op" id="4576441">.</span><span class="ident" id="4576442">alpnProtocols</span>&nbsp;<span class="op" id="4576456">=</span>&nbsp;<span class="ident" id="4576458">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4576464">if</span>&nbsp;<span class="builtinfunc" id="4576467">len</span><span class="op" id="4576470">(</span><span class="ident" id="4576471">data</span><span class="op" id="4576475">)</span>&nbsp;<span class="op" id="4576477">==</span>&nbsp;<span class="num" id="4576480">0</span>&nbsp;<span class="op" id="4576482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4576486">//&nbsp;ClientHello&nbsp;is&nbsp;optionally&nbsp;followed&nbsp;by&nbsp;extension&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4576544">return</span>&nbsp;<span class="builtintype" id="4576551">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4576557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4576560">if</span>&nbsp;<span class="builtinfunc" id="4576563">len</span><span class="op" id="4576566">(</span><span class="ident" id="4576567">data</span><span class="op" id="4576571">)</span>&nbsp;<span class="op" id="4576573">&lt;</span>&nbsp;<span class="num" id="4576575">2</span>&nbsp;<span class="op" id="4576577">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4576581">return</span>&nbsp;<span class="builtintype" id="4576588">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4576595">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4576599">extensionsLength</span>&nbsp;<span class="op" id="4576616">:=</span>&nbsp;<span class="builtintype" id="4576619">int</span><span class="op" id="4576622">(</span><span class="ident" id="4576623">data</span><span class="op" id="4576627">[</span><span class="num" id="4576628">0</span><span class="op" id="4576629">]</span><span class="op" id="4576630">)</span><span class="op" id="4576631">&lt;&lt;</span><span class="num" id="4576633">8</span>&nbsp;<span class="op" id="4576635">|</span>&nbsp;<span class="builtintype" id="4576637">int</span><span class="op" id="4576640">(</span><span class="ident" id="4576641">data</span><span class="op" id="4576645">[</span><span class="num" id="4576646">1</span><span class="op" id="4576647">]</span><span class="op" id="4576648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4576651">data</span>&nbsp;<span class="op" id="4576656">=</span>&nbsp;<span class="ident" id="4576658">data</span><span class="op" id="4576662">[</span><span class="num" id="4576663">2</span><span class="op" id="4576664">:</span><span class="op" id="4576665">]</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4576668">if</span>&nbsp;<span class="ident" id="4576671">extensionsLength</span>&nbsp;<span class="op" id="4576688">!=</span>&nbsp;<span class="builtinfunc" id="4576691">len</span><span class="op" id="4576694">(</span><span class="ident" id="4576695">data</span><span class="op" id="4576699">)</span>&nbsp;<span class="op" id="4576701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4576705">return</span>&nbsp;<span class="builtintype" id="4576712">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4576719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4576723">for</span>&nbsp;<span class="builtinfunc" id="4576727">len</span><span class="op" id="4576730">(</span><span class="ident" id="4576731">data</span><span class="op" id="4576735">)</span>&nbsp;<span class="op" id="4576737">!=</span>&nbsp;<span class="num" id="4576740">0</span>&nbsp;<span class="op" id="4576742">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4576746">if</span>&nbsp;<span class="builtinfunc" id="4576749">len</span><span class="op" id="4576752">(</span><span class="ident" id="4576753">data</span><span class="op" id="4576757">)</span>&nbsp;<span class="op" id="4576759">&lt;</span>&nbsp;<span class="num" id="4576761">4</span>&nbsp;<span class="op" id="4576763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4576768">return</span>&nbsp;<span class="builtintype" id="4576775">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4576783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4576787">extension</span>&nbsp;<span class="op" id="4576797">:=</span>&nbsp;<span class="builtintype" id="4576800">uint16</span><span class="op" id="4576806">(</span><span class="ident" id="4576807">data</span><span class="op" id="4576811">[</span><span class="num" id="4576812">0</span><span class="op" id="4576813">]</span><span class="op" id="4576814">)</span><span class="op" id="4576815">&lt;&lt;</span><span class="num" id="4576817">8</span>&nbsp;<span class="op" id="4576819">|</span>&nbsp;<span class="builtintype" id="4576821">uint16</span><span class="op" id="4576827">(</span><span class="ident" id="4576828">data</span><span class="op" id="4576832">[</span><span class="num" id="4576833">1</span><span class="op" id="4576834">]</span><span class="op" id="4576835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4576839">length</span>&nbsp;<span class="op" id="4576846">:=</span>&nbsp;<span class="builtintype" id="4576849">int</span><span class="op" id="4576852">(</span><span class="ident" id="4576853">data</span><span class="op" id="4576857">[</span><span class="num" id="4576858">2</span><span class="op" id="4576859">]</span><span class="op" id="4576860">)</span><span class="op" id="4576861">&lt;&lt;</span><span class="num" id="4576863">8</span>&nbsp;<span class="op" id="4576865">|</span>&nbsp;<span class="builtintype" id="4576867">int</span><span class="op" id="4576870">(</span><span class="ident" id="4576871">data</span><span class="op" id="4576875">[</span><span class="num" id="4576876">3</span><span class="op" id="4576877">]</span><span class="op" id="4576878">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4576882">data</span>&nbsp;<span class="op" id="4576887">=</span>&nbsp;<span class="ident" id="4576889">data</span><span class="op" id="4576893">[</span><span class="num" id="4576894">4</span><span class="op" id="4576895">:</span><span class="op" id="4576896">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4576900">if</span>&nbsp;<span class="builtinfunc" id="4576903">len</span><span class="op" id="4576906">(</span><span class="ident" id="4576907">data</span><span class="op" id="4576911">)</span>&nbsp;<span class="op" id="4576913">&lt;</span>&nbsp;<span class="ident" id="4576915">length</span>&nbsp;<span class="op" id="4576922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4576927">return</span>&nbsp;<span class="builtintype" id="4576934">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4576942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4576947">switch</span>&nbsp;<span class="ident" id="4576954">extension</span>&nbsp;<span class="op" id="4576964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4576968">case</span>&nbsp;<span class="ident" id="4576973">extensionServerName</span><span class="op" id="4576992">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4576997">if</span>&nbsp;<span class="ident" id="4577000">length</span>&nbsp;<span class="op" id="4577007">&lt;</span>&nbsp;<span class="num" id="4577009">2</span>&nbsp;<span class="op" id="4577011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4577017">return</span>&nbsp;<span class="builtintype" id="4577024">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4577033">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4577038">numNames</span>&nbsp;<span class="op" id="4577047">:=</span>&nbsp;<span class="builtintype" id="4577050">int</span><span class="op" id="4577053">(</span><span class="ident" id="4577054">data</span><span class="op" id="4577058">[</span><span class="num" id="4577059">0</span><span class="op" id="4577060">]</span><span class="op" id="4577061">)</span><span class="op" id="4577062">&lt;&lt;</span><span class="num" id="4577064">8</span>&nbsp;<span class="op" id="4577066">|</span>&nbsp;<span class="builtintype" id="4577068">int</span><span class="op" id="4577071">(</span><span class="ident" id="4577072">data</span><span class="op" id="4577076">[</span><span class="num" id="4577077">1</span><span class="op" id="4577078">]</span><span class="op" id="4577079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4577084">d</span>&nbsp;<span class="op" id="4577086">:=</span>&nbsp;<span class="ident" id="4577089">data</span><span class="op" id="4577093">[</span><span class="num" id="4577094">2</span><span class="op" id="4577095">:</span><span class="op" id="4577096">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4577101">for</span>&nbsp;<span class="ident" id="4577105">i</span>&nbsp;<span class="op" id="4577107">:=</span>&nbsp;<span class="num" id="4577110">0</span><span class="op" id="4577111">;</span>&nbsp;<span class="ident" id="4577113">i</span>&nbsp;<span class="op" id="4577115">&lt;</span>&nbsp;<span class="ident" id="4577117">numNames</span><span class="op" id="4577125">;</span>&nbsp;<span class="ident" id="4577127">i</span><span class="op" id="4577128">++</span>&nbsp;<span class="op" id="4577131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4577137">if</span>&nbsp;<span class="builtinfunc" id="4577140">len</span><span class="op" id="4577143">(</span><span class="ident" id="4577144">d</span><span class="op" id="4577145">)</span>&nbsp;<span class="op" id="4577147">&lt;</span>&nbsp;<span class="num" id="4577149">3</span>&nbsp;<span class="op" id="4577151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4577158">return</span>&nbsp;<span class="builtintype" id="4577165">false</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4577175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4577181">nameType</span>&nbsp;<span class="op" id="4577190">:=</span>&nbsp;<span class="ident" id="4577193">d</span><span class="op" id="4577194">[</span><span class="num" id="4577195">0</span><span class="op" id="4577196">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4577202">nameLen</span>&nbsp;<span class="op" id="4577210">:=</span>&nbsp;<span class="builtintype" id="4577213">int</span><span class="op" id="4577216">(</span><span class="ident" id="4577217">d</span><span class="op" id="4577218">[</span><span class="num" id="4577219">1</span><span class="op" id="4577220">]</span><span class="op" id="4577221">)</span><span class="op" id="4577222">&lt;&lt;</span><span class="num" id="4577224">8</span>&nbsp;<span class="op" id="4577226">|</span>&nbsp;<span class="builtintype" id="4577228">int</span><span class="op" id="4577231">(</span><span class="ident" id="4577232">d</span><span class="op" id="4577233">[</span><span class="num" id="4577234">2</span><span class="op" id="4577235">]</span><span class="op" id="4577236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4577242">d</span>&nbsp;<span class="op" id="4577244">=</span>&nbsp;<span class="ident" id="4577246">d</span><span class="op" id="4577247">[</span><span class="num" id="4577248">3</span><span class="op" id="4577249">:</span><span class="op" id="4577250">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4577256">if</span>&nbsp;<span class="builtinfunc" id="4577259">len</span><span class="op" id="4577262">(</span><span class="ident" id="4577263">d</span><span class="op" id="4577264">)</span>&nbsp;<span class="op" id="4577266">&lt;</span>&nbsp;<span class="ident" id="4577268">nameLen</span>&nbsp;<span class="op" id="4577276">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4577283">return</span>&nbsp;<span class="builtintype" id="4577290">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4577300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4577306">if</span>&nbsp;<span class="ident" id="4577309">nameType</span>&nbsp;<span class="op" id="4577318">==</span>&nbsp;<span class="num" id="4577321">0</span>&nbsp;<span class="op" id="4577323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4577330">m</span><span class="op" id="4577331">.</span><span class="ident" id="4577332">serverName</span>&nbsp;<span class="op" id="4577343">=</span>&nbsp;<span class="builtintype" id="4577345">string</span><span class="op" id="4577351">(</span><span class="ident" id="4577352">d</span><span class="op" id="4577353">[</span><span class="num" id="4577354">0</span><span class="op" id="4577355">:</span><span class="ident" id="4577356">nameLen</span><span class="op" id="4577363">]</span><span class="op" id="4577364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4577371">break</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4577381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4577387">d</span>&nbsp;<span class="op" id="4577389">=</span>&nbsp;<span class="ident" id="4577391">d</span><span class="op" id="4577392">[</span><span class="ident" id="4577393">nameLen</span><span class="op" id="4577400">:</span><span class="op" id="4577401">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4577406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4577410">case</span>&nbsp;<span class="ident" id="4577415">extensionNextProtoNeg</span><span class="op" id="4577436">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4577441">if</span>&nbsp;<span class="ident" id="4577444">length</span>&nbsp;<span class="op" id="4577451">&gt;</span>&nbsp;<span class="num" id="4577453">0</span>&nbsp;<span class="op" id="4577455">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4577461">return</span>&nbsp;<span class="builtintype" id="4577468">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4577477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4577482">m</span><span class="op" id="4577483">.</span><span class="ident" id="4577484">nextProtoNeg</span>&nbsp;<span class="op" id="4577497">=</span>&nbsp;<span class="builtintype" id="4577499">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4577506">case</span>&nbsp;<span class="ident" id="4577511">extensionStatusRequest</span><span class="op" id="4577533">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4577538">m</span><span class="op" id="4577539">.</span><span class="ident" id="4577540">ocspStapling</span>&nbsp;<span class="op" id="4577553">=</span>&nbsp;<span class="ident" id="4577555">length</span>&nbsp;<span class="op" id="4577562">&gt;</span>&nbsp;<span class="num" id="4577564">0</span>&nbsp;<span class="op" id="4577566">&amp;&amp;</span>&nbsp;<span class="ident" id="4577569">data</span><span class="op" id="4577573">[</span><span class="num" id="4577574">0</span><span class="op" id="4577575">]</span>&nbsp;<span class="op" id="4577577">==</span>&nbsp;<span class="ident" id="4577580">statusTypeOCSP</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4577597">case</span>&nbsp;<span class="ident" id="4577602">extensionSupportedCurves</span><span class="op" id="4577626">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4577631">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4577686">if</span>&nbsp;<span class="ident" id="4577689">length</span>&nbsp;<span class="op" id="4577696">&lt;</span>&nbsp;<span class="num" id="4577698">2</span>&nbsp;<span class="op" id="4577700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4577706">return</span>&nbsp;<span class="builtintype" id="4577713">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4577722">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4577727">l</span>&nbsp;<span class="op" id="4577729">:=</span>&nbsp;<span class="builtintype" id="4577732">int</span><span class="op" id="4577735">(</span><span class="ident" id="4577736">data</span><span class="op" id="4577740">[</span><span class="num" id="4577741">0</span><span class="op" id="4577742">]</span><span class="op" id="4577743">)</span><span class="op" id="4577744">&lt;&lt;</span><span class="num" id="4577746">8</span>&nbsp;<span class="op" id="4577748">|</span>&nbsp;<span class="builtintype" id="4577750">int</span><span class="op" id="4577753">(</span><span class="ident" id="4577754">data</span><span class="op" id="4577758">[</span><span class="num" id="4577759">1</span><span class="op" id="4577760">]</span><span class="op" id="4577761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4577766">if</span>&nbsp;<span class="ident" id="4577769">l</span><span class="op" id="4577770">%</span><span class="num" id="4577771">2</span>&nbsp;<span class="op" id="4577773">==</span>&nbsp;<span class="num" id="4577776">1</span>&nbsp;<span class="op" id="4577778">||</span>&nbsp;<span class="ident" id="4577781">length</span>&nbsp;<span class="op" id="4577788">!=</span>&nbsp;<span class="ident" id="4577791">l</span><span class="op" id="4577792">+</span><span class="num" id="4577793">2</span>&nbsp;<span class="op" id="4577795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4577801">return</span>&nbsp;<span class="builtintype" id="4577808">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4577817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4577822">numCurves</span>&nbsp;<span class="op" id="4577832">:=</span>&nbsp;<span class="ident" id="4577835">l</span>&nbsp;<span class="op" id="4577837">/</span>&nbsp;<span class="num" id="4577839">2</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4577844">m</span><span class="op" id="4577845">.</span><span class="ident" id="4577846">supportedCurves</span>&nbsp;<span class="op" id="4577862">=</span>&nbsp;<span class="builtinfunc" id="4577864">make</span><span class="op" id="4577868">(</span><span class="op" id="4577869">[</span><span class="op" id="4577870">]</span><span class="ident" id="4577871">CurveID</span><span class="op" id="4577878">,</span>&nbsp;<span class="ident" id="4577880">numCurves</span><span class="op" id="4577889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4577894">d</span>&nbsp;<span class="op" id="4577896">:=</span>&nbsp;<span class="ident" id="4577899">data</span><span class="op" id="4577903">[</span><span class="num" id="4577904">2</span><span class="op" id="4577905">:</span><span class="op" id="4577906">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4577911">for</span>&nbsp;<span class="ident" id="4577915">i</span>&nbsp;<span class="op" id="4577917">:=</span>&nbsp;<span class="num" id="4577920">0</span><span class="op" id="4577921">;</span>&nbsp;<span class="ident" id="4577923">i</span>&nbsp;<span class="op" id="4577925">&lt;</span>&nbsp;<span class="ident" id="4577927">numCurves</span><span class="op" id="4577936">;</span>&nbsp;<span class="ident" id="4577938">i</span><span class="op" id="4577939">++</span>&nbsp;<span class="op" id="4577942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4577948">m</span><span class="op" id="4577949">.</span><span class="ident" id="4577950">supportedCurves</span><span class="op" id="4577965">[</span><span class="ident" id="4577966">i</span><span class="op" id="4577967">]</span>&nbsp;<span class="op" id="4577969">=</span>&nbsp;<span class="ident" id="4577971">CurveID</span><span class="op" id="4577978">(</span><span class="ident" id="4577979">d</span><span class="op" id="4577980">[</span><span class="num" id="4577981">0</span><span class="op" id="4577982">]</span><span class="op" id="4577983">)</span><span class="op" id="4577984">&lt;&lt;</span><span class="num" id="4577986">8</span>&nbsp;<span class="op" id="4577988">|</span>&nbsp;<span class="ident" id="4577990">CurveID</span><span class="op" id="4577997">(</span><span class="ident" id="4577998">d</span><span class="op" id="4577999">[</span><span class="num" id="4578000">1</span><span class="op" id="4578001">]</span><span class="op" id="4578002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4578008">d</span>&nbsp;<span class="op" id="4578010">=</span>&nbsp;<span class="ident" id="4578012">d</span><span class="op" id="4578013">[</span><span class="num" id="4578014">2</span><span class="op" id="4578015">:</span><span class="op" id="4578016">]</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4578021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4578025">case</span>&nbsp;<span class="ident" id="4578030">extensionSupportedPoints</span><span class="op" id="4578054">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4578059">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4578114">if</span>&nbsp;<span class="ident" id="4578117">length</span>&nbsp;<span class="op" id="4578124">&lt;</span>&nbsp;<span class="num" id="4578126">1</span>&nbsp;<span class="op" id="4578128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4578134">return</span>&nbsp;<span class="builtintype" id="4578141">false</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4578150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4578155">l</span>&nbsp;<span class="op" id="4578157">:=</span>&nbsp;<span class="builtintype" id="4578160">int</span><span class="op" id="4578163">(</span><span class="ident" id="4578164">data</span><span class="op" id="4578168">[</span><span class="num" id="4578169">0</span><span class="op" id="4578170">]</span><span class="op" id="4578171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4578176">if</span>&nbsp;<span class="ident" id="4578179">length</span>&nbsp;<span class="op" id="4578186">!=</span>&nbsp;<span class="ident" id="4578189">l</span><span class="op" id="4578190">+</span><span class="num" id="4578191">1</span>&nbsp;<span class="op" id="4578193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4578199">return</span>&nbsp;<span class="builtintype" id="4578206">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4578215">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4578220">m</span><span class="op" id="4578221">.</span><span class="ident" id="4578222">supportedPoints</span>&nbsp;<span class="op" id="4578238">=</span>&nbsp;<span class="builtinfunc" id="4578240">make</span><span class="op" id="4578244">(</span><span class="op" id="4578245">[</span><span class="op" id="4578246">]</span><span class="builtintype" id="4578247">uint8</span><span class="op" id="4578252">,</span>&nbsp;<span class="ident" id="4578254">l</span><span class="op" id="4578255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4578260">copy</span><span class="op" id="4578264">(</span><span class="ident" id="4578265">m</span><span class="op" id="4578266">.</span><span class="ident" id="4578267">supportedPoints</span><span class="op" id="4578282">,</span>&nbsp;<span class="ident" id="4578284">data</span><span class="op" id="4578288">[</span><span class="num" id="4578289">1</span><span class="op" id="4578290">:</span><span class="op" id="4578291">]</span><span class="op" id="4578292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4578296">case</span>&nbsp;<span class="ident" id="4578301">extensionSessionTicket</span><span class="op" id="4578323">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4578328">//&nbsp;http://tools.ietf.org/html/rfc5077#section-3.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4578381">m</span><span class="op" id="4578382">.</span><span class="ident" id="4578383">ticketSupported</span>&nbsp;<span class="op" id="4578399">=</span>&nbsp;<span class="builtintype" id="4578401">true</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4578409">m</span><span class="op" id="4578410">.</span><span class="ident" id="4578411">sessionTicket</span>&nbsp;<span class="op" id="4578425">=</span>&nbsp;<span class="ident" id="4578427">data</span><span class="op" id="4578431">[</span><span class="op" id="4578432">:</span><span class="ident" id="4578433">length</span><span class="op" id="4578439">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4578443">case</span>&nbsp;<span class="ident" id="4578448">extensionSignatureAlgorithms</span><span class="op" id="4578476">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4578481">//&nbsp;https://tools.ietf.org/html/rfc5246#section-7.4.1.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4578541">if</span>&nbsp;<span class="ident" id="4578544">length</span>&nbsp;<span class="op" id="4578551">&lt;</span>&nbsp;<span class="num" id="4578553">2</span>&nbsp;<span class="op" id="4578555">||</span>&nbsp;<span class="ident" id="4578558">length</span><span class="op" id="4578564">&amp;</span><span class="num" id="4578565">1</span>&nbsp;<span class="op" id="4578567">!=</span>&nbsp;<span class="num" id="4578570">0</span>&nbsp;<span class="op" id="4578572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4578578">return</span>&nbsp;<span class="builtintype" id="4578585">false</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4578594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4578599">l</span>&nbsp;<span class="op" id="4578601">:=</span>&nbsp;<span class="builtintype" id="4578604">int</span><span class="op" id="4578607">(</span><span class="ident" id="4578608">data</span><span class="op" id="4578612">[</span><span class="num" id="4578613">0</span><span class="op" id="4578614">]</span><span class="op" id="4578615">)</span><span class="op" id="4578616">&lt;&lt;</span><span class="num" id="4578618">8</span>&nbsp;<span class="op" id="4578620">|</span>&nbsp;<span class="builtintype" id="4578622">int</span><span class="op" id="4578625">(</span><span class="ident" id="4578626">data</span><span class="op" id="4578630">[</span><span class="num" id="4578631">1</span><span class="op" id="4578632">]</span><span class="op" id="4578633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4578638">if</span>&nbsp;<span class="ident" id="4578641">l</span>&nbsp;<span class="op" id="4578643">!=</span>&nbsp;<span class="ident" id="4578646">length</span><span class="op" id="4578652">-</span><span class="num" id="4578653">2</span>&nbsp;<span class="op" id="4578655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4578661">return</span>&nbsp;<span class="builtintype" id="4578668">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4578677">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4578682">n</span>&nbsp;<span class="op" id="4578684">:=</span>&nbsp;<span class="ident" id="4578687">l</span>&nbsp;<span class="op" id="4578689">/</span>&nbsp;<span class="num" id="4578691">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4578696">d</span>&nbsp;<span class="op" id="4578698">:=</span>&nbsp;<span class="ident" id="4578701">data</span><span class="op" id="4578705">[</span><span class="num" id="4578706">2</span><span class="op" id="4578707">:</span><span class="op" id="4578708">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4578713">m</span><span class="op" id="4578714">.</span><span class="ident" id="4578715">signatureAndHashes</span>&nbsp;<span class="op" id="4578734">=</span>&nbsp;<span class="builtinfunc" id="4578736">make</span><span class="op" id="4578740">(</span><span class="op" id="4578741">[</span><span class="op" id="4578742">]</span><span class="ident" id="4578743">signatureAndHash</span><span class="op" id="4578759">,</span>&nbsp;<span class="ident" id="4578761">n</span><span class="op" id="4578762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4578767">for</span>&nbsp;<span class="ident" id="4578771">i</span>&nbsp;<span class="op" id="4578773">:=</span>&nbsp;<span class="keyword" id="4578776">range</span>&nbsp;<span class="ident" id="4578782">m</span><span class="op" id="4578783">.</span><span class="ident" id="4578784">signatureAndHashes</span>&nbsp;<span class="op" id="4578803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4578809">m</span><span class="op" id="4578810">.</span><span class="ident" id="4578811">signatureAndHashes</span><span class="op" id="4578829">[</span><span class="ident" id="4578830">i</span><span class="op" id="4578831">]</span><span class="op" id="4578832">.</span><span class="ident" id="4578833">hash</span>&nbsp;<span class="op" id="4578838">=</span>&nbsp;<span class="ident" id="4578840">d</span><span class="op" id="4578841">[</span><span class="num" id="4578842">0</span><span class="op" id="4578843">]</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4578849">m</span><span class="op" id="4578850">.</span><span class="ident" id="4578851">signatureAndHashes</span><span class="op" id="4578869">[</span><span class="ident" id="4578870">i</span><span class="op" id="4578871">]</span><span class="op" id="4578872">.</span><span class="ident" id="4578873">signature</span>&nbsp;<span class="op" id="4578883">=</span>&nbsp;<span class="ident" id="4578885">d</span><span class="op" id="4578886">[</span><span class="num" id="4578887">1</span><span class="op" id="4578888">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4578894">d</span>&nbsp;<span class="op" id="4578896">=</span>&nbsp;<span class="ident" id="4578898">d</span><span class="op" id="4578899">[</span><span class="num" id="4578900">2</span><span class="op" id="4578901">:</span><span class="op" id="4578902">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4578907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4578911">case</span>&nbsp;<span class="ident" id="4578916">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="4578943">+</span>&nbsp;<span class="num" id="4578945">1</span><span class="op" id="4578946">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4578951">if</span>&nbsp;<span class="ident" id="4578954">length</span>&nbsp;<span class="op" id="4578961">!=</span>&nbsp;<span class="num" id="4578964">1</span>&nbsp;<span class="op" id="4578966">||</span>&nbsp;<span class="ident" id="4578969">data</span><span class="op" id="4578973">[</span><span class="num" id="4578974">0</span><span class="op" id="4578975">]</span>&nbsp;<span class="op" id="4578977">!=</span>&nbsp;<span class="num" id="4578980">0</span>&nbsp;<span class="op" id="4578982">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4578988">return</span>&nbsp;<span class="builtintype" id="4578995">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4579004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4579009">m</span><span class="op" id="4579010">.</span><span class="ident" id="4579011">secureRenegotiation</span>&nbsp;<span class="op" id="4579031">=</span>&nbsp;<span class="builtintype" id="4579033">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4579040">case</span>&nbsp;<span class="ident" id="4579045">extensionALPN</span><span class="op" id="4579058">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4579063">if</span>&nbsp;<span class="ident" id="4579066">length</span>&nbsp;<span class="op" id="4579073">&lt;</span>&nbsp;<span class="num" id="4579075">2</span>&nbsp;<span class="op" id="4579077">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4579083">return</span>&nbsp;<span class="builtintype" id="4579090">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4579099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4579104">l</span>&nbsp;<span class="op" id="4579106">:=</span>&nbsp;<span class="builtintype" id="4579109">int</span><span class="op" id="4579112">(</span><span class="ident" id="4579113">data</span><span class="op" id="4579117">[</span><span class="num" id="4579118">0</span><span class="op" id="4579119">]</span><span class="op" id="4579120">)</span><span class="op" id="4579121">&lt;&lt;</span><span class="num" id="4579123">8</span>&nbsp;<span class="op" id="4579125">|</span>&nbsp;<span class="builtintype" id="4579127">int</span><span class="op" id="4579130">(</span><span class="ident" id="4579131">data</span><span class="op" id="4579135">[</span><span class="num" id="4579136">1</span><span class="op" id="4579137">]</span><span class="op" id="4579138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4579143">if</span>&nbsp;<span class="ident" id="4579146">l</span>&nbsp;<span class="op" id="4579148">!=</span>&nbsp;<span class="ident" id="4579151">length</span><span class="op" id="4579157">-</span><span class="num" id="4579158">2</span>&nbsp;<span class="op" id="4579160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4579166">return</span>&nbsp;<span class="builtintype" id="4579173">false</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4579182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4579187">d</span>&nbsp;<span class="op" id="4579189">:=</span>&nbsp;<span class="ident" id="4579192">data</span><span class="op" id="4579196">[</span><span class="num" id="4579197">2</span><span class="op" id="4579198">:</span><span class="ident" id="4579199">length</span><span class="op" id="4579205">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4579210">for</span>&nbsp;<span class="builtinfunc" id="4579214">len</span><span class="op" id="4579217">(</span><span class="ident" id="4579218">d</span><span class="op" id="4579219">)</span>&nbsp;<span class="op" id="4579221">!=</span>&nbsp;<span class="num" id="4579224">0</span>&nbsp;<span class="op" id="4579226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4579232">stringLen</span>&nbsp;<span class="op" id="4579242">:=</span>&nbsp;<span class="builtintype" id="4579245">int</span><span class="op" id="4579248">(</span><span class="ident" id="4579249">d</span><span class="op" id="4579250">[</span><span class="num" id="4579251">0</span><span class="op" id="4579252">]</span><span class="op" id="4579253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4579259">d</span>&nbsp;<span class="op" id="4579261">=</span>&nbsp;<span class="ident" id="4579263">d</span><span class="op" id="4579264">[</span><span class="num" id="4579265">1</span><span class="op" id="4579266">:</span><span class="op" id="4579267">]</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4579273">if</span>&nbsp;<span class="ident" id="4579276">stringLen</span>&nbsp;<span class="op" id="4579286">==</span>&nbsp;<span class="num" id="4579289">0</span>&nbsp;<span class="op" id="4579291">||</span>&nbsp;<span class="ident" id="4579294">stringLen</span>&nbsp;<span class="op" id="4579304">&gt;</span>&nbsp;<span class="builtinfunc" id="4579306">len</span><span class="op" id="4579309">(</span><span class="ident" id="4579310">d</span><span class="op" id="4579311">)</span>&nbsp;<span class="op" id="4579313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4579320">return</span>&nbsp;<span class="builtintype" id="4579327">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4579337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4579343">m</span><span class="op" id="4579344">.</span><span class="ident" id="4579345">alpnProtocols</span>&nbsp;<span class="op" id="4579359">=</span>&nbsp;<span class="builtinfunc" id="4579361">append</span><span class="op" id="4579367">(</span><span class="ident" id="4579368">m</span><span class="op" id="4579369">.</span><span class="ident" id="4579370">alpnProtocols</span><span class="op" id="4579383">,</span>&nbsp;<span class="builtintype" id="4579385">string</span><span class="op" id="4579391">(</span><span class="ident" id="4579392">d</span><span class="op" id="4579393">[</span><span class="op" id="4579394">:</span><span class="ident" id="4579395">stringLen</span><span class="op" id="4579404">]</span><span class="op" id="4579405">)</span><span class="op" id="4579406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4579412">d</span>&nbsp;<span class="op" id="4579414">=</span>&nbsp;<span class="ident" id="4579416">d</span><span class="op" id="4579417">[</span><span class="ident" id="4579418">stringLen</span><span class="op" id="4579427">:</span><span class="op" id="4579428">]</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4579433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4579437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4579441">data</span>&nbsp;<span class="op" id="4579446">=</span>&nbsp;<span class="ident" id="4579448">data</span><span class="op" id="4579452">[</span><span class="ident" id="4579453">length</span><span class="op" id="4579459">:</span><span class="op" id="4579460">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4579463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4579467">return</span>&nbsp;<span class="builtintype" id="4579474">true</span><br>
<span class="lineno"></span><span class="op" id="4579479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4579482">type</span>&nbsp;<span class="ident" id="4579487">serverHelloMsg</span>&nbsp;<span class="keyword" id="4579502">struct</span>&nbsp;<span class="op" id="4579509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4579512">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4579532">[</span><span class="op" id="4579533">]</span><span class="builtintype" id="4579534">byte</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4579540">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4579560">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4579568">random</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4579588">[</span><span class="op" id="4579589">]</span><span class="builtintype" id="4579590">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4579596">sessionId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4579616">[</span><span class="op" id="4579617">]</span><span class="builtintype" id="4579618">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4579624">cipherSuite</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4579644">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4579652">compressionMethod</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4579672">uint8</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4579679">nextProtoNeg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4579699">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4579705">nextProtos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4579725">[</span><span class="op" id="4579726">]</span><span class="builtintype" id="4579727">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4579735">ocspStapling</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4579755">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4579761">ticketSupported</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4579781">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4579787">secureRenegotiation</span>&nbsp;<span class="builtintype" id="4579807">bool</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4579813">alpnProtocol</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4579833">string</span><br>
<span class="lineno"></span><span class="op" id="4579840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4579843">func</span>&nbsp;<span class="op" id="4579848">(</span><span class="ident" id="4579849">m</span>&nbsp;<span class="op" id="4579851">*</span><span class="ident" id="4579852">serverHelloMsg</span><span class="op" id="4579866">)</span>&nbsp;<span class="ident" id="4579868">equal</span><span class="op" id="4579873">(</span><span class="ident" id="4579874">i</span>&nbsp;<span class="keyword" id="4579876">interface</span><span class="op" id="4579885">{</span><span class="op" id="4579886">}</span><span class="op" id="4579887">)</span>&nbsp;<span class="builtintype" id="4579889">bool</span>&nbsp;<span class="op" id="4579894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4579897">m1</span><span class="op" id="4579899">,</span>&nbsp;<span class="ident" id="4579901">ok</span>&nbsp;<span class="op" id="4579904">:=</span>&nbsp;<span class="ident" id="4579907">i</span><span class="op" id="4579908">.</span><span class="op" id="4579909">(</span><span class="op" id="4579910">*</span><span class="ident" id="4579911">serverHelloMsg</span><span class="op" id="4579925">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4579928">if</span>&nbsp;<span class="op" id="4579931">!</span><span class="ident" id="4579932">ok</span>&nbsp;<span class="op" id="4579935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4579939">return</span>&nbsp;<span class="builtintype" id="4579946">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4579953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4579957">return</span>&nbsp;<span class="ident" id="4579964">bytes</span><span class="op" id="4579969">.</span><span class="ident" id="4579970">Equal</span><span class="op" id="4579975">(</span><span class="ident" id="4579976">m</span><span class="op" id="4579977">.</span><span class="ident" id="4579978">raw</span><span class="op" id="4579981">,</span>&nbsp;<span class="ident" id="4579983">m1</span><span class="op" id="4579985">.</span><span class="ident" id="4579986">raw</span><span class="op" id="4579989">)</span>&nbsp;<span class="op" id="4579991">&amp;&amp;</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4579996">m</span><span class="op" id="4579997">.</span><span class="ident" id="4579998">vers</span>&nbsp;<span class="op" id="4580003">==</span>&nbsp;<span class="ident" id="4580006">m1</span><span class="op" id="4580008">.</span><span class="ident" id="4580009">vers</span>&nbsp;<span class="op" id="4580014">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4580019">bytes</span><span class="op" id="4580024">.</span><span class="ident" id="4580025">Equal</span><span class="op" id="4580030">(</span><span class="ident" id="4580031">m</span><span class="op" id="4580032">.</span><span class="ident" id="4580033">random</span><span class="op" id="4580039">,</span>&nbsp;<span class="ident" id="4580041">m1</span><span class="op" id="4580043">.</span><span class="ident" id="4580044">random</span><span class="op" id="4580050">)</span>&nbsp;<span class="op" id="4580052">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4580057">bytes</span><span class="op" id="4580062">.</span><span class="ident" id="4580063">Equal</span><span class="op" id="4580068">(</span><span class="ident" id="4580069">m</span><span class="op" id="4580070">.</span><span class="ident" id="4580071">sessionId</span><span class="op" id="4580080">,</span>&nbsp;<span class="ident" id="4580082">m1</span><span class="op" id="4580084">.</span><span class="ident" id="4580085">sessionId</span><span class="op" id="4580094">)</span>&nbsp;<span class="op" id="4580096">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4580101">m</span><span class="op" id="4580102">.</span><span class="ident" id="4580103">cipherSuite</span>&nbsp;<span class="op" id="4580115">==</span>&nbsp;<span class="ident" id="4580118">m1</span><span class="op" id="4580120">.</span><span class="ident" id="4580121">cipherSuite</span>&nbsp;<span class="op" id="4580133">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4580138">m</span><span class="op" id="4580139">.</span><span class="ident" id="4580140">compressionMethod</span>&nbsp;<span class="op" id="4580158">==</span>&nbsp;<span class="ident" id="4580161">m1</span><span class="op" id="4580163">.</span><span class="ident" id="4580164">compressionMethod</span>&nbsp;<span class="op" id="4580182">&amp;&amp;</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4580187">m</span><span class="op" id="4580188">.</span><span class="ident" id="4580189">nextProtoNeg</span>&nbsp;<span class="op" id="4580202">==</span>&nbsp;<span class="ident" id="4580205">m1</span><span class="op" id="4580207">.</span><span class="ident" id="4580208">nextProtoNeg</span>&nbsp;<span class="op" id="4580221">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4580226">eqStrings</span><span class="op" id="4580235">(</span><span class="ident" id="4580236">m</span><span class="op" id="4580237">.</span><span class="ident" id="4580238">nextProtos</span><span class="op" id="4580248">,</span>&nbsp;<span class="ident" id="4580250">m1</span><span class="op" id="4580252">.</span><span class="ident" id="4580253">nextProtos</span><span class="op" id="4580263">)</span>&nbsp;<span class="op" id="4580265">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4580270">m</span><span class="op" id="4580271">.</span><span class="ident" id="4580272">ocspStapling</span>&nbsp;<span class="op" id="4580285">==</span>&nbsp;<span class="ident" id="4580288">m1</span><span class="op" id="4580290">.</span><span class="ident" id="4580291">ocspStapling</span>&nbsp;<span class="op" id="4580304">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4580309">m</span><span class="op" id="4580310">.</span><span class="ident" id="4580311">ticketSupported</span>&nbsp;<span class="op" id="4580327">==</span>&nbsp;<span class="ident" id="4580330">m1</span><span class="op" id="4580332">.</span><span class="ident" id="4580333">ticketSupported</span>&nbsp;<span class="op" id="4580349">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4580354">m</span><span class="op" id="4580355">.</span><span class="ident" id="4580356">secureRenegotiation</span>&nbsp;<span class="op" id="4580376">==</span>&nbsp;<span class="ident" id="4580379">m1</span><span class="op" id="4580381">.</span><span class="ident" id="4580382">secureRenegotiation</span>&nbsp;<span class="op" id="4580402">&amp;&amp;</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4580407">m</span><span class="op" id="4580408">.</span><span class="ident" id="4580409">alpnProtocol</span>&nbsp;<span class="op" id="4580422">==</span>&nbsp;<span class="ident" id="4580425">m1</span><span class="op" id="4580427">.</span><span class="ident" id="4580428">alpnProtocol</span><br>
<span class="lineno"></span><span class="op" id="4580441">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4580444">func</span>&nbsp;<span class="op" id="4580449">(</span><span class="ident" id="4580450">m</span>&nbsp;<span class="op" id="4580452">*</span><span class="ident" id="4580453">serverHelloMsg</span><span class="op" id="4580467">)</span>&nbsp;<span class="ident" id="4580469">marshal</span><span class="op" id="4580476">(</span><span class="op" id="4580477">)</span>&nbsp;<span class="op" id="4580479">[</span><span class="op" id="4580480">]</span><span class="builtintype" id="4580481">byte</span>&nbsp;<span class="op" id="4580486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4580489">if</span>&nbsp;<span class="ident" id="4580492">m</span><span class="op" id="4580493">.</span><span class="ident" id="4580494">raw</span>&nbsp;<span class="op" id="4580498">!=</span>&nbsp;<span class="ident" id="4580501">nil</span>&nbsp;<span class="op" id="4580505">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4580509">return</span>&nbsp;<span class="ident" id="4580516">m</span><span class="op" id="4580517">.</span><span class="ident" id="4580518">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4580523">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4580527">length</span>&nbsp;<span class="op" id="4580534">:=</span>&nbsp;<span class="num" id="4580537">38</span>&nbsp;<span class="op" id="4580540">+</span>&nbsp;<span class="builtinfunc" id="4580542">len</span><span class="op" id="4580545">(</span><span class="ident" id="4580546">m</span><span class="op" id="4580547">.</span><span class="ident" id="4580548">sessionId</span><span class="op" id="4580557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4580560">numExtensions</span>&nbsp;<span class="op" id="4580574">:=</span>&nbsp;<span class="num" id="4580577">0</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4580580">extensionsLength</span>&nbsp;<span class="op" id="4580597">:=</span>&nbsp;<span class="num" id="4580600">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4580604">nextProtoLen</span>&nbsp;<span class="op" id="4580617">:=</span>&nbsp;<span class="num" id="4580620">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4580623">if</span>&nbsp;<span class="ident" id="4580626">m</span><span class="op" id="4580627">.</span><span class="ident" id="4580628">nextProtoNeg</span>&nbsp;<span class="op" id="4580641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4580645">numExtensions</span><span class="op" id="4580658">++</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4580663">for</span>&nbsp;<span class="ident" id="4580667">_</span><span class="op" id="4580668">,</span>&nbsp;<span class="ident" id="4580670">v</span>&nbsp;<span class="op" id="4580672">:=</span>&nbsp;<span class="keyword" id="4580675">range</span>&nbsp;<span class="ident" id="4580681">m</span><span class="op" id="4580682">.</span><span class="ident" id="4580683">nextProtos</span>&nbsp;<span class="op" id="4580694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4580699">nextProtoLen</span>&nbsp;<span class="op" id="4580712">+=</span>&nbsp;<span class="builtinfunc" id="4580715">len</span><span class="op" id="4580718">(</span><span class="ident" id="4580719">v</span><span class="op" id="4580720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4580724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4580728">nextProtoLen</span>&nbsp;<span class="op" id="4580741">+=</span>&nbsp;<span class="builtinfunc" id="4580744">len</span><span class="op" id="4580747">(</span><span class="ident" id="4580748">m</span><span class="op" id="4580749">.</span><span class="ident" id="4580750">nextProtos</span><span class="op" id="4580760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4580764">extensionsLength</span>&nbsp;<span class="op" id="4580781">+=</span>&nbsp;<span class="ident" id="4580784">nextProtoLen</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4580798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4580801">if</span>&nbsp;<span class="ident" id="4580804">m</span><span class="op" id="4580805">.</span><span class="ident" id="4580806">ocspStapling</span>&nbsp;<span class="op" id="4580819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4580823">numExtensions</span><span class="op" id="4580836">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4580840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4580843">if</span>&nbsp;<span class="ident" id="4580846">m</span><span class="op" id="4580847">.</span><span class="ident" id="4580848">ticketSupported</span>&nbsp;<span class="op" id="4580864">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4580868">numExtensions</span><span class="op" id="4580881">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4580885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4580888">if</span>&nbsp;<span class="ident" id="4580891">m</span><span class="op" id="4580892">.</span><span class="ident" id="4580893">secureRenegotiation</span>&nbsp;<span class="op" id="4580913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4580917">extensionsLength</span>&nbsp;<span class="op" id="4580934">+=</span>&nbsp;<span class="num" id="4580937">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4580941">numExtensions</span><span class="op" id="4580954">++</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4580958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4580961">if</span>&nbsp;<span class="ident" id="4580964">alpnLen</span>&nbsp;<span class="op" id="4580972">:=</span>&nbsp;<span class="builtinfunc" id="4580975">len</span><span class="op" id="4580978">(</span><span class="ident" id="4580979">m</span><span class="op" id="4580980">.</span><span class="ident" id="4580981">alpnProtocol</span><span class="op" id="4580993">)</span><span class="op" id="4580994">;</span>&nbsp;<span class="ident" id="4580996">alpnLen</span>&nbsp;<span class="op" id="4581004">&gt;</span>&nbsp;<span class="num" id="4581006">0</span>&nbsp;<span class="op" id="4581008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4581012">if</span>&nbsp;<span class="ident" id="4581015">alpnLen</span>&nbsp;<span class="op" id="4581023">&gt;=</span>&nbsp;<span class="num" id="4581026">256</span>&nbsp;<span class="op" id="4581030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4581035">panic</span><span class="op" id="4581040">(</span><span class="string" id="4581041">&#34;invalid&nbsp;ALPN&nbsp;protocol&#34;</span><span class="op" id="4581064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4581068">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4581072">extensionsLength</span>&nbsp;<span class="op" id="4581089">+=</span>&nbsp;<span class="num" id="4581092">2</span>&nbsp;<span class="op" id="4581094">+</span>&nbsp;<span class="num" id="4581096">1</span>&nbsp;<span class="op" id="4581098">+</span>&nbsp;<span class="ident" id="4581100">alpnLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4581110">numExtensions</span><span class="op" id="4581123">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4581127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4581131">if</span>&nbsp;<span class="ident" id="4581134">numExtensions</span>&nbsp;<span class="op" id="4581148">&gt;</span>&nbsp;<span class="num" id="4581150">0</span>&nbsp;<span class="op" id="4581152">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4581156">extensionsLength</span>&nbsp;<span class="op" id="4581173">+=</span>&nbsp;<span class="num" id="4581176">4</span>&nbsp;<span class="op" id="4581178">*</span>&nbsp;<span class="ident" id="4581180">numExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4581196">length</span>&nbsp;<span class="op" id="4581203">+=</span>&nbsp;<span class="num" id="4581206">2</span>&nbsp;<span class="op" id="4581208">+</span>&nbsp;<span class="ident" id="4581210">extensionsLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4581228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4581232">x</span>&nbsp;<span class="op" id="4581234">:=</span>&nbsp;<span class="builtinfunc" id="4581237">make</span><span class="op" id="4581241">(</span><span class="op" id="4581242">[</span><span class="op" id="4581243">]</span><span class="builtintype" id="4581244">byte</span><span class="op" id="4581248">,</span>&nbsp;<span class="num" id="4581250">4</span><span class="op" id="4581251">+</span><span class="ident" id="4581252">length</span><span class="op" id="4581258">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4581261">x</span><span class="op" id="4581262">[</span><span class="num" id="4581263">0</span><span class="op" id="4581264">]</span>&nbsp;<span class="op" id="4581266">=</span>&nbsp;<span class="ident" id="4581268">typeServerHello</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4581285">x</span><span class="op" id="4581286">[</span><span class="num" id="4581287">1</span><span class="op" id="4581288">]</span>&nbsp;<span class="op" id="4581290">=</span>&nbsp;<span class="builtintype" id="4581292">uint8</span><span class="op" id="4581297">(</span><span class="ident" id="4581298">length</span>&nbsp;<span class="op" id="4581305">&gt;&gt;</span>&nbsp;<span class="num" id="4581308">16</span><span class="op" id="4581310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4581313">x</span><span class="op" id="4581314">[</span><span class="num" id="4581315">2</span><span class="op" id="4581316">]</span>&nbsp;<span class="op" id="4581318">=</span>&nbsp;<span class="builtintype" id="4581320">uint8</span><span class="op" id="4581325">(</span><span class="ident" id="4581326">length</span>&nbsp;<span class="op" id="4581333">&gt;&gt;</span>&nbsp;<span class="num" id="4581336">8</span><span class="op" id="4581337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4581340">x</span><span class="op" id="4581341">[</span><span class="num" id="4581342">3</span><span class="op" id="4581343">]</span>&nbsp;<span class="op" id="4581345">=</span>&nbsp;<span class="builtintype" id="4581347">uint8</span><span class="op" id="4581352">(</span><span class="ident" id="4581353">length</span><span class="op" id="4581359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4581362">x</span><span class="op" id="4581363">[</span><span class="num" id="4581364">4</span><span class="op" id="4581365">]</span>&nbsp;<span class="op" id="4581367">=</span>&nbsp;<span class="builtintype" id="4581369">uint8</span><span class="op" id="4581374">(</span><span class="ident" id="4581375">m</span><span class="op" id="4581376">.</span><span class="ident" id="4581377">vers</span>&nbsp;<span class="op" id="4581382">&gt;&gt;</span>&nbsp;<span class="num" id="4581385">8</span><span class="op" id="4581386">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4581389">x</span><span class="op" id="4581390">[</span><span class="num" id="4581391">5</span><span class="op" id="4581392">]</span>&nbsp;<span class="op" id="4581394">=</span>&nbsp;<span class="builtintype" id="4581396">uint8</span><span class="op" id="4581401">(</span><span class="ident" id="4581402">m</span><span class="op" id="4581403">.</span><span class="ident" id="4581404">vers</span><span class="op" id="4581408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4581411">copy</span><span class="op" id="4581415">(</span><span class="ident" id="4581416">x</span><span class="op" id="4581417">[</span><span class="num" id="4581418">6</span><span class="op" id="4581419">:</span><span class="num" id="4581420">38</span><span class="op" id="4581422">]</span><span class="op" id="4581423">,</span>&nbsp;<span class="ident" id="4581425">m</span><span class="op" id="4581426">.</span><span class="ident" id="4581427">random</span><span class="op" id="4581433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4581436">x</span><span class="op" id="4581437">[</span><span class="num" id="4581438">38</span><span class="op" id="4581440">]</span>&nbsp;<span class="op" id="4581442">=</span>&nbsp;<span class="builtintype" id="4581444">uint8</span><span class="op" id="4581449">(</span><span class="builtinfunc" id="4581450">len</span><span class="op" id="4581453">(</span><span class="ident" id="4581454">m</span><span class="op" id="4581455">.</span><span class="ident" id="4581456">sessionId</span><span class="op" id="4581465">)</span><span class="op" id="4581466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4581469">copy</span><span class="op" id="4581473">(</span><span class="ident" id="4581474">x</span><span class="op" id="4581475">[</span><span class="num" id="4581476">39</span><span class="op" id="4581478">:</span><span class="num" id="4581479">39</span><span class="op" id="4581481">+</span><span class="builtinfunc" id="4581482">len</span><span class="op" id="4581485">(</span><span class="ident" id="4581486">m</span><span class="op" id="4581487">.</span><span class="ident" id="4581488">sessionId</span><span class="op" id="4581497">)</span><span class="op" id="4581498">]</span><span class="op" id="4581499">,</span>&nbsp;<span class="ident" id="4581501">m</span><span class="op" id="4581502">.</span><span class="ident" id="4581503">sessionId</span><span class="op" id="4581512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4581515">z</span>&nbsp;<span class="op" id="4581517">:=</span>&nbsp;<span class="ident" id="4581520">x</span><span class="op" id="4581521">[</span><span class="num" id="4581522">39</span><span class="op" id="4581524">+</span><span class="builtinfunc" id="4581525">len</span><span class="op" id="4581528">(</span><span class="ident" id="4581529">m</span><span class="op" id="4581530">.</span><span class="ident" id="4581531">sessionId</span><span class="op" id="4581540">)</span><span class="op" id="4581541">:</span><span class="op" id="4581542">]</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4581545">z</span><span class="op" id="4581546">[</span><span class="num" id="4581547">0</span><span class="op" id="4581548">]</span>&nbsp;<span class="op" id="4581550">=</span>&nbsp;<span class="builtintype" id="4581552">uint8</span><span class="op" id="4581557">(</span><span class="ident" id="4581558">m</span><span class="op" id="4581559">.</span><span class="ident" id="4581560">cipherSuite</span>&nbsp;<span class="op" id="4581572">&gt;&gt;</span>&nbsp;<span class="num" id="4581575">8</span><span class="op" id="4581576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4581579">z</span><span class="op" id="4581580">[</span><span class="num" id="4581581">1</span><span class="op" id="4581582">]</span>&nbsp;<span class="op" id="4581584">=</span>&nbsp;<span class="builtintype" id="4581586">uint8</span><span class="op" id="4581591">(</span><span class="ident" id="4581592">m</span><span class="op" id="4581593">.</span><span class="ident" id="4581594">cipherSuite</span><span class="op" id="4581605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4581608">z</span><span class="op" id="4581609">[</span><span class="num" id="4581610">2</span><span class="op" id="4581611">]</span>&nbsp;<span class="op" id="4581613">=</span>&nbsp;<span class="builtintype" id="4581615">uint8</span><span class="op" id="4581620">(</span><span class="ident" id="4581621">m</span><span class="op" id="4581622">.</span><span class="ident" id="4581623">compressionMethod</span><span class="op" id="4581640">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4581644">z</span>&nbsp;<span class="op" id="4581646">=</span>&nbsp;<span class="ident" id="4581648">z</span><span class="op" id="4581649">[</span><span class="num" id="4581650">3</span><span class="op" id="4581651">:</span><span class="op" id="4581652">]</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4581655">if</span>&nbsp;<span class="ident" id="4581658">numExtensions</span>&nbsp;<span class="op" id="4581672">&gt;</span>&nbsp;<span class="num" id="4581674">0</span>&nbsp;<span class="op" id="4581676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4581680">z</span><span class="op" id="4581681">[</span><span class="num" id="4581682">0</span><span class="op" id="4581683">]</span>&nbsp;<span class="op" id="4581685">=</span>&nbsp;<span class="builtintype" id="4581687">byte</span><span class="op" id="4581691">(</span><span class="ident" id="4581692">extensionsLength</span>&nbsp;<span class="op" id="4581709">&gt;&gt;</span>&nbsp;<span class="num" id="4581712">8</span><span class="op" id="4581713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4581717">z</span><span class="op" id="4581718">[</span><span class="num" id="4581719">1</span><span class="op" id="4581720">]</span>&nbsp;<span class="op" id="4581722">=</span>&nbsp;<span class="builtintype" id="4581724">byte</span><span class="op" id="4581728">(</span><span class="ident" id="4581729">extensionsLength</span><span class="op" id="4581745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4581749">z</span>&nbsp;<span class="op" id="4581751">=</span>&nbsp;<span class="ident" id="4581753">z</span><span class="op" id="4581754">[</span><span class="num" id="4581755">2</span><span class="op" id="4581756">:</span><span class="op" id="4581757">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4581760">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4581763">if</span>&nbsp;<span class="ident" id="4581766">m</span><span class="op" id="4581767">.</span><span class="ident" id="4581768">nextProtoNeg</span>&nbsp;<span class="op" id="4581781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4581785">z</span><span class="op" id="4581786">[</span><span class="num" id="4581787">0</span><span class="op" id="4581788">]</span>&nbsp;<span class="op" id="4581790">=</span>&nbsp;<span class="builtintype" id="4581792">byte</span><span class="op" id="4581796">(</span><span class="ident" id="4581797">extensionNextProtoNeg</span>&nbsp;<span class="op" id="4581819">&gt;&gt;</span>&nbsp;<span class="num" id="4581822">8</span><span class="op" id="4581823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4581827">z</span><span class="op" id="4581828">[</span><span class="num" id="4581829">1</span><span class="op" id="4581830">]</span>&nbsp;<span class="op" id="4581832">=</span>&nbsp;<span class="builtintype" id="4581834">byte</span><span class="op" id="4581838">(</span><span class="ident" id="4581839">extensionNextProtoNeg</span>&nbsp;<span class="op" id="4581861">&amp;</span>&nbsp;<span class="num" id="4581863">0xff</span><span class="op" id="4581867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4581871">z</span><span class="op" id="4581872">[</span><span class="num" id="4581873">2</span><span class="op" id="4581874">]</span>&nbsp;<span class="op" id="4581876">=</span>&nbsp;<span class="builtintype" id="4581878">byte</span><span class="op" id="4581882">(</span><span class="ident" id="4581883">nextProtoLen</span>&nbsp;<span class="op" id="4581896">&gt;&gt;</span>&nbsp;<span class="num" id="4581899">8</span><span class="op" id="4581900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4581904">z</span><span class="op" id="4581905">[</span><span class="num" id="4581906">3</span><span class="op" id="4581907">]</span>&nbsp;<span class="op" id="4581909">=</span>&nbsp;<span class="builtintype" id="4581911">byte</span><span class="op" id="4581915">(</span><span class="ident" id="4581916">nextProtoLen</span><span class="op" id="4581928">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4581932">z</span>&nbsp;<span class="op" id="4581934">=</span>&nbsp;<span class="ident" id="4581936">z</span><span class="op" id="4581937">[</span><span class="num" id="4581938">4</span><span class="op" id="4581939">:</span><span class="op" id="4581940">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4581945">for</span>&nbsp;<span class="ident" id="4581949">_</span><span class="op" id="4581950">,</span>&nbsp;<span class="ident" id="4581952">v</span>&nbsp;<span class="op" id="4581954">:=</span>&nbsp;<span class="keyword" id="4581957">range</span>&nbsp;<span class="ident" id="4581963">m</span><span class="op" id="4581964">.</span><span class="ident" id="4581965">nextProtos</span>&nbsp;<span class="op" id="4581976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4581981">l</span>&nbsp;<span class="op" id="4581983">:=</span>&nbsp;<span class="builtinfunc" id="4581986">len</span><span class="op" id="4581989">(</span><span class="ident" id="4581990">v</span><span class="op" id="4581991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4581996">if</span>&nbsp;<span class="ident" id="4581999">l</span>&nbsp;<span class="op" id="4582001">&gt;</span>&nbsp;<span class="num" id="4582003">255</span>&nbsp;<span class="op" id="4582007">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4582013">l</span>&nbsp;<span class="op" id="4582015">=</span>&nbsp;<span class="num" id="4582017">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4582024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4582029">z</span><span class="op" id="4582030">[</span><span class="num" id="4582031">0</span><span class="op" id="4582032">]</span>&nbsp;<span class="op" id="4582034">=</span>&nbsp;<span class="builtintype" id="4582036">byte</span><span class="op" id="4582040">(</span><span class="ident" id="4582041">l</span><span class="op" id="4582042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4582047">copy</span><span class="op" id="4582051">(</span><span class="ident" id="4582052">z</span><span class="op" id="4582053">[</span><span class="num" id="4582054">1</span><span class="op" id="4582055">:</span><span class="op" id="4582056">]</span><span class="op" id="4582057">,</span>&nbsp;<span class="op" id="4582059">[</span><span class="op" id="4582060">]</span><span class="builtintype" id="4582061">byte</span><span class="op" id="4582065">(</span><span class="ident" id="4582066">v</span><span class="op" id="4582067">[</span><span class="num" id="4582068">0</span><span class="op" id="4582069">:</span><span class="ident" id="4582070">l</span><span class="op" id="4582071">]</span><span class="op" id="4582072">)</span><span class="op" id="4582073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4582078">z</span>&nbsp;<span class="op" id="4582080">=</span>&nbsp;<span class="ident" id="4582082">z</span><span class="op" id="4582083">[</span><span class="num" id="4582084">1</span><span class="op" id="4582085">+</span><span class="ident" id="4582086">l</span><span class="op" id="4582087">:</span><span class="op" id="4582088">]</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4582092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4582095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4582098">if</span>&nbsp;<span class="ident" id="4582101">m</span><span class="op" id="4582102">.</span><span class="ident" id="4582103">ocspStapling</span>&nbsp;<span class="op" id="4582116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4582120">z</span><span class="op" id="4582121">[</span><span class="num" id="4582122">0</span><span class="op" id="4582123">]</span>&nbsp;<span class="op" id="4582125">=</span>&nbsp;<span class="builtintype" id="4582127">byte</span><span class="op" id="4582131">(</span><span class="ident" id="4582132">extensionStatusRequest</span>&nbsp;<span class="op" id="4582155">&gt;&gt;</span>&nbsp;<span class="num" id="4582158">8</span><span class="op" id="4582159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4582163">z</span><span class="op" id="4582164">[</span><span class="num" id="4582165">1</span><span class="op" id="4582166">]</span>&nbsp;<span class="op" id="4582168">=</span>&nbsp;<span class="builtintype" id="4582170">byte</span><span class="op" id="4582174">(</span><span class="ident" id="4582175">extensionStatusRequest</span><span class="op" id="4582197">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4582201">z</span>&nbsp;<span class="op" id="4582203">=</span>&nbsp;<span class="ident" id="4582205">z</span><span class="op" id="4582206">[</span><span class="num" id="4582207">4</span><span class="op" id="4582208">:</span><span class="op" id="4582209">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4582212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4582215">if</span>&nbsp;<span class="ident" id="4582218">m</span><span class="op" id="4582219">.</span><span class="ident" id="4582220">ticketSupported</span>&nbsp;<span class="op" id="4582236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4582240">z</span><span class="op" id="4582241">[</span><span class="num" id="4582242">0</span><span class="op" id="4582243">]</span>&nbsp;<span class="op" id="4582245">=</span>&nbsp;<span class="builtintype" id="4582247">byte</span><span class="op" id="4582251">(</span><span class="ident" id="4582252">extensionSessionTicket</span>&nbsp;<span class="op" id="4582275">&gt;&gt;</span>&nbsp;<span class="num" id="4582278">8</span><span class="op" id="4582279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4582283">z</span><span class="op" id="4582284">[</span><span class="num" id="4582285">1</span><span class="op" id="4582286">]</span>&nbsp;<span class="op" id="4582288">=</span>&nbsp;<span class="builtintype" id="4582290">byte</span><span class="op" id="4582294">(</span><span class="ident" id="4582295">extensionSessionTicket</span><span class="op" id="4582317">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4582321">z</span>&nbsp;<span class="op" id="4582323">=</span>&nbsp;<span class="ident" id="4582325">z</span><span class="op" id="4582326">[</span><span class="num" id="4582327">4</span><span class="op" id="4582328">:</span><span class="op" id="4582329">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4582332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4582335">if</span>&nbsp;<span class="ident" id="4582338">m</span><span class="op" id="4582339">.</span><span class="ident" id="4582340">secureRenegotiation</span>&nbsp;<span class="op" id="4582360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4582364">z</span><span class="op" id="4582365">[</span><span class="num" id="4582366">0</span><span class="op" id="4582367">]</span>&nbsp;<span class="op" id="4582369">=</span>&nbsp;<span class="builtintype" id="4582371">byte</span><span class="op" id="4582375">(</span><span class="ident" id="4582376">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="4582403">&gt;&gt;</span>&nbsp;<span class="num" id="4582406">8</span><span class="op" id="4582407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4582411">z</span><span class="op" id="4582412">[</span><span class="num" id="4582413">1</span><span class="op" id="4582414">]</span>&nbsp;<span class="op" id="4582416">=</span>&nbsp;<span class="builtintype" id="4582418">byte</span><span class="op" id="4582422">(</span><span class="ident" id="4582423">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="4582450">&amp;</span>&nbsp;<span class="num" id="4582452">0xff</span><span class="op" id="4582456">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4582460">z</span><span class="op" id="4582461">[</span><span class="num" id="4582462">2</span><span class="op" id="4582463">]</span>&nbsp;<span class="op" id="4582465">=</span>&nbsp;<span class="num" id="4582467">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4582471">z</span><span class="op" id="4582472">[</span><span class="num" id="4582473">3</span><span class="op" id="4582474">]</span>&nbsp;<span class="op" id="4582476">=</span>&nbsp;<span class="num" id="4582478">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4582482">z</span>&nbsp;<span class="op" id="4582484">=</span>&nbsp;<span class="ident" id="4582486">z</span><span class="op" id="4582487">[</span><span class="num" id="4582488">5</span><span class="op" id="4582489">:</span><span class="op" id="4582490">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4582493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4582496">if</span>&nbsp;<span class="ident" id="4582499">alpnLen</span>&nbsp;<span class="op" id="4582507">:=</span>&nbsp;<span class="builtinfunc" id="4582510">len</span><span class="op" id="4582513">(</span><span class="ident" id="4582514">m</span><span class="op" id="4582515">.</span><span class="ident" id="4582516">alpnProtocol</span><span class="op" id="4582528">)</span><span class="op" id="4582529">;</span>&nbsp;<span class="ident" id="4582531">alpnLen</span>&nbsp;<span class="op" id="4582539">&gt;</span>&nbsp;<span class="num" id="4582541">0</span>&nbsp;<span class="op" id="4582543">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4582547">z</span><span class="op" id="4582548">[</span><span class="num" id="4582549">0</span><span class="op" id="4582550">]</span>&nbsp;<span class="op" id="4582552">=</span>&nbsp;<span class="builtintype" id="4582554">byte</span><span class="op" id="4582558">(</span><span class="ident" id="4582559">extensionALPN</span>&nbsp;<span class="op" id="4582573">&gt;&gt;</span>&nbsp;<span class="num" id="4582576">8</span><span class="op" id="4582577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4582581">z</span><span class="op" id="4582582">[</span><span class="num" id="4582583">1</span><span class="op" id="4582584">]</span>&nbsp;<span class="op" id="4582586">=</span>&nbsp;<span class="builtintype" id="4582588">byte</span><span class="op" id="4582592">(</span><span class="ident" id="4582593">extensionALPN</span>&nbsp;<span class="op" id="4582607">&amp;</span>&nbsp;<span class="num" id="4582609">0xff</span><span class="op" id="4582613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4582617">l</span>&nbsp;<span class="op" id="4582619">:=</span>&nbsp;<span class="num" id="4582622">2</span>&nbsp;<span class="op" id="4582624">+</span>&nbsp;<span class="num" id="4582626">1</span>&nbsp;<span class="op" id="4582628">+</span>&nbsp;<span class="ident" id="4582630">alpnLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4582640">z</span><span class="op" id="4582641">[</span><span class="num" id="4582642">2</span><span class="op" id="4582643">]</span>&nbsp;<span class="op" id="4582645">=</span>&nbsp;<span class="builtintype" id="4582647">byte</span><span class="op" id="4582651">(</span><span class="ident" id="4582652">l</span>&nbsp;<span class="op" id="4582654">&gt;&gt;</span>&nbsp;<span class="num" id="4582657">8</span><span class="op" id="4582658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4582662">z</span><span class="op" id="4582663">[</span><span class="num" id="4582664">3</span><span class="op" id="4582665">]</span>&nbsp;<span class="op" id="4582667">=</span>&nbsp;<span class="builtintype" id="4582669">byte</span><span class="op" id="4582673">(</span><span class="ident" id="4582674">l</span><span class="op" id="4582675">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4582679">l</span>&nbsp;<span class="op" id="4582681">-=</span>&nbsp;<span class="num" id="4582684">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4582688">z</span><span class="op" id="4582689">[</span><span class="num" id="4582690">4</span><span class="op" id="4582691">]</span>&nbsp;<span class="op" id="4582693">=</span>&nbsp;<span class="builtintype" id="4582695">byte</span><span class="op" id="4582699">(</span><span class="ident" id="4582700">l</span>&nbsp;<span class="op" id="4582702">&gt;&gt;</span>&nbsp;<span class="num" id="4582705">8</span><span class="op" id="4582706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4582710">z</span><span class="op" id="4582711">[</span><span class="num" id="4582712">5</span><span class="op" id="4582713">]</span>&nbsp;<span class="op" id="4582715">=</span>&nbsp;<span class="builtintype" id="4582717">byte</span><span class="op" id="4582721">(</span><span class="ident" id="4582722">l</span><span class="op" id="4582723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4582727">l</span>&nbsp;<span class="op" id="4582729">-=</span>&nbsp;<span class="num" id="4582732">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4582736">z</span><span class="op" id="4582737">[</span><span class="num" id="4582738">6</span><span class="op" id="4582739">]</span>&nbsp;<span class="op" id="4582741">=</span>&nbsp;<span class="builtintype" id="4582743">byte</span><span class="op" id="4582747">(</span><span class="ident" id="4582748">l</span><span class="op" id="4582749">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4582753">copy</span><span class="op" id="4582757">(</span><span class="ident" id="4582758">z</span><span class="op" id="4582759">[</span><span class="num" id="4582760">7</span><span class="op" id="4582761">:</span><span class="op" id="4582762">]</span><span class="op" id="4582763">,</span>&nbsp;<span class="op" id="4582765">[</span><span class="op" id="4582766">]</span><span class="builtintype" id="4582767">byte</span><span class="op" id="4582771">(</span><span class="ident" id="4582772">m</span><span class="op" id="4582773">.</span><span class="ident" id="4582774">alpnProtocol</span><span class="op" id="4582786">)</span><span class="op" id="4582787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4582791">z</span>&nbsp;<span class="op" id="4582793">=</span>&nbsp;<span class="ident" id="4582795">z</span><span class="op" id="4582796">[</span><span class="num" id="4582797">7</span><span class="op" id="4582798">+</span><span class="ident" id="4582799">alpnLen</span><span class="op" id="4582806">:</span><span class="op" id="4582807">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4582810">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4582814">m</span><span class="op" id="4582815">.</span><span class="ident" id="4582816">raw</span>&nbsp;<span class="op" id="4582820">=</span>&nbsp;<span class="ident" id="4582822">x</span><br>
<span class="lineno">610</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4582826">return</span>&nbsp;<span class="ident" id="4582833">x</span><br>
<span class="lineno"></span><span class="op" id="4582835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4582838">func</span>&nbsp;<span class="op" id="4582843">(</span><span class="ident" id="4582844">m</span>&nbsp;<span class="op" id="4582846">*</span><span class="ident" id="4582847">serverHelloMsg</span><span class="op" id="4582861">)</span>&nbsp;<span class="ident" id="4582863">unmarshal</span><span class="op" id="4582872">(</span><span class="ident" id="4582873">data</span>&nbsp;<span class="op" id="4582878">[</span><span class="op" id="4582879">]</span><span class="builtintype" id="4582880">byte</span><span class="op" id="4582884">)</span>&nbsp;<span class="builtintype" id="4582886">bool</span>&nbsp;<span class="op" id="4582891">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4582894">if</span>&nbsp;<span class="builtinfunc" id="4582897">len</span><span class="op" id="4582900">(</span><span class="ident" id="4582901">data</span><span class="op" id="4582905">)</span>&nbsp;<span class="op" id="4582907">&lt;</span>&nbsp;<span class="num" id="4582909">42</span>&nbsp;<span class="op" id="4582912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4582916">return</span>&nbsp;<span class="builtintype" id="4582923">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4582930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4582933">m</span><span class="op" id="4582934">.</span><span class="ident" id="4582935">raw</span>&nbsp;<span class="op" id="4582939">=</span>&nbsp;<span class="ident" id="4582941">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4582947">m</span><span class="op" id="4582948">.</span><span class="ident" id="4582949">vers</span>&nbsp;<span class="op" id="4582954">=</span>&nbsp;<span class="builtintype" id="4582956">uint16</span><span class="op" id="4582962">(</span><span class="ident" id="4582963">data</span><span class="op" id="4582967">[</span><span class="num" id="4582968">4</span><span class="op" id="4582969">]</span><span class="op" id="4582970">)</span><span class="op" id="4582971">&lt;&lt;</span><span class="num" id="4582973">8</span>&nbsp;<span class="op" id="4582975">|</span>&nbsp;<span class="builtintype" id="4582977">uint16</span><span class="op" id="4582983">(</span><span class="ident" id="4582984">data</span><span class="op" id="4582988">[</span><span class="num" id="4582989">5</span><span class="op" id="4582990">]</span><span class="op" id="4582991">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4582994">m</span><span class="op" id="4582995">.</span><span class="ident" id="4582996">random</span>&nbsp;<span class="op" id="4583003">=</span>&nbsp;<span class="ident" id="4583005">data</span><span class="op" id="4583009">[</span><span class="num" id="4583010">6</span><span class="op" id="4583011">:</span><span class="num" id="4583012">38</span><span class="op" id="4583014">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4583017">sessionIdLen</span>&nbsp;<span class="op" id="4583030">:=</span>&nbsp;<span class="builtintype" id="4583033">int</span><span class="op" id="4583036">(</span><span class="ident" id="4583037">data</span><span class="op" id="4583041">[</span><span class="num" id="4583042">38</span><span class="op" id="4583044">]</span><span class="op" id="4583045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4583048">if</span>&nbsp;<span class="ident" id="4583051">sessionIdLen</span>&nbsp;<span class="op" id="4583064">&gt;</span>&nbsp;<span class="num" id="4583066">32</span>&nbsp;<span class="op" id="4583069">||</span>&nbsp;<span class="builtinfunc" id="4583072">len</span><span class="op" id="4583075">(</span><span class="ident" id="4583076">data</span><span class="op" id="4583080">)</span>&nbsp;<span class="op" id="4583082">&lt;</span>&nbsp;<span class="num" id="4583084">39</span><span class="op" id="4583086">+</span><span class="ident" id="4583087">sessionIdLen</span>&nbsp;<span class="op" id="4583100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4583104">return</span>&nbsp;<span class="builtintype" id="4583111">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4583118">}</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4583121">m</span><span class="op" id="4583122">.</span><span class="ident" id="4583123">sessionId</span>&nbsp;<span class="op" id="4583133">=</span>&nbsp;<span class="ident" id="4583135">data</span><span class="op" id="4583139">[</span><span class="num" id="4583140">39</span>&nbsp;<span class="op" id="4583143">:</span>&nbsp;<span class="num" id="4583145">39</span><span class="op" id="4583147">+</span><span class="ident" id="4583148">sessionIdLen</span><span class="op" id="4583160">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4583163">data</span>&nbsp;<span class="op" id="4583168">=</span>&nbsp;<span class="ident" id="4583170">data</span><span class="op" id="4583174">[</span><span class="num" id="4583175">39</span><span class="op" id="4583177">+</span><span class="ident" id="4583178">sessionIdLen</span><span class="op" id="4583190">:</span><span class="op" id="4583191">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4583194">if</span>&nbsp;<span class="builtinfunc" id="4583197">len</span><span class="op" id="4583200">(</span><span class="ident" id="4583201">data</span><span class="op" id="4583205">)</span>&nbsp;<span class="op" id="4583207">&lt;</span>&nbsp;<span class="num" id="4583209">3</span>&nbsp;<span class="op" id="4583211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4583215">return</span>&nbsp;<span class="builtintype" id="4583222">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4583229">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4583232">m</span><span class="op" id="4583233">.</span><span class="ident" id="4583234">cipherSuite</span>&nbsp;<span class="op" id="4583246">=</span>&nbsp;<span class="builtintype" id="4583248">uint16</span><span class="op" id="4583254">(</span><span class="ident" id="4583255">data</span><span class="op" id="4583259">[</span><span class="num" id="4583260">0</span><span class="op" id="4583261">]</span><span class="op" id="4583262">)</span><span class="op" id="4583263">&lt;&lt;</span><span class="num" id="4583265">8</span>&nbsp;<span class="op" id="4583267">|</span>&nbsp;<span class="builtintype" id="4583269">uint16</span><span class="op" id="4583275">(</span><span class="ident" id="4583276">data</span><span class="op" id="4583280">[</span><span class="num" id="4583281">1</span><span class="op" id="4583282">]</span><span class="op" id="4583283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4583286">m</span><span class="op" id="4583287">.</span><span class="ident" id="4583288">compressionMethod</span>&nbsp;<span class="op" id="4583306">=</span>&nbsp;<span class="ident" id="4583308">data</span><span class="op" id="4583312">[</span><span class="num" id="4583313">2</span><span class="op" id="4583314">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4583317">data</span>&nbsp;<span class="op" id="4583322">=</span>&nbsp;<span class="ident" id="4583324">data</span><span class="op" id="4583328">[</span><span class="num" id="4583329">3</span><span class="op" id="4583330">:</span><span class="op" id="4583331">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4583335">m</span><span class="op" id="4583336">.</span><span class="ident" id="4583337">nextProtoNeg</span>&nbsp;<span class="op" id="4583350">=</span>&nbsp;<span class="builtintype" id="4583352">false</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4583359">m</span><span class="op" id="4583360">.</span><span class="ident" id="4583361">nextProtos</span>&nbsp;<span class="op" id="4583372">=</span>&nbsp;<span class="ident" id="4583374">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4583379">m</span><span class="op" id="4583380">.</span><span class="ident" id="4583381">ocspStapling</span>&nbsp;<span class="op" id="4583394">=</span>&nbsp;<span class="builtintype" id="4583396">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4583403">m</span><span class="op" id="4583404">.</span><span class="ident" id="4583405">ticketSupported</span>&nbsp;<span class="op" id="4583421">=</span>&nbsp;<span class="builtintype" id="4583423">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4583430">m</span><span class="op" id="4583431">.</span><span class="ident" id="4583432">alpnProtocol</span>&nbsp;<span class="op" id="4583445">=</span>&nbsp;<span class="string" id="4583447">&#34;&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4583452">if</span>&nbsp;<span class="builtinfunc" id="4583455">len</span><span class="op" id="4583458">(</span><span class="ident" id="4583459">data</span><span class="op" id="4583463">)</span>&nbsp;<span class="op" id="4583465">==</span>&nbsp;<span class="num" id="4583468">0</span>&nbsp;<span class="op" id="4583470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4583474">//&nbsp;ServerHello&nbsp;is&nbsp;optionally&nbsp;followed&nbsp;by&nbsp;extension&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4583532">return</span>&nbsp;<span class="builtintype" id="4583539">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4583545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4583548">if</span>&nbsp;<span class="builtinfunc" id="4583551">len</span><span class="op" id="4583554">(</span><span class="ident" id="4583555">data</span><span class="op" id="4583559">)</span>&nbsp;<span class="op" id="4583561">&lt;</span>&nbsp;<span class="num" id="4583563">2</span>&nbsp;<span class="op" id="4583565">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4583569">return</span>&nbsp;<span class="builtintype" id="4583576">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4583583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4583587">extensionsLength</span>&nbsp;<span class="op" id="4583604">:=</span>&nbsp;<span class="builtintype" id="4583607">int</span><span class="op" id="4583610">(</span><span class="ident" id="4583611">data</span><span class="op" id="4583615">[</span><span class="num" id="4583616">0</span><span class="op" id="4583617">]</span><span class="op" id="4583618">)</span><span class="op" id="4583619">&lt;&lt;</span><span class="num" id="4583621">8</span>&nbsp;<span class="op" id="4583623">|</span>&nbsp;<span class="builtintype" id="4583625">int</span><span class="op" id="4583628">(</span><span class="ident" id="4583629">data</span><span class="op" id="4583633">[</span><span class="num" id="4583634">1</span><span class="op" id="4583635">]</span><span class="op" id="4583636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4583639">data</span>&nbsp;<span class="op" id="4583644">=</span>&nbsp;<span class="ident" id="4583646">data</span><span class="op" id="4583650">[</span><span class="num" id="4583651">2</span><span class="op" id="4583652">:</span><span class="op" id="4583653">]</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4583656">if</span>&nbsp;<span class="builtinfunc" id="4583659">len</span><span class="op" id="4583662">(</span><span class="ident" id="4583663">data</span><span class="op" id="4583667">)</span>&nbsp;<span class="op" id="4583669">!=</span>&nbsp;<span class="ident" id="4583672">extensionsLength</span>&nbsp;<span class="op" id="4583689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4583693">return</span>&nbsp;<span class="builtintype" id="4583700">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4583707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4583711">for</span>&nbsp;<span class="builtinfunc" id="4583715">len</span><span class="op" id="4583718">(</span><span class="ident" id="4583719">data</span><span class="op" id="4583723">)</span>&nbsp;<span class="op" id="4583725">!=</span>&nbsp;<span class="num" id="4583728">0</span>&nbsp;<span class="op" id="4583730">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4583734">if</span>&nbsp;<span class="builtinfunc" id="4583737">len</span><span class="op" id="4583740">(</span><span class="ident" id="4583741">data</span><span class="op" id="4583745">)</span>&nbsp;<span class="op" id="4583747">&lt;</span>&nbsp;<span class="num" id="4583749">4</span>&nbsp;<span class="op" id="4583751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4583756">return</span>&nbsp;<span class="builtintype" id="4583763">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4583771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4583775">extension</span>&nbsp;<span class="op" id="4583785">:=</span>&nbsp;<span class="builtintype" id="4583788">uint16</span><span class="op" id="4583794">(</span><span class="ident" id="4583795">data</span><span class="op" id="4583799">[</span><span class="num" id="4583800">0</span><span class="op" id="4583801">]</span><span class="op" id="4583802">)</span><span class="op" id="4583803">&lt;&lt;</span><span class="num" id="4583805">8</span>&nbsp;<span class="op" id="4583807">|</span>&nbsp;<span class="builtintype" id="4583809">uint16</span><span class="op" id="4583815">(</span><span class="ident" id="4583816">data</span><span class="op" id="4583820">[</span><span class="num" id="4583821">1</span><span class="op" id="4583822">]</span><span class="op" id="4583823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4583827">length</span>&nbsp;<span class="op" id="4583834">:=</span>&nbsp;<span class="builtintype" id="4583837">int</span><span class="op" id="4583840">(</span><span class="ident" id="4583841">data</span><span class="op" id="4583845">[</span><span class="num" id="4583846">2</span><span class="op" id="4583847">]</span><span class="op" id="4583848">)</span><span class="op" id="4583849">&lt;&lt;</span><span class="num" id="4583851">8</span>&nbsp;<span class="op" id="4583853">|</span>&nbsp;<span class="builtintype" id="4583855">int</span><span class="op" id="4583858">(</span><span class="ident" id="4583859">data</span><span class="op" id="4583863">[</span><span class="num" id="4583864">3</span><span class="op" id="4583865">]</span><span class="op" id="4583866">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4583870">data</span>&nbsp;<span class="op" id="4583875">=</span>&nbsp;<span class="ident" id="4583877">data</span><span class="op" id="4583881">[</span><span class="num" id="4583882">4</span><span class="op" id="4583883">:</span><span class="op" id="4583884">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4583888">if</span>&nbsp;<span class="builtinfunc" id="4583891">len</span><span class="op" id="4583894">(</span><span class="ident" id="4583895">data</span><span class="op" id="4583899">)</span>&nbsp;<span class="op" id="4583901">&lt;</span>&nbsp;<span class="ident" id="4583903">length</span>&nbsp;<span class="op" id="4583910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4583915">return</span>&nbsp;<span class="builtintype" id="4583922">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4583930">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4583935">switch</span>&nbsp;<span class="ident" id="4583942">extension</span>&nbsp;<span class="op" id="4583952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4583956">case</span>&nbsp;<span class="ident" id="4583961">extensionNextProtoNeg</span><span class="op" id="4583982">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4583987">m</span><span class="op" id="4583988">.</span><span class="ident" id="4583989">nextProtoNeg</span>&nbsp;<span class="op" id="4584002">=</span>&nbsp;<span class="builtintype" id="4584004">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4584012">d</span>&nbsp;<span class="op" id="4584014">:=</span>&nbsp;<span class="ident" id="4584017">data</span><span class="op" id="4584021">[</span><span class="op" id="4584022">:</span><span class="ident" id="4584023">length</span><span class="op" id="4584029">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4584034">for</span>&nbsp;<span class="builtinfunc" id="4584038">len</span><span class="op" id="4584041">(</span><span class="ident" id="4584042">d</span><span class="op" id="4584043">)</span>&nbsp;<span class="op" id="4584045">&gt;</span>&nbsp;<span class="num" id="4584047">0</span>&nbsp;<span class="op" id="4584049">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4584055">l</span>&nbsp;<span class="op" id="4584057">:=</span>&nbsp;<span class="builtintype" id="4584060">int</span><span class="op" id="4584063">(</span><span class="ident" id="4584064">d</span><span class="op" id="4584065">[</span><span class="num" id="4584066">0</span><span class="op" id="4584067">]</span><span class="op" id="4584068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4584074">d</span>&nbsp;<span class="op" id="4584076">=</span>&nbsp;<span class="ident" id="4584078">d</span><span class="op" id="4584079">[</span><span class="num" id="4584080">1</span><span class="op" id="4584081">:</span><span class="op" id="4584082">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4584088">if</span>&nbsp;<span class="ident" id="4584091">l</span>&nbsp;<span class="op" id="4584093">==</span>&nbsp;<span class="num" id="4584096">0</span>&nbsp;<span class="op" id="4584098">||</span>&nbsp;<span class="ident" id="4584101">l</span>&nbsp;<span class="op" id="4584103">&gt;</span>&nbsp;<span class="builtinfunc" id="4584105">len</span><span class="op" id="4584108">(</span><span class="ident" id="4584109">d</span><span class="op" id="4584110">)</span>&nbsp;<span class="op" id="4584112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4584119">return</span>&nbsp;<span class="builtintype" id="4584126">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4584136">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4584142">m</span><span class="op" id="4584143">.</span><span class="ident" id="4584144">nextProtos</span>&nbsp;<span class="op" id="4584155">=</span>&nbsp;<span class="builtinfunc" id="4584157">append</span><span class="op" id="4584163">(</span><span class="ident" id="4584164">m</span><span class="op" id="4584165">.</span><span class="ident" id="4584166">nextProtos</span><span class="op" id="4584176">,</span>&nbsp;<span class="builtintype" id="4584178">string</span><span class="op" id="4584184">(</span><span class="ident" id="4584185">d</span><span class="op" id="4584186">[</span><span class="op" id="4584187">:</span><span class="ident" id="4584188">l</span><span class="op" id="4584189">]</span><span class="op" id="4584190">)</span><span class="op" id="4584191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4584197">d</span>&nbsp;<span class="op" id="4584199">=</span>&nbsp;<span class="ident" id="4584201">d</span><span class="op" id="4584202">[</span><span class="ident" id="4584203">l</span><span class="op" id="4584204">:</span><span class="op" id="4584205">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4584210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4584214">case</span>&nbsp;<span class="ident" id="4584219">extensionStatusRequest</span><span class="op" id="4584241">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4584246">if</span>&nbsp;<span class="ident" id="4584249">length</span>&nbsp;<span class="op" id="4584256">&gt;</span>&nbsp;<span class="num" id="4584258">0</span>&nbsp;<span class="op" id="4584260">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4584266">return</span>&nbsp;<span class="builtintype" id="4584273">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4584282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4584287">m</span><span class="op" id="4584288">.</span><span class="ident" id="4584289">ocspStapling</span>&nbsp;<span class="op" id="4584302">=</span>&nbsp;<span class="builtintype" id="4584304">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4584311">case</span>&nbsp;<span class="ident" id="4584316">extensionSessionTicket</span><span class="op" id="4584338">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4584343">if</span>&nbsp;<span class="ident" id="4584346">length</span>&nbsp;<span class="op" id="4584353">&gt;</span>&nbsp;<span class="num" id="4584355">0</span>&nbsp;<span class="op" id="4584357">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4584363">return</span>&nbsp;<span class="builtintype" id="4584370">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4584379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4584384">m</span><span class="op" id="4584385">.</span><span class="ident" id="4584386">ticketSupported</span>&nbsp;<span class="op" id="4584402">=</span>&nbsp;<span class="builtintype" id="4584404">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4584411">case</span>&nbsp;<span class="ident" id="4584416">extensionRenegotiationInfo</span><span class="op" id="4584442">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4584447">if</span>&nbsp;<span class="ident" id="4584450">length</span>&nbsp;<span class="op" id="4584457">!=</span>&nbsp;<span class="num" id="4584460">1</span>&nbsp;<span class="op" id="4584462">||</span>&nbsp;<span class="ident" id="4584465">data</span><span class="op" id="4584469">[</span><span class="num" id="4584470">0</span><span class="op" id="4584471">]</span>&nbsp;<span class="op" id="4584473">!=</span>&nbsp;<span class="num" id="4584476">0</span>&nbsp;<span class="op" id="4584478">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4584484">return</span>&nbsp;<span class="builtintype" id="4584491">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4584500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4584505">m</span><span class="op" id="4584506">.</span><span class="ident" id="4584507">secureRenegotiation</span>&nbsp;<span class="op" id="4584527">=</span>&nbsp;<span class="builtintype" id="4584529">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4584536">case</span>&nbsp;<span class="ident" id="4584541">extensionALPN</span><span class="op" id="4584554">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4584559">d</span>&nbsp;<span class="op" id="4584561">:=</span>&nbsp;<span class="ident" id="4584564">data</span><span class="op" id="4584568">[</span><span class="op" id="4584569">:</span><span class="ident" id="4584570">length</span><span class="op" id="4584576">]</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4584581">if</span>&nbsp;<span class="builtinfunc" id="4584584">len</span><span class="op" id="4584587">(</span><span class="ident" id="4584588">d</span><span class="op" id="4584589">)</span>&nbsp;<span class="op" id="4584591">&lt;</span>&nbsp;<span class="num" id="4584593">3</span>&nbsp;<span class="op" id="4584595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4584601">return</span>&nbsp;<span class="builtintype" id="4584608">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4584617">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4584622">l</span>&nbsp;<span class="op" id="4584624">:=</span>&nbsp;<span class="builtintype" id="4584627">int</span><span class="op" id="4584630">(</span><span class="ident" id="4584631">d</span><span class="op" id="4584632">[</span><span class="num" id="4584633">0</span><span class="op" id="4584634">]</span><span class="op" id="4584635">)</span><span class="op" id="4584636">&lt;&lt;</span><span class="num" id="4584638">8</span>&nbsp;<span class="op" id="4584640">|</span>&nbsp;<span class="builtintype" id="4584642">int</span><span class="op" id="4584645">(</span><span class="ident" id="4584646">d</span><span class="op" id="4584647">[</span><span class="num" id="4584648">1</span><span class="op" id="4584649">]</span><span class="op" id="4584650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4584655">if</span>&nbsp;<span class="ident" id="4584658">l</span>&nbsp;<span class="op" id="4584660">!=</span>&nbsp;<span class="builtinfunc" id="4584663">len</span><span class="op" id="4584666">(</span><span class="ident" id="4584667">d</span><span class="op" id="4584668">)</span><span class="op" id="4584669">-</span><span class="num" id="4584670">2</span>&nbsp;<span class="op" id="4584672">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4584678">return</span>&nbsp;<span class="builtintype" id="4584685">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4584694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4584699">d</span>&nbsp;<span class="op" id="4584701">=</span>&nbsp;<span class="ident" id="4584703">d</span><span class="op" id="4584704">[</span><span class="num" id="4584705">2</span><span class="op" id="4584706">:</span><span class="op" id="4584707">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4584712">l</span>&nbsp;<span class="op" id="4584714">=</span>&nbsp;<span class="builtintype" id="4584716">int</span><span class="op" id="4584719">(</span><span class="ident" id="4584720">d</span><span class="op" id="4584721">[</span><span class="num" id="4584722">0</span><span class="op" id="4584723">]</span><span class="op" id="4584724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4584729">if</span>&nbsp;<span class="ident" id="4584732">l</span>&nbsp;<span class="op" id="4584734">!=</span>&nbsp;<span class="builtinfunc" id="4584737">len</span><span class="op" id="4584740">(</span><span class="ident" id="4584741">d</span><span class="op" id="4584742">)</span><span class="op" id="4584743">-</span><span class="num" id="4584744">1</span>&nbsp;<span class="op" id="4584746">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4584752">return</span>&nbsp;<span class="builtintype" id="4584759">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4584768">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4584773">d</span>&nbsp;<span class="op" id="4584775">=</span>&nbsp;<span class="ident" id="4584777">d</span><span class="op" id="4584778">[</span><span class="num" id="4584779">1</span><span class="op" id="4584780">:</span><span class="op" id="4584781">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4584786">m</span><span class="op" id="4584787">.</span><span class="ident" id="4584788">alpnProtocol</span>&nbsp;<span class="op" id="4584801">=</span>&nbsp;<span class="builtintype" id="4584803">string</span><span class="op" id="4584809">(</span><span class="ident" id="4584810">d</span><span class="op" id="4584811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4584815">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4584819">data</span>&nbsp;<span class="op" id="4584824">=</span>&nbsp;<span class="ident" id="4584826">data</span><span class="op" id="4584830">[</span><span class="ident" id="4584831">length</span><span class="op" id="4584837">:</span><span class="op" id="4584838">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4584841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4584845">return</span>&nbsp;<span class="builtintype" id="4584852">true</span><br>
<span class="lineno"></span><span class="op" id="4584857">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="4584860">type</span>&nbsp;<span class="ident" id="4584865">certificateMsg</span>&nbsp;<span class="keyword" id="4584880">struct</span>&nbsp;<span class="op" id="4584887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4584890">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4584903">[</span><span class="op" id="4584904">]</span><span class="builtintype" id="4584905">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4584911">certificates</span>&nbsp;<span class="op" id="4584924">[</span><span class="op" id="4584925">]</span><span class="op" id="4584926">[</span><span class="op" id="4584927">]</span><span class="builtintype" id="4584928">byte</span><br>
<span class="lineno"></span><span class="op" id="4584933">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="4584936">func</span>&nbsp;<span class="op" id="4584941">(</span><span class="ident" id="4584942">m</span>&nbsp;<span class="op" id="4584944">*</span><span class="ident" id="4584945">certificateMsg</span><span class="op" id="4584959">)</span>&nbsp;<span class="ident" id="4584961">equal</span><span class="op" id="4584966">(</span><span class="ident" id="4584967">i</span>&nbsp;<span class="keyword" id="4584969">interface</span><span class="op" id="4584978">{</span><span class="op" id="4584979">}</span><span class="op" id="4584980">)</span>&nbsp;<span class="builtintype" id="4584982">bool</span>&nbsp;<span class="op" id="4584987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4584990">m1</span><span class="op" id="4584992">,</span>&nbsp;<span class="ident" id="4584994">ok</span>&nbsp;<span class="op" id="4584997">:=</span>&nbsp;<span class="ident" id="4585000">i</span><span class="op" id="4585001">.</span><span class="op" id="4585002">(</span><span class="op" id="4585003">*</span><span class="ident" id="4585004">certificateMsg</span><span class="op" id="4585018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4585021">if</span>&nbsp;<span class="op" id="4585024">!</span><span class="ident" id="4585025">ok</span>&nbsp;<span class="op" id="4585028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4585032">return</span>&nbsp;<span class="builtintype" id="4585039">false</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4585046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4585050">return</span>&nbsp;<span class="ident" id="4585057">bytes</span><span class="op" id="4585062">.</span><span class="ident" id="4585063">Equal</span><span class="op" id="4585068">(</span><span class="ident" id="4585069">m</span><span class="op" id="4585070">.</span><span class="ident" id="4585071">raw</span><span class="op" id="4585074">,</span>&nbsp;<span class="ident" id="4585076">m1</span><span class="op" id="4585078">.</span><span class="ident" id="4585079">raw</span><span class="op" id="4585082">)</span>&nbsp;<span class="op" id="4585084">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4585089">eqByteSlices</span><span class="op" id="4585101">(</span><span class="ident" id="4585102">m</span><span class="op" id="4585103">.</span><span class="ident" id="4585104">certificates</span><span class="op" id="4585116">,</span>&nbsp;<span class="ident" id="4585118">m1</span><span class="op" id="4585120">.</span><span class="ident" id="4585121">certificates</span><span class="op" id="4585133">)</span><br>
<span class="lineno"></span><span class="op" id="4585135">}</span><br>
<span class="lineno">730</span><br>
<span class="lineno"></span><span class="keyword" id="4585138">func</span>&nbsp;<span class="op" id="4585143">(</span><span class="ident" id="4585144">m</span>&nbsp;<span class="op" id="4585146">*</span><span class="ident" id="4585147">certificateMsg</span><span class="op" id="4585161">)</span>&nbsp;<span class="ident" id="4585163">marshal</span><span class="op" id="4585170">(</span><span class="op" id="4585171">)</span>&nbsp;<span class="op" id="4585173">(</span><span class="ident" id="4585174">x</span>&nbsp;<span class="op" id="4585176">[</span><span class="op" id="4585177">]</span><span class="builtintype" id="4585178">byte</span><span class="op" id="4585182">)</span>&nbsp;<span class="op" id="4585184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4585187">if</span>&nbsp;<span class="ident" id="4585190">m</span><span class="op" id="4585191">.</span><span class="ident" id="4585192">raw</span>&nbsp;<span class="op" id="4585196">!=</span>&nbsp;<span class="ident" id="4585199">nil</span>&nbsp;<span class="op" id="4585203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4585207">return</span>&nbsp;<span class="ident" id="4585214">m</span><span class="op" id="4585215">.</span><span class="ident" id="4585216">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4585221">}</span><br>
<span class="lineno">735</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4585225">var</span>&nbsp;<span class="ident" id="4585229">i</span>&nbsp;<span class="builtintype" id="4585231">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4585236">for</span>&nbsp;<span class="ident" id="4585240">_</span><span class="op" id="4585241">,</span>&nbsp;<span class="ident" id="4585243">slice</span>&nbsp;<span class="op" id="4585249">:=</span>&nbsp;<span class="keyword" id="4585252">range</span>&nbsp;<span class="ident" id="4585258">m</span><span class="op" id="4585259">.</span><span class="ident" id="4585260">certificates</span>&nbsp;<span class="op" id="4585273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4585277">i</span>&nbsp;<span class="op" id="4585279">+=</span>&nbsp;<span class="builtinfunc" id="4585282">len</span><span class="op" id="4585285">(</span><span class="ident" id="4585286">slice</span><span class="op" id="4585291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4585294">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4585298">length</span>&nbsp;<span class="op" id="4585305">:=</span>&nbsp;<span class="num" id="4585308">3</span>&nbsp;<span class="op" id="4585310">+</span>&nbsp;<span class="num" id="4585312">3</span><span class="op" id="4585313">*</span><span class="builtinfunc" id="4585314">len</span><span class="op" id="4585317">(</span><span class="ident" id="4585318">m</span><span class="op" id="4585319">.</span><span class="ident" id="4585320">certificates</span><span class="op" id="4585332">)</span>&nbsp;<span class="op" id="4585334">+</span>&nbsp;<span class="ident" id="4585336">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4585339">x</span>&nbsp;<span class="op" id="4585341">=</span>&nbsp;<span class="builtinfunc" id="4585343">make</span><span class="op" id="4585347">(</span><span class="op" id="4585348">[</span><span class="op" id="4585349">]</span><span class="builtintype" id="4585350">byte</span><span class="op" id="4585354">,</span>&nbsp;<span class="num" id="4585356">4</span><span class="op" id="4585357">+</span><span class="ident" id="4585358">length</span><span class="op" id="4585364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4585367">x</span><span class="op" id="4585368">[</span><span class="num" id="4585369">0</span><span class="op" id="4585370">]</span>&nbsp;<span class="op" id="4585372">=</span>&nbsp;<span class="ident" id="4585374">typeCertificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4585391">x</span><span class="op" id="4585392">[</span><span class="num" id="4585393">1</span><span class="op" id="4585394">]</span>&nbsp;<span class="op" id="4585396">=</span>&nbsp;<span class="builtintype" id="4585398">uint8</span><span class="op" id="4585403">(</span><span class="ident" id="4585404">length</span>&nbsp;<span class="op" id="4585411">&gt;&gt;</span>&nbsp;<span class="num" id="4585414">16</span><span class="op" id="4585416">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4585419">x</span><span class="op" id="4585420">[</span><span class="num" id="4585421">2</span><span class="op" id="4585422">]</span>&nbsp;<span class="op" id="4585424">=</span>&nbsp;<span class="builtintype" id="4585426">uint8</span><span class="op" id="4585431">(</span><span class="ident" id="4585432">length</span>&nbsp;<span class="op" id="4585439">&gt;&gt;</span>&nbsp;<span class="num" id="4585442">8</span><span class="op" id="4585443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4585446">x</span><span class="op" id="4585447">[</span><span class="num" id="4585448">3</span><span class="op" id="4585449">]</span>&nbsp;<span class="op" id="4585451">=</span>&nbsp;<span class="builtintype" id="4585453">uint8</span><span class="op" id="4585458">(</span><span class="ident" id="4585459">length</span><span class="op" id="4585465">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4585469">certificateOctets</span>&nbsp;<span class="op" id="4585487">:=</span>&nbsp;<span class="ident" id="4585490">length</span>&nbsp;<span class="op" id="4585497">-</span>&nbsp;<span class="num" id="4585499">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4585502">x</span><span class="op" id="4585503">[</span><span class="num" id="4585504">4</span><span class="op" id="4585505">]</span>&nbsp;<span class="op" id="4585507">=</span>&nbsp;<span class="builtintype" id="4585509">uint8</span><span class="op" id="4585514">(</span><span class="ident" id="4585515">certificateOctets</span>&nbsp;<span class="op" id="4585533">&gt;&gt;</span>&nbsp;<span class="num" id="4585536">16</span><span class="op" id="4585538">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4585541">x</span><span class="op" id="4585542">[</span><span class="num" id="4585543">5</span><span class="op" id="4585544">]</span>&nbsp;<span class="op" id="4585546">=</span>&nbsp;<span class="builtintype" id="4585548">uint8</span><span class="op" id="4585553">(</span><span class="ident" id="4585554">certificateOctets</span>&nbsp;<span class="op" id="4585572">&gt;&gt;</span>&nbsp;<span class="num" id="4585575">8</span><span class="op" id="4585576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4585579">x</span><span class="op" id="4585580">[</span><span class="num" id="4585581">6</span><span class="op" id="4585582">]</span>&nbsp;<span class="op" id="4585584">=</span>&nbsp;<span class="builtintype" id="4585586">uint8</span><span class="op" id="4585591">(</span><span class="ident" id="4585592">certificateOctets</span><span class="op" id="4585609">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4585613">y</span>&nbsp;<span class="op" id="4585615">:=</span>&nbsp;<span class="ident" id="4585618">x</span><span class="op" id="4585619">[</span><span class="num" id="4585620">7</span><span class="op" id="4585621">:</span><span class="op" id="4585622">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4585625">for</span>&nbsp;<span class="ident" id="4585629">_</span><span class="op" id="4585630">,</span>&nbsp;<span class="ident" id="4585632">slice</span>&nbsp;<span class="op" id="4585638">:=</span>&nbsp;<span class="keyword" id="4585641">range</span>&nbsp;<span class="ident" id="4585647">m</span><span class="op" id="4585648">.</span><span class="ident" id="4585649">certificates</span>&nbsp;<span class="op" id="4585662">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4585666">y</span><span class="op" id="4585667">[</span><span class="num" id="4585668">0</span><span class="op" id="4585669">]</span>&nbsp;<span class="op" id="4585671">=</span>&nbsp;<span class="builtintype" id="4585673">uint8</span><span class="op" id="4585678">(</span><span class="builtinfunc" id="4585679">len</span><span class="op" id="4585682">(</span><span class="ident" id="4585683">slice</span><span class="op" id="4585688">)</span>&nbsp;<span class="op" id="4585690">&gt;&gt;</span>&nbsp;<span class="num" id="4585693">16</span><span class="op" id="4585695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4585699">y</span><span class="op" id="4585700">[</span><span class="num" id="4585701">1</span><span class="op" id="4585702">]</span>&nbsp;<span class="op" id="4585704">=</span>&nbsp;<span class="builtintype" id="4585706">uint8</span><span class="op" id="4585711">(</span><span class="builtinfunc" id="4585712">len</span><span class="op" id="4585715">(</span><span class="ident" id="4585716">slice</span><span class="op" id="4585721">)</span>&nbsp;<span class="op" id="4585723">&gt;&gt;</span>&nbsp;<span class="num" id="4585726">8</span><span class="op" id="4585727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4585731">y</span><span class="op" id="4585732">[</span><span class="num" id="4585733">2</span><span class="op" id="4585734">]</span>&nbsp;<span class="op" id="4585736">=</span>&nbsp;<span class="builtintype" id="4585738">uint8</span><span class="op" id="4585743">(</span><span class="builtinfunc" id="4585744">len</span><span class="op" id="4585747">(</span><span class="ident" id="4585748">slice</span><span class="op" id="4585753">)</span><span class="op" id="4585754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4585758">copy</span><span class="op" id="4585762">(</span><span class="ident" id="4585763">y</span><span class="op" id="4585764">[</span><span class="num" id="4585765">3</span><span class="op" id="4585766">:</span><span class="op" id="4585767">]</span><span class="op" id="4585768">,</span>&nbsp;<span class="ident" id="4585770">slice</span><span class="op" id="4585775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4585779">y</span>&nbsp;<span class="op" id="4585781">=</span>&nbsp;<span class="ident" id="4585783">y</span><span class="op" id="4585784">[</span><span class="num" id="4585785">3</span><span class="op" id="4585786">+</span><span class="builtinfunc" id="4585787">len</span><span class="op" id="4585790">(</span><span class="ident" id="4585791">slice</span><span class="op" id="4585796">)</span><span class="op" id="4585797">:</span><span class="op" id="4585798">]</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4585801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4585805">m</span><span class="op" id="4585806">.</span><span class="ident" id="4585807">raw</span>&nbsp;<span class="op" id="4585811">=</span>&nbsp;<span class="ident" id="4585813">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4585816">return</span><br>
<span class="lineno"></span><span class="op" id="4585823">}</span><br>
<span class="lineno">765</span><br>
<span class="lineno"></span><span class="keyword" id="4585826">func</span>&nbsp;<span class="op" id="4585831">(</span><span class="ident" id="4585832">m</span>&nbsp;<span class="op" id="4585834">*</span><span class="ident" id="4585835">certificateMsg</span><span class="op" id="4585849">)</span>&nbsp;<span class="ident" id="4585851">unmarshal</span><span class="op" id="4585860">(</span><span class="ident" id="4585861">data</span>&nbsp;<span class="op" id="4585866">[</span><span class="op" id="4585867">]</span><span class="builtintype" id="4585868">byte</span><span class="op" id="4585872">)</span>&nbsp;<span class="builtintype" id="4585874">bool</span>&nbsp;<span class="op" id="4585879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4585882">if</span>&nbsp;<span class="builtinfunc" id="4585885">len</span><span class="op" id="4585888">(</span><span class="ident" id="4585889">data</span><span class="op" id="4585893">)</span>&nbsp;<span class="op" id="4585895">&lt;</span>&nbsp;<span class="num" id="4585897">7</span>&nbsp;<span class="op" id="4585899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4585903">return</span>&nbsp;<span class="builtintype" id="4585910">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4585917">}</span><br>
<span class="lineno">770</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4585921">m</span><span class="op" id="4585922">.</span><span class="ident" id="4585923">raw</span>&nbsp;<span class="op" id="4585927">=</span>&nbsp;<span class="ident" id="4585929">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4585935">certsLen</span>&nbsp;<span class="op" id="4585944">:=</span>&nbsp;<span class="builtintype" id="4585947">uint32</span><span class="op" id="4585953">(</span><span class="ident" id="4585954">data</span><span class="op" id="4585958">[</span><span class="num" id="4585959">4</span><span class="op" id="4585960">]</span><span class="op" id="4585961">)</span><span class="op" id="4585962">&lt;&lt;</span><span class="num" id="4585964">16</span>&nbsp;<span class="op" id="4585967">|</span>&nbsp;<span class="builtintype" id="4585969">uint32</span><span class="op" id="4585975">(</span><span class="ident" id="4585976">data</span><span class="op" id="4585980">[</span><span class="num" id="4585981">5</span><span class="op" id="4585982">]</span><span class="op" id="4585983">)</span><span class="op" id="4585984">&lt;&lt;</span><span class="num" id="4585986">8</span>&nbsp;<span class="op" id="4585988">|</span>&nbsp;<span class="builtintype" id="4585990">uint32</span><span class="op" id="4585996">(</span><span class="ident" id="4585997">data</span><span class="op" id="4586001">[</span><span class="num" id="4586002">6</span><span class="op" id="4586003">]</span><span class="op" id="4586004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4586007">if</span>&nbsp;<span class="builtintype" id="4586010">uint32</span><span class="op" id="4586016">(</span><span class="builtinfunc" id="4586017">len</span><span class="op" id="4586020">(</span><span class="ident" id="4586021">data</span><span class="op" id="4586025">)</span><span class="op" id="4586026">)</span>&nbsp;<span class="op" id="4586028">!=</span>&nbsp;<span class="ident" id="4586031">certsLen</span><span class="op" id="4586039">+</span><span class="num" id="4586040">7</span>&nbsp;<span class="op" id="4586042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4586046">return</span>&nbsp;<span class="builtintype" id="4586053">false</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4586060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4586064">numCerts</span>&nbsp;<span class="op" id="4586073">:=</span>&nbsp;<span class="num" id="4586076">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4586079">d</span>&nbsp;<span class="op" id="4586081">:=</span>&nbsp;<span class="ident" id="4586084">data</span><span class="op" id="4586088">[</span><span class="num" id="4586089">7</span><span class="op" id="4586090">:</span><span class="op" id="4586091">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4586094">for</span>&nbsp;<span class="ident" id="4586098">certsLen</span>&nbsp;<span class="op" id="4586107">&gt;</span>&nbsp;<span class="num" id="4586109">0</span>&nbsp;<span class="op" id="4586111">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4586115">if</span>&nbsp;<span class="builtinfunc" id="4586118">len</span><span class="op" id="4586121">(</span><span class="ident" id="4586122">d</span><span class="op" id="4586123">)</span>&nbsp;<span class="op" id="4586125">&lt;</span>&nbsp;<span class="num" id="4586127">4</span>&nbsp;<span class="op" id="4586129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4586134">return</span>&nbsp;<span class="builtintype" id="4586141">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4586149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4586153">certLen</span>&nbsp;<span class="op" id="4586161">:=</span>&nbsp;<span class="builtintype" id="4586164">uint32</span><span class="op" id="4586170">(</span><span class="ident" id="4586171">d</span><span class="op" id="4586172">[</span><span class="num" id="4586173">0</span><span class="op" id="4586174">]</span><span class="op" id="4586175">)</span><span class="op" id="4586176">&lt;&lt;</span><span class="num" id="4586178">16</span>&nbsp;<span class="op" id="4586181">|</span>&nbsp;<span class="builtintype" id="4586183">uint32</span><span class="op" id="4586189">(</span><span class="ident" id="4586190">d</span><span class="op" id="4586191">[</span><span class="num" id="4586192">1</span><span class="op" id="4586193">]</span><span class="op" id="4586194">)</span><span class="op" id="4586195">&lt;&lt;</span><span class="num" id="4586197">8</span>&nbsp;<span class="op" id="4586199">|</span>&nbsp;<span class="builtintype" id="4586201">uint32</span><span class="op" id="4586207">(</span><span class="ident" id="4586208">d</span><span class="op" id="4586209">[</span><span class="num" id="4586210">2</span><span class="op" id="4586211">]</span><span class="op" id="4586212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4586216">if</span>&nbsp;<span class="builtintype" id="4586219">uint32</span><span class="op" id="4586225">(</span><span class="builtinfunc" id="4586226">len</span><span class="op" id="4586229">(</span><span class="ident" id="4586230">d</span><span class="op" id="4586231">)</span><span class="op" id="4586232">)</span>&nbsp;<span class="op" id="4586234">&lt;</span>&nbsp;<span class="num" id="4586236">3</span><span class="op" id="4586237">+</span><span class="ident" id="4586238">certLen</span>&nbsp;<span class="op" id="4586246">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4586251">return</span>&nbsp;<span class="builtintype" id="4586258">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4586266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4586270">d</span>&nbsp;<span class="op" id="4586272">=</span>&nbsp;<span class="ident" id="4586274">d</span><span class="op" id="4586275">[</span><span class="num" id="4586276">3</span><span class="op" id="4586277">+</span><span class="ident" id="4586278">certLen</span><span class="op" id="4586285">:</span><span class="op" id="4586286">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4586290">certsLen</span>&nbsp;<span class="op" id="4586299">-=</span>&nbsp;<span class="num" id="4586302">3</span>&nbsp;<span class="op" id="4586304">+</span>&nbsp;<span class="ident" id="4586306">certLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4586316">numCerts</span><span class="op" id="4586324">++</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4586328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4586332">m</span><span class="op" id="4586333">.</span><span class="ident" id="4586334">certificates</span>&nbsp;<span class="op" id="4586347">=</span>&nbsp;<span class="builtinfunc" id="4586349">make</span><span class="op" id="4586353">(</span><span class="op" id="4586354">[</span><span class="op" id="4586355">]</span><span class="op" id="4586356">[</span><span class="op" id="4586357">]</span><span class="builtintype" id="4586358">byte</span><span class="op" id="4586362">,</span>&nbsp;<span class="ident" id="4586364">numCerts</span><span class="op" id="4586372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4586375">d</span>&nbsp;<span class="op" id="4586377">=</span>&nbsp;<span class="ident" id="4586379">data</span><span class="op" id="4586383">[</span><span class="num" id="4586384">7</span><span class="op" id="4586385">:</span><span class="op" id="4586386">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4586389">for</span>&nbsp;<span class="ident" id="4586393">i</span>&nbsp;<span class="op" id="4586395">:=</span>&nbsp;<span class="num" id="4586398">0</span><span class="op" id="4586399">;</span>&nbsp;<span class="ident" id="4586401">i</span>&nbsp;<span class="op" id="4586403">&lt;</span>&nbsp;<span class="ident" id="4586405">numCerts</span><span class="op" id="4586413">;</span>&nbsp;<span class="ident" id="4586415">i</span><span class="op" id="4586416">++</span>&nbsp;<span class="op" id="4586419">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4586423">certLen</span>&nbsp;<span class="op" id="4586431">:=</span>&nbsp;<span class="builtintype" id="4586434">uint32</span><span class="op" id="4586440">(</span><span class="ident" id="4586441">d</span><span class="op" id="4586442">[</span><span class="num" id="4586443">0</span><span class="op" id="4586444">]</span><span class="op" id="4586445">)</span><span class="op" id="4586446">&lt;&lt;</span><span class="num" id="4586448">16</span>&nbsp;<span class="op" id="4586451">|</span>&nbsp;<span class="builtintype" id="4586453">uint32</span><span class="op" id="4586459">(</span><span class="ident" id="4586460">d</span><span class="op" id="4586461">[</span><span class="num" id="4586462">1</span><span class="op" id="4586463">]</span><span class="op" id="4586464">)</span><span class="op" id="4586465">&lt;&lt;</span><span class="num" id="4586467">8</span>&nbsp;<span class="op" id="4586469">|</span>&nbsp;<span class="builtintype" id="4586471">uint32</span><span class="op" id="4586477">(</span><span class="ident" id="4586478">d</span><span class="op" id="4586479">[</span><span class="num" id="4586480">2</span><span class="op" id="4586481">]</span><span class="op" id="4586482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4586486">m</span><span class="op" id="4586487">.</span><span class="ident" id="4586488">certificates</span><span class="op" id="4586500">[</span><span class="ident" id="4586501">i</span><span class="op" id="4586502">]</span>&nbsp;<span class="op" id="4586504">=</span>&nbsp;<span class="ident" id="4586506">d</span><span class="op" id="4586507">[</span><span class="num" id="4586508">3</span>&nbsp;<span class="op" id="4586510">:</span>&nbsp;<span class="num" id="4586512">3</span><span class="op" id="4586513">+</span><span class="ident" id="4586514">certLen</span><span class="op" id="4586521">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4586525">d</span>&nbsp;<span class="op" id="4586527">=</span>&nbsp;<span class="ident" id="4586529">d</span><span class="op" id="4586530">[</span><span class="num" id="4586531">3</span><span class="op" id="4586532">+</span><span class="ident" id="4586533">certLen</span><span class="op" id="4586540">:</span><span class="op" id="4586541">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4586544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4586548">return</span>&nbsp;<span class="builtintype" id="4586555">true</span><br>
<span class="lineno"></span><span class="op" id="4586560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4586563">type</span>&nbsp;<span class="ident" id="4586568">serverKeyExchangeMsg</span>&nbsp;<span class="keyword" id="4586589">struct</span>&nbsp;<span class="op" id="4586596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4586599">raw</span>&nbsp;<span class="op" id="4586603">[</span><span class="op" id="4586604">]</span><span class="builtintype" id="4586605">byte</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4586611">key</span>&nbsp;<span class="op" id="4586615">[</span><span class="op" id="4586616">]</span><span class="builtintype" id="4586617">byte</span><br>
<span class="lineno"></span><span class="op" id="4586622">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4586625">func</span>&nbsp;<span class="op" id="4586630">(</span><span class="ident" id="4586631">m</span>&nbsp;<span class="op" id="4586633">*</span><span class="ident" id="4586634">serverKeyExchangeMsg</span><span class="op" id="4586654">)</span>&nbsp;<span class="ident" id="4586656">equal</span><span class="op" id="4586661">(</span><span class="ident" id="4586662">i</span>&nbsp;<span class="keyword" id="4586664">interface</span><span class="op" id="4586673">{</span><span class="op" id="4586674">}</span><span class="op" id="4586675">)</span>&nbsp;<span class="builtintype" id="4586677">bool</span>&nbsp;<span class="op" id="4586682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4586685">m1</span><span class="op" id="4586687">,</span>&nbsp;<span class="ident" id="4586689">ok</span>&nbsp;<span class="op" id="4586692">:=</span>&nbsp;<span class="ident" id="4586695">i</span><span class="op" id="4586696">.</span><span class="op" id="4586697">(</span><span class="op" id="4586698">*</span><span class="ident" id="4586699">serverKeyExchangeMsg</span><span class="op" id="4586719">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4586722">if</span>&nbsp;<span class="op" id="4586725">!</span><span class="ident" id="4586726">ok</span>&nbsp;<span class="op" id="4586729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4586733">return</span>&nbsp;<span class="builtintype" id="4586740">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4586747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4586751">return</span>&nbsp;<span class="ident" id="4586758">bytes</span><span class="op" id="4586763">.</span><span class="ident" id="4586764">Equal</span><span class="op" id="4586769">(</span><span class="ident" id="4586770">m</span><span class="op" id="4586771">.</span><span class="ident" id="4586772">raw</span><span class="op" id="4586775">,</span>&nbsp;<span class="ident" id="4586777">m1</span><span class="op" id="4586779">.</span><span class="ident" id="4586780">raw</span><span class="op" id="4586783">)</span>&nbsp;<span class="op" id="4586785">&amp;&amp;</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4586790">bytes</span><span class="op" id="4586795">.</span><span class="ident" id="4586796">Equal</span><span class="op" id="4586801">(</span><span class="ident" id="4586802">m</span><span class="op" id="4586803">.</span><span class="ident" id="4586804">key</span><span class="op" id="4586807">,</span>&nbsp;<span class="ident" id="4586809">m1</span><span class="op" id="4586811">.</span><span class="ident" id="4586812">key</span><span class="op" id="4586815">)</span><br>
<span class="lineno"></span><span class="op" id="4586817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4586820">func</span>&nbsp;<span class="op" id="4586825">(</span><span class="ident" id="4586826">m</span>&nbsp;<span class="op" id="4586828">*</span><span class="ident" id="4586829">serverKeyExchangeMsg</span><span class="op" id="4586849">)</span>&nbsp;<span class="ident" id="4586851">marshal</span><span class="op" id="4586858">(</span><span class="op" id="4586859">)</span>&nbsp;<span class="op" id="4586861">[</span><span class="op" id="4586862">]</span><span class="builtintype" id="4586863">byte</span>&nbsp;<span class="op" id="4586868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4586871">if</span>&nbsp;<span class="ident" id="4586874">m</span><span class="op" id="4586875">.</span><span class="ident" id="4586876">raw</span>&nbsp;<span class="op" id="4586880">!=</span>&nbsp;<span class="ident" id="4586883">nil</span>&nbsp;<span class="op" id="4586887">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4586891">return</span>&nbsp;<span class="ident" id="4586898">m</span><span class="op" id="4586899">.</span><span class="ident" id="4586900">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4586905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4586908">length</span>&nbsp;<span class="op" id="4586915">:=</span>&nbsp;<span class="builtinfunc" id="4586918">len</span><span class="op" id="4586921">(</span><span class="ident" id="4586922">m</span><span class="op" id="4586923">.</span><span class="ident" id="4586924">key</span><span class="op" id="4586927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4586930">x</span>&nbsp;<span class="op" id="4586932">:=</span>&nbsp;<span class="builtinfunc" id="4586935">make</span><span class="op" id="4586939">(</span><span class="op" id="4586940">[</span><span class="op" id="4586941">]</span><span class="builtintype" id="4586942">byte</span><span class="op" id="4586946">,</span>&nbsp;<span class="ident" id="4586948">length</span><span class="op" id="4586954">+</span><span class="num" id="4586955">4</span><span class="op" id="4586956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4586959">x</span><span class="op" id="4586960">[</span><span class="num" id="4586961">0</span><span class="op" id="4586962">]</span>&nbsp;<span class="op" id="4586964">=</span>&nbsp;<span class="ident" id="4586966">typeServerKeyExchange</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4586989">x</span><span class="op" id="4586990">[</span><span class="num" id="4586991">1</span><span class="op" id="4586992">]</span>&nbsp;<span class="op" id="4586994">=</span>&nbsp;<span class="builtintype" id="4586996">uint8</span><span class="op" id="4587001">(</span><span class="ident" id="4587002">length</span>&nbsp;<span class="op" id="4587009">&gt;&gt;</span>&nbsp;<span class="num" id="4587012">16</span><span class="op" id="4587014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587017">x</span><span class="op" id="4587018">[</span><span class="num" id="4587019">2</span><span class="op" id="4587020">]</span>&nbsp;<span class="op" id="4587022">=</span>&nbsp;<span class="builtintype" id="4587024">uint8</span><span class="op" id="4587029">(</span><span class="ident" id="4587030">length</span>&nbsp;<span class="op" id="4587037">&gt;&gt;</span>&nbsp;<span class="num" id="4587040">8</span><span class="op" id="4587041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587044">x</span><span class="op" id="4587045">[</span><span class="num" id="4587046">3</span><span class="op" id="4587047">]</span>&nbsp;<span class="op" id="4587049">=</span>&nbsp;<span class="builtintype" id="4587051">uint8</span><span class="op" id="4587056">(</span><span class="ident" id="4587057">length</span><span class="op" id="4587063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4587066">copy</span><span class="op" id="4587070">(</span><span class="ident" id="4587071">x</span><span class="op" id="4587072">[</span><span class="num" id="4587073">4</span><span class="op" id="4587074">:</span><span class="op" id="4587075">]</span><span class="op" id="4587076">,</span>&nbsp;<span class="ident" id="4587078">m</span><span class="op" id="4587079">.</span><span class="ident" id="4587080">key</span><span class="op" id="4587083">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587087">m</span><span class="op" id="4587088">.</span><span class="ident" id="4587089">raw</span>&nbsp;<span class="op" id="4587093">=</span>&nbsp;<span class="ident" id="4587095">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4587098">return</span>&nbsp;<span class="ident" id="4587105">x</span><br>
<span class="lineno"></span><span class="op" id="4587107">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4587110">func</span>&nbsp;<span class="op" id="4587115">(</span><span class="ident" id="4587116">m</span>&nbsp;<span class="op" id="4587118">*</span><span class="ident" id="4587119">serverKeyExchangeMsg</span><span class="op" id="4587139">)</span>&nbsp;<span class="ident" id="4587141">unmarshal</span><span class="op" id="4587150">(</span><span class="ident" id="4587151">data</span>&nbsp;<span class="op" id="4587156">[</span><span class="op" id="4587157">]</span><span class="builtintype" id="4587158">byte</span><span class="op" id="4587162">)</span>&nbsp;<span class="builtintype" id="4587164">bool</span>&nbsp;<span class="op" id="4587169">{</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587172">m</span><span class="op" id="4587173">.</span><span class="ident" id="4587174">raw</span>&nbsp;<span class="op" id="4587178">=</span>&nbsp;<span class="ident" id="4587180">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4587186">if</span>&nbsp;<span class="builtinfunc" id="4587189">len</span><span class="op" id="4587192">(</span><span class="ident" id="4587193">data</span><span class="op" id="4587197">)</span>&nbsp;<span class="op" id="4587199">&lt;</span>&nbsp;<span class="num" id="4587201">4</span>&nbsp;<span class="op" id="4587203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4587207">return</span>&nbsp;<span class="builtintype" id="4587214">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4587221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587224">m</span><span class="op" id="4587225">.</span><span class="ident" id="4587226">key</span>&nbsp;<span class="op" id="4587230">=</span>&nbsp;<span class="ident" id="4587232">data</span><span class="op" id="4587236">[</span><span class="num" id="4587237">4</span><span class="op" id="4587238">:</span><span class="op" id="4587239">]</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4587242">return</span>&nbsp;<span class="builtintype" id="4587249">true</span><br>
<span class="lineno"></span><span class="op" id="4587254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4587257">type</span>&nbsp;<span class="ident" id="4587262">certificateStatusMsg</span>&nbsp;<span class="keyword" id="4587283">struct</span>&nbsp;<span class="op" id="4587290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587293">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4587304">[</span><span class="op" id="4587305">]</span><span class="builtintype" id="4587306">byte</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587312">statusType</span>&nbsp;<span class="builtintype" id="4587323">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587330">response</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4587341">[</span><span class="op" id="4587342">]</span><span class="builtintype" id="4587343">byte</span><br>
<span class="lineno"></span><span class="op" id="4587348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4587351">func</span>&nbsp;<span class="op" id="4587356">(</span><span class="ident" id="4587357">m</span>&nbsp;<span class="op" id="4587359">*</span><span class="ident" id="4587360">certificateStatusMsg</span><span class="op" id="4587380">)</span>&nbsp;<span class="ident" id="4587382">equal</span><span class="op" id="4587387">(</span><span class="ident" id="4587388">i</span>&nbsp;<span class="keyword" id="4587390">interface</span><span class="op" id="4587399">{</span><span class="op" id="4587400">}</span><span class="op" id="4587401">)</span>&nbsp;<span class="builtintype" id="4587403">bool</span>&nbsp;<span class="op" id="4587408">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587411">m1</span><span class="op" id="4587413">,</span>&nbsp;<span class="ident" id="4587415">ok</span>&nbsp;<span class="op" id="4587418">:=</span>&nbsp;<span class="ident" id="4587421">i</span><span class="op" id="4587422">.</span><span class="op" id="4587423">(</span><span class="op" id="4587424">*</span><span class="ident" id="4587425">certificateStatusMsg</span><span class="op" id="4587445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4587448">if</span>&nbsp;<span class="op" id="4587451">!</span><span class="ident" id="4587452">ok</span>&nbsp;<span class="op" id="4587455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4587459">return</span>&nbsp;<span class="builtintype" id="4587466">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4587473">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4587477">return</span>&nbsp;<span class="ident" id="4587484">bytes</span><span class="op" id="4587489">.</span><span class="ident" id="4587490">Equal</span><span class="op" id="4587495">(</span><span class="ident" id="4587496">m</span><span class="op" id="4587497">.</span><span class="ident" id="4587498">raw</span><span class="op" id="4587501">,</span>&nbsp;<span class="ident" id="4587503">m1</span><span class="op" id="4587505">.</span><span class="ident" id="4587506">raw</span><span class="op" id="4587509">)</span>&nbsp;<span class="op" id="4587511">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587516">m</span><span class="op" id="4587517">.</span><span class="ident" id="4587518">statusType</span>&nbsp;<span class="op" id="4587529">==</span>&nbsp;<span class="ident" id="4587532">m1</span><span class="op" id="4587534">.</span><span class="ident" id="4587535">statusType</span>&nbsp;<span class="op" id="4587546">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587551">bytes</span><span class="op" id="4587556">.</span><span class="ident" id="4587557">Equal</span><span class="op" id="4587562">(</span><span class="ident" id="4587563">m</span><span class="op" id="4587564">.</span><span class="ident" id="4587565">response</span><span class="op" id="4587573">,</span>&nbsp;<span class="ident" id="4587575">m1</span><span class="op" id="4587577">.</span><span class="ident" id="4587578">response</span><span class="op" id="4587586">)</span><br>
<span class="lineno"></span><span class="op" id="4587588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="keyword" id="4587591">func</span>&nbsp;<span class="op" id="4587596">(</span><span class="ident" id="4587597">m</span>&nbsp;<span class="op" id="4587599">*</span><span class="ident" id="4587600">certificateStatusMsg</span><span class="op" id="4587620">)</span>&nbsp;<span class="ident" id="4587622">marshal</span><span class="op" id="4587629">(</span><span class="op" id="4587630">)</span>&nbsp;<span class="op" id="4587632">[</span><span class="op" id="4587633">]</span><span class="builtintype" id="4587634">byte</span>&nbsp;<span class="op" id="4587639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4587642">if</span>&nbsp;<span class="ident" id="4587645">m</span><span class="op" id="4587646">.</span><span class="ident" id="4587647">raw</span>&nbsp;<span class="op" id="4587651">!=</span>&nbsp;<span class="ident" id="4587654">nil</span>&nbsp;<span class="op" id="4587658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4587662">return</span>&nbsp;<span class="ident" id="4587669">m</span><span class="op" id="4587670">.</span><span class="ident" id="4587671">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4587676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4587680">var</span>&nbsp;<span class="ident" id="4587684">x</span>&nbsp;<span class="op" id="4587686">[</span><span class="op" id="4587687">]</span><span class="builtintype" id="4587688">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4587694">if</span>&nbsp;<span class="ident" id="4587697">m</span><span class="op" id="4587698">.</span><span class="ident" id="4587699">statusType</span>&nbsp;<span class="op" id="4587710">==</span>&nbsp;<span class="ident" id="4587713">statusTypeOCSP</span>&nbsp;<span class="op" id="4587728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587732">x</span>&nbsp;<span class="op" id="4587734">=</span>&nbsp;<span class="builtinfunc" id="4587736">make</span><span class="op" id="4587740">(</span><span class="op" id="4587741">[</span><span class="op" id="4587742">]</span><span class="builtintype" id="4587743">byte</span><span class="op" id="4587747">,</span>&nbsp;<span class="num" id="4587749">4</span><span class="op" id="4587750">+</span><span class="num" id="4587751">4</span><span class="op" id="4587752">+</span><span class="builtinfunc" id="4587753">len</span><span class="op" id="4587756">(</span><span class="ident" id="4587757">m</span><span class="op" id="4587758">.</span><span class="ident" id="4587759">response</span><span class="op" id="4587767">)</span><span class="op" id="4587768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587772">x</span><span class="op" id="4587773">[</span><span class="num" id="4587774">0</span><span class="op" id="4587775">]</span>&nbsp;<span class="op" id="4587777">=</span>&nbsp;<span class="ident" id="4587779">typeCertificateStatus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587803">l</span>&nbsp;<span class="op" id="4587805">:=</span>&nbsp;<span class="builtinfunc" id="4587808">len</span><span class="op" id="4587811">(</span><span class="ident" id="4587812">m</span><span class="op" id="4587813">.</span><span class="ident" id="4587814">response</span><span class="op" id="4587822">)</span>&nbsp;<span class="op" id="4587824">+</span>&nbsp;<span class="num" id="4587826">4</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587830">x</span><span class="op" id="4587831">[</span><span class="num" id="4587832">1</span><span class="op" id="4587833">]</span>&nbsp;<span class="op" id="4587835">=</span>&nbsp;<span class="builtintype" id="4587837">byte</span><span class="op" id="4587841">(</span><span class="ident" id="4587842">l</span>&nbsp;<span class="op" id="4587844">&gt;&gt;</span>&nbsp;<span class="num" id="4587847">16</span><span class="op" id="4587849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587853">x</span><span class="op" id="4587854">[</span><span class="num" id="4587855">2</span><span class="op" id="4587856">]</span>&nbsp;<span class="op" id="4587858">=</span>&nbsp;<span class="builtintype" id="4587860">byte</span><span class="op" id="4587864">(</span><span class="ident" id="4587865">l</span>&nbsp;<span class="op" id="4587867">&gt;&gt;</span>&nbsp;<span class="num" id="4587870">8</span><span class="op" id="4587871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587875">x</span><span class="op" id="4587876">[</span><span class="num" id="4587877">3</span><span class="op" id="4587878">]</span>&nbsp;<span class="op" id="4587880">=</span>&nbsp;<span class="builtintype" id="4587882">byte</span><span class="op" id="4587886">(</span><span class="ident" id="4587887">l</span><span class="op" id="4587888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587892">x</span><span class="op" id="4587893">[</span><span class="num" id="4587894">4</span><span class="op" id="4587895">]</span>&nbsp;<span class="op" id="4587897">=</span>&nbsp;<span class="ident" id="4587899">statusTypeOCSP</span><br>
<span class="lineno"></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587917">l</span>&nbsp;<span class="op" id="4587919">-=</span>&nbsp;<span class="num" id="4587922">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587926">x</span><span class="op" id="4587927">[</span><span class="num" id="4587928">5</span><span class="op" id="4587929">]</span>&nbsp;<span class="op" id="4587931">=</span>&nbsp;<span class="builtintype" id="4587933">byte</span><span class="op" id="4587937">(</span><span class="ident" id="4587938">l</span>&nbsp;<span class="op" id="4587940">&gt;&gt;</span>&nbsp;<span class="num" id="4587943">16</span><span class="op" id="4587945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587949">x</span><span class="op" id="4587950">[</span><span class="num" id="4587951">6</span><span class="op" id="4587952">]</span>&nbsp;<span class="op" id="4587954">=</span>&nbsp;<span class="builtintype" id="4587956">byte</span><span class="op" id="4587960">(</span><span class="ident" id="4587961">l</span>&nbsp;<span class="op" id="4587963">&gt;&gt;</span>&nbsp;<span class="num" id="4587966">8</span><span class="op" id="4587967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587971">x</span><span class="op" id="4587972">[</span><span class="num" id="4587973">7</span><span class="op" id="4587974">]</span>&nbsp;<span class="op" id="4587976">=</span>&nbsp;<span class="builtintype" id="4587978">byte</span><span class="op" id="4587982">(</span><span class="ident" id="4587983">l</span><span class="op" id="4587984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4587988">copy</span><span class="op" id="4587992">(</span><span class="ident" id="4587993">x</span><span class="op" id="4587994">[</span><span class="num" id="4587995">8</span><span class="op" id="4587996">:</span><span class="op" id="4587997">]</span><span class="op" id="4587998">,</span>&nbsp;<span class="ident" id="4588000">m</span><span class="op" id="4588001">.</span><span class="ident" id="4588002">response</span><span class="op" id="4588010">)</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4588013">}</span>&nbsp;<span class="keyword" id="4588015">else</span>&nbsp;<span class="op" id="4588020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4588024">x</span>&nbsp;<span class="op" id="4588026">=</span>&nbsp;<span class="op" id="4588028">[</span><span class="op" id="4588029">]</span><span class="builtintype" id="4588030">byte</span><span class="op" id="4588034">{</span><span class="ident" id="4588035">typeCertificateStatus</span><span class="op" id="4588056">,</span>&nbsp;<span class="num" id="4588058">0</span><span class="op" id="4588059">,</span>&nbsp;<span class="num" id="4588061">0</span><span class="op" id="4588062">,</span>&nbsp;<span class="num" id="4588064">1</span><span class="op" id="4588065">,</span>&nbsp;<span class="ident" id="4588067">m</span><span class="op" id="4588068">.</span><span class="ident" id="4588069">statusType</span><span class="op" id="4588079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4588082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4588086">m</span><span class="op" id="4588087">.</span><span class="ident" id="4588088">raw</span>&nbsp;<span class="op" id="4588092">=</span>&nbsp;<span class="ident" id="4588094">x</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4588097">return</span>&nbsp;<span class="ident" id="4588104">x</span><br>
<span class="lineno"></span><span class="op" id="4588106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4588109">func</span>&nbsp;<span class="op" id="4588114">(</span><span class="ident" id="4588115">m</span>&nbsp;<span class="op" id="4588117">*</span><span class="ident" id="4588118">certificateStatusMsg</span><span class="op" id="4588138">)</span>&nbsp;<span class="ident" id="4588140">unmarshal</span><span class="op" id="4588149">(</span><span class="ident" id="4588150">data</span>&nbsp;<span class="op" id="4588155">[</span><span class="op" id="4588156">]</span><span class="builtintype" id="4588157">byte</span><span class="op" id="4588161">)</span>&nbsp;<span class="builtintype" id="4588163">bool</span>&nbsp;<span class="op" id="4588168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4588171">m</span><span class="op" id="4588172">.</span><span class="ident" id="4588173">raw</span>&nbsp;<span class="op" id="4588177">=</span>&nbsp;<span class="ident" id="4588179">data</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4588185">if</span>&nbsp;<span class="builtinfunc" id="4588188">len</span><span class="op" id="4588191">(</span><span class="ident" id="4588192">data</span><span class="op" id="4588196">)</span>&nbsp;<span class="op" id="4588198">&lt;</span>&nbsp;<span class="num" id="4588200">5</span>&nbsp;<span class="op" id="4588202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4588206">return</span>&nbsp;<span class="builtintype" id="4588213">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4588220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4588223">m</span><span class="op" id="4588224">.</span><span class="ident" id="4588225">statusType</span>&nbsp;<span class="op" id="4588236">=</span>&nbsp;<span class="ident" id="4588238">data</span><span class="op" id="4588242">[</span><span class="num" id="4588243">4</span><span class="op" id="4588244">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4588248">m</span><span class="op" id="4588249">.</span><span class="ident" id="4588250">response</span>&nbsp;<span class="op" id="4588259">=</span>&nbsp;<span class="ident" id="4588261">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4588266">if</span>&nbsp;<span class="ident" id="4588269">m</span><span class="op" id="4588270">.</span><span class="ident" id="4588271">statusType</span>&nbsp;<span class="op" id="4588282">==</span>&nbsp;<span class="ident" id="4588285">statusTypeOCSP</span>&nbsp;<span class="op" id="4588300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4588304">if</span>&nbsp;<span class="builtinfunc" id="4588307">len</span><span class="op" id="4588310">(</span><span class="ident" id="4588311">data</span><span class="op" id="4588315">)</span>&nbsp;<span class="op" id="4588317">&lt;</span>&nbsp;<span class="num" id="4588319">8</span>&nbsp;<span class="op" id="4588321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4588326">return</span>&nbsp;<span class="builtintype" id="4588333">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4588341">}</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4588345">respLen</span>&nbsp;<span class="op" id="4588353">:=</span>&nbsp;<span class="builtintype" id="4588356">uint32</span><span class="op" id="4588362">(</span><span class="ident" id="4588363">data</span><span class="op" id="4588367">[</span><span class="num" id="4588368">5</span><span class="op" id="4588369">]</span><span class="op" id="4588370">)</span><span class="op" id="4588371">&lt;&lt;</span><span class="num" id="4588373">16</span>&nbsp;<span class="op" id="4588376">|</span>&nbsp;<span class="builtintype" id="4588378">uint32</span><span class="op" id="4588384">(</span><span class="ident" id="4588385">data</span><span class="op" id="4588389">[</span><span class="num" id="4588390">6</span><span class="op" id="4588391">]</span><span class="op" id="4588392">)</span><span class="op" id="4588393">&lt;&lt;</span><span class="num" id="4588395">8</span>&nbsp;<span class="op" id="4588397">|</span>&nbsp;<span class="builtintype" id="4588399">uint32</span><span class="op" id="4588405">(</span><span class="ident" id="4588406">data</span><span class="op" id="4588410">[</span><span class="num" id="4588411">7</span><span class="op" id="4588412">]</span><span class="op" id="4588413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4588417">if</span>&nbsp;<span class="builtintype" id="4588420">uint32</span><span class="op" id="4588426">(</span><span class="builtinfunc" id="4588427">len</span><span class="op" id="4588430">(</span><span class="ident" id="4588431">data</span><span class="op" id="4588435">)</span><span class="op" id="4588436">)</span>&nbsp;<span class="op" id="4588438">!=</span>&nbsp;<span class="num" id="4588441">4</span><span class="op" id="4588442">+</span><span class="num" id="4588443">4</span><span class="op" id="4588444">+</span><span class="ident" id="4588445">respLen</span>&nbsp;<span class="op" id="4588453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4588458">return</span>&nbsp;<span class="builtintype" id="4588465">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4588473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4588477">m</span><span class="op" id="4588478">.</span><span class="ident" id="4588479">response</span>&nbsp;<span class="op" id="4588488">=</span>&nbsp;<span class="ident" id="4588490">data</span><span class="op" id="4588494">[</span><span class="num" id="4588495">8</span><span class="op" id="4588496">:</span><span class="op" id="4588497">]</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4588500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4588503">return</span>&nbsp;<span class="builtintype" id="4588510">true</span><br>
<span class="lineno"></span><span class="op" id="4588515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4588518">type</span>&nbsp;<span class="ident" id="4588523">serverHelloDoneMsg</span>&nbsp;<span class="keyword" id="4588542">struct</span><span class="op" id="4588548">{</span><span class="op" id="4588549">}</span><br>
<span class="lineno">910</span><br>
<span class="lineno"></span><span class="keyword" id="4588552">func</span>&nbsp;<span class="op" id="4588557">(</span><span class="ident" id="4588558">m</span>&nbsp;<span class="op" id="4588560">*</span><span class="ident" id="4588561">serverHelloDoneMsg</span><span class="op" id="4588579">)</span>&nbsp;<span class="ident" id="4588581">equal</span><span class="op" id="4588586">(</span><span class="ident" id="4588587">i</span>&nbsp;<span class="keyword" id="4588589">interface</span><span class="op" id="4588598">{</span><span class="op" id="4588599">}</span><span class="op" id="4588600">)</span>&nbsp;<span class="builtintype" id="4588602">bool</span>&nbsp;<span class="op" id="4588607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4588610">_</span><span class="op" id="4588611">,</span>&nbsp;<span class="ident" id="4588613">ok</span>&nbsp;<span class="op" id="4588616">:=</span>&nbsp;<span class="ident" id="4588619">i</span><span class="op" id="4588620">.</span><span class="op" id="4588621">(</span><span class="op" id="4588622">*</span><span class="ident" id="4588623">serverHelloDoneMsg</span><span class="op" id="4588641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4588644">return</span>&nbsp;<span class="ident" id="4588651">ok</span><br>
<span class="lineno"></span><span class="op" id="4588654">}</span><br>
<span class="lineno">915</span><br>
<span class="lineno"></span><span class="keyword" id="4588657">func</span>&nbsp;<span class="op" id="4588662">(</span><span class="ident" id="4588663">m</span>&nbsp;<span class="op" id="4588665">*</span><span class="ident" id="4588666">serverHelloDoneMsg</span><span class="op" id="4588684">)</span>&nbsp;<span class="ident" id="4588686">marshal</span><span class="op" id="4588693">(</span><span class="op" id="4588694">)</span>&nbsp;<span class="op" id="4588696">[</span><span class="op" id="4588697">]</span><span class="builtintype" id="4588698">byte</span>&nbsp;<span class="op" id="4588703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4588706">x</span>&nbsp;<span class="op" id="4588708">:=</span>&nbsp;<span class="builtinfunc" id="4588711">make</span><span class="op" id="4588715">(</span><span class="op" id="4588716">[</span><span class="op" id="4588717">]</span><span class="builtintype" id="4588718">byte</span><span class="op" id="4588722">,</span>&nbsp;<span class="num" id="4588724">4</span><span class="op" id="4588725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4588728">x</span><span class="op" id="4588729">[</span><span class="num" id="4588730">0</span><span class="op" id="4588731">]</span>&nbsp;<span class="op" id="4588733">=</span>&nbsp;<span class="ident" id="4588735">typeServerHelloDone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4588756">return</span>&nbsp;<span class="ident" id="4588763">x</span><br>
<span class="lineno">920</span><span class="op" id="4588765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4588768">func</span>&nbsp;<span class="op" id="4588773">(</span><span class="ident" id="4588774">m</span>&nbsp;<span class="op" id="4588776">*</span><span class="ident" id="4588777">serverHelloDoneMsg</span><span class="op" id="4588795">)</span>&nbsp;<span class="ident" id="4588797">unmarshal</span><span class="op" id="4588806">(</span><span class="ident" id="4588807">data</span>&nbsp;<span class="op" id="4588812">[</span><span class="op" id="4588813">]</span><span class="builtintype" id="4588814">byte</span><span class="op" id="4588818">)</span>&nbsp;<span class="builtintype" id="4588820">bool</span>&nbsp;<span class="op" id="4588825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4588828">return</span>&nbsp;<span class="builtinfunc" id="4588835">len</span><span class="op" id="4588838">(</span><span class="ident" id="4588839">data</span><span class="op" id="4588843">)</span>&nbsp;<span class="op" id="4588845">==</span>&nbsp;<span class="num" id="4588848">4</span><br>
<span class="lineno"></span><span class="op" id="4588850">}</span><br>
<span class="lineno">925</span><br>
<span class="lineno"></span><span class="keyword" id="4588853">type</span>&nbsp;<span class="ident" id="4588858">clientKeyExchangeMsg</span>&nbsp;<span class="keyword" id="4588879">struct</span>&nbsp;<span class="op" id="4588886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4588889">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4588900">[</span><span class="op" id="4588901">]</span><span class="builtintype" id="4588902">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4588908">ciphertext</span>&nbsp;<span class="op" id="4588919">[</span><span class="op" id="4588920">]</span><span class="builtintype" id="4588921">byte</span><br>
<span class="lineno"></span><span class="op" id="4588926">}</span><br>
<span class="lineno">930</span><br>
<span class="lineno"></span><span class="keyword" id="4588929">func</span>&nbsp;<span class="op" id="4588934">(</span><span class="ident" id="4588935">m</span>&nbsp;<span class="op" id="4588937">*</span><span class="ident" id="4588938">clientKeyExchangeMsg</span><span class="op" id="4588958">)</span>&nbsp;<span class="ident" id="4588960">equal</span><span class="op" id="4588965">(</span><span class="ident" id="4588966">i</span>&nbsp;<span class="keyword" id="4588968">interface</span><span class="op" id="4588977">{</span><span class="op" id="4588978">}</span><span class="op" id="4588979">)</span>&nbsp;<span class="builtintype" id="4588981">bool</span>&nbsp;<span class="op" id="4588986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4588989">m1</span><span class="op" id="4588991">,</span>&nbsp;<span class="ident" id="4588993">ok</span>&nbsp;<span class="op" id="4588996">:=</span>&nbsp;<span class="ident" id="4588999">i</span><span class="op" id="4589000">.</span><span class="op" id="4589001">(</span><span class="op" id="4589002">*</span><span class="ident" id="4589003">clientKeyExchangeMsg</span><span class="op" id="4589023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4589026">if</span>&nbsp;<span class="op" id="4589029">!</span><span class="ident" id="4589030">ok</span>&nbsp;<span class="op" id="4589033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4589037">return</span>&nbsp;<span class="builtintype" id="4589044">false</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4589051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4589055">return</span>&nbsp;<span class="ident" id="4589062">bytes</span><span class="op" id="4589067">.</span><span class="ident" id="4589068">Equal</span><span class="op" id="4589073">(</span><span class="ident" id="4589074">m</span><span class="op" id="4589075">.</span><span class="ident" id="4589076">raw</span><span class="op" id="4589079">,</span>&nbsp;<span class="ident" id="4589081">m1</span><span class="op" id="4589083">.</span><span class="ident" id="4589084">raw</span><span class="op" id="4589087">)</span>&nbsp;<span class="op" id="4589089">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4589094">bytes</span><span class="op" id="4589099">.</span><span class="ident" id="4589100">Equal</span><span class="op" id="4589105">(</span><span class="ident" id="4589106">m</span><span class="op" id="4589107">.</span><span class="ident" id="4589108">ciphertext</span><span class="op" id="4589118">,</span>&nbsp;<span class="ident" id="4589120">m1</span><span class="op" id="4589122">.</span><span class="ident" id="4589123">ciphertext</span><span class="op" id="4589133">)</span><br>
<span class="lineno"></span><span class="op" id="4589135">}</span><br>
<span class="lineno">940</span><br>
<span class="lineno"></span><span class="keyword" id="4589138">func</span>&nbsp;<span class="op" id="4589143">(</span><span class="ident" id="4589144">m</span>&nbsp;<span class="op" id="4589146">*</span><span class="ident" id="4589147">clientKeyExchangeMsg</span><span class="op" id="4589167">)</span>&nbsp;<span class="ident" id="4589169">marshal</span><span class="op" id="4589176">(</span><span class="op" id="4589177">)</span>&nbsp;<span class="op" id="4589179">[</span><span class="op" id="4589180">]</span><span class="builtintype" id="4589181">byte</span>&nbsp;<span class="op" id="4589186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4589189">if</span>&nbsp;<span class="ident" id="4589192">m</span><span class="op" id="4589193">.</span><span class="ident" id="4589194">raw</span>&nbsp;<span class="op" id="4589198">!=</span>&nbsp;<span class="ident" id="4589201">nil</span>&nbsp;<span class="op" id="4589205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4589209">return</span>&nbsp;<span class="ident" id="4589216">m</span><span class="op" id="4589217">.</span><span class="ident" id="4589218">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4589223">}</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4589226">length</span>&nbsp;<span class="op" id="4589233">:=</span>&nbsp;<span class="builtinfunc" id="4589236">len</span><span class="op" id="4589239">(</span><span class="ident" id="4589240">m</span><span class="op" id="4589241">.</span><span class="ident" id="4589242">ciphertext</span><span class="op" id="4589252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4589255">x</span>&nbsp;<span class="op" id="4589257">:=</span>&nbsp;<span class="builtinfunc" id="4589260">make</span><span class="op" id="4589264">(</span><span class="op" id="4589265">[</span><span class="op" id="4589266">]</span><span class="builtintype" id="4589267">byte</span><span class="op" id="4589271">,</span>&nbsp;<span class="ident" id="4589273">length</span><span class="op" id="4589279">+</span><span class="num" id="4589280">4</span><span class="op" id="4589281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4589284">x</span><span class="op" id="4589285">[</span><span class="num" id="4589286">0</span><span class="op" id="4589287">]</span>&nbsp;<span class="op" id="4589289">=</span>&nbsp;<span class="ident" id="4589291">typeClientKeyExchange</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4589314">x</span><span class="op" id="4589315">[</span><span class="num" id="4589316">1</span><span class="op" id="4589317">]</span>&nbsp;<span class="op" id="4589319">=</span>&nbsp;<span class="builtintype" id="4589321">uint8</span><span class="op" id="4589326">(</span><span class="ident" id="4589327">length</span>&nbsp;<span class="op" id="4589334">&gt;&gt;</span>&nbsp;<span class="num" id="4589337">16</span><span class="op" id="4589339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4589342">x</span><span class="op" id="4589343">[</span><span class="num" id="4589344">2</span><span class="op" id="4589345">]</span>&nbsp;<span class="op" id="4589347">=</span>&nbsp;<span class="builtintype" id="4589349">uint8</span><span class="op" id="4589354">(</span><span class="ident" id="4589355">length</span>&nbsp;<span class="op" id="4589362">&gt;&gt;</span>&nbsp;<span class="num" id="4589365">8</span><span class="op" id="4589366">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4589369">x</span><span class="op" id="4589370">[</span><span class="num" id="4589371">3</span><span class="op" id="4589372">]</span>&nbsp;<span class="op" id="4589374">=</span>&nbsp;<span class="builtintype" id="4589376">uint8</span><span class="op" id="4589381">(</span><span class="ident" id="4589382">length</span><span class="op" id="4589388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4589391">copy</span><span class="op" id="4589395">(</span><span class="ident" id="4589396">x</span><span class="op" id="4589397">[</span><span class="num" id="4589398">4</span><span class="op" id="4589399">:</span><span class="op" id="4589400">]</span><span class="op" id="4589401">,</span>&nbsp;<span class="ident" id="4589403">m</span><span class="op" id="4589404">.</span><span class="ident" id="4589405">ciphertext</span><span class="op" id="4589415">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4589419">m</span><span class="op" id="4589420">.</span><span class="ident" id="4589421">raw</span>&nbsp;<span class="op" id="4589425">=</span>&nbsp;<span class="ident" id="4589427">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4589430">return</span>&nbsp;<span class="ident" id="4589437">x</span><br>
<span class="lineno">955</span><span class="op" id="4589439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4589442">func</span>&nbsp;<span class="op" id="4589447">(</span><span class="ident" id="4589448">m</span>&nbsp;<span class="op" id="4589450">*</span><span class="ident" id="4589451">clientKeyExchangeMsg</span><span class="op" id="4589471">)</span>&nbsp;<span class="ident" id="4589473">unmarshal</span><span class="op" id="4589482">(</span><span class="ident" id="4589483">data</span>&nbsp;<span class="op" id="4589488">[</span><span class="op" id="4589489">]</span><span class="builtintype" id="4589490">byte</span><span class="op" id="4589494">)</span>&nbsp;<span class="builtintype" id="4589496">bool</span>&nbsp;<span class="op" id="4589501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4589504">m</span><span class="op" id="4589505">.</span><span class="ident" id="4589506">raw</span>&nbsp;<span class="op" id="4589510">=</span>&nbsp;<span class="ident" id="4589512">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4589518">if</span>&nbsp;<span class="builtinfunc" id="4589521">len</span><span class="op" id="4589524">(</span><span class="ident" id="4589525">data</span><span class="op" id="4589529">)</span>&nbsp;<span class="op" id="4589531">&lt;</span>&nbsp;<span class="num" id="4589533">4</span>&nbsp;<span class="op" id="4589535">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4589539">return</span>&nbsp;<span class="builtintype" id="4589546">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4589553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4589556">l</span>&nbsp;<span class="op" id="4589558">:=</span>&nbsp;<span class="builtintype" id="4589561">int</span><span class="op" id="4589564">(</span><span class="ident" id="4589565">data</span><span class="op" id="4589569">[</span><span class="num" id="4589570">1</span><span class="op" id="4589571">]</span><span class="op" id="4589572">)</span><span class="op" id="4589573">&lt;&lt;</span><span class="num" id="4589575">16</span>&nbsp;<span class="op" id="4589578">|</span>&nbsp;<span class="builtintype" id="4589580">int</span><span class="op" id="4589583">(</span><span class="ident" id="4589584">data</span><span class="op" id="4589588">[</span><span class="num" id="4589589">2</span><span class="op" id="4589590">]</span><span class="op" id="4589591">)</span><span class="op" id="4589592">&lt;&lt;</span><span class="num" id="4589594">8</span>&nbsp;<span class="op" id="4589596">|</span>&nbsp;<span class="builtintype" id="4589598">int</span><span class="op" id="4589601">(</span><span class="ident" id="4589602">data</span><span class="op" id="4589606">[</span><span class="num" id="4589607">3</span><span class="op" id="4589608">]</span><span class="op" id="4589609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4589612">if</span>&nbsp;<span class="ident" id="4589615">l</span>&nbsp;<span class="op" id="4589617">!=</span>&nbsp;<span class="builtinfunc" id="4589620">len</span><span class="op" id="4589623">(</span><span class="ident" id="4589624">data</span><span class="op" id="4589628">)</span><span class="op" id="4589629">-</span><span class="num" id="4589630">4</span>&nbsp;<span class="op" id="4589632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4589636">return</span>&nbsp;<span class="builtintype" id="4589643">false</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4589650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4589653">m</span><span class="op" id="4589654">.</span><span class="ident" id="4589655">ciphertext</span>&nbsp;<span class="op" id="4589666">=</span>&nbsp;<span class="ident" id="4589668">data</span><span class="op" id="4589672">[</span><span class="num" id="4589673">4</span><span class="op" id="4589674">:</span><span class="op" id="4589675">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4589678">return</span>&nbsp;<span class="builtintype" id="4589685">true</span><br>
<span class="lineno"></span><span class="op" id="4589690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">970</span><span class="keyword" id="4589693">type</span>&nbsp;<span class="ident" id="4589698">finishedMsg</span>&nbsp;<span class="keyword" id="4589710">struct</span>&nbsp;<span class="op" id="4589717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4589720">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4589731">[</span><span class="op" id="4589732">]</span><span class="builtintype" id="4589733">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4589739">verifyData</span>&nbsp;<span class="op" id="4589750">[</span><span class="op" id="4589751">]</span><span class="builtintype" id="4589752">byte</span><br>
<span class="lineno"></span><span class="op" id="4589757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">975</span><span class="keyword" id="4589760">func</span>&nbsp;<span class="op" id="4589765">(</span><span class="ident" id="4589766">m</span>&nbsp;<span class="op" id="4589768">*</span><span class="ident" id="4589769">finishedMsg</span><span class="op" id="4589780">)</span>&nbsp;<span class="ident" id="4589782">equal</span><span class="op" id="4589787">(</span><span class="ident" id="4589788">i</span>&nbsp;<span class="keyword" id="4589790">interface</span><span class="op" id="4589799">{</span><span class="op" id="4589800">}</span><span class="op" id="4589801">)</span>&nbsp;<span class="builtintype" id="4589803">bool</span>&nbsp;<span class="op" id="4589808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4589811">m1</span><span class="op" id="4589813">,</span>&nbsp;<span class="ident" id="4589815">ok</span>&nbsp;<span class="op" id="4589818">:=</span>&nbsp;<span class="ident" id="4589821">i</span><span class="op" id="4589822">.</span><span class="op" id="4589823">(</span><span class="op" id="4589824">*</span><span class="ident" id="4589825">finishedMsg</span><span class="op" id="4589836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4589839">if</span>&nbsp;<span class="op" id="4589842">!</span><span class="ident" id="4589843">ok</span>&nbsp;<span class="op" id="4589846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4589850">return</span>&nbsp;<span class="builtintype" id="4589857">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4589864">}</span><br>
<span class="lineno">980</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4589868">return</span>&nbsp;<span class="ident" id="4589875">bytes</span><span class="op" id="4589880">.</span><span class="ident" id="4589881">Equal</span><span class="op" id="4589886">(</span><span class="ident" id="4589887">m</span><span class="op" id="4589888">.</span><span class="ident" id="4589889">raw</span><span class="op" id="4589892">,</span>&nbsp;<span class="ident" id="4589894">m1</span><span class="op" id="4589896">.</span><span class="ident" id="4589897">raw</span><span class="op" id="4589900">)</span>&nbsp;<span class="op" id="4589902">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4589907">bytes</span><span class="op" id="4589912">.</span><span class="ident" id="4589913">Equal</span><span class="op" id="4589918">(</span><span class="ident" id="4589919">m</span><span class="op" id="4589920">.</span><span class="ident" id="4589921">verifyData</span><span class="op" id="4589931">,</span>&nbsp;<span class="ident" id="4589933">m1</span><span class="op" id="4589935">.</span><span class="ident" id="4589936">verifyData</span><span class="op" id="4589946">)</span><br>
<span class="lineno"></span><span class="op" id="4589948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">985</span><span class="keyword" id="4589951">func</span>&nbsp;<span class="op" id="4589956">(</span><span class="ident" id="4589957">m</span>&nbsp;<span class="op" id="4589959">*</span><span class="ident" id="4589960">finishedMsg</span><span class="op" id="4589971">)</span>&nbsp;<span class="ident" id="4589973">marshal</span><span class="op" id="4589980">(</span><span class="op" id="4589981">)</span>&nbsp;<span class="op" id="4589983">(</span><span class="ident" id="4589984">x</span>&nbsp;<span class="op" id="4589986">[</span><span class="op" id="4589987">]</span><span class="builtintype" id="4589988">byte</span><span class="op" id="4589992">)</span>&nbsp;<span class="op" id="4589994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4589997">if</span>&nbsp;<span class="ident" id="4590000">m</span><span class="op" id="4590001">.</span><span class="ident" id="4590002">raw</span>&nbsp;<span class="op" id="4590006">!=</span>&nbsp;<span class="ident" id="4590009">nil</span>&nbsp;<span class="op" id="4590013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4590017">return</span>&nbsp;<span class="ident" id="4590024">m</span><span class="op" id="4590025">.</span><span class="ident" id="4590026">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4590031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590035">x</span>&nbsp;<span class="op" id="4590037">=</span>&nbsp;<span class="builtinfunc" id="4590039">make</span><span class="op" id="4590043">(</span><span class="op" id="4590044">[</span><span class="op" id="4590045">]</span><span class="builtintype" id="4590046">byte</span><span class="op" id="4590050">,</span>&nbsp;<span class="num" id="4590052">4</span><span class="op" id="4590053">+</span><span class="builtinfunc" id="4590054">len</span><span class="op" id="4590057">(</span><span class="ident" id="4590058">m</span><span class="op" id="4590059">.</span><span class="ident" id="4590060">verifyData</span><span class="op" id="4590070">)</span><span class="op" id="4590071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590074">x</span><span class="op" id="4590075">[</span><span class="num" id="4590076">0</span><span class="op" id="4590077">]</span>&nbsp;<span class="op" id="4590079">=</span>&nbsp;<span class="ident" id="4590081">typeFinished</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590095">x</span><span class="op" id="4590096">[</span><span class="num" id="4590097">3</span><span class="op" id="4590098">]</span>&nbsp;<span class="op" id="4590100">=</span>&nbsp;<span class="builtintype" id="4590102">byte</span><span class="op" id="4590106">(</span><span class="builtinfunc" id="4590107">len</span><span class="op" id="4590110">(</span><span class="ident" id="4590111">m</span><span class="op" id="4590112">.</span><span class="ident" id="4590113">verifyData</span><span class="op" id="4590123">)</span><span class="op" id="4590124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4590127">copy</span><span class="op" id="4590131">(</span><span class="ident" id="4590132">x</span><span class="op" id="4590133">[</span><span class="num" id="4590134">4</span><span class="op" id="4590135">:</span><span class="op" id="4590136">]</span><span class="op" id="4590137">,</span>&nbsp;<span class="ident" id="4590139">m</span><span class="op" id="4590140">.</span><span class="ident" id="4590141">verifyData</span><span class="op" id="4590151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590154">m</span><span class="op" id="4590155">.</span><span class="ident" id="4590156">raw</span>&nbsp;<span class="op" id="4590160">=</span>&nbsp;<span class="ident" id="4590162">x</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4590165">return</span><br>
<span class="lineno"></span><span class="op" id="4590172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4590175">func</span>&nbsp;<span class="op" id="4590180">(</span><span class="ident" id="4590181">m</span>&nbsp;<span class="op" id="4590183">*</span><span class="ident" id="4590184">finishedMsg</span><span class="op" id="4590195">)</span>&nbsp;<span class="ident" id="4590197">unmarshal</span><span class="op" id="4590206">(</span><span class="ident" id="4590207">data</span>&nbsp;<span class="op" id="4590212">[</span><span class="op" id="4590213">]</span><span class="builtintype" id="4590214">byte</span><span class="op" id="4590218">)</span>&nbsp;<span class="builtintype" id="4590220">bool</span>&nbsp;<span class="op" id="4590225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590228">m</span><span class="op" id="4590229">.</span><span class="ident" id="4590230">raw</span>&nbsp;<span class="op" id="4590234">=</span>&nbsp;<span class="ident" id="4590236">data</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4590242">if</span>&nbsp;<span class="builtinfunc" id="4590245">len</span><span class="op" id="4590248">(</span><span class="ident" id="4590249">data</span><span class="op" id="4590253">)</span>&nbsp;<span class="op" id="4590255">&lt;</span>&nbsp;<span class="num" id="4590257">4</span>&nbsp;<span class="op" id="4590259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4590263">return</span>&nbsp;<span class="builtintype" id="4590270">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4590277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590280">m</span><span class="op" id="4590281">.</span><span class="ident" id="4590282">verifyData</span>&nbsp;<span class="op" id="4590293">=</span>&nbsp;<span class="ident" id="4590295">data</span><span class="op" id="4590299">[</span><span class="num" id="4590300">4</span><span class="op" id="4590301">:</span><span class="op" id="4590302">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4590305">return</span>&nbsp;<span class="builtintype" id="4590312">true</span><br>
<span class="lineno">1005</span><span class="op" id="4590317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4590320">type</span>&nbsp;<span class="ident" id="4590325">nextProtoMsg</span>&nbsp;<span class="keyword" id="4590338">struct</span>&nbsp;<span class="op" id="4590345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590348">raw</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4590354">[</span><span class="op" id="4590355">]</span><span class="builtintype" id="4590356">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590362">proto</span>&nbsp;<span class="builtintype" id="4590368">string</span><br>
<span class="lineno">1010</span><span class="op" id="4590375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4590378">func</span>&nbsp;<span class="op" id="4590383">(</span><span class="ident" id="4590384">m</span>&nbsp;<span class="op" id="4590386">*</span><span class="ident" id="4590387">nextProtoMsg</span><span class="op" id="4590399">)</span>&nbsp;<span class="ident" id="4590401">equal</span><span class="op" id="4590406">(</span><span class="ident" id="4590407">i</span>&nbsp;<span class="keyword" id="4590409">interface</span><span class="op" id="4590418">{</span><span class="op" id="4590419">}</span><span class="op" id="4590420">)</span>&nbsp;<span class="builtintype" id="4590422">bool</span>&nbsp;<span class="op" id="4590427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590430">m1</span><span class="op" id="4590432">,</span>&nbsp;<span class="ident" id="4590434">ok</span>&nbsp;<span class="op" id="4590437">:=</span>&nbsp;<span class="ident" id="4590440">i</span><span class="op" id="4590441">.</span><span class="op" id="4590442">(</span><span class="op" id="4590443">*</span><span class="ident" id="4590444">nextProtoMsg</span><span class="op" id="4590456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4590459">if</span>&nbsp;<span class="op" id="4590462">!</span><span class="ident" id="4590463">ok</span>&nbsp;<span class="op" id="4590466">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4590470">return</span>&nbsp;<span class="builtintype" id="4590477">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4590484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4590488">return</span>&nbsp;<span class="ident" id="4590495">bytes</span><span class="op" id="4590500">.</span><span class="ident" id="4590501">Equal</span><span class="op" id="4590506">(</span><span class="ident" id="4590507">m</span><span class="op" id="4590508">.</span><span class="ident" id="4590509">raw</span><span class="op" id="4590512">,</span>&nbsp;<span class="ident" id="4590514">m1</span><span class="op" id="4590516">.</span><span class="ident" id="4590517">raw</span><span class="op" id="4590520">)</span>&nbsp;<span class="op" id="4590522">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590527">m</span><span class="op" id="4590528">.</span><span class="ident" id="4590529">proto</span>&nbsp;<span class="op" id="4590535">==</span>&nbsp;<span class="ident" id="4590538">m1</span><span class="op" id="4590540">.</span><span class="ident" id="4590541">proto</span><br>
<span class="lineno">1020</span><span class="op" id="4590547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4590550">func</span>&nbsp;<span class="op" id="4590555">(</span><span class="ident" id="4590556">m</span>&nbsp;<span class="op" id="4590558">*</span><span class="ident" id="4590559">nextProtoMsg</span><span class="op" id="4590571">)</span>&nbsp;<span class="ident" id="4590573">marshal</span><span class="op" id="4590580">(</span><span class="op" id="4590581">)</span>&nbsp;<span class="op" id="4590583">[</span><span class="op" id="4590584">]</span><span class="builtintype" id="4590585">byte</span>&nbsp;<span class="op" id="4590590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4590593">if</span>&nbsp;<span class="ident" id="4590596">m</span><span class="op" id="4590597">.</span><span class="ident" id="4590598">raw</span>&nbsp;<span class="op" id="4590602">!=</span>&nbsp;<span class="ident" id="4590605">nil</span>&nbsp;<span class="op" id="4590609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4590613">return</span>&nbsp;<span class="ident" id="4590620">m</span><span class="op" id="4590621">.</span><span class="ident" id="4590622">raw</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4590627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590630">l</span>&nbsp;<span class="op" id="4590632">:=</span>&nbsp;<span class="builtinfunc" id="4590635">len</span><span class="op" id="4590638">(</span><span class="ident" id="4590639">m</span><span class="op" id="4590640">.</span><span class="ident" id="4590641">proto</span><span class="op" id="4590646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4590649">if</span>&nbsp;<span class="ident" id="4590652">l</span>&nbsp;<span class="op" id="4590654">&gt;</span>&nbsp;<span class="num" id="4590656">255</span>&nbsp;<span class="op" id="4590660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590664">l</span>&nbsp;<span class="op" id="4590666">=</span>&nbsp;<span class="num" id="4590668">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4590673">}</span><br>
<span class="lineno">1030</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590677">padding</span>&nbsp;<span class="op" id="4590685">:=</span>&nbsp;<span class="num" id="4590688">32</span>&nbsp;<span class="op" id="4590691">-</span>&nbsp;<span class="op" id="4590693">(</span><span class="ident" id="4590694">l</span><span class="op" id="4590695">+</span><span class="num" id="4590696">2</span><span class="op" id="4590697">)</span><span class="op" id="4590698">%</span><span class="num" id="4590699">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590703">length</span>&nbsp;<span class="op" id="4590710">:=</span>&nbsp;<span class="ident" id="4590713">l</span>&nbsp;<span class="op" id="4590715">+</span>&nbsp;<span class="ident" id="4590717">padding</span>&nbsp;<span class="op" id="4590725">+</span>&nbsp;<span class="num" id="4590727">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590730">x</span>&nbsp;<span class="op" id="4590732">:=</span>&nbsp;<span class="builtinfunc" id="4590735">make</span><span class="op" id="4590739">(</span><span class="op" id="4590740">[</span><span class="op" id="4590741">]</span><span class="builtintype" id="4590742">byte</span><span class="op" id="4590746">,</span>&nbsp;<span class="ident" id="4590748">length</span><span class="op" id="4590754">+</span><span class="num" id="4590755">4</span><span class="op" id="4590756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590759">x</span><span class="op" id="4590760">[</span><span class="num" id="4590761">0</span><span class="op" id="4590762">]</span>&nbsp;<span class="op" id="4590764">=</span>&nbsp;<span class="ident" id="4590766">typeNextProtocol</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590784">x</span><span class="op" id="4590785">[</span><span class="num" id="4590786">1</span><span class="op" id="4590787">]</span>&nbsp;<span class="op" id="4590789">=</span>&nbsp;<span class="builtintype" id="4590791">uint8</span><span class="op" id="4590796">(</span><span class="ident" id="4590797">length</span>&nbsp;<span class="op" id="4590804">&gt;&gt;</span>&nbsp;<span class="num" id="4590807">16</span><span class="op" id="4590809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590812">x</span><span class="op" id="4590813">[</span><span class="num" id="4590814">2</span><span class="op" id="4590815">]</span>&nbsp;<span class="op" id="4590817">=</span>&nbsp;<span class="builtintype" id="4590819">uint8</span><span class="op" id="4590824">(</span><span class="ident" id="4590825">length</span>&nbsp;<span class="op" id="4590832">&gt;&gt;</span>&nbsp;<span class="num" id="4590835">8</span><span class="op" id="4590836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590839">x</span><span class="op" id="4590840">[</span><span class="num" id="4590841">3</span><span class="op" id="4590842">]</span>&nbsp;<span class="op" id="4590844">=</span>&nbsp;<span class="builtintype" id="4590846">uint8</span><span class="op" id="4590851">(</span><span class="ident" id="4590852">length</span><span class="op" id="4590858">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590862">y</span>&nbsp;<span class="op" id="4590864">:=</span>&nbsp;<span class="ident" id="4590867">x</span><span class="op" id="4590868">[</span><span class="num" id="4590869">4</span><span class="op" id="4590870">:</span><span class="op" id="4590871">]</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590874">y</span><span class="op" id="4590875">[</span><span class="num" id="4590876">0</span><span class="op" id="4590877">]</span>&nbsp;<span class="op" id="4590879">=</span>&nbsp;<span class="builtintype" id="4590881">byte</span><span class="op" id="4590885">(</span><span class="ident" id="4590886">l</span><span class="op" id="4590887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4590890">copy</span><span class="op" id="4590894">(</span><span class="ident" id="4590895">y</span><span class="op" id="4590896">[</span><span class="num" id="4590897">1</span><span class="op" id="4590898">:</span><span class="op" id="4590899">]</span><span class="op" id="4590900">,</span>&nbsp;<span class="op" id="4590902">[</span><span class="op" id="4590903">]</span><span class="builtintype" id="4590904">byte</span><span class="op" id="4590908">(</span><span class="ident" id="4590909">m</span><span class="op" id="4590910">.</span><span class="ident" id="4590911">proto</span><span class="op" id="4590916">[</span><span class="num" id="4590917">0</span><span class="op" id="4590918">:</span><span class="ident" id="4590919">l</span><span class="op" id="4590920">]</span><span class="op" id="4590921">)</span><span class="op" id="4590922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590925">y</span>&nbsp;<span class="op" id="4590927">=</span>&nbsp;<span class="ident" id="4590929">y</span><span class="op" id="4590930">[</span><span class="num" id="4590931">1</span><span class="op" id="4590932">+</span><span class="ident" id="4590933">l</span><span class="op" id="4590934">:</span><span class="op" id="4590935">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590938">y</span><span class="op" id="4590939">[</span><span class="num" id="4590940">0</span><span class="op" id="4590941">]</span>&nbsp;<span class="op" id="4590943">=</span>&nbsp;<span class="builtintype" id="4590945">byte</span><span class="op" id="4590949">(</span><span class="ident" id="4590950">padding</span><span class="op" id="4590957">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590961">m</span><span class="op" id="4590962">.</span><span class="ident" id="4590963">raw</span>&nbsp;<span class="op" id="4590967">=</span>&nbsp;<span class="ident" id="4590969">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4590973">return</span>&nbsp;<span class="ident" id="4590980">x</span><br>
<span class="lineno"></span><span class="op" id="4590982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1050</span><span class="keyword" id="4590985">func</span>&nbsp;<span class="op" id="4590990">(</span><span class="ident" id="4590991">m</span>&nbsp;<span class="op" id="4590993">*</span><span class="ident" id="4590994">nextProtoMsg</span><span class="op" id="4591006">)</span>&nbsp;<span class="ident" id="4591008">unmarshal</span><span class="op" id="4591017">(</span><span class="ident" id="4591018">data</span>&nbsp;<span class="op" id="4591023">[</span><span class="op" id="4591024">]</span><span class="builtintype" id="4591025">byte</span><span class="op" id="4591029">)</span>&nbsp;<span class="builtintype" id="4591031">bool</span>&nbsp;<span class="op" id="4591036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4591039">m</span><span class="op" id="4591040">.</span><span class="ident" id="4591041">raw</span>&nbsp;<span class="op" id="4591045">=</span>&nbsp;<span class="ident" id="4591047">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4591054">if</span>&nbsp;<span class="builtinfunc" id="4591057">len</span><span class="op" id="4591060">(</span><span class="ident" id="4591061">data</span><span class="op" id="4591065">)</span>&nbsp;<span class="op" id="4591067">&lt;</span>&nbsp;<span class="num" id="4591069">5</span>&nbsp;<span class="op" id="4591071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4591075">return</span>&nbsp;<span class="builtintype" id="4591082">false</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4591089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4591092">data</span>&nbsp;<span class="op" id="4591097">=</span>&nbsp;<span class="ident" id="4591099">data</span><span class="op" id="4591103">[</span><span class="num" id="4591104">4</span><span class="op" id="4591105">:</span><span class="op" id="4591106">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4591109">protoLen</span>&nbsp;<span class="op" id="4591118">:=</span>&nbsp;<span class="builtintype" id="4591121">int</span><span class="op" id="4591124">(</span><span class="ident" id="4591125">data</span><span class="op" id="4591129">[</span><span class="num" id="4591130">0</span><span class="op" id="4591131">]</span><span class="op" id="4591132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4591135">data</span>&nbsp;<span class="op" id="4591140">=</span>&nbsp;<span class="ident" id="4591142">data</span><span class="op" id="4591146">[</span><span class="num" id="4591147">1</span><span class="op" id="4591148">:</span><span class="op" id="4591149">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4591152">if</span>&nbsp;<span class="builtinfunc" id="4591155">len</span><span class="op" id="4591158">(</span><span class="ident" id="4591159">data</span><span class="op" id="4591163">)</span>&nbsp;<span class="op" id="4591165">&lt;</span>&nbsp;<span class="ident" id="4591167">protoLen</span>&nbsp;<span class="op" id="4591176">{</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4591180">return</span>&nbsp;<span class="builtintype" id="4591187">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4591194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4591197">m</span><span class="op" id="4591198">.</span><span class="ident" id="4591199">proto</span>&nbsp;<span class="op" id="4591205">=</span>&nbsp;<span class="builtintype" id="4591207">string</span><span class="op" id="4591213">(</span><span class="ident" id="4591214">data</span><span class="op" id="4591218">[</span><span class="num" id="4591219">0</span><span class="op" id="4591220">:</span><span class="ident" id="4591221">protoLen</span><span class="op" id="4591229">]</span><span class="op" id="4591230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4591233">data</span>&nbsp;<span class="op" id="4591238">=</span>&nbsp;<span class="ident" id="4591240">data</span><span class="op" id="4591244">[</span><span class="ident" id="4591245">protoLen</span><span class="op" id="4591253">:</span><span class="op" id="4591254">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4591258">if</span>&nbsp;<span class="builtinfunc" id="4591261">len</span><span class="op" id="4591264">(</span><span class="ident" id="4591265">data</span><span class="op" id="4591269">)</span>&nbsp;<span class="op" id="4591271">&lt;</span>&nbsp;<span class="num" id="4591273">1</span>&nbsp;<span class="op" id="4591275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4591279">return</span>&nbsp;<span class="builtintype" id="4591286">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4591293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4591296">paddingLen</span>&nbsp;<span class="op" id="4591307">:=</span>&nbsp;<span class="builtintype" id="4591310">int</span><span class="op" id="4591313">(</span><span class="ident" id="4591314">data</span><span class="op" id="4591318">[</span><span class="num" id="4591319">0</span><span class="op" id="4591320">]</span><span class="op" id="4591321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4591324">data</span>&nbsp;<span class="op" id="4591329">=</span>&nbsp;<span class="ident" id="4591331">data</span><span class="op" id="4591335">[</span><span class="num" id="4591336">1</span><span class="op" id="4591337">:</span><span class="op" id="4591338">]</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4591341">if</span>&nbsp;<span class="builtinfunc" id="4591344">len</span><span class="op" id="4591347">(</span><span class="ident" id="4591348">data</span><span class="op" id="4591352">)</span>&nbsp;<span class="op" id="4591354">!=</span>&nbsp;<span class="ident" id="4591357">paddingLen</span>&nbsp;<span class="op" id="4591368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4591372">return</span>&nbsp;<span class="builtintype" id="4591379">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4591386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4591390">return</span>&nbsp;<span class="builtintype" id="4591397">true</span><br>
<span class="lineno">1075</span><span class="op" id="4591402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4591405">type</span>&nbsp;<span class="ident" id="4591410">certificateRequestMsg</span>&nbsp;<span class="keyword" id="4591432">struct</span>&nbsp;<span class="op" id="4591439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4591442">raw</span>&nbsp;<span class="op" id="4591446">[</span><span class="op" id="4591447">]</span><span class="builtintype" id="4591448">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4591454">//&nbsp;hasSignatureAndHash&nbsp;indicates&nbsp;whether&nbsp;this&nbsp;message&nbsp;includes&nbsp;a&nbsp;list</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4591525">//&nbsp;of&nbsp;signature&nbsp;and&nbsp;hash&nbsp;functions.&nbsp;This&nbsp;change&nbsp;was&nbsp;introduced&nbsp;with&nbsp;TLS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4591598">//&nbsp;1.2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4591607">hasSignatureAndHash</span>&nbsp;<span class="builtintype" id="4591627">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4591634">certificateTypes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4591657">[</span><span class="op" id="4591658">]</span><span class="builtintype" id="4591659">byte</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4591665">signatureAndHashes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4591688">[</span><span class="op" id="4591689">]</span><span class="ident" id="4591690">signatureAndHash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4591708">certificateAuthorities</span>&nbsp;<span class="op" id="4591731">[</span><span class="op" id="4591732">]</span><span class="op" id="4591733">[</span><span class="op" id="4591734">]</span><span class="builtintype" id="4591735">byte</span><br>
<span class="lineno"></span><span class="op" id="4591740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4591743">func</span>&nbsp;<span class="op" id="4591748">(</span><span class="ident" id="4591749">m</span>&nbsp;<span class="op" id="4591751">*</span><span class="ident" id="4591752">certificateRequestMsg</span><span class="op" id="4591773">)</span>&nbsp;<span class="ident" id="4591775">equal</span><span class="op" id="4591780">(</span><span class="ident" id="4591781">i</span>&nbsp;<span class="keyword" id="4591783">interface</span><span class="op" id="4591792">{</span><span class="op" id="4591793">}</span><span class="op" id="4591794">)</span>&nbsp;<span class="builtintype" id="4591796">bool</span>&nbsp;<span class="op" id="4591801">{</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4591804">m1</span><span class="op" id="4591806">,</span>&nbsp;<span class="ident" id="4591808">ok</span>&nbsp;<span class="op" id="4591811">:=</span>&nbsp;<span class="ident" id="4591814">i</span><span class="op" id="4591815">.</span><span class="op" id="4591816">(</span><span class="op" id="4591817">*</span><span class="ident" id="4591818">certificateRequestMsg</span><span class="op" id="4591839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4591842">if</span>&nbsp;<span class="op" id="4591845">!</span><span class="ident" id="4591846">ok</span>&nbsp;<span class="op" id="4591849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4591853">return</span>&nbsp;<span class="builtintype" id="4591860">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4591867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4591871">return</span>&nbsp;<span class="ident" id="4591878">bytes</span><span class="op" id="4591883">.</span><span class="ident" id="4591884">Equal</span><span class="op" id="4591889">(</span><span class="ident" id="4591890">m</span><span class="op" id="4591891">.</span><span class="ident" id="4591892">raw</span><span class="op" id="4591895">,</span>&nbsp;<span class="ident" id="4591897">m1</span><span class="op" id="4591899">.</span><span class="ident" id="4591900">raw</span><span class="op" id="4591903">)</span>&nbsp;<span class="op" id="4591905">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4591910">bytes</span><span class="op" id="4591915">.</span><span class="ident" id="4591916">Equal</span><span class="op" id="4591921">(</span><span class="ident" id="4591922">m</span><span class="op" id="4591923">.</span><span class="ident" id="4591924">certificateTypes</span><span class="op" id="4591940">,</span>&nbsp;<span class="ident" id="4591942">m1</span><span class="op" id="4591944">.</span><span class="ident" id="4591945">certificateTypes</span><span class="op" id="4591961">)</span>&nbsp;<span class="op" id="4591963">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4591968">eqByteSlices</span><span class="op" id="4591980">(</span><span class="ident" id="4591981">m</span><span class="op" id="4591982">.</span><span class="ident" id="4591983">certificateAuthorities</span><span class="op" id="4592005">,</span>&nbsp;<span class="ident" id="4592007">m1</span><span class="op" id="4592009">.</span><span class="ident" id="4592010">certificateAuthorities</span><span class="op" id="4592032">)</span>&nbsp;<span class="op" id="4592034">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4592039">eqSignatureAndHashes</span><span class="op" id="4592059">(</span><span class="ident" id="4592060">m</span><span class="op" id="4592061">.</span><span class="ident" id="4592062">signatureAndHashes</span><span class="op" id="4592080">,</span>&nbsp;<span class="ident" id="4592082">m1</span><span class="op" id="4592084">.</span><span class="ident" id="4592085">signatureAndHashes</span><span class="op" id="4592103">)</span><br>
<span class="lineno"></span><span class="op" id="4592105">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span><span class="keyword" id="4592108">func</span>&nbsp;<span class="op" id="4592113">(</span><span class="ident" id="4592114">m</span>&nbsp;<span class="op" id="4592116">*</span><span class="ident" id="4592117">certificateRequestMsg</span><span class="op" id="4592138">)</span>&nbsp;<span class="ident" id="4592140">marshal</span><span class="op" id="4592147">(</span><span class="op" id="4592148">)</span>&nbsp;<span class="op" id="4592150">(</span><span class="ident" id="4592151">x</span>&nbsp;<span class="op" id="4592153">[</span><span class="op" id="4592154">]</span><span class="builtintype" id="4592155">byte</span><span class="op" id="4592159">)</span>&nbsp;<span class="op" id="4592161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4592164">if</span>&nbsp;<span class="ident" id="4592167">m</span><span class="op" id="4592168">.</span><span class="ident" id="4592169">raw</span>&nbsp;<span class="op" id="4592173">!=</span>&nbsp;<span class="ident" id="4592176">nil</span>&nbsp;<span class="op" id="4592180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4592184">return</span>&nbsp;<span class="ident" id="4592191">m</span><span class="op" id="4592192">.</span><span class="ident" id="4592193">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4592198">}</span><br>
<span class="lineno">1105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4592202">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc4346#section-7.4.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4592259">length</span>&nbsp;<span class="op" id="4592266">:=</span>&nbsp;<span class="num" id="4592269">1</span>&nbsp;<span class="op" id="4592271">+</span>&nbsp;<span class="builtinfunc" id="4592273">len</span><span class="op" id="4592276">(</span><span class="ident" id="4592277">m</span><span class="op" id="4592278">.</span><span class="ident" id="4592279">certificateTypes</span><span class="op" id="4592295">)</span>&nbsp;<span class="op" id="4592297">+</span>&nbsp;<span class="num" id="4592299">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4592302">casLength</span>&nbsp;<span class="op" id="4592312">:=</span>&nbsp;<span class="num" id="4592315">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4592318">for</span>&nbsp;<span class="ident" id="4592322">_</span><span class="op" id="4592323">,</span>&nbsp;<span class="ident" id="4592325">ca</span>&nbsp;<span class="op" id="4592328">:=</span>&nbsp;<span class="keyword" id="4592331">range</span>&nbsp;<span class="ident" id="4592337">m</span><span class="op" id="4592338">.</span><span class="ident" id="4592339">certificateAuthorities</span>&nbsp;<span class="op" id="4592362">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4592366">casLength</span>&nbsp;<span class="op" id="4592376">+=</span>&nbsp;<span class="num" id="4592379">2</span>&nbsp;<span class="op" id="4592381">+</span>&nbsp;<span class="builtinfunc" id="4592383">len</span><span class="op" id="4592386">(</span><span class="ident" id="4592387">ca</span><span class="op" id="4592389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4592392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4592395">length</span>&nbsp;<span class="op" id="4592402">+=</span>&nbsp;<span class="ident" id="4592405">casLength</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4592417">if</span>&nbsp;<span class="ident" id="4592420">m</span><span class="op" id="4592421">.</span><span class="ident" id="4592422">hasSignatureAndHash</span>&nbsp;<span class="op" id="4592442">{</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4592446">length</span>&nbsp;<span class="op" id="4592453">+=</span>&nbsp;<span class="num" id="4592456">2</span>&nbsp;<span class="op" id="4592458">+</span>&nbsp;<span class="num" id="4592460">2</span><span class="op" id="4592461">*</span><span class="builtinfunc" id="4592462">len</span><span class="op" id="4592465">(</span><span class="ident" id="4592466">m</span><span class="op" id="4592467">.</span><span class="ident" id="4592468">signatureAndHashes</span><span class="op" id="4592486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4592489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4592493">x</span>&nbsp;<span class="op" id="4592495">=</span>&nbsp;<span class="builtinfunc" id="4592497">make</span><span class="op" id="4592501">(</span><span class="op" id="4592502">[</span><span class="op" id="4592503">]</span><span class="builtintype" id="4592504">byte</span><span class="op" id="4592508">,</span>&nbsp;<span class="num" id="4592510">4</span><span class="op" id="4592511">+</span><span class="ident" id="4592512">length</span><span class="op" id="4592518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4592521">x</span><span class="op" id="4592522">[</span><span class="num" id="4592523">0</span><span class="op" id="4592524">]</span>&nbsp;<span class="op" id="4592526">=</span>&nbsp;<span class="ident" id="4592528">typeCertificateRequest</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4592552">x</span><span class="op" id="4592553">[</span><span class="num" id="4592554">1</span><span class="op" id="4592555">]</span>&nbsp;<span class="op" id="4592557">=</span>&nbsp;<span class="builtintype" id="4592559">uint8</span><span class="op" id="4592564">(</span><span class="ident" id="4592565">length</span>&nbsp;<span class="op" id="4592572">&gt;&gt;</span>&nbsp;<span class="num" id="4592575">16</span><span class="op" id="4592577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4592580">x</span><span class="op" id="4592581">[</span><span class="num" id="4592582">2</span><span class="op" id="4592583">]</span>&nbsp;<span class="op" id="4592585">=</span>&nbsp;<span class="builtintype" id="4592587">uint8</span><span class="op" id="4592592">(</span><span class="ident" id="4592593">length</span>&nbsp;<span class="op" id="4592600">&gt;&gt;</span>&nbsp;<span class="num" id="4592603">8</span><span class="op" id="4592604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4592607">x</span><span class="op" id="4592608">[</span><span class="num" id="4592609">3</span><span class="op" id="4592610">]</span>&nbsp;<span class="op" id="4592612">=</span>&nbsp;<span class="builtintype" id="4592614">uint8</span><span class="op" id="4592619">(</span><span class="ident" id="4592620">length</span><span class="op" id="4592626">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4592630">x</span><span class="op" id="4592631">[</span><span class="num" id="4592632">4</span><span class="op" id="4592633">]</span>&nbsp;<span class="op" id="4592635">=</span>&nbsp;<span class="builtintype" id="4592637">uint8</span><span class="op" id="4592642">(</span><span class="builtinfunc" id="4592643">len</span><span class="op" id="4592646">(</span><span class="ident" id="4592647">m</span><span class="op" id="4592648">.</span><span class="ident" id="4592649">certificateTypes</span><span class="op" id="4592665">)</span><span class="op" id="4592666">)</span><br>
<span class="lineno">1125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4592670">copy</span><span class="op" id="4592674">(</span><span class="ident" id="4592675">x</span><span class="op" id="4592676">[</span><span class="num" id="4592677">5</span><span class="op" id="4592678">:</span><span class="op" id="4592679">]</span><span class="op" id="4592680">,</span>&nbsp;<span class="ident" id="4592682">m</span><span class="op" id="4592683">.</span><span class="ident" id="4592684">certificateTypes</span><span class="op" id="4592700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4592703">y</span>&nbsp;<span class="op" id="4592705">:=</span>&nbsp;<span class="ident" id="4592708">x</span><span class="op" id="4592709">[</span><span class="num" id="4592710">5</span><span class="op" id="4592711">+</span><span class="builtinfunc" id="4592712">len</span><span class="op" id="4592715">(</span><span class="ident" id="4592716">m</span><span class="op" id="4592717">.</span><span class="ident" id="4592718">certificateTypes</span><span class="op" id="4592734">)</span><span class="op" id="4592735">:</span><span class="op" id="4592736">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4592740">if</span>&nbsp;<span class="ident" id="4592743">m</span><span class="op" id="4592744">.</span><span class="ident" id="4592745">hasSignatureAndHash</span>&nbsp;<span class="op" id="4592765">{</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4592769">n</span>&nbsp;<span class="op" id="4592771">:=</span>&nbsp;<span class="builtinfunc" id="4592774">len</span><span class="op" id="4592777">(</span><span class="ident" id="4592778">m</span><span class="op" id="4592779">.</span><span class="ident" id="4592780">signatureAndHashes</span><span class="op" id="4592798">)</span>&nbsp;<span class="op" id="4592800">*</span>&nbsp;<span class="num" id="4592802">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4592806">y</span><span class="op" id="4592807">[</span><span class="num" id="4592808">0</span><span class="op" id="4592809">]</span>&nbsp;<span class="op" id="4592811">=</span>&nbsp;<span class="builtintype" id="4592813">uint8</span><span class="op" id="4592818">(</span><span class="ident" id="4592819">n</span>&nbsp;<span class="op" id="4592821">&gt;&gt;</span>&nbsp;<span class="num" id="4592824">8</span><span class="op" id="4592825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4592829">y</span><span class="op" id="4592830">[</span><span class="num" id="4592831">1</span><span class="op" id="4592832">]</span>&nbsp;<span class="op" id="4592834">=</span>&nbsp;<span class="builtintype" id="4592836">uint8</span><span class="op" id="4592841">(</span><span class="ident" id="4592842">n</span><span class="op" id="4592843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4592847">y</span>&nbsp;<span class="op" id="4592849">=</span>&nbsp;<span class="ident" id="4592851">y</span><span class="op" id="4592852">[</span><span class="num" id="4592853">2</span><span class="op" id="4592854">:</span><span class="op" id="4592855">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4592859">for</span>&nbsp;<span class="ident" id="4592863">_</span><span class="op" id="4592864">,</span>&nbsp;<span class="ident" id="4592866">sigAndHash</span>&nbsp;<span class="op" id="4592877">:=</span>&nbsp;<span class="keyword" id="4592880">range</span>&nbsp;<span class="ident" id="4592886">m</span><span class="op" id="4592887">.</span><span class="ident" id="4592888">signatureAndHashes</span>&nbsp;<span class="op" id="4592907">{</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4592912">y</span><span class="op" id="4592913">[</span><span class="num" id="4592914">0</span><span class="op" id="4592915">]</span>&nbsp;<span class="op" id="4592917">=</span>&nbsp;<span class="ident" id="4592919">sigAndHash</span><span class="op" id="4592929">.</span><span class="ident" id="4592930">hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4592938">y</span><span class="op" id="4592939">[</span><span class="num" id="4592940">1</span><span class="op" id="4592941">]</span>&nbsp;<span class="op" id="4592943">=</span>&nbsp;<span class="ident" id="4592945">sigAndHash</span><span class="op" id="4592955">.</span><span class="ident" id="4592956">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4592969">y</span>&nbsp;<span class="op" id="4592971">=</span>&nbsp;<span class="ident" id="4592973">y</span><span class="op" id="4592974">[</span><span class="num" id="4592975">2</span><span class="op" id="4592976">:</span><span class="op" id="4592977">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4592981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4592984">}</span><br>
<span class="lineno">1140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4592988">y</span><span class="op" id="4592989">[</span><span class="num" id="4592990">0</span><span class="op" id="4592991">]</span>&nbsp;<span class="op" id="4592993">=</span>&nbsp;<span class="builtintype" id="4592995">uint8</span><span class="op" id="4593000">(</span><span class="ident" id="4593001">casLength</span>&nbsp;<span class="op" id="4593011">&gt;&gt;</span>&nbsp;<span class="num" id="4593014">8</span><span class="op" id="4593015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4593018">y</span><span class="op" id="4593019">[</span><span class="num" id="4593020">1</span><span class="op" id="4593021">]</span>&nbsp;<span class="op" id="4593023">=</span>&nbsp;<span class="builtintype" id="4593025">uint8</span><span class="op" id="4593030">(</span><span class="ident" id="4593031">casLength</span><span class="op" id="4593040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4593043">y</span>&nbsp;<span class="op" id="4593045">=</span>&nbsp;<span class="ident" id="4593047">y</span><span class="op" id="4593048">[</span><span class="num" id="4593049">2</span><span class="op" id="4593050">:</span><span class="op" id="4593051">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4593054">for</span>&nbsp;<span class="ident" id="4593058">_</span><span class="op" id="4593059">,</span>&nbsp;<span class="ident" id="4593061">ca</span>&nbsp;<span class="op" id="4593064">:=</span>&nbsp;<span class="keyword" id="4593067">range</span>&nbsp;<span class="ident" id="4593073">m</span><span class="op" id="4593074">.</span><span class="ident" id="4593075">certificateAuthorities</span>&nbsp;<span class="op" id="4593098">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4593102">y</span><span class="op" id="4593103">[</span><span class="num" id="4593104">0</span><span class="op" id="4593105">]</span>&nbsp;<span class="op" id="4593107">=</span>&nbsp;<span class="builtintype" id="4593109">uint8</span><span class="op" id="4593114">(</span><span class="builtinfunc" id="4593115">len</span><span class="op" id="4593118">(</span><span class="ident" id="4593119">ca</span><span class="op" id="4593121">)</span>&nbsp;<span class="op" id="4593123">&gt;&gt;</span>&nbsp;<span class="num" id="4593126">8</span><span class="op" id="4593127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4593131">y</span><span class="op" id="4593132">[</span><span class="num" id="4593133">1</span><span class="op" id="4593134">]</span>&nbsp;<span class="op" id="4593136">=</span>&nbsp;<span class="builtintype" id="4593138">uint8</span><span class="op" id="4593143">(</span><span class="builtinfunc" id="4593144">len</span><span class="op" id="4593147">(</span><span class="ident" id="4593148">ca</span><span class="op" id="4593150">)</span><span class="op" id="4593151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4593155">y</span>&nbsp;<span class="op" id="4593157">=</span>&nbsp;<span class="ident" id="4593159">y</span><span class="op" id="4593160">[</span><span class="num" id="4593161">2</span><span class="op" id="4593162">:</span><span class="op" id="4593163">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4593167">copy</span><span class="op" id="4593171">(</span><span class="ident" id="4593172">y</span><span class="op" id="4593173">,</span>&nbsp;<span class="ident" id="4593175">ca</span><span class="op" id="4593177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4593181">y</span>&nbsp;<span class="op" id="4593183">=</span>&nbsp;<span class="ident" id="4593185">y</span><span class="op" id="4593186">[</span><span class="builtinfunc" id="4593187">len</span><span class="op" id="4593190">(</span><span class="ident" id="4593191">ca</span><span class="op" id="4593193">)</span><span class="op" id="4593194">:</span><span class="op" id="4593195">]</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4593198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4593202">m</span><span class="op" id="4593203">.</span><span class="ident" id="4593204">raw</span>&nbsp;<span class="op" id="4593208">=</span>&nbsp;<span class="ident" id="4593210">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4593213">return</span><br>
<span class="lineno"></span><span class="op" id="4593220">}</span><br>
<span class="lineno">1155</span><br>
<span class="lineno"></span><span class="keyword" id="4593223">func</span>&nbsp;<span class="op" id="4593228">(</span><span class="ident" id="4593229">m</span>&nbsp;<span class="op" id="4593231">*</span><span class="ident" id="4593232">certificateRequestMsg</span><span class="op" id="4593253">)</span>&nbsp;<span class="ident" id="4593255">unmarshal</span><span class="op" id="4593264">(</span><span class="ident" id="4593265">data</span>&nbsp;<span class="op" id="4593270">[</span><span class="op" id="4593271">]</span><span class="builtintype" id="4593272">byte</span><span class="op" id="4593276">)</span>&nbsp;<span class="builtintype" id="4593278">bool</span>&nbsp;<span class="op" id="4593283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4593286">m</span><span class="op" id="4593287">.</span><span class="ident" id="4593288">raw</span>&nbsp;<span class="op" id="4593292">=</span>&nbsp;<span class="ident" id="4593294">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4593301">if</span>&nbsp;<span class="builtinfunc" id="4593304">len</span><span class="op" id="4593307">(</span><span class="ident" id="4593308">data</span><span class="op" id="4593312">)</span>&nbsp;<span class="op" id="4593314">&lt;</span>&nbsp;<span class="num" id="4593316">5</span>&nbsp;<span class="op" id="4593318">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4593322">return</span>&nbsp;<span class="builtintype" id="4593329">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4593336">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4593340">length</span>&nbsp;<span class="op" id="4593347">:=</span>&nbsp;<span class="builtintype" id="4593350">uint32</span><span class="op" id="4593356">(</span><span class="ident" id="4593357">data</span><span class="op" id="4593361">[</span><span class="num" id="4593362">1</span><span class="op" id="4593363">]</span><span class="op" id="4593364">)</span><span class="op" id="4593365">&lt;&lt;</span><span class="num" id="4593367">16</span>&nbsp;<span class="op" id="4593370">|</span>&nbsp;<span class="builtintype" id="4593372">uint32</span><span class="op" id="4593378">(</span><span class="ident" id="4593379">data</span><span class="op" id="4593383">[</span><span class="num" id="4593384">2</span><span class="op" id="4593385">]</span><span class="op" id="4593386">)</span><span class="op" id="4593387">&lt;&lt;</span><span class="num" id="4593389">8</span>&nbsp;<span class="op" id="4593391">|</span>&nbsp;<span class="builtintype" id="4593393">uint32</span><span class="op" id="4593399">(</span><span class="ident" id="4593400">data</span><span class="op" id="4593404">[</span><span class="num" id="4593405">3</span><span class="op" id="4593406">]</span><span class="op" id="4593407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4593410">if</span>&nbsp;<span class="builtintype" id="4593413">uint32</span><span class="op" id="4593419">(</span><span class="builtinfunc" id="4593420">len</span><span class="op" id="4593423">(</span><span class="ident" id="4593424">data</span><span class="op" id="4593428">)</span><span class="op" id="4593429">)</span><span class="op" id="4593430">-</span><span class="num" id="4593431">4</span>&nbsp;<span class="op" id="4593433">!=</span>&nbsp;<span class="ident" id="4593436">length</span>&nbsp;<span class="op" id="4593443">{</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4593447">return</span>&nbsp;<span class="builtintype" id="4593454">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4593461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4593465">numCertTypes</span>&nbsp;<span class="op" id="4593478">:=</span>&nbsp;<span class="builtintype" id="4593481">int</span><span class="op" id="4593484">(</span><span class="ident" id="4593485">data</span><span class="op" id="4593489">[</span><span class="num" id="4593490">4</span><span class="op" id="4593491">]</span><span class="op" id="4593492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4593495">data</span>&nbsp;<span class="op" id="4593500">=</span>&nbsp;<span class="ident" id="4593502">data</span><span class="op" id="4593506">[</span><span class="num" id="4593507">5</span><span class="op" id="4593508">:</span><span class="op" id="4593509">]</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4593512">if</span>&nbsp;<span class="ident" id="4593515">numCertTypes</span>&nbsp;<span class="op" id="4593528">==</span>&nbsp;<span class="num" id="4593531">0</span>&nbsp;<span class="op" id="4593533">||</span>&nbsp;<span class="builtinfunc" id="4593536">len</span><span class="op" id="4593539">(</span><span class="ident" id="4593540">data</span><span class="op" id="4593544">)</span>&nbsp;<span class="op" id="4593546">&lt;=</span>&nbsp;<span class="ident" id="4593549">numCertTypes</span>&nbsp;<span class="op" id="4593562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4593566">return</span>&nbsp;<span class="builtintype" id="4593573">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4593580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4593584">m</span><span class="op" id="4593585">.</span><span class="ident" id="4593586">certificateTypes</span>&nbsp;<span class="op" id="4593603">=</span>&nbsp;<span class="builtinfunc" id="4593605">make</span><span class="op" id="4593609">(</span><span class="op" id="4593610">[</span><span class="op" id="4593611">]</span><span class="builtintype" id="4593612">byte</span><span class="op" id="4593616">,</span>&nbsp;<span class="ident" id="4593618">numCertTypes</span><span class="op" id="4593630">)</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4593633">if</span>&nbsp;<span class="builtinfunc" id="4593636">copy</span><span class="op" id="4593640">(</span><span class="ident" id="4593641">m</span><span class="op" id="4593642">.</span><span class="ident" id="4593643">certificateTypes</span><span class="op" id="4593659">,</span>&nbsp;<span class="ident" id="4593661">data</span><span class="op" id="4593665">)</span>&nbsp;<span class="op" id="4593667">!=</span>&nbsp;<span class="ident" id="4593670">numCertTypes</span>&nbsp;<span class="op" id="4593683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4593687">return</span>&nbsp;<span class="builtintype" id="4593694">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4593701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4593705">data</span>&nbsp;<span class="op" id="4593710">=</span>&nbsp;<span class="ident" id="4593712">data</span><span class="op" id="4593716">[</span><span class="ident" id="4593717">numCertTypes</span><span class="op" id="4593729">:</span><span class="op" id="4593730">]</span><br>
<span class="lineno">1180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4593734">if</span>&nbsp;<span class="ident" id="4593737">m</span><span class="op" id="4593738">.</span><span class="ident" id="4593739">hasSignatureAndHash</span>&nbsp;<span class="op" id="4593759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4593763">if</span>&nbsp;<span class="builtinfunc" id="4593766">len</span><span class="op" id="4593769">(</span><span class="ident" id="4593770">data</span><span class="op" id="4593774">)</span>&nbsp;<span class="op" id="4593776">&lt;</span>&nbsp;<span class="num" id="4593778">2</span>&nbsp;<span class="op" id="4593780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4593785">return</span>&nbsp;<span class="builtintype" id="4593792">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4593800">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4593804">sigAndHashLen</span>&nbsp;<span class="op" id="4593818">:=</span>&nbsp;<span class="builtintype" id="4593821">uint16</span><span class="op" id="4593827">(</span><span class="ident" id="4593828">data</span><span class="op" id="4593832">[</span><span class="num" id="4593833">0</span><span class="op" id="4593834">]</span><span class="op" id="4593835">)</span><span class="op" id="4593836">&lt;&lt;</span><span class="num" id="4593838">8</span>&nbsp;<span class="op" id="4593840">|</span>&nbsp;<span class="builtintype" id="4593842">uint16</span><span class="op" id="4593848">(</span><span class="ident" id="4593849">data</span><span class="op" id="4593853">[</span><span class="num" id="4593854">1</span><span class="op" id="4593855">]</span><span class="op" id="4593856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4593860">data</span>&nbsp;<span class="op" id="4593865">=</span>&nbsp;<span class="ident" id="4593867">data</span><span class="op" id="4593871">[</span><span class="num" id="4593872">2</span><span class="op" id="4593873">:</span><span class="op" id="4593874">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4593878">if</span>&nbsp;<span class="ident" id="4593881">sigAndHashLen</span><span class="op" id="4593894">&amp;</span><span class="num" id="4593895">1</span>&nbsp;<span class="op" id="4593897">!=</span>&nbsp;<span class="num" id="4593900">0</span>&nbsp;<span class="op" id="4593902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4593907">return</span>&nbsp;<span class="builtintype" id="4593914">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4593922">}</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4593926">if</span>&nbsp;<span class="builtinfunc" id="4593929">len</span><span class="op" id="4593932">(</span><span class="ident" id="4593933">data</span><span class="op" id="4593937">)</span>&nbsp;<span class="op" id="4593939">&lt;</span>&nbsp;<span class="builtintype" id="4593941">int</span><span class="op" id="4593944">(</span><span class="ident" id="4593945">sigAndHashLen</span><span class="op" id="4593958">)</span>&nbsp;<span class="op" id="4593960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4593965">return</span>&nbsp;<span class="builtintype" id="4593972">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4593980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4593984">numSigAndHash</span>&nbsp;<span class="op" id="4593998">:=</span>&nbsp;<span class="ident" id="4594001">sigAndHashLen</span>&nbsp;<span class="op" id="4594015">/</span>&nbsp;<span class="num" id="4594017">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4594021">m</span><span class="op" id="4594022">.</span><span class="ident" id="4594023">signatureAndHashes</span>&nbsp;<span class="op" id="4594042">=</span>&nbsp;<span class="builtinfunc" id="4594044">make</span><span class="op" id="4594048">(</span><span class="op" id="4594049">[</span><span class="op" id="4594050">]</span><span class="ident" id="4594051">signatureAndHash</span><span class="op" id="4594067">,</span>&nbsp;<span class="ident" id="4594069">numSigAndHash</span><span class="op" id="4594082">)</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4594086">for</span>&nbsp;<span class="ident" id="4594090">i</span>&nbsp;<span class="op" id="4594092">:=</span>&nbsp;<span class="keyword" id="4594095">range</span>&nbsp;<span class="ident" id="4594101">m</span><span class="op" id="4594102">.</span><span class="ident" id="4594103">signatureAndHashes</span>&nbsp;<span class="op" id="4594122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4594127">m</span><span class="op" id="4594128">.</span><span class="ident" id="4594129">signatureAndHashes</span><span class="op" id="4594147">[</span><span class="ident" id="4594148">i</span><span class="op" id="4594149">]</span><span class="op" id="4594150">.</span><span class="ident" id="4594151">hash</span>&nbsp;<span class="op" id="4594156">=</span>&nbsp;<span class="ident" id="4594158">data</span><span class="op" id="4594162">[</span><span class="num" id="4594163">0</span><span class="op" id="4594164">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4594169">m</span><span class="op" id="4594170">.</span><span class="ident" id="4594171">signatureAndHashes</span><span class="op" id="4594189">[</span><span class="ident" id="4594190">i</span><span class="op" id="4594191">]</span><span class="op" id="4594192">.</span><span class="ident" id="4594193">signature</span>&nbsp;<span class="op" id="4594203">=</span>&nbsp;<span class="ident" id="4594205">data</span><span class="op" id="4594209">[</span><span class="num" id="4594210">1</span><span class="op" id="4594211">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4594216">data</span>&nbsp;<span class="op" id="4594221">=</span>&nbsp;<span class="ident" id="4594223">data</span><span class="op" id="4594227">[</span><span class="num" id="4594228">2</span><span class="op" id="4594229">:</span><span class="op" id="4594230">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4594234">}</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4594237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4594241">if</span>&nbsp;<span class="builtinfunc" id="4594244">len</span><span class="op" id="4594247">(</span><span class="ident" id="4594248">data</span><span class="op" id="4594252">)</span>&nbsp;<span class="op" id="4594254">&lt;</span>&nbsp;<span class="num" id="4594256">2</span>&nbsp;<span class="op" id="4594258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4594262">return</span>&nbsp;<span class="builtintype" id="4594269">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4594276">}</span><br>
<span class="lineno">1205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4594279">casLength</span>&nbsp;<span class="op" id="4594289">:=</span>&nbsp;<span class="builtintype" id="4594292">uint16</span><span class="op" id="4594298">(</span><span class="ident" id="4594299">data</span><span class="op" id="4594303">[</span><span class="num" id="4594304">0</span><span class="op" id="4594305">]</span><span class="op" id="4594306">)</span><span class="op" id="4594307">&lt;&lt;</span><span class="num" id="4594309">8</span>&nbsp;<span class="op" id="4594311">|</span>&nbsp;<span class="builtintype" id="4594313">uint16</span><span class="op" id="4594319">(</span><span class="ident" id="4594320">data</span><span class="op" id="4594324">[</span><span class="num" id="4594325">1</span><span class="op" id="4594326">]</span><span class="op" id="4594327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4594330">data</span>&nbsp;<span class="op" id="4594335">=</span>&nbsp;<span class="ident" id="4594337">data</span><span class="op" id="4594341">[</span><span class="num" id="4594342">2</span><span class="op" id="4594343">:</span><span class="op" id="4594344">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4594347">if</span>&nbsp;<span class="builtinfunc" id="4594350">len</span><span class="op" id="4594353">(</span><span class="ident" id="4594354">data</span><span class="op" id="4594358">)</span>&nbsp;<span class="op" id="4594360">&lt;</span>&nbsp;<span class="builtintype" id="4594362">int</span><span class="op" id="4594365">(</span><span class="ident" id="4594366">casLength</span><span class="op" id="4594375">)</span>&nbsp;<span class="op" id="4594377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4594381">return</span>&nbsp;<span class="builtintype" id="4594388">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4594395">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4594398">cas</span>&nbsp;<span class="op" id="4594402">:=</span>&nbsp;<span class="builtinfunc" id="4594405">make</span><span class="op" id="4594409">(</span><span class="op" id="4594410">[</span><span class="op" id="4594411">]</span><span class="builtintype" id="4594412">byte</span><span class="op" id="4594416">,</span>&nbsp;<span class="ident" id="4594418">casLength</span><span class="op" id="4594427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4594430">copy</span><span class="op" id="4594434">(</span><span class="ident" id="4594435">cas</span><span class="op" id="4594438">,</span>&nbsp;<span class="ident" id="4594440">data</span><span class="op" id="4594444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4594447">data</span>&nbsp;<span class="op" id="4594452">=</span>&nbsp;<span class="ident" id="4594454">data</span><span class="op" id="4594458">[</span><span class="ident" id="4594459">casLength</span><span class="op" id="4594468">:</span><span class="op" id="4594469">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4594473">m</span><span class="op" id="4594474">.</span><span class="ident" id="4594475">certificateAuthorities</span>&nbsp;<span class="op" id="4594498">=</span>&nbsp;<span class="ident" id="4594500">nil</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4594505">for</span>&nbsp;<span class="builtinfunc" id="4594509">len</span><span class="op" id="4594512">(</span><span class="ident" id="4594513">cas</span><span class="op" id="4594516">)</span>&nbsp;<span class="op" id="4594518">&gt;</span>&nbsp;<span class="num" id="4594520">0</span>&nbsp;<span class="op" id="4594522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4594526">if</span>&nbsp;<span class="builtinfunc" id="4594529">len</span><span class="op" id="4594532">(</span><span class="ident" id="4594533">cas</span><span class="op" id="4594536">)</span>&nbsp;<span class="op" id="4594538">&lt;</span>&nbsp;<span class="num" id="4594540">2</span>&nbsp;<span class="op" id="4594542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4594547">return</span>&nbsp;<span class="builtintype" id="4594554">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4594562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4594566">caLen</span>&nbsp;<span class="op" id="4594572">:=</span>&nbsp;<span class="builtintype" id="4594575">uint16</span><span class="op" id="4594581">(</span><span class="ident" id="4594582">cas</span><span class="op" id="4594585">[</span><span class="num" id="4594586">0</span><span class="op" id="4594587">]</span><span class="op" id="4594588">)</span><span class="op" id="4594589">&lt;&lt;</span><span class="num" id="4594591">8</span>&nbsp;<span class="op" id="4594593">|</span>&nbsp;<span class="builtintype" id="4594595">uint16</span><span class="op" id="4594601">(</span><span class="ident" id="4594602">cas</span><span class="op" id="4594605">[</span><span class="num" id="4594606">1</span><span class="op" id="4594607">]</span><span class="op" id="4594608">)</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4594612">cas</span>&nbsp;<span class="op" id="4594616">=</span>&nbsp;<span class="ident" id="4594618">cas</span><span class="op" id="4594621">[</span><span class="num" id="4594622">2</span><span class="op" id="4594623">:</span><span class="op" id="4594624">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4594629">if</span>&nbsp;<span class="builtinfunc" id="4594632">len</span><span class="op" id="4594635">(</span><span class="ident" id="4594636">cas</span><span class="op" id="4594639">)</span>&nbsp;<span class="op" id="4594641">&lt;</span>&nbsp;<span class="builtintype" id="4594643">int</span><span class="op" id="4594646">(</span><span class="ident" id="4594647">caLen</span><span class="op" id="4594652">)</span>&nbsp;<span class="op" id="4594654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4594659">return</span>&nbsp;<span class="builtintype" id="4594666">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4594674">}</span><br>
<span class="lineno">1225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4594679">m</span><span class="op" id="4594680">.</span><span class="ident" id="4594681">certificateAuthorities</span>&nbsp;<span class="op" id="4594704">=</span>&nbsp;<span class="builtinfunc" id="4594706">append</span><span class="op" id="4594712">(</span><span class="ident" id="4594713">m</span><span class="op" id="4594714">.</span><span class="ident" id="4594715">certificateAuthorities</span><span class="op" id="4594737">,</span>&nbsp;<span class="ident" id="4594739">cas</span><span class="op" id="4594742">[</span><span class="op" id="4594743">:</span><span class="ident" id="4594744">caLen</span><span class="op" id="4594749">]</span><span class="op" id="4594750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4594754">cas</span>&nbsp;<span class="op" id="4594758">=</span>&nbsp;<span class="ident" id="4594760">cas</span><span class="op" id="4594763">[</span><span class="ident" id="4594764">caLen</span><span class="op" id="4594769">:</span><span class="op" id="4594770">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4594773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4594776">if</span>&nbsp;<span class="builtinfunc" id="4594779">len</span><span class="op" id="4594782">(</span><span class="ident" id="4594783">data</span><span class="op" id="4594787">)</span>&nbsp;<span class="op" id="4594789">&gt;</span>&nbsp;<span class="num" id="4594791">0</span>&nbsp;<span class="op" id="4594793">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4594797">return</span>&nbsp;<span class="builtintype" id="4594804">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4594811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4594815">return</span>&nbsp;<span class="builtintype" id="4594822">true</span><br>
<span class="lineno"></span><span class="op" id="4594827">}</span><br>
<span class="lineno">1235</span><br>
<span class="lineno"></span><span class="keyword" id="4594830">type</span>&nbsp;<span class="ident" id="4594835">certificateVerifyMsg</span>&nbsp;<span class="keyword" id="4594856">struct</span>&nbsp;<span class="op" id="4594863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4594866">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4594886">[</span><span class="op" id="4594887">]</span><span class="builtintype" id="4594888">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4594894">hasSignatureAndHash</span>&nbsp;<span class="builtintype" id="4594914">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4594920">signatureAndHash</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4594940">signatureAndHash</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4594958">signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4594978">[</span><span class="op" id="4594979">]</span><span class="builtintype" id="4594980">byte</span><br>
<span class="lineno"></span><span class="op" id="4594985">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4594988">func</span>&nbsp;<span class="op" id="4594993">(</span><span class="ident" id="4594994">m</span>&nbsp;<span class="op" id="4594996">*</span><span class="ident" id="4594997">certificateVerifyMsg</span><span class="op" id="4595017">)</span>&nbsp;<span class="ident" id="4595019">equal</span><span class="op" id="4595024">(</span><span class="ident" id="4595025">i</span>&nbsp;<span class="keyword" id="4595027">interface</span><span class="op" id="4595036">{</span><span class="op" id="4595037">}</span><span class="op" id="4595038">)</span>&nbsp;<span class="builtintype" id="4595040">bool</span>&nbsp;<span class="op" id="4595045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4595048">m1</span><span class="op" id="4595050">,</span>&nbsp;<span class="ident" id="4595052">ok</span>&nbsp;<span class="op" id="4595055">:=</span>&nbsp;<span class="ident" id="4595058">i</span><span class="op" id="4595059">.</span><span class="op" id="4595060">(</span><span class="op" id="4595061">*</span><span class="ident" id="4595062">certificateVerifyMsg</span><span class="op" id="4595082">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4595085">if</span>&nbsp;<span class="op" id="4595088">!</span><span class="ident" id="4595089">ok</span>&nbsp;<span class="op" id="4595092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4595096">return</span>&nbsp;<span class="builtintype" id="4595103">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4595110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4595114">return</span>&nbsp;<span class="ident" id="4595121">bytes</span><span class="op" id="4595126">.</span><span class="ident" id="4595127">Equal</span><span class="op" id="4595132">(</span><span class="ident" id="4595133">m</span><span class="op" id="4595134">.</span><span class="ident" id="4595135">raw</span><span class="op" id="4595138">,</span>&nbsp;<span class="ident" id="4595140">m1</span><span class="op" id="4595142">.</span><span class="ident" id="4595143">raw</span><span class="op" id="4595146">)</span>&nbsp;<span class="op" id="4595148">&amp;&amp;</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4595153">m</span><span class="op" id="4595154">.</span><span class="ident" id="4595155">hasSignatureAndHash</span>&nbsp;<span class="op" id="4595175">==</span>&nbsp;<span class="ident" id="4595178">m1</span><span class="op" id="4595180">.</span><span class="ident" id="4595181">hasSignatureAndHash</span>&nbsp;<span class="op" id="4595201">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4595206">m</span><span class="op" id="4595207">.</span><span class="ident" id="4595208">signatureAndHash</span><span class="op" id="4595224">.</span><span class="ident" id="4595225">hash</span>&nbsp;<span class="op" id="4595230">==</span>&nbsp;<span class="ident" id="4595233">m1</span><span class="op" id="4595235">.</span><span class="ident" id="4595236">signatureAndHash</span><span class="op" id="4595252">.</span><span class="ident" id="4595253">hash</span>&nbsp;<span class="op" id="4595258">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4595263">m</span><span class="op" id="4595264">.</span><span class="ident" id="4595265">signatureAndHash</span><span class="op" id="4595281">.</span><span class="ident" id="4595282">signature</span>&nbsp;<span class="op" id="4595292">==</span>&nbsp;<span class="ident" id="4595295">m1</span><span class="op" id="4595297">.</span><span class="ident" id="4595298">signatureAndHash</span><span class="op" id="4595314">.</span><span class="ident" id="4595315">signature</span>&nbsp;<span class="op" id="4595325">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4595330">bytes</span><span class="op" id="4595335">.</span><span class="ident" id="4595336">Equal</span><span class="op" id="4595341">(</span><span class="ident" id="4595342">m</span><span class="op" id="4595343">.</span><span class="ident" id="4595344">signature</span><span class="op" id="4595353">,</span>&nbsp;<span class="ident" id="4595355">m1</span><span class="op" id="4595357">.</span><span class="ident" id="4595358">signature</span><span class="op" id="4595367">)</span><br>
<span class="lineno"></span><span class="op" id="4595369">}</span><br>
<span class="lineno">1255</span><br>
<span class="lineno"></span><span class="keyword" id="4595372">func</span>&nbsp;<span class="op" id="4595377">(</span><span class="ident" id="4595378">m</span>&nbsp;<span class="op" id="4595380">*</span><span class="ident" id="4595381">certificateVerifyMsg</span><span class="op" id="4595401">)</span>&nbsp;<span class="ident" id="4595403">marshal</span><span class="op" id="4595410">(</span><span class="op" id="4595411">)</span>&nbsp;<span class="op" id="4595413">(</span><span class="ident" id="4595414">x</span>&nbsp;<span class="op" id="4595416">[</span><span class="op" id="4595417">]</span><span class="builtintype" id="4595418">byte</span><span class="op" id="4595422">)</span>&nbsp;<span class="op" id="4595424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4595427">if</span>&nbsp;<span class="ident" id="4595430">m</span><span class="op" id="4595431">.</span><span class="ident" id="4595432">raw</span>&nbsp;<span class="op" id="4595436">!=</span>&nbsp;<span class="ident" id="4595439">nil</span>&nbsp;<span class="op" id="4595443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4595447">return</span>&nbsp;<span class="ident" id="4595454">m</span><span class="op" id="4595455">.</span><span class="ident" id="4595456">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4595461">}</span><br>
<span class="lineno">1260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4595465">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc4346#section-7.4.8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4595522">siglength</span>&nbsp;<span class="op" id="4595532">:=</span>&nbsp;<span class="builtinfunc" id="4595535">len</span><span class="op" id="4595538">(</span><span class="ident" id="4595539">m</span><span class="op" id="4595540">.</span><span class="ident" id="4595541">signature</span><span class="op" id="4595550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4595553">length</span>&nbsp;<span class="op" id="4595560">:=</span>&nbsp;<span class="num" id="4595563">2</span>&nbsp;<span class="op" id="4595565">+</span>&nbsp;<span class="ident" id="4595567">siglength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4595578">if</span>&nbsp;<span class="ident" id="4595581">m</span><span class="op" id="4595582">.</span><span class="ident" id="4595583">hasSignatureAndHash</span>&nbsp;<span class="op" id="4595603">{</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4595607">length</span>&nbsp;<span class="op" id="4595614">+=</span>&nbsp;<span class="num" id="4595617">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4595620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4595623">x</span>&nbsp;<span class="op" id="4595625">=</span>&nbsp;<span class="builtinfunc" id="4595627">make</span><span class="op" id="4595631">(</span><span class="op" id="4595632">[</span><span class="op" id="4595633">]</span><span class="builtintype" id="4595634">byte</span><span class="op" id="4595638">,</span>&nbsp;<span class="num" id="4595640">4</span><span class="op" id="4595641">+</span><span class="ident" id="4595642">length</span><span class="op" id="4595648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4595651">x</span><span class="op" id="4595652">[</span><span class="num" id="4595653">0</span><span class="op" id="4595654">]</span>&nbsp;<span class="op" id="4595656">=</span>&nbsp;<span class="ident" id="4595658">typeCertificateVerify</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4595681">x</span><span class="op" id="4595682">[</span><span class="num" id="4595683">1</span><span class="op" id="4595684">]</span>&nbsp;<span class="op" id="4595686">=</span>&nbsp;<span class="builtintype" id="4595688">uint8</span><span class="op" id="4595693">(</span><span class="ident" id="4595694">length</span>&nbsp;<span class="op" id="4595701">&gt;&gt;</span>&nbsp;<span class="num" id="4595704">16</span><span class="op" id="4595706">)</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4595709">x</span><span class="op" id="4595710">[</span><span class="num" id="4595711">2</span><span class="op" id="4595712">]</span>&nbsp;<span class="op" id="4595714">=</span>&nbsp;<span class="builtintype" id="4595716">uint8</span><span class="op" id="4595721">(</span><span class="ident" id="4595722">length</span>&nbsp;<span class="op" id="4595729">&gt;&gt;</span>&nbsp;<span class="num" id="4595732">8</span><span class="op" id="4595733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4595736">x</span><span class="op" id="4595737">[</span><span class="num" id="4595738">3</span><span class="op" id="4595739">]</span>&nbsp;<span class="op" id="4595741">=</span>&nbsp;<span class="builtintype" id="4595743">uint8</span><span class="op" id="4595748">(</span><span class="ident" id="4595749">length</span><span class="op" id="4595755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4595758">y</span>&nbsp;<span class="op" id="4595760">:=</span>&nbsp;<span class="ident" id="4595763">x</span><span class="op" id="4595764">[</span><span class="num" id="4595765">4</span><span class="op" id="4595766">:</span><span class="op" id="4595767">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4595770">if</span>&nbsp;<span class="ident" id="4595773">m</span><span class="op" id="4595774">.</span><span class="ident" id="4595775">hasSignatureAndHash</span>&nbsp;<span class="op" id="4595795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4595799">y</span><span class="op" id="4595800">[</span><span class="num" id="4595801">0</span><span class="op" id="4595802">]</span>&nbsp;<span class="op" id="4595804">=</span>&nbsp;<span class="ident" id="4595806">m</span><span class="op" id="4595807">.</span><span class="ident" id="4595808">signatureAndHash</span><span class="op" id="4595824">.</span><span class="ident" id="4595825">hash</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4595832">y</span><span class="op" id="4595833">[</span><span class="num" id="4595834">1</span><span class="op" id="4595835">]</span>&nbsp;<span class="op" id="4595837">=</span>&nbsp;<span class="ident" id="4595839">m</span><span class="op" id="4595840">.</span><span class="ident" id="4595841">signatureAndHash</span><span class="op" id="4595857">.</span><span class="ident" id="4595858">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4595870">y</span>&nbsp;<span class="op" id="4595872">=</span>&nbsp;<span class="ident" id="4595874">y</span><span class="op" id="4595875">[</span><span class="num" id="4595876">2</span><span class="op" id="4595877">:</span><span class="op" id="4595878">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4595881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4595884">y</span><span class="op" id="4595885">[</span><span class="num" id="4595886">0</span><span class="op" id="4595887">]</span>&nbsp;<span class="op" id="4595889">=</span>&nbsp;<span class="builtintype" id="4595891">uint8</span><span class="op" id="4595896">(</span><span class="ident" id="4595897">siglength</span>&nbsp;<span class="op" id="4595907">&gt;&gt;</span>&nbsp;<span class="num" id="4595910">8</span><span class="op" id="4595911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4595914">y</span><span class="op" id="4595915">[</span><span class="num" id="4595916">1</span><span class="op" id="4595917">]</span>&nbsp;<span class="op" id="4595919">=</span>&nbsp;<span class="builtintype" id="4595921">uint8</span><span class="op" id="4595926">(</span><span class="ident" id="4595927">siglength</span><span class="op" id="4595936">)</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4595939">copy</span><span class="op" id="4595943">(</span><span class="ident" id="4595944">y</span><span class="op" id="4595945">[</span><span class="num" id="4595946">2</span><span class="op" id="4595947">:</span><span class="op" id="4595948">]</span><span class="op" id="4595949">,</span>&nbsp;<span class="ident" id="4595951">m</span><span class="op" id="4595952">.</span><span class="ident" id="4595953">signature</span><span class="op" id="4595962">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4595966">m</span><span class="op" id="4595967">.</span><span class="ident" id="4595968">raw</span>&nbsp;<span class="op" id="4595972">=</span>&nbsp;<span class="ident" id="4595974">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4595978">return</span><br>
<span class="lineno">1285</span><span class="op" id="4595985">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4595988">func</span>&nbsp;<span class="op" id="4595993">(</span><span class="ident" id="4595994">m</span>&nbsp;<span class="op" id="4595996">*</span><span class="ident" id="4595997">certificateVerifyMsg</span><span class="op" id="4596017">)</span>&nbsp;<span class="ident" id="4596019">unmarshal</span><span class="op" id="4596028">(</span><span class="ident" id="4596029">data</span>&nbsp;<span class="op" id="4596034">[</span><span class="op" id="4596035">]</span><span class="builtintype" id="4596036">byte</span><span class="op" id="4596040">)</span>&nbsp;<span class="builtintype" id="4596042">bool</span>&nbsp;<span class="op" id="4596047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4596050">m</span><span class="op" id="4596051">.</span><span class="ident" id="4596052">raw</span>&nbsp;<span class="op" id="4596056">=</span>&nbsp;<span class="ident" id="4596058">data</span><br>
<span class="lineno"></span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4596065">if</span>&nbsp;<span class="builtinfunc" id="4596068">len</span><span class="op" id="4596071">(</span><span class="ident" id="4596072">data</span><span class="op" id="4596076">)</span>&nbsp;<span class="op" id="4596078">&lt;</span>&nbsp;<span class="num" id="4596080">6</span>&nbsp;<span class="op" id="4596082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4596086">return</span>&nbsp;<span class="builtintype" id="4596093">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4596100">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4596104">length</span>&nbsp;<span class="op" id="4596111">:=</span>&nbsp;<span class="builtintype" id="4596114">uint32</span><span class="op" id="4596120">(</span><span class="ident" id="4596121">data</span><span class="op" id="4596125">[</span><span class="num" id="4596126">1</span><span class="op" id="4596127">]</span><span class="op" id="4596128">)</span><span class="op" id="4596129">&lt;&lt;</span><span class="num" id="4596131">16</span>&nbsp;<span class="op" id="4596134">|</span>&nbsp;<span class="builtintype" id="4596136">uint32</span><span class="op" id="4596142">(</span><span class="ident" id="4596143">data</span><span class="op" id="4596147">[</span><span class="num" id="4596148">2</span><span class="op" id="4596149">]</span><span class="op" id="4596150">)</span><span class="op" id="4596151">&lt;&lt;</span><span class="num" id="4596153">8</span>&nbsp;<span class="op" id="4596155">|</span>&nbsp;<span class="builtintype" id="4596157">uint32</span><span class="op" id="4596163">(</span><span class="ident" id="4596164">data</span><span class="op" id="4596168">[</span><span class="num" id="4596169">3</span><span class="op" id="4596170">]</span><span class="op" id="4596171">)</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4596174">if</span>&nbsp;<span class="builtintype" id="4596177">uint32</span><span class="op" id="4596183">(</span><span class="builtinfunc" id="4596184">len</span><span class="op" id="4596187">(</span><span class="ident" id="4596188">data</span><span class="op" id="4596192">)</span><span class="op" id="4596193">)</span><span class="op" id="4596194">-</span><span class="num" id="4596195">4</span>&nbsp;<span class="op" id="4596197">!=</span>&nbsp;<span class="ident" id="4596200">length</span>&nbsp;<span class="op" id="4596207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4596211">return</span>&nbsp;<span class="builtintype" id="4596218">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4596225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4596229">data</span>&nbsp;<span class="op" id="4596234">=</span>&nbsp;<span class="ident" id="4596236">data</span><span class="op" id="4596240">[</span><span class="num" id="4596241">4</span><span class="op" id="4596242">:</span><span class="op" id="4596243">]</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4596246">if</span>&nbsp;<span class="ident" id="4596249">m</span><span class="op" id="4596250">.</span><span class="ident" id="4596251">hasSignatureAndHash</span>&nbsp;<span class="op" id="4596271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4596275">m</span><span class="op" id="4596276">.</span><span class="ident" id="4596277">signatureAndHash</span><span class="op" id="4596293">.</span><span class="ident" id="4596294">hash</span>&nbsp;<span class="op" id="4596299">=</span>&nbsp;<span class="ident" id="4596301">data</span><span class="op" id="4596305">[</span><span class="num" id="4596306">0</span><span class="op" id="4596307">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4596311">m</span><span class="op" id="4596312">.</span><span class="ident" id="4596313">signatureAndHash</span><span class="op" id="4596329">.</span><span class="ident" id="4596330">signature</span>&nbsp;<span class="op" id="4596340">=</span>&nbsp;<span class="ident" id="4596342">data</span><span class="op" id="4596346">[</span><span class="num" id="4596347">1</span><span class="op" id="4596348">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4596352">data</span>&nbsp;<span class="op" id="4596357">=</span>&nbsp;<span class="ident" id="4596359">data</span><span class="op" id="4596363">[</span><span class="num" id="4596364">2</span><span class="op" id="4596365">:</span><span class="op" id="4596366">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4596369">}</span><br>
<span class="lineno">1305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4596373">if</span>&nbsp;<span class="builtinfunc" id="4596376">len</span><span class="op" id="4596379">(</span><span class="ident" id="4596380">data</span><span class="op" id="4596384">)</span>&nbsp;<span class="op" id="4596386">&lt;</span>&nbsp;<span class="num" id="4596388">2</span>&nbsp;<span class="op" id="4596390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4596394">return</span>&nbsp;<span class="builtintype" id="4596401">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4596408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4596411">siglength</span>&nbsp;<span class="op" id="4596421">:=</span>&nbsp;<span class="builtintype" id="4596424">int</span><span class="op" id="4596427">(</span><span class="ident" id="4596428">data</span><span class="op" id="4596432">[</span><span class="num" id="4596433">0</span><span class="op" id="4596434">]</span><span class="op" id="4596435">)</span><span class="op" id="4596436">&lt;&lt;</span><span class="num" id="4596438">8</span>&nbsp;<span class="op" id="4596440">+</span>&nbsp;<span class="builtintype" id="4596442">int</span><span class="op" id="4596445">(</span><span class="ident" id="4596446">data</span><span class="op" id="4596450">[</span><span class="num" id="4596451">1</span><span class="op" id="4596452">]</span><span class="op" id="4596453">)</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4596456">data</span>&nbsp;<span class="op" id="4596461">=</span>&nbsp;<span class="ident" id="4596463">data</span><span class="op" id="4596467">[</span><span class="num" id="4596468">2</span><span class="op" id="4596469">:</span><span class="op" id="4596470">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4596473">if</span>&nbsp;<span class="builtinfunc" id="4596476">len</span><span class="op" id="4596479">(</span><span class="ident" id="4596480">data</span><span class="op" id="4596484">)</span>&nbsp;<span class="op" id="4596486">!=</span>&nbsp;<span class="ident" id="4596489">siglength</span>&nbsp;<span class="op" id="4596499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4596503">return</span>&nbsp;<span class="builtintype" id="4596510">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4596517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4596521">m</span><span class="op" id="4596522">.</span><span class="ident" id="4596523">signature</span>&nbsp;<span class="op" id="4596533">=</span>&nbsp;<span class="ident" id="4596535">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4596542">return</span>&nbsp;<span class="builtintype" id="4596549">true</span><br>
<span class="lineno"></span><span class="op" id="4596554">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1320</span><span class="keyword" id="4596557">type</span>&nbsp;<span class="ident" id="4596562">newSessionTicketMsg</span>&nbsp;<span class="keyword" id="4596582">struct</span>&nbsp;<span class="op" id="4596589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4596592">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4596599">[</span><span class="op" id="4596600">]</span><span class="builtintype" id="4596601">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4596607">ticket</span>&nbsp;<span class="op" id="4596614">[</span><span class="op" id="4596615">]</span><span class="builtintype" id="4596616">byte</span><br>
<span class="lineno"></span><span class="op" id="4596621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1325</span><span class="keyword" id="4596624">func</span>&nbsp;<span class="op" id="4596629">(</span><span class="ident" id="4596630">m</span>&nbsp;<span class="op" id="4596632">*</span><span class="ident" id="4596633">newSessionTicketMsg</span><span class="op" id="4596652">)</span>&nbsp;<span class="ident" id="4596654">equal</span><span class="op" id="4596659">(</span><span class="ident" id="4596660">i</span>&nbsp;<span class="keyword" id="4596662">interface</span><span class="op" id="4596671">{</span><span class="op" id="4596672">}</span><span class="op" id="4596673">)</span>&nbsp;<span class="builtintype" id="4596675">bool</span>&nbsp;<span class="op" id="4596680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4596683">m1</span><span class="op" id="4596685">,</span>&nbsp;<span class="ident" id="4596687">ok</span>&nbsp;<span class="op" id="4596690">:=</span>&nbsp;<span class="ident" id="4596693">i</span><span class="op" id="4596694">.</span><span class="op" id="4596695">(</span><span class="op" id="4596696">*</span><span class="ident" id="4596697">newSessionTicketMsg</span><span class="op" id="4596716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4596719">if</span>&nbsp;<span class="op" id="4596722">!</span><span class="ident" id="4596723">ok</span>&nbsp;<span class="op" id="4596726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4596730">return</span>&nbsp;<span class="builtintype" id="4596737">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4596744">}</span><br>
<span class="lineno">1330</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4596748">return</span>&nbsp;<span class="ident" id="4596755">bytes</span><span class="op" id="4596760">.</span><span class="ident" id="4596761">Equal</span><span class="op" id="4596766">(</span><span class="ident" id="4596767">m</span><span class="op" id="4596768">.</span><span class="ident" id="4596769">raw</span><span class="op" id="4596772">,</span>&nbsp;<span class="ident" id="4596774">m1</span><span class="op" id="4596776">.</span><span class="ident" id="4596777">raw</span><span class="op" id="4596780">)</span>&nbsp;<span class="op" id="4596782">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4596787">bytes</span><span class="op" id="4596792">.</span><span class="ident" id="4596793">Equal</span><span class="op" id="4596798">(</span><span class="ident" id="4596799">m</span><span class="op" id="4596800">.</span><span class="ident" id="4596801">ticket</span><span class="op" id="4596807">,</span>&nbsp;<span class="ident" id="4596809">m1</span><span class="op" id="4596811">.</span><span class="ident" id="4596812">ticket</span><span class="op" id="4596818">)</span><br>
<span class="lineno"></span><span class="op" id="4596820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1335</span><span class="keyword" id="4596823">func</span>&nbsp;<span class="op" id="4596828">(</span><span class="ident" id="4596829">m</span>&nbsp;<span class="op" id="4596831">*</span><span class="ident" id="4596832">newSessionTicketMsg</span><span class="op" id="4596851">)</span>&nbsp;<span class="ident" id="4596853">marshal</span><span class="op" id="4596860">(</span><span class="op" id="4596861">)</span>&nbsp;<span class="op" id="4596863">(</span><span class="ident" id="4596864">x</span>&nbsp;<span class="op" id="4596866">[</span><span class="op" id="4596867">]</span><span class="builtintype" id="4596868">byte</span><span class="op" id="4596872">)</span>&nbsp;<span class="op" id="4596874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4596877">if</span>&nbsp;<span class="ident" id="4596880">m</span><span class="op" id="4596881">.</span><span class="ident" id="4596882">raw</span>&nbsp;<span class="op" id="4596886">!=</span>&nbsp;<span class="ident" id="4596889">nil</span>&nbsp;<span class="op" id="4596893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4596897">return</span>&nbsp;<span class="ident" id="4596904">m</span><span class="op" id="4596905">.</span><span class="ident" id="4596906">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4596911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4596915">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc5077#section-3.3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4596970">ticketLen</span>&nbsp;<span class="op" id="4596980">:=</span>&nbsp;<span class="builtinfunc" id="4596983">len</span><span class="op" id="4596986">(</span><span class="ident" id="4596987">m</span><span class="op" id="4596988">.</span><span class="ident" id="4596989">ticket</span><span class="op" id="4596995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4596998">length</span>&nbsp;<span class="op" id="4597005">:=</span>&nbsp;<span class="num" id="4597008">2</span>&nbsp;<span class="op" id="4597010">+</span>&nbsp;<span class="num" id="4597012">4</span>&nbsp;<span class="op" id="4597014">+</span>&nbsp;<span class="ident" id="4597016">ticketLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4597027">x</span>&nbsp;<span class="op" id="4597029">=</span>&nbsp;<span class="builtinfunc" id="4597031">make</span><span class="op" id="4597035">(</span><span class="op" id="4597036">[</span><span class="op" id="4597037">]</span><span class="builtintype" id="4597038">byte</span><span class="op" id="4597042">,</span>&nbsp;<span class="num" id="4597044">4</span><span class="op" id="4597045">+</span><span class="ident" id="4597046">length</span><span class="op" id="4597052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4597055">x</span><span class="op" id="4597056">[</span><span class="num" id="4597057">0</span><span class="op" id="4597058">]</span>&nbsp;<span class="op" id="4597060">=</span>&nbsp;<span class="ident" id="4597062">typeNewSessionTicket</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4597084">x</span><span class="op" id="4597085">[</span><span class="num" id="4597086">1</span><span class="op" id="4597087">]</span>&nbsp;<span class="op" id="4597089">=</span>&nbsp;<span class="builtintype" id="4597091">uint8</span><span class="op" id="4597096">(</span><span class="ident" id="4597097">length</span>&nbsp;<span class="op" id="4597104">&gt;&gt;</span>&nbsp;<span class="num" id="4597107">16</span><span class="op" id="4597109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4597112">x</span><span class="op" id="4597113">[</span><span class="num" id="4597114">2</span><span class="op" id="4597115">]</span>&nbsp;<span class="op" id="4597117">=</span>&nbsp;<span class="builtintype" id="4597119">uint8</span><span class="op" id="4597124">(</span><span class="ident" id="4597125">length</span>&nbsp;<span class="op" id="4597132">&gt;&gt;</span>&nbsp;<span class="num" id="4597135">8</span><span class="op" id="4597136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4597139">x</span><span class="op" id="4597140">[</span><span class="num" id="4597141">3</span><span class="op" id="4597142">]</span>&nbsp;<span class="op" id="4597144">=</span>&nbsp;<span class="builtintype" id="4597146">uint8</span><span class="op" id="4597151">(</span><span class="ident" id="4597152">length</span><span class="op" id="4597158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4597161">x</span><span class="op" id="4597162">[</span><span class="num" id="4597163">8</span><span class="op" id="4597164">]</span>&nbsp;<span class="op" id="4597166">=</span>&nbsp;<span class="builtintype" id="4597168">uint8</span><span class="op" id="4597173">(</span><span class="ident" id="4597174">ticketLen</span>&nbsp;<span class="op" id="4597184">&gt;&gt;</span>&nbsp;<span class="num" id="4597187">8</span><span class="op" id="4597188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4597191">x</span><span class="op" id="4597192">[</span><span class="num" id="4597193">9</span><span class="op" id="4597194">]</span>&nbsp;<span class="op" id="4597196">=</span>&nbsp;<span class="builtintype" id="4597198">uint8</span><span class="op" id="4597203">(</span><span class="ident" id="4597204">ticketLen</span><span class="op" id="4597213">)</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4597216">copy</span><span class="op" id="4597220">(</span><span class="ident" id="4597221">x</span><span class="op" id="4597222">[</span><span class="num" id="4597223">10</span><span class="op" id="4597225">:</span><span class="op" id="4597226">]</span><span class="op" id="4597227">,</span>&nbsp;<span class="ident" id="4597229">m</span><span class="op" id="4597230">.</span><span class="ident" id="4597231">ticket</span><span class="op" id="4597237">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4597241">m</span><span class="op" id="4597242">.</span><span class="ident" id="4597243">raw</span>&nbsp;<span class="op" id="4597247">=</span>&nbsp;<span class="ident" id="4597249">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4597253">return</span><br>
<span class="lineno">1355</span><span class="op" id="4597260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4597263">func</span>&nbsp;<span class="op" id="4597268">(</span><span class="ident" id="4597269">m</span>&nbsp;<span class="op" id="4597271">*</span><span class="ident" id="4597272">newSessionTicketMsg</span><span class="op" id="4597291">)</span>&nbsp;<span class="ident" id="4597293">unmarshal</span><span class="op" id="4597302">(</span><span class="ident" id="4597303">data</span>&nbsp;<span class="op" id="4597308">[</span><span class="op" id="4597309">]</span><span class="builtintype" id="4597310">byte</span><span class="op" id="4597314">)</span>&nbsp;<span class="builtintype" id="4597316">bool</span>&nbsp;<span class="op" id="4597321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4597324">m</span><span class="op" id="4597325">.</span><span class="ident" id="4597326">raw</span>&nbsp;<span class="op" id="4597330">=</span>&nbsp;<span class="ident" id="4597332">data</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4597339">if</span>&nbsp;<span class="builtinfunc" id="4597342">len</span><span class="op" id="4597345">(</span><span class="ident" id="4597346">data</span><span class="op" id="4597350">)</span>&nbsp;<span class="op" id="4597352">&lt;</span>&nbsp;<span class="num" id="4597354">10</span>&nbsp;<span class="op" id="4597357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4597361">return</span>&nbsp;<span class="builtintype" id="4597368">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4597375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4597379">length</span>&nbsp;<span class="op" id="4597386">:=</span>&nbsp;<span class="builtintype" id="4597389">uint32</span><span class="op" id="4597395">(</span><span class="ident" id="4597396">data</span><span class="op" id="4597400">[</span><span class="num" id="4597401">1</span><span class="op" id="4597402">]</span><span class="op" id="4597403">)</span><span class="op" id="4597404">&lt;&lt;</span><span class="num" id="4597406">16</span>&nbsp;<span class="op" id="4597409">|</span>&nbsp;<span class="builtintype" id="4597411">uint32</span><span class="op" id="4597417">(</span><span class="ident" id="4597418">data</span><span class="op" id="4597422">[</span><span class="num" id="4597423">2</span><span class="op" id="4597424">]</span><span class="op" id="4597425">)</span><span class="op" id="4597426">&lt;&lt;</span><span class="num" id="4597428">8</span>&nbsp;<span class="op" id="4597430">|</span>&nbsp;<span class="builtintype" id="4597432">uint32</span><span class="op" id="4597438">(</span><span class="ident" id="4597439">data</span><span class="op" id="4597443">[</span><span class="num" id="4597444">3</span><span class="op" id="4597445">]</span><span class="op" id="4597446">)</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4597449">if</span>&nbsp;<span class="builtintype" id="4597452">uint32</span><span class="op" id="4597458">(</span><span class="builtinfunc" id="4597459">len</span><span class="op" id="4597462">(</span><span class="ident" id="4597463">data</span><span class="op" id="4597467">)</span><span class="op" id="4597468">)</span><span class="op" id="4597469">-</span><span class="num" id="4597470">4</span>&nbsp;<span class="op" id="4597472">!=</span>&nbsp;<span class="ident" id="4597475">length</span>&nbsp;<span class="op" id="4597482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4597486">return</span>&nbsp;<span class="builtintype" id="4597493">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4597500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4597504">ticketLen</span>&nbsp;<span class="op" id="4597514">:=</span>&nbsp;<span class="builtintype" id="4597517">int</span><span class="op" id="4597520">(</span><span class="ident" id="4597521">data</span><span class="op" id="4597525">[</span><span class="num" id="4597526">8</span><span class="op" id="4597527">]</span><span class="op" id="4597528">)</span><span class="op" id="4597529">&lt;&lt;</span><span class="num" id="4597531">8</span>&nbsp;<span class="op" id="4597533">+</span>&nbsp;<span class="builtintype" id="4597535">int</span><span class="op" id="4597538">(</span><span class="ident" id="4597539">data</span><span class="op" id="4597543">[</span><span class="num" id="4597544">9</span><span class="op" id="4597545">]</span><span class="op" id="4597546">)</span><br>
<span class="lineno">1370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4597549">if</span>&nbsp;<span class="builtinfunc" id="4597552">len</span><span class="op" id="4597555">(</span><span class="ident" id="4597556">data</span><span class="op" id="4597560">)</span><span class="op" id="4597561">-</span><span class="num" id="4597562">10</span>&nbsp;<span class="op" id="4597565">!=</span>&nbsp;<span class="ident" id="4597568">ticketLen</span>&nbsp;<span class="op" id="4597578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4597582">return</span>&nbsp;<span class="builtintype" id="4597589">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4597596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4597600">m</span><span class="op" id="4597601">.</span><span class="ident" id="4597602">ticket</span>&nbsp;<span class="op" id="4597609">=</span>&nbsp;<span class="ident" id="4597611">data</span><span class="op" id="4597615">[</span><span class="num" id="4597616">10</span><span class="op" id="4597618">:</span><span class="op" id="4597619">]</span><br>
<span class="lineno">1375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4597623">return</span>&nbsp;<span class="builtintype" id="4597630">true</span><br>
<span class="lineno"></span><span class="op" id="4597635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4597638">func</span>&nbsp;<span class="ident" id="4597643">eqUint16s</span><span class="op" id="4597652">(</span><span class="ident" id="4597653">x</span><span class="op" id="4597654">,</span>&nbsp;<span class="ident" id="4597656">y</span>&nbsp;<span class="op" id="4597658">[</span><span class="op" id="4597659">]</span><span class="builtintype" id="4597660">uint16</span><span class="op" id="4597666">)</span>&nbsp;<span class="builtintype" id="4597668">bool</span>&nbsp;<span class="op" id="4597673">{</span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4597676">if</span>&nbsp;<span class="builtinfunc" id="4597679">len</span><span class="op" id="4597682">(</span><span class="ident" id="4597683">x</span><span class="op" id="4597684">)</span>&nbsp;<span class="op" id="4597686">!=</span>&nbsp;<span class="builtinfunc" id="4597689">len</span><span class="op" id="4597692">(</span><span class="ident" id="4597693">y</span><span class="op" id="4597694">)</span>&nbsp;<span class="op" id="4597696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4597700">return</span>&nbsp;<span class="builtintype" id="4597707">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4597714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4597717">for</span>&nbsp;<span class="ident" id="4597721">i</span><span class="op" id="4597722">,</span>&nbsp;<span class="ident" id="4597724">v</span>&nbsp;<span class="op" id="4597726">:=</span>&nbsp;<span class="keyword" id="4597729">range</span>&nbsp;<span class="ident" id="4597735">x</span>&nbsp;<span class="op" id="4597737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4597741">if</span>&nbsp;<span class="ident" id="4597744">y</span><span class="op" id="4597745">[</span><span class="ident" id="4597746">i</span><span class="op" id="4597747">]</span>&nbsp;<span class="op" id="4597749">!=</span>&nbsp;<span class="ident" id="4597752">v</span>&nbsp;<span class="op" id="4597754">{</span><br>
<span class="lineno">1385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4597759">return</span>&nbsp;<span class="builtintype" id="4597766">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4597774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4597777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4597780">return</span>&nbsp;<span class="builtintype" id="4597787">true</span><br>
<span class="lineno"></span><span class="op" id="4597792">}</span><br>
<span class="lineno">1390</span><br>
<span class="lineno"></span><span class="keyword" id="4597795">func</span>&nbsp;<span class="ident" id="4597800">eqCurveIDs</span><span class="op" id="4597810">(</span><span class="ident" id="4597811">x</span><span class="op" id="4597812">,</span>&nbsp;<span class="ident" id="4597814">y</span>&nbsp;<span class="op" id="4597816">[</span><span class="op" id="4597817">]</span><span class="ident" id="4597818">CurveID</span><span class="op" id="4597825">)</span>&nbsp;<span class="builtintype" id="4597827">bool</span>&nbsp;<span class="op" id="4597832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4597835">if</span>&nbsp;<span class="builtinfunc" id="4597838">len</span><span class="op" id="4597841">(</span><span class="ident" id="4597842">x</span><span class="op" id="4597843">)</span>&nbsp;<span class="op" id="4597845">!=</span>&nbsp;<span class="builtinfunc" id="4597848">len</span><span class="op" id="4597851">(</span><span class="ident" id="4597852">y</span><span class="op" id="4597853">)</span>&nbsp;<span class="op" id="4597855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4597859">return</span>&nbsp;<span class="builtintype" id="4597866">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4597873">}</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4597876">for</span>&nbsp;<span class="ident" id="4597880">i</span><span class="op" id="4597881">,</span>&nbsp;<span class="ident" id="4597883">v</span>&nbsp;<span class="op" id="4597885">:=</span>&nbsp;<span class="keyword" id="4597888">range</span>&nbsp;<span class="ident" id="4597894">x</span>&nbsp;<span class="op" id="4597896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4597900">if</span>&nbsp;<span class="ident" id="4597903">y</span><span class="op" id="4597904">[</span><span class="ident" id="4597905">i</span><span class="op" id="4597906">]</span>&nbsp;<span class="op" id="4597908">!=</span>&nbsp;<span class="ident" id="4597911">v</span>&nbsp;<span class="op" id="4597913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4597918">return</span>&nbsp;<span class="builtintype" id="4597925">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4597933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4597936">}</span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4597939">return</span>&nbsp;<span class="builtintype" id="4597946">true</span><br>
<span class="lineno"></span><span class="op" id="4597951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4597954">func</span>&nbsp;<span class="ident" id="4597959">eqStrings</span><span class="op" id="4597968">(</span><span class="ident" id="4597969">x</span><span class="op" id="4597970">,</span>&nbsp;<span class="ident" id="4597972">y</span>&nbsp;<span class="op" id="4597974">[</span><span class="op" id="4597975">]</span><span class="builtintype" id="4597976">string</span><span class="op" id="4597982">)</span>&nbsp;<span class="builtintype" id="4597984">bool</span>&nbsp;<span class="op" id="4597989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4597992">if</span>&nbsp;<span class="builtinfunc" id="4597995">len</span><span class="op" id="4597998">(</span><span class="ident" id="4597999">x</span><span class="op" id="4598000">)</span>&nbsp;<span class="op" id="4598002">!=</span>&nbsp;<span class="builtinfunc" id="4598005">len</span><span class="op" id="4598008">(</span><span class="ident" id="4598009">y</span><span class="op" id="4598010">)</span>&nbsp;<span class="op" id="4598012">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4598016">return</span>&nbsp;<span class="builtintype" id="4598023">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4598030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4598033">for</span>&nbsp;<span class="ident" id="4598037">i</span><span class="op" id="4598038">,</span>&nbsp;<span class="ident" id="4598040">v</span>&nbsp;<span class="op" id="4598042">:=</span>&nbsp;<span class="keyword" id="4598045">range</span>&nbsp;<span class="ident" id="4598051">x</span>&nbsp;<span class="op" id="4598053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4598057">if</span>&nbsp;<span class="ident" id="4598060">y</span><span class="op" id="4598061">[</span><span class="ident" id="4598062">i</span><span class="op" id="4598063">]</span>&nbsp;<span class="op" id="4598065">!=</span>&nbsp;<span class="ident" id="4598068">v</span>&nbsp;<span class="op" id="4598070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4598075">return</span>&nbsp;<span class="builtintype" id="4598082">false</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4598090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4598093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4598096">return</span>&nbsp;<span class="builtintype" id="4598103">true</span><br>
<span class="lineno"></span><span class="op" id="4598108">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1415</span><span class="keyword" id="4598111">func</span>&nbsp;<span class="ident" id="4598116">eqByteSlices</span><span class="op" id="4598128">(</span><span class="ident" id="4598129">x</span><span class="op" id="4598130">,</span>&nbsp;<span class="ident" id="4598132">y</span>&nbsp;<span class="op" id="4598134">[</span><span class="op" id="4598135">]</span><span class="op" id="4598136">[</span><span class="op" id="4598137">]</span><span class="builtintype" id="4598138">byte</span><span class="op" id="4598142">)</span>&nbsp;<span class="builtintype" id="4598144">bool</span>&nbsp;<span class="op" id="4598149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4598152">if</span>&nbsp;<span class="builtinfunc" id="4598155">len</span><span class="op" id="4598158">(</span><span class="ident" id="4598159">x</span><span class="op" id="4598160">)</span>&nbsp;<span class="op" id="4598162">!=</span>&nbsp;<span class="builtinfunc" id="4598165">len</span><span class="op" id="4598168">(</span><span class="ident" id="4598169">y</span><span class="op" id="4598170">)</span>&nbsp;<span class="op" id="4598172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4598176">return</span>&nbsp;<span class="builtintype" id="4598183">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4598190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4598193">for</span>&nbsp;<span class="ident" id="4598197">i</span><span class="op" id="4598198">,</span>&nbsp;<span class="ident" id="4598200">v</span>&nbsp;<span class="op" id="4598202">:=</span>&nbsp;<span class="keyword" id="4598205">range</span>&nbsp;<span class="ident" id="4598211">x</span>&nbsp;<span class="op" id="4598213">{</span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4598217">if</span>&nbsp;<span class="op" id="4598220">!</span><span class="ident" id="4598221">bytes</span><span class="op" id="4598226">.</span><span class="ident" id="4598227">Equal</span><span class="op" id="4598232">(</span><span class="ident" id="4598233">v</span><span class="op" id="4598234">,</span>&nbsp;<span class="ident" id="4598236">y</span><span class="op" id="4598237">[</span><span class="ident" id="4598238">i</span><span class="op" id="4598239">]</span><span class="op" id="4598240">)</span>&nbsp;<span class="op" id="4598242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4598247">return</span>&nbsp;<span class="builtintype" id="4598254">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4598262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4598265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4598268">return</span>&nbsp;<span class="builtintype" id="4598275">true</span><br>
<span class="lineno">1425</span><span class="op" id="4598280">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4598283">func</span>&nbsp;<span class="ident" id="4598288">eqSignatureAndHashes</span><span class="op" id="4598308">(</span><span class="ident" id="4598309">x</span><span class="op" id="4598310">,</span>&nbsp;<span class="ident" id="4598312">y</span>&nbsp;<span class="op" id="4598314">[</span><span class="op" id="4598315">]</span><span class="ident" id="4598316">signatureAndHash</span><span class="op" id="4598332">)</span>&nbsp;<span class="builtintype" id="4598334">bool</span>&nbsp;<span class="op" id="4598339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4598342">if</span>&nbsp;<span class="builtinfunc" id="4598345">len</span><span class="op" id="4598348">(</span><span class="ident" id="4598349">x</span><span class="op" id="4598350">)</span>&nbsp;<span class="op" id="4598352">!=</span>&nbsp;<span class="builtinfunc" id="4598355">len</span><span class="op" id="4598358">(</span><span class="ident" id="4598359">y</span><span class="op" id="4598360">)</span>&nbsp;<span class="op" id="4598362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4598366">return</span>&nbsp;<span class="builtintype" id="4598373">false</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4598380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4598383">for</span>&nbsp;<span class="ident" id="4598387">i</span><span class="op" id="4598388">,</span>&nbsp;<span class="ident" id="4598390">v</span>&nbsp;<span class="op" id="4598392">:=</span>&nbsp;<span class="keyword" id="4598395">range</span>&nbsp;<span class="ident" id="4598401">x</span>&nbsp;<span class="op" id="4598403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4598407">v2</span>&nbsp;<span class="op" id="4598410">:=</span>&nbsp;<span class="ident" id="4598413">y</span><span class="op" id="4598414">[</span><span class="ident" id="4598415">i</span><span class="op" id="4598416">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4598420">if</span>&nbsp;<span class="ident" id="4598423">v</span><span class="op" id="4598424">.</span><span class="ident" id="4598425">hash</span>&nbsp;<span class="op" id="4598430">!=</span>&nbsp;<span class="ident" id="4598433">v2</span><span class="op" id="4598435">.</span><span class="ident" id="4598436">hash</span>&nbsp;<span class="op" id="4598441">||</span>&nbsp;<span class="ident" id="4598444">v</span><span class="op" id="4598445">.</span><span class="ident" id="4598446">signature</span>&nbsp;<span class="op" id="4598456">!=</span>&nbsp;<span class="ident" id="4598459">v2</span><span class="op" id="4598461">.</span><span class="ident" id="4598462">signature</span>&nbsp;<span class="op" id="4598472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4598477">return</span>&nbsp;<span class="builtintype" id="4598484">false</span><br>
<span class="lineno">1435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4598492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4598495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4598498">return</span>&nbsp;<span class="builtintype" id="4598505">true</span><br>
<span class="lineno"></span><span class="op" id="4598510">}</span>
</div>
</body>
</html>
