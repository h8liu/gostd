<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html" class="current">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4230624">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4230680">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4230734">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4230785">package</span>&nbsp;<span class="ident" id="4230793">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4230799">import</span>&nbsp;<span class="op" id="4230806">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4230809">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4230818">&#34;encoding/binary&#34;</span><br>
<span class="lineno">10</span><span class="op" id="4230836">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4230839">//&nbsp;The&nbsp;algorithm&nbsp;uses&nbsp;at&nbsp;most&nbsp;sniffLen&nbsp;bytes&nbsp;to&nbsp;make&nbsp;its&nbsp;decision.</span><br>
<span class="lineno"></span><span class="keyword" id="4230906">const</span>&nbsp;<span class="ident" id="4230912">sniffLen</span>&nbsp;<span class="op" id="4230921">=</span>&nbsp;<span class="num" id="4230923">512</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="4230928">//&nbsp;DetectContentType&nbsp;implements&nbsp;the&nbsp;algorithm&nbsp;described</span><br>
<span class="lineno"></span><span class="comment" id="4230984">//&nbsp;at&nbsp;http://mimesniff.spec.whatwg.org/&nbsp;to&nbsp;determine&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4231041">//&nbsp;Content-Type&nbsp;of&nbsp;the&nbsp;given&nbsp;data.&nbsp;&nbsp;It&nbsp;considers&nbsp;at&nbsp;most&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4231102">//&nbsp;first&nbsp;512&nbsp;bytes&nbsp;of&nbsp;data.&nbsp;&nbsp;DetectContentType&nbsp;always&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4231164">//&nbsp;a&nbsp;valid&nbsp;MIME&nbsp;type:&nbsp;if&nbsp;it&nbsp;cannot&nbsp;determine&nbsp;a&nbsp;more&nbsp;specific&nbsp;one,&nbsp;it</span><br>
<span class="lineno">20</span><span class="comment" id="4231233">//&nbsp;returns&nbsp;&#34;application/octet-stream&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="4231272">func</span>&nbsp;<span class="ident" id="4231277">DetectContentType</span><span class="op" id="4231294">(</span><span class="ident" id="4231295">data</span>&nbsp;<span class="op" id="4231300">[</span><span class="op" id="4231301">]</span><span class="builtintype" id="4231302">byte</span><span class="op" id="4231306">)</span>&nbsp;<span class="builtintype" id="4231308">string</span>&nbsp;<span class="op" id="4231315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4231318">if</span>&nbsp;<span class="builtinfunc" id="4231321">len</span><span class="op" id="4231324">(</span><span class="ident" id="4231325"><a href="/gostd/net/http/sniff.go.html#4231295">data</a></span><span class="op" id="4231329">)</span>&nbsp;<span class="op" id="4231331">&gt;</span>&nbsp;<span class="ident" id="4231333"><a href="/gostd/net/http/sniff.go.html#4230912">sniffLen</a></span>&nbsp;<span class="op" id="4231342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4231346"><a href="/gostd/net/http/sniff.go.html#4231295">data</a></span>&nbsp;<span class="op" id="4231351">=</span>&nbsp;<span class="ident" id="4231353"><a href="/gostd/net/http/sniff.go.html#4231295">data</a></span><span class="op" id="4231357">[</span><span class="op" id="4231358">:</span><span class="ident" id="4231359"><a href="/gostd/net/http/sniff.go.html#4230912">sniffLen</a></span><span class="op" id="4231367">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4231370">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4231374">//&nbsp;Index&nbsp;of&nbsp;the&nbsp;first&nbsp;non-whitespace&nbsp;byte&nbsp;in&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4231426">firstNonWS</span>&nbsp;<span class="op" id="4231437">:=</span>&nbsp;<span class="num" id="4231440">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4231443">for</span>&nbsp;<span class="op" id="4231447">;</span>&nbsp;<span class="ident" id="4231449"><a href="/gostd/net/http/sniff.go.html#4231426">firstNonWS</a></span>&nbsp;<span class="op" id="4231460">&lt;</span>&nbsp;<span class="builtinfunc" id="4231462">len</span><span class="op" id="4231465">(</span><span class="ident" id="4231466"><a href="/gostd/net/http/sniff.go.html#4231295">data</a></span><span class="op" id="4231470">)</span>&nbsp;<span class="op" id="4231472">&amp;&amp;</span>&nbsp;<span class="ident" id="4231475"><a href="/gostd/net/http/sniff.go.html#4231684">isWS</a></span><span class="op" id="4231479">(</span><span class="ident" id="4231480"><a href="/gostd/net/http/sniff.go.html#4231295">data</a></span><span class="op" id="4231484">[</span><span class="ident" id="4231485"><a href="/gostd/net/http/sniff.go.html#4231426">firstNonWS</a></span><span class="op" id="4231495">]</span><span class="op" id="4231496">)</span><span class="op" id="4231497">;</span>&nbsp;<span class="ident" id="4231499"><a href="/gostd/net/http/sniff.go.html#4231426">firstNonWS</a></span><span class="op" id="4231509">++</span>&nbsp;<span class="op" id="4231512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4231515">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4231519">for</span>&nbsp;<span class="ident" id="4231523">_</span><span class="op" id="4231524">,</span>&nbsp;<span class="ident" id="4231526">sig</span>&nbsp;<span class="op" id="4231530">:=</span>&nbsp;<span class="keyword" id="4231533">range</span>&nbsp;<span class="ident" id="4231539"><a href="/gostd/net/http/sniff.go.html#4231943">sniffSignatures</a></span>&nbsp;<span class="op" id="4231555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4231559">if</span>&nbsp;<span class="ident" id="4231562">ct</span>&nbsp;<span class="op" id="4231565">:=</span>&nbsp;<span class="ident" id="4231568"><a href="/gostd/net/http/sniff.go.html#4231526">sig</a></span><span class="op" id="4231571">.</span><span class="ident" id="4231572"><a href="/gostd/net/http/sniff.go.html#4231853">match</a></span><span class="op" id="4231577">(</span><span class="ident" id="4231578"><a href="/gostd/net/http/sniff.go.html#4231295">data</a></span><span class="op" id="4231582">,</span>&nbsp;<span class="ident" id="4231584"><a href="/gostd/net/http/sniff.go.html#4231426">firstNonWS</a></span><span class="op" id="4231594">)</span><span class="op" id="4231595">;</span>&nbsp;<span class="ident" id="4231597"><a href="/gostd/net/http/sniff.go.html#4231562">ct</a></span>&nbsp;<span class="op" id="4231600">!=</span>&nbsp;<span class="string" id="4231603">&#34;&#34;</span>&nbsp;<span class="op" id="4231606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4231611">return</span>&nbsp;<span class="ident" id="4231618"><a href="/gostd/net/http/sniff.go.html#4231562">ct</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4231623">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4231626">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4231630">return</span>&nbsp;<span class="string" id="4231637">&#34;application/octet-stream&#34;</span>&nbsp;<span class="comment" id="4231664">//&nbsp;fallback</span><br>
<span class="lineno"></span><span class="op" id="4231676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="4231679">func</span>&nbsp;<span class="ident" id="4231684">isWS</span><span class="op" id="4231688">(</span><span class="ident" id="4231689">b</span>&nbsp;<span class="builtintype" id="4231691">byte</span><span class="op" id="4231695">)</span>&nbsp;<span class="builtintype" id="4231697">bool</span>&nbsp;<span class="op" id="4231702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4231705">return</span>&nbsp;<span class="ident" id="4231712"><a href="/gostd/net/http/sniff.go.html#4230809">bytes</a></span><span class="op" id="4231717">.</span><span class="ident" id="4231718"><a href="/gostd/bytes/bytes_decl.go.html#1414570">IndexByte</a></span><span class="op" id="4231727">(</span><span class="op" id="4231728">[</span><span class="op" id="4231729">]</span><span class="builtintype" id="4231730">byte</span><span class="op" id="4231734">(</span><span class="string" id="4231735">&#34;\t\n\x0C\r&nbsp;&#34;</span><span class="op" id="4231748">)</span><span class="op" id="4231749">,</span>&nbsp;<span class="ident" id="4231751"><a href="/gostd/net/http/sniff.go.html#4231689">b</a></span><span class="op" id="4231752">)</span>&nbsp;<span class="op" id="4231754">!=</span>&nbsp;<span class="op" id="4231757">-</span><span class="num" id="4231758">1</span><br>
<span class="lineno"></span><span class="op" id="4231760">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4231763">type</span>&nbsp;<span class="ident" id="4231768">sniffSig</span>&nbsp;<span class="keyword" id="4231777">interface</span>&nbsp;<span class="op" id="4231787">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4231790">//&nbsp;match&nbsp;returns&nbsp;the&nbsp;MIME&nbsp;type&nbsp;of&nbsp;the&nbsp;data,&nbsp;or&nbsp;&#34;&#34;&nbsp;if&nbsp;unknown.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4231853">match</span><span class="op" id="4231858">(</span><span class="ident" id="4231859">data</span>&nbsp;<span class="op" id="4231864">[</span><span class="op" id="4231865">]</span><span class="builtintype" id="4231866">byte</span><span class="op" id="4231870">,</span>&nbsp;<span class="ident" id="4231872">firstNonWS</span>&nbsp;<span class="builtintype" id="4231883">int</span><span class="op" id="4231886">)</span>&nbsp;<span class="builtintype" id="4231888">string</span><br>
<span class="lineno"></span><span class="op" id="4231895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4231898">//&nbsp;Data&nbsp;matching&nbsp;the&nbsp;table&nbsp;in&nbsp;section&nbsp;6.</span><br>
<span class="lineno">50</span><span class="keyword" id="4231939">var</span>&nbsp;<span class="ident" id="4231943">sniffSignatures</span>&nbsp;<span class="op" id="4231959">=</span>&nbsp;<span class="op" id="4231961">[</span><span class="op" id="4231962">]</span><span class="ident" id="4231963"><a href="/gostd/net/http/sniff.go.html#4231768">sniffSig</a></span><span class="op" id="4231971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4231974"><a href="/gostd/net/http/sniff.go.html#4234479">htmlSig</a></span><span class="op" id="4231981">(</span><span class="string" id="4231982">&#34;&lt;!DOCTYPE&nbsp;HTML&#34;</span><span class="op" id="4231998">)</span><span class="op" id="4231999">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232002"><a href="/gostd/net/http/sniff.go.html#4234479">htmlSig</a></span><span class="op" id="4232009">(</span><span class="string" id="4232010">&#34;&lt;HTML&#34;</span><span class="op" id="4232017">)</span><span class="op" id="4232018">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232021"><a href="/gostd/net/http/sniff.go.html#4234479">htmlSig</a></span><span class="op" id="4232028">(</span><span class="string" id="4232029">&#34;&lt;HEAD&#34;</span><span class="op" id="4232036">)</span><span class="op" id="4232037">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232040"><a href="/gostd/net/http/sniff.go.html#4234479">htmlSig</a></span><span class="op" id="4232047">(</span><span class="string" id="4232048">&#34;&lt;SCRIPT&#34;</span><span class="op" id="4232057">)</span><span class="op" id="4232058">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232061"><a href="/gostd/net/http/sniff.go.html#4234479">htmlSig</a></span><span class="op" id="4232068">(</span><span class="string" id="4232069">&#34;&lt;IFRAME&#34;</span><span class="op" id="4232078">)</span><span class="op" id="4232079">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232082"><a href="/gostd/net/http/sniff.go.html#4234479">htmlSig</a></span><span class="op" id="4232089">(</span><span class="string" id="4232090">&#34;&lt;H1&#34;</span><span class="op" id="4232095">)</span><span class="op" id="4232096">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232099"><a href="/gostd/net/http/sniff.go.html#4234479">htmlSig</a></span><span class="op" id="4232106">(</span><span class="string" id="4232107">&#34;&lt;DIV&#34;</span><span class="op" id="4232113">)</span><span class="op" id="4232114">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232117"><a href="/gostd/net/http/sniff.go.html#4234479">htmlSig</a></span><span class="op" id="4232124">(</span><span class="string" id="4232125">&#34;&lt;FONT&#34;</span><span class="op" id="4232132">)</span><span class="op" id="4232133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232136"><a href="/gostd/net/http/sniff.go.html#4234479">htmlSig</a></span><span class="op" id="4232143">(</span><span class="string" id="4232144">&#34;&lt;TABLE&#34;</span><span class="op" id="4232152">)</span><span class="op" id="4232153">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232156"><a href="/gostd/net/http/sniff.go.html#4234479">htmlSig</a></span><span class="op" id="4232163">(</span><span class="string" id="4232164">&#34;&lt;A&#34;</span><span class="op" id="4232168">)</span><span class="op" id="4232169">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232172"><a href="/gostd/net/http/sniff.go.html#4234479">htmlSig</a></span><span class="op" id="4232179">(</span><span class="string" id="4232180">&#34;&lt;STYLE&#34;</span><span class="op" id="4232188">)</span><span class="op" id="4232189">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232192"><a href="/gostd/net/http/sniff.go.html#4234479">htmlSig</a></span><span class="op" id="4232199">(</span><span class="string" id="4232200">&#34;&lt;TITLE&#34;</span><span class="op" id="4232208">)</span><span class="op" id="4232209">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232212"><a href="/gostd/net/http/sniff.go.html#4234479">htmlSig</a></span><span class="op" id="4232219">(</span><span class="string" id="4232220">&#34;&lt;B&#34;</span><span class="op" id="4232224">)</span><span class="op" id="4232225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232228"><a href="/gostd/net/http/sniff.go.html#4234479">htmlSig</a></span><span class="op" id="4232235">(</span><span class="string" id="4232236">&#34;&lt;BODY&#34;</span><span class="op" id="4232243">)</span><span class="op" id="4232244">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232247"><a href="/gostd/net/http/sniff.go.html#4234479">htmlSig</a></span><span class="op" id="4232254">(</span><span class="string" id="4232255">&#34;&lt;BR&#34;</span><span class="op" id="4232260">)</span><span class="op" id="4232261">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232264"><a href="/gostd/net/http/sniff.go.html#4234479">htmlSig</a></span><span class="op" id="4232271">(</span><span class="string" id="4232272">&#34;&lt;P&#34;</span><span class="op" id="4232276">)</span><span class="op" id="4232277">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4232280"><a href="/gostd/net/http/sniff.go.html#4234479">htmlSig</a></span><span class="op" id="4232287">(</span><span class="string" id="4232288">&#34;&lt;!--&#34;</span><span class="op" id="4232294">)</span><span class="op" id="4232295">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4232299">&amp;</span><span class="ident" id="4232300"><a href="/gostd/net/http/sniff.go.html#4234134">maskedSig</a></span><span class="op" id="4232309">{</span><span class="ident" id="4232310"><a href="/gostd/net/http/sniff.go.html#4234154">mask</a></span><span class="op" id="4232314">:</span>&nbsp;<span class="op" id="4232316">[</span><span class="op" id="4232317">]</span><span class="builtintype" id="4232318">byte</span><span class="op" id="4232322">(</span><span class="string" id="4232323">&#34;\xFF\xFF\xFF\xFF\xFF&#34;</span><span class="op" id="4232345">)</span><span class="op" id="4232346">,</span>&nbsp;<span class="ident" id="4232348"><a href="/gostd/net/http/sniff.go.html#4234160">pat</a></span><span class="op" id="4232351">:</span>&nbsp;<span class="op" id="4232353">[</span><span class="op" id="4232354">]</span><span class="builtintype" id="4232355">byte</span><span class="op" id="4232359">(</span><span class="string" id="4232360">&#34;&lt;?xml&#34;</span><span class="op" id="4232367">)</span><span class="op" id="4232368">,</span>&nbsp;<span class="ident" id="4232370"><a href="/gostd/net/http/sniff.go.html#4234172">skipWS</a></span><span class="op" id="4232376">:</span>&nbsp;<span class="builtintype" id="4232378">true</span><span class="op" id="4232382">,</span>&nbsp;<span class="ident" id="4232384"><a href="/gostd/net/http/sniff.go.html#4234188">ct</a></span><span class="op" id="4232386">:</span>&nbsp;<span class="string" id="4232388">&#34;text/xml;&nbsp;charset=utf-8&#34;</span><span class="op" id="4232413">}</span><span class="op" id="4232414">,</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4232418">&amp;</span><span class="ident" id="4232419"><a href="/gostd/net/http/sniff.go.html#4233955">exactSig</a></span><span class="op" id="4232427">{</span><span class="op" id="4232428">[</span><span class="op" id="4232429">]</span><span class="builtintype" id="4232430">byte</span><span class="op" id="4232434">(</span><span class="string" id="4232435">&#34;%PDF-&#34;</span><span class="op" id="4232442">)</span><span class="op" id="4232443">,</span>&nbsp;<span class="string" id="4232445">&#34;application/pdf&#34;</span><span class="op" id="4232462">}</span><span class="op" id="4232463">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4232466">&amp;</span><span class="ident" id="4232467"><a href="/gostd/net/http/sniff.go.html#4233955">exactSig</a></span><span class="op" id="4232475">{</span><span class="op" id="4232476">[</span><span class="op" id="4232477">]</span><span class="builtintype" id="4232478">byte</span><span class="op" id="4232482">(</span><span class="string" id="4232483">&#34;%!PS-Adobe-&#34;</span><span class="op" id="4232496">)</span><span class="op" id="4232497">,</span>&nbsp;<span class="string" id="4232499">&#34;application/postscript&#34;</span><span class="op" id="4232523">}</span><span class="op" id="4232524">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4232528">//&nbsp;UTF&nbsp;BOMs.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4232542">&amp;</span><span class="ident" id="4232543"><a href="/gostd/net/http/sniff.go.html#4234134">maskedSig</a></span><span class="op" id="4232552">{</span><span class="ident" id="4232553"><a href="/gostd/net/http/sniff.go.html#4234154">mask</a></span><span class="op" id="4232557">:</span>&nbsp;<span class="op" id="4232559">[</span><span class="op" id="4232560">]</span><span class="builtintype" id="4232561">byte</span><span class="op" id="4232565">(</span><span class="string" id="4232566">&#34;\xFF\xFF\x00\x00&#34;</span><span class="op" id="4232584">)</span><span class="op" id="4232585">,</span>&nbsp;<span class="ident" id="4232587"><a href="/gostd/net/http/sniff.go.html#4234160">pat</a></span><span class="op" id="4232590">:</span>&nbsp;<span class="op" id="4232592">[</span><span class="op" id="4232593">]</span><span class="builtintype" id="4232594">byte</span><span class="op" id="4232598">(</span><span class="string" id="4232599">&#34;\xFE\xFF\x00\x00&#34;</span><span class="op" id="4232617">)</span><span class="op" id="4232618">,</span>&nbsp;<span class="ident" id="4232620"><a href="/gostd/net/http/sniff.go.html#4234188">ct</a></span><span class="op" id="4232622">:</span>&nbsp;<span class="string" id="4232624">&#34;text/plain;&nbsp;charset=utf-16be&#34;</span><span class="op" id="4232654">}</span><span class="op" id="4232655">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4232658">&amp;</span><span class="ident" id="4232659"><a href="/gostd/net/http/sniff.go.html#4234134">maskedSig</a></span><span class="op" id="4232668">{</span><span class="ident" id="4232669"><a href="/gostd/net/http/sniff.go.html#4234154">mask</a></span><span class="op" id="4232673">:</span>&nbsp;<span class="op" id="4232675">[</span><span class="op" id="4232676">]</span><span class="builtintype" id="4232677">byte</span><span class="op" id="4232681">(</span><span class="string" id="4232682">&#34;\xFF\xFF\x00\x00&#34;</span><span class="op" id="4232700">)</span><span class="op" id="4232701">,</span>&nbsp;<span class="ident" id="4232703"><a href="/gostd/net/http/sniff.go.html#4234160">pat</a></span><span class="op" id="4232706">:</span>&nbsp;<span class="op" id="4232708">[</span><span class="op" id="4232709">]</span><span class="builtintype" id="4232710">byte</span><span class="op" id="4232714">(</span><span class="string" id="4232715">&#34;\xFF\xFE\x00\x00&#34;</span><span class="op" id="4232733">)</span><span class="op" id="4232734">,</span>&nbsp;<span class="ident" id="4232736"><a href="/gostd/net/http/sniff.go.html#4234188">ct</a></span><span class="op" id="4232738">:</span>&nbsp;<span class="string" id="4232740">&#34;text/plain;&nbsp;charset=utf-16le&#34;</span><span class="op" id="4232770">}</span><span class="op" id="4232771">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4232774">&amp;</span><span class="ident" id="4232775"><a href="/gostd/net/http/sniff.go.html#4234134">maskedSig</a></span><span class="op" id="4232784">{</span><span class="ident" id="4232785"><a href="/gostd/net/http/sniff.go.html#4234154">mask</a></span><span class="op" id="4232789">:</span>&nbsp;<span class="op" id="4232791">[</span><span class="op" id="4232792">]</span><span class="builtintype" id="4232793">byte</span><span class="op" id="4232797">(</span><span class="string" id="4232798">&#34;\xFF\xFF\xFF\x00&#34;</span><span class="op" id="4232816">)</span><span class="op" id="4232817">,</span>&nbsp;<span class="ident" id="4232819"><a href="/gostd/net/http/sniff.go.html#4234160">pat</a></span><span class="op" id="4232822">:</span>&nbsp;<span class="op" id="4232824">[</span><span class="op" id="4232825">]</span><span class="builtintype" id="4232826">byte</span><span class="op" id="4232830">(</span><span class="string" id="4232831">&#34;\xEF\xBB\xBF\x00&#34;</span><span class="op" id="4232849">)</span><span class="op" id="4232850">,</span>&nbsp;<span class="ident" id="4232852"><a href="/gostd/net/http/sniff.go.html#4234188">ct</a></span><span class="op" id="4232854">:</span>&nbsp;<span class="string" id="4232856">&#34;text/plain;&nbsp;charset=utf-8&#34;</span><span class="op" id="4232883">}</span><span class="op" id="4232884">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4232888">&amp;</span><span class="ident" id="4232889"><a href="/gostd/net/http/sniff.go.html#4233955">exactSig</a></span><span class="op" id="4232897">{</span><span class="op" id="4232898">[</span><span class="op" id="4232899">]</span><span class="builtintype" id="4232900">byte</span><span class="op" id="4232904">(</span><span class="string" id="4232905">&#34;GIF87a&#34;</span><span class="op" id="4232913">)</span><span class="op" id="4232914">,</span>&nbsp;<span class="string" id="4232916">&#34;image/gif&#34;</span><span class="op" id="4232927">}</span><span class="op" id="4232928">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4232931">&amp;</span><span class="ident" id="4232932"><a href="/gostd/net/http/sniff.go.html#4233955">exactSig</a></span><span class="op" id="4232940">{</span><span class="op" id="4232941">[</span><span class="op" id="4232942">]</span><span class="builtintype" id="4232943">byte</span><span class="op" id="4232947">(</span><span class="string" id="4232948">&#34;GIF89a&#34;</span><span class="op" id="4232956">)</span><span class="op" id="4232957">,</span>&nbsp;<span class="string" id="4232959">&#34;image/gif&#34;</span><span class="op" id="4232970">}</span><span class="op" id="4232971">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4232974">&amp;</span><span class="ident" id="4232975"><a href="/gostd/net/http/sniff.go.html#4233955">exactSig</a></span><span class="op" id="4232983">{</span><span class="op" id="4232984">[</span><span class="op" id="4232985">]</span><span class="builtintype" id="4232986">byte</span><span class="op" id="4232990">(</span><span class="string" id="4232991">&#34;\x89\x50\x4E\x47\x0D\x0A\x1A\x0A&#34;</span><span class="op" id="4233025">)</span><span class="op" id="4233026">,</span>&nbsp;<span class="string" id="4233028">&#34;image/png&#34;</span><span class="op" id="4233039">}</span><span class="op" id="4233040">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4233043">&amp;</span><span class="ident" id="4233044"><a href="/gostd/net/http/sniff.go.html#4233955">exactSig</a></span><span class="op" id="4233052">{</span><span class="op" id="4233053">[</span><span class="op" id="4233054">]</span><span class="builtintype" id="4233055">byte</span><span class="op" id="4233059">(</span><span class="string" id="4233060">&#34;\xFF\xD8\xFF&#34;</span><span class="op" id="4233074">)</span><span class="op" id="4233075">,</span>&nbsp;<span class="string" id="4233077">&#34;image/jpeg&#34;</span><span class="op" id="4233089">}</span><span class="op" id="4233090">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4233093">&amp;</span><span class="ident" id="4233094"><a href="/gostd/net/http/sniff.go.html#4233955">exactSig</a></span><span class="op" id="4233102">{</span><span class="op" id="4233103">[</span><span class="op" id="4233104">]</span><span class="builtintype" id="4233105">byte</span><span class="op" id="4233109">(</span><span class="string" id="4233110">&#34;BM&#34;</span><span class="op" id="4233114">)</span><span class="op" id="4233115">,</span>&nbsp;<span class="string" id="4233117">&#34;image/bmp&#34;</span><span class="op" id="4233128">}</span><span class="op" id="4233129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4233132">&amp;</span><span class="ident" id="4233133"><a href="/gostd/net/http/sniff.go.html#4234134">maskedSig</a></span><span class="op" id="4233142">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4233146"><a href="/gostd/net/http/sniff.go.html#4234154">mask</a></span><span class="op" id="4233150">:</span>&nbsp;<span class="op" id="4233152">[</span><span class="op" id="4233153">]</span><span class="builtintype" id="4233154">byte</span><span class="op" id="4233158">(</span><span class="string" id="4233159">&#34;\xFF\xFF\xFF\xFF\x00\x00\x00\x00\xFF\xFF\xFF\xFF\xFF\xFF&#34;</span><span class="op" id="4233217">)</span><span class="op" id="4233218">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4233222"><a href="/gostd/net/http/sniff.go.html#4234160">pat</a></span><span class="op" id="4233225">:</span>&nbsp;&nbsp;<span class="op" id="4233228">[</span><span class="op" id="4233229">]</span><span class="builtintype" id="4233230">byte</span><span class="op" id="4233234">(</span><span class="string" id="4233235">&#34;RIFF\x00\x00\x00\x00WEBPVP&#34;</span><span class="op" id="4233263">)</span><span class="op" id="4233264">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4233268"><a href="/gostd/net/http/sniff.go.html#4234188">ct</a></span><span class="op" id="4233270">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4233274">&#34;image/webp&#34;</span><span class="op" id="4233286">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4233289">}</span><span class="op" id="4233290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4233293">&amp;</span><span class="ident" id="4233294"><a href="/gostd/net/http/sniff.go.html#4233955">exactSig</a></span><span class="op" id="4233302">{</span><span class="op" id="4233303">[</span><span class="op" id="4233304">]</span><span class="builtintype" id="4233305">byte</span><span class="op" id="4233309">(</span><span class="string" id="4233310">&#34;\x00\x00\x01\x00&#34;</span><span class="op" id="4233328">)</span><span class="op" id="4233329">,</span>&nbsp;<span class="string" id="4233331">&#34;image/vnd.microsoft.icon&#34;</span><span class="op" id="4233357">}</span><span class="op" id="4233358">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4233361">&amp;</span><span class="ident" id="4233362"><a href="/gostd/net/http/sniff.go.html#4233955">exactSig</a></span><span class="op" id="4233370">{</span><span class="op" id="4233371">[</span><span class="op" id="4233372">]</span><span class="builtintype" id="4233373">byte</span><span class="op" id="4233377">(</span><span class="string" id="4233378">&#34;\x4F\x67\x67\x53\x00&#34;</span><span class="op" id="4233400">)</span><span class="op" id="4233401">,</span>&nbsp;<span class="string" id="4233403">&#34;application/ogg&#34;</span><span class="op" id="4233420">}</span><span class="op" id="4233421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4233424">&amp;</span><span class="ident" id="4233425"><a href="/gostd/net/http/sniff.go.html#4234134">maskedSig</a></span><span class="op" id="4233434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4233438"><a href="/gostd/net/http/sniff.go.html#4234154">mask</a></span><span class="op" id="4233442">:</span>&nbsp;<span class="op" id="4233444">[</span><span class="op" id="4233445">]</span><span class="builtintype" id="4233446">byte</span><span class="op" id="4233450">(</span><span class="string" id="4233451">&#34;\xFF\xFF\xFF\xFF\x00\x00\x00\x00\xFF\xFF\xFF\xFF&#34;</span><span class="op" id="4233501">)</span><span class="op" id="4233502">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4233506"><a href="/gostd/net/http/sniff.go.html#4234160">pat</a></span><span class="op" id="4233509">:</span>&nbsp;&nbsp;<span class="op" id="4233512">[</span><span class="op" id="4233513">]</span><span class="builtintype" id="4233514">byte</span><span class="op" id="4233518">(</span><span class="string" id="4233519">&#34;RIFF\x00\x00\x00\x00WAVE&#34;</span><span class="op" id="4233545">)</span><span class="op" id="4233546">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4233550"><a href="/gostd/net/http/sniff.go.html#4234188">ct</a></span><span class="op" id="4233552">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4233556">&#34;audio/wave&#34;</span><span class="op" id="4233568">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4233571">}</span><span class="op" id="4233572">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4233575">&amp;</span><span class="ident" id="4233576"><a href="/gostd/net/http/sniff.go.html#4233955">exactSig</a></span><span class="op" id="4233584">{</span><span class="op" id="4233585">[</span><span class="op" id="4233586">]</span><span class="builtintype" id="4233587">byte</span><span class="op" id="4233591">(</span><span class="string" id="4233592">&#34;\x1A\x45\xDF\xA3&#34;</span><span class="op" id="4233610">)</span><span class="op" id="4233611">,</span>&nbsp;<span class="string" id="4233613">&#34;video/webm&#34;</span><span class="op" id="4233625">}</span><span class="op" id="4233626">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4233629">&amp;</span><span class="ident" id="4233630"><a href="/gostd/net/http/sniff.go.html#4233955">exactSig</a></span><span class="op" id="4233638">{</span><span class="op" id="4233639">[</span><span class="op" id="4233640">]</span><span class="builtintype" id="4233641">byte</span><span class="op" id="4233645">(</span><span class="string" id="4233646">&#34;\x52\x61\x72\x20\x1A\x07\x00&#34;</span><span class="op" id="4233676">)</span><span class="op" id="4233677">,</span>&nbsp;<span class="string" id="4233679">&#34;application/x-rar-compressed&#34;</span><span class="op" id="4233709">}</span><span class="op" id="4233710">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4233713">&amp;</span><span class="ident" id="4233714"><a href="/gostd/net/http/sniff.go.html#4233955">exactSig</a></span><span class="op" id="4233722">{</span><span class="op" id="4233723">[</span><span class="op" id="4233724">]</span><span class="builtintype" id="4233725">byte</span><span class="op" id="4233729">(</span><span class="string" id="4233730">&#34;\x50\x4B\x03\x04&#34;</span><span class="op" id="4233748">)</span><span class="op" id="4233749">,</span>&nbsp;<span class="string" id="4233751">&#34;application/zip&#34;</span><span class="op" id="4233768">}</span><span class="op" id="4233769">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4233772">&amp;</span><span class="ident" id="4233773"><a href="/gostd/net/http/sniff.go.html#4233955">exactSig</a></span><span class="op" id="4233781">{</span><span class="op" id="4233782">[</span><span class="op" id="4233783">]</span><span class="builtintype" id="4233784">byte</span><span class="op" id="4233788">(</span><span class="string" id="4233789">&#34;\x1F\x8B\x08&#34;</span><span class="op" id="4233803">)</span><span class="op" id="4233804">,</span>&nbsp;<span class="string" id="4233806">&#34;application/x-gzip&#34;</span><span class="op" id="4233826">}</span><span class="op" id="4233827">,</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4233831">//&nbsp;TODO(dsymonds):&nbsp;Re-enable&nbsp;this&nbsp;when&nbsp;the&nbsp;spec&nbsp;is&nbsp;sorted&nbsp;w.r.t.&nbsp;MP4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4233902">//mp4Sig(0),</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4233917"><a href="/gostd/net/http/sniff.go.html#4235611">textSig</a></span><span class="op" id="4233924">(</span><span class="num" id="4233925">0</span><span class="op" id="4233926">)</span><span class="op" id="4233927">,</span>&nbsp;<span class="comment" id="4233929">//&nbsp;should&nbsp;be&nbsp;last</span><br>
<span class="lineno">105</span><span class="op" id="4233947">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4233950">type</span>&nbsp;<span class="ident" id="4233955">exactSig</span>&nbsp;<span class="keyword" id="4233964">struct</span>&nbsp;<span class="op" id="4233971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4233974">sig</span>&nbsp;<span class="op" id="4233978">[</span><span class="op" id="4233979">]</span><span class="builtintype" id="4233980">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4233986">ct</span>&nbsp;&nbsp;<span class="builtintype" id="4233990">string</span><br>
<span class="lineno">110</span><span class="op" id="4233997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4234000">func</span>&nbsp;<span class="op" id="4234005">(</span><span class="ident" id="4234006">e</span>&nbsp;<span class="op" id="4234008">*</span><span class="ident" id="4234009"><a href="/gostd/net/http/sniff.go.html#4233955">exactSig</a></span><span class="op" id="4234017">)</span>&nbsp;<span class="ident" id="4234019">match</span><span class="op" id="4234024">(</span><span class="ident" id="4234025">data</span>&nbsp;<span class="op" id="4234030">[</span><span class="op" id="4234031">]</span><span class="builtintype" id="4234032">byte</span><span class="op" id="4234036">,</span>&nbsp;<span class="ident" id="4234038">firstNonWS</span>&nbsp;<span class="builtintype" id="4234049">int</span><span class="op" id="4234052">)</span>&nbsp;<span class="builtintype" id="4234054">string</span>&nbsp;<span class="op" id="4234061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4234064">if</span>&nbsp;<span class="ident" id="4234067"><a href="/gostd/net/http/sniff.go.html#4230809">bytes</a></span><span class="op" id="4234072">.</span><span class="ident" id="4234073"><a href="/gostd/bytes/bytes.go.html#1403977">HasPrefix</a></span><span class="op" id="4234082">(</span><span class="ident" id="4234083"><a href="/gostd/net/http/sniff.go.html#4234025">data</a></span><span class="op" id="4234087">,</span>&nbsp;<span class="ident" id="4234089"><a href="/gostd/net/http/sniff.go.html#4234006">e</a></span><span class="op" id="4234090">.</span><span class="ident" id="4234091"><a href="/gostd/net/http/sniff.go.html#4233974">sig</a></span><span class="op" id="4234094">)</span>&nbsp;<span class="op" id="4234096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4234100">return</span>&nbsp;<span class="ident" id="4234107"><a href="/gostd/net/http/sniff.go.html#4234006">e</a></span><span class="op" id="4234108">.</span><span class="ident" id="4234109"><a href="/gostd/net/http/sniff.go.html#4233986">ct</a></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4234113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4234116">return</span>&nbsp;<span class="string" id="4234123">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="4234126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4234129">type</span>&nbsp;<span class="ident" id="4234134">maskedSig</span>&nbsp;<span class="keyword" id="4234144">struct</span>&nbsp;<span class="op" id="4234151">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4234154">mask</span><span class="op" id="4234158">,</span>&nbsp;<span class="ident" id="4234160">pat</span>&nbsp;<span class="op" id="4234164">[</span><span class="op" id="4234165">]</span><span class="builtintype" id="4234166">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4234172">skipWS</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4234182">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4234188">ct</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4234198">string</span><br>
<span class="lineno"></span><span class="op" id="4234205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="4234208">func</span>&nbsp;<span class="op" id="4234213">(</span><span class="ident" id="4234214">m</span>&nbsp;<span class="op" id="4234216">*</span><span class="ident" id="4234217"><a href="/gostd/net/http/sniff.go.html#4234134">maskedSig</a></span><span class="op" id="4234226">)</span>&nbsp;<span class="ident" id="4234228">match</span><span class="op" id="4234233">(</span><span class="ident" id="4234234">data</span>&nbsp;<span class="op" id="4234239">[</span><span class="op" id="4234240">]</span><span class="builtintype" id="4234241">byte</span><span class="op" id="4234245">,</span>&nbsp;<span class="ident" id="4234247">firstNonWS</span>&nbsp;<span class="builtintype" id="4234258">int</span><span class="op" id="4234261">)</span>&nbsp;<span class="builtintype" id="4234263">string</span>&nbsp;<span class="op" id="4234270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4234273">if</span>&nbsp;<span class="ident" id="4234276"><a href="/gostd/net/http/sniff.go.html#4234214">m</a></span><span class="op" id="4234277">.</span><span class="ident" id="4234278"><a href="/gostd/net/http/sniff.go.html#4234172">skipWS</a></span>&nbsp;<span class="op" id="4234285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4234289"><a href="/gostd/net/http/sniff.go.html#4234234">data</a></span>&nbsp;<span class="op" id="4234294">=</span>&nbsp;<span class="ident" id="4234296"><a href="/gostd/net/http/sniff.go.html#4234234">data</a></span><span class="op" id="4234300">[</span><span class="ident" id="4234301"><a href="/gostd/net/http/sniff.go.html#4234247">firstNonWS</a></span><span class="op" id="4234311">:</span><span class="op" id="4234312">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4234315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4234318">if</span>&nbsp;<span class="builtinfunc" id="4234321">len</span><span class="op" id="4234324">(</span><span class="ident" id="4234325"><a href="/gostd/net/http/sniff.go.html#4234234">data</a></span><span class="op" id="4234329">)</span>&nbsp;<span class="op" id="4234331">&lt;</span>&nbsp;<span class="builtinfunc" id="4234333">len</span><span class="op" id="4234336">(</span><span class="ident" id="4234337"><a href="/gostd/net/http/sniff.go.html#4234214">m</a></span><span class="op" id="4234338">.</span><span class="ident" id="4234339"><a href="/gostd/net/http/sniff.go.html#4234154">mask</a></span><span class="op" id="4234343">)</span>&nbsp;<span class="op" id="4234345">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4234349">return</span>&nbsp;<span class="string" id="4234356">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4234360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4234363">for</span>&nbsp;<span class="ident" id="4234367">i</span><span class="op" id="4234368">,</span>&nbsp;<span class="ident" id="4234370">mask</span>&nbsp;<span class="op" id="4234375">:=</span>&nbsp;<span class="keyword" id="4234378">range</span>&nbsp;<span class="ident" id="4234384"><a href="/gostd/net/http/sniff.go.html#4234214">m</a></span><span class="op" id="4234385">.</span><span class="ident" id="4234386"><a href="/gostd/net/http/sniff.go.html#4234154">mask</a></span>&nbsp;<span class="op" id="4234391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4234395">db</span>&nbsp;<span class="op" id="4234398">:=</span>&nbsp;<span class="ident" id="4234401"><a href="/gostd/net/http/sniff.go.html#4234234">data</a></span><span class="op" id="4234405">[</span><span class="ident" id="4234406"><a href="/gostd/net/http/sniff.go.html#4234367">i</a></span><span class="op" id="4234407">]</span>&nbsp;<span class="op" id="4234409">&amp;</span>&nbsp;<span class="ident" id="4234411"><a href="/gostd/net/http/sniff.go.html#4234370">mask</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4234418">if</span>&nbsp;<span class="ident" id="4234421"><a href="/gostd/net/http/sniff.go.html#4234395">db</a></span>&nbsp;<span class="op" id="4234424">!=</span>&nbsp;<span class="ident" id="4234427"><a href="/gostd/net/http/sniff.go.html#4234214">m</a></span><span class="op" id="4234428">.</span><span class="ident" id="4234429"><a href="/gostd/net/http/sniff.go.html#4234160">pat</a></span><span class="op" id="4234432">[</span><span class="ident" id="4234433"><a href="/gostd/net/http/sniff.go.html#4234367">i</a></span><span class="op" id="4234434">]</span>&nbsp;<span class="op" id="4234436">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4234441">return</span>&nbsp;<span class="string" id="4234448">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4234453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4234456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4234459">return</span>&nbsp;<span class="ident" id="4234466"><a href="/gostd/net/http/sniff.go.html#4234214">m</a></span><span class="op" id="4234467">.</span><span class="ident" id="4234468"><a href="/gostd/net/http/sniff.go.html#4234188">ct</a></span><br>
<span class="lineno"></span><span class="op" id="4234471">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="4234474">type</span>&nbsp;<span class="ident" id="4234479">htmlSig</span>&nbsp;<span class="op" id="4234487">[</span><span class="op" id="4234488">]</span><span class="builtintype" id="4234489">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4234495">func</span>&nbsp;<span class="op" id="4234500">(</span><span class="ident" id="4234501">h</span>&nbsp;<span class="ident" id="4234503"><a href="/gostd/net/http/sniff.go.html#4234479">htmlSig</a></span><span class="op" id="4234510">)</span>&nbsp;<span class="ident" id="4234512">match</span><span class="op" id="4234517">(</span><span class="ident" id="4234518">data</span>&nbsp;<span class="op" id="4234523">[</span><span class="op" id="4234524">]</span><span class="builtintype" id="4234525">byte</span><span class="op" id="4234529">,</span>&nbsp;<span class="ident" id="4234531">firstNonWS</span>&nbsp;<span class="builtintype" id="4234542">int</span><span class="op" id="4234545">)</span>&nbsp;<span class="builtintype" id="4234547">string</span>&nbsp;<span class="op" id="4234554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4234557"><a href="/gostd/net/http/sniff.go.html#4234518">data</a></span>&nbsp;<span class="op" id="4234562">=</span>&nbsp;<span class="ident" id="4234564"><a href="/gostd/net/http/sniff.go.html#4234518">data</a></span><span class="op" id="4234568">[</span><span class="ident" id="4234569"><a href="/gostd/net/http/sniff.go.html#4234531">firstNonWS</a></span><span class="op" id="4234579">:</span><span class="op" id="4234580">]</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4234583">if</span>&nbsp;<span class="builtinfunc" id="4234586">len</span><span class="op" id="4234589">(</span><span class="ident" id="4234590"><a href="/gostd/net/http/sniff.go.html#4234518">data</a></span><span class="op" id="4234594">)</span>&nbsp;<span class="op" id="4234596">&lt;</span>&nbsp;<span class="builtinfunc" id="4234598">len</span><span class="op" id="4234601">(</span><span class="ident" id="4234602"><a href="/gostd/net/http/sniff.go.html#4234501">h</a></span><span class="op" id="4234603">)</span><span class="op" id="4234604">+</span><span class="num" id="4234605">1</span>&nbsp;<span class="op" id="4234607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4234611">return</span>&nbsp;<span class="string" id="4234618">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4234622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4234625">for</span>&nbsp;<span class="ident" id="4234629">i</span><span class="op" id="4234630">,</span>&nbsp;<span class="ident" id="4234632">b</span>&nbsp;<span class="op" id="4234634">:=</span>&nbsp;<span class="keyword" id="4234637">range</span>&nbsp;<span class="ident" id="4234643"><a href="/gostd/net/http/sniff.go.html#4234501">h</a></span>&nbsp;<span class="op" id="4234645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4234649">db</span>&nbsp;<span class="op" id="4234652">:=</span>&nbsp;<span class="ident" id="4234655"><a href="/gostd/net/http/sniff.go.html#4234518">data</a></span><span class="op" id="4234659">[</span><span class="ident" id="4234660"><a href="/gostd/net/http/sniff.go.html#4234629">i</a></span><span class="op" id="4234661">]</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4234665">if</span>&nbsp;<span class="string" id="4234668">&#39;A&#39;</span>&nbsp;<span class="op" id="4234672">&lt;=</span>&nbsp;<span class="ident" id="4234675"><a href="/gostd/net/http/sniff.go.html#4234632">b</a></span>&nbsp;<span class="op" id="4234677">&amp;&amp;</span>&nbsp;<span class="ident" id="4234680"><a href="/gostd/net/http/sniff.go.html#4234632">b</a></span>&nbsp;<span class="op" id="4234682">&lt;=</span>&nbsp;<span class="string" id="4234685">&#39;Z&#39;</span>&nbsp;<span class="op" id="4234689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4234694"><a href="/gostd/net/http/sniff.go.html#4234649">db</a></span>&nbsp;<span class="op" id="4234697">&amp;=</span>&nbsp;<span class="num" id="4234700">0xDF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4234707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4234711">if</span>&nbsp;<span class="ident" id="4234714"><a href="/gostd/net/http/sniff.go.html#4234632">b</a></span>&nbsp;<span class="op" id="4234716">!=</span>&nbsp;<span class="ident" id="4234719"><a href="/gostd/net/http/sniff.go.html#4234649">db</a></span>&nbsp;<span class="op" id="4234722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4234727">return</span>&nbsp;<span class="string" id="4234734">&#34;&#34;</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4234739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4234742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4234745">//&nbsp;Next&nbsp;byte&nbsp;must&nbsp;be&nbsp;space&nbsp;or&nbsp;right&nbsp;angle&nbsp;bracket.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4234797">if</span>&nbsp;<span class="ident" id="4234800">db</span>&nbsp;<span class="op" id="4234803">:=</span>&nbsp;<span class="ident" id="4234806"><a href="/gostd/net/http/sniff.go.html#4234518">data</a></span><span class="op" id="4234810">[</span><span class="builtinfunc" id="4234811">len</span><span class="op" id="4234814">(</span><span class="ident" id="4234815"><a href="/gostd/net/http/sniff.go.html#4234501">h</a></span><span class="op" id="4234816">)</span><span class="op" id="4234817">]</span><span class="op" id="4234818">;</span>&nbsp;<span class="ident" id="4234820"><a href="/gostd/net/http/sniff.go.html#4234800">db</a></span>&nbsp;<span class="op" id="4234823">!=</span>&nbsp;<span class="string" id="4234826">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4234830">&amp;&amp;</span>&nbsp;<span class="ident" id="4234833"><a href="/gostd/net/http/sniff.go.html#4234800">db</a></span>&nbsp;<span class="op" id="4234836">!=</span>&nbsp;<span class="string" id="4234839">&#39;&gt;&#39;</span>&nbsp;<span class="op" id="4234843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4234847">return</span>&nbsp;<span class="string" id="4234854">&#34;&#34;</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4234858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4234861">return</span>&nbsp;<span class="string" id="4234868">&#34;text/html;&nbsp;charset=utf-8&#34;</span><br>
<span class="lineno"></span><span class="op" id="4234895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4234898">type</span>&nbsp;<span class="ident" id="4234903">mp4Sig</span>&nbsp;<span class="builtintype" id="4234910">int</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="4234915">func</span>&nbsp;<span class="op" id="4234920">(</span><span class="ident" id="4234921"><a href="/gostd/net/http/sniff.go.html#4234903">mp4Sig</a></span><span class="op" id="4234927">)</span>&nbsp;<span class="ident" id="4234929">match</span><span class="op" id="4234934">(</span><span class="ident" id="4234935">data</span>&nbsp;<span class="op" id="4234940">[</span><span class="op" id="4234941">]</span><span class="builtintype" id="4234942">byte</span><span class="op" id="4234946">,</span>&nbsp;<span class="ident" id="4234948">firstNonWS</span>&nbsp;<span class="builtintype" id="4234959">int</span><span class="op" id="4234962">)</span>&nbsp;<span class="builtintype" id="4234964">string</span>&nbsp;<span class="op" id="4234971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4234974">//&nbsp;c.f.&nbsp;section&nbsp;6.1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4234996">if</span>&nbsp;<span class="builtinfunc" id="4234999">len</span><span class="op" id="4235002">(</span><span class="ident" id="4235003"><a href="/gostd/net/http/sniff.go.html#4234935">data</a></span><span class="op" id="4235007">)</span>&nbsp;<span class="op" id="4235009">&lt;</span>&nbsp;<span class="num" id="4235011">8</span>&nbsp;<span class="op" id="4235013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4235017">return</span>&nbsp;<span class="string" id="4235024">&#34;&#34;</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4235028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4235031">boxSize</span>&nbsp;<span class="op" id="4235039">:=</span>&nbsp;<span class="builtintype" id="4235042">int</span><span class="op" id="4235045">(</span><span class="ident" id="4235046"><a href="/gostd/net/http/sniff.go.html#4230818">binary</a></span><span class="op" id="4235052">.</span><span class="ident" id="4235053"><a href="/gostd/encoding/binary/binary.go.html#2987146">BigEndian</a></span><span class="op" id="4235062">.</span><span class="ident" id="4235063"><a href="/gostd/encoding/binary/binary.go.html#2988414">Uint32</a></span><span class="op" id="4235069">(</span><span class="ident" id="4235070"><a href="/gostd/net/http/sniff.go.html#4234935">data</a></span><span class="op" id="4235074">[</span><span class="op" id="4235075">:</span><span class="num" id="4235076">4</span><span class="op" id="4235077">]</span><span class="op" id="4235078">)</span><span class="op" id="4235079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4235082">if</span>&nbsp;<span class="ident" id="4235085"><a href="/gostd/net/http/sniff.go.html#4235031">boxSize</a></span><span class="op" id="4235092">%</span><span class="num" id="4235093">4</span>&nbsp;<span class="op" id="4235095">!=</span>&nbsp;<span class="num" id="4235098">0</span>&nbsp;<span class="op" id="4235100">||</span>&nbsp;<span class="builtinfunc" id="4235103">len</span><span class="op" id="4235106">(</span><span class="ident" id="4235107"><a href="/gostd/net/http/sniff.go.html#4234935">data</a></span><span class="op" id="4235111">)</span>&nbsp;<span class="op" id="4235113">&lt;</span>&nbsp;<span class="ident" id="4235115"><a href="/gostd/net/http/sniff.go.html#4235031">boxSize</a></span>&nbsp;<span class="op" id="4235123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4235127">return</span>&nbsp;<span class="string" id="4235134">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4235138">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4235141">if</span>&nbsp;<span class="op" id="4235144">!</span><span class="ident" id="4235145"><a href="/gostd/net/http/sniff.go.html#4230809">bytes</a></span><span class="op" id="4235150">.</span><span class="ident" id="4235151"><a href="/gostd/bytes/bytes_decl.go.html#1414806">Equal</a></span><span class="op" id="4235156">(</span><span class="ident" id="4235157"><a href="/gostd/net/http/sniff.go.html#4234935">data</a></span><span class="op" id="4235161">[</span><span class="num" id="4235162">4</span><span class="op" id="4235163">:</span><span class="num" id="4235164">8</span><span class="op" id="4235165">]</span><span class="op" id="4235166">,</span>&nbsp;<span class="op" id="4235168">[</span><span class="op" id="4235169">]</span><span class="builtintype" id="4235170">byte</span><span class="op" id="4235174">(</span><span class="string" id="4235175">&#34;ftyp&#34;</span><span class="op" id="4235181">)</span><span class="op" id="4235182">)</span>&nbsp;<span class="op" id="4235184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4235188">return</span>&nbsp;<span class="string" id="4235195">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4235199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4235202">for</span>&nbsp;<span class="ident" id="4235206">st</span>&nbsp;<span class="op" id="4235209">:=</span>&nbsp;<span class="num" id="4235212">8</span><span class="op" id="4235213">;</span>&nbsp;<span class="ident" id="4235215"><a href="/gostd/net/http/sniff.go.html#4235206">st</a></span>&nbsp;<span class="op" id="4235218">&lt;</span>&nbsp;<span class="ident" id="4235220"><a href="/gostd/net/http/sniff.go.html#4235031">boxSize</a></span><span class="op" id="4235227">;</span>&nbsp;<span class="ident" id="4235229"><a href="/gostd/net/http/sniff.go.html#4235206">st</a></span>&nbsp;<span class="op" id="4235232">+=</span>&nbsp;<span class="num" id="4235235">4</span>&nbsp;<span class="op" id="4235237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4235241">if</span>&nbsp;<span class="ident" id="4235244"><a href="/gostd/net/http/sniff.go.html#4235206">st</a></span>&nbsp;<span class="op" id="4235247">==</span>&nbsp;<span class="num" id="4235250">12</span>&nbsp;<span class="op" id="4235253">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4235258">//&nbsp;minor&nbsp;version&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4235285">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4235296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4235300">seg</span>&nbsp;<span class="op" id="4235304">:=</span>&nbsp;<span class="builtintype" id="4235307">string</span><span class="op" id="4235313">(</span><span class="ident" id="4235314"><a href="/gostd/net/http/sniff.go.html#4234935">data</a></span><span class="op" id="4235318">[</span><span class="ident" id="4235319"><a href="/gostd/net/http/sniff.go.html#4235206">st</a></span>&nbsp;<span class="op" id="4235322">:</span>&nbsp;<span class="ident" id="4235324"><a href="/gostd/net/http/sniff.go.html#4235206">st</a></span><span class="op" id="4235326">+</span><span class="num" id="4235327">3</span><span class="op" id="4235328">]</span><span class="op" id="4235329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4235333">switch</span>&nbsp;<span class="ident" id="4235340"><a href="/gostd/net/http/sniff.go.html#4235300">seg</a></span>&nbsp;<span class="op" id="4235344">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4235348">case</span>&nbsp;<span class="string" id="4235353">&#34;mp4&#34;</span><span class="op" id="4235358">,</span>&nbsp;<span class="string" id="4235360">&#34;iso&#34;</span><span class="op" id="4235365">,</span>&nbsp;<span class="string" id="4235367">&#34;M4V&#34;</span><span class="op" id="4235372">,</span>&nbsp;<span class="string" id="4235374">&#34;M4P&#34;</span><span class="op" id="4235379">,</span>&nbsp;<span class="string" id="4235381">&#34;M4B&#34;</span><span class="op" id="4235386">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4235391">return</span>&nbsp;<span class="string" id="4235398">&#34;video/mp4&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4235413">/*&nbsp;The&nbsp;remainder&nbsp;are&nbsp;not&nbsp;in&nbsp;the&nbsp;spec.<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;&#34;M4A&#34;:<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&#34;audio/mp4&#34;<br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;&#34;3gp&#34;:<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&#34;video/3gpp&#34;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;&#34;jp2&#34;:<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&#34;image/jp2&#34;&nbsp;//&nbsp;JPEG&nbsp;2000<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4235587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4235590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4235593">return</span>&nbsp;<span class="string" id="4235600">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="4235603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="4235606">type</span>&nbsp;<span class="ident" id="4235611">textSig</span>&nbsp;<span class="builtintype" id="4235619">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4235624">func</span>&nbsp;<span class="op" id="4235629">(</span><span class="ident" id="4235630"><a href="/gostd/net/http/sniff.go.html#4235611">textSig</a></span><span class="op" id="4235637">)</span>&nbsp;<span class="ident" id="4235639">match</span><span class="op" id="4235644">(</span><span class="ident" id="4235645">data</span>&nbsp;<span class="op" id="4235650">[</span><span class="op" id="4235651">]</span><span class="builtintype" id="4235652">byte</span><span class="op" id="4235656">,</span>&nbsp;<span class="ident" id="4235658">firstNonWS</span>&nbsp;<span class="builtintype" id="4235669">int</span><span class="op" id="4235672">)</span>&nbsp;<span class="builtintype" id="4235674">string</span>&nbsp;<span class="op" id="4235681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4235684">//&nbsp;c.f.&nbsp;section&nbsp;5,&nbsp;step&nbsp;4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4235712">for</span>&nbsp;<span class="ident" id="4235716">_</span><span class="op" id="4235717">,</span>&nbsp;<span class="ident" id="4235719">b</span>&nbsp;<span class="op" id="4235721">:=</span>&nbsp;<span class="keyword" id="4235724">range</span>&nbsp;<span class="ident" id="4235730"><a href="/gostd/net/http/sniff.go.html#4235645">data</a></span><span class="op" id="4235734">[</span><span class="ident" id="4235735"><a href="/gostd/net/http/sniff.go.html#4235658">firstNonWS</a></span><span class="op" id="4235745">:</span><span class="op" id="4235746">]</span>&nbsp;<span class="op" id="4235748">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4235752">switch</span>&nbsp;<span class="op" id="4235759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4235763">case</span>&nbsp;<span class="num" id="4235768">0x00</span>&nbsp;<span class="op" id="4235773">&lt;=</span>&nbsp;<span class="ident" id="4235776"><a href="/gostd/net/http/sniff.go.html#4235719">b</a></span>&nbsp;<span class="op" id="4235778">&amp;&amp;</span>&nbsp;<span class="ident" id="4235781"><a href="/gostd/net/http/sniff.go.html#4235719">b</a></span>&nbsp;<span class="op" id="4235783">&lt;=</span>&nbsp;<span class="num" id="4235786">0x08</span><span class="op" id="4235790">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4235795"><a href="/gostd/net/http/sniff.go.html#4235719">b</a></span>&nbsp;<span class="op" id="4235797">==</span>&nbsp;<span class="num" id="4235800">0x0B</span><span class="op" id="4235804">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4235809">0x0E</span>&nbsp;<span class="op" id="4235814">&lt;=</span>&nbsp;<span class="ident" id="4235817"><a href="/gostd/net/http/sniff.go.html#4235719">b</a></span>&nbsp;<span class="op" id="4235819">&amp;&amp;</span>&nbsp;<span class="ident" id="4235822"><a href="/gostd/net/http/sniff.go.html#4235719">b</a></span>&nbsp;<span class="op" id="4235824">&lt;=</span>&nbsp;<span class="num" id="4235827">0x1A</span><span class="op" id="4235831">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4235836">0x1C</span>&nbsp;<span class="op" id="4235841">&lt;=</span>&nbsp;<span class="ident" id="4235844"><a href="/gostd/net/http/sniff.go.html#4235719">b</a></span>&nbsp;<span class="op" id="4235846">&amp;&amp;</span>&nbsp;<span class="ident" id="4235849"><a href="/gostd/net/http/sniff.go.html#4235719">b</a></span>&nbsp;<span class="op" id="4235851">&lt;=</span>&nbsp;<span class="num" id="4235854">0x1F</span><span class="op" id="4235858">:</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4235863">return</span>&nbsp;<span class="string" id="4235870">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4235875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4235878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4235881">return</span>&nbsp;<span class="string" id="4235888">&#34;text/plain;&nbsp;charset=utf-8&#34;</span><br>
<span class="lineno"></span><span class="op" id="4235916">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
