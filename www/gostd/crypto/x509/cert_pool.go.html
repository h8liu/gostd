<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html" class="current">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4613181">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4613236">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4613290">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4613341">package</span>&nbsp;<span class="ident" id="4613349">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4613355">import</span>&nbsp;<span class="op" id="4613362">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4613365">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span><span class="op" id="4613380">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="4613383">//&nbsp;CertPool&nbsp;is&nbsp;a&nbsp;set&nbsp;of&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="keyword" id="4613421">type</span>&nbsp;<span class="ident" id="4613426">CertPool</span>&nbsp;<span class="keyword" id="4613435">struct</span>&nbsp;<span class="op" id="4613442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4613445">bySubjectKeyId</span>&nbsp;<span class="keyword" id="4613460">map</span><span class="op" id="4613463">[</span><span class="builtintype" id="4613464">string</span><span class="op" id="4613470">]</span><span class="op" id="4613471">[</span><span class="op" id="4613472">]</span><span class="builtintype" id="4613473">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4613478">byName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4613493">map</span><span class="op" id="4613496">[</span><span class="builtintype" id="4613497">string</span><span class="op" id="4613503">]</span><span class="op" id="4613504">[</span><span class="op" id="4613505">]</span><span class="builtintype" id="4613506">int</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4613511">certs</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4613526">[</span><span class="op" id="4613527">]</span><span class="op" id="4613528">*</span><span class="ident" id="4613529"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><br>
<span class="lineno"></span><span class="op" id="4613541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4613544">//&nbsp;NewCertPool&nbsp;returns&nbsp;a&nbsp;new,&nbsp;empty&nbsp;CertPool.</span><br>
<span class="lineno"></span><span class="keyword" id="4613590">func</span>&nbsp;<span class="ident" id="4613595">NewCertPool</span><span class="op" id="4613606">(</span><span class="op" id="4613607">)</span>&nbsp;<span class="op" id="4613609">*</span><span class="ident" id="4613610"><a href="/gostd/crypto/x509/cert_pool.go.html#4613426">CertPool</a></span>&nbsp;<span class="op" id="4613619">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4613622">return</span>&nbsp;<span class="op" id="4613629">&amp;</span><span class="ident" id="4613630"><a href="/gostd/crypto/x509/cert_pool.go.html#4613426">CertPool</a></span><span class="op" id="4613638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4613642">make</span><span class="op" id="4613646">(</span><span class="keyword" id="4613647">map</span><span class="op" id="4613650">[</span><span class="builtintype" id="4613651">string</span><span class="op" id="4613657">]</span><span class="op" id="4613658">[</span><span class="op" id="4613659">]</span><span class="builtintype" id="4613660">int</span><span class="op" id="4613663">)</span><span class="op" id="4613664">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4613668">make</span><span class="op" id="4613672">(</span><span class="keyword" id="4613673">map</span><span class="op" id="4613676">[</span><span class="builtintype" id="4613677">string</span><span class="op" id="4613683">]</span><span class="op" id="4613684">[</span><span class="op" id="4613685">]</span><span class="builtintype" id="4613686">int</span><span class="op" id="4613689">)</span><span class="op" id="4613690">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4613694">nil</span><span class="op" id="4613697">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4613700">}</span><br>
<span class="lineno">25</span><span class="op" id="4613702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4613705">//&nbsp;findVerifiedParents&nbsp;attempts&nbsp;to&nbsp;find&nbsp;certificates&nbsp;in&nbsp;s&nbsp;which&nbsp;have&nbsp;signed&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4613785">//&nbsp;given&nbsp;certificate.&nbsp;If&nbsp;any&nbsp;candidates&nbsp;were&nbsp;rejected&nbsp;then&nbsp;errCert&nbsp;will&nbsp;be&nbsp;set</span><br>
<span class="lineno"></span><span class="comment" id="4613864">//&nbsp;to&nbsp;one&nbsp;of&nbsp;them,&nbsp;arbitrarily,&nbsp;and&nbsp;err&nbsp;will&nbsp;contain&nbsp;the&nbsp;reason&nbsp;that&nbsp;it&nbsp;was</span><br>
<span class="lineno">30</span><span class="comment" id="4613940">//&nbsp;rejected.</span><br>
<span class="lineno"></span><span class="keyword" id="4613953">func</span>&nbsp;<span class="op" id="4613958">(</span><span class="ident" id="4613959">s</span>&nbsp;<span class="op" id="4613961">*</span><span class="ident" id="4613962"><a href="/gostd/crypto/x509/cert_pool.go.html#4613426">CertPool</a></span><span class="op" id="4613970">)</span>&nbsp;<span class="ident" id="4613972">findVerifiedParents</span><span class="op" id="4613991">(</span><span class="ident" id="4613992">cert</span>&nbsp;<span class="op" id="4613997">*</span><span class="ident" id="4613998"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4614009">)</span>&nbsp;<span class="op" id="4614011">(</span><span class="ident" id="4614012">parents</span>&nbsp;<span class="op" id="4614020">[</span><span class="op" id="4614021">]</span><span class="builtintype" id="4614022">int</span><span class="op" id="4614025">,</span>&nbsp;<span class="ident" id="4614027">errCert</span>&nbsp;<span class="op" id="4614035">*</span><span class="ident" id="4614036"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4614047">,</span>&nbsp;<span class="ident" id="4614049">err</span>&nbsp;<span class="builtintype" id="4614053">error</span><span class="op" id="4614058">)</span>&nbsp;<span class="op" id="4614060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4614063">if</span>&nbsp;<span class="ident" id="4614066"><a href="/gostd/crypto/x509/cert_pool.go.html#4613959">s</a></span>&nbsp;<span class="op" id="4614068">==</span>&nbsp;<span class="builtintype" id="4614071">nil</span>&nbsp;<span class="op" id="4614075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4614079">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4614087">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4614090">var</span>&nbsp;<span class="ident" id="4614094">candidates</span>&nbsp;<span class="op" id="4614105">[</span><span class="op" id="4614106">]</span><span class="builtintype" id="4614107">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4614113">if</span>&nbsp;<span class="builtinfunc" id="4614116">len</span><span class="op" id="4614119">(</span><span class="ident" id="4614120"><a href="/gostd/crypto/x509/cert_pool.go.html#4613992">cert</a></span><span class="op" id="4614124">.</span><span class="ident" id="4614125"><a href="/gostd/crypto/x509/x509.go.html#4661687">AuthorityKeyId</a></span><span class="op" id="4614139">)</span>&nbsp;<span class="op" id="4614141">&gt;</span>&nbsp;<span class="num" id="4614143">0</span>&nbsp;<span class="op" id="4614145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4614149"><a href="/gostd/crypto/x509/cert_pool.go.html#4614094">candidates</a></span>&nbsp;<span class="op" id="4614160">=</span>&nbsp;<span class="ident" id="4614162"><a href="/gostd/crypto/x509/cert_pool.go.html#4613959">s</a></span><span class="op" id="4614163">.</span><span class="ident" id="4614164"><a href="/gostd/crypto/x509/cert_pool.go.html#4613445">bySubjectKeyId</a></span><span class="op" id="4614178">[</span><span class="builtintype" id="4614179">string</span><span class="op" id="4614185">(</span><span class="ident" id="4614186"><a href="/gostd/crypto/x509/cert_pool.go.html#4613992">cert</a></span><span class="op" id="4614190">.</span><span class="ident" id="4614191"><a href="/gostd/crypto/x509/x509.go.html#4661687">AuthorityKeyId</a></span><span class="op" id="4614205">)</span><span class="op" id="4614206">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4614209">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4614212">if</span>&nbsp;<span class="builtinfunc" id="4614215">len</span><span class="op" id="4614218">(</span><span class="ident" id="4614219"><a href="/gostd/crypto/x509/cert_pool.go.html#4614094">candidates</a></span><span class="op" id="4614229">)</span>&nbsp;<span class="op" id="4614231">==</span>&nbsp;<span class="num" id="4614234">0</span>&nbsp;<span class="op" id="4614236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4614240"><a href="/gostd/crypto/x509/cert_pool.go.html#4614094">candidates</a></span>&nbsp;<span class="op" id="4614251">=</span>&nbsp;<span class="ident" id="4614253"><a href="/gostd/crypto/x509/cert_pool.go.html#4613959">s</a></span><span class="op" id="4614254">.</span><span class="ident" id="4614255"><a href="/gostd/crypto/x509/cert_pool.go.html#4613478">byName</a></span><span class="op" id="4614261">[</span><span class="builtintype" id="4614262">string</span><span class="op" id="4614268">(</span><span class="ident" id="4614269"><a href="/gostd/crypto/x509/cert_pool.go.html#4613992">cert</a></span><span class="op" id="4614273">.</span><span class="ident" id="4614274"><a href="/gostd/crypto/x509/x509.go.html#4660102">RawIssuer</a></span><span class="op" id="4614283">)</span><span class="op" id="4614284">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4614287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4614291">for</span>&nbsp;<span class="ident" id="4614295">_</span><span class="op" id="4614296">,</span>&nbsp;<span class="ident" id="4614298">c</span>&nbsp;<span class="op" id="4614300">:=</span>&nbsp;<span class="keyword" id="4614303">range</span>&nbsp;<span class="ident" id="4614309"><a href="/gostd/crypto/x509/cert_pool.go.html#4614094">candidates</a></span>&nbsp;<span class="op" id="4614320">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4614324">if</span>&nbsp;<span class="ident" id="4614327"><a href="/gostd/crypto/x509/cert_pool.go.html#4614049">err</a></span>&nbsp;<span class="op" id="4614331">=</span>&nbsp;<span class="ident" id="4614333"><a href="/gostd/crypto/x509/cert_pool.go.html#4613992">cert</a></span><span class="op" id="4614337">.</span><span class="ident" id="4614338"><a href="/gostd/crypto/x509/x509.go.html#4665300">CheckSignatureFrom</a></span><span class="op" id="4614356">(</span><span class="ident" id="4614357"><a href="/gostd/crypto/x509/cert_pool.go.html#4613959">s</a></span><span class="op" id="4614358">.</span><span class="ident" id="4614359"><a href="/gostd/crypto/x509/cert_pool.go.html#4613511">certs</a></span><span class="op" id="4614364">[</span><span class="ident" id="4614365"><a href="/gostd/crypto/x509/cert_pool.go.html#4614298">c</a></span><span class="op" id="4614366">]</span><span class="op" id="4614367">)</span><span class="op" id="4614368">;</span>&nbsp;<span class="ident" id="4614370"><a href="/gostd/crypto/x509/cert_pool.go.html#4614049">err</a></span>&nbsp;<span class="op" id="4614374">==</span>&nbsp;<span class="builtintype" id="4614377">nil</span>&nbsp;<span class="op" id="4614381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4614386"><a href="/gostd/crypto/x509/cert_pool.go.html#4614012">parents</a></span>&nbsp;<span class="op" id="4614394">=</span>&nbsp;<span class="builtinfunc" id="4614396">append</span><span class="op" id="4614402">(</span><span class="ident" id="4614403"><a href="/gostd/crypto/x509/cert_pool.go.html#4614012">parents</a></span><span class="op" id="4614410">,</span>&nbsp;<span class="ident" id="4614412"><a href="/gostd/crypto/x509/cert_pool.go.html#4614298">c</a></span><span class="op" id="4614413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4614417">}</span>&nbsp;<span class="keyword" id="4614419">else</span>&nbsp;<span class="op" id="4614424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4614429"><a href="/gostd/crypto/x509/cert_pool.go.html#4614027">errCert</a></span>&nbsp;<span class="op" id="4614437">=</span>&nbsp;<span class="ident" id="4614439"><a href="/gostd/crypto/x509/cert_pool.go.html#4613959">s</a></span><span class="op" id="4614440">.</span><span class="ident" id="4614441"><a href="/gostd/crypto/x509/cert_pool.go.html#4613511">certs</a></span><span class="op" id="4614446">[</span><span class="ident" id="4614447"><a href="/gostd/crypto/x509/cert_pool.go.html#4614298">c</a></span><span class="op" id="4614448">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4614452">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4614455">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4614459">return</span><br>
<span class="lineno"></span><span class="op" id="4614466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="4614469">//&nbsp;AddCert&nbsp;adds&nbsp;a&nbsp;certificate&nbsp;to&nbsp;a&nbsp;pool.</span><br>
<span class="lineno"></span><span class="keyword" id="4614510">func</span>&nbsp;<span class="op" id="4614515">(</span><span class="ident" id="4614516">s</span>&nbsp;<span class="op" id="4614518">*</span><span class="ident" id="4614519"><a href="/gostd/crypto/x509/cert_pool.go.html#4613426">CertPool</a></span><span class="op" id="4614527">)</span>&nbsp;<span class="ident" id="4614529">AddCert</span><span class="op" id="4614536">(</span><span class="ident" id="4614537">cert</span>&nbsp;<span class="op" id="4614542">*</span><span class="ident" id="4614543"><a href="/gostd/crypto/x509/x509.go.html#4659766">Certificate</a></span><span class="op" id="4614554">)</span>&nbsp;<span class="op" id="4614556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4614559">if</span>&nbsp;<span class="ident" id="4614562"><a href="/gostd/crypto/x509/cert_pool.go.html#4614537">cert</a></span>&nbsp;<span class="op" id="4614567">==</span>&nbsp;<span class="builtintype" id="4614570">nil</span>&nbsp;<span class="op" id="4614574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4614578">panic</span><span class="op" id="4614583">(</span><span class="string" id="4614584">&#34;adding&nbsp;nil&nbsp;Certificate&nbsp;to&nbsp;CertPool&#34;</span><span class="op" id="4614620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4614623">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4614627">//&nbsp;Check&nbsp;that&nbsp;the&nbsp;certificate&nbsp;isn&#39;t&nbsp;being&nbsp;added&nbsp;twice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4614683">for</span>&nbsp;<span class="ident" id="4614687">_</span><span class="op" id="4614688">,</span>&nbsp;<span class="ident" id="4614690">c</span>&nbsp;<span class="op" id="4614692">:=</span>&nbsp;<span class="keyword" id="4614695">range</span>&nbsp;<span class="ident" id="4614701"><a href="/gostd/crypto/x509/cert_pool.go.html#4614516">s</a></span><span class="op" id="4614702">.</span><span class="ident" id="4614703"><a href="/gostd/crypto/x509/cert_pool.go.html#4613511">certs</a></span>&nbsp;<span class="op" id="4614709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4614713">if</span>&nbsp;<span class="ident" id="4614716"><a href="/gostd/crypto/x509/cert_pool.go.html#4614690">c</a></span><span class="op" id="4614717">.</span><span class="ident" id="4614718"><a href="/gostd/crypto/x509/x509.go.html#4662828">Equal</a></span><span class="op" id="4614723">(</span><span class="ident" id="4614724"><a href="/gostd/crypto/x509/cert_pool.go.html#4614537">cert</a></span><span class="op" id="4614728">)</span>&nbsp;<span class="op" id="4614730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4614735">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4614744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4614747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4614751">n</span>&nbsp;<span class="op" id="4614753">:=</span>&nbsp;<span class="builtinfunc" id="4614756">len</span><span class="op" id="4614759">(</span><span class="ident" id="4614760"><a href="/gostd/crypto/x509/cert_pool.go.html#4614516">s</a></span><span class="op" id="4614761">.</span><span class="ident" id="4614762"><a href="/gostd/crypto/x509/cert_pool.go.html#4613511">certs</a></span><span class="op" id="4614767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4614770"><a href="/gostd/crypto/x509/cert_pool.go.html#4614516">s</a></span><span class="op" id="4614771">.</span><span class="ident" id="4614772"><a href="/gostd/crypto/x509/cert_pool.go.html#4613511">certs</a></span>&nbsp;<span class="op" id="4614778">=</span>&nbsp;<span class="builtinfunc" id="4614780">append</span><span class="op" id="4614786">(</span><span class="ident" id="4614787"><a href="/gostd/crypto/x509/cert_pool.go.html#4614516">s</a></span><span class="op" id="4614788">.</span><span class="ident" id="4614789"><a href="/gostd/crypto/x509/cert_pool.go.html#4613511">certs</a></span><span class="op" id="4614794">,</span>&nbsp;<span class="ident" id="4614796"><a href="/gostd/crypto/x509/cert_pool.go.html#4614537">cert</a></span><span class="op" id="4614800">)</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4614804">if</span>&nbsp;<span class="builtinfunc" id="4614807">len</span><span class="op" id="4614810">(</span><span class="ident" id="4614811"><a href="/gostd/crypto/x509/cert_pool.go.html#4614537">cert</a></span><span class="op" id="4614815">.</span><span class="ident" id="4614816"><a href="/gostd/crypto/x509/x509.go.html#4661664">SubjectKeyId</a></span><span class="op" id="4614828">)</span>&nbsp;<span class="op" id="4614830">&gt;</span>&nbsp;<span class="num" id="4614832">0</span>&nbsp;<span class="op" id="4614834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4614838">keyId</span>&nbsp;<span class="op" id="4614844">:=</span>&nbsp;<span class="builtintype" id="4614847">string</span><span class="op" id="4614853">(</span><span class="ident" id="4614854"><a href="/gostd/crypto/x509/cert_pool.go.html#4614537">cert</a></span><span class="op" id="4614858">.</span><span class="ident" id="4614859"><a href="/gostd/crypto/x509/x509.go.html#4661664">SubjectKeyId</a></span><span class="op" id="4614871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4614875"><a href="/gostd/crypto/x509/cert_pool.go.html#4614516">s</a></span><span class="op" id="4614876">.</span><span class="ident" id="4614877"><a href="/gostd/crypto/x509/cert_pool.go.html#4613445">bySubjectKeyId</a></span><span class="op" id="4614891">[</span><span class="ident" id="4614892"><a href="/gostd/crypto/x509/cert_pool.go.html#4614838">keyId</a></span><span class="op" id="4614897">]</span>&nbsp;<span class="op" id="4614899">=</span>&nbsp;<span class="builtinfunc" id="4614901">append</span><span class="op" id="4614907">(</span><span class="ident" id="4614908"><a href="/gostd/crypto/x509/cert_pool.go.html#4614516">s</a></span><span class="op" id="4614909">.</span><span class="ident" id="4614910"><a href="/gostd/crypto/x509/cert_pool.go.html#4613445">bySubjectKeyId</a></span><span class="op" id="4614924">[</span><span class="ident" id="4614925"><a href="/gostd/crypto/x509/cert_pool.go.html#4614838">keyId</a></span><span class="op" id="4614930">]</span><span class="op" id="4614931">,</span>&nbsp;<span class="ident" id="4614933"><a href="/gostd/crypto/x509/cert_pool.go.html#4614751">n</a></span><span class="op" id="4614934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4614937">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4614940">name</span>&nbsp;<span class="op" id="4614945">:=</span>&nbsp;<span class="builtintype" id="4614948">string</span><span class="op" id="4614954">(</span><span class="ident" id="4614955"><a href="/gostd/crypto/x509/cert_pool.go.html#4614537">cert</a></span><span class="op" id="4614959">.</span><span class="ident" id="4614960"><a href="/gostd/crypto/x509/x509.go.html#4660047">RawSubject</a></span><span class="op" id="4614970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4614973"><a href="/gostd/crypto/x509/cert_pool.go.html#4614516">s</a></span><span class="op" id="4614974">.</span><span class="ident" id="4614975"><a href="/gostd/crypto/x509/cert_pool.go.html#4613478">byName</a></span><span class="op" id="4614981">[</span><span class="ident" id="4614982"><a href="/gostd/crypto/x509/cert_pool.go.html#4614940">name</a></span><span class="op" id="4614986">]</span>&nbsp;<span class="op" id="4614988">=</span>&nbsp;<span class="builtinfunc" id="4614990">append</span><span class="op" id="4614996">(</span><span class="ident" id="4614997"><a href="/gostd/crypto/x509/cert_pool.go.html#4614516">s</a></span><span class="op" id="4614998">.</span><span class="ident" id="4614999"><a href="/gostd/crypto/x509/cert_pool.go.html#4613478">byName</a></span><span class="op" id="4615005">[</span><span class="ident" id="4615006"><a href="/gostd/crypto/x509/cert_pool.go.html#4614940">name</a></span><span class="op" id="4615010">]</span><span class="op" id="4615011">,</span>&nbsp;<span class="ident" id="4615013"><a href="/gostd/crypto/x509/cert_pool.go.html#4614751">n</a></span><span class="op" id="4615014">)</span><br>
<span class="lineno"></span><span class="op" id="4615016">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4615019">//&nbsp;AppendCertsFromPEM&nbsp;attempts&nbsp;to&nbsp;parse&nbsp;a&nbsp;series&nbsp;of&nbsp;PEM&nbsp;encoded&nbsp;certificates.</span><br>
<span class="lineno">80</span><span class="comment" id="4615097">//&nbsp;It&nbsp;appends&nbsp;any&nbsp;certificates&nbsp;found&nbsp;to&nbsp;s&nbsp;and&nbsp;returns&nbsp;true&nbsp;if&nbsp;any&nbsp;certificates</span><br>
<span class="lineno"></span><span class="comment" id="4615176">//&nbsp;were&nbsp;successfully&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="comment" id="4615205">//</span><br>
<span class="lineno"></span><span class="comment" id="4615208">//&nbsp;On&nbsp;many&nbsp;Linux&nbsp;systems,&nbsp;/etc/ssl/cert.pem&nbsp;will&nbsp;contain&nbsp;the&nbsp;system&nbsp;wide&nbsp;set</span><br>
<span class="lineno"></span><span class="comment" id="4615285">//&nbsp;of&nbsp;root&nbsp;CAs&nbsp;in&nbsp;a&nbsp;format&nbsp;suitable&nbsp;for&nbsp;this&nbsp;function.</span><br>
<span class="lineno">85</span><span class="keyword" id="4615340">func</span>&nbsp;<span class="op" id="4615345">(</span><span class="ident" id="4615346">s</span>&nbsp;<span class="op" id="4615348">*</span><span class="ident" id="4615349"><a href="/gostd/crypto/x509/cert_pool.go.html#4613426">CertPool</a></span><span class="op" id="4615357">)</span>&nbsp;<span class="ident" id="4615359">AppendCertsFromPEM</span><span class="op" id="4615377">(</span><span class="ident" id="4615378">pemCerts</span>&nbsp;<span class="op" id="4615387">[</span><span class="op" id="4615388">]</span><span class="builtintype" id="4615389">byte</span><span class="op" id="4615393">)</span>&nbsp;<span class="op" id="4615395">(</span><span class="ident" id="4615396">ok</span>&nbsp;<span class="builtintype" id="4615399">bool</span><span class="op" id="4615403">)</span>&nbsp;<span class="op" id="4615405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4615408">for</span>&nbsp;<span class="builtinfunc" id="4615412">len</span><span class="op" id="4615415">(</span><span class="ident" id="4615416"><a href="/gostd/crypto/x509/cert_pool.go.html#4615378">pemCerts</a></span><span class="op" id="4615424">)</span>&nbsp;<span class="op" id="4615426">&gt;</span>&nbsp;<span class="num" id="4615428">0</span>&nbsp;<span class="op" id="4615430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4615434">var</span>&nbsp;<span class="ident" id="4615438">block</span>&nbsp;<span class="op" id="4615444">*</span><span class="ident" id="4615445"><a href="/gostd/crypto/x509/cert_pool.go.html#4613365">pem</a></span><span class="op" id="4615448">.</span><span class="ident" id="4615449"><a href="/gostd/encoding/pem/pem.go.html#4703705">Block</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4615457"><a href="/gostd/crypto/x509/cert_pool.go.html#4615438">block</a></span><span class="op" id="4615462">,</span>&nbsp;<span class="ident" id="4615464"><a href="/gostd/crypto/x509/cert_pool.go.html#4615378">pemCerts</a></span>&nbsp;<span class="op" id="4615473">=</span>&nbsp;<span class="ident" id="4615475"><a href="/gostd/crypto/x509/cert_pool.go.html#4613365">pem</a></span><span class="op" id="4615478">.</span><span class="ident" id="4615479"><a href="/gostd/encoding/pem/pem.go.html#4705239">Decode</a></span><span class="op" id="4615485">(</span><span class="ident" id="4615486"><a href="/gostd/crypto/x509/cert_pool.go.html#4615378">pemCerts</a></span><span class="op" id="4615494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4615498">if</span>&nbsp;<span class="ident" id="4615501"><a href="/gostd/crypto/x509/cert_pool.go.html#4615438">block</a></span>&nbsp;<span class="op" id="4615507">==</span>&nbsp;<span class="builtintype" id="4615510">nil</span>&nbsp;<span class="op" id="4615514">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4615519">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4615527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4615531">if</span>&nbsp;<span class="ident" id="4615534"><a href="/gostd/crypto/x509/cert_pool.go.html#4615438">block</a></span><span class="op" id="4615539">.</span><span class="ident" id="4615540"><a href="/gostd/encoding/pem/pem.go.html#4703721">Type</a></span>&nbsp;<span class="op" id="4615545">!=</span>&nbsp;<span class="string" id="4615548">&#34;CERTIFICATE&#34;</span>&nbsp;<span class="op" id="4615562">||</span>&nbsp;<span class="builtinfunc" id="4615565">len</span><span class="op" id="4615568">(</span><span class="ident" id="4615569"><a href="/gostd/crypto/x509/cert_pool.go.html#4615438">block</a></span><span class="op" id="4615574">.</span><span class="ident" id="4615575"><a href="/gostd/encoding/pem/pem.go.html#4703811">Headers</a></span><span class="op" id="4615582">)</span>&nbsp;<span class="op" id="4615584">!=</span>&nbsp;<span class="num" id="4615587">0</span>&nbsp;<span class="op" id="4615589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4615594">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4615605">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4615610">cert</span><span class="op" id="4615614">,</span>&nbsp;<span class="ident" id="4615616">err</span>&nbsp;<span class="op" id="4615620">:=</span>&nbsp;<span class="ident" id="4615623"><a href="/gostd/crypto/x509/x509.go.html#4679509">ParseCertificate</a></span><span class="op" id="4615639">(</span><span class="ident" id="4615640"><a href="/gostd/crypto/x509/cert_pool.go.html#4615438">block</a></span><span class="op" id="4615645">.</span><span class="ident" id="4615646"><a href="/gostd/encoding/pem/pem.go.html#4703859">Bytes</a></span><span class="op" id="4615651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4615655">if</span>&nbsp;<span class="ident" id="4615658"><a href="/gostd/crypto/x509/cert_pool.go.html#4615616">err</a></span>&nbsp;<span class="op" id="4615662">!=</span>&nbsp;<span class="builtintype" id="4615665">nil</span>&nbsp;<span class="op" id="4615669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4615674">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4615685">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4615690"><a href="/gostd/crypto/x509/cert_pool.go.html#4615346">s</a></span><span class="op" id="4615691">.</span><span class="ident" id="4615692"><a href="/gostd/crypto/x509/cert_pool.go.html#4614529">AddCert</a></span><span class="op" id="4615699">(</span><span class="ident" id="4615700"><a href="/gostd/crypto/x509/cert_pool.go.html#4615610">cert</a></span><span class="op" id="4615704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4615708"><a href="/gostd/crypto/x509/cert_pool.go.html#4615396">ok</a></span>&nbsp;<span class="op" id="4615711">=</span>&nbsp;<span class="builtintype" id="4615713">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4615719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4615723">return</span><br>
<span class="lineno"></span><span class="op" id="4615730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4615733">//&nbsp;Subjects&nbsp;returns&nbsp;a&nbsp;list&nbsp;of&nbsp;the&nbsp;DER-encoded&nbsp;subjects&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4615791">//&nbsp;all&nbsp;of&nbsp;the&nbsp;certificates&nbsp;in&nbsp;the&nbsp;pool.</span><br>
<span class="lineno">110</span><span class="keyword" id="4615831">func</span>&nbsp;<span class="op" id="4615836">(</span><span class="ident" id="4615837">s</span>&nbsp;<span class="op" id="4615839">*</span><span class="ident" id="4615840"><a href="/gostd/crypto/x509/cert_pool.go.html#4613426">CertPool</a></span><span class="op" id="4615848">)</span>&nbsp;<span class="ident" id="4615850">Subjects</span><span class="op" id="4615858">(</span><span class="op" id="4615859">)</span>&nbsp;<span class="op" id="4615861">(</span><span class="ident" id="4615862">res</span>&nbsp;<span class="op" id="4615866">[</span><span class="op" id="4615867">]</span><span class="op" id="4615868">[</span><span class="op" id="4615869">]</span><span class="builtintype" id="4615870">byte</span><span class="op" id="4615874">)</span>&nbsp;<span class="op" id="4615876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4615879"><a href="/gostd/crypto/x509/cert_pool.go.html#4615862">res</a></span>&nbsp;<span class="op" id="4615883">=</span>&nbsp;<span class="builtinfunc" id="4615885">make</span><span class="op" id="4615889">(</span><span class="op" id="4615890">[</span><span class="op" id="4615891">]</span><span class="op" id="4615892">[</span><span class="op" id="4615893">]</span><span class="builtintype" id="4615894">byte</span><span class="op" id="4615898">,</span>&nbsp;<span class="builtinfunc" id="4615900">len</span><span class="op" id="4615903">(</span><span class="ident" id="4615904"><a href="/gostd/crypto/x509/cert_pool.go.html#4615837">s</a></span><span class="op" id="4615905">.</span><span class="ident" id="4615906"><a href="/gostd/crypto/x509/cert_pool.go.html#4613511">certs</a></span><span class="op" id="4615911">)</span><span class="op" id="4615912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4615915">for</span>&nbsp;<span class="ident" id="4615919">i</span><span class="op" id="4615920">,</span>&nbsp;<span class="ident" id="4615922">c</span>&nbsp;<span class="op" id="4615924">:=</span>&nbsp;<span class="keyword" id="4615927">range</span>&nbsp;<span class="ident" id="4615933"><a href="/gostd/crypto/x509/cert_pool.go.html#4615837">s</a></span><span class="op" id="4615934">.</span><span class="ident" id="4615935"><a href="/gostd/crypto/x509/cert_pool.go.html#4613511">certs</a></span>&nbsp;<span class="op" id="4615941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4615945"><a href="/gostd/crypto/x509/cert_pool.go.html#4615862">res</a></span><span class="op" id="4615948">[</span><span class="ident" id="4615949"><a href="/gostd/crypto/x509/cert_pool.go.html#4615919">i</a></span><span class="op" id="4615950">]</span>&nbsp;<span class="op" id="4615952">=</span>&nbsp;<span class="ident" id="4615954"><a href="/gostd/crypto/x509/cert_pool.go.html#4615922">c</a></span><span class="op" id="4615955">.</span><span class="ident" id="4615956"><a href="/gostd/crypto/x509/x509.go.html#4660047">RawSubject</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4615968">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4615971">return</span><br>
<span class="lineno"></span><span class="op" id="4615978">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
