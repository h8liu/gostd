<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>syscall</h2>
<ul>
<li><a href="/gostd/syscall/creds_test.go.html">creds_test.go</a></li>
<li><a href="/gostd/syscall/env_unix.go.html">env_unix.go</a></li>
<li><a href="/gostd/syscall/exec_linux.go.html">exec_linux.go</a></li>
<li><a href="/gostd/syscall/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/syscall/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/syscall/flock.go.html">flock.go</a></li>
<li><a href="/gostd/syscall/lsf_linux.go.html" class="current">lsf_linux.go</a></li>
<li><a href="/gostd/syscall/mmap_unix_test.go.html">mmap_unix_test.go</a></li>
<li><a href="/gostd/syscall/netlink_linux.go.html">netlink_linux.go</a></li>
<li><a href="/gostd/syscall/race0.go.html">race0.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_linux.go.html">sockcmsg_linux.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_unix.go.html">sockcmsg_unix.go</a></li>
<li><a href="/gostd/syscall/str.go.html">str.go</a></li>
<li><a href="/gostd/syscall/syscall.go.html">syscall.go</a></li>
<li><a href="/gostd/syscall/syscall_linux.go.html">syscall_linux.go</a></li>
<li><a href="/gostd/syscall/syscall_linux_amd64.go.html">syscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/syscall_test.go.html">syscall_test.go</a></li>
<li><a href="/gostd/syscall/syscall_unix.go.html">syscall_unix.go</a></li>
<li><a href="/gostd/syscall/syscall_unix_test.go.html">syscall_unix_test.go</a></li>
<li><a href="/gostd/syscall/zerrors_linux_amd64.go.html">zerrors_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsyscall_linux_amd64.go.html">zsyscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsysnum_linux_amd64.go.html">zsysnum_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/ztypes_linux_amd64.go.html">ztypes_linux_amd64.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2390763">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2390819">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2390873">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2390924">//&nbsp;Linux&nbsp;socket&nbsp;filter</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2390948">package</span>&nbsp;<span class="ident" id="2390956">syscall</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2390965">import</span>&nbsp;<span class="op" id="2390972">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2390975">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="2390984">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2390987">func</span>&nbsp;<span class="ident" id="2390992">LsfStmt</span><span class="op" id="2390999">(</span><span class="ident" id="2391000">code</span><span class="op" id="2391004">,</span>&nbsp;<span class="ident" id="2391006">k</span>&nbsp;<span class="builtintype" id="2391008">int</span><span class="op" id="2391011">)</span>&nbsp;<span class="op" id="2391013">*</span><span class="ident" id="2391014">SockFilter</span>&nbsp;<span class="op" id="2391025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2391028">return</span>&nbsp;<span class="op" id="2391035">&amp;</span><span class="ident" id="2391036">SockFilter</span><span class="op" id="2391046">{</span><span class="ident" id="2391047">Code</span><span class="op" id="2391051">:</span>&nbsp;<span class="builtintype" id="2391053">uint16</span><span class="op" id="2391059">(</span><span class="ident" id="2391060">code</span><span class="op" id="2391064">)</span><span class="op" id="2391065">,</span>&nbsp;<span class="ident" id="2391067">K</span><span class="op" id="2391068">:</span>&nbsp;<span class="builtintype" id="2391070">uint32</span><span class="op" id="2391076">(</span><span class="ident" id="2391077">k</span><span class="op" id="2391078">)</span><span class="op" id="2391079">}</span><br>
<span class="lineno">15</span><span class="op" id="2391081">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2391084">func</span>&nbsp;<span class="ident" id="2391089">LsfJump</span><span class="op" id="2391096">(</span><span class="ident" id="2391097">code</span><span class="op" id="2391101">,</span>&nbsp;<span class="ident" id="2391103">k</span><span class="op" id="2391104">,</span>&nbsp;<span class="ident" id="2391106">jt</span><span class="op" id="2391108">,</span>&nbsp;<span class="ident" id="2391110">jf</span>&nbsp;<span class="builtintype" id="2391113">int</span><span class="op" id="2391116">)</span>&nbsp;<span class="op" id="2391118">*</span><span class="ident" id="2391119">SockFilter</span>&nbsp;<span class="op" id="2391130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2391133">return</span>&nbsp;<span class="op" id="2391140">&amp;</span><span class="ident" id="2391141">SockFilter</span><span class="op" id="2391151">{</span><span class="ident" id="2391152">Code</span><span class="op" id="2391156">:</span>&nbsp;<span class="builtintype" id="2391158">uint16</span><span class="op" id="2391164">(</span><span class="ident" id="2391165">code</span><span class="op" id="2391169">)</span><span class="op" id="2391170">,</span>&nbsp;<span class="ident" id="2391172">Jt</span><span class="op" id="2391174">:</span>&nbsp;<span class="builtintype" id="2391176">uint8</span><span class="op" id="2391181">(</span><span class="ident" id="2391182">jt</span><span class="op" id="2391184">)</span><span class="op" id="2391185">,</span>&nbsp;<span class="ident" id="2391187">Jf</span><span class="op" id="2391189">:</span>&nbsp;<span class="builtintype" id="2391191">uint8</span><span class="op" id="2391196">(</span><span class="ident" id="2391197">jf</span><span class="op" id="2391199">)</span><span class="op" id="2391200">,</span>&nbsp;<span class="ident" id="2391202">K</span><span class="op" id="2391203">:</span>&nbsp;<span class="builtintype" id="2391205">uint32</span><span class="op" id="2391211">(</span><span class="ident" id="2391212">k</span><span class="op" id="2391213">)</span><span class="op" id="2391214">}</span><br>
<span class="lineno"></span><span class="op" id="2391216">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="2391219">func</span>&nbsp;<span class="ident" id="2391224">LsfSocket</span><span class="op" id="2391233">(</span><span class="ident" id="2391234">ifindex</span><span class="op" id="2391241">,</span>&nbsp;<span class="ident" id="2391243">proto</span>&nbsp;<span class="builtintype" id="2391249">int</span><span class="op" id="2391252">)</span>&nbsp;<span class="op" id="2391254">(</span><span class="builtintype" id="2391255">int</span><span class="op" id="2391258">,</span>&nbsp;<span class="builtintype" id="2391260">error</span><span class="op" id="2391265">)</span>&nbsp;<span class="op" id="2391267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2391270">var</span>&nbsp;<span class="ident" id="2391274">lsall</span>&nbsp;<span class="ident" id="2391280">SockaddrLinklayer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2391299">s</span><span class="op" id="2391300">,</span>&nbsp;<span class="ident" id="2391302">e</span>&nbsp;<span class="op" id="2391304">:=</span>&nbsp;<span class="ident" id="2391307">Socket</span><span class="op" id="2391313">(</span><span class="ident" id="2391314">AF_PACKET</span><span class="op" id="2391323">,</span>&nbsp;<span class="ident" id="2391325">SOCK_RAW</span><span class="op" id="2391333">,</span>&nbsp;<span class="ident" id="2391335">proto</span><span class="op" id="2391340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2391343">if</span>&nbsp;<span class="ident" id="2391346">e</span>&nbsp;<span class="op" id="2391348">!=</span>&nbsp;<span class="builtintype" id="2391351">nil</span>&nbsp;<span class="op" id="2391355">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2391359">return</span>&nbsp;<span class="num" id="2391366">0</span><span class="op" id="2391367">,</span>&nbsp;<span class="ident" id="2391369">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2391372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2391375">p</span>&nbsp;<span class="op" id="2391377">:=</span>&nbsp;<span class="op" id="2391380">(</span><span class="op" id="2391381">*</span><span class="op" id="2391382">[</span><span class="num" id="2391383">2</span><span class="op" id="2391384">]</span><span class="builtintype" id="2391385">byte</span><span class="op" id="2391389">)</span><span class="op" id="2391390">(</span><span class="ident" id="2391391">unsafe</span><span class="op" id="2391397">.</span><span class="ident" id="2391398">Pointer</span><span class="op" id="2391405">(</span><span class="op" id="2391406">&amp;</span><span class="ident" id="2391407">lsall</span><span class="op" id="2391412">.</span><span class="ident" id="2391413">Protocol</span><span class="op" id="2391421">)</span><span class="op" id="2391422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2391425">p</span><span class="op" id="2391426">[</span><span class="num" id="2391427">0</span><span class="op" id="2391428">]</span>&nbsp;<span class="op" id="2391430">=</span>&nbsp;<span class="builtintype" id="2391432">byte</span><span class="op" id="2391436">(</span><span class="ident" id="2391437">proto</span>&nbsp;<span class="op" id="2391443">&gt;&gt;</span>&nbsp;<span class="num" id="2391446">8</span><span class="op" id="2391447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2391450">p</span><span class="op" id="2391451">[</span><span class="num" id="2391452">1</span><span class="op" id="2391453">]</span>&nbsp;<span class="op" id="2391455">=</span>&nbsp;<span class="builtintype" id="2391457">byte</span><span class="op" id="2391461">(</span><span class="ident" id="2391462">proto</span><span class="op" id="2391467">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2391470">lsall</span><span class="op" id="2391475">.</span><span class="ident" id="2391476">Ifindex</span>&nbsp;<span class="op" id="2391484">=</span>&nbsp;<span class="ident" id="2391486">ifindex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2391495">e</span>&nbsp;<span class="op" id="2391497">=</span>&nbsp;<span class="ident" id="2391499">Bind</span><span class="op" id="2391503">(</span><span class="ident" id="2391504">s</span><span class="op" id="2391505">,</span>&nbsp;<span class="op" id="2391507">&amp;</span><span class="ident" id="2391508">lsall</span><span class="op" id="2391513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2391516">if</span>&nbsp;<span class="ident" id="2391519">e</span>&nbsp;<span class="op" id="2391521">!=</span>&nbsp;<span class="builtintype" id="2391524">nil</span>&nbsp;<span class="op" id="2391528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2391532">Close</span><span class="op" id="2391537">(</span><span class="ident" id="2391538">s</span><span class="op" id="2391539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2391543">return</span>&nbsp;<span class="num" id="2391550">0</span><span class="op" id="2391551">,</span>&nbsp;<span class="ident" id="2391553">e</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2391556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2391559">return</span>&nbsp;<span class="ident" id="2391566">s</span><span class="op" id="2391567">,</span>&nbsp;<span class="builtintype" id="2391569">nil</span><br>
<span class="lineno"></span><span class="op" id="2391573">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2391576">type</span>&nbsp;<span class="ident" id="2391581">iflags</span>&nbsp;<span class="keyword" id="2391588">struct</span>&nbsp;<span class="op" id="2391595">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2391598">name</span>&nbsp;&nbsp;<span class="op" id="2391604">[</span><span class="ident" id="2391605">IFNAMSIZ</span><span class="op" id="2391613">]</span><span class="builtintype" id="2391614">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2391620">flags</span>&nbsp;<span class="builtintype" id="2391626">uint16</span><br>
<span class="lineno"></span><span class="op" id="2391633">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2391636">func</span>&nbsp;<span class="ident" id="2391641">SetLsfPromisc</span><span class="op" id="2391654">(</span><span class="ident" id="2391655">name</span>&nbsp;<span class="builtintype" id="2391660">string</span><span class="op" id="2391666">,</span>&nbsp;<span class="ident" id="2391668">m</span>&nbsp;<span class="builtintype" id="2391670">bool</span><span class="op" id="2391674">)</span>&nbsp;<span class="builtintype" id="2391676">error</span>&nbsp;<span class="op" id="2391682">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2391685">s</span><span class="op" id="2391686">,</span>&nbsp;<span class="ident" id="2391688">e</span>&nbsp;<span class="op" id="2391690">:=</span>&nbsp;<span class="ident" id="2391693">Socket</span><span class="op" id="2391699">(</span><span class="ident" id="2391700">AF_INET</span><span class="op" id="2391707">,</span>&nbsp;<span class="ident" id="2391709">SOCK_DGRAM</span><span class="op" id="2391719">,</span>&nbsp;<span class="num" id="2391721">0</span><span class="op" id="2391722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2391725">if</span>&nbsp;<span class="ident" id="2391728">e</span>&nbsp;<span class="op" id="2391730">!=</span>&nbsp;<span class="builtintype" id="2391733">nil</span>&nbsp;<span class="op" id="2391737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2391741">return</span>&nbsp;<span class="ident" id="2391748">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2391751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2391754">defer</span>&nbsp;<span class="ident" id="2391760">Close</span><span class="op" id="2391765">(</span><span class="ident" id="2391766">s</span><span class="op" id="2391767">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2391770">var</span>&nbsp;<span class="ident" id="2391774">ifl</span>&nbsp;<span class="ident" id="2391778">iflags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2391786">copy</span><span class="op" id="2391790">(</span><span class="ident" id="2391791">ifl</span><span class="op" id="2391794">.</span><span class="ident" id="2391795">name</span><span class="op" id="2391799">[</span><span class="op" id="2391800">:</span><span class="op" id="2391801">]</span><span class="op" id="2391802">,</span>&nbsp;<span class="op" id="2391804">[</span><span class="op" id="2391805">]</span><span class="builtintype" id="2391806">byte</span><span class="op" id="2391810">(</span><span class="ident" id="2391811">name</span><span class="op" id="2391815">)</span><span class="op" id="2391816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2391819">_</span><span class="op" id="2391820">,</span>&nbsp;<span class="ident" id="2391822">_</span><span class="op" id="2391823">,</span>&nbsp;<span class="ident" id="2391825">ep</span>&nbsp;<span class="op" id="2391828">:=</span>&nbsp;<span class="ident" id="2391831">Syscall</span><span class="op" id="2391838">(</span><span class="ident" id="2391839">SYS_IOCTL</span><span class="op" id="2391848">,</span>&nbsp;<span class="builtintype" id="2391850">uintptr</span><span class="op" id="2391857">(</span><span class="ident" id="2391858">s</span><span class="op" id="2391859">)</span><span class="op" id="2391860">,</span>&nbsp;<span class="ident" id="2391862">SIOCGIFFLAGS</span><span class="op" id="2391874">,</span>&nbsp;<span class="builtintype" id="2391876">uintptr</span><span class="op" id="2391883">(</span><span class="ident" id="2391884">unsafe</span><span class="op" id="2391890">.</span><span class="ident" id="2391891">Pointer</span><span class="op" id="2391898">(</span><span class="op" id="2391899">&amp;</span><span class="ident" id="2391900">ifl</span><span class="op" id="2391903">)</span><span class="op" id="2391904">)</span><span class="op" id="2391905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2391908">if</span>&nbsp;<span class="ident" id="2391911">ep</span>&nbsp;<span class="op" id="2391914">!=</span>&nbsp;<span class="num" id="2391917">0</span>&nbsp;<span class="op" id="2391919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2391923">return</span>&nbsp;<span class="ident" id="2391930">Errno</span><span class="op" id="2391935">(</span><span class="ident" id="2391936">ep</span><span class="op" id="2391938">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2391941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2391944">if</span>&nbsp;<span class="ident" id="2391947">m</span>&nbsp;<span class="op" id="2391949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2391953">ifl</span><span class="op" id="2391956">.</span><span class="ident" id="2391957">flags</span>&nbsp;<span class="op" id="2391963">|=</span>&nbsp;<span class="builtintype" id="2391966">uint16</span><span class="op" id="2391972">(</span><span class="ident" id="2391973">IFF_PROMISC</span><span class="op" id="2391984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2391987">}</span>&nbsp;<span class="keyword" id="2391989">else</span>&nbsp;<span class="op" id="2391994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2391998">ifl</span><span class="op" id="2392001">.</span><span class="ident" id="2392002">flags</span>&nbsp;<span class="op" id="2392008">&amp;=</span>&nbsp;<span class="op" id="2392011">^</span><span class="builtintype" id="2392012">uint16</span><span class="op" id="2392018">(</span><span class="ident" id="2392019">IFF_PROMISC</span><span class="op" id="2392030">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2392033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2392036">_</span><span class="op" id="2392037">,</span>&nbsp;<span class="ident" id="2392039">_</span><span class="op" id="2392040">,</span>&nbsp;<span class="ident" id="2392042">ep</span>&nbsp;<span class="op" id="2392045">=</span>&nbsp;<span class="ident" id="2392047">Syscall</span><span class="op" id="2392054">(</span><span class="ident" id="2392055">SYS_IOCTL</span><span class="op" id="2392064">,</span>&nbsp;<span class="builtintype" id="2392066">uintptr</span><span class="op" id="2392073">(</span><span class="ident" id="2392074">s</span><span class="op" id="2392075">)</span><span class="op" id="2392076">,</span>&nbsp;<span class="ident" id="2392078">SIOCSIFFLAGS</span><span class="op" id="2392090">,</span>&nbsp;<span class="builtintype" id="2392092">uintptr</span><span class="op" id="2392099">(</span><span class="ident" id="2392100">unsafe</span><span class="op" id="2392106">.</span><span class="ident" id="2392107">Pointer</span><span class="op" id="2392114">(</span><span class="op" id="2392115">&amp;</span><span class="ident" id="2392116">ifl</span><span class="op" id="2392119">)</span><span class="op" id="2392120">)</span><span class="op" id="2392121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2392124">if</span>&nbsp;<span class="ident" id="2392127">ep</span>&nbsp;<span class="op" id="2392130">!=</span>&nbsp;<span class="num" id="2392133">0</span>&nbsp;<span class="op" id="2392135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2392139">return</span>&nbsp;<span class="ident" id="2392146">Errno</span><span class="op" id="2392151">(</span><span class="ident" id="2392152">ep</span><span class="op" id="2392154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2392157">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2392160">return</span>&nbsp;<span class="builtintype" id="2392167">nil</span><br>
<span class="lineno"></span><span class="op" id="2392171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2392174">func</span>&nbsp;<span class="ident" id="2392179">AttachLsf</span><span class="op" id="2392188">(</span><span class="ident" id="2392189">fd</span>&nbsp;<span class="builtintype" id="2392192">int</span><span class="op" id="2392195">,</span>&nbsp;<span class="ident" id="2392197">i</span>&nbsp;<span class="op" id="2392199">[</span><span class="op" id="2392200">]</span><span class="ident" id="2392201">SockFilter</span><span class="op" id="2392211">)</span>&nbsp;<span class="builtintype" id="2392213">error</span>&nbsp;<span class="op" id="2392219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2392222">var</span>&nbsp;<span class="ident" id="2392226">p</span>&nbsp;<span class="ident" id="2392228">SockFprog</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2392239">p</span><span class="op" id="2392240">.</span><span class="ident" id="2392241">Len</span>&nbsp;<span class="op" id="2392245">=</span>&nbsp;<span class="builtintype" id="2392247">uint16</span><span class="op" id="2392253">(</span><span class="builtinfunc" id="2392254">len</span><span class="op" id="2392257">(</span><span class="ident" id="2392258">i</span><span class="op" id="2392259">)</span><span class="op" id="2392260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2392263">p</span><span class="op" id="2392264">.</span><span class="ident" id="2392265">Filter</span>&nbsp;<span class="op" id="2392272">=</span>&nbsp;<span class="op" id="2392274">(</span><span class="op" id="2392275">*</span><span class="ident" id="2392276">SockFilter</span><span class="op" id="2392286">)</span><span class="op" id="2392287">(</span><span class="ident" id="2392288">unsafe</span><span class="op" id="2392294">.</span><span class="ident" id="2392295">Pointer</span><span class="op" id="2392302">(</span><span class="op" id="2392303">&amp;</span><span class="ident" id="2392304">i</span><span class="op" id="2392305">[</span><span class="num" id="2392306">0</span><span class="op" id="2392307">]</span><span class="op" id="2392308">)</span><span class="op" id="2392309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2392312">return</span>&nbsp;<span class="ident" id="2392319">setsockopt</span><span class="op" id="2392329">(</span><span class="ident" id="2392330">fd</span><span class="op" id="2392332">,</span>&nbsp;<span class="ident" id="2392334">SOL_SOCKET</span><span class="op" id="2392344">,</span>&nbsp;<span class="ident" id="2392346">SO_ATTACH_FILTER</span><span class="op" id="2392362">,</span>&nbsp;<span class="ident" id="2392364">unsafe</span><span class="op" id="2392370">.</span><span class="ident" id="2392371">Pointer</span><span class="op" id="2392378">(</span><span class="op" id="2392379">&amp;</span><span class="ident" id="2392380">p</span><span class="op" id="2392381">)</span><span class="op" id="2392382">,</span>&nbsp;<span class="ident" id="2392384">unsafe</span><span class="op" id="2392390">.</span><span class="ident" id="2392391">Sizeof</span><span class="op" id="2392397">(</span><span class="ident" id="2392398">p</span><span class="op" id="2392399">)</span><span class="op" id="2392400">)</span><br>
<span class="lineno"></span><span class="op" id="2392402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="2392405">func</span>&nbsp;<span class="ident" id="2392410">DetachLsf</span><span class="op" id="2392419">(</span><span class="ident" id="2392420">fd</span>&nbsp;<span class="builtintype" id="2392423">int</span><span class="op" id="2392426">)</span>&nbsp;<span class="builtintype" id="2392428">error</span>&nbsp;<span class="op" id="2392434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2392437">var</span>&nbsp;<span class="ident" id="2392441">dummy</span>&nbsp;<span class="builtintype" id="2392447">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2392452">return</span>&nbsp;<span class="ident" id="2392459">setsockopt</span><span class="op" id="2392469">(</span><span class="ident" id="2392470">fd</span><span class="op" id="2392472">,</span>&nbsp;<span class="ident" id="2392474">SOL_SOCKET</span><span class="op" id="2392484">,</span>&nbsp;<span class="ident" id="2392486">SO_DETACH_FILTER</span><span class="op" id="2392502">,</span>&nbsp;<span class="ident" id="2392504">unsafe</span><span class="op" id="2392510">.</span><span class="ident" id="2392511">Pointer</span><span class="op" id="2392518">(</span><span class="op" id="2392519">&amp;</span><span class="ident" id="2392520">dummy</span><span class="op" id="2392525">)</span><span class="op" id="2392526">,</span>&nbsp;<span class="ident" id="2392528">unsafe</span><span class="op" id="2392534">.</span><span class="ident" id="2392535">Sizeof</span><span class="op" id="2392541">(</span><span class="ident" id="2392542">dummy</span><span class="op" id="2392547">)</span><span class="op" id="2392548">)</span><br>
<span class="lineno"></span><span class="op" id="2392550">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
