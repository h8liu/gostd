<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html" class="current">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3913065">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3913121">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3913175">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3913226">package</span>&nbsp;<span class="ident" id="3913234">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3913239">import</span>&nbsp;<span class="op" id="3913246">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3913249">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3913255">&#34;syscall&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3913266">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="3913275">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3913278">//&nbsp;If&nbsp;the&nbsp;ifindex&nbsp;is&nbsp;zero,&nbsp;interfaceTable&nbsp;returns&nbsp;mappings&nbsp;of&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3913344">//&nbsp;network&nbsp;interfaces.&nbsp;&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;a&nbsp;mapping&nbsp;of&nbsp;a&nbsp;specific</span><br>
<span class="lineno">15</span><span class="comment" id="3913413">//&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="3913427">func</span>&nbsp;<span class="ident" id="3913432">interfaceTable</span><span class="op" id="3913446">(</span><span class="ident" id="3913447">ifindex</span>&nbsp;<span class="builtintype" id="3913455">int</span><span class="op" id="3913458">)</span>&nbsp;<span class="op" id="3913460">(</span><span class="op" id="3913461">[</span><span class="op" id="3913462">]</span><span class="ident" id="3913463">Interface</span><span class="op" id="3913472">,</span>&nbsp;<span class="builtintype" id="3913474">error</span><span class="op" id="3913479">)</span>&nbsp;<span class="op" id="3913481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913484">tab</span><span class="op" id="3913487">,</span>&nbsp;<span class="ident" id="3913489">err</span>&nbsp;<span class="op" id="3913493">:=</span>&nbsp;<span class="ident" id="3913496">syscall</span><span class="op" id="3913503">.</span><span class="ident" id="3913504">NetlinkRIB</span><span class="op" id="3913514">(</span><span class="ident" id="3913515">syscall</span><span class="op" id="3913522">.</span><span class="ident" id="3913523">RTM_GETLINK</span><span class="op" id="3913534">,</span>&nbsp;<span class="ident" id="3913536">syscall</span><span class="op" id="3913543">.</span><span class="ident" id="3913544">AF_UNSPEC</span><span class="op" id="3913553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3913556">if</span>&nbsp;<span class="ident" id="3913559">err</span>&nbsp;<span class="op" id="3913563">!=</span>&nbsp;<span class="builtintype" id="3913566">nil</span>&nbsp;<span class="op" id="3913570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3913574">return</span>&nbsp;<span class="builtintype" id="3913581">nil</span><span class="op" id="3913584">,</span>&nbsp;<span class="ident" id="3913586">os</span><span class="op" id="3913588">.</span><span class="ident" id="3913589">NewSyscallError</span><span class="op" id="3913604">(</span><span class="string" id="3913605">&#34;netlink&nbsp;rib&#34;</span><span class="op" id="3913618">,</span>&nbsp;<span class="ident" id="3913620">err</span><span class="op" id="3913623">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3913626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913629">msgs</span><span class="op" id="3913633">,</span>&nbsp;<span class="ident" id="3913635">err</span>&nbsp;<span class="op" id="3913639">:=</span>&nbsp;<span class="ident" id="3913642">syscall</span><span class="op" id="3913649">.</span><span class="ident" id="3913650">ParseNetlinkMessage</span><span class="op" id="3913669">(</span><span class="ident" id="3913670">tab</span><span class="op" id="3913673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3913676">if</span>&nbsp;<span class="ident" id="3913679">err</span>&nbsp;<span class="op" id="3913683">!=</span>&nbsp;<span class="builtintype" id="3913686">nil</span>&nbsp;<span class="op" id="3913690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3913694">return</span>&nbsp;<span class="builtintype" id="3913701">nil</span><span class="op" id="3913704">,</span>&nbsp;<span class="ident" id="3913706">os</span><span class="op" id="3913708">.</span><span class="ident" id="3913709">NewSyscallError</span><span class="op" id="3913724">(</span><span class="string" id="3913725">&#34;netlink&nbsp;message&#34;</span><span class="op" id="3913742">,</span>&nbsp;<span class="ident" id="3913744">err</span><span class="op" id="3913747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3913750">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3913753">var</span>&nbsp;<span class="ident" id="3913757">ift</span>&nbsp;<span class="op" id="3913761">[</span><span class="op" id="3913762">]</span><span class="ident" id="3913763">Interface</span><br>
<span class="lineno"></span><span class="ident" id="3913773">loop</span><span class="op" id="3913777">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3913780">for</span>&nbsp;<span class="ident" id="3913784">_</span><span class="op" id="3913785">,</span>&nbsp;<span class="ident" id="3913787">m</span>&nbsp;<span class="op" id="3913789">:=</span>&nbsp;<span class="keyword" id="3913792">range</span>&nbsp;<span class="ident" id="3913798">msgs</span>&nbsp;<span class="op" id="3913803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3913807">switch</span>&nbsp;<span class="ident" id="3913814">m</span><span class="op" id="3913815">.</span><span class="ident" id="3913816">Header</span><span class="op" id="3913822">.</span><span class="ident" id="3913823">Type</span>&nbsp;<span class="op" id="3913828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3913832">case</span>&nbsp;<span class="ident" id="3913837">syscall</span><span class="op" id="3913844">.</span><span class="ident" id="3913845">NLMSG_DONE</span><span class="op" id="3913855">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3913860">break</span>&nbsp;<span class="ident" id="3913866">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3913873">case</span>&nbsp;<span class="ident" id="3913878">syscall</span><span class="op" id="3913885">.</span><span class="ident" id="3913886">RTM_NEWLINK</span><span class="op" id="3913897">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3913902">ifim</span>&nbsp;<span class="op" id="3913907">:=</span>&nbsp;<span class="op" id="3913910">(</span><span class="op" id="3913911">*</span><span class="ident" id="3913912">syscall</span><span class="op" id="3913919">.</span><span class="ident" id="3913920">IfInfomsg</span><span class="op" id="3913929">)</span><span class="op" id="3913930">(</span><span class="ident" id="3913931">unsafe</span><span class="op" id="3913937">.</span><span class="ident" id="3913938">Pointer</span><span class="op" id="3913945">(</span><span class="op" id="3913946">&amp;</span><span class="ident" id="3913947">m</span><span class="op" id="3913948">.</span><span class="ident" id="3913949">Data</span><span class="op" id="3913953">[</span><span class="num" id="3913954">0</span><span class="op" id="3913955">]</span><span class="op" id="3913956">)</span><span class="op" id="3913957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3913962">if</span>&nbsp;<span class="ident" id="3913965">ifindex</span>&nbsp;<span class="op" id="3913973">==</span>&nbsp;<span class="num" id="3913976">0</span>&nbsp;<span class="op" id="3913978">||</span>&nbsp;<span class="ident" id="3913981">ifindex</span>&nbsp;<span class="op" id="3913989">==</span>&nbsp;<span class="builtintype" id="3913992">int</span><span class="op" id="3913995">(</span><span class="ident" id="3913996">ifim</span><span class="op" id="3914000">.</span><span class="ident" id="3914001">Index</span><span class="op" id="3914006">)</span>&nbsp;<span class="op" id="3914008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3914014">attrs</span><span class="op" id="3914019">,</span>&nbsp;<span class="ident" id="3914021">err</span>&nbsp;<span class="op" id="3914025">:=</span>&nbsp;<span class="ident" id="3914028">syscall</span><span class="op" id="3914035">.</span><span class="ident" id="3914036">ParseNetlinkRouteAttr</span><span class="op" id="3914057">(</span><span class="op" id="3914058">&amp;</span><span class="ident" id="3914059">m</span><span class="op" id="3914060">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3914066">if</span>&nbsp;<span class="ident" id="3914069">err</span>&nbsp;<span class="op" id="3914073">!=</span>&nbsp;<span class="builtintype" id="3914076">nil</span>&nbsp;<span class="op" id="3914080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3914087">return</span>&nbsp;<span class="builtintype" id="3914094">nil</span><span class="op" id="3914097">,</span>&nbsp;<span class="ident" id="3914099">os</span><span class="op" id="3914101">.</span><span class="ident" id="3914102">NewSyscallError</span><span class="op" id="3914117">(</span><span class="string" id="3914118">&#34;netlink&nbsp;routeattr&#34;</span><span class="op" id="3914137">,</span>&nbsp;<span class="ident" id="3914139">err</span><span class="op" id="3914142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3914148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3914154">ift</span>&nbsp;<span class="op" id="3914158">=</span>&nbsp;<span class="builtinfunc" id="3914160">append</span><span class="op" id="3914166">(</span><span class="ident" id="3914167">ift</span><span class="op" id="3914170">,</span>&nbsp;<span class="op" id="3914172">*</span><span class="ident" id="3914173">newLink</span><span class="op" id="3914180">(</span><span class="ident" id="3914181">ifim</span><span class="op" id="3914185">,</span>&nbsp;<span class="ident" id="3914187">attrs</span><span class="op" id="3914192">)</span><span class="op" id="3914193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3914199">if</span>&nbsp;<span class="ident" id="3914202">ifindex</span>&nbsp;<span class="op" id="3914210">==</span>&nbsp;<span class="builtintype" id="3914213">int</span><span class="op" id="3914216">(</span><span class="ident" id="3914217">ifim</span><span class="op" id="3914221">.</span><span class="ident" id="3914222">Index</span><span class="op" id="3914227">)</span>&nbsp;<span class="op" id="3914229">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3914236">break</span>&nbsp;<span class="ident" id="3914242">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3914251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3914256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3914260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3914263">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3914266">return</span>&nbsp;<span class="ident" id="3914273">ift</span><span class="op" id="3914276">,</span>&nbsp;<span class="builtintype" id="3914278">nil</span><br>
<span class="lineno"></span><span class="op" id="3914282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3914285">const</span>&nbsp;<span class="op" id="3914291">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3914294">//&nbsp;See&nbsp;linux/if_arp.h.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3914318">//&nbsp;Note&nbsp;that&nbsp;Linux&nbsp;doesn&#39;t&nbsp;support&nbsp;IPv4&nbsp;over&nbsp;IPv6&nbsp;tunneling.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3914380">sysARPHardwareIPv4IPv4</span>&nbsp;<span class="op" id="3914403">=</span>&nbsp;<span class="num" id="3914405">768</span>&nbsp;<span class="comment" id="3914409">//&nbsp;IPv4&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3914438">sysARPHardwareIPv6IPv6</span>&nbsp;<span class="op" id="3914461">=</span>&nbsp;<span class="num" id="3914463">769</span>&nbsp;<span class="comment" id="3914467">//&nbsp;IPv6&nbsp;over&nbsp;IPv6&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3914496">sysARPHardwareIPv6IPv4</span>&nbsp;<span class="op" id="3914519">=</span>&nbsp;<span class="num" id="3914521">776</span>&nbsp;<span class="comment" id="3914525">//&nbsp;IPv6&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3914554">sysARPHardwareGREIPv4</span>&nbsp;&nbsp;<span class="op" id="3914577">=</span>&nbsp;<span class="num" id="3914579">778</span>&nbsp;<span class="comment" id="3914583">//&nbsp;any&nbsp;over&nbsp;GRE&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3914620">sysARPHardwareGREIPv6</span>&nbsp;&nbsp;<span class="op" id="3914643">=</span>&nbsp;<span class="num" id="3914645">823</span>&nbsp;<span class="comment" id="3914649">//&nbsp;any&nbsp;over&nbsp;GRE&nbsp;over&nbsp;IPv6&nbsp;tunneling</span><br>
<span class="lineno"></span><span class="op" id="3914685">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3914688">func</span>&nbsp;<span class="ident" id="3914693">newLink</span><span class="op" id="3914700">(</span><span class="ident" id="3914701">ifim</span>&nbsp;<span class="op" id="3914706">*</span><span class="ident" id="3914707">syscall</span><span class="op" id="3914714">.</span><span class="ident" id="3914715">IfInfomsg</span><span class="op" id="3914724">,</span>&nbsp;<span class="ident" id="3914726">attrs</span>&nbsp;<span class="op" id="3914732">[</span><span class="op" id="3914733">]</span><span class="ident" id="3914734">syscall</span><span class="op" id="3914741">.</span><span class="ident" id="3914742">NetlinkRouteAttr</span><span class="op" id="3914758">)</span>&nbsp;<span class="op" id="3914760">*</span><span class="ident" id="3914761">Interface</span>&nbsp;<span class="op" id="3914771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3914774">ifi</span>&nbsp;<span class="op" id="3914778">:=</span>&nbsp;<span class="op" id="3914781">&amp;</span><span class="ident" id="3914782">Interface</span><span class="op" id="3914791">{</span><span class="ident" id="3914792">Index</span><span class="op" id="3914797">:</span>&nbsp;<span class="builtintype" id="3914799">int</span><span class="op" id="3914802">(</span><span class="ident" id="3914803">ifim</span><span class="op" id="3914807">.</span><span class="ident" id="3914808">Index</span><span class="op" id="3914813">)</span><span class="op" id="3914814">,</span>&nbsp;<span class="ident" id="3914816">Flags</span><span class="op" id="3914821">:</span>&nbsp;<span class="ident" id="3914823">linkFlags</span><span class="op" id="3914832">(</span><span class="ident" id="3914833">ifim</span><span class="op" id="3914837">.</span><span class="ident" id="3914838">Flags</span><span class="op" id="3914843">)</span><span class="op" id="3914844">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3914847">for</span>&nbsp;<span class="ident" id="3914851">_</span><span class="op" id="3914852">,</span>&nbsp;<span class="ident" id="3914854">a</span>&nbsp;<span class="op" id="3914856">:=</span>&nbsp;<span class="keyword" id="3914859">range</span>&nbsp;<span class="ident" id="3914865">attrs</span>&nbsp;<span class="op" id="3914871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3914875">switch</span>&nbsp;<span class="ident" id="3914882">a</span><span class="op" id="3914883">.</span><span class="ident" id="3914884">Attr</span><span class="op" id="3914888">.</span><span class="ident" id="3914889">Type</span>&nbsp;<span class="op" id="3914894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3914898">case</span>&nbsp;<span class="ident" id="3914903">syscall</span><span class="op" id="3914910">.</span><span class="ident" id="3914911">IFLA_ADDRESS</span><span class="op" id="3914923">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3914928">//&nbsp;We&nbsp;never&nbsp;return&nbsp;any&nbsp;/32&nbsp;or&nbsp;/128&nbsp;IP&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3914977">//&nbsp;prefix&nbsp;on&nbsp;any&nbsp;IP&nbsp;tunnel&nbsp;interface&nbsp;as&nbsp;the</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3915024">//&nbsp;hardware&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3915048">switch</span>&nbsp;<span class="builtinfunc" id="3915055">len</span><span class="op" id="3915058">(</span><span class="ident" id="3915059">a</span><span class="op" id="3915060">.</span><span class="ident" id="3915061">Value</span><span class="op" id="3915066">)</span>&nbsp;<span class="op" id="3915068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3915073">case</span>&nbsp;<span class="ident" id="3915078">IPv4len</span><span class="op" id="3915085">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3915091">switch</span>&nbsp;<span class="ident" id="3915098">ifim</span><span class="op" id="3915102">.</span><span class="ident" id="3915103">Type</span>&nbsp;<span class="op" id="3915108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3915114">case</span>&nbsp;<span class="ident" id="3915119">sysARPHardwareIPv4IPv4</span><span class="op" id="3915141">,</span>&nbsp;<span class="ident" id="3915143">sysARPHardwareGREIPv4</span><span class="op" id="3915164">,</span>&nbsp;<span class="ident" id="3915166">sysARPHardwareIPv6IPv4</span><span class="op" id="3915188">:</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3915195">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3915208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3915213">case</span>&nbsp;<span class="ident" id="3915218">IPv6len</span><span class="op" id="3915225">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3915231">switch</span>&nbsp;<span class="ident" id="3915238">ifim</span><span class="op" id="3915242">.</span><span class="ident" id="3915243">Type</span>&nbsp;<span class="op" id="3915248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3915254">case</span>&nbsp;<span class="ident" id="3915259">sysARPHardwareIPv6IPv6</span><span class="op" id="3915281">,</span>&nbsp;<span class="ident" id="3915283">sysARPHardwareGREIPv6</span><span class="op" id="3915304">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3915311">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3915324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3915329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3915334">var</span>&nbsp;<span class="ident" id="3915338">nonzero</span>&nbsp;<span class="builtintype" id="3915346">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3915354">for</span>&nbsp;<span class="ident" id="3915358">_</span><span class="op" id="3915359">,</span>&nbsp;<span class="ident" id="3915361">b</span>&nbsp;<span class="op" id="3915363">:=</span>&nbsp;<span class="keyword" id="3915366">range</span>&nbsp;<span class="ident" id="3915372">a</span><span class="op" id="3915373">.</span><span class="ident" id="3915374">Value</span>&nbsp;<span class="op" id="3915380">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3915386">if</span>&nbsp;<span class="ident" id="3915389">b</span>&nbsp;<span class="op" id="3915391">!=</span>&nbsp;<span class="num" id="3915394">0</span>&nbsp;<span class="op" id="3915396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3915403">nonzero</span>&nbsp;<span class="op" id="3915411">=</span>&nbsp;<span class="builtintype" id="3915413">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3915423">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3915433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3915438">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3915443">if</span>&nbsp;<span class="ident" id="3915446">nonzero</span>&nbsp;<span class="op" id="3915454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3915460">ifi</span><span class="op" id="3915463">.</span><span class="ident" id="3915464">HardwareAddr</span>&nbsp;<span class="op" id="3915477">=</span>&nbsp;<span class="ident" id="3915479">a</span><span class="op" id="3915480">.</span><span class="ident" id="3915481">Value</span><span class="op" id="3915486">[</span><span class="op" id="3915487">:</span><span class="op" id="3915488">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3915493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3915497">case</span>&nbsp;<span class="ident" id="3915502">syscall</span><span class="op" id="3915509">.</span><span class="ident" id="3915510">IFLA_IFNAME</span><span class="op" id="3915521">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3915526">ifi</span><span class="op" id="3915529">.</span><span class="ident" id="3915530">Name</span>&nbsp;<span class="op" id="3915535">=</span>&nbsp;<span class="builtintype" id="3915537">string</span><span class="op" id="3915543">(</span><span class="ident" id="3915544">a</span><span class="op" id="3915545">.</span><span class="ident" id="3915546">Value</span><span class="op" id="3915551">[</span><span class="op" id="3915552">:</span><span class="builtinfunc" id="3915553">len</span><span class="op" id="3915556">(</span><span class="ident" id="3915557">a</span><span class="op" id="3915558">.</span><span class="ident" id="3915559">Value</span><span class="op" id="3915564">)</span><span class="op" id="3915565">-</span><span class="num" id="3915566">1</span><span class="op" id="3915567">]</span><span class="op" id="3915568">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3915572">case</span>&nbsp;<span class="ident" id="3915577">syscall</span><span class="op" id="3915584">.</span><span class="ident" id="3915585">IFLA_MTU</span><span class="op" id="3915593">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3915598">ifi</span><span class="op" id="3915601">.</span><span class="ident" id="3915602">MTU</span>&nbsp;<span class="op" id="3915606">=</span>&nbsp;<span class="builtintype" id="3915608">int</span><span class="op" id="3915611">(</span><span class="op" id="3915612">*</span><span class="op" id="3915613">(</span><span class="op" id="3915614">*</span><span class="builtintype" id="3915615">uint32</span><span class="op" id="3915621">)</span><span class="op" id="3915622">(</span><span class="ident" id="3915623">unsafe</span><span class="op" id="3915629">.</span><span class="ident" id="3915630">Pointer</span><span class="op" id="3915637">(</span><span class="op" id="3915638">&amp;</span><span class="ident" id="3915639">a</span><span class="op" id="3915640">.</span><span class="ident" id="3915641">Value</span><span class="op" id="3915646">[</span><span class="op" id="3915647">:</span><span class="num" id="3915648">4</span><span class="op" id="3915649">]</span><span class="op" id="3915650">[</span><span class="num" id="3915651">0</span><span class="op" id="3915652">]</span><span class="op" id="3915653">)</span><span class="op" id="3915654">)</span><span class="op" id="3915655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3915659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3915662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3915665">return</span>&nbsp;<span class="ident" id="3915672">ifi</span><br>
<span class="lineno">95</span><span class="op" id="3915676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3915679">func</span>&nbsp;<span class="ident" id="3915684">linkFlags</span><span class="op" id="3915693">(</span><span class="ident" id="3915694">rawFlags</span>&nbsp;<span class="builtintype" id="3915703">uint32</span><span class="op" id="3915709">)</span>&nbsp;<span class="ident" id="3915711">Flags</span>&nbsp;<span class="op" id="3915717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3915720">var</span>&nbsp;<span class="ident" id="3915724">f</span>&nbsp;<span class="ident" id="3915726">Flags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3915733">if</span>&nbsp;<span class="ident" id="3915736">rawFlags</span><span class="op" id="3915744">&amp;</span><span class="ident" id="3915745">syscall</span><span class="op" id="3915752">.</span><span class="ident" id="3915753">IFF_UP</span>&nbsp;<span class="op" id="3915760">!=</span>&nbsp;<span class="num" id="3915763">0</span>&nbsp;<span class="op" id="3915765">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3915769">f</span>&nbsp;<span class="op" id="3915771">|=</span>&nbsp;<span class="ident" id="3915774">FlagUp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3915782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3915785">if</span>&nbsp;<span class="ident" id="3915788">rawFlags</span><span class="op" id="3915796">&amp;</span><span class="ident" id="3915797">syscall</span><span class="op" id="3915804">.</span><span class="ident" id="3915805">IFF_BROADCAST</span>&nbsp;<span class="op" id="3915819">!=</span>&nbsp;<span class="num" id="3915822">0</span>&nbsp;<span class="op" id="3915824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3915828">f</span>&nbsp;<span class="op" id="3915830">|=</span>&nbsp;<span class="ident" id="3915833">FlagBroadcast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3915848">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3915851">if</span>&nbsp;<span class="ident" id="3915854">rawFlags</span><span class="op" id="3915862">&amp;</span><span class="ident" id="3915863">syscall</span><span class="op" id="3915870">.</span><span class="ident" id="3915871">IFF_LOOPBACK</span>&nbsp;<span class="op" id="3915884">!=</span>&nbsp;<span class="num" id="3915887">0</span>&nbsp;<span class="op" id="3915889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3915893">f</span>&nbsp;<span class="op" id="3915895">|=</span>&nbsp;<span class="ident" id="3915898">FlagLoopback</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3915912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3915915">if</span>&nbsp;<span class="ident" id="3915918">rawFlags</span><span class="op" id="3915926">&amp;</span><span class="ident" id="3915927">syscall</span><span class="op" id="3915934">.</span><span class="ident" id="3915935">IFF_POINTOPOINT</span>&nbsp;<span class="op" id="3915951">!=</span>&nbsp;<span class="num" id="3915954">0</span>&nbsp;<span class="op" id="3915956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3915960">f</span>&nbsp;<span class="op" id="3915962">|=</span>&nbsp;<span class="ident" id="3915965">FlagPointToPoint</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3915983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3915986">if</span>&nbsp;<span class="ident" id="3915989">rawFlags</span><span class="op" id="3915997">&amp;</span><span class="ident" id="3915998">syscall</span><span class="op" id="3916005">.</span><span class="ident" id="3916006">IFF_MULTICAST</span>&nbsp;<span class="op" id="3916020">!=</span>&nbsp;<span class="num" id="3916023">0</span>&nbsp;<span class="op" id="3916025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3916029">f</span>&nbsp;<span class="op" id="3916031">|=</span>&nbsp;<span class="ident" id="3916034">FlagMulticast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3916049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3916052">return</span>&nbsp;<span class="ident" id="3916059">f</span><br>
<span class="lineno">115</span><span class="op" id="3916061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3916064">//&nbsp;If&nbsp;the&nbsp;ifi&nbsp;is&nbsp;nil,&nbsp;interfaceAddrTable&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3916131">//&nbsp;network&nbsp;interfaces.&nbsp;&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;a&nbsp;specific</span><br>
<span class="lineno"></span><span class="comment" id="3916201">//&nbsp;interface.</span><br>
<span class="lineno">120</span><span class="keyword" id="3916215">func</span>&nbsp;<span class="ident" id="3916220">interfaceAddrTable</span><span class="op" id="3916238">(</span><span class="ident" id="3916239">ifi</span>&nbsp;<span class="op" id="3916243">*</span><span class="ident" id="3916244">Interface</span><span class="op" id="3916253">)</span>&nbsp;<span class="op" id="3916255">(</span><span class="op" id="3916256">[</span><span class="op" id="3916257">]</span><span class="ident" id="3916258">Addr</span><span class="op" id="3916262">,</span>&nbsp;<span class="builtintype" id="3916264">error</span><span class="op" id="3916269">)</span>&nbsp;<span class="op" id="3916271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3916274">tab</span><span class="op" id="3916277">,</span>&nbsp;<span class="ident" id="3916279">err</span>&nbsp;<span class="op" id="3916283">:=</span>&nbsp;<span class="ident" id="3916286">syscall</span><span class="op" id="3916293">.</span><span class="ident" id="3916294">NetlinkRIB</span><span class="op" id="3916304">(</span><span class="ident" id="3916305">syscall</span><span class="op" id="3916312">.</span><span class="ident" id="3916313">RTM_GETADDR</span><span class="op" id="3916324">,</span>&nbsp;<span class="ident" id="3916326">syscall</span><span class="op" id="3916333">.</span><span class="ident" id="3916334">AF_UNSPEC</span><span class="op" id="3916343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3916346">if</span>&nbsp;<span class="ident" id="3916349">err</span>&nbsp;<span class="op" id="3916353">!=</span>&nbsp;<span class="builtintype" id="3916356">nil</span>&nbsp;<span class="op" id="3916360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3916364">return</span>&nbsp;<span class="builtintype" id="3916371">nil</span><span class="op" id="3916374">,</span>&nbsp;<span class="ident" id="3916376">os</span><span class="op" id="3916378">.</span><span class="ident" id="3916379">NewSyscallError</span><span class="op" id="3916394">(</span><span class="string" id="3916395">&#34;netlink&nbsp;rib&#34;</span><span class="op" id="3916408">,</span>&nbsp;<span class="ident" id="3916410">err</span><span class="op" id="3916413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3916416">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3916419">msgs</span><span class="op" id="3916423">,</span>&nbsp;<span class="ident" id="3916425">err</span>&nbsp;<span class="op" id="3916429">:=</span>&nbsp;<span class="ident" id="3916432">syscall</span><span class="op" id="3916439">.</span><span class="ident" id="3916440">ParseNetlinkMessage</span><span class="op" id="3916459">(</span><span class="ident" id="3916460">tab</span><span class="op" id="3916463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3916466">if</span>&nbsp;<span class="ident" id="3916469">err</span>&nbsp;<span class="op" id="3916473">!=</span>&nbsp;<span class="builtintype" id="3916476">nil</span>&nbsp;<span class="op" id="3916480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3916484">return</span>&nbsp;<span class="builtintype" id="3916491">nil</span><span class="op" id="3916494">,</span>&nbsp;<span class="ident" id="3916496">os</span><span class="op" id="3916498">.</span><span class="ident" id="3916499">NewSyscallError</span><span class="op" id="3916514">(</span><span class="string" id="3916515">&#34;netlink&nbsp;message&#34;</span><span class="op" id="3916532">,</span>&nbsp;<span class="ident" id="3916534">err</span><span class="op" id="3916537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3916540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3916543">var</span>&nbsp;<span class="ident" id="3916547">ift</span>&nbsp;<span class="op" id="3916551">[</span><span class="op" id="3916552">]</span><span class="ident" id="3916553">Interface</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3916564">if</span>&nbsp;<span class="ident" id="3916567">ifi</span>&nbsp;<span class="op" id="3916571">==</span>&nbsp;<span class="builtintype" id="3916574">nil</span>&nbsp;<span class="op" id="3916578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3916582">var</span>&nbsp;<span class="ident" id="3916586">err</span>&nbsp;<span class="builtintype" id="3916590">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3916598">ift</span><span class="op" id="3916601">,</span>&nbsp;<span class="ident" id="3916603">err</span>&nbsp;<span class="op" id="3916607">=</span>&nbsp;<span class="ident" id="3916609">interfaceTable</span><span class="op" id="3916623">(</span><span class="num" id="3916624">0</span><span class="op" id="3916625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3916629">if</span>&nbsp;<span class="ident" id="3916632">err</span>&nbsp;<span class="op" id="3916636">!=</span>&nbsp;<span class="builtintype" id="3916639">nil</span>&nbsp;<span class="op" id="3916643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3916648">return</span>&nbsp;<span class="builtintype" id="3916655">nil</span><span class="op" id="3916658">,</span>&nbsp;<span class="ident" id="3916660">err</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3916666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3916669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3916672">ifat</span><span class="op" id="3916676">,</span>&nbsp;<span class="ident" id="3916678">err</span>&nbsp;<span class="op" id="3916682">:=</span>&nbsp;<span class="ident" id="3916685">addrTable</span><span class="op" id="3916694">(</span><span class="ident" id="3916695">ift</span><span class="op" id="3916698">,</span>&nbsp;<span class="ident" id="3916700">ifi</span><span class="op" id="3916703">,</span>&nbsp;<span class="ident" id="3916705">msgs</span><span class="op" id="3916709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3916712">if</span>&nbsp;<span class="ident" id="3916715">err</span>&nbsp;<span class="op" id="3916719">!=</span>&nbsp;<span class="builtintype" id="3916722">nil</span>&nbsp;<span class="op" id="3916726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3916730">return</span>&nbsp;<span class="builtintype" id="3916737">nil</span><span class="op" id="3916740">,</span>&nbsp;<span class="ident" id="3916742">err</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3916747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3916750">return</span>&nbsp;<span class="ident" id="3916757">ifat</span><span class="op" id="3916761">,</span>&nbsp;<span class="builtintype" id="3916763">nil</span><br>
<span class="lineno"></span><span class="op" id="3916767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3916770">func</span>&nbsp;<span class="ident" id="3916775">addrTable</span><span class="op" id="3916784">(</span><span class="ident" id="3916785">ift</span>&nbsp;<span class="op" id="3916789">[</span><span class="op" id="3916790">]</span><span class="ident" id="3916791">Interface</span><span class="op" id="3916800">,</span>&nbsp;<span class="ident" id="3916802">ifi</span>&nbsp;<span class="op" id="3916806">*</span><span class="ident" id="3916807">Interface</span><span class="op" id="3916816">,</span>&nbsp;<span class="ident" id="3916818">msgs</span>&nbsp;<span class="op" id="3916823">[</span><span class="op" id="3916824">]</span><span class="ident" id="3916825">syscall</span><span class="op" id="3916832">.</span><span class="ident" id="3916833">NetlinkMessage</span><span class="op" id="3916847">)</span>&nbsp;<span class="op" id="3916849">(</span><span class="op" id="3916850">[</span><span class="op" id="3916851">]</span><span class="ident" id="3916852">Addr</span><span class="op" id="3916856">,</span>&nbsp;<span class="builtintype" id="3916858">error</span><span class="op" id="3916863">)</span>&nbsp;<span class="op" id="3916865">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3916868">var</span>&nbsp;<span class="ident" id="3916872">ifat</span>&nbsp;<span class="op" id="3916877">[</span><span class="op" id="3916878">]</span><span class="ident" id="3916879">Addr</span><br>
<span class="lineno"></span><span class="ident" id="3916884">loop</span><span class="op" id="3916888">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3916891">for</span>&nbsp;<span class="ident" id="3916895">_</span><span class="op" id="3916896">,</span>&nbsp;<span class="ident" id="3916898">m</span>&nbsp;<span class="op" id="3916900">:=</span>&nbsp;<span class="keyword" id="3916903">range</span>&nbsp;<span class="ident" id="3916909">msgs</span>&nbsp;<span class="op" id="3916914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3916918">switch</span>&nbsp;<span class="ident" id="3916925">m</span><span class="op" id="3916926">.</span><span class="ident" id="3916927">Header</span><span class="op" id="3916933">.</span><span class="ident" id="3916934">Type</span>&nbsp;<span class="op" id="3916939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3916943">case</span>&nbsp;<span class="ident" id="3916948">syscall</span><span class="op" id="3916955">.</span><span class="ident" id="3916956">NLMSG_DONE</span><span class="op" id="3916966">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3916971">break</span>&nbsp;<span class="ident" id="3916977">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3916984">case</span>&nbsp;<span class="ident" id="3916989">syscall</span><span class="op" id="3916996">.</span><span class="ident" id="3916997">RTM_NEWADDR</span><span class="op" id="3917008">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3917013">ifam</span>&nbsp;<span class="op" id="3917018">:=</span>&nbsp;<span class="op" id="3917021">(</span><span class="op" id="3917022">*</span><span class="ident" id="3917023">syscall</span><span class="op" id="3917030">.</span><span class="ident" id="3917031">IfAddrmsg</span><span class="op" id="3917040">)</span><span class="op" id="3917041">(</span><span class="ident" id="3917042">unsafe</span><span class="op" id="3917048">.</span><span class="ident" id="3917049">Pointer</span><span class="op" id="3917056">(</span><span class="op" id="3917057">&amp;</span><span class="ident" id="3917058">m</span><span class="op" id="3917059">.</span><span class="ident" id="3917060">Data</span><span class="op" id="3917064">[</span><span class="num" id="3917065">0</span><span class="op" id="3917066">]</span><span class="op" id="3917067">)</span><span class="op" id="3917068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3917073">if</span>&nbsp;<span class="builtinfunc" id="3917076">len</span><span class="op" id="3917079">(</span><span class="ident" id="3917080">ift</span><span class="op" id="3917083">)</span>&nbsp;<span class="op" id="3917085">!=</span>&nbsp;<span class="num" id="3917088">0</span>&nbsp;<span class="op" id="3917090">||</span>&nbsp;<span class="ident" id="3917093">ifi</span><span class="op" id="3917096">.</span><span class="ident" id="3917097">Index</span>&nbsp;<span class="op" id="3917103">==</span>&nbsp;<span class="builtintype" id="3917106">int</span><span class="op" id="3917109">(</span><span class="ident" id="3917110">ifam</span><span class="op" id="3917114">.</span><span class="ident" id="3917115">Index</span><span class="op" id="3917120">)</span>&nbsp;<span class="op" id="3917122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3917128">if</span>&nbsp;<span class="builtinfunc" id="3917131">len</span><span class="op" id="3917134">(</span><span class="ident" id="3917135">ift</span><span class="op" id="3917138">)</span>&nbsp;<span class="op" id="3917140">!=</span>&nbsp;<span class="num" id="3917143">0</span>&nbsp;<span class="op" id="3917145">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3917152">var</span>&nbsp;<span class="ident" id="3917156">err</span>&nbsp;<span class="builtintype" id="3917160">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3917171">ifi</span><span class="op" id="3917174">,</span>&nbsp;<span class="ident" id="3917176">err</span>&nbsp;<span class="op" id="3917180">=</span>&nbsp;<span class="ident" id="3917182">interfaceByIndex</span><span class="op" id="3917198">(</span><span class="ident" id="3917199">ift</span><span class="op" id="3917202">,</span>&nbsp;<span class="builtintype" id="3917204">int</span><span class="op" id="3917207">(</span><span class="ident" id="3917208">ifam</span><span class="op" id="3917212">.</span><span class="ident" id="3917213">Index</span><span class="op" id="3917218">)</span><span class="op" id="3917219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3917226">if</span>&nbsp;<span class="ident" id="3917229">err</span>&nbsp;<span class="op" id="3917233">!=</span>&nbsp;<span class="builtintype" id="3917236">nil</span>&nbsp;<span class="op" id="3917240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3917248">return</span>&nbsp;<span class="builtintype" id="3917255">nil</span><span class="op" id="3917258">,</span>&nbsp;<span class="ident" id="3917260">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3917269">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3917275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3917281">attrs</span><span class="op" id="3917286">,</span>&nbsp;<span class="ident" id="3917288">err</span>&nbsp;<span class="op" id="3917292">:=</span>&nbsp;<span class="ident" id="3917295">syscall</span><span class="op" id="3917302">.</span><span class="ident" id="3917303">ParseNetlinkRouteAttr</span><span class="op" id="3917324">(</span><span class="op" id="3917325">&amp;</span><span class="ident" id="3917326">m</span><span class="op" id="3917327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3917333">if</span>&nbsp;<span class="ident" id="3917336">err</span>&nbsp;<span class="op" id="3917340">!=</span>&nbsp;<span class="builtintype" id="3917343">nil</span>&nbsp;<span class="op" id="3917347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3917354">return</span>&nbsp;<span class="builtintype" id="3917361">nil</span><span class="op" id="3917364">,</span>&nbsp;<span class="ident" id="3917366">os</span><span class="op" id="3917368">.</span><span class="ident" id="3917369">NewSyscallError</span><span class="op" id="3917384">(</span><span class="string" id="3917385">&#34;netlink&nbsp;routeattr&#34;</span><span class="op" id="3917404">,</span>&nbsp;<span class="ident" id="3917406">err</span><span class="op" id="3917409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3917415">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3917421">ifa</span>&nbsp;<span class="op" id="3917425">:=</span>&nbsp;<span class="ident" id="3917428">newAddr</span><span class="op" id="3917435">(</span><span class="ident" id="3917436">ifi</span><span class="op" id="3917439">,</span>&nbsp;<span class="ident" id="3917441">ifam</span><span class="op" id="3917445">,</span>&nbsp;<span class="ident" id="3917447">attrs</span><span class="op" id="3917452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3917458">if</span>&nbsp;<span class="ident" id="3917461">ifa</span>&nbsp;<span class="op" id="3917465">!=</span>&nbsp;<span class="builtintype" id="3917468">nil</span>&nbsp;<span class="op" id="3917472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3917479">ifat</span>&nbsp;<span class="op" id="3917484">=</span>&nbsp;<span class="builtinfunc" id="3917486">append</span><span class="op" id="3917492">(</span><span class="ident" id="3917493">ifat</span><span class="op" id="3917497">,</span>&nbsp;<span class="ident" id="3917499">ifa</span><span class="op" id="3917502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3917508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3917513">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3917517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3917520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3917523">return</span>&nbsp;<span class="ident" id="3917530">ifat</span><span class="op" id="3917534">,</span>&nbsp;<span class="builtintype" id="3917536">nil</span><br>
<span class="lineno"></span><span class="op" id="3917540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="3917543">func</span>&nbsp;<span class="ident" id="3917548">newAddr</span><span class="op" id="3917555">(</span><span class="ident" id="3917556">ifi</span>&nbsp;<span class="op" id="3917560">*</span><span class="ident" id="3917561">Interface</span><span class="op" id="3917570">,</span>&nbsp;<span class="ident" id="3917572">ifam</span>&nbsp;<span class="op" id="3917577">*</span><span class="ident" id="3917578">syscall</span><span class="op" id="3917585">.</span><span class="ident" id="3917586">IfAddrmsg</span><span class="op" id="3917595">,</span>&nbsp;<span class="ident" id="3917597">attrs</span>&nbsp;<span class="op" id="3917603">[</span><span class="op" id="3917604">]</span><span class="ident" id="3917605">syscall</span><span class="op" id="3917612">.</span><span class="ident" id="3917613">NetlinkRouteAttr</span><span class="op" id="3917629">)</span>&nbsp;<span class="ident" id="3917631">Addr</span>&nbsp;<span class="op" id="3917636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3917639">var</span>&nbsp;<span class="ident" id="3917643">ipPointToPoint</span>&nbsp;<span class="builtintype" id="3917658">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3917664">//&nbsp;Seems&nbsp;like&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure&nbsp;whether&nbsp;the&nbsp;IP&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3917725">//&nbsp;stack&nbsp;consists&nbsp;of&nbsp;IP&nbsp;point-to-point&nbsp;numbered&nbsp;or&nbsp;unnumbered</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3917788">//&nbsp;addressing&nbsp;over&nbsp;point-to-point&nbsp;link&nbsp;encapsulation.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3917843">if</span>&nbsp;<span class="ident" id="3917846">ifi</span><span class="op" id="3917849">.</span><span class="ident" id="3917850">Flags</span><span class="op" id="3917855">&amp;</span><span class="ident" id="3917856">FlagPointToPoint</span>&nbsp;<span class="op" id="3917873">!=</span>&nbsp;<span class="num" id="3917876">0</span>&nbsp;<span class="op" id="3917878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3917882">for</span>&nbsp;<span class="ident" id="3917886">_</span><span class="op" id="3917887">,</span>&nbsp;<span class="ident" id="3917889">a</span>&nbsp;<span class="op" id="3917891">:=</span>&nbsp;<span class="keyword" id="3917894">range</span>&nbsp;<span class="ident" id="3917900">attrs</span>&nbsp;<span class="op" id="3917906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3917911">if</span>&nbsp;<span class="ident" id="3917914">a</span><span class="op" id="3917915">.</span><span class="ident" id="3917916">Attr</span><span class="op" id="3917920">.</span><span class="ident" id="3917921">Type</span>&nbsp;<span class="op" id="3917926">==</span>&nbsp;<span class="ident" id="3917929">syscall</span><span class="op" id="3917936">.</span><span class="ident" id="3917937">IFA_LOCAL</span>&nbsp;<span class="op" id="3917947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3917953">ipPointToPoint</span>&nbsp;<span class="op" id="3917968">=</span>&nbsp;<span class="builtintype" id="3917970">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3917979">break</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3917988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3917992">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3917995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3917998">for</span>&nbsp;<span class="ident" id="3918002">_</span><span class="op" id="3918003">,</span>&nbsp;<span class="ident" id="3918005">a</span>&nbsp;<span class="op" id="3918007">:=</span>&nbsp;<span class="keyword" id="3918010">range</span>&nbsp;<span class="ident" id="3918016">attrs</span>&nbsp;<span class="op" id="3918022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3918026">if</span>&nbsp;<span class="ident" id="3918029">ipPointToPoint</span>&nbsp;<span class="op" id="3918044">&amp;&amp;</span>&nbsp;<span class="ident" id="3918047">a</span><span class="op" id="3918048">.</span><span class="ident" id="3918049">Attr</span><span class="op" id="3918053">.</span><span class="ident" id="3918054">Type</span>&nbsp;<span class="op" id="3918059">==</span>&nbsp;<span class="ident" id="3918062">syscall</span><span class="op" id="3918069">.</span><span class="ident" id="3918070">IFA_ADDRESS</span>&nbsp;<span class="op" id="3918082">||</span>&nbsp;<span class="op" id="3918085">!</span><span class="ident" id="3918086">ipPointToPoint</span>&nbsp;<span class="op" id="3918101">&amp;&amp;</span>&nbsp;<span class="ident" id="3918104">a</span><span class="op" id="3918105">.</span><span class="ident" id="3918106">Attr</span><span class="op" id="3918110">.</span><span class="ident" id="3918111">Type</span>&nbsp;<span class="op" id="3918116">==</span>&nbsp;<span class="ident" id="3918119">syscall</span><span class="op" id="3918126">.</span><span class="ident" id="3918127">IFA_LOCAL</span>&nbsp;<span class="op" id="3918137">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3918142">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3918153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3918157">switch</span>&nbsp;<span class="ident" id="3918164">ifam</span><span class="op" id="3918168">.</span><span class="ident" id="3918169">Family</span>&nbsp;<span class="op" id="3918176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3918180">case</span>&nbsp;<span class="ident" id="3918185">syscall</span><span class="op" id="3918192">.</span><span class="ident" id="3918193">AF_INET</span><span class="op" id="3918200">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3918205">return</span>&nbsp;<span class="op" id="3918212">&amp;</span><span class="ident" id="3918213">IPNet</span><span class="op" id="3918218">{</span><span class="ident" id="3918219">IP</span><span class="op" id="3918221">:</span>&nbsp;<span class="ident" id="3918223">IPv4</span><span class="op" id="3918227">(</span><span class="ident" id="3918228">a</span><span class="op" id="3918229">.</span><span class="ident" id="3918230">Value</span><span class="op" id="3918235">[</span><span class="num" id="3918236">0</span><span class="op" id="3918237">]</span><span class="op" id="3918238">,</span>&nbsp;<span class="ident" id="3918240">a</span><span class="op" id="3918241">.</span><span class="ident" id="3918242">Value</span><span class="op" id="3918247">[</span><span class="num" id="3918248">1</span><span class="op" id="3918249">]</span><span class="op" id="3918250">,</span>&nbsp;<span class="ident" id="3918252">a</span><span class="op" id="3918253">.</span><span class="ident" id="3918254">Value</span><span class="op" id="3918259">[</span><span class="num" id="3918260">2</span><span class="op" id="3918261">]</span><span class="op" id="3918262">,</span>&nbsp;<span class="ident" id="3918264">a</span><span class="op" id="3918265">.</span><span class="ident" id="3918266">Value</span><span class="op" id="3918271">[</span><span class="num" id="3918272">3</span><span class="op" id="3918273">]</span><span class="op" id="3918274">)</span><span class="op" id="3918275">,</span>&nbsp;<span class="ident" id="3918277">Mask</span><span class="op" id="3918281">:</span>&nbsp;<span class="ident" id="3918283">CIDRMask</span><span class="op" id="3918291">(</span><span class="builtintype" id="3918292">int</span><span class="op" id="3918295">(</span><span class="ident" id="3918296">ifam</span><span class="op" id="3918300">.</span><span class="ident" id="3918301">Prefixlen</span><span class="op" id="3918310">)</span><span class="op" id="3918311">,</span>&nbsp;<span class="num" id="3918313">8</span><span class="op" id="3918314">*</span><span class="ident" id="3918315">IPv4len</span><span class="op" id="3918322">)</span><span class="op" id="3918323">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3918327">case</span>&nbsp;<span class="ident" id="3918332">syscall</span><span class="op" id="3918339">.</span><span class="ident" id="3918340">AF_INET6</span><span class="op" id="3918348">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3918353">ifa</span>&nbsp;<span class="op" id="3918357">:=</span>&nbsp;<span class="op" id="3918360">&amp;</span><span class="ident" id="3918361">IPNet</span><span class="op" id="3918366">{</span><span class="ident" id="3918367">IP</span><span class="op" id="3918369">:</span>&nbsp;<span class="builtinfunc" id="3918371">make</span><span class="op" id="3918375">(</span><span class="ident" id="3918376">IP</span><span class="op" id="3918378">,</span>&nbsp;<span class="ident" id="3918380">IPv6len</span><span class="op" id="3918387">)</span><span class="op" id="3918388">,</span>&nbsp;<span class="ident" id="3918390">Mask</span><span class="op" id="3918394">:</span>&nbsp;<span class="ident" id="3918396">CIDRMask</span><span class="op" id="3918404">(</span><span class="builtintype" id="3918405">int</span><span class="op" id="3918408">(</span><span class="ident" id="3918409">ifam</span><span class="op" id="3918413">.</span><span class="ident" id="3918414">Prefixlen</span><span class="op" id="3918423">)</span><span class="op" id="3918424">,</span>&nbsp;<span class="num" id="3918426">8</span><span class="op" id="3918427">*</span><span class="ident" id="3918428">IPv6len</span><span class="op" id="3918435">)</span><span class="op" id="3918436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3918441">copy</span><span class="op" id="3918445">(</span><span class="ident" id="3918446">ifa</span><span class="op" id="3918449">.</span><span class="ident" id="3918450">IP</span><span class="op" id="3918452">,</span>&nbsp;<span class="ident" id="3918454">a</span><span class="op" id="3918455">.</span><span class="ident" id="3918456">Value</span><span class="op" id="3918461">[</span><span class="op" id="3918462">:</span><span class="op" id="3918463">]</span><span class="op" id="3918464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3918469">return</span>&nbsp;<span class="ident" id="3918476">ifa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3918482">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3918485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3918488">return</span>&nbsp;<span class="builtintype" id="3918495">nil</span><br>
<span class="lineno"></span><span class="op" id="3918499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3918502">//&nbsp;interfaceMulticastAddrTable&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;a&nbsp;specific</span><br>
<span class="lineno">205</span><span class="comment" id="3918566">//&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="3918580">func</span>&nbsp;<span class="ident" id="3918585">interfaceMulticastAddrTable</span><span class="op" id="3918612">(</span><span class="ident" id="3918613">ifi</span>&nbsp;<span class="op" id="3918617">*</span><span class="ident" id="3918618">Interface</span><span class="op" id="3918627">)</span>&nbsp;<span class="op" id="3918629">(</span><span class="op" id="3918630">[</span><span class="op" id="3918631">]</span><span class="ident" id="3918632">Addr</span><span class="op" id="3918636">,</span>&nbsp;<span class="builtintype" id="3918638">error</span><span class="op" id="3918643">)</span>&nbsp;<span class="op" id="3918645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3918648">ifmat4</span>&nbsp;<span class="op" id="3918655">:=</span>&nbsp;<span class="ident" id="3918658">parseProcNetIGMP</span><span class="op" id="3918674">(</span><span class="string" id="3918675">&#34;/proc/net/igmp&#34;</span><span class="op" id="3918691">,</span>&nbsp;<span class="ident" id="3918693">ifi</span><span class="op" id="3918696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3918699">ifmat6</span>&nbsp;<span class="op" id="3918706">:=</span>&nbsp;<span class="ident" id="3918709">parseProcNetIGMP6</span><span class="op" id="3918726">(</span><span class="string" id="3918727">&#34;/proc/net/igmp6&#34;</span><span class="op" id="3918744">,</span>&nbsp;<span class="ident" id="3918746">ifi</span><span class="op" id="3918749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3918752">return</span>&nbsp;<span class="builtinfunc" id="3918759">append</span><span class="op" id="3918765">(</span><span class="ident" id="3918766">ifmat4</span><span class="op" id="3918772">,</span>&nbsp;<span class="ident" id="3918774">ifmat6</span><span class="op" id="3918780">...</span><span class="op" id="3918783">)</span><span class="op" id="3918784">,</span>&nbsp;<span class="builtintype" id="3918786">nil</span><br>
<span class="lineno">210</span><span class="op" id="3918790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3918793">func</span>&nbsp;<span class="ident" id="3918798">parseProcNetIGMP</span><span class="op" id="3918814">(</span><span class="ident" id="3918815">path</span>&nbsp;<span class="builtintype" id="3918820">string</span><span class="op" id="3918826">,</span>&nbsp;<span class="ident" id="3918828">ifi</span>&nbsp;<span class="op" id="3918832">*</span><span class="ident" id="3918833">Interface</span><span class="op" id="3918842">)</span>&nbsp;<span class="op" id="3918844">[</span><span class="op" id="3918845">]</span><span class="ident" id="3918846">Addr</span>&nbsp;<span class="op" id="3918851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3918854">fd</span><span class="op" id="3918856">,</span>&nbsp;<span class="ident" id="3918858">err</span>&nbsp;<span class="op" id="3918862">:=</span>&nbsp;<span class="ident" id="3918865">open</span><span class="op" id="3918869">(</span><span class="ident" id="3918870">path</span><span class="op" id="3918874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3918877">if</span>&nbsp;<span class="ident" id="3918880">err</span>&nbsp;<span class="op" id="3918884">!=</span>&nbsp;<span class="builtintype" id="3918887">nil</span>&nbsp;<span class="op" id="3918891">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3918895">return</span>&nbsp;<span class="builtintype" id="3918902">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3918907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3918910">defer</span>&nbsp;<span class="ident" id="3918916">fd</span><span class="op" id="3918918">.</span><span class="builtinfunc" id="3918919">close</span><span class="op" id="3918924">(</span><span class="op" id="3918925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3918928">var</span>&nbsp;<span class="op" id="3918932">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3918936">ifmat</span>&nbsp;<span class="op" id="3918942">[</span><span class="op" id="3918943">]</span><span class="ident" id="3918944">Addr</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3918951">name</span>&nbsp;&nbsp;<span class="builtintype" id="3918957">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3918965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3918968">fd</span><span class="op" id="3918970">.</span><span class="ident" id="3918971">readLine</span><span class="op" id="3918979">(</span><span class="op" id="3918980">)</span>&nbsp;<span class="comment" id="3918982">//&nbsp;skip&nbsp;first&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3919002">b</span>&nbsp;<span class="op" id="3919004">:=</span>&nbsp;<span class="builtinfunc" id="3919007">make</span><span class="op" id="3919011">(</span><span class="op" id="3919012">[</span><span class="op" id="3919013">]</span><span class="builtintype" id="3919014">byte</span><span class="op" id="3919018">,</span>&nbsp;<span class="ident" id="3919020">IPv4len</span><span class="op" id="3919027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3919030">for</span>&nbsp;<span class="ident" id="3919034">l</span><span class="op" id="3919035">,</span>&nbsp;<span class="ident" id="3919037">ok</span>&nbsp;<span class="op" id="3919040">:=</span>&nbsp;<span class="ident" id="3919043">fd</span><span class="op" id="3919045">.</span><span class="ident" id="3919046">readLine</span><span class="op" id="3919054">(</span><span class="op" id="3919055">)</span><span class="op" id="3919056">;</span>&nbsp;<span class="ident" id="3919058">ok</span><span class="op" id="3919060">;</span>&nbsp;<span class="ident" id="3919062">l</span><span class="op" id="3919063">,</span>&nbsp;<span class="ident" id="3919065">ok</span>&nbsp;<span class="op" id="3919068">=</span>&nbsp;<span class="ident" id="3919070">fd</span><span class="op" id="3919072">.</span><span class="ident" id="3919073">readLine</span><span class="op" id="3919081">(</span><span class="op" id="3919082">)</span>&nbsp;<span class="op" id="3919084">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3919088">f</span>&nbsp;<span class="op" id="3919090">:=</span>&nbsp;<span class="ident" id="3919093">splitAtBytes</span><span class="op" id="3919105">(</span><span class="ident" id="3919106">l</span><span class="op" id="3919107">,</span>&nbsp;<span class="string" id="3919109">&#34;&nbsp;:\r\t\n&#34;</span><span class="op" id="3919119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3919123">if</span>&nbsp;<span class="builtinfunc" id="3919126">len</span><span class="op" id="3919129">(</span><span class="ident" id="3919130">f</span><span class="op" id="3919131">)</span>&nbsp;<span class="op" id="3919133">&lt;</span>&nbsp;<span class="num" id="3919135">4</span>&nbsp;<span class="op" id="3919137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3919142">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3919153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3919157">switch</span>&nbsp;<span class="op" id="3919164">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3919168">case</span>&nbsp;<span class="ident" id="3919173">l</span><span class="op" id="3919174">[</span><span class="num" id="3919175">0</span><span class="op" id="3919176">]</span>&nbsp;<span class="op" id="3919178">!=</span>&nbsp;<span class="string" id="3919181">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3919185">&amp;&amp;</span>&nbsp;<span class="ident" id="3919188">l</span><span class="op" id="3919189">[</span><span class="num" id="3919190">0</span><span class="op" id="3919191">]</span>&nbsp;<span class="op" id="3919193">!=</span>&nbsp;<span class="string" id="3919196">&#39;\t&#39;</span><span class="op" id="3919200">:</span>&nbsp;<span class="comment" id="3919202">//&nbsp;new&nbsp;interface&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3919227">name</span>&nbsp;<span class="op" id="3919232">=</span>&nbsp;<span class="ident" id="3919234">f</span><span class="op" id="3919235">[</span><span class="num" id="3919236">1</span><span class="op" id="3919237">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3919241">case</span>&nbsp;<span class="builtinfunc" id="3919246">len</span><span class="op" id="3919249">(</span><span class="ident" id="3919250">f</span><span class="op" id="3919251">[</span><span class="num" id="3919252">0</span><span class="op" id="3919253">]</span><span class="op" id="3919254">)</span>&nbsp;<span class="op" id="3919256">==</span>&nbsp;<span class="num" id="3919259">8</span><span class="op" id="3919260">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3919265">if</span>&nbsp;<span class="ident" id="3919268">ifi</span>&nbsp;<span class="op" id="3919272">==</span>&nbsp;<span class="builtintype" id="3919275">nil</span>&nbsp;<span class="op" id="3919279">||</span>&nbsp;<span class="ident" id="3919282">name</span>&nbsp;<span class="op" id="3919287">==</span>&nbsp;<span class="ident" id="3919290">ifi</span><span class="op" id="3919293">.</span><span class="ident" id="3919294">Name</span>&nbsp;<span class="op" id="3919299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3919305">//&nbsp;The&nbsp;Linux&nbsp;kernel&nbsp;puts&nbsp;the&nbsp;IP</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3919341">//&nbsp;address&nbsp;in&nbsp;/proc/net/igmp&nbsp;in&nbsp;native</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3919384">//&nbsp;endianness.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3919403">for</span>&nbsp;<span class="ident" id="3919407">i</span>&nbsp;<span class="op" id="3919409">:=</span>&nbsp;<span class="num" id="3919412">0</span><span class="op" id="3919413">;</span>&nbsp;<span class="ident" id="3919415">i</span><span class="op" id="3919416">+</span><span class="num" id="3919417">1</span>&nbsp;<span class="op" id="3919419">&lt;</span>&nbsp;<span class="builtinfunc" id="3919421">len</span><span class="op" id="3919424">(</span><span class="ident" id="3919425">f</span><span class="op" id="3919426">[</span><span class="num" id="3919427">0</span><span class="op" id="3919428">]</span><span class="op" id="3919429">)</span><span class="op" id="3919430">;</span>&nbsp;<span class="ident" id="3919432">i</span>&nbsp;<span class="op" id="3919434">+=</span>&nbsp;<span class="num" id="3919437">2</span>&nbsp;<span class="op" id="3919439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3919446">b</span><span class="op" id="3919447">[</span><span class="ident" id="3919448">i</span><span class="op" id="3919449">/</span><span class="num" id="3919450">2</span><span class="op" id="3919451">]</span><span class="op" id="3919452">,</span>&nbsp;<span class="ident" id="3919454">_</span>&nbsp;<span class="op" id="3919456">=</span>&nbsp;<span class="ident" id="3919458">xtoi2</span><span class="op" id="3919463">(</span><span class="ident" id="3919464">f</span><span class="op" id="3919465">[</span><span class="num" id="3919466">0</span><span class="op" id="3919467">]</span><span class="op" id="3919468">[</span><span class="ident" id="3919469">i</span><span class="op" id="3919470">:</span><span class="ident" id="3919471">i</span><span class="op" id="3919472">+</span><span class="num" id="3919473">2</span><span class="op" id="3919474">]</span><span class="op" id="3919475">,</span>&nbsp;<span class="num" id="3919477">0</span><span class="op" id="3919478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3919484">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3919490">i</span>&nbsp;<span class="op" id="3919492">:=</span>&nbsp;<span class="op" id="3919495">*</span><span class="op" id="3919496">(</span><span class="op" id="3919497">*</span><span class="builtintype" id="3919498">uint32</span><span class="op" id="3919504">)</span><span class="op" id="3919505">(</span><span class="ident" id="3919506">unsafe</span><span class="op" id="3919512">.</span><span class="ident" id="3919513">Pointer</span><span class="op" id="3919520">(</span><span class="op" id="3919521">&amp;</span><span class="ident" id="3919522">b</span><span class="op" id="3919523">[</span><span class="op" id="3919524">:</span><span class="num" id="3919525">4</span><span class="op" id="3919526">]</span><span class="op" id="3919527">[</span><span class="num" id="3919528">0</span><span class="op" id="3919529">]</span><span class="op" id="3919530">)</span><span class="op" id="3919531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3919537">ifma</span>&nbsp;<span class="op" id="3919542">:=</span>&nbsp;<span class="ident" id="3919545">IPAddr</span><span class="op" id="3919551">{</span><span class="ident" id="3919552">IP</span><span class="op" id="3919554">:</span>&nbsp;<span class="ident" id="3919556">IPv4</span><span class="op" id="3919560">(</span><span class="builtintype" id="3919561">byte</span><span class="op" id="3919565">(</span><span class="ident" id="3919566">i</span><span class="op" id="3919567">&gt;&gt;</span><span class="num" id="3919569">24</span><span class="op" id="3919571">)</span><span class="op" id="3919572">,</span>&nbsp;<span class="builtintype" id="3919574">byte</span><span class="op" id="3919578">(</span><span class="ident" id="3919579">i</span><span class="op" id="3919580">&gt;&gt;</span><span class="num" id="3919582">16</span><span class="op" id="3919584">)</span><span class="op" id="3919585">,</span>&nbsp;<span class="builtintype" id="3919587">byte</span><span class="op" id="3919591">(</span><span class="ident" id="3919592">i</span><span class="op" id="3919593">&gt;&gt;</span><span class="num" id="3919595">8</span><span class="op" id="3919596">)</span><span class="op" id="3919597">,</span>&nbsp;<span class="builtintype" id="3919599">byte</span><span class="op" id="3919603">(</span><span class="ident" id="3919604">i</span><span class="op" id="3919605">)</span><span class="op" id="3919606">)</span><span class="op" id="3919607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3919613">ifmat</span>&nbsp;<span class="op" id="3919619">=</span>&nbsp;<span class="builtinfunc" id="3919621">append</span><span class="op" id="3919627">(</span><span class="ident" id="3919628">ifmat</span><span class="op" id="3919633">,</span>&nbsp;<span class="ident" id="3919635">ifma</span><span class="op" id="3919639">.</span><span class="ident" id="3919640">toAddr</span><span class="op" id="3919646">(</span><span class="op" id="3919647">)</span><span class="op" id="3919648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3919653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3919657">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3919660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3919663">return</span>&nbsp;<span class="ident" id="3919670">ifmat</span><br>
<span class="lineno"></span><span class="op" id="3919676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3919679">func</span>&nbsp;<span class="ident" id="3919684">parseProcNetIGMP6</span><span class="op" id="3919701">(</span><span class="ident" id="3919702">path</span>&nbsp;<span class="builtintype" id="3919707">string</span><span class="op" id="3919713">,</span>&nbsp;<span class="ident" id="3919715">ifi</span>&nbsp;<span class="op" id="3919719">*</span><span class="ident" id="3919720">Interface</span><span class="op" id="3919729">)</span>&nbsp;<span class="op" id="3919731">[</span><span class="op" id="3919732">]</span><span class="ident" id="3919733">Addr</span>&nbsp;<span class="op" id="3919738">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3919741">fd</span><span class="op" id="3919743">,</span>&nbsp;<span class="ident" id="3919745">err</span>&nbsp;<span class="op" id="3919749">:=</span>&nbsp;<span class="ident" id="3919752">open</span><span class="op" id="3919756">(</span><span class="ident" id="3919757">path</span><span class="op" id="3919761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3919764">if</span>&nbsp;<span class="ident" id="3919767">err</span>&nbsp;<span class="op" id="3919771">!=</span>&nbsp;<span class="builtintype" id="3919774">nil</span>&nbsp;<span class="op" id="3919778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3919782">return</span>&nbsp;<span class="builtintype" id="3919789">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3919794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3919797">defer</span>&nbsp;<span class="ident" id="3919803">fd</span><span class="op" id="3919805">.</span><span class="builtinfunc" id="3919806">close</span><span class="op" id="3919811">(</span><span class="op" id="3919812">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3919815">var</span>&nbsp;<span class="ident" id="3919819">ifmat</span>&nbsp;<span class="op" id="3919825">[</span><span class="op" id="3919826">]</span><span class="ident" id="3919827">Addr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3919833">b</span>&nbsp;<span class="op" id="3919835">:=</span>&nbsp;<span class="builtinfunc" id="3919838">make</span><span class="op" id="3919842">(</span><span class="op" id="3919843">[</span><span class="op" id="3919844">]</span><span class="builtintype" id="3919845">byte</span><span class="op" id="3919849">,</span>&nbsp;<span class="ident" id="3919851">IPv6len</span><span class="op" id="3919858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3919861">for</span>&nbsp;<span class="ident" id="3919865">l</span><span class="op" id="3919866">,</span>&nbsp;<span class="ident" id="3919868">ok</span>&nbsp;<span class="op" id="3919871">:=</span>&nbsp;<span class="ident" id="3919874">fd</span><span class="op" id="3919876">.</span><span class="ident" id="3919877">readLine</span><span class="op" id="3919885">(</span><span class="op" id="3919886">)</span><span class="op" id="3919887">;</span>&nbsp;<span class="ident" id="3919889">ok</span><span class="op" id="3919891">;</span>&nbsp;<span class="ident" id="3919893">l</span><span class="op" id="3919894">,</span>&nbsp;<span class="ident" id="3919896">ok</span>&nbsp;<span class="op" id="3919899">=</span>&nbsp;<span class="ident" id="3919901">fd</span><span class="op" id="3919903">.</span><span class="ident" id="3919904">readLine</span><span class="op" id="3919912">(</span><span class="op" id="3919913">)</span>&nbsp;<span class="op" id="3919915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3919919">f</span>&nbsp;<span class="op" id="3919921">:=</span>&nbsp;<span class="ident" id="3919924">splitAtBytes</span><span class="op" id="3919936">(</span><span class="ident" id="3919937">l</span><span class="op" id="3919938">,</span>&nbsp;<span class="string" id="3919940">&#34;&nbsp;\r\t\n&#34;</span><span class="op" id="3919949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3919953">if</span>&nbsp;<span class="builtinfunc" id="3919956">len</span><span class="op" id="3919959">(</span><span class="ident" id="3919960">f</span><span class="op" id="3919961">)</span>&nbsp;<span class="op" id="3919963">&lt;</span>&nbsp;<span class="num" id="3919965">6</span>&nbsp;<span class="op" id="3919967">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3919972">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3919983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3919987">if</span>&nbsp;<span class="ident" id="3919990">ifi</span>&nbsp;<span class="op" id="3919994">==</span>&nbsp;<span class="builtintype" id="3919997">nil</span>&nbsp;<span class="op" id="3920001">||</span>&nbsp;<span class="ident" id="3920004">f</span><span class="op" id="3920005">[</span><span class="num" id="3920006">1</span><span class="op" id="3920007">]</span>&nbsp;<span class="op" id="3920009">==</span>&nbsp;<span class="ident" id="3920012">ifi</span><span class="op" id="3920015">.</span><span class="ident" id="3920016">Name</span>&nbsp;<span class="op" id="3920021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3920026">for</span>&nbsp;<span class="ident" id="3920030">i</span>&nbsp;<span class="op" id="3920032">:=</span>&nbsp;<span class="num" id="3920035">0</span><span class="op" id="3920036">;</span>&nbsp;<span class="ident" id="3920038">i</span><span class="op" id="3920039">+</span><span class="num" id="3920040">1</span>&nbsp;<span class="op" id="3920042">&lt;</span>&nbsp;<span class="builtinfunc" id="3920044">len</span><span class="op" id="3920047">(</span><span class="ident" id="3920048">f</span><span class="op" id="3920049">[</span><span class="num" id="3920050">2</span><span class="op" id="3920051">]</span><span class="op" id="3920052">)</span><span class="op" id="3920053">;</span>&nbsp;<span class="ident" id="3920055">i</span>&nbsp;<span class="op" id="3920057">+=</span>&nbsp;<span class="num" id="3920060">2</span>&nbsp;<span class="op" id="3920062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3920068">b</span><span class="op" id="3920069">[</span><span class="ident" id="3920070">i</span><span class="op" id="3920071">/</span><span class="num" id="3920072">2</span><span class="op" id="3920073">]</span><span class="op" id="3920074">,</span>&nbsp;<span class="ident" id="3920076">_</span>&nbsp;<span class="op" id="3920078">=</span>&nbsp;<span class="ident" id="3920080">xtoi2</span><span class="op" id="3920085">(</span><span class="ident" id="3920086">f</span><span class="op" id="3920087">[</span><span class="num" id="3920088">2</span><span class="op" id="3920089">]</span><span class="op" id="3920090">[</span><span class="ident" id="3920091">i</span><span class="op" id="3920092">:</span><span class="ident" id="3920093">i</span><span class="op" id="3920094">+</span><span class="num" id="3920095">2</span><span class="op" id="3920096">]</span><span class="op" id="3920097">,</span>&nbsp;<span class="num" id="3920099">0</span><span class="op" id="3920100">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3920105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3920110">ifma</span>&nbsp;<span class="op" id="3920115">:=</span>&nbsp;<span class="ident" id="3920118">IPAddr</span><span class="op" id="3920124">{</span><span class="ident" id="3920125">IP</span><span class="op" id="3920127">:</span>&nbsp;<span class="ident" id="3920129">IP</span><span class="op" id="3920131">{</span><span class="ident" id="3920132">b</span><span class="op" id="3920133">[</span><span class="num" id="3920134">0</span><span class="op" id="3920135">]</span><span class="op" id="3920136">,</span>&nbsp;<span class="ident" id="3920138">b</span><span class="op" id="3920139">[</span><span class="num" id="3920140">1</span><span class="op" id="3920141">]</span><span class="op" id="3920142">,</span>&nbsp;<span class="ident" id="3920144">b</span><span class="op" id="3920145">[</span><span class="num" id="3920146">2</span><span class="op" id="3920147">]</span><span class="op" id="3920148">,</span>&nbsp;<span class="ident" id="3920150">b</span><span class="op" id="3920151">[</span><span class="num" id="3920152">3</span><span class="op" id="3920153">]</span><span class="op" id="3920154">,</span>&nbsp;<span class="ident" id="3920156">b</span><span class="op" id="3920157">[</span><span class="num" id="3920158">4</span><span class="op" id="3920159">]</span><span class="op" id="3920160">,</span>&nbsp;<span class="ident" id="3920162">b</span><span class="op" id="3920163">[</span><span class="num" id="3920164">5</span><span class="op" id="3920165">]</span><span class="op" id="3920166">,</span>&nbsp;<span class="ident" id="3920168">b</span><span class="op" id="3920169">[</span><span class="num" id="3920170">6</span><span class="op" id="3920171">]</span><span class="op" id="3920172">,</span>&nbsp;<span class="ident" id="3920174">b</span><span class="op" id="3920175">[</span><span class="num" id="3920176">7</span><span class="op" id="3920177">]</span><span class="op" id="3920178">,</span>&nbsp;<span class="ident" id="3920180">b</span><span class="op" id="3920181">[</span><span class="num" id="3920182">8</span><span class="op" id="3920183">]</span><span class="op" id="3920184">,</span>&nbsp;<span class="ident" id="3920186">b</span><span class="op" id="3920187">[</span><span class="num" id="3920188">9</span><span class="op" id="3920189">]</span><span class="op" id="3920190">,</span>&nbsp;<span class="ident" id="3920192">b</span><span class="op" id="3920193">[</span><span class="num" id="3920194">10</span><span class="op" id="3920196">]</span><span class="op" id="3920197">,</span>&nbsp;<span class="ident" id="3920199">b</span><span class="op" id="3920200">[</span><span class="num" id="3920201">11</span><span class="op" id="3920203">]</span><span class="op" id="3920204">,</span>&nbsp;<span class="ident" id="3920206">b</span><span class="op" id="3920207">[</span><span class="num" id="3920208">12</span><span class="op" id="3920210">]</span><span class="op" id="3920211">,</span>&nbsp;<span class="ident" id="3920213">b</span><span class="op" id="3920214">[</span><span class="num" id="3920215">13</span><span class="op" id="3920217">]</span><span class="op" id="3920218">,</span>&nbsp;<span class="ident" id="3920220">b</span><span class="op" id="3920221">[</span><span class="num" id="3920222">14</span><span class="op" id="3920224">]</span><span class="op" id="3920225">,</span>&nbsp;<span class="ident" id="3920227">b</span><span class="op" id="3920228">[</span><span class="num" id="3920229">15</span><span class="op" id="3920231">]</span><span class="op" id="3920232">}</span><span class="op" id="3920233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3920238">ifmat</span>&nbsp;<span class="op" id="3920244">=</span>&nbsp;<span class="builtinfunc" id="3920246">append</span><span class="op" id="3920252">(</span><span class="ident" id="3920253">ifmat</span><span class="op" id="3920258">,</span>&nbsp;<span class="ident" id="3920260">ifma</span><span class="op" id="3920264">.</span><span class="ident" id="3920265">toAddr</span><span class="op" id="3920271">(</span><span class="op" id="3920272">)</span><span class="op" id="3920273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3920277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3920280">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3920283">return</span>&nbsp;<span class="ident" id="3920290">ifmat</span><br>
<span class="lineno"></span><span class="op" id="3920296">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
