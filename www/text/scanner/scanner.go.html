<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4940572">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4940627">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4940681">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4940732">//&nbsp;Package&nbsp;scanner&nbsp;provides&nbsp;a&nbsp;scanner&nbsp;and&nbsp;tokenizer&nbsp;for&nbsp;UTF-8-encoded&nbsp;text.</span><br>
<span class="lineno"></span><span class="comment" id="4940808">//&nbsp;It&nbsp;takes&nbsp;an&nbsp;io.Reader&nbsp;providing&nbsp;the&nbsp;source,&nbsp;which&nbsp;then&nbsp;can&nbsp;be&nbsp;tokenized</span><br>
<span class="lineno"></span><span class="comment" id="4940883">//&nbsp;through&nbsp;repeated&nbsp;calls&nbsp;to&nbsp;the&nbsp;Scan&nbsp;function.&nbsp;&nbsp;For&nbsp;compatibility&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="4940955">//&nbsp;existing&nbsp;tools,&nbsp;the&nbsp;NUL&nbsp;character&nbsp;is&nbsp;not&nbsp;allowed.&nbsp;If&nbsp;the&nbsp;first&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="4941031">//&nbsp;in&nbsp;the&nbsp;source&nbsp;is&nbsp;a&nbsp;UTF-8&nbsp;encoded&nbsp;byte&nbsp;order&nbsp;mark&nbsp;(BOM),&nbsp;it&nbsp;is&nbsp;discarded.</span><br>
<span class="lineno">10</span><span class="comment" id="4941107">//</span><br>
<span class="lineno"></span><span class="comment" id="4941110">//&nbsp;By&nbsp;default,&nbsp;a&nbsp;Scanner&nbsp;skips&nbsp;white&nbsp;space&nbsp;and&nbsp;Go&nbsp;comments&nbsp;and&nbsp;recognizes&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="4941188">//&nbsp;literals&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;Go&nbsp;language&nbsp;specification.&nbsp;&nbsp;It&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4941256">//&nbsp;customized&nbsp;to&nbsp;recognize&nbsp;only&nbsp;a&nbsp;subset&nbsp;of&nbsp;those&nbsp;literals&nbsp;and&nbsp;to&nbsp;recognize</span><br>
<span class="lineno"></span><span class="comment" id="4941332">//&nbsp;different&nbsp;identifier&nbsp;and&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno">15</span><span class="comment" id="4941384">//</span><br>
<span class="lineno"></span><span class="comment" id="4941387">//&nbsp;Basic&nbsp;usage&nbsp;pattern:</span><br>
<span class="lineno"></span><span class="comment" id="4941411">//</span><br>
<span class="lineno"></span><span class="comment" id="4941414">//&nbsp;&nbsp;&nbsp;&nbspvar&nbsp;s&nbsp;scanner.Scanner</span><br>
<span class="lineno"></span><span class="comment" id="4941439">//&nbsp;&nbsp;&nbsp;&nbsps.Init(src)</span><br>
<span class="lineno">20</span><span class="comment" id="4941454">//&nbsp;&nbsp;&nbsp;&nbsptok&nbsp;:=&nbsp;s.Scan()</span><br>
<span class="lineno"></span><span class="comment" id="4941473">//&nbsp;&nbsp;&nbsp;&nbspfor&nbsp;tok&nbsp;!=&nbsp;scanner.EOF&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4941501">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;do&nbsp;something&nbsp;with&nbsp;tok</span><br>
<span class="lineno"></span><span class="comment" id="4941530">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsptok&nbsp;=&nbsp;s.Scan()</span><br>
<span class="lineno"></span><span class="comment" id="4941549">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno">25</span><span class="comment" id="4941554">//</span><br>
<span class="lineno"></span><span class="keyword" id="4941557">package</span>&nbsp;<span class="ident" id="4941565">scanner</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4941574">import</span>&nbsp;<span class="op" id="4941581">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4941584">&#34;bytes&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4941593">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4941600">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4941606">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4941612">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4941623">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">35</span><span class="op" id="4941638">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4941641">//&nbsp;A&nbsp;source&nbsp;position&nbsp;is&nbsp;represented&nbsp;by&nbsp;a&nbsp;Position&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="4941698">//&nbsp;A&nbsp;position&nbsp;is&nbsp;valid&nbsp;if&nbsp;Line&nbsp;&gt;&nbsp;0.</span><br>
<span class="lineno"></span><span class="keyword" id="4941734">type</span>&nbsp;<span class="ident" id="4941739">Position</span>&nbsp;<span class="keyword" id="4941748">struct</span>&nbsp;<span class="op" id="4941755">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4941758">Filename</span>&nbsp;<span class="builtintype" id="4941767">string</span>&nbsp;<span class="comment" id="4941774">//&nbsp;filename,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4941795">Offset</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4941804">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4941811">//&nbsp;byte&nbsp;offset,&nbsp;starting&nbsp;at&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4941842">Line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4941851">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4941858">//&nbsp;line&nbsp;number,&nbsp;starting&nbsp;at&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4941889">Column</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4941898">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4941905">//&nbsp;column&nbsp;number,&nbsp;starting&nbsp;at&nbsp;1&nbsp;(character&nbsp;count&nbsp;per&nbsp;line)</span><br>
<span class="lineno"></span><span class="op" id="4941964">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="4941967">//&nbsp;IsValid&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;position&nbsp;is&nbsp;valid.</span><br>
<span class="lineno"></span><span class="keyword" id="4942017">func</span>&nbsp;<span class="op" id="4942022">(</span><span class="ident" id="4942023">pos</span>&nbsp;<span class="op" id="4942027">*</span><span class="ident" id="4942028">Position</span><span class="op" id="4942036">)</span>&nbsp;<span class="ident" id="4942038">IsValid</span><span class="op" id="4942045">(</span><span class="op" id="4942046">)</span>&nbsp;<span class="builtintype" id="4942048">bool</span>&nbsp;<span class="op" id="4942053">{</span>&nbsp;<span class="keyword" id="4942055">return</span>&nbsp;<span class="ident" id="4942062">pos</span><span class="op" id="4942065">.</span><span class="ident" id="4942066">Line</span>&nbsp;<span class="op" id="4942071">&gt;</span>&nbsp;<span class="num" id="4942073">0</span>&nbsp;<span class="op" id="4942075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4942078">func</span>&nbsp;<span class="op" id="4942083">(</span><span class="ident" id="4942084">pos</span>&nbsp;<span class="ident" id="4942088">Position</span><span class="op" id="4942096">)</span>&nbsp;<span class="ident" id="4942098">String</span><span class="op" id="4942104">(</span><span class="op" id="4942105">)</span>&nbsp;<span class="builtintype" id="4942107">string</span>&nbsp;<span class="op" id="4942114">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4942117">s</span>&nbsp;<span class="op" id="4942119">:=</span>&nbsp;<span class="ident" id="4942122">pos</span><span class="op" id="4942125">.</span><span class="ident" id="4942126">Filename</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4942136">if</span>&nbsp;<span class="ident" id="4942139">pos</span><span class="op" id="4942142">.</span><span class="ident" id="4942143">IsValid</span><span class="op" id="4942150">(</span><span class="op" id="4942151">)</span>&nbsp;<span class="op" id="4942153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4942157">if</span>&nbsp;<span class="ident" id="4942160">s</span>&nbsp;<span class="op" id="4942162">!=</span>&nbsp;<span class="string" id="4942165">&#34;&#34;</span>&nbsp;<span class="op" id="4942168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4942173">s</span>&nbsp;<span class="op" id="4942175">+=</span>&nbsp;<span class="string" id="4942178">&#34;:&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4942184">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4942188">s</span>&nbsp;<span class="op" id="4942190">+=</span>&nbsp;<span class="ident" id="4942193">fmt</span><span class="op" id="4942196">.</span><span class="ident" id="4942197">Sprintf</span><span class="op" id="4942204">(</span><span class="string" id="4942205">&#34;%d:%d&#34;</span><span class="op" id="4942212">,</span>&nbsp;<span class="ident" id="4942214">pos</span><span class="op" id="4942217">.</span><span class="ident" id="4942218">Line</span><span class="op" id="4942222">,</span>&nbsp;<span class="ident" id="4942224">pos</span><span class="op" id="4942227">.</span><span class="ident" id="4942228">Column</span><span class="op" id="4942234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4942237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4942240">if</span>&nbsp;<span class="ident" id="4942243">s</span>&nbsp;<span class="op" id="4942245">==</span>&nbsp;<span class="string" id="4942248">&#34;&#34;</span>&nbsp;<span class="op" id="4942251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4942255">s</span>&nbsp;<span class="op" id="4942257">=</span>&nbsp;<span class="string" id="4942259">&#34;???&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4942266">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4942269">return</span>&nbsp;<span class="ident" id="4942276">s</span><br>
<span class="lineno"></span><span class="op" id="4942278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4942281">//&nbsp;Predefined&nbsp;mode&nbsp;bits&nbsp;to&nbsp;control&nbsp;recognition&nbsp;of&nbsp;tokens.&nbsp;For&nbsp;instance,</span><br>
<span class="lineno"></span><span class="comment" id="4942353">//&nbsp;to&nbsp;configure&nbsp;a&nbsp;Scanner&nbsp;such&nbsp;that&nbsp;it&nbsp;only&nbsp;recognizes&nbsp;(Go)&nbsp;identifiers,</span><br>
<span class="lineno">65</span><span class="comment" id="4942426">//&nbsp;integers,&nbsp;and&nbsp;skips&nbsp;comments,&nbsp;set&nbsp;the&nbsp;Scanner&#39;s&nbsp;Mode&nbsp;field&nbsp;to:</span><br>
<span class="lineno"></span><span class="comment" id="4942492">//</span><br>
<span class="lineno"></span><span class="comment" id="4942495">//&nbsp;&nbsp;&nbsp;&nbspScanIdents&nbsp;|&nbsp;ScanInts&nbsp;|&nbsp;SkipComments</span><br>
<span class="lineno"></span><span class="comment" id="4942535">//</span><br>
<span class="lineno"></span><span class="comment" id="4942538">//&nbsp;With&nbsp;the&nbsp;exceptions&nbsp;of&nbsp;comments,&nbsp;which&nbsp;are&nbsp;skipped&nbsp;if&nbsp;SkipComments&nbsp;is</span><br>
<span class="lineno">70</span><span class="comment" id="4942611">//&nbsp;set,&nbsp;unrecognized&nbsp;tokens&nbsp;are&nbsp;not&nbsp;ignored.&nbsp;Instead,&nbsp;the&nbsp;scanner&nbsp;simply</span><br>
<span class="lineno"></span><span class="comment" id="4942684">//&nbsp;returns&nbsp;the&nbsp;respective&nbsp;individual&nbsp;characters&nbsp;(or&nbsp;possibly&nbsp;sub-tokens).</span><br>
<span class="lineno"></span><span class="comment" id="4942758">//&nbsp;For&nbsp;instance,&nbsp;if&nbsp;the&nbsp;mode&nbsp;is&nbsp;ScanIdents&nbsp;(not&nbsp;ScanStrings),&nbsp;the&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="4942831">//&nbsp;&#34;foo&#34;&nbsp;is&nbsp;scanned&nbsp;as&nbsp;the&nbsp;token&nbsp;sequence&nbsp;&#39;&#34;&#39;&nbsp;Ident&nbsp;&#39;&#34;&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="4942888">//</span><br>
<span class="lineno">75</span><span class="keyword" id="4942891">const</span>&nbsp;<span class="op" id="4942897">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4942900">ScanIdents</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4942915">=</span>&nbsp;<span class="num" id="4942917">1</span>&nbsp;<span class="op" id="4942919">&lt;&lt;</span>&nbsp;<span class="op" id="4942922">-</span><span class="ident" id="4942923">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4942930">ScanInts</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4942945">=</span>&nbsp;<span class="num" id="4942947">1</span>&nbsp;<span class="op" id="4942949">&lt;&lt;</span>&nbsp;<span class="op" id="4942952">-</span><span class="ident" id="4942953">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4942958">ScanFloats</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4942973">=</span>&nbsp;<span class="num" id="4942975">1</span>&nbsp;<span class="op" id="4942977">&lt;&lt;</span>&nbsp;<span class="op" id="4942980">-</span><span class="ident" id="4942981">Float</span>&nbsp;<span class="comment" id="4942987">//&nbsp;includes&nbsp;Ints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4943005">ScanChars</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4943020">=</span>&nbsp;<span class="num" id="4943022">1</span>&nbsp;<span class="op" id="4943024">&lt;&lt;</span>&nbsp;<span class="op" id="4943027">-</span><span class="ident" id="4943028">Char</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4943034">ScanStrings</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4943049">=</span>&nbsp;<span class="num" id="4943051">1</span>&nbsp;<span class="op" id="4943053">&lt;&lt;</span>&nbsp;<span class="op" id="4943056">-</span><span class="ident" id="4943057">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4943065">ScanRawStrings</span>&nbsp;<span class="op" id="4943080">=</span>&nbsp;<span class="num" id="4943082">1</span>&nbsp;<span class="op" id="4943084">&lt;&lt;</span>&nbsp;<span class="op" id="4943087">-</span><span class="ident" id="4943088">RawString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4943099">ScanComments</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4943114">=</span>&nbsp;<span class="num" id="4943116">1</span>&nbsp;<span class="op" id="4943118">&lt;&lt;</span>&nbsp;<span class="op" id="4943121">-</span><span class="ident" id="4943122">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4943131">SkipComments</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4943146">=</span>&nbsp;<span class="num" id="4943148">1</span>&nbsp;<span class="op" id="4943150">&lt;&lt;</span>&nbsp;<span class="op" id="4943153">-</span><span class="ident" id="4943154">skipComment</span>&nbsp;<span class="comment" id="4943166">//&nbsp;if&nbsp;set&nbsp;with&nbsp;ScanComments,&nbsp;comments&nbsp;become&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4943224">GoTokens</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4943239">=</span>&nbsp;<span class="ident" id="4943241">ScanIdents</span>&nbsp;<span class="op" id="4943252">|</span>&nbsp;<span class="ident" id="4943254">ScanFloats</span>&nbsp;<span class="op" id="4943265">|</span>&nbsp;<span class="ident" id="4943267">ScanChars</span>&nbsp;<span class="op" id="4943277">|</span>&nbsp;<span class="ident" id="4943279">ScanStrings</span>&nbsp;<span class="op" id="4943291">|</span>&nbsp;<span class="ident" id="4943293">ScanRawStrings</span>&nbsp;<span class="op" id="4943308">|</span>&nbsp;<span class="ident" id="4943310">ScanComments</span>&nbsp;<span class="op" id="4943323">|</span>&nbsp;<span class="ident" id="4943325">SkipComments</span><br>
<span class="lineno">85</span><span class="op" id="4943338">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4943341">//&nbsp;The&nbsp;result&nbsp;of&nbsp;Scan&nbsp;is&nbsp;one&nbsp;of&nbsp;the&nbsp;following&nbsp;tokens&nbsp;or&nbsp;a&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="4943418">const</span>&nbsp;<span class="op" id="4943424">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4943427">EOF</span>&nbsp;<span class="op" id="4943431">=</span>&nbsp;<span class="op" id="4943433">-</span><span class="op" id="4943434">(</span><span class="ident" id="4943435">iota</span>&nbsp;<span class="op" id="4943440">+</span>&nbsp;<span class="num" id="4943442">1</span><span class="op" id="4943443">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4943446">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4943453">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4943458">Float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4943465">Char</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4943471">String</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4943479">RawString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4943490">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4943499">skipComment</span><br>
<span class="lineno"></span><span class="op" id="4943511">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="4943514">var</span>&nbsp;<span class="ident" id="4943518">tokenString</span>&nbsp;<span class="op" id="4943530">=</span>&nbsp;<span class="keyword" id="4943532">map</span><span class="op" id="4943535">[</span><span class="builtintype" id="4943536">rune</span><span class="op" id="4943540">]</span><span class="builtintype" id="4943541">string</span><span class="op" id="4943547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4943550">EOF</span><span class="op" id="4943553">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4943561">&#34;EOF&#34;</span><span class="op" id="4943566">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4943569">Ident</span><span class="op" id="4943574">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4943580">&#34;Ident&#34;</span><span class="op" id="4943587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4943590">Int</span><span class="op" id="4943593">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4943601">&#34;Int&#34;</span><span class="op" id="4943606">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4943609">Float</span><span class="op" id="4943614">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4943620">&#34;Float&#34;</span><span class="op" id="4943627">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4943630">Char</span><span class="op" id="4943634">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4943641">&#34;Char&#34;</span><span class="op" id="4943647">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4943650">String</span><span class="op" id="4943656">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4943661">&#34;String&#34;</span><span class="op" id="4943669">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4943672">RawString</span><span class="op" id="4943681">:</span>&nbsp;<span class="string" id="4943683">&#34;RawString&#34;</span><span class="op" id="4943694">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4943697">Comment</span><span class="op" id="4943704">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4943708">&#34;Comment&#34;</span><span class="op" id="4943717">,</span><br>
<span class="lineno"></span><span class="op" id="4943719">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="4943722">//&nbsp;TokenString&nbsp;returns&nbsp;a&nbsp;printable&nbsp;string&nbsp;for&nbsp;a&nbsp;token&nbsp;or&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="4943798">func</span>&nbsp;<span class="ident" id="4943803">TokenString</span><span class="op" id="4943814">(</span><span class="ident" id="4943815">tok</span>&nbsp;<span class="builtintype" id="4943819">rune</span><span class="op" id="4943823">)</span>&nbsp;<span class="builtintype" id="4943825">string</span>&nbsp;<span class="op" id="4943832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4943835">if</span>&nbsp;<span class="ident" id="4943838">s</span><span class="op" id="4943839">,</span>&nbsp;<span class="ident" id="4943841">found</span>&nbsp;<span class="op" id="4943847">:=</span>&nbsp;<span class="ident" id="4943850">tokenString</span><span class="op" id="4943861">[</span><span class="ident" id="4943862">tok</span><span class="op" id="4943865">]</span><span class="op" id="4943866">;</span>&nbsp;<span class="ident" id="4943868">found</span>&nbsp;<span class="op" id="4943874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4943878">return</span>&nbsp;<span class="ident" id="4943885">s</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4943888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4943891">return</span>&nbsp;<span class="ident" id="4943898">fmt</span><span class="op" id="4943901">.</span><span class="ident" id="4943902">Sprintf</span><span class="op" id="4943909">(</span><span class="string" id="4943910">&#34;%q&#34;</span><span class="op" id="4943914">,</span>&nbsp;<span class="builtintype" id="4943916">string</span><span class="op" id="4943922">(</span><span class="ident" id="4943923">tok</span><span class="op" id="4943926">)</span><span class="op" id="4943927">)</span><br>
<span class="lineno"></span><span class="op" id="4943929">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4943932">//&nbsp;GoWhitespace&nbsp;is&nbsp;the&nbsp;default&nbsp;value&nbsp;for&nbsp;the&nbsp;Scanner&#39;s&nbsp;Whitespace&nbsp;field.</span><br>
<span class="lineno">120</span><span class="comment" id="4944005">//&nbsp;Its&nbsp;value&nbsp;selects&nbsp;Go&#39;s&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno"></span><span class="keyword" id="4944055">const</span>&nbsp;<span class="ident" id="4944061">GoWhitespace</span>&nbsp;<span class="op" id="4944074">=</span>&nbsp;<span class="num" id="4944076">1</span><span class="op" id="4944077">&lt;&lt;</span><span class="string" id="4944079">&#39;\t&#39;</span>&nbsp;<span class="op" id="4944084">|</span>&nbsp;<span class="num" id="4944086">1</span><span class="op" id="4944087">&lt;&lt;</span><span class="string" id="4944089">&#39;\n&#39;</span>&nbsp;<span class="op" id="4944094">|</span>&nbsp;<span class="num" id="4944096">1</span><span class="op" id="4944097">&lt;&lt;</span><span class="string" id="4944099">&#39;\r&#39;</span>&nbsp;<span class="op" id="4944104">|</span>&nbsp;<span class="num" id="4944106">1</span><span class="op" id="4944107">&lt;&lt;</span><span class="string" id="4944109">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4944114">const</span>&nbsp;<span class="ident" id="4944120">bufLen</span>&nbsp;<span class="op" id="4944127">=</span>&nbsp;<span class="num" id="4944129">1024</span>&nbsp;<span class="comment" id="4944134">//&nbsp;at&nbsp;least&nbsp;utf8.UTFMax</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="4944159">//&nbsp;A&nbsp;Scanner&nbsp;implements&nbsp;reading&nbsp;of&nbsp;Unicode&nbsp;characters&nbsp;and&nbsp;tokens&nbsp;from&nbsp;an&nbsp;io.Reader.</span><br>
<span class="lineno"></span><span class="keyword" id="4944243">type</span>&nbsp;<span class="ident" id="4944248">Scanner</span>&nbsp;<span class="keyword" id="4944256">struct</span>&nbsp;<span class="op" id="4944263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4944266">//&nbsp;Input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4944276">src</span>&nbsp;<span class="ident" id="4944280">io</span><span class="op" id="4944282">.</span><span class="ident" id="4944283">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4944292">//&nbsp;Source&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4944310">srcBuf</span>&nbsp;<span class="op" id="4944317">[</span><span class="ident" id="4944318">bufLen</span>&nbsp;<span class="op" id="4944325">+</span>&nbsp;<span class="num" id="4944327">1</span><span class="op" id="4944328">]</span><span class="builtintype" id="4944329">byte</span>&nbsp;<span class="comment" id="4944334">//&nbsp;+1&nbsp;for&nbsp;sentinel&nbsp;for&nbsp;common&nbsp;case&nbsp;of&nbsp;s.next()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4944382">srcPos</span>&nbsp;<span class="builtintype" id="4944389">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4944406">//&nbsp;reading&nbsp;position&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4944442">srcEnd</span>&nbsp;<span class="builtintype" id="4944449">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4944466">//&nbsp;source&nbsp;end&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4944497">//&nbsp;Source&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4944517">srcBufOffset</span>&nbsp;<span class="builtintype" id="4944530">int</span>&nbsp;<span class="comment" id="4944534">//&nbsp;byte&nbsp;offset&nbsp;of&nbsp;srcBuf[0]&nbsp;in&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4944573">line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4944586">int</span>&nbsp;<span class="comment" id="4944590">//&nbsp;line&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4944605">column</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4944618">int</span>&nbsp;<span class="comment" id="4944622">//&nbsp;character&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4944642">lastLineLen</span>&nbsp;&nbsp;<span class="builtintype" id="4944655">int</span>&nbsp;<span class="comment" id="4944659">//&nbsp;length&nbsp;of&nbsp;last&nbsp;line&nbsp;in&nbsp;characters&nbsp;(for&nbsp;correct&nbsp;column&nbsp;reporting)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4944728">lastCharLen</span>&nbsp;&nbsp;<span class="builtintype" id="4944741">int</span>&nbsp;<span class="comment" id="4944745">//&nbsp;length&nbsp;of&nbsp;last&nbsp;character&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4944784">//&nbsp;Token&nbsp;text&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4944806">//&nbsp;Typically,&nbsp;token&nbsp;text&nbsp;is&nbsp;stored&nbsp;completely&nbsp;in&nbsp;srcBuf,&nbsp;but&nbsp;in&nbsp;general</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4944879">//&nbsp;the&nbsp;token&nbsp;text&#39;s&nbsp;head&nbsp;may&nbsp;be&nbsp;buffered&nbsp;in&nbsp;tokBuf&nbsp;while&nbsp;the&nbsp;token&nbsp;text&#39;s</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4944954">//&nbsp;tail&nbsp;is&nbsp;stored&nbsp;in&nbsp;srcBuf.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4944984">tokBuf</span>&nbsp;<span class="ident" id="4944991">bytes</span><span class="op" id="4944996">.</span><span class="ident" id="4944997">Buffer</span>&nbsp;<span class="comment" id="4945004">//&nbsp;token&nbsp;text&nbsp;head&nbsp;that&nbsp;is&nbsp;not&nbsp;in&nbsp;srcBuf&nbsp;anymore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4945054">tokPos</span>&nbsp;<span class="builtintype" id="4945061">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4945074">//&nbsp;token&nbsp;text&nbsp;tail&nbsp;position&nbsp;(srcBuf&nbsp;index);&nbsp;valid&nbsp;if&nbsp;&gt;=&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4945133">tokEnd</span>&nbsp;<span class="builtintype" id="4945140">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4945153">//&nbsp;token&nbsp;text&nbsp;tail&nbsp;end&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4945193">//&nbsp;One&nbsp;character&nbsp;look-ahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4945222">ch</span>&nbsp;<span class="builtintype" id="4945225">rune</span>&nbsp;<span class="comment" id="4945230">//&nbsp;character&nbsp;before&nbsp;current&nbsp;srcPos</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4945267">//&nbsp;Error&nbsp;is&nbsp;called&nbsp;for&nbsp;each&nbsp;error&nbsp;encountered.&nbsp;If&nbsp;no&nbsp;Error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4945327">//&nbsp;function&nbsp;is&nbsp;set,&nbsp;the&nbsp;error&nbsp;is&nbsp;reported&nbsp;to&nbsp;os.Stderr.</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4945384">Error</span>&nbsp;<span class="keyword" id="4945390">func</span><span class="op" id="4945394">(</span><span class="ident" id="4945395">s</span>&nbsp;<span class="op" id="4945397">*</span><span class="ident" id="4945398">Scanner</span><span class="op" id="4945405">,</span>&nbsp;<span class="ident" id="4945407">msg</span>&nbsp;<span class="builtintype" id="4945411">string</span><span class="op" id="4945417">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4945421">//&nbsp;ErrorCount&nbsp;is&nbsp;incremented&nbsp;by&nbsp;one&nbsp;for&nbsp;each&nbsp;error&nbsp;encountered.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4945486">ErrorCount</span>&nbsp;<span class="builtintype" id="4945497">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4945503">//&nbsp;The&nbsp;Mode&nbsp;field&nbsp;controls&nbsp;which&nbsp;tokens&nbsp;are&nbsp;recognized.&nbsp;For&nbsp;instance,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4945574">//&nbsp;to&nbsp;recognize&nbsp;Ints,&nbsp;set&nbsp;the&nbsp;ScanInts&nbsp;bit&nbsp;in&nbsp;Mode.&nbsp;The&nbsp;field&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4945644">//&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4945669">Mode</span>&nbsp;<span class="builtintype" id="4945674">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4945681">//&nbsp;The&nbsp;Whitespace&nbsp;field&nbsp;controls&nbsp;which&nbsp;characters&nbsp;are&nbsp;recognized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4945747">//&nbsp;as&nbsp;white&nbsp;space.&nbsp;To&nbsp;recognize&nbsp;a&nbsp;character&nbsp;ch&nbsp;&lt;=&nbsp;&#39;&nbsp;&#39;&nbsp;as&nbsp;white&nbsp;space,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4945818">//&nbsp;set&nbsp;the&nbsp;ch&#39;th&nbsp;bit&nbsp;in&nbsp;Whitespace&nbsp;(the&nbsp;Scanner&#39;s&nbsp;behavior&nbsp;is&nbsp;undefined</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4945891">//&nbsp;for&nbsp;values&nbsp;ch&nbsp;&gt;&nbsp;&#39;&nbsp;&#39;).&nbsp;The&nbsp;field&nbsp;may&nbsp;be&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4945955">Whitespace</span>&nbsp;<span class="ident" id="4945966">uint64</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4945975">//&nbsp;IsIdentRune&nbsp;is&nbsp;a&nbsp;predicate&nbsp;controlling&nbsp;the&nbsp;characters&nbsp;accepted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4946042">//&nbsp;as&nbsp;the&nbsp;ith&nbsp;rune&nbsp;in&nbsp;an&nbsp;identifier.&nbsp;The&nbsp;set&nbsp;of&nbsp;valid&nbsp;characters</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4946108">//&nbsp;must&nbsp;not&nbsp;intersect&nbsp;with&nbsp;the&nbsp;set&nbsp;of&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4946171">//&nbsp;If&nbsp;no&nbsp;IsIdentRune&nbsp;function&nbsp;is&nbsp;set,&nbsp;regular&nbsp;Go&nbsp;identifiers&nbsp;are</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4946237">//&nbsp;accepted&nbsp;instead.&nbsp;The&nbsp;field&nbsp;may&nbsp;be&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4946297">IsIdentRune</span>&nbsp;<span class="keyword" id="4946309">func</span><span class="op" id="4946313">(</span><span class="ident" id="4946314">ch</span>&nbsp;<span class="builtintype" id="4946317">rune</span><span class="op" id="4946321">,</span>&nbsp;<span class="ident" id="4946323">i</span>&nbsp;<span class="builtintype" id="4946325">int</span><span class="op" id="4946328">)</span>&nbsp;<span class="builtintype" id="4946330">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4946337">//&nbsp;Start&nbsp;position&nbsp;of&nbsp;most&nbsp;recently&nbsp;scanned&nbsp;token;&nbsp;set&nbsp;by&nbsp;Scan.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4946401">//&nbsp;Calling&nbsp;Init&nbsp;or&nbsp;Next&nbsp;invalidates&nbsp;the&nbsp;position&nbsp;(Line&nbsp;==&nbsp;0).</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4946464">//&nbsp;The&nbsp;Filename&nbsp;field&nbsp;is&nbsp;always&nbsp;left&nbsp;untouched&nbsp;by&nbsp;the&nbsp;Scanner.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4946528">//&nbsp;If&nbsp;an&nbsp;error&nbsp;is&nbsp;reported&nbsp;(via&nbsp;Error)&nbsp;and&nbsp;Position&nbsp;is&nbsp;invalid,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4946593">//&nbsp;the&nbsp;scanner&nbsp;is&nbsp;not&nbsp;inside&nbsp;a&nbsp;token.&nbsp;Call&nbsp;Pos&nbsp;to&nbsp;obtain&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4946660">//&nbsp;position&nbsp;in&nbsp;that&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4946687">Position</span><br>
<span class="lineno">185</span><span class="op" id="4946696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4946699">//&nbsp;Init&nbsp;initializes&nbsp;a&nbsp;Scanner&nbsp;with&nbsp;a&nbsp;new&nbsp;source&nbsp;and&nbsp;returns&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="4946762">//&nbsp;Error&nbsp;is&nbsp;set&nbsp;to&nbsp;nil,&nbsp;ErrorCount&nbsp;is&nbsp;set&nbsp;to&nbsp;0,&nbsp;Mode&nbsp;is&nbsp;set&nbsp;to&nbsp;GoTokens,</span><br>
<span class="lineno"></span><span class="comment" id="4946835">//&nbsp;and&nbsp;Whitespace&nbsp;is&nbsp;set&nbsp;to&nbsp;GoWhitespace.</span><br>
<span class="lineno">190</span><span class="keyword" id="4946877">func</span>&nbsp;<span class="op" id="4946882">(</span><span class="ident" id="4946883">s</span>&nbsp;<span class="op" id="4946885">*</span><span class="ident" id="4946886">Scanner</span><span class="op" id="4946893">)</span>&nbsp;<span class="ident" id="4946895">Init</span><span class="op" id="4946899">(</span><span class="ident" id="4946900">src</span>&nbsp;<span class="ident" id="4946904">io</span><span class="op" id="4946906">.</span><span class="ident" id="4946907">Reader</span><span class="op" id="4946913">)</span>&nbsp;<span class="op" id="4946915">*</span><span class="ident" id="4946916">Scanner</span>&nbsp;<span class="op" id="4946924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4946927">s</span><span class="op" id="4946928">.</span><span class="ident" id="4946929">src</span>&nbsp;<span class="op" id="4946933">=</span>&nbsp;<span class="ident" id="4946935">src</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4946941">//&nbsp;initialize&nbsp;source&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4946970">//&nbsp;(the&nbsp;first&nbsp;call&nbsp;to&nbsp;next()&nbsp;will&nbsp;fill&nbsp;it&nbsp;by&nbsp;calling&nbsp;src.Read)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4947034">s</span><span class="op" id="4947035">.</span><span class="ident" id="4947036">srcBuf</span><span class="op" id="4947042">[</span><span class="num" id="4947043">0</span><span class="op" id="4947044">]</span>&nbsp;<span class="op" id="4947046">=</span>&nbsp;<span class="ident" id="4947048">utf8</span><span class="op" id="4947052">.</span><span class="ident" id="4947053">RuneSelf</span>&nbsp;<span class="comment" id="4947062">//&nbsp;sentinel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4947075">s</span><span class="op" id="4947076">.</span><span class="ident" id="4947077">srcPos</span>&nbsp;<span class="op" id="4947084">=</span>&nbsp;<span class="num" id="4947086">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4947089">s</span><span class="op" id="4947090">.</span><span class="ident" id="4947091">srcEnd</span>&nbsp;<span class="op" id="4947098">=</span>&nbsp;<span class="num" id="4947100">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4947104">//&nbsp;initialize&nbsp;source&nbsp;position</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4947135">s</span><span class="op" id="4947136">.</span><span class="ident" id="4947137">srcBufOffset</span>&nbsp;<span class="op" id="4947150">=</span>&nbsp;<span class="num" id="4947152">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4947155">s</span><span class="op" id="4947156">.</span><span class="ident" id="4947157">line</span>&nbsp;<span class="op" id="4947162">=</span>&nbsp;<span class="num" id="4947164">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4947167">s</span><span class="op" id="4947168">.</span><span class="ident" id="4947169">column</span>&nbsp;<span class="op" id="4947176">=</span>&nbsp;<span class="num" id="4947178">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4947181">s</span><span class="op" id="4947182">.</span><span class="ident" id="4947183">lastLineLen</span>&nbsp;<span class="op" id="4947195">=</span>&nbsp;<span class="num" id="4947197">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4947200">s</span><span class="op" id="4947201">.</span><span class="ident" id="4947202">lastCharLen</span>&nbsp;<span class="op" id="4947214">=</span>&nbsp;<span class="num" id="4947216">0</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4947220">//&nbsp;initialize&nbsp;token&nbsp;text&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4947253">//&nbsp;(required&nbsp;for&nbsp;first&nbsp;call&nbsp;to&nbsp;next()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4947294">s</span><span class="op" id="4947295">.</span><span class="ident" id="4947296">tokPos</span>&nbsp;<span class="op" id="4947303">=</span>&nbsp;<span class="op" id="4947305">-</span><span class="num" id="4947306">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4947310">//&nbsp;initialize&nbsp;one&nbsp;character&nbsp;look-ahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4947350">s</span><span class="op" id="4947351">.</span><span class="ident" id="4947352">ch</span>&nbsp;<span class="op" id="4947355">=</span>&nbsp;<span class="op" id="4947357">-</span><span class="num" id="4947358">1</span>&nbsp;<span class="comment" id="4947360">//&nbsp;no&nbsp;char&nbsp;read&nbsp;yet</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4947382">//&nbsp;initialize&nbsp;public&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4947411">s</span><span class="op" id="4947412">.</span><span class="ident" id="4947413">Error</span>&nbsp;<span class="op" id="4947419">=</span>&nbsp;<span class="ident" id="4947421">nil</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4947426">s</span><span class="op" id="4947427">.</span><span class="ident" id="4947428">ErrorCount</span>&nbsp;<span class="op" id="4947439">=</span>&nbsp;<span class="num" id="4947441">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4947444">s</span><span class="op" id="4947445">.</span><span class="ident" id="4947446">Mode</span>&nbsp;<span class="op" id="4947451">=</span>&nbsp;<span class="ident" id="4947453">GoTokens</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4947463">s</span><span class="op" id="4947464">.</span><span class="ident" id="4947465">Whitespace</span>&nbsp;<span class="op" id="4947476">=</span>&nbsp;<span class="ident" id="4947478">GoWhitespace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4947492">s</span><span class="op" id="4947493">.</span><span class="ident" id="4947494">Line</span>&nbsp;<span class="op" id="4947499">=</span>&nbsp;<span class="num" id="4947501">0</span>&nbsp;<span class="comment" id="4947503">//&nbsp;invalidate&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4947534">return</span>&nbsp;<span class="ident" id="4947541">s</span><br>
<span class="lineno"></span><span class="op" id="4947543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4947546">//&nbsp;next&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character.&nbsp;It&nbsp;is&nbsp;designed&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="4947620">//&nbsp;that&nbsp;only&nbsp;a&nbsp;minimal&nbsp;amount&nbsp;of&nbsp;work&nbsp;needs&nbsp;to&nbsp;be&nbsp;done&nbsp;in&nbsp;the&nbsp;common&nbsp;ASCII</span><br>
<span class="lineno">225</span><span class="comment" id="4947695">//&nbsp;case&nbsp;(one&nbsp;test&nbsp;to&nbsp;check&nbsp;for&nbsp;both&nbsp;ASCII&nbsp;and&nbsp;end-of-buffer,&nbsp;and&nbsp;one&nbsp;test</span><br>
<span class="lineno"></span><span class="comment" id="4947769">//&nbsp;to&nbsp;check&nbsp;for&nbsp;newlines).</span><br>
<span class="lineno"></span><span class="keyword" id="4947796">func</span>&nbsp;<span class="op" id="4947801">(</span><span class="ident" id="4947802">s</span>&nbsp;<span class="op" id="4947804">*</span><span class="ident" id="4947805">Scanner</span><span class="op" id="4947812">)</span>&nbsp;<span class="ident" id="4947814">next</span><span class="op" id="4947818">(</span><span class="op" id="4947819">)</span>&nbsp;<span class="builtintype" id="4947821">rune</span>&nbsp;<span class="op" id="4947826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4947829">ch</span><span class="op" id="4947831">,</span>&nbsp;<span class="ident" id="4947833">width</span>&nbsp;<span class="op" id="4947839">:=</span>&nbsp;<span class="builtintype" id="4947842">rune</span><span class="op" id="4947846">(</span><span class="ident" id="4947847">s</span><span class="op" id="4947848">.</span><span class="ident" id="4947849">srcBuf</span><span class="op" id="4947855">[</span><span class="ident" id="4947856">s</span><span class="op" id="4947857">.</span><span class="ident" id="4947858">srcPos</span><span class="op" id="4947864">]</span><span class="op" id="4947865">)</span><span class="op" id="4947866">,</span>&nbsp;<span class="num" id="4947868">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4947872">if</span>&nbsp;<span class="ident" id="4947875">ch</span>&nbsp;<span class="op" id="4947878">&gt;=</span>&nbsp;<span class="ident" id="4947881">utf8</span><span class="op" id="4947885">.</span><span class="ident" id="4947886">RuneSelf</span>&nbsp;<span class="op" id="4947895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4947899">//&nbsp;uncommon&nbsp;case:&nbsp;not&nbsp;ASCII&nbsp;or&nbsp;not&nbsp;enough&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4947949">for</span>&nbsp;<span class="ident" id="4947953">s</span><span class="op" id="4947954">.</span><span class="ident" id="4947955">srcPos</span><span class="op" id="4947961">+</span><span class="ident" id="4947962">utf8</span><span class="op" id="4947966">.</span><span class="ident" id="4947967">UTFMax</span>&nbsp;<span class="op" id="4947974">&gt;</span>&nbsp;<span class="ident" id="4947976">s</span><span class="op" id="4947977">.</span><span class="ident" id="4947978">srcEnd</span>&nbsp;<span class="op" id="4947985">&amp;&amp;</span>&nbsp;<span class="op" id="4947988">!</span><span class="ident" id="4947989">utf8</span><span class="op" id="4947993">.</span><span class="ident" id="4947994">FullRune</span><span class="op" id="4948002">(</span><span class="ident" id="4948003">s</span><span class="op" id="4948004">.</span><span class="ident" id="4948005">srcBuf</span><span class="op" id="4948011">[</span><span class="ident" id="4948012">s</span><span class="op" id="4948013">.</span><span class="ident" id="4948014">srcPos</span><span class="op" id="4948020">:</span><span class="ident" id="4948021">s</span><span class="op" id="4948022">.</span><span class="ident" id="4948023">srcEnd</span><span class="op" id="4948029">]</span><span class="op" id="4948030">)</span>&nbsp;<span class="op" id="4948032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4948037">//&nbsp;not&nbsp;enough&nbsp;bytes:&nbsp;read&nbsp;some&nbsp;more,&nbsp;but&nbsp;first</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4948087">//&nbsp;save&nbsp;away&nbsp;token&nbsp;text&nbsp;if&nbsp;any</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4948121">if</span>&nbsp;<span class="ident" id="4948124">s</span><span class="op" id="4948125">.</span><span class="ident" id="4948126">tokPos</span>&nbsp;<span class="op" id="4948133">&gt;=</span>&nbsp;<span class="num" id="4948136">0</span>&nbsp;<span class="op" id="4948138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4948144">s</span><span class="op" id="4948145">.</span><span class="ident" id="4948146">tokBuf</span><span class="op" id="4948152">.</span><span class="ident" id="4948153">Write</span><span class="op" id="4948158">(</span><span class="ident" id="4948159">s</span><span class="op" id="4948160">.</span><span class="ident" id="4948161">srcBuf</span><span class="op" id="4948167">[</span><span class="ident" id="4948168">s</span><span class="op" id="4948169">.</span><span class="ident" id="4948170">tokPos</span><span class="op" id="4948176">:</span><span class="ident" id="4948177">s</span><span class="op" id="4948178">.</span><span class="ident" id="4948179">srcPos</span><span class="op" id="4948185">]</span><span class="op" id="4948186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4948192">s</span><span class="op" id="4948193">.</span><span class="ident" id="4948194">tokPos</span>&nbsp;<span class="op" id="4948201">=</span>&nbsp;<span class="num" id="4948203">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4948209">//&nbsp;s.tokEnd&nbsp;is&nbsp;set&nbsp;by&nbsp;Scan()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4948241">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4948246">//&nbsp;move&nbsp;unread&nbsp;bytes&nbsp;to&nbsp;beginning&nbsp;of&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4948293">copy</span><span class="op" id="4948297">(</span><span class="ident" id="4948298">s</span><span class="op" id="4948299">.</span><span class="ident" id="4948300">srcBuf</span><span class="op" id="4948306">[</span><span class="num" id="4948307">0</span><span class="op" id="4948308">:</span><span class="op" id="4948309">]</span><span class="op" id="4948310">,</span>&nbsp;<span class="ident" id="4948312">s</span><span class="op" id="4948313">.</span><span class="ident" id="4948314">srcBuf</span><span class="op" id="4948320">[</span><span class="ident" id="4948321">s</span><span class="op" id="4948322">.</span><span class="ident" id="4948323">srcPos</span><span class="op" id="4948329">:</span><span class="ident" id="4948330">s</span><span class="op" id="4948331">.</span><span class="ident" id="4948332">srcEnd</span><span class="op" id="4948338">]</span><span class="op" id="4948339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4948344">s</span><span class="op" id="4948345">.</span><span class="ident" id="4948346">srcBufOffset</span>&nbsp;<span class="op" id="4948359">+=</span>&nbsp;<span class="ident" id="4948362">s</span><span class="op" id="4948363">.</span><span class="ident" id="4948364">srcPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4948374">//&nbsp;read&nbsp;more&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4948396">//&nbsp;(an&nbsp;io.Reader&nbsp;must&nbsp;return&nbsp;io.EOF&nbsp;when&nbsp;it&nbsp;reaches</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4948451">//&nbsp;the&nbsp;end&nbsp;of&nbsp;what&nbsp;it&nbsp;is&nbsp;reading&nbsp;-&nbsp;simply&nbsp;returning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4948506">//&nbsp;n&nbsp;==&nbsp;0&nbsp;will&nbsp;make&nbsp;this&nbsp;loop&nbsp;retry&nbsp;forever;&nbsp;but&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4948562">//&nbsp;error&nbsp;is&nbsp;in&nbsp;the&nbsp;reader&nbsp;implementation&nbsp;in&nbsp;that&nbsp;case)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4948620">i</span>&nbsp;<span class="op" id="4948622">:=</span>&nbsp;<span class="ident" id="4948625">s</span><span class="op" id="4948626">.</span><span class="ident" id="4948627">srcEnd</span>&nbsp;<span class="op" id="4948634">-</span>&nbsp;<span class="ident" id="4948636">s</span><span class="op" id="4948637">.</span><span class="ident" id="4948638">srcPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4948648">n</span><span class="op" id="4948649">,</span>&nbsp;<span class="ident" id="4948651">err</span>&nbsp;<span class="op" id="4948655">:=</span>&nbsp;<span class="ident" id="4948658">s</span><span class="op" id="4948659">.</span><span class="ident" id="4948660">src</span><span class="op" id="4948663">.</span><span class="ident" id="4948664">Read</span><span class="op" id="4948668">(</span><span class="ident" id="4948669">s</span><span class="op" id="4948670">.</span><span class="ident" id="4948671">srcBuf</span><span class="op" id="4948677">[</span><span class="ident" id="4948678">i</span><span class="op" id="4948679">:</span><span class="ident" id="4948680">bufLen</span><span class="op" id="4948686">]</span><span class="op" id="4948687">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4948692">s</span><span class="op" id="4948693">.</span><span class="ident" id="4948694">srcPos</span>&nbsp;<span class="op" id="4948701">=</span>&nbsp;<span class="num" id="4948703">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4948708">s</span><span class="op" id="4948709">.</span><span class="ident" id="4948710">srcEnd</span>&nbsp;<span class="op" id="4948717">=</span>&nbsp;<span class="ident" id="4948719">i</span>&nbsp;<span class="op" id="4948721">+</span>&nbsp;<span class="ident" id="4948723">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4948728">s</span><span class="op" id="4948729">.</span><span class="ident" id="4948730">srcBuf</span><span class="op" id="4948736">[</span><span class="ident" id="4948737">s</span><span class="op" id="4948738">.</span><span class="ident" id="4948739">srcEnd</span><span class="op" id="4948745">]</span>&nbsp;<span class="op" id="4948747">=</span>&nbsp;<span class="ident" id="4948749">utf8</span><span class="op" id="4948753">.</span><span class="ident" id="4948754">RuneSelf</span>&nbsp;<span class="comment" id="4948763">//&nbsp;sentinel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4948778">if</span>&nbsp;<span class="ident" id="4948781">err</span>&nbsp;<span class="op" id="4948785">!=</span>&nbsp;<span class="ident" id="4948788">nil</span>&nbsp;<span class="op" id="4948792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4948798">if</span>&nbsp;<span class="ident" id="4948801">err</span>&nbsp;<span class="op" id="4948805">!=</span>&nbsp;<span class="ident" id="4948808">io</span><span class="op" id="4948810">.</span><span class="ident" id="4948811">EOF</span>&nbsp;<span class="op" id="4948815">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4948822">s</span><span class="op" id="4948823">.</span><span class="builtintype" id="4948824">error</span><span class="op" id="4948829">(</span><span class="ident" id="4948830">err</span><span class="op" id="4948833">.</span><span class="ident" id="4948834">Error</span><span class="op" id="4948839">(</span><span class="op" id="4948840">)</span><span class="op" id="4948841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4948847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4948853">if</span>&nbsp;<span class="ident" id="4948856">s</span><span class="op" id="4948857">.</span><span class="ident" id="4948858">srcEnd</span>&nbsp;<span class="op" id="4948865">==</span>&nbsp;<span class="num" id="4948868">0</span>&nbsp;<span class="op" id="4948870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4948877">if</span>&nbsp;<span class="ident" id="4948880">s</span><span class="op" id="4948881">.</span><span class="ident" id="4948882">lastCharLen</span>&nbsp;<span class="op" id="4948894">&gt;</span>&nbsp;<span class="num" id="4948896">0</span>&nbsp;<span class="op" id="4948898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4948906">//&nbsp;previous&nbsp;character&nbsp;was&nbsp;not&nbsp;EOF</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4948946">s</span><span class="op" id="4948947">.</span><span class="ident" id="4948948">column</span><span class="op" id="4948954">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4948962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4948969">s</span><span class="op" id="4948970">.</span><span class="ident" id="4948971">lastCharLen</span>&nbsp;<span class="op" id="4948983">=</span>&nbsp;<span class="num" id="4948985">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4948992">return</span>&nbsp;<span class="ident" id="4948999">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4949007">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4949013">//&nbsp;If&nbsp;err&nbsp;==&nbsp;EOF,&nbsp;we&nbsp;won&#39;t&nbsp;be&nbsp;getting&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4949060">//&nbsp;bytes;&nbsp;break&nbsp;to&nbsp;avoid&nbsp;infinite&nbsp;loop.&nbsp;If</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4949107">//&nbsp;err&nbsp;is&nbsp;something&nbsp;else,&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4949154">//&nbsp;we&nbsp;can&nbsp;get&nbsp;more&nbsp;bytes;&nbsp;thus&nbsp;also&nbsp;break.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4949201">break</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4949210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4949214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4949218">//&nbsp;at&nbsp;least&nbsp;one&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4949241">ch</span>&nbsp;<span class="op" id="4949244">=</span>&nbsp;<span class="builtintype" id="4949246">rune</span><span class="op" id="4949250">(</span><span class="ident" id="4949251">s</span><span class="op" id="4949252">.</span><span class="ident" id="4949253">srcBuf</span><span class="op" id="4949259">[</span><span class="ident" id="4949260">s</span><span class="op" id="4949261">.</span><span class="ident" id="4949262">srcPos</span><span class="op" id="4949268">]</span><span class="op" id="4949269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4949273">if</span>&nbsp;<span class="ident" id="4949276">ch</span>&nbsp;<span class="op" id="4949279">&gt;=</span>&nbsp;<span class="ident" id="4949282">utf8</span><span class="op" id="4949286">.</span><span class="ident" id="4949287">RuneSelf</span>&nbsp;<span class="op" id="4949296">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4949301">//&nbsp;uncommon&nbsp;case:&nbsp;not&nbsp;ASCII</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4949332">ch</span><span class="op" id="4949334">,</span>&nbsp;<span class="ident" id="4949336">width</span>&nbsp;<span class="op" id="4949342">=</span>&nbsp;<span class="ident" id="4949344">utf8</span><span class="op" id="4949348">.</span><span class="ident" id="4949349">DecodeRune</span><span class="op" id="4949359">(</span><span class="ident" id="4949360">s</span><span class="op" id="4949361">.</span><span class="ident" id="4949362">srcBuf</span><span class="op" id="4949368">[</span><span class="ident" id="4949369">s</span><span class="op" id="4949370">.</span><span class="ident" id="4949371">srcPos</span><span class="op" id="4949377">:</span><span class="ident" id="4949378">s</span><span class="op" id="4949379">.</span><span class="ident" id="4949380">srcEnd</span><span class="op" id="4949386">]</span><span class="op" id="4949387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4949392">if</span>&nbsp;<span class="ident" id="4949395">ch</span>&nbsp;<span class="op" id="4949398">==</span>&nbsp;<span class="ident" id="4949401">utf8</span><span class="op" id="4949405">.</span><span class="ident" id="4949406">RuneError</span>&nbsp;<span class="op" id="4949416">&amp;&amp;</span>&nbsp;<span class="ident" id="4949419">width</span>&nbsp;<span class="op" id="4949425">==</span>&nbsp;<span class="num" id="4949428">1</span>&nbsp;<span class="op" id="4949430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4949436">//&nbsp;advance&nbsp;for&nbsp;correct&nbsp;error&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4949478">s</span><span class="op" id="4949479">.</span><span class="ident" id="4949480">srcPos</span>&nbsp;<span class="op" id="4949487">+=</span>&nbsp;<span class="ident" id="4949490">width</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4949500">s</span><span class="op" id="4949501">.</span><span class="ident" id="4949502">lastCharLen</span>&nbsp;<span class="op" id="4949514">=</span>&nbsp;<span class="ident" id="4949516">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4949526">s</span><span class="op" id="4949527">.</span><span class="ident" id="4949528">column</span><span class="op" id="4949534">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4949541">s</span><span class="op" id="4949542">.</span><span class="builtintype" id="4949543">error</span><span class="op" id="4949548">(</span><span class="string" id="4949549">&#34;illegal&nbsp;UTF-8&nbsp;encoding&#34;</span><span class="op" id="4949573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4949579">return</span>&nbsp;<span class="ident" id="4949586">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4949592">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4949596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4949599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4949603">//&nbsp;advance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4949615">s</span><span class="op" id="4949616">.</span><span class="ident" id="4949617">srcPos</span>&nbsp;<span class="op" id="4949624">+=</span>&nbsp;<span class="ident" id="4949627">width</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4949634">s</span><span class="op" id="4949635">.</span><span class="ident" id="4949636">lastCharLen</span>&nbsp;<span class="op" id="4949648">=</span>&nbsp;<span class="ident" id="4949650">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4949657">s</span><span class="op" id="4949658">.</span><span class="ident" id="4949659">column</span><span class="op" id="4949665">++</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4949670">//&nbsp;special&nbsp;situations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4949693">switch</span>&nbsp;<span class="ident" id="4949700">ch</span>&nbsp;<span class="op" id="4949703">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4949706">case</span>&nbsp;<span class="num" id="4949711">0</span><span class="op" id="4949712">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4949716">//&nbsp;for&nbsp;compatibility&nbsp;with&nbsp;other&nbsp;tools</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4949756">s</span><span class="op" id="4949757">.</span><span class="builtintype" id="4949758">error</span><span class="op" id="4949763">(</span><span class="string" id="4949764">&#34;illegal&nbsp;character&nbsp;NUL&#34;</span><span class="op" id="4949787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4949790">case</span>&nbsp;<span class="string" id="4949795">&#39;\n&#39;</span><span class="op" id="4949799">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4949803">s</span><span class="op" id="4949804">.</span><span class="ident" id="4949805">line</span><span class="op" id="4949809">++</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4949814">s</span><span class="op" id="4949815">.</span><span class="ident" id="4949816">lastLineLen</span>&nbsp;<span class="op" id="4949828">=</span>&nbsp;<span class="ident" id="4949830">s</span><span class="op" id="4949831">.</span><span class="ident" id="4949832">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4949841">s</span><span class="op" id="4949842">.</span><span class="ident" id="4949843">column</span>&nbsp;<span class="op" id="4949850">=</span>&nbsp;<span class="num" id="4949852">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4949855">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4949859">return</span>&nbsp;<span class="ident" id="4949866">ch</span><br>
<span class="lineno">305</span><span class="op" id="4949869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4949872">//&nbsp;Next&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="comment" id="4949926">//&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;source.&nbsp;It&nbsp;reports</span><br>
<span class="lineno"></span><span class="comment" id="4949981">//&nbsp;a&nbsp;read&nbsp;error&nbsp;by&nbsp;calling&nbsp;s.Error,&nbsp;if&nbsp;not&nbsp;nil;&nbsp;otherwise</span><br>
<span class="lineno">310</span><span class="comment" id="4950039">//&nbsp;it&nbsp;prints&nbsp;an&nbsp;error&nbsp;message&nbsp;to&nbsp;os.Stderr.&nbsp;Next&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="4950097">//&nbsp;update&nbsp;the&nbsp;Scanner&#39;s&nbsp;Position&nbsp;field;&nbsp;use&nbsp;Pos()&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4950150">//&nbsp;get&nbsp;the&nbsp;current&nbsp;position.</span><br>
<span class="lineno"></span><span class="keyword" id="4950179">func</span>&nbsp;<span class="op" id="4950184">(</span><span class="ident" id="4950185">s</span>&nbsp;<span class="op" id="4950187">*</span><span class="ident" id="4950188">Scanner</span><span class="op" id="4950195">)</span>&nbsp;<span class="ident" id="4950197">Next</span><span class="op" id="4950201">(</span><span class="op" id="4950202">)</span>&nbsp;<span class="builtintype" id="4950204">rune</span>&nbsp;<span class="op" id="4950209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4950212">s</span><span class="op" id="4950213">.</span><span class="ident" id="4950214">tokPos</span>&nbsp;<span class="op" id="4950221">=</span>&nbsp;<span class="op" id="4950223">-</span><span class="num" id="4950224">1</span>&nbsp;<span class="comment" id="4950226">//&nbsp;don&#39;t&nbsp;collect&nbsp;token&nbsp;text</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4950255">s</span><span class="op" id="4950256">.</span><span class="ident" id="4950257">Line</span>&nbsp;<span class="op" id="4950262">=</span>&nbsp;<span class="num" id="4950264">0</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4950269">//&nbsp;invalidate&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4950299">ch</span>&nbsp;<span class="op" id="4950302">:=</span>&nbsp;<span class="ident" id="4950305">s</span><span class="op" id="4950306">.</span><span class="ident" id="4950307">Peek</span><span class="op" id="4950311">(</span><span class="op" id="4950312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4950315">s</span><span class="op" id="4950316">.</span><span class="ident" id="4950317">ch</span>&nbsp;<span class="op" id="4950320">=</span>&nbsp;<span class="ident" id="4950322">s</span><span class="op" id="4950323">.</span><span class="ident" id="4950324">next</span><span class="op" id="4950328">(</span><span class="op" id="4950329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4950332">return</span>&nbsp;<span class="ident" id="4950339">ch</span><br>
<span class="lineno"></span><span class="op" id="4950342">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="4950345">//&nbsp;Peek&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character&nbsp;in&nbsp;the&nbsp;source&nbsp;without&nbsp;advancing</span><br>
<span class="lineno"></span><span class="comment" id="4950420">//&nbsp;the&nbsp;scanner.&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;if&nbsp;the&nbsp;scanner&#39;s&nbsp;position&nbsp;is&nbsp;at&nbsp;the&nbsp;last</span><br>
<span class="lineno"></span><span class="comment" id="4950492">//&nbsp;character&nbsp;of&nbsp;the&nbsp;source.</span><br>
<span class="lineno"></span><span class="keyword" id="4950520">func</span>&nbsp;<span class="op" id="4950525">(</span><span class="ident" id="4950526">s</span>&nbsp;<span class="op" id="4950528">*</span><span class="ident" id="4950529">Scanner</span><span class="op" id="4950536">)</span>&nbsp;<span class="ident" id="4950538">Peek</span><span class="op" id="4950542">(</span><span class="op" id="4950543">)</span>&nbsp;<span class="builtintype" id="4950545">rune</span>&nbsp;<span class="op" id="4950550">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4950553">if</span>&nbsp;<span class="ident" id="4950556">s</span><span class="op" id="4950557">.</span><span class="ident" id="4950558">ch</span>&nbsp;<span class="op" id="4950561">&lt;</span>&nbsp;<span class="num" id="4950563">0</span>&nbsp;<span class="op" id="4950565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4950569">//&nbsp;this&nbsp;code&nbsp;is&nbsp;only&nbsp;run&nbsp;for&nbsp;the&nbsp;very&nbsp;first&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4950625">s</span><span class="op" id="4950626">.</span><span class="ident" id="4950627">ch</span>&nbsp;<span class="op" id="4950630">=</span>&nbsp;<span class="ident" id="4950632">s</span><span class="op" id="4950633">.</span><span class="ident" id="4950634">next</span><span class="op" id="4950638">(</span><span class="op" id="4950639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4950643">if</span>&nbsp;<span class="ident" id="4950646">s</span><span class="op" id="4950647">.</span><span class="ident" id="4950648">ch</span>&nbsp;<span class="op" id="4950651">==</span>&nbsp;<span class="string" id="4950654">&#39;\uFEFF&#39;</span>&nbsp;<span class="op" id="4950663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4950668">s</span><span class="op" id="4950669">.</span><span class="ident" id="4950670">ch</span>&nbsp;<span class="op" id="4950673">=</span>&nbsp;<span class="ident" id="4950675">s</span><span class="op" id="4950676">.</span><span class="ident" id="4950677">next</span><span class="op" id="4950681">(</span><span class="op" id="4950682">)</span>&nbsp;<span class="comment" id="4950684">//&nbsp;ignore&nbsp;BOM</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4950700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4950703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4950706">return</span>&nbsp;<span class="ident" id="4950713">s</span><span class="op" id="4950714">.</span><span class="ident" id="4950715">ch</span><br>
<span class="lineno"></span><span class="op" id="4950718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="4950721">func</span>&nbsp;<span class="op" id="4950726">(</span><span class="ident" id="4950727">s</span>&nbsp;<span class="op" id="4950729">*</span><span class="ident" id="4950730">Scanner</span><span class="op" id="4950737">)</span>&nbsp;<span class="builtintype" id="4950739">error</span><span class="op" id="4950744">(</span><span class="ident" id="4950745">msg</span>&nbsp;<span class="builtintype" id="4950749">string</span><span class="op" id="4950755">)</span>&nbsp;<span class="op" id="4950757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4950760">s</span><span class="op" id="4950761">.</span><span class="ident" id="4950762">ErrorCount</span><span class="op" id="4950772">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4950776">if</span>&nbsp;<span class="ident" id="4950779">s</span><span class="op" id="4950780">.</span><span class="ident" id="4950781">Error</span>&nbsp;<span class="op" id="4950787">!=</span>&nbsp;<span class="ident" id="4950790">nil</span>&nbsp;<span class="op" id="4950794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4950798">s</span><span class="op" id="4950799">.</span><span class="ident" id="4950800">Error</span><span class="op" id="4950805">(</span><span class="ident" id="4950806">s</span><span class="op" id="4950807">,</span>&nbsp;<span class="ident" id="4950809">msg</span><span class="op" id="4950812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4950816">return</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4950824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4950827">pos</span>&nbsp;<span class="op" id="4950831">:=</span>&nbsp;<span class="ident" id="4950834">s</span><span class="op" id="4950835">.</span><span class="ident" id="4950836">Position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4950846">if</span>&nbsp;<span class="op" id="4950849">!</span><span class="ident" id="4950850">pos</span><span class="op" id="4950853">.</span><span class="ident" id="4950854">IsValid</span><span class="op" id="4950861">(</span><span class="op" id="4950862">)</span>&nbsp;<span class="op" id="4950864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4950868">pos</span>&nbsp;<span class="op" id="4950872">=</span>&nbsp;<span class="ident" id="4950874">s</span><span class="op" id="4950875">.</span><span class="ident" id="4950876">Pos</span><span class="op" id="4950879">(</span><span class="op" id="4950880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4950883">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4950886">fmt</span><span class="op" id="4950889">.</span><span class="ident" id="4950890">Fprintf</span><span class="op" id="4950897">(</span><span class="ident" id="4950898">os</span><span class="op" id="4950900">.</span><span class="ident" id="4950901">Stderr</span><span class="op" id="4950907">,</span>&nbsp;<span class="string" id="4950909">&#34;%s:&nbsp;%s\n&#34;</span><span class="op" id="4950919">,</span>&nbsp;<span class="ident" id="4950921">pos</span><span class="op" id="4950924">,</span>&nbsp;<span class="ident" id="4950926">msg</span><span class="op" id="4950929">)</span><br>
<span class="lineno"></span><span class="op" id="4950931">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4950934">func</span>&nbsp;<span class="op" id="4950939">(</span><span class="ident" id="4950940">s</span>&nbsp;<span class="op" id="4950942">*</span><span class="ident" id="4950943">Scanner</span><span class="op" id="4950950">)</span>&nbsp;<span class="ident" id="4950952">isIdentRune</span><span class="op" id="4950963">(</span><span class="ident" id="4950964">ch</span>&nbsp;<span class="builtintype" id="4950967">rune</span><span class="op" id="4950971">,</span>&nbsp;<span class="ident" id="4950973">i</span>&nbsp;<span class="builtintype" id="4950975">int</span><span class="op" id="4950978">)</span>&nbsp;<span class="builtintype" id="4950980">bool</span>&nbsp;<span class="op" id="4950985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4950988">if</span>&nbsp;<span class="ident" id="4950991">s</span><span class="op" id="4950992">.</span><span class="ident" id="4950993">IsIdentRune</span>&nbsp;<span class="op" id="4951005">!=</span>&nbsp;<span class="ident" id="4951008">nil</span>&nbsp;<span class="op" id="4951012">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4951016">return</span>&nbsp;<span class="ident" id="4951023">s</span><span class="op" id="4951024">.</span><span class="ident" id="4951025">IsIdentRune</span><span class="op" id="4951036">(</span><span class="ident" id="4951037">ch</span><span class="op" id="4951039">,</span>&nbsp;<span class="ident" id="4951041">i</span><span class="op" id="4951042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4951045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4951048">return</span>&nbsp;<span class="ident" id="4951055">ch</span>&nbsp;<span class="op" id="4951058">==</span>&nbsp;<span class="string" id="4951061">&#39;_&#39;</span>&nbsp;<span class="op" id="4951065">||</span>&nbsp;<span class="ident" id="4951068">unicode</span><span class="op" id="4951075">.</span><span class="ident" id="4951076">IsLetter</span><span class="op" id="4951084">(</span><span class="ident" id="4951085">ch</span><span class="op" id="4951087">)</span>&nbsp;<span class="op" id="4951089">||</span>&nbsp;<span class="ident" id="4951092">unicode</span><span class="op" id="4951099">.</span><span class="ident" id="4951100">IsDigit</span><span class="op" id="4951107">(</span><span class="ident" id="4951108">ch</span><span class="op" id="4951110">)</span>&nbsp;<span class="op" id="4951112">&amp;&amp;</span>&nbsp;<span class="ident" id="4951115">i</span>&nbsp;<span class="op" id="4951117">&gt;</span>&nbsp;<span class="num" id="4951119">0</span><br>
<span class="lineno"></span><span class="op" id="4951121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="keyword" id="4951124">func</span>&nbsp;<span class="op" id="4951129">(</span><span class="ident" id="4951130">s</span>&nbsp;<span class="op" id="4951132">*</span><span class="ident" id="4951133">Scanner</span><span class="op" id="4951140">)</span>&nbsp;<span class="ident" id="4951142">scanIdentifier</span><span class="op" id="4951156">(</span><span class="op" id="4951157">)</span>&nbsp;<span class="builtintype" id="4951159">rune</span>&nbsp;<span class="op" id="4951164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4951167">//&nbsp;we&nbsp;know&nbsp;the&nbsp;zero&#39;th&nbsp;rune&nbsp;is&nbsp;OK;&nbsp;start&nbsp;scanning&nbsp;at&nbsp;the&nbsp;next&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4951234">ch</span>&nbsp;<span class="op" id="4951237">:=</span>&nbsp;<span class="ident" id="4951240">s</span><span class="op" id="4951241">.</span><span class="ident" id="4951242">next</span><span class="op" id="4951246">(</span><span class="op" id="4951247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4951250">for</span>&nbsp;<span class="ident" id="4951254">i</span>&nbsp;<span class="op" id="4951256">:=</span>&nbsp;<span class="num" id="4951259">1</span><span class="op" id="4951260">;</span>&nbsp;<span class="ident" id="4951262">s</span><span class="op" id="4951263">.</span><span class="ident" id="4951264">isIdentRune</span><span class="op" id="4951275">(</span><span class="ident" id="4951276">ch</span><span class="op" id="4951278">,</span>&nbsp;<span class="ident" id="4951280">i</span><span class="op" id="4951281">)</span><span class="op" id="4951282">;</span>&nbsp;<span class="ident" id="4951284">i</span><span class="op" id="4951285">++</span>&nbsp;<span class="op" id="4951288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4951292">ch</span>&nbsp;<span class="op" id="4951295">=</span>&nbsp;<span class="ident" id="4951297">s</span><span class="op" id="4951298">.</span><span class="ident" id="4951299">next</span><span class="op" id="4951303">(</span><span class="op" id="4951304">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4951307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4951310">return</span>&nbsp;<span class="ident" id="4951317">ch</span><br>
<span class="lineno"></span><span class="op" id="4951320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4951323">func</span>&nbsp;<span class="ident" id="4951328">digitVal</span><span class="op" id="4951336">(</span><span class="ident" id="4951337">ch</span>&nbsp;<span class="builtintype" id="4951340">rune</span><span class="op" id="4951344">)</span>&nbsp;<span class="builtintype" id="4951346">int</span>&nbsp;<span class="op" id="4951350">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4951353">switch</span>&nbsp;<span class="op" id="4951360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4951363">case</span>&nbsp;<span class="string" id="4951368">&#39;0&#39;</span>&nbsp;<span class="op" id="4951372">&lt;=</span>&nbsp;<span class="ident" id="4951375">ch</span>&nbsp;<span class="op" id="4951378">&amp;&amp;</span>&nbsp;<span class="ident" id="4951381">ch</span>&nbsp;<span class="op" id="4951384">&lt;=</span>&nbsp;<span class="string" id="4951387">&#39;9&#39;</span><span class="op" id="4951390">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4951394">return</span>&nbsp;<span class="builtintype" id="4951401">int</span><span class="op" id="4951404">(</span><span class="ident" id="4951405">ch</span>&nbsp;<span class="op" id="4951408">-</span>&nbsp;<span class="string" id="4951410">&#39;0&#39;</span><span class="op" id="4951413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4951416">case</span>&nbsp;<span class="string" id="4951421">&#39;a&#39;</span>&nbsp;<span class="op" id="4951425">&lt;=</span>&nbsp;<span class="ident" id="4951428">ch</span>&nbsp;<span class="op" id="4951431">&amp;&amp;</span>&nbsp;<span class="ident" id="4951434">ch</span>&nbsp;<span class="op" id="4951437">&lt;=</span>&nbsp;<span class="string" id="4951440">&#39;f&#39;</span><span class="op" id="4951443">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4951447">return</span>&nbsp;<span class="builtintype" id="4951454">int</span><span class="op" id="4951457">(</span><span class="ident" id="4951458">ch</span>&nbsp;<span class="op" id="4951461">-</span>&nbsp;<span class="string" id="4951463">&#39;a&#39;</span>&nbsp;<span class="op" id="4951467">+</span>&nbsp;<span class="num" id="4951469">10</span><span class="op" id="4951471">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4951474">case</span>&nbsp;<span class="string" id="4951479">&#39;A&#39;</span>&nbsp;<span class="op" id="4951483">&lt;=</span>&nbsp;<span class="ident" id="4951486">ch</span>&nbsp;<span class="op" id="4951489">&amp;&amp;</span>&nbsp;<span class="ident" id="4951492">ch</span>&nbsp;<span class="op" id="4951495">&lt;=</span>&nbsp;<span class="string" id="4951498">&#39;F&#39;</span><span class="op" id="4951501">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4951505">return</span>&nbsp;<span class="builtintype" id="4951512">int</span><span class="op" id="4951515">(</span><span class="ident" id="4951516">ch</span>&nbsp;<span class="op" id="4951519">-</span>&nbsp;<span class="string" id="4951521">&#39;A&#39;</span>&nbsp;<span class="op" id="4951525">+</span>&nbsp;<span class="num" id="4951527">10</span><span class="op" id="4951529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4951532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4951535">return</span>&nbsp;<span class="num" id="4951542">16</span>&nbsp;<span class="comment" id="4951545">//&nbsp;larger&nbsp;than&nbsp;any&nbsp;legal&nbsp;digit&nbsp;val</span><br>
<span class="lineno"></span><span class="op" id="4951580">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span><span class="keyword" id="4951583">func</span>&nbsp;<span class="ident" id="4951588">isDecimal</span><span class="op" id="4951597">(</span><span class="ident" id="4951598">ch</span>&nbsp;<span class="builtintype" id="4951601">rune</span><span class="op" id="4951605">)</span>&nbsp;<span class="builtintype" id="4951607">bool</span>&nbsp;<span class="op" id="4951612">{</span>&nbsp;<span class="keyword" id="4951614">return</span>&nbsp;<span class="string" id="4951621">&#39;0&#39;</span>&nbsp;<span class="op" id="4951625">&lt;=</span>&nbsp;<span class="ident" id="4951628">ch</span>&nbsp;<span class="op" id="4951631">&amp;&amp;</span>&nbsp;<span class="ident" id="4951634">ch</span>&nbsp;<span class="op" id="4951637">&lt;=</span>&nbsp;<span class="string" id="4951640">&#39;9&#39;</span>&nbsp;<span class="op" id="4951644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4951647">func</span>&nbsp;<span class="op" id="4951652">(</span><span class="ident" id="4951653">s</span>&nbsp;<span class="op" id="4951655">*</span><span class="ident" id="4951656">Scanner</span><span class="op" id="4951663">)</span>&nbsp;<span class="ident" id="4951665">scanMantissa</span><span class="op" id="4951677">(</span><span class="ident" id="4951678">ch</span>&nbsp;<span class="builtintype" id="4951681">rune</span><span class="op" id="4951685">)</span>&nbsp;<span class="builtintype" id="4951687">rune</span>&nbsp;<span class="op" id="4951692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4951695">for</span>&nbsp;<span class="ident" id="4951699">isDecimal</span><span class="op" id="4951708">(</span><span class="ident" id="4951709">ch</span><span class="op" id="4951711">)</span>&nbsp;<span class="op" id="4951713">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4951717">ch</span>&nbsp;<span class="op" id="4951720">=</span>&nbsp;<span class="ident" id="4951722">s</span><span class="op" id="4951723">.</span><span class="ident" id="4951724">next</span><span class="op" id="4951728">(</span><span class="op" id="4951729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4951732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4951735">return</span>&nbsp;<span class="ident" id="4951742">ch</span><br>
<span class="lineno"></span><span class="op" id="4951745">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="4951748">func</span>&nbsp;<span class="op" id="4951753">(</span><span class="ident" id="4951754">s</span>&nbsp;<span class="op" id="4951756">*</span><span class="ident" id="4951757">Scanner</span><span class="op" id="4951764">)</span>&nbsp;<span class="ident" id="4951766">scanFraction</span><span class="op" id="4951778">(</span><span class="ident" id="4951779">ch</span>&nbsp;<span class="builtintype" id="4951782">rune</span><span class="op" id="4951786">)</span>&nbsp;<span class="builtintype" id="4951788">rune</span>&nbsp;<span class="op" id="4951793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4951796">if</span>&nbsp;<span class="ident" id="4951799">ch</span>&nbsp;<span class="op" id="4951802">==</span>&nbsp;<span class="string" id="4951805">&#39;.&#39;</span>&nbsp;<span class="op" id="4951809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4951813">ch</span>&nbsp;<span class="op" id="4951816">=</span>&nbsp;<span class="ident" id="4951818">s</span><span class="op" id="4951819">.</span><span class="ident" id="4951820">scanMantissa</span><span class="op" id="4951832">(</span><span class="ident" id="4951833">s</span><span class="op" id="4951834">.</span><span class="ident" id="4951835">next</span><span class="op" id="4951839">(</span><span class="op" id="4951840">)</span><span class="op" id="4951841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4951844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4951847">return</span>&nbsp;<span class="ident" id="4951854">ch</span><br>
<span class="lineno">390</span><span class="op" id="4951857">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4951860">func</span>&nbsp;<span class="op" id="4951865">(</span><span class="ident" id="4951866">s</span>&nbsp;<span class="op" id="4951868">*</span><span class="ident" id="4951869">Scanner</span><span class="op" id="4951876">)</span>&nbsp;<span class="ident" id="4951878">scanExponent</span><span class="op" id="4951890">(</span><span class="ident" id="4951891">ch</span>&nbsp;<span class="builtintype" id="4951894">rune</span><span class="op" id="4951898">)</span>&nbsp;<span class="builtintype" id="4951900">rune</span>&nbsp;<span class="op" id="4951905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4951908">if</span>&nbsp;<span class="ident" id="4951911">ch</span>&nbsp;<span class="op" id="4951914">==</span>&nbsp;<span class="string" id="4951917">&#39;e&#39;</span>&nbsp;<span class="op" id="4951921">||</span>&nbsp;<span class="ident" id="4951924">ch</span>&nbsp;<span class="op" id="4951927">==</span>&nbsp;<span class="string" id="4951930">&#39;E&#39;</span>&nbsp;<span class="op" id="4951934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4951938">ch</span>&nbsp;<span class="op" id="4951941">=</span>&nbsp;<span class="ident" id="4951943">s</span><span class="op" id="4951944">.</span><span class="ident" id="4951945">next</span><span class="op" id="4951949">(</span><span class="op" id="4951950">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4951954">if</span>&nbsp;<span class="ident" id="4951957">ch</span>&nbsp;<span class="op" id="4951960">==</span>&nbsp;<span class="string" id="4951963">&#39;-&#39;</span>&nbsp;<span class="op" id="4951967">||</span>&nbsp;<span class="ident" id="4951970">ch</span>&nbsp;<span class="op" id="4951973">==</span>&nbsp;<span class="string" id="4951976">&#39;+&#39;</span>&nbsp;<span class="op" id="4951980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4951985">ch</span>&nbsp;<span class="op" id="4951988">=</span>&nbsp;<span class="ident" id="4951990">s</span><span class="op" id="4951991">.</span><span class="ident" id="4951992">next</span><span class="op" id="4951996">(</span><span class="op" id="4951997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4952001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4952005">ch</span>&nbsp;<span class="op" id="4952008">=</span>&nbsp;<span class="ident" id="4952010">s</span><span class="op" id="4952011">.</span><span class="ident" id="4952012">scanMantissa</span><span class="op" id="4952024">(</span><span class="ident" id="4952025">ch</span><span class="op" id="4952027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4952030">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4952033">return</span>&nbsp;<span class="ident" id="4952040">ch</span><br>
<span class="lineno"></span><span class="op" id="4952043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4952046">func</span>&nbsp;<span class="op" id="4952051">(</span><span class="ident" id="4952052">s</span>&nbsp;<span class="op" id="4952054">*</span><span class="ident" id="4952055">Scanner</span><span class="op" id="4952062">)</span>&nbsp;<span class="ident" id="4952064">scanNumber</span><span class="op" id="4952074">(</span><span class="ident" id="4952075">ch</span>&nbsp;<span class="builtintype" id="4952078">rune</span><span class="op" id="4952082">)</span>&nbsp;<span class="op" id="4952084">(</span><span class="builtintype" id="4952085">rune</span><span class="op" id="4952089">,</span>&nbsp;<span class="builtintype" id="4952091">rune</span><span class="op" id="4952095">)</span>&nbsp;<span class="op" id="4952097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4952100">//&nbsp;isDecimal(ch)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4952118">if</span>&nbsp;<span class="ident" id="4952121">ch</span>&nbsp;<span class="op" id="4952124">==</span>&nbsp;<span class="string" id="4952127">&#39;0&#39;</span>&nbsp;<span class="op" id="4952131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4952135">//&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4952153">ch</span>&nbsp;<span class="op" id="4952156">=</span>&nbsp;<span class="ident" id="4952158">s</span><span class="op" id="4952159">.</span><span class="ident" id="4952160">next</span><span class="op" id="4952164">(</span><span class="op" id="4952165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4952169">if</span>&nbsp;<span class="ident" id="4952172">ch</span>&nbsp;<span class="op" id="4952175">==</span>&nbsp;<span class="string" id="4952178">&#39;x&#39;</span>&nbsp;<span class="op" id="4952182">||</span>&nbsp;<span class="ident" id="4952185">ch</span>&nbsp;<span class="op" id="4952188">==</span>&nbsp;<span class="string" id="4952191">&#39;X&#39;</span>&nbsp;<span class="op" id="4952195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4952200">//&nbsp;hexadecimal&nbsp;int</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4952222">ch</span>&nbsp;<span class="op" id="4952225">=</span>&nbsp;<span class="ident" id="4952227">s</span><span class="op" id="4952228">.</span><span class="ident" id="4952229">next</span><span class="op" id="4952233">(</span><span class="op" id="4952234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4952239">hasMantissa</span>&nbsp;<span class="op" id="4952251">:=</span>&nbsp;<span class="ident" id="4952254">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4952263">for</span>&nbsp;<span class="ident" id="4952267">digitVal</span><span class="op" id="4952275">(</span><span class="ident" id="4952276">ch</span><span class="op" id="4952278">)</span>&nbsp;<span class="op" id="4952280">&lt;</span>&nbsp;<span class="num" id="4952282">16</span>&nbsp;<span class="op" id="4952285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4952291">ch</span>&nbsp;<span class="op" id="4952294">=</span>&nbsp;<span class="ident" id="4952296">s</span><span class="op" id="4952297">.</span><span class="ident" id="4952298">next</span><span class="op" id="4952302">(</span><span class="op" id="4952303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4952309">hasMantissa</span>&nbsp;<span class="op" id="4952321">=</span>&nbsp;<span class="ident" id="4952323">true</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4952331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4952336">if</span>&nbsp;<span class="op" id="4952339">!</span><span class="ident" id="4952340">hasMantissa</span>&nbsp;<span class="op" id="4952352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4952358">s</span><span class="op" id="4952359">.</span><span class="builtintype" id="4952360">error</span><span class="op" id="4952365">(</span><span class="string" id="4952366">&#34;illegal&nbsp;hexadecimal&nbsp;number&#34;</span><span class="op" id="4952394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4952399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4952403">}</span>&nbsp;<span class="keyword" id="4952405">else</span>&nbsp;<span class="op" id="4952410">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4952415">//&nbsp;octal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4952440">has8or9</span>&nbsp;<span class="op" id="4952448">:=</span>&nbsp;<span class="ident" id="4952451">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4952460">for</span>&nbsp;<span class="ident" id="4952464">isDecimal</span><span class="op" id="4952473">(</span><span class="ident" id="4952474">ch</span><span class="op" id="4952476">)</span>&nbsp;<span class="op" id="4952478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4952484">if</span>&nbsp;<span class="ident" id="4952487">ch</span>&nbsp;<span class="op" id="4952490">&gt;</span>&nbsp;<span class="string" id="4952492">&#39;7&#39;</span>&nbsp;<span class="op" id="4952496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4952503">has8or9</span>&nbsp;<span class="op" id="4952511">=</span>&nbsp;<span class="ident" id="4952513">true</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4952522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4952528">ch</span>&nbsp;<span class="op" id="4952531">=</span>&nbsp;<span class="ident" id="4952533">s</span><span class="op" id="4952534">.</span><span class="ident" id="4952535">next</span><span class="op" id="4952539">(</span><span class="op" id="4952540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4952545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4952550">if</span>&nbsp;<span class="ident" id="4952553">s</span><span class="op" id="4952554">.</span><span class="ident" id="4952555">Mode</span><span class="op" id="4952559">&amp;</span><span class="ident" id="4952560">ScanFloats</span>&nbsp;<span class="op" id="4952571">!=</span>&nbsp;<span class="num" id="4952574">0</span>&nbsp;<span class="op" id="4952576">&amp;&amp;</span>&nbsp;<span class="op" id="4952579">(</span><span class="ident" id="4952580">ch</span>&nbsp;<span class="op" id="4952583">==</span>&nbsp;<span class="string" id="4952586">&#39;.&#39;</span>&nbsp;<span class="op" id="4952590">||</span>&nbsp;<span class="ident" id="4952593">ch</span>&nbsp;<span class="op" id="4952596">==</span>&nbsp;<span class="string" id="4952599">&#39;e&#39;</span>&nbsp;<span class="op" id="4952603">||</span>&nbsp;<span class="ident" id="4952606">ch</span>&nbsp;<span class="op" id="4952609">==</span>&nbsp;<span class="string" id="4952612">&#39;E&#39;</span><span class="op" id="4952615">)</span>&nbsp;<span class="op" id="4952617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4952623">//&nbsp;float</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4952636">ch</span>&nbsp;<span class="op" id="4952639">=</span>&nbsp;<span class="ident" id="4952641">s</span><span class="op" id="4952642">.</span><span class="ident" id="4952643">scanFraction</span><span class="op" id="4952655">(</span><span class="ident" id="4952656">ch</span><span class="op" id="4952658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4952664">ch</span>&nbsp;<span class="op" id="4952667">=</span>&nbsp;<span class="ident" id="4952669">s</span><span class="op" id="4952670">.</span><span class="ident" id="4952671">scanExponent</span><span class="op" id="4952683">(</span><span class="ident" id="4952684">ch</span><span class="op" id="4952686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4952692">return</span>&nbsp;<span class="ident" id="4952699">Float</span><span class="op" id="4952704">,</span>&nbsp;<span class="ident" id="4952706">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4952712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4952717">//&nbsp;octal&nbsp;int</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4952733">if</span>&nbsp;<span class="ident" id="4952736">has8or9</span>&nbsp;<span class="op" id="4952744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4952750">s</span><span class="op" id="4952751">.</span><span class="builtintype" id="4952752">error</span><span class="op" id="4952757">(</span><span class="string" id="4952758">&#34;illegal&nbsp;octal&nbsp;number&#34;</span><span class="op" id="4952780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4952785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4952789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4952793">return</span>&nbsp;<span class="ident" id="4952800">Int</span><span class="op" id="4952803">,</span>&nbsp;<span class="ident" id="4952805">ch</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4952809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4952812">//&nbsp;decimal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4952837">ch</span>&nbsp;<span class="op" id="4952840">=</span>&nbsp;<span class="ident" id="4952842">s</span><span class="op" id="4952843">.</span><span class="ident" id="4952844">scanMantissa</span><span class="op" id="4952856">(</span><span class="ident" id="4952857">ch</span><span class="op" id="4952859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4952862">if</span>&nbsp;<span class="ident" id="4952865">s</span><span class="op" id="4952866">.</span><span class="ident" id="4952867">Mode</span><span class="op" id="4952871">&amp;</span><span class="ident" id="4952872">ScanFloats</span>&nbsp;<span class="op" id="4952883">!=</span>&nbsp;<span class="num" id="4952886">0</span>&nbsp;<span class="op" id="4952888">&amp;&amp;</span>&nbsp;<span class="op" id="4952891">(</span><span class="ident" id="4952892">ch</span>&nbsp;<span class="op" id="4952895">==</span>&nbsp;<span class="string" id="4952898">&#39;.&#39;</span>&nbsp;<span class="op" id="4952902">||</span>&nbsp;<span class="ident" id="4952905">ch</span>&nbsp;<span class="op" id="4952908">==</span>&nbsp;<span class="string" id="4952911">&#39;e&#39;</span>&nbsp;<span class="op" id="4952915">||</span>&nbsp;<span class="ident" id="4952918">ch</span>&nbsp;<span class="op" id="4952921">==</span>&nbsp;<span class="string" id="4952924">&#39;E&#39;</span><span class="op" id="4952927">)</span>&nbsp;<span class="op" id="4952929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4952933">//&nbsp;float</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4952944">ch</span>&nbsp;<span class="op" id="4952947">=</span>&nbsp;<span class="ident" id="4952949">s</span><span class="op" id="4952950">.</span><span class="ident" id="4952951">scanFraction</span><span class="op" id="4952963">(</span><span class="ident" id="4952964">ch</span><span class="op" id="4952966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4952970">ch</span>&nbsp;<span class="op" id="4952973">=</span>&nbsp;<span class="ident" id="4952975">s</span><span class="op" id="4952976">.</span><span class="ident" id="4952977">scanExponent</span><span class="op" id="4952989">(</span><span class="ident" id="4952990">ch</span><span class="op" id="4952992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4952996">return</span>&nbsp;<span class="ident" id="4953003">Float</span><span class="op" id="4953008">,</span>&nbsp;<span class="ident" id="4953010">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4953014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4953017">return</span>&nbsp;<span class="ident" id="4953024">Int</span><span class="op" id="4953027">,</span>&nbsp;<span class="ident" id="4953029">ch</span><br>
<span class="lineno">450</span><span class="op" id="4953032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4953035">func</span>&nbsp;<span class="op" id="4953040">(</span><span class="ident" id="4953041">s</span>&nbsp;<span class="op" id="4953043">*</span><span class="ident" id="4953044">Scanner</span><span class="op" id="4953051">)</span>&nbsp;<span class="ident" id="4953053">scanDigits</span><span class="op" id="4953063">(</span><span class="ident" id="4953064">ch</span>&nbsp;<span class="builtintype" id="4953067">rune</span><span class="op" id="4953071">,</span>&nbsp;<span class="ident" id="4953073">base</span><span class="op" id="4953077">,</span>&nbsp;<span class="ident" id="4953079">n</span>&nbsp;<span class="builtintype" id="4953081">int</span><span class="op" id="4953084">)</span>&nbsp;<span class="builtintype" id="4953086">rune</span>&nbsp;<span class="op" id="4953091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4953094">for</span>&nbsp;<span class="ident" id="4953098">n</span>&nbsp;<span class="op" id="4953100">&gt;</span>&nbsp;<span class="num" id="4953102">0</span>&nbsp;<span class="op" id="4953104">&amp;&amp;</span>&nbsp;<span class="ident" id="4953107">digitVal</span><span class="op" id="4953115">(</span><span class="ident" id="4953116">ch</span><span class="op" id="4953118">)</span>&nbsp;<span class="op" id="4953120">&lt;</span>&nbsp;<span class="ident" id="4953122">base</span>&nbsp;<span class="op" id="4953127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4953131">ch</span>&nbsp;<span class="op" id="4953134">=</span>&nbsp;<span class="ident" id="4953136">s</span><span class="op" id="4953137">.</span><span class="ident" id="4953138">next</span><span class="op" id="4953142">(</span><span class="op" id="4953143">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4953147">n</span><span class="op" id="4953148">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4953152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4953155">if</span>&nbsp;<span class="ident" id="4953158">n</span>&nbsp;<span class="op" id="4953160">&gt;</span>&nbsp;<span class="num" id="4953162">0</span>&nbsp;<span class="op" id="4953164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4953168">s</span><span class="op" id="4953169">.</span><span class="builtintype" id="4953170">error</span><span class="op" id="4953175">(</span><span class="string" id="4953176">&#34;illegal&nbsp;char&nbsp;escape&#34;</span><span class="op" id="4953197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4953200">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4953203">return</span>&nbsp;<span class="ident" id="4953210">ch</span><br>
<span class="lineno"></span><span class="op" id="4953213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4953216">func</span>&nbsp;<span class="op" id="4953221">(</span><span class="ident" id="4953222">s</span>&nbsp;<span class="op" id="4953224">*</span><span class="ident" id="4953225">Scanner</span><span class="op" id="4953232">)</span>&nbsp;<span class="ident" id="4953234">scanEscape</span><span class="op" id="4953244">(</span><span class="ident" id="4953245">quote</span>&nbsp;<span class="builtintype" id="4953251">rune</span><span class="op" id="4953255">)</span>&nbsp;<span class="builtintype" id="4953257">rune</span>&nbsp;<span class="op" id="4953262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4953265">ch</span>&nbsp;<span class="op" id="4953268">:=</span>&nbsp;<span class="ident" id="4953271">s</span><span class="op" id="4953272">.</span><span class="ident" id="4953273">next</span><span class="op" id="4953277">(</span><span class="op" id="4953278">)</span>&nbsp;<span class="comment" id="4953280">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#39;/&#39;</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4953309">switch</span>&nbsp;<span class="ident" id="4953316">ch</span>&nbsp;<span class="op" id="4953319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4953322">case</span>&nbsp;<span class="string" id="4953327">&#39;a&#39;</span><span class="op" id="4953330">,</span>&nbsp;<span class="string" id="4953332">&#39;b&#39;</span><span class="op" id="4953335">,</span>&nbsp;<span class="string" id="4953337">&#39;f&#39;</span><span class="op" id="4953340">,</span>&nbsp;<span class="string" id="4953342">&#39;n&#39;</span><span class="op" id="4953345">,</span>&nbsp;<span class="string" id="4953347">&#39;r&#39;</span><span class="op" id="4953350">,</span>&nbsp;<span class="string" id="4953352">&#39;t&#39;</span><span class="op" id="4953355">,</span>&nbsp;<span class="string" id="4953357">&#39;v&#39;</span><span class="op" id="4953360">,</span>&nbsp;<span class="string" id="4953362">&#39;\\&#39;</span><span class="op" id="4953366">,</span>&nbsp;<span class="ident" id="4953368">quote</span><span class="op" id="4953373">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4953377">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4953396">ch</span>&nbsp;<span class="op" id="4953399">=</span>&nbsp;<span class="ident" id="4953401">s</span><span class="op" id="4953402">.</span><span class="ident" id="4953403">next</span><span class="op" id="4953407">(</span><span class="op" id="4953408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4953411">case</span>&nbsp;<span class="string" id="4953416">&#39;0&#39;</span><span class="op" id="4953419">,</span>&nbsp;<span class="string" id="4953421">&#39;1&#39;</span><span class="op" id="4953424">,</span>&nbsp;<span class="string" id="4953426">&#39;2&#39;</span><span class="op" id="4953429">,</span>&nbsp;<span class="string" id="4953431">&#39;3&#39;</span><span class="op" id="4953434">,</span>&nbsp;<span class="string" id="4953436">&#39;4&#39;</span><span class="op" id="4953439">,</span>&nbsp;<span class="string" id="4953441">&#39;5&#39;</span><span class="op" id="4953444">,</span>&nbsp;<span class="string" id="4953446">&#39;6&#39;</span><span class="op" id="4953449">,</span>&nbsp;<span class="string" id="4953451">&#39;7&#39;</span><span class="op" id="4953454">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4953458">ch</span>&nbsp;<span class="op" id="4953461">=</span>&nbsp;<span class="ident" id="4953463">s</span><span class="op" id="4953464">.</span><span class="ident" id="4953465">scanDigits</span><span class="op" id="4953475">(</span><span class="ident" id="4953476">ch</span><span class="op" id="4953478">,</span>&nbsp;<span class="num" id="4953480">8</span><span class="op" id="4953481">,</span>&nbsp;<span class="num" id="4953483">3</span><span class="op" id="4953484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4953487">case</span>&nbsp;<span class="string" id="4953492">&#39;x&#39;</span><span class="op" id="4953495">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4953499">ch</span>&nbsp;<span class="op" id="4953502">=</span>&nbsp;<span class="ident" id="4953504">s</span><span class="op" id="4953505">.</span><span class="ident" id="4953506">scanDigits</span><span class="op" id="4953516">(</span><span class="ident" id="4953517">s</span><span class="op" id="4953518">.</span><span class="ident" id="4953519">next</span><span class="op" id="4953523">(</span><span class="op" id="4953524">)</span><span class="op" id="4953525">,</span>&nbsp;<span class="num" id="4953527">16</span><span class="op" id="4953529">,</span>&nbsp;<span class="num" id="4953531">2</span><span class="op" id="4953532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4953535">case</span>&nbsp;<span class="string" id="4953540">&#39;u&#39;</span><span class="op" id="4953543">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4953547">ch</span>&nbsp;<span class="op" id="4953550">=</span>&nbsp;<span class="ident" id="4953552">s</span><span class="op" id="4953553">.</span><span class="ident" id="4953554">scanDigits</span><span class="op" id="4953564">(</span><span class="ident" id="4953565">s</span><span class="op" id="4953566">.</span><span class="ident" id="4953567">next</span><span class="op" id="4953571">(</span><span class="op" id="4953572">)</span><span class="op" id="4953573">,</span>&nbsp;<span class="num" id="4953575">16</span><span class="op" id="4953577">,</span>&nbsp;<span class="num" id="4953579">4</span><span class="op" id="4953580">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4953583">case</span>&nbsp;<span class="string" id="4953588">&#39;U&#39;</span><span class="op" id="4953591">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4953595">ch</span>&nbsp;<span class="op" id="4953598">=</span>&nbsp;<span class="ident" id="4953600">s</span><span class="op" id="4953601">.</span><span class="ident" id="4953602">scanDigits</span><span class="op" id="4953612">(</span><span class="ident" id="4953613">s</span><span class="op" id="4953614">.</span><span class="ident" id="4953615">next</span><span class="op" id="4953619">(</span><span class="op" id="4953620">)</span><span class="op" id="4953621">,</span>&nbsp;<span class="num" id="4953623">16</span><span class="op" id="4953625">,</span>&nbsp;<span class="num" id="4953627">8</span><span class="op" id="4953628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4953631">default</span><span class="op" id="4953638">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4953642">s</span><span class="op" id="4953643">.</span><span class="builtintype" id="4953644">error</span><span class="op" id="4953649">(</span><span class="string" id="4953650">&#34;illegal&nbsp;char&nbsp;escape&#34;</span><span class="op" id="4953671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4953674">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4953677">return</span>&nbsp;<span class="ident" id="4953684">ch</span><br>
<span class="lineno"></span><span class="op" id="4953687">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4953690">func</span>&nbsp;<span class="op" id="4953695">(</span><span class="ident" id="4953696">s</span>&nbsp;<span class="op" id="4953698">*</span><span class="ident" id="4953699">Scanner</span><span class="op" id="4953706">)</span>&nbsp;<span class="ident" id="4953708">scanString</span><span class="op" id="4953718">(</span><span class="ident" id="4953719">quote</span>&nbsp;<span class="builtintype" id="4953725">rune</span><span class="op" id="4953729">)</span>&nbsp;<span class="op" id="4953731">(</span><span class="ident" id="4953732">n</span>&nbsp;<span class="builtintype" id="4953734">int</span><span class="op" id="4953737">)</span>&nbsp;<span class="op" id="4953739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4953742">ch</span>&nbsp;<span class="op" id="4953745">:=</span>&nbsp;<span class="ident" id="4953748">s</span><span class="op" id="4953749">.</span><span class="ident" id="4953750">next</span><span class="op" id="4953754">(</span><span class="op" id="4953755">)</span>&nbsp;<span class="comment" id="4953757">//&nbsp;read&nbsp;character&nbsp;after&nbsp;quote</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4953788">for</span>&nbsp;<span class="ident" id="4953792">ch</span>&nbsp;<span class="op" id="4953795">!=</span>&nbsp;<span class="ident" id="4953798">quote</span>&nbsp;<span class="op" id="4953804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4953808">if</span>&nbsp;<span class="ident" id="4953811">ch</span>&nbsp;<span class="op" id="4953814">==</span>&nbsp;<span class="string" id="4953817">&#39;\n&#39;</span>&nbsp;<span class="op" id="4953822">||</span>&nbsp;<span class="ident" id="4953825">ch</span>&nbsp;<span class="op" id="4953828">&lt;</span>&nbsp;<span class="num" id="4953830">0</span>&nbsp;<span class="op" id="4953832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4953837">s</span><span class="op" id="4953838">.</span><span class="builtintype" id="4953839">error</span><span class="op" id="4953844">(</span><span class="string" id="4953845">&#34;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="4953869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4953874">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4953883">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4953887">if</span>&nbsp;<span class="ident" id="4953890">ch</span>&nbsp;<span class="op" id="4953893">==</span>&nbsp;<span class="string" id="4953896">&#39;\\&#39;</span>&nbsp;<span class="op" id="4953901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4953906">ch</span>&nbsp;<span class="op" id="4953909">=</span>&nbsp;<span class="ident" id="4953911">s</span><span class="op" id="4953912">.</span><span class="ident" id="4953913">scanEscape</span><span class="op" id="4953923">(</span><span class="ident" id="4953924">quote</span><span class="op" id="4953929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4953933">}</span>&nbsp;<span class="keyword" id="4953935">else</span>&nbsp;<span class="op" id="4953940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4953945">ch</span>&nbsp;<span class="op" id="4953948">=</span>&nbsp;<span class="ident" id="4953950">s</span><span class="op" id="4953951">.</span><span class="ident" id="4953952">next</span><span class="op" id="4953956">(</span><span class="op" id="4953957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4953961">}</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4953965">n</span><span class="op" id="4953966">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4953970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4953973">return</span><br>
<span class="lineno"></span><span class="op" id="4953980">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span><span class="keyword" id="4953983">func</span>&nbsp;<span class="op" id="4953988">(</span><span class="ident" id="4953989">s</span>&nbsp;<span class="op" id="4953991">*</span><span class="ident" id="4953992">Scanner</span><span class="op" id="4953999">)</span>&nbsp;<span class="ident" id="4954001">scanRawString</span><span class="op" id="4954014">(</span><span class="op" id="4954015">)</span>&nbsp;<span class="op" id="4954017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4954020">ch</span>&nbsp;<span class="op" id="4954023">:=</span>&nbsp;<span class="ident" id="4954026">s</span><span class="op" id="4954027">.</span><span class="ident" id="4954028">next</span><span class="op" id="4954032">(</span><span class="op" id="4954033">)</span>&nbsp;<span class="comment" id="4954035">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#39;`&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4954064">for</span>&nbsp;<span class="ident" id="4954068">ch</span>&nbsp;<span class="op" id="4954071">!=</span>&nbsp;<span class="string" id="4954074">&#39;`&#39;</span>&nbsp;<span class="op" id="4954078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4954082">if</span>&nbsp;<span class="ident" id="4954085">ch</span>&nbsp;<span class="op" id="4954088">&lt;</span>&nbsp;<span class="num" id="4954090">0</span>&nbsp;<span class="op" id="4954092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4954097">s</span><span class="op" id="4954098">.</span><span class="builtintype" id="4954099">error</span><span class="op" id="4954104">(</span><span class="string" id="4954105">&#34;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="4954129">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4954134">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4954143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4954147">ch</span>&nbsp;<span class="op" id="4954150">=</span>&nbsp;<span class="ident" id="4954152">s</span><span class="op" id="4954153">.</span><span class="ident" id="4954154">next</span><span class="op" id="4954158">(</span><span class="op" id="4954159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4954162">}</span><br>
<span class="lineno"></span><span class="op" id="4954164">}</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span><span class="keyword" id="4954167">func</span>&nbsp;<span class="op" id="4954172">(</span><span class="ident" id="4954173">s</span>&nbsp;<span class="op" id="4954175">*</span><span class="ident" id="4954176">Scanner</span><span class="op" id="4954183">)</span>&nbsp;<span class="ident" id="4954185">scanChar</span><span class="op" id="4954193">(</span><span class="op" id="4954194">)</span>&nbsp;<span class="op" id="4954196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4954199">if</span>&nbsp;<span class="ident" id="4954202">s</span><span class="op" id="4954203">.</span><span class="ident" id="4954204">scanString</span><span class="op" id="4954214">(</span><span class="string" id="4954215">&#39;\&#39;&#39;</span><span class="op" id="4954219">)</span>&nbsp;<span class="op" id="4954221">!=</span>&nbsp;<span class="num" id="4954224">1</span>&nbsp;<span class="op" id="4954226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4954230">s</span><span class="op" id="4954231">.</span><span class="builtintype" id="4954232">error</span><span class="op" id="4954237">(</span><span class="string" id="4954238">&#34;illegal&nbsp;char&nbsp;literal&#34;</span><span class="op" id="4954260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4954263">}</span><br>
<span class="lineno">515</span><span class="op" id="4954265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4954268">func</span>&nbsp;<span class="op" id="4954273">(</span><span class="ident" id="4954274">s</span>&nbsp;<span class="op" id="4954276">*</span><span class="ident" id="4954277">Scanner</span><span class="op" id="4954284">)</span>&nbsp;<span class="ident" id="4954286">scanComment</span><span class="op" id="4954297">(</span><span class="ident" id="4954298">ch</span>&nbsp;<span class="builtintype" id="4954301">rune</span><span class="op" id="4954305">)</span>&nbsp;<span class="builtintype" id="4954307">rune</span>&nbsp;<span class="op" id="4954312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4954315">//&nbsp;ch&nbsp;==&nbsp;&#39;/&#39;&nbsp;||&nbsp;ch&nbsp;==&nbsp;&#39;*&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4954342">if</span>&nbsp;<span class="ident" id="4954345">ch</span>&nbsp;<span class="op" id="4954348">==</span>&nbsp;<span class="string" id="4954351">&#39;/&#39;</span>&nbsp;<span class="op" id="4954355">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4954359">//&nbsp;line&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4954377">ch</span>&nbsp;<span class="op" id="4954380">=</span>&nbsp;<span class="ident" id="4954382">s</span><span class="op" id="4954383">.</span><span class="ident" id="4954384">next</span><span class="op" id="4954388">(</span><span class="op" id="4954389">)</span>&nbsp;<span class="comment" id="4954391">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#34;//&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4954422">for</span>&nbsp;<span class="ident" id="4954426">ch</span>&nbsp;<span class="op" id="4954429">!=</span>&nbsp;<span class="string" id="4954432">&#39;\n&#39;</span>&nbsp;<span class="op" id="4954437">&amp;&amp;</span>&nbsp;<span class="ident" id="4954440">ch</span>&nbsp;<span class="op" id="4954443">&gt;=</span>&nbsp;<span class="num" id="4954446">0</span>&nbsp;<span class="op" id="4954448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4954453">ch</span>&nbsp;<span class="op" id="4954456">=</span>&nbsp;<span class="ident" id="4954458">s</span><span class="op" id="4954459">.</span><span class="ident" id="4954460">next</span><span class="op" id="4954464">(</span><span class="op" id="4954465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4954469">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4954473">return</span>&nbsp;<span class="ident" id="4954480">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4954484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4954488">//&nbsp;general&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4954508">ch</span>&nbsp;<span class="op" id="4954511">=</span>&nbsp;<span class="ident" id="4954513">s</span><span class="op" id="4954514">.</span><span class="ident" id="4954515">next</span><span class="op" id="4954519">(</span><span class="op" id="4954520">)</span>&nbsp;<span class="comment" id="4954522">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#34;/*&#34;</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4954552">for</span>&nbsp;<span class="op" id="4954556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4954560">if</span>&nbsp;<span class="ident" id="4954563">ch</span>&nbsp;<span class="op" id="4954566">&lt;</span>&nbsp;<span class="num" id="4954568">0</span>&nbsp;<span class="op" id="4954570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4954575">s</span><span class="op" id="4954576">.</span><span class="builtintype" id="4954577">error</span><span class="op" id="4954582">(</span><span class="string" id="4954583">&#34;comment&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="4954607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4954612">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4954620">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4954624">ch0</span>&nbsp;<span class="op" id="4954628">:=</span>&nbsp;<span class="ident" id="4954631">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4954636">ch</span>&nbsp;<span class="op" id="4954639">=</span>&nbsp;<span class="ident" id="4954641">s</span><span class="op" id="4954642">.</span><span class="ident" id="4954643">next</span><span class="op" id="4954647">(</span><span class="op" id="4954648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4954652">if</span>&nbsp;<span class="ident" id="4954655">ch0</span>&nbsp;<span class="op" id="4954659">==</span>&nbsp;<span class="string" id="4954662">&#39;*&#39;</span>&nbsp;<span class="op" id="4954666">&amp;&amp;</span>&nbsp;<span class="ident" id="4954669">ch</span>&nbsp;<span class="op" id="4954672">==</span>&nbsp;<span class="string" id="4954675">&#39;/&#39;</span>&nbsp;<span class="op" id="4954679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4954684">ch</span>&nbsp;<span class="op" id="4954687">=</span>&nbsp;<span class="ident" id="4954689">s</span><span class="op" id="4954690">.</span><span class="ident" id="4954691">next</span><span class="op" id="4954695">(</span><span class="op" id="4954696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4954701">break</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4954709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4954712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4954715">return</span>&nbsp;<span class="ident" id="4954722">ch</span><br>
<span class="lineno"></span><span class="op" id="4954725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span><span class="comment" id="4954728">//&nbsp;Scan&nbsp;reads&nbsp;the&nbsp;next&nbsp;token&nbsp;or&nbsp;Unicode&nbsp;character&nbsp;from&nbsp;source&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="4954806">//&nbsp;It&nbsp;only&nbsp;recognizes&nbsp;tokens&nbsp;t&nbsp;for&nbsp;which&nbsp;the&nbsp;respective&nbsp;Mode&nbsp;bit&nbsp;(1&lt;&lt;-t)&nbsp;is&nbsp;set.</span><br>
<span class="lineno"></span><span class="comment" id="4954887">//&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;source.&nbsp;It&nbsp;reports&nbsp;scanner&nbsp;errors&nbsp;(read&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4954967">//&nbsp;token&nbsp;errors)&nbsp;by&nbsp;calling&nbsp;s.Error,&nbsp;if&nbsp;not&nbsp;nil;&nbsp;otherwise&nbsp;it&nbsp;prints&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="4955045">//&nbsp;message&nbsp;to&nbsp;os.Stderr.</span><br>
<span class="lineno">550</span><span class="keyword" id="4955070">func</span>&nbsp;<span class="op" id="4955075">(</span><span class="ident" id="4955076">s</span>&nbsp;<span class="op" id="4955078">*</span><span class="ident" id="4955079">Scanner</span><span class="op" id="4955086">)</span>&nbsp;<span class="ident" id="4955088">Scan</span><span class="op" id="4955092">(</span><span class="op" id="4955093">)</span>&nbsp;<span class="builtintype" id="4955095">rune</span>&nbsp;<span class="op" id="4955100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4955103">ch</span>&nbsp;<span class="op" id="4955106">:=</span>&nbsp;<span class="ident" id="4955109">s</span><span class="op" id="4955110">.</span><span class="ident" id="4955111">Peek</span><span class="op" id="4955115">(</span><span class="op" id="4955116">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4955120">//&nbsp;reset&nbsp;token&nbsp;text&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4955150">s</span><span class="op" id="4955151">.</span><span class="ident" id="4955152">tokPos</span>&nbsp;<span class="op" id="4955159">=</span>&nbsp;<span class="op" id="4955161">-</span><span class="num" id="4955162">1</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4955165">s</span><span class="op" id="4955166">.</span><span class="ident" id="4955167">Line</span>&nbsp;<span class="op" id="4955172">=</span>&nbsp;<span class="num" id="4955174">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="4955177">redo</span><span class="op" id="4955181">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4955184">//&nbsp;skip&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4955205">for</span>&nbsp;<span class="ident" id="4955209">s</span><span class="op" id="4955210">.</span><span class="ident" id="4955211">Whitespace</span><span class="op" id="4955221">&amp;</span><span class="op" id="4955222">(</span><span class="num" id="4955223">1</span><span class="op" id="4955224">&lt;&lt;</span><span class="builtintype" id="4955226">uint</span><span class="op" id="4955230">(</span><span class="ident" id="4955231">ch</span><span class="op" id="4955233">)</span><span class="op" id="4955234">)</span>&nbsp;<span class="op" id="4955236">!=</span>&nbsp;<span class="num" id="4955239">0</span>&nbsp;<span class="op" id="4955241">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4955245">ch</span>&nbsp;<span class="op" id="4955248">=</span>&nbsp;<span class="ident" id="4955250">s</span><span class="op" id="4955251">.</span><span class="ident" id="4955252">next</span><span class="op" id="4955256">(</span><span class="op" id="4955257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4955260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4955264">//&nbsp;start&nbsp;collecting&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4955296">s</span><span class="op" id="4955297">.</span><span class="ident" id="4955298">tokBuf</span><span class="op" id="4955304">.</span><span class="ident" id="4955305">Reset</span><span class="op" id="4955310">(</span><span class="op" id="4955311">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4955314">s</span><span class="op" id="4955315">.</span><span class="ident" id="4955316">tokPos</span>&nbsp;<span class="op" id="4955323">=</span>&nbsp;<span class="ident" id="4955325">s</span><span class="op" id="4955326">.</span><span class="ident" id="4955327">srcPos</span>&nbsp;<span class="op" id="4955334">-</span>&nbsp;<span class="ident" id="4955336">s</span><span class="op" id="4955337">.</span><span class="ident" id="4955338">lastCharLen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4955352">//&nbsp;set&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4955375">//&nbsp;(this&nbsp;is&nbsp;a&nbsp;slightly&nbsp;optimized&nbsp;version&nbsp;of&nbsp;the&nbsp;code&nbsp;in&nbsp;Pos())</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4955439">s</span><span class="op" id="4955440">.</span><span class="ident" id="4955441">Offset</span>&nbsp;<span class="op" id="4955448">=</span>&nbsp;<span class="ident" id="4955450">s</span><span class="op" id="4955451">.</span><span class="ident" id="4955452">srcBufOffset</span>&nbsp;<span class="op" id="4955465">+</span>&nbsp;<span class="ident" id="4955467">s</span><span class="op" id="4955468">.</span><span class="ident" id="4955469">tokPos</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4955477">if</span>&nbsp;<span class="ident" id="4955480">s</span><span class="op" id="4955481">.</span><span class="ident" id="4955482">column</span>&nbsp;<span class="op" id="4955489">&gt;</span>&nbsp;<span class="num" id="4955491">0</span>&nbsp;<span class="op" id="4955493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4955497">//&nbsp;common&nbsp;case:&nbsp;last&nbsp;character&nbsp;was&nbsp;not&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4955545">s</span><span class="op" id="4955546">.</span><span class="ident" id="4955547">Line</span>&nbsp;<span class="op" id="4955552">=</span>&nbsp;<span class="ident" id="4955554">s</span><span class="op" id="4955555">.</span><span class="ident" id="4955556">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4955563">s</span><span class="op" id="4955564">.</span><span class="ident" id="4955565">Column</span>&nbsp;<span class="op" id="4955572">=</span>&nbsp;<span class="ident" id="4955574">s</span><span class="op" id="4955575">.</span><span class="ident" id="4955576">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4955584">}</span>&nbsp;<span class="keyword" id="4955586">else</span>&nbsp;<span class="op" id="4955591">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4955595">//&nbsp;last&nbsp;character&nbsp;was&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4955626">//&nbsp;(we&nbsp;cannot&nbsp;be&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4955676">//&nbsp;since&nbsp;we&nbsp;have&nbsp;called&nbsp;next()&nbsp;at&nbsp;least&nbsp;once)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4955724">s</span><span class="op" id="4955725">.</span><span class="ident" id="4955726">Line</span>&nbsp;<span class="op" id="4955731">=</span>&nbsp;<span class="ident" id="4955733">s</span><span class="op" id="4955734">.</span><span class="ident" id="4955735">line</span>&nbsp;<span class="op" id="4955740">-</span>&nbsp;<span class="num" id="4955742">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4955746">s</span><span class="op" id="4955747">.</span><span class="ident" id="4955748">Column</span>&nbsp;<span class="op" id="4955755">=</span>&nbsp;<span class="ident" id="4955757">s</span><span class="op" id="4955758">.</span><span class="ident" id="4955759">lastLineLen</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4955772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4955776">//&nbsp;determine&nbsp;token&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4955802">tok</span>&nbsp;<span class="op" id="4955806">:=</span>&nbsp;<span class="ident" id="4955809">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4955813">switch</span>&nbsp;<span class="op" id="4955820">{</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4955823">case</span>&nbsp;<span class="ident" id="4955828">s</span><span class="op" id="4955829">.</span><span class="ident" id="4955830">isIdentRune</span><span class="op" id="4955841">(</span><span class="ident" id="4955842">ch</span><span class="op" id="4955844">,</span>&nbsp;<span class="num" id="4955846">0</span><span class="op" id="4955847">)</span><span class="op" id="4955848">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4955852">if</span>&nbsp;<span class="ident" id="4955855">s</span><span class="op" id="4955856">.</span><span class="ident" id="4955857">Mode</span><span class="op" id="4955861">&amp;</span><span class="ident" id="4955862">ScanIdents</span>&nbsp;<span class="op" id="4955873">!=</span>&nbsp;<span class="num" id="4955876">0</span>&nbsp;<span class="op" id="4955878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4955883">tok</span>&nbsp;<span class="op" id="4955887">=</span>&nbsp;<span class="ident" id="4955889">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4955898">ch</span>&nbsp;<span class="op" id="4955901">=</span>&nbsp;<span class="ident" id="4955903">s</span><span class="op" id="4955904">.</span><span class="ident" id="4955905">scanIdentifier</span><span class="op" id="4955919">(</span><span class="op" id="4955920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4955924">}</span>&nbsp;<span class="keyword" id="4955926">else</span>&nbsp;<span class="op" id="4955931">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4955936">ch</span>&nbsp;<span class="op" id="4955939">=</span>&nbsp;<span class="ident" id="4955941">s</span><span class="op" id="4955942">.</span><span class="ident" id="4955943">next</span><span class="op" id="4955947">(</span><span class="op" id="4955948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4955952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4955955">case</span>&nbsp;<span class="ident" id="4955960">isDecimal</span><span class="op" id="4955969">(</span><span class="ident" id="4955970">ch</span><span class="op" id="4955972">)</span><span class="op" id="4955973">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4955977">if</span>&nbsp;<span class="ident" id="4955980">s</span><span class="op" id="4955981">.</span><span class="ident" id="4955982">Mode</span><span class="op" id="4955986">&amp;</span><span class="op" id="4955987">(</span><span class="ident" id="4955988">ScanInts</span><span class="op" id="4955996">|</span><span class="ident" id="4955997">ScanFloats</span><span class="op" id="4956007">)</span>&nbsp;<span class="op" id="4956009">!=</span>&nbsp;<span class="num" id="4956012">0</span>&nbsp;<span class="op" id="4956014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4956019">tok</span><span class="op" id="4956022">,</span>&nbsp;<span class="ident" id="4956024">ch</span>&nbsp;<span class="op" id="4956027">=</span>&nbsp;<span class="ident" id="4956029">s</span><span class="op" id="4956030">.</span><span class="ident" id="4956031">scanNumber</span><span class="op" id="4956041">(</span><span class="ident" id="4956042">ch</span><span class="op" id="4956044">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4956048">}</span>&nbsp;<span class="keyword" id="4956050">else</span>&nbsp;<span class="op" id="4956055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4956060">ch</span>&nbsp;<span class="op" id="4956063">=</span>&nbsp;<span class="ident" id="4956065">s</span><span class="op" id="4956066">.</span><span class="ident" id="4956067">next</span><span class="op" id="4956071">(</span><span class="op" id="4956072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4956076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4956079">default</span><span class="op" id="4956086">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4956090">switch</span>&nbsp;<span class="ident" id="4956097">ch</span>&nbsp;<span class="op" id="4956100">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4956104">case</span>&nbsp;<span class="string" id="4956109">&#39;&#34;&#39;</span><span class="op" id="4956112">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4956117">if</span>&nbsp;<span class="ident" id="4956120">s</span><span class="op" id="4956121">.</span><span class="ident" id="4956122">Mode</span><span class="op" id="4956126">&amp;</span><span class="ident" id="4956127">ScanStrings</span>&nbsp;<span class="op" id="4956139">!=</span>&nbsp;<span class="num" id="4956142">0</span>&nbsp;<span class="op" id="4956144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4956150">s</span><span class="op" id="4956151">.</span><span class="ident" id="4956152">scanString</span><span class="op" id="4956162">(</span><span class="string" id="4956163">&#39;&#34;&#39;</span><span class="op" id="4956166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4956172">tok</span>&nbsp;<span class="op" id="4956176">=</span>&nbsp;<span class="ident" id="4956178">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4956188">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4956193">ch</span>&nbsp;<span class="op" id="4956196">=</span>&nbsp;<span class="ident" id="4956198">s</span><span class="op" id="4956199">.</span><span class="ident" id="4956200">next</span><span class="op" id="4956204">(</span><span class="op" id="4956205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4956209">case</span>&nbsp;<span class="string" id="4956214">&#39;\&#39;&#39;</span><span class="op" id="4956218">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4956223">if</span>&nbsp;<span class="ident" id="4956226">s</span><span class="op" id="4956227">.</span><span class="ident" id="4956228">Mode</span><span class="op" id="4956232">&amp;</span><span class="ident" id="4956233">ScanChars</span>&nbsp;<span class="op" id="4956243">!=</span>&nbsp;<span class="num" id="4956246">0</span>&nbsp;<span class="op" id="4956248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4956254">s</span><span class="op" id="4956255">.</span><span class="ident" id="4956256">scanChar</span><span class="op" id="4956264">(</span><span class="op" id="4956265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4956271">tok</span>&nbsp;<span class="op" id="4956275">=</span>&nbsp;<span class="ident" id="4956277">Char</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4956285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4956290">ch</span>&nbsp;<span class="op" id="4956293">=</span>&nbsp;<span class="ident" id="4956295">s</span><span class="op" id="4956296">.</span><span class="ident" id="4956297">next</span><span class="op" id="4956301">(</span><span class="op" id="4956302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4956306">case</span>&nbsp;<span class="string" id="4956311">&#39;.&#39;</span><span class="op" id="4956314">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4956319">ch</span>&nbsp;<span class="op" id="4956322">=</span>&nbsp;<span class="ident" id="4956324">s</span><span class="op" id="4956325">.</span><span class="ident" id="4956326">next</span><span class="op" id="4956330">(</span><span class="op" id="4956331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4956336">if</span>&nbsp;<span class="ident" id="4956339">isDecimal</span><span class="op" id="4956348">(</span><span class="ident" id="4956349">ch</span><span class="op" id="4956351">)</span>&nbsp;<span class="op" id="4956353">&amp;&amp;</span>&nbsp;<span class="ident" id="4956356">s</span><span class="op" id="4956357">.</span><span class="ident" id="4956358">Mode</span><span class="op" id="4956362">&amp;</span><span class="ident" id="4956363">ScanFloats</span>&nbsp;<span class="op" id="4956374">!=</span>&nbsp;<span class="num" id="4956377">0</span>&nbsp;<span class="op" id="4956379">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4956385">tok</span>&nbsp;<span class="op" id="4956389">=</span>&nbsp;<span class="ident" id="4956391">Float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4956401">ch</span>&nbsp;<span class="op" id="4956404">=</span>&nbsp;<span class="ident" id="4956406">s</span><span class="op" id="4956407">.</span><span class="ident" id="4956408">scanMantissa</span><span class="op" id="4956420">(</span><span class="ident" id="4956421">ch</span><span class="op" id="4956423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4956429">ch</span>&nbsp;<span class="op" id="4956432">=</span>&nbsp;<span class="ident" id="4956434">s</span><span class="op" id="4956435">.</span><span class="ident" id="4956436">scanExponent</span><span class="op" id="4956448">(</span><span class="ident" id="4956449">ch</span><span class="op" id="4956451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4956456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4956460">case</span>&nbsp;<span class="string" id="4956465">&#39;/&#39;</span><span class="op" id="4956468">:</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4956473">ch</span>&nbsp;<span class="op" id="4956476">=</span>&nbsp;<span class="ident" id="4956478">s</span><span class="op" id="4956479">.</span><span class="ident" id="4956480">next</span><span class="op" id="4956484">(</span><span class="op" id="4956485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4956490">if</span>&nbsp;<span class="op" id="4956493">(</span><span class="ident" id="4956494">ch</span>&nbsp;<span class="op" id="4956497">==</span>&nbsp;<span class="string" id="4956500">&#39;/&#39;</span>&nbsp;<span class="op" id="4956504">||</span>&nbsp;<span class="ident" id="4956507">ch</span>&nbsp;<span class="op" id="4956510">==</span>&nbsp;<span class="string" id="4956513">&#39;*&#39;</span><span class="op" id="4956516">)</span>&nbsp;<span class="op" id="4956518">&amp;&amp;</span>&nbsp;<span class="ident" id="4956521">s</span><span class="op" id="4956522">.</span><span class="ident" id="4956523">Mode</span><span class="op" id="4956527">&amp;</span><span class="ident" id="4956528">ScanComments</span>&nbsp;<span class="op" id="4956541">!=</span>&nbsp;<span class="num" id="4956544">0</span>&nbsp;<span class="op" id="4956546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4956552">if</span>&nbsp;<span class="ident" id="4956555">s</span><span class="op" id="4956556">.</span><span class="ident" id="4956557">Mode</span><span class="op" id="4956561">&amp;</span><span class="ident" id="4956562">SkipComments</span>&nbsp;<span class="op" id="4956575">!=</span>&nbsp;<span class="num" id="4956578">0</span>&nbsp;<span class="op" id="4956580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4956587">s</span><span class="op" id="4956588">.</span><span class="ident" id="4956589">tokPos</span>&nbsp;<span class="op" id="4956596">=</span>&nbsp;<span class="op" id="4956598">-</span><span class="num" id="4956599">1</span>&nbsp;<span class="comment" id="4956601">//&nbsp;don&#39;t&nbsp;collect&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4956634">ch</span>&nbsp;<span class="op" id="4956637">=</span>&nbsp;<span class="ident" id="4956639">s</span><span class="op" id="4956640">.</span><span class="ident" id="4956641">scanComment</span><span class="op" id="4956652">(</span><span class="ident" id="4956653">ch</span><span class="op" id="4956655">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4956662">goto</span>&nbsp;<span class="ident" id="4956667">redo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4956676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4956682">ch</span>&nbsp;<span class="op" id="4956685">=</span>&nbsp;<span class="ident" id="4956687">s</span><span class="op" id="4956688">.</span><span class="ident" id="4956689">scanComment</span><span class="op" id="4956700">(</span><span class="ident" id="4956701">ch</span><span class="op" id="4956703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4956709">tok</span>&nbsp;<span class="op" id="4956713">=</span>&nbsp;<span class="ident" id="4956715">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4956726">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4956730">case</span>&nbsp;<span class="string" id="4956735">&#39;`&#39;</span><span class="op" id="4956738">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4956743">if</span>&nbsp;<span class="ident" id="4956746">s</span><span class="op" id="4956747">.</span><span class="ident" id="4956748">Mode</span><span class="op" id="4956752">&amp;</span><span class="ident" id="4956753">ScanRawStrings</span>&nbsp;<span class="op" id="4956768">!=</span>&nbsp;<span class="num" id="4956771">0</span>&nbsp;<span class="op" id="4956773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4956779">s</span><span class="op" id="4956780">.</span><span class="ident" id="4956781">scanRawString</span><span class="op" id="4956794">(</span><span class="op" id="4956795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4956801">tok</span>&nbsp;<span class="op" id="4956805">=</span>&nbsp;<span class="ident" id="4956807">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4956817">}</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4956822">ch</span>&nbsp;<span class="op" id="4956825">=</span>&nbsp;<span class="ident" id="4956827">s</span><span class="op" id="4956828">.</span><span class="ident" id="4956829">next</span><span class="op" id="4956833">(</span><span class="op" id="4956834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4956838">default</span><span class="op" id="4956845">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4956850">ch</span>&nbsp;<span class="op" id="4956853">=</span>&nbsp;<span class="ident" id="4956855">s</span><span class="op" id="4956856">.</span><span class="ident" id="4956857">next</span><span class="op" id="4956861">(</span><span class="op" id="4956862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4956866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4956869">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4956873">//&nbsp;end&nbsp;of&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4956895">s</span><span class="op" id="4956896">.</span><span class="ident" id="4956897">tokEnd</span>&nbsp;<span class="op" id="4956904">=</span>&nbsp;<span class="ident" id="4956906">s</span><span class="op" id="4956907">.</span><span class="ident" id="4956908">srcPos</span>&nbsp;<span class="op" id="4956915">-</span>&nbsp;<span class="ident" id="4956917">s</span><span class="op" id="4956918">.</span><span class="ident" id="4956919">lastCharLen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4956933">s</span><span class="op" id="4956934">.</span><span class="ident" id="4956935">ch</span>&nbsp;<span class="op" id="4956938">=</span>&nbsp;<span class="ident" id="4956940">ch</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4956944">return</span>&nbsp;<span class="ident" id="4956951">tok</span><br>
<span class="lineno"></span><span class="op" id="4956955">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4956958">//&nbsp;Pos&nbsp;returns&nbsp;the&nbsp;position&nbsp;of&nbsp;the&nbsp;character&nbsp;immediately&nbsp;after</span><br>
<span class="lineno"></span><span class="comment" id="4957021">//&nbsp;the&nbsp;character&nbsp;or&nbsp;token&nbsp;returned&nbsp;by&nbsp;the&nbsp;last&nbsp;call&nbsp;to&nbsp;Next&nbsp;or&nbsp;Scan.</span><br>
<span class="lineno">650</span><span class="keyword" id="4957090">func</span>&nbsp;<span class="op" id="4957095">(</span><span class="ident" id="4957096">s</span>&nbsp;<span class="op" id="4957098">*</span><span class="ident" id="4957099">Scanner</span><span class="op" id="4957106">)</span>&nbsp;<span class="ident" id="4957108">Pos</span><span class="op" id="4957111">(</span><span class="op" id="4957112">)</span>&nbsp;<span class="op" id="4957114">(</span><span class="ident" id="4957115">pos</span>&nbsp;<span class="ident" id="4957119">Position</span><span class="op" id="4957127">)</span>&nbsp;<span class="op" id="4957129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4957132">pos</span><span class="op" id="4957135">.</span><span class="ident" id="4957136">Filename</span>&nbsp;<span class="op" id="4957145">=</span>&nbsp;<span class="ident" id="4957147">s</span><span class="op" id="4957148">.</span><span class="ident" id="4957149">Filename</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4957159">pos</span><span class="op" id="4957162">.</span><span class="ident" id="4957163">Offset</span>&nbsp;<span class="op" id="4957170">=</span>&nbsp;<span class="ident" id="4957172">s</span><span class="op" id="4957173">.</span><span class="ident" id="4957174">srcBufOffset</span>&nbsp;<span class="op" id="4957187">+</span>&nbsp;<span class="ident" id="4957189">s</span><span class="op" id="4957190">.</span><span class="ident" id="4957191">srcPos</span>&nbsp;<span class="op" id="4957198">-</span>&nbsp;<span class="ident" id="4957200">s</span><span class="op" id="4957201">.</span><span class="ident" id="4957202">lastCharLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4957215">switch</span>&nbsp;<span class="op" id="4957222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4957225">case</span>&nbsp;<span class="ident" id="4957230">s</span><span class="op" id="4957231">.</span><span class="ident" id="4957232">column</span>&nbsp;<span class="op" id="4957239">&gt;</span>&nbsp;<span class="num" id="4957241">0</span><span class="op" id="4957242">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4957246">//&nbsp;common&nbsp;case:&nbsp;last&nbsp;character&nbsp;was&nbsp;not&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4957294">pos</span><span class="op" id="4957297">.</span><span class="ident" id="4957298">Line</span>&nbsp;<span class="op" id="4957303">=</span>&nbsp;<span class="ident" id="4957305">s</span><span class="op" id="4957306">.</span><span class="ident" id="4957307">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4957314">pos</span><span class="op" id="4957317">.</span><span class="ident" id="4957318">Column</span>&nbsp;<span class="op" id="4957325">=</span>&nbsp;<span class="ident" id="4957327">s</span><span class="op" id="4957328">.</span><span class="ident" id="4957329">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4957337">case</span>&nbsp;<span class="ident" id="4957342">s</span><span class="op" id="4957343">.</span><span class="ident" id="4957344">lastLineLen</span>&nbsp;<span class="op" id="4957356">&gt;</span>&nbsp;<span class="num" id="4957358">0</span><span class="op" id="4957359">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4957363">//&nbsp;last&nbsp;character&nbsp;was&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4957394">pos</span><span class="op" id="4957397">.</span><span class="ident" id="4957398">Line</span>&nbsp;<span class="op" id="4957403">=</span>&nbsp;<span class="ident" id="4957405">s</span><span class="op" id="4957406">.</span><span class="ident" id="4957407">line</span>&nbsp;<span class="op" id="4957412">-</span>&nbsp;<span class="num" id="4957414">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4957418">pos</span><span class="op" id="4957421">.</span><span class="ident" id="4957422">Column</span>&nbsp;<span class="op" id="4957429">=</span>&nbsp;<span class="ident" id="4957431">s</span><span class="op" id="4957432">.</span><span class="ident" id="4957433">lastLineLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4957446">default</span><span class="op" id="4957453">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4957457">//&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4957493">pos</span><span class="op" id="4957496">.</span><span class="ident" id="4957497">Line</span>&nbsp;<span class="op" id="4957502">=</span>&nbsp;<span class="num" id="4957504">1</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4957508">pos</span><span class="op" id="4957511">.</span><span class="ident" id="4957512">Column</span>&nbsp;<span class="op" id="4957519">=</span>&nbsp;<span class="num" id="4957521">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4957524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4957527">return</span><br>
<span class="lineno"></span><span class="op" id="4957534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="comment" id="4957537">//&nbsp;TokenText&nbsp;returns&nbsp;the&nbsp;string&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;most&nbsp;recently&nbsp;scanned&nbsp;token.</span><br>
<span class="lineno"></span><span class="comment" id="4957619">//&nbsp;Valid&nbsp;after&nbsp;calling&nbsp;Scan().</span><br>
<span class="lineno"></span><span class="keyword" id="4957650">func</span>&nbsp;<span class="op" id="4957655">(</span><span class="ident" id="4957656">s</span>&nbsp;<span class="op" id="4957658">*</span><span class="ident" id="4957659">Scanner</span><span class="op" id="4957666">)</span>&nbsp;<span class="ident" id="4957668">TokenText</span><span class="op" id="4957677">(</span><span class="op" id="4957678">)</span>&nbsp;<span class="builtintype" id="4957680">string</span>&nbsp;<span class="op" id="4957687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4957690">if</span>&nbsp;<span class="ident" id="4957693">s</span><span class="op" id="4957694">.</span><span class="ident" id="4957695">tokPos</span>&nbsp;<span class="op" id="4957702">&lt;</span>&nbsp;<span class="num" id="4957704">0</span>&nbsp;<span class="op" id="4957706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4957710">//&nbsp;no&nbsp;token&nbsp;text</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4957729">return</span>&nbsp;<span class="string" id="4957736">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4957740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4957744">if</span>&nbsp;<span class="ident" id="4957747">s</span><span class="op" id="4957748">.</span><span class="ident" id="4957749">tokEnd</span>&nbsp;<span class="op" id="4957756">&lt;</span>&nbsp;<span class="num" id="4957758">0</span>&nbsp;<span class="op" id="4957760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4957764">//&nbsp;if&nbsp;EOF&nbsp;was&nbsp;reached,&nbsp;s.tokEnd&nbsp;is&nbsp;set&nbsp;to&nbsp;-1&nbsp;(s.srcPos&nbsp;==&nbsp;0)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4957827">s</span><span class="op" id="4957828">.</span><span class="ident" id="4957829">tokEnd</span>&nbsp;<span class="op" id="4957836">=</span>&nbsp;<span class="ident" id="4957838">s</span><span class="op" id="4957839">.</span><span class="ident" id="4957840">tokPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4957848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4957852">if</span>&nbsp;<span class="ident" id="4957855">s</span><span class="op" id="4957856">.</span><span class="ident" id="4957857">tokBuf</span><span class="op" id="4957863">.</span><span class="ident" id="4957864">Len</span><span class="op" id="4957867">(</span><span class="op" id="4957868">)</span>&nbsp;<span class="op" id="4957870">==</span>&nbsp;<span class="num" id="4957873">0</span>&nbsp;<span class="op" id="4957875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4957879">//&nbsp;common&nbsp;case:&nbsp;the&nbsp;entire&nbsp;token&nbsp;text&nbsp;is&nbsp;still&nbsp;in&nbsp;srcBuf</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4957938">return</span>&nbsp;<span class="builtintype" id="4957945">string</span><span class="op" id="4957951">(</span><span class="ident" id="4957952">s</span><span class="op" id="4957953">.</span><span class="ident" id="4957954">srcBuf</span><span class="op" id="4957960">[</span><span class="ident" id="4957961">s</span><span class="op" id="4957962">.</span><span class="ident" id="4957963">tokPos</span><span class="op" id="4957969">:</span><span class="ident" id="4957970">s</span><span class="op" id="4957971">.</span><span class="ident" id="4957972">tokEnd</span><span class="op" id="4957978">]</span><span class="op" id="4957979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4957982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4957986">//&nbsp;part&nbsp;of&nbsp;the&nbsp;token&nbsp;text&nbsp;was&nbsp;saved&nbsp;in&nbsp;tokBuf:&nbsp;save&nbsp;the&nbsp;rest&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4958051">//&nbsp;tokBuf&nbsp;as&nbsp;well&nbsp;and&nbsp;return&nbsp;its&nbsp;content</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4958093">s</span><span class="op" id="4958094">.</span><span class="ident" id="4958095">tokBuf</span><span class="op" id="4958101">.</span><span class="ident" id="4958102">Write</span><span class="op" id="4958107">(</span><span class="ident" id="4958108">s</span><span class="op" id="4958109">.</span><span class="ident" id="4958110">srcBuf</span><span class="op" id="4958116">[</span><span class="ident" id="4958117">s</span><span class="op" id="4958118">.</span><span class="ident" id="4958119">tokPos</span><span class="op" id="4958125">:</span><span class="ident" id="4958126">s</span><span class="op" id="4958127">.</span><span class="ident" id="4958128">tokEnd</span><span class="op" id="4958134">]</span><span class="op" id="4958135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4958138">s</span><span class="op" id="4958139">.</span><span class="ident" id="4958140">tokPos</span>&nbsp;<span class="op" id="4958147">=</span>&nbsp;<span class="ident" id="4958149">s</span><span class="op" id="4958150">.</span><span class="ident" id="4958151">tokEnd</span>&nbsp;<span class="comment" id="4958158">//&nbsp;ensure&nbsp;idempotency&nbsp;of&nbsp;TokenText()&nbsp;call</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4958201">return</span>&nbsp;<span class="ident" id="4958208">s</span><span class="op" id="4958209">.</span><span class="ident" id="4958210">tokBuf</span><span class="op" id="4958216">.</span><span class="ident" id="4958217">String</span><span class="op" id="4958223">(</span><span class="op" id="4958224">)</span><br>
<span class="lineno"></span><span class="op" id="4958226">}</span>
</div>
</body>
</html>
