<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8511109">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8511164">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8511218">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8511269">package</span>&nbsp;<span class="ident" id="8511277">printer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8511286">import</span>&nbsp;<span class="op" id="8511293">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8511296">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8511305">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8511315">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8511323">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8511330">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8511340">&#34;go/parser&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8511353">&#34;go/token&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8511365">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8511378">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8511395">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8511406">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="8511413">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="8511416">const</span>&nbsp;<span class="op" id="8511422">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8511425">dataDir</span>&nbsp;&nbsp;<span class="op" id="8511434">=</span>&nbsp;<span class="string" id="8511436">&#34;testdata&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8511448">tabwidth</span>&nbsp;<span class="op" id="8511457">=</span>&nbsp;<span class="num" id="8511459">8</span><br>
<span class="lineno"></span><span class="op" id="8511461">)</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="8511464">var</span>&nbsp;<span class="ident" id="8511468">update</span>&nbsp;<span class="op" id="8511475">=</span>&nbsp;<span class="ident" id="8511477"><a href="/go/printer/printer_test.go.html#8511315">flag</a></span><span class="op" id="8511481">.</span><span class="ident" id="8511482">Bool</span><span class="op" id="8511486">(</span><span class="string" id="8511487">&#34;update&#34;</span><span class="op" id="8511495">,</span>&nbsp;<span class="builtintype" id="8511497">false</span><span class="op" id="8511502">,</span>&nbsp;<span class="string" id="8511504">&#34;update&nbsp;golden&nbsp;files&#34;</span><span class="op" id="8511525">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8511528">var</span>&nbsp;<span class="ident" id="8511532">fset</span>&nbsp;<span class="op" id="8511537">=</span>&nbsp;<span class="ident" id="8511539"><a href="/go/printer/printer_test.go.html#8511353">token</a></span><span class="op" id="8511544">.</span><span class="ident" id="8511545">NewFileSet</span><span class="op" id="8511555">(</span><span class="op" id="8511556">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="8511559">type</span>&nbsp;<span class="ident" id="8511564">checkMode</span>&nbsp;<span class="builtintype" id="8511574">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8511580">const</span>&nbsp;<span class="op" id="8511586">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8511589">export</span>&nbsp;<span class="ident" id="8511596"><a href="/go/printer/printer_test.go.html#8511564">checkMode</a></span>&nbsp;<span class="op" id="8511606">=</span>&nbsp;<span class="num" id="8511608">1</span>&nbsp;<span class="op" id="8511610">&lt;&lt;</span>&nbsp;<span class="ident" id="8511613">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8511619">rawFormat</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8511630">idempotent</span><br>
<span class="lineno"></span><span class="op" id="8511641">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8511644">//&nbsp;format&nbsp;parses&nbsp;src,&nbsp;prints&nbsp;the&nbsp;corresponding&nbsp;AST,&nbsp;verifies&nbsp;the&nbsp;resulting</span><br>
<span class="lineno"></span><span class="comment" id="8511719">//&nbsp;src&nbsp;is&nbsp;syntactically&nbsp;correct,&nbsp;and&nbsp;returns&nbsp;the&nbsp;resulting&nbsp;src&nbsp;or&nbsp;an&nbsp;error</span><br>
<span class="lineno">40</span><span class="comment" id="8511794">//&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span><span class="keyword" id="8511805">func</span>&nbsp;<span class="ident" id="8511810">format</span><span class="op" id="8511816">(</span><span class="ident" id="8511817">src</span>&nbsp;<span class="op" id="8511821">[</span><span class="op" id="8511822">]</span><span class="builtintype" id="8511823">byte</span><span class="op" id="8511827">,</span>&nbsp;<span class="ident" id="8511829">mode</span>&nbsp;<span class="ident" id="8511834"><a href="/go/printer/printer_test.go.html#8511564">checkMode</a></span><span class="op" id="8511843">)</span>&nbsp;<span class="op" id="8511845">(</span><span class="op" id="8511846">[</span><span class="op" id="8511847">]</span><span class="builtintype" id="8511848">byte</span><span class="op" id="8511852">,</span>&nbsp;<span class="builtintype" id="8511854">error</span><span class="op" id="8511859">)</span>&nbsp;<span class="op" id="8511861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8511864">//&nbsp;parse&nbsp;src</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8511878">f</span><span class="op" id="8511879">,</span>&nbsp;<span class="ident" id="8511881">err</span>&nbsp;<span class="op" id="8511885">:=</span>&nbsp;<span class="ident" id="8511888"><a href="/go/printer/printer_test.go.html#8511340">parser</a></span><span class="op" id="8511894">.</span><span class="ident" id="8511895">ParseFile</span><span class="op" id="8511904">(</span><span class="ident" id="8511905"><a href="/go/printer/printer_test.go.html#8511532">fset</a></span><span class="op" id="8511909">,</span>&nbsp;<span class="string" id="8511911">&#34;&#34;</span><span class="op" id="8511913">,</span>&nbsp;<span class="ident" id="8511915"><a href="/go/printer/printer_test.go.html#8511817">src</a></span><span class="op" id="8511918">,</span>&nbsp;<span class="ident" id="8511920"><a href="/go/printer/printer_test.go.html#8511340">parser</a></span><span class="op" id="8511926">.</span><span class="ident" id="8511927">ParseComments</span><span class="op" id="8511940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8511943">if</span>&nbsp;<span class="ident" id="8511946"><a href="/go/printer/printer_test.go.html#8511881">err</a></span>&nbsp;<span class="op" id="8511950">!=</span>&nbsp;<span class="ident" id="8511953">nil</span>&nbsp;<span class="op" id="8511957">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8511961">return</span>&nbsp;<span class="ident" id="8511968">nil</span><span class="op" id="8511971">,</span>&nbsp;<span class="ident" id="8511973"><a href="/go/printer/printer_test.go.html#8511323">fmt</a></span><span class="op" id="8511976">.</span><span class="ident" id="8511977">Errorf</span><span class="op" id="8511983">(</span><span class="string" id="8511984">&#34;parse:&nbsp;%s\n%s&#34;</span><span class="op" id="8511999">,</span>&nbsp;<span class="ident" id="8512001"><a href="/go/printer/printer_test.go.html#8511881">err</a></span><span class="op" id="8512004">,</span>&nbsp;<span class="ident" id="8512006"><a href="/go/printer/printer_test.go.html#8511817">src</a></span><span class="op" id="8512009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8512012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8512016">//&nbsp;filter&nbsp;exports&nbsp;if&nbsp;necessary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8512048">if</span>&nbsp;<span class="ident" id="8512051"><a href="/go/printer/printer_test.go.html#8511829">mode</a></span><span class="op" id="8512055">&amp;</span><span class="ident" id="8512056"><a href="/go/printer/printer_test.go.html#8511589">export</a></span>&nbsp;<span class="op" id="8512063">!=</span>&nbsp;<span class="num" id="8512066">0</span>&nbsp;<span class="op" id="8512068">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8512072"><a href="/go/printer/printer_test.go.html#8511330">ast</a></span><span class="op" id="8512075">.</span><span class="ident" id="8512076">FileExports</span><span class="op" id="8512087">(</span><span class="ident" id="8512088"><a href="/go/printer/printer_test.go.html#8511878">f</a></span><span class="op" id="8512089">)</span>&nbsp;<span class="comment" id="8512091">//&nbsp;ignore&nbsp;result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8512110"><a href="/go/printer/printer_test.go.html#8511878">f</a></span><span class="op" id="8512111">.</span><span class="ident" id="8512112">Comments</span>&nbsp;<span class="op" id="8512121">=</span>&nbsp;<span class="ident" id="8512123">nil</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="8512129">//&nbsp;don&#39;t&nbsp;print&nbsp;comments&nbsp;that&nbsp;are&nbsp;not&nbsp;in&nbsp;AST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8512174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8512178">//&nbsp;determine&nbsp;printer&nbsp;configuration</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8512214">cfg</span>&nbsp;<span class="op" id="8512218">:=</span>&nbsp;<span class="ident" id="8512221"><a href="/go/printer/printer.go.html#5359429">Config</a></span><span class="op" id="8512227">{</span><span class="ident" id="8512228">Tabwidth</span><span class="op" id="8512236">:</span>&nbsp;<span class="ident" id="8512238"><a href="/go/printer/printer_test.go.html#8511448">tabwidth</a></span><span class="op" id="8512246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8512249">if</span>&nbsp;<span class="ident" id="8512252"><a href="/go/printer/printer_test.go.html#8511829">mode</a></span><span class="op" id="8512256">&amp;</span><span class="ident" id="8512257"><a href="/go/printer/printer_test.go.html#8511619">rawFormat</a></span>&nbsp;<span class="op" id="8512267">!=</span>&nbsp;<span class="num" id="8512270">0</span>&nbsp;<span class="op" id="8512272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8512276"><a href="/go/printer/printer_test.go.html#8512214">cfg</a></span><span class="op" id="8512279">.</span><span class="ident" id="8512280">Mode</span>&nbsp;<span class="op" id="8512285">|=</span>&nbsp;<span class="ident" id="8512288"><a href="/go/printer/printer.go.html#5359047">RawFormat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8512299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8512303">//&nbsp;print&nbsp;AST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8512317">var</span>&nbsp;<span class="ident" id="8512321">buf</span>&nbsp;<span class="ident" id="8512325"><a href="/go/printer/printer_test.go.html#8511296">bytes</a></span><span class="op" id="8512330">.</span><span class="ident" id="8512331">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8512339">if</span>&nbsp;<span class="ident" id="8512342">err</span>&nbsp;<span class="op" id="8512346">:=</span>&nbsp;<span class="ident" id="8512349"><a href="/go/printer/printer_test.go.html#8512214">cfg</a></span><span class="op" id="8512352">.</span><span class="ident" id="8512353">Fprint</span><span class="op" id="8512359">(</span><span class="op" id="8512360">&amp;</span><span class="ident" id="8512361"><a href="/go/printer/printer_test.go.html#8512321">buf</a></span><span class="op" id="8512364">,</span>&nbsp;<span class="ident" id="8512366"><a href="/go/printer/printer_test.go.html#8511532">fset</a></span><span class="op" id="8512370">,</span>&nbsp;<span class="ident" id="8512372"><a href="/go/printer/printer_test.go.html#8511878">f</a></span><span class="op" id="8512373">)</span><span class="op" id="8512374">;</span>&nbsp;<span class="ident" id="8512376"><a href="/go/printer/printer_test.go.html#8512342">err</a></span>&nbsp;<span class="op" id="8512380">!=</span>&nbsp;<span class="ident" id="8512383">nil</span>&nbsp;<span class="op" id="8512387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8512391">return</span>&nbsp;<span class="ident" id="8512398">nil</span><span class="op" id="8512401">,</span>&nbsp;<span class="ident" id="8512403"><a href="/go/printer/printer_test.go.html#8511323">fmt</a></span><span class="op" id="8512406">.</span><span class="ident" id="8512407">Errorf</span><span class="op" id="8512413">(</span><span class="string" id="8512414">&#34;print:&nbsp;%s&#34;</span><span class="op" id="8512425">,</span>&nbsp;<span class="ident" id="8512427"><a href="/go/printer/printer_test.go.html#8512342">err</a></span><span class="op" id="8512430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8512433">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8512437">//&nbsp;make&nbsp;sure&nbsp;formatted&nbsp;output&nbsp;is&nbsp;syntactically&nbsp;correct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8512493">res</span>&nbsp;<span class="op" id="8512497">:=</span>&nbsp;<span class="ident" id="8512500"><a href="/go/printer/printer_test.go.html#8512321">buf</a></span><span class="op" id="8512503">.</span><span class="ident" id="8512504">Bytes</span><span class="op" id="8512509">(</span><span class="op" id="8512510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8512513">if</span>&nbsp;<span class="ident" id="8512516">_</span><span class="op" id="8512517">,</span>&nbsp;<span class="ident" id="8512519">err</span>&nbsp;<span class="op" id="8512523">:=</span>&nbsp;<span class="ident" id="8512526"><a href="/go/printer/printer_test.go.html#8511340">parser</a></span><span class="op" id="8512532">.</span><span class="ident" id="8512533">ParseFile</span><span class="op" id="8512542">(</span><span class="ident" id="8512543"><a href="/go/printer/printer_test.go.html#8511532">fset</a></span><span class="op" id="8512547">,</span>&nbsp;<span class="string" id="8512549">&#34;&#34;</span><span class="op" id="8512551">,</span>&nbsp;<span class="ident" id="8512553"><a href="/go/printer/printer_test.go.html#8512493">res</a></span><span class="op" id="8512556">,</span>&nbsp;<span class="num" id="8512558">0</span><span class="op" id="8512559">)</span><span class="op" id="8512560">;</span>&nbsp;<span class="ident" id="8512562"><a href="/go/printer/printer_test.go.html#8512519">err</a></span>&nbsp;<span class="op" id="8512566">!=</span>&nbsp;<span class="ident" id="8512569">nil</span>&nbsp;<span class="op" id="8512573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8512577">return</span>&nbsp;<span class="ident" id="8512584">nil</span><span class="op" id="8512587">,</span>&nbsp;<span class="ident" id="8512589"><a href="/go/printer/printer_test.go.html#8511323">fmt</a></span><span class="op" id="8512592">.</span><span class="ident" id="8512593">Errorf</span><span class="op" id="8512599">(</span><span class="string" id="8512600">&#34;re-parse:&nbsp;%s\n%s&#34;</span><span class="op" id="8512618">,</span>&nbsp;<span class="ident" id="8512620"><a href="/go/printer/printer_test.go.html#8512519">err</a></span><span class="op" id="8512623">,</span>&nbsp;<span class="ident" id="8512625"><a href="/go/printer/printer_test.go.html#8512321">buf</a></span><span class="op" id="8512628">.</span><span class="ident" id="8512629">Bytes</span><span class="op" id="8512634">(</span><span class="op" id="8512635">)</span><span class="op" id="8512636">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8512639">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8512643">return</span>&nbsp;<span class="ident" id="8512650"><a href="/go/printer/printer_test.go.html#8512493">res</a></span><span class="op" id="8512653">,</span>&nbsp;<span class="ident" id="8512655">nil</span><br>
<span class="lineno"></span><span class="op" id="8512659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="8512662">//&nbsp;lineAt&nbsp;returns&nbsp;the&nbsp;line&nbsp;in&nbsp;text&nbsp;starting&nbsp;at&nbsp;offset&nbsp;offs.</span><br>
<span class="lineno"></span><span class="keyword" id="8512722">func</span>&nbsp;<span class="ident" id="8512727">lineAt</span><span class="op" id="8512733">(</span><span class="ident" id="8512734">text</span>&nbsp;<span class="op" id="8512739">[</span><span class="op" id="8512740">]</span><span class="builtintype" id="8512741">byte</span><span class="op" id="8512745">,</span>&nbsp;<span class="ident" id="8512747">offs</span>&nbsp;<span class="builtintype" id="8512752">int</span><span class="op" id="8512755">)</span>&nbsp;<span class="op" id="8512757">[</span><span class="op" id="8512758">]</span><span class="builtintype" id="8512759">byte</span>&nbsp;<span class="op" id="8512764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8512767">i</span>&nbsp;<span class="op" id="8512769">:=</span>&nbsp;<span class="ident" id="8512772"><a href="/go/printer/printer_test.go.html#8512747">offs</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8512778">for</span>&nbsp;<span class="ident" id="8512782"><a href="/go/printer/printer_test.go.html#8512767">i</a></span>&nbsp;<span class="op" id="8512784">&lt;</span>&nbsp;<span class="builtinfunc" id="8512786">len</span><span class="op" id="8512789">(</span><span class="ident" id="8512790"><a href="/go/printer/printer_test.go.html#8512734">text</a></span><span class="op" id="8512794">)</span>&nbsp;<span class="op" id="8512796">&amp;&amp;</span>&nbsp;<span class="ident" id="8512799"><a href="/go/printer/printer_test.go.html#8512734">text</a></span><span class="op" id="8512803">[</span><span class="ident" id="8512804"><a href="/go/printer/printer_test.go.html#8512767">i</a></span><span class="op" id="8512805">]</span>&nbsp;<span class="op" id="8512807">!=</span>&nbsp;<span class="string" id="8512810">&#39;\n&#39;</span>&nbsp;<span class="op" id="8512815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8512819"><a href="/go/printer/printer_test.go.html#8512767">i</a></span><span class="op" id="8512820">++</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8512824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8512827">return</span>&nbsp;<span class="ident" id="8512834"><a href="/go/printer/printer_test.go.html#8512734">text</a></span><span class="op" id="8512838">[</span><span class="ident" id="8512839"><a href="/go/printer/printer_test.go.html#8512747">offs</a></span><span class="op" id="8512843">:</span><span class="ident" id="8512844"><a href="/go/printer/printer_test.go.html#8512767">i</a></span><span class="op" id="8512845">]</span><br>
<span class="lineno"></span><span class="op" id="8512847">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8512850">//&nbsp;diff&nbsp;compares&nbsp;a&nbsp;and&nbsp;b.</span><br>
<span class="lineno">85</span><span class="keyword" id="8512876">func</span>&nbsp;<span class="ident" id="8512881">diff</span><span class="op" id="8512885">(</span><span class="ident" id="8512886">aname</span><span class="op" id="8512891">,</span>&nbsp;<span class="ident" id="8512893">bname</span>&nbsp;<span class="builtintype" id="8512899">string</span><span class="op" id="8512905">,</span>&nbsp;<span class="ident" id="8512907">a</span><span class="op" id="8512908">,</span>&nbsp;<span class="ident" id="8512910">b</span>&nbsp;<span class="op" id="8512912">[</span><span class="op" id="8512913">]</span><span class="builtintype" id="8512914">byte</span><span class="op" id="8512918">)</span>&nbsp;<span class="builtintype" id="8512920">error</span>&nbsp;<span class="op" id="8512926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8512929">var</span>&nbsp;<span class="ident" id="8512933">buf</span>&nbsp;<span class="ident" id="8512937"><a href="/go/printer/printer_test.go.html#8511296">bytes</a></span><span class="op" id="8512942">.</span><span class="ident" id="8512943">Buffer</span>&nbsp;<span class="comment" id="8512950">//&nbsp;holding&nbsp;long&nbsp;error&nbsp;message</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8512982">//&nbsp;compare&nbsp;lengths</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8513002">if</span>&nbsp;<span class="builtinfunc" id="8513005">len</span><span class="op" id="8513008">(</span><span class="ident" id="8513009"><a href="/go/printer/printer_test.go.html#8512907">a</a></span><span class="op" id="8513010">)</span>&nbsp;<span class="op" id="8513012">!=</span>&nbsp;<span class="builtinfunc" id="8513015">len</span><span class="op" id="8513018">(</span><span class="ident" id="8513019"><a href="/go/printer/printer_test.go.html#8512910">b</a></span><span class="op" id="8513020">)</span>&nbsp;<span class="op" id="8513022">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8513026"><a href="/go/printer/printer_test.go.html#8511323">fmt</a></span><span class="op" id="8513029">.</span><span class="ident" id="8513030">Fprintf</span><span class="op" id="8513037">(</span><span class="op" id="8513038">&amp;</span><span class="ident" id="8513039"><a href="/go/printer/printer_test.go.html#8512933">buf</a></span><span class="op" id="8513042">,</span>&nbsp;<span class="string" id="8513044">&#34;\nlength&nbsp;changed:&nbsp;len(%s)&nbsp;=&nbsp;%d,&nbsp;len(%s)&nbsp;=&nbsp;%d&#34;</span><span class="op" id="8513090">,</span>&nbsp;<span class="ident" id="8513092"><a href="/go/printer/printer_test.go.html#8512886">aname</a></span><span class="op" id="8513097">,</span>&nbsp;<span class="builtinfunc" id="8513099">len</span><span class="op" id="8513102">(</span><span class="ident" id="8513103"><a href="/go/printer/printer_test.go.html#8512907">a</a></span><span class="op" id="8513104">)</span><span class="op" id="8513105">,</span>&nbsp;<span class="ident" id="8513107"><a href="/go/printer/printer_test.go.html#8512893">bname</a></span><span class="op" id="8513112">,</span>&nbsp;<span class="builtinfunc" id="8513114">len</span><span class="op" id="8513117">(</span><span class="ident" id="8513118"><a href="/go/printer/printer_test.go.html#8512910">b</a></span><span class="op" id="8513119">)</span><span class="op" id="8513120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8513123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8513127">//&nbsp;compare&nbsp;contents</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8513148">line</span>&nbsp;<span class="op" id="8513153">:=</span>&nbsp;<span class="num" id="8513156">1</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8513159">offs</span>&nbsp;<span class="op" id="8513164">:=</span>&nbsp;<span class="num" id="8513167">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8513170">for</span>&nbsp;<span class="ident" id="8513174">i</span>&nbsp;<span class="op" id="8513176">:=</span>&nbsp;<span class="num" id="8513179">0</span><span class="op" id="8513180">;</span>&nbsp;<span class="ident" id="8513182"><a href="/go/printer/printer_test.go.html#8513174">i</a></span>&nbsp;<span class="op" id="8513184">&lt;</span>&nbsp;<span class="builtinfunc" id="8513186">len</span><span class="op" id="8513189">(</span><span class="ident" id="8513190"><a href="/go/printer/printer_test.go.html#8512907">a</a></span><span class="op" id="8513191">)</span>&nbsp;<span class="op" id="8513193">&amp;&amp;</span>&nbsp;<span class="ident" id="8513196"><a href="/go/printer/printer_test.go.html#8513174">i</a></span>&nbsp;<span class="op" id="8513198">&lt;</span>&nbsp;<span class="builtinfunc" id="8513200">len</span><span class="op" id="8513203">(</span><span class="ident" id="8513204"><a href="/go/printer/printer_test.go.html#8512910">b</a></span><span class="op" id="8513205">)</span><span class="op" id="8513206">;</span>&nbsp;<span class="ident" id="8513208"><a href="/go/printer/printer_test.go.html#8513174">i</a></span><span class="op" id="8513209">++</span>&nbsp;<span class="op" id="8513212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8513216">ch</span>&nbsp;<span class="op" id="8513219">:=</span>&nbsp;<span class="ident" id="8513222"><a href="/go/printer/printer_test.go.html#8512907">a</a></span><span class="op" id="8513223">[</span><span class="ident" id="8513224"><a href="/go/printer/printer_test.go.html#8513174">i</a></span><span class="op" id="8513225">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8513229">if</span>&nbsp;<span class="ident" id="8513232"><a href="/go/printer/printer_test.go.html#8513216">ch</a></span>&nbsp;<span class="op" id="8513235">!=</span>&nbsp;<span class="ident" id="8513238"><a href="/go/printer/printer_test.go.html#8512910">b</a></span><span class="op" id="8513239">[</span><span class="ident" id="8513240"><a href="/go/printer/printer_test.go.html#8513174">i</a></span><span class="op" id="8513241">]</span>&nbsp;<span class="op" id="8513243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8513248"><a href="/go/printer/printer_test.go.html#8511323">fmt</a></span><span class="op" id="8513251">.</span><span class="ident" id="8513252">Fprintf</span><span class="op" id="8513259">(</span><span class="op" id="8513260">&amp;</span><span class="ident" id="8513261"><a href="/go/printer/printer_test.go.html#8512933">buf</a></span><span class="op" id="8513264">,</span>&nbsp;<span class="string" id="8513266">&#34;\n%s:%d:%d:&nbsp;%s&#34;</span><span class="op" id="8513282">,</span>&nbsp;<span class="ident" id="8513284"><a href="/go/printer/printer_test.go.html#8512886">aname</a></span><span class="op" id="8513289">,</span>&nbsp;<span class="ident" id="8513291"><a href="/go/printer/printer_test.go.html#8513148">line</a></span><span class="op" id="8513295">,</span>&nbsp;<span class="ident" id="8513297"><a href="/go/printer/printer_test.go.html#8513174">i</a></span><span class="op" id="8513298">-</span><span class="ident" id="8513299"><a href="/go/printer/printer_test.go.html#8513159">offs</a></span><span class="op" id="8513303">+</span><span class="num" id="8513304">1</span><span class="op" id="8513305">,</span>&nbsp;<span class="ident" id="8513307"><a href="/go/printer/printer_test.go.html#8512727">lineAt</a></span><span class="op" id="8513313">(</span><span class="ident" id="8513314"><a href="/go/printer/printer_test.go.html#8512907">a</a></span><span class="op" id="8513315">,</span>&nbsp;<span class="ident" id="8513317"><a href="/go/printer/printer_test.go.html#8513159">offs</a></span><span class="op" id="8513321">)</span><span class="op" id="8513322">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8513327"><a href="/go/printer/printer_test.go.html#8511323">fmt</a></span><span class="op" id="8513330">.</span><span class="ident" id="8513331">Fprintf</span><span class="op" id="8513338">(</span><span class="op" id="8513339">&amp;</span><span class="ident" id="8513340"><a href="/go/printer/printer_test.go.html#8512933">buf</a></span><span class="op" id="8513343">,</span>&nbsp;<span class="string" id="8513345">&#34;\n%s:%d:%d:&nbsp;%s&#34;</span><span class="op" id="8513361">,</span>&nbsp;<span class="ident" id="8513363"><a href="/go/printer/printer_test.go.html#8512893">bname</a></span><span class="op" id="8513368">,</span>&nbsp;<span class="ident" id="8513370"><a href="/go/printer/printer_test.go.html#8513148">line</a></span><span class="op" id="8513374">,</span>&nbsp;<span class="ident" id="8513376"><a href="/go/printer/printer_test.go.html#8513174">i</a></span><span class="op" id="8513377">-</span><span class="ident" id="8513378"><a href="/go/printer/printer_test.go.html#8513159">offs</a></span><span class="op" id="8513382">+</span><span class="num" id="8513383">1</span><span class="op" id="8513384">,</span>&nbsp;<span class="ident" id="8513386"><a href="/go/printer/printer_test.go.html#8512727">lineAt</a></span><span class="op" id="8513392">(</span><span class="ident" id="8513393"><a href="/go/printer/printer_test.go.html#8512910">b</a></span><span class="op" id="8513394">,</span>&nbsp;<span class="ident" id="8513396"><a href="/go/printer/printer_test.go.html#8513159">offs</a></span><span class="op" id="8513400">)</span><span class="op" id="8513401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8513406"><a href="/go/printer/printer_test.go.html#8511323">fmt</a></span><span class="op" id="8513409">.</span><span class="ident" id="8513410">Fprintf</span><span class="op" id="8513417">(</span><span class="op" id="8513418">&amp;</span><span class="ident" id="8513419"><a href="/go/printer/printer_test.go.html#8512933">buf</a></span><span class="op" id="8513422">,</span>&nbsp;<span class="string" id="8513424">&#34;\n\n&#34;</span><span class="op" id="8513430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8513435">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8513443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8513447">if</span>&nbsp;<span class="ident" id="8513450"><a href="/go/printer/printer_test.go.html#8513216">ch</a></span>&nbsp;<span class="op" id="8513453">==</span>&nbsp;<span class="string" id="8513456">&#39;\n&#39;</span>&nbsp;<span class="op" id="8513461">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8513466"><a href="/go/printer/printer_test.go.html#8513148">line</a></span><span class="op" id="8513470">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8513476"><a href="/go/printer/printer_test.go.html#8513159">offs</a></span>&nbsp;<span class="op" id="8513481">=</span>&nbsp;<span class="ident" id="8513483"><a href="/go/printer/printer_test.go.html#8513174">i</a></span>&nbsp;<span class="op" id="8513485">+</span>&nbsp;<span class="num" id="8513487">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8513491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8513494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8513498">if</span>&nbsp;<span class="ident" id="8513501"><a href="/go/printer/printer_test.go.html#8512933">buf</a></span><span class="op" id="8513504">.</span><span class="ident" id="8513505">Len</span><span class="op" id="8513508">(</span><span class="op" id="8513509">)</span>&nbsp;<span class="op" id="8513511">&gt;</span>&nbsp;<span class="num" id="8513513">0</span>&nbsp;<span class="op" id="8513515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8513519">return</span>&nbsp;<span class="ident" id="8513526"><a href="/go/printer/printer_test.go.html#8511305">errors</a></span><span class="op" id="8513532">.</span><span class="ident" id="8513533">New</span><span class="op" id="8513536">(</span><span class="ident" id="8513537"><a href="/go/printer/printer_test.go.html#8512933">buf</a></span><span class="op" id="8513540">.</span><span class="ident" id="8513541">String</span><span class="op" id="8513547">(</span><span class="op" id="8513548">)</span><span class="op" id="8513549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8513552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8513555">return</span>&nbsp;<span class="ident" id="8513562">nil</span><br>
<span class="lineno"></span><span class="op" id="8513566">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="keyword" id="8513569">func</span>&nbsp;<span class="ident" id="8513574">runcheck</span><span class="op" id="8513582">(</span><span class="ident" id="8513583">t</span>&nbsp;<span class="op" id="8513585">*</span><span class="ident" id="8513586"><a href="/go/printer/printer_test.go.html#8511395">testing</a></span><span class="op" id="8513593">.</span><span class="ident" id="8513594">T</span><span class="op" id="8513595">,</span>&nbsp;<span class="ident" id="8513597">source</span><span class="op" id="8513603">,</span>&nbsp;<span class="ident" id="8513605">golden</span>&nbsp;<span class="builtintype" id="8513612">string</span><span class="op" id="8513618">,</span>&nbsp;<span class="ident" id="8513620">mode</span>&nbsp;<span class="ident" id="8513625"><a href="/go/printer/printer_test.go.html#8511564">checkMode</a></span><span class="op" id="8513634">)</span>&nbsp;<span class="op" id="8513636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8513639">src</span><span class="op" id="8513642">,</span>&nbsp;<span class="ident" id="8513644">err</span>&nbsp;<span class="op" id="8513648">:=</span>&nbsp;<span class="ident" id="8513651"><a href="/go/printer/printer_test.go.html#8511365">ioutil</a></span><span class="op" id="8513657">.</span><span class="ident" id="8513658">ReadFile</span><span class="op" id="8513666">(</span><span class="ident" id="8513667"><a href="/go/printer/printer_test.go.html#8513597">source</a></span><span class="op" id="8513673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8513676">if</span>&nbsp;<span class="ident" id="8513679"><a href="/go/printer/printer_test.go.html#8513644">err</a></span>&nbsp;<span class="op" id="8513683">!=</span>&nbsp;<span class="ident" id="8513686">nil</span>&nbsp;<span class="op" id="8513690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8513694"><a href="/go/printer/printer_test.go.html#8513583">t</a></span><span class="op" id="8513695">.</span><span class="ident" id="8513696">Error</span><span class="op" id="8513701">(</span><span class="ident" id="8513702"><a href="/go/printer/printer_test.go.html#8513644">err</a></span><span class="op" id="8513705">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8513709">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8513717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8513721">res</span><span class="op" id="8513724">,</span>&nbsp;<span class="ident" id="8513726"><a href="/go/printer/printer_test.go.html#8513644">err</a></span>&nbsp;<span class="op" id="8513730">:=</span>&nbsp;<span class="ident" id="8513733"><a href="/go/printer/printer_test.go.html#8511810">format</a></span><span class="op" id="8513739">(</span><span class="ident" id="8513740"><a href="/go/printer/printer_test.go.html#8513639">src</a></span><span class="op" id="8513743">,</span>&nbsp;<span class="ident" id="8513745"><a href="/go/printer/printer_test.go.html#8513620">mode</a></span><span class="op" id="8513749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8513752">if</span>&nbsp;<span class="ident" id="8513755"><a href="/go/printer/printer_test.go.html#8513644">err</a></span>&nbsp;<span class="op" id="8513759">!=</span>&nbsp;<span class="ident" id="8513762">nil</span>&nbsp;<span class="op" id="8513766">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8513770"><a href="/go/printer/printer_test.go.html#8513583">t</a></span><span class="op" id="8513771">.</span><span class="ident" id="8513772">Error</span><span class="op" id="8513777">(</span><span class="ident" id="8513778"><a href="/go/printer/printer_test.go.html#8513644">err</a></span><span class="op" id="8513781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8513785">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8513793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8513797">//&nbsp;update&nbsp;golden&nbsp;files&nbsp;if&nbsp;necessary</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8513834">if</span>&nbsp;<span class="op" id="8513837">*</span><span class="ident" id="8513838"><a href="/go/printer/printer_test.go.html#8511468">update</a></span>&nbsp;<span class="op" id="8513845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8513849">if</span>&nbsp;<span class="ident" id="8513852">err</span>&nbsp;<span class="op" id="8513856">:=</span>&nbsp;<span class="ident" id="8513859"><a href="/go/printer/printer_test.go.html#8511365">ioutil</a></span><span class="op" id="8513865">.</span><span class="ident" id="8513866">WriteFile</span><span class="op" id="8513875">(</span><span class="ident" id="8513876"><a href="/go/printer/printer_test.go.html#8513605">golden</a></span><span class="op" id="8513882">,</span>&nbsp;<span class="ident" id="8513884"><a href="/go/printer/printer_test.go.html#8513721">res</a></span><span class="op" id="8513887">,</span>&nbsp;<span class="num" id="8513889">0644</span><span class="op" id="8513893">)</span><span class="op" id="8513894">;</span>&nbsp;<span class="ident" id="8513896"><a href="/go/printer/printer_test.go.html#8513852">err</a></span>&nbsp;<span class="op" id="8513900">!=</span>&nbsp;<span class="ident" id="8513903">nil</span>&nbsp;<span class="op" id="8513907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8513912"><a href="/go/printer/printer_test.go.html#8513583">t</a></span><span class="op" id="8513913">.</span><span class="ident" id="8513914">Error</span><span class="op" id="8513919">(</span><span class="ident" id="8513920"><a href="/go/printer/printer_test.go.html#8513852">err</a></span><span class="op" id="8513923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8513927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8513931">return</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8513939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8513943">//&nbsp;get&nbsp;golden</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8513958">gld</span><span class="op" id="8513961">,</span>&nbsp;<span class="ident" id="8513963"><a href="/go/printer/printer_test.go.html#8513644">err</a></span>&nbsp;<span class="op" id="8513967">:=</span>&nbsp;<span class="ident" id="8513970"><a href="/go/printer/printer_test.go.html#8511365">ioutil</a></span><span class="op" id="8513976">.</span><span class="ident" id="8513977">ReadFile</span><span class="op" id="8513985">(</span><span class="ident" id="8513986"><a href="/go/printer/printer_test.go.html#8513605">golden</a></span><span class="op" id="8513992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8513995">if</span>&nbsp;<span class="ident" id="8513998"><a href="/go/printer/printer_test.go.html#8513644">err</a></span>&nbsp;<span class="op" id="8514002">!=</span>&nbsp;<span class="ident" id="8514005">nil</span>&nbsp;<span class="op" id="8514009">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8514013"><a href="/go/printer/printer_test.go.html#8513583">t</a></span><span class="op" id="8514014">.</span><span class="ident" id="8514015">Error</span><span class="op" id="8514020">(</span><span class="ident" id="8514021"><a href="/go/printer/printer_test.go.html#8513644">err</a></span><span class="op" id="8514024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8514028">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8514036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8514040">//&nbsp;formatted&nbsp;source&nbsp;and&nbsp;golden&nbsp;must&nbsp;be&nbsp;the&nbsp;same</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8514089">if</span>&nbsp;<span class="ident" id="8514092">err</span>&nbsp;<span class="op" id="8514096">:=</span>&nbsp;<span class="ident" id="8514099"><a href="/go/printer/printer_test.go.html#8512881">diff</a></span><span class="op" id="8514103">(</span><span class="ident" id="8514104"><a href="/go/printer/printer_test.go.html#8513597">source</a></span><span class="op" id="8514110">,</span>&nbsp;<span class="ident" id="8514112"><a href="/go/printer/printer_test.go.html#8513605">golden</a></span><span class="op" id="8514118">,</span>&nbsp;<span class="ident" id="8514120"><a href="/go/printer/printer_test.go.html#8513721">res</a></span><span class="op" id="8514123">,</span>&nbsp;<span class="ident" id="8514125"><a href="/go/printer/printer_test.go.html#8513958">gld</a></span><span class="op" id="8514128">)</span><span class="op" id="8514129">;</span>&nbsp;<span class="ident" id="8514131"><a href="/go/printer/printer_test.go.html#8514092">err</a></span>&nbsp;<span class="op" id="8514135">!=</span>&nbsp;<span class="ident" id="8514138">nil</span>&nbsp;<span class="op" id="8514142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8514146"><a href="/go/printer/printer_test.go.html#8513583">t</a></span><span class="op" id="8514147">.</span><span class="ident" id="8514148">Error</span><span class="op" id="8514153">(</span><span class="ident" id="8514154"><a href="/go/printer/printer_test.go.html#8514092">err</a></span><span class="op" id="8514157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8514161">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8514169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8514173">if</span>&nbsp;<span class="ident" id="8514176"><a href="/go/printer/printer_test.go.html#8513620">mode</a></span><span class="op" id="8514180">&amp;</span><span class="ident" id="8514181"><a href="/go/printer/printer_test.go.html#8511630">idempotent</a></span>&nbsp;<span class="op" id="8514192">!=</span>&nbsp;<span class="num" id="8514195">0</span>&nbsp;<span class="op" id="8514197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8514201">//&nbsp;formatting&nbsp;golden&nbsp;must&nbsp;be&nbsp;idempotent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8514243">//&nbsp;(This&nbsp;is&nbsp;very&nbsp;difficult&nbsp;to&nbsp;achieve&nbsp;in&nbsp;general&nbsp;and&nbsp;for&nbsp;now</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8514306">//&nbsp;it&nbsp;is&nbsp;only&nbsp;checked&nbsp;for&nbsp;files&nbsp;explicitly&nbsp;marked&nbsp;as&nbsp;such.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8514368"><a href="/go/printer/printer_test.go.html#8513721">res</a></span><span class="op" id="8514371">,</span>&nbsp;<span class="ident" id="8514373"><a href="/go/printer/printer_test.go.html#8513644">err</a></span>&nbsp;<span class="op" id="8514377">=</span>&nbsp;<span class="ident" id="8514379"><a href="/go/printer/printer_test.go.html#8511810">format</a></span><span class="op" id="8514385">(</span><span class="ident" id="8514386"><a href="/go/printer/printer_test.go.html#8513958">gld</a></span><span class="op" id="8514389">,</span>&nbsp;<span class="ident" id="8514391"><a href="/go/printer/printer_test.go.html#8513620">mode</a></span><span class="op" id="8514395">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8514399">if</span>&nbsp;<span class="ident" id="8514402">err</span>&nbsp;<span class="op" id="8514406">:=</span>&nbsp;<span class="ident" id="8514409"><a href="/go/printer/printer_test.go.html#8512881">diff</a></span><span class="op" id="8514413">(</span><span class="ident" id="8514414"><a href="/go/printer/printer_test.go.html#8513605">golden</a></span><span class="op" id="8514420">,</span>&nbsp;<span class="ident" id="8514422"><a href="/go/printer/printer_test.go.html#8511323">fmt</a></span><span class="op" id="8514425">.</span><span class="ident" id="8514426">Sprintf</span><span class="op" id="8514433">(</span><span class="string" id="8514434">&#34;format(%s)&#34;</span><span class="op" id="8514446">,</span>&nbsp;<span class="ident" id="8514448"><a href="/go/printer/printer_test.go.html#8513605">golden</a></span><span class="op" id="8514454">)</span><span class="op" id="8514455">,</span>&nbsp;<span class="ident" id="8514457"><a href="/go/printer/printer_test.go.html#8513958">gld</a></span><span class="op" id="8514460">,</span>&nbsp;<span class="ident" id="8514462"><a href="/go/printer/printer_test.go.html#8513721">res</a></span><span class="op" id="8514465">)</span><span class="op" id="8514466">;</span>&nbsp;<span class="ident" id="8514468"><a href="/go/printer/printer_test.go.html#8514402">err</a></span>&nbsp;<span class="op" id="8514472">!=</span>&nbsp;<span class="ident" id="8514475">nil</span>&nbsp;<span class="op" id="8514479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8514484"><a href="/go/printer/printer_test.go.html#8513583">t</a></span><span class="op" id="8514485">.</span><span class="ident" id="8514486">Errorf</span><span class="op" id="8514492">(</span><span class="string" id="8514493">&#34;golden&nbsp;is&nbsp;not&nbsp;idempotent:&nbsp;%s&#34;</span><span class="op" id="8514523">,</span>&nbsp;<span class="ident" id="8514525"><a href="/go/printer/printer_test.go.html#8514402">err</a></span><span class="op" id="8514528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8514532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8514535">}</span><br>
<span class="lineno"></span><span class="op" id="8514537">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="keyword" id="8514540">func</span>&nbsp;<span class="ident" id="8514545">check</span><span class="op" id="8514550">(</span><span class="ident" id="8514551">t</span>&nbsp;<span class="op" id="8514553">*</span><span class="ident" id="8514554"><a href="/go/printer/printer_test.go.html#8511395">testing</a></span><span class="op" id="8514561">.</span><span class="ident" id="8514562">T</span><span class="op" id="8514563">,</span>&nbsp;<span class="ident" id="8514565">source</span><span class="op" id="8514571">,</span>&nbsp;<span class="ident" id="8514573">golden</span>&nbsp;<span class="builtintype" id="8514580">string</span><span class="op" id="8514586">,</span>&nbsp;<span class="ident" id="8514588">mode</span>&nbsp;<span class="ident" id="8514593"><a href="/go/printer/printer_test.go.html#8511564">checkMode</a></span><span class="op" id="8514602">)</span>&nbsp;<span class="op" id="8514604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8514607">//&nbsp;run&nbsp;the&nbsp;test</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8514624">cc</span>&nbsp;<span class="op" id="8514627">:=</span>&nbsp;<span class="builtinfunc" id="8514630">make</span><span class="op" id="8514634">(</span><span class="keyword" id="8514635">chan</span>&nbsp;<span class="builtintype" id="8514640">int</span><span class="op" id="8514643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8514646">go</span>&nbsp;<span class="keyword" id="8514649">func</span><span class="op" id="8514653">(</span><span class="op" id="8514654">)</span>&nbsp;<span class="op" id="8514656">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8514660"><a href="/go/printer/printer_test.go.html#8513574">runcheck</a></span><span class="op" id="8514668">(</span><span class="ident" id="8514669"><a href="/go/printer/printer_test.go.html#8514551">t</a></span><span class="op" id="8514670">,</span>&nbsp;<span class="ident" id="8514672"><a href="/go/printer/printer_test.go.html#8514565">source</a></span><span class="op" id="8514678">,</span>&nbsp;<span class="ident" id="8514680"><a href="/go/printer/printer_test.go.html#8514573">golden</a></span><span class="op" id="8514686">,</span>&nbsp;<span class="ident" id="8514688"><a href="/go/printer/printer_test.go.html#8514588">mode</a></span><span class="op" id="8514692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8514696"><a href="/go/printer/printer_test.go.html#8514624">cc</a></span>&nbsp;<span class="op" id="8514699">&lt;-</span>&nbsp;<span class="num" id="8514702">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8514705">}</span><span class="op" id="8514706">(</span><span class="op" id="8514707">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8514711">//&nbsp;wait&nbsp;with&nbsp;timeout</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8514733">select</span>&nbsp;<span class="op" id="8514740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8514743">case</span>&nbsp;<span class="op" id="8514748">&lt;-</span><span class="ident" id="8514750"><a href="/go/printer/printer_test.go.html#8511406">time</a></span><span class="op" id="8514754">.</span><span class="ident" id="8514755">After</span><span class="op" id="8514760">(</span><span class="num" id="8514761">10</span>&nbsp;<span class="op" id="8514764">*</span>&nbsp;<span class="ident" id="8514766"><a href="/go/printer/printer_test.go.html#8511406">time</a></span><span class="op" id="8514770">.</span><span class="ident" id="8514771">Second</span><span class="op" id="8514777">)</span><span class="op" id="8514778">:</span>&nbsp;<span class="comment" id="8514780">//&nbsp;plenty&nbsp;of&nbsp;a&nbsp;safety&nbsp;margin,&nbsp;even&nbsp;for&nbsp;very&nbsp;slow&nbsp;machines</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8514840">//&nbsp;test&nbsp;running&nbsp;past&nbsp;time&nbsp;out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8514872"><a href="/go/printer/printer_test.go.html#8514551">t</a></span><span class="op" id="8514873">.</span><span class="ident" id="8514874">Errorf</span><span class="op" id="8514880">(</span><span class="string" id="8514881">&#34;%s:&nbsp;running&nbsp;too&nbsp;slowly&#34;</span><span class="op" id="8514905">,</span>&nbsp;<span class="ident" id="8514907"><a href="/go/printer/printer_test.go.html#8514565">source</a></span><span class="op" id="8514913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8514916">case</span>&nbsp;<span class="op" id="8514921">&lt;-</span><span class="ident" id="8514923"><a href="/go/printer/printer_test.go.html#8514624">cc</a></span><span class="op" id="8514925">:</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8514929">//&nbsp;test&nbsp;finished&nbsp;within&nbsp;allotted&nbsp;time&nbsp;margin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8514975">}</span><br>
<span class="lineno"></span><span class="op" id="8514977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8514980">type</span>&nbsp;<span class="ident" id="8514985">entry</span>&nbsp;<span class="keyword" id="8514991">struct</span>&nbsp;<span class="op" id="8514998">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8515001">source</span><span class="op" id="8515007">,</span>&nbsp;<span class="ident" id="8515009">golden</span>&nbsp;<span class="builtintype" id="8515016">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8515024">mode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8515039"><a href="/go/printer/printer_test.go.html#8511564">checkMode</a></span><br>
<span class="lineno"></span><span class="op" id="8515049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8515052">//&nbsp;Use&nbsp;go&nbsp;test&nbsp;-update&nbsp;to&nbsp;create/update&nbsp;the&nbsp;respective&nbsp;golden&nbsp;files.</span><br>
<span class="lineno">185</span><span class="keyword" id="8515121">var</span>&nbsp;<span class="ident" id="8515125">data</span>&nbsp;<span class="op" id="8515130">=</span>&nbsp;<span class="op" id="8515132">[</span><span class="op" id="8515133">]</span><span class="ident" id="8515134"><a href="/go/printer/printer_test.go.html#8514985">entry</a></span><span class="op" id="8515139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8515142">{</span><span class="string" id="8515143">&#34;empty.input&#34;</span><span class="op" id="8515156">,</span>&nbsp;<span class="string" id="8515158">&#34;empty.golden&#34;</span><span class="op" id="8515172">,</span>&nbsp;<span class="ident" id="8515174"><a href="/go/printer/printer_test.go.html#8511630">idempotent</a></span><span class="op" id="8515184">}</span><span class="op" id="8515185">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8515188">{</span><span class="string" id="8515189">&#34;comments.input&#34;</span><span class="op" id="8515205">,</span>&nbsp;<span class="string" id="8515207">&#34;comments.golden&#34;</span><span class="op" id="8515224">,</span>&nbsp;<span class="num" id="8515226">0</span><span class="op" id="8515227">}</span><span class="op" id="8515228">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8515231">{</span><span class="string" id="8515232">&#34;comments.input&#34;</span><span class="op" id="8515248">,</span>&nbsp;<span class="string" id="8515250">&#34;comments.x&#34;</span><span class="op" id="8515262">,</span>&nbsp;<span class="ident" id="8515264"><a href="/go/printer/printer_test.go.html#8511589">export</a></span><span class="op" id="8515270">}</span><span class="op" id="8515271">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8515274">{</span><span class="string" id="8515275">&#34;comments2.input&#34;</span><span class="op" id="8515292">,</span>&nbsp;<span class="string" id="8515294">&#34;comments2.golden&#34;</span><span class="op" id="8515312">,</span>&nbsp;<span class="ident" id="8515314"><a href="/go/printer/printer_test.go.html#8511630">idempotent</a></span><span class="op" id="8515324">}</span><span class="op" id="8515325">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8515328">{</span><span class="string" id="8515329">&#34;linebreaks.input&#34;</span><span class="op" id="8515347">,</span>&nbsp;<span class="string" id="8515349">&#34;linebreaks.golden&#34;</span><span class="op" id="8515368">,</span>&nbsp;<span class="ident" id="8515370"><a href="/go/printer/printer_test.go.html#8511630">idempotent</a></span><span class="op" id="8515380">}</span><span class="op" id="8515381">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8515384">{</span><span class="string" id="8515385">&#34;expressions.input&#34;</span><span class="op" id="8515404">,</span>&nbsp;<span class="string" id="8515406">&#34;expressions.golden&#34;</span><span class="op" id="8515426">,</span>&nbsp;<span class="ident" id="8515428"><a href="/go/printer/printer_test.go.html#8511630">idempotent</a></span><span class="op" id="8515438">}</span><span class="op" id="8515439">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8515442">{</span><span class="string" id="8515443">&#34;expressions.input&#34;</span><span class="op" id="8515462">,</span>&nbsp;<span class="string" id="8515464">&#34;expressions.raw&#34;</span><span class="op" id="8515481">,</span>&nbsp;<span class="ident" id="8515483"><a href="/go/printer/printer_test.go.html#8511619">rawFormat</a></span>&nbsp;<span class="op" id="8515493">|</span>&nbsp;<span class="ident" id="8515495"><a href="/go/printer/printer_test.go.html#8511630">idempotent</a></span><span class="op" id="8515505">}</span><span class="op" id="8515506">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8515509">{</span><span class="string" id="8515510">&#34;declarations.input&#34;</span><span class="op" id="8515530">,</span>&nbsp;<span class="string" id="8515532">&#34;declarations.golden&#34;</span><span class="op" id="8515553">,</span>&nbsp;<span class="num" id="8515555">0</span><span class="op" id="8515556">}</span><span class="op" id="8515557">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8515560">{</span><span class="string" id="8515561">&#34;statements.input&#34;</span><span class="op" id="8515579">,</span>&nbsp;<span class="string" id="8515581">&#34;statements.golden&#34;</span><span class="op" id="8515600">,</span>&nbsp;<span class="num" id="8515602">0</span><span class="op" id="8515603">}</span><span class="op" id="8515604">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8515607">{</span><span class="string" id="8515608">&#34;slow.input&#34;</span><span class="op" id="8515620">,</span>&nbsp;<span class="string" id="8515622">&#34;slow.golden&#34;</span><span class="op" id="8515635">,</span>&nbsp;<span class="ident" id="8515637"><a href="/go/printer/printer_test.go.html#8511630">idempotent</a></span><span class="op" id="8515647">}</span><span class="op" id="8515648">,</span><br>
<span class="lineno"></span><span class="op" id="8515650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8515653">func</span>&nbsp;<span class="ident" id="8515658">TestFiles</span><span class="op" id="8515667">(</span><span class="ident" id="8515668">t</span>&nbsp;<span class="op" id="8515670">*</span><span class="ident" id="8515671"><a href="/go/printer/printer_test.go.html#8511395">testing</a></span><span class="op" id="8515678">.</span><span class="ident" id="8515679">T</span><span class="op" id="8515680">)</span>&nbsp;<span class="op" id="8515682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8515685">for</span>&nbsp;<span class="ident" id="8515689">_</span><span class="op" id="8515690">,</span>&nbsp;<span class="ident" id="8515692">e</span>&nbsp;<span class="op" id="8515694">:=</span>&nbsp;<span class="keyword" id="8515697">range</span>&nbsp;<span class="ident" id="8515703"><a href="/go/printer/printer_test.go.html#8515125">data</a></span>&nbsp;<span class="op" id="8515708">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8515712">source</span>&nbsp;<span class="op" id="8515719">:=</span>&nbsp;<span class="ident" id="8515722"><a href="/go/printer/printer_test.go.html#8511378">filepath</a></span><span class="op" id="8515730">.</span><span class="ident" id="8515731">Join</span><span class="op" id="8515735">(</span><span class="ident" id="8515736"><a href="/go/printer/printer_test.go.html#8511425">dataDir</a></span><span class="op" id="8515743">,</span>&nbsp;<span class="ident" id="8515745"><a href="/go/printer/printer_test.go.html#8515692">e</a></span><span class="op" id="8515746">.</span><span class="ident" id="8515747">source</span><span class="op" id="8515753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8515757">golden</span>&nbsp;<span class="op" id="8515764">:=</span>&nbsp;<span class="ident" id="8515767"><a href="/go/printer/printer_test.go.html#8511378">filepath</a></span><span class="op" id="8515775">.</span><span class="ident" id="8515776">Join</span><span class="op" id="8515780">(</span><span class="ident" id="8515781"><a href="/go/printer/printer_test.go.html#8511425">dataDir</a></span><span class="op" id="8515788">,</span>&nbsp;<span class="ident" id="8515790"><a href="/go/printer/printer_test.go.html#8515692">e</a></span><span class="op" id="8515791">.</span><span class="ident" id="8515792">golden</span><span class="op" id="8515798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8515802"><a href="/go/printer/printer_test.go.html#8514545">check</a></span><span class="op" id="8515807">(</span><span class="ident" id="8515808"><a href="/go/printer/printer_test.go.html#8515668">t</a></span><span class="op" id="8515809">,</span>&nbsp;<span class="ident" id="8515811"><a href="/go/printer/printer_test.go.html#8515712">source</a></span><span class="op" id="8515817">,</span>&nbsp;<span class="ident" id="8515819"><a href="/go/printer/printer_test.go.html#8515757">golden</a></span><span class="op" id="8515825">,</span>&nbsp;<span class="ident" id="8515827"><a href="/go/printer/printer_test.go.html#8515692">e</a></span><span class="op" id="8515828">.</span><span class="ident" id="8515829">mode</span><span class="op" id="8515833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8515837">//&nbsp;TODO(gri)&nbsp;check&nbsp;that&nbsp;golden&nbsp;is&nbsp;idempotent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8515884">//check(t,&nbsp;golden,&nbsp;golden,&nbsp;e.mode)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8515920">}</span><br>
<span class="lineno"></span><span class="op" id="8515922">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8515925">//&nbsp;TestLineComments,&nbsp;using&nbsp;a&nbsp;simple&nbsp;test&nbsp;case,&nbsp;checks&nbsp;that&nbsp;consecutive&nbsp;line</span><br>
<span class="lineno"></span><span class="comment" id="8516001">//&nbsp;comments&nbsp;are&nbsp;properly&nbsp;terminated&nbsp;with&nbsp;a&nbsp;newline&nbsp;even&nbsp;if&nbsp;the&nbsp;AST&nbsp;position</span><br>
<span class="lineno">210</span><span class="comment" id="8516077">//&nbsp;information&nbsp;is&nbsp;incorrect.</span><br>
<span class="lineno"></span><span class="comment" id="8516106">//</span><br>
<span class="lineno"></span><span class="keyword" id="8516109">func</span>&nbsp;<span class="ident" id="8516114">TestLineComments</span><span class="op" id="8516130">(</span><span class="ident" id="8516131">t</span>&nbsp;<span class="op" id="8516133">*</span><span class="ident" id="8516134"><a href="/go/printer/printer_test.go.html#8511395">testing</a></span><span class="op" id="8516141">.</span><span class="ident" id="8516142">T</span><span class="op" id="8516143">)</span>&nbsp;<span class="op" id="8516145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8516148">const</span>&nbsp;<span class="ident" id="8516154">src</span>&nbsp;<span class="op" id="8516158">=</span>&nbsp;<span class="string" id="8516160">`//&nbsp;comment&nbsp;1<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;comment&nbsp;2<br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;comment&nbsp;3<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsppackage&nbsp;main<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8516221">fset</span>&nbsp;<span class="op" id="8516226">:=</span>&nbsp;<span class="ident" id="8516229"><a href="/go/printer/printer_test.go.html#8511353">token</a></span><span class="op" id="8516234">.</span><span class="ident" id="8516235">NewFileSet</span><span class="op" id="8516245">(</span><span class="op" id="8516246">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8516249">f</span><span class="op" id="8516250">,</span>&nbsp;<span class="ident" id="8516252">err</span>&nbsp;<span class="op" id="8516256">:=</span>&nbsp;<span class="ident" id="8516259"><a href="/go/printer/printer_test.go.html#8511340">parser</a></span><span class="op" id="8516265">.</span><span class="ident" id="8516266">ParseFile</span><span class="op" id="8516275">(</span><span class="ident" id="8516276"><a href="/go/printer/printer_test.go.html#8516221">fset</a></span><span class="op" id="8516280">,</span>&nbsp;<span class="string" id="8516282">&#34;&#34;</span><span class="op" id="8516284">,</span>&nbsp;<span class="ident" id="8516286"><a href="/go/printer/printer_test.go.html#8516154">src</a></span><span class="op" id="8516289">,</span>&nbsp;<span class="ident" id="8516291"><a href="/go/printer/printer_test.go.html#8511340">parser</a></span><span class="op" id="8516297">.</span><span class="ident" id="8516298">ParseComments</span><span class="op" id="8516311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8516314">if</span>&nbsp;<span class="ident" id="8516317"><a href="/go/printer/printer_test.go.html#8516252">err</a></span>&nbsp;<span class="op" id="8516321">!=</span>&nbsp;<span class="ident" id="8516324">nil</span>&nbsp;<span class="op" id="8516328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8516332">panic</span><span class="op" id="8516337">(</span><span class="ident" id="8516338"><a href="/go/printer/printer_test.go.html#8516252">err</a></span><span class="op" id="8516341">)</span>&nbsp;<span class="comment" id="8516343">//&nbsp;error&nbsp;in&nbsp;test</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8516361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8516365">var</span>&nbsp;<span class="ident" id="8516369">buf</span>&nbsp;<span class="ident" id="8516373"><a href="/go/printer/printer_test.go.html#8511296">bytes</a></span><span class="op" id="8516378">.</span><span class="ident" id="8516379">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8516387"><a href="/go/printer/printer_test.go.html#8516221">fset</a></span>&nbsp;<span class="op" id="8516392">=</span>&nbsp;<span class="ident" id="8516394"><a href="/go/printer/printer_test.go.html#8511353">token</a></span><span class="op" id="8516399">.</span><span class="ident" id="8516400">NewFileSet</span><span class="op" id="8516410">(</span><span class="op" id="8516411">)</span>&nbsp;<span class="comment" id="8516413">//&nbsp;use&nbsp;the&nbsp;wrong&nbsp;file&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8516440"><a href="/go/printer/printer.go.html#5361851">Fprint</a></span><span class="op" id="8516446">(</span><span class="op" id="8516447">&amp;</span><span class="ident" id="8516448"><a href="/go/printer/printer_test.go.html#8516369">buf</a></span><span class="op" id="8516451">,</span>&nbsp;<span class="ident" id="8516453"><a href="/go/printer/printer_test.go.html#8516221">fset</a></span><span class="op" id="8516457">,</span>&nbsp;<span class="ident" id="8516459"><a href="/go/printer/printer_test.go.html#8516249">f</a></span><span class="op" id="8516460">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8516464">nlines</span>&nbsp;<span class="op" id="8516471">:=</span>&nbsp;<span class="num" id="8516474">0</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8516477">for</span>&nbsp;<span class="ident" id="8516481">_</span><span class="op" id="8516482">,</span>&nbsp;<span class="ident" id="8516484">ch</span>&nbsp;<span class="op" id="8516487">:=</span>&nbsp;<span class="keyword" id="8516490">range</span>&nbsp;<span class="ident" id="8516496"><a href="/go/printer/printer_test.go.html#8516369">buf</a></span><span class="op" id="8516499">.</span><span class="ident" id="8516500">Bytes</span><span class="op" id="8516505">(</span><span class="op" id="8516506">)</span>&nbsp;<span class="op" id="8516508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8516512">if</span>&nbsp;<span class="ident" id="8516515"><a href="/go/printer/printer_test.go.html#8516484">ch</a></span>&nbsp;<span class="op" id="8516518">==</span>&nbsp;<span class="string" id="8516521">&#39;\n&#39;</span>&nbsp;<span class="op" id="8516526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8516531"><a href="/go/printer/printer_test.go.html#8516464">nlines</a></span><span class="op" id="8516537">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8516542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8516545">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8516549">const</span>&nbsp;<span class="ident" id="8516555">expected</span>&nbsp;<span class="op" id="8516564">=</span>&nbsp;<span class="num" id="8516566">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8516569">if</span>&nbsp;<span class="ident" id="8516572"><a href="/go/printer/printer_test.go.html#8516464">nlines</a></span>&nbsp;<span class="op" id="8516579">&lt;</span>&nbsp;<span class="ident" id="8516581"><a href="/go/printer/printer_test.go.html#8516555">expected</a></span>&nbsp;<span class="op" id="8516590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8516594"><a href="/go/printer/printer_test.go.html#8516131">t</a></span><span class="op" id="8516595">.</span><span class="ident" id="8516596">Errorf</span><span class="op" id="8516602">(</span><span class="string" id="8516603">&#34;got&nbsp;%d,&nbsp;expected&nbsp;%d\n&#34;</span><span class="op" id="8516626">,</span>&nbsp;<span class="ident" id="8516628"><a href="/go/printer/printer_test.go.html#8516464">nlines</a></span><span class="op" id="8516634">,</span>&nbsp;<span class="ident" id="8516636"><a href="/go/printer/printer_test.go.html#8516555">expected</a></span><span class="op" id="8516644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8516648"><a href="/go/printer/printer_test.go.html#8516131">t</a></span><span class="op" id="8516649">.</span><span class="ident" id="8516650">Errorf</span><span class="op" id="8516656">(</span><span class="string" id="8516657">&#34;result:\n%s&#34;</span><span class="op" id="8516670">,</span>&nbsp;<span class="ident" id="8516672"><a href="/go/printer/printer_test.go.html#8516369">buf</a></span><span class="op" id="8516675">.</span><span class="ident" id="8516676">Bytes</span><span class="op" id="8516681">(</span><span class="op" id="8516682">)</span><span class="op" id="8516683">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8516686">}</span><br>
<span class="lineno"></span><span class="op" id="8516688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8516691">//&nbsp;Verify&nbsp;that&nbsp;the&nbsp;printer&nbsp;can&nbsp;be&nbsp;invoked&nbsp;during&nbsp;initialization.</span><br>
<span class="lineno"></span><span class="keyword" id="8516756">func</span>&nbsp;<span class="ident" id="8516761">init</span><span class="op" id="8516765">(</span><span class="op" id="8516766">)</span>&nbsp;<span class="op" id="8516768">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8516771">const</span>&nbsp;<span class="ident" id="8516777">name</span>&nbsp;<span class="op" id="8516782">=</span>&nbsp;<span class="string" id="8516784">&#34;foobar&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8516794">var</span>&nbsp;<span class="ident" id="8516798">buf</span>&nbsp;<span class="ident" id="8516802"><a href="/go/printer/printer_test.go.html#8511296">bytes</a></span><span class="op" id="8516807">.</span><span class="ident" id="8516808">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8516816">if</span>&nbsp;<span class="ident" id="8516819">err</span>&nbsp;<span class="op" id="8516823">:=</span>&nbsp;<span class="ident" id="8516826"><a href="/go/printer/printer.go.html#5361851">Fprint</a></span><span class="op" id="8516832">(</span><span class="op" id="8516833">&amp;</span><span class="ident" id="8516834"><a href="/go/printer/printer_test.go.html#8516798">buf</a></span><span class="op" id="8516837">,</span>&nbsp;<span class="ident" id="8516839"><a href="/go/printer/printer_test.go.html#8511532">fset</a></span><span class="op" id="8516843">,</span>&nbsp;<span class="op" id="8516845">&amp;</span><span class="ident" id="8516846"><a href="/go/printer/printer_test.go.html#8511330">ast</a></span><span class="op" id="8516849">.</span><span class="ident" id="8516850">Ident</span><span class="op" id="8516855">{</span><span class="ident" id="8516856">Name</span><span class="op" id="8516860">:</span>&nbsp;<span class="ident" id="8516862"><a href="/go/printer/printer_test.go.html#8516777">name</a></span><span class="op" id="8516866">}</span><span class="op" id="8516867">)</span><span class="op" id="8516868">;</span>&nbsp;<span class="ident" id="8516870"><a href="/go/printer/printer_test.go.html#8516819">err</a></span>&nbsp;<span class="op" id="8516874">!=</span>&nbsp;<span class="ident" id="8516877">nil</span>&nbsp;<span class="op" id="8516881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8516885">panic</span><span class="op" id="8516890">(</span><span class="ident" id="8516891"><a href="/go/printer/printer_test.go.html#8516819">err</a></span><span class="op" id="8516894">)</span>&nbsp;<span class="comment" id="8516896">//&nbsp;error&nbsp;in&nbsp;test</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8516914">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8516917">//&nbsp;in&nbsp;debug&nbsp;mode,&nbsp;the&nbsp;result&nbsp;contains&nbsp;additional&nbsp;information;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8516980">//&nbsp;ignore&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8516994">if</span>&nbsp;<span class="ident" id="8516997">s</span>&nbsp;<span class="op" id="8516999">:=</span>&nbsp;<span class="ident" id="8517002"><a href="/go/printer/printer_test.go.html#8516798">buf</a></span><span class="op" id="8517005">.</span><span class="ident" id="8517006">String</span><span class="op" id="8517012">(</span><span class="op" id="8517013">)</span><span class="op" id="8517014">;</span>&nbsp;<span class="op" id="8517016">!</span><span class="ident" id="8517017"><a href="/go/printer/printer.go.html#5324790">debug</a></span>&nbsp;<span class="op" id="8517023">&amp;&amp;</span>&nbsp;<span class="ident" id="8517026"><a href="/go/printer/printer_test.go.html#8516997">s</a></span>&nbsp;<span class="op" id="8517028">!=</span>&nbsp;<span class="ident" id="8517031"><a href="/go/printer/printer_test.go.html#8516777">name</a></span>&nbsp;<span class="op" id="8517036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8517040">panic</span><span class="op" id="8517045">(</span><span class="string" id="8517046">&#34;got&nbsp;&#34;</span>&nbsp;<span class="op" id="8517053">+</span>&nbsp;<span class="ident" id="8517055"><a href="/go/printer/printer_test.go.html#8516997">s</a></span>&nbsp;<span class="op" id="8517057">+</span>&nbsp;<span class="string" id="8517059">&#34;,&nbsp;want&nbsp;&#34;</span>&nbsp;<span class="op" id="8517069">+</span>&nbsp;<span class="ident" id="8517071"><a href="/go/printer/printer_test.go.html#8516777">name</a></span><span class="op" id="8517075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8517078">}</span><br>
<span class="lineno">255</span><span class="op" id="8517080">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8517083">//&nbsp;Verify&nbsp;that&nbsp;the&nbsp;printer&nbsp;doesn&#39;t&nbsp;crash&nbsp;if&nbsp;the&nbsp;AST&nbsp;contains&nbsp;BadXXX&nbsp;nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="8517158">func</span>&nbsp;<span class="ident" id="8517163">TestBadNodes</span><span class="op" id="8517175">(</span><span class="ident" id="8517176">t</span>&nbsp;<span class="op" id="8517178">*</span><span class="ident" id="8517179"><a href="/go/printer/printer_test.go.html#8511395">testing</a></span><span class="op" id="8517186">.</span><span class="ident" id="8517187">T</span><span class="op" id="8517188">)</span>&nbsp;<span class="op" id="8517190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8517193">const</span>&nbsp;<span class="ident" id="8517199">src</span>&nbsp;<span class="op" id="8517203">=</span>&nbsp;<span class="string" id="8517205">&#34;package&nbsp;p\n(&#34;</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8517221">const</span>&nbsp;<span class="ident" id="8517227">res</span>&nbsp;<span class="op" id="8517231">=</span>&nbsp;<span class="string" id="8517233">&#34;package&nbsp;p\nBadDecl\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517257">f</span><span class="op" id="8517258">,</span>&nbsp;<span class="ident" id="8517260">err</span>&nbsp;<span class="op" id="8517264">:=</span>&nbsp;<span class="ident" id="8517267"><a href="/go/printer/printer_test.go.html#8511340">parser</a></span><span class="op" id="8517273">.</span><span class="ident" id="8517274">ParseFile</span><span class="op" id="8517283">(</span><span class="ident" id="8517284"><a href="/go/printer/printer_test.go.html#8511532">fset</a></span><span class="op" id="8517288">,</span>&nbsp;<span class="string" id="8517290">&#34;&#34;</span><span class="op" id="8517292">,</span>&nbsp;<span class="ident" id="8517294"><a href="/go/printer/printer_test.go.html#8517199">src</a></span><span class="op" id="8517297">,</span>&nbsp;<span class="ident" id="8517299"><a href="/go/printer/printer_test.go.html#8511340">parser</a></span><span class="op" id="8517305">.</span><span class="ident" id="8517306">ParseComments</span><span class="op" id="8517319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8517322">if</span>&nbsp;<span class="ident" id="8517325"><a href="/go/printer/printer_test.go.html#8517260">err</a></span>&nbsp;<span class="op" id="8517329">==</span>&nbsp;<span class="ident" id="8517332">nil</span>&nbsp;<span class="op" id="8517336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517340"><a href="/go/printer/printer_test.go.html#8517176">t</a></span><span class="op" id="8517341">.</span><span class="ident" id="8517342">Error</span><span class="op" id="8517347">(</span><span class="string" id="8517348">&#34;expected&nbsp;illegal&nbsp;program&#34;</span><span class="op" id="8517374">)</span>&nbsp;<span class="comment" id="8517376">//&nbsp;error&nbsp;in&nbsp;test</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8517394">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8517397">var</span>&nbsp;<span class="ident" id="8517401">buf</span>&nbsp;<span class="ident" id="8517405"><a href="/go/printer/printer_test.go.html#8511296">bytes</a></span><span class="op" id="8517410">.</span><span class="ident" id="8517411">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517419"><a href="/go/printer/printer.go.html#5361851">Fprint</a></span><span class="op" id="8517425">(</span><span class="op" id="8517426">&amp;</span><span class="ident" id="8517427"><a href="/go/printer/printer_test.go.html#8517401">buf</a></span><span class="op" id="8517430">,</span>&nbsp;<span class="ident" id="8517432"><a href="/go/printer/printer_test.go.html#8511532">fset</a></span><span class="op" id="8517436">,</span>&nbsp;<span class="ident" id="8517438"><a href="/go/printer/printer_test.go.html#8517257">f</a></span><span class="op" id="8517439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8517442">if</span>&nbsp;<span class="ident" id="8517445"><a href="/go/printer/printer_test.go.html#8517401">buf</a></span><span class="op" id="8517448">.</span><span class="ident" id="8517449">String</span><span class="op" id="8517455">(</span><span class="op" id="8517456">)</span>&nbsp;<span class="op" id="8517458">!=</span>&nbsp;<span class="ident" id="8517461"><a href="/go/printer/printer_test.go.html#8517227">res</a></span>&nbsp;<span class="op" id="8517465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517469"><a href="/go/printer/printer_test.go.html#8517176">t</a></span><span class="op" id="8517470">.</span><span class="ident" id="8517471">Errorf</span><span class="op" id="8517477">(</span><span class="string" id="8517478">&#34;got&nbsp;%q,&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="8517499">,</span>&nbsp;<span class="ident" id="8517501"><a href="/go/printer/printer_test.go.html#8517401">buf</a></span><span class="op" id="8517504">.</span><span class="ident" id="8517505">String</span><span class="op" id="8517511">(</span><span class="op" id="8517512">)</span><span class="op" id="8517513">,</span>&nbsp;<span class="ident" id="8517515"><a href="/go/printer/printer_test.go.html#8517227">res</a></span><span class="op" id="8517518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8517521">}</span><br>
<span class="lineno">270</span><span class="op" id="8517523">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8517526">//&nbsp;testComment&nbsp;verifies&nbsp;that&nbsp;f&nbsp;can&nbsp;be&nbsp;parsed&nbsp;again&nbsp;after&nbsp;printing&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="8517595">//&nbsp;with&nbsp;its&nbsp;first&nbsp;comment&nbsp;set&nbsp;to&nbsp;comment&nbsp;at&nbsp;any&nbsp;possible&nbsp;source&nbsp;offset.</span><br>
<span class="lineno"></span><span class="keyword" id="8517667">func</span>&nbsp;<span class="ident" id="8517672">testComment</span><span class="op" id="8517683">(</span><span class="ident" id="8517684">t</span>&nbsp;<span class="op" id="8517686">*</span><span class="ident" id="8517687"><a href="/go/printer/printer_test.go.html#8511395">testing</a></span><span class="op" id="8517694">.</span><span class="ident" id="8517695">T</span><span class="op" id="8517696">,</span>&nbsp;<span class="ident" id="8517698">f</span>&nbsp;<span class="op" id="8517700">*</span><span class="ident" id="8517701"><a href="/go/printer/printer_test.go.html#8511330">ast</a></span><span class="op" id="8517704">.</span><span class="ident" id="8517705">File</span><span class="op" id="8517709">,</span>&nbsp;<span class="ident" id="8517711">srclen</span>&nbsp;<span class="builtintype" id="8517718">int</span><span class="op" id="8517721">,</span>&nbsp;<span class="ident" id="8517723">comment</span>&nbsp;<span class="op" id="8517731">*</span><span class="ident" id="8517732"><a href="/go/printer/printer_test.go.html#8511330">ast</a></span><span class="op" id="8517735">.</span><span class="ident" id="8517736">Comment</span><span class="op" id="8517743">)</span>&nbsp;<span class="op" id="8517745">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517748"><a href="/go/printer/printer_test.go.html#8517698">f</a></span><span class="op" id="8517749">.</span><span class="ident" id="8517750">Comments</span><span class="op" id="8517758">[</span><span class="num" id="8517759">0</span><span class="op" id="8517760">]</span><span class="op" id="8517761">.</span><span class="ident" id="8517762">List</span><span class="op" id="8517766">[</span><span class="num" id="8517767">0</span><span class="op" id="8517768">]</span>&nbsp;<span class="op" id="8517770">=</span>&nbsp;<span class="ident" id="8517772"><a href="/go/printer/printer_test.go.html#8517723">comment</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8517781">var</span>&nbsp;<span class="ident" id="8517785">buf</span>&nbsp;<span class="ident" id="8517789"><a href="/go/printer/printer_test.go.html#8511296">bytes</a></span><span class="op" id="8517794">.</span><span class="ident" id="8517795">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8517803">for</span>&nbsp;<span class="ident" id="8517807">offs</span>&nbsp;<span class="op" id="8517812">:=</span>&nbsp;<span class="num" id="8517815">0</span><span class="op" id="8517816">;</span>&nbsp;<span class="ident" id="8517818"><a href="/go/printer/printer_test.go.html#8517807">offs</a></span>&nbsp;<span class="op" id="8517823">&lt;=</span>&nbsp;<span class="ident" id="8517826"><a href="/go/printer/printer_test.go.html#8517711">srclen</a></span><span class="op" id="8517832">;</span>&nbsp;<span class="ident" id="8517834"><a href="/go/printer/printer_test.go.html#8517807">offs</a></span><span class="op" id="8517838">++</span>&nbsp;<span class="op" id="8517841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517845"><a href="/go/printer/printer_test.go.html#8517785">buf</a></span><span class="op" id="8517848">.</span><span class="ident" id="8517849">Reset</span><span class="op" id="8517854">(</span><span class="op" id="8517855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8517859">//&nbsp;Printing&nbsp;f&nbsp;should&nbsp;result&nbsp;in&nbsp;a&nbsp;correct&nbsp;program&nbsp;no</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8517913">//&nbsp;matter&nbsp;what&nbsp;the&nbsp;(incorrect)&nbsp;comment&nbsp;position&nbsp;is.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8517967">if</span>&nbsp;<span class="ident" id="8517970">err</span>&nbsp;<span class="op" id="8517974">:=</span>&nbsp;<span class="ident" id="8517977"><a href="/go/printer/printer.go.html#5361851">Fprint</a></span><span class="op" id="8517983">(</span><span class="op" id="8517984">&amp;</span><span class="ident" id="8517985"><a href="/go/printer/printer_test.go.html#8517785">buf</a></span><span class="op" id="8517988">,</span>&nbsp;<span class="ident" id="8517990"><a href="/go/printer/printer_test.go.html#8511532">fset</a></span><span class="op" id="8517994">,</span>&nbsp;<span class="ident" id="8517996"><a href="/go/printer/printer_test.go.html#8517698">f</a></span><span class="op" id="8517997">)</span><span class="op" id="8517998">;</span>&nbsp;<span class="ident" id="8518000"><a href="/go/printer/printer_test.go.html#8517970">err</a></span>&nbsp;<span class="op" id="8518004">!=</span>&nbsp;<span class="ident" id="8518007">nil</span>&nbsp;<span class="op" id="8518011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518016"><a href="/go/printer/printer_test.go.html#8517684">t</a></span><span class="op" id="8518017">.</span><span class="ident" id="8518018">Error</span><span class="op" id="8518023">(</span><span class="ident" id="8518024"><a href="/go/printer/printer_test.go.html#8517970">err</a></span><span class="op" id="8518027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8518031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8518035">if</span>&nbsp;<span class="ident" id="8518038">_</span><span class="op" id="8518039">,</span>&nbsp;<span class="ident" id="8518041">err</span>&nbsp;<span class="op" id="8518045">:=</span>&nbsp;<span class="ident" id="8518048"><a href="/go/printer/printer_test.go.html#8511340">parser</a></span><span class="op" id="8518054">.</span><span class="ident" id="8518055">ParseFile</span><span class="op" id="8518064">(</span><span class="ident" id="8518065"><a href="/go/printer/printer_test.go.html#8511532">fset</a></span><span class="op" id="8518069">,</span>&nbsp;<span class="string" id="8518071">&#34;&#34;</span><span class="op" id="8518073">,</span>&nbsp;<span class="ident" id="8518075"><a href="/go/printer/printer_test.go.html#8517785">buf</a></span><span class="op" id="8518078">.</span><span class="ident" id="8518079">Bytes</span><span class="op" id="8518084">(</span><span class="op" id="8518085">)</span><span class="op" id="8518086">,</span>&nbsp;<span class="num" id="8518088">0</span><span class="op" id="8518089">)</span><span class="op" id="8518090">;</span>&nbsp;<span class="ident" id="8518092"><a href="/go/printer/printer_test.go.html#8518041">err</a></span>&nbsp;<span class="op" id="8518096">!=</span>&nbsp;<span class="ident" id="8518099">nil</span>&nbsp;<span class="op" id="8518103">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518108"><a href="/go/printer/printer_test.go.html#8517684">t</a></span><span class="op" id="8518109">.</span><span class="ident" id="8518110">Fatalf</span><span class="op" id="8518116">(</span><span class="string" id="8518117">&#34;incorrect&nbsp;program&nbsp;for&nbsp;pos&nbsp;=&nbsp;%d:\n%s&#34;</span><span class="op" id="8518154">,</span>&nbsp;<span class="ident" id="8518156"><a href="/go/printer/printer_test.go.html#8517723">comment</a></span><span class="op" id="8518163">.</span><span class="ident" id="8518164">Slash</span><span class="op" id="8518169">,</span>&nbsp;<span class="ident" id="8518171"><a href="/go/printer/printer_test.go.html#8517785">buf</a></span><span class="op" id="8518174">.</span><span class="ident" id="8518175">String</span><span class="op" id="8518181">(</span><span class="op" id="8518182">)</span><span class="op" id="8518183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8518187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8518191">//&nbsp;Position&nbsp;information&nbsp;is&nbsp;just&nbsp;an&nbsp;offset.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8518236">//&nbsp;Move&nbsp;comment&nbsp;one&nbsp;byte&nbsp;down&nbsp;in&nbsp;the&nbsp;source.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518283"><a href="/go/printer/printer_test.go.html#8517723">comment</a></span><span class="op" id="8518290">.</span><span class="ident" id="8518291">Slash</span><span class="op" id="8518296">++</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8518300">}</span><br>
<span class="lineno"></span><span class="op" id="8518302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8518305">//&nbsp;Verify&nbsp;that&nbsp;the&nbsp;printer&nbsp;produces&nbsp;a&nbsp;correct&nbsp;program</span><br>
<span class="lineno"></span><span class="comment" id="8518359">//&nbsp;even&nbsp;if&nbsp;the&nbsp;position&nbsp;information&nbsp;of&nbsp;comments&nbsp;introducing&nbsp;newlines</span><br>
<span class="lineno">295</span><span class="comment" id="8518428">//&nbsp;is&nbsp;incorrect.</span><br>
<span class="lineno"></span><span class="keyword" id="8518445">func</span>&nbsp;<span class="ident" id="8518450">TestBadComments</span><span class="op" id="8518465">(</span><span class="ident" id="8518466">t</span>&nbsp;<span class="op" id="8518468">*</span><span class="ident" id="8518469"><a href="/go/printer/printer_test.go.html#8511395">testing</a></span><span class="op" id="8518476">.</span><span class="ident" id="8518477">T</span><span class="op" id="8518478">)</span>&nbsp;<span class="op" id="8518480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8518483">const</span>&nbsp;<span class="ident" id="8518489">src</span>&nbsp;<span class="op" id="8518493">=</span>&nbsp;<span class="string" id="8518495">`<br>
<span class="lineno"></span>//&nbsp;first&nbsp;comment&nbsp;-&nbsp;text&nbsp;and&nbsp;position&nbsp;changed&nbsp;by&nbsp;test<br>
<span class="lineno"></span>package&nbsp;p<br>
<span class="lineno">300</span>import&nbsp;&#34;fmt&#34;<br>
<span class="lineno"></span>const&nbsp;pi&nbsp;=&nbsp;3.14&nbsp;//&nbsp;rough&nbsp;circle<br>
<span class="lineno"></span>var&nbsp;(<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspx,&nbsp;y,&nbsp;z&nbsp;int&nbsp;=&nbsp;1,&nbsp;2,&nbsp;3<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspu,&nbsp;v&nbsp;float64<br>
<span class="lineno">305</span>)<br>
<span class="lineno"></span>func&nbsp;fibo(n&nbsp;int)&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspif&nbsp;n&nbsp;&lt;&nbsp;2&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;n&nbsp;/*&nbsp;seed&nbsp;values&nbsp;*/<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp}<br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;fibo(n-1)&nbsp;+&nbsp;fibo(n-2)<br>
<span class="lineno"></span>}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518749">f</span><span class="op" id="8518750">,</span>&nbsp;<span class="ident" id="8518752">err</span>&nbsp;<span class="op" id="8518756">:=</span>&nbsp;<span class="ident" id="8518759"><a href="/go/printer/printer_test.go.html#8511340">parser</a></span><span class="op" id="8518765">.</span><span class="ident" id="8518766">ParseFile</span><span class="op" id="8518775">(</span><span class="ident" id="8518776"><a href="/go/printer/printer_test.go.html#8511532">fset</a></span><span class="op" id="8518780">,</span>&nbsp;<span class="string" id="8518782">&#34;&#34;</span><span class="op" id="8518784">,</span>&nbsp;<span class="ident" id="8518786"><a href="/go/printer/printer_test.go.html#8518489">src</a></span><span class="op" id="8518789">,</span>&nbsp;<span class="ident" id="8518791"><a href="/go/printer/printer_test.go.html#8511340">parser</a></span><span class="op" id="8518797">.</span><span class="ident" id="8518798">ParseComments</span><span class="op" id="8518811">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8518814">if</span>&nbsp;<span class="ident" id="8518817"><a href="/go/printer/printer_test.go.html#8518752">err</a></span>&nbsp;<span class="op" id="8518821">!=</span>&nbsp;<span class="ident" id="8518824">nil</span>&nbsp;<span class="op" id="8518828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518832"><a href="/go/printer/printer_test.go.html#8518466">t</a></span><span class="op" id="8518833">.</span><span class="ident" id="8518834">Error</span><span class="op" id="8518839">(</span><span class="ident" id="8518840"><a href="/go/printer/printer_test.go.html#8518752">err</a></span><span class="op" id="8518843">)</span>&nbsp;<span class="comment" id="8518845">//&nbsp;error&nbsp;in&nbsp;test</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8518863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518867">comment</span>&nbsp;<span class="op" id="8518875">:=</span>&nbsp;<span class="ident" id="8518878"><a href="/go/printer/printer_test.go.html#8518749">f</a></span><span class="op" id="8518879">.</span><span class="ident" id="8518880">Comments</span><span class="op" id="8518888">[</span><span class="num" id="8518889">0</span><span class="op" id="8518890">]</span><span class="op" id="8518891">.</span><span class="ident" id="8518892">List</span><span class="op" id="8518896">[</span><span class="num" id="8518897">0</span><span class="op" id="8518898">]</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518901">pos</span>&nbsp;<span class="op" id="8518905">:=</span>&nbsp;<span class="ident" id="8518908"><a href="/go/printer/printer_test.go.html#8518867">comment</a></span><span class="op" id="8518915">.</span><span class="ident" id="8518916">Pos</span><span class="op" id="8518919">(</span><span class="op" id="8518920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8518923">if</span>&nbsp;<span class="ident" id="8518926"><a href="/go/printer/printer_test.go.html#8511532">fset</a></span><span class="op" id="8518930">.</span><span class="ident" id="8518931">Position</span><span class="op" id="8518939">(</span><span class="ident" id="8518940"><a href="/go/printer/printer_test.go.html#8518901">pos</a></span><span class="op" id="8518943">)</span><span class="op" id="8518944">.</span><span class="ident" id="8518945">Offset</span>&nbsp;<span class="op" id="8518952">!=</span>&nbsp;<span class="num" id="8518955">1</span>&nbsp;<span class="op" id="8518957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518961"><a href="/go/printer/printer_test.go.html#8518466">t</a></span><span class="op" id="8518962">.</span><span class="ident" id="8518963">Error</span><span class="op" id="8518968">(</span><span class="string" id="8518969">&#34;expected&nbsp;offset&nbsp;1&#34;</span><span class="op" id="8518988">)</span>&nbsp;<span class="comment" id="8518990">//&nbsp;error&nbsp;in&nbsp;test</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8519008">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519012"><a href="/go/printer/printer_test.go.html#8517672">testComment</a></span><span class="op" id="8519023">(</span><span class="ident" id="8519024"><a href="/go/printer/printer_test.go.html#8518466">t</a></span><span class="op" id="8519025">,</span>&nbsp;<span class="ident" id="8519027"><a href="/go/printer/printer_test.go.html#8518749">f</a></span><span class="op" id="8519028">,</span>&nbsp;<span class="builtinfunc" id="8519030">len</span><span class="op" id="8519033">(</span><span class="ident" id="8519034"><a href="/go/printer/printer_test.go.html#8518489">src</a></span><span class="op" id="8519037">)</span><span class="op" id="8519038">,</span>&nbsp;<span class="op" id="8519040">&amp;</span><span class="ident" id="8519041"><a href="/go/printer/printer_test.go.html#8511330">ast</a></span><span class="op" id="8519044">.</span><span class="ident" id="8519045">Comment</span><span class="op" id="8519052">{</span><span class="ident" id="8519053">Slash</span><span class="op" id="8519058">:</span>&nbsp;<span class="ident" id="8519060"><a href="/go/printer/printer_test.go.html#8518901">pos</a></span><span class="op" id="8519063">,</span>&nbsp;<span class="ident" id="8519065">Text</span><span class="op" id="8519069">:</span>&nbsp;<span class="string" id="8519071">&#34;//-style&nbsp;comment&#34;</span><span class="op" id="8519089">}</span><span class="op" id="8519090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519093"><a href="/go/printer/printer_test.go.html#8517672">testComment</a></span><span class="op" id="8519104">(</span><span class="ident" id="8519105"><a href="/go/printer/printer_test.go.html#8518466">t</a></span><span class="op" id="8519106">,</span>&nbsp;<span class="ident" id="8519108"><a href="/go/printer/printer_test.go.html#8518749">f</a></span><span class="op" id="8519109">,</span>&nbsp;<span class="builtinfunc" id="8519111">len</span><span class="op" id="8519114">(</span><span class="ident" id="8519115"><a href="/go/printer/printer_test.go.html#8518489">src</a></span><span class="op" id="8519118">)</span><span class="op" id="8519119">,</span>&nbsp;<span class="op" id="8519121">&amp;</span><span class="ident" id="8519122"><a href="/go/printer/printer_test.go.html#8511330">ast</a></span><span class="op" id="8519125">.</span><span class="ident" id="8519126">Comment</span><span class="op" id="8519133">{</span><span class="ident" id="8519134">Slash</span><span class="op" id="8519139">:</span>&nbsp;<span class="ident" id="8519141"><a href="/go/printer/printer_test.go.html#8518901">pos</a></span><span class="op" id="8519144">,</span>&nbsp;<span class="ident" id="8519146">Text</span><span class="op" id="8519150">:</span>&nbsp;<span class="string" id="8519152">&#34;/*-style&nbsp;comment&nbsp;*/&#34;</span><span class="op" id="8519173">}</span><span class="op" id="8519174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519177"><a href="/go/printer/printer_test.go.html#8517672">testComment</a></span><span class="op" id="8519188">(</span><span class="ident" id="8519189"><a href="/go/printer/printer_test.go.html#8518466">t</a></span><span class="op" id="8519190">,</span>&nbsp;<span class="ident" id="8519192"><a href="/go/printer/printer_test.go.html#8518749">f</a></span><span class="op" id="8519193">,</span>&nbsp;<span class="builtinfunc" id="8519195">len</span><span class="op" id="8519198">(</span><span class="ident" id="8519199"><a href="/go/printer/printer_test.go.html#8518489">src</a></span><span class="op" id="8519202">)</span><span class="op" id="8519203">,</span>&nbsp;<span class="op" id="8519205">&amp;</span><span class="ident" id="8519206"><a href="/go/printer/printer_test.go.html#8511330">ast</a></span><span class="op" id="8519209">.</span><span class="ident" id="8519210">Comment</span><span class="op" id="8519217">{</span><span class="ident" id="8519218">Slash</span><span class="op" id="8519223">:</span>&nbsp;<span class="ident" id="8519225"><a href="/go/printer/printer_test.go.html#8518901">pos</a></span><span class="op" id="8519228">,</span>&nbsp;<span class="ident" id="8519230">Text</span><span class="op" id="8519234">:</span>&nbsp;<span class="string" id="8519236">&#34;/*-style&nbsp;\n&nbsp;comment&nbsp;*/&#34;</span><span class="op" id="8519260">}</span><span class="op" id="8519261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519264"><a href="/go/printer/printer_test.go.html#8517672">testComment</a></span><span class="op" id="8519275">(</span><span class="ident" id="8519276"><a href="/go/printer/printer_test.go.html#8518466">t</a></span><span class="op" id="8519277">,</span>&nbsp;<span class="ident" id="8519279"><a href="/go/printer/printer_test.go.html#8518749">f</a></span><span class="op" id="8519280">,</span>&nbsp;<span class="builtinfunc" id="8519282">len</span><span class="op" id="8519285">(</span><span class="ident" id="8519286"><a href="/go/printer/printer_test.go.html#8518489">src</a></span><span class="op" id="8519289">)</span><span class="op" id="8519290">,</span>&nbsp;<span class="op" id="8519292">&amp;</span><span class="ident" id="8519293"><a href="/go/printer/printer_test.go.html#8511330">ast</a></span><span class="op" id="8519296">.</span><span class="ident" id="8519297">Comment</span><span class="op" id="8519304">{</span><span class="ident" id="8519305">Slash</span><span class="op" id="8519310">:</span>&nbsp;<span class="ident" id="8519312"><a href="/go/printer/printer_test.go.html#8518901">pos</a></span><span class="op" id="8519315">,</span>&nbsp;<span class="ident" id="8519317">Text</span><span class="op" id="8519321">:</span>&nbsp;<span class="string" id="8519323">&#34;/*-style&nbsp;comment&nbsp;\n\n\n&nbsp;*/&#34;</span><span class="op" id="8519351">}</span><span class="op" id="8519352">)</span><br>
<span class="lineno"></span><span class="op" id="8519354">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="keyword" id="8519357">type</span>&nbsp;<span class="ident" id="8519362">visitor</span>&nbsp;<span class="keyword" id="8519370">chan</span>&nbsp;<span class="op" id="8519375">*</span><span class="ident" id="8519376"><a href="/go/printer/printer_test.go.html#8511330">ast</a></span><span class="op" id="8519379">.</span><span class="ident" id="8519380">Ident</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8519387">func</span>&nbsp;<span class="op" id="8519392">(</span><span class="ident" id="8519393">v</span>&nbsp;<span class="ident" id="8519395"><a href="/go/printer/printer_test.go.html#8519362">visitor</a></span><span class="op" id="8519402">)</span>&nbsp;<span class="ident" id="8519404">Visit</span><span class="op" id="8519409">(</span><span class="ident" id="8519410">n</span>&nbsp;<span class="ident" id="8519412"><a href="/go/printer/printer_test.go.html#8511330">ast</a></span><span class="op" id="8519415">.</span><span class="ident" id="8519416">Node</span><span class="op" id="8519420">)</span>&nbsp;<span class="op" id="8519422">(</span><span class="ident" id="8519423">w</span>&nbsp;<span class="ident" id="8519425"><a href="/go/printer/printer_test.go.html#8511330">ast</a></span><span class="op" id="8519428">.</span><span class="ident" id="8519429">Visitor</span><span class="op" id="8519436">)</span>&nbsp;<span class="op" id="8519438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8519441">if</span>&nbsp;<span class="ident" id="8519444">ident</span><span class="op" id="8519449">,</span>&nbsp;<span class="ident" id="8519451">ok</span>&nbsp;<span class="op" id="8519454">:=</span>&nbsp;<span class="ident" id="8519457"><a href="/go/printer/printer_test.go.html#8519410">n</a></span><span class="op" id="8519458">.</span><span class="op" id="8519459">(</span><span class="op" id="8519460">*</span><span class="ident" id="8519461"><a href="/go/printer/printer_test.go.html#8511330">ast</a></span><span class="op" id="8519464">.</span><span class="ident" id="8519465">Ident</span><span class="op" id="8519470">)</span><span class="op" id="8519471">;</span>&nbsp;<span class="ident" id="8519473"><a href="/go/printer/printer_test.go.html#8519451">ok</a></span>&nbsp;<span class="op" id="8519476">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519480"><a href="/go/printer/printer_test.go.html#8519393">v</a></span>&nbsp;<span class="op" id="8519482">&lt;-</span>&nbsp;<span class="ident" id="8519485"><a href="/go/printer/printer_test.go.html#8519444">ident</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8519492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8519495">return</span>&nbsp;<span class="ident" id="8519502"><a href="/go/printer/printer_test.go.html#8519393">v</a></span><br>
<span class="lineno"></span><span class="op" id="8519504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="comment" id="8519507">//&nbsp;idents&nbsp;is&nbsp;an&nbsp;iterator&nbsp;that&nbsp;returns&nbsp;all&nbsp;idents&nbsp;in&nbsp;f&nbsp;via&nbsp;the&nbsp;result&nbsp;channel.</span><br>
<span class="lineno"></span><span class="keyword" id="8519585">func</span>&nbsp;<span class="ident" id="8519590">idents</span><span class="op" id="8519596">(</span><span class="ident" id="8519597">f</span>&nbsp;<span class="op" id="8519599">*</span><span class="ident" id="8519600"><a href="/go/printer/printer_test.go.html#8511330">ast</a></span><span class="op" id="8519603">.</span><span class="ident" id="8519604">File</span><span class="op" id="8519608">)</span>&nbsp;<span class="op" id="8519610">&lt;-</span><span class="keyword" id="8519612">chan</span>&nbsp;<span class="op" id="8519617">*</span><span class="ident" id="8519618"><a href="/go/printer/printer_test.go.html#8511330">ast</a></span><span class="op" id="8519621">.</span><span class="ident" id="8519622">Ident</span>&nbsp;<span class="op" id="8519628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519631">v</span>&nbsp;<span class="op" id="8519633">:=</span>&nbsp;<span class="builtinfunc" id="8519636">make</span><span class="op" id="8519640">(</span><span class="ident" id="8519641"><a href="/go/printer/printer_test.go.html#8519362">visitor</a></span><span class="op" id="8519648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8519651">go</span>&nbsp;<span class="keyword" id="8519654">func</span><span class="op" id="8519658">(</span><span class="op" id="8519659">)</span>&nbsp;<span class="op" id="8519661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519665"><a href="/go/printer/printer_test.go.html#8511330">ast</a></span><span class="op" id="8519668">.</span><span class="ident" id="8519669">Walk</span><span class="op" id="8519673">(</span><span class="ident" id="8519674"><a href="/go/printer/printer_test.go.html#8519631">v</a></span><span class="op" id="8519675">,</span>&nbsp;<span class="ident" id="8519677"><a href="/go/printer/printer_test.go.html#8519597">f</a></span><span class="op" id="8519678">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8519682">close</span><span class="op" id="8519687">(</span><span class="ident" id="8519688"><a href="/go/printer/printer_test.go.html#8519631">v</a></span><span class="op" id="8519689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8519692">}</span><span class="op" id="8519693">(</span><span class="op" id="8519694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8519697">return</span>&nbsp;<span class="ident" id="8519704"><a href="/go/printer/printer_test.go.html#8519631">v</a></span><br>
<span class="lineno"></span><span class="op" id="8519706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="comment" id="8519709">//&nbsp;identCount&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;identifiers&nbsp;found&nbsp;in&nbsp;f.</span><br>
<span class="lineno"></span><span class="keyword" id="8519769">func</span>&nbsp;<span class="ident" id="8519774">identCount</span><span class="op" id="8519784">(</span><span class="ident" id="8519785">f</span>&nbsp;<span class="op" id="8519787">*</span><span class="ident" id="8519788"><a href="/go/printer/printer_test.go.html#8511330">ast</a></span><span class="op" id="8519791">.</span><span class="ident" id="8519792">File</span><span class="op" id="8519796">)</span>&nbsp;<span class="builtintype" id="8519798">int</span>&nbsp;<span class="op" id="8519802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519805">n</span>&nbsp;<span class="op" id="8519807">:=</span>&nbsp;<span class="num" id="8519810">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8519813">for</span>&nbsp;<span class="keyword" id="8519817">range</span>&nbsp;<span class="ident" id="8519823"><a href="/go/printer/printer_test.go.html#8519590">idents</a></span><span class="op" id="8519829">(</span><span class="ident" id="8519830"><a href="/go/printer/printer_test.go.html#8519785">f</a></span><span class="op" id="8519831">)</span>&nbsp;<span class="op" id="8519833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519837"><a href="/go/printer/printer_test.go.html#8519805">n</a></span><span class="op" id="8519838">++</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8519842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8519845">return</span>&nbsp;<span class="ident" id="8519852"><a href="/go/printer/printer_test.go.html#8519805">n</a></span><br>
<span class="lineno"></span><span class="op" id="8519854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8519857">//&nbsp;Verify&nbsp;that&nbsp;the&nbsp;SourcePos&nbsp;mode&nbsp;emits&nbsp;correct&nbsp;//line&nbsp;comments</span><br>
<span class="lineno">360</span><span class="comment" id="8519921">//&nbsp;by&nbsp;testing&nbsp;that&nbsp;position&nbsp;information&nbsp;for&nbsp;matching&nbsp;identifiers</span><br>
<span class="lineno"></span><span class="comment" id="8519986">//&nbsp;is&nbsp;maintained.</span><br>
<span class="lineno"></span><span class="keyword" id="8520004">func</span>&nbsp;<span class="ident" id="8520009">TestSourcePos</span><span class="op" id="8520022">(</span><span class="ident" id="8520023">t</span>&nbsp;<span class="op" id="8520025">*</span><span class="ident" id="8520026"><a href="/go/printer/printer_test.go.html#8511395">testing</a></span><span class="op" id="8520033">.</span><span class="ident" id="8520034">T</span><span class="op" id="8520035">)</span>&nbsp;<span class="op" id="8520037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8520040">const</span>&nbsp;<span class="ident" id="8520046">src</span>&nbsp;<span class="op" id="8520050">=</span>&nbsp;<span class="string" id="8520052">`<br>
<span class="lineno"></span>package&nbsp;p<br>
<span class="lineno">365</span>import&nbsp;(&nbsp;&#34;go/printer&#34;;&nbsp;&#34;math&#34;&nbsp;)<br>
<span class="lineno"></span>const&nbsp;pi&nbsp;=&nbsp;3.14;&nbsp;var&nbsp;x&nbsp;=&nbsp;0<br>
<span class="lineno"></span>type&nbsp;t&nbsp;struct{&nbsp;x,&nbsp;y,&nbsp;z&nbsp;int;&nbsp;u,&nbsp;v,&nbsp;w&nbsp;float32&nbsp;}<br>
<span class="lineno"></span>func&nbsp;(t&nbsp;*t)&nbsp;foo(a,&nbsp;b,&nbsp;c&nbsp;int)&nbsp;int&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;a*t.x&nbsp;+&nbsp;b*t.y&nbsp;+<br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;two&nbsp;extra&nbsp;lines&nbsp;here<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;...<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspc*t.z<br>
<span class="lineno"></span>}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8520277">//&nbsp;parse&nbsp;original</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520296">f1</span><span class="op" id="8520298">,</span>&nbsp;<span class="ident" id="8520300">err</span>&nbsp;<span class="op" id="8520304">:=</span>&nbsp;<span class="ident" id="8520307"><a href="/go/printer/printer_test.go.html#8511340">parser</a></span><span class="op" id="8520313">.</span><span class="ident" id="8520314">ParseFile</span><span class="op" id="8520323">(</span><span class="ident" id="8520324"><a href="/go/printer/printer_test.go.html#8511532">fset</a></span><span class="op" id="8520328">,</span>&nbsp;<span class="string" id="8520330">&#34;src&#34;</span><span class="op" id="8520335">,</span>&nbsp;<span class="ident" id="8520337"><a href="/go/printer/printer_test.go.html#8520046">src</a></span><span class="op" id="8520340">,</span>&nbsp;<span class="ident" id="8520342"><a href="/go/printer/printer_test.go.html#8511340">parser</a></span><span class="op" id="8520348">.</span><span class="ident" id="8520349">ParseComments</span><span class="op" id="8520362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8520365">if</span>&nbsp;<span class="ident" id="8520368"><a href="/go/printer/printer_test.go.html#8520300">err</a></span>&nbsp;<span class="op" id="8520372">!=</span>&nbsp;<span class="ident" id="8520375">nil</span>&nbsp;<span class="op" id="8520379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520383"><a href="/go/printer/printer_test.go.html#8520023">t</a></span><span class="op" id="8520384">.</span><span class="ident" id="8520385">Fatal</span><span class="op" id="8520390">(</span><span class="ident" id="8520391"><a href="/go/printer/printer_test.go.html#8520300">err</a></span><span class="op" id="8520394">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8520397">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8520401">//&nbsp;pretty-print&nbsp;original</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8520427">var</span>&nbsp;<span class="ident" id="8520431">buf</span>&nbsp;<span class="ident" id="8520435"><a href="/go/printer/printer_test.go.html#8511296">bytes</a></span><span class="op" id="8520440">.</span><span class="ident" id="8520441">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520449"><a href="/go/printer/printer_test.go.html#8520300">err</a></span>&nbsp;<span class="op" id="8520453">=</span>&nbsp;<span class="op" id="8520455">(</span><span class="op" id="8520456">&amp;</span><span class="ident" id="8520457"><a href="/go/printer/printer.go.html#5359429">Config</a></span><span class="op" id="8520463">{</span><span class="ident" id="8520464">Mode</span><span class="op" id="8520468">:</span>&nbsp;<span class="ident" id="8520470"><a href="/go/printer/printer.go.html#5359212">UseSpaces</a></span>&nbsp;<span class="op" id="8520480">|</span>&nbsp;<span class="ident" id="8520482"><a href="/go/printer/printer.go.html#5359284">SourcePos</a></span><span class="op" id="8520491">,</span>&nbsp;<span class="ident" id="8520493">Tabwidth</span><span class="op" id="8520501">:</span>&nbsp;<span class="num" id="8520503">8</span><span class="op" id="8520504">}</span><span class="op" id="8520505">)</span><span class="op" id="8520506">.</span><span class="ident" id="8520507">Fprint</span><span class="op" id="8520513">(</span><span class="op" id="8520514">&amp;</span><span class="ident" id="8520515"><a href="/go/printer/printer_test.go.html#8520431">buf</a></span><span class="op" id="8520518">,</span>&nbsp;<span class="ident" id="8520520"><a href="/go/printer/printer_test.go.html#8511532">fset</a></span><span class="op" id="8520524">,</span>&nbsp;<span class="ident" id="8520526"><a href="/go/printer/printer_test.go.html#8520296">f1</a></span><span class="op" id="8520528">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8520531">if</span>&nbsp;<span class="ident" id="8520534"><a href="/go/printer/printer_test.go.html#8520300">err</a></span>&nbsp;<span class="op" id="8520538">!=</span>&nbsp;<span class="ident" id="8520541">nil</span>&nbsp;<span class="op" id="8520545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520549"><a href="/go/printer/printer_test.go.html#8520023">t</a></span><span class="op" id="8520550">.</span><span class="ident" id="8520551">Fatal</span><span class="op" id="8520556">(</span><span class="ident" id="8520557"><a href="/go/printer/printer_test.go.html#8520300">err</a></span><span class="op" id="8520560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8520563">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8520567">//&nbsp;parse&nbsp;pretty&nbsp;printed&nbsp;original</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8520601">//&nbsp;(//line&nbsp;comments&nbsp;must&nbsp;be&nbsp;interpreted&nbsp;even&nbsp;w/o&nbsp;parser.ParseComments&nbsp;set)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520677">f2</span><span class="op" id="8520679">,</span>&nbsp;<span class="ident" id="8520681"><a href="/go/printer/printer_test.go.html#8520300">err</a></span>&nbsp;<span class="op" id="8520685">:=</span>&nbsp;<span class="ident" id="8520688"><a href="/go/printer/printer_test.go.html#8511340">parser</a></span><span class="op" id="8520694">.</span><span class="ident" id="8520695">ParseFile</span><span class="op" id="8520704">(</span><span class="ident" id="8520705"><a href="/go/printer/printer_test.go.html#8511532">fset</a></span><span class="op" id="8520709">,</span>&nbsp;<span class="string" id="8520711">&#34;&#34;</span><span class="op" id="8520713">,</span>&nbsp;<span class="ident" id="8520715"><a href="/go/printer/printer_test.go.html#8520431">buf</a></span><span class="op" id="8520718">.</span><span class="ident" id="8520719">Bytes</span><span class="op" id="8520724">(</span><span class="op" id="8520725">)</span><span class="op" id="8520726">,</span>&nbsp;<span class="num" id="8520728">0</span><span class="op" id="8520729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8520732">if</span>&nbsp;<span class="ident" id="8520735"><a href="/go/printer/printer_test.go.html#8520300">err</a></span>&nbsp;<span class="op" id="8520739">!=</span>&nbsp;<span class="ident" id="8520742">nil</span>&nbsp;<span class="op" id="8520746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520750"><a href="/go/printer/printer_test.go.html#8520023">t</a></span><span class="op" id="8520751">.</span><span class="ident" id="8520752">Fatalf</span><span class="op" id="8520758">(</span><span class="string" id="8520759">&#34;%s\n%s&#34;</span><span class="op" id="8520767">,</span>&nbsp;<span class="ident" id="8520769"><a href="/go/printer/printer_test.go.html#8520300">err</a></span><span class="op" id="8520772">,</span>&nbsp;<span class="ident" id="8520774"><a href="/go/printer/printer_test.go.html#8520431">buf</a></span><span class="op" id="8520777">.</span><span class="ident" id="8520778">Bytes</span><span class="op" id="8520783">(</span><span class="op" id="8520784">)</span><span class="op" id="8520785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8520788">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8520792">//&nbsp;At&nbsp;this&nbsp;point&nbsp;the&nbsp;position&nbsp;information&nbsp;of&nbsp;identifiers&nbsp;in&nbsp;f2&nbsp;should</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8520863">//&nbsp;match&nbsp;the&nbsp;position&nbsp;information&nbsp;of&nbsp;corresponding&nbsp;identifiers&nbsp;in&nbsp;f1.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8520935">//&nbsp;number&nbsp;of&nbsp;identifiers&nbsp;must&nbsp;be&nbsp;&gt;&nbsp;0&nbsp;(test&nbsp;should&nbsp;run)&nbsp;and&nbsp;must&nbsp;match</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521006">n1</span>&nbsp;<span class="op" id="8521009">:=</span>&nbsp;<span class="ident" id="8521012"><a href="/go/printer/printer_test.go.html#8519774">identCount</a></span><span class="op" id="8521022">(</span><span class="ident" id="8521023"><a href="/go/printer/printer_test.go.html#8520296">f1</a></span><span class="op" id="8521025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521028">n2</span>&nbsp;<span class="op" id="8521031">:=</span>&nbsp;<span class="ident" id="8521034"><a href="/go/printer/printer_test.go.html#8519774">identCount</a></span><span class="op" id="8521044">(</span><span class="ident" id="8521045"><a href="/go/printer/printer_test.go.html#8520677">f2</a></span><span class="op" id="8521047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8521050">if</span>&nbsp;<span class="ident" id="8521053"><a href="/go/printer/printer_test.go.html#8521006">n1</a></span>&nbsp;<span class="op" id="8521056">==</span>&nbsp;<span class="num" id="8521059">0</span>&nbsp;<span class="op" id="8521061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521065"><a href="/go/printer/printer_test.go.html#8520023">t</a></span><span class="op" id="8521066">.</span><span class="ident" id="8521067">Fatal</span><span class="op" id="8521072">(</span><span class="string" id="8521073">&#34;got&nbsp;no&nbsp;idents&#34;</span><span class="op" id="8521088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8521091">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8521094">if</span>&nbsp;<span class="ident" id="8521097"><a href="/go/printer/printer_test.go.html#8521028">n2</a></span>&nbsp;<span class="op" id="8521100">!=</span>&nbsp;<span class="ident" id="8521103"><a href="/go/printer/printer_test.go.html#8521006">n1</a></span>&nbsp;<span class="op" id="8521106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521110"><a href="/go/printer/printer_test.go.html#8520023">t</a></span><span class="op" id="8521111">.</span><span class="ident" id="8521112">Errorf</span><span class="op" id="8521118">(</span><span class="string" id="8521119">&#34;got&nbsp;%d&nbsp;idents;&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8521143">,</span>&nbsp;<span class="ident" id="8521145"><a href="/go/printer/printer_test.go.html#8521028">n2</a></span><span class="op" id="8521147">,</span>&nbsp;<span class="ident" id="8521149"><a href="/go/printer/printer_test.go.html#8521006">n1</a></span><span class="op" id="8521151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8521154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8521158">//&nbsp;verify&nbsp;that&nbsp;all&nbsp;identifiers&nbsp;have&nbsp;correct&nbsp;line&nbsp;information</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521220">i2range</span>&nbsp;<span class="op" id="8521228">:=</span>&nbsp;<span class="ident" id="8521231"><a href="/go/printer/printer_test.go.html#8519590">idents</a></span><span class="op" id="8521237">(</span><span class="ident" id="8521238"><a href="/go/printer/printer_test.go.html#8520677">f2</a></span><span class="op" id="8521240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8521243">for</span>&nbsp;<span class="ident" id="8521247">i1</span>&nbsp;<span class="op" id="8521250">:=</span>&nbsp;<span class="keyword" id="8521253">range</span>&nbsp;<span class="ident" id="8521259"><a href="/go/printer/printer_test.go.html#8519590">idents</a></span><span class="op" id="8521265">(</span><span class="ident" id="8521266"><a href="/go/printer/printer_test.go.html#8520296">f1</a></span><span class="op" id="8521268">)</span>&nbsp;<span class="op" id="8521270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521274">i2</span>&nbsp;<span class="op" id="8521277">:=</span>&nbsp;<span class="op" id="8521280">&lt;-</span><span class="ident" id="8521282"><a href="/go/printer/printer_test.go.html#8521220">i2range</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8521293">if</span>&nbsp;<span class="ident" id="8521296"><a href="/go/printer/printer_test.go.html#8521274">i2</a></span><span class="op" id="8521298">.</span><span class="ident" id="8521299">Name</span>&nbsp;<span class="op" id="8521304">!=</span>&nbsp;<span class="ident" id="8521307"><a href="/go/printer/printer_test.go.html#8521247">i1</a></span><span class="op" id="8521309">.</span><span class="ident" id="8521310">Name</span>&nbsp;<span class="op" id="8521315">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521320"><a href="/go/printer/printer_test.go.html#8520023">t</a></span><span class="op" id="8521321">.</span><span class="ident" id="8521322">Errorf</span><span class="op" id="8521328">(</span><span class="string" id="8521329">&#34;got&nbsp;ident&nbsp;%s;&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8521352">,</span>&nbsp;<span class="ident" id="8521354"><a href="/go/printer/printer_test.go.html#8521274">i2</a></span><span class="op" id="8521356">.</span><span class="ident" id="8521357">Name</span><span class="op" id="8521361">,</span>&nbsp;<span class="ident" id="8521363"><a href="/go/printer/printer_test.go.html#8521247">i1</a></span><span class="op" id="8521365">.</span><span class="ident" id="8521366">Name</span><span class="op" id="8521370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8521374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521379">l1</span>&nbsp;<span class="op" id="8521382">:=</span>&nbsp;<span class="ident" id="8521385"><a href="/go/printer/printer_test.go.html#8511532">fset</a></span><span class="op" id="8521389">.</span><span class="ident" id="8521390">Position</span><span class="op" id="8521398">(</span><span class="ident" id="8521399"><a href="/go/printer/printer_test.go.html#8521247">i1</a></span><span class="op" id="8521401">.</span><span class="ident" id="8521402">Pos</span><span class="op" id="8521405">(</span><span class="op" id="8521406">)</span><span class="op" id="8521407">)</span><span class="op" id="8521408">.</span><span class="ident" id="8521409">Line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521416">l2</span>&nbsp;<span class="op" id="8521419">:=</span>&nbsp;<span class="ident" id="8521422"><a href="/go/printer/printer_test.go.html#8511532">fset</a></span><span class="op" id="8521426">.</span><span class="ident" id="8521427">Position</span><span class="op" id="8521435">(</span><span class="ident" id="8521436"><a href="/go/printer/printer_test.go.html#8521274">i2</a></span><span class="op" id="8521438">.</span><span class="ident" id="8521439">Pos</span><span class="op" id="8521442">(</span><span class="op" id="8521443">)</span><span class="op" id="8521444">)</span><span class="op" id="8521445">.</span><span class="ident" id="8521446">Line</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8521453">if</span>&nbsp;<span class="ident" id="8521456"><a href="/go/printer/printer_test.go.html#8521416">l2</a></span>&nbsp;<span class="op" id="8521459">!=</span>&nbsp;<span class="ident" id="8521462"><a href="/go/printer/printer_test.go.html#8521379">l1</a></span>&nbsp;<span class="op" id="8521465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521470"><a href="/go/printer/printer_test.go.html#8520023">t</a></span><span class="op" id="8521471">.</span><span class="ident" id="8521472">Errorf</span><span class="op" id="8521478">(</span><span class="string" id="8521479">&#34;got&nbsp;line&nbsp;%d;&nbsp;want&nbsp;%d&nbsp;for&nbsp;%s&#34;</span><span class="op" id="8521508">,</span>&nbsp;<span class="ident" id="8521510"><a href="/go/printer/printer_test.go.html#8521416">l2</a></span><span class="op" id="8521512">,</span>&nbsp;<span class="ident" id="8521514"><a href="/go/printer/printer_test.go.html#8521379">l1</a></span><span class="op" id="8521516">,</span>&nbsp;<span class="ident" id="8521518"><a href="/go/printer/printer_test.go.html#8521247">i1</a></span><span class="op" id="8521520">.</span><span class="ident" id="8521521">Name</span><span class="op" id="8521525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8521529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8521532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8521536">if</span>&nbsp;<span class="ident" id="8521539"><a href="/go/printer/printer_test.go.html#8520023">t</a></span><span class="op" id="8521540">.</span><span class="ident" id="8521541">Failed</span><span class="op" id="8521547">(</span><span class="op" id="8521548">)</span>&nbsp;<span class="op" id="8521550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521554"><a href="/go/printer/printer_test.go.html#8520023">t</a></span><span class="op" id="8521555">.</span><span class="ident" id="8521556">Logf</span><span class="op" id="8521560">(</span><span class="string" id="8521561">&#34;\n%s&#34;</span><span class="op" id="8521567">,</span>&nbsp;<span class="ident" id="8521569"><a href="/go/printer/printer_test.go.html#8520431">buf</a></span><span class="op" id="8521572">.</span><span class="ident" id="8521573">Bytes</span><span class="op" id="8521578">(</span><span class="op" id="8521579">)</span><span class="op" id="8521580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8521583">}</span><br>
<span class="lineno"></span><span class="op" id="8521585">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span><span class="keyword" id="8521588">var</span>&nbsp;<span class="ident" id="8521592">decls</span>&nbsp;<span class="op" id="8521598">=</span>&nbsp;<span class="op" id="8521600">[</span><span class="op" id="8521601">]</span><span class="builtintype" id="8521602">string</span><span class="op" id="8521608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8521611">`import&nbsp;&#34;fmt&#34;`</span><span class="op" id="8521625">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8521628">&#34;const&nbsp;pi&nbsp;=&nbsp;3.1415\nconst&nbsp;e&nbsp;=&nbsp;2.71828\n\nvar&nbsp;x&nbsp;=&nbsp;pi&#34;</span><span class="op" id="8521680">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8521683">&#34;func&nbsp;sum(x,&nbsp;y&nbsp;int)&nbsp;int\t{&nbsp;return&nbsp;x&nbsp;+&nbsp;y&nbsp;}&#34;</span><span class="op" id="8521725">,</span><br>
<span class="lineno"></span><span class="op" id="8521727">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="8521730">func</span>&nbsp;<span class="ident" id="8521735">TestDeclLists</span><span class="op" id="8521748">(</span><span class="ident" id="8521749">t</span>&nbsp;<span class="op" id="8521751">*</span><span class="ident" id="8521752"><a href="/go/printer/printer_test.go.html#8511395">testing</a></span><span class="op" id="8521759">.</span><span class="ident" id="8521760">T</span><span class="op" id="8521761">)</span>&nbsp;<span class="op" id="8521763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8521766">for</span>&nbsp;<span class="ident" id="8521770">_</span><span class="op" id="8521771">,</span>&nbsp;<span class="ident" id="8521773">src</span>&nbsp;<span class="op" id="8521777">:=</span>&nbsp;<span class="keyword" id="8521780">range</span>&nbsp;<span class="ident" id="8521786"><a href="/go/printer/printer_test.go.html#8521592">decls</a></span>&nbsp;<span class="op" id="8521792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521796">file</span><span class="op" id="8521800">,</span>&nbsp;<span class="ident" id="8521802">err</span>&nbsp;<span class="op" id="8521806">:=</span>&nbsp;<span class="ident" id="8521809"><a href="/go/printer/printer_test.go.html#8511340">parser</a></span><span class="op" id="8521815">.</span><span class="ident" id="8521816">ParseFile</span><span class="op" id="8521825">(</span><span class="ident" id="8521826"><a href="/go/printer/printer_test.go.html#8511532">fset</a></span><span class="op" id="8521830">,</span>&nbsp;<span class="string" id="8521832">&#34;&#34;</span><span class="op" id="8521834">,</span>&nbsp;<span class="string" id="8521836">&#34;package&nbsp;p;&#34;</span><span class="op" id="8521848">+</span><span class="ident" id="8521849"><a href="/go/printer/printer_test.go.html#8521773">src</a></span><span class="op" id="8521852">,</span>&nbsp;<span class="ident" id="8521854"><a href="/go/printer/printer_test.go.html#8511340">parser</a></span><span class="op" id="8521860">.</span><span class="ident" id="8521861">ParseComments</span><span class="op" id="8521874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8521878">if</span>&nbsp;<span class="ident" id="8521881"><a href="/go/printer/printer_test.go.html#8521802">err</a></span>&nbsp;<span class="op" id="8521885">!=</span>&nbsp;<span class="ident" id="8521888">nil</span>&nbsp;<span class="op" id="8521892">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8521897">panic</span><span class="op" id="8521902">(</span><span class="ident" id="8521903"><a href="/go/printer/printer_test.go.html#8521802">err</a></span><span class="op" id="8521906">)</span>&nbsp;<span class="comment" id="8521908">//&nbsp;error&nbsp;in&nbsp;test</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8521927">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8521932">var</span>&nbsp;<span class="ident" id="8521936">buf</span>&nbsp;<span class="ident" id="8521940"><a href="/go/printer/printer_test.go.html#8511296">bytes</a></span><span class="op" id="8521945">.</span><span class="ident" id="8521946">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521955"><a href="/go/printer/printer_test.go.html#8521802">err</a></span>&nbsp;<span class="op" id="8521959">=</span>&nbsp;<span class="ident" id="8521961"><a href="/go/printer/printer.go.html#5361851">Fprint</a></span><span class="op" id="8521967">(</span><span class="op" id="8521968">&amp;</span><span class="ident" id="8521969"><a href="/go/printer/printer_test.go.html#8521936">buf</a></span><span class="op" id="8521972">,</span>&nbsp;<span class="ident" id="8521974"><a href="/go/printer/printer_test.go.html#8511532">fset</a></span><span class="op" id="8521978">,</span>&nbsp;<span class="ident" id="8521980"><a href="/go/printer/printer_test.go.html#8521796">file</a></span><span class="op" id="8521984">.</span><span class="ident" id="8521985">Decls</span><span class="op" id="8521990">)</span>&nbsp;<span class="comment" id="8521992">//&nbsp;only&nbsp;print&nbsp;declarations</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8522021">if</span>&nbsp;<span class="ident" id="8522024"><a href="/go/printer/printer_test.go.html#8521802">err</a></span>&nbsp;<span class="op" id="8522028">!=</span>&nbsp;<span class="ident" id="8522031">nil</span>&nbsp;<span class="op" id="8522035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8522040">panic</span><span class="op" id="8522045">(</span><span class="ident" id="8522046"><a href="/go/printer/printer_test.go.html#8521802">err</a></span><span class="op" id="8522049">)</span>&nbsp;<span class="comment" id="8522051">//&nbsp;error&nbsp;in&nbsp;test</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8522070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522075">out</span>&nbsp;<span class="op" id="8522079">:=</span>&nbsp;<span class="ident" id="8522082"><a href="/go/printer/printer_test.go.html#8521936">buf</a></span><span class="op" id="8522085">.</span><span class="ident" id="8522086">String</span><span class="op" id="8522092">(</span><span class="op" id="8522093">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8522097">if</span>&nbsp;<span class="ident" id="8522100"><a href="/go/printer/printer_test.go.html#8522075">out</a></span>&nbsp;<span class="op" id="8522104">!=</span>&nbsp;<span class="ident" id="8522107"><a href="/go/printer/printer_test.go.html#8521773">src</a></span>&nbsp;<span class="op" id="8522111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522116"><a href="/go/printer/printer_test.go.html#8521749">t</a></span><span class="op" id="8522117">.</span><span class="ident" id="8522118">Errorf</span><span class="op" id="8522124">(</span><span class="string" id="8522125">&#34;\ngot&nbsp;:&nbsp;%q\nwant:&nbsp;%q\n&#34;</span><span class="op" id="8522149">,</span>&nbsp;<span class="ident" id="8522151"><a href="/go/printer/printer_test.go.html#8522075">out</a></span><span class="op" id="8522154">,</span>&nbsp;<span class="ident" id="8522156"><a href="/go/printer/printer_test.go.html#8521773">src</a></span><span class="op" id="8522159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8522163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8522166">}</span><br>
<span class="lineno"></span><span class="op" id="8522168">}</span><br>
<span class="lineno">455</span><br>
<span class="lineno"></span><span class="keyword" id="8522171">var</span>&nbsp;<span class="ident" id="8522175">stmts</span>&nbsp;<span class="op" id="8522181">=</span>&nbsp;<span class="op" id="8522183">[</span><span class="op" id="8522184">]</span><span class="builtintype" id="8522185">string</span><span class="op" id="8522191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8522194">&#34;i&nbsp;:=&nbsp;0&#34;</span><span class="op" id="8522202">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8522205">&#34;select&nbsp;{}\nvar&nbsp;a,&nbsp;b&nbsp;=&nbsp;1,&nbsp;2\nreturn&nbsp;a&nbsp;+&nbsp;b&#34;</span><span class="op" id="8522247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8522250">&#34;go&nbsp;f()\ndefer&nbsp;func()&nbsp;{}()&#34;</span><span class="op" id="8522277">,</span><br>
<span class="lineno">460</span><span class="op" id="8522279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8522282">func</span>&nbsp;<span class="ident" id="8522287">TestStmtLists</span><span class="op" id="8522300">(</span><span class="ident" id="8522301">t</span>&nbsp;<span class="op" id="8522303">*</span><span class="ident" id="8522304"><a href="/go/printer/printer_test.go.html#8511395">testing</a></span><span class="op" id="8522311">.</span><span class="ident" id="8522312">T</span><span class="op" id="8522313">)</span>&nbsp;<span class="op" id="8522315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8522318">for</span>&nbsp;<span class="ident" id="8522322">_</span><span class="op" id="8522323">,</span>&nbsp;<span class="ident" id="8522325">src</span>&nbsp;<span class="op" id="8522329">:=</span>&nbsp;<span class="keyword" id="8522332">range</span>&nbsp;<span class="ident" id="8522338"><a href="/go/printer/printer_test.go.html#8522175">stmts</a></span>&nbsp;<span class="op" id="8522344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522348">file</span><span class="op" id="8522352">,</span>&nbsp;<span class="ident" id="8522354">err</span>&nbsp;<span class="op" id="8522358">:=</span>&nbsp;<span class="ident" id="8522361"><a href="/go/printer/printer_test.go.html#8511340">parser</a></span><span class="op" id="8522367">.</span><span class="ident" id="8522368">ParseFile</span><span class="op" id="8522377">(</span><span class="ident" id="8522378"><a href="/go/printer/printer_test.go.html#8511532">fset</a></span><span class="op" id="8522382">,</span>&nbsp;<span class="string" id="8522384">&#34;&#34;</span><span class="op" id="8522386">,</span>&nbsp;<span class="string" id="8522388">&#34;package&nbsp;p;&nbsp;func&nbsp;_()&nbsp;{&#34;</span><span class="op" id="8522411">+</span><span class="ident" id="8522412"><a href="/go/printer/printer_test.go.html#8522325">src</a></span><span class="op" id="8522415">+</span><span class="string" id="8522416">&#34;}&#34;</span><span class="op" id="8522419">,</span>&nbsp;<span class="ident" id="8522421"><a href="/go/printer/printer_test.go.html#8511340">parser</a></span><span class="op" id="8522427">.</span><span class="ident" id="8522428">ParseComments</span><span class="op" id="8522441">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8522445">if</span>&nbsp;<span class="ident" id="8522448"><a href="/go/printer/printer_test.go.html#8522354">err</a></span>&nbsp;<span class="op" id="8522452">!=</span>&nbsp;<span class="ident" id="8522455">nil</span>&nbsp;<span class="op" id="8522459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8522464">panic</span><span class="op" id="8522469">(</span><span class="ident" id="8522470"><a href="/go/printer/printer_test.go.html#8522354">err</a></span><span class="op" id="8522473">)</span>&nbsp;<span class="comment" id="8522475">//&nbsp;error&nbsp;in&nbsp;test</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8522494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8522499">var</span>&nbsp;<span class="ident" id="8522503">buf</span>&nbsp;<span class="ident" id="8522507"><a href="/go/printer/printer_test.go.html#8511296">bytes</a></span><span class="op" id="8522512">.</span><span class="ident" id="8522513">Buffer</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522522"><a href="/go/printer/printer_test.go.html#8522354">err</a></span>&nbsp;<span class="op" id="8522526">=</span>&nbsp;<span class="ident" id="8522528"><a href="/go/printer/printer.go.html#5361851">Fprint</a></span><span class="op" id="8522534">(</span><span class="op" id="8522535">&amp;</span><span class="ident" id="8522536"><a href="/go/printer/printer_test.go.html#8522503">buf</a></span><span class="op" id="8522539">,</span>&nbsp;<span class="ident" id="8522541"><a href="/go/printer/printer_test.go.html#8511532">fset</a></span><span class="op" id="8522545">,</span>&nbsp;<span class="ident" id="8522547"><a href="/go/printer/printer_test.go.html#8522348">file</a></span><span class="op" id="8522551">.</span><span class="ident" id="8522552">Decls</span><span class="op" id="8522557">[</span><span class="num" id="8522558">0</span><span class="op" id="8522559">]</span><span class="op" id="8522560">.</span><span class="op" id="8522561">(</span><span class="op" id="8522562">*</span><span class="ident" id="8522563"><a href="/go/printer/printer_test.go.html#8511330">ast</a></span><span class="op" id="8522566">.</span><span class="ident" id="8522567">FuncDecl</span><span class="op" id="8522575">)</span><span class="op" id="8522576">.</span><span class="ident" id="8522577">Body</span><span class="op" id="8522581">.</span><span class="ident" id="8522582">List</span><span class="op" id="8522586">)</span>&nbsp;<span class="comment" id="8522588">//&nbsp;only&nbsp;print&nbsp;statements</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8522615">if</span>&nbsp;<span class="ident" id="8522618"><a href="/go/printer/printer_test.go.html#8522354">err</a></span>&nbsp;<span class="op" id="8522622">!=</span>&nbsp;<span class="ident" id="8522625">nil</span>&nbsp;<span class="op" id="8522629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8522634">panic</span><span class="op" id="8522639">(</span><span class="ident" id="8522640"><a href="/go/printer/printer_test.go.html#8522354">err</a></span><span class="op" id="8522643">)</span>&nbsp;<span class="comment" id="8522645">//&nbsp;error&nbsp;in&nbsp;test</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8522664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522669">out</span>&nbsp;<span class="op" id="8522673">:=</span>&nbsp;<span class="ident" id="8522676"><a href="/go/printer/printer_test.go.html#8522503">buf</a></span><span class="op" id="8522679">.</span><span class="ident" id="8522680">String</span><span class="op" id="8522686">(</span><span class="op" id="8522687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8522691">if</span>&nbsp;<span class="ident" id="8522694"><a href="/go/printer/printer_test.go.html#8522669">out</a></span>&nbsp;<span class="op" id="8522698">!=</span>&nbsp;<span class="ident" id="8522701"><a href="/go/printer/printer_test.go.html#8522325">src</a></span>&nbsp;<span class="op" id="8522705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522710"><a href="/go/printer/printer_test.go.html#8522301">t</a></span><span class="op" id="8522711">.</span><span class="ident" id="8522712">Errorf</span><span class="op" id="8522718">(</span><span class="string" id="8522719">&#34;\ngot&nbsp;:&nbsp;%q\nwant:&nbsp;%q\n&#34;</span><span class="op" id="8522743">,</span>&nbsp;<span class="ident" id="8522745"><a href="/go/printer/printer_test.go.html#8522669">out</a></span><span class="op" id="8522748">,</span>&nbsp;<span class="ident" id="8522750"><a href="/go/printer/printer_test.go.html#8522325">src</a></span><span class="op" id="8522753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8522757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8522760">}</span><br>
<span class="lineno">480</span><span class="op" id="8522762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8522765">func</span>&nbsp;<span class="ident" id="8522770">TestBaseIndent</span><span class="op" id="8522784">(</span><span class="ident" id="8522785">t</span>&nbsp;<span class="op" id="8522787">*</span><span class="ident" id="8522788"><a href="/go/printer/printer_test.go.html#8511395">testing</a></span><span class="op" id="8522795">.</span><span class="ident" id="8522796">T</span><span class="op" id="8522797">)</span>&nbsp;<span class="op" id="8522799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8522802">//&nbsp;The&nbsp;testfile&nbsp;must&nbsp;not&nbsp;contain&nbsp;multi-line&nbsp;raw&nbsp;strings&nbsp;since&nbsp;those</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8522871">//&nbsp;are&nbsp;not&nbsp;indented&nbsp;(because&nbsp;their&nbsp;values&nbsp;must&nbsp;not&nbsp;change)&nbsp;and&nbsp;make</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8522940">//&nbsp;this&nbsp;test&nbsp;fail.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8522960">const</span>&nbsp;<span class="ident" id="8522966">filename</span>&nbsp;<span class="op" id="8522975">=</span>&nbsp;<span class="string" id="8522977">&#34;printer.go&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522991">src</span><span class="op" id="8522994">,</span>&nbsp;<span class="ident" id="8522996">err</span>&nbsp;<span class="op" id="8523000">:=</span>&nbsp;<span class="ident" id="8523003"><a href="/go/printer/printer_test.go.html#8511365">ioutil</a></span><span class="op" id="8523009">.</span><span class="ident" id="8523010">ReadFile</span><span class="op" id="8523018">(</span><span class="ident" id="8523019"><a href="/go/printer/printer_test.go.html#8522966">filename</a></span><span class="op" id="8523027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8523030">if</span>&nbsp;<span class="ident" id="8523033"><a href="/go/printer/printer_test.go.html#8522996">err</a></span>&nbsp;<span class="op" id="8523037">!=</span>&nbsp;<span class="ident" id="8523040">nil</span>&nbsp;<span class="op" id="8523044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8523048">panic</span><span class="op" id="8523053">(</span><span class="ident" id="8523054"><a href="/go/printer/printer_test.go.html#8522996">err</a></span><span class="op" id="8523057">)</span>&nbsp;<span class="comment" id="8523059">//&nbsp;error&nbsp;in&nbsp;test</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8523077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523081">file</span><span class="op" id="8523085">,</span>&nbsp;<span class="ident" id="8523087"><a href="/go/printer/printer_test.go.html#8522996">err</a></span>&nbsp;<span class="op" id="8523091">:=</span>&nbsp;<span class="ident" id="8523094"><a href="/go/printer/printer_test.go.html#8511340">parser</a></span><span class="op" id="8523100">.</span><span class="ident" id="8523101">ParseFile</span><span class="op" id="8523110">(</span><span class="ident" id="8523111"><a href="/go/printer/printer_test.go.html#8511532">fset</a></span><span class="op" id="8523115">,</span>&nbsp;<span class="ident" id="8523117"><a href="/go/printer/printer_test.go.html#8522966">filename</a></span><span class="op" id="8523125">,</span>&nbsp;<span class="ident" id="8523127"><a href="/go/printer/printer_test.go.html#8522991">src</a></span><span class="op" id="8523130">,</span>&nbsp;<span class="num" id="8523132">0</span><span class="op" id="8523133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8523136">if</span>&nbsp;<span class="ident" id="8523139"><a href="/go/printer/printer_test.go.html#8522996">err</a></span>&nbsp;<span class="op" id="8523143">!=</span>&nbsp;<span class="ident" id="8523146">nil</span>&nbsp;<span class="op" id="8523150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8523154">panic</span><span class="op" id="8523159">(</span><span class="ident" id="8523160"><a href="/go/printer/printer_test.go.html#8522996">err</a></span><span class="op" id="8523163">)</span>&nbsp;<span class="comment" id="8523165">//&nbsp;error&nbsp;in&nbsp;test</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8523183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8523187">var</span>&nbsp;<span class="ident" id="8523191">buf</span>&nbsp;<span class="ident" id="8523195"><a href="/go/printer/printer_test.go.html#8511296">bytes</a></span><span class="op" id="8523200">.</span><span class="ident" id="8523201">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8523209">for</span>&nbsp;<span class="ident" id="8523213">indent</span>&nbsp;<span class="op" id="8523220">:=</span>&nbsp;<span class="num" id="8523223">0</span><span class="op" id="8523224">;</span>&nbsp;<span class="ident" id="8523226"><a href="/go/printer/printer_test.go.html#8523213">indent</a></span>&nbsp;<span class="op" id="8523233">&lt;</span>&nbsp;<span class="num" id="8523235">4</span><span class="op" id="8523236">;</span>&nbsp;<span class="ident" id="8523238"><a href="/go/printer/printer_test.go.html#8523213">indent</a></span><span class="op" id="8523244">++</span>&nbsp;<span class="op" id="8523247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523251"><a href="/go/printer/printer_test.go.html#8523191">buf</a></span><span class="op" id="8523254">.</span><span class="ident" id="8523255">Reset</span><span class="op" id="8523260">(</span><span class="op" id="8523261">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8523265">(</span><span class="op" id="8523266">&amp;</span><span class="ident" id="8523267"><a href="/go/printer/printer.go.html#5359429">Config</a></span><span class="op" id="8523273">{</span><span class="ident" id="8523274">Tabwidth</span><span class="op" id="8523282">:</span>&nbsp;<span class="ident" id="8523284"><a href="/go/printer/printer_test.go.html#8511448">tabwidth</a></span><span class="op" id="8523292">,</span>&nbsp;<span class="ident" id="8523294">Indent</span><span class="op" id="8523300">:</span>&nbsp;<span class="ident" id="8523302"><a href="/go/printer/printer_test.go.html#8523213">indent</a></span><span class="op" id="8523308">}</span><span class="op" id="8523309">)</span><span class="op" id="8523310">.</span><span class="ident" id="8523311">Fprint</span><span class="op" id="8523317">(</span><span class="op" id="8523318">&amp;</span><span class="ident" id="8523319"><a href="/go/printer/printer_test.go.html#8523191">buf</a></span><span class="op" id="8523322">,</span>&nbsp;<span class="ident" id="8523324"><a href="/go/printer/printer_test.go.html#8511532">fset</a></span><span class="op" id="8523328">,</span>&nbsp;<span class="ident" id="8523330"><a href="/go/printer/printer_test.go.html#8523081">file</a></span><span class="op" id="8523334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8523338">//&nbsp;all&nbsp;code&nbsp;must&nbsp;be&nbsp;indented&nbsp;by&nbsp;at&nbsp;least&nbsp;&#39;indent&#39;&nbsp;tabs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523395">lines</span>&nbsp;<span class="op" id="8523401">:=</span>&nbsp;<span class="ident" id="8523404"><a href="/go/printer/printer_test.go.html#8511296">bytes</a></span><span class="op" id="8523409">.</span><span class="ident" id="8523410">Split</span><span class="op" id="8523415">(</span><span class="ident" id="8523416"><a href="/go/printer/printer_test.go.html#8523191">buf</a></span><span class="op" id="8523419">.</span><span class="ident" id="8523420">Bytes</span><span class="op" id="8523425">(</span><span class="op" id="8523426">)</span><span class="op" id="8523427">,</span>&nbsp;<span class="op" id="8523429">[</span><span class="op" id="8523430">]</span><span class="builtintype" id="8523431">byte</span><span class="op" id="8523435">{</span><span class="string" id="8523436">&#39;\n&#39;</span><span class="op" id="8523440">}</span><span class="op" id="8523441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8523445">for</span>&nbsp;<span class="ident" id="8523449">i</span><span class="op" id="8523450">,</span>&nbsp;<span class="ident" id="8523452">line</span>&nbsp;<span class="op" id="8523457">:=</span>&nbsp;<span class="keyword" id="8523460">range</span>&nbsp;<span class="ident" id="8523466"><a href="/go/printer/printer_test.go.html#8523395">lines</a></span>&nbsp;<span class="op" id="8523472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8523477">if</span>&nbsp;<span class="builtinfunc" id="8523480">len</span><span class="op" id="8523483">(</span><span class="ident" id="8523484"><a href="/go/printer/printer_test.go.html#8523452">line</a></span><span class="op" id="8523488">)</span>&nbsp;<span class="op" id="8523490">==</span>&nbsp;<span class="num" id="8523493">0</span>&nbsp;<span class="op" id="8523495">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8523501">continue</span>&nbsp;<span class="comment" id="8523510">//&nbsp;empty&nbsp;lines&nbsp;don&#39;t&nbsp;have&nbsp;indentation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8523551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523556">n</span>&nbsp;<span class="op" id="8523558">:=</span>&nbsp;<span class="num" id="8523561">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8523566">for</span>&nbsp;<span class="ident" id="8523570">j</span><span class="op" id="8523571">,</span>&nbsp;<span class="ident" id="8523573">b</span>&nbsp;<span class="op" id="8523575">:=</span>&nbsp;<span class="keyword" id="8523578">range</span>&nbsp;<span class="ident" id="8523584"><a href="/go/printer/printer_test.go.html#8523452">line</a></span>&nbsp;<span class="op" id="8523589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8523595">if</span>&nbsp;<span class="ident" id="8523598"><a href="/go/printer/printer_test.go.html#8523573">b</a></span>&nbsp;<span class="op" id="8523600">!=</span>&nbsp;<span class="string" id="8523603">&#39;\t&#39;</span>&nbsp;<span class="op" id="8523608">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8523615">//&nbsp;end&nbsp;of&nbsp;indentation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523642"><a href="/go/printer/printer_test.go.html#8523556">n</a></span>&nbsp;<span class="op" id="8523644">=</span>&nbsp;<span class="ident" id="8523646"><a href="/go/printer/printer_test.go.html#8523570">j</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8523653">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8523663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8523668">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8523673">if</span>&nbsp;<span class="ident" id="8523676"><a href="/go/printer/printer_test.go.html#8523556">n</a></span>&nbsp;<span class="op" id="8523678">&lt;</span>&nbsp;<span class="ident" id="8523680"><a href="/go/printer/printer_test.go.html#8523213">indent</a></span>&nbsp;<span class="op" id="8523687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523693"><a href="/go/printer/printer_test.go.html#8522785">t</a></span><span class="op" id="8523694">.</span><span class="ident" id="8523695">Errorf</span><span class="op" id="8523701">(</span><span class="string" id="8523702">&#34;line&nbsp;%d:&nbsp;got&nbsp;only&nbsp;%d&nbsp;tabs;&nbsp;want&nbsp;at&nbsp;least&nbsp;%d:&nbsp;%q&#34;</span><span class="op" id="8523751">,</span>&nbsp;<span class="ident" id="8523753"><a href="/go/printer/printer_test.go.html#8523449">i</a></span><span class="op" id="8523754">,</span>&nbsp;<span class="ident" id="8523756"><a href="/go/printer/printer_test.go.html#8523556">n</a></span><span class="op" id="8523757">,</span>&nbsp;<span class="ident" id="8523759"><a href="/go/printer/printer_test.go.html#8523213">indent</a></span><span class="op" id="8523765">,</span>&nbsp;<span class="ident" id="8523767"><a href="/go/printer/printer_test.go.html#8523452">line</a></span><span class="op" id="8523771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8523776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8523780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8523783">}</span><br>
<span class="lineno">520</span><span class="op" id="8523785">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8523788">//&nbsp;TestFuncType&nbsp;tests&nbsp;that&nbsp;an&nbsp;ast.FuncType&nbsp;with&nbsp;a&nbsp;nil&nbsp;Params&nbsp;field</span><br>
<span class="lineno"></span><span class="comment" id="8523855">//&nbsp;can&nbsp;be&nbsp;printed&nbsp;(per&nbsp;go/ast&nbsp;specification).&nbsp;Test&nbsp;case&nbsp;for&nbsp;issue&nbsp;3870.</span><br>
<span class="lineno"></span><span class="keyword" id="8523927">func</span>&nbsp;<span class="ident" id="8523932">TestFuncType</span><span class="op" id="8523944">(</span><span class="ident" id="8523945">t</span>&nbsp;<span class="op" id="8523947">*</span><span class="ident" id="8523948"><a href="/go/printer/printer_test.go.html#8511395">testing</a></span><span class="op" id="8523955">.</span><span class="ident" id="8523956">T</span><span class="op" id="8523957">)</span>&nbsp;<span class="op" id="8523959">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523962">src</span>&nbsp;<span class="op" id="8523966">:=</span>&nbsp;<span class="op" id="8523969">&amp;</span><span class="ident" id="8523970"><a href="/go/printer/printer_test.go.html#8511330">ast</a></span><span class="op" id="8523973">.</span><span class="ident" id="8523974">File</span><span class="op" id="8523978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523982">Name</span><span class="op" id="8523986">:</span>&nbsp;<span class="op" id="8523988">&amp;</span><span class="ident" id="8523989"><a href="/go/printer/printer_test.go.html#8511330">ast</a></span><span class="op" id="8523992">.</span><span class="ident" id="8523993">Ident</span><span class="op" id="8523998">{</span><span class="ident" id="8523999">Name</span><span class="op" id="8524003">:</span>&nbsp;<span class="string" id="8524005">&#34;p&#34;</span><span class="op" id="8524008">}</span><span class="op" id="8524009">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524013">Decls</span><span class="op" id="8524018">:</span>&nbsp;<span class="op" id="8524020">[</span><span class="op" id="8524021">]</span><span class="ident" id="8524022"><a href="/go/printer/printer_test.go.html#8511330">ast</a></span><span class="op" id="8524025">.</span><span class="ident" id="8524026">Decl</span><span class="op" id="8524030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8524035">&amp;</span><span class="ident" id="8524036"><a href="/go/printer/printer_test.go.html#8511330">ast</a></span><span class="op" id="8524039">.</span><span class="ident" id="8524040">FuncDecl</span><span class="op" id="8524048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524054">Name</span><span class="op" id="8524058">:</span>&nbsp;<span class="op" id="8524060">&amp;</span><span class="ident" id="8524061"><a href="/go/printer/printer_test.go.html#8511330">ast</a></span><span class="op" id="8524064">.</span><span class="ident" id="8524065">Ident</span><span class="op" id="8524070">{</span><span class="ident" id="8524071">Name</span><span class="op" id="8524075">:</span>&nbsp;<span class="string" id="8524077">&#34;f&#34;</span><span class="op" id="8524080">}</span><span class="op" id="8524081">,</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524087">Type</span><span class="op" id="8524091">:</span>&nbsp;<span class="op" id="8524093">&amp;</span><span class="ident" id="8524094"><a href="/go/printer/printer_test.go.html#8511330">ast</a></span><span class="op" id="8524097">.</span><span class="ident" id="8524098">FuncType</span><span class="op" id="8524106">{</span><span class="op" id="8524107">}</span><span class="op" id="8524108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8524113">}</span><span class="op" id="8524114">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8524118">}</span><span class="op" id="8524119">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8524122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8524126">var</span>&nbsp;<span class="ident" id="8524130">buf</span>&nbsp;<span class="ident" id="8524134"><a href="/go/printer/printer_test.go.html#8511296">bytes</a></span><span class="op" id="8524139">.</span><span class="ident" id="8524140">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8524148">if</span>&nbsp;<span class="ident" id="8524151">err</span>&nbsp;<span class="op" id="8524155">:=</span>&nbsp;<span class="ident" id="8524158"><a href="/go/printer/printer.go.html#5361851">Fprint</a></span><span class="op" id="8524164">(</span><span class="op" id="8524165">&amp;</span><span class="ident" id="8524166"><a href="/go/printer/printer_test.go.html#8524130">buf</a></span><span class="op" id="8524169">,</span>&nbsp;<span class="ident" id="8524171"><a href="/go/printer/printer_test.go.html#8511532">fset</a></span><span class="op" id="8524175">,</span>&nbsp;<span class="ident" id="8524177"><a href="/go/printer/printer_test.go.html#8523962">src</a></span><span class="op" id="8524180">)</span><span class="op" id="8524181">;</span>&nbsp;<span class="ident" id="8524183"><a href="/go/printer/printer_test.go.html#8524151">err</a></span>&nbsp;<span class="op" id="8524187">!=</span>&nbsp;<span class="ident" id="8524190">nil</span>&nbsp;<span class="op" id="8524194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524198"><a href="/go/printer/printer_test.go.html#8523945">t</a></span><span class="op" id="8524199">.</span><span class="ident" id="8524200">Fatal</span><span class="op" id="8524205">(</span><span class="ident" id="8524206"><a href="/go/printer/printer_test.go.html#8524151">err</a></span><span class="op" id="8524209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8524212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524215">got</span>&nbsp;<span class="op" id="8524219">:=</span>&nbsp;<span class="ident" id="8524222"><a href="/go/printer/printer_test.go.html#8524130">buf</a></span><span class="op" id="8524225">.</span><span class="ident" id="8524226">String</span><span class="op" id="8524232">(</span><span class="op" id="8524233">)</span><br>
<span class="lineno">540</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8524237">const</span>&nbsp;<span class="ident" id="8524243">want</span>&nbsp;<span class="op" id="8524248">=</span>&nbsp;<span class="string" id="8524250">`package&nbsp;p<br>
<span class="lineno"></span><br>
<span class="lineno"></span>func&nbsp;f()<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8524275">if</span>&nbsp;<span class="ident" id="8524278"><a href="/go/printer/printer_test.go.html#8524215">got</a></span>&nbsp;<span class="op" id="8524282">!=</span>&nbsp;<span class="ident" id="8524285"><a href="/go/printer/printer_test.go.html#8524243">want</a></span>&nbsp;<span class="op" id="8524290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524294"><a href="/go/printer/printer_test.go.html#8523945">t</a></span><span class="op" id="8524295">.</span><span class="ident" id="8524296">Fatalf</span><span class="op" id="8524302">(</span><span class="string" id="8524303">&#34;got:\n%s\nwant:\n%s\n&#34;</span><span class="op" id="8524326">,</span>&nbsp;<span class="ident" id="8524328"><a href="/go/printer/printer_test.go.html#8524215">got</a></span><span class="op" id="8524331">,</span>&nbsp;<span class="ident" id="8524333"><a href="/go/printer/printer_test.go.html#8524243">want</a></span><span class="op" id="8524337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8524340">}</span><br>
<span class="lineno"></span><span class="op" id="8524342">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span><span class="comment" id="8524345">//&nbsp;TextX&nbsp;is&nbsp;a&nbsp;skeleton&nbsp;test&nbsp;that&nbsp;can&nbsp;be&nbsp;filled&nbsp;in&nbsp;for&nbsp;debugging&nbsp;one-off&nbsp;cases.</span><br>
<span class="lineno"></span><span class="comment" id="8524424">//&nbsp;Do&nbsp;not&nbsp;remove.</span><br>
<span class="lineno"></span><span class="keyword" id="8524442">func</span>&nbsp;<span class="ident" id="8524447">TestX</span><span class="op" id="8524452">(</span><span class="ident" id="8524453">t</span>&nbsp;<span class="op" id="8524455">*</span><span class="ident" id="8524456"><a href="/go/printer/printer_test.go.html#8511395">testing</a></span><span class="op" id="8524463">.</span><span class="ident" id="8524464">T</span><span class="op" id="8524465">)</span>&nbsp;<span class="op" id="8524467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8524470">const</span>&nbsp;<span class="ident" id="8524476">src</span>&nbsp;<span class="op" id="8524480">=</span>&nbsp;<span class="string" id="8524482">`<br>
<span class="lineno">555</span>package&nbsp;p<br>
<span class="lineno"></span>func&nbsp;_()&nbsp;{}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524509">_</span><span class="op" id="8524510">,</span>&nbsp;<span class="ident" id="8524512">err</span>&nbsp;<span class="op" id="8524516">:=</span>&nbsp;<span class="ident" id="8524519"><a href="/go/printer/printer_test.go.html#8511810">format</a></span><span class="op" id="8524525">(</span><span class="op" id="8524526">[</span><span class="op" id="8524527">]</span><span class="builtintype" id="8524528">byte</span><span class="op" id="8524532">(</span><span class="ident" id="8524533"><a href="/go/printer/printer_test.go.html#8524476">src</a></span><span class="op" id="8524536">)</span><span class="op" id="8524537">,</span>&nbsp;<span class="num" id="8524539">0</span><span class="op" id="8524540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8524543">if</span>&nbsp;<span class="ident" id="8524546"><a href="/go/printer/printer_test.go.html#8524512">err</a></span>&nbsp;<span class="op" id="8524550">!=</span>&nbsp;<span class="ident" id="8524553">nil</span>&nbsp;<span class="op" id="8524557">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524561"><a href="/go/printer/printer_test.go.html#8524453">t</a></span><span class="op" id="8524562">.</span><span class="ident" id="8524563">Error</span><span class="op" id="8524568">(</span><span class="ident" id="8524569"><a href="/go/printer/printer_test.go.html#8524512">err</a></span><span class="op" id="8524572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8524575">}</span><br>
<span class="lineno"></span><span class="op" id="8524577">}</span>
</div>
</body>
</html>
