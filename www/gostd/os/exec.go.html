<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2149404">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2149459">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2149513">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2149564">package</span>&nbsp;<span class="ident" id="2149572">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2149576">import</span>&nbsp;<span class="op" id="2149583">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2149586">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2149597">&#34;sync/atomic&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2149612">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="2149622">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2149625">//&nbsp;Process&nbsp;stores&nbsp;the&nbsp;information&nbsp;about&nbsp;a&nbsp;process&nbsp;created&nbsp;by&nbsp;StartProcess.</span><br>
<span class="lineno"></span><span class="keyword" id="2149700">type</span>&nbsp;<span class="ident" id="2149705">Process</span>&nbsp;<span class="keyword" id="2149713">struct</span>&nbsp;<span class="op" id="2149720">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2149723">Pid</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2149730">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2149735">handle</span>&nbsp;<span class="builtintype" id="2149742">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2149751">isdone</span>&nbsp;<span class="builtintype" id="2149758">uint32</span>&nbsp;<span class="comment" id="2149765">//&nbsp;process&nbsp;has&nbsp;been&nbsp;successfully&nbsp;waited&nbsp;on,&nbsp;non&nbsp;zero&nbsp;if&nbsp;true</span><br>
<span class="lineno"></span><span class="op" id="2149826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="2149829">func</span>&nbsp;<span class="ident" id="2149834">newProcess</span><span class="op" id="2149844">(</span><span class="ident" id="2149845">pid</span>&nbsp;<span class="builtintype" id="2149849">int</span><span class="op" id="2149852">,</span>&nbsp;<span class="ident" id="2149854">handle</span>&nbsp;<span class="builtintype" id="2149861">uintptr</span><span class="op" id="2149868">)</span>&nbsp;<span class="op" id="2149870">*</span><span class="ident" id="2149871">Process</span>&nbsp;<span class="op" id="2149879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2149882">p</span>&nbsp;<span class="op" id="2149884">:=</span>&nbsp;<span class="op" id="2149887">&amp;</span><span class="ident" id="2149888">Process</span><span class="op" id="2149895">{</span><span class="ident" id="2149896">Pid</span><span class="op" id="2149899">:</span>&nbsp;<span class="ident" id="2149901">pid</span><span class="op" id="2149904">,</span>&nbsp;<span class="ident" id="2149906">handle</span><span class="op" id="2149912">:</span>&nbsp;<span class="ident" id="2149914">handle</span><span class="op" id="2149920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2149923">runtime</span><span class="op" id="2149930">.</span><span class="ident" id="2149931">SetFinalizer</span><span class="op" id="2149943">(</span><span class="ident" id="2149944">p</span><span class="op" id="2149945">,</span>&nbsp;<span class="op" id="2149947">(</span><span class="op" id="2149948">*</span><span class="ident" id="2149949">Process</span><span class="op" id="2149956">)</span><span class="op" id="2149957">.</span><span class="ident" id="2149958">Release</span><span class="op" id="2149965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2149968">return</span>&nbsp;<span class="ident" id="2149975">p</span><br>
<span class="lineno"></span><span class="op" id="2149977">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="2149980">func</span>&nbsp;<span class="op" id="2149985">(</span><span class="ident" id="2149986">p</span>&nbsp;<span class="op" id="2149988">*</span><span class="ident" id="2149989">Process</span><span class="op" id="2149996">)</span>&nbsp;<span class="ident" id="2149998">setDone</span><span class="op" id="2150005">(</span><span class="op" id="2150006">)</span>&nbsp;<span class="op" id="2150008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2150011">atomic</span><span class="op" id="2150017">.</span><span class="ident" id="2150018">StoreUint32</span><span class="op" id="2150029">(</span><span class="op" id="2150030">&amp;</span><span class="ident" id="2150031">p</span><span class="op" id="2150032">.</span><span class="ident" id="2150033">isdone</span><span class="op" id="2150039">,</span>&nbsp;<span class="num" id="2150041">1</span><span class="op" id="2150042">)</span><br>
<span class="lineno"></span><span class="op" id="2150044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="2150047">func</span>&nbsp;<span class="op" id="2150052">(</span><span class="ident" id="2150053">p</span>&nbsp;<span class="op" id="2150055">*</span><span class="ident" id="2150056">Process</span><span class="op" id="2150063">)</span>&nbsp;<span class="ident" id="2150065">done</span><span class="op" id="2150069">(</span><span class="op" id="2150070">)</span>&nbsp;<span class="builtintype" id="2150072">bool</span>&nbsp;<span class="op" id="2150077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2150080">return</span>&nbsp;<span class="ident" id="2150087">atomic</span><span class="op" id="2150093">.</span><span class="ident" id="2150094">LoadUint32</span><span class="op" id="2150104">(</span><span class="op" id="2150105">&amp;</span><span class="ident" id="2150106">p</span><span class="op" id="2150107">.</span><span class="ident" id="2150108">isdone</span><span class="op" id="2150114">)</span>&nbsp;<span class="op" id="2150116">&gt;</span>&nbsp;<span class="num" id="2150118">0</span><br>
<span class="lineno"></span><span class="op" id="2150120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2150123">//&nbsp;ProcAttr&nbsp;holds&nbsp;the&nbsp;attributes&nbsp;that&nbsp;will&nbsp;be&nbsp;applied&nbsp;to&nbsp;a&nbsp;new&nbsp;process</span><br>
<span class="lineno">35</span><span class="comment" id="2150194">//&nbsp;started&nbsp;by&nbsp;StartProcess.</span><br>
<span class="lineno"></span><span class="keyword" id="2150222">type</span>&nbsp;<span class="ident" id="2150227">ProcAttr</span>&nbsp;<span class="keyword" id="2150236">struct</span>&nbsp;<span class="op" id="2150243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2150246">//&nbsp;If&nbsp;Dir&nbsp;is&nbsp;non-empty,&nbsp;the&nbsp;child&nbsp;changes&nbsp;into&nbsp;the&nbsp;directory&nbsp;before</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2150315">//&nbsp;creating&nbsp;the&nbsp;process.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2150341">Dir</span>&nbsp;<span class="builtintype" id="2150345">string</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2150353">//&nbsp;If&nbsp;Env&nbsp;is&nbsp;non-nil,&nbsp;it&nbsp;gives&nbsp;the&nbsp;environment&nbsp;variables&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2150419">//&nbsp;new&nbsp;process&nbsp;in&nbsp;the&nbsp;form&nbsp;returned&nbsp;by&nbsp;Environ.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2150468">//&nbsp;If&nbsp;it&nbsp;is&nbsp;nil,&nbsp;the&nbsp;result&nbsp;of&nbsp;Environ&nbsp;will&nbsp;be&nbsp;used.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2150522">Env</span>&nbsp;<span class="op" id="2150526">[</span><span class="op" id="2150527">]</span><span class="builtintype" id="2150528">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2150536">//&nbsp;Files&nbsp;specifies&nbsp;the&nbsp;open&nbsp;files&nbsp;inherited&nbsp;by&nbsp;the&nbsp;new&nbsp;process.&nbsp;&nbsp;The</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2150606">//&nbsp;first&nbsp;three&nbsp;entries&nbsp;correspond&nbsp;to&nbsp;standard&nbsp;input,&nbsp;standard&nbsp;output,&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2150681">//&nbsp;standard&nbsp;error.&nbsp;&nbsp;An&nbsp;implementation&nbsp;may&nbsp;support&nbsp;additional&nbsp;entries,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2150752">//&nbsp;depending&nbsp;on&nbsp;the&nbsp;underlying&nbsp;operating&nbsp;system.&nbsp;&nbsp;A&nbsp;nil&nbsp;entry&nbsp;corresponds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2150827">//&nbsp;to&nbsp;that&nbsp;file&nbsp;being&nbsp;closed&nbsp;when&nbsp;the&nbsp;process&nbsp;starts.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2150882">Files</span>&nbsp;<span class="op" id="2150888">[</span><span class="op" id="2150889">]</span><span class="op" id="2150890">*</span><span class="ident" id="2150891">File</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2150898">//&nbsp;Operating&nbsp;system-specific&nbsp;process&nbsp;creation&nbsp;attributes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2150957">//&nbsp;Note&nbsp;that&nbsp;setting&nbsp;this&nbsp;field&nbsp;means&nbsp;that&nbsp;your&nbsp;program</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2151014">//&nbsp;may&nbsp;not&nbsp;execute&nbsp;properly&nbsp;or&nbsp;even&nbsp;compile&nbsp;on&nbsp;some</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2151067">//&nbsp;operating&nbsp;systems.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2151090">Sys</span>&nbsp;<span class="op" id="2151094">*</span><span class="ident" id="2151095">syscall</span><span class="op" id="2151102">.</span><span class="ident" id="2151103">SysProcAttr</span><br>
<span class="lineno"></span><span class="op" id="2151115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2151118">//&nbsp;A&nbsp;Signal&nbsp;represents&nbsp;an&nbsp;operating&nbsp;system&nbsp;signal.</span><br>
<span class="lineno"></span><span class="comment" id="2151169">//&nbsp;The&nbsp;usual&nbsp;underlying&nbsp;implementation&nbsp;is&nbsp;operating&nbsp;system-dependent:</span><br>
<span class="lineno">60</span><span class="comment" id="2151239">//&nbsp;on&nbsp;Unix&nbsp;it&nbsp;is&nbsp;syscall.Signal.</span><br>
<span class="lineno"></span><span class="keyword" id="2151272">type</span>&nbsp;<span class="ident" id="2151277">Signal</span>&nbsp;<span class="keyword" id="2151284">interface</span>&nbsp;<span class="op" id="2151294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2151297">String</span><span class="op" id="2151303">(</span><span class="op" id="2151304">)</span>&nbsp;<span class="builtintype" id="2151306">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2151314">Signal</span><span class="op" id="2151320">(</span><span class="op" id="2151321">)</span>&nbsp;<span class="comment" id="2151323">//&nbsp;to&nbsp;distinguish&nbsp;from&nbsp;other&nbsp;Stringers</span><br>
<span class="lineno"></span><span class="op" id="2151362">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="2151365">//&nbsp;Getpid&nbsp;returns&nbsp;the&nbsp;process&nbsp;id&nbsp;of&nbsp;the&nbsp;caller.</span><br>
<span class="lineno"></span><span class="keyword" id="2151413">func</span>&nbsp;<span class="ident" id="2151418">Getpid</span><span class="op" id="2151424">(</span><span class="op" id="2151425">)</span>&nbsp;<span class="builtintype" id="2151427">int</span>&nbsp;<span class="op" id="2151431">{</span>&nbsp;<span class="keyword" id="2151433">return</span>&nbsp;<span class="ident" id="2151440">syscall</span><span class="op" id="2151447">.</span><span class="ident" id="2151448">Getpid</span><span class="op" id="2151454">(</span><span class="op" id="2151455">)</span>&nbsp;<span class="op" id="2151457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2151460">//&nbsp;Getppid&nbsp;returns&nbsp;the&nbsp;process&nbsp;id&nbsp;of&nbsp;the&nbsp;caller&#39;s&nbsp;parent.</span><br>
<span class="lineno">70</span><span class="keyword" id="2151518">func</span>&nbsp;<span class="ident" id="2151523">Getppid</span><span class="op" id="2151530">(</span><span class="op" id="2151531">)</span>&nbsp;<span class="builtintype" id="2151533">int</span>&nbsp;<span class="op" id="2151537">{</span>&nbsp;<span class="keyword" id="2151539">return</span>&nbsp;<span class="ident" id="2151546">syscall</span><span class="op" id="2151553">.</span><span class="ident" id="2151554">Getppid</span><span class="op" id="2151561">(</span><span class="op" id="2151562">)</span>&nbsp;<span class="op" id="2151564">}</span>
</div>
</body>
</html>
