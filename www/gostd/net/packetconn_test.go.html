<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7933285">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7933341">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7933395">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="7933446">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;API&nbsp;tests&nbsp;across&nbsp;platforms&nbsp;and&nbsp;will&nbsp;never&nbsp;have&nbsp;a&nbsp;build</span><br>
<span class="lineno"></span><span class="comment" id="7933525">//&nbsp;tag.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7933534">package</span>&nbsp;<span class="ident" id="7933542">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="7933547">import</span>&nbsp;<span class="op" id="7933554">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7933557">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7933563">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7933574">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7933585">&#34;testing&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7933596">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7933603">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7933606">func</span>&nbsp;<span class="ident" id="7933611">packetConnTestData</span><span class="op" id="7933629">(</span><span class="ident" id="7933630">t</span>&nbsp;<span class="op" id="7933632">*</span><span class="ident" id="7933633">testing</span><span class="op" id="7933640">.</span><span class="ident" id="7933641">T</span><span class="op" id="7933642">,</span>&nbsp;<span class="ident" id="7933644">net</span>&nbsp;<span class="builtintype" id="7933648">string</span><span class="op" id="7933654">,</span>&nbsp;<span class="ident" id="7933656">i</span>&nbsp;<span class="builtintype" id="7933658">int</span><span class="op" id="7933661">)</span>&nbsp;<span class="op" id="7933663">(</span><span class="op" id="7933664">[</span><span class="op" id="7933665">]</span><span class="builtintype" id="7933666">byte</span><span class="op" id="7933670">,</span>&nbsp;<span class="keyword" id="7933672">func</span><span class="op" id="7933676">(</span><span class="op" id="7933677">)</span><span class="op" id="7933678">)</span>&nbsp;<span class="op" id="7933680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7933683">switch</span>&nbsp;<span class="ident" id="7933690">net</span>&nbsp;<span class="op" id="7933694">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7933697">case</span>&nbsp;<span class="string" id="7933702">&#34;udp&#34;</span><span class="op" id="7933707">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7933711">return</span>&nbsp;<span class="op" id="7933718">[</span><span class="op" id="7933719">]</span><span class="builtintype" id="7933720">byte</span><span class="op" id="7933724">(</span><span class="string" id="7933725">&#34;UDP&nbsp;PACKETCONN&nbsp;TEST&#34;</span><span class="op" id="7933746">)</span><span class="op" id="7933747">,</span>&nbsp;<span class="ident" id="7933749">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7933754">case</span>&nbsp;<span class="string" id="7933759">&#34;ip&#34;</span><span class="op" id="7933763">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7933767">if</span>&nbsp;<span class="ident" id="7933770">skip</span><span class="op" id="7933774">,</span>&nbsp;<span class="ident" id="7933776">skipmsg</span>&nbsp;<span class="op" id="7933784">:=</span>&nbsp;<span class="ident" id="7933787">skipRawSocketTest</span><span class="op" id="7933804">(</span><span class="ident" id="7933805">t</span><span class="op" id="7933806">)</span><span class="op" id="7933807">;</span>&nbsp;<span class="ident" id="7933809">skip</span>&nbsp;<span class="op" id="7933814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7933819">return</span>&nbsp;<span class="ident" id="7933826">nil</span><span class="op" id="7933829">,</span>&nbsp;<span class="keyword" id="7933831">func</span><span class="op" id="7933835">(</span><span class="op" id="7933836">)</span>&nbsp;<span class="op" id="7933838">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933844">t</span><span class="op" id="7933845">.</span><span class="ident" id="7933846">Logf</span><span class="op" id="7933850">(</span><span class="ident" id="7933851">skipmsg</span><span class="op" id="7933858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7933863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7933867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933871">b</span><span class="op" id="7933872">,</span>&nbsp;<span class="ident" id="7933874">err</span>&nbsp;<span class="op" id="7933878">:=</span>&nbsp;<span class="op" id="7933881">(</span><span class="op" id="7933882">&amp;</span><span class="ident" id="7933883">icmpMessage</span><span class="op" id="7933894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933899">Type</span><span class="op" id="7933903">:</span>&nbsp;<span class="ident" id="7933905">icmpv4EchoRequest</span><span class="op" id="7933922">,</span>&nbsp;<span class="ident" id="7933924">Code</span><span class="op" id="7933928">:</span>&nbsp;<span class="num" id="7933930">0</span><span class="op" id="7933931">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933936">Body</span><span class="op" id="7933940">:</span>&nbsp;<span class="op" id="7933942">&amp;</span><span class="ident" id="7933943">icmpEcho</span><span class="op" id="7933951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933957">ID</span><span class="op" id="7933959">:</span>&nbsp;<span class="ident" id="7933961">os</span><span class="op" id="7933963">.</span><span class="ident" id="7933964">Getpid</span><span class="op" id="7933970">(</span><span class="op" id="7933971">)</span>&nbsp;<span class="op" id="7933973">&amp;</span>&nbsp;<span class="num" id="7933975">0xffff</span><span class="op" id="7933981">,</span>&nbsp;<span class="ident" id="7933983">Seq</span><span class="op" id="7933986">:</span>&nbsp;<span class="ident" id="7933988">i</span>&nbsp;<span class="op" id="7933990">+</span>&nbsp;<span class="num" id="7933992">1</span><span class="op" id="7933993">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7933999">Data</span><span class="op" id="7934003">:</span>&nbsp;<span class="op" id="7934005">[</span><span class="op" id="7934006">]</span><span class="builtintype" id="7934007">byte</span><span class="op" id="7934011">(</span><span class="string" id="7934012">&#34;IP&nbsp;PACKETCONN&nbsp;TEST&#34;</span><span class="op" id="7934032">)</span><span class="op" id="7934033">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934038">}</span><span class="op" id="7934039">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934043">}</span><span class="op" id="7934044">)</span><span class="op" id="7934045">.</span><span class="ident" id="7934046">Marshal</span><span class="op" id="7934053">(</span><span class="op" id="7934054">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934058">if</span>&nbsp;<span class="ident" id="7934061">err</span>&nbsp;<span class="op" id="7934065">!=</span>&nbsp;<span class="ident" id="7934068">nil</span>&nbsp;<span class="op" id="7934072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934077">return</span>&nbsp;<span class="ident" id="7934084">nil</span><span class="op" id="7934087">,</span>&nbsp;<span class="keyword" id="7934089">func</span><span class="op" id="7934093">(</span><span class="op" id="7934094">)</span>&nbsp;<span class="op" id="7934096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934102">t</span><span class="op" id="7934103">.</span><span class="ident" id="7934104">Fatalf</span><span class="op" id="7934110">(</span><span class="string" id="7934111">&#34;icmpMessage.Marshal&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7934143">,</span>&nbsp;<span class="ident" id="7934145">err</span><span class="op" id="7934148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934157">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934161">return</span>&nbsp;<span class="ident" id="7934168">b</span><span class="op" id="7934169">,</span>&nbsp;<span class="ident" id="7934171">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934176">case</span>&nbsp;<span class="string" id="7934181">&#34;unixgram&#34;</span><span class="op" id="7934191">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934195">switch</span>&nbsp;<span class="ident" id="7934202">runtime</span><span class="op" id="7934209">.</span><span class="ident" id="7934210">GOOS</span>&nbsp;<span class="op" id="7934215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934219">case</span>&nbsp;<span class="string" id="7934224">&#34;nacl&#34;</span><span class="op" id="7934230">,</span>&nbsp;<span class="string" id="7934232">&#34;plan9&#34;</span><span class="op" id="7934239">,</span>&nbsp;<span class="string" id="7934241">&#34;windows&#34;</span><span class="op" id="7934250">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934255">return</span>&nbsp;<span class="ident" id="7934262">nil</span><span class="op" id="7934265">,</span>&nbsp;<span class="keyword" id="7934267">func</span><span class="op" id="7934271">(</span><span class="op" id="7934272">)</span>&nbsp;<span class="op" id="7934274">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934280">t</span><span class="op" id="7934281">.</span><span class="ident" id="7934282">Logf</span><span class="op" id="7934286">(</span><span class="string" id="7934287">&#34;skipping&nbsp;%q&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7934311">,</span>&nbsp;<span class="ident" id="7934313">net</span><span class="op" id="7934316">,</span>&nbsp;<span class="ident" id="7934318">runtime</span><span class="op" id="7934325">.</span><span class="ident" id="7934326">GOOS</span><span class="op" id="7934330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934339">default</span><span class="op" id="7934346">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934351">return</span>&nbsp;<span class="op" id="7934358">[</span><span class="op" id="7934359">]</span><span class="builtintype" id="7934360">byte</span><span class="op" id="7934364">(</span><span class="string" id="7934365">&#34;UNIXGRAM&nbsp;PACKETCONN&nbsp;TEST&#34;</span><span class="op" id="7934391">)</span><span class="op" id="7934392">,</span>&nbsp;<span class="ident" id="7934394">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934400">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934403">default</span><span class="op" id="7934410">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934414">return</span>&nbsp;<span class="ident" id="7934421">nil</span><span class="op" id="7934424">,</span>&nbsp;<span class="keyword" id="7934426">func</span><span class="op" id="7934430">(</span><span class="op" id="7934431">)</span>&nbsp;<span class="op" id="7934433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934438">t</span><span class="op" id="7934439">.</span><span class="ident" id="7934440">Logf</span><span class="op" id="7934444">(</span><span class="string" id="7934445">&#34;skipping&nbsp;%q&nbsp;test&#34;</span><span class="op" id="7934463">,</span>&nbsp;<span class="ident" id="7934465">net</span><span class="op" id="7934468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934475">}</span><br>
<span class="lineno">55</span><span class="op" id="7934477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7934480">var</span>&nbsp;<span class="ident" id="7934484">packetConnTests</span>&nbsp;<span class="op" id="7934500">=</span>&nbsp;<span class="op" id="7934502">[</span><span class="op" id="7934503">]</span><span class="keyword" id="7934504">struct</span>&nbsp;<span class="op" id="7934511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934514">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7934520">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934528">addr1</span>&nbsp;<span class="builtintype" id="7934534">string</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934542">addr2</span>&nbsp;<span class="builtintype" id="7934548">string</span><br>
<span class="lineno"></span><span class="op" id="7934555">}</span><span class="op" id="7934556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934559">{</span><span class="string" id="7934560">&#34;udp&#34;</span><span class="op" id="7934565">,</span>&nbsp;<span class="string" id="7934567">&#34;127.0.0.1:0&#34;</span><span class="op" id="7934580">,</span>&nbsp;<span class="string" id="7934582">&#34;127.0.0.1:0&#34;</span><span class="op" id="7934595">}</span><span class="op" id="7934596">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934599">{</span><span class="string" id="7934600">&#34;ip:icmp&#34;</span><span class="op" id="7934609">,</span>&nbsp;<span class="string" id="7934611">&#34;127.0.0.1&#34;</span><span class="op" id="7934622">,</span>&nbsp;<span class="string" id="7934624">&#34;127.0.0.1&#34;</span><span class="op" id="7934635">}</span><span class="op" id="7934636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934639">{</span><span class="string" id="7934640">&#34;unixgram&#34;</span><span class="op" id="7934650">,</span>&nbsp;<span class="ident" id="7934652">testUnixAddr</span><span class="op" id="7934664">(</span><span class="op" id="7934665">)</span><span class="op" id="7934666">,</span>&nbsp;<span class="ident" id="7934668">testUnixAddr</span><span class="op" id="7934680">(</span><span class="op" id="7934681">)</span><span class="op" id="7934682">}</span><span class="op" id="7934683">,</span><br>
<span class="lineno">65</span><span class="op" id="7934685">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7934688">func</span>&nbsp;<span class="ident" id="7934693">TestPacketConn</span><span class="op" id="7934707">(</span><span class="ident" id="7934708">t</span>&nbsp;<span class="op" id="7934710">*</span><span class="ident" id="7934711">testing</span><span class="op" id="7934718">.</span><span class="ident" id="7934719">T</span><span class="op" id="7934720">)</span>&nbsp;<span class="op" id="7934722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934725">closer</span>&nbsp;<span class="op" id="7934732">:=</span>&nbsp;<span class="keyword" id="7934735">func</span><span class="op" id="7934739">(</span><span class="ident" id="7934740">c</span>&nbsp;<span class="ident" id="7934742">PacketConn</span><span class="op" id="7934752">,</span>&nbsp;<span class="ident" id="7934754">net</span><span class="op" id="7934757">,</span>&nbsp;<span class="ident" id="7934759">addr1</span><span class="op" id="7934764">,</span>&nbsp;<span class="ident" id="7934766">addr2</span>&nbsp;<span class="builtintype" id="7934772">string</span><span class="op" id="7934778">)</span>&nbsp;<span class="op" id="7934780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934784">c</span><span class="op" id="7934785">.</span><span class="ident" id="7934786">Close</span><span class="op" id="7934791">(</span><span class="op" id="7934792">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934796">switch</span>&nbsp;<span class="ident" id="7934803">net</span>&nbsp;<span class="op" id="7934807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934811">case</span>&nbsp;<span class="string" id="7934816">&#34;unixgram&#34;</span><span class="op" id="7934826">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934831">os</span><span class="op" id="7934833">.</span><span class="ident" id="7934834">Remove</span><span class="op" id="7934840">(</span><span class="ident" id="7934841">addr1</span><span class="op" id="7934846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934851">os</span><span class="op" id="7934853">.</span><span class="ident" id="7934854">Remove</span><span class="op" id="7934860">(</span><span class="ident" id="7934861">addr2</span><span class="op" id="7934866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934870">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7934873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7934877">for</span>&nbsp;<span class="ident" id="7934881">i</span><span class="op" id="7934882">,</span>&nbsp;<span class="ident" id="7934884">tt</span>&nbsp;<span class="op" id="7934887">:=</span>&nbsp;<span class="keyword" id="7934890">range</span>&nbsp;<span class="ident" id="7934896">packetConnTests</span>&nbsp;<span class="op" id="7934912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934916">netstr</span>&nbsp;<span class="op" id="7934923">:=</span>&nbsp;<span class="ident" id="7934926">strings</span><span class="op" id="7934933">.</span><span class="ident" id="7934934">Split</span><span class="op" id="7934939">(</span><span class="ident" id="7934940">tt</span><span class="op" id="7934942">.</span><span class="ident" id="7934943">net</span><span class="op" id="7934946">,</span>&nbsp;<span class="string" id="7934948">&#34;:&#34;</span><span class="op" id="7934951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7934955">wb</span><span class="op" id="7934957">,</span>&nbsp;<span class="ident" id="7934959">skipOrFatalFn</span>&nbsp;<span class="op" id="7934973">:=</span>&nbsp;<span class="ident" id="7934976">packetConnTestData</span><span class="op" id="7934994">(</span><span class="ident" id="7934995">t</span><span class="op" id="7934996">,</span>&nbsp;<span class="ident" id="7934998">netstr</span><span class="op" id="7935004">[</span><span class="num" id="7935005">0</span><span class="op" id="7935006">]</span><span class="op" id="7935007">,</span>&nbsp;<span class="ident" id="7935009">i</span><span class="op" id="7935010">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7935014">if</span>&nbsp;<span class="ident" id="7935017">skipOrFatalFn</span>&nbsp;<span class="op" id="7935031">!=</span>&nbsp;<span class="ident" id="7935034">nil</span>&nbsp;<span class="op" id="7935038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7935043">skipOrFatalFn</span><span class="op" id="7935056">(</span><span class="op" id="7935057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7935062">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7935073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7935078">c1</span><span class="op" id="7935080">,</span>&nbsp;<span class="ident" id="7935082">err</span>&nbsp;<span class="op" id="7935086">:=</span>&nbsp;<span class="ident" id="7935089">ListenPacket</span><span class="op" id="7935101">(</span><span class="ident" id="7935102">tt</span><span class="op" id="7935104">.</span><span class="ident" id="7935105">net</span><span class="op" id="7935108">,</span>&nbsp;<span class="ident" id="7935110">tt</span><span class="op" id="7935112">.</span><span class="ident" id="7935113">addr1</span><span class="op" id="7935118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7935122">if</span>&nbsp;<span class="ident" id="7935125">err</span>&nbsp;<span class="op" id="7935129">!=</span>&nbsp;<span class="ident" id="7935132">nil</span>&nbsp;<span class="op" id="7935136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7935141">t</span><span class="op" id="7935142">.</span><span class="ident" id="7935143">Fatalf</span><span class="op" id="7935149">(</span><span class="string" id="7935150">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7935175">,</span>&nbsp;<span class="ident" id="7935177">err</span><span class="op" id="7935180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7935184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7935188">defer</span>&nbsp;<span class="ident" id="7935194">closer</span><span class="op" id="7935200">(</span><span class="ident" id="7935201">c1</span><span class="op" id="7935203">,</span>&nbsp;<span class="ident" id="7935205">netstr</span><span class="op" id="7935211">[</span><span class="num" id="7935212">0</span><span class="op" id="7935213">]</span><span class="op" id="7935214">,</span>&nbsp;<span class="ident" id="7935216">tt</span><span class="op" id="7935218">.</span><span class="ident" id="7935219">addr1</span><span class="op" id="7935224">,</span>&nbsp;<span class="ident" id="7935226">tt</span><span class="op" id="7935228">.</span><span class="ident" id="7935229">addr2</span><span class="op" id="7935234">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7935238">c1</span><span class="op" id="7935240">.</span><span class="ident" id="7935241">LocalAddr</span><span class="op" id="7935250">(</span><span class="op" id="7935251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7935255">c1</span><span class="op" id="7935257">.</span><span class="ident" id="7935258">SetDeadline</span><span class="op" id="7935269">(</span><span class="ident" id="7935270">time</span><span class="op" id="7935274">.</span><span class="ident" id="7935275">Now</span><span class="op" id="7935278">(</span><span class="op" id="7935279">)</span><span class="op" id="7935280">.</span><span class="ident" id="7935281">Add</span><span class="op" id="7935284">(</span><span class="num" id="7935285">100</span>&nbsp;<span class="op" id="7935289">*</span>&nbsp;<span class="ident" id="7935291">time</span><span class="op" id="7935295">.</span><span class="ident" id="7935296">Millisecond</span><span class="op" id="7935307">)</span><span class="op" id="7935308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7935312">c1</span><span class="op" id="7935314">.</span><span class="ident" id="7935315">SetReadDeadline</span><span class="op" id="7935330">(</span><span class="ident" id="7935331">time</span><span class="op" id="7935335">.</span><span class="ident" id="7935336">Now</span><span class="op" id="7935339">(</span><span class="op" id="7935340">)</span><span class="op" id="7935341">.</span><span class="ident" id="7935342">Add</span><span class="op" id="7935345">(</span><span class="num" id="7935346">100</span>&nbsp;<span class="op" id="7935350">*</span>&nbsp;<span class="ident" id="7935352">time</span><span class="op" id="7935356">.</span><span class="ident" id="7935357">Millisecond</span><span class="op" id="7935368">)</span><span class="op" id="7935369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7935373">c1</span><span class="op" id="7935375">.</span><span class="ident" id="7935376">SetWriteDeadline</span><span class="op" id="7935392">(</span><span class="ident" id="7935393">time</span><span class="op" id="7935397">.</span><span class="ident" id="7935398">Now</span><span class="op" id="7935401">(</span><span class="op" id="7935402">)</span><span class="op" id="7935403">.</span><span class="ident" id="7935404">Add</span><span class="op" id="7935407">(</span><span class="num" id="7935408">100</span>&nbsp;<span class="op" id="7935412">*</span>&nbsp;<span class="ident" id="7935414">time</span><span class="op" id="7935418">.</span><span class="ident" id="7935419">Millisecond</span><span class="op" id="7935430">)</span><span class="op" id="7935431">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7935436">c2</span><span class="op" id="7935438">,</span>&nbsp;<span class="ident" id="7935440">err</span>&nbsp;<span class="op" id="7935444">:=</span>&nbsp;<span class="ident" id="7935447">ListenPacket</span><span class="op" id="7935459">(</span><span class="ident" id="7935460">tt</span><span class="op" id="7935462">.</span><span class="ident" id="7935463">net</span><span class="op" id="7935466">,</span>&nbsp;<span class="ident" id="7935468">tt</span><span class="op" id="7935470">.</span><span class="ident" id="7935471">addr2</span><span class="op" id="7935476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7935480">if</span>&nbsp;<span class="ident" id="7935483">err</span>&nbsp;<span class="op" id="7935487">!=</span>&nbsp;<span class="ident" id="7935490">nil</span>&nbsp;<span class="op" id="7935494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7935499">t</span><span class="op" id="7935500">.</span><span class="ident" id="7935501">Fatalf</span><span class="op" id="7935507">(</span><span class="string" id="7935508">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7935533">,</span>&nbsp;<span class="ident" id="7935535">err</span><span class="op" id="7935538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7935542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7935546">defer</span>&nbsp;<span class="ident" id="7935552">closer</span><span class="op" id="7935558">(</span><span class="ident" id="7935559">c2</span><span class="op" id="7935561">,</span>&nbsp;<span class="ident" id="7935563">netstr</span><span class="op" id="7935569">[</span><span class="num" id="7935570">0</span><span class="op" id="7935571">]</span><span class="op" id="7935572">,</span>&nbsp;<span class="ident" id="7935574">tt</span><span class="op" id="7935576">.</span><span class="ident" id="7935577">addr1</span><span class="op" id="7935582">,</span>&nbsp;<span class="ident" id="7935584">tt</span><span class="op" id="7935586">.</span><span class="ident" id="7935587">addr2</span><span class="op" id="7935592">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7935596">c2</span><span class="op" id="7935598">.</span><span class="ident" id="7935599">LocalAddr</span><span class="op" id="7935608">(</span><span class="op" id="7935609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7935613">c2</span><span class="op" id="7935615">.</span><span class="ident" id="7935616">SetDeadline</span><span class="op" id="7935627">(</span><span class="ident" id="7935628">time</span><span class="op" id="7935632">.</span><span class="ident" id="7935633">Now</span><span class="op" id="7935636">(</span><span class="op" id="7935637">)</span><span class="op" id="7935638">.</span><span class="ident" id="7935639">Add</span><span class="op" id="7935642">(</span><span class="num" id="7935643">100</span>&nbsp;<span class="op" id="7935647">*</span>&nbsp;<span class="ident" id="7935649">time</span><span class="op" id="7935653">.</span><span class="ident" id="7935654">Millisecond</span><span class="op" id="7935665">)</span><span class="op" id="7935666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7935670">c2</span><span class="op" id="7935672">.</span><span class="ident" id="7935673">SetReadDeadline</span><span class="op" id="7935688">(</span><span class="ident" id="7935689">time</span><span class="op" id="7935693">.</span><span class="ident" id="7935694">Now</span><span class="op" id="7935697">(</span><span class="op" id="7935698">)</span><span class="op" id="7935699">.</span><span class="ident" id="7935700">Add</span><span class="op" id="7935703">(</span><span class="num" id="7935704">100</span>&nbsp;<span class="op" id="7935708">*</span>&nbsp;<span class="ident" id="7935710">time</span><span class="op" id="7935714">.</span><span class="ident" id="7935715">Millisecond</span><span class="op" id="7935726">)</span><span class="op" id="7935727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7935731">c2</span><span class="op" id="7935733">.</span><span class="ident" id="7935734">SetWriteDeadline</span><span class="op" id="7935750">(</span><span class="ident" id="7935751">time</span><span class="op" id="7935755">.</span><span class="ident" id="7935756">Now</span><span class="op" id="7935759">(</span><span class="op" id="7935760">)</span><span class="op" id="7935761">.</span><span class="ident" id="7935762">Add</span><span class="op" id="7935765">(</span><span class="num" id="7935766">100</span>&nbsp;<span class="op" id="7935770">*</span>&nbsp;<span class="ident" id="7935772">time</span><span class="op" id="7935776">.</span><span class="ident" id="7935777">Millisecond</span><span class="op" id="7935788">)</span><span class="op" id="7935789">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7935794">if</span>&nbsp;<span class="ident" id="7935797">_</span><span class="op" id="7935798">,</span>&nbsp;<span class="ident" id="7935800">err</span>&nbsp;<span class="op" id="7935804">:=</span>&nbsp;<span class="ident" id="7935807">c1</span><span class="op" id="7935809">.</span><span class="ident" id="7935810">WriteTo</span><span class="op" id="7935817">(</span><span class="ident" id="7935818">wb</span><span class="op" id="7935820">,</span>&nbsp;<span class="ident" id="7935822">c2</span><span class="op" id="7935824">.</span><span class="ident" id="7935825">LocalAddr</span><span class="op" id="7935834">(</span><span class="op" id="7935835">)</span><span class="op" id="7935836">)</span><span class="op" id="7935837">;</span>&nbsp;<span class="ident" id="7935839">err</span>&nbsp;<span class="op" id="7935843">!=</span>&nbsp;<span class="ident" id="7935846">nil</span>&nbsp;<span class="op" id="7935850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7935855">t</span><span class="op" id="7935856">.</span><span class="ident" id="7935857">Fatalf</span><span class="op" id="7935863">(</span><span class="string" id="7935864">&#34;PacketConn.WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7935895">,</span>&nbsp;<span class="ident" id="7935897">err</span><span class="op" id="7935900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7935904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7935908">rb2</span>&nbsp;<span class="op" id="7935912">:=</span>&nbsp;<span class="builtinfunc" id="7935915">make</span><span class="op" id="7935919">(</span><span class="op" id="7935920">[</span><span class="op" id="7935921">]</span><span class="builtintype" id="7935922">byte</span><span class="op" id="7935926">,</span>&nbsp;<span class="num" id="7935928">128</span><span class="op" id="7935931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7935935">if</span>&nbsp;<span class="ident" id="7935938">_</span><span class="op" id="7935939">,</span>&nbsp;<span class="ident" id="7935941">_</span><span class="op" id="7935942">,</span>&nbsp;<span class="ident" id="7935944">err</span>&nbsp;<span class="op" id="7935948">:=</span>&nbsp;<span class="ident" id="7935951">c2</span><span class="op" id="7935953">.</span><span class="ident" id="7935954">ReadFrom</span><span class="op" id="7935962">(</span><span class="ident" id="7935963">rb2</span><span class="op" id="7935966">)</span><span class="op" id="7935967">;</span>&nbsp;<span class="ident" id="7935969">err</span>&nbsp;<span class="op" id="7935973">!=</span>&nbsp;<span class="ident" id="7935976">nil</span>&nbsp;<span class="op" id="7935980">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7935985">t</span><span class="op" id="7935986">.</span><span class="ident" id="7935987">Fatalf</span><span class="op" id="7935993">(</span><span class="string" id="7935994">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7936026">,</span>&nbsp;<span class="ident" id="7936028">err</span><span class="op" id="7936031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7936035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7936039">if</span>&nbsp;<span class="ident" id="7936042">_</span><span class="op" id="7936043">,</span>&nbsp;<span class="ident" id="7936045">err</span>&nbsp;<span class="op" id="7936049">:=</span>&nbsp;<span class="ident" id="7936052">c2</span><span class="op" id="7936054">.</span><span class="ident" id="7936055">WriteTo</span><span class="op" id="7936062">(</span><span class="ident" id="7936063">wb</span><span class="op" id="7936065">,</span>&nbsp;<span class="ident" id="7936067">c1</span><span class="op" id="7936069">.</span><span class="ident" id="7936070">LocalAddr</span><span class="op" id="7936079">(</span><span class="op" id="7936080">)</span><span class="op" id="7936081">)</span><span class="op" id="7936082">;</span>&nbsp;<span class="ident" id="7936084">err</span>&nbsp;<span class="op" id="7936088">!=</span>&nbsp;<span class="ident" id="7936091">nil</span>&nbsp;<span class="op" id="7936095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7936100">t</span><span class="op" id="7936101">.</span><span class="ident" id="7936102">Fatalf</span><span class="op" id="7936108">(</span><span class="string" id="7936109">&#34;PacketConn.WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7936140">,</span>&nbsp;<span class="ident" id="7936142">err</span><span class="op" id="7936145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7936149">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7936153">rb1</span>&nbsp;<span class="op" id="7936157">:=</span>&nbsp;<span class="builtinfunc" id="7936160">make</span><span class="op" id="7936164">(</span><span class="op" id="7936165">[</span><span class="op" id="7936166">]</span><span class="builtintype" id="7936167">byte</span><span class="op" id="7936171">,</span>&nbsp;<span class="num" id="7936173">128</span><span class="op" id="7936176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7936180">if</span>&nbsp;<span class="ident" id="7936183">_</span><span class="op" id="7936184">,</span>&nbsp;<span class="ident" id="7936186">_</span><span class="op" id="7936187">,</span>&nbsp;<span class="ident" id="7936189">err</span>&nbsp;<span class="op" id="7936193">:=</span>&nbsp;<span class="ident" id="7936196">c1</span><span class="op" id="7936198">.</span><span class="ident" id="7936199">ReadFrom</span><span class="op" id="7936207">(</span><span class="ident" id="7936208">rb1</span><span class="op" id="7936211">)</span><span class="op" id="7936212">;</span>&nbsp;<span class="ident" id="7936214">err</span>&nbsp;<span class="op" id="7936218">!=</span>&nbsp;<span class="ident" id="7936221">nil</span>&nbsp;<span class="op" id="7936225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7936230">t</span><span class="op" id="7936231">.</span><span class="ident" id="7936232">Fatalf</span><span class="op" id="7936238">(</span><span class="string" id="7936239">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7936271">,</span>&nbsp;<span class="ident" id="7936273">err</span><span class="op" id="7936276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7936280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7936283">}</span><br>
<span class="lineno">120</span><span class="op" id="7936285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7936288">func</span>&nbsp;<span class="ident" id="7936293">TestConnAndPacketConn</span><span class="op" id="7936314">(</span><span class="ident" id="7936315">t</span>&nbsp;<span class="op" id="7936317">*</span><span class="ident" id="7936318">testing</span><span class="op" id="7936325">.</span><span class="ident" id="7936326">T</span><span class="op" id="7936327">)</span>&nbsp;<span class="op" id="7936329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7936332">closer</span>&nbsp;<span class="op" id="7936339">:=</span>&nbsp;<span class="keyword" id="7936342">func</span><span class="op" id="7936346">(</span><span class="ident" id="7936347">c</span>&nbsp;<span class="ident" id="7936349">PacketConn</span><span class="op" id="7936359">,</span>&nbsp;<span class="ident" id="7936361">net</span><span class="op" id="7936364">,</span>&nbsp;<span class="ident" id="7936366">addr1</span><span class="op" id="7936371">,</span>&nbsp;<span class="ident" id="7936373">addr2</span>&nbsp;<span class="builtintype" id="7936379">string</span><span class="op" id="7936385">)</span>&nbsp;<span class="op" id="7936387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7936391">c</span><span class="op" id="7936392">.</span><span class="ident" id="7936393">Close</span><span class="op" id="7936398">(</span><span class="op" id="7936399">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7936403">switch</span>&nbsp;<span class="ident" id="7936410">net</span>&nbsp;<span class="op" id="7936414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7936418">case</span>&nbsp;<span class="string" id="7936423">&#34;unixgram&#34;</span><span class="op" id="7936433">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7936438">os</span><span class="op" id="7936440">.</span><span class="ident" id="7936441">Remove</span><span class="op" id="7936447">(</span><span class="ident" id="7936448">addr1</span><span class="op" id="7936453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7936458">os</span><span class="op" id="7936460">.</span><span class="ident" id="7936461">Remove</span><span class="op" id="7936467">(</span><span class="ident" id="7936468">addr2</span><span class="op" id="7936473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7936477">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7936480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7936484">for</span>&nbsp;<span class="ident" id="7936488">i</span><span class="op" id="7936489">,</span>&nbsp;<span class="ident" id="7936491">tt</span>&nbsp;<span class="op" id="7936494">:=</span>&nbsp;<span class="keyword" id="7936497">range</span>&nbsp;<span class="ident" id="7936503">packetConnTests</span>&nbsp;<span class="op" id="7936519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7936523">var</span>&nbsp;<span class="ident" id="7936527">wb</span>&nbsp;<span class="op" id="7936530">[</span><span class="op" id="7936531">]</span><span class="builtintype" id="7936532">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7936539">netstr</span>&nbsp;<span class="op" id="7936546">:=</span>&nbsp;<span class="ident" id="7936549">strings</span><span class="op" id="7936556">.</span><span class="ident" id="7936557">Split</span><span class="op" id="7936562">(</span><span class="ident" id="7936563">tt</span><span class="op" id="7936565">.</span><span class="ident" id="7936566">net</span><span class="op" id="7936569">,</span>&nbsp;<span class="string" id="7936571">&#34;:&#34;</span><span class="op" id="7936574">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7936578">wb</span><span class="op" id="7936580">,</span>&nbsp;<span class="ident" id="7936582">skipOrFatalFn</span>&nbsp;<span class="op" id="7936596">:=</span>&nbsp;<span class="ident" id="7936599">packetConnTestData</span><span class="op" id="7936617">(</span><span class="ident" id="7936618">t</span><span class="op" id="7936619">,</span>&nbsp;<span class="ident" id="7936621">netstr</span><span class="op" id="7936627">[</span><span class="num" id="7936628">0</span><span class="op" id="7936629">]</span><span class="op" id="7936630">,</span>&nbsp;<span class="ident" id="7936632">i</span><span class="op" id="7936633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7936637">if</span>&nbsp;<span class="ident" id="7936640">skipOrFatalFn</span>&nbsp;<span class="op" id="7936654">!=</span>&nbsp;<span class="ident" id="7936657">nil</span>&nbsp;<span class="op" id="7936661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7936666">skipOrFatalFn</span><span class="op" id="7936679">(</span><span class="op" id="7936680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7936685">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7936696">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7936701">c1</span><span class="op" id="7936703">,</span>&nbsp;<span class="ident" id="7936705">err</span>&nbsp;<span class="op" id="7936709">:=</span>&nbsp;<span class="ident" id="7936712">ListenPacket</span><span class="op" id="7936724">(</span><span class="ident" id="7936725">tt</span><span class="op" id="7936727">.</span><span class="ident" id="7936728">net</span><span class="op" id="7936731">,</span>&nbsp;<span class="ident" id="7936733">tt</span><span class="op" id="7936735">.</span><span class="ident" id="7936736">addr1</span><span class="op" id="7936741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7936745">if</span>&nbsp;<span class="ident" id="7936748">err</span>&nbsp;<span class="op" id="7936752">!=</span>&nbsp;<span class="ident" id="7936755">nil</span>&nbsp;<span class="op" id="7936759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7936764">t</span><span class="op" id="7936765">.</span><span class="ident" id="7936766">Fatalf</span><span class="op" id="7936772">(</span><span class="string" id="7936773">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7936798">,</span>&nbsp;<span class="ident" id="7936800">err</span><span class="op" id="7936803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7936807">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7936811">defer</span>&nbsp;<span class="ident" id="7936817">closer</span><span class="op" id="7936823">(</span><span class="ident" id="7936824">c1</span><span class="op" id="7936826">,</span>&nbsp;<span class="ident" id="7936828">netstr</span><span class="op" id="7936834">[</span><span class="num" id="7936835">0</span><span class="op" id="7936836">]</span><span class="op" id="7936837">,</span>&nbsp;<span class="ident" id="7936839">tt</span><span class="op" id="7936841">.</span><span class="ident" id="7936842">addr1</span><span class="op" id="7936847">,</span>&nbsp;<span class="ident" id="7936849">tt</span><span class="op" id="7936851">.</span><span class="ident" id="7936852">addr2</span><span class="op" id="7936857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7936861">c1</span><span class="op" id="7936863">.</span><span class="ident" id="7936864">LocalAddr</span><span class="op" id="7936873">(</span><span class="op" id="7936874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7936878">c1</span><span class="op" id="7936880">.</span><span class="ident" id="7936881">SetDeadline</span><span class="op" id="7936892">(</span><span class="ident" id="7936893">time</span><span class="op" id="7936897">.</span><span class="ident" id="7936898">Now</span><span class="op" id="7936901">(</span><span class="op" id="7936902">)</span><span class="op" id="7936903">.</span><span class="ident" id="7936904">Add</span><span class="op" id="7936907">(</span><span class="num" id="7936908">100</span>&nbsp;<span class="op" id="7936912">*</span>&nbsp;<span class="ident" id="7936914">time</span><span class="op" id="7936918">.</span><span class="ident" id="7936919">Millisecond</span><span class="op" id="7936930">)</span><span class="op" id="7936931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7936935">c1</span><span class="op" id="7936937">.</span><span class="ident" id="7936938">SetReadDeadline</span><span class="op" id="7936953">(</span><span class="ident" id="7936954">time</span><span class="op" id="7936958">.</span><span class="ident" id="7936959">Now</span><span class="op" id="7936962">(</span><span class="op" id="7936963">)</span><span class="op" id="7936964">.</span><span class="ident" id="7936965">Add</span><span class="op" id="7936968">(</span><span class="num" id="7936969">100</span>&nbsp;<span class="op" id="7936973">*</span>&nbsp;<span class="ident" id="7936975">time</span><span class="op" id="7936979">.</span><span class="ident" id="7936980">Millisecond</span><span class="op" id="7936991">)</span><span class="op" id="7936992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7936996">c1</span><span class="op" id="7936998">.</span><span class="ident" id="7936999">SetWriteDeadline</span><span class="op" id="7937015">(</span><span class="ident" id="7937016">time</span><span class="op" id="7937020">.</span><span class="ident" id="7937021">Now</span><span class="op" id="7937024">(</span><span class="op" id="7937025">)</span><span class="op" id="7937026">.</span><span class="ident" id="7937027">Add</span><span class="op" id="7937030">(</span><span class="num" id="7937031">100</span>&nbsp;<span class="op" id="7937035">*</span>&nbsp;<span class="ident" id="7937037">time</span><span class="op" id="7937041">.</span><span class="ident" id="7937042">Millisecond</span><span class="op" id="7937053">)</span><span class="op" id="7937054">)</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7937059">c2</span><span class="op" id="7937061">,</span>&nbsp;<span class="ident" id="7937063">err</span>&nbsp;<span class="op" id="7937067">:=</span>&nbsp;<span class="ident" id="7937070">Dial</span><span class="op" id="7937074">(</span><span class="ident" id="7937075">tt</span><span class="op" id="7937077">.</span><span class="ident" id="7937078">net</span><span class="op" id="7937081">,</span>&nbsp;<span class="ident" id="7937083">c1</span><span class="op" id="7937085">.</span><span class="ident" id="7937086">LocalAddr</span><span class="op" id="7937095">(</span><span class="op" id="7937096">)</span><span class="op" id="7937097">.</span><span class="ident" id="7937098">String</span><span class="op" id="7937104">(</span><span class="op" id="7937105">)</span><span class="op" id="7937106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7937110">if</span>&nbsp;<span class="ident" id="7937113">err</span>&nbsp;<span class="op" id="7937117">!=</span>&nbsp;<span class="ident" id="7937120">nil</span>&nbsp;<span class="op" id="7937124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7937129">t</span><span class="op" id="7937130">.</span><span class="ident" id="7937131">Fatalf</span><span class="op" id="7937137">(</span><span class="string" id="7937138">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7937155">,</span>&nbsp;<span class="ident" id="7937157">err</span><span class="op" id="7937160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7937164">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7937168">defer</span>&nbsp;<span class="ident" id="7937174">c2</span><span class="op" id="7937176">.</span><span class="ident" id="7937177">Close</span><span class="op" id="7937182">(</span><span class="op" id="7937183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7937187">c2</span><span class="op" id="7937189">.</span><span class="ident" id="7937190">LocalAddr</span><span class="op" id="7937199">(</span><span class="op" id="7937200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7937204">c2</span><span class="op" id="7937206">.</span><span class="ident" id="7937207">RemoteAddr</span><span class="op" id="7937217">(</span><span class="op" id="7937218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7937222">c2</span><span class="op" id="7937224">.</span><span class="ident" id="7937225">SetDeadline</span><span class="op" id="7937236">(</span><span class="ident" id="7937237">time</span><span class="op" id="7937241">.</span><span class="ident" id="7937242">Now</span><span class="op" id="7937245">(</span><span class="op" id="7937246">)</span><span class="op" id="7937247">.</span><span class="ident" id="7937248">Add</span><span class="op" id="7937251">(</span><span class="num" id="7937252">100</span>&nbsp;<span class="op" id="7937256">*</span>&nbsp;<span class="ident" id="7937258">time</span><span class="op" id="7937262">.</span><span class="ident" id="7937263">Millisecond</span><span class="op" id="7937274">)</span><span class="op" id="7937275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7937279">c2</span><span class="op" id="7937281">.</span><span class="ident" id="7937282">SetReadDeadline</span><span class="op" id="7937297">(</span><span class="ident" id="7937298">time</span><span class="op" id="7937302">.</span><span class="ident" id="7937303">Now</span><span class="op" id="7937306">(</span><span class="op" id="7937307">)</span><span class="op" id="7937308">.</span><span class="ident" id="7937309">Add</span><span class="op" id="7937312">(</span><span class="num" id="7937313">100</span>&nbsp;<span class="op" id="7937317">*</span>&nbsp;<span class="ident" id="7937319">time</span><span class="op" id="7937323">.</span><span class="ident" id="7937324">Millisecond</span><span class="op" id="7937335">)</span><span class="op" id="7937336">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7937340">c2</span><span class="op" id="7937342">.</span><span class="ident" id="7937343">SetWriteDeadline</span><span class="op" id="7937359">(</span><span class="ident" id="7937360">time</span><span class="op" id="7937364">.</span><span class="ident" id="7937365">Now</span><span class="op" id="7937368">(</span><span class="op" id="7937369">)</span><span class="op" id="7937370">.</span><span class="ident" id="7937371">Add</span><span class="op" id="7937374">(</span><span class="num" id="7937375">100</span>&nbsp;<span class="op" id="7937379">*</span>&nbsp;<span class="ident" id="7937381">time</span><span class="op" id="7937385">.</span><span class="ident" id="7937386">Millisecond</span><span class="op" id="7937397">)</span><span class="op" id="7937398">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7937403">if</span>&nbsp;<span class="ident" id="7937406">_</span><span class="op" id="7937407">,</span>&nbsp;<span class="ident" id="7937409">err</span>&nbsp;<span class="op" id="7937413">:=</span>&nbsp;<span class="ident" id="7937416">c2</span><span class="op" id="7937418">.</span><span class="ident" id="7937419">Write</span><span class="op" id="7937424">(</span><span class="ident" id="7937425">wb</span><span class="op" id="7937427">)</span><span class="op" id="7937428">;</span>&nbsp;<span class="ident" id="7937430">err</span>&nbsp;<span class="op" id="7937434">!=</span>&nbsp;<span class="ident" id="7937437">nil</span>&nbsp;<span class="op" id="7937441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7937446">t</span><span class="op" id="7937447">.</span><span class="ident" id="7937448">Fatalf</span><span class="op" id="7937454">(</span><span class="string" id="7937455">&#34;Conn.Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7937478">,</span>&nbsp;<span class="ident" id="7937480">err</span><span class="op" id="7937483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7937487">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7937491">rb1</span>&nbsp;<span class="op" id="7937495">:=</span>&nbsp;<span class="builtinfunc" id="7937498">make</span><span class="op" id="7937502">(</span><span class="op" id="7937503">[</span><span class="op" id="7937504">]</span><span class="builtintype" id="7937505">byte</span><span class="op" id="7937509">,</span>&nbsp;<span class="num" id="7937511">128</span><span class="op" id="7937514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7937518">if</span>&nbsp;<span class="ident" id="7937521">_</span><span class="op" id="7937522">,</span>&nbsp;<span class="ident" id="7937524">_</span><span class="op" id="7937525">,</span>&nbsp;<span class="ident" id="7937527">err</span>&nbsp;<span class="op" id="7937531">:=</span>&nbsp;<span class="ident" id="7937534">c1</span><span class="op" id="7937536">.</span><span class="ident" id="7937537">ReadFrom</span><span class="op" id="7937545">(</span><span class="ident" id="7937546">rb1</span><span class="op" id="7937549">)</span><span class="op" id="7937550">;</span>&nbsp;<span class="ident" id="7937552">err</span>&nbsp;<span class="op" id="7937556">!=</span>&nbsp;<span class="ident" id="7937559">nil</span>&nbsp;<span class="op" id="7937563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7937568">t</span><span class="op" id="7937569">.</span><span class="ident" id="7937570">Fatalf</span><span class="op" id="7937576">(</span><span class="string" id="7937577">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7937609">,</span>&nbsp;<span class="ident" id="7937611">err</span><span class="op" id="7937614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7937618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7937622">var</span>&nbsp;<span class="ident" id="7937626">dst</span>&nbsp;<span class="ident" id="7937630">Addr</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7937637">switch</span>&nbsp;<span class="ident" id="7937644">netstr</span><span class="op" id="7937650">[</span><span class="num" id="7937651">0</span><span class="op" id="7937652">]</span>&nbsp;<span class="op" id="7937654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7937658">case</span>&nbsp;<span class="string" id="7937663">&#34;ip&#34;</span><span class="op" id="7937667">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7937672">dst</span>&nbsp;<span class="op" id="7937676">=</span>&nbsp;<span class="op" id="7937678">&amp;</span><span class="ident" id="7937679">IPAddr</span><span class="op" id="7937685">{</span><span class="ident" id="7937686">IP</span><span class="op" id="7937688">:</span>&nbsp;<span class="ident" id="7937690">IPv4</span><span class="op" id="7937694">(</span><span class="num" id="7937695">127</span><span class="op" id="7937698">,</span>&nbsp;<span class="num" id="7937700">0</span><span class="op" id="7937701">,</span>&nbsp;<span class="num" id="7937703">0</span><span class="op" id="7937704">,</span>&nbsp;<span class="num" id="7937706">1</span><span class="op" id="7937707">)</span><span class="op" id="7937708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7937712">case</span>&nbsp;<span class="string" id="7937717">&#34;unixgram&#34;</span><span class="op" id="7937727">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7937732">continue</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7937743">default</span><span class="op" id="7937750">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7937755">dst</span>&nbsp;<span class="op" id="7937759">=</span>&nbsp;<span class="ident" id="7937761">c2</span><span class="op" id="7937763">.</span><span class="ident" id="7937764">LocalAddr</span><span class="op" id="7937773">(</span><span class="op" id="7937774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7937778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7937782">if</span>&nbsp;<span class="ident" id="7937785">_</span><span class="op" id="7937786">,</span>&nbsp;<span class="ident" id="7937788">err</span>&nbsp;<span class="op" id="7937792">:=</span>&nbsp;<span class="ident" id="7937795">c1</span><span class="op" id="7937797">.</span><span class="ident" id="7937798">WriteTo</span><span class="op" id="7937805">(</span><span class="ident" id="7937806">wb</span><span class="op" id="7937808">,</span>&nbsp;<span class="ident" id="7937810">dst</span><span class="op" id="7937813">)</span><span class="op" id="7937814">;</span>&nbsp;<span class="ident" id="7937816">err</span>&nbsp;<span class="op" id="7937820">!=</span>&nbsp;<span class="ident" id="7937823">nil</span>&nbsp;<span class="op" id="7937827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7937832">t</span><span class="op" id="7937833">.</span><span class="ident" id="7937834">Fatalf</span><span class="op" id="7937840">(</span><span class="string" id="7937841">&#34;PacketConn.WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7937872">,</span>&nbsp;<span class="ident" id="7937874">err</span><span class="op" id="7937877">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7937881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7937885">rb2</span>&nbsp;<span class="op" id="7937889">:=</span>&nbsp;<span class="builtinfunc" id="7937892">make</span><span class="op" id="7937896">(</span><span class="op" id="7937897">[</span><span class="op" id="7937898">]</span><span class="builtintype" id="7937899">byte</span><span class="op" id="7937903">,</span>&nbsp;<span class="num" id="7937905">128</span><span class="op" id="7937908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7937912">if</span>&nbsp;<span class="ident" id="7937915">_</span><span class="op" id="7937916">,</span>&nbsp;<span class="ident" id="7937918">err</span>&nbsp;<span class="op" id="7937922">:=</span>&nbsp;<span class="ident" id="7937925">c2</span><span class="op" id="7937927">.</span><span class="ident" id="7937928">Read</span><span class="op" id="7937932">(</span><span class="ident" id="7937933">rb2</span><span class="op" id="7937936">)</span><span class="op" id="7937937">;</span>&nbsp;<span class="ident" id="7937939">err</span>&nbsp;<span class="op" id="7937943">!=</span>&nbsp;<span class="ident" id="7937946">nil</span>&nbsp;<span class="op" id="7937950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7937955">t</span><span class="op" id="7937956">.</span><span class="ident" id="7937957">Fatalf</span><span class="op" id="7937963">(</span><span class="string" id="7937964">&#34;Conn.Read&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7937986">,</span>&nbsp;<span class="ident" id="7937988">err</span><span class="op" id="7937991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7937995">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7937998">}</span><br>
<span class="lineno"></span><span class="op" id="7938000">}</span>
</div>
</body>
</html>
