<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime/debug</h2>
<ul>
<li><a href="/gostd/runtime/debug/garbage.go.html">garbage.go</a></li>
<li><a href="/gostd/runtime/debug/garbage_test.go.html">garbage_test.go</a></li>
<li><a href="/gostd/runtime/debug/heapdump_test.go.html">heapdump_test.go</a></li>
<li><a href="/gostd/runtime/debug/stack.go.html" class="current">stack.go</a></li>
<li><a href="/gostd/runtime/debug/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/debug/stubs.go.html">stubs.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6401544">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6401599">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6401653">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6401704">//&nbsp;Package&nbsp;debug&nbsp;contains&nbsp;facilities&nbsp;for&nbsp;programs&nbsp;to&nbsp;debug&nbsp;themselves&nbsp;while</span><br>
<span class="lineno"></span><span class="comment" id="6401780">//&nbsp;they&nbsp;are&nbsp;running.</span><br>
<span class="lineno"></span><span class="keyword" id="6401801">package</span>&nbsp;<span class="ident" id="6401809">debug</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6401816">import</span>&nbsp;<span class="op" id="6401823">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6401826">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6401835">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6401842">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6401855">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6401861">&#34;runtime&#34;</span><br>
<span class="lineno">15</span><span class="op" id="6401871">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6401874">var</span>&nbsp;<span class="op" id="6401878">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6401881">dunno</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6401891">=</span>&nbsp;<span class="op" id="6401893">[</span><span class="op" id="6401894">]</span><span class="builtintype" id="6401895">byte</span><span class="op" id="6401899">(</span><span class="string" id="6401900">&#34;???&#34;</span><span class="op" id="6401905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6401908">centerDot</span>&nbsp;<span class="op" id="6401918">=</span>&nbsp;<span class="op" id="6401920">[</span><span class="op" id="6401921">]</span><span class="builtintype" id="6401922">byte</span><span class="op" id="6401926">(</span><span class="string" id="6401927">&#34;·&#34;</span><span class="op" id="6401931">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6401934">dot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6401944">=</span>&nbsp;<span class="op" id="6401946">[</span><span class="op" id="6401947">]</span><span class="builtintype" id="6401948">byte</span><span class="op" id="6401952">(</span><span class="string" id="6401953">&#34;.&#34;</span><span class="op" id="6401956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6401959">slash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6401969">=</span>&nbsp;<span class="op" id="6401971">[</span><span class="op" id="6401972">]</span><span class="builtintype" id="6401973">byte</span><span class="op" id="6401977">(</span><span class="string" id="6401978">&#34;/&#34;</span><span class="op" id="6401981">)</span><br>
<span class="lineno"></span><span class="op" id="6401983">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6401986">//&nbsp;PrintStack&nbsp;prints&nbsp;to&nbsp;standard&nbsp;error&nbsp;the&nbsp;stack&nbsp;trace&nbsp;returned&nbsp;by&nbsp;Stack.</span><br>
<span class="lineno">25</span><span class="keyword" id="6402060">func</span>&nbsp;<span class="ident" id="6402065">PrintStack</span><span class="op" id="6402075">(</span><span class="op" id="6402076">)</span>&nbsp;<span class="op" id="6402078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6402081">os</span><span class="op" id="6402083">.</span><span class="ident" id="6402084">Stderr</span><span class="op" id="6402090">.</span><span class="ident" id="6402091">Write</span><span class="op" id="6402096">(</span><span class="ident" id="6402097">stack</span><span class="op" id="6402102">(</span><span class="op" id="6402103">)</span><span class="op" id="6402104">)</span><br>
<span class="lineno"></span><span class="op" id="6402106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6402109">//&nbsp;Stack&nbsp;returns&nbsp;a&nbsp;formatted&nbsp;stack&nbsp;trace&nbsp;of&nbsp;the&nbsp;goroutine&nbsp;that&nbsp;calls&nbsp;it.</span><br>
<span class="lineno">30</span><span class="comment" id="6402182">//&nbsp;For&nbsp;each&nbsp;routine,&nbsp;it&nbsp;includes&nbsp;the&nbsp;source&nbsp;line&nbsp;information&nbsp;and&nbsp;PC&nbsp;value,</span><br>
<span class="lineno"></span><span class="comment" id="6402257">//&nbsp;then&nbsp;attempts&nbsp;to&nbsp;discover,&nbsp;for&nbsp;Go&nbsp;functions,&nbsp;the&nbsp;calling&nbsp;function&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6402329">//&nbsp;method&nbsp;and&nbsp;the&nbsp;text&nbsp;of&nbsp;the&nbsp;line&nbsp;containing&nbsp;the&nbsp;invocation.</span><br>
<span class="lineno"></span><span class="comment" id="6402391">//</span><br>
<span class="lineno"></span><span class="comment" id="6402394">//&nbsp;This&nbsp;function&nbsp;is&nbsp;deprecated.&nbsp;Use&nbsp;package&nbsp;runtime&#39;s&nbsp;Stack&nbsp;instead.</span><br>
<span class="lineno">35</span><span class="keyword" id="6402463">func</span>&nbsp;<span class="ident" id="6402468">Stack</span><span class="op" id="6402473">(</span><span class="op" id="6402474">)</span>&nbsp;<span class="op" id="6402476">[</span><span class="op" id="6402477">]</span><span class="builtintype" id="6402478">byte</span>&nbsp;<span class="op" id="6402483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6402486">return</span>&nbsp;<span class="ident" id="6402493">stack</span><span class="op" id="6402498">(</span><span class="op" id="6402499">)</span><br>
<span class="lineno"></span><span class="op" id="6402501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6402504">//&nbsp;stack&nbsp;implements&nbsp;Stack,&nbsp;skipping&nbsp;2&nbsp;frames</span><br>
<span class="lineno">40</span><span class="keyword" id="6402549">func</span>&nbsp;<span class="ident" id="6402554">stack</span><span class="op" id="6402559">(</span><span class="op" id="6402560">)</span>&nbsp;<span class="op" id="6402562">[</span><span class="op" id="6402563">]</span><span class="builtintype" id="6402564">byte</span>&nbsp;<span class="op" id="6402569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6402572">buf</span>&nbsp;<span class="op" id="6402576">:=</span>&nbsp;<span class="builtinfunc" id="6402579">new</span><span class="op" id="6402582">(</span><span class="ident" id="6402583">bytes</span><span class="op" id="6402588">.</span><span class="ident" id="6402589">Buffer</span><span class="op" id="6402595">)</span>&nbsp;<span class="comment" id="6402597">//&nbsp;the&nbsp;returned&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6402619">//&nbsp;As&nbsp;we&nbsp;loop,&nbsp;we&nbsp;open&nbsp;files&nbsp;and&nbsp;read&nbsp;them.&nbsp;These&nbsp;variables&nbsp;record&nbsp;the&nbsp;currently</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6402701">//&nbsp;loaded&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6402718">var</span>&nbsp;<span class="ident" id="6402722">lines</span>&nbsp;<span class="op" id="6402728">[</span><span class="op" id="6402729">]</span><span class="op" id="6402730">[</span><span class="op" id="6402731">]</span><span class="builtintype" id="6402732">byte</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6402738">var</span>&nbsp;<span class="ident" id="6402742">lastFile</span>&nbsp;<span class="builtintype" id="6402751">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6402759">for</span>&nbsp;<span class="ident" id="6402763">i</span>&nbsp;<span class="op" id="6402765">:=</span>&nbsp;<span class="num" id="6402768">2</span><span class="op" id="6402769">;</span>&nbsp;<span class="op" id="6402771">;</span>&nbsp;<span class="ident" id="6402773">i</span><span class="op" id="6402774">++</span>&nbsp;<span class="op" id="6402777">{</span>&nbsp;<span class="comment" id="6402779">//&nbsp;Caller&nbsp;we&nbsp;care&nbsp;about&nbsp;is&nbsp;the&nbsp;user,&nbsp;2&nbsp;frames&nbsp;up</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6402830">pc</span><span class="op" id="6402832">,</span>&nbsp;<span class="ident" id="6402834">file</span><span class="op" id="6402838">,</span>&nbsp;<span class="ident" id="6402840">line</span><span class="op" id="6402844">,</span>&nbsp;<span class="ident" id="6402846">ok</span>&nbsp;<span class="op" id="6402849">:=</span>&nbsp;<span class="ident" id="6402852">runtime</span><span class="op" id="6402859">.</span><span class="ident" id="6402860">Caller</span><span class="op" id="6402866">(</span><span class="ident" id="6402867">i</span><span class="op" id="6402868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6402872">if</span>&nbsp;<span class="op" id="6402875">!</span><span class="ident" id="6402876">ok</span>&nbsp;<span class="op" id="6402879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6402884">break</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6402892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6402896">//&nbsp;Print&nbsp;this&nbsp;much&nbsp;at&nbsp;least.&nbsp;&nbsp;If&nbsp;we&nbsp;can&#39;t&nbsp;find&nbsp;the&nbsp;source,&nbsp;it&nbsp;won&#39;t&nbsp;show.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6402972">fmt</span><span class="op" id="6402975">.</span><span class="ident" id="6402976">Fprintf</span><span class="op" id="6402983">(</span><span class="ident" id="6402984">buf</span><span class="op" id="6402987">,</span>&nbsp;<span class="string" id="6402989">&#34;%s:%d&nbsp;(0x%x)\n&#34;</span><span class="op" id="6403005">,</span>&nbsp;<span class="ident" id="6403007">file</span><span class="op" id="6403011">,</span>&nbsp;<span class="ident" id="6403013">line</span><span class="op" id="6403017">,</span>&nbsp;<span class="ident" id="6403019">pc</span><span class="op" id="6403021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6403025">if</span>&nbsp;<span class="ident" id="6403028">file</span>&nbsp;<span class="op" id="6403033">!=</span>&nbsp;<span class="ident" id="6403036">lastFile</span>&nbsp;<span class="op" id="6403045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6403050">data</span><span class="op" id="6403054">,</span>&nbsp;<span class="ident" id="6403056">err</span>&nbsp;<span class="op" id="6403060">:=</span>&nbsp;<span class="ident" id="6403063">ioutil</span><span class="op" id="6403069">.</span><span class="ident" id="6403070">ReadFile</span><span class="op" id="6403078">(</span><span class="ident" id="6403079">file</span><span class="op" id="6403083">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6403088">if</span>&nbsp;<span class="ident" id="6403091">err</span>&nbsp;<span class="op" id="6403095">!=</span>&nbsp;<span class="ident" id="6403098">nil</span>&nbsp;<span class="op" id="6403102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6403108">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6403120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6403125">lines</span>&nbsp;<span class="op" id="6403131">=</span>&nbsp;<span class="ident" id="6403133">bytes</span><span class="op" id="6403138">.</span><span class="ident" id="6403139">Split</span><span class="op" id="6403144">(</span><span class="ident" id="6403145">data</span><span class="op" id="6403149">,</span>&nbsp;<span class="op" id="6403151">[</span><span class="op" id="6403152">]</span><span class="builtintype" id="6403153">byte</span><span class="op" id="6403157">{</span><span class="string" id="6403158">&#39;\n&#39;</span><span class="op" id="6403162">}</span><span class="op" id="6403163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6403168">lastFile</span>&nbsp;<span class="op" id="6403177">=</span>&nbsp;<span class="ident" id="6403179">file</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6403186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6403190">line</span><span class="op" id="6403194">--</span>&nbsp;<span class="comment" id="6403197">//&nbsp;in&nbsp;stack&nbsp;trace,&nbsp;lines&nbsp;are&nbsp;1-indexed&nbsp;but&nbsp;our&nbsp;array&nbsp;is&nbsp;0-indexed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6403265">fmt</span><span class="op" id="6403268">.</span><span class="ident" id="6403269">Fprintf</span><span class="op" id="6403276">(</span><span class="ident" id="6403277">buf</span><span class="op" id="6403280">,</span>&nbsp;<span class="string" id="6403282">&#34;\t%s:&nbsp;%s\n&#34;</span><span class="op" id="6403294">,</span>&nbsp;<span class="ident" id="6403296">function</span><span class="op" id="6403304">(</span><span class="ident" id="6403305">pc</span><span class="op" id="6403307">)</span><span class="op" id="6403308">,</span>&nbsp;<span class="ident" id="6403310">source</span><span class="op" id="6403316">(</span><span class="ident" id="6403317">lines</span><span class="op" id="6403322">,</span>&nbsp;<span class="ident" id="6403324">line</span><span class="op" id="6403328">)</span><span class="op" id="6403329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6403332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6403335">return</span>&nbsp;<span class="ident" id="6403342">buf</span><span class="op" id="6403345">.</span><span class="ident" id="6403346">Bytes</span><span class="op" id="6403351">(</span><span class="op" id="6403352">)</span><br>
<span class="lineno">65</span><span class="op" id="6403354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6403357">//&nbsp;source&nbsp;returns&nbsp;a&nbsp;space-trimmed&nbsp;slice&nbsp;of&nbsp;the&nbsp;n&#39;th&nbsp;line.</span><br>
<span class="lineno"></span><span class="keyword" id="6403415">func</span>&nbsp;<span class="ident" id="6403420">source</span><span class="op" id="6403426">(</span><span class="ident" id="6403427">lines</span>&nbsp;<span class="op" id="6403433">[</span><span class="op" id="6403434">]</span><span class="op" id="6403435">[</span><span class="op" id="6403436">]</span><span class="builtintype" id="6403437">byte</span><span class="op" id="6403441">,</span>&nbsp;<span class="ident" id="6403443">n</span>&nbsp;<span class="builtintype" id="6403445">int</span><span class="op" id="6403448">)</span>&nbsp;<span class="op" id="6403450">[</span><span class="op" id="6403451">]</span><span class="builtintype" id="6403452">byte</span>&nbsp;<span class="op" id="6403457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6403460">if</span>&nbsp;<span class="ident" id="6403463">n</span>&nbsp;<span class="op" id="6403465">&lt;</span>&nbsp;<span class="num" id="6403467">0</span>&nbsp;<span class="op" id="6403469">||</span>&nbsp;<span class="ident" id="6403472">n</span>&nbsp;<span class="op" id="6403474">&gt;=</span>&nbsp;<span class="builtinfunc" id="6403477">len</span><span class="op" id="6403480">(</span><span class="ident" id="6403481">lines</span><span class="op" id="6403486">)</span>&nbsp;<span class="op" id="6403488">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6403492">return</span>&nbsp;<span class="ident" id="6403499">dunno</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6403506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6403509">return</span>&nbsp;<span class="ident" id="6403516">bytes</span><span class="op" id="6403521">.</span><span class="ident" id="6403522">Trim</span><span class="op" id="6403526">(</span><span class="ident" id="6403527">lines</span><span class="op" id="6403532">[</span><span class="ident" id="6403533">n</span><span class="op" id="6403534">]</span><span class="op" id="6403535">,</span>&nbsp;<span class="string" id="6403537">&#34;&nbsp;\t&#34;</span><span class="op" id="6403542">)</span><br>
<span class="lineno"></span><span class="op" id="6403544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="6403547">//&nbsp;function&nbsp;returns,&nbsp;if&nbsp;possible,&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;function&nbsp;containing&nbsp;the&nbsp;PC.</span><br>
<span class="lineno"></span><span class="keyword" id="6403625">func</span>&nbsp;<span class="ident" id="6403630">function</span><span class="op" id="6403638">(</span><span class="ident" id="6403639">pc</span>&nbsp;<span class="builtintype" id="6403642">uintptr</span><span class="op" id="6403649">)</span>&nbsp;<span class="op" id="6403651">[</span><span class="op" id="6403652">]</span><span class="builtintype" id="6403653">byte</span>&nbsp;<span class="op" id="6403658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6403661">fn</span>&nbsp;<span class="op" id="6403664">:=</span>&nbsp;<span class="ident" id="6403667">runtime</span><span class="op" id="6403674">.</span><span class="ident" id="6403675">FuncForPC</span><span class="op" id="6403684">(</span><span class="ident" id="6403685">pc</span><span class="op" id="6403687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6403690">if</span>&nbsp;<span class="ident" id="6403693">fn</span>&nbsp;<span class="op" id="6403696">==</span>&nbsp;<span class="ident" id="6403699">nil</span>&nbsp;<span class="op" id="6403703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6403707">return</span>&nbsp;<span class="ident" id="6403714">dunno</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6403721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6403724">name</span>&nbsp;<span class="op" id="6403729">:=</span>&nbsp;<span class="op" id="6403732">[</span><span class="op" id="6403733">]</span><span class="builtintype" id="6403734">byte</span><span class="op" id="6403738">(</span><span class="ident" id="6403739">fn</span><span class="op" id="6403741">.</span><span class="ident" id="6403742">Name</span><span class="op" id="6403746">(</span><span class="op" id="6403747">)</span><span class="op" id="6403748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6403751">//&nbsp;The&nbsp;name&nbsp;includes&nbsp;the&nbsp;path&nbsp;name&nbsp;to&nbsp;the&nbsp;package,&nbsp;which&nbsp;is&nbsp;unnecessary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6403824">//&nbsp;since&nbsp;the&nbsp;file&nbsp;name&nbsp;is&nbsp;already&nbsp;included.&nbsp;&nbsp;Plus,&nbsp;it&nbsp;has&nbsp;center&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6403896">//&nbsp;That&nbsp;is,&nbsp;we&nbsp;see</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6403916">//&nbsp;&nbsp;&nbsp;&nbspruntime/debug.*T·ptrmethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6403948">//&nbsp;and&nbsp;want</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6403961">//&nbsp;&nbsp;&nbsp;&nbsp*T.ptrmethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6403978">//&nbsp;Since&nbsp;the&nbsp;package&nbsp;path&nbsp;might&nbsp;contains&nbsp;dots&nbsp;(e.g.&nbsp;code.google.com/...),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6404053">//&nbsp;we&nbsp;first&nbsp;remove&nbsp;the&nbsp;path&nbsp;prefix&nbsp;if&nbsp;there&nbsp;is&nbsp;one.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6404106">if</span>&nbsp;<span class="ident" id="6404109">lastslash</span>&nbsp;<span class="op" id="6404119">:=</span>&nbsp;<span class="ident" id="6404122">bytes</span><span class="op" id="6404127">.</span><span class="ident" id="6404128">LastIndex</span><span class="op" id="6404137">(</span><span class="ident" id="6404138">name</span><span class="op" id="6404142">,</span>&nbsp;<span class="ident" id="6404144">slash</span><span class="op" id="6404149">)</span><span class="op" id="6404150">;</span>&nbsp;<span class="ident" id="6404152">lastslash</span>&nbsp;<span class="op" id="6404162">&gt;=</span>&nbsp;<span class="num" id="6404165">0</span>&nbsp;<span class="op" id="6404167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6404171">name</span>&nbsp;<span class="op" id="6404176">=</span>&nbsp;<span class="ident" id="6404178">name</span><span class="op" id="6404182">[</span><span class="ident" id="6404183">lastslash</span><span class="op" id="6404192">+</span><span class="num" id="6404193">1</span><span class="op" id="6404194">:</span><span class="op" id="6404195">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6404198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6404201">if</span>&nbsp;<span class="ident" id="6404204">period</span>&nbsp;<span class="op" id="6404211">:=</span>&nbsp;<span class="ident" id="6404214">bytes</span><span class="op" id="6404219">.</span><span class="ident" id="6404220">Index</span><span class="op" id="6404225">(</span><span class="ident" id="6404226">name</span><span class="op" id="6404230">,</span>&nbsp;<span class="ident" id="6404232">dot</span><span class="op" id="6404235">)</span><span class="op" id="6404236">;</span>&nbsp;<span class="ident" id="6404238">period</span>&nbsp;<span class="op" id="6404245">&gt;=</span>&nbsp;<span class="num" id="6404248">0</span>&nbsp;<span class="op" id="6404250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6404254">name</span>&nbsp;<span class="op" id="6404259">=</span>&nbsp;<span class="ident" id="6404261">name</span><span class="op" id="6404265">[</span><span class="ident" id="6404266">period</span><span class="op" id="6404272">+</span><span class="num" id="6404273">1</span><span class="op" id="6404274">:</span><span class="op" id="6404275">]</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6404278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6404281">name</span>&nbsp;<span class="op" id="6404286">=</span>&nbsp;<span class="ident" id="6404288">bytes</span><span class="op" id="6404293">.</span><span class="ident" id="6404294">Replace</span><span class="op" id="6404301">(</span><span class="ident" id="6404302">name</span><span class="op" id="6404306">,</span>&nbsp;<span class="ident" id="6404308">centerDot</span><span class="op" id="6404317">,</span>&nbsp;<span class="ident" id="6404319">dot</span><span class="op" id="6404322">,</span>&nbsp;<span class="op" id="6404324">-</span><span class="num" id="6404325">1</span><span class="op" id="6404326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6404329">return</span>&nbsp;<span class="ident" id="6404336">name</span><br>
<span class="lineno"></span><span class="op" id="6404341">}</span>
</div>
</body>
</html>
