<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/md5</h2>
<ul>
<li><a href="/gostd/crypto/md5/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/md5/md5.go.html">md5.go</a></li>
<li><a href="/gostd/crypto/md5/md5_test.go.html" class="current">md5_test.go</a></li>
<li><a href="/gostd/crypto/md5/md5block.go.html">md5block.go</a></li>
<li><a href="/gostd/crypto/md5/md5block_decl.go.html">md5block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7373706">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7373761">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7373815">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7373866">package</span>&nbsp;<span class="ident" id="7373874">md5</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7373879">import</span>&nbsp;<span class="op" id="7373886">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7373889">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7373904">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7373911">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7373917">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7373928">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="7373937">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="7373940">type</span>&nbsp;<span class="ident" id="7373945">md5Test</span>&nbsp;<span class="keyword" id="7373953">struct</span>&nbsp;<span class="op" id="7373960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7373963">out</span>&nbsp;<span class="builtintype" id="7373967">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7373975">in</span>&nbsp;&nbsp;<span class="builtintype" id="7373979">string</span><br>
<span class="lineno"></span><span class="op" id="7373986">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="7373989">var</span>&nbsp;<span class="ident" id="7373993">golden</span>&nbsp;<span class="op" id="7374000">=</span>&nbsp;<span class="op" id="7374002">[</span><span class="op" id="7374003">]</span><span class="ident" id="7374004">md5Test</span><span class="op" id="7374011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7374014">{</span><span class="string" id="7374015">&#34;d41d8cd98f00b204e9800998ecf8427e&#34;</span><span class="op" id="7374049">,</span>&nbsp;<span class="string" id="7374051">&#34;&#34;</span><span class="op" id="7374053">}</span><span class="op" id="7374054">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7374057">{</span><span class="string" id="7374058">&#34;0cc175b9c0f1b6a831c399e269772661&#34;</span><span class="op" id="7374092">,</span>&nbsp;<span class="string" id="7374094">&#34;a&#34;</span><span class="op" id="7374097">}</span><span class="op" id="7374098">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7374101">{</span><span class="string" id="7374102">&#34;187ef4436122d1cc2f40dc2b92f0eba0&#34;</span><span class="op" id="7374136">,</span>&nbsp;<span class="string" id="7374138">&#34;ab&#34;</span><span class="op" id="7374142">}</span><span class="op" id="7374143">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7374146">{</span><span class="string" id="7374147">&#34;900150983cd24fb0d6963f7d28e17f72&#34;</span><span class="op" id="7374181">,</span>&nbsp;<span class="string" id="7374183">&#34;abc&#34;</span><span class="op" id="7374188">}</span><span class="op" id="7374189">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7374192">{</span><span class="string" id="7374193">&#34;e2fc714c4727ee9395f324cd2e7f331f&#34;</span><span class="op" id="7374227">,</span>&nbsp;<span class="string" id="7374229">&#34;abcd&#34;</span><span class="op" id="7374235">}</span><span class="op" id="7374236">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7374239">{</span><span class="string" id="7374240">&#34;ab56b4d92b40713acc5af89985d4b786&#34;</span><span class="op" id="7374274">,</span>&nbsp;<span class="string" id="7374276">&#34;abcde&#34;</span><span class="op" id="7374283">}</span><span class="op" id="7374284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7374287">{</span><span class="string" id="7374288">&#34;e80b5017098950fc58aad83c8c14978e&#34;</span><span class="op" id="7374322">,</span>&nbsp;<span class="string" id="7374324">&#34;abcdef&#34;</span><span class="op" id="7374332">}</span><span class="op" id="7374333">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7374336">{</span><span class="string" id="7374337">&#34;7ac66c0f148de9519b8bd264312c4d64&#34;</span><span class="op" id="7374371">,</span>&nbsp;<span class="string" id="7374373">&#34;abcdefg&#34;</span><span class="op" id="7374382">}</span><span class="op" id="7374383">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7374386">{</span><span class="string" id="7374387">&#34;e8dc4081b13434b45189a720b77b6818&#34;</span><span class="op" id="7374421">,</span>&nbsp;<span class="string" id="7374423">&#34;abcdefgh&#34;</span><span class="op" id="7374433">}</span><span class="op" id="7374434">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7374437">{</span><span class="string" id="7374438">&#34;8aa99b1f439ff71293e95357bac6fd94&#34;</span><span class="op" id="7374472">,</span>&nbsp;<span class="string" id="7374474">&#34;abcdefghi&#34;</span><span class="op" id="7374485">}</span><span class="op" id="7374486">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7374489">{</span><span class="string" id="7374490">&#34;a925576942e94b2ef57a066101b48876&#34;</span><span class="op" id="7374524">,</span>&nbsp;<span class="string" id="7374526">&#34;abcdefghij&#34;</span><span class="op" id="7374538">}</span><span class="op" id="7374539">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7374542">{</span><span class="string" id="7374543">&#34;d747fc1719c7eacb84058196cfe56d57&#34;</span><span class="op" id="7374577">,</span>&nbsp;<span class="string" id="7374579">&#34;Discard&nbsp;medicine&nbsp;more&nbsp;than&nbsp;two&nbsp;years&nbsp;old.&#34;</span><span class="op" id="7374622">}</span><span class="op" id="7374623">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7374626">{</span><span class="string" id="7374627">&#34;bff2dcb37ef3a44ba43ab144768ca837&#34;</span><span class="op" id="7374661">,</span>&nbsp;<span class="string" id="7374663">&#34;He&nbsp;who&nbsp;has&nbsp;a&nbsp;shady&nbsp;past&nbsp;knows&nbsp;that&nbsp;nice&nbsp;guys&nbsp;finish&nbsp;last.&#34;</span><span class="op" id="7374722">}</span><span class="op" id="7374723">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7374726">{</span><span class="string" id="7374727">&#34;0441015ecb54a7342d017ed1bcfdbea5&#34;</span><span class="op" id="7374761">,</span>&nbsp;<span class="string" id="7374763">&#34;I&nbsp;wouldn&#39;t&nbsp;marry&nbsp;him&nbsp;with&nbsp;a&nbsp;ten&nbsp;foot&nbsp;pole.&#34;</span><span class="op" id="7374807">}</span><span class="op" id="7374808">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7374811">{</span><span class="string" id="7374812">&#34;9e3cac8e9e9757a60c3ea391130d3689&#34;</span><span class="op" id="7374846">,</span>&nbsp;<span class="string" id="7374848">&#34;Free!&nbsp;Free!/A&nbsp;trip/to&nbsp;Mars/for&nbsp;900/empty&nbsp;jars/Burma&nbsp;Shave&#34;</span><span class="op" id="7374907">}</span><span class="op" id="7374908">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7374911">{</span><span class="string" id="7374912">&#34;a0f04459b031f916a59a35cc482dc039&#34;</span><span class="op" id="7374946">,</span>&nbsp;<span class="string" id="7374948">&#34;The&nbsp;days&nbsp;of&nbsp;the&nbsp;digital&nbsp;watch&nbsp;are&nbsp;numbered.&nbsp;&nbsp;-Tom&nbsp;Stoppard&#34;</span><span class="op" id="7375008">}</span><span class="op" id="7375009">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7375012">{</span><span class="string" id="7375013">&#34;e7a48e0fe884faf31475d2a04b1362cc&#34;</span><span class="op" id="7375047">,</span>&nbsp;<span class="string" id="7375049">&#34;Nepal&nbsp;premier&nbsp;won&#39;t&nbsp;resign.&#34;</span><span class="op" id="7375078">}</span><span class="op" id="7375079">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7375082">{</span><span class="string" id="7375083">&#34;637d2fe925c07c113800509964fb0e06&#34;</span><span class="op" id="7375117">,</span>&nbsp;<span class="string" id="7375119">&#34;For&nbsp;every&nbsp;action&nbsp;there&nbsp;is&nbsp;an&nbsp;equal&nbsp;and&nbsp;opposite&nbsp;government&nbsp;program.&#34;</span><span class="op" id="7375188">}</span><span class="op" id="7375189">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7375192">{</span><span class="string" id="7375193">&#34;834a8d18d5c6562119cf4c7f5086cb71&#34;</span><span class="op" id="7375227">,</span>&nbsp;<span class="string" id="7375229">&#34;His&nbsp;money&nbsp;is&nbsp;twice&nbsp;tainted:&nbsp;&#39;taint&nbsp;yours&nbsp;and&nbsp;&#39;taint&nbsp;mine.&#34;</span><span class="op" id="7375288">}</span><span class="op" id="7375289">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7375292">{</span><span class="string" id="7375293">&#34;de3a4d2fd6c73ec2db2abad23b444281&#34;</span><span class="op" id="7375327">,</span>&nbsp;<span class="string" id="7375329">&#34;There&nbsp;is&nbsp;no&nbsp;reason&nbsp;for&nbsp;any&nbsp;individual&nbsp;to&nbsp;have&nbsp;a&nbsp;computer&nbsp;in&nbsp;their&nbsp;home.&nbsp;-Ken&nbsp;Olsen,&nbsp;1977&#34;</span><span class="op" id="7375419">}</span><span class="op" id="7375420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7375423">{</span><span class="string" id="7375424">&#34;acf203f997e2cf74ea3aff86985aefaf&#34;</span><span class="op" id="7375458">,</span>&nbsp;<span class="string" id="7375460">&#34;It&#39;s&nbsp;a&nbsp;tiny&nbsp;change&nbsp;to&nbsp;the&nbsp;code&nbsp;and&nbsp;not&nbsp;completely&nbsp;disgusting.&nbsp;-&nbsp;Bob&nbsp;Manchek&#34;</span><span class="op" id="7375537">}</span><span class="op" id="7375538">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7375541">{</span><span class="string" id="7375542">&#34;e1c1384cb4d2221dfdd7c795a4222c9a&#34;</span><span class="op" id="7375576">,</span>&nbsp;<span class="string" id="7375578">&#34;size:&nbsp;&nbsp;a.out:&nbsp;&nbsp;bad&nbsp;magic&#34;</span><span class="op" id="7375604">}</span><span class="op" id="7375605">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7375608">{</span><span class="string" id="7375609">&#34;c90f3ddecc54f34228c063d7525bf644&#34;</span><span class="op" id="7375643">,</span>&nbsp;<span class="string" id="7375645">&#34;The&nbsp;major&nbsp;problem&nbsp;is&nbsp;with&nbsp;sendmail.&nbsp;&nbsp;-Mark&nbsp;Horton&#34;</span><span class="op" id="7375696">}</span><span class="op" id="7375697">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7375700">{</span><span class="string" id="7375701">&#34;cdf7ab6c1fd49bd9933c43f3ea5af185&#34;</span><span class="op" id="7375735">,</span>&nbsp;<span class="string" id="7375737">&#34;Give&nbsp;me&nbsp;a&nbsp;rock,&nbsp;paper&nbsp;and&nbsp;scissors&nbsp;and&nbsp;I&nbsp;will&nbsp;move&nbsp;the&nbsp;world.&nbsp;&nbsp;CCFestoon&#34;</span><span class="op" id="7375811">}</span><span class="op" id="7375812">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7375815">{</span><span class="string" id="7375816">&#34;83bc85234942fc883c063cbd7f0ad5d0&#34;</span><span class="op" id="7375850">,</span>&nbsp;<span class="string" id="7375852">&#34;If&nbsp;the&nbsp;enemy&nbsp;is&nbsp;within&nbsp;range,&nbsp;then&nbsp;so&nbsp;are&nbsp;you.&#34;</span><span class="op" id="7375900">}</span><span class="op" id="7375901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7375904">{</span><span class="string" id="7375905">&#34;277cbe255686b48dd7e8f389394d9299&#34;</span><span class="op" id="7375939">,</span>&nbsp;<span class="string" id="7375941">&#34;It&#39;s&nbsp;well&nbsp;we&nbsp;cannot&nbsp;hear&nbsp;the&nbsp;screams/That&nbsp;we&nbsp;create&nbsp;in&nbsp;others&#39;&nbsp;dreams.&#34;</span><span class="op" id="7376013">}</span><span class="op" id="7376014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7376017">{</span><span class="string" id="7376018">&#34;fd3fb0a7ffb8af16603f3d3af98f8e1f&#34;</span><span class="op" id="7376052">,</span>&nbsp;<span class="string" id="7376054">&#34;You&nbsp;remind&nbsp;me&nbsp;of&nbsp;a&nbsp;TV&nbsp;show,&nbsp;but&nbsp;that&#39;s&nbsp;all&nbsp;right:&nbsp;I&nbsp;watch&nbsp;it&nbsp;anyway.&#34;</span><span class="op" id="7376124">}</span><span class="op" id="7376125">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7376128">{</span><span class="string" id="7376129">&#34;469b13a78ebf297ecda64d4723655154&#34;</span><span class="op" id="7376163">,</span>&nbsp;<span class="string" id="7376165">&#34;C&nbsp;is&nbsp;as&nbsp;portable&nbsp;as&nbsp;Stonehedge!!&#34;</span><span class="op" id="7376199">}</span><span class="op" id="7376200">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7376203">{</span><span class="string" id="7376204">&#34;63eb3a2f466410104731c4b037600110&#34;</span><span class="op" id="7376238">,</span>&nbsp;<span class="string" id="7376240">&#34;Even&nbsp;if&nbsp;I&nbsp;could&nbsp;be&nbsp;Shakespeare,&nbsp;I&nbsp;think&nbsp;I&nbsp;should&nbsp;still&nbsp;choose&nbsp;to&nbsp;be&nbsp;Faraday.&nbsp;-&nbsp;A.&nbsp;Huxley&#34;</span><span class="op" id="7376330">}</span><span class="op" id="7376331">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7376334">{</span><span class="string" id="7376335">&#34;72c2ed7592debca1c90fc0100f931a2f&#34;</span><span class="op" id="7376369">,</span>&nbsp;<span class="string" id="7376371">&#34;The&nbsp;fugacity&nbsp;of&nbsp;a&nbsp;constituent&nbsp;in&nbsp;a&nbsp;mixture&nbsp;of&nbsp;gases&nbsp;at&nbsp;a&nbsp;given&nbsp;temperature&nbsp;is&nbsp;proportional&nbsp;to&nbsp;its&nbsp;mole&nbsp;fraction.&nbsp;&nbsp;Lewis-Randall&nbsp;Rule&#34;</span><span class="op" id="7376505">}</span><span class="op" id="7376506">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7376509">{</span><span class="string" id="7376510">&#34;132f7619d33b523b1d9e5bd8e0928355&#34;</span><span class="op" id="7376544">,</span>&nbsp;<span class="string" id="7376546">&#34;How&nbsp;can&nbsp;you&nbsp;write&nbsp;a&nbsp;big&nbsp;system&nbsp;without&nbsp;C++?&nbsp;&nbsp;-Paul&nbsp;Glick&#34;</span><span class="op" id="7376604">}</span><span class="op" id="7376605">,</span><br>
<span class="lineno"></span><span class="op" id="7376607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7376610">func</span>&nbsp;<span class="ident" id="7376615">TestGolden</span><span class="op" id="7376625">(</span><span class="ident" id="7376626">t</span>&nbsp;<span class="op" id="7376628">*</span><span class="ident" id="7376629">testing</span><span class="op" id="7376636">.</span><span class="ident" id="7376637">T</span><span class="op" id="7376638">)</span>&nbsp;<span class="op" id="7376640">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7376643">for</span>&nbsp;<span class="ident" id="7376647">i</span>&nbsp;<span class="op" id="7376649">:=</span>&nbsp;<span class="num" id="7376652">0</span><span class="op" id="7376653">;</span>&nbsp;<span class="ident" id="7376655">i</span>&nbsp;<span class="op" id="7376657">&lt;</span>&nbsp;<span class="builtinfunc" id="7376659">len</span><span class="op" id="7376662">(</span><span class="ident" id="7376663">golden</span><span class="op" id="7376669">)</span><span class="op" id="7376670">;</span>&nbsp;<span class="ident" id="7376672">i</span><span class="op" id="7376673">++</span>&nbsp;<span class="op" id="7376676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7376680">g</span>&nbsp;<span class="op" id="7376682">:=</span>&nbsp;<span class="ident" id="7376685">golden</span><span class="op" id="7376691">[</span><span class="ident" id="7376692">i</span><span class="op" id="7376693">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7376697">s</span>&nbsp;<span class="op" id="7376699">:=</span>&nbsp;<span class="ident" id="7376702">fmt</span><span class="op" id="7376705">.</span><span class="ident" id="7376706">Sprintf</span><span class="op" id="7376713">(</span><span class="string" id="7376714">&#34;%x&#34;</span><span class="op" id="7376718">,</span>&nbsp;<span class="ident" id="7376720">Sum</span><span class="op" id="7376723">(</span><span class="op" id="7376724">[</span><span class="op" id="7376725">]</span><span class="builtintype" id="7376726">byte</span><span class="op" id="7376730">(</span><span class="ident" id="7376731">g</span><span class="op" id="7376732">.</span><span class="ident" id="7376733">in</span><span class="op" id="7376735">)</span><span class="op" id="7376736">)</span><span class="op" id="7376737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7376741">if</span>&nbsp;<span class="ident" id="7376744">s</span>&nbsp;<span class="op" id="7376746">!=</span>&nbsp;<span class="ident" id="7376749">g</span><span class="op" id="7376750">.</span><span class="ident" id="7376751">out</span>&nbsp;<span class="op" id="7376755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7376760">t</span><span class="op" id="7376761">.</span><span class="ident" id="7376762">Fatalf</span><span class="op" id="7376768">(</span><span class="string" id="7376769">&#34;Sum&nbsp;function:&nbsp;md5(%s)&nbsp;=&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7376805">,</span>&nbsp;<span class="ident" id="7376807">g</span><span class="op" id="7376808">.</span><span class="ident" id="7376809">in</span><span class="op" id="7376811">,</span>&nbsp;<span class="ident" id="7376813">s</span><span class="op" id="7376814">,</span>&nbsp;<span class="ident" id="7376816">g</span><span class="op" id="7376817">.</span><span class="ident" id="7376818">out</span><span class="op" id="7376821">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7376825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7376829">c</span>&nbsp;<span class="op" id="7376831">:=</span>&nbsp;<span class="ident" id="7376834">New</span><span class="op" id="7376837">(</span><span class="op" id="7376838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7376842">buf</span>&nbsp;<span class="op" id="7376846">:=</span>&nbsp;<span class="builtinfunc" id="7376849">make</span><span class="op" id="7376853">(</span><span class="op" id="7376854">[</span><span class="op" id="7376855">]</span><span class="builtintype" id="7376856">byte</span><span class="op" id="7376860">,</span>&nbsp;<span class="builtinfunc" id="7376862">len</span><span class="op" id="7376865">(</span><span class="ident" id="7376866">g</span><span class="op" id="7376867">.</span><span class="ident" id="7376868">in</span><span class="op" id="7376870">)</span><span class="op" id="7376871">+</span><span class="num" id="7376872">4</span><span class="op" id="7376873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7376877">for</span>&nbsp;<span class="ident" id="7376881">j</span>&nbsp;<span class="op" id="7376883">:=</span>&nbsp;<span class="num" id="7376886">0</span><span class="op" id="7376887">;</span>&nbsp;<span class="ident" id="7376889">j</span>&nbsp;<span class="op" id="7376891">&lt;</span>&nbsp;<span class="num" id="7376893">3</span><span class="op" id="7376894">+</span><span class="num" id="7376895">4</span><span class="op" id="7376896">;</span>&nbsp;<span class="ident" id="7376898">j</span><span class="op" id="7376899">++</span>&nbsp;<span class="op" id="7376902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7376907">if</span>&nbsp;<span class="ident" id="7376910">j</span>&nbsp;<span class="op" id="7376912">&lt;</span>&nbsp;<span class="num" id="7376914">2</span>&nbsp;<span class="op" id="7376916">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7376922">io</span><span class="op" id="7376924">.</span><span class="ident" id="7376925">WriteString</span><span class="op" id="7376936">(</span><span class="ident" id="7376937">c</span><span class="op" id="7376938">,</span>&nbsp;<span class="ident" id="7376940">g</span><span class="op" id="7376941">.</span><span class="ident" id="7376942">in</span><span class="op" id="7376944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7376949">}</span>&nbsp;<span class="keyword" id="7376951">else</span>&nbsp;<span class="keyword" id="7376956">if</span>&nbsp;<span class="ident" id="7376959">j</span>&nbsp;<span class="op" id="7376961">==</span>&nbsp;<span class="num" id="7376964">2</span>&nbsp;<span class="op" id="7376966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7376972">io</span><span class="op" id="7376974">.</span><span class="ident" id="7376975">WriteString</span><span class="op" id="7376986">(</span><span class="ident" id="7376987">c</span><span class="op" id="7376988">,</span>&nbsp;<span class="ident" id="7376990">g</span><span class="op" id="7376991">.</span><span class="ident" id="7376992">in</span><span class="op" id="7376994">[</span><span class="num" id="7376995">0</span><span class="op" id="7376996">:</span><span class="builtinfunc" id="7376997">len</span><span class="op" id="7377000">(</span><span class="ident" id="7377001">g</span><span class="op" id="7377002">.</span><span class="ident" id="7377003">in</span><span class="op" id="7377005">)</span><span class="op" id="7377006">/</span><span class="num" id="7377007">2</span><span class="op" id="7377008">]</span><span class="op" id="7377009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7377015">c</span><span class="op" id="7377016">.</span><span class="ident" id="7377017">Sum</span><span class="op" id="7377020">(</span><span class="ident" id="7377021">nil</span><span class="op" id="7377024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7377030">io</span><span class="op" id="7377032">.</span><span class="ident" id="7377033">WriteString</span><span class="op" id="7377044">(</span><span class="ident" id="7377045">c</span><span class="op" id="7377046">,</span>&nbsp;<span class="ident" id="7377048">g</span><span class="op" id="7377049">.</span><span class="ident" id="7377050">in</span><span class="op" id="7377052">[</span><span class="builtinfunc" id="7377053">len</span><span class="op" id="7377056">(</span><span class="ident" id="7377057">g</span><span class="op" id="7377058">.</span><span class="ident" id="7377059">in</span><span class="op" id="7377061">)</span><span class="op" id="7377062">/</span><span class="num" id="7377063">2</span><span class="op" id="7377064">:</span><span class="op" id="7377065">]</span><span class="op" id="7377066">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7377071">}</span>&nbsp;<span class="keyword" id="7377073">else</span>&nbsp;<span class="keyword" id="7377078">if</span>&nbsp;<span class="ident" id="7377081">j</span>&nbsp;<span class="op" id="7377083">&gt;</span>&nbsp;<span class="num" id="7377085">2</span>&nbsp;<span class="op" id="7377087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7377093">//&nbsp;test&nbsp;unaligned&nbsp;write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7377121">buf</span>&nbsp;<span class="op" id="7377125">=</span>&nbsp;<span class="ident" id="7377127">buf</span><span class="op" id="7377130">[</span><span class="num" id="7377131">1</span><span class="op" id="7377132">:</span><span class="op" id="7377133">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7377139">copy</span><span class="op" id="7377143">(</span><span class="ident" id="7377144">buf</span><span class="op" id="7377147">,</span>&nbsp;<span class="ident" id="7377149">g</span><span class="op" id="7377150">.</span><span class="ident" id="7377151">in</span><span class="op" id="7377153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7377159">c</span><span class="op" id="7377160">.</span><span class="ident" id="7377161">Write</span><span class="op" id="7377166">(</span><span class="ident" id="7377167">buf</span><span class="op" id="7377170">[</span><span class="op" id="7377171">:</span><span class="builtinfunc" id="7377172">len</span><span class="op" id="7377175">(</span><span class="ident" id="7377176">g</span><span class="op" id="7377177">.</span><span class="ident" id="7377178">in</span><span class="op" id="7377180">)</span><span class="op" id="7377181">]</span><span class="op" id="7377182">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7377187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7377192">s</span>&nbsp;<span class="op" id="7377194">:=</span>&nbsp;<span class="ident" id="7377197">fmt</span><span class="op" id="7377200">.</span><span class="ident" id="7377201">Sprintf</span><span class="op" id="7377208">(</span><span class="string" id="7377209">&#34;%x&#34;</span><span class="op" id="7377213">,</span>&nbsp;<span class="ident" id="7377215">c</span><span class="op" id="7377216">.</span><span class="ident" id="7377217">Sum</span><span class="op" id="7377220">(</span><span class="ident" id="7377221">nil</span><span class="op" id="7377224">)</span><span class="op" id="7377225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7377230">if</span>&nbsp;<span class="ident" id="7377233">s</span>&nbsp;<span class="op" id="7377235">!=</span>&nbsp;<span class="ident" id="7377238">g</span><span class="op" id="7377239">.</span><span class="ident" id="7377240">out</span>&nbsp;<span class="op" id="7377244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7377250">t</span><span class="op" id="7377251">.</span><span class="ident" id="7377252">Fatalf</span><span class="op" id="7377258">(</span><span class="string" id="7377259">&#34;md5[%d](%s)&nbsp;=&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7377285">,</span>&nbsp;<span class="ident" id="7377287">j</span><span class="op" id="7377288">,</span>&nbsp;<span class="ident" id="7377290">g</span><span class="op" id="7377291">.</span><span class="ident" id="7377292">in</span><span class="op" id="7377294">,</span>&nbsp;<span class="ident" id="7377296">s</span><span class="op" id="7377297">,</span>&nbsp;<span class="ident" id="7377299">g</span><span class="op" id="7377300">.</span><span class="ident" id="7377301">out</span><span class="op" id="7377304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7377309">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7377314">c</span><span class="op" id="7377315">.</span><span class="ident" id="7377316">Reset</span><span class="op" id="7377321">(</span><span class="op" id="7377322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7377326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7377329">}</span><br>
<span class="lineno"></span><span class="op" id="7377331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="keyword" id="7377334">func</span>&nbsp;<span class="ident" id="7377339">TestLarge</span><span class="op" id="7377348">(</span><span class="ident" id="7377349">t</span>&nbsp;<span class="op" id="7377351">*</span><span class="ident" id="7377352">testing</span><span class="op" id="7377359">.</span><span class="ident" id="7377360">T</span><span class="op" id="7377361">)</span>&nbsp;<span class="op" id="7377363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7377366">const</span>&nbsp;<span class="ident" id="7377372">N</span>&nbsp;<span class="op" id="7377374">=</span>&nbsp;<span class="num" id="7377376">10000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7377383">ok</span>&nbsp;<span class="op" id="7377386">:=</span>&nbsp;<span class="string" id="7377389">&#34;2bb571599a4180e1d542f76904adc3df&#34;</span>&nbsp;<span class="comment" id="7377424">//&nbsp;md5sum&nbsp;of&nbsp;&#34;0123456789&#34;&nbsp;*&nbsp;1000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7377458">block</span>&nbsp;<span class="op" id="7377464">:=</span>&nbsp;<span class="builtinfunc" id="7377467">make</span><span class="op" id="7377471">(</span><span class="op" id="7377472">[</span><span class="op" id="7377473">]</span><span class="builtintype" id="7377474">byte</span><span class="op" id="7377478">,</span>&nbsp;<span class="num" id="7377480">10004</span><span class="op" id="7377485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7377488">c</span>&nbsp;<span class="op" id="7377490">:=</span>&nbsp;<span class="ident" id="7377493">New</span><span class="op" id="7377496">(</span><span class="op" id="7377497">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7377500">for</span>&nbsp;<span class="ident" id="7377504">offset</span>&nbsp;<span class="op" id="7377511">:=</span>&nbsp;<span class="num" id="7377514">0</span><span class="op" id="7377515">;</span>&nbsp;<span class="ident" id="7377517">offset</span>&nbsp;<span class="op" id="7377524">&lt;</span>&nbsp;<span class="num" id="7377526">4</span><span class="op" id="7377527">;</span>&nbsp;<span class="ident" id="7377529">offset</span><span class="op" id="7377535">++</span>&nbsp;<span class="op" id="7377538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7377542">for</span>&nbsp;<span class="ident" id="7377546">i</span>&nbsp;<span class="op" id="7377548">:=</span>&nbsp;<span class="num" id="7377551">0</span><span class="op" id="7377552">;</span>&nbsp;<span class="ident" id="7377554">i</span>&nbsp;<span class="op" id="7377556">&lt;</span>&nbsp;<span class="ident" id="7377558">N</span><span class="op" id="7377559">;</span>&nbsp;<span class="ident" id="7377561">i</span><span class="op" id="7377562">++</span>&nbsp;<span class="op" id="7377565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7377570">block</span><span class="op" id="7377575">[</span><span class="ident" id="7377576">offset</span><span class="op" id="7377582">+</span><span class="ident" id="7377583">i</span><span class="op" id="7377584">]</span>&nbsp;<span class="op" id="7377586">=</span>&nbsp;<span class="string" id="7377588">&#39;0&#39;</span>&nbsp;<span class="op" id="7377592">+</span>&nbsp;<span class="builtintype" id="7377594">byte</span><span class="op" id="7377598">(</span><span class="ident" id="7377599">i</span><span class="op" id="7377600">%</span><span class="num" id="7377601">10</span><span class="op" id="7377603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7377607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7377611">for</span>&nbsp;<span class="ident" id="7377615">blockSize</span>&nbsp;<span class="op" id="7377625">:=</span>&nbsp;<span class="num" id="7377628">10</span><span class="op" id="7377630">;</span>&nbsp;<span class="ident" id="7377632">blockSize</span>&nbsp;<span class="op" id="7377642">&lt;=</span>&nbsp;<span class="ident" id="7377645">N</span><span class="op" id="7377646">;</span>&nbsp;<span class="ident" id="7377648">blockSize</span>&nbsp;<span class="op" id="7377658">*=</span>&nbsp;<span class="num" id="7377661">10</span>&nbsp;<span class="op" id="7377664">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7377669">blocks</span>&nbsp;<span class="op" id="7377676">:=</span>&nbsp;<span class="ident" id="7377679">N</span>&nbsp;<span class="op" id="7377681">/</span>&nbsp;<span class="ident" id="7377683">blockSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7377696">b</span>&nbsp;<span class="op" id="7377698">:=</span>&nbsp;<span class="ident" id="7377701">block</span><span class="op" id="7377706">[</span><span class="ident" id="7377707">offset</span>&nbsp;<span class="op" id="7377714">:</span>&nbsp;<span class="ident" id="7377716">offset</span><span class="op" id="7377722">+</span><span class="ident" id="7377723">blockSize</span><span class="op" id="7377732">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7377737">c</span><span class="op" id="7377738">.</span><span class="ident" id="7377739">Reset</span><span class="op" id="7377744">(</span><span class="op" id="7377745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7377750">for</span>&nbsp;<span class="ident" id="7377754">i</span>&nbsp;<span class="op" id="7377756">:=</span>&nbsp;<span class="num" id="7377759">0</span><span class="op" id="7377760">;</span>&nbsp;<span class="ident" id="7377762">i</span>&nbsp;<span class="op" id="7377764">&lt;</span>&nbsp;<span class="ident" id="7377766">blocks</span><span class="op" id="7377772">;</span>&nbsp;<span class="ident" id="7377774">i</span><span class="op" id="7377775">++</span>&nbsp;<span class="op" id="7377778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7377784">c</span><span class="op" id="7377785">.</span><span class="ident" id="7377786">Write</span><span class="op" id="7377791">(</span><span class="ident" id="7377792">b</span><span class="op" id="7377793">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7377798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7377803">s</span>&nbsp;<span class="op" id="7377805">:=</span>&nbsp;<span class="ident" id="7377808">fmt</span><span class="op" id="7377811">.</span><span class="ident" id="7377812">Sprintf</span><span class="op" id="7377819">(</span><span class="string" id="7377820">&#34;%x&#34;</span><span class="op" id="7377824">,</span>&nbsp;<span class="ident" id="7377826">c</span><span class="op" id="7377827">.</span><span class="ident" id="7377828">Sum</span><span class="op" id="7377831">(</span><span class="ident" id="7377832">nil</span><span class="op" id="7377835">)</span><span class="op" id="7377836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7377841">if</span>&nbsp;<span class="ident" id="7377844">s</span>&nbsp;<span class="op" id="7377846">!=</span>&nbsp;<span class="ident" id="7377849">ok</span>&nbsp;<span class="op" id="7377852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7377858">t</span><span class="op" id="7377859">.</span><span class="ident" id="7377860">Fatalf</span><span class="op" id="7377866">(</span><span class="string" id="7377867">&#34;md5&nbsp;TestLarge&nbsp;offset=%d,&nbsp;blockSize=%d&nbsp;=&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7377919">,</span>&nbsp;<span class="ident" id="7377921">offset</span><span class="op" id="7377927">,</span>&nbsp;<span class="ident" id="7377929">blockSize</span><span class="op" id="7377938">,</span>&nbsp;<span class="ident" id="7377940">s</span><span class="op" id="7377941">,</span>&nbsp;<span class="ident" id="7377943">ok</span><span class="op" id="7377945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7377950">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7377954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7377957">}</span><br>
<span class="lineno"></span><span class="op" id="7377959">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7377962">//&nbsp;Tests&nbsp;that&nbsp;blockGeneric&nbsp;(pure&nbsp;Go)&nbsp;and&nbsp;block&nbsp;(in&nbsp;assembly&nbsp;for&nbsp;amd64,&nbsp;386,&nbsp;arm)&nbsp;match.</span><br>
<span class="lineno">110</span><span class="keyword" id="7378050">func</span>&nbsp;<span class="ident" id="7378055">TestBlockGeneric</span><span class="op" id="7378071">(</span><span class="ident" id="7378072">t</span>&nbsp;<span class="op" id="7378074">*</span><span class="ident" id="7378075">testing</span><span class="op" id="7378082">.</span><span class="ident" id="7378083">T</span><span class="op" id="7378084">)</span>&nbsp;<span class="op" id="7378086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7378089">gen</span><span class="op" id="7378092">,</span>&nbsp;<span class="ident" id="7378094">asm</span>&nbsp;<span class="op" id="7378098">:=</span>&nbsp;<span class="ident" id="7378101">New</span><span class="op" id="7378104">(</span><span class="op" id="7378105">)</span><span class="op" id="7378106">.</span><span class="op" id="7378107">(</span><span class="op" id="7378108">*</span><span class="ident" id="7378109">digest</span><span class="op" id="7378115">)</span><span class="op" id="7378116">,</span>&nbsp;<span class="ident" id="7378118">New</span><span class="op" id="7378121">(</span><span class="op" id="7378122">)</span><span class="op" id="7378123">.</span><span class="op" id="7378124">(</span><span class="op" id="7378125">*</span><span class="ident" id="7378126">digest</span><span class="op" id="7378132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7378135">buf</span>&nbsp;<span class="op" id="7378139">:=</span>&nbsp;<span class="builtinfunc" id="7378142">make</span><span class="op" id="7378146">(</span><span class="op" id="7378147">[</span><span class="op" id="7378148">]</span><span class="builtintype" id="7378149">byte</span><span class="op" id="7378153">,</span>&nbsp;<span class="ident" id="7378155">BlockSize</span><span class="op" id="7378164">*</span><span class="num" id="7378165">20</span><span class="op" id="7378167">)</span>&nbsp;<span class="comment" id="7378169">//&nbsp;arbitrary&nbsp;factor</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7378190">rand</span><span class="op" id="7378194">.</span><span class="ident" id="7378195">Read</span><span class="op" id="7378199">(</span><span class="ident" id="7378200">buf</span><span class="op" id="7378203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7378206">blockGeneric</span><span class="op" id="7378218">(</span><span class="ident" id="7378219">gen</span><span class="op" id="7378222">,</span>&nbsp;<span class="ident" id="7378224">buf</span><span class="op" id="7378227">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7378230">block</span><span class="op" id="7378235">(</span><span class="ident" id="7378236">asm</span><span class="op" id="7378239">,</span>&nbsp;<span class="ident" id="7378241">buf</span><span class="op" id="7378244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7378247">if</span>&nbsp;<span class="op" id="7378250">*</span><span class="ident" id="7378251">gen</span>&nbsp;<span class="op" id="7378255">!=</span>&nbsp;<span class="op" id="7378258">*</span><span class="ident" id="7378259">asm</span>&nbsp;<span class="op" id="7378263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7378267">t</span><span class="op" id="7378268">.</span><span class="ident" id="7378269">Error</span><span class="op" id="7378274">(</span><span class="string" id="7378275">&#34;block&nbsp;and&nbsp;blockGeneric&nbsp;resulted&nbsp;in&nbsp;different&nbsp;states&#34;</span><span class="op" id="7378328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7378331">}</span><br>
<span class="lineno"></span><span class="op" id="7378333">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="7378336">var</span>&nbsp;<span class="ident" id="7378340">bench</span>&nbsp;<span class="op" id="7378346">=</span>&nbsp;<span class="ident" id="7378348">New</span><span class="op" id="7378351">(</span><span class="op" id="7378352">)</span><br>
<span class="lineno"></span><span class="keyword" id="7378354">var</span>&nbsp;<span class="ident" id="7378358">buf</span>&nbsp;<span class="op" id="7378362">=</span>&nbsp;<span class="builtinfunc" id="7378364">make</span><span class="op" id="7378368">(</span><span class="op" id="7378369">[</span><span class="op" id="7378370">]</span><span class="builtintype" id="7378371">byte</span><span class="op" id="7378375">,</span>&nbsp;<span class="num" id="7378377">8192</span><span class="op" id="7378381">+</span><span class="num" id="7378382">1</span><span class="op" id="7378383">)</span><br>
<span class="lineno"></span><span class="keyword" id="7378385">var</span>&nbsp;<span class="ident" id="7378389">sum</span>&nbsp;<span class="op" id="7378393">=</span>&nbsp;<span class="builtinfunc" id="7378395">make</span><span class="op" id="7378399">(</span><span class="op" id="7378400">[</span><span class="op" id="7378401">]</span><span class="builtintype" id="7378402">byte</span><span class="op" id="7378406">,</span>&nbsp;<span class="ident" id="7378408">bench</span><span class="op" id="7378413">.</span><span class="ident" id="7378414">Size</span><span class="op" id="7378418">(</span><span class="op" id="7378419">)</span><span class="op" id="7378420">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="7378423">func</span>&nbsp;<span class="ident" id="7378428">benchmarkSize</span><span class="op" id="7378441">(</span><span class="ident" id="7378442">b</span>&nbsp;<span class="op" id="7378444">*</span><span class="ident" id="7378445">testing</span><span class="op" id="7378452">.</span><span class="ident" id="7378453">B</span><span class="op" id="7378454">,</span>&nbsp;<span class="ident" id="7378456">size</span>&nbsp;<span class="builtintype" id="7378461">int</span><span class="op" id="7378464">,</span>&nbsp;<span class="ident" id="7378466">unaligned</span>&nbsp;<span class="builtintype" id="7378476">bool</span><span class="op" id="7378480">)</span>&nbsp;<span class="op" id="7378482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7378485">b</span><span class="op" id="7378486">.</span><span class="ident" id="7378487">SetBytes</span><span class="op" id="7378495">(</span><span class="ident" id="7378496">int64</span><span class="op" id="7378501">(</span><span class="ident" id="7378502">size</span><span class="op" id="7378506">)</span><span class="op" id="7378507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7378510">buf</span>&nbsp;<span class="op" id="7378514">:=</span>&nbsp;<span class="ident" id="7378517">buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7378522">if</span>&nbsp;<span class="ident" id="7378525">unaligned</span>&nbsp;<span class="op" id="7378535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7378539">if</span>&nbsp;<span class="builtintype" id="7378542">uintptr</span><span class="op" id="7378549">(</span><span class="ident" id="7378550">unsafe</span><span class="op" id="7378556">.</span><span class="ident" id="7378557">Pointer</span><span class="op" id="7378564">(</span><span class="op" id="7378565">&amp;</span><span class="ident" id="7378566">buf</span><span class="op" id="7378569">[</span><span class="num" id="7378570">0</span><span class="op" id="7378571">]</span><span class="op" id="7378572">)</span><span class="op" id="7378573">)</span><span class="op" id="7378574">&amp;</span><span class="op" id="7378575">(</span><span class="ident" id="7378576">unsafe</span><span class="op" id="7378582">.</span><span class="ident" id="7378583">Alignof</span><span class="op" id="7378590">(</span><span class="builtintype" id="7378591">uint32</span><span class="op" id="7378597">(</span><span class="num" id="7378598">0</span><span class="op" id="7378599">)</span><span class="op" id="7378600">)</span><span class="op" id="7378601">-</span><span class="num" id="7378602">1</span><span class="op" id="7378603">)</span>&nbsp;<span class="op" id="7378605">==</span>&nbsp;<span class="num" id="7378608">0</span>&nbsp;<span class="op" id="7378610">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7378615">buf</span>&nbsp;<span class="op" id="7378619">=</span>&nbsp;<span class="ident" id="7378621">buf</span><span class="op" id="7378624">[</span><span class="num" id="7378625">1</span><span class="op" id="7378626">:</span><span class="op" id="7378627">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7378631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7378634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7378637">b</span><span class="op" id="7378638">.</span><span class="ident" id="7378639">ResetTimer</span><span class="op" id="7378649">(</span><span class="op" id="7378650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7378653">for</span>&nbsp;<span class="ident" id="7378657">i</span>&nbsp;<span class="op" id="7378659">:=</span>&nbsp;<span class="num" id="7378662">0</span><span class="op" id="7378663">;</span>&nbsp;<span class="ident" id="7378665">i</span>&nbsp;<span class="op" id="7378667">&lt;</span>&nbsp;<span class="ident" id="7378669">b</span><span class="op" id="7378670">.</span><span class="ident" id="7378671">N</span><span class="op" id="7378672">;</span>&nbsp;<span class="ident" id="7378674">i</span><span class="op" id="7378675">++</span>&nbsp;<span class="op" id="7378678">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7378682">bench</span><span class="op" id="7378687">.</span><span class="ident" id="7378688">Reset</span><span class="op" id="7378693">(</span><span class="op" id="7378694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7378698">bench</span><span class="op" id="7378703">.</span><span class="ident" id="7378704">Write</span><span class="op" id="7378709">(</span><span class="ident" id="7378710">buf</span><span class="op" id="7378713">[</span><span class="op" id="7378714">:</span><span class="ident" id="7378715">size</span><span class="op" id="7378719">]</span><span class="op" id="7378720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7378724">bench</span><span class="op" id="7378729">.</span><span class="ident" id="7378730">Sum</span><span class="op" id="7378733">(</span><span class="ident" id="7378734">sum</span><span class="op" id="7378737">[</span><span class="op" id="7378738">:</span><span class="num" id="7378739">0</span><span class="op" id="7378740">]</span><span class="op" id="7378741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7378744">}</span><br>
<span class="lineno"></span><span class="op" id="7378746">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="7378749">func</span>&nbsp;<span class="ident" id="7378754">BenchmarkHash8Bytes</span><span class="op" id="7378773">(</span><span class="ident" id="7378774">b</span>&nbsp;<span class="op" id="7378776">*</span><span class="ident" id="7378777">testing</span><span class="op" id="7378784">.</span><span class="ident" id="7378785">B</span><span class="op" id="7378786">)</span>&nbsp;<span class="op" id="7378788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7378791">benchmarkSize</span><span class="op" id="7378804">(</span><span class="ident" id="7378805">b</span><span class="op" id="7378806">,</span>&nbsp;<span class="num" id="7378808">8</span><span class="op" id="7378809">,</span>&nbsp;<span class="builtintype" id="7378811">false</span><span class="op" id="7378816">)</span><br>
<span class="lineno"></span><span class="op" id="7378818">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="keyword" id="7378821">func</span>&nbsp;<span class="ident" id="7378826">BenchmarkHash1K</span><span class="op" id="7378841">(</span><span class="ident" id="7378842">b</span>&nbsp;<span class="op" id="7378844">*</span><span class="ident" id="7378845">testing</span><span class="op" id="7378852">.</span><span class="ident" id="7378853">B</span><span class="op" id="7378854">)</span>&nbsp;<span class="op" id="7378856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7378859">benchmarkSize</span><span class="op" id="7378872">(</span><span class="ident" id="7378873">b</span><span class="op" id="7378874">,</span>&nbsp;<span class="num" id="7378876">1024</span><span class="op" id="7378880">,</span>&nbsp;<span class="builtintype" id="7378882">false</span><span class="op" id="7378887">)</span><br>
<span class="lineno"></span><span class="op" id="7378889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7378892">func</span>&nbsp;<span class="ident" id="7378897">BenchmarkHash8K</span><span class="op" id="7378912">(</span><span class="ident" id="7378913">b</span>&nbsp;<span class="op" id="7378915">*</span><span class="ident" id="7378916">testing</span><span class="op" id="7378923">.</span><span class="ident" id="7378924">B</span><span class="op" id="7378925">)</span>&nbsp;<span class="op" id="7378927">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7378930">benchmarkSize</span><span class="op" id="7378943">(</span><span class="ident" id="7378944">b</span><span class="op" id="7378945">,</span>&nbsp;<span class="num" id="7378947">8192</span><span class="op" id="7378951">,</span>&nbsp;<span class="builtintype" id="7378953">false</span><span class="op" id="7378958">)</span><br>
<span class="lineno"></span><span class="op" id="7378960">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7378963">func</span>&nbsp;<span class="ident" id="7378968">BenchmarkHash8BytesUnaligned</span><span class="op" id="7378996">(</span><span class="ident" id="7378997">b</span>&nbsp;<span class="op" id="7378999">*</span><span class="ident" id="7379000">testing</span><span class="op" id="7379007">.</span><span class="ident" id="7379008">B</span><span class="op" id="7379009">)</span>&nbsp;<span class="op" id="7379011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7379014">benchmarkSize</span><span class="op" id="7379027">(</span><span class="ident" id="7379028">b</span><span class="op" id="7379029">,</span>&nbsp;<span class="num" id="7379031">8</span><span class="op" id="7379032">,</span>&nbsp;<span class="builtintype" id="7379034">true</span><span class="op" id="7379038">)</span><br>
<span class="lineno">155</span><span class="op" id="7379040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7379043">func</span>&nbsp;<span class="ident" id="7379048">BenchmarkHash1KUnaligned</span><span class="op" id="7379072">(</span><span class="ident" id="7379073">b</span>&nbsp;<span class="op" id="7379075">*</span><span class="ident" id="7379076">testing</span><span class="op" id="7379083">.</span><span class="ident" id="7379084">B</span><span class="op" id="7379085">)</span>&nbsp;<span class="op" id="7379087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7379090">benchmarkSize</span><span class="op" id="7379103">(</span><span class="ident" id="7379104">b</span><span class="op" id="7379105">,</span>&nbsp;<span class="num" id="7379107">1024</span><span class="op" id="7379111">,</span>&nbsp;<span class="builtintype" id="7379113">true</span><span class="op" id="7379117">)</span><br>
<span class="lineno"></span><span class="op" id="7379119">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="keyword" id="7379122">func</span>&nbsp;<span class="ident" id="7379127">BenchmarkHash8KUnaligned</span><span class="op" id="7379151">(</span><span class="ident" id="7379152">b</span>&nbsp;<span class="op" id="7379154">*</span><span class="ident" id="7379155">testing</span><span class="op" id="7379162">.</span><span class="ident" id="7379163">B</span><span class="op" id="7379164">)</span>&nbsp;<span class="op" id="7379166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7379169">benchmarkSize</span><span class="op" id="7379182">(</span><span class="ident" id="7379183">b</span><span class="op" id="7379184">,</span>&nbsp;<span class="num" id="7379186">8192</span><span class="op" id="7379190">,</span>&nbsp;<span class="builtintype" id="7379192">true</span><span class="op" id="7379196">)</span><br>
<span class="lineno"></span><span class="op" id="7379198">}</span>
</div>
</body>
</html>
