<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html" class="current">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5028217">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5028272">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5028326">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5028377">package</span>&nbsp;<span class="ident" id="5028385">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5028395">import</span>&nbsp;<span class="op" id="5028402">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5028405">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5028414">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5028421">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5028432">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5028447">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5028450">//&nbsp;endsWithCSSKeyword&nbsp;reports&nbsp;whether&nbsp;b&nbsp;ends&nbsp;with&nbsp;an&nbsp;ident&nbsp;that</span><br>
<span class="lineno">15</span><span class="comment" id="5028514">//&nbsp;case-insensitively&nbsp;matches&nbsp;the&nbsp;lower-case&nbsp;kw.</span><br>
<span class="lineno"></span><span class="keyword" id="5028563">func</span>&nbsp;<span class="ident" id="5028568">endsWithCSSKeyword</span><span class="op" id="5028586">(</span><span class="ident" id="5028587">b</span>&nbsp;<span class="op" id="5028589">[</span><span class="op" id="5028590">]</span><span class="builtintype" id="5028591">byte</span><span class="op" id="5028595">,</span>&nbsp;<span class="ident" id="5028597">kw</span>&nbsp;<span class="builtintype" id="5028600">string</span><span class="op" id="5028606">)</span>&nbsp;<span class="builtintype" id="5028608">bool</span>&nbsp;<span class="op" id="5028613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5028616">i</span>&nbsp;<span class="op" id="5028618">:=</span>&nbsp;<span class="builtinfunc" id="5028621">len</span><span class="op" id="5028624">(</span><span class="ident" id="5028625">b</span><span class="op" id="5028626">)</span>&nbsp;<span class="op" id="5028628">-</span>&nbsp;<span class="builtinfunc" id="5028630">len</span><span class="op" id="5028633">(</span><span class="ident" id="5028634">kw</span><span class="op" id="5028636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5028639">if</span>&nbsp;<span class="ident" id="5028642">i</span>&nbsp;<span class="op" id="5028644">&lt;</span>&nbsp;<span class="num" id="5028646">0</span>&nbsp;<span class="op" id="5028648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5028652">//&nbsp;Too&nbsp;short.</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5028668">return</span>&nbsp;<span class="builtintype" id="5028675">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5028682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5028685">if</span>&nbsp;<span class="ident" id="5028688">i</span>&nbsp;<span class="op" id="5028690">!=</span>&nbsp;<span class="num" id="5028693">0</span>&nbsp;<span class="op" id="5028695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5028699">r</span><span class="op" id="5028700">,</span>&nbsp;<span class="ident" id="5028702">_</span>&nbsp;<span class="op" id="5028704">:=</span>&nbsp;<span class="ident" id="5028707">utf8</span><span class="op" id="5028711">.</span><span class="ident" id="5028712">DecodeLastRune</span><span class="op" id="5028726">(</span><span class="ident" id="5028727">b</span><span class="op" id="5028728">[</span><span class="op" id="5028729">:</span><span class="ident" id="5028730">i</span><span class="op" id="5028731">]</span><span class="op" id="5028732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5028736">if</span>&nbsp;<span class="ident" id="5028739">isCSSNmchar</span><span class="op" id="5028750">(</span><span class="ident" id="5028751">r</span><span class="op" id="5028752">)</span>&nbsp;<span class="op" id="5028754">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5028759">//&nbsp;Too&nbsp;long.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5028775">return</span>&nbsp;<span class="builtintype" id="5028782">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5028790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5028793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5028796">//&nbsp;Many&nbsp;CSS&nbsp;keywords,&nbsp;such&nbsp;as&nbsp;&#34;!important&#34;&nbsp;can&nbsp;have&nbsp;characters&nbsp;encoded,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5028869">//&nbsp;but&nbsp;the&nbsp;URI&nbsp;production&nbsp;does&nbsp;not&nbsp;allow&nbsp;that&nbsp;according&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5028929">//&nbsp;http://www.w3.org/TR/css3-syntax/#TOK-URI</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5028975">//&nbsp;This&nbsp;does&nbsp;not&nbsp;attempt&nbsp;to&nbsp;recognize&nbsp;encoded&nbsp;keywords.&nbsp;For&nbsp;example,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5029045">//&nbsp;given&nbsp;&#34;\75\72\6c&#34;&nbsp;and&nbsp;&#34;url&#34;&nbsp;this&nbsp;return&nbsp;false.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5029096">return</span>&nbsp;<span class="builtintype" id="5029103">string</span><span class="op" id="5029109">(</span><span class="ident" id="5029110">bytes</span><span class="op" id="5029115">.</span><span class="ident" id="5029116">ToLower</span><span class="op" id="5029123">(</span><span class="ident" id="5029124">b</span><span class="op" id="5029125">[</span><span class="ident" id="5029126">i</span><span class="op" id="5029127">:</span><span class="op" id="5029128">]</span><span class="op" id="5029129">)</span><span class="op" id="5029130">)</span>&nbsp;<span class="op" id="5029132">==</span>&nbsp;<span class="ident" id="5029135">kw</span><br>
<span class="lineno">35</span><span class="op" id="5029138">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5029141">//&nbsp;isCSSNmchar&nbsp;reports&nbsp;whether&nbsp;rune&nbsp;is&nbsp;allowed&nbsp;anywhere&nbsp;in&nbsp;a&nbsp;CSS&nbsp;identifier.</span><br>
<span class="lineno"></span><span class="keyword" id="5029218">func</span>&nbsp;<span class="ident" id="5029223">isCSSNmchar</span><span class="op" id="5029234">(</span><span class="ident" id="5029235">r</span>&nbsp;<span class="builtintype" id="5029237">rune</span><span class="op" id="5029241">)</span>&nbsp;<span class="builtintype" id="5029243">bool</span>&nbsp;<span class="op" id="5029248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5029251">//&nbsp;Based&nbsp;on&nbsp;the&nbsp;CSS3&nbsp;nmchar&nbsp;production&nbsp;but&nbsp;ignores&nbsp;multi-rune&nbsp;escape</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5029321">//&nbsp;sequences.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5029336">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-nmchar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5029388">return</span>&nbsp;<span class="string" id="5029395">&#39;a&#39;</span>&nbsp;<span class="op" id="5029399">&lt;=</span>&nbsp;<span class="ident" id="5029402">r</span>&nbsp;<span class="op" id="5029404">&amp;&amp;</span>&nbsp;<span class="ident" id="5029407">r</span>&nbsp;<span class="op" id="5029409">&lt;=</span>&nbsp;<span class="string" id="5029412">&#39;z&#39;</span>&nbsp;<span class="op" id="5029416">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5029421">&#39;A&#39;</span>&nbsp;<span class="op" id="5029425">&lt;=</span>&nbsp;<span class="ident" id="5029428">r</span>&nbsp;<span class="op" id="5029430">&amp;&amp;</span>&nbsp;<span class="ident" id="5029433">r</span>&nbsp;<span class="op" id="5029435">&lt;=</span>&nbsp;<span class="string" id="5029438">&#39;Z&#39;</span>&nbsp;<span class="op" id="5029442">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5029447">&#39;0&#39;</span>&nbsp;<span class="op" id="5029451">&lt;=</span>&nbsp;<span class="ident" id="5029454">r</span>&nbsp;<span class="op" id="5029456">&amp;&amp;</span>&nbsp;<span class="ident" id="5029459">r</span>&nbsp;<span class="op" id="5029461">&lt;=</span>&nbsp;<span class="string" id="5029464">&#39;9&#39;</span>&nbsp;<span class="op" id="5029468">||</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5029473">r</span>&nbsp;<span class="op" id="5029475">==</span>&nbsp;<span class="string" id="5029478">&#39;-&#39;</span>&nbsp;<span class="op" id="5029482">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5029487">r</span>&nbsp;<span class="op" id="5029489">==</span>&nbsp;<span class="string" id="5029492">&#39;_&#39;</span>&nbsp;<span class="op" id="5029496">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5029501">//&nbsp;Non-ASCII&nbsp;cases&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="5029529">0x80</span>&nbsp;<span class="op" id="5029534">&lt;=</span>&nbsp;<span class="ident" id="5029537">r</span>&nbsp;<span class="op" id="5029539">&amp;&amp;</span>&nbsp;<span class="ident" id="5029542">r</span>&nbsp;<span class="op" id="5029544">&lt;=</span>&nbsp;<span class="num" id="5029547">0xd7ff</span>&nbsp;<span class="op" id="5029554">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="5029559">0xe000</span>&nbsp;<span class="op" id="5029566">&lt;=</span>&nbsp;<span class="ident" id="5029569">r</span>&nbsp;<span class="op" id="5029571">&amp;&amp;</span>&nbsp;<span class="ident" id="5029574">r</span>&nbsp;<span class="op" id="5029576">&lt;=</span>&nbsp;<span class="num" id="5029579">0xfffd</span>&nbsp;<span class="op" id="5029586">||</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="5029591">0x10000</span>&nbsp;<span class="op" id="5029599">&lt;=</span>&nbsp;<span class="ident" id="5029602">r</span>&nbsp;<span class="op" id="5029604">&amp;&amp;</span>&nbsp;<span class="ident" id="5029607">r</span>&nbsp;<span class="op" id="5029609">&lt;=</span>&nbsp;<span class="num" id="5029612">0x10ffff</span><br>
<span class="lineno"></span><span class="op" id="5029621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5029624">//&nbsp;decodeCSS&nbsp;decodes&nbsp;CSS3&nbsp;escapes&nbsp;given&nbsp;a&nbsp;sequence&nbsp;of&nbsp;stringchars.</span><br>
<span class="lineno"></span><span class="comment" id="5029691">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;change,&nbsp;it&nbsp;returns&nbsp;the&nbsp;input,&nbsp;otherwise&nbsp;it&nbsp;returns&nbsp;a&nbsp;slice</span><br>
<span class="lineno">55</span><span class="comment" id="5029768">//&nbsp;backed&nbsp;by&nbsp;a&nbsp;new&nbsp;array.</span><br>
<span class="lineno"></span><span class="comment" id="5029794">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-stringchar&nbsp;defines&nbsp;stringchar.</span><br>
<span class="lineno"></span><span class="keyword" id="5029869">func</span>&nbsp;<span class="ident" id="5029874">decodeCSS</span><span class="op" id="5029883">(</span><span class="ident" id="5029884">s</span>&nbsp;<span class="op" id="5029886">[</span><span class="op" id="5029887">]</span><span class="builtintype" id="5029888">byte</span><span class="op" id="5029892">)</span>&nbsp;<span class="op" id="5029894">[</span><span class="op" id="5029895">]</span><span class="builtintype" id="5029896">byte</span>&nbsp;<span class="op" id="5029901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5029904">i</span>&nbsp;<span class="op" id="5029906">:=</span>&nbsp;<span class="ident" id="5029909">bytes</span><span class="op" id="5029914">.</span><span class="ident" id="5029915">IndexByte</span><span class="op" id="5029924">(</span><span class="ident" id="5029925">s</span><span class="op" id="5029926">,</span>&nbsp;<span class="string" id="5029928">&#39;\\&#39;</span><span class="op" id="5029932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5029935">if</span>&nbsp;<span class="ident" id="5029938">i</span>&nbsp;<span class="op" id="5029940">==</span>&nbsp;<span class="op" id="5029943">-</span><span class="num" id="5029944">1</span>&nbsp;<span class="op" id="5029946">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5029950">return</span>&nbsp;<span class="ident" id="5029957">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5029960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5029963">//&nbsp;The&nbsp;UTF-8&nbsp;sequence&nbsp;for&nbsp;a&nbsp;codepoint&nbsp;is&nbsp;never&nbsp;longer&nbsp;than&nbsp;1&nbsp;+&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5030031">//&nbsp;number&nbsp;hex&nbsp;digits&nbsp;need&nbsp;to&nbsp;represent&nbsp;that&nbsp;codepoint,&nbsp;so&nbsp;len(s)&nbsp;is&nbsp;an</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5030103">//&nbsp;upper&nbsp;bound&nbsp;on&nbsp;the&nbsp;output&nbsp;length.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5030141">b</span>&nbsp;<span class="op" id="5030143">:=</span>&nbsp;<span class="builtinfunc" id="5030146">make</span><span class="op" id="5030150">(</span><span class="op" id="5030151">[</span><span class="op" id="5030152">]</span><span class="builtintype" id="5030153">byte</span><span class="op" id="5030157">,</span>&nbsp;<span class="num" id="5030159">0</span><span class="op" id="5030160">,</span>&nbsp;<span class="builtinfunc" id="5030162">len</span><span class="op" id="5030165">(</span><span class="ident" id="5030166">s</span><span class="op" id="5030167">)</span><span class="op" id="5030168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5030171">for</span>&nbsp;<span class="builtinfunc" id="5030175">len</span><span class="op" id="5030178">(</span><span class="ident" id="5030179">s</span><span class="op" id="5030180">)</span>&nbsp;<span class="op" id="5030182">!=</span>&nbsp;<span class="num" id="5030185">0</span>&nbsp;<span class="op" id="5030187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5030191">i</span>&nbsp;<span class="op" id="5030193">:=</span>&nbsp;<span class="ident" id="5030196">bytes</span><span class="op" id="5030201">.</span><span class="ident" id="5030202">IndexByte</span><span class="op" id="5030211">(</span><span class="ident" id="5030212">s</span><span class="op" id="5030213">,</span>&nbsp;<span class="string" id="5030215">&#39;\\&#39;</span><span class="op" id="5030219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5030223">if</span>&nbsp;<span class="ident" id="5030226">i</span>&nbsp;<span class="op" id="5030228">==</span>&nbsp;<span class="op" id="5030231">-</span><span class="num" id="5030232">1</span>&nbsp;<span class="op" id="5030234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5030239">i</span>&nbsp;<span class="op" id="5030241">=</span>&nbsp;<span class="builtinfunc" id="5030243">len</span><span class="op" id="5030246">(</span><span class="ident" id="5030247">s</span><span class="op" id="5030248">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5030252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5030256">b</span><span class="op" id="5030257">,</span>&nbsp;<span class="ident" id="5030259">s</span>&nbsp;<span class="op" id="5030261">=</span>&nbsp;<span class="builtinfunc" id="5030263">append</span><span class="op" id="5030269">(</span><span class="ident" id="5030270">b</span><span class="op" id="5030271">,</span>&nbsp;<span class="ident" id="5030273">s</span><span class="op" id="5030274">[</span><span class="op" id="5030275">:</span><span class="ident" id="5030276">i</span><span class="op" id="5030277">]</span><span class="op" id="5030278">...</span><span class="op" id="5030281">)</span><span class="op" id="5030282">,</span>&nbsp;<span class="ident" id="5030284">s</span><span class="op" id="5030285">[</span><span class="ident" id="5030286">i</span><span class="op" id="5030287">:</span><span class="op" id="5030288">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5030292">if</span>&nbsp;<span class="builtinfunc" id="5030295">len</span><span class="op" id="5030298">(</span><span class="ident" id="5030299">s</span><span class="op" id="5030300">)</span>&nbsp;<span class="op" id="5030302">&lt;</span>&nbsp;<span class="num" id="5030304">2</span>&nbsp;<span class="op" id="5030306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5030311">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5030319">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5030323">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-escape</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5030376">//&nbsp;escape&nbsp;::=&nbsp;unicode&nbsp;|&nbsp;&#39;\&#39;&nbsp;[#x20-#x7E#x80-#xD7FF#xE000-#xFFFD#x10000-#x10FFFF]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5030458">if</span>&nbsp;<span class="ident" id="5030461">isHex</span><span class="op" id="5030466">(</span><span class="ident" id="5030467">s</span><span class="op" id="5030468">[</span><span class="num" id="5030469">1</span><span class="op" id="5030470">]</span><span class="op" id="5030471">)</span>&nbsp;<span class="op" id="5030473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5030478">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-unicode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5030533">//&nbsp;&nbsp;&nbsp;unicode&nbsp;::=&nbsp;&#39;\&#39;&nbsp;[0-9a-fA-F]{1,6}&nbsp;wc?</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5030578">j</span>&nbsp;<span class="op" id="5030580">:=</span>&nbsp;<span class="num" id="5030583">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5030588">for</span>&nbsp;<span class="ident" id="5030592">j</span>&nbsp;<span class="op" id="5030594">&lt;</span>&nbsp;<span class="builtinfunc" id="5030596">len</span><span class="op" id="5030599">(</span><span class="ident" id="5030600">s</span><span class="op" id="5030601">)</span>&nbsp;<span class="op" id="5030603">&amp;&amp;</span>&nbsp;<span class="ident" id="5030606">j</span>&nbsp;<span class="op" id="5030608">&lt;</span>&nbsp;<span class="num" id="5030610">7</span>&nbsp;<span class="op" id="5030612">&amp;&amp;</span>&nbsp;<span class="ident" id="5030615">isHex</span><span class="op" id="5030620">(</span><span class="ident" id="5030621">s</span><span class="op" id="5030622">[</span><span class="ident" id="5030623">j</span><span class="op" id="5030624">]</span><span class="op" id="5030625">)</span>&nbsp;<span class="op" id="5030627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5030633">j</span><span class="op" id="5030634">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5030640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5030645">r</span>&nbsp;<span class="op" id="5030647">:=</span>&nbsp;<span class="ident" id="5030650">hexDecode</span><span class="op" id="5030659">(</span><span class="ident" id="5030660">s</span><span class="op" id="5030661">[</span><span class="num" id="5030662">1</span><span class="op" id="5030663">:</span><span class="ident" id="5030664">j</span><span class="op" id="5030665">]</span><span class="op" id="5030666">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5030671">if</span>&nbsp;<span class="ident" id="5030674">r</span>&nbsp;<span class="op" id="5030676">&gt;</span>&nbsp;<span class="ident" id="5030678">unicode</span><span class="op" id="5030685">.</span><span class="ident" id="5030686">MaxRune</span>&nbsp;<span class="op" id="5030694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5030700">r</span><span class="op" id="5030701">,</span>&nbsp;<span class="ident" id="5030703">j</span>&nbsp;<span class="op" id="5030705">=</span>&nbsp;<span class="ident" id="5030707">r</span><span class="op" id="5030708">/</span><span class="num" id="5030709">16</span><span class="op" id="5030711">,</span>&nbsp;<span class="ident" id="5030713">j</span><span class="op" id="5030714">-</span><span class="num" id="5030715">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5030720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5030725">n</span>&nbsp;<span class="op" id="5030727">:=</span>&nbsp;<span class="ident" id="5030730">utf8</span><span class="op" id="5030734">.</span><span class="ident" id="5030735">EncodeRune</span><span class="op" id="5030745">(</span><span class="ident" id="5030746">b</span><span class="op" id="5030747">[</span><span class="builtinfunc" id="5030748">len</span><span class="op" id="5030751">(</span><span class="ident" id="5030752">b</span><span class="op" id="5030753">)</span><span class="op" id="5030754">:</span><span class="builtinfunc" id="5030755">cap</span><span class="op" id="5030758">(</span><span class="ident" id="5030759">b</span><span class="op" id="5030760">)</span><span class="op" id="5030761">]</span><span class="op" id="5030762">,</span>&nbsp;<span class="ident" id="5030764">r</span><span class="op" id="5030765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5030770">//&nbsp;The&nbsp;optional&nbsp;space&nbsp;at&nbsp;the&nbsp;end&nbsp;allows&nbsp;a&nbsp;hex</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5030819">//&nbsp;sequence&nbsp;to&nbsp;be&nbsp;followed&nbsp;by&nbsp;a&nbsp;literal&nbsp;hex.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5030867">//&nbsp;string(decodeCSS([]byte(`\A&nbsp;B`)))&nbsp;==&nbsp;&#34;\nB&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5030916">b</span><span class="op" id="5030917">,</span>&nbsp;<span class="ident" id="5030919">s</span>&nbsp;<span class="op" id="5030921">=</span>&nbsp;<span class="ident" id="5030923">b</span><span class="op" id="5030924">[</span><span class="op" id="5030925">:</span><span class="builtinfunc" id="5030926">len</span><span class="op" id="5030929">(</span><span class="ident" id="5030930">b</span><span class="op" id="5030931">)</span><span class="op" id="5030932">+</span><span class="ident" id="5030933">n</span><span class="op" id="5030934">]</span><span class="op" id="5030935">,</span>&nbsp;<span class="ident" id="5030937">skipCSSSpace</span><span class="op" id="5030949">(</span><span class="ident" id="5030950">s</span><span class="op" id="5030951">[</span><span class="ident" id="5030952">j</span><span class="op" id="5030953">:</span><span class="op" id="5030954">]</span><span class="op" id="5030955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5030959">}</span>&nbsp;<span class="keyword" id="5030961">else</span>&nbsp;<span class="op" id="5030966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5030971">//&nbsp;`\\`&nbsp;decodes&nbsp;to&nbsp;`\`&nbsp;and&nbsp;`\&#34;`&nbsp;to&nbsp;`&#34;`.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5031014">_</span><span class="op" id="5031015">,</span>&nbsp;<span class="ident" id="5031017">n</span>&nbsp;<span class="op" id="5031019">:=</span>&nbsp;<span class="ident" id="5031022">utf8</span><span class="op" id="5031026">.</span><span class="ident" id="5031027">DecodeRune</span><span class="op" id="5031037">(</span><span class="ident" id="5031038">s</span><span class="op" id="5031039">[</span><span class="num" id="5031040">1</span><span class="op" id="5031041">:</span><span class="op" id="5031042">]</span><span class="op" id="5031043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5031048">b</span><span class="op" id="5031049">,</span>&nbsp;<span class="ident" id="5031051">s</span>&nbsp;<span class="op" id="5031053">=</span>&nbsp;<span class="builtinfunc" id="5031055">append</span><span class="op" id="5031061">(</span><span class="ident" id="5031062">b</span><span class="op" id="5031063">,</span>&nbsp;<span class="ident" id="5031065">s</span><span class="op" id="5031066">[</span><span class="num" id="5031067">1</span><span class="op" id="5031068">:</span><span class="num" id="5031069">1</span><span class="op" id="5031070">+</span><span class="ident" id="5031071">n</span><span class="op" id="5031072">]</span><span class="op" id="5031073">...</span><span class="op" id="5031076">)</span><span class="op" id="5031077">,</span>&nbsp;<span class="ident" id="5031079">s</span><span class="op" id="5031080">[</span><span class="num" id="5031081">1</span><span class="op" id="5031082">+</span><span class="ident" id="5031083">n</span><span class="op" id="5031084">:</span><span class="op" id="5031085">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5031089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5031092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5031095">return</span>&nbsp;<span class="ident" id="5031102">b</span><br>
<span class="lineno">100</span><span class="op" id="5031104">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5031107">//&nbsp;isHex&nbsp;reports&nbsp;whether&nbsp;the&nbsp;given&nbsp;character&nbsp;is&nbsp;a&nbsp;hex&nbsp;digit.</span><br>
<span class="lineno"></span><span class="keyword" id="5031168">func</span>&nbsp;<span class="ident" id="5031173">isHex</span><span class="op" id="5031178">(</span><span class="ident" id="5031179">c</span>&nbsp;<span class="builtintype" id="5031181">byte</span><span class="op" id="5031185">)</span>&nbsp;<span class="builtintype" id="5031187">bool</span>&nbsp;<span class="op" id="5031192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5031195">return</span>&nbsp;<span class="string" id="5031202">&#39;0&#39;</span>&nbsp;<span class="op" id="5031206">&lt;=</span>&nbsp;<span class="ident" id="5031209">c</span>&nbsp;<span class="op" id="5031211">&amp;&amp;</span>&nbsp;<span class="ident" id="5031214">c</span>&nbsp;<span class="op" id="5031216">&lt;=</span>&nbsp;<span class="string" id="5031219">&#39;9&#39;</span>&nbsp;<span class="op" id="5031223">||</span>&nbsp;<span class="string" id="5031226">&#39;a&#39;</span>&nbsp;<span class="op" id="5031230">&lt;=</span>&nbsp;<span class="ident" id="5031233">c</span>&nbsp;<span class="op" id="5031235">&amp;&amp;</span>&nbsp;<span class="ident" id="5031238">c</span>&nbsp;<span class="op" id="5031240">&lt;=</span>&nbsp;<span class="string" id="5031243">&#39;f&#39;</span>&nbsp;<span class="op" id="5031247">||</span>&nbsp;<span class="string" id="5031250">&#39;A&#39;</span>&nbsp;<span class="op" id="5031254">&lt;=</span>&nbsp;<span class="ident" id="5031257">c</span>&nbsp;<span class="op" id="5031259">&amp;&amp;</span>&nbsp;<span class="ident" id="5031262">c</span>&nbsp;<span class="op" id="5031264">&lt;=</span>&nbsp;<span class="string" id="5031267">&#39;F&#39;</span><br>
<span class="lineno">105</span><span class="op" id="5031271">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5031274">//&nbsp;hexDecode&nbsp;decodes&nbsp;a&nbsp;short&nbsp;hex&nbsp;digit&nbsp;sequence:&nbsp;&#34;10&#34;&nbsp;-&gt;&nbsp;16.</span><br>
<span class="lineno"></span><span class="keyword" id="5031335">func</span>&nbsp;<span class="ident" id="5031340">hexDecode</span><span class="op" id="5031349">(</span><span class="ident" id="5031350">s</span>&nbsp;<span class="op" id="5031352">[</span><span class="op" id="5031353">]</span><span class="builtintype" id="5031354">byte</span><span class="op" id="5031358">)</span>&nbsp;<span class="builtintype" id="5031360">rune</span>&nbsp;<span class="op" id="5031365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5031368">n</span>&nbsp;<span class="op" id="5031370">:=</span>&nbsp;<span class="string" id="5031373">&#39;\x00&#39;</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5031381">for</span>&nbsp;<span class="ident" id="5031385">_</span><span class="op" id="5031386">,</span>&nbsp;<span class="ident" id="5031388">c</span>&nbsp;<span class="op" id="5031390">:=</span>&nbsp;<span class="keyword" id="5031393">range</span>&nbsp;<span class="ident" id="5031399">s</span>&nbsp;<span class="op" id="5031401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5031405">n</span>&nbsp;<span class="op" id="5031407">&lt;&lt;=</span>&nbsp;<span class="num" id="5031411">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5031415">switch</span>&nbsp;<span class="op" id="5031422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5031426">case</span>&nbsp;<span class="string" id="5031431">&#39;0&#39;</span>&nbsp;<span class="op" id="5031435">&lt;=</span>&nbsp;<span class="ident" id="5031438">c</span>&nbsp;<span class="op" id="5031440">&amp;&amp;</span>&nbsp;<span class="ident" id="5031443">c</span>&nbsp;<span class="op" id="5031445">&lt;=</span>&nbsp;<span class="string" id="5031448">&#39;9&#39;</span><span class="op" id="5031451">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5031456">n</span>&nbsp;<span class="op" id="5031458">|=</span>&nbsp;<span class="builtintype" id="5031461">rune</span><span class="op" id="5031465">(</span><span class="ident" id="5031466">c</span>&nbsp;<span class="op" id="5031468">-</span>&nbsp;<span class="string" id="5031470">&#39;0&#39;</span><span class="op" id="5031473">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5031477">case</span>&nbsp;<span class="string" id="5031482">&#39;a&#39;</span>&nbsp;<span class="op" id="5031486">&lt;=</span>&nbsp;<span class="ident" id="5031489">c</span>&nbsp;<span class="op" id="5031491">&amp;&amp;</span>&nbsp;<span class="ident" id="5031494">c</span>&nbsp;<span class="op" id="5031496">&lt;=</span>&nbsp;<span class="string" id="5031499">&#39;f&#39;</span><span class="op" id="5031502">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5031507">n</span>&nbsp;<span class="op" id="5031509">|=</span>&nbsp;<span class="builtintype" id="5031512">rune</span><span class="op" id="5031516">(</span><span class="ident" id="5031517">c</span><span class="op" id="5031518">-</span><span class="string" id="5031519">&#39;a&#39;</span><span class="op" id="5031522">)</span>&nbsp;<span class="op" id="5031524">+</span>&nbsp;<span class="num" id="5031526">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5031531">case</span>&nbsp;<span class="string" id="5031536">&#39;A&#39;</span>&nbsp;<span class="op" id="5031540">&lt;=</span>&nbsp;<span class="ident" id="5031543">c</span>&nbsp;<span class="op" id="5031545">&amp;&amp;</span>&nbsp;<span class="ident" id="5031548">c</span>&nbsp;<span class="op" id="5031550">&lt;=</span>&nbsp;<span class="string" id="5031553">&#39;F&#39;</span><span class="op" id="5031556">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5031561">n</span>&nbsp;<span class="op" id="5031563">|=</span>&nbsp;<span class="builtintype" id="5031566">rune</span><span class="op" id="5031570">(</span><span class="ident" id="5031571">c</span><span class="op" id="5031572">-</span><span class="string" id="5031573">&#39;A&#39;</span><span class="op" id="5031576">)</span>&nbsp;<span class="op" id="5031578">+</span>&nbsp;<span class="num" id="5031580">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5031585">default</span><span class="op" id="5031592">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5031597">panic</span><span class="op" id="5031602">(</span><span class="ident" id="5031603">fmt</span><span class="op" id="5031606">.</span><span class="ident" id="5031607">Sprintf</span><span class="op" id="5031614">(</span><span class="string" id="5031615">&#34;Bad&nbsp;hex&nbsp;digit&nbsp;in&nbsp;%q&#34;</span><span class="op" id="5031636">,</span>&nbsp;<span class="ident" id="5031638">s</span><span class="op" id="5031639">)</span><span class="op" id="5031640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5031644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5031647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5031650">return</span>&nbsp;<span class="ident" id="5031657">n</span><br>
<span class="lineno"></span><span class="op" id="5031659">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="5031662">//&nbsp;skipCSSSpace&nbsp;returns&nbsp;a&nbsp;suffix&nbsp;of&nbsp;c,&nbsp;skipping&nbsp;over&nbsp;a&nbsp;single&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="5031731">func</span>&nbsp;<span class="ident" id="5031736">skipCSSSpace</span><span class="op" id="5031748">(</span><span class="ident" id="5031749">c</span>&nbsp;<span class="op" id="5031751">[</span><span class="op" id="5031752">]</span><span class="builtintype" id="5031753">byte</span><span class="op" id="5031757">)</span>&nbsp;<span class="op" id="5031759">[</span><span class="op" id="5031760">]</span><span class="builtintype" id="5031761">byte</span>&nbsp;<span class="op" id="5031766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5031769">if</span>&nbsp;<span class="builtinfunc" id="5031772">len</span><span class="op" id="5031775">(</span><span class="ident" id="5031776">c</span><span class="op" id="5031777">)</span>&nbsp;<span class="op" id="5031779">==</span>&nbsp;<span class="num" id="5031782">0</span>&nbsp;<span class="op" id="5031784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5031788">return</span>&nbsp;<span class="ident" id="5031795">c</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5031798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5031801">//&nbsp;wc&nbsp;::=&nbsp;#x9&nbsp;|&nbsp;#xA&nbsp;|&nbsp;#xC&nbsp;|&nbsp;#xD&nbsp;|&nbsp;#x20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5031841">switch</span>&nbsp;<span class="ident" id="5031848">c</span><span class="op" id="5031849">[</span><span class="num" id="5031850">0</span><span class="op" id="5031851">]</span>&nbsp;<span class="op" id="5031853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5031856">case</span>&nbsp;<span class="string" id="5031861">&#39;\t&#39;</span><span class="op" id="5031865">,</span>&nbsp;<span class="string" id="5031867">&#39;\n&#39;</span><span class="op" id="5031871">,</span>&nbsp;<span class="string" id="5031873">&#39;\f&#39;</span><span class="op" id="5031877">,</span>&nbsp;<span class="string" id="5031879">&#39;&nbsp;&#39;</span><span class="op" id="5031882">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5031886">return</span>&nbsp;<span class="ident" id="5031893">c</span><span class="op" id="5031894">[</span><span class="num" id="5031895">1</span><span class="op" id="5031896">:</span><span class="op" id="5031897">]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5031900">case</span>&nbsp;<span class="string" id="5031905">&#39;\r&#39;</span><span class="op" id="5031909">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5031913">//&nbsp;This&nbsp;differs&nbsp;from&nbsp;CSS3&#39;s&nbsp;wc&nbsp;production&nbsp;because&nbsp;it&nbsp;contains&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5031979">//&nbsp;probable&nbsp;spec&nbsp;error&nbsp;whereby&nbsp;wc&nbsp;contains&nbsp;all&nbsp;the&nbsp;single&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5032044">//&nbsp;sequences&nbsp;in&nbsp;nl&nbsp;(newline)&nbsp;but&nbsp;not&nbsp;CRLF.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5032089">if</span>&nbsp;<span class="builtinfunc" id="5032092">len</span><span class="op" id="5032095">(</span><span class="ident" id="5032096">c</span><span class="op" id="5032097">)</span>&nbsp;<span class="op" id="5032099">&gt;=</span>&nbsp;<span class="num" id="5032102">2</span>&nbsp;<span class="op" id="5032104">&amp;&amp;</span>&nbsp;<span class="ident" id="5032107">c</span><span class="op" id="5032108">[</span><span class="num" id="5032109">1</span><span class="op" id="5032110">]</span>&nbsp;<span class="op" id="5032112">==</span>&nbsp;<span class="string" id="5032115">&#39;\n&#39;</span>&nbsp;<span class="op" id="5032120">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5032125">return</span>&nbsp;<span class="ident" id="5032132">c</span><span class="op" id="5032133">[</span><span class="num" id="5032134">2</span><span class="op" id="5032135">:</span><span class="op" id="5032136">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5032140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5032144">return</span>&nbsp;<span class="ident" id="5032151">c</span><span class="op" id="5032152">[</span><span class="num" id="5032153">1</span><span class="op" id="5032154">:</span><span class="op" id="5032155">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5032158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5032161">return</span>&nbsp;<span class="ident" id="5032168">c</span><br>
<span class="lineno">145</span><span class="op" id="5032170">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5032173">//&nbsp;isCSSSpace&nbsp;reports&nbsp;whether&nbsp;b&nbsp;is&nbsp;a&nbsp;CSS&nbsp;space&nbsp;char&nbsp;as&nbsp;defined&nbsp;in&nbsp;wc.</span><br>
<span class="lineno"></span><span class="keyword" id="5032243">func</span>&nbsp;<span class="ident" id="5032248">isCSSSpace</span><span class="op" id="5032258">(</span><span class="ident" id="5032259">b</span>&nbsp;<span class="builtintype" id="5032261">byte</span><span class="op" id="5032265">)</span>&nbsp;<span class="builtintype" id="5032267">bool</span>&nbsp;<span class="op" id="5032272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5032275">switch</span>&nbsp;<span class="ident" id="5032282">b</span>&nbsp;<span class="op" id="5032284">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5032287">case</span>&nbsp;<span class="string" id="5032292">&#39;\t&#39;</span><span class="op" id="5032296">,</span>&nbsp;<span class="string" id="5032298">&#39;\n&#39;</span><span class="op" id="5032302">,</span>&nbsp;<span class="string" id="5032304">&#39;\f&#39;</span><span class="op" id="5032308">,</span>&nbsp;<span class="string" id="5032310">&#39;\r&#39;</span><span class="op" id="5032314">,</span>&nbsp;<span class="string" id="5032316">&#39;&nbsp;&#39;</span><span class="op" id="5032319">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5032323">return</span>&nbsp;<span class="builtintype" id="5032330">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5032336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5032339">return</span>&nbsp;<span class="builtintype" id="5032346">false</span><br>
<span class="lineno"></span><span class="op" id="5032352">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="5032355">//&nbsp;cssEscaper&nbsp;escapes&nbsp;HTML&nbsp;and&nbsp;CSS&nbsp;special&nbsp;characters&nbsp;using&nbsp;\&lt;hex&gt;+&nbsp;escapes.</span><br>
<span class="lineno"></span><span class="keyword" id="5032432">func</span>&nbsp;<span class="ident" id="5032437">cssEscaper</span><span class="op" id="5032447">(</span><span class="ident" id="5032448">args</span>&nbsp;<span class="op" id="5032453">...</span><span class="keyword" id="5032456">interface</span><span class="op" id="5032465">{</span><span class="op" id="5032466">}</span><span class="op" id="5032467">)</span>&nbsp;<span class="builtintype" id="5032469">string</span>&nbsp;<span class="op" id="5032476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5032479">s</span><span class="op" id="5032480">,</span>&nbsp;<span class="ident" id="5032482">_</span>&nbsp;<span class="op" id="5032484">:=</span>&nbsp;<span class="ident" id="5032487">stringify</span><span class="op" id="5032496">(</span><span class="ident" id="5032497">args</span><span class="op" id="5032501">...</span><span class="op" id="5032504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5032507">var</span>&nbsp;<span class="ident" id="5032511">b</span>&nbsp;<span class="ident" id="5032513">bytes</span><span class="op" id="5032518">.</span><span class="ident" id="5032519">Buffer</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5032527">written</span>&nbsp;<span class="op" id="5032535">:=</span>&nbsp;<span class="num" id="5032538">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5032541">for</span>&nbsp;<span class="ident" id="5032545">i</span><span class="op" id="5032546">,</span>&nbsp;<span class="ident" id="5032548">r</span>&nbsp;<span class="op" id="5032550">:=</span>&nbsp;<span class="keyword" id="5032553">range</span>&nbsp;<span class="ident" id="5032559">s</span>&nbsp;<span class="op" id="5032561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5032565">var</span>&nbsp;<span class="ident" id="5032569">repl</span>&nbsp;<span class="builtintype" id="5032574">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5032583">switch</span>&nbsp;<span class="ident" id="5032590">r</span>&nbsp;<span class="op" id="5032592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5032596">case</span>&nbsp;<span class="num" id="5032601">0</span><span class="op" id="5032602">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5032607">repl</span>&nbsp;<span class="op" id="5032612">=</span>&nbsp;<span class="string" id="5032614">`\0`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5032621">case</span>&nbsp;<span class="string" id="5032626">&#39;\t&#39;</span><span class="op" id="5032630">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5032635">repl</span>&nbsp;<span class="op" id="5032640">=</span>&nbsp;<span class="string" id="5032642">`\9`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5032649">case</span>&nbsp;<span class="string" id="5032654">&#39;\n&#39;</span><span class="op" id="5032658">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5032663">repl</span>&nbsp;<span class="op" id="5032668">=</span>&nbsp;<span class="string" id="5032670">`\a`</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5032677">case</span>&nbsp;<span class="string" id="5032682">&#39;\f&#39;</span><span class="op" id="5032686">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5032691">repl</span>&nbsp;<span class="op" id="5032696">=</span>&nbsp;<span class="string" id="5032698">`\c`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5032705">case</span>&nbsp;<span class="string" id="5032710">&#39;\r&#39;</span><span class="op" id="5032714">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5032719">repl</span>&nbsp;<span class="op" id="5032724">=</span>&nbsp;<span class="string" id="5032726">`\d`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5032733">//&nbsp;Encode&nbsp;HTML&nbsp;specials&nbsp;as&nbsp;hex&nbsp;so&nbsp;the&nbsp;output&nbsp;can&nbsp;be&nbsp;embedded</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5032796">//&nbsp;in&nbsp;HTML&nbsp;attributes&nbsp;without&nbsp;further&nbsp;encoding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5032846">case</span>&nbsp;<span class="string" id="5032851">&#39;&#34;&#39;</span><span class="op" id="5032854">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5032859">repl</span>&nbsp;<span class="op" id="5032864">=</span>&nbsp;<span class="string" id="5032866">`\22`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5032874">case</span>&nbsp;<span class="string" id="5032879">&#39;&amp;&#39;</span><span class="op" id="5032882">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5032887">repl</span>&nbsp;<span class="op" id="5032892">=</span>&nbsp;<span class="string" id="5032894">`\26`</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5032902">case</span>&nbsp;<span class="string" id="5032907">&#39;\&#39;&#39;</span><span class="op" id="5032911">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5032916">repl</span>&nbsp;<span class="op" id="5032921">=</span>&nbsp;<span class="string" id="5032923">`\27`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5032931">case</span>&nbsp;<span class="string" id="5032936">&#39;(&#39;</span><span class="op" id="5032939">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5032944">repl</span>&nbsp;<span class="op" id="5032949">=</span>&nbsp;<span class="string" id="5032951">`\28`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5032959">case</span>&nbsp;<span class="string" id="5032964">&#39;)&#39;</span><span class="op" id="5032967">:</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5032972">repl</span>&nbsp;<span class="op" id="5032977">=</span>&nbsp;<span class="string" id="5032979">`\29`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5032987">case</span>&nbsp;<span class="string" id="5032992">&#39;+&#39;</span><span class="op" id="5032995">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5033000">repl</span>&nbsp;<span class="op" id="5033005">=</span>&nbsp;<span class="string" id="5033007">`\2b`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5033015">case</span>&nbsp;<span class="string" id="5033020">&#39;/&#39;</span><span class="op" id="5033023">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5033028">repl</span>&nbsp;<span class="op" id="5033033">=</span>&nbsp;<span class="string" id="5033035">`\2f`</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5033043">case</span>&nbsp;<span class="string" id="5033048">&#39;:&#39;</span><span class="op" id="5033051">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5033056">repl</span>&nbsp;<span class="op" id="5033061">=</span>&nbsp;<span class="string" id="5033063">`\3a`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5033071">case</span>&nbsp;<span class="string" id="5033076">&#39;;&#39;</span><span class="op" id="5033079">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5033084">repl</span>&nbsp;<span class="op" id="5033089">=</span>&nbsp;<span class="string" id="5033091">`\3b`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5033099">case</span>&nbsp;<span class="string" id="5033104">&#39;&lt;&#39;</span><span class="op" id="5033107">:</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5033112">repl</span>&nbsp;<span class="op" id="5033117">=</span>&nbsp;<span class="string" id="5033119">`\3c`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5033127">case</span>&nbsp;<span class="string" id="5033132">&#39;&gt;&#39;</span><span class="op" id="5033135">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5033140">repl</span>&nbsp;<span class="op" id="5033145">=</span>&nbsp;<span class="string" id="5033147">`\3e`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5033155">case</span>&nbsp;<span class="string" id="5033160">&#39;\\&#39;</span><span class="op" id="5033164">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5033169">repl</span>&nbsp;<span class="op" id="5033174">=</span>&nbsp;<span class="string" id="5033176">`\\`</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5033183">case</span>&nbsp;<span class="string" id="5033188">&#39;{&#39;</span><span class="op" id="5033191">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5033196">repl</span>&nbsp;<span class="op" id="5033201">=</span>&nbsp;<span class="string" id="5033203">`\7b`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5033211">case</span>&nbsp;<span class="string" id="5033216">&#39;}&#39;</span><span class="op" id="5033219">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5033224">repl</span>&nbsp;<span class="op" id="5033229">=</span>&nbsp;<span class="string" id="5033231">`\7d`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5033239">default</span><span class="op" id="5033246">:</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5033251">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5033262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5033266">b</span><span class="op" id="5033267">.</span><span class="ident" id="5033268">WriteString</span><span class="op" id="5033279">(</span><span class="ident" id="5033280">s</span><span class="op" id="5033281">[</span><span class="ident" id="5033282">written</span><span class="op" id="5033289">:</span><span class="ident" id="5033290">i</span><span class="op" id="5033291">]</span><span class="op" id="5033292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5033296">b</span><span class="op" id="5033297">.</span><span class="ident" id="5033298">WriteString</span><span class="op" id="5033309">(</span><span class="ident" id="5033310">repl</span><span class="op" id="5033314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5033318">written</span>&nbsp;<span class="op" id="5033326">=</span>&nbsp;<span class="ident" id="5033328">i</span>&nbsp;<span class="op" id="5033330">+</span>&nbsp;<span class="ident" id="5033332">utf8</span><span class="op" id="5033336">.</span><span class="ident" id="5033337">RuneLen</span><span class="op" id="5033344">(</span><span class="ident" id="5033345">r</span><span class="op" id="5033346">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5033350">if</span>&nbsp;<span class="ident" id="5033353">repl</span>&nbsp;<span class="op" id="5033358">!=</span>&nbsp;<span class="string" id="5033361">`\\`</span>&nbsp;<span class="op" id="5033366">&amp;&amp;</span>&nbsp;<span class="op" id="5033369">(</span><span class="ident" id="5033370">written</span>&nbsp;<span class="op" id="5033378">==</span>&nbsp;<span class="builtinfunc" id="5033381">len</span><span class="op" id="5033384">(</span><span class="ident" id="5033385">s</span><span class="op" id="5033386">)</span>&nbsp;<span class="op" id="5033388">||</span>&nbsp;<span class="ident" id="5033391">isHex</span><span class="op" id="5033396">(</span><span class="ident" id="5033397">s</span><span class="op" id="5033398">[</span><span class="ident" id="5033399">written</span><span class="op" id="5033406">]</span><span class="op" id="5033407">)</span>&nbsp;<span class="op" id="5033409">||</span>&nbsp;<span class="ident" id="5033412">isCSSSpace</span><span class="op" id="5033422">(</span><span class="ident" id="5033423">s</span><span class="op" id="5033424">[</span><span class="ident" id="5033425">written</span><span class="op" id="5033432">]</span><span class="op" id="5033433">)</span><span class="op" id="5033434">)</span>&nbsp;<span class="op" id="5033436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5033441">b</span><span class="op" id="5033442">.</span><span class="ident" id="5033443">WriteByte</span><span class="op" id="5033452">(</span><span class="string" id="5033453">&#39;&nbsp;&#39;</span><span class="op" id="5033456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5033460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5033463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5033466">if</span>&nbsp;<span class="ident" id="5033469">written</span>&nbsp;<span class="op" id="5033477">==</span>&nbsp;<span class="num" id="5033480">0</span>&nbsp;<span class="op" id="5033482">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5033486">return</span>&nbsp;<span class="ident" id="5033493">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5033496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5033499">b</span><span class="op" id="5033500">.</span><span class="ident" id="5033501">WriteString</span><span class="op" id="5033512">(</span><span class="ident" id="5033513">s</span><span class="op" id="5033514">[</span><span class="ident" id="5033515">written</span><span class="op" id="5033522">:</span><span class="op" id="5033523">]</span><span class="op" id="5033524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5033527">return</span>&nbsp;<span class="ident" id="5033534">b</span><span class="op" id="5033535">.</span><span class="ident" id="5033536">String</span><span class="op" id="5033542">(</span><span class="op" id="5033543">)</span><br>
<span class="lineno"></span><span class="op" id="5033545">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="keyword" id="5033548">var</span>&nbsp;<span class="ident" id="5033552">expressionBytes</span>&nbsp;<span class="op" id="5033568">=</span>&nbsp;<span class="op" id="5033570">[</span><span class="op" id="5033571">]</span><span class="builtintype" id="5033572">byte</span><span class="op" id="5033576">(</span><span class="string" id="5033577">&#34;expression&#34;</span><span class="op" id="5033589">)</span><br>
<span class="lineno"></span><span class="keyword" id="5033591">var</span>&nbsp;<span class="ident" id="5033595">mozBindingBytes</span>&nbsp;<span class="op" id="5033611">=</span>&nbsp;<span class="op" id="5033613">[</span><span class="op" id="5033614">]</span><span class="builtintype" id="5033615">byte</span><span class="op" id="5033619">(</span><span class="string" id="5033620">&#34;mozbinding&#34;</span><span class="op" id="5033632">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5033635">//&nbsp;cssValueFilter&nbsp;allows&nbsp;innocuous&nbsp;CSS&nbsp;values&nbsp;in&nbsp;the&nbsp;output&nbsp;including&nbsp;CSS</span><br>
<span class="lineno">225</span><span class="comment" id="5033709">//&nbsp;quantities&nbsp;(10px&nbsp;or&nbsp;25%),&nbsp;ID&nbsp;or&nbsp;class&nbsp;literals&nbsp;(#foo,&nbsp;.bar),&nbsp;keyword&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="5033788">//&nbsp;(inherit,&nbsp;blue),&nbsp;and&nbsp;colors&nbsp;(#888).</span><br>
<span class="lineno"></span><span class="comment" id="5033827">//&nbsp;It&nbsp;filters&nbsp;out&nbsp;unsafe&nbsp;values,&nbsp;such&nbsp;as&nbsp;those&nbsp;that&nbsp;affect&nbsp;token&nbsp;boundaries,</span><br>
<span class="lineno"></span><span class="comment" id="5033904">//&nbsp;and&nbsp;anything&nbsp;that&nbsp;might&nbsp;execute&nbsp;scripts.</span><br>
<span class="lineno"></span><span class="keyword" id="5033948">func</span>&nbsp;<span class="ident" id="5033953">cssValueFilter</span><span class="op" id="5033967">(</span><span class="ident" id="5033968">args</span>&nbsp;<span class="op" id="5033973">...</span><span class="keyword" id="5033976">interface</span><span class="op" id="5033985">{</span><span class="op" id="5033986">}</span><span class="op" id="5033987">)</span>&nbsp;<span class="builtintype" id="5033989">string</span>&nbsp;<span class="op" id="5033996">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5033999">s</span><span class="op" id="5034000">,</span>&nbsp;<span class="ident" id="5034002">t</span>&nbsp;<span class="op" id="5034004">:=</span>&nbsp;<span class="ident" id="5034007">stringify</span><span class="op" id="5034016">(</span><span class="ident" id="5034017">args</span><span class="op" id="5034021">...</span><span class="op" id="5034024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5034027">if</span>&nbsp;<span class="ident" id="5034030">t</span>&nbsp;<span class="op" id="5034032">==</span>&nbsp;<span class="ident" id="5034035">contentTypeCSS</span>&nbsp;<span class="op" id="5034050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5034054">return</span>&nbsp;<span class="ident" id="5034061">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5034064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5034067">b</span><span class="op" id="5034068">,</span>&nbsp;<span class="ident" id="5034070">id</span>&nbsp;<span class="op" id="5034073">:=</span>&nbsp;<span class="ident" id="5034076">decodeCSS</span><span class="op" id="5034085">(</span><span class="op" id="5034086">[</span><span class="op" id="5034087">]</span><span class="builtintype" id="5034088">byte</span><span class="op" id="5034092">(</span><span class="ident" id="5034093">s</span><span class="op" id="5034094">)</span><span class="op" id="5034095">)</span><span class="op" id="5034096">,</span>&nbsp;<span class="builtinfunc" id="5034098">make</span><span class="op" id="5034102">(</span><span class="op" id="5034103">[</span><span class="op" id="5034104">]</span><span class="builtintype" id="5034105">byte</span><span class="op" id="5034109">,</span>&nbsp;<span class="num" id="5034111">0</span><span class="op" id="5034112">,</span>&nbsp;<span class="num" id="5034114">64</span><span class="op" id="5034116">)</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5034120">//&nbsp;CSS3&nbsp;error&nbsp;handling&nbsp;is&nbsp;specified&nbsp;as&nbsp;honoring&nbsp;string&nbsp;boundaries&nbsp;per</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5034191">//&nbsp;http://www.w3.org/TR/css3-syntax/#error-handling&nbsp;:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5034246">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Malformed&nbsp;declarations.&nbsp;User&nbsp;agents&nbsp;must&nbsp;handle&nbsp;unexpected</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5034313">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tokens&nbsp;encountered&nbsp;while&nbsp;parsing&nbsp;a&nbsp;declaration&nbsp;by&nbsp;reading&nbsp;until</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5034385">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;declaration,&nbsp;while&nbsp;observing&nbsp;the&nbsp;rules&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5034451">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matching&nbsp;pairs&nbsp;of&nbsp;(),&nbsp;[],&nbsp;{},&nbsp;&#34;&#34;,&nbsp;and&nbsp;&#39;&#39;,&nbsp;and&nbsp;correctly&nbsp;handling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5034524">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;escapes.&nbsp;For&nbsp;example,&nbsp;a&nbsp;malformed&nbsp;declaration&nbsp;may&nbsp;be&nbsp;missing&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5034595">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;property,&nbsp;colon&nbsp;(:)&nbsp;or&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5034633">//&nbsp;So&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure&nbsp;that&nbsp;values&nbsp;do&nbsp;not&nbsp;have&nbsp;mismatched&nbsp;bracket</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5034704">//&nbsp;or&nbsp;quote&nbsp;characters&nbsp;to&nbsp;prevent&nbsp;the&nbsp;browser&nbsp;from&nbsp;restarting&nbsp;parsing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5034775">//&nbsp;inside&nbsp;a&nbsp;string&nbsp;that&nbsp;might&nbsp;embed&nbsp;JavaScript&nbsp;source.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5034831">for</span>&nbsp;<span class="ident" id="5034835">i</span><span class="op" id="5034836">,</span>&nbsp;<span class="ident" id="5034838">c</span>&nbsp;<span class="op" id="5034840">:=</span>&nbsp;<span class="keyword" id="5034843">range</span>&nbsp;<span class="ident" id="5034849">b</span>&nbsp;<span class="op" id="5034851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5034855">switch</span>&nbsp;<span class="ident" id="5034862">c</span>&nbsp;<span class="op" id="5034864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5034868">case</span>&nbsp;<span class="num" id="5034873">0</span><span class="op" id="5034874">,</span>&nbsp;<span class="string" id="5034876">&#39;&#34;&#39;</span><span class="op" id="5034879">,</span>&nbsp;<span class="string" id="5034881">&#39;\&#39;&#39;</span><span class="op" id="5034885">,</span>&nbsp;<span class="string" id="5034887">&#39;(&#39;</span><span class="op" id="5034890">,</span>&nbsp;<span class="string" id="5034892">&#39;)&#39;</span><span class="op" id="5034895">,</span>&nbsp;<span class="string" id="5034897">&#39;/&#39;</span><span class="op" id="5034900">,</span>&nbsp;<span class="string" id="5034902">&#39;;&#39;</span><span class="op" id="5034905">,</span>&nbsp;<span class="string" id="5034907">&#39;@&#39;</span><span class="op" id="5034910">,</span>&nbsp;<span class="string" id="5034912">&#39;[&#39;</span><span class="op" id="5034915">,</span>&nbsp;<span class="string" id="5034917">&#39;\\&#39;</span><span class="op" id="5034921">,</span>&nbsp;<span class="string" id="5034923">&#39;]&#39;</span><span class="op" id="5034926">,</span>&nbsp;<span class="string" id="5034928">&#39;`&#39;</span><span class="op" id="5034931">,</span>&nbsp;<span class="string" id="5034933">&#39;{&#39;</span><span class="op" id="5034936">,</span>&nbsp;<span class="string" id="5034938">&#39;}&#39;</span><span class="op" id="5034941">:</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5034946">return</span>&nbsp;<span class="ident" id="5034953">filterFailsafe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5034970">case</span>&nbsp;<span class="string" id="5034975">&#39;-&#39;</span><span class="op" id="5034978">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5034983">//&nbsp;Disallow&nbsp;&lt;!--&nbsp;or&nbsp;--&gt;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5035011">//&nbsp;--&nbsp;should&nbsp;not&nbsp;appear&nbsp;in&nbsp;valid&nbsp;identifiers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5035060">if</span>&nbsp;<span class="ident" id="5035063">i</span>&nbsp;<span class="op" id="5035065">!=</span>&nbsp;<span class="num" id="5035068">0</span>&nbsp;<span class="op" id="5035070">&amp;&amp;</span>&nbsp;<span class="ident" id="5035073">b</span><span class="op" id="5035074">[</span><span class="ident" id="5035075">i</span><span class="op" id="5035076">-</span><span class="num" id="5035077">1</span><span class="op" id="5035078">]</span>&nbsp;<span class="op" id="5035080">==</span>&nbsp;<span class="string" id="5035083">&#39;-&#39;</span>&nbsp;<span class="op" id="5035087">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5035093">return</span>&nbsp;<span class="ident" id="5035100">filterFailsafe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5035118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5035122">default</span><span class="op" id="5035129">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5035134">if</span>&nbsp;<span class="ident" id="5035137">c</span>&nbsp;<span class="op" id="5035139">&lt;</span>&nbsp;<span class="num" id="5035141">0x80</span>&nbsp;<span class="op" id="5035146">&amp;&amp;</span>&nbsp;<span class="ident" id="5035149">isCSSNmchar</span><span class="op" id="5035160">(</span><span class="builtintype" id="5035161">rune</span><span class="op" id="5035165">(</span><span class="ident" id="5035166">c</span><span class="op" id="5035167">)</span><span class="op" id="5035168">)</span>&nbsp;<span class="op" id="5035170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5035176">id</span>&nbsp;<span class="op" id="5035179">=</span>&nbsp;<span class="builtinfunc" id="5035181">append</span><span class="op" id="5035187">(</span><span class="ident" id="5035188">id</span><span class="op" id="5035190">,</span>&nbsp;<span class="ident" id="5035192">c</span><span class="op" id="5035193">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5035198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5035202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5035205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5035208">id</span>&nbsp;<span class="op" id="5035211">=</span>&nbsp;<span class="ident" id="5035213">bytes</span><span class="op" id="5035218">.</span><span class="ident" id="5035219">ToLower</span><span class="op" id="5035226">(</span><span class="ident" id="5035227">id</span><span class="op" id="5035229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5035232">if</span>&nbsp;<span class="ident" id="5035235">bytes</span><span class="op" id="5035240">.</span><span class="ident" id="5035241">Index</span><span class="op" id="5035246">(</span><span class="ident" id="5035247">id</span><span class="op" id="5035249">,</span>&nbsp;<span class="ident" id="5035251">expressionBytes</span><span class="op" id="5035266">)</span>&nbsp;<span class="op" id="5035268">!=</span>&nbsp;<span class="op" id="5035271">-</span><span class="num" id="5035272">1</span>&nbsp;<span class="op" id="5035274">||</span>&nbsp;<span class="ident" id="5035277">bytes</span><span class="op" id="5035282">.</span><span class="ident" id="5035283">Index</span><span class="op" id="5035288">(</span><span class="ident" id="5035289">id</span><span class="op" id="5035291">,</span>&nbsp;<span class="ident" id="5035293">mozBindingBytes</span><span class="op" id="5035308">)</span>&nbsp;<span class="op" id="5035310">!=</span>&nbsp;<span class="op" id="5035313">-</span><span class="num" id="5035314">1</span>&nbsp;<span class="op" id="5035316">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5035320">return</span>&nbsp;<span class="ident" id="5035327">filterFailsafe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5035343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5035346">return</span>&nbsp;<span class="builtintype" id="5035353">string</span><span class="op" id="5035359">(</span><span class="ident" id="5035360">b</span><span class="op" id="5035361">)</span><br>
<span class="lineno"></span><span class="op" id="5035363">}</span>
</div>
</body>
</html>
