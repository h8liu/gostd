<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime</h2>
<ul>
<li><a href="/gostd/mime/grammar.go.html">grammar.go</a></li>
<li><a href="/gostd/mime/mediatype.go.html">mediatype.go</a></li>
<li><a href="/gostd/mime/mediatype_test.go.html">mediatype_test.go</a></li>
<li><a href="/gostd/mime/type.go.html">type.go</a></li>
<li><a href="/gostd/mime/type_test.go.html">type_test.go</a></li>
<li><a href="/gostd/mime/type_unix.go.html">type_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7615622">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7615677">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7615731">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7615782">package</span>&nbsp;<span class="ident" id="7615790">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7615796">import</span>&nbsp;<span class="op" id="7615803">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7615806">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7615817">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="7615827">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7615830">func</span>&nbsp;<span class="ident" id="7615835">TestConsumeToken</span><span class="op" id="7615851">(</span><span class="ident" id="7615852">t</span>&nbsp;<span class="op" id="7615854">*</span><span class="ident" id="7615855">testing</span><span class="op" id="7615862">.</span><span class="ident" id="7615863">T</span><span class="op" id="7615864">)</span>&nbsp;<span class="op" id="7615866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7615869">tests</span>&nbsp;<span class="op" id="7615875">:=</span>&nbsp;<span class="op" id="7615878">[</span><span class="op" id="7615879">...</span><span class="op" id="7615882">]</span><span class="op" id="7615883">[</span><span class="num" id="7615884">3</span><span class="op" id="7615885">]</span><span class="builtintype" id="7615886">string</span><span class="op" id="7615892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7615896">{</span><span class="string" id="7615897">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7615906">,</span>&nbsp;<span class="string" id="7615908">&#34;foo&#34;</span><span class="op" id="7615913">,</span>&nbsp;<span class="string" id="7615915">&#34;&nbsp;bar&#34;</span><span class="op" id="7615921">}</span><span class="op" id="7615922">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7615926">{</span><span class="string" id="7615927">&#34;bar&#34;</span><span class="op" id="7615932">,</span>&nbsp;<span class="string" id="7615934">&#34;bar&#34;</span><span class="op" id="7615939">,</span>&nbsp;<span class="string" id="7615941">&#34;&#34;</span><span class="op" id="7615943">}</span><span class="op" id="7615944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7615948">{</span><span class="string" id="7615949">&#34;&#34;</span><span class="op" id="7615951">,</span>&nbsp;<span class="string" id="7615953">&#34;&#34;</span><span class="op" id="7615955">,</span>&nbsp;<span class="string" id="7615957">&#34;&#34;</span><span class="op" id="7615959">}</span><span class="op" id="7615960">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7615964">{</span><span class="string" id="7615965">&#34;&nbsp;foo&#34;</span><span class="op" id="7615971">,</span>&nbsp;<span class="string" id="7615973">&#34;&#34;</span><span class="op" id="7615975">,</span>&nbsp;<span class="string" id="7615977">&#34;&nbsp;foo&#34;</span><span class="op" id="7615983">}</span><span class="op" id="7615984">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7615987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7615990">for</span>&nbsp;<span class="ident" id="7615994">_</span><span class="op" id="7615995">,</span>&nbsp;<span class="ident" id="7615997">test</span>&nbsp;<span class="op" id="7616002">:=</span>&nbsp;<span class="keyword" id="7616005">range</span>&nbsp;<span class="ident" id="7616011">tests</span>&nbsp;<span class="op" id="7616017">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7616021">token</span><span class="op" id="7616026">,</span>&nbsp;<span class="ident" id="7616028">rest</span>&nbsp;<span class="op" id="7616033">:=</span>&nbsp;<span class="ident" id="7616036">consumeToken</span><span class="op" id="7616048">(</span><span class="ident" id="7616049">test</span><span class="op" id="7616053">[</span><span class="num" id="7616054">0</span><span class="op" id="7616055">]</span><span class="op" id="7616056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7616060">expectedToken</span>&nbsp;<span class="op" id="7616074">:=</span>&nbsp;<span class="ident" id="7616077">test</span><span class="op" id="7616081">[</span><span class="num" id="7616082">1</span><span class="op" id="7616083">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7616087">expectedRest</span>&nbsp;<span class="op" id="7616100">:=</span>&nbsp;<span class="ident" id="7616103">test</span><span class="op" id="7616107">[</span><span class="num" id="7616108">2</span><span class="op" id="7616109">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7616113">if</span>&nbsp;<span class="ident" id="7616116">token</span>&nbsp;<span class="op" id="7616122">!=</span>&nbsp;<span class="ident" id="7616125">expectedToken</span>&nbsp;<span class="op" id="7616139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7616144">t</span><span class="op" id="7616145">.</span><span class="ident" id="7616146">Errorf</span><span class="op" id="7616152">(</span><span class="string" id="7616153">&#34;expected&nbsp;to&nbsp;consume&nbsp;token&nbsp;&#39;%s&#39;,&nbsp;not&nbsp;&#39;%s&#39;&nbsp;from&nbsp;&#39;%s&#39;&#34;</span><span class="op" id="7616205">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7616211">expectedToken</span><span class="op" id="7616224">,</span>&nbsp;<span class="ident" id="7616226">token</span><span class="op" id="7616231">,</span>&nbsp;<span class="ident" id="7616233">test</span><span class="op" id="7616237">[</span><span class="num" id="7616238">0</span><span class="op" id="7616239">]</span><span class="op" id="7616240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7616244">}</span>&nbsp;<span class="keyword" id="7616246">else</span>&nbsp;<span class="keyword" id="7616251">if</span>&nbsp;<span class="ident" id="7616254">rest</span>&nbsp;<span class="op" id="7616259">!=</span>&nbsp;<span class="ident" id="7616262">expectedRest</span>&nbsp;<span class="op" id="7616275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7616280">t</span><span class="op" id="7616281">.</span><span class="ident" id="7616282">Errorf</span><span class="op" id="7616288">(</span><span class="string" id="7616289">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;&#39;%s&#39;,&nbsp;not&nbsp;&#39;%s&#39;&nbsp;after&nbsp;reading&nbsp;token&nbsp;&#39;%s&#39;&nbsp;from&nbsp;&#39;%s&#39;&#34;</span><span class="op" id="7616362">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7616368">expectedRest</span><span class="op" id="7616380">,</span>&nbsp;<span class="ident" id="7616382">rest</span><span class="op" id="7616386">,</span>&nbsp;<span class="ident" id="7616388">token</span><span class="op" id="7616393">,</span>&nbsp;<span class="ident" id="7616395">test</span><span class="op" id="7616399">[</span><span class="num" id="7616400">0</span><span class="op" id="7616401">]</span><span class="op" id="7616402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7616406">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7616409">}</span><br>
<span class="lineno"></span><span class="op" id="7616411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7616414">func</span>&nbsp;<span class="ident" id="7616419">TestConsumeValue</span><span class="op" id="7616435">(</span><span class="ident" id="7616436">t</span>&nbsp;<span class="op" id="7616438">*</span><span class="ident" id="7616439">testing</span><span class="op" id="7616446">.</span><span class="ident" id="7616447">T</span><span class="op" id="7616448">)</span>&nbsp;<span class="op" id="7616450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7616453">tests</span>&nbsp;<span class="op" id="7616459">:=</span>&nbsp;<span class="op" id="7616462">[</span><span class="op" id="7616463">...</span><span class="op" id="7616466">]</span><span class="op" id="7616467">[</span><span class="num" id="7616468">3</span><span class="op" id="7616469">]</span><span class="builtintype" id="7616470">string</span><span class="op" id="7616476">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7616480">{</span><span class="string" id="7616481">&#34;foo&nbsp;bar&#34;</span><span class="op" id="7616490">,</span>&nbsp;<span class="string" id="7616492">&#34;foo&#34;</span><span class="op" id="7616497">,</span>&nbsp;<span class="string" id="7616499">&#34;&nbsp;bar&#34;</span><span class="op" id="7616505">}</span><span class="op" id="7616506">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7616510">{</span><span class="string" id="7616511">&#34;bar&#34;</span><span class="op" id="7616516">,</span>&nbsp;<span class="string" id="7616518">&#34;bar&#34;</span><span class="op" id="7616523">,</span>&nbsp;<span class="string" id="7616525">&#34;&#34;</span><span class="op" id="7616527">}</span><span class="op" id="7616528">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7616532">{</span><span class="string" id="7616533">&#34;&nbsp;bar&nbsp;&#34;</span><span class="op" id="7616540">,</span>&nbsp;<span class="string" id="7616542">&#34;&#34;</span><span class="op" id="7616544">,</span>&nbsp;<span class="string" id="7616546">&#34;&nbsp;bar&nbsp;&#34;</span><span class="op" id="7616553">}</span><span class="op" id="7616554">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7616558">{</span><span class="string" id="7616559">`&#34;My&nbsp;value&#34;end`</span><span class="op" id="7616574">,</span>&nbsp;<span class="string" id="7616576">&#34;My&nbsp;value&#34;</span><span class="op" id="7616586">,</span>&nbsp;<span class="string" id="7616588">&#34;end&#34;</span><span class="op" id="7616593">}</span><span class="op" id="7616594">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7616598">{</span><span class="string" id="7616599">`&#34;My&nbsp;value&#34;&nbsp;end`</span><span class="op" id="7616615">,</span>&nbsp;<span class="string" id="7616617">&#34;My&nbsp;value&#34;</span><span class="op" id="7616627">,</span>&nbsp;<span class="string" id="7616629">&#34;&nbsp;end&#34;</span><span class="op" id="7616635">}</span><span class="op" id="7616636">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7616640">{</span><span class="string" id="7616641">`&#34;\\&#34;&nbsp;rest`</span><span class="op" id="7616652">,</span>&nbsp;<span class="string" id="7616654">&#34;\\&#34;</span><span class="op" id="7616658">,</span>&nbsp;<span class="string" id="7616660">&#34;&nbsp;rest&#34;</span><span class="op" id="7616667">}</span><span class="op" id="7616668">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7616672">{</span><span class="string" id="7616673">`&#34;My&nbsp;\&#34;&nbsp;value&#34;end`</span><span class="op" id="7616691">,</span>&nbsp;<span class="string" id="7616693">&#34;My&nbsp;\&#34;&nbsp;value&#34;</span><span class="op" id="7616706">,</span>&nbsp;<span class="string" id="7616708">&#34;end&#34;</span><span class="op" id="7616713">}</span><span class="op" id="7616714">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7616718">{</span><span class="string" id="7616719">`&#34;\&#34;&nbsp;rest`</span><span class="op" id="7616729">,</span>&nbsp;<span class="string" id="7616731">&#34;&#34;</span><span class="op" id="7616733">,</span>&nbsp;<span class="string" id="7616735">`&#34;\&#34;&nbsp;rest`</span><span class="op" id="7616745">}</span><span class="op" id="7616746">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7616749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7616752">for</span>&nbsp;<span class="ident" id="7616756">_</span><span class="op" id="7616757">,</span>&nbsp;<span class="ident" id="7616759">test</span>&nbsp;<span class="op" id="7616764">:=</span>&nbsp;<span class="keyword" id="7616767">range</span>&nbsp;<span class="ident" id="7616773">tests</span>&nbsp;<span class="op" id="7616779">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7616783">value</span><span class="op" id="7616788">,</span>&nbsp;<span class="ident" id="7616790">rest</span>&nbsp;<span class="op" id="7616795">:=</span>&nbsp;<span class="ident" id="7616798">consumeValue</span><span class="op" id="7616810">(</span><span class="ident" id="7616811">test</span><span class="op" id="7616815">[</span><span class="num" id="7616816">0</span><span class="op" id="7616817">]</span><span class="op" id="7616818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7616822">expectedValue</span>&nbsp;<span class="op" id="7616836">:=</span>&nbsp;<span class="ident" id="7616839">test</span><span class="op" id="7616843">[</span><span class="num" id="7616844">1</span><span class="op" id="7616845">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7616849">expectedRest</span>&nbsp;<span class="op" id="7616862">:=</span>&nbsp;<span class="ident" id="7616865">test</span><span class="op" id="7616869">[</span><span class="num" id="7616870">2</span><span class="op" id="7616871">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7616875">if</span>&nbsp;<span class="ident" id="7616878">value</span>&nbsp;<span class="op" id="7616884">!=</span>&nbsp;<span class="ident" id="7616887">expectedValue</span>&nbsp;<span class="op" id="7616901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7616906">t</span><span class="op" id="7616907">.</span><span class="ident" id="7616908">Errorf</span><span class="op" id="7616914">(</span><span class="string" id="7616915">&#34;expected&nbsp;to&nbsp;consume&nbsp;value&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="7616967">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7616973">expectedValue</span><span class="op" id="7616986">,</span>&nbsp;<span class="ident" id="7616988">value</span><span class="op" id="7616993">,</span>&nbsp;<span class="ident" id="7616995">test</span><span class="op" id="7616999">[</span><span class="num" id="7617000">0</span><span class="op" id="7617001">]</span><span class="op" id="7617002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7617006">}</span>&nbsp;<span class="keyword" id="7617008">else</span>&nbsp;<span class="keyword" id="7617013">if</span>&nbsp;<span class="ident" id="7617016">rest</span>&nbsp;<span class="op" id="7617021">!=</span>&nbsp;<span class="ident" id="7617024">expectedRest</span>&nbsp;<span class="op" id="7617037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7617042">t</span><span class="op" id="7617043">.</span><span class="ident" id="7617044">Errorf</span><span class="op" id="7617050">(</span><span class="string" id="7617051">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;after&nbsp;reading&nbsp;value&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="7617124">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7617130">expectedRest</span><span class="op" id="7617142">,</span>&nbsp;<span class="ident" id="7617144">rest</span><span class="op" id="7617148">,</span>&nbsp;<span class="ident" id="7617150">value</span><span class="op" id="7617155">,</span>&nbsp;<span class="ident" id="7617157">test</span><span class="op" id="7617161">[</span><span class="num" id="7617162">0</span><span class="op" id="7617163">]</span><span class="op" id="7617164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7617168">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7617171">}</span><br>
<span class="lineno"></span><span class="op" id="7617173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7617176">func</span>&nbsp;<span class="ident" id="7617181">TestConsumeMediaParam</span><span class="op" id="7617202">(</span><span class="ident" id="7617203">t</span>&nbsp;<span class="op" id="7617205">*</span><span class="ident" id="7617206">testing</span><span class="op" id="7617213">.</span><span class="ident" id="7617214">T</span><span class="op" id="7617215">)</span>&nbsp;<span class="op" id="7617217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7617220">tests</span>&nbsp;<span class="op" id="7617226">:=</span>&nbsp;<span class="op" id="7617229">[</span><span class="op" id="7617230">...</span><span class="op" id="7617233">]</span><span class="op" id="7617234">[</span><span class="num" id="7617235">4</span><span class="op" id="7617236">]</span><span class="builtintype" id="7617237">string</span><span class="op" id="7617243">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7617247">{</span><span class="string" id="7617248">&#34;&nbsp;;&nbsp;foo=bar&#34;</span><span class="op" id="7617260">,</span>&nbsp;<span class="string" id="7617262">&#34;foo&#34;</span><span class="op" id="7617267">,</span>&nbsp;<span class="string" id="7617269">&#34;bar&#34;</span><span class="op" id="7617274">,</span>&nbsp;<span class="string" id="7617276">&#34;&#34;</span><span class="op" id="7617278">}</span><span class="op" id="7617279">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7617283">{</span><span class="string" id="7617284">&#34;;&nbsp;foo=bar&#34;</span><span class="op" id="7617295">,</span>&nbsp;<span class="string" id="7617297">&#34;foo&#34;</span><span class="op" id="7617302">,</span>&nbsp;<span class="string" id="7617304">&#34;bar&#34;</span><span class="op" id="7617309">,</span>&nbsp;<span class="string" id="7617311">&#34;&#34;</span><span class="op" id="7617313">}</span><span class="op" id="7617314">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7617318">{</span><span class="string" id="7617319">&#34;;foo=bar&#34;</span><span class="op" id="7617329">,</span>&nbsp;<span class="string" id="7617331">&#34;foo&#34;</span><span class="op" id="7617336">,</span>&nbsp;<span class="string" id="7617338">&#34;bar&#34;</span><span class="op" id="7617343">,</span>&nbsp;<span class="string" id="7617345">&#34;&#34;</span><span class="op" id="7617347">}</span><span class="op" id="7617348">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7617352">{</span><span class="string" id="7617353">&#34;;FOO=bar&#34;</span><span class="op" id="7617363">,</span>&nbsp;<span class="string" id="7617365">&#34;foo&#34;</span><span class="op" id="7617370">,</span>&nbsp;<span class="string" id="7617372">&#34;bar&#34;</span><span class="op" id="7617377">,</span>&nbsp;<span class="string" id="7617379">&#34;&#34;</span><span class="op" id="7617381">}</span><span class="op" id="7617382">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7617386">{</span><span class="string" id="7617387">`;foo=&#34;bar&#34;`</span><span class="op" id="7617399">,</span>&nbsp;<span class="string" id="7617401">&#34;foo&#34;</span><span class="op" id="7617406">,</span>&nbsp;<span class="string" id="7617408">&#34;bar&#34;</span><span class="op" id="7617413">,</span>&nbsp;<span class="string" id="7617415">&#34;&#34;</span><span class="op" id="7617417">}</span><span class="op" id="7617418">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7617422">{</span><span class="string" id="7617423">`;foo=&#34;bar&#34;;&nbsp;`</span><span class="op" id="7617437">,</span>&nbsp;<span class="string" id="7617439">&#34;foo&#34;</span><span class="op" id="7617444">,</span>&nbsp;<span class="string" id="7617446">&#34;bar&#34;</span><span class="op" id="7617451">,</span>&nbsp;<span class="string" id="7617453">&#34;;&nbsp;&#34;</span><span class="op" id="7617457">}</span><span class="op" id="7617458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7617462">{</span><span class="string" id="7617463">`;foo=&#34;bar&#34;;&nbsp;foo=baz`</span><span class="op" id="7617484">,</span>&nbsp;<span class="string" id="7617486">&#34;foo&#34;</span><span class="op" id="7617491">,</span>&nbsp;<span class="string" id="7617493">&#34;bar&#34;</span><span class="op" id="7617498">,</span>&nbsp;<span class="string" id="7617500">&#34;;&nbsp;foo=baz&#34;</span><span class="op" id="7617511">}</span><span class="op" id="7617512">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7617516">{</span><span class="string" id="7617517">`&nbsp;;&nbsp;boundary=----CUT;`</span><span class="op" id="7617539">,</span>&nbsp;<span class="string" id="7617541">&#34;boundary&#34;</span><span class="op" id="7617551">,</span>&nbsp;<span class="string" id="7617553">&#34;----CUT&#34;</span><span class="op" id="7617562">,</span>&nbsp;<span class="string" id="7617564">&#34;;&#34;</span><span class="op" id="7617567">}</span><span class="op" id="7617568">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7617572">{</span><span class="string" id="7617573">`&nbsp;;&nbsp;key=value;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="7617614">,</span>&nbsp;<span class="string" id="7617616">&#34;key&#34;</span><span class="op" id="7617621">,</span>&nbsp;<span class="string" id="7617623">&#34;value&#34;</span><span class="op" id="7617630">,</span>&nbsp;<span class="string" id="7617632">`;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="7617661">}</span><span class="op" id="7617662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7617666">{</span><span class="string" id="7617667">`;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="7617696">,</span>&nbsp;<span class="string" id="7617698">&#34;blah&#34;</span><span class="op" id="7617704">,</span>&nbsp;<span class="string" id="7617706">&#34;value&#34;</span><span class="op" id="7617713">,</span>&nbsp;<span class="string" id="7617715">`;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="7617729">}</span><span class="op" id="7617730">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7617734">{</span><span class="string" id="7617735">`;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="7617749">,</span>&nbsp;<span class="string" id="7617751">&#34;name&#34;</span><span class="op" id="7617757">,</span>&nbsp;<span class="string" id="7617759">&#34;foo&#34;</span><span class="op" id="7617764">,</span>&nbsp;<span class="string" id="7617766">`&nbsp;`</span><span class="op" id="7617769">}</span><span class="op" id="7617770">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7617773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7617776">for</span>&nbsp;<span class="ident" id="7617780">_</span><span class="op" id="7617781">,</span>&nbsp;<span class="ident" id="7617783">test</span>&nbsp;<span class="op" id="7617788">:=</span>&nbsp;<span class="keyword" id="7617791">range</span>&nbsp;<span class="ident" id="7617797">tests</span>&nbsp;<span class="op" id="7617803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7617807">param</span><span class="op" id="7617812">,</span>&nbsp;<span class="ident" id="7617814">value</span><span class="op" id="7617819">,</span>&nbsp;<span class="ident" id="7617821">rest</span>&nbsp;<span class="op" id="7617826">:=</span>&nbsp;<span class="ident" id="7617829">consumeMediaParam</span><span class="op" id="7617846">(</span><span class="ident" id="7617847">test</span><span class="op" id="7617851">[</span><span class="num" id="7617852">0</span><span class="op" id="7617853">]</span><span class="op" id="7617854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7617858">expectedParam</span>&nbsp;<span class="op" id="7617872">:=</span>&nbsp;<span class="ident" id="7617875">test</span><span class="op" id="7617879">[</span><span class="num" id="7617880">1</span><span class="op" id="7617881">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7617885">expectedValue</span>&nbsp;<span class="op" id="7617899">:=</span>&nbsp;<span class="ident" id="7617902">test</span><span class="op" id="7617906">[</span><span class="num" id="7617907">2</span><span class="op" id="7617908">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7617912">expectedRest</span>&nbsp;<span class="op" id="7617925">:=</span>&nbsp;<span class="ident" id="7617928">test</span><span class="op" id="7617932">[</span><span class="num" id="7617933">3</span><span class="op" id="7617934">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7617938">if</span>&nbsp;<span class="ident" id="7617941">param</span>&nbsp;<span class="op" id="7617947">!=</span>&nbsp;<span class="ident" id="7617950">expectedParam</span>&nbsp;<span class="op" id="7617964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7617969">t</span><span class="op" id="7617970">.</span><span class="ident" id="7617971">Errorf</span><span class="op" id="7617977">(</span><span class="string" id="7617978">&#34;expected&nbsp;to&nbsp;consume&nbsp;param&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="7618030">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7618036">expectedParam</span><span class="op" id="7618049">,</span>&nbsp;<span class="ident" id="7618051">param</span><span class="op" id="7618056">,</span>&nbsp;<span class="ident" id="7618058">test</span><span class="op" id="7618062">[</span><span class="num" id="7618063">0</span><span class="op" id="7618064">]</span><span class="op" id="7618065">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7618069">}</span>&nbsp;<span class="keyword" id="7618071">else</span>&nbsp;<span class="keyword" id="7618076">if</span>&nbsp;<span class="ident" id="7618079">value</span>&nbsp;<span class="op" id="7618085">!=</span>&nbsp;<span class="ident" id="7618088">expectedValue</span>&nbsp;<span class="op" id="7618102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7618107">t</span><span class="op" id="7618108">.</span><span class="ident" id="7618109">Errorf</span><span class="op" id="7618115">(</span><span class="string" id="7618116">&#34;expected&nbsp;to&nbsp;consume&nbsp;value&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="7618168">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7618174">expectedValue</span><span class="op" id="7618187">,</span>&nbsp;<span class="ident" id="7618189">value</span><span class="op" id="7618194">,</span>&nbsp;<span class="ident" id="7618196">test</span><span class="op" id="7618200">[</span><span class="num" id="7618201">0</span><span class="op" id="7618202">]</span><span class="op" id="7618203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7618207">}</span>&nbsp;<span class="keyword" id="7618209">else</span>&nbsp;<span class="keyword" id="7618214">if</span>&nbsp;<span class="ident" id="7618217">rest</span>&nbsp;<span class="op" id="7618222">!=</span>&nbsp;<span class="ident" id="7618225">expectedRest</span>&nbsp;<span class="op" id="7618238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7618243">t</span><span class="op" id="7618244">.</span><span class="ident" id="7618245">Errorf</span><span class="op" id="7618251">(</span><span class="string" id="7618252">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;after&nbsp;reading&nbsp;[%s/%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="7618322">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7618328">expectedRest</span><span class="op" id="7618340">,</span>&nbsp;<span class="ident" id="7618342">rest</span><span class="op" id="7618346">,</span>&nbsp;<span class="ident" id="7618348">param</span><span class="op" id="7618353">,</span>&nbsp;<span class="ident" id="7618355">value</span><span class="op" id="7618360">,</span>&nbsp;<span class="ident" id="7618362">test</span><span class="op" id="7618366">[</span><span class="num" id="7618367">0</span><span class="op" id="7618368">]</span><span class="op" id="7618369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7618373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7618376">}</span><br>
<span class="lineno"></span><span class="op" id="7618378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="7618381">type</span>&nbsp;<span class="ident" id="7618386">mediaTypeTest</span>&nbsp;<span class="keyword" id="7618400">struct</span>&nbsp;<span class="op" id="7618407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7618410">in</span>&nbsp;<span class="builtintype" id="7618413">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7618421">t</span>&nbsp;&nbsp;<span class="builtintype" id="7618424">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7618432">p</span>&nbsp;&nbsp;<span class="keyword" id="7618435">map</span><span class="op" id="7618438">[</span><span class="builtintype" id="7618439">string</span><span class="op" id="7618445">]</span><span class="builtintype" id="7618446">string</span><br>
<span class="lineno"></span><span class="op" id="7618453">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="7618456">func</span>&nbsp;<span class="ident" id="7618461">TestParseMediaType</span><span class="op" id="7618479">(</span><span class="ident" id="7618480">t</span>&nbsp;<span class="op" id="7618482">*</span><span class="ident" id="7618483">testing</span><span class="op" id="7618490">.</span><span class="ident" id="7618491">T</span><span class="op" id="7618492">)</span>&nbsp;<span class="op" id="7618494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7618497">//&nbsp;Convenience&nbsp;map&nbsp;initializer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7618529">m</span>&nbsp;<span class="op" id="7618531">:=</span>&nbsp;<span class="keyword" id="7618534">func</span><span class="op" id="7618538">(</span><span class="ident" id="7618539">s</span>&nbsp;<span class="op" id="7618541">...</span><span class="builtintype" id="7618544">string</span><span class="op" id="7618550">)</span>&nbsp;<span class="keyword" id="7618552">map</span><span class="op" id="7618555">[</span><span class="builtintype" id="7618556">string</span><span class="op" id="7618562">]</span><span class="builtintype" id="7618563">string</span>&nbsp;<span class="op" id="7618570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7618574">sm</span>&nbsp;<span class="op" id="7618577">:=</span>&nbsp;<span class="builtinfunc" id="7618580">make</span><span class="op" id="7618584">(</span><span class="keyword" id="7618585">map</span><span class="op" id="7618588">[</span><span class="builtintype" id="7618589">string</span><span class="op" id="7618595">]</span><span class="builtintype" id="7618596">string</span><span class="op" id="7618602">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7618606">for</span>&nbsp;<span class="ident" id="7618610">i</span>&nbsp;<span class="op" id="7618612">:=</span>&nbsp;<span class="num" id="7618615">0</span><span class="op" id="7618616">;</span>&nbsp;<span class="ident" id="7618618">i</span>&nbsp;<span class="op" id="7618620">&lt;</span>&nbsp;<span class="builtinfunc" id="7618622">len</span><span class="op" id="7618625">(</span><span class="ident" id="7618626">s</span><span class="op" id="7618627">)</span><span class="op" id="7618628">;</span>&nbsp;<span class="ident" id="7618630">i</span>&nbsp;<span class="op" id="7618632">+=</span>&nbsp;<span class="num" id="7618635">2</span>&nbsp;<span class="op" id="7618637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7618642">sm</span><span class="op" id="7618644">[</span><span class="ident" id="7618645">s</span><span class="op" id="7618646">[</span><span class="ident" id="7618647">i</span><span class="op" id="7618648">]</span><span class="op" id="7618649">]</span>&nbsp;<span class="op" id="7618651">=</span>&nbsp;<span class="ident" id="7618653">s</span><span class="op" id="7618654">[</span><span class="ident" id="7618655">i</span><span class="op" id="7618656">+</span><span class="num" id="7618657">1</span><span class="op" id="7618658">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7618662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7618666">return</span>&nbsp;<span class="ident" id="7618673">sm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7618677">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7618681">nameFoo</span>&nbsp;<span class="op" id="7618689">:=</span>&nbsp;<span class="keyword" id="7618692">map</span><span class="op" id="7618695">[</span><span class="builtintype" id="7618696">string</span><span class="op" id="7618702">]</span><span class="builtintype" id="7618703">string</span><span class="op" id="7618709">{</span><span class="string" id="7618710">&#34;name&#34;</span><span class="op" id="7618716">:</span>&nbsp;<span class="string" id="7618718">&#34;foo&#34;</span><span class="op" id="7618723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7618726">tests</span>&nbsp;<span class="op" id="7618732">:=</span>&nbsp;<span class="op" id="7618735">[</span><span class="op" id="7618736">]</span><span class="ident" id="7618737">mediaTypeTest</span><span class="op" id="7618750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7618754">{</span><span class="string" id="7618755">`form-data;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="7618778">,</span>&nbsp;<span class="string" id="7618780">&#34;form-data&#34;</span><span class="op" id="7618791">,</span>&nbsp;<span class="ident" id="7618793">nameFoo</span><span class="op" id="7618800">}</span><span class="op" id="7618801">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7618805">{</span><span class="string" id="7618806">`&nbsp;form-data&nbsp;;&nbsp;name=foo`</span><span class="op" id="7618829">,</span>&nbsp;<span class="string" id="7618831">&#34;form-data&#34;</span><span class="op" id="7618842">,</span>&nbsp;<span class="ident" id="7618844">nameFoo</span><span class="op" id="7618851">}</span><span class="op" id="7618852">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7618856">{</span><span class="string" id="7618857">`FORM-DATA;name=&#34;foo&#34;`</span><span class="op" id="7618879">,</span>&nbsp;<span class="string" id="7618881">&#34;form-data&#34;</span><span class="op" id="7618892">,</span>&nbsp;<span class="ident" id="7618894">nameFoo</span><span class="op" id="7618901">}</span><span class="op" id="7618902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7618906">{</span><span class="string" id="7618907">`&nbsp;FORM-DATA&nbsp;;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="7618932">,</span>&nbsp;<span class="string" id="7618934">&#34;form-data&#34;</span><span class="op" id="7618945">,</span>&nbsp;<span class="ident" id="7618947">nameFoo</span><span class="op" id="7618954">}</span><span class="op" id="7618955">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7618959">{</span><span class="string" id="7618960">`&nbsp;FORM-DATA&nbsp;;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="7618985">,</span>&nbsp;<span class="string" id="7618987">&#34;form-data&#34;</span><span class="op" id="7618998">,</span>&nbsp;<span class="ident" id="7619000">nameFoo</span><span class="op" id="7619007">}</span><span class="op" id="7619008">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7619013">{</span><span class="string" id="7619014">`form-data;&nbsp;key=value;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="7619063">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7619068">&#34;form-data&#34;</span><span class="op" id="7619079">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7619084">m</span><span class="op" id="7619085">(</span><span class="string" id="7619086">&#34;key&#34;</span><span class="op" id="7619091">,</span>&nbsp;<span class="string" id="7619093">&#34;value&#34;</span><span class="op" id="7619100">,</span>&nbsp;<span class="string" id="7619102">&#34;blah&#34;</span><span class="op" id="7619108">,</span>&nbsp;<span class="string" id="7619110">&#34;value&#34;</span><span class="op" id="7619117">,</span>&nbsp;<span class="string" id="7619119">&#34;name&#34;</span><span class="op" id="7619125">,</span>&nbsp;<span class="string" id="7619127">&#34;foo&#34;</span><span class="op" id="7619132">)</span><span class="op" id="7619133">}</span><span class="op" id="7619134">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7619139">{</span><span class="string" id="7619140">`foo;&nbsp;key=val1;&nbsp;key=the-key-appears-again-which-is-bogus`</span><span class="op" id="7619197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7619202">&#34;&#34;</span><span class="op" id="7619204">,</span>&nbsp;<span class="ident" id="7619206">m</span><span class="op" id="7619207">(</span><span class="op" id="7619208">)</span><span class="op" id="7619209">}</span><span class="op" id="7619210">,</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7619215">//&nbsp;From&nbsp;RFC&nbsp;2231:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7619235">{</span><span class="string" id="7619236">`application/x-stuff;&nbsp;title*=us-ascii&#39;en-us&#39;This%20is%20%2A%2A%2Afun%2A%2A%2A`</span><span class="op" id="7619314">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7619319">&#34;application/x-stuff&#34;</span><span class="op" id="7619340">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7619345">m</span><span class="op" id="7619346">(</span><span class="string" id="7619347">&#34;title&#34;</span><span class="op" id="7619354">,</span>&nbsp;<span class="string" id="7619356">&#34;This&nbsp;is&nbsp;***fun***&#34;</span><span class="op" id="7619375">)</span><span class="op" id="7619376">}</span><span class="op" id="7619377">,</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7619382">{</span><span class="string" id="7619383">`message/external-body;&nbsp;access-type=URL;&nbsp;`</span>&nbsp;<span class="op" id="7619426">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7619431">`URL*0=&#34;ftp://&#34;;`</span>&nbsp;<span class="op" id="7619449">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7619454">`URL*1=&#34;cs.utk.edu/pub/moore/bulk-mailer/bulk-mailer.tar&#34;`</span><span class="op" id="7619512">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7619517">&#34;message/external-body&#34;</span><span class="op" id="7619540">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7619545">m</span><span class="op" id="7619546">(</span><span class="string" id="7619547">&#34;access-type&#34;</span><span class="op" id="7619560">,</span>&nbsp;<span class="string" id="7619562">&#34;URL&#34;</span><span class="op" id="7619567">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7619573">&#34;url&#34;</span><span class="op" id="7619578">,</span>&nbsp;<span class="string" id="7619580">&#34;ftp://cs.utk.edu/pub/moore/bulk-mailer/bulk-mailer.tar&#34;</span><span class="op" id="7619636">)</span><span class="op" id="7619637">}</span><span class="op" id="7619638">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7619643">{</span><span class="string" id="7619644">`application/x-stuff;&nbsp;`</span>&nbsp;<span class="op" id="7619668">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7619673">`title*0*=us-ascii&#39;en&#39;This%20is%20even%20more%20;&nbsp;`</span>&nbsp;<span class="op" id="7619725">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7619730">`title*1*=%2A%2A%2Afun%2A%2A%2A%20;&nbsp;`</span>&nbsp;<span class="op" id="7619768">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7619773">`title*2=&#34;isn&#39;t&nbsp;it!&#34;`</span><span class="op" id="7619794">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7619799">&#34;application/x-stuff&#34;</span><span class="op" id="7619820">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7619825">m</span><span class="op" id="7619826">(</span><span class="string" id="7619827">&#34;title&#34;</span><span class="op" id="7619834">,</span>&nbsp;<span class="string" id="7619836">&#34;This&nbsp;is&nbsp;even&nbsp;more&nbsp;***fun***&nbsp;isn&#39;t&nbsp;it!&#34;</span><span class="op" id="7619875">)</span><span class="op" id="7619876">}</span><span class="op" id="7619877">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7619882">//&nbsp;Tests&nbsp;from&nbsp;http://greenbytes.de/tech/tc2231/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7619932">//&nbsp;TODO(bradfitz):&nbsp;add&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;tests&nbsp;from&nbsp;that&nbsp;site.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7619995">{</span><span class="string" id="7619996">`attachment;&nbsp;filename=&#34;f\oo.html&#34;`</span><span class="op" id="7620030">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7620035">&#34;attachment&#34;</span><span class="op" id="7620047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7620052">m</span><span class="op" id="7620053">(</span><span class="string" id="7620054">&#34;filename&#34;</span><span class="op" id="7620064">,</span>&nbsp;<span class="string" id="7620066">&#34;foo.html&#34;</span><span class="op" id="7620076">)</span><span class="op" id="7620077">}</span><span class="op" id="7620078">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7620082">{</span><span class="string" id="7620083">`attachment;&nbsp;filename=&#34;\&#34;quoting\&#34;&nbsp;tested.html&#34;`</span><span class="op" id="7620131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7620136">&#34;attachment&#34;</span><span class="op" id="7620148">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7620153">m</span><span class="op" id="7620154">(</span><span class="string" id="7620155">&#34;filename&#34;</span><span class="op" id="7620165">,</span>&nbsp;<span class="string" id="7620167">`&#34;quoting&#34;&nbsp;tested.html`</span><span class="op" id="7620190">)</span><span class="op" id="7620191">}</span><span class="op" id="7620192">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7620196">{</span><span class="string" id="7620197">`attachment;&nbsp;filename=&#34;Here&#39;s&nbsp;a&nbsp;semicolon;.html&#34;`</span><span class="op" id="7620246">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7620251">&#34;attachment&#34;</span><span class="op" id="7620263">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7620268">m</span><span class="op" id="7620269">(</span><span class="string" id="7620270">&#34;filename&#34;</span><span class="op" id="7620280">,</span>&nbsp;<span class="string" id="7620282">&#34;Here&#39;s&nbsp;a&nbsp;semicolon;.html&#34;</span><span class="op" id="7620308">)</span><span class="op" id="7620309">}</span><span class="op" id="7620310">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7620314">{</span><span class="string" id="7620315">`attachment;&nbsp;foo=&#34;\&#34;\\&#34;;filename=&#34;foo.html&#34;`</span><span class="op" id="7620359">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7620364">&#34;attachment&#34;</span><span class="op" id="7620376">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7620381">m</span><span class="op" id="7620382">(</span><span class="string" id="7620383">&#34;foo&#34;</span><span class="op" id="7620388">,</span>&nbsp;<span class="string" id="7620390">&#34;\&#34;\\&#34;</span><span class="op" id="7620396">,</span>&nbsp;<span class="string" id="7620398">&#34;filename&#34;</span><span class="op" id="7620408">,</span>&nbsp;<span class="string" id="7620410">&#34;foo.html&#34;</span><span class="op" id="7620420">)</span><span class="op" id="7620421">}</span><span class="op" id="7620422">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7620426">{</span><span class="string" id="7620427">`attachment;&nbsp;filename=foo.html`</span><span class="op" id="7620458">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7620463">&#34;attachment&#34;</span><span class="op" id="7620475">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7620480">m</span><span class="op" id="7620481">(</span><span class="string" id="7620482">&#34;filename&#34;</span><span class="op" id="7620492">,</span>&nbsp;<span class="string" id="7620494">&#34;foo.html&#34;</span><span class="op" id="7620504">)</span><span class="op" id="7620505">}</span><span class="op" id="7620506">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7620510">{</span><span class="string" id="7620511">`attachment;&nbsp;filename=foo.html&nbsp;;`</span><span class="op" id="7620544">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7620549">&#34;attachment&#34;</span><span class="op" id="7620561">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7620566">m</span><span class="op" id="7620567">(</span><span class="string" id="7620568">&#34;filename&#34;</span><span class="op" id="7620578">,</span>&nbsp;<span class="string" id="7620580">&#34;foo.html&#34;</span><span class="op" id="7620590">)</span><span class="op" id="7620591">}</span><span class="op" id="7620592">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7620596">{</span><span class="string" id="7620597">`attachment;&nbsp;filename=&#39;foo.html&#39;`</span><span class="op" id="7620630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7620635">&#34;attachment&#34;</span><span class="op" id="7620647">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7620652">m</span><span class="op" id="7620653">(</span><span class="string" id="7620654">&#34;filename&#34;</span><span class="op" id="7620664">,</span>&nbsp;<span class="string" id="7620666">&#34;foo.html&#34;</span><span class="op" id="7620676">)</span><span class="op" id="7620677">}</span><span class="op" id="7620678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7620682">{</span><span class="string" id="7620683">`attachment;&nbsp;filename=&#34;foo-%41.html&#34;`</span><span class="op" id="7620720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7620725">&#34;attachment&#34;</span><span class="op" id="7620737">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7620742">m</span><span class="op" id="7620743">(</span><span class="string" id="7620744">&#34;filename&#34;</span><span class="op" id="7620754">,</span>&nbsp;<span class="string" id="7620756">&#34;foo-%41.html&#34;</span><span class="op" id="7620770">)</span><span class="op" id="7620771">}</span><span class="op" id="7620772">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7620776">{</span><span class="string" id="7620777">`attachment;&nbsp;filename=&#34;foo-%\41.html&#34;`</span><span class="op" id="7620815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7620820">&#34;attachment&#34;</span><span class="op" id="7620832">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7620837">m</span><span class="op" id="7620838">(</span><span class="string" id="7620839">&#34;filename&#34;</span><span class="op" id="7620849">,</span>&nbsp;<span class="string" id="7620851">&#34;foo-%41.html&#34;</span><span class="op" id="7620865">)</span><span class="op" id="7620866">}</span><span class="op" id="7620867">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7620871">{</span><span class="string" id="7620872">`filename=foo.html`</span><span class="op" id="7620891">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7620896">&#34;&#34;</span><span class="op" id="7620898">,</span>&nbsp;<span class="ident" id="7620900">m</span><span class="op" id="7620901">(</span><span class="op" id="7620902">)</span><span class="op" id="7620903">}</span><span class="op" id="7620904">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7620908">{</span><span class="string" id="7620909">`x=y;&nbsp;filename=foo.html`</span><span class="op" id="7620933">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7620938">&#34;&#34;</span><span class="op" id="7620940">,</span>&nbsp;<span class="ident" id="7620942">m</span><span class="op" id="7620943">(</span><span class="op" id="7620944">)</span><span class="op" id="7620945">}</span><span class="op" id="7620946">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7620950">{</span><span class="string" id="7620951">`&#34;foo;&nbsp;filename=bar;baz&#34;;&nbsp;filename=qux`</span><span class="op" id="7620990">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7620995">&#34;&#34;</span><span class="op" id="7620997">,</span>&nbsp;<span class="ident" id="7620999">m</span><span class="op" id="7621000">(</span><span class="op" id="7621001">)</span><span class="op" id="7621002">}</span><span class="op" id="7621003">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7621007">{</span><span class="string" id="7621008">`inline;&nbsp;attachment;&nbsp;filename=foo.html`</span><span class="op" id="7621047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7621052">&#34;&#34;</span><span class="op" id="7621054">,</span>&nbsp;<span class="ident" id="7621056">m</span><span class="op" id="7621057">(</span><span class="op" id="7621058">)</span><span class="op" id="7621059">}</span><span class="op" id="7621060">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7621064">{</span><span class="string" id="7621065">`attachment;&nbsp;filename=&#34;foo.html&#34;.txt`</span><span class="op" id="7621102">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7621107">&#34;&#34;</span><span class="op" id="7621109">,</span>&nbsp;<span class="ident" id="7621111">m</span><span class="op" id="7621112">(</span><span class="op" id="7621113">)</span><span class="op" id="7621114">}</span><span class="op" id="7621115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7621119">{</span><span class="string" id="7621120">`attachment;&nbsp;filename=&#34;bar`</span><span class="op" id="7621147">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7621152">&#34;&#34;</span><span class="op" id="7621154">,</span>&nbsp;<span class="ident" id="7621156">m</span><span class="op" id="7621157">(</span><span class="op" id="7621158">)</span><span class="op" id="7621159">}</span><span class="op" id="7621160">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7621164">{</span><span class="string" id="7621165">`attachment;&nbsp;creation-date=&#34;Wed,&nbsp;12&nbsp;Feb&nbsp;1997&nbsp;16:29:51&nbsp;-0500&#34;`</span><span class="op" id="7621226">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7621231">&#34;attachment&#34;</span><span class="op" id="7621243">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7621248">m</span><span class="op" id="7621249">(</span><span class="string" id="7621250">&#34;creation-date&#34;</span><span class="op" id="7621265">,</span>&nbsp;<span class="string" id="7621267">&#34;Wed,&nbsp;12&nbsp;Feb&nbsp;1997&nbsp;16:29:51&nbsp;-0500&#34;</span><span class="op" id="7621300">)</span><span class="op" id="7621301">}</span><span class="op" id="7621302">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7621306">{</span><span class="string" id="7621307">`foobar`</span><span class="op" id="7621315">,</span>&nbsp;<span class="string" id="7621317">&#34;foobar&#34;</span><span class="op" id="7621325">,</span>&nbsp;<span class="ident" id="7621327">m</span><span class="op" id="7621328">(</span><span class="op" id="7621329">)</span><span class="op" id="7621330">}</span><span class="op" id="7621331">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7621335">{</span><span class="string" id="7621336">`attachment;&nbsp;filename*&nbsp;=UTF-8&#39;&#39;foo-%c3%a4.html`</span><span class="op" id="7621383">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7621388">&#34;attachment&#34;</span><span class="op" id="7621400">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7621405">m</span><span class="op" id="7621406">(</span><span class="string" id="7621407">&#34;filename&#34;</span><span class="op" id="7621417">,</span>&nbsp;<span class="string" id="7621419">&#34;foo-ä.html&#34;</span><span class="op" id="7621432">)</span><span class="op" id="7621433">}</span><span class="op" id="7621434">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7621438">{</span><span class="string" id="7621439">`attachment;&nbsp;filename*=UTF-8&#39;&#39;A-%2541.html`</span><span class="op" id="7621482">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7621487">&#34;attachment&#34;</span><span class="op" id="7621499">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7621504">m</span><span class="op" id="7621505">(</span><span class="string" id="7621506">&#34;filename&#34;</span><span class="op" id="7621516">,</span>&nbsp;<span class="string" id="7621518">&#34;A-%41.html&#34;</span><span class="op" id="7621530">)</span><span class="op" id="7621531">}</span><span class="op" id="7621532">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7621536">{</span><span class="string" id="7621537">`attachment;&nbsp;filename*0=&#34;foo.&#34;;&nbsp;filename*1=&#34;html&#34;`</span><span class="op" id="7621587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7621592">&#34;attachment&#34;</span><span class="op" id="7621604">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7621609">m</span><span class="op" id="7621610">(</span><span class="string" id="7621611">&#34;filename&#34;</span><span class="op" id="7621621">,</span>&nbsp;<span class="string" id="7621623">&#34;foo.html&#34;</span><span class="op" id="7621633">)</span><span class="op" id="7621634">}</span><span class="op" id="7621635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7621639">{</span><span class="string" id="7621640">`attachment;&nbsp;filename*0*=UTF-8&#39;&#39;foo-%c3%a4;&nbsp;filename*1=&#34;.html&#34;`</span><span class="op" id="7621703">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7621708">&#34;attachment&#34;</span><span class="op" id="7621720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7621725">m</span><span class="op" id="7621726">(</span><span class="string" id="7621727">&#34;filename&#34;</span><span class="op" id="7621737">,</span>&nbsp;<span class="string" id="7621739">&#34;foo-ä.html&#34;</span><span class="op" id="7621752">)</span><span class="op" id="7621753">}</span><span class="op" id="7621754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7621758">{</span><span class="string" id="7621759">`attachment;&nbsp;filename*0=&#34;foo&#34;;&nbsp;filename*01=&#34;bar&#34;`</span><span class="op" id="7621808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7621813">&#34;attachment&#34;</span><span class="op" id="7621825">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7621830">m</span><span class="op" id="7621831">(</span><span class="string" id="7621832">&#34;filename&#34;</span><span class="op" id="7621842">,</span>&nbsp;<span class="string" id="7621844">&#34;foo&#34;</span><span class="op" id="7621849">)</span><span class="op" id="7621850">}</span><span class="op" id="7621851">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7621855">{</span><span class="string" id="7621856">`attachment;&nbsp;filename*0=&#34;foo&#34;;&nbsp;filename*2=&#34;bar&#34;`</span><span class="op" id="7621904">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7621909">&#34;attachment&#34;</span><span class="op" id="7621921">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7621926">m</span><span class="op" id="7621927">(</span><span class="string" id="7621928">&#34;filename&#34;</span><span class="op" id="7621938">,</span>&nbsp;<span class="string" id="7621940">&#34;foo&#34;</span><span class="op" id="7621945">)</span><span class="op" id="7621946">}</span><span class="op" id="7621947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7621951">{</span><span class="string" id="7621952">`attachment;&nbsp;filename*1=&#34;foo&#34;;&nbsp;filename*2=&#34;bar&#34;`</span><span class="op" id="7622000">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7622005">&#34;attachment&#34;</span><span class="op" id="7622017">,</span>&nbsp;<span class="ident" id="7622019">m</span><span class="op" id="7622020">(</span><span class="op" id="7622021">)</span><span class="op" id="7622022">}</span><span class="op" id="7622023">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7622027">{</span><span class="string" id="7622028">`attachment;&nbsp;filename*1=&#34;bar&#34;;&nbsp;filename*0=&#34;foo&#34;`</span><span class="op" id="7622076">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7622081">&#34;attachment&#34;</span><span class="op" id="7622093">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7622098">m</span><span class="op" id="7622099">(</span><span class="string" id="7622100">&#34;filename&#34;</span><span class="op" id="7622110">,</span>&nbsp;<span class="string" id="7622112">&#34;foobar&#34;</span><span class="op" id="7622120">)</span><span class="op" id="7622121">}</span><span class="op" id="7622122">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7622126">{</span><span class="string" id="7622127">`attachment;&nbsp;filename=&#34;foo-ae.html&#34;;&nbsp;filename*=UTF-8&#39;&#39;foo-%c3%a4.html`</span><span class="op" id="7622197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7622202">&#34;attachment&#34;</span><span class="op" id="7622214">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7622219">m</span><span class="op" id="7622220">(</span><span class="string" id="7622221">&#34;filename&#34;</span><span class="op" id="7622231">,</span>&nbsp;<span class="string" id="7622233">&#34;foo-ä.html&#34;</span><span class="op" id="7622246">)</span><span class="op" id="7622247">}</span><span class="op" id="7622248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7622252">{</span><span class="string" id="7622253">`attachment;&nbsp;filename*=UTF-8&#39;&#39;foo-%c3%a4.html;&nbsp;filename=&#34;foo-ae.html&#34;`</span><span class="op" id="7622323">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7622328">&#34;attachment&#34;</span><span class="op" id="7622340">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7622345">m</span><span class="op" id="7622346">(</span><span class="string" id="7622347">&#34;filename&#34;</span><span class="op" id="7622357">,</span>&nbsp;<span class="string" id="7622359">&#34;foo-ä.html&#34;</span><span class="op" id="7622372">)</span><span class="op" id="7622373">}</span><span class="op" id="7622374">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7622379">//&nbsp;Browsers&nbsp;also&nbsp;just&nbsp;send&nbsp;UTF-8&nbsp;directly&nbsp;without&nbsp;RFC&nbsp;2231,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7622441">//&nbsp;at&nbsp;least&nbsp;when&nbsp;the&nbsp;source&nbsp;page&nbsp;is&nbsp;served&nbsp;with&nbsp;UTF-8.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7622498">{</span><span class="string" id="7622499">`form-data;&nbsp;firstname=&#34;Брэд&#34;;&nbsp;lastname=&#34;Фицпатрик&#34;`</span><span class="op" id="7622563">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7622568">&#34;form-data&#34;</span><span class="op" id="7622579">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7622584">m</span><span class="op" id="7622585">(</span><span class="string" id="7622586">&#34;firstname&#34;</span><span class="op" id="7622597">,</span>&nbsp;<span class="string" id="7622599">&#34;Брэд&#34;</span><span class="op" id="7622609">,</span>&nbsp;<span class="string" id="7622611">&#34;lastname&#34;</span><span class="op" id="7622621">,</span>&nbsp;<span class="string" id="7622623">&#34;Фицпатрик&#34;</span><span class="op" id="7622643">)</span><span class="op" id="7622644">}</span><span class="op" id="7622645">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7622648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7622651">for</span>&nbsp;<span class="ident" id="7622655">_</span><span class="op" id="7622656">,</span>&nbsp;<span class="ident" id="7622658">test</span>&nbsp;<span class="op" id="7622663">:=</span>&nbsp;<span class="keyword" id="7622666">range</span>&nbsp;<span class="ident" id="7622672">tests</span>&nbsp;<span class="op" id="7622678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7622682">mt</span><span class="op" id="7622684">,</span>&nbsp;<span class="ident" id="7622686">params</span><span class="op" id="7622692">,</span>&nbsp;<span class="ident" id="7622694">err</span>&nbsp;<span class="op" id="7622698">:=</span>&nbsp;<span class="ident" id="7622701">ParseMediaType</span><span class="op" id="7622715">(</span><span class="ident" id="7622716">test</span><span class="op" id="7622720">.</span><span class="ident" id="7622721">in</span><span class="op" id="7622723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7622727">if</span>&nbsp;<span class="ident" id="7622730">err</span>&nbsp;<span class="op" id="7622734">!=</span>&nbsp;<span class="ident" id="7622737">nil</span>&nbsp;<span class="op" id="7622741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7622746">if</span>&nbsp;<span class="ident" id="7622749">test</span><span class="op" id="7622753">.</span><span class="ident" id="7622754">t</span>&nbsp;<span class="op" id="7622756">!=</span>&nbsp;<span class="string" id="7622759">&#34;&#34;</span>&nbsp;<span class="op" id="7622762">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7622768">t</span><span class="op" id="7622769">.</span><span class="ident" id="7622770">Errorf</span><span class="op" id="7622776">(</span><span class="string" id="7622777">&#34;for&nbsp;input&nbsp;%q,&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7622813">,</span>&nbsp;<span class="ident" id="7622815">test</span><span class="op" id="7622819">.</span><span class="ident" id="7622820">in</span><span class="op" id="7622822">,</span>&nbsp;<span class="ident" id="7622824">err</span><span class="op" id="7622827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7622833">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7622845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7622850">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7622861">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7622865">if</span>&nbsp;<span class="ident" id="7622868">g</span><span class="op" id="7622869">,</span>&nbsp;<span class="ident" id="7622871">e</span>&nbsp;<span class="op" id="7622873">:=</span>&nbsp;<span class="ident" id="7622876">mt</span><span class="op" id="7622878">,</span>&nbsp;<span class="ident" id="7622880">test</span><span class="op" id="7622884">.</span><span class="ident" id="7622885">t</span><span class="op" id="7622886">;</span>&nbsp;<span class="ident" id="7622888">g</span>&nbsp;<span class="op" id="7622890">!=</span>&nbsp;<span class="ident" id="7622893">e</span>&nbsp;<span class="op" id="7622895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7622900">t</span><span class="op" id="7622901">.</span><span class="ident" id="7622902">Errorf</span><span class="op" id="7622908">(</span><span class="string" id="7622909">&#34;for&nbsp;input&nbsp;%q,&nbsp;expected&nbsp;type&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7622949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7622955">test</span><span class="op" id="7622959">.</span><span class="ident" id="7622960">in</span><span class="op" id="7622962">,</span>&nbsp;<span class="ident" id="7622964">e</span><span class="op" id="7622965">,</span>&nbsp;<span class="ident" id="7622967">g</span><span class="op" id="7622968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7622973">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7622984">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7622988">if</span>&nbsp;<span class="builtinfunc" id="7622991">len</span><span class="op" id="7622994">(</span><span class="ident" id="7622995">params</span><span class="op" id="7623001">)</span>&nbsp;<span class="op" id="7623003">==</span>&nbsp;<span class="num" id="7623006">0</span>&nbsp;<span class="op" id="7623008">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="7623011">len</span><span class="op" id="7623014">(</span><span class="ident" id="7623015">test</span><span class="op" id="7623019">.</span><span class="ident" id="7623020">p</span><span class="op" id="7623021">)</span>&nbsp;<span class="op" id="7623023">==</span>&nbsp;<span class="num" id="7623026">0</span>&nbsp;<span class="op" id="7623028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7623033">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7623044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7623048">if</span>&nbsp;<span class="op" id="7623051">!</span><span class="ident" id="7623052">reflect</span><span class="op" id="7623059">.</span><span class="ident" id="7623060">DeepEqual</span><span class="op" id="7623069">(</span><span class="ident" id="7623070">params</span><span class="op" id="7623076">,</span>&nbsp;<span class="ident" id="7623078">test</span><span class="op" id="7623082">.</span><span class="ident" id="7623083">p</span><span class="op" id="7623084">)</span>&nbsp;<span class="op" id="7623086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7623091">t</span><span class="op" id="7623092">.</span><span class="ident" id="7623093">Errorf</span><span class="op" id="7623099">(</span><span class="string" id="7623100">&#34;for&nbsp;input&nbsp;%q,&nbsp;wrong&nbsp;params.\n&#34;</span><span class="op" id="7623131">+</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7623137">&#34;expected:&nbsp;%#v\n&#34;</span><span class="op" id="7623154">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7623160">&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;got:&nbsp;%#v&#34;</span><span class="op" id="7623175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7623181">test</span><span class="op" id="7623185">.</span><span class="ident" id="7623186">in</span><span class="op" id="7623188">,</span>&nbsp;<span class="ident" id="7623190">test</span><span class="op" id="7623194">.</span><span class="ident" id="7623195">p</span><span class="op" id="7623196">,</span>&nbsp;<span class="ident" id="7623198">params</span><span class="op" id="7623204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7623208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7623211">}</span><br>
<span class="lineno">245</span><span class="op" id="7623213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7623216">type</span>&nbsp;<span class="ident" id="7623221">badMediaTypeTest</span>&nbsp;<span class="keyword" id="7623238">struct</span>&nbsp;<span class="op" id="7623245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7623248">in</span>&nbsp;&nbsp;<span class="builtintype" id="7623252">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7623260">err</span>&nbsp;<span class="builtintype" id="7623264">string</span><br>
<span class="lineno">250</span><span class="op" id="7623271">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7623274">var</span>&nbsp;<span class="ident" id="7623278">badMediaTypeTests</span>&nbsp;<span class="op" id="7623296">=</span>&nbsp;<span class="op" id="7623298">[</span><span class="op" id="7623299">]</span><span class="ident" id="7623300">badMediaTypeTest</span><span class="op" id="7623316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7623319">{</span><span class="string" id="7623320">&#34;bogus&nbsp;;=========&#34;</span><span class="op" id="7623338">,</span>&nbsp;<span class="string" id="7623340">&#34;mime:&nbsp;invalid&nbsp;media&nbsp;parameter&#34;</span><span class="op" id="7623371">}</span><span class="op" id="7623372">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7623375">{</span><span class="string" id="7623376">&#34;bogus/&lt;script&gt;alert&lt;/script&gt;&#34;</span><span class="op" id="7623406">,</span>&nbsp;<span class="string" id="7623408">&#34;mime:&nbsp;expected&nbsp;token&nbsp;after&nbsp;slash&#34;</span><span class="op" id="7623442">}</span><span class="op" id="7623443">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7623446">{</span><span class="string" id="7623447">&#34;bogus/bogus&lt;script&gt;alert&lt;/script&gt;&#34;</span><span class="op" id="7623482">,</span>&nbsp;<span class="string" id="7623484">&#34;mime:&nbsp;unexpected&nbsp;content&nbsp;after&nbsp;media&nbsp;subtype&#34;</span><span class="op" id="7623530">}</span><span class="op" id="7623531">,</span><br>
<span class="lineno"></span><span class="op" id="7623533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7623536">func</span>&nbsp;<span class="ident" id="7623541">TestParseMediaTypeBogus</span><span class="op" id="7623564">(</span><span class="ident" id="7623565">t</span>&nbsp;<span class="op" id="7623567">*</span><span class="ident" id="7623568">testing</span><span class="op" id="7623575">.</span><span class="ident" id="7623576">T</span><span class="op" id="7623577">)</span>&nbsp;<span class="op" id="7623579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7623582">for</span>&nbsp;<span class="ident" id="7623586">_</span><span class="op" id="7623587">,</span>&nbsp;<span class="ident" id="7623589">tt</span>&nbsp;<span class="op" id="7623592">:=</span>&nbsp;<span class="keyword" id="7623595">range</span>&nbsp;<span class="ident" id="7623601">badMediaTypeTests</span>&nbsp;<span class="op" id="7623619">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7623623">mt</span><span class="op" id="7623625">,</span>&nbsp;<span class="ident" id="7623627">params</span><span class="op" id="7623633">,</span>&nbsp;<span class="ident" id="7623635">err</span>&nbsp;<span class="op" id="7623639">:=</span>&nbsp;<span class="ident" id="7623642">ParseMediaType</span><span class="op" id="7623656">(</span><span class="ident" id="7623657">tt</span><span class="op" id="7623659">.</span><span class="ident" id="7623660">in</span><span class="op" id="7623662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7623666">if</span>&nbsp;<span class="ident" id="7623669">err</span>&nbsp;<span class="op" id="7623673">==</span>&nbsp;<span class="ident" id="7623676">nil</span>&nbsp;<span class="op" id="7623680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7623685">t</span><span class="op" id="7623686">.</span><span class="ident" id="7623687">Errorf</span><span class="op" id="7623693">(</span><span class="string" id="7623694">&#34;ParseMediaType(%q)&nbsp;=&nbsp;nil&nbsp;error;&nbsp;want&nbsp;parse&nbsp;error&#34;</span><span class="op" id="7623744">,</span>&nbsp;<span class="ident" id="7623746">tt</span><span class="op" id="7623748">.</span><span class="ident" id="7623749">in</span><span class="op" id="7623751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7623756">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7623767">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7623771">if</span>&nbsp;<span class="ident" id="7623774">err</span><span class="op" id="7623777">.</span><span class="ident" id="7623778">Error</span><span class="op" id="7623783">(</span><span class="op" id="7623784">)</span>&nbsp;<span class="op" id="7623786">!=</span>&nbsp;<span class="ident" id="7623789">tt</span><span class="op" id="7623791">.</span><span class="ident" id="7623792">err</span>&nbsp;<span class="op" id="7623796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7623801">t</span><span class="op" id="7623802">.</span><span class="ident" id="7623803">Errorf</span><span class="op" id="7623809">(</span><span class="string" id="7623810">&#34;ParseMediaType(%q)&nbsp;=&nbsp;err&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7623848">,</span>&nbsp;<span class="ident" id="7623850">tt</span><span class="op" id="7623852">.</span><span class="ident" id="7623853">in</span><span class="op" id="7623855">,</span>&nbsp;<span class="ident" id="7623857">err</span><span class="op" id="7623860">.</span><span class="ident" id="7623861">Error</span><span class="op" id="7623866">(</span><span class="op" id="7623867">)</span><span class="op" id="7623868">,</span>&nbsp;<span class="ident" id="7623870">tt</span><span class="op" id="7623872">.</span><span class="ident" id="7623873">err</span><span class="op" id="7623876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7623880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7623884">if</span>&nbsp;<span class="ident" id="7623887">params</span>&nbsp;<span class="op" id="7623894">!=</span>&nbsp;<span class="ident" id="7623897">nil</span>&nbsp;<span class="op" id="7623901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7623906">t</span><span class="op" id="7623907">.</span><span class="ident" id="7623908">Errorf</span><span class="op" id="7623914">(</span><span class="string" id="7623915">&#34;ParseMediaType(%q):&nbsp;got&nbsp;non-nil&nbsp;params&nbsp;on&nbsp;error&#34;</span><span class="op" id="7623964">,</span>&nbsp;<span class="ident" id="7623966">tt</span><span class="op" id="7623968">.</span><span class="ident" id="7623969">in</span><span class="op" id="7623971">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7623975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7623979">if</span>&nbsp;<span class="ident" id="7623982">mt</span>&nbsp;<span class="op" id="7623985">!=</span>&nbsp;<span class="string" id="7623988">&#34;&#34;</span>&nbsp;<span class="op" id="7623991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7623996">t</span><span class="op" id="7623997">.</span><span class="ident" id="7623998">Errorf</span><span class="op" id="7624004">(</span><span class="string" id="7624005">&#34;ParseMediaType(%q):&nbsp;got&nbsp;non-empty&nbsp;media&nbsp;type&nbsp;string&nbsp;on&nbsp;error&#34;</span><span class="op" id="7624067">,</span>&nbsp;<span class="ident" id="7624069">tt</span><span class="op" id="7624071">.</span><span class="ident" id="7624072">in</span><span class="op" id="7624074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7624078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7624081">}</span><br>
<span class="lineno">275</span><span class="op" id="7624083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7624086">type</span>&nbsp;<span class="ident" id="7624091">formatTest</span>&nbsp;<span class="keyword" id="7624102">struct</span>&nbsp;<span class="op" id="7624109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7624112">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7624119">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7624127">params</span>&nbsp;<span class="keyword" id="7624134">map</span><span class="op" id="7624137">[</span><span class="builtintype" id="7624138">string</span><span class="op" id="7624144">]</span><span class="builtintype" id="7624145">string</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7624153">want</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7624160">string</span><br>
<span class="lineno"></span><span class="op" id="7624167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7624170">var</span>&nbsp;<span class="ident" id="7624174">formatTests</span>&nbsp;<span class="op" id="7624186">=</span>&nbsp;<span class="op" id="7624188">[</span><span class="op" id="7624189">]</span><span class="ident" id="7624190">formatTest</span><span class="op" id="7624200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7624203">{</span><span class="string" id="7624204">&#34;noslash&#34;</span><span class="op" id="7624213">,</span>&nbsp;<span class="ident" id="7624215">nil</span><span class="op" id="7624218">,</span>&nbsp;<span class="string" id="7624220">&#34;&#34;</span><span class="op" id="7624222">}</span><span class="op" id="7624223">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7624226">{</span><span class="string" id="7624227">&#34;foo&nbsp;bar/baz&#34;</span><span class="op" id="7624240">,</span>&nbsp;<span class="ident" id="7624242">nil</span><span class="op" id="7624245">,</span>&nbsp;<span class="string" id="7624247">&#34;&#34;</span><span class="op" id="7624249">}</span><span class="op" id="7624250">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7624253">{</span><span class="string" id="7624254">&#34;foo/bar&nbsp;baz&#34;</span><span class="op" id="7624267">,</span>&nbsp;<span class="ident" id="7624269">nil</span><span class="op" id="7624272">,</span>&nbsp;<span class="string" id="7624274">&#34;&#34;</span><span class="op" id="7624276">}</span><span class="op" id="7624277">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7624280">{</span><span class="string" id="7624281">&#34;foo/BAR&#34;</span><span class="op" id="7624290">,</span>&nbsp;<span class="ident" id="7624292">nil</span><span class="op" id="7624295">,</span>&nbsp;<span class="string" id="7624297">&#34;foo/bar&#34;</span><span class="op" id="7624306">}</span><span class="op" id="7624307">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7624310">{</span><span class="string" id="7624311">&#34;foo/BAR&#34;</span><span class="op" id="7624320">,</span>&nbsp;<span class="keyword" id="7624322">map</span><span class="op" id="7624325">[</span><span class="builtintype" id="7624326">string</span><span class="op" id="7624332">]</span><span class="builtintype" id="7624333">string</span><span class="op" id="7624339">{</span><span class="string" id="7624340">&#34;X&#34;</span><span class="op" id="7624343">:</span>&nbsp;<span class="string" id="7624345">&#34;Y&#34;</span><span class="op" id="7624348">}</span><span class="op" id="7624349">,</span>&nbsp;<span class="string" id="7624351">&#34;foo/bar;&nbsp;x=Y&#34;</span><span class="op" id="7624365">}</span><span class="op" id="7624366">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7624369">{</span><span class="string" id="7624370">&#34;foo/BAR&#34;</span><span class="op" id="7624379">,</span>&nbsp;<span class="keyword" id="7624381">map</span><span class="op" id="7624384">[</span><span class="builtintype" id="7624385">string</span><span class="op" id="7624391">]</span><span class="builtintype" id="7624392">string</span><span class="op" id="7624398">{</span><span class="string" id="7624399">&#34;space&#34;</span><span class="op" id="7624406">:</span>&nbsp;<span class="string" id="7624408">&#34;With&nbsp;space&#34;</span><span class="op" id="7624420">}</span><span class="op" id="7624421">,</span>&nbsp;<span class="string" id="7624423">`foo/bar;&nbsp;space=&#34;With&nbsp;space&#34;`</span><span class="op" id="7624452">}</span><span class="op" id="7624453">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7624456">{</span><span class="string" id="7624457">&#34;foo/BAR&#34;</span><span class="op" id="7624466">,</span>&nbsp;<span class="keyword" id="7624468">map</span><span class="op" id="7624471">[</span><span class="builtintype" id="7624472">string</span><span class="op" id="7624478">]</span><span class="builtintype" id="7624479">string</span><span class="op" id="7624485">{</span><span class="string" id="7624486">&#34;quote&#34;</span><span class="op" id="7624493">:</span>&nbsp;<span class="string" id="7624495">`With&nbsp;&#34;quote`</span><span class="op" id="7624508">}</span><span class="op" id="7624509">,</span>&nbsp;<span class="string" id="7624511">`foo/bar;&nbsp;quote=&#34;With&nbsp;\&#34;quote&#34;`</span><span class="op" id="7624542">}</span><span class="op" id="7624543">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7624546">{</span><span class="string" id="7624547">&#34;foo/BAR&#34;</span><span class="op" id="7624556">,</span>&nbsp;<span class="keyword" id="7624558">map</span><span class="op" id="7624561">[</span><span class="builtintype" id="7624562">string</span><span class="op" id="7624568">]</span><span class="builtintype" id="7624569">string</span><span class="op" id="7624575">{</span><span class="string" id="7624576">&#34;bslash&#34;</span><span class="op" id="7624584">:</span>&nbsp;<span class="string" id="7624586">`With&nbsp;\backslash`</span><span class="op" id="7624603">}</span><span class="op" id="7624604">,</span>&nbsp;<span class="string" id="7624606">`foo/bar;&nbsp;bslash=&#34;With&nbsp;\\backslash&#34;`</span><span class="op" id="7624642">}</span><span class="op" id="7624643">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7624646">{</span><span class="string" id="7624647">&#34;foo/BAR&#34;</span><span class="op" id="7624656">,</span>&nbsp;<span class="keyword" id="7624658">map</span><span class="op" id="7624661">[</span><span class="builtintype" id="7624662">string</span><span class="op" id="7624668">]</span><span class="builtintype" id="7624669">string</span><span class="op" id="7624675">{</span><span class="string" id="7624676">&#34;both&#34;</span><span class="op" id="7624682">:</span>&nbsp;<span class="string" id="7624684">`With&nbsp;\backslash&nbsp;and&nbsp;&#34;quote`</span><span class="op" id="7624712">}</span><span class="op" id="7624713">,</span>&nbsp;<span class="string" id="7624715">`foo/bar;&nbsp;both=&#34;With&nbsp;\\backslash&nbsp;and&nbsp;\&#34;quote&#34;`</span><span class="op" id="7624761">}</span><span class="op" id="7624762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7624765">{</span><span class="string" id="7624766">&#34;foo/BAR&#34;</span><span class="op" id="7624775">,</span>&nbsp;<span class="keyword" id="7624777">map</span><span class="op" id="7624780">[</span><span class="builtintype" id="7624781">string</span><span class="op" id="7624787">]</span><span class="builtintype" id="7624788">string</span><span class="op" id="7624794">{</span><span class="string" id="7624795">&#34;&#34;</span><span class="op" id="7624797">:</span>&nbsp;<span class="string" id="7624799">&#34;empty&nbsp;attribute&#34;</span><span class="op" id="7624816">}</span><span class="op" id="7624817">,</span>&nbsp;<span class="string" id="7624819">&#34;&#34;</span><span class="op" id="7624821">}</span><span class="op" id="7624822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7624825">{</span><span class="string" id="7624826">&#34;foo/BAR&#34;</span><span class="op" id="7624835">,</span>&nbsp;<span class="keyword" id="7624837">map</span><span class="op" id="7624840">[</span><span class="builtintype" id="7624841">string</span><span class="op" id="7624847">]</span><span class="builtintype" id="7624848">string</span><span class="op" id="7624854">{</span><span class="string" id="7624855">&#34;bad&nbsp;attribute&#34;</span><span class="op" id="7624870">:</span>&nbsp;<span class="string" id="7624872">&#34;baz&#34;</span><span class="op" id="7624877">}</span><span class="op" id="7624878">,</span>&nbsp;<span class="string" id="7624880">&#34;&#34;</span><span class="op" id="7624882">}</span><span class="op" id="7624883">,</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7624886">{</span><span class="string" id="7624887">&#34;foo/BAR&#34;</span><span class="op" id="7624896">,</span>&nbsp;<span class="keyword" id="7624898">map</span><span class="op" id="7624901">[</span><span class="builtintype" id="7624902">string</span><span class="op" id="7624908">]</span><span class="builtintype" id="7624909">string</span><span class="op" id="7624915">{</span><span class="string" id="7624916">&#34;nonascii&#34;</span><span class="op" id="7624926">:</span>&nbsp;<span class="string" id="7624928">&#34;not&nbsp;an&nbsp;ascii&nbsp;character:&nbsp;ä&#34;</span><span class="op" id="7624956">}</span><span class="op" id="7624957">,</span>&nbsp;<span class="string" id="7624959">&#34;&#34;</span><span class="op" id="7624961">}</span><span class="op" id="7624962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7624965">{</span><span class="string" id="7624966">&#34;foo/bar&#34;</span><span class="op" id="7624975">,</span>&nbsp;<span class="keyword" id="7624977">map</span><span class="op" id="7624980">[</span><span class="builtintype" id="7624981">string</span><span class="op" id="7624987">]</span><span class="builtintype" id="7624988">string</span><span class="op" id="7624994">{</span><span class="string" id="7624995">&#34;a&#34;</span><span class="op" id="7624998">:</span>&nbsp;<span class="string" id="7625000">&#34;av&#34;</span><span class="op" id="7625004">,</span>&nbsp;<span class="string" id="7625006">&#34;b&#34;</span><span class="op" id="7625009">:</span>&nbsp;<span class="string" id="7625011">&#34;bv&#34;</span><span class="op" id="7625015">,</span>&nbsp;<span class="string" id="7625017">&#34;c&#34;</span><span class="op" id="7625020">:</span>&nbsp;<span class="string" id="7625022">&#34;cv&#34;</span><span class="op" id="7625026">}</span><span class="op" id="7625027">,</span>&nbsp;<span class="string" id="7625029">&#34;foo/bar;&nbsp;a=av;&nbsp;b=bv;&nbsp;c=cv&#34;</span><span class="op" id="7625056">}</span><span class="op" id="7625057">,</span><br>
<span class="lineno"></span><span class="op" id="7625059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7625062">func</span>&nbsp;<span class="ident" id="7625067">TestFormatMediaType</span><span class="op" id="7625086">(</span><span class="ident" id="7625087">t</span>&nbsp;<span class="op" id="7625089">*</span><span class="ident" id="7625090">testing</span><span class="op" id="7625097">.</span><span class="ident" id="7625098">T</span><span class="op" id="7625099">)</span>&nbsp;<span class="op" id="7625101">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7625104">for</span>&nbsp;<span class="ident" id="7625108">i</span><span class="op" id="7625109">,</span>&nbsp;<span class="ident" id="7625111">tt</span>&nbsp;<span class="op" id="7625114">:=</span>&nbsp;<span class="keyword" id="7625117">range</span>&nbsp;<span class="ident" id="7625123">formatTests</span>&nbsp;<span class="op" id="7625135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7625139">got</span>&nbsp;<span class="op" id="7625143">:=</span>&nbsp;<span class="ident" id="7625146">FormatMediaType</span><span class="op" id="7625161">(</span><span class="ident" id="7625162">tt</span><span class="op" id="7625164">.</span><span class="ident" id="7625165">typ</span><span class="op" id="7625168">,</span>&nbsp;<span class="ident" id="7625170">tt</span><span class="op" id="7625172">.</span><span class="ident" id="7625173">params</span><span class="op" id="7625179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7625183">if</span>&nbsp;<span class="ident" id="7625186">got</span>&nbsp;<span class="op" id="7625190">!=</span>&nbsp;<span class="ident" id="7625193">tt</span><span class="op" id="7625195">.</span><span class="ident" id="7625196">want</span>&nbsp;<span class="op" id="7625201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7625206">t</span><span class="op" id="7625207">.</span><span class="ident" id="7625208">Errorf</span><span class="op" id="7625214">(</span><span class="string" id="7625215">&#34;%d.&nbsp;FormatMediaType(%q,&nbsp;%v)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7625258">,</span>&nbsp;<span class="ident" id="7625260">i</span><span class="op" id="7625261">,</span>&nbsp;<span class="ident" id="7625263">tt</span><span class="op" id="7625265">.</span><span class="ident" id="7625266">typ</span><span class="op" id="7625269">,</span>&nbsp;<span class="ident" id="7625271">tt</span><span class="op" id="7625273">.</span><span class="ident" id="7625274">params</span><span class="op" id="7625280">,</span>&nbsp;<span class="ident" id="7625282">got</span><span class="op" id="7625285">,</span>&nbsp;<span class="ident" id="7625287">tt</span><span class="op" id="7625289">.</span><span class="ident" id="7625290">want</span><span class="op" id="7625294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7625298">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7625301">}</span><br>
<span class="lineno"></span><span class="op" id="7625303">}</span>
</div>
</body>
</html>
