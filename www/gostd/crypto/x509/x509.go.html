<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html" class="current">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4379487">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4379542">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4379596">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4379647">//&nbsp;Package&nbsp;x509&nbsp;parses&nbsp;X.509-encoded&nbsp;keys&nbsp;and&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="keyword" id="4379707">package</span>&nbsp;<span class="ident" id="4379715">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4379721">import</span>&nbsp;<span class="op" id="4379728">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4379731">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4379740">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4379750">&#34;crypto/dsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4379764">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4379780">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4379799">&#34;crypto/rsa&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4379813">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4379828">_</span>&nbsp;<span class="string" id="4379830">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4379847">_</span>&nbsp;<span class="string" id="4379849">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4379866">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4379886">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4379903">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4379919">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4379929">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4379935">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4379947">&#34;net&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4379954">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4379965">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4379972">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4379975">//&nbsp;pkixPublicKey&nbsp;reflects&nbsp;a&nbsp;PKIX&nbsp;public&nbsp;key&nbsp;structure.&nbsp;See&nbsp;SubjectPublicKeyInfo</span><br>
<span class="lineno">30</span><span class="comment" id="4380055">//&nbsp;in&nbsp;RFC&nbsp;3280.</span><br>
<span class="lineno"></span><span class="keyword" id="4380071">type</span>&nbsp;<span class="ident" id="4380076">pkixPublicKey</span>&nbsp;<span class="keyword" id="4380090">struct</span>&nbsp;<span class="op" id="4380097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4380100">Algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4380110">pkix</span><span class="op" id="4380114">.</span><span class="ident" id="4380115">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4380136">BitString</span>&nbsp;<span class="ident" id="4380146">asn1</span><span class="op" id="4380150">.</span><span class="ident" id="4380151">BitString</span><br>
<span class="lineno"></span><span class="op" id="4380161">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4380164">//&nbsp;ParsePKIXPublicKey&nbsp;parses&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;public&nbsp;key.&nbsp;These&nbsp;values&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4380236">//&nbsp;typically&nbsp;found&nbsp;in&nbsp;PEM&nbsp;blocks&nbsp;with&nbsp;&#34;BEGIN&nbsp;PUBLIC&nbsp;KEY&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="4380294">func</span>&nbsp;<span class="ident" id="4380299">ParsePKIXPublicKey</span><span class="op" id="4380317">(</span><span class="ident" id="4380318">derBytes</span>&nbsp;<span class="op" id="4380327">[</span><span class="op" id="4380328">]</span><span class="builtintype" id="4380329">byte</span><span class="op" id="4380333">)</span>&nbsp;<span class="op" id="4380335">(</span><span class="ident" id="4380336">pub</span>&nbsp;<span class="keyword" id="4380340">interface</span><span class="op" id="4380349">{</span><span class="op" id="4380350">}</span><span class="op" id="4380351">,</span>&nbsp;<span class="ident" id="4380353">err</span>&nbsp;<span class="builtintype" id="4380357">error</span><span class="op" id="4380362">)</span>&nbsp;<span class="op" id="4380364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4380367">var</span>&nbsp;<span class="ident" id="4380371">pki</span>&nbsp;<span class="ident" id="4380375">publicKeyInfo</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4380390">if</span>&nbsp;<span class="ident" id="4380393">_</span><span class="op" id="4380394">,</span>&nbsp;<span class="ident" id="4380396">err</span>&nbsp;<span class="op" id="4380400">=</span>&nbsp;<span class="ident" id="4380402">asn1</span><span class="op" id="4380406">.</span><span class="ident" id="4380407">Unmarshal</span><span class="op" id="4380416">(</span><span class="ident" id="4380417">derBytes</span><span class="op" id="4380425">,</span>&nbsp;<span class="op" id="4380427">&amp;</span><span class="ident" id="4380428">pki</span><span class="op" id="4380431">)</span><span class="op" id="4380432">;</span>&nbsp;<span class="ident" id="4380434">err</span>&nbsp;<span class="op" id="4380438">!=</span>&nbsp;<span class="builtintype" id="4380441">nil</span>&nbsp;<span class="op" id="4380445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4380449">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4380457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4380460">algo</span>&nbsp;<span class="op" id="4380465">:=</span>&nbsp;<span class="ident" id="4380468">getPublicKeyAlgorithmFromOID</span><span class="op" id="4380496">(</span><span class="ident" id="4380497">pki</span><span class="op" id="4380500">.</span><span class="ident" id="4380501">Algorithm</span><span class="op" id="4380510">.</span><span class="ident" id="4380511">Algorithm</span><span class="op" id="4380520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4380523">if</span>&nbsp;<span class="ident" id="4380526">algo</span>&nbsp;<span class="op" id="4380531">==</span>&nbsp;<span class="ident" id="4380534">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="op" id="4380560">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4380564">return</span>&nbsp;<span class="builtintype" id="4380571">nil</span><span class="op" id="4380574">,</span>&nbsp;<span class="ident" id="4380576">errors</span><span class="op" id="4380582">.</span><span class="ident" id="4380583">New</span><span class="op" id="4380586">(</span><span class="string" id="4380587">&#34;x509:&nbsp;unknown&nbsp;public&nbsp;key&nbsp;algorithm&#34;</span><span class="op" id="4380623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4380626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4380629">return</span>&nbsp;<span class="ident" id="4380636">parsePublicKey</span><span class="op" id="4380650">(</span><span class="ident" id="4380651">algo</span><span class="op" id="4380655">,</span>&nbsp;<span class="op" id="4380657">&amp;</span><span class="ident" id="4380658">pki</span><span class="op" id="4380661">)</span><br>
<span class="lineno"></span><span class="op" id="4380663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="4380666">func</span>&nbsp;<span class="ident" id="4380671">marshalPublicKey</span><span class="op" id="4380687">(</span><span class="ident" id="4380688">pub</span>&nbsp;<span class="keyword" id="4380692">interface</span><span class="op" id="4380701">{</span><span class="op" id="4380702">}</span><span class="op" id="4380703">)</span>&nbsp;<span class="op" id="4380705">(</span><span class="ident" id="4380706">publicKeyBytes</span>&nbsp;<span class="op" id="4380721">[</span><span class="op" id="4380722">]</span><span class="builtintype" id="4380723">byte</span><span class="op" id="4380727">,</span>&nbsp;<span class="ident" id="4380729">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4380748">pkix</span><span class="op" id="4380752">.</span><span class="ident" id="4380753">AlgorithmIdentifier</span><span class="op" id="4380772">,</span>&nbsp;<span class="ident" id="4380774">err</span>&nbsp;<span class="builtintype" id="4380778">error</span><span class="op" id="4380783">)</span>&nbsp;<span class="op" id="4380785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4380788">switch</span>&nbsp;<span class="ident" id="4380795">pub</span>&nbsp;<span class="op" id="4380799">:=</span>&nbsp;<span class="ident" id="4380802">pub</span><span class="op" id="4380805">.</span><span class="op" id="4380806">(</span><span class="keyword" id="4380807">type</span><span class="op" id="4380811">)</span>&nbsp;<span class="op" id="4380813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4380816">case</span>&nbsp;<span class="op" id="4380821">*</span><span class="ident" id="4380822">rsa</span><span class="op" id="4380825">.</span><span class="ident" id="4380826">PublicKey</span><span class="op" id="4380835">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4380839">publicKeyBytes</span><span class="op" id="4380853">,</span>&nbsp;<span class="ident" id="4380855">err</span>&nbsp;<span class="op" id="4380859">=</span>&nbsp;<span class="ident" id="4380861">asn1</span><span class="op" id="4380865">.</span><span class="ident" id="4380866">Marshal</span><span class="op" id="4380873">(</span><span class="ident" id="4380874">rsaPublicKey</span><span class="op" id="4380886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4380891">N</span><span class="op" id="4380892">:</span>&nbsp;<span class="ident" id="4380894">pub</span><span class="op" id="4380897">.</span><span class="ident" id="4380898">N</span><span class="op" id="4380899">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4380904">E</span><span class="op" id="4380905">:</span>&nbsp;<span class="ident" id="4380907">pub</span><span class="op" id="4380910">.</span><span class="ident" id="4380911">E</span><span class="op" id="4380912">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4380916">}</span><span class="op" id="4380917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4380921">publicKeyAlgorithm</span><span class="op" id="4380939">.</span><span class="ident" id="4380940">Algorithm</span>&nbsp;<span class="op" id="4380950">=</span>&nbsp;<span class="ident" id="4380952">oidPublicKeyRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4380970">//&nbsp;This&nbsp;is&nbsp;a&nbsp;NULL&nbsp;parameters&nbsp;value&nbsp;which&nbsp;is&nbsp;technically</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4381028">//&nbsp;superfluous,&nbsp;but&nbsp;most&nbsp;other&nbsp;code&nbsp;includes&nbsp;it&nbsp;and,&nbsp;by</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4381086">//&nbsp;doing&nbsp;this,&nbsp;we&nbsp;match&nbsp;their&nbsp;public&nbsp;key&nbsp;hashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4381137">publicKeyAlgorithm</span><span class="op" id="4381155">.</span><span class="ident" id="4381156">Parameters</span>&nbsp;<span class="op" id="4381167">=</span>&nbsp;<span class="ident" id="4381169">asn1</span><span class="op" id="4381173">.</span><span class="ident" id="4381174">RawValue</span><span class="op" id="4381182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4381187">Tag</span><span class="op" id="4381190">:</span>&nbsp;<span class="num" id="4381192">5</span><span class="op" id="4381193">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4381197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4381200">case</span>&nbsp;<span class="op" id="4381205">*</span><span class="ident" id="4381206">ecdsa</span><span class="op" id="4381211">.</span><span class="ident" id="4381212">PublicKey</span><span class="op" id="4381221">:</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4381225">publicKeyBytes</span>&nbsp;<span class="op" id="4381240">=</span>&nbsp;<span class="ident" id="4381242">elliptic</span><span class="op" id="4381250">.</span><span class="ident" id="4381251">Marshal</span><span class="op" id="4381258">(</span><span class="ident" id="4381259">pub</span><span class="op" id="4381262">.</span><span class="ident" id="4381263">Curve</span><span class="op" id="4381268">,</span>&nbsp;<span class="ident" id="4381270">pub</span><span class="op" id="4381273">.</span><span class="ident" id="4381274">X</span><span class="op" id="4381275">,</span>&nbsp;<span class="ident" id="4381277">pub</span><span class="op" id="4381280">.</span><span class="ident" id="4381281">Y</span><span class="op" id="4381282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4381286">oid</span><span class="op" id="4381289">,</span>&nbsp;<span class="ident" id="4381291">ok</span>&nbsp;<span class="op" id="4381294">:=</span>&nbsp;<span class="ident" id="4381297">oidFromNamedCurve</span><span class="op" id="4381314">(</span><span class="ident" id="4381315">pub</span><span class="op" id="4381318">.</span><span class="ident" id="4381319">Curve</span><span class="op" id="4381324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4381328">if</span>&nbsp;<span class="op" id="4381331">!</span><span class="ident" id="4381332">ok</span>&nbsp;<span class="op" id="4381335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4381340">return</span>&nbsp;<span class="builtintype" id="4381347">nil</span><span class="op" id="4381350">,</span>&nbsp;<span class="ident" id="4381352">pkix</span><span class="op" id="4381356">.</span><span class="ident" id="4381357">AlgorithmIdentifier</span><span class="op" id="4381376">{</span><span class="op" id="4381377">}</span><span class="op" id="4381378">,</span>&nbsp;<span class="ident" id="4381380">errors</span><span class="op" id="4381386">.</span><span class="ident" id="4381387">New</span><span class="op" id="4381390">(</span><span class="string" id="4381391">&#34;x509:&nbsp;unsupported&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4381425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4381429">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4381433">publicKeyAlgorithm</span><span class="op" id="4381451">.</span><span class="ident" id="4381452">Algorithm</span>&nbsp;<span class="op" id="4381462">=</span>&nbsp;<span class="ident" id="4381464">oidPublicKeyECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4381484">var</span>&nbsp;<span class="ident" id="4381488">paramBytes</span>&nbsp;<span class="op" id="4381499">[</span><span class="op" id="4381500">]</span><span class="builtintype" id="4381501">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4381508">paramBytes</span><span class="op" id="4381518">,</span>&nbsp;<span class="ident" id="4381520">err</span>&nbsp;<span class="op" id="4381524">=</span>&nbsp;<span class="ident" id="4381526">asn1</span><span class="op" id="4381530">.</span><span class="ident" id="4381531">Marshal</span><span class="op" id="4381538">(</span><span class="ident" id="4381539">oid</span><span class="op" id="4381542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4381546">if</span>&nbsp;<span class="ident" id="4381549">err</span>&nbsp;<span class="op" id="4381553">!=</span>&nbsp;<span class="builtintype" id="4381556">nil</span>&nbsp;<span class="op" id="4381560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4381565">return</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4381574">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4381578">publicKeyAlgorithm</span><span class="op" id="4381596">.</span><span class="ident" id="4381597">Parameters</span><span class="op" id="4381607">.</span><span class="ident" id="4381608">FullBytes</span>&nbsp;<span class="op" id="4381618">=</span>&nbsp;<span class="ident" id="4381620">paramBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4381632">default</span><span class="op" id="4381639">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4381643">return</span>&nbsp;<span class="builtintype" id="4381650">nil</span><span class="op" id="4381653">,</span>&nbsp;<span class="ident" id="4381655">pkix</span><span class="op" id="4381659">.</span><span class="ident" id="4381660">AlgorithmIdentifier</span><span class="op" id="4381679">{</span><span class="op" id="4381680">}</span><span class="op" id="4381681">,</span>&nbsp;<span class="ident" id="4381683">errors</span><span class="op" id="4381689">.</span><span class="ident" id="4381690">New</span><span class="op" id="4381693">(</span><span class="string" id="4381694">&#34;x509:&nbsp;only&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;public&nbsp;keys&nbsp;supported&#34;</span><span class="op" id="4381742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4381745">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4381749">return</span>&nbsp;<span class="ident" id="4381756">publicKeyBytes</span><span class="op" id="4381770">,</span>&nbsp;<span class="ident" id="4381772">publicKeyAlgorithm</span><span class="op" id="4381790">,</span>&nbsp;<span class="builtintype" id="4381792">nil</span><br>
<span class="lineno"></span><span class="op" id="4381796">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4381799">//&nbsp;MarshalPKIXPublicKey&nbsp;serialises&nbsp;a&nbsp;public&nbsp;key&nbsp;to&nbsp;DER-encoded&nbsp;PKIX&nbsp;format.</span><br>
<span class="lineno">85</span><span class="keyword" id="4381875">func</span>&nbsp;<span class="ident" id="4381880">MarshalPKIXPublicKey</span><span class="op" id="4381900">(</span><span class="ident" id="4381901">pub</span>&nbsp;<span class="keyword" id="4381905">interface</span><span class="op" id="4381914">{</span><span class="op" id="4381915">}</span><span class="op" id="4381916">)</span>&nbsp;<span class="op" id="4381918">(</span><span class="op" id="4381919">[</span><span class="op" id="4381920">]</span><span class="builtintype" id="4381921">byte</span><span class="op" id="4381925">,</span>&nbsp;<span class="builtintype" id="4381927">error</span><span class="op" id="4381932">)</span>&nbsp;<span class="op" id="4381934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4381937">var</span>&nbsp;<span class="ident" id="4381941">publicKeyBytes</span>&nbsp;<span class="op" id="4381956">[</span><span class="op" id="4381957">]</span><span class="builtintype" id="4381958">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4381964">var</span>&nbsp;<span class="ident" id="4381968">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4381987">pkix</span><span class="op" id="4381991">.</span><span class="ident" id="4381992">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4382013">var</span>&nbsp;<span class="ident" id="4382017">err</span>&nbsp;<span class="builtintype" id="4382021">error</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4382029">if</span>&nbsp;<span class="ident" id="4382032">publicKeyBytes</span><span class="op" id="4382046">,</span>&nbsp;<span class="ident" id="4382048">publicKeyAlgorithm</span><span class="op" id="4382066">,</span>&nbsp;<span class="ident" id="4382068">err</span>&nbsp;<span class="op" id="4382072">=</span>&nbsp;<span class="ident" id="4382074">marshalPublicKey</span><span class="op" id="4382090">(</span><span class="ident" id="4382091">pub</span><span class="op" id="4382094">)</span><span class="op" id="4382095">;</span>&nbsp;<span class="ident" id="4382097">err</span>&nbsp;<span class="op" id="4382101">!=</span>&nbsp;<span class="builtintype" id="4382104">nil</span>&nbsp;<span class="op" id="4382108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4382112">return</span>&nbsp;<span class="builtintype" id="4382119">nil</span><span class="op" id="4382122">,</span>&nbsp;<span class="ident" id="4382124">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4382129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382133">pkix</span>&nbsp;<span class="op" id="4382138">:=</span>&nbsp;<span class="ident" id="4382141">pkixPublicKey</span><span class="op" id="4382154">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382158">Algo</span><span class="op" id="4382162">:</span>&nbsp;<span class="ident" id="4382164">publicKeyAlgorithm</span><span class="op" id="4382182">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382186">BitString</span><span class="op" id="4382195">:</span>&nbsp;<span class="ident" id="4382197">asn1</span><span class="op" id="4382201">.</span><span class="ident" id="4382202">BitString</span><span class="op" id="4382211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382216">Bytes</span><span class="op" id="4382221">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382227">publicKeyBytes</span><span class="op" id="4382241">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382246">BitLength</span><span class="op" id="4382255">:</span>&nbsp;<span class="num" id="4382257">8</span>&nbsp;<span class="op" id="4382259">*</span>&nbsp;<span class="builtinfunc" id="4382261">len</span><span class="op" id="4382264">(</span><span class="ident" id="4382265">publicKeyBytes</span><span class="op" id="4382279">)</span><span class="op" id="4382280">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4382284">}</span><span class="op" id="4382285">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4382288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382292">ret</span><span class="op" id="4382295">,</span>&nbsp;<span class="ident" id="4382297">_</span>&nbsp;<span class="op" id="4382299">:=</span>&nbsp;<span class="ident" id="4382302">asn1</span><span class="op" id="4382306">.</span><span class="ident" id="4382307">Marshal</span><span class="op" id="4382314">(</span><span class="ident" id="4382315">pkix</span><span class="op" id="4382319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4382322">return</span>&nbsp;<span class="ident" id="4382329">ret</span><span class="op" id="4382332">,</span>&nbsp;<span class="builtintype" id="4382334">nil</span><br>
<span class="lineno"></span><span class="op" id="4382338">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="4382341">//&nbsp;These&nbsp;structures&nbsp;reflect&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;X.509&nbsp;certificates.:</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4382414">type</span>&nbsp;<span class="ident" id="4382419">certificate</span>&nbsp;<span class="keyword" id="4382431">struct</span>&nbsp;<span class="op" id="4382438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382441">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382460">asn1</span><span class="op" id="4382464">.</span><span class="ident" id="4382465">RawContent</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382477">TBSCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382496">tbsCertificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382512">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4382531">pkix</span><span class="op" id="4382535">.</span><span class="ident" id="4382536">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382557">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382576">asn1</span><span class="op" id="4382580">.</span><span class="ident" id="4382581">BitString</span><br>
<span class="lineno"></span><span class="op" id="4382591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="4382594">type</span>&nbsp;<span class="ident" id="4382599">tbsCertificate</span>&nbsp;<span class="keyword" id="4382614">struct</span>&nbsp;<span class="op" id="4382621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382624">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382643">asn1</span><span class="op" id="4382647">.</span><span class="ident" id="4382648">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382660">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4382679">int</span>&nbsp;<span class="string" id="4382683">`asn1:&#34;optional,explicit,default:1,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382727">SerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4382746">*</span><span class="ident" id="4382747">big</span><span class="op" id="4382750">.</span><span class="ident" id="4382751">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382756">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4382775">pkix</span><span class="op" id="4382779">.</span><span class="ident" id="4382780">AlgorithmIdentifier</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382801">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382820">asn1</span><span class="op" id="4382824">.</span><span class="ident" id="4382825">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382835">Validity</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382854">validity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382864">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382883">asn1</span><span class="op" id="4382887">.</span><span class="ident" id="4382888">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382898">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382917">publicKeyInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382932">UniqueId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382951">asn1</span><span class="op" id="4382955">.</span><span class="ident" id="4382956">BitString</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4382968">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382993">SubjectUniqueId</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4383012">asn1</span><span class="op" id="4383016">.</span><span class="ident" id="4383017">BitString</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4383029">`asn1:&#34;optional,tag:2&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4383054">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4383073">[</span><span class="op" id="4383074">]</span><span class="ident" id="4383075">pkix</span><span class="op" id="4383079">.</span><span class="ident" id="4383080">Extension</span>&nbsp;<span class="string" id="4383090">`asn1:&#34;optional,explicit,tag:3&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4383123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4383126">type</span>&nbsp;<span class="ident" id="4383131">dsaAlgorithmParameters</span>&nbsp;<span class="keyword" id="4383154">struct</span>&nbsp;<span class="op" id="4383161">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4383164">P</span><span class="op" id="4383165">,</span>&nbsp;<span class="ident" id="4383167">Q</span><span class="op" id="4383168">,</span>&nbsp;<span class="ident" id="4383170">G</span>&nbsp;<span class="op" id="4383172">*</span><span class="ident" id="4383173">big</span><span class="op" id="4383176">.</span><span class="ident" id="4383177">Int</span><br>
<span class="lineno"></span><span class="op" id="4383181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4383184">type</span>&nbsp;<span class="ident" id="4383189">dsaSignature</span>&nbsp;<span class="keyword" id="4383202">struct</span>&nbsp;<span class="op" id="4383209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4383212">R</span><span class="op" id="4383213">,</span>&nbsp;<span class="ident" id="4383215">S</span>&nbsp;<span class="op" id="4383217">*</span><span class="ident" id="4383218">big</span><span class="op" id="4383221">.</span><span class="ident" id="4383222">Int</span><br>
<span class="lineno">135</span><span class="op" id="4383226">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4383229">type</span>&nbsp;<span class="ident" id="4383234">ecdsaSignature</span>&nbsp;<span class="ident" id="4383249">dsaSignature</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4383263">type</span>&nbsp;<span class="ident" id="4383268">validity</span>&nbsp;<span class="keyword" id="4383277">struct</span>&nbsp;<span class="op" id="4383284">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4383287">NotBefore</span><span class="op" id="4383296">,</span>&nbsp;<span class="ident" id="4383298">NotAfter</span>&nbsp;<span class="ident" id="4383307">time</span><span class="op" id="4383311">.</span><span class="ident" id="4383312">Time</span><br>
<span class="lineno"></span><span class="op" id="4383317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4383320">type</span>&nbsp;<span class="ident" id="4383325">publicKeyInfo</span>&nbsp;<span class="keyword" id="4383339">struct</span>&nbsp;<span class="op" id="4383346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4383349">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4383359">asn1</span><span class="op" id="4383363">.</span><span class="ident" id="4383364">RawContent</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4383376">Algorithm</span>&nbsp;<span class="ident" id="4383386">pkix</span><span class="op" id="4383390">.</span><span class="ident" id="4383391">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4383412">PublicKey</span>&nbsp;<span class="ident" id="4383422">asn1</span><span class="op" id="4383426">.</span><span class="ident" id="4383427">BitString</span><br>
<span class="lineno"></span><span class="op" id="4383437">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4383440">//&nbsp;RFC&nbsp;5280,&nbsp;&nbsp;4.2.1.1</span><br>
<span class="lineno">150</span><span class="keyword" id="4383462">type</span>&nbsp;<span class="ident" id="4383467">authKeyId</span>&nbsp;<span class="keyword" id="4383477">struct</span>&nbsp;<span class="op" id="4383484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4383487">Id</span>&nbsp;<span class="op" id="4383490">[</span><span class="op" id="4383491">]</span><span class="builtintype" id="4383492">byte</span>&nbsp;<span class="string" id="4383497">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4383521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4383524">type</span>&nbsp;<span class="ident" id="4383529">SignatureAlgorithm</span>&nbsp;<span class="builtintype" id="4383548">int</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="4383553">const</span>&nbsp;<span class="op" id="4383559">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4383562">UnknownSignatureAlgorithm</span>&nbsp;<span class="ident" id="4383588">SignatureAlgorithm</span>&nbsp;<span class="op" id="4383607">=</span>&nbsp;<span class="ident" id="4383609">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4383615">MD2WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4383627">MD5WithRSA</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4383639">SHA1WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4383652">SHA256WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4383667">SHA384WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4383682">SHA512WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4383697">DSAWithSHA1</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4383710">DSAWithSHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4383725">ECDSAWithSHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4383740">ECDSAWithSHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4383757">ECDSAWithSHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4383774">ECDSAWithSHA512</span><br>
<span class="lineno">170</span><span class="op" id="4383790">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4383793">type</span>&nbsp;<span class="ident" id="4383798">PublicKeyAlgorithm</span>&nbsp;<span class="builtintype" id="4383817">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4383822">const</span>&nbsp;<span class="op" id="4383828">(</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4383831">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4383857">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4383876">=</span>&nbsp;<span class="ident" id="4383878">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4383884">RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4383889">DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4383894">ECDSA</span><br>
<span class="lineno"></span><span class="op" id="4383900">)</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="4383903">//&nbsp;OIDs&nbsp;for&nbsp;signature&nbsp;algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4383936">//</span><br>
<span class="lineno"></span><span class="comment" id="4383939">//&nbsp;pkcs-1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4383973">//&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;rsadsi(113549)&nbsp;pkcs(1)&nbsp;1&nbsp;}</span><br>
<span class="lineno">185</span><span class="comment" id="4384036">//</span><br>
<span class="lineno"></span><span class="comment" id="4384039">//</span><br>
<span class="lineno"></span><span class="comment" id="4384042">//&nbsp;RFC&nbsp;3279&nbsp;2.2.1&nbsp;RSA&nbsp;Signature&nbsp;Algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4384085">//</span><br>
<span class="lineno"></span><span class="comment" id="4384088">//&nbsp;md2WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;2&nbsp;}</span><br>
<span class="lineno">190</span><span class="comment" id="4384147">//</span><br>
<span class="lineno"></span><span class="comment" id="4384150">//&nbsp;md5WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;4&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4384209">//</span><br>
<span class="lineno"></span><span class="comment" id="4384212">//&nbsp;sha-1WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;5&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4384273">//</span><br>
<span class="lineno">195</span><span class="comment" id="4384276">//&nbsp;dsaWithSha1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4384315">//&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;x9-57(10040)&nbsp;x9cm(4)&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4384376">//</span><br>
<span class="lineno"></span><span class="comment" id="4384379">//&nbsp;RFC&nbsp;3279&nbsp;2.2.3&nbsp;ECDSA&nbsp;Signature&nbsp;Algorithm</span><br>
<span class="lineno"></span><span class="comment" id="4384423">//</span><br>
<span class="lineno">200</span><span class="comment" id="4384426">//&nbsp;ecdsa-with-SHA1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4384469">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-x962(10045)</span><br>
<span class="lineno"></span><span class="comment" id="4384522">//&nbsp;&nbsp;&nbsp;&nbsp;signatures(4)&nbsp;ecdsa-with-SHA1(1)}</span><br>
<span class="lineno"></span><span class="comment" id="4384562">//</span><br>
<span class="lineno"></span><span class="comment" id="4384565">//</span><br>
<span class="lineno">205</span><span class="comment" id="4384568">//&nbsp;RFC&nbsp;4055&nbsp;5&nbsp;PKCS&nbsp;#1&nbsp;Version&nbsp;1.5</span><br>
<span class="lineno"></span><span class="comment" id="4384602">//</span><br>
<span class="lineno"></span><span class="comment" id="4384605">//&nbsp;sha256WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;11&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4384668">//</span><br>
<span class="lineno"></span><span class="comment" id="4384671">//&nbsp;sha384WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;12&nbsp;}</span><br>
<span class="lineno">210</span><span class="comment" id="4384734">//</span><br>
<span class="lineno"></span><span class="comment" id="4384737">//&nbsp;sha512WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;13&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4384800">//</span><br>
<span class="lineno"></span><span class="comment" id="4384803">//</span><br>
<span class="lineno"></span><span class="comment" id="4384806">//&nbsp;RFC&nbsp;5758&nbsp;3.1&nbsp;DSA&nbsp;Signature&nbsp;Algorithms</span><br>
<span class="lineno">215</span><span class="comment" id="4384847">//</span><br>
<span class="lineno"></span><span class="comment" id="4384850">//&nbsp;dsaWithSha256&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4384891">//&nbsp;&nbsp;&nbsp;&nbsp;joint-iso-ccitt(2)&nbsp;country(16)&nbsp;us(840)&nbsp;organization(1)&nbsp;gov(101)</span><br>
<span class="lineno"></span><span class="comment" id="4384961">//&nbsp;&nbsp;&nbsp;&nbsp;csor(3)&nbsp;algorithms(4)&nbsp;id-dsa-with-sha2(3)&nbsp;2}</span><br>
<span class="lineno"></span><span class="comment" id="4385012">//</span><br>
<span class="lineno">220</span><span class="comment" id="4385015">//&nbsp;RFC&nbsp;5758&nbsp;3.2&nbsp;ECDSA&nbsp;Signature&nbsp;Algorithm</span><br>
<span class="lineno"></span><span class="comment" id="4385057">//</span><br>
<span class="lineno"></span><span class="comment" id="4385060">//&nbsp;ecdsa-with-SHA256&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4385127">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;2&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4385196">//</span><br>
<span class="lineno">225</span><span class="comment" id="4385199">//&nbsp;ecdsa-with-SHA384&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4385266">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4385335">//</span><br>
<span class="lineno"></span><span class="comment" id="4385338">//&nbsp;ecdsa-with-SHA512&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="4385405">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;4&nbsp;}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="4385475">var</span>&nbsp;<span class="op" id="4385479">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4385482">oidSignatureMD2WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4385510">=</span>&nbsp;<span class="ident" id="4385512">asn1</span><span class="op" id="4385516">.</span><span class="ident" id="4385517">ObjectIdentifier</span><span class="op" id="4385533">{</span><span class="num" id="4385534">1</span><span class="op" id="4385535">,</span>&nbsp;<span class="num" id="4385537">2</span><span class="op" id="4385538">,</span>&nbsp;<span class="num" id="4385540">840</span><span class="op" id="4385543">,</span>&nbsp;<span class="num" id="4385545">113549</span><span class="op" id="4385551">,</span>&nbsp;<span class="num" id="4385553">1</span><span class="op" id="4385554">,</span>&nbsp;<span class="num" id="4385556">1</span><span class="op" id="4385557">,</span>&nbsp;<span class="num" id="4385559">2</span><span class="op" id="4385560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4385563">oidSignatureMD5WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4385591">=</span>&nbsp;<span class="ident" id="4385593">asn1</span><span class="op" id="4385597">.</span><span class="ident" id="4385598">ObjectIdentifier</span><span class="op" id="4385614">{</span><span class="num" id="4385615">1</span><span class="op" id="4385616">,</span>&nbsp;<span class="num" id="4385618">2</span><span class="op" id="4385619">,</span>&nbsp;<span class="num" id="4385621">840</span><span class="op" id="4385624">,</span>&nbsp;<span class="num" id="4385626">113549</span><span class="op" id="4385632">,</span>&nbsp;<span class="num" id="4385634">1</span><span class="op" id="4385635">,</span>&nbsp;<span class="num" id="4385637">1</span><span class="op" id="4385638">,</span>&nbsp;<span class="num" id="4385640">4</span><span class="op" id="4385641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4385644">oidSignatureSHA1WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4385672">=</span>&nbsp;<span class="ident" id="4385674">asn1</span><span class="op" id="4385678">.</span><span class="ident" id="4385679">ObjectIdentifier</span><span class="op" id="4385695">{</span><span class="num" id="4385696">1</span><span class="op" id="4385697">,</span>&nbsp;<span class="num" id="4385699">2</span><span class="op" id="4385700">,</span>&nbsp;<span class="num" id="4385702">840</span><span class="op" id="4385705">,</span>&nbsp;<span class="num" id="4385707">113549</span><span class="op" id="4385713">,</span>&nbsp;<span class="num" id="4385715">1</span><span class="op" id="4385716">,</span>&nbsp;<span class="num" id="4385718">1</span><span class="op" id="4385719">,</span>&nbsp;<span class="num" id="4385721">5</span><span class="op" id="4385722">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4385725">oidSignatureSHA256WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4385753">=</span>&nbsp;<span class="ident" id="4385755">asn1</span><span class="op" id="4385759">.</span><span class="ident" id="4385760">ObjectIdentifier</span><span class="op" id="4385776">{</span><span class="num" id="4385777">1</span><span class="op" id="4385778">,</span>&nbsp;<span class="num" id="4385780">2</span><span class="op" id="4385781">,</span>&nbsp;<span class="num" id="4385783">840</span><span class="op" id="4385786">,</span>&nbsp;<span class="num" id="4385788">113549</span><span class="op" id="4385794">,</span>&nbsp;<span class="num" id="4385796">1</span><span class="op" id="4385797">,</span>&nbsp;<span class="num" id="4385799">1</span><span class="op" id="4385800">,</span>&nbsp;<span class="num" id="4385802">11</span><span class="op" id="4385804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4385807">oidSignatureSHA384WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4385835">=</span>&nbsp;<span class="ident" id="4385837">asn1</span><span class="op" id="4385841">.</span><span class="ident" id="4385842">ObjectIdentifier</span><span class="op" id="4385858">{</span><span class="num" id="4385859">1</span><span class="op" id="4385860">,</span>&nbsp;<span class="num" id="4385862">2</span><span class="op" id="4385863">,</span>&nbsp;<span class="num" id="4385865">840</span><span class="op" id="4385868">,</span>&nbsp;<span class="num" id="4385870">113549</span><span class="op" id="4385876">,</span>&nbsp;<span class="num" id="4385878">1</span><span class="op" id="4385879">,</span>&nbsp;<span class="num" id="4385881">1</span><span class="op" id="4385882">,</span>&nbsp;<span class="num" id="4385884">12</span><span class="op" id="4385886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4385889">oidSignatureSHA512WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4385917">=</span>&nbsp;<span class="ident" id="4385919">asn1</span><span class="op" id="4385923">.</span><span class="ident" id="4385924">ObjectIdentifier</span><span class="op" id="4385940">{</span><span class="num" id="4385941">1</span><span class="op" id="4385942">,</span>&nbsp;<span class="num" id="4385944">2</span><span class="op" id="4385945">,</span>&nbsp;<span class="num" id="4385947">840</span><span class="op" id="4385950">,</span>&nbsp;<span class="num" id="4385952">113549</span><span class="op" id="4385958">,</span>&nbsp;<span class="num" id="4385960">1</span><span class="op" id="4385961">,</span>&nbsp;<span class="num" id="4385963">1</span><span class="op" id="4385964">,</span>&nbsp;<span class="num" id="4385966">13</span><span class="op" id="4385968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4385971">oidSignatureDSAWithSHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4385999">=</span>&nbsp;<span class="ident" id="4386001">asn1</span><span class="op" id="4386005">.</span><span class="ident" id="4386006">ObjectIdentifier</span><span class="op" id="4386022">{</span><span class="num" id="4386023">1</span><span class="op" id="4386024">,</span>&nbsp;<span class="num" id="4386026">2</span><span class="op" id="4386027">,</span>&nbsp;<span class="num" id="4386029">840</span><span class="op" id="4386032">,</span>&nbsp;<span class="num" id="4386034">10040</span><span class="op" id="4386039">,</span>&nbsp;<span class="num" id="4386041">4</span><span class="op" id="4386042">,</span>&nbsp;<span class="num" id="4386044">3</span><span class="op" id="4386045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4386048">oidSignatureDSAWithSHA256</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4386076">=</span>&nbsp;<span class="ident" id="4386078">asn1</span><span class="op" id="4386082">.</span><span class="ident" id="4386083">ObjectIdentifier</span><span class="op" id="4386099">{</span><span class="num" id="4386100">2</span><span class="op" id="4386101">,</span>&nbsp;<span class="num" id="4386103">16</span><span class="op" id="4386105">,</span>&nbsp;<span class="num" id="4386107">840</span><span class="op" id="4386110">,</span>&nbsp;<span class="num" id="4386112">1</span><span class="op" id="4386113">,</span>&nbsp;<span class="num" id="4386115">101</span><span class="op" id="4386118">,</span>&nbsp;<span class="num" id="4386120">4</span><span class="op" id="4386121">,</span>&nbsp;<span class="num" id="4386123">3</span><span class="op" id="4386124">,</span>&nbsp;<span class="num" id="4386126">2</span><span class="op" id="4386127">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4386130">oidSignatureECDSAWithSHA1</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4386158">=</span>&nbsp;<span class="ident" id="4386160">asn1</span><span class="op" id="4386164">.</span><span class="ident" id="4386165">ObjectIdentifier</span><span class="op" id="4386181">{</span><span class="num" id="4386182">1</span><span class="op" id="4386183">,</span>&nbsp;<span class="num" id="4386185">2</span><span class="op" id="4386186">,</span>&nbsp;<span class="num" id="4386188">840</span><span class="op" id="4386191">,</span>&nbsp;<span class="num" id="4386193">10045</span><span class="op" id="4386198">,</span>&nbsp;<span class="num" id="4386200">4</span><span class="op" id="4386201">,</span>&nbsp;<span class="num" id="4386203">1</span><span class="op" id="4386204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4386207">oidSignatureECDSAWithSHA256</span>&nbsp;<span class="op" id="4386235">=</span>&nbsp;<span class="ident" id="4386237">asn1</span><span class="op" id="4386241">.</span><span class="ident" id="4386242">ObjectIdentifier</span><span class="op" id="4386258">{</span><span class="num" id="4386259">1</span><span class="op" id="4386260">,</span>&nbsp;<span class="num" id="4386262">2</span><span class="op" id="4386263">,</span>&nbsp;<span class="num" id="4386265">840</span><span class="op" id="4386268">,</span>&nbsp;<span class="num" id="4386270">10045</span><span class="op" id="4386275">,</span>&nbsp;<span class="num" id="4386277">4</span><span class="op" id="4386278">,</span>&nbsp;<span class="num" id="4386280">3</span><span class="op" id="4386281">,</span>&nbsp;<span class="num" id="4386283">2</span><span class="op" id="4386284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4386287">oidSignatureECDSAWithSHA384</span>&nbsp;<span class="op" id="4386315">=</span>&nbsp;<span class="ident" id="4386317">asn1</span><span class="op" id="4386321">.</span><span class="ident" id="4386322">ObjectIdentifier</span><span class="op" id="4386338">{</span><span class="num" id="4386339">1</span><span class="op" id="4386340">,</span>&nbsp;<span class="num" id="4386342">2</span><span class="op" id="4386343">,</span>&nbsp;<span class="num" id="4386345">840</span><span class="op" id="4386348">,</span>&nbsp;<span class="num" id="4386350">10045</span><span class="op" id="4386355">,</span>&nbsp;<span class="num" id="4386357">4</span><span class="op" id="4386358">,</span>&nbsp;<span class="num" id="4386360">3</span><span class="op" id="4386361">,</span>&nbsp;<span class="num" id="4386363">3</span><span class="op" id="4386364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4386367">oidSignatureECDSAWithSHA512</span>&nbsp;<span class="op" id="4386395">=</span>&nbsp;<span class="ident" id="4386397">asn1</span><span class="op" id="4386401">.</span><span class="ident" id="4386402">ObjectIdentifier</span><span class="op" id="4386418">{</span><span class="num" id="4386419">1</span><span class="op" id="4386420">,</span>&nbsp;<span class="num" id="4386422">2</span><span class="op" id="4386423">,</span>&nbsp;<span class="num" id="4386425">840</span><span class="op" id="4386428">,</span>&nbsp;<span class="num" id="4386430">10045</span><span class="op" id="4386435">,</span>&nbsp;<span class="num" id="4386437">4</span><span class="op" id="4386438">,</span>&nbsp;<span class="num" id="4386440">3</span><span class="op" id="4386441">,</span>&nbsp;<span class="num" id="4386443">4</span><span class="op" id="4386444">}</span><br>
<span class="lineno"></span><span class="op" id="4386446">)</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="4386449">var</span>&nbsp;<span class="ident" id="4386453">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="4386479">=</span>&nbsp;<span class="op" id="4386481">[</span><span class="op" id="4386482">]</span><span class="keyword" id="4386483">struct</span>&nbsp;<span class="op" id="4386490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4386493">algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4386504">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4386524">oid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4386535">asn1</span><span class="op" id="4386539">.</span><span class="ident" id="4386540">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4386558">pubKeyAlgo</span>&nbsp;<span class="ident" id="4386569">PublicKeyAlgorithm</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4386589">hash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4386600">crypto</span><span class="op" id="4386606">.</span><span class="ident" id="4386607">Hash</span><br>
<span class="lineno"></span><span class="op" id="4386612">}</span><span class="op" id="4386613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4386616">{</span><span class="ident" id="4386617">MD2WithRSA</span><span class="op" id="4386627">,</span>&nbsp;<span class="ident" id="4386629">oidSignatureMD2WithRSA</span><span class="op" id="4386651">,</span>&nbsp;<span class="ident" id="4386653">RSA</span><span class="op" id="4386656">,</span>&nbsp;<span class="ident" id="4386658">crypto</span><span class="op" id="4386664">.</span><span class="ident" id="4386665">Hash</span><span class="op" id="4386669">(</span><span class="num" id="4386670">0</span><span class="op" id="4386671">)</span>&nbsp;<span class="comment" id="4386673">/*&nbsp;no&nbsp;value&nbsp;for&nbsp;MD2&nbsp;*/</span><span class="op" id="4386695">}</span><span class="op" id="4386696">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4386699">{</span><span class="ident" id="4386700">MD5WithRSA</span><span class="op" id="4386710">,</span>&nbsp;<span class="ident" id="4386712">oidSignatureMD5WithRSA</span><span class="op" id="4386734">,</span>&nbsp;<span class="ident" id="4386736">RSA</span><span class="op" id="4386739">,</span>&nbsp;<span class="ident" id="4386741">crypto</span><span class="op" id="4386747">.</span><span class="ident" id="4386748">MD5</span><span class="op" id="4386751">}</span><span class="op" id="4386752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4386755">{</span><span class="ident" id="4386756">SHA1WithRSA</span><span class="op" id="4386767">,</span>&nbsp;<span class="ident" id="4386769">oidSignatureSHA1WithRSA</span><span class="op" id="4386792">,</span>&nbsp;<span class="ident" id="4386794">RSA</span><span class="op" id="4386797">,</span>&nbsp;<span class="ident" id="4386799">crypto</span><span class="op" id="4386805">.</span><span class="ident" id="4386806">SHA1</span><span class="op" id="4386810">}</span><span class="op" id="4386811">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4386814">{</span><span class="ident" id="4386815">SHA256WithRSA</span><span class="op" id="4386828">,</span>&nbsp;<span class="ident" id="4386830">oidSignatureSHA256WithRSA</span><span class="op" id="4386855">,</span>&nbsp;<span class="ident" id="4386857">RSA</span><span class="op" id="4386860">,</span>&nbsp;<span class="ident" id="4386862">crypto</span><span class="op" id="4386868">.</span><span class="ident" id="4386869">SHA256</span><span class="op" id="4386875">}</span><span class="op" id="4386876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4386879">{</span><span class="ident" id="4386880">SHA384WithRSA</span><span class="op" id="4386893">,</span>&nbsp;<span class="ident" id="4386895">oidSignatureSHA384WithRSA</span><span class="op" id="4386920">,</span>&nbsp;<span class="ident" id="4386922">RSA</span><span class="op" id="4386925">,</span>&nbsp;<span class="ident" id="4386927">crypto</span><span class="op" id="4386933">.</span><span class="ident" id="4386934">SHA384</span><span class="op" id="4386940">}</span><span class="op" id="4386941">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4386944">{</span><span class="ident" id="4386945">SHA512WithRSA</span><span class="op" id="4386958">,</span>&nbsp;<span class="ident" id="4386960">oidSignatureSHA512WithRSA</span><span class="op" id="4386985">,</span>&nbsp;<span class="ident" id="4386987">RSA</span><span class="op" id="4386990">,</span>&nbsp;<span class="ident" id="4386992">crypto</span><span class="op" id="4386998">.</span><span class="ident" id="4386999">SHA512</span><span class="op" id="4387005">}</span><span class="op" id="4387006">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4387009">{</span><span class="ident" id="4387010">DSAWithSHA1</span><span class="op" id="4387021">,</span>&nbsp;<span class="ident" id="4387023">oidSignatureDSAWithSHA1</span><span class="op" id="4387046">,</span>&nbsp;<span class="ident" id="4387048">DSA</span><span class="op" id="4387051">,</span>&nbsp;<span class="ident" id="4387053">crypto</span><span class="op" id="4387059">.</span><span class="ident" id="4387060">SHA1</span><span class="op" id="4387064">}</span><span class="op" id="4387065">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4387068">{</span><span class="ident" id="4387069">DSAWithSHA256</span><span class="op" id="4387082">,</span>&nbsp;<span class="ident" id="4387084">oidSignatureDSAWithSHA256</span><span class="op" id="4387109">,</span>&nbsp;<span class="ident" id="4387111">DSA</span><span class="op" id="4387114">,</span>&nbsp;<span class="ident" id="4387116">crypto</span><span class="op" id="4387122">.</span><span class="ident" id="4387123">SHA256</span><span class="op" id="4387129">}</span><span class="op" id="4387130">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4387133">{</span><span class="ident" id="4387134">ECDSAWithSHA1</span><span class="op" id="4387147">,</span>&nbsp;<span class="ident" id="4387149">oidSignatureECDSAWithSHA1</span><span class="op" id="4387174">,</span>&nbsp;<span class="ident" id="4387176">ECDSA</span><span class="op" id="4387181">,</span>&nbsp;<span class="ident" id="4387183">crypto</span><span class="op" id="4387189">.</span><span class="ident" id="4387190">SHA1</span><span class="op" id="4387194">}</span><span class="op" id="4387195">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4387198">{</span><span class="ident" id="4387199">ECDSAWithSHA256</span><span class="op" id="4387214">,</span>&nbsp;<span class="ident" id="4387216">oidSignatureECDSAWithSHA256</span><span class="op" id="4387243">,</span>&nbsp;<span class="ident" id="4387245">ECDSA</span><span class="op" id="4387250">,</span>&nbsp;<span class="ident" id="4387252">crypto</span><span class="op" id="4387258">.</span><span class="ident" id="4387259">SHA256</span><span class="op" id="4387265">}</span><span class="op" id="4387266">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4387269">{</span><span class="ident" id="4387270">ECDSAWithSHA384</span><span class="op" id="4387285">,</span>&nbsp;<span class="ident" id="4387287">oidSignatureECDSAWithSHA384</span><span class="op" id="4387314">,</span>&nbsp;<span class="ident" id="4387316">ECDSA</span><span class="op" id="4387321">,</span>&nbsp;<span class="ident" id="4387323">crypto</span><span class="op" id="4387329">.</span><span class="ident" id="4387330">SHA384</span><span class="op" id="4387336">}</span><span class="op" id="4387337">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4387340">{</span><span class="ident" id="4387341">ECDSAWithSHA512</span><span class="op" id="4387356">,</span>&nbsp;<span class="ident" id="4387358">oidSignatureECDSAWithSHA512</span><span class="op" id="4387385">,</span>&nbsp;<span class="ident" id="4387387">ECDSA</span><span class="op" id="4387392">,</span>&nbsp;<span class="ident" id="4387394">crypto</span><span class="op" id="4387400">.</span><span class="ident" id="4387401">SHA512</span><span class="op" id="4387407">}</span><span class="op" id="4387408">,</span><br>
<span class="lineno"></span><span class="op" id="4387410">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="keyword" id="4387413">func</span>&nbsp;<span class="ident" id="4387418">getSignatureAlgorithmFromOID</span><span class="op" id="4387446">(</span><span class="ident" id="4387447">oid</span>&nbsp;<span class="ident" id="4387451">asn1</span><span class="op" id="4387455">.</span><span class="ident" id="4387456">ObjectIdentifier</span><span class="op" id="4387472">)</span>&nbsp;<span class="ident" id="4387474">SignatureAlgorithm</span>&nbsp;<span class="op" id="4387493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4387496">for</span>&nbsp;<span class="ident" id="4387500">_</span><span class="op" id="4387501">,</span>&nbsp;<span class="ident" id="4387503">details</span>&nbsp;<span class="op" id="4387511">:=</span>&nbsp;<span class="keyword" id="4387514">range</span>&nbsp;<span class="ident" id="4387520">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="4387546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4387550">if</span>&nbsp;<span class="ident" id="4387553">oid</span><span class="op" id="4387556">.</span><span class="ident" id="4387557">Equal</span><span class="op" id="4387562">(</span><span class="ident" id="4387563">details</span><span class="op" id="4387570">.</span><span class="ident" id="4387571">oid</span><span class="op" id="4387574">)</span>&nbsp;<span class="op" id="4387576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4387581">return</span>&nbsp;<span class="ident" id="4387588">details</span><span class="op" id="4387595">.</span><span class="ident" id="4387596">algo</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4387603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4387606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4387609">return</span>&nbsp;<span class="ident" id="4387616">UnknownSignatureAlgorithm</span><br>
<span class="lineno"></span><span class="op" id="4387642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="comment" id="4387645">//&nbsp;RFC&nbsp;3279,&nbsp;2.3&nbsp;Public&nbsp;Key&nbsp;Algorithms</span><br>
<span class="lineno"></span><span class="comment" id="4387684">//</span><br>
<span class="lineno"></span><span class="comment" id="4387687">//&nbsp;pkcs-1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)</span><br>
<span class="lineno"></span><span class="comment" id="4387752">//&nbsp;&nbsp;&nbsp;&nbsp;rsadsi(113549)&nbsp;pkcs(1)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4387785">//</span><br>
<span class="lineno">280</span><span class="comment" id="4387788">//&nbsp;rsaEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;pkcs1-1&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4387842">//</span><br>
<span class="lineno"></span><span class="comment" id="4387845">//&nbsp;id-dsa&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)</span><br>
<span class="lineno"></span><span class="comment" id="4387910">//&nbsp;&nbsp;&nbsp;&nbsp;x9-57(10040)&nbsp;x9cm(4)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4387941">//</span><br>
<span class="lineno">285</span><span class="comment" id="4387944">//&nbsp;RFC&nbsp;5480,&nbsp;2.1.1&nbsp;Unrestricted&nbsp;Algorithm&nbsp;Identifier&nbsp;and&nbsp;Parameters</span><br>
<span class="lineno"></span><span class="comment" id="4388012">//</span><br>
<span class="lineno"></span><span class="comment" id="4388015">//&nbsp;id-ecPublicKey&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4388057">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;keyType(2)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="4388129">var</span>&nbsp;<span class="op" id="4388133">(</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4388136">oidPublicKeyRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4388154">=</span>&nbsp;<span class="ident" id="4388156">asn1</span><span class="op" id="4388160">.</span><span class="ident" id="4388161">ObjectIdentifier</span><span class="op" id="4388177">{</span><span class="num" id="4388178">1</span><span class="op" id="4388179">,</span>&nbsp;<span class="num" id="4388181">2</span><span class="op" id="4388182">,</span>&nbsp;<span class="num" id="4388184">840</span><span class="op" id="4388187">,</span>&nbsp;<span class="num" id="4388189">113549</span><span class="op" id="4388195">,</span>&nbsp;<span class="num" id="4388197">1</span><span class="op" id="4388198">,</span>&nbsp;<span class="num" id="4388200">1</span><span class="op" id="4388201">,</span>&nbsp;<span class="num" id="4388203">1</span><span class="op" id="4388204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4388207">oidPublicKeyDSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4388225">=</span>&nbsp;<span class="ident" id="4388227">asn1</span><span class="op" id="4388231">.</span><span class="ident" id="4388232">ObjectIdentifier</span><span class="op" id="4388248">{</span><span class="num" id="4388249">1</span><span class="op" id="4388250">,</span>&nbsp;<span class="num" id="4388252">2</span><span class="op" id="4388253">,</span>&nbsp;<span class="num" id="4388255">840</span><span class="op" id="4388258">,</span>&nbsp;<span class="num" id="4388260">10040</span><span class="op" id="4388265">,</span>&nbsp;<span class="num" id="4388267">4</span><span class="op" id="4388268">,</span>&nbsp;<span class="num" id="4388270">1</span><span class="op" id="4388271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4388274">oidPublicKeyECDSA</span>&nbsp;<span class="op" id="4388292">=</span>&nbsp;<span class="ident" id="4388294">asn1</span><span class="op" id="4388298">.</span><span class="ident" id="4388299">ObjectIdentifier</span><span class="op" id="4388315">{</span><span class="num" id="4388316">1</span><span class="op" id="4388317">,</span>&nbsp;<span class="num" id="4388319">2</span><span class="op" id="4388320">,</span>&nbsp;<span class="num" id="4388322">840</span><span class="op" id="4388325">,</span>&nbsp;<span class="num" id="4388327">10045</span><span class="op" id="4388332">,</span>&nbsp;<span class="num" id="4388334">2</span><span class="op" id="4388335">,</span>&nbsp;<span class="num" id="4388337">1</span><span class="op" id="4388338">}</span><br>
<span class="lineno"></span><span class="op" id="4388340">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span><span class="keyword" id="4388343">func</span>&nbsp;<span class="ident" id="4388348">getPublicKeyAlgorithmFromOID</span><span class="op" id="4388376">(</span><span class="ident" id="4388377">oid</span>&nbsp;<span class="ident" id="4388381">asn1</span><span class="op" id="4388385">.</span><span class="ident" id="4388386">ObjectIdentifier</span><span class="op" id="4388402">)</span>&nbsp;<span class="ident" id="4388404">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4388423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4388426">switch</span>&nbsp;<span class="op" id="4388433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4388436">case</span>&nbsp;<span class="ident" id="4388441">oid</span><span class="op" id="4388444">.</span><span class="ident" id="4388445">Equal</span><span class="op" id="4388450">(</span><span class="ident" id="4388451">oidPublicKeyRSA</span><span class="op" id="4388466">)</span><span class="op" id="4388467">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4388471">return</span>&nbsp;<span class="ident" id="4388478">RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4388483">case</span>&nbsp;<span class="ident" id="4388488">oid</span><span class="op" id="4388491">.</span><span class="ident" id="4388492">Equal</span><span class="op" id="4388497">(</span><span class="ident" id="4388498">oidPublicKeyDSA</span><span class="op" id="4388513">)</span><span class="op" id="4388514">:</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4388518">return</span>&nbsp;<span class="ident" id="4388525">DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4388530">case</span>&nbsp;<span class="ident" id="4388535">oid</span><span class="op" id="4388538">.</span><span class="ident" id="4388539">Equal</span><span class="op" id="4388544">(</span><span class="ident" id="4388545">oidPublicKeyECDSA</span><span class="op" id="4388562">)</span><span class="op" id="4388563">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4388567">return</span>&nbsp;<span class="ident" id="4388574">ECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4388581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4388584">return</span>&nbsp;<span class="ident" id="4388591">UnknownPublicKeyAlgorithm</span><br>
<span class="lineno">305</span><span class="op" id="4388617">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4388620">//&nbsp;RFC&nbsp;5480,&nbsp;2.1.1.1.&nbsp;Named&nbsp;Curve</span><br>
<span class="lineno"></span><span class="comment" id="4388654">//</span><br>
<span class="lineno"></span><span class="comment" id="4388657">//&nbsp;secp224r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno">310</span><span class="comment" id="4388694">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;33&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4388761">//</span><br>
<span class="lineno"></span><span class="comment" id="4388764">//&nbsp;secp256r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4388801">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;curves(3)</span><br>
<span class="lineno"></span><span class="comment" id="4388864">//&nbsp;&nbsp;&nbsp;prime(1)&nbsp;7&nbsp;}</span><br>
<span class="lineno">315</span><span class="comment" id="4388882">//</span><br>
<span class="lineno"></span><span class="comment" id="4388885">//&nbsp;secp384r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4388922">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;34&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4388989">//</span><br>
<span class="lineno"></span><span class="comment" id="4388992">//&nbsp;secp521r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno">320</span><span class="comment" id="4389029">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;35&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4389096">//</span><br>
<span class="lineno"></span><span class="comment" id="4389099">//&nbsp;NB:&nbsp;secp256r1&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;prime256v1</span><br>
<span class="lineno"></span><span class="keyword" id="4389144">var</span>&nbsp;<span class="op" id="4389148">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4389151">oidNamedCurveP224</span>&nbsp;<span class="op" id="4389169">=</span>&nbsp;<span class="ident" id="4389171">asn1</span><span class="op" id="4389175">.</span><span class="ident" id="4389176">ObjectIdentifier</span><span class="op" id="4389192">{</span><span class="num" id="4389193">1</span><span class="op" id="4389194">,</span>&nbsp;<span class="num" id="4389196">3</span><span class="op" id="4389197">,</span>&nbsp;<span class="num" id="4389199">132</span><span class="op" id="4389202">,</span>&nbsp;<span class="num" id="4389204">0</span><span class="op" id="4389205">,</span>&nbsp;<span class="num" id="4389207">33</span><span class="op" id="4389209">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4389212">oidNamedCurveP256</span>&nbsp;<span class="op" id="4389230">=</span>&nbsp;<span class="ident" id="4389232">asn1</span><span class="op" id="4389236">.</span><span class="ident" id="4389237">ObjectIdentifier</span><span class="op" id="4389253">{</span><span class="num" id="4389254">1</span><span class="op" id="4389255">,</span>&nbsp;<span class="num" id="4389257">2</span><span class="op" id="4389258">,</span>&nbsp;<span class="num" id="4389260">840</span><span class="op" id="4389263">,</span>&nbsp;<span class="num" id="4389265">10045</span><span class="op" id="4389270">,</span>&nbsp;<span class="num" id="4389272">3</span><span class="op" id="4389273">,</span>&nbsp;<span class="num" id="4389275">1</span><span class="op" id="4389276">,</span>&nbsp;<span class="num" id="4389278">7</span><span class="op" id="4389279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4389282">oidNamedCurveP384</span>&nbsp;<span class="op" id="4389300">=</span>&nbsp;<span class="ident" id="4389302">asn1</span><span class="op" id="4389306">.</span><span class="ident" id="4389307">ObjectIdentifier</span><span class="op" id="4389323">{</span><span class="num" id="4389324">1</span><span class="op" id="4389325">,</span>&nbsp;<span class="num" id="4389327">3</span><span class="op" id="4389328">,</span>&nbsp;<span class="num" id="4389330">132</span><span class="op" id="4389333">,</span>&nbsp;<span class="num" id="4389335">0</span><span class="op" id="4389336">,</span>&nbsp;<span class="num" id="4389338">34</span><span class="op" id="4389340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4389343">oidNamedCurveP521</span>&nbsp;<span class="op" id="4389361">=</span>&nbsp;<span class="ident" id="4389363">asn1</span><span class="op" id="4389367">.</span><span class="ident" id="4389368">ObjectIdentifier</span><span class="op" id="4389384">{</span><span class="num" id="4389385">1</span><span class="op" id="4389386">,</span>&nbsp;<span class="num" id="4389388">3</span><span class="op" id="4389389">,</span>&nbsp;<span class="num" id="4389391">132</span><span class="op" id="4389394">,</span>&nbsp;<span class="num" id="4389396">0</span><span class="op" id="4389397">,</span>&nbsp;<span class="num" id="4389399">35</span><span class="op" id="4389401">}</span><br>
<span class="lineno"></span><span class="op" id="4389403">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="4389406">func</span>&nbsp;<span class="ident" id="4389411">namedCurveFromOID</span><span class="op" id="4389428">(</span><span class="ident" id="4389429">oid</span>&nbsp;<span class="ident" id="4389433">asn1</span><span class="op" id="4389437">.</span><span class="ident" id="4389438">ObjectIdentifier</span><span class="op" id="4389454">)</span>&nbsp;<span class="ident" id="4389456">elliptic</span><span class="op" id="4389464">.</span><span class="ident" id="4389465">Curve</span>&nbsp;<span class="op" id="4389471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4389474">switch</span>&nbsp;<span class="op" id="4389481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4389484">case</span>&nbsp;<span class="ident" id="4389489">oid</span><span class="op" id="4389492">.</span><span class="ident" id="4389493">Equal</span><span class="op" id="4389498">(</span><span class="ident" id="4389499">oidNamedCurveP224</span><span class="op" id="4389516">)</span><span class="op" id="4389517">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4389521">return</span>&nbsp;<span class="ident" id="4389528">elliptic</span><span class="op" id="4389536">.</span><span class="ident" id="4389537">P224</span><span class="op" id="4389541">(</span><span class="op" id="4389542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4389545">case</span>&nbsp;<span class="ident" id="4389550">oid</span><span class="op" id="4389553">.</span><span class="ident" id="4389554">Equal</span><span class="op" id="4389559">(</span><span class="ident" id="4389560">oidNamedCurveP256</span><span class="op" id="4389577">)</span><span class="op" id="4389578">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4389582">return</span>&nbsp;<span class="ident" id="4389589">elliptic</span><span class="op" id="4389597">.</span><span class="ident" id="4389598">P256</span><span class="op" id="4389602">(</span><span class="op" id="4389603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4389606">case</span>&nbsp;<span class="ident" id="4389611">oid</span><span class="op" id="4389614">.</span><span class="ident" id="4389615">Equal</span><span class="op" id="4389620">(</span><span class="ident" id="4389621">oidNamedCurveP384</span><span class="op" id="4389638">)</span><span class="op" id="4389639">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4389643">return</span>&nbsp;<span class="ident" id="4389650">elliptic</span><span class="op" id="4389658">.</span><span class="ident" id="4389659">P384</span><span class="op" id="4389663">(</span><span class="op" id="4389664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4389667">case</span>&nbsp;<span class="ident" id="4389672">oid</span><span class="op" id="4389675">.</span><span class="ident" id="4389676">Equal</span><span class="op" id="4389681">(</span><span class="ident" id="4389682">oidNamedCurveP521</span><span class="op" id="4389699">)</span><span class="op" id="4389700">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4389704">return</span>&nbsp;<span class="ident" id="4389711">elliptic</span><span class="op" id="4389719">.</span><span class="ident" id="4389720">P521</span><span class="op" id="4389724">(</span><span class="op" id="4389725">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4389728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4389731">return</span>&nbsp;<span class="builtintype" id="4389738">nil</span><br>
<span class="lineno"></span><span class="op" id="4389742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4389745">func</span>&nbsp;<span class="ident" id="4389750">oidFromNamedCurve</span><span class="op" id="4389767">(</span><span class="ident" id="4389768">curve</span>&nbsp;<span class="ident" id="4389774">elliptic</span><span class="op" id="4389782">.</span><span class="ident" id="4389783">Curve</span><span class="op" id="4389788">)</span>&nbsp;<span class="op" id="4389790">(</span><span class="ident" id="4389791">asn1</span><span class="op" id="4389795">.</span><span class="ident" id="4389796">ObjectIdentifier</span><span class="op" id="4389812">,</span>&nbsp;<span class="builtintype" id="4389814">bool</span><span class="op" id="4389818">)</span>&nbsp;<span class="op" id="4389820">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4389823">switch</span>&nbsp;<span class="ident" id="4389830">curve</span>&nbsp;<span class="op" id="4389836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4389839">case</span>&nbsp;<span class="ident" id="4389844">elliptic</span><span class="op" id="4389852">.</span><span class="ident" id="4389853">P224</span><span class="op" id="4389857">(</span><span class="op" id="4389858">)</span><span class="op" id="4389859">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4389863">return</span>&nbsp;<span class="ident" id="4389870">oidNamedCurveP224</span><span class="op" id="4389887">,</span>&nbsp;<span class="builtintype" id="4389889">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4389895">case</span>&nbsp;<span class="ident" id="4389900">elliptic</span><span class="op" id="4389908">.</span><span class="ident" id="4389909">P256</span><span class="op" id="4389913">(</span><span class="op" id="4389914">)</span><span class="op" id="4389915">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4389919">return</span>&nbsp;<span class="ident" id="4389926">oidNamedCurveP256</span><span class="op" id="4389943">,</span>&nbsp;<span class="builtintype" id="4389945">true</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4389951">case</span>&nbsp;<span class="ident" id="4389956">elliptic</span><span class="op" id="4389964">.</span><span class="ident" id="4389965">P384</span><span class="op" id="4389969">(</span><span class="op" id="4389970">)</span><span class="op" id="4389971">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4389975">return</span>&nbsp;<span class="ident" id="4389982">oidNamedCurveP384</span><span class="op" id="4389999">,</span>&nbsp;<span class="builtintype" id="4390001">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4390007">case</span>&nbsp;<span class="ident" id="4390012">elliptic</span><span class="op" id="4390020">.</span><span class="ident" id="4390021">P521</span><span class="op" id="4390025">(</span><span class="op" id="4390026">)</span><span class="op" id="4390027">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4390031">return</span>&nbsp;<span class="ident" id="4390038">oidNamedCurveP521</span><span class="op" id="4390055">,</span>&nbsp;<span class="builtintype" id="4390057">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4390063">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4390067">return</span>&nbsp;<span class="builtintype" id="4390074">nil</span><span class="op" id="4390077">,</span>&nbsp;<span class="builtintype" id="4390079">false</span><br>
<span class="lineno"></span><span class="op" id="4390085">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4390088">//&nbsp;KeyUsage&nbsp;represents&nbsp;the&nbsp;set&nbsp;of&nbsp;actions&nbsp;that&nbsp;are&nbsp;valid&nbsp;for&nbsp;a&nbsp;given&nbsp;key.&nbsp;It&#39;s</span><br>
<span class="lineno">360</span><span class="comment" id="4390167">//&nbsp;a&nbsp;bitmap&nbsp;of&nbsp;the&nbsp;KeyUsage*&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="4390207">type</span>&nbsp;<span class="ident" id="4390212">KeyUsage</span>&nbsp;<span class="builtintype" id="4390221">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4390226">const</span>&nbsp;<span class="op" id="4390232">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4390235">KeyUsageDigitalSignature</span>&nbsp;<span class="ident" id="4390260">KeyUsage</span>&nbsp;<span class="op" id="4390269">=</span>&nbsp;<span class="num" id="4390271">1</span>&nbsp;<span class="op" id="4390273">&lt;&lt;</span>&nbsp;<span class="ident" id="4390276">iota</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4390282">KeyUsageContentCommitment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4390309">KeyUsageKeyEncipherment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4390334">KeyUsageDataEncipherment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4390360">KeyUsageKeyAgreement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4390382">KeyUsageCertSign</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4390400">KeyUsageCRLSign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4390417">KeyUsageEncipherOnly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4390439">KeyUsageDecipherOnly</span><br>
<span class="lineno"></span><span class="op" id="4390460">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="4390463">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.12&nbsp;&nbsp;Extended&nbsp;Key&nbsp;Usage</span><br>
<span class="lineno"></span><span class="comment" id="4390505">//</span><br>
<span class="lineno"></span><span class="comment" id="4390508">//&nbsp;anyExtendedKeyUsage&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-ce-extKeyUsage&nbsp;0&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4390577">//</span><br>
<span class="lineno"></span><span class="comment" id="4390580">//&nbsp;id-kp&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-pkix&nbsp;3&nbsp;}</span><br>
<span class="lineno">380</span><span class="comment" id="4390625">//</span><br>
<span class="lineno"></span><span class="comment" id="4390628">//&nbsp;id-kp-serverAuth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4390694">//&nbsp;id-kp-clientAuth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;2&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4390760">//&nbsp;id-kp-codeSigning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4390826">//&nbsp;id-kp-emailProtection&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;4&nbsp;}</span><br>
<span class="lineno">385</span><span class="comment" id="4390892">//&nbsp;id-kp-timeStamping&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;8&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4390958">//&nbsp;id-kp-OCSPSigning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;9&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="4391024">var</span>&nbsp;<span class="op" id="4391028">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391031">oidExtKeyUsageAny</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4391072">=</span>&nbsp;<span class="ident" id="4391074">asn1</span><span class="op" id="4391078">.</span><span class="ident" id="4391079">ObjectIdentifier</span><span class="op" id="4391095">{</span><span class="num" id="4391096">2</span><span class="op" id="4391097">,</span>&nbsp;<span class="num" id="4391099">5</span><span class="op" id="4391100">,</span>&nbsp;<span class="num" id="4391102">29</span><span class="op" id="4391104">,</span>&nbsp;<span class="num" id="4391106">37</span><span class="op" id="4391108">,</span>&nbsp;<span class="num" id="4391110">0</span><span class="op" id="4391111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391114">oidExtKeyUsageServerAuth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4391155">=</span>&nbsp;<span class="ident" id="4391157">asn1</span><span class="op" id="4391161">.</span><span class="ident" id="4391162">ObjectIdentifier</span><span class="op" id="4391178">{</span><span class="num" id="4391179">1</span><span class="op" id="4391180">,</span>&nbsp;<span class="num" id="4391182">3</span><span class="op" id="4391183">,</span>&nbsp;<span class="num" id="4391185">6</span><span class="op" id="4391186">,</span>&nbsp;<span class="num" id="4391188">1</span><span class="op" id="4391189">,</span>&nbsp;<span class="num" id="4391191">5</span><span class="op" id="4391192">,</span>&nbsp;<span class="num" id="4391194">5</span><span class="op" id="4391195">,</span>&nbsp;<span class="num" id="4391197">7</span><span class="op" id="4391198">,</span>&nbsp;<span class="num" id="4391200">3</span><span class="op" id="4391201">,</span>&nbsp;<span class="num" id="4391203">1</span><span class="op" id="4391204">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391207">oidExtKeyUsageClientAuth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4391248">=</span>&nbsp;<span class="ident" id="4391250">asn1</span><span class="op" id="4391254">.</span><span class="ident" id="4391255">ObjectIdentifier</span><span class="op" id="4391271">{</span><span class="num" id="4391272">1</span><span class="op" id="4391273">,</span>&nbsp;<span class="num" id="4391275">3</span><span class="op" id="4391276">,</span>&nbsp;<span class="num" id="4391278">6</span><span class="op" id="4391279">,</span>&nbsp;<span class="num" id="4391281">1</span><span class="op" id="4391282">,</span>&nbsp;<span class="num" id="4391284">5</span><span class="op" id="4391285">,</span>&nbsp;<span class="num" id="4391287">5</span><span class="op" id="4391288">,</span>&nbsp;<span class="num" id="4391290">7</span><span class="op" id="4391291">,</span>&nbsp;<span class="num" id="4391293">3</span><span class="op" id="4391294">,</span>&nbsp;<span class="num" id="4391296">2</span><span class="op" id="4391297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391300">oidExtKeyUsageCodeSigning</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4391341">=</span>&nbsp;<span class="ident" id="4391343">asn1</span><span class="op" id="4391347">.</span><span class="ident" id="4391348">ObjectIdentifier</span><span class="op" id="4391364">{</span><span class="num" id="4391365">1</span><span class="op" id="4391366">,</span>&nbsp;<span class="num" id="4391368">3</span><span class="op" id="4391369">,</span>&nbsp;<span class="num" id="4391371">6</span><span class="op" id="4391372">,</span>&nbsp;<span class="num" id="4391374">1</span><span class="op" id="4391375">,</span>&nbsp;<span class="num" id="4391377">5</span><span class="op" id="4391378">,</span>&nbsp;<span class="num" id="4391380">5</span><span class="op" id="4391381">,</span>&nbsp;<span class="num" id="4391383">7</span><span class="op" id="4391384">,</span>&nbsp;<span class="num" id="4391386">3</span><span class="op" id="4391387">,</span>&nbsp;<span class="num" id="4391389">3</span><span class="op" id="4391390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391393">oidExtKeyUsageEmailProtection</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4391434">=</span>&nbsp;<span class="ident" id="4391436">asn1</span><span class="op" id="4391440">.</span><span class="ident" id="4391441">ObjectIdentifier</span><span class="op" id="4391457">{</span><span class="num" id="4391458">1</span><span class="op" id="4391459">,</span>&nbsp;<span class="num" id="4391461">3</span><span class="op" id="4391462">,</span>&nbsp;<span class="num" id="4391464">6</span><span class="op" id="4391465">,</span>&nbsp;<span class="num" id="4391467">1</span><span class="op" id="4391468">,</span>&nbsp;<span class="num" id="4391470">5</span><span class="op" id="4391471">,</span>&nbsp;<span class="num" id="4391473">5</span><span class="op" id="4391474">,</span>&nbsp;<span class="num" id="4391476">7</span><span class="op" id="4391477">,</span>&nbsp;<span class="num" id="4391479">3</span><span class="op" id="4391480">,</span>&nbsp;<span class="num" id="4391482">4</span><span class="op" id="4391483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391486">oidExtKeyUsageIPSECEndSystem</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4391527">=</span>&nbsp;<span class="ident" id="4391529">asn1</span><span class="op" id="4391533">.</span><span class="ident" id="4391534">ObjectIdentifier</span><span class="op" id="4391550">{</span><span class="num" id="4391551">1</span><span class="op" id="4391552">,</span>&nbsp;<span class="num" id="4391554">3</span><span class="op" id="4391555">,</span>&nbsp;<span class="num" id="4391557">6</span><span class="op" id="4391558">,</span>&nbsp;<span class="num" id="4391560">1</span><span class="op" id="4391561">,</span>&nbsp;<span class="num" id="4391563">5</span><span class="op" id="4391564">,</span>&nbsp;<span class="num" id="4391566">5</span><span class="op" id="4391567">,</span>&nbsp;<span class="num" id="4391569">7</span><span class="op" id="4391570">,</span>&nbsp;<span class="num" id="4391572">3</span><span class="op" id="4391573">,</span>&nbsp;<span class="num" id="4391575">5</span><span class="op" id="4391576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391579">oidExtKeyUsageIPSECTunnel</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4391620">=</span>&nbsp;<span class="ident" id="4391622">asn1</span><span class="op" id="4391626">.</span><span class="ident" id="4391627">ObjectIdentifier</span><span class="op" id="4391643">{</span><span class="num" id="4391644">1</span><span class="op" id="4391645">,</span>&nbsp;<span class="num" id="4391647">3</span><span class="op" id="4391648">,</span>&nbsp;<span class="num" id="4391650">6</span><span class="op" id="4391651">,</span>&nbsp;<span class="num" id="4391653">1</span><span class="op" id="4391654">,</span>&nbsp;<span class="num" id="4391656">5</span><span class="op" id="4391657">,</span>&nbsp;<span class="num" id="4391659">5</span><span class="op" id="4391660">,</span>&nbsp;<span class="num" id="4391662">7</span><span class="op" id="4391663">,</span>&nbsp;<span class="num" id="4391665">3</span><span class="op" id="4391666">,</span>&nbsp;<span class="num" id="4391668">6</span><span class="op" id="4391669">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391672">oidExtKeyUsageIPSECUser</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4391713">=</span>&nbsp;<span class="ident" id="4391715">asn1</span><span class="op" id="4391719">.</span><span class="ident" id="4391720">ObjectIdentifier</span><span class="op" id="4391736">{</span><span class="num" id="4391737">1</span><span class="op" id="4391738">,</span>&nbsp;<span class="num" id="4391740">3</span><span class="op" id="4391741">,</span>&nbsp;<span class="num" id="4391743">6</span><span class="op" id="4391744">,</span>&nbsp;<span class="num" id="4391746">1</span><span class="op" id="4391747">,</span>&nbsp;<span class="num" id="4391749">5</span><span class="op" id="4391750">,</span>&nbsp;<span class="num" id="4391752">5</span><span class="op" id="4391753">,</span>&nbsp;<span class="num" id="4391755">7</span><span class="op" id="4391756">,</span>&nbsp;<span class="num" id="4391758">3</span><span class="op" id="4391759">,</span>&nbsp;<span class="num" id="4391761">7</span><span class="op" id="4391762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391765">oidExtKeyUsageTimeStamping</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4391806">=</span>&nbsp;<span class="ident" id="4391808">asn1</span><span class="op" id="4391812">.</span><span class="ident" id="4391813">ObjectIdentifier</span><span class="op" id="4391829">{</span><span class="num" id="4391830">1</span><span class="op" id="4391831">,</span>&nbsp;<span class="num" id="4391833">3</span><span class="op" id="4391834">,</span>&nbsp;<span class="num" id="4391836">6</span><span class="op" id="4391837">,</span>&nbsp;<span class="num" id="4391839">1</span><span class="op" id="4391840">,</span>&nbsp;<span class="num" id="4391842">5</span><span class="op" id="4391843">,</span>&nbsp;<span class="num" id="4391845">5</span><span class="op" id="4391846">,</span>&nbsp;<span class="num" id="4391848">7</span><span class="op" id="4391849">,</span>&nbsp;<span class="num" id="4391851">3</span><span class="op" id="4391852">,</span>&nbsp;<span class="num" id="4391854">8</span><span class="op" id="4391855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391858">oidExtKeyUsageOCSPSigning</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4391899">=</span>&nbsp;<span class="ident" id="4391901">asn1</span><span class="op" id="4391905">.</span><span class="ident" id="4391906">ObjectIdentifier</span><span class="op" id="4391922">{</span><span class="num" id="4391923">1</span><span class="op" id="4391924">,</span>&nbsp;<span class="num" id="4391926">3</span><span class="op" id="4391927">,</span>&nbsp;<span class="num" id="4391929">6</span><span class="op" id="4391930">,</span>&nbsp;<span class="num" id="4391932">1</span><span class="op" id="4391933">,</span>&nbsp;<span class="num" id="4391935">5</span><span class="op" id="4391936">,</span>&nbsp;<span class="num" id="4391938">5</span><span class="op" id="4391939">,</span>&nbsp;<span class="num" id="4391941">7</span><span class="op" id="4391942">,</span>&nbsp;<span class="num" id="4391944">3</span><span class="op" id="4391945">,</span>&nbsp;<span class="num" id="4391947">9</span><span class="op" id="4391948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391951">oidExtKeyUsageMicrosoftServerGatedCrypto</span>&nbsp;<span class="op" id="4391992">=</span>&nbsp;<span class="ident" id="4391994">asn1</span><span class="op" id="4391998">.</span><span class="ident" id="4391999">ObjectIdentifier</span><span class="op" id="4392015">{</span><span class="num" id="4392016">1</span><span class="op" id="4392017">,</span>&nbsp;<span class="num" id="4392019">3</span><span class="op" id="4392020">,</span>&nbsp;<span class="num" id="4392022">6</span><span class="op" id="4392023">,</span>&nbsp;<span class="num" id="4392025">1</span><span class="op" id="4392026">,</span>&nbsp;<span class="num" id="4392028">4</span><span class="op" id="4392029">,</span>&nbsp;<span class="num" id="4392031">1</span><span class="op" id="4392032">,</span>&nbsp;<span class="num" id="4392034">311</span><span class="op" id="4392037">,</span>&nbsp;<span class="num" id="4392039">10</span><span class="op" id="4392041">,</span>&nbsp;<span class="num" id="4392043">3</span><span class="op" id="4392044">,</span>&nbsp;<span class="num" id="4392046">3</span><span class="op" id="4392047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392050">oidExtKeyUsageNetscapeServerGatedCrypto</span>&nbsp;&nbsp;<span class="op" id="4392091">=</span>&nbsp;<span class="ident" id="4392093">asn1</span><span class="op" id="4392097">.</span><span class="ident" id="4392098">ObjectIdentifier</span><span class="op" id="4392114">{</span><span class="num" id="4392115">2</span><span class="op" id="4392116">,</span>&nbsp;<span class="num" id="4392118">16</span><span class="op" id="4392120">,</span>&nbsp;<span class="num" id="4392122">840</span><span class="op" id="4392125">,</span>&nbsp;<span class="num" id="4392127">1</span><span class="op" id="4392128">,</span>&nbsp;<span class="num" id="4392130">113730</span><span class="op" id="4392136">,</span>&nbsp;<span class="num" id="4392138">4</span><span class="op" id="4392139">,</span>&nbsp;<span class="num" id="4392141">1</span><span class="op" id="4392142">}</span><br>
<span class="lineno">400</span><span class="op" id="4392144">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4392147">//&nbsp;ExtKeyUsage&nbsp;represents&nbsp;an&nbsp;extended&nbsp;set&nbsp;of&nbsp;actions&nbsp;that&nbsp;are&nbsp;valid&nbsp;for&nbsp;a&nbsp;given&nbsp;key.</span><br>
<span class="lineno"></span><span class="comment" id="4392232">//&nbsp;Each&nbsp;of&nbsp;the&nbsp;ExtKeyUsage*&nbsp;constants&nbsp;define&nbsp;a&nbsp;unique&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="4392294">type</span>&nbsp;<span class="ident" id="4392299">ExtKeyUsage</span>&nbsp;<span class="builtintype" id="4392311">int</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="keyword" id="4392316">const</span>&nbsp;<span class="op" id="4392322">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392325">ExtKeyUsageAny</span>&nbsp;<span class="ident" id="4392340">ExtKeyUsage</span>&nbsp;<span class="op" id="4392352">=</span>&nbsp;<span class="ident" id="4392354">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392360">ExtKeyUsageServerAuth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392383">ExtKeyUsageClientAuth</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392406">ExtKeyUsageCodeSigning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392430">ExtKeyUsageEmailProtection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392458">ExtKeyUsageIPSECEndSystem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392485">ExtKeyUsageIPSECTunnel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392509">ExtKeyUsageIPSECUser</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392531">ExtKeyUsageTimeStamping</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392556">ExtKeyUsageOCSPSigning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392580">ExtKeyUsageMicrosoftServerGatedCrypto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392619">ExtKeyUsageNetscapeServerGatedCrypto</span><br>
<span class="lineno"></span><span class="op" id="4392656">)</span><br>
<span class="lineno">420</span><br>
<span class="lineno"></span><span class="comment" id="4392659">//&nbsp;extKeyUsageOIDs&nbsp;contains&nbsp;the&nbsp;mapping&nbsp;between&nbsp;an&nbsp;ExtKeyUsage&nbsp;and&nbsp;its&nbsp;OID.</span><br>
<span class="lineno"></span><span class="keyword" id="4392735">var</span>&nbsp;<span class="ident" id="4392739">extKeyUsageOIDs</span>&nbsp;<span class="op" id="4392755">=</span>&nbsp;<span class="op" id="4392757">[</span><span class="op" id="4392758">]</span><span class="keyword" id="4392759">struct</span>&nbsp;<span class="op" id="4392766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392769">extKeyUsage</span>&nbsp;<span class="ident" id="4392781">ExtKeyUsage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392794">oid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392806">asn1</span><span class="op" id="4392810">.</span><span class="ident" id="4392811">ObjectIdentifier</span><br>
<span class="lineno">425</span><span class="op" id="4392828">}</span><span class="op" id="4392829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4392832">{</span><span class="ident" id="4392833">ExtKeyUsageAny</span><span class="op" id="4392847">,</span>&nbsp;<span class="ident" id="4392849">oidExtKeyUsageAny</span><span class="op" id="4392866">}</span><span class="op" id="4392867">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4392870">{</span><span class="ident" id="4392871">ExtKeyUsageServerAuth</span><span class="op" id="4392892">,</span>&nbsp;<span class="ident" id="4392894">oidExtKeyUsageServerAuth</span><span class="op" id="4392918">}</span><span class="op" id="4392919">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4392922">{</span><span class="ident" id="4392923">ExtKeyUsageClientAuth</span><span class="op" id="4392944">,</span>&nbsp;<span class="ident" id="4392946">oidExtKeyUsageClientAuth</span><span class="op" id="4392970">}</span><span class="op" id="4392971">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4392974">{</span><span class="ident" id="4392975">ExtKeyUsageCodeSigning</span><span class="op" id="4392997">,</span>&nbsp;<span class="ident" id="4392999">oidExtKeyUsageCodeSigning</span><span class="op" id="4393024">}</span><span class="op" id="4393025">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4393028">{</span><span class="ident" id="4393029">ExtKeyUsageEmailProtection</span><span class="op" id="4393055">,</span>&nbsp;<span class="ident" id="4393057">oidExtKeyUsageEmailProtection</span><span class="op" id="4393086">}</span><span class="op" id="4393087">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4393090">{</span><span class="ident" id="4393091">ExtKeyUsageIPSECEndSystem</span><span class="op" id="4393116">,</span>&nbsp;<span class="ident" id="4393118">oidExtKeyUsageIPSECEndSystem</span><span class="op" id="4393146">}</span><span class="op" id="4393147">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4393150">{</span><span class="ident" id="4393151">ExtKeyUsageIPSECTunnel</span><span class="op" id="4393173">,</span>&nbsp;<span class="ident" id="4393175">oidExtKeyUsageIPSECTunnel</span><span class="op" id="4393200">}</span><span class="op" id="4393201">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4393204">{</span><span class="ident" id="4393205">ExtKeyUsageIPSECUser</span><span class="op" id="4393225">,</span>&nbsp;<span class="ident" id="4393227">oidExtKeyUsageIPSECUser</span><span class="op" id="4393250">}</span><span class="op" id="4393251">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4393254">{</span><span class="ident" id="4393255">ExtKeyUsageTimeStamping</span><span class="op" id="4393278">,</span>&nbsp;<span class="ident" id="4393280">oidExtKeyUsageTimeStamping</span><span class="op" id="4393306">}</span><span class="op" id="4393307">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4393310">{</span><span class="ident" id="4393311">ExtKeyUsageOCSPSigning</span><span class="op" id="4393333">,</span>&nbsp;<span class="ident" id="4393335">oidExtKeyUsageOCSPSigning</span><span class="op" id="4393360">}</span><span class="op" id="4393361">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4393364">{</span><span class="ident" id="4393365">ExtKeyUsageMicrosoftServerGatedCrypto</span><span class="op" id="4393402">,</span>&nbsp;<span class="ident" id="4393404">oidExtKeyUsageMicrosoftServerGatedCrypto</span><span class="op" id="4393444">}</span><span class="op" id="4393445">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4393448">{</span><span class="ident" id="4393449">ExtKeyUsageNetscapeServerGatedCrypto</span><span class="op" id="4393485">,</span>&nbsp;<span class="ident" id="4393487">oidExtKeyUsageNetscapeServerGatedCrypto</span><span class="op" id="4393526">}</span><span class="op" id="4393527">,</span><br>
<span class="lineno"></span><span class="op" id="4393529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="keyword" id="4393532">func</span>&nbsp;<span class="ident" id="4393537">extKeyUsageFromOID</span><span class="op" id="4393555">(</span><span class="ident" id="4393556">oid</span>&nbsp;<span class="ident" id="4393560">asn1</span><span class="op" id="4393564">.</span><span class="ident" id="4393565">ObjectIdentifier</span><span class="op" id="4393581">)</span>&nbsp;<span class="op" id="4393583">(</span><span class="ident" id="4393584">eku</span>&nbsp;<span class="ident" id="4393588">ExtKeyUsage</span><span class="op" id="4393599">,</span>&nbsp;<span class="ident" id="4393601">ok</span>&nbsp;<span class="builtintype" id="4393604">bool</span><span class="op" id="4393608">)</span>&nbsp;<span class="op" id="4393610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4393613">for</span>&nbsp;<span class="ident" id="4393617">_</span><span class="op" id="4393618">,</span>&nbsp;<span class="ident" id="4393620">pair</span>&nbsp;<span class="op" id="4393625">:=</span>&nbsp;<span class="keyword" id="4393628">range</span>&nbsp;<span class="ident" id="4393634">extKeyUsageOIDs</span>&nbsp;<span class="op" id="4393650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4393654">if</span>&nbsp;<span class="ident" id="4393657">oid</span><span class="op" id="4393660">.</span><span class="ident" id="4393661">Equal</span><span class="op" id="4393666">(</span><span class="ident" id="4393667">pair</span><span class="op" id="4393671">.</span><span class="ident" id="4393672">oid</span><span class="op" id="4393675">)</span>&nbsp;<span class="op" id="4393677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4393682">return</span>&nbsp;<span class="ident" id="4393689">pair</span><span class="op" id="4393693">.</span><span class="ident" id="4393694">extKeyUsage</span><span class="op" id="4393705">,</span>&nbsp;<span class="builtintype" id="4393707">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4393714">}</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4393717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4393720">return</span><br>
<span class="lineno"></span><span class="op" id="4393727">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4393730">func</span>&nbsp;<span class="ident" id="4393735">oidFromExtKeyUsage</span><span class="op" id="4393753">(</span><span class="ident" id="4393754">eku</span>&nbsp;<span class="ident" id="4393758">ExtKeyUsage</span><span class="op" id="4393769">)</span>&nbsp;<span class="op" id="4393771">(</span><span class="ident" id="4393772">oid</span>&nbsp;<span class="ident" id="4393776">asn1</span><span class="op" id="4393780">.</span><span class="ident" id="4393781">ObjectIdentifier</span><span class="op" id="4393797">,</span>&nbsp;<span class="ident" id="4393799">ok</span>&nbsp;<span class="builtintype" id="4393802">bool</span><span class="op" id="4393806">)</span>&nbsp;<span class="op" id="4393808">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4393811">for</span>&nbsp;<span class="ident" id="4393815">_</span><span class="op" id="4393816">,</span>&nbsp;<span class="ident" id="4393818">pair</span>&nbsp;<span class="op" id="4393823">:=</span>&nbsp;<span class="keyword" id="4393826">range</span>&nbsp;<span class="ident" id="4393832">extKeyUsageOIDs</span>&nbsp;<span class="op" id="4393848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4393852">if</span>&nbsp;<span class="ident" id="4393855">eku</span>&nbsp;<span class="op" id="4393859">==</span>&nbsp;<span class="ident" id="4393862">pair</span><span class="op" id="4393866">.</span><span class="ident" id="4393867">extKeyUsage</span>&nbsp;<span class="op" id="4393879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4393884">return</span>&nbsp;<span class="ident" id="4393891">pair</span><span class="op" id="4393895">.</span><span class="ident" id="4393896">oid</span><span class="op" id="4393899">,</span>&nbsp;<span class="builtintype" id="4393901">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4393908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4393911">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4393914">return</span><br>
<span class="lineno"></span><span class="op" id="4393921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4393924">//&nbsp;A&nbsp;Certificate&nbsp;represents&nbsp;an&nbsp;X.509&nbsp;certificate.</span><br>
<span class="lineno"></span><span class="keyword" id="4393974">type</span>&nbsp;<span class="ident" id="4393979">Certificate</span>&nbsp;<span class="keyword" id="4393991">struct</span>&nbsp;<span class="op" id="4393998">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394001">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4394025">[</span><span class="op" id="4394026">]</span><span class="builtintype" id="4394027">byte</span>&nbsp;<span class="comment" id="4394032">//&nbsp;Complete&nbsp;ASN.1&nbsp;DER&nbsp;content&nbsp;(certificate,&nbsp;signature&nbsp;algorithm&nbsp;and&nbsp;signature).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394113">RawTBSCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4394137">[</span><span class="op" id="4394138">]</span><span class="builtintype" id="4394139">byte</span>&nbsp;<span class="comment" id="4394144">//&nbsp;Certificate&nbsp;part&nbsp;of&nbsp;raw&nbsp;ASN.1&nbsp;DER&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394191">RawSubjectPublicKeyInfo</span>&nbsp;<span class="op" id="4394215">[</span><span class="op" id="4394216">]</span><span class="builtintype" id="4394217">byte</span>&nbsp;<span class="comment" id="4394222">//&nbsp;DER&nbsp;encoded&nbsp;SubjectPublicKeyInfo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394260">RawSubject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4394284">[</span><span class="op" id="4394285">]</span><span class="builtintype" id="4394286">byte</span>&nbsp;<span class="comment" id="4394291">//&nbsp;DER&nbsp;encoded&nbsp;Subject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394315">RawIssuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4394339">[</span><span class="op" id="4394340">]</span><span class="builtintype" id="4394341">byte</span>&nbsp;<span class="comment" id="4394346">//&nbsp;DER&nbsp;encoded&nbsp;Issuer</span><br>
<span class="lineno">465</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394370">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4394389">[</span><span class="op" id="4394390">]</span><span class="builtintype" id="4394391">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394397">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4394416">SignatureAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394437">PublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4394456">PublicKeyAlgorithm</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394476">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4394495">interface</span><span class="op" id="4394504">{</span><span class="op" id="4394505">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394509">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4394529">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394534">SerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4394554">*</span><span class="ident" id="4394555">big</span><span class="op" id="4394558">.</span><span class="ident" id="4394559">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394564">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394584">pkix</span><span class="op" id="4394588">.</span><span class="ident" id="4394589">Name</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394595">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394615">pkix</span><span class="op" id="4394619">.</span><span class="ident" id="4394620">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394626">NotBefore</span><span class="op" id="4394635">,</span>&nbsp;<span class="ident" id="4394637">NotAfter</span>&nbsp;<span class="ident" id="4394646">time</span><span class="op" id="4394650">.</span><span class="ident" id="4394651">Time</span>&nbsp;<span class="comment" id="4394656">//&nbsp;Validity&nbsp;bounds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394677">KeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394697">KeyUsage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4394708">//&nbsp;Extensions&nbsp;contains&nbsp;raw&nbsp;X.509&nbsp;extensions.&nbsp;When&nbsp;parsing&nbsp;certificates,</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4394781">//&nbsp;this&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;non-critical&nbsp;extensions&nbsp;that&nbsp;are&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4394850">//&nbsp;parsed&nbsp;by&nbsp;this&nbsp;package.&nbsp;When&nbsp;marshaling&nbsp;certificates,&nbsp;the&nbsp;Extensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4394923">//&nbsp;field&nbsp;is&nbsp;ignored,&nbsp;see&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394966">Extensions</span>&nbsp;<span class="op" id="4394977">[</span><span class="op" id="4394978">]</span><span class="ident" id="4394979">pkix</span><span class="op" id="4394983">.</span><span class="ident" id="4394984">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4394996">//&nbsp;ExtraExtensions&nbsp;contains&nbsp;extensions&nbsp;to&nbsp;be&nbsp;copied,&nbsp;raw,&nbsp;into&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4395064">//&nbsp;marshaled&nbsp;certificates.&nbsp;Values&nbsp;override&nbsp;any&nbsp;extensions&nbsp;that&nbsp;would</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4395134">//&nbsp;otherwise&nbsp;be&nbsp;produced&nbsp;based&nbsp;on&nbsp;the&nbsp;other&nbsp;fields.&nbsp;The&nbsp;ExtraExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4395207">//&nbsp;field&nbsp;is&nbsp;not&nbsp;populated&nbsp;when&nbsp;parsing&nbsp;certificates,&nbsp;see&nbsp;Extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4395277">ExtraExtensions</span>&nbsp;<span class="op" id="4395293">[</span><span class="op" id="4395294">]</span><span class="ident" id="4395295">pkix</span><span class="op" id="4395299">.</span><span class="ident" id="4395300">Extension</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4395312">ExtKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4395331">[</span><span class="op" id="4395332">]</span><span class="ident" id="4395333">ExtKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4395355">//&nbsp;Sequence&nbsp;of&nbsp;extended&nbsp;key&nbsp;usages.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4395392">UnknownExtKeyUsage</span>&nbsp;<span class="op" id="4395411">[</span><span class="op" id="4395412">]</span><span class="ident" id="4395413">asn1</span><span class="op" id="4395417">.</span><span class="ident" id="4395418">ObjectIdentifier</span>&nbsp;<span class="comment" id="4395435">//&nbsp;Encountered&nbsp;extended&nbsp;key&nbsp;usages&nbsp;unknown&nbsp;to&nbsp;this&nbsp;package.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4395497">BasicConstraintsValid</span>&nbsp;<span class="builtintype" id="4395519">bool</span>&nbsp;<span class="comment" id="4395524">//&nbsp;if&nbsp;true&nbsp;then&nbsp;the&nbsp;next&nbsp;two&nbsp;fields&nbsp;are&nbsp;valid.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4395572">IsCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4395594">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4395600">MaxPathLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4395622">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4395627">//&nbsp;MaxPathLenZero&nbsp;indicates&nbsp;that&nbsp;BasicConstraintsValid==true&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4395693">//&nbsp;MaxPathLen==0&nbsp;should&nbsp;be&nbsp;interpreted&nbsp;as&nbsp;an&nbsp;actual&nbsp;maximum&nbsp;path&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4395766">//&nbsp;of&nbsp;zero.&nbsp;Otherwise,&nbsp;that&nbsp;combination&nbsp;is&nbsp;interpreted&nbsp;as&nbsp;MaxPathLen</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4395836">//&nbsp;not&nbsp;being&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4395855">MaxPathLenZero</span>&nbsp;<span class="builtintype" id="4395870">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4395877">SubjectKeyId</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4395892">[</span><span class="op" id="4395893">]</span><span class="builtintype" id="4395894">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4395900">AuthorityKeyId</span>&nbsp;<span class="op" id="4395915">[</span><span class="op" id="4395916">]</span><span class="builtintype" id="4395917">byte</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4395924">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.2.1&nbsp;(Authority&nbsp;Information&nbsp;Access)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4395977">OCSPServer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4395999">[</span><span class="op" id="4396000">]</span><span class="builtintype" id="4396001">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396009">IssuingCertificateURL</span>&nbsp;<span class="op" id="4396031">[</span><span class="op" id="4396032">]</span><span class="builtintype" id="4396033">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4396042">//&nbsp;Subject&nbsp;Alternate&nbsp;Name&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396076">DNSNames</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4396091">[</span><span class="op" id="4396092">]</span><span class="builtintype" id="4396093">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396101">EmailAddresses</span>&nbsp;<span class="op" id="4396116">[</span><span class="op" id="4396117">]</span><span class="builtintype" id="4396118">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396126">IPAddresses</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4396141">[</span><span class="op" id="4396142">]</span><span class="ident" id="4396143">net</span><span class="op" id="4396146">.</span><span class="ident" id="4396147">IP</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4396152">//&nbsp;Name&nbsp;constraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396173">PermittedDNSDomainsCritical</span>&nbsp;<span class="builtintype" id="4396201">bool</span>&nbsp;<span class="comment" id="4396206">//&nbsp;if&nbsp;true&nbsp;then&nbsp;the&nbsp;name&nbsp;constraints&nbsp;are&nbsp;marked&nbsp;critical.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396265">PermittedDNSDomains</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4396293">[</span><span class="op" id="4396294">]</span><span class="builtintype" id="4396295">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4396304">//&nbsp;CRL&nbsp;Distribution&nbsp;Points</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396332">CRLDistributionPoints</span>&nbsp;<span class="op" id="4396354">[</span><span class="op" id="4396355">]</span><span class="builtintype" id="4396356">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396365">PolicyIdentifiers</span>&nbsp;<span class="op" id="4396383">[</span><span class="op" id="4396384">]</span><span class="ident" id="4396385">asn1</span><span class="op" id="4396389">.</span><span class="ident" id="4396390">ObjectIdentifier</span><br>
<span class="lineno"></span><span class="op" id="4396407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="4396410">//&nbsp;ErrUnsupportedAlgorithm&nbsp;results&nbsp;from&nbsp;attempting&nbsp;to&nbsp;perform&nbsp;an&nbsp;operation&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4396490">//&nbsp;involves&nbsp;algorithms&nbsp;that&nbsp;are&nbsp;not&nbsp;currently&nbsp;implemented.</span><br>
<span class="lineno"></span><span class="keyword" id="4396549">var</span>&nbsp;<span class="ident" id="4396553">ErrUnsupportedAlgorithm</span>&nbsp;<span class="op" id="4396577">=</span>&nbsp;<span class="ident" id="4396579">errors</span><span class="op" id="4396585">.</span><span class="ident" id="4396586">New</span><span class="op" id="4396589">(</span><span class="string" id="4396590">&#34;x509:&nbsp;cannot&nbsp;verify&nbsp;signature:&nbsp;algorithm&nbsp;unimplemented&#34;</span><span class="op" id="4396646">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4396649">//&nbsp;ConstraintViolationError&nbsp;results&nbsp;when&nbsp;a&nbsp;requested&nbsp;usage&nbsp;is&nbsp;not&nbsp;permitted&nbsp;by</span><br>
<span class="lineno">530</span><span class="comment" id="4396728">//&nbsp;a&nbsp;certificate.&nbsp;For&nbsp;example:&nbsp;checking&nbsp;a&nbsp;signature&nbsp;when&nbsp;the&nbsp;public&nbsp;key&nbsp;isn&#39;t&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4396808">//&nbsp;certificate&nbsp;signing&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4396836">type</span>&nbsp;<span class="ident" id="4396841">ConstraintViolationError</span>&nbsp;<span class="keyword" id="4396866">struct</span><span class="op" id="4396872">{</span><span class="op" id="4396873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4396876">func</span>&nbsp;<span class="op" id="4396881">(</span><span class="ident" id="4396882">ConstraintViolationError</span><span class="op" id="4396906">)</span>&nbsp;<span class="ident" id="4396908">Error</span><span class="op" id="4396913">(</span><span class="op" id="4396914">)</span>&nbsp;<span class="builtintype" id="4396916">string</span>&nbsp;<span class="op" id="4396923">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4396926">return</span>&nbsp;<span class="string" id="4396933">&#34;x509:&nbsp;invalid&nbsp;signature:&nbsp;parent&nbsp;certificate&nbsp;cannot&nbsp;sign&nbsp;this&nbsp;kind&nbsp;of&nbsp;certificate&#34;</span><br>
<span class="lineno"></span><span class="op" id="4397016">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4397019">func</span>&nbsp;<span class="op" id="4397024">(</span><span class="ident" id="4397025">c</span>&nbsp;<span class="op" id="4397027">*</span><span class="ident" id="4397028">Certificate</span><span class="op" id="4397039">)</span>&nbsp;<span class="ident" id="4397041">Equal</span><span class="op" id="4397046">(</span><span class="ident" id="4397047">other</span>&nbsp;<span class="op" id="4397053">*</span><span class="ident" id="4397054">Certificate</span><span class="op" id="4397065">)</span>&nbsp;<span class="builtintype" id="4397067">bool</span>&nbsp;<span class="op" id="4397072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4397075">return</span>&nbsp;<span class="ident" id="4397082">bytes</span><span class="op" id="4397087">.</span><span class="ident" id="4397088">Equal</span><span class="op" id="4397093">(</span><span class="ident" id="4397094">c</span><span class="op" id="4397095">.</span><span class="ident" id="4397096">Raw</span><span class="op" id="4397099">,</span>&nbsp;<span class="ident" id="4397101">other</span><span class="op" id="4397106">.</span><span class="ident" id="4397107">Raw</span><span class="op" id="4397110">)</span><br>
<span class="lineno">540</span><span class="op" id="4397112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4397115">//&nbsp;Entrust&nbsp;have&nbsp;a&nbsp;broken&nbsp;root&nbsp;certificate&nbsp;(CN=Entrust.net&nbsp;Certification</span><br>
<span class="lineno"></span><span class="comment" id="4397187">//&nbsp;Authority&nbsp;(2048))&nbsp;which&nbsp;isn&#39;t&nbsp;marked&nbsp;as&nbsp;a&nbsp;CA&nbsp;certificate&nbsp;and&nbsp;is&nbsp;thus&nbsp;invalid</span><br>
<span class="lineno"></span><span class="comment" id="4397267">//&nbsp;according&nbsp;to&nbsp;PKIX.</span><br>
<span class="lineno">545</span><span class="comment" id="4397289">//&nbsp;We&nbsp;recognise&nbsp;this&nbsp;certificate&nbsp;by&nbsp;its&nbsp;SubjectPublicKeyInfo&nbsp;and&nbsp;exempt&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4397364">//&nbsp;from&nbsp;the&nbsp;Basic&nbsp;Constraints&nbsp;requirement.</span><br>
<span class="lineno"></span><span class="comment" id="4397407">//&nbsp;See&nbsp;http://www.entrust.net/knowledge-base/technote.cfm?tn=7869</span><br>
<span class="lineno"></span><span class="comment" id="4397473">//</span><br>
<span class="lineno"></span><span class="comment" id="4397476">//&nbsp;TODO(agl):&nbsp;remove&nbsp;this&nbsp;hack&nbsp;once&nbsp;their&nbsp;reissued&nbsp;root&nbsp;is&nbsp;sufficiently</span><br>
<span class="lineno">550</span><span class="comment" id="4397548">//&nbsp;widespread.</span><br>
<span class="lineno"></span><span class="keyword" id="4397563">var</span>&nbsp;<span class="ident" id="4397567">entrustBrokenSPKI</span>&nbsp;<span class="op" id="4397585">=</span>&nbsp;<span class="op" id="4397587">[</span><span class="op" id="4397588">]</span><span class="builtintype" id="4397589">byte</span><span class="op" id="4397593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4397596">0x30</span><span class="op" id="4397600">,</span>&nbsp;<span class="num" id="4397602">0x82</span><span class="op" id="4397606">,</span>&nbsp;<span class="num" id="4397608">0x01</span><span class="op" id="4397612">,</span>&nbsp;<span class="num" id="4397614">0x22</span><span class="op" id="4397618">,</span>&nbsp;<span class="num" id="4397620">0x30</span><span class="op" id="4397624">,</span>&nbsp;<span class="num" id="4397626">0x0d</span><span class="op" id="4397630">,</span>&nbsp;<span class="num" id="4397632">0x06</span><span class="op" id="4397636">,</span>&nbsp;<span class="num" id="4397638">0x09</span><span class="op" id="4397642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4397645">0x2a</span><span class="op" id="4397649">,</span>&nbsp;<span class="num" id="4397651">0x86</span><span class="op" id="4397655">,</span>&nbsp;<span class="num" id="4397657">0x48</span><span class="op" id="4397661">,</span>&nbsp;<span class="num" id="4397663">0x86</span><span class="op" id="4397667">,</span>&nbsp;<span class="num" id="4397669">0xf7</span><span class="op" id="4397673">,</span>&nbsp;<span class="num" id="4397675">0x0d</span><span class="op" id="4397679">,</span>&nbsp;<span class="num" id="4397681">0x01</span><span class="op" id="4397685">,</span>&nbsp;<span class="num" id="4397687">0x01</span><span class="op" id="4397691">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4397694">0x01</span><span class="op" id="4397698">,</span>&nbsp;<span class="num" id="4397700">0x05</span><span class="op" id="4397704">,</span>&nbsp;<span class="num" id="4397706">0x00</span><span class="op" id="4397710">,</span>&nbsp;<span class="num" id="4397712">0x03</span><span class="op" id="4397716">,</span>&nbsp;<span class="num" id="4397718">0x82</span><span class="op" id="4397722">,</span>&nbsp;<span class="num" id="4397724">0x01</span><span class="op" id="4397728">,</span>&nbsp;<span class="num" id="4397730">0x0f</span><span class="op" id="4397734">,</span>&nbsp;<span class="num" id="4397736">0x00</span><span class="op" id="4397740">,</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4397743">0x30</span><span class="op" id="4397747">,</span>&nbsp;<span class="num" id="4397749">0x82</span><span class="op" id="4397753">,</span>&nbsp;<span class="num" id="4397755">0x01</span><span class="op" id="4397759">,</span>&nbsp;<span class="num" id="4397761">0x0a</span><span class="op" id="4397765">,</span>&nbsp;<span class="num" id="4397767">0x02</span><span class="op" id="4397771">,</span>&nbsp;<span class="num" id="4397773">0x82</span><span class="op" id="4397777">,</span>&nbsp;<span class="num" id="4397779">0x01</span><span class="op" id="4397783">,</span>&nbsp;<span class="num" id="4397785">0x01</span><span class="op" id="4397789">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4397792">0x00</span><span class="op" id="4397796">,</span>&nbsp;<span class="num" id="4397798">0x97</span><span class="op" id="4397802">,</span>&nbsp;<span class="num" id="4397804">0xa3</span><span class="op" id="4397808">,</span>&nbsp;<span class="num" id="4397810">0x2d</span><span class="op" id="4397814">,</span>&nbsp;<span class="num" id="4397816">0x3c</span><span class="op" id="4397820">,</span>&nbsp;<span class="num" id="4397822">0x9e</span><span class="op" id="4397826">,</span>&nbsp;<span class="num" id="4397828">0xde</span><span class="op" id="4397832">,</span>&nbsp;<span class="num" id="4397834">0x05</span><span class="op" id="4397838">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4397841">0xda</span><span class="op" id="4397845">,</span>&nbsp;<span class="num" id="4397847">0x13</span><span class="op" id="4397851">,</span>&nbsp;<span class="num" id="4397853">0xc2</span><span class="op" id="4397857">,</span>&nbsp;<span class="num" id="4397859">0x11</span><span class="op" id="4397863">,</span>&nbsp;<span class="num" id="4397865">0x8d</span><span class="op" id="4397869">,</span>&nbsp;<span class="num" id="4397871">0x9d</span><span class="op" id="4397875">,</span>&nbsp;<span class="num" id="4397877">0x8e</span><span class="op" id="4397881">,</span>&nbsp;<span class="num" id="4397883">0xe3</span><span class="op" id="4397887">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4397890">0x7f</span><span class="op" id="4397894">,</span>&nbsp;<span class="num" id="4397896">0xc7</span><span class="op" id="4397900">,</span>&nbsp;<span class="num" id="4397902">0x4b</span><span class="op" id="4397906">,</span>&nbsp;<span class="num" id="4397908">0x7e</span><span class="op" id="4397912">,</span>&nbsp;<span class="num" id="4397914">0x5a</span><span class="op" id="4397918">,</span>&nbsp;<span class="num" id="4397920">0x9f</span><span class="op" id="4397924">,</span>&nbsp;<span class="num" id="4397926">0xb3</span><span class="op" id="4397930">,</span>&nbsp;<span class="num" id="4397932">0xff</span><span class="op" id="4397936">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4397939">0x62</span><span class="op" id="4397943">,</span>&nbsp;<span class="num" id="4397945">0xab</span><span class="op" id="4397949">,</span>&nbsp;<span class="num" id="4397951">0x73</span><span class="op" id="4397955">,</span>&nbsp;<span class="num" id="4397957">0xc8</span><span class="op" id="4397961">,</span>&nbsp;<span class="num" id="4397963">0x28</span><span class="op" id="4397967">,</span>&nbsp;<span class="num" id="4397969">0x6b</span><span class="op" id="4397973">,</span>&nbsp;<span class="num" id="4397975">0xba</span><span class="op" id="4397979">,</span>&nbsp;<span class="num" id="4397981">0x10</span><span class="op" id="4397985">,</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4397988">0x64</span><span class="op" id="4397992">,</span>&nbsp;<span class="num" id="4397994">0x82</span><span class="op" id="4397998">,</span>&nbsp;<span class="num" id="4398000">0x87</span><span class="op" id="4398004">,</span>&nbsp;<span class="num" id="4398006">0x13</span><span class="op" id="4398010">,</span>&nbsp;<span class="num" id="4398012">0xcd</span><span class="op" id="4398016">,</span>&nbsp;<span class="num" id="4398018">0x57</span><span class="op" id="4398022">,</span>&nbsp;<span class="num" id="4398024">0x18</span><span class="op" id="4398028">,</span>&nbsp;<span class="num" id="4398030">0xff</span><span class="op" id="4398034">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4398037">0x28</span><span class="op" id="4398041">,</span>&nbsp;<span class="num" id="4398043">0xce</span><span class="op" id="4398047">,</span>&nbsp;<span class="num" id="4398049">0xc0</span><span class="op" id="4398053">,</span>&nbsp;<span class="num" id="4398055">0xe6</span><span class="op" id="4398059">,</span>&nbsp;<span class="num" id="4398061">0x0e</span><span class="op" id="4398065">,</span>&nbsp;<span class="num" id="4398067">0x06</span><span class="op" id="4398071">,</span>&nbsp;<span class="num" id="4398073">0x91</span><span class="op" id="4398077">,</span>&nbsp;<span class="num" id="4398079">0x50</span><span class="op" id="4398083">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4398086">0x29</span><span class="op" id="4398090">,</span>&nbsp;<span class="num" id="4398092">0x83</span><span class="op" id="4398096">,</span>&nbsp;<span class="num" id="4398098">0xd1</span><span class="op" id="4398102">,</span>&nbsp;<span class="num" id="4398104">0xf2</span><span class="op" id="4398108">,</span>&nbsp;<span class="num" id="4398110">0xc3</span><span class="op" id="4398114">,</span>&nbsp;<span class="num" id="4398116">0x2a</span><span class="op" id="4398120">,</span>&nbsp;<span class="num" id="4398122">0xdb</span><span class="op" id="4398126">,</span>&nbsp;<span class="num" id="4398128">0xd8</span><span class="op" id="4398132">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4398135">0xdb</span><span class="op" id="4398139">,</span>&nbsp;<span class="num" id="4398141">0x4e</span><span class="op" id="4398145">,</span>&nbsp;<span class="num" id="4398147">0x04</span><span class="op" id="4398151">,</span>&nbsp;<span class="num" id="4398153">0xcc</span><span class="op" id="4398157">,</span>&nbsp;<span class="num" id="4398159">0x00</span><span class="op" id="4398163">,</span>&nbsp;<span class="num" id="4398165">0xeb</span><span class="op" id="4398169">,</span>&nbsp;<span class="num" id="4398171">0x8b</span><span class="op" id="4398175">,</span>&nbsp;<span class="num" id="4398177">0xb6</span><span class="op" id="4398181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4398184">0x96</span><span class="op" id="4398188">,</span>&nbsp;<span class="num" id="4398190">0xdc</span><span class="op" id="4398194">,</span>&nbsp;<span class="num" id="4398196">0xbc</span><span class="op" id="4398200">,</span>&nbsp;<span class="num" id="4398202">0xaa</span><span class="op" id="4398206">,</span>&nbsp;<span class="num" id="4398208">0xfa</span><span class="op" id="4398212">,</span>&nbsp;<span class="num" id="4398214">0x52</span><span class="op" id="4398218">,</span>&nbsp;<span class="num" id="4398220">0x77</span><span class="op" id="4398224">,</span>&nbsp;<span class="num" id="4398226">0x04</span><span class="op" id="4398230">,</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4398233">0xc1</span><span class="op" id="4398237">,</span>&nbsp;<span class="num" id="4398239">0xdb</span><span class="op" id="4398243">,</span>&nbsp;<span class="num" id="4398245">0x19</span><span class="op" id="4398249">,</span>&nbsp;<span class="num" id="4398251">0xe4</span><span class="op" id="4398255">,</span>&nbsp;<span class="num" id="4398257">0xae</span><span class="op" id="4398261">,</span>&nbsp;<span class="num" id="4398263">0x9c</span><span class="op" id="4398267">,</span>&nbsp;<span class="num" id="4398269">0xfd</span><span class="op" id="4398273">,</span>&nbsp;<span class="num" id="4398275">0x3c</span><span class="op" id="4398279">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4398282">0x8b</span><span class="op" id="4398286">,</span>&nbsp;<span class="num" id="4398288">0x03</span><span class="op" id="4398292">,</span>&nbsp;<span class="num" id="4398294">0xef</span><span class="op" id="4398298">,</span>&nbsp;<span class="num" id="4398300">0x4d</span><span class="op" id="4398304">,</span>&nbsp;<span class="num" id="4398306">0xbc</span><span class="op" id="4398310">,</span>&nbsp;<span class="num" id="4398312">0x1a</span><span class="op" id="4398316">,</span>&nbsp;<span class="num" id="4398318">0x03</span><span class="op" id="4398322">,</span>&nbsp;<span class="num" id="4398324">0x65</span><span class="op" id="4398328">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4398331">0xf9</span><span class="op" id="4398335">,</span>&nbsp;<span class="num" id="4398337">0xc1</span><span class="op" id="4398341">,</span>&nbsp;<span class="num" id="4398343">0xb1</span><span class="op" id="4398347">,</span>&nbsp;<span class="num" id="4398349">0x3f</span><span class="op" id="4398353">,</span>&nbsp;<span class="num" id="4398355">0x72</span><span class="op" id="4398359">,</span>&nbsp;<span class="num" id="4398361">0x86</span><span class="op" id="4398365">,</span>&nbsp;<span class="num" id="4398367">0xf2</span><span class="op" id="4398371">,</span>&nbsp;<span class="num" id="4398373">0x38</span><span class="op" id="4398377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4398380">0xaa</span><span class="op" id="4398384">,</span>&nbsp;<span class="num" id="4398386">0x19</span><span class="op" id="4398390">,</span>&nbsp;<span class="num" id="4398392">0xae</span><span class="op" id="4398396">,</span>&nbsp;<span class="num" id="4398398">0x10</span><span class="op" id="4398402">,</span>&nbsp;<span class="num" id="4398404">0x88</span><span class="op" id="4398408">,</span>&nbsp;<span class="num" id="4398410">0x78</span><span class="op" id="4398414">,</span>&nbsp;<span class="num" id="4398416">0x28</span><span class="op" id="4398420">,</span>&nbsp;<span class="num" id="4398422">0xda</span><span class="op" id="4398426">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4398429">0x75</span><span class="op" id="4398433">,</span>&nbsp;<span class="num" id="4398435">0xc3</span><span class="op" id="4398439">,</span>&nbsp;<span class="num" id="4398441">0x3d</span><span class="op" id="4398445">,</span>&nbsp;<span class="num" id="4398447">0x02</span><span class="op" id="4398451">,</span>&nbsp;<span class="num" id="4398453">0x82</span><span class="op" id="4398457">,</span>&nbsp;<span class="num" id="4398459">0x02</span><span class="op" id="4398463">,</span>&nbsp;<span class="num" id="4398465">0x9c</span><span class="op" id="4398469">,</span>&nbsp;<span class="num" id="4398471">0xb9</span><span class="op" id="4398475">,</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4398478">0xc1</span><span class="op" id="4398482">,</span>&nbsp;<span class="num" id="4398484">0x65</span><span class="op" id="4398488">,</span>&nbsp;<span class="num" id="4398490">0x77</span><span class="op" id="4398494">,</span>&nbsp;<span class="num" id="4398496">0x76</span><span class="op" id="4398500">,</span>&nbsp;<span class="num" id="4398502">0x24</span><span class="op" id="4398506">,</span>&nbsp;<span class="num" id="4398508">0x4c</span><span class="op" id="4398512">,</span>&nbsp;<span class="num" id="4398514">0x98</span><span class="op" id="4398518">,</span>&nbsp;<span class="num" id="4398520">0xf7</span><span class="op" id="4398524">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4398527">0x6d</span><span class="op" id="4398531">,</span>&nbsp;<span class="num" id="4398533">0x31</span><span class="op" id="4398537">,</span>&nbsp;<span class="num" id="4398539">0x38</span><span class="op" id="4398543">,</span>&nbsp;<span class="num" id="4398545">0xfb</span><span class="op" id="4398549">,</span>&nbsp;<span class="num" id="4398551">0xdb</span><span class="op" id="4398555">,</span>&nbsp;<span class="num" id="4398557">0xfe</span><span class="op" id="4398561">,</span>&nbsp;<span class="num" id="4398563">0xdb</span><span class="op" id="4398567">,</span>&nbsp;<span class="num" id="4398569">0x37</span><span class="op" id="4398573">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4398576">0x02</span><span class="op" id="4398580">,</span>&nbsp;<span class="num" id="4398582">0x76</span><span class="op" id="4398586">,</span>&nbsp;<span class="num" id="4398588">0xa1</span><span class="op" id="4398592">,</span>&nbsp;<span class="num" id="4398594">0x18</span><span class="op" id="4398598">,</span>&nbsp;<span class="num" id="4398600">0x97</span><span class="op" id="4398604">,</span>&nbsp;<span class="num" id="4398606">0xa6</span><span class="op" id="4398610">,</span>&nbsp;<span class="num" id="4398612">0xcc</span><span class="op" id="4398616">,</span>&nbsp;<span class="num" id="4398618">0xde</span><span class="op" id="4398622">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4398625">0x20</span><span class="op" id="4398629">,</span>&nbsp;<span class="num" id="4398631">0x09</span><span class="op" id="4398635">,</span>&nbsp;<span class="num" id="4398637">0x49</span><span class="op" id="4398641">,</span>&nbsp;<span class="num" id="4398643">0x36</span><span class="op" id="4398647">,</span>&nbsp;<span class="num" id="4398649">0x24</span><span class="op" id="4398653">,</span>&nbsp;<span class="num" id="4398655">0x69</span><span class="op" id="4398659">,</span>&nbsp;<span class="num" id="4398661">0x42</span><span class="op" id="4398665">,</span>&nbsp;<span class="num" id="4398667">0xf6</span><span class="op" id="4398671">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4398674">0xe4</span><span class="op" id="4398678">,</span>&nbsp;<span class="num" id="4398680">0x37</span><span class="op" id="4398684">,</span>&nbsp;<span class="num" id="4398686">0x62</span><span class="op" id="4398690">,</span>&nbsp;<span class="num" id="4398692">0xf1</span><span class="op" id="4398696">,</span>&nbsp;<span class="num" id="4398698">0x59</span><span class="op" id="4398702">,</span>&nbsp;<span class="num" id="4398704">0x6d</span><span class="op" id="4398708">,</span>&nbsp;<span class="num" id="4398710">0xa9</span><span class="op" id="4398714">,</span>&nbsp;<span class="num" id="4398716">0x3c</span><span class="op" id="4398720">,</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4398723">0xed</span><span class="op" id="4398727">,</span>&nbsp;<span class="num" id="4398729">0x34</span><span class="op" id="4398733">,</span>&nbsp;<span class="num" id="4398735">0x9c</span><span class="op" id="4398739">,</span>&nbsp;<span class="num" id="4398741">0xa3</span><span class="op" id="4398745">,</span>&nbsp;<span class="num" id="4398747">0x8e</span><span class="op" id="4398751">,</span>&nbsp;<span class="num" id="4398753">0xdb</span><span class="op" id="4398757">,</span>&nbsp;<span class="num" id="4398759">0xdc</span><span class="op" id="4398763">,</span>&nbsp;<span class="num" id="4398765">0x3a</span><span class="op" id="4398769">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4398772">0xd7</span><span class="op" id="4398776">,</span>&nbsp;<span class="num" id="4398778">0xf7</span><span class="op" id="4398782">,</span>&nbsp;<span class="num" id="4398784">0x0a</span><span class="op" id="4398788">,</span>&nbsp;<span class="num" id="4398790">0x6f</span><span class="op" id="4398794">,</span>&nbsp;<span class="num" id="4398796">0xef</span><span class="op" id="4398800">,</span>&nbsp;<span class="num" id="4398802">0x2e</span><span class="op" id="4398806">,</span>&nbsp;<span class="num" id="4398808">0xd8</span><span class="op" id="4398812">,</span>&nbsp;<span class="num" id="4398814">0xd5</span><span class="op" id="4398818">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4398821">0x93</span><span class="op" id="4398825">,</span>&nbsp;<span class="num" id="4398827">0x5a</span><span class="op" id="4398831">,</span>&nbsp;<span class="num" id="4398833">0x7a</span><span class="op" id="4398837">,</span>&nbsp;<span class="num" id="4398839">0xed</span><span class="op" id="4398843">,</span>&nbsp;<span class="num" id="4398845">0x08</span><span class="op" id="4398849">,</span>&nbsp;<span class="num" id="4398851">0x49</span><span class="op" id="4398855">,</span>&nbsp;<span class="num" id="4398857">0x68</span><span class="op" id="4398861">,</span>&nbsp;<span class="num" id="4398863">0xe2</span><span class="op" id="4398867">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4398870">0x41</span><span class="op" id="4398874">,</span>&nbsp;<span class="num" id="4398876">0xe3</span><span class="op" id="4398880">,</span>&nbsp;<span class="num" id="4398882">0x5a</span><span class="op" id="4398886">,</span>&nbsp;<span class="num" id="4398888">0x90</span><span class="op" id="4398892">,</span>&nbsp;<span class="num" id="4398894">0xc1</span><span class="op" id="4398898">,</span>&nbsp;<span class="num" id="4398900">0x86</span><span class="op" id="4398904">,</span>&nbsp;<span class="num" id="4398906">0x55</span><span class="op" id="4398910">,</span>&nbsp;<span class="num" id="4398912">0xfc</span><span class="op" id="4398916">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4398919">0x51</span><span class="op" id="4398923">,</span>&nbsp;<span class="num" id="4398925">0x43</span><span class="op" id="4398929">,</span>&nbsp;<span class="num" id="4398931">0x9d</span><span class="op" id="4398935">,</span>&nbsp;<span class="num" id="4398937">0xe0</span><span class="op" id="4398941">,</span>&nbsp;<span class="num" id="4398943">0xb2</span><span class="op" id="4398947">,</span>&nbsp;<span class="num" id="4398949">0xc4</span><span class="op" id="4398953">,</span>&nbsp;<span class="num" id="4398955">0x67</span><span class="op" id="4398959">,</span>&nbsp;<span class="num" id="4398961">0xb4</span><span class="op" id="4398965">,</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4398968">0xcb</span><span class="op" id="4398972">,</span>&nbsp;<span class="num" id="4398974">0x32</span><span class="op" id="4398978">,</span>&nbsp;<span class="num" id="4398980">0x31</span><span class="op" id="4398984">,</span>&nbsp;<span class="num" id="4398986">0x25</span><span class="op" id="4398990">,</span>&nbsp;<span class="num" id="4398992">0xf0</span><span class="op" id="4398996">,</span>&nbsp;<span class="num" id="4398998">0x54</span><span class="op" id="4399002">,</span>&nbsp;<span class="num" id="4399004">0x9f</span><span class="op" id="4399008">,</span>&nbsp;<span class="num" id="4399010">0x4b</span><span class="op" id="4399014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4399017">0xd1</span><span class="op" id="4399021">,</span>&nbsp;<span class="num" id="4399023">0x6f</span><span class="op" id="4399027">,</span>&nbsp;<span class="num" id="4399029">0xdb</span><span class="op" id="4399033">,</span>&nbsp;<span class="num" id="4399035">0xd4</span><span class="op" id="4399039">,</span>&nbsp;<span class="num" id="4399041">0xdd</span><span class="op" id="4399045">,</span>&nbsp;<span class="num" id="4399047">0xfc</span><span class="op" id="4399051">,</span>&nbsp;<span class="num" id="4399053">0xaf</span><span class="op" id="4399057">,</span>&nbsp;<span class="num" id="4399059">0x5e</span><span class="op" id="4399063">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4399066">0x6c</span><span class="op" id="4399070">,</span>&nbsp;<span class="num" id="4399072">0x78</span><span class="op" id="4399076">,</span>&nbsp;<span class="num" id="4399078">0x90</span><span class="op" id="4399082">,</span>&nbsp;<span class="num" id="4399084">0x95</span><span class="op" id="4399088">,</span>&nbsp;<span class="num" id="4399090">0xde</span><span class="op" id="4399094">,</span>&nbsp;<span class="num" id="4399096">0xca</span><span class="op" id="4399100">,</span>&nbsp;<span class="num" id="4399102">0x3a</span><span class="op" id="4399106">,</span>&nbsp;<span class="num" id="4399108">0x48</span><span class="op" id="4399112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4399115">0xb9</span><span class="op" id="4399119">,</span>&nbsp;<span class="num" id="4399121">0x79</span><span class="op" id="4399125">,</span>&nbsp;<span class="num" id="4399127">0x3c</span><span class="op" id="4399131">,</span>&nbsp;<span class="num" id="4399133">0x9b</span><span class="op" id="4399137">,</span>&nbsp;<span class="num" id="4399139">0x19</span><span class="op" id="4399143">,</span>&nbsp;<span class="num" id="4399145">0xd6</span><span class="op" id="4399149">,</span>&nbsp;<span class="num" id="4399151">0x75</span><span class="op" id="4399155">,</span>&nbsp;<span class="num" id="4399157">0x05</span><span class="op" id="4399161">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4399164">0xa0</span><span class="op" id="4399168">,</span>&nbsp;<span class="num" id="4399170">0xf9</span><span class="op" id="4399174">,</span>&nbsp;<span class="num" id="4399176">0x88</span><span class="op" id="4399180">,</span>&nbsp;<span class="num" id="4399182">0xd7</span><span class="op" id="4399186">,</span>&nbsp;<span class="num" id="4399188">0xc1</span><span class="op" id="4399192">,</span>&nbsp;<span class="num" id="4399194">0xe8</span><span class="op" id="4399198">,</span>&nbsp;<span class="num" id="4399200">0xa5</span><span class="op" id="4399204">,</span>&nbsp;<span class="num" id="4399206">0x09</span><span class="op" id="4399210">,</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4399213">0xe4</span><span class="op" id="4399217">,</span>&nbsp;<span class="num" id="4399219">0x1a</span><span class="op" id="4399223">,</span>&nbsp;<span class="num" id="4399225">0x15</span><span class="op" id="4399229">,</span>&nbsp;<span class="num" id="4399231">0xdc</span><span class="op" id="4399235">,</span>&nbsp;<span class="num" id="4399237">0x87</span><span class="op" id="4399241">,</span>&nbsp;<span class="num" id="4399243">0x23</span><span class="op" id="4399247">,</span>&nbsp;<span class="num" id="4399249">0xaa</span><span class="op" id="4399253">,</span>&nbsp;<span class="num" id="4399255">0xb2</span><span class="op" id="4399259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4399262">0x75</span><span class="op" id="4399266">,</span>&nbsp;<span class="num" id="4399268">0x8c</span><span class="op" id="4399272">,</span>&nbsp;<span class="num" id="4399274">0x63</span><span class="op" id="4399278">,</span>&nbsp;<span class="num" id="4399280">0x25</span><span class="op" id="4399284">,</span>&nbsp;<span class="num" id="4399286">0x87</span><span class="op" id="4399290">,</span>&nbsp;<span class="num" id="4399292">0xd8</span><span class="op" id="4399296">,</span>&nbsp;<span class="num" id="4399298">0xf8</span><span class="op" id="4399302">,</span>&nbsp;<span class="num" id="4399304">0x3d</span><span class="op" id="4399308">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4399311">0xa6</span><span class="op" id="4399315">,</span>&nbsp;<span class="num" id="4399317">0xc2</span><span class="op" id="4399321">,</span>&nbsp;<span class="num" id="4399323">0xcc</span><span class="op" id="4399327">,</span>&nbsp;<span class="num" id="4399329">0x66</span><span class="op" id="4399333">,</span>&nbsp;<span class="num" id="4399335">0xff</span><span class="op" id="4399339">,</span>&nbsp;<span class="num" id="4399341">0xa5</span><span class="op" id="4399345">,</span>&nbsp;<span class="num" id="4399347">0x66</span><span class="op" id="4399351">,</span>&nbsp;<span class="num" id="4399353">0x68</span><span class="op" id="4399357">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4399360">0x55</span><span class="op" id="4399364">,</span>&nbsp;<span class="num" id="4399366">0x02</span><span class="op" id="4399370">,</span>&nbsp;<span class="num" id="4399372">0x03</span><span class="op" id="4399376">,</span>&nbsp;<span class="num" id="4399378">0x01</span><span class="op" id="4399382">,</span>&nbsp;<span class="num" id="4399384">0x00</span><span class="op" id="4399388">,</span>&nbsp;<span class="num" id="4399390">0x01</span><span class="op" id="4399394">,</span><br>
<span class="lineno"></span><span class="op" id="4399396">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="4399399">//&nbsp;CheckSignatureFrom&nbsp;verifies&nbsp;that&nbsp;the&nbsp;signature&nbsp;on&nbsp;c&nbsp;is&nbsp;a&nbsp;valid&nbsp;signature</span><br>
<span class="lineno"></span><span class="comment" id="4399475">//&nbsp;from&nbsp;parent.</span><br>
<span class="lineno"></span><span class="keyword" id="4399491">func</span>&nbsp;<span class="op" id="4399496">(</span><span class="ident" id="4399497">c</span>&nbsp;<span class="op" id="4399499">*</span><span class="ident" id="4399500">Certificate</span><span class="op" id="4399511">)</span>&nbsp;<span class="ident" id="4399513">CheckSignatureFrom</span><span class="op" id="4399531">(</span><span class="ident" id="4399532">parent</span>&nbsp;<span class="op" id="4399539">*</span><span class="ident" id="4399540">Certificate</span><span class="op" id="4399551">)</span>&nbsp;<span class="op" id="4399553">(</span><span class="ident" id="4399554">err</span>&nbsp;<span class="builtintype" id="4399558">error</span><span class="op" id="4399563">)</span>&nbsp;<span class="op" id="4399565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4399568">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.9:</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4399591">//&nbsp;&#34;If&nbsp;the&nbsp;basic&nbsp;constraints&nbsp;extension&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;a&nbsp;version&nbsp;3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4399661">//&nbsp;certificate,&nbsp;or&nbsp;the&nbsp;extension&nbsp;is&nbsp;present&nbsp;but&nbsp;the&nbsp;cA&nbsp;boolean&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4399732">//&nbsp;asserted,&nbsp;then&nbsp;the&nbsp;certified&nbsp;public&nbsp;key&nbsp;MUST&nbsp;NOT&nbsp;be&nbsp;used&nbsp;to&nbsp;verify</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4399803">//&nbsp;certificate&nbsp;signatures.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4399832">//&nbsp;(except&nbsp;for&nbsp;Entrust,&nbsp;see&nbsp;comment&nbsp;above&nbsp;entrustBrokenSPKI)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4399894">if</span>&nbsp;<span class="op" id="4399897">(</span><span class="ident" id="4399898">parent</span><span class="op" id="4399904">.</span><span class="ident" id="4399905">Version</span>&nbsp;<span class="op" id="4399913">==</span>&nbsp;<span class="num" id="4399916">3</span>&nbsp;<span class="op" id="4399918">&amp;&amp;</span>&nbsp;<span class="op" id="4399921">!</span><span class="ident" id="4399922">parent</span><span class="op" id="4399928">.</span><span class="ident" id="4399929">BasicConstraintsValid</span>&nbsp;<span class="op" id="4399951">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4399956">parent</span><span class="op" id="4399962">.</span><span class="ident" id="4399963">BasicConstraintsValid</span>&nbsp;<span class="op" id="4399985">&amp;&amp;</span>&nbsp;<span class="op" id="4399988">!</span><span class="ident" id="4399989">parent</span><span class="op" id="4399995">.</span><span class="ident" id="4399996">IsCA</span><span class="op" id="4400000">)</span>&nbsp;<span class="op" id="4400002">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4400007">!</span><span class="ident" id="4400008">bytes</span><span class="op" id="4400013">.</span><span class="ident" id="4400014">Equal</span><span class="op" id="4400019">(</span><span class="ident" id="4400020">c</span><span class="op" id="4400021">.</span><span class="ident" id="4400022">RawSubjectPublicKeyInfo</span><span class="op" id="4400045">,</span>&nbsp;<span class="ident" id="4400047">entrustBrokenSPKI</span><span class="op" id="4400064">)</span>&nbsp;<span class="op" id="4400066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400070">return</span>&nbsp;<span class="ident" id="4400077">ConstraintViolationError</span><span class="op" id="4400101">{</span><span class="op" id="4400102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4400105">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400109">if</span>&nbsp;<span class="ident" id="4400112">parent</span><span class="op" id="4400118">.</span><span class="ident" id="4400119">KeyUsage</span>&nbsp;<span class="op" id="4400128">!=</span>&nbsp;<span class="num" id="4400131">0</span>&nbsp;<span class="op" id="4400133">&amp;&amp;</span>&nbsp;<span class="ident" id="4400136">parent</span><span class="op" id="4400142">.</span><span class="ident" id="4400143">KeyUsage</span><span class="op" id="4400151">&amp;</span><span class="ident" id="4400152">KeyUsageCertSign</span>&nbsp;<span class="op" id="4400169">==</span>&nbsp;<span class="num" id="4400172">0</span>&nbsp;<span class="op" id="4400174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400178">return</span>&nbsp;<span class="ident" id="4400185">ConstraintViolationError</span><span class="op" id="4400209">{</span><span class="op" id="4400210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4400213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400217">if</span>&nbsp;<span class="ident" id="4400220">parent</span><span class="op" id="4400226">.</span><span class="ident" id="4400227">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4400246">==</span>&nbsp;<span class="ident" id="4400249">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="op" id="4400275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400279">return</span>&nbsp;<span class="ident" id="4400286">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4400311">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4400315">//&nbsp;TODO(agl):&nbsp;don&#39;t&nbsp;ignore&nbsp;the&nbsp;path&nbsp;length&nbsp;constraint.</span><br>
<span class="lineno">615</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400372">return</span>&nbsp;<span class="ident" id="4400379">parent</span><span class="op" id="4400385">.</span><span class="ident" id="4400386">CheckSignature</span><span class="op" id="4400400">(</span><span class="ident" id="4400401">c</span><span class="op" id="4400402">.</span><span class="ident" id="4400403">SignatureAlgorithm</span><span class="op" id="4400421">,</span>&nbsp;<span class="ident" id="4400423">c</span><span class="op" id="4400424">.</span><span class="ident" id="4400425">RawTBSCertificate</span><span class="op" id="4400442">,</span>&nbsp;<span class="ident" id="4400444">c</span><span class="op" id="4400445">.</span><span class="ident" id="4400446">Signature</span><span class="op" id="4400455">)</span><br>
<span class="lineno"></span><span class="op" id="4400457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4400460">//&nbsp;CheckSignature&nbsp;verifies&nbsp;that&nbsp;signature&nbsp;is&nbsp;a&nbsp;valid&nbsp;signature&nbsp;over&nbsp;signed&nbsp;from</span><br>
<span class="lineno">620</span><span class="comment" id="4400540">//&nbsp;c&#39;s&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4400559">func</span>&nbsp;<span class="op" id="4400564">(</span><span class="ident" id="4400565">c</span>&nbsp;<span class="op" id="4400567">*</span><span class="ident" id="4400568">Certificate</span><span class="op" id="4400579">)</span>&nbsp;<span class="ident" id="4400581">CheckSignature</span><span class="op" id="4400595">(</span><span class="ident" id="4400596">algo</span>&nbsp;<span class="ident" id="4400601">SignatureAlgorithm</span><span class="op" id="4400619">,</span>&nbsp;<span class="ident" id="4400621">signed</span><span class="op" id="4400627">,</span>&nbsp;<span class="ident" id="4400629">signature</span>&nbsp;<span class="op" id="4400639">[</span><span class="op" id="4400640">]</span><span class="builtintype" id="4400641">byte</span><span class="op" id="4400645">)</span>&nbsp;<span class="op" id="4400647">(</span><span class="ident" id="4400648">err</span>&nbsp;<span class="builtintype" id="4400652">error</span><span class="op" id="4400657">)</span>&nbsp;<span class="op" id="4400659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400662">var</span>&nbsp;<span class="ident" id="4400666">hashType</span>&nbsp;<span class="ident" id="4400675">crypto</span><span class="op" id="4400681">.</span><span class="ident" id="4400682">Hash</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400689">switch</span>&nbsp;<span class="ident" id="4400696">algo</span>&nbsp;<span class="op" id="4400701">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400704">case</span>&nbsp;<span class="ident" id="4400709">SHA1WithRSA</span><span class="op" id="4400720">,</span>&nbsp;<span class="ident" id="4400722">DSAWithSHA1</span><span class="op" id="4400733">,</span>&nbsp;<span class="ident" id="4400735">ECDSAWithSHA1</span><span class="op" id="4400748">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4400752">hashType</span>&nbsp;<span class="op" id="4400761">=</span>&nbsp;<span class="ident" id="4400763">crypto</span><span class="op" id="4400769">.</span><span class="ident" id="4400770">SHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400776">case</span>&nbsp;<span class="ident" id="4400781">SHA256WithRSA</span><span class="op" id="4400794">,</span>&nbsp;<span class="ident" id="4400796">DSAWithSHA256</span><span class="op" id="4400809">,</span>&nbsp;<span class="ident" id="4400811">ECDSAWithSHA256</span><span class="op" id="4400826">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4400830">hashType</span>&nbsp;<span class="op" id="4400839">=</span>&nbsp;<span class="ident" id="4400841">crypto</span><span class="op" id="4400847">.</span><span class="ident" id="4400848">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400856">case</span>&nbsp;<span class="ident" id="4400861">SHA384WithRSA</span><span class="op" id="4400874">,</span>&nbsp;<span class="ident" id="4400876">ECDSAWithSHA384</span><span class="op" id="4400891">:</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4400895">hashType</span>&nbsp;<span class="op" id="4400904">=</span>&nbsp;<span class="ident" id="4400906">crypto</span><span class="op" id="4400912">.</span><span class="ident" id="4400913">SHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400921">case</span>&nbsp;<span class="ident" id="4400926">SHA512WithRSA</span><span class="op" id="4400939">,</span>&nbsp;<span class="ident" id="4400941">ECDSAWithSHA512</span><span class="op" id="4400956">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4400960">hashType</span>&nbsp;<span class="op" id="4400969">=</span>&nbsp;<span class="ident" id="4400971">crypto</span><span class="op" id="4400977">.</span><span class="ident" id="4400978">SHA512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400986">default</span><span class="op" id="4400993">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400997">return</span>&nbsp;<span class="ident" id="4401004">ErrUnsupportedAlgorithm</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4401029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401033">if</span>&nbsp;<span class="op" id="4401036">!</span><span class="ident" id="4401037">hashType</span><span class="op" id="4401045">.</span><span class="ident" id="4401046">Available</span><span class="op" id="4401055">(</span><span class="op" id="4401056">)</span>&nbsp;<span class="op" id="4401058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401062">return</span>&nbsp;<span class="ident" id="4401069">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4401094">}</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4401097">h</span>&nbsp;<span class="op" id="4401099">:=</span>&nbsp;<span class="ident" id="4401102">hashType</span><span class="op" id="4401110">.</span><span class="ident" id="4401111">New</span><span class="op" id="4401114">(</span><span class="op" id="4401115">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4401119">h</span><span class="op" id="4401120">.</span><span class="ident" id="4401121">Write</span><span class="op" id="4401126">(</span><span class="ident" id="4401127">signed</span><span class="op" id="4401133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4401136">digest</span>&nbsp;<span class="op" id="4401143">:=</span>&nbsp;<span class="ident" id="4401146">h</span><span class="op" id="4401147">.</span><span class="ident" id="4401148">Sum</span><span class="op" id="4401151">(</span><span class="builtintype" id="4401152">nil</span><span class="op" id="4401155">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401159">switch</span>&nbsp;<span class="ident" id="4401166">pub</span>&nbsp;<span class="op" id="4401170">:=</span>&nbsp;<span class="ident" id="4401173">c</span><span class="op" id="4401174">.</span><span class="ident" id="4401175">PublicKey</span><span class="op" id="4401184">.</span><span class="op" id="4401185">(</span><span class="keyword" id="4401186">type</span><span class="op" id="4401190">)</span>&nbsp;<span class="op" id="4401192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401195">case</span>&nbsp;<span class="op" id="4401200">*</span><span class="ident" id="4401201">rsa</span><span class="op" id="4401204">.</span><span class="ident" id="4401205">PublicKey</span><span class="op" id="4401214">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401218">return</span>&nbsp;<span class="ident" id="4401225">rsa</span><span class="op" id="4401228">.</span><span class="ident" id="4401229">VerifyPKCS1v15</span><span class="op" id="4401243">(</span><span class="ident" id="4401244">pub</span><span class="op" id="4401247">,</span>&nbsp;<span class="ident" id="4401249">hashType</span><span class="op" id="4401257">,</span>&nbsp;<span class="ident" id="4401259">digest</span><span class="op" id="4401265">,</span>&nbsp;<span class="ident" id="4401267">signature</span><span class="op" id="4401276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401279">case</span>&nbsp;<span class="op" id="4401284">*</span><span class="ident" id="4401285">dsa</span><span class="op" id="4401288">.</span><span class="ident" id="4401289">PublicKey</span><span class="op" id="4401298">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4401302">dsaSig</span>&nbsp;<span class="op" id="4401309">:=</span>&nbsp;<span class="builtinfunc" id="4401312">new</span><span class="op" id="4401315">(</span><span class="ident" id="4401316">dsaSignature</span><span class="op" id="4401328">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401332">if</span>&nbsp;<span class="ident" id="4401335">_</span><span class="op" id="4401336">,</span>&nbsp;<span class="ident" id="4401338">err</span>&nbsp;<span class="op" id="4401342">:=</span>&nbsp;<span class="ident" id="4401345">asn1</span><span class="op" id="4401349">.</span><span class="ident" id="4401350">Unmarshal</span><span class="op" id="4401359">(</span><span class="ident" id="4401360">signature</span><span class="op" id="4401369">,</span>&nbsp;<span class="ident" id="4401371">dsaSig</span><span class="op" id="4401377">)</span><span class="op" id="4401378">;</span>&nbsp;<span class="ident" id="4401380">err</span>&nbsp;<span class="op" id="4401384">!=</span>&nbsp;<span class="builtintype" id="4401387">nil</span>&nbsp;<span class="op" id="4401391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401396">return</span>&nbsp;<span class="ident" id="4401403">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4401409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401413">if</span>&nbsp;<span class="ident" id="4401416">dsaSig</span><span class="op" id="4401422">.</span><span class="ident" id="4401423">R</span><span class="op" id="4401424">.</span><span class="ident" id="4401425">Sign</span><span class="op" id="4401429">(</span><span class="op" id="4401430">)</span>&nbsp;<span class="op" id="4401432">&lt;=</span>&nbsp;<span class="num" id="4401435">0</span>&nbsp;<span class="op" id="4401437">||</span>&nbsp;<span class="ident" id="4401440">dsaSig</span><span class="op" id="4401446">.</span><span class="ident" id="4401447">S</span><span class="op" id="4401448">.</span><span class="ident" id="4401449">Sign</span><span class="op" id="4401453">(</span><span class="op" id="4401454">)</span>&nbsp;<span class="op" id="4401456">&lt;=</span>&nbsp;<span class="num" id="4401459">0</span>&nbsp;<span class="op" id="4401461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401466">return</span>&nbsp;<span class="ident" id="4401473">errors</span><span class="op" id="4401479">.</span><span class="ident" id="4401480">New</span><span class="op" id="4401483">(</span><span class="string" id="4401484">&#34;x509:&nbsp;DSA&nbsp;signature&nbsp;contained&nbsp;zero&nbsp;or&nbsp;negative&nbsp;values&#34;</span><span class="op" id="4401539">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4401543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401547">if</span>&nbsp;<span class="op" id="4401550">!</span><span class="ident" id="4401551">dsa</span><span class="op" id="4401554">.</span><span class="ident" id="4401555">Verify</span><span class="op" id="4401561">(</span><span class="ident" id="4401562">pub</span><span class="op" id="4401565">,</span>&nbsp;<span class="ident" id="4401567">digest</span><span class="op" id="4401573">,</span>&nbsp;<span class="ident" id="4401575">dsaSig</span><span class="op" id="4401581">.</span><span class="ident" id="4401582">R</span><span class="op" id="4401583">,</span>&nbsp;<span class="ident" id="4401585">dsaSig</span><span class="op" id="4401591">.</span><span class="ident" id="4401592">S</span><span class="op" id="4401593">)</span>&nbsp;<span class="op" id="4401595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401600">return</span>&nbsp;<span class="ident" id="4401607">errors</span><span class="op" id="4401613">.</span><span class="ident" id="4401614">New</span><span class="op" id="4401617">(</span><span class="string" id="4401618">&#34;x509:&nbsp;DSA&nbsp;verification&nbsp;failure&#34;</span><span class="op" id="4401650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4401654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401658">return</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401666">case</span>&nbsp;<span class="op" id="4401671">*</span><span class="ident" id="4401672">ecdsa</span><span class="op" id="4401677">.</span><span class="ident" id="4401678">PublicKey</span><span class="op" id="4401687">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4401691">ecdsaSig</span>&nbsp;<span class="op" id="4401700">:=</span>&nbsp;<span class="builtinfunc" id="4401703">new</span><span class="op" id="4401706">(</span><span class="ident" id="4401707">ecdsaSignature</span><span class="op" id="4401721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401725">if</span>&nbsp;<span class="ident" id="4401728">_</span><span class="op" id="4401729">,</span>&nbsp;<span class="ident" id="4401731">err</span>&nbsp;<span class="op" id="4401735">:=</span>&nbsp;<span class="ident" id="4401738">asn1</span><span class="op" id="4401742">.</span><span class="ident" id="4401743">Unmarshal</span><span class="op" id="4401752">(</span><span class="ident" id="4401753">signature</span><span class="op" id="4401762">,</span>&nbsp;<span class="ident" id="4401764">ecdsaSig</span><span class="op" id="4401772">)</span><span class="op" id="4401773">;</span>&nbsp;<span class="ident" id="4401775">err</span>&nbsp;<span class="op" id="4401779">!=</span>&nbsp;<span class="builtintype" id="4401782">nil</span>&nbsp;<span class="op" id="4401786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401791">return</span>&nbsp;<span class="ident" id="4401798">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4401804">}</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401808">if</span>&nbsp;<span class="ident" id="4401811">ecdsaSig</span><span class="op" id="4401819">.</span><span class="ident" id="4401820">R</span><span class="op" id="4401821">.</span><span class="ident" id="4401822">Sign</span><span class="op" id="4401826">(</span><span class="op" id="4401827">)</span>&nbsp;<span class="op" id="4401829">&lt;=</span>&nbsp;<span class="num" id="4401832">0</span>&nbsp;<span class="op" id="4401834">||</span>&nbsp;<span class="ident" id="4401837">ecdsaSig</span><span class="op" id="4401845">.</span><span class="ident" id="4401846">S</span><span class="op" id="4401847">.</span><span class="ident" id="4401848">Sign</span><span class="op" id="4401852">(</span><span class="op" id="4401853">)</span>&nbsp;<span class="op" id="4401855">&lt;=</span>&nbsp;<span class="num" id="4401858">0</span>&nbsp;<span class="op" id="4401860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401865">return</span>&nbsp;<span class="ident" id="4401872">errors</span><span class="op" id="4401878">.</span><span class="ident" id="4401879">New</span><span class="op" id="4401882">(</span><span class="string" id="4401883">&#34;x509:&nbsp;ECDSA&nbsp;signature&nbsp;contained&nbsp;zero&nbsp;or&nbsp;negative&nbsp;values&#34;</span><span class="op" id="4401940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4401944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401948">if</span>&nbsp;<span class="op" id="4401951">!</span><span class="ident" id="4401952">ecdsa</span><span class="op" id="4401957">.</span><span class="ident" id="4401958">Verify</span><span class="op" id="4401964">(</span><span class="ident" id="4401965">pub</span><span class="op" id="4401968">,</span>&nbsp;<span class="ident" id="4401970">digest</span><span class="op" id="4401976">,</span>&nbsp;<span class="ident" id="4401978">ecdsaSig</span><span class="op" id="4401986">.</span><span class="ident" id="4401987">R</span><span class="op" id="4401988">,</span>&nbsp;<span class="ident" id="4401990">ecdsaSig</span><span class="op" id="4401998">.</span><span class="ident" id="4401999">S</span><span class="op" id="4402000">)</span>&nbsp;<span class="op" id="4402002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4402007">return</span>&nbsp;<span class="ident" id="4402014">errors</span><span class="op" id="4402020">.</span><span class="ident" id="4402021">New</span><span class="op" id="4402024">(</span><span class="string" id="4402025">&#34;x509:&nbsp;ECDSA&nbsp;verification&nbsp;failure&#34;</span><span class="op" id="4402059">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4402063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4402067">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4402075">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4402078">return</span>&nbsp;<span class="ident" id="4402085">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span><span class="op" id="4402109">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span><span class="comment" id="4402112">//&nbsp;CheckCRLSignature&nbsp;checks&nbsp;that&nbsp;the&nbsp;signature&nbsp;in&nbsp;crl&nbsp;is&nbsp;from&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="4402177">func</span>&nbsp;<span class="op" id="4402182">(</span><span class="ident" id="4402183">c</span>&nbsp;<span class="op" id="4402185">*</span><span class="ident" id="4402186">Certificate</span><span class="op" id="4402197">)</span>&nbsp;<span class="ident" id="4402199">CheckCRLSignature</span><span class="op" id="4402216">(</span><span class="ident" id="4402217">crl</span>&nbsp;<span class="op" id="4402221">*</span><span class="ident" id="4402222">pkix</span><span class="op" id="4402226">.</span><span class="ident" id="4402227">CertificateList</span><span class="op" id="4402242">)</span>&nbsp;<span class="op" id="4402244">(</span><span class="ident" id="4402245">err</span>&nbsp;<span class="builtintype" id="4402249">error</span><span class="op" id="4402254">)</span>&nbsp;<span class="op" id="4402256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402259">algo</span>&nbsp;<span class="op" id="4402264">:=</span>&nbsp;<span class="ident" id="4402267">getSignatureAlgorithmFromOID</span><span class="op" id="4402295">(</span><span class="ident" id="4402296">crl</span><span class="op" id="4402299">.</span><span class="ident" id="4402300">SignatureAlgorithm</span><span class="op" id="4402318">.</span><span class="ident" id="4402319">Algorithm</span><span class="op" id="4402328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4402331">return</span>&nbsp;<span class="ident" id="4402338">c</span><span class="op" id="4402339">.</span><span class="ident" id="4402340">CheckSignature</span><span class="op" id="4402354">(</span><span class="ident" id="4402355">algo</span><span class="op" id="4402359">,</span>&nbsp;<span class="ident" id="4402361">crl</span><span class="op" id="4402364">.</span><span class="ident" id="4402365">TBSCertList</span><span class="op" id="4402376">.</span><span class="ident" id="4402377">Raw</span><span class="op" id="4402380">,</span>&nbsp;<span class="ident" id="4402382">crl</span><span class="op" id="4402385">.</span><span class="ident" id="4402386">SignatureValue</span><span class="op" id="4402400">.</span><span class="ident" id="4402401">RightAlign</span><span class="op" id="4402411">(</span><span class="op" id="4402412">)</span><span class="op" id="4402413">)</span><br>
<span class="lineno">680</span><span class="op" id="4402415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4402418">type</span>&nbsp;<span class="ident" id="4402423">UnhandledCriticalExtension</span>&nbsp;<span class="keyword" id="4402450">struct</span><span class="op" id="4402456">{</span><span class="op" id="4402457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4402460">func</span>&nbsp;<span class="op" id="4402465">(</span><span class="ident" id="4402466">h</span>&nbsp;<span class="ident" id="4402468">UnhandledCriticalExtension</span><span class="op" id="4402494">)</span>&nbsp;<span class="ident" id="4402496">Error</span><span class="op" id="4402501">(</span><span class="op" id="4402502">)</span>&nbsp;<span class="builtintype" id="4402504">string</span>&nbsp;<span class="op" id="4402511">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4402514">return</span>&nbsp;<span class="string" id="4402521">&#34;x509:&nbsp;unhandled&nbsp;critical&nbsp;extension&#34;</span><br>
<span class="lineno"></span><span class="op" id="4402558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4402561">type</span>&nbsp;<span class="ident" id="4402566">basicConstraints</span>&nbsp;<span class="keyword" id="4402583">struct</span>&nbsp;<span class="op" id="4402590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402593">IsCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4402604">bool</span>&nbsp;<span class="string" id="4402609">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402628">MaxPathLen</span>&nbsp;<span class="builtintype" id="4402639">int</span>&nbsp;&nbsp;<span class="string" id="4402644">`asn1:&#34;optional,default:-1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4402673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4402676">//&nbsp;RFC&nbsp;5280&nbsp;4.2.1.4</span><br>
<span class="lineno"></span><span class="keyword" id="4402696">type</span>&nbsp;<span class="ident" id="4402701">policyInformation</span>&nbsp;<span class="keyword" id="4402719">struct</span>&nbsp;<span class="op" id="4402726">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402729">Policy</span>&nbsp;<span class="ident" id="4402736">asn1</span><span class="op" id="4402740">.</span><span class="ident" id="4402741">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4402759">//&nbsp;policyQualifiers&nbsp;omitted</span><br>
<span class="lineno"></span><span class="op" id="4402787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4402790">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.10</span><br>
<span class="lineno">700</span><span class="keyword" id="4402812">type</span>&nbsp;<span class="ident" id="4402817">nameConstraints</span>&nbsp;<span class="keyword" id="4402833">struct</span>&nbsp;<span class="op" id="4402840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402843">Permitted</span>&nbsp;<span class="op" id="4402853">[</span><span class="op" id="4402854">]</span><span class="ident" id="4402855">generalSubtree</span>&nbsp;<span class="string" id="4402870">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402895">Excluded</span>&nbsp;&nbsp;<span class="op" id="4402905">[</span><span class="op" id="4402906">]</span><span class="ident" id="4402907">generalSubtree</span>&nbsp;<span class="string" id="4402922">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4402946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">705</span><span class="keyword" id="4402949">type</span>&nbsp;<span class="ident" id="4402954">generalSubtree</span>&nbsp;<span class="keyword" id="4402969">struct</span>&nbsp;<span class="op" id="4402976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402979">Name</span>&nbsp;<span class="builtintype" id="4402984">string</span>&nbsp;<span class="string" id="4402991">`asn1:&#34;tag:2,optional,ia5&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4403019">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4403022">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.2.1</span><br>
<span class="lineno">710</span><span class="keyword" id="4403043">type</span>&nbsp;<span class="ident" id="4403048">authorityInfoAccess</span>&nbsp;<span class="keyword" id="4403068">struct</span>&nbsp;<span class="op" id="4403075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403078">Method</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4403087">asn1</span><span class="op" id="4403091">.</span><span class="ident" id="4403092">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403110">Location</span>&nbsp;<span class="ident" id="4403119">asn1</span><span class="op" id="4403123">.</span><span class="ident" id="4403124">RawValue</span><br>
<span class="lineno"></span><span class="op" id="4403133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">715</span><span class="comment" id="4403136">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.14</span><br>
<span class="lineno"></span><span class="keyword" id="4403158">type</span>&nbsp;<span class="ident" id="4403163">distributionPoint</span>&nbsp;<span class="keyword" id="4403181">struct</span>&nbsp;<span class="op" id="4403188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403191">DistributionPoint</span>&nbsp;<span class="ident" id="4403209">distributionPointName</span>&nbsp;<span class="string" id="4403231">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403256">Reason</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403274">asn1</span><span class="op" id="4403278">.</span><span class="ident" id="4403279">BitString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4403296">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403321">CRLIssuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403339">asn1</span><span class="op" id="4403343">.</span><span class="ident" id="4403344">RawValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4403361">`asn1:&#34;optional,tag:2&#34;`</span><br>
<span class="lineno">720</span><span class="op" id="4403385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4403388">type</span>&nbsp;<span class="ident" id="4403393">distributionPointName</span>&nbsp;<span class="keyword" id="4403415">struct</span>&nbsp;<span class="op" id="4403422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403425">FullName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403438">asn1</span><span class="op" id="4403442">.</span><span class="ident" id="4403443">RawValue</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4403455">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403480">RelativeName</span>&nbsp;<span class="ident" id="4403493">pkix</span><span class="op" id="4403497">.</span><span class="ident" id="4403498">RDNSequence</span>&nbsp;<span class="string" id="4403510">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno">725</span><span class="op" id="4403534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4403537">func</span>&nbsp;<span class="ident" id="4403542">parsePublicKey</span><span class="op" id="4403556">(</span><span class="ident" id="4403557">algo</span>&nbsp;<span class="ident" id="4403562">PublicKeyAlgorithm</span><span class="op" id="4403580">,</span>&nbsp;<span class="ident" id="4403582">keyData</span>&nbsp;<span class="op" id="4403590">*</span><span class="ident" id="4403591">publicKeyInfo</span><span class="op" id="4403604">)</span>&nbsp;<span class="op" id="4403606">(</span><span class="keyword" id="4403607">interface</span><span class="op" id="4403616">{</span><span class="op" id="4403617">}</span><span class="op" id="4403618">,</span>&nbsp;<span class="builtintype" id="4403620">error</span><span class="op" id="4403625">)</span>&nbsp;<span class="op" id="4403627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403630">asn1Data</span>&nbsp;<span class="op" id="4403639">:=</span>&nbsp;<span class="ident" id="4403642">keyData</span><span class="op" id="4403649">.</span><span class="ident" id="4403650">PublicKey</span><span class="op" id="4403659">.</span><span class="ident" id="4403660">RightAlign</span><span class="op" id="4403670">(</span><span class="op" id="4403671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4403674">switch</span>&nbsp;<span class="ident" id="4403681">algo</span>&nbsp;<span class="op" id="4403686">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4403689">case</span>&nbsp;<span class="ident" id="4403694">RSA</span><span class="op" id="4403697">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403701">p</span>&nbsp;<span class="op" id="4403703">:=</span>&nbsp;<span class="builtinfunc" id="4403706">new</span><span class="op" id="4403709">(</span><span class="ident" id="4403710">rsaPublicKey</span><span class="op" id="4403722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403726">_</span><span class="op" id="4403727">,</span>&nbsp;<span class="ident" id="4403729">err</span>&nbsp;<span class="op" id="4403733">:=</span>&nbsp;<span class="ident" id="4403736">asn1</span><span class="op" id="4403740">.</span><span class="ident" id="4403741">Unmarshal</span><span class="op" id="4403750">(</span><span class="ident" id="4403751">asn1Data</span><span class="op" id="4403759">,</span>&nbsp;<span class="ident" id="4403761">p</span><span class="op" id="4403762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4403766">if</span>&nbsp;<span class="ident" id="4403769">err</span>&nbsp;<span class="op" id="4403773">!=</span>&nbsp;<span class="builtintype" id="4403776">nil</span>&nbsp;<span class="op" id="4403780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4403785">return</span>&nbsp;<span class="builtintype" id="4403792">nil</span><span class="op" id="4403795">,</span>&nbsp;<span class="ident" id="4403797">err</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4403803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4403808">if</span>&nbsp;<span class="ident" id="4403811">p</span><span class="op" id="4403812">.</span><span class="ident" id="4403813">N</span><span class="op" id="4403814">.</span><span class="ident" id="4403815">Sign</span><span class="op" id="4403819">(</span><span class="op" id="4403820">)</span>&nbsp;<span class="op" id="4403822">&lt;=</span>&nbsp;<span class="num" id="4403825">0</span>&nbsp;<span class="op" id="4403827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4403832">return</span>&nbsp;<span class="builtintype" id="4403839">nil</span><span class="op" id="4403842">,</span>&nbsp;<span class="ident" id="4403844">errors</span><span class="op" id="4403850">.</span><span class="ident" id="4403851">New</span><span class="op" id="4403854">(</span><span class="string" id="4403855">&#34;x509:&nbsp;RSA&nbsp;modulus&nbsp;is&nbsp;not&nbsp;a&nbsp;positive&nbsp;number&#34;</span><span class="op" id="4403899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4403903">}</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4403907">if</span>&nbsp;<span class="ident" id="4403910">p</span><span class="op" id="4403911">.</span><span class="ident" id="4403912">E</span>&nbsp;<span class="op" id="4403914">&lt;=</span>&nbsp;<span class="num" id="4403917">0</span>&nbsp;<span class="op" id="4403919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4403924">return</span>&nbsp;<span class="builtintype" id="4403931">nil</span><span class="op" id="4403934">,</span>&nbsp;<span class="ident" id="4403936">errors</span><span class="op" id="4403942">.</span><span class="ident" id="4403943">New</span><span class="op" id="4403946">(</span><span class="string" id="4403947">&#34;x509:&nbsp;RSA&nbsp;public&nbsp;exponent&nbsp;is&nbsp;not&nbsp;a&nbsp;positive&nbsp;number&#34;</span><span class="op" id="4403999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4404003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404008">pub</span>&nbsp;<span class="op" id="4404012">:=</span>&nbsp;<span class="op" id="4404015">&amp;</span><span class="ident" id="4404016">rsa</span><span class="op" id="4404019">.</span><span class="ident" id="4404020">PublicKey</span><span class="op" id="4404029">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404034">E</span><span class="op" id="4404035">:</span>&nbsp;<span class="ident" id="4404037">p</span><span class="op" id="4404038">.</span><span class="ident" id="4404039">E</span><span class="op" id="4404040">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404045">N</span><span class="op" id="4404046">:</span>&nbsp;<span class="ident" id="4404048">p</span><span class="op" id="4404049">.</span><span class="ident" id="4404050">N</span><span class="op" id="4404051">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4404055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4404059">return</span>&nbsp;<span class="ident" id="4404066">pub</span><span class="op" id="4404069">,</span>&nbsp;<span class="builtintype" id="4404071">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4404076">case</span>&nbsp;<span class="ident" id="4404081">DSA</span><span class="op" id="4404084">:</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4404088">var</span>&nbsp;<span class="ident" id="4404092">p</span>&nbsp;<span class="op" id="4404094">*</span><span class="ident" id="4404095">big</span><span class="op" id="4404098">.</span><span class="ident" id="4404099">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404105">_</span><span class="op" id="4404106">,</span>&nbsp;<span class="ident" id="4404108">err</span>&nbsp;<span class="op" id="4404112">:=</span>&nbsp;<span class="ident" id="4404115">asn1</span><span class="op" id="4404119">.</span><span class="ident" id="4404120">Unmarshal</span><span class="op" id="4404129">(</span><span class="ident" id="4404130">asn1Data</span><span class="op" id="4404138">,</span>&nbsp;<span class="op" id="4404140">&amp;</span><span class="ident" id="4404141">p</span><span class="op" id="4404142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4404146">if</span>&nbsp;<span class="ident" id="4404149">err</span>&nbsp;<span class="op" id="4404153">!=</span>&nbsp;<span class="builtintype" id="4404156">nil</span>&nbsp;<span class="op" id="4404160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4404165">return</span>&nbsp;<span class="builtintype" id="4404172">nil</span><span class="op" id="4404175">,</span>&nbsp;<span class="ident" id="4404177">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4404183">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404187">paramsData</span>&nbsp;<span class="op" id="4404198">:=</span>&nbsp;<span class="ident" id="4404201">keyData</span><span class="op" id="4404208">.</span><span class="ident" id="4404209">Algorithm</span><span class="op" id="4404218">.</span><span class="ident" id="4404219">Parameters</span><span class="op" id="4404229">.</span><span class="ident" id="4404230">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404242">params</span>&nbsp;<span class="op" id="4404249">:=</span>&nbsp;<span class="builtinfunc" id="4404252">new</span><span class="op" id="4404255">(</span><span class="ident" id="4404256">dsaAlgorithmParameters</span><span class="op" id="4404278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404282">_</span><span class="op" id="4404283">,</span>&nbsp;<span class="ident" id="4404285">err</span>&nbsp;<span class="op" id="4404289">=</span>&nbsp;<span class="ident" id="4404291">asn1</span><span class="op" id="4404295">.</span><span class="ident" id="4404296">Unmarshal</span><span class="op" id="4404305">(</span><span class="ident" id="4404306">paramsData</span><span class="op" id="4404316">,</span>&nbsp;<span class="ident" id="4404318">params</span><span class="op" id="4404324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4404328">if</span>&nbsp;<span class="ident" id="4404331">err</span>&nbsp;<span class="op" id="4404335">!=</span>&nbsp;<span class="builtintype" id="4404338">nil</span>&nbsp;<span class="op" id="4404342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4404347">return</span>&nbsp;<span class="builtintype" id="4404354">nil</span><span class="op" id="4404357">,</span>&nbsp;<span class="ident" id="4404359">err</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4404365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4404369">if</span>&nbsp;<span class="ident" id="4404372">p</span><span class="op" id="4404373">.</span><span class="ident" id="4404374">Sign</span><span class="op" id="4404378">(</span><span class="op" id="4404379">)</span>&nbsp;<span class="op" id="4404381">&lt;=</span>&nbsp;<span class="num" id="4404384">0</span>&nbsp;<span class="op" id="4404386">||</span>&nbsp;<span class="ident" id="4404389">params</span><span class="op" id="4404395">.</span><span class="ident" id="4404396">P</span><span class="op" id="4404397">.</span><span class="ident" id="4404398">Sign</span><span class="op" id="4404402">(</span><span class="op" id="4404403">)</span>&nbsp;<span class="op" id="4404405">&lt;=</span>&nbsp;<span class="num" id="4404408">0</span>&nbsp;<span class="op" id="4404410">||</span>&nbsp;<span class="ident" id="4404413">params</span><span class="op" id="4404419">.</span><span class="ident" id="4404420">Q</span><span class="op" id="4404421">.</span><span class="ident" id="4404422">Sign</span><span class="op" id="4404426">(</span><span class="op" id="4404427">)</span>&nbsp;<span class="op" id="4404429">&lt;=</span>&nbsp;<span class="num" id="4404432">0</span>&nbsp;<span class="op" id="4404434">||</span>&nbsp;<span class="ident" id="4404437">params</span><span class="op" id="4404443">.</span><span class="ident" id="4404444">G</span><span class="op" id="4404445">.</span><span class="ident" id="4404446">Sign</span><span class="op" id="4404450">(</span><span class="op" id="4404451">)</span>&nbsp;<span class="op" id="4404453">&lt;=</span>&nbsp;<span class="num" id="4404456">0</span>&nbsp;<span class="op" id="4404458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4404463">return</span>&nbsp;<span class="builtintype" id="4404470">nil</span><span class="op" id="4404473">,</span>&nbsp;<span class="ident" id="4404475">errors</span><span class="op" id="4404481">.</span><span class="ident" id="4404482">New</span><span class="op" id="4404485">(</span><span class="string" id="4404486">&#34;x509:&nbsp;zero&nbsp;or&nbsp;negative&nbsp;DSA&nbsp;parameter&#34;</span><span class="op" id="4404524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4404528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404532">pub</span>&nbsp;<span class="op" id="4404536">:=</span>&nbsp;<span class="op" id="4404539">&amp;</span><span class="ident" id="4404540">dsa</span><span class="op" id="4404543">.</span><span class="ident" id="4404544">PublicKey</span><span class="op" id="4404553">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404558">Parameters</span><span class="op" id="4404568">:</span>&nbsp;<span class="ident" id="4404570">dsa</span><span class="op" id="4404573">.</span><span class="ident" id="4404574">Parameters</span><span class="op" id="4404584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404590">P</span><span class="op" id="4404591">:</span>&nbsp;<span class="ident" id="4404593">params</span><span class="op" id="4404599">.</span><span class="ident" id="4404600">P</span><span class="op" id="4404601">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404607">Q</span><span class="op" id="4404608">:</span>&nbsp;<span class="ident" id="4404610">params</span><span class="op" id="4404616">.</span><span class="ident" id="4404617">Q</span><span class="op" id="4404618">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404624">G</span><span class="op" id="4404625">:</span>&nbsp;<span class="ident" id="4404627">params</span><span class="op" id="4404633">.</span><span class="ident" id="4404634">G</span><span class="op" id="4404635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4404640">}</span><span class="op" id="4404641">,</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404646">Y</span><span class="op" id="4404647">:</span>&nbsp;<span class="ident" id="4404649">p</span><span class="op" id="4404650">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4404654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4404658">return</span>&nbsp;<span class="ident" id="4404665">pub</span><span class="op" id="4404668">,</span>&nbsp;<span class="builtintype" id="4404670">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4404675">case</span>&nbsp;<span class="ident" id="4404680">ECDSA</span><span class="op" id="4404685">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404689">paramsData</span>&nbsp;<span class="op" id="4404700">:=</span>&nbsp;<span class="ident" id="4404703">keyData</span><span class="op" id="4404710">.</span><span class="ident" id="4404711">Algorithm</span><span class="op" id="4404720">.</span><span class="ident" id="4404721">Parameters</span><span class="op" id="4404731">.</span><span class="ident" id="4404732">FullBytes</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404744">namedCurveOID</span>&nbsp;<span class="op" id="4404758">:=</span>&nbsp;<span class="builtinfunc" id="4404761">new</span><span class="op" id="4404764">(</span><span class="ident" id="4404765">asn1</span><span class="op" id="4404769">.</span><span class="ident" id="4404770">ObjectIdentifier</span><span class="op" id="4404786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404790">_</span><span class="op" id="4404791">,</span>&nbsp;<span class="ident" id="4404793">err</span>&nbsp;<span class="op" id="4404797">:=</span>&nbsp;<span class="ident" id="4404800">asn1</span><span class="op" id="4404804">.</span><span class="ident" id="4404805">Unmarshal</span><span class="op" id="4404814">(</span><span class="ident" id="4404815">paramsData</span><span class="op" id="4404825">,</span>&nbsp;<span class="ident" id="4404827">namedCurveOID</span><span class="op" id="4404840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4404844">if</span>&nbsp;<span class="ident" id="4404847">err</span>&nbsp;<span class="op" id="4404851">!=</span>&nbsp;<span class="builtintype" id="4404854">nil</span>&nbsp;<span class="op" id="4404858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4404863">return</span>&nbsp;<span class="builtintype" id="4404870">nil</span><span class="op" id="4404873">,</span>&nbsp;<span class="ident" id="4404875">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4404881">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404885">namedCurve</span>&nbsp;<span class="op" id="4404896">:=</span>&nbsp;<span class="ident" id="4404899">namedCurveFromOID</span><span class="op" id="4404916">(</span><span class="op" id="4404917">*</span><span class="ident" id="4404918">namedCurveOID</span><span class="op" id="4404931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4404935">if</span>&nbsp;<span class="ident" id="4404938">namedCurve</span>&nbsp;<span class="op" id="4404949">==</span>&nbsp;<span class="builtintype" id="4404952">nil</span>&nbsp;<span class="op" id="4404956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4404961">return</span>&nbsp;<span class="builtintype" id="4404968">nil</span><span class="op" id="4404971">,</span>&nbsp;<span class="ident" id="4404973">errors</span><span class="op" id="4404979">.</span><span class="ident" id="4404980">New</span><span class="op" id="4404983">(</span><span class="string" id="4404984">&#34;x509:&nbsp;unsupported&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4405018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4405022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405026">x</span><span class="op" id="4405027">,</span>&nbsp;<span class="ident" id="4405029">y</span>&nbsp;<span class="op" id="4405031">:=</span>&nbsp;<span class="ident" id="4405034">elliptic</span><span class="op" id="4405042">.</span><span class="ident" id="4405043">Unmarshal</span><span class="op" id="4405052">(</span><span class="ident" id="4405053">namedCurve</span><span class="op" id="4405063">,</span>&nbsp;<span class="ident" id="4405065">asn1Data</span><span class="op" id="4405073">)</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4405077">if</span>&nbsp;<span class="ident" id="4405080">x</span>&nbsp;<span class="op" id="4405082">==</span>&nbsp;<span class="builtintype" id="4405085">nil</span>&nbsp;<span class="op" id="4405089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4405094">return</span>&nbsp;<span class="builtintype" id="4405101">nil</span><span class="op" id="4405104">,</span>&nbsp;<span class="ident" id="4405106">errors</span><span class="op" id="4405112">.</span><span class="ident" id="4405113">New</span><span class="op" id="4405116">(</span><span class="string" id="4405117">&#34;x509:&nbsp;failed&nbsp;to&nbsp;unmarshal&nbsp;elliptic&nbsp;curve&nbsp;point&#34;</span><span class="op" id="4405165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4405169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405173">pub</span>&nbsp;<span class="op" id="4405177">:=</span>&nbsp;<span class="op" id="4405180">&amp;</span><span class="ident" id="4405181">ecdsa</span><span class="op" id="4405186">.</span><span class="ident" id="4405187">PublicKey</span><span class="op" id="4405196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405201">Curve</span><span class="op" id="4405206">:</span>&nbsp;<span class="ident" id="4405208">namedCurve</span><span class="op" id="4405218">,</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405223">X</span><span class="op" id="4405224">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405230">x</span><span class="op" id="4405231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405236">Y</span><span class="op" id="4405237">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405243">y</span><span class="op" id="4405244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4405248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4405252">return</span>&nbsp;<span class="ident" id="4405259">pub</span><span class="op" id="4405262">,</span>&nbsp;<span class="builtintype" id="4405264">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4405269">default</span><span class="op" id="4405276">:</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4405280">return</span>&nbsp;<span class="builtintype" id="4405287">nil</span><span class="op" id="4405290">,</span>&nbsp;<span class="builtintype" id="4405292">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4405297">}</span><br>
<span class="lineno"></span><span class="op" id="4405299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4405302">func</span>&nbsp;<span class="ident" id="4405307">parseSANExtension</span><span class="op" id="4405324">(</span><span class="ident" id="4405325">value</span>&nbsp;<span class="op" id="4405331">[</span><span class="op" id="4405332">]</span><span class="builtintype" id="4405333">byte</span><span class="op" id="4405337">)</span>&nbsp;<span class="op" id="4405339">(</span><span class="ident" id="4405340">dnsNames</span><span class="op" id="4405348">,</span>&nbsp;<span class="ident" id="4405350">emailAddresses</span>&nbsp;<span class="op" id="4405365">[</span><span class="op" id="4405366">]</span><span class="builtintype" id="4405367">string</span><span class="op" id="4405373">,</span>&nbsp;<span class="ident" id="4405375">ipAddresses</span>&nbsp;<span class="op" id="4405387">[</span><span class="op" id="4405388">]</span><span class="ident" id="4405389">net</span><span class="op" id="4405392">.</span><span class="ident" id="4405393">IP</span><span class="op" id="4405395">,</span>&nbsp;<span class="ident" id="4405397">err</span>&nbsp;<span class="builtintype" id="4405401">error</span><span class="op" id="4405406">)</span>&nbsp;<span class="op" id="4405408">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4405411">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4405434">//&nbsp;SubjectAltName&nbsp;::=&nbsp;GeneralNames</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4405470">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4405474">//&nbsp;GeneralNames&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;GeneralName</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4405533">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4405537">//&nbsp;GeneralName&nbsp;::=&nbsp;CHOICE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4405566">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;otherName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OtherName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4405626">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rfc822Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4405686">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dNSName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4405746">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x400Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORAddress,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4405806">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directoryName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4405861">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ediPartyName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[5]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EDIPartyName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4405924">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uniformResourceIdentifier&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[6]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4405984">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iPAddress&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[7]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OCTET&nbsp;STRING,</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4406047">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;registeredID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406116">var</span>&nbsp;<span class="ident" id="4406120">seq</span>&nbsp;<span class="ident" id="4406124">asn1</span><span class="op" id="4406128">.</span><span class="ident" id="4406129">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406139">if</span>&nbsp;<span class="ident" id="4406142">_</span><span class="op" id="4406143">,</span>&nbsp;<span class="ident" id="4406145">err</span>&nbsp;<span class="op" id="4406149">=</span>&nbsp;<span class="ident" id="4406151">asn1</span><span class="op" id="4406155">.</span><span class="ident" id="4406156">Unmarshal</span><span class="op" id="4406165">(</span><span class="ident" id="4406166">value</span><span class="op" id="4406171">,</span>&nbsp;<span class="op" id="4406173">&amp;</span><span class="ident" id="4406174">seq</span><span class="op" id="4406177">)</span><span class="op" id="4406178">;</span>&nbsp;<span class="ident" id="4406180">err</span>&nbsp;<span class="op" id="4406184">!=</span>&nbsp;<span class="builtintype" id="4406187">nil</span>&nbsp;<span class="op" id="4406191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406195">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4406203">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406206">if</span>&nbsp;<span class="op" id="4406209">!</span><span class="ident" id="4406210">seq</span><span class="op" id="4406213">.</span><span class="ident" id="4406214">IsCompound</span>&nbsp;<span class="op" id="4406225">||</span>&nbsp;<span class="ident" id="4406228">seq</span><span class="op" id="4406231">.</span><span class="ident" id="4406232">Tag</span>&nbsp;<span class="op" id="4406236">!=</span>&nbsp;<span class="num" id="4406239">16</span>&nbsp;<span class="op" id="4406242">||</span>&nbsp;<span class="ident" id="4406245">seq</span><span class="op" id="4406248">.</span><span class="ident" id="4406249">Class</span>&nbsp;<span class="op" id="4406255">!=</span>&nbsp;<span class="num" id="4406258">0</span>&nbsp;<span class="op" id="4406260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4406264">err</span>&nbsp;<span class="op" id="4406268">=</span>&nbsp;<span class="ident" id="4406270">asn1</span><span class="op" id="4406274">.</span><span class="ident" id="4406275">StructuralError</span><span class="op" id="4406290">{</span><span class="ident" id="4406291">Msg</span><span class="op" id="4406294">:</span>&nbsp;<span class="string" id="4406296">&#34;bad&nbsp;SAN&nbsp;sequence&#34;</span><span class="op" id="4406314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406318">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4406326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4406330">rest</span>&nbsp;<span class="op" id="4406335">:=</span>&nbsp;<span class="ident" id="4406338">seq</span><span class="op" id="4406341">.</span><span class="ident" id="4406342">Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406349">for</span>&nbsp;<span class="builtinfunc" id="4406353">len</span><span class="op" id="4406356">(</span><span class="ident" id="4406357">rest</span><span class="op" id="4406361">)</span>&nbsp;<span class="op" id="4406363">&gt;</span>&nbsp;<span class="num" id="4406365">0</span>&nbsp;<span class="op" id="4406367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406371">var</span>&nbsp;<span class="ident" id="4406375">v</span>&nbsp;<span class="ident" id="4406377">asn1</span><span class="op" id="4406381">.</span><span class="ident" id="4406382">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4406393">rest</span><span class="op" id="4406397">,</span>&nbsp;<span class="ident" id="4406399">err</span>&nbsp;<span class="op" id="4406403">=</span>&nbsp;<span class="ident" id="4406405">asn1</span><span class="op" id="4406409">.</span><span class="ident" id="4406410">Unmarshal</span><span class="op" id="4406419">(</span><span class="ident" id="4406420">rest</span><span class="op" id="4406424">,</span>&nbsp;<span class="op" id="4406426">&amp;</span><span class="ident" id="4406427">v</span><span class="op" id="4406428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406432">if</span>&nbsp;<span class="ident" id="4406435">err</span>&nbsp;<span class="op" id="4406439">!=</span>&nbsp;<span class="builtintype" id="4406442">nil</span>&nbsp;<span class="op" id="4406446">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406451">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4406460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406464">switch</span>&nbsp;<span class="ident" id="4406471">v</span><span class="op" id="4406472">.</span><span class="ident" id="4406473">Tag</span>&nbsp;<span class="op" id="4406477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406481">case</span>&nbsp;<span class="num" id="4406486">1</span><span class="op" id="4406487">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4406492">emailAddresses</span>&nbsp;<span class="op" id="4406507">=</span>&nbsp;<span class="builtinfunc" id="4406509">append</span><span class="op" id="4406515">(</span><span class="ident" id="4406516">emailAddresses</span><span class="op" id="4406530">,</span>&nbsp;<span class="builtintype" id="4406532">string</span><span class="op" id="4406538">(</span><span class="ident" id="4406539">v</span><span class="op" id="4406540">.</span><span class="ident" id="4406541">Bytes</span><span class="op" id="4406546">)</span><span class="op" id="4406547">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406551">case</span>&nbsp;<span class="num" id="4406556">2</span><span class="op" id="4406557">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4406562">dnsNames</span>&nbsp;<span class="op" id="4406571">=</span>&nbsp;<span class="builtinfunc" id="4406573">append</span><span class="op" id="4406579">(</span><span class="ident" id="4406580">dnsNames</span><span class="op" id="4406588">,</span>&nbsp;<span class="builtintype" id="4406590">string</span><span class="op" id="4406596">(</span><span class="ident" id="4406597">v</span><span class="op" id="4406598">.</span><span class="ident" id="4406599">Bytes</span><span class="op" id="4406604">)</span><span class="op" id="4406605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406609">case</span>&nbsp;<span class="num" id="4406614">7</span><span class="op" id="4406615">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406620">switch</span>&nbsp;<span class="builtinfunc" id="4406627">len</span><span class="op" id="4406630">(</span><span class="ident" id="4406631">v</span><span class="op" id="4406632">.</span><span class="ident" id="4406633">Bytes</span><span class="op" id="4406638">)</span>&nbsp;<span class="op" id="4406640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406645">case</span>&nbsp;<span class="ident" id="4406650">net</span><span class="op" id="4406653">.</span><span class="ident" id="4406654">IPv4len</span><span class="op" id="4406661">,</span>&nbsp;<span class="ident" id="4406663">net</span><span class="op" id="4406666">.</span><span class="ident" id="4406667">IPv6len</span><span class="op" id="4406674">:</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4406680">ipAddresses</span>&nbsp;<span class="op" id="4406692">=</span>&nbsp;<span class="builtinfunc" id="4406694">append</span><span class="op" id="4406700">(</span><span class="ident" id="4406701">ipAddresses</span><span class="op" id="4406712">,</span>&nbsp;<span class="ident" id="4406714">v</span><span class="op" id="4406715">.</span><span class="ident" id="4406716">Bytes</span><span class="op" id="4406721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406726">default</span><span class="op" id="4406733">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4406739">err</span>&nbsp;<span class="op" id="4406743">=</span>&nbsp;<span class="ident" id="4406745">errors</span><span class="op" id="4406751">.</span><span class="ident" id="4406752">New</span><span class="op" id="4406755">(</span><span class="string" id="4406756">&#34;x509:&nbsp;certificate&nbsp;contained&nbsp;IP&nbsp;address&nbsp;of&nbsp;length&nbsp;&#34;</span>&nbsp;<span class="op" id="4406808">+</span>&nbsp;<span class="ident" id="4406810">strconv</span><span class="op" id="4406817">.</span><span class="ident" id="4406818">Itoa</span><span class="op" id="4406822">(</span><span class="builtinfunc" id="4406823">len</span><span class="op" id="4406826">(</span><span class="ident" id="4406827">v</span><span class="op" id="4406828">.</span><span class="ident" id="4406829">Bytes</span><span class="op" id="4406834">)</span><span class="op" id="4406835">)</span><span class="op" id="4406836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406842">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4406852">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4406856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4406859">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406863">return</span><br>
<span class="lineno"></span><span class="op" id="4406870">}</span><br>
<span class="lineno">850</span><br>
<span class="lineno"></span><span class="keyword" id="4406873">func</span>&nbsp;<span class="ident" id="4406878">parseCertificate</span><span class="op" id="4406894">(</span><span class="ident" id="4406895">in</span>&nbsp;<span class="op" id="4406898">*</span><span class="ident" id="4406899">certificate</span><span class="op" id="4406910">)</span>&nbsp;<span class="op" id="4406912">(</span><span class="op" id="4406913">*</span><span class="ident" id="4406914">Certificate</span><span class="op" id="4406925">,</span>&nbsp;<span class="builtintype" id="4406927">error</span><span class="op" id="4406932">)</span>&nbsp;<span class="op" id="4406934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4406937">out</span>&nbsp;<span class="op" id="4406941">:=</span>&nbsp;<span class="builtinfunc" id="4406944">new</span><span class="op" id="4406947">(</span><span class="ident" id="4406948">Certificate</span><span class="op" id="4406959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4406962">out</span><span class="op" id="4406965">.</span><span class="ident" id="4406966">Raw</span>&nbsp;<span class="op" id="4406970">=</span>&nbsp;<span class="ident" id="4406972">in</span><span class="op" id="4406974">.</span><span class="ident" id="4406975">Raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4406980">out</span><span class="op" id="4406983">.</span><span class="ident" id="4406984">RawTBSCertificate</span>&nbsp;<span class="op" id="4407002">=</span>&nbsp;<span class="ident" id="4407004">in</span><span class="op" id="4407006">.</span><span class="ident" id="4407007">TBSCertificate</span><span class="op" id="4407021">.</span><span class="ident" id="4407022">Raw</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4407027">out</span><span class="op" id="4407030">.</span><span class="ident" id="4407031">RawSubjectPublicKeyInfo</span>&nbsp;<span class="op" id="4407055">=</span>&nbsp;<span class="ident" id="4407057">in</span><span class="op" id="4407059">.</span><span class="ident" id="4407060">TBSCertificate</span><span class="op" id="4407074">.</span><span class="ident" id="4407075">PublicKey</span><span class="op" id="4407084">.</span><span class="ident" id="4407085">Raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4407090">out</span><span class="op" id="4407093">.</span><span class="ident" id="4407094">RawSubject</span>&nbsp;<span class="op" id="4407105">=</span>&nbsp;<span class="ident" id="4407107">in</span><span class="op" id="4407109">.</span><span class="ident" id="4407110">TBSCertificate</span><span class="op" id="4407124">.</span><span class="ident" id="4407125">Subject</span><span class="op" id="4407132">.</span><span class="ident" id="4407133">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4407144">out</span><span class="op" id="4407147">.</span><span class="ident" id="4407148">RawIssuer</span>&nbsp;<span class="op" id="4407158">=</span>&nbsp;<span class="ident" id="4407160">in</span><span class="op" id="4407162">.</span><span class="ident" id="4407163">TBSCertificate</span><span class="op" id="4407177">.</span><span class="ident" id="4407178">Issuer</span><span class="op" id="4407184">.</span><span class="ident" id="4407185">FullBytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4407197">out</span><span class="op" id="4407200">.</span><span class="ident" id="4407201">Signature</span>&nbsp;<span class="op" id="4407211">=</span>&nbsp;<span class="ident" id="4407213">in</span><span class="op" id="4407215">.</span><span class="ident" id="4407216">SignatureValue</span><span class="op" id="4407230">.</span><span class="ident" id="4407231">RightAlign</span><span class="op" id="4407241">(</span><span class="op" id="4407242">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4407245">out</span><span class="op" id="4407248">.</span><span class="ident" id="4407249">SignatureAlgorithm</span>&nbsp;<span class="op" id="4407268">=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4407272">getSignatureAlgorithmFromOID</span><span class="op" id="4407300">(</span><span class="ident" id="4407301">in</span><span class="op" id="4407303">.</span><span class="ident" id="4407304">TBSCertificate</span><span class="op" id="4407318">.</span><span class="ident" id="4407319">SignatureAlgorithm</span><span class="op" id="4407337">.</span><span class="ident" id="4407338">Algorithm</span><span class="op" id="4407347">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4407351">out</span><span class="op" id="4407354">.</span><span class="ident" id="4407355">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="4407374">=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4407378">getPublicKeyAlgorithmFromOID</span><span class="op" id="4407406">(</span><span class="ident" id="4407407">in</span><span class="op" id="4407409">.</span><span class="ident" id="4407410">TBSCertificate</span><span class="op" id="4407424">.</span><span class="ident" id="4407425">PublicKey</span><span class="op" id="4407434">.</span><span class="ident" id="4407435">Algorithm</span><span class="op" id="4407444">.</span><span class="ident" id="4407445">Algorithm</span><span class="op" id="4407454">)</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407457">var</span>&nbsp;<span class="ident" id="4407461">err</span>&nbsp;<span class="builtintype" id="4407465">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4407472">out</span><span class="op" id="4407475">.</span><span class="ident" id="4407476">PublicKey</span><span class="op" id="4407485">,</span>&nbsp;<span class="ident" id="4407487">err</span>&nbsp;<span class="op" id="4407491">=</span>&nbsp;<span class="ident" id="4407493">parsePublicKey</span><span class="op" id="4407507">(</span><span class="ident" id="4407508">out</span><span class="op" id="4407511">.</span><span class="ident" id="4407512">PublicKeyAlgorithm</span><span class="op" id="4407530">,</span>&nbsp;<span class="op" id="4407532">&amp;</span><span class="ident" id="4407533">in</span><span class="op" id="4407535">.</span><span class="ident" id="4407536">TBSCertificate</span><span class="op" id="4407550">.</span><span class="ident" id="4407551">PublicKey</span><span class="op" id="4407560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407563">if</span>&nbsp;<span class="ident" id="4407566">err</span>&nbsp;<span class="op" id="4407570">!=</span>&nbsp;<span class="builtintype" id="4407573">nil</span>&nbsp;<span class="op" id="4407577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407581">return</span>&nbsp;<span class="builtintype" id="4407588">nil</span><span class="op" id="4407591">,</span>&nbsp;<span class="ident" id="4407593">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4407598">}</span><br>
<span class="lineno">870</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407602">if</span>&nbsp;<span class="ident" id="4407605">in</span><span class="op" id="4407607">.</span><span class="ident" id="4407608">TBSCertificate</span><span class="op" id="4407622">.</span><span class="ident" id="4407623">SerialNumber</span><span class="op" id="4407635">.</span><span class="ident" id="4407636">Sign</span><span class="op" id="4407640">(</span><span class="op" id="4407641">)</span>&nbsp;<span class="op" id="4407643">&lt;</span>&nbsp;<span class="num" id="4407645">0</span>&nbsp;<span class="op" id="4407647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407651">return</span>&nbsp;<span class="builtintype" id="4407658">nil</span><span class="op" id="4407661">,</span>&nbsp;<span class="ident" id="4407663">errors</span><span class="op" id="4407669">.</span><span class="ident" id="4407670">New</span><span class="op" id="4407673">(</span><span class="string" id="4407674">&#34;x509:&nbsp;negative&nbsp;serial&nbsp;number&#34;</span><span class="op" id="4407704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4407707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4407711">out</span><span class="op" id="4407714">.</span><span class="ident" id="4407715">Version</span>&nbsp;<span class="op" id="4407723">=</span>&nbsp;<span class="ident" id="4407725">in</span><span class="op" id="4407727">.</span><span class="ident" id="4407728">TBSCertificate</span><span class="op" id="4407742">.</span><span class="ident" id="4407743">Version</span>&nbsp;<span class="op" id="4407751">+</span>&nbsp;<span class="num" id="4407753">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4407756">out</span><span class="op" id="4407759">.</span><span class="ident" id="4407760">SerialNumber</span>&nbsp;<span class="op" id="4407773">=</span>&nbsp;<span class="ident" id="4407775">in</span><span class="op" id="4407777">.</span><span class="ident" id="4407778">TBSCertificate</span><span class="op" id="4407792">.</span><span class="ident" id="4407793">SerialNumber</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407808">var</span>&nbsp;<span class="ident" id="4407812">issuer</span><span class="op" id="4407818">,</span>&nbsp;<span class="ident" id="4407820">subject</span>&nbsp;<span class="ident" id="4407828">pkix</span><span class="op" id="4407832">.</span><span class="ident" id="4407833">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407846">if</span>&nbsp;<span class="ident" id="4407849">_</span><span class="op" id="4407850">,</span>&nbsp;<span class="ident" id="4407852">err</span>&nbsp;<span class="op" id="4407856">:=</span>&nbsp;<span class="ident" id="4407859">asn1</span><span class="op" id="4407863">.</span><span class="ident" id="4407864">Unmarshal</span><span class="op" id="4407873">(</span><span class="ident" id="4407874">in</span><span class="op" id="4407876">.</span><span class="ident" id="4407877">TBSCertificate</span><span class="op" id="4407891">.</span><span class="ident" id="4407892">Subject</span><span class="op" id="4407899">.</span><span class="ident" id="4407900">FullBytes</span><span class="op" id="4407909">,</span>&nbsp;<span class="op" id="4407911">&amp;</span><span class="ident" id="4407912">subject</span><span class="op" id="4407919">)</span><span class="op" id="4407920">;</span>&nbsp;<span class="ident" id="4407922">err</span>&nbsp;<span class="op" id="4407926">!=</span>&nbsp;<span class="builtintype" id="4407929">nil</span>&nbsp;<span class="op" id="4407933">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407937">return</span>&nbsp;<span class="builtintype" id="4407944">nil</span><span class="op" id="4407947">,</span>&nbsp;<span class="ident" id="4407949">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4407954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407957">if</span>&nbsp;<span class="ident" id="4407960">_</span><span class="op" id="4407961">,</span>&nbsp;<span class="ident" id="4407963">err</span>&nbsp;<span class="op" id="4407967">:=</span>&nbsp;<span class="ident" id="4407970">asn1</span><span class="op" id="4407974">.</span><span class="ident" id="4407975">Unmarshal</span><span class="op" id="4407984">(</span><span class="ident" id="4407985">in</span><span class="op" id="4407987">.</span><span class="ident" id="4407988">TBSCertificate</span><span class="op" id="4408002">.</span><span class="ident" id="4408003">Issuer</span><span class="op" id="4408009">.</span><span class="ident" id="4408010">FullBytes</span><span class="op" id="4408019">,</span>&nbsp;<span class="op" id="4408021">&amp;</span><span class="ident" id="4408022">issuer</span><span class="op" id="4408028">)</span><span class="op" id="4408029">;</span>&nbsp;<span class="ident" id="4408031">err</span>&nbsp;<span class="op" id="4408035">!=</span>&nbsp;<span class="builtintype" id="4408038">nil</span>&nbsp;<span class="op" id="4408042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4408046">return</span>&nbsp;<span class="builtintype" id="4408053">nil</span><span class="op" id="4408056">,</span>&nbsp;<span class="ident" id="4408058">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4408063">}</span><br>
<span class="lineno">885</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408067">out</span><span class="op" id="4408070">.</span><span class="ident" id="4408071">Issuer</span><span class="op" id="4408077">.</span><span class="ident" id="4408078">FillFromRDNSequence</span><span class="op" id="4408097">(</span><span class="op" id="4408098">&amp;</span><span class="ident" id="4408099">issuer</span><span class="op" id="4408105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408108">out</span><span class="op" id="4408111">.</span><span class="ident" id="4408112">Subject</span><span class="op" id="4408119">.</span><span class="ident" id="4408120">FillFromRDNSequence</span><span class="op" id="4408139">(</span><span class="op" id="4408140">&amp;</span><span class="ident" id="4408141">subject</span><span class="op" id="4408148">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408152">out</span><span class="op" id="4408155">.</span><span class="ident" id="4408156">NotBefore</span>&nbsp;<span class="op" id="4408166">=</span>&nbsp;<span class="ident" id="4408168">in</span><span class="op" id="4408170">.</span><span class="ident" id="4408171">TBSCertificate</span><span class="op" id="4408185">.</span><span class="ident" id="4408186">Validity</span><span class="op" id="4408194">.</span><span class="ident" id="4408195">NotBefore</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408206">out</span><span class="op" id="4408209">.</span><span class="ident" id="4408210">NotAfter</span>&nbsp;<span class="op" id="4408219">=</span>&nbsp;<span class="ident" id="4408221">in</span><span class="op" id="4408223">.</span><span class="ident" id="4408224">TBSCertificate</span><span class="op" id="4408238">.</span><span class="ident" id="4408239">Validity</span><span class="op" id="4408247">.</span><span class="ident" id="4408248">NotAfter</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4408259">for</span>&nbsp;<span class="ident" id="4408263">_</span><span class="op" id="4408264">,</span>&nbsp;<span class="ident" id="4408266">e</span>&nbsp;<span class="op" id="4408268">:=</span>&nbsp;<span class="keyword" id="4408271">range</span>&nbsp;<span class="ident" id="4408277">in</span><span class="op" id="4408279">.</span><span class="ident" id="4408280">TBSCertificate</span><span class="op" id="4408294">.</span><span class="ident" id="4408295">Extensions</span>&nbsp;<span class="op" id="4408306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408310">out</span><span class="op" id="4408313">.</span><span class="ident" id="4408314">Extensions</span>&nbsp;<span class="op" id="4408325">=</span>&nbsp;<span class="builtinfunc" id="4408327">append</span><span class="op" id="4408333">(</span><span class="ident" id="4408334">out</span><span class="op" id="4408337">.</span><span class="ident" id="4408338">Extensions</span><span class="op" id="4408348">,</span>&nbsp;<span class="ident" id="4408350">e</span><span class="op" id="4408351">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4408356">if</span>&nbsp;<span class="builtinfunc" id="4408359">len</span><span class="op" id="4408362">(</span><span class="ident" id="4408363">e</span><span class="op" id="4408364">.</span><span class="ident" id="4408365">Id</span><span class="op" id="4408367">)</span>&nbsp;<span class="op" id="4408369">==</span>&nbsp;<span class="num" id="4408372">4</span>&nbsp;<span class="op" id="4408374">&amp;&amp;</span>&nbsp;<span class="ident" id="4408377">e</span><span class="op" id="4408378">.</span><span class="ident" id="4408379">Id</span><span class="op" id="4408381">[</span><span class="num" id="4408382">0</span><span class="op" id="4408383">]</span>&nbsp;<span class="op" id="4408385">==</span>&nbsp;<span class="num" id="4408388">2</span>&nbsp;<span class="op" id="4408390">&amp;&amp;</span>&nbsp;<span class="ident" id="4408393">e</span><span class="op" id="4408394">.</span><span class="ident" id="4408395">Id</span><span class="op" id="4408397">[</span><span class="num" id="4408398">1</span><span class="op" id="4408399">]</span>&nbsp;<span class="op" id="4408401">==</span>&nbsp;<span class="num" id="4408404">5</span>&nbsp;<span class="op" id="4408406">&amp;&amp;</span>&nbsp;<span class="ident" id="4408409">e</span><span class="op" id="4408410">.</span><span class="ident" id="4408411">Id</span><span class="op" id="4408413">[</span><span class="num" id="4408414">2</span><span class="op" id="4408415">]</span>&nbsp;<span class="op" id="4408417">==</span>&nbsp;<span class="num" id="4408420">29</span>&nbsp;<span class="op" id="4408423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4408428">switch</span>&nbsp;<span class="ident" id="4408435">e</span><span class="op" id="4408436">.</span><span class="ident" id="4408437">Id</span><span class="op" id="4408439">[</span><span class="num" id="4408440">3</span><span class="op" id="4408441">]</span>&nbsp;<span class="op" id="4408443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4408448">case</span>&nbsp;<span class="num" id="4408453">15</span><span class="op" id="4408455">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4408461">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4408486">var</span>&nbsp;<span class="ident" id="4408490">usageBits</span>&nbsp;<span class="ident" id="4408500">asn1</span><span class="op" id="4408504">.</span><span class="ident" id="4408505">BitString</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408519">_</span><span class="op" id="4408520">,</span>&nbsp;<span class="ident" id="4408522">err</span>&nbsp;<span class="op" id="4408526">:=</span>&nbsp;<span class="ident" id="4408529">asn1</span><span class="op" id="4408533">.</span><span class="ident" id="4408534">Unmarshal</span><span class="op" id="4408543">(</span><span class="ident" id="4408544">e</span><span class="op" id="4408545">.</span><span class="ident" id="4408546">Value</span><span class="op" id="4408551">,</span>&nbsp;<span class="op" id="4408553">&amp;</span><span class="ident" id="4408554">usageBits</span><span class="op" id="4408563">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4408570">if</span>&nbsp;<span class="ident" id="4408573">err</span>&nbsp;<span class="op" id="4408577">==</span>&nbsp;<span class="builtintype" id="4408580">nil</span>&nbsp;<span class="op" id="4408584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4408591">var</span>&nbsp;<span class="ident" id="4408595">usage</span>&nbsp;<span class="builtintype" id="4408601">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4408610">for</span>&nbsp;<span class="ident" id="4408614">i</span>&nbsp;<span class="op" id="4408616">:=</span>&nbsp;<span class="num" id="4408619">0</span><span class="op" id="4408620">;</span>&nbsp;<span class="ident" id="4408622">i</span>&nbsp;<span class="op" id="4408624">&lt;</span>&nbsp;<span class="num" id="4408626">9</span><span class="op" id="4408627">;</span>&nbsp;<span class="ident" id="4408629">i</span><span class="op" id="4408630">++</span>&nbsp;<span class="op" id="4408633">{</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4408641">if</span>&nbsp;<span class="ident" id="4408644">usageBits</span><span class="op" id="4408653">.</span><span class="ident" id="4408654">At</span><span class="op" id="4408656">(</span><span class="ident" id="4408657">i</span><span class="op" id="4408658">)</span>&nbsp;<span class="op" id="4408660">!=</span>&nbsp;<span class="num" id="4408663">0</span>&nbsp;<span class="op" id="4408665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408674">usage</span>&nbsp;<span class="op" id="4408680">|=</span>&nbsp;<span class="num" id="4408683">1</span>&nbsp;<span class="op" id="4408685">&lt;&lt;</span>&nbsp;<span class="builtintype" id="4408688">uint</span><span class="op" id="4408692">(</span><span class="ident" id="4408693">i</span><span class="op" id="4408694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4408702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4408709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408716">out</span><span class="op" id="4408719">.</span><span class="ident" id="4408720">KeyUsage</span>&nbsp;<span class="op" id="4408729">=</span>&nbsp;<span class="ident" id="4408731">KeyUsage</span><span class="op" id="4408739">(</span><span class="ident" id="4408740">usage</span><span class="op" id="4408745">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4408752">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4408765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4408770">case</span>&nbsp;<span class="num" id="4408775">19</span><span class="op" id="4408777">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4408783">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4408808">var</span>&nbsp;<span class="ident" id="4408812">constraints</span>&nbsp;<span class="ident" id="4408824">basicConstraints</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408845">_</span><span class="op" id="4408846">,</span>&nbsp;<span class="ident" id="4408848">err</span>&nbsp;<span class="op" id="4408852">:=</span>&nbsp;<span class="ident" id="4408855">asn1</span><span class="op" id="4408859">.</span><span class="ident" id="4408860">Unmarshal</span><span class="op" id="4408869">(</span><span class="ident" id="4408870">e</span><span class="op" id="4408871">.</span><span class="ident" id="4408872">Value</span><span class="op" id="4408877">,</span>&nbsp;<span class="op" id="4408879">&amp;</span><span class="ident" id="4408880">constraints</span><span class="op" id="4408891">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4408898">if</span>&nbsp;<span class="ident" id="4408901">err</span>&nbsp;<span class="op" id="4408905">==</span>&nbsp;<span class="builtintype" id="4408908">nil</span>&nbsp;<span class="op" id="4408912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408919">out</span><span class="op" id="4408922">.</span><span class="ident" id="4408923">BasicConstraintsValid</span>&nbsp;<span class="op" id="4408945">=</span>&nbsp;<span class="builtintype" id="4408947">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408957">out</span><span class="op" id="4408960">.</span><span class="ident" id="4408961">IsCA</span>&nbsp;<span class="op" id="4408966">=</span>&nbsp;<span class="ident" id="4408968">constraints</span><span class="op" id="4408979">.</span><span class="ident" id="4408980">IsCA</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408990">out</span><span class="op" id="4408993">.</span><span class="ident" id="4408994">MaxPathLen</span>&nbsp;<span class="op" id="4409005">=</span>&nbsp;<span class="ident" id="4409007">constraints</span><span class="op" id="4409018">.</span><span class="ident" id="4409019">MaxPathLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4409035">out</span><span class="op" id="4409038">.</span><span class="ident" id="4409039">MaxPathLenZero</span>&nbsp;<span class="op" id="4409054">=</span>&nbsp;<span class="ident" id="4409056">out</span><span class="op" id="4409059">.</span><span class="ident" id="4409060">MaxPathLen</span>&nbsp;<span class="op" id="4409071">==</span>&nbsp;<span class="num" id="4409074">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4409081">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4409094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4409099">case</span>&nbsp;<span class="num" id="4409104">17</span><span class="op" id="4409106">:</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4409112">out</span><span class="op" id="4409115">.</span><span class="ident" id="4409116">DNSNames</span><span class="op" id="4409124">,</span>&nbsp;<span class="ident" id="4409126">out</span><span class="op" id="4409129">.</span><span class="ident" id="4409130">EmailAddresses</span><span class="op" id="4409144">,</span>&nbsp;<span class="ident" id="4409146">out</span><span class="op" id="4409149">.</span><span class="ident" id="4409150">IPAddresses</span><span class="op" id="4409161">,</span>&nbsp;<span class="ident" id="4409163">err</span>&nbsp;<span class="op" id="4409167">=</span>&nbsp;<span class="ident" id="4409169">parseSANExtension</span><span class="op" id="4409186">(</span><span class="ident" id="4409187">e</span><span class="op" id="4409188">.</span><span class="ident" id="4409189">Value</span><span class="op" id="4409194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4409200">if</span>&nbsp;<span class="ident" id="4409203">err</span>&nbsp;<span class="op" id="4409207">!=</span>&nbsp;<span class="builtintype" id="4409210">nil</span>&nbsp;<span class="op" id="4409214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4409221">return</span>&nbsp;<span class="builtintype" id="4409228">nil</span><span class="op" id="4409231">,</span>&nbsp;<span class="ident" id="4409233">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4409241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4409248">if</span>&nbsp;<span class="builtinfunc" id="4409251">len</span><span class="op" id="4409254">(</span><span class="ident" id="4409255">out</span><span class="op" id="4409258">.</span><span class="ident" id="4409259">DNSNames</span><span class="op" id="4409267">)</span>&nbsp;<span class="op" id="4409269">&gt;</span>&nbsp;<span class="num" id="4409271">0</span>&nbsp;<span class="op" id="4409273">||</span>&nbsp;<span class="builtinfunc" id="4409276">len</span><span class="op" id="4409279">(</span><span class="ident" id="4409280">out</span><span class="op" id="4409283">.</span><span class="ident" id="4409284">EmailAddresses</span><span class="op" id="4409298">)</span>&nbsp;<span class="op" id="4409300">&gt;</span>&nbsp;<span class="num" id="4409302">0</span>&nbsp;<span class="op" id="4409304">||</span>&nbsp;<span class="builtinfunc" id="4409307">len</span><span class="op" id="4409310">(</span><span class="ident" id="4409311">out</span><span class="op" id="4409314">.</span><span class="ident" id="4409315">IPAddresses</span><span class="op" id="4409326">)</span>&nbsp;<span class="op" id="4409328">&gt;</span>&nbsp;<span class="num" id="4409330">0</span>&nbsp;<span class="op" id="4409332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4409339">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4409352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4409358">//&nbsp;If&nbsp;we&nbsp;didn&#39;t&nbsp;parse&nbsp;any&nbsp;of&nbsp;the&nbsp;names&nbsp;then&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4409409">//&nbsp;fall&nbsp;through&nbsp;to&nbsp;the&nbsp;critical&nbsp;check&nbsp;below.</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4409458">case</span>&nbsp;<span class="num" id="4409463">30</span><span class="op" id="4409465">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4409471">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.10</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4409498">//&nbsp;NameConstraints&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4409536">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permittedSubtrees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralSubtrees&nbsp;OPTIONAL,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4409606">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;excludedSubtrees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralSubtrees&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4409677">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4409684">//&nbsp;GeneralSubtrees&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;GeneralSubtree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4409752">//</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4409759">//&nbsp;GeneralSubtree&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4409796">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4409845">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseDistance&nbsp;DEFAULT&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4409905">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maximum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseDistance&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4409965">//</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4409972">//&nbsp;BaseDistance&nbsp;::=&nbsp;INTEGER&nbsp;(0..MAX)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4410014">var</span>&nbsp;<span class="ident" id="4410018">constraints</span>&nbsp;<span class="ident" id="4410030">nameConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4410050">_</span><span class="op" id="4410051">,</span>&nbsp;<span class="ident" id="4410053">err</span>&nbsp;<span class="op" id="4410057">:=</span>&nbsp;<span class="ident" id="4410060">asn1</span><span class="op" id="4410064">.</span><span class="ident" id="4410065">Unmarshal</span><span class="op" id="4410074">(</span><span class="ident" id="4410075">e</span><span class="op" id="4410076">.</span><span class="ident" id="4410077">Value</span><span class="op" id="4410082">,</span>&nbsp;<span class="op" id="4410084">&amp;</span><span class="ident" id="4410085">constraints</span><span class="op" id="4410096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4410102">if</span>&nbsp;<span class="ident" id="4410105">err</span>&nbsp;<span class="op" id="4410109">!=</span>&nbsp;<span class="builtintype" id="4410112">nil</span>&nbsp;<span class="op" id="4410116">{</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4410123">return</span>&nbsp;<span class="builtintype" id="4410130">nil</span><span class="op" id="4410133">,</span>&nbsp;<span class="ident" id="4410135">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4410143">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4410150">if</span>&nbsp;<span class="builtinfunc" id="4410153">len</span><span class="op" id="4410156">(</span><span class="ident" id="4410157">constraints</span><span class="op" id="4410168">.</span><span class="ident" id="4410169">Excluded</span><span class="op" id="4410177">)</span>&nbsp;<span class="op" id="4410179">&gt;</span>&nbsp;<span class="num" id="4410181">0</span>&nbsp;<span class="op" id="4410183">&amp;&amp;</span>&nbsp;<span class="ident" id="4410186">e</span><span class="op" id="4410187">.</span><span class="ident" id="4410188">Critical</span>&nbsp;<span class="op" id="4410197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4410204">return</span>&nbsp;<span class="ident" id="4410211">out</span><span class="op" id="4410214">,</span>&nbsp;<span class="ident" id="4410216">UnhandledCriticalExtension</span><span class="op" id="4410242">{</span><span class="op" id="4410243">}</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4410249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4410256">for</span>&nbsp;<span class="ident" id="4410260">_</span><span class="op" id="4410261">,</span>&nbsp;<span class="ident" id="4410263">subtree</span>&nbsp;<span class="op" id="4410271">:=</span>&nbsp;<span class="keyword" id="4410274">range</span>&nbsp;<span class="ident" id="4410280">constraints</span><span class="op" id="4410291">.</span><span class="ident" id="4410292">Permitted</span>&nbsp;<span class="op" id="4410302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4410309">if</span>&nbsp;<span class="builtinfunc" id="4410312">len</span><span class="op" id="4410315">(</span><span class="ident" id="4410316">subtree</span><span class="op" id="4410323">.</span><span class="ident" id="4410324">Name</span><span class="op" id="4410328">)</span>&nbsp;<span class="op" id="4410330">==</span>&nbsp;<span class="num" id="4410333">0</span>&nbsp;<span class="op" id="4410335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4410343">if</span>&nbsp;<span class="ident" id="4410346">e</span><span class="op" id="4410347">.</span><span class="ident" id="4410348">Critical</span>&nbsp;<span class="op" id="4410357">{</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4410366">return</span>&nbsp;<span class="ident" id="4410373">out</span><span class="op" id="4410376">,</span>&nbsp;<span class="ident" id="4410378">UnhandledCriticalExtension</span><span class="op" id="4410404">{</span><span class="op" id="4410405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4410413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4410421">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4410435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4410442">out</span><span class="op" id="4410445">.</span><span class="ident" id="4410446">PermittedDNSDomains</span>&nbsp;<span class="op" id="4410466">=</span>&nbsp;<span class="builtinfunc" id="4410468">append</span><span class="op" id="4410474">(</span><span class="ident" id="4410475">out</span><span class="op" id="4410478">.</span><span class="ident" id="4410479">PermittedDNSDomains</span><span class="op" id="4410498">,</span>&nbsp;<span class="ident" id="4410500">subtree</span><span class="op" id="4410507">.</span><span class="ident" id="4410508">Name</span><span class="op" id="4410512">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4410518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4410524">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4410537">case</span>&nbsp;<span class="num" id="4410542">31</span><span class="op" id="4410544">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4410550">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.14</span><br>
<span class="lineno">975</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4410577">//&nbsp;CRLDistributionPoints&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;DistributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4410654">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4410661">//&nbsp;DistributionPoint&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4410701">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distributionPoint&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DistributionPointName&nbsp;OPTIONAL,</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4410776">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reasons&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReasonFlags&nbsp;OPTIONAL,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4410841">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cRLIssuer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralNames&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4410908">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4410915">//&nbsp;DistributionPointName&nbsp;::=&nbsp;CHOICE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4410957">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fullName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralNames,</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4411014">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nameRelativeToCRLIssuer&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RelativeDistinguishedName&nbsp;}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4411086">var</span>&nbsp;<span class="ident" id="4411090">cdp</span>&nbsp;<span class="op" id="4411094">[</span><span class="op" id="4411095">]</span><span class="ident" id="4411096">distributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4411118">_</span><span class="op" id="4411119">,</span>&nbsp;<span class="ident" id="4411121">err</span>&nbsp;<span class="op" id="4411125">:=</span>&nbsp;<span class="ident" id="4411128">asn1</span><span class="op" id="4411132">.</span><span class="ident" id="4411133">Unmarshal</span><span class="op" id="4411142">(</span><span class="ident" id="4411143">e</span><span class="op" id="4411144">.</span><span class="ident" id="4411145">Value</span><span class="op" id="4411150">,</span>&nbsp;<span class="op" id="4411152">&amp;</span><span class="ident" id="4411153">cdp</span><span class="op" id="4411156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4411162">if</span>&nbsp;<span class="ident" id="4411165">err</span>&nbsp;<span class="op" id="4411169">!=</span>&nbsp;<span class="builtintype" id="4411172">nil</span>&nbsp;<span class="op" id="4411176">{</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4411183">return</span>&nbsp;<span class="builtintype" id="4411190">nil</span><span class="op" id="4411193">,</span>&nbsp;<span class="ident" id="4411195">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4411203">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4411210">for</span>&nbsp;<span class="ident" id="4411214">_</span><span class="op" id="4411215">,</span>&nbsp;<span class="ident" id="4411217">dp</span>&nbsp;<span class="op" id="4411220">:=</span>&nbsp;<span class="keyword" id="4411223">range</span>&nbsp;<span class="ident" id="4411229">cdp</span>&nbsp;<span class="op" id="4411233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4411240">var</span>&nbsp;<span class="ident" id="4411244">n</span>&nbsp;<span class="ident" id="4411246">asn1</span><span class="op" id="4411250">.</span><span class="ident" id="4411251">RawValue</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4411265">_</span><span class="op" id="4411266">,</span>&nbsp;<span class="ident" id="4411268">err</span>&nbsp;<span class="op" id="4411272">=</span>&nbsp;<span class="ident" id="4411274">asn1</span><span class="op" id="4411278">.</span><span class="ident" id="4411279">Unmarshal</span><span class="op" id="4411288">(</span><span class="ident" id="4411289">dp</span><span class="op" id="4411291">.</span><span class="ident" id="4411292">DistributionPoint</span><span class="op" id="4411309">.</span><span class="ident" id="4411310">FullName</span><span class="op" id="4411318">.</span><span class="ident" id="4411319">Bytes</span><span class="op" id="4411324">,</span>&nbsp;<span class="op" id="4411326">&amp;</span><span class="ident" id="4411327">n</span><span class="op" id="4411328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4411335">if</span>&nbsp;<span class="ident" id="4411338">err</span>&nbsp;<span class="op" id="4411342">!=</span>&nbsp;<span class="builtintype" id="4411345">nil</span>&nbsp;<span class="op" id="4411349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4411357">return</span>&nbsp;<span class="builtintype" id="4411364">nil</span><span class="op" id="4411367">,</span>&nbsp;<span class="ident" id="4411369">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4411378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4411386">if</span>&nbsp;<span class="ident" id="4411389">n</span><span class="op" id="4411390">.</span><span class="ident" id="4411391">Tag</span>&nbsp;<span class="op" id="4411395">==</span>&nbsp;<span class="num" id="4411398">6</span>&nbsp;<span class="op" id="4411400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4411408">out</span><span class="op" id="4411411">.</span><span class="ident" id="4411412">CRLDistributionPoints</span>&nbsp;<span class="op" id="4411434">=</span>&nbsp;<span class="builtinfunc" id="4411436">append</span><span class="op" id="4411442">(</span><span class="ident" id="4411443">out</span><span class="op" id="4411446">.</span><span class="ident" id="4411447">CRLDistributionPoints</span><span class="op" id="4411468">,</span>&nbsp;<span class="builtintype" id="4411470">string</span><span class="op" id="4411476">(</span><span class="ident" id="4411477">n</span><span class="op" id="4411478">.</span><span class="ident" id="4411479">Bytes</span><span class="op" id="4411484">)</span><span class="op" id="4411485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4411492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4411498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4411504">continue</span><br>
<span class="lineno">1005</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4411517">case</span>&nbsp;<span class="num" id="4411522">35</span><span class="op" id="4411524">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4411530">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4411555">var</span>&nbsp;<span class="ident" id="4411559">a</span>&nbsp;<span class="ident" id="4411561">authKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4411575">_</span><span class="op" id="4411576">,</span>&nbsp;<span class="ident" id="4411578">err</span>&nbsp;<span class="op" id="4411582">=</span>&nbsp;<span class="ident" id="4411584">asn1</span><span class="op" id="4411588">.</span><span class="ident" id="4411589">Unmarshal</span><span class="op" id="4411598">(</span><span class="ident" id="4411599">e</span><span class="op" id="4411600">.</span><span class="ident" id="4411601">Value</span><span class="op" id="4411606">,</span>&nbsp;<span class="op" id="4411608">&amp;</span><span class="ident" id="4411609">a</span><span class="op" id="4411610">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4411616">if</span>&nbsp;<span class="ident" id="4411619">err</span>&nbsp;<span class="op" id="4411623">!=</span>&nbsp;<span class="builtintype" id="4411626">nil</span>&nbsp;<span class="op" id="4411630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4411637">return</span>&nbsp;<span class="builtintype" id="4411644">nil</span><span class="op" id="4411647">,</span>&nbsp;<span class="ident" id="4411649">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4411657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4411663">out</span><span class="op" id="4411666">.</span><span class="ident" id="4411667">AuthorityKeyId</span>&nbsp;<span class="op" id="4411682">=</span>&nbsp;<span class="ident" id="4411684">a</span><span class="op" id="4411685">.</span><span class="ident" id="4411686">Id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4411693">continue</span><br>
<span class="lineno">1015</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4411706">case</span>&nbsp;<span class="num" id="4411711">37</span><span class="op" id="4411713">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4411719">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.12.&nbsp;&nbsp;Extended&nbsp;Key&nbsp;Usage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4411767">//&nbsp;id-ce-extKeyUsage&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-ce&nbsp;37&nbsp;}</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4411827">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4411834">//&nbsp;ExtKeyUsageSyntax&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;KeyPurposeId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4411902">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4411909">//&nbsp;KeyPurposeId&nbsp;::=&nbsp;OBJECT&nbsp;IDENTIFIER</span><br>
<span class="lineno"></span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4411952">var</span>&nbsp;<span class="ident" id="4411956">keyUsage</span>&nbsp;<span class="op" id="4411965">[</span><span class="op" id="4411966">]</span><span class="ident" id="4411967">asn1</span><span class="op" id="4411971">.</span><span class="ident" id="4411972">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4411993">_</span><span class="op" id="4411994">,</span>&nbsp;<span class="ident" id="4411996">err</span>&nbsp;<span class="op" id="4412000">=</span>&nbsp;<span class="ident" id="4412002">asn1</span><span class="op" id="4412006">.</span><span class="ident" id="4412007">Unmarshal</span><span class="op" id="4412016">(</span><span class="ident" id="4412017">e</span><span class="op" id="4412018">.</span><span class="ident" id="4412019">Value</span><span class="op" id="4412024">,</span>&nbsp;<span class="op" id="4412026">&amp;</span><span class="ident" id="4412027">keyUsage</span><span class="op" id="4412035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412041">if</span>&nbsp;<span class="ident" id="4412044">err</span>&nbsp;<span class="op" id="4412048">!=</span>&nbsp;<span class="builtintype" id="4412051">nil</span>&nbsp;<span class="op" id="4412055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412062">return</span>&nbsp;<span class="builtintype" id="4412069">nil</span><span class="op" id="4412072">,</span>&nbsp;<span class="ident" id="4412074">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4412082">}</span><br>
<span class="lineno">1030</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412089">for</span>&nbsp;<span class="ident" id="4412093">_</span><span class="op" id="4412094">,</span>&nbsp;<span class="ident" id="4412096">u</span>&nbsp;<span class="op" id="4412098">:=</span>&nbsp;<span class="keyword" id="4412101">range</span>&nbsp;<span class="ident" id="4412107">keyUsage</span>&nbsp;<span class="op" id="4412116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412123">if</span>&nbsp;<span class="ident" id="4412126">extKeyUsage</span><span class="op" id="4412137">,</span>&nbsp;<span class="ident" id="4412139">ok</span>&nbsp;<span class="op" id="4412142">:=</span>&nbsp;<span class="ident" id="4412145">extKeyUsageFromOID</span><span class="op" id="4412163">(</span><span class="ident" id="4412164">u</span><span class="op" id="4412165">)</span><span class="op" id="4412166">;</span>&nbsp;<span class="ident" id="4412168">ok</span>&nbsp;<span class="op" id="4412171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412179">out</span><span class="op" id="4412182">.</span><span class="ident" id="4412183">ExtKeyUsage</span>&nbsp;<span class="op" id="4412195">=</span>&nbsp;<span class="builtinfunc" id="4412197">append</span><span class="op" id="4412203">(</span><span class="ident" id="4412204">out</span><span class="op" id="4412207">.</span><span class="ident" id="4412208">ExtKeyUsage</span><span class="op" id="4412219">,</span>&nbsp;<span class="ident" id="4412221">extKeyUsage</span><span class="op" id="4412232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4412239">}</span>&nbsp;<span class="keyword" id="4412241">else</span>&nbsp;<span class="op" id="4412246">{</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412254">out</span><span class="op" id="4412257">.</span><span class="ident" id="4412258">UnknownExtKeyUsage</span>&nbsp;<span class="op" id="4412277">=</span>&nbsp;<span class="builtinfunc" id="4412279">append</span><span class="op" id="4412285">(</span><span class="ident" id="4412286">out</span><span class="op" id="4412289">.</span><span class="ident" id="4412290">UnknownExtKeyUsage</span><span class="op" id="4412308">,</span>&nbsp;<span class="ident" id="4412310">u</span><span class="op" id="4412311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4412318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4412324">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412331">continue</span><br>
<span class="lineno">1040</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412344">case</span>&nbsp;<span class="num" id="4412349">14</span><span class="op" id="4412351">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4412357">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412382">var</span>&nbsp;<span class="ident" id="4412386">keyid</span>&nbsp;<span class="op" id="4412392">[</span><span class="op" id="4412393">]</span><span class="builtintype" id="4412394">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412403">_</span><span class="op" id="4412404">,</span>&nbsp;<span class="ident" id="4412406">err</span>&nbsp;<span class="op" id="4412410">=</span>&nbsp;<span class="ident" id="4412412">asn1</span><span class="op" id="4412416">.</span><span class="ident" id="4412417">Unmarshal</span><span class="op" id="4412426">(</span><span class="ident" id="4412427">e</span><span class="op" id="4412428">.</span><span class="ident" id="4412429">Value</span><span class="op" id="4412434">,</span>&nbsp;<span class="op" id="4412436">&amp;</span><span class="ident" id="4412437">keyid</span><span class="op" id="4412442">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412448">if</span>&nbsp;<span class="ident" id="4412451">err</span>&nbsp;<span class="op" id="4412455">!=</span>&nbsp;<span class="builtintype" id="4412458">nil</span>&nbsp;<span class="op" id="4412462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412469">return</span>&nbsp;<span class="builtintype" id="4412476">nil</span><span class="op" id="4412479">,</span>&nbsp;<span class="ident" id="4412481">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4412489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412495">out</span><span class="op" id="4412498">.</span><span class="ident" id="4412499">SubjectKeyId</span>&nbsp;<span class="op" id="4412512">=</span>&nbsp;<span class="ident" id="4412514">keyid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412524">continue</span><br>
<span class="lineno">1050</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412537">case</span>&nbsp;<span class="num" id="4412542">32</span><span class="op" id="4412544">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4412550">//&nbsp;RFC&nbsp;5280&nbsp;4.2.1.4:&nbsp;Certificate&nbsp;Policies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412596">var</span>&nbsp;<span class="ident" id="4412600">policies</span>&nbsp;<span class="op" id="4412609">[</span><span class="op" id="4412610">]</span><span class="ident" id="4412611">policyInformation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412633">if</span>&nbsp;<span class="ident" id="4412636">_</span><span class="op" id="4412637">,</span>&nbsp;<span class="ident" id="4412639">err</span>&nbsp;<span class="op" id="4412643">=</span>&nbsp;<span class="ident" id="4412645">asn1</span><span class="op" id="4412649">.</span><span class="ident" id="4412650">Unmarshal</span><span class="op" id="4412659">(</span><span class="ident" id="4412660">e</span><span class="op" id="4412661">.</span><span class="ident" id="4412662">Value</span><span class="op" id="4412667">,</span>&nbsp;<span class="op" id="4412669">&amp;</span><span class="ident" id="4412670">policies</span><span class="op" id="4412678">)</span><span class="op" id="4412679">;</span>&nbsp;<span class="ident" id="4412681">err</span>&nbsp;<span class="op" id="4412685">!=</span>&nbsp;<span class="builtintype" id="4412688">nil</span>&nbsp;<span class="op" id="4412692">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412699">return</span>&nbsp;<span class="builtintype" id="4412706">nil</span><span class="op" id="4412709">,</span>&nbsp;<span class="ident" id="4412711">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4412719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412725">out</span><span class="op" id="4412728">.</span><span class="ident" id="4412729">PolicyIdentifiers</span>&nbsp;<span class="op" id="4412747">=</span>&nbsp;<span class="builtinfunc" id="4412749">make</span><span class="op" id="4412753">(</span><span class="op" id="4412754">[</span><span class="op" id="4412755">]</span><span class="ident" id="4412756">asn1</span><span class="op" id="4412760">.</span><span class="ident" id="4412761">ObjectIdentifier</span><span class="op" id="4412777">,</span>&nbsp;<span class="builtinfunc" id="4412779">len</span><span class="op" id="4412782">(</span><span class="ident" id="4412783">policies</span><span class="op" id="4412791">)</span><span class="op" id="4412792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412798">for</span>&nbsp;<span class="ident" id="4412802">i</span><span class="op" id="4412803">,</span>&nbsp;<span class="ident" id="4412805">policy</span>&nbsp;<span class="op" id="4412812">:=</span>&nbsp;<span class="keyword" id="4412815">range</span>&nbsp;<span class="ident" id="4412821">policies</span>&nbsp;<span class="op" id="4412830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412837">out</span><span class="op" id="4412840">.</span><span class="ident" id="4412841">PolicyIdentifiers</span><span class="op" id="4412858">[</span><span class="ident" id="4412859">i</span><span class="op" id="4412860">]</span>&nbsp;<span class="op" id="4412862">=</span>&nbsp;<span class="ident" id="4412864">policy</span><span class="op" id="4412870">.</span><span class="ident" id="4412871">Policy</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4412882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4412887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4412891">}</span>&nbsp;<span class="keyword" id="4412893">else</span>&nbsp;<span class="keyword" id="4412898">if</span>&nbsp;<span class="ident" id="4412901">e</span><span class="op" id="4412902">.</span><span class="ident" id="4412903">Id</span><span class="op" id="4412905">.</span><span class="ident" id="4412906">Equal</span><span class="op" id="4412911">(</span><span class="ident" id="4412912">oidExtensionAuthorityInfoAccess</span><span class="op" id="4412943">)</span>&nbsp;<span class="op" id="4412945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4412950">//&nbsp;RFC&nbsp;5280&nbsp;4.2.2.1:&nbsp;Authority&nbsp;Information&nbsp;Access</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413003">var</span>&nbsp;<span class="ident" id="4413007">aia</span>&nbsp;<span class="op" id="4413011">[</span><span class="op" id="4413012">]</span><span class="ident" id="4413013">authorityInfoAccess</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413036">if</span>&nbsp;<span class="ident" id="4413039">_</span><span class="op" id="4413040">,</span>&nbsp;<span class="ident" id="4413042">err</span>&nbsp;<span class="op" id="4413046">=</span>&nbsp;<span class="ident" id="4413048">asn1</span><span class="op" id="4413052">.</span><span class="ident" id="4413053">Unmarshal</span><span class="op" id="4413062">(</span><span class="ident" id="4413063">e</span><span class="op" id="4413064">.</span><span class="ident" id="4413065">Value</span><span class="op" id="4413070">,</span>&nbsp;<span class="op" id="4413072">&amp;</span><span class="ident" id="4413073">aia</span><span class="op" id="4413076">)</span><span class="op" id="4413077">;</span>&nbsp;<span class="ident" id="4413079">err</span>&nbsp;<span class="op" id="4413083">!=</span>&nbsp;<span class="builtintype" id="4413086">nil</span>&nbsp;<span class="op" id="4413090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413096">return</span>&nbsp;<span class="builtintype" id="4413103">nil</span><span class="op" id="4413106">,</span>&nbsp;<span class="ident" id="4413108">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4413115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413121">for</span>&nbsp;<span class="ident" id="4413125">_</span><span class="op" id="4413126">,</span>&nbsp;<span class="ident" id="4413128">v</span>&nbsp;<span class="op" id="4413130">:=</span>&nbsp;<span class="keyword" id="4413133">range</span>&nbsp;<span class="ident" id="4413139">aia</span>&nbsp;<span class="op" id="4413143">{</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4413149">//&nbsp;GeneralName:&nbsp;uniformResourceIdentifier&nbsp;[6]&nbsp;IA5String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413209">if</span>&nbsp;<span class="ident" id="4413212">v</span><span class="op" id="4413213">.</span><span class="ident" id="4413214">Location</span><span class="op" id="4413222">.</span><span class="ident" id="4413223">Tag</span>&nbsp;<span class="op" id="4413227">!=</span>&nbsp;<span class="num" id="4413230">6</span>&nbsp;<span class="op" id="4413232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413239">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4413252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413258">if</span>&nbsp;<span class="ident" id="4413261">v</span><span class="op" id="4413262">.</span><span class="ident" id="4413263">Method</span><span class="op" id="4413269">.</span><span class="ident" id="4413270">Equal</span><span class="op" id="4413275">(</span><span class="ident" id="4413276">oidAuthorityInfoAccessOcsp</span><span class="op" id="4413302">)</span>&nbsp;<span class="op" id="4413304">{</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413311">out</span><span class="op" id="4413314">.</span><span class="ident" id="4413315">OCSPServer</span>&nbsp;<span class="op" id="4413326">=</span>&nbsp;<span class="builtinfunc" id="4413328">append</span><span class="op" id="4413334">(</span><span class="ident" id="4413335">out</span><span class="op" id="4413338">.</span><span class="ident" id="4413339">OCSPServer</span><span class="op" id="4413349">,</span>&nbsp;<span class="builtintype" id="4413351">string</span><span class="op" id="4413357">(</span><span class="ident" id="4413358">v</span><span class="op" id="4413359">.</span><span class="ident" id="4413360">Location</span><span class="op" id="4413368">.</span><span class="ident" id="4413369">Bytes</span><span class="op" id="4413374">)</span><span class="op" id="4413375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4413381">}</span>&nbsp;<span class="keyword" id="4413383">else</span>&nbsp;<span class="keyword" id="4413388">if</span>&nbsp;<span class="ident" id="4413391">v</span><span class="op" id="4413392">.</span><span class="ident" id="4413393">Method</span><span class="op" id="4413399">.</span><span class="ident" id="4413400">Equal</span><span class="op" id="4413405">(</span><span class="ident" id="4413406">oidAuthorityInfoAccessIssuers</span><span class="op" id="4413435">)</span>&nbsp;<span class="op" id="4413437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413444">out</span><span class="op" id="4413447">.</span><span class="ident" id="4413448">IssuingCertificateURL</span>&nbsp;<span class="op" id="4413470">=</span>&nbsp;<span class="builtinfunc" id="4413472">append</span><span class="op" id="4413478">(</span><span class="ident" id="4413479">out</span><span class="op" id="4413482">.</span><span class="ident" id="4413483">IssuingCertificateURL</span><span class="op" id="4413504">,</span>&nbsp;<span class="builtintype" id="4413506">string</span><span class="op" id="4413512">(</span><span class="ident" id="4413513">v</span><span class="op" id="4413514">.</span><span class="ident" id="4413515">Location</span><span class="op" id="4413523">.</span><span class="ident" id="4413524">Bytes</span><span class="op" id="4413529">)</span><span class="op" id="4413530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4413536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4413541">}</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4413545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413550">if</span>&nbsp;<span class="ident" id="4413553">e</span><span class="op" id="4413554">.</span><span class="ident" id="4413555">Critical</span>&nbsp;<span class="op" id="4413564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413569">return</span>&nbsp;<span class="ident" id="4413576">out</span><span class="op" id="4413579">,</span>&nbsp;<span class="ident" id="4413581">UnhandledCriticalExtension</span><span class="op" id="4413607">{</span><span class="op" id="4413608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4413612">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4413615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413619">return</span>&nbsp;<span class="ident" id="4413626">out</span><span class="op" id="4413629">,</span>&nbsp;<span class="builtintype" id="4413631">nil</span><br>
<span class="lineno"></span><span class="op" id="4413635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1090</span><span class="comment" id="4413638">//&nbsp;ParseCertificate&nbsp;parses&nbsp;a&nbsp;single&nbsp;certificate&nbsp;from&nbsp;the&nbsp;given&nbsp;ASN.1&nbsp;DER&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4413717">func</span>&nbsp;<span class="ident" id="4413722">ParseCertificate</span><span class="op" id="4413738">(</span><span class="ident" id="4413739">asn1Data</span>&nbsp;<span class="op" id="4413748">[</span><span class="op" id="4413749">]</span><span class="builtintype" id="4413750">byte</span><span class="op" id="4413754">)</span>&nbsp;<span class="op" id="4413756">(</span><span class="op" id="4413757">*</span><span class="ident" id="4413758">Certificate</span><span class="op" id="4413769">,</span>&nbsp;<span class="builtintype" id="4413771">error</span><span class="op" id="4413776">)</span>&nbsp;<span class="op" id="4413778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413781">var</span>&nbsp;<span class="ident" id="4413785">cert</span>&nbsp;<span class="ident" id="4413790">certificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413803">rest</span><span class="op" id="4413807">,</span>&nbsp;<span class="ident" id="4413809">err</span>&nbsp;<span class="op" id="4413813">:=</span>&nbsp;<span class="ident" id="4413816">asn1</span><span class="op" id="4413820">.</span><span class="ident" id="4413821">Unmarshal</span><span class="op" id="4413830">(</span><span class="ident" id="4413831">asn1Data</span><span class="op" id="4413839">,</span>&nbsp;<span class="op" id="4413841">&amp;</span><span class="ident" id="4413842">cert</span><span class="op" id="4413846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413849">if</span>&nbsp;<span class="ident" id="4413852">err</span>&nbsp;<span class="op" id="4413856">!=</span>&nbsp;<span class="builtintype" id="4413859">nil</span>&nbsp;<span class="op" id="4413863">{</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413867">return</span>&nbsp;<span class="builtintype" id="4413874">nil</span><span class="op" id="4413877">,</span>&nbsp;<span class="ident" id="4413879">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4413884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413887">if</span>&nbsp;<span class="builtinfunc" id="4413890">len</span><span class="op" id="4413893">(</span><span class="ident" id="4413894">rest</span><span class="op" id="4413898">)</span>&nbsp;<span class="op" id="4413900">&gt;</span>&nbsp;<span class="num" id="4413902">0</span>&nbsp;<span class="op" id="4413904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413908">return</span>&nbsp;<span class="builtintype" id="4413915">nil</span><span class="op" id="4413918">,</span>&nbsp;<span class="ident" id="4413920">asn1</span><span class="op" id="4413924">.</span><span class="ident" id="4413925">SyntaxError</span><span class="op" id="4413936">{</span><span class="ident" id="4413937">Msg</span><span class="op" id="4413940">:</span>&nbsp;<span class="string" id="4413942">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4413957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4413960">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413964">return</span>&nbsp;<span class="ident" id="4413971">parseCertificate</span><span class="op" id="4413987">(</span><span class="op" id="4413988">&amp;</span><span class="ident" id="4413989">cert</span><span class="op" id="4413993">)</span><br>
<span class="lineno"></span><span class="op" id="4413995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4413998">//&nbsp;ParseCertificates&nbsp;parses&nbsp;one&nbsp;or&nbsp;more&nbsp;certificates&nbsp;from&nbsp;the&nbsp;given&nbsp;ASN.1&nbsp;DER</span><br>
<span class="lineno">1105</span><span class="comment" id="4414076">//&nbsp;data.&nbsp;The&nbsp;certificates&nbsp;must&nbsp;be&nbsp;concatenated&nbsp;with&nbsp;no&nbsp;intermediate&nbsp;padding.</span><br>
<span class="lineno"></span><span class="keyword" id="4414153">func</span>&nbsp;<span class="ident" id="4414158">ParseCertificates</span><span class="op" id="4414175">(</span><span class="ident" id="4414176">asn1Data</span>&nbsp;<span class="op" id="4414185">[</span><span class="op" id="4414186">]</span><span class="builtintype" id="4414187">byte</span><span class="op" id="4414191">)</span>&nbsp;<span class="op" id="4414193">(</span><span class="op" id="4414194">[</span><span class="op" id="4414195">]</span><span class="op" id="4414196">*</span><span class="ident" id="4414197">Certificate</span><span class="op" id="4414208">,</span>&nbsp;<span class="builtintype" id="4414210">error</span><span class="op" id="4414215">)</span>&nbsp;<span class="op" id="4414217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4414220">var</span>&nbsp;<span class="ident" id="4414224">v</span>&nbsp;<span class="op" id="4414226">[</span><span class="op" id="4414227">]</span><span class="op" id="4414228">*</span><span class="ident" id="4414229">certificate</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4414243">for</span>&nbsp;<span class="builtinfunc" id="4414247">len</span><span class="op" id="4414250">(</span><span class="ident" id="4414251">asn1Data</span><span class="op" id="4414259">)</span>&nbsp;<span class="op" id="4414261">&gt;</span>&nbsp;<span class="num" id="4414263">0</span>&nbsp;<span class="op" id="4414265">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414269">cert</span>&nbsp;<span class="op" id="4414274">:=</span>&nbsp;<span class="builtinfunc" id="4414277">new</span><span class="op" id="4414280">(</span><span class="ident" id="4414281">certificate</span><span class="op" id="4414292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4414296">var</span>&nbsp;<span class="ident" id="4414300">err</span>&nbsp;<span class="builtintype" id="4414304">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414312">asn1Data</span><span class="op" id="4414320">,</span>&nbsp;<span class="ident" id="4414322">err</span>&nbsp;<span class="op" id="4414326">=</span>&nbsp;<span class="ident" id="4414328">asn1</span><span class="op" id="4414332">.</span><span class="ident" id="4414333">Unmarshal</span><span class="op" id="4414342">(</span><span class="ident" id="4414343">asn1Data</span><span class="op" id="4414351">,</span>&nbsp;<span class="ident" id="4414353">cert</span><span class="op" id="4414357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4414361">if</span>&nbsp;<span class="ident" id="4414364">err</span>&nbsp;<span class="op" id="4414368">!=</span>&nbsp;<span class="builtintype" id="4414371">nil</span>&nbsp;<span class="op" id="4414375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4414380">return</span>&nbsp;<span class="builtintype" id="4414387">nil</span><span class="op" id="4414390">,</span>&nbsp;<span class="ident" id="4414392">err</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4414398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414402">v</span>&nbsp;<span class="op" id="4414404">=</span>&nbsp;<span class="builtinfunc" id="4414406">append</span><span class="op" id="4414412">(</span><span class="ident" id="4414413">v</span><span class="op" id="4414414">,</span>&nbsp;<span class="ident" id="4414416">cert</span><span class="op" id="4414420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4414423">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414427">ret</span>&nbsp;<span class="op" id="4414431">:=</span>&nbsp;<span class="builtinfunc" id="4414434">make</span><span class="op" id="4414438">(</span><span class="op" id="4414439">[</span><span class="op" id="4414440">]</span><span class="op" id="4414441">*</span><span class="ident" id="4414442">Certificate</span><span class="op" id="4414453">,</span>&nbsp;<span class="builtinfunc" id="4414455">len</span><span class="op" id="4414458">(</span><span class="ident" id="4414459">v</span><span class="op" id="4414460">)</span><span class="op" id="4414461">)</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4414464">for</span>&nbsp;<span class="ident" id="4414468">i</span><span class="op" id="4414469">,</span>&nbsp;<span class="ident" id="4414471">ci</span>&nbsp;<span class="op" id="4414474">:=</span>&nbsp;<span class="keyword" id="4414477">range</span>&nbsp;<span class="ident" id="4414483">v</span>&nbsp;<span class="op" id="4414485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414489">cert</span><span class="op" id="4414493">,</span>&nbsp;<span class="ident" id="4414495">err</span>&nbsp;<span class="op" id="4414499">:=</span>&nbsp;<span class="ident" id="4414502">parseCertificate</span><span class="op" id="4414518">(</span><span class="ident" id="4414519">ci</span><span class="op" id="4414521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4414525">if</span>&nbsp;<span class="ident" id="4414528">err</span>&nbsp;<span class="op" id="4414532">!=</span>&nbsp;<span class="builtintype" id="4414535">nil</span>&nbsp;<span class="op" id="4414539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4414544">return</span>&nbsp;<span class="builtintype" id="4414551">nil</span><span class="op" id="4414554">,</span>&nbsp;<span class="ident" id="4414556">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4414562">}</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414566">ret</span><span class="op" id="4414569">[</span><span class="ident" id="4414570">i</span><span class="op" id="4414571">]</span>&nbsp;<span class="op" id="4414573">=</span>&nbsp;<span class="ident" id="4414575">cert</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4414581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4414585">return</span>&nbsp;<span class="ident" id="4414592">ret</span><span class="op" id="4414595">,</span>&nbsp;<span class="builtintype" id="4414597">nil</span><br>
<span class="lineno"></span><span class="op" id="4414601">}</span><br>
<span class="lineno">1130</span><br>
<span class="lineno"></span><span class="keyword" id="4414604">func</span>&nbsp;<span class="ident" id="4414609">reverseBitsInAByte</span><span class="op" id="4414627">(</span><span class="ident" id="4414628">in</span>&nbsp;<span class="builtintype" id="4414631">byte</span><span class="op" id="4414635">)</span>&nbsp;<span class="builtintype" id="4414637">byte</span>&nbsp;<span class="op" id="4414642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414645">b1</span>&nbsp;<span class="op" id="4414648">:=</span>&nbsp;<span class="ident" id="4414651">in</span><span class="op" id="4414653">&gt;&gt;</span><span class="num" id="4414655">4</span>&nbsp;<span class="op" id="4414657">|</span>&nbsp;<span class="ident" id="4414659">in</span><span class="op" id="4414661">&lt;&lt;</span><span class="num" id="4414663">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414666">b2</span>&nbsp;<span class="op" id="4414669">:=</span>&nbsp;<span class="ident" id="4414672">b1</span><span class="op" id="4414674">&gt;&gt;</span><span class="num" id="4414676">2</span><span class="op" id="4414677">&amp;</span><span class="num" id="4414678">0x33</span>&nbsp;<span class="op" id="4414683">|</span>&nbsp;<span class="ident" id="4414685">b1</span><span class="op" id="4414687">&lt;&lt;</span><span class="num" id="4414689">2</span><span class="op" id="4414690">&amp;</span><span class="num" id="4414691">0xcc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414697">b3</span>&nbsp;<span class="op" id="4414700">:=</span>&nbsp;<span class="ident" id="4414703">b2</span><span class="op" id="4414705">&gt;&gt;</span><span class="num" id="4414707">1</span><span class="op" id="4414708">&amp;</span><span class="num" id="4414709">0x55</span>&nbsp;<span class="op" id="4414714">|</span>&nbsp;<span class="ident" id="4414716">b2</span><span class="op" id="4414718">&lt;&lt;</span><span class="num" id="4414720">1</span><span class="op" id="4414721">&amp;</span><span class="num" id="4414722">0xaa</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4414728">return</span>&nbsp;<span class="ident" id="4414735">b3</span><br>
<span class="lineno"></span><span class="op" id="4414738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4414741">var</span>&nbsp;<span class="op" id="4414745">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414748">oidExtensionSubjectKeyId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4414782">=</span>&nbsp;<span class="op" id="4414784">[</span><span class="op" id="4414785">]</span><span class="builtintype" id="4414786">int</span><span class="op" id="4414789">{</span><span class="num" id="4414790">2</span><span class="op" id="4414791">,</span>&nbsp;<span class="num" id="4414793">5</span><span class="op" id="4414794">,</span>&nbsp;<span class="num" id="4414796">29</span><span class="op" id="4414798">,</span>&nbsp;<span class="num" id="4414800">14</span><span class="op" id="4414802">}</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414805">oidExtensionKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4414839">=</span>&nbsp;<span class="op" id="4414841">[</span><span class="op" id="4414842">]</span><span class="builtintype" id="4414843">int</span><span class="op" id="4414846">{</span><span class="num" id="4414847">2</span><span class="op" id="4414848">,</span>&nbsp;<span class="num" id="4414850">5</span><span class="op" id="4414851">,</span>&nbsp;<span class="num" id="4414853">29</span><span class="op" id="4414855">,</span>&nbsp;<span class="num" id="4414857">15</span><span class="op" id="4414859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414862">oidExtensionExtendedKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4414896">=</span>&nbsp;<span class="op" id="4414898">[</span><span class="op" id="4414899">]</span><span class="builtintype" id="4414900">int</span><span class="op" id="4414903">{</span><span class="num" id="4414904">2</span><span class="op" id="4414905">,</span>&nbsp;<span class="num" id="4414907">5</span><span class="op" id="4414908">,</span>&nbsp;<span class="num" id="4414910">29</span><span class="op" id="4414912">,</span>&nbsp;<span class="num" id="4414914">37</span><span class="op" id="4414916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414919">oidExtensionAuthorityKeyId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4414953">=</span>&nbsp;<span class="op" id="4414955">[</span><span class="op" id="4414956">]</span><span class="builtintype" id="4414957">int</span><span class="op" id="4414960">{</span><span class="num" id="4414961">2</span><span class="op" id="4414962">,</span>&nbsp;<span class="num" id="4414964">5</span><span class="op" id="4414965">,</span>&nbsp;<span class="num" id="4414967">29</span><span class="op" id="4414969">,</span>&nbsp;<span class="num" id="4414971">35</span><span class="op" id="4414973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414976">oidExtensionBasicConstraints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4415010">=</span>&nbsp;<span class="op" id="4415012">[</span><span class="op" id="4415013">]</span><span class="builtintype" id="4415014">int</span><span class="op" id="4415017">{</span><span class="num" id="4415018">2</span><span class="op" id="4415019">,</span>&nbsp;<span class="num" id="4415021">5</span><span class="op" id="4415022">,</span>&nbsp;<span class="num" id="4415024">29</span><span class="op" id="4415026">,</span>&nbsp;<span class="num" id="4415028">19</span><span class="op" id="4415030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415033">oidExtensionSubjectAltName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4415067">=</span>&nbsp;<span class="op" id="4415069">[</span><span class="op" id="4415070">]</span><span class="builtintype" id="4415071">int</span><span class="op" id="4415074">{</span><span class="num" id="4415075">2</span><span class="op" id="4415076">,</span>&nbsp;<span class="num" id="4415078">5</span><span class="op" id="4415079">,</span>&nbsp;<span class="num" id="4415081">29</span><span class="op" id="4415083">,</span>&nbsp;<span class="num" id="4415085">17</span><span class="op" id="4415087">}</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415090">oidExtensionCertificatePolicies</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4415124">=</span>&nbsp;<span class="op" id="4415126">[</span><span class="op" id="4415127">]</span><span class="builtintype" id="4415128">int</span><span class="op" id="4415131">{</span><span class="num" id="4415132">2</span><span class="op" id="4415133">,</span>&nbsp;<span class="num" id="4415135">5</span><span class="op" id="4415136">,</span>&nbsp;<span class="num" id="4415138">29</span><span class="op" id="4415140">,</span>&nbsp;<span class="num" id="4415142">32</span><span class="op" id="4415144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415147">oidExtensionNameConstraints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4415181">=</span>&nbsp;<span class="op" id="4415183">[</span><span class="op" id="4415184">]</span><span class="builtintype" id="4415185">int</span><span class="op" id="4415188">{</span><span class="num" id="4415189">2</span><span class="op" id="4415190">,</span>&nbsp;<span class="num" id="4415192">5</span><span class="op" id="4415193">,</span>&nbsp;<span class="num" id="4415195">29</span><span class="op" id="4415197">,</span>&nbsp;<span class="num" id="4415199">30</span><span class="op" id="4415201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415204">oidExtensionCRLDistributionPoints</span>&nbsp;<span class="op" id="4415238">=</span>&nbsp;<span class="op" id="4415240">[</span><span class="op" id="4415241">]</span><span class="builtintype" id="4415242">int</span><span class="op" id="4415245">{</span><span class="num" id="4415246">2</span><span class="op" id="4415247">,</span>&nbsp;<span class="num" id="4415249">5</span><span class="op" id="4415250">,</span>&nbsp;<span class="num" id="4415252">29</span><span class="op" id="4415254">,</span>&nbsp;<span class="num" id="4415256">31</span><span class="op" id="4415258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415261">oidExtensionAuthorityInfoAccess</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4415295">=</span>&nbsp;<span class="op" id="4415297">[</span><span class="op" id="4415298">]</span><span class="builtintype" id="4415299">int</span><span class="op" id="4415302">{</span><span class="num" id="4415303">1</span><span class="op" id="4415304">,</span>&nbsp;<span class="num" id="4415306">3</span><span class="op" id="4415307">,</span>&nbsp;<span class="num" id="4415309">6</span><span class="op" id="4415310">,</span>&nbsp;<span class="num" id="4415312">1</span><span class="op" id="4415313">,</span>&nbsp;<span class="num" id="4415315">5</span><span class="op" id="4415316">,</span>&nbsp;<span class="num" id="4415318">5</span><span class="op" id="4415319">,</span>&nbsp;<span class="num" id="4415321">7</span><span class="op" id="4415322">,</span>&nbsp;<span class="num" id="4415324">1</span><span class="op" id="4415325">,</span>&nbsp;<span class="num" id="4415327">1</span><span class="op" id="4415328">}</span><br>
<span class="lineno"></span><span class="op" id="4415330">)</span><br>
<span class="lineno">1150</span><br>
<span class="lineno"></span><span class="keyword" id="4415333">var</span>&nbsp;<span class="op" id="4415337">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415340">oidAuthorityInfoAccessOcsp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4415370">=</span>&nbsp;<span class="ident" id="4415372">asn1</span><span class="op" id="4415376">.</span><span class="ident" id="4415377">ObjectIdentifier</span><span class="op" id="4415393">{</span><span class="num" id="4415394">1</span><span class="op" id="4415395">,</span>&nbsp;<span class="num" id="4415397">3</span><span class="op" id="4415398">,</span>&nbsp;<span class="num" id="4415400">6</span><span class="op" id="4415401">,</span>&nbsp;<span class="num" id="4415403">1</span><span class="op" id="4415404">,</span>&nbsp;<span class="num" id="4415406">5</span><span class="op" id="4415407">,</span>&nbsp;<span class="num" id="4415409">5</span><span class="op" id="4415410">,</span>&nbsp;<span class="num" id="4415412">7</span><span class="op" id="4415413">,</span>&nbsp;<span class="num" id="4415415">48</span><span class="op" id="4415417">,</span>&nbsp;<span class="num" id="4415419">1</span><span class="op" id="4415420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415423">oidAuthorityInfoAccessIssuers</span>&nbsp;<span class="op" id="4415453">=</span>&nbsp;<span class="ident" id="4415455">asn1</span><span class="op" id="4415459">.</span><span class="ident" id="4415460">ObjectIdentifier</span><span class="op" id="4415476">{</span><span class="num" id="4415477">1</span><span class="op" id="4415478">,</span>&nbsp;<span class="num" id="4415480">3</span><span class="op" id="4415481">,</span>&nbsp;<span class="num" id="4415483">6</span><span class="op" id="4415484">,</span>&nbsp;<span class="num" id="4415486">1</span><span class="op" id="4415487">,</span>&nbsp;<span class="num" id="4415489">5</span><span class="op" id="4415490">,</span>&nbsp;<span class="num" id="4415492">5</span><span class="op" id="4415493">,</span>&nbsp;<span class="num" id="4415495">7</span><span class="op" id="4415496">,</span>&nbsp;<span class="num" id="4415498">48</span><span class="op" id="4415500">,</span>&nbsp;<span class="num" id="4415502">2</span><span class="op" id="4415503">}</span><br>
<span class="lineno"></span><span class="op" id="4415505">)</span><br>
<span class="lineno">1155</span><br>
<span class="lineno"></span><span class="comment" id="4415508">//&nbsp;oidNotInExtensions&nbsp;returns&nbsp;whether&nbsp;an&nbsp;extension&nbsp;with&nbsp;the&nbsp;given&nbsp;oid&nbsp;exists&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4415588">//&nbsp;extensions.</span><br>
<span class="lineno"></span><span class="keyword" id="4415603">func</span>&nbsp;<span class="ident" id="4415608">oidInExtensions</span><span class="op" id="4415623">(</span><span class="ident" id="4415624">oid</span>&nbsp;<span class="ident" id="4415628">asn1</span><span class="op" id="4415632">.</span><span class="ident" id="4415633">ObjectIdentifier</span><span class="op" id="4415649">,</span>&nbsp;<span class="ident" id="4415651">extensions</span>&nbsp;<span class="op" id="4415662">[</span><span class="op" id="4415663">]</span><span class="ident" id="4415664">pkix</span><span class="op" id="4415668">.</span><span class="ident" id="4415669">Extension</span><span class="op" id="4415678">)</span>&nbsp;<span class="builtintype" id="4415680">bool</span>&nbsp;<span class="op" id="4415685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4415688">for</span>&nbsp;<span class="ident" id="4415692">_</span><span class="op" id="4415693">,</span>&nbsp;<span class="ident" id="4415695">e</span>&nbsp;<span class="op" id="4415697">:=</span>&nbsp;<span class="keyword" id="4415700">range</span>&nbsp;<span class="ident" id="4415706">extensions</span>&nbsp;<span class="op" id="4415717">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4415721">if</span>&nbsp;<span class="ident" id="4415724">e</span><span class="op" id="4415725">.</span><span class="ident" id="4415726">Id</span><span class="op" id="4415728">.</span><span class="ident" id="4415729">Equal</span><span class="op" id="4415734">(</span><span class="ident" id="4415735">oid</span><span class="op" id="4415738">)</span>&nbsp;<span class="op" id="4415740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4415745">return</span>&nbsp;<span class="builtintype" id="4415752">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4415759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4415762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4415765">return</span>&nbsp;<span class="builtintype" id="4415772">false</span><br>
<span class="lineno">1165</span><span class="op" id="4415778">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4415781">//&nbsp;marshalSANs&nbsp;marshals&nbsp;a&nbsp;list&nbsp;of&nbsp;addresses&nbsp;into&nbsp;a&nbsp;the&nbsp;contents&nbsp;of&nbsp;an&nbsp;X.509</span><br>
<span class="lineno"></span><span class="comment" id="4415857">//&nbsp;SubjectAlternativeName&nbsp;extension.</span><br>
<span class="lineno"></span><span class="keyword" id="4415894">func</span>&nbsp;<span class="ident" id="4415899">marshalSANs</span><span class="op" id="4415910">(</span><span class="ident" id="4415911">dnsNames</span><span class="op" id="4415919">,</span>&nbsp;<span class="ident" id="4415921">emailAddresses</span>&nbsp;<span class="op" id="4415936">[</span><span class="op" id="4415937">]</span><span class="builtintype" id="4415938">string</span><span class="op" id="4415944">,</span>&nbsp;<span class="ident" id="4415946">ipAddresses</span>&nbsp;<span class="op" id="4415958">[</span><span class="op" id="4415959">]</span><span class="ident" id="4415960">net</span><span class="op" id="4415963">.</span><span class="ident" id="4415964">IP</span><span class="op" id="4415966">)</span>&nbsp;<span class="op" id="4415968">(</span><span class="ident" id="4415969">derBytes</span>&nbsp;<span class="op" id="4415978">[</span><span class="op" id="4415979">]</span><span class="builtintype" id="4415980">byte</span><span class="op" id="4415984">,</span>&nbsp;<span class="ident" id="4415986">err</span>&nbsp;<span class="builtintype" id="4415990">error</span><span class="op" id="4415995">)</span>&nbsp;<span class="op" id="4415997">{</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416000">var</span>&nbsp;<span class="ident" id="4416004">rawValues</span>&nbsp;<span class="op" id="4416014">[</span><span class="op" id="4416015">]</span><span class="ident" id="4416016">asn1</span><span class="op" id="4416020">.</span><span class="ident" id="4416021">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416031">for</span>&nbsp;<span class="ident" id="4416035">_</span><span class="op" id="4416036">,</span>&nbsp;<span class="ident" id="4416038">name</span>&nbsp;<span class="op" id="4416043">:=</span>&nbsp;<span class="keyword" id="4416046">range</span>&nbsp;<span class="ident" id="4416052">dnsNames</span>&nbsp;<span class="op" id="4416061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416065">rawValues</span>&nbsp;<span class="op" id="4416075">=</span>&nbsp;<span class="builtinfunc" id="4416077">append</span><span class="op" id="4416083">(</span><span class="ident" id="4416084">rawValues</span><span class="op" id="4416093">,</span>&nbsp;<span class="ident" id="4416095">asn1</span><span class="op" id="4416099">.</span><span class="ident" id="4416100">RawValue</span><span class="op" id="4416108">{</span><span class="ident" id="4416109">Tag</span><span class="op" id="4416112">:</span>&nbsp;<span class="num" id="4416114">2</span><span class="op" id="4416115">,</span>&nbsp;<span class="ident" id="4416117">Class</span><span class="op" id="4416122">:</span>&nbsp;<span class="num" id="4416124">2</span><span class="op" id="4416125">,</span>&nbsp;<span class="ident" id="4416127">Bytes</span><span class="op" id="4416132">:</span>&nbsp;<span class="op" id="4416134">[</span><span class="op" id="4416135">]</span><span class="builtintype" id="4416136">byte</span><span class="op" id="4416140">(</span><span class="ident" id="4416141">name</span><span class="op" id="4416145">)</span><span class="op" id="4416146">}</span><span class="op" id="4416147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4416150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416153">for</span>&nbsp;<span class="ident" id="4416157">_</span><span class="op" id="4416158">,</span>&nbsp;<span class="ident" id="4416160">email</span>&nbsp;<span class="op" id="4416166">:=</span>&nbsp;<span class="keyword" id="4416169">range</span>&nbsp;<span class="ident" id="4416175">emailAddresses</span>&nbsp;<span class="op" id="4416190">{</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416194">rawValues</span>&nbsp;<span class="op" id="4416204">=</span>&nbsp;<span class="builtinfunc" id="4416206">append</span><span class="op" id="4416212">(</span><span class="ident" id="4416213">rawValues</span><span class="op" id="4416222">,</span>&nbsp;<span class="ident" id="4416224">asn1</span><span class="op" id="4416228">.</span><span class="ident" id="4416229">RawValue</span><span class="op" id="4416237">{</span><span class="ident" id="4416238">Tag</span><span class="op" id="4416241">:</span>&nbsp;<span class="num" id="4416243">1</span><span class="op" id="4416244">,</span>&nbsp;<span class="ident" id="4416246">Class</span><span class="op" id="4416251">:</span>&nbsp;<span class="num" id="4416253">2</span><span class="op" id="4416254">,</span>&nbsp;<span class="ident" id="4416256">Bytes</span><span class="op" id="4416261">:</span>&nbsp;<span class="op" id="4416263">[</span><span class="op" id="4416264">]</span><span class="builtintype" id="4416265">byte</span><span class="op" id="4416269">(</span><span class="ident" id="4416270">email</span><span class="op" id="4416275">)</span><span class="op" id="4416276">}</span><span class="op" id="4416277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4416280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416283">for</span>&nbsp;<span class="ident" id="4416287">_</span><span class="op" id="4416288">,</span>&nbsp;<span class="ident" id="4416290">rawIP</span>&nbsp;<span class="op" id="4416296">:=</span>&nbsp;<span class="keyword" id="4416299">range</span>&nbsp;<span class="ident" id="4416305">ipAddresses</span>&nbsp;<span class="op" id="4416317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4416321">//&nbsp;If&nbsp;possible,&nbsp;we&nbsp;always&nbsp;want&nbsp;to&nbsp;encode&nbsp;IPv4&nbsp;addresses&nbsp;in&nbsp;4&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416391">ip</span>&nbsp;<span class="op" id="4416394">:=</span>&nbsp;<span class="ident" id="4416397">rawIP</span><span class="op" id="4416402">.</span><span class="ident" id="4416403">To4</span><span class="op" id="4416406">(</span><span class="op" id="4416407">)</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416411">if</span>&nbsp;<span class="ident" id="4416414">ip</span>&nbsp;<span class="op" id="4416417">==</span>&nbsp;<span class="builtintype" id="4416420">nil</span>&nbsp;<span class="op" id="4416424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416429">ip</span>&nbsp;<span class="op" id="4416432">=</span>&nbsp;<span class="ident" id="4416434">rawIP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4416442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416446">rawValues</span>&nbsp;<span class="op" id="4416456">=</span>&nbsp;<span class="builtinfunc" id="4416458">append</span><span class="op" id="4416464">(</span><span class="ident" id="4416465">rawValues</span><span class="op" id="4416474">,</span>&nbsp;<span class="ident" id="4416476">asn1</span><span class="op" id="4416480">.</span><span class="ident" id="4416481">RawValue</span><span class="op" id="4416489">{</span><span class="ident" id="4416490">Tag</span><span class="op" id="4416493">:</span>&nbsp;<span class="num" id="4416495">7</span><span class="op" id="4416496">,</span>&nbsp;<span class="ident" id="4416498">Class</span><span class="op" id="4416503">:</span>&nbsp;<span class="num" id="4416505">2</span><span class="op" id="4416506">,</span>&nbsp;<span class="ident" id="4416508">Bytes</span><span class="op" id="4416513">:</span>&nbsp;<span class="ident" id="4416515">ip</span><span class="op" id="4416517">}</span><span class="op" id="4416518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4416521">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416524">return</span>&nbsp;<span class="ident" id="4416531">asn1</span><span class="op" id="4416535">.</span><span class="ident" id="4416536">Marshal</span><span class="op" id="4416543">(</span><span class="ident" id="4416544">rawValues</span><span class="op" id="4416553">)</span><br>
<span class="lineno"></span><span class="op" id="4416555">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4416558">func</span>&nbsp;<span class="ident" id="4416563">buildExtensions</span><span class="op" id="4416578">(</span><span class="ident" id="4416579">template</span>&nbsp;<span class="op" id="4416588">*</span><span class="ident" id="4416589">Certificate</span><span class="op" id="4416600">)</span>&nbsp;<span class="op" id="4416602">(</span><span class="ident" id="4416603">ret</span>&nbsp;<span class="op" id="4416607">[</span><span class="op" id="4416608">]</span><span class="ident" id="4416609">pkix</span><span class="op" id="4416613">.</span><span class="ident" id="4416614">Extension</span><span class="op" id="4416623">,</span>&nbsp;<span class="ident" id="4416625">err</span>&nbsp;<span class="builtintype" id="4416629">error</span><span class="op" id="4416634">)</span>&nbsp;<span class="op" id="4416636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416639">ret</span>&nbsp;<span class="op" id="4416643">=</span>&nbsp;<span class="builtinfunc" id="4416645">make</span><span class="op" id="4416649">(</span><span class="op" id="4416650">[</span><span class="op" id="4416651">]</span><span class="ident" id="4416652">pkix</span><span class="op" id="4416656">.</span><span class="ident" id="4416657">Extension</span><span class="op" id="4416666">,</span>&nbsp;<span class="num" id="4416668">10</span>&nbsp;<span class="comment" id="4416671">/*&nbsp;maximum&nbsp;number&nbsp;of&nbsp;elements.&nbsp;*/</span><span class="op" id="4416704">)</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416707">n</span>&nbsp;<span class="op" id="4416709">:=</span>&nbsp;<span class="num" id="4416712">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416716">if</span>&nbsp;<span class="ident" id="4416719">template</span><span class="op" id="4416727">.</span><span class="ident" id="4416728">KeyUsage</span>&nbsp;<span class="op" id="4416737">!=</span>&nbsp;<span class="num" id="4416740">0</span>&nbsp;<span class="op" id="4416742">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4416747">!</span><span class="ident" id="4416748">oidInExtensions</span><span class="op" id="4416763">(</span><span class="ident" id="4416764">oidExtensionKeyUsage</span><span class="op" id="4416784">,</span>&nbsp;<span class="ident" id="4416786">template</span><span class="op" id="4416794">.</span><span class="ident" id="4416795">ExtraExtensions</span><span class="op" id="4416810">)</span>&nbsp;<span class="op" id="4416812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416816">ret</span><span class="op" id="4416819">[</span><span class="ident" id="4416820">n</span><span class="op" id="4416821">]</span><span class="op" id="4416822">.</span><span class="ident" id="4416823">Id</span>&nbsp;<span class="op" id="4416826">=</span>&nbsp;<span class="ident" id="4416828">oidExtensionKeyUsage</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416851">ret</span><span class="op" id="4416854">[</span><span class="ident" id="4416855">n</span><span class="op" id="4416856">]</span><span class="op" id="4416857">.</span><span class="ident" id="4416858">Critical</span>&nbsp;<span class="op" id="4416867">=</span>&nbsp;<span class="builtintype" id="4416869">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416877">var</span>&nbsp;<span class="ident" id="4416881">a</span>&nbsp;<span class="op" id="4416883">[</span><span class="num" id="4416884">2</span><span class="op" id="4416885">]</span><span class="builtintype" id="4416886">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416893">a</span><span class="op" id="4416894">[</span><span class="num" id="4416895">0</span><span class="op" id="4416896">]</span>&nbsp;<span class="op" id="4416898">=</span>&nbsp;<span class="ident" id="4416900">reverseBitsInAByte</span><span class="op" id="4416918">(</span><span class="builtintype" id="4416919">byte</span><span class="op" id="4416923">(</span><span class="ident" id="4416924">template</span><span class="op" id="4416932">.</span><span class="ident" id="4416933">KeyUsage</span><span class="op" id="4416941">)</span><span class="op" id="4416942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416946">a</span><span class="op" id="4416947">[</span><span class="num" id="4416948">1</span><span class="op" id="4416949">]</span>&nbsp;<span class="op" id="4416951">=</span>&nbsp;<span class="ident" id="4416953">reverseBitsInAByte</span><span class="op" id="4416971">(</span><span class="builtintype" id="4416972">byte</span><span class="op" id="4416976">(</span><span class="ident" id="4416977">template</span><span class="op" id="4416985">.</span><span class="ident" id="4416986">KeyUsage</span>&nbsp;<span class="op" id="4416995">&gt;&gt;</span>&nbsp;<span class="num" id="4416998">8</span><span class="op" id="4416999">)</span><span class="op" id="4417000">)</span><br>
<span class="lineno">1200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417005">l</span>&nbsp;<span class="op" id="4417007">:=</span>&nbsp;<span class="num" id="4417010">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417014">if</span>&nbsp;<span class="ident" id="4417017">a</span><span class="op" id="4417018">[</span><span class="num" id="4417019">1</span><span class="op" id="4417020">]</span>&nbsp;<span class="op" id="4417022">!=</span>&nbsp;<span class="num" id="4417025">0</span>&nbsp;<span class="op" id="4417027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417032">l</span>&nbsp;<span class="op" id="4417034">=</span>&nbsp;<span class="num" id="4417036">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4417040">}</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417045">ret</span><span class="op" id="4417048">[</span><span class="ident" id="4417049">n</span><span class="op" id="4417050">]</span><span class="op" id="4417051">.</span><span class="ident" id="4417052">Value</span><span class="op" id="4417057">,</span>&nbsp;<span class="ident" id="4417059">err</span>&nbsp;<span class="op" id="4417063">=</span>&nbsp;<span class="ident" id="4417065">asn1</span><span class="op" id="4417069">.</span><span class="ident" id="4417070">Marshal</span><span class="op" id="4417077">(</span><span class="ident" id="4417078">asn1</span><span class="op" id="4417082">.</span><span class="ident" id="4417083">BitString</span><span class="op" id="4417092">{</span><span class="ident" id="4417093">Bytes</span><span class="op" id="4417098">:</span>&nbsp;<span class="ident" id="4417100">a</span><span class="op" id="4417101">[</span><span class="num" id="4417102">0</span><span class="op" id="4417103">:</span><span class="ident" id="4417104">l</span><span class="op" id="4417105">]</span><span class="op" id="4417106">,</span>&nbsp;<span class="ident" id="4417108">BitLength</span><span class="op" id="4417117">:</span>&nbsp;<span class="ident" id="4417119">l</span>&nbsp;<span class="op" id="4417121">*</span>&nbsp;<span class="num" id="4417123">8</span><span class="op" id="4417124">}</span><span class="op" id="4417125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417129">if</span>&nbsp;<span class="ident" id="4417132">err</span>&nbsp;<span class="op" id="4417136">!=</span>&nbsp;<span class="builtintype" id="4417139">nil</span>&nbsp;<span class="op" id="4417143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417148">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4417157">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417161">n</span><span class="op" id="4417162">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4417166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417170">if</span>&nbsp;<span class="op" id="4417173">(</span><span class="builtinfunc" id="4417174">len</span><span class="op" id="4417177">(</span><span class="ident" id="4417178">template</span><span class="op" id="4417186">.</span><span class="ident" id="4417187">ExtKeyUsage</span><span class="op" id="4417198">)</span>&nbsp;<span class="op" id="4417200">&gt;</span>&nbsp;<span class="num" id="4417202">0</span>&nbsp;<span class="op" id="4417204">||</span>&nbsp;<span class="builtinfunc" id="4417207">len</span><span class="op" id="4417210">(</span><span class="ident" id="4417211">template</span><span class="op" id="4417219">.</span><span class="ident" id="4417220">UnknownExtKeyUsage</span><span class="op" id="4417238">)</span>&nbsp;<span class="op" id="4417240">&gt;</span>&nbsp;<span class="num" id="4417242">0</span><span class="op" id="4417243">)</span>&nbsp;<span class="op" id="4417245">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4417250">!</span><span class="ident" id="4417251">oidInExtensions</span><span class="op" id="4417266">(</span><span class="ident" id="4417267">oidExtensionExtendedKeyUsage</span><span class="op" id="4417295">,</span>&nbsp;<span class="ident" id="4417297">template</span><span class="op" id="4417305">.</span><span class="ident" id="4417306">ExtraExtensions</span><span class="op" id="4417321">)</span>&nbsp;<span class="op" id="4417323">{</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417327">ret</span><span class="op" id="4417330">[</span><span class="ident" id="4417331">n</span><span class="op" id="4417332">]</span><span class="op" id="4417333">.</span><span class="ident" id="4417334">Id</span>&nbsp;<span class="op" id="4417337">=</span>&nbsp;<span class="ident" id="4417339">oidExtensionExtendedKeyUsage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417371">var</span>&nbsp;<span class="ident" id="4417375">oids</span>&nbsp;<span class="op" id="4417380">[</span><span class="op" id="4417381">]</span><span class="ident" id="4417382">asn1</span><span class="op" id="4417386">.</span><span class="ident" id="4417387">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417406">for</span>&nbsp;<span class="ident" id="4417410">_</span><span class="op" id="4417411">,</span>&nbsp;<span class="ident" id="4417413">u</span>&nbsp;<span class="op" id="4417415">:=</span>&nbsp;<span class="keyword" id="4417418">range</span>&nbsp;<span class="ident" id="4417424">template</span><span class="op" id="4417432">.</span><span class="ident" id="4417433">ExtKeyUsage</span>&nbsp;<span class="op" id="4417445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417450">if</span>&nbsp;<span class="ident" id="4417453">oid</span><span class="op" id="4417456">,</span>&nbsp;<span class="ident" id="4417458">ok</span>&nbsp;<span class="op" id="4417461">:=</span>&nbsp;<span class="ident" id="4417464">oidFromExtKeyUsage</span><span class="op" id="4417482">(</span><span class="ident" id="4417483">u</span><span class="op" id="4417484">)</span><span class="op" id="4417485">;</span>&nbsp;<span class="ident" id="4417487">ok</span>&nbsp;<span class="op" id="4417490">{</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417496">oids</span>&nbsp;<span class="op" id="4417501">=</span>&nbsp;<span class="builtinfunc" id="4417503">append</span><span class="op" id="4417509">(</span><span class="ident" id="4417510">oids</span><span class="op" id="4417514">,</span>&nbsp;<span class="ident" id="4417516">oid</span><span class="op" id="4417519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4417524">}</span>&nbsp;<span class="keyword" id="4417526">else</span>&nbsp;<span class="op" id="4417531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4417537">panic</span><span class="op" id="4417542">(</span><span class="string" id="4417543">&#34;internal&nbsp;error&#34;</span><span class="op" id="4417559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4417564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4417568">}</span><br>
<span class="lineno">1225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417573">oids</span>&nbsp;<span class="op" id="4417578">=</span>&nbsp;<span class="builtinfunc" id="4417580">append</span><span class="op" id="4417586">(</span><span class="ident" id="4417587">oids</span><span class="op" id="4417591">,</span>&nbsp;<span class="ident" id="4417593">template</span><span class="op" id="4417601">.</span><span class="ident" id="4417602">UnknownExtKeyUsage</span><span class="op" id="4417620">...</span><span class="op" id="4417623">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417628">ret</span><span class="op" id="4417631">[</span><span class="ident" id="4417632">n</span><span class="op" id="4417633">]</span><span class="op" id="4417634">.</span><span class="ident" id="4417635">Value</span><span class="op" id="4417640">,</span>&nbsp;<span class="ident" id="4417642">err</span>&nbsp;<span class="op" id="4417646">=</span>&nbsp;<span class="ident" id="4417648">asn1</span><span class="op" id="4417652">.</span><span class="ident" id="4417653">Marshal</span><span class="op" id="4417660">(</span><span class="ident" id="4417661">oids</span><span class="op" id="4417665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417669">if</span>&nbsp;<span class="ident" id="4417672">err</span>&nbsp;<span class="op" id="4417676">!=</span>&nbsp;<span class="builtintype" id="4417679">nil</span>&nbsp;<span class="op" id="4417683">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417688">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4417697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417701">n</span><span class="op" id="4417702">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4417706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417710">if</span>&nbsp;<span class="ident" id="4417713">template</span><span class="op" id="4417721">.</span><span class="ident" id="4417722">BasicConstraintsValid</span>&nbsp;<span class="op" id="4417744">&amp;&amp;</span>&nbsp;<span class="op" id="4417747">!</span><span class="ident" id="4417748">oidInExtensions</span><span class="op" id="4417763">(</span><span class="ident" id="4417764">oidExtensionBasicConstraints</span><span class="op" id="4417792">,</span>&nbsp;<span class="ident" id="4417794">template</span><span class="op" id="4417802">.</span><span class="ident" id="4417803">ExtraExtensions</span><span class="op" id="4417818">)</span>&nbsp;<span class="op" id="4417820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4417824">//&nbsp;Leaving&nbsp;MaxPathLen&nbsp;as&nbsp;zero&nbsp;indicates&nbsp;that&nbsp;no&nbsp;maximum&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4417887">//&nbsp;length&nbsp;is&nbsp;desired,&nbsp;unless&nbsp;MaxPathLenZero&nbsp;is&nbsp;set.&nbsp;A&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4417952">//&nbsp;-1&nbsp;causes&nbsp;encoding/asn1&nbsp;to&nbsp;omit&nbsp;the&nbsp;value&nbsp;as&nbsp;desired.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418011">maxPathLen</span>&nbsp;<span class="op" id="4418022">:=</span>&nbsp;<span class="ident" id="4418025">template</span><span class="op" id="4418033">.</span><span class="ident" id="4418034">MaxPathLen</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418047">if</span>&nbsp;<span class="ident" id="4418050">maxPathLen</span>&nbsp;<span class="op" id="4418061">==</span>&nbsp;<span class="num" id="4418064">0</span>&nbsp;<span class="op" id="4418066">&amp;&amp;</span>&nbsp;<span class="op" id="4418069">!</span><span class="ident" id="4418070">template</span><span class="op" id="4418078">.</span><span class="ident" id="4418079">MaxPathLenZero</span>&nbsp;<span class="op" id="4418094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418099">maxPathLen</span>&nbsp;<span class="op" id="4418110">=</span>&nbsp;<span class="op" id="4418112">-</span><span class="num" id="4418113">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4418117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418121">ret</span><span class="op" id="4418124">[</span><span class="ident" id="4418125">n</span><span class="op" id="4418126">]</span><span class="op" id="4418127">.</span><span class="ident" id="4418128">Id</span>&nbsp;<span class="op" id="4418131">=</span>&nbsp;<span class="ident" id="4418133">oidExtensionBasicConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418164">ret</span><span class="op" id="4418167">[</span><span class="ident" id="4418168">n</span><span class="op" id="4418169">]</span><span class="op" id="4418170">.</span><span class="ident" id="4418171">Value</span><span class="op" id="4418176">,</span>&nbsp;<span class="ident" id="4418178">err</span>&nbsp;<span class="op" id="4418182">=</span>&nbsp;<span class="ident" id="4418184">asn1</span><span class="op" id="4418188">.</span><span class="ident" id="4418189">Marshal</span><span class="op" id="4418196">(</span><span class="ident" id="4418197">basicConstraints</span><span class="op" id="4418213">{</span><span class="ident" id="4418214">template</span><span class="op" id="4418222">.</span><span class="ident" id="4418223">IsCA</span><span class="op" id="4418227">,</span>&nbsp;<span class="ident" id="4418229">maxPathLen</span><span class="op" id="4418239">}</span><span class="op" id="4418240">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418244">ret</span><span class="op" id="4418247">[</span><span class="ident" id="4418248">n</span><span class="op" id="4418249">]</span><span class="op" id="4418250">.</span><span class="ident" id="4418251">Critical</span>&nbsp;<span class="op" id="4418260">=</span>&nbsp;<span class="builtintype" id="4418262">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418269">if</span>&nbsp;<span class="ident" id="4418272">err</span>&nbsp;<span class="op" id="4418276">!=</span>&nbsp;<span class="builtintype" id="4418279">nil</span>&nbsp;<span class="op" id="4418283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418288">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4418297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418301">n</span><span class="op" id="4418302">++</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4418306">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418310">if</span>&nbsp;<span class="builtinfunc" id="4418313">len</span><span class="op" id="4418316">(</span><span class="ident" id="4418317">template</span><span class="op" id="4418325">.</span><span class="ident" id="4418326">SubjectKeyId</span><span class="op" id="4418338">)</span>&nbsp;<span class="op" id="4418340">&gt;</span>&nbsp;<span class="num" id="4418342">0</span>&nbsp;<span class="op" id="4418344">&amp;&amp;</span>&nbsp;<span class="op" id="4418347">!</span><span class="ident" id="4418348">oidInExtensions</span><span class="op" id="4418363">(</span><span class="ident" id="4418364">oidExtensionSubjectKeyId</span><span class="op" id="4418388">,</span>&nbsp;<span class="ident" id="4418390">template</span><span class="op" id="4418398">.</span><span class="ident" id="4418399">ExtraExtensions</span><span class="op" id="4418414">)</span>&nbsp;<span class="op" id="4418416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418420">ret</span><span class="op" id="4418423">[</span><span class="ident" id="4418424">n</span><span class="op" id="4418425">]</span><span class="op" id="4418426">.</span><span class="ident" id="4418427">Id</span>&nbsp;<span class="op" id="4418430">=</span>&nbsp;<span class="ident" id="4418432">oidExtensionSubjectKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418459">ret</span><span class="op" id="4418462">[</span><span class="ident" id="4418463">n</span><span class="op" id="4418464">]</span><span class="op" id="4418465">.</span><span class="ident" id="4418466">Value</span><span class="op" id="4418471">,</span>&nbsp;<span class="ident" id="4418473">err</span>&nbsp;<span class="op" id="4418477">=</span>&nbsp;<span class="ident" id="4418479">asn1</span><span class="op" id="4418483">.</span><span class="ident" id="4418484">Marshal</span><span class="op" id="4418491">(</span><span class="ident" id="4418492">template</span><span class="op" id="4418500">.</span><span class="ident" id="4418501">SubjectKeyId</span><span class="op" id="4418513">)</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418517">if</span>&nbsp;<span class="ident" id="4418520">err</span>&nbsp;<span class="op" id="4418524">!=</span>&nbsp;<span class="builtintype" id="4418527">nil</span>&nbsp;<span class="op" id="4418531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418536">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4418545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418549">n</span><span class="op" id="4418550">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4418554">}</span><br>
<span class="lineno">1260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418558">if</span>&nbsp;<span class="builtinfunc" id="4418561">len</span><span class="op" id="4418564">(</span><span class="ident" id="4418565">template</span><span class="op" id="4418573">.</span><span class="ident" id="4418574">AuthorityKeyId</span><span class="op" id="4418588">)</span>&nbsp;<span class="op" id="4418590">&gt;</span>&nbsp;<span class="num" id="4418592">0</span>&nbsp;<span class="op" id="4418594">&amp;&amp;</span>&nbsp;<span class="op" id="4418597">!</span><span class="ident" id="4418598">oidInExtensions</span><span class="op" id="4418613">(</span><span class="ident" id="4418614">oidExtensionAuthorityKeyId</span><span class="op" id="4418640">,</span>&nbsp;<span class="ident" id="4418642">template</span><span class="op" id="4418650">.</span><span class="ident" id="4418651">ExtraExtensions</span><span class="op" id="4418666">)</span>&nbsp;<span class="op" id="4418668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418672">ret</span><span class="op" id="4418675">[</span><span class="ident" id="4418676">n</span><span class="op" id="4418677">]</span><span class="op" id="4418678">.</span><span class="ident" id="4418679">Id</span>&nbsp;<span class="op" id="4418682">=</span>&nbsp;<span class="ident" id="4418684">oidExtensionAuthorityKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418713">ret</span><span class="op" id="4418716">[</span><span class="ident" id="4418717">n</span><span class="op" id="4418718">]</span><span class="op" id="4418719">.</span><span class="ident" id="4418720">Value</span><span class="op" id="4418725">,</span>&nbsp;<span class="ident" id="4418727">err</span>&nbsp;<span class="op" id="4418731">=</span>&nbsp;<span class="ident" id="4418733">asn1</span><span class="op" id="4418737">.</span><span class="ident" id="4418738">Marshal</span><span class="op" id="4418745">(</span><span class="ident" id="4418746">authKeyId</span><span class="op" id="4418755">{</span><span class="ident" id="4418756">template</span><span class="op" id="4418764">.</span><span class="ident" id="4418765">AuthorityKeyId</span><span class="op" id="4418779">}</span><span class="op" id="4418780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418784">if</span>&nbsp;<span class="ident" id="4418787">err</span>&nbsp;<span class="op" id="4418791">!=</span>&nbsp;<span class="builtintype" id="4418794">nil</span>&nbsp;<span class="op" id="4418798">{</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418803">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4418812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418816">n</span><span class="op" id="4418817">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4418821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418825">if</span>&nbsp;<span class="op" id="4418828">(</span><span class="builtinfunc" id="4418829">len</span><span class="op" id="4418832">(</span><span class="ident" id="4418833">template</span><span class="op" id="4418841">.</span><span class="ident" id="4418842">OCSPServer</span><span class="op" id="4418852">)</span>&nbsp;<span class="op" id="4418854">&gt;</span>&nbsp;<span class="num" id="4418856">0</span>&nbsp;<span class="op" id="4418858">||</span>&nbsp;<span class="builtinfunc" id="4418861">len</span><span class="op" id="4418864">(</span><span class="ident" id="4418865">template</span><span class="op" id="4418873">.</span><span class="ident" id="4418874">IssuingCertificateURL</span><span class="op" id="4418895">)</span>&nbsp;<span class="op" id="4418897">&gt;</span>&nbsp;<span class="num" id="4418899">0</span><span class="op" id="4418900">)</span>&nbsp;<span class="op" id="4418902">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4418907">!</span><span class="ident" id="4418908">oidInExtensions</span><span class="op" id="4418923">(</span><span class="ident" id="4418924">oidExtensionAuthorityInfoAccess</span><span class="op" id="4418955">,</span>&nbsp;<span class="ident" id="4418957">template</span><span class="op" id="4418965">.</span><span class="ident" id="4418966">ExtraExtensions</span><span class="op" id="4418981">)</span>&nbsp;<span class="op" id="4418983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418987">ret</span><span class="op" id="4418990">[</span><span class="ident" id="4418991">n</span><span class="op" id="4418992">]</span><span class="op" id="4418993">.</span><span class="ident" id="4418994">Id</span>&nbsp;<span class="op" id="4418997">=</span>&nbsp;<span class="ident" id="4418999">oidExtensionAuthorityInfoAccess</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419033">var</span>&nbsp;<span class="ident" id="4419037">aiaValues</span>&nbsp;<span class="op" id="4419047">[</span><span class="op" id="4419048">]</span><span class="ident" id="4419049">authorityInfoAccess</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419071">for</span>&nbsp;<span class="ident" id="4419075">_</span><span class="op" id="4419076">,</span>&nbsp;<span class="ident" id="4419078">name</span>&nbsp;<span class="op" id="4419083">:=</span>&nbsp;<span class="keyword" id="4419086">range</span>&nbsp;<span class="ident" id="4419092">template</span><span class="op" id="4419100">.</span><span class="ident" id="4419101">OCSPServer</span>&nbsp;<span class="op" id="4419112">{</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419117">aiaValues</span>&nbsp;<span class="op" id="4419127">=</span>&nbsp;<span class="builtinfunc" id="4419129">append</span><span class="op" id="4419135">(</span><span class="ident" id="4419136">aiaValues</span><span class="op" id="4419145">,</span>&nbsp;<span class="ident" id="4419147">authorityInfoAccess</span><span class="op" id="4419166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419172">Method</span><span class="op" id="4419178">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4419182">oidAuthorityInfoAccessOcsp</span><span class="op" id="4419208">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419214">Location</span><span class="op" id="4419222">:</span>&nbsp;<span class="ident" id="4419224">asn1</span><span class="op" id="4419228">.</span><span class="ident" id="4419229">RawValue</span><span class="op" id="4419237">{</span><span class="ident" id="4419238">Tag</span><span class="op" id="4419241">:</span>&nbsp;<span class="num" id="4419243">6</span><span class="op" id="4419244">,</span>&nbsp;<span class="ident" id="4419246">Class</span><span class="op" id="4419251">:</span>&nbsp;<span class="num" id="4419253">2</span><span class="op" id="4419254">,</span>&nbsp;<span class="ident" id="4419256">Bytes</span><span class="op" id="4419261">:</span>&nbsp;<span class="op" id="4419263">[</span><span class="op" id="4419264">]</span><span class="builtintype" id="4419265">byte</span><span class="op" id="4419269">(</span><span class="ident" id="4419270">name</span><span class="op" id="4419274">)</span><span class="op" id="4419275">}</span><span class="op" id="4419276">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4419281">}</span><span class="op" id="4419282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4419286">}</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419290">for</span>&nbsp;<span class="ident" id="4419294">_</span><span class="op" id="4419295">,</span>&nbsp;<span class="ident" id="4419297">name</span>&nbsp;<span class="op" id="4419302">:=</span>&nbsp;<span class="keyword" id="4419305">range</span>&nbsp;<span class="ident" id="4419311">template</span><span class="op" id="4419319">.</span><span class="ident" id="4419320">IssuingCertificateURL</span>&nbsp;<span class="op" id="4419342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419347">aiaValues</span>&nbsp;<span class="op" id="4419357">=</span>&nbsp;<span class="builtinfunc" id="4419359">append</span><span class="op" id="4419365">(</span><span class="ident" id="4419366">aiaValues</span><span class="op" id="4419375">,</span>&nbsp;<span class="ident" id="4419377">authorityInfoAccess</span><span class="op" id="4419396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419402">Method</span><span class="op" id="4419408">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4419412">oidAuthorityInfoAccessIssuers</span><span class="op" id="4419441">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419447">Location</span><span class="op" id="4419455">:</span>&nbsp;<span class="ident" id="4419457">asn1</span><span class="op" id="4419461">.</span><span class="ident" id="4419462">RawValue</span><span class="op" id="4419470">{</span><span class="ident" id="4419471">Tag</span><span class="op" id="4419474">:</span>&nbsp;<span class="num" id="4419476">6</span><span class="op" id="4419477">,</span>&nbsp;<span class="ident" id="4419479">Class</span><span class="op" id="4419484">:</span>&nbsp;<span class="num" id="4419486">2</span><span class="op" id="4419487">,</span>&nbsp;<span class="ident" id="4419489">Bytes</span><span class="op" id="4419494">:</span>&nbsp;<span class="op" id="4419496">[</span><span class="op" id="4419497">]</span><span class="builtintype" id="4419498">byte</span><span class="op" id="4419502">(</span><span class="ident" id="4419503">name</span><span class="op" id="4419507">)</span><span class="op" id="4419508">}</span><span class="op" id="4419509">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4419514">}</span><span class="op" id="4419515">)</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4419519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419523">ret</span><span class="op" id="4419526">[</span><span class="ident" id="4419527">n</span><span class="op" id="4419528">]</span><span class="op" id="4419529">.</span><span class="ident" id="4419530">Value</span><span class="op" id="4419535">,</span>&nbsp;<span class="ident" id="4419537">err</span>&nbsp;<span class="op" id="4419541">=</span>&nbsp;<span class="ident" id="4419543">asn1</span><span class="op" id="4419547">.</span><span class="ident" id="4419548">Marshal</span><span class="op" id="4419555">(</span><span class="ident" id="4419556">aiaValues</span><span class="op" id="4419565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419569">if</span>&nbsp;<span class="ident" id="4419572">err</span>&nbsp;<span class="op" id="4419576">!=</span>&nbsp;<span class="builtintype" id="4419579">nil</span>&nbsp;<span class="op" id="4419583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419588">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4419597">}</span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419601">n</span><span class="op" id="4419602">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4419606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419610">if</span>&nbsp;<span class="op" id="4419613">(</span><span class="builtinfunc" id="4419614">len</span><span class="op" id="4419617">(</span><span class="ident" id="4419618">template</span><span class="op" id="4419626">.</span><span class="ident" id="4419627">DNSNames</span><span class="op" id="4419635">)</span>&nbsp;<span class="op" id="4419637">&gt;</span>&nbsp;<span class="num" id="4419639">0</span>&nbsp;<span class="op" id="4419641">||</span>&nbsp;<span class="builtinfunc" id="4419644">len</span><span class="op" id="4419647">(</span><span class="ident" id="4419648">template</span><span class="op" id="4419656">.</span><span class="ident" id="4419657">EmailAddresses</span><span class="op" id="4419671">)</span>&nbsp;<span class="op" id="4419673">&gt;</span>&nbsp;<span class="num" id="4419675">0</span>&nbsp;<span class="op" id="4419677">||</span>&nbsp;<span class="builtinfunc" id="4419680">len</span><span class="op" id="4419683">(</span><span class="ident" id="4419684">template</span><span class="op" id="4419692">.</span><span class="ident" id="4419693">IPAddresses</span><span class="op" id="4419704">)</span>&nbsp;<span class="op" id="4419706">&gt;</span>&nbsp;<span class="num" id="4419708">0</span><span class="op" id="4419709">)</span>&nbsp;<span class="op" id="4419711">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4419716">!</span><span class="ident" id="4419717">oidInExtensions</span><span class="op" id="4419732">(</span><span class="ident" id="4419733">oidExtensionSubjectAltName</span><span class="op" id="4419759">,</span>&nbsp;<span class="ident" id="4419761">template</span><span class="op" id="4419769">.</span><span class="ident" id="4419770">ExtraExtensions</span><span class="op" id="4419785">)</span>&nbsp;<span class="op" id="4419787">{</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419791">ret</span><span class="op" id="4419794">[</span><span class="ident" id="4419795">n</span><span class="op" id="4419796">]</span><span class="op" id="4419797">.</span><span class="ident" id="4419798">Id</span>&nbsp;<span class="op" id="4419801">=</span>&nbsp;<span class="ident" id="4419803">oidExtensionSubjectAltName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419832">ret</span><span class="op" id="4419835">[</span><span class="ident" id="4419836">n</span><span class="op" id="4419837">]</span><span class="op" id="4419838">.</span><span class="ident" id="4419839">Value</span><span class="op" id="4419844">,</span>&nbsp;<span class="ident" id="4419846">err</span>&nbsp;<span class="op" id="4419850">=</span>&nbsp;<span class="ident" id="4419852">marshalSANs</span><span class="op" id="4419863">(</span><span class="ident" id="4419864">template</span><span class="op" id="4419872">.</span><span class="ident" id="4419873">DNSNames</span><span class="op" id="4419881">,</span>&nbsp;<span class="ident" id="4419883">template</span><span class="op" id="4419891">.</span><span class="ident" id="4419892">EmailAddresses</span><span class="op" id="4419906">,</span>&nbsp;<span class="ident" id="4419908">template</span><span class="op" id="4419916">.</span><span class="ident" id="4419917">IPAddresses</span><span class="op" id="4419928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419932">if</span>&nbsp;<span class="ident" id="4419935">err</span>&nbsp;<span class="op" id="4419939">!=</span>&nbsp;<span class="builtintype" id="4419942">nil</span>&nbsp;<span class="op" id="4419946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419951">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4419960">}</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419964">n</span><span class="op" id="4419965">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4419969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419973">if</span>&nbsp;<span class="builtinfunc" id="4419976">len</span><span class="op" id="4419979">(</span><span class="ident" id="4419980">template</span><span class="op" id="4419988">.</span><span class="ident" id="4419989">PolicyIdentifiers</span><span class="op" id="4420006">)</span>&nbsp;<span class="op" id="4420008">&gt;</span>&nbsp;<span class="num" id="4420010">0</span>&nbsp;<span class="op" id="4420012">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4420017">!</span><span class="ident" id="4420018">oidInExtensions</span><span class="op" id="4420033">(</span><span class="ident" id="4420034">oidExtensionCertificatePolicies</span><span class="op" id="4420065">,</span>&nbsp;<span class="ident" id="4420067">template</span><span class="op" id="4420075">.</span><span class="ident" id="4420076">ExtraExtensions</span><span class="op" id="4420091">)</span>&nbsp;<span class="op" id="4420093">{</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4420097">ret</span><span class="op" id="4420100">[</span><span class="ident" id="4420101">n</span><span class="op" id="4420102">]</span><span class="op" id="4420103">.</span><span class="ident" id="4420104">Id</span>&nbsp;<span class="op" id="4420107">=</span>&nbsp;<span class="ident" id="4420109">oidExtensionCertificatePolicies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4420143">policies</span>&nbsp;<span class="op" id="4420152">:=</span>&nbsp;<span class="builtinfunc" id="4420155">make</span><span class="op" id="4420159">(</span><span class="op" id="4420160">[</span><span class="op" id="4420161">]</span><span class="ident" id="4420162">policyInformation</span><span class="op" id="4420179">,</span>&nbsp;<span class="builtinfunc" id="4420181">len</span><span class="op" id="4420184">(</span><span class="ident" id="4420185">template</span><span class="op" id="4420193">.</span><span class="ident" id="4420194">PolicyIdentifiers</span><span class="op" id="4420211">)</span><span class="op" id="4420212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420216">for</span>&nbsp;<span class="ident" id="4420220">i</span><span class="op" id="4420221">,</span>&nbsp;<span class="ident" id="4420223">policy</span>&nbsp;<span class="op" id="4420230">:=</span>&nbsp;<span class="keyword" id="4420233">range</span>&nbsp;<span class="ident" id="4420239">template</span><span class="op" id="4420247">.</span><span class="ident" id="4420248">PolicyIdentifiers</span>&nbsp;<span class="op" id="4420266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4420271">policies</span><span class="op" id="4420279">[</span><span class="ident" id="4420280">i</span><span class="op" id="4420281">]</span><span class="op" id="4420282">.</span><span class="ident" id="4420283">Policy</span>&nbsp;<span class="op" id="4420290">=</span>&nbsp;<span class="ident" id="4420292">policy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4420301">}</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4420305">ret</span><span class="op" id="4420308">[</span><span class="ident" id="4420309">n</span><span class="op" id="4420310">]</span><span class="op" id="4420311">.</span><span class="ident" id="4420312">Value</span><span class="op" id="4420317">,</span>&nbsp;<span class="ident" id="4420319">err</span>&nbsp;<span class="op" id="4420323">=</span>&nbsp;<span class="ident" id="4420325">asn1</span><span class="op" id="4420329">.</span><span class="ident" id="4420330">Marshal</span><span class="op" id="4420337">(</span><span class="ident" id="4420338">policies</span><span class="op" id="4420346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420350">if</span>&nbsp;<span class="ident" id="4420353">err</span>&nbsp;<span class="op" id="4420357">!=</span>&nbsp;<span class="builtintype" id="4420360">nil</span>&nbsp;<span class="op" id="4420364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420369">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4420378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4420382">n</span><span class="op" id="4420383">++</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4420387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420391">if</span>&nbsp;<span class="builtinfunc" id="4420394">len</span><span class="op" id="4420397">(</span><span class="ident" id="4420398">template</span><span class="op" id="4420406">.</span><span class="ident" id="4420407">PermittedDNSDomains</span><span class="op" id="4420426">)</span>&nbsp;<span class="op" id="4420428">&gt;</span>&nbsp;<span class="num" id="4420430">0</span>&nbsp;<span class="op" id="4420432">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4420437">!</span><span class="ident" id="4420438">oidInExtensions</span><span class="op" id="4420453">(</span><span class="ident" id="4420454">oidExtensionNameConstraints</span><span class="op" id="4420481">,</span>&nbsp;<span class="ident" id="4420483">template</span><span class="op" id="4420491">.</span><span class="ident" id="4420492">ExtraExtensions</span><span class="op" id="4420507">)</span>&nbsp;<span class="op" id="4420509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4420513">ret</span><span class="op" id="4420516">[</span><span class="ident" id="4420517">n</span><span class="op" id="4420518">]</span><span class="op" id="4420519">.</span><span class="ident" id="4420520">Id</span>&nbsp;<span class="op" id="4420523">=</span>&nbsp;<span class="ident" id="4420525">oidExtensionNameConstraints</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4420555">ret</span><span class="op" id="4420558">[</span><span class="ident" id="4420559">n</span><span class="op" id="4420560">]</span><span class="op" id="4420561">.</span><span class="ident" id="4420562">Critical</span>&nbsp;<span class="op" id="4420571">=</span>&nbsp;<span class="ident" id="4420573">template</span><span class="op" id="4420581">.</span><span class="ident" id="4420582">PermittedDNSDomainsCritical</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420613">var</span>&nbsp;<span class="ident" id="4420617">out</span>&nbsp;<span class="ident" id="4420621">nameConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4420639">out</span><span class="op" id="4420642">.</span><span class="ident" id="4420643">Permitted</span>&nbsp;<span class="op" id="4420653">=</span>&nbsp;<span class="builtinfunc" id="4420655">make</span><span class="op" id="4420659">(</span><span class="op" id="4420660">[</span><span class="op" id="4420661">]</span><span class="ident" id="4420662">generalSubtree</span><span class="op" id="4420676">,</span>&nbsp;<span class="builtinfunc" id="4420678">len</span><span class="op" id="4420681">(</span><span class="ident" id="4420682">template</span><span class="op" id="4420690">.</span><span class="ident" id="4420691">PermittedDNSDomains</span><span class="op" id="4420710">)</span><span class="op" id="4420711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420715">for</span>&nbsp;<span class="ident" id="4420719">i</span><span class="op" id="4420720">,</span>&nbsp;<span class="ident" id="4420722">permitted</span>&nbsp;<span class="op" id="4420732">:=</span>&nbsp;<span class="keyword" id="4420735">range</span>&nbsp;<span class="ident" id="4420741">template</span><span class="op" id="4420749">.</span><span class="ident" id="4420750">PermittedDNSDomains</span>&nbsp;<span class="op" id="4420770">{</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4420775">out</span><span class="op" id="4420778">.</span><span class="ident" id="4420779">Permitted</span><span class="op" id="4420788">[</span><span class="ident" id="4420789">i</span><span class="op" id="4420790">]</span>&nbsp;<span class="op" id="4420792">=</span>&nbsp;<span class="ident" id="4420794">generalSubtree</span><span class="op" id="4420808">{</span><span class="ident" id="4420809">Name</span><span class="op" id="4420813">:</span>&nbsp;<span class="ident" id="4420815">permitted</span><span class="op" id="4420824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4420828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4420832">ret</span><span class="op" id="4420835">[</span><span class="ident" id="4420836">n</span><span class="op" id="4420837">]</span><span class="op" id="4420838">.</span><span class="ident" id="4420839">Value</span><span class="op" id="4420844">,</span>&nbsp;<span class="ident" id="4420846">err</span>&nbsp;<span class="op" id="4420850">=</span>&nbsp;<span class="ident" id="4420852">asn1</span><span class="op" id="4420856">.</span><span class="ident" id="4420857">Marshal</span><span class="op" id="4420864">(</span><span class="ident" id="4420865">out</span><span class="op" id="4420868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420872">if</span>&nbsp;<span class="ident" id="4420875">err</span>&nbsp;<span class="op" id="4420879">!=</span>&nbsp;<span class="builtintype" id="4420882">nil</span>&nbsp;<span class="op" id="4420886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420891">return</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4420900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4420904">n</span><span class="op" id="4420905">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4420909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420913">if</span>&nbsp;<span class="builtinfunc" id="4420916">len</span><span class="op" id="4420919">(</span><span class="ident" id="4420920">template</span><span class="op" id="4420928">.</span><span class="ident" id="4420929">CRLDistributionPoints</span><span class="op" id="4420950">)</span>&nbsp;<span class="op" id="4420952">&gt;</span>&nbsp;<span class="num" id="4420954">0</span>&nbsp;<span class="op" id="4420956">&amp;&amp;</span><br>
<span class="lineno">1335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4420961">!</span><span class="ident" id="4420962">oidInExtensions</span><span class="op" id="4420977">(</span><span class="ident" id="4420978">oidExtensionCRLDistributionPoints</span><span class="op" id="4421011">,</span>&nbsp;<span class="ident" id="4421013">template</span><span class="op" id="4421021">.</span><span class="ident" id="4421022">ExtraExtensions</span><span class="op" id="4421037">)</span>&nbsp;<span class="op" id="4421039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4421043">ret</span><span class="op" id="4421046">[</span><span class="ident" id="4421047">n</span><span class="op" id="4421048">]</span><span class="op" id="4421049">.</span><span class="ident" id="4421050">Id</span>&nbsp;<span class="op" id="4421053">=</span>&nbsp;<span class="ident" id="4421055">oidExtensionCRLDistributionPoints</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4421092">var</span>&nbsp;<span class="ident" id="4421096">crlDp</span>&nbsp;<span class="op" id="4421102">[</span><span class="op" id="4421103">]</span><span class="ident" id="4421104">distributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4421124">for</span>&nbsp;<span class="ident" id="4421128">_</span><span class="op" id="4421129">,</span>&nbsp;<span class="ident" id="4421131">name</span>&nbsp;<span class="op" id="4421136">:=</span>&nbsp;<span class="keyword" id="4421139">range</span>&nbsp;<span class="ident" id="4421145">template</span><span class="op" id="4421153">.</span><span class="ident" id="4421154">CRLDistributionPoints</span>&nbsp;<span class="op" id="4421176">{</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4421181">rawFullName</span><span class="op" id="4421192">,</span>&nbsp;<span class="ident" id="4421194">_</span>&nbsp;<span class="op" id="4421196">:=</span>&nbsp;<span class="ident" id="4421199">asn1</span><span class="op" id="4421203">.</span><span class="ident" id="4421204">Marshal</span><span class="op" id="4421211">(</span><span class="ident" id="4421212">asn1</span><span class="op" id="4421216">.</span><span class="ident" id="4421217">RawValue</span><span class="op" id="4421225">{</span><span class="ident" id="4421226">Tag</span><span class="op" id="4421229">:</span>&nbsp;<span class="num" id="4421231">6</span><span class="op" id="4421232">,</span>&nbsp;<span class="ident" id="4421234">Class</span><span class="op" id="4421239">:</span>&nbsp;<span class="num" id="4421241">2</span><span class="op" id="4421242">,</span>&nbsp;<span class="ident" id="4421244">Bytes</span><span class="op" id="4421249">:</span>&nbsp;<span class="op" id="4421251">[</span><span class="op" id="4421252">]</span><span class="builtintype" id="4421253">byte</span><span class="op" id="4421257">(</span><span class="ident" id="4421258">name</span><span class="op" id="4421262">)</span><span class="op" id="4421263">}</span><span class="op" id="4421264">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4421270">dp</span>&nbsp;<span class="op" id="4421273">:=</span>&nbsp;<span class="ident" id="4421276">distributionPoint</span><span class="op" id="4421293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4421299">DistributionPoint</span><span class="op" id="4421316">:</span>&nbsp;<span class="ident" id="4421318">distributionPointName</span><span class="op" id="4421339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4421346">FullName</span><span class="op" id="4421354">:</span>&nbsp;<span class="ident" id="4421356">asn1</span><span class="op" id="4421360">.</span><span class="ident" id="4421361">RawValue</span><span class="op" id="4421369">{</span><span class="ident" id="4421370">Tag</span><span class="op" id="4421373">:</span>&nbsp;<span class="num" id="4421375">0</span><span class="op" id="4421376">,</span>&nbsp;<span class="ident" id="4421378">Class</span><span class="op" id="4421383">:</span>&nbsp;<span class="num" id="4421385">2</span><span class="op" id="4421386">,</span>&nbsp;<span class="ident" id="4421388">IsCompound</span><span class="op" id="4421398">:</span>&nbsp;<span class="builtintype" id="4421400">true</span><span class="op" id="4421404">,</span>&nbsp;<span class="ident" id="4421406">Bytes</span><span class="op" id="4421411">:</span>&nbsp;<span class="ident" id="4421413">rawFullName</span><span class="op" id="4421424">}</span><span class="op" id="4421425">,</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4421431">}</span><span class="op" id="4421432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4421437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4421442">crlDp</span>&nbsp;<span class="op" id="4421448">=</span>&nbsp;<span class="builtinfunc" id="4421450">append</span><span class="op" id="4421456">(</span><span class="ident" id="4421457">crlDp</span><span class="op" id="4421462">,</span>&nbsp;<span class="ident" id="4421464">dp</span><span class="op" id="4421466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4421470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4421475">ret</span><span class="op" id="4421478">[</span><span class="ident" id="4421479">n</span><span class="op" id="4421480">]</span><span class="op" id="4421481">.</span><span class="ident" id="4421482">Value</span><span class="op" id="4421487">,</span>&nbsp;<span class="ident" id="4421489">err</span>&nbsp;<span class="op" id="4421493">=</span>&nbsp;<span class="ident" id="4421495">asn1</span><span class="op" id="4421499">.</span><span class="ident" id="4421500">Marshal</span><span class="op" id="4421507">(</span><span class="ident" id="4421508">crlDp</span><span class="op" id="4421513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4421517">if</span>&nbsp;<span class="ident" id="4421520">err</span>&nbsp;<span class="op" id="4421524">!=</span>&nbsp;<span class="builtintype" id="4421527">nil</span>&nbsp;<span class="op" id="4421531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4421536">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4421545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4421549">n</span><span class="op" id="4421550">++</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4421554">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4421558">//&nbsp;Adding&nbsp;another&nbsp;extension&nbsp;here?&nbsp;Remember&nbsp;to&nbsp;update&nbsp;the&nbsp;maximum&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4421631">//&nbsp;of&nbsp;elements&nbsp;in&nbsp;the&nbsp;make()&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;function.</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4421690">return</span>&nbsp;<span class="builtinfunc" id="4421697">append</span><span class="op" id="4421703">(</span><span class="ident" id="4421704">ret</span><span class="op" id="4421707">[</span><span class="op" id="4421708">:</span><span class="ident" id="4421709">n</span><span class="op" id="4421710">]</span><span class="op" id="4421711">,</span>&nbsp;<span class="ident" id="4421713">template</span><span class="op" id="4421721">.</span><span class="ident" id="4421722">ExtraExtensions</span><span class="op" id="4421737">...</span><span class="op" id="4421740">)</span><span class="op" id="4421741">,</span>&nbsp;<span class="builtintype" id="4421743">nil</span><br>
<span class="lineno"></span><span class="op" id="4421747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4421750">func</span>&nbsp;<span class="ident" id="4421755">subjectBytes</span><span class="op" id="4421767">(</span><span class="ident" id="4421768">cert</span>&nbsp;<span class="op" id="4421773">*</span><span class="ident" id="4421774">Certificate</span><span class="op" id="4421785">)</span>&nbsp;<span class="op" id="4421787">(</span><span class="op" id="4421788">[</span><span class="op" id="4421789">]</span><span class="builtintype" id="4421790">byte</span><span class="op" id="4421794">,</span>&nbsp;<span class="builtintype" id="4421796">error</span><span class="op" id="4421801">)</span>&nbsp;<span class="op" id="4421803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4421806">if</span>&nbsp;<span class="builtinfunc" id="4421809">len</span><span class="op" id="4421812">(</span><span class="ident" id="4421813">cert</span><span class="op" id="4421817">.</span><span class="ident" id="4421818">RawSubject</span><span class="op" id="4421828">)</span>&nbsp;<span class="op" id="4421830">&gt;</span>&nbsp;<span class="num" id="4421832">0</span>&nbsp;<span class="op" id="4421834">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4421838">return</span>&nbsp;<span class="ident" id="4421845">cert</span><span class="op" id="4421849">.</span><span class="ident" id="4421850">RawSubject</span><span class="op" id="4421860">,</span>&nbsp;<span class="builtintype" id="4421862">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4421867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4421871">return</span>&nbsp;<span class="ident" id="4421878">asn1</span><span class="op" id="4421882">.</span><span class="ident" id="4421883">Marshal</span><span class="op" id="4421890">(</span><span class="ident" id="4421891">cert</span><span class="op" id="4421895">.</span><span class="ident" id="4421896">Subject</span><span class="op" id="4421903">.</span><span class="ident" id="4421904">ToRDNSequence</span><span class="op" id="4421917">(</span><span class="op" id="4421918">)</span><span class="op" id="4421919">)</span><br>
<span class="lineno"></span><span class="op" id="4421921">}</span><br>
<span class="lineno">1370</span><br>
<span class="lineno"></span><span class="comment" id="4421924">//&nbsp;signingParamsForPrivateKey&nbsp;returns&nbsp;the&nbsp;parameters&nbsp;to&nbsp;use&nbsp;for&nbsp;signing&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="4422001">//&nbsp;priv.&nbsp;If&nbsp;requestedSigAlgo&nbsp;is&nbsp;not&nbsp;zero&nbsp;then&nbsp;it&nbsp;overrides&nbsp;the&nbsp;default</span><br>
<span class="lineno"></span><span class="comment" id="4422072">//&nbsp;signature&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="4422096">func</span>&nbsp;<span class="ident" id="4422101">signingParamsForPrivateKey</span><span class="op" id="4422127">(</span><span class="ident" id="4422128">priv</span>&nbsp;<span class="keyword" id="4422133">interface</span><span class="op" id="4422142">{</span><span class="op" id="4422143">}</span><span class="op" id="4422144">,</span>&nbsp;<span class="ident" id="4422146">requestedSigAlgo</span>&nbsp;<span class="ident" id="4422163">SignatureAlgorithm</span><span class="op" id="4422181">)</span>&nbsp;<span class="op" id="4422183">(</span><span class="ident" id="4422184">hashFunc</span>&nbsp;<span class="ident" id="4422193">crypto</span><span class="op" id="4422199">.</span><span class="ident" id="4422200">Hash</span><span class="op" id="4422204">,</span>&nbsp;<span class="ident" id="4422206">sigAlgo</span>&nbsp;<span class="ident" id="4422214">pkix</span><span class="op" id="4422218">.</span><span class="ident" id="4422219">AlgorithmIdentifier</span><span class="op" id="4422238">,</span>&nbsp;<span class="ident" id="4422240">err</span>&nbsp;<span class="builtintype" id="4422244">error</span><span class="op" id="4422249">)</span>&nbsp;<span class="op" id="4422251">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4422254">var</span>&nbsp;<span class="ident" id="4422258">pubType</span>&nbsp;<span class="ident" id="4422266">PublicKeyAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4422287">switch</span>&nbsp;<span class="ident" id="4422294">priv</span>&nbsp;<span class="op" id="4422299">:=</span>&nbsp;<span class="ident" id="4422302">priv</span><span class="op" id="4422306">.</span><span class="op" id="4422307">(</span><span class="keyword" id="4422308">type</span><span class="op" id="4422312">)</span>&nbsp;<span class="op" id="4422314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4422317">case</span>&nbsp;<span class="op" id="4422322">*</span><span class="ident" id="4422323">rsa</span><span class="op" id="4422326">.</span><span class="ident" id="4422327">PrivateKey</span><span class="op" id="4422337">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4422341">pubType</span>&nbsp;<span class="op" id="4422349">=</span>&nbsp;<span class="ident" id="4422351">RSA</span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4422357">sigAlgo</span><span class="op" id="4422364">.</span><span class="ident" id="4422365">Algorithm</span>&nbsp;<span class="op" id="4422375">=</span>&nbsp;<span class="ident" id="4422377">oidSignatureSHA256WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4422405">hashFunc</span>&nbsp;<span class="op" id="4422414">=</span>&nbsp;<span class="ident" id="4422416">crypto</span><span class="op" id="4422422">.</span><span class="ident" id="4422423">SHA256</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4422432">case</span>&nbsp;<span class="op" id="4422437">*</span><span class="ident" id="4422438">ecdsa</span><span class="op" id="4422443">.</span><span class="ident" id="4422444">PrivateKey</span><span class="op" id="4422454">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4422458">pubType</span>&nbsp;<span class="op" id="4422466">=</span>&nbsp;<span class="ident" id="4422468">ECDSA</span><br>
<span class="lineno">1385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4422477">switch</span>&nbsp;<span class="ident" id="4422484">priv</span><span class="op" id="4422488">.</span><span class="ident" id="4422489">Curve</span>&nbsp;<span class="op" id="4422495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4422499">case</span>&nbsp;<span class="ident" id="4422504">elliptic</span><span class="op" id="4422512">.</span><span class="ident" id="4422513">P224</span><span class="op" id="4422517">(</span><span class="op" id="4422518">)</span><span class="op" id="4422519">,</span>&nbsp;<span class="ident" id="4422521">elliptic</span><span class="op" id="4422529">.</span><span class="ident" id="4422530">P256</span><span class="op" id="4422534">(</span><span class="op" id="4422535">)</span><span class="op" id="4422536">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4422541">hashFunc</span>&nbsp;<span class="op" id="4422550">=</span>&nbsp;<span class="ident" id="4422552">crypto</span><span class="op" id="4422558">.</span><span class="ident" id="4422559">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4422569">sigAlgo</span><span class="op" id="4422576">.</span><span class="ident" id="4422577">Algorithm</span>&nbsp;<span class="op" id="4422587">=</span>&nbsp;<span class="ident" id="4422589">oidSignatureECDSAWithSHA256</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4422619">case</span>&nbsp;<span class="ident" id="4422624">elliptic</span><span class="op" id="4422632">.</span><span class="ident" id="4422633">P384</span><span class="op" id="4422637">(</span><span class="op" id="4422638">)</span><span class="op" id="4422639">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4422644">hashFunc</span>&nbsp;<span class="op" id="4422653">=</span>&nbsp;<span class="ident" id="4422655">crypto</span><span class="op" id="4422661">.</span><span class="ident" id="4422662">SHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4422672">sigAlgo</span><span class="op" id="4422679">.</span><span class="ident" id="4422680">Algorithm</span>&nbsp;<span class="op" id="4422690">=</span>&nbsp;<span class="ident" id="4422692">oidSignatureECDSAWithSHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4422722">case</span>&nbsp;<span class="ident" id="4422727">elliptic</span><span class="op" id="4422735">.</span><span class="ident" id="4422736">P521</span><span class="op" id="4422740">(</span><span class="op" id="4422741">)</span><span class="op" id="4422742">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4422747">hashFunc</span>&nbsp;<span class="op" id="4422756">=</span>&nbsp;<span class="ident" id="4422758">crypto</span><span class="op" id="4422764">.</span><span class="ident" id="4422765">SHA512</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4422775">sigAlgo</span><span class="op" id="4422782">.</span><span class="ident" id="4422783">Algorithm</span>&nbsp;<span class="op" id="4422793">=</span>&nbsp;<span class="ident" id="4422795">oidSignatureECDSAWithSHA512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4422825">default</span><span class="op" id="4422832">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4422837">err</span>&nbsp;<span class="op" id="4422841">=</span>&nbsp;<span class="ident" id="4422843">errors</span><span class="op" id="4422849">.</span><span class="ident" id="4422850">New</span><span class="op" id="4422853">(</span><span class="string" id="4422854">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4422884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4422888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4422892">default</span><span class="op" id="4422899">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4422903">err</span>&nbsp;<span class="op" id="4422907">=</span>&nbsp;<span class="ident" id="4422909">errors</span><span class="op" id="4422915">.</span><span class="ident" id="4422916">New</span><span class="op" id="4422919">(</span><span class="string" id="4422920">&#34;x509:&nbsp;only&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;private&nbsp;keys&nbsp;supported&#34;</span><span class="op" id="4422969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4422972">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4422976">if</span>&nbsp;<span class="ident" id="4422979">err</span>&nbsp;<span class="op" id="4422983">!=</span>&nbsp;<span class="builtintype" id="4422986">nil</span>&nbsp;<span class="op" id="4422990">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4422994">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4423002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4423006">if</span>&nbsp;<span class="ident" id="4423009">requestedSigAlgo</span>&nbsp;<span class="op" id="4423026">==</span>&nbsp;<span class="num" id="4423029">0</span>&nbsp;<span class="op" id="4423031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4423035">return</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4423043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4423047">found</span>&nbsp;<span class="op" id="4423053">:=</span>&nbsp;<span class="builtintype" id="4423056">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4423063">for</span>&nbsp;<span class="ident" id="4423067">_</span><span class="op" id="4423068">,</span>&nbsp;<span class="ident" id="4423070">details</span>&nbsp;<span class="op" id="4423078">:=</span>&nbsp;<span class="keyword" id="4423081">range</span>&nbsp;<span class="ident" id="4423087">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="4423113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4423117">if</span>&nbsp;<span class="ident" id="4423120">details</span><span class="op" id="4423127">.</span><span class="ident" id="4423128">algo</span>&nbsp;<span class="op" id="4423133">==</span>&nbsp;<span class="ident" id="4423136">requestedSigAlgo</span>&nbsp;<span class="op" id="4423153">{</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4423158">if</span>&nbsp;<span class="ident" id="4423161">details</span><span class="op" id="4423168">.</span><span class="ident" id="4423169">pubKeyAlgo</span>&nbsp;<span class="op" id="4423180">!=</span>&nbsp;<span class="ident" id="4423183">pubType</span>&nbsp;<span class="op" id="4423191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4423197">err</span>&nbsp;<span class="op" id="4423201">=</span>&nbsp;<span class="ident" id="4423203">errors</span><span class="op" id="4423209">.</span><span class="ident" id="4423210">New</span><span class="op" id="4423213">(</span><span class="string" id="4423214">&#34;x509:&nbsp;requested&nbsp;SignatureAlgorithm&nbsp;does&nbsp;not&nbsp;match&nbsp;private&nbsp;key&nbsp;type&#34;</span><span class="op" id="4423282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4423288">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4423298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4423303">sigAlgo</span><span class="op" id="4423310">.</span><span class="ident" id="4423311">Algorithm</span><span class="op" id="4423320">,</span>&nbsp;<span class="ident" id="4423322">hashFunc</span>&nbsp;<span class="op" id="4423331">=</span>&nbsp;<span class="ident" id="4423333">details</span><span class="op" id="4423340">.</span><span class="ident" id="4423341">oid</span><span class="op" id="4423344">,</span>&nbsp;<span class="ident" id="4423346">details</span><span class="op" id="4423353">.</span><span class="ident" id="4423354">hash</span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4423362">if</span>&nbsp;<span class="ident" id="4423365">hashFunc</span>&nbsp;<span class="op" id="4423374">==</span>&nbsp;<span class="num" id="4423377">0</span>&nbsp;<span class="op" id="4423379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4423385">err</span>&nbsp;<span class="op" id="4423389">=</span>&nbsp;<span class="ident" id="4423391">errors</span><span class="op" id="4423397">.</span><span class="ident" id="4423398">New</span><span class="op" id="4423401">(</span><span class="string" id="4423402">&#34;x509:&nbsp;cannot&nbsp;sign&nbsp;with&nbsp;hash&nbsp;function&nbsp;requested&#34;</span><span class="op" id="4423450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4423456">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4423466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4423471">found</span>&nbsp;<span class="op" id="4423477">=</span>&nbsp;<span class="builtintype" id="4423479">true</span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4423487">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4423495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4423498">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4423502">if</span>&nbsp;<span class="op" id="4423505">!</span><span class="ident" id="4423506">found</span>&nbsp;<span class="op" id="4423512">{</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4423516">err</span>&nbsp;<span class="op" id="4423520">=</span>&nbsp;<span class="ident" id="4423522">errors</span><span class="op" id="4423528">.</span><span class="ident" id="4423529">New</span><span class="op" id="4423532">(</span><span class="string" id="4423533">&#34;x509:&nbsp;unknown&nbsp;SignatureAlgorithm&#34;</span><span class="op" id="4423567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4423570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4423574">return</span><br>
<span class="lineno"></span><span class="op" id="4423581">}</span><br>
<span class="lineno">1435</span><br>
<span class="lineno"></span><span class="comment" id="4423584">//&nbsp;CreateCertificate&nbsp;creates&nbsp;a&nbsp;new&nbsp;certificate&nbsp;based&nbsp;on&nbsp;a&nbsp;template.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4423656">//&nbsp;following&nbsp;members&nbsp;of&nbsp;template&nbsp;are&nbsp;used:&nbsp;SerialNumber,&nbsp;Subject,&nbsp;NotBefore,</span><br>
<span class="lineno"></span><span class="comment" id="4423733">//&nbsp;NotAfter,&nbsp;KeyUsage,&nbsp;ExtKeyUsage,&nbsp;UnknownExtKeyUsage,&nbsp;BasicConstraintsValid,</span><br>
<span class="lineno"></span><span class="comment" id="4423812">//&nbsp;IsCA,&nbsp;MaxPathLen,&nbsp;SubjectKeyId,&nbsp;DNSNames,&nbsp;PermittedDNSDomainsCritical,</span><br>
<span class="lineno">1440</span><span class="comment" id="4423886">//&nbsp;PermittedDNSDomains,&nbsp;SignatureAlgorithm.</span><br>
<span class="lineno"></span><span class="comment" id="4423930">//</span><br>
<span class="lineno"></span><span class="comment" id="4423933">//&nbsp;The&nbsp;certificate&nbsp;is&nbsp;signed&nbsp;by&nbsp;parent.&nbsp;If&nbsp;parent&nbsp;is&nbsp;equal&nbsp;to&nbsp;template&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4424013">//&nbsp;certificate&nbsp;is&nbsp;self-signed.&nbsp;The&nbsp;parameter&nbsp;pub&nbsp;is&nbsp;the&nbsp;public&nbsp;key&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4424087">//&nbsp;signee&nbsp;and&nbsp;priv&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;of&nbsp;the&nbsp;signer.</span><br>
<span class="lineno">1445</span><span class="comment" id="4424140">//</span><br>
<span class="lineno"></span><span class="comment" id="4424143">//&nbsp;The&nbsp;returned&nbsp;slice&nbsp;is&nbsp;the&nbsp;certificate&nbsp;in&nbsp;DER&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="4424201">//</span><br>
<span class="lineno"></span><span class="comment" id="4424204">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;types&nbsp;are&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;(*rsa.PublicKey&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="4424273">//&nbsp;*ecdsa.PublicKey&nbsp;for&nbsp;pub,&nbsp;*rsa.PrivateKey&nbsp;or&nbsp;*ecdsa.PrivateKey&nbsp;for&nbsp;priv).</span><br>
<span class="lineno">1450</span><span class="keyword" id="4424350">func</span>&nbsp;<span class="ident" id="4424355">CreateCertificate</span><span class="op" id="4424372">(</span><span class="ident" id="4424373">rand</span>&nbsp;<span class="ident" id="4424378">io</span><span class="op" id="4424380">.</span><span class="ident" id="4424381">Reader</span><span class="op" id="4424387">,</span>&nbsp;<span class="ident" id="4424389">template</span><span class="op" id="4424397">,</span>&nbsp;<span class="ident" id="4424399">parent</span>&nbsp;<span class="op" id="4424406">*</span><span class="ident" id="4424407">Certificate</span><span class="op" id="4424418">,</span>&nbsp;<span class="ident" id="4424420">pub</span>&nbsp;<span class="keyword" id="4424424">interface</span><span class="op" id="4424433">{</span><span class="op" id="4424434">}</span><span class="op" id="4424435">,</span>&nbsp;<span class="ident" id="4424437">priv</span>&nbsp;<span class="keyword" id="4424442">interface</span><span class="op" id="4424451">{</span><span class="op" id="4424452">}</span><span class="op" id="4424453">)</span>&nbsp;<span class="op" id="4424455">(</span><span class="ident" id="4424456">cert</span>&nbsp;<span class="op" id="4424461">[</span><span class="op" id="4424462">]</span><span class="builtintype" id="4424463">byte</span><span class="op" id="4424467">,</span>&nbsp;<span class="ident" id="4424469">err</span>&nbsp;<span class="builtintype" id="4424473">error</span><span class="op" id="4424478">)</span>&nbsp;<span class="op" id="4424480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4424483">hashFunc</span><span class="op" id="4424491">,</span>&nbsp;<span class="ident" id="4424493">signatureAlgorithm</span><span class="op" id="4424511">,</span>&nbsp;<span class="ident" id="4424513">err</span>&nbsp;<span class="op" id="4424517">:=</span>&nbsp;<span class="ident" id="4424520">signingParamsForPrivateKey</span><span class="op" id="4424546">(</span><span class="ident" id="4424547">priv</span><span class="op" id="4424551">,</span>&nbsp;<span class="ident" id="4424553">template</span><span class="op" id="4424561">.</span><span class="ident" id="4424562">SignatureAlgorithm</span><span class="op" id="4424580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4424583">if</span>&nbsp;<span class="ident" id="4424586">err</span>&nbsp;<span class="op" id="4424590">!=</span>&nbsp;<span class="builtintype" id="4424593">nil</span>&nbsp;<span class="op" id="4424597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4424601">return</span>&nbsp;<span class="builtintype" id="4424608">nil</span><span class="op" id="4424611">,</span>&nbsp;<span class="ident" id="4424613">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4424618">}</span><br>
<span class="lineno">1455</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4424622">publicKeyBytes</span><span class="op" id="4424636">,</span>&nbsp;<span class="ident" id="4424638">publicKeyAlgorithm</span><span class="op" id="4424656">,</span>&nbsp;<span class="ident" id="4424658">err</span>&nbsp;<span class="op" id="4424662">:=</span>&nbsp;<span class="ident" id="4424665">marshalPublicKey</span><span class="op" id="4424681">(</span><span class="ident" id="4424682">pub</span><span class="op" id="4424685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4424688">if</span>&nbsp;<span class="ident" id="4424691">err</span>&nbsp;<span class="op" id="4424695">!=</span>&nbsp;<span class="builtintype" id="4424698">nil</span>&nbsp;<span class="op" id="4424702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4424706">return</span>&nbsp;<span class="builtintype" id="4424713">nil</span><span class="op" id="4424716">,</span>&nbsp;<span class="ident" id="4424718">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4424723">}</span><br>
<span class="lineno">1460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4424727">if</span>&nbsp;<span class="ident" id="4424730">err</span>&nbsp;<span class="op" id="4424734">!=</span>&nbsp;<span class="builtintype" id="4424737">nil</span>&nbsp;<span class="op" id="4424741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4424745">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4424753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4424757">if</span>&nbsp;<span class="builtinfunc" id="4424760">len</span><span class="op" id="4424763">(</span><span class="ident" id="4424764">parent</span><span class="op" id="4424770">.</span><span class="ident" id="4424771">SubjectKeyId</span><span class="op" id="4424783">)</span>&nbsp;<span class="op" id="4424785">&gt;</span>&nbsp;<span class="num" id="4424787">0</span>&nbsp;<span class="op" id="4424789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4424793">template</span><span class="op" id="4424801">.</span><span class="ident" id="4424802">AuthorityKeyId</span>&nbsp;<span class="op" id="4424817">=</span>&nbsp;<span class="ident" id="4424819">parent</span><span class="op" id="4424825">.</span><span class="ident" id="4424826">SubjectKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4424840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4424844">extensions</span><span class="op" id="4424854">,</span>&nbsp;<span class="ident" id="4424856">err</span>&nbsp;<span class="op" id="4424860">:=</span>&nbsp;<span class="ident" id="4424863">buildExtensions</span><span class="op" id="4424878">(</span><span class="ident" id="4424879">template</span><span class="op" id="4424887">)</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4424890">if</span>&nbsp;<span class="ident" id="4424893">err</span>&nbsp;<span class="op" id="4424897">!=</span>&nbsp;<span class="builtintype" id="4424900">nil</span>&nbsp;<span class="op" id="4424904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4424908">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4424916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4424920">asn1Issuer</span><span class="op" id="4424930">,</span>&nbsp;<span class="ident" id="4424932">err</span>&nbsp;<span class="op" id="4424936">:=</span>&nbsp;<span class="ident" id="4424939">subjectBytes</span><span class="op" id="4424951">(</span><span class="ident" id="4424952">parent</span><span class="op" id="4424958">)</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4424961">if</span>&nbsp;<span class="ident" id="4424964">err</span>&nbsp;<span class="op" id="4424968">!=</span>&nbsp;<span class="builtintype" id="4424971">nil</span>&nbsp;<span class="op" id="4424975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4424979">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4424987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4424991">asn1Subject</span><span class="op" id="4425002">,</span>&nbsp;<span class="ident" id="4425004">err</span>&nbsp;<span class="op" id="4425008">:=</span>&nbsp;<span class="ident" id="4425011">subjectBytes</span><span class="op" id="4425023">(</span><span class="ident" id="4425024">template</span><span class="op" id="4425032">)</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4425035">if</span>&nbsp;<span class="ident" id="4425038">err</span>&nbsp;<span class="op" id="4425042">!=</span>&nbsp;<span class="builtintype" id="4425045">nil</span>&nbsp;<span class="op" id="4425049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4425053">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4425061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425065">encodedPublicKey</span>&nbsp;<span class="op" id="4425082">:=</span>&nbsp;<span class="ident" id="4425085">asn1</span><span class="op" id="4425089">.</span><span class="ident" id="4425090">BitString</span><span class="op" id="4425099">{</span><span class="ident" id="4425100">BitLength</span><span class="op" id="4425109">:</span>&nbsp;<span class="builtinfunc" id="4425111">len</span><span class="op" id="4425114">(</span><span class="ident" id="4425115">publicKeyBytes</span><span class="op" id="4425129">)</span>&nbsp;<span class="op" id="4425131">*</span>&nbsp;<span class="num" id="4425133">8</span><span class="op" id="4425134">,</span>&nbsp;<span class="ident" id="4425136">Bytes</span><span class="op" id="4425141">:</span>&nbsp;<span class="ident" id="4425143">publicKeyBytes</span><span class="op" id="4425157">}</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425160">c</span>&nbsp;<span class="op" id="4425162">:=</span>&nbsp;<span class="ident" id="4425165">tbsCertificate</span><span class="op" id="4425179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425183">Version</span><span class="op" id="4425190">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4425203">2</span><span class="op" id="4425204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425208">SerialNumber</span><span class="op" id="4425220">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425228">template</span><span class="op" id="4425236">.</span><span class="ident" id="4425237">SerialNumber</span><span class="op" id="4425249">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425253">SignatureAlgorithm</span><span class="op" id="4425271">:</span>&nbsp;<span class="ident" id="4425273">signatureAlgorithm</span><span class="op" id="4425291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425295">Issuer</span><span class="op" id="4425301">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425315">asn1</span><span class="op" id="4425319">.</span><span class="ident" id="4425320">RawValue</span><span class="op" id="4425328">{</span><span class="ident" id="4425329">FullBytes</span><span class="op" id="4425338">:</span>&nbsp;<span class="ident" id="4425340">asn1Issuer</span><span class="op" id="4425350">}</span><span class="op" id="4425351">,</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425355">Validity</span><span class="op" id="4425363">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425375">validity</span><span class="op" id="4425383">{</span><span class="ident" id="4425384">template</span><span class="op" id="4425392">.</span><span class="ident" id="4425393">NotBefore</span><span class="op" id="4425402">.</span><span class="ident" id="4425403">UTC</span><span class="op" id="4425406">(</span><span class="op" id="4425407">)</span><span class="op" id="4425408">,</span>&nbsp;<span class="ident" id="4425410">template</span><span class="op" id="4425418">.</span><span class="ident" id="4425419">NotAfter</span><span class="op" id="4425427">.</span><span class="ident" id="4425428">UTC</span><span class="op" id="4425431">(</span><span class="op" id="4425432">)</span><span class="op" id="4425433">}</span><span class="op" id="4425434">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425438">Subject</span><span class="op" id="4425445">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425458">asn1</span><span class="op" id="4425462">.</span><span class="ident" id="4425463">RawValue</span><span class="op" id="4425471">{</span><span class="ident" id="4425472">FullBytes</span><span class="op" id="4425481">:</span>&nbsp;<span class="ident" id="4425483">asn1Subject</span><span class="op" id="4425494">}</span><span class="op" id="4425495">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425499">PublicKey</span><span class="op" id="4425508">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425519">publicKeyInfo</span><span class="op" id="4425532">{</span><span class="builtintype" id="4425533">nil</span><span class="op" id="4425536">,</span>&nbsp;<span class="ident" id="4425538">publicKeyAlgorithm</span><span class="op" id="4425556">,</span>&nbsp;<span class="ident" id="4425558">encodedPublicKey</span><span class="op" id="4425574">}</span><span class="op" id="4425575">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425579">Extensions</span><span class="op" id="4425589">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425599">extensions</span><span class="op" id="4425609">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4425612">}</span><br>
<span class="lineno">1495</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425616">tbsCertContents</span><span class="op" id="4425631">,</span>&nbsp;<span class="ident" id="4425633">err</span>&nbsp;<span class="op" id="4425637">:=</span>&nbsp;<span class="ident" id="4425640">asn1</span><span class="op" id="4425644">.</span><span class="ident" id="4425645">Marshal</span><span class="op" id="4425652">(</span><span class="ident" id="4425653">c</span><span class="op" id="4425654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4425657">if</span>&nbsp;<span class="ident" id="4425660">err</span>&nbsp;<span class="op" id="4425664">!=</span>&nbsp;<span class="builtintype" id="4425667">nil</span>&nbsp;<span class="op" id="4425671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4425675">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4425683">}</span><br>
<span class="lineno">1500</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425687">c</span><span class="op" id="4425688">.</span><span class="ident" id="4425689">Raw</span>&nbsp;<span class="op" id="4425693">=</span>&nbsp;<span class="ident" id="4425695">tbsCertContents</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425713">h</span>&nbsp;<span class="op" id="4425715">:=</span>&nbsp;<span class="ident" id="4425718">hashFunc</span><span class="op" id="4425726">.</span><span class="ident" id="4425727">New</span><span class="op" id="4425730">(</span><span class="op" id="4425731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425734">h</span><span class="op" id="4425735">.</span><span class="ident" id="4425736">Write</span><span class="op" id="4425741">(</span><span class="ident" id="4425742">tbsCertContents</span><span class="op" id="4425757">)</span><br>
<span class="lineno">1505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425760">digest</span>&nbsp;<span class="op" id="4425767">:=</span>&nbsp;<span class="ident" id="4425770">h</span><span class="op" id="4425771">.</span><span class="ident" id="4425772">Sum</span><span class="op" id="4425775">(</span><span class="builtintype" id="4425776">nil</span><span class="op" id="4425779">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4425783">var</span>&nbsp;<span class="ident" id="4425787">signature</span>&nbsp;<span class="op" id="4425797">[</span><span class="op" id="4425798">]</span><span class="builtintype" id="4425799">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4425806">switch</span>&nbsp;<span class="ident" id="4425813">priv</span>&nbsp;<span class="op" id="4425818">:=</span>&nbsp;<span class="ident" id="4425821">priv</span><span class="op" id="4425825">.</span><span class="op" id="4425826">(</span><span class="keyword" id="4425827">type</span><span class="op" id="4425831">)</span>&nbsp;<span class="op" id="4425833">{</span><br>
<span class="lineno">1510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4425836">case</span>&nbsp;<span class="op" id="4425841">*</span><span class="ident" id="4425842">rsa</span><span class="op" id="4425845">.</span><span class="ident" id="4425846">PrivateKey</span><span class="op" id="4425856">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4425860">signature</span><span class="op" id="4425869">,</span>&nbsp;<span class="ident" id="4425871">err</span>&nbsp;<span class="op" id="4425875">=</span>&nbsp;<span class="ident" id="4425877">rsa</span><span class="op" id="4425880">.</span><span class="ident" id="4425881">SignPKCS1v15</span><span class="op" id="4425893">(</span><span class="ident" id="4425894">rand</span><span class="op" id="4425898">,</span>&nbsp;<span class="ident" id="4425900">priv</span><span class="op" id="4425904">,</span>&nbsp;<span class="ident" id="4425906">hashFunc</span><span class="op" id="4425914">,</span>&nbsp;<span class="ident" id="4425916">digest</span><span class="op" id="4425922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4425925">case</span>&nbsp;<span class="op" id="4425930">*</span><span class="ident" id="4425931">ecdsa</span><span class="op" id="4425936">.</span><span class="ident" id="4425937">PrivateKey</span><span class="op" id="4425947">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4425951">var</span>&nbsp;<span class="ident" id="4425955">r</span><span class="op" id="4425956">,</span>&nbsp;<span class="ident" id="4425958">s</span>&nbsp;<span class="op" id="4425960">*</span><span class="ident" id="4425961">big</span><span class="op" id="4425964">.</span><span class="ident" id="4425965">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4425971">if</span>&nbsp;<span class="ident" id="4425974">r</span><span class="op" id="4425975">,</span>&nbsp;<span class="ident" id="4425977">s</span><span class="op" id="4425978">,</span>&nbsp;<span class="ident" id="4425980">err</span>&nbsp;<span class="op" id="4425984">=</span>&nbsp;<span class="ident" id="4425986">ecdsa</span><span class="op" id="4425991">.</span><span class="ident" id="4425992">Sign</span><span class="op" id="4425996">(</span><span class="ident" id="4425997">rand</span><span class="op" id="4426001">,</span>&nbsp;<span class="ident" id="4426003">priv</span><span class="op" id="4426007">,</span>&nbsp;<span class="ident" id="4426009">digest</span><span class="op" id="4426015">)</span><span class="op" id="4426016">;</span>&nbsp;<span class="ident" id="4426018">err</span>&nbsp;<span class="op" id="4426022">==</span>&nbsp;<span class="builtintype" id="4426025">nil</span>&nbsp;<span class="op" id="4426029">{</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426034">signature</span><span class="op" id="4426043">,</span>&nbsp;<span class="ident" id="4426045">err</span>&nbsp;<span class="op" id="4426049">=</span>&nbsp;<span class="ident" id="4426051">asn1</span><span class="op" id="4426055">.</span><span class="ident" id="4426056">Marshal</span><span class="op" id="4426063">(</span><span class="ident" id="4426064">ecdsaSignature</span><span class="op" id="4426078">{</span><span class="ident" id="4426079">r</span><span class="op" id="4426080">,</span>&nbsp;<span class="ident" id="4426082">s</span><span class="op" id="4426083">}</span><span class="op" id="4426084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4426088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4426091">default</span><span class="op" id="4426098">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4426102">panic</span><span class="op" id="4426107">(</span><span class="string" id="4426108">&#34;internal&nbsp;error&#34;</span><span class="op" id="4426124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4426127">}</span><br>
<span class="lineno">1520</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4426131">if</span>&nbsp;<span class="ident" id="4426134">err</span>&nbsp;<span class="op" id="4426138">!=</span>&nbsp;<span class="builtintype" id="4426141">nil</span>&nbsp;<span class="op" id="4426145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4426149">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4426157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426161">cert</span><span class="op" id="4426165">,</span>&nbsp;<span class="ident" id="4426167">err</span>&nbsp;<span class="op" id="4426171">=</span>&nbsp;<span class="ident" id="4426173">asn1</span><span class="op" id="4426177">.</span><span class="ident" id="4426178">Marshal</span><span class="op" id="4426185">(</span><span class="ident" id="4426186">certificate</span><span class="op" id="4426197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4426201">nil</span><span class="op" id="4426204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426208">c</span><span class="op" id="4426209">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426213">signatureAlgorithm</span><span class="op" id="4426231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426235">asn1</span><span class="op" id="4426239">.</span><span class="ident" id="4426240">BitString</span><span class="op" id="4426249">{</span><span class="ident" id="4426250">Bytes</span><span class="op" id="4426255">:</span>&nbsp;<span class="ident" id="4426257">signature</span><span class="op" id="4426266">,</span>&nbsp;<span class="ident" id="4426268">BitLength</span><span class="op" id="4426277">:</span>&nbsp;<span class="builtinfunc" id="4426279">len</span><span class="op" id="4426282">(</span><span class="ident" id="4426283">signature</span><span class="op" id="4426292">)</span>&nbsp;<span class="op" id="4426294">*</span>&nbsp;<span class="num" id="4426296">8</span><span class="op" id="4426297">}</span><span class="op" id="4426298">,</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4426301">}</span><span class="op" id="4426302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4426305">return</span><br>
<span class="lineno"></span><span class="op" id="4426312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4426315">//&nbsp;pemCRLPrefix&nbsp;is&nbsp;the&nbsp;magic&nbsp;string&nbsp;that&nbsp;indicates&nbsp;that&nbsp;we&nbsp;have&nbsp;a&nbsp;PEM&nbsp;encoded</span><br>
<span class="lineno">1535</span><span class="comment" id="4426393">//&nbsp;CRL.</span><br>
<span class="lineno"></span><span class="keyword" id="4426401">var</span>&nbsp;<span class="ident" id="4426405">pemCRLPrefix</span>&nbsp;<span class="op" id="4426418">=</span>&nbsp;<span class="op" id="4426420">[</span><span class="op" id="4426421">]</span><span class="builtintype" id="4426422">byte</span><span class="op" id="4426426">(</span><span class="string" id="4426427">&#34;-----BEGIN&nbsp;X509&nbsp;CRL&#34;</span><span class="op" id="4426448">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4426451">//&nbsp;pemType&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;PEM&nbsp;encoded&nbsp;CRL.</span><br>
<span class="lineno"></span><span class="keyword" id="4426496">var</span>&nbsp;<span class="ident" id="4426500">pemType</span>&nbsp;<span class="op" id="4426508">=</span>&nbsp;<span class="string" id="4426510">&#34;X509&nbsp;CRL&#34;</span><br>
<span class="lineno">1540</span><br>
<span class="lineno"></span><span class="comment" id="4426522">//&nbsp;ParseCRL&nbsp;parses&nbsp;a&nbsp;CRL&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes.&nbsp;It&#39;s&nbsp;often&nbsp;the&nbsp;case&nbsp;that&nbsp;PEM</span><br>
<span class="lineno"></span><span class="comment" id="4426598">//&nbsp;encoded&nbsp;CRLs&nbsp;will&nbsp;appear&nbsp;where&nbsp;they&nbsp;should&nbsp;be&nbsp;DER&nbsp;encoded,&nbsp;so&nbsp;this&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="4426677">//&nbsp;will&nbsp;transparently&nbsp;handle&nbsp;PEM&nbsp;encoding&nbsp;as&nbsp;long&nbsp;as&nbsp;there&nbsp;isn&#39;t&nbsp;any&nbsp;leading</span><br>
<span class="lineno"></span><span class="comment" id="4426754">//&nbsp;garbage.</span><br>
<span class="lineno">1545</span><span class="keyword" id="4426766">func</span>&nbsp;<span class="ident" id="4426771">ParseCRL</span><span class="op" id="4426779">(</span><span class="ident" id="4426780">crlBytes</span>&nbsp;<span class="op" id="4426789">[</span><span class="op" id="4426790">]</span><span class="builtintype" id="4426791">byte</span><span class="op" id="4426795">)</span>&nbsp;<span class="op" id="4426797">(</span><span class="ident" id="4426798">certList</span>&nbsp;<span class="op" id="4426807">*</span><span class="ident" id="4426808">pkix</span><span class="op" id="4426812">.</span><span class="ident" id="4426813">CertificateList</span><span class="op" id="4426828">,</span>&nbsp;<span class="ident" id="4426830">err</span>&nbsp;<span class="builtintype" id="4426834">error</span><span class="op" id="4426839">)</span>&nbsp;<span class="op" id="4426841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4426844">if</span>&nbsp;<span class="ident" id="4426847">bytes</span><span class="op" id="4426852">.</span><span class="ident" id="4426853">HasPrefix</span><span class="op" id="4426862">(</span><span class="ident" id="4426863">crlBytes</span><span class="op" id="4426871">,</span>&nbsp;<span class="ident" id="4426873">pemCRLPrefix</span><span class="op" id="4426885">)</span>&nbsp;<span class="op" id="4426887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426891">block</span><span class="op" id="4426896">,</span>&nbsp;<span class="ident" id="4426898">_</span>&nbsp;<span class="op" id="4426900">:=</span>&nbsp;<span class="ident" id="4426903">pem</span><span class="op" id="4426906">.</span><span class="ident" id="4426907">Decode</span><span class="op" id="4426913">(</span><span class="ident" id="4426914">crlBytes</span><span class="op" id="4426922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4426926">if</span>&nbsp;<span class="ident" id="4426929">block</span>&nbsp;<span class="op" id="4426935">!=</span>&nbsp;<span class="builtintype" id="4426938">nil</span>&nbsp;<span class="op" id="4426942">&amp;&amp;</span>&nbsp;<span class="ident" id="4426945">block</span><span class="op" id="4426950">.</span><span class="ident" id="4426951">Type</span>&nbsp;<span class="op" id="4426956">==</span>&nbsp;<span class="ident" id="4426959">pemType</span>&nbsp;<span class="op" id="4426967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426972">crlBytes</span>&nbsp;<span class="op" id="4426981">=</span>&nbsp;<span class="ident" id="4426983">block</span><span class="op" id="4426988">.</span><span class="ident" id="4426989">Bytes</span><br>
<span class="lineno">1550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4426997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4427000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4427003">return</span>&nbsp;<span class="ident" id="4427010">ParseDERCRL</span><span class="op" id="4427021">(</span><span class="ident" id="4427022">crlBytes</span><span class="op" id="4427030">)</span><br>
<span class="lineno"></span><span class="op" id="4427032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1555</span><span class="comment" id="4427035">//&nbsp;ParseDERCRL&nbsp;parses&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;CRL&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4427097">func</span>&nbsp;<span class="ident" id="4427102">ParseDERCRL</span><span class="op" id="4427113">(</span><span class="ident" id="4427114">derBytes</span>&nbsp;<span class="op" id="4427123">[</span><span class="op" id="4427124">]</span><span class="builtintype" id="4427125">byte</span><span class="op" id="4427129">)</span>&nbsp;<span class="op" id="4427131">(</span><span class="ident" id="4427132">certList</span>&nbsp;<span class="op" id="4427141">*</span><span class="ident" id="4427142">pkix</span><span class="op" id="4427146">.</span><span class="ident" id="4427147">CertificateList</span><span class="op" id="4427162">,</span>&nbsp;<span class="ident" id="4427164">err</span>&nbsp;<span class="builtintype" id="4427168">error</span><span class="op" id="4427173">)</span>&nbsp;<span class="op" id="4427175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4427178">certList</span>&nbsp;<span class="op" id="4427187">=</span>&nbsp;<span class="builtinfunc" id="4427189">new</span><span class="op" id="4427192">(</span><span class="ident" id="4427193">pkix</span><span class="op" id="4427197">.</span><span class="ident" id="4427198">CertificateList</span><span class="op" id="4427213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4427216">_</span><span class="op" id="4427217">,</span>&nbsp;<span class="ident" id="4427219">err</span>&nbsp;<span class="op" id="4427223">=</span>&nbsp;<span class="ident" id="4427225">asn1</span><span class="op" id="4427229">.</span><span class="ident" id="4427230">Unmarshal</span><span class="op" id="4427239">(</span><span class="ident" id="4427240">derBytes</span><span class="op" id="4427248">,</span>&nbsp;<span class="ident" id="4427250">certList</span><span class="op" id="4427258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4427261">if</span>&nbsp;<span class="ident" id="4427264">err</span>&nbsp;<span class="op" id="4427268">!=</span>&nbsp;<span class="builtintype" id="4427271">nil</span>&nbsp;<span class="op" id="4427275">{</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4427279">certList</span>&nbsp;<span class="op" id="4427288">=</span>&nbsp;<span class="builtintype" id="4427290">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4427295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4427298">return</span><br>
<span class="lineno"></span><span class="op" id="4427305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1565</span><span class="comment" id="4427308">//&nbsp;CreateCRL&nbsp;returns&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;CRL,&nbsp;signed&nbsp;by&nbsp;this&nbsp;Certificate,&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4427381">//&nbsp;contains&nbsp;the&nbsp;given&nbsp;list&nbsp;of&nbsp;revoked&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="comment" id="4427433">//</span><br>
<span class="lineno"></span><span class="comment" id="4427436">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;type&nbsp;is&nbsp;RSA&nbsp;(*rsa.PrivateKey&nbsp;for&nbsp;priv).</span><br>
<span class="lineno"></span><span class="keyword" id="4427502">func</span>&nbsp;<span class="op" id="4427507">(</span><span class="ident" id="4427508">c</span>&nbsp;<span class="op" id="4427510">*</span><span class="ident" id="4427511">Certificate</span><span class="op" id="4427522">)</span>&nbsp;<span class="ident" id="4427524">CreateCRL</span><span class="op" id="4427533">(</span><span class="ident" id="4427534">rand</span>&nbsp;<span class="ident" id="4427539">io</span><span class="op" id="4427541">.</span><span class="ident" id="4427542">Reader</span><span class="op" id="4427548">,</span>&nbsp;<span class="ident" id="4427550">priv</span>&nbsp;<span class="keyword" id="4427555">interface</span><span class="op" id="4427564">{</span><span class="op" id="4427565">}</span><span class="op" id="4427566">,</span>&nbsp;<span class="ident" id="4427568">revokedCerts</span>&nbsp;<span class="op" id="4427581">[</span><span class="op" id="4427582">]</span><span class="ident" id="4427583">pkix</span><span class="op" id="4427587">.</span><span class="ident" id="4427588">RevokedCertificate</span><span class="op" id="4427606">,</span>&nbsp;<span class="ident" id="4427608">now</span><span class="op" id="4427611">,</span>&nbsp;<span class="ident" id="4427613">expiry</span>&nbsp;<span class="ident" id="4427620">time</span><span class="op" id="4427624">.</span><span class="ident" id="4427625">Time</span><span class="op" id="4427629">)</span>&nbsp;<span class="op" id="4427631">(</span><span class="ident" id="4427632">crlBytes</span>&nbsp;<span class="op" id="4427641">[</span><span class="op" id="4427642">]</span><span class="builtintype" id="4427643">byte</span><span class="op" id="4427647">,</span>&nbsp;<span class="ident" id="4427649">err</span>&nbsp;<span class="builtintype" id="4427653">error</span><span class="op" id="4427658">)</span>&nbsp;<span class="op" id="4427660">{</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4427663">rsaPriv</span><span class="op" id="4427670">,</span>&nbsp;<span class="ident" id="4427672">ok</span>&nbsp;<span class="op" id="4427675">:=</span>&nbsp;<span class="ident" id="4427678">priv</span><span class="op" id="4427682">.</span><span class="op" id="4427683">(</span><span class="op" id="4427684">*</span><span class="ident" id="4427685">rsa</span><span class="op" id="4427688">.</span><span class="ident" id="4427689">PrivateKey</span><span class="op" id="4427699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4427702">if</span>&nbsp;<span class="op" id="4427705">!</span><span class="ident" id="4427706">ok</span>&nbsp;<span class="op" id="4427709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4427713">return</span>&nbsp;<span class="builtintype" id="4427720">nil</span><span class="op" id="4427723">,</span>&nbsp;<span class="ident" id="4427725">errors</span><span class="op" id="4427731">.</span><span class="ident" id="4427732">New</span><span class="op" id="4427735">(</span><span class="string" id="4427736">&#34;x509:&nbsp;non-RSA&nbsp;private&nbsp;keys&nbsp;not&nbsp;supported&#34;</span><span class="op" id="4427778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4427781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4427784">tbsCertList</span>&nbsp;<span class="op" id="4427796">:=</span>&nbsp;<span class="ident" id="4427799">pkix</span><span class="op" id="4427803">.</span><span class="ident" id="4427804">TBSCertificateList</span><span class="op" id="4427822">{</span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4427826">Version</span><span class="op" id="4427833">:</span>&nbsp;<span class="num" id="4427835">2</span><span class="op" id="4427836">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4427840">Signature</span><span class="op" id="4427849">:</span>&nbsp;<span class="ident" id="4427851">pkix</span><span class="op" id="4427855">.</span><span class="ident" id="4427856">AlgorithmIdentifier</span><span class="op" id="4427875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4427880">Algorithm</span><span class="op" id="4427889">:</span>&nbsp;<span class="ident" id="4427891">oidSignatureSHA1WithRSA</span><span class="op" id="4427914">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4427918">}</span><span class="op" id="4427919">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4427923">Issuer</span><span class="op" id="4427929">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4427944">c</span><span class="op" id="4427945">.</span><span class="ident" id="4427946">Subject</span><span class="op" id="4427953">.</span><span class="ident" id="4427954">ToRDNSequence</span><span class="op" id="4427967">(</span><span class="op" id="4427968">)</span><span class="op" id="4427969">,</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4427973">ThisUpdate</span><span class="op" id="4427983">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4427994">now</span><span class="op" id="4427997">.</span><span class="ident" id="4427998">UTC</span><span class="op" id="4428001">(</span><span class="op" id="4428002">)</span><span class="op" id="4428003">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4428007">NextUpdate</span><span class="op" id="4428017">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4428028">expiry</span><span class="op" id="4428034">.</span><span class="ident" id="4428035">UTC</span><span class="op" id="4428038">(</span><span class="op" id="4428039">)</span><span class="op" id="4428040">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4428044">RevokedCertificates</span><span class="op" id="4428063">:</span>&nbsp;<span class="ident" id="4428065">revokedCerts</span><span class="op" id="4428077">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4428080">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4428084">tbsCertListContents</span><span class="op" id="4428103">,</span>&nbsp;<span class="ident" id="4428105">err</span>&nbsp;<span class="op" id="4428109">:=</span>&nbsp;<span class="ident" id="4428112">asn1</span><span class="op" id="4428116">.</span><span class="ident" id="4428117">Marshal</span><span class="op" id="4428124">(</span><span class="ident" id="4428125">tbsCertList</span><span class="op" id="4428136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4428139">if</span>&nbsp;<span class="ident" id="4428142">err</span>&nbsp;<span class="op" id="4428146">!=</span>&nbsp;<span class="builtintype" id="4428149">nil</span>&nbsp;<span class="op" id="4428153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4428157">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4428165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4428169">h</span>&nbsp;<span class="op" id="4428171">:=</span>&nbsp;<span class="ident" id="4428174">sha1</span><span class="op" id="4428178">.</span><span class="ident" id="4428179">New</span><span class="op" id="4428182">(</span><span class="op" id="4428183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4428186">h</span><span class="op" id="4428187">.</span><span class="ident" id="4428188">Write</span><span class="op" id="4428193">(</span><span class="ident" id="4428194">tbsCertListContents</span><span class="op" id="4428213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4428216">digest</span>&nbsp;<span class="op" id="4428223">:=</span>&nbsp;<span class="ident" id="4428226">h</span><span class="op" id="4428227">.</span><span class="ident" id="4428228">Sum</span><span class="op" id="4428231">(</span><span class="builtintype" id="4428232">nil</span><span class="op" id="4428235">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4428239">signature</span><span class="op" id="4428248">,</span>&nbsp;<span class="ident" id="4428250">err</span>&nbsp;<span class="op" id="4428254">:=</span>&nbsp;<span class="ident" id="4428257">rsa</span><span class="op" id="4428260">.</span><span class="ident" id="4428261">SignPKCS1v15</span><span class="op" id="4428273">(</span><span class="ident" id="4428274">rand</span><span class="op" id="4428278">,</span>&nbsp;<span class="ident" id="4428280">rsaPriv</span><span class="op" id="4428287">,</span>&nbsp;<span class="ident" id="4428289">crypto</span><span class="op" id="4428295">.</span><span class="ident" id="4428296">SHA1</span><span class="op" id="4428300">,</span>&nbsp;<span class="ident" id="4428302">digest</span><span class="op" id="4428308">)</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4428311">if</span>&nbsp;<span class="ident" id="4428314">err</span>&nbsp;<span class="op" id="4428318">!=</span>&nbsp;<span class="builtintype" id="4428321">nil</span>&nbsp;<span class="op" id="4428325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4428329">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4428337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4428341">return</span>&nbsp;<span class="ident" id="4428348">asn1</span><span class="op" id="4428352">.</span><span class="ident" id="4428353">Marshal</span><span class="op" id="4428360">(</span><span class="ident" id="4428361">pkix</span><span class="op" id="4428365">.</span><span class="ident" id="4428366">CertificateList</span><span class="op" id="4428381">{</span><br>
<span class="lineno">1600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4428385">TBSCertList</span><span class="op" id="4428396">:</span>&nbsp;<span class="ident" id="4428398">tbsCertList</span><span class="op" id="4428409">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4428413">SignatureAlgorithm</span><span class="op" id="4428431">:</span>&nbsp;<span class="ident" id="4428433">pkix</span><span class="op" id="4428437">.</span><span class="ident" id="4428438">AlgorithmIdentifier</span><span class="op" id="4428457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4428462">Algorithm</span><span class="op" id="4428471">:</span>&nbsp;<span class="ident" id="4428473">oidSignatureSHA1WithRSA</span><span class="op" id="4428496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4428500">}</span><span class="op" id="4428501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4428505">SignatureValue</span><span class="op" id="4428519">:</span>&nbsp;<span class="ident" id="4428521">asn1</span><span class="op" id="4428525">.</span><span class="ident" id="4428526">BitString</span><span class="op" id="4428535">{</span><span class="ident" id="4428536">Bytes</span><span class="op" id="4428541">:</span>&nbsp;<span class="ident" id="4428543">signature</span><span class="op" id="4428552">,</span>&nbsp;<span class="ident" id="4428554">BitLength</span><span class="op" id="4428563">:</span>&nbsp;<span class="builtinfunc" id="4428565">len</span><span class="op" id="4428568">(</span><span class="ident" id="4428569">signature</span><span class="op" id="4428578">)</span>&nbsp;<span class="op" id="4428580">*</span>&nbsp;<span class="num" id="4428582">8</span><span class="op" id="4428583">}</span><span class="op" id="4428584">,</span><br>
<span class="lineno">1605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4428587">}</span><span class="op" id="4428588">)</span><br>
<span class="lineno"></span><span class="op" id="4428590">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4428593">//&nbsp;CertificateRequest&nbsp;represents&nbsp;a&nbsp;PKCS&nbsp;#10,&nbsp;certificate&nbsp;signature&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="4428669">type</span>&nbsp;<span class="ident" id="4428674">CertificateRequest</span>&nbsp;<span class="keyword" id="4428693">struct</span>&nbsp;<span class="op" id="4428700">{</span><br>
<span class="lineno">1610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4428703">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4428728">[</span><span class="op" id="4428729">]</span><span class="builtintype" id="4428730">byte</span>&nbsp;<span class="comment" id="4428735">//&nbsp;Complete&nbsp;ASN.1&nbsp;DER&nbsp;content&nbsp;(CSR,&nbsp;signature&nbsp;algorithm&nbsp;and&nbsp;signature).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4428808">RawTBSCertificateRequest</span>&nbsp;<span class="op" id="4428833">[</span><span class="op" id="4428834">]</span><span class="builtintype" id="4428835">byte</span>&nbsp;<span class="comment" id="4428840">//&nbsp;Certificate&nbsp;request&nbsp;info&nbsp;part&nbsp;of&nbsp;raw&nbsp;ASN.1&nbsp;DER&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4428900">RawSubjectPublicKeyInfo</span>&nbsp;&nbsp;<span class="op" id="4428925">[</span><span class="op" id="4428926">]</span><span class="builtintype" id="4428927">byte</span>&nbsp;<span class="comment" id="4428932">//&nbsp;DER&nbsp;encoded&nbsp;SubjectPublicKeyInfo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4428970">RawSubject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4428995">[</span><span class="op" id="4428996">]</span><span class="builtintype" id="4428997">byte</span>&nbsp;<span class="comment" id="4429002">//&nbsp;DER&nbsp;encoded&nbsp;Subject.</span><br>
<span class="lineno"></span><br>
<span class="lineno">1615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429028">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4429047">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429052">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4429071">[</span><span class="op" id="4429072">]</span><span class="builtintype" id="4429073">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429079">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4429098">SignatureAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429119">PublicKeyAlgorithm</span>&nbsp;<span class="ident" id="4429138">PublicKeyAlgorithm</span><br>
<span class="lineno">1620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429158">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4429177">interface</span><span class="op" id="4429186">{</span><span class="op" id="4429187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429191">Subject</span>&nbsp;<span class="ident" id="4429199">pkix</span><span class="op" id="4429203">.</span><span class="ident" id="4429204">Name</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4429211">//&nbsp;Attributes&nbsp;is&nbsp;a&nbsp;collection&nbsp;of&nbsp;attributes&nbsp;providing</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4429266">//&nbsp;additional&nbsp;information&nbsp;about&nbsp;the&nbsp;subject&nbsp;of&nbsp;the&nbsp;certificate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4429331">//&nbsp;See&nbsp;RFC&nbsp;2986&nbsp;section&nbsp;4.1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429361">Attributes</span>&nbsp;<span class="op" id="4429372">[</span><span class="op" id="4429373">]</span><span class="ident" id="4429374">pkix</span><span class="op" id="4429378">.</span><span class="ident" id="4429379">AttributeTypeAndValueSET</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4429406">//&nbsp;Extensions&nbsp;contains&nbsp;raw&nbsp;X.509&nbsp;extensions.&nbsp;When&nbsp;parsing&nbsp;CSRs,&nbsp;this</span><br>
<span class="lineno">1630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4429476">//&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;extensions&nbsp;that&nbsp;are&nbsp;not&nbsp;parsed&nbsp;by&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4429542">//&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429555">Extensions</span>&nbsp;<span class="op" id="4429566">[</span><span class="op" id="4429567">]</span><span class="ident" id="4429568">pkix</span><span class="op" id="4429572">.</span><span class="ident" id="4429573">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4429585">//&nbsp;ExtraExtensions&nbsp;contains&nbsp;extensions&nbsp;to&nbsp;be&nbsp;copied,&nbsp;raw,&nbsp;into&nbsp;any</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4429653">//&nbsp;marshaled&nbsp;CSR.&nbsp;Values&nbsp;override&nbsp;any&nbsp;extensions&nbsp;that&nbsp;would&nbsp;otherwise</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4429724">//&nbsp;be&nbsp;produced&nbsp;based&nbsp;on&nbsp;the&nbsp;other&nbsp;fields&nbsp;but&nbsp;are&nbsp;overridden&nbsp;by&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4429792">//&nbsp;extensions&nbsp;specified&nbsp;in&nbsp;Attributes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4429832">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4429836">//&nbsp;The&nbsp;ExtraExtensions&nbsp;field&nbsp;is&nbsp;not&nbsp;populated&nbsp;when&nbsp;parsing&nbsp;CSRs,&nbsp;see</span><br>
<span class="lineno">1640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4429906">//&nbsp;Extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429922">ExtraExtensions</span>&nbsp;<span class="op" id="4429938">[</span><span class="op" id="4429939">]</span><span class="ident" id="4429940">pkix</span><span class="op" id="4429944">.</span><span class="ident" id="4429945">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4429957">//&nbsp;Subject&nbsp;Alternate&nbsp;Name&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429992">DNSNames</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4430007">[</span><span class="op" id="4430008">]</span><span class="builtintype" id="4430009">string</span><br>
<span class="lineno">1645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4430017">EmailAddresses</span>&nbsp;<span class="op" id="4430032">[</span><span class="op" id="4430033">]</span><span class="builtintype" id="4430034">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4430042">IPAddresses</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4430057">[</span><span class="op" id="4430058">]</span><span class="ident" id="4430059">net</span><span class="op" id="4430062">.</span><span class="ident" id="4430063">IP</span><br>
<span class="lineno"></span><span class="op" id="4430066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4430069">//&nbsp;These&nbsp;structures&nbsp;reflect&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;X.509&nbsp;certificate</span><br>
<span class="lineno">1650</span><span class="comment" id="4430138">//&nbsp;signature&nbsp;requests&nbsp;(see&nbsp;RFC&nbsp;2986):</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4430177">type</span>&nbsp;<span class="ident" id="4430182">tbsCertificateRequest</span>&nbsp;<span class="keyword" id="4430204">struct</span>&nbsp;<span class="op" id="4430211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4430214">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4430225">asn1</span><span class="op" id="4430229">.</span><span class="ident" id="4430230">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4430242">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4430253">int</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4430258">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4430269">asn1</span><span class="op" id="4430273">.</span><span class="ident" id="4430274">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4430284">PublicKey</span>&nbsp;&nbsp;<span class="ident" id="4430295">publicKeyInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4430310">Attributes</span>&nbsp;<span class="op" id="4430321">[</span><span class="op" id="4430322">]</span><span class="ident" id="4430323">pkix</span><span class="op" id="4430327">.</span><span class="ident" id="4430328">AttributeTypeAndValueSET</span>&nbsp;<span class="string" id="4430353">`asn1:&#34;tag:0&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4430368">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1660</span><span class="keyword" id="4430371">type</span>&nbsp;<span class="ident" id="4430376">certificateRequest</span>&nbsp;<span class="keyword" id="4430395">struct</span>&nbsp;<span class="op" id="4430402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4430405">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4430424">asn1</span><span class="op" id="4430428">.</span><span class="ident" id="4430429">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4430441">TBSCSR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4430460">tbsCertificateRequest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4430483">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4430502">pkix</span><span class="op" id="4430506">.</span><span class="ident" id="4430507">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4430528">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4430547">asn1</span><span class="op" id="4430551">.</span><span class="ident" id="4430552">BitString</span><br>
<span class="lineno">1665</span><span class="op" id="4430562">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4430565">//&nbsp;oidExtensionRequest&nbsp;is&nbsp;a&nbsp;PKCS#9&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;that&nbsp;indicates&nbsp;requested</span><br>
<span class="lineno"></span><span class="comment" id="4430643">//&nbsp;extensions&nbsp;in&nbsp;a&nbsp;CSR.</span><br>
<span class="lineno"></span><span class="keyword" id="4430667">var</span>&nbsp;<span class="ident" id="4430671">oidExtensionRequest</span>&nbsp;<span class="op" id="4430691">=</span>&nbsp;<span class="ident" id="4430693">asn1</span><span class="op" id="4430697">.</span><span class="ident" id="4430698">ObjectIdentifier</span><span class="op" id="4430714">{</span><span class="num" id="4430715">1</span><span class="op" id="4430716">,</span>&nbsp;<span class="num" id="4430718">2</span><span class="op" id="4430719">,</span>&nbsp;<span class="num" id="4430721">840</span><span class="op" id="4430724">,</span>&nbsp;<span class="num" id="4430726">113549</span><span class="op" id="4430732">,</span>&nbsp;<span class="num" id="4430734">1</span><span class="op" id="4430735">,</span>&nbsp;<span class="num" id="4430737">9</span><span class="op" id="4430738">,</span>&nbsp;<span class="num" id="4430740">14</span><span class="op" id="4430742">}</span><br>
<span class="lineno">1670</span><br>
<span class="lineno"></span><span class="comment" id="4430745">//&nbsp;CreateCertificateRequest&nbsp;creates&nbsp;a&nbsp;new&nbsp;certificate&nbsp;based&nbsp;on&nbsp;a&nbsp;template.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4430824">//&nbsp;following&nbsp;members&nbsp;of&nbsp;template&nbsp;are&nbsp;used:&nbsp;Subject,&nbsp;Attributes,</span><br>
<span class="lineno"></span><span class="comment" id="4430888">//&nbsp;SignatureAlgorithm,&nbsp;Extensions,&nbsp;DNSNames,&nbsp;EmailAddresses,&nbsp;and&nbsp;IPAddresses.</span><br>
<span class="lineno"></span><span class="comment" id="4430966">//&nbsp;The&nbsp;private&nbsp;key&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;of&nbsp;the&nbsp;signer.</span><br>
<span class="lineno">1675</span><span class="comment" id="4431019">//</span><br>
<span class="lineno"></span><span class="comment" id="4431022">//&nbsp;The&nbsp;returned&nbsp;slice&nbsp;is&nbsp;the&nbsp;certificate&nbsp;request&nbsp;in&nbsp;DER&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="4431088">//</span><br>
<span class="lineno"></span><span class="comment" id="4431091">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;types&nbsp;are&nbsp;RSA&nbsp;(*rsa.PrivateKey)&nbsp;and&nbsp;ECDSA</span><br>
<span class="lineno"></span><span class="comment" id="4431159">//&nbsp;(*ecdsa.PrivateKey).</span><br>
<span class="lineno">1680</span><span class="keyword" id="4431183">func</span>&nbsp;<span class="ident" id="4431188">CreateCertificateRequest</span><span class="op" id="4431212">(</span><span class="ident" id="4431213">rand</span>&nbsp;<span class="ident" id="4431218">io</span><span class="op" id="4431220">.</span><span class="ident" id="4431221">Reader</span><span class="op" id="4431227">,</span>&nbsp;<span class="ident" id="4431229">template</span>&nbsp;<span class="op" id="4431238">*</span><span class="ident" id="4431239">CertificateRequest</span><span class="op" id="4431257">,</span>&nbsp;<span class="ident" id="4431259">priv</span>&nbsp;<span class="keyword" id="4431264">interface</span><span class="op" id="4431273">{</span><span class="op" id="4431274">}</span><span class="op" id="4431275">)</span>&nbsp;<span class="op" id="4431277">(</span><span class="ident" id="4431278">csr</span>&nbsp;<span class="op" id="4431282">[</span><span class="op" id="4431283">]</span><span class="builtintype" id="4431284">byte</span><span class="op" id="4431288">,</span>&nbsp;<span class="ident" id="4431290">err</span>&nbsp;<span class="builtintype" id="4431294">error</span><span class="op" id="4431299">)</span>&nbsp;<span class="op" id="4431301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4431304">hashFunc</span><span class="op" id="4431312">,</span>&nbsp;<span class="ident" id="4431314">sigAlgo</span><span class="op" id="4431321">,</span>&nbsp;<span class="ident" id="4431323">err</span>&nbsp;<span class="op" id="4431327">:=</span>&nbsp;<span class="ident" id="4431330">signingParamsForPrivateKey</span><span class="op" id="4431356">(</span><span class="ident" id="4431357">priv</span><span class="op" id="4431361">,</span>&nbsp;<span class="ident" id="4431363">template</span><span class="op" id="4431371">.</span><span class="ident" id="4431372">SignatureAlgorithm</span><span class="op" id="4431390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4431393">if</span>&nbsp;<span class="ident" id="4431396">err</span>&nbsp;<span class="op" id="4431400">!=</span>&nbsp;<span class="builtintype" id="4431403">nil</span>&nbsp;<span class="op" id="4431407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4431411">return</span>&nbsp;<span class="builtintype" id="4431418">nil</span><span class="op" id="4431421">,</span>&nbsp;<span class="ident" id="4431423">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4431428">}</span><br>
<span class="lineno">1685</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4431432">var</span>&nbsp;<span class="ident" id="4431436">publicKeyBytes</span>&nbsp;<span class="op" id="4431451">[</span><span class="op" id="4431452">]</span><span class="builtintype" id="4431453">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4431459">var</span>&nbsp;<span class="ident" id="4431463">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="4431482">pkix</span><span class="op" id="4431486">.</span><span class="ident" id="4431487">AlgorithmIdentifier</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4431509">switch</span>&nbsp;<span class="ident" id="4431516">priv</span>&nbsp;<span class="op" id="4431521">:=</span>&nbsp;<span class="ident" id="4431524">priv</span><span class="op" id="4431528">.</span><span class="op" id="4431529">(</span><span class="keyword" id="4431530">type</span><span class="op" id="4431534">)</span>&nbsp;<span class="op" id="4431536">{</span><br>
<span class="lineno">1690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4431539">case</span>&nbsp;<span class="op" id="4431544">*</span><span class="ident" id="4431545">rsa</span><span class="op" id="4431548">.</span><span class="ident" id="4431549">PrivateKey</span><span class="op" id="4431559">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4431563">publicKeyBytes</span><span class="op" id="4431577">,</span>&nbsp;<span class="ident" id="4431579">publicKeyAlgorithm</span><span class="op" id="4431597">,</span>&nbsp;<span class="ident" id="4431599">err</span>&nbsp;<span class="op" id="4431603">=</span>&nbsp;<span class="ident" id="4431605">marshalPublicKey</span><span class="op" id="4431621">(</span><span class="op" id="4431622">&amp;</span><span class="ident" id="4431623">priv</span><span class="op" id="4431627">.</span><span class="ident" id="4431628">PublicKey</span><span class="op" id="4431637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4431640">case</span>&nbsp;<span class="op" id="4431645">*</span><span class="ident" id="4431646">ecdsa</span><span class="op" id="4431651">.</span><span class="ident" id="4431652">PrivateKey</span><span class="op" id="4431662">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4431666">publicKeyBytes</span><span class="op" id="4431680">,</span>&nbsp;<span class="ident" id="4431682">publicKeyAlgorithm</span><span class="op" id="4431700">,</span>&nbsp;<span class="ident" id="4431702">err</span>&nbsp;<span class="op" id="4431706">=</span>&nbsp;<span class="ident" id="4431708">marshalPublicKey</span><span class="op" id="4431724">(</span><span class="op" id="4431725">&amp;</span><span class="ident" id="4431726">priv</span><span class="op" id="4431730">.</span><span class="ident" id="4431731">PublicKey</span><span class="op" id="4431740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4431743">default</span><span class="op" id="4431750">:</span><br>
<span class="lineno">1695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4431754">panic</span><span class="op" id="4431759">(</span><span class="string" id="4431760">&#34;internal&nbsp;error&#34;</span><span class="op" id="4431776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4431779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4431783">if</span>&nbsp;<span class="ident" id="4431786">err</span>&nbsp;<span class="op" id="4431790">!=</span>&nbsp;<span class="builtintype" id="4431793">nil</span>&nbsp;<span class="op" id="4431797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4431801">return</span>&nbsp;<span class="builtintype" id="4431808">nil</span><span class="op" id="4431811">,</span>&nbsp;<span class="ident" id="4431813">err</span><br>
<span class="lineno">1700</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4431818">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4431822">var</span>&nbsp;<span class="ident" id="4431826">extensions</span>&nbsp;<span class="op" id="4431837">[</span><span class="op" id="4431838">]</span><span class="ident" id="4431839">pkix</span><span class="op" id="4431843">.</span><span class="ident" id="4431844">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4431856">if</span>&nbsp;<span class="op" id="4431859">(</span><span class="builtinfunc" id="4431860">len</span><span class="op" id="4431863">(</span><span class="ident" id="4431864">template</span><span class="op" id="4431872">.</span><span class="ident" id="4431873">DNSNames</span><span class="op" id="4431881">)</span>&nbsp;<span class="op" id="4431883">&gt;</span>&nbsp;<span class="num" id="4431885">0</span>&nbsp;<span class="op" id="4431887">||</span>&nbsp;<span class="builtinfunc" id="4431890">len</span><span class="op" id="4431893">(</span><span class="ident" id="4431894">template</span><span class="op" id="4431902">.</span><span class="ident" id="4431903">EmailAddresses</span><span class="op" id="4431917">)</span>&nbsp;<span class="op" id="4431919">&gt;</span>&nbsp;<span class="num" id="4431921">0</span>&nbsp;<span class="op" id="4431923">||</span>&nbsp;<span class="builtinfunc" id="4431926">len</span><span class="op" id="4431929">(</span><span class="ident" id="4431930">template</span><span class="op" id="4431938">.</span><span class="ident" id="4431939">IPAddresses</span><span class="op" id="4431950">)</span>&nbsp;<span class="op" id="4431952">&gt;</span>&nbsp;<span class="num" id="4431954">0</span><span class="op" id="4431955">)</span>&nbsp;<span class="op" id="4431957">&amp;&amp;</span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4431962">!</span><span class="ident" id="4431963">oidInExtensions</span><span class="op" id="4431978">(</span><span class="ident" id="4431979">oidExtensionSubjectAltName</span><span class="op" id="4432005">,</span>&nbsp;<span class="ident" id="4432007">template</span><span class="op" id="4432015">.</span><span class="ident" id="4432016">ExtraExtensions</span><span class="op" id="4432031">)</span>&nbsp;<span class="op" id="4432033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4432037">sanBytes</span><span class="op" id="4432045">,</span>&nbsp;<span class="ident" id="4432047">err</span>&nbsp;<span class="op" id="4432051">:=</span>&nbsp;<span class="ident" id="4432054">marshalSANs</span><span class="op" id="4432065">(</span><span class="ident" id="4432066">template</span><span class="op" id="4432074">.</span><span class="ident" id="4432075">DNSNames</span><span class="op" id="4432083">,</span>&nbsp;<span class="ident" id="4432085">template</span><span class="op" id="4432093">.</span><span class="ident" id="4432094">EmailAddresses</span><span class="op" id="4432108">,</span>&nbsp;<span class="ident" id="4432110">template</span><span class="op" id="4432118">.</span><span class="ident" id="4432119">IPAddresses</span><span class="op" id="4432130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4432134">if</span>&nbsp;<span class="ident" id="4432137">err</span>&nbsp;<span class="op" id="4432141">!=</span>&nbsp;<span class="builtintype" id="4432144">nil</span>&nbsp;<span class="op" id="4432148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4432153">return</span>&nbsp;<span class="builtintype" id="4432160">nil</span><span class="op" id="4432163">,</span>&nbsp;<span class="ident" id="4432165">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4432171">}</span><br>
<span class="lineno">1710</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4432176">extensions</span>&nbsp;<span class="op" id="4432187">=</span>&nbsp;<span class="builtinfunc" id="4432189">append</span><span class="op" id="4432195">(</span><span class="ident" id="4432196">extensions</span><span class="op" id="4432206">,</span>&nbsp;<span class="ident" id="4432208">pkix</span><span class="op" id="4432212">.</span><span class="ident" id="4432213">Extension</span><span class="op" id="4432222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4432227">Id</span><span class="op" id="4432229">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4432234">oidExtensionSubjectAltName</span><span class="op" id="4432260">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4432265">Value</span><span class="op" id="4432270">:</span>&nbsp;<span class="ident" id="4432272">sanBytes</span><span class="op" id="4432280">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4432284">}</span><span class="op" id="4432285">)</span><br>
<span class="lineno">1715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4432288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4432292">extensions</span>&nbsp;<span class="op" id="4432303">=</span>&nbsp;<span class="builtinfunc" id="4432305">append</span><span class="op" id="4432311">(</span><span class="ident" id="4432312">extensions</span><span class="op" id="4432322">,</span>&nbsp;<span class="ident" id="4432324">template</span><span class="op" id="4432332">.</span><span class="ident" id="4432333">ExtraExtensions</span><span class="op" id="4432348">...</span><span class="op" id="4432351">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4432355">var</span>&nbsp;<span class="ident" id="4432359">attributes</span>&nbsp;<span class="op" id="4432370">[</span><span class="op" id="4432371">]</span><span class="ident" id="4432372">pkix</span><span class="op" id="4432376">.</span><span class="ident" id="4432377">AttributeTypeAndValueSET</span><br>
<span class="lineno">1720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4432403">attributes</span>&nbsp;<span class="op" id="4432414">=</span>&nbsp;<span class="builtinfunc" id="4432416">append</span><span class="op" id="4432422">(</span><span class="ident" id="4432423">attributes</span><span class="op" id="4432433">,</span>&nbsp;<span class="ident" id="4432435">template</span><span class="op" id="4432443">.</span><span class="ident" id="4432444">Attributes</span><span class="op" id="4432454">...</span><span class="op" id="4432457">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4432461">if</span>&nbsp;<span class="builtinfunc" id="4432464">len</span><span class="op" id="4432467">(</span><span class="ident" id="4432468">extensions</span><span class="op" id="4432478">)</span>&nbsp;<span class="op" id="4432480">&gt;</span>&nbsp;<span class="num" id="4432482">0</span>&nbsp;<span class="op" id="4432484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4432488">//&nbsp;specifiedExtensions&nbsp;contains&nbsp;all&nbsp;the&nbsp;extensions&nbsp;that&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4432549">//&nbsp;found&nbsp;specified&nbsp;via&nbsp;template.Attributes.</span><br>
<span class="lineno">1725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4432595">specifiedExtensions</span>&nbsp;<span class="op" id="4432615">:=</span>&nbsp;<span class="builtinfunc" id="4432618">make</span><span class="op" id="4432622">(</span><span class="keyword" id="4432623">map</span><span class="op" id="4432626">[</span><span class="builtintype" id="4432627">string</span><span class="op" id="4432633">]</span><span class="builtintype" id="4432634">bool</span><span class="op" id="4432638">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4432643">for</span>&nbsp;<span class="ident" id="4432647">_</span><span class="op" id="4432648">,</span>&nbsp;<span class="ident" id="4432650">atvSet</span>&nbsp;<span class="op" id="4432657">:=</span>&nbsp;<span class="keyword" id="4432660">range</span>&nbsp;<span class="ident" id="4432666">template</span><span class="op" id="4432674">.</span><span class="ident" id="4432675">Attributes</span>&nbsp;<span class="op" id="4432686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4432691">if</span>&nbsp;<span class="op" id="4432694">!</span><span class="ident" id="4432695">atvSet</span><span class="op" id="4432701">.</span><span class="ident" id="4432702">Type</span><span class="op" id="4432706">.</span><span class="ident" id="4432707">Equal</span><span class="op" id="4432712">(</span><span class="ident" id="4432713">oidExtensionRequest</span><span class="op" id="4432732">)</span>&nbsp;<span class="op" id="4432734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4432740">continue</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4432752">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4432758">for</span>&nbsp;<span class="ident" id="4432762">_</span><span class="op" id="4432763">,</span>&nbsp;<span class="ident" id="4432765">atvs</span>&nbsp;<span class="op" id="4432770">:=</span>&nbsp;<span class="keyword" id="4432773">range</span>&nbsp;<span class="ident" id="4432779">atvSet</span><span class="op" id="4432785">.</span><span class="ident" id="4432786">Value</span>&nbsp;<span class="op" id="4432792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4432798">for</span>&nbsp;<span class="ident" id="4432802">_</span><span class="op" id="4432803">,</span>&nbsp;<span class="ident" id="4432805">atv</span>&nbsp;<span class="op" id="4432809">:=</span>&nbsp;<span class="keyword" id="4432812">range</span>&nbsp;<span class="ident" id="4432818">atvs</span>&nbsp;<span class="op" id="4432823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4432830">specifiedExtensions</span><span class="op" id="4432849">[</span><span class="ident" id="4432850">atv</span><span class="op" id="4432853">.</span><span class="ident" id="4432854">Type</span><span class="op" id="4432858">.</span><span class="ident" id="4432859">String</span><span class="op" id="4432865">(</span><span class="op" id="4432866">)</span><span class="op" id="4432867">]</span>&nbsp;<span class="op" id="4432869">=</span>&nbsp;<span class="builtintype" id="4432871">true</span><br>
<span class="lineno">1735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4432880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4432885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4432889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4432894">atvs</span>&nbsp;<span class="op" id="4432899">:=</span>&nbsp;<span class="builtinfunc" id="4432902">make</span><span class="op" id="4432906">(</span><span class="op" id="4432907">[</span><span class="op" id="4432908">]</span><span class="ident" id="4432909">pkix</span><span class="op" id="4432913">.</span><span class="ident" id="4432914">AttributeTypeAndValue</span><span class="op" id="4432935">,</span>&nbsp;<span class="num" id="4432937">0</span><span class="op" id="4432938">,</span>&nbsp;<span class="builtinfunc" id="4432940">len</span><span class="op" id="4432943">(</span><span class="ident" id="4432944">extensions</span><span class="op" id="4432954">)</span><span class="op" id="4432955">)</span><br>
<span class="lineno">1740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4432959">for</span>&nbsp;<span class="ident" id="4432963">_</span><span class="op" id="4432964">,</span>&nbsp;<span class="ident" id="4432966">e</span>&nbsp;<span class="op" id="4432968">:=</span>&nbsp;<span class="keyword" id="4432971">range</span>&nbsp;<span class="ident" id="4432977">extensions</span>&nbsp;<span class="op" id="4432988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4432993">if</span>&nbsp;<span class="ident" id="4432996">specifiedExtensions</span><span class="op" id="4433015">[</span><span class="ident" id="4433016">e</span><span class="op" id="4433017">.</span><span class="ident" id="4433018">Id</span><span class="op" id="4433020">.</span><span class="ident" id="4433021">String</span><span class="op" id="4433027">(</span><span class="op" id="4433028">)</span><span class="op" id="4433029">]</span>&nbsp;<span class="op" id="4433031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4433037">//&nbsp;Attributes&nbsp;already&nbsp;contained&nbsp;a&nbsp;value&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4433085">//&nbsp;this&nbsp;extension&nbsp;and&nbsp;it&nbsp;takes&nbsp;priority.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4433130">continue</span><br>
<span class="lineno">1745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4433142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4433148">atvs</span>&nbsp;<span class="op" id="4433153">=</span>&nbsp;<span class="builtinfunc" id="4433155">append</span><span class="op" id="4433161">(</span><span class="ident" id="4433162">atvs</span><span class="op" id="4433166">,</span>&nbsp;<span class="ident" id="4433168">pkix</span><span class="op" id="4433172">.</span><span class="ident" id="4433173">AttributeTypeAndValue</span><span class="op" id="4433194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4433200">//&nbsp;There&nbsp;is&nbsp;no&nbsp;place&nbsp;for&nbsp;the&nbsp;critical&nbsp;flag&nbsp;in&nbsp;a&nbsp;CSR.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4433257">Type</span><span class="op" id="4433261">:</span>&nbsp;&nbsp;<span class="ident" id="4433264">e</span><span class="op" id="4433265">.</span><span class="ident" id="4433266">Id</span><span class="op" id="4433268">,</span><br>
<span class="lineno">1750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4433274">Value</span><span class="op" id="4433279">:</span>&nbsp;<span class="ident" id="4433281">e</span><span class="op" id="4433282">.</span><span class="ident" id="4433283">Value</span><span class="op" id="4433288">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4433293">}</span><span class="op" id="4433294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4433298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4433303">//&nbsp;Append&nbsp;the&nbsp;extensions&nbsp;to&nbsp;an&nbsp;existing&nbsp;attribute&nbsp;if&nbsp;possible.</span><br>
<span class="lineno">1755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4433368">appended</span>&nbsp;<span class="op" id="4433377">:=</span>&nbsp;<span class="builtintype" id="4433380">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4433388">for</span>&nbsp;<span class="ident" id="4433392">_</span><span class="op" id="4433393">,</span>&nbsp;<span class="ident" id="4433395">atvSet</span>&nbsp;<span class="op" id="4433402">:=</span>&nbsp;<span class="keyword" id="4433405">range</span>&nbsp;<span class="ident" id="4433411">attributes</span>&nbsp;<span class="op" id="4433422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4433427">if</span>&nbsp;<span class="op" id="4433430">!</span><span class="ident" id="4433431">atvSet</span><span class="op" id="4433437">.</span><span class="ident" id="4433438">Type</span><span class="op" id="4433442">.</span><span class="ident" id="4433443">Equal</span><span class="op" id="4433448">(</span><span class="ident" id="4433449">oidExtensionRequest</span><span class="op" id="4433468">)</span>&nbsp;<span class="op" id="4433470">||</span>&nbsp;<span class="builtinfunc" id="4433473">len</span><span class="op" id="4433476">(</span><span class="ident" id="4433477">atvSet</span><span class="op" id="4433483">.</span><span class="ident" id="4433484">Value</span><span class="op" id="4433489">)</span>&nbsp;<span class="op" id="4433491">==</span>&nbsp;<span class="num" id="4433494">0</span>&nbsp;<span class="op" id="4433496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4433502">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4433514">}</span><br>
<span class="lineno">1760</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4433520">atvSet</span><span class="op" id="4433526">.</span><span class="ident" id="4433527">Value</span><span class="op" id="4433532">[</span><span class="num" id="4433533">0</span><span class="op" id="4433534">]</span>&nbsp;<span class="op" id="4433536">=</span>&nbsp;<span class="builtinfunc" id="4433538">append</span><span class="op" id="4433544">(</span><span class="ident" id="4433545">atvSet</span><span class="op" id="4433551">.</span><span class="ident" id="4433552">Value</span><span class="op" id="4433557">[</span><span class="num" id="4433558">0</span><span class="op" id="4433559">]</span><span class="op" id="4433560">,</span>&nbsp;<span class="ident" id="4433562">atvs</span><span class="op" id="4433566">...</span><span class="op" id="4433569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4433574">appended</span>&nbsp;<span class="op" id="4433583">=</span>&nbsp;<span class="builtintype" id="4433585">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4433593">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4433601">}</span><br>
<span class="lineno">1765</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4433606">//&nbsp;Otherwise,&nbsp;add&nbsp;a&nbsp;new&nbsp;attribute&nbsp;for&nbsp;the&nbsp;extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4433662">if</span>&nbsp;<span class="op" id="4433665">!</span><span class="ident" id="4433666">appended</span>&nbsp;<span class="op" id="4433675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4433680">attributes</span>&nbsp;<span class="op" id="4433691">=</span>&nbsp;<span class="builtinfunc" id="4433693">append</span><span class="op" id="4433699">(</span><span class="ident" id="4433700">attributes</span><span class="op" id="4433710">,</span>&nbsp;<span class="ident" id="4433712">pkix</span><span class="op" id="4433716">.</span><span class="ident" id="4433717">AttributeTypeAndValueSET</span><span class="op" id="4433741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4433747">Type</span><span class="op" id="4433751">:</span>&nbsp;<span class="ident" id="4433753">oidExtensionRequest</span><span class="op" id="4433772">,</span><br>
<span class="lineno">1770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4433778">Value</span><span class="op" id="4433783">:</span>&nbsp;<span class="op" id="4433785">[</span><span class="op" id="4433786">]</span><span class="op" id="4433787">[</span><span class="op" id="4433788">]</span><span class="ident" id="4433789">pkix</span><span class="op" id="4433793">.</span><span class="ident" id="4433794">AttributeTypeAndValue</span><span class="op" id="4433815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4433822">atvs</span><span class="op" id="4433826">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4433832">}</span><span class="op" id="4433833">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4433838">}</span><span class="op" id="4433839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4433843">}</span><br>
<span class="lineno">1775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4433846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4433850">asn1Subject</span>&nbsp;<span class="op" id="4433862">:=</span>&nbsp;<span class="ident" id="4433865">template</span><span class="op" id="4433873">.</span><span class="ident" id="4433874">RawSubject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4433886">if</span>&nbsp;<span class="builtinfunc" id="4433889">len</span><span class="op" id="4433892">(</span><span class="ident" id="4433893">asn1Subject</span><span class="op" id="4433904">)</span>&nbsp;<span class="op" id="4433906">==</span>&nbsp;<span class="num" id="4433909">0</span>&nbsp;<span class="op" id="4433911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4433915">asn1Subject</span><span class="op" id="4433926">,</span>&nbsp;<span class="ident" id="4433928">err</span>&nbsp;<span class="op" id="4433932">=</span>&nbsp;<span class="ident" id="4433934">asn1</span><span class="op" id="4433938">.</span><span class="ident" id="4433939">Marshal</span><span class="op" id="4433946">(</span><span class="ident" id="4433947">template</span><span class="op" id="4433955">.</span><span class="ident" id="4433956">Subject</span><span class="op" id="4433963">.</span><span class="ident" id="4433964">ToRDNSequence</span><span class="op" id="4433977">(</span><span class="op" id="4433978">)</span><span class="op" id="4433979">)</span><br>
<span class="lineno">1780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4433983">if</span>&nbsp;<span class="ident" id="4433986">err</span>&nbsp;<span class="op" id="4433990">!=</span>&nbsp;<span class="builtintype" id="4433993">nil</span>&nbsp;<span class="op" id="4433997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4434002">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4434011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4434014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434018">tbsCSR</span>&nbsp;<span class="op" id="4434025">:=</span>&nbsp;<span class="ident" id="4434028">tbsCertificateRequest</span><span class="op" id="4434049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434053">Version</span><span class="op" id="4434060">:</span>&nbsp;<span class="num" id="4434062">0</span><span class="op" id="4434063">,</span>&nbsp;<span class="comment" id="4434065">//&nbsp;PKCS&nbsp;#10,&nbsp;RFC&nbsp;2986</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434089">Subject</span><span class="op" id="4434096">:</span>&nbsp;<span class="ident" id="4434098">asn1</span><span class="op" id="4434102">.</span><span class="ident" id="4434103">RawValue</span><span class="op" id="4434111">{</span><span class="ident" id="4434112">FullBytes</span><span class="op" id="4434121">:</span>&nbsp;<span class="ident" id="4434123">asn1Subject</span><span class="op" id="4434134">}</span><span class="op" id="4434135">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434139">PublicKey</span><span class="op" id="4434148">:</span>&nbsp;<span class="ident" id="4434150">publicKeyInfo</span><span class="op" id="4434163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434168">Algorithm</span><span class="op" id="4434177">:</span>&nbsp;<span class="ident" id="4434179">publicKeyAlgorithm</span><span class="op" id="4434197">,</span><br>
<span class="lineno">1790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434202">PublicKey</span><span class="op" id="4434211">:</span>&nbsp;<span class="ident" id="4434213">asn1</span><span class="op" id="4434217">.</span><span class="ident" id="4434218">BitString</span><span class="op" id="4434227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434233">Bytes</span><span class="op" id="4434238">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434244">publicKeyBytes</span><span class="op" id="4434258">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434264">BitLength</span><span class="op" id="4434273">:</span>&nbsp;<span class="builtinfunc" id="4434275">len</span><span class="op" id="4434278">(</span><span class="ident" id="4434279">publicKeyBytes</span><span class="op" id="4434293">)</span>&nbsp;<span class="op" id="4434295">*</span>&nbsp;<span class="num" id="4434297">8</span><span class="op" id="4434298">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4434303">}</span><span class="op" id="4434304">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4434308">}</span><span class="op" id="4434309">,</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434313">Attributes</span><span class="op" id="4434323">:</span>&nbsp;<span class="ident" id="4434325">attributes</span><span class="op" id="4434335">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4434338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434342">tbsCSRContents</span><span class="op" id="4434356">,</span>&nbsp;<span class="ident" id="4434358">err</span>&nbsp;<span class="op" id="4434362">:=</span>&nbsp;<span class="ident" id="4434365">asn1</span><span class="op" id="4434369">.</span><span class="ident" id="4434370">Marshal</span><span class="op" id="4434377">(</span><span class="ident" id="4434378">tbsCSR</span><span class="op" id="4434384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4434387">if</span>&nbsp;<span class="ident" id="4434390">err</span>&nbsp;<span class="op" id="4434394">!=</span>&nbsp;<span class="builtintype" id="4434397">nil</span>&nbsp;<span class="op" id="4434401">{</span><br>
<span class="lineno">1800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4434405">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4434413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434416">tbsCSR</span><span class="op" id="4434422">.</span><span class="ident" id="4434423">Raw</span>&nbsp;<span class="op" id="4434427">=</span>&nbsp;<span class="ident" id="4434429">tbsCSRContents</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434446">h</span>&nbsp;<span class="op" id="4434448">:=</span>&nbsp;<span class="ident" id="4434451">hashFunc</span><span class="op" id="4434459">.</span><span class="ident" id="4434460">New</span><span class="op" id="4434463">(</span><span class="op" id="4434464">)</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434467">h</span><span class="op" id="4434468">.</span><span class="ident" id="4434469">Write</span><span class="op" id="4434474">(</span><span class="ident" id="4434475">tbsCSRContents</span><span class="op" id="4434489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434492">digest</span>&nbsp;<span class="op" id="4434499">:=</span>&nbsp;<span class="ident" id="4434502">h</span><span class="op" id="4434503">.</span><span class="ident" id="4434504">Sum</span><span class="op" id="4434507">(</span><span class="builtintype" id="4434508">nil</span><span class="op" id="4434511">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4434515">var</span>&nbsp;<span class="ident" id="4434519">signature</span>&nbsp;<span class="op" id="4434529">[</span><span class="op" id="4434530">]</span><span class="builtintype" id="4434531">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4434537">switch</span>&nbsp;<span class="ident" id="4434544">priv</span>&nbsp;<span class="op" id="4434549">:=</span>&nbsp;<span class="ident" id="4434552">priv</span><span class="op" id="4434556">.</span><span class="op" id="4434557">(</span><span class="keyword" id="4434558">type</span><span class="op" id="4434562">)</span>&nbsp;<span class="op" id="4434564">{</span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4434567">case</span>&nbsp;<span class="op" id="4434572">*</span><span class="ident" id="4434573">rsa</span><span class="op" id="4434576">.</span><span class="ident" id="4434577">PrivateKey</span><span class="op" id="4434587">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434591">signature</span><span class="op" id="4434600">,</span>&nbsp;<span class="ident" id="4434602">err</span>&nbsp;<span class="op" id="4434606">=</span>&nbsp;<span class="ident" id="4434608">rsa</span><span class="op" id="4434611">.</span><span class="ident" id="4434612">SignPKCS1v15</span><span class="op" id="4434624">(</span><span class="ident" id="4434625">rand</span><span class="op" id="4434629">,</span>&nbsp;<span class="ident" id="4434631">priv</span><span class="op" id="4434635">,</span>&nbsp;<span class="ident" id="4434637">hashFunc</span><span class="op" id="4434645">,</span>&nbsp;<span class="ident" id="4434647">digest</span><span class="op" id="4434653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4434656">case</span>&nbsp;<span class="op" id="4434661">*</span><span class="ident" id="4434662">ecdsa</span><span class="op" id="4434667">.</span><span class="ident" id="4434668">PrivateKey</span><span class="op" id="4434678">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4434682">var</span>&nbsp;<span class="ident" id="4434686">r</span><span class="op" id="4434687">,</span>&nbsp;<span class="ident" id="4434689">s</span>&nbsp;<span class="op" id="4434691">*</span><span class="ident" id="4434692">big</span><span class="op" id="4434695">.</span><span class="ident" id="4434696">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4434702">if</span>&nbsp;<span class="ident" id="4434705">r</span><span class="op" id="4434706">,</span>&nbsp;<span class="ident" id="4434708">s</span><span class="op" id="4434709">,</span>&nbsp;<span class="ident" id="4434711">err</span>&nbsp;<span class="op" id="4434715">=</span>&nbsp;<span class="ident" id="4434717">ecdsa</span><span class="op" id="4434722">.</span><span class="ident" id="4434723">Sign</span><span class="op" id="4434727">(</span><span class="ident" id="4434728">rand</span><span class="op" id="4434732">,</span>&nbsp;<span class="ident" id="4434734">priv</span><span class="op" id="4434738">,</span>&nbsp;<span class="ident" id="4434740">digest</span><span class="op" id="4434746">)</span><span class="op" id="4434747">;</span>&nbsp;<span class="ident" id="4434749">err</span>&nbsp;<span class="op" id="4434753">==</span>&nbsp;<span class="builtintype" id="4434756">nil</span>&nbsp;<span class="op" id="4434760">{</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434765">signature</span><span class="op" id="4434774">,</span>&nbsp;<span class="ident" id="4434776">err</span>&nbsp;<span class="op" id="4434780">=</span>&nbsp;<span class="ident" id="4434782">asn1</span><span class="op" id="4434786">.</span><span class="ident" id="4434787">Marshal</span><span class="op" id="4434794">(</span><span class="ident" id="4434795">ecdsaSignature</span><span class="op" id="4434809">{</span><span class="ident" id="4434810">r</span><span class="op" id="4434811">,</span>&nbsp;<span class="ident" id="4434813">s</span><span class="op" id="4434814">}</span><span class="op" id="4434815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4434819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4434822">default</span><span class="op" id="4434829">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4434833">panic</span><span class="op" id="4434838">(</span><span class="string" id="4434839">&#34;internal&nbsp;error&#34;</span><span class="op" id="4434855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4434858">}</span><br>
<span class="lineno">1820</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4434862">if</span>&nbsp;<span class="ident" id="4434865">err</span>&nbsp;<span class="op" id="4434869">!=</span>&nbsp;<span class="builtintype" id="4434872">nil</span>&nbsp;<span class="op" id="4434876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4434880">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4434888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4434892">return</span>&nbsp;<span class="ident" id="4434899">asn1</span><span class="op" id="4434903">.</span><span class="ident" id="4434904">Marshal</span><span class="op" id="4434911">(</span><span class="ident" id="4434912">certificateRequest</span><span class="op" id="4434930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434934">TBSCSR</span><span class="op" id="4434940">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434954">tbsCSR</span><span class="op" id="4434960">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434964">SignatureAlgorithm</span><span class="op" id="4434982">:</span>&nbsp;<span class="ident" id="4434984">sigAlgo</span><span class="op" id="4434991">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4434995">SignatureValue</span><span class="op" id="4435009">:</span>&nbsp;<span class="ident" id="4435011">asn1</span><span class="op" id="4435015">.</span><span class="ident" id="4435016">BitString</span><span class="op" id="4435025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4435030">Bytes</span><span class="op" id="4435035">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4435041">signature</span><span class="op" id="4435050">,</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4435055">BitLength</span><span class="op" id="4435064">:</span>&nbsp;<span class="builtinfunc" id="4435066">len</span><span class="op" id="4435069">(</span><span class="ident" id="4435070">signature</span><span class="op" id="4435079">)</span>&nbsp;<span class="op" id="4435081">*</span>&nbsp;<span class="num" id="4435083">8</span><span class="op" id="4435084">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4435088">}</span><span class="op" id="4435089">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4435092">}</span><span class="op" id="4435093">)</span><br>
<span class="lineno"></span><span class="op" id="4435095">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1835</span><span class="comment" id="4435098">//&nbsp;ParseCertificateRequest&nbsp;parses&nbsp;a&nbsp;single&nbsp;certificate&nbsp;request&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4435170">//&nbsp;given&nbsp;ASN.1&nbsp;DER&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4435195">func</span>&nbsp;<span class="ident" id="4435200">ParseCertificateRequest</span><span class="op" id="4435223">(</span><span class="ident" id="4435224">asn1Data</span>&nbsp;<span class="op" id="4435233">[</span><span class="op" id="4435234">]</span><span class="builtintype" id="4435235">byte</span><span class="op" id="4435239">)</span>&nbsp;<span class="op" id="4435241">(</span><span class="op" id="4435242">*</span><span class="ident" id="4435243">CertificateRequest</span><span class="op" id="4435261">,</span>&nbsp;<span class="builtintype" id="4435263">error</span><span class="op" id="4435268">)</span>&nbsp;<span class="op" id="4435270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4435273">var</span>&nbsp;<span class="ident" id="4435277">csr</span>&nbsp;<span class="ident" id="4435281">certificateRequest</span><br>
<span class="lineno"></span><br>
<span class="lineno">1840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4435302">rest</span><span class="op" id="4435306">,</span>&nbsp;<span class="ident" id="4435308">err</span>&nbsp;<span class="op" id="4435312">:=</span>&nbsp;<span class="ident" id="4435315">asn1</span><span class="op" id="4435319">.</span><span class="ident" id="4435320">Unmarshal</span><span class="op" id="4435329">(</span><span class="ident" id="4435330">asn1Data</span><span class="op" id="4435338">,</span>&nbsp;<span class="op" id="4435340">&amp;</span><span class="ident" id="4435341">csr</span><span class="op" id="4435344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4435347">if</span>&nbsp;<span class="ident" id="4435350">err</span>&nbsp;<span class="op" id="4435354">!=</span>&nbsp;<span class="builtintype" id="4435357">nil</span>&nbsp;<span class="op" id="4435361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4435365">return</span>&nbsp;<span class="builtintype" id="4435372">nil</span><span class="op" id="4435375">,</span>&nbsp;<span class="ident" id="4435377">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4435382">}</span>&nbsp;<span class="keyword" id="4435384">else</span>&nbsp;<span class="keyword" id="4435389">if</span>&nbsp;<span class="builtinfunc" id="4435392">len</span><span class="op" id="4435395">(</span><span class="ident" id="4435396">rest</span><span class="op" id="4435400">)</span>&nbsp;<span class="op" id="4435402">!=</span>&nbsp;<span class="num" id="4435405">0</span>&nbsp;<span class="op" id="4435407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4435411">return</span>&nbsp;<span class="builtintype" id="4435418">nil</span><span class="op" id="4435421">,</span>&nbsp;<span class="ident" id="4435423">asn1</span><span class="op" id="4435427">.</span><span class="ident" id="4435428">SyntaxError</span><span class="op" id="4435439">{</span><span class="ident" id="4435440">Msg</span><span class="op" id="4435443">:</span>&nbsp;<span class="string" id="4435445">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4435460">}</span><br>
<span class="lineno">1845</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4435463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4435467">return</span>&nbsp;<span class="ident" id="4435474">parseCertificateRequest</span><span class="op" id="4435497">(</span><span class="op" id="4435498">&amp;</span><span class="ident" id="4435499">csr</span><span class="op" id="4435502">)</span><br>
<span class="lineno"></span><span class="op" id="4435504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1850</span><span class="keyword" id="4435507">func</span>&nbsp;<span class="ident" id="4435512">parseCertificateRequest</span><span class="op" id="4435535">(</span><span class="ident" id="4435536">in</span>&nbsp;<span class="op" id="4435539">*</span><span class="ident" id="4435540">certificateRequest</span><span class="op" id="4435558">)</span>&nbsp;<span class="op" id="4435560">(</span><span class="op" id="4435561">*</span><span class="ident" id="4435562">CertificateRequest</span><span class="op" id="4435580">,</span>&nbsp;<span class="builtintype" id="4435582">error</span><span class="op" id="4435587">)</span>&nbsp;<span class="op" id="4435589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4435592">out</span>&nbsp;<span class="op" id="4435596">:=</span>&nbsp;<span class="op" id="4435599">&amp;</span><span class="ident" id="4435600">CertificateRequest</span><span class="op" id="4435618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4435622">Raw</span><span class="op" id="4435625">:</span>&nbsp;<span class="ident" id="4435627">in</span><span class="op" id="4435629">.</span><span class="ident" id="4435630">Raw</span><span class="op" id="4435633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4435637">RawTBSCertificateRequest</span><span class="op" id="4435661">:</span>&nbsp;<span class="ident" id="4435663">in</span><span class="op" id="4435665">.</span><span class="ident" id="4435666">TBSCSR</span><span class="op" id="4435672">.</span><span class="ident" id="4435673">Raw</span><span class="op" id="4435676">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4435680">RawSubjectPublicKeyInfo</span><span class="op" id="4435703">:</span>&nbsp;&nbsp;<span class="ident" id="4435706">in</span><span class="op" id="4435708">.</span><span class="ident" id="4435709">TBSCSR</span><span class="op" id="4435715">.</span><span class="ident" id="4435716">PublicKey</span><span class="op" id="4435725">.</span><span class="ident" id="4435726">Raw</span><span class="op" id="4435729">,</span><br>
<span class="lineno">1855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4435733">RawSubject</span><span class="op" id="4435743">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4435759">in</span><span class="op" id="4435761">.</span><span class="ident" id="4435762">TBSCSR</span><span class="op" id="4435768">.</span><span class="ident" id="4435769">Subject</span><span class="op" id="4435776">.</span><span class="ident" id="4435777">FullBytes</span><span class="op" id="4435786">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4435791">Signature</span><span class="op" id="4435800">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4435811">in</span><span class="op" id="4435813">.</span><span class="ident" id="4435814">SignatureValue</span><span class="op" id="4435828">.</span><span class="ident" id="4435829">RightAlign</span><span class="op" id="4435839">(</span><span class="op" id="4435840">)</span><span class="op" id="4435841">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4435845">SignatureAlgorithm</span><span class="op" id="4435863">:</span>&nbsp;<span class="ident" id="4435865">getSignatureAlgorithmFromOID</span><span class="op" id="4435893">(</span><span class="ident" id="4435894">in</span><span class="op" id="4435896">.</span><span class="ident" id="4435897">SignatureAlgorithm</span><span class="op" id="4435915">.</span><span class="ident" id="4435916">Algorithm</span><span class="op" id="4435925">)</span><span class="op" id="4435926">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">1860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4435931">PublicKeyAlgorithm</span><span class="op" id="4435949">:</span>&nbsp;<span class="ident" id="4435951">getPublicKeyAlgorithmFromOID</span><span class="op" id="4435979">(</span><span class="ident" id="4435980">in</span><span class="op" id="4435982">.</span><span class="ident" id="4435983">TBSCSR</span><span class="op" id="4435989">.</span><span class="ident" id="4435990">PublicKey</span><span class="op" id="4435999">.</span><span class="ident" id="4436000">Algorithm</span><span class="op" id="4436009">.</span><span class="ident" id="4436010">Algorithm</span><span class="op" id="4436019">)</span><span class="op" id="4436020">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4436025">Version</span><span class="op" id="4436032">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4436037">in</span><span class="op" id="4436039">.</span><span class="ident" id="4436040">TBSCSR</span><span class="op" id="4436046">.</span><span class="ident" id="4436047">Version</span><span class="op" id="4436054">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4436058">Attributes</span><span class="op" id="4436068">:</span>&nbsp;<span class="ident" id="4436070">in</span><span class="op" id="4436072">.</span><span class="ident" id="4436073">TBSCSR</span><span class="op" id="4436079">.</span><span class="ident" id="4436080">Attributes</span><span class="op" id="4436090">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4436093">}</span><br>
<span class="lineno">1865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4436097">var</span>&nbsp;<span class="ident" id="4436101">err</span>&nbsp;<span class="builtintype" id="4436105">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4436112">out</span><span class="op" id="4436115">.</span><span class="ident" id="4436116">PublicKey</span><span class="op" id="4436125">,</span>&nbsp;<span class="ident" id="4436127">err</span>&nbsp;<span class="op" id="4436131">=</span>&nbsp;<span class="ident" id="4436133">parsePublicKey</span><span class="op" id="4436147">(</span><span class="ident" id="4436148">out</span><span class="op" id="4436151">.</span><span class="ident" id="4436152">PublicKeyAlgorithm</span><span class="op" id="4436170">,</span>&nbsp;<span class="op" id="4436172">&amp;</span><span class="ident" id="4436173">in</span><span class="op" id="4436175">.</span><span class="ident" id="4436176">TBSCSR</span><span class="op" id="4436182">.</span><span class="ident" id="4436183">PublicKey</span><span class="op" id="4436192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4436195">if</span>&nbsp;<span class="ident" id="4436198">err</span>&nbsp;<span class="op" id="4436202">!=</span>&nbsp;<span class="builtintype" id="4436205">nil</span>&nbsp;<span class="op" id="4436209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4436213">return</span>&nbsp;<span class="builtintype" id="4436220">nil</span><span class="op" id="4436223">,</span>&nbsp;<span class="ident" id="4436225">err</span><br>
<span class="lineno">1870</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4436230">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4436234">var</span>&nbsp;<span class="ident" id="4436238">subject</span>&nbsp;<span class="ident" id="4436246">pkix</span><span class="op" id="4436250">.</span><span class="ident" id="4436251">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4436264">if</span>&nbsp;<span class="ident" id="4436267">_</span><span class="op" id="4436268">,</span>&nbsp;<span class="ident" id="4436270">err</span>&nbsp;<span class="op" id="4436274">:=</span>&nbsp;<span class="ident" id="4436277">asn1</span><span class="op" id="4436281">.</span><span class="ident" id="4436282">Unmarshal</span><span class="op" id="4436291">(</span><span class="ident" id="4436292">in</span><span class="op" id="4436294">.</span><span class="ident" id="4436295">TBSCSR</span><span class="op" id="4436301">.</span><span class="ident" id="4436302">Subject</span><span class="op" id="4436309">.</span><span class="ident" id="4436310">FullBytes</span><span class="op" id="4436319">,</span>&nbsp;<span class="op" id="4436321">&amp;</span><span class="ident" id="4436322">subject</span><span class="op" id="4436329">)</span><span class="op" id="4436330">;</span>&nbsp;<span class="ident" id="4436332">err</span>&nbsp;<span class="op" id="4436336">!=</span>&nbsp;<span class="builtintype" id="4436339">nil</span>&nbsp;<span class="op" id="4436343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4436347">return</span>&nbsp;<span class="builtintype" id="4436354">nil</span><span class="op" id="4436357">,</span>&nbsp;<span class="ident" id="4436359">err</span><br>
<span class="lineno">1875</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4436364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4436368">out</span><span class="op" id="4436371">.</span><span class="ident" id="4436372">Subject</span><span class="op" id="4436379">.</span><span class="ident" id="4436380">FillFromRDNSequence</span><span class="op" id="4436399">(</span><span class="op" id="4436400">&amp;</span><span class="ident" id="4436401">subject</span><span class="op" id="4436408">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4436412">var</span>&nbsp;<span class="ident" id="4436416">extensions</span>&nbsp;<span class="op" id="4436427">[</span><span class="op" id="4436428">]</span><span class="ident" id="4436429">pkix</span><span class="op" id="4436433">.</span><span class="ident" id="4436434">AttributeTypeAndValue</span><br>
<span class="lineno">1880</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4436458">for</span>&nbsp;<span class="ident" id="4436462">_</span><span class="op" id="4436463">,</span>&nbsp;<span class="ident" id="4436465">atvSet</span>&nbsp;<span class="op" id="4436472">:=</span>&nbsp;<span class="keyword" id="4436475">range</span>&nbsp;<span class="ident" id="4436481">in</span><span class="op" id="4436483">.</span><span class="ident" id="4436484">TBSCSR</span><span class="op" id="4436490">.</span><span class="ident" id="4436491">Attributes</span>&nbsp;<span class="op" id="4436502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4436506">if</span>&nbsp;<span class="op" id="4436509">!</span><span class="ident" id="4436510">atvSet</span><span class="op" id="4436516">.</span><span class="ident" id="4436517">Type</span><span class="op" id="4436521">.</span><span class="ident" id="4436522">Equal</span><span class="op" id="4436527">(</span><span class="ident" id="4436528">oidExtensionRequest</span><span class="op" id="4436547">)</span>&nbsp;<span class="op" id="4436549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4436554">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4436565">}</span><br>
<span class="lineno">1885</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4436570">for</span>&nbsp;<span class="ident" id="4436574">_</span><span class="op" id="4436575">,</span>&nbsp;<span class="ident" id="4436577">atvs</span>&nbsp;<span class="op" id="4436582">:=</span>&nbsp;<span class="keyword" id="4436585">range</span>&nbsp;<span class="ident" id="4436591">atvSet</span><span class="op" id="4436597">.</span><span class="ident" id="4436598">Value</span>&nbsp;<span class="op" id="4436604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4436609">extensions</span>&nbsp;<span class="op" id="4436620">=</span>&nbsp;<span class="builtinfunc" id="4436622">append</span><span class="op" id="4436628">(</span><span class="ident" id="4436629">extensions</span><span class="op" id="4436639">,</span>&nbsp;<span class="ident" id="4436641">atvs</span><span class="op" id="4436645">...</span><span class="op" id="4436648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4436652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4436655">}</span><br>
<span class="lineno">1890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4436659">out</span><span class="op" id="4436662">.</span><span class="ident" id="4436663">Extensions</span>&nbsp;<span class="op" id="4436674">=</span>&nbsp;<span class="builtinfunc" id="4436676">make</span><span class="op" id="4436680">(</span><span class="op" id="4436681">[</span><span class="op" id="4436682">]</span><span class="ident" id="4436683">pkix</span><span class="op" id="4436687">.</span><span class="ident" id="4436688">Extension</span><span class="op" id="4436697">,</span>&nbsp;<span class="num" id="4436699">0</span><span class="op" id="4436700">,</span>&nbsp;<span class="builtinfunc" id="4436702">len</span><span class="op" id="4436705">(</span><span class="ident" id="4436706">extensions</span><span class="op" id="4436716">)</span><span class="op" id="4436717">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4436721">for</span>&nbsp;<span class="ident" id="4436725">_</span><span class="op" id="4436726">,</span>&nbsp;<span class="ident" id="4436728">e</span>&nbsp;<span class="op" id="4436730">:=</span>&nbsp;<span class="keyword" id="4436733">range</span>&nbsp;<span class="ident" id="4436739">extensions</span>&nbsp;<span class="op" id="4436750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4436754">value</span><span class="op" id="4436759">,</span>&nbsp;<span class="ident" id="4436761">ok</span>&nbsp;<span class="op" id="4436764">:=</span>&nbsp;<span class="ident" id="4436767">e</span><span class="op" id="4436768">.</span><span class="ident" id="4436769">Value</span><span class="op" id="4436774">.</span><span class="op" id="4436775">(</span><span class="op" id="4436776">[</span><span class="op" id="4436777">]</span><span class="builtintype" id="4436778">byte</span><span class="op" id="4436782">)</span><br>
<span class="lineno">1895</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4436786">if</span>&nbsp;<span class="op" id="4436789">!</span><span class="ident" id="4436790">ok</span>&nbsp;<span class="op" id="4436793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4436798">return</span>&nbsp;<span class="builtintype" id="4436805">nil</span><span class="op" id="4436808">,</span>&nbsp;<span class="ident" id="4436810">errors</span><span class="op" id="4436816">.</span><span class="ident" id="4436817">New</span><span class="op" id="4436820">(</span><span class="string" id="4436821">&#34;x509:&nbsp;extension&nbsp;attribute&nbsp;contained&nbsp;non-OCTET&nbsp;STRING&nbsp;data&#34;</span><span class="op" id="4436880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4436884">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4436889">out</span><span class="op" id="4436892">.</span><span class="ident" id="4436893">Extensions</span>&nbsp;<span class="op" id="4436904">=</span>&nbsp;<span class="builtinfunc" id="4436906">append</span><span class="op" id="4436912">(</span><span class="ident" id="4436913">out</span><span class="op" id="4436916">.</span><span class="ident" id="4436917">Extensions</span><span class="op" id="4436927">,</span>&nbsp;<span class="ident" id="4436929">pkix</span><span class="op" id="4436933">.</span><span class="ident" id="4436934">Extension</span><span class="op" id="4436943">{</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4436948">Id</span><span class="op" id="4436950">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4436955">e</span><span class="op" id="4436956">.</span><span class="ident" id="4436957">Type</span><span class="op" id="4436961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4436966">Value</span><span class="op" id="4436971">:</span>&nbsp;<span class="ident" id="4436973">value</span><span class="op" id="4436978">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4436982">}</span><span class="op" id="4436983">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4436988">if</span>&nbsp;<span class="builtinfunc" id="4436991">len</span><span class="op" id="4436994">(</span><span class="ident" id="4436995">e</span><span class="op" id="4436996">.</span><span class="ident" id="4436997">Type</span><span class="op" id="4437001">)</span>&nbsp;<span class="op" id="4437003">==</span>&nbsp;<span class="num" id="4437006">4</span>&nbsp;<span class="op" id="4437008">&amp;&amp;</span>&nbsp;<span class="ident" id="4437011">e</span><span class="op" id="4437012">.</span><span class="ident" id="4437013">Type</span><span class="op" id="4437017">[</span><span class="num" id="4437018">0</span><span class="op" id="4437019">]</span>&nbsp;<span class="op" id="4437021">==</span>&nbsp;<span class="num" id="4437024">2</span>&nbsp;<span class="op" id="4437026">&amp;&amp;</span>&nbsp;<span class="ident" id="4437029">e</span><span class="op" id="4437030">.</span><span class="ident" id="4437031">Type</span><span class="op" id="4437035">[</span><span class="num" id="4437036">1</span><span class="op" id="4437037">]</span>&nbsp;<span class="op" id="4437039">==</span>&nbsp;<span class="num" id="4437042">5</span>&nbsp;<span class="op" id="4437044">&amp;&amp;</span>&nbsp;<span class="ident" id="4437047">e</span><span class="op" id="4437048">.</span><span class="ident" id="4437049">Type</span><span class="op" id="4437053">[</span><span class="num" id="4437054">2</span><span class="op" id="4437055">]</span>&nbsp;<span class="op" id="4437057">==</span>&nbsp;<span class="num" id="4437060">29</span>&nbsp;<span class="op" id="4437063">{</span><br>
<span class="lineno">1905</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4437068">switch</span>&nbsp;<span class="ident" id="4437075">e</span><span class="op" id="4437076">.</span><span class="ident" id="4437077">Type</span><span class="op" id="4437081">[</span><span class="num" id="4437082">3</span><span class="op" id="4437083">]</span>&nbsp;<span class="op" id="4437085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4437090">case</span>&nbsp;<span class="num" id="4437095">17</span><span class="op" id="4437097">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4437103">out</span><span class="op" id="4437106">.</span><span class="ident" id="4437107">DNSNames</span><span class="op" id="4437115">,</span>&nbsp;<span class="ident" id="4437117">out</span><span class="op" id="4437120">.</span><span class="ident" id="4437121">EmailAddresses</span><span class="op" id="4437135">,</span>&nbsp;<span class="ident" id="4437137">out</span><span class="op" id="4437140">.</span><span class="ident" id="4437141">IPAddresses</span><span class="op" id="4437152">,</span>&nbsp;<span class="ident" id="4437154">err</span>&nbsp;<span class="op" id="4437158">=</span>&nbsp;<span class="ident" id="4437160">parseSANExtension</span><span class="op" id="4437177">(</span><span class="ident" id="4437178">value</span><span class="op" id="4437183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4437189">if</span>&nbsp;<span class="ident" id="4437192">err</span>&nbsp;<span class="op" id="4437196">!=</span>&nbsp;<span class="builtintype" id="4437199">nil</span>&nbsp;<span class="op" id="4437203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4437210">return</span>&nbsp;<span class="builtintype" id="4437217">nil</span><span class="op" id="4437220">,</span>&nbsp;<span class="ident" id="4437222">err</span><br>
<span class="lineno">1910</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4437230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4437235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4437239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4437242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1915</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4437246">return</span>&nbsp;<span class="ident" id="4437253">out</span><span class="op" id="4437256">,</span>&nbsp;<span class="builtintype" id="4437258">nil</span><br>
<span class="lineno"></span><span class="op" id="4437262">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
