<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>compress/gzip</h2>
<ul>
<li><a href="/gostd/compress/gzip/gunzip.go.html" class="current">gunzip.go</a></li>
<li><a href="/gostd/compress/gzip/gunzip_test.go.html">gunzip_test.go</a></li>
<li><a href="/gostd/compress/gzip/gzip.go.html">gzip.go</a></li>
<li><a href="/gostd/compress/gzip/gzip_test.go.html">gzip_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4645007">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4645062">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4645116">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4645167">//&nbsp;Package&nbsp;gzip&nbsp;implements&nbsp;reading&nbsp;and&nbsp;writing&nbsp;of&nbsp;gzip&nbsp;format&nbsp;compressed&nbsp;files,</span><br>
<span class="lineno"></span><span class="comment" id="4645247">//&nbsp;as&nbsp;specified&nbsp;in&nbsp;RFC&nbsp;1952.</span><br>
<span class="lineno"></span><span class="keyword" id="4645276">package</span>&nbsp;<span class="ident" id="4645284">gzip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4645290">import</span>&nbsp;<span class="op" id="4645297">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4645300">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4645309">&#34;compress/flate&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4645327">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4645337">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4645345">&#34;hash/crc32&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4645359">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4645365">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4645372">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4645375">const</span>&nbsp;<span class="op" id="4645381">(</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4645384">gzipID1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4645396">=</span>&nbsp;<span class="num" id="4645398">0x1f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4645404">gzipID2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4645416">=</span>&nbsp;<span class="num" id="4645418">0x8b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4645424">gzipDeflate</span>&nbsp;<span class="op" id="4645436">=</span>&nbsp;<span class="num" id="4645438">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4645441">flagText</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4645453">=</span>&nbsp;<span class="num" id="4645455">1</span>&nbsp;<span class="op" id="4645457">&lt;&lt;</span>&nbsp;<span class="num" id="4645460">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4645463">flagHdrCrc</span>&nbsp;&nbsp;<span class="op" id="4645475">=</span>&nbsp;<span class="num" id="4645477">1</span>&nbsp;<span class="op" id="4645479">&lt;&lt;</span>&nbsp;<span class="num" id="4645482">1</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4645485">flagExtra</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4645497">=</span>&nbsp;<span class="num" id="4645499">1</span>&nbsp;<span class="op" id="4645501">&lt;&lt;</span>&nbsp;<span class="num" id="4645504">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4645507">flagName</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4645519">=</span>&nbsp;<span class="num" id="4645521">1</span>&nbsp;<span class="op" id="4645523">&lt;&lt;</span>&nbsp;<span class="num" id="4645526">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4645529">flagComment</span>&nbsp;<span class="op" id="4645541">=</span>&nbsp;<span class="num" id="4645543">1</span>&nbsp;<span class="op" id="4645545">&lt;&lt;</span>&nbsp;<span class="num" id="4645548">4</span><br>
<span class="lineno"></span><span class="op" id="4645550">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="4645553">func</span>&nbsp;<span class="ident" id="4645558">makeReader</span><span class="op" id="4645568">(</span><span class="ident" id="4645569">r</span>&nbsp;<span class="ident" id="4645571">io</span><span class="op" id="4645573">.</span><span class="ident" id="4645574">Reader</span><span class="op" id="4645580">)</span>&nbsp;<span class="ident" id="4645582">flate</span><span class="op" id="4645587">.</span><span class="ident" id="4645588">Reader</span>&nbsp;<span class="op" id="4645595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4645598">if</span>&nbsp;<span class="ident" id="4645601">rr</span><span class="op" id="4645603">,</span>&nbsp;<span class="ident" id="4645605">ok</span>&nbsp;<span class="op" id="4645608">:=</span>&nbsp;<span class="ident" id="4645611">r</span><span class="op" id="4645612">.</span><span class="op" id="4645613">(</span><span class="ident" id="4645614">flate</span><span class="op" id="4645619">.</span><span class="ident" id="4645620">Reader</span><span class="op" id="4645626">)</span><span class="op" id="4645627">;</span>&nbsp;<span class="ident" id="4645629">ok</span>&nbsp;<span class="op" id="4645632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4645636">return</span>&nbsp;<span class="ident" id="4645643">rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4645647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4645650">return</span>&nbsp;<span class="ident" id="4645657">bufio</span><span class="op" id="4645662">.</span><span class="ident" id="4645663">NewReader</span><span class="op" id="4645672">(</span><span class="ident" id="4645673">r</span><span class="op" id="4645674">)</span><br>
<span class="lineno">35</span><span class="op" id="4645676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4645679">var</span>&nbsp;<span class="op" id="4645683">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4645686">//&nbsp;ErrChecksum&nbsp;is&nbsp;returned&nbsp;when&nbsp;reading&nbsp;GZIP&nbsp;data&nbsp;that&nbsp;has&nbsp;an&nbsp;invalid&nbsp;checksum.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4645767">ErrChecksum</span>&nbsp;<span class="op" id="4645779">=</span>&nbsp;<span class="ident" id="4645781">errors</span><span class="op" id="4645787">.</span><span class="ident" id="4645788">New</span><span class="op" id="4645791">(</span><span class="string" id="4645792">&#34;gzip:&nbsp;invalid&nbsp;checksum&#34;</span><span class="op" id="4645816">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4645819">//&nbsp;ErrHeader&nbsp;is&nbsp;returned&nbsp;when&nbsp;reading&nbsp;GZIP&nbsp;data&nbsp;that&nbsp;has&nbsp;an&nbsp;invalid&nbsp;header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4645896">ErrHeader</span>&nbsp;<span class="op" id="4645906">=</span>&nbsp;<span class="ident" id="4645908">errors</span><span class="op" id="4645914">.</span><span class="ident" id="4645915">New</span><span class="op" id="4645918">(</span><span class="string" id="4645919">&#34;gzip:&nbsp;invalid&nbsp;header&#34;</span><span class="op" id="4645941">)</span><br>
<span class="lineno"></span><span class="op" id="4645943">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4645946">//&nbsp;The&nbsp;gzip&nbsp;file&nbsp;stores&nbsp;a&nbsp;header&nbsp;giving&nbsp;metadata&nbsp;about&nbsp;the&nbsp;compressed&nbsp;file.</span><br>
<span class="lineno">45</span><span class="comment" id="4646022">//&nbsp;That&nbsp;header&nbsp;is&nbsp;exposed&nbsp;as&nbsp;the&nbsp;fields&nbsp;of&nbsp;the&nbsp;Writer&nbsp;and&nbsp;Reader&nbsp;structs.</span><br>
<span class="lineno"></span><span class="keyword" id="4646096">type</span>&nbsp;<span class="ident" id="4646101">Header</span>&nbsp;<span class="keyword" id="4646108">struct</span>&nbsp;<span class="op" id="4646115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4646118">Comment</span>&nbsp;<span class="builtintype" id="4646126">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4646136">//&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4646148">Extra</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4646156">[</span><span class="op" id="4646157">]</span><span class="builtintype" id="4646158">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4646166">//&nbsp;&#34;extra&nbsp;data&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4646183">ModTime</span>&nbsp;<span class="ident" id="4646191">time</span><span class="op" id="4646195">.</span><span class="ident" id="4646196">Time</span>&nbsp;<span class="comment" id="4646201">//&nbsp;modification&nbsp;time</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4646223">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4646231">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4646241">//&nbsp;file&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4646255">OS</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4646263">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4646273">//&nbsp;operating&nbsp;system&nbsp;type</span><br>
<span class="lineno"></span><span class="op" id="4646298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4646301">//&nbsp;A&nbsp;Reader&nbsp;is&nbsp;an&nbsp;io.Reader&nbsp;that&nbsp;can&nbsp;be&nbsp;read&nbsp;to&nbsp;retrieve</span><br>
<span class="lineno">55</span><span class="comment" id="4646358">//&nbsp;uncompressed&nbsp;data&nbsp;from&nbsp;a&nbsp;gzip-format&nbsp;compressed&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="4646415">//</span><br>
<span class="lineno"></span><span class="comment" id="4646418">//&nbsp;In&nbsp;general,&nbsp;a&nbsp;gzip&nbsp;file&nbsp;can&nbsp;be&nbsp;a&nbsp;concatenation&nbsp;of&nbsp;gzip&nbsp;files,</span><br>
<span class="lineno"></span><span class="comment" id="4646483">//&nbsp;each&nbsp;with&nbsp;its&nbsp;own&nbsp;header.&nbsp;&nbsp;Reads&nbsp;from&nbsp;the&nbsp;Reader</span><br>
<span class="lineno"></span><span class="comment" id="4646535">//&nbsp;return&nbsp;the&nbsp;concatenation&nbsp;of&nbsp;the&nbsp;uncompressed&nbsp;data&nbsp;of&nbsp;each.</span><br>
<span class="lineno">60</span><span class="comment" id="4646597">//&nbsp;Only&nbsp;the&nbsp;first&nbsp;header&nbsp;is&nbsp;recorded&nbsp;in&nbsp;the&nbsp;Reader&nbsp;fields.</span><br>
<span class="lineno"></span><span class="comment" id="4646656">//</span><br>
<span class="lineno"></span><span class="comment" id="4646659">//&nbsp;Gzip&nbsp;files&nbsp;store&nbsp;a&nbsp;length&nbsp;and&nbsp;checksum&nbsp;of&nbsp;the&nbsp;uncompressed&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="4646727">//&nbsp;The&nbsp;Reader&nbsp;will&nbsp;return&nbsp;a&nbsp;ErrChecksum&nbsp;when&nbsp;Read</span><br>
<span class="lineno"></span><span class="comment" id="4646777">//&nbsp;reaches&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;uncompressed&nbsp;data&nbsp;if&nbsp;it&nbsp;does&nbsp;not</span><br>
<span class="lineno">65</span><span class="comment" id="4646836">//&nbsp;have&nbsp;the&nbsp;expected&nbsp;length&nbsp;or&nbsp;checksum.&nbsp;&nbsp;Clients&nbsp;should&nbsp;treat&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="4646904">//&nbsp;returned&nbsp;by&nbsp;Read&nbsp;as&nbsp;tentative&nbsp;until&nbsp;they&nbsp;receive&nbsp;the&nbsp;io.EOF</span><br>
<span class="lineno"></span><span class="comment" id="4646967">//&nbsp;marking&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4646999">type</span>&nbsp;<span class="ident" id="4647004">Reader</span>&nbsp;<span class="keyword" id="4647011">struct</span>&nbsp;<span class="op" id="4647018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4647021">Header</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4647029">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4647042">flate</span><span class="op" id="4647047">.</span><span class="ident" id="4647048">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4647056">decompressor</span>&nbsp;<span class="ident" id="4647069">io</span><span class="op" id="4647071">.</span><span class="ident" id="4647072">ReadCloser</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4647084">digest</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4647097">hash</span><span class="op" id="4647101">.</span><span class="ident" id="4647102">Hash32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4647110">size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4647123">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4647131">flg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4647144">byte</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4647150">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4647163">[</span><span class="num" id="4647164">512</span><span class="op" id="4647167">]</span><span class="builtintype" id="4647168">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4647174">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4647187">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4647194">multistream</span>&nbsp;&nbsp;<span class="builtintype" id="4647207">bool</span><br>
<span class="lineno"></span><span class="op" id="4647212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="4647215">//&nbsp;NewReader&nbsp;creates&nbsp;a&nbsp;new&nbsp;Reader&nbsp;reading&nbsp;the&nbsp;given&nbsp;reader.</span><br>
<span class="lineno"></span><span class="comment" id="4647275">//&nbsp;If&nbsp;r&nbsp;does&nbsp;not&nbsp;also&nbsp;implement&nbsp;io.ByteReader,</span><br>
<span class="lineno"></span><span class="comment" id="4647322">//&nbsp;the&nbsp;decompressor&nbsp;may&nbsp;read&nbsp;more&nbsp;data&nbsp;than&nbsp;necessary&nbsp;from&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="4647384">//&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;call&nbsp;Close&nbsp;on&nbsp;the&nbsp;Reader&nbsp;when&nbsp;done.</span><br>
<span class="lineno"></span><span class="keyword" id="4647460">func</span>&nbsp;<span class="ident" id="4647465">NewReader</span><span class="op" id="4647474">(</span><span class="ident" id="4647475">r</span>&nbsp;<span class="ident" id="4647477">io</span><span class="op" id="4647479">.</span><span class="ident" id="4647480">Reader</span><span class="op" id="4647486">)</span>&nbsp;<span class="op" id="4647488">(</span><span class="op" id="4647489">*</span><span class="ident" id="4647490">Reader</span><span class="op" id="4647496">,</span>&nbsp;<span class="builtintype" id="4647498">error</span><span class="op" id="4647503">)</span>&nbsp;<span class="op" id="4647505">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4647508">z</span>&nbsp;<span class="op" id="4647510">:=</span>&nbsp;<span class="builtinfunc" id="4647513">new</span><span class="op" id="4647516">(</span><span class="ident" id="4647517">Reader</span><span class="op" id="4647523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4647526">z</span><span class="op" id="4647527">.</span><span class="ident" id="4647528">r</span>&nbsp;<span class="op" id="4647530">=</span>&nbsp;<span class="ident" id="4647532">makeReader</span><span class="op" id="4647542">(</span><span class="ident" id="4647543">r</span><span class="op" id="4647544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4647547">z</span><span class="op" id="4647548">.</span><span class="ident" id="4647549">multistream</span>&nbsp;<span class="op" id="4647561">=</span>&nbsp;<span class="builtintype" id="4647563">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4647569">z</span><span class="op" id="4647570">.</span><span class="ident" id="4647571">digest</span>&nbsp;<span class="op" id="4647578">=</span>&nbsp;<span class="ident" id="4647580">crc32</span><span class="op" id="4647585">.</span><span class="ident" id="4647586">NewIEEE</span><span class="op" id="4647593">(</span><span class="op" id="4647594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4647597">if</span>&nbsp;<span class="ident" id="4647600">err</span>&nbsp;<span class="op" id="4647604">:=</span>&nbsp;<span class="ident" id="4647607">z</span><span class="op" id="4647608">.</span><span class="ident" id="4647609">readHeader</span><span class="op" id="4647619">(</span><span class="builtintype" id="4647620">true</span><span class="op" id="4647624">)</span><span class="op" id="4647625">;</span>&nbsp;<span class="ident" id="4647627">err</span>&nbsp;<span class="op" id="4647631">!=</span>&nbsp;<span class="builtintype" id="4647634">nil</span>&nbsp;<span class="op" id="4647638">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4647642">return</span>&nbsp;<span class="builtintype" id="4647649">nil</span><span class="op" id="4647652">,</span>&nbsp;<span class="ident" id="4647654">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4647659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4647662">return</span>&nbsp;<span class="ident" id="4647669">z</span><span class="op" id="4647670">,</span>&nbsp;<span class="builtintype" id="4647672">nil</span><br>
<span class="lineno"></span><span class="op" id="4647676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="4647679">//&nbsp;Reset&nbsp;discards&nbsp;the&nbsp;Reader&nbsp;z&#39;s&nbsp;state&nbsp;and&nbsp;makes&nbsp;it&nbsp;equivalent&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4647749">//&nbsp;result&nbsp;of&nbsp;its&nbsp;original&nbsp;state&nbsp;from&nbsp;NewReader,&nbsp;but&nbsp;reading&nbsp;from&nbsp;r&nbsp;instead.</span><br>
<span class="lineno"></span><span class="comment" id="4647825">//&nbsp;This&nbsp;permits&nbsp;reusing&nbsp;a&nbsp;Reader&nbsp;rather&nbsp;than&nbsp;allocating&nbsp;a&nbsp;new&nbsp;one.</span><br>
<span class="lineno"></span><span class="keyword" id="4647892">func</span>&nbsp;<span class="op" id="4647897">(</span><span class="ident" id="4647898">z</span>&nbsp;<span class="op" id="4647900">*</span><span class="ident" id="4647901">Reader</span><span class="op" id="4647907">)</span>&nbsp;<span class="ident" id="4647909">Reset</span><span class="op" id="4647914">(</span><span class="ident" id="4647915">r</span>&nbsp;<span class="ident" id="4647917">io</span><span class="op" id="4647919">.</span><span class="ident" id="4647920">Reader</span><span class="op" id="4647926">)</span>&nbsp;<span class="builtintype" id="4647928">error</span>&nbsp;<span class="op" id="4647934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4647937">z</span><span class="op" id="4647938">.</span><span class="ident" id="4647939">r</span>&nbsp;<span class="op" id="4647941">=</span>&nbsp;<span class="ident" id="4647943">makeReader</span><span class="op" id="4647953">(</span><span class="ident" id="4647954">r</span><span class="op" id="4647955">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4647958">if</span>&nbsp;<span class="ident" id="4647961">z</span><span class="op" id="4647962">.</span><span class="ident" id="4647963">digest</span>&nbsp;<span class="op" id="4647970">==</span>&nbsp;<span class="builtintype" id="4647973">nil</span>&nbsp;<span class="op" id="4647977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4647981">z</span><span class="op" id="4647982">.</span><span class="ident" id="4647983">digest</span>&nbsp;<span class="op" id="4647990">=</span>&nbsp;<span class="ident" id="4647992">crc32</span><span class="op" id="4647997">.</span><span class="ident" id="4647998">NewIEEE</span><span class="op" id="4648005">(</span><span class="op" id="4648006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4648009">}</span>&nbsp;<span class="keyword" id="4648011">else</span>&nbsp;<span class="op" id="4648016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648020">z</span><span class="op" id="4648021">.</span><span class="ident" id="4648022">digest</span><span class="op" id="4648028">.</span><span class="ident" id="4648029">Reset</span><span class="op" id="4648034">(</span><span class="op" id="4648035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4648038">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648041">z</span><span class="op" id="4648042">.</span><span class="ident" id="4648043">size</span>&nbsp;<span class="op" id="4648048">=</span>&nbsp;<span class="num" id="4648050">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648053">z</span><span class="op" id="4648054">.</span><span class="ident" id="4648055">err</span>&nbsp;<span class="op" id="4648059">=</span>&nbsp;<span class="builtintype" id="4648061">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4648066">z</span><span class="op" id="4648067">.</span><span class="ident" id="4648068">multistream</span>&nbsp;<span class="op" id="4648080">=</span>&nbsp;<span class="builtintype" id="4648082">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4648088">return</span>&nbsp;<span class="ident" id="4648095">z</span><span class="op" id="4648096">.</span><span class="ident" id="4648097">readHeader</span><span class="op" id="4648107">(</span><span class="builtintype" id="4648108">true</span><span class="op" id="4648112">)</span><br>
<span class="lineno"></span><span class="op" id="4648114">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="4648117">//&nbsp;Multistream&nbsp;controls&nbsp;whether&nbsp;the&nbsp;reader&nbsp;supports&nbsp;multistream&nbsp;files.</span><br>
<span class="lineno"></span><span class="comment" id="4648188">//</span><br>
<span class="lineno"></span><span class="comment" id="4648191">//&nbsp;If&nbsp;enabled&nbsp;(the&nbsp;default),&nbsp;the&nbsp;Reader&nbsp;expects&nbsp;the&nbsp;input&nbsp;to&nbsp;be&nbsp;a&nbsp;sequence</span><br>
<span class="lineno"></span><span class="comment" id="4648266">//&nbsp;of&nbsp;individually&nbsp;gzipped&nbsp;data&nbsp;streams,&nbsp;each&nbsp;with&nbsp;its&nbsp;own&nbsp;header&nbsp;and</span><br>
<span class="lineno">115</span><span class="comment" id="4648336">//&nbsp;trailer,&nbsp;ending&nbsp;at&nbsp;EOF.&nbsp;The&nbsp;effect&nbsp;is&nbsp;that&nbsp;the&nbsp;concatenation&nbsp;of&nbsp;a&nbsp;sequence</span><br>
<span class="lineno"></span><span class="comment" id="4648414">//&nbsp;of&nbsp;gzipped&nbsp;files&nbsp;is&nbsp;treated&nbsp;as&nbsp;equivalent&nbsp;to&nbsp;the&nbsp;gzip&nbsp;of&nbsp;the&nbsp;concatenation</span><br>
<span class="lineno"></span><span class="comment" id="4648492">//&nbsp;of&nbsp;the&nbsp;sequence.&nbsp;This&nbsp;is&nbsp;standard&nbsp;behavior&nbsp;for&nbsp;gzip&nbsp;readers.</span><br>
<span class="lineno"></span><span class="comment" id="4648556">//</span><br>
<span class="lineno"></span><span class="comment" id="4648559">//&nbsp;Calling&nbsp;Multistream(false)&nbsp;disables&nbsp;this&nbsp;behavior;&nbsp;disabling&nbsp;the&nbsp;behavior</span><br>
<span class="lineno">120</span><span class="comment" id="4648636">//&nbsp;can&nbsp;be&nbsp;useful&nbsp;when&nbsp;reading&nbsp;file&nbsp;formats&nbsp;that&nbsp;distinguish&nbsp;individual&nbsp;gzip</span><br>
<span class="lineno"></span><span class="comment" id="4648712">//&nbsp;data&nbsp;streams&nbsp;or&nbsp;mix&nbsp;gzip&nbsp;data&nbsp;streams&nbsp;with&nbsp;other&nbsp;data&nbsp;streams.</span><br>
<span class="lineno"></span><span class="comment" id="4648778">//&nbsp;In&nbsp;this&nbsp;mode,&nbsp;when&nbsp;the&nbsp;Reader&nbsp;reaches&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;data&nbsp;stream,</span><br>
<span class="lineno"></span><span class="comment" id="4648847">//&nbsp;Read&nbsp;returns&nbsp;io.EOF.&nbsp;If&nbsp;the&nbsp;underlying&nbsp;reader&nbsp;implements&nbsp;io.ByteReader,</span><br>
<span class="lineno"></span><span class="comment" id="4648922">//&nbsp;it&nbsp;will&nbsp;be&nbsp;left&nbsp;positioned&nbsp;just&nbsp;after&nbsp;the&nbsp;gzip&nbsp;stream.</span><br>
<span class="lineno">125</span><span class="comment" id="4648980">//&nbsp;To&nbsp;start&nbsp;the&nbsp;next&nbsp;stream,&nbsp;call&nbsp;z.Reset(r)&nbsp;followed&nbsp;by&nbsp;z.Multistream(false).</span><br>
<span class="lineno"></span><span class="comment" id="4649059">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;next&nbsp;stream,&nbsp;z.Reset(r)&nbsp;will&nbsp;return&nbsp;io.EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="4649121">func</span>&nbsp;<span class="op" id="4649126">(</span><span class="ident" id="4649127">z</span>&nbsp;<span class="op" id="4649129">*</span><span class="ident" id="4649130">Reader</span><span class="op" id="4649136">)</span>&nbsp;<span class="ident" id="4649138">Multistream</span><span class="op" id="4649149">(</span><span class="ident" id="4649150">ok</span>&nbsp;<span class="builtintype" id="4649153">bool</span><span class="op" id="4649157">)</span>&nbsp;<span class="op" id="4649159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4649162">z</span><span class="op" id="4649163">.</span><span class="ident" id="4649164">multistream</span>&nbsp;<span class="op" id="4649176">=</span>&nbsp;<span class="ident" id="4649178">ok</span><br>
<span class="lineno"></span><span class="op" id="4649181">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="4649184">//&nbsp;GZIP&nbsp;(RFC&nbsp;1952)&nbsp;is&nbsp;little-endian,&nbsp;unlike&nbsp;ZLIB&nbsp;(RFC&nbsp;1950).</span><br>
<span class="lineno"></span><span class="keyword" id="4649245">func</span>&nbsp;<span class="ident" id="4649250">get4</span><span class="op" id="4649254">(</span><span class="ident" id="4649255">p</span>&nbsp;<span class="op" id="4649257">[</span><span class="op" id="4649258">]</span><span class="builtintype" id="4649259">byte</span><span class="op" id="4649263">)</span>&nbsp;<span class="builtintype" id="4649265">uint32</span>&nbsp;<span class="op" id="4649272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4649275">return</span>&nbsp;<span class="builtintype" id="4649282">uint32</span><span class="op" id="4649288">(</span><span class="ident" id="4649289">p</span><span class="op" id="4649290">[</span><span class="num" id="4649291">0</span><span class="op" id="4649292">]</span><span class="op" id="4649293">)</span>&nbsp;<span class="op" id="4649295">|</span>&nbsp;<span class="builtintype" id="4649297">uint32</span><span class="op" id="4649303">(</span><span class="ident" id="4649304">p</span><span class="op" id="4649305">[</span><span class="num" id="4649306">1</span><span class="op" id="4649307">]</span><span class="op" id="4649308">)</span><span class="op" id="4649309">&lt;&lt;</span><span class="num" id="4649311">8</span>&nbsp;<span class="op" id="4649313">|</span>&nbsp;<span class="builtintype" id="4649315">uint32</span><span class="op" id="4649321">(</span><span class="ident" id="4649322">p</span><span class="op" id="4649323">[</span><span class="num" id="4649324">2</span><span class="op" id="4649325">]</span><span class="op" id="4649326">)</span><span class="op" id="4649327">&lt;&lt;</span><span class="num" id="4649329">16</span>&nbsp;<span class="op" id="4649332">|</span>&nbsp;<span class="builtintype" id="4649334">uint32</span><span class="op" id="4649340">(</span><span class="ident" id="4649341">p</span><span class="op" id="4649342">[</span><span class="num" id="4649343">3</span><span class="op" id="4649344">]</span><span class="op" id="4649345">)</span><span class="op" id="4649346">&lt;&lt;</span><span class="num" id="4649348">24</span><br>
<span class="lineno"></span><span class="op" id="4649351">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="keyword" id="4649354">func</span>&nbsp;<span class="op" id="4649359">(</span><span class="ident" id="4649360">z</span>&nbsp;<span class="op" id="4649362">*</span><span class="ident" id="4649363">Reader</span><span class="op" id="4649369">)</span>&nbsp;<span class="ident" id="4649371">readString</span><span class="op" id="4649381">(</span><span class="op" id="4649382">)</span>&nbsp;<span class="op" id="4649384">(</span><span class="builtintype" id="4649385">string</span><span class="op" id="4649391">,</span>&nbsp;<span class="builtintype" id="4649393">error</span><span class="op" id="4649398">)</span>&nbsp;<span class="op" id="4649400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4649403">var</span>&nbsp;<span class="ident" id="4649407">err</span>&nbsp;<span class="builtintype" id="4649411">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4649418">needconv</span>&nbsp;<span class="op" id="4649427">:=</span>&nbsp;<span class="builtintype" id="4649430">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4649437">for</span>&nbsp;<span class="ident" id="4649441">i</span>&nbsp;<span class="op" id="4649443">:=</span>&nbsp;<span class="num" id="4649446">0</span><span class="op" id="4649447">;</span>&nbsp;<span class="op" id="4649449">;</span>&nbsp;<span class="ident" id="4649451">i</span><span class="op" id="4649452">++</span>&nbsp;<span class="op" id="4649455">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4649459">if</span>&nbsp;<span class="ident" id="4649462">i</span>&nbsp;<span class="op" id="4649464">&gt;=</span>&nbsp;<span class="builtinfunc" id="4649467">len</span><span class="op" id="4649470">(</span><span class="ident" id="4649471">z</span><span class="op" id="4649472">.</span><span class="ident" id="4649473">buf</span><span class="op" id="4649476">)</span>&nbsp;<span class="op" id="4649478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4649483">return</span>&nbsp;<span class="string" id="4649490">&#34;&#34;</span><span class="op" id="4649492">,</span>&nbsp;<span class="ident" id="4649494">ErrHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4649506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4649510">z</span><span class="op" id="4649511">.</span><span class="ident" id="4649512">buf</span><span class="op" id="4649515">[</span><span class="ident" id="4649516">i</span><span class="op" id="4649517">]</span><span class="op" id="4649518">,</span>&nbsp;<span class="ident" id="4649520">err</span>&nbsp;<span class="op" id="4649524">=</span>&nbsp;<span class="ident" id="4649526">z</span><span class="op" id="4649527">.</span><span class="ident" id="4649528">r</span><span class="op" id="4649529">.</span><span class="ident" id="4649530">ReadByte</span><span class="op" id="4649538">(</span><span class="op" id="4649539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4649543">if</span>&nbsp;<span class="ident" id="4649546">err</span>&nbsp;<span class="op" id="4649550">!=</span>&nbsp;<span class="builtintype" id="4649553">nil</span>&nbsp;<span class="op" id="4649557">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4649562">return</span>&nbsp;<span class="string" id="4649569">&#34;&#34;</span><span class="op" id="4649571">,</span>&nbsp;<span class="ident" id="4649573">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4649579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4649583">if</span>&nbsp;<span class="ident" id="4649586">z</span><span class="op" id="4649587">.</span><span class="ident" id="4649588">buf</span><span class="op" id="4649591">[</span><span class="ident" id="4649592">i</span><span class="op" id="4649593">]</span>&nbsp;<span class="op" id="4649595">&gt;</span>&nbsp;<span class="num" id="4649597">0x7f</span>&nbsp;<span class="op" id="4649602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4649607">needconv</span>&nbsp;<span class="op" id="4649616">=</span>&nbsp;<span class="builtintype" id="4649618">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4649625">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4649629">if</span>&nbsp;<span class="ident" id="4649632">z</span><span class="op" id="4649633">.</span><span class="ident" id="4649634">buf</span><span class="op" id="4649637">[</span><span class="ident" id="4649638">i</span><span class="op" id="4649639">]</span>&nbsp;<span class="op" id="4649641">==</span>&nbsp;<span class="num" id="4649644">0</span>&nbsp;<span class="op" id="4649646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4649651">//&nbsp;GZIP&nbsp;(RFC&nbsp;1952)&nbsp;specifies&nbsp;that&nbsp;strings&nbsp;are&nbsp;NUL-terminated&nbsp;ISO&nbsp;8859-1&nbsp;(Latin-1).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4649737">if</span>&nbsp;<span class="ident" id="4649740">needconv</span>&nbsp;<span class="op" id="4649749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4649755">s</span>&nbsp;<span class="op" id="4649757">:=</span>&nbsp;<span class="builtinfunc" id="4649760">make</span><span class="op" id="4649764">(</span><span class="op" id="4649765">[</span><span class="op" id="4649766">]</span><span class="builtintype" id="4649767">rune</span><span class="op" id="4649771">,</span>&nbsp;<span class="num" id="4649773">0</span><span class="op" id="4649774">,</span>&nbsp;<span class="ident" id="4649776">i</span><span class="op" id="4649777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4649783">for</span>&nbsp;<span class="ident" id="4649787">_</span><span class="op" id="4649788">,</span>&nbsp;<span class="ident" id="4649790">v</span>&nbsp;<span class="op" id="4649792">:=</span>&nbsp;<span class="keyword" id="4649795">range</span>&nbsp;<span class="ident" id="4649801">z</span><span class="op" id="4649802">.</span><span class="ident" id="4649803">buf</span><span class="op" id="4649806">[</span><span class="num" id="4649807">0</span><span class="op" id="4649808">:</span><span class="ident" id="4649809">i</span><span class="op" id="4649810">]</span>&nbsp;<span class="op" id="4649812">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4649819">s</span>&nbsp;<span class="op" id="4649821">=</span>&nbsp;<span class="builtinfunc" id="4649823">append</span><span class="op" id="4649829">(</span><span class="ident" id="4649830">s</span><span class="op" id="4649831">,</span>&nbsp;<span class="builtintype" id="4649833">rune</span><span class="op" id="4649837">(</span><span class="ident" id="4649838">v</span><span class="op" id="4649839">)</span><span class="op" id="4649840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4649846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4649852">return</span>&nbsp;<span class="builtintype" id="4649859">string</span><span class="op" id="4649865">(</span><span class="ident" id="4649866">s</span><span class="op" id="4649867">)</span><span class="op" id="4649868">,</span>&nbsp;<span class="builtintype" id="4649870">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4649877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4649882">return</span>&nbsp;<span class="builtintype" id="4649889">string</span><span class="op" id="4649895">(</span><span class="ident" id="4649896">z</span><span class="op" id="4649897">.</span><span class="ident" id="4649898">buf</span><span class="op" id="4649901">[</span><span class="num" id="4649902">0</span><span class="op" id="4649903">:</span><span class="ident" id="4649904">i</span><span class="op" id="4649905">]</span><span class="op" id="4649906">)</span><span class="op" id="4649907">,</span>&nbsp;<span class="builtintype" id="4649909">nil</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4649915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4649918">}</span><br>
<span class="lineno"></span><span class="op" id="4649920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4649923">func</span>&nbsp;<span class="op" id="4649928">(</span><span class="ident" id="4649929">z</span>&nbsp;<span class="op" id="4649931">*</span><span class="ident" id="4649932">Reader</span><span class="op" id="4649938">)</span>&nbsp;<span class="ident" id="4649940">read2</span><span class="op" id="4649945">(</span><span class="op" id="4649946">)</span>&nbsp;<span class="op" id="4649948">(</span><span class="builtintype" id="4649949">uint32</span><span class="op" id="4649955">,</span>&nbsp;<span class="builtintype" id="4649957">error</span><span class="op" id="4649962">)</span>&nbsp;<span class="op" id="4649964">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4649967">_</span><span class="op" id="4649968">,</span>&nbsp;<span class="ident" id="4649970">err</span>&nbsp;<span class="op" id="4649974">:=</span>&nbsp;<span class="ident" id="4649977">io</span><span class="op" id="4649979">.</span><span class="ident" id="4649980">ReadFull</span><span class="op" id="4649988">(</span><span class="ident" id="4649989">z</span><span class="op" id="4649990">.</span><span class="ident" id="4649991">r</span><span class="op" id="4649992">,</span>&nbsp;<span class="ident" id="4649994">z</span><span class="op" id="4649995">.</span><span class="ident" id="4649996">buf</span><span class="op" id="4649999">[</span><span class="num" id="4650000">0</span><span class="op" id="4650001">:</span><span class="num" id="4650002">2</span><span class="op" id="4650003">]</span><span class="op" id="4650004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4650007">if</span>&nbsp;<span class="ident" id="4650010">err</span>&nbsp;<span class="op" id="4650014">!=</span>&nbsp;<span class="builtintype" id="4650017">nil</span>&nbsp;<span class="op" id="4650021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4650025">return</span>&nbsp;<span class="num" id="4650032">0</span><span class="op" id="4650033">,</span>&nbsp;<span class="ident" id="4650035">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4650040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4650043">return</span>&nbsp;<span class="builtintype" id="4650050">uint32</span><span class="op" id="4650056">(</span><span class="ident" id="4650057">z</span><span class="op" id="4650058">.</span><span class="ident" id="4650059">buf</span><span class="op" id="4650062">[</span><span class="num" id="4650063">0</span><span class="op" id="4650064">]</span><span class="op" id="4650065">)</span>&nbsp;<span class="op" id="4650067">|</span>&nbsp;<span class="builtintype" id="4650069">uint32</span><span class="op" id="4650075">(</span><span class="ident" id="4650076">z</span><span class="op" id="4650077">.</span><span class="ident" id="4650078">buf</span><span class="op" id="4650081">[</span><span class="num" id="4650082">1</span><span class="op" id="4650083">]</span><span class="op" id="4650084">)</span><span class="op" id="4650085">&lt;&lt;</span><span class="num" id="4650087">8</span><span class="op" id="4650088">,</span>&nbsp;<span class="builtintype" id="4650090">nil</span><br>
<span class="lineno">170</span><span class="op" id="4650094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4650097">func</span>&nbsp;<span class="op" id="4650102">(</span><span class="ident" id="4650103">z</span>&nbsp;<span class="op" id="4650105">*</span><span class="ident" id="4650106">Reader</span><span class="op" id="4650112">)</span>&nbsp;<span class="ident" id="4650114">readHeader</span><span class="op" id="4650124">(</span><span class="ident" id="4650125">save</span>&nbsp;<span class="builtintype" id="4650130">bool</span><span class="op" id="4650134">)</span>&nbsp;<span class="builtintype" id="4650136">error</span>&nbsp;<span class="op" id="4650142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4650145">_</span><span class="op" id="4650146">,</span>&nbsp;<span class="ident" id="4650148">err</span>&nbsp;<span class="op" id="4650152">:=</span>&nbsp;<span class="ident" id="4650155">io</span><span class="op" id="4650157">.</span><span class="ident" id="4650158">ReadFull</span><span class="op" id="4650166">(</span><span class="ident" id="4650167">z</span><span class="op" id="4650168">.</span><span class="ident" id="4650169">r</span><span class="op" id="4650170">,</span>&nbsp;<span class="ident" id="4650172">z</span><span class="op" id="4650173">.</span><span class="ident" id="4650174">buf</span><span class="op" id="4650177">[</span><span class="num" id="4650178">0</span><span class="op" id="4650179">:</span><span class="num" id="4650180">10</span><span class="op" id="4650182">]</span><span class="op" id="4650183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4650186">if</span>&nbsp;<span class="ident" id="4650189">err</span>&nbsp;<span class="op" id="4650193">!=</span>&nbsp;<span class="builtintype" id="4650196">nil</span>&nbsp;<span class="op" id="4650200">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4650204">return</span>&nbsp;<span class="ident" id="4650211">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4650216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4650219">if</span>&nbsp;<span class="ident" id="4650222">z</span><span class="op" id="4650223">.</span><span class="ident" id="4650224">buf</span><span class="op" id="4650227">[</span><span class="num" id="4650228">0</span><span class="op" id="4650229">]</span>&nbsp;<span class="op" id="4650231">!=</span>&nbsp;<span class="ident" id="4650234">gzipID1</span>&nbsp;<span class="op" id="4650242">||</span>&nbsp;<span class="ident" id="4650245">z</span><span class="op" id="4650246">.</span><span class="ident" id="4650247">buf</span><span class="op" id="4650250">[</span><span class="num" id="4650251">1</span><span class="op" id="4650252">]</span>&nbsp;<span class="op" id="4650254">!=</span>&nbsp;<span class="ident" id="4650257">gzipID2</span>&nbsp;<span class="op" id="4650265">||</span>&nbsp;<span class="ident" id="4650268">z</span><span class="op" id="4650269">.</span><span class="ident" id="4650270">buf</span><span class="op" id="4650273">[</span><span class="num" id="4650274">2</span><span class="op" id="4650275">]</span>&nbsp;<span class="op" id="4650277">!=</span>&nbsp;<span class="ident" id="4650280">gzipDeflate</span>&nbsp;<span class="op" id="4650292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4650296">return</span>&nbsp;<span class="ident" id="4650303">ErrHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4650314">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4650317">z</span><span class="op" id="4650318">.</span><span class="ident" id="4650319">flg</span>&nbsp;<span class="op" id="4650323">=</span>&nbsp;<span class="ident" id="4650325">z</span><span class="op" id="4650326">.</span><span class="ident" id="4650327">buf</span><span class="op" id="4650330">[</span><span class="num" id="4650331">3</span><span class="op" id="4650332">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4650335">if</span>&nbsp;<span class="ident" id="4650338">save</span>&nbsp;<span class="op" id="4650343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4650347">z</span><span class="op" id="4650348">.</span><span class="ident" id="4650349">ModTime</span>&nbsp;<span class="op" id="4650357">=</span>&nbsp;<span class="ident" id="4650359">time</span><span class="op" id="4650363">.</span><span class="ident" id="4650364">Unix</span><span class="op" id="4650368">(</span><span class="builtintype" id="4650369">int64</span><span class="op" id="4650374">(</span><span class="ident" id="4650375">get4</span><span class="op" id="4650379">(</span><span class="ident" id="4650380">z</span><span class="op" id="4650381">.</span><span class="ident" id="4650382">buf</span><span class="op" id="4650385">[</span><span class="num" id="4650386">4</span><span class="op" id="4650387">:</span><span class="num" id="4650388">8</span><span class="op" id="4650389">]</span><span class="op" id="4650390">)</span><span class="op" id="4650391">)</span><span class="op" id="4650392">,</span>&nbsp;<span class="num" id="4650394">0</span><span class="op" id="4650395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4650399">//&nbsp;z.buf[8]&nbsp;is&nbsp;xfl,&nbsp;ignored</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4650429">z</span><span class="op" id="4650430">.</span><span class="ident" id="4650431">OS</span>&nbsp;<span class="op" id="4650434">=</span>&nbsp;<span class="ident" id="4650436">z</span><span class="op" id="4650437">.</span><span class="ident" id="4650438">buf</span><span class="op" id="4650441">[</span><span class="num" id="4650442">9</span><span class="op" id="4650443">]</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4650446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4650449">z</span><span class="op" id="4650450">.</span><span class="ident" id="4650451">digest</span><span class="op" id="4650457">.</span><span class="ident" id="4650458">Reset</span><span class="op" id="4650463">(</span><span class="op" id="4650464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4650467">z</span><span class="op" id="4650468">.</span><span class="ident" id="4650469">digest</span><span class="op" id="4650475">.</span><span class="ident" id="4650476">Write</span><span class="op" id="4650481">(</span><span class="ident" id="4650482">z</span><span class="op" id="4650483">.</span><span class="ident" id="4650484">buf</span><span class="op" id="4650487">[</span><span class="num" id="4650488">0</span><span class="op" id="4650489">:</span><span class="num" id="4650490">10</span><span class="op" id="4650492">]</span><span class="op" id="4650493">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4650497">if</span>&nbsp;<span class="ident" id="4650500">z</span><span class="op" id="4650501">.</span><span class="ident" id="4650502">flg</span><span class="op" id="4650505">&amp;</span><span class="ident" id="4650506">flagExtra</span>&nbsp;<span class="op" id="4650516">!=</span>&nbsp;<span class="num" id="4650519">0</span>&nbsp;<span class="op" id="4650521">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4650525">n</span><span class="op" id="4650526">,</span>&nbsp;<span class="ident" id="4650528">err</span>&nbsp;<span class="op" id="4650532">:=</span>&nbsp;<span class="ident" id="4650535">z</span><span class="op" id="4650536">.</span><span class="ident" id="4650537">read2</span><span class="op" id="4650542">(</span><span class="op" id="4650543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4650547">if</span>&nbsp;<span class="ident" id="4650550">err</span>&nbsp;<span class="op" id="4650554">!=</span>&nbsp;<span class="builtintype" id="4650557">nil</span>&nbsp;<span class="op" id="4650561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4650566">return</span>&nbsp;<span class="ident" id="4650573">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4650579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4650583">data</span>&nbsp;<span class="op" id="4650588">:=</span>&nbsp;<span class="builtinfunc" id="4650591">make</span><span class="op" id="4650595">(</span><span class="op" id="4650596">[</span><span class="op" id="4650597">]</span><span class="builtintype" id="4650598">byte</span><span class="op" id="4650602">,</span>&nbsp;<span class="ident" id="4650604">n</span><span class="op" id="4650605">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4650609">if</span>&nbsp;<span class="ident" id="4650612">_</span><span class="op" id="4650613">,</span>&nbsp;<span class="ident" id="4650615">err</span>&nbsp;<span class="op" id="4650619">=</span>&nbsp;<span class="ident" id="4650621">io</span><span class="op" id="4650623">.</span><span class="ident" id="4650624">ReadFull</span><span class="op" id="4650632">(</span><span class="ident" id="4650633">z</span><span class="op" id="4650634">.</span><span class="ident" id="4650635">r</span><span class="op" id="4650636">,</span>&nbsp;<span class="ident" id="4650638">data</span><span class="op" id="4650642">)</span><span class="op" id="4650643">;</span>&nbsp;<span class="ident" id="4650645">err</span>&nbsp;<span class="op" id="4650649">!=</span>&nbsp;<span class="builtintype" id="4650652">nil</span>&nbsp;<span class="op" id="4650656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4650661">return</span>&nbsp;<span class="ident" id="4650668">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4650674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4650678">if</span>&nbsp;<span class="ident" id="4650681">save</span>&nbsp;<span class="op" id="4650686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4650691">z</span><span class="op" id="4650692">.</span><span class="ident" id="4650693">Extra</span>&nbsp;<span class="op" id="4650699">=</span>&nbsp;<span class="ident" id="4650701">data</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4650708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4650711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4650715">var</span>&nbsp;<span class="ident" id="4650719">s</span>&nbsp;<span class="builtintype" id="4650721">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4650729">if</span>&nbsp;<span class="ident" id="4650732">z</span><span class="op" id="4650733">.</span><span class="ident" id="4650734">flg</span><span class="op" id="4650737">&amp;</span><span class="ident" id="4650738">flagName</span>&nbsp;<span class="op" id="4650747">!=</span>&nbsp;<span class="num" id="4650750">0</span>&nbsp;<span class="op" id="4650752">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4650756">if</span>&nbsp;<span class="ident" id="4650759">s</span><span class="op" id="4650760">,</span>&nbsp;<span class="ident" id="4650762">err</span>&nbsp;<span class="op" id="4650766">=</span>&nbsp;<span class="ident" id="4650768">z</span><span class="op" id="4650769">.</span><span class="ident" id="4650770">readString</span><span class="op" id="4650780">(</span><span class="op" id="4650781">)</span><span class="op" id="4650782">;</span>&nbsp;<span class="ident" id="4650784">err</span>&nbsp;<span class="op" id="4650788">!=</span>&nbsp;<span class="builtintype" id="4650791">nil</span>&nbsp;<span class="op" id="4650795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4650800">return</span>&nbsp;<span class="ident" id="4650807">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4650813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4650817">if</span>&nbsp;<span class="ident" id="4650820">save</span>&nbsp;<span class="op" id="4650825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4650830">z</span><span class="op" id="4650831">.</span><span class="ident" id="4650832">Name</span>&nbsp;<span class="op" id="4650837">=</span>&nbsp;<span class="ident" id="4650839">s</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4650843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4650846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4650850">if</span>&nbsp;<span class="ident" id="4650853">z</span><span class="op" id="4650854">.</span><span class="ident" id="4650855">flg</span><span class="op" id="4650858">&amp;</span><span class="ident" id="4650859">flagComment</span>&nbsp;<span class="op" id="4650871">!=</span>&nbsp;<span class="num" id="4650874">0</span>&nbsp;<span class="op" id="4650876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4650880">if</span>&nbsp;<span class="ident" id="4650883">s</span><span class="op" id="4650884">,</span>&nbsp;<span class="ident" id="4650886">err</span>&nbsp;<span class="op" id="4650890">=</span>&nbsp;<span class="ident" id="4650892">z</span><span class="op" id="4650893">.</span><span class="ident" id="4650894">readString</span><span class="op" id="4650904">(</span><span class="op" id="4650905">)</span><span class="op" id="4650906">;</span>&nbsp;<span class="ident" id="4650908">err</span>&nbsp;<span class="op" id="4650912">!=</span>&nbsp;<span class="builtintype" id="4650915">nil</span>&nbsp;<span class="op" id="4650919">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4650924">return</span>&nbsp;<span class="ident" id="4650931">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4650937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4650941">if</span>&nbsp;<span class="ident" id="4650944">save</span>&nbsp;<span class="op" id="4650949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4650954">z</span><span class="op" id="4650955">.</span><span class="ident" id="4650956">Comment</span>&nbsp;<span class="op" id="4650964">=</span>&nbsp;<span class="ident" id="4650966">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4650970">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4650973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4650977">if</span>&nbsp;<span class="ident" id="4650980">z</span><span class="op" id="4650981">.</span><span class="ident" id="4650982">flg</span><span class="op" id="4650985">&amp;</span><span class="ident" id="4650986">flagHdrCrc</span>&nbsp;<span class="op" id="4650997">!=</span>&nbsp;<span class="num" id="4651000">0</span>&nbsp;<span class="op" id="4651002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4651006">n</span><span class="op" id="4651007">,</span>&nbsp;<span class="ident" id="4651009">err</span>&nbsp;<span class="op" id="4651013">:=</span>&nbsp;<span class="ident" id="4651016">z</span><span class="op" id="4651017">.</span><span class="ident" id="4651018">read2</span><span class="op" id="4651023">(</span><span class="op" id="4651024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4651028">if</span>&nbsp;<span class="ident" id="4651031">err</span>&nbsp;<span class="op" id="4651035">!=</span>&nbsp;<span class="builtintype" id="4651038">nil</span>&nbsp;<span class="op" id="4651042">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4651047">return</span>&nbsp;<span class="ident" id="4651054">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4651060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4651064">sum</span>&nbsp;<span class="op" id="4651068">:=</span>&nbsp;<span class="ident" id="4651071">z</span><span class="op" id="4651072">.</span><span class="ident" id="4651073">digest</span><span class="op" id="4651079">.</span><span class="ident" id="4651080">Sum32</span><span class="op" id="4651085">(</span><span class="op" id="4651086">)</span>&nbsp;<span class="op" id="4651088">&amp;</span>&nbsp;<span class="num" id="4651090">0xFFFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4651099">if</span>&nbsp;<span class="ident" id="4651102">n</span>&nbsp;<span class="op" id="4651104">!=</span>&nbsp;<span class="ident" id="4651107">sum</span>&nbsp;<span class="op" id="4651111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4651116">return</span>&nbsp;<span class="ident" id="4651123">ErrHeader</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4651135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4651138">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4651142">z</span><span class="op" id="4651143">.</span><span class="ident" id="4651144">digest</span><span class="op" id="4651150">.</span><span class="ident" id="4651151">Reset</span><span class="op" id="4651156">(</span><span class="op" id="4651157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4651160">if</span>&nbsp;<span class="ident" id="4651163">z</span><span class="op" id="4651164">.</span><span class="ident" id="4651165">decompressor</span>&nbsp;<span class="op" id="4651178">==</span>&nbsp;<span class="builtintype" id="4651181">nil</span>&nbsp;<span class="op" id="4651185">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4651189">z</span><span class="op" id="4651190">.</span><span class="ident" id="4651191">decompressor</span>&nbsp;<span class="op" id="4651204">=</span>&nbsp;<span class="ident" id="4651206">flate</span><span class="op" id="4651211">.</span><span class="ident" id="4651212">NewReader</span><span class="op" id="4651221">(</span><span class="ident" id="4651222">z</span><span class="op" id="4651223">.</span><span class="ident" id="4651224">r</span><span class="op" id="4651225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4651228">}</span>&nbsp;<span class="keyword" id="4651230">else</span>&nbsp;<span class="op" id="4651235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4651239">z</span><span class="op" id="4651240">.</span><span class="ident" id="4651241">decompressor</span><span class="op" id="4651253">.</span><span class="op" id="4651254">(</span><span class="ident" id="4651255">flate</span><span class="op" id="4651260">.</span><span class="ident" id="4651261">Resetter</span><span class="op" id="4651269">)</span><span class="op" id="4651270">.</span><span class="ident" id="4651271">Reset</span><span class="op" id="4651276">(</span><span class="ident" id="4651277">z</span><span class="op" id="4651278">.</span><span class="ident" id="4651279">r</span><span class="op" id="4651280">,</span>&nbsp;<span class="builtintype" id="4651282">nil</span><span class="op" id="4651285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4651288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4651291">return</span>&nbsp;<span class="builtintype" id="4651298">nil</span><br>
<span class="lineno">240</span><span class="op" id="4651302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4651305">func</span>&nbsp;<span class="op" id="4651310">(</span><span class="ident" id="4651311">z</span>&nbsp;<span class="op" id="4651313">*</span><span class="ident" id="4651314">Reader</span><span class="op" id="4651320">)</span>&nbsp;<span class="ident" id="4651322">Read</span><span class="op" id="4651326">(</span><span class="ident" id="4651327">p</span>&nbsp;<span class="op" id="4651329">[</span><span class="op" id="4651330">]</span><span class="builtintype" id="4651331">byte</span><span class="op" id="4651335">)</span>&nbsp;<span class="op" id="4651337">(</span><span class="ident" id="4651338">n</span>&nbsp;<span class="builtintype" id="4651340">int</span><span class="op" id="4651343">,</span>&nbsp;<span class="ident" id="4651345">err</span>&nbsp;<span class="builtintype" id="4651349">error</span><span class="op" id="4651354">)</span>&nbsp;<span class="op" id="4651356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4651359">if</span>&nbsp;<span class="ident" id="4651362">z</span><span class="op" id="4651363">.</span><span class="ident" id="4651364">err</span>&nbsp;<span class="op" id="4651368">!=</span>&nbsp;<span class="builtintype" id="4651371">nil</span>&nbsp;<span class="op" id="4651375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4651379">return</span>&nbsp;<span class="num" id="4651386">0</span><span class="op" id="4651387">,</span>&nbsp;<span class="ident" id="4651389">z</span><span class="op" id="4651390">.</span><span class="ident" id="4651391">err</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4651396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4651399">if</span>&nbsp;<span class="builtinfunc" id="4651402">len</span><span class="op" id="4651405">(</span><span class="ident" id="4651406">p</span><span class="op" id="4651407">)</span>&nbsp;<span class="op" id="4651409">==</span>&nbsp;<span class="num" id="4651412">0</span>&nbsp;<span class="op" id="4651414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4651418">return</span>&nbsp;<span class="num" id="4651425">0</span><span class="op" id="4651426">,</span>&nbsp;<span class="builtintype" id="4651428">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4651433">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4651437">n</span><span class="op" id="4651438">,</span>&nbsp;<span class="ident" id="4651440">err</span>&nbsp;<span class="op" id="4651444">=</span>&nbsp;<span class="ident" id="4651446">z</span><span class="op" id="4651447">.</span><span class="ident" id="4651448">decompressor</span><span class="op" id="4651460">.</span><span class="ident" id="4651461">Read</span><span class="op" id="4651465">(</span><span class="ident" id="4651466">p</span><span class="op" id="4651467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4651470">z</span><span class="op" id="4651471">.</span><span class="ident" id="4651472">digest</span><span class="op" id="4651478">.</span><span class="ident" id="4651479">Write</span><span class="op" id="4651484">(</span><span class="ident" id="4651485">p</span><span class="op" id="4651486">[</span><span class="num" id="4651487">0</span><span class="op" id="4651488">:</span><span class="ident" id="4651489">n</span><span class="op" id="4651490">]</span><span class="op" id="4651491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4651494">z</span><span class="op" id="4651495">.</span><span class="ident" id="4651496">size</span>&nbsp;<span class="op" id="4651501">+=</span>&nbsp;<span class="builtintype" id="4651504">uint32</span><span class="op" id="4651510">(</span><span class="ident" id="4651511">n</span><span class="op" id="4651512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4651515">if</span>&nbsp;<span class="ident" id="4651518">n</span>&nbsp;<span class="op" id="4651520">!=</span>&nbsp;<span class="num" id="4651523">0</span>&nbsp;<span class="op" id="4651525">||</span>&nbsp;<span class="ident" id="4651528">err</span>&nbsp;<span class="op" id="4651532">!=</span>&nbsp;<span class="ident" id="4651535">io</span><span class="op" id="4651537">.</span><span class="ident" id="4651538">EOF</span>&nbsp;<span class="op" id="4651542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4651546">z</span><span class="op" id="4651547">.</span><span class="ident" id="4651548">err</span>&nbsp;<span class="op" id="4651552">=</span>&nbsp;<span class="ident" id="4651554">err</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4651560">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4651568">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4651572">//&nbsp;Finished&nbsp;file;&nbsp;check&nbsp;checksum&nbsp;+&nbsp;size.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4651614">if</span>&nbsp;<span class="ident" id="4651617">_</span><span class="op" id="4651618">,</span>&nbsp;<span class="ident" id="4651620">err</span>&nbsp;<span class="op" id="4651624">:=</span>&nbsp;<span class="ident" id="4651627">io</span><span class="op" id="4651629">.</span><span class="ident" id="4651630">ReadFull</span><span class="op" id="4651638">(</span><span class="ident" id="4651639">z</span><span class="op" id="4651640">.</span><span class="ident" id="4651641">r</span><span class="op" id="4651642">,</span>&nbsp;<span class="ident" id="4651644">z</span><span class="op" id="4651645">.</span><span class="ident" id="4651646">buf</span><span class="op" id="4651649">[</span><span class="num" id="4651650">0</span><span class="op" id="4651651">:</span><span class="num" id="4651652">8</span><span class="op" id="4651653">]</span><span class="op" id="4651654">)</span><span class="op" id="4651655">;</span>&nbsp;<span class="ident" id="4651657">err</span>&nbsp;<span class="op" id="4651661">!=</span>&nbsp;<span class="builtintype" id="4651664">nil</span>&nbsp;<span class="op" id="4651668">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4651672">z</span><span class="op" id="4651673">.</span><span class="ident" id="4651674">err</span>&nbsp;<span class="op" id="4651678">=</span>&nbsp;<span class="ident" id="4651680">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4651686">return</span>&nbsp;<span class="num" id="4651693">0</span><span class="op" id="4651694">,</span>&nbsp;<span class="ident" id="4651696">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4651701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4651704">crc32</span><span class="op" id="4651709">,</span>&nbsp;<span class="ident" id="4651711">isize</span>&nbsp;<span class="op" id="4651717">:=</span>&nbsp;<span class="ident" id="4651720">get4</span><span class="op" id="4651724">(</span><span class="ident" id="4651725">z</span><span class="op" id="4651726">.</span><span class="ident" id="4651727">buf</span><span class="op" id="4651730">[</span><span class="num" id="4651731">0</span><span class="op" id="4651732">:</span><span class="num" id="4651733">4</span><span class="op" id="4651734">]</span><span class="op" id="4651735">)</span><span class="op" id="4651736">,</span>&nbsp;<span class="ident" id="4651738">get4</span><span class="op" id="4651742">(</span><span class="ident" id="4651743">z</span><span class="op" id="4651744">.</span><span class="ident" id="4651745">buf</span><span class="op" id="4651748">[</span><span class="num" id="4651749">4</span><span class="op" id="4651750">:</span><span class="num" id="4651751">8</span><span class="op" id="4651752">]</span><span class="op" id="4651753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4651756">sum</span>&nbsp;<span class="op" id="4651760">:=</span>&nbsp;<span class="ident" id="4651763">z</span><span class="op" id="4651764">.</span><span class="ident" id="4651765">digest</span><span class="op" id="4651771">.</span><span class="ident" id="4651772">Sum32</span><span class="op" id="4651777">(</span><span class="op" id="4651778">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4651781">if</span>&nbsp;<span class="ident" id="4651784">sum</span>&nbsp;<span class="op" id="4651788">!=</span>&nbsp;<span class="ident" id="4651791">crc32</span>&nbsp;<span class="op" id="4651797">||</span>&nbsp;<span class="ident" id="4651800">isize</span>&nbsp;<span class="op" id="4651806">!=</span>&nbsp;<span class="ident" id="4651809">z</span><span class="op" id="4651810">.</span><span class="ident" id="4651811">size</span>&nbsp;<span class="op" id="4651816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4651820">z</span><span class="op" id="4651821">.</span><span class="ident" id="4651822">err</span>&nbsp;<span class="op" id="4651826">=</span>&nbsp;<span class="ident" id="4651828">ErrChecksum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4651842">return</span>&nbsp;<span class="num" id="4651849">0</span><span class="op" id="4651850">,</span>&nbsp;<span class="ident" id="4651852">z</span><span class="op" id="4651853">.</span><span class="ident" id="4651854">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4651859">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4651863">//&nbsp;File&nbsp;is&nbsp;ok;&nbsp;is&nbsp;there&nbsp;another?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4651897">if</span>&nbsp;<span class="op" id="4651900">!</span><span class="ident" id="4651901">z</span><span class="op" id="4651902">.</span><span class="ident" id="4651903">multistream</span>&nbsp;<span class="op" id="4651915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4651919">return</span>&nbsp;<span class="num" id="4651926">0</span><span class="op" id="4651927">,</span>&nbsp;<span class="ident" id="4651929">io</span><span class="op" id="4651931">.</span><span class="ident" id="4651932">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4651937">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4651941">if</span>&nbsp;<span class="ident" id="4651944">err</span>&nbsp;<span class="op" id="4651948">=</span>&nbsp;<span class="ident" id="4651950">z</span><span class="op" id="4651951">.</span><span class="ident" id="4651952">readHeader</span><span class="op" id="4651962">(</span><span class="builtintype" id="4651963">false</span><span class="op" id="4651968">)</span><span class="op" id="4651969">;</span>&nbsp;<span class="ident" id="4651971">err</span>&nbsp;<span class="op" id="4651975">!=</span>&nbsp;<span class="builtintype" id="4651978">nil</span>&nbsp;<span class="op" id="4651982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4651986">z</span><span class="op" id="4651987">.</span><span class="ident" id="4651988">err</span>&nbsp;<span class="op" id="4651992">=</span>&nbsp;<span class="ident" id="4651994">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4652000">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4652008">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4652012">//&nbsp;Yes.&nbsp;&nbsp;Reset&nbsp;and&nbsp;read&nbsp;from&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4652046">z</span><span class="op" id="4652047">.</span><span class="ident" id="4652048">digest</span><span class="op" id="4652054">.</span><span class="ident" id="4652055">Reset</span><span class="op" id="4652060">(</span><span class="op" id="4652061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4652064">z</span><span class="op" id="4652065">.</span><span class="ident" id="4652066">size</span>&nbsp;<span class="op" id="4652071">=</span>&nbsp;<span class="num" id="4652073">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4652076">return</span>&nbsp;<span class="ident" id="4652083">z</span><span class="op" id="4652084">.</span><span class="ident" id="4652085">Read</span><span class="op" id="4652089">(</span><span class="ident" id="4652090">p</span><span class="op" id="4652091">)</span><br>
<span class="lineno"></span><span class="op" id="4652093">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="4652096">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;Reader.&nbsp;It&nbsp;does&nbsp;not&nbsp;close&nbsp;the&nbsp;underlying&nbsp;io.Reader.</span><br>
<span class="lineno"></span><span class="keyword" id="4652168">func</span>&nbsp;<span class="op" id="4652173">(</span><span class="ident" id="4652174">z</span>&nbsp;<span class="op" id="4652176">*</span><span class="ident" id="4652177">Reader</span><span class="op" id="4652183">)</span>&nbsp;<span class="ident" id="4652185">Close</span><span class="op" id="4652190">(</span><span class="op" id="4652191">)</span>&nbsp;<span class="builtintype" id="4652193">error</span>&nbsp;<span class="op" id="4652199">{</span>&nbsp;<span class="keyword" id="4652201">return</span>&nbsp;<span class="ident" id="4652208">z</span><span class="op" id="4652209">.</span><span class="ident" id="4652210">decompressor</span><span class="op" id="4652222">.</span><span class="ident" id="4652223">Close</span><span class="op" id="4652228">(</span><span class="op" id="4652229">)</span>&nbsp;<span class="op" id="4652231">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
