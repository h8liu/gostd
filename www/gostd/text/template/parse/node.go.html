<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template/parse</h2>
<ul>
<li><a href="/gostd/text/template/parse/lex.go.html">lex.go</a></li>
<li><a href="/gostd/text/template/parse/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/text/template/parse/node.go.html" class="current">node.go</a></li>
<li><a href="/gostd/text/template/parse/parse.go.html">parse.go</a></li>
<li><a href="/gostd/text/template/parse/parse_test.go.html">parse_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3091084">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3091139">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3091193">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3091244">//&nbsp;Parse&nbsp;nodes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3091261">package</span>&nbsp;<span class="ident" id="3091269">parse</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3091276">import</span>&nbsp;<span class="op" id="3091283">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3091286">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3091295">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3091302">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3091313">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="3091323">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="3091326">var</span>&nbsp;<span class="ident" id="3091330">textFormat</span>&nbsp;<span class="op" id="3091341">=</span>&nbsp;<span class="string" id="3091343">&#34;%s&#34;</span>&nbsp;<span class="comment" id="3091348">//&nbsp;Changed&nbsp;to&nbsp;&#34;%q&#34;&nbsp;in&nbsp;tests&nbsp;for&nbsp;better&nbsp;error&nbsp;messages.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3091404">//&nbsp;A&nbsp;Node&nbsp;is&nbsp;an&nbsp;element&nbsp;in&nbsp;the&nbsp;parse&nbsp;tree.&nbsp;The&nbsp;interface&nbsp;is&nbsp;trivial.</span><br>
<span class="lineno"></span><span class="comment" id="3091473">//&nbsp;The&nbsp;interface&nbsp;contains&nbsp;an&nbsp;unexported&nbsp;method&nbsp;so&nbsp;that&nbsp;only</span><br>
<span class="lineno">20</span><span class="comment" id="3091533">//&nbsp;types&nbsp;local&nbsp;to&nbsp;this&nbsp;package&nbsp;can&nbsp;satisfy&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="3091580">type</span>&nbsp;<span class="ident" id="3091585">Node</span>&nbsp;<span class="keyword" id="3091590">interface</span>&nbsp;<span class="op" id="3091600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3091603">Type</span><span class="op" id="3091607">(</span><span class="op" id="3091608">)</span>&nbsp;<span class="ident" id="3091610">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3091620">String</span><span class="op" id="3091626">(</span><span class="op" id="3091627">)</span>&nbsp;<span class="builtintype" id="3091629">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3091637">//&nbsp;Copy&nbsp;does&nbsp;a&nbsp;deep&nbsp;copy&nbsp;of&nbsp;the&nbsp;Node&nbsp;and&nbsp;all&nbsp;its&nbsp;components.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3091699">//&nbsp;To&nbsp;avoid&nbsp;type&nbsp;assertions,&nbsp;some&nbsp;XxxNodes&nbsp;also&nbsp;have&nbsp;specialized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3091765">//&nbsp;CopyXxx&nbsp;methods&nbsp;that&nbsp;return&nbsp;*XxxNode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3091807">Copy</span><span class="op" id="3091811">(</span><span class="op" id="3091812">)</span>&nbsp;<span class="ident" id="3091814">Node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3091820">Position</span><span class="op" id="3091828">(</span><span class="op" id="3091829">)</span>&nbsp;<span class="ident" id="3091831">Pos</span>&nbsp;<span class="comment" id="3091835">//&nbsp;byte&nbsp;position&nbsp;of&nbsp;start&nbsp;of&nbsp;node&nbsp;in&nbsp;full&nbsp;original&nbsp;input&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3091900">//&nbsp;tree&nbsp;returns&nbsp;the&nbsp;containing&nbsp;*Tree.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3091939">//&nbsp;It&nbsp;is&nbsp;unexported&nbsp;so&nbsp;all&nbsp;implementations&nbsp;of&nbsp;Node&nbsp;are&nbsp;in&nbsp;this&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3092012">tree</span><span class="op" id="3092016">(</span><span class="op" id="3092017">)</span>&nbsp;<span class="op" id="3092019">*</span><span class="ident" id="3092020">Tree</span><br>
<span class="lineno"></span><span class="op" id="3092025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3092028">//&nbsp;NodeType&nbsp;identifies&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;parse&nbsp;tree&nbsp;node.</span><br>
<span class="lineno">35</span><span class="keyword" id="3092082">type</span>&nbsp;<span class="ident" id="3092087">NodeType</span>&nbsp;<span class="builtintype" id="3092096">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3092101">//&nbsp;Pos&nbsp;represents&nbsp;a&nbsp;byte&nbsp;position&nbsp;in&nbsp;the&nbsp;original&nbsp;input&nbsp;text&nbsp;from&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="3092173">//&nbsp;this&nbsp;template&nbsp;was&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="3092202">type</span>&nbsp;<span class="ident" id="3092207">Pos</span>&nbsp;<span class="builtintype" id="3092211">int</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="3092216">func</span>&nbsp;<span class="op" id="3092221">(</span><span class="ident" id="3092222">p</span>&nbsp;<span class="ident" id="3092224">Pos</span><span class="op" id="3092227">)</span>&nbsp;<span class="ident" id="3092229">Position</span><span class="op" id="3092237">(</span><span class="op" id="3092238">)</span>&nbsp;<span class="ident" id="3092240">Pos</span>&nbsp;<span class="op" id="3092244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3092247">return</span>&nbsp;<span class="ident" id="3092254">p</span><br>
<span class="lineno"></span><span class="op" id="3092256">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="3092259">//&nbsp;Type&nbsp;returns&nbsp;itself&nbsp;and&nbsp;provides&nbsp;an&nbsp;easy&nbsp;default&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="3092326">//&nbsp;for&nbsp;embedding&nbsp;in&nbsp;a&nbsp;Node.&nbsp;Embedded&nbsp;in&nbsp;all&nbsp;non-trivial&nbsp;Nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="3092389">func</span>&nbsp;<span class="op" id="3092394">(</span><span class="ident" id="3092395">t</span>&nbsp;<span class="ident" id="3092397">NodeType</span><span class="op" id="3092405">)</span>&nbsp;<span class="ident" id="3092407">Type</span><span class="op" id="3092411">(</span><span class="op" id="3092412">)</span>&nbsp;<span class="ident" id="3092414">NodeType</span>&nbsp;<span class="op" id="3092423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3092426">return</span>&nbsp;<span class="ident" id="3092433">t</span><br>
<span class="lineno"></span><span class="op" id="3092435">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="3092438">const</span>&nbsp;<span class="op" id="3092444">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3092447">NodeText</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3092462">NodeType</span>&nbsp;<span class="op" id="3092471">=</span>&nbsp;<span class="ident" id="3092473">iota</span>&nbsp;<span class="comment" id="3092478">//&nbsp;Plain&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3092494">NodeAction</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3092525">//&nbsp;A&nbsp;non-control&nbsp;action&nbsp;such&nbsp;as&nbsp;a&nbsp;field&nbsp;evaluation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3092578">NodeBool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3092609">//&nbsp;A&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3092633">NodeChain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3092664">//&nbsp;A&nbsp;sequence&nbsp;of&nbsp;field&nbsp;accesses.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3092698">NodeCommand</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3092729">//&nbsp;An&nbsp;element&nbsp;of&nbsp;a&nbsp;pipeline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3092759">NodeDot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3092790">//&nbsp;The&nbsp;cursor,&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3092811">nodeElse</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3092842">//&nbsp;An&nbsp;else&nbsp;action.&nbsp;Not&nbsp;added&nbsp;to&nbsp;tree.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3092881">nodeEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3092912">//&nbsp;An&nbsp;end&nbsp;action.&nbsp;Not&nbsp;added&nbsp;to&nbsp;tree.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3092950">NodeField</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3092981">//&nbsp;A&nbsp;field&nbsp;or&nbsp;method&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093009">NodeIdentifier</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3093040">//&nbsp;An&nbsp;identifier;&nbsp;always&nbsp;a&nbsp;function&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093083">NodeIf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3093114">//&nbsp;An&nbsp;if&nbsp;action.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093132">NodeList</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3093163">//&nbsp;A&nbsp;list&nbsp;of&nbsp;Nodes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093184">NodeNil</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3093215">//&nbsp;An&nbsp;untyped&nbsp;nil&nbsp;constant.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093244">NodeNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3093275">//&nbsp;A&nbsp;numerical&nbsp;constant.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093301">NodePipe</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3093332">//&nbsp;A&nbsp;pipeline&nbsp;of&nbsp;commands.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093360">NodeRange</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3093391">//&nbsp;A&nbsp;range&nbsp;action.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093411">NodeString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3093442">//&nbsp;A&nbsp;string&nbsp;constant.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093465">NodeTemplate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3093496">//&nbsp;A&nbsp;template&nbsp;invocation&nbsp;action.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093530">NodeVariable</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3093561">//&nbsp;A&nbsp;$&nbsp;variable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093579">NodeWith</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3093610">//&nbsp;A&nbsp;with&nbsp;action.</span><br>
<span class="lineno"></span><span class="op" id="3093628">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3093631">//&nbsp;Nodes.</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="3093642">//&nbsp;ListNode&nbsp;holds&nbsp;a&nbsp;sequence&nbsp;of&nbsp;nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="3093681">type</span>&nbsp;<span class="ident" id="3093686">ListNode</span>&nbsp;<span class="keyword" id="3093695">struct</span>&nbsp;<span class="op" id="3093702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093705">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093715">Pos</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093720">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3093726">*</span><span class="ident" id="3093727">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093733">Nodes</span>&nbsp;<span class="op" id="3093739">[</span><span class="op" id="3093740">]</span><span class="ident" id="3093741">Node</span>&nbsp;<span class="comment" id="3093746">//&nbsp;The&nbsp;element&nbsp;nodes&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="3093785">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3093788">func</span>&nbsp;<span class="op" id="3093793">(</span><span class="ident" id="3093794">t</span>&nbsp;<span class="op" id="3093796">*</span><span class="ident" id="3093797">Tree</span><span class="op" id="3093801">)</span>&nbsp;<span class="ident" id="3093803">newList</span><span class="op" id="3093810">(</span><span class="ident" id="3093811">pos</span>&nbsp;<span class="ident" id="3093815">Pos</span><span class="op" id="3093818">)</span>&nbsp;<span class="op" id="3093820">*</span><span class="ident" id="3093821">ListNode</span>&nbsp;<span class="op" id="3093830">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3093833">return</span>&nbsp;<span class="op" id="3093840">&amp;</span><span class="ident" id="3093841">ListNode</span><span class="op" id="3093849">{</span><span class="ident" id="3093850">tr</span><span class="op" id="3093852">:</span>&nbsp;<span class="ident" id="3093854">t</span><span class="op" id="3093855">,</span>&nbsp;<span class="ident" id="3093857">NodeType</span><span class="op" id="3093865">:</span>&nbsp;<span class="ident" id="3093867">NodeList</span><span class="op" id="3093875">,</span>&nbsp;<span class="ident" id="3093877">Pos</span><span class="op" id="3093880">:</span>&nbsp;<span class="ident" id="3093882">pos</span><span class="op" id="3093885">}</span><br>
<span class="lineno"></span><span class="op" id="3093887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3093890">func</span>&nbsp;<span class="op" id="3093895">(</span><span class="ident" id="3093896">l</span>&nbsp;<span class="op" id="3093898">*</span><span class="ident" id="3093899">ListNode</span><span class="op" id="3093907">)</span>&nbsp;<span class="builtinfunc" id="3093909">append</span><span class="op" id="3093915">(</span><span class="ident" id="3093916">n</span>&nbsp;<span class="ident" id="3093918">Node</span><span class="op" id="3093922">)</span>&nbsp;<span class="op" id="3093924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093927">l</span><span class="op" id="3093928">.</span><span class="ident" id="3093929">Nodes</span>&nbsp;<span class="op" id="3093935">=</span>&nbsp;<span class="builtinfunc" id="3093937">append</span><span class="op" id="3093943">(</span><span class="ident" id="3093944">l</span><span class="op" id="3093945">.</span><span class="ident" id="3093946">Nodes</span><span class="op" id="3093951">,</span>&nbsp;<span class="ident" id="3093953">n</span><span class="op" id="3093954">)</span><br>
<span class="lineno">90</span><span class="op" id="3093956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3093959">func</span>&nbsp;<span class="op" id="3093964">(</span><span class="ident" id="3093965">l</span>&nbsp;<span class="op" id="3093967">*</span><span class="ident" id="3093968">ListNode</span><span class="op" id="3093976">)</span>&nbsp;<span class="ident" id="3093978">tree</span><span class="op" id="3093982">(</span><span class="op" id="3093983">)</span>&nbsp;<span class="op" id="3093985">*</span><span class="ident" id="3093986">Tree</span>&nbsp;<span class="op" id="3093991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3093994">return</span>&nbsp;<span class="ident" id="3094001">l</span><span class="op" id="3094002">.</span><span class="ident" id="3094003">tr</span><br>
<span class="lineno"></span><span class="op" id="3094006">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="3094009">func</span>&nbsp;<span class="op" id="3094014">(</span><span class="ident" id="3094015">l</span>&nbsp;<span class="op" id="3094017">*</span><span class="ident" id="3094018">ListNode</span><span class="op" id="3094026">)</span>&nbsp;<span class="ident" id="3094028">String</span><span class="op" id="3094034">(</span><span class="op" id="3094035">)</span>&nbsp;<span class="builtintype" id="3094037">string</span>&nbsp;<span class="op" id="3094044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3094047">b</span>&nbsp;<span class="op" id="3094049">:=</span>&nbsp;<span class="builtinfunc" id="3094052">new</span><span class="op" id="3094055">(</span><span class="ident" id="3094056">bytes</span><span class="op" id="3094061">.</span><span class="ident" id="3094062">Buffer</span><span class="op" id="3094068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3094071">for</span>&nbsp;<span class="ident" id="3094075">_</span><span class="op" id="3094076">,</span>&nbsp;<span class="ident" id="3094078">n</span>&nbsp;<span class="op" id="3094080">:=</span>&nbsp;<span class="keyword" id="3094083">range</span>&nbsp;<span class="ident" id="3094089">l</span><span class="op" id="3094090">.</span><span class="ident" id="3094091">Nodes</span>&nbsp;<span class="op" id="3094097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3094101">fmt</span><span class="op" id="3094104">.</span><span class="ident" id="3094105">Fprint</span><span class="op" id="3094111">(</span><span class="ident" id="3094112">b</span><span class="op" id="3094113">,</span>&nbsp;<span class="ident" id="3094115">n</span><span class="op" id="3094116">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3094119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3094122">return</span>&nbsp;<span class="ident" id="3094129">b</span><span class="op" id="3094130">.</span><span class="ident" id="3094131">String</span><span class="op" id="3094137">(</span><span class="op" id="3094138">)</span><br>
<span class="lineno"></span><span class="op" id="3094140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3094143">func</span>&nbsp;<span class="op" id="3094148">(</span><span class="ident" id="3094149">l</span>&nbsp;<span class="op" id="3094151">*</span><span class="ident" id="3094152">ListNode</span><span class="op" id="3094160">)</span>&nbsp;<span class="ident" id="3094162">CopyList</span><span class="op" id="3094170">(</span><span class="op" id="3094171">)</span>&nbsp;<span class="op" id="3094173">*</span><span class="ident" id="3094174">ListNode</span>&nbsp;<span class="op" id="3094183">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3094186">if</span>&nbsp;<span class="ident" id="3094189">l</span>&nbsp;<span class="op" id="3094191">==</span>&nbsp;<span class="builtintype" id="3094194">nil</span>&nbsp;<span class="op" id="3094198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3094202">return</span>&nbsp;<span class="ident" id="3094209">l</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3094212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3094215">n</span>&nbsp;<span class="op" id="3094217">:=</span>&nbsp;<span class="ident" id="3094220">l</span><span class="op" id="3094221">.</span><span class="ident" id="3094222">tr</span><span class="op" id="3094224">.</span><span class="ident" id="3094225">newList</span><span class="op" id="3094232">(</span><span class="ident" id="3094233">l</span><span class="op" id="3094234">.</span><span class="ident" id="3094235">Pos</span><span class="op" id="3094238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3094241">for</span>&nbsp;<span class="ident" id="3094245">_</span><span class="op" id="3094246">,</span>&nbsp;<span class="ident" id="3094248">elem</span>&nbsp;<span class="op" id="3094253">:=</span>&nbsp;<span class="keyword" id="3094256">range</span>&nbsp;<span class="ident" id="3094262">l</span><span class="op" id="3094263">.</span><span class="ident" id="3094264">Nodes</span>&nbsp;<span class="op" id="3094270">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3094274">n</span><span class="op" id="3094275">.</span><span class="builtinfunc" id="3094276">append</span><span class="op" id="3094282">(</span><span class="ident" id="3094283">elem</span><span class="op" id="3094287">.</span><span class="ident" id="3094288">Copy</span><span class="op" id="3094292">(</span><span class="op" id="3094293">)</span><span class="op" id="3094294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3094297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3094300">return</span>&nbsp;<span class="ident" id="3094307">n</span><br>
<span class="lineno"></span><span class="op" id="3094309">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="3094312">func</span>&nbsp;<span class="op" id="3094317">(</span><span class="ident" id="3094318">l</span>&nbsp;<span class="op" id="3094320">*</span><span class="ident" id="3094321">ListNode</span><span class="op" id="3094329">)</span>&nbsp;<span class="ident" id="3094331">Copy</span><span class="op" id="3094335">(</span><span class="op" id="3094336">)</span>&nbsp;<span class="ident" id="3094338">Node</span>&nbsp;<span class="op" id="3094343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3094346">return</span>&nbsp;<span class="ident" id="3094353">l</span><span class="op" id="3094354">.</span><span class="ident" id="3094355">CopyList</span><span class="op" id="3094363">(</span><span class="op" id="3094364">)</span><br>
<span class="lineno"></span><span class="op" id="3094366">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3094369">//&nbsp;TextNode&nbsp;holds&nbsp;plain&nbsp;text.</span><br>
<span class="lineno">120</span><span class="keyword" id="3094399">type</span>&nbsp;<span class="ident" id="3094404">TextNode</span>&nbsp;<span class="keyword" id="3094413">struct</span>&nbsp;<span class="op" id="3094420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3094423">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3094433">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3094438">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3094443">*</span><span class="ident" id="3094444">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3094450">Text</span>&nbsp;<span class="op" id="3094455">[</span><span class="op" id="3094456">]</span><span class="builtintype" id="3094457">byte</span>&nbsp;<span class="comment" id="3094462">//&nbsp;The&nbsp;text;&nbsp;may&nbsp;span&nbsp;newlines.</span><br>
<span class="lineno">125</span><span class="op" id="3094494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3094497">func</span>&nbsp;<span class="op" id="3094502">(</span><span class="ident" id="3094503">t</span>&nbsp;<span class="op" id="3094505">*</span><span class="ident" id="3094506">Tree</span><span class="op" id="3094510">)</span>&nbsp;<span class="ident" id="3094512">newText</span><span class="op" id="3094519">(</span><span class="ident" id="3094520">pos</span>&nbsp;<span class="ident" id="3094524">Pos</span><span class="op" id="3094527">,</span>&nbsp;<span class="ident" id="3094529">text</span>&nbsp;<span class="builtintype" id="3094534">string</span><span class="op" id="3094540">)</span>&nbsp;<span class="op" id="3094542">*</span><span class="ident" id="3094543">TextNode</span>&nbsp;<span class="op" id="3094552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3094555">return</span>&nbsp;<span class="op" id="3094562">&amp;</span><span class="ident" id="3094563">TextNode</span><span class="op" id="3094571">{</span><span class="ident" id="3094572">tr</span><span class="op" id="3094574">:</span>&nbsp;<span class="ident" id="3094576">t</span><span class="op" id="3094577">,</span>&nbsp;<span class="ident" id="3094579">NodeType</span><span class="op" id="3094587">:</span>&nbsp;<span class="ident" id="3094589">NodeText</span><span class="op" id="3094597">,</span>&nbsp;<span class="ident" id="3094599">Pos</span><span class="op" id="3094602">:</span>&nbsp;<span class="ident" id="3094604">pos</span><span class="op" id="3094607">,</span>&nbsp;<span class="ident" id="3094609">Text</span><span class="op" id="3094613">:</span>&nbsp;<span class="op" id="3094615">[</span><span class="op" id="3094616">]</span><span class="builtintype" id="3094617">byte</span><span class="op" id="3094621">(</span><span class="ident" id="3094622">text</span><span class="op" id="3094626">)</span><span class="op" id="3094627">}</span><br>
<span class="lineno"></span><span class="op" id="3094629">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="keyword" id="3094632">func</span>&nbsp;<span class="op" id="3094637">(</span><span class="ident" id="3094638">t</span>&nbsp;<span class="op" id="3094640">*</span><span class="ident" id="3094641">TextNode</span><span class="op" id="3094649">)</span>&nbsp;<span class="ident" id="3094651">String</span><span class="op" id="3094657">(</span><span class="op" id="3094658">)</span>&nbsp;<span class="builtintype" id="3094660">string</span>&nbsp;<span class="op" id="3094667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3094670">return</span>&nbsp;<span class="ident" id="3094677">fmt</span><span class="op" id="3094680">.</span><span class="ident" id="3094681">Sprintf</span><span class="op" id="3094688">(</span><span class="ident" id="3094689">textFormat</span><span class="op" id="3094699">,</span>&nbsp;<span class="ident" id="3094701">t</span><span class="op" id="3094702">.</span><span class="ident" id="3094703">Text</span><span class="op" id="3094707">)</span><br>
<span class="lineno"></span><span class="op" id="3094709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="3094712">func</span>&nbsp;<span class="op" id="3094717">(</span><span class="ident" id="3094718">t</span>&nbsp;<span class="op" id="3094720">*</span><span class="ident" id="3094721">TextNode</span><span class="op" id="3094729">)</span>&nbsp;<span class="ident" id="3094731">tree</span><span class="op" id="3094735">(</span><span class="op" id="3094736">)</span>&nbsp;<span class="op" id="3094738">*</span><span class="ident" id="3094739">Tree</span>&nbsp;<span class="op" id="3094744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3094747">return</span>&nbsp;<span class="ident" id="3094754">t</span><span class="op" id="3094755">.</span><span class="ident" id="3094756">tr</span><br>
<span class="lineno"></span><span class="op" id="3094759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3094762">func</span>&nbsp;<span class="op" id="3094767">(</span><span class="ident" id="3094768">t</span>&nbsp;<span class="op" id="3094770">*</span><span class="ident" id="3094771">TextNode</span><span class="op" id="3094779">)</span>&nbsp;<span class="ident" id="3094781">Copy</span><span class="op" id="3094785">(</span><span class="op" id="3094786">)</span>&nbsp;<span class="ident" id="3094788">Node</span>&nbsp;<span class="op" id="3094793">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3094796">return</span>&nbsp;<span class="op" id="3094803">&amp;</span><span class="ident" id="3094804">TextNode</span><span class="op" id="3094812">{</span><span class="ident" id="3094813">tr</span><span class="op" id="3094815">:</span>&nbsp;<span class="ident" id="3094817">t</span><span class="op" id="3094818">.</span><span class="ident" id="3094819">tr</span><span class="op" id="3094821">,</span>&nbsp;<span class="ident" id="3094823">NodeType</span><span class="op" id="3094831">:</span>&nbsp;<span class="ident" id="3094833">NodeText</span><span class="op" id="3094841">,</span>&nbsp;<span class="ident" id="3094843">Pos</span><span class="op" id="3094846">:</span>&nbsp;<span class="ident" id="3094848">t</span><span class="op" id="3094849">.</span><span class="ident" id="3094850">Pos</span><span class="op" id="3094853">,</span>&nbsp;<span class="ident" id="3094855">Text</span><span class="op" id="3094859">:</span>&nbsp;<span class="builtinfunc" id="3094861">append</span><span class="op" id="3094867">(</span><span class="op" id="3094868">[</span><span class="op" id="3094869">]</span><span class="builtintype" id="3094870">byte</span><span class="op" id="3094874">{</span><span class="op" id="3094875">}</span><span class="op" id="3094876">,</span>&nbsp;<span class="ident" id="3094878">t</span><span class="op" id="3094879">.</span><span class="ident" id="3094880">Text</span><span class="op" id="3094884">...</span><span class="op" id="3094887">)</span><span class="op" id="3094888">}</span><br>
<span class="lineno"></span><span class="op" id="3094890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3094893">//&nbsp;PipeNode&nbsp;holds&nbsp;a&nbsp;pipeline&nbsp;with&nbsp;optional&nbsp;declaration</span><br>
<span class="lineno"></span><span class="keyword" id="3094948">type</span>&nbsp;<span class="ident" id="3094953">PipeNode</span>&nbsp;<span class="keyword" id="3094962">struct</span>&nbsp;<span class="op" id="3094969">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3094972">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3094982">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3094987">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3094992">*</span><span class="ident" id="3094993">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3094999">Line</span>&nbsp;<span class="builtintype" id="3095004">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3095020">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3095090">Decl</span>&nbsp;<span class="op" id="3095095">[</span><span class="op" id="3095096">]</span><span class="op" id="3095097">*</span><span class="ident" id="3095098">VariableNode</span>&nbsp;<span class="comment" id="3095111">//&nbsp;Variable&nbsp;declarations&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3095155">Cmds</span>&nbsp;<span class="op" id="3095160">[</span><span class="op" id="3095161">]</span><span class="op" id="3095162">*</span><span class="ident" id="3095163">CommandNode</span>&nbsp;&nbsp;<span class="comment" id="3095176">//&nbsp;The&nbsp;commands&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="3095210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3095213">func</span>&nbsp;<span class="op" id="3095218">(</span><span class="ident" id="3095219">t</span>&nbsp;<span class="op" id="3095221">*</span><span class="ident" id="3095222">Tree</span><span class="op" id="3095226">)</span>&nbsp;<span class="ident" id="3095228">newPipeline</span><span class="op" id="3095239">(</span><span class="ident" id="3095240">pos</span>&nbsp;<span class="ident" id="3095244">Pos</span><span class="op" id="3095247">,</span>&nbsp;<span class="ident" id="3095249">line</span>&nbsp;<span class="builtintype" id="3095254">int</span><span class="op" id="3095257">,</span>&nbsp;<span class="ident" id="3095259">decl</span>&nbsp;<span class="op" id="3095264">[</span><span class="op" id="3095265">]</span><span class="op" id="3095266">*</span><span class="ident" id="3095267">VariableNode</span><span class="op" id="3095279">)</span>&nbsp;<span class="op" id="3095281">*</span><span class="ident" id="3095282">PipeNode</span>&nbsp;<span class="op" id="3095291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3095294">return</span>&nbsp;<span class="op" id="3095301">&amp;</span><span class="ident" id="3095302">PipeNode</span><span class="op" id="3095310">{</span><span class="ident" id="3095311">tr</span><span class="op" id="3095313">:</span>&nbsp;<span class="ident" id="3095315">t</span><span class="op" id="3095316">,</span>&nbsp;<span class="ident" id="3095318">NodeType</span><span class="op" id="3095326">:</span>&nbsp;<span class="ident" id="3095328">NodePipe</span><span class="op" id="3095336">,</span>&nbsp;<span class="ident" id="3095338">Pos</span><span class="op" id="3095341">:</span>&nbsp;<span class="ident" id="3095343">pos</span><span class="op" id="3095346">,</span>&nbsp;<span class="ident" id="3095348">Line</span><span class="op" id="3095352">:</span>&nbsp;<span class="ident" id="3095354">line</span><span class="op" id="3095358">,</span>&nbsp;<span class="ident" id="3095360">Decl</span><span class="op" id="3095364">:</span>&nbsp;<span class="ident" id="3095366">decl</span><span class="op" id="3095370">}</span><br>
<span class="lineno">155</span><span class="op" id="3095372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3095375">func</span>&nbsp;<span class="op" id="3095380">(</span><span class="ident" id="3095381">p</span>&nbsp;<span class="op" id="3095383">*</span><span class="ident" id="3095384">PipeNode</span><span class="op" id="3095392">)</span>&nbsp;<span class="builtinfunc" id="3095394">append</span><span class="op" id="3095400">(</span><span class="ident" id="3095401">command</span>&nbsp;<span class="op" id="3095409">*</span><span class="ident" id="3095410">CommandNode</span><span class="op" id="3095421">)</span>&nbsp;<span class="op" id="3095423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3095426">p</span><span class="op" id="3095427">.</span><span class="ident" id="3095428">Cmds</span>&nbsp;<span class="op" id="3095433">=</span>&nbsp;<span class="builtinfunc" id="3095435">append</span><span class="op" id="3095441">(</span><span class="ident" id="3095442">p</span><span class="op" id="3095443">.</span><span class="ident" id="3095444">Cmds</span><span class="op" id="3095448">,</span>&nbsp;<span class="ident" id="3095450">command</span><span class="op" id="3095457">)</span><br>
<span class="lineno"></span><span class="op" id="3095459">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="keyword" id="3095462">func</span>&nbsp;<span class="op" id="3095467">(</span><span class="ident" id="3095468">p</span>&nbsp;<span class="op" id="3095470">*</span><span class="ident" id="3095471">PipeNode</span><span class="op" id="3095479">)</span>&nbsp;<span class="ident" id="3095481">String</span><span class="op" id="3095487">(</span><span class="op" id="3095488">)</span>&nbsp;<span class="builtintype" id="3095490">string</span>&nbsp;<span class="op" id="3095497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3095500">s</span>&nbsp;<span class="op" id="3095502">:=</span>&nbsp;<span class="string" id="3095505">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3095509">if</span>&nbsp;<span class="builtinfunc" id="3095512">len</span><span class="op" id="3095515">(</span><span class="ident" id="3095516">p</span><span class="op" id="3095517">.</span><span class="ident" id="3095518">Decl</span><span class="op" id="3095522">)</span>&nbsp;<span class="op" id="3095524">&gt;</span>&nbsp;<span class="num" id="3095526">0</span>&nbsp;<span class="op" id="3095528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3095532">for</span>&nbsp;<span class="ident" id="3095536">i</span><span class="op" id="3095537">,</span>&nbsp;<span class="ident" id="3095539">v</span>&nbsp;<span class="op" id="3095541">:=</span>&nbsp;<span class="keyword" id="3095544">range</span>&nbsp;<span class="ident" id="3095550">p</span><span class="op" id="3095551">.</span><span class="ident" id="3095552">Decl</span>&nbsp;<span class="op" id="3095557">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3095562">if</span>&nbsp;<span class="ident" id="3095565">i</span>&nbsp;<span class="op" id="3095567">&gt;</span>&nbsp;<span class="num" id="3095569">0</span>&nbsp;<span class="op" id="3095571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3095577">s</span>&nbsp;<span class="op" id="3095579">+=</span>&nbsp;<span class="string" id="3095582">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3095590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3095595">s</span>&nbsp;<span class="op" id="3095597">+=</span>&nbsp;<span class="ident" id="3095600">v</span><span class="op" id="3095601">.</span><span class="ident" id="3095602">String</span><span class="op" id="3095608">(</span><span class="op" id="3095609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3095613">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3095617">s</span>&nbsp;<span class="op" id="3095619">+=</span>&nbsp;<span class="string" id="3095622">&#34;&nbsp;:=&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3095630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3095633">for</span>&nbsp;<span class="ident" id="3095637">i</span><span class="op" id="3095638">,</span>&nbsp;<span class="ident" id="3095640">c</span>&nbsp;<span class="op" id="3095642">:=</span>&nbsp;<span class="keyword" id="3095645">range</span>&nbsp;<span class="ident" id="3095651">p</span><span class="op" id="3095652">.</span><span class="ident" id="3095653">Cmds</span>&nbsp;<span class="op" id="3095658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3095662">if</span>&nbsp;<span class="ident" id="3095665">i</span>&nbsp;<span class="op" id="3095667">&gt;</span>&nbsp;<span class="num" id="3095669">0</span>&nbsp;<span class="op" id="3095671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3095676">s</span>&nbsp;<span class="op" id="3095678">+=</span>&nbsp;<span class="string" id="3095681">&#34;&nbsp;|&nbsp;&#34;</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3095689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3095693">s</span>&nbsp;<span class="op" id="3095695">+=</span>&nbsp;<span class="ident" id="3095698">c</span><span class="op" id="3095699">.</span><span class="ident" id="3095700">String</span><span class="op" id="3095706">(</span><span class="op" id="3095707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3095710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3095713">return</span>&nbsp;<span class="ident" id="3095720">s</span><br>
<span class="lineno"></span><span class="op" id="3095722">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="keyword" id="3095725">func</span>&nbsp;<span class="op" id="3095730">(</span><span class="ident" id="3095731">p</span>&nbsp;<span class="op" id="3095733">*</span><span class="ident" id="3095734">PipeNode</span><span class="op" id="3095742">)</span>&nbsp;<span class="ident" id="3095744">tree</span><span class="op" id="3095748">(</span><span class="op" id="3095749">)</span>&nbsp;<span class="op" id="3095751">*</span><span class="ident" id="3095752">Tree</span>&nbsp;<span class="op" id="3095757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3095760">return</span>&nbsp;<span class="ident" id="3095767">p</span><span class="op" id="3095768">.</span><span class="ident" id="3095769">tr</span><br>
<span class="lineno"></span><span class="op" id="3095772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="3095775">func</span>&nbsp;<span class="op" id="3095780">(</span><span class="ident" id="3095781">p</span>&nbsp;<span class="op" id="3095783">*</span><span class="ident" id="3095784">PipeNode</span><span class="op" id="3095792">)</span>&nbsp;<span class="ident" id="3095794">CopyPipe</span><span class="op" id="3095802">(</span><span class="op" id="3095803">)</span>&nbsp;<span class="op" id="3095805">*</span><span class="ident" id="3095806">PipeNode</span>&nbsp;<span class="op" id="3095815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3095818">if</span>&nbsp;<span class="ident" id="3095821">p</span>&nbsp;<span class="op" id="3095823">==</span>&nbsp;<span class="builtintype" id="3095826">nil</span>&nbsp;<span class="op" id="3095830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3095834">return</span>&nbsp;<span class="ident" id="3095841">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3095844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3095847">var</span>&nbsp;<span class="ident" id="3095851">decl</span>&nbsp;<span class="op" id="3095856">[</span><span class="op" id="3095857">]</span><span class="op" id="3095858">*</span><span class="ident" id="3095859">VariableNode</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3095873">for</span>&nbsp;<span class="ident" id="3095877">_</span><span class="op" id="3095878">,</span>&nbsp;<span class="ident" id="3095880">d</span>&nbsp;<span class="op" id="3095882">:=</span>&nbsp;<span class="keyword" id="3095885">range</span>&nbsp;<span class="ident" id="3095891">p</span><span class="op" id="3095892">.</span><span class="ident" id="3095893">Decl</span>&nbsp;<span class="op" id="3095898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3095902">decl</span>&nbsp;<span class="op" id="3095907">=</span>&nbsp;<span class="builtinfunc" id="3095909">append</span><span class="op" id="3095915">(</span><span class="ident" id="3095916">decl</span><span class="op" id="3095920">,</span>&nbsp;<span class="ident" id="3095922">d</span><span class="op" id="3095923">.</span><span class="ident" id="3095924">Copy</span><span class="op" id="3095928">(</span><span class="op" id="3095929">)</span><span class="op" id="3095930">.</span><span class="op" id="3095931">(</span><span class="op" id="3095932">*</span><span class="ident" id="3095933">VariableNode</span><span class="op" id="3095945">)</span><span class="op" id="3095946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3095949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3095952">n</span>&nbsp;<span class="op" id="3095954">:=</span>&nbsp;<span class="ident" id="3095957">p</span><span class="op" id="3095958">.</span><span class="ident" id="3095959">tr</span><span class="op" id="3095961">.</span><span class="ident" id="3095962">newPipeline</span><span class="op" id="3095973">(</span><span class="ident" id="3095974">p</span><span class="op" id="3095975">.</span><span class="ident" id="3095976">Pos</span><span class="op" id="3095979">,</span>&nbsp;<span class="ident" id="3095981">p</span><span class="op" id="3095982">.</span><span class="ident" id="3095983">Line</span><span class="op" id="3095987">,</span>&nbsp;<span class="ident" id="3095989">decl</span><span class="op" id="3095993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3095996">for</span>&nbsp;<span class="ident" id="3096000">_</span><span class="op" id="3096001">,</span>&nbsp;<span class="ident" id="3096003">c</span>&nbsp;<span class="op" id="3096005">:=</span>&nbsp;<span class="keyword" id="3096008">range</span>&nbsp;<span class="ident" id="3096014">p</span><span class="op" id="3096015">.</span><span class="ident" id="3096016">Cmds</span>&nbsp;<span class="op" id="3096021">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3096025">n</span><span class="op" id="3096026">.</span><span class="builtinfunc" id="3096027">append</span><span class="op" id="3096033">(</span><span class="ident" id="3096034">c</span><span class="op" id="3096035">.</span><span class="ident" id="3096036">Copy</span><span class="op" id="3096040">(</span><span class="op" id="3096041">)</span><span class="op" id="3096042">.</span><span class="op" id="3096043">(</span><span class="op" id="3096044">*</span><span class="ident" id="3096045">CommandNode</span><span class="op" id="3096056">)</span><span class="op" id="3096057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3096060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3096063">return</span>&nbsp;<span class="ident" id="3096070">n</span><br>
<span class="lineno"></span><span class="op" id="3096072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="3096075">func</span>&nbsp;<span class="op" id="3096080">(</span><span class="ident" id="3096081">p</span>&nbsp;<span class="op" id="3096083">*</span><span class="ident" id="3096084">PipeNode</span><span class="op" id="3096092">)</span>&nbsp;<span class="ident" id="3096094">Copy</span><span class="op" id="3096098">(</span><span class="op" id="3096099">)</span>&nbsp;<span class="ident" id="3096101">Node</span>&nbsp;<span class="op" id="3096106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3096109">return</span>&nbsp;<span class="ident" id="3096116">p</span><span class="op" id="3096117">.</span><span class="ident" id="3096118">CopyPipe</span><span class="op" id="3096126">(</span><span class="op" id="3096127">)</span><br>
<span class="lineno"></span><span class="op" id="3096129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3096132">//&nbsp;ActionNode&nbsp;holds&nbsp;an&nbsp;action&nbsp;(something&nbsp;bounded&nbsp;by&nbsp;delimiters).</span><br>
<span class="lineno">205</span><span class="comment" id="3096197">//&nbsp;Control&nbsp;actions&nbsp;have&nbsp;their&nbsp;own&nbsp;nodes;&nbsp;ActionNode&nbsp;represents&nbsp;simple</span><br>
<span class="lineno"></span><span class="comment" id="3096267">//&nbsp;ones&nbsp;such&nbsp;as&nbsp;field&nbsp;evaluations&nbsp;and&nbsp;parenthesized&nbsp;pipelines.</span><br>
<span class="lineno"></span><span class="keyword" id="3096330">type</span>&nbsp;<span class="ident" id="3096335">ActionNode</span>&nbsp;<span class="keyword" id="3096346">struct</span>&nbsp;<span class="op" id="3096353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3096356">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3096366">Pos</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3096371">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3096376">*</span><span class="ident" id="3096377">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3096383">Line</span>&nbsp;<span class="builtintype" id="3096388">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3096398">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3096468">Pipe</span>&nbsp;<span class="op" id="3096473">*</span><span class="ident" id="3096474">PipeNode</span>&nbsp;<span class="comment" id="3096483">//&nbsp;The&nbsp;pipeline&nbsp;in&nbsp;the&nbsp;action.</span><br>
<span class="lineno"></span><span class="op" id="3096514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="3096517">func</span>&nbsp;<span class="op" id="3096522">(</span><span class="ident" id="3096523">t</span>&nbsp;<span class="op" id="3096525">*</span><span class="ident" id="3096526">Tree</span><span class="op" id="3096530">)</span>&nbsp;<span class="ident" id="3096532">newAction</span><span class="op" id="3096541">(</span><span class="ident" id="3096542">pos</span>&nbsp;<span class="ident" id="3096546">Pos</span><span class="op" id="3096549">,</span>&nbsp;<span class="ident" id="3096551">line</span>&nbsp;<span class="builtintype" id="3096556">int</span><span class="op" id="3096559">,</span>&nbsp;<span class="ident" id="3096561">pipe</span>&nbsp;<span class="op" id="3096566">*</span><span class="ident" id="3096567">PipeNode</span><span class="op" id="3096575">)</span>&nbsp;<span class="op" id="3096577">*</span><span class="ident" id="3096578">ActionNode</span>&nbsp;<span class="op" id="3096589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3096592">return</span>&nbsp;<span class="op" id="3096599">&amp;</span><span class="ident" id="3096600">ActionNode</span><span class="op" id="3096610">{</span><span class="ident" id="3096611">tr</span><span class="op" id="3096613">:</span>&nbsp;<span class="ident" id="3096615">t</span><span class="op" id="3096616">,</span>&nbsp;<span class="ident" id="3096618">NodeType</span><span class="op" id="3096626">:</span>&nbsp;<span class="ident" id="3096628">NodeAction</span><span class="op" id="3096638">,</span>&nbsp;<span class="ident" id="3096640">Pos</span><span class="op" id="3096643">:</span>&nbsp;<span class="ident" id="3096645">pos</span><span class="op" id="3096648">,</span>&nbsp;<span class="ident" id="3096650">Line</span><span class="op" id="3096654">:</span>&nbsp;<span class="ident" id="3096656">line</span><span class="op" id="3096660">,</span>&nbsp;<span class="ident" id="3096662">Pipe</span><span class="op" id="3096666">:</span>&nbsp;<span class="ident" id="3096668">pipe</span><span class="op" id="3096672">}</span><br>
<span class="lineno"></span><span class="op" id="3096674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3096677">func</span>&nbsp;<span class="op" id="3096682">(</span><span class="ident" id="3096683">a</span>&nbsp;<span class="op" id="3096685">*</span><span class="ident" id="3096686">ActionNode</span><span class="op" id="3096696">)</span>&nbsp;<span class="ident" id="3096698">String</span><span class="op" id="3096704">(</span><span class="op" id="3096705">)</span>&nbsp;<span class="builtintype" id="3096707">string</span>&nbsp;<span class="op" id="3096714">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3096717">return</span>&nbsp;<span class="ident" id="3096724">fmt</span><span class="op" id="3096727">.</span><span class="ident" id="3096728">Sprintf</span><span class="op" id="3096735">(</span><span class="string" id="3096736">&#34;{{%s}}&#34;</span><span class="op" id="3096744">,</span>&nbsp;<span class="ident" id="3096746">a</span><span class="op" id="3096747">.</span><span class="ident" id="3096748">Pipe</span><span class="op" id="3096752">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="3096755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3096758">func</span>&nbsp;<span class="op" id="3096763">(</span><span class="ident" id="3096764">a</span>&nbsp;<span class="op" id="3096766">*</span><span class="ident" id="3096767">ActionNode</span><span class="op" id="3096777">)</span>&nbsp;<span class="ident" id="3096779">tree</span><span class="op" id="3096783">(</span><span class="op" id="3096784">)</span>&nbsp;<span class="op" id="3096786">*</span><span class="ident" id="3096787">Tree</span>&nbsp;<span class="op" id="3096792">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3096795">return</span>&nbsp;<span class="ident" id="3096802">a</span><span class="op" id="3096803">.</span><span class="ident" id="3096804">tr</span><br>
<span class="lineno"></span><span class="op" id="3096807">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3096810">func</span>&nbsp;<span class="op" id="3096815">(</span><span class="ident" id="3096816">a</span>&nbsp;<span class="op" id="3096818">*</span><span class="ident" id="3096819">ActionNode</span><span class="op" id="3096829">)</span>&nbsp;<span class="ident" id="3096831">Copy</span><span class="op" id="3096835">(</span><span class="op" id="3096836">)</span>&nbsp;<span class="ident" id="3096838">Node</span>&nbsp;<span class="op" id="3096843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3096846">return</span>&nbsp;<span class="ident" id="3096853">a</span><span class="op" id="3096854">.</span><span class="ident" id="3096855">tr</span><span class="op" id="3096857">.</span><span class="ident" id="3096858">newAction</span><span class="op" id="3096867">(</span><span class="ident" id="3096868">a</span><span class="op" id="3096869">.</span><span class="ident" id="3096870">Pos</span><span class="op" id="3096873">,</span>&nbsp;<span class="ident" id="3096875">a</span><span class="op" id="3096876">.</span><span class="ident" id="3096877">Line</span><span class="op" id="3096881">,</span>&nbsp;<span class="ident" id="3096883">a</span><span class="op" id="3096884">.</span><span class="ident" id="3096885">Pipe</span><span class="op" id="3096889">.</span><span class="ident" id="3096890">CopyPipe</span><span class="op" id="3096898">(</span><span class="op" id="3096899">)</span><span class="op" id="3096900">)</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="op" id="3096903">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3096906">//&nbsp;CommandNode&nbsp;holds&nbsp;a&nbsp;command&nbsp;(a&nbsp;pipeline&nbsp;inside&nbsp;an&nbsp;evaluating&nbsp;action).</span><br>
<span class="lineno"></span><span class="keyword" id="3096979">type</span>&nbsp;<span class="ident" id="3096984">CommandNode</span>&nbsp;<span class="keyword" id="3096996">struct</span>&nbsp;<span class="op" id="3097003">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097006">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097016">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097021">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3097026">*</span><span class="ident" id="3097027">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097033">Args</span>&nbsp;<span class="op" id="3097038">[</span><span class="op" id="3097039">]</span><span class="ident" id="3097040">Node</span>&nbsp;<span class="comment" id="3097045">//&nbsp;Arguments&nbsp;in&nbsp;lexical&nbsp;order:&nbsp;Identifier,&nbsp;field,&nbsp;or&nbsp;constant.</span><br>
<span class="lineno"></span><span class="op" id="3097108">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span><span class="keyword" id="3097111">func</span>&nbsp;<span class="op" id="3097116">(</span><span class="ident" id="3097117">t</span>&nbsp;<span class="op" id="3097119">*</span><span class="ident" id="3097120">Tree</span><span class="op" id="3097124">)</span>&nbsp;<span class="ident" id="3097126">newCommand</span><span class="op" id="3097136">(</span><span class="ident" id="3097137">pos</span>&nbsp;<span class="ident" id="3097141">Pos</span><span class="op" id="3097144">)</span>&nbsp;<span class="op" id="3097146">*</span><span class="ident" id="3097147">CommandNode</span>&nbsp;<span class="op" id="3097159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097162">return</span>&nbsp;<span class="op" id="3097169">&amp;</span><span class="ident" id="3097170">CommandNode</span><span class="op" id="3097181">{</span><span class="ident" id="3097182">tr</span><span class="op" id="3097184">:</span>&nbsp;<span class="ident" id="3097186">t</span><span class="op" id="3097187">,</span>&nbsp;<span class="ident" id="3097189">NodeType</span><span class="op" id="3097197">:</span>&nbsp;<span class="ident" id="3097199">NodeCommand</span><span class="op" id="3097210">,</span>&nbsp;<span class="ident" id="3097212">Pos</span><span class="op" id="3097215">:</span>&nbsp;<span class="ident" id="3097217">pos</span><span class="op" id="3097220">}</span><br>
<span class="lineno"></span><span class="op" id="3097222">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="keyword" id="3097225">func</span>&nbsp;<span class="op" id="3097230">(</span><span class="ident" id="3097231">c</span>&nbsp;<span class="op" id="3097233">*</span><span class="ident" id="3097234">CommandNode</span><span class="op" id="3097245">)</span>&nbsp;<span class="builtinfunc" id="3097247">append</span><span class="op" id="3097253">(</span><span class="ident" id="3097254">arg</span>&nbsp;<span class="ident" id="3097258">Node</span><span class="op" id="3097262">)</span>&nbsp;<span class="op" id="3097264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097267">c</span><span class="op" id="3097268">.</span><span class="ident" id="3097269">Args</span>&nbsp;<span class="op" id="3097274">=</span>&nbsp;<span class="builtinfunc" id="3097276">append</span><span class="op" id="3097282">(</span><span class="ident" id="3097283">c</span><span class="op" id="3097284">.</span><span class="ident" id="3097285">Args</span><span class="op" id="3097289">,</span>&nbsp;<span class="ident" id="3097291">arg</span><span class="op" id="3097294">)</span><br>
<span class="lineno"></span><span class="op" id="3097296">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3097299">func</span>&nbsp;<span class="op" id="3097304">(</span><span class="ident" id="3097305">c</span>&nbsp;<span class="op" id="3097307">*</span><span class="ident" id="3097308">CommandNode</span><span class="op" id="3097319">)</span>&nbsp;<span class="ident" id="3097321">String</span><span class="op" id="3097327">(</span><span class="op" id="3097328">)</span>&nbsp;<span class="builtintype" id="3097330">string</span>&nbsp;<span class="op" id="3097337">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097340">s</span>&nbsp;<span class="op" id="3097342">:=</span>&nbsp;<span class="string" id="3097345">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097349">for</span>&nbsp;<span class="ident" id="3097353">i</span><span class="op" id="3097354">,</span>&nbsp;<span class="ident" id="3097356">arg</span>&nbsp;<span class="op" id="3097360">:=</span>&nbsp;<span class="keyword" id="3097363">range</span>&nbsp;<span class="ident" id="3097369">c</span><span class="op" id="3097370">.</span><span class="ident" id="3097371">Args</span>&nbsp;<span class="op" id="3097376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097380">if</span>&nbsp;<span class="ident" id="3097383">i</span>&nbsp;<span class="op" id="3097385">&gt;</span>&nbsp;<span class="num" id="3097387">0</span>&nbsp;<span class="op" id="3097389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097394">s</span>&nbsp;<span class="op" id="3097396">+=</span>&nbsp;<span class="string" id="3097399">&#34;&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3097405">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097409">if</span>&nbsp;<span class="ident" id="3097412">arg</span><span class="op" id="3097415">,</span>&nbsp;<span class="ident" id="3097417">ok</span>&nbsp;<span class="op" id="3097420">:=</span>&nbsp;<span class="ident" id="3097423">arg</span><span class="op" id="3097426">.</span><span class="op" id="3097427">(</span><span class="op" id="3097428">*</span><span class="ident" id="3097429">PipeNode</span><span class="op" id="3097437">)</span><span class="op" id="3097438">;</span>&nbsp;<span class="ident" id="3097440">ok</span>&nbsp;<span class="op" id="3097443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097448">s</span>&nbsp;<span class="op" id="3097450">+=</span>&nbsp;<span class="string" id="3097453">&#34;(&#34;</span>&nbsp;<span class="op" id="3097457">+</span>&nbsp;<span class="ident" id="3097459">arg</span><span class="op" id="3097462">.</span><span class="ident" id="3097463">String</span><span class="op" id="3097469">(</span><span class="op" id="3097470">)</span>&nbsp;<span class="op" id="3097472">+</span>&nbsp;<span class="string" id="3097474">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097481">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3097492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097496">s</span>&nbsp;<span class="op" id="3097498">+=</span>&nbsp;<span class="ident" id="3097501">arg</span><span class="op" id="3097504">.</span><span class="ident" id="3097505">String</span><span class="op" id="3097511">(</span><span class="op" id="3097512">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3097515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097518">return</span>&nbsp;<span class="ident" id="3097525">s</span><br>
<span class="lineno"></span><span class="op" id="3097527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3097530">func</span>&nbsp;<span class="op" id="3097535">(</span><span class="ident" id="3097536">c</span>&nbsp;<span class="op" id="3097538">*</span><span class="ident" id="3097539">CommandNode</span><span class="op" id="3097550">)</span>&nbsp;<span class="ident" id="3097552">tree</span><span class="op" id="3097556">(</span><span class="op" id="3097557">)</span>&nbsp;<span class="op" id="3097559">*</span><span class="ident" id="3097560">Tree</span>&nbsp;<span class="op" id="3097565">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097568">return</span>&nbsp;<span class="ident" id="3097575">c</span><span class="op" id="3097576">.</span><span class="ident" id="3097577">tr</span><br>
<span class="lineno"></span><span class="op" id="3097580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3097583">func</span>&nbsp;<span class="op" id="3097588">(</span><span class="ident" id="3097589">c</span>&nbsp;<span class="op" id="3097591">*</span><span class="ident" id="3097592">CommandNode</span><span class="op" id="3097603">)</span>&nbsp;<span class="ident" id="3097605">Copy</span><span class="op" id="3097609">(</span><span class="op" id="3097610">)</span>&nbsp;<span class="ident" id="3097612">Node</span>&nbsp;<span class="op" id="3097617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097620">if</span>&nbsp;<span class="ident" id="3097623">c</span>&nbsp;<span class="op" id="3097625">==</span>&nbsp;<span class="builtintype" id="3097628">nil</span>&nbsp;<span class="op" id="3097632">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097636">return</span>&nbsp;<span class="ident" id="3097643">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3097646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097649">n</span>&nbsp;<span class="op" id="3097651">:=</span>&nbsp;<span class="ident" id="3097654">c</span><span class="op" id="3097655">.</span><span class="ident" id="3097656">tr</span><span class="op" id="3097658">.</span><span class="ident" id="3097659">newCommand</span><span class="op" id="3097669">(</span><span class="ident" id="3097670">c</span><span class="op" id="3097671">.</span><span class="ident" id="3097672">Pos</span><span class="op" id="3097675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097678">for</span>&nbsp;<span class="ident" id="3097682">_</span><span class="op" id="3097683">,</span>&nbsp;<span class="ident" id="3097685">c</span>&nbsp;<span class="op" id="3097687">:=</span>&nbsp;<span class="keyword" id="3097690">range</span>&nbsp;<span class="ident" id="3097696">c</span><span class="op" id="3097697">.</span><span class="ident" id="3097698">Args</span>&nbsp;<span class="op" id="3097703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097707">n</span><span class="op" id="3097708">.</span><span class="builtinfunc" id="3097709">append</span><span class="op" id="3097715">(</span><span class="ident" id="3097716">c</span><span class="op" id="3097717">.</span><span class="ident" id="3097718">Copy</span><span class="op" id="3097722">(</span><span class="op" id="3097723">)</span><span class="op" id="3097724">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3097727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097730">return</span>&nbsp;<span class="ident" id="3097737">n</span><br>
<span class="lineno"></span><span class="op" id="3097739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3097742">//&nbsp;IdentifierNode&nbsp;holds&nbsp;an&nbsp;identifier.</span><br>
<span class="lineno">280</span><span class="keyword" id="3097781">type</span>&nbsp;<span class="ident" id="3097786">IdentifierNode</span>&nbsp;<span class="keyword" id="3097801">struct</span>&nbsp;<span class="op" id="3097808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097811">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097821">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097826">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3097832">*</span><span class="ident" id="3097833">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097839">Ident</span>&nbsp;<span class="builtintype" id="3097845">string</span>&nbsp;<span class="comment" id="3097852">//&nbsp;The&nbsp;identifier&#39;s&nbsp;name.</span><br>
<span class="lineno">285</span><span class="op" id="3097878">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3097881">//&nbsp;NewIdentifier&nbsp;returns&nbsp;a&nbsp;new&nbsp;IdentifierNode&nbsp;with&nbsp;the&nbsp;given&nbsp;identifier&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="3097959">func</span>&nbsp;<span class="ident" id="3097964">NewIdentifier</span><span class="op" id="3097977">(</span><span class="ident" id="3097978">ident</span>&nbsp;<span class="builtintype" id="3097984">string</span><span class="op" id="3097990">)</span>&nbsp;<span class="op" id="3097992">*</span><span class="ident" id="3097993">IdentifierNode</span>&nbsp;<span class="op" id="3098008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098011">return</span>&nbsp;<span class="op" id="3098018">&amp;</span><span class="ident" id="3098019">IdentifierNode</span><span class="op" id="3098033">{</span><span class="ident" id="3098034">NodeType</span><span class="op" id="3098042">:</span>&nbsp;<span class="ident" id="3098044">NodeIdentifier</span><span class="op" id="3098058">,</span>&nbsp;<span class="ident" id="3098060">Ident</span><span class="op" id="3098065">:</span>&nbsp;<span class="ident" id="3098067">ident</span><span class="op" id="3098072">}</span><br>
<span class="lineno">290</span><span class="op" id="3098074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3098077">//&nbsp;SetPos&nbsp;sets&nbsp;the&nbsp;position.&nbsp;NewIdentifier&nbsp;is&nbsp;a&nbsp;public&nbsp;method&nbsp;so&nbsp;we&nbsp;can&#39;t&nbsp;modify&nbsp;its&nbsp;signature.</span><br>
<span class="lineno"></span><span class="comment" id="3098173">//&nbsp;Chained&nbsp;for&nbsp;convenience.</span><br>
<span class="lineno"></span><span class="comment" id="3098201">//&nbsp;TODO:&nbsp;fix&nbsp;one&nbsp;day?</span><br>
<span class="lineno">295</span><span class="keyword" id="3098223">func</span>&nbsp;<span class="op" id="3098228">(</span><span class="ident" id="3098229">i</span>&nbsp;<span class="op" id="3098231">*</span><span class="ident" id="3098232">IdentifierNode</span><span class="op" id="3098246">)</span>&nbsp;<span class="ident" id="3098248">SetPos</span><span class="op" id="3098254">(</span><span class="ident" id="3098255">pos</span>&nbsp;<span class="ident" id="3098259">Pos</span><span class="op" id="3098262">)</span>&nbsp;<span class="op" id="3098264">*</span><span class="ident" id="3098265">IdentifierNode</span>&nbsp;<span class="op" id="3098280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098283">i</span><span class="op" id="3098284">.</span><span class="ident" id="3098285">Pos</span>&nbsp;<span class="op" id="3098289">=</span>&nbsp;<span class="ident" id="3098291">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098296">return</span>&nbsp;<span class="ident" id="3098303">i</span><br>
<span class="lineno"></span><span class="op" id="3098305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="comment" id="3098308">//&nbsp;SetTree&nbsp;sets&nbsp;the&nbsp;parent&nbsp;tree&nbsp;for&nbsp;the&nbsp;node.&nbsp;NewIdentifier&nbsp;is&nbsp;a&nbsp;public&nbsp;method&nbsp;so&nbsp;we&nbsp;can&#39;t&nbsp;modify&nbsp;its&nbsp;signature.</span><br>
<span class="lineno"></span><span class="comment" id="3098421">//&nbsp;Chained&nbsp;for&nbsp;convenience.</span><br>
<span class="lineno"></span><span class="comment" id="3098449">//&nbsp;TODO:&nbsp;fix&nbsp;one&nbsp;day?</span><br>
<span class="lineno"></span><span class="keyword" id="3098471">func</span>&nbsp;<span class="op" id="3098476">(</span><span class="ident" id="3098477">i</span>&nbsp;<span class="op" id="3098479">*</span><span class="ident" id="3098480">IdentifierNode</span><span class="op" id="3098494">)</span>&nbsp;<span class="ident" id="3098496">SetTree</span><span class="op" id="3098503">(</span><span class="ident" id="3098504">t</span>&nbsp;<span class="op" id="3098506">*</span><span class="ident" id="3098507">Tree</span><span class="op" id="3098511">)</span>&nbsp;<span class="op" id="3098513">*</span><span class="ident" id="3098514">IdentifierNode</span>&nbsp;<span class="op" id="3098529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098532">i</span><span class="op" id="3098533">.</span><span class="ident" id="3098534">tr</span>&nbsp;<span class="op" id="3098537">=</span>&nbsp;<span class="ident" id="3098539">t</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098542">return</span>&nbsp;<span class="ident" id="3098549">i</span><br>
<span class="lineno"></span><span class="op" id="3098551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3098554">func</span>&nbsp;<span class="op" id="3098559">(</span><span class="ident" id="3098560">i</span>&nbsp;<span class="op" id="3098562">*</span><span class="ident" id="3098563">IdentifierNode</span><span class="op" id="3098577">)</span>&nbsp;<span class="ident" id="3098579">String</span><span class="op" id="3098585">(</span><span class="op" id="3098586">)</span>&nbsp;<span class="builtintype" id="3098588">string</span>&nbsp;<span class="op" id="3098595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098598">return</span>&nbsp;<span class="ident" id="3098605">i</span><span class="op" id="3098606">.</span><span class="ident" id="3098607">Ident</span><br>
<span class="lineno">310</span><span class="op" id="3098613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3098616">func</span>&nbsp;<span class="op" id="3098621">(</span><span class="ident" id="3098622">i</span>&nbsp;<span class="op" id="3098624">*</span><span class="ident" id="3098625">IdentifierNode</span><span class="op" id="3098639">)</span>&nbsp;<span class="ident" id="3098641">tree</span><span class="op" id="3098645">(</span><span class="op" id="3098646">)</span>&nbsp;<span class="op" id="3098648">*</span><span class="ident" id="3098649">Tree</span>&nbsp;<span class="op" id="3098654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098657">return</span>&nbsp;<span class="ident" id="3098664">i</span><span class="op" id="3098665">.</span><span class="ident" id="3098666">tr</span><br>
<span class="lineno"></span><span class="op" id="3098669">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="3098672">func</span>&nbsp;<span class="op" id="3098677">(</span><span class="ident" id="3098678">i</span>&nbsp;<span class="op" id="3098680">*</span><span class="ident" id="3098681">IdentifierNode</span><span class="op" id="3098695">)</span>&nbsp;<span class="ident" id="3098697">Copy</span><span class="op" id="3098701">(</span><span class="op" id="3098702">)</span>&nbsp;<span class="ident" id="3098704">Node</span>&nbsp;<span class="op" id="3098709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098712">return</span>&nbsp;<span class="ident" id="3098719">NewIdentifier</span><span class="op" id="3098732">(</span><span class="ident" id="3098733">i</span><span class="op" id="3098734">.</span><span class="ident" id="3098735">Ident</span><span class="op" id="3098740">)</span><span class="op" id="3098741">.</span><span class="ident" id="3098742">SetTree</span><span class="op" id="3098749">(</span><span class="ident" id="3098750">i</span><span class="op" id="3098751">.</span><span class="ident" id="3098752">tr</span><span class="op" id="3098754">)</span><span class="op" id="3098755">.</span><span class="ident" id="3098756">SetPos</span><span class="op" id="3098762">(</span><span class="ident" id="3098763">i</span><span class="op" id="3098764">.</span><span class="ident" id="3098765">Pos</span><span class="op" id="3098768">)</span><br>
<span class="lineno"></span><span class="op" id="3098770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="comment" id="3098773">//&nbsp;VariableNode&nbsp;holds&nbsp;a&nbsp;list&nbsp;of&nbsp;variable&nbsp;names,&nbsp;possibly&nbsp;with&nbsp;chained&nbsp;field</span><br>
<span class="lineno"></span><span class="comment" id="3098849">//&nbsp;accesses.&nbsp;The&nbsp;dollar&nbsp;sign&nbsp;is&nbsp;part&nbsp;of&nbsp;the&nbsp;(first)&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="3098907">type</span>&nbsp;<span class="ident" id="3098912">VariableNode</span>&nbsp;<span class="keyword" id="3098925">struct</span>&nbsp;<span class="op" id="3098932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098935">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098945">Pos</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098950">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3098956">*</span><span class="ident" id="3098957">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098963">Ident</span>&nbsp;<span class="op" id="3098969">[</span><span class="op" id="3098970">]</span><span class="builtintype" id="3098971">string</span>&nbsp;<span class="comment" id="3098978">//&nbsp;Variable&nbsp;name&nbsp;and&nbsp;fields&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="3099024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3099027">func</span>&nbsp;<span class="op" id="3099032">(</span><span class="ident" id="3099033">t</span>&nbsp;<span class="op" id="3099035">*</span><span class="ident" id="3099036">Tree</span><span class="op" id="3099040">)</span>&nbsp;<span class="ident" id="3099042">newVariable</span><span class="op" id="3099053">(</span><span class="ident" id="3099054">pos</span>&nbsp;<span class="ident" id="3099058">Pos</span><span class="op" id="3099061">,</span>&nbsp;<span class="ident" id="3099063">ident</span>&nbsp;<span class="builtintype" id="3099069">string</span><span class="op" id="3099075">)</span>&nbsp;<span class="op" id="3099077">*</span><span class="ident" id="3099078">VariableNode</span>&nbsp;<span class="op" id="3099091">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099094">return</span>&nbsp;<span class="op" id="3099101">&amp;</span><span class="ident" id="3099102">VariableNode</span><span class="op" id="3099114">{</span><span class="ident" id="3099115">tr</span><span class="op" id="3099117">:</span>&nbsp;<span class="ident" id="3099119">t</span><span class="op" id="3099120">,</span>&nbsp;<span class="ident" id="3099122">NodeType</span><span class="op" id="3099130">:</span>&nbsp;<span class="ident" id="3099132">NodeVariable</span><span class="op" id="3099144">,</span>&nbsp;<span class="ident" id="3099146">Pos</span><span class="op" id="3099149">:</span>&nbsp;<span class="ident" id="3099151">pos</span><span class="op" id="3099154">,</span>&nbsp;<span class="ident" id="3099156">Ident</span><span class="op" id="3099161">:</span>&nbsp;<span class="ident" id="3099163">strings</span><span class="op" id="3099170">.</span><span class="ident" id="3099171">Split</span><span class="op" id="3099176">(</span><span class="ident" id="3099177">ident</span><span class="op" id="3099182">,</span>&nbsp;<span class="string" id="3099184">&#34;.&#34;</span><span class="op" id="3099187">)</span><span class="op" id="3099188">}</span><br>
<span class="lineno"></span><span class="op" id="3099190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3099193">func</span>&nbsp;<span class="op" id="3099198">(</span><span class="ident" id="3099199">v</span>&nbsp;<span class="op" id="3099201">*</span><span class="ident" id="3099202">VariableNode</span><span class="op" id="3099214">)</span>&nbsp;<span class="ident" id="3099216">String</span><span class="op" id="3099222">(</span><span class="op" id="3099223">)</span>&nbsp;<span class="builtintype" id="3099225">string</span>&nbsp;<span class="op" id="3099232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3099235">s</span>&nbsp;<span class="op" id="3099237">:=</span>&nbsp;<span class="string" id="3099240">&#34;&#34;</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099244">for</span>&nbsp;<span class="ident" id="3099248">i</span><span class="op" id="3099249">,</span>&nbsp;<span class="ident" id="3099251">id</span>&nbsp;<span class="op" id="3099254">:=</span>&nbsp;<span class="keyword" id="3099257">range</span>&nbsp;<span class="ident" id="3099263">v</span><span class="op" id="3099264">.</span><span class="ident" id="3099265">Ident</span>&nbsp;<span class="op" id="3099271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099275">if</span>&nbsp;<span class="ident" id="3099278">i</span>&nbsp;<span class="op" id="3099280">&gt;</span>&nbsp;<span class="num" id="3099282">0</span>&nbsp;<span class="op" id="3099284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3099289">s</span>&nbsp;<span class="op" id="3099291">+=</span>&nbsp;<span class="string" id="3099294">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3099300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3099304">s</span>&nbsp;<span class="op" id="3099306">+=</span>&nbsp;<span class="ident" id="3099309">id</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3099313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099316">return</span>&nbsp;<span class="ident" id="3099323">s</span><br>
<span class="lineno"></span><span class="op" id="3099325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3099328">func</span>&nbsp;<span class="op" id="3099333">(</span><span class="ident" id="3099334">v</span>&nbsp;<span class="op" id="3099336">*</span><span class="ident" id="3099337">VariableNode</span><span class="op" id="3099349">)</span>&nbsp;<span class="ident" id="3099351">tree</span><span class="op" id="3099355">(</span><span class="op" id="3099356">)</span>&nbsp;<span class="op" id="3099358">*</span><span class="ident" id="3099359">Tree</span>&nbsp;<span class="op" id="3099364">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099367">return</span>&nbsp;<span class="ident" id="3099374">v</span><span class="op" id="3099375">.</span><span class="ident" id="3099376">tr</span><br>
<span class="lineno"></span><span class="op" id="3099379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3099382">func</span>&nbsp;<span class="op" id="3099387">(</span><span class="ident" id="3099388">v</span>&nbsp;<span class="op" id="3099390">*</span><span class="ident" id="3099391">VariableNode</span><span class="op" id="3099403">)</span>&nbsp;<span class="ident" id="3099405">Copy</span><span class="op" id="3099409">(</span><span class="op" id="3099410">)</span>&nbsp;<span class="ident" id="3099412">Node</span>&nbsp;<span class="op" id="3099417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099420">return</span>&nbsp;<span class="op" id="3099427">&amp;</span><span class="ident" id="3099428">VariableNode</span><span class="op" id="3099440">{</span><span class="ident" id="3099441">tr</span><span class="op" id="3099443">:</span>&nbsp;<span class="ident" id="3099445">v</span><span class="op" id="3099446">.</span><span class="ident" id="3099447">tr</span><span class="op" id="3099449">,</span>&nbsp;<span class="ident" id="3099451">NodeType</span><span class="op" id="3099459">:</span>&nbsp;<span class="ident" id="3099461">NodeVariable</span><span class="op" id="3099473">,</span>&nbsp;<span class="ident" id="3099475">Pos</span><span class="op" id="3099478">:</span>&nbsp;<span class="ident" id="3099480">v</span><span class="op" id="3099481">.</span><span class="ident" id="3099482">Pos</span><span class="op" id="3099485">,</span>&nbsp;<span class="ident" id="3099487">Ident</span><span class="op" id="3099492">:</span>&nbsp;<span class="builtinfunc" id="3099494">append</span><span class="op" id="3099500">(</span><span class="op" id="3099501">[</span><span class="op" id="3099502">]</span><span class="builtintype" id="3099503">string</span><span class="op" id="3099509">{</span><span class="op" id="3099510">}</span><span class="op" id="3099511">,</span>&nbsp;<span class="ident" id="3099513">v</span><span class="op" id="3099514">.</span><span class="ident" id="3099515">Ident</span><span class="op" id="3099520">...</span><span class="op" id="3099523">)</span><span class="op" id="3099524">}</span><br>
<span class="lineno">350</span><span class="op" id="3099526">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3099529">//&nbsp;DotNode&nbsp;holds&nbsp;the&nbsp;special&nbsp;identifier&nbsp;&#39;.&#39;.</span><br>
<span class="lineno"></span><span class="keyword" id="3099574">type</span>&nbsp;<span class="ident" id="3099579">DotNode</span>&nbsp;<span class="keyword" id="3099587">struct</span>&nbsp;<span class="op" id="3099594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3099597">NodeType</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3099607">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3099612">tr</span>&nbsp;<span class="op" id="3099615">*</span><span class="ident" id="3099616">Tree</span><br>
<span class="lineno"></span><span class="op" id="3099621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3099624">func</span>&nbsp;<span class="op" id="3099629">(</span><span class="ident" id="3099630">t</span>&nbsp;<span class="op" id="3099632">*</span><span class="ident" id="3099633">Tree</span><span class="op" id="3099637">)</span>&nbsp;<span class="ident" id="3099639">newDot</span><span class="op" id="3099645">(</span><span class="ident" id="3099646">pos</span>&nbsp;<span class="ident" id="3099650">Pos</span><span class="op" id="3099653">)</span>&nbsp;<span class="op" id="3099655">*</span><span class="ident" id="3099656">DotNode</span>&nbsp;<span class="op" id="3099664">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099667">return</span>&nbsp;<span class="op" id="3099674">&amp;</span><span class="ident" id="3099675">DotNode</span><span class="op" id="3099682">{</span><span class="ident" id="3099683">tr</span><span class="op" id="3099685">:</span>&nbsp;<span class="ident" id="3099687">t</span><span class="op" id="3099688">,</span>&nbsp;<span class="ident" id="3099690">NodeType</span><span class="op" id="3099698">:</span>&nbsp;<span class="ident" id="3099700">NodeDot</span><span class="op" id="3099707">,</span>&nbsp;<span class="ident" id="3099709">Pos</span><span class="op" id="3099712">:</span>&nbsp;<span class="ident" id="3099714">pos</span><span class="op" id="3099717">}</span><br>
<span class="lineno"></span><span class="op" id="3099719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3099722">func</span>&nbsp;<span class="op" id="3099727">(</span><span class="ident" id="3099728">d</span>&nbsp;<span class="op" id="3099730">*</span><span class="ident" id="3099731">DotNode</span><span class="op" id="3099738">)</span>&nbsp;<span class="ident" id="3099740">Type</span><span class="op" id="3099744">(</span><span class="op" id="3099745">)</span>&nbsp;<span class="ident" id="3099747">NodeType</span>&nbsp;<span class="op" id="3099756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3099759">//&nbsp;Override&nbsp;method&nbsp;on&nbsp;embedded&nbsp;NodeType&nbsp;for&nbsp;API&nbsp;compatibility.</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3099823">//&nbsp;TODO:&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem;&nbsp;could&nbsp;change&nbsp;API&nbsp;without&nbsp;effect&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3099891">//&nbsp;api&nbsp;tool&nbsp;complains.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099915">return</span>&nbsp;<span class="ident" id="3099922">NodeDot</span><br>
<span class="lineno"></span><span class="op" id="3099930">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span><span class="keyword" id="3099933">func</span>&nbsp;<span class="op" id="3099938">(</span><span class="ident" id="3099939">d</span>&nbsp;<span class="op" id="3099941">*</span><span class="ident" id="3099942">DotNode</span><span class="op" id="3099949">)</span>&nbsp;<span class="ident" id="3099951">String</span><span class="op" id="3099957">(</span><span class="op" id="3099958">)</span>&nbsp;<span class="builtintype" id="3099960">string</span>&nbsp;<span class="op" id="3099967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099970">return</span>&nbsp;<span class="string" id="3099977">&#34;.&#34;</span><br>
<span class="lineno"></span><span class="op" id="3099981">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3099984">func</span>&nbsp;<span class="op" id="3099989">(</span><span class="ident" id="3099990">d</span>&nbsp;<span class="op" id="3099992">*</span><span class="ident" id="3099993">DotNode</span><span class="op" id="3100000">)</span>&nbsp;<span class="ident" id="3100002">tree</span><span class="op" id="3100006">(</span><span class="op" id="3100007">)</span>&nbsp;<span class="op" id="3100009">*</span><span class="ident" id="3100010">Tree</span>&nbsp;<span class="op" id="3100015">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100018">return</span>&nbsp;<span class="ident" id="3100025">d</span><span class="op" id="3100026">.</span><span class="ident" id="3100027">tr</span><br>
<span class="lineno"></span><span class="op" id="3100030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3100033">func</span>&nbsp;<span class="op" id="3100038">(</span><span class="ident" id="3100039">d</span>&nbsp;<span class="op" id="3100041">*</span><span class="ident" id="3100042">DotNode</span><span class="op" id="3100049">)</span>&nbsp;<span class="ident" id="3100051">Copy</span><span class="op" id="3100055">(</span><span class="op" id="3100056">)</span>&nbsp;<span class="ident" id="3100058">Node</span>&nbsp;<span class="op" id="3100063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100066">return</span>&nbsp;<span class="ident" id="3100073">d</span><span class="op" id="3100074">.</span><span class="ident" id="3100075">tr</span><span class="op" id="3100077">.</span><span class="ident" id="3100078">newDot</span><span class="op" id="3100084">(</span><span class="ident" id="3100085">d</span><span class="op" id="3100086">.</span><span class="ident" id="3100087">Pos</span><span class="op" id="3100090">)</span><br>
<span class="lineno">380</span><span class="op" id="3100092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3100095">//&nbsp;NilNode&nbsp;holds&nbsp;the&nbsp;special&nbsp;identifier&nbsp;&#39;nil&#39;&nbsp;representing&nbsp;an&nbsp;untyped&nbsp;nil&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="3100179">type</span>&nbsp;<span class="ident" id="3100184">NilNode</span>&nbsp;<span class="keyword" id="3100192">struct</span>&nbsp;<span class="op" id="3100199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3100202">NodeType</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3100212">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3100217">tr</span>&nbsp;<span class="op" id="3100220">*</span><span class="ident" id="3100221">Tree</span><br>
<span class="lineno"></span><span class="op" id="3100226">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3100229">func</span>&nbsp;<span class="op" id="3100234">(</span><span class="ident" id="3100235">t</span>&nbsp;<span class="op" id="3100237">*</span><span class="ident" id="3100238">Tree</span><span class="op" id="3100242">)</span>&nbsp;<span class="ident" id="3100244">newNil</span><span class="op" id="3100250">(</span><span class="ident" id="3100251">pos</span>&nbsp;<span class="ident" id="3100255">Pos</span><span class="op" id="3100258">)</span>&nbsp;<span class="op" id="3100260">*</span><span class="ident" id="3100261">NilNode</span>&nbsp;<span class="op" id="3100269">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100272">return</span>&nbsp;<span class="op" id="3100279">&amp;</span><span class="ident" id="3100280">NilNode</span><span class="op" id="3100287">{</span><span class="ident" id="3100288">tr</span><span class="op" id="3100290">:</span>&nbsp;<span class="ident" id="3100292">t</span><span class="op" id="3100293">,</span>&nbsp;<span class="ident" id="3100295">NodeType</span><span class="op" id="3100303">:</span>&nbsp;<span class="ident" id="3100305">NodeNil</span><span class="op" id="3100312">,</span>&nbsp;<span class="ident" id="3100314">Pos</span><span class="op" id="3100317">:</span>&nbsp;<span class="ident" id="3100319">pos</span><span class="op" id="3100322">}</span><br>
<span class="lineno"></span><span class="op" id="3100324">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3100327">func</span>&nbsp;<span class="op" id="3100332">(</span><span class="ident" id="3100333">n</span>&nbsp;<span class="op" id="3100335">*</span><span class="ident" id="3100336">NilNode</span><span class="op" id="3100343">)</span>&nbsp;<span class="ident" id="3100345">Type</span><span class="op" id="3100349">(</span><span class="op" id="3100350">)</span>&nbsp;<span class="ident" id="3100352">NodeType</span>&nbsp;<span class="op" id="3100361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3100364">//&nbsp;Override&nbsp;method&nbsp;on&nbsp;embedded&nbsp;NodeType&nbsp;for&nbsp;API&nbsp;compatibility.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3100428">//&nbsp;TODO:&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem;&nbsp;could&nbsp;change&nbsp;API&nbsp;without&nbsp;effect&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3100496">//&nbsp;api&nbsp;tool&nbsp;complains.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100520">return</span>&nbsp;<span class="ident" id="3100527">NodeNil</span><br>
<span class="lineno"></span><span class="op" id="3100535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span><span class="keyword" id="3100538">func</span>&nbsp;<span class="op" id="3100543">(</span><span class="ident" id="3100544">n</span>&nbsp;<span class="op" id="3100546">*</span><span class="ident" id="3100547">NilNode</span><span class="op" id="3100554">)</span>&nbsp;<span class="ident" id="3100556">String</span><span class="op" id="3100562">(</span><span class="op" id="3100563">)</span>&nbsp;<span class="builtintype" id="3100565">string</span>&nbsp;<span class="op" id="3100572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100575">return</span>&nbsp;<span class="string" id="3100582">&#34;nil&#34;</span><br>
<span class="lineno"></span><span class="op" id="3100588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3100591">func</span>&nbsp;<span class="op" id="3100596">(</span><span class="ident" id="3100597">n</span>&nbsp;<span class="op" id="3100599">*</span><span class="ident" id="3100600">NilNode</span><span class="op" id="3100607">)</span>&nbsp;<span class="ident" id="3100609">tree</span><span class="op" id="3100613">(</span><span class="op" id="3100614">)</span>&nbsp;<span class="op" id="3100616">*</span><span class="ident" id="3100617">Tree</span>&nbsp;<span class="op" id="3100622">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100625">return</span>&nbsp;<span class="ident" id="3100632">n</span><span class="op" id="3100633">.</span><span class="ident" id="3100634">tr</span><br>
<span class="lineno"></span><span class="op" id="3100637">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3100640">func</span>&nbsp;<span class="op" id="3100645">(</span><span class="ident" id="3100646">n</span>&nbsp;<span class="op" id="3100648">*</span><span class="ident" id="3100649">NilNode</span><span class="op" id="3100656">)</span>&nbsp;<span class="ident" id="3100658">Copy</span><span class="op" id="3100662">(</span><span class="op" id="3100663">)</span>&nbsp;<span class="ident" id="3100665">Node</span>&nbsp;<span class="op" id="3100670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100673">return</span>&nbsp;<span class="ident" id="3100680">n</span><span class="op" id="3100681">.</span><span class="ident" id="3100682">tr</span><span class="op" id="3100684">.</span><span class="ident" id="3100685">newNil</span><span class="op" id="3100691">(</span><span class="ident" id="3100692">n</span><span class="op" id="3100693">.</span><span class="ident" id="3100694">Pos</span><span class="op" id="3100697">)</span><br>
<span class="lineno">410</span><span class="op" id="3100699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3100702">//&nbsp;FieldNode&nbsp;holds&nbsp;a&nbsp;field&nbsp;(identifier&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="3100761">//&nbsp;The&nbsp;names&nbsp;may&nbsp;be&nbsp;chained&nbsp;(&#39;.x.y&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="3100799">//&nbsp;The&nbsp;period&nbsp;is&nbsp;dropped&nbsp;from&nbsp;each&nbsp;ident.</span><br>
<span class="lineno">415</span><span class="keyword" id="3100841">type</span>&nbsp;<span class="ident" id="3100846">FieldNode</span>&nbsp;<span class="keyword" id="3100856">struct</span>&nbsp;<span class="op" id="3100863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3100866">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3100876">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3100881">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3100887">*</span><span class="ident" id="3100888">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3100894">Ident</span>&nbsp;<span class="op" id="3100900">[</span><span class="op" id="3100901">]</span><span class="builtintype" id="3100902">string</span>&nbsp;<span class="comment" id="3100909">//&nbsp;The&nbsp;identifiers&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno">420</span><span class="op" id="3100946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3100949">func</span>&nbsp;<span class="op" id="3100954">(</span><span class="ident" id="3100955">t</span>&nbsp;<span class="op" id="3100957">*</span><span class="ident" id="3100958">Tree</span><span class="op" id="3100962">)</span>&nbsp;<span class="ident" id="3100964">newField</span><span class="op" id="3100972">(</span><span class="ident" id="3100973">pos</span>&nbsp;<span class="ident" id="3100977">Pos</span><span class="op" id="3100980">,</span>&nbsp;<span class="ident" id="3100982">ident</span>&nbsp;<span class="builtintype" id="3100988">string</span><span class="op" id="3100994">)</span>&nbsp;<span class="op" id="3100996">*</span><span class="ident" id="3100997">FieldNode</span>&nbsp;<span class="op" id="3101007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3101010">return</span>&nbsp;<span class="op" id="3101017">&amp;</span><span class="ident" id="3101018">FieldNode</span><span class="op" id="3101027">{</span><span class="ident" id="3101028">tr</span><span class="op" id="3101030">:</span>&nbsp;<span class="ident" id="3101032">t</span><span class="op" id="3101033">,</span>&nbsp;<span class="ident" id="3101035">NodeType</span><span class="op" id="3101043">:</span>&nbsp;<span class="ident" id="3101045">NodeField</span><span class="op" id="3101054">,</span>&nbsp;<span class="ident" id="3101056">Pos</span><span class="op" id="3101059">:</span>&nbsp;<span class="ident" id="3101061">pos</span><span class="op" id="3101064">,</span>&nbsp;<span class="ident" id="3101066">Ident</span><span class="op" id="3101071">:</span>&nbsp;<span class="ident" id="3101073">strings</span><span class="op" id="3101080">.</span><span class="ident" id="3101081">Split</span><span class="op" id="3101086">(</span><span class="ident" id="3101087">ident</span><span class="op" id="3101092">[</span><span class="num" id="3101093">1</span><span class="op" id="3101094">:</span><span class="op" id="3101095">]</span><span class="op" id="3101096">,</span>&nbsp;<span class="string" id="3101098">&#34;.&#34;</span><span class="op" id="3101101">)</span><span class="op" id="3101102">}</span>&nbsp;<span class="comment" id="3101104">//&nbsp;[1:]&nbsp;to&nbsp;drop&nbsp;leading&nbsp;period</span><br>
<span class="lineno"></span><span class="op" id="3101135">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span><span class="keyword" id="3101138">func</span>&nbsp;<span class="op" id="3101143">(</span><span class="ident" id="3101144">f</span>&nbsp;<span class="op" id="3101146">*</span><span class="ident" id="3101147">FieldNode</span><span class="op" id="3101156">)</span>&nbsp;<span class="ident" id="3101158">String</span><span class="op" id="3101164">(</span><span class="op" id="3101165">)</span>&nbsp;<span class="builtintype" id="3101167">string</span>&nbsp;<span class="op" id="3101174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3101177">s</span>&nbsp;<span class="op" id="3101179">:=</span>&nbsp;<span class="string" id="3101182">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3101186">for</span>&nbsp;<span class="ident" id="3101190">_</span><span class="op" id="3101191">,</span>&nbsp;<span class="ident" id="3101193">id</span>&nbsp;<span class="op" id="3101196">:=</span>&nbsp;<span class="keyword" id="3101199">range</span>&nbsp;<span class="ident" id="3101205">f</span><span class="op" id="3101206">.</span><span class="ident" id="3101207">Ident</span>&nbsp;<span class="op" id="3101213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3101217">s</span>&nbsp;<span class="op" id="3101219">+=</span>&nbsp;<span class="string" id="3101222">&#34;.&#34;</span>&nbsp;<span class="op" id="3101226">+</span>&nbsp;<span class="ident" id="3101228">id</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3101232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3101235">return</span>&nbsp;<span class="ident" id="3101242">s</span><br>
<span class="lineno"></span><span class="op" id="3101244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3101247">func</span>&nbsp;<span class="op" id="3101252">(</span><span class="ident" id="3101253">f</span>&nbsp;<span class="op" id="3101255">*</span><span class="ident" id="3101256">FieldNode</span><span class="op" id="3101265">)</span>&nbsp;<span class="ident" id="3101267">tree</span><span class="op" id="3101271">(</span><span class="op" id="3101272">)</span>&nbsp;<span class="op" id="3101274">*</span><span class="ident" id="3101275">Tree</span>&nbsp;<span class="op" id="3101280">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3101283">return</span>&nbsp;<span class="ident" id="3101290">f</span><span class="op" id="3101291">.</span><span class="ident" id="3101292">tr</span><br>
<span class="lineno"></span><span class="op" id="3101295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3101298">func</span>&nbsp;<span class="op" id="3101303">(</span><span class="ident" id="3101304">f</span>&nbsp;<span class="op" id="3101306">*</span><span class="ident" id="3101307">FieldNode</span><span class="op" id="3101316">)</span>&nbsp;<span class="ident" id="3101318">Copy</span><span class="op" id="3101322">(</span><span class="op" id="3101323">)</span>&nbsp;<span class="ident" id="3101325">Node</span>&nbsp;<span class="op" id="3101330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3101333">return</span>&nbsp;<span class="op" id="3101340">&amp;</span><span class="ident" id="3101341">FieldNode</span><span class="op" id="3101350">{</span><span class="ident" id="3101351">tr</span><span class="op" id="3101353">:</span>&nbsp;<span class="ident" id="3101355">f</span><span class="op" id="3101356">.</span><span class="ident" id="3101357">tr</span><span class="op" id="3101359">,</span>&nbsp;<span class="ident" id="3101361">NodeType</span><span class="op" id="3101369">:</span>&nbsp;<span class="ident" id="3101371">NodeField</span><span class="op" id="3101380">,</span>&nbsp;<span class="ident" id="3101382">Pos</span><span class="op" id="3101385">:</span>&nbsp;<span class="ident" id="3101387">f</span><span class="op" id="3101388">.</span><span class="ident" id="3101389">Pos</span><span class="op" id="3101392">,</span>&nbsp;<span class="ident" id="3101394">Ident</span><span class="op" id="3101399">:</span>&nbsp;<span class="builtinfunc" id="3101401">append</span><span class="op" id="3101407">(</span><span class="op" id="3101408">[</span><span class="op" id="3101409">]</span><span class="builtintype" id="3101410">string</span><span class="op" id="3101416">{</span><span class="op" id="3101417">}</span><span class="op" id="3101418">,</span>&nbsp;<span class="ident" id="3101420">f</span><span class="op" id="3101421">.</span><span class="ident" id="3101422">Ident</span><span class="op" id="3101427">...</span><span class="op" id="3101430">)</span><span class="op" id="3101431">}</span><br>
<span class="lineno">440</span><span class="op" id="3101433">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3101436">//&nbsp;ChainNode&nbsp;holds&nbsp;a&nbsp;term&nbsp;followed&nbsp;by&nbsp;a&nbsp;chain&nbsp;of&nbsp;field&nbsp;accesses&nbsp;(identifier&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="3101532">//&nbsp;The&nbsp;names&nbsp;may&nbsp;be&nbsp;chained&nbsp;(&#39;.x.y&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="3101570">//&nbsp;The&nbsp;periods&nbsp;are&nbsp;dropped&nbsp;from&nbsp;each&nbsp;ident.</span><br>
<span class="lineno">445</span><span class="keyword" id="3101614">type</span>&nbsp;<span class="ident" id="3101619">ChainNode</span>&nbsp;<span class="keyword" id="3101629">struct</span>&nbsp;<span class="op" id="3101636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3101639">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3101649">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3101654">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3101660">*</span><span class="ident" id="3101661">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3101667">Node</span>&nbsp;&nbsp;<span class="ident" id="3101673">Node</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3101679">Field</span>&nbsp;<span class="op" id="3101685">[</span><span class="op" id="3101686">]</span><span class="builtintype" id="3101687">string</span>&nbsp;<span class="comment" id="3101694">//&nbsp;The&nbsp;identifiers&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="3101731">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3101734">func</span>&nbsp;<span class="op" id="3101739">(</span><span class="ident" id="3101740">t</span>&nbsp;<span class="op" id="3101742">*</span><span class="ident" id="3101743">Tree</span><span class="op" id="3101747">)</span>&nbsp;<span class="ident" id="3101749">newChain</span><span class="op" id="3101757">(</span><span class="ident" id="3101758">pos</span>&nbsp;<span class="ident" id="3101762">Pos</span><span class="op" id="3101765">,</span>&nbsp;<span class="ident" id="3101767">node</span>&nbsp;<span class="ident" id="3101772">Node</span><span class="op" id="3101776">)</span>&nbsp;<span class="op" id="3101778">*</span><span class="ident" id="3101779">ChainNode</span>&nbsp;<span class="op" id="3101789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3101792">return</span>&nbsp;<span class="op" id="3101799">&amp;</span><span class="ident" id="3101800">ChainNode</span><span class="op" id="3101809">{</span><span class="ident" id="3101810">tr</span><span class="op" id="3101812">:</span>&nbsp;<span class="ident" id="3101814">t</span><span class="op" id="3101815">,</span>&nbsp;<span class="ident" id="3101817">NodeType</span><span class="op" id="3101825">:</span>&nbsp;<span class="ident" id="3101827">NodeChain</span><span class="op" id="3101836">,</span>&nbsp;<span class="ident" id="3101838">Pos</span><span class="op" id="3101841">:</span>&nbsp;<span class="ident" id="3101843">pos</span><span class="op" id="3101846">,</span>&nbsp;<span class="ident" id="3101848">Node</span><span class="op" id="3101852">:</span>&nbsp;<span class="ident" id="3101854">node</span><span class="op" id="3101858">}</span><br>
<span class="lineno">455</span><span class="op" id="3101860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3101863">//&nbsp;Add&nbsp;adds&nbsp;the&nbsp;named&nbsp;field&nbsp;(which&nbsp;should&nbsp;start&nbsp;with&nbsp;a&nbsp;period)&nbsp;to&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;chain.</span><br>
<span class="lineno"></span><span class="keyword" id="3101951">func</span>&nbsp;<span class="op" id="3101956">(</span><span class="ident" id="3101957">c</span>&nbsp;<span class="op" id="3101959">*</span><span class="ident" id="3101960">ChainNode</span><span class="op" id="3101969">)</span>&nbsp;<span class="ident" id="3101971">Add</span><span class="op" id="3101974">(</span><span class="ident" id="3101975">field</span>&nbsp;<span class="builtintype" id="3101981">string</span><span class="op" id="3101987">)</span>&nbsp;<span class="op" id="3101989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3101992">if</span>&nbsp;<span class="builtinfunc" id="3101995">len</span><span class="op" id="3101998">(</span><span class="ident" id="3101999">field</span><span class="op" id="3102004">)</span>&nbsp;<span class="op" id="3102006">==</span>&nbsp;<span class="num" id="3102009">0</span>&nbsp;<span class="op" id="3102011">||</span>&nbsp;<span class="ident" id="3102014">field</span><span class="op" id="3102019">[</span><span class="num" id="3102020">0</span><span class="op" id="3102021">]</span>&nbsp;<span class="op" id="3102023">!=</span>&nbsp;<span class="string" id="3102026">&#39;.&#39;</span>&nbsp;<span class="op" id="3102030">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3102034">panic</span><span class="op" id="3102039">(</span><span class="string" id="3102040">&#34;no&nbsp;dot&nbsp;in&nbsp;field&#34;</span><span class="op" id="3102057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3102060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3102063">field</span>&nbsp;<span class="op" id="3102069">=</span>&nbsp;<span class="ident" id="3102071">field</span><span class="op" id="3102076">[</span><span class="num" id="3102077">1</span><span class="op" id="3102078">:</span><span class="op" id="3102079">]</span>&nbsp;<span class="comment" id="3102081">//&nbsp;Remove&nbsp;leading&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102105">if</span>&nbsp;<span class="ident" id="3102108">field</span>&nbsp;<span class="op" id="3102114">==</span>&nbsp;<span class="string" id="3102117">&#34;&#34;</span>&nbsp;<span class="op" id="3102120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3102124">panic</span><span class="op" id="3102129">(</span><span class="string" id="3102130">&#34;empty&nbsp;field&#34;</span><span class="op" id="3102143">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3102146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3102149">c</span><span class="op" id="3102150">.</span><span class="ident" id="3102151">Field</span>&nbsp;<span class="op" id="3102157">=</span>&nbsp;<span class="builtinfunc" id="3102159">append</span><span class="op" id="3102165">(</span><span class="ident" id="3102166">c</span><span class="op" id="3102167">.</span><span class="ident" id="3102168">Field</span><span class="op" id="3102173">,</span>&nbsp;<span class="ident" id="3102175">field</span><span class="op" id="3102180">)</span><br>
<span class="lineno"></span><span class="op" id="3102182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3102185">func</span>&nbsp;<span class="op" id="3102190">(</span><span class="ident" id="3102191">c</span>&nbsp;<span class="op" id="3102193">*</span><span class="ident" id="3102194">ChainNode</span><span class="op" id="3102203">)</span>&nbsp;<span class="ident" id="3102205">String</span><span class="op" id="3102211">(</span><span class="op" id="3102212">)</span>&nbsp;<span class="builtintype" id="3102214">string</span>&nbsp;<span class="op" id="3102221">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3102224">s</span>&nbsp;<span class="op" id="3102226">:=</span>&nbsp;<span class="ident" id="3102229">c</span><span class="op" id="3102230">.</span><span class="ident" id="3102231">Node</span><span class="op" id="3102235">.</span><span class="ident" id="3102236">String</span><span class="op" id="3102242">(</span><span class="op" id="3102243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102246">if</span>&nbsp;<span class="ident" id="3102249">_</span><span class="op" id="3102250">,</span>&nbsp;<span class="ident" id="3102252">ok</span>&nbsp;<span class="op" id="3102255">:=</span>&nbsp;<span class="ident" id="3102258">c</span><span class="op" id="3102259">.</span><span class="ident" id="3102260">Node</span><span class="op" id="3102264">.</span><span class="op" id="3102265">(</span><span class="op" id="3102266">*</span><span class="ident" id="3102267">PipeNode</span><span class="op" id="3102275">)</span><span class="op" id="3102276">;</span>&nbsp;<span class="ident" id="3102278">ok</span>&nbsp;<span class="op" id="3102281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3102285">s</span>&nbsp;<span class="op" id="3102287">=</span>&nbsp;<span class="string" id="3102289">&#34;(&#34;</span>&nbsp;<span class="op" id="3102293">+</span>&nbsp;<span class="ident" id="3102295">s</span>&nbsp;<span class="op" id="3102297">+</span>&nbsp;<span class="string" id="3102299">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3102304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102307">for</span>&nbsp;<span class="ident" id="3102311">_</span><span class="op" id="3102312">,</span>&nbsp;<span class="ident" id="3102314">field</span>&nbsp;<span class="op" id="3102320">:=</span>&nbsp;<span class="keyword" id="3102323">range</span>&nbsp;<span class="ident" id="3102329">c</span><span class="op" id="3102330">.</span><span class="ident" id="3102331">Field</span>&nbsp;<span class="op" id="3102337">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3102341">s</span>&nbsp;<span class="op" id="3102343">+=</span>&nbsp;<span class="string" id="3102346">&#34;.&#34;</span>&nbsp;<span class="op" id="3102350">+</span>&nbsp;<span class="ident" id="3102352">field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3102359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102362">return</span>&nbsp;<span class="ident" id="3102369">s</span><br>
<span class="lineno"></span><span class="op" id="3102371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="keyword" id="3102374">func</span>&nbsp;<span class="op" id="3102379">(</span><span class="ident" id="3102380">c</span>&nbsp;<span class="op" id="3102382">*</span><span class="ident" id="3102383">ChainNode</span><span class="op" id="3102392">)</span>&nbsp;<span class="ident" id="3102394">tree</span><span class="op" id="3102398">(</span><span class="op" id="3102399">)</span>&nbsp;<span class="op" id="3102401">*</span><span class="ident" id="3102402">Tree</span>&nbsp;<span class="op" id="3102407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102410">return</span>&nbsp;<span class="ident" id="3102417">c</span><span class="op" id="3102418">.</span><span class="ident" id="3102419">tr</span><br>
<span class="lineno"></span><span class="op" id="3102422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3102425">func</span>&nbsp;<span class="op" id="3102430">(</span><span class="ident" id="3102431">c</span>&nbsp;<span class="op" id="3102433">*</span><span class="ident" id="3102434">ChainNode</span><span class="op" id="3102443">)</span>&nbsp;<span class="ident" id="3102445">Copy</span><span class="op" id="3102449">(</span><span class="op" id="3102450">)</span>&nbsp;<span class="ident" id="3102452">Node</span>&nbsp;<span class="op" id="3102457">{</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102460">return</span>&nbsp;<span class="op" id="3102467">&amp;</span><span class="ident" id="3102468">ChainNode</span><span class="op" id="3102477">{</span><span class="ident" id="3102478">tr</span><span class="op" id="3102480">:</span>&nbsp;<span class="ident" id="3102482">c</span><span class="op" id="3102483">.</span><span class="ident" id="3102484">tr</span><span class="op" id="3102486">,</span>&nbsp;<span class="ident" id="3102488">NodeType</span><span class="op" id="3102496">:</span>&nbsp;<span class="ident" id="3102498">NodeChain</span><span class="op" id="3102507">,</span>&nbsp;<span class="ident" id="3102509">Pos</span><span class="op" id="3102512">:</span>&nbsp;<span class="ident" id="3102514">c</span><span class="op" id="3102515">.</span><span class="ident" id="3102516">Pos</span><span class="op" id="3102519">,</span>&nbsp;<span class="ident" id="3102521">Node</span><span class="op" id="3102525">:</span>&nbsp;<span class="ident" id="3102527">c</span><span class="op" id="3102528">.</span><span class="ident" id="3102529">Node</span><span class="op" id="3102533">,</span>&nbsp;<span class="ident" id="3102535">Field</span><span class="op" id="3102540">:</span>&nbsp;<span class="builtinfunc" id="3102542">append</span><span class="op" id="3102548">(</span><span class="op" id="3102549">[</span><span class="op" id="3102550">]</span><span class="builtintype" id="3102551">string</span><span class="op" id="3102557">{</span><span class="op" id="3102558">}</span><span class="op" id="3102559">,</span>&nbsp;<span class="ident" id="3102561">c</span><span class="op" id="3102562">.</span><span class="ident" id="3102563">Field</span><span class="op" id="3102568">...</span><span class="op" id="3102571">)</span><span class="op" id="3102572">}</span><br>
<span class="lineno"></span><span class="op" id="3102574">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3102577">//&nbsp;BoolNode&nbsp;holds&nbsp;a&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="3102615">type</span>&nbsp;<span class="ident" id="3102620">BoolNode</span>&nbsp;<span class="keyword" id="3102629">struct</span>&nbsp;<span class="op" id="3102636">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3102639">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3102649">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3102654">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3102659">*</span><span class="ident" id="3102660">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3102666">True</span>&nbsp;<span class="builtintype" id="3102671">bool</span>&nbsp;<span class="comment" id="3102676">//&nbsp;The&nbsp;value&nbsp;of&nbsp;the&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno"></span><span class="op" id="3102714">}</span><br>
<span class="lineno">495</span><br>
<span class="lineno"></span><span class="keyword" id="3102717">func</span>&nbsp;<span class="op" id="3102722">(</span><span class="ident" id="3102723">t</span>&nbsp;<span class="op" id="3102725">*</span><span class="ident" id="3102726">Tree</span><span class="op" id="3102730">)</span>&nbsp;<span class="ident" id="3102732">newBool</span><span class="op" id="3102739">(</span><span class="ident" id="3102740">pos</span>&nbsp;<span class="ident" id="3102744">Pos</span><span class="op" id="3102747">,</span>&nbsp;<span class="builtintype" id="3102749">true</span>&nbsp;<span class="builtintype" id="3102754">bool</span><span class="op" id="3102758">)</span>&nbsp;<span class="op" id="3102760">*</span><span class="ident" id="3102761">BoolNode</span>&nbsp;<span class="op" id="3102770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102773">return</span>&nbsp;<span class="op" id="3102780">&amp;</span><span class="ident" id="3102781">BoolNode</span><span class="op" id="3102789">{</span><span class="ident" id="3102790">tr</span><span class="op" id="3102792">:</span>&nbsp;<span class="ident" id="3102794">t</span><span class="op" id="3102795">,</span>&nbsp;<span class="ident" id="3102797">NodeType</span><span class="op" id="3102805">:</span>&nbsp;<span class="ident" id="3102807">NodeBool</span><span class="op" id="3102815">,</span>&nbsp;<span class="ident" id="3102817">Pos</span><span class="op" id="3102820">:</span>&nbsp;<span class="ident" id="3102822">pos</span><span class="op" id="3102825">,</span>&nbsp;<span class="ident" id="3102827">True</span><span class="op" id="3102831">:</span>&nbsp;<span class="builtintype" id="3102833">true</span><span class="op" id="3102837">}</span><br>
<span class="lineno"></span><span class="op" id="3102839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span><span class="keyword" id="3102842">func</span>&nbsp;<span class="op" id="3102847">(</span><span class="ident" id="3102848">b</span>&nbsp;<span class="op" id="3102850">*</span><span class="ident" id="3102851">BoolNode</span><span class="op" id="3102859">)</span>&nbsp;<span class="ident" id="3102861">String</span><span class="op" id="3102867">(</span><span class="op" id="3102868">)</span>&nbsp;<span class="builtintype" id="3102870">string</span>&nbsp;<span class="op" id="3102877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102880">if</span>&nbsp;<span class="ident" id="3102883">b</span><span class="op" id="3102884">.</span><span class="ident" id="3102885">True</span>&nbsp;<span class="op" id="3102890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102894">return</span>&nbsp;<span class="string" id="3102901">&#34;true&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3102909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102912">return</span>&nbsp;<span class="string" id="3102919">&#34;false&#34;</span><br>
<span class="lineno">505</span><span class="op" id="3102927">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3102930">func</span>&nbsp;<span class="op" id="3102935">(</span><span class="ident" id="3102936">b</span>&nbsp;<span class="op" id="3102938">*</span><span class="ident" id="3102939">BoolNode</span><span class="op" id="3102947">)</span>&nbsp;<span class="ident" id="3102949">tree</span><span class="op" id="3102953">(</span><span class="op" id="3102954">)</span>&nbsp;<span class="op" id="3102956">*</span><span class="ident" id="3102957">Tree</span>&nbsp;<span class="op" id="3102962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102965">return</span>&nbsp;<span class="ident" id="3102972">b</span><span class="op" id="3102973">.</span><span class="ident" id="3102974">tr</span><br>
<span class="lineno"></span><span class="op" id="3102977">}</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span><span class="keyword" id="3102980">func</span>&nbsp;<span class="op" id="3102985">(</span><span class="ident" id="3102986">b</span>&nbsp;<span class="op" id="3102988">*</span><span class="ident" id="3102989">BoolNode</span><span class="op" id="3102997">)</span>&nbsp;<span class="ident" id="3102999">Copy</span><span class="op" id="3103003">(</span><span class="op" id="3103004">)</span>&nbsp;<span class="ident" id="3103006">Node</span>&nbsp;<span class="op" id="3103011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103014">return</span>&nbsp;<span class="ident" id="3103021">b</span><span class="op" id="3103022">.</span><span class="ident" id="3103023">tr</span><span class="op" id="3103025">.</span><span class="ident" id="3103026">newBool</span><span class="op" id="3103033">(</span><span class="ident" id="3103034">b</span><span class="op" id="3103035">.</span><span class="ident" id="3103036">Pos</span><span class="op" id="3103039">,</span>&nbsp;<span class="ident" id="3103041">b</span><span class="op" id="3103042">.</span><span class="ident" id="3103043">True</span><span class="op" id="3103047">)</span><br>
<span class="lineno"></span><span class="op" id="3103049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="comment" id="3103052">//&nbsp;NumberNode&nbsp;holds&nbsp;a&nbsp;number:&nbsp;signed&nbsp;or&nbsp;unsigned&nbsp;integer,&nbsp;float,&nbsp;or&nbsp;complex.</span><br>
<span class="lineno"></span><span class="comment" id="3103129">//&nbsp;The&nbsp;value&nbsp;is&nbsp;parsed&nbsp;and&nbsp;stored&nbsp;under&nbsp;all&nbsp;the&nbsp;types&nbsp;that&nbsp;can&nbsp;represent&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="3103213">//&nbsp;This&nbsp;simulates&nbsp;in&nbsp;a&nbsp;small&nbsp;amount&nbsp;of&nbsp;code&nbsp;the&nbsp;behavior&nbsp;of&nbsp;Go&#39;s&nbsp;ideal&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="3103295">type</span>&nbsp;<span class="ident" id="3103300">NumberNode</span>&nbsp;<span class="keyword" id="3103311">struct</span>&nbsp;<span class="op" id="3103318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103321">NodeType</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103331">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103336">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3103347">*</span><span class="ident" id="3103348">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103354">IsInt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3103365">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3103376">//&nbsp;Number&nbsp;has&nbsp;an&nbsp;integral&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103410">IsUint</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3103421">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3103432">//&nbsp;Number&nbsp;has&nbsp;an&nbsp;unsigned&nbsp;integral&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103475">IsFloat</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3103486">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3103497">//&nbsp;Number&nbsp;has&nbsp;a&nbsp;floating-point&nbsp;value.</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103536">IsComplex</span>&nbsp;&nbsp;<span class="builtintype" id="3103547">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3103558">//&nbsp;Number&nbsp;is&nbsp;complex.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103581">Int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3103592">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3103603">//&nbsp;The&nbsp;signed&nbsp;integer&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103633">Uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3103644">uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3103655">//&nbsp;The&nbsp;unsigned&nbsp;integer&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103687">Float64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3103698">float64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3103709">//&nbsp;The&nbsp;floating-point&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103739">Complex128</span>&nbsp;<span class="builtintype" id="3103750">complex128</span>&nbsp;<span class="comment" id="3103761">//&nbsp;The&nbsp;complex&nbsp;value.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103784">Text</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3103795">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3103806">//&nbsp;The&nbsp;original&nbsp;textual&nbsp;representation&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="op" id="3103861">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3103864">func</span>&nbsp;<span class="op" id="3103869">(</span><span class="ident" id="3103870">t</span>&nbsp;<span class="op" id="3103872">*</span><span class="ident" id="3103873">Tree</span><span class="op" id="3103877">)</span>&nbsp;<span class="ident" id="3103879">newNumber</span><span class="op" id="3103888">(</span><span class="ident" id="3103889">pos</span>&nbsp;<span class="ident" id="3103893">Pos</span><span class="op" id="3103896">,</span>&nbsp;<span class="ident" id="3103898">text</span>&nbsp;<span class="builtintype" id="3103903">string</span><span class="op" id="3103909">,</span>&nbsp;<span class="ident" id="3103911">typ</span>&nbsp;<span class="ident" id="3103915">itemType</span><span class="op" id="3103923">)</span>&nbsp;<span class="op" id="3103925">(</span><span class="op" id="3103926">*</span><span class="ident" id="3103927">NumberNode</span><span class="op" id="3103937">,</span>&nbsp;<span class="builtintype" id="3103939">error</span><span class="op" id="3103944">)</span>&nbsp;<span class="op" id="3103946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103949">n</span>&nbsp;<span class="op" id="3103951">:=</span>&nbsp;<span class="op" id="3103954">&amp;</span><span class="ident" id="3103955">NumberNode</span><span class="op" id="3103965">{</span><span class="ident" id="3103966">tr</span><span class="op" id="3103968">:</span>&nbsp;<span class="ident" id="3103970">t</span><span class="op" id="3103971">,</span>&nbsp;<span class="ident" id="3103973">NodeType</span><span class="op" id="3103981">:</span>&nbsp;<span class="ident" id="3103983">NodeNumber</span><span class="op" id="3103993">,</span>&nbsp;<span class="ident" id="3103995">Pos</span><span class="op" id="3103998">:</span>&nbsp;<span class="ident" id="3104000">pos</span><span class="op" id="3104003">,</span>&nbsp;<span class="ident" id="3104005">Text</span><span class="op" id="3104009">:</span>&nbsp;<span class="ident" id="3104011">text</span><span class="op" id="3104015">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104018">switch</span>&nbsp;<span class="ident" id="3104025">typ</span>&nbsp;<span class="op" id="3104029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104032">case</span>&nbsp;<span class="ident" id="3104037">itemCharConstant</span><span class="op" id="3104053">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3104057">rune</span><span class="op" id="3104061">,</span>&nbsp;<span class="ident" id="3104063">_</span><span class="op" id="3104064">,</span>&nbsp;<span class="ident" id="3104066">tail</span><span class="op" id="3104070">,</span>&nbsp;<span class="ident" id="3104072">err</span>&nbsp;<span class="op" id="3104076">:=</span>&nbsp;<span class="ident" id="3104079">strconv</span><span class="op" id="3104086">.</span><span class="ident" id="3104087">UnquoteChar</span><span class="op" id="3104098">(</span><span class="ident" id="3104099">text</span><span class="op" id="3104103">[</span><span class="num" id="3104104">1</span><span class="op" id="3104105">:</span><span class="op" id="3104106">]</span><span class="op" id="3104107">,</span>&nbsp;<span class="ident" id="3104109">text</span><span class="op" id="3104113">[</span><span class="num" id="3104114">0</span><span class="op" id="3104115">]</span><span class="op" id="3104116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104120">if</span>&nbsp;<span class="ident" id="3104123">err</span>&nbsp;<span class="op" id="3104127">!=</span>&nbsp;<span class="builtintype" id="3104130">nil</span>&nbsp;<span class="op" id="3104134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104139">return</span>&nbsp;<span class="builtintype" id="3104146">nil</span><span class="op" id="3104149">,</span>&nbsp;<span class="ident" id="3104151">err</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3104157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104161">if</span>&nbsp;<span class="ident" id="3104164">tail</span>&nbsp;<span class="op" id="3104169">!=</span>&nbsp;<span class="string" id="3104172">&#34;&#39;&#34;</span>&nbsp;<span class="op" id="3104176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104181">return</span>&nbsp;<span class="builtintype" id="3104188">nil</span><span class="op" id="3104191">,</span>&nbsp;<span class="ident" id="3104193">fmt</span><span class="op" id="3104196">.</span><span class="ident" id="3104197">Errorf</span><span class="op" id="3104203">(</span><span class="string" id="3104204">&#34;malformed&nbsp;character&nbsp;constant:&nbsp;%s&#34;</span><span class="op" id="3104238">,</span>&nbsp;<span class="ident" id="3104240">text</span><span class="op" id="3104244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3104248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104252">n</span><span class="op" id="3104253">.</span><span class="ident" id="3104254">Int64</span>&nbsp;<span class="op" id="3104260">=</span>&nbsp;<span class="builtintype" id="3104262">int64</span><span class="op" id="3104267">(</span><span class="builtintype" id="3104268">rune</span><span class="op" id="3104272">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104276">n</span><span class="op" id="3104277">.</span><span class="ident" id="3104278">IsInt</span>&nbsp;<span class="op" id="3104284">=</span>&nbsp;<span class="builtintype" id="3104286">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104293">n</span><span class="op" id="3104294">.</span><span class="ident" id="3104295">Uint64</span>&nbsp;<span class="op" id="3104302">=</span>&nbsp;<span class="builtintype" id="3104304">uint64</span><span class="op" id="3104310">(</span><span class="builtintype" id="3104311">rune</span><span class="op" id="3104315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104319">n</span><span class="op" id="3104320">.</span><span class="ident" id="3104321">IsUint</span>&nbsp;<span class="op" id="3104328">=</span>&nbsp;<span class="builtintype" id="3104330">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104337">n</span><span class="op" id="3104338">.</span><span class="ident" id="3104339">Float64</span>&nbsp;<span class="op" id="3104347">=</span>&nbsp;<span class="builtintype" id="3104349">float64</span><span class="op" id="3104356">(</span><span class="builtintype" id="3104357">rune</span><span class="op" id="3104361">)</span>&nbsp;<span class="comment" id="3104363">//&nbsp;odd&nbsp;but&nbsp;those&nbsp;are&nbsp;the&nbsp;rules.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104397">n</span><span class="op" id="3104398">.</span><span class="ident" id="3104399">IsFloat</span>&nbsp;<span class="op" id="3104407">=</span>&nbsp;<span class="builtintype" id="3104409">true</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104416">return</span>&nbsp;<span class="ident" id="3104423">n</span><span class="op" id="3104424">,</span>&nbsp;<span class="builtintype" id="3104426">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104431">case</span>&nbsp;<span class="ident" id="3104436">itemComplex</span><span class="op" id="3104447">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3104451">//&nbsp;fmt.Sscan&nbsp;can&nbsp;parse&nbsp;the&nbsp;pair,&nbsp;so&nbsp;let&nbsp;it&nbsp;do&nbsp;the&nbsp;work.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104509">if</span>&nbsp;<span class="ident" id="3104512">_</span><span class="op" id="3104513">,</span>&nbsp;<span class="ident" id="3104515">err</span>&nbsp;<span class="op" id="3104519">:=</span>&nbsp;<span class="ident" id="3104522">fmt</span><span class="op" id="3104525">.</span><span class="ident" id="3104526">Sscan</span><span class="op" id="3104531">(</span><span class="ident" id="3104532">text</span><span class="op" id="3104536">,</span>&nbsp;<span class="op" id="3104538">&amp;</span><span class="ident" id="3104539">n</span><span class="op" id="3104540">.</span><span class="ident" id="3104541">Complex128</span><span class="op" id="3104551">)</span><span class="op" id="3104552">;</span>&nbsp;<span class="ident" id="3104554">err</span>&nbsp;<span class="op" id="3104558">!=</span>&nbsp;<span class="builtintype" id="3104561">nil</span>&nbsp;<span class="op" id="3104565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104570">return</span>&nbsp;<span class="builtintype" id="3104577">nil</span><span class="op" id="3104580">,</span>&nbsp;<span class="ident" id="3104582">err</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3104588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104592">n</span><span class="op" id="3104593">.</span><span class="ident" id="3104594">IsComplex</span>&nbsp;<span class="op" id="3104604">=</span>&nbsp;<span class="builtintype" id="3104606">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104613">n</span><span class="op" id="3104614">.</span><span class="ident" id="3104615">simplifyComplex</span><span class="op" id="3104630">(</span><span class="op" id="3104631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104635">return</span>&nbsp;<span class="ident" id="3104642">n</span><span class="op" id="3104643">,</span>&nbsp;<span class="builtintype" id="3104645">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3104650">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3104653">//&nbsp;Imaginary&nbsp;constants&nbsp;can&nbsp;only&nbsp;be&nbsp;complex&nbsp;unless&nbsp;they&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104719">if</span>&nbsp;<span class="builtinfunc" id="3104722">len</span><span class="op" id="3104725">(</span><span class="ident" id="3104726">text</span><span class="op" id="3104730">)</span>&nbsp;<span class="op" id="3104732">&gt;</span>&nbsp;<span class="num" id="3104734">0</span>&nbsp;<span class="op" id="3104736">&amp;&amp;</span>&nbsp;<span class="ident" id="3104739">text</span><span class="op" id="3104743">[</span><span class="builtinfunc" id="3104744">len</span><span class="op" id="3104747">(</span><span class="ident" id="3104748">text</span><span class="op" id="3104752">)</span><span class="op" id="3104753">-</span><span class="num" id="3104754">1</span><span class="op" id="3104755">]</span>&nbsp;<span class="op" id="3104757">==</span>&nbsp;<span class="string" id="3104760">&#39;i&#39;</span>&nbsp;<span class="op" id="3104764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104768">f</span><span class="op" id="3104769">,</span>&nbsp;<span class="ident" id="3104771">err</span>&nbsp;<span class="op" id="3104775">:=</span>&nbsp;<span class="ident" id="3104778">strconv</span><span class="op" id="3104785">.</span><span class="ident" id="3104786">ParseFloat</span><span class="op" id="3104796">(</span><span class="ident" id="3104797">text</span><span class="op" id="3104801">[</span><span class="op" id="3104802">:</span><span class="builtinfunc" id="3104803">len</span><span class="op" id="3104806">(</span><span class="ident" id="3104807">text</span><span class="op" id="3104811">)</span><span class="op" id="3104812">-</span><span class="num" id="3104813">1</span><span class="op" id="3104814">]</span><span class="op" id="3104815">,</span>&nbsp;<span class="num" id="3104817">64</span><span class="op" id="3104819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104823">if</span>&nbsp;<span class="ident" id="3104826">err</span>&nbsp;<span class="op" id="3104830">==</span>&nbsp;<span class="builtintype" id="3104833">nil</span>&nbsp;<span class="op" id="3104837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104842">n</span><span class="op" id="3104843">.</span><span class="ident" id="3104844">IsComplex</span>&nbsp;<span class="op" id="3104854">=</span>&nbsp;<span class="builtintype" id="3104856">true</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104864">n</span><span class="op" id="3104865">.</span><span class="ident" id="3104866">Complex128</span>&nbsp;<span class="op" id="3104877">=</span>&nbsp;<span class="builtinfunc" id="3104879">complex</span><span class="op" id="3104886">(</span><span class="num" id="3104887">0</span><span class="op" id="3104888">,</span>&nbsp;<span class="ident" id="3104890">f</span><span class="op" id="3104891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104896">n</span><span class="op" id="3104897">.</span><span class="ident" id="3104898">simplifyComplex</span><span class="op" id="3104913">(</span><span class="op" id="3104914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104919">return</span>&nbsp;<span class="ident" id="3104926">n</span><span class="op" id="3104927">,</span>&nbsp;<span class="builtintype" id="3104929">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3104935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3104938">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3104941">//&nbsp;Do&nbsp;integer&nbsp;test&nbsp;first&nbsp;so&nbsp;we&nbsp;get&nbsp;0x123&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104988">u</span><span class="op" id="3104989">,</span>&nbsp;<span class="ident" id="3104991">err</span>&nbsp;<span class="op" id="3104995">:=</span>&nbsp;<span class="ident" id="3104998">strconv</span><span class="op" id="3105005">.</span><span class="ident" id="3105006">ParseUint</span><span class="op" id="3105015">(</span><span class="ident" id="3105016">text</span><span class="op" id="3105020">,</span>&nbsp;<span class="num" id="3105022">0</span><span class="op" id="3105023">,</span>&nbsp;<span class="num" id="3105025">64</span><span class="op" id="3105027">)</span>&nbsp;<span class="comment" id="3105029">//&nbsp;will&nbsp;fail&nbsp;for&nbsp;-0;&nbsp;fixed&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105064">if</span>&nbsp;<span class="ident" id="3105067">err</span>&nbsp;<span class="op" id="3105071">==</span>&nbsp;<span class="builtintype" id="3105074">nil</span>&nbsp;<span class="op" id="3105078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105082">n</span><span class="op" id="3105083">.</span><span class="ident" id="3105084">IsUint</span>&nbsp;<span class="op" id="3105091">=</span>&nbsp;<span class="builtintype" id="3105093">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105100">n</span><span class="op" id="3105101">.</span><span class="ident" id="3105102">Uint64</span>&nbsp;<span class="op" id="3105109">=</span>&nbsp;<span class="ident" id="3105111">u</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3105114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105117">i</span><span class="op" id="3105118">,</span>&nbsp;<span class="ident" id="3105120">err</span>&nbsp;<span class="op" id="3105124">:=</span>&nbsp;<span class="ident" id="3105127">strconv</span><span class="op" id="3105134">.</span><span class="ident" id="3105135">ParseInt</span><span class="op" id="3105143">(</span><span class="ident" id="3105144">text</span><span class="op" id="3105148">,</span>&nbsp;<span class="num" id="3105150">0</span><span class="op" id="3105151">,</span>&nbsp;<span class="num" id="3105153">64</span><span class="op" id="3105155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105158">if</span>&nbsp;<span class="ident" id="3105161">err</span>&nbsp;<span class="op" id="3105165">==</span>&nbsp;<span class="builtintype" id="3105168">nil</span>&nbsp;<span class="op" id="3105172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105176">n</span><span class="op" id="3105177">.</span><span class="ident" id="3105178">IsInt</span>&nbsp;<span class="op" id="3105184">=</span>&nbsp;<span class="builtintype" id="3105186">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105193">n</span><span class="op" id="3105194">.</span><span class="ident" id="3105195">Int64</span>&nbsp;<span class="op" id="3105201">=</span>&nbsp;<span class="ident" id="3105203">i</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105207">if</span>&nbsp;<span class="ident" id="3105210">i</span>&nbsp;<span class="op" id="3105212">==</span>&nbsp;<span class="num" id="3105215">0</span>&nbsp;<span class="op" id="3105217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105222">n</span><span class="op" id="3105223">.</span><span class="ident" id="3105224">IsUint</span>&nbsp;<span class="op" id="3105231">=</span>&nbsp;<span class="builtintype" id="3105233">true</span>&nbsp;<span class="comment" id="3105238">//&nbsp;in&nbsp;case&nbsp;of&nbsp;-0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105259">n</span><span class="op" id="3105260">.</span><span class="ident" id="3105261">Uint64</span>&nbsp;<span class="op" id="3105268">=</span>&nbsp;<span class="ident" id="3105270">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3105274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3105277">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3105280">//&nbsp;If&nbsp;an&nbsp;integer&nbsp;extraction&nbsp;succeeded,&nbsp;promote&nbsp;the&nbsp;float.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105339">if</span>&nbsp;<span class="ident" id="3105342">n</span><span class="op" id="3105343">.</span><span class="ident" id="3105344">IsInt</span>&nbsp;<span class="op" id="3105350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105354">n</span><span class="op" id="3105355">.</span><span class="ident" id="3105356">IsFloat</span>&nbsp;<span class="op" id="3105364">=</span>&nbsp;<span class="builtintype" id="3105366">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105373">n</span><span class="op" id="3105374">.</span><span class="ident" id="3105375">Float64</span>&nbsp;<span class="op" id="3105383">=</span>&nbsp;<span class="builtintype" id="3105385">float64</span><span class="op" id="3105392">(</span><span class="ident" id="3105393">n</span><span class="op" id="3105394">.</span><span class="ident" id="3105395">Int64</span><span class="op" id="3105400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3105403">}</span>&nbsp;<span class="keyword" id="3105405">else</span>&nbsp;<span class="keyword" id="3105410">if</span>&nbsp;<span class="ident" id="3105413">n</span><span class="op" id="3105414">.</span><span class="ident" id="3105415">IsUint</span>&nbsp;<span class="op" id="3105422">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105426">n</span><span class="op" id="3105427">.</span><span class="ident" id="3105428">IsFloat</span>&nbsp;<span class="op" id="3105436">=</span>&nbsp;<span class="builtintype" id="3105438">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105445">n</span><span class="op" id="3105446">.</span><span class="ident" id="3105447">Float64</span>&nbsp;<span class="op" id="3105455">=</span>&nbsp;<span class="builtintype" id="3105457">float64</span><span class="op" id="3105464">(</span><span class="ident" id="3105465">n</span><span class="op" id="3105466">.</span><span class="ident" id="3105467">Uint64</span><span class="op" id="3105473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3105476">}</span>&nbsp;<span class="keyword" id="3105478">else</span>&nbsp;<span class="op" id="3105483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105487">f</span><span class="op" id="3105488">,</span>&nbsp;<span class="ident" id="3105490">err</span>&nbsp;<span class="op" id="3105494">:=</span>&nbsp;<span class="ident" id="3105497">strconv</span><span class="op" id="3105504">.</span><span class="ident" id="3105505">ParseFloat</span><span class="op" id="3105515">(</span><span class="ident" id="3105516">text</span><span class="op" id="3105520">,</span>&nbsp;<span class="num" id="3105522">64</span><span class="op" id="3105524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105528">if</span>&nbsp;<span class="ident" id="3105531">err</span>&nbsp;<span class="op" id="3105535">==</span>&nbsp;<span class="builtintype" id="3105538">nil</span>&nbsp;<span class="op" id="3105542">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105547">n</span><span class="op" id="3105548">.</span><span class="ident" id="3105549">IsFloat</span>&nbsp;<span class="op" id="3105557">=</span>&nbsp;<span class="builtintype" id="3105559">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105567">n</span><span class="op" id="3105568">.</span><span class="ident" id="3105569">Float64</span>&nbsp;<span class="op" id="3105577">=</span>&nbsp;<span class="ident" id="3105579">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3105584">//&nbsp;If&nbsp;a&nbsp;floating-point&nbsp;extraction&nbsp;succeeded,&nbsp;extract&nbsp;the&nbsp;int&nbsp;if&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105659">if</span>&nbsp;<span class="op" id="3105662">!</span><span class="ident" id="3105663">n</span><span class="op" id="3105664">.</span><span class="ident" id="3105665">IsInt</span>&nbsp;<span class="op" id="3105671">&amp;&amp;</span>&nbsp;<span class="builtintype" id="3105674">float64</span><span class="op" id="3105681">(</span><span class="builtintype" id="3105682">int64</span><span class="op" id="3105687">(</span><span class="ident" id="3105688">f</span><span class="op" id="3105689">)</span><span class="op" id="3105690">)</span>&nbsp;<span class="op" id="3105692">==</span>&nbsp;<span class="ident" id="3105695">f</span>&nbsp;<span class="op" id="3105697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105703">n</span><span class="op" id="3105704">.</span><span class="ident" id="3105705">IsInt</span>&nbsp;<span class="op" id="3105711">=</span>&nbsp;<span class="builtintype" id="3105713">true</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105722">n</span><span class="op" id="3105723">.</span><span class="ident" id="3105724">Int64</span>&nbsp;<span class="op" id="3105730">=</span>&nbsp;<span class="builtintype" id="3105732">int64</span><span class="op" id="3105737">(</span><span class="ident" id="3105738">f</span><span class="op" id="3105739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3105744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105749">if</span>&nbsp;<span class="op" id="3105752">!</span><span class="ident" id="3105753">n</span><span class="op" id="3105754">.</span><span class="ident" id="3105755">IsUint</span>&nbsp;<span class="op" id="3105762">&amp;&amp;</span>&nbsp;<span class="builtintype" id="3105765">float64</span><span class="op" id="3105772">(</span><span class="builtintype" id="3105773">uint64</span><span class="op" id="3105779">(</span><span class="ident" id="3105780">f</span><span class="op" id="3105781">)</span><span class="op" id="3105782">)</span>&nbsp;<span class="op" id="3105784">==</span>&nbsp;<span class="ident" id="3105787">f</span>&nbsp;<span class="op" id="3105789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105795">n</span><span class="op" id="3105796">.</span><span class="ident" id="3105797">IsUint</span>&nbsp;<span class="op" id="3105804">=</span>&nbsp;<span class="builtintype" id="3105806">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105815">n</span><span class="op" id="3105816">.</span><span class="ident" id="3105817">Uint64</span>&nbsp;<span class="op" id="3105824">=</span>&nbsp;<span class="builtintype" id="3105826">uint64</span><span class="op" id="3105832">(</span><span class="ident" id="3105833">f</span><span class="op" id="3105834">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3105839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3105843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3105846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105849">if</span>&nbsp;<span class="op" id="3105852">!</span><span class="ident" id="3105853">n</span><span class="op" id="3105854">.</span><span class="ident" id="3105855">IsInt</span>&nbsp;<span class="op" id="3105861">&amp;&amp;</span>&nbsp;<span class="op" id="3105864">!</span><span class="ident" id="3105865">n</span><span class="op" id="3105866">.</span><span class="ident" id="3105867">IsUint</span>&nbsp;<span class="op" id="3105874">&amp;&amp;</span>&nbsp;<span class="op" id="3105877">!</span><span class="ident" id="3105878">n</span><span class="op" id="3105879">.</span><span class="ident" id="3105880">IsFloat</span>&nbsp;<span class="op" id="3105888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105892">return</span>&nbsp;<span class="builtintype" id="3105899">nil</span><span class="op" id="3105902">,</span>&nbsp;<span class="ident" id="3105904">fmt</span><span class="op" id="3105907">.</span><span class="ident" id="3105908">Errorf</span><span class="op" id="3105914">(</span><span class="string" id="3105915">&#34;illegal&nbsp;number&nbsp;syntax:&nbsp;%q&#34;</span><span class="op" id="3105942">,</span>&nbsp;<span class="ident" id="3105944">text</span><span class="op" id="3105948">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3105951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105954">return</span>&nbsp;<span class="ident" id="3105961">n</span><span class="op" id="3105962">,</span>&nbsp;<span class="builtintype" id="3105964">nil</span><br>
<span class="lineno"></span><span class="op" id="3105968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3105971">//&nbsp;simplifyComplex&nbsp;pulls&nbsp;out&nbsp;any&nbsp;other&nbsp;types&nbsp;that&nbsp;are&nbsp;represented&nbsp;by&nbsp;the&nbsp;complex&nbsp;number.</span><br>
<span class="lineno">615</span><span class="comment" id="3106060">//&nbsp;These&nbsp;all&nbsp;require&nbsp;that&nbsp;the&nbsp;imaginary&nbsp;part&nbsp;be&nbsp;zero.</span><br>
<span class="lineno"></span><span class="keyword" id="3106114">func</span>&nbsp;<span class="op" id="3106119">(</span><span class="ident" id="3106120">n</span>&nbsp;<span class="op" id="3106122">*</span><span class="ident" id="3106123">NumberNode</span><span class="op" id="3106133">)</span>&nbsp;<span class="ident" id="3106135">simplifyComplex</span><span class="op" id="3106150">(</span><span class="op" id="3106151">)</span>&nbsp;<span class="op" id="3106153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106156">n</span><span class="op" id="3106157">.</span><span class="ident" id="3106158">IsFloat</span>&nbsp;<span class="op" id="3106166">=</span>&nbsp;<span class="builtinfunc" id="3106168">imag</span><span class="op" id="3106172">(</span><span class="ident" id="3106173">n</span><span class="op" id="3106174">.</span><span class="ident" id="3106175">Complex128</span><span class="op" id="3106185">)</span>&nbsp;<span class="op" id="3106187">==</span>&nbsp;<span class="num" id="3106190">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106193">if</span>&nbsp;<span class="ident" id="3106196">n</span><span class="op" id="3106197">.</span><span class="ident" id="3106198">IsFloat</span>&nbsp;<span class="op" id="3106206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106210">n</span><span class="op" id="3106211">.</span><span class="ident" id="3106212">Float64</span>&nbsp;<span class="op" id="3106220">=</span>&nbsp;<span class="builtinfunc" id="3106222">real</span><span class="op" id="3106226">(</span><span class="ident" id="3106227">n</span><span class="op" id="3106228">.</span><span class="ident" id="3106229">Complex128</span><span class="op" id="3106239">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106243">n</span><span class="op" id="3106244">.</span><span class="ident" id="3106245">IsInt</span>&nbsp;<span class="op" id="3106251">=</span>&nbsp;<span class="builtintype" id="3106253">float64</span><span class="op" id="3106260">(</span><span class="builtintype" id="3106261">int64</span><span class="op" id="3106266">(</span><span class="ident" id="3106267">n</span><span class="op" id="3106268">.</span><span class="ident" id="3106269">Float64</span><span class="op" id="3106276">)</span><span class="op" id="3106277">)</span>&nbsp;<span class="op" id="3106279">==</span>&nbsp;<span class="ident" id="3106282">n</span><span class="op" id="3106283">.</span><span class="ident" id="3106284">Float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106294">if</span>&nbsp;<span class="ident" id="3106297">n</span><span class="op" id="3106298">.</span><span class="ident" id="3106299">IsInt</span>&nbsp;<span class="op" id="3106305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106310">n</span><span class="op" id="3106311">.</span><span class="ident" id="3106312">Int64</span>&nbsp;<span class="op" id="3106318">=</span>&nbsp;<span class="builtintype" id="3106320">int64</span><span class="op" id="3106325">(</span><span class="ident" id="3106326">n</span><span class="op" id="3106327">.</span><span class="ident" id="3106328">Float64</span><span class="op" id="3106335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3106339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106343">n</span><span class="op" id="3106344">.</span><span class="ident" id="3106345">IsUint</span>&nbsp;<span class="op" id="3106352">=</span>&nbsp;<span class="builtintype" id="3106354">float64</span><span class="op" id="3106361">(</span><span class="builtintype" id="3106362">uint64</span><span class="op" id="3106368">(</span><span class="ident" id="3106369">n</span><span class="op" id="3106370">.</span><span class="ident" id="3106371">Float64</span><span class="op" id="3106378">)</span><span class="op" id="3106379">)</span>&nbsp;<span class="op" id="3106381">==</span>&nbsp;<span class="ident" id="3106384">n</span><span class="op" id="3106385">.</span><span class="ident" id="3106386">Float64</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106396">if</span>&nbsp;<span class="ident" id="3106399">n</span><span class="op" id="3106400">.</span><span class="ident" id="3106401">IsUint</span>&nbsp;<span class="op" id="3106408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106413">n</span><span class="op" id="3106414">.</span><span class="ident" id="3106415">Uint64</span>&nbsp;<span class="op" id="3106422">=</span>&nbsp;<span class="builtintype" id="3106424">uint64</span><span class="op" id="3106430">(</span><span class="ident" id="3106431">n</span><span class="op" id="3106432">.</span><span class="ident" id="3106433">Float64</span><span class="op" id="3106440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3106444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3106447">}</span><br>
<span class="lineno"></span><span class="op" id="3106449">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span><span class="keyword" id="3106452">func</span>&nbsp;<span class="op" id="3106457">(</span><span class="ident" id="3106458">n</span>&nbsp;<span class="op" id="3106460">*</span><span class="ident" id="3106461">NumberNode</span><span class="op" id="3106471">)</span>&nbsp;<span class="ident" id="3106473">String</span><span class="op" id="3106479">(</span><span class="op" id="3106480">)</span>&nbsp;<span class="builtintype" id="3106482">string</span>&nbsp;<span class="op" id="3106489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106492">return</span>&nbsp;<span class="ident" id="3106499">n</span><span class="op" id="3106500">.</span><span class="ident" id="3106501">Text</span><br>
<span class="lineno"></span><span class="op" id="3106506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">635</span><span class="keyword" id="3106509">func</span>&nbsp;<span class="op" id="3106514">(</span><span class="ident" id="3106515">n</span>&nbsp;<span class="op" id="3106517">*</span><span class="ident" id="3106518">NumberNode</span><span class="op" id="3106528">)</span>&nbsp;<span class="ident" id="3106530">tree</span><span class="op" id="3106534">(</span><span class="op" id="3106535">)</span>&nbsp;<span class="op" id="3106537">*</span><span class="ident" id="3106538">Tree</span>&nbsp;<span class="op" id="3106543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106546">return</span>&nbsp;<span class="ident" id="3106553">n</span><span class="op" id="3106554">.</span><span class="ident" id="3106555">tr</span><br>
<span class="lineno"></span><span class="op" id="3106558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3106561">func</span>&nbsp;<span class="op" id="3106566">(</span><span class="ident" id="3106567">n</span>&nbsp;<span class="op" id="3106569">*</span><span class="ident" id="3106570">NumberNode</span><span class="op" id="3106580">)</span>&nbsp;<span class="ident" id="3106582">Copy</span><span class="op" id="3106586">(</span><span class="op" id="3106587">)</span>&nbsp;<span class="ident" id="3106589">Node</span>&nbsp;<span class="op" id="3106594">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106597">nn</span>&nbsp;<span class="op" id="3106600">:=</span>&nbsp;<span class="builtinfunc" id="3106603">new</span><span class="op" id="3106606">(</span><span class="ident" id="3106607">NumberNode</span><span class="op" id="3106617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3106620">*</span><span class="ident" id="3106621">nn</span>&nbsp;<span class="op" id="3106624">=</span>&nbsp;<span class="op" id="3106626">*</span><span class="ident" id="3106627">n</span>&nbsp;<span class="comment" id="3106629">//&nbsp;Easy,&nbsp;fast,&nbsp;correct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106654">return</span>&nbsp;<span class="ident" id="3106661">nn</span><br>
<span class="lineno"></span><span class="op" id="3106664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span><span class="comment" id="3106667">//&nbsp;StringNode&nbsp;holds&nbsp;a&nbsp;string&nbsp;constant.&nbsp;The&nbsp;value&nbsp;has&nbsp;been&nbsp;&#34;unquoted&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3106737">type</span>&nbsp;<span class="ident" id="3106742">StringNode</span>&nbsp;<span class="keyword" id="3106753">struct</span>&nbsp;<span class="op" id="3106760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106763">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106773">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106778">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3106785">*</span><span class="ident" id="3106786">Tree</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106792">Quoted</span>&nbsp;<span class="builtintype" id="3106799">string</span>&nbsp;<span class="comment" id="3106806">//&nbsp;The&nbsp;original&nbsp;text&nbsp;of&nbsp;the&nbsp;string,&nbsp;with&nbsp;quotes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106856">Text</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3106863">string</span>&nbsp;<span class="comment" id="3106870">//&nbsp;The&nbsp;string,&nbsp;after&nbsp;quote&nbsp;processing.</span><br>
<span class="lineno"></span><span class="op" id="3106909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3106912">func</span>&nbsp;<span class="op" id="3106917">(</span><span class="ident" id="3106918">t</span>&nbsp;<span class="op" id="3106920">*</span><span class="ident" id="3106921">Tree</span><span class="op" id="3106925">)</span>&nbsp;<span class="ident" id="3106927">newString</span><span class="op" id="3106936">(</span><span class="ident" id="3106937">pos</span>&nbsp;<span class="ident" id="3106941">Pos</span><span class="op" id="3106944">,</span>&nbsp;<span class="ident" id="3106946">orig</span><span class="op" id="3106950">,</span>&nbsp;<span class="ident" id="3106952">text</span>&nbsp;<span class="builtintype" id="3106957">string</span><span class="op" id="3106963">)</span>&nbsp;<span class="op" id="3106965">*</span><span class="ident" id="3106966">StringNode</span>&nbsp;<span class="op" id="3106977">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106980">return</span>&nbsp;<span class="op" id="3106987">&amp;</span><span class="ident" id="3106988">StringNode</span><span class="op" id="3106998">{</span><span class="ident" id="3106999">tr</span><span class="op" id="3107001">:</span>&nbsp;<span class="ident" id="3107003">t</span><span class="op" id="3107004">,</span>&nbsp;<span class="ident" id="3107006">NodeType</span><span class="op" id="3107014">:</span>&nbsp;<span class="ident" id="3107016">NodeString</span><span class="op" id="3107026">,</span>&nbsp;<span class="ident" id="3107028">Pos</span><span class="op" id="3107031">:</span>&nbsp;<span class="ident" id="3107033">pos</span><span class="op" id="3107036">,</span>&nbsp;<span class="ident" id="3107038">Quoted</span><span class="op" id="3107044">:</span>&nbsp;<span class="ident" id="3107046">orig</span><span class="op" id="3107050">,</span>&nbsp;<span class="ident" id="3107052">Text</span><span class="op" id="3107056">:</span>&nbsp;<span class="ident" id="3107058">text</span><span class="op" id="3107062">}</span><br>
<span class="lineno"></span><span class="op" id="3107064">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3107067">func</span>&nbsp;<span class="op" id="3107072">(</span><span class="ident" id="3107073">s</span>&nbsp;<span class="op" id="3107075">*</span><span class="ident" id="3107076">StringNode</span><span class="op" id="3107086">)</span>&nbsp;<span class="ident" id="3107088">String</span><span class="op" id="3107094">(</span><span class="op" id="3107095">)</span>&nbsp;<span class="builtintype" id="3107097">string</span>&nbsp;<span class="op" id="3107104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3107107">return</span>&nbsp;<span class="ident" id="3107114">s</span><span class="op" id="3107115">.</span><span class="ident" id="3107116">Quoted</span><br>
<span class="lineno">660</span><span class="op" id="3107123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3107126">func</span>&nbsp;<span class="op" id="3107131">(</span><span class="ident" id="3107132">s</span>&nbsp;<span class="op" id="3107134">*</span><span class="ident" id="3107135">StringNode</span><span class="op" id="3107145">)</span>&nbsp;<span class="ident" id="3107147">tree</span><span class="op" id="3107151">(</span><span class="op" id="3107152">)</span>&nbsp;<span class="op" id="3107154">*</span><span class="ident" id="3107155">Tree</span>&nbsp;<span class="op" id="3107160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3107163">return</span>&nbsp;<span class="ident" id="3107170">s</span><span class="op" id="3107171">.</span><span class="ident" id="3107172">tr</span><br>
<span class="lineno"></span><span class="op" id="3107175">}</span><br>
<span class="lineno">665</span><br>
<span class="lineno"></span><span class="keyword" id="3107178">func</span>&nbsp;<span class="op" id="3107183">(</span><span class="ident" id="3107184">s</span>&nbsp;<span class="op" id="3107186">*</span><span class="ident" id="3107187">StringNode</span><span class="op" id="3107197">)</span>&nbsp;<span class="ident" id="3107199">Copy</span><span class="op" id="3107203">(</span><span class="op" id="3107204">)</span>&nbsp;<span class="ident" id="3107206">Node</span>&nbsp;<span class="op" id="3107211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3107214">return</span>&nbsp;<span class="ident" id="3107221">s</span><span class="op" id="3107222">.</span><span class="ident" id="3107223">tr</span><span class="op" id="3107225">.</span><span class="ident" id="3107226">newString</span><span class="op" id="3107235">(</span><span class="ident" id="3107236">s</span><span class="op" id="3107237">.</span><span class="ident" id="3107238">Pos</span><span class="op" id="3107241">,</span>&nbsp;<span class="ident" id="3107243">s</span><span class="op" id="3107244">.</span><span class="ident" id="3107245">Quoted</span><span class="op" id="3107251">,</span>&nbsp;<span class="ident" id="3107253">s</span><span class="op" id="3107254">.</span><span class="ident" id="3107255">Text</span><span class="op" id="3107259">)</span><br>
<span class="lineno"></span><span class="op" id="3107261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="comment" id="3107264">//&nbsp;endNode&nbsp;represents&nbsp;an&nbsp;{{end}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="comment" id="3107305">//&nbsp;It&nbsp;does&nbsp;not&nbsp;appear&nbsp;in&nbsp;the&nbsp;final&nbsp;parse&nbsp;tree.</span><br>
<span class="lineno"></span><span class="keyword" id="3107352">type</span>&nbsp;<span class="ident" id="3107357">endNode</span>&nbsp;<span class="keyword" id="3107365">struct</span>&nbsp;<span class="op" id="3107372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3107375">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3107385">Pos</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3107390">tr</span>&nbsp;<span class="op" id="3107393">*</span><span class="ident" id="3107394">Tree</span><br>
<span class="lineno"></span><span class="op" id="3107399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3107402">func</span>&nbsp;<span class="op" id="3107407">(</span><span class="ident" id="3107408">t</span>&nbsp;<span class="op" id="3107410">*</span><span class="ident" id="3107411">Tree</span><span class="op" id="3107415">)</span>&nbsp;<span class="ident" id="3107417">newEnd</span><span class="op" id="3107423">(</span><span class="ident" id="3107424">pos</span>&nbsp;<span class="ident" id="3107428">Pos</span><span class="op" id="3107431">)</span>&nbsp;<span class="op" id="3107433">*</span><span class="ident" id="3107434">endNode</span>&nbsp;<span class="op" id="3107442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3107445">return</span>&nbsp;<span class="op" id="3107452">&amp;</span><span class="ident" id="3107453">endNode</span><span class="op" id="3107460">{</span><span class="ident" id="3107461">tr</span><span class="op" id="3107463">:</span>&nbsp;<span class="ident" id="3107465">t</span><span class="op" id="3107466">,</span>&nbsp;<span class="ident" id="3107468">NodeType</span><span class="op" id="3107476">:</span>&nbsp;<span class="ident" id="3107478">nodeEnd</span><span class="op" id="3107485">,</span>&nbsp;<span class="ident" id="3107487">Pos</span><span class="op" id="3107490">:</span>&nbsp;<span class="ident" id="3107492">pos</span><span class="op" id="3107495">}</span><br>
<span class="lineno">680</span><span class="op" id="3107497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3107500">func</span>&nbsp;<span class="op" id="3107505">(</span><span class="ident" id="3107506">e</span>&nbsp;<span class="op" id="3107508">*</span><span class="ident" id="3107509">endNode</span><span class="op" id="3107516">)</span>&nbsp;<span class="ident" id="3107518">String</span><span class="op" id="3107524">(</span><span class="op" id="3107525">)</span>&nbsp;<span class="builtintype" id="3107527">string</span>&nbsp;<span class="op" id="3107534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3107537">return</span>&nbsp;<span class="string" id="3107544">&#34;{{end}}&#34;</span><br>
<span class="lineno"></span><span class="op" id="3107554">}</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span><span class="keyword" id="3107557">func</span>&nbsp;<span class="op" id="3107562">(</span><span class="ident" id="3107563">e</span>&nbsp;<span class="op" id="3107565">*</span><span class="ident" id="3107566">endNode</span><span class="op" id="3107573">)</span>&nbsp;<span class="ident" id="3107575">tree</span><span class="op" id="3107579">(</span><span class="op" id="3107580">)</span>&nbsp;<span class="op" id="3107582">*</span><span class="ident" id="3107583">Tree</span>&nbsp;<span class="op" id="3107588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3107591">return</span>&nbsp;<span class="ident" id="3107598">e</span><span class="op" id="3107599">.</span><span class="ident" id="3107600">tr</span><br>
<span class="lineno"></span><span class="op" id="3107603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="3107606">func</span>&nbsp;<span class="op" id="3107611">(</span><span class="ident" id="3107612">e</span>&nbsp;<span class="op" id="3107614">*</span><span class="ident" id="3107615">endNode</span><span class="op" id="3107622">)</span>&nbsp;<span class="ident" id="3107624">Copy</span><span class="op" id="3107628">(</span><span class="op" id="3107629">)</span>&nbsp;<span class="ident" id="3107631">Node</span>&nbsp;<span class="op" id="3107636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3107639">return</span>&nbsp;<span class="ident" id="3107646">e</span><span class="op" id="3107647">.</span><span class="ident" id="3107648">tr</span><span class="op" id="3107650">.</span><span class="ident" id="3107651">newEnd</span><span class="op" id="3107657">(</span><span class="ident" id="3107658">e</span><span class="op" id="3107659">.</span><span class="ident" id="3107660">Pos</span><span class="op" id="3107663">)</span><br>
<span class="lineno"></span><span class="op" id="3107665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3107668">//&nbsp;elseNode&nbsp;represents&nbsp;an&nbsp;{{else}}&nbsp;action.&nbsp;Does&nbsp;not&nbsp;appear&nbsp;in&nbsp;the&nbsp;final&nbsp;tree.</span><br>
<span class="lineno">695</span><span class="keyword" id="3107746">type</span>&nbsp;<span class="ident" id="3107751">elseNode</span>&nbsp;<span class="keyword" id="3107760">struct</span>&nbsp;<span class="op" id="3107767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3107770">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3107780">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3107785">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3107790">*</span><span class="ident" id="3107791">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3107797">Line</span>&nbsp;<span class="builtintype" id="3107802">int</span>&nbsp;<span class="comment" id="3107806">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno">700</span><span class="op" id="3107875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3107878">func</span>&nbsp;<span class="op" id="3107883">(</span><span class="ident" id="3107884">t</span>&nbsp;<span class="op" id="3107886">*</span><span class="ident" id="3107887">Tree</span><span class="op" id="3107891">)</span>&nbsp;<span class="ident" id="3107893">newElse</span><span class="op" id="3107900">(</span><span class="ident" id="3107901">pos</span>&nbsp;<span class="ident" id="3107905">Pos</span><span class="op" id="3107908">,</span>&nbsp;<span class="ident" id="3107910">line</span>&nbsp;<span class="builtintype" id="3107915">int</span><span class="op" id="3107918">)</span>&nbsp;<span class="op" id="3107920">*</span><span class="ident" id="3107921">elseNode</span>&nbsp;<span class="op" id="3107930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3107933">return</span>&nbsp;<span class="op" id="3107940">&amp;</span><span class="ident" id="3107941">elseNode</span><span class="op" id="3107949">{</span><span class="ident" id="3107950">tr</span><span class="op" id="3107952">:</span>&nbsp;<span class="ident" id="3107954">t</span><span class="op" id="3107955">,</span>&nbsp;<span class="ident" id="3107957">NodeType</span><span class="op" id="3107965">:</span>&nbsp;<span class="ident" id="3107967">nodeElse</span><span class="op" id="3107975">,</span>&nbsp;<span class="ident" id="3107977">Pos</span><span class="op" id="3107980">:</span>&nbsp;<span class="ident" id="3107982">pos</span><span class="op" id="3107985">,</span>&nbsp;<span class="ident" id="3107987">Line</span><span class="op" id="3107991">:</span>&nbsp;<span class="ident" id="3107993">line</span><span class="op" id="3107997">}</span><br>
<span class="lineno"></span><span class="op" id="3107999">}</span><br>
<span class="lineno">705</span><br>
<span class="lineno"></span><span class="keyword" id="3108002">func</span>&nbsp;<span class="op" id="3108007">(</span><span class="ident" id="3108008">e</span>&nbsp;<span class="op" id="3108010">*</span><span class="ident" id="3108011">elseNode</span><span class="op" id="3108019">)</span>&nbsp;<span class="ident" id="3108021">Type</span><span class="op" id="3108025">(</span><span class="op" id="3108026">)</span>&nbsp;<span class="ident" id="3108028">NodeType</span>&nbsp;<span class="op" id="3108037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3108040">return</span>&nbsp;<span class="ident" id="3108047">nodeElse</span><br>
<span class="lineno"></span><span class="op" id="3108056">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">710</span><span class="keyword" id="3108059">func</span>&nbsp;<span class="op" id="3108064">(</span><span class="ident" id="3108065">e</span>&nbsp;<span class="op" id="3108067">*</span><span class="ident" id="3108068">elseNode</span><span class="op" id="3108076">)</span>&nbsp;<span class="ident" id="3108078">String</span><span class="op" id="3108084">(</span><span class="op" id="3108085">)</span>&nbsp;<span class="builtintype" id="3108087">string</span>&nbsp;<span class="op" id="3108094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3108097">return</span>&nbsp;<span class="string" id="3108104">&#34;{{else}}&#34;</span><br>
<span class="lineno"></span><span class="op" id="3108115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3108118">func</span>&nbsp;<span class="op" id="3108123">(</span><span class="ident" id="3108124">e</span>&nbsp;<span class="op" id="3108126">*</span><span class="ident" id="3108127">elseNode</span><span class="op" id="3108135">)</span>&nbsp;<span class="ident" id="3108137">tree</span><span class="op" id="3108141">(</span><span class="op" id="3108142">)</span>&nbsp;<span class="op" id="3108144">*</span><span class="ident" id="3108145">Tree</span>&nbsp;<span class="op" id="3108150">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3108153">return</span>&nbsp;<span class="ident" id="3108160">e</span><span class="op" id="3108161">.</span><span class="ident" id="3108162">tr</span><br>
<span class="lineno"></span><span class="op" id="3108165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3108168">func</span>&nbsp;<span class="op" id="3108173">(</span><span class="ident" id="3108174">e</span>&nbsp;<span class="op" id="3108176">*</span><span class="ident" id="3108177">elseNode</span><span class="op" id="3108185">)</span>&nbsp;<span class="ident" id="3108187">Copy</span><span class="op" id="3108191">(</span><span class="op" id="3108192">)</span>&nbsp;<span class="ident" id="3108194">Node</span>&nbsp;<span class="op" id="3108199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3108202">return</span>&nbsp;<span class="ident" id="3108209">e</span><span class="op" id="3108210">.</span><span class="ident" id="3108211">tr</span><span class="op" id="3108213">.</span><span class="ident" id="3108214">newElse</span><span class="op" id="3108221">(</span><span class="ident" id="3108222">e</span><span class="op" id="3108223">.</span><span class="ident" id="3108224">Pos</span><span class="op" id="3108227">,</span>&nbsp;<span class="ident" id="3108229">e</span><span class="op" id="3108230">.</span><span class="ident" id="3108231">Line</span><span class="op" id="3108235">)</span><br>
<span class="lineno">720</span><span class="op" id="3108237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3108240">//&nbsp;BranchNode&nbsp;is&nbsp;the&nbsp;common&nbsp;representation&nbsp;of&nbsp;if,&nbsp;range,&nbsp;and&nbsp;with.</span><br>
<span class="lineno"></span><span class="keyword" id="3108307">type</span>&nbsp;<span class="ident" id="3108312">BranchNode</span>&nbsp;<span class="keyword" id="3108323">struct</span>&nbsp;<span class="op" id="3108330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3108333">NodeType</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3108343">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3108348">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3108357">*</span><span class="ident" id="3108358">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3108364">Line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3108373">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3108383">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3108453">Pipe</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3108462">*</span><span class="ident" id="3108463">PipeNode</span>&nbsp;<span class="comment" id="3108472">//&nbsp;The&nbsp;pipeline&nbsp;to&nbsp;be&nbsp;evaluated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3108506">List</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3108515">*</span><span class="ident" id="3108516">ListNode</span>&nbsp;<span class="comment" id="3108525">//&nbsp;What&nbsp;to&nbsp;execute&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;non-empty.</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3108572">ElseList</span>&nbsp;<span class="op" id="3108581">*</span><span class="ident" id="3108582">ListNode</span>&nbsp;<span class="comment" id="3108591">//&nbsp;What&nbsp;to&nbsp;execute&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;empty&nbsp;(nil&nbsp;if&nbsp;absent).</span><br>
<span class="lineno"></span><span class="op" id="3108649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3108652">func</span>&nbsp;<span class="op" id="3108657">(</span><span class="ident" id="3108658">b</span>&nbsp;<span class="op" id="3108660">*</span><span class="ident" id="3108661">BranchNode</span><span class="op" id="3108671">)</span>&nbsp;<span class="ident" id="3108673">String</span><span class="op" id="3108679">(</span><span class="op" id="3108680">)</span>&nbsp;<span class="builtintype" id="3108682">string</span>&nbsp;<span class="op" id="3108689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3108692">name</span>&nbsp;<span class="op" id="3108697">:=</span>&nbsp;<span class="string" id="3108700">&#34;&#34;</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3108704">switch</span>&nbsp;<span class="ident" id="3108711">b</span><span class="op" id="3108712">.</span><span class="ident" id="3108713">NodeType</span>&nbsp;<span class="op" id="3108722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3108725">case</span>&nbsp;<span class="ident" id="3108730">NodeIf</span><span class="op" id="3108736">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3108740">name</span>&nbsp;<span class="op" id="3108745">=</span>&nbsp;<span class="string" id="3108747">&#34;if&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3108753">case</span>&nbsp;<span class="ident" id="3108758">NodeRange</span><span class="op" id="3108767">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3108771">name</span>&nbsp;<span class="op" id="3108776">=</span>&nbsp;<span class="string" id="3108778">&#34;range&#34;</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3108787">case</span>&nbsp;<span class="ident" id="3108792">NodeWith</span><span class="op" id="3108800">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3108804">name</span>&nbsp;<span class="op" id="3108809">=</span>&nbsp;<span class="string" id="3108811">&#34;with&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3108819">default</span><span class="op" id="3108826">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3108830">panic</span><span class="op" id="3108835">(</span><span class="string" id="3108836">&#34;unknown&nbsp;branch&nbsp;type&#34;</span><span class="op" id="3108857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3108860">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3108863">if</span>&nbsp;<span class="ident" id="3108866">b</span><span class="op" id="3108867">.</span><span class="ident" id="3108868">ElseList</span>&nbsp;<span class="op" id="3108877">!=</span>&nbsp;<span class="builtintype" id="3108880">nil</span>&nbsp;<span class="op" id="3108884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3108888">return</span>&nbsp;<span class="ident" id="3108895">fmt</span><span class="op" id="3108898">.</span><span class="ident" id="3108899">Sprintf</span><span class="op" id="3108906">(</span><span class="string" id="3108907">&#34;{{%s&nbsp;%s}}%s{{else}}%s{{end}}&#34;</span><span class="op" id="3108937">,</span>&nbsp;<span class="ident" id="3108939">name</span><span class="op" id="3108943">,</span>&nbsp;<span class="ident" id="3108945">b</span><span class="op" id="3108946">.</span><span class="ident" id="3108947">Pipe</span><span class="op" id="3108951">,</span>&nbsp;<span class="ident" id="3108953">b</span><span class="op" id="3108954">.</span><span class="ident" id="3108955">List</span><span class="op" id="3108959">,</span>&nbsp;<span class="ident" id="3108961">b</span><span class="op" id="3108962">.</span><span class="ident" id="3108963">ElseList</span><span class="op" id="3108971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3108974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3108977">return</span>&nbsp;<span class="ident" id="3108984">fmt</span><span class="op" id="3108987">.</span><span class="ident" id="3108988">Sprintf</span><span class="op" id="3108995">(</span><span class="string" id="3108996">&#34;{{%s&nbsp;%s}}%s{{end}}&#34;</span><span class="op" id="3109016">,</span>&nbsp;<span class="ident" id="3109018">name</span><span class="op" id="3109022">,</span>&nbsp;<span class="ident" id="3109024">b</span><span class="op" id="3109025">.</span><span class="ident" id="3109026">Pipe</span><span class="op" id="3109030">,</span>&nbsp;<span class="ident" id="3109032">b</span><span class="op" id="3109033">.</span><span class="ident" id="3109034">List</span><span class="op" id="3109038">)</span><br>
<span class="lineno"></span><span class="op" id="3109040">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span><span class="keyword" id="3109043">func</span>&nbsp;<span class="op" id="3109048">(</span><span class="ident" id="3109049">b</span>&nbsp;<span class="op" id="3109051">*</span><span class="ident" id="3109052">BranchNode</span><span class="op" id="3109062">)</span>&nbsp;<span class="ident" id="3109064">tree</span><span class="op" id="3109068">(</span><span class="op" id="3109069">)</span>&nbsp;<span class="op" id="3109071">*</span><span class="ident" id="3109072">Tree</span>&nbsp;<span class="op" id="3109077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3109080">return</span>&nbsp;<span class="ident" id="3109087">b</span><span class="op" id="3109088">.</span><span class="ident" id="3109089">tr</span><br>
<span class="lineno"></span><span class="op" id="3109092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span><span class="keyword" id="3109095">func</span>&nbsp;<span class="op" id="3109100">(</span><span class="ident" id="3109101">b</span>&nbsp;<span class="op" id="3109103">*</span><span class="ident" id="3109104">BranchNode</span><span class="op" id="3109114">)</span>&nbsp;<span class="ident" id="3109116">Copy</span><span class="op" id="3109120">(</span><span class="op" id="3109121">)</span>&nbsp;<span class="ident" id="3109123">Node</span>&nbsp;<span class="op" id="3109128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3109131">switch</span>&nbsp;<span class="ident" id="3109138">b</span><span class="op" id="3109139">.</span><span class="ident" id="3109140">NodeType</span>&nbsp;<span class="op" id="3109149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3109152">case</span>&nbsp;<span class="ident" id="3109157">NodeIf</span><span class="op" id="3109163">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3109167">return</span>&nbsp;<span class="ident" id="3109174">b</span><span class="op" id="3109175">.</span><span class="ident" id="3109176">tr</span><span class="op" id="3109178">.</span><span class="ident" id="3109179">newIf</span><span class="op" id="3109184">(</span><span class="ident" id="3109185">b</span><span class="op" id="3109186">.</span><span class="ident" id="3109187">Pos</span><span class="op" id="3109190">,</span>&nbsp;<span class="ident" id="3109192">b</span><span class="op" id="3109193">.</span><span class="ident" id="3109194">Line</span><span class="op" id="3109198">,</span>&nbsp;<span class="ident" id="3109200">b</span><span class="op" id="3109201">.</span><span class="ident" id="3109202">Pipe</span><span class="op" id="3109206">,</span>&nbsp;<span class="ident" id="3109208">b</span><span class="op" id="3109209">.</span><span class="ident" id="3109210">List</span><span class="op" id="3109214">,</span>&nbsp;<span class="ident" id="3109216">b</span><span class="op" id="3109217">.</span><span class="ident" id="3109218">ElseList</span><span class="op" id="3109226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3109229">case</span>&nbsp;<span class="ident" id="3109234">NodeRange</span><span class="op" id="3109243">:</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3109247">return</span>&nbsp;<span class="ident" id="3109254">b</span><span class="op" id="3109255">.</span><span class="ident" id="3109256">tr</span><span class="op" id="3109258">.</span><span class="ident" id="3109259">newRange</span><span class="op" id="3109267">(</span><span class="ident" id="3109268">b</span><span class="op" id="3109269">.</span><span class="ident" id="3109270">Pos</span><span class="op" id="3109273">,</span>&nbsp;<span class="ident" id="3109275">b</span><span class="op" id="3109276">.</span><span class="ident" id="3109277">Line</span><span class="op" id="3109281">,</span>&nbsp;<span class="ident" id="3109283">b</span><span class="op" id="3109284">.</span><span class="ident" id="3109285">Pipe</span><span class="op" id="3109289">,</span>&nbsp;<span class="ident" id="3109291">b</span><span class="op" id="3109292">.</span><span class="ident" id="3109293">List</span><span class="op" id="3109297">,</span>&nbsp;<span class="ident" id="3109299">b</span><span class="op" id="3109300">.</span><span class="ident" id="3109301">ElseList</span><span class="op" id="3109309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3109312">case</span>&nbsp;<span class="ident" id="3109317">NodeWith</span><span class="op" id="3109325">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3109329">return</span>&nbsp;<span class="ident" id="3109336">b</span><span class="op" id="3109337">.</span><span class="ident" id="3109338">tr</span><span class="op" id="3109340">.</span><span class="ident" id="3109341">newWith</span><span class="op" id="3109348">(</span><span class="ident" id="3109349">b</span><span class="op" id="3109350">.</span><span class="ident" id="3109351">Pos</span><span class="op" id="3109354">,</span>&nbsp;<span class="ident" id="3109356">b</span><span class="op" id="3109357">.</span><span class="ident" id="3109358">Line</span><span class="op" id="3109362">,</span>&nbsp;<span class="ident" id="3109364">b</span><span class="op" id="3109365">.</span><span class="ident" id="3109366">Pipe</span><span class="op" id="3109370">,</span>&nbsp;<span class="ident" id="3109372">b</span><span class="op" id="3109373">.</span><span class="ident" id="3109374">List</span><span class="op" id="3109378">,</span>&nbsp;<span class="ident" id="3109380">b</span><span class="op" id="3109381">.</span><span class="ident" id="3109382">ElseList</span><span class="op" id="3109390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3109393">default</span><span class="op" id="3109400">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3109404">panic</span><span class="op" id="3109409">(</span><span class="string" id="3109410">&#34;unknown&nbsp;branch&nbsp;type&#34;</span><span class="op" id="3109431">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3109434">}</span><br>
<span class="lineno"></span><span class="op" id="3109436">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3109439">//&nbsp;IfNode&nbsp;represents&nbsp;an&nbsp;{{if}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="3109495">type</span>&nbsp;<span class="ident" id="3109500">IfNode</span>&nbsp;<span class="keyword" id="3109507">struct</span>&nbsp;<span class="op" id="3109514">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3109517">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="3109528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3109531">func</span>&nbsp;<span class="op" id="3109536">(</span><span class="ident" id="3109537">t</span>&nbsp;<span class="op" id="3109539">*</span><span class="ident" id="3109540">Tree</span><span class="op" id="3109544">)</span>&nbsp;<span class="ident" id="3109546">newIf</span><span class="op" id="3109551">(</span><span class="ident" id="3109552">pos</span>&nbsp;<span class="ident" id="3109556">Pos</span><span class="op" id="3109559">,</span>&nbsp;<span class="ident" id="3109561">line</span>&nbsp;<span class="builtintype" id="3109566">int</span><span class="op" id="3109569">,</span>&nbsp;<span class="ident" id="3109571">pipe</span>&nbsp;<span class="op" id="3109576">*</span><span class="ident" id="3109577">PipeNode</span><span class="op" id="3109585">,</span>&nbsp;<span class="ident" id="3109587">list</span><span class="op" id="3109591">,</span>&nbsp;<span class="ident" id="3109593">elseList</span>&nbsp;<span class="op" id="3109602">*</span><span class="ident" id="3109603">ListNode</span><span class="op" id="3109611">)</span>&nbsp;<span class="op" id="3109613">*</span><span class="ident" id="3109614">IfNode</span>&nbsp;<span class="op" id="3109621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3109624">return</span>&nbsp;<span class="op" id="3109631">&amp;</span><span class="ident" id="3109632">IfNode</span><span class="op" id="3109638">{</span><span class="ident" id="3109639">BranchNode</span><span class="op" id="3109649">{</span><span class="ident" id="3109650">tr</span><span class="op" id="3109652">:</span>&nbsp;<span class="ident" id="3109654">t</span><span class="op" id="3109655">,</span>&nbsp;<span class="ident" id="3109657">NodeType</span><span class="op" id="3109665">:</span>&nbsp;<span class="ident" id="3109667">NodeIf</span><span class="op" id="3109673">,</span>&nbsp;<span class="ident" id="3109675">Pos</span><span class="op" id="3109678">:</span>&nbsp;<span class="ident" id="3109680">pos</span><span class="op" id="3109683">,</span>&nbsp;<span class="ident" id="3109685">Line</span><span class="op" id="3109689">:</span>&nbsp;<span class="ident" id="3109691">line</span><span class="op" id="3109695">,</span>&nbsp;<span class="ident" id="3109697">Pipe</span><span class="op" id="3109701">:</span>&nbsp;<span class="ident" id="3109703">pipe</span><span class="op" id="3109707">,</span>&nbsp;<span class="ident" id="3109709">List</span><span class="op" id="3109713">:</span>&nbsp;<span class="ident" id="3109715">list</span><span class="op" id="3109719">,</span>&nbsp;<span class="ident" id="3109721">ElseList</span><span class="op" id="3109729">:</span>&nbsp;<span class="ident" id="3109731">elseList</span><span class="op" id="3109739">}</span><span class="op" id="3109740">}</span><br>
<span class="lineno">775</span><span class="op" id="3109742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3109745">func</span>&nbsp;<span class="op" id="3109750">(</span><span class="ident" id="3109751">i</span>&nbsp;<span class="op" id="3109753">*</span><span class="ident" id="3109754">IfNode</span><span class="op" id="3109760">)</span>&nbsp;<span class="ident" id="3109762">Copy</span><span class="op" id="3109766">(</span><span class="op" id="3109767">)</span>&nbsp;<span class="ident" id="3109769">Node</span>&nbsp;<span class="op" id="3109774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3109777">return</span>&nbsp;<span class="ident" id="3109784">i</span><span class="op" id="3109785">.</span><span class="ident" id="3109786">tr</span><span class="op" id="3109788">.</span><span class="ident" id="3109789">newIf</span><span class="op" id="3109794">(</span><span class="ident" id="3109795">i</span><span class="op" id="3109796">.</span><span class="ident" id="3109797">Pos</span><span class="op" id="3109800">,</span>&nbsp;<span class="ident" id="3109802">i</span><span class="op" id="3109803">.</span><span class="ident" id="3109804">Line</span><span class="op" id="3109808">,</span>&nbsp;<span class="ident" id="3109810">i</span><span class="op" id="3109811">.</span><span class="ident" id="3109812">Pipe</span><span class="op" id="3109816">.</span><span class="ident" id="3109817">CopyPipe</span><span class="op" id="3109825">(</span><span class="op" id="3109826">)</span><span class="op" id="3109827">,</span>&nbsp;<span class="ident" id="3109829">i</span><span class="op" id="3109830">.</span><span class="ident" id="3109831">List</span><span class="op" id="3109835">.</span><span class="ident" id="3109836">CopyList</span><span class="op" id="3109844">(</span><span class="op" id="3109845">)</span><span class="op" id="3109846">,</span>&nbsp;<span class="ident" id="3109848">i</span><span class="op" id="3109849">.</span><span class="ident" id="3109850">ElseList</span><span class="op" id="3109858">.</span><span class="ident" id="3109859">CopyList</span><span class="op" id="3109867">(</span><span class="op" id="3109868">)</span><span class="op" id="3109869">)</span><br>
<span class="lineno"></span><span class="op" id="3109871">}</span><br>
<span class="lineno">780</span><br>
<span class="lineno"></span><span class="comment" id="3109874">//&nbsp;RangeNode&nbsp;represents&nbsp;a&nbsp;{{range}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="3109935">type</span>&nbsp;<span class="ident" id="3109940">RangeNode</span>&nbsp;<span class="keyword" id="3109950">struct</span>&nbsp;<span class="op" id="3109957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3109960">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="3109971">}</span><br>
<span class="lineno">785</span><br>
<span class="lineno"></span><span class="keyword" id="3109974">func</span>&nbsp;<span class="op" id="3109979">(</span><span class="ident" id="3109980">t</span>&nbsp;<span class="op" id="3109982">*</span><span class="ident" id="3109983">Tree</span><span class="op" id="3109987">)</span>&nbsp;<span class="ident" id="3109989">newRange</span><span class="op" id="3109997">(</span><span class="ident" id="3109998">pos</span>&nbsp;<span class="ident" id="3110002">Pos</span><span class="op" id="3110005">,</span>&nbsp;<span class="ident" id="3110007">line</span>&nbsp;<span class="builtintype" id="3110012">int</span><span class="op" id="3110015">,</span>&nbsp;<span class="ident" id="3110017">pipe</span>&nbsp;<span class="op" id="3110022">*</span><span class="ident" id="3110023">PipeNode</span><span class="op" id="3110031">,</span>&nbsp;<span class="ident" id="3110033">list</span><span class="op" id="3110037">,</span>&nbsp;<span class="ident" id="3110039">elseList</span>&nbsp;<span class="op" id="3110048">*</span><span class="ident" id="3110049">ListNode</span><span class="op" id="3110057">)</span>&nbsp;<span class="op" id="3110059">*</span><span class="ident" id="3110060">RangeNode</span>&nbsp;<span class="op" id="3110070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3110073">return</span>&nbsp;<span class="op" id="3110080">&amp;</span><span class="ident" id="3110081">RangeNode</span><span class="op" id="3110090">{</span><span class="ident" id="3110091">BranchNode</span><span class="op" id="3110101">{</span><span class="ident" id="3110102">tr</span><span class="op" id="3110104">:</span>&nbsp;<span class="ident" id="3110106">t</span><span class="op" id="3110107">,</span>&nbsp;<span class="ident" id="3110109">NodeType</span><span class="op" id="3110117">:</span>&nbsp;<span class="ident" id="3110119">NodeRange</span><span class="op" id="3110128">,</span>&nbsp;<span class="ident" id="3110130">Pos</span><span class="op" id="3110133">:</span>&nbsp;<span class="ident" id="3110135">pos</span><span class="op" id="3110138">,</span>&nbsp;<span class="ident" id="3110140">Line</span><span class="op" id="3110144">:</span>&nbsp;<span class="ident" id="3110146">line</span><span class="op" id="3110150">,</span>&nbsp;<span class="ident" id="3110152">Pipe</span><span class="op" id="3110156">:</span>&nbsp;<span class="ident" id="3110158">pipe</span><span class="op" id="3110162">,</span>&nbsp;<span class="ident" id="3110164">List</span><span class="op" id="3110168">:</span>&nbsp;<span class="ident" id="3110170">list</span><span class="op" id="3110174">,</span>&nbsp;<span class="ident" id="3110176">ElseList</span><span class="op" id="3110184">:</span>&nbsp;<span class="ident" id="3110186">elseList</span><span class="op" id="3110194">}</span><span class="op" id="3110195">}</span><br>
<span class="lineno"></span><span class="op" id="3110197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">790</span><span class="keyword" id="3110200">func</span>&nbsp;<span class="op" id="3110205">(</span><span class="ident" id="3110206">r</span>&nbsp;<span class="op" id="3110208">*</span><span class="ident" id="3110209">RangeNode</span><span class="op" id="3110218">)</span>&nbsp;<span class="ident" id="3110220">Copy</span><span class="op" id="3110224">(</span><span class="op" id="3110225">)</span>&nbsp;<span class="ident" id="3110227">Node</span>&nbsp;<span class="op" id="3110232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3110235">return</span>&nbsp;<span class="ident" id="3110242">r</span><span class="op" id="3110243">.</span><span class="ident" id="3110244">tr</span><span class="op" id="3110246">.</span><span class="ident" id="3110247">newRange</span><span class="op" id="3110255">(</span><span class="ident" id="3110256">r</span><span class="op" id="3110257">.</span><span class="ident" id="3110258">Pos</span><span class="op" id="3110261">,</span>&nbsp;<span class="ident" id="3110263">r</span><span class="op" id="3110264">.</span><span class="ident" id="3110265">Line</span><span class="op" id="3110269">,</span>&nbsp;<span class="ident" id="3110271">r</span><span class="op" id="3110272">.</span><span class="ident" id="3110273">Pipe</span><span class="op" id="3110277">.</span><span class="ident" id="3110278">CopyPipe</span><span class="op" id="3110286">(</span><span class="op" id="3110287">)</span><span class="op" id="3110288">,</span>&nbsp;<span class="ident" id="3110290">r</span><span class="op" id="3110291">.</span><span class="ident" id="3110292">List</span><span class="op" id="3110296">.</span><span class="ident" id="3110297">CopyList</span><span class="op" id="3110305">(</span><span class="op" id="3110306">)</span><span class="op" id="3110307">,</span>&nbsp;<span class="ident" id="3110309">r</span><span class="op" id="3110310">.</span><span class="ident" id="3110311">ElseList</span><span class="op" id="3110319">.</span><span class="ident" id="3110320">CopyList</span><span class="op" id="3110328">(</span><span class="op" id="3110329">)</span><span class="op" id="3110330">)</span><br>
<span class="lineno"></span><span class="op" id="3110332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3110335">//&nbsp;WithNode&nbsp;represents&nbsp;a&nbsp;{{with}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno">795</span><span class="keyword" id="3110394">type</span>&nbsp;<span class="ident" id="3110399">WithNode</span>&nbsp;<span class="keyword" id="3110408">struct</span>&nbsp;<span class="op" id="3110415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3110418">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="3110429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3110432">func</span>&nbsp;<span class="op" id="3110437">(</span><span class="ident" id="3110438">t</span>&nbsp;<span class="op" id="3110440">*</span><span class="ident" id="3110441">Tree</span><span class="op" id="3110445">)</span>&nbsp;<span class="ident" id="3110447">newWith</span><span class="op" id="3110454">(</span><span class="ident" id="3110455">pos</span>&nbsp;<span class="ident" id="3110459">Pos</span><span class="op" id="3110462">,</span>&nbsp;<span class="ident" id="3110464">line</span>&nbsp;<span class="builtintype" id="3110469">int</span><span class="op" id="3110472">,</span>&nbsp;<span class="ident" id="3110474">pipe</span>&nbsp;<span class="op" id="3110479">*</span><span class="ident" id="3110480">PipeNode</span><span class="op" id="3110488">,</span>&nbsp;<span class="ident" id="3110490">list</span><span class="op" id="3110494">,</span>&nbsp;<span class="ident" id="3110496">elseList</span>&nbsp;<span class="op" id="3110505">*</span><span class="ident" id="3110506">ListNode</span><span class="op" id="3110514">)</span>&nbsp;<span class="op" id="3110516">*</span><span class="ident" id="3110517">WithNode</span>&nbsp;<span class="op" id="3110526">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3110529">return</span>&nbsp;<span class="op" id="3110536">&amp;</span><span class="ident" id="3110537">WithNode</span><span class="op" id="3110545">{</span><span class="ident" id="3110546">BranchNode</span><span class="op" id="3110556">{</span><span class="ident" id="3110557">tr</span><span class="op" id="3110559">:</span>&nbsp;<span class="ident" id="3110561">t</span><span class="op" id="3110562">,</span>&nbsp;<span class="ident" id="3110564">NodeType</span><span class="op" id="3110572">:</span>&nbsp;<span class="ident" id="3110574">NodeWith</span><span class="op" id="3110582">,</span>&nbsp;<span class="ident" id="3110584">Pos</span><span class="op" id="3110587">:</span>&nbsp;<span class="ident" id="3110589">pos</span><span class="op" id="3110592">,</span>&nbsp;<span class="ident" id="3110594">Line</span><span class="op" id="3110598">:</span>&nbsp;<span class="ident" id="3110600">line</span><span class="op" id="3110604">,</span>&nbsp;<span class="ident" id="3110606">Pipe</span><span class="op" id="3110610">:</span>&nbsp;<span class="ident" id="3110612">pipe</span><span class="op" id="3110616">,</span>&nbsp;<span class="ident" id="3110618">List</span><span class="op" id="3110622">:</span>&nbsp;<span class="ident" id="3110624">list</span><span class="op" id="3110628">,</span>&nbsp;<span class="ident" id="3110630">ElseList</span><span class="op" id="3110638">:</span>&nbsp;<span class="ident" id="3110640">elseList</span><span class="op" id="3110648">}</span><span class="op" id="3110649">}</span><br>
<span class="lineno"></span><span class="op" id="3110651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3110654">func</span>&nbsp;<span class="op" id="3110659">(</span><span class="ident" id="3110660">w</span>&nbsp;<span class="op" id="3110662">*</span><span class="ident" id="3110663">WithNode</span><span class="op" id="3110671">)</span>&nbsp;<span class="ident" id="3110673">Copy</span><span class="op" id="3110677">(</span><span class="op" id="3110678">)</span>&nbsp;<span class="ident" id="3110680">Node</span>&nbsp;<span class="op" id="3110685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3110688">return</span>&nbsp;<span class="ident" id="3110695">w</span><span class="op" id="3110696">.</span><span class="ident" id="3110697">tr</span><span class="op" id="3110699">.</span><span class="ident" id="3110700">newWith</span><span class="op" id="3110707">(</span><span class="ident" id="3110708">w</span><span class="op" id="3110709">.</span><span class="ident" id="3110710">Pos</span><span class="op" id="3110713">,</span>&nbsp;<span class="ident" id="3110715">w</span><span class="op" id="3110716">.</span><span class="ident" id="3110717">Line</span><span class="op" id="3110721">,</span>&nbsp;<span class="ident" id="3110723">w</span><span class="op" id="3110724">.</span><span class="ident" id="3110725">Pipe</span><span class="op" id="3110729">.</span><span class="ident" id="3110730">CopyPipe</span><span class="op" id="3110738">(</span><span class="op" id="3110739">)</span><span class="op" id="3110740">,</span>&nbsp;<span class="ident" id="3110742">w</span><span class="op" id="3110743">.</span><span class="ident" id="3110744">List</span><span class="op" id="3110748">.</span><span class="ident" id="3110749">CopyList</span><span class="op" id="3110757">(</span><span class="op" id="3110758">)</span><span class="op" id="3110759">,</span>&nbsp;<span class="ident" id="3110761">w</span><span class="op" id="3110762">.</span><span class="ident" id="3110763">ElseList</span><span class="op" id="3110771">.</span><span class="ident" id="3110772">CopyList</span><span class="op" id="3110780">(</span><span class="op" id="3110781">)</span><span class="op" id="3110782">)</span><br>
<span class="lineno">805</span><span class="op" id="3110784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3110787">//&nbsp;TemplateNode&nbsp;represents&nbsp;a&nbsp;{{template}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="3110837">type</span>&nbsp;<span class="ident" id="3110842">TemplateNode</span>&nbsp;<span class="keyword" id="3110855">struct</span>&nbsp;<span class="op" id="3110862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3110865">NodeType</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3110875">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3110880">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3110885">*</span><span class="ident" id="3110886">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3110892">Line</span>&nbsp;<span class="builtintype" id="3110897">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3110907">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3110977">Name</span>&nbsp;<span class="builtintype" id="3110982">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3110992">//&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;template&nbsp;(unquoted).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3111033">Pipe</span>&nbsp;<span class="op" id="3111038">*</span><span class="ident" id="3111039">PipeNode</span>&nbsp;<span class="comment" id="3111048">//&nbsp;The&nbsp;command&nbsp;to&nbsp;evaluate&nbsp;as&nbsp;dot&nbsp;for&nbsp;the&nbsp;template.</span><br>
<span class="lineno">815</span><span class="op" id="3111100">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3111103">func</span>&nbsp;<span class="op" id="3111108">(</span><span class="ident" id="3111109">t</span>&nbsp;<span class="op" id="3111111">*</span><span class="ident" id="3111112">Tree</span><span class="op" id="3111116">)</span>&nbsp;<span class="ident" id="3111118">newTemplate</span><span class="op" id="3111129">(</span><span class="ident" id="3111130">pos</span>&nbsp;<span class="ident" id="3111134">Pos</span><span class="op" id="3111137">,</span>&nbsp;<span class="ident" id="3111139">line</span>&nbsp;<span class="builtintype" id="3111144">int</span><span class="op" id="3111147">,</span>&nbsp;<span class="ident" id="3111149">name</span>&nbsp;<span class="builtintype" id="3111154">string</span><span class="op" id="3111160">,</span>&nbsp;<span class="ident" id="3111162">pipe</span>&nbsp;<span class="op" id="3111167">*</span><span class="ident" id="3111168">PipeNode</span><span class="op" id="3111176">)</span>&nbsp;<span class="op" id="3111178">*</span><span class="ident" id="3111179">TemplateNode</span>&nbsp;<span class="op" id="3111192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3111195">return</span>&nbsp;<span class="op" id="3111202">&amp;</span><span class="ident" id="3111203">TemplateNode</span><span class="op" id="3111215">{</span><span class="ident" id="3111216">tr</span><span class="op" id="3111218">:</span>&nbsp;<span class="ident" id="3111220">t</span><span class="op" id="3111221">,</span>&nbsp;<span class="ident" id="3111223">NodeType</span><span class="op" id="3111231">:</span>&nbsp;<span class="ident" id="3111233">NodeTemplate</span><span class="op" id="3111245">,</span>&nbsp;<span class="ident" id="3111247">Pos</span><span class="op" id="3111250">:</span>&nbsp;<span class="ident" id="3111252">pos</span><span class="op" id="3111255">,</span>&nbsp;<span class="ident" id="3111257">Line</span><span class="op" id="3111261">:</span>&nbsp;<span class="ident" id="3111263">line</span><span class="op" id="3111267">,</span>&nbsp;<span class="ident" id="3111269">Name</span><span class="op" id="3111273">:</span>&nbsp;<span class="ident" id="3111275">name</span><span class="op" id="3111279">,</span>&nbsp;<span class="ident" id="3111281">Pipe</span><span class="op" id="3111285">:</span>&nbsp;<span class="ident" id="3111287">pipe</span><span class="op" id="3111291">}</span><br>
<span class="lineno"></span><span class="op" id="3111293">}</span><br>
<span class="lineno">820</span><br>
<span class="lineno"></span><span class="keyword" id="3111296">func</span>&nbsp;<span class="op" id="3111301">(</span><span class="ident" id="3111302">t</span>&nbsp;<span class="op" id="3111304">*</span><span class="ident" id="3111305">TemplateNode</span><span class="op" id="3111317">)</span>&nbsp;<span class="ident" id="3111319">String</span><span class="op" id="3111325">(</span><span class="op" id="3111326">)</span>&nbsp;<span class="builtintype" id="3111328">string</span>&nbsp;<span class="op" id="3111335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3111338">if</span>&nbsp;<span class="ident" id="3111341">t</span><span class="op" id="3111342">.</span><span class="ident" id="3111343">Pipe</span>&nbsp;<span class="op" id="3111348">==</span>&nbsp;<span class="builtintype" id="3111351">nil</span>&nbsp;<span class="op" id="3111355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3111359">return</span>&nbsp;<span class="ident" id="3111366">fmt</span><span class="op" id="3111369">.</span><span class="ident" id="3111370">Sprintf</span><span class="op" id="3111377">(</span><span class="string" id="3111378">&#34;{{template&nbsp;%q}}&#34;</span><span class="op" id="3111395">,</span>&nbsp;<span class="ident" id="3111397">t</span><span class="op" id="3111398">.</span><span class="ident" id="3111399">Name</span><span class="op" id="3111403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3111406">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3111409">return</span>&nbsp;<span class="ident" id="3111416">fmt</span><span class="op" id="3111419">.</span><span class="ident" id="3111420">Sprintf</span><span class="op" id="3111427">(</span><span class="string" id="3111428">&#34;{{template&nbsp;%q&nbsp;%s}}&#34;</span><span class="op" id="3111448">,</span>&nbsp;<span class="ident" id="3111450">t</span><span class="op" id="3111451">.</span><span class="ident" id="3111452">Name</span><span class="op" id="3111456">,</span>&nbsp;<span class="ident" id="3111458">t</span><span class="op" id="3111459">.</span><span class="ident" id="3111460">Pipe</span><span class="op" id="3111464">)</span><br>
<span class="lineno"></span><span class="op" id="3111466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3111469">func</span>&nbsp;<span class="op" id="3111474">(</span><span class="ident" id="3111475">t</span>&nbsp;<span class="op" id="3111477">*</span><span class="ident" id="3111478">TemplateNode</span><span class="op" id="3111490">)</span>&nbsp;<span class="ident" id="3111492">tree</span><span class="op" id="3111496">(</span><span class="op" id="3111497">)</span>&nbsp;<span class="op" id="3111499">*</span><span class="ident" id="3111500">Tree</span>&nbsp;<span class="op" id="3111505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3111508">return</span>&nbsp;<span class="ident" id="3111515">t</span><span class="op" id="3111516">.</span><span class="ident" id="3111517">tr</span><br>
<span class="lineno">830</span><span class="op" id="3111520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3111523">func</span>&nbsp;<span class="op" id="3111528">(</span><span class="ident" id="3111529">t</span>&nbsp;<span class="op" id="3111531">*</span><span class="ident" id="3111532">TemplateNode</span><span class="op" id="3111544">)</span>&nbsp;<span class="ident" id="3111546">Copy</span><span class="op" id="3111550">(</span><span class="op" id="3111551">)</span>&nbsp;<span class="ident" id="3111553">Node</span>&nbsp;<span class="op" id="3111558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3111561">return</span>&nbsp;<span class="ident" id="3111568">t</span><span class="op" id="3111569">.</span><span class="ident" id="3111570">tr</span><span class="op" id="3111572">.</span><span class="ident" id="3111573">newTemplate</span><span class="op" id="3111584">(</span><span class="ident" id="3111585">t</span><span class="op" id="3111586">.</span><span class="ident" id="3111587">Pos</span><span class="op" id="3111590">,</span>&nbsp;<span class="ident" id="3111592">t</span><span class="op" id="3111593">.</span><span class="ident" id="3111594">Line</span><span class="op" id="3111598">,</span>&nbsp;<span class="ident" id="3111600">t</span><span class="op" id="3111601">.</span><span class="ident" id="3111602">Name</span><span class="op" id="3111606">,</span>&nbsp;<span class="ident" id="3111608">t</span><span class="op" id="3111609">.</span><span class="ident" id="3111610">Pipe</span><span class="op" id="3111614">.</span><span class="ident" id="3111615">CopyPipe</span><span class="op" id="3111623">(</span><span class="op" id="3111624">)</span><span class="op" id="3111625">)</span><br>
<span class="lineno"></span><span class="op" id="3111627">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
