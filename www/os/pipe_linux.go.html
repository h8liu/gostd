<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2080770">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2080825">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2080879">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2080930">package</span>&nbsp;<span class="ident" id="2080938">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2080942">import</span>&nbsp;<span class="string" id="2080949">&#34;syscall&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2080960">//&nbsp;Pipe&nbsp;returns&nbsp;a&nbsp;connected&nbsp;pair&nbsp;of&nbsp;Files;&nbsp;reads&nbsp;from&nbsp;r&nbsp;return&nbsp;bytes&nbsp;written&nbsp;to&nbsp;w.</span><br>
<span class="lineno">10</span><span class="comment" id="2081043">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;files&nbsp;and&nbsp;an&nbsp;error,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span><span class="keyword" id="2081089">func</span>&nbsp;<span class="ident" id="2081094">Pipe</span><span class="op" id="2081098">(</span><span class="op" id="2081099">)</span>&nbsp;<span class="op" id="2081101">(</span><span class="ident" id="2081102">r</span>&nbsp;<span class="op" id="2081104">*</span><span class="ident" id="2081105"><a href="/os/file_unix.go.html#2065616">File</a></span><span class="op" id="2081109">,</span>&nbsp;<span class="ident" id="2081111">w</span>&nbsp;<span class="op" id="2081113">*</span><span class="ident" id="2081114"><a href="/os/file_unix.go.html#2065616">File</a></span><span class="op" id="2081118">,</span>&nbsp;<span class="ident" id="2081120">err</span>&nbsp;<span class="builtintype" id="2081124">error</span><span class="op" id="2081129">)</span>&nbsp;<span class="op" id="2081131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081134">var</span>&nbsp;<span class="ident" id="2081138">p</span>&nbsp;<span class="op" id="2081140">[</span><span class="num" id="2081141">2</span><span class="op" id="2081142">]</span><span class="builtintype" id="2081143">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2081149">e</span>&nbsp;<span class="op" id="2081151">:=</span>&nbsp;<span class="ident" id="2081154"><a href="/os/pipe_linux.go.html#2080949">syscall</a></span><span class="op" id="2081161">.</span><span class="ident" id="2081162">Pipe2</span><span class="op" id="2081167">(</span><span class="ident" id="2081168"><a href="/os/pipe_linux.go.html#2081138">p</a></span><span class="op" id="2081169">[</span><span class="num" id="2081170">0</span><span class="op" id="2081171">:</span><span class="op" id="2081172">]</span><span class="op" id="2081173">,</span>&nbsp;<span class="ident" id="2081175"><a href="/os/pipe_linux.go.html#2080949">syscall</a></span><span class="op" id="2081182">.</span><span class="ident" id="2081183">O_CLOEXEC</span><span class="op" id="2081192">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2081195">//&nbsp;pipe2&nbsp;was&nbsp;added&nbsp;in&nbsp;2.6.27&nbsp;and&nbsp;our&nbsp;minimum&nbsp;requirement&nbsp;is&nbsp;2.6.23,&nbsp;so&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2081270">//&nbsp;might&nbsp;not&nbsp;be&nbsp;implemented.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081300">if</span>&nbsp;<span class="ident" id="2081303"><a href="/os/pipe_linux.go.html#2081149">e</a></span>&nbsp;<span class="op" id="2081305">==</span>&nbsp;<span class="ident" id="2081308"><a href="/os/pipe_linux.go.html#2080949">syscall</a></span><span class="op" id="2081315">.</span><span class="ident" id="2081316">ENOSYS</span>&nbsp;<span class="op" id="2081323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2081327">//&nbsp;See&nbsp;../syscall/exec.go&nbsp;for&nbsp;description&nbsp;of&nbsp;lock.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2081380"><a href="/os/pipe_linux.go.html#2080949">syscall</a></span><span class="op" id="2081387">.</span><span class="ident" id="2081388">ForkLock</span><span class="op" id="2081396">.</span><span class="ident" id="2081397">RLock</span><span class="op" id="2081402">(</span><span class="op" id="2081403">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2081407"><a href="/os/pipe_linux.go.html#2081149">e</a></span>&nbsp;<span class="op" id="2081409">=</span>&nbsp;<span class="ident" id="2081411"><a href="/os/pipe_linux.go.html#2080949">syscall</a></span><span class="op" id="2081418">.</span><span class="ident" id="2081419">Pipe</span><span class="op" id="2081423">(</span><span class="ident" id="2081424"><a href="/os/pipe_linux.go.html#2081138">p</a></span><span class="op" id="2081425">[</span><span class="num" id="2081426">0</span><span class="op" id="2081427">:</span><span class="op" id="2081428">]</span><span class="op" id="2081429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081433">if</span>&nbsp;<span class="ident" id="2081436"><a href="/os/pipe_linux.go.html#2081149">e</a></span>&nbsp;<span class="op" id="2081438">!=</span>&nbsp;<span class="ident" id="2081441">nil</span>&nbsp;<span class="op" id="2081445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2081450"><a href="/os/pipe_linux.go.html#2080949">syscall</a></span><span class="op" id="2081457">.</span><span class="ident" id="2081458">ForkLock</span><span class="op" id="2081466">.</span><span class="ident" id="2081467">RUnlock</span><span class="op" id="2081474">(</span><span class="op" id="2081475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081480">return</span>&nbsp;<span class="ident" id="2081487">nil</span><span class="op" id="2081490">,</span>&nbsp;<span class="ident" id="2081492">nil</span><span class="op" id="2081495">,</span>&nbsp;<span class="ident" id="2081497"><a href="/os/error.go.html#2044800">NewSyscallError</a></span><span class="op" id="2081512">(</span><span class="string" id="2081513">&#34;pipe&#34;</span><span class="op" id="2081519">,</span>&nbsp;<span class="ident" id="2081521"><a href="/os/pipe_linux.go.html#2081149">e</a></span><span class="op" id="2081522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2081526">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2081530"><a href="/os/pipe_linux.go.html#2080949">syscall</a></span><span class="op" id="2081537">.</span><span class="ident" id="2081538">CloseOnExec</span><span class="op" id="2081549">(</span><span class="ident" id="2081550"><a href="/os/pipe_linux.go.html#2081138">p</a></span><span class="op" id="2081551">[</span><span class="num" id="2081552">0</span><span class="op" id="2081553">]</span><span class="op" id="2081554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2081558"><a href="/os/pipe_linux.go.html#2080949">syscall</a></span><span class="op" id="2081565">.</span><span class="ident" id="2081566">CloseOnExec</span><span class="op" id="2081577">(</span><span class="ident" id="2081578"><a href="/os/pipe_linux.go.html#2081138">p</a></span><span class="op" id="2081579">[</span><span class="num" id="2081580">1</span><span class="op" id="2081581">]</span><span class="op" id="2081582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2081586"><a href="/os/pipe_linux.go.html#2080949">syscall</a></span><span class="op" id="2081593">.</span><span class="ident" id="2081594">ForkLock</span><span class="op" id="2081602">.</span><span class="ident" id="2081603">RUnlock</span><span class="op" id="2081610">(</span><span class="op" id="2081611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2081614">}</span>&nbsp;<span class="keyword" id="2081616">else</span>&nbsp;<span class="keyword" id="2081621">if</span>&nbsp;<span class="ident" id="2081624"><a href="/os/pipe_linux.go.html#2081149">e</a></span>&nbsp;<span class="op" id="2081626">!=</span>&nbsp;<span class="ident" id="2081629">nil</span>&nbsp;<span class="op" id="2081633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081637">return</span>&nbsp;<span class="ident" id="2081644">nil</span><span class="op" id="2081647">,</span>&nbsp;<span class="ident" id="2081649">nil</span><span class="op" id="2081652">,</span>&nbsp;<span class="ident" id="2081654"><a href="/os/error.go.html#2044800">NewSyscallError</a></span><span class="op" id="2081669">(</span><span class="string" id="2081670">&#34;pipe2&#34;</span><span class="op" id="2081677">,</span>&nbsp;<span class="ident" id="2081679"><a href="/os/pipe_linux.go.html#2081149">e</a></span><span class="op" id="2081680">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2081683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2081687">return</span>&nbsp;<span class="ident" id="2081694"><a href="/os/file_unix.go.html#2066344">NewFile</a></span><span class="op" id="2081701">(</span><span class="builtintype" id="2081702">uintptr</span><span class="op" id="2081709">(</span><span class="ident" id="2081710"><a href="/os/pipe_linux.go.html#2081138">p</a></span><span class="op" id="2081711">[</span><span class="num" id="2081712">0</span><span class="op" id="2081713">]</span><span class="op" id="2081714">)</span><span class="op" id="2081715">,</span>&nbsp;<span class="string" id="2081717">&#34;|0&#34;</span><span class="op" id="2081721">)</span><span class="op" id="2081722">,</span>&nbsp;<span class="ident" id="2081724"><a href="/os/file_unix.go.html#2066344">NewFile</a></span><span class="op" id="2081731">(</span><span class="builtintype" id="2081732">uintptr</span><span class="op" id="2081739">(</span><span class="ident" id="2081740"><a href="/os/pipe_linux.go.html#2081138">p</a></span><span class="op" id="2081741">[</span><span class="num" id="2081742">1</span><span class="op" id="2081743">]</span><span class="op" id="2081744">)</span><span class="op" id="2081745">,</span>&nbsp;<span class="string" id="2081747">&#34;|1&#34;</span><span class="op" id="2081751">)</span><span class="op" id="2081752">,</span>&nbsp;<span class="ident" id="2081754">nil</span><br>
<span class="lineno"></span><span class="op" id="2081758">}</span>
</div>
</body>
</html>
