<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>database/sql/driver</h2>
<ul>
<li><a href="/gostd/database/sql/driver/driver.go.html" class="current">driver.go</a></li>
<li><a href="/gostd/database/sql/driver/types.go.html">types.go</a></li>
<li><a href="/gostd/database/sql/driver/types_test.go.html">types_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6252490">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6252545">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6252599">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6252650">//&nbsp;Package&nbsp;driver&nbsp;defines&nbsp;interfaces&nbsp;to&nbsp;be&nbsp;implemented&nbsp;by&nbsp;database</span><br>
<span class="lineno"></span><span class="comment" id="6252717">//&nbsp;drivers&nbsp;as&nbsp;used&nbsp;by&nbsp;package&nbsp;sql.</span><br>
<span class="lineno"></span><span class="comment" id="6252752">//</span><br>
<span class="lineno"></span><span class="comment" id="6252755">//&nbsp;Most&nbsp;code&nbsp;should&nbsp;use&nbsp;package&nbsp;sql.</span><br>
<span class="lineno"></span><span class="keyword" id="6252792">package</span>&nbsp;<span class="ident" id="6252800">driver</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="6252808">import</span>&nbsp;<span class="string" id="6252815">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6252825">//&nbsp;Value&nbsp;is&nbsp;a&nbsp;value&nbsp;that&nbsp;drivers&nbsp;must&nbsp;be&nbsp;able&nbsp;to&nbsp;handle.</span><br>
<span class="lineno"></span><span class="comment" id="6252882">//&nbsp;It&nbsp;is&nbsp;either&nbsp;nil&nbsp;or&nbsp;an&nbsp;instance&nbsp;of&nbsp;one&nbsp;of&nbsp;these&nbsp;types:</span><br>
<span class="lineno">15</span><span class="comment" id="6252940">//</span><br>
<span class="lineno"></span><span class="comment" id="6252943">//&nbsp;&nbsp;&nbsp;int64</span><br>
<span class="lineno"></span><span class="comment" id="6252954">//&nbsp;&nbsp;&nbsp;float64</span><br>
<span class="lineno"></span><span class="comment" id="6252967">//&nbsp;&nbsp;&nbsp;bool</span><br>
<span class="lineno"></span><span class="comment" id="6252977">//&nbsp;&nbsp;&nbsp;[]byte</span><br>
<span class="lineno">20</span><span class="comment" id="6252989">//&nbsp;&nbsp;&nbsp;string&nbsp;&nbsp;&nbsp;[*]&nbsp;everywhere&nbsp;except&nbsp;from&nbsp;Rows.Next.</span><br>
<span class="lineno"></span><span class="comment" id="6253041">//&nbsp;&nbsp;&nbsp;time.Time</span><br>
<span class="lineno"></span><span class="keyword" id="6253056">type</span>&nbsp;<span class="ident" id="6253061">Value</span>&nbsp;<span class="keyword" id="6253067">interface</span><span class="op" id="6253076">{</span><span class="op" id="6253077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6253080">//&nbsp;Driver&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;must&nbsp;be&nbsp;implemented&nbsp;by&nbsp;a&nbsp;database</span><br>
<span class="lineno">25</span><span class="comment" id="6253146">//&nbsp;driver.</span><br>
<span class="lineno"></span><span class="keyword" id="6253157">type</span>&nbsp;<span class="ident" id="6253162">Driver</span>&nbsp;<span class="keyword" id="6253169">interface</span>&nbsp;<span class="op" id="6253179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6253182">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;connection&nbsp;to&nbsp;the&nbsp;database.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6253233">//&nbsp;The&nbsp;name&nbsp;is&nbsp;a&nbsp;string&nbsp;in&nbsp;a&nbsp;driver-specific&nbsp;format.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6253287">//</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6253291">//&nbsp;Open&nbsp;may&nbsp;return&nbsp;a&nbsp;cached&nbsp;connection&nbsp;(one&nbsp;previously</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6253347">//&nbsp;closed),&nbsp;but&nbsp;doing&nbsp;so&nbsp;is&nbsp;unnecessary;&nbsp;the&nbsp;sql&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6253405">//&nbsp;maintains&nbsp;a&nbsp;pool&nbsp;of&nbsp;idle&nbsp;connections&nbsp;for&nbsp;efficient&nbsp;re-use.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6253468">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6253472">//&nbsp;The&nbsp;returned&nbsp;connection&nbsp;is&nbsp;only&nbsp;used&nbsp;by&nbsp;one&nbsp;goroutine&nbsp;at&nbsp;a</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6253535">//&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6253545">Open</span><span class="op" id="6253549">(</span><span class="ident" id="6253550">name</span>&nbsp;<span class="builtintype" id="6253555">string</span><span class="op" id="6253561">)</span>&nbsp;<span class="op" id="6253563">(</span><span class="ident" id="6253564">Conn</span><span class="op" id="6253568">,</span>&nbsp;<span class="builtintype" id="6253570">error</span><span class="op" id="6253575">)</span><br>
<span class="lineno"></span><span class="op" id="6253577">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6253580">//&nbsp;ErrSkip&nbsp;may&nbsp;be&nbsp;returned&nbsp;by&nbsp;some&nbsp;optional&nbsp;interfaces&#39;&nbsp;methods&nbsp;to</span><br>
<span class="lineno">40</span><span class="comment" id="6253647">//&nbsp;indicate&nbsp;at&nbsp;runtime&nbsp;that&nbsp;the&nbsp;fast&nbsp;path&nbsp;is&nbsp;unavailable&nbsp;and&nbsp;the&nbsp;sql</span><br>
<span class="lineno"></span><span class="comment" id="6253716">//&nbsp;package&nbsp;should&nbsp;continue&nbsp;as&nbsp;if&nbsp;the&nbsp;optional&nbsp;interface&nbsp;was&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="6253780">//&nbsp;implemented.&nbsp;ErrSkip&nbsp;is&nbsp;only&nbsp;supported&nbsp;where&nbsp;explicitly</span><br>
<span class="lineno"></span><span class="comment" id="6253839">//&nbsp;documented.</span><br>
<span class="lineno"></span><span class="keyword" id="6253854">var</span>&nbsp;<span class="ident" id="6253858">ErrSkip</span>&nbsp;<span class="op" id="6253866">=</span>&nbsp;<span class="ident" id="6253868">errors</span><span class="op" id="6253874">.</span><span class="ident" id="6253875">New</span><span class="op" id="6253878">(</span><span class="string" id="6253879">&#34;driver:&nbsp;skip&nbsp;fast-path;&nbsp;continue&nbsp;as&nbsp;if&nbsp;unimplemented&#34;</span><span class="op" id="6253933">)</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="6253936">//&nbsp;ErrBadConn&nbsp;should&nbsp;be&nbsp;returned&nbsp;by&nbsp;a&nbsp;driver&nbsp;to&nbsp;signal&nbsp;to&nbsp;the&nbsp;sql</span><br>
<span class="lineno"></span><span class="comment" id="6254002">//&nbsp;package&nbsp;that&nbsp;a&nbsp;driver.Conn&nbsp;is&nbsp;in&nbsp;a&nbsp;bad&nbsp;state&nbsp;(such&nbsp;as&nbsp;the&nbsp;server</span><br>
<span class="lineno"></span><span class="comment" id="6254070">//&nbsp;having&nbsp;earlier&nbsp;closed&nbsp;the&nbsp;connection)&nbsp;and&nbsp;the&nbsp;sql&nbsp;package&nbsp;should</span><br>
<span class="lineno"></span><span class="comment" id="6254138">//&nbsp;retry&nbsp;on&nbsp;a&nbsp;new&nbsp;connection.</span><br>
<span class="lineno">50</span><span class="comment" id="6254168">//</span><br>
<span class="lineno"></span><span class="comment" id="6254171">//&nbsp;To&nbsp;prevent&nbsp;duplicate&nbsp;operations,&nbsp;ErrBadConn&nbsp;should&nbsp;NOT&nbsp;be&nbsp;returned</span><br>
<span class="lineno"></span><span class="comment" id="6254241">//&nbsp;if&nbsp;there&#39;s&nbsp;a&nbsp;possibility&nbsp;that&nbsp;the&nbsp;database&nbsp;server&nbsp;might&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="6254305">//&nbsp;performed&nbsp;the&nbsp;operation.&nbsp;Even&nbsp;if&nbsp;the&nbsp;server&nbsp;sends&nbsp;back&nbsp;an&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="6254373">//&nbsp;you&nbsp;shouldn&#39;t&nbsp;return&nbsp;ErrBadConn.</span><br>
<span class="lineno">55</span><span class="keyword" id="6254409">var</span>&nbsp;<span class="ident" id="6254413">ErrBadConn</span>&nbsp;<span class="op" id="6254424">=</span>&nbsp;<span class="ident" id="6254426">errors</span><span class="op" id="6254432">.</span><span class="ident" id="6254433">New</span><span class="op" id="6254436">(</span><span class="string" id="6254437">&#34;driver:&nbsp;bad&nbsp;connection&#34;</span><span class="op" id="6254461">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6254464">//&nbsp;Execer&nbsp;is&nbsp;an&nbsp;optional&nbsp;interface&nbsp;that&nbsp;may&nbsp;be&nbsp;implemented&nbsp;by&nbsp;a&nbsp;Conn.</span><br>
<span class="lineno"></span><span class="comment" id="6254534">//</span><br>
<span class="lineno"></span><span class="comment" id="6254537">//&nbsp;If&nbsp;a&nbsp;Conn&nbsp;does&nbsp;not&nbsp;implement&nbsp;Execer,&nbsp;the&nbsp;sql&nbsp;package&#39;s&nbsp;DB.Exec&nbsp;will</span><br>
<span class="lineno">60</span><span class="comment" id="6254608">//&nbsp;first&nbsp;prepare&nbsp;a&nbsp;query,&nbsp;execute&nbsp;the&nbsp;statement,&nbsp;and&nbsp;then&nbsp;close&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6254676">//&nbsp;statement.</span><br>
<span class="lineno"></span><span class="comment" id="6254690">//</span><br>
<span class="lineno"></span><span class="comment" id="6254693">//&nbsp;Exec&nbsp;may&nbsp;return&nbsp;ErrSkip.</span><br>
<span class="lineno"></span><span class="keyword" id="6254721">type</span>&nbsp;<span class="ident" id="6254726">Execer</span>&nbsp;<span class="keyword" id="6254733">interface</span>&nbsp;<span class="op" id="6254743">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6254746">Exec</span><span class="op" id="6254750">(</span><span class="ident" id="6254751">query</span>&nbsp;<span class="builtintype" id="6254757">string</span><span class="op" id="6254763">,</span>&nbsp;<span class="ident" id="6254765">args</span>&nbsp;<span class="op" id="6254770">[</span><span class="op" id="6254771">]</span><span class="ident" id="6254772">Value</span><span class="op" id="6254777">)</span>&nbsp;<span class="op" id="6254779">(</span><span class="ident" id="6254780">Result</span><span class="op" id="6254786">,</span>&nbsp;<span class="builtintype" id="6254788">error</span><span class="op" id="6254793">)</span><br>
<span class="lineno"></span><span class="op" id="6254795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6254798">//&nbsp;Queryer&nbsp;is&nbsp;an&nbsp;optional&nbsp;interface&nbsp;that&nbsp;may&nbsp;be&nbsp;implemented&nbsp;by&nbsp;a&nbsp;Conn.</span><br>
<span class="lineno"></span><span class="comment" id="6254869">//</span><br>
<span class="lineno">70</span><span class="comment" id="6254872">//&nbsp;If&nbsp;a&nbsp;Conn&nbsp;does&nbsp;not&nbsp;implement&nbsp;Queryer,&nbsp;the&nbsp;sql&nbsp;package&#39;s&nbsp;DB.Query&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="6254945">//&nbsp;first&nbsp;prepare&nbsp;a&nbsp;query,&nbsp;execute&nbsp;the&nbsp;statement,&nbsp;and&nbsp;then&nbsp;close&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6255013">//&nbsp;statement.</span><br>
<span class="lineno"></span><span class="comment" id="6255027">//</span><br>
<span class="lineno"></span><span class="comment" id="6255030">//&nbsp;Query&nbsp;may&nbsp;return&nbsp;ErrSkip.</span><br>
<span class="lineno">75</span><span class="keyword" id="6255059">type</span>&nbsp;<span class="ident" id="6255064">Queryer</span>&nbsp;<span class="keyword" id="6255072">interface</span>&nbsp;<span class="op" id="6255082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6255085">Query</span><span class="op" id="6255090">(</span><span class="ident" id="6255091">query</span>&nbsp;<span class="builtintype" id="6255097">string</span><span class="op" id="6255103">,</span>&nbsp;<span class="ident" id="6255105">args</span>&nbsp;<span class="op" id="6255110">[</span><span class="op" id="6255111">]</span><span class="ident" id="6255112">Value</span><span class="op" id="6255117">)</span>&nbsp;<span class="op" id="6255119">(</span><span class="ident" id="6255120">Rows</span><span class="op" id="6255124">,</span>&nbsp;<span class="builtintype" id="6255126">error</span><span class="op" id="6255131">)</span><br>
<span class="lineno"></span><span class="op" id="6255133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6255136">//&nbsp;Conn&nbsp;is&nbsp;a&nbsp;connection&nbsp;to&nbsp;a&nbsp;database.&nbsp;It&nbsp;is&nbsp;not&nbsp;used&nbsp;concurrently</span><br>
<span class="lineno">80</span><span class="comment" id="6255203">//&nbsp;by&nbsp;multiple&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="comment" id="6255230">//</span><br>
<span class="lineno"></span><span class="comment" id="6255233">//&nbsp;Conn&nbsp;is&nbsp;assumed&nbsp;to&nbsp;be&nbsp;stateful.</span><br>
<span class="lineno"></span><span class="keyword" id="6255268">type</span>&nbsp;<span class="ident" id="6255273">Conn</span>&nbsp;<span class="keyword" id="6255278">interface</span>&nbsp;<span class="op" id="6255288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6255291">//&nbsp;Prepare&nbsp;returns&nbsp;a&nbsp;prepared&nbsp;statement,&nbsp;bound&nbsp;to&nbsp;this&nbsp;connection.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6255359">Prepare</span><span class="op" id="6255366">(</span><span class="ident" id="6255367">query</span>&nbsp;<span class="builtintype" id="6255373">string</span><span class="op" id="6255379">)</span>&nbsp;<span class="op" id="6255381">(</span><span class="ident" id="6255382">Stmt</span><span class="op" id="6255386">,</span>&nbsp;<span class="builtintype" id="6255388">error</span><span class="op" id="6255393">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6255397">//&nbsp;Close&nbsp;invalidates&nbsp;and&nbsp;potentially&nbsp;stops&nbsp;any&nbsp;current</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6255453">//&nbsp;prepared&nbsp;statements&nbsp;and&nbsp;transactions,&nbsp;marking&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6255508">//&nbsp;connection&nbsp;as&nbsp;no&nbsp;longer&nbsp;in&nbsp;use.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6255544">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6255548">//&nbsp;Because&nbsp;the&nbsp;sql&nbsp;package&nbsp;maintains&nbsp;a&nbsp;free&nbsp;pool&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6255601">//&nbsp;connections&nbsp;and&nbsp;only&nbsp;calls&nbsp;Close&nbsp;when&nbsp;there&#39;s&nbsp;a&nbsp;surplus&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6255664">//&nbsp;idle&nbsp;connections,&nbsp;it&nbsp;shouldn&#39;t&nbsp;be&nbsp;necessary&nbsp;for&nbsp;drivers&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6255727">//&nbsp;do&nbsp;their&nbsp;own&nbsp;connection&nbsp;caching.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6255764">Close</span><span class="op" id="6255769">(</span><span class="op" id="6255770">)</span>&nbsp;<span class="builtintype" id="6255772">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6255780">//&nbsp;Begin&nbsp;starts&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;transaction.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6255828">Begin</span><span class="op" id="6255833">(</span><span class="op" id="6255834">)</span>&nbsp;<span class="op" id="6255836">(</span><span class="ident" id="6255837">Tx</span><span class="op" id="6255839">,</span>&nbsp;<span class="builtintype" id="6255841">error</span><span class="op" id="6255846">)</span><br>
<span class="lineno"></span><span class="op" id="6255848">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="6255851">//&nbsp;Result&nbsp;is&nbsp;the&nbsp;result&nbsp;of&nbsp;a&nbsp;query&nbsp;execution.</span><br>
<span class="lineno"></span><span class="keyword" id="6255897">type</span>&nbsp;<span class="ident" id="6255902">Result</span>&nbsp;<span class="keyword" id="6255909">interface</span>&nbsp;<span class="op" id="6255919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6255922">//&nbsp;LastInsertId&nbsp;returns&nbsp;the&nbsp;database&#39;s&nbsp;auto-generated&nbsp;ID</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6255980">//&nbsp;after,&nbsp;for&nbsp;example,&nbsp;an&nbsp;INSERT&nbsp;into&nbsp;a&nbsp;table&nbsp;with&nbsp;primary</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6256040">//&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256049">LastInsertId</span><span class="op" id="6256061">(</span><span class="op" id="6256062">)</span>&nbsp;<span class="op" id="6256064">(</span><span class="ident" id="6256065">int64</span><span class="op" id="6256070">,</span>&nbsp;<span class="builtintype" id="6256072">error</span><span class="op" id="6256077">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6256081">//&nbsp;RowsAffected&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;rows&nbsp;affected&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6256141">//&nbsp;query.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256152">RowsAffected</span><span class="op" id="6256164">(</span><span class="op" id="6256165">)</span>&nbsp;<span class="op" id="6256167">(</span><span class="ident" id="6256168">int64</span><span class="op" id="6256173">,</span>&nbsp;<span class="builtintype" id="6256175">error</span><span class="op" id="6256180">)</span><br>
<span class="lineno"></span><span class="op" id="6256182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6256185">//&nbsp;Stmt&nbsp;is&nbsp;a&nbsp;prepared&nbsp;statement.&nbsp;It&nbsp;is&nbsp;bound&nbsp;to&nbsp;a&nbsp;Conn&nbsp;and&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="6256248">//&nbsp;used&nbsp;by&nbsp;multiple&nbsp;goroutines&nbsp;concurrently.</span><br>
<span class="lineno">115</span><span class="keyword" id="6256293">type</span>&nbsp;<span class="ident" id="6256298">Stmt</span>&nbsp;<span class="keyword" id="6256303">interface</span>&nbsp;<span class="op" id="6256313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6256316">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;statement.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6256348">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6256352">//&nbsp;As&nbsp;of&nbsp;Go&nbsp;1.1,&nbsp;a&nbsp;Stmt&nbsp;will&nbsp;not&nbsp;be&nbsp;closed&nbsp;if&nbsp;it&#39;s&nbsp;in&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6256411">//&nbsp;by&nbsp;any&nbsp;queries.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256431">Close</span><span class="op" id="6256436">(</span><span class="op" id="6256437">)</span>&nbsp;<span class="builtintype" id="6256439">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6256447">//&nbsp;NumInput&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;placeholder&nbsp;parameters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6256506">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6256510">//&nbsp;If&nbsp;NumInput&nbsp;returns&nbsp;&gt;=&nbsp;0,&nbsp;the&nbsp;sql&nbsp;package&nbsp;will&nbsp;sanity&nbsp;check</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6256574">//&nbsp;argument&nbsp;counts&nbsp;from&nbsp;callers&nbsp;and&nbsp;return&nbsp;errors&nbsp;to&nbsp;the&nbsp;caller</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6256639">//&nbsp;before&nbsp;the&nbsp;statement&#39;s&nbsp;Exec&nbsp;or&nbsp;Query&nbsp;methods&nbsp;are&nbsp;called.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6256700">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6256704">//&nbsp;NumInput&nbsp;may&nbsp;also&nbsp;return&nbsp;-1,&nbsp;if&nbsp;the&nbsp;driver&nbsp;doesn&#39;t&nbsp;know</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6256764">//&nbsp;its&nbsp;number&nbsp;of&nbsp;placeholders.&nbsp;In&nbsp;that&nbsp;case,&nbsp;the&nbsp;sql&nbsp;package</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6256826">//&nbsp;will&nbsp;not&nbsp;sanity&nbsp;check&nbsp;Exec&nbsp;or&nbsp;Query&nbsp;argument&nbsp;counts.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256883">NumInput</span><span class="op" id="6256891">(</span><span class="op" id="6256892">)</span>&nbsp;<span class="builtintype" id="6256894">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6256900">//&nbsp;Exec&nbsp;executes&nbsp;a&nbsp;query&nbsp;that&nbsp;doesn&#39;t&nbsp;return&nbsp;rows,&nbsp;such</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6256957">//&nbsp;as&nbsp;an&nbsp;INSERT&nbsp;or&nbsp;UPDATE.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6256985">Exec</span><span class="op" id="6256989">(</span><span class="ident" id="6256990">args</span>&nbsp;<span class="op" id="6256995">[</span><span class="op" id="6256996">]</span><span class="ident" id="6256997">Value</span><span class="op" id="6257002">)</span>&nbsp;<span class="op" id="6257004">(</span><span class="ident" id="6257005">Result</span><span class="op" id="6257011">,</span>&nbsp;<span class="builtintype" id="6257013">error</span><span class="op" id="6257018">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6257022">//&nbsp;Query&nbsp;executes&nbsp;a&nbsp;query&nbsp;that&nbsp;may&nbsp;return&nbsp;rows,&nbsp;such&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6257081">//&nbsp;SELECT.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257093">Query</span><span class="op" id="6257098">(</span><span class="ident" id="6257099">args</span>&nbsp;<span class="op" id="6257104">[</span><span class="op" id="6257105">]</span><span class="ident" id="6257106">Value</span><span class="op" id="6257111">)</span>&nbsp;<span class="op" id="6257113">(</span><span class="ident" id="6257114">Rows</span><span class="op" id="6257118">,</span>&nbsp;<span class="builtintype" id="6257120">error</span><span class="op" id="6257125">)</span><br>
<span class="lineno">140</span><span class="op" id="6257127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6257130">//&nbsp;ColumnConverter&nbsp;may&nbsp;be&nbsp;optionally&nbsp;implemented&nbsp;by&nbsp;Stmt&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6257194">//&nbsp;statement&nbsp;is&nbsp;aware&nbsp;of&nbsp;its&nbsp;own&nbsp;columns&#39;&nbsp;types&nbsp;and&nbsp;can&nbsp;convert&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="6257263">//&nbsp;any&nbsp;type&nbsp;to&nbsp;a&nbsp;driver&nbsp;Value.</span><br>
<span class="lineno">145</span><span class="keyword" id="6257294">type</span>&nbsp;<span class="ident" id="6257299">ColumnConverter</span>&nbsp;<span class="keyword" id="6257315">interface</span>&nbsp;<span class="op" id="6257325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6257328">//&nbsp;ColumnConverter&nbsp;returns&nbsp;a&nbsp;ValueConverter&nbsp;for&nbsp;the&nbsp;provided</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6257390">//&nbsp;column&nbsp;index.&nbsp;&nbsp;If&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;specific&nbsp;column&nbsp;isn&#39;t&nbsp;known</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6257454">//&nbsp;or&nbsp;shouldn&#39;t&nbsp;be&nbsp;handled&nbsp;specially,&nbsp;DefaultValueConverter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6257515">//&nbsp;can&nbsp;be&nbsp;returned.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257536">ColumnConverter</span><span class="op" id="6257551">(</span><span class="ident" id="6257552">idx</span>&nbsp;<span class="builtintype" id="6257556">int</span><span class="op" id="6257559">)</span>&nbsp;<span class="ident" id="6257561">ValueConverter</span><br>
<span class="lineno"></span><span class="op" id="6257576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6257579">//&nbsp;Rows&nbsp;is&nbsp;an&nbsp;iterator&nbsp;over&nbsp;an&nbsp;executed&nbsp;query&#39;s&nbsp;results.</span><br>
<span class="lineno"></span><span class="keyword" id="6257636">type</span>&nbsp;<span class="ident" id="6257641">Rows</span>&nbsp;<span class="keyword" id="6257646">interface</span>&nbsp;<span class="op" id="6257656">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6257659">//&nbsp;Columns&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;the&nbsp;columns.&nbsp;The&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6257719">//&nbsp;columns&nbsp;of&nbsp;the&nbsp;result&nbsp;is&nbsp;inferred&nbsp;from&nbsp;the&nbsp;length&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6257780">//&nbsp;slice.&nbsp;&nbsp;If&nbsp;a&nbsp;particular&nbsp;column&nbsp;name&nbsp;isn&#39;t&nbsp;known,&nbsp;an&nbsp;empty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6257842">//&nbsp;string&nbsp;should&nbsp;be&nbsp;returned&nbsp;for&nbsp;that&nbsp;entry.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257888">Columns</span><span class="op" id="6257895">(</span><span class="op" id="6257896">)</span>&nbsp;<span class="op" id="6257898">[</span><span class="op" id="6257899">]</span><span class="builtintype" id="6257900">string</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6257909">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;rows&nbsp;iterator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6257945">Close</span><span class="op" id="6257950">(</span><span class="op" id="6257951">)</span>&nbsp;<span class="builtintype" id="6257953">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6257961">//&nbsp;Next&nbsp;is&nbsp;called&nbsp;to&nbsp;populate&nbsp;the&nbsp;next&nbsp;row&nbsp;of&nbsp;data&nbsp;into</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6258018">//&nbsp;the&nbsp;provided&nbsp;slice.&nbsp;The&nbsp;provided&nbsp;slice&nbsp;will&nbsp;be&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6258078">//&nbsp;size&nbsp;as&nbsp;the&nbsp;Columns()&nbsp;are&nbsp;wide.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6258114">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6258118">//&nbsp;The&nbsp;dest&nbsp;slice&nbsp;may&nbsp;be&nbsp;populated&nbsp;only&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6258164">//&nbsp;a&nbsp;driver&nbsp;Value&nbsp;type,&nbsp;but&nbsp;excluding&nbsp;string.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6258211">//&nbsp;All&nbsp;string&nbsp;values&nbsp;must&nbsp;be&nbsp;converted&nbsp;to&nbsp;[]byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6258262">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6258266">//&nbsp;Next&nbsp;should&nbsp;return&nbsp;io.EOF&nbsp;when&nbsp;there&nbsp;are&nbsp;no&nbsp;more&nbsp;rows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6258325">Next</span><span class="op" id="6258329">(</span><span class="ident" id="6258330">dest</span>&nbsp;<span class="op" id="6258335">[</span><span class="op" id="6258336">]</span><span class="ident" id="6258337">Value</span><span class="op" id="6258342">)</span>&nbsp;<span class="builtintype" id="6258344">error</span><br>
<span class="lineno"></span><span class="op" id="6258350">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="6258353">//&nbsp;Tx&nbsp;is&nbsp;a&nbsp;transaction.</span><br>
<span class="lineno"></span><span class="keyword" id="6258377">type</span>&nbsp;<span class="ident" id="6258382">Tx</span>&nbsp;<span class="keyword" id="6258385">interface</span>&nbsp;<span class="op" id="6258395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6258398">Commit</span><span class="op" id="6258404">(</span><span class="op" id="6258405">)</span>&nbsp;<span class="builtintype" id="6258407">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6258414">Rollback</span><span class="op" id="6258422">(</span><span class="op" id="6258423">)</span>&nbsp;<span class="builtintype" id="6258425">error</span><br>
<span class="lineno">180</span><span class="op" id="6258431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6258434">//&nbsp;RowsAffected&nbsp;implements&nbsp;Result&nbsp;for&nbsp;an&nbsp;INSERT&nbsp;or&nbsp;UPDATE&nbsp;operation</span><br>
<span class="lineno"></span><span class="comment" id="6258502">//&nbsp;which&nbsp;mutates&nbsp;a&nbsp;number&nbsp;of&nbsp;rows.</span><br>
<span class="lineno"></span><span class="keyword" id="6258537">type</span>&nbsp;<span class="ident" id="6258542">RowsAffected</span>&nbsp;<span class="ident" id="6258555">int64</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="6258562">var</span>&nbsp;<span class="ident" id="6258566">_</span>&nbsp;<span class="ident" id="6258568">Result</span>&nbsp;<span class="op" id="6258575">=</span>&nbsp;<span class="ident" id="6258577">RowsAffected</span><span class="op" id="6258589">(</span><span class="num" id="6258590">0</span><span class="op" id="6258591">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6258594">func</span>&nbsp;<span class="op" id="6258599">(</span><span class="ident" id="6258600">RowsAffected</span><span class="op" id="6258612">)</span>&nbsp;<span class="ident" id="6258614">LastInsertId</span><span class="op" id="6258626">(</span><span class="op" id="6258627">)</span>&nbsp;<span class="op" id="6258629">(</span><span class="ident" id="6258630">int64</span><span class="op" id="6258635">,</span>&nbsp;<span class="builtintype" id="6258637">error</span><span class="op" id="6258642">)</span>&nbsp;<span class="op" id="6258644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6258647">return</span>&nbsp;<span class="num" id="6258654">0</span><span class="op" id="6258655">,</span>&nbsp;<span class="ident" id="6258657">errors</span><span class="op" id="6258663">.</span><span class="ident" id="6258664">New</span><span class="op" id="6258667">(</span><span class="string" id="6258668">&#34;no&nbsp;LastInsertId&nbsp;available&#34;</span><span class="op" id="6258695">)</span><br>
<span class="lineno">190</span><span class="op" id="6258697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6258700">func</span>&nbsp;<span class="op" id="6258705">(</span><span class="ident" id="6258706">v</span>&nbsp;<span class="ident" id="6258708">RowsAffected</span><span class="op" id="6258720">)</span>&nbsp;<span class="ident" id="6258722">RowsAffected</span><span class="op" id="6258734">(</span><span class="op" id="6258735">)</span>&nbsp;<span class="op" id="6258737">(</span><span class="ident" id="6258738">int64</span><span class="op" id="6258743">,</span>&nbsp;<span class="builtintype" id="6258745">error</span><span class="op" id="6258750">)</span>&nbsp;<span class="op" id="6258752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6258755">return</span>&nbsp;<span class="ident" id="6258762">int64</span><span class="op" id="6258767">(</span><span class="ident" id="6258768">v</span><span class="op" id="6258769">)</span><span class="op" id="6258770">,</span>&nbsp;<span class="ident" id="6258772">nil</span><br>
<span class="lineno"></span><span class="op" id="6258776">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="comment" id="6258779">//&nbsp;ResultNoRows&nbsp;is&nbsp;a&nbsp;pre-defined&nbsp;Result&nbsp;for&nbsp;drivers&nbsp;to&nbsp;return&nbsp;when&nbsp;a&nbsp;DDL</span><br>
<span class="lineno"></span><span class="comment" id="6258852">//&nbsp;command&nbsp;(such&nbsp;as&nbsp;a&nbsp;CREATE&nbsp;TABLE)&nbsp;succeeds.&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;for&nbsp;both</span><br>
<span class="lineno"></span><span class="comment" id="6258927">//&nbsp;LastInsertId&nbsp;and&nbsp;RowsAffected.</span><br>
<span class="lineno"></span><span class="keyword" id="6258961">var</span>&nbsp;<span class="ident" id="6258965">ResultNoRows</span>&nbsp;<span class="ident" id="6258978">noRows</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="6258986">type</span>&nbsp;<span class="ident" id="6258991">noRows</span>&nbsp;<span class="keyword" id="6258998">struct</span><span class="op" id="6259004">{</span><span class="op" id="6259005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6259008">var</span>&nbsp;<span class="ident" id="6259012">_</span>&nbsp;<span class="ident" id="6259014">Result</span>&nbsp;<span class="op" id="6259021">=</span>&nbsp;<span class="ident" id="6259023">noRows</span><span class="op" id="6259029">{</span><span class="op" id="6259030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="keyword" id="6259033">func</span>&nbsp;<span class="op" id="6259038">(</span><span class="ident" id="6259039">noRows</span><span class="op" id="6259045">)</span>&nbsp;<span class="ident" id="6259047">LastInsertId</span><span class="op" id="6259059">(</span><span class="op" id="6259060">)</span>&nbsp;<span class="op" id="6259062">(</span><span class="ident" id="6259063">int64</span><span class="op" id="6259068">,</span>&nbsp;<span class="builtintype" id="6259070">error</span><span class="op" id="6259075">)</span>&nbsp;<span class="op" id="6259077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6259080">return</span>&nbsp;<span class="num" id="6259087">0</span><span class="op" id="6259088">,</span>&nbsp;<span class="ident" id="6259090">errors</span><span class="op" id="6259096">.</span><span class="ident" id="6259097">New</span><span class="op" id="6259100">(</span><span class="string" id="6259101">&#34;no&nbsp;LastInsertId&nbsp;available&nbsp;after&nbsp;DDL&nbsp;statement&#34;</span><span class="op" id="6259148">)</span><br>
<span class="lineno"></span><span class="op" id="6259150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6259153">func</span>&nbsp;<span class="op" id="6259158">(</span><span class="ident" id="6259159">noRows</span><span class="op" id="6259165">)</span>&nbsp;<span class="ident" id="6259167">RowsAffected</span><span class="op" id="6259179">(</span><span class="op" id="6259180">)</span>&nbsp;<span class="op" id="6259182">(</span><span class="ident" id="6259183">int64</span><span class="op" id="6259188">,</span>&nbsp;<span class="builtintype" id="6259190">error</span><span class="op" id="6259195">)</span>&nbsp;<span class="op" id="6259197">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6259200">return</span>&nbsp;<span class="num" id="6259207">0</span><span class="op" id="6259208">,</span>&nbsp;<span class="ident" id="6259210">errors</span><span class="op" id="6259216">.</span><span class="ident" id="6259217">New</span><span class="op" id="6259220">(</span><span class="string" id="6259221">&#34;no&nbsp;RowsAffected&nbsp;available&nbsp;after&nbsp;DDL&nbsp;statement&#34;</span><span class="op" id="6259268">)</span><br>
<span class="lineno"></span><span class="op" id="6259270">}</span>
</div>
</body>
</html>
