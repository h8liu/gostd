<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>archive/zip</h2>
<ul>
<li><a href="/gostd/archive/zip/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/archive/zip/reader.go.html">reader.go</a></li>
<li><a href="/gostd/archive/zip/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/archive/zip/register.go.html">register.go</a></li>
<li><a href="/gostd/archive/zip/struct.go.html" class="current">struct.go</a></li>
<li><a href="/gostd/archive/zip/writer.go.html">writer.go</a></li>
<li><a href="/gostd/archive/zip/writer_test.go.html">writer_test.go</a></li>
<li><a href="/gostd/archive/zip/zip_test.go.html">zip_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6044056">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6044111">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6044165">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6044216">/*<br>
<span class="lineno"></span>Package&nbsp;zip&nbsp;provides&nbsp;support&nbsp;for&nbsp;reading&nbsp;and&nbsp;writing&nbsp;ZIP&nbsp;archives.<br>
<span class="lineno"></span><br>
<span class="lineno"></span>See:&nbsp;http://www.pkware.com/documents/casestudies/APPNOTE.TXT<br>
<span class="lineno"></span><br>
<span class="lineno">10</span>This&nbsp;package&nbsp;does&nbsp;not&nbsp;support&nbsp;disk&nbsp;spanning.<br>
<span class="lineno"></span><br>
<span class="lineno"></span>A&nbsp;note&nbsp;about&nbsp;ZIP64:<br>
<span class="lineno"></span><br>
<span class="lineno"></span>To&nbsp;be&nbsp;backwards&nbsp;compatible&nbsp;the&nbsp;FileHeader&nbsp;has&nbsp;both&nbsp;32&nbsp;and&nbsp;64&nbsp;bit&nbsp;Size<br>
<span class="lineno">15</span>fields.&nbsp;The&nbsp;64&nbsp;bit&nbsp;fields&nbsp;will&nbsp;always&nbsp;contain&nbsp;the&nbsp;correct&nbsp;value&nbsp;and<br>
<span class="lineno"></span>for&nbsp;normal&nbsp;archives&nbsp;both&nbsp;fields&nbsp;will&nbsp;be&nbsp;the&nbsp;same.&nbsp;For&nbsp;files&nbsp;requiring<br>
<span class="lineno"></span>the&nbsp;ZIP64&nbsp;format&nbsp;the&nbsp;32&nbsp;bit&nbsp;fields&nbsp;will&nbsp;be&nbsp;0xffffffff&nbsp;and&nbsp;the&nbsp;64&nbsp;bit<br>
<span class="lineno"></span>fields&nbsp;must&nbsp;be&nbsp;used&nbsp;instead.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">20</span><span class="keyword" id="6044725">package</span>&nbsp;<span class="ident" id="6044733">zip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6044738">import</span>&nbsp;<span class="op" id="6044745">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6044748">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6044754">&#34;path&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6044762">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6044769">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6044772">//&nbsp;Compression&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="6044796">const</span>&nbsp;<span class="op" id="6044802">(</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6044805">Store</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6044813">uint16</span>&nbsp;<span class="op" id="6044820">=</span>&nbsp;<span class="num" id="6044822">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6044825">Deflate</span>&nbsp;<span class="builtintype" id="6044833">uint16</span>&nbsp;<span class="op" id="6044840">=</span>&nbsp;<span class="num" id="6044842">8</span><br>
<span class="lineno"></span><span class="op" id="6044844">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6044847">const</span>&nbsp;<span class="op" id="6044853">(</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6044856">fileHeaderSignature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6044881">=</span>&nbsp;<span class="num" id="6044883">0x04034b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6044895">directoryHeaderSignature</span>&nbsp;<span class="op" id="6044920">=</span>&nbsp;<span class="num" id="6044922">0x02014b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6044934">directoryEndSignature</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6044959">=</span>&nbsp;<span class="num" id="6044961">0x06054b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6044973">directory64LocSignature</span>&nbsp;&nbsp;<span class="op" id="6044998">=</span>&nbsp;<span class="num" id="6045000">0x07064b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6045012">directory64EndSignature</span>&nbsp;&nbsp;<span class="op" id="6045037">=</span>&nbsp;<span class="num" id="6045039">0x06064b50</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6045051">dataDescriptorSignature</span>&nbsp;&nbsp;<span class="op" id="6045076">=</span>&nbsp;<span class="num" id="6045078">0x08074b50</span>&nbsp;<span class="comment" id="6045089">//&nbsp;de-facto&nbsp;standard;&nbsp;required&nbsp;by&nbsp;OS&nbsp;X&nbsp;Finder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6045136">fileHeaderLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6045161">=</span>&nbsp;<span class="num" id="6045163">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6045174">//&nbsp;+&nbsp;filename&nbsp;+&nbsp;extra</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6045197">directoryHeaderLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6045222">=</span>&nbsp;<span class="num" id="6045224">46</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6045235">//&nbsp;+&nbsp;filename&nbsp;+&nbsp;extra&nbsp;+&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6045268">directoryEndLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6045293">=</span>&nbsp;<span class="num" id="6045295">22</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6045306">//&nbsp;+&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6045320">dataDescriptorLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6045345">=</span>&nbsp;<span class="num" id="6045347">16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6045358">//&nbsp;four&nbsp;uint32:&nbsp;descriptor&nbsp;signature,&nbsp;crc32,&nbsp;compressed&nbsp;size,&nbsp;size</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6045426">dataDescriptor64Len</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6045451">=</span>&nbsp;<span class="num" id="6045453">24</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6045464">//&nbsp;descriptor&nbsp;with&nbsp;8&nbsp;byte&nbsp;sizes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6045497">directory64LocLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6045522">=</span>&nbsp;<span class="num" id="6045524">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6045535">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6045539">directory64EndLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6045564">=</span>&nbsp;<span class="num" id="6045566">56</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6045577">//&nbsp;+&nbsp;extra</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6045590">//&nbsp;Constants&nbsp;for&nbsp;the&nbsp;first&nbsp;byte&nbsp;in&nbsp;CreatorVersion</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6045641">creatorFAT</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6045655">=</span>&nbsp;<span class="num" id="6045657">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6045660">creatorUnix</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6045674">=</span>&nbsp;<span class="num" id="6045676">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6045679">creatorNTFS</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6045693">=</span>&nbsp;<span class="num" id="6045695">11</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6045699">creatorVFAT</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6045713">=</span>&nbsp;<span class="num" id="6045715">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6045719">creatorMacOSX</span>&nbsp;<span class="op" id="6045733">=</span>&nbsp;<span class="num" id="6045735">19</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6045740">//&nbsp;version&nbsp;numbers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6045760">zipVersion20</span>&nbsp;<span class="op" id="6045773">=</span>&nbsp;<span class="num" id="6045775">20</span>&nbsp;<span class="comment" id="6045778">//&nbsp;2.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6045786">zipVersion45</span>&nbsp;<span class="op" id="6045799">=</span>&nbsp;<span class="num" id="6045801">45</span>&nbsp;<span class="comment" id="6045804">//&nbsp;4.5&nbsp;(reads&nbsp;and&nbsp;writes&nbsp;zip64&nbsp;archives)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6045847">//&nbsp;limits&nbsp;for&nbsp;non&nbsp;zip64&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6045878">uint16max</span>&nbsp;<span class="op" id="6045888">=</span>&nbsp;<span class="op" id="6045890">(</span><span class="num" id="6045891">1</span>&nbsp;<span class="op" id="6045893">&lt;&lt;</span>&nbsp;<span class="num" id="6045896">16</span><span class="op" id="6045898">)</span>&nbsp;<span class="op" id="6045900">-</span>&nbsp;<span class="num" id="6045902">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6045905">uint32max</span>&nbsp;<span class="op" id="6045915">=</span>&nbsp;<span class="op" id="6045917">(</span><span class="num" id="6045918">1</span>&nbsp;<span class="op" id="6045920">&lt;&lt;</span>&nbsp;<span class="num" id="6045923">32</span><span class="op" id="6045925">)</span>&nbsp;<span class="op" id="6045927">-</span>&nbsp;<span class="num" id="6045929">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6045933">//&nbsp;extra&nbsp;header&nbsp;id&#39;s</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6045955">zip64ExtraId</span>&nbsp;<span class="op" id="6045968">=</span>&nbsp;<span class="num" id="6045970">0x0001</span>&nbsp;<span class="comment" id="6045977">//&nbsp;zip64&nbsp;Extended&nbsp;Information&nbsp;Extra&nbsp;Field</span><br>
<span class="lineno"></span><span class="op" id="6046019">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6046022">//&nbsp;FileHeader&nbsp;describes&nbsp;a&nbsp;file&nbsp;within&nbsp;a&nbsp;zip&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="6046072">//&nbsp;See&nbsp;the&nbsp;zip&nbsp;spec&nbsp;for&nbsp;details.</span><br>
<span class="lineno">70</span><span class="keyword" id="6046105">type</span>&nbsp;<span class="ident" id="6046110">FileHeader</span>&nbsp;<span class="keyword" id="6046121">struct</span>&nbsp;<span class="op" id="6046128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6046131">//&nbsp;Name&nbsp;is&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6046165">//&nbsp;It&nbsp;must&nbsp;be&nbsp;a&nbsp;relative&nbsp;path:&nbsp;it&nbsp;must&nbsp;not&nbsp;start&nbsp;with&nbsp;a&nbsp;drive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6046228">//&nbsp;letter&nbsp;(e.g.&nbsp;C:)&nbsp;or&nbsp;leading&nbsp;slash,&nbsp;and&nbsp;only&nbsp;forward&nbsp;slashes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6046292">//&nbsp;are&nbsp;allowed.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6046309">Name</span>&nbsp;<span class="builtintype" id="6046314">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6046323">CreatorVersion</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6046342">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6046350">ReaderVersion</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6046369">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6046377">Flags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6046396">uint16</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6046404">Method</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6046423">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6046431">ModifiedTime</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6046450">uint16</span>&nbsp;<span class="comment" id="6046457">//&nbsp;MS-DOS&nbsp;time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6046473">ModifiedDate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6046492">uint16</span>&nbsp;<span class="comment" id="6046499">//&nbsp;MS-DOS&nbsp;date</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6046515">CRC32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6046534">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6046542">CompressedSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6046561">uint32</span>&nbsp;<span class="comment" id="6046568">//&nbsp;deprecated;&nbsp;use&nbsp;CompressedSize64</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6046605">UncompressedSize</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6046624">uint32</span>&nbsp;<span class="comment" id="6046631">//&nbsp;deprecated;&nbsp;use&nbsp;UncompressedSize64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6046670">CompressedSize64</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6046689">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6046697">UncompressedSize64</span>&nbsp;<span class="ident" id="6046716">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6046724">Extra</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6046743">[</span><span class="op" id="6046744">]</span><span class="builtintype" id="6046745">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6046751">ExternalAttrs</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6046770">uint32</span>&nbsp;<span class="comment" id="6046777">//&nbsp;Meaning&nbsp;depends&nbsp;on&nbsp;CreatorVersion</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6046815">Comment</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6046834">string</span><br>
<span class="lineno"></span><span class="op" id="6046841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6046844">//&nbsp;FileInfo&nbsp;returns&nbsp;an&nbsp;os.FileInfo&nbsp;for&nbsp;the&nbsp;FileHeader.</span><br>
<span class="lineno"></span><span class="keyword" id="6046899">func</span>&nbsp;<span class="op" id="6046904">(</span><span class="ident" id="6046905">h</span>&nbsp;<span class="op" id="6046907">*</span><span class="ident" id="6046908">FileHeader</span><span class="op" id="6046918">)</span>&nbsp;<span class="ident" id="6046920">FileInfo</span><span class="op" id="6046928">(</span><span class="op" id="6046929">)</span>&nbsp;<span class="ident" id="6046931">os</span><span class="op" id="6046933">.</span><span class="ident" id="6046934">FileInfo</span>&nbsp;<span class="op" id="6046943">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6046946">return</span>&nbsp;<span class="ident" id="6046953">headerFileInfo</span><span class="op" id="6046967">{</span><span class="ident" id="6046968">h</span><span class="op" id="6046969">}</span><br>
<span class="lineno"></span><span class="op" id="6046971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6046974">//&nbsp;headerFileInfo&nbsp;implements&nbsp;os.FileInfo.</span><br>
<span class="lineno"></span><span class="keyword" id="6047016">type</span>&nbsp;<span class="ident" id="6047021">headerFileInfo</span>&nbsp;<span class="keyword" id="6047036">struct</span>&nbsp;<span class="op" id="6047043">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6047046">fh</span>&nbsp;<span class="op" id="6047049">*</span><span class="ident" id="6047050">FileHeader</span><br>
<span class="lineno"></span><span class="op" id="6047061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6047064">func</span>&nbsp;<span class="op" id="6047069">(</span><span class="ident" id="6047070">fi</span>&nbsp;<span class="ident" id="6047073">headerFileInfo</span><span class="op" id="6047087">)</span>&nbsp;<span class="ident" id="6047089">Name</span><span class="op" id="6047093">(</span><span class="op" id="6047094">)</span>&nbsp;<span class="builtintype" id="6047096">string</span>&nbsp;<span class="op" id="6047103">{</span>&nbsp;<span class="keyword" id="6047105">return</span>&nbsp;<span class="ident" id="6047112">path</span><span class="op" id="6047116">.</span><span class="ident" id="6047117">Base</span><span class="op" id="6047121">(</span><span class="ident" id="6047122">fi</span><span class="op" id="6047124">.</span><span class="ident" id="6047125">fh</span><span class="op" id="6047127">.</span><span class="ident" id="6047128">Name</span><span class="op" id="6047132">)</span>&nbsp;<span class="op" id="6047134">}</span><br>
<span class="lineno"></span><span class="keyword" id="6047136">func</span>&nbsp;<span class="op" id="6047141">(</span><span class="ident" id="6047142">fi</span>&nbsp;<span class="ident" id="6047145">headerFileInfo</span><span class="op" id="6047159">)</span>&nbsp;<span class="ident" id="6047161">Size</span><span class="op" id="6047165">(</span><span class="op" id="6047166">)</span>&nbsp;<span class="ident" id="6047168">int64</span>&nbsp;<span class="op" id="6047174">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6047177">if</span>&nbsp;<span class="ident" id="6047180">fi</span><span class="op" id="6047182">.</span><span class="ident" id="6047183">fh</span><span class="op" id="6047185">.</span><span class="ident" id="6047186">UncompressedSize64</span>&nbsp;<span class="op" id="6047205">&gt;</span>&nbsp;<span class="num" id="6047207">0</span>&nbsp;<span class="op" id="6047209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6047213">return</span>&nbsp;<span class="ident" id="6047220">int64</span><span class="op" id="6047225">(</span><span class="ident" id="6047226">fi</span><span class="op" id="6047228">.</span><span class="ident" id="6047229">fh</span><span class="op" id="6047231">.</span><span class="ident" id="6047232">UncompressedSize64</span><span class="op" id="6047250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6047253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6047256">return</span>&nbsp;<span class="ident" id="6047263">int64</span><span class="op" id="6047268">(</span><span class="ident" id="6047269">fi</span><span class="op" id="6047271">.</span><span class="ident" id="6047272">fh</span><span class="op" id="6047274">.</span><span class="ident" id="6047275">UncompressedSize</span><span class="op" id="6047291">)</span><br>
<span class="lineno"></span><span class="op" id="6047293">}</span><br>
<span class="lineno">110</span><span class="keyword" id="6047295">func</span>&nbsp;<span class="op" id="6047300">(</span><span class="ident" id="6047301">fi</span>&nbsp;<span class="ident" id="6047304">headerFileInfo</span><span class="op" id="6047318">)</span>&nbsp;<span class="ident" id="6047320">IsDir</span><span class="op" id="6047325">(</span><span class="op" id="6047326">)</span>&nbsp;<span class="builtintype" id="6047328">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6047340">{</span>&nbsp;<span class="keyword" id="6047342">return</span>&nbsp;<span class="ident" id="6047349">fi</span><span class="op" id="6047351">.</span><span class="ident" id="6047352">Mode</span><span class="op" id="6047356">(</span><span class="op" id="6047357">)</span><span class="op" id="6047358">.</span><span class="ident" id="6047359">IsDir</span><span class="op" id="6047364">(</span><span class="op" id="6047365">)</span>&nbsp;<span class="op" id="6047367">}</span><br>
<span class="lineno"></span><span class="keyword" id="6047369">func</span>&nbsp;<span class="op" id="6047374">(</span><span class="ident" id="6047375">fi</span>&nbsp;<span class="ident" id="6047378">headerFileInfo</span><span class="op" id="6047392">)</span>&nbsp;<span class="ident" id="6047394">ModTime</span><span class="op" id="6047401">(</span><span class="op" id="6047402">)</span>&nbsp;<span class="ident" id="6047404">time</span><span class="op" id="6047408">.</span><span class="ident" id="6047409">Time</span>&nbsp;<span class="op" id="6047414">{</span>&nbsp;<span class="keyword" id="6047416">return</span>&nbsp;<span class="ident" id="6047423">fi</span><span class="op" id="6047425">.</span><span class="ident" id="6047426">fh</span><span class="op" id="6047428">.</span><span class="ident" id="6047429">ModTime</span><span class="op" id="6047436">(</span><span class="op" id="6047437">)</span>&nbsp;<span class="op" id="6047439">}</span><br>
<span class="lineno"></span><span class="keyword" id="6047441">func</span>&nbsp;<span class="op" id="6047446">(</span><span class="ident" id="6047447">fi</span>&nbsp;<span class="ident" id="6047450">headerFileInfo</span><span class="op" id="6047464">)</span>&nbsp;<span class="ident" id="6047466">Mode</span><span class="op" id="6047470">(</span><span class="op" id="6047471">)</span>&nbsp;<span class="ident" id="6047473">os</span><span class="op" id="6047475">.</span><span class="ident" id="6047476">FileMode</span>&nbsp;&nbsp;<span class="op" id="6047486">{</span>&nbsp;<span class="keyword" id="6047488">return</span>&nbsp;<span class="ident" id="6047495">fi</span><span class="op" id="6047497">.</span><span class="ident" id="6047498">fh</span><span class="op" id="6047500">.</span><span class="ident" id="6047501">Mode</span><span class="op" id="6047505">(</span><span class="op" id="6047506">)</span>&nbsp;<span class="op" id="6047508">}</span><br>
<span class="lineno"></span><span class="keyword" id="6047510">func</span>&nbsp;<span class="op" id="6047515">(</span><span class="ident" id="6047516">fi</span>&nbsp;<span class="ident" id="6047519">headerFileInfo</span><span class="op" id="6047533">)</span>&nbsp;<span class="ident" id="6047535">Sys</span><span class="op" id="6047538">(</span><span class="op" id="6047539">)</span>&nbsp;<span class="keyword" id="6047541">interface</span><span class="op" id="6047550">{</span><span class="op" id="6047551">}</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6047555">{</span>&nbsp;<span class="keyword" id="6047557">return</span>&nbsp;<span class="ident" id="6047564">fi</span><span class="op" id="6047566">.</span><span class="ident" id="6047567">fh</span>&nbsp;<span class="op" id="6047570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="comment" id="6047573">//&nbsp;FileInfoHeader&nbsp;creates&nbsp;a&nbsp;partially-populated&nbsp;FileHeader&nbsp;from&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="6047640">//&nbsp;os.FileInfo.</span><br>
<span class="lineno"></span><span class="comment" id="6047656">//&nbsp;Because&nbsp;os.FileInfo&#39;s&nbsp;Name&nbsp;method&nbsp;returns&nbsp;only&nbsp;the&nbsp;base&nbsp;name&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="6047723">//&nbsp;the&nbsp;file&nbsp;it&nbsp;describes,&nbsp;it&nbsp;may&nbsp;be&nbsp;necessary&nbsp;to&nbsp;modify&nbsp;the&nbsp;Name&nbsp;field</span><br>
<span class="lineno"></span><span class="comment" id="6047794">//&nbsp;of&nbsp;the&nbsp;returned&nbsp;header&nbsp;to&nbsp;provide&nbsp;the&nbsp;full&nbsp;path&nbsp;name&nbsp;of&nbsp;the&nbsp;file.</span><br>
<span class="lineno">120</span><span class="keyword" id="6047863">func</span>&nbsp;<span class="ident" id="6047868">FileInfoHeader</span><span class="op" id="6047882">(</span><span class="ident" id="6047883">fi</span>&nbsp;<span class="ident" id="6047886">os</span><span class="op" id="6047888">.</span><span class="ident" id="6047889">FileInfo</span><span class="op" id="6047897">)</span>&nbsp;<span class="op" id="6047899">(</span><span class="op" id="6047900">*</span><span class="ident" id="6047901">FileHeader</span><span class="op" id="6047911">,</span>&nbsp;<span class="builtintype" id="6047913">error</span><span class="op" id="6047918">)</span>&nbsp;<span class="op" id="6047920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6047923">size</span>&nbsp;<span class="op" id="6047928">:=</span>&nbsp;<span class="ident" id="6047931">fi</span><span class="op" id="6047933">.</span><span class="ident" id="6047934">Size</span><span class="op" id="6047938">(</span><span class="op" id="6047939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6047942">fh</span>&nbsp;<span class="op" id="6047945">:=</span>&nbsp;<span class="op" id="6047948">&amp;</span><span class="ident" id="6047949">FileHeader</span><span class="op" id="6047959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6047963">Name</span><span class="op" id="6047967">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6047983">fi</span><span class="op" id="6047985">.</span><span class="ident" id="6047986">Name</span><span class="op" id="6047990">(</span><span class="op" id="6047991">)</span><span class="op" id="6047992">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6047996">UncompressedSize64</span><span class="op" id="6048014">:</span>&nbsp;<span class="ident" id="6048016">uint64</span><span class="op" id="6048022">(</span><span class="ident" id="6048023">size</span><span class="op" id="6048027">)</span><span class="op" id="6048028">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6048031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6048034">fh</span><span class="op" id="6048036">.</span><span class="ident" id="6048037">SetModTime</span><span class="op" id="6048047">(</span><span class="ident" id="6048048">fi</span><span class="op" id="6048050">.</span><span class="ident" id="6048051">ModTime</span><span class="op" id="6048058">(</span><span class="op" id="6048059">)</span><span class="op" id="6048060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6048063">fh</span><span class="op" id="6048065">.</span><span class="ident" id="6048066">SetMode</span><span class="op" id="6048073">(</span><span class="ident" id="6048074">fi</span><span class="op" id="6048076">.</span><span class="ident" id="6048077">Mode</span><span class="op" id="6048081">(</span><span class="op" id="6048082">)</span><span class="op" id="6048083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6048086">if</span>&nbsp;<span class="ident" id="6048089">fh</span><span class="op" id="6048091">.</span><span class="ident" id="6048092">UncompressedSize64</span>&nbsp;<span class="op" id="6048111">&gt;</span>&nbsp;<span class="ident" id="6048113">uint32max</span>&nbsp;<span class="op" id="6048123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6048127">fh</span><span class="op" id="6048129">.</span><span class="ident" id="6048130">UncompressedSize</span>&nbsp;<span class="op" id="6048147">=</span>&nbsp;<span class="ident" id="6048149">uint32max</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6048160">}</span>&nbsp;<span class="keyword" id="6048162">else</span>&nbsp;<span class="op" id="6048167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6048171">fh</span><span class="op" id="6048173">.</span><span class="ident" id="6048174">UncompressedSize</span>&nbsp;<span class="op" id="6048191">=</span>&nbsp;<span class="builtintype" id="6048193">uint32</span><span class="op" id="6048199">(</span><span class="ident" id="6048200">fh</span><span class="op" id="6048202">.</span><span class="ident" id="6048203">UncompressedSize64</span><span class="op" id="6048221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6048224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6048227">return</span>&nbsp;<span class="ident" id="6048234">fh</span><span class="op" id="6048236">,</span>&nbsp;<span class="builtintype" id="6048238">nil</span><br>
<span class="lineno"></span><span class="op" id="6048242">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="keyword" id="6048245">type</span>&nbsp;<span class="ident" id="6048250">directoryEnd</span>&nbsp;<span class="keyword" id="6048263">struct</span>&nbsp;<span class="op" id="6048270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6048273">diskNbr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6048292">uint32</span>&nbsp;<span class="comment" id="6048299">//&nbsp;unused</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6048310">dirDiskNbr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6048329">uint32</span>&nbsp;<span class="comment" id="6048336">//&nbsp;unused</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6048347">dirRecordsThisDisk</span>&nbsp;<span class="ident" id="6048366">uint64</span>&nbsp;<span class="comment" id="6048373">//&nbsp;unused</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6048384">directoryRecords</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6048403">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6048411">directorySize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6048430">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6048438">directoryOffset</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6048457">uint64</span>&nbsp;<span class="comment" id="6048464">//&nbsp;relative&nbsp;to&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6048485">commentLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6048504">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6048512">comment</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6048531">string</span><br>
<span class="lineno">145</span><span class="op" id="6048538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6048541">//&nbsp;msDosTimeToTime&nbsp;converts&nbsp;an&nbsp;MS-DOS&nbsp;date&nbsp;and&nbsp;time&nbsp;into&nbsp;a&nbsp;time.Time.</span><br>
<span class="lineno"></span><span class="comment" id="6048611">//&nbsp;The&nbsp;resolution&nbsp;is&nbsp;2s.</span><br>
<span class="lineno"></span><span class="comment" id="6048636">//&nbsp;See:&nbsp;http://msdn.microsoft.com/en-us/library/ms724247(v=VS.85).aspx</span><br>
<span class="lineno">150</span><span class="keyword" id="6048707">func</span>&nbsp;<span class="ident" id="6048712">msDosTimeToTime</span><span class="op" id="6048727">(</span><span class="ident" id="6048728">dosDate</span><span class="op" id="6048735">,</span>&nbsp;<span class="ident" id="6048737">dosTime</span>&nbsp;<span class="builtintype" id="6048745">uint16</span><span class="op" id="6048751">)</span>&nbsp;<span class="ident" id="6048753">time</span><span class="op" id="6048757">.</span><span class="ident" id="6048758">Time</span>&nbsp;<span class="op" id="6048763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6048766">return</span>&nbsp;<span class="ident" id="6048773">time</span><span class="op" id="6048777">.</span><span class="ident" id="6048778">Date</span><span class="op" id="6048782">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6048786">//&nbsp;date&nbsp;bits&nbsp;0-4:&nbsp;day&nbsp;of&nbsp;month;&nbsp;5-8:&nbsp;month;&nbsp;9-15:&nbsp;years&nbsp;since&nbsp;1980</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6048855">int</span><span class="op" id="6048858">(</span><span class="ident" id="6048859">dosDate</span><span class="op" id="6048866">&gt;&gt;</span><span class="num" id="6048868">9</span><span class="op" id="6048869">+</span><span class="num" id="6048870">1980</span><span class="op" id="6048874">)</span><span class="op" id="6048875">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6048879">time</span><span class="op" id="6048883">.</span><span class="ident" id="6048884">Month</span><span class="op" id="6048889">(</span><span class="ident" id="6048890">dosDate</span><span class="op" id="6048897">&gt;&gt;</span><span class="num" id="6048899">5</span><span class="op" id="6048900">&amp;</span><span class="num" id="6048901">0xf</span><span class="op" id="6048904">)</span><span class="op" id="6048905">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6048909">int</span><span class="op" id="6048912">(</span><span class="ident" id="6048913">dosDate</span><span class="op" id="6048920">&amp;</span><span class="num" id="6048921">0x1f</span><span class="op" id="6048925">)</span><span class="op" id="6048926">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6048931">//&nbsp;time&nbsp;bits&nbsp;0-4:&nbsp;second/2;&nbsp;5-10:&nbsp;minute;&nbsp;11-15:&nbsp;hour</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6048987">int</span><span class="op" id="6048990">(</span><span class="ident" id="6048991">dosTime</span><span class="op" id="6048998">&gt;&gt;</span><span class="num" id="6049000">11</span><span class="op" id="6049002">)</span><span class="op" id="6049003">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6049007">int</span><span class="op" id="6049010">(</span><span class="ident" id="6049011">dosTime</span><span class="op" id="6049018">&gt;&gt;</span><span class="num" id="6049020">5</span><span class="op" id="6049021">&amp;</span><span class="num" id="6049022">0x3f</span><span class="op" id="6049026">)</span><span class="op" id="6049027">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6049031">int</span><span class="op" id="6049034">(</span><span class="ident" id="6049035">dosTime</span><span class="op" id="6049042">&amp;</span><span class="num" id="6049043">0x1f</span><span class="op" id="6049047">*</span><span class="num" id="6049048">2</span><span class="op" id="6049049">)</span><span class="op" id="6049050">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6049054">0</span><span class="op" id="6049055">,</span>&nbsp;<span class="comment" id="6049057">//&nbsp;nanoseconds</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6049075">time</span><span class="op" id="6049079">.</span><span class="ident" id="6049080">UTC</span><span class="op" id="6049083">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6049086">)</span><br>
<span class="lineno">165</span><span class="op" id="6049088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6049091">//&nbsp;timeToMsDosTime&nbsp;converts&nbsp;a&nbsp;time.Time&nbsp;to&nbsp;an&nbsp;MS-DOS&nbsp;date&nbsp;and&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="6049159">//&nbsp;The&nbsp;resolution&nbsp;is&nbsp;2s.</span><br>
<span class="lineno"></span><span class="comment" id="6049184">//&nbsp;See:&nbsp;http://msdn.microsoft.com/en-us/library/ms724274(v=VS.85).aspx</span><br>
<span class="lineno">170</span><span class="keyword" id="6049255">func</span>&nbsp;<span class="ident" id="6049260">timeToMsDosTime</span><span class="op" id="6049275">(</span><span class="ident" id="6049276">t</span>&nbsp;<span class="ident" id="6049278">time</span><span class="op" id="6049282">.</span><span class="ident" id="6049283">Time</span><span class="op" id="6049287">)</span>&nbsp;<span class="op" id="6049289">(</span><span class="ident" id="6049290">fDate</span>&nbsp;<span class="builtintype" id="6049296">uint16</span><span class="op" id="6049302">,</span>&nbsp;<span class="ident" id="6049304">fTime</span>&nbsp;<span class="builtintype" id="6049310">uint16</span><span class="op" id="6049316">)</span>&nbsp;<span class="op" id="6049318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6049321">t</span>&nbsp;<span class="op" id="6049323">=</span>&nbsp;<span class="ident" id="6049325">t</span><span class="op" id="6049326">.</span><span class="ident" id="6049327">In</span><span class="op" id="6049329">(</span><span class="ident" id="6049330">time</span><span class="op" id="6049334">.</span><span class="ident" id="6049335">UTC</span><span class="op" id="6049338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6049341">fDate</span>&nbsp;<span class="op" id="6049347">=</span>&nbsp;<span class="builtintype" id="6049349">uint16</span><span class="op" id="6049355">(</span><span class="ident" id="6049356">t</span><span class="op" id="6049357">.</span><span class="ident" id="6049358">Day</span><span class="op" id="6049361">(</span><span class="op" id="6049362">)</span>&nbsp;<span class="op" id="6049364">+</span>&nbsp;<span class="builtintype" id="6049366">int</span><span class="op" id="6049369">(</span><span class="ident" id="6049370">t</span><span class="op" id="6049371">.</span><span class="ident" id="6049372">Month</span><span class="op" id="6049377">(</span><span class="op" id="6049378">)</span><span class="op" id="6049379">)</span><span class="op" id="6049380">&lt;&lt;</span><span class="num" id="6049382">5</span>&nbsp;<span class="op" id="6049384">+</span>&nbsp;<span class="op" id="6049386">(</span><span class="ident" id="6049387">t</span><span class="op" id="6049388">.</span><span class="ident" id="6049389">Year</span><span class="op" id="6049393">(</span><span class="op" id="6049394">)</span><span class="op" id="6049395">-</span><span class="num" id="6049396">1980</span><span class="op" id="6049400">)</span><span class="op" id="6049401">&lt;&lt;</span><span class="num" id="6049403">9</span><span class="op" id="6049404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6049407">fTime</span>&nbsp;<span class="op" id="6049413">=</span>&nbsp;<span class="builtintype" id="6049415">uint16</span><span class="op" id="6049421">(</span><span class="ident" id="6049422">t</span><span class="op" id="6049423">.</span><span class="ident" id="6049424">Second</span><span class="op" id="6049430">(</span><span class="op" id="6049431">)</span><span class="op" id="6049432">/</span><span class="num" id="6049433">2</span>&nbsp;<span class="op" id="6049435">+</span>&nbsp;<span class="ident" id="6049437">t</span><span class="op" id="6049438">.</span><span class="ident" id="6049439">Minute</span><span class="op" id="6049445">(</span><span class="op" id="6049446">)</span><span class="op" id="6049447">&lt;&lt;</span><span class="num" id="6049449">5</span>&nbsp;<span class="op" id="6049451">+</span>&nbsp;<span class="ident" id="6049453">t</span><span class="op" id="6049454">.</span><span class="ident" id="6049455">Hour</span><span class="op" id="6049459">(</span><span class="op" id="6049460">)</span><span class="op" id="6049461">&lt;&lt;</span><span class="num" id="6049463">11</span><span class="op" id="6049465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6049468">return</span><br>
<span class="lineno">175</span><span class="op" id="6049475">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6049478">//&nbsp;ModTime&nbsp;returns&nbsp;the&nbsp;modification&nbsp;time&nbsp;in&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="6049527">//&nbsp;The&nbsp;resolution&nbsp;is&nbsp;2s.</span><br>
<span class="lineno"></span><span class="keyword" id="6049552">func</span>&nbsp;<span class="op" id="6049557">(</span><span class="ident" id="6049558">h</span>&nbsp;<span class="op" id="6049560">*</span><span class="ident" id="6049561">FileHeader</span><span class="op" id="6049571">)</span>&nbsp;<span class="ident" id="6049573">ModTime</span><span class="op" id="6049580">(</span><span class="op" id="6049581">)</span>&nbsp;<span class="ident" id="6049583">time</span><span class="op" id="6049587">.</span><span class="ident" id="6049588">Time</span>&nbsp;<span class="op" id="6049593">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6049596">return</span>&nbsp;<span class="ident" id="6049603">msDosTimeToTime</span><span class="op" id="6049618">(</span><span class="ident" id="6049619">h</span><span class="op" id="6049620">.</span><span class="ident" id="6049621">ModifiedDate</span><span class="op" id="6049633">,</span>&nbsp;<span class="ident" id="6049635">h</span><span class="op" id="6049636">.</span><span class="ident" id="6049637">ModifiedTime</span><span class="op" id="6049649">)</span><br>
<span class="lineno"></span><span class="op" id="6049651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6049654">//&nbsp;SetModTime&nbsp;sets&nbsp;the&nbsp;ModifiedTime&nbsp;and&nbsp;ModifiedDate&nbsp;fields&nbsp;to&nbsp;the&nbsp;given&nbsp;time&nbsp;in&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="6049740">//&nbsp;The&nbsp;resolution&nbsp;is&nbsp;2s.</span><br>
<span class="lineno">185</span><span class="keyword" id="6049765">func</span>&nbsp;<span class="op" id="6049770">(</span><span class="ident" id="6049771">h</span>&nbsp;<span class="op" id="6049773">*</span><span class="ident" id="6049774">FileHeader</span><span class="op" id="6049784">)</span>&nbsp;<span class="ident" id="6049786">SetModTime</span><span class="op" id="6049796">(</span><span class="ident" id="6049797">t</span>&nbsp;<span class="ident" id="6049799">time</span><span class="op" id="6049803">.</span><span class="ident" id="6049804">Time</span><span class="op" id="6049808">)</span>&nbsp;<span class="op" id="6049810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6049813">h</span><span class="op" id="6049814">.</span><span class="ident" id="6049815">ModifiedDate</span><span class="op" id="6049827">,</span>&nbsp;<span class="ident" id="6049829">h</span><span class="op" id="6049830">.</span><span class="ident" id="6049831">ModifiedTime</span>&nbsp;<span class="op" id="6049844">=</span>&nbsp;<span class="ident" id="6049846">timeToMsDosTime</span><span class="op" id="6049861">(</span><span class="ident" id="6049862">t</span><span class="op" id="6049863">)</span><br>
<span class="lineno"></span><span class="op" id="6049865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6049868">const</span>&nbsp;<span class="op" id="6049874">(</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6049877">//&nbsp;Unix&nbsp;constants.&nbsp;The&nbsp;specification&nbsp;doesn&#39;t&nbsp;mention&nbsp;them,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6049937">//&nbsp;but&nbsp;these&nbsp;seem&nbsp;to&nbsp;be&nbsp;the&nbsp;values&nbsp;agreed&nbsp;on&nbsp;by&nbsp;tools.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6049993">s_IFMT</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6050002">=</span>&nbsp;<span class="num" id="6050004">0xf000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6050012">s_IFSOCK</span>&nbsp;<span class="op" id="6050021">=</span>&nbsp;<span class="num" id="6050023">0xc000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6050031">s_IFLNK</span>&nbsp;&nbsp;<span class="op" id="6050040">=</span>&nbsp;<span class="num" id="6050042">0xa000</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6050050">s_IFREG</span>&nbsp;&nbsp;<span class="op" id="6050059">=</span>&nbsp;<span class="num" id="6050061">0x8000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6050069">s_IFBLK</span>&nbsp;&nbsp;<span class="op" id="6050078">=</span>&nbsp;<span class="num" id="6050080">0x6000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6050088">s_IFDIR</span>&nbsp;&nbsp;<span class="op" id="6050097">=</span>&nbsp;<span class="num" id="6050099">0x4000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6050107">s_IFCHR</span>&nbsp;&nbsp;<span class="op" id="6050116">=</span>&nbsp;<span class="num" id="6050118">0x2000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6050126">s_IFIFO</span>&nbsp;&nbsp;<span class="op" id="6050135">=</span>&nbsp;<span class="num" id="6050137">0x1000</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6050145">s_ISUID</span>&nbsp;&nbsp;<span class="op" id="6050154">=</span>&nbsp;<span class="num" id="6050156">0x800</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6050163">s_ISGID</span>&nbsp;&nbsp;<span class="op" id="6050172">=</span>&nbsp;<span class="num" id="6050174">0x400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6050181">s_ISVTX</span>&nbsp;&nbsp;<span class="op" id="6050190">=</span>&nbsp;<span class="num" id="6050192">0x200</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6050200">msdosDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6050214">=</span>&nbsp;<span class="num" id="6050216">0x10</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6050222">msdosReadOnly</span>&nbsp;<span class="op" id="6050236">=</span>&nbsp;<span class="num" id="6050238">0x01</span><br>
<span class="lineno"></span><span class="op" id="6050243">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6050246">//&nbsp;Mode&nbsp;returns&nbsp;the&nbsp;permission&nbsp;and&nbsp;mode&nbsp;bits&nbsp;for&nbsp;the&nbsp;FileHeader.</span><br>
<span class="lineno"></span><span class="keyword" id="6050311">func</span>&nbsp;<span class="op" id="6050316">(</span><span class="ident" id="6050317">h</span>&nbsp;<span class="op" id="6050319">*</span><span class="ident" id="6050320">FileHeader</span><span class="op" id="6050330">)</span>&nbsp;<span class="ident" id="6050332">Mode</span><span class="op" id="6050336">(</span><span class="op" id="6050337">)</span>&nbsp;<span class="op" id="6050339">(</span><span class="ident" id="6050340">mode</span>&nbsp;<span class="ident" id="6050345">os</span><span class="op" id="6050347">.</span><span class="ident" id="6050348">FileMode</span><span class="op" id="6050356">)</span>&nbsp;<span class="op" id="6050358">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6050361">switch</span>&nbsp;<span class="ident" id="6050368">h</span><span class="op" id="6050369">.</span><span class="ident" id="6050370">CreatorVersion</span>&nbsp;<span class="op" id="6050385">&gt;&gt;</span>&nbsp;<span class="num" id="6050388">8</span>&nbsp;<span class="op" id="6050390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6050393">case</span>&nbsp;<span class="ident" id="6050398">creatorUnix</span><span class="op" id="6050409">,</span>&nbsp;<span class="ident" id="6050411">creatorMacOSX</span><span class="op" id="6050424">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6050428">mode</span>&nbsp;<span class="op" id="6050433">=</span>&nbsp;<span class="ident" id="6050435">unixModeToFileMode</span><span class="op" id="6050453">(</span><span class="ident" id="6050454">h</span><span class="op" id="6050455">.</span><span class="ident" id="6050456">ExternalAttrs</span>&nbsp;<span class="op" id="6050470">&gt;&gt;</span>&nbsp;<span class="num" id="6050473">16</span><span class="op" id="6050475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6050478">case</span>&nbsp;<span class="ident" id="6050483">creatorNTFS</span><span class="op" id="6050494">,</span>&nbsp;<span class="ident" id="6050496">creatorVFAT</span><span class="op" id="6050507">,</span>&nbsp;<span class="ident" id="6050509">creatorFAT</span><span class="op" id="6050519">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6050523">mode</span>&nbsp;<span class="op" id="6050528">=</span>&nbsp;<span class="ident" id="6050530">msdosModeToFileMode</span><span class="op" id="6050549">(</span><span class="ident" id="6050550">h</span><span class="op" id="6050551">.</span><span class="ident" id="6050552">ExternalAttrs</span><span class="op" id="6050565">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6050568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6050571">if</span>&nbsp;<span class="builtinfunc" id="6050574">len</span><span class="op" id="6050577">(</span><span class="ident" id="6050578">h</span><span class="op" id="6050579">.</span><span class="ident" id="6050580">Name</span><span class="op" id="6050584">)</span>&nbsp;<span class="op" id="6050586">&gt;</span>&nbsp;<span class="num" id="6050588">0</span>&nbsp;<span class="op" id="6050590">&amp;&amp;</span>&nbsp;<span class="ident" id="6050593">h</span><span class="op" id="6050594">.</span><span class="ident" id="6050595">Name</span><span class="op" id="6050599">[</span><span class="builtinfunc" id="6050600">len</span><span class="op" id="6050603">(</span><span class="ident" id="6050604">h</span><span class="op" id="6050605">.</span><span class="ident" id="6050606">Name</span><span class="op" id="6050610">)</span><span class="op" id="6050611">-</span><span class="num" id="6050612">1</span><span class="op" id="6050613">]</span>&nbsp;<span class="op" id="6050615">==</span>&nbsp;<span class="string" id="6050618">&#39;/&#39;</span>&nbsp;<span class="op" id="6050622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6050626">mode</span>&nbsp;<span class="op" id="6050631">|=</span>&nbsp;<span class="ident" id="6050634">os</span><span class="op" id="6050636">.</span><span class="ident" id="6050637">ModeDir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6050646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6050649">return</span>&nbsp;<span class="ident" id="6050656">mode</span><br>
<span class="lineno">220</span><span class="op" id="6050661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6050664">//&nbsp;SetMode&nbsp;changes&nbsp;the&nbsp;permission&nbsp;and&nbsp;mode&nbsp;bits&nbsp;for&nbsp;the&nbsp;FileHeader.</span><br>
<span class="lineno"></span><span class="keyword" id="6050732">func</span>&nbsp;<span class="op" id="6050737">(</span><span class="ident" id="6050738">h</span>&nbsp;<span class="op" id="6050740">*</span><span class="ident" id="6050741">FileHeader</span><span class="op" id="6050751">)</span>&nbsp;<span class="ident" id="6050753">SetMode</span><span class="op" id="6050760">(</span><span class="ident" id="6050761">mode</span>&nbsp;<span class="ident" id="6050766">os</span><span class="op" id="6050768">.</span><span class="ident" id="6050769">FileMode</span><span class="op" id="6050777">)</span>&nbsp;<span class="op" id="6050779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6050782">h</span><span class="op" id="6050783">.</span><span class="ident" id="6050784">CreatorVersion</span>&nbsp;<span class="op" id="6050799">=</span>&nbsp;<span class="ident" id="6050801">h</span><span class="op" id="6050802">.</span><span class="ident" id="6050803">CreatorVersion</span><span class="op" id="6050817">&amp;</span><span class="num" id="6050818">0xff</span>&nbsp;<span class="op" id="6050823">|</span>&nbsp;<span class="ident" id="6050825">creatorUnix</span><span class="op" id="6050836">&lt;&lt;</span><span class="num" id="6050838">8</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6050841">h</span><span class="op" id="6050842">.</span><span class="ident" id="6050843">ExternalAttrs</span>&nbsp;<span class="op" id="6050857">=</span>&nbsp;<span class="ident" id="6050859">fileModeToUnixMode</span><span class="op" id="6050877">(</span><span class="ident" id="6050878">mode</span><span class="op" id="6050882">)</span>&nbsp;<span class="op" id="6050884">&lt;&lt;</span>&nbsp;<span class="num" id="6050887">16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6050892">//&nbsp;set&nbsp;MSDOS&nbsp;attributes&nbsp;too,&nbsp;as&nbsp;the&nbsp;original&nbsp;zip&nbsp;does.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6050948">if</span>&nbsp;<span class="ident" id="6050951">mode</span><span class="op" id="6050955">&amp;</span><span class="ident" id="6050956">os</span><span class="op" id="6050958">.</span><span class="ident" id="6050959">ModeDir</span>&nbsp;<span class="op" id="6050967">!=</span>&nbsp;<span class="num" id="6050970">0</span>&nbsp;<span class="op" id="6050972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6050976">h</span><span class="op" id="6050977">.</span><span class="ident" id="6050978">ExternalAttrs</span>&nbsp;<span class="op" id="6050992">|=</span>&nbsp;<span class="ident" id="6050995">msdosDir</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6051005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6051008">if</span>&nbsp;<span class="ident" id="6051011">mode</span><span class="op" id="6051015">&amp;</span><span class="num" id="6051016">0200</span>&nbsp;<span class="op" id="6051021">==</span>&nbsp;<span class="num" id="6051024">0</span>&nbsp;<span class="op" id="6051026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6051030">h</span><span class="op" id="6051031">.</span><span class="ident" id="6051032">ExternalAttrs</span>&nbsp;<span class="op" id="6051046">|=</span>&nbsp;<span class="ident" id="6051049">msdosReadOnly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6051064">}</span><br>
<span class="lineno"></span><span class="op" id="6051066">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="comment" id="6051069">//&nbsp;isZip64&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;file&nbsp;size&nbsp;exceeds&nbsp;the&nbsp;32&nbsp;bit&nbsp;limit</span><br>
<span class="lineno"></span><span class="keyword" id="6051135">func</span>&nbsp;<span class="op" id="6051140">(</span><span class="ident" id="6051141">fh</span>&nbsp;<span class="op" id="6051144">*</span><span class="ident" id="6051145">FileHeader</span><span class="op" id="6051155">)</span>&nbsp;<span class="ident" id="6051157">isZip64</span><span class="op" id="6051164">(</span><span class="op" id="6051165">)</span>&nbsp;<span class="builtintype" id="6051167">bool</span>&nbsp;<span class="op" id="6051172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6051175">return</span>&nbsp;<span class="ident" id="6051182">fh</span><span class="op" id="6051184">.</span><span class="ident" id="6051185">CompressedSize64</span>&nbsp;<span class="op" id="6051202">&gt;</span>&nbsp;<span class="ident" id="6051204">uint32max</span>&nbsp;<span class="op" id="6051214">||</span>&nbsp;<span class="ident" id="6051217">fh</span><span class="op" id="6051219">.</span><span class="ident" id="6051220">UncompressedSize64</span>&nbsp;<span class="op" id="6051239">&gt;</span>&nbsp;<span class="ident" id="6051241">uint32max</span><br>
<span class="lineno"></span><span class="op" id="6051251">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span><span class="keyword" id="6051254">func</span>&nbsp;<span class="ident" id="6051259">msdosModeToFileMode</span><span class="op" id="6051278">(</span><span class="ident" id="6051279">m</span>&nbsp;<span class="builtintype" id="6051281">uint32</span><span class="op" id="6051287">)</span>&nbsp;<span class="op" id="6051289">(</span><span class="ident" id="6051290">mode</span>&nbsp;<span class="ident" id="6051295">os</span><span class="op" id="6051297">.</span><span class="ident" id="6051298">FileMode</span><span class="op" id="6051306">)</span>&nbsp;<span class="op" id="6051308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6051311">if</span>&nbsp;<span class="ident" id="6051314">m</span><span class="op" id="6051315">&amp;</span><span class="ident" id="6051316">msdosDir</span>&nbsp;<span class="op" id="6051325">!=</span>&nbsp;<span class="num" id="6051328">0</span>&nbsp;<span class="op" id="6051330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6051334">mode</span>&nbsp;<span class="op" id="6051339">=</span>&nbsp;<span class="ident" id="6051341">os</span><span class="op" id="6051343">.</span><span class="ident" id="6051344">ModeDir</span>&nbsp;<span class="op" id="6051352">|</span>&nbsp;<span class="num" id="6051354">0777</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6051360">}</span>&nbsp;<span class="keyword" id="6051362">else</span>&nbsp;<span class="op" id="6051367">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6051371">mode</span>&nbsp;<span class="op" id="6051376">=</span>&nbsp;<span class="num" id="6051378">0666</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6051384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6051387">if</span>&nbsp;<span class="ident" id="6051390">m</span><span class="op" id="6051391">&amp;</span><span class="ident" id="6051392">msdosReadOnly</span>&nbsp;<span class="op" id="6051406">!=</span>&nbsp;<span class="num" id="6051409">0</span>&nbsp;<span class="op" id="6051411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6051415">mode</span>&nbsp;<span class="op" id="6051420">&amp;^=</span>&nbsp;<span class="num" id="6051424">0222</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6051430">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6051433">return</span>&nbsp;<span class="ident" id="6051440">mode</span><br>
<span class="lineno"></span><span class="op" id="6051445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6051448">func</span>&nbsp;<span class="ident" id="6051453">fileModeToUnixMode</span><span class="op" id="6051471">(</span><span class="ident" id="6051472">mode</span>&nbsp;<span class="ident" id="6051477">os</span><span class="op" id="6051479">.</span><span class="ident" id="6051480">FileMode</span><span class="op" id="6051488">)</span>&nbsp;<span class="builtintype" id="6051490">uint32</span>&nbsp;<span class="op" id="6051497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6051500">var</span>&nbsp;<span class="ident" id="6051504">m</span>&nbsp;<span class="builtintype" id="6051506">uint32</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6051514">switch</span>&nbsp;<span class="ident" id="6051521">mode</span>&nbsp;<span class="op" id="6051526">&amp;</span>&nbsp;<span class="ident" id="6051528">os</span><span class="op" id="6051530">.</span><span class="ident" id="6051531">ModeType</span>&nbsp;<span class="op" id="6051540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6051543">default</span><span class="op" id="6051550">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6051554">m</span>&nbsp;<span class="op" id="6051556">=</span>&nbsp;<span class="ident" id="6051558">s_IFREG</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6051567">case</span>&nbsp;<span class="ident" id="6051572">os</span><span class="op" id="6051574">.</span><span class="ident" id="6051575">ModeDir</span><span class="op" id="6051582">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6051586">m</span>&nbsp;<span class="op" id="6051588">=</span>&nbsp;<span class="ident" id="6051590">s_IFDIR</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6051599">case</span>&nbsp;<span class="ident" id="6051604">os</span><span class="op" id="6051606">.</span><span class="ident" id="6051607">ModeSymlink</span><span class="op" id="6051618">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6051622">m</span>&nbsp;<span class="op" id="6051624">=</span>&nbsp;<span class="ident" id="6051626">s_IFLNK</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6051635">case</span>&nbsp;<span class="ident" id="6051640">os</span><span class="op" id="6051642">.</span><span class="ident" id="6051643">ModeNamedPipe</span><span class="op" id="6051656">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6051660">m</span>&nbsp;<span class="op" id="6051662">=</span>&nbsp;<span class="ident" id="6051664">s_IFIFO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6051673">case</span>&nbsp;<span class="ident" id="6051678">os</span><span class="op" id="6051680">.</span><span class="ident" id="6051681">ModeSocket</span><span class="op" id="6051691">:</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6051695">m</span>&nbsp;<span class="op" id="6051697">=</span>&nbsp;<span class="ident" id="6051699">s_IFSOCK</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6051709">case</span>&nbsp;<span class="ident" id="6051714">os</span><span class="op" id="6051716">.</span><span class="ident" id="6051717">ModeDevice</span><span class="op" id="6051727">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6051731">if</span>&nbsp;<span class="ident" id="6051734">mode</span><span class="op" id="6051738">&amp;</span><span class="ident" id="6051739">os</span><span class="op" id="6051741">.</span><span class="ident" id="6051742">ModeCharDevice</span>&nbsp;<span class="op" id="6051757">!=</span>&nbsp;<span class="num" id="6051760">0</span>&nbsp;<span class="op" id="6051762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6051767">m</span>&nbsp;<span class="op" id="6051769">=</span>&nbsp;<span class="ident" id="6051771">s_IFCHR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6051781">}</span>&nbsp;<span class="keyword" id="6051783">else</span>&nbsp;<span class="op" id="6051788">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6051793">m</span>&nbsp;<span class="op" id="6051795">=</span>&nbsp;<span class="ident" id="6051797">s_IFBLK</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6051807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6051810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6051813">if</span>&nbsp;<span class="ident" id="6051816">mode</span><span class="op" id="6051820">&amp;</span><span class="ident" id="6051821">os</span><span class="op" id="6051823">.</span><span class="ident" id="6051824">ModeSetuid</span>&nbsp;<span class="op" id="6051835">!=</span>&nbsp;<span class="num" id="6051838">0</span>&nbsp;<span class="op" id="6051840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6051844">m</span>&nbsp;<span class="op" id="6051846">|=</span>&nbsp;<span class="ident" id="6051849">s_ISUID</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6051858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6051861">if</span>&nbsp;<span class="ident" id="6051864">mode</span><span class="op" id="6051868">&amp;</span><span class="ident" id="6051869">os</span><span class="op" id="6051871">.</span><span class="ident" id="6051872">ModeSetgid</span>&nbsp;<span class="op" id="6051883">!=</span>&nbsp;<span class="num" id="6051886">0</span>&nbsp;<span class="op" id="6051888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6051892">m</span>&nbsp;<span class="op" id="6051894">|=</span>&nbsp;<span class="ident" id="6051897">s_ISGID</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6051906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6051909">if</span>&nbsp;<span class="ident" id="6051912">mode</span><span class="op" id="6051916">&amp;</span><span class="ident" id="6051917">os</span><span class="op" id="6051919">.</span><span class="ident" id="6051920">ModeSticky</span>&nbsp;<span class="op" id="6051931">!=</span>&nbsp;<span class="num" id="6051934">0</span>&nbsp;<span class="op" id="6051936">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6051940">m</span>&nbsp;<span class="op" id="6051942">|=</span>&nbsp;<span class="ident" id="6051945">s_ISVTX</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6051954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6051957">return</span>&nbsp;<span class="ident" id="6051964">m</span>&nbsp;<span class="op" id="6051966">|</span>&nbsp;<span class="builtintype" id="6051968">uint32</span><span class="op" id="6051974">(</span><span class="ident" id="6051975">mode</span><span class="op" id="6051979">&amp;</span><span class="num" id="6051980">0777</span><span class="op" id="6051984">)</span><br>
<span class="lineno"></span><span class="op" id="6051986">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="6051989">func</span>&nbsp;<span class="ident" id="6051994">unixModeToFileMode</span><span class="op" id="6052012">(</span><span class="ident" id="6052013">m</span>&nbsp;<span class="builtintype" id="6052015">uint32</span><span class="op" id="6052021">)</span>&nbsp;<span class="ident" id="6052023">os</span><span class="op" id="6052025">.</span><span class="ident" id="6052026">FileMode</span>&nbsp;<span class="op" id="6052035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6052038">mode</span>&nbsp;<span class="op" id="6052043">:=</span>&nbsp;<span class="ident" id="6052046">os</span><span class="op" id="6052048">.</span><span class="ident" id="6052049">FileMode</span><span class="op" id="6052057">(</span><span class="ident" id="6052058">m</span>&nbsp;<span class="op" id="6052060">&amp;</span>&nbsp;<span class="num" id="6052062">0777</span><span class="op" id="6052066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6052069">switch</span>&nbsp;<span class="ident" id="6052076">m</span>&nbsp;<span class="op" id="6052078">&amp;</span>&nbsp;<span class="ident" id="6052080">s_IFMT</span>&nbsp;<span class="op" id="6052087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6052090">case</span>&nbsp;<span class="ident" id="6052095">s_IFBLK</span><span class="op" id="6052102">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6052106">mode</span>&nbsp;<span class="op" id="6052111">|=</span>&nbsp;<span class="ident" id="6052114">os</span><span class="op" id="6052116">.</span><span class="ident" id="6052117">ModeDevice</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6052129">case</span>&nbsp;<span class="ident" id="6052134">s_IFCHR</span><span class="op" id="6052141">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6052145">mode</span>&nbsp;<span class="op" id="6052150">|=</span>&nbsp;<span class="ident" id="6052153">os</span><span class="op" id="6052155">.</span><span class="ident" id="6052156">ModeDevice</span>&nbsp;<span class="op" id="6052167">|</span>&nbsp;<span class="ident" id="6052169">os</span><span class="op" id="6052171">.</span><span class="ident" id="6052172">ModeCharDevice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6052188">case</span>&nbsp;<span class="ident" id="6052193">s_IFDIR</span><span class="op" id="6052200">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6052204">mode</span>&nbsp;<span class="op" id="6052209">|=</span>&nbsp;<span class="ident" id="6052212">os</span><span class="op" id="6052214">.</span><span class="ident" id="6052215">ModeDir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6052224">case</span>&nbsp;<span class="ident" id="6052229">s_IFIFO</span><span class="op" id="6052236">:</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6052240">mode</span>&nbsp;<span class="op" id="6052245">|=</span>&nbsp;<span class="ident" id="6052248">os</span><span class="op" id="6052250">.</span><span class="ident" id="6052251">ModeNamedPipe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6052266">case</span>&nbsp;<span class="ident" id="6052271">s_IFLNK</span><span class="op" id="6052278">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6052282">mode</span>&nbsp;<span class="op" id="6052287">|=</span>&nbsp;<span class="ident" id="6052290">os</span><span class="op" id="6052292">.</span><span class="ident" id="6052293">ModeSymlink</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6052306">case</span>&nbsp;<span class="ident" id="6052311">s_IFREG</span><span class="op" id="6052318">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6052322">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6052340">case</span>&nbsp;<span class="ident" id="6052345">s_IFSOCK</span><span class="op" id="6052353">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6052357">mode</span>&nbsp;<span class="op" id="6052362">|=</span>&nbsp;<span class="ident" id="6052365">os</span><span class="op" id="6052367">.</span><span class="ident" id="6052368">ModeSocket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6052380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6052383">if</span>&nbsp;<span class="ident" id="6052386">m</span><span class="op" id="6052387">&amp;</span><span class="ident" id="6052388">s_ISGID</span>&nbsp;<span class="op" id="6052396">!=</span>&nbsp;<span class="num" id="6052399">0</span>&nbsp;<span class="op" id="6052401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6052405">mode</span>&nbsp;<span class="op" id="6052410">|=</span>&nbsp;<span class="ident" id="6052413">os</span><span class="op" id="6052415">.</span><span class="ident" id="6052416">ModeSetgid</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6052428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6052431">if</span>&nbsp;<span class="ident" id="6052434">m</span><span class="op" id="6052435">&amp;</span><span class="ident" id="6052436">s_ISUID</span>&nbsp;<span class="op" id="6052444">!=</span>&nbsp;<span class="num" id="6052447">0</span>&nbsp;<span class="op" id="6052449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6052453">mode</span>&nbsp;<span class="op" id="6052458">|=</span>&nbsp;<span class="ident" id="6052461">os</span><span class="op" id="6052463">.</span><span class="ident" id="6052464">ModeSetuid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6052476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6052479">if</span>&nbsp;<span class="ident" id="6052482">m</span><span class="op" id="6052483">&amp;</span><span class="ident" id="6052484">s_ISVTX</span>&nbsp;<span class="op" id="6052492">!=</span>&nbsp;<span class="num" id="6052495">0</span>&nbsp;<span class="op" id="6052497">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6052501">mode</span>&nbsp;<span class="op" id="6052506">|=</span>&nbsp;<span class="ident" id="6052509">os</span><span class="op" id="6052511">.</span><span class="ident" id="6052512">ModeSticky</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6052524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6052527">return</span>&nbsp;<span class="ident" id="6052534">mode</span><br>
<span class="lineno"></span><span class="op" id="6052539">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
