<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/cipher</h2>
<ul>
<li><a href="/gostd/crypto/cipher/benchmark_test.go.html">benchmark_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cbc.go.html">cbc.go</a></li>
<li><a href="/gostd/crypto/cipher/cbc_aes_test.go.html">cbc_aes_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cfb.go.html">cfb.go</a></li>
<li><a href="/gostd/crypto/cipher/cfb_test.go.html">cfb_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/cipher/cipher_test.go.html">cipher_test.go</a></li>
<li><a href="/gostd/crypto/cipher/common_test.go.html">common_test.go</a></li>
<li><a href="/gostd/crypto/cipher/ctr.go.html">ctr.go</a></li>
<li><a href="/gostd/crypto/cipher/ctr_aes_test.go.html">ctr_aes_test.go</a></li>
<li><a href="/gostd/crypto/cipher/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/cipher/gcm.go.html">gcm.go</a></li>
<li><a href="/gostd/crypto/cipher/gcm_test.go.html">gcm_test.go</a></li>
<li><a href="/gostd/crypto/cipher/io.go.html">io.go</a></li>
<li><a href="/gostd/crypto/cipher/ofb.go.html">ofb.go</a></li>
<li><a href="/gostd/crypto/cipher/ofb_test.go.html">ofb_test.go</a></li>
<li><a href="/gostd/crypto/cipher/xor.go.html">xor.go</a></li>
<li><a href="/gostd/crypto/cipher/xor_test.go.html">xor_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3528677">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3528732">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3528786">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3528837">//&nbsp;Counter&nbsp;(CTR)&nbsp;mode.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3528861">//&nbsp;CTR&nbsp;converts&nbsp;a&nbsp;block&nbsp;cipher&nbsp;into&nbsp;a&nbsp;stream&nbsp;cipher&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3528916">//&nbsp;repeatedly&nbsp;encrypting&nbsp;an&nbsp;incrementing&nbsp;counter&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3528969">//&nbsp;xoring&nbsp;the&nbsp;resulting&nbsp;stream&nbsp;of&nbsp;data&nbsp;with&nbsp;the&nbsp;input.</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="3529025">//&nbsp;See&nbsp;NIST&nbsp;SP&nbsp;800-38A,&nbsp;pp&nbsp;13-15</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3529059">package</span>&nbsp;<span class="ident" id="3529067">cipher</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3529075">type</span>&nbsp;<span class="ident" id="3529080">ctr</span>&nbsp;<span class="keyword" id="3529084">struct</span>&nbsp;<span class="op" id="3529091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3529094">b</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3529102">Block</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3529109">ctr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3529117">[</span><span class="op" id="3529118">]</span><span class="builtintype" id="3529119">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3529125">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3529133">[</span><span class="op" id="3529134">]</span><span class="builtintype" id="3529135">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3529141">outUsed</span>&nbsp;<span class="builtintype" id="3529149">int</span><br>
<span class="lineno">20</span><span class="op" id="3529153">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3529156">const</span>&nbsp;<span class="ident" id="3529162">streamBufferSize</span>&nbsp;<span class="op" id="3529179">=</span>&nbsp;<span class="num" id="3529181">512</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3529186">//&nbsp;NewCTR&nbsp;returns&nbsp;a&nbsp;Stream&nbsp;which&nbsp;encrypts/decrypts&nbsp;using&nbsp;the&nbsp;given&nbsp;Block&nbsp;in</span><br>
<span class="lineno">25</span><span class="comment" id="3529262">//&nbsp;counter&nbsp;mode.&nbsp;The&nbsp;length&nbsp;of&nbsp;iv&nbsp;must&nbsp;be&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;Block&#39;s&nbsp;block&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="3529340">func</span>&nbsp;<span class="ident" id="3529345">NewCTR</span><span class="op" id="3529351">(</span><span class="ident" id="3529352">block</span>&nbsp;<span class="ident" id="3529358">Block</span><span class="op" id="3529363">,</span>&nbsp;<span class="ident" id="3529365">iv</span>&nbsp;<span class="op" id="3529368">[</span><span class="op" id="3529369">]</span><span class="builtintype" id="3529370">byte</span><span class="op" id="3529374">)</span>&nbsp;<span class="ident" id="3529376">Stream</span>&nbsp;<span class="op" id="3529383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3529386">if</span>&nbsp;<span class="builtinfunc" id="3529389">len</span><span class="op" id="3529392">(</span><span class="ident" id="3529393">iv</span><span class="op" id="3529395">)</span>&nbsp;<span class="op" id="3529397">!=</span>&nbsp;<span class="ident" id="3529400">block</span><span class="op" id="3529405">.</span><span class="ident" id="3529406">BlockSize</span><span class="op" id="3529415">(</span><span class="op" id="3529416">)</span>&nbsp;<span class="op" id="3529418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3529422">panic</span><span class="op" id="3529427">(</span><span class="string" id="3529428">&#34;cipher.NewCTR:&nbsp;IV&nbsp;length&nbsp;must&nbsp;equal&nbsp;block&nbsp;size&#34;</span><span class="op" id="3529476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3529479">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3529482">bufSize</span>&nbsp;<span class="op" id="3529490">:=</span>&nbsp;<span class="ident" id="3529493">streamBufferSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3529511">if</span>&nbsp;<span class="ident" id="3529514">bufSize</span>&nbsp;<span class="op" id="3529522">&lt;</span>&nbsp;<span class="ident" id="3529524">block</span><span class="op" id="3529529">.</span><span class="ident" id="3529530">BlockSize</span><span class="op" id="3529539">(</span><span class="op" id="3529540">)</span>&nbsp;<span class="op" id="3529542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3529546">bufSize</span>&nbsp;<span class="op" id="3529554">=</span>&nbsp;<span class="ident" id="3529556">block</span><span class="op" id="3529561">.</span><span class="ident" id="3529562">BlockSize</span><span class="op" id="3529571">(</span><span class="op" id="3529572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3529575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3529578">return</span>&nbsp;<span class="op" id="3529585">&amp;</span><span class="ident" id="3529586">ctr</span><span class="op" id="3529589">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3529593">b</span><span class="op" id="3529594">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3529602">block</span><span class="op" id="3529607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3529611">ctr</span><span class="op" id="3529614">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3529620">dup</span><span class="op" id="3529623">(</span><span class="ident" id="3529624">iv</span><span class="op" id="3529626">)</span><span class="op" id="3529627">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3529631">out</span><span class="op" id="3529634">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3529640">make</span><span class="op" id="3529644">(</span><span class="op" id="3529645">[</span><span class="op" id="3529646">]</span><span class="builtintype" id="3529647">byte</span><span class="op" id="3529651">,</span>&nbsp;<span class="num" id="3529653">0</span><span class="op" id="3529654">,</span>&nbsp;<span class="ident" id="3529656">bufSize</span><span class="op" id="3529663">)</span><span class="op" id="3529664">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3529668">outUsed</span><span class="op" id="3529675">:</span>&nbsp;<span class="num" id="3529677">0</span><span class="op" id="3529678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3529681">}</span><br>
<span class="lineno">40</span><span class="op" id="3529683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3529686">func</span>&nbsp;<span class="op" id="3529691">(</span><span class="ident" id="3529692">x</span>&nbsp;<span class="op" id="3529694">*</span><span class="ident" id="3529695">ctr</span><span class="op" id="3529698">)</span>&nbsp;<span class="ident" id="3529700">refill</span><span class="op" id="3529706">(</span><span class="op" id="3529707">)</span>&nbsp;<span class="op" id="3529709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3529712">remain</span>&nbsp;<span class="op" id="3529719">:=</span>&nbsp;<span class="builtinfunc" id="3529722">len</span><span class="op" id="3529725">(</span><span class="ident" id="3529726">x</span><span class="op" id="3529727">.</span><span class="ident" id="3529728">out</span><span class="op" id="3529731">)</span>&nbsp;<span class="op" id="3529733">-</span>&nbsp;<span class="ident" id="3529735">x</span><span class="op" id="3529736">.</span><span class="ident" id="3529737">outUsed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3529746">if</span>&nbsp;<span class="ident" id="3529749">remain</span>&nbsp;<span class="op" id="3529756">&gt;</span>&nbsp;<span class="ident" id="3529758">x</span><span class="op" id="3529759">.</span><span class="ident" id="3529760">outUsed</span>&nbsp;<span class="op" id="3529768">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3529772">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3529780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3529783">copy</span><span class="op" id="3529787">(</span><span class="ident" id="3529788">x</span><span class="op" id="3529789">.</span><span class="ident" id="3529790">out</span><span class="op" id="3529793">,</span>&nbsp;<span class="ident" id="3529795">x</span><span class="op" id="3529796">.</span><span class="ident" id="3529797">out</span><span class="op" id="3529800">[</span><span class="ident" id="3529801">x</span><span class="op" id="3529802">.</span><span class="ident" id="3529803">outUsed</span><span class="op" id="3529810">:</span><span class="op" id="3529811">]</span><span class="op" id="3529812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3529815">x</span><span class="op" id="3529816">.</span><span class="ident" id="3529817">out</span>&nbsp;<span class="op" id="3529821">=</span>&nbsp;<span class="ident" id="3529823">x</span><span class="op" id="3529824">.</span><span class="ident" id="3529825">out</span><span class="op" id="3529828">[</span><span class="op" id="3529829">:</span><span class="builtinfunc" id="3529830">cap</span><span class="op" id="3529833">(</span><span class="ident" id="3529834">x</span><span class="op" id="3529835">.</span><span class="ident" id="3529836">out</span><span class="op" id="3529839">)</span><span class="op" id="3529840">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3529843">bs</span>&nbsp;<span class="op" id="3529846">:=</span>&nbsp;<span class="ident" id="3529849">x</span><span class="op" id="3529850">.</span><span class="ident" id="3529851">b</span><span class="op" id="3529852">.</span><span class="ident" id="3529853">BlockSize</span><span class="op" id="3529862">(</span><span class="op" id="3529863">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3529866">for</span>&nbsp;<span class="ident" id="3529870">remain</span>&nbsp;<span class="op" id="3529877">&lt;</span>&nbsp;<span class="builtinfunc" id="3529879">len</span><span class="op" id="3529882">(</span><span class="ident" id="3529883">x</span><span class="op" id="3529884">.</span><span class="ident" id="3529885">out</span><span class="op" id="3529888">)</span><span class="op" id="3529889">-</span><span class="ident" id="3529890">bs</span>&nbsp;<span class="op" id="3529893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3529897">x</span><span class="op" id="3529898">.</span><span class="ident" id="3529899">b</span><span class="op" id="3529900">.</span><span class="ident" id="3529901">Encrypt</span><span class="op" id="3529908">(</span><span class="ident" id="3529909">x</span><span class="op" id="3529910">.</span><span class="ident" id="3529911">out</span><span class="op" id="3529914">[</span><span class="ident" id="3529915">remain</span><span class="op" id="3529921">:</span><span class="op" id="3529922">]</span><span class="op" id="3529923">,</span>&nbsp;<span class="ident" id="3529925">x</span><span class="op" id="3529926">.</span><span class="ident" id="3529927">ctr</span><span class="op" id="3529930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3529934">remain</span>&nbsp;<span class="op" id="3529941">+=</span>&nbsp;<span class="ident" id="3529944">bs</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3529950">//&nbsp;Increment&nbsp;counter</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3529973">for</span>&nbsp;<span class="ident" id="3529977">i</span>&nbsp;<span class="op" id="3529979">:=</span>&nbsp;<span class="builtinfunc" id="3529982">len</span><span class="op" id="3529985">(</span><span class="ident" id="3529986">x</span><span class="op" id="3529987">.</span><span class="ident" id="3529988">ctr</span><span class="op" id="3529991">)</span>&nbsp;<span class="op" id="3529993">-</span>&nbsp;<span class="num" id="3529995">1</span><span class="op" id="3529996">;</span>&nbsp;<span class="ident" id="3529998">i</span>&nbsp;<span class="op" id="3530000">&gt;=</span>&nbsp;<span class="num" id="3530003">0</span><span class="op" id="3530004">;</span>&nbsp;<span class="ident" id="3530006">i</span><span class="op" id="3530007">--</span>&nbsp;<span class="op" id="3530010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3530015">x</span><span class="op" id="3530016">.</span><span class="ident" id="3530017">ctr</span><span class="op" id="3530020">[</span><span class="ident" id="3530021">i</span><span class="op" id="3530022">]</span><span class="op" id="3530023">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3530029">if</span>&nbsp;<span class="ident" id="3530032">x</span><span class="op" id="3530033">.</span><span class="ident" id="3530034">ctr</span><span class="op" id="3530037">[</span><span class="ident" id="3530038">i</span><span class="op" id="3530039">]</span>&nbsp;<span class="op" id="3530041">!=</span>&nbsp;<span class="num" id="3530044">0</span>&nbsp;<span class="op" id="3530046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3530052">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3530061">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3530065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3530068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3530071">x</span><span class="op" id="3530072">.</span><span class="ident" id="3530073">out</span>&nbsp;<span class="op" id="3530077">=</span>&nbsp;<span class="ident" id="3530079">x</span><span class="op" id="3530080">.</span><span class="ident" id="3530081">out</span><span class="op" id="3530084">[</span><span class="op" id="3530085">:</span><span class="ident" id="3530086">remain</span><span class="op" id="3530092">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3530095">x</span><span class="op" id="3530096">.</span><span class="ident" id="3530097">outUsed</span>&nbsp;<span class="op" id="3530105">=</span>&nbsp;<span class="num" id="3530107">0</span><br>
<span class="lineno"></span><span class="op" id="3530109">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="3530112">func</span>&nbsp;<span class="op" id="3530117">(</span><span class="ident" id="3530118">x</span>&nbsp;<span class="op" id="3530120">*</span><span class="ident" id="3530121">ctr</span><span class="op" id="3530124">)</span>&nbsp;<span class="ident" id="3530126">XORKeyStream</span><span class="op" id="3530138">(</span><span class="ident" id="3530139">dst</span><span class="op" id="3530142">,</span>&nbsp;<span class="ident" id="3530144">src</span>&nbsp;<span class="op" id="3530148">[</span><span class="op" id="3530149">]</span><span class="builtintype" id="3530150">byte</span><span class="op" id="3530154">)</span>&nbsp;<span class="op" id="3530156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3530159">for</span>&nbsp;<span class="builtinfunc" id="3530163">len</span><span class="op" id="3530166">(</span><span class="ident" id="3530167">src</span><span class="op" id="3530170">)</span>&nbsp;<span class="op" id="3530172">&gt;</span>&nbsp;<span class="num" id="3530174">0</span>&nbsp;<span class="op" id="3530176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3530180">if</span>&nbsp;<span class="ident" id="3530183">x</span><span class="op" id="3530184">.</span><span class="ident" id="3530185">outUsed</span>&nbsp;<span class="op" id="3530193">&gt;=</span>&nbsp;<span class="builtinfunc" id="3530196">len</span><span class="op" id="3530199">(</span><span class="ident" id="3530200">x</span><span class="op" id="3530201">.</span><span class="ident" id="3530202">out</span><span class="op" id="3530205">)</span><span class="op" id="3530206">-</span><span class="ident" id="3530207">x</span><span class="op" id="3530208">.</span><span class="ident" id="3530209">b</span><span class="op" id="3530210">.</span><span class="ident" id="3530211">BlockSize</span><span class="op" id="3530220">(</span><span class="op" id="3530221">)</span>&nbsp;<span class="op" id="3530223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3530228">x</span><span class="op" id="3530229">.</span><span class="ident" id="3530230">refill</span><span class="op" id="3530236">(</span><span class="op" id="3530237">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3530241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3530245">n</span>&nbsp;<span class="op" id="3530247">:=</span>&nbsp;<span class="ident" id="3530250">xorBytes</span><span class="op" id="3530258">(</span><span class="ident" id="3530259">dst</span><span class="op" id="3530262">,</span>&nbsp;<span class="ident" id="3530264">src</span><span class="op" id="3530267">,</span>&nbsp;<span class="ident" id="3530269">x</span><span class="op" id="3530270">.</span><span class="ident" id="3530271">out</span><span class="op" id="3530274">[</span><span class="ident" id="3530275">x</span><span class="op" id="3530276">.</span><span class="ident" id="3530277">outUsed</span><span class="op" id="3530284">:</span><span class="op" id="3530285">]</span><span class="op" id="3530286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3530290">dst</span>&nbsp;<span class="op" id="3530294">=</span>&nbsp;<span class="ident" id="3530296">dst</span><span class="op" id="3530299">[</span><span class="ident" id="3530300">n</span><span class="op" id="3530301">:</span><span class="op" id="3530302">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3530306">src</span>&nbsp;<span class="op" id="3530310">=</span>&nbsp;<span class="ident" id="3530312">src</span><span class="op" id="3530315">[</span><span class="ident" id="3530316">n</span><span class="op" id="3530317">:</span><span class="op" id="3530318">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3530322">x</span><span class="op" id="3530323">.</span><span class="ident" id="3530324">outUsed</span>&nbsp;<span class="op" id="3530332">+=</span>&nbsp;<span class="ident" id="3530335">n</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3530338">}</span><br>
<span class="lineno"></span><span class="op" id="3530340">}</span>
</div>
</body>
</html>
