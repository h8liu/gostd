<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>syscall</h2>
<ul>
<li><a href="/gostd/syscall/creds_test.go.html">creds_test.go</a></li>
<li><a href="/gostd/syscall/env_unix.go.html">env_unix.go</a></li>
<li><a href="/gostd/syscall/exec_linux.go.html">exec_linux.go</a></li>
<li><a href="/gostd/syscall/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/syscall/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/syscall/flock.go.html">flock.go</a></li>
<li><a href="/gostd/syscall/lsf_linux.go.html">lsf_linux.go</a></li>
<li><a href="/gostd/syscall/mmap_unix_test.go.html">mmap_unix_test.go</a></li>
<li><a href="/gostd/syscall/netlink_linux.go.html">netlink_linux.go</a></li>
<li><a href="/gostd/syscall/race0.go.html">race0.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_linux.go.html">sockcmsg_linux.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_unix.go.html">sockcmsg_unix.go</a></li>
<li><a href="/gostd/syscall/str.go.html">str.go</a></li>
<li><a href="/gostd/syscall/syscall.go.html">syscall.go</a></li>
<li><a href="/gostd/syscall/syscall_linux.go.html">syscall_linux.go</a></li>
<li><a href="/gostd/syscall/syscall_linux_amd64.go.html">syscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/syscall_test.go.html">syscall_test.go</a></li>
<li><a href="/gostd/syscall/syscall_unix.go.html">syscall_unix.go</a></li>
<li><a href="/gostd/syscall/syscall_unix_test.go.html">syscall_unix_test.go</a></li>
<li><a href="/gostd/syscall/zerrors_linux_amd64.go.html">zerrors_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsyscall_linux_amd64.go.html">zsyscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsysnum_linux_amd64.go.html">zsysnum_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/ztypes_linux_amd64.go.html">ztypes_linux_amd64.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2543322">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2543377">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2543431">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2543482">//&nbsp;Linux&nbsp;system&nbsp;calls.</span><br>
<span class="lineno"></span><span class="comment" id="2543505">//&nbsp;This&nbsp;file&nbsp;is&nbsp;compiled&nbsp;as&nbsp;ordinary&nbsp;Go&nbsp;code,</span><br>
<span class="lineno"></span><span class="comment" id="2543551">//&nbsp;but&nbsp;it&nbsp;is&nbsp;also&nbsp;input&nbsp;to&nbsp;mksyscall,</span><br>
<span class="lineno"></span><span class="comment" id="2543589">//&nbsp;which&nbsp;parses&nbsp;the&nbsp;//sys&nbsp;lines&nbsp;and&nbsp;generates&nbsp;system&nbsp;call&nbsp;stubs.</span><br>
<span class="lineno"></span><span class="comment" id="2543654">//&nbsp;Note&nbsp;that&nbsp;sometimes&nbsp;we&nbsp;use&nbsp;a&nbsp;lowercase&nbsp;//sys&nbsp;name&nbsp;and</span><br>
<span class="lineno">10</span><span class="comment" id="2543711">//&nbsp;wrap&nbsp;it&nbsp;in&nbsp;our&nbsp;own&nbsp;nicer&nbsp;implementation.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2543756">package</span>&nbsp;<span class="ident" id="2543764">syscall</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2543773">import</span>&nbsp;<span class="string" id="2543780">&#34;unsafe&#34;</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2543790">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Wrapped<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="2543809">//sys&nbsp;&nbsp;&nbsp;&nbspopen(path&nbsp;string,&nbsp;mode&nbsp;int,&nbsp;perm&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2543877">func</span>&nbsp;<span class="ident" id="2543882">Open</span><span class="op" id="2543886">(</span><span class="ident" id="2543887">path</span>&nbsp;<span class="builtintype" id="2543892">string</span><span class="op" id="2543898">,</span>&nbsp;<span class="ident" id="2543900">mode</span>&nbsp;<span class="builtintype" id="2543905">int</span><span class="op" id="2543908">,</span>&nbsp;<span class="ident" id="2543910">perm</span>&nbsp;<span class="builtintype" id="2543915">uint32</span><span class="op" id="2543921">)</span>&nbsp;<span class="op" id="2543923">(</span><span class="ident" id="2543924">fd</span>&nbsp;<span class="builtintype" id="2543927">int</span><span class="op" id="2543930">,</span>&nbsp;<span class="ident" id="2543932">err</span>&nbsp;<span class="builtintype" id="2543936">error</span><span class="op" id="2543941">)</span>&nbsp;<span class="op" id="2543943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2543946">return</span>&nbsp;<span class="ident" id="2543953">open</span><span class="op" id="2543957">(</span><span class="ident" id="2543958">path</span><span class="op" id="2543962">,</span>&nbsp;<span class="ident" id="2543964">mode</span><span class="op" id="2543968">|</span><span class="ident" id="2543969">O_LARGEFILE</span><span class="op" id="2543980">,</span>&nbsp;<span class="ident" id="2543982">perm</span><span class="op" id="2543986">)</span><br>
<span class="lineno"></span><span class="op" id="2543988">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="2543991">//sys&nbsp;&nbsp;&nbsp;&nbspopenat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;flags&nbsp;int,&nbsp;mode&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2544073">func</span>&nbsp;<span class="ident" id="2544078">Openat</span><span class="op" id="2544084">(</span><span class="ident" id="2544085">dirfd</span>&nbsp;<span class="builtintype" id="2544091">int</span><span class="op" id="2544094">,</span>&nbsp;<span class="ident" id="2544096">path</span>&nbsp;<span class="builtintype" id="2544101">string</span><span class="op" id="2544107">,</span>&nbsp;<span class="ident" id="2544109">flags</span>&nbsp;<span class="builtintype" id="2544115">int</span><span class="op" id="2544118">,</span>&nbsp;<span class="ident" id="2544120">mode</span>&nbsp;<span class="builtintype" id="2544125">uint32</span><span class="op" id="2544131">)</span>&nbsp;<span class="op" id="2544133">(</span><span class="ident" id="2544134">fd</span>&nbsp;<span class="builtintype" id="2544137">int</span><span class="op" id="2544140">,</span>&nbsp;<span class="ident" id="2544142">err</span>&nbsp;<span class="builtintype" id="2544146">error</span><span class="op" id="2544151">)</span>&nbsp;<span class="op" id="2544153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544156">return</span>&nbsp;<span class="ident" id="2544163">openat</span><span class="op" id="2544169">(</span><span class="ident" id="2544170">dirfd</span><span class="op" id="2544175">,</span>&nbsp;<span class="ident" id="2544177">path</span><span class="op" id="2544181">,</span>&nbsp;<span class="ident" id="2544183">flags</span><span class="op" id="2544188">|</span><span class="ident" id="2544189">O_LARGEFILE</span><span class="op" id="2544200">,</span>&nbsp;<span class="ident" id="2544202">mode</span><span class="op" id="2544206">)</span><br>
<span class="lineno">30</span><span class="op" id="2544208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2544211">//sysnb&nbsp;&nbsp;&nbsp;&nbsppipe(p&nbsp;*[2]_C_int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2544251">func</span>&nbsp;<span class="ident" id="2544256">Pipe</span><span class="op" id="2544260">(</span><span class="ident" id="2544261">p</span>&nbsp;<span class="op" id="2544263">[</span><span class="op" id="2544264">]</span><span class="builtintype" id="2544265">int</span><span class="op" id="2544268">)</span>&nbsp;<span class="op" id="2544270">(</span><span class="ident" id="2544271">err</span>&nbsp;<span class="builtintype" id="2544275">error</span><span class="op" id="2544280">)</span>&nbsp;<span class="op" id="2544282">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544285">if</span>&nbsp;<span class="builtinfunc" id="2544288">len</span><span class="op" id="2544291">(</span><span class="ident" id="2544292">p</span><span class="op" id="2544293">)</span>&nbsp;<span class="op" id="2544295">!=</span>&nbsp;<span class="num" id="2544298">2</span>&nbsp;<span class="op" id="2544300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544304">return</span>&nbsp;<span class="ident" id="2544311">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2544319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544322">var</span>&nbsp;<span class="ident" id="2544326">pp</span>&nbsp;<span class="op" id="2544329">[</span><span class="num" id="2544330">2</span><span class="op" id="2544331">]</span><span class="ident" id="2544332">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544340">err</span>&nbsp;<span class="op" id="2544344">=</span>&nbsp;<span class="ident" id="2544346">pipe</span><span class="op" id="2544350">(</span><span class="op" id="2544351">&amp;</span><span class="ident" id="2544352">pp</span><span class="op" id="2544354">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544357">p</span><span class="op" id="2544358">[</span><span class="num" id="2544359">0</span><span class="op" id="2544360">]</span>&nbsp;<span class="op" id="2544362">=</span>&nbsp;<span class="builtintype" id="2544364">int</span><span class="op" id="2544367">(</span><span class="ident" id="2544368">pp</span><span class="op" id="2544370">[</span><span class="num" id="2544371">0</span><span class="op" id="2544372">]</span><span class="op" id="2544373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544376">p</span><span class="op" id="2544377">[</span><span class="num" id="2544378">1</span><span class="op" id="2544379">]</span>&nbsp;<span class="op" id="2544381">=</span>&nbsp;<span class="builtintype" id="2544383">int</span><span class="op" id="2544386">(</span><span class="ident" id="2544387">pp</span><span class="op" id="2544389">[</span><span class="num" id="2544390">1</span><span class="op" id="2544391">]</span><span class="op" id="2544392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544395">return</span><br>
<span class="lineno"></span><span class="op" id="2544402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="2544405">//sysnb&nbsp;pipe2(p&nbsp;*[2]_C_int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2544457">func</span>&nbsp;<span class="ident" id="2544462">Pipe2</span><span class="op" id="2544467">(</span><span class="ident" id="2544468">p</span>&nbsp;<span class="op" id="2544470">[</span><span class="op" id="2544471">]</span><span class="builtintype" id="2544472">int</span><span class="op" id="2544475">,</span>&nbsp;<span class="ident" id="2544477">flags</span>&nbsp;<span class="builtintype" id="2544483">int</span><span class="op" id="2544486">)</span>&nbsp;<span class="op" id="2544488">(</span><span class="ident" id="2544489">err</span>&nbsp;<span class="builtintype" id="2544493">error</span><span class="op" id="2544498">)</span>&nbsp;<span class="op" id="2544500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544503">if</span>&nbsp;<span class="builtinfunc" id="2544506">len</span><span class="op" id="2544509">(</span><span class="ident" id="2544510">p</span><span class="op" id="2544511">)</span>&nbsp;<span class="op" id="2544513">!=</span>&nbsp;<span class="num" id="2544516">2</span>&nbsp;<span class="op" id="2544518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544522">return</span>&nbsp;<span class="ident" id="2544529">EINVAL</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2544537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544540">var</span>&nbsp;<span class="ident" id="2544544">pp</span>&nbsp;<span class="op" id="2544547">[</span><span class="num" id="2544548">2</span><span class="op" id="2544549">]</span><span class="ident" id="2544550">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544558">err</span>&nbsp;<span class="op" id="2544562">=</span>&nbsp;<span class="ident" id="2544564">pipe2</span><span class="op" id="2544569">(</span><span class="op" id="2544570">&amp;</span><span class="ident" id="2544571">pp</span><span class="op" id="2544573">,</span>&nbsp;<span class="ident" id="2544575">flags</span><span class="op" id="2544580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544583">p</span><span class="op" id="2544584">[</span><span class="num" id="2544585">0</span><span class="op" id="2544586">]</span>&nbsp;<span class="op" id="2544588">=</span>&nbsp;<span class="builtintype" id="2544590">int</span><span class="op" id="2544593">(</span><span class="ident" id="2544594">pp</span><span class="op" id="2544596">[</span><span class="num" id="2544597">0</span><span class="op" id="2544598">]</span><span class="op" id="2544599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544602">p</span><span class="op" id="2544603">[</span><span class="num" id="2544604">1</span><span class="op" id="2544605">]</span>&nbsp;<span class="op" id="2544607">=</span>&nbsp;<span class="builtintype" id="2544609">int</span><span class="op" id="2544612">(</span><span class="ident" id="2544613">pp</span><span class="op" id="2544615">[</span><span class="num" id="2544616">1</span><span class="op" id="2544617">]</span><span class="op" id="2544618">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544621">return</span><br>
<span class="lineno"></span><span class="op" id="2544628">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2544631">//sys&nbsp;&nbsp;&nbsp;&nbsputimes(path&nbsp;string,&nbsp;times&nbsp;*[2]Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="2544689">func</span>&nbsp;<span class="ident" id="2544694">Utimes</span><span class="op" id="2544700">(</span><span class="ident" id="2544701">path</span>&nbsp;<span class="builtintype" id="2544706">string</span><span class="op" id="2544712">,</span>&nbsp;<span class="ident" id="2544714">tv</span>&nbsp;<span class="op" id="2544717">[</span><span class="op" id="2544718">]</span><span class="ident" id="2544719">Timeval</span><span class="op" id="2544726">)</span>&nbsp;<span class="op" id="2544728">(</span><span class="ident" id="2544729">err</span>&nbsp;<span class="builtintype" id="2544733">error</span><span class="op" id="2544738">)</span>&nbsp;<span class="op" id="2544740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544743">if</span>&nbsp;<span class="builtinfunc" id="2544746">len</span><span class="op" id="2544749">(</span><span class="ident" id="2544750">tv</span><span class="op" id="2544752">)</span>&nbsp;<span class="op" id="2544754">!=</span>&nbsp;<span class="num" id="2544757">2</span>&nbsp;<span class="op" id="2544759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544763">return</span>&nbsp;<span class="ident" id="2544770">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2544778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544781">return</span>&nbsp;<span class="ident" id="2544788">utimes</span><span class="op" id="2544794">(</span><span class="ident" id="2544795">path</span><span class="op" id="2544799">,</span>&nbsp;<span class="op" id="2544801">(</span><span class="op" id="2544802">*</span><span class="op" id="2544803">[</span><span class="num" id="2544804">2</span><span class="op" id="2544805">]</span><span class="ident" id="2544806">Timeval</span><span class="op" id="2544813">)</span><span class="op" id="2544814">(</span><span class="ident" id="2544815">unsafe</span><span class="op" id="2544821">.</span><span class="ident" id="2544822">Pointer</span><span class="op" id="2544829">(</span><span class="op" id="2544830">&amp;</span><span class="ident" id="2544831">tv</span><span class="op" id="2544833">[</span><span class="num" id="2544834">0</span><span class="op" id="2544835">]</span><span class="op" id="2544836">)</span><span class="op" id="2544837">)</span><span class="op" id="2544838">)</span><br>
<span class="lineno">65</span><span class="op" id="2544840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2544843">//sys&nbsp;&nbsp;&nbsp;&nbsputimensat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;times&nbsp;*[2]Timespec)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2544916">func</span>&nbsp;<span class="ident" id="2544921">UtimesNano</span><span class="op" id="2544931">(</span><span class="ident" id="2544932">path</span>&nbsp;<span class="builtintype" id="2544937">string</span><span class="op" id="2544943">,</span>&nbsp;<span class="ident" id="2544945">ts</span>&nbsp;<span class="op" id="2544948">[</span><span class="op" id="2544949">]</span><span class="ident" id="2544950">Timespec</span><span class="op" id="2544958">)</span>&nbsp;<span class="op" id="2544960">(</span><span class="ident" id="2544961">err</span>&nbsp;<span class="builtintype" id="2544965">error</span><span class="op" id="2544970">)</span>&nbsp;<span class="op" id="2544972">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544975">if</span>&nbsp;<span class="builtinfunc" id="2544978">len</span><span class="op" id="2544981">(</span><span class="ident" id="2544982">ts</span><span class="op" id="2544984">)</span>&nbsp;<span class="op" id="2544986">!=</span>&nbsp;<span class="num" id="2544989">2</span>&nbsp;<span class="op" id="2544991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544995">return</span>&nbsp;<span class="ident" id="2545002">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2545010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545013">err</span>&nbsp;<span class="op" id="2545017">=</span>&nbsp;<span class="ident" id="2545019">utimensat</span><span class="op" id="2545028">(</span><span class="ident" id="2545029">_AT_FDCWD</span><span class="op" id="2545038">,</span>&nbsp;<span class="ident" id="2545040">path</span><span class="op" id="2545044">,</span>&nbsp;<span class="op" id="2545046">(</span><span class="op" id="2545047">*</span><span class="op" id="2545048">[</span><span class="num" id="2545049">2</span><span class="op" id="2545050">]</span><span class="ident" id="2545051">Timespec</span><span class="op" id="2545059">)</span><span class="op" id="2545060">(</span><span class="ident" id="2545061">unsafe</span><span class="op" id="2545067">.</span><span class="ident" id="2545068">Pointer</span><span class="op" id="2545075">(</span><span class="op" id="2545076">&amp;</span><span class="ident" id="2545077">ts</span><span class="op" id="2545079">[</span><span class="num" id="2545080">0</span><span class="op" id="2545081">]</span><span class="op" id="2545082">)</span><span class="op" id="2545083">)</span><span class="op" id="2545084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545087">if</span>&nbsp;<span class="ident" id="2545090">err</span>&nbsp;<span class="op" id="2545094">!=</span>&nbsp;<span class="ident" id="2545097">ENOSYS</span>&nbsp;<span class="op" id="2545104">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545108">return</span>&nbsp;<span class="ident" id="2545115">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2545120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2545123">//&nbsp;If&nbsp;the&nbsp;utimensat&nbsp;syscall&nbsp;isn&#39;t&nbsp;available&nbsp;(utimensat&nbsp;was&nbsp;added&nbsp;to&nbsp;Linux</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2545198">//&nbsp;in&nbsp;2.6.22,&nbsp;Released,&nbsp;8&nbsp;July&nbsp;2007)&nbsp;then&nbsp;fall&nbsp;back&nbsp;to&nbsp;utimes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545261">var</span>&nbsp;<span class="ident" id="2545265">tv</span>&nbsp;<span class="op" id="2545268">[</span><span class="num" id="2545269">2</span><span class="op" id="2545270">]</span><span class="ident" id="2545271">Timeval</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545280">for</span>&nbsp;<span class="ident" id="2545284">i</span>&nbsp;<span class="op" id="2545286">:=</span>&nbsp;<span class="num" id="2545289">0</span><span class="op" id="2545290">;</span>&nbsp;<span class="ident" id="2545292">i</span>&nbsp;<span class="op" id="2545294">&lt;</span>&nbsp;<span class="num" id="2545296">2</span><span class="op" id="2545297">;</span>&nbsp;<span class="ident" id="2545299">i</span><span class="op" id="2545300">++</span>&nbsp;<span class="op" id="2545303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545307">tv</span><span class="op" id="2545309">[</span><span class="ident" id="2545310">i</span><span class="op" id="2545311">]</span><span class="op" id="2545312">.</span><span class="ident" id="2545313">Sec</span>&nbsp;<span class="op" id="2545317">=</span>&nbsp;<span class="ident" id="2545319">ts</span><span class="op" id="2545321">[</span><span class="ident" id="2545322">i</span><span class="op" id="2545323">]</span><span class="op" id="2545324">.</span><span class="ident" id="2545325">Sec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545331">tv</span><span class="op" id="2545333">[</span><span class="ident" id="2545334">i</span><span class="op" id="2545335">]</span><span class="op" id="2545336">.</span><span class="ident" id="2545337">Usec</span>&nbsp;<span class="op" id="2545342">=</span>&nbsp;<span class="ident" id="2545344">ts</span><span class="op" id="2545346">[</span><span class="ident" id="2545347">i</span><span class="op" id="2545348">]</span><span class="op" id="2545349">.</span><span class="ident" id="2545350">Nsec</span>&nbsp;<span class="op" id="2545355">/</span>&nbsp;<span class="num" id="2545357">1000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2545363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545366">return</span>&nbsp;<span class="ident" id="2545373">utimes</span><span class="op" id="2545379">(</span><span class="ident" id="2545380">path</span><span class="op" id="2545384">,</span>&nbsp;<span class="op" id="2545386">(</span><span class="op" id="2545387">*</span><span class="op" id="2545388">[</span><span class="num" id="2545389">2</span><span class="op" id="2545390">]</span><span class="ident" id="2545391">Timeval</span><span class="op" id="2545398">)</span><span class="op" id="2545399">(</span><span class="ident" id="2545400">unsafe</span><span class="op" id="2545406">.</span><span class="ident" id="2545407">Pointer</span><span class="op" id="2545414">(</span><span class="op" id="2545415">&amp;</span><span class="ident" id="2545416">tv</span><span class="op" id="2545418">[</span><span class="num" id="2545419">0</span><span class="op" id="2545420">]</span><span class="op" id="2545421">)</span><span class="op" id="2545422">)</span><span class="op" id="2545423">)</span><br>
<span class="lineno">85</span><span class="op" id="2545425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2545428">//sys&nbsp;&nbsp;&nbsp;&nbspfutimesat(dirfd&nbsp;int,&nbsp;path&nbsp;*byte,&nbsp;times&nbsp;*[2]Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2545499">func</span>&nbsp;<span class="ident" id="2545504">Futimesat</span><span class="op" id="2545513">(</span><span class="ident" id="2545514">dirfd</span>&nbsp;<span class="builtintype" id="2545520">int</span><span class="op" id="2545523">,</span>&nbsp;<span class="ident" id="2545525">path</span>&nbsp;<span class="builtintype" id="2545530">string</span><span class="op" id="2545536">,</span>&nbsp;<span class="ident" id="2545538">tv</span>&nbsp;<span class="op" id="2545541">[</span><span class="op" id="2545542">]</span><span class="ident" id="2545543">Timeval</span><span class="op" id="2545550">)</span>&nbsp;<span class="op" id="2545552">(</span><span class="ident" id="2545553">err</span>&nbsp;<span class="builtintype" id="2545557">error</span><span class="op" id="2545562">)</span>&nbsp;<span class="op" id="2545564">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545567">if</span>&nbsp;<span class="builtinfunc" id="2545570">len</span><span class="op" id="2545573">(</span><span class="ident" id="2545574">tv</span><span class="op" id="2545576">)</span>&nbsp;<span class="op" id="2545578">!=</span>&nbsp;<span class="num" id="2545581">2</span>&nbsp;<span class="op" id="2545583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545587">return</span>&nbsp;<span class="ident" id="2545594">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2545602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545605">pathp</span><span class="op" id="2545610">,</span>&nbsp;<span class="ident" id="2545612">err</span>&nbsp;<span class="op" id="2545616">:=</span>&nbsp;<span class="ident" id="2545619">BytePtrFromString</span><span class="op" id="2545636">(</span><span class="ident" id="2545637">path</span><span class="op" id="2545641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545644">if</span>&nbsp;<span class="ident" id="2545647">err</span>&nbsp;<span class="op" id="2545651">!=</span>&nbsp;<span class="ident" id="2545654">nil</span>&nbsp;<span class="op" id="2545658">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545662">return</span>&nbsp;<span class="ident" id="2545669">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2545674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545677">err</span>&nbsp;<span class="op" id="2545681">=</span>&nbsp;<span class="ident" id="2545683">futimesat</span><span class="op" id="2545692">(</span><span class="ident" id="2545693">dirfd</span><span class="op" id="2545698">,</span>&nbsp;<span class="ident" id="2545700">pathp</span><span class="op" id="2545705">,</span>&nbsp;<span class="op" id="2545707">(</span><span class="op" id="2545708">*</span><span class="op" id="2545709">[</span><span class="num" id="2545710">2</span><span class="op" id="2545711">]</span><span class="ident" id="2545712">Timeval</span><span class="op" id="2545719">)</span><span class="op" id="2545720">(</span><span class="ident" id="2545721">unsafe</span><span class="op" id="2545727">.</span><span class="ident" id="2545728">Pointer</span><span class="op" id="2545735">(</span><span class="op" id="2545736">&amp;</span><span class="ident" id="2545737">tv</span><span class="op" id="2545739">[</span><span class="num" id="2545740">0</span><span class="op" id="2545741">]</span><span class="op" id="2545742">)</span><span class="op" id="2545743">)</span><span class="op" id="2545744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545747">use</span><span class="op" id="2545750">(</span><span class="ident" id="2545751">unsafe</span><span class="op" id="2545757">.</span><span class="ident" id="2545758">Pointer</span><span class="op" id="2545765">(</span><span class="ident" id="2545766">pathp</span><span class="op" id="2545771">)</span><span class="op" id="2545772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545775">return</span>&nbsp;<span class="ident" id="2545782">err</span><br>
<span class="lineno">100</span><span class="op" id="2545786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2545789">func</span>&nbsp;<span class="ident" id="2545794">Futimes</span><span class="op" id="2545801">(</span><span class="ident" id="2545802">fd</span>&nbsp;<span class="builtintype" id="2545805">int</span><span class="op" id="2545808">,</span>&nbsp;<span class="ident" id="2545810">tv</span>&nbsp;<span class="op" id="2545813">[</span><span class="op" id="2545814">]</span><span class="ident" id="2545815">Timeval</span><span class="op" id="2545822">)</span>&nbsp;<span class="op" id="2545824">(</span><span class="ident" id="2545825">err</span>&nbsp;<span class="builtintype" id="2545829">error</span><span class="op" id="2545834">)</span>&nbsp;<span class="op" id="2545836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2545839">//&nbsp;Believe&nbsp;it&nbsp;or&nbsp;not,&nbsp;this&nbsp;is&nbsp;the&nbsp;best&nbsp;we&nbsp;can&nbsp;do&nbsp;on&nbsp;Linux</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2545898">//&nbsp;(and&nbsp;is&nbsp;what&nbsp;glibc&nbsp;does).</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545928">return</span>&nbsp;<span class="ident" id="2545935">Utimes</span><span class="op" id="2545941">(</span><span class="string" id="2545942">&#34;/proc/self/fd/&#34;</span><span class="op" id="2545958">+</span><span class="ident" id="2545959">itoa</span><span class="op" id="2545963">(</span><span class="ident" id="2545964">fd</span><span class="op" id="2545966">)</span><span class="op" id="2545967">,</span>&nbsp;<span class="ident" id="2545969">tv</span><span class="op" id="2545971">)</span><br>
<span class="lineno"></span><span class="op" id="2545973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2545976">const</span>&nbsp;<span class="ident" id="2545982">ImplementsGetwd</span>&nbsp;<span class="op" id="2545998">=</span>&nbsp;<span class="builtintype" id="2546000">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="2546006">//sys&nbsp;&nbsp;&nbsp;&nbspGetcwd(buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2546051">func</span>&nbsp;<span class="ident" id="2546056">Getwd</span><span class="op" id="2546061">(</span><span class="op" id="2546062">)</span>&nbsp;<span class="op" id="2546064">(</span><span class="ident" id="2546065">wd</span>&nbsp;<span class="builtintype" id="2546068">string</span><span class="op" id="2546074">,</span>&nbsp;<span class="ident" id="2546076">err</span>&nbsp;<span class="builtintype" id="2546080">error</span><span class="op" id="2546085">)</span>&nbsp;<span class="op" id="2546087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546090">var</span>&nbsp;<span class="ident" id="2546094">buf</span>&nbsp;<span class="op" id="2546098">[</span><span class="ident" id="2546099">PathMax</span><span class="op" id="2546106">]</span><span class="builtintype" id="2546107">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546113">n</span><span class="op" id="2546114">,</span>&nbsp;<span class="ident" id="2546116">err</span>&nbsp;<span class="op" id="2546120">:=</span>&nbsp;<span class="ident" id="2546123">Getcwd</span><span class="op" id="2546129">(</span><span class="ident" id="2546130">buf</span><span class="op" id="2546133">[</span><span class="num" id="2546134">0</span><span class="op" id="2546135">:</span><span class="op" id="2546136">]</span><span class="op" id="2546137">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546140">if</span>&nbsp;<span class="ident" id="2546143">err</span>&nbsp;<span class="op" id="2546147">!=</span>&nbsp;<span class="ident" id="2546150">nil</span>&nbsp;<span class="op" id="2546154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546158">return</span>&nbsp;<span class="string" id="2546165">&#34;&#34;</span><span class="op" id="2546167">,</span>&nbsp;<span class="ident" id="2546169">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2546174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2546177">//&nbsp;Getcwd&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written&nbsp;to&nbsp;buf,&nbsp;including&nbsp;the&nbsp;NUL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546251">if</span>&nbsp;<span class="ident" id="2546254">n</span>&nbsp;<span class="op" id="2546256">&lt;</span>&nbsp;<span class="num" id="2546258">1</span>&nbsp;<span class="op" id="2546260">||</span>&nbsp;<span class="ident" id="2546263">n</span>&nbsp;<span class="op" id="2546265">&gt;</span>&nbsp;<span class="builtinfunc" id="2546267">len</span><span class="op" id="2546270">(</span><span class="ident" id="2546271">buf</span><span class="op" id="2546274">)</span>&nbsp;<span class="op" id="2546276">||</span>&nbsp;<span class="ident" id="2546279">buf</span><span class="op" id="2546282">[</span><span class="ident" id="2546283">n</span><span class="op" id="2546284">-</span><span class="num" id="2546285">1</span><span class="op" id="2546286">]</span>&nbsp;<span class="op" id="2546288">!=</span>&nbsp;<span class="num" id="2546291">0</span>&nbsp;<span class="op" id="2546293">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546297">return</span>&nbsp;<span class="string" id="2546304">&#34;&#34;</span><span class="op" id="2546306">,</span>&nbsp;<span class="ident" id="2546308">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2546316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546319">return</span>&nbsp;<span class="builtintype" id="2546326">string</span><span class="op" id="2546332">(</span><span class="ident" id="2546333">buf</span><span class="op" id="2546336">[</span><span class="num" id="2546337">0</span>&nbsp;<span class="op" id="2546339">:</span>&nbsp;<span class="ident" id="2546341">n</span><span class="op" id="2546342">-</span><span class="num" id="2546343">1</span><span class="op" id="2546344">]</span><span class="op" id="2546345">)</span><span class="op" id="2546346">,</span>&nbsp;<span class="ident" id="2546348">nil</span><br>
<span class="lineno"></span><span class="op" id="2546352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="2546355">func</span>&nbsp;<span class="ident" id="2546360">Getgroups</span><span class="op" id="2546369">(</span><span class="op" id="2546370">)</span>&nbsp;<span class="op" id="2546372">(</span><span class="ident" id="2546373">gids</span>&nbsp;<span class="op" id="2546378">[</span><span class="op" id="2546379">]</span><span class="builtintype" id="2546380">int</span><span class="op" id="2546383">,</span>&nbsp;<span class="ident" id="2546385">err</span>&nbsp;<span class="builtintype" id="2546389">error</span><span class="op" id="2546394">)</span>&nbsp;<span class="op" id="2546396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546399">n</span><span class="op" id="2546400">,</span>&nbsp;<span class="ident" id="2546402">err</span>&nbsp;<span class="op" id="2546406">:=</span>&nbsp;<span class="ident" id="2546409">getgroups</span><span class="op" id="2546418">(</span><span class="num" id="2546419">0</span><span class="op" id="2546420">,</span>&nbsp;<span class="ident" id="2546422">nil</span><span class="op" id="2546425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546428">if</span>&nbsp;<span class="ident" id="2546431">err</span>&nbsp;<span class="op" id="2546435">!=</span>&nbsp;<span class="ident" id="2546438">nil</span>&nbsp;<span class="op" id="2546442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546446">return</span>&nbsp;<span class="ident" id="2546453">nil</span><span class="op" id="2546456">,</span>&nbsp;<span class="ident" id="2546458">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2546463">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546466">if</span>&nbsp;<span class="ident" id="2546469">n</span>&nbsp;<span class="op" id="2546471">==</span>&nbsp;<span class="num" id="2546474">0</span>&nbsp;<span class="op" id="2546476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546480">return</span>&nbsp;<span class="ident" id="2546487">nil</span><span class="op" id="2546490">,</span>&nbsp;<span class="ident" id="2546492">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2546497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2546501">//&nbsp;Sanity&nbsp;check&nbsp;group&nbsp;count.&nbsp;&nbsp;Max&nbsp;is&nbsp;1&lt;&lt;16&nbsp;on&nbsp;Linux.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546555">if</span>&nbsp;<span class="ident" id="2546558">n</span>&nbsp;<span class="op" id="2546560">&lt;</span>&nbsp;<span class="num" id="2546562">0</span>&nbsp;<span class="op" id="2546564">||</span>&nbsp;<span class="ident" id="2546567">n</span>&nbsp;<span class="op" id="2546569">&gt;</span>&nbsp;<span class="num" id="2546571">1</span><span class="op" id="2546572">&lt;&lt;</span><span class="num" id="2546574">20</span>&nbsp;<span class="op" id="2546577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546581">return</span>&nbsp;<span class="ident" id="2546588">nil</span><span class="op" id="2546591">,</span>&nbsp;<span class="ident" id="2546593">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2546601">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546605">a</span>&nbsp;<span class="op" id="2546607">:=</span>&nbsp;<span class="builtinfunc" id="2546610">make</span><span class="op" id="2546614">(</span><span class="op" id="2546615">[</span><span class="op" id="2546616">]</span><span class="ident" id="2546617">_Gid_t</span><span class="op" id="2546623">,</span>&nbsp;<span class="ident" id="2546625">n</span><span class="op" id="2546626">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546629">n</span><span class="op" id="2546630">,</span>&nbsp;<span class="ident" id="2546632">err</span>&nbsp;<span class="op" id="2546636">=</span>&nbsp;<span class="ident" id="2546638">getgroups</span><span class="op" id="2546647">(</span><span class="ident" id="2546648">n</span><span class="op" id="2546649">,</span>&nbsp;<span class="op" id="2546651">&amp;</span><span class="ident" id="2546652">a</span><span class="op" id="2546653">[</span><span class="num" id="2546654">0</span><span class="op" id="2546655">]</span><span class="op" id="2546656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546659">if</span>&nbsp;<span class="ident" id="2546662">err</span>&nbsp;<span class="op" id="2546666">!=</span>&nbsp;<span class="ident" id="2546669">nil</span>&nbsp;<span class="op" id="2546673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546677">return</span>&nbsp;<span class="ident" id="2546684">nil</span><span class="op" id="2546687">,</span>&nbsp;<span class="ident" id="2546689">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2546694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546697">gids</span>&nbsp;<span class="op" id="2546702">=</span>&nbsp;<span class="builtinfunc" id="2546704">make</span><span class="op" id="2546708">(</span><span class="op" id="2546709">[</span><span class="op" id="2546710">]</span><span class="builtintype" id="2546711">int</span><span class="op" id="2546714">,</span>&nbsp;<span class="ident" id="2546716">n</span><span class="op" id="2546717">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546720">for</span>&nbsp;<span class="ident" id="2546724">i</span><span class="op" id="2546725">,</span>&nbsp;<span class="ident" id="2546727">v</span>&nbsp;<span class="op" id="2546729">:=</span>&nbsp;<span class="keyword" id="2546732">range</span>&nbsp;<span class="ident" id="2546738">a</span><span class="op" id="2546739">[</span><span class="num" id="2546740">0</span><span class="op" id="2546741">:</span><span class="ident" id="2546742">n</span><span class="op" id="2546743">]</span>&nbsp;<span class="op" id="2546745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546749">gids</span><span class="op" id="2546753">[</span><span class="ident" id="2546754">i</span><span class="op" id="2546755">]</span>&nbsp;<span class="op" id="2546757">=</span>&nbsp;<span class="builtintype" id="2546759">int</span><span class="op" id="2546762">(</span><span class="ident" id="2546763">v</span><span class="op" id="2546764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2546767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546770">return</span><br>
<span class="lineno"></span><span class="op" id="2546777">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="2546780">func</span>&nbsp;<span class="ident" id="2546785">Setgroups</span><span class="op" id="2546794">(</span><span class="ident" id="2546795">gids</span>&nbsp;<span class="op" id="2546800">[</span><span class="op" id="2546801">]</span><span class="builtintype" id="2546802">int</span><span class="op" id="2546805">)</span>&nbsp;<span class="op" id="2546807">(</span><span class="ident" id="2546808">err</span>&nbsp;<span class="builtintype" id="2546812">error</span><span class="op" id="2546817">)</span>&nbsp;<span class="op" id="2546819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546822">if</span>&nbsp;<span class="builtinfunc" id="2546825">len</span><span class="op" id="2546828">(</span><span class="ident" id="2546829">gids</span><span class="op" id="2546833">)</span>&nbsp;<span class="op" id="2546835">==</span>&nbsp;<span class="num" id="2546838">0</span>&nbsp;<span class="op" id="2546840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546844">return</span>&nbsp;<span class="ident" id="2546851">setgroups</span><span class="op" id="2546860">(</span><span class="num" id="2546861">0</span><span class="op" id="2546862">,</span>&nbsp;<span class="ident" id="2546864">nil</span><span class="op" id="2546867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2546870">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546874">a</span>&nbsp;<span class="op" id="2546876">:=</span>&nbsp;<span class="builtinfunc" id="2546879">make</span><span class="op" id="2546883">(</span><span class="op" id="2546884">[</span><span class="op" id="2546885">]</span><span class="ident" id="2546886">_Gid_t</span><span class="op" id="2546892">,</span>&nbsp;<span class="builtinfunc" id="2546894">len</span><span class="op" id="2546897">(</span><span class="ident" id="2546898">gids</span><span class="op" id="2546902">)</span><span class="op" id="2546903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546906">for</span>&nbsp;<span class="ident" id="2546910">i</span><span class="op" id="2546911">,</span>&nbsp;<span class="ident" id="2546913">v</span>&nbsp;<span class="op" id="2546915">:=</span>&nbsp;<span class="keyword" id="2546918">range</span>&nbsp;<span class="ident" id="2546924">gids</span>&nbsp;<span class="op" id="2546929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546933">a</span><span class="op" id="2546934">[</span><span class="ident" id="2546935">i</span><span class="op" id="2546936">]</span>&nbsp;<span class="op" id="2546938">=</span>&nbsp;<span class="ident" id="2546940">_Gid_t</span><span class="op" id="2546946">(</span><span class="ident" id="2546947">v</span><span class="op" id="2546948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2546951">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546954">return</span>&nbsp;<span class="ident" id="2546961">setgroups</span><span class="op" id="2546970">(</span><span class="builtinfunc" id="2546971">len</span><span class="op" id="2546974">(</span><span class="ident" id="2546975">a</span><span class="op" id="2546976">)</span><span class="op" id="2546977">,</span>&nbsp;<span class="op" id="2546979">&amp;</span><span class="ident" id="2546980">a</span><span class="op" id="2546981">[</span><span class="num" id="2546982">0</span><span class="op" id="2546983">]</span><span class="op" id="2546984">)</span><br>
<span class="lineno"></span><span class="op" id="2546986">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2546989">type</span>&nbsp;<span class="ident" id="2546994">WaitStatus</span>&nbsp;<span class="builtintype" id="2547005">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="2547013">//&nbsp;Wait&nbsp;status&nbsp;is&nbsp;7&nbsp;bits&nbsp;at&nbsp;bottom,&nbsp;either&nbsp;0&nbsp;(exited),</span><br>
<span class="lineno"></span><span class="comment" id="2547068">//&nbsp;0x7F&nbsp;(stopped),&nbsp;or&nbsp;a&nbsp;signal&nbsp;number&nbsp;that&nbsp;caused&nbsp;an&nbsp;exit.</span><br>
<span class="lineno"></span><span class="comment" id="2547127">//&nbsp;The&nbsp;0x80&nbsp;bit&nbsp;is&nbsp;whether&nbsp;there&nbsp;was&nbsp;a&nbsp;core&nbsp;dump.</span><br>
<span class="lineno"></span><span class="comment" id="2547177">//&nbsp;An&nbsp;extra&nbsp;number&nbsp;(exit&nbsp;code,&nbsp;signal&nbsp;causing&nbsp;a&nbsp;stop)</span><br>
<span class="lineno"></span><span class="comment" id="2547231">//&nbsp;is&nbsp;in&nbsp;the&nbsp;high&nbsp;bits.&nbsp;&nbsp;At&nbsp;least&nbsp;that&#39;s&nbsp;the&nbsp;idea.</span><br>
<span class="lineno">170</span><span class="comment" id="2547282">//&nbsp;There&nbsp;are&nbsp;various&nbsp;irregularities.&nbsp;&nbsp;For&nbsp;example,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2547337">//&nbsp;&#34;continued&#34;&nbsp;status&nbsp;is&nbsp;0xFFFF,&nbsp;distinguishing&nbsp;itself</span><br>
<span class="lineno"></span><span class="comment" id="2547392">//&nbsp;from&nbsp;stopped&nbsp;via&nbsp;the&nbsp;core&nbsp;dump&nbsp;bit.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2547432">const</span>&nbsp;<span class="op" id="2547438">(</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547441">mask</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2547449">=</span>&nbsp;<span class="num" id="2547451">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547457">core</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2547465">=</span>&nbsp;<span class="num" id="2547467">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547473">exited</span>&nbsp;&nbsp;<span class="op" id="2547481">=</span>&nbsp;<span class="num" id="2547483">0x00</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547489">stopped</span>&nbsp;<span class="op" id="2547497">=</span>&nbsp;<span class="num" id="2547499">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547505">shift</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2547513">=</span>&nbsp;<span class="num" id="2547515">8</span><br>
<span class="lineno">180</span><span class="op" id="2547517">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2547520">func</span>&nbsp;<span class="op" id="2547525">(</span><span class="ident" id="2547526">w</span>&nbsp;<span class="ident" id="2547528">WaitStatus</span><span class="op" id="2547538">)</span>&nbsp;<span class="ident" id="2547540">Exited</span><span class="op" id="2547546">(</span><span class="op" id="2547547">)</span>&nbsp;<span class="builtintype" id="2547549">bool</span>&nbsp;<span class="op" id="2547554">{</span>&nbsp;<span class="keyword" id="2547556">return</span>&nbsp;<span class="ident" id="2547563">w</span><span class="op" id="2547564">&amp;</span><span class="ident" id="2547565">mask</span>&nbsp;<span class="op" id="2547570">==</span>&nbsp;<span class="ident" id="2547573">exited</span>&nbsp;<span class="op" id="2547580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2547583">func</span>&nbsp;<span class="op" id="2547588">(</span><span class="ident" id="2547589">w</span>&nbsp;<span class="ident" id="2547591">WaitStatus</span><span class="op" id="2547601">)</span>&nbsp;<span class="ident" id="2547603">Signaled</span><span class="op" id="2547611">(</span><span class="op" id="2547612">)</span>&nbsp;<span class="builtintype" id="2547614">bool</span>&nbsp;<span class="op" id="2547619">{</span>&nbsp;<span class="keyword" id="2547621">return</span>&nbsp;<span class="ident" id="2547628">w</span><span class="op" id="2547629">&amp;</span><span class="ident" id="2547630">mask</span>&nbsp;<span class="op" id="2547635">!=</span>&nbsp;<span class="ident" id="2547638">stopped</span>&nbsp;<span class="op" id="2547646">&amp;&amp;</span>&nbsp;<span class="ident" id="2547649">w</span><span class="op" id="2547650">&amp;</span><span class="ident" id="2547651">mask</span>&nbsp;<span class="op" id="2547656">!=</span>&nbsp;<span class="ident" id="2547659">exited</span>&nbsp;<span class="op" id="2547666">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="2547669">func</span>&nbsp;<span class="op" id="2547674">(</span><span class="ident" id="2547675">w</span>&nbsp;<span class="ident" id="2547677">WaitStatus</span><span class="op" id="2547687">)</span>&nbsp;<span class="ident" id="2547689">Stopped</span><span class="op" id="2547696">(</span><span class="op" id="2547697">)</span>&nbsp;<span class="builtintype" id="2547699">bool</span>&nbsp;<span class="op" id="2547704">{</span>&nbsp;<span class="keyword" id="2547706">return</span>&nbsp;<span class="ident" id="2547713">w</span><span class="op" id="2547714">&amp;</span><span class="num" id="2547715">0xFF</span>&nbsp;<span class="op" id="2547720">==</span>&nbsp;<span class="ident" id="2547723">stopped</span>&nbsp;<span class="op" id="2547731">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2547734">func</span>&nbsp;<span class="op" id="2547739">(</span><span class="ident" id="2547740">w</span>&nbsp;<span class="ident" id="2547742">WaitStatus</span><span class="op" id="2547752">)</span>&nbsp;<span class="ident" id="2547754">Continued</span><span class="op" id="2547763">(</span><span class="op" id="2547764">)</span>&nbsp;<span class="builtintype" id="2547766">bool</span>&nbsp;<span class="op" id="2547771">{</span>&nbsp;<span class="keyword" id="2547773">return</span>&nbsp;<span class="ident" id="2547780">w</span>&nbsp;<span class="op" id="2547782">==</span>&nbsp;<span class="num" id="2547785">0xFFFF</span>&nbsp;<span class="op" id="2547792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="2547795">func</span>&nbsp;<span class="op" id="2547800">(</span><span class="ident" id="2547801">w</span>&nbsp;<span class="ident" id="2547803">WaitStatus</span><span class="op" id="2547813">)</span>&nbsp;<span class="ident" id="2547815">CoreDump</span><span class="op" id="2547823">(</span><span class="op" id="2547824">)</span>&nbsp;<span class="builtintype" id="2547826">bool</span>&nbsp;<span class="op" id="2547831">{</span>&nbsp;<span class="keyword" id="2547833">return</span>&nbsp;<span class="ident" id="2547840">w</span><span class="op" id="2547841">.</span><span class="ident" id="2547842">Signaled</span><span class="op" id="2547850">(</span><span class="op" id="2547851">)</span>&nbsp;<span class="op" id="2547853">&amp;&amp;</span>&nbsp;<span class="ident" id="2547856">w</span><span class="op" id="2547857">&amp;</span><span class="ident" id="2547858">core</span>&nbsp;<span class="op" id="2547863">!=</span>&nbsp;<span class="num" id="2547866">0</span>&nbsp;<span class="op" id="2547868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2547871">func</span>&nbsp;<span class="op" id="2547876">(</span><span class="ident" id="2547877">w</span>&nbsp;<span class="ident" id="2547879">WaitStatus</span><span class="op" id="2547889">)</span>&nbsp;<span class="ident" id="2547891">ExitStatus</span><span class="op" id="2547901">(</span><span class="op" id="2547902">)</span>&nbsp;<span class="builtintype" id="2547904">int</span>&nbsp;<span class="op" id="2547908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2547911">if</span>&nbsp;<span class="op" id="2547914">!</span><span class="ident" id="2547915">w</span><span class="op" id="2547916">.</span><span class="ident" id="2547917">Exited</span><span class="op" id="2547923">(</span><span class="op" id="2547924">)</span>&nbsp;<span class="op" id="2547926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2547930">return</span>&nbsp;<span class="op" id="2547937">-</span><span class="num" id="2547938">1</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2547941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2547944">return</span>&nbsp;<span class="builtintype" id="2547951">int</span><span class="op" id="2547954">(</span><span class="ident" id="2547955">w</span><span class="op" id="2547956">&gt;&gt;</span><span class="ident" id="2547958">shift</span><span class="op" id="2547963">)</span>&nbsp;<span class="op" id="2547965">&amp;</span>&nbsp;<span class="num" id="2547967">0xFF</span><br>
<span class="lineno"></span><span class="op" id="2547972">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2547975">func</span>&nbsp;<span class="op" id="2547980">(</span><span class="ident" id="2547981">w</span>&nbsp;<span class="ident" id="2547983">WaitStatus</span><span class="op" id="2547993">)</span>&nbsp;<span class="ident" id="2547995">Signal</span><span class="op" id="2548001">(</span><span class="op" id="2548002">)</span>&nbsp;<span class="ident" id="2548004">Signal</span>&nbsp;<span class="op" id="2548011">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2548014">if</span>&nbsp;<span class="op" id="2548017">!</span><span class="ident" id="2548018">w</span><span class="op" id="2548019">.</span><span class="ident" id="2548020">Signaled</span><span class="op" id="2548028">(</span><span class="op" id="2548029">)</span>&nbsp;<span class="op" id="2548031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2548035">return</span>&nbsp;<span class="op" id="2548042">-</span><span class="num" id="2548043">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2548046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2548049">return</span>&nbsp;<span class="ident" id="2548056">Signal</span><span class="op" id="2548062">(</span><span class="ident" id="2548063">w</span>&nbsp;<span class="op" id="2548065">&amp;</span>&nbsp;<span class="ident" id="2548067">mask</span><span class="op" id="2548071">)</span><br>
<span class="lineno"></span><span class="op" id="2548073">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="2548076">func</span>&nbsp;<span class="op" id="2548081">(</span><span class="ident" id="2548082">w</span>&nbsp;<span class="ident" id="2548084">WaitStatus</span><span class="op" id="2548094">)</span>&nbsp;<span class="ident" id="2548096">StopSignal</span><span class="op" id="2548106">(</span><span class="op" id="2548107">)</span>&nbsp;<span class="ident" id="2548109">Signal</span>&nbsp;<span class="op" id="2548116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2548119">if</span>&nbsp;<span class="op" id="2548122">!</span><span class="ident" id="2548123">w</span><span class="op" id="2548124">.</span><span class="ident" id="2548125">Stopped</span><span class="op" id="2548132">(</span><span class="op" id="2548133">)</span>&nbsp;<span class="op" id="2548135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2548139">return</span>&nbsp;<span class="op" id="2548146">-</span><span class="num" id="2548147">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2548150">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2548153">return</span>&nbsp;<span class="ident" id="2548160">Signal</span><span class="op" id="2548166">(</span><span class="ident" id="2548167">w</span><span class="op" id="2548168">&gt;&gt;</span><span class="ident" id="2548170">shift</span><span class="op" id="2548175">)</span>&nbsp;<span class="op" id="2548177">&amp;</span>&nbsp;<span class="num" id="2548179">0xFF</span><br>
<span class="lineno"></span><span class="op" id="2548184">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2548187">func</span>&nbsp;<span class="op" id="2548192">(</span><span class="ident" id="2548193">w</span>&nbsp;<span class="ident" id="2548195">WaitStatus</span><span class="op" id="2548205">)</span>&nbsp;<span class="ident" id="2548207">TrapCause</span><span class="op" id="2548216">(</span><span class="op" id="2548217">)</span>&nbsp;<span class="builtintype" id="2548219">int</span>&nbsp;<span class="op" id="2548223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2548226">if</span>&nbsp;<span class="ident" id="2548229">w</span><span class="op" id="2548230">.</span><span class="ident" id="2548231">StopSignal</span><span class="op" id="2548241">(</span><span class="op" id="2548242">)</span>&nbsp;<span class="op" id="2548244">!=</span>&nbsp;<span class="ident" id="2548247">SIGTRAP</span>&nbsp;<span class="op" id="2548255">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2548259">return</span>&nbsp;<span class="op" id="2548266">-</span><span class="num" id="2548267">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2548270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2548273">return</span>&nbsp;<span class="builtintype" id="2548280">int</span><span class="op" id="2548283">(</span><span class="ident" id="2548284">w</span><span class="op" id="2548285">&gt;&gt;</span><span class="ident" id="2548287">shift</span><span class="op" id="2548292">)</span>&nbsp;<span class="op" id="2548294">&gt;&gt;</span>&nbsp;<span class="num" id="2548297">8</span><br>
<span class="lineno"></span><span class="op" id="2548299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="2548302">//sys&nbsp;&nbsp;&nbsp;&nbspwait4(pid&nbsp;int,&nbsp;wstatus&nbsp;*_C_int,&nbsp;options&nbsp;int,&nbsp;rusage&nbsp;*Rusage)&nbsp;(wpid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2548392">func</span>&nbsp;<span class="ident" id="2548397">Wait4</span><span class="op" id="2548402">(</span><span class="ident" id="2548403">pid</span>&nbsp;<span class="builtintype" id="2548407">int</span><span class="op" id="2548410">,</span>&nbsp;<span class="ident" id="2548412">wstatus</span>&nbsp;<span class="op" id="2548420">*</span><span class="ident" id="2548421">WaitStatus</span><span class="op" id="2548431">,</span>&nbsp;<span class="ident" id="2548433">options</span>&nbsp;<span class="builtintype" id="2548441">int</span><span class="op" id="2548444">,</span>&nbsp;<span class="ident" id="2548446">rusage</span>&nbsp;<span class="op" id="2548453">*</span><span class="ident" id="2548454">Rusage</span><span class="op" id="2548460">)</span>&nbsp;<span class="op" id="2548462">(</span><span class="ident" id="2548463">wpid</span>&nbsp;<span class="builtintype" id="2548468">int</span><span class="op" id="2548471">,</span>&nbsp;<span class="ident" id="2548473">err</span>&nbsp;<span class="builtintype" id="2548477">error</span><span class="op" id="2548482">)</span>&nbsp;<span class="op" id="2548484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2548487">var</span>&nbsp;<span class="ident" id="2548491">status</span>&nbsp;<span class="ident" id="2548498">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548506">wpid</span><span class="op" id="2548510">,</span>&nbsp;<span class="ident" id="2548512">err</span>&nbsp;<span class="op" id="2548516">=</span>&nbsp;<span class="ident" id="2548518">wait4</span><span class="op" id="2548523">(</span><span class="ident" id="2548524">pid</span><span class="op" id="2548527">,</span>&nbsp;<span class="op" id="2548529">&amp;</span><span class="ident" id="2548530">status</span><span class="op" id="2548536">,</span>&nbsp;<span class="ident" id="2548538">options</span><span class="op" id="2548545">,</span>&nbsp;<span class="ident" id="2548547">rusage</span><span class="op" id="2548553">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2548556">if</span>&nbsp;<span class="ident" id="2548559">wstatus</span>&nbsp;<span class="op" id="2548567">!=</span>&nbsp;<span class="ident" id="2548570">nil</span>&nbsp;<span class="op" id="2548574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2548578">*</span><span class="ident" id="2548579">wstatus</span>&nbsp;<span class="op" id="2548587">=</span>&nbsp;<span class="ident" id="2548589">WaitStatus</span><span class="op" id="2548599">(</span><span class="ident" id="2548600">status</span><span class="op" id="2548606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2548609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2548612">return</span><br>
<span class="lineno"></span><span class="op" id="2548619">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="2548622">func</span>&nbsp;<span class="ident" id="2548627">Mkfifo</span><span class="op" id="2548633">(</span><span class="ident" id="2548634">path</span>&nbsp;<span class="builtintype" id="2548639">string</span><span class="op" id="2548645">,</span>&nbsp;<span class="ident" id="2548647">mode</span>&nbsp;<span class="builtintype" id="2548652">uint32</span><span class="op" id="2548658">)</span>&nbsp;<span class="op" id="2548660">(</span><span class="ident" id="2548661">err</span>&nbsp;<span class="builtintype" id="2548665">error</span><span class="op" id="2548670">)</span>&nbsp;<span class="op" id="2548672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2548675">return</span>&nbsp;<span class="ident" id="2548682">Mknod</span><span class="op" id="2548687">(</span><span class="ident" id="2548688">path</span><span class="op" id="2548692">,</span>&nbsp;<span class="ident" id="2548694">mode</span><span class="op" id="2548698">|</span><span class="ident" id="2548699">S_IFIFO</span><span class="op" id="2548706">,</span>&nbsp;<span class="num" id="2548708">0</span><span class="op" id="2548709">)</span><br>
<span class="lineno"></span><span class="op" id="2548711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="2548714">func</span>&nbsp;<span class="op" id="2548719">(</span><span class="ident" id="2548720">sa</span>&nbsp;<span class="op" id="2548723">*</span><span class="ident" id="2548724">SockaddrInet4</span><span class="op" id="2548737">)</span>&nbsp;<span class="ident" id="2548739">sockaddr</span><span class="op" id="2548747">(</span><span class="op" id="2548748">)</span>&nbsp;<span class="op" id="2548750">(</span><span class="ident" id="2548751">unsafe</span><span class="op" id="2548757">.</span><span class="ident" id="2548758">Pointer</span><span class="op" id="2548765">,</span>&nbsp;<span class="ident" id="2548767">_Socklen</span><span class="op" id="2548775">,</span>&nbsp;<span class="builtintype" id="2548777">error</span><span class="op" id="2548782">)</span>&nbsp;<span class="op" id="2548784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2548787">if</span>&nbsp;<span class="ident" id="2548790">sa</span><span class="op" id="2548792">.</span><span class="ident" id="2548793">Port</span>&nbsp;<span class="op" id="2548798">&lt;</span>&nbsp;<span class="num" id="2548800">0</span>&nbsp;<span class="op" id="2548802">||</span>&nbsp;<span class="ident" id="2548805">sa</span><span class="op" id="2548807">.</span><span class="ident" id="2548808">Port</span>&nbsp;<span class="op" id="2548813">&gt;</span>&nbsp;<span class="num" id="2548815">0xFFFF</span>&nbsp;<span class="op" id="2548822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2548826">return</span>&nbsp;<span class="ident" id="2548833">nil</span><span class="op" id="2548836">,</span>&nbsp;<span class="num" id="2548838">0</span><span class="op" id="2548839">,</span>&nbsp;<span class="ident" id="2548841">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2548849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548852">sa</span><span class="op" id="2548854">.</span><span class="ident" id="2548855">raw</span><span class="op" id="2548858">.</span><span class="ident" id="2548859">Family</span>&nbsp;<span class="op" id="2548866">=</span>&nbsp;<span class="ident" id="2548868">AF_INET</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548877">p</span>&nbsp;<span class="op" id="2548879">:=</span>&nbsp;<span class="op" id="2548882">(</span><span class="op" id="2548883">*</span><span class="op" id="2548884">[</span><span class="num" id="2548885">2</span><span class="op" id="2548886">]</span><span class="builtintype" id="2548887">byte</span><span class="op" id="2548891">)</span><span class="op" id="2548892">(</span><span class="ident" id="2548893">unsafe</span><span class="op" id="2548899">.</span><span class="ident" id="2548900">Pointer</span><span class="op" id="2548907">(</span><span class="op" id="2548908">&amp;</span><span class="ident" id="2548909">sa</span><span class="op" id="2548911">.</span><span class="ident" id="2548912">raw</span><span class="op" id="2548915">.</span><span class="ident" id="2548916">Port</span><span class="op" id="2548920">)</span><span class="op" id="2548921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548924">p</span><span class="op" id="2548925">[</span><span class="num" id="2548926">0</span><span class="op" id="2548927">]</span>&nbsp;<span class="op" id="2548929">=</span>&nbsp;<span class="builtintype" id="2548931">byte</span><span class="op" id="2548935">(</span><span class="ident" id="2548936">sa</span><span class="op" id="2548938">.</span><span class="ident" id="2548939">Port</span>&nbsp;<span class="op" id="2548944">&gt;&gt;</span>&nbsp;<span class="num" id="2548947">8</span><span class="op" id="2548948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548951">p</span><span class="op" id="2548952">[</span><span class="num" id="2548953">1</span><span class="op" id="2548954">]</span>&nbsp;<span class="op" id="2548956">=</span>&nbsp;<span class="builtintype" id="2548958">byte</span><span class="op" id="2548962">(</span><span class="ident" id="2548963">sa</span><span class="op" id="2548965">.</span><span class="ident" id="2548966">Port</span><span class="op" id="2548970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2548973">for</span>&nbsp;<span class="ident" id="2548977">i</span>&nbsp;<span class="op" id="2548979">:=</span>&nbsp;<span class="num" id="2548982">0</span><span class="op" id="2548983">;</span>&nbsp;<span class="ident" id="2548985">i</span>&nbsp;<span class="op" id="2548987">&lt;</span>&nbsp;<span class="builtinfunc" id="2548989">len</span><span class="op" id="2548992">(</span><span class="ident" id="2548993">sa</span><span class="op" id="2548995">.</span><span class="ident" id="2548996">Addr</span><span class="op" id="2549000">)</span><span class="op" id="2549001">;</span>&nbsp;<span class="ident" id="2549003">i</span><span class="op" id="2549004">++</span>&nbsp;<span class="op" id="2549007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549011">sa</span><span class="op" id="2549013">.</span><span class="ident" id="2549014">raw</span><span class="op" id="2549017">.</span><span class="ident" id="2549018">Addr</span><span class="op" id="2549022">[</span><span class="ident" id="2549023">i</span><span class="op" id="2549024">]</span>&nbsp;<span class="op" id="2549026">=</span>&nbsp;<span class="ident" id="2549028">sa</span><span class="op" id="2549030">.</span><span class="ident" id="2549031">Addr</span><span class="op" id="2549035">[</span><span class="ident" id="2549036">i</span><span class="op" id="2549037">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2549040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2549043">return</span>&nbsp;<span class="ident" id="2549050">unsafe</span><span class="op" id="2549056">.</span><span class="ident" id="2549057">Pointer</span><span class="op" id="2549064">(</span><span class="op" id="2549065">&amp;</span><span class="ident" id="2549066">sa</span><span class="op" id="2549068">.</span><span class="ident" id="2549069">raw</span><span class="op" id="2549072">)</span><span class="op" id="2549073">,</span>&nbsp;<span class="ident" id="2549075">SizeofSockaddrInet4</span><span class="op" id="2549094">,</span>&nbsp;<span class="ident" id="2549096">nil</span><br>
<span class="lineno"></span><span class="op" id="2549100">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2549103">func</span>&nbsp;<span class="op" id="2549108">(</span><span class="ident" id="2549109">sa</span>&nbsp;<span class="op" id="2549112">*</span><span class="ident" id="2549113">SockaddrInet6</span><span class="op" id="2549126">)</span>&nbsp;<span class="ident" id="2549128">sockaddr</span><span class="op" id="2549136">(</span><span class="op" id="2549137">)</span>&nbsp;<span class="op" id="2549139">(</span><span class="ident" id="2549140">unsafe</span><span class="op" id="2549146">.</span><span class="ident" id="2549147">Pointer</span><span class="op" id="2549154">,</span>&nbsp;<span class="ident" id="2549156">_Socklen</span><span class="op" id="2549164">,</span>&nbsp;<span class="builtintype" id="2549166">error</span><span class="op" id="2549171">)</span>&nbsp;<span class="op" id="2549173">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2549176">if</span>&nbsp;<span class="ident" id="2549179">sa</span><span class="op" id="2549181">.</span><span class="ident" id="2549182">Port</span>&nbsp;<span class="op" id="2549187">&lt;</span>&nbsp;<span class="num" id="2549189">0</span>&nbsp;<span class="op" id="2549191">||</span>&nbsp;<span class="ident" id="2549194">sa</span><span class="op" id="2549196">.</span><span class="ident" id="2549197">Port</span>&nbsp;<span class="op" id="2549202">&gt;</span>&nbsp;<span class="num" id="2549204">0xFFFF</span>&nbsp;<span class="op" id="2549211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2549215">return</span>&nbsp;<span class="ident" id="2549222">nil</span><span class="op" id="2549225">,</span>&nbsp;<span class="num" id="2549227">0</span><span class="op" id="2549228">,</span>&nbsp;<span class="ident" id="2549230">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2549238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549241">sa</span><span class="op" id="2549243">.</span><span class="ident" id="2549244">raw</span><span class="op" id="2549247">.</span><span class="ident" id="2549248">Family</span>&nbsp;<span class="op" id="2549255">=</span>&nbsp;<span class="ident" id="2549257">AF_INET6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549267">p</span>&nbsp;<span class="op" id="2549269">:=</span>&nbsp;<span class="op" id="2549272">(</span><span class="op" id="2549273">*</span><span class="op" id="2549274">[</span><span class="num" id="2549275">2</span><span class="op" id="2549276">]</span><span class="builtintype" id="2549277">byte</span><span class="op" id="2549281">)</span><span class="op" id="2549282">(</span><span class="ident" id="2549283">unsafe</span><span class="op" id="2549289">.</span><span class="ident" id="2549290">Pointer</span><span class="op" id="2549297">(</span><span class="op" id="2549298">&amp;</span><span class="ident" id="2549299">sa</span><span class="op" id="2549301">.</span><span class="ident" id="2549302">raw</span><span class="op" id="2549305">.</span><span class="ident" id="2549306">Port</span><span class="op" id="2549310">)</span><span class="op" id="2549311">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549314">p</span><span class="op" id="2549315">[</span><span class="num" id="2549316">0</span><span class="op" id="2549317">]</span>&nbsp;<span class="op" id="2549319">=</span>&nbsp;<span class="builtintype" id="2549321">byte</span><span class="op" id="2549325">(</span><span class="ident" id="2549326">sa</span><span class="op" id="2549328">.</span><span class="ident" id="2549329">Port</span>&nbsp;<span class="op" id="2549334">&gt;&gt;</span>&nbsp;<span class="num" id="2549337">8</span><span class="op" id="2549338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549341">p</span><span class="op" id="2549342">[</span><span class="num" id="2549343">1</span><span class="op" id="2549344">]</span>&nbsp;<span class="op" id="2549346">=</span>&nbsp;<span class="builtintype" id="2549348">byte</span><span class="op" id="2549352">(</span><span class="ident" id="2549353">sa</span><span class="op" id="2549355">.</span><span class="ident" id="2549356">Port</span><span class="op" id="2549360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549363">sa</span><span class="op" id="2549365">.</span><span class="ident" id="2549366">raw</span><span class="op" id="2549369">.</span><span class="ident" id="2549370">Scope_id</span>&nbsp;<span class="op" id="2549379">=</span>&nbsp;<span class="ident" id="2549381">sa</span><span class="op" id="2549383">.</span><span class="ident" id="2549384">ZoneId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2549392">for</span>&nbsp;<span class="ident" id="2549396">i</span>&nbsp;<span class="op" id="2549398">:=</span>&nbsp;<span class="num" id="2549401">0</span><span class="op" id="2549402">;</span>&nbsp;<span class="ident" id="2549404">i</span>&nbsp;<span class="op" id="2549406">&lt;</span>&nbsp;<span class="builtinfunc" id="2549408">len</span><span class="op" id="2549411">(</span><span class="ident" id="2549412">sa</span><span class="op" id="2549414">.</span><span class="ident" id="2549415">Addr</span><span class="op" id="2549419">)</span><span class="op" id="2549420">;</span>&nbsp;<span class="ident" id="2549422">i</span><span class="op" id="2549423">++</span>&nbsp;<span class="op" id="2549426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549430">sa</span><span class="op" id="2549432">.</span><span class="ident" id="2549433">raw</span><span class="op" id="2549436">.</span><span class="ident" id="2549437">Addr</span><span class="op" id="2549441">[</span><span class="ident" id="2549442">i</span><span class="op" id="2549443">]</span>&nbsp;<span class="op" id="2549445">=</span>&nbsp;<span class="ident" id="2549447">sa</span><span class="op" id="2549449">.</span><span class="ident" id="2549450">Addr</span><span class="op" id="2549454">[</span><span class="ident" id="2549455">i</span><span class="op" id="2549456">]</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2549459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2549462">return</span>&nbsp;<span class="ident" id="2549469">unsafe</span><span class="op" id="2549475">.</span><span class="ident" id="2549476">Pointer</span><span class="op" id="2549483">(</span><span class="op" id="2549484">&amp;</span><span class="ident" id="2549485">sa</span><span class="op" id="2549487">.</span><span class="ident" id="2549488">raw</span><span class="op" id="2549491">)</span><span class="op" id="2549492">,</span>&nbsp;<span class="ident" id="2549494">SizeofSockaddrInet6</span><span class="op" id="2549513">,</span>&nbsp;<span class="ident" id="2549515">nil</span><br>
<span class="lineno"></span><span class="op" id="2549519">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2549522">func</span>&nbsp;<span class="op" id="2549527">(</span><span class="ident" id="2549528">sa</span>&nbsp;<span class="op" id="2549531">*</span><span class="ident" id="2549532">SockaddrUnix</span><span class="op" id="2549544">)</span>&nbsp;<span class="ident" id="2549546">sockaddr</span><span class="op" id="2549554">(</span><span class="op" id="2549555">)</span>&nbsp;<span class="op" id="2549557">(</span><span class="ident" id="2549558">unsafe</span><span class="op" id="2549564">.</span><span class="ident" id="2549565">Pointer</span><span class="op" id="2549572">,</span>&nbsp;<span class="ident" id="2549574">_Socklen</span><span class="op" id="2549582">,</span>&nbsp;<span class="builtintype" id="2549584">error</span><span class="op" id="2549589">)</span>&nbsp;<span class="op" id="2549591">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549594">name</span>&nbsp;<span class="op" id="2549599">:=</span>&nbsp;<span class="ident" id="2549602">sa</span><span class="op" id="2549604">.</span><span class="ident" id="2549605">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549611">n</span>&nbsp;<span class="op" id="2549613">:=</span>&nbsp;<span class="builtinfunc" id="2549616">len</span><span class="op" id="2549619">(</span><span class="ident" id="2549620">name</span><span class="op" id="2549624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2549627">if</span>&nbsp;<span class="ident" id="2549630">n</span>&nbsp;<span class="op" id="2549632">&gt;=</span>&nbsp;<span class="builtinfunc" id="2549635">len</span><span class="op" id="2549638">(</span><span class="ident" id="2549639">sa</span><span class="op" id="2549641">.</span><span class="ident" id="2549642">raw</span><span class="op" id="2549645">.</span><span class="ident" id="2549646">Path</span><span class="op" id="2549650">)</span>&nbsp;<span class="op" id="2549652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2549656">return</span>&nbsp;<span class="ident" id="2549663">nil</span><span class="op" id="2549666">,</span>&nbsp;<span class="num" id="2549668">0</span><span class="op" id="2549669">,</span>&nbsp;<span class="ident" id="2549671">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2549679">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549682">sa</span><span class="op" id="2549684">.</span><span class="ident" id="2549685">raw</span><span class="op" id="2549688">.</span><span class="ident" id="2549689">Family</span>&nbsp;<span class="op" id="2549696">=</span>&nbsp;<span class="ident" id="2549698">AF_UNIX</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2549707">for</span>&nbsp;<span class="ident" id="2549711">i</span>&nbsp;<span class="op" id="2549713">:=</span>&nbsp;<span class="num" id="2549716">0</span><span class="op" id="2549717">;</span>&nbsp;<span class="ident" id="2549719">i</span>&nbsp;<span class="op" id="2549721">&lt;</span>&nbsp;<span class="ident" id="2549723">n</span><span class="op" id="2549724">;</span>&nbsp;<span class="ident" id="2549726">i</span><span class="op" id="2549727">++</span>&nbsp;<span class="op" id="2549730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549734">sa</span><span class="op" id="2549736">.</span><span class="ident" id="2549737">raw</span><span class="op" id="2549740">.</span><span class="ident" id="2549741">Path</span><span class="op" id="2549745">[</span><span class="ident" id="2549746">i</span><span class="op" id="2549747">]</span>&nbsp;<span class="op" id="2549749">=</span>&nbsp;<span class="builtintype" id="2549751">int8</span><span class="op" id="2549755">(</span><span class="ident" id="2549756">name</span><span class="op" id="2549760">[</span><span class="ident" id="2549761">i</span><span class="op" id="2549762">]</span><span class="op" id="2549763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2549766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2549769">//&nbsp;length&nbsp;is&nbsp;family&nbsp;(uint16),&nbsp;name,&nbsp;NUL.</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549811">sl</span>&nbsp;<span class="op" id="2549814">:=</span>&nbsp;<span class="ident" id="2549817">_Socklen</span><span class="op" id="2549825">(</span><span class="num" id="2549826">2</span><span class="op" id="2549827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2549830">if</span>&nbsp;<span class="ident" id="2549833">n</span>&nbsp;<span class="op" id="2549835">&gt;</span>&nbsp;<span class="num" id="2549837">0</span>&nbsp;<span class="op" id="2549839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549843">sl</span>&nbsp;<span class="op" id="2549846">+=</span>&nbsp;<span class="ident" id="2549849">_Socklen</span><span class="op" id="2549857">(</span><span class="ident" id="2549858">n</span><span class="op" id="2549859">)</span>&nbsp;<span class="op" id="2549861">+</span>&nbsp;<span class="num" id="2549863">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2549866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2549869">if</span>&nbsp;<span class="ident" id="2549872">sa</span><span class="op" id="2549874">.</span><span class="ident" id="2549875">raw</span><span class="op" id="2549878">.</span><span class="ident" id="2549879">Path</span><span class="op" id="2549883">[</span><span class="num" id="2549884">0</span><span class="op" id="2549885">]</span>&nbsp;<span class="op" id="2549887">==</span>&nbsp;<span class="string" id="2549890">&#39;@&#39;</span>&nbsp;<span class="op" id="2549894">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549898">sa</span><span class="op" id="2549900">.</span><span class="ident" id="2549901">raw</span><span class="op" id="2549904">.</span><span class="ident" id="2549905">Path</span><span class="op" id="2549909">[</span><span class="num" id="2549910">0</span><span class="op" id="2549911">]</span>&nbsp;<span class="op" id="2549913">=</span>&nbsp;<span class="num" id="2549915">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2549919">//&nbsp;Don&#39;t&nbsp;count&nbsp;trailing&nbsp;NUL&nbsp;for&nbsp;abstract&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2549971">sl</span><span class="op" id="2549973">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2549977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2549981">return</span>&nbsp;<span class="ident" id="2549988">unsafe</span><span class="op" id="2549994">.</span><span class="ident" id="2549995">Pointer</span><span class="op" id="2550002">(</span><span class="op" id="2550003">&amp;</span><span class="ident" id="2550004">sa</span><span class="op" id="2550006">.</span><span class="ident" id="2550007">raw</span><span class="op" id="2550010">)</span><span class="op" id="2550011">,</span>&nbsp;<span class="ident" id="2550013">sl</span><span class="op" id="2550015">,</span>&nbsp;<span class="ident" id="2550017">nil</span><br>
<span class="lineno"></span><span class="op" id="2550021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2550024">type</span>&nbsp;<span class="ident" id="2550029">SockaddrLinklayer</span>&nbsp;<span class="keyword" id="2550047">struct</span>&nbsp;<span class="op" id="2550054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550057">Protocol</span>&nbsp;<span class="builtintype" id="2550066">uint16</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550074">Ifindex</span>&nbsp;&nbsp;<span class="builtintype" id="2550083">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550088">Hatype</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2550097">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550105">Pkttype</span>&nbsp;&nbsp;<span class="builtintype" id="2550114">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550121">Halen</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2550130">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550137">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2550146">[</span><span class="num" id="2550147">8</span><span class="op" id="2550148">]</span><span class="builtintype" id="2550149">byte</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550155">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2550164">RawSockaddrLinklayer</span><br>
<span class="lineno"></span><span class="op" id="2550185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2550188">func</span>&nbsp;<span class="op" id="2550193">(</span><span class="ident" id="2550194">sa</span>&nbsp;<span class="op" id="2550197">*</span><span class="ident" id="2550198">SockaddrLinklayer</span><span class="op" id="2550215">)</span>&nbsp;<span class="ident" id="2550217">sockaddr</span><span class="op" id="2550225">(</span><span class="op" id="2550226">)</span>&nbsp;<span class="op" id="2550228">(</span><span class="ident" id="2550229">unsafe</span><span class="op" id="2550235">.</span><span class="ident" id="2550236">Pointer</span><span class="op" id="2550243">,</span>&nbsp;<span class="ident" id="2550245">_Socklen</span><span class="op" id="2550253">,</span>&nbsp;<span class="builtintype" id="2550255">error</span><span class="op" id="2550260">)</span>&nbsp;<span class="op" id="2550262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2550265">if</span>&nbsp;<span class="ident" id="2550268">sa</span><span class="op" id="2550270">.</span><span class="ident" id="2550271">Ifindex</span>&nbsp;<span class="op" id="2550279">&lt;</span>&nbsp;<span class="num" id="2550281">0</span>&nbsp;<span class="op" id="2550283">||</span>&nbsp;<span class="ident" id="2550286">sa</span><span class="op" id="2550288">.</span><span class="ident" id="2550289">Ifindex</span>&nbsp;<span class="op" id="2550297">&gt;</span>&nbsp;<span class="num" id="2550299">0x7fffffff</span>&nbsp;<span class="op" id="2550310">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2550314">return</span>&nbsp;<span class="ident" id="2550321">nil</span><span class="op" id="2550324">,</span>&nbsp;<span class="num" id="2550326">0</span><span class="op" id="2550327">,</span>&nbsp;<span class="ident" id="2550329">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2550337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550340">sa</span><span class="op" id="2550342">.</span><span class="ident" id="2550343">raw</span><span class="op" id="2550346">.</span><span class="ident" id="2550347">Family</span>&nbsp;<span class="op" id="2550354">=</span>&nbsp;<span class="ident" id="2550356">AF_PACKET</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550367">sa</span><span class="op" id="2550369">.</span><span class="ident" id="2550370">raw</span><span class="op" id="2550373">.</span><span class="ident" id="2550374">Protocol</span>&nbsp;<span class="op" id="2550383">=</span>&nbsp;<span class="ident" id="2550385">sa</span><span class="op" id="2550387">.</span><span class="ident" id="2550388">Protocol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550398">sa</span><span class="op" id="2550400">.</span><span class="ident" id="2550401">raw</span><span class="op" id="2550404">.</span><span class="ident" id="2550405">Ifindex</span>&nbsp;<span class="op" id="2550413">=</span>&nbsp;<span class="builtintype" id="2550415">int32</span><span class="op" id="2550420">(</span><span class="ident" id="2550421">sa</span><span class="op" id="2550423">.</span><span class="ident" id="2550424">Ifindex</span><span class="op" id="2550431">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550434">sa</span><span class="op" id="2550436">.</span><span class="ident" id="2550437">raw</span><span class="op" id="2550440">.</span><span class="ident" id="2550441">Hatype</span>&nbsp;<span class="op" id="2550448">=</span>&nbsp;<span class="ident" id="2550450">sa</span><span class="op" id="2550452">.</span><span class="ident" id="2550453">Hatype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550461">sa</span><span class="op" id="2550463">.</span><span class="ident" id="2550464">raw</span><span class="op" id="2550467">.</span><span class="ident" id="2550468">Pkttype</span>&nbsp;<span class="op" id="2550476">=</span>&nbsp;<span class="ident" id="2550478">sa</span><span class="op" id="2550480">.</span><span class="ident" id="2550481">Pkttype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550490">sa</span><span class="op" id="2550492">.</span><span class="ident" id="2550493">raw</span><span class="op" id="2550496">.</span><span class="ident" id="2550497">Halen</span>&nbsp;<span class="op" id="2550503">=</span>&nbsp;<span class="ident" id="2550505">sa</span><span class="op" id="2550507">.</span><span class="ident" id="2550508">Halen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2550515">for</span>&nbsp;<span class="ident" id="2550519">i</span>&nbsp;<span class="op" id="2550521">:=</span>&nbsp;<span class="num" id="2550524">0</span><span class="op" id="2550525">;</span>&nbsp;<span class="ident" id="2550527">i</span>&nbsp;<span class="op" id="2550529">&lt;</span>&nbsp;<span class="builtinfunc" id="2550531">len</span><span class="op" id="2550534">(</span><span class="ident" id="2550535">sa</span><span class="op" id="2550537">.</span><span class="ident" id="2550538">Addr</span><span class="op" id="2550542">)</span><span class="op" id="2550543">;</span>&nbsp;<span class="ident" id="2550545">i</span><span class="op" id="2550546">++</span>&nbsp;<span class="op" id="2550549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550553">sa</span><span class="op" id="2550555">.</span><span class="ident" id="2550556">raw</span><span class="op" id="2550559">.</span><span class="ident" id="2550560">Addr</span><span class="op" id="2550564">[</span><span class="ident" id="2550565">i</span><span class="op" id="2550566">]</span>&nbsp;<span class="op" id="2550568">=</span>&nbsp;<span class="ident" id="2550570">sa</span><span class="op" id="2550572">.</span><span class="ident" id="2550573">Addr</span><span class="op" id="2550577">[</span><span class="ident" id="2550578">i</span><span class="op" id="2550579">]</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2550582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2550585">return</span>&nbsp;<span class="ident" id="2550592">unsafe</span><span class="op" id="2550598">.</span><span class="ident" id="2550599">Pointer</span><span class="op" id="2550606">(</span><span class="op" id="2550607">&amp;</span><span class="ident" id="2550608">sa</span><span class="op" id="2550610">.</span><span class="ident" id="2550611">raw</span><span class="op" id="2550614">)</span><span class="op" id="2550615">,</span>&nbsp;<span class="ident" id="2550617">SizeofSockaddrLinklayer</span><span class="op" id="2550640">,</span>&nbsp;<span class="ident" id="2550642">nil</span><br>
<span class="lineno"></span><span class="op" id="2550646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2550649">type</span>&nbsp;<span class="ident" id="2550654">SockaddrNetlink</span>&nbsp;<span class="keyword" id="2550670">struct</span>&nbsp;<span class="op" id="2550677">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550680">Family</span>&nbsp;<span class="builtintype" id="2550687">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550695">Pad</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2550702">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550710">Pid</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2550717">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550725">Groups</span>&nbsp;<span class="builtintype" id="2550732">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550740">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2550747">RawSockaddrNetlink</span><br>
<span class="lineno">320</span><span class="op" id="2550766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2550769">func</span>&nbsp;<span class="op" id="2550774">(</span><span class="ident" id="2550775">sa</span>&nbsp;<span class="op" id="2550778">*</span><span class="ident" id="2550779">SockaddrNetlink</span><span class="op" id="2550794">)</span>&nbsp;<span class="ident" id="2550796">sockaddr</span><span class="op" id="2550804">(</span><span class="op" id="2550805">)</span>&nbsp;<span class="op" id="2550807">(</span><span class="ident" id="2550808">unsafe</span><span class="op" id="2550814">.</span><span class="ident" id="2550815">Pointer</span><span class="op" id="2550822">,</span>&nbsp;<span class="ident" id="2550824">_Socklen</span><span class="op" id="2550832">,</span>&nbsp;<span class="builtintype" id="2550834">error</span><span class="op" id="2550839">)</span>&nbsp;<span class="op" id="2550841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550844">sa</span><span class="op" id="2550846">.</span><span class="ident" id="2550847">raw</span><span class="op" id="2550850">.</span><span class="ident" id="2550851">Family</span>&nbsp;<span class="op" id="2550858">=</span>&nbsp;<span class="ident" id="2550860">AF_NETLINK</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550872">sa</span><span class="op" id="2550874">.</span><span class="ident" id="2550875">raw</span><span class="op" id="2550878">.</span><span class="ident" id="2550879">Pad</span>&nbsp;<span class="op" id="2550883">=</span>&nbsp;<span class="ident" id="2550885">sa</span><span class="op" id="2550887">.</span><span class="ident" id="2550888">Pad</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550893">sa</span><span class="op" id="2550895">.</span><span class="ident" id="2550896">raw</span><span class="op" id="2550899">.</span><span class="ident" id="2550900">Pid</span>&nbsp;<span class="op" id="2550904">=</span>&nbsp;<span class="ident" id="2550906">sa</span><span class="op" id="2550908">.</span><span class="ident" id="2550909">Pid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2550914">sa</span><span class="op" id="2550916">.</span><span class="ident" id="2550917">raw</span><span class="op" id="2550920">.</span><span class="ident" id="2550921">Groups</span>&nbsp;<span class="op" id="2550928">=</span>&nbsp;<span class="ident" id="2550930">sa</span><span class="op" id="2550932">.</span><span class="ident" id="2550933">Groups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2550941">return</span>&nbsp;<span class="ident" id="2550948">unsafe</span><span class="op" id="2550954">.</span><span class="ident" id="2550955">Pointer</span><span class="op" id="2550962">(</span><span class="op" id="2550963">&amp;</span><span class="ident" id="2550964">sa</span><span class="op" id="2550966">.</span><span class="ident" id="2550967">raw</span><span class="op" id="2550970">)</span><span class="op" id="2550971">,</span>&nbsp;<span class="ident" id="2550973">SizeofSockaddrNetlink</span><span class="op" id="2550994">,</span>&nbsp;<span class="ident" id="2550996">nil</span><br>
<span class="lineno"></span><span class="op" id="2551000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="2551003">func</span>&nbsp;<span class="ident" id="2551008">anyToSockaddr</span><span class="op" id="2551021">(</span><span class="ident" id="2551022">rsa</span>&nbsp;<span class="op" id="2551026">*</span><span class="ident" id="2551027">RawSockaddrAny</span><span class="op" id="2551041">)</span>&nbsp;<span class="op" id="2551043">(</span><span class="ident" id="2551044">Sockaddr</span><span class="op" id="2551052">,</span>&nbsp;<span class="builtintype" id="2551054">error</span><span class="op" id="2551059">)</span>&nbsp;<span class="op" id="2551061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2551064">switch</span>&nbsp;<span class="ident" id="2551071">rsa</span><span class="op" id="2551074">.</span><span class="ident" id="2551075">Addr</span><span class="op" id="2551079">.</span><span class="ident" id="2551080">Family</span>&nbsp;<span class="op" id="2551087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2551090">case</span>&nbsp;<span class="ident" id="2551095">AF_NETLINK</span><span class="op" id="2551105">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2551109">pp</span>&nbsp;<span class="op" id="2551112">:=</span>&nbsp;<span class="op" id="2551115">(</span><span class="op" id="2551116">*</span><span class="ident" id="2551117">RawSockaddrNetlink</span><span class="op" id="2551135">)</span><span class="op" id="2551136">(</span><span class="ident" id="2551137">unsafe</span><span class="op" id="2551143">.</span><span class="ident" id="2551144">Pointer</span><span class="op" id="2551151">(</span><span class="ident" id="2551152">rsa</span><span class="op" id="2551155">)</span><span class="op" id="2551156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2551160">sa</span>&nbsp;<span class="op" id="2551163">:=</span>&nbsp;<span class="builtinfunc" id="2551166">new</span><span class="op" id="2551169">(</span><span class="ident" id="2551170">SockaddrNetlink</span><span class="op" id="2551185">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2551189">sa</span><span class="op" id="2551191">.</span><span class="ident" id="2551192">Family</span>&nbsp;<span class="op" id="2551199">=</span>&nbsp;<span class="ident" id="2551201">pp</span><span class="op" id="2551203">.</span><span class="ident" id="2551204">Family</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2551213">sa</span><span class="op" id="2551215">.</span><span class="ident" id="2551216">Pad</span>&nbsp;<span class="op" id="2551220">=</span>&nbsp;<span class="ident" id="2551222">pp</span><span class="op" id="2551224">.</span><span class="ident" id="2551225">Pad</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2551231">sa</span><span class="op" id="2551233">.</span><span class="ident" id="2551234">Pid</span>&nbsp;<span class="op" id="2551238">=</span>&nbsp;<span class="ident" id="2551240">pp</span><span class="op" id="2551242">.</span><span class="ident" id="2551243">Pid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2551249">sa</span><span class="op" id="2551251">.</span><span class="ident" id="2551252">Groups</span>&nbsp;<span class="op" id="2551259">=</span>&nbsp;<span class="ident" id="2551261">pp</span><span class="op" id="2551263">.</span><span class="ident" id="2551264">Groups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2551273">return</span>&nbsp;<span class="ident" id="2551280">sa</span><span class="op" id="2551282">,</span>&nbsp;<span class="ident" id="2551284">nil</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2551290">case</span>&nbsp;<span class="ident" id="2551295">AF_PACKET</span><span class="op" id="2551304">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2551308">pp</span>&nbsp;<span class="op" id="2551311">:=</span>&nbsp;<span class="op" id="2551314">(</span><span class="op" id="2551315">*</span><span class="ident" id="2551316">RawSockaddrLinklayer</span><span class="op" id="2551336">)</span><span class="op" id="2551337">(</span><span class="ident" id="2551338">unsafe</span><span class="op" id="2551344">.</span><span class="ident" id="2551345">Pointer</span><span class="op" id="2551352">(</span><span class="ident" id="2551353">rsa</span><span class="op" id="2551356">)</span><span class="op" id="2551357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2551361">sa</span>&nbsp;<span class="op" id="2551364">:=</span>&nbsp;<span class="builtinfunc" id="2551367">new</span><span class="op" id="2551370">(</span><span class="ident" id="2551371">SockaddrLinklayer</span><span class="op" id="2551388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2551392">sa</span><span class="op" id="2551394">.</span><span class="ident" id="2551395">Protocol</span>&nbsp;<span class="op" id="2551404">=</span>&nbsp;<span class="ident" id="2551406">pp</span><span class="op" id="2551408">.</span><span class="ident" id="2551409">Protocol</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2551420">sa</span><span class="op" id="2551422">.</span><span class="ident" id="2551423">Ifindex</span>&nbsp;<span class="op" id="2551431">=</span>&nbsp;<span class="builtintype" id="2551433">int</span><span class="op" id="2551436">(</span><span class="ident" id="2551437">pp</span><span class="op" id="2551439">.</span><span class="ident" id="2551440">Ifindex</span><span class="op" id="2551447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2551451">sa</span><span class="op" id="2551453">.</span><span class="ident" id="2551454">Hatype</span>&nbsp;<span class="op" id="2551461">=</span>&nbsp;<span class="ident" id="2551463">pp</span><span class="op" id="2551465">.</span><span class="ident" id="2551466">Hatype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2551475">sa</span><span class="op" id="2551477">.</span><span class="ident" id="2551478">Pkttype</span>&nbsp;<span class="op" id="2551486">=</span>&nbsp;<span class="ident" id="2551488">pp</span><span class="op" id="2551490">.</span><span class="ident" id="2551491">Pkttype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2551501">sa</span><span class="op" id="2551503">.</span><span class="ident" id="2551504">Halen</span>&nbsp;<span class="op" id="2551510">=</span>&nbsp;<span class="ident" id="2551512">pp</span><span class="op" id="2551514">.</span><span class="ident" id="2551515">Halen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2551523">for</span>&nbsp;<span class="ident" id="2551527">i</span>&nbsp;<span class="op" id="2551529">:=</span>&nbsp;<span class="num" id="2551532">0</span><span class="op" id="2551533">;</span>&nbsp;<span class="ident" id="2551535">i</span>&nbsp;<span class="op" id="2551537">&lt;</span>&nbsp;<span class="builtinfunc" id="2551539">len</span><span class="op" id="2551542">(</span><span class="ident" id="2551543">sa</span><span class="op" id="2551545">.</span><span class="ident" id="2551546">Addr</span><span class="op" id="2551550">)</span><span class="op" id="2551551">;</span>&nbsp;<span class="ident" id="2551553">i</span><span class="op" id="2551554">++</span>&nbsp;<span class="op" id="2551557">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2551562">sa</span><span class="op" id="2551564">.</span><span class="ident" id="2551565">Addr</span><span class="op" id="2551569">[</span><span class="ident" id="2551570">i</span><span class="op" id="2551571">]</span>&nbsp;<span class="op" id="2551573">=</span>&nbsp;<span class="ident" id="2551575">pp</span><span class="op" id="2551577">.</span><span class="ident" id="2551578">Addr</span><span class="op" id="2551582">[</span><span class="ident" id="2551583">i</span><span class="op" id="2551584">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2551588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2551592">return</span>&nbsp;<span class="ident" id="2551599">sa</span><span class="op" id="2551601">,</span>&nbsp;<span class="ident" id="2551603">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2551609">case</span>&nbsp;<span class="ident" id="2551614">AF_UNIX</span><span class="op" id="2551621">:</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2551625">pp</span>&nbsp;<span class="op" id="2551628">:=</span>&nbsp;<span class="op" id="2551631">(</span><span class="op" id="2551632">*</span><span class="ident" id="2551633">RawSockaddrUnix</span><span class="op" id="2551648">)</span><span class="op" id="2551649">(</span><span class="ident" id="2551650">unsafe</span><span class="op" id="2551656">.</span><span class="ident" id="2551657">Pointer</span><span class="op" id="2551664">(</span><span class="ident" id="2551665">rsa</span><span class="op" id="2551668">)</span><span class="op" id="2551669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2551673">sa</span>&nbsp;<span class="op" id="2551676">:=</span>&nbsp;<span class="builtinfunc" id="2551679">new</span><span class="op" id="2551682">(</span><span class="ident" id="2551683">SockaddrUnix</span><span class="op" id="2551695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2551699">if</span>&nbsp;<span class="ident" id="2551702">pp</span><span class="op" id="2551704">.</span><span class="ident" id="2551705">Path</span><span class="op" id="2551709">[</span><span class="num" id="2551710">0</span><span class="op" id="2551711">]</span>&nbsp;<span class="op" id="2551713">==</span>&nbsp;<span class="num" id="2551716">0</span>&nbsp;<span class="op" id="2551718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2551723">//&nbsp;&#34;Abstract&#34;&nbsp;Unix&nbsp;domain&nbsp;socket.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2551760">//&nbsp;Rewrite&nbsp;leading&nbsp;NUL&nbsp;as&nbsp;@&nbsp;for&nbsp;textual&nbsp;display.</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2551812">//&nbsp;(This&nbsp;is&nbsp;the&nbsp;standard&nbsp;convention.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2551853">//&nbsp;Not&nbsp;friendly&nbsp;to&nbsp;overwrite&nbsp;in&nbsp;place,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2551895">//&nbsp;but&nbsp;the&nbsp;callers&nbsp;below&nbsp;don&#39;t&nbsp;care.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2551935">pp</span><span class="op" id="2551937">.</span><span class="ident" id="2551938">Path</span><span class="op" id="2551942">[</span><span class="num" id="2551943">0</span><span class="op" id="2551944">]</span>&nbsp;<span class="op" id="2551946">=</span>&nbsp;<span class="string" id="2551948">&#39;@&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2551954">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2551959">//&nbsp;Assume&nbsp;path&nbsp;ends&nbsp;at&nbsp;NUL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2551989">//&nbsp;This&nbsp;is&nbsp;not&nbsp;technically&nbsp;the&nbsp;Linux&nbsp;semantics&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2552042">//&nbsp;abstract&nbsp;Unix&nbsp;domain&nbsp;sockets--they&nbsp;are&nbsp;supposed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2552095">//&nbsp;to&nbsp;be&nbsp;uninterpreted&nbsp;fixed-size&nbsp;binary&nbsp;blobs--but</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2552149">//&nbsp;everyone&nbsp;uses&nbsp;this&nbsp;convention.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552185">n</span>&nbsp;<span class="op" id="2552187">:=</span>&nbsp;<span class="num" id="2552190">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2552194">for</span>&nbsp;<span class="ident" id="2552198">n</span>&nbsp;<span class="op" id="2552200">&lt;</span>&nbsp;<span class="builtinfunc" id="2552202">len</span><span class="op" id="2552205">(</span><span class="ident" id="2552206">pp</span><span class="op" id="2552208">.</span><span class="ident" id="2552209">Path</span><span class="op" id="2552213">)</span>&nbsp;<span class="op" id="2552215">&amp;&amp;</span>&nbsp;<span class="ident" id="2552218">pp</span><span class="op" id="2552220">.</span><span class="ident" id="2552221">Path</span><span class="op" id="2552225">[</span><span class="ident" id="2552226">n</span><span class="op" id="2552227">]</span>&nbsp;<span class="op" id="2552229">!=</span>&nbsp;<span class="num" id="2552232">0</span>&nbsp;<span class="op" id="2552234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552239">n</span><span class="op" id="2552240">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2552245">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552249">bytes</span>&nbsp;<span class="op" id="2552255">:=</span>&nbsp;<span class="op" id="2552258">(</span><span class="op" id="2552259">*</span><span class="op" id="2552260">[</span><span class="num" id="2552261">10000</span><span class="op" id="2552266">]</span><span class="builtintype" id="2552267">byte</span><span class="op" id="2552271">)</span><span class="op" id="2552272">(</span><span class="ident" id="2552273">unsafe</span><span class="op" id="2552279">.</span><span class="ident" id="2552280">Pointer</span><span class="op" id="2552287">(</span><span class="op" id="2552288">&amp;</span><span class="ident" id="2552289">pp</span><span class="op" id="2552291">.</span><span class="ident" id="2552292">Path</span><span class="op" id="2552296">[</span><span class="num" id="2552297">0</span><span class="op" id="2552298">]</span><span class="op" id="2552299">)</span><span class="op" id="2552300">)</span><span class="op" id="2552301">[</span><span class="num" id="2552302">0</span><span class="op" id="2552303">:</span><span class="ident" id="2552304">n</span><span class="op" id="2552305">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552309">sa</span><span class="op" id="2552311">.</span><span class="ident" id="2552312">Name</span>&nbsp;<span class="op" id="2552317">=</span>&nbsp;<span class="builtintype" id="2552319">string</span><span class="op" id="2552325">(</span><span class="ident" id="2552326">bytes</span><span class="op" id="2552331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2552335">return</span>&nbsp;<span class="ident" id="2552342">sa</span><span class="op" id="2552344">,</span>&nbsp;<span class="ident" id="2552346">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2552352">case</span>&nbsp;<span class="ident" id="2552357">AF_INET</span><span class="op" id="2552364">:</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552368">pp</span>&nbsp;<span class="op" id="2552371">:=</span>&nbsp;<span class="op" id="2552374">(</span><span class="op" id="2552375">*</span><span class="ident" id="2552376">RawSockaddrInet4</span><span class="op" id="2552392">)</span><span class="op" id="2552393">(</span><span class="ident" id="2552394">unsafe</span><span class="op" id="2552400">.</span><span class="ident" id="2552401">Pointer</span><span class="op" id="2552408">(</span><span class="ident" id="2552409">rsa</span><span class="op" id="2552412">)</span><span class="op" id="2552413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552417">sa</span>&nbsp;<span class="op" id="2552420">:=</span>&nbsp;<span class="builtinfunc" id="2552423">new</span><span class="op" id="2552426">(</span><span class="ident" id="2552427">SockaddrInet4</span><span class="op" id="2552440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552444">p</span>&nbsp;<span class="op" id="2552446">:=</span>&nbsp;<span class="op" id="2552449">(</span><span class="op" id="2552450">*</span><span class="op" id="2552451">[</span><span class="num" id="2552452">2</span><span class="op" id="2552453">]</span><span class="builtintype" id="2552454">byte</span><span class="op" id="2552458">)</span><span class="op" id="2552459">(</span><span class="ident" id="2552460">unsafe</span><span class="op" id="2552466">.</span><span class="ident" id="2552467">Pointer</span><span class="op" id="2552474">(</span><span class="op" id="2552475">&amp;</span><span class="ident" id="2552476">pp</span><span class="op" id="2552478">.</span><span class="ident" id="2552479">Port</span><span class="op" id="2552483">)</span><span class="op" id="2552484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552488">sa</span><span class="op" id="2552490">.</span><span class="ident" id="2552491">Port</span>&nbsp;<span class="op" id="2552496">=</span>&nbsp;<span class="builtintype" id="2552498">int</span><span class="op" id="2552501">(</span><span class="ident" id="2552502">p</span><span class="op" id="2552503">[</span><span class="num" id="2552504">0</span><span class="op" id="2552505">]</span><span class="op" id="2552506">)</span><span class="op" id="2552507">&lt;&lt;</span><span class="num" id="2552509">8</span>&nbsp;<span class="op" id="2552511">+</span>&nbsp;<span class="builtintype" id="2552513">int</span><span class="op" id="2552516">(</span><span class="ident" id="2552517">p</span><span class="op" id="2552518">[</span><span class="num" id="2552519">1</span><span class="op" id="2552520">]</span><span class="op" id="2552521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2552525">for</span>&nbsp;<span class="ident" id="2552529">i</span>&nbsp;<span class="op" id="2552531">:=</span>&nbsp;<span class="num" id="2552534">0</span><span class="op" id="2552535">;</span>&nbsp;<span class="ident" id="2552537">i</span>&nbsp;<span class="op" id="2552539">&lt;</span>&nbsp;<span class="builtinfunc" id="2552541">len</span><span class="op" id="2552544">(</span><span class="ident" id="2552545">sa</span><span class="op" id="2552547">.</span><span class="ident" id="2552548">Addr</span><span class="op" id="2552552">)</span><span class="op" id="2552553">;</span>&nbsp;<span class="ident" id="2552555">i</span><span class="op" id="2552556">++</span>&nbsp;<span class="op" id="2552559">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552564">sa</span><span class="op" id="2552566">.</span><span class="ident" id="2552567">Addr</span><span class="op" id="2552571">[</span><span class="ident" id="2552572">i</span><span class="op" id="2552573">]</span>&nbsp;<span class="op" id="2552575">=</span>&nbsp;<span class="ident" id="2552577">pp</span><span class="op" id="2552579">.</span><span class="ident" id="2552580">Addr</span><span class="op" id="2552584">[</span><span class="ident" id="2552585">i</span><span class="op" id="2552586">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2552590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2552594">return</span>&nbsp;<span class="ident" id="2552601">sa</span><span class="op" id="2552603">,</span>&nbsp;<span class="ident" id="2552605">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2552611">case</span>&nbsp;<span class="ident" id="2552616">AF_INET6</span><span class="op" id="2552624">:</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552628">pp</span>&nbsp;<span class="op" id="2552631">:=</span>&nbsp;<span class="op" id="2552634">(</span><span class="op" id="2552635">*</span><span class="ident" id="2552636">RawSockaddrInet6</span><span class="op" id="2552652">)</span><span class="op" id="2552653">(</span><span class="ident" id="2552654">unsafe</span><span class="op" id="2552660">.</span><span class="ident" id="2552661">Pointer</span><span class="op" id="2552668">(</span><span class="ident" id="2552669">rsa</span><span class="op" id="2552672">)</span><span class="op" id="2552673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552677">sa</span>&nbsp;<span class="op" id="2552680">:=</span>&nbsp;<span class="builtinfunc" id="2552683">new</span><span class="op" id="2552686">(</span><span class="ident" id="2552687">SockaddrInet6</span><span class="op" id="2552700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552704">p</span>&nbsp;<span class="op" id="2552706">:=</span>&nbsp;<span class="op" id="2552709">(</span><span class="op" id="2552710">*</span><span class="op" id="2552711">[</span><span class="num" id="2552712">2</span><span class="op" id="2552713">]</span><span class="builtintype" id="2552714">byte</span><span class="op" id="2552718">)</span><span class="op" id="2552719">(</span><span class="ident" id="2552720">unsafe</span><span class="op" id="2552726">.</span><span class="ident" id="2552727">Pointer</span><span class="op" id="2552734">(</span><span class="op" id="2552735">&amp;</span><span class="ident" id="2552736">pp</span><span class="op" id="2552738">.</span><span class="ident" id="2552739">Port</span><span class="op" id="2552743">)</span><span class="op" id="2552744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552748">sa</span><span class="op" id="2552750">.</span><span class="ident" id="2552751">Port</span>&nbsp;<span class="op" id="2552756">=</span>&nbsp;<span class="builtintype" id="2552758">int</span><span class="op" id="2552761">(</span><span class="ident" id="2552762">p</span><span class="op" id="2552763">[</span><span class="num" id="2552764">0</span><span class="op" id="2552765">]</span><span class="op" id="2552766">)</span><span class="op" id="2552767">&lt;&lt;</span><span class="num" id="2552769">8</span>&nbsp;<span class="op" id="2552771">+</span>&nbsp;<span class="builtintype" id="2552773">int</span><span class="op" id="2552776">(</span><span class="ident" id="2552777">p</span><span class="op" id="2552778">[</span><span class="num" id="2552779">1</span><span class="op" id="2552780">]</span><span class="op" id="2552781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552785">sa</span><span class="op" id="2552787">.</span><span class="ident" id="2552788">ZoneId</span>&nbsp;<span class="op" id="2552795">=</span>&nbsp;<span class="ident" id="2552797">pp</span><span class="op" id="2552799">.</span><span class="ident" id="2552800">Scope_id</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2552811">for</span>&nbsp;<span class="ident" id="2552815">i</span>&nbsp;<span class="op" id="2552817">:=</span>&nbsp;<span class="num" id="2552820">0</span><span class="op" id="2552821">;</span>&nbsp;<span class="ident" id="2552823">i</span>&nbsp;<span class="op" id="2552825">&lt;</span>&nbsp;<span class="builtinfunc" id="2552827">len</span><span class="op" id="2552830">(</span><span class="ident" id="2552831">sa</span><span class="op" id="2552833">.</span><span class="ident" id="2552834">Addr</span><span class="op" id="2552838">)</span><span class="op" id="2552839">;</span>&nbsp;<span class="ident" id="2552841">i</span><span class="op" id="2552842">++</span>&nbsp;<span class="op" id="2552845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2552850">sa</span><span class="op" id="2552852">.</span><span class="ident" id="2552853">Addr</span><span class="op" id="2552857">[</span><span class="ident" id="2552858">i</span><span class="op" id="2552859">]</span>&nbsp;<span class="op" id="2552861">=</span>&nbsp;<span class="ident" id="2552863">pp</span><span class="op" id="2552865">.</span><span class="ident" id="2552866">Addr</span><span class="op" id="2552870">[</span><span class="ident" id="2552871">i</span><span class="op" id="2552872">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2552876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2552880">return</span>&nbsp;<span class="ident" id="2552887">sa</span><span class="op" id="2552889">,</span>&nbsp;<span class="ident" id="2552891">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2552896">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2552899">return</span>&nbsp;<span class="ident" id="2552906">nil</span><span class="op" id="2552909">,</span>&nbsp;<span class="ident" id="2552911">EAFNOSUPPORT</span><br>
<span class="lineno"></span><span class="op" id="2552924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2552927">func</span>&nbsp;<span class="ident" id="2552932">Accept</span><span class="op" id="2552938">(</span><span class="ident" id="2552939">fd</span>&nbsp;<span class="builtintype" id="2552942">int</span><span class="op" id="2552945">)</span>&nbsp;<span class="op" id="2552947">(</span><span class="ident" id="2552948">nfd</span>&nbsp;<span class="builtintype" id="2552952">int</span><span class="op" id="2552955">,</span>&nbsp;<span class="ident" id="2552957">sa</span>&nbsp;<span class="ident" id="2552960">Sockaddr</span><span class="op" id="2552968">,</span>&nbsp;<span class="ident" id="2552970">err</span>&nbsp;<span class="builtintype" id="2552974">error</span><span class="op" id="2552979">)</span>&nbsp;<span class="op" id="2552981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2552984">var</span>&nbsp;<span class="ident" id="2552988">rsa</span>&nbsp;<span class="ident" id="2552992">RawSockaddrAny</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2553008">var</span>&nbsp;<span class="builtinfunc" id="2553012">len</span>&nbsp;<span class="ident" id="2553016">_Socklen</span>&nbsp;<span class="op" id="2553025">=</span>&nbsp;<span class="ident" id="2553027">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553046">nfd</span><span class="op" id="2553049">,</span>&nbsp;<span class="ident" id="2553051">err</span>&nbsp;<span class="op" id="2553055">=</span>&nbsp;<span class="ident" id="2553057">accept</span><span class="op" id="2553063">(</span><span class="ident" id="2553064">fd</span><span class="op" id="2553066">,</span>&nbsp;<span class="op" id="2553068">&amp;</span><span class="ident" id="2553069">rsa</span><span class="op" id="2553072">,</span>&nbsp;<span class="op" id="2553074">&amp;</span><span class="builtinfunc" id="2553075">len</span><span class="op" id="2553078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2553081">if</span>&nbsp;<span class="ident" id="2553084">err</span>&nbsp;<span class="op" id="2553088">!=</span>&nbsp;<span class="ident" id="2553091">nil</span>&nbsp;<span class="op" id="2553095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2553099">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2553107">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553110">sa</span><span class="op" id="2553112">,</span>&nbsp;<span class="ident" id="2553114">err</span>&nbsp;<span class="op" id="2553118">=</span>&nbsp;<span class="ident" id="2553120">anyToSockaddr</span><span class="op" id="2553133">(</span><span class="op" id="2553134">&amp;</span><span class="ident" id="2553135">rsa</span><span class="op" id="2553138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2553141">if</span>&nbsp;<span class="ident" id="2553144">err</span>&nbsp;<span class="op" id="2553148">!=</span>&nbsp;<span class="ident" id="2553151">nil</span>&nbsp;<span class="op" id="2553155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553159">Close</span><span class="op" id="2553164">(</span><span class="ident" id="2553165">nfd</span><span class="op" id="2553168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553172">nfd</span>&nbsp;<span class="op" id="2553176">=</span>&nbsp;<span class="num" id="2553178">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2553181">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2553184">return</span><br>
<span class="lineno"></span><span class="op" id="2553191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2553194">func</span>&nbsp;<span class="ident" id="2553199">Accept4</span><span class="op" id="2553206">(</span><span class="ident" id="2553207">fd</span>&nbsp;<span class="builtintype" id="2553210">int</span><span class="op" id="2553213">,</span>&nbsp;<span class="ident" id="2553215">flags</span>&nbsp;<span class="builtintype" id="2553221">int</span><span class="op" id="2553224">)</span>&nbsp;<span class="op" id="2553226">(</span><span class="ident" id="2553227">nfd</span>&nbsp;<span class="builtintype" id="2553231">int</span><span class="op" id="2553234">,</span>&nbsp;<span class="ident" id="2553236">sa</span>&nbsp;<span class="ident" id="2553239">Sockaddr</span><span class="op" id="2553247">,</span>&nbsp;<span class="ident" id="2553249">err</span>&nbsp;<span class="builtintype" id="2553253">error</span><span class="op" id="2553258">)</span>&nbsp;<span class="op" id="2553260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2553263">var</span>&nbsp;<span class="ident" id="2553267">rsa</span>&nbsp;<span class="ident" id="2553271">RawSockaddrAny</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2553287">var</span>&nbsp;<span class="builtinfunc" id="2553291">len</span>&nbsp;<span class="ident" id="2553295">_Socklen</span>&nbsp;<span class="op" id="2553304">=</span>&nbsp;<span class="ident" id="2553306">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553325">nfd</span><span class="op" id="2553328">,</span>&nbsp;<span class="ident" id="2553330">err</span>&nbsp;<span class="op" id="2553334">=</span>&nbsp;<span class="ident" id="2553336">accept4</span><span class="op" id="2553343">(</span><span class="ident" id="2553344">fd</span><span class="op" id="2553346">,</span>&nbsp;<span class="op" id="2553348">&amp;</span><span class="ident" id="2553349">rsa</span><span class="op" id="2553352">,</span>&nbsp;<span class="op" id="2553354">&amp;</span><span class="builtinfunc" id="2553355">len</span><span class="op" id="2553358">,</span>&nbsp;<span class="ident" id="2553360">flags</span><span class="op" id="2553365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2553368">if</span>&nbsp;<span class="ident" id="2553371">err</span>&nbsp;<span class="op" id="2553375">!=</span>&nbsp;<span class="ident" id="2553378">nil</span>&nbsp;<span class="op" id="2553382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2553386">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2553394">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2553397">if</span>&nbsp;<span class="builtinfunc" id="2553400">len</span>&nbsp;<span class="op" id="2553404">&gt;</span>&nbsp;<span class="ident" id="2553406">SizeofSockaddrAny</span>&nbsp;<span class="op" id="2553424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2553428">panic</span><span class="op" id="2553433">(</span><span class="string" id="2553434">&#34;RawSockaddrAny&nbsp;too&nbsp;small&#34;</span><span class="op" id="2553460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2553463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553466">sa</span><span class="op" id="2553468">,</span>&nbsp;<span class="ident" id="2553470">err</span>&nbsp;<span class="op" id="2553474">=</span>&nbsp;<span class="ident" id="2553476">anyToSockaddr</span><span class="op" id="2553489">(</span><span class="op" id="2553490">&amp;</span><span class="ident" id="2553491">rsa</span><span class="op" id="2553494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2553497">if</span>&nbsp;<span class="ident" id="2553500">err</span>&nbsp;<span class="op" id="2553504">!=</span>&nbsp;<span class="ident" id="2553507">nil</span>&nbsp;<span class="op" id="2553511">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553515">Close</span><span class="op" id="2553520">(</span><span class="ident" id="2553521">nfd</span><span class="op" id="2553524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553528">nfd</span>&nbsp;<span class="op" id="2553532">=</span>&nbsp;<span class="num" id="2553534">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2553537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2553540">return</span><br>
<span class="lineno"></span><span class="op" id="2553547">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="2553550">func</span>&nbsp;<span class="ident" id="2553555">Getsockname</span><span class="op" id="2553566">(</span><span class="ident" id="2553567">fd</span>&nbsp;<span class="builtintype" id="2553570">int</span><span class="op" id="2553573">)</span>&nbsp;<span class="op" id="2553575">(</span><span class="ident" id="2553576">sa</span>&nbsp;<span class="ident" id="2553579">Sockaddr</span><span class="op" id="2553587">,</span>&nbsp;<span class="ident" id="2553589">err</span>&nbsp;<span class="builtintype" id="2553593">error</span><span class="op" id="2553598">)</span>&nbsp;<span class="op" id="2553600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2553603">var</span>&nbsp;<span class="ident" id="2553607">rsa</span>&nbsp;<span class="ident" id="2553611">RawSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2553627">var</span>&nbsp;<span class="builtinfunc" id="2553631">len</span>&nbsp;<span class="ident" id="2553635">_Socklen</span>&nbsp;<span class="op" id="2553644">=</span>&nbsp;<span class="ident" id="2553646">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2553665">if</span>&nbsp;<span class="ident" id="2553668">err</span>&nbsp;<span class="op" id="2553672">=</span>&nbsp;<span class="ident" id="2553674">getsockname</span><span class="op" id="2553685">(</span><span class="ident" id="2553686">fd</span><span class="op" id="2553688">,</span>&nbsp;<span class="op" id="2553690">&amp;</span><span class="ident" id="2553691">rsa</span><span class="op" id="2553694">,</span>&nbsp;<span class="op" id="2553696">&amp;</span><span class="builtinfunc" id="2553697">len</span><span class="op" id="2553700">)</span><span class="op" id="2553701">;</span>&nbsp;<span class="ident" id="2553703">err</span>&nbsp;<span class="op" id="2553707">!=</span>&nbsp;<span class="ident" id="2553710">nil</span>&nbsp;<span class="op" id="2553714">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2553718">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2553726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2553729">return</span>&nbsp;<span class="ident" id="2553736">anyToSockaddr</span><span class="op" id="2553749">(</span><span class="op" id="2553750">&amp;</span><span class="ident" id="2553751">rsa</span><span class="op" id="2553754">)</span><br>
<span class="lineno"></span><span class="op" id="2553756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span><span class="keyword" id="2553759">func</span>&nbsp;<span class="ident" id="2553764">GetsockoptInet4Addr</span><span class="op" id="2553783">(</span><span class="ident" id="2553784">fd</span><span class="op" id="2553786">,</span>&nbsp;<span class="ident" id="2553788">level</span><span class="op" id="2553793">,</span>&nbsp;<span class="ident" id="2553795">opt</span>&nbsp;<span class="builtintype" id="2553799">int</span><span class="op" id="2553802">)</span>&nbsp;<span class="op" id="2553804">(</span><span class="ident" id="2553805">value</span>&nbsp;<span class="op" id="2553811">[</span><span class="num" id="2553812">4</span><span class="op" id="2553813">]</span><span class="builtintype" id="2553814">byte</span><span class="op" id="2553818">,</span>&nbsp;<span class="ident" id="2553820">err</span>&nbsp;<span class="builtintype" id="2553824">error</span><span class="op" id="2553829">)</span>&nbsp;<span class="op" id="2553831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553834">vallen</span>&nbsp;<span class="op" id="2553841">:=</span>&nbsp;<span class="ident" id="2553844">_Socklen</span><span class="op" id="2553852">(</span><span class="num" id="2553853">4</span><span class="op" id="2553854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2553857">err</span>&nbsp;<span class="op" id="2553861">=</span>&nbsp;<span class="ident" id="2553863">getsockopt</span><span class="op" id="2553873">(</span><span class="ident" id="2553874">fd</span><span class="op" id="2553876">,</span>&nbsp;<span class="ident" id="2553878">level</span><span class="op" id="2553883">,</span>&nbsp;<span class="ident" id="2553885">opt</span><span class="op" id="2553888">,</span>&nbsp;<span class="ident" id="2553890">unsafe</span><span class="op" id="2553896">.</span><span class="ident" id="2553897">Pointer</span><span class="op" id="2553904">(</span><span class="op" id="2553905">&amp;</span><span class="ident" id="2553906">value</span><span class="op" id="2553911">[</span><span class="num" id="2553912">0</span><span class="op" id="2553913">]</span><span class="op" id="2553914">)</span><span class="op" id="2553915">,</span>&nbsp;<span class="op" id="2553917">&amp;</span><span class="ident" id="2553918">vallen</span><span class="op" id="2553924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2553927">return</span>&nbsp;<span class="ident" id="2553934">value</span><span class="op" id="2553939">,</span>&nbsp;<span class="ident" id="2553941">err</span><br>
<span class="lineno"></span><span class="op" id="2553945">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="keyword" id="2553948">func</span>&nbsp;<span class="ident" id="2553953">GetsockoptIPMreq</span><span class="op" id="2553969">(</span><span class="ident" id="2553970">fd</span><span class="op" id="2553972">,</span>&nbsp;<span class="ident" id="2553974">level</span><span class="op" id="2553979">,</span>&nbsp;<span class="ident" id="2553981">opt</span>&nbsp;<span class="builtintype" id="2553985">int</span><span class="op" id="2553988">)</span>&nbsp;<span class="op" id="2553990">(</span><span class="op" id="2553991">*</span><span class="ident" id="2553992">IPMreq</span><span class="op" id="2553998">,</span>&nbsp;<span class="builtintype" id="2554000">error</span><span class="op" id="2554005">)</span>&nbsp;<span class="op" id="2554007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2554010">var</span>&nbsp;<span class="ident" id="2554014">value</span>&nbsp;<span class="ident" id="2554020">IPMreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2554028">vallen</span>&nbsp;<span class="op" id="2554035">:=</span>&nbsp;<span class="ident" id="2554038">_Socklen</span><span class="op" id="2554046">(</span><span class="ident" id="2554047">SizeofIPMreq</span><span class="op" id="2554059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2554062">err</span>&nbsp;<span class="op" id="2554066">:=</span>&nbsp;<span class="ident" id="2554069">getsockopt</span><span class="op" id="2554079">(</span><span class="ident" id="2554080">fd</span><span class="op" id="2554082">,</span>&nbsp;<span class="ident" id="2554084">level</span><span class="op" id="2554089">,</span>&nbsp;<span class="ident" id="2554091">opt</span><span class="op" id="2554094">,</span>&nbsp;<span class="ident" id="2554096">unsafe</span><span class="op" id="2554102">.</span><span class="ident" id="2554103">Pointer</span><span class="op" id="2554110">(</span><span class="op" id="2554111">&amp;</span><span class="ident" id="2554112">value</span><span class="op" id="2554117">)</span><span class="op" id="2554118">,</span>&nbsp;<span class="op" id="2554120">&amp;</span><span class="ident" id="2554121">vallen</span><span class="op" id="2554127">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2554130">return</span>&nbsp;<span class="op" id="2554137">&amp;</span><span class="ident" id="2554138">value</span><span class="op" id="2554143">,</span>&nbsp;<span class="ident" id="2554145">err</span><br>
<span class="lineno"></span><span class="op" id="2554149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2554152">func</span>&nbsp;<span class="ident" id="2554157">GetsockoptIPMreqn</span><span class="op" id="2554174">(</span><span class="ident" id="2554175">fd</span><span class="op" id="2554177">,</span>&nbsp;<span class="ident" id="2554179">level</span><span class="op" id="2554184">,</span>&nbsp;<span class="ident" id="2554186">opt</span>&nbsp;<span class="builtintype" id="2554190">int</span><span class="op" id="2554193">)</span>&nbsp;<span class="op" id="2554195">(</span><span class="op" id="2554196">*</span><span class="ident" id="2554197">IPMreqn</span><span class="op" id="2554204">,</span>&nbsp;<span class="builtintype" id="2554206">error</span><span class="op" id="2554211">)</span>&nbsp;<span class="op" id="2554213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2554216">var</span>&nbsp;<span class="ident" id="2554220">value</span>&nbsp;<span class="ident" id="2554226">IPMreqn</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2554235">vallen</span>&nbsp;<span class="op" id="2554242">:=</span>&nbsp;<span class="ident" id="2554245">_Socklen</span><span class="op" id="2554253">(</span><span class="ident" id="2554254">SizeofIPMreqn</span><span class="op" id="2554267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2554270">err</span>&nbsp;<span class="op" id="2554274">:=</span>&nbsp;<span class="ident" id="2554277">getsockopt</span><span class="op" id="2554287">(</span><span class="ident" id="2554288">fd</span><span class="op" id="2554290">,</span>&nbsp;<span class="ident" id="2554292">level</span><span class="op" id="2554297">,</span>&nbsp;<span class="ident" id="2554299">opt</span><span class="op" id="2554302">,</span>&nbsp;<span class="ident" id="2554304">unsafe</span><span class="op" id="2554310">.</span><span class="ident" id="2554311">Pointer</span><span class="op" id="2554318">(</span><span class="op" id="2554319">&amp;</span><span class="ident" id="2554320">value</span><span class="op" id="2554325">)</span><span class="op" id="2554326">,</span>&nbsp;<span class="op" id="2554328">&amp;</span><span class="ident" id="2554329">vallen</span><span class="op" id="2554335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2554338">return</span>&nbsp;<span class="op" id="2554345">&amp;</span><span class="ident" id="2554346">value</span><span class="op" id="2554351">,</span>&nbsp;<span class="ident" id="2554353">err</span><br>
<span class="lineno"></span><span class="op" id="2554357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span><span class="keyword" id="2554360">func</span>&nbsp;<span class="ident" id="2554365">GetsockoptIPv6Mreq</span><span class="op" id="2554383">(</span><span class="ident" id="2554384">fd</span><span class="op" id="2554386">,</span>&nbsp;<span class="ident" id="2554388">level</span><span class="op" id="2554393">,</span>&nbsp;<span class="ident" id="2554395">opt</span>&nbsp;<span class="builtintype" id="2554399">int</span><span class="op" id="2554402">)</span>&nbsp;<span class="op" id="2554404">(</span><span class="op" id="2554405">*</span><span class="ident" id="2554406">IPv6Mreq</span><span class="op" id="2554414">,</span>&nbsp;<span class="builtintype" id="2554416">error</span><span class="op" id="2554421">)</span>&nbsp;<span class="op" id="2554423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2554426">var</span>&nbsp;<span class="ident" id="2554430">value</span>&nbsp;<span class="ident" id="2554436">IPv6Mreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2554446">vallen</span>&nbsp;<span class="op" id="2554453">:=</span>&nbsp;<span class="ident" id="2554456">_Socklen</span><span class="op" id="2554464">(</span><span class="ident" id="2554465">SizeofIPv6Mreq</span><span class="op" id="2554479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2554482">err</span>&nbsp;<span class="op" id="2554486">:=</span>&nbsp;<span class="ident" id="2554489">getsockopt</span><span class="op" id="2554499">(</span><span class="ident" id="2554500">fd</span><span class="op" id="2554502">,</span>&nbsp;<span class="ident" id="2554504">level</span><span class="op" id="2554509">,</span>&nbsp;<span class="ident" id="2554511">opt</span><span class="op" id="2554514">,</span>&nbsp;<span class="ident" id="2554516">unsafe</span><span class="op" id="2554522">.</span><span class="ident" id="2554523">Pointer</span><span class="op" id="2554530">(</span><span class="op" id="2554531">&amp;</span><span class="ident" id="2554532">value</span><span class="op" id="2554537">)</span><span class="op" id="2554538">,</span>&nbsp;<span class="op" id="2554540">&amp;</span><span class="ident" id="2554541">vallen</span><span class="op" id="2554547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2554550">return</span>&nbsp;<span class="op" id="2554557">&amp;</span><span class="ident" id="2554558">value</span><span class="op" id="2554563">,</span>&nbsp;<span class="ident" id="2554565">err</span><br>
<span class="lineno">470</span><span class="op" id="2554569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2554572">func</span>&nbsp;<span class="ident" id="2554577">GetsockoptIPv6MTUInfo</span><span class="op" id="2554598">(</span><span class="ident" id="2554599">fd</span><span class="op" id="2554601">,</span>&nbsp;<span class="ident" id="2554603">level</span><span class="op" id="2554608">,</span>&nbsp;<span class="ident" id="2554610">opt</span>&nbsp;<span class="builtintype" id="2554614">int</span><span class="op" id="2554617">)</span>&nbsp;<span class="op" id="2554619">(</span><span class="op" id="2554620">*</span><span class="ident" id="2554621">IPv6MTUInfo</span><span class="op" id="2554632">,</span>&nbsp;<span class="builtintype" id="2554634">error</span><span class="op" id="2554639">)</span>&nbsp;<span class="op" id="2554641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2554644">var</span>&nbsp;<span class="ident" id="2554648">value</span>&nbsp;<span class="ident" id="2554654">IPv6MTUInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2554667">vallen</span>&nbsp;<span class="op" id="2554674">:=</span>&nbsp;<span class="ident" id="2554677">_Socklen</span><span class="op" id="2554685">(</span><span class="ident" id="2554686">SizeofIPv6MTUInfo</span><span class="op" id="2554703">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2554706">err</span>&nbsp;<span class="op" id="2554710">:=</span>&nbsp;<span class="ident" id="2554713">getsockopt</span><span class="op" id="2554723">(</span><span class="ident" id="2554724">fd</span><span class="op" id="2554726">,</span>&nbsp;<span class="ident" id="2554728">level</span><span class="op" id="2554733">,</span>&nbsp;<span class="ident" id="2554735">opt</span><span class="op" id="2554738">,</span>&nbsp;<span class="ident" id="2554740">unsafe</span><span class="op" id="2554746">.</span><span class="ident" id="2554747">Pointer</span><span class="op" id="2554754">(</span><span class="op" id="2554755">&amp;</span><span class="ident" id="2554756">value</span><span class="op" id="2554761">)</span><span class="op" id="2554762">,</span>&nbsp;<span class="op" id="2554764">&amp;</span><span class="ident" id="2554765">vallen</span><span class="op" id="2554771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2554774">return</span>&nbsp;<span class="op" id="2554781">&amp;</span><span class="ident" id="2554782">value</span><span class="op" id="2554787">,</span>&nbsp;<span class="ident" id="2554789">err</span><br>
<span class="lineno"></span><span class="op" id="2554793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2554796">func</span>&nbsp;<span class="ident" id="2554801">GetsockoptICMPv6Filter</span><span class="op" id="2554823">(</span><span class="ident" id="2554824">fd</span><span class="op" id="2554826">,</span>&nbsp;<span class="ident" id="2554828">level</span><span class="op" id="2554833">,</span>&nbsp;<span class="ident" id="2554835">opt</span>&nbsp;<span class="builtintype" id="2554839">int</span><span class="op" id="2554842">)</span>&nbsp;<span class="op" id="2554844">(</span><span class="op" id="2554845">*</span><span class="ident" id="2554846">ICMPv6Filter</span><span class="op" id="2554858">,</span>&nbsp;<span class="builtintype" id="2554860">error</span><span class="op" id="2554865">)</span>&nbsp;<span class="op" id="2554867">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2554870">var</span>&nbsp;<span class="ident" id="2554874">value</span>&nbsp;<span class="ident" id="2554880">ICMPv6Filter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2554894">vallen</span>&nbsp;<span class="op" id="2554901">:=</span>&nbsp;<span class="ident" id="2554904">_Socklen</span><span class="op" id="2554912">(</span><span class="ident" id="2554913">SizeofICMPv6Filter</span><span class="op" id="2554931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2554934">err</span>&nbsp;<span class="op" id="2554938">:=</span>&nbsp;<span class="ident" id="2554941">getsockopt</span><span class="op" id="2554951">(</span><span class="ident" id="2554952">fd</span><span class="op" id="2554954">,</span>&nbsp;<span class="ident" id="2554956">level</span><span class="op" id="2554961">,</span>&nbsp;<span class="ident" id="2554963">opt</span><span class="op" id="2554966">,</span>&nbsp;<span class="ident" id="2554968">unsafe</span><span class="op" id="2554974">.</span><span class="ident" id="2554975">Pointer</span><span class="op" id="2554982">(</span><span class="op" id="2554983">&amp;</span><span class="ident" id="2554984">value</span><span class="op" id="2554989">)</span><span class="op" id="2554990">,</span>&nbsp;<span class="op" id="2554992">&amp;</span><span class="ident" id="2554993">vallen</span><span class="op" id="2554999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2555002">return</span>&nbsp;<span class="op" id="2555009">&amp;</span><span class="ident" id="2555010">value</span><span class="op" id="2555015">,</span>&nbsp;<span class="ident" id="2555017">err</span><br>
<span class="lineno"></span><span class="op" id="2555021">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span><span class="keyword" id="2555024">func</span>&nbsp;<span class="ident" id="2555029">GetsockoptUcred</span><span class="op" id="2555044">(</span><span class="ident" id="2555045">fd</span><span class="op" id="2555047">,</span>&nbsp;<span class="ident" id="2555049">level</span><span class="op" id="2555054">,</span>&nbsp;<span class="ident" id="2555056">opt</span>&nbsp;<span class="builtintype" id="2555060">int</span><span class="op" id="2555063">)</span>&nbsp;<span class="op" id="2555065">(</span><span class="op" id="2555066">*</span><span class="ident" id="2555067">Ucred</span><span class="op" id="2555072">,</span>&nbsp;<span class="builtintype" id="2555074">error</span><span class="op" id="2555079">)</span>&nbsp;<span class="op" id="2555081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2555084">var</span>&nbsp;<span class="ident" id="2555088">value</span>&nbsp;<span class="ident" id="2555094">Ucred</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2555101">vallen</span>&nbsp;<span class="op" id="2555108">:=</span>&nbsp;<span class="ident" id="2555111">_Socklen</span><span class="op" id="2555119">(</span><span class="ident" id="2555120">SizeofUcred</span><span class="op" id="2555131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2555134">err</span>&nbsp;<span class="op" id="2555138">:=</span>&nbsp;<span class="ident" id="2555141">getsockopt</span><span class="op" id="2555151">(</span><span class="ident" id="2555152">fd</span><span class="op" id="2555154">,</span>&nbsp;<span class="ident" id="2555156">level</span><span class="op" id="2555161">,</span>&nbsp;<span class="ident" id="2555163">opt</span><span class="op" id="2555166">,</span>&nbsp;<span class="ident" id="2555168">unsafe</span><span class="op" id="2555174">.</span><span class="ident" id="2555175">Pointer</span><span class="op" id="2555182">(</span><span class="op" id="2555183">&amp;</span><span class="ident" id="2555184">value</span><span class="op" id="2555189">)</span><span class="op" id="2555190">,</span>&nbsp;<span class="op" id="2555192">&amp;</span><span class="ident" id="2555193">vallen</span><span class="op" id="2555199">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2555202">return</span>&nbsp;<span class="op" id="2555209">&amp;</span><span class="ident" id="2555210">value</span><span class="op" id="2555215">,</span>&nbsp;<span class="ident" id="2555217">err</span><br>
<span class="lineno"></span><span class="op" id="2555221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2555224">func</span>&nbsp;<span class="ident" id="2555229">SetsockoptIPMreqn</span><span class="op" id="2555246">(</span><span class="ident" id="2555247">fd</span><span class="op" id="2555249">,</span>&nbsp;<span class="ident" id="2555251">level</span><span class="op" id="2555256">,</span>&nbsp;<span class="ident" id="2555258">opt</span>&nbsp;<span class="builtintype" id="2555262">int</span><span class="op" id="2555265">,</span>&nbsp;<span class="ident" id="2555267">mreq</span>&nbsp;<span class="op" id="2555272">*</span><span class="ident" id="2555273">IPMreqn</span><span class="op" id="2555280">)</span>&nbsp;<span class="op" id="2555282">(</span><span class="ident" id="2555283">err</span>&nbsp;<span class="builtintype" id="2555287">error</span><span class="op" id="2555292">)</span>&nbsp;<span class="op" id="2555294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2555297">return</span>&nbsp;<span class="ident" id="2555304">setsockopt</span><span class="op" id="2555314">(</span><span class="ident" id="2555315">fd</span><span class="op" id="2555317">,</span>&nbsp;<span class="ident" id="2555319">level</span><span class="op" id="2555324">,</span>&nbsp;<span class="ident" id="2555326">opt</span><span class="op" id="2555329">,</span>&nbsp;<span class="ident" id="2555331">unsafe</span><span class="op" id="2555337">.</span><span class="ident" id="2555338">Pointer</span><span class="op" id="2555345">(</span><span class="ident" id="2555346">mreq</span><span class="op" id="2555350">)</span><span class="op" id="2555351">,</span>&nbsp;<span class="ident" id="2555353">unsafe</span><span class="op" id="2555359">.</span><span class="ident" id="2555360">Sizeof</span><span class="op" id="2555366">(</span><span class="op" id="2555367">*</span><span class="ident" id="2555368">mreq</span><span class="op" id="2555372">)</span><span class="op" id="2555373">)</span><br>
<span class="lineno">495</span><span class="op" id="2555375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2555378">func</span>&nbsp;<span class="ident" id="2555383">Recvmsg</span><span class="op" id="2555390">(</span><span class="ident" id="2555391">fd</span>&nbsp;<span class="builtintype" id="2555394">int</span><span class="op" id="2555397">,</span>&nbsp;<span class="ident" id="2555399">p</span><span class="op" id="2555400">,</span>&nbsp;<span class="ident" id="2555402">oob</span>&nbsp;<span class="op" id="2555406">[</span><span class="op" id="2555407">]</span><span class="builtintype" id="2555408">byte</span><span class="op" id="2555412">,</span>&nbsp;<span class="ident" id="2555414">flags</span>&nbsp;<span class="builtintype" id="2555420">int</span><span class="op" id="2555423">)</span>&nbsp;<span class="op" id="2555425">(</span><span class="ident" id="2555426">n</span><span class="op" id="2555427">,</span>&nbsp;<span class="ident" id="2555429">oobn</span>&nbsp;<span class="builtintype" id="2555434">int</span><span class="op" id="2555437">,</span>&nbsp;<span class="ident" id="2555439">recvflags</span>&nbsp;<span class="builtintype" id="2555449">int</span><span class="op" id="2555452">,</span>&nbsp;<span class="ident" id="2555454">from</span>&nbsp;<span class="ident" id="2555459">Sockaddr</span><span class="op" id="2555467">,</span>&nbsp;<span class="ident" id="2555469">err</span>&nbsp;<span class="builtintype" id="2555473">error</span><span class="op" id="2555478">)</span>&nbsp;<span class="op" id="2555480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2555483">var</span>&nbsp;<span class="ident" id="2555487">msg</span>&nbsp;<span class="ident" id="2555491">Msghdr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2555499">var</span>&nbsp;<span class="ident" id="2555503">rsa</span>&nbsp;<span class="ident" id="2555507">RawSockaddrAny</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2555523">msg</span><span class="op" id="2555526">.</span><span class="ident" id="2555527">Name</span>&nbsp;<span class="op" id="2555532">=</span>&nbsp;<span class="op" id="2555534">(</span><span class="op" id="2555535">*</span><span class="builtintype" id="2555536">byte</span><span class="op" id="2555540">)</span><span class="op" id="2555541">(</span><span class="ident" id="2555542">unsafe</span><span class="op" id="2555548">.</span><span class="ident" id="2555549">Pointer</span><span class="op" id="2555556">(</span><span class="op" id="2555557">&amp;</span><span class="ident" id="2555558">rsa</span><span class="op" id="2555561">)</span><span class="op" id="2555562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2555565">msg</span><span class="op" id="2555568">.</span><span class="ident" id="2555569">Namelen</span>&nbsp;<span class="op" id="2555577">=</span>&nbsp;<span class="builtintype" id="2555579">uint32</span><span class="op" id="2555585">(</span><span class="ident" id="2555586">SizeofSockaddrAny</span><span class="op" id="2555603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2555606">var</span>&nbsp;<span class="ident" id="2555610">iov</span>&nbsp;<span class="ident" id="2555614">Iovec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2555621">if</span>&nbsp;<span class="builtinfunc" id="2555624">len</span><span class="op" id="2555627">(</span><span class="ident" id="2555628">p</span><span class="op" id="2555629">)</span>&nbsp;<span class="op" id="2555631">&gt;</span>&nbsp;<span class="num" id="2555633">0</span>&nbsp;<span class="op" id="2555635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2555639">iov</span><span class="op" id="2555642">.</span><span class="ident" id="2555643">Base</span>&nbsp;<span class="op" id="2555648">=</span>&nbsp;<span class="op" id="2555650">(</span><span class="op" id="2555651">*</span><span class="builtintype" id="2555652">byte</span><span class="op" id="2555656">)</span><span class="op" id="2555657">(</span><span class="ident" id="2555658">unsafe</span><span class="op" id="2555664">.</span><span class="ident" id="2555665">Pointer</span><span class="op" id="2555672">(</span><span class="op" id="2555673">&amp;</span><span class="ident" id="2555674">p</span><span class="op" id="2555675">[</span><span class="num" id="2555676">0</span><span class="op" id="2555677">]</span><span class="op" id="2555678">)</span><span class="op" id="2555679">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2555683">iov</span><span class="op" id="2555686">.</span><span class="ident" id="2555687">SetLen</span><span class="op" id="2555693">(</span><span class="builtinfunc" id="2555694">len</span><span class="op" id="2555697">(</span><span class="ident" id="2555698">p</span><span class="op" id="2555699">)</span><span class="op" id="2555700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2555703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2555706">var</span>&nbsp;<span class="ident" id="2555710">dummy</span>&nbsp;<span class="builtintype" id="2555716">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2555722">if</span>&nbsp;<span class="builtinfunc" id="2555725">len</span><span class="op" id="2555728">(</span><span class="ident" id="2555729">oob</span><span class="op" id="2555732">)</span>&nbsp;<span class="op" id="2555734">&gt;</span>&nbsp;<span class="num" id="2555736">0</span>&nbsp;<span class="op" id="2555738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2555742">//&nbsp;receive&nbsp;at&nbsp;least&nbsp;one&nbsp;normal&nbsp;byte</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2555780">if</span>&nbsp;<span class="builtinfunc" id="2555783">len</span><span class="op" id="2555786">(</span><span class="ident" id="2555787">p</span><span class="op" id="2555788">)</span>&nbsp;<span class="op" id="2555790">==</span>&nbsp;<span class="num" id="2555793">0</span>&nbsp;<span class="op" id="2555795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2555800">iov</span><span class="op" id="2555803">.</span><span class="ident" id="2555804">Base</span>&nbsp;<span class="op" id="2555809">=</span>&nbsp;<span class="op" id="2555811">&amp;</span><span class="ident" id="2555812">dummy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2555821">iov</span><span class="op" id="2555824">.</span><span class="ident" id="2555825">SetLen</span><span class="op" id="2555831">(</span><span class="num" id="2555832">1</span><span class="op" id="2555833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2555837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2555841">msg</span><span class="op" id="2555844">.</span><span class="ident" id="2555845">Control</span>&nbsp;<span class="op" id="2555853">=</span>&nbsp;<span class="op" id="2555855">(</span><span class="op" id="2555856">*</span><span class="builtintype" id="2555857">byte</span><span class="op" id="2555861">)</span><span class="op" id="2555862">(</span><span class="ident" id="2555863">unsafe</span><span class="op" id="2555869">.</span><span class="ident" id="2555870">Pointer</span><span class="op" id="2555877">(</span><span class="op" id="2555878">&amp;</span><span class="ident" id="2555879">oob</span><span class="op" id="2555882">[</span><span class="num" id="2555883">0</span><span class="op" id="2555884">]</span><span class="op" id="2555885">)</span><span class="op" id="2555886">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2555890">msg</span><span class="op" id="2555893">.</span><span class="ident" id="2555894">SetControllen</span><span class="op" id="2555907">(</span><span class="builtinfunc" id="2555908">len</span><span class="op" id="2555911">(</span><span class="ident" id="2555912">oob</span><span class="op" id="2555915">)</span><span class="op" id="2555916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2555919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2555922">msg</span><span class="op" id="2555925">.</span><span class="ident" id="2555926">Iov</span>&nbsp;<span class="op" id="2555930">=</span>&nbsp;<span class="op" id="2555932">&amp;</span><span class="ident" id="2555933">iov</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2555938">msg</span><span class="op" id="2555941">.</span><span class="ident" id="2555942">Iovlen</span>&nbsp;<span class="op" id="2555949">=</span>&nbsp;<span class="num" id="2555951">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2555954">if</span>&nbsp;<span class="ident" id="2555957">n</span><span class="op" id="2555958">,</span>&nbsp;<span class="ident" id="2555960">err</span>&nbsp;<span class="op" id="2555964">=</span>&nbsp;<span class="ident" id="2555966">recvmsg</span><span class="op" id="2555973">(</span><span class="ident" id="2555974">fd</span><span class="op" id="2555976">,</span>&nbsp;<span class="op" id="2555978">&amp;</span><span class="ident" id="2555979">msg</span><span class="op" id="2555982">,</span>&nbsp;<span class="ident" id="2555984">flags</span><span class="op" id="2555989">)</span><span class="op" id="2555990">;</span>&nbsp;<span class="ident" id="2555992">err</span>&nbsp;<span class="op" id="2555996">!=</span>&nbsp;<span class="ident" id="2555999">nil</span>&nbsp;<span class="op" id="2556003">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2556007">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2556015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2556018">oobn</span>&nbsp;<span class="op" id="2556023">=</span>&nbsp;<span class="builtintype" id="2556025">int</span><span class="op" id="2556028">(</span><span class="ident" id="2556029">msg</span><span class="op" id="2556032">.</span><span class="ident" id="2556033">Controllen</span><span class="op" id="2556043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2556046">recvflags</span>&nbsp;<span class="op" id="2556056">=</span>&nbsp;<span class="builtintype" id="2556058">int</span><span class="op" id="2556061">(</span><span class="ident" id="2556062">msg</span><span class="op" id="2556065">.</span><span class="ident" id="2556066">Flags</span><span class="op" id="2556071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2556074">//&nbsp;source&nbsp;address&nbsp;is&nbsp;only&nbsp;specified&nbsp;if&nbsp;the&nbsp;socket&nbsp;is&nbsp;unconnected</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2556140">if</span>&nbsp;<span class="ident" id="2556143">rsa</span><span class="op" id="2556146">.</span><span class="ident" id="2556147">Addr</span><span class="op" id="2556151">.</span><span class="ident" id="2556152">Family</span>&nbsp;<span class="op" id="2556159">!=</span>&nbsp;<span class="ident" id="2556162">AF_UNSPEC</span>&nbsp;<span class="op" id="2556172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2556176">from</span><span class="op" id="2556180">,</span>&nbsp;<span class="ident" id="2556182">err</span>&nbsp;<span class="op" id="2556186">=</span>&nbsp;<span class="ident" id="2556188">anyToSockaddr</span><span class="op" id="2556201">(</span><span class="op" id="2556202">&amp;</span><span class="ident" id="2556203">rsa</span><span class="op" id="2556206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2556209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2556212">return</span><br>
<span class="lineno"></span><span class="op" id="2556219">}</span><br>
<span class="lineno">530</span><br>
<span class="lineno"></span><span class="keyword" id="2556222">func</span>&nbsp;<span class="ident" id="2556227">Sendmsg</span><span class="op" id="2556234">(</span><span class="ident" id="2556235">fd</span>&nbsp;<span class="builtintype" id="2556238">int</span><span class="op" id="2556241">,</span>&nbsp;<span class="ident" id="2556243">p</span><span class="op" id="2556244">,</span>&nbsp;<span class="ident" id="2556246">oob</span>&nbsp;<span class="op" id="2556250">[</span><span class="op" id="2556251">]</span><span class="builtintype" id="2556252">byte</span><span class="op" id="2556256">,</span>&nbsp;<span class="ident" id="2556258">to</span>&nbsp;<span class="ident" id="2556261">Sockaddr</span><span class="op" id="2556269">,</span>&nbsp;<span class="ident" id="2556271">flags</span>&nbsp;<span class="builtintype" id="2556277">int</span><span class="op" id="2556280">)</span>&nbsp;<span class="op" id="2556282">(</span><span class="ident" id="2556283">err</span>&nbsp;<span class="builtintype" id="2556287">error</span><span class="op" id="2556292">)</span>&nbsp;<span class="op" id="2556294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2556297">_</span><span class="op" id="2556298">,</span>&nbsp;<span class="ident" id="2556300">err</span>&nbsp;<span class="op" id="2556304">=</span>&nbsp;<span class="ident" id="2556306">SendmsgN</span><span class="op" id="2556314">(</span><span class="ident" id="2556315">fd</span><span class="op" id="2556317">,</span>&nbsp;<span class="ident" id="2556319">p</span><span class="op" id="2556320">,</span>&nbsp;<span class="ident" id="2556322">oob</span><span class="op" id="2556325">,</span>&nbsp;<span class="ident" id="2556327">to</span><span class="op" id="2556329">,</span>&nbsp;<span class="ident" id="2556331">flags</span><span class="op" id="2556336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2556339">return</span><br>
<span class="lineno"></span><span class="op" id="2556346">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="keyword" id="2556349">func</span>&nbsp;<span class="ident" id="2556354">SendmsgN</span><span class="op" id="2556362">(</span><span class="ident" id="2556363">fd</span>&nbsp;<span class="builtintype" id="2556366">int</span><span class="op" id="2556369">,</span>&nbsp;<span class="ident" id="2556371">p</span><span class="op" id="2556372">,</span>&nbsp;<span class="ident" id="2556374">oob</span>&nbsp;<span class="op" id="2556378">[</span><span class="op" id="2556379">]</span><span class="builtintype" id="2556380">byte</span><span class="op" id="2556384">,</span>&nbsp;<span class="ident" id="2556386">to</span>&nbsp;<span class="ident" id="2556389">Sockaddr</span><span class="op" id="2556397">,</span>&nbsp;<span class="ident" id="2556399">flags</span>&nbsp;<span class="builtintype" id="2556405">int</span><span class="op" id="2556408">)</span>&nbsp;<span class="op" id="2556410">(</span><span class="ident" id="2556411">n</span>&nbsp;<span class="builtintype" id="2556413">int</span><span class="op" id="2556416">,</span>&nbsp;<span class="ident" id="2556418">err</span>&nbsp;<span class="builtintype" id="2556422">error</span><span class="op" id="2556427">)</span>&nbsp;<span class="op" id="2556429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2556432">var</span>&nbsp;<span class="ident" id="2556436">ptr</span>&nbsp;<span class="ident" id="2556440">unsafe</span><span class="op" id="2556446">.</span><span class="ident" id="2556447">Pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2556456">var</span>&nbsp;<span class="ident" id="2556460">salen</span>&nbsp;<span class="ident" id="2556466">_Socklen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2556476">if</span>&nbsp;<span class="ident" id="2556479">to</span>&nbsp;<span class="op" id="2556482">!=</span>&nbsp;<span class="ident" id="2556485">nil</span>&nbsp;<span class="op" id="2556489">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2556493">var</span>&nbsp;<span class="ident" id="2556497">err</span>&nbsp;<span class="builtintype" id="2556501">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2556509">ptr</span><span class="op" id="2556512">,</span>&nbsp;<span class="ident" id="2556514">salen</span><span class="op" id="2556519">,</span>&nbsp;<span class="ident" id="2556521">err</span>&nbsp;<span class="op" id="2556525">=</span>&nbsp;<span class="ident" id="2556527">to</span><span class="op" id="2556529">.</span><span class="ident" id="2556530">sockaddr</span><span class="op" id="2556538">(</span><span class="op" id="2556539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2556543">if</span>&nbsp;<span class="ident" id="2556546">err</span>&nbsp;<span class="op" id="2556550">!=</span>&nbsp;<span class="ident" id="2556553">nil</span>&nbsp;<span class="op" id="2556557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2556562">return</span>&nbsp;<span class="num" id="2556569">0</span><span class="op" id="2556570">,</span>&nbsp;<span class="ident" id="2556572">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2556578">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2556581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2556584">var</span>&nbsp;<span class="ident" id="2556588">msg</span>&nbsp;<span class="ident" id="2556592">Msghdr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2556600">msg</span><span class="op" id="2556603">.</span><span class="ident" id="2556604">Name</span>&nbsp;<span class="op" id="2556609">=</span>&nbsp;<span class="op" id="2556611">(</span><span class="op" id="2556612">*</span><span class="builtintype" id="2556613">byte</span><span class="op" id="2556617">)</span><span class="op" id="2556618">(</span><span class="ident" id="2556619">unsafe</span><span class="op" id="2556625">.</span><span class="ident" id="2556626">Pointer</span><span class="op" id="2556633">(</span><span class="ident" id="2556634">ptr</span><span class="op" id="2556637">)</span><span class="op" id="2556638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2556641">msg</span><span class="op" id="2556644">.</span><span class="ident" id="2556645">Namelen</span>&nbsp;<span class="op" id="2556653">=</span>&nbsp;<span class="builtintype" id="2556655">uint32</span><span class="op" id="2556661">(</span><span class="ident" id="2556662">salen</span><span class="op" id="2556667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2556670">var</span>&nbsp;<span class="ident" id="2556674">iov</span>&nbsp;<span class="ident" id="2556678">Iovec</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2556685">if</span>&nbsp;<span class="builtinfunc" id="2556688">len</span><span class="op" id="2556691">(</span><span class="ident" id="2556692">p</span><span class="op" id="2556693">)</span>&nbsp;<span class="op" id="2556695">&gt;</span>&nbsp;<span class="num" id="2556697">0</span>&nbsp;<span class="op" id="2556699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2556703">iov</span><span class="op" id="2556706">.</span><span class="ident" id="2556707">Base</span>&nbsp;<span class="op" id="2556712">=</span>&nbsp;<span class="op" id="2556714">(</span><span class="op" id="2556715">*</span><span class="builtintype" id="2556716">byte</span><span class="op" id="2556720">)</span><span class="op" id="2556721">(</span><span class="ident" id="2556722">unsafe</span><span class="op" id="2556728">.</span><span class="ident" id="2556729">Pointer</span><span class="op" id="2556736">(</span><span class="op" id="2556737">&amp;</span><span class="ident" id="2556738">p</span><span class="op" id="2556739">[</span><span class="num" id="2556740">0</span><span class="op" id="2556741">]</span><span class="op" id="2556742">)</span><span class="op" id="2556743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2556747">iov</span><span class="op" id="2556750">.</span><span class="ident" id="2556751">SetLen</span><span class="op" id="2556757">(</span><span class="builtinfunc" id="2556758">len</span><span class="op" id="2556761">(</span><span class="ident" id="2556762">p</span><span class="op" id="2556763">)</span><span class="op" id="2556764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2556767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2556770">var</span>&nbsp;<span class="ident" id="2556774">dummy</span>&nbsp;<span class="builtintype" id="2556780">byte</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2556786">if</span>&nbsp;<span class="builtinfunc" id="2556789">len</span><span class="op" id="2556792">(</span><span class="ident" id="2556793">oob</span><span class="op" id="2556796">)</span>&nbsp;<span class="op" id="2556798">&gt;</span>&nbsp;<span class="num" id="2556800">0</span>&nbsp;<span class="op" id="2556802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2556806">//&nbsp;send&nbsp;at&nbsp;least&nbsp;one&nbsp;normal&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2556841">if</span>&nbsp;<span class="builtinfunc" id="2556844">len</span><span class="op" id="2556847">(</span><span class="ident" id="2556848">p</span><span class="op" id="2556849">)</span>&nbsp;<span class="op" id="2556851">==</span>&nbsp;<span class="num" id="2556854">0</span>&nbsp;<span class="op" id="2556856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2556861">iov</span><span class="op" id="2556864">.</span><span class="ident" id="2556865">Base</span>&nbsp;<span class="op" id="2556870">=</span>&nbsp;<span class="op" id="2556872">&amp;</span><span class="ident" id="2556873">dummy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2556882">iov</span><span class="op" id="2556885">.</span><span class="ident" id="2556886">SetLen</span><span class="op" id="2556892">(</span><span class="num" id="2556893">1</span><span class="op" id="2556894">)</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2556898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2556902">msg</span><span class="op" id="2556905">.</span><span class="ident" id="2556906">Control</span>&nbsp;<span class="op" id="2556914">=</span>&nbsp;<span class="op" id="2556916">(</span><span class="op" id="2556917">*</span><span class="builtintype" id="2556918">byte</span><span class="op" id="2556922">)</span><span class="op" id="2556923">(</span><span class="ident" id="2556924">unsafe</span><span class="op" id="2556930">.</span><span class="ident" id="2556931">Pointer</span><span class="op" id="2556938">(</span><span class="op" id="2556939">&amp;</span><span class="ident" id="2556940">oob</span><span class="op" id="2556943">[</span><span class="num" id="2556944">0</span><span class="op" id="2556945">]</span><span class="op" id="2556946">)</span><span class="op" id="2556947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2556951">msg</span><span class="op" id="2556954">.</span><span class="ident" id="2556955">SetControllen</span><span class="op" id="2556968">(</span><span class="builtinfunc" id="2556969">len</span><span class="op" id="2556972">(</span><span class="ident" id="2556973">oob</span><span class="op" id="2556976">)</span><span class="op" id="2556977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2556980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2556983">msg</span><span class="op" id="2556986">.</span><span class="ident" id="2556987">Iov</span>&nbsp;<span class="op" id="2556991">=</span>&nbsp;<span class="op" id="2556993">&amp;</span><span class="ident" id="2556994">iov</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2556999">msg</span><span class="op" id="2557002">.</span><span class="ident" id="2557003">Iovlen</span>&nbsp;<span class="op" id="2557010">=</span>&nbsp;<span class="num" id="2557012">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2557015">if</span>&nbsp;<span class="ident" id="2557018">n</span><span class="op" id="2557019">,</span>&nbsp;<span class="ident" id="2557021">err</span>&nbsp;<span class="op" id="2557025">=</span>&nbsp;<span class="ident" id="2557027">sendmsg</span><span class="op" id="2557034">(</span><span class="ident" id="2557035">fd</span><span class="op" id="2557037">,</span>&nbsp;<span class="op" id="2557039">&amp;</span><span class="ident" id="2557040">msg</span><span class="op" id="2557043">,</span>&nbsp;<span class="ident" id="2557045">flags</span><span class="op" id="2557050">)</span><span class="op" id="2557051">;</span>&nbsp;<span class="ident" id="2557053">err</span>&nbsp;<span class="op" id="2557057">!=</span>&nbsp;<span class="ident" id="2557060">nil</span>&nbsp;<span class="op" id="2557064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2557068">return</span>&nbsp;<span class="num" id="2557075">0</span><span class="op" id="2557076">,</span>&nbsp;<span class="ident" id="2557078">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2557083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2557086">if</span>&nbsp;<span class="builtinfunc" id="2557089">len</span><span class="op" id="2557092">(</span><span class="ident" id="2557093">oob</span><span class="op" id="2557096">)</span>&nbsp;<span class="op" id="2557098">&gt;</span>&nbsp;<span class="num" id="2557100">0</span>&nbsp;<span class="op" id="2557102">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2557105">len</span><span class="op" id="2557108">(</span><span class="ident" id="2557109">p</span><span class="op" id="2557110">)</span>&nbsp;<span class="op" id="2557112">==</span>&nbsp;<span class="num" id="2557115">0</span>&nbsp;<span class="op" id="2557117">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2557121">n</span>&nbsp;<span class="op" id="2557123">=</span>&nbsp;<span class="num" id="2557125">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2557128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2557131">return</span>&nbsp;<span class="ident" id="2557138">n</span><span class="op" id="2557139">,</span>&nbsp;<span class="ident" id="2557141">nil</span><br>
<span class="lineno"></span><span class="op" id="2557145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">575</span><span class="comment" id="2557148">//&nbsp;BindToDevice&nbsp;binds&nbsp;the&nbsp;socket&nbsp;associated&nbsp;with&nbsp;fd&nbsp;to&nbsp;device.</span><br>
<span class="lineno"></span><span class="keyword" id="2557211">func</span>&nbsp;<span class="ident" id="2557216">BindToDevice</span><span class="op" id="2557228">(</span><span class="ident" id="2557229">fd</span>&nbsp;<span class="builtintype" id="2557232">int</span><span class="op" id="2557235">,</span>&nbsp;<span class="ident" id="2557237">device</span>&nbsp;<span class="builtintype" id="2557244">string</span><span class="op" id="2557250">)</span>&nbsp;<span class="op" id="2557252">(</span><span class="ident" id="2557253">err</span>&nbsp;<span class="builtintype" id="2557257">error</span><span class="op" id="2557262">)</span>&nbsp;<span class="op" id="2557264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2557267">return</span>&nbsp;<span class="ident" id="2557274">SetsockoptString</span><span class="op" id="2557290">(</span><span class="ident" id="2557291">fd</span><span class="op" id="2557293">,</span>&nbsp;<span class="ident" id="2557295">SOL_SOCKET</span><span class="op" id="2557305">,</span>&nbsp;<span class="ident" id="2557307">SO_BINDTODEVICE</span><span class="op" id="2557322">,</span>&nbsp;<span class="ident" id="2557324">device</span><span class="op" id="2557330">)</span><br>
<span class="lineno"></span><span class="op" id="2557332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">580</span><span class="comment" id="2557335">//sys&nbsp;&nbsp;&nbsp;&nbspptrace(request&nbsp;int,&nbsp;pid&nbsp;int,&nbsp;addr&nbsp;uintptr,&nbsp;data&nbsp;uintptr)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2557411">func</span>&nbsp;<span class="ident" id="2557416">ptracePeek</span><span class="op" id="2557426">(</span><span class="ident" id="2557427">req</span>&nbsp;<span class="builtintype" id="2557431">int</span><span class="op" id="2557434">,</span>&nbsp;<span class="ident" id="2557436">pid</span>&nbsp;<span class="builtintype" id="2557440">int</span><span class="op" id="2557443">,</span>&nbsp;<span class="ident" id="2557445">addr</span>&nbsp;<span class="builtintype" id="2557450">uintptr</span><span class="op" id="2557457">,</span>&nbsp;<span class="ident" id="2557459">out</span>&nbsp;<span class="op" id="2557463">[</span><span class="op" id="2557464">]</span><span class="builtintype" id="2557465">byte</span><span class="op" id="2557469">)</span>&nbsp;<span class="op" id="2557471">(</span><span class="ident" id="2557472">count</span>&nbsp;<span class="builtintype" id="2557478">int</span><span class="op" id="2557481">,</span>&nbsp;<span class="ident" id="2557483">err</span>&nbsp;<span class="builtintype" id="2557487">error</span><span class="op" id="2557492">)</span>&nbsp;<span class="op" id="2557494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557497">//&nbsp;The&nbsp;peek&nbsp;requests&nbsp;are&nbsp;machine-size&nbsp;oriented,&nbsp;so&nbsp;we&nbsp;wrap&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557560">//&nbsp;to&nbsp;retrieve&nbsp;arbitrary-length&nbsp;data.</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557600">//&nbsp;The&nbsp;ptrace&nbsp;syscall&nbsp;differs&nbsp;from&nbsp;glibc&#39;s&nbsp;ptrace.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557652">//&nbsp;Peeks&nbsp;returns&nbsp;the&nbsp;word&nbsp;in&nbsp;*data,&nbsp;not&nbsp;as&nbsp;the&nbsp;return&nbsp;value.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2557715">var</span>&nbsp;<span class="ident" id="2557719">buf</span>&nbsp;<span class="op" id="2557723">[</span><span class="ident" id="2557724">sizeofPtr</span><span class="op" id="2557733">]</span><span class="builtintype" id="2557734">byte</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557741">//&nbsp;Leading&nbsp;edge.&nbsp;&nbsp;PEEKTEXT/PEEKDATA&nbsp;don&#39;t&nbsp;require&nbsp;aligned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557800">//&nbsp;access&nbsp;(PEEKUSER&nbsp;warns&nbsp;that&nbsp;it&nbsp;might),&nbsp;but&nbsp;if&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557859">//&nbsp;align&nbsp;our&nbsp;reads,&nbsp;we&nbsp;might&nbsp;straddle&nbsp;an&nbsp;unmapped&nbsp;page</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557915">//&nbsp;boundary&nbsp;and&nbsp;not&nbsp;get&nbsp;the&nbsp;bytes&nbsp;leading&nbsp;up&nbsp;to&nbsp;the&nbsp;page</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2557973">//&nbsp;boundary.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2557987">n</span>&nbsp;<span class="op" id="2557989">:=</span>&nbsp;<span class="num" id="2557992">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2557995">if</span>&nbsp;<span class="ident" id="2557998">addr</span><span class="op" id="2558002">%</span><span class="ident" id="2558003">sizeofPtr</span>&nbsp;<span class="op" id="2558013">!=</span>&nbsp;<span class="num" id="2558016">0</span>&nbsp;<span class="op" id="2558018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558022">err</span>&nbsp;<span class="op" id="2558026">=</span>&nbsp;<span class="ident" id="2558028">ptrace</span><span class="op" id="2558034">(</span><span class="ident" id="2558035">req</span><span class="op" id="2558038">,</span>&nbsp;<span class="ident" id="2558040">pid</span><span class="op" id="2558043">,</span>&nbsp;<span class="ident" id="2558045">addr</span><span class="op" id="2558049">-</span><span class="ident" id="2558050">addr</span><span class="op" id="2558054">%</span><span class="ident" id="2558055">sizeofPtr</span><span class="op" id="2558064">,</span>&nbsp;<span class="builtintype" id="2558066">uintptr</span><span class="op" id="2558073">(</span><span class="ident" id="2558074">unsafe</span><span class="op" id="2558080">.</span><span class="ident" id="2558081">Pointer</span><span class="op" id="2558088">(</span><span class="op" id="2558089">&amp;</span><span class="ident" id="2558090">buf</span><span class="op" id="2558093">[</span><span class="num" id="2558094">0</span><span class="op" id="2558095">]</span><span class="op" id="2558096">)</span><span class="op" id="2558097">)</span><span class="op" id="2558098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2558102">if</span>&nbsp;<span class="ident" id="2558105">err</span>&nbsp;<span class="op" id="2558109">!=</span>&nbsp;<span class="ident" id="2558112">nil</span>&nbsp;<span class="op" id="2558116">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2558121">return</span>&nbsp;<span class="num" id="2558128">0</span><span class="op" id="2558129">,</span>&nbsp;<span class="ident" id="2558131">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2558137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558141">n</span>&nbsp;<span class="op" id="2558143">+=</span>&nbsp;<span class="builtinfunc" id="2558146">copy</span><span class="op" id="2558150">(</span><span class="ident" id="2558151">out</span><span class="op" id="2558154">,</span>&nbsp;<span class="ident" id="2558156">buf</span><span class="op" id="2558159">[</span><span class="ident" id="2558160">addr</span><span class="op" id="2558164">%</span><span class="ident" id="2558165">sizeofPtr</span><span class="op" id="2558174">:</span><span class="op" id="2558175">]</span><span class="op" id="2558176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558180">out</span>&nbsp;<span class="op" id="2558184">=</span>&nbsp;<span class="ident" id="2558186">out</span><span class="op" id="2558189">[</span><span class="ident" id="2558190">n</span><span class="op" id="2558191">:</span><span class="op" id="2558192">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2558195">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2558199">//&nbsp;Remainder.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2558214">for</span>&nbsp;<span class="builtinfunc" id="2558218">len</span><span class="op" id="2558221">(</span><span class="ident" id="2558222">out</span><span class="op" id="2558225">)</span>&nbsp;<span class="op" id="2558227">&gt;</span>&nbsp;<span class="num" id="2558229">0</span>&nbsp;<span class="op" id="2558231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2558235">//&nbsp;We&nbsp;use&nbsp;an&nbsp;internal&nbsp;buffer&nbsp;to&nbsp;guarantee&nbsp;alignment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2558290">//&nbsp;It&#39;s&nbsp;not&nbsp;documented&nbsp;if&nbsp;this&nbsp;is&nbsp;necessary,&nbsp;but&nbsp;we&#39;re&nbsp;paranoid.</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558357">err</span>&nbsp;<span class="op" id="2558361">=</span>&nbsp;<span class="ident" id="2558363">ptrace</span><span class="op" id="2558369">(</span><span class="ident" id="2558370">req</span><span class="op" id="2558373">,</span>&nbsp;<span class="ident" id="2558375">pid</span><span class="op" id="2558378">,</span>&nbsp;<span class="ident" id="2558380">addr</span><span class="op" id="2558384">+</span><span class="builtintype" id="2558385">uintptr</span><span class="op" id="2558392">(</span><span class="ident" id="2558393">n</span><span class="op" id="2558394">)</span><span class="op" id="2558395">,</span>&nbsp;<span class="builtintype" id="2558397">uintptr</span><span class="op" id="2558404">(</span><span class="ident" id="2558405">unsafe</span><span class="op" id="2558411">.</span><span class="ident" id="2558412">Pointer</span><span class="op" id="2558419">(</span><span class="op" id="2558420">&amp;</span><span class="ident" id="2558421">buf</span><span class="op" id="2558424">[</span><span class="num" id="2558425">0</span><span class="op" id="2558426">]</span><span class="op" id="2558427">)</span><span class="op" id="2558428">)</span><span class="op" id="2558429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2558433">if</span>&nbsp;<span class="ident" id="2558436">err</span>&nbsp;<span class="op" id="2558440">!=</span>&nbsp;<span class="ident" id="2558443">nil</span>&nbsp;<span class="op" id="2558447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2558452">return</span>&nbsp;<span class="ident" id="2558459">n</span><span class="op" id="2558460">,</span>&nbsp;<span class="ident" id="2558462">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2558468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558472">copied</span>&nbsp;<span class="op" id="2558479">:=</span>&nbsp;<span class="builtinfunc" id="2558482">copy</span><span class="op" id="2558486">(</span><span class="ident" id="2558487">out</span><span class="op" id="2558490">,</span>&nbsp;<span class="ident" id="2558492">buf</span><span class="op" id="2558495">[</span><span class="num" id="2558496">0</span><span class="op" id="2558497">:</span><span class="op" id="2558498">]</span><span class="op" id="2558499">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558503">n</span>&nbsp;<span class="op" id="2558505">+=</span>&nbsp;<span class="ident" id="2558508">copied</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2558517">out</span>&nbsp;<span class="op" id="2558521">=</span>&nbsp;<span class="ident" id="2558523">out</span><span class="op" id="2558526">[</span><span class="ident" id="2558527">copied</span><span class="op" id="2558533">:</span><span class="op" id="2558534">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2558537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2558541">return</span>&nbsp;<span class="ident" id="2558548">n</span><span class="op" id="2558549">,</span>&nbsp;<span class="ident" id="2558551">nil</span><br>
<span class="lineno">620</span><span class="op" id="2558555">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2558558">func</span>&nbsp;<span class="ident" id="2558563">PtracePeekText</span><span class="op" id="2558577">(</span><span class="ident" id="2558578">pid</span>&nbsp;<span class="builtintype" id="2558582">int</span><span class="op" id="2558585">,</span>&nbsp;<span class="ident" id="2558587">addr</span>&nbsp;<span class="builtintype" id="2558592">uintptr</span><span class="op" id="2558599">,</span>&nbsp;<span class="ident" id="2558601">out</span>&nbsp;<span class="op" id="2558605">[</span><span class="op" id="2558606">]</span><span class="builtintype" id="2558607">byte</span><span class="op" id="2558611">)</span>&nbsp;<span class="op" id="2558613">(</span><span class="ident" id="2558614">count</span>&nbsp;<span class="builtintype" id="2558620">int</span><span class="op" id="2558623">,</span>&nbsp;<span class="ident" id="2558625">err</span>&nbsp;<span class="builtintype" id="2558629">error</span><span class="op" id="2558634">)</span>&nbsp;<span class="op" id="2558636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2558639">return</span>&nbsp;<span class="ident" id="2558646">ptracePeek</span><span class="op" id="2558656">(</span><span class="ident" id="2558657">PTRACE_PEEKTEXT</span><span class="op" id="2558672">,</span>&nbsp;<span class="ident" id="2558674">pid</span><span class="op" id="2558677">,</span>&nbsp;<span class="ident" id="2558679">addr</span><span class="op" id="2558683">,</span>&nbsp;<span class="ident" id="2558685">out</span><span class="op" id="2558688">)</span><br>
<span class="lineno"></span><span class="op" id="2558690">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="2558693">func</span>&nbsp;<span class="ident" id="2558698">PtracePeekData</span><span class="op" id="2558712">(</span><span class="ident" id="2558713">pid</span>&nbsp;<span class="builtintype" id="2558717">int</span><span class="op" id="2558720">,</span>&nbsp;<span class="ident" id="2558722">addr</span>&nbsp;<span class="builtintype" id="2558727">uintptr</span><span class="op" id="2558734">,</span>&nbsp;<span class="ident" id="2558736">out</span>&nbsp;<span class="op" id="2558740">[</span><span class="op" id="2558741">]</span><span class="builtintype" id="2558742">byte</span><span class="op" id="2558746">)</span>&nbsp;<span class="op" id="2558748">(</span><span class="ident" id="2558749">count</span>&nbsp;<span class="builtintype" id="2558755">int</span><span class="op" id="2558758">,</span>&nbsp;<span class="ident" id="2558760">err</span>&nbsp;<span class="builtintype" id="2558764">error</span><span class="op" id="2558769">)</span>&nbsp;<span class="op" id="2558771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2558774">return</span>&nbsp;<span class="ident" id="2558781">ptracePeek</span><span class="op" id="2558791">(</span><span class="ident" id="2558792">PTRACE_PEEKDATA</span><span class="op" id="2558807">,</span>&nbsp;<span class="ident" id="2558809">pid</span><span class="op" id="2558812">,</span>&nbsp;<span class="ident" id="2558814">addr</span><span class="op" id="2558818">,</span>&nbsp;<span class="ident" id="2558820">out</span><span class="op" id="2558823">)</span><br>
<span class="lineno"></span><span class="op" id="2558825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">630</span><span class="keyword" id="2558828">func</span>&nbsp;<span class="ident" id="2558833">ptracePoke</span><span class="op" id="2558843">(</span><span class="ident" id="2558844">pokeReq</span>&nbsp;<span class="builtintype" id="2558852">int</span><span class="op" id="2558855">,</span>&nbsp;<span class="ident" id="2558857">peekReq</span>&nbsp;<span class="builtintype" id="2558865">int</span><span class="op" id="2558868">,</span>&nbsp;<span class="ident" id="2558870">pid</span>&nbsp;<span class="builtintype" id="2558874">int</span><span class="op" id="2558877">,</span>&nbsp;<span class="ident" id="2558879">addr</span>&nbsp;<span class="builtintype" id="2558884">uintptr</span><span class="op" id="2558891">,</span>&nbsp;<span class="ident" id="2558893">data</span>&nbsp;<span class="op" id="2558898">[</span><span class="op" id="2558899">]</span><span class="builtintype" id="2558900">byte</span><span class="op" id="2558904">)</span>&nbsp;<span class="op" id="2558906">(</span><span class="ident" id="2558907">count</span>&nbsp;<span class="builtintype" id="2558913">int</span><span class="op" id="2558916">,</span>&nbsp;<span class="ident" id="2558918">err</span>&nbsp;<span class="builtintype" id="2558922">error</span><span class="op" id="2558927">)</span>&nbsp;<span class="op" id="2558929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2558932">//&nbsp;As&nbsp;for&nbsp;ptracePeek,&nbsp;we&nbsp;need&nbsp;to&nbsp;align&nbsp;our&nbsp;accesses&nbsp;to&nbsp;deal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2558993">//&nbsp;with&nbsp;the&nbsp;possibility&nbsp;of&nbsp;straddling&nbsp;an&nbsp;invalid&nbsp;page.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2559050">//&nbsp;Leading&nbsp;edge.</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2559068">n</span>&nbsp;<span class="op" id="2559070">:=</span>&nbsp;<span class="num" id="2559073">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559076">if</span>&nbsp;<span class="ident" id="2559079">addr</span><span class="op" id="2559083">%</span><span class="ident" id="2559084">sizeofPtr</span>&nbsp;<span class="op" id="2559094">!=</span>&nbsp;<span class="num" id="2559097">0</span>&nbsp;<span class="op" id="2559099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559103">var</span>&nbsp;<span class="ident" id="2559107">buf</span>&nbsp;<span class="op" id="2559111">[</span><span class="ident" id="2559112">sizeofPtr</span><span class="op" id="2559121">]</span><span class="builtintype" id="2559122">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2559129">err</span>&nbsp;<span class="op" id="2559133">=</span>&nbsp;<span class="ident" id="2559135">ptrace</span><span class="op" id="2559141">(</span><span class="ident" id="2559142">peekReq</span><span class="op" id="2559149">,</span>&nbsp;<span class="ident" id="2559151">pid</span><span class="op" id="2559154">,</span>&nbsp;<span class="ident" id="2559156">addr</span><span class="op" id="2559160">-</span><span class="ident" id="2559161">addr</span><span class="op" id="2559165">%</span><span class="ident" id="2559166">sizeofPtr</span><span class="op" id="2559175">,</span>&nbsp;<span class="builtintype" id="2559177">uintptr</span><span class="op" id="2559184">(</span><span class="ident" id="2559185">unsafe</span><span class="op" id="2559191">.</span><span class="ident" id="2559192">Pointer</span><span class="op" id="2559199">(</span><span class="op" id="2559200">&amp;</span><span class="ident" id="2559201">buf</span><span class="op" id="2559204">[</span><span class="num" id="2559205">0</span><span class="op" id="2559206">]</span><span class="op" id="2559207">)</span><span class="op" id="2559208">)</span><span class="op" id="2559209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559213">if</span>&nbsp;<span class="ident" id="2559216">err</span>&nbsp;<span class="op" id="2559220">!=</span>&nbsp;<span class="ident" id="2559223">nil</span>&nbsp;<span class="op" id="2559227">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559232">return</span>&nbsp;<span class="num" id="2559239">0</span><span class="op" id="2559240">,</span>&nbsp;<span class="ident" id="2559242">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2559248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2559252">n</span>&nbsp;<span class="op" id="2559254">+=</span>&nbsp;<span class="builtinfunc" id="2559257">copy</span><span class="op" id="2559261">(</span><span class="ident" id="2559262">buf</span><span class="op" id="2559265">[</span><span class="ident" id="2559266">addr</span><span class="op" id="2559270">%</span><span class="ident" id="2559271">sizeofPtr</span><span class="op" id="2559280">:</span><span class="op" id="2559281">]</span><span class="op" id="2559282">,</span>&nbsp;<span class="ident" id="2559284">data</span><span class="op" id="2559288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2559292">word</span>&nbsp;<span class="op" id="2559297">:=</span>&nbsp;<span class="op" id="2559300">*</span><span class="op" id="2559301">(</span><span class="op" id="2559302">(</span><span class="op" id="2559303">*</span><span class="builtintype" id="2559304">uintptr</span><span class="op" id="2559311">)</span><span class="op" id="2559312">(</span><span class="ident" id="2559313">unsafe</span><span class="op" id="2559319">.</span><span class="ident" id="2559320">Pointer</span><span class="op" id="2559327">(</span><span class="op" id="2559328">&amp;</span><span class="ident" id="2559329">buf</span><span class="op" id="2559332">[</span><span class="num" id="2559333">0</span><span class="op" id="2559334">]</span><span class="op" id="2559335">)</span><span class="op" id="2559336">)</span><span class="op" id="2559337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2559341">err</span>&nbsp;<span class="op" id="2559345">=</span>&nbsp;<span class="ident" id="2559347">ptrace</span><span class="op" id="2559353">(</span><span class="ident" id="2559354">pokeReq</span><span class="op" id="2559361">,</span>&nbsp;<span class="ident" id="2559363">pid</span><span class="op" id="2559366">,</span>&nbsp;<span class="ident" id="2559368">addr</span><span class="op" id="2559372">-</span><span class="ident" id="2559373">addr</span><span class="op" id="2559377">%</span><span class="ident" id="2559378">sizeofPtr</span><span class="op" id="2559387">,</span>&nbsp;<span class="ident" id="2559389">word</span><span class="op" id="2559393">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559397">if</span>&nbsp;<span class="ident" id="2559400">err</span>&nbsp;<span class="op" id="2559404">!=</span>&nbsp;<span class="ident" id="2559407">nil</span>&nbsp;<span class="op" id="2559411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559416">return</span>&nbsp;<span class="num" id="2559423">0</span><span class="op" id="2559424">,</span>&nbsp;<span class="ident" id="2559426">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2559432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2559436">data</span>&nbsp;<span class="op" id="2559441">=</span>&nbsp;<span class="ident" id="2559443">data</span><span class="op" id="2559447">[</span><span class="ident" id="2559448">n</span><span class="op" id="2559449">:</span><span class="op" id="2559450">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2559453">}</span><br>
<span class="lineno">650</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2559457">//&nbsp;Interior.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559471">for</span>&nbsp;<span class="builtinfunc" id="2559475">len</span><span class="op" id="2559478">(</span><span class="ident" id="2559479">data</span><span class="op" id="2559483">)</span>&nbsp;<span class="op" id="2559485">&gt;</span>&nbsp;<span class="ident" id="2559487">sizeofPtr</span>&nbsp;<span class="op" id="2559497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2559501">word</span>&nbsp;<span class="op" id="2559506">:=</span>&nbsp;<span class="op" id="2559509">*</span><span class="op" id="2559510">(</span><span class="op" id="2559511">(</span><span class="op" id="2559512">*</span><span class="builtintype" id="2559513">uintptr</span><span class="op" id="2559520">)</span><span class="op" id="2559521">(</span><span class="ident" id="2559522">unsafe</span><span class="op" id="2559528">.</span><span class="ident" id="2559529">Pointer</span><span class="op" id="2559536">(</span><span class="op" id="2559537">&amp;</span><span class="ident" id="2559538">data</span><span class="op" id="2559542">[</span><span class="num" id="2559543">0</span><span class="op" id="2559544">]</span><span class="op" id="2559545">)</span><span class="op" id="2559546">)</span><span class="op" id="2559547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2559551">err</span>&nbsp;<span class="op" id="2559555">=</span>&nbsp;<span class="ident" id="2559557">ptrace</span><span class="op" id="2559563">(</span><span class="ident" id="2559564">pokeReq</span><span class="op" id="2559571">,</span>&nbsp;<span class="ident" id="2559573">pid</span><span class="op" id="2559576">,</span>&nbsp;<span class="ident" id="2559578">addr</span><span class="op" id="2559582">+</span><span class="builtintype" id="2559583">uintptr</span><span class="op" id="2559590">(</span><span class="ident" id="2559591">n</span><span class="op" id="2559592">)</span><span class="op" id="2559593">,</span>&nbsp;<span class="ident" id="2559595">word</span><span class="op" id="2559599">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559603">if</span>&nbsp;<span class="ident" id="2559606">err</span>&nbsp;<span class="op" id="2559610">!=</span>&nbsp;<span class="ident" id="2559613">nil</span>&nbsp;<span class="op" id="2559617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559622">return</span>&nbsp;<span class="ident" id="2559629">n</span><span class="op" id="2559630">,</span>&nbsp;<span class="ident" id="2559632">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2559638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2559642">n</span>&nbsp;<span class="op" id="2559644">+=</span>&nbsp;<span class="ident" id="2559647">sizeofPtr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2559659">data</span>&nbsp;<span class="op" id="2559664">=</span>&nbsp;<span class="ident" id="2559666">data</span><span class="op" id="2559670">[</span><span class="ident" id="2559671">sizeofPtr</span><span class="op" id="2559680">:</span><span class="op" id="2559681">]</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2559684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2559688">//&nbsp;Trailing&nbsp;edge.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559707">if</span>&nbsp;<span class="builtinfunc" id="2559710">len</span><span class="op" id="2559713">(</span><span class="ident" id="2559714">data</span><span class="op" id="2559718">)</span>&nbsp;<span class="op" id="2559720">&gt;</span>&nbsp;<span class="num" id="2559722">0</span>&nbsp;<span class="op" id="2559724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559728">var</span>&nbsp;<span class="ident" id="2559732">buf</span>&nbsp;<span class="op" id="2559736">[</span><span class="ident" id="2559737">sizeofPtr</span><span class="op" id="2559746">]</span><span class="builtintype" id="2559747">byte</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2559754">err</span>&nbsp;<span class="op" id="2559758">=</span>&nbsp;<span class="ident" id="2559760">ptrace</span><span class="op" id="2559766">(</span><span class="ident" id="2559767">peekReq</span><span class="op" id="2559774">,</span>&nbsp;<span class="ident" id="2559776">pid</span><span class="op" id="2559779">,</span>&nbsp;<span class="ident" id="2559781">addr</span><span class="op" id="2559785">+</span><span class="builtintype" id="2559786">uintptr</span><span class="op" id="2559793">(</span><span class="ident" id="2559794">n</span><span class="op" id="2559795">)</span><span class="op" id="2559796">,</span>&nbsp;<span class="builtintype" id="2559798">uintptr</span><span class="op" id="2559805">(</span><span class="ident" id="2559806">unsafe</span><span class="op" id="2559812">.</span><span class="ident" id="2559813">Pointer</span><span class="op" id="2559820">(</span><span class="op" id="2559821">&amp;</span><span class="ident" id="2559822">buf</span><span class="op" id="2559825">[</span><span class="num" id="2559826">0</span><span class="op" id="2559827">]</span><span class="op" id="2559828">)</span><span class="op" id="2559829">)</span><span class="op" id="2559830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559834">if</span>&nbsp;<span class="ident" id="2559837">err</span>&nbsp;<span class="op" id="2559841">!=</span>&nbsp;<span class="ident" id="2559844">nil</span>&nbsp;<span class="op" id="2559848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559853">return</span>&nbsp;<span class="ident" id="2559860">n</span><span class="op" id="2559861">,</span>&nbsp;<span class="ident" id="2559863">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2559869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2559873">copy</span><span class="op" id="2559877">(</span><span class="ident" id="2559878">buf</span><span class="op" id="2559881">[</span><span class="num" id="2559882">0</span><span class="op" id="2559883">:</span><span class="op" id="2559884">]</span><span class="op" id="2559885">,</span>&nbsp;<span class="ident" id="2559887">data</span><span class="op" id="2559891">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2559895">word</span>&nbsp;<span class="op" id="2559900">:=</span>&nbsp;<span class="op" id="2559903">*</span><span class="op" id="2559904">(</span><span class="op" id="2559905">(</span><span class="op" id="2559906">*</span><span class="builtintype" id="2559907">uintptr</span><span class="op" id="2559914">)</span><span class="op" id="2559915">(</span><span class="ident" id="2559916">unsafe</span><span class="op" id="2559922">.</span><span class="ident" id="2559923">Pointer</span><span class="op" id="2559930">(</span><span class="op" id="2559931">&amp;</span><span class="ident" id="2559932">buf</span><span class="op" id="2559935">[</span><span class="num" id="2559936">0</span><span class="op" id="2559937">]</span><span class="op" id="2559938">)</span><span class="op" id="2559939">)</span><span class="op" id="2559940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2559944">err</span>&nbsp;<span class="op" id="2559948">=</span>&nbsp;<span class="ident" id="2559950">ptrace</span><span class="op" id="2559956">(</span><span class="ident" id="2559957">pokeReq</span><span class="op" id="2559964">,</span>&nbsp;<span class="ident" id="2559966">pid</span><span class="op" id="2559969">,</span>&nbsp;<span class="ident" id="2559971">addr</span><span class="op" id="2559975">+</span><span class="builtintype" id="2559976">uintptr</span><span class="op" id="2559983">(</span><span class="ident" id="2559984">n</span><span class="op" id="2559985">)</span><span class="op" id="2559986">,</span>&nbsp;<span class="ident" id="2559988">word</span><span class="op" id="2559992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2559996">if</span>&nbsp;<span class="ident" id="2559999">err</span>&nbsp;<span class="op" id="2560003">!=</span>&nbsp;<span class="ident" id="2560006">nil</span>&nbsp;<span class="op" id="2560010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560015">return</span>&nbsp;<span class="ident" id="2560022">n</span><span class="op" id="2560023">,</span>&nbsp;<span class="ident" id="2560025">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2560031">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560035">n</span>&nbsp;<span class="op" id="2560037">+=</span>&nbsp;<span class="builtinfunc" id="2560040">len</span><span class="op" id="2560043">(</span><span class="ident" id="2560044">data</span><span class="op" id="2560048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2560051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560055">return</span>&nbsp;<span class="ident" id="2560062">n</span><span class="op" id="2560063">,</span>&nbsp;<span class="ident" id="2560065">nil</span><br>
<span class="lineno"></span><span class="op" id="2560069">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="2560072">func</span>&nbsp;<span class="ident" id="2560077">PtracePokeText</span><span class="op" id="2560091">(</span><span class="ident" id="2560092">pid</span>&nbsp;<span class="builtintype" id="2560096">int</span><span class="op" id="2560099">,</span>&nbsp;<span class="ident" id="2560101">addr</span>&nbsp;<span class="builtintype" id="2560106">uintptr</span><span class="op" id="2560113">,</span>&nbsp;<span class="ident" id="2560115">data</span>&nbsp;<span class="op" id="2560120">[</span><span class="op" id="2560121">]</span><span class="builtintype" id="2560122">byte</span><span class="op" id="2560126">)</span>&nbsp;<span class="op" id="2560128">(</span><span class="ident" id="2560129">count</span>&nbsp;<span class="builtintype" id="2560135">int</span><span class="op" id="2560138">,</span>&nbsp;<span class="ident" id="2560140">err</span>&nbsp;<span class="builtintype" id="2560144">error</span><span class="op" id="2560149">)</span>&nbsp;<span class="op" id="2560151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560154">return</span>&nbsp;<span class="ident" id="2560161">ptracePoke</span><span class="op" id="2560171">(</span><span class="ident" id="2560172">PTRACE_POKETEXT</span><span class="op" id="2560187">,</span>&nbsp;<span class="ident" id="2560189">PTRACE_PEEKTEXT</span><span class="op" id="2560204">,</span>&nbsp;<span class="ident" id="2560206">pid</span><span class="op" id="2560209">,</span>&nbsp;<span class="ident" id="2560211">addr</span><span class="op" id="2560215">,</span>&nbsp;<span class="ident" id="2560217">data</span><span class="op" id="2560221">)</span><br>
<span class="lineno"></span><span class="op" id="2560223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">685</span><span class="keyword" id="2560226">func</span>&nbsp;<span class="ident" id="2560231">PtracePokeData</span><span class="op" id="2560245">(</span><span class="ident" id="2560246">pid</span>&nbsp;<span class="builtintype" id="2560250">int</span><span class="op" id="2560253">,</span>&nbsp;<span class="ident" id="2560255">addr</span>&nbsp;<span class="builtintype" id="2560260">uintptr</span><span class="op" id="2560267">,</span>&nbsp;<span class="ident" id="2560269">data</span>&nbsp;<span class="op" id="2560274">[</span><span class="op" id="2560275">]</span><span class="builtintype" id="2560276">byte</span><span class="op" id="2560280">)</span>&nbsp;<span class="op" id="2560282">(</span><span class="ident" id="2560283">count</span>&nbsp;<span class="builtintype" id="2560289">int</span><span class="op" id="2560292">,</span>&nbsp;<span class="ident" id="2560294">err</span>&nbsp;<span class="builtintype" id="2560298">error</span><span class="op" id="2560303">)</span>&nbsp;<span class="op" id="2560305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560308">return</span>&nbsp;<span class="ident" id="2560315">ptracePoke</span><span class="op" id="2560325">(</span><span class="ident" id="2560326">PTRACE_POKEDATA</span><span class="op" id="2560341">,</span>&nbsp;<span class="ident" id="2560343">PTRACE_PEEKDATA</span><span class="op" id="2560358">,</span>&nbsp;<span class="ident" id="2560360">pid</span><span class="op" id="2560363">,</span>&nbsp;<span class="ident" id="2560365">addr</span><span class="op" id="2560369">,</span>&nbsp;<span class="ident" id="2560371">data</span><span class="op" id="2560375">)</span><br>
<span class="lineno"></span><span class="op" id="2560377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2560380">func</span>&nbsp;<span class="ident" id="2560385">PtraceGetRegs</span><span class="op" id="2560398">(</span><span class="ident" id="2560399">pid</span>&nbsp;<span class="builtintype" id="2560403">int</span><span class="op" id="2560406">,</span>&nbsp;<span class="ident" id="2560408">regsout</span>&nbsp;<span class="op" id="2560416">*</span><span class="ident" id="2560417">PtraceRegs</span><span class="op" id="2560427">)</span>&nbsp;<span class="op" id="2560429">(</span><span class="ident" id="2560430">err</span>&nbsp;<span class="builtintype" id="2560434">error</span><span class="op" id="2560439">)</span>&nbsp;<span class="op" id="2560441">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560444">return</span>&nbsp;<span class="ident" id="2560451">ptrace</span><span class="op" id="2560457">(</span><span class="ident" id="2560458">PTRACE_GETREGS</span><span class="op" id="2560472">,</span>&nbsp;<span class="ident" id="2560474">pid</span><span class="op" id="2560477">,</span>&nbsp;<span class="num" id="2560479">0</span><span class="op" id="2560480">,</span>&nbsp;<span class="builtintype" id="2560482">uintptr</span><span class="op" id="2560489">(</span><span class="ident" id="2560490">unsafe</span><span class="op" id="2560496">.</span><span class="ident" id="2560497">Pointer</span><span class="op" id="2560504">(</span><span class="ident" id="2560505">regsout</span><span class="op" id="2560512">)</span><span class="op" id="2560513">)</span><span class="op" id="2560514">)</span><br>
<span class="lineno"></span><span class="op" id="2560516">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2560519">func</span>&nbsp;<span class="ident" id="2560524">PtraceSetRegs</span><span class="op" id="2560537">(</span><span class="ident" id="2560538">pid</span>&nbsp;<span class="builtintype" id="2560542">int</span><span class="op" id="2560545">,</span>&nbsp;<span class="ident" id="2560547">regs</span>&nbsp;<span class="op" id="2560552">*</span><span class="ident" id="2560553">PtraceRegs</span><span class="op" id="2560563">)</span>&nbsp;<span class="op" id="2560565">(</span><span class="ident" id="2560566">err</span>&nbsp;<span class="builtintype" id="2560570">error</span><span class="op" id="2560575">)</span>&nbsp;<span class="op" id="2560577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560580">return</span>&nbsp;<span class="ident" id="2560587">ptrace</span><span class="op" id="2560593">(</span><span class="ident" id="2560594">PTRACE_SETREGS</span><span class="op" id="2560608">,</span>&nbsp;<span class="ident" id="2560610">pid</span><span class="op" id="2560613">,</span>&nbsp;<span class="num" id="2560615">0</span><span class="op" id="2560616">,</span>&nbsp;<span class="builtintype" id="2560618">uintptr</span><span class="op" id="2560625">(</span><span class="ident" id="2560626">unsafe</span><span class="op" id="2560632">.</span><span class="ident" id="2560633">Pointer</span><span class="op" id="2560640">(</span><span class="ident" id="2560641">regs</span><span class="op" id="2560645">)</span><span class="op" id="2560646">)</span><span class="op" id="2560647">)</span><br>
<span class="lineno">695</span><span class="op" id="2560649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2560652">func</span>&nbsp;<span class="ident" id="2560657">PtraceSetOptions</span><span class="op" id="2560673">(</span><span class="ident" id="2560674">pid</span>&nbsp;<span class="builtintype" id="2560678">int</span><span class="op" id="2560681">,</span>&nbsp;<span class="ident" id="2560683">options</span>&nbsp;<span class="builtintype" id="2560691">int</span><span class="op" id="2560694">)</span>&nbsp;<span class="op" id="2560696">(</span><span class="ident" id="2560697">err</span>&nbsp;<span class="builtintype" id="2560701">error</span><span class="op" id="2560706">)</span>&nbsp;<span class="op" id="2560708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560711">return</span>&nbsp;<span class="ident" id="2560718">ptrace</span><span class="op" id="2560724">(</span><span class="ident" id="2560725">PTRACE_SETOPTIONS</span><span class="op" id="2560742">,</span>&nbsp;<span class="ident" id="2560744">pid</span><span class="op" id="2560747">,</span>&nbsp;<span class="num" id="2560749">0</span><span class="op" id="2560750">,</span>&nbsp;<span class="builtintype" id="2560752">uintptr</span><span class="op" id="2560759">(</span><span class="ident" id="2560760">options</span><span class="op" id="2560767">)</span><span class="op" id="2560768">)</span><br>
<span class="lineno"></span><span class="op" id="2560770">}</span><br>
<span class="lineno">700</span><br>
<span class="lineno"></span><span class="keyword" id="2560773">func</span>&nbsp;<span class="ident" id="2560778">PtraceGetEventMsg</span><span class="op" id="2560795">(</span><span class="ident" id="2560796">pid</span>&nbsp;<span class="builtintype" id="2560800">int</span><span class="op" id="2560803">)</span>&nbsp;<span class="op" id="2560805">(</span><span class="ident" id="2560806">msg</span>&nbsp;<span class="builtintype" id="2560810">uint</span><span class="op" id="2560814">,</span>&nbsp;<span class="ident" id="2560816">err</span>&nbsp;<span class="builtintype" id="2560820">error</span><span class="op" id="2560825">)</span>&nbsp;<span class="op" id="2560827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560830">var</span>&nbsp;<span class="ident" id="2560834">data</span>&nbsp;<span class="ident" id="2560839">_C_long</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560848">err</span>&nbsp;<span class="op" id="2560852">=</span>&nbsp;<span class="ident" id="2560854">ptrace</span><span class="op" id="2560860">(</span><span class="ident" id="2560861">PTRACE_GETEVENTMSG</span><span class="op" id="2560879">,</span>&nbsp;<span class="ident" id="2560881">pid</span><span class="op" id="2560884">,</span>&nbsp;<span class="num" id="2560886">0</span><span class="op" id="2560887">,</span>&nbsp;<span class="builtintype" id="2560889">uintptr</span><span class="op" id="2560896">(</span><span class="ident" id="2560897">unsafe</span><span class="op" id="2560903">.</span><span class="ident" id="2560904">Pointer</span><span class="op" id="2560911">(</span><span class="op" id="2560912">&amp;</span><span class="ident" id="2560913">data</span><span class="op" id="2560917">)</span><span class="op" id="2560918">)</span><span class="op" id="2560919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2560922">msg</span>&nbsp;<span class="op" id="2560926">=</span>&nbsp;<span class="builtintype" id="2560928">uint</span><span class="op" id="2560932">(</span><span class="ident" id="2560933">data</span><span class="op" id="2560937">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2560940">return</span><br>
<span class="lineno"></span><span class="op" id="2560947">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2560950">func</span>&nbsp;<span class="ident" id="2560955">PtraceCont</span><span class="op" id="2560965">(</span><span class="ident" id="2560966">pid</span>&nbsp;<span class="builtintype" id="2560970">int</span><span class="op" id="2560973">,</span>&nbsp;<span class="ident" id="2560975">signal</span>&nbsp;<span class="builtintype" id="2560982">int</span><span class="op" id="2560985">)</span>&nbsp;<span class="op" id="2560987">(</span><span class="ident" id="2560988">err</span>&nbsp;<span class="builtintype" id="2560992">error</span><span class="op" id="2560997">)</span>&nbsp;<span class="op" id="2560999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561002">return</span>&nbsp;<span class="ident" id="2561009">ptrace</span><span class="op" id="2561015">(</span><span class="ident" id="2561016">PTRACE_CONT</span><span class="op" id="2561027">,</span>&nbsp;<span class="ident" id="2561029">pid</span><span class="op" id="2561032">,</span>&nbsp;<span class="num" id="2561034">0</span><span class="op" id="2561035">,</span>&nbsp;<span class="builtintype" id="2561037">uintptr</span><span class="op" id="2561044">(</span><span class="ident" id="2561045">signal</span><span class="op" id="2561051">)</span><span class="op" id="2561052">)</span><br>
<span class="lineno">710</span><span class="op" id="2561054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2561057">func</span>&nbsp;<span class="ident" id="2561062">PtraceSyscall</span><span class="op" id="2561075">(</span><span class="ident" id="2561076">pid</span>&nbsp;<span class="builtintype" id="2561080">int</span><span class="op" id="2561083">,</span>&nbsp;<span class="ident" id="2561085">signal</span>&nbsp;<span class="builtintype" id="2561092">int</span><span class="op" id="2561095">)</span>&nbsp;<span class="op" id="2561097">(</span><span class="ident" id="2561098">err</span>&nbsp;<span class="builtintype" id="2561102">error</span><span class="op" id="2561107">)</span>&nbsp;<span class="op" id="2561109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561112">return</span>&nbsp;<span class="ident" id="2561119">ptrace</span><span class="op" id="2561125">(</span><span class="ident" id="2561126">PTRACE_SYSCALL</span><span class="op" id="2561140">,</span>&nbsp;<span class="ident" id="2561142">pid</span><span class="op" id="2561145">,</span>&nbsp;<span class="num" id="2561147">0</span><span class="op" id="2561148">,</span>&nbsp;<span class="builtintype" id="2561150">uintptr</span><span class="op" id="2561157">(</span><span class="ident" id="2561158">signal</span><span class="op" id="2561164">)</span><span class="op" id="2561165">)</span><br>
<span class="lineno"></span><span class="op" id="2561167">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="2561170">func</span>&nbsp;<span class="ident" id="2561175">PtraceSingleStep</span><span class="op" id="2561191">(</span><span class="ident" id="2561192">pid</span>&nbsp;<span class="builtintype" id="2561196">int</span><span class="op" id="2561199">)</span>&nbsp;<span class="op" id="2561201">(</span><span class="ident" id="2561202">err</span>&nbsp;<span class="builtintype" id="2561206">error</span><span class="op" id="2561211">)</span>&nbsp;<span class="op" id="2561213">{</span>&nbsp;<span class="keyword" id="2561215">return</span>&nbsp;<span class="ident" id="2561222">ptrace</span><span class="op" id="2561228">(</span><span class="ident" id="2561229">PTRACE_SINGLESTEP</span><span class="op" id="2561246">,</span>&nbsp;<span class="ident" id="2561248">pid</span><span class="op" id="2561251">,</span>&nbsp;<span class="num" id="2561253">0</span><span class="op" id="2561254">,</span>&nbsp;<span class="num" id="2561256">0</span><span class="op" id="2561257">)</span>&nbsp;<span class="op" id="2561259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2561262">func</span>&nbsp;<span class="ident" id="2561267">PtraceAttach</span><span class="op" id="2561279">(</span><span class="ident" id="2561280">pid</span>&nbsp;<span class="builtintype" id="2561284">int</span><span class="op" id="2561287">)</span>&nbsp;<span class="op" id="2561289">(</span><span class="ident" id="2561290">err</span>&nbsp;<span class="builtintype" id="2561294">error</span><span class="op" id="2561299">)</span>&nbsp;<span class="op" id="2561301">{</span>&nbsp;<span class="keyword" id="2561303">return</span>&nbsp;<span class="ident" id="2561310">ptrace</span><span class="op" id="2561316">(</span><span class="ident" id="2561317">PTRACE_ATTACH</span><span class="op" id="2561330">,</span>&nbsp;<span class="ident" id="2561332">pid</span><span class="op" id="2561335">,</span>&nbsp;<span class="num" id="2561337">0</span><span class="op" id="2561338">,</span>&nbsp;<span class="num" id="2561340">0</span><span class="op" id="2561341">)</span>&nbsp;<span class="op" id="2561343">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span><span class="keyword" id="2561346">func</span>&nbsp;<span class="ident" id="2561351">PtraceDetach</span><span class="op" id="2561363">(</span><span class="ident" id="2561364">pid</span>&nbsp;<span class="builtintype" id="2561368">int</span><span class="op" id="2561371">)</span>&nbsp;<span class="op" id="2561373">(</span><span class="ident" id="2561374">err</span>&nbsp;<span class="builtintype" id="2561378">error</span><span class="op" id="2561383">)</span>&nbsp;<span class="op" id="2561385">{</span>&nbsp;<span class="keyword" id="2561387">return</span>&nbsp;<span class="ident" id="2561394">ptrace</span><span class="op" id="2561400">(</span><span class="ident" id="2561401">PTRACE_DETACH</span><span class="op" id="2561414">,</span>&nbsp;<span class="ident" id="2561416">pid</span><span class="op" id="2561419">,</span>&nbsp;<span class="num" id="2561421">0</span><span class="op" id="2561422">,</span>&nbsp;<span class="num" id="2561424">0</span><span class="op" id="2561425">)</span>&nbsp;<span class="op" id="2561427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2561430">//sys&nbsp;&nbsp;&nbsp;&nbspreboot(magic1&nbsp;uint,&nbsp;magic2&nbsp;uint,&nbsp;cmd&nbsp;int,&nbsp;arg&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2561503">func</span>&nbsp;<span class="ident" id="2561508">Reboot</span><span class="op" id="2561514">(</span><span class="ident" id="2561515">cmd</span>&nbsp;<span class="builtintype" id="2561519">int</span><span class="op" id="2561522">)</span>&nbsp;<span class="op" id="2561524">(</span><span class="ident" id="2561525">err</span>&nbsp;<span class="builtintype" id="2561529">error</span><span class="op" id="2561534">)</span>&nbsp;<span class="op" id="2561536">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561539">return</span>&nbsp;<span class="ident" id="2561546">reboot</span><span class="op" id="2561552">(</span><span class="ident" id="2561553">LINUX_REBOOT_MAGIC1</span><span class="op" id="2561572">,</span>&nbsp;<span class="ident" id="2561574">LINUX_REBOOT_MAGIC2</span><span class="op" id="2561593">,</span>&nbsp;<span class="ident" id="2561595">cmd</span><span class="op" id="2561598">,</span>&nbsp;<span class="string" id="2561600">&#34;&#34;</span><span class="op" id="2561602">)</span><br>
<span class="lineno"></span><span class="op" id="2561604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2561607">func</span>&nbsp;<span class="ident" id="2561612">clen</span><span class="op" id="2561616">(</span><span class="ident" id="2561617">n</span>&nbsp;<span class="op" id="2561619">[</span><span class="op" id="2561620">]</span><span class="builtintype" id="2561621">byte</span><span class="op" id="2561625">)</span>&nbsp;<span class="builtintype" id="2561627">int</span>&nbsp;<span class="op" id="2561631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561634">for</span>&nbsp;<span class="ident" id="2561638">i</span>&nbsp;<span class="op" id="2561640">:=</span>&nbsp;<span class="num" id="2561643">0</span><span class="op" id="2561644">;</span>&nbsp;<span class="ident" id="2561646">i</span>&nbsp;<span class="op" id="2561648">&lt;</span>&nbsp;<span class="builtinfunc" id="2561650">len</span><span class="op" id="2561653">(</span><span class="ident" id="2561654">n</span><span class="op" id="2561655">)</span><span class="op" id="2561656">;</span>&nbsp;<span class="ident" id="2561658">i</span><span class="op" id="2561659">++</span>&nbsp;<span class="op" id="2561662">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561666">if</span>&nbsp;<span class="ident" id="2561669">n</span><span class="op" id="2561670">[</span><span class="ident" id="2561671">i</span><span class="op" id="2561672">]</span>&nbsp;<span class="op" id="2561674">==</span>&nbsp;<span class="num" id="2561677">0</span>&nbsp;<span class="op" id="2561679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561684">return</span>&nbsp;<span class="ident" id="2561691">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2561695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2561698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561701">return</span>&nbsp;<span class="builtinfunc" id="2561708">len</span><span class="op" id="2561711">(</span><span class="ident" id="2561712">n</span><span class="op" id="2561713">)</span><br>
<span class="lineno">735</span><span class="op" id="2561715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2561718">func</span>&nbsp;<span class="ident" id="2561723">ReadDirent</span><span class="op" id="2561733">(</span><span class="ident" id="2561734">fd</span>&nbsp;<span class="builtintype" id="2561737">int</span><span class="op" id="2561740">,</span>&nbsp;<span class="ident" id="2561742">buf</span>&nbsp;<span class="op" id="2561746">[</span><span class="op" id="2561747">]</span><span class="builtintype" id="2561748">byte</span><span class="op" id="2561752">)</span>&nbsp;<span class="op" id="2561754">(</span><span class="ident" id="2561755">n</span>&nbsp;<span class="builtintype" id="2561757">int</span><span class="op" id="2561760">,</span>&nbsp;<span class="ident" id="2561762">err</span>&nbsp;<span class="builtintype" id="2561766">error</span><span class="op" id="2561771">)</span>&nbsp;<span class="op" id="2561773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561776">return</span>&nbsp;<span class="ident" id="2561783">Getdents</span><span class="op" id="2561791">(</span><span class="ident" id="2561792">fd</span><span class="op" id="2561794">,</span>&nbsp;<span class="ident" id="2561796">buf</span><span class="op" id="2561799">)</span><br>
<span class="lineno"></span><span class="op" id="2561801">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span><span class="keyword" id="2561804">func</span>&nbsp;<span class="ident" id="2561809">ParseDirent</span><span class="op" id="2561820">(</span><span class="ident" id="2561821">buf</span>&nbsp;<span class="op" id="2561825">[</span><span class="op" id="2561826">]</span><span class="builtintype" id="2561827">byte</span><span class="op" id="2561831">,</span>&nbsp;<span class="ident" id="2561833">max</span>&nbsp;<span class="builtintype" id="2561837">int</span><span class="op" id="2561840">,</span>&nbsp;<span class="ident" id="2561842">names</span>&nbsp;<span class="op" id="2561848">[</span><span class="op" id="2561849">]</span><span class="builtintype" id="2561850">string</span><span class="op" id="2561856">)</span>&nbsp;<span class="op" id="2561858">(</span><span class="ident" id="2561859">consumed</span>&nbsp;<span class="builtintype" id="2561868">int</span><span class="op" id="2561871">,</span>&nbsp;<span class="ident" id="2561873">count</span>&nbsp;<span class="builtintype" id="2561879">int</span><span class="op" id="2561882">,</span>&nbsp;<span class="ident" id="2561884">newnames</span>&nbsp;<span class="op" id="2561893">[</span><span class="op" id="2561894">]</span><span class="builtintype" id="2561895">string</span><span class="op" id="2561901">)</span>&nbsp;<span class="op" id="2561903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561906">origlen</span>&nbsp;<span class="op" id="2561914">:=</span>&nbsp;<span class="builtinfunc" id="2561917">len</span><span class="op" id="2561920">(</span><span class="ident" id="2561921">buf</span><span class="op" id="2561924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561927">count</span>&nbsp;<span class="op" id="2561933">=</span>&nbsp;<span class="num" id="2561935">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2561938">for</span>&nbsp;<span class="ident" id="2561942">max</span>&nbsp;<span class="op" id="2561946">!=</span>&nbsp;<span class="num" id="2561949">0</span>&nbsp;<span class="op" id="2561951">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2561954">len</span><span class="op" id="2561957">(</span><span class="ident" id="2561958">buf</span><span class="op" id="2561961">)</span>&nbsp;<span class="op" id="2561963">&gt;</span>&nbsp;<span class="num" id="2561965">0</span>&nbsp;<span class="op" id="2561967">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2561971">dirent</span>&nbsp;<span class="op" id="2561978">:=</span>&nbsp;<span class="op" id="2561981">(</span><span class="op" id="2561982">*</span><span class="ident" id="2561983">Dirent</span><span class="op" id="2561989">)</span><span class="op" id="2561990">(</span><span class="ident" id="2561991">unsafe</span><span class="op" id="2561997">.</span><span class="ident" id="2561998">Pointer</span><span class="op" id="2562005">(</span><span class="op" id="2562006">&amp;</span><span class="ident" id="2562007">buf</span><span class="op" id="2562010">[</span><span class="num" id="2562011">0</span><span class="op" id="2562012">]</span><span class="op" id="2562013">)</span><span class="op" id="2562014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2562018">buf</span>&nbsp;<span class="op" id="2562022">=</span>&nbsp;<span class="ident" id="2562024">buf</span><span class="op" id="2562027">[</span><span class="ident" id="2562028">dirent</span><span class="op" id="2562034">.</span><span class="ident" id="2562035">Reclen</span><span class="op" id="2562041">:</span><span class="op" id="2562042">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2562046">if</span>&nbsp;<span class="ident" id="2562049">dirent</span><span class="op" id="2562055">.</span><span class="ident" id="2562056">Ino</span>&nbsp;<span class="op" id="2562060">==</span>&nbsp;<span class="num" id="2562063">0</span>&nbsp;<span class="op" id="2562065">{</span>&nbsp;<span class="comment" id="2562067">//&nbsp;File&nbsp;absent&nbsp;in&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2562099">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2562110">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2562114">bytes</span>&nbsp;<span class="op" id="2562120">:=</span>&nbsp;<span class="op" id="2562123">(</span><span class="op" id="2562124">*</span><span class="op" id="2562125">[</span><span class="num" id="2562126">10000</span><span class="op" id="2562131">]</span><span class="builtintype" id="2562132">byte</span><span class="op" id="2562136">)</span><span class="op" id="2562137">(</span><span class="ident" id="2562138">unsafe</span><span class="op" id="2562144">.</span><span class="ident" id="2562145">Pointer</span><span class="op" id="2562152">(</span><span class="op" id="2562153">&amp;</span><span class="ident" id="2562154">dirent</span><span class="op" id="2562160">.</span><span class="ident" id="2562161">Name</span><span class="op" id="2562165">[</span><span class="num" id="2562166">0</span><span class="op" id="2562167">]</span><span class="op" id="2562168">)</span><span class="op" id="2562169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2562173">var</span>&nbsp;<span class="ident" id="2562177">name</span>&nbsp;<span class="op" id="2562182">=</span>&nbsp;<span class="builtintype" id="2562184">string</span><span class="op" id="2562190">(</span><span class="ident" id="2562191">bytes</span><span class="op" id="2562196">[</span><span class="num" id="2562197">0</span><span class="op" id="2562198">:</span><span class="ident" id="2562199">clen</span><span class="op" id="2562203">(</span><span class="ident" id="2562204">bytes</span><span class="op" id="2562209">[</span><span class="op" id="2562210">:</span><span class="op" id="2562211">]</span><span class="op" id="2562212">)</span><span class="op" id="2562213">]</span><span class="op" id="2562214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2562218">if</span>&nbsp;<span class="ident" id="2562221">name</span>&nbsp;<span class="op" id="2562226">==</span>&nbsp;<span class="string" id="2562229">&#34;.&#34;</span>&nbsp;<span class="op" id="2562233">||</span>&nbsp;<span class="ident" id="2562236">name</span>&nbsp;<span class="op" id="2562241">==</span>&nbsp;<span class="string" id="2562244">&#34;..&#34;</span>&nbsp;<span class="op" id="2562249">{</span>&nbsp;<span class="comment" id="2562251">//&nbsp;Useless&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2562271">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2562282">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2562286">max</span><span class="op" id="2562289">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2562294">count</span><span class="op" id="2562299">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2562304">names</span>&nbsp;<span class="op" id="2562310">=</span>&nbsp;<span class="builtinfunc" id="2562312">append</span><span class="op" id="2562318">(</span><span class="ident" id="2562319">names</span><span class="op" id="2562324">,</span>&nbsp;<span class="ident" id="2562326">name</span><span class="op" id="2562330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2562333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2562336">return</span>&nbsp;<span class="ident" id="2562343">origlen</span>&nbsp;<span class="op" id="2562351">-</span>&nbsp;<span class="builtinfunc" id="2562353">len</span><span class="op" id="2562356">(</span><span class="ident" id="2562357">buf</span><span class="op" id="2562360">)</span><span class="op" id="2562361">,</span>&nbsp;<span class="ident" id="2562363">count</span><span class="op" id="2562368">,</span>&nbsp;<span class="ident" id="2562370">names</span><br>
<span class="lineno">760</span><span class="op" id="2562376">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2562379">//sys&nbsp;&nbsp;&nbsp;&nbspmount(source&nbsp;string,&nbsp;target&nbsp;string,&nbsp;fstype&nbsp;string,&nbsp;flags&nbsp;uintptr,&nbsp;data&nbsp;*byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2562476">func</span>&nbsp;<span class="ident" id="2562481">Mount</span><span class="op" id="2562486">(</span><span class="ident" id="2562487">source</span>&nbsp;<span class="builtintype" id="2562494">string</span><span class="op" id="2562500">,</span>&nbsp;<span class="ident" id="2562502">target</span>&nbsp;<span class="builtintype" id="2562509">string</span><span class="op" id="2562515">,</span>&nbsp;<span class="ident" id="2562517">fstype</span>&nbsp;<span class="builtintype" id="2562524">string</span><span class="op" id="2562530">,</span>&nbsp;<span class="ident" id="2562532">flags</span>&nbsp;<span class="builtintype" id="2562538">uintptr</span><span class="op" id="2562545">,</span>&nbsp;<span class="ident" id="2562547">data</span>&nbsp;<span class="builtintype" id="2562552">string</span><span class="op" id="2562558">)</span>&nbsp;<span class="op" id="2562560">(</span><span class="ident" id="2562561">err</span>&nbsp;<span class="builtintype" id="2562565">error</span><span class="op" id="2562570">)</span>&nbsp;<span class="op" id="2562572">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2562575">//&nbsp;Certain&nbsp;file&nbsp;systems&nbsp;get&nbsp;rather&nbsp;angry&nbsp;and&nbsp;EINVAL&nbsp;if&nbsp;you&nbsp;give</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2562640">//&nbsp;them&nbsp;an&nbsp;empty&nbsp;string&nbsp;of&nbsp;data,&nbsp;rather&nbsp;than&nbsp;NULL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2562692">if</span>&nbsp;<span class="ident" id="2562695">data</span>&nbsp;<span class="op" id="2562700">==</span>&nbsp;<span class="string" id="2562703">&#34;&#34;</span>&nbsp;<span class="op" id="2562706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2562710">return</span>&nbsp;<span class="ident" id="2562717">mount</span><span class="op" id="2562722">(</span><span class="ident" id="2562723">source</span><span class="op" id="2562729">,</span>&nbsp;<span class="ident" id="2562731">target</span><span class="op" id="2562737">,</span>&nbsp;<span class="ident" id="2562739">fstype</span><span class="op" id="2562745">,</span>&nbsp;<span class="ident" id="2562747">flags</span><span class="op" id="2562752">,</span>&nbsp;<span class="ident" id="2562754">nil</span><span class="op" id="2562757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2562760">}</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2562763">datap</span><span class="op" id="2562768">,</span>&nbsp;<span class="ident" id="2562770">err</span>&nbsp;<span class="op" id="2562774">:=</span>&nbsp;<span class="ident" id="2562777">BytePtrFromString</span><span class="op" id="2562794">(</span><span class="ident" id="2562795">data</span><span class="op" id="2562799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2562802">if</span>&nbsp;<span class="ident" id="2562805">err</span>&nbsp;<span class="op" id="2562809">!=</span>&nbsp;<span class="ident" id="2562812">nil</span>&nbsp;<span class="op" id="2562816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2562820">return</span>&nbsp;<span class="ident" id="2562827">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2562832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2562835">err</span>&nbsp;<span class="op" id="2562839">=</span>&nbsp;<span class="ident" id="2562841">mount</span><span class="op" id="2562846">(</span><span class="ident" id="2562847">source</span><span class="op" id="2562853">,</span>&nbsp;<span class="ident" id="2562855">target</span><span class="op" id="2562861">,</span>&nbsp;<span class="ident" id="2562863">fstype</span><span class="op" id="2562869">,</span>&nbsp;<span class="ident" id="2562871">flags</span><span class="op" id="2562876">,</span>&nbsp;<span class="ident" id="2562878">datap</span><span class="op" id="2562883">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2562886">use</span><span class="op" id="2562889">(</span><span class="ident" id="2562890">unsafe</span><span class="op" id="2562896">.</span><span class="ident" id="2562897">Pointer</span><span class="op" id="2562904">(</span><span class="ident" id="2562905">datap</span><span class="op" id="2562910">)</span><span class="op" id="2562911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2562914">return</span>&nbsp;<span class="ident" id="2562921">err</span><br>
<span class="lineno"></span><span class="op" id="2562925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2562928">//&nbsp;Sendto</span><br>
<span class="lineno">780</span><span class="comment" id="2562938">//&nbsp;Recvfrom</span><br>
<span class="lineno"></span><span class="comment" id="2562950">//&nbsp;Socketpair</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2562965">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Direct&nbsp;access<br>
<span class="lineno">785</span>&nbsp;*/</span><br>
<span class="lineno"></span><span class="comment" id="2562989">//sys&nbsp;&nbsp;&nbsp;&nbspAccess(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2563040">//sys&nbsp;&nbsp;&nbsp;&nbspAcct(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2563076">//sys&nbsp;&nbsp;&nbsp;&nbspAdjtimex(buf&nbsp;*Timex)&nbsp;(state&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2563126">//sys&nbsp;&nbsp;&nbsp;&nbspChdir(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">790</span><span class="comment" id="2563163">//sys&nbsp;&nbsp;&nbsp;&nbspChmod(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2563213">//sys&nbsp;&nbsp;&nbsp;&nbspChroot(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2563251">//sys&nbsp;&nbsp;&nbsp;&nbspClose(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2563283">//sys&nbsp;&nbsp;&nbsp;&nbspCreat(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2563341">//sysnb&nbsp;&nbsp;&nbsp;&nbspDup(oldfd&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">795</span><span class="comment" id="2563384">//sysnb&nbsp;&nbsp;&nbsp;&nbspDup2(oldfd&nbsp;int,&nbsp;newfd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2563431">//sysnb&nbsp;&nbsp;&nbsp;&nbspDup3(oldfd&nbsp;int,&nbsp;newfd&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2563489">//sysnb&nbsp;&nbsp;&nbsp;&nbspEpollCreate(size&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2563539">//sysnb&nbsp;&nbsp;&nbsp;&nbspEpollCreate1(flag&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2563590">//sysnb&nbsp;&nbsp;&nbsp;&nbspEpollCtl(epfd&nbsp;int,&nbsp;op&nbsp;int,&nbsp;fd&nbsp;int,&nbsp;event&nbsp;*EpollEvent)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">800</span><span class="comment" id="2563664">//sys&nbsp;&nbsp;&nbsp;&nbspEpollWait(epfd&nbsp;int,&nbsp;events&nbsp;[]EpollEvent,&nbsp;msec&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2563740">//sys&nbsp;&nbsp;&nbsp;&nbspExit(code&nbsp;int)&nbsp;=&nbsp;SYS_EXIT_GROUP</span><br>
<span class="lineno"></span><span class="comment" id="2563778">//sys&nbsp;&nbsp;&nbsp;&nbspFaccessat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2563854">//sys&nbsp;&nbsp;&nbsp;&nbspFallocate(fd&nbsp;int,&nbsp;mode&nbsp;uint32,&nbsp;off&nbsp;int64,&nbsp;len&nbsp;int64)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2563925">//sys&nbsp;&nbsp;&nbsp;&nbspFchdir(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">805</span><span class="comment" id="2563958">//sys&nbsp;&nbsp;&nbsp;&nbspFchmod(fd&nbsp;int,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2564004">//sys&nbsp;&nbsp;&nbsp;&nbspFchmodat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2564079">//sys&nbsp;&nbsp;&nbsp;&nbspFchownat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;uid&nbsp;int,&nbsp;gid&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2564159">//sys&nbsp;&nbsp;&nbsp;&nbspfcntl(fd&nbsp;int,&nbsp;cmd&nbsp;int,&nbsp;arg&nbsp;int)&nbsp;(val&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2564218">//sys&nbsp;&nbsp;&nbsp;&nbspFdatasync(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">810</span><span class="comment" id="2564254">//sys&nbsp;&nbsp;&nbsp;&nbspFlock(fd&nbsp;int,&nbsp;how&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2564295">//sys&nbsp;&nbsp;&nbsp;&nbspFsync(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2564327">//sys&nbsp;&nbsp;&nbsp;&nbspGetdents(fd&nbsp;int,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_GETDENTS64</span><br>
<span class="lineno"></span><span class="comment" id="2564398">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetpgid(pid&nbsp;int)&nbsp;(pgid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2564445">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetpgrp()&nbsp;(pid&nbsp;int)</span><br>
<span class="lineno">815</span><span class="comment" id="2564473">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetpid()&nbsp;(pid&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2564500">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetppid()&nbsp;(ppid&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2564529">//sys&nbsp;&nbsp;&nbsp;&nbspGetpriority(which&nbsp;int,&nbsp;who&nbsp;int)&nbsp;(prio&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2564589">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetrusage(who&nbsp;int,&nbsp;rusage&nbsp;*Rusage)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2564644">//sysnb&nbsp;&nbsp;&nbsp;&nbspGettid()&nbsp;(tid&nbsp;int)</span><br>
<span class="lineno">820</span><span class="comment" id="2564671">//sys&nbsp;&nbsp;&nbsp;&nbspGetxattr(path&nbsp;string,&nbsp;attr&nbsp;string,&nbsp;dest&nbsp;[]byte)&nbsp;(sz&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2564745">//sys&nbsp;&nbsp;&nbsp;&nbspInotifyAddWatch(fd&nbsp;int,&nbsp;pathname&nbsp;string,&nbsp;mask&nbsp;uint32)&nbsp;(watchdesc&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2564832">//sysnb&nbsp;&nbsp;&nbsp;&nbspInotifyInit()&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2564874">//sysnb&nbsp;&nbsp;&nbsp;&nbspInotifyInit1(flags&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2564926">//sysnb&nbsp;&nbsp;&nbsp;&nbspInotifyRmWatch(fd&nbsp;int,&nbsp;watchdesc&nbsp;uint32)&nbsp;(success&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">825</span><span class="comment" id="2565000">//sysnb&nbsp;&nbsp;&nbsp;&nbspKill(pid&nbsp;int,&nbsp;sig&nbsp;Signal)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2565046">//sys&nbsp;&nbsp;&nbsp;&nbspKlogctl(typ&nbsp;int,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_SYSLOG</span><br>
<span class="lineno"></span><span class="comment" id="2565113">//sys&nbsp;&nbsp;&nbsp;&nbspLink(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2565168">//sys&nbsp;&nbsp;&nbsp;&nbspListxattr(path&nbsp;string,&nbsp;dest&nbsp;[]byte)&nbsp;(sz&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2565230">//sys&nbsp;&nbsp;&nbsp;&nbspMkdir(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">830</span><span class="comment" id="2565280">//sys&nbsp;&nbsp;&nbsp;&nbspMkdirat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2565343">//sys&nbsp;&nbsp;&nbsp;&nbspMknod(path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;dev&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2565402">//sys&nbsp;&nbsp;&nbsp;&nbspMknodat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;dev&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2565474">//sys&nbsp;&nbsp;&nbsp;&nbspNanosleep(time&nbsp;*Timespec,&nbsp;leftover&nbsp;*Timespec)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2565538">//sys&nbsp;&nbsp;&nbsp;&nbspPause()&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">835</span><span class="comment" id="2565564">//sys&nbsp;&nbsp;&nbsp;&nbspPivotRoot(newroot&nbsp;string,&nbsp;putold&nbsp;string)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_PIVOT_ROOT</span><br>
<span class="lineno"></span><span class="comment" id="2565640">//sysnb&nbsp;prlimit(pid&nbsp;int,&nbsp;resource&nbsp;int,&nbsp;old&nbsp;*Rlimit,&nbsp;newlimit&nbsp;*Rlimit)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_PRLIMIT64</span><br>
<span class="lineno"></span><span class="comment" id="2565738">//sys&nbsp;&nbsp;&nbsp;&nbspread(fd&nbsp;int,&nbsp;p&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2565786">//sys&nbsp;&nbsp;&nbsp;&nbspReadlink(path&nbsp;string,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2565845">//sys&nbsp;&nbsp;&nbsp;&nbspRemovexattr(path&nbsp;string,&nbsp;attr&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">840</span><span class="comment" id="2565901">//sys&nbsp;&nbsp;&nbsp;&nbspRename(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2565958">//sys&nbsp;&nbsp;&nbsp;&nbspRenameat(olddirfd&nbsp;int,&nbsp;oldpath&nbsp;string,&nbsp;newdirfd&nbsp;int,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2566045">//sys&nbsp;&nbsp;&nbsp;&nbspRmdir(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2566082">//sys&nbsp;&nbsp;&nbsp;&nbspSetdomainname(p&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2566124">//sys&nbsp;&nbsp;&nbsp;&nbspSethostname(p&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">845</span><span class="comment" id="2566164">//sysnb&nbsp;&nbsp;&nbsp;&nbspSetpgid(pid&nbsp;int,&nbsp;pgid&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2566211">//sysnb&nbsp;&nbsp;&nbsp;&nbspSetsid()&nbsp;(pid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2566249">//sysnb&nbsp;&nbsp;&nbsp;&nbspSettimeofday(tv&nbsp;*Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2566296">//&nbsp;issue&nbsp;1435.</span><br>
<span class="lineno">850</span><span class="comment" id="2566311">//&nbsp;On&nbsp;linux&nbsp;Setuid&nbsp;and&nbsp;Setgid&nbsp;only&nbsp;affects&nbsp;the&nbsp;current&nbsp;thread,&nbsp;not&nbsp;the&nbsp;process.</span><br>
<span class="lineno"></span><span class="comment" id="2566391">//&nbsp;This&nbsp;does&nbsp;not&nbsp;match&nbsp;what&nbsp;most&nbsp;callers&nbsp;expect&nbsp;so&nbsp;we&nbsp;must&nbsp;return&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2566466">//&nbsp;here&nbsp;rather&nbsp;than&nbsp;letting&nbsp;the&nbsp;caller&nbsp;think&nbsp;that&nbsp;the&nbsp;call&nbsp;succeeded.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2566537">func</span>&nbsp;<span class="ident" id="2566542">Setuid</span><span class="op" id="2566548">(</span><span class="ident" id="2566549">uid</span>&nbsp;<span class="builtintype" id="2566553">int</span><span class="op" id="2566556">)</span>&nbsp;<span class="op" id="2566558">(</span><span class="ident" id="2566559">err</span>&nbsp;<span class="builtintype" id="2566563">error</span><span class="op" id="2566568">)</span>&nbsp;<span class="op" id="2566570">{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2566573">return</span>&nbsp;<span class="ident" id="2566580">EOPNOTSUPP</span><br>
<span class="lineno"></span><span class="op" id="2566591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2566594">func</span>&nbsp;<span class="ident" id="2566599">Setgid</span><span class="op" id="2566605">(</span><span class="ident" id="2566606">uid</span>&nbsp;<span class="builtintype" id="2566610">int</span><span class="op" id="2566613">)</span>&nbsp;<span class="op" id="2566615">(</span><span class="ident" id="2566616">err</span>&nbsp;<span class="builtintype" id="2566620">error</span><span class="op" id="2566625">)</span>&nbsp;<span class="op" id="2566627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2566630">return</span>&nbsp;<span class="ident" id="2566637">EOPNOTSUPP</span><br>
<span class="lineno">860</span><span class="op" id="2566648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2566651">//sys&nbsp;&nbsp;&nbsp;&nbspSetpriority(which&nbsp;int,&nbsp;who&nbsp;int,&nbsp;prio&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2566711">//sys&nbsp;&nbsp;&nbsp;&nbspSetxattr(path&nbsp;string,&nbsp;attr&nbsp;string,&nbsp;data&nbsp;[]byte,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2566788">//sys&nbsp;&nbsp;&nbsp;&nbspSymlink(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">865</span><span class="comment" id="2566846">//sys&nbsp;&nbsp;&nbsp;&nbspSync()</span><br>
<span class="lineno"></span><span class="comment" id="2566859">//sysnb&nbsp;&nbsp;&nbsp;&nbspSysinfo(info&nbsp;*Sysinfo_t)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2566904">//sys&nbsp;&nbsp;&nbsp;&nbspTee(rfd&nbsp;int,&nbsp;wfd&nbsp;int,&nbsp;len&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(n&nbsp;int64,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2566973">//sysnb&nbsp;&nbsp;&nbsp;&nbspTgkill(tgid&nbsp;int,&nbsp;tid&nbsp;int,&nbsp;sig&nbsp;Signal)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2567031">//sysnb&nbsp;&nbsp;&nbsp;&nbspTimes(tms&nbsp;*Tms)&nbsp;(ticks&nbsp;uintptr,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">870</span><span class="comment" id="2567082">//sysnb&nbsp;&nbsp;&nbsp;&nbspUmask(mask&nbsp;int)&nbsp;(oldmask&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2567120">//sysnb&nbsp;&nbsp;&nbsp;&nbspUname(buf&nbsp;*Utsname)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2567160">//sys&nbsp;&nbsp;&nbsp;&nbspUnlink(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2567198">//sys&nbsp;&nbsp;&nbsp;&nbspUnlinkat(dirfd&nbsp;int,&nbsp;path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2567249">//sys&nbsp;&nbsp;&nbsp;&nbspUnmount(target&nbsp;string,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_UMOUNT2</span><br>
<span class="lineno">875</span><span class="comment" id="2567315">//sys&nbsp;&nbsp;&nbsp;&nbspUnshare(flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2567352">//sys&nbsp;&nbsp;&nbsp;&nbspUstat(dev&nbsp;int,&nbsp;ubuf&nbsp;*Ustat_t)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2567400">//sys&nbsp;&nbsp;&nbsp;&nbspUtime(path&nbsp;string,&nbsp;buf&nbsp;*Utimbuf)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2567451">//sys&nbsp;&nbsp;&nbsp;&nbspwrite(fd&nbsp;int,&nbsp;p&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2567500">//sys&nbsp;&nbsp;&nbsp;&nbspexitThread(code&nbsp;int)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_EXIT</span><br>
<span class="lineno">880</span><span class="comment" id="2567550">//sys&nbsp;&nbsp;&nbsp;&nbspreadlen(fd&nbsp;int,&nbsp;p&nbsp;*byte,&nbsp;np&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_READ</span><br>
<span class="lineno"></span><span class="comment" id="2567619">//sys&nbsp;&nbsp;&nbsp;&nbspwritelen(fd&nbsp;int,&nbsp;p&nbsp;*byte,&nbsp;np&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_WRITE</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2567691">//&nbsp;mmap&nbsp;varies&nbsp;by&nbsp;architecture;&nbsp;see&nbsp;syscall_linux_*.go.</span><br>
<span class="lineno"></span><span class="comment" id="2567747">//sys&nbsp;&nbsp;&nbsp;&nbspmunmap(addr&nbsp;uintptr,&nbsp;length&nbsp;uintptr)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">885</span><br>
<span class="lineno"></span><span class="keyword" id="2567803">var</span>&nbsp;<span class="ident" id="2567807">mapper</span>&nbsp;<span class="op" id="2567814">=</span>&nbsp;<span class="op" id="2567816">&amp;</span><span class="ident" id="2567817">mmapper</span><span class="op" id="2567824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2567827">active</span><span class="op" id="2567833">:</span>&nbsp;<span class="builtinfunc" id="2567835">make</span><span class="op" id="2567839">(</span><span class="keyword" id="2567840">map</span><span class="op" id="2567843">[</span><span class="op" id="2567844">*</span><span class="builtintype" id="2567845">byte</span><span class="op" id="2567849">]</span><span class="op" id="2567850">[</span><span class="op" id="2567851">]</span><span class="builtintype" id="2567852">byte</span><span class="op" id="2567856">)</span><span class="op" id="2567857">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2567860">mmap</span><span class="op" id="2567864">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2567868">mmap</span><span class="op" id="2567872">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2567875">munmap</span><span class="op" id="2567881">:</span>&nbsp;<span class="ident" id="2567883">munmap</span><span class="op" id="2567889">,</span><br>
<span class="lineno">890</span><span class="op" id="2567891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2567894">func</span>&nbsp;<span class="ident" id="2567899">Mmap</span><span class="op" id="2567903">(</span><span class="ident" id="2567904">fd</span>&nbsp;<span class="builtintype" id="2567907">int</span><span class="op" id="2567910">,</span>&nbsp;<span class="ident" id="2567912">offset</span>&nbsp;<span class="ident" id="2567919">int64</span><span class="op" id="2567924">,</span>&nbsp;<span class="ident" id="2567926">length</span>&nbsp;<span class="builtintype" id="2567933">int</span><span class="op" id="2567936">,</span>&nbsp;<span class="ident" id="2567938">prot</span>&nbsp;<span class="builtintype" id="2567943">int</span><span class="op" id="2567946">,</span>&nbsp;<span class="ident" id="2567948">flags</span>&nbsp;<span class="builtintype" id="2567954">int</span><span class="op" id="2567957">)</span>&nbsp;<span class="op" id="2567959">(</span><span class="ident" id="2567960">data</span>&nbsp;<span class="op" id="2567965">[</span><span class="op" id="2567966">]</span><span class="builtintype" id="2567967">byte</span><span class="op" id="2567971">,</span>&nbsp;<span class="ident" id="2567973">err</span>&nbsp;<span class="builtintype" id="2567977">error</span><span class="op" id="2567982">)</span>&nbsp;<span class="op" id="2567984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2567987">return</span>&nbsp;<span class="ident" id="2567994">mapper</span><span class="op" id="2568000">.</span><span class="ident" id="2568001">Mmap</span><span class="op" id="2568005">(</span><span class="ident" id="2568006">fd</span><span class="op" id="2568008">,</span>&nbsp;<span class="ident" id="2568010">offset</span><span class="op" id="2568016">,</span>&nbsp;<span class="ident" id="2568018">length</span><span class="op" id="2568024">,</span>&nbsp;<span class="ident" id="2568026">prot</span><span class="op" id="2568030">,</span>&nbsp;<span class="ident" id="2568032">flags</span><span class="op" id="2568037">)</span><br>
<span class="lineno"></span><span class="op" id="2568039">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span><span class="keyword" id="2568042">func</span>&nbsp;<span class="ident" id="2568047">Munmap</span><span class="op" id="2568053">(</span><span class="ident" id="2568054">b</span>&nbsp;<span class="op" id="2568056">[</span><span class="op" id="2568057">]</span><span class="builtintype" id="2568058">byte</span><span class="op" id="2568062">)</span>&nbsp;<span class="op" id="2568064">(</span><span class="ident" id="2568065">err</span>&nbsp;<span class="builtintype" id="2568069">error</span><span class="op" id="2568074">)</span>&nbsp;<span class="op" id="2568076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2568079">return</span>&nbsp;<span class="ident" id="2568086">mapper</span><span class="op" id="2568092">.</span><span class="ident" id="2568093">Munmap</span><span class="op" id="2568099">(</span><span class="ident" id="2568100">b</span><span class="op" id="2568101">)</span><br>
<span class="lineno"></span><span class="op" id="2568103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="2568106">//sys&nbsp;&nbsp;&nbsp;&nbspMadvise(b&nbsp;[]byte,&nbsp;advice&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2568154">//sys&nbsp;&nbsp;&nbsp;&nbspMprotect(b&nbsp;[]byte,&nbsp;prot&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2568201">//sys&nbsp;&nbsp;&nbsp;&nbspMlock(b&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2568235">//sys&nbsp;&nbsp;&nbsp;&nbspMunlock(b&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2568271">//sys&nbsp;&nbsp;&nbsp;&nbspMlockall(flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">905</span><span class="comment" id="2568309">//sys&nbsp;&nbsp;&nbsp;&nbspMunlockall()&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2568341">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Unimplemented<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno">910</span><span class="comment" id="2568365">//&nbsp;AddKey</span><br>
<span class="lineno"></span><span class="comment" id="2568375">//&nbsp;AfsSyscall</span><br>
<span class="lineno"></span><span class="comment" id="2568389">//&nbsp;Alarm</span><br>
<span class="lineno"></span><span class="comment" id="2568398">//&nbsp;ArchPrctl</span><br>
<span class="lineno"></span><span class="comment" id="2568411">//&nbsp;Brk</span><br>
<span class="lineno">915</span><span class="comment" id="2568418">//&nbsp;Capget</span><br>
<span class="lineno"></span><span class="comment" id="2568428">//&nbsp;Capset</span><br>
<span class="lineno"></span><span class="comment" id="2568438">//&nbsp;ClockGetres</span><br>
<span class="lineno"></span><span class="comment" id="2568453">//&nbsp;ClockGettime</span><br>
<span class="lineno"></span><span class="comment" id="2568469">//&nbsp;ClockNanosleep</span><br>
<span class="lineno">920</span><span class="comment" id="2568487">//&nbsp;ClockSettime</span><br>
<span class="lineno"></span><span class="comment" id="2568503">//&nbsp;Clone</span><br>
<span class="lineno"></span><span class="comment" id="2568512">//&nbsp;CreateModule</span><br>
<span class="lineno"></span><span class="comment" id="2568528">//&nbsp;DeleteModule</span><br>
<span class="lineno"></span><span class="comment" id="2568544">//&nbsp;EpollCtlOld</span><br>
<span class="lineno">925</span><span class="comment" id="2568559">//&nbsp;EpollPwait</span><br>
<span class="lineno"></span><span class="comment" id="2568573">//&nbsp;EpollWaitOld</span><br>
<span class="lineno"></span><span class="comment" id="2568589">//&nbsp;Eventfd</span><br>
<span class="lineno"></span><span class="comment" id="2568600">//&nbsp;Execve</span><br>
<span class="lineno"></span><span class="comment" id="2568610">//&nbsp;Fadvise64</span><br>
<span class="lineno">930</span><span class="comment" id="2568623">//&nbsp;Fgetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2568636">//&nbsp;Flistxattr</span><br>
<span class="lineno"></span><span class="comment" id="2568650">//&nbsp;Fork</span><br>
<span class="lineno"></span><span class="comment" id="2568658">//&nbsp;Fremovexattr</span><br>
<span class="lineno"></span><span class="comment" id="2568674">//&nbsp;Fsetxattr</span><br>
<span class="lineno">935</span><span class="comment" id="2568687">//&nbsp;Futex</span><br>
<span class="lineno"></span><span class="comment" id="2568696">//&nbsp;GetKernelSyms</span><br>
<span class="lineno"></span><span class="comment" id="2568713">//&nbsp;GetMempolicy</span><br>
<span class="lineno"></span><span class="comment" id="2568729">//&nbsp;GetRobustList</span><br>
<span class="lineno"></span><span class="comment" id="2568746">//&nbsp;GetThreadArea</span><br>
<span class="lineno">940</span><span class="comment" id="2568763">//&nbsp;Getitimer</span><br>
<span class="lineno"></span><span class="comment" id="2568776">//&nbsp;Getpmsg</span><br>
<span class="lineno"></span><span class="comment" id="2568787">//&nbsp;IoCancel</span><br>
<span class="lineno"></span><span class="comment" id="2568799">//&nbsp;IoDestroy</span><br>
<span class="lineno"></span><span class="comment" id="2568812">//&nbsp;IoGetevents</span><br>
<span class="lineno">945</span><span class="comment" id="2568827">//&nbsp;IoSetup</span><br>
<span class="lineno"></span><span class="comment" id="2568838">//&nbsp;IoSubmit</span><br>
<span class="lineno"></span><span class="comment" id="2568850">//&nbsp;Ioctl</span><br>
<span class="lineno"></span><span class="comment" id="2568859">//&nbsp;IoprioGet</span><br>
<span class="lineno"></span><span class="comment" id="2568872">//&nbsp;IoprioSet</span><br>
<span class="lineno">950</span><span class="comment" id="2568885">//&nbsp;KexecLoad</span><br>
<span class="lineno"></span><span class="comment" id="2568898">//&nbsp;Keyctl</span><br>
<span class="lineno"></span><span class="comment" id="2568908">//&nbsp;Lgetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2568921">//&nbsp;Llistxattr</span><br>
<span class="lineno"></span><span class="comment" id="2568935">//&nbsp;LookupDcookie</span><br>
<span class="lineno">955</span><span class="comment" id="2568952">//&nbsp;Lremovexattr</span><br>
<span class="lineno"></span><span class="comment" id="2568968">//&nbsp;Lsetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2568981">//&nbsp;Mbind</span><br>
<span class="lineno"></span><span class="comment" id="2568990">//&nbsp;MigratePages</span><br>
<span class="lineno"></span><span class="comment" id="2569006">//&nbsp;Mincore</span><br>
<span class="lineno">960</span><span class="comment" id="2569017">//&nbsp;ModifyLdt</span><br>
<span class="lineno"></span><span class="comment" id="2569030">//&nbsp;Mount</span><br>
<span class="lineno"></span><span class="comment" id="2569039">//&nbsp;MovePages</span><br>
<span class="lineno"></span><span class="comment" id="2569052">//&nbsp;Mprotect</span><br>
<span class="lineno"></span><span class="comment" id="2569064">//&nbsp;MqGetsetattr</span><br>
<span class="lineno">965</span><span class="comment" id="2569080">//&nbsp;MqNotify</span><br>
<span class="lineno"></span><span class="comment" id="2569092">//&nbsp;MqOpen</span><br>
<span class="lineno"></span><span class="comment" id="2569102">//&nbsp;MqTimedreceive</span><br>
<span class="lineno"></span><span class="comment" id="2569120">//&nbsp;MqTimedsend</span><br>
<span class="lineno"></span><span class="comment" id="2569135">//&nbsp;MqUnlink</span><br>
<span class="lineno">970</span><span class="comment" id="2569147">//&nbsp;Mremap</span><br>
<span class="lineno"></span><span class="comment" id="2569157">//&nbsp;Msgctl</span><br>
<span class="lineno"></span><span class="comment" id="2569167">//&nbsp;Msgget</span><br>
<span class="lineno"></span><span class="comment" id="2569177">//&nbsp;Msgrcv</span><br>
<span class="lineno"></span><span class="comment" id="2569187">//&nbsp;Msgsnd</span><br>
<span class="lineno">975</span><span class="comment" id="2569197">//&nbsp;Msync</span><br>
<span class="lineno"></span><span class="comment" id="2569206">//&nbsp;Newfstatat</span><br>
<span class="lineno"></span><span class="comment" id="2569220">//&nbsp;Nfsservctl</span><br>
<span class="lineno"></span><span class="comment" id="2569234">//&nbsp;Personality</span><br>
<span class="lineno"></span><span class="comment" id="2569249">//&nbsp;Poll</span><br>
<span class="lineno">980</span><span class="comment" id="2569257">//&nbsp;Ppoll</span><br>
<span class="lineno"></span><span class="comment" id="2569266">//&nbsp;Prctl</span><br>
<span class="lineno"></span><span class="comment" id="2569275">//&nbsp;Pselect6</span><br>
<span class="lineno"></span><span class="comment" id="2569287">//&nbsp;Ptrace</span><br>
<span class="lineno"></span><span class="comment" id="2569297">//&nbsp;Putpmsg</span><br>
<span class="lineno">985</span><span class="comment" id="2569308">//&nbsp;QueryModule</span><br>
<span class="lineno"></span><span class="comment" id="2569323">//&nbsp;Quotactl</span><br>
<span class="lineno"></span><span class="comment" id="2569335">//&nbsp;Readahead</span><br>
<span class="lineno"></span><span class="comment" id="2569348">//&nbsp;Readv</span><br>
<span class="lineno"></span><span class="comment" id="2569357">//&nbsp;RemapFilePages</span><br>
<span class="lineno">990</span><span class="comment" id="2569375">//&nbsp;RequestKey</span><br>
<span class="lineno"></span><span class="comment" id="2569389">//&nbsp;RestartSyscall</span><br>
<span class="lineno"></span><span class="comment" id="2569407">//&nbsp;RtSigaction</span><br>
<span class="lineno"></span><span class="comment" id="2569422">//&nbsp;RtSigpending</span><br>
<span class="lineno"></span><span class="comment" id="2569438">//&nbsp;RtSigprocmask</span><br>
<span class="lineno">995</span><span class="comment" id="2569455">//&nbsp;RtSigqueueinfo</span><br>
<span class="lineno"></span><span class="comment" id="2569473">//&nbsp;RtSigreturn</span><br>
<span class="lineno"></span><span class="comment" id="2569488">//&nbsp;RtSigsuspend</span><br>
<span class="lineno"></span><span class="comment" id="2569504">//&nbsp;RtSigtimedwait</span><br>
<span class="lineno"></span><span class="comment" id="2569522">//&nbsp;SchedGetPriorityMax</span><br>
<span class="lineno">1000</span><span class="comment" id="2569545">//&nbsp;SchedGetPriorityMin</span><br>
<span class="lineno"></span><span class="comment" id="2569568">//&nbsp;SchedGetaffinity</span><br>
<span class="lineno"></span><span class="comment" id="2569588">//&nbsp;SchedGetparam</span><br>
<span class="lineno"></span><span class="comment" id="2569605">//&nbsp;SchedGetscheduler</span><br>
<span class="lineno"></span><span class="comment" id="2569626">//&nbsp;SchedRrGetInterval</span><br>
<span class="lineno">1005</span><span class="comment" id="2569648">//&nbsp;SchedSetaffinity</span><br>
<span class="lineno"></span><span class="comment" id="2569668">//&nbsp;SchedSetparam</span><br>
<span class="lineno"></span><span class="comment" id="2569685">//&nbsp;SchedYield</span><br>
<span class="lineno"></span><span class="comment" id="2569699">//&nbsp;Security</span><br>
<span class="lineno"></span><span class="comment" id="2569711">//&nbsp;Semctl</span><br>
<span class="lineno">1010</span><span class="comment" id="2569721">//&nbsp;Semget</span><br>
<span class="lineno"></span><span class="comment" id="2569731">//&nbsp;Semop</span><br>
<span class="lineno"></span><span class="comment" id="2569740">//&nbsp;Semtimedop</span><br>
<span class="lineno"></span><span class="comment" id="2569754">//&nbsp;SetMempolicy</span><br>
<span class="lineno"></span><span class="comment" id="2569770">//&nbsp;SetRobustList</span><br>
<span class="lineno">1015</span><span class="comment" id="2569787">//&nbsp;SetThreadArea</span><br>
<span class="lineno"></span><span class="comment" id="2569804">//&nbsp;SetTidAddress</span><br>
<span class="lineno"></span><span class="comment" id="2569821">//&nbsp;Shmat</span><br>
<span class="lineno"></span><span class="comment" id="2569830">//&nbsp;Shmctl</span><br>
<span class="lineno"></span><span class="comment" id="2569840">//&nbsp;Shmdt</span><br>
<span class="lineno">1020</span><span class="comment" id="2569849">//&nbsp;Shmget</span><br>
<span class="lineno"></span><span class="comment" id="2569859">//&nbsp;Sigaltstack</span><br>
<span class="lineno"></span><span class="comment" id="2569874">//&nbsp;Signalfd</span><br>
<span class="lineno"></span><span class="comment" id="2569886">//&nbsp;Swapoff</span><br>
<span class="lineno"></span><span class="comment" id="2569897">//&nbsp;Swapon</span><br>
<span class="lineno">1025</span><span class="comment" id="2569907">//&nbsp;Sysfs</span><br>
<span class="lineno"></span><span class="comment" id="2569916">//&nbsp;TimerCreate</span><br>
<span class="lineno"></span><span class="comment" id="2569931">//&nbsp;TimerDelete</span><br>
<span class="lineno"></span><span class="comment" id="2569946">//&nbsp;TimerGetoverrun</span><br>
<span class="lineno"></span><span class="comment" id="2569965">//&nbsp;TimerGettime</span><br>
<span class="lineno">1030</span><span class="comment" id="2569981">//&nbsp;TimerSettime</span><br>
<span class="lineno"></span><span class="comment" id="2569997">//&nbsp;Timerfd</span><br>
<span class="lineno"></span><span class="comment" id="2570008">//&nbsp;Tkill&nbsp;(obsolete)</span><br>
<span class="lineno"></span><span class="comment" id="2570028">//&nbsp;Tuxcall</span><br>
<span class="lineno"></span><span class="comment" id="2570039">//&nbsp;Umount2</span><br>
<span class="lineno">1035</span><span class="comment" id="2570050">//&nbsp;Uselib</span><br>
<span class="lineno"></span><span class="comment" id="2570060">//&nbsp;Utimensat</span><br>
<span class="lineno"></span><span class="comment" id="2570073">//&nbsp;Vfork</span><br>
<span class="lineno"></span><span class="comment" id="2570082">//&nbsp;Vhangup</span><br>
<span class="lineno"></span><span class="comment" id="2570093">//&nbsp;Vmsplice</span><br>
<span class="lineno">1040</span><span class="comment" id="2570105">//&nbsp;Vserver</span><br>
<span class="lineno"></span><span class="comment" id="2570116">//&nbsp;Waitid</span><br>
<span class="lineno"></span><span class="comment" id="2570126">//&nbsp;_Sysctl</span>
</div>
</body>
</html>
