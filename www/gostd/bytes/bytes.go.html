<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>bytes</h2>
<ul>
<li><a href="/gostd/bytes/buffer.go.html">buffer.go</a></li>
<li><a href="/gostd/bytes/buffer_test.go.html">buffer_test.go</a></li>
<li><a href="/gostd/bytes/bytes.go.html">bytes.go</a></li>
<li><a href="/gostd/bytes/bytes_decl.go.html">bytes_decl.go</a></li>
<li><a href="/gostd/bytes/bytes_test.go.html">bytes_test.go</a></li>
<li><a href="/gostd/bytes/compare_test.go.html">compare_test.go</a></li>
<li><a href="/gostd/bytes/equal_test.go.html">equal_test.go</a></li>
<li><a href="/gostd/bytes/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/bytes/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/bytes/reader.go.html">reader.go</a></li>
<li><a href="/gostd/bytes/reader_test.go.html">reader_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1352011">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1352066">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1352120">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1352171">//&nbsp;Package&nbsp;bytes&nbsp;implements&nbsp;functions&nbsp;for&nbsp;the&nbsp;manipulation&nbsp;of&nbsp;byte&nbsp;slices.</span><br>
<span class="lineno"></span><span class="comment" id="1352246">//&nbsp;It&nbsp;is&nbsp;analogous&nbsp;to&nbsp;the&nbsp;facilities&nbsp;of&nbsp;the&nbsp;strings&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="1352307">package</span>&nbsp;<span class="ident" id="1352315">bytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1352322">import</span>&nbsp;<span class="op" id="1352329">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1352332">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1352343">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="1352358">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1352361">func</span>&nbsp;<span class="ident" id="1352366">equalPortable</span><span class="op" id="1352379">(</span><span class="ident" id="1352380">a</span><span class="op" id="1352381">,</span>&nbsp;<span class="ident" id="1352383">b</span>&nbsp;<span class="op" id="1352385">[</span><span class="op" id="1352386">]</span><span class="builtintype" id="1352387">byte</span><span class="op" id="1352391">)</span>&nbsp;<span class="builtintype" id="1352393">bool</span>&nbsp;<span class="op" id="1352398">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352401">if</span>&nbsp;<span class="builtinfunc" id="1352404">len</span><span class="op" id="1352407">(</span><span class="ident" id="1352408">a</span><span class="op" id="1352409">)</span>&nbsp;<span class="op" id="1352411">!=</span>&nbsp;<span class="builtinfunc" id="1352414">len</span><span class="op" id="1352417">(</span><span class="ident" id="1352418">b</span><span class="op" id="1352419">)</span>&nbsp;<span class="op" id="1352421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352425">return</span>&nbsp;<span class="builtintype" id="1352432">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1352439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352442">for</span>&nbsp;<span class="ident" id="1352446">i</span><span class="op" id="1352447">,</span>&nbsp;<span class="ident" id="1352449">c</span>&nbsp;<span class="op" id="1352451">:=</span>&nbsp;<span class="keyword" id="1352454">range</span>&nbsp;<span class="ident" id="1352460">a</span>&nbsp;<span class="op" id="1352462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352466">if</span>&nbsp;<span class="ident" id="1352469">c</span>&nbsp;<span class="op" id="1352471">!=</span>&nbsp;<span class="ident" id="1352474">b</span><span class="op" id="1352475">[</span><span class="ident" id="1352476">i</span><span class="op" id="1352477">]</span>&nbsp;<span class="op" id="1352479">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352484">return</span>&nbsp;<span class="builtintype" id="1352491">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1352499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1352502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352505">return</span>&nbsp;<span class="builtintype" id="1352512">true</span><br>
<span class="lineno"></span><span class="op" id="1352517">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="1352520">//&nbsp;explode&nbsp;splits&nbsp;s&nbsp;into&nbsp;a&nbsp;slice&nbsp;of&nbsp;UTF-8&nbsp;sequences,&nbsp;one&nbsp;per&nbsp;Unicode&nbsp;character&nbsp;(still&nbsp;slices&nbsp;of&nbsp;bytes),</span><br>
<span class="lineno"></span><span class="comment" id="1352624">//&nbsp;up&nbsp;to&nbsp;a&nbsp;maximum&nbsp;of&nbsp;n&nbsp;byte&nbsp;slices.&nbsp;Invalid&nbsp;UTF-8&nbsp;sequences&nbsp;are&nbsp;chopped&nbsp;into&nbsp;individual&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="1352720">func</span>&nbsp;<span class="ident" id="1352725">explode</span><span class="op" id="1352732">(</span><span class="ident" id="1352733">s</span>&nbsp;<span class="op" id="1352735">[</span><span class="op" id="1352736">]</span><span class="builtintype" id="1352737">byte</span><span class="op" id="1352741">,</span>&nbsp;<span class="ident" id="1352743">n</span>&nbsp;<span class="builtintype" id="1352745">int</span><span class="op" id="1352748">)</span>&nbsp;<span class="op" id="1352750">[</span><span class="op" id="1352751">]</span><span class="op" id="1352752">[</span><span class="op" id="1352753">]</span><span class="builtintype" id="1352754">byte</span>&nbsp;<span class="op" id="1352759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352762">if</span>&nbsp;<span class="ident" id="1352765">n</span>&nbsp;<span class="op" id="1352767">&lt;=</span>&nbsp;<span class="num" id="1352770">0</span>&nbsp;<span class="op" id="1352772">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352776">n</span>&nbsp;<span class="op" id="1352778">=</span>&nbsp;<span class="builtinfunc" id="1352780">len</span><span class="op" id="1352783">(</span><span class="ident" id="1352784">s</span><span class="op" id="1352785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1352788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352791">a</span>&nbsp;<span class="op" id="1352793">:=</span>&nbsp;<span class="builtinfunc" id="1352796">make</span><span class="op" id="1352800">(</span><span class="op" id="1352801">[</span><span class="op" id="1352802">]</span><span class="op" id="1352803">[</span><span class="op" id="1352804">]</span><span class="builtintype" id="1352805">byte</span><span class="op" id="1352809">,</span>&nbsp;<span class="ident" id="1352811">n</span><span class="op" id="1352812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352815">var</span>&nbsp;<span class="ident" id="1352819">size</span>&nbsp;<span class="builtintype" id="1352824">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352829">na</span>&nbsp;<span class="op" id="1352832">:=</span>&nbsp;<span class="num" id="1352835">0</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352838">for</span>&nbsp;<span class="builtinfunc" id="1352842">len</span><span class="op" id="1352845">(</span><span class="ident" id="1352846">s</span><span class="op" id="1352847">)</span>&nbsp;<span class="op" id="1352849">&gt;</span>&nbsp;<span class="num" id="1352851">0</span>&nbsp;<span class="op" id="1352853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352857">if</span>&nbsp;<span class="ident" id="1352860">na</span><span class="op" id="1352862">+</span><span class="num" id="1352863">1</span>&nbsp;<span class="op" id="1352865">&gt;=</span>&nbsp;<span class="ident" id="1352868">n</span>&nbsp;<span class="op" id="1352870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352875">a</span><span class="op" id="1352876">[</span><span class="ident" id="1352877">na</span><span class="op" id="1352879">]</span>&nbsp;<span class="op" id="1352881">=</span>&nbsp;<span class="ident" id="1352883">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352888">na</span><span class="op" id="1352890">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352896">break</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1352904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352908">_</span><span class="op" id="1352909">,</span>&nbsp;<span class="ident" id="1352911">size</span>&nbsp;<span class="op" id="1352916">=</span>&nbsp;<span class="ident" id="1352918">utf8</span><span class="op" id="1352922">.</span><span class="ident" id="1352923">DecodeRune</span><span class="op" id="1352933">(</span><span class="ident" id="1352934">s</span><span class="op" id="1352935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352939">a</span><span class="op" id="1352940">[</span><span class="ident" id="1352941">na</span><span class="op" id="1352943">]</span>&nbsp;<span class="op" id="1352945">=</span>&nbsp;<span class="ident" id="1352947">s</span><span class="op" id="1352948">[</span><span class="num" id="1352949">0</span><span class="op" id="1352950">:</span><span class="ident" id="1352951">size</span><span class="op" id="1352955">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352959">s</span>&nbsp;<span class="op" id="1352961">=</span>&nbsp;<span class="ident" id="1352963">s</span><span class="op" id="1352964">[</span><span class="ident" id="1352965">size</span><span class="op" id="1352969">:</span><span class="op" id="1352970">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1352974">na</span><span class="op" id="1352976">++</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1352980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1352983">return</span>&nbsp;<span class="ident" id="1352990">a</span><span class="op" id="1352991">[</span><span class="num" id="1352992">0</span><span class="op" id="1352993">:</span><span class="ident" id="1352994">na</span><span class="op" id="1352996">]</span><br>
<span class="lineno"></span><span class="op" id="1352998">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1353001">//&nbsp;Count&nbsp;counts&nbsp;the&nbsp;number&nbsp;of&nbsp;non-overlapping&nbsp;instances&nbsp;of&nbsp;sep&nbsp;in&nbsp;s.</span><br>
<span class="lineno">50</span><span class="keyword" id="1353070">func</span>&nbsp;<span class="ident" id="1353075">Count</span><span class="op" id="1353080">(</span><span class="ident" id="1353081">s</span><span class="op" id="1353082">,</span>&nbsp;<span class="ident" id="1353084">sep</span>&nbsp;<span class="op" id="1353088">[</span><span class="op" id="1353089">]</span><span class="builtintype" id="1353090">byte</span><span class="op" id="1353094">)</span>&nbsp;<span class="builtintype" id="1353096">int</span>&nbsp;<span class="op" id="1353100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353103">n</span>&nbsp;<span class="op" id="1353105">:=</span>&nbsp;<span class="builtinfunc" id="1353108">len</span><span class="op" id="1353111">(</span><span class="ident" id="1353112">sep</span><span class="op" id="1353115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353118">if</span>&nbsp;<span class="ident" id="1353121">n</span>&nbsp;<span class="op" id="1353123">==</span>&nbsp;<span class="num" id="1353126">0</span>&nbsp;<span class="op" id="1353128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353132">return</span>&nbsp;<span class="ident" id="1353139">utf8</span><span class="op" id="1353143">.</span><span class="ident" id="1353144">RuneCount</span><span class="op" id="1353153">(</span><span class="ident" id="1353154">s</span><span class="op" id="1353155">)</span>&nbsp;<span class="op" id="1353157">+</span>&nbsp;<span class="num" id="1353159">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1353162">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353165">if</span>&nbsp;<span class="ident" id="1353168">n</span>&nbsp;<span class="op" id="1353170">&gt;</span>&nbsp;<span class="builtinfunc" id="1353172">len</span><span class="op" id="1353175">(</span><span class="ident" id="1353176">s</span><span class="op" id="1353177">)</span>&nbsp;<span class="op" id="1353179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353183">return</span>&nbsp;<span class="num" id="1353190">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1353193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353196">count</span>&nbsp;<span class="op" id="1353202">:=</span>&nbsp;<span class="num" id="1353205">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353208">c</span>&nbsp;<span class="op" id="1353210">:=</span>&nbsp;<span class="ident" id="1353213">sep</span><span class="op" id="1353216">[</span><span class="num" id="1353217">0</span><span class="op" id="1353218">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353221">i</span>&nbsp;<span class="op" id="1353223">:=</span>&nbsp;<span class="num" id="1353226">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353229">t</span>&nbsp;<span class="op" id="1353231">:=</span>&nbsp;<span class="ident" id="1353234">s</span><span class="op" id="1353235">[</span><span class="op" id="1353236">:</span><span class="builtinfunc" id="1353237">len</span><span class="op" id="1353240">(</span><span class="ident" id="1353241">s</span><span class="op" id="1353242">)</span><span class="op" id="1353243">-</span><span class="ident" id="1353244">n</span><span class="op" id="1353245">+</span><span class="num" id="1353246">1</span><span class="op" id="1353247">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353250">for</span>&nbsp;<span class="ident" id="1353254">i</span>&nbsp;<span class="op" id="1353256">&lt;</span>&nbsp;<span class="builtinfunc" id="1353258">len</span><span class="op" id="1353261">(</span><span class="ident" id="1353262">t</span><span class="op" id="1353263">)</span>&nbsp;<span class="op" id="1353265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353269">if</span>&nbsp;<span class="ident" id="1353272">t</span><span class="op" id="1353273">[</span><span class="ident" id="1353274">i</span><span class="op" id="1353275">]</span>&nbsp;<span class="op" id="1353277">!=</span>&nbsp;<span class="ident" id="1353280">c</span>&nbsp;<span class="op" id="1353282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353287">o</span>&nbsp;<span class="op" id="1353289">:=</span>&nbsp;<span class="ident" id="1353292">IndexByte</span><span class="op" id="1353301">(</span><span class="ident" id="1353302">t</span><span class="op" id="1353303">[</span><span class="ident" id="1353304">i</span><span class="op" id="1353305">:</span><span class="op" id="1353306">]</span><span class="op" id="1353307">,</span>&nbsp;<span class="ident" id="1353309">c</span><span class="op" id="1353310">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353315">if</span>&nbsp;<span class="ident" id="1353318">o</span>&nbsp;<span class="op" id="1353320">&lt;</span>&nbsp;<span class="num" id="1353322">0</span>&nbsp;<span class="op" id="1353324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353330">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1353339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353344">i</span>&nbsp;<span class="op" id="1353346">+=</span>&nbsp;<span class="ident" id="1353349">o</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1353353">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353357">if</span>&nbsp;<span class="ident" id="1353360">n</span>&nbsp;<span class="op" id="1353362">==</span>&nbsp;<span class="num" id="1353365">1</span>&nbsp;<span class="op" id="1353367">||</span>&nbsp;<span class="ident" id="1353370">Equal</span><span class="op" id="1353375">(</span><span class="ident" id="1353376">s</span><span class="op" id="1353377">[</span><span class="ident" id="1353378">i</span><span class="op" id="1353379">:</span><span class="ident" id="1353380">i</span><span class="op" id="1353381">+</span><span class="ident" id="1353382">n</span><span class="op" id="1353383">]</span><span class="op" id="1353384">,</span>&nbsp;<span class="ident" id="1353386">sep</span><span class="op" id="1353389">)</span>&nbsp;<span class="op" id="1353391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353396">count</span><span class="op" id="1353401">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353407">i</span>&nbsp;<span class="op" id="1353409">+=</span>&nbsp;<span class="ident" id="1353412">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353417">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1353428">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353432">i</span><span class="op" id="1353433">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1353437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353440">return</span>&nbsp;<span class="ident" id="1353447">count</span><br>
<span class="lineno"></span><span class="op" id="1353453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="1353456">//&nbsp;Contains&nbsp;reports&nbsp;whether&nbsp;subslice&nbsp;is&nbsp;within&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="1353506">func</span>&nbsp;<span class="ident" id="1353511">Contains</span><span class="op" id="1353519">(</span><span class="ident" id="1353520">b</span><span class="op" id="1353521">,</span>&nbsp;<span class="ident" id="1353523">subslice</span>&nbsp;<span class="op" id="1353532">[</span><span class="op" id="1353533">]</span><span class="builtintype" id="1353534">byte</span><span class="op" id="1353538">)</span>&nbsp;<span class="builtintype" id="1353540">bool</span>&nbsp;<span class="op" id="1353545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353548">return</span>&nbsp;<span class="ident" id="1353555">Index</span><span class="op" id="1353560">(</span><span class="ident" id="1353561">b</span><span class="op" id="1353562">,</span>&nbsp;<span class="ident" id="1353564">subslice</span><span class="op" id="1353572">)</span>&nbsp;<span class="op" id="1353574">!=</span>&nbsp;<span class="op" id="1353577">-</span><span class="num" id="1353578">1</span><br>
<span class="lineno"></span><span class="op" id="1353580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="1353583">//&nbsp;Index&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;instance&nbsp;of&nbsp;sep&nbsp;in&nbsp;s,&nbsp;or&nbsp;-1&nbsp;if&nbsp;sep&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="1353679">func</span>&nbsp;<span class="ident" id="1353684">Index</span><span class="op" id="1353689">(</span><span class="ident" id="1353690">s</span><span class="op" id="1353691">,</span>&nbsp;<span class="ident" id="1353693">sep</span>&nbsp;<span class="op" id="1353697">[</span><span class="op" id="1353698">]</span><span class="builtintype" id="1353699">byte</span><span class="op" id="1353703">)</span>&nbsp;<span class="builtintype" id="1353705">int</span>&nbsp;<span class="op" id="1353709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353712">n</span>&nbsp;<span class="op" id="1353714">:=</span>&nbsp;<span class="builtinfunc" id="1353717">len</span><span class="op" id="1353720">(</span><span class="ident" id="1353721">sep</span><span class="op" id="1353724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353727">if</span>&nbsp;<span class="ident" id="1353730">n</span>&nbsp;<span class="op" id="1353732">==</span>&nbsp;<span class="num" id="1353735">0</span>&nbsp;<span class="op" id="1353737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353741">return</span>&nbsp;<span class="num" id="1353748">0</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1353751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353754">if</span>&nbsp;<span class="ident" id="1353757">n</span>&nbsp;<span class="op" id="1353759">&gt;</span>&nbsp;<span class="builtinfunc" id="1353761">len</span><span class="op" id="1353764">(</span><span class="ident" id="1353765">s</span><span class="op" id="1353766">)</span>&nbsp;<span class="op" id="1353768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353772">return</span>&nbsp;<span class="op" id="1353779">-</span><span class="num" id="1353780">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1353783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353786">c</span>&nbsp;<span class="op" id="1353788">:=</span>&nbsp;<span class="ident" id="1353791">sep</span><span class="op" id="1353794">[</span><span class="num" id="1353795">0</span><span class="op" id="1353796">]</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353799">if</span>&nbsp;<span class="ident" id="1353802">n</span>&nbsp;<span class="op" id="1353804">==</span>&nbsp;<span class="num" id="1353807">1</span>&nbsp;<span class="op" id="1353809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353813">return</span>&nbsp;<span class="ident" id="1353820">IndexByte</span><span class="op" id="1353829">(</span><span class="ident" id="1353830">s</span><span class="op" id="1353831">,</span>&nbsp;<span class="ident" id="1353833">c</span><span class="op" id="1353834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1353837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353840">i</span>&nbsp;<span class="op" id="1353842">:=</span>&nbsp;<span class="num" id="1353845">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353848">t</span>&nbsp;<span class="op" id="1353850">:=</span>&nbsp;<span class="ident" id="1353853">s</span><span class="op" id="1353854">[</span><span class="op" id="1353855">:</span><span class="builtinfunc" id="1353856">len</span><span class="op" id="1353859">(</span><span class="ident" id="1353860">s</span><span class="op" id="1353861">)</span><span class="op" id="1353862">-</span><span class="ident" id="1353863">n</span><span class="op" id="1353864">+</span><span class="num" id="1353865">1</span><span class="op" id="1353866">]</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353869">for</span>&nbsp;<span class="ident" id="1353873">i</span>&nbsp;<span class="op" id="1353875">&lt;</span>&nbsp;<span class="builtinfunc" id="1353877">len</span><span class="op" id="1353880">(</span><span class="ident" id="1353881">t</span><span class="op" id="1353882">)</span>&nbsp;<span class="op" id="1353884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353888">if</span>&nbsp;<span class="ident" id="1353891">t</span><span class="op" id="1353892">[</span><span class="ident" id="1353893">i</span><span class="op" id="1353894">]</span>&nbsp;<span class="op" id="1353896">!=</span>&nbsp;<span class="ident" id="1353899">c</span>&nbsp;<span class="op" id="1353901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353906">o</span>&nbsp;<span class="op" id="1353908">:=</span>&nbsp;<span class="ident" id="1353911">IndexByte</span><span class="op" id="1353920">(</span><span class="ident" id="1353921">t</span><span class="op" id="1353922">[</span><span class="ident" id="1353923">i</span><span class="op" id="1353924">:</span><span class="op" id="1353925">]</span><span class="op" id="1353926">,</span>&nbsp;<span class="ident" id="1353928">c</span><span class="op" id="1353929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353934">if</span>&nbsp;<span class="ident" id="1353937">o</span>&nbsp;<span class="op" id="1353939">&lt;</span>&nbsp;<span class="num" id="1353941">0</span>&nbsp;<span class="op" id="1353943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353949">break</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1353958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1353963">i</span>&nbsp;<span class="op" id="1353965">+=</span>&nbsp;<span class="ident" id="1353968">o</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1353972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1353976">if</span>&nbsp;<span class="ident" id="1353979">Equal</span><span class="op" id="1353984">(</span><span class="ident" id="1353985">s</span><span class="op" id="1353986">[</span><span class="ident" id="1353987">i</span><span class="op" id="1353988">:</span><span class="ident" id="1353989">i</span><span class="op" id="1353990">+</span><span class="ident" id="1353991">n</span><span class="op" id="1353992">]</span><span class="op" id="1353993">,</span>&nbsp;<span class="ident" id="1353995">sep</span><span class="op" id="1353998">)</span>&nbsp;<span class="op" id="1354000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354005">return</span>&nbsp;<span class="ident" id="1354012">i</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1354016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1354020">i</span><span class="op" id="1354021">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1354025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354028">return</span>&nbsp;<span class="op" id="1354035">-</span><span class="num" id="1354036">1</span><br>
<span class="lineno"></span><span class="op" id="1354038">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="keyword" id="1354041">func</span>&nbsp;<span class="ident" id="1354046">indexBytePortable</span><span class="op" id="1354063">(</span><span class="ident" id="1354064">s</span>&nbsp;<span class="op" id="1354066">[</span><span class="op" id="1354067">]</span><span class="builtintype" id="1354068">byte</span><span class="op" id="1354072">,</span>&nbsp;<span class="ident" id="1354074">c</span>&nbsp;<span class="builtintype" id="1354076">byte</span><span class="op" id="1354080">)</span>&nbsp;<span class="builtintype" id="1354082">int</span>&nbsp;<span class="op" id="1354086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354089">for</span>&nbsp;<span class="ident" id="1354093">i</span><span class="op" id="1354094">,</span>&nbsp;<span class="ident" id="1354096">b</span>&nbsp;<span class="op" id="1354098">:=</span>&nbsp;<span class="keyword" id="1354101">range</span>&nbsp;<span class="ident" id="1354107">s</span>&nbsp;<span class="op" id="1354109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354113">if</span>&nbsp;<span class="ident" id="1354116">b</span>&nbsp;<span class="op" id="1354118">==</span>&nbsp;<span class="ident" id="1354121">c</span>&nbsp;<span class="op" id="1354123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354128">return</span>&nbsp;<span class="ident" id="1354135">i</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1354139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1354142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354145">return</span>&nbsp;<span class="op" id="1354152">-</span><span class="num" id="1354153">1</span><br>
<span class="lineno"></span><span class="op" id="1354155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="1354158">//&nbsp;LastIndex&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;last&nbsp;instance&nbsp;of&nbsp;sep&nbsp;in&nbsp;s,&nbsp;or&nbsp;-1&nbsp;if&nbsp;sep&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="1354257">func</span>&nbsp;<span class="ident" id="1354262">LastIndex</span><span class="op" id="1354271">(</span><span class="ident" id="1354272">s</span><span class="op" id="1354273">,</span>&nbsp;<span class="ident" id="1354275">sep</span>&nbsp;<span class="op" id="1354279">[</span><span class="op" id="1354280">]</span><span class="builtintype" id="1354281">byte</span><span class="op" id="1354285">)</span>&nbsp;<span class="builtintype" id="1354287">int</span>&nbsp;<span class="op" id="1354291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1354294">n</span>&nbsp;<span class="op" id="1354296">:=</span>&nbsp;<span class="builtinfunc" id="1354299">len</span><span class="op" id="1354302">(</span><span class="ident" id="1354303">sep</span><span class="op" id="1354306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354309">if</span>&nbsp;<span class="ident" id="1354312">n</span>&nbsp;<span class="op" id="1354314">==</span>&nbsp;<span class="num" id="1354317">0</span>&nbsp;<span class="op" id="1354319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354323">return</span>&nbsp;<span class="builtinfunc" id="1354330">len</span><span class="op" id="1354333">(</span><span class="ident" id="1354334">s</span><span class="op" id="1354335">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1354338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1354341">c</span>&nbsp;<span class="op" id="1354343">:=</span>&nbsp;<span class="ident" id="1354346">sep</span><span class="op" id="1354349">[</span><span class="num" id="1354350">0</span><span class="op" id="1354351">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354354">for</span>&nbsp;<span class="ident" id="1354358">i</span>&nbsp;<span class="op" id="1354360">:=</span>&nbsp;<span class="builtinfunc" id="1354363">len</span><span class="op" id="1354366">(</span><span class="ident" id="1354367">s</span><span class="op" id="1354368">)</span>&nbsp;<span class="op" id="1354370">-</span>&nbsp;<span class="ident" id="1354372">n</span><span class="op" id="1354373">;</span>&nbsp;<span class="ident" id="1354375">i</span>&nbsp;<span class="op" id="1354377">&gt;=</span>&nbsp;<span class="num" id="1354380">0</span><span class="op" id="1354381">;</span>&nbsp;<span class="ident" id="1354383">i</span><span class="op" id="1354384">--</span>&nbsp;<span class="op" id="1354387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354391">if</span>&nbsp;<span class="ident" id="1354394">s</span><span class="op" id="1354395">[</span><span class="ident" id="1354396">i</span><span class="op" id="1354397">]</span>&nbsp;<span class="op" id="1354399">==</span>&nbsp;<span class="ident" id="1354402">c</span>&nbsp;<span class="op" id="1354404">&amp;&amp;</span>&nbsp;<span class="op" id="1354407">(</span><span class="ident" id="1354408">n</span>&nbsp;<span class="op" id="1354410">==</span>&nbsp;<span class="num" id="1354413">1</span>&nbsp;<span class="op" id="1354415">||</span>&nbsp;<span class="ident" id="1354418">Equal</span><span class="op" id="1354423">(</span><span class="ident" id="1354424">s</span><span class="op" id="1354425">[</span><span class="ident" id="1354426">i</span><span class="op" id="1354427">:</span><span class="ident" id="1354428">i</span><span class="op" id="1354429">+</span><span class="ident" id="1354430">n</span><span class="op" id="1354431">]</span><span class="op" id="1354432">,</span>&nbsp;<span class="ident" id="1354434">sep</span><span class="op" id="1354437">)</span><span class="op" id="1354438">)</span>&nbsp;<span class="op" id="1354440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354445">return</span>&nbsp;<span class="ident" id="1354452">i</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1354456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1354459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354462">return</span>&nbsp;<span class="op" id="1354469">-</span><span class="num" id="1354470">1</span><br>
<span class="lineno"></span><span class="op" id="1354472">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="1354475">//&nbsp;IndexRune&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="1354553">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;occurrence&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;given&nbsp;rune.</span><br>
<span class="lineno"></span><span class="comment" id="1354630">//&nbsp;It&nbsp;returns&nbsp;-1&nbsp;if&nbsp;rune&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="1354676">func</span>&nbsp;<span class="ident" id="1354681">IndexRune</span><span class="op" id="1354690">(</span><span class="ident" id="1354691">s</span>&nbsp;<span class="op" id="1354693">[</span><span class="op" id="1354694">]</span><span class="builtintype" id="1354695">byte</span><span class="op" id="1354699">,</span>&nbsp;<span class="ident" id="1354701">r</span>&nbsp;<span class="builtintype" id="1354703">rune</span><span class="op" id="1354707">)</span>&nbsp;<span class="builtintype" id="1354709">int</span>&nbsp;<span class="op" id="1354713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354716">for</span>&nbsp;<span class="ident" id="1354720">i</span>&nbsp;<span class="op" id="1354722">:=</span>&nbsp;<span class="num" id="1354725">0</span><span class="op" id="1354726">;</span>&nbsp;<span class="ident" id="1354728">i</span>&nbsp;<span class="op" id="1354730">&lt;</span>&nbsp;<span class="builtinfunc" id="1354732">len</span><span class="op" id="1354735">(</span><span class="ident" id="1354736">s</span><span class="op" id="1354737">)</span><span class="op" id="1354738">;</span>&nbsp;<span class="op" id="1354740">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1354744">r1</span><span class="op" id="1354746">,</span>&nbsp;<span class="ident" id="1354748">size</span>&nbsp;<span class="op" id="1354753">:=</span>&nbsp;<span class="ident" id="1354756">utf8</span><span class="op" id="1354760">.</span><span class="ident" id="1354761">DecodeRune</span><span class="op" id="1354771">(</span><span class="ident" id="1354772">s</span><span class="op" id="1354773">[</span><span class="ident" id="1354774">i</span><span class="op" id="1354775">:</span><span class="op" id="1354776">]</span><span class="op" id="1354777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354781">if</span>&nbsp;<span class="ident" id="1354784">r</span>&nbsp;<span class="op" id="1354786">==</span>&nbsp;<span class="ident" id="1354789">r1</span>&nbsp;<span class="op" id="1354792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354797">return</span>&nbsp;<span class="ident" id="1354804">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1354808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1354812">i</span>&nbsp;<span class="op" id="1354814">+=</span>&nbsp;<span class="ident" id="1354817">size</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1354823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1354826">return</span>&nbsp;<span class="op" id="1354833">-</span><span class="num" id="1354834">1</span><br>
<span class="lineno"></span><span class="op" id="1354836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1354839">//&nbsp;IndexAny&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno">155</span><span class="comment" id="1354916">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;occurrence&nbsp;in&nbsp;s&nbsp;of&nbsp;any&nbsp;of&nbsp;the&nbsp;Unicode</span><br>
<span class="lineno"></span><span class="comment" id="1354996">//&nbsp;code&nbsp;points&nbsp;in&nbsp;chars.&nbsp;&nbsp;It&nbsp;returns&nbsp;-1&nbsp;if&nbsp;chars&nbsp;is&nbsp;empty&nbsp;or&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;code</span><br>
<span class="lineno"></span><span class="comment" id="1355077">//&nbsp;point&nbsp;in&nbsp;common.</span><br>
<span class="lineno"></span><span class="keyword" id="1355097">func</span>&nbsp;<span class="ident" id="1355102">IndexAny</span><span class="op" id="1355110">(</span><span class="ident" id="1355111">s</span>&nbsp;<span class="op" id="1355113">[</span><span class="op" id="1355114">]</span><span class="builtintype" id="1355115">byte</span><span class="op" id="1355119">,</span>&nbsp;<span class="ident" id="1355121">chars</span>&nbsp;<span class="builtintype" id="1355127">string</span><span class="op" id="1355133">)</span>&nbsp;<span class="builtintype" id="1355135">int</span>&nbsp;<span class="op" id="1355139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1355142">if</span>&nbsp;<span class="builtinfunc" id="1355145">len</span><span class="op" id="1355148">(</span><span class="ident" id="1355149">chars</span><span class="op" id="1355154">)</span>&nbsp;<span class="op" id="1355156">&gt;</span>&nbsp;<span class="num" id="1355158">0</span>&nbsp;<span class="op" id="1355160">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1355164">var</span>&nbsp;<span class="ident" id="1355168">r</span>&nbsp;<span class="builtintype" id="1355170">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1355177">var</span>&nbsp;<span class="ident" id="1355181">width</span>&nbsp;<span class="builtintype" id="1355187">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1355193">for</span>&nbsp;<span class="ident" id="1355197">i</span>&nbsp;<span class="op" id="1355199">:=</span>&nbsp;<span class="num" id="1355202">0</span><span class="op" id="1355203">;</span>&nbsp;<span class="ident" id="1355205">i</span>&nbsp;<span class="op" id="1355207">&lt;</span>&nbsp;<span class="builtinfunc" id="1355209">len</span><span class="op" id="1355212">(</span><span class="ident" id="1355213">s</span><span class="op" id="1355214">)</span><span class="op" id="1355215">;</span>&nbsp;<span class="ident" id="1355217">i</span>&nbsp;<span class="op" id="1355219">+=</span>&nbsp;<span class="ident" id="1355222">width</span>&nbsp;<span class="op" id="1355228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1355233">r</span>&nbsp;<span class="op" id="1355235">=</span>&nbsp;<span class="builtintype" id="1355237">rune</span><span class="op" id="1355241">(</span><span class="ident" id="1355242">s</span><span class="op" id="1355243">[</span><span class="ident" id="1355244">i</span><span class="op" id="1355245">]</span><span class="op" id="1355246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1355251">if</span>&nbsp;<span class="ident" id="1355254">r</span>&nbsp;<span class="op" id="1355256">&lt;</span>&nbsp;<span class="ident" id="1355258">utf8</span><span class="op" id="1355262">.</span><span class="ident" id="1355263">RuneSelf</span>&nbsp;<span class="op" id="1355272">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1355278">width</span>&nbsp;<span class="op" id="1355284">=</span>&nbsp;<span class="num" id="1355286">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1355291">}</span>&nbsp;<span class="keyword" id="1355293">else</span>&nbsp;<span class="op" id="1355298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1355304">r</span><span class="op" id="1355305">,</span>&nbsp;<span class="ident" id="1355307">width</span>&nbsp;<span class="op" id="1355313">=</span>&nbsp;<span class="ident" id="1355315">utf8</span><span class="op" id="1355319">.</span><span class="ident" id="1355320">DecodeRune</span><span class="op" id="1355330">(</span><span class="ident" id="1355331">s</span><span class="op" id="1355332">[</span><span class="ident" id="1355333">i</span><span class="op" id="1355334">:</span><span class="op" id="1355335">]</span><span class="op" id="1355336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1355341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1355346">for</span>&nbsp;<span class="ident" id="1355350">_</span><span class="op" id="1355351">,</span>&nbsp;<span class="ident" id="1355353">ch</span>&nbsp;<span class="op" id="1355356">:=</span>&nbsp;<span class="keyword" id="1355359">range</span>&nbsp;<span class="ident" id="1355365">chars</span>&nbsp;<span class="op" id="1355371">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1355377">if</span>&nbsp;<span class="ident" id="1355380">r</span>&nbsp;<span class="op" id="1355382">==</span>&nbsp;<span class="ident" id="1355385">ch</span>&nbsp;<span class="op" id="1355388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1355395">return</span>&nbsp;<span class="ident" id="1355402">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1355408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1355413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1355417">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1355420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1355423">return</span>&nbsp;<span class="op" id="1355430">-</span><span class="num" id="1355431">1</span><br>
<span class="lineno"></span><span class="op" id="1355433">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1355436">//&nbsp;LastIndexAny&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code</span><br>
<span class="lineno">180</span><span class="comment" id="1355509">//&nbsp;points.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;of&nbsp;the&nbsp;last&nbsp;occurrence&nbsp;in&nbsp;s&nbsp;of&nbsp;any&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1355585">//&nbsp;the&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;in&nbsp;chars.&nbsp;&nbsp;It&nbsp;returns&nbsp;-1&nbsp;if&nbsp;chars&nbsp;is&nbsp;empty&nbsp;or&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="1355661">//&nbsp;there&nbsp;is&nbsp;no&nbsp;code&nbsp;point&nbsp;in&nbsp;common.</span><br>
<span class="lineno"></span><span class="keyword" id="1355698">func</span>&nbsp;<span class="ident" id="1355703">LastIndexAny</span><span class="op" id="1355715">(</span><span class="ident" id="1355716">s</span>&nbsp;<span class="op" id="1355718">[</span><span class="op" id="1355719">]</span><span class="builtintype" id="1355720">byte</span><span class="op" id="1355724">,</span>&nbsp;<span class="ident" id="1355726">chars</span>&nbsp;<span class="builtintype" id="1355732">string</span><span class="op" id="1355738">)</span>&nbsp;<span class="builtintype" id="1355740">int</span>&nbsp;<span class="op" id="1355744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1355747">if</span>&nbsp;<span class="builtinfunc" id="1355750">len</span><span class="op" id="1355753">(</span><span class="ident" id="1355754">chars</span><span class="op" id="1355759">)</span>&nbsp;<span class="op" id="1355761">&gt;</span>&nbsp;<span class="num" id="1355763">0</span>&nbsp;<span class="op" id="1355765">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1355769">for</span>&nbsp;<span class="ident" id="1355773">i</span>&nbsp;<span class="op" id="1355775">:=</span>&nbsp;<span class="builtinfunc" id="1355778">len</span><span class="op" id="1355781">(</span><span class="ident" id="1355782">s</span><span class="op" id="1355783">)</span><span class="op" id="1355784">;</span>&nbsp;<span class="ident" id="1355786">i</span>&nbsp;<span class="op" id="1355788">&gt;</span>&nbsp;<span class="num" id="1355790">0</span><span class="op" id="1355791">;</span>&nbsp;<span class="op" id="1355793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1355798">r</span><span class="op" id="1355799">,</span>&nbsp;<span class="ident" id="1355801">size</span>&nbsp;<span class="op" id="1355806">:=</span>&nbsp;<span class="ident" id="1355809">utf8</span><span class="op" id="1355813">.</span><span class="ident" id="1355814">DecodeLastRune</span><span class="op" id="1355828">(</span><span class="ident" id="1355829">s</span><span class="op" id="1355830">[</span><span class="num" id="1355831">0</span><span class="op" id="1355832">:</span><span class="ident" id="1355833">i</span><span class="op" id="1355834">]</span><span class="op" id="1355835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1355840">i</span>&nbsp;<span class="op" id="1355842">-=</span>&nbsp;<span class="ident" id="1355845">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1355853">for</span>&nbsp;<span class="ident" id="1355857">_</span><span class="op" id="1355858">,</span>&nbsp;<span class="ident" id="1355860">ch</span>&nbsp;<span class="op" id="1355863">:=</span>&nbsp;<span class="keyword" id="1355866">range</span>&nbsp;<span class="ident" id="1355872">chars</span>&nbsp;<span class="op" id="1355878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1355884">if</span>&nbsp;<span class="ident" id="1355887">r</span>&nbsp;<span class="op" id="1355889">==</span>&nbsp;<span class="ident" id="1355892">ch</span>&nbsp;<span class="op" id="1355895">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1355902">return</span>&nbsp;<span class="ident" id="1355909">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1355915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1355920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1355924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1355927">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1355930">return</span>&nbsp;<span class="op" id="1355937">-</span><span class="num" id="1355938">1</span><br>
<span class="lineno"></span><span class="op" id="1355940">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1355943">//&nbsp;Generic&nbsp;split:&nbsp;splits&nbsp;after&nbsp;each&nbsp;instance&nbsp;of&nbsp;sep,</span><br>
<span class="lineno"></span><span class="comment" id="1355996">//&nbsp;including&nbsp;sepSave&nbsp;bytes&nbsp;of&nbsp;sep&nbsp;in&nbsp;the&nbsp;subslices.</span><br>
<span class="lineno">200</span><span class="keyword" id="1356048">func</span>&nbsp;<span class="ident" id="1356053">genSplit</span><span class="op" id="1356061">(</span><span class="ident" id="1356062">s</span><span class="op" id="1356063">,</span>&nbsp;<span class="ident" id="1356065">sep</span>&nbsp;<span class="op" id="1356069">[</span><span class="op" id="1356070">]</span><span class="builtintype" id="1356071">byte</span><span class="op" id="1356075">,</span>&nbsp;<span class="ident" id="1356077">sepSave</span><span class="op" id="1356084">,</span>&nbsp;<span class="ident" id="1356086">n</span>&nbsp;<span class="builtintype" id="1356088">int</span><span class="op" id="1356091">)</span>&nbsp;<span class="op" id="1356093">[</span><span class="op" id="1356094">]</span><span class="op" id="1356095">[</span><span class="op" id="1356096">]</span><span class="builtintype" id="1356097">byte</span>&nbsp;<span class="op" id="1356102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1356105">if</span>&nbsp;<span class="ident" id="1356108">n</span>&nbsp;<span class="op" id="1356110">==</span>&nbsp;<span class="num" id="1356113">0</span>&nbsp;<span class="op" id="1356115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1356119">return</span>&nbsp;<span class="ident" id="1356126">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1356131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1356134">if</span>&nbsp;<span class="builtinfunc" id="1356137">len</span><span class="op" id="1356140">(</span><span class="ident" id="1356141">sep</span><span class="op" id="1356144">)</span>&nbsp;<span class="op" id="1356146">==</span>&nbsp;<span class="num" id="1356149">0</span>&nbsp;<span class="op" id="1356151">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1356155">return</span>&nbsp;<span class="ident" id="1356162">explode</span><span class="op" id="1356169">(</span><span class="ident" id="1356170">s</span><span class="op" id="1356171">,</span>&nbsp;<span class="ident" id="1356173">n</span><span class="op" id="1356174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1356177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1356180">if</span>&nbsp;<span class="ident" id="1356183">n</span>&nbsp;<span class="op" id="1356185">&lt;</span>&nbsp;<span class="num" id="1356187">0</span>&nbsp;<span class="op" id="1356189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356193">n</span>&nbsp;<span class="op" id="1356195">=</span>&nbsp;<span class="ident" id="1356197">Count</span><span class="op" id="1356202">(</span><span class="ident" id="1356203">s</span><span class="op" id="1356204">,</span>&nbsp;<span class="ident" id="1356206">sep</span><span class="op" id="1356209">)</span>&nbsp;<span class="op" id="1356211">+</span>&nbsp;<span class="num" id="1356213">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1356216">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356219">c</span>&nbsp;<span class="op" id="1356221">:=</span>&nbsp;<span class="ident" id="1356224">sep</span><span class="op" id="1356227">[</span><span class="num" id="1356228">0</span><span class="op" id="1356229">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356232">start</span>&nbsp;<span class="op" id="1356238">:=</span>&nbsp;<span class="num" id="1356241">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356244">a</span>&nbsp;<span class="op" id="1356246">:=</span>&nbsp;<span class="builtinfunc" id="1356249">make</span><span class="op" id="1356253">(</span><span class="op" id="1356254">[</span><span class="op" id="1356255">]</span><span class="op" id="1356256">[</span><span class="op" id="1356257">]</span><span class="builtintype" id="1356258">byte</span><span class="op" id="1356262">,</span>&nbsp;<span class="ident" id="1356264">n</span><span class="op" id="1356265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356268">na</span>&nbsp;<span class="op" id="1356271">:=</span>&nbsp;<span class="num" id="1356274">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1356277">for</span>&nbsp;<span class="ident" id="1356281">i</span>&nbsp;<span class="op" id="1356283">:=</span>&nbsp;<span class="num" id="1356286">0</span><span class="op" id="1356287">;</span>&nbsp;<span class="ident" id="1356289">i</span><span class="op" id="1356290">+</span><span class="builtinfunc" id="1356291">len</span><span class="op" id="1356294">(</span><span class="ident" id="1356295">sep</span><span class="op" id="1356298">)</span>&nbsp;<span class="op" id="1356300">&lt;=</span>&nbsp;<span class="builtinfunc" id="1356303">len</span><span class="op" id="1356306">(</span><span class="ident" id="1356307">s</span><span class="op" id="1356308">)</span>&nbsp;<span class="op" id="1356310">&amp;&amp;</span>&nbsp;<span class="ident" id="1356313">na</span><span class="op" id="1356315">+</span><span class="num" id="1356316">1</span>&nbsp;<span class="op" id="1356318">&lt;</span>&nbsp;<span class="ident" id="1356320">n</span><span class="op" id="1356321">;</span>&nbsp;<span class="ident" id="1356323">i</span><span class="op" id="1356324">++</span>&nbsp;<span class="op" id="1356327">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1356331">if</span>&nbsp;<span class="ident" id="1356334">s</span><span class="op" id="1356335">[</span><span class="ident" id="1356336">i</span><span class="op" id="1356337">]</span>&nbsp;<span class="op" id="1356339">==</span>&nbsp;<span class="ident" id="1356342">c</span>&nbsp;<span class="op" id="1356344">&amp;&amp;</span>&nbsp;<span class="op" id="1356347">(</span><span class="builtinfunc" id="1356348">len</span><span class="op" id="1356351">(</span><span class="ident" id="1356352">sep</span><span class="op" id="1356355">)</span>&nbsp;<span class="op" id="1356357">==</span>&nbsp;<span class="num" id="1356360">1</span>&nbsp;<span class="op" id="1356362">||</span>&nbsp;<span class="ident" id="1356365">Equal</span><span class="op" id="1356370">(</span><span class="ident" id="1356371">s</span><span class="op" id="1356372">[</span><span class="ident" id="1356373">i</span><span class="op" id="1356374">:</span><span class="ident" id="1356375">i</span><span class="op" id="1356376">+</span><span class="builtinfunc" id="1356377">len</span><span class="op" id="1356380">(</span><span class="ident" id="1356381">sep</span><span class="op" id="1356384">)</span><span class="op" id="1356385">]</span><span class="op" id="1356386">,</span>&nbsp;<span class="ident" id="1356388">sep</span><span class="op" id="1356391">)</span><span class="op" id="1356392">)</span>&nbsp;<span class="op" id="1356394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356399">a</span><span class="op" id="1356400">[</span><span class="ident" id="1356401">na</span><span class="op" id="1356403">]</span>&nbsp;<span class="op" id="1356405">=</span>&nbsp;<span class="ident" id="1356407">s</span><span class="op" id="1356408">[</span><span class="ident" id="1356409">start</span>&nbsp;<span class="op" id="1356415">:</span>&nbsp;<span class="ident" id="1356417">i</span><span class="op" id="1356418">+</span><span class="ident" id="1356419">sepSave</span><span class="op" id="1356426">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356431">na</span><span class="op" id="1356433">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356439">start</span>&nbsp;<span class="op" id="1356445">=</span>&nbsp;<span class="ident" id="1356447">i</span>&nbsp;<span class="op" id="1356449">+</span>&nbsp;<span class="builtinfunc" id="1356451">len</span><span class="op" id="1356454">(</span><span class="ident" id="1356455">sep</span><span class="op" id="1356458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356463">i</span>&nbsp;<span class="op" id="1356465">+=</span>&nbsp;<span class="builtinfunc" id="1356468">len</span><span class="op" id="1356471">(</span><span class="ident" id="1356472">sep</span><span class="op" id="1356475">)</span>&nbsp;<span class="op" id="1356477">-</span>&nbsp;<span class="num" id="1356479">1</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1356483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1356486">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356489">a</span><span class="op" id="1356490">[</span><span class="ident" id="1356491">na</span><span class="op" id="1356493">]</span>&nbsp;<span class="op" id="1356495">=</span>&nbsp;<span class="ident" id="1356497">s</span><span class="op" id="1356498">[</span><span class="ident" id="1356499">start</span><span class="op" id="1356504">:</span><span class="op" id="1356505">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1356508">return</span>&nbsp;<span class="ident" id="1356515">a</span><span class="op" id="1356516">[</span><span class="num" id="1356517">0</span>&nbsp;<span class="op" id="1356519">:</span>&nbsp;<span class="ident" id="1356521">na</span><span class="op" id="1356523">+</span><span class="num" id="1356524">1</span><span class="op" id="1356525">]</span><br>
<span class="lineno"></span><span class="op" id="1356527">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="1356530">//&nbsp;SplitN&nbsp;slices&nbsp;s&nbsp;into&nbsp;subslices&nbsp;separated&nbsp;by&nbsp;sep&nbsp;and&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1356604">//&nbsp;the&nbsp;subslices&nbsp;between&nbsp;those&nbsp;separators.</span><br>
<span class="lineno"></span><span class="comment" id="1356647">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;SplitN&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="comment" id="1356708">//&nbsp;The&nbsp;count&nbsp;determines&nbsp;the&nbsp;number&nbsp;of&nbsp;subslices&nbsp;to&nbsp;return:</span><br>
<span class="lineno">230</span><span class="comment" id="1356767">//&nbsp;&nbsp;&nbsp;n&nbsp;&gt;&nbsp;0:&nbsp;at&nbsp;most&nbsp;n&nbsp;subslices;&nbsp;the&nbsp;last&nbsp;subslice&nbsp;will&nbsp;be&nbsp;the&nbsp;unsplit&nbsp;remainder.</span><br>
<span class="lineno"></span><span class="comment" id="1356849">//&nbsp;&nbsp;&nbsp;n&nbsp;==&nbsp;0:&nbsp;the&nbsp;result&nbsp;is&nbsp;nil&nbsp;(zero&nbsp;subslices)</span><br>
<span class="lineno"></span><span class="comment" id="1356897">//&nbsp;&nbsp;&nbsp;n&nbsp;&lt;&nbsp;0:&nbsp;all&nbsp;subslices</span><br>
<span class="lineno"></span><span class="keyword" id="1356923">func</span>&nbsp;<span class="ident" id="1356928">SplitN</span><span class="op" id="1356934">(</span><span class="ident" id="1356935">s</span><span class="op" id="1356936">,</span>&nbsp;<span class="ident" id="1356938">sep</span>&nbsp;<span class="op" id="1356942">[</span><span class="op" id="1356943">]</span><span class="builtintype" id="1356944">byte</span><span class="op" id="1356948">,</span>&nbsp;<span class="ident" id="1356950">n</span>&nbsp;<span class="builtintype" id="1356952">int</span><span class="op" id="1356955">)</span>&nbsp;<span class="op" id="1356957">[</span><span class="op" id="1356958">]</span><span class="op" id="1356959">[</span><span class="op" id="1356960">]</span><span class="builtintype" id="1356961">byte</span>&nbsp;<span class="op" id="1356966">{</span>&nbsp;<span class="keyword" id="1356968">return</span>&nbsp;<span class="ident" id="1356975">genSplit</span><span class="op" id="1356983">(</span><span class="ident" id="1356984">s</span><span class="op" id="1356985">,</span>&nbsp;<span class="ident" id="1356987">sep</span><span class="op" id="1356990">,</span>&nbsp;<span class="num" id="1356992">0</span><span class="op" id="1356993">,</span>&nbsp;<span class="ident" id="1356995">n</span><span class="op" id="1356996">)</span>&nbsp;<span class="op" id="1356998">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="comment" id="1357001">//&nbsp;SplitAfterN&nbsp;slices&nbsp;s&nbsp;into&nbsp;subslices&nbsp;after&nbsp;each&nbsp;instance&nbsp;of&nbsp;sep&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1357071">//&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;those&nbsp;subslices.</span><br>
<span class="lineno"></span><span class="comment" id="1357110">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;SplitAfterN&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="comment" id="1357176">//&nbsp;The&nbsp;count&nbsp;determines&nbsp;the&nbsp;number&nbsp;of&nbsp;subslices&nbsp;to&nbsp;return:</span><br>
<span class="lineno"></span><span class="comment" id="1357235">//&nbsp;&nbsp;&nbsp;n&nbsp;&gt;&nbsp;0:&nbsp;at&nbsp;most&nbsp;n&nbsp;subslices;&nbsp;the&nbsp;last&nbsp;subslice&nbsp;will&nbsp;be&nbsp;the&nbsp;unsplit&nbsp;remainder.</span><br>
<span class="lineno">240</span><span class="comment" id="1357317">//&nbsp;&nbsp;&nbsp;n&nbsp;==&nbsp;0:&nbsp;the&nbsp;result&nbsp;is&nbsp;nil&nbsp;(zero&nbsp;subslices)</span><br>
<span class="lineno"></span><span class="comment" id="1357365">//&nbsp;&nbsp;&nbsp;n&nbsp;&lt;&nbsp;0:&nbsp;all&nbsp;subslices</span><br>
<span class="lineno"></span><span class="keyword" id="1357391">func</span>&nbsp;<span class="ident" id="1357396">SplitAfterN</span><span class="op" id="1357407">(</span><span class="ident" id="1357408">s</span><span class="op" id="1357409">,</span>&nbsp;<span class="ident" id="1357411">sep</span>&nbsp;<span class="op" id="1357415">[</span><span class="op" id="1357416">]</span><span class="builtintype" id="1357417">byte</span><span class="op" id="1357421">,</span>&nbsp;<span class="ident" id="1357423">n</span>&nbsp;<span class="builtintype" id="1357425">int</span><span class="op" id="1357428">)</span>&nbsp;<span class="op" id="1357430">[</span><span class="op" id="1357431">]</span><span class="op" id="1357432">[</span><span class="op" id="1357433">]</span><span class="builtintype" id="1357434">byte</span>&nbsp;<span class="op" id="1357439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1357442">return</span>&nbsp;<span class="ident" id="1357449">genSplit</span><span class="op" id="1357457">(</span><span class="ident" id="1357458">s</span><span class="op" id="1357459">,</span>&nbsp;<span class="ident" id="1357461">sep</span><span class="op" id="1357464">,</span>&nbsp;<span class="builtinfunc" id="1357466">len</span><span class="op" id="1357469">(</span><span class="ident" id="1357470">sep</span><span class="op" id="1357473">)</span><span class="op" id="1357474">,</span>&nbsp;<span class="ident" id="1357476">n</span><span class="op" id="1357477">)</span><br>
<span class="lineno"></span><span class="op" id="1357479">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="comment" id="1357482">//&nbsp;Split&nbsp;slices&nbsp;s&nbsp;into&nbsp;all&nbsp;subslices&nbsp;separated&nbsp;by&nbsp;sep&nbsp;and&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1357559">//&nbsp;the&nbsp;subslices&nbsp;between&nbsp;those&nbsp;separators.</span><br>
<span class="lineno"></span><span class="comment" id="1357602">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;Split&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="comment" id="1357662">//&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;SplitN&nbsp;with&nbsp;a&nbsp;count&nbsp;of&nbsp;-1.</span><br>
<span class="lineno">250</span><span class="keyword" id="1357712">func</span>&nbsp;<span class="ident" id="1357717">Split</span><span class="op" id="1357722">(</span><span class="ident" id="1357723">s</span><span class="op" id="1357724">,</span>&nbsp;<span class="ident" id="1357726">sep</span>&nbsp;<span class="op" id="1357730">[</span><span class="op" id="1357731">]</span><span class="builtintype" id="1357732">byte</span><span class="op" id="1357736">)</span>&nbsp;<span class="op" id="1357738">[</span><span class="op" id="1357739">]</span><span class="op" id="1357740">[</span><span class="op" id="1357741">]</span><span class="builtintype" id="1357742">byte</span>&nbsp;<span class="op" id="1357747">{</span>&nbsp;<span class="keyword" id="1357749">return</span>&nbsp;<span class="ident" id="1357756">genSplit</span><span class="op" id="1357764">(</span><span class="ident" id="1357765">s</span><span class="op" id="1357766">,</span>&nbsp;<span class="ident" id="1357768">sep</span><span class="op" id="1357771">,</span>&nbsp;<span class="num" id="1357773">0</span><span class="op" id="1357774">,</span>&nbsp;<span class="op" id="1357776">-</span><span class="num" id="1357777">1</span><span class="op" id="1357778">)</span>&nbsp;<span class="op" id="1357780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1357783">//&nbsp;SplitAfter&nbsp;slices&nbsp;s&nbsp;into&nbsp;all&nbsp;subslices&nbsp;after&nbsp;each&nbsp;instance&nbsp;of&nbsp;sep&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1357856">//&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;those&nbsp;subslices.</span><br>
<span class="lineno"></span><span class="comment" id="1357895">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;SplitAfter&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno">255</span><span class="comment" id="1357960">//&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;SplitAfterN&nbsp;with&nbsp;a&nbsp;count&nbsp;of&nbsp;-1.</span><br>
<span class="lineno"></span><span class="keyword" id="1358015">func</span>&nbsp;<span class="ident" id="1358020">SplitAfter</span><span class="op" id="1358030">(</span><span class="ident" id="1358031">s</span><span class="op" id="1358032">,</span>&nbsp;<span class="ident" id="1358034">sep</span>&nbsp;<span class="op" id="1358038">[</span><span class="op" id="1358039">]</span><span class="builtintype" id="1358040">byte</span><span class="op" id="1358044">)</span>&nbsp;<span class="op" id="1358046">[</span><span class="op" id="1358047">]</span><span class="op" id="1358048">[</span><span class="op" id="1358049">]</span><span class="builtintype" id="1358050">byte</span>&nbsp;<span class="op" id="1358055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1358058">return</span>&nbsp;<span class="ident" id="1358065">genSplit</span><span class="op" id="1358073">(</span><span class="ident" id="1358074">s</span><span class="op" id="1358075">,</span>&nbsp;<span class="ident" id="1358077">sep</span><span class="op" id="1358080">,</span>&nbsp;<span class="builtinfunc" id="1358082">len</span><span class="op" id="1358085">(</span><span class="ident" id="1358086">sep</span><span class="op" id="1358089">)</span><span class="op" id="1358090">,</span>&nbsp;<span class="op" id="1358092">-</span><span class="num" id="1358093">1</span><span class="op" id="1358094">)</span><br>
<span class="lineno"></span><span class="op" id="1358096">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="1358099">//&nbsp;Fields&nbsp;splits&nbsp;the&nbsp;slice&nbsp;s&nbsp;around&nbsp;each&nbsp;instance&nbsp;of&nbsp;one&nbsp;or&nbsp;more&nbsp;consecutive&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span><span class="comment" id="1358188">//&nbsp;characters,&nbsp;returning&nbsp;a&nbsp;slice&nbsp;of&nbsp;subslices&nbsp;of&nbsp;s&nbsp;or&nbsp;an&nbsp;empty&nbsp;list&nbsp;if&nbsp;s&nbsp;contains&nbsp;only&nbsp;white&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="1358288">func</span>&nbsp;<span class="ident" id="1358293">Fields</span><span class="op" id="1358299">(</span><span class="ident" id="1358300">s</span>&nbsp;<span class="op" id="1358302">[</span><span class="op" id="1358303">]</span><span class="builtintype" id="1358304">byte</span><span class="op" id="1358308">)</span>&nbsp;<span class="op" id="1358310">[</span><span class="op" id="1358311">]</span><span class="op" id="1358312">[</span><span class="op" id="1358313">]</span><span class="builtintype" id="1358314">byte</span>&nbsp;<span class="op" id="1358319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1358322">return</span>&nbsp;<span class="ident" id="1358329">FieldsFunc</span><span class="op" id="1358339">(</span><span class="ident" id="1358340">s</span><span class="op" id="1358341">,</span>&nbsp;<span class="ident" id="1358343">unicode</span><span class="op" id="1358350">.</span><span class="ident" id="1358351">IsSpace</span><span class="op" id="1358358">)</span><br>
<span class="lineno"></span><span class="op" id="1358360">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="comment" id="1358363">//&nbsp;FieldsFunc&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="1358442">//&nbsp;It&nbsp;splits&nbsp;the&nbsp;slice&nbsp;s&nbsp;at&nbsp;each&nbsp;run&nbsp;of&nbsp;code&nbsp;points&nbsp;c&nbsp;satisfying&nbsp;f(c)&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1358516">//&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;subslices&nbsp;of&nbsp;s.&nbsp;&nbsp;If&nbsp;all&nbsp;code&nbsp;points&nbsp;in&nbsp;s&nbsp;satisfy&nbsp;f(c),&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1358596">//&nbsp;len(s)&nbsp;==&nbsp;0,&nbsp;an&nbsp;empty&nbsp;slice&nbsp;is&nbsp;returned.</span><br>
<span class="lineno">270</span><span class="comment" id="1358640">//&nbsp;FieldsFunc&nbsp;makes&nbsp;no&nbsp;guarantees&nbsp;about&nbsp;the&nbsp;order&nbsp;in&nbsp;which&nbsp;it&nbsp;calls&nbsp;f(c).</span><br>
<span class="lineno"></span><span class="comment" id="1358714">//&nbsp;If&nbsp;f&nbsp;does&nbsp;not&nbsp;return&nbsp;consistent&nbsp;results&nbsp;for&nbsp;a&nbsp;given&nbsp;c,&nbsp;FieldsFunc&nbsp;may&nbsp;crash.</span><br>
<span class="lineno"></span><span class="keyword" id="1358794">func</span>&nbsp;<span class="ident" id="1358799">FieldsFunc</span><span class="op" id="1358809">(</span><span class="ident" id="1358810">s</span>&nbsp;<span class="op" id="1358812">[</span><span class="op" id="1358813">]</span><span class="builtintype" id="1358814">byte</span><span class="op" id="1358818">,</span>&nbsp;<span class="ident" id="1358820">f</span>&nbsp;<span class="keyword" id="1358822">func</span><span class="op" id="1358826">(</span><span class="builtintype" id="1358827">rune</span><span class="op" id="1358831">)</span>&nbsp;<span class="builtintype" id="1358833">bool</span><span class="op" id="1358837">)</span>&nbsp;<span class="op" id="1358839">[</span><span class="op" id="1358840">]</span><span class="op" id="1358841">[</span><span class="op" id="1358842">]</span><span class="builtintype" id="1358843">byte</span>&nbsp;<span class="op" id="1358848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358851">n</span>&nbsp;<span class="op" id="1358853">:=</span>&nbsp;<span class="num" id="1358856">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358859">inField</span>&nbsp;<span class="op" id="1358867">:=</span>&nbsp;<span class="builtintype" id="1358870">false</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1358877">for</span>&nbsp;<span class="ident" id="1358881">i</span>&nbsp;<span class="op" id="1358883">:=</span>&nbsp;<span class="num" id="1358886">0</span><span class="op" id="1358887">;</span>&nbsp;<span class="ident" id="1358889">i</span>&nbsp;<span class="op" id="1358891">&lt;</span>&nbsp;<span class="builtinfunc" id="1358893">len</span><span class="op" id="1358896">(</span><span class="ident" id="1358897">s</span><span class="op" id="1358898">)</span><span class="op" id="1358899">;</span>&nbsp;<span class="op" id="1358901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358905">r</span><span class="op" id="1358906">,</span>&nbsp;<span class="ident" id="1358908">size</span>&nbsp;<span class="op" id="1358913">:=</span>&nbsp;<span class="ident" id="1358916">utf8</span><span class="op" id="1358920">.</span><span class="ident" id="1358921">DecodeRune</span><span class="op" id="1358931">(</span><span class="ident" id="1358932">s</span><span class="op" id="1358933">[</span><span class="ident" id="1358934">i</span><span class="op" id="1358935">:</span><span class="op" id="1358936">]</span><span class="op" id="1358937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358941">wasInField</span>&nbsp;<span class="op" id="1358952">:=</span>&nbsp;<span class="ident" id="1358955">inField</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358965">inField</span>&nbsp;<span class="op" id="1358973">=</span>&nbsp;<span class="op" id="1358975">!</span><span class="ident" id="1358976">f</span><span class="op" id="1358977">(</span><span class="ident" id="1358978">r</span><span class="op" id="1358979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1358983">if</span>&nbsp;<span class="ident" id="1358986">inField</span>&nbsp;<span class="op" id="1358994">&amp;&amp;</span>&nbsp;<span class="op" id="1358997">!</span><span class="ident" id="1358998">wasInField</span>&nbsp;<span class="op" id="1359009">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359014">n</span><span class="op" id="1359015">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1359020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359024">i</span>&nbsp;<span class="op" id="1359026">+=</span>&nbsp;<span class="ident" id="1359029">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1359035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359039">a</span>&nbsp;<span class="op" id="1359041">:=</span>&nbsp;<span class="builtinfunc" id="1359044">make</span><span class="op" id="1359048">(</span><span class="op" id="1359049">[</span><span class="op" id="1359050">]</span><span class="op" id="1359051">[</span><span class="op" id="1359052">]</span><span class="builtintype" id="1359053">byte</span><span class="op" id="1359057">,</span>&nbsp;<span class="ident" id="1359059">n</span><span class="op" id="1359060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359063">na</span>&nbsp;<span class="op" id="1359066">:=</span>&nbsp;<span class="num" id="1359069">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359072">fieldStart</span>&nbsp;<span class="op" id="1359083">:=</span>&nbsp;<span class="op" id="1359086">-</span><span class="num" id="1359087">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1359090">for</span>&nbsp;<span class="ident" id="1359094">i</span>&nbsp;<span class="op" id="1359096">:=</span>&nbsp;<span class="num" id="1359099">0</span><span class="op" id="1359100">;</span>&nbsp;<span class="ident" id="1359102">i</span>&nbsp;<span class="op" id="1359104">&lt;=</span>&nbsp;<span class="builtinfunc" id="1359107">len</span><span class="op" id="1359110">(</span><span class="ident" id="1359111">s</span><span class="op" id="1359112">)</span>&nbsp;<span class="op" id="1359114">&amp;&amp;</span>&nbsp;<span class="ident" id="1359117">na</span>&nbsp;<span class="op" id="1359120">&lt;</span>&nbsp;<span class="ident" id="1359122">n</span><span class="op" id="1359123">;</span>&nbsp;<span class="op" id="1359125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359129">r</span><span class="op" id="1359130">,</span>&nbsp;<span class="ident" id="1359132">size</span>&nbsp;<span class="op" id="1359137">:=</span>&nbsp;<span class="ident" id="1359140">utf8</span><span class="op" id="1359144">.</span><span class="ident" id="1359145">DecodeRune</span><span class="op" id="1359155">(</span><span class="ident" id="1359156">s</span><span class="op" id="1359157">[</span><span class="ident" id="1359158">i</span><span class="op" id="1359159">:</span><span class="op" id="1359160">]</span><span class="op" id="1359161">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1359165">if</span>&nbsp;<span class="ident" id="1359168">fieldStart</span>&nbsp;<span class="op" id="1359179">&lt;</span>&nbsp;<span class="num" id="1359181">0</span>&nbsp;<span class="op" id="1359183">&amp;&amp;</span>&nbsp;<span class="ident" id="1359186">size</span>&nbsp;<span class="op" id="1359191">&gt;</span>&nbsp;<span class="num" id="1359193">0</span>&nbsp;<span class="op" id="1359195">&amp;&amp;</span>&nbsp;<span class="op" id="1359198">!</span><span class="ident" id="1359199">f</span><span class="op" id="1359200">(</span><span class="ident" id="1359201">r</span><span class="op" id="1359202">)</span>&nbsp;<span class="op" id="1359204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359209">fieldStart</span>&nbsp;<span class="op" id="1359220">=</span>&nbsp;<span class="ident" id="1359222">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359227">i</span>&nbsp;<span class="op" id="1359229">+=</span>&nbsp;<span class="ident" id="1359232">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1359240">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1359251">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1359255">if</span>&nbsp;<span class="ident" id="1359258">fieldStart</span>&nbsp;<span class="op" id="1359269">&gt;=</span>&nbsp;<span class="num" id="1359272">0</span>&nbsp;<span class="op" id="1359274">&amp;&amp;</span>&nbsp;<span class="op" id="1359277">(</span><span class="ident" id="1359278">size</span>&nbsp;<span class="op" id="1359283">==</span>&nbsp;<span class="num" id="1359286">0</span>&nbsp;<span class="op" id="1359288">||</span>&nbsp;<span class="ident" id="1359291">f</span><span class="op" id="1359292">(</span><span class="ident" id="1359293">r</span><span class="op" id="1359294">)</span><span class="op" id="1359295">)</span>&nbsp;<span class="op" id="1359297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359302">a</span><span class="op" id="1359303">[</span><span class="ident" id="1359304">na</span><span class="op" id="1359306">]</span>&nbsp;<span class="op" id="1359308">=</span>&nbsp;<span class="ident" id="1359310">s</span><span class="op" id="1359311">[</span><span class="ident" id="1359312">fieldStart</span><span class="op" id="1359322">:</span><span class="ident" id="1359323">i</span><span class="op" id="1359324">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359329">na</span><span class="op" id="1359331">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359337">fieldStart</span>&nbsp;<span class="op" id="1359348">=</span>&nbsp;<span class="op" id="1359350">-</span><span class="num" id="1359351">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1359355">}</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1359359">if</span>&nbsp;<span class="ident" id="1359362">size</span>&nbsp;<span class="op" id="1359367">==</span>&nbsp;<span class="num" id="1359370">0</span>&nbsp;<span class="op" id="1359372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1359377">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1359385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359389">i</span>&nbsp;<span class="op" id="1359391">+=</span>&nbsp;<span class="ident" id="1359394">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1359400">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1359403">return</span>&nbsp;<span class="ident" id="1359410">a</span><span class="op" id="1359411">[</span><span class="num" id="1359412">0</span><span class="op" id="1359413">:</span><span class="ident" id="1359414">na</span><span class="op" id="1359416">]</span><br>
<span class="lineno"></span><span class="op" id="1359418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1359421">//&nbsp;Join&nbsp;concatenates&nbsp;the&nbsp;elements&nbsp;of&nbsp;s&nbsp;to&nbsp;create&nbsp;a&nbsp;new&nbsp;byte&nbsp;slice.&nbsp;The&nbsp;separator</span><br>
<span class="lineno"></span><span class="comment" id="1359502">//&nbsp;sep&nbsp;is&nbsp;placed&nbsp;between&nbsp;elements&nbsp;in&nbsp;the&nbsp;resulting&nbsp;slice.</span><br>
<span class="lineno">310</span><span class="keyword" id="1359560">func</span>&nbsp;<span class="ident" id="1359565">Join</span><span class="op" id="1359569">(</span><span class="ident" id="1359570">s</span>&nbsp;<span class="op" id="1359572">[</span><span class="op" id="1359573">]</span><span class="op" id="1359574">[</span><span class="op" id="1359575">]</span><span class="builtintype" id="1359576">byte</span><span class="op" id="1359580">,</span>&nbsp;<span class="ident" id="1359582">sep</span>&nbsp;<span class="op" id="1359586">[</span><span class="op" id="1359587">]</span><span class="builtintype" id="1359588">byte</span><span class="op" id="1359592">)</span>&nbsp;<span class="op" id="1359594">[</span><span class="op" id="1359595">]</span><span class="builtintype" id="1359596">byte</span>&nbsp;<span class="op" id="1359601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1359604">if</span>&nbsp;<span class="builtinfunc" id="1359607">len</span><span class="op" id="1359610">(</span><span class="ident" id="1359611">s</span><span class="op" id="1359612">)</span>&nbsp;<span class="op" id="1359614">==</span>&nbsp;<span class="num" id="1359617">0</span>&nbsp;<span class="op" id="1359619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1359623">return</span>&nbsp;<span class="op" id="1359630">[</span><span class="op" id="1359631">]</span><span class="builtintype" id="1359632">byte</span><span class="op" id="1359636">{</span><span class="op" id="1359637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1359640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1359643">if</span>&nbsp;<span class="builtinfunc" id="1359646">len</span><span class="op" id="1359649">(</span><span class="ident" id="1359650">s</span><span class="op" id="1359651">)</span>&nbsp;<span class="op" id="1359653">==</span>&nbsp;<span class="num" id="1359656">1</span>&nbsp;<span class="op" id="1359658">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1359662">//&nbsp;Just&nbsp;return&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1359687">return</span>&nbsp;<span class="builtinfunc" id="1359694">append</span><span class="op" id="1359700">(</span><span class="op" id="1359701">[</span><span class="op" id="1359702">]</span><span class="builtintype" id="1359703">byte</span><span class="op" id="1359707">(</span><span class="ident" id="1359708">nil</span><span class="op" id="1359711">)</span><span class="op" id="1359712">,</span>&nbsp;<span class="ident" id="1359714">s</span><span class="op" id="1359715">[</span><span class="num" id="1359716">0</span><span class="op" id="1359717">]</span><span class="op" id="1359718">...</span><span class="op" id="1359721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1359724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359727">n</span>&nbsp;<span class="op" id="1359729">:=</span>&nbsp;<span class="builtinfunc" id="1359732">len</span><span class="op" id="1359735">(</span><span class="ident" id="1359736">sep</span><span class="op" id="1359739">)</span>&nbsp;<span class="op" id="1359741">*</span>&nbsp;<span class="op" id="1359743">(</span><span class="builtinfunc" id="1359744">len</span><span class="op" id="1359747">(</span><span class="ident" id="1359748">s</span><span class="op" id="1359749">)</span>&nbsp;<span class="op" id="1359751">-</span>&nbsp;<span class="num" id="1359753">1</span><span class="op" id="1359754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1359757">for</span>&nbsp;<span class="ident" id="1359761">_</span><span class="op" id="1359762">,</span>&nbsp;<span class="ident" id="1359764">v</span>&nbsp;<span class="op" id="1359766">:=</span>&nbsp;<span class="keyword" id="1359769">range</span>&nbsp;<span class="ident" id="1359775">s</span>&nbsp;<span class="op" id="1359777">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359781">n</span>&nbsp;<span class="op" id="1359783">+=</span>&nbsp;<span class="builtinfunc" id="1359786">len</span><span class="op" id="1359789">(</span><span class="ident" id="1359790">v</span><span class="op" id="1359791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1359794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359798">b</span>&nbsp;<span class="op" id="1359800">:=</span>&nbsp;<span class="builtinfunc" id="1359803">make</span><span class="op" id="1359807">(</span><span class="op" id="1359808">[</span><span class="op" id="1359809">]</span><span class="builtintype" id="1359810">byte</span><span class="op" id="1359814">,</span>&nbsp;<span class="ident" id="1359816">n</span><span class="op" id="1359817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359820">bp</span>&nbsp;<span class="op" id="1359823">:=</span>&nbsp;<span class="builtinfunc" id="1359826">copy</span><span class="op" id="1359830">(</span><span class="ident" id="1359831">b</span><span class="op" id="1359832">,</span>&nbsp;<span class="ident" id="1359834">s</span><span class="op" id="1359835">[</span><span class="num" id="1359836">0</span><span class="op" id="1359837">]</span><span class="op" id="1359838">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1359841">for</span>&nbsp;<span class="ident" id="1359845">_</span><span class="op" id="1359846">,</span>&nbsp;<span class="ident" id="1359848">v</span>&nbsp;<span class="op" id="1359850">:=</span>&nbsp;<span class="keyword" id="1359853">range</span>&nbsp;<span class="ident" id="1359859">s</span><span class="op" id="1359860">[</span><span class="num" id="1359861">1</span><span class="op" id="1359862">:</span><span class="op" id="1359863">]</span>&nbsp;<span class="op" id="1359865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359869">bp</span>&nbsp;<span class="op" id="1359872">+=</span>&nbsp;<span class="builtinfunc" id="1359875">copy</span><span class="op" id="1359879">(</span><span class="ident" id="1359880">b</span><span class="op" id="1359881">[</span><span class="ident" id="1359882">bp</span><span class="op" id="1359884">:</span><span class="op" id="1359885">]</span><span class="op" id="1359886">,</span>&nbsp;<span class="ident" id="1359888">sep</span><span class="op" id="1359891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359895">bp</span>&nbsp;<span class="op" id="1359898">+=</span>&nbsp;<span class="builtinfunc" id="1359901">copy</span><span class="op" id="1359905">(</span><span class="ident" id="1359906">b</span><span class="op" id="1359907">[</span><span class="ident" id="1359908">bp</span><span class="op" id="1359910">:</span><span class="op" id="1359911">]</span><span class="op" id="1359912">,</span>&nbsp;<span class="ident" id="1359914">v</span><span class="op" id="1359915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1359918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1359921">return</span>&nbsp;<span class="ident" id="1359928">b</span><br>
<span class="lineno">330</span><span class="op" id="1359930">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1359933">//&nbsp;HasPrefix&nbsp;tests&nbsp;whether&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;begins&nbsp;with&nbsp;prefix.</span><br>
<span class="lineno"></span><span class="keyword" id="1359997">func</span>&nbsp;<span class="ident" id="1360002">HasPrefix</span><span class="op" id="1360011">(</span><span class="ident" id="1360012">s</span><span class="op" id="1360013">,</span>&nbsp;<span class="ident" id="1360015">prefix</span>&nbsp;<span class="op" id="1360022">[</span><span class="op" id="1360023">]</span><span class="builtintype" id="1360024">byte</span><span class="op" id="1360028">)</span>&nbsp;<span class="builtintype" id="1360030">bool</span>&nbsp;<span class="op" id="1360035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1360038">return</span>&nbsp;<span class="builtinfunc" id="1360045">len</span><span class="op" id="1360048">(</span><span class="ident" id="1360049">s</span><span class="op" id="1360050">)</span>&nbsp;<span class="op" id="1360052">&gt;=</span>&nbsp;<span class="builtinfunc" id="1360055">len</span><span class="op" id="1360058">(</span><span class="ident" id="1360059">prefix</span><span class="op" id="1360065">)</span>&nbsp;<span class="op" id="1360067">&amp;&amp;</span>&nbsp;<span class="ident" id="1360070">Equal</span><span class="op" id="1360075">(</span><span class="ident" id="1360076">s</span><span class="op" id="1360077">[</span><span class="num" id="1360078">0</span><span class="op" id="1360079">:</span><span class="builtinfunc" id="1360080">len</span><span class="op" id="1360083">(</span><span class="ident" id="1360084">prefix</span><span class="op" id="1360090">)</span><span class="op" id="1360091">]</span><span class="op" id="1360092">,</span>&nbsp;<span class="ident" id="1360094">prefix</span><span class="op" id="1360100">)</span><br>
<span class="lineno">335</span><span class="op" id="1360102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1360105">//&nbsp;HasSuffix&nbsp;tests&nbsp;whether&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;ends&nbsp;with&nbsp;suffix.</span><br>
<span class="lineno"></span><span class="keyword" id="1360167">func</span>&nbsp;<span class="ident" id="1360172">HasSuffix</span><span class="op" id="1360181">(</span><span class="ident" id="1360182">s</span><span class="op" id="1360183">,</span>&nbsp;<span class="ident" id="1360185">suffix</span>&nbsp;<span class="op" id="1360192">[</span><span class="op" id="1360193">]</span><span class="builtintype" id="1360194">byte</span><span class="op" id="1360198">)</span>&nbsp;<span class="builtintype" id="1360200">bool</span>&nbsp;<span class="op" id="1360205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1360208">return</span>&nbsp;<span class="builtinfunc" id="1360215">len</span><span class="op" id="1360218">(</span><span class="ident" id="1360219">s</span><span class="op" id="1360220">)</span>&nbsp;<span class="op" id="1360222">&gt;=</span>&nbsp;<span class="builtinfunc" id="1360225">len</span><span class="op" id="1360228">(</span><span class="ident" id="1360229">suffix</span><span class="op" id="1360235">)</span>&nbsp;<span class="op" id="1360237">&amp;&amp;</span>&nbsp;<span class="ident" id="1360240">Equal</span><span class="op" id="1360245">(</span><span class="ident" id="1360246">s</span><span class="op" id="1360247">[</span><span class="builtinfunc" id="1360248">len</span><span class="op" id="1360251">(</span><span class="ident" id="1360252">s</span><span class="op" id="1360253">)</span><span class="op" id="1360254">-</span><span class="builtinfunc" id="1360255">len</span><span class="op" id="1360258">(</span><span class="ident" id="1360259">suffix</span><span class="op" id="1360265">)</span><span class="op" id="1360266">:</span><span class="op" id="1360267">]</span><span class="op" id="1360268">,</span>&nbsp;<span class="ident" id="1360270">suffix</span><span class="op" id="1360276">)</span><br>
<span class="lineno">340</span><span class="op" id="1360278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1360281">//&nbsp;Map&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;its&nbsp;characters&nbsp;modified</span><br>
<span class="lineno"></span><span class="comment" id="1360356">//&nbsp;according&nbsp;to&nbsp;the&nbsp;mapping&nbsp;function.&nbsp;If&nbsp;mapping&nbsp;returns&nbsp;a&nbsp;negative&nbsp;value,&nbsp;the&nbsp;character&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1360448">//&nbsp;dropped&nbsp;from&nbsp;the&nbsp;string&nbsp;with&nbsp;no&nbsp;replacement.&nbsp;&nbsp;The&nbsp;characters&nbsp;in&nbsp;s&nbsp;and&nbsp;the</span><br>
<span class="lineno">345</span><span class="comment" id="1360525">//&nbsp;output&nbsp;are&nbsp;interpreted&nbsp;as&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="keyword" id="1360589">func</span>&nbsp;<span class="ident" id="1360594">Map</span><span class="op" id="1360597">(</span><span class="ident" id="1360598">mapping</span>&nbsp;<span class="keyword" id="1360606">func</span><span class="op" id="1360610">(</span><span class="ident" id="1360611">r</span>&nbsp;<span class="builtintype" id="1360613">rune</span><span class="op" id="1360617">)</span>&nbsp;<span class="builtintype" id="1360619">rune</span><span class="op" id="1360623">,</span>&nbsp;<span class="ident" id="1360625">s</span>&nbsp;<span class="op" id="1360627">[</span><span class="op" id="1360628">]</span><span class="builtintype" id="1360629">byte</span><span class="op" id="1360633">)</span>&nbsp;<span class="op" id="1360635">[</span><span class="op" id="1360636">]</span><span class="builtintype" id="1360637">byte</span>&nbsp;<span class="op" id="1360642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1360645">//&nbsp;In&nbsp;the&nbsp;worst&nbsp;case,&nbsp;the&nbsp;slice&nbsp;can&nbsp;grow&nbsp;when&nbsp;mapped,&nbsp;making</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1360707">//&nbsp;things&nbsp;unpleasant.&nbsp;&nbsp;But&nbsp;it&#39;s&nbsp;so&nbsp;rare&nbsp;we&nbsp;barge&nbsp;in&nbsp;assuming&nbsp;it&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1360774">//&nbsp;fine.&nbsp;&nbsp;It&nbsp;could&nbsp;also&nbsp;shrink&nbsp;but&nbsp;that&nbsp;falls&nbsp;out&nbsp;naturally.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360836">maxbytes</span>&nbsp;<span class="op" id="1360845">:=</span>&nbsp;<span class="builtinfunc" id="1360848">len</span><span class="op" id="1360851">(</span><span class="ident" id="1360852">s</span><span class="op" id="1360853">)</span>&nbsp;<span class="comment" id="1360855">//&nbsp;length&nbsp;of&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360871">nbytes</span>&nbsp;<span class="op" id="1360878">:=</span>&nbsp;<span class="num" id="1360881">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1360890">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;encoded&nbsp;in&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360923">b</span>&nbsp;<span class="op" id="1360925">:=</span>&nbsp;<span class="builtinfunc" id="1360928">make</span><span class="op" id="1360932">(</span><span class="op" id="1360933">[</span><span class="op" id="1360934">]</span><span class="builtintype" id="1360935">byte</span><span class="op" id="1360939">,</span>&nbsp;<span class="ident" id="1360941">maxbytes</span><span class="op" id="1360949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1360952">for</span>&nbsp;<span class="ident" id="1360956">i</span>&nbsp;<span class="op" id="1360958">:=</span>&nbsp;<span class="num" id="1360961">0</span><span class="op" id="1360962">;</span>&nbsp;<span class="ident" id="1360964">i</span>&nbsp;<span class="op" id="1360966">&lt;</span>&nbsp;<span class="builtinfunc" id="1360968">len</span><span class="op" id="1360971">(</span><span class="ident" id="1360972">s</span><span class="op" id="1360973">)</span><span class="op" id="1360974">;</span>&nbsp;<span class="op" id="1360976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360980">wid</span>&nbsp;<span class="op" id="1360984">:=</span>&nbsp;<span class="num" id="1360987">1</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1360991">r</span>&nbsp;<span class="op" id="1360993">:=</span>&nbsp;<span class="builtintype" id="1360996">rune</span><span class="op" id="1361000">(</span><span class="ident" id="1361001">s</span><span class="op" id="1361002">[</span><span class="ident" id="1361003">i</span><span class="op" id="1361004">]</span><span class="op" id="1361005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1361009">if</span>&nbsp;<span class="ident" id="1361012">r</span>&nbsp;<span class="op" id="1361014">&gt;=</span>&nbsp;<span class="ident" id="1361017">utf8</span><span class="op" id="1361021">.</span><span class="ident" id="1361022">RuneSelf</span>&nbsp;<span class="op" id="1361031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361036">r</span><span class="op" id="1361037">,</span>&nbsp;<span class="ident" id="1361039">wid</span>&nbsp;<span class="op" id="1361043">=</span>&nbsp;<span class="ident" id="1361045">utf8</span><span class="op" id="1361049">.</span><span class="ident" id="1361050">DecodeRune</span><span class="op" id="1361060">(</span><span class="ident" id="1361061">s</span><span class="op" id="1361062">[</span><span class="ident" id="1361063">i</span><span class="op" id="1361064">:</span><span class="op" id="1361065">]</span><span class="op" id="1361066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1361070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361074">r</span>&nbsp;<span class="op" id="1361076">=</span>&nbsp;<span class="ident" id="1361078">mapping</span><span class="op" id="1361085">(</span><span class="ident" id="1361086">r</span><span class="op" id="1361087">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1361091">if</span>&nbsp;<span class="ident" id="1361094">r</span>&nbsp;<span class="op" id="1361096">&gt;=</span>&nbsp;<span class="num" id="1361099">0</span>&nbsp;<span class="op" id="1361101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361106">rl</span>&nbsp;<span class="op" id="1361109">:=</span>&nbsp;<span class="ident" id="1361112">utf8</span><span class="op" id="1361116">.</span><span class="ident" id="1361117">RuneLen</span><span class="op" id="1361124">(</span><span class="ident" id="1361125">r</span><span class="op" id="1361126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1361131">if</span>&nbsp;<span class="ident" id="1361134">rl</span>&nbsp;<span class="op" id="1361137">&lt;</span>&nbsp;<span class="num" id="1361139">0</span>&nbsp;<span class="op" id="1361141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361147">rl</span>&nbsp;<span class="op" id="1361150">=</span>&nbsp;<span class="builtinfunc" id="1361152">len</span><span class="op" id="1361155">(</span><span class="builtintype" id="1361156">string</span><span class="op" id="1361162">(</span><span class="ident" id="1361163">utf8</span><span class="op" id="1361167">.</span><span class="ident" id="1361168">RuneError</span><span class="op" id="1361177">)</span><span class="op" id="1361178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1361183">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1361188">if</span>&nbsp;<span class="ident" id="1361191">nbytes</span><span class="op" id="1361197">+</span><span class="ident" id="1361198">rl</span>&nbsp;<span class="op" id="1361201">&gt;</span>&nbsp;<span class="ident" id="1361203">maxbytes</span>&nbsp;<span class="op" id="1361212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1361218">//&nbsp;Grow&nbsp;the&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361242">maxbytes</span>&nbsp;<span class="op" id="1361251">=</span>&nbsp;<span class="ident" id="1361253">maxbytes</span><span class="op" id="1361261">*</span><span class="num" id="1361262">2</span>&nbsp;<span class="op" id="1361264">+</span>&nbsp;<span class="ident" id="1361266">utf8</span><span class="op" id="1361270">.</span><span class="ident" id="1361271">UTFMax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361282">nb</span>&nbsp;<span class="op" id="1361285">:=</span>&nbsp;<span class="builtinfunc" id="1361288">make</span><span class="op" id="1361292">(</span><span class="op" id="1361293">[</span><span class="op" id="1361294">]</span><span class="builtintype" id="1361295">byte</span><span class="op" id="1361299">,</span>&nbsp;<span class="ident" id="1361301">maxbytes</span><span class="op" id="1361309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1361315">copy</span><span class="op" id="1361319">(</span><span class="ident" id="1361320">nb</span><span class="op" id="1361322">,</span>&nbsp;<span class="ident" id="1361324">b</span><span class="op" id="1361325">[</span><span class="num" id="1361326">0</span><span class="op" id="1361327">:</span><span class="ident" id="1361328">nbytes</span><span class="op" id="1361334">]</span><span class="op" id="1361335">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361341">b</span>&nbsp;<span class="op" id="1361343">=</span>&nbsp;<span class="ident" id="1361345">nb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1361351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361356">nbytes</span>&nbsp;<span class="op" id="1361363">+=</span>&nbsp;<span class="ident" id="1361366">utf8</span><span class="op" id="1361370">.</span><span class="ident" id="1361371">EncodeRune</span><span class="op" id="1361381">(</span><span class="ident" id="1361382">b</span><span class="op" id="1361383">[</span><span class="ident" id="1361384">nbytes</span><span class="op" id="1361390">:</span><span class="ident" id="1361391">maxbytes</span><span class="op" id="1361399">]</span><span class="op" id="1361400">,</span>&nbsp;<span class="ident" id="1361402">r</span><span class="op" id="1361403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1361407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361411">i</span>&nbsp;<span class="op" id="1361413">+=</span>&nbsp;<span class="ident" id="1361416">wid</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1361421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1361424">return</span>&nbsp;<span class="ident" id="1361431">b</span><span class="op" id="1361432">[</span><span class="num" id="1361433">0</span><span class="op" id="1361434">:</span><span class="ident" id="1361435">nbytes</span><span class="op" id="1361441">]</span><br>
<span class="lineno"></span><span class="op" id="1361443">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1361446">//&nbsp;Repeat&nbsp;returns&nbsp;a&nbsp;new&nbsp;byte&nbsp;slice&nbsp;consisting&nbsp;of&nbsp;count&nbsp;copies&nbsp;of&nbsp;b.</span><br>
<span class="lineno">380</span><span class="keyword" id="1361514">func</span>&nbsp;<span class="ident" id="1361519">Repeat</span><span class="op" id="1361525">(</span><span class="ident" id="1361526">b</span>&nbsp;<span class="op" id="1361528">[</span><span class="op" id="1361529">]</span><span class="builtintype" id="1361530">byte</span><span class="op" id="1361534">,</span>&nbsp;<span class="ident" id="1361536">count</span>&nbsp;<span class="builtintype" id="1361542">int</span><span class="op" id="1361545">)</span>&nbsp;<span class="op" id="1361547">[</span><span class="op" id="1361548">]</span><span class="builtintype" id="1361549">byte</span>&nbsp;<span class="op" id="1361554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361557">nb</span>&nbsp;<span class="op" id="1361560">:=</span>&nbsp;<span class="builtinfunc" id="1361563">make</span><span class="op" id="1361567">(</span><span class="op" id="1361568">[</span><span class="op" id="1361569">]</span><span class="builtintype" id="1361570">byte</span><span class="op" id="1361574">,</span>&nbsp;<span class="builtinfunc" id="1361576">len</span><span class="op" id="1361579">(</span><span class="ident" id="1361580">b</span><span class="op" id="1361581">)</span><span class="op" id="1361582">*</span><span class="ident" id="1361583">count</span><span class="op" id="1361588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361591">bp</span>&nbsp;<span class="op" id="1361594">:=</span>&nbsp;<span class="builtinfunc" id="1361597">copy</span><span class="op" id="1361601">(</span><span class="ident" id="1361602">nb</span><span class="op" id="1361604">,</span>&nbsp;<span class="ident" id="1361606">b</span><span class="op" id="1361607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1361610">for</span>&nbsp;<span class="ident" id="1361614">bp</span>&nbsp;<span class="op" id="1361617">&lt;</span>&nbsp;<span class="builtinfunc" id="1361619">len</span><span class="op" id="1361622">(</span><span class="ident" id="1361623">nb</span><span class="op" id="1361625">)</span>&nbsp;<span class="op" id="1361627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1361631">copy</span><span class="op" id="1361635">(</span><span class="ident" id="1361636">nb</span><span class="op" id="1361638">[</span><span class="ident" id="1361639">bp</span><span class="op" id="1361641">:</span><span class="op" id="1361642">]</span><span class="op" id="1361643">,</span>&nbsp;<span class="ident" id="1361645">nb</span><span class="op" id="1361647">[</span><span class="op" id="1361648">:</span><span class="ident" id="1361649">bp</span><span class="op" id="1361651">]</span><span class="op" id="1361652">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1361656">bp</span>&nbsp;<span class="op" id="1361659">*=</span>&nbsp;<span class="num" id="1361662">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1361665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1361668">return</span>&nbsp;<span class="ident" id="1361675">nb</span><br>
<span class="lineno"></span><span class="op" id="1361678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="comment" id="1361681">//&nbsp;ToUpper&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their&nbsp;upper&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1361780">func</span>&nbsp;<span class="ident" id="1361785">ToUpper</span><span class="op" id="1361792">(</span><span class="ident" id="1361793">s</span>&nbsp;<span class="op" id="1361795">[</span><span class="op" id="1361796">]</span><span class="builtintype" id="1361797">byte</span><span class="op" id="1361801">)</span>&nbsp;<span class="op" id="1361803">[</span><span class="op" id="1361804">]</span><span class="builtintype" id="1361805">byte</span>&nbsp;<span class="op" id="1361810">{</span>&nbsp;<span class="keyword" id="1361812">return</span>&nbsp;<span class="ident" id="1361819">Map</span><span class="op" id="1361822">(</span><span class="ident" id="1361823">unicode</span><span class="op" id="1361830">.</span><span class="ident" id="1361831">ToUpper</span><span class="op" id="1361838">,</span>&nbsp;<span class="ident" id="1361840">s</span><span class="op" id="1361841">)</span>&nbsp;<span class="op" id="1361843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1361846">//&nbsp;ToLower&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their&nbsp;lower&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1361945">func</span>&nbsp;<span class="ident" id="1361950">ToLower</span><span class="op" id="1361957">(</span><span class="ident" id="1361958">s</span>&nbsp;<span class="op" id="1361960">[</span><span class="op" id="1361961">]</span><span class="builtintype" id="1361962">byte</span><span class="op" id="1361966">)</span>&nbsp;<span class="op" id="1361968">[</span><span class="op" id="1361969">]</span><span class="builtintype" id="1361970">byte</span>&nbsp;<span class="op" id="1361975">{</span>&nbsp;<span class="keyword" id="1361977">return</span>&nbsp;<span class="ident" id="1361984">Map</span><span class="op" id="1361987">(</span><span class="ident" id="1361988">unicode</span><span class="op" id="1361995">.</span><span class="ident" id="1361996">ToLower</span><span class="op" id="1362003">,</span>&nbsp;<span class="ident" id="1362005">s</span><span class="op" id="1362006">)</span>&nbsp;<span class="op" id="1362008">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="1362011">//&nbsp;ToTitle&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their&nbsp;title&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1362110">func</span>&nbsp;<span class="ident" id="1362115">ToTitle</span><span class="op" id="1362122">(</span><span class="ident" id="1362123">s</span>&nbsp;<span class="op" id="1362125">[</span><span class="op" id="1362126">]</span><span class="builtintype" id="1362127">byte</span><span class="op" id="1362131">)</span>&nbsp;<span class="op" id="1362133">[</span><span class="op" id="1362134">]</span><span class="builtintype" id="1362135">byte</span>&nbsp;<span class="op" id="1362140">{</span>&nbsp;<span class="keyword" id="1362142">return</span>&nbsp;<span class="ident" id="1362149">Map</span><span class="op" id="1362152">(</span><span class="ident" id="1362153">unicode</span><span class="op" id="1362160">.</span><span class="ident" id="1362161">ToTitle</span><span class="op" id="1362168">,</span>&nbsp;<span class="ident" id="1362170">s</span><span class="op" id="1362171">)</span>&nbsp;<span class="op" id="1362173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1362176">//&nbsp;ToUpperSpecial&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their</span><br>
<span class="lineno">400</span><span class="comment" id="1362270">//&nbsp;upper&nbsp;case,&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;casing&nbsp;rules.</span><br>
<span class="lineno"></span><span class="keyword" id="1362330">func</span>&nbsp;<span class="ident" id="1362335">ToUpperSpecial</span><span class="op" id="1362349">(</span><span class="ident" id="1362350">_case</span>&nbsp;<span class="ident" id="1362356">unicode</span><span class="op" id="1362363">.</span><span class="ident" id="1362364">SpecialCase</span><span class="op" id="1362375">,</span>&nbsp;<span class="ident" id="1362377">s</span>&nbsp;<span class="op" id="1362379">[</span><span class="op" id="1362380">]</span><span class="builtintype" id="1362381">byte</span><span class="op" id="1362385">)</span>&nbsp;<span class="op" id="1362387">[</span><span class="op" id="1362388">]</span><span class="builtintype" id="1362389">byte</span>&nbsp;<span class="op" id="1362394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1362397">return</span>&nbsp;<span class="ident" id="1362404">Map</span><span class="op" id="1362407">(</span><span class="keyword" id="1362408">func</span><span class="op" id="1362412">(</span><span class="ident" id="1362413">r</span>&nbsp;<span class="builtintype" id="1362415">rune</span><span class="op" id="1362419">)</span>&nbsp;<span class="builtintype" id="1362421">rune</span>&nbsp;<span class="op" id="1362426">{</span>&nbsp;<span class="keyword" id="1362428">return</span>&nbsp;<span class="ident" id="1362435">_case</span><span class="op" id="1362440">.</span><span class="ident" id="1362441">ToUpper</span><span class="op" id="1362448">(</span><span class="ident" id="1362449">r</span><span class="op" id="1362450">)</span>&nbsp;<span class="op" id="1362452">}</span><span class="op" id="1362453">,</span>&nbsp;<span class="ident" id="1362455">s</span><span class="op" id="1362456">)</span><br>
<span class="lineno"></span><span class="op" id="1362458">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="comment" id="1362461">//&nbsp;ToLowerSpecial&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their</span><br>
<span class="lineno"></span><span class="comment" id="1362555">//&nbsp;lower&nbsp;case,&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;casing&nbsp;rules.</span><br>
<span class="lineno"></span><span class="keyword" id="1362615">func</span>&nbsp;<span class="ident" id="1362620">ToLowerSpecial</span><span class="op" id="1362634">(</span><span class="ident" id="1362635">_case</span>&nbsp;<span class="ident" id="1362641">unicode</span><span class="op" id="1362648">.</span><span class="ident" id="1362649">SpecialCase</span><span class="op" id="1362660">,</span>&nbsp;<span class="ident" id="1362662">s</span>&nbsp;<span class="op" id="1362664">[</span><span class="op" id="1362665">]</span><span class="builtintype" id="1362666">byte</span><span class="op" id="1362670">)</span>&nbsp;<span class="op" id="1362672">[</span><span class="op" id="1362673">]</span><span class="builtintype" id="1362674">byte</span>&nbsp;<span class="op" id="1362679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1362682">return</span>&nbsp;<span class="ident" id="1362689">Map</span><span class="op" id="1362692">(</span><span class="keyword" id="1362693">func</span><span class="op" id="1362697">(</span><span class="ident" id="1362698">r</span>&nbsp;<span class="builtintype" id="1362700">rune</span><span class="op" id="1362704">)</span>&nbsp;<span class="builtintype" id="1362706">rune</span>&nbsp;<span class="op" id="1362711">{</span>&nbsp;<span class="keyword" id="1362713">return</span>&nbsp;<span class="ident" id="1362720">_case</span><span class="op" id="1362725">.</span><span class="ident" id="1362726">ToLower</span><span class="op" id="1362733">(</span><span class="ident" id="1362734">r</span><span class="op" id="1362735">)</span>&nbsp;<span class="op" id="1362737">}</span><span class="op" id="1362738">,</span>&nbsp;<span class="ident" id="1362740">s</span><span class="op" id="1362741">)</span><br>
<span class="lineno"></span><span class="op" id="1362743">}</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span><span class="comment" id="1362746">//&nbsp;ToTitleSpecial&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their</span><br>
<span class="lineno"></span><span class="comment" id="1362840">//&nbsp;title&nbsp;case,&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;casing&nbsp;rules.</span><br>
<span class="lineno"></span><span class="keyword" id="1362900">func</span>&nbsp;<span class="ident" id="1362905">ToTitleSpecial</span><span class="op" id="1362919">(</span><span class="ident" id="1362920">_case</span>&nbsp;<span class="ident" id="1362926">unicode</span><span class="op" id="1362933">.</span><span class="ident" id="1362934">SpecialCase</span><span class="op" id="1362945">,</span>&nbsp;<span class="ident" id="1362947">s</span>&nbsp;<span class="op" id="1362949">[</span><span class="op" id="1362950">]</span><span class="builtintype" id="1362951">byte</span><span class="op" id="1362955">)</span>&nbsp;<span class="op" id="1362957">[</span><span class="op" id="1362958">]</span><span class="builtintype" id="1362959">byte</span>&nbsp;<span class="op" id="1362964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1362967">return</span>&nbsp;<span class="ident" id="1362974">Map</span><span class="op" id="1362977">(</span><span class="keyword" id="1362978">func</span><span class="op" id="1362982">(</span><span class="ident" id="1362983">r</span>&nbsp;<span class="builtintype" id="1362985">rune</span><span class="op" id="1362989">)</span>&nbsp;<span class="builtintype" id="1362991">rune</span>&nbsp;<span class="op" id="1362996">{</span>&nbsp;<span class="keyword" id="1362998">return</span>&nbsp;<span class="ident" id="1363005">_case</span><span class="op" id="1363010">.</span><span class="ident" id="1363011">ToTitle</span><span class="op" id="1363018">(</span><span class="ident" id="1363019">r</span><span class="op" id="1363020">)</span>&nbsp;<span class="op" id="1363022">}</span><span class="op" id="1363023">,</span>&nbsp;<span class="ident" id="1363025">s</span><span class="op" id="1363026">)</span><br>
<span class="lineno">415</span><span class="op" id="1363028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1363031">//&nbsp;isSeparator&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;could&nbsp;mark&nbsp;a&nbsp;word&nbsp;boundary.</span><br>
<span class="lineno"></span><span class="comment" id="1363099">//&nbsp;TODO:&nbsp;update&nbsp;when&nbsp;package&nbsp;unicode&nbsp;captures&nbsp;more&nbsp;of&nbsp;the&nbsp;properties.</span><br>
<span class="lineno"></span><span class="keyword" id="1363169">func</span>&nbsp;<span class="ident" id="1363174">isSeparator</span><span class="op" id="1363185">(</span><span class="ident" id="1363186">r</span>&nbsp;<span class="builtintype" id="1363188">rune</span><span class="op" id="1363192">)</span>&nbsp;<span class="builtintype" id="1363194">bool</span>&nbsp;<span class="op" id="1363199">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1363202">//&nbsp;ASCII&nbsp;alphanumerics&nbsp;and&nbsp;underscore&nbsp;are&nbsp;not&nbsp;separators</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1363260">if</span>&nbsp;<span class="ident" id="1363263">r</span>&nbsp;<span class="op" id="1363265">&lt;=</span>&nbsp;<span class="num" id="1363268">0x7F</span>&nbsp;<span class="op" id="1363273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1363277">switch</span>&nbsp;<span class="op" id="1363284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1363288">case</span>&nbsp;<span class="string" id="1363293">&#39;0&#39;</span>&nbsp;<span class="op" id="1363297">&lt;=</span>&nbsp;<span class="ident" id="1363300">r</span>&nbsp;<span class="op" id="1363302">&amp;&amp;</span>&nbsp;<span class="ident" id="1363305">r</span>&nbsp;<span class="op" id="1363307">&lt;=</span>&nbsp;<span class="string" id="1363310">&#39;9&#39;</span><span class="op" id="1363313">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1363318">return</span>&nbsp;<span class="builtintype" id="1363325">false</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1363333">case</span>&nbsp;<span class="string" id="1363338">&#39;a&#39;</span>&nbsp;<span class="op" id="1363342">&lt;=</span>&nbsp;<span class="ident" id="1363345">r</span>&nbsp;<span class="op" id="1363347">&amp;&amp;</span>&nbsp;<span class="ident" id="1363350">r</span>&nbsp;<span class="op" id="1363352">&lt;=</span>&nbsp;<span class="string" id="1363355">&#39;z&#39;</span><span class="op" id="1363358">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1363363">return</span>&nbsp;<span class="builtintype" id="1363370">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1363378">case</span>&nbsp;<span class="string" id="1363383">&#39;A&#39;</span>&nbsp;<span class="op" id="1363387">&lt;=</span>&nbsp;<span class="ident" id="1363390">r</span>&nbsp;<span class="op" id="1363392">&amp;&amp;</span>&nbsp;<span class="ident" id="1363395">r</span>&nbsp;<span class="op" id="1363397">&lt;=</span>&nbsp;<span class="string" id="1363400">&#39;Z&#39;</span><span class="op" id="1363403">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1363408">return</span>&nbsp;<span class="builtintype" id="1363415">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1363423">case</span>&nbsp;<span class="ident" id="1363428">r</span>&nbsp;<span class="op" id="1363430">==</span>&nbsp;<span class="string" id="1363433">&#39;_&#39;</span><span class="op" id="1363436">:</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1363441">return</span>&nbsp;<span class="builtintype" id="1363448">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1363456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1363460">return</span>&nbsp;<span class="builtintype" id="1363467">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1363473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1363476">//&nbsp;Letters&nbsp;and&nbsp;digits&nbsp;are&nbsp;not&nbsp;separators</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1363518">if</span>&nbsp;<span class="ident" id="1363521">unicode</span><span class="op" id="1363528">.</span><span class="ident" id="1363529">IsLetter</span><span class="op" id="1363537">(</span><span class="ident" id="1363538">r</span><span class="op" id="1363539">)</span>&nbsp;<span class="op" id="1363541">||</span>&nbsp;<span class="ident" id="1363544">unicode</span><span class="op" id="1363551">.</span><span class="ident" id="1363552">IsDigit</span><span class="op" id="1363559">(</span><span class="ident" id="1363560">r</span><span class="op" id="1363561">)</span>&nbsp;<span class="op" id="1363563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1363567">return</span>&nbsp;<span class="builtintype" id="1363574">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1363581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1363584">//&nbsp;Otherwise,&nbsp;all&nbsp;we&nbsp;can&nbsp;do&nbsp;for&nbsp;now&nbsp;is&nbsp;treat&nbsp;spaces&nbsp;as&nbsp;separators.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1363652">return</span>&nbsp;<span class="ident" id="1363659">unicode</span><span class="op" id="1363666">.</span><span class="ident" id="1363667">IsSpace</span><span class="op" id="1363674">(</span><span class="ident" id="1363675">r</span><span class="op" id="1363676">)</span><br>
<span class="lineno">440</span><span class="op" id="1363678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1363681">//&nbsp;Title&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;that&nbsp;begin&nbsp;words</span><br>
<span class="lineno"></span><span class="comment" id="1363752">//&nbsp;mapped&nbsp;to&nbsp;their&nbsp;title&nbsp;case.</span><br>
<span class="lineno"></span><span class="comment" id="1363783">//</span><br>
<span class="lineno">445</span><span class="comment" id="1363786">//&nbsp;BUG:&nbsp;The&nbsp;rule&nbsp;Title&nbsp;uses&nbsp;for&nbsp;word&nbsp;boundaries&nbsp;does&nbsp;not&nbsp;handle&nbsp;Unicode&nbsp;punctuation&nbsp;properly.</span><br>
<span class="lineno"></span><span class="keyword" id="1363880">func</span>&nbsp;<span class="ident" id="1363885">Title</span><span class="op" id="1363890">(</span><span class="ident" id="1363891">s</span>&nbsp;<span class="op" id="1363893">[</span><span class="op" id="1363894">]</span><span class="builtintype" id="1363895">byte</span><span class="op" id="1363899">)</span>&nbsp;<span class="op" id="1363901">[</span><span class="op" id="1363902">]</span><span class="builtintype" id="1363903">byte</span>&nbsp;<span class="op" id="1363908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1363911">//&nbsp;Use&nbsp;a&nbsp;closure&nbsp;here&nbsp;to&nbsp;remember&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1363953">//&nbsp;Hackish&nbsp;but&nbsp;effective.&nbsp;Depends&nbsp;on&nbsp;Map&nbsp;scanning&nbsp;in&nbsp;order&nbsp;and&nbsp;calling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1364025">//&nbsp;the&nbsp;closure&nbsp;once&nbsp;per&nbsp;rune.</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364056">prev</span>&nbsp;<span class="op" id="1364061">:=</span>&nbsp;<span class="string" id="1364064">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1364069">return</span>&nbsp;<span class="ident" id="1364076">Map</span><span class="op" id="1364079">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1364083">func</span><span class="op" id="1364087">(</span><span class="ident" id="1364088">r</span>&nbsp;<span class="builtintype" id="1364090">rune</span><span class="op" id="1364094">)</span>&nbsp;<span class="builtintype" id="1364096">rune</span>&nbsp;<span class="op" id="1364101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1364106">if</span>&nbsp;<span class="ident" id="1364109">isSeparator</span><span class="op" id="1364120">(</span><span class="ident" id="1364121">prev</span><span class="op" id="1364125">)</span>&nbsp;<span class="op" id="1364127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364133">prev</span>&nbsp;<span class="op" id="1364138">=</span>&nbsp;<span class="ident" id="1364140">r</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1364146">return</span>&nbsp;<span class="ident" id="1364153">unicode</span><span class="op" id="1364160">.</span><span class="ident" id="1364161">ToTitle</span><span class="op" id="1364168">(</span><span class="ident" id="1364169">r</span><span class="op" id="1364170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1364175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364180">prev</span>&nbsp;<span class="op" id="1364185">=</span>&nbsp;<span class="ident" id="1364187">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1364192">return</span>&nbsp;<span class="ident" id="1364199">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1364203">}</span><span class="op" id="1364204">,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364208">s</span><span class="op" id="1364209">)</span><br>
<span class="lineno"></span><span class="op" id="1364211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1364214">//&nbsp;TrimLeftFunc&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;UTF-8-encoded</span><br>
<span class="lineno"></span><span class="comment" id="1364295">//&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;that&nbsp;satisfy&nbsp;f(c).</span><br>
<span class="lineno">465</span><span class="keyword" id="1364339">func</span>&nbsp;<span class="ident" id="1364344">TrimLeftFunc</span><span class="op" id="1364356">(</span><span class="ident" id="1364357">s</span>&nbsp;<span class="op" id="1364359">[</span><span class="op" id="1364360">]</span><span class="builtintype" id="1364361">byte</span><span class="op" id="1364365">,</span>&nbsp;<span class="ident" id="1364367">f</span>&nbsp;<span class="keyword" id="1364369">func</span><span class="op" id="1364373">(</span><span class="ident" id="1364374">r</span>&nbsp;<span class="builtintype" id="1364376">rune</span><span class="op" id="1364380">)</span>&nbsp;<span class="builtintype" id="1364382">bool</span><span class="op" id="1364386">)</span>&nbsp;<span class="op" id="1364388">[</span><span class="op" id="1364389">]</span><span class="builtintype" id="1364390">byte</span>&nbsp;<span class="op" id="1364395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364398">i</span>&nbsp;<span class="op" id="1364400">:=</span>&nbsp;<span class="ident" id="1364403">indexFunc</span><span class="op" id="1364412">(</span><span class="ident" id="1364413">s</span><span class="op" id="1364414">,</span>&nbsp;<span class="ident" id="1364416">f</span><span class="op" id="1364417">,</span>&nbsp;<span class="builtintype" id="1364419">false</span><span class="op" id="1364424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1364427">if</span>&nbsp;<span class="ident" id="1364430">i</span>&nbsp;<span class="op" id="1364432">==</span>&nbsp;<span class="op" id="1364435">-</span><span class="num" id="1364436">1</span>&nbsp;<span class="op" id="1364438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1364442">return</span>&nbsp;<span class="ident" id="1364449">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1364454">}</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1364457">return</span>&nbsp;<span class="ident" id="1364464">s</span><span class="op" id="1364465">[</span><span class="ident" id="1364466">i</span><span class="op" id="1364467">:</span><span class="op" id="1364468">]</span><br>
<span class="lineno"></span><span class="op" id="1364470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1364473">//&nbsp;TrimRightFunc&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;trailing&nbsp;UTF-8</span><br>
<span class="lineno"></span><span class="comment" id="1364548">//&nbsp;encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;that&nbsp;satisfy&nbsp;f(c).</span><br>
<span class="lineno">475</span><span class="keyword" id="1364600">func</span>&nbsp;<span class="ident" id="1364605">TrimRightFunc</span><span class="op" id="1364618">(</span><span class="ident" id="1364619">s</span>&nbsp;<span class="op" id="1364621">[</span><span class="op" id="1364622">]</span><span class="builtintype" id="1364623">byte</span><span class="op" id="1364627">,</span>&nbsp;<span class="ident" id="1364629">f</span>&nbsp;<span class="keyword" id="1364631">func</span><span class="op" id="1364635">(</span><span class="ident" id="1364636">r</span>&nbsp;<span class="builtintype" id="1364638">rune</span><span class="op" id="1364642">)</span>&nbsp;<span class="builtintype" id="1364644">bool</span><span class="op" id="1364648">)</span>&nbsp;<span class="op" id="1364650">[</span><span class="op" id="1364651">]</span><span class="builtintype" id="1364652">byte</span>&nbsp;<span class="op" id="1364657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364660">i</span>&nbsp;<span class="op" id="1364662">:=</span>&nbsp;<span class="ident" id="1364665">lastIndexFunc</span><span class="op" id="1364678">(</span><span class="ident" id="1364679">s</span><span class="op" id="1364680">,</span>&nbsp;<span class="ident" id="1364682">f</span><span class="op" id="1364683">,</span>&nbsp;<span class="builtintype" id="1364685">false</span><span class="op" id="1364690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1364693">if</span>&nbsp;<span class="ident" id="1364696">i</span>&nbsp;<span class="op" id="1364698">&gt;=</span>&nbsp;<span class="num" id="1364701">0</span>&nbsp;<span class="op" id="1364703">&amp;&amp;</span>&nbsp;<span class="ident" id="1364706">s</span><span class="op" id="1364707">[</span><span class="ident" id="1364708">i</span><span class="op" id="1364709">]</span>&nbsp;<span class="op" id="1364711">&gt;=</span>&nbsp;<span class="ident" id="1364714">utf8</span><span class="op" id="1364718">.</span><span class="ident" id="1364719">RuneSelf</span>&nbsp;<span class="op" id="1364728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364732">_</span><span class="op" id="1364733">,</span>&nbsp;<span class="ident" id="1364735">wid</span>&nbsp;<span class="op" id="1364739">:=</span>&nbsp;<span class="ident" id="1364742">utf8</span><span class="op" id="1364746">.</span><span class="ident" id="1364747">DecodeRune</span><span class="op" id="1364757">(</span><span class="ident" id="1364758">s</span><span class="op" id="1364759">[</span><span class="ident" id="1364760">i</span><span class="op" id="1364761">:</span><span class="op" id="1364762">]</span><span class="op" id="1364763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364767">i</span>&nbsp;<span class="op" id="1364769">+=</span>&nbsp;<span class="ident" id="1364772">wid</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1364777">}</span>&nbsp;<span class="keyword" id="1364779">else</span>&nbsp;<span class="op" id="1364784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1364788">i</span><span class="op" id="1364789">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1364793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1364796">return</span>&nbsp;<span class="ident" id="1364803">s</span><span class="op" id="1364804">[</span><span class="num" id="1364805">0</span><span class="op" id="1364806">:</span><span class="ident" id="1364807">i</span><span class="op" id="1364808">]</span><br>
<span class="lineno"></span><span class="op" id="1364810">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span><span class="comment" id="1364813">//&nbsp;TrimFunc&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;and&nbsp;trailing</span><br>
<span class="lineno"></span><span class="comment" id="1364889">//&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;that&nbsp;satisfy&nbsp;f(c).</span><br>
<span class="lineno"></span><span class="keyword" id="1364947">func</span>&nbsp;<span class="ident" id="1364952">TrimFunc</span><span class="op" id="1364960">(</span><span class="ident" id="1364961">s</span>&nbsp;<span class="op" id="1364963">[</span><span class="op" id="1364964">]</span><span class="builtintype" id="1364965">byte</span><span class="op" id="1364969">,</span>&nbsp;<span class="ident" id="1364971">f</span>&nbsp;<span class="keyword" id="1364973">func</span><span class="op" id="1364977">(</span><span class="ident" id="1364978">r</span>&nbsp;<span class="builtintype" id="1364980">rune</span><span class="op" id="1364984">)</span>&nbsp;<span class="builtintype" id="1364986">bool</span><span class="op" id="1364990">)</span>&nbsp;<span class="op" id="1364992">[</span><span class="op" id="1364993">]</span><span class="builtintype" id="1364994">byte</span>&nbsp;<span class="op" id="1364999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1365002">return</span>&nbsp;<span class="ident" id="1365009">TrimRightFunc</span><span class="op" id="1365022">(</span><span class="ident" id="1365023">TrimLeftFunc</span><span class="op" id="1365035">(</span><span class="ident" id="1365036">s</span><span class="op" id="1365037">,</span>&nbsp;<span class="ident" id="1365039">f</span><span class="op" id="1365040">)</span><span class="op" id="1365041">,</span>&nbsp;<span class="ident" id="1365043">f</span><span class="op" id="1365044">)</span><br>
<span class="lineno">490</span><span class="op" id="1365046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1365049">//&nbsp;TrimPrefix&nbsp;returns&nbsp;s&nbsp;without&nbsp;the&nbsp;provided&nbsp;leading&nbsp;prefix&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="1365117">//&nbsp;If&nbsp;s&nbsp;doesn&#39;t&nbsp;start&nbsp;with&nbsp;prefix,&nbsp;s&nbsp;is&nbsp;returned&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="keyword" id="1365177">func</span>&nbsp;<span class="ident" id="1365182">TrimPrefix</span><span class="op" id="1365192">(</span><span class="ident" id="1365193">s</span><span class="op" id="1365194">,</span>&nbsp;<span class="ident" id="1365196">prefix</span>&nbsp;<span class="op" id="1365203">[</span><span class="op" id="1365204">]</span><span class="builtintype" id="1365205">byte</span><span class="op" id="1365209">)</span>&nbsp;<span class="op" id="1365211">[</span><span class="op" id="1365212">]</span><span class="builtintype" id="1365213">byte</span>&nbsp;<span class="op" id="1365218">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1365221">if</span>&nbsp;<span class="ident" id="1365224">HasPrefix</span><span class="op" id="1365233">(</span><span class="ident" id="1365234">s</span><span class="op" id="1365235">,</span>&nbsp;<span class="ident" id="1365237">prefix</span><span class="op" id="1365243">)</span>&nbsp;<span class="op" id="1365245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1365249">return</span>&nbsp;<span class="ident" id="1365256">s</span><span class="op" id="1365257">[</span><span class="builtinfunc" id="1365258">len</span><span class="op" id="1365261">(</span><span class="ident" id="1365262">prefix</span><span class="op" id="1365268">)</span><span class="op" id="1365269">:</span><span class="op" id="1365270">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1365273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1365276">return</span>&nbsp;<span class="ident" id="1365283">s</span><br>
<span class="lineno"></span><span class="op" id="1365285">}</span><br>
<span class="lineno">500</span><br>
<span class="lineno"></span><span class="comment" id="1365288">//&nbsp;TrimSuffix&nbsp;returns&nbsp;s&nbsp;without&nbsp;the&nbsp;provided&nbsp;trailing&nbsp;suffix&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="1365357">//&nbsp;If&nbsp;s&nbsp;doesn&#39;t&nbsp;end&nbsp;with&nbsp;suffix,&nbsp;s&nbsp;is&nbsp;returned&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="keyword" id="1365415">func</span>&nbsp;<span class="ident" id="1365420">TrimSuffix</span><span class="op" id="1365430">(</span><span class="ident" id="1365431">s</span><span class="op" id="1365432">,</span>&nbsp;<span class="ident" id="1365434">suffix</span>&nbsp;<span class="op" id="1365441">[</span><span class="op" id="1365442">]</span><span class="builtintype" id="1365443">byte</span><span class="op" id="1365447">)</span>&nbsp;<span class="op" id="1365449">[</span><span class="op" id="1365450">]</span><span class="builtintype" id="1365451">byte</span>&nbsp;<span class="op" id="1365456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1365459">if</span>&nbsp;<span class="ident" id="1365462">HasSuffix</span><span class="op" id="1365471">(</span><span class="ident" id="1365472">s</span><span class="op" id="1365473">,</span>&nbsp;<span class="ident" id="1365475">suffix</span><span class="op" id="1365481">)</span>&nbsp;<span class="op" id="1365483">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1365487">return</span>&nbsp;<span class="ident" id="1365494">s</span><span class="op" id="1365495">[</span><span class="op" id="1365496">:</span><span class="builtinfunc" id="1365497">len</span><span class="op" id="1365500">(</span><span class="ident" id="1365501">s</span><span class="op" id="1365502">)</span><span class="op" id="1365503">-</span><span class="builtinfunc" id="1365504">len</span><span class="op" id="1365507">(</span><span class="ident" id="1365508">suffix</span><span class="op" id="1365514">)</span><span class="op" id="1365515">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1365518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1365521">return</span>&nbsp;<span class="ident" id="1365528">s</span><br>
<span class="lineno"></span><span class="op" id="1365530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span><span class="comment" id="1365533">//&nbsp;IndexFunc&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="1365611">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;first&nbsp;Unicode</span><br>
<span class="lineno"></span><span class="comment" id="1365666">//&nbsp;code&nbsp;point&nbsp;satisfying&nbsp;f(c),&nbsp;or&nbsp;-1&nbsp;if&nbsp;none&nbsp;do.</span><br>
<span class="lineno"></span><span class="keyword" id="1365715">func</span>&nbsp;<span class="ident" id="1365720">IndexFunc</span><span class="op" id="1365729">(</span><span class="ident" id="1365730">s</span>&nbsp;<span class="op" id="1365732">[</span><span class="op" id="1365733">]</span><span class="builtintype" id="1365734">byte</span><span class="op" id="1365738">,</span>&nbsp;<span class="ident" id="1365740">f</span>&nbsp;<span class="keyword" id="1365742">func</span><span class="op" id="1365746">(</span><span class="ident" id="1365747">r</span>&nbsp;<span class="builtintype" id="1365749">rune</span><span class="op" id="1365753">)</span>&nbsp;<span class="builtintype" id="1365755">bool</span><span class="op" id="1365759">)</span>&nbsp;<span class="builtintype" id="1365761">int</span>&nbsp;<span class="op" id="1365765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1365768">return</span>&nbsp;<span class="ident" id="1365775">indexFunc</span><span class="op" id="1365784">(</span><span class="ident" id="1365785">s</span><span class="op" id="1365786">,</span>&nbsp;<span class="ident" id="1365788">f</span><span class="op" id="1365789">,</span>&nbsp;<span class="builtintype" id="1365791">true</span><span class="op" id="1365795">)</span><br>
<span class="lineno">515</span><span class="op" id="1365797">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1365800">//&nbsp;LastIndexFunc&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="1365882">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;last&nbsp;Unicode</span><br>
<span class="lineno"></span><span class="comment" id="1365936">//&nbsp;code&nbsp;point&nbsp;satisfying&nbsp;f(c),&nbsp;or&nbsp;-1&nbsp;if&nbsp;none&nbsp;do.</span><br>
<span class="lineno">520</span><span class="keyword" id="1365985">func</span>&nbsp;<span class="ident" id="1365990">LastIndexFunc</span><span class="op" id="1366003">(</span><span class="ident" id="1366004">s</span>&nbsp;<span class="op" id="1366006">[</span><span class="op" id="1366007">]</span><span class="builtintype" id="1366008">byte</span><span class="op" id="1366012">,</span>&nbsp;<span class="ident" id="1366014">f</span>&nbsp;<span class="keyword" id="1366016">func</span><span class="op" id="1366020">(</span><span class="ident" id="1366021">r</span>&nbsp;<span class="builtintype" id="1366023">rune</span><span class="op" id="1366027">)</span>&nbsp;<span class="builtintype" id="1366029">bool</span><span class="op" id="1366033">)</span>&nbsp;<span class="builtintype" id="1366035">int</span>&nbsp;<span class="op" id="1366039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1366042">return</span>&nbsp;<span class="ident" id="1366049">lastIndexFunc</span><span class="op" id="1366062">(</span><span class="ident" id="1366063">s</span><span class="op" id="1366064">,</span>&nbsp;<span class="ident" id="1366066">f</span><span class="op" id="1366067">,</span>&nbsp;<span class="builtintype" id="1366069">true</span><span class="op" id="1366073">)</span><br>
<span class="lineno"></span><span class="op" id="1366075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1366078">//&nbsp;indexFunc&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;IndexFunc&nbsp;except&nbsp;that&nbsp;if</span><br>
<span class="lineno">525</span><span class="comment" id="1366131">//&nbsp;truth==false,&nbsp;the&nbsp;sense&nbsp;of&nbsp;the&nbsp;predicate&nbsp;function&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1366187">//&nbsp;inverted.</span><br>
<span class="lineno"></span><span class="keyword" id="1366200">func</span>&nbsp;<span class="ident" id="1366205">indexFunc</span><span class="op" id="1366214">(</span><span class="ident" id="1366215">s</span>&nbsp;<span class="op" id="1366217">[</span><span class="op" id="1366218">]</span><span class="builtintype" id="1366219">byte</span><span class="op" id="1366223">,</span>&nbsp;<span class="ident" id="1366225">f</span>&nbsp;<span class="keyword" id="1366227">func</span><span class="op" id="1366231">(</span><span class="ident" id="1366232">r</span>&nbsp;<span class="builtintype" id="1366234">rune</span><span class="op" id="1366238">)</span>&nbsp;<span class="builtintype" id="1366240">bool</span><span class="op" id="1366244">,</span>&nbsp;<span class="ident" id="1366246">truth</span>&nbsp;<span class="builtintype" id="1366252">bool</span><span class="op" id="1366256">)</span>&nbsp;<span class="builtintype" id="1366258">int</span>&nbsp;<span class="op" id="1366262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1366265">start</span>&nbsp;<span class="op" id="1366271">:=</span>&nbsp;<span class="num" id="1366274">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1366277">for</span>&nbsp;<span class="ident" id="1366281">start</span>&nbsp;<span class="op" id="1366287">&lt;</span>&nbsp;<span class="builtinfunc" id="1366289">len</span><span class="op" id="1366292">(</span><span class="ident" id="1366293">s</span><span class="op" id="1366294">)</span>&nbsp;<span class="op" id="1366296">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1366300">wid</span>&nbsp;<span class="op" id="1366304">:=</span>&nbsp;<span class="num" id="1366307">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1366311">r</span>&nbsp;<span class="op" id="1366313">:=</span>&nbsp;<span class="builtintype" id="1366316">rune</span><span class="op" id="1366320">(</span><span class="ident" id="1366321">s</span><span class="op" id="1366322">[</span><span class="ident" id="1366323">start</span><span class="op" id="1366328">]</span><span class="op" id="1366329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1366333">if</span>&nbsp;<span class="ident" id="1366336">r</span>&nbsp;<span class="op" id="1366338">&gt;=</span>&nbsp;<span class="ident" id="1366341">utf8</span><span class="op" id="1366345">.</span><span class="ident" id="1366346">RuneSelf</span>&nbsp;<span class="op" id="1366355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1366360">r</span><span class="op" id="1366361">,</span>&nbsp;<span class="ident" id="1366363">wid</span>&nbsp;<span class="op" id="1366367">=</span>&nbsp;<span class="ident" id="1366369">utf8</span><span class="op" id="1366373">.</span><span class="ident" id="1366374">DecodeRune</span><span class="op" id="1366384">(</span><span class="ident" id="1366385">s</span><span class="op" id="1366386">[</span><span class="ident" id="1366387">start</span><span class="op" id="1366392">:</span><span class="op" id="1366393">]</span><span class="op" id="1366394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1366398">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1366402">if</span>&nbsp;<span class="ident" id="1366405">f</span><span class="op" id="1366406">(</span><span class="ident" id="1366407">r</span><span class="op" id="1366408">)</span>&nbsp;<span class="op" id="1366410">==</span>&nbsp;<span class="ident" id="1366413">truth</span>&nbsp;<span class="op" id="1366419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1366424">return</span>&nbsp;<span class="ident" id="1366431">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1366439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1366443">start</span>&nbsp;<span class="op" id="1366449">+=</span>&nbsp;<span class="ident" id="1366452">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1366457">}</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1366460">return</span>&nbsp;<span class="op" id="1366467">-</span><span class="num" id="1366468">1</span><br>
<span class="lineno"></span><span class="op" id="1366470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1366473">//&nbsp;lastIndexFunc&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;LastIndexFunc&nbsp;except&nbsp;that&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="1366534">//&nbsp;truth==false,&nbsp;the&nbsp;sense&nbsp;of&nbsp;the&nbsp;predicate&nbsp;function&nbsp;is</span><br>
<span class="lineno">545</span><span class="comment" id="1366590">//&nbsp;inverted.</span><br>
<span class="lineno"></span><span class="keyword" id="1366603">func</span>&nbsp;<span class="ident" id="1366608">lastIndexFunc</span><span class="op" id="1366621">(</span><span class="ident" id="1366622">s</span>&nbsp;<span class="op" id="1366624">[</span><span class="op" id="1366625">]</span><span class="builtintype" id="1366626">byte</span><span class="op" id="1366630">,</span>&nbsp;<span class="ident" id="1366632">f</span>&nbsp;<span class="keyword" id="1366634">func</span><span class="op" id="1366638">(</span><span class="ident" id="1366639">r</span>&nbsp;<span class="builtintype" id="1366641">rune</span><span class="op" id="1366645">)</span>&nbsp;<span class="builtintype" id="1366647">bool</span><span class="op" id="1366651">,</span>&nbsp;<span class="ident" id="1366653">truth</span>&nbsp;<span class="builtintype" id="1366659">bool</span><span class="op" id="1366663">)</span>&nbsp;<span class="builtintype" id="1366665">int</span>&nbsp;<span class="op" id="1366669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1366672">for</span>&nbsp;<span class="ident" id="1366676">i</span>&nbsp;<span class="op" id="1366678">:=</span>&nbsp;<span class="builtinfunc" id="1366681">len</span><span class="op" id="1366684">(</span><span class="ident" id="1366685">s</span><span class="op" id="1366686">)</span><span class="op" id="1366687">;</span>&nbsp;<span class="ident" id="1366689">i</span>&nbsp;<span class="op" id="1366691">&gt;</span>&nbsp;<span class="num" id="1366693">0</span><span class="op" id="1366694">;</span>&nbsp;<span class="op" id="1366696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1366700">r</span><span class="op" id="1366701">,</span>&nbsp;<span class="ident" id="1366703">size</span>&nbsp;<span class="op" id="1366708">:=</span>&nbsp;<span class="builtintype" id="1366711">rune</span><span class="op" id="1366715">(</span><span class="ident" id="1366716">s</span><span class="op" id="1366717">[</span><span class="ident" id="1366718">i</span><span class="op" id="1366719">-</span><span class="num" id="1366720">1</span><span class="op" id="1366721">]</span><span class="op" id="1366722">)</span><span class="op" id="1366723">,</span>&nbsp;<span class="num" id="1366725">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1366729">if</span>&nbsp;<span class="ident" id="1366732">r</span>&nbsp;<span class="op" id="1366734">&gt;=</span>&nbsp;<span class="ident" id="1366737">utf8</span><span class="op" id="1366741">.</span><span class="ident" id="1366742">RuneSelf</span>&nbsp;<span class="op" id="1366751">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1366756">r</span><span class="op" id="1366757">,</span>&nbsp;<span class="ident" id="1366759">size</span>&nbsp;<span class="op" id="1366764">=</span>&nbsp;<span class="ident" id="1366766">utf8</span><span class="op" id="1366770">.</span><span class="ident" id="1366771">DecodeLastRune</span><span class="op" id="1366785">(</span><span class="ident" id="1366786">s</span><span class="op" id="1366787">[</span><span class="num" id="1366788">0</span><span class="op" id="1366789">:</span><span class="ident" id="1366790">i</span><span class="op" id="1366791">]</span><span class="op" id="1366792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1366796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1366800">i</span>&nbsp;<span class="op" id="1366802">-=</span>&nbsp;<span class="ident" id="1366805">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1366812">if</span>&nbsp;<span class="ident" id="1366815">f</span><span class="op" id="1366816">(</span><span class="ident" id="1366817">r</span><span class="op" id="1366818">)</span>&nbsp;<span class="op" id="1366820">==</span>&nbsp;<span class="ident" id="1366823">truth</span>&nbsp;<span class="op" id="1366829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1366834">return</span>&nbsp;<span class="ident" id="1366841">i</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1366845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1366848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1366851">return</span>&nbsp;<span class="op" id="1366858">-</span><span class="num" id="1366859">1</span><br>
<span class="lineno"></span><span class="op" id="1366861">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span><span class="keyword" id="1366864">func</span>&nbsp;<span class="ident" id="1366869">makeCutsetFunc</span><span class="op" id="1366883">(</span><span class="ident" id="1366884">cutset</span>&nbsp;<span class="builtintype" id="1366891">string</span><span class="op" id="1366897">)</span>&nbsp;<span class="keyword" id="1366899">func</span><span class="op" id="1366903">(</span><span class="ident" id="1366904">r</span>&nbsp;<span class="builtintype" id="1366906">rune</span><span class="op" id="1366910">)</span>&nbsp;<span class="builtintype" id="1366912">bool</span>&nbsp;<span class="op" id="1366917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1366920">return</span>&nbsp;<span class="keyword" id="1366927">func</span><span class="op" id="1366931">(</span><span class="ident" id="1366932">r</span>&nbsp;<span class="builtintype" id="1366934">rune</span><span class="op" id="1366938">)</span>&nbsp;<span class="builtintype" id="1366940">bool</span>&nbsp;<span class="op" id="1366945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1366949">for</span>&nbsp;<span class="ident" id="1366953">_</span><span class="op" id="1366954">,</span>&nbsp;<span class="ident" id="1366956">c</span>&nbsp;<span class="op" id="1366958">:=</span>&nbsp;<span class="keyword" id="1366961">range</span>&nbsp;<span class="ident" id="1366967">cutset</span>&nbsp;<span class="op" id="1366974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1366979">if</span>&nbsp;<span class="ident" id="1366982">c</span>&nbsp;<span class="op" id="1366984">==</span>&nbsp;<span class="ident" id="1366987">r</span>&nbsp;<span class="op" id="1366989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1366995">return</span>&nbsp;<span class="builtintype" id="1367002">true</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1367010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1367014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1367018">return</span>&nbsp;<span class="builtintype" id="1367025">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1367032">}</span><br>
<span class="lineno"></span><span class="op" id="1367034">}</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span><span class="comment" id="1367037">//&nbsp;Trim&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1367100">//&nbsp;trailing&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;contained&nbsp;in&nbsp;cutset.</span><br>
<span class="lineno"></span><span class="keyword" id="1367167">func</span>&nbsp;<span class="ident" id="1367172">Trim</span><span class="op" id="1367176">(</span><span class="ident" id="1367177">s</span>&nbsp;<span class="op" id="1367179">[</span><span class="op" id="1367180">]</span><span class="builtintype" id="1367181">byte</span><span class="op" id="1367185">,</span>&nbsp;<span class="ident" id="1367187">cutset</span>&nbsp;<span class="builtintype" id="1367194">string</span><span class="op" id="1367200">)</span>&nbsp;<span class="op" id="1367202">[</span><span class="op" id="1367203">]</span><span class="builtintype" id="1367204">byte</span>&nbsp;<span class="op" id="1367209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1367212">return</span>&nbsp;<span class="ident" id="1367219">TrimFunc</span><span class="op" id="1367227">(</span><span class="ident" id="1367228">s</span><span class="op" id="1367229">,</span>&nbsp;<span class="ident" id="1367231">makeCutsetFunc</span><span class="op" id="1367245">(</span><span class="ident" id="1367246">cutset</span><span class="op" id="1367252">)</span><span class="op" id="1367253">)</span><br>
<span class="lineno">575</span><span class="op" id="1367255">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1367258">//&nbsp;TrimLeft&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading</span><br>
<span class="lineno"></span><span class="comment" id="1367321">//&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;contained&nbsp;in&nbsp;cutset.</span><br>
<span class="lineno"></span><span class="keyword" id="1367379">func</span>&nbsp;<span class="ident" id="1367384">TrimLeft</span><span class="op" id="1367392">(</span><span class="ident" id="1367393">s</span>&nbsp;<span class="op" id="1367395">[</span><span class="op" id="1367396">]</span><span class="builtintype" id="1367397">byte</span><span class="op" id="1367401">,</span>&nbsp;<span class="ident" id="1367403">cutset</span>&nbsp;<span class="builtintype" id="1367410">string</span><span class="op" id="1367416">)</span>&nbsp;<span class="op" id="1367418">[</span><span class="op" id="1367419">]</span><span class="builtintype" id="1367420">byte</span>&nbsp;<span class="op" id="1367425">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1367428">return</span>&nbsp;<span class="ident" id="1367435">TrimLeftFunc</span><span class="op" id="1367447">(</span><span class="ident" id="1367448">s</span><span class="op" id="1367449">,</span>&nbsp;<span class="ident" id="1367451">makeCutsetFunc</span><span class="op" id="1367465">(</span><span class="ident" id="1367466">cutset</span><span class="op" id="1367472">)</span><span class="op" id="1367473">)</span><br>
<span class="lineno"></span><span class="op" id="1367475">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1367478">//&nbsp;TrimRight&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;trailing</span><br>
<span class="lineno"></span><span class="comment" id="1367543">//&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;that&nbsp;are&nbsp;contained&nbsp;in&nbsp;cutset.</span><br>
<span class="lineno">585</span><span class="keyword" id="1367610">func</span>&nbsp;<span class="ident" id="1367615">TrimRight</span><span class="op" id="1367624">(</span><span class="ident" id="1367625">s</span>&nbsp;<span class="op" id="1367627">[</span><span class="op" id="1367628">]</span><span class="builtintype" id="1367629">byte</span><span class="op" id="1367633">,</span>&nbsp;<span class="ident" id="1367635">cutset</span>&nbsp;<span class="builtintype" id="1367642">string</span><span class="op" id="1367648">)</span>&nbsp;<span class="op" id="1367650">[</span><span class="op" id="1367651">]</span><span class="builtintype" id="1367652">byte</span>&nbsp;<span class="op" id="1367657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1367660">return</span>&nbsp;<span class="ident" id="1367667">TrimRightFunc</span><span class="op" id="1367680">(</span><span class="ident" id="1367681">s</span><span class="op" id="1367682">,</span>&nbsp;<span class="ident" id="1367684">makeCutsetFunc</span><span class="op" id="1367698">(</span><span class="ident" id="1367699">cutset</span><span class="op" id="1367705">)</span><span class="op" id="1367706">)</span><br>
<span class="lineno"></span><span class="op" id="1367708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1367711">//&nbsp;TrimSpace&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;and</span><br>
<span class="lineno">590</span><span class="comment" id="1367779">//&nbsp;trailing&nbsp;white&nbsp;space,&nbsp;as&nbsp;defined&nbsp;by&nbsp;Unicode.</span><br>
<span class="lineno"></span><span class="keyword" id="1367827">func</span>&nbsp;<span class="ident" id="1367832">TrimSpace</span><span class="op" id="1367841">(</span><span class="ident" id="1367842">s</span>&nbsp;<span class="op" id="1367844">[</span><span class="op" id="1367845">]</span><span class="builtintype" id="1367846">byte</span><span class="op" id="1367850">)</span>&nbsp;<span class="op" id="1367852">[</span><span class="op" id="1367853">]</span><span class="builtintype" id="1367854">byte</span>&nbsp;<span class="op" id="1367859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1367862">return</span>&nbsp;<span class="ident" id="1367869">TrimFunc</span><span class="op" id="1367877">(</span><span class="ident" id="1367878">s</span><span class="op" id="1367879">,</span>&nbsp;<span class="ident" id="1367881">unicode</span><span class="op" id="1367888">.</span><span class="ident" id="1367889">IsSpace</span><span class="op" id="1367896">)</span><br>
<span class="lineno"></span><span class="op" id="1367898">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="1367901">//&nbsp;Runes&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;runes&nbsp;(Unicode&nbsp;code&nbsp;points)&nbsp;equivalent&nbsp;to&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="1367974">func</span>&nbsp;<span class="ident" id="1367979">Runes</span><span class="op" id="1367984">(</span><span class="ident" id="1367985">s</span>&nbsp;<span class="op" id="1367987">[</span><span class="op" id="1367988">]</span><span class="builtintype" id="1367989">byte</span><span class="op" id="1367993">)</span>&nbsp;<span class="op" id="1367995">[</span><span class="op" id="1367996">]</span><span class="builtintype" id="1367997">rune</span>&nbsp;<span class="op" id="1368002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1368005">t</span>&nbsp;<span class="op" id="1368007">:=</span>&nbsp;<span class="builtinfunc" id="1368010">make</span><span class="op" id="1368014">(</span><span class="op" id="1368015">[</span><span class="op" id="1368016">]</span><span class="builtintype" id="1368017">rune</span><span class="op" id="1368021">,</span>&nbsp;<span class="ident" id="1368023">utf8</span><span class="op" id="1368027">.</span><span class="ident" id="1368028">RuneCount</span><span class="op" id="1368037">(</span><span class="ident" id="1368038">s</span><span class="op" id="1368039">)</span><span class="op" id="1368040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1368043">i</span>&nbsp;<span class="op" id="1368045">:=</span>&nbsp;<span class="num" id="1368048">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1368051">for</span>&nbsp;<span class="builtinfunc" id="1368055">len</span><span class="op" id="1368058">(</span><span class="ident" id="1368059">s</span><span class="op" id="1368060">)</span>&nbsp;<span class="op" id="1368062">&gt;</span>&nbsp;<span class="num" id="1368064">0</span>&nbsp;<span class="op" id="1368066">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1368070">r</span><span class="op" id="1368071">,</span>&nbsp;<span class="ident" id="1368073">l</span>&nbsp;<span class="op" id="1368075">:=</span>&nbsp;<span class="ident" id="1368078">utf8</span><span class="op" id="1368082">.</span><span class="ident" id="1368083">DecodeRune</span><span class="op" id="1368093">(</span><span class="ident" id="1368094">s</span><span class="op" id="1368095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1368099">t</span><span class="op" id="1368100">[</span><span class="ident" id="1368101">i</span><span class="op" id="1368102">]</span>&nbsp;<span class="op" id="1368104">=</span>&nbsp;<span class="ident" id="1368106">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1368110">i</span><span class="op" id="1368111">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1368116">s</span>&nbsp;<span class="op" id="1368118">=</span>&nbsp;<span class="ident" id="1368120">s</span><span class="op" id="1368121">[</span><span class="ident" id="1368122">l</span><span class="op" id="1368123">:</span><span class="op" id="1368124">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1368127">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1368130">return</span>&nbsp;<span class="ident" id="1368137">t</span><br>
<span class="lineno"></span><span class="op" id="1368139">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1368142">//&nbsp;Replace&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;slice&nbsp;s&nbsp;with&nbsp;the&nbsp;first&nbsp;n</span><br>
<span class="lineno"></span><span class="comment" id="1368200">//&nbsp;non-overlapping&nbsp;instances&nbsp;of&nbsp;old&nbsp;replaced&nbsp;by&nbsp;new.</span><br>
<span class="lineno">610</span><span class="comment" id="1368253">//&nbsp;If&nbsp;old&nbsp;is&nbsp;empty,&nbsp;it&nbsp;matches&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="1368314">//&nbsp;and&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence,&nbsp;yielding&nbsp;up&nbsp;to&nbsp;k+1&nbsp;replacements</span><br>
<span class="lineno"></span><span class="comment" id="1368380">//&nbsp;for&nbsp;a&nbsp;k-rune&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="1368403">//&nbsp;If&nbsp;n&nbsp;&lt;&nbsp;0,&nbsp;there&nbsp;is&nbsp;no&nbsp;limit&nbsp;on&nbsp;the&nbsp;number&nbsp;of&nbsp;replacements.</span><br>
<span class="lineno"></span><span class="keyword" id="1368465">func</span>&nbsp;<span class="ident" id="1368470">Replace</span><span class="op" id="1368477">(</span><span class="ident" id="1368478">s</span><span class="op" id="1368479">,</span>&nbsp;<span class="ident" id="1368481">old</span><span class="op" id="1368484">,</span>&nbsp;<span class="builtinfunc" id="1368486">new</span>&nbsp;<span class="op" id="1368490">[</span><span class="op" id="1368491">]</span><span class="builtintype" id="1368492">byte</span><span class="op" id="1368496">,</span>&nbsp;<span class="ident" id="1368498">n</span>&nbsp;<span class="builtintype" id="1368500">int</span><span class="op" id="1368503">)</span>&nbsp;<span class="op" id="1368505">[</span><span class="op" id="1368506">]</span><span class="builtintype" id="1368507">byte</span>&nbsp;<span class="op" id="1368512">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1368515">m</span>&nbsp;<span class="op" id="1368517">:=</span>&nbsp;<span class="num" id="1368520">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1368523">if</span>&nbsp;<span class="ident" id="1368526">n</span>&nbsp;<span class="op" id="1368528">!=</span>&nbsp;<span class="num" id="1368531">0</span>&nbsp;<span class="op" id="1368533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1368537">//&nbsp;Compute&nbsp;number&nbsp;of&nbsp;replacements.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1368574">m</span>&nbsp;<span class="op" id="1368576">=</span>&nbsp;<span class="ident" id="1368578">Count</span><span class="op" id="1368583">(</span><span class="ident" id="1368584">s</span><span class="op" id="1368585">,</span>&nbsp;<span class="ident" id="1368587">old</span><span class="op" id="1368590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1368593">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1368596">if</span>&nbsp;<span class="ident" id="1368599">m</span>&nbsp;<span class="op" id="1368601">==</span>&nbsp;<span class="num" id="1368604">0</span>&nbsp;<span class="op" id="1368606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1368610">//&nbsp;Just&nbsp;return&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1368635">return</span>&nbsp;<span class="builtinfunc" id="1368642">append</span><span class="op" id="1368648">(</span><span class="op" id="1368649">[</span><span class="op" id="1368650">]</span><span class="builtintype" id="1368651">byte</span><span class="op" id="1368655">(</span><span class="ident" id="1368656">nil</span><span class="op" id="1368659">)</span><span class="op" id="1368660">,</span>&nbsp;<span class="ident" id="1368662">s</span><span class="op" id="1368663">...</span><span class="op" id="1368666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1368669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1368672">if</span>&nbsp;<span class="ident" id="1368675">n</span>&nbsp;<span class="op" id="1368677">&lt;</span>&nbsp;<span class="num" id="1368679">0</span>&nbsp;<span class="op" id="1368681">||</span>&nbsp;<span class="ident" id="1368684">m</span>&nbsp;<span class="op" id="1368686">&lt;</span>&nbsp;<span class="ident" id="1368688">n</span>&nbsp;<span class="op" id="1368690">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1368694">n</span>&nbsp;<span class="op" id="1368696">=</span>&nbsp;<span class="ident" id="1368698">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1368701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1368705">//&nbsp;Apply&nbsp;replacements&nbsp;to&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1368739">t</span>&nbsp;<span class="op" id="1368741">:=</span>&nbsp;<span class="builtinfunc" id="1368744">make</span><span class="op" id="1368748">(</span><span class="op" id="1368749">[</span><span class="op" id="1368750">]</span><span class="builtintype" id="1368751">byte</span><span class="op" id="1368755">,</span>&nbsp;<span class="builtinfunc" id="1368757">len</span><span class="op" id="1368760">(</span><span class="ident" id="1368761">s</span><span class="op" id="1368762">)</span><span class="op" id="1368763">+</span><span class="ident" id="1368764">n</span><span class="op" id="1368765">*</span><span class="op" id="1368766">(</span><span class="builtinfunc" id="1368767">len</span><span class="op" id="1368770">(</span><span class="builtinfunc" id="1368771">new</span><span class="op" id="1368774">)</span><span class="op" id="1368775">-</span><span class="builtinfunc" id="1368776">len</span><span class="op" id="1368779">(</span><span class="ident" id="1368780">old</span><span class="op" id="1368783">)</span><span class="op" id="1368784">)</span><span class="op" id="1368785">)</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1368788">w</span>&nbsp;<span class="op" id="1368790">:=</span>&nbsp;<span class="num" id="1368793">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1368796">start</span>&nbsp;<span class="op" id="1368802">:=</span>&nbsp;<span class="num" id="1368805">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1368808">for</span>&nbsp;<span class="ident" id="1368812">i</span>&nbsp;<span class="op" id="1368814">:=</span>&nbsp;<span class="num" id="1368817">0</span><span class="op" id="1368818">;</span>&nbsp;<span class="ident" id="1368820">i</span>&nbsp;<span class="op" id="1368822">&lt;</span>&nbsp;<span class="ident" id="1368824">n</span><span class="op" id="1368825">;</span>&nbsp;<span class="ident" id="1368827">i</span><span class="op" id="1368828">++</span>&nbsp;<span class="op" id="1368831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1368835">j</span>&nbsp;<span class="op" id="1368837">:=</span>&nbsp;<span class="ident" id="1368840">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1368848">if</span>&nbsp;<span class="builtinfunc" id="1368851">len</span><span class="op" id="1368854">(</span><span class="ident" id="1368855">old</span><span class="op" id="1368858">)</span>&nbsp;<span class="op" id="1368860">==</span>&nbsp;<span class="num" id="1368863">0</span>&nbsp;<span class="op" id="1368865">{</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1368870">if</span>&nbsp;<span class="ident" id="1368873">i</span>&nbsp;<span class="op" id="1368875">&gt;</span>&nbsp;<span class="num" id="1368877">0</span>&nbsp;<span class="op" id="1368879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1368885">_</span><span class="op" id="1368886">,</span>&nbsp;<span class="ident" id="1368888">wid</span>&nbsp;<span class="op" id="1368892">:=</span>&nbsp;<span class="ident" id="1368895">utf8</span><span class="op" id="1368899">.</span><span class="ident" id="1368900">DecodeRune</span><span class="op" id="1368910">(</span><span class="ident" id="1368911">s</span><span class="op" id="1368912">[</span><span class="ident" id="1368913">start</span><span class="op" id="1368918">:</span><span class="op" id="1368919">]</span><span class="op" id="1368920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1368926">j</span>&nbsp;<span class="op" id="1368928">+=</span>&nbsp;<span class="ident" id="1368931">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1368938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1368942">}</span>&nbsp;<span class="keyword" id="1368944">else</span>&nbsp;<span class="op" id="1368949">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1368954">j</span>&nbsp;<span class="op" id="1368956">+=</span>&nbsp;<span class="ident" id="1368959">Index</span><span class="op" id="1368964">(</span><span class="ident" id="1368965">s</span><span class="op" id="1368966">[</span><span class="ident" id="1368967">start</span><span class="op" id="1368972">:</span><span class="op" id="1368973">]</span><span class="op" id="1368974">,</span>&nbsp;<span class="ident" id="1368976">old</span><span class="op" id="1368979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1368983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1368987">w</span>&nbsp;<span class="op" id="1368989">+=</span>&nbsp;<span class="builtinfunc" id="1368992">copy</span><span class="op" id="1368996">(</span><span class="ident" id="1368997">t</span><span class="op" id="1368998">[</span><span class="ident" id="1368999">w</span><span class="op" id="1369000">:</span><span class="op" id="1369001">]</span><span class="op" id="1369002">,</span>&nbsp;<span class="ident" id="1369004">s</span><span class="op" id="1369005">[</span><span class="ident" id="1369006">start</span><span class="op" id="1369011">:</span><span class="ident" id="1369012">j</span><span class="op" id="1369013">]</span><span class="op" id="1369014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1369018">w</span>&nbsp;<span class="op" id="1369020">+=</span>&nbsp;<span class="builtinfunc" id="1369023">copy</span><span class="op" id="1369027">(</span><span class="ident" id="1369028">t</span><span class="op" id="1369029">[</span><span class="ident" id="1369030">w</span><span class="op" id="1369031">:</span><span class="op" id="1369032">]</span><span class="op" id="1369033">,</span>&nbsp;<span class="builtinfunc" id="1369035">new</span><span class="op" id="1369038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1369042">start</span>&nbsp;<span class="op" id="1369048">=</span>&nbsp;<span class="ident" id="1369050">j</span>&nbsp;<span class="op" id="1369052">+</span>&nbsp;<span class="builtinfunc" id="1369054">len</span><span class="op" id="1369057">(</span><span class="ident" id="1369058">old</span><span class="op" id="1369061">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1369064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1369067">w</span>&nbsp;<span class="op" id="1369069">+=</span>&nbsp;<span class="builtinfunc" id="1369072">copy</span><span class="op" id="1369076">(</span><span class="ident" id="1369077">t</span><span class="op" id="1369078">[</span><span class="ident" id="1369079">w</span><span class="op" id="1369080">:</span><span class="op" id="1369081">]</span><span class="op" id="1369082">,</span>&nbsp;<span class="ident" id="1369084">s</span><span class="op" id="1369085">[</span><span class="ident" id="1369086">start</span><span class="op" id="1369091">:</span><span class="op" id="1369092">]</span><span class="op" id="1369093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1369096">return</span>&nbsp;<span class="ident" id="1369103">t</span><span class="op" id="1369104">[</span><span class="num" id="1369105">0</span><span class="op" id="1369106">:</span><span class="ident" id="1369107">w</span><span class="op" id="1369108">]</span><br>
<span class="lineno"></span><span class="op" id="1369110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="comment" id="1369113">//&nbsp;EqualFold&nbsp;reports&nbsp;whether&nbsp;s&nbsp;and&nbsp;t,&nbsp;interpreted&nbsp;as&nbsp;UTF-8&nbsp;strings,</span><br>
<span class="lineno"></span><span class="comment" id="1369181">//&nbsp;are&nbsp;equal&nbsp;under&nbsp;Unicode&nbsp;case-folding.</span><br>
<span class="lineno"></span><span class="keyword" id="1369222">func</span>&nbsp;<span class="ident" id="1369227">EqualFold</span><span class="op" id="1369236">(</span><span class="ident" id="1369237">s</span><span class="op" id="1369238">,</span>&nbsp;<span class="ident" id="1369240">t</span>&nbsp;<span class="op" id="1369242">[</span><span class="op" id="1369243">]</span><span class="builtintype" id="1369244">byte</span><span class="op" id="1369248">)</span>&nbsp;<span class="builtintype" id="1369250">bool</span>&nbsp;<span class="op" id="1369255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1369258">for</span>&nbsp;<span class="builtinfunc" id="1369262">len</span><span class="op" id="1369265">(</span><span class="ident" id="1369266">s</span><span class="op" id="1369267">)</span>&nbsp;<span class="op" id="1369269">!=</span>&nbsp;<span class="num" id="1369272">0</span>&nbsp;<span class="op" id="1369274">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="1369277">len</span><span class="op" id="1369280">(</span><span class="ident" id="1369281">t</span><span class="op" id="1369282">)</span>&nbsp;<span class="op" id="1369284">!=</span>&nbsp;<span class="num" id="1369287">0</span>&nbsp;<span class="op" id="1369289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1369293">//&nbsp;Extract&nbsp;first&nbsp;rune&nbsp;from&nbsp;each.</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1369328">var</span>&nbsp;<span class="ident" id="1369332">sr</span><span class="op" id="1369334">,</span>&nbsp;<span class="ident" id="1369336">tr</span>&nbsp;<span class="builtintype" id="1369339">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1369346">if</span>&nbsp;<span class="ident" id="1369349">s</span><span class="op" id="1369350">[</span><span class="num" id="1369351">0</span><span class="op" id="1369352">]</span>&nbsp;<span class="op" id="1369354">&lt;</span>&nbsp;<span class="ident" id="1369356">utf8</span><span class="op" id="1369360">.</span><span class="ident" id="1369361">RuneSelf</span>&nbsp;<span class="op" id="1369370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1369375">sr</span><span class="op" id="1369377">,</span>&nbsp;<span class="ident" id="1369379">s</span>&nbsp;<span class="op" id="1369381">=</span>&nbsp;<span class="builtintype" id="1369383">rune</span><span class="op" id="1369387">(</span><span class="ident" id="1369388">s</span><span class="op" id="1369389">[</span><span class="num" id="1369390">0</span><span class="op" id="1369391">]</span><span class="op" id="1369392">)</span><span class="op" id="1369393">,</span>&nbsp;<span class="ident" id="1369395">s</span><span class="op" id="1369396">[</span><span class="num" id="1369397">1</span><span class="op" id="1369398">:</span><span class="op" id="1369399">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1369403">}</span>&nbsp;<span class="keyword" id="1369405">else</span>&nbsp;<span class="op" id="1369410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1369415">r</span><span class="op" id="1369416">,</span>&nbsp;<span class="ident" id="1369418">size</span>&nbsp;<span class="op" id="1369423">:=</span>&nbsp;<span class="ident" id="1369426">utf8</span><span class="op" id="1369430">.</span><span class="ident" id="1369431">DecodeRune</span><span class="op" id="1369441">(</span><span class="ident" id="1369442">s</span><span class="op" id="1369443">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1369448">sr</span><span class="op" id="1369450">,</span>&nbsp;<span class="ident" id="1369452">s</span>&nbsp;<span class="op" id="1369454">=</span>&nbsp;<span class="ident" id="1369456">r</span><span class="op" id="1369457">,</span>&nbsp;<span class="ident" id="1369459">s</span><span class="op" id="1369460">[</span><span class="ident" id="1369461">size</span><span class="op" id="1369465">:</span><span class="op" id="1369466">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1369470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1369474">if</span>&nbsp;<span class="ident" id="1369477">t</span><span class="op" id="1369478">[</span><span class="num" id="1369479">0</span><span class="op" id="1369480">]</span>&nbsp;<span class="op" id="1369482">&lt;</span>&nbsp;<span class="ident" id="1369484">utf8</span><span class="op" id="1369488">.</span><span class="ident" id="1369489">RuneSelf</span>&nbsp;<span class="op" id="1369498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1369503">tr</span><span class="op" id="1369505">,</span>&nbsp;<span class="ident" id="1369507">t</span>&nbsp;<span class="op" id="1369509">=</span>&nbsp;<span class="builtintype" id="1369511">rune</span><span class="op" id="1369515">(</span><span class="ident" id="1369516">t</span><span class="op" id="1369517">[</span><span class="num" id="1369518">0</span><span class="op" id="1369519">]</span><span class="op" id="1369520">)</span><span class="op" id="1369521">,</span>&nbsp;<span class="ident" id="1369523">t</span><span class="op" id="1369524">[</span><span class="num" id="1369525">1</span><span class="op" id="1369526">:</span><span class="op" id="1369527">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1369531">}</span>&nbsp;<span class="keyword" id="1369533">else</span>&nbsp;<span class="op" id="1369538">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1369543">r</span><span class="op" id="1369544">,</span>&nbsp;<span class="ident" id="1369546">size</span>&nbsp;<span class="op" id="1369551">:=</span>&nbsp;<span class="ident" id="1369554">utf8</span><span class="op" id="1369558">.</span><span class="ident" id="1369559">DecodeRune</span><span class="op" id="1369569">(</span><span class="ident" id="1369570">t</span><span class="op" id="1369571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1369576">tr</span><span class="op" id="1369578">,</span>&nbsp;<span class="ident" id="1369580">t</span>&nbsp;<span class="op" id="1369582">=</span>&nbsp;<span class="ident" id="1369584">r</span><span class="op" id="1369585">,</span>&nbsp;<span class="ident" id="1369587">t</span><span class="op" id="1369588">[</span><span class="ident" id="1369589">size</span><span class="op" id="1369593">:</span><span class="op" id="1369594">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1369598">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1369603">//&nbsp;If&nbsp;they&nbsp;match,&nbsp;keep&nbsp;going;&nbsp;if&nbsp;not,&nbsp;return&nbsp;false.</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1369658">//&nbsp;Easy&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1369674">if</span>&nbsp;<span class="ident" id="1369677">tr</span>&nbsp;<span class="op" id="1369680">==</span>&nbsp;<span class="ident" id="1369683">sr</span>&nbsp;<span class="op" id="1369686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1369691">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1369702">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1369707">//&nbsp;Make&nbsp;sr&nbsp;&lt;&nbsp;tr&nbsp;to&nbsp;simplify&nbsp;what&nbsp;follows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1369751">if</span>&nbsp;<span class="ident" id="1369754">tr</span>&nbsp;<span class="op" id="1369757">&lt;</span>&nbsp;<span class="ident" id="1369759">sr</span>&nbsp;<span class="op" id="1369762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1369767">tr</span><span class="op" id="1369769">,</span>&nbsp;<span class="ident" id="1369771">sr</span>&nbsp;<span class="op" id="1369774">=</span>&nbsp;<span class="ident" id="1369776">sr</span><span class="op" id="1369778">,</span>&nbsp;<span class="ident" id="1369780">tr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1369785">}</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1369789">//&nbsp;Fast&nbsp;check&nbsp;for&nbsp;ASCII.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1369816">if</span>&nbsp;<span class="ident" id="1369819">tr</span>&nbsp;<span class="op" id="1369822">&lt;</span>&nbsp;<span class="ident" id="1369824">utf8</span><span class="op" id="1369828">.</span><span class="ident" id="1369829">RuneSelf</span>&nbsp;<span class="op" id="1369838">&amp;&amp;</span>&nbsp;<span class="string" id="1369841">&#39;A&#39;</span>&nbsp;<span class="op" id="1369845">&lt;=</span>&nbsp;<span class="ident" id="1369848">sr</span>&nbsp;<span class="op" id="1369851">&amp;&amp;</span>&nbsp;<span class="ident" id="1369854">sr</span>&nbsp;<span class="op" id="1369857">&lt;=</span>&nbsp;<span class="string" id="1369860">&#39;Z&#39;</span>&nbsp;<span class="op" id="1369864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1369869">//&nbsp;ASCII,&nbsp;and&nbsp;sr&nbsp;is&nbsp;upper&nbsp;case.&nbsp;&nbsp;tr&nbsp;must&nbsp;be&nbsp;lower&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1369928">if</span>&nbsp;<span class="ident" id="1369931">tr</span>&nbsp;<span class="op" id="1369934">==</span>&nbsp;<span class="ident" id="1369937">sr</span><span class="op" id="1369939">+</span><span class="string" id="1369940">&#39;a&#39;</span><span class="op" id="1369943">-</span><span class="string" id="1369944">&#39;A&#39;</span>&nbsp;<span class="op" id="1369948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1369954">continue</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1369966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1369971">return</span>&nbsp;<span class="builtintype" id="1369978">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1369986">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1369991">//&nbsp;General&nbsp;case.&nbsp;&nbsp;SimpleFold(x)&nbsp;returns&nbsp;the&nbsp;next&nbsp;equivalent&nbsp;rune&nbsp;&gt;&nbsp;x</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1370062">//&nbsp;or&nbsp;wraps&nbsp;around&nbsp;to&nbsp;smaller&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1370102">r</span>&nbsp;<span class="op" id="1370104">:=</span>&nbsp;<span class="ident" id="1370107">unicode</span><span class="op" id="1370114">.</span><span class="ident" id="1370115">SimpleFold</span><span class="op" id="1370125">(</span><span class="ident" id="1370126">sr</span><span class="op" id="1370128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1370132">for</span>&nbsp;<span class="ident" id="1370136">r</span>&nbsp;<span class="op" id="1370138">!=</span>&nbsp;<span class="ident" id="1370141">sr</span>&nbsp;<span class="op" id="1370144">&amp;&amp;</span>&nbsp;<span class="ident" id="1370147">r</span>&nbsp;<span class="op" id="1370149">&lt;</span>&nbsp;<span class="ident" id="1370151">tr</span>&nbsp;<span class="op" id="1370154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1370159">r</span>&nbsp;<span class="op" id="1370161">=</span>&nbsp;<span class="ident" id="1370163">unicode</span><span class="op" id="1370170">.</span><span class="ident" id="1370171">SimpleFold</span><span class="op" id="1370181">(</span><span class="ident" id="1370182">r</span><span class="op" id="1370183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1370187">}</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1370191">if</span>&nbsp;<span class="ident" id="1370194">r</span>&nbsp;<span class="op" id="1370196">==</span>&nbsp;<span class="ident" id="1370199">tr</span>&nbsp;<span class="op" id="1370202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1370207">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1370218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1370222">return</span>&nbsp;<span class="builtintype" id="1370229">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1370236">}</span><br>
<span class="lineno">700</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1370240">//&nbsp;One&nbsp;string&nbsp;is&nbsp;empty.&nbsp;&nbsp;Are&nbsp;both?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1370276">return</span>&nbsp;<span class="builtinfunc" id="1370283">len</span><span class="op" id="1370286">(</span><span class="ident" id="1370287">s</span><span class="op" id="1370288">)</span>&nbsp;<span class="op" id="1370290">==</span>&nbsp;<span class="builtinfunc" id="1370293">len</span><span class="op" id="1370296">(</span><span class="ident" id="1370297">t</span><span class="op" id="1370298">)</span><br>
<span class="lineno"></span><span class="op" id="1370300">}</span>
</div>
</body>
</html>
