<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>fmt</h2>
<ul>
<li><a href="/gostd/fmt/doc.go.html">doc.go</a></li>
<li><a href="/gostd/fmt/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/fmt/fmt_test.go.html">fmt_test.go</a></li>
<li><a href="/gostd/fmt/format.go.html">format.go</a></li>
<li><a href="/gostd/fmt/print.go.html">print.go</a></li>
<li><a href="/gostd/fmt/scan.go.html">scan.go</a></li>
<li><a href="/gostd/fmt/scan_test.go.html">scan_test.go</a></li>
<li><a href="/gostd/fmt/stringer_test.go.html">stringer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2275497">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2275552">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2275606">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2275657">package</span>&nbsp;<span class="ident" id="2275665">fmt</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2275670">import</span>&nbsp;<span class="op" id="2275677">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2275680">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2275690">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2275696">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2275704">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2275710">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2275721">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2275732">&#34;sync&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2275740">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2275755">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2275758">//&nbsp;runeUnreader&nbsp;is&nbsp;the&nbsp;interface&nbsp;to&nbsp;something&nbsp;that&nbsp;can&nbsp;unread&nbsp;runes.</span><br>
<span class="lineno"></span><span class="comment" id="2275827">//&nbsp;If&nbsp;the&nbsp;object&nbsp;provided&nbsp;to&nbsp;Scan&nbsp;does&nbsp;not&nbsp;satisfy&nbsp;this&nbsp;interface,</span><br>
<span class="lineno">20</span><span class="comment" id="2275894">//&nbsp;a&nbsp;local&nbsp;buffer&nbsp;will&nbsp;be&nbsp;used&nbsp;to&nbsp;back&nbsp;up&nbsp;the&nbsp;input,&nbsp;but&nbsp;its&nbsp;contents</span><br>
<span class="lineno"></span><span class="comment" id="2275964">//&nbsp;will&nbsp;be&nbsp;lost&nbsp;when&nbsp;Scan&nbsp;returns.</span><br>
<span class="lineno"></span><span class="keyword" id="2275999">type</span>&nbsp;<span class="ident" id="2276004">runeUnreader</span>&nbsp;<span class="keyword" id="2276017">interface</span>&nbsp;<span class="op" id="2276027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2276030">UnreadRune</span><span class="op" id="2276040">(</span><span class="op" id="2276041">)</span>&nbsp;<span class="builtintype" id="2276043">error</span><br>
<span class="lineno"></span><span class="op" id="2276049">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="2276052">//&nbsp;ScanState&nbsp;represents&nbsp;the&nbsp;scanner&nbsp;state&nbsp;passed&nbsp;to&nbsp;custom&nbsp;scanners.</span><br>
<span class="lineno"></span><span class="comment" id="2276121">//&nbsp;Scanners&nbsp;may&nbsp;do&nbsp;rune-at-a-time&nbsp;scanning&nbsp;or&nbsp;ask&nbsp;the&nbsp;ScanState</span><br>
<span class="lineno"></span><span class="comment" id="2276185">//&nbsp;to&nbsp;discover&nbsp;the&nbsp;next&nbsp;space-delimited&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="2276232">type</span>&nbsp;<span class="ident" id="2276237">ScanState</span>&nbsp;<span class="keyword" id="2276247">interface</span>&nbsp;<span class="op" id="2276257">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2276260">//&nbsp;ReadRune&nbsp;reads&nbsp;the&nbsp;next&nbsp;rune&nbsp;(Unicode&nbsp;code&nbsp;point)&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2276330">//&nbsp;If&nbsp;invoked&nbsp;during&nbsp;Scanln,&nbsp;Fscanln,&nbsp;or&nbsp;Sscanln,&nbsp;ReadRune()&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2276397">//&nbsp;return&nbsp;EOF&nbsp;after&nbsp;returning&nbsp;the&nbsp;first&nbsp;&#39;\n&#39;&nbsp;or&nbsp;when&nbsp;reading&nbsp;beyond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2276466">//&nbsp;the&nbsp;specified&nbsp;width.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2276491">ReadRune</span><span class="op" id="2276499">(</span><span class="op" id="2276500">)</span>&nbsp;<span class="op" id="2276502">(</span><span class="ident" id="2276503">r</span>&nbsp;<span class="builtintype" id="2276505">rune</span><span class="op" id="2276509">,</span>&nbsp;<span class="ident" id="2276511">size</span>&nbsp;<span class="builtintype" id="2276516">int</span><span class="op" id="2276519">,</span>&nbsp;<span class="ident" id="2276521">err</span>&nbsp;<span class="builtintype" id="2276525">error</span><span class="op" id="2276530">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2276533">//&nbsp;UnreadRune&nbsp;causes&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;ReadRune&nbsp;to&nbsp;return&nbsp;the&nbsp;same&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2276606">UnreadRune</span><span class="op" id="2276616">(</span><span class="op" id="2276617">)</span>&nbsp;<span class="builtintype" id="2276619">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2276626">//&nbsp;SkipSpace&nbsp;skips&nbsp;space&nbsp;in&nbsp;the&nbsp;input.&nbsp;Newlines&nbsp;are&nbsp;treated&nbsp;as&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2276696">//&nbsp;unless&nbsp;the&nbsp;scan&nbsp;operation&nbsp;is&nbsp;Scanln,&nbsp;Fscanln&nbsp;or&nbsp;Sscanln,&nbsp;in&nbsp;which&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2276771">//&nbsp;a&nbsp;newline&nbsp;is&nbsp;treated&nbsp;as&nbsp;EOF.</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2276804">SkipSpace</span><span class="op" id="2276813">(</span><span class="op" id="2276814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2276817">//&nbsp;Token&nbsp;skips&nbsp;space&nbsp;in&nbsp;the&nbsp;input&nbsp;if&nbsp;skipSpace&nbsp;is&nbsp;true,&nbsp;then&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2276891">//&nbsp;run&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;satisfying&nbsp;f(c).&nbsp;&nbsp;If&nbsp;f&nbsp;is&nbsp;nil,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2276955">//&nbsp;!unicode.IsSpace(c)&nbsp;is&nbsp;used;&nbsp;that&nbsp;is,&nbsp;the&nbsp;token&nbsp;will&nbsp;hold&nbsp;non-space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2277027">//&nbsp;characters.&nbsp;&nbsp;Newlines&nbsp;are&nbsp;treated&nbsp;as&nbsp;space&nbsp;unless&nbsp;the&nbsp;scan&nbsp;operation</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2277100">//&nbsp;is&nbsp;Scanln,&nbsp;Fscanln&nbsp;or&nbsp;Sscanln,&nbsp;in&nbsp;which&nbsp;case&nbsp;a&nbsp;newline&nbsp;is&nbsp;treated&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2277173">//&nbsp;EOF.&nbsp;&nbsp;The&nbsp;returned&nbsp;slice&nbsp;points&nbsp;to&nbsp;shared&nbsp;data&nbsp;that&nbsp;may&nbsp;be&nbsp;overwritten</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2277248">//&nbsp;by&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;Token,&nbsp;a&nbsp;call&nbsp;to&nbsp;a&nbsp;Scan&nbsp;function&nbsp;using&nbsp;the&nbsp;ScanState</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2277325">//&nbsp;as&nbsp;input,&nbsp;or&nbsp;when&nbsp;the&nbsp;calling&nbsp;Scan&nbsp;method&nbsp;returns.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2277380">Token</span><span class="op" id="2277385">(</span><span class="ident" id="2277386">skipSpace</span>&nbsp;<span class="builtintype" id="2277396">bool</span><span class="op" id="2277400">,</span>&nbsp;<span class="ident" id="2277402">f</span>&nbsp;<span class="keyword" id="2277404">func</span><span class="op" id="2277408">(</span><span class="builtintype" id="2277409">rune</span><span class="op" id="2277413">)</span>&nbsp;<span class="builtintype" id="2277415">bool</span><span class="op" id="2277419">)</span>&nbsp;<span class="op" id="2277421">(</span><span class="ident" id="2277422">token</span>&nbsp;<span class="op" id="2277428">[</span><span class="op" id="2277429">]</span><span class="builtintype" id="2277430">byte</span><span class="op" id="2277434">,</span>&nbsp;<span class="ident" id="2277436">err</span>&nbsp;<span class="builtintype" id="2277440">error</span><span class="op" id="2277445">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2277448">//&nbsp;Width&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;width&nbsp;option&nbsp;and&nbsp;whether&nbsp;it&nbsp;has&nbsp;been&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2277525">//&nbsp;The&nbsp;unit&nbsp;is&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2277562">Width</span><span class="op" id="2277567">(</span><span class="op" id="2277568">)</span>&nbsp;<span class="op" id="2277570">(</span><span class="ident" id="2277571">wid</span>&nbsp;<span class="builtintype" id="2277575">int</span><span class="op" id="2277578">,</span>&nbsp;<span class="ident" id="2277580">ok</span>&nbsp;<span class="builtintype" id="2277583">bool</span><span class="op" id="2277587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2277590">//&nbsp;Because&nbsp;ReadRune&nbsp;is&nbsp;implemented&nbsp;by&nbsp;the&nbsp;interface,&nbsp;Read&nbsp;should&nbsp;never&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2277665">//&nbsp;called&nbsp;by&nbsp;the&nbsp;scanning&nbsp;routines&nbsp;and&nbsp;a&nbsp;valid&nbsp;implementation&nbsp;of</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2277731">//&nbsp;ScanState&nbsp;may&nbsp;choose&nbsp;always&nbsp;to&nbsp;return&nbsp;an&nbsp;error&nbsp;from&nbsp;Read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2277793">Read</span><span class="op" id="2277797">(</span><span class="ident" id="2277798">buf</span>&nbsp;<span class="op" id="2277802">[</span><span class="op" id="2277803">]</span><span class="builtintype" id="2277804">byte</span><span class="op" id="2277808">)</span>&nbsp;<span class="op" id="2277810">(</span><span class="ident" id="2277811">n</span>&nbsp;<span class="builtintype" id="2277813">int</span><span class="op" id="2277816">,</span>&nbsp;<span class="ident" id="2277818">err</span>&nbsp;<span class="builtintype" id="2277822">error</span><span class="op" id="2277827">)</span><br>
<span class="lineno"></span><span class="op" id="2277829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2277832">//&nbsp;Scanner&nbsp;is&nbsp;implemented&nbsp;by&nbsp;any&nbsp;value&nbsp;that&nbsp;has&nbsp;a&nbsp;Scan&nbsp;method,&nbsp;which&nbsp;scans</span><br>
<span class="lineno">60</span><span class="comment" id="2277907">//&nbsp;the&nbsp;input&nbsp;for&nbsp;the&nbsp;representation&nbsp;of&nbsp;a&nbsp;value&nbsp;and&nbsp;stores&nbsp;the&nbsp;result&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2277983">//&nbsp;receiver,&nbsp;which&nbsp;must&nbsp;be&nbsp;a&nbsp;pointer&nbsp;to&nbsp;be&nbsp;useful.&nbsp;&nbsp;The&nbsp;Scan&nbsp;method&nbsp;is&nbsp;called</span><br>
<span class="lineno"></span><span class="comment" id="2278061">//&nbsp;for&nbsp;any&nbsp;argument&nbsp;to&nbsp;Scan,&nbsp;Scanf,&nbsp;or&nbsp;Scanln&nbsp;that&nbsp;implements&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="2278127">type</span>&nbsp;<span class="ident" id="2278132">Scanner</span>&nbsp;<span class="keyword" id="2278140">interface</span>&nbsp;<span class="op" id="2278150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2278153">Scan</span><span class="op" id="2278157">(</span><span class="ident" id="2278158">state</span>&nbsp;<span class="ident" id="2278164">ScanState</span><span class="op" id="2278173">,</span>&nbsp;<span class="ident" id="2278175">verb</span>&nbsp;<span class="builtintype" id="2278180">rune</span><span class="op" id="2278184">)</span>&nbsp;<span class="builtintype" id="2278186">error</span><br>
<span class="lineno">65</span><span class="op" id="2278192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2278195">//&nbsp;Scan&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;standard&nbsp;input,&nbsp;storing&nbsp;successive</span><br>
<span class="lineno"></span><span class="comment" id="2278259">//&nbsp;space-separated&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments.&nbsp;&nbsp;Newlines&nbsp;count</span><br>
<span class="lineno"></span><span class="comment" id="2278328">//&nbsp;as&nbsp;space.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.</span><br>
<span class="lineno">70</span><span class="comment" id="2278395">//&nbsp;If&nbsp;that&nbsp;is&nbsp;less&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;arguments,&nbsp;err&nbsp;will&nbsp;report&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="2278465">func</span>&nbsp;<span class="ident" id="2278470">Scan</span><span class="op" id="2278474">(</span><span class="ident" id="2278475">a</span>&nbsp;<span class="op" id="2278477">...</span><span class="keyword" id="2278480">interface</span><span class="op" id="2278489">{</span><span class="op" id="2278490">}</span><span class="op" id="2278491">)</span>&nbsp;<span class="op" id="2278493">(</span><span class="ident" id="2278494">n</span>&nbsp;<span class="builtintype" id="2278496">int</span><span class="op" id="2278499">,</span>&nbsp;<span class="ident" id="2278501">err</span>&nbsp;<span class="builtintype" id="2278505">error</span><span class="op" id="2278510">)</span>&nbsp;<span class="op" id="2278512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2278515">return</span>&nbsp;<span class="ident" id="2278522">Fscan</span><span class="op" id="2278527">(</span><span class="ident" id="2278528">os</span><span class="op" id="2278530">.</span><span class="ident" id="2278531">Stdin</span><span class="op" id="2278536">,</span>&nbsp;<span class="ident" id="2278538">a</span><span class="op" id="2278539">...</span><span class="op" id="2278542">)</span><br>
<span class="lineno"></span><span class="op" id="2278544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="2278547">//&nbsp;Scanln&nbsp;is&nbsp;similar&nbsp;to&nbsp;Scan,&nbsp;but&nbsp;stops&nbsp;scanning&nbsp;at&nbsp;a&nbsp;newline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2278613">//&nbsp;after&nbsp;the&nbsp;final&nbsp;item&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;newline&nbsp;or&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="2278669">func</span>&nbsp;<span class="ident" id="2278674">Scanln</span><span class="op" id="2278680">(</span><span class="ident" id="2278681">a</span>&nbsp;<span class="op" id="2278683">...</span><span class="keyword" id="2278686">interface</span><span class="op" id="2278695">{</span><span class="op" id="2278696">}</span><span class="op" id="2278697">)</span>&nbsp;<span class="op" id="2278699">(</span><span class="ident" id="2278700">n</span>&nbsp;<span class="builtintype" id="2278702">int</span><span class="op" id="2278705">,</span>&nbsp;<span class="ident" id="2278707">err</span>&nbsp;<span class="builtintype" id="2278711">error</span><span class="op" id="2278716">)</span>&nbsp;<span class="op" id="2278718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2278721">return</span>&nbsp;<span class="ident" id="2278728">Fscanln</span><span class="op" id="2278735">(</span><span class="ident" id="2278736">os</span><span class="op" id="2278738">.</span><span class="ident" id="2278739">Stdin</span><span class="op" id="2278744">,</span>&nbsp;<span class="ident" id="2278746">a</span><span class="op" id="2278747">...</span><span class="op" id="2278750">)</span><br>
<span class="lineno"></span><span class="op" id="2278752">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="2278755">//&nbsp;Scanf&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;standard&nbsp;input,&nbsp;storing&nbsp;successive</span><br>
<span class="lineno"></span><span class="comment" id="2278820">//&nbsp;space-separated&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments&nbsp;as&nbsp;determined&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2278889">//&nbsp;the&nbsp;format.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.</span><br>
<span class="lineno"></span><span class="keyword" id="2278958">func</span>&nbsp;<span class="ident" id="2278963">Scanf</span><span class="op" id="2278968">(</span><span class="ident" id="2278969">format</span>&nbsp;<span class="builtintype" id="2278976">string</span><span class="op" id="2278982">,</span>&nbsp;<span class="ident" id="2278984">a</span>&nbsp;<span class="op" id="2278986">...</span><span class="keyword" id="2278989">interface</span><span class="op" id="2278998">{</span><span class="op" id="2278999">}</span><span class="op" id="2279000">)</span>&nbsp;<span class="op" id="2279002">(</span><span class="ident" id="2279003">n</span>&nbsp;<span class="builtintype" id="2279005">int</span><span class="op" id="2279008">,</span>&nbsp;<span class="ident" id="2279010">err</span>&nbsp;<span class="builtintype" id="2279014">error</span><span class="op" id="2279019">)</span>&nbsp;<span class="op" id="2279021">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2279024">return</span>&nbsp;<span class="ident" id="2279031">Fscanf</span><span class="op" id="2279037">(</span><span class="ident" id="2279038">os</span><span class="op" id="2279040">.</span><span class="ident" id="2279041">Stdin</span><span class="op" id="2279046">,</span>&nbsp;<span class="ident" id="2279048">format</span><span class="op" id="2279054">,</span>&nbsp;<span class="ident" id="2279056">a</span><span class="op" id="2279057">...</span><span class="op" id="2279060">)</span><br>
<span class="lineno"></span><span class="op" id="2279062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2279065">type</span>&nbsp;<span class="ident" id="2279070">stringReader</span>&nbsp;<span class="builtintype" id="2279083">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="2279091">func</span>&nbsp;<span class="op" id="2279096">(</span><span class="ident" id="2279097">r</span>&nbsp;<span class="op" id="2279099">*</span><span class="ident" id="2279100">stringReader</span><span class="op" id="2279112">)</span>&nbsp;<span class="ident" id="2279114">Read</span><span class="op" id="2279118">(</span><span class="ident" id="2279119">b</span>&nbsp;<span class="op" id="2279121">[</span><span class="op" id="2279122">]</span><span class="builtintype" id="2279123">byte</span><span class="op" id="2279127">)</span>&nbsp;<span class="op" id="2279129">(</span><span class="ident" id="2279130">n</span>&nbsp;<span class="builtintype" id="2279132">int</span><span class="op" id="2279135">,</span>&nbsp;<span class="ident" id="2279137">err</span>&nbsp;<span class="builtintype" id="2279141">error</span><span class="op" id="2279146">)</span>&nbsp;<span class="op" id="2279148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2279151">n</span>&nbsp;<span class="op" id="2279153">=</span>&nbsp;<span class="builtinfunc" id="2279155">copy</span><span class="op" id="2279159">(</span><span class="ident" id="2279160">b</span><span class="op" id="2279161">,</span>&nbsp;<span class="op" id="2279163">*</span><span class="ident" id="2279164">r</span><span class="op" id="2279165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2279168">*</span><span class="ident" id="2279169">r</span>&nbsp;<span class="op" id="2279171">=</span>&nbsp;<span class="op" id="2279173">(</span><span class="op" id="2279174">*</span><span class="ident" id="2279175">r</span><span class="op" id="2279176">)</span><span class="op" id="2279177">[</span><span class="ident" id="2279178">n</span><span class="op" id="2279179">:</span><span class="op" id="2279180">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2279183">if</span>&nbsp;<span class="ident" id="2279186">n</span>&nbsp;<span class="op" id="2279188">==</span>&nbsp;<span class="num" id="2279191">0</span>&nbsp;<span class="op" id="2279193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2279197">err</span>&nbsp;<span class="op" id="2279201">=</span>&nbsp;<span class="ident" id="2279203">io</span><span class="op" id="2279205">.</span><span class="ident" id="2279206">EOF</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2279211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2279214">return</span><br>
<span class="lineno"></span><span class="op" id="2279221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2279224">//&nbsp;Sscan&nbsp;scans&nbsp;the&nbsp;argument&nbsp;string,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno">100</span><span class="comment" id="2279295">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments.&nbsp;&nbsp;Newlines&nbsp;count&nbsp;as&nbsp;space.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2279362">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.&nbsp;&nbsp;If&nbsp;that&nbsp;is&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="2279432">//&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;arguments,&nbsp;err&nbsp;will&nbsp;report&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="2279486">func</span>&nbsp;<span class="ident" id="2279491">Sscan</span><span class="op" id="2279496">(</span><span class="ident" id="2279497">str</span>&nbsp;<span class="builtintype" id="2279501">string</span><span class="op" id="2279507">,</span>&nbsp;<span class="ident" id="2279509">a</span>&nbsp;<span class="op" id="2279511">...</span><span class="keyword" id="2279514">interface</span><span class="op" id="2279523">{</span><span class="op" id="2279524">}</span><span class="op" id="2279525">)</span>&nbsp;<span class="op" id="2279527">(</span><span class="ident" id="2279528">n</span>&nbsp;<span class="builtintype" id="2279530">int</span><span class="op" id="2279533">,</span>&nbsp;<span class="ident" id="2279535">err</span>&nbsp;<span class="builtintype" id="2279539">error</span><span class="op" id="2279544">)</span>&nbsp;<span class="op" id="2279546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2279549">return</span>&nbsp;<span class="ident" id="2279556">Fscan</span><span class="op" id="2279561">(</span><span class="op" id="2279562">(</span><span class="op" id="2279563">*</span><span class="ident" id="2279564">stringReader</span><span class="op" id="2279576">)</span><span class="op" id="2279577">(</span><span class="op" id="2279578">&amp;</span><span class="ident" id="2279579">str</span><span class="op" id="2279582">)</span><span class="op" id="2279583">,</span>&nbsp;<span class="ident" id="2279585">a</span><span class="op" id="2279586">...</span><span class="op" id="2279589">)</span><br>
<span class="lineno">105</span><span class="op" id="2279591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2279594">//&nbsp;Sscanln&nbsp;is&nbsp;similar&nbsp;to&nbsp;Sscan,&nbsp;but&nbsp;stops&nbsp;scanning&nbsp;at&nbsp;a&nbsp;newline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2279662">//&nbsp;after&nbsp;the&nbsp;final&nbsp;item&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;newline&nbsp;or&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="2279718">func</span>&nbsp;<span class="ident" id="2279723">Sscanln</span><span class="op" id="2279730">(</span><span class="ident" id="2279731">str</span>&nbsp;<span class="builtintype" id="2279735">string</span><span class="op" id="2279741">,</span>&nbsp;<span class="ident" id="2279743">a</span>&nbsp;<span class="op" id="2279745">...</span><span class="keyword" id="2279748">interface</span><span class="op" id="2279757">{</span><span class="op" id="2279758">}</span><span class="op" id="2279759">)</span>&nbsp;<span class="op" id="2279761">(</span><span class="ident" id="2279762">n</span>&nbsp;<span class="builtintype" id="2279764">int</span><span class="op" id="2279767">,</span>&nbsp;<span class="ident" id="2279769">err</span>&nbsp;<span class="builtintype" id="2279773">error</span><span class="op" id="2279778">)</span>&nbsp;<span class="op" id="2279780">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2279783">return</span>&nbsp;<span class="ident" id="2279790">Fscanln</span><span class="op" id="2279797">(</span><span class="op" id="2279798">(</span><span class="op" id="2279799">*</span><span class="ident" id="2279800">stringReader</span><span class="op" id="2279812">)</span><span class="op" id="2279813">(</span><span class="op" id="2279814">&amp;</span><span class="ident" id="2279815">str</span><span class="op" id="2279818">)</span><span class="op" id="2279819">,</span>&nbsp;<span class="ident" id="2279821">a</span><span class="op" id="2279822">...</span><span class="op" id="2279825">)</span><br>
<span class="lineno"></span><span class="op" id="2279827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2279830">//&nbsp;Sscanf&nbsp;scans&nbsp;the&nbsp;argument&nbsp;string,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno"></span><span class="comment" id="2279902">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments&nbsp;as&nbsp;determined&nbsp;by&nbsp;the&nbsp;format.&nbsp;&nbsp;It</span><br>
<span class="lineno">115</span><span class="comment" id="2279971">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="2280023">func</span>&nbsp;<span class="ident" id="2280028">Sscanf</span><span class="op" id="2280034">(</span><span class="ident" id="2280035">str</span>&nbsp;<span class="builtintype" id="2280039">string</span><span class="op" id="2280045">,</span>&nbsp;<span class="ident" id="2280047">format</span>&nbsp;<span class="builtintype" id="2280054">string</span><span class="op" id="2280060">,</span>&nbsp;<span class="ident" id="2280062">a</span>&nbsp;<span class="op" id="2280064">...</span><span class="keyword" id="2280067">interface</span><span class="op" id="2280076">{</span><span class="op" id="2280077">}</span><span class="op" id="2280078">)</span>&nbsp;<span class="op" id="2280080">(</span><span class="ident" id="2280081">n</span>&nbsp;<span class="builtintype" id="2280083">int</span><span class="op" id="2280086">,</span>&nbsp;<span class="ident" id="2280088">err</span>&nbsp;<span class="builtintype" id="2280092">error</span><span class="op" id="2280097">)</span>&nbsp;<span class="op" id="2280099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2280102">return</span>&nbsp;<span class="ident" id="2280109">Fscanf</span><span class="op" id="2280115">(</span><span class="op" id="2280116">(</span><span class="op" id="2280117">*</span><span class="ident" id="2280118">stringReader</span><span class="op" id="2280130">)</span><span class="op" id="2280131">(</span><span class="op" id="2280132">&amp;</span><span class="ident" id="2280133">str</span><span class="op" id="2280136">)</span><span class="op" id="2280137">,</span>&nbsp;<span class="ident" id="2280139">format</span><span class="op" id="2280145">,</span>&nbsp;<span class="ident" id="2280147">a</span><span class="op" id="2280148">...</span><span class="op" id="2280151">)</span><br>
<span class="lineno"></span><span class="op" id="2280153">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="2280156">//&nbsp;Fscan&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;r,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno"></span><span class="comment" id="2280224">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments.&nbsp;&nbsp;Newlines&nbsp;count&nbsp;as&nbsp;space.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2280291">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;scanned.&nbsp;&nbsp;If&nbsp;that&nbsp;is&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="2280361">//&nbsp;than&nbsp;the&nbsp;number&nbsp;of&nbsp;arguments,&nbsp;err&nbsp;will&nbsp;report&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="2280415">func</span>&nbsp;<span class="ident" id="2280420">Fscan</span><span class="op" id="2280425">(</span><span class="ident" id="2280426">r</span>&nbsp;<span class="ident" id="2280428">io</span><span class="op" id="2280430">.</span><span class="ident" id="2280431">Reader</span><span class="op" id="2280437">,</span>&nbsp;<span class="ident" id="2280439">a</span>&nbsp;<span class="op" id="2280441">...</span><span class="keyword" id="2280444">interface</span><span class="op" id="2280453">{</span><span class="op" id="2280454">}</span><span class="op" id="2280455">)</span>&nbsp;<span class="op" id="2280457">(</span><span class="ident" id="2280458">n</span>&nbsp;<span class="builtintype" id="2280460">int</span><span class="op" id="2280463">,</span>&nbsp;<span class="ident" id="2280465">err</span>&nbsp;<span class="builtintype" id="2280469">error</span><span class="op" id="2280474">)</span>&nbsp;<span class="op" id="2280476">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2280479">s</span><span class="op" id="2280480">,</span>&nbsp;<span class="ident" id="2280482">old</span>&nbsp;<span class="op" id="2280486">:=</span>&nbsp;<span class="ident" id="2280489">newScanState</span><span class="op" id="2280501">(</span><span class="ident" id="2280502">r</span><span class="op" id="2280503">,</span>&nbsp;<span class="builtintype" id="2280505">true</span><span class="op" id="2280509">,</span>&nbsp;<span class="builtintype" id="2280511">false</span><span class="op" id="2280516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2280519">n</span><span class="op" id="2280520">,</span>&nbsp;<span class="ident" id="2280522">err</span>&nbsp;<span class="op" id="2280526">=</span>&nbsp;<span class="ident" id="2280528">s</span><span class="op" id="2280529">.</span><span class="ident" id="2280530">doScan</span><span class="op" id="2280536">(</span><span class="ident" id="2280537">a</span><span class="op" id="2280538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2280541">s</span><span class="op" id="2280542">.</span><span class="ident" id="2280543">free</span><span class="op" id="2280547">(</span><span class="ident" id="2280548">old</span><span class="op" id="2280551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2280554">return</span><br>
<span class="lineno"></span><span class="op" id="2280561">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="2280564">//&nbsp;Fscanln&nbsp;is&nbsp;similar&nbsp;to&nbsp;Fscan,&nbsp;but&nbsp;stops&nbsp;scanning&nbsp;at&nbsp;a&nbsp;newline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2280632">//&nbsp;after&nbsp;the&nbsp;final&nbsp;item&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;newline&nbsp;or&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="2280688">func</span>&nbsp;<span class="ident" id="2280693">Fscanln</span><span class="op" id="2280700">(</span><span class="ident" id="2280701">r</span>&nbsp;<span class="ident" id="2280703">io</span><span class="op" id="2280705">.</span><span class="ident" id="2280706">Reader</span><span class="op" id="2280712">,</span>&nbsp;<span class="ident" id="2280714">a</span>&nbsp;<span class="op" id="2280716">...</span><span class="keyword" id="2280719">interface</span><span class="op" id="2280728">{</span><span class="op" id="2280729">}</span><span class="op" id="2280730">)</span>&nbsp;<span class="op" id="2280732">(</span><span class="ident" id="2280733">n</span>&nbsp;<span class="builtintype" id="2280735">int</span><span class="op" id="2280738">,</span>&nbsp;<span class="ident" id="2280740">err</span>&nbsp;<span class="builtintype" id="2280744">error</span><span class="op" id="2280749">)</span>&nbsp;<span class="op" id="2280751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2280754">s</span><span class="op" id="2280755">,</span>&nbsp;<span class="ident" id="2280757">old</span>&nbsp;<span class="op" id="2280761">:=</span>&nbsp;<span class="ident" id="2280764">newScanState</span><span class="op" id="2280776">(</span><span class="ident" id="2280777">r</span><span class="op" id="2280778">,</span>&nbsp;<span class="builtintype" id="2280780">false</span><span class="op" id="2280785">,</span>&nbsp;<span class="builtintype" id="2280787">true</span><span class="op" id="2280791">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2280794">n</span><span class="op" id="2280795">,</span>&nbsp;<span class="ident" id="2280797">err</span>&nbsp;<span class="op" id="2280801">=</span>&nbsp;<span class="ident" id="2280803">s</span><span class="op" id="2280804">.</span><span class="ident" id="2280805">doScan</span><span class="op" id="2280811">(</span><span class="ident" id="2280812">a</span><span class="op" id="2280813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2280816">s</span><span class="op" id="2280817">.</span><span class="ident" id="2280818">free</span><span class="op" id="2280822">(</span><span class="ident" id="2280823">old</span><span class="op" id="2280826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2280829">return</span><br>
<span class="lineno"></span><span class="op" id="2280836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="2280839">//&nbsp;Fscanf&nbsp;scans&nbsp;text&nbsp;read&nbsp;from&nbsp;r,&nbsp;storing&nbsp;successive&nbsp;space-separated</span><br>
<span class="lineno"></span><span class="comment" id="2280908">//&nbsp;values&nbsp;into&nbsp;successive&nbsp;arguments&nbsp;as&nbsp;determined&nbsp;by&nbsp;the&nbsp;format.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2280977">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;items&nbsp;successfully&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="2281029">func</span>&nbsp;<span class="ident" id="2281034">Fscanf</span><span class="op" id="2281040">(</span><span class="ident" id="2281041">r</span>&nbsp;<span class="ident" id="2281043">io</span><span class="op" id="2281045">.</span><span class="ident" id="2281046">Reader</span><span class="op" id="2281052">,</span>&nbsp;<span class="ident" id="2281054">format</span>&nbsp;<span class="builtintype" id="2281061">string</span><span class="op" id="2281067">,</span>&nbsp;<span class="ident" id="2281069">a</span>&nbsp;<span class="op" id="2281071">...</span><span class="keyword" id="2281074">interface</span><span class="op" id="2281083">{</span><span class="op" id="2281084">}</span><span class="op" id="2281085">)</span>&nbsp;<span class="op" id="2281087">(</span><span class="ident" id="2281088">n</span>&nbsp;<span class="builtintype" id="2281090">int</span><span class="op" id="2281093">,</span>&nbsp;<span class="ident" id="2281095">err</span>&nbsp;<span class="builtintype" id="2281099">error</span><span class="op" id="2281104">)</span>&nbsp;<span class="op" id="2281106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2281109">s</span><span class="op" id="2281110">,</span>&nbsp;<span class="ident" id="2281112">old</span>&nbsp;<span class="op" id="2281116">:=</span>&nbsp;<span class="ident" id="2281119">newScanState</span><span class="op" id="2281131">(</span><span class="ident" id="2281132">r</span><span class="op" id="2281133">,</span>&nbsp;<span class="builtintype" id="2281135">false</span><span class="op" id="2281140">,</span>&nbsp;<span class="builtintype" id="2281142">false</span><span class="op" id="2281147">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2281150">n</span><span class="op" id="2281151">,</span>&nbsp;<span class="ident" id="2281153">err</span>&nbsp;<span class="op" id="2281157">=</span>&nbsp;<span class="ident" id="2281159">s</span><span class="op" id="2281160">.</span><span class="ident" id="2281161">doScanf</span><span class="op" id="2281168">(</span><span class="ident" id="2281169">format</span><span class="op" id="2281175">,</span>&nbsp;<span class="ident" id="2281177">a</span><span class="op" id="2281178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2281181">s</span><span class="op" id="2281182">.</span><span class="ident" id="2281183">free</span><span class="op" id="2281187">(</span><span class="ident" id="2281188">old</span><span class="op" id="2281191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2281194">return</span><br>
<span class="lineno"></span><span class="op" id="2281201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="comment" id="2281204">//&nbsp;scanError&nbsp;represents&nbsp;an&nbsp;error&nbsp;generated&nbsp;by&nbsp;the&nbsp;scanning&nbsp;software.</span><br>
<span class="lineno"></span><span class="comment" id="2281273">//&nbsp;It&#39;s&nbsp;used&nbsp;as&nbsp;a&nbsp;unique&nbsp;signature&nbsp;to&nbsp;identify&nbsp;such&nbsp;errors&nbsp;when&nbsp;recovering.</span><br>
<span class="lineno"></span><span class="keyword" id="2281349">type</span>&nbsp;<span class="ident" id="2281354">scanError</span>&nbsp;<span class="keyword" id="2281364">struct</span>&nbsp;<span class="op" id="2281371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2281374">err</span>&nbsp;<span class="builtintype" id="2281378">error</span><br>
<span class="lineno"></span><span class="op" id="2281384">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="2281387">const</span>&nbsp;<span class="ident" id="2281393">eof</span>&nbsp;<span class="op" id="2281397">=</span>&nbsp;<span class="op" id="2281399">-</span><span class="num" id="2281400">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2281403">//&nbsp;ss&nbsp;is&nbsp;the&nbsp;internal&nbsp;implementation&nbsp;of&nbsp;ScanState.</span><br>
<span class="lineno"></span><span class="keyword" id="2281454">type</span>&nbsp;<span class="ident" id="2281459">ss</span>&nbsp;<span class="keyword" id="2281462">struct</span>&nbsp;<span class="op" id="2281469">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2281472">rr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2281481">io</span><span class="op" id="2281483">.</span><span class="ident" id="2281484">RuneReader</span>&nbsp;<span class="comment" id="2281495">//&nbsp;where&nbsp;to&nbsp;read&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2281519">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2281528">buffer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2281542">//&nbsp;token&nbsp;accumulator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2281564">peekRune</span>&nbsp;<span class="builtintype" id="2281573">rune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2281587">//&nbsp;one-rune&nbsp;lookahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2281610">prevRune</span>&nbsp;<span class="builtintype" id="2281619">rune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2281633">//&nbsp;last&nbsp;rune&nbsp;returned&nbsp;by&nbsp;ReadRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2281668">count</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2281677">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2281691">//&nbsp;runes&nbsp;consumed&nbsp;so&nbsp;far.</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2281718">atEOF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2281727">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2281741">//&nbsp;already&nbsp;read&nbsp;EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2281762">ssave</span><br>
<span class="lineno"></span><span class="op" id="2281768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2281771">//&nbsp;ssave&nbsp;holds&nbsp;the&nbsp;parts&nbsp;of&nbsp;ss&nbsp;that&nbsp;need&nbsp;to&nbsp;be</span><br>
<span class="lineno">170</span><span class="comment" id="2281818">//&nbsp;saved&nbsp;and&nbsp;restored&nbsp;on&nbsp;recursive&nbsp;scans.</span><br>
<span class="lineno"></span><span class="keyword" id="2281860">type</span>&nbsp;<span class="ident" id="2281865">ssave</span>&nbsp;<span class="keyword" id="2281871">struct</span>&nbsp;<span class="op" id="2281878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2281881">validSave</span>&nbsp;<span class="builtintype" id="2281891">bool</span>&nbsp;<span class="comment" id="2281896">//&nbsp;is&nbsp;or&nbsp;was&nbsp;a&nbsp;part&nbsp;of&nbsp;an&nbsp;actual&nbsp;ss.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2281934">nlIsEnd</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2281944">bool</span>&nbsp;<span class="comment" id="2281949">//&nbsp;whether&nbsp;newline&nbsp;terminates&nbsp;scan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2281985">nlIsSpace</span>&nbsp;<span class="builtintype" id="2281995">bool</span>&nbsp;<span class="comment" id="2282000">//&nbsp;whether&nbsp;newline&nbsp;counts&nbsp;as&nbsp;white&nbsp;space</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2282042">argLimit</span>&nbsp;&nbsp;<span class="builtintype" id="2282052">int</span>&nbsp;&nbsp;<span class="comment" id="2282057">//&nbsp;max&nbsp;value&nbsp;of&nbsp;ss.count&nbsp;for&nbsp;this&nbsp;arg;&nbsp;argLimit&nbsp;&lt;=&nbsp;limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2282115">limit</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2282125">int</span>&nbsp;&nbsp;<span class="comment" id="2282130">//&nbsp;max&nbsp;value&nbsp;of&nbsp;ss.count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2282157">maxWid</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2282167">int</span>&nbsp;&nbsp;<span class="comment" id="2282172">//&nbsp;width&nbsp;of&nbsp;this&nbsp;arg.</span><br>
<span class="lineno"></span><span class="op" id="2282194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="2282197">//&nbsp;The&nbsp;Read&nbsp;method&nbsp;is&nbsp;only&nbsp;in&nbsp;ScanState&nbsp;so&nbsp;that&nbsp;ScanState</span><br>
<span class="lineno"></span><span class="comment" id="2282255">//&nbsp;satisfies&nbsp;io.Reader.&nbsp;It&nbsp;will&nbsp;never&nbsp;be&nbsp;called&nbsp;when&nbsp;used&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="2282316">//&nbsp;intended,&nbsp;so&nbsp;there&nbsp;is&nbsp;no&nbsp;need&nbsp;to&nbsp;make&nbsp;it&nbsp;actually&nbsp;work.</span><br>
<span class="lineno"></span><span class="keyword" id="2282375">func</span>&nbsp;<span class="op" id="2282380">(</span><span class="ident" id="2282381">s</span>&nbsp;<span class="op" id="2282383">*</span><span class="ident" id="2282384">ss</span><span class="op" id="2282386">)</span>&nbsp;<span class="ident" id="2282388">Read</span><span class="op" id="2282392">(</span><span class="ident" id="2282393">buf</span>&nbsp;<span class="op" id="2282397">[</span><span class="op" id="2282398">]</span><span class="builtintype" id="2282399">byte</span><span class="op" id="2282403">)</span>&nbsp;<span class="op" id="2282405">(</span><span class="ident" id="2282406">n</span>&nbsp;<span class="builtintype" id="2282408">int</span><span class="op" id="2282411">,</span>&nbsp;<span class="ident" id="2282413">err</span>&nbsp;<span class="builtintype" id="2282417">error</span><span class="op" id="2282422">)</span>&nbsp;<span class="op" id="2282424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2282427">return</span>&nbsp;<span class="num" id="2282434">0</span><span class="op" id="2282435">,</span>&nbsp;<span class="ident" id="2282437">errors</span><span class="op" id="2282443">.</span><span class="ident" id="2282444">New</span><span class="op" id="2282447">(</span><span class="string" id="2282448">&#34;ScanState&#39;s&nbsp;Read&nbsp;should&nbsp;not&nbsp;be&nbsp;called.&nbsp;Use&nbsp;ReadRune&#34;</span><span class="op" id="2282501">)</span><br>
<span class="lineno">185</span><span class="op" id="2282503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2282506">func</span>&nbsp;<span class="op" id="2282511">(</span><span class="ident" id="2282512">s</span>&nbsp;<span class="op" id="2282514">*</span><span class="ident" id="2282515">ss</span><span class="op" id="2282517">)</span>&nbsp;<span class="ident" id="2282519">ReadRune</span><span class="op" id="2282527">(</span><span class="op" id="2282528">)</span>&nbsp;<span class="op" id="2282530">(</span><span class="ident" id="2282531">r</span>&nbsp;<span class="builtintype" id="2282533">rune</span><span class="op" id="2282537">,</span>&nbsp;<span class="ident" id="2282539">size</span>&nbsp;<span class="builtintype" id="2282544">int</span><span class="op" id="2282547">,</span>&nbsp;<span class="ident" id="2282549">err</span>&nbsp;<span class="builtintype" id="2282553">error</span><span class="op" id="2282558">)</span>&nbsp;<span class="op" id="2282560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2282563">if</span>&nbsp;<span class="ident" id="2282566">s</span><span class="op" id="2282567">.</span><span class="ident" id="2282568">peekRune</span>&nbsp;<span class="op" id="2282577">&gt;=</span>&nbsp;<span class="num" id="2282580">0</span>&nbsp;<span class="op" id="2282582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2282586">s</span><span class="op" id="2282587">.</span><span class="ident" id="2282588">count</span><span class="op" id="2282593">++</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2282598">r</span>&nbsp;<span class="op" id="2282600">=</span>&nbsp;<span class="ident" id="2282602">s</span><span class="op" id="2282603">.</span><span class="ident" id="2282604">peekRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2282615">size</span>&nbsp;<span class="op" id="2282620">=</span>&nbsp;<span class="ident" id="2282622">utf8</span><span class="op" id="2282626">.</span><span class="ident" id="2282627">RuneLen</span><span class="op" id="2282634">(</span><span class="ident" id="2282635">r</span><span class="op" id="2282636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2282640">s</span><span class="op" id="2282641">.</span><span class="ident" id="2282642">prevRune</span>&nbsp;<span class="op" id="2282651">=</span>&nbsp;<span class="ident" id="2282653">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2282657">s</span><span class="op" id="2282658">.</span><span class="ident" id="2282659">peekRune</span>&nbsp;<span class="op" id="2282668">=</span>&nbsp;<span class="op" id="2282670">-</span><span class="num" id="2282671">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2282675">return</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2282683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2282686">if</span>&nbsp;<span class="ident" id="2282689">s</span><span class="op" id="2282690">.</span><span class="ident" id="2282691">atEOF</span>&nbsp;<span class="op" id="2282697">||</span>&nbsp;<span class="ident" id="2282700">s</span><span class="op" id="2282701">.</span><span class="ident" id="2282702">nlIsEnd</span>&nbsp;<span class="op" id="2282710">&amp;&amp;</span>&nbsp;<span class="ident" id="2282713">s</span><span class="op" id="2282714">.</span><span class="ident" id="2282715">prevRune</span>&nbsp;<span class="op" id="2282724">==</span>&nbsp;<span class="string" id="2282727">&#39;\n&#39;</span>&nbsp;<span class="op" id="2282732">||</span>&nbsp;<span class="ident" id="2282735">s</span><span class="op" id="2282736">.</span><span class="ident" id="2282737">count</span>&nbsp;<span class="op" id="2282743">&gt;=</span>&nbsp;<span class="ident" id="2282746">s</span><span class="op" id="2282747">.</span><span class="ident" id="2282748">argLimit</span>&nbsp;<span class="op" id="2282757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2282761">err</span>&nbsp;<span class="op" id="2282765">=</span>&nbsp;<span class="ident" id="2282767">io</span><span class="op" id="2282769">.</span><span class="ident" id="2282770">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2282776">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2282784">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2282788">r</span><span class="op" id="2282789">,</span>&nbsp;<span class="ident" id="2282791">size</span><span class="op" id="2282795">,</span>&nbsp;<span class="ident" id="2282797">err</span>&nbsp;<span class="op" id="2282801">=</span>&nbsp;<span class="ident" id="2282803">s</span><span class="op" id="2282804">.</span><span class="ident" id="2282805">rr</span><span class="op" id="2282807">.</span><span class="ident" id="2282808">ReadRune</span><span class="op" id="2282816">(</span><span class="op" id="2282817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2282820">if</span>&nbsp;<span class="ident" id="2282823">err</span>&nbsp;<span class="op" id="2282827">==</span>&nbsp;<span class="ident" id="2282830">nil</span>&nbsp;<span class="op" id="2282834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2282838">s</span><span class="op" id="2282839">.</span><span class="ident" id="2282840">count</span><span class="op" id="2282845">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2282850">s</span><span class="op" id="2282851">.</span><span class="ident" id="2282852">prevRune</span>&nbsp;<span class="op" id="2282861">=</span>&nbsp;<span class="ident" id="2282863">r</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2282866">}</span>&nbsp;<span class="keyword" id="2282868">else</span>&nbsp;<span class="keyword" id="2282873">if</span>&nbsp;<span class="ident" id="2282876">err</span>&nbsp;<span class="op" id="2282880">==</span>&nbsp;<span class="ident" id="2282883">io</span><span class="op" id="2282885">.</span><span class="ident" id="2282886">EOF</span>&nbsp;<span class="op" id="2282890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2282894">s</span><span class="op" id="2282895">.</span><span class="ident" id="2282896">atEOF</span>&nbsp;<span class="op" id="2282902">=</span>&nbsp;<span class="builtintype" id="2282904">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2282910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2282913">return</span><br>
<span class="lineno"></span><span class="op" id="2282920">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="2282923">func</span>&nbsp;<span class="op" id="2282928">(</span><span class="ident" id="2282929">s</span>&nbsp;<span class="op" id="2282931">*</span><span class="ident" id="2282932">ss</span><span class="op" id="2282934">)</span>&nbsp;<span class="ident" id="2282936">Width</span><span class="op" id="2282941">(</span><span class="op" id="2282942">)</span>&nbsp;<span class="op" id="2282944">(</span><span class="ident" id="2282945">wid</span>&nbsp;<span class="builtintype" id="2282949">int</span><span class="op" id="2282952">,</span>&nbsp;<span class="ident" id="2282954">ok</span>&nbsp;<span class="builtintype" id="2282957">bool</span><span class="op" id="2282961">)</span>&nbsp;<span class="op" id="2282963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2282966">if</span>&nbsp;<span class="ident" id="2282969">s</span><span class="op" id="2282970">.</span><span class="ident" id="2282971">maxWid</span>&nbsp;<span class="op" id="2282978">==</span>&nbsp;<span class="ident" id="2282981">hugeWid</span>&nbsp;<span class="op" id="2282989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2282993">return</span>&nbsp;<span class="num" id="2283000">0</span><span class="op" id="2283001">,</span>&nbsp;<span class="builtintype" id="2283003">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2283010">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2283013">return</span>&nbsp;<span class="ident" id="2283020">s</span><span class="op" id="2283021">.</span><span class="ident" id="2283022">maxWid</span><span class="op" id="2283028">,</span>&nbsp;<span class="builtintype" id="2283030">true</span><br>
<span class="lineno"></span><span class="op" id="2283035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2283038">//&nbsp;The&nbsp;public&nbsp;method&nbsp;returns&nbsp;an&nbsp;error;&nbsp;this&nbsp;private&nbsp;one&nbsp;panics.</span><br>
<span class="lineno"></span><span class="comment" id="2283102">//&nbsp;If&nbsp;getRune&nbsp;reaches&nbsp;EOF,&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;EOF&nbsp;(-1).</span><br>
<span class="lineno">220</span><span class="keyword" id="2283159">func</span>&nbsp;<span class="op" id="2283164">(</span><span class="ident" id="2283165">s</span>&nbsp;<span class="op" id="2283167">*</span><span class="ident" id="2283168">ss</span><span class="op" id="2283170">)</span>&nbsp;<span class="ident" id="2283172">getRune</span><span class="op" id="2283179">(</span><span class="op" id="2283180">)</span>&nbsp;<span class="op" id="2283182">(</span><span class="ident" id="2283183">r</span>&nbsp;<span class="builtintype" id="2283185">rune</span><span class="op" id="2283189">)</span>&nbsp;<span class="op" id="2283191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2283194">r</span><span class="op" id="2283195">,</span>&nbsp;<span class="ident" id="2283197">_</span><span class="op" id="2283198">,</span>&nbsp;<span class="ident" id="2283200">err</span>&nbsp;<span class="op" id="2283204">:=</span>&nbsp;<span class="ident" id="2283207">s</span><span class="op" id="2283208">.</span><span class="ident" id="2283209">ReadRune</span><span class="op" id="2283217">(</span><span class="op" id="2283218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2283221">if</span>&nbsp;<span class="ident" id="2283224">err</span>&nbsp;<span class="op" id="2283228">!=</span>&nbsp;<span class="ident" id="2283231">nil</span>&nbsp;<span class="op" id="2283235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2283239">if</span>&nbsp;<span class="ident" id="2283242">err</span>&nbsp;<span class="op" id="2283246">==</span>&nbsp;<span class="ident" id="2283249">io</span><span class="op" id="2283251">.</span><span class="ident" id="2283252">EOF</span>&nbsp;<span class="op" id="2283256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2283261">return</span>&nbsp;<span class="ident" id="2283268">eof</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2283274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2283278">s</span><span class="op" id="2283279">.</span><span class="builtintype" id="2283280">error</span><span class="op" id="2283285">(</span><span class="ident" id="2283286">err</span><span class="op" id="2283289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2283292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2283295">return</span><br>
<span class="lineno"></span><span class="op" id="2283302">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="comment" id="2283305">//&nbsp;mustReadRune&nbsp;turns&nbsp;io.EOF&nbsp;into&nbsp;a&nbsp;panic(io.ErrUnexpectedEOF).</span><br>
<span class="lineno"></span><span class="comment" id="2283369">//&nbsp;It&nbsp;is&nbsp;called&nbsp;in&nbsp;cases&nbsp;such&nbsp;as&nbsp;string&nbsp;scanning&nbsp;where&nbsp;an&nbsp;EOF&nbsp;is&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2283436">//&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="2283453">func</span>&nbsp;<span class="op" id="2283458">(</span><span class="ident" id="2283459">s</span>&nbsp;<span class="op" id="2283461">*</span><span class="ident" id="2283462">ss</span><span class="op" id="2283464">)</span>&nbsp;<span class="ident" id="2283466">mustReadRune</span><span class="op" id="2283478">(</span><span class="op" id="2283479">)</span>&nbsp;<span class="op" id="2283481">(</span><span class="ident" id="2283482">r</span>&nbsp;<span class="builtintype" id="2283484">rune</span><span class="op" id="2283488">)</span>&nbsp;<span class="op" id="2283490">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2283493">r</span>&nbsp;<span class="op" id="2283495">=</span>&nbsp;<span class="ident" id="2283497">s</span><span class="op" id="2283498">.</span><span class="ident" id="2283499">getRune</span><span class="op" id="2283506">(</span><span class="op" id="2283507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2283510">if</span>&nbsp;<span class="ident" id="2283513">r</span>&nbsp;<span class="op" id="2283515">==</span>&nbsp;<span class="ident" id="2283518">eof</span>&nbsp;<span class="op" id="2283522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2283526">s</span><span class="op" id="2283527">.</span><span class="builtintype" id="2283528">error</span><span class="op" id="2283533">(</span><span class="ident" id="2283534">io</span><span class="op" id="2283536">.</span><span class="ident" id="2283537">ErrUnexpectedEOF</span><span class="op" id="2283553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2283556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2283559">return</span><br>
<span class="lineno">240</span><span class="op" id="2283566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2283569">func</span>&nbsp;<span class="op" id="2283574">(</span><span class="ident" id="2283575">s</span>&nbsp;<span class="op" id="2283577">*</span><span class="ident" id="2283578">ss</span><span class="op" id="2283580">)</span>&nbsp;<span class="ident" id="2283582">UnreadRune</span><span class="op" id="2283592">(</span><span class="op" id="2283593">)</span>&nbsp;<span class="builtintype" id="2283595">error</span>&nbsp;<span class="op" id="2283601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2283604">if</span>&nbsp;<span class="ident" id="2283607">u</span><span class="op" id="2283608">,</span>&nbsp;<span class="ident" id="2283610">ok</span>&nbsp;<span class="op" id="2283613">:=</span>&nbsp;<span class="ident" id="2283616">s</span><span class="op" id="2283617">.</span><span class="ident" id="2283618">rr</span><span class="op" id="2283620">.</span><span class="op" id="2283621">(</span><span class="ident" id="2283622">runeUnreader</span><span class="op" id="2283634">)</span><span class="op" id="2283635">;</span>&nbsp;<span class="ident" id="2283637">ok</span>&nbsp;<span class="op" id="2283640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2283644">u</span><span class="op" id="2283645">.</span><span class="ident" id="2283646">UnreadRune</span><span class="op" id="2283656">(</span><span class="op" id="2283657">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2283660">}</span>&nbsp;<span class="keyword" id="2283662">else</span>&nbsp;<span class="op" id="2283667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2283671">s</span><span class="op" id="2283672">.</span><span class="ident" id="2283673">peekRune</span>&nbsp;<span class="op" id="2283682">=</span>&nbsp;<span class="ident" id="2283684">s</span><span class="op" id="2283685">.</span><span class="ident" id="2283686">prevRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2283696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2283699">s</span><span class="op" id="2283700">.</span><span class="ident" id="2283701">prevRune</span>&nbsp;<span class="op" id="2283710">=</span>&nbsp;<span class="op" id="2283712">-</span><span class="num" id="2283713">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2283716">s</span><span class="op" id="2283717">.</span><span class="ident" id="2283718">count</span><span class="op" id="2283723">--</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2283727">return</span>&nbsp;<span class="ident" id="2283734">nil</span><br>
<span class="lineno"></span><span class="op" id="2283738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2283741">func</span>&nbsp;<span class="op" id="2283746">(</span><span class="ident" id="2283747">s</span>&nbsp;<span class="op" id="2283749">*</span><span class="ident" id="2283750">ss</span><span class="op" id="2283752">)</span>&nbsp;<span class="builtintype" id="2283754">error</span><span class="op" id="2283759">(</span><span class="ident" id="2283760">err</span>&nbsp;<span class="builtintype" id="2283764">error</span><span class="op" id="2283769">)</span>&nbsp;<span class="op" id="2283771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2283774">panic</span><span class="op" id="2283779">(</span><span class="ident" id="2283780">scanError</span><span class="op" id="2283789">{</span><span class="ident" id="2283790">err</span><span class="op" id="2283793">}</span><span class="op" id="2283794">)</span><br>
<span class="lineno">255</span><span class="op" id="2283796">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2283799">func</span>&nbsp;<span class="op" id="2283804">(</span><span class="ident" id="2283805">s</span>&nbsp;<span class="op" id="2283807">*</span><span class="ident" id="2283808">ss</span><span class="op" id="2283810">)</span>&nbsp;<span class="ident" id="2283812">errorString</span><span class="op" id="2283823">(</span><span class="ident" id="2283824">err</span>&nbsp;<span class="builtintype" id="2283828">string</span><span class="op" id="2283834">)</span>&nbsp;<span class="op" id="2283836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2283839">panic</span><span class="op" id="2283844">(</span><span class="ident" id="2283845">scanError</span><span class="op" id="2283854">{</span><span class="ident" id="2283855">errors</span><span class="op" id="2283861">.</span><span class="ident" id="2283862">New</span><span class="op" id="2283865">(</span><span class="ident" id="2283866">err</span><span class="op" id="2283869">)</span><span class="op" id="2283870">}</span><span class="op" id="2283871">)</span><br>
<span class="lineno"></span><span class="op" id="2283873">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="2283876">func</span>&nbsp;<span class="op" id="2283881">(</span><span class="ident" id="2283882">s</span>&nbsp;<span class="op" id="2283884">*</span><span class="ident" id="2283885">ss</span><span class="op" id="2283887">)</span>&nbsp;<span class="ident" id="2283889">Token</span><span class="op" id="2283894">(</span><span class="ident" id="2283895">skipSpace</span>&nbsp;<span class="builtintype" id="2283905">bool</span><span class="op" id="2283909">,</span>&nbsp;<span class="ident" id="2283911">f</span>&nbsp;<span class="keyword" id="2283913">func</span><span class="op" id="2283917">(</span><span class="builtintype" id="2283918">rune</span><span class="op" id="2283922">)</span>&nbsp;<span class="builtintype" id="2283924">bool</span><span class="op" id="2283928">)</span>&nbsp;<span class="op" id="2283930">(</span><span class="ident" id="2283931">tok</span>&nbsp;<span class="op" id="2283935">[</span><span class="op" id="2283936">]</span><span class="builtintype" id="2283937">byte</span><span class="op" id="2283941">,</span>&nbsp;<span class="ident" id="2283943">err</span>&nbsp;<span class="builtintype" id="2283947">error</span><span class="op" id="2283952">)</span>&nbsp;<span class="op" id="2283954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2283957">defer</span>&nbsp;<span class="keyword" id="2283963">func</span><span class="op" id="2283967">(</span><span class="op" id="2283968">)</span>&nbsp;<span class="op" id="2283970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2283974">if</span>&nbsp;<span class="ident" id="2283977">e</span>&nbsp;<span class="op" id="2283979">:=</span>&nbsp;<span class="builtinfunc" id="2283982">recover</span><span class="op" id="2283989">(</span><span class="op" id="2283990">)</span><span class="op" id="2283991">;</span>&nbsp;<span class="ident" id="2283993">e</span>&nbsp;<span class="op" id="2283995">!=</span>&nbsp;<span class="ident" id="2283998">nil</span>&nbsp;<span class="op" id="2284002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2284007">if</span>&nbsp;<span class="ident" id="2284010">se</span><span class="op" id="2284012">,</span>&nbsp;<span class="ident" id="2284014">ok</span>&nbsp;<span class="op" id="2284017">:=</span>&nbsp;<span class="ident" id="2284020">e</span><span class="op" id="2284021">.</span><span class="op" id="2284022">(</span><span class="ident" id="2284023">scanError</span><span class="op" id="2284032">)</span><span class="op" id="2284033">;</span>&nbsp;<span class="ident" id="2284035">ok</span>&nbsp;<span class="op" id="2284038">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2284044">err</span>&nbsp;<span class="op" id="2284048">=</span>&nbsp;<span class="ident" id="2284050">se</span><span class="op" id="2284052">.</span><span class="ident" id="2284053">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2284060">}</span>&nbsp;<span class="keyword" id="2284062">else</span>&nbsp;<span class="op" id="2284067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2284073">panic</span><span class="op" id="2284078">(</span><span class="ident" id="2284079">e</span><span class="op" id="2284080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2284085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2284089">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2284092">}</span><span class="op" id="2284093">(</span><span class="op" id="2284094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2284097">if</span>&nbsp;<span class="ident" id="2284100">f</span>&nbsp;<span class="op" id="2284102">==</span>&nbsp;<span class="ident" id="2284105">nil</span>&nbsp;<span class="op" id="2284109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2284113">f</span>&nbsp;<span class="op" id="2284115">=</span>&nbsp;<span class="ident" id="2284117">notSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2284127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2284130">s</span><span class="op" id="2284131">.</span><span class="ident" id="2284132">buf</span>&nbsp;<span class="op" id="2284136">=</span>&nbsp;<span class="ident" id="2284138">s</span><span class="op" id="2284139">.</span><span class="ident" id="2284140">buf</span><span class="op" id="2284143">[</span><span class="op" id="2284144">:</span><span class="num" id="2284145">0</span><span class="op" id="2284146">]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2284149">tok</span>&nbsp;<span class="op" id="2284153">=</span>&nbsp;<span class="ident" id="2284155">s</span><span class="op" id="2284156">.</span><span class="ident" id="2284157">token</span><span class="op" id="2284162">(</span><span class="ident" id="2284163">skipSpace</span><span class="op" id="2284172">,</span>&nbsp;<span class="ident" id="2284174">f</span><span class="op" id="2284175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2284178">return</span><br>
<span class="lineno"></span><span class="op" id="2284185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2284188">//&nbsp;space&nbsp;is&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;unicode.White_Space&nbsp;ranges,</span><br>
<span class="lineno">280</span><span class="comment" id="2284242">//&nbsp;to&nbsp;avoid&nbsp;depending&nbsp;on&nbsp;package&nbsp;unicode.</span><br>
<span class="lineno"></span><span class="keyword" id="2284284">var</span>&nbsp;<span class="ident" id="2284288">space</span>&nbsp;<span class="op" id="2284294">=</span>&nbsp;<span class="op" id="2284296">[</span><span class="op" id="2284297">]</span><span class="op" id="2284298">[</span><span class="num" id="2284299">2</span><span class="op" id="2284300">]</span><span class="builtintype" id="2284301">uint16</span><span class="op" id="2284307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2284310">{</span><span class="num" id="2284311">0x0009</span><span class="op" id="2284317">,</span>&nbsp;<span class="num" id="2284319">0x000d</span><span class="op" id="2284325">}</span><span class="op" id="2284326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2284329">{</span><span class="num" id="2284330">0x0020</span><span class="op" id="2284336">,</span>&nbsp;<span class="num" id="2284338">0x0020</span><span class="op" id="2284344">}</span><span class="op" id="2284345">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2284348">{</span><span class="num" id="2284349">0x0085</span><span class="op" id="2284355">,</span>&nbsp;<span class="num" id="2284357">0x0085</span><span class="op" id="2284363">}</span><span class="op" id="2284364">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2284367">{</span><span class="num" id="2284368">0x00a0</span><span class="op" id="2284374">,</span>&nbsp;<span class="num" id="2284376">0x00a0</span><span class="op" id="2284382">}</span><span class="op" id="2284383">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2284386">{</span><span class="num" id="2284387">0x1680</span><span class="op" id="2284393">,</span>&nbsp;<span class="num" id="2284395">0x1680</span><span class="op" id="2284401">}</span><span class="op" id="2284402">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2284405">{</span><span class="num" id="2284406">0x2000</span><span class="op" id="2284412">,</span>&nbsp;<span class="num" id="2284414">0x200a</span><span class="op" id="2284420">}</span><span class="op" id="2284421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2284424">{</span><span class="num" id="2284425">0x2028</span><span class="op" id="2284431">,</span>&nbsp;<span class="num" id="2284433">0x2029</span><span class="op" id="2284439">}</span><span class="op" id="2284440">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2284443">{</span><span class="num" id="2284444">0x202f</span><span class="op" id="2284450">,</span>&nbsp;<span class="num" id="2284452">0x202f</span><span class="op" id="2284458">}</span><span class="op" id="2284459">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2284462">{</span><span class="num" id="2284463">0x205f</span><span class="op" id="2284469">,</span>&nbsp;<span class="num" id="2284471">0x205f</span><span class="op" id="2284477">}</span><span class="op" id="2284478">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2284481">{</span><span class="num" id="2284482">0x3000</span><span class="op" id="2284488">,</span>&nbsp;<span class="num" id="2284490">0x3000</span><span class="op" id="2284496">}</span><span class="op" id="2284497">,</span><br>
<span class="lineno"></span><span class="op" id="2284499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2284502">func</span>&nbsp;<span class="ident" id="2284507">isSpace</span><span class="op" id="2284514">(</span><span class="ident" id="2284515">r</span>&nbsp;<span class="builtintype" id="2284517">rune</span><span class="op" id="2284521">)</span>&nbsp;<span class="builtintype" id="2284523">bool</span>&nbsp;<span class="op" id="2284528">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2284531">if</span>&nbsp;<span class="ident" id="2284534">r</span>&nbsp;<span class="op" id="2284536">&gt;=</span>&nbsp;<span class="num" id="2284539">1</span><span class="op" id="2284540">&lt;&lt;</span><span class="num" id="2284542">16</span>&nbsp;<span class="op" id="2284545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2284549">return</span>&nbsp;<span class="builtintype" id="2284556">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2284563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2284566">rx</span>&nbsp;<span class="op" id="2284569">:=</span>&nbsp;<span class="builtintype" id="2284572">uint16</span><span class="op" id="2284578">(</span><span class="ident" id="2284579">r</span><span class="op" id="2284580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2284583">for</span>&nbsp;<span class="ident" id="2284587">_</span><span class="op" id="2284588">,</span>&nbsp;<span class="ident" id="2284590">rng</span>&nbsp;<span class="op" id="2284594">:=</span>&nbsp;<span class="keyword" id="2284597">range</span>&nbsp;<span class="ident" id="2284603">space</span>&nbsp;<span class="op" id="2284609">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2284613">if</span>&nbsp;<span class="ident" id="2284616">rx</span>&nbsp;<span class="op" id="2284619">&lt;</span>&nbsp;<span class="ident" id="2284621">rng</span><span class="op" id="2284624">[</span><span class="num" id="2284625">0</span><span class="op" id="2284626">]</span>&nbsp;<span class="op" id="2284628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2284633">return</span>&nbsp;<span class="builtintype" id="2284640">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2284648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2284652">if</span>&nbsp;<span class="ident" id="2284655">rx</span>&nbsp;<span class="op" id="2284658">&lt;=</span>&nbsp;<span class="ident" id="2284661">rng</span><span class="op" id="2284664">[</span><span class="num" id="2284665">1</span><span class="op" id="2284666">]</span>&nbsp;<span class="op" id="2284668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2284673">return</span>&nbsp;<span class="builtintype" id="2284680">true</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2284687">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2284690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2284693">return</span>&nbsp;<span class="builtintype" id="2284700">false</span><br>
<span class="lineno"></span><span class="op" id="2284706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="2284709">//&nbsp;notSpace&nbsp;is&nbsp;the&nbsp;default&nbsp;scanning&nbsp;function&nbsp;used&nbsp;in&nbsp;Token.</span><br>
<span class="lineno"></span><span class="keyword" id="2284769">func</span>&nbsp;<span class="ident" id="2284774">notSpace</span><span class="op" id="2284782">(</span><span class="ident" id="2284783">r</span>&nbsp;<span class="builtintype" id="2284785">rune</span><span class="op" id="2284789">)</span>&nbsp;<span class="builtintype" id="2284791">bool</span>&nbsp;<span class="op" id="2284796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2284799">return</span>&nbsp;<span class="op" id="2284806">!</span><span class="ident" id="2284807">isSpace</span><span class="op" id="2284814">(</span><span class="ident" id="2284815">r</span><span class="op" id="2284816">)</span><br>
<span class="lineno"></span><span class="op" id="2284818">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span><span class="comment" id="2284821">//&nbsp;SkipSpace&nbsp;provides&nbsp;Scan&nbsp;methods&nbsp;the&nbsp;ability&nbsp;to&nbsp;skip&nbsp;space&nbsp;and&nbsp;newline</span><br>
<span class="lineno"></span><span class="comment" id="2284894">//&nbsp;characters&nbsp;in&nbsp;keeping&nbsp;with&nbsp;the&nbsp;current&nbsp;scanning&nbsp;mode&nbsp;set&nbsp;by&nbsp;format&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="2284972">//&nbsp;and&nbsp;Scan/Scanln.</span><br>
<span class="lineno"></span><span class="keyword" id="2284992">func</span>&nbsp;<span class="op" id="2284997">(</span><span class="ident" id="2284998">s</span>&nbsp;<span class="op" id="2285000">*</span><span class="ident" id="2285001">ss</span><span class="op" id="2285003">)</span>&nbsp;<span class="ident" id="2285005">SkipSpace</span><span class="op" id="2285014">(</span><span class="op" id="2285015">)</span>&nbsp;<span class="op" id="2285017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285020">s</span><span class="op" id="2285021">.</span><span class="ident" id="2285022">skipSpace</span><span class="op" id="2285031">(</span><span class="builtintype" id="2285032">false</span><span class="op" id="2285037">)</span><br>
<span class="lineno">320</span><span class="op" id="2285039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2285042">//&nbsp;readRune&nbsp;is&nbsp;a&nbsp;structure&nbsp;to&nbsp;enable&nbsp;reading&nbsp;UTF-8&nbsp;encoded&nbsp;code&nbsp;points</span><br>
<span class="lineno"></span><span class="comment" id="2285113">//&nbsp;from&nbsp;an&nbsp;io.Reader.&nbsp;&nbsp;It&nbsp;is&nbsp;used&nbsp;if&nbsp;the&nbsp;Reader&nbsp;given&nbsp;to&nbsp;the&nbsp;scanner&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="2285187">//&nbsp;not&nbsp;already&nbsp;implement&nbsp;io.RuneReader.</span><br>
<span class="lineno">325</span><span class="keyword" id="2285227">type</span>&nbsp;<span class="ident" id="2285232">readRune</span>&nbsp;<span class="keyword" id="2285241">struct</span>&nbsp;<span class="op" id="2285248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285251">reader</span>&nbsp;&nbsp;<span class="ident" id="2285259">io</span><span class="op" id="2285261">.</span><span class="ident" id="2285262">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285270">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2285278">[</span><span class="ident" id="2285279">utf8</span><span class="op" id="2285283">.</span><span class="ident" id="2285284">UTFMax</span><span class="op" id="2285290">]</span><span class="builtintype" id="2285291">byte</span>&nbsp;<span class="comment" id="2285296">//&nbsp;used&nbsp;only&nbsp;inside&nbsp;ReadRune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285326">pending</span>&nbsp;<span class="builtintype" id="2285334">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2285352">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;in&nbsp;pendBuf;&nbsp;only&nbsp;&gt;0&nbsp;for&nbsp;bad&nbsp;UTF-8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285406">pendBuf</span>&nbsp;<span class="op" id="2285414">[</span><span class="ident" id="2285415">utf8</span><span class="op" id="2285419">.</span><span class="ident" id="2285420">UTFMax</span><span class="op" id="2285426">]</span><span class="builtintype" id="2285427">byte</span>&nbsp;<span class="comment" id="2285432">//&nbsp;bytes&nbsp;left&nbsp;over</span><br>
<span class="lineno">330</span><span class="op" id="2285451">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2285454">//&nbsp;readByte&nbsp;returns&nbsp;the&nbsp;next&nbsp;byte&nbsp;from&nbsp;the&nbsp;input,&nbsp;which&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2285517">//&nbsp;left&nbsp;over&nbsp;from&nbsp;a&nbsp;previous&nbsp;read&nbsp;if&nbsp;the&nbsp;UTF-8&nbsp;was&nbsp;ill-formed.</span><br>
<span class="lineno"></span><span class="keyword" id="2285580">func</span>&nbsp;<span class="op" id="2285585">(</span><span class="ident" id="2285586">r</span>&nbsp;<span class="op" id="2285588">*</span><span class="ident" id="2285589">readRune</span><span class="op" id="2285597">)</span>&nbsp;<span class="ident" id="2285599">readByte</span><span class="op" id="2285607">(</span><span class="op" id="2285608">)</span>&nbsp;<span class="op" id="2285610">(</span><span class="ident" id="2285611">b</span>&nbsp;<span class="builtintype" id="2285613">byte</span><span class="op" id="2285617">,</span>&nbsp;<span class="ident" id="2285619">err</span>&nbsp;<span class="builtintype" id="2285623">error</span><span class="op" id="2285628">)</span>&nbsp;<span class="op" id="2285630">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285633">if</span>&nbsp;<span class="ident" id="2285636">r</span><span class="op" id="2285637">.</span><span class="ident" id="2285638">pending</span>&nbsp;<span class="op" id="2285646">&gt;</span>&nbsp;<span class="num" id="2285648">0</span>&nbsp;<span class="op" id="2285650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285654">b</span>&nbsp;<span class="op" id="2285656">=</span>&nbsp;<span class="ident" id="2285658">r</span><span class="op" id="2285659">.</span><span class="ident" id="2285660">pendBuf</span><span class="op" id="2285667">[</span><span class="num" id="2285668">0</span><span class="op" id="2285669">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2285673">copy</span><span class="op" id="2285677">(</span><span class="ident" id="2285678">r</span><span class="op" id="2285679">.</span><span class="ident" id="2285680">pendBuf</span><span class="op" id="2285687">[</span><span class="num" id="2285688">0</span><span class="op" id="2285689">:</span><span class="op" id="2285690">]</span><span class="op" id="2285691">,</span>&nbsp;<span class="ident" id="2285693">r</span><span class="op" id="2285694">.</span><span class="ident" id="2285695">pendBuf</span><span class="op" id="2285702">[</span><span class="num" id="2285703">1</span><span class="op" id="2285704">:</span><span class="op" id="2285705">]</span><span class="op" id="2285706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285710">r</span><span class="op" id="2285711">.</span><span class="ident" id="2285712">pending</span><span class="op" id="2285719">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285724">return</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2285732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285735">n</span><span class="op" id="2285736">,</span>&nbsp;<span class="ident" id="2285738">err</span>&nbsp;<span class="op" id="2285742">:=</span>&nbsp;<span class="ident" id="2285745">io</span><span class="op" id="2285747">.</span><span class="ident" id="2285748">ReadFull</span><span class="op" id="2285756">(</span><span class="ident" id="2285757">r</span><span class="op" id="2285758">.</span><span class="ident" id="2285759">reader</span><span class="op" id="2285765">,</span>&nbsp;<span class="ident" id="2285767">r</span><span class="op" id="2285768">.</span><span class="ident" id="2285769">pendBuf</span><span class="op" id="2285776">[</span><span class="num" id="2285777">0</span><span class="op" id="2285778">:</span><span class="num" id="2285779">1</span><span class="op" id="2285780">]</span><span class="op" id="2285781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285784">if</span>&nbsp;<span class="ident" id="2285787">n</span>&nbsp;<span class="op" id="2285789">!=</span>&nbsp;<span class="num" id="2285792">1</span>&nbsp;<span class="op" id="2285794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285798">return</span>&nbsp;<span class="num" id="2285805">0</span><span class="op" id="2285806">,</span>&nbsp;<span class="ident" id="2285808">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2285813">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2285816">return</span>&nbsp;<span class="ident" id="2285823">r</span><span class="op" id="2285824">.</span><span class="ident" id="2285825">pendBuf</span><span class="op" id="2285832">[</span><span class="num" id="2285833">0</span><span class="op" id="2285834">]</span><span class="op" id="2285835">,</span>&nbsp;<span class="ident" id="2285837">err</span><br>
<span class="lineno"></span><span class="op" id="2285841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2285844">//&nbsp;unread&nbsp;saves&nbsp;the&nbsp;bytes&nbsp;for&nbsp;the&nbsp;next&nbsp;read.</span><br>
<span class="lineno"></span><span class="keyword" id="2285889">func</span>&nbsp;<span class="op" id="2285894">(</span><span class="ident" id="2285895">r</span>&nbsp;<span class="op" id="2285897">*</span><span class="ident" id="2285898">readRune</span><span class="op" id="2285906">)</span>&nbsp;<span class="ident" id="2285908">unread</span><span class="op" id="2285914">(</span><span class="ident" id="2285915">buf</span>&nbsp;<span class="op" id="2285919">[</span><span class="op" id="2285920">]</span><span class="builtintype" id="2285921">byte</span><span class="op" id="2285925">)</span>&nbsp;<span class="op" id="2285927">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2285930">copy</span><span class="op" id="2285934">(</span><span class="ident" id="2285935">r</span><span class="op" id="2285936">.</span><span class="ident" id="2285937">pendBuf</span><span class="op" id="2285944">[</span><span class="ident" id="2285945">r</span><span class="op" id="2285946">.</span><span class="ident" id="2285947">pending</span><span class="op" id="2285954">:</span><span class="op" id="2285955">]</span><span class="op" id="2285956">,</span>&nbsp;<span class="ident" id="2285958">buf</span><span class="op" id="2285961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2285964">r</span><span class="op" id="2285965">.</span><span class="ident" id="2285966">pending</span>&nbsp;<span class="op" id="2285974">+=</span>&nbsp;<span class="builtinfunc" id="2285977">len</span><span class="op" id="2285980">(</span><span class="ident" id="2285981">buf</span><span class="op" id="2285984">)</span><br>
<span class="lineno"></span><span class="op" id="2285986">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2285989">//&nbsp;ReadRune&nbsp;returns&nbsp;the&nbsp;next&nbsp;UTF-8&nbsp;encoded&nbsp;code&nbsp;point&nbsp;from&nbsp;the</span><br>
<span class="lineno">355</span><span class="comment" id="2286052">//&nbsp;io.Reader&nbsp;inside&nbsp;r.</span><br>
<span class="lineno"></span><span class="keyword" id="2286075">func</span>&nbsp;<span class="op" id="2286080">(</span><span class="ident" id="2286081">r</span>&nbsp;<span class="op" id="2286083">*</span><span class="ident" id="2286084">readRune</span><span class="op" id="2286092">)</span>&nbsp;<span class="ident" id="2286094">ReadRune</span><span class="op" id="2286102">(</span><span class="op" id="2286103">)</span>&nbsp;<span class="op" id="2286105">(</span><span class="ident" id="2286106">rr</span>&nbsp;<span class="builtintype" id="2286109">rune</span><span class="op" id="2286113">,</span>&nbsp;<span class="ident" id="2286115">size</span>&nbsp;<span class="builtintype" id="2286120">int</span><span class="op" id="2286123">,</span>&nbsp;<span class="ident" id="2286125">err</span>&nbsp;<span class="builtintype" id="2286129">error</span><span class="op" id="2286134">)</span>&nbsp;<span class="op" id="2286136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286139">r</span><span class="op" id="2286140">.</span><span class="ident" id="2286141">buf</span><span class="op" id="2286144">[</span><span class="num" id="2286145">0</span><span class="op" id="2286146">]</span><span class="op" id="2286147">,</span>&nbsp;<span class="ident" id="2286149">err</span>&nbsp;<span class="op" id="2286153">=</span>&nbsp;<span class="ident" id="2286155">r</span><span class="op" id="2286156">.</span><span class="ident" id="2286157">readByte</span><span class="op" id="2286165">(</span><span class="op" id="2286166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286169">if</span>&nbsp;<span class="ident" id="2286172">err</span>&nbsp;<span class="op" id="2286176">!=</span>&nbsp;<span class="ident" id="2286179">nil</span>&nbsp;<span class="op" id="2286183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286187">return</span>&nbsp;<span class="num" id="2286194">0</span><span class="op" id="2286195">,</span>&nbsp;<span class="num" id="2286197">0</span><span class="op" id="2286198">,</span>&nbsp;<span class="ident" id="2286200">err</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2286205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286208">if</span>&nbsp;<span class="ident" id="2286211">r</span><span class="op" id="2286212">.</span><span class="ident" id="2286213">buf</span><span class="op" id="2286216">[</span><span class="num" id="2286217">0</span><span class="op" id="2286218">]</span>&nbsp;<span class="op" id="2286220">&lt;</span>&nbsp;<span class="ident" id="2286222">utf8</span><span class="op" id="2286226">.</span><span class="ident" id="2286227">RuneSelf</span>&nbsp;<span class="op" id="2286236">{</span>&nbsp;<span class="comment" id="2286238">//&nbsp;fast&nbsp;check&nbsp;for&nbsp;common&nbsp;ASCII&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286276">rr</span>&nbsp;<span class="op" id="2286279">=</span>&nbsp;<span class="builtintype" id="2286281">rune</span><span class="op" id="2286285">(</span><span class="ident" id="2286286">r</span><span class="op" id="2286287">.</span><span class="ident" id="2286288">buf</span><span class="op" id="2286291">[</span><span class="num" id="2286292">0</span><span class="op" id="2286293">]</span><span class="op" id="2286294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286298">size</span>&nbsp;<span class="op" id="2286303">=</span>&nbsp;<span class="num" id="2286305">1</span>&nbsp;<span class="comment" id="2286307">//&nbsp;Known&nbsp;to&nbsp;be&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286327">return</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2286335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286338">var</span>&nbsp;<span class="ident" id="2286342">n</span>&nbsp;<span class="builtintype" id="2286344">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286349">for</span>&nbsp;<span class="ident" id="2286353">n</span>&nbsp;<span class="op" id="2286355">=</span>&nbsp;<span class="num" id="2286357">1</span><span class="op" id="2286358">;</span>&nbsp;<span class="op" id="2286360">!</span><span class="ident" id="2286361">utf8</span><span class="op" id="2286365">.</span><span class="ident" id="2286366">FullRune</span><span class="op" id="2286374">(</span><span class="ident" id="2286375">r</span><span class="op" id="2286376">.</span><span class="ident" id="2286377">buf</span><span class="op" id="2286380">[</span><span class="num" id="2286381">0</span><span class="op" id="2286382">:</span><span class="ident" id="2286383">n</span><span class="op" id="2286384">]</span><span class="op" id="2286385">)</span><span class="op" id="2286386">;</span>&nbsp;<span class="ident" id="2286388">n</span><span class="op" id="2286389">++</span>&nbsp;<span class="op" id="2286392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286396">r</span><span class="op" id="2286397">.</span><span class="ident" id="2286398">buf</span><span class="op" id="2286401">[</span><span class="ident" id="2286402">n</span><span class="op" id="2286403">]</span><span class="op" id="2286404">,</span>&nbsp;<span class="ident" id="2286406">err</span>&nbsp;<span class="op" id="2286410">=</span>&nbsp;<span class="ident" id="2286412">r</span><span class="op" id="2286413">.</span><span class="ident" id="2286414">readByte</span><span class="op" id="2286422">(</span><span class="op" id="2286423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286427">if</span>&nbsp;<span class="ident" id="2286430">err</span>&nbsp;<span class="op" id="2286434">!=</span>&nbsp;<span class="ident" id="2286437">nil</span>&nbsp;<span class="op" id="2286441">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286446">if</span>&nbsp;<span class="ident" id="2286449">err</span>&nbsp;<span class="op" id="2286453">==</span>&nbsp;<span class="ident" id="2286456">io</span><span class="op" id="2286458">.</span><span class="ident" id="2286459">EOF</span>&nbsp;<span class="op" id="2286463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286469">err</span>&nbsp;<span class="op" id="2286473">=</span>&nbsp;<span class="ident" id="2286475">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286483">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2286492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286497">return</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2286506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2286509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286512">rr</span><span class="op" id="2286514">,</span>&nbsp;<span class="ident" id="2286516">size</span>&nbsp;<span class="op" id="2286521">=</span>&nbsp;<span class="ident" id="2286523">utf8</span><span class="op" id="2286527">.</span><span class="ident" id="2286528">DecodeRune</span><span class="op" id="2286538">(</span><span class="ident" id="2286539">r</span><span class="op" id="2286540">.</span><span class="ident" id="2286541">buf</span><span class="op" id="2286544">[</span><span class="num" id="2286545">0</span><span class="op" id="2286546">:</span><span class="ident" id="2286547">n</span><span class="op" id="2286548">]</span><span class="op" id="2286549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286552">if</span>&nbsp;<span class="ident" id="2286555">size</span>&nbsp;<span class="op" id="2286560">&lt;</span>&nbsp;<span class="ident" id="2286562">n</span>&nbsp;<span class="op" id="2286564">{</span>&nbsp;<span class="comment" id="2286566">//&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286580">r</span><span class="op" id="2286581">.</span><span class="ident" id="2286582">unread</span><span class="op" id="2286588">(</span><span class="ident" id="2286589">r</span><span class="op" id="2286590">.</span><span class="ident" id="2286591">buf</span><span class="op" id="2286594">[</span><span class="ident" id="2286595">size</span><span class="op" id="2286599">:</span><span class="ident" id="2286600">n</span><span class="op" id="2286601">]</span><span class="op" id="2286602">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2286605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286608">return</span><br>
<span class="lineno"></span><span class="op" id="2286615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2286618">var</span>&nbsp;<span class="ident" id="2286622">ssFree</span>&nbsp;<span class="op" id="2286629">=</span>&nbsp;<span class="ident" id="2286631">sync</span><span class="op" id="2286635">.</span><span class="ident" id="2286636">Pool</span><span class="op" id="2286640">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286643">New</span><span class="op" id="2286646">:</span>&nbsp;<span class="keyword" id="2286648">func</span><span class="op" id="2286652">(</span><span class="op" id="2286653">)</span>&nbsp;<span class="keyword" id="2286655">interface</span><span class="op" id="2286664">{</span><span class="op" id="2286665">}</span>&nbsp;<span class="op" id="2286667">{</span>&nbsp;<span class="keyword" id="2286669">return</span>&nbsp;<span class="builtinfunc" id="2286676">new</span><span class="op" id="2286679">(</span><span class="ident" id="2286680">ss</span><span class="op" id="2286682">)</span>&nbsp;<span class="op" id="2286684">}</span><span class="op" id="2286685">,</span><br>
<span class="lineno"></span><span class="op" id="2286687">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2286690">//&nbsp;newScanState&nbsp;allocates&nbsp;a&nbsp;new&nbsp;ss&nbsp;struct&nbsp;or&nbsp;grab&nbsp;a&nbsp;cached&nbsp;one.</span><br>
<span class="lineno"></span><span class="keyword" id="2286754">func</span>&nbsp;<span class="ident" id="2286759">newScanState</span><span class="op" id="2286771">(</span><span class="ident" id="2286772">r</span>&nbsp;<span class="ident" id="2286774">io</span><span class="op" id="2286776">.</span><span class="ident" id="2286777">Reader</span><span class="op" id="2286783">,</span>&nbsp;<span class="ident" id="2286785">nlIsSpace</span><span class="op" id="2286794">,</span>&nbsp;<span class="ident" id="2286796">nlIsEnd</span>&nbsp;<span class="builtintype" id="2286804">bool</span><span class="op" id="2286808">)</span>&nbsp;<span class="op" id="2286810">(</span><span class="ident" id="2286811">s</span>&nbsp;<span class="op" id="2286813">*</span><span class="ident" id="2286814">ss</span><span class="op" id="2286816">,</span>&nbsp;<span class="ident" id="2286818">old</span>&nbsp;<span class="ident" id="2286822">ssave</span><span class="op" id="2286827">)</span>&nbsp;<span class="op" id="2286829">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2286832">//&nbsp;If&nbsp;the&nbsp;reader&nbsp;is&nbsp;a&nbsp;*ss,&nbsp;then&nbsp;we&#39;ve&nbsp;got&nbsp;a&nbsp;recursive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2286887">//&nbsp;call&nbsp;to&nbsp;Scan,&nbsp;so&nbsp;re-use&nbsp;the&nbsp;scan&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286931">s</span><span class="op" id="2286932">,</span>&nbsp;<span class="ident" id="2286934">ok</span>&nbsp;<span class="op" id="2286937">:=</span>&nbsp;<span class="ident" id="2286940">r</span><span class="op" id="2286941">.</span><span class="op" id="2286942">(</span><span class="op" id="2286943">*</span><span class="ident" id="2286944">ss</span><span class="op" id="2286946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2286949">if</span>&nbsp;<span class="ident" id="2286952">ok</span>&nbsp;<span class="op" id="2286955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286959">old</span>&nbsp;<span class="op" id="2286963">=</span>&nbsp;<span class="ident" id="2286965">s</span><span class="op" id="2286966">.</span><span class="ident" id="2286967">ssave</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286975">s</span><span class="op" id="2286976">.</span><span class="ident" id="2286977">limit</span>&nbsp;<span class="op" id="2286983">=</span>&nbsp;<span class="ident" id="2286985">s</span><span class="op" id="2286986">.</span><span class="ident" id="2286987">argLimit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2286998">s</span><span class="op" id="2286999">.</span><span class="ident" id="2287000">nlIsEnd</span>&nbsp;<span class="op" id="2287008">=</span>&nbsp;<span class="ident" id="2287010">nlIsEnd</span>&nbsp;<span class="op" id="2287018">||</span>&nbsp;<span class="ident" id="2287021">s</span><span class="op" id="2287022">.</span><span class="ident" id="2287023">nlIsEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287033">s</span><span class="op" id="2287034">.</span><span class="ident" id="2287035">nlIsSpace</span>&nbsp;<span class="op" id="2287045">=</span>&nbsp;<span class="ident" id="2287047">nlIsSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287059">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2287067">}</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287071">s</span>&nbsp;<span class="op" id="2287073">=</span>&nbsp;<span class="ident" id="2287075">ssFree</span><span class="op" id="2287081">.</span><span class="ident" id="2287082">Get</span><span class="op" id="2287085">(</span><span class="op" id="2287086">)</span><span class="op" id="2287087">.</span><span class="op" id="2287088">(</span><span class="op" id="2287089">*</span><span class="ident" id="2287090">ss</span><span class="op" id="2287092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287095">if</span>&nbsp;<span class="ident" id="2287098">rr</span><span class="op" id="2287100">,</span>&nbsp;<span class="ident" id="2287102">ok</span>&nbsp;<span class="op" id="2287105">:=</span>&nbsp;<span class="ident" id="2287108">r</span><span class="op" id="2287109">.</span><span class="op" id="2287110">(</span><span class="ident" id="2287111">io</span><span class="op" id="2287113">.</span><span class="ident" id="2287114">RuneReader</span><span class="op" id="2287124">)</span><span class="op" id="2287125">;</span>&nbsp;<span class="ident" id="2287127">ok</span>&nbsp;<span class="op" id="2287130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287134">s</span><span class="op" id="2287135">.</span><span class="ident" id="2287136">rr</span>&nbsp;<span class="op" id="2287139">=</span>&nbsp;<span class="ident" id="2287141">rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2287145">}</span>&nbsp;<span class="keyword" id="2287147">else</span>&nbsp;<span class="op" id="2287152">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287156">s</span><span class="op" id="2287157">.</span><span class="ident" id="2287158">rr</span>&nbsp;<span class="op" id="2287161">=</span>&nbsp;<span class="op" id="2287163">&amp;</span><span class="ident" id="2287164">readRune</span><span class="op" id="2287172">{</span><span class="ident" id="2287173">reader</span><span class="op" id="2287179">:</span>&nbsp;<span class="ident" id="2287181">r</span><span class="op" id="2287182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2287185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287188">s</span><span class="op" id="2287189">.</span><span class="ident" id="2287190">nlIsSpace</span>&nbsp;<span class="op" id="2287200">=</span>&nbsp;<span class="ident" id="2287202">nlIsSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287213">s</span><span class="op" id="2287214">.</span><span class="ident" id="2287215">nlIsEnd</span>&nbsp;<span class="op" id="2287223">=</span>&nbsp;<span class="ident" id="2287225">nlIsEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287234">s</span><span class="op" id="2287235">.</span><span class="ident" id="2287236">prevRune</span>&nbsp;<span class="op" id="2287245">=</span>&nbsp;<span class="op" id="2287247">-</span><span class="num" id="2287248">1</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287251">s</span><span class="op" id="2287252">.</span><span class="ident" id="2287253">peekRune</span>&nbsp;<span class="op" id="2287262">=</span>&nbsp;<span class="op" id="2287264">-</span><span class="num" id="2287265">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287268">s</span><span class="op" id="2287269">.</span><span class="ident" id="2287270">atEOF</span>&nbsp;<span class="op" id="2287276">=</span>&nbsp;<span class="builtintype" id="2287278">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287285">s</span><span class="op" id="2287286">.</span><span class="ident" id="2287287">limit</span>&nbsp;<span class="op" id="2287293">=</span>&nbsp;<span class="ident" id="2287295">hugeWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287304">s</span><span class="op" id="2287305">.</span><span class="ident" id="2287306">argLimit</span>&nbsp;<span class="op" id="2287315">=</span>&nbsp;<span class="ident" id="2287317">hugeWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287326">s</span><span class="op" id="2287327">.</span><span class="ident" id="2287328">maxWid</span>&nbsp;<span class="op" id="2287335">=</span>&nbsp;<span class="ident" id="2287337">hugeWid</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287346">s</span><span class="op" id="2287347">.</span><span class="ident" id="2287348">validSave</span>&nbsp;<span class="op" id="2287358">=</span>&nbsp;<span class="builtintype" id="2287360">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287366">s</span><span class="op" id="2287367">.</span><span class="ident" id="2287368">count</span>&nbsp;<span class="op" id="2287374">=</span>&nbsp;<span class="num" id="2287376">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287379">return</span><br>
<span class="lineno"></span><span class="op" id="2287386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span><span class="comment" id="2287389">//&nbsp;free&nbsp;saves&nbsp;used&nbsp;ss&nbsp;structs&nbsp;in&nbsp;ssFree;&nbsp;avoid&nbsp;an&nbsp;allocation&nbsp;per&nbsp;invocation.</span><br>
<span class="lineno"></span><span class="keyword" id="2287466">func</span>&nbsp;<span class="op" id="2287471">(</span><span class="ident" id="2287472">s</span>&nbsp;<span class="op" id="2287474">*</span><span class="ident" id="2287475">ss</span><span class="op" id="2287477">)</span>&nbsp;<span class="ident" id="2287479">free</span><span class="op" id="2287483">(</span><span class="ident" id="2287484">old</span>&nbsp;<span class="ident" id="2287488">ssave</span><span class="op" id="2287493">)</span>&nbsp;<span class="op" id="2287495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2287498">//&nbsp;If&nbsp;it&nbsp;was&nbsp;used&nbsp;recursively,&nbsp;just&nbsp;restore&nbsp;the&nbsp;old&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287558">if</span>&nbsp;<span class="ident" id="2287561">old</span><span class="op" id="2287564">.</span><span class="ident" id="2287565">validSave</span>&nbsp;<span class="op" id="2287575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287579">s</span><span class="op" id="2287580">.</span><span class="ident" id="2287581">ssave</span>&nbsp;<span class="op" id="2287587">=</span>&nbsp;<span class="ident" id="2287589">old</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287595">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2287603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2287606">//&nbsp;Don&#39;t&nbsp;hold&nbsp;on&nbsp;to&nbsp;ss&nbsp;structs&nbsp;with&nbsp;large&nbsp;buffers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287658">if</span>&nbsp;<span class="builtinfunc" id="2287661">cap</span><span class="op" id="2287664">(</span><span class="ident" id="2287665">s</span><span class="op" id="2287666">.</span><span class="ident" id="2287667">buf</span><span class="op" id="2287670">)</span>&nbsp;<span class="op" id="2287672">&gt;</span>&nbsp;<span class="num" id="2287674">1024</span>&nbsp;<span class="op" id="2287679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287683">return</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2287691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287694">s</span><span class="op" id="2287695">.</span><span class="ident" id="2287696">buf</span>&nbsp;<span class="op" id="2287700">=</span>&nbsp;<span class="ident" id="2287702">s</span><span class="op" id="2287703">.</span><span class="ident" id="2287704">buf</span><span class="op" id="2287707">[</span><span class="op" id="2287708">:</span><span class="num" id="2287709">0</span><span class="op" id="2287710">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287713">s</span><span class="op" id="2287714">.</span><span class="ident" id="2287715">rr</span>&nbsp;<span class="op" id="2287718">=</span>&nbsp;<span class="ident" id="2287720">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287725">ssFree</span><span class="op" id="2287731">.</span><span class="ident" id="2287732">Put</span><span class="op" id="2287735">(</span><span class="ident" id="2287736">s</span><span class="op" id="2287737">)</span><br>
<span class="lineno"></span><span class="op" id="2287739">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="comment" id="2287742">//&nbsp;skipSpace&nbsp;skips&nbsp;spaces&nbsp;and&nbsp;maybe&nbsp;newlines.</span><br>
<span class="lineno"></span><span class="keyword" id="2287788">func</span>&nbsp;<span class="op" id="2287793">(</span><span class="ident" id="2287794">s</span>&nbsp;<span class="op" id="2287796">*</span><span class="ident" id="2287797">ss</span><span class="op" id="2287799">)</span>&nbsp;<span class="ident" id="2287801">skipSpace</span><span class="op" id="2287810">(</span><span class="ident" id="2287811">stopAtNewline</span>&nbsp;<span class="builtintype" id="2287825">bool</span><span class="op" id="2287829">)</span>&nbsp;<span class="op" id="2287831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287834">for</span>&nbsp;<span class="op" id="2287838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2287842">r</span>&nbsp;<span class="op" id="2287844">:=</span>&nbsp;<span class="ident" id="2287847">s</span><span class="op" id="2287848">.</span><span class="ident" id="2287849">getRune</span><span class="op" id="2287856">(</span><span class="op" id="2287857">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287861">if</span>&nbsp;<span class="ident" id="2287864">r</span>&nbsp;<span class="op" id="2287866">==</span>&nbsp;<span class="ident" id="2287869">eof</span>&nbsp;<span class="op" id="2287873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287878">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2287887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287891">if</span>&nbsp;<span class="ident" id="2287894">r</span>&nbsp;<span class="op" id="2287896">==</span>&nbsp;<span class="string" id="2287899">&#39;\r&#39;</span>&nbsp;<span class="op" id="2287904">&amp;&amp;</span>&nbsp;<span class="ident" id="2287907">s</span><span class="op" id="2287908">.</span><span class="ident" id="2287909">peek</span><span class="op" id="2287913">(</span><span class="string" id="2287914">&#34;\n&#34;</span><span class="op" id="2287918">)</span>&nbsp;<span class="op" id="2287920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287925">continue</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2287936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287940">if</span>&nbsp;<span class="ident" id="2287943">r</span>&nbsp;<span class="op" id="2287945">==</span>&nbsp;<span class="string" id="2287948">&#39;\n&#39;</span>&nbsp;<span class="op" id="2287953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287958">if</span>&nbsp;<span class="ident" id="2287961">stopAtNewline</span>&nbsp;<span class="op" id="2287975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287981">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2287990">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2287995">if</span>&nbsp;<span class="ident" id="2287998">s</span><span class="op" id="2287999">.</span><span class="ident" id="2288000">nlIsSpace</span>&nbsp;<span class="op" id="2288010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288016">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2288028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2288033">s</span><span class="op" id="2288034">.</span><span class="ident" id="2288035">errorString</span><span class="op" id="2288046">(</span><span class="string" id="2288047">&#34;unexpected&nbsp;newline&#34;</span><span class="op" id="2288067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288072">return</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2288081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288085">if</span>&nbsp;<span class="op" id="2288088">!</span><span class="ident" id="2288089">isSpace</span><span class="op" id="2288096">(</span><span class="ident" id="2288097">r</span><span class="op" id="2288098">)</span>&nbsp;<span class="op" id="2288100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2288105">s</span><span class="op" id="2288106">.</span><span class="ident" id="2288107">UnreadRune</span><span class="op" id="2288117">(</span><span class="op" id="2288118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288123">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2288131">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2288134">}</span><br>
<span class="lineno"></span><span class="op" id="2288136">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2288139">//&nbsp;token&nbsp;returns&nbsp;the&nbsp;next&nbsp;space-delimited&nbsp;string&nbsp;from&nbsp;the&nbsp;input.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="2288208">//&nbsp;skips&nbsp;white&nbsp;space.&nbsp;&nbsp;For&nbsp;Scanln,&nbsp;it&nbsp;stops&nbsp;at&nbsp;newlines.&nbsp;&nbsp;For&nbsp;Scan,</span><br>
<span class="lineno">465</span><span class="comment" id="2288276">//&nbsp;newlines&nbsp;are&nbsp;treated&nbsp;as&nbsp;spaces.</span><br>
<span class="lineno"></span><span class="keyword" id="2288311">func</span>&nbsp;<span class="op" id="2288316">(</span><span class="ident" id="2288317">s</span>&nbsp;<span class="op" id="2288319">*</span><span class="ident" id="2288320">ss</span><span class="op" id="2288322">)</span>&nbsp;<span class="ident" id="2288324">token</span><span class="op" id="2288329">(</span><span class="ident" id="2288330">skipSpace</span>&nbsp;<span class="builtintype" id="2288340">bool</span><span class="op" id="2288344">,</span>&nbsp;<span class="ident" id="2288346">f</span>&nbsp;<span class="keyword" id="2288348">func</span><span class="op" id="2288352">(</span><span class="builtintype" id="2288353">rune</span><span class="op" id="2288357">)</span>&nbsp;<span class="builtintype" id="2288359">bool</span><span class="op" id="2288363">)</span>&nbsp;<span class="op" id="2288365">[</span><span class="op" id="2288366">]</span><span class="builtintype" id="2288367">byte</span>&nbsp;<span class="op" id="2288372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288375">if</span>&nbsp;<span class="ident" id="2288378">skipSpace</span>&nbsp;<span class="op" id="2288388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2288392">s</span><span class="op" id="2288393">.</span><span class="ident" id="2288394">skipSpace</span><span class="op" id="2288403">(</span><span class="builtintype" id="2288404">false</span><span class="op" id="2288409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2288412">}</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2288415">//&nbsp;read&nbsp;until&nbsp;white&nbsp;space&nbsp;or&nbsp;newline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288453">for</span>&nbsp;<span class="op" id="2288457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2288461">r</span>&nbsp;<span class="op" id="2288463">:=</span>&nbsp;<span class="ident" id="2288466">s</span><span class="op" id="2288467">.</span><span class="ident" id="2288468">getRune</span><span class="op" id="2288475">(</span><span class="op" id="2288476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288480">if</span>&nbsp;<span class="ident" id="2288483">r</span>&nbsp;<span class="op" id="2288485">==</span>&nbsp;<span class="ident" id="2288488">eof</span>&nbsp;<span class="op" id="2288492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288497">break</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2288505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288509">if</span>&nbsp;<span class="op" id="2288512">!</span><span class="ident" id="2288513">f</span><span class="op" id="2288514">(</span><span class="ident" id="2288515">r</span><span class="op" id="2288516">)</span>&nbsp;<span class="op" id="2288518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2288523">s</span><span class="op" id="2288524">.</span><span class="ident" id="2288525">UnreadRune</span><span class="op" id="2288535">(</span><span class="op" id="2288536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288541">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2288549">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2288553">s</span><span class="op" id="2288554">.</span><span class="ident" id="2288555">buf</span><span class="op" id="2288558">.</span><span class="ident" id="2288559">WriteRune</span><span class="op" id="2288568">(</span><span class="ident" id="2288569">r</span><span class="op" id="2288570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2288573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288576">return</span>&nbsp;<span class="ident" id="2288583">s</span><span class="op" id="2288584">.</span><span class="ident" id="2288585">buf</span><br>
<span class="lineno"></span><span class="op" id="2288589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="keyword" id="2288592">var</span>&nbsp;<span class="ident" id="2288596">complexError</span>&nbsp;<span class="op" id="2288609">=</span>&nbsp;<span class="ident" id="2288611">errors</span><span class="op" id="2288617">.</span><span class="ident" id="2288618">New</span><span class="op" id="2288621">(</span><span class="string" id="2288622">&#34;syntax&nbsp;error&nbsp;scanning&nbsp;complex&nbsp;number&#34;</span><span class="op" id="2288660">)</span><br>
<span class="lineno"></span><span class="keyword" id="2288662">var</span>&nbsp;<span class="ident" id="2288666">boolError</span>&nbsp;<span class="op" id="2288676">=</span>&nbsp;<span class="ident" id="2288678">errors</span><span class="op" id="2288684">.</span><span class="ident" id="2288685">New</span><span class="op" id="2288688">(</span><span class="string" id="2288689">&#34;syntax&nbsp;error&nbsp;scanning&nbsp;boolean&#34;</span><span class="op" id="2288720">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2288723">func</span>&nbsp;<span class="ident" id="2288728">indexRune</span><span class="op" id="2288737">(</span><span class="ident" id="2288738">s</span>&nbsp;<span class="builtintype" id="2288740">string</span><span class="op" id="2288746">,</span>&nbsp;<span class="ident" id="2288748">r</span>&nbsp;<span class="builtintype" id="2288750">rune</span><span class="op" id="2288754">)</span>&nbsp;<span class="builtintype" id="2288756">int</span>&nbsp;<span class="op" id="2288760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288763">for</span>&nbsp;<span class="ident" id="2288767">i</span><span class="op" id="2288768">,</span>&nbsp;<span class="ident" id="2288770">c</span>&nbsp;<span class="op" id="2288772">:=</span>&nbsp;<span class="keyword" id="2288775">range</span>&nbsp;<span class="ident" id="2288781">s</span>&nbsp;<span class="op" id="2288783">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288787">if</span>&nbsp;<span class="ident" id="2288790">c</span>&nbsp;<span class="op" id="2288792">==</span>&nbsp;<span class="ident" id="2288795">r</span>&nbsp;<span class="op" id="2288797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288802">return</span>&nbsp;<span class="ident" id="2288809">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2288813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2288816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2288819">return</span>&nbsp;<span class="op" id="2288826">-</span><span class="num" id="2288827">1</span><br>
<span class="lineno">495</span><span class="op" id="2288829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2288832">//&nbsp;consume&nbsp;reads&nbsp;the&nbsp;next&nbsp;rune&nbsp;in&nbsp;the&nbsp;input&nbsp;and&nbsp;reports&nbsp;whether&nbsp;it&nbsp;is&nbsp;in&nbsp;the&nbsp;ok&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2288920">//&nbsp;If&nbsp;accept&nbsp;is&nbsp;true,&nbsp;it&nbsp;puts&nbsp;the&nbsp;character&nbsp;into&nbsp;the&nbsp;input&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="2288986">func</span>&nbsp;<span class="op" id="2288991">(</span><span class="ident" id="2288992">s</span>&nbsp;<span class="op" id="2288994">*</span><span class="ident" id="2288995">ss</span><span class="op" id="2288997">)</span>&nbsp;<span class="ident" id="2288999">consume</span><span class="op" id="2289006">(</span><span class="ident" id="2289007">ok</span>&nbsp;<span class="builtintype" id="2289010">string</span><span class="op" id="2289016">,</span>&nbsp;<span class="ident" id="2289018">accept</span>&nbsp;<span class="builtintype" id="2289025">bool</span><span class="op" id="2289029">)</span>&nbsp;<span class="builtintype" id="2289031">bool</span>&nbsp;<span class="op" id="2289036">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289039">r</span>&nbsp;<span class="op" id="2289041">:=</span>&nbsp;<span class="ident" id="2289044">s</span><span class="op" id="2289045">.</span><span class="ident" id="2289046">getRune</span><span class="op" id="2289053">(</span><span class="op" id="2289054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289057">if</span>&nbsp;<span class="ident" id="2289060">r</span>&nbsp;<span class="op" id="2289062">==</span>&nbsp;<span class="ident" id="2289065">eof</span>&nbsp;<span class="op" id="2289069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289073">return</span>&nbsp;<span class="builtintype" id="2289080">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2289087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289090">if</span>&nbsp;<span class="ident" id="2289093">indexRune</span><span class="op" id="2289102">(</span><span class="ident" id="2289103">ok</span><span class="op" id="2289105">,</span>&nbsp;<span class="ident" id="2289107">r</span><span class="op" id="2289108">)</span>&nbsp;<span class="op" id="2289110">&gt;=</span>&nbsp;<span class="num" id="2289113">0</span>&nbsp;<span class="op" id="2289115">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289119">if</span>&nbsp;<span class="ident" id="2289122">accept</span>&nbsp;<span class="op" id="2289129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289134">s</span><span class="op" id="2289135">.</span><span class="ident" id="2289136">buf</span><span class="op" id="2289139">.</span><span class="ident" id="2289140">WriteRune</span><span class="op" id="2289149">(</span><span class="ident" id="2289150">r</span><span class="op" id="2289151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2289155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289159">return</span>&nbsp;<span class="builtintype" id="2289166">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2289172">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289175">if</span>&nbsp;<span class="ident" id="2289178">r</span>&nbsp;<span class="op" id="2289180">!=</span>&nbsp;<span class="ident" id="2289183">eof</span>&nbsp;<span class="op" id="2289187">&amp;&amp;</span>&nbsp;<span class="ident" id="2289190">accept</span>&nbsp;<span class="op" id="2289197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289201">s</span><span class="op" id="2289202">.</span><span class="ident" id="2289203">UnreadRune</span><span class="op" id="2289213">(</span><span class="op" id="2289214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2289217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289220">return</span>&nbsp;<span class="builtintype" id="2289227">false</span><br>
<span class="lineno"></span><span class="op" id="2289233">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span><span class="comment" id="2289236">//&nbsp;peek&nbsp;reports&nbsp;whether&nbsp;the&nbsp;next&nbsp;character&nbsp;is&nbsp;in&nbsp;the&nbsp;ok&nbsp;string,&nbsp;without&nbsp;consuming&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="2289322">func</span>&nbsp;<span class="op" id="2289327">(</span><span class="ident" id="2289328">s</span>&nbsp;<span class="op" id="2289330">*</span><span class="ident" id="2289331">ss</span><span class="op" id="2289333">)</span>&nbsp;<span class="ident" id="2289335">peek</span><span class="op" id="2289339">(</span><span class="ident" id="2289340">ok</span>&nbsp;<span class="builtintype" id="2289343">string</span><span class="op" id="2289349">)</span>&nbsp;<span class="builtintype" id="2289351">bool</span>&nbsp;<span class="op" id="2289356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289359">r</span>&nbsp;<span class="op" id="2289361">:=</span>&nbsp;<span class="ident" id="2289364">s</span><span class="op" id="2289365">.</span><span class="ident" id="2289366">getRune</span><span class="op" id="2289373">(</span><span class="op" id="2289374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289377">if</span>&nbsp;<span class="ident" id="2289380">r</span>&nbsp;<span class="op" id="2289382">!=</span>&nbsp;<span class="ident" id="2289385">eof</span>&nbsp;<span class="op" id="2289389">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289393">s</span><span class="op" id="2289394">.</span><span class="ident" id="2289395">UnreadRune</span><span class="op" id="2289405">(</span><span class="op" id="2289406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2289409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289412">return</span>&nbsp;<span class="ident" id="2289419">indexRune</span><span class="op" id="2289428">(</span><span class="ident" id="2289429">ok</span><span class="op" id="2289431">,</span>&nbsp;<span class="ident" id="2289433">r</span><span class="op" id="2289434">)</span>&nbsp;<span class="op" id="2289436">&gt;=</span>&nbsp;<span class="num" id="2289439">0</span><br>
<span class="lineno"></span><span class="op" id="2289441">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="keyword" id="2289444">func</span>&nbsp;<span class="op" id="2289449">(</span><span class="ident" id="2289450">s</span>&nbsp;<span class="op" id="2289452">*</span><span class="ident" id="2289453">ss</span><span class="op" id="2289455">)</span>&nbsp;<span class="ident" id="2289457">notEOF</span><span class="op" id="2289463">(</span><span class="op" id="2289464">)</span>&nbsp;<span class="op" id="2289466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2289469">//&nbsp;Guarantee&nbsp;there&nbsp;is&nbsp;data&nbsp;to&nbsp;be&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289509">if</span>&nbsp;<span class="ident" id="2289512">r</span>&nbsp;<span class="op" id="2289514">:=</span>&nbsp;<span class="ident" id="2289517">s</span><span class="op" id="2289518">.</span><span class="ident" id="2289519">getRune</span><span class="op" id="2289526">(</span><span class="op" id="2289527">)</span><span class="op" id="2289528">;</span>&nbsp;<span class="ident" id="2289530">r</span>&nbsp;<span class="op" id="2289532">==</span>&nbsp;<span class="ident" id="2289535">eof</span>&nbsp;<span class="op" id="2289539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2289543">panic</span><span class="op" id="2289548">(</span><span class="ident" id="2289549">io</span><span class="op" id="2289551">.</span><span class="ident" id="2289552">EOF</span><span class="op" id="2289555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2289558">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2289561">s</span><span class="op" id="2289562">.</span><span class="ident" id="2289563">UnreadRune</span><span class="op" id="2289573">(</span><span class="op" id="2289574">)</span><br>
<span class="lineno"></span><span class="op" id="2289576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2289579">//&nbsp;accept&nbsp;checks&nbsp;the&nbsp;next&nbsp;rune&nbsp;in&nbsp;the&nbsp;input.&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;byte&nbsp;(sic)&nbsp;in&nbsp;the&nbsp;string,&nbsp;it&nbsp;puts&nbsp;it&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2289679">//&nbsp;buffer&nbsp;and&nbsp;returns&nbsp;true.&nbsp;Otherwise&nbsp;it&nbsp;return&nbsp;false.</span><br>
<span class="lineno">535</span><span class="keyword" id="2289734">func</span>&nbsp;<span class="op" id="2289739">(</span><span class="ident" id="2289740">s</span>&nbsp;<span class="op" id="2289742">*</span><span class="ident" id="2289743">ss</span><span class="op" id="2289745">)</span>&nbsp;<span class="ident" id="2289747">accept</span><span class="op" id="2289753">(</span><span class="ident" id="2289754">ok</span>&nbsp;<span class="builtintype" id="2289757">string</span><span class="op" id="2289763">)</span>&nbsp;<span class="builtintype" id="2289765">bool</span>&nbsp;<span class="op" id="2289770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289773">return</span>&nbsp;<span class="ident" id="2289780">s</span><span class="op" id="2289781">.</span><span class="ident" id="2289782">consume</span><span class="op" id="2289789">(</span><span class="ident" id="2289790">ok</span><span class="op" id="2289792">,</span>&nbsp;<span class="builtintype" id="2289794">true</span><span class="op" id="2289798">)</span><br>
<span class="lineno"></span><span class="op" id="2289800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2289803">//&nbsp;okVerb&nbsp;verifies&nbsp;that&nbsp;the&nbsp;verb&nbsp;is&nbsp;present&nbsp;in&nbsp;the&nbsp;list,&nbsp;setting&nbsp;s.err&nbsp;appropriately&nbsp;if&nbsp;not.</span><br>
<span class="lineno">540</span><span class="keyword" id="2289896">func</span>&nbsp;<span class="op" id="2289901">(</span><span class="ident" id="2289902">s</span>&nbsp;<span class="op" id="2289904">*</span><span class="ident" id="2289905">ss</span><span class="op" id="2289907">)</span>&nbsp;<span class="ident" id="2289909">okVerb</span><span class="op" id="2289915">(</span><span class="ident" id="2289916">verb</span>&nbsp;<span class="builtintype" id="2289921">rune</span><span class="op" id="2289925">,</span>&nbsp;<span class="ident" id="2289927">okVerbs</span><span class="op" id="2289934">,</span>&nbsp;<span class="ident" id="2289936">typ</span>&nbsp;<span class="builtintype" id="2289940">string</span><span class="op" id="2289946">)</span>&nbsp;<span class="builtintype" id="2289948">bool</span>&nbsp;<span class="op" id="2289953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289956">for</span>&nbsp;<span class="ident" id="2289960">_</span><span class="op" id="2289961">,</span>&nbsp;<span class="ident" id="2289963">v</span>&nbsp;<span class="op" id="2289965">:=</span>&nbsp;<span class="keyword" id="2289968">range</span>&nbsp;<span class="ident" id="2289974">okVerbs</span>&nbsp;<span class="op" id="2289982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2289986">if</span>&nbsp;<span class="ident" id="2289989">v</span>&nbsp;<span class="op" id="2289991">==</span>&nbsp;<span class="ident" id="2289994">verb</span>&nbsp;<span class="op" id="2289999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290004">return</span>&nbsp;<span class="builtintype" id="2290011">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2290018">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2290021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290024">s</span><span class="op" id="2290025">.</span><span class="ident" id="2290026">errorString</span><span class="op" id="2290037">(</span><span class="string" id="2290038">&#34;bad&nbsp;verb&nbsp;%&#34;</span>&nbsp;<span class="op" id="2290051">+</span>&nbsp;<span class="builtintype" id="2290053">string</span><span class="op" id="2290059">(</span><span class="ident" id="2290060">verb</span><span class="op" id="2290064">)</span>&nbsp;<span class="op" id="2290066">+</span>&nbsp;<span class="string" id="2290068">&#34;&nbsp;for&nbsp;&#34;</span>&nbsp;<span class="op" id="2290076">+</span>&nbsp;<span class="ident" id="2290078">typ</span><span class="op" id="2290081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290084">return</span>&nbsp;<span class="builtintype" id="2290091">false</span><br>
<span class="lineno"></span><span class="op" id="2290097">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span><span class="comment" id="2290100">//&nbsp;scanBool&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;boolean&nbsp;represented&nbsp;by&nbsp;the&nbsp;next&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="2290176">func</span>&nbsp;<span class="op" id="2290181">(</span><span class="ident" id="2290182">s</span>&nbsp;<span class="op" id="2290184">*</span><span class="ident" id="2290185">ss</span><span class="op" id="2290187">)</span>&nbsp;<span class="ident" id="2290189">scanBool</span><span class="op" id="2290197">(</span><span class="ident" id="2290198">verb</span>&nbsp;<span class="builtintype" id="2290203">rune</span><span class="op" id="2290207">)</span>&nbsp;<span class="builtintype" id="2290209">bool</span>&nbsp;<span class="op" id="2290214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290217">s</span><span class="op" id="2290218">.</span><span class="ident" id="2290219">skipSpace</span><span class="op" id="2290228">(</span><span class="builtintype" id="2290229">false</span><span class="op" id="2290234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290237">s</span><span class="op" id="2290238">.</span><span class="ident" id="2290239">notEOF</span><span class="op" id="2290245">(</span><span class="op" id="2290246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290249">if</span>&nbsp;<span class="op" id="2290252">!</span><span class="ident" id="2290253">s</span><span class="op" id="2290254">.</span><span class="ident" id="2290255">okVerb</span><span class="op" id="2290261">(</span><span class="ident" id="2290262">verb</span><span class="op" id="2290266">,</span>&nbsp;<span class="string" id="2290268">&#34;tv&#34;</span><span class="op" id="2290272">,</span>&nbsp;<span class="string" id="2290274">&#34;boolean&#34;</span><span class="op" id="2290283">)</span>&nbsp;<span class="op" id="2290285">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290289">return</span>&nbsp;<span class="builtintype" id="2290296">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2290303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2290306">//&nbsp;Syntax-checking&nbsp;a&nbsp;boolean&nbsp;is&nbsp;annoying.&nbsp;&nbsp;We&#39;re&nbsp;not&nbsp;fastidious&nbsp;about&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290383">switch</span>&nbsp;<span class="ident" id="2290390">s</span><span class="op" id="2290391">.</span><span class="ident" id="2290392">getRune</span><span class="op" id="2290399">(</span><span class="op" id="2290400">)</span>&nbsp;<span class="op" id="2290402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290405">case</span>&nbsp;<span class="string" id="2290410">&#39;0&#39;</span><span class="op" id="2290413">:</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290417">return</span>&nbsp;<span class="builtintype" id="2290424">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290431">case</span>&nbsp;<span class="string" id="2290436">&#39;1&#39;</span><span class="op" id="2290439">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290443">return</span>&nbsp;<span class="builtintype" id="2290450">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290456">case</span>&nbsp;<span class="string" id="2290461">&#39;t&#39;</span><span class="op" id="2290464">,</span>&nbsp;<span class="string" id="2290466">&#39;T&#39;</span><span class="op" id="2290469">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290473">if</span>&nbsp;<span class="ident" id="2290476">s</span><span class="op" id="2290477">.</span><span class="ident" id="2290478">accept</span><span class="op" id="2290484">(</span><span class="string" id="2290485">&#34;rR&#34;</span><span class="op" id="2290489">)</span>&nbsp;<span class="op" id="2290491">&amp;&amp;</span>&nbsp;<span class="op" id="2290494">(</span><span class="op" id="2290495">!</span><span class="ident" id="2290496">s</span><span class="op" id="2290497">.</span><span class="ident" id="2290498">accept</span><span class="op" id="2290504">(</span><span class="string" id="2290505">&#34;uU&#34;</span><span class="op" id="2290509">)</span>&nbsp;<span class="op" id="2290511">||</span>&nbsp;<span class="op" id="2290514">!</span><span class="ident" id="2290515">s</span><span class="op" id="2290516">.</span><span class="ident" id="2290517">accept</span><span class="op" id="2290523">(</span><span class="string" id="2290524">&#34;eE&#34;</span><span class="op" id="2290528">)</span><span class="op" id="2290529">)</span>&nbsp;<span class="op" id="2290531">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290536">s</span><span class="op" id="2290537">.</span><span class="builtintype" id="2290538">error</span><span class="op" id="2290543">(</span><span class="ident" id="2290544">boolError</span><span class="op" id="2290553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2290557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290561">return</span>&nbsp;<span class="builtintype" id="2290568">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290574">case</span>&nbsp;<span class="string" id="2290579">&#39;f&#39;</span><span class="op" id="2290582">,</span>&nbsp;<span class="string" id="2290584">&#39;F&#39;</span><span class="op" id="2290587">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290591">if</span>&nbsp;<span class="ident" id="2290594">s</span><span class="op" id="2290595">.</span><span class="ident" id="2290596">accept</span><span class="op" id="2290602">(</span><span class="string" id="2290603">&#34;aA&#34;</span><span class="op" id="2290607">)</span>&nbsp;<span class="op" id="2290609">&amp;&amp;</span>&nbsp;<span class="op" id="2290612">(</span><span class="op" id="2290613">!</span><span class="ident" id="2290614">s</span><span class="op" id="2290615">.</span><span class="ident" id="2290616">accept</span><span class="op" id="2290622">(</span><span class="string" id="2290623">&#34;lL&#34;</span><span class="op" id="2290627">)</span>&nbsp;<span class="op" id="2290629">||</span>&nbsp;<span class="op" id="2290632">!</span><span class="ident" id="2290633">s</span><span class="op" id="2290634">.</span><span class="ident" id="2290635">accept</span><span class="op" id="2290641">(</span><span class="string" id="2290642">&#34;sS&#34;</span><span class="op" id="2290646">)</span>&nbsp;<span class="op" id="2290648">||</span>&nbsp;<span class="op" id="2290651">!</span><span class="ident" id="2290652">s</span><span class="op" id="2290653">.</span><span class="ident" id="2290654">accept</span><span class="op" id="2290660">(</span><span class="string" id="2290661">&#34;eE&#34;</span><span class="op" id="2290665">)</span><span class="op" id="2290666">)</span>&nbsp;<span class="op" id="2290668">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290673">s</span><span class="op" id="2290674">.</span><span class="builtintype" id="2290675">error</span><span class="op" id="2290680">(</span><span class="ident" id="2290681">boolError</span><span class="op" id="2290690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2290694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290698">return</span>&nbsp;<span class="builtintype" id="2290705">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2290712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2290715">return</span>&nbsp;<span class="builtintype" id="2290722">false</span><br>
<span class="lineno">575</span><span class="op" id="2290728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2290731">//&nbsp;Numerical&nbsp;elements</span><br>
<span class="lineno"></span><span class="keyword" id="2290753">const</span>&nbsp;<span class="op" id="2290759">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290762">binaryDigits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2290780">=</span>&nbsp;<span class="string" id="2290782">&#34;01&#34;</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290788">octalDigits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2290806">=</span>&nbsp;<span class="string" id="2290808">&#34;01234567&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290820">decimalDigits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2290838">=</span>&nbsp;<span class="string" id="2290840">&#34;0123456789&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290854">hexadecimalDigits</span>&nbsp;<span class="op" id="2290872">=</span>&nbsp;<span class="string" id="2290874">&#34;0123456789aAbBcCdDeEfF&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290900">sign</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2290918">=</span>&nbsp;<span class="string" id="2290920">&#34;+-&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290926">period</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2290944">=</span>&nbsp;<span class="string" id="2290946">&#34;.&#34;</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2290951">exponent</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2290969">=</span>&nbsp;<span class="string" id="2290971">&#34;eEp&#34;</span><br>
<span class="lineno"></span><span class="op" id="2290977">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2290980">//&nbsp;getBase&nbsp;returns&nbsp;the&nbsp;numeric&nbsp;base&nbsp;represented&nbsp;by&nbsp;the&nbsp;verb&nbsp;and&nbsp;its&nbsp;digit&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2291062">func</span>&nbsp;<span class="op" id="2291067">(</span><span class="ident" id="2291068">s</span>&nbsp;<span class="op" id="2291070">*</span><span class="ident" id="2291071">ss</span><span class="op" id="2291073">)</span>&nbsp;<span class="ident" id="2291075">getBase</span><span class="op" id="2291082">(</span><span class="ident" id="2291083">verb</span>&nbsp;<span class="builtintype" id="2291088">rune</span><span class="op" id="2291092">)</span>&nbsp;<span class="op" id="2291094">(</span><span class="ident" id="2291095">base</span>&nbsp;<span class="builtintype" id="2291100">int</span><span class="op" id="2291103">,</span>&nbsp;<span class="ident" id="2291105">digits</span>&nbsp;<span class="builtintype" id="2291112">string</span><span class="op" id="2291118">)</span>&nbsp;<span class="op" id="2291120">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291123">s</span><span class="op" id="2291124">.</span><span class="ident" id="2291125">okVerb</span><span class="op" id="2291131">(</span><span class="ident" id="2291132">verb</span><span class="op" id="2291136">,</span>&nbsp;<span class="string" id="2291138">&#34;bdoUxXv&#34;</span><span class="op" id="2291147">,</span>&nbsp;<span class="string" id="2291149">&#34;integer&#34;</span><span class="op" id="2291158">)</span>&nbsp;<span class="comment" id="2291160">//&nbsp;sets&nbsp;s.err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291175">base</span>&nbsp;<span class="op" id="2291180">=</span>&nbsp;<span class="num" id="2291182">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291186">digits</span>&nbsp;<span class="op" id="2291193">=</span>&nbsp;<span class="ident" id="2291195">decimalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291210">switch</span>&nbsp;<span class="ident" id="2291217">verb</span>&nbsp;<span class="op" id="2291222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291225">case</span>&nbsp;<span class="string" id="2291230">&#39;b&#39;</span><span class="op" id="2291233">:</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291237">base</span>&nbsp;<span class="op" id="2291242">=</span>&nbsp;<span class="num" id="2291244">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291248">digits</span>&nbsp;<span class="op" id="2291255">=</span>&nbsp;<span class="ident" id="2291257">binaryDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291271">case</span>&nbsp;<span class="string" id="2291276">&#39;o&#39;</span><span class="op" id="2291279">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291283">base</span>&nbsp;<span class="op" id="2291288">=</span>&nbsp;<span class="num" id="2291290">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291294">digits</span>&nbsp;<span class="op" id="2291301">=</span>&nbsp;<span class="ident" id="2291303">octalDigits</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291316">case</span>&nbsp;<span class="string" id="2291321">&#39;x&#39;</span><span class="op" id="2291324">,</span>&nbsp;<span class="string" id="2291326">&#39;X&#39;</span><span class="op" id="2291329">,</span>&nbsp;<span class="string" id="2291331">&#39;U&#39;</span><span class="op" id="2291334">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291338">base</span>&nbsp;<span class="op" id="2291343">=</span>&nbsp;<span class="num" id="2291345">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291350">digits</span>&nbsp;<span class="op" id="2291357">=</span>&nbsp;<span class="ident" id="2291359">hexadecimalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2291378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291381">return</span><br>
<span class="lineno">605</span><span class="op" id="2291388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2291391">//&nbsp;scanNumber&nbsp;returns&nbsp;the&nbsp;numerical&nbsp;string&nbsp;with&nbsp;specified&nbsp;digits&nbsp;starting&nbsp;here.</span><br>
<span class="lineno"></span><span class="keyword" id="2291471">func</span>&nbsp;<span class="op" id="2291476">(</span><span class="ident" id="2291477">s</span>&nbsp;<span class="op" id="2291479">*</span><span class="ident" id="2291480">ss</span><span class="op" id="2291482">)</span>&nbsp;<span class="ident" id="2291484">scanNumber</span><span class="op" id="2291494">(</span><span class="ident" id="2291495">digits</span>&nbsp;<span class="builtintype" id="2291502">string</span><span class="op" id="2291508">,</span>&nbsp;<span class="ident" id="2291510">haveDigits</span>&nbsp;<span class="builtintype" id="2291521">bool</span><span class="op" id="2291525">)</span>&nbsp;<span class="builtintype" id="2291527">string</span>&nbsp;<span class="op" id="2291534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291537">if</span>&nbsp;<span class="op" id="2291540">!</span><span class="ident" id="2291541">haveDigits</span>&nbsp;<span class="op" id="2291552">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291556">s</span><span class="op" id="2291557">.</span><span class="ident" id="2291558">notEOF</span><span class="op" id="2291564">(</span><span class="op" id="2291565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291569">if</span>&nbsp;<span class="op" id="2291572">!</span><span class="ident" id="2291573">s</span><span class="op" id="2291574">.</span><span class="ident" id="2291575">accept</span><span class="op" id="2291581">(</span><span class="ident" id="2291582">digits</span><span class="op" id="2291588">)</span>&nbsp;<span class="op" id="2291590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291595">s</span><span class="op" id="2291596">.</span><span class="ident" id="2291597">errorString</span><span class="op" id="2291608">(</span><span class="string" id="2291609">&#34;expected&nbsp;integer&#34;</span><span class="op" id="2291627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2291631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2291634">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291637">for</span>&nbsp;<span class="ident" id="2291641">s</span><span class="op" id="2291642">.</span><span class="ident" id="2291643">accept</span><span class="op" id="2291649">(</span><span class="ident" id="2291650">digits</span><span class="op" id="2291656">)</span>&nbsp;<span class="op" id="2291658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2291661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291664">return</span>&nbsp;<span class="builtintype" id="2291671">string</span><span class="op" id="2291677">(</span><span class="ident" id="2291678">s</span><span class="op" id="2291679">.</span><span class="ident" id="2291680">buf</span><span class="op" id="2291683">)</span><br>
<span class="lineno"></span><span class="op" id="2291685">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">620</span><span class="comment" id="2291688">//&nbsp;scanRune&nbsp;returns&nbsp;the&nbsp;next&nbsp;rune&nbsp;value&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="keyword" id="2291742">func</span>&nbsp;<span class="op" id="2291747">(</span><span class="ident" id="2291748">s</span>&nbsp;<span class="op" id="2291750">*</span><span class="ident" id="2291751">ss</span><span class="op" id="2291753">)</span>&nbsp;<span class="ident" id="2291755">scanRune</span><span class="op" id="2291763">(</span><span class="ident" id="2291764">bitSize</span>&nbsp;<span class="builtintype" id="2291772">int</span><span class="op" id="2291775">)</span>&nbsp;<span class="ident" id="2291777">int64</span>&nbsp;<span class="op" id="2291783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291786">s</span><span class="op" id="2291787">.</span><span class="ident" id="2291788">notEOF</span><span class="op" id="2291794">(</span><span class="op" id="2291795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291798">r</span>&nbsp;<span class="op" id="2291800">:=</span>&nbsp;<span class="ident" id="2291803">int64</span><span class="op" id="2291808">(</span><span class="ident" id="2291809">s</span><span class="op" id="2291810">.</span><span class="ident" id="2291811">getRune</span><span class="op" id="2291818">(</span><span class="op" id="2291819">)</span><span class="op" id="2291820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291823">n</span>&nbsp;<span class="op" id="2291825">:=</span>&nbsp;<span class="builtintype" id="2291828">uint</span><span class="op" id="2291832">(</span><span class="ident" id="2291833">bitSize</span><span class="op" id="2291840">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291843">x</span>&nbsp;<span class="op" id="2291845">:=</span>&nbsp;<span class="op" id="2291848">(</span><span class="ident" id="2291849">r</span>&nbsp;<span class="op" id="2291851">&lt;&lt;</span>&nbsp;<span class="op" id="2291854">(</span><span class="num" id="2291855">64</span>&nbsp;<span class="op" id="2291858">-</span>&nbsp;<span class="ident" id="2291860">n</span><span class="op" id="2291861">)</span><span class="op" id="2291862">)</span>&nbsp;<span class="op" id="2291864">&gt;&gt;</span>&nbsp;<span class="op" id="2291867">(</span><span class="num" id="2291868">64</span>&nbsp;<span class="op" id="2291871">-</span>&nbsp;<span class="ident" id="2291873">n</span><span class="op" id="2291874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291877">if</span>&nbsp;<span class="ident" id="2291880">x</span>&nbsp;<span class="op" id="2291882">!=</span>&nbsp;<span class="ident" id="2291885">r</span>&nbsp;<span class="op" id="2291887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2291891">s</span><span class="op" id="2291892">.</span><span class="ident" id="2291893">errorString</span><span class="op" id="2291904">(</span><span class="string" id="2291905">&#34;overflow&nbsp;on&nbsp;character&nbsp;value&nbsp;&#34;</span>&nbsp;<span class="op" id="2291936">+</span>&nbsp;<span class="builtintype" id="2291938">string</span><span class="op" id="2291944">(</span><span class="ident" id="2291945">r</span><span class="op" id="2291946">)</span><span class="op" id="2291947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2291950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2291953">return</span>&nbsp;<span class="ident" id="2291960">r</span><br>
<span class="lineno">630</span><span class="op" id="2291962">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2291965">//&nbsp;scanBasePrefix&nbsp;reports&nbsp;whether&nbsp;the&nbsp;integer&nbsp;begins&nbsp;with&nbsp;a&nbsp;0&nbsp;or&nbsp;0x,</span><br>
<span class="lineno"></span><span class="comment" id="2292034">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;base,&nbsp;digit&nbsp;string,&nbsp;and&nbsp;whether&nbsp;a&nbsp;zero&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="comment" id="2292103">//&nbsp;It&nbsp;is&nbsp;called&nbsp;only&nbsp;if&nbsp;the&nbsp;verb&nbsp;is&nbsp;%v.</span><br>
<span class="lineno">635</span><span class="keyword" id="2292143">func</span>&nbsp;<span class="op" id="2292148">(</span><span class="ident" id="2292149">s</span>&nbsp;<span class="op" id="2292151">*</span><span class="ident" id="2292152">ss</span><span class="op" id="2292154">)</span>&nbsp;<span class="ident" id="2292156">scanBasePrefix</span><span class="op" id="2292170">(</span><span class="op" id="2292171">)</span>&nbsp;<span class="op" id="2292173">(</span><span class="ident" id="2292174">base</span>&nbsp;<span class="builtintype" id="2292179">int</span><span class="op" id="2292182">,</span>&nbsp;<span class="ident" id="2292184">digits</span>&nbsp;<span class="builtintype" id="2292191">string</span><span class="op" id="2292197">,</span>&nbsp;<span class="ident" id="2292199">found</span>&nbsp;<span class="builtintype" id="2292205">bool</span><span class="op" id="2292209">)</span>&nbsp;<span class="op" id="2292211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292214">if</span>&nbsp;<span class="op" id="2292217">!</span><span class="ident" id="2292218">s</span><span class="op" id="2292219">.</span><span class="ident" id="2292220">peek</span><span class="op" id="2292224">(</span><span class="string" id="2292225">&#34;0&#34;</span><span class="op" id="2292228">)</span>&nbsp;<span class="op" id="2292230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292234">return</span>&nbsp;<span class="num" id="2292241">10</span><span class="op" id="2292243">,</span>&nbsp;<span class="ident" id="2292245">decimalDigits</span><span class="op" id="2292258">,</span>&nbsp;<span class="builtintype" id="2292260">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2292267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292270">s</span><span class="op" id="2292271">.</span><span class="ident" id="2292272">accept</span><span class="op" id="2292278">(</span><span class="string" id="2292279">&#34;0&#34;</span><span class="op" id="2292282">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292285">found</span>&nbsp;<span class="op" id="2292291">=</span>&nbsp;<span class="builtintype" id="2292293">true</span>&nbsp;<span class="comment" id="2292298">//&nbsp;We&#39;ve&nbsp;put&nbsp;a&nbsp;digit&nbsp;into&nbsp;the&nbsp;token&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2292343">//&nbsp;Special&nbsp;cases&nbsp;for&nbsp;&#39;0&#39;&nbsp;&amp;&amp;&nbsp;&#39;0x&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292377">base</span><span class="op" id="2292381">,</span>&nbsp;<span class="ident" id="2292383">digits</span>&nbsp;<span class="op" id="2292390">=</span>&nbsp;<span class="num" id="2292392">8</span><span class="op" id="2292393">,</span>&nbsp;<span class="ident" id="2292395">octalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292408">if</span>&nbsp;<span class="ident" id="2292411">s</span><span class="op" id="2292412">.</span><span class="ident" id="2292413">peek</span><span class="op" id="2292417">(</span><span class="string" id="2292418">&#34;xX&#34;</span><span class="op" id="2292422">)</span>&nbsp;<span class="op" id="2292424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292428">s</span><span class="op" id="2292429">.</span><span class="ident" id="2292430">consume</span><span class="op" id="2292437">(</span><span class="string" id="2292438">&#34;xX&#34;</span><span class="op" id="2292442">,</span>&nbsp;<span class="builtintype" id="2292444">false</span><span class="op" id="2292449">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292453">base</span><span class="op" id="2292457">,</span>&nbsp;<span class="ident" id="2292459">digits</span>&nbsp;<span class="op" id="2292466">=</span>&nbsp;<span class="num" id="2292468">16</span><span class="op" id="2292470">,</span>&nbsp;<span class="ident" id="2292472">hexadecimalDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2292491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292494">return</span><br>
<span class="lineno"></span><span class="op" id="2292501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="comment" id="2292504">//&nbsp;scanInt&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;integer&nbsp;represented&nbsp;by&nbsp;the&nbsp;next</span><br>
<span class="lineno"></span><span class="comment" id="2292572">//&nbsp;token,&nbsp;checking&nbsp;for&nbsp;overflow.&nbsp;&nbsp;Any&nbsp;error&nbsp;is&nbsp;stored&nbsp;in&nbsp;s.err.</span><br>
<span class="lineno"></span><span class="keyword" id="2292636">func</span>&nbsp;<span class="op" id="2292641">(</span><span class="ident" id="2292642">s</span>&nbsp;<span class="op" id="2292644">*</span><span class="ident" id="2292645">ss</span><span class="op" id="2292647">)</span>&nbsp;<span class="ident" id="2292649">scanInt</span><span class="op" id="2292656">(</span><span class="ident" id="2292657">verb</span>&nbsp;<span class="builtintype" id="2292662">rune</span><span class="op" id="2292666">,</span>&nbsp;<span class="ident" id="2292668">bitSize</span>&nbsp;<span class="builtintype" id="2292676">int</span><span class="op" id="2292679">)</span>&nbsp;<span class="ident" id="2292681">int64</span>&nbsp;<span class="op" id="2292687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292690">if</span>&nbsp;<span class="ident" id="2292693">verb</span>&nbsp;<span class="op" id="2292698">==</span>&nbsp;<span class="string" id="2292701">&#39;c&#39;</span>&nbsp;<span class="op" id="2292705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292709">return</span>&nbsp;<span class="ident" id="2292716">s</span><span class="op" id="2292717">.</span><span class="ident" id="2292718">scanRune</span><span class="op" id="2292726">(</span><span class="ident" id="2292727">bitSize</span><span class="op" id="2292734">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2292737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292740">s</span><span class="op" id="2292741">.</span><span class="ident" id="2292742">skipSpace</span><span class="op" id="2292751">(</span><span class="builtintype" id="2292752">false</span><span class="op" id="2292757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292760">s</span><span class="op" id="2292761">.</span><span class="ident" id="2292762">notEOF</span><span class="op" id="2292768">(</span><span class="op" id="2292769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292772">base</span><span class="op" id="2292776">,</span>&nbsp;<span class="ident" id="2292778">digits</span>&nbsp;<span class="op" id="2292785">:=</span>&nbsp;<span class="ident" id="2292788">s</span><span class="op" id="2292789">.</span><span class="ident" id="2292790">getBase</span><span class="op" id="2292797">(</span><span class="ident" id="2292798">verb</span><span class="op" id="2292802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292805">haveDigits</span>&nbsp;<span class="op" id="2292816">:=</span>&nbsp;<span class="builtintype" id="2292819">false</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292826">if</span>&nbsp;<span class="ident" id="2292829">verb</span>&nbsp;<span class="op" id="2292834">==</span>&nbsp;<span class="string" id="2292837">&#39;U&#39;</span>&nbsp;<span class="op" id="2292841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2292845">if</span>&nbsp;<span class="op" id="2292848">!</span><span class="ident" id="2292849">s</span><span class="op" id="2292850">.</span><span class="ident" id="2292851">consume</span><span class="op" id="2292858">(</span><span class="string" id="2292859">&#34;U&#34;</span><span class="op" id="2292862">,</span>&nbsp;<span class="builtintype" id="2292864">false</span><span class="op" id="2292869">)</span>&nbsp;<span class="op" id="2292871">||</span>&nbsp;<span class="op" id="2292874">!</span><span class="ident" id="2292875">s</span><span class="op" id="2292876">.</span><span class="ident" id="2292877">consume</span><span class="op" id="2292884">(</span><span class="string" id="2292885">&#34;+&#34;</span><span class="op" id="2292888">,</span>&nbsp;<span class="builtintype" id="2292890">false</span><span class="op" id="2292895">)</span>&nbsp;<span class="op" id="2292897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292902">s</span><span class="op" id="2292903">.</span><span class="ident" id="2292904">errorString</span><span class="op" id="2292915">(</span><span class="string" id="2292916">&#34;bad&nbsp;unicode&nbsp;format&nbsp;&#34;</span><span class="op" id="2292937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2292941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2292944">}</span>&nbsp;<span class="keyword" id="2292946">else</span>&nbsp;<span class="op" id="2292951">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2292955">s</span><span class="op" id="2292956">.</span><span class="ident" id="2292957">accept</span><span class="op" id="2292963">(</span><span class="ident" id="2292964">sign</span><span class="op" id="2292968">)</span>&nbsp;<span class="comment" id="2292970">//&nbsp;If&nbsp;there&#39;s&nbsp;a&nbsp;sign,&nbsp;it&nbsp;will&nbsp;be&nbsp;left&nbsp;in&nbsp;the&nbsp;token&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293031">if</span>&nbsp;<span class="ident" id="2293034">verb</span>&nbsp;<span class="op" id="2293039">==</span>&nbsp;<span class="string" id="2293042">&#39;v&#39;</span>&nbsp;<span class="op" id="2293046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293051">base</span><span class="op" id="2293055">,</span>&nbsp;<span class="ident" id="2293057">digits</span><span class="op" id="2293063">,</span>&nbsp;<span class="ident" id="2293065">haveDigits</span>&nbsp;<span class="op" id="2293076">=</span>&nbsp;<span class="ident" id="2293078">s</span><span class="op" id="2293079">.</span><span class="ident" id="2293080">scanBasePrefix</span><span class="op" id="2293094">(</span><span class="op" id="2293095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2293099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2293102">}</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293105">tok</span>&nbsp;<span class="op" id="2293109">:=</span>&nbsp;<span class="ident" id="2293112">s</span><span class="op" id="2293113">.</span><span class="ident" id="2293114">scanNumber</span><span class="op" id="2293124">(</span><span class="ident" id="2293125">digits</span><span class="op" id="2293131">,</span>&nbsp;<span class="ident" id="2293133">haveDigits</span><span class="op" id="2293143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293146">i</span><span class="op" id="2293147">,</span>&nbsp;<span class="ident" id="2293149">err</span>&nbsp;<span class="op" id="2293153">:=</span>&nbsp;<span class="ident" id="2293156">strconv</span><span class="op" id="2293163">.</span><span class="ident" id="2293164">ParseInt</span><span class="op" id="2293172">(</span><span class="ident" id="2293173">tok</span><span class="op" id="2293176">,</span>&nbsp;<span class="ident" id="2293178">base</span><span class="op" id="2293182">,</span>&nbsp;<span class="num" id="2293184">64</span><span class="op" id="2293186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293189">if</span>&nbsp;<span class="ident" id="2293192">err</span>&nbsp;<span class="op" id="2293196">!=</span>&nbsp;<span class="ident" id="2293199">nil</span>&nbsp;<span class="op" id="2293203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293207">s</span><span class="op" id="2293208">.</span><span class="builtintype" id="2293209">error</span><span class="op" id="2293214">(</span><span class="ident" id="2293215">err</span><span class="op" id="2293218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2293221">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293224">n</span>&nbsp;<span class="op" id="2293226">:=</span>&nbsp;<span class="builtintype" id="2293229">uint</span><span class="op" id="2293233">(</span><span class="ident" id="2293234">bitSize</span><span class="op" id="2293241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293244">x</span>&nbsp;<span class="op" id="2293246">:=</span>&nbsp;<span class="op" id="2293249">(</span><span class="ident" id="2293250">i</span>&nbsp;<span class="op" id="2293252">&lt;&lt;</span>&nbsp;<span class="op" id="2293255">(</span><span class="num" id="2293256">64</span>&nbsp;<span class="op" id="2293259">-</span>&nbsp;<span class="ident" id="2293261">n</span><span class="op" id="2293262">)</span><span class="op" id="2293263">)</span>&nbsp;<span class="op" id="2293265">&gt;&gt;</span>&nbsp;<span class="op" id="2293268">(</span><span class="num" id="2293269">64</span>&nbsp;<span class="op" id="2293272">-</span>&nbsp;<span class="ident" id="2293274">n</span><span class="op" id="2293275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293278">if</span>&nbsp;<span class="ident" id="2293281">x</span>&nbsp;<span class="op" id="2293283">!=</span>&nbsp;<span class="ident" id="2293286">i</span>&nbsp;<span class="op" id="2293288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293292">s</span><span class="op" id="2293293">.</span><span class="ident" id="2293294">errorString</span><span class="op" id="2293305">(</span><span class="string" id="2293306">&#34;integer&nbsp;overflow&nbsp;on&nbsp;token&nbsp;&#34;</span>&nbsp;<span class="op" id="2293335">+</span>&nbsp;<span class="ident" id="2293337">tok</span><span class="op" id="2293340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2293343">}</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293346">return</span>&nbsp;<span class="ident" id="2293353">i</span><br>
<span class="lineno"></span><span class="op" id="2293355">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2293358">//&nbsp;scanUint&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;unsigned&nbsp;integer&nbsp;represented</span><br>
<span class="lineno"></span><span class="comment" id="2293424">//&nbsp;by&nbsp;the&nbsp;next&nbsp;token,&nbsp;checking&nbsp;for&nbsp;overflow.&nbsp;&nbsp;Any&nbsp;error&nbsp;is&nbsp;stored&nbsp;in&nbsp;s.err.</span><br>
<span class="lineno">685</span><span class="keyword" id="2293500">func</span>&nbsp;<span class="op" id="2293505">(</span><span class="ident" id="2293506">s</span>&nbsp;<span class="op" id="2293508">*</span><span class="ident" id="2293509">ss</span><span class="op" id="2293511">)</span>&nbsp;<span class="ident" id="2293513">scanUint</span><span class="op" id="2293521">(</span><span class="ident" id="2293522">verb</span>&nbsp;<span class="builtintype" id="2293527">rune</span><span class="op" id="2293531">,</span>&nbsp;<span class="ident" id="2293533">bitSize</span>&nbsp;<span class="builtintype" id="2293541">int</span><span class="op" id="2293544">)</span>&nbsp;<span class="ident" id="2293546">uint64</span>&nbsp;<span class="op" id="2293553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293556">if</span>&nbsp;<span class="ident" id="2293559">verb</span>&nbsp;<span class="op" id="2293564">==</span>&nbsp;<span class="string" id="2293567">&#39;c&#39;</span>&nbsp;<span class="op" id="2293571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293575">return</span>&nbsp;<span class="ident" id="2293582">uint64</span><span class="op" id="2293588">(</span><span class="ident" id="2293589">s</span><span class="op" id="2293590">.</span><span class="ident" id="2293591">scanRune</span><span class="op" id="2293599">(</span><span class="ident" id="2293600">bitSize</span><span class="op" id="2293607">)</span><span class="op" id="2293608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2293611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293614">s</span><span class="op" id="2293615">.</span><span class="ident" id="2293616">skipSpace</span><span class="op" id="2293625">(</span><span class="builtintype" id="2293626">false</span><span class="op" id="2293631">)</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293634">s</span><span class="op" id="2293635">.</span><span class="ident" id="2293636">notEOF</span><span class="op" id="2293642">(</span><span class="op" id="2293643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293646">base</span><span class="op" id="2293650">,</span>&nbsp;<span class="ident" id="2293652">digits</span>&nbsp;<span class="op" id="2293659">:=</span>&nbsp;<span class="ident" id="2293662">s</span><span class="op" id="2293663">.</span><span class="ident" id="2293664">getBase</span><span class="op" id="2293671">(</span><span class="ident" id="2293672">verb</span><span class="op" id="2293676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293679">haveDigits</span>&nbsp;<span class="op" id="2293690">:=</span>&nbsp;<span class="builtintype" id="2293693">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293700">if</span>&nbsp;<span class="ident" id="2293703">verb</span>&nbsp;<span class="op" id="2293708">==</span>&nbsp;<span class="string" id="2293711">&#39;U&#39;</span>&nbsp;<span class="op" id="2293715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293719">if</span>&nbsp;<span class="op" id="2293722">!</span><span class="ident" id="2293723">s</span><span class="op" id="2293724">.</span><span class="ident" id="2293725">consume</span><span class="op" id="2293732">(</span><span class="string" id="2293733">&#34;U&#34;</span><span class="op" id="2293736">,</span>&nbsp;<span class="builtintype" id="2293738">false</span><span class="op" id="2293743">)</span>&nbsp;<span class="op" id="2293745">||</span>&nbsp;<span class="op" id="2293748">!</span><span class="ident" id="2293749">s</span><span class="op" id="2293750">.</span><span class="ident" id="2293751">consume</span><span class="op" id="2293758">(</span><span class="string" id="2293759">&#34;+&#34;</span><span class="op" id="2293762">,</span>&nbsp;<span class="builtintype" id="2293764">false</span><span class="op" id="2293769">)</span>&nbsp;<span class="op" id="2293771">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293776">s</span><span class="op" id="2293777">.</span><span class="ident" id="2293778">errorString</span><span class="op" id="2293789">(</span><span class="string" id="2293790">&#34;bad&nbsp;unicode&nbsp;format&nbsp;&#34;</span><span class="op" id="2293811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2293815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2293818">}</span>&nbsp;<span class="keyword" id="2293820">else</span>&nbsp;<span class="keyword" id="2293825">if</span>&nbsp;<span class="ident" id="2293828">verb</span>&nbsp;<span class="op" id="2293833">==</span>&nbsp;<span class="string" id="2293836">&#39;v&#39;</span>&nbsp;<span class="op" id="2293840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293844">base</span><span class="op" id="2293848">,</span>&nbsp;<span class="ident" id="2293850">digits</span><span class="op" id="2293856">,</span>&nbsp;<span class="ident" id="2293858">haveDigits</span>&nbsp;<span class="op" id="2293869">=</span>&nbsp;<span class="ident" id="2293871">s</span><span class="op" id="2293872">.</span><span class="ident" id="2293873">scanBasePrefix</span><span class="op" id="2293887">(</span><span class="op" id="2293888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2293891">}</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293894">tok</span>&nbsp;<span class="op" id="2293898">:=</span>&nbsp;<span class="ident" id="2293901">s</span><span class="op" id="2293902">.</span><span class="ident" id="2293903">scanNumber</span><span class="op" id="2293913">(</span><span class="ident" id="2293914">digits</span><span class="op" id="2293920">,</span>&nbsp;<span class="ident" id="2293922">haveDigits</span><span class="op" id="2293932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293935">i</span><span class="op" id="2293936">,</span>&nbsp;<span class="ident" id="2293938">err</span>&nbsp;<span class="op" id="2293942">:=</span>&nbsp;<span class="ident" id="2293945">strconv</span><span class="op" id="2293952">.</span><span class="ident" id="2293953">ParseUint</span><span class="op" id="2293962">(</span><span class="ident" id="2293963">tok</span><span class="op" id="2293966">,</span>&nbsp;<span class="ident" id="2293968">base</span><span class="op" id="2293972">,</span>&nbsp;<span class="num" id="2293974">64</span><span class="op" id="2293976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2293979">if</span>&nbsp;<span class="ident" id="2293982">err</span>&nbsp;<span class="op" id="2293986">!=</span>&nbsp;<span class="ident" id="2293989">nil</span>&nbsp;<span class="op" id="2293993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2293997">s</span><span class="op" id="2293998">.</span><span class="builtintype" id="2293999">error</span><span class="op" id="2294004">(</span><span class="ident" id="2294005">err</span><span class="op" id="2294008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2294011">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294014">n</span>&nbsp;<span class="op" id="2294016">:=</span>&nbsp;<span class="builtintype" id="2294019">uint</span><span class="op" id="2294023">(</span><span class="ident" id="2294024">bitSize</span><span class="op" id="2294031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294034">x</span>&nbsp;<span class="op" id="2294036">:=</span>&nbsp;<span class="op" id="2294039">(</span><span class="ident" id="2294040">i</span>&nbsp;<span class="op" id="2294042">&lt;&lt;</span>&nbsp;<span class="op" id="2294045">(</span><span class="num" id="2294046">64</span>&nbsp;<span class="op" id="2294049">-</span>&nbsp;<span class="ident" id="2294051">n</span><span class="op" id="2294052">)</span><span class="op" id="2294053">)</span>&nbsp;<span class="op" id="2294055">&gt;&gt;</span>&nbsp;<span class="op" id="2294058">(</span><span class="num" id="2294059">64</span>&nbsp;<span class="op" id="2294062">-</span>&nbsp;<span class="ident" id="2294064">n</span><span class="op" id="2294065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294068">if</span>&nbsp;<span class="ident" id="2294071">x</span>&nbsp;<span class="op" id="2294073">!=</span>&nbsp;<span class="ident" id="2294076">i</span>&nbsp;<span class="op" id="2294078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294082">s</span><span class="op" id="2294083">.</span><span class="ident" id="2294084">errorString</span><span class="op" id="2294095">(</span><span class="string" id="2294096">&#34;unsigned&nbsp;integer&nbsp;overflow&nbsp;on&nbsp;token&nbsp;&#34;</span>&nbsp;<span class="op" id="2294134">+</span>&nbsp;<span class="ident" id="2294136">tok</span><span class="op" id="2294139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2294142">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294145">return</span>&nbsp;<span class="ident" id="2294152">i</span><br>
<span class="lineno"></span><span class="op" id="2294154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2294157">//&nbsp;floatToken&nbsp;returns&nbsp;the&nbsp;floating-point&nbsp;number&nbsp;starting&nbsp;here,&nbsp;no&nbsp;longer&nbsp;than&nbsp;swid</span><br>
<span class="lineno"></span><span class="comment" id="2294240">//&nbsp;if&nbsp;the&nbsp;width&nbsp;is&nbsp;specified.&nbsp;It&#39;s&nbsp;not&nbsp;rigorous&nbsp;about&nbsp;syntax&nbsp;because&nbsp;it&nbsp;doesn&#39;t&nbsp;check&nbsp;that</span><br>
<span class="lineno">715</span><span class="comment" id="2294331">//&nbsp;we&nbsp;have&nbsp;at&nbsp;least&nbsp;some&nbsp;digits,&nbsp;but&nbsp;Atof&nbsp;will&nbsp;do&nbsp;that.</span><br>
<span class="lineno"></span><span class="keyword" id="2294387">func</span>&nbsp;<span class="op" id="2294392">(</span><span class="ident" id="2294393">s</span>&nbsp;<span class="op" id="2294395">*</span><span class="ident" id="2294396">ss</span><span class="op" id="2294398">)</span>&nbsp;<span class="ident" id="2294400">floatToken</span><span class="op" id="2294410">(</span><span class="op" id="2294411">)</span>&nbsp;<span class="builtintype" id="2294413">string</span>&nbsp;<span class="op" id="2294420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294423">s</span><span class="op" id="2294424">.</span><span class="ident" id="2294425">buf</span>&nbsp;<span class="op" id="2294429">=</span>&nbsp;<span class="ident" id="2294431">s</span><span class="op" id="2294432">.</span><span class="ident" id="2294433">buf</span><span class="op" id="2294436">[</span><span class="op" id="2294437">:</span><span class="num" id="2294438">0</span><span class="op" id="2294439">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2294442">//&nbsp;NaN?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294451">if</span>&nbsp;<span class="ident" id="2294454">s</span><span class="op" id="2294455">.</span><span class="ident" id="2294456">accept</span><span class="op" id="2294462">(</span><span class="string" id="2294463">&#34;nN&#34;</span><span class="op" id="2294467">)</span>&nbsp;<span class="op" id="2294469">&amp;&amp;</span>&nbsp;<span class="ident" id="2294472">s</span><span class="op" id="2294473">.</span><span class="ident" id="2294474">accept</span><span class="op" id="2294480">(</span><span class="string" id="2294481">&#34;aA&#34;</span><span class="op" id="2294485">)</span>&nbsp;<span class="op" id="2294487">&amp;&amp;</span>&nbsp;<span class="ident" id="2294490">s</span><span class="op" id="2294491">.</span><span class="ident" id="2294492">accept</span><span class="op" id="2294498">(</span><span class="string" id="2294499">&#34;nN&#34;</span><span class="op" id="2294503">)</span>&nbsp;<span class="op" id="2294505">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294509">return</span>&nbsp;<span class="builtintype" id="2294516">string</span><span class="op" id="2294522">(</span><span class="ident" id="2294523">s</span><span class="op" id="2294524">.</span><span class="ident" id="2294525">buf</span><span class="op" id="2294528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2294531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2294534">//&nbsp;leading&nbsp;sign?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294552">s</span><span class="op" id="2294553">.</span><span class="ident" id="2294554">accept</span><span class="op" id="2294560">(</span><span class="ident" id="2294561">sign</span><span class="op" id="2294565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2294568">//&nbsp;Inf?</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294577">if</span>&nbsp;<span class="ident" id="2294580">s</span><span class="op" id="2294581">.</span><span class="ident" id="2294582">accept</span><span class="op" id="2294588">(</span><span class="string" id="2294589">&#34;iI&#34;</span><span class="op" id="2294593">)</span>&nbsp;<span class="op" id="2294595">&amp;&amp;</span>&nbsp;<span class="ident" id="2294598">s</span><span class="op" id="2294599">.</span><span class="ident" id="2294600">accept</span><span class="op" id="2294606">(</span><span class="string" id="2294607">&#34;nN&#34;</span><span class="op" id="2294611">)</span>&nbsp;<span class="op" id="2294613">&amp;&amp;</span>&nbsp;<span class="ident" id="2294616">s</span><span class="op" id="2294617">.</span><span class="ident" id="2294618">accept</span><span class="op" id="2294624">(</span><span class="string" id="2294625">&#34;fF&#34;</span><span class="op" id="2294629">)</span>&nbsp;<span class="op" id="2294631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294635">return</span>&nbsp;<span class="builtintype" id="2294642">string</span><span class="op" id="2294648">(</span><span class="ident" id="2294649">s</span><span class="op" id="2294650">.</span><span class="ident" id="2294651">buf</span><span class="op" id="2294654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2294657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2294660">//&nbsp;digits?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294672">for</span>&nbsp;<span class="ident" id="2294676">s</span><span class="op" id="2294677">.</span><span class="ident" id="2294678">accept</span><span class="op" id="2294684">(</span><span class="ident" id="2294685">decimalDigits</span><span class="op" id="2294698">)</span>&nbsp;<span class="op" id="2294700">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2294703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2294706">//&nbsp;decimal&nbsp;point?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294725">if</span>&nbsp;<span class="ident" id="2294728">s</span><span class="op" id="2294729">.</span><span class="ident" id="2294730">accept</span><span class="op" id="2294736">(</span><span class="ident" id="2294737">period</span><span class="op" id="2294743">)</span>&nbsp;<span class="op" id="2294745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2294749">//&nbsp;fraction?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294764">for</span>&nbsp;<span class="ident" id="2294768">s</span><span class="op" id="2294769">.</span><span class="ident" id="2294770">accept</span><span class="op" id="2294776">(</span><span class="ident" id="2294777">decimalDigits</span><span class="op" id="2294790">)</span>&nbsp;<span class="op" id="2294792">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2294796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2294799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2294802">//&nbsp;exponent?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294816">if</span>&nbsp;<span class="ident" id="2294819">s</span><span class="op" id="2294820">.</span><span class="ident" id="2294821">accept</span><span class="op" id="2294827">(</span><span class="ident" id="2294828">exponent</span><span class="op" id="2294836">)</span>&nbsp;<span class="op" id="2294838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2294842">//&nbsp;leading&nbsp;sign?</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2294861">s</span><span class="op" id="2294862">.</span><span class="ident" id="2294863">accept</span><span class="op" id="2294869">(</span><span class="ident" id="2294870">sign</span><span class="op" id="2294874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2294878">//&nbsp;digits?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294891">for</span>&nbsp;<span class="ident" id="2294895">s</span><span class="op" id="2294896">.</span><span class="ident" id="2294897">accept</span><span class="op" id="2294903">(</span><span class="ident" id="2294904">decimalDigits</span><span class="op" id="2294917">)</span>&nbsp;<span class="op" id="2294919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2294923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2294926">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2294929">return</span>&nbsp;<span class="builtintype" id="2294936">string</span><span class="op" id="2294942">(</span><span class="ident" id="2294943">s</span><span class="op" id="2294944">.</span><span class="ident" id="2294945">buf</span><span class="op" id="2294948">)</span><br>
<span class="lineno"></span><span class="op" id="2294950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2294953">//&nbsp;complexTokens&nbsp;returns&nbsp;the&nbsp;real&nbsp;and&nbsp;imaginary&nbsp;parts&nbsp;of&nbsp;the&nbsp;complex&nbsp;number&nbsp;starting&nbsp;here.</span><br>
<span class="lineno"></span><span class="comment" id="2295044">//&nbsp;The&nbsp;number&nbsp;might&nbsp;be&nbsp;parenthesized&nbsp;and&nbsp;has&nbsp;the&nbsp;format&nbsp;(N+Ni)&nbsp;where&nbsp;N&nbsp;is&nbsp;a&nbsp;floating-point</span><br>
<span class="lineno">750</span><span class="comment" id="2295135">//&nbsp;number&nbsp;and&nbsp;there&nbsp;are&nbsp;no&nbsp;spaces&nbsp;within.</span><br>
<span class="lineno"></span><span class="keyword" id="2295177">func</span>&nbsp;<span class="op" id="2295182">(</span><span class="ident" id="2295183">s</span>&nbsp;<span class="op" id="2295185">*</span><span class="ident" id="2295186">ss</span><span class="op" id="2295188">)</span>&nbsp;<span class="ident" id="2295190">complexTokens</span><span class="op" id="2295203">(</span><span class="op" id="2295204">)</span>&nbsp;<span class="op" id="2295206">(</span><span class="builtinfunc" id="2295207">real</span><span class="op" id="2295211">,</span>&nbsp;<span class="builtinfunc" id="2295213">imag</span>&nbsp;<span class="builtintype" id="2295218">string</span><span class="op" id="2295224">)</span>&nbsp;<span class="op" id="2295226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2295229">//&nbsp;TODO:&nbsp;accept&nbsp;N&nbsp;and&nbsp;Ni&nbsp;independently?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2295270">parens</span>&nbsp;<span class="op" id="2295277">:=</span>&nbsp;<span class="ident" id="2295280">s</span><span class="op" id="2295281">.</span><span class="ident" id="2295282">accept</span><span class="op" id="2295288">(</span><span class="string" id="2295289">&#34;(&#34;</span><span class="op" id="2295292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2295295">real</span>&nbsp;<span class="op" id="2295300">=</span>&nbsp;<span class="ident" id="2295302">s</span><span class="op" id="2295303">.</span><span class="ident" id="2295304">floatToken</span><span class="op" id="2295314">(</span><span class="op" id="2295315">)</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2295318">s</span><span class="op" id="2295319">.</span><span class="ident" id="2295320">buf</span>&nbsp;<span class="op" id="2295324">=</span>&nbsp;<span class="ident" id="2295326">s</span><span class="op" id="2295327">.</span><span class="ident" id="2295328">buf</span><span class="op" id="2295331">[</span><span class="op" id="2295332">:</span><span class="num" id="2295333">0</span><span class="op" id="2295334">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2295337">//&nbsp;Must&nbsp;now&nbsp;have&nbsp;a&nbsp;sign.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2295363">if</span>&nbsp;<span class="op" id="2295366">!</span><span class="ident" id="2295367">s</span><span class="op" id="2295368">.</span><span class="ident" id="2295369">accept</span><span class="op" id="2295375">(</span><span class="string" id="2295376">&#34;+-&#34;</span><span class="op" id="2295380">)</span>&nbsp;<span class="op" id="2295382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2295386">s</span><span class="op" id="2295387">.</span><span class="builtintype" id="2295388">error</span><span class="op" id="2295393">(</span><span class="ident" id="2295394">complexError</span><span class="op" id="2295406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2295409">}</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2295412">//&nbsp;Sign&nbsp;is&nbsp;now&nbsp;in&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2295438">imagSign</span>&nbsp;<span class="op" id="2295447">:=</span>&nbsp;<span class="builtintype" id="2295450">string</span><span class="op" id="2295456">(</span><span class="ident" id="2295457">s</span><span class="op" id="2295458">.</span><span class="ident" id="2295459">buf</span><span class="op" id="2295462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2295465">imag</span>&nbsp;<span class="op" id="2295470">=</span>&nbsp;<span class="ident" id="2295472">s</span><span class="op" id="2295473">.</span><span class="ident" id="2295474">floatToken</span><span class="op" id="2295484">(</span><span class="op" id="2295485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2295488">if</span>&nbsp;<span class="op" id="2295491">!</span><span class="ident" id="2295492">s</span><span class="op" id="2295493">.</span><span class="ident" id="2295494">accept</span><span class="op" id="2295500">(</span><span class="string" id="2295501">&#34;i&#34;</span><span class="op" id="2295504">)</span>&nbsp;<span class="op" id="2295506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2295510">s</span><span class="op" id="2295511">.</span><span class="builtintype" id="2295512">error</span><span class="op" id="2295517">(</span><span class="ident" id="2295518">complexError</span><span class="op" id="2295530">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2295533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2295536">if</span>&nbsp;<span class="ident" id="2295539">parens</span>&nbsp;<span class="op" id="2295546">&amp;&amp;</span>&nbsp;<span class="op" id="2295549">!</span><span class="ident" id="2295550">s</span><span class="op" id="2295551">.</span><span class="ident" id="2295552">accept</span><span class="op" id="2295558">(</span><span class="string" id="2295559">&#34;)&#34;</span><span class="op" id="2295562">)</span>&nbsp;<span class="op" id="2295564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2295568">s</span><span class="op" id="2295569">.</span><span class="builtintype" id="2295570">error</span><span class="op" id="2295575">(</span><span class="ident" id="2295576">complexError</span><span class="op" id="2295588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2295591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2295594">return</span>&nbsp;<span class="builtinfunc" id="2295601">real</span><span class="op" id="2295605">,</span>&nbsp;<span class="ident" id="2295607">imagSign</span>&nbsp;<span class="op" id="2295616">+</span>&nbsp;<span class="builtinfunc" id="2295618">imag</span><br>
<span class="lineno">770</span><span class="op" id="2295623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2295626">//&nbsp;convertFloat&nbsp;converts&nbsp;the&nbsp;string&nbsp;to&nbsp;a&nbsp;float64value.</span><br>
<span class="lineno"></span><span class="keyword" id="2295681">func</span>&nbsp;<span class="op" id="2295686">(</span><span class="ident" id="2295687">s</span>&nbsp;<span class="op" id="2295689">*</span><span class="ident" id="2295690">ss</span><span class="op" id="2295692">)</span>&nbsp;<span class="ident" id="2295694">convertFloat</span><span class="op" id="2295706">(</span><span class="ident" id="2295707">str</span>&nbsp;<span class="builtintype" id="2295711">string</span><span class="op" id="2295717">,</span>&nbsp;<span class="ident" id="2295719">n</span>&nbsp;<span class="builtintype" id="2295721">int</span><span class="op" id="2295724">)</span>&nbsp;<span class="builtintype" id="2295726">float64</span>&nbsp;<span class="op" id="2295734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2295737">if</span>&nbsp;<span class="ident" id="2295740">p</span>&nbsp;<span class="op" id="2295742">:=</span>&nbsp;<span class="ident" id="2295745">indexRune</span><span class="op" id="2295754">(</span><span class="ident" id="2295755">str</span><span class="op" id="2295758">,</span>&nbsp;<span class="string" id="2295760">&#39;p&#39;</span><span class="op" id="2295763">)</span><span class="op" id="2295764">;</span>&nbsp;<span class="ident" id="2295766">p</span>&nbsp;<span class="op" id="2295768">&gt;=</span>&nbsp;<span class="num" id="2295771">0</span>&nbsp;<span class="op" id="2295773">{</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2295777">//&nbsp;Atof&nbsp;doesn&#39;t&nbsp;handle&nbsp;power-of-2&nbsp;exponents,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2295824">//&nbsp;but&nbsp;they&#39;re&nbsp;easy&nbsp;to&nbsp;evaluate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2295859">f</span><span class="op" id="2295860">,</span>&nbsp;<span class="ident" id="2295862">err</span>&nbsp;<span class="op" id="2295866">:=</span>&nbsp;<span class="ident" id="2295869">strconv</span><span class="op" id="2295876">.</span><span class="ident" id="2295877">ParseFloat</span><span class="op" id="2295887">(</span><span class="ident" id="2295888">str</span><span class="op" id="2295891">[</span><span class="op" id="2295892">:</span><span class="ident" id="2295893">p</span><span class="op" id="2295894">]</span><span class="op" id="2295895">,</span>&nbsp;<span class="ident" id="2295897">n</span><span class="op" id="2295898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2295902">if</span>&nbsp;<span class="ident" id="2295905">err</span>&nbsp;<span class="op" id="2295909">!=</span>&nbsp;<span class="ident" id="2295912">nil</span>&nbsp;<span class="op" id="2295916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2295921">//&nbsp;Put&nbsp;full&nbsp;string&nbsp;into&nbsp;error.</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2295955">if</span>&nbsp;<span class="ident" id="2295958">e</span><span class="op" id="2295959">,</span>&nbsp;<span class="ident" id="2295961">ok</span>&nbsp;<span class="op" id="2295964">:=</span>&nbsp;<span class="ident" id="2295967">err</span><span class="op" id="2295970">.</span><span class="op" id="2295971">(</span><span class="op" id="2295972">*</span><span class="ident" id="2295973">strconv</span><span class="op" id="2295980">.</span><span class="ident" id="2295981">NumError</span><span class="op" id="2295989">)</span><span class="op" id="2295990">;</span>&nbsp;<span class="ident" id="2295992">ok</span>&nbsp;<span class="op" id="2295995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2296001">e</span><span class="op" id="2296002">.</span><span class="ident" id="2296003">Num</span>&nbsp;<span class="op" id="2296007">=</span>&nbsp;<span class="ident" id="2296009">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2296016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2296021">s</span><span class="op" id="2296022">.</span><span class="builtintype" id="2296023">error</span><span class="op" id="2296028">(</span><span class="ident" id="2296029">err</span><span class="op" id="2296032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2296036">}</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2296040">m</span><span class="op" id="2296041">,</span>&nbsp;<span class="ident" id="2296043">err</span>&nbsp;<span class="op" id="2296047">:=</span>&nbsp;<span class="ident" id="2296050">strconv</span><span class="op" id="2296057">.</span><span class="ident" id="2296058">Atoi</span><span class="op" id="2296062">(</span><span class="ident" id="2296063">str</span><span class="op" id="2296066">[</span><span class="ident" id="2296067">p</span><span class="op" id="2296068">+</span><span class="num" id="2296069">1</span><span class="op" id="2296070">:</span><span class="op" id="2296071">]</span><span class="op" id="2296072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2296076">if</span>&nbsp;<span class="ident" id="2296079">err</span>&nbsp;<span class="op" id="2296083">!=</span>&nbsp;<span class="ident" id="2296086">nil</span>&nbsp;<span class="op" id="2296090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2296095">//&nbsp;Put&nbsp;full&nbsp;string&nbsp;into&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2296129">if</span>&nbsp;<span class="ident" id="2296132">e</span><span class="op" id="2296133">,</span>&nbsp;<span class="ident" id="2296135">ok</span>&nbsp;<span class="op" id="2296138">:=</span>&nbsp;<span class="ident" id="2296141">err</span><span class="op" id="2296144">.</span><span class="op" id="2296145">(</span><span class="op" id="2296146">*</span><span class="ident" id="2296147">strconv</span><span class="op" id="2296154">.</span><span class="ident" id="2296155">NumError</span><span class="op" id="2296163">)</span><span class="op" id="2296164">;</span>&nbsp;<span class="ident" id="2296166">ok</span>&nbsp;<span class="op" id="2296169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2296175">e</span><span class="op" id="2296176">.</span><span class="ident" id="2296177">Num</span>&nbsp;<span class="op" id="2296181">=</span>&nbsp;<span class="ident" id="2296183">str</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2296190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2296195">s</span><span class="op" id="2296196">.</span><span class="builtintype" id="2296197">error</span><span class="op" id="2296202">(</span><span class="ident" id="2296203">err</span><span class="op" id="2296206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2296210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2296214">return</span>&nbsp;<span class="ident" id="2296221">math</span><span class="op" id="2296225">.</span><span class="ident" id="2296226">Ldexp</span><span class="op" id="2296231">(</span><span class="ident" id="2296232">f</span><span class="op" id="2296233">,</span>&nbsp;<span class="ident" id="2296235">m</span><span class="op" id="2296236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2296239">}</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2296242">f</span><span class="op" id="2296243">,</span>&nbsp;<span class="ident" id="2296245">err</span>&nbsp;<span class="op" id="2296249">:=</span>&nbsp;<span class="ident" id="2296252">strconv</span><span class="op" id="2296259">.</span><span class="ident" id="2296260">ParseFloat</span><span class="op" id="2296270">(</span><span class="ident" id="2296271">str</span><span class="op" id="2296274">,</span>&nbsp;<span class="ident" id="2296276">n</span><span class="op" id="2296277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2296280">if</span>&nbsp;<span class="ident" id="2296283">err</span>&nbsp;<span class="op" id="2296287">!=</span>&nbsp;<span class="ident" id="2296290">nil</span>&nbsp;<span class="op" id="2296294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2296298">s</span><span class="op" id="2296299">.</span><span class="builtintype" id="2296300">error</span><span class="op" id="2296305">(</span><span class="ident" id="2296306">err</span><span class="op" id="2296309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2296312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2296315">return</span>&nbsp;<span class="ident" id="2296322">f</span><br>
<span class="lineno">800</span><span class="op" id="2296324">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2296327">//&nbsp;convertComplex&nbsp;converts&nbsp;the&nbsp;next&nbsp;token&nbsp;to&nbsp;a&nbsp;complex128&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="2296392">//&nbsp;The&nbsp;atof&nbsp;argument&nbsp;is&nbsp;a&nbsp;type-specific&nbsp;reader&nbsp;for&nbsp;the&nbsp;underlying&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2296464">//&nbsp;If&nbsp;we&#39;re&nbsp;reading&nbsp;complex64,&nbsp;atof&nbsp;will&nbsp;parse&nbsp;float32s&nbsp;and&nbsp;convert&nbsp;them</span><br>
<span class="lineno">805</span><span class="comment" id="2296537">//&nbsp;to&nbsp;float64&#39;s&nbsp;to&nbsp;avoid&nbsp;reproducing&nbsp;this&nbsp;code&nbsp;for&nbsp;each&nbsp;complex&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2296607">func</span>&nbsp;<span class="op" id="2296612">(</span><span class="ident" id="2296613">s</span>&nbsp;<span class="op" id="2296615">*</span><span class="ident" id="2296616">ss</span><span class="op" id="2296618">)</span>&nbsp;<span class="ident" id="2296620">scanComplex</span><span class="op" id="2296631">(</span><span class="ident" id="2296632">verb</span>&nbsp;<span class="builtintype" id="2296637">rune</span><span class="op" id="2296641">,</span>&nbsp;<span class="ident" id="2296643">n</span>&nbsp;<span class="builtintype" id="2296645">int</span><span class="op" id="2296648">)</span>&nbsp;<span class="builtintype" id="2296650">complex128</span>&nbsp;<span class="op" id="2296661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2296664">if</span>&nbsp;<span class="op" id="2296667">!</span><span class="ident" id="2296668">s</span><span class="op" id="2296669">.</span><span class="ident" id="2296670">okVerb</span><span class="op" id="2296676">(</span><span class="ident" id="2296677">verb</span><span class="op" id="2296681">,</span>&nbsp;<span class="ident" id="2296683">floatVerbs</span><span class="op" id="2296693">,</span>&nbsp;<span class="string" id="2296695">&#34;complex&#34;</span><span class="op" id="2296704">)</span>&nbsp;<span class="op" id="2296706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2296710">return</span>&nbsp;<span class="num" id="2296717">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2296720">}</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2296723">s</span><span class="op" id="2296724">.</span><span class="ident" id="2296725">skipSpace</span><span class="op" id="2296734">(</span><span class="builtintype" id="2296735">false</span><span class="op" id="2296740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2296743">s</span><span class="op" id="2296744">.</span><span class="ident" id="2296745">notEOF</span><span class="op" id="2296751">(</span><span class="op" id="2296752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2296755">sreal</span><span class="op" id="2296760">,</span>&nbsp;<span class="ident" id="2296762">simag</span>&nbsp;<span class="op" id="2296768">:=</span>&nbsp;<span class="ident" id="2296771">s</span><span class="op" id="2296772">.</span><span class="ident" id="2296773">complexTokens</span><span class="op" id="2296786">(</span><span class="op" id="2296787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2296790">real</span>&nbsp;<span class="op" id="2296795">:=</span>&nbsp;<span class="ident" id="2296798">s</span><span class="op" id="2296799">.</span><span class="ident" id="2296800">convertFloat</span><span class="op" id="2296812">(</span><span class="ident" id="2296813">sreal</span><span class="op" id="2296818">,</span>&nbsp;<span class="ident" id="2296820">n</span><span class="op" id="2296821">/</span><span class="num" id="2296822">2</span><span class="op" id="2296823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2296826">imag</span>&nbsp;<span class="op" id="2296831">:=</span>&nbsp;<span class="ident" id="2296834">s</span><span class="op" id="2296835">.</span><span class="ident" id="2296836">convertFloat</span><span class="op" id="2296848">(</span><span class="ident" id="2296849">simag</span><span class="op" id="2296854">,</span>&nbsp;<span class="ident" id="2296856">n</span><span class="op" id="2296857">/</span><span class="num" id="2296858">2</span><span class="op" id="2296859">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2296862">return</span>&nbsp;<span class="builtinfunc" id="2296869">complex</span><span class="op" id="2296876">(</span><span class="builtinfunc" id="2296877">real</span><span class="op" id="2296881">,</span>&nbsp;<span class="builtinfunc" id="2296883">imag</span><span class="op" id="2296887">)</span><br>
<span class="lineno"></span><span class="op" id="2296889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2296892">//&nbsp;convertString&nbsp;returns&nbsp;the&nbsp;string&nbsp;represented&nbsp;by&nbsp;the&nbsp;next&nbsp;input&nbsp;characters.</span><br>
<span class="lineno"></span><span class="comment" id="2296970">//&nbsp;The&nbsp;format&nbsp;of&nbsp;the&nbsp;input&nbsp;is&nbsp;determined&nbsp;by&nbsp;the&nbsp;verb.</span><br>
<span class="lineno">820</span><span class="keyword" id="2297024">func</span>&nbsp;<span class="op" id="2297029">(</span><span class="ident" id="2297030">s</span>&nbsp;<span class="op" id="2297032">*</span><span class="ident" id="2297033">ss</span><span class="op" id="2297035">)</span>&nbsp;<span class="ident" id="2297037">convertString</span><span class="op" id="2297050">(</span><span class="ident" id="2297051">verb</span>&nbsp;<span class="builtintype" id="2297056">rune</span><span class="op" id="2297060">)</span>&nbsp;<span class="op" id="2297062">(</span><span class="ident" id="2297063">str</span>&nbsp;<span class="builtintype" id="2297067">string</span><span class="op" id="2297073">)</span>&nbsp;<span class="op" id="2297075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297078">if</span>&nbsp;<span class="op" id="2297081">!</span><span class="ident" id="2297082">s</span><span class="op" id="2297083">.</span><span class="ident" id="2297084">okVerb</span><span class="op" id="2297090">(</span><span class="ident" id="2297091">verb</span><span class="op" id="2297095">,</span>&nbsp;<span class="string" id="2297097">&#34;svqx&#34;</span><span class="op" id="2297103">,</span>&nbsp;<span class="string" id="2297105">&#34;string&#34;</span><span class="op" id="2297113">)</span>&nbsp;<span class="op" id="2297115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297119">return</span>&nbsp;<span class="string" id="2297126">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2297130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2297133">s</span><span class="op" id="2297134">.</span><span class="ident" id="2297135">skipSpace</span><span class="op" id="2297144">(</span><span class="builtintype" id="2297145">false</span><span class="op" id="2297150">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2297153">s</span><span class="op" id="2297154">.</span><span class="ident" id="2297155">notEOF</span><span class="op" id="2297161">(</span><span class="op" id="2297162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297165">switch</span>&nbsp;<span class="ident" id="2297172">verb</span>&nbsp;<span class="op" id="2297177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297180">case</span>&nbsp;<span class="string" id="2297185">&#39;q&#39;</span><span class="op" id="2297188">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2297192">str</span>&nbsp;<span class="op" id="2297196">=</span>&nbsp;<span class="ident" id="2297198">s</span><span class="op" id="2297199">.</span><span class="ident" id="2297200">quotedString</span><span class="op" id="2297212">(</span><span class="op" id="2297213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297216">case</span>&nbsp;<span class="string" id="2297221">&#39;x&#39;</span><span class="op" id="2297224">:</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2297228">str</span>&nbsp;<span class="op" id="2297232">=</span>&nbsp;<span class="ident" id="2297234">s</span><span class="op" id="2297235">.</span><span class="ident" id="2297236">hexString</span><span class="op" id="2297245">(</span><span class="op" id="2297246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297249">default</span><span class="op" id="2297256">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2297260">str</span>&nbsp;<span class="op" id="2297264">=</span>&nbsp;<span class="builtintype" id="2297266">string</span><span class="op" id="2297272">(</span><span class="ident" id="2297273">s</span><span class="op" id="2297274">.</span><span class="ident" id="2297275">token</span><span class="op" id="2297280">(</span><span class="builtintype" id="2297281">true</span><span class="op" id="2297285">,</span>&nbsp;<span class="ident" id="2297287">notSpace</span><span class="op" id="2297295">)</span><span class="op" id="2297296">)</span>&nbsp;<span class="comment" id="2297298">//&nbsp;%s&nbsp;and&nbsp;%v&nbsp;just&nbsp;return&nbsp;the&nbsp;next&nbsp;word</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2297338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297341">return</span><br>
<span class="lineno">835</span><span class="op" id="2297348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2297351">//&nbsp;quotedString&nbsp;returns&nbsp;the&nbsp;double-&nbsp;or&nbsp;back-quoted&nbsp;string&nbsp;represented&nbsp;by&nbsp;the&nbsp;next&nbsp;input&nbsp;characters.</span><br>
<span class="lineno"></span><span class="keyword" id="2297451">func</span>&nbsp;<span class="op" id="2297456">(</span><span class="ident" id="2297457">s</span>&nbsp;<span class="op" id="2297459">*</span><span class="ident" id="2297460">ss</span><span class="op" id="2297462">)</span>&nbsp;<span class="ident" id="2297464">quotedString</span><span class="op" id="2297476">(</span><span class="op" id="2297477">)</span>&nbsp;<span class="builtintype" id="2297479">string</span>&nbsp;<span class="op" id="2297486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2297489">s</span><span class="op" id="2297490">.</span><span class="ident" id="2297491">notEOF</span><span class="op" id="2297497">(</span><span class="op" id="2297498">)</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2297501">quote</span>&nbsp;<span class="op" id="2297507">:=</span>&nbsp;<span class="ident" id="2297510">s</span><span class="op" id="2297511">.</span><span class="ident" id="2297512">getRune</span><span class="op" id="2297519">(</span><span class="op" id="2297520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297523">switch</span>&nbsp;<span class="ident" id="2297530">quote</span>&nbsp;<span class="op" id="2297536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297539">case</span>&nbsp;<span class="string" id="2297544">&#39;`&#39;</span><span class="op" id="2297547">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2297551">//&nbsp;Back-quoted:&nbsp;Anything&nbsp;goes&nbsp;until&nbsp;EOF&nbsp;or&nbsp;back&nbsp;quote.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297608">for</span>&nbsp;<span class="op" id="2297612">{</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2297617">r</span>&nbsp;<span class="op" id="2297619">:=</span>&nbsp;<span class="ident" id="2297622">s</span><span class="op" id="2297623">.</span><span class="ident" id="2297624">mustReadRune</span><span class="op" id="2297636">(</span><span class="op" id="2297637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297642">if</span>&nbsp;<span class="ident" id="2297645">r</span>&nbsp;<span class="op" id="2297647">==</span>&nbsp;<span class="ident" id="2297650">quote</span>&nbsp;<span class="op" id="2297656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297662">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2297671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2297676">s</span><span class="op" id="2297677">.</span><span class="ident" id="2297678">buf</span><span class="op" id="2297681">.</span><span class="ident" id="2297682">WriteRune</span><span class="op" id="2297691">(</span><span class="ident" id="2297692">r</span><span class="op" id="2297693">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2297697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297701">return</span>&nbsp;<span class="builtintype" id="2297708">string</span><span class="op" id="2297714">(</span><span class="ident" id="2297715">s</span><span class="op" id="2297716">.</span><span class="ident" id="2297717">buf</span><span class="op" id="2297720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297723">case</span>&nbsp;<span class="string" id="2297728">&#39;&#34;&#39;</span><span class="op" id="2297731">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2297735">//&nbsp;Double-quoted:&nbsp;Include&nbsp;the&nbsp;quotes&nbsp;and&nbsp;let&nbsp;strconv.Unquote&nbsp;do&nbsp;the&nbsp;backslash&nbsp;escapes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2297824">s</span><span class="op" id="2297825">.</span><span class="ident" id="2297826">buf</span><span class="op" id="2297829">.</span><span class="ident" id="2297830">WriteRune</span><span class="op" id="2297839">(</span><span class="ident" id="2297840">quote</span><span class="op" id="2297845">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297849">for</span>&nbsp;<span class="op" id="2297853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2297858">r</span>&nbsp;<span class="op" id="2297860">:=</span>&nbsp;<span class="ident" id="2297863">s</span><span class="op" id="2297864">.</span><span class="ident" id="2297865">mustReadRune</span><span class="op" id="2297877">(</span><span class="op" id="2297878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2297883">s</span><span class="op" id="2297884">.</span><span class="ident" id="2297885">buf</span><span class="op" id="2297888">.</span><span class="ident" id="2297889">WriteRune</span><span class="op" id="2297898">(</span><span class="ident" id="2297899">r</span><span class="op" id="2297900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2297905">if</span>&nbsp;<span class="ident" id="2297908">r</span>&nbsp;<span class="op" id="2297910">==</span>&nbsp;<span class="string" id="2297913">&#39;\\&#39;</span>&nbsp;<span class="op" id="2297918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2297924">//&nbsp;In&nbsp;a&nbsp;legal&nbsp;backslash&nbsp;escape,&nbsp;no&nbsp;matter&nbsp;how&nbsp;long,&nbsp;only&nbsp;the&nbsp;character</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2297999">//&nbsp;immediately&nbsp;after&nbsp;the&nbsp;escape&nbsp;can&nbsp;itself&nbsp;be&nbsp;a&nbsp;backslash&nbsp;or&nbsp;quote.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2298071">//&nbsp;Thus&nbsp;we&nbsp;only&nbsp;need&nbsp;to&nbsp;protect&nbsp;the&nbsp;first&nbsp;character&nbsp;after&nbsp;the&nbsp;backslash.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2298148">s</span><span class="op" id="2298149">.</span><span class="ident" id="2298150">buf</span><span class="op" id="2298153">.</span><span class="ident" id="2298154">WriteRune</span><span class="op" id="2298163">(</span><span class="ident" id="2298164">s</span><span class="op" id="2298165">.</span><span class="ident" id="2298166">mustReadRune</span><span class="op" id="2298178">(</span><span class="op" id="2298179">)</span><span class="op" id="2298180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2298185">}</span>&nbsp;<span class="keyword" id="2298187">else</span>&nbsp;<span class="keyword" id="2298192">if</span>&nbsp;<span class="ident" id="2298195">r</span>&nbsp;<span class="op" id="2298197">==</span>&nbsp;<span class="string" id="2298200">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2298204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2298210">break</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2298219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2298223">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2298227">result</span><span class="op" id="2298233">,</span>&nbsp;<span class="ident" id="2298235">err</span>&nbsp;<span class="op" id="2298239">:=</span>&nbsp;<span class="ident" id="2298242">strconv</span><span class="op" id="2298249">.</span><span class="ident" id="2298250">Unquote</span><span class="op" id="2298257">(</span><span class="builtintype" id="2298258">string</span><span class="op" id="2298264">(</span><span class="ident" id="2298265">s</span><span class="op" id="2298266">.</span><span class="ident" id="2298267">buf</span><span class="op" id="2298270">)</span><span class="op" id="2298271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2298275">if</span>&nbsp;<span class="ident" id="2298278">err</span>&nbsp;<span class="op" id="2298282">!=</span>&nbsp;<span class="ident" id="2298285">nil</span>&nbsp;<span class="op" id="2298289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2298294">s</span><span class="op" id="2298295">.</span><span class="builtintype" id="2298296">error</span><span class="op" id="2298301">(</span><span class="ident" id="2298302">err</span><span class="op" id="2298305">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2298309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2298313">return</span>&nbsp;<span class="ident" id="2298320">result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2298328">default</span><span class="op" id="2298335">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2298339">s</span><span class="op" id="2298340">.</span><span class="ident" id="2298341">errorString</span><span class="op" id="2298352">(</span><span class="string" id="2298353">&#34;expected&nbsp;quoted&nbsp;string&#34;</span><span class="op" id="2298377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2298380">}</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2298383">return</span>&nbsp;<span class="string" id="2298390">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="2298393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2298396">//&nbsp;hexDigit&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;hexadecimal&nbsp;digit</span><br>
<span class="lineno"></span><span class="keyword" id="2298451">func</span>&nbsp;<span class="op" id="2298456">(</span><span class="ident" id="2298457">s</span>&nbsp;<span class="op" id="2298459">*</span><span class="ident" id="2298460">ss</span><span class="op" id="2298462">)</span>&nbsp;<span class="ident" id="2298464">hexDigit</span><span class="op" id="2298472">(</span><span class="ident" id="2298473">d</span>&nbsp;<span class="builtintype" id="2298475">rune</span><span class="op" id="2298479">)</span>&nbsp;<span class="builtintype" id="2298481">int</span>&nbsp;<span class="op" id="2298485">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2298488">digit</span>&nbsp;<span class="op" id="2298494">:=</span>&nbsp;<span class="builtintype" id="2298497">int</span><span class="op" id="2298500">(</span><span class="ident" id="2298501">d</span><span class="op" id="2298502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2298505">switch</span>&nbsp;<span class="ident" id="2298512">digit</span>&nbsp;<span class="op" id="2298518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2298521">case</span>&nbsp;<span class="string" id="2298526">&#39;0&#39;</span><span class="op" id="2298529">,</span>&nbsp;<span class="string" id="2298531">&#39;1&#39;</span><span class="op" id="2298534">,</span>&nbsp;<span class="string" id="2298536">&#39;2&#39;</span><span class="op" id="2298539">,</span>&nbsp;<span class="string" id="2298541">&#39;3&#39;</span><span class="op" id="2298544">,</span>&nbsp;<span class="string" id="2298546">&#39;4&#39;</span><span class="op" id="2298549">,</span>&nbsp;<span class="string" id="2298551">&#39;5&#39;</span><span class="op" id="2298554">,</span>&nbsp;<span class="string" id="2298556">&#39;6&#39;</span><span class="op" id="2298559">,</span>&nbsp;<span class="string" id="2298561">&#39;7&#39;</span><span class="op" id="2298564">,</span>&nbsp;<span class="string" id="2298566">&#39;8&#39;</span><span class="op" id="2298569">,</span>&nbsp;<span class="string" id="2298571">&#39;9&#39;</span><span class="op" id="2298574">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2298578">return</span>&nbsp;<span class="ident" id="2298585">digit</span>&nbsp;<span class="op" id="2298591">-</span>&nbsp;<span class="string" id="2298593">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2298598">case</span>&nbsp;<span class="string" id="2298603">&#39;a&#39;</span><span class="op" id="2298606">,</span>&nbsp;<span class="string" id="2298608">&#39;b&#39;</span><span class="op" id="2298611">,</span>&nbsp;<span class="string" id="2298613">&#39;c&#39;</span><span class="op" id="2298616">,</span>&nbsp;<span class="string" id="2298618">&#39;d&#39;</span><span class="op" id="2298621">,</span>&nbsp;<span class="string" id="2298623">&#39;e&#39;</span><span class="op" id="2298626">,</span>&nbsp;<span class="string" id="2298628">&#39;f&#39;</span><span class="op" id="2298631">:</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2298635">return</span>&nbsp;<span class="num" id="2298642">10</span>&nbsp;<span class="op" id="2298645">+</span>&nbsp;<span class="ident" id="2298647">digit</span>&nbsp;<span class="op" id="2298653">-</span>&nbsp;<span class="string" id="2298655">&#39;a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2298660">case</span>&nbsp;<span class="string" id="2298665">&#39;A&#39;</span><span class="op" id="2298668">,</span>&nbsp;<span class="string" id="2298670">&#39;B&#39;</span><span class="op" id="2298673">,</span>&nbsp;<span class="string" id="2298675">&#39;C&#39;</span><span class="op" id="2298678">,</span>&nbsp;<span class="string" id="2298680">&#39;D&#39;</span><span class="op" id="2298683">,</span>&nbsp;<span class="string" id="2298685">&#39;E&#39;</span><span class="op" id="2298688">,</span>&nbsp;<span class="string" id="2298690">&#39;F&#39;</span><span class="op" id="2298693">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2298697">return</span>&nbsp;<span class="num" id="2298704">10</span>&nbsp;<span class="op" id="2298707">+</span>&nbsp;<span class="ident" id="2298709">digit</span>&nbsp;<span class="op" id="2298715">-</span>&nbsp;<span class="string" id="2298717">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2298722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2298725">s</span><span class="op" id="2298726">.</span><span class="ident" id="2298727">errorString</span><span class="op" id="2298738">(</span><span class="string" id="2298739">&#34;illegal&nbsp;hex&nbsp;digit&#34;</span><span class="op" id="2298758">)</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2298761">return</span>&nbsp;<span class="num" id="2298768">0</span><br>
<span class="lineno"></span><span class="op" id="2298770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2298773">//&nbsp;hexByte&nbsp;returns&nbsp;the&nbsp;next&nbsp;hex-encoded&nbsp;(two-character)&nbsp;byte&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="2298850">//&nbsp;There&nbsp;must&nbsp;be&nbsp;either&nbsp;two&nbsp;hexadecimal&nbsp;digits&nbsp;or&nbsp;a&nbsp;space&nbsp;character&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno">895</span><span class="keyword" id="2298932">func</span>&nbsp;<span class="op" id="2298937">(</span><span class="ident" id="2298938">s</span>&nbsp;<span class="op" id="2298940">*</span><span class="ident" id="2298941">ss</span><span class="op" id="2298943">)</span>&nbsp;<span class="ident" id="2298945">hexByte</span><span class="op" id="2298952">(</span><span class="op" id="2298953">)</span>&nbsp;<span class="op" id="2298955">(</span><span class="ident" id="2298956">b</span>&nbsp;<span class="builtintype" id="2298958">byte</span><span class="op" id="2298962">,</span>&nbsp;<span class="ident" id="2298964">ok</span>&nbsp;<span class="builtintype" id="2298967">bool</span><span class="op" id="2298971">)</span>&nbsp;<span class="op" id="2298973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2298976">rune1</span>&nbsp;<span class="op" id="2298982">:=</span>&nbsp;<span class="ident" id="2298985">s</span><span class="op" id="2298986">.</span><span class="ident" id="2298987">getRune</span><span class="op" id="2298994">(</span><span class="op" id="2298995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2298998">if</span>&nbsp;<span class="ident" id="2299001">rune1</span>&nbsp;<span class="op" id="2299007">==</span>&nbsp;<span class="ident" id="2299010">eof</span>&nbsp;<span class="op" id="2299014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299018">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2299026">}</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299029">if</span>&nbsp;<span class="ident" id="2299032">isSpace</span><span class="op" id="2299039">(</span><span class="ident" id="2299040">rune1</span><span class="op" id="2299045">)</span>&nbsp;<span class="op" id="2299047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299051">s</span><span class="op" id="2299052">.</span><span class="ident" id="2299053">UnreadRune</span><span class="op" id="2299063">(</span><span class="op" id="2299064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299068">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2299076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299079">rune2</span>&nbsp;<span class="op" id="2299085">:=</span>&nbsp;<span class="ident" id="2299088">s</span><span class="op" id="2299089">.</span><span class="ident" id="2299090">mustReadRune</span><span class="op" id="2299102">(</span><span class="op" id="2299103">)</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299106">return</span>&nbsp;<span class="builtintype" id="2299113">byte</span><span class="op" id="2299117">(</span><span class="ident" id="2299118">s</span><span class="op" id="2299119">.</span><span class="ident" id="2299120">hexDigit</span><span class="op" id="2299128">(</span><span class="ident" id="2299129">rune1</span><span class="op" id="2299134">)</span><span class="op" id="2299135">&lt;&lt;</span><span class="num" id="2299137">4</span>&nbsp;<span class="op" id="2299139">|</span>&nbsp;<span class="ident" id="2299141">s</span><span class="op" id="2299142">.</span><span class="ident" id="2299143">hexDigit</span><span class="op" id="2299151">(</span><span class="ident" id="2299152">rune2</span><span class="op" id="2299157">)</span><span class="op" id="2299158">)</span><span class="op" id="2299159">,</span>&nbsp;<span class="builtintype" id="2299161">true</span><br>
<span class="lineno"></span><span class="op" id="2299166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2299169">//&nbsp;hexString&nbsp;returns&nbsp;the&nbsp;space-delimited&nbsp;hexpair-encoded&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2299234">func</span>&nbsp;<span class="op" id="2299239">(</span><span class="ident" id="2299240">s</span>&nbsp;<span class="op" id="2299242">*</span><span class="ident" id="2299243">ss</span><span class="op" id="2299245">)</span>&nbsp;<span class="ident" id="2299247">hexString</span><span class="op" id="2299256">(</span><span class="op" id="2299257">)</span>&nbsp;<span class="builtintype" id="2299259">string</span>&nbsp;<span class="op" id="2299266">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299269">s</span><span class="op" id="2299270">.</span><span class="ident" id="2299271">notEOF</span><span class="op" id="2299277">(</span><span class="op" id="2299278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299281">for</span>&nbsp;<span class="op" id="2299285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299289">b</span><span class="op" id="2299290">,</span>&nbsp;<span class="ident" id="2299292">ok</span>&nbsp;<span class="op" id="2299295">:=</span>&nbsp;<span class="ident" id="2299298">s</span><span class="op" id="2299299">.</span><span class="ident" id="2299300">hexByte</span><span class="op" id="2299307">(</span><span class="op" id="2299308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299312">if</span>&nbsp;<span class="op" id="2299315">!</span><span class="ident" id="2299316">ok</span>&nbsp;<span class="op" id="2299319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299324">break</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2299332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299336">s</span><span class="op" id="2299337">.</span><span class="ident" id="2299338">buf</span><span class="op" id="2299341">.</span><span class="ident" id="2299342">WriteByte</span><span class="op" id="2299351">(</span><span class="ident" id="2299352">b</span><span class="op" id="2299353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2299356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299359">if</span>&nbsp;<span class="builtinfunc" id="2299362">len</span><span class="op" id="2299365">(</span><span class="ident" id="2299366">s</span><span class="op" id="2299367">.</span><span class="ident" id="2299368">buf</span><span class="op" id="2299371">)</span>&nbsp;<span class="op" id="2299373">==</span>&nbsp;<span class="num" id="2299376">0</span>&nbsp;<span class="op" id="2299378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299382">s</span><span class="op" id="2299383">.</span><span class="ident" id="2299384">errorString</span><span class="op" id="2299395">(</span><span class="string" id="2299396">&#34;no&nbsp;hex&nbsp;data&nbsp;for&nbsp;%x&nbsp;string&#34;</span><span class="op" id="2299423">)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299427">return</span>&nbsp;<span class="string" id="2299434">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2299438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299441">return</span>&nbsp;<span class="builtintype" id="2299448">string</span><span class="op" id="2299454">(</span><span class="ident" id="2299455">s</span><span class="op" id="2299456">.</span><span class="ident" id="2299457">buf</span><span class="op" id="2299460">)</span><br>
<span class="lineno"></span><span class="op" id="2299462">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="keyword" id="2299465">const</span>&nbsp;<span class="ident" id="2299471">floatVerbs</span>&nbsp;<span class="op" id="2299482">=</span>&nbsp;<span class="string" id="2299484">&#34;beEfFgGv&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2299496">const</span>&nbsp;<span class="ident" id="2299502">hugeWid</span>&nbsp;<span class="op" id="2299510">=</span>&nbsp;<span class="num" id="2299512">1</span>&nbsp;<span class="op" id="2299514">&lt;&lt;</span>&nbsp;<span class="num" id="2299517">30</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2299521">//&nbsp;scanOne&nbsp;scans&nbsp;a&nbsp;single&nbsp;value,&nbsp;deriving&nbsp;the&nbsp;scanner&nbsp;from&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;argument.</span><br>
<span class="lineno">930</span><span class="keyword" id="2299606">func</span>&nbsp;<span class="op" id="2299611">(</span><span class="ident" id="2299612">s</span>&nbsp;<span class="op" id="2299614">*</span><span class="ident" id="2299615">ss</span><span class="op" id="2299617">)</span>&nbsp;<span class="ident" id="2299619">scanOne</span><span class="op" id="2299626">(</span><span class="ident" id="2299627">verb</span>&nbsp;<span class="builtintype" id="2299632">rune</span><span class="op" id="2299636">,</span>&nbsp;<span class="ident" id="2299638">arg</span>&nbsp;<span class="keyword" id="2299642">interface</span><span class="op" id="2299651">{</span><span class="op" id="2299652">}</span><span class="op" id="2299653">)</span>&nbsp;<span class="op" id="2299655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299658">s</span><span class="op" id="2299659">.</span><span class="ident" id="2299660">buf</span>&nbsp;<span class="op" id="2299664">=</span>&nbsp;<span class="ident" id="2299666">s</span><span class="op" id="2299667">.</span><span class="ident" id="2299668">buf</span><span class="op" id="2299671">[</span><span class="op" id="2299672">:</span><span class="num" id="2299673">0</span><span class="op" id="2299674">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299677">var</span>&nbsp;<span class="ident" id="2299681">err</span>&nbsp;<span class="builtintype" id="2299685">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2299692">//&nbsp;If&nbsp;the&nbsp;parameter&nbsp;has&nbsp;its&nbsp;own&nbsp;Scan&nbsp;method,&nbsp;use&nbsp;that.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299748">if</span>&nbsp;<span class="ident" id="2299751">v</span><span class="op" id="2299752">,</span>&nbsp;<span class="ident" id="2299754">ok</span>&nbsp;<span class="op" id="2299757">:=</span>&nbsp;<span class="ident" id="2299760">arg</span><span class="op" id="2299763">.</span><span class="op" id="2299764">(</span><span class="ident" id="2299765">Scanner</span><span class="op" id="2299772">)</span><span class="op" id="2299773">;</span>&nbsp;<span class="ident" id="2299775">ok</span>&nbsp;<span class="op" id="2299778">{</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299782">err</span>&nbsp;<span class="op" id="2299786">=</span>&nbsp;<span class="ident" id="2299788">v</span><span class="op" id="2299789">.</span><span class="ident" id="2299790">Scan</span><span class="op" id="2299794">(</span><span class="ident" id="2299795">s</span><span class="op" id="2299796">,</span>&nbsp;<span class="ident" id="2299798">verb</span><span class="op" id="2299802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299806">if</span>&nbsp;<span class="ident" id="2299809">err</span>&nbsp;<span class="op" id="2299813">!=</span>&nbsp;<span class="ident" id="2299816">nil</span>&nbsp;<span class="op" id="2299820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299825">if</span>&nbsp;<span class="ident" id="2299828">err</span>&nbsp;<span class="op" id="2299832">==</span>&nbsp;<span class="ident" id="2299835">io</span><span class="op" id="2299837">.</span><span class="ident" id="2299838">EOF</span>&nbsp;<span class="op" id="2299842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299848">err</span>&nbsp;<span class="op" id="2299852">=</span>&nbsp;<span class="ident" id="2299854">io</span><span class="op" id="2299856">.</span><span class="ident" id="2299857">ErrUnexpectedEOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2299877">}</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2299882">s</span><span class="op" id="2299883">.</span><span class="builtintype" id="2299884">error</span><span class="op" id="2299889">(</span><span class="ident" id="2299890">err</span><span class="op" id="2299893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2299897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299901">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2299909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299913">switch</span>&nbsp;<span class="ident" id="2299920">v</span>&nbsp;<span class="op" id="2299922">:=</span>&nbsp;<span class="ident" id="2299925">arg</span><span class="op" id="2299928">.</span><span class="op" id="2299929">(</span><span class="keyword" id="2299930">type</span><span class="op" id="2299934">)</span>&nbsp;<span class="op" id="2299936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299939">case</span>&nbsp;<span class="op" id="2299944">*</span><span class="builtintype" id="2299945">bool</span><span class="op" id="2299949">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2299953">*</span><span class="ident" id="2299954">v</span>&nbsp;<span class="op" id="2299956">=</span>&nbsp;<span class="ident" id="2299958">s</span><span class="op" id="2299959">.</span><span class="ident" id="2299960">scanBool</span><span class="op" id="2299968">(</span><span class="ident" id="2299969">verb</span><span class="op" id="2299973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2299976">case</span>&nbsp;<span class="op" id="2299981">*</span><span class="builtintype" id="2299982">complex64</span><span class="op" id="2299991">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2299995">*</span><span class="ident" id="2299996">v</span>&nbsp;<span class="op" id="2299998">=</span>&nbsp;<span class="builtintype" id="2300000">complex64</span><span class="op" id="2300009">(</span><span class="ident" id="2300010">s</span><span class="op" id="2300011">.</span><span class="ident" id="2300012">scanComplex</span><span class="op" id="2300023">(</span><span class="ident" id="2300024">verb</span><span class="op" id="2300028">,</span>&nbsp;<span class="num" id="2300030">64</span><span class="op" id="2300032">)</span><span class="op" id="2300033">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300036">case</span>&nbsp;<span class="op" id="2300041">*</span><span class="builtintype" id="2300042">complex128</span><span class="op" id="2300052">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300056">*</span><span class="ident" id="2300057">v</span>&nbsp;<span class="op" id="2300059">=</span>&nbsp;<span class="ident" id="2300061">s</span><span class="op" id="2300062">.</span><span class="ident" id="2300063">scanComplex</span><span class="op" id="2300074">(</span><span class="ident" id="2300075">verb</span><span class="op" id="2300079">,</span>&nbsp;<span class="num" id="2300081">128</span><span class="op" id="2300084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300087">case</span>&nbsp;<span class="op" id="2300092">*</span><span class="builtintype" id="2300093">int</span><span class="op" id="2300096">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300100">*</span><span class="ident" id="2300101">v</span>&nbsp;<span class="op" id="2300103">=</span>&nbsp;<span class="builtintype" id="2300105">int</span><span class="op" id="2300108">(</span><span class="ident" id="2300109">s</span><span class="op" id="2300110">.</span><span class="ident" id="2300111">scanInt</span><span class="op" id="2300118">(</span><span class="ident" id="2300119">verb</span><span class="op" id="2300123">,</span>&nbsp;<span class="ident" id="2300125">intBits</span><span class="op" id="2300132">)</span><span class="op" id="2300133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300136">case</span>&nbsp;<span class="op" id="2300141">*</span><span class="builtintype" id="2300142">int8</span><span class="op" id="2300146">:</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300150">*</span><span class="ident" id="2300151">v</span>&nbsp;<span class="op" id="2300153">=</span>&nbsp;<span class="builtintype" id="2300155">int8</span><span class="op" id="2300159">(</span><span class="ident" id="2300160">s</span><span class="op" id="2300161">.</span><span class="ident" id="2300162">scanInt</span><span class="op" id="2300169">(</span><span class="ident" id="2300170">verb</span><span class="op" id="2300174">,</span>&nbsp;<span class="num" id="2300176">8</span><span class="op" id="2300177">)</span><span class="op" id="2300178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300181">case</span>&nbsp;<span class="op" id="2300186">*</span><span class="builtintype" id="2300187">int16</span><span class="op" id="2300192">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300196">*</span><span class="ident" id="2300197">v</span>&nbsp;<span class="op" id="2300199">=</span>&nbsp;<span class="builtintype" id="2300201">int16</span><span class="op" id="2300206">(</span><span class="ident" id="2300207">s</span><span class="op" id="2300208">.</span><span class="ident" id="2300209">scanInt</span><span class="op" id="2300216">(</span><span class="ident" id="2300217">verb</span><span class="op" id="2300221">,</span>&nbsp;<span class="num" id="2300223">16</span><span class="op" id="2300225">)</span><span class="op" id="2300226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300229">case</span>&nbsp;<span class="op" id="2300234">*</span><span class="builtintype" id="2300235">int32</span><span class="op" id="2300240">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300244">*</span><span class="ident" id="2300245">v</span>&nbsp;<span class="op" id="2300247">=</span>&nbsp;<span class="builtintype" id="2300249">int32</span><span class="op" id="2300254">(</span><span class="ident" id="2300255">s</span><span class="op" id="2300256">.</span><span class="ident" id="2300257">scanInt</span><span class="op" id="2300264">(</span><span class="ident" id="2300265">verb</span><span class="op" id="2300269">,</span>&nbsp;<span class="num" id="2300271">32</span><span class="op" id="2300273">)</span><span class="op" id="2300274">)</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300277">case</span>&nbsp;<span class="op" id="2300282">*</span><span class="ident" id="2300283">int64</span><span class="op" id="2300288">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300292">*</span><span class="ident" id="2300293">v</span>&nbsp;<span class="op" id="2300295">=</span>&nbsp;<span class="ident" id="2300297">s</span><span class="op" id="2300298">.</span><span class="ident" id="2300299">scanInt</span><span class="op" id="2300306">(</span><span class="ident" id="2300307">verb</span><span class="op" id="2300311">,</span>&nbsp;<span class="num" id="2300313">64</span><span class="op" id="2300315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300318">case</span>&nbsp;<span class="op" id="2300323">*</span><span class="builtintype" id="2300324">uint</span><span class="op" id="2300328">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300332">*</span><span class="ident" id="2300333">v</span>&nbsp;<span class="op" id="2300335">=</span>&nbsp;<span class="builtintype" id="2300337">uint</span><span class="op" id="2300341">(</span><span class="ident" id="2300342">s</span><span class="op" id="2300343">.</span><span class="ident" id="2300344">scanUint</span><span class="op" id="2300352">(</span><span class="ident" id="2300353">verb</span><span class="op" id="2300357">,</span>&nbsp;<span class="ident" id="2300359">intBits</span><span class="op" id="2300366">)</span><span class="op" id="2300367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300370">case</span>&nbsp;<span class="op" id="2300375">*</span><span class="builtintype" id="2300376">uint8</span><span class="op" id="2300381">:</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300385">*</span><span class="ident" id="2300386">v</span>&nbsp;<span class="op" id="2300388">=</span>&nbsp;<span class="builtintype" id="2300390">uint8</span><span class="op" id="2300395">(</span><span class="ident" id="2300396">s</span><span class="op" id="2300397">.</span><span class="ident" id="2300398">scanUint</span><span class="op" id="2300406">(</span><span class="ident" id="2300407">verb</span><span class="op" id="2300411">,</span>&nbsp;<span class="num" id="2300413">8</span><span class="op" id="2300414">)</span><span class="op" id="2300415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300418">case</span>&nbsp;<span class="op" id="2300423">*</span><span class="builtintype" id="2300424">uint16</span><span class="op" id="2300430">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300434">*</span><span class="ident" id="2300435">v</span>&nbsp;<span class="op" id="2300437">=</span>&nbsp;<span class="builtintype" id="2300439">uint16</span><span class="op" id="2300445">(</span><span class="ident" id="2300446">s</span><span class="op" id="2300447">.</span><span class="ident" id="2300448">scanUint</span><span class="op" id="2300456">(</span><span class="ident" id="2300457">verb</span><span class="op" id="2300461">,</span>&nbsp;<span class="num" id="2300463">16</span><span class="op" id="2300465">)</span><span class="op" id="2300466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300469">case</span>&nbsp;<span class="op" id="2300474">*</span><span class="builtintype" id="2300475">uint32</span><span class="op" id="2300481">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300485">*</span><span class="ident" id="2300486">v</span>&nbsp;<span class="op" id="2300488">=</span>&nbsp;<span class="builtintype" id="2300490">uint32</span><span class="op" id="2300496">(</span><span class="ident" id="2300497">s</span><span class="op" id="2300498">.</span><span class="ident" id="2300499">scanUint</span><span class="op" id="2300507">(</span><span class="ident" id="2300508">verb</span><span class="op" id="2300512">,</span>&nbsp;<span class="num" id="2300514">32</span><span class="op" id="2300516">)</span><span class="op" id="2300517">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300520">case</span>&nbsp;<span class="op" id="2300525">*</span><span class="ident" id="2300526">uint64</span><span class="op" id="2300532">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300536">*</span><span class="ident" id="2300537">v</span>&nbsp;<span class="op" id="2300539">=</span>&nbsp;<span class="ident" id="2300541">s</span><span class="op" id="2300542">.</span><span class="ident" id="2300543">scanUint</span><span class="op" id="2300551">(</span><span class="ident" id="2300552">verb</span><span class="op" id="2300556">,</span>&nbsp;<span class="num" id="2300558">64</span><span class="op" id="2300560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300563">case</span>&nbsp;<span class="op" id="2300568">*</span><span class="builtintype" id="2300569">uintptr</span><span class="op" id="2300576">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300580">*</span><span class="ident" id="2300581">v</span>&nbsp;<span class="op" id="2300583">=</span>&nbsp;<span class="builtintype" id="2300585">uintptr</span><span class="op" id="2300592">(</span><span class="ident" id="2300593">s</span><span class="op" id="2300594">.</span><span class="ident" id="2300595">scanUint</span><span class="op" id="2300603">(</span><span class="ident" id="2300604">verb</span><span class="op" id="2300608">,</span>&nbsp;<span class="ident" id="2300610">uintptrBits</span><span class="op" id="2300621">)</span><span class="op" id="2300622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2300625">//&nbsp;Floats&nbsp;are&nbsp;tricky&nbsp;because&nbsp;you&nbsp;want&nbsp;to&nbsp;scan&nbsp;in&nbsp;the&nbsp;precision&nbsp;of&nbsp;the&nbsp;result,&nbsp;not</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2300708">//&nbsp;scan&nbsp;in&nbsp;high&nbsp;precision&nbsp;and&nbsp;convert,&nbsp;in&nbsp;order&nbsp;to&nbsp;preserve&nbsp;the&nbsp;correct&nbsp;error&nbsp;condition.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300798">case</span>&nbsp;<span class="op" id="2300803">*</span><span class="builtintype" id="2300804">float32</span><span class="op" id="2300811">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300815">if</span>&nbsp;<span class="ident" id="2300818">s</span><span class="op" id="2300819">.</span><span class="ident" id="2300820">okVerb</span><span class="op" id="2300826">(</span><span class="ident" id="2300827">verb</span><span class="op" id="2300831">,</span>&nbsp;<span class="ident" id="2300833">floatVerbs</span><span class="op" id="2300843">,</span>&nbsp;<span class="string" id="2300845">&#34;float32&#34;</span><span class="op" id="2300854">)</span>&nbsp;<span class="op" id="2300856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300861">s</span><span class="op" id="2300862">.</span><span class="ident" id="2300863">skipSpace</span><span class="op" id="2300872">(</span><span class="builtintype" id="2300873">false</span><span class="op" id="2300878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2300883">s</span><span class="op" id="2300884">.</span><span class="ident" id="2300885">notEOF</span><span class="op" id="2300891">(</span><span class="op" id="2300892">)</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300897">*</span><span class="ident" id="2300898">v</span>&nbsp;<span class="op" id="2300900">=</span>&nbsp;<span class="builtintype" id="2300902">float32</span><span class="op" id="2300909">(</span><span class="ident" id="2300910">s</span><span class="op" id="2300911">.</span><span class="ident" id="2300912">convertFloat</span><span class="op" id="2300924">(</span><span class="ident" id="2300925">s</span><span class="op" id="2300926">.</span><span class="ident" id="2300927">floatToken</span><span class="op" id="2300937">(</span><span class="op" id="2300938">)</span><span class="op" id="2300939">,</span>&nbsp;<span class="num" id="2300941">32</span><span class="op" id="2300943">)</span><span class="op" id="2300944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2300948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300951">case</span>&nbsp;<span class="op" id="2300956">*</span><span class="builtintype" id="2300957">float64</span><span class="op" id="2300964">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2300968">if</span>&nbsp;<span class="ident" id="2300971">s</span><span class="op" id="2300972">.</span><span class="ident" id="2300973">okVerb</span><span class="op" id="2300979">(</span><span class="ident" id="2300980">verb</span><span class="op" id="2300984">,</span>&nbsp;<span class="ident" id="2300986">floatVerbs</span><span class="op" id="2300996">,</span>&nbsp;<span class="string" id="2300998">&#34;float64&#34;</span><span class="op" id="2301007">)</span>&nbsp;<span class="op" id="2301009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301014">s</span><span class="op" id="2301015">.</span><span class="ident" id="2301016">skipSpace</span><span class="op" id="2301025">(</span><span class="builtintype" id="2301026">false</span><span class="op" id="2301031">)</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301036">s</span><span class="op" id="2301037">.</span><span class="ident" id="2301038">notEOF</span><span class="op" id="2301044">(</span><span class="op" id="2301045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2301050">*</span><span class="ident" id="2301051">v</span>&nbsp;<span class="op" id="2301053">=</span>&nbsp;<span class="ident" id="2301055">s</span><span class="op" id="2301056">.</span><span class="ident" id="2301057">convertFloat</span><span class="op" id="2301069">(</span><span class="ident" id="2301070">s</span><span class="op" id="2301071">.</span><span class="ident" id="2301072">floatToken</span><span class="op" id="2301082">(</span><span class="op" id="2301083">)</span><span class="op" id="2301084">,</span>&nbsp;<span class="num" id="2301086">64</span><span class="op" id="2301088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2301092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301095">case</span>&nbsp;<span class="op" id="2301100">*</span><span class="builtintype" id="2301101">string</span><span class="op" id="2301107">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2301111">*</span><span class="ident" id="2301112">v</span>&nbsp;<span class="op" id="2301114">=</span>&nbsp;<span class="ident" id="2301116">s</span><span class="op" id="2301117">.</span><span class="ident" id="2301118">convertString</span><span class="op" id="2301131">(</span><span class="ident" id="2301132">verb</span><span class="op" id="2301136">)</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301139">case</span>&nbsp;<span class="op" id="2301144">*</span><span class="op" id="2301145">[</span><span class="op" id="2301146">]</span><span class="builtintype" id="2301147">byte</span><span class="op" id="2301151">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2301155">//&nbsp;We&nbsp;scan&nbsp;to&nbsp;string&nbsp;and&nbsp;convert&nbsp;so&nbsp;we&nbsp;get&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2301220">//&nbsp;If&nbsp;we&nbsp;scanned&nbsp;to&nbsp;bytes,&nbsp;the&nbsp;slice&nbsp;would&nbsp;point&nbsp;at&nbsp;the&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2301286">*</span><span class="ident" id="2301287">v</span>&nbsp;<span class="op" id="2301289">=</span>&nbsp;<span class="op" id="2301291">[</span><span class="op" id="2301292">]</span><span class="builtintype" id="2301293">byte</span><span class="op" id="2301297">(</span><span class="ident" id="2301298">s</span><span class="op" id="2301299">.</span><span class="ident" id="2301300">convertString</span><span class="op" id="2301313">(</span><span class="ident" id="2301314">verb</span><span class="op" id="2301318">)</span><span class="op" id="2301319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301322">default</span><span class="op" id="2301329">:</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301333">val</span>&nbsp;<span class="op" id="2301337">:=</span>&nbsp;<span class="ident" id="2301340">reflect</span><span class="op" id="2301347">.</span><span class="ident" id="2301348">ValueOf</span><span class="op" id="2301355">(</span><span class="ident" id="2301356">v</span><span class="op" id="2301357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301361">ptr</span>&nbsp;<span class="op" id="2301365">:=</span>&nbsp;<span class="ident" id="2301368">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301374">if</span>&nbsp;<span class="ident" id="2301377">ptr</span><span class="op" id="2301380">.</span><span class="ident" id="2301381">Kind</span><span class="op" id="2301385">(</span><span class="op" id="2301386">)</span>&nbsp;<span class="op" id="2301388">!=</span>&nbsp;<span class="ident" id="2301391">reflect</span><span class="op" id="2301398">.</span><span class="ident" id="2301399">Ptr</span>&nbsp;<span class="op" id="2301403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301408">s</span><span class="op" id="2301409">.</span><span class="ident" id="2301410">errorString</span><span class="op" id="2301421">(</span><span class="string" id="2301422">&#34;type&nbsp;not&nbsp;a&nbsp;pointer:&nbsp;&#34;</span>&nbsp;<span class="op" id="2301445">+</span>&nbsp;<span class="ident" id="2301447">val</span><span class="op" id="2301450">.</span><span class="ident" id="2301451">Type</span><span class="op" id="2301455">(</span><span class="op" id="2301456">)</span><span class="op" id="2301457">.</span><span class="ident" id="2301458">String</span><span class="op" id="2301464">(</span><span class="op" id="2301465">)</span><span class="op" id="2301466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301471">return</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2301480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301484">switch</span>&nbsp;<span class="ident" id="2301491">v</span>&nbsp;<span class="op" id="2301493">:=</span>&nbsp;<span class="ident" id="2301496">ptr</span><span class="op" id="2301499">.</span><span class="ident" id="2301500">Elem</span><span class="op" id="2301504">(</span><span class="op" id="2301505">)</span><span class="op" id="2301506">;</span>&nbsp;<span class="ident" id="2301508">v</span><span class="op" id="2301509">.</span><span class="ident" id="2301510">Kind</span><span class="op" id="2301514">(</span><span class="op" id="2301515">)</span>&nbsp;<span class="op" id="2301517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301521">case</span>&nbsp;<span class="ident" id="2301526">reflect</span><span class="op" id="2301533">.</span><span class="ident" id="2301534">Bool</span><span class="op" id="2301538">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301543">v</span><span class="op" id="2301544">.</span><span class="ident" id="2301545">SetBool</span><span class="op" id="2301552">(</span><span class="ident" id="2301553">s</span><span class="op" id="2301554">.</span><span class="ident" id="2301555">scanBool</span><span class="op" id="2301563">(</span><span class="ident" id="2301564">verb</span><span class="op" id="2301568">)</span><span class="op" id="2301569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301573">case</span>&nbsp;<span class="ident" id="2301578">reflect</span><span class="op" id="2301585">.</span><span class="ident" id="2301586">Int</span><span class="op" id="2301589">,</span>&nbsp;<span class="ident" id="2301591">reflect</span><span class="op" id="2301598">.</span><span class="ident" id="2301599">Int8</span><span class="op" id="2301603">,</span>&nbsp;<span class="ident" id="2301605">reflect</span><span class="op" id="2301612">.</span><span class="ident" id="2301613">Int16</span><span class="op" id="2301618">,</span>&nbsp;<span class="ident" id="2301620">reflect</span><span class="op" id="2301627">.</span><span class="ident" id="2301628">Int32</span><span class="op" id="2301633">,</span>&nbsp;<span class="ident" id="2301635">reflect</span><span class="op" id="2301642">.</span><span class="ident" id="2301643">Int64</span><span class="op" id="2301648">:</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301653">v</span><span class="op" id="2301654">.</span><span class="ident" id="2301655">SetInt</span><span class="op" id="2301661">(</span><span class="ident" id="2301662">s</span><span class="op" id="2301663">.</span><span class="ident" id="2301664">scanInt</span><span class="op" id="2301671">(</span><span class="ident" id="2301672">verb</span><span class="op" id="2301676">,</span>&nbsp;<span class="ident" id="2301678">v</span><span class="op" id="2301679">.</span><span class="ident" id="2301680">Type</span><span class="op" id="2301684">(</span><span class="op" id="2301685">)</span><span class="op" id="2301686">.</span><span class="ident" id="2301687">Bits</span><span class="op" id="2301691">(</span><span class="op" id="2301692">)</span><span class="op" id="2301693">)</span><span class="op" id="2301694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301698">case</span>&nbsp;<span class="ident" id="2301703">reflect</span><span class="op" id="2301710">.</span><span class="ident" id="2301711">Uint</span><span class="op" id="2301715">,</span>&nbsp;<span class="ident" id="2301717">reflect</span><span class="op" id="2301724">.</span><span class="ident" id="2301725">Uint8</span><span class="op" id="2301730">,</span>&nbsp;<span class="ident" id="2301732">reflect</span><span class="op" id="2301739">.</span><span class="ident" id="2301740">Uint16</span><span class="op" id="2301746">,</span>&nbsp;<span class="ident" id="2301748">reflect</span><span class="op" id="2301755">.</span><span class="ident" id="2301756">Uint32</span><span class="op" id="2301762">,</span>&nbsp;<span class="ident" id="2301764">reflect</span><span class="op" id="2301771">.</span><span class="ident" id="2301772">Uint64</span><span class="op" id="2301778">,</span>&nbsp;<span class="ident" id="2301780">reflect</span><span class="op" id="2301787">.</span><span class="ident" id="2301788">Uintptr</span><span class="op" id="2301795">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301800">v</span><span class="op" id="2301801">.</span><span class="ident" id="2301802">SetUint</span><span class="op" id="2301809">(</span><span class="ident" id="2301810">s</span><span class="op" id="2301811">.</span><span class="ident" id="2301812">scanUint</span><span class="op" id="2301820">(</span><span class="ident" id="2301821">verb</span><span class="op" id="2301825">,</span>&nbsp;<span class="ident" id="2301827">v</span><span class="op" id="2301828">.</span><span class="ident" id="2301829">Type</span><span class="op" id="2301833">(</span><span class="op" id="2301834">)</span><span class="op" id="2301835">.</span><span class="ident" id="2301836">Bits</span><span class="op" id="2301840">(</span><span class="op" id="2301841">)</span><span class="op" id="2301842">)</span><span class="op" id="2301843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301847">case</span>&nbsp;<span class="ident" id="2301852">reflect</span><span class="op" id="2301859">.</span><span class="ident" id="2301860">String</span><span class="op" id="2301866">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301871">v</span><span class="op" id="2301872">.</span><span class="ident" id="2301873">SetString</span><span class="op" id="2301882">(</span><span class="ident" id="2301883">s</span><span class="op" id="2301884">.</span><span class="ident" id="2301885">convertString</span><span class="op" id="2301898">(</span><span class="ident" id="2301899">verb</span><span class="op" id="2301903">)</span><span class="op" id="2301904">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301908">case</span>&nbsp;<span class="ident" id="2301913">reflect</span><span class="op" id="2301920">.</span><span class="ident" id="2301921">Slice</span><span class="op" id="2301926">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2301931">//&nbsp;For&nbsp;now,&nbsp;can&nbsp;only&nbsp;handle&nbsp;(renamed)&nbsp;[]byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2301980">typ</span>&nbsp;<span class="op" id="2301984">:=</span>&nbsp;<span class="ident" id="2301987">v</span><span class="op" id="2301988">.</span><span class="ident" id="2301989">Type</span><span class="op" id="2301993">(</span><span class="op" id="2301994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2301999">if</span>&nbsp;<span class="ident" id="2302002">typ</span><span class="op" id="2302005">.</span><span class="ident" id="2302006">Elem</span><span class="op" id="2302010">(</span><span class="op" id="2302011">)</span><span class="op" id="2302012">.</span><span class="ident" id="2302013">Kind</span><span class="op" id="2302017">(</span><span class="op" id="2302018">)</span>&nbsp;<span class="op" id="2302020">!=</span>&nbsp;<span class="ident" id="2302023">reflect</span><span class="op" id="2302030">.</span><span class="ident" id="2302031">Uint8</span>&nbsp;<span class="op" id="2302037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2302043">s</span><span class="op" id="2302044">.</span><span class="ident" id="2302045">errorString</span><span class="op" id="2302056">(</span><span class="string" id="2302057">&#34;can&#39;t&nbsp;scan&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="2302077">+</span>&nbsp;<span class="ident" id="2302079">val</span><span class="op" id="2302082">.</span><span class="ident" id="2302083">Type</span><span class="op" id="2302087">(</span><span class="op" id="2302088">)</span><span class="op" id="2302089">.</span><span class="ident" id="2302090">String</span><span class="op" id="2302096">(</span><span class="op" id="2302097">)</span><span class="op" id="2302098">)</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2302103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2302108">str</span>&nbsp;<span class="op" id="2302112">:=</span>&nbsp;<span class="ident" id="2302115">s</span><span class="op" id="2302116">.</span><span class="ident" id="2302117">convertString</span><span class="op" id="2302130">(</span><span class="ident" id="2302131">verb</span><span class="op" id="2302135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2302140">v</span><span class="op" id="2302141">.</span><span class="ident" id="2302142">Set</span><span class="op" id="2302145">(</span><span class="ident" id="2302146">reflect</span><span class="op" id="2302153">.</span><span class="ident" id="2302154">MakeSlice</span><span class="op" id="2302163">(</span><span class="ident" id="2302164">typ</span><span class="op" id="2302167">,</span>&nbsp;<span class="builtinfunc" id="2302169">len</span><span class="op" id="2302172">(</span><span class="ident" id="2302173">str</span><span class="op" id="2302176">)</span><span class="op" id="2302177">,</span>&nbsp;<span class="builtinfunc" id="2302179">len</span><span class="op" id="2302182">(</span><span class="ident" id="2302183">str</span><span class="op" id="2302186">)</span><span class="op" id="2302187">)</span><span class="op" id="2302188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2302193">for</span>&nbsp;<span class="ident" id="2302197">i</span>&nbsp;<span class="op" id="2302199">:=</span>&nbsp;<span class="num" id="2302202">0</span><span class="op" id="2302203">;</span>&nbsp;<span class="ident" id="2302205">i</span>&nbsp;<span class="op" id="2302207">&lt;</span>&nbsp;<span class="builtinfunc" id="2302209">len</span><span class="op" id="2302212">(</span><span class="ident" id="2302213">str</span><span class="op" id="2302216">)</span><span class="op" id="2302217">;</span>&nbsp;<span class="ident" id="2302219">i</span><span class="op" id="2302220">++</span>&nbsp;<span class="op" id="2302223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2302229">v</span><span class="op" id="2302230">.</span><span class="ident" id="2302231">Index</span><span class="op" id="2302236">(</span><span class="ident" id="2302237">i</span><span class="op" id="2302238">)</span><span class="op" id="2302239">.</span><span class="ident" id="2302240">SetUint</span><span class="op" id="2302247">(</span><span class="ident" id="2302248">uint64</span><span class="op" id="2302254">(</span><span class="ident" id="2302255">str</span><span class="op" id="2302258">[</span><span class="ident" id="2302259">i</span><span class="op" id="2302260">]</span><span class="op" id="2302261">)</span><span class="op" id="2302262">)</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2302267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2302271">case</span>&nbsp;<span class="ident" id="2302276">reflect</span><span class="op" id="2302283">.</span><span class="ident" id="2302284">Float32</span><span class="op" id="2302291">,</span>&nbsp;<span class="ident" id="2302293">reflect</span><span class="op" id="2302300">.</span><span class="ident" id="2302301">Float64</span><span class="op" id="2302308">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2302313">s</span><span class="op" id="2302314">.</span><span class="ident" id="2302315">skipSpace</span><span class="op" id="2302324">(</span><span class="builtintype" id="2302325">false</span><span class="op" id="2302330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2302335">s</span><span class="op" id="2302336">.</span><span class="ident" id="2302337">notEOF</span><span class="op" id="2302343">(</span><span class="op" id="2302344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2302349">v</span><span class="op" id="2302350">.</span><span class="ident" id="2302351">SetFloat</span><span class="op" id="2302359">(</span><span class="ident" id="2302360">s</span><span class="op" id="2302361">.</span><span class="ident" id="2302362">convertFloat</span><span class="op" id="2302374">(</span><span class="ident" id="2302375">s</span><span class="op" id="2302376">.</span><span class="ident" id="2302377">floatToken</span><span class="op" id="2302387">(</span><span class="op" id="2302388">)</span><span class="op" id="2302389">,</span>&nbsp;<span class="ident" id="2302391">v</span><span class="op" id="2302392">.</span><span class="ident" id="2302393">Type</span><span class="op" id="2302397">(</span><span class="op" id="2302398">)</span><span class="op" id="2302399">.</span><span class="ident" id="2302400">Bits</span><span class="op" id="2302404">(</span><span class="op" id="2302405">)</span><span class="op" id="2302406">)</span><span class="op" id="2302407">)</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2302411">case</span>&nbsp;<span class="ident" id="2302416">reflect</span><span class="op" id="2302423">.</span><span class="ident" id="2302424">Complex64</span><span class="op" id="2302433">,</span>&nbsp;<span class="ident" id="2302435">reflect</span><span class="op" id="2302442">.</span><span class="ident" id="2302443">Complex128</span><span class="op" id="2302453">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2302458">v</span><span class="op" id="2302459">.</span><span class="ident" id="2302460">SetComplex</span><span class="op" id="2302470">(</span><span class="ident" id="2302471">s</span><span class="op" id="2302472">.</span><span class="ident" id="2302473">scanComplex</span><span class="op" id="2302484">(</span><span class="ident" id="2302485">verb</span><span class="op" id="2302489">,</span>&nbsp;<span class="ident" id="2302491">v</span><span class="op" id="2302492">.</span><span class="ident" id="2302493">Type</span><span class="op" id="2302497">(</span><span class="op" id="2302498">)</span><span class="op" id="2302499">.</span><span class="ident" id="2302500">Bits</span><span class="op" id="2302504">(</span><span class="op" id="2302505">)</span><span class="op" id="2302506">)</span><span class="op" id="2302507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2302511">default</span><span class="op" id="2302518">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2302523">s</span><span class="op" id="2302524">.</span><span class="ident" id="2302525">errorString</span><span class="op" id="2302536">(</span><span class="string" id="2302537">&#34;can&#39;t&nbsp;scan&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="2302557">+</span>&nbsp;<span class="ident" id="2302559">val</span><span class="op" id="2302562">.</span><span class="ident" id="2302563">Type</span><span class="op" id="2302567">(</span><span class="op" id="2302568">)</span><span class="op" id="2302569">.</span><span class="ident" id="2302570">String</span><span class="op" id="2302576">(</span><span class="op" id="2302577">)</span><span class="op" id="2302578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2302582">}</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2302585">}</span><br>
<span class="lineno"></span><span class="op" id="2302587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2302590">//&nbsp;errorHandler&nbsp;turns&nbsp;local&nbsp;panics&nbsp;into&nbsp;error&nbsp;returns.</span><br>
<span class="lineno"></span><span class="keyword" id="2302645">func</span>&nbsp;<span class="ident" id="2302650">errorHandler</span><span class="op" id="2302662">(</span><span class="ident" id="2302663">errp</span>&nbsp;<span class="op" id="2302668">*</span><span class="builtintype" id="2302669">error</span><span class="op" id="2302674">)</span>&nbsp;<span class="op" id="2302676">{</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2302679">if</span>&nbsp;<span class="ident" id="2302682">e</span>&nbsp;<span class="op" id="2302684">:=</span>&nbsp;<span class="builtinfunc" id="2302687">recover</span><span class="op" id="2302694">(</span><span class="op" id="2302695">)</span><span class="op" id="2302696">;</span>&nbsp;<span class="ident" id="2302698">e</span>&nbsp;<span class="op" id="2302700">!=</span>&nbsp;<span class="ident" id="2302703">nil</span>&nbsp;<span class="op" id="2302707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2302711">if</span>&nbsp;<span class="ident" id="2302714">se</span><span class="op" id="2302716">,</span>&nbsp;<span class="ident" id="2302718">ok</span>&nbsp;<span class="op" id="2302721">:=</span>&nbsp;<span class="ident" id="2302724">e</span><span class="op" id="2302725">.</span><span class="op" id="2302726">(</span><span class="ident" id="2302727">scanError</span><span class="op" id="2302736">)</span><span class="op" id="2302737">;</span>&nbsp;<span class="ident" id="2302739">ok</span>&nbsp;<span class="op" id="2302742">{</span>&nbsp;<span class="comment" id="2302744">//&nbsp;catch&nbsp;local&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2302768">*</span><span class="ident" id="2302769">errp</span>&nbsp;<span class="op" id="2302774">=</span>&nbsp;<span class="ident" id="2302776">se</span><span class="op" id="2302778">.</span><span class="ident" id="2302779">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2302785">}</span>&nbsp;<span class="keyword" id="2302787">else</span>&nbsp;<span class="keyword" id="2302792">if</span>&nbsp;<span class="ident" id="2302795">eof</span><span class="op" id="2302798">,</span>&nbsp;<span class="ident" id="2302800">ok</span>&nbsp;<span class="op" id="2302803">:=</span>&nbsp;<span class="ident" id="2302806">e</span><span class="op" id="2302807">.</span><span class="op" id="2302808">(</span><span class="builtintype" id="2302809">error</span><span class="op" id="2302814">)</span><span class="op" id="2302815">;</span>&nbsp;<span class="ident" id="2302817">ok</span>&nbsp;<span class="op" id="2302820">&amp;&amp;</span>&nbsp;<span class="ident" id="2302823">eof</span>&nbsp;<span class="op" id="2302827">==</span>&nbsp;<span class="ident" id="2302830">io</span><span class="op" id="2302832">.</span><span class="ident" id="2302833">EOF</span>&nbsp;<span class="op" id="2302837">{</span>&nbsp;<span class="comment" id="2302839">//&nbsp;out&nbsp;of&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2302858">*</span><span class="ident" id="2302859">errp</span>&nbsp;<span class="op" id="2302864">=</span>&nbsp;<span class="ident" id="2302866">eof</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2302872">}</span>&nbsp;<span class="keyword" id="2302874">else</span>&nbsp;<span class="op" id="2302879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2302884">panic</span><span class="op" id="2302889">(</span><span class="ident" id="2302890">e</span><span class="op" id="2302891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2302895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2302898">}</span><br>
<span class="lineno"></span><span class="op" id="2302900">}</span><br>
<span class="lineno">1045</span><br>
<span class="lineno"></span><span class="comment" id="2302903">//&nbsp;doScan&nbsp;does&nbsp;the&nbsp;real&nbsp;work&nbsp;for&nbsp;scanning&nbsp;without&nbsp;a&nbsp;format&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2302970">func</span>&nbsp;<span class="op" id="2302975">(</span><span class="ident" id="2302976">s</span>&nbsp;<span class="op" id="2302978">*</span><span class="ident" id="2302979">ss</span><span class="op" id="2302981">)</span>&nbsp;<span class="ident" id="2302983">doScan</span><span class="op" id="2302989">(</span><span class="ident" id="2302990">a</span>&nbsp;<span class="op" id="2302992">[</span><span class="op" id="2302993">]</span><span class="keyword" id="2302994">interface</span><span class="op" id="2303003">{</span><span class="op" id="2303004">}</span><span class="op" id="2303005">)</span>&nbsp;<span class="op" id="2303007">(</span><span class="ident" id="2303008">numProcessed</span>&nbsp;<span class="builtintype" id="2303021">int</span><span class="op" id="2303024">,</span>&nbsp;<span class="ident" id="2303026">err</span>&nbsp;<span class="builtintype" id="2303030">error</span><span class="op" id="2303035">)</span>&nbsp;<span class="op" id="2303037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303040">defer</span>&nbsp;<span class="ident" id="2303046">errorHandler</span><span class="op" id="2303058">(</span><span class="op" id="2303059">&amp;</span><span class="ident" id="2303060">err</span><span class="op" id="2303063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303066">for</span>&nbsp;<span class="ident" id="2303070">_</span><span class="op" id="2303071">,</span>&nbsp;<span class="ident" id="2303073">arg</span>&nbsp;<span class="op" id="2303077">:=</span>&nbsp;<span class="keyword" id="2303080">range</span>&nbsp;<span class="ident" id="2303086">a</span>&nbsp;<span class="op" id="2303088">{</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2303092">s</span><span class="op" id="2303093">.</span><span class="ident" id="2303094">scanOne</span><span class="op" id="2303101">(</span><span class="string" id="2303102">&#39;v&#39;</span><span class="op" id="2303105">,</span>&nbsp;<span class="ident" id="2303107">arg</span><span class="op" id="2303110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2303114">numProcessed</span><span class="op" id="2303126">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2303130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2303133">//&nbsp;Check&nbsp;for&nbsp;newline&nbsp;if&nbsp;required.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303168">if</span>&nbsp;<span class="op" id="2303171">!</span><span class="ident" id="2303172">s</span><span class="op" id="2303173">.</span><span class="ident" id="2303174">nlIsSpace</span>&nbsp;<span class="op" id="2303184">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303188">for</span>&nbsp;<span class="op" id="2303192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2303197">r</span>&nbsp;<span class="op" id="2303199">:=</span>&nbsp;<span class="ident" id="2303202">s</span><span class="op" id="2303203">.</span><span class="ident" id="2303204">getRune</span><span class="op" id="2303211">(</span><span class="op" id="2303212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303217">if</span>&nbsp;<span class="ident" id="2303220">r</span>&nbsp;<span class="op" id="2303222">==</span>&nbsp;<span class="string" id="2303225">&#39;\n&#39;</span>&nbsp;<span class="op" id="2303230">||</span>&nbsp;<span class="ident" id="2303233">r</span>&nbsp;<span class="op" id="2303235">==</span>&nbsp;<span class="ident" id="2303238">eof</span>&nbsp;<span class="op" id="2303242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303248">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2303257">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303262">if</span>&nbsp;<span class="op" id="2303265">!</span><span class="ident" id="2303266">isSpace</span><span class="op" id="2303273">(</span><span class="ident" id="2303274">r</span><span class="op" id="2303275">)</span>&nbsp;<span class="op" id="2303277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2303283">s</span><span class="op" id="2303284">.</span><span class="ident" id="2303285">errorString</span><span class="op" id="2303296">(</span><span class="string" id="2303297">&#34;expected&nbsp;newline&#34;</span><span class="op" id="2303315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303321">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2303330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2303334">}</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2303337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303340">return</span><br>
<span class="lineno"></span><span class="op" id="2303347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2303350">//&nbsp;advance&nbsp;determines&nbsp;whether&nbsp;the&nbsp;next&nbsp;characters&nbsp;in&nbsp;the&nbsp;input&nbsp;match</span><br>
<span class="lineno">1070</span><span class="comment" id="2303419">//&nbsp;those&nbsp;of&nbsp;the&nbsp;format.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;(sic)&nbsp;consumed</span><br>
<span class="lineno"></span><span class="comment" id="2303490">//&nbsp;in&nbsp;the&nbsp;format.&nbsp;Newlines&nbsp;included,&nbsp;all&nbsp;runs&nbsp;of&nbsp;space&nbsp;characters&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2303559">//&nbsp;either&nbsp;input&nbsp;or&nbsp;format&nbsp;behave&nbsp;as&nbsp;a&nbsp;single&nbsp;space.&nbsp;This&nbsp;routine&nbsp;also</span><br>
<span class="lineno"></span><span class="comment" id="2303629">//&nbsp;handles&nbsp;the&nbsp;%%&nbsp;case.&nbsp;&nbsp;If&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;zero,&nbsp;either&nbsp;format</span><br>
<span class="lineno"></span><span class="comment" id="2303697">//&nbsp;starts&nbsp;with&nbsp;a&nbsp;%&nbsp;(with&nbsp;no&nbsp;following&nbsp;%)&nbsp;or&nbsp;the&nbsp;input&nbsp;is&nbsp;empty.</span><br>
<span class="lineno">1075</span><span class="comment" id="2303761">//&nbsp;If&nbsp;it&nbsp;is&nbsp;negative,&nbsp;the&nbsp;input&nbsp;did&nbsp;not&nbsp;match&nbsp;the&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2303819">func</span>&nbsp;<span class="op" id="2303824">(</span><span class="ident" id="2303825">s</span>&nbsp;<span class="op" id="2303827">*</span><span class="ident" id="2303828">ss</span><span class="op" id="2303830">)</span>&nbsp;<span class="ident" id="2303832">advance</span><span class="op" id="2303839">(</span><span class="ident" id="2303840">format</span>&nbsp;<span class="builtintype" id="2303847">string</span><span class="op" id="2303853">)</span>&nbsp;<span class="op" id="2303855">(</span><span class="ident" id="2303856">i</span>&nbsp;<span class="builtintype" id="2303858">int</span><span class="op" id="2303861">)</span>&nbsp;<span class="op" id="2303863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303866">for</span>&nbsp;<span class="ident" id="2303870">i</span>&nbsp;<span class="op" id="2303872">&lt;</span>&nbsp;<span class="builtinfunc" id="2303874">len</span><span class="op" id="2303877">(</span><span class="ident" id="2303878">format</span><span class="op" id="2303884">)</span>&nbsp;<span class="op" id="2303886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2303890">fmtc</span><span class="op" id="2303894">,</span>&nbsp;<span class="ident" id="2303896">w</span>&nbsp;<span class="op" id="2303898">:=</span>&nbsp;<span class="ident" id="2303901">utf8</span><span class="op" id="2303905">.</span><span class="ident" id="2303906">DecodeRuneInString</span><span class="op" id="2303924">(</span><span class="ident" id="2303925">format</span><span class="op" id="2303931">[</span><span class="ident" id="2303932">i</span><span class="op" id="2303933">:</span><span class="op" id="2303934">]</span><span class="op" id="2303935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2303939">if</span>&nbsp;<span class="ident" id="2303942">fmtc</span>&nbsp;<span class="op" id="2303947">==</span>&nbsp;<span class="string" id="2303950">&#39;%&#39;</span>&nbsp;<span class="op" id="2303954">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2303959">//&nbsp;%%&nbsp;acts&nbsp;like&nbsp;a&nbsp;real&nbsp;percent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2303993">nextc</span><span class="op" id="2303998">,</span>&nbsp;<span class="ident" id="2304000">_</span>&nbsp;<span class="op" id="2304002">:=</span>&nbsp;<span class="ident" id="2304005">utf8</span><span class="op" id="2304009">.</span><span class="ident" id="2304010">DecodeRuneInString</span><span class="op" id="2304028">(</span><span class="ident" id="2304029">format</span><span class="op" id="2304035">[</span><span class="ident" id="2304036">i</span><span class="op" id="2304037">+</span><span class="ident" id="2304038">w</span><span class="op" id="2304039">:</span><span class="op" id="2304040">]</span><span class="op" id="2304041">)</span>&nbsp;<span class="comment" id="2304043">//&nbsp;will&nbsp;not&nbsp;match&nbsp;%&nbsp;if&nbsp;string&nbsp;is&nbsp;empty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304085">if</span>&nbsp;<span class="ident" id="2304088">nextc</span>&nbsp;<span class="op" id="2304094">!=</span>&nbsp;<span class="string" id="2304097">&#39;%&#39;</span>&nbsp;<span class="op" id="2304101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304107">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2304117">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2304122">i</span>&nbsp;<span class="op" id="2304124">+=</span>&nbsp;<span class="ident" id="2304127">w</span>&nbsp;<span class="comment" id="2304129">//&nbsp;skip&nbsp;the&nbsp;first&nbsp;%</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2304151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2304155">sawSpace</span>&nbsp;<span class="op" id="2304164">:=</span>&nbsp;<span class="builtintype" id="2304167">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304175">for</span>&nbsp;<span class="ident" id="2304179">isSpace</span><span class="op" id="2304186">(</span><span class="ident" id="2304187">fmtc</span><span class="op" id="2304191">)</span>&nbsp;<span class="op" id="2304193">&amp;&amp;</span>&nbsp;<span class="ident" id="2304196">i</span>&nbsp;<span class="op" id="2304198">&lt;</span>&nbsp;<span class="builtinfunc" id="2304200">len</span><span class="op" id="2304203">(</span><span class="ident" id="2304204">format</span><span class="op" id="2304210">)</span>&nbsp;<span class="op" id="2304212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2304217">sawSpace</span>&nbsp;<span class="op" id="2304226">=</span>&nbsp;<span class="builtintype" id="2304228">true</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2304236">i</span>&nbsp;<span class="op" id="2304238">+=</span>&nbsp;<span class="ident" id="2304241">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2304246">fmtc</span><span class="op" id="2304250">,</span>&nbsp;<span class="ident" id="2304252">w</span>&nbsp;<span class="op" id="2304254">=</span>&nbsp;<span class="ident" id="2304256">utf8</span><span class="op" id="2304260">.</span><span class="ident" id="2304261">DecodeRuneInString</span><span class="op" id="2304279">(</span><span class="ident" id="2304280">format</span><span class="op" id="2304286">[</span><span class="ident" id="2304287">i</span><span class="op" id="2304288">:</span><span class="op" id="2304289">]</span><span class="op" id="2304290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2304294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304298">if</span>&nbsp;<span class="ident" id="2304301">sawSpace</span>&nbsp;<span class="op" id="2304310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2304315">//&nbsp;There&nbsp;was&nbsp;space&nbsp;in&nbsp;the&nbsp;format,&nbsp;so&nbsp;there&nbsp;should&nbsp;be&nbsp;space&nbsp;(EOF)</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2304383">//&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2304403">inputc</span>&nbsp;<span class="op" id="2304410">:=</span>&nbsp;<span class="ident" id="2304413">s</span><span class="op" id="2304414">.</span><span class="ident" id="2304415">getRune</span><span class="op" id="2304422">(</span><span class="op" id="2304423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304428">if</span>&nbsp;<span class="ident" id="2304431">inputc</span>&nbsp;<span class="op" id="2304438">==</span>&nbsp;<span class="ident" id="2304441">eof</span>&nbsp;<span class="op" id="2304445">||</span>&nbsp;<span class="ident" id="2304448">inputc</span>&nbsp;<span class="op" id="2304455">==</span>&nbsp;<span class="string" id="2304458">&#39;\n&#39;</span>&nbsp;<span class="op" id="2304463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2304469">//&nbsp;If&nbsp;we&#39;ve&nbsp;reached&nbsp;a&nbsp;newline,&nbsp;stop&nbsp;now;&nbsp;don&#39;t&nbsp;read&nbsp;ahead.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304532">return</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2304542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304547">if</span>&nbsp;<span class="op" id="2304550">!</span><span class="ident" id="2304551">isSpace</span><span class="op" id="2304558">(</span><span class="ident" id="2304559">inputc</span><span class="op" id="2304565">)</span>&nbsp;<span class="op" id="2304567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2304573">//&nbsp;Space&nbsp;in&nbsp;format&nbsp;but&nbsp;not&nbsp;in&nbsp;input:&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2304620">s</span><span class="op" id="2304621">.</span><span class="ident" id="2304622">errorString</span><span class="op" id="2304633">(</span><span class="string" id="2304634">&#34;expected&nbsp;space&nbsp;in&nbsp;input&nbsp;to&nbsp;match&nbsp;format&#34;</span><span class="op" id="2304675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2304680">}</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2304685">s</span><span class="op" id="2304686">.</span><span class="ident" id="2304687">skipSpace</span><span class="op" id="2304696">(</span><span class="builtintype" id="2304697">true</span><span class="op" id="2304701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304706">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2304717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2304721">inputc</span>&nbsp;<span class="op" id="2304728">:=</span>&nbsp;<span class="ident" id="2304731">s</span><span class="op" id="2304732">.</span><span class="ident" id="2304733">mustReadRune</span><span class="op" id="2304745">(</span><span class="op" id="2304746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304750">if</span>&nbsp;<span class="ident" id="2304753">fmtc</span>&nbsp;<span class="op" id="2304758">!=</span>&nbsp;<span class="ident" id="2304761">inputc</span>&nbsp;<span class="op" id="2304768">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2304773">s</span><span class="op" id="2304774">.</span><span class="ident" id="2304775">UnreadRune</span><span class="op" id="2304785">(</span><span class="op" id="2304786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304791">return</span>&nbsp;<span class="op" id="2304798">-</span><span class="num" id="2304799">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2304803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2304807">i</span>&nbsp;<span class="op" id="2304809">+=</span>&nbsp;<span class="ident" id="2304812">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2304815">}</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2304818">return</span><br>
<span class="lineno"></span><span class="op" id="2304825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2304828">//&nbsp;doScanf&nbsp;does&nbsp;the&nbsp;real&nbsp;work&nbsp;when&nbsp;scanning&nbsp;with&nbsp;a&nbsp;format&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2304894">//&nbsp;&nbsp;At&nbsp;the&nbsp;moment,&nbsp;it&nbsp;handles&nbsp;only&nbsp;pointers&nbsp;to&nbsp;basic&nbsp;types.</span><br>
<span class="lineno">1120</span><span class="keyword" id="2304954">func</span>&nbsp;<span class="op" id="2304959">(</span><span class="ident" id="2304960">s</span>&nbsp;<span class="op" id="2304962">*</span><span class="ident" id="2304963">ss</span><span class="op" id="2304965">)</span>&nbsp;<span class="ident" id="2304967">doScanf</span><span class="op" id="2304974">(</span><span class="ident" id="2304975">format</span>&nbsp;<span class="builtintype" id="2304982">string</span><span class="op" id="2304988">,</span>&nbsp;<span class="ident" id="2304990">a</span>&nbsp;<span class="op" id="2304992">[</span><span class="op" id="2304993">]</span><span class="keyword" id="2304994">interface</span><span class="op" id="2305003">{</span><span class="op" id="2305004">}</span><span class="op" id="2305005">)</span>&nbsp;<span class="op" id="2305007">(</span><span class="ident" id="2305008">numProcessed</span>&nbsp;<span class="builtintype" id="2305021">int</span><span class="op" id="2305024">,</span>&nbsp;<span class="ident" id="2305026">err</span>&nbsp;<span class="builtintype" id="2305030">error</span><span class="op" id="2305035">)</span>&nbsp;<span class="op" id="2305037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2305040">defer</span>&nbsp;<span class="ident" id="2305046">errorHandler</span><span class="op" id="2305058">(</span><span class="op" id="2305059">&amp;</span><span class="ident" id="2305060">err</span><span class="op" id="2305063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2305066">end</span>&nbsp;<span class="op" id="2305070">:=</span>&nbsp;<span class="builtinfunc" id="2305073">len</span><span class="op" id="2305076">(</span><span class="ident" id="2305077">format</span><span class="op" id="2305083">)</span>&nbsp;<span class="op" id="2305085">-</span>&nbsp;<span class="num" id="2305087">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2305090">//&nbsp;We&nbsp;process&nbsp;one&nbsp;item&nbsp;per&nbsp;non-trivial&nbsp;format</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2305137">for</span>&nbsp;<span class="ident" id="2305141">i</span>&nbsp;<span class="op" id="2305143">:=</span>&nbsp;<span class="num" id="2305146">0</span><span class="op" id="2305147">;</span>&nbsp;<span class="ident" id="2305149">i</span>&nbsp;<span class="op" id="2305151">&lt;=</span>&nbsp;<span class="ident" id="2305154">end</span><span class="op" id="2305157">;</span>&nbsp;<span class="op" id="2305159">{</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2305163">w</span>&nbsp;<span class="op" id="2305165">:=</span>&nbsp;<span class="ident" id="2305168">s</span><span class="op" id="2305169">.</span><span class="ident" id="2305170">advance</span><span class="op" id="2305177">(</span><span class="ident" id="2305178">format</span><span class="op" id="2305184">[</span><span class="ident" id="2305185">i</span><span class="op" id="2305186">:</span><span class="op" id="2305187">]</span><span class="op" id="2305188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2305192">if</span>&nbsp;<span class="ident" id="2305195">w</span>&nbsp;<span class="op" id="2305197">&gt;</span>&nbsp;<span class="num" id="2305199">0</span>&nbsp;<span class="op" id="2305201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2305206">i</span>&nbsp;<span class="op" id="2305208">+=</span>&nbsp;<span class="ident" id="2305211">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2305216">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2305227">}</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2305231">//&nbsp;Either&nbsp;we&nbsp;failed&nbsp;to&nbsp;advance,&nbsp;we&nbsp;have&nbsp;a&nbsp;percent&nbsp;character,&nbsp;or&nbsp;we&nbsp;ran&nbsp;out&nbsp;of&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2305318">if</span>&nbsp;<span class="ident" id="2305321">format</span><span class="op" id="2305327">[</span><span class="ident" id="2305328">i</span><span class="op" id="2305329">]</span>&nbsp;<span class="op" id="2305331">!=</span>&nbsp;<span class="string" id="2305334">&#39;%&#39;</span>&nbsp;<span class="op" id="2305338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2305343">//&nbsp;Can&#39;t&nbsp;advance&nbsp;format.&nbsp;&nbsp;Why&nbsp;not?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2305381">if</span>&nbsp;<span class="ident" id="2305384">w</span>&nbsp;<span class="op" id="2305386">&lt;</span>&nbsp;<span class="num" id="2305388">0</span>&nbsp;<span class="op" id="2305390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2305396">s</span><span class="op" id="2305397">.</span><span class="ident" id="2305398">errorString</span><span class="op" id="2305409">(</span><span class="string" id="2305410">&#34;input&nbsp;does&nbsp;not&nbsp;match&nbsp;format&#34;</span><span class="op" id="2305439">)</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2305444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2305449">//&nbsp;Otherwise&nbsp;at&nbsp;EOF;&nbsp;&#34;too&nbsp;many&nbsp;operands&#34;&nbsp;error&nbsp;handled&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2305513">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2305521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2305525">i</span><span class="op" id="2305526">++</span>&nbsp;<span class="comment" id="2305529">//&nbsp;%&nbsp;is&nbsp;one&nbsp;byte</span><br>
<span class="lineno">1140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2305549">//&nbsp;do&nbsp;we&nbsp;have&nbsp;20&nbsp;(width)?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2305577">var</span>&nbsp;<span class="ident" id="2305581">widPresent</span>&nbsp;<span class="builtintype" id="2305592">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2305599">s</span><span class="op" id="2305600">.</span><span class="ident" id="2305601">maxWid</span><span class="op" id="2305607">,</span>&nbsp;<span class="ident" id="2305609">widPresent</span><span class="op" id="2305619">,</span>&nbsp;<span class="ident" id="2305621">i</span>&nbsp;<span class="op" id="2305623">=</span>&nbsp;<span class="ident" id="2305625">parsenum</span><span class="op" id="2305633">(</span><span class="ident" id="2305634">format</span><span class="op" id="2305640">,</span>&nbsp;<span class="ident" id="2305642">i</span><span class="op" id="2305643">,</span>&nbsp;<span class="ident" id="2305645">end</span><span class="op" id="2305648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2305652">if</span>&nbsp;<span class="op" id="2305655">!</span><span class="ident" id="2305656">widPresent</span>&nbsp;<span class="op" id="2305667">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2305672">s</span><span class="op" id="2305673">.</span><span class="ident" id="2305674">maxWid</span>&nbsp;<span class="op" id="2305681">=</span>&nbsp;<span class="ident" id="2305683">hugeWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2305693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2305697">s</span><span class="op" id="2305698">.</span><span class="ident" id="2305699">argLimit</span>&nbsp;<span class="op" id="2305708">=</span>&nbsp;<span class="ident" id="2305710">s</span><span class="op" id="2305711">.</span><span class="ident" id="2305712">limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2305720">if</span>&nbsp;<span class="ident" id="2305723">f</span>&nbsp;<span class="op" id="2305725">:=</span>&nbsp;<span class="ident" id="2305728">s</span><span class="op" id="2305729">.</span><span class="ident" id="2305730">count</span>&nbsp;<span class="op" id="2305736">+</span>&nbsp;<span class="ident" id="2305738">s</span><span class="op" id="2305739">.</span><span class="ident" id="2305740">maxWid</span><span class="op" id="2305746">;</span>&nbsp;<span class="ident" id="2305748">f</span>&nbsp;<span class="op" id="2305750">&lt;</span>&nbsp;<span class="ident" id="2305752">s</span><span class="op" id="2305753">.</span><span class="ident" id="2305754">argLimit</span>&nbsp;<span class="op" id="2305763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2305768">s</span><span class="op" id="2305769">.</span><span class="ident" id="2305770">argLimit</span>&nbsp;<span class="op" id="2305779">=</span>&nbsp;<span class="ident" id="2305781">f</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2305785">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2305790">c</span><span class="op" id="2305791">,</span>&nbsp;<span class="ident" id="2305793">w</span>&nbsp;<span class="op" id="2305795">:=</span>&nbsp;<span class="ident" id="2305798">utf8</span><span class="op" id="2305802">.</span><span class="ident" id="2305803">DecodeRuneInString</span><span class="op" id="2305821">(</span><span class="ident" id="2305822">format</span><span class="op" id="2305828">[</span><span class="ident" id="2305829">i</span><span class="op" id="2305830">:</span><span class="op" id="2305831">]</span><span class="op" id="2305832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2305836">i</span>&nbsp;<span class="op" id="2305838">+=</span>&nbsp;<span class="ident" id="2305841">w</span><br>
<span class="lineno"></span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2305846">if</span>&nbsp;<span class="ident" id="2305849">numProcessed</span>&nbsp;<span class="op" id="2305862">&gt;=</span>&nbsp;<span class="builtinfunc" id="2305865">len</span><span class="op" id="2305868">(</span><span class="ident" id="2305869">a</span><span class="op" id="2305870">)</span>&nbsp;<span class="op" id="2305872">{</span>&nbsp;<span class="comment" id="2305874">//&nbsp;out&nbsp;of&nbsp;operands</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2305896">s</span><span class="op" id="2305897">.</span><span class="ident" id="2305898">errorString</span><span class="op" id="2305909">(</span><span class="string" id="2305910">&#34;too&nbsp;few&nbsp;operands&nbsp;for&nbsp;format&nbsp;%&#34;</span>&nbsp;<span class="op" id="2305942">+</span>&nbsp;<span class="ident" id="2305944">format</span><span class="op" id="2305950">[</span><span class="ident" id="2305951">i</span><span class="op" id="2305952">-</span><span class="ident" id="2305953">w</span><span class="op" id="2305954">:</span><span class="op" id="2305955">]</span><span class="op" id="2305956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2305961">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2305969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2305973">arg</span>&nbsp;<span class="op" id="2305977">:=</span>&nbsp;<span class="ident" id="2305980">a</span><span class="op" id="2305981">[</span><span class="ident" id="2305982">numProcessed</span><span class="op" id="2305994">]</span><br>
<span class="lineno">1160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2305999">s</span><span class="op" id="2306000">.</span><span class="ident" id="2306001">scanOne</span><span class="op" id="2306008">(</span><span class="ident" id="2306009">c</span><span class="op" id="2306010">,</span>&nbsp;<span class="ident" id="2306012">arg</span><span class="op" id="2306015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306019">numProcessed</span><span class="op" id="2306031">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306036">s</span><span class="op" id="2306037">.</span><span class="ident" id="2306038">argLimit</span>&nbsp;<span class="op" id="2306047">=</span>&nbsp;<span class="ident" id="2306049">s</span><span class="op" id="2306050">.</span><span class="ident" id="2306051">limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2306058">}</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306061">if</span>&nbsp;<span class="ident" id="2306064">numProcessed</span>&nbsp;<span class="op" id="2306077">&lt;</span>&nbsp;<span class="builtinfunc" id="2306079">len</span><span class="op" id="2306082">(</span><span class="ident" id="2306083">a</span><span class="op" id="2306084">)</span>&nbsp;<span class="op" id="2306086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2306090">s</span><span class="op" id="2306091">.</span><span class="ident" id="2306092">errorString</span><span class="op" id="2306103">(</span><span class="string" id="2306104">&#34;too&nbsp;many&nbsp;operands&#34;</span><span class="op" id="2306123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2306126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2306129">return</span><br>
<span class="lineno"></span><span class="op" id="2306136">}</span>
</div>
</body>
</html>
