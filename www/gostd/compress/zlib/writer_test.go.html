<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>compress/zlib</h2>
<ul>
<li><a href="/gostd/compress/zlib/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/compress/zlib/reader.go.html">reader.go</a></li>
<li><a href="/gostd/compress/zlib/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/compress/zlib/writer.go.html">writer.go</a></li>
<li><a href="/gostd/compress/zlib/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7586914">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7586969">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7587023">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7587074">package</span>&nbsp;<span class="ident" id="7587082">zlib</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7587088">import</span>&nbsp;<span class="op" id="7587095">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7587098">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7587107">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7587114">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7587120">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7587133">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7587139">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7587149">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7587152">var</span>&nbsp;<span class="ident" id="7587156">filenames</span>&nbsp;<span class="op" id="7587166">=</span>&nbsp;<span class="op" id="7587168">[</span><span class="op" id="7587169">]</span><span class="builtintype" id="7587170">string</span><span class="op" id="7587176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7587179">&#34;../testdata/e.txt&#34;</span><span class="op" id="7587198">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7587201">&#34;../testdata/pi.txt&#34;</span><span class="op" id="7587221">,</span><br>
<span class="lineno"></span><span class="op" id="7587223">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="7587226">var</span>&nbsp;<span class="ident" id="7587230">data</span>&nbsp;<span class="op" id="7587235">=</span>&nbsp;<span class="op" id="7587237">[</span><span class="op" id="7587238">]</span><span class="builtintype" id="7587239">string</span><span class="op" id="7587245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7587248">&#34;test&nbsp;a&nbsp;reasonable&nbsp;sized&nbsp;string&nbsp;that&nbsp;can&nbsp;be&nbsp;compressed&#34;</span><span class="op" id="7587303">,</span><br>
<span class="lineno"></span><span class="op" id="7587305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="7587308">//&nbsp;Tests&nbsp;that&nbsp;compressing&nbsp;and&nbsp;then&nbsp;decompressing&nbsp;the&nbsp;given&nbsp;file&nbsp;at&nbsp;the&nbsp;given&nbsp;compression&nbsp;level&nbsp;and&nbsp;dictionary</span><br>
<span class="lineno"></span><span class="comment" id="7587418">//&nbsp;yields&nbsp;equivalent&nbsp;bytes&nbsp;to&nbsp;the&nbsp;original&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="7587467">func</span>&nbsp;<span class="ident" id="7587472">testFileLevelDict</span><span class="op" id="7587489">(</span><span class="ident" id="7587490">t</span>&nbsp;<span class="op" id="7587492">*</span><span class="ident" id="7587493">testing</span><span class="op" id="7587500">.</span><span class="ident" id="7587501">T</span><span class="op" id="7587502">,</span>&nbsp;<span class="ident" id="7587504">fn</span>&nbsp;<span class="builtintype" id="7587507">string</span><span class="op" id="7587513">,</span>&nbsp;<span class="ident" id="7587515">level</span>&nbsp;<span class="builtintype" id="7587521">int</span><span class="op" id="7587524">,</span>&nbsp;<span class="ident" id="7587526">d</span>&nbsp;<span class="builtintype" id="7587528">string</span><span class="op" id="7587534">)</span>&nbsp;<span class="op" id="7587536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7587539">//&nbsp;Read&nbsp;the&nbsp;file,&nbsp;as&nbsp;golden&nbsp;output.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587576">golden</span><span class="op" id="7587582">,</span>&nbsp;<span class="ident" id="7587584">err</span>&nbsp;<span class="op" id="7587588">:=</span>&nbsp;<span class="ident" id="7587591">os</span><span class="op" id="7587593">.</span><span class="ident" id="7587594">Open</span><span class="op" id="7587598">(</span><span class="ident" id="7587599">fn</span><span class="op" id="7587601">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587604">if</span>&nbsp;<span class="ident" id="7587607">err</span>&nbsp;<span class="op" id="7587611">!=</span>&nbsp;<span class="ident" id="7587614">nil</span>&nbsp;<span class="op" id="7587618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587622">t</span><span class="op" id="7587623">.</span><span class="ident" id="7587624">Errorf</span><span class="op" id="7587630">(</span><span class="string" id="7587631">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="7587659">,</span>&nbsp;<span class="ident" id="7587661">fn</span><span class="op" id="7587663">,</span>&nbsp;<span class="ident" id="7587665">level</span><span class="op" id="7587670">,</span>&nbsp;<span class="ident" id="7587672">d</span><span class="op" id="7587673">,</span>&nbsp;<span class="ident" id="7587675">err</span><span class="op" id="7587678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587682">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7587690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587693">defer</span>&nbsp;<span class="ident" id="7587699">golden</span><span class="op" id="7587705">.</span><span class="ident" id="7587706">Close</span><span class="op" id="7587711">(</span><span class="op" id="7587712">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587715">b0</span><span class="op" id="7587717">,</span>&nbsp;<span class="ident" id="7587719">err0</span>&nbsp;<span class="op" id="7587724">:=</span>&nbsp;<span class="ident" id="7587727">ioutil</span><span class="op" id="7587733">.</span><span class="ident" id="7587734">ReadAll</span><span class="op" id="7587741">(</span><span class="ident" id="7587742">golden</span><span class="op" id="7587748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587751">if</span>&nbsp;<span class="ident" id="7587754">err0</span>&nbsp;<span class="op" id="7587759">!=</span>&nbsp;<span class="ident" id="7587762">nil</span>&nbsp;<span class="op" id="7587766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587770">t</span><span class="op" id="7587771">.</span><span class="ident" id="7587772">Errorf</span><span class="op" id="7587778">(</span><span class="string" id="7587779">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="7587807">,</span>&nbsp;<span class="ident" id="7587809">fn</span><span class="op" id="7587811">,</span>&nbsp;<span class="ident" id="7587813">level</span><span class="op" id="7587818">,</span>&nbsp;<span class="ident" id="7587820">d</span><span class="op" id="7587821">,</span>&nbsp;<span class="ident" id="7587823">err0</span><span class="op" id="7587827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587831">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7587839">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587842">testLevelDict</span><span class="op" id="7587855">(</span><span class="ident" id="7587856">t</span><span class="op" id="7587857">,</span>&nbsp;<span class="ident" id="7587859">fn</span><span class="op" id="7587861">,</span>&nbsp;<span class="ident" id="7587863">b0</span><span class="op" id="7587865">,</span>&nbsp;<span class="ident" id="7587867">level</span><span class="op" id="7587872">,</span>&nbsp;<span class="ident" id="7587874">d</span><span class="op" id="7587875">)</span><br>
<span class="lineno"></span><span class="op" id="7587877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7587880">func</span>&nbsp;<span class="ident" id="7587885">testLevelDict</span><span class="op" id="7587898">(</span><span class="ident" id="7587899">t</span>&nbsp;<span class="op" id="7587901">*</span><span class="ident" id="7587902">testing</span><span class="op" id="7587909">.</span><span class="ident" id="7587910">T</span><span class="op" id="7587911">,</span>&nbsp;<span class="ident" id="7587913">fn</span>&nbsp;<span class="builtintype" id="7587916">string</span><span class="op" id="7587922">,</span>&nbsp;<span class="ident" id="7587924">b0</span>&nbsp;<span class="op" id="7587927">[</span><span class="op" id="7587928">]</span><span class="builtintype" id="7587929">byte</span><span class="op" id="7587933">,</span>&nbsp;<span class="ident" id="7587935">level</span>&nbsp;<span class="builtintype" id="7587941">int</span><span class="op" id="7587944">,</span>&nbsp;<span class="ident" id="7587946">d</span>&nbsp;<span class="builtintype" id="7587948">string</span><span class="op" id="7587954">)</span>&nbsp;<span class="op" id="7587956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7587959">//&nbsp;Make&nbsp;dictionary,&nbsp;if&nbsp;given.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587990">var</span>&nbsp;<span class="ident" id="7587994">dict</span>&nbsp;<span class="op" id="7587999">[</span><span class="op" id="7588000">]</span><span class="builtintype" id="7588001">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588007">if</span>&nbsp;<span class="ident" id="7588010">d</span>&nbsp;<span class="op" id="7588012">!=</span>&nbsp;<span class="string" id="7588015">&#34;&#34;</span>&nbsp;<span class="op" id="7588018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588022">dict</span>&nbsp;<span class="op" id="7588027">=</span>&nbsp;<span class="op" id="7588029">[</span><span class="op" id="7588030">]</span><span class="builtintype" id="7588031">byte</span><span class="op" id="7588035">(</span><span class="ident" id="7588036">d</span><span class="op" id="7588037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7588040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7588044">//&nbsp;Push&nbsp;data&nbsp;through&nbsp;a&nbsp;pipe&nbsp;that&nbsp;compresses&nbsp;at&nbsp;the&nbsp;write&nbsp;end,&nbsp;and&nbsp;decompresses&nbsp;at&nbsp;the&nbsp;read&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588141">piper</span><span class="op" id="7588146">,</span>&nbsp;<span class="ident" id="7588148">pipew</span>&nbsp;<span class="op" id="7588154">:=</span>&nbsp;<span class="ident" id="7588157">io</span><span class="op" id="7588159">.</span><span class="ident" id="7588160">Pipe</span><span class="op" id="7588164">(</span><span class="op" id="7588165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588168">defer</span>&nbsp;<span class="ident" id="7588174">piper</span><span class="op" id="7588179">.</span><span class="ident" id="7588180">Close</span><span class="op" id="7588185">(</span><span class="op" id="7588186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588189">go</span>&nbsp;<span class="keyword" id="7588192">func</span><span class="op" id="7588196">(</span><span class="op" id="7588197">)</span>&nbsp;<span class="op" id="7588199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588203">defer</span>&nbsp;<span class="ident" id="7588209">pipew</span><span class="op" id="7588214">.</span><span class="ident" id="7588215">Close</span><span class="op" id="7588220">(</span><span class="op" id="7588221">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588225">zlibw</span><span class="op" id="7588230">,</span>&nbsp;<span class="ident" id="7588232">err</span>&nbsp;<span class="op" id="7588236">:=</span>&nbsp;<span class="ident" id="7588239">NewWriterLevelDict</span><span class="op" id="7588257">(</span><span class="ident" id="7588258">pipew</span><span class="op" id="7588263">,</span>&nbsp;<span class="ident" id="7588265">level</span><span class="op" id="7588270">,</span>&nbsp;<span class="ident" id="7588272">dict</span><span class="op" id="7588276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588280">if</span>&nbsp;<span class="ident" id="7588283">err</span>&nbsp;<span class="op" id="7588287">!=</span>&nbsp;<span class="ident" id="7588290">nil</span>&nbsp;<span class="op" id="7588294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588299">t</span><span class="op" id="7588300">.</span><span class="ident" id="7588301">Errorf</span><span class="op" id="7588307">(</span><span class="string" id="7588308">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="7588336">,</span>&nbsp;<span class="ident" id="7588338">fn</span><span class="op" id="7588340">,</span>&nbsp;<span class="ident" id="7588342">level</span><span class="op" id="7588347">,</span>&nbsp;<span class="ident" id="7588349">d</span><span class="op" id="7588350">,</span>&nbsp;<span class="ident" id="7588352">err</span><span class="op" id="7588355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588360">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7588369">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588373">defer</span>&nbsp;<span class="ident" id="7588379">zlibw</span><span class="op" id="7588384">.</span><span class="ident" id="7588385">Close</span><span class="op" id="7588390">(</span><span class="op" id="7588391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588395">_</span><span class="op" id="7588396">,</span>&nbsp;<span class="ident" id="7588398">err</span>&nbsp;<span class="op" id="7588402">=</span>&nbsp;<span class="ident" id="7588404">zlibw</span><span class="op" id="7588409">.</span><span class="ident" id="7588410">Write</span><span class="op" id="7588415">(</span><span class="ident" id="7588416">b0</span><span class="op" id="7588418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588422">if</span>&nbsp;<span class="ident" id="7588425">err</span>&nbsp;<span class="op" id="7588429">!=</span>&nbsp;<span class="ident" id="7588432">nil</span>&nbsp;<span class="op" id="7588436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588441">t</span><span class="op" id="7588442">.</span><span class="ident" id="7588443">Errorf</span><span class="op" id="7588449">(</span><span class="string" id="7588450">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="7588478">,</span>&nbsp;<span class="ident" id="7588480">fn</span><span class="op" id="7588482">,</span>&nbsp;<span class="ident" id="7588484">level</span><span class="op" id="7588489">,</span>&nbsp;<span class="ident" id="7588491">d</span><span class="op" id="7588492">,</span>&nbsp;<span class="ident" id="7588494">err</span><span class="op" id="7588497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588502">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7588511">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7588514">}</span><span class="op" id="7588515">(</span><span class="op" id="7588516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588519">zlibr</span><span class="op" id="7588524">,</span>&nbsp;<span class="ident" id="7588526">err</span>&nbsp;<span class="op" id="7588530">:=</span>&nbsp;<span class="ident" id="7588533">NewReaderDict</span><span class="op" id="7588546">(</span><span class="ident" id="7588547">piper</span><span class="op" id="7588552">,</span>&nbsp;<span class="ident" id="7588554">dict</span><span class="op" id="7588558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588561">if</span>&nbsp;<span class="ident" id="7588564">err</span>&nbsp;<span class="op" id="7588568">!=</span>&nbsp;<span class="ident" id="7588571">nil</span>&nbsp;<span class="op" id="7588575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588579">t</span><span class="op" id="7588580">.</span><span class="ident" id="7588581">Errorf</span><span class="op" id="7588587">(</span><span class="string" id="7588588">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="7588616">,</span>&nbsp;<span class="ident" id="7588618">fn</span><span class="op" id="7588620">,</span>&nbsp;<span class="ident" id="7588622">level</span><span class="op" id="7588627">,</span>&nbsp;<span class="ident" id="7588629">d</span><span class="op" id="7588630">,</span>&nbsp;<span class="ident" id="7588632">err</span><span class="op" id="7588635">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588639">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7588647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588650">defer</span>&nbsp;<span class="ident" id="7588656">zlibr</span><span class="op" id="7588661">.</span><span class="ident" id="7588662">Close</span><span class="op" id="7588667">(</span><span class="op" id="7588668">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7588672">//&nbsp;Compare&nbsp;the&nbsp;decompressed&nbsp;data.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588707">b1</span><span class="op" id="7588709">,</span>&nbsp;<span class="ident" id="7588711">err1</span>&nbsp;<span class="op" id="7588716">:=</span>&nbsp;<span class="ident" id="7588719">ioutil</span><span class="op" id="7588725">.</span><span class="ident" id="7588726">ReadAll</span><span class="op" id="7588733">(</span><span class="ident" id="7588734">zlibr</span><span class="op" id="7588739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588742">if</span>&nbsp;<span class="ident" id="7588745">err1</span>&nbsp;<span class="op" id="7588750">!=</span>&nbsp;<span class="ident" id="7588753">nil</span>&nbsp;<span class="op" id="7588757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588761">t</span><span class="op" id="7588762">.</span><span class="ident" id="7588763">Errorf</span><span class="op" id="7588769">(</span><span class="string" id="7588770">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="7588798">,</span>&nbsp;<span class="ident" id="7588800">fn</span><span class="op" id="7588802">,</span>&nbsp;<span class="ident" id="7588804">level</span><span class="op" id="7588809">,</span>&nbsp;<span class="ident" id="7588811">d</span><span class="op" id="7588812">,</span>&nbsp;<span class="ident" id="7588814">err1</span><span class="op" id="7588818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588822">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7588830">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588833">if</span>&nbsp;<span class="builtinfunc" id="7588836">len</span><span class="op" id="7588839">(</span><span class="ident" id="7588840">b0</span><span class="op" id="7588842">)</span>&nbsp;<span class="op" id="7588844">!=</span>&nbsp;<span class="builtinfunc" id="7588847">len</span><span class="op" id="7588850">(</span><span class="ident" id="7588851">b1</span><span class="op" id="7588853">)</span>&nbsp;<span class="op" id="7588855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588859">t</span><span class="op" id="7588860">.</span><span class="ident" id="7588861">Errorf</span><span class="op" id="7588867">(</span><span class="string" id="7588868">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;length&nbsp;mismatch&nbsp;%d&nbsp;versus&nbsp;%d&#34;</span><span class="op" id="7588922">,</span>&nbsp;<span class="ident" id="7588924">fn</span><span class="op" id="7588926">,</span>&nbsp;<span class="ident" id="7588928">level</span><span class="op" id="7588933">,</span>&nbsp;<span class="ident" id="7588935">d</span><span class="op" id="7588936">,</span>&nbsp;<span class="builtinfunc" id="7588938">len</span><span class="op" id="7588941">(</span><span class="ident" id="7588942">b0</span><span class="op" id="7588944">)</span><span class="op" id="7588945">,</span>&nbsp;<span class="builtinfunc" id="7588947">len</span><span class="op" id="7588950">(</span><span class="ident" id="7588951">b1</span><span class="op" id="7588953">)</span><span class="op" id="7588954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588958">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7588966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588969">for</span>&nbsp;<span class="ident" id="7588973">i</span>&nbsp;<span class="op" id="7588975">:=</span>&nbsp;<span class="num" id="7588978">0</span><span class="op" id="7588979">;</span>&nbsp;<span class="ident" id="7588981">i</span>&nbsp;<span class="op" id="7588983">&lt;</span>&nbsp;<span class="builtinfunc" id="7588985">len</span><span class="op" id="7588988">(</span><span class="ident" id="7588989">b0</span><span class="op" id="7588991">)</span><span class="op" id="7588992">;</span>&nbsp;<span class="ident" id="7588994">i</span><span class="op" id="7588995">++</span>&nbsp;<span class="op" id="7588998">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589002">if</span>&nbsp;<span class="ident" id="7589005">b0</span><span class="op" id="7589007">[</span><span class="ident" id="7589008">i</span><span class="op" id="7589009">]</span>&nbsp;<span class="op" id="7589011">!=</span>&nbsp;<span class="ident" id="7589014">b1</span><span class="op" id="7589016">[</span><span class="ident" id="7589017">i</span><span class="op" id="7589018">]</span>&nbsp;<span class="op" id="7589020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589025">t</span><span class="op" id="7589026">.</span><span class="ident" id="7589027">Errorf</span><span class="op" id="7589033">(</span><span class="string" id="7589034">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;mismatch&nbsp;at&nbsp;%d,&nbsp;0x%02x&nbsp;versus&nbsp;0x%02x\n&#34;</span><span class="op" id="7589098">,</span>&nbsp;<span class="ident" id="7589100">fn</span><span class="op" id="7589102">,</span>&nbsp;<span class="ident" id="7589104">level</span><span class="op" id="7589109">,</span>&nbsp;<span class="ident" id="7589111">d</span><span class="op" id="7589112">,</span>&nbsp;<span class="ident" id="7589114">i</span><span class="op" id="7589115">,</span>&nbsp;<span class="ident" id="7589117">b0</span><span class="op" id="7589119">[</span><span class="ident" id="7589120">i</span><span class="op" id="7589121">]</span><span class="op" id="7589122">,</span>&nbsp;<span class="ident" id="7589124">b1</span><span class="op" id="7589126">[</span><span class="ident" id="7589127">i</span><span class="op" id="7589128">]</span><span class="op" id="7589129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589134">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7589143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7589146">}</span><br>
<span class="lineno">90</span><span class="op" id="7589148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7589151">func</span>&nbsp;<span class="ident" id="7589156">testFileLevelDictReset</span><span class="op" id="7589178">(</span><span class="ident" id="7589179">t</span>&nbsp;<span class="op" id="7589181">*</span><span class="ident" id="7589182">testing</span><span class="op" id="7589189">.</span><span class="ident" id="7589190">T</span><span class="op" id="7589191">,</span>&nbsp;<span class="ident" id="7589193">fn</span>&nbsp;<span class="builtintype" id="7589196">string</span><span class="op" id="7589202">,</span>&nbsp;<span class="ident" id="7589204">level</span>&nbsp;<span class="builtintype" id="7589210">int</span><span class="op" id="7589213">,</span>&nbsp;<span class="ident" id="7589215">dict</span>&nbsp;<span class="op" id="7589220">[</span><span class="op" id="7589221">]</span><span class="builtintype" id="7589222">byte</span><span class="op" id="7589226">)</span>&nbsp;<span class="op" id="7589228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589231">var</span>&nbsp;<span class="ident" id="7589235">b0</span>&nbsp;<span class="op" id="7589238">[</span><span class="op" id="7589239">]</span><span class="builtintype" id="7589240">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589246">var</span>&nbsp;<span class="ident" id="7589250">err</span>&nbsp;<span class="builtintype" id="7589254">error</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589261">if</span>&nbsp;<span class="ident" id="7589264">fn</span>&nbsp;<span class="op" id="7589267">!=</span>&nbsp;<span class="string" id="7589270">&#34;&#34;</span>&nbsp;<span class="op" id="7589273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589277">b0</span><span class="op" id="7589279">,</span>&nbsp;<span class="ident" id="7589281">err</span>&nbsp;<span class="op" id="7589285">=</span>&nbsp;<span class="ident" id="7589287">ioutil</span><span class="op" id="7589293">.</span><span class="ident" id="7589294">ReadFile</span><span class="op" id="7589302">(</span><span class="ident" id="7589303">fn</span><span class="op" id="7589305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589309">if</span>&nbsp;<span class="ident" id="7589312">err</span>&nbsp;<span class="op" id="7589316">!=</span>&nbsp;<span class="ident" id="7589319">nil</span>&nbsp;<span class="op" id="7589323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589328">t</span><span class="op" id="7589329">.</span><span class="ident" id="7589330">Errorf</span><span class="op" id="7589336">(</span><span class="string" id="7589337">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="7589356">,</span>&nbsp;<span class="ident" id="7589358">fn</span><span class="op" id="7589360">,</span>&nbsp;<span class="ident" id="7589362">level</span><span class="op" id="7589367">,</span>&nbsp;<span class="ident" id="7589369">err</span><span class="op" id="7589372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589377">return</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7589386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7589389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7589393">//&nbsp;Compress&nbsp;once.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589412">buf</span>&nbsp;<span class="op" id="7589416">:=</span>&nbsp;<span class="builtinfunc" id="7589419">new</span><span class="op" id="7589422">(</span><span class="ident" id="7589423">bytes</span><span class="op" id="7589428">.</span><span class="ident" id="7589429">Buffer</span><span class="op" id="7589435">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589438">var</span>&nbsp;<span class="ident" id="7589442">zlibw</span>&nbsp;<span class="op" id="7589448">*</span><span class="ident" id="7589449">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589457">if</span>&nbsp;<span class="ident" id="7589460">dict</span>&nbsp;<span class="op" id="7589465">==</span>&nbsp;<span class="ident" id="7589468">nil</span>&nbsp;<span class="op" id="7589472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589476">zlibw</span><span class="op" id="7589481">,</span>&nbsp;<span class="ident" id="7589483">err</span>&nbsp;<span class="op" id="7589487">=</span>&nbsp;<span class="ident" id="7589489">NewWriterLevel</span><span class="op" id="7589503">(</span><span class="ident" id="7589504">buf</span><span class="op" id="7589507">,</span>&nbsp;<span class="ident" id="7589509">level</span><span class="op" id="7589514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7589517">}</span>&nbsp;<span class="keyword" id="7589519">else</span>&nbsp;<span class="op" id="7589524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589528">zlibw</span><span class="op" id="7589533">,</span>&nbsp;<span class="ident" id="7589535">err</span>&nbsp;<span class="op" id="7589539">=</span>&nbsp;<span class="ident" id="7589541">NewWriterLevelDict</span><span class="op" id="7589559">(</span><span class="ident" id="7589560">buf</span><span class="op" id="7589563">,</span>&nbsp;<span class="ident" id="7589565">level</span><span class="op" id="7589570">,</span>&nbsp;<span class="ident" id="7589572">dict</span><span class="op" id="7589576">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7589579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589582">if</span>&nbsp;<span class="ident" id="7589585">err</span>&nbsp;<span class="op" id="7589589">==</span>&nbsp;<span class="ident" id="7589592">nil</span>&nbsp;<span class="op" id="7589596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589600">_</span><span class="op" id="7589601">,</span>&nbsp;<span class="ident" id="7589603">err</span>&nbsp;<span class="op" id="7589607">=</span>&nbsp;<span class="ident" id="7589609">zlibw</span><span class="op" id="7589614">.</span><span class="ident" id="7589615">Write</span><span class="op" id="7589620">(</span><span class="ident" id="7589621">b0</span><span class="op" id="7589623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7589626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589629">if</span>&nbsp;<span class="ident" id="7589632">err</span>&nbsp;<span class="op" id="7589636">==</span>&nbsp;<span class="ident" id="7589639">nil</span>&nbsp;<span class="op" id="7589643">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589647">err</span>&nbsp;<span class="op" id="7589651">=</span>&nbsp;<span class="ident" id="7589653">zlibw</span><span class="op" id="7589658">.</span><span class="ident" id="7589659">Close</span><span class="op" id="7589664">(</span><span class="op" id="7589665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7589668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589671">if</span>&nbsp;<span class="ident" id="7589674">err</span>&nbsp;<span class="op" id="7589678">!=</span>&nbsp;<span class="ident" id="7589681">nil</span>&nbsp;<span class="op" id="7589685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589689">t</span><span class="op" id="7589690">.</span><span class="ident" id="7589691">Errorf</span><span class="op" id="7589697">(</span><span class="string" id="7589698">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="7589717">,</span>&nbsp;<span class="ident" id="7589719">fn</span><span class="op" id="7589721">,</span>&nbsp;<span class="ident" id="7589723">level</span><span class="op" id="7589728">,</span>&nbsp;<span class="ident" id="7589730">err</span><span class="op" id="7589733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589737">return</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7589745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589748">out</span>&nbsp;<span class="op" id="7589752">:=</span>&nbsp;<span class="ident" id="7589755">buf</span><span class="op" id="7589758">.</span><span class="ident" id="7589759">String</span><span class="op" id="7589765">(</span><span class="op" id="7589766">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7589770">//&nbsp;Reset&nbsp;and&nbsp;compress&nbsp;again.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589800">buf2</span>&nbsp;<span class="op" id="7589805">:=</span>&nbsp;<span class="builtinfunc" id="7589808">new</span><span class="op" id="7589811">(</span><span class="ident" id="7589812">bytes</span><span class="op" id="7589817">.</span><span class="ident" id="7589818">Buffer</span><span class="op" id="7589824">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589827">zlibw</span><span class="op" id="7589832">.</span><span class="ident" id="7589833">Reset</span><span class="op" id="7589838">(</span><span class="ident" id="7589839">buf2</span><span class="op" id="7589843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589846">_</span><span class="op" id="7589847">,</span>&nbsp;<span class="ident" id="7589849">err</span>&nbsp;<span class="op" id="7589853">=</span>&nbsp;<span class="ident" id="7589855">zlibw</span><span class="op" id="7589860">.</span><span class="ident" id="7589861">Write</span><span class="op" id="7589866">(</span><span class="ident" id="7589867">b0</span><span class="op" id="7589869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589872">if</span>&nbsp;<span class="ident" id="7589875">err</span>&nbsp;<span class="op" id="7589879">==</span>&nbsp;<span class="ident" id="7589882">nil</span>&nbsp;<span class="op" id="7589886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589890">err</span>&nbsp;<span class="op" id="7589894">=</span>&nbsp;<span class="ident" id="7589896">zlibw</span><span class="op" id="7589901">.</span><span class="ident" id="7589902">Close</span><span class="op" id="7589907">(</span><span class="op" id="7589908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7589911">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589914">if</span>&nbsp;<span class="ident" id="7589917">err</span>&nbsp;<span class="op" id="7589921">!=</span>&nbsp;<span class="ident" id="7589924">nil</span>&nbsp;<span class="op" id="7589928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589932">t</span><span class="op" id="7589933">.</span><span class="ident" id="7589934">Errorf</span><span class="op" id="7589940">(</span><span class="string" id="7589941">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="7589960">,</span>&nbsp;<span class="ident" id="7589962">fn</span><span class="op" id="7589964">,</span>&nbsp;<span class="ident" id="7589966">level</span><span class="op" id="7589971">,</span>&nbsp;<span class="ident" id="7589973">err</span><span class="op" id="7589976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589980">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7589988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589991">out2</span>&nbsp;<span class="op" id="7589996">:=</span>&nbsp;<span class="ident" id="7589999">buf2</span><span class="op" id="7590003">.</span><span class="ident" id="7590004">String</span><span class="op" id="7590010">(</span><span class="op" id="7590011">)</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7590015">if</span>&nbsp;<span class="ident" id="7590018">out2</span>&nbsp;<span class="op" id="7590023">!=</span>&nbsp;<span class="ident" id="7590026">out</span>&nbsp;<span class="op" id="7590030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7590034">t</span><span class="op" id="7590035">.</span><span class="ident" id="7590036">Errorf</span><span class="op" id="7590042">(</span><span class="string" id="7590043">&#34;%s&nbsp;(level=%d):&nbsp;different&nbsp;output&nbsp;after&nbsp;reset&nbsp;(got&nbsp;%d&nbsp;bytes,&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="7590115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7590120">fn</span><span class="op" id="7590122">,</span>&nbsp;<span class="ident" id="7590124">level</span><span class="op" id="7590129">,</span>&nbsp;<span class="builtinfunc" id="7590131">len</span><span class="op" id="7590134">(</span><span class="ident" id="7590135">out2</span><span class="op" id="7590139">)</span><span class="op" id="7590140">,</span>&nbsp;<span class="builtinfunc" id="7590142">len</span><span class="op" id="7590145">(</span><span class="ident" id="7590146">out</span><span class="op" id="7590149">)</span><span class="op" id="7590150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7590153">}</span><br>
<span class="lineno">140</span><span class="op" id="7590155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7590158">func</span>&nbsp;<span class="ident" id="7590163">TestWriter</span><span class="op" id="7590173">(</span><span class="ident" id="7590174">t</span>&nbsp;<span class="op" id="7590176">*</span><span class="ident" id="7590177">testing</span><span class="op" id="7590184">.</span><span class="ident" id="7590185">T</span><span class="op" id="7590186">)</span>&nbsp;<span class="op" id="7590188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7590191">for</span>&nbsp;<span class="ident" id="7590195">i</span><span class="op" id="7590196">,</span>&nbsp;<span class="ident" id="7590198">s</span>&nbsp;<span class="op" id="7590200">:=</span>&nbsp;<span class="keyword" id="7590203">range</span>&nbsp;<span class="ident" id="7590209">data</span>&nbsp;<span class="op" id="7590214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7590218">b</span>&nbsp;<span class="op" id="7590220">:=</span>&nbsp;<span class="op" id="7590223">[</span><span class="op" id="7590224">]</span><span class="builtintype" id="7590225">byte</span><span class="op" id="7590229">(</span><span class="ident" id="7590230">s</span><span class="op" id="7590231">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7590235">tag</span>&nbsp;<span class="op" id="7590239">:=</span>&nbsp;<span class="ident" id="7590242">fmt</span><span class="op" id="7590245">.</span><span class="ident" id="7590246">Sprintf</span><span class="op" id="7590253">(</span><span class="string" id="7590254">&#34;#%d&#34;</span><span class="op" id="7590259">,</span>&nbsp;<span class="ident" id="7590261">i</span><span class="op" id="7590262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7590266">testLevelDict</span><span class="op" id="7590279">(</span><span class="ident" id="7590280">t</span><span class="op" id="7590281">,</span>&nbsp;<span class="ident" id="7590283">tag</span><span class="op" id="7590286">,</span>&nbsp;<span class="ident" id="7590288">b</span><span class="op" id="7590289">,</span>&nbsp;<span class="ident" id="7590291">DefaultCompression</span><span class="op" id="7590309">,</span>&nbsp;<span class="string" id="7590311">&#34;&#34;</span><span class="op" id="7590313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7590317">testLevelDict</span><span class="op" id="7590330">(</span><span class="ident" id="7590331">t</span><span class="op" id="7590332">,</span>&nbsp;<span class="ident" id="7590334">tag</span><span class="op" id="7590337">,</span>&nbsp;<span class="ident" id="7590339">b</span><span class="op" id="7590340">,</span>&nbsp;<span class="ident" id="7590342">NoCompression</span><span class="op" id="7590355">,</span>&nbsp;<span class="string" id="7590357">&#34;&#34;</span><span class="op" id="7590359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7590363">for</span>&nbsp;<span class="ident" id="7590367">level</span>&nbsp;<span class="op" id="7590373">:=</span>&nbsp;<span class="ident" id="7590376">BestSpeed</span><span class="op" id="7590385">;</span>&nbsp;<span class="ident" id="7590387">level</span>&nbsp;<span class="op" id="7590393">&lt;=</span>&nbsp;<span class="ident" id="7590396">BestCompression</span><span class="op" id="7590411">;</span>&nbsp;<span class="ident" id="7590413">level</span><span class="op" id="7590418">++</span>&nbsp;<span class="op" id="7590421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7590426">testLevelDict</span><span class="op" id="7590439">(</span><span class="ident" id="7590440">t</span><span class="op" id="7590441">,</span>&nbsp;<span class="ident" id="7590443">tag</span><span class="op" id="7590446">,</span>&nbsp;<span class="ident" id="7590448">b</span><span class="op" id="7590449">,</span>&nbsp;<span class="ident" id="7590451">level</span><span class="op" id="7590456">,</span>&nbsp;<span class="string" id="7590458">&#34;&#34;</span><span class="op" id="7590460">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7590464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7590467">}</span><br>
<span class="lineno"></span><span class="op" id="7590469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7590472">func</span>&nbsp;<span class="ident" id="7590477">TestWriterBig</span><span class="op" id="7590490">(</span><span class="ident" id="7590491">t</span>&nbsp;<span class="op" id="7590493">*</span><span class="ident" id="7590494">testing</span><span class="op" id="7590501">.</span><span class="ident" id="7590502">T</span><span class="op" id="7590503">)</span>&nbsp;<span class="op" id="7590505">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7590508">for</span>&nbsp;<span class="ident" id="7590512">_</span><span class="op" id="7590513">,</span>&nbsp;<span class="ident" id="7590515">fn</span>&nbsp;<span class="op" id="7590518">:=</span>&nbsp;<span class="keyword" id="7590521">range</span>&nbsp;<span class="ident" id="7590527">filenames</span>&nbsp;<span class="op" id="7590537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7590541">testFileLevelDict</span><span class="op" id="7590558">(</span><span class="ident" id="7590559">t</span><span class="op" id="7590560">,</span>&nbsp;<span class="ident" id="7590562">fn</span><span class="op" id="7590564">,</span>&nbsp;<span class="ident" id="7590566">DefaultCompression</span><span class="op" id="7590584">,</span>&nbsp;<span class="string" id="7590586">&#34;&#34;</span><span class="op" id="7590588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7590592">testFileLevelDict</span><span class="op" id="7590609">(</span><span class="ident" id="7590610">t</span><span class="op" id="7590611">,</span>&nbsp;<span class="ident" id="7590613">fn</span><span class="op" id="7590615">,</span>&nbsp;<span class="ident" id="7590617">NoCompression</span><span class="op" id="7590630">,</span>&nbsp;<span class="string" id="7590632">&#34;&#34;</span><span class="op" id="7590634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7590638">for</span>&nbsp;<span class="ident" id="7590642">level</span>&nbsp;<span class="op" id="7590648">:=</span>&nbsp;<span class="ident" id="7590651">BestSpeed</span><span class="op" id="7590660">;</span>&nbsp;<span class="ident" id="7590662">level</span>&nbsp;<span class="op" id="7590668">&lt;=</span>&nbsp;<span class="ident" id="7590671">BestCompression</span><span class="op" id="7590686">;</span>&nbsp;<span class="ident" id="7590688">level</span><span class="op" id="7590693">++</span>&nbsp;<span class="op" id="7590696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7590701">testFileLevelDict</span><span class="op" id="7590718">(</span><span class="ident" id="7590719">t</span><span class="op" id="7590720">,</span>&nbsp;<span class="ident" id="7590722">fn</span><span class="op" id="7590724">,</span>&nbsp;<span class="ident" id="7590726">level</span><span class="op" id="7590731">,</span>&nbsp;<span class="string" id="7590733">&#34;&#34;</span><span class="op" id="7590735">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7590739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7590742">}</span><br>
<span class="lineno"></span><span class="op" id="7590744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7590747">func</span>&nbsp;<span class="ident" id="7590752">TestWriterDict</span><span class="op" id="7590766">(</span><span class="ident" id="7590767">t</span>&nbsp;<span class="op" id="7590769">*</span><span class="ident" id="7590770">testing</span><span class="op" id="7590777">.</span><span class="ident" id="7590778">T</span><span class="op" id="7590779">)</span>&nbsp;<span class="op" id="7590781">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7590784">const</span>&nbsp;<span class="ident" id="7590790">dictionary</span>&nbsp;<span class="op" id="7590801">=</span>&nbsp;<span class="string" id="7590803">&#34;0123456789.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7590818">for</span>&nbsp;<span class="ident" id="7590822">_</span><span class="op" id="7590823">,</span>&nbsp;<span class="ident" id="7590825">fn</span>&nbsp;<span class="op" id="7590828">:=</span>&nbsp;<span class="keyword" id="7590831">range</span>&nbsp;<span class="ident" id="7590837">filenames</span>&nbsp;<span class="op" id="7590847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7590851">testFileLevelDict</span><span class="op" id="7590868">(</span><span class="ident" id="7590869">t</span><span class="op" id="7590870">,</span>&nbsp;<span class="ident" id="7590872">fn</span><span class="op" id="7590874">,</span>&nbsp;<span class="ident" id="7590876">DefaultCompression</span><span class="op" id="7590894">,</span>&nbsp;<span class="ident" id="7590896">dictionary</span><span class="op" id="7590906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7590910">testFileLevelDict</span><span class="op" id="7590927">(</span><span class="ident" id="7590928">t</span><span class="op" id="7590929">,</span>&nbsp;<span class="ident" id="7590931">fn</span><span class="op" id="7590933">,</span>&nbsp;<span class="ident" id="7590935">NoCompression</span><span class="op" id="7590948">,</span>&nbsp;<span class="ident" id="7590950">dictionary</span><span class="op" id="7590960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7590964">for</span>&nbsp;<span class="ident" id="7590968">level</span>&nbsp;<span class="op" id="7590974">:=</span>&nbsp;<span class="ident" id="7590977">BestSpeed</span><span class="op" id="7590986">;</span>&nbsp;<span class="ident" id="7590988">level</span>&nbsp;<span class="op" id="7590994">&lt;=</span>&nbsp;<span class="ident" id="7590997">BestCompression</span><span class="op" id="7591012">;</span>&nbsp;<span class="ident" id="7591014">level</span><span class="op" id="7591019">++</span>&nbsp;<span class="op" id="7591022">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7591027">testFileLevelDict</span><span class="op" id="7591044">(</span><span class="ident" id="7591045">t</span><span class="op" id="7591046">,</span>&nbsp;<span class="ident" id="7591048">fn</span><span class="op" id="7591050">,</span>&nbsp;<span class="ident" id="7591052">level</span><span class="op" id="7591057">,</span>&nbsp;<span class="ident" id="7591059">dictionary</span><span class="op" id="7591069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7591073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7591076">}</span><br>
<span class="lineno"></span><span class="op" id="7591078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="7591081">func</span>&nbsp;<span class="ident" id="7591086">TestWriterReset</span><span class="op" id="7591101">(</span><span class="ident" id="7591102">t</span>&nbsp;<span class="op" id="7591104">*</span><span class="ident" id="7591105">testing</span><span class="op" id="7591112">.</span><span class="ident" id="7591113">T</span><span class="op" id="7591114">)</span>&nbsp;<span class="op" id="7591116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7591119">const</span>&nbsp;<span class="ident" id="7591125">dictionary</span>&nbsp;<span class="op" id="7591136">=</span>&nbsp;<span class="string" id="7591138">&#34;0123456789.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7591153">for</span>&nbsp;<span class="ident" id="7591157">_</span><span class="op" id="7591158">,</span>&nbsp;<span class="ident" id="7591160">fn</span>&nbsp;<span class="op" id="7591163">:=</span>&nbsp;<span class="keyword" id="7591166">range</span>&nbsp;<span class="ident" id="7591172">filenames</span>&nbsp;<span class="op" id="7591182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7591186">testFileLevelDictReset</span><span class="op" id="7591208">(</span><span class="ident" id="7591209">t</span><span class="op" id="7591210">,</span>&nbsp;<span class="ident" id="7591212">fn</span><span class="op" id="7591214">,</span>&nbsp;<span class="ident" id="7591216">NoCompression</span><span class="op" id="7591229">,</span>&nbsp;<span class="ident" id="7591231">nil</span><span class="op" id="7591234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7591238">testFileLevelDictReset</span><span class="op" id="7591260">(</span><span class="ident" id="7591261">t</span><span class="op" id="7591262">,</span>&nbsp;<span class="ident" id="7591264">fn</span><span class="op" id="7591266">,</span>&nbsp;<span class="ident" id="7591268">DefaultCompression</span><span class="op" id="7591286">,</span>&nbsp;<span class="ident" id="7591288">nil</span><span class="op" id="7591291">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7591295">testFileLevelDictReset</span><span class="op" id="7591317">(</span><span class="ident" id="7591318">t</span><span class="op" id="7591319">,</span>&nbsp;<span class="ident" id="7591321">fn</span><span class="op" id="7591323">,</span>&nbsp;<span class="ident" id="7591325">NoCompression</span><span class="op" id="7591338">,</span>&nbsp;<span class="op" id="7591340">[</span><span class="op" id="7591341">]</span><span class="builtintype" id="7591342">byte</span><span class="op" id="7591346">(</span><span class="ident" id="7591347">dictionary</span><span class="op" id="7591357">)</span><span class="op" id="7591358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7591362">testFileLevelDictReset</span><span class="op" id="7591384">(</span><span class="ident" id="7591385">t</span><span class="op" id="7591386">,</span>&nbsp;<span class="ident" id="7591388">fn</span><span class="op" id="7591390">,</span>&nbsp;<span class="ident" id="7591392">DefaultCompression</span><span class="op" id="7591410">,</span>&nbsp;<span class="op" id="7591412">[</span><span class="op" id="7591413">]</span><span class="builtintype" id="7591414">byte</span><span class="op" id="7591418">(</span><span class="ident" id="7591419">dictionary</span><span class="op" id="7591429">)</span><span class="op" id="7591430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7591434">if</span>&nbsp;<span class="op" id="7591437">!</span><span class="ident" id="7591438">testing</span><span class="op" id="7591445">.</span><span class="ident" id="7591446">Short</span><span class="op" id="7591451">(</span><span class="op" id="7591452">)</span>&nbsp;<span class="op" id="7591454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7591459">for</span>&nbsp;<span class="ident" id="7591463">level</span>&nbsp;<span class="op" id="7591469">:=</span>&nbsp;<span class="ident" id="7591472">BestSpeed</span><span class="op" id="7591481">;</span>&nbsp;<span class="ident" id="7591483">level</span>&nbsp;<span class="op" id="7591489">&lt;=</span>&nbsp;<span class="ident" id="7591492">BestCompression</span><span class="op" id="7591507">;</span>&nbsp;<span class="ident" id="7591509">level</span><span class="op" id="7591514">++</span>&nbsp;<span class="op" id="7591517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7591523">testFileLevelDictReset</span><span class="op" id="7591545">(</span><span class="ident" id="7591546">t</span><span class="op" id="7591547">,</span>&nbsp;<span class="ident" id="7591549">fn</span><span class="op" id="7591551">,</span>&nbsp;<span class="ident" id="7591553">level</span><span class="op" id="7591558">,</span>&nbsp;<span class="ident" id="7591560">nil</span><span class="op" id="7591563">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7591568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7591572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7591575">}</span><br>
<span class="lineno"></span><span class="op" id="7591577">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="7591580">func</span>&nbsp;<span class="ident" id="7591585">TestWriterDictIsUsed</span><span class="op" id="7591605">(</span><span class="ident" id="7591606">t</span>&nbsp;<span class="op" id="7591608">*</span><span class="ident" id="7591609">testing</span><span class="op" id="7591616">.</span><span class="ident" id="7591617">T</span><span class="op" id="7591618">)</span>&nbsp;<span class="op" id="7591620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7591623">var</span>&nbsp;<span class="ident" id="7591627">input</span>&nbsp;<span class="op" id="7591633">=</span>&nbsp;<span class="op" id="7591635">[</span><span class="op" id="7591636">]</span><span class="builtintype" id="7591637">byte</span><span class="op" id="7591641">(</span><span class="string" id="7591642">&#34;Lorem&nbsp;ipsum&nbsp;dolor&nbsp;sit&nbsp;amet,&nbsp;consectetur&nbsp;adipisicing&nbsp;elit,&nbsp;sed&nbsp;do&nbsp;eiusmod&nbsp;tempor&nbsp;incididunt&nbsp;ut&nbsp;labore&nbsp;et&nbsp;dolore&nbsp;magna&nbsp;aliqua.&#34;</span><span class="op" id="7591768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7591771">var</span>&nbsp;<span class="ident" id="7591775">buf</span>&nbsp;<span class="ident" id="7591779">bytes</span><span class="op" id="7591784">.</span><span class="ident" id="7591785">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7591793">compressor</span><span class="op" id="7591803">,</span>&nbsp;<span class="ident" id="7591805">err</span>&nbsp;<span class="op" id="7591809">:=</span>&nbsp;<span class="ident" id="7591812">NewWriterLevelDict</span><span class="op" id="7591830">(</span><span class="op" id="7591831">&amp;</span><span class="ident" id="7591832">buf</span><span class="op" id="7591835">,</span>&nbsp;<span class="ident" id="7591837">BestCompression</span><span class="op" id="7591852">,</span>&nbsp;<span class="ident" id="7591854">input</span><span class="op" id="7591859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7591862">if</span>&nbsp;<span class="ident" id="7591865">err</span>&nbsp;<span class="op" id="7591869">!=</span>&nbsp;<span class="ident" id="7591872">nil</span>&nbsp;<span class="op" id="7591876">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7591880">t</span><span class="op" id="7591881">.</span><span class="ident" id="7591882">Errorf</span><span class="op" id="7591888">(</span><span class="string" id="7591889">&#34;error&nbsp;in&nbsp;NewWriterLevelDict:&nbsp;%s&#34;</span><span class="op" id="7591922">,</span>&nbsp;<span class="ident" id="7591924">err</span><span class="op" id="7591927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7591931">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7591939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7591942">compressor</span><span class="op" id="7591952">.</span><span class="ident" id="7591953">Write</span><span class="op" id="7591958">(</span><span class="ident" id="7591959">input</span><span class="op" id="7591964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7591967">compressor</span><span class="op" id="7591977">.</span><span class="ident" id="7591978">Close</span><span class="op" id="7591983">(</span><span class="op" id="7591984">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7591987">const</span>&nbsp;<span class="ident" id="7591993">expectedMaxSize</span>&nbsp;<span class="op" id="7592009">=</span>&nbsp;<span class="num" id="7592011">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7592015">output</span>&nbsp;<span class="op" id="7592022">:=</span>&nbsp;<span class="ident" id="7592025">buf</span><span class="op" id="7592028">.</span><span class="ident" id="7592029">Bytes</span><span class="op" id="7592034">(</span><span class="op" id="7592035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7592038">if</span>&nbsp;<span class="builtinfunc" id="7592041">len</span><span class="op" id="7592044">(</span><span class="ident" id="7592045">output</span><span class="op" id="7592051">)</span>&nbsp;<span class="op" id="7592053">&gt;</span>&nbsp;<span class="ident" id="7592055">expectedMaxSize</span>&nbsp;<span class="op" id="7592071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7592075">t</span><span class="op" id="7592076">.</span><span class="ident" id="7592077">Errorf</span><span class="op" id="7592083">(</span><span class="string" id="7592084">&#34;result&nbsp;too&nbsp;large&nbsp;(got&nbsp;%d,&nbsp;want&nbsp;&lt;=&nbsp;%d&nbsp;bytes).&nbsp;Is&nbsp;the&nbsp;dictionary&nbsp;being&nbsp;used?&#34;</span><span class="op" id="7592160">,</span>&nbsp;<span class="builtinfunc" id="7592162">len</span><span class="op" id="7592165">(</span><span class="ident" id="7592166">output</span><span class="op" id="7592172">)</span><span class="op" id="7592173">,</span>&nbsp;<span class="ident" id="7592175">expectedMaxSize</span><span class="op" id="7592190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7592193">}</span><br>
<span class="lineno">205</span><span class="op" id="7592195">}</span>
</div>
</body>
</html>
