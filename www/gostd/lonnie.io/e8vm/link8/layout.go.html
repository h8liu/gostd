<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="keyword" id="5128894">package</span>&nbsp;<span class="ident" id="5128902">link8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5128909">import</span>&nbsp;<span class="op" id="5128916">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5128919">&#34;fmt&#34;</span><br>
<span class="lineno">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5128927">&#34;lonnie.io/e8vm/arch8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5128950">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5128953">func</span>&nbsp;<span class="ident" id="5128958">layout</span><span class="op" id="5128964">(</span><span class="ident" id="5128965">used</span>&nbsp;<span class="op" id="5128970">[</span><span class="op" id="5128971">]</span><span class="ident" id="5128972">pkgSym</span><span class="op" id="5128978">)</span>&nbsp;<span class="op" id="5128980">(</span><span class="ident" id="5128981">funcs</span><span class="op" id="5128986">,</span>&nbsp;<span class="ident" id="5128988">vars</span>&nbsp;<span class="op" id="5128993">[</span><span class="op" id="5128994">]</span><span class="ident" id="5128995">pkgSym</span><span class="op" id="5129001">,</span>&nbsp;<span class="ident" id="5129003">e</span>&nbsp;<span class="builtintype" id="5129005">error</span><span class="op" id="5129010">)</span>&nbsp;<span class="op" id="5129012">{</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5129015">//&nbsp;code</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129024">pt</span>&nbsp;<span class="op" id="5129027">:=</span>&nbsp;<span class="builtintype" id="5129030">uint32</span><span class="op" id="5129036">(</span><span class="ident" id="5129037">arch8</span><span class="op" id="5129042">.</span><span class="ident" id="5129043">InitPC</span><span class="op" id="5129049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129052">codeMax</span>&nbsp;<span class="op" id="5129060">:=</span>&nbsp;<span class="builtintype" id="5129063">uint32</span><span class="op" id="5129069">(</span><span class="num" id="5129070">0xffffffff</span><span class="op" id="5129080">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129084">for</span>&nbsp;<span class="ident" id="5129088">_</span><span class="op" id="5129089">,</span>&nbsp;<span class="ident" id="5129091">ps</span>&nbsp;<span class="op" id="5129094">:=</span>&nbsp;<span class="keyword" id="5129097">range</span>&nbsp;<span class="ident" id="5129103">used</span>&nbsp;<span class="op" id="5129108">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129112">typ</span>&nbsp;<span class="op" id="5129116">:=</span>&nbsp;<span class="ident" id="5129119">ps</span><span class="op" id="5129121">.</span><span class="ident" id="5129122">Type</span><span class="op" id="5129126">(</span><span class="op" id="5129127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129131">switch</span>&nbsp;<span class="ident" id="5129138">typ</span>&nbsp;<span class="op" id="5129142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129146">case</span>&nbsp;<span class="ident" id="5129151">SymFunc</span><span class="op" id="5129158">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129163">funcs</span>&nbsp;<span class="op" id="5129169">=</span>&nbsp;<span class="builtinfunc" id="5129171">append</span><span class="op" id="5129177">(</span><span class="ident" id="5129178">funcs</span><span class="op" id="5129183">,</span>&nbsp;<span class="ident" id="5129185">ps</span><span class="op" id="5129187">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129193">f</span>&nbsp;<span class="op" id="5129195">:=</span>&nbsp;<span class="ident" id="5129198">ps</span><span class="op" id="5129200">.</span><span class="ident" id="5129201">Func</span><span class="op" id="5129205">(</span><span class="op" id="5129206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129211">f</span><span class="op" id="5129212">.</span><span class="ident" id="5129213">addr</span>&nbsp;<span class="op" id="5129218">=</span>&nbsp;<span class="ident" id="5129220">pt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129226">size</span>&nbsp;<span class="op" id="5129231">:=</span>&nbsp;<span class="ident" id="5129234">f</span><span class="op" id="5129235">.</span><span class="ident" id="5129236">Size</span><span class="op" id="5129240">(</span><span class="op" id="5129241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129246">if</span>&nbsp;<span class="ident" id="5129249">size</span>&nbsp;<span class="op" id="5129254">&gt;</span>&nbsp;<span class="ident" id="5129256">codeMax</span><span class="op" id="5129263">-</span><span class="ident" id="5129264">pt</span>&nbsp;<span class="op" id="5129267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129273">return</span>&nbsp;<span class="ident" id="5129280">nil</span><span class="op" id="5129283">,</span>&nbsp;<span class="ident" id="5129285">nil</span><span class="op" id="5129288">,</span>&nbsp;<span class="ident" id="5129290">fmt</span><span class="op" id="5129293">.</span><span class="ident" id="5129294">Errorf</span><span class="op" id="5129300">(</span><span class="string" id="5129301">&#34;code&nbsp;section&nbsp;too&nbsp;large&#34;</span><span class="op" id="5129325">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5129330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129335">pt</span>&nbsp;<span class="op" id="5129338">+=</span>&nbsp;<span class="ident" id="5129341">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129348">case</span>&nbsp;<span class="ident" id="5129353">SymVar</span><span class="op" id="5129359">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129364">vars</span>&nbsp;<span class="op" id="5129369">=</span>&nbsp;<span class="builtinfunc" id="5129371">append</span><span class="op" id="5129377">(</span><span class="ident" id="5129378">vars</span><span class="op" id="5129382">,</span>&nbsp;<span class="ident" id="5129384">ps</span><span class="op" id="5129386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129390">default</span><span class="op" id="5129397">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5129402">panic</span><span class="op" id="5129407">(</span><span class="string" id="5129408">&#34;bug&#34;</span><span class="op" id="5129413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5129417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5129420">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129424">dataMax</span>&nbsp;<span class="op" id="5129432">:=</span>&nbsp;<span class="builtintype" id="5129435">uint32</span><span class="op" id="5129441">(</span><span class="num" id="5129442">0xffffffff</span><span class="op" id="5129452">)</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129456">for</span>&nbsp;<span class="ident" id="5129460">_</span><span class="op" id="5129461">,</span>&nbsp;<span class="ident" id="5129463">ps</span>&nbsp;<span class="op" id="5129466">:=</span>&nbsp;<span class="keyword" id="5129469">range</span>&nbsp;<span class="ident" id="5129475">vars</span>&nbsp;<span class="op" id="5129480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129484">if</span>&nbsp;<span class="ident" id="5129487">ps</span><span class="op" id="5129489">.</span><span class="ident" id="5129490">Type</span><span class="op" id="5129494">(</span><span class="op" id="5129495">)</span>&nbsp;<span class="op" id="5129497">!=</span>&nbsp;<span class="ident" id="5129500">SymVar</span>&nbsp;<span class="op" id="5129507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5129512">panic</span><span class="op" id="5129517">(</span><span class="string" id="5129518">&#34;bug&#34;</span><span class="op" id="5129523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5129527">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129532">v</span>&nbsp;<span class="op" id="5129534">:=</span>&nbsp;<span class="ident" id="5129537">ps</span><span class="op" id="5129539">.</span><span class="ident" id="5129540">Var</span><span class="op" id="5129543">(</span><span class="op" id="5129544">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129549">if</span>&nbsp;<span class="ident" id="5129552">v</span><span class="op" id="5129553">.</span><span class="ident" id="5129554">align</span>&nbsp;<span class="op" id="5129560">&gt;</span>&nbsp;<span class="num" id="5129562">1</span>&nbsp;<span class="op" id="5129564">&amp;&amp;</span>&nbsp;<span class="ident" id="5129567">pt</span><span class="op" id="5129569">%</span><span class="ident" id="5129570">v</span><span class="op" id="5129571">.</span><span class="ident" id="5129572">align</span>&nbsp;<span class="op" id="5129578">!=</span>&nbsp;<span class="num" id="5129581">0</span>&nbsp;<span class="op" id="5129583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129588">v</span><span class="op" id="5129589">.</span><span class="ident" id="5129590">prePad</span>&nbsp;<span class="op" id="5129597">=</span>&nbsp;<span class="ident" id="5129599">v</span><span class="op" id="5129600">.</span><span class="ident" id="5129601">align</span>&nbsp;<span class="op" id="5129607">-</span>&nbsp;<span class="ident" id="5129609">pt</span><span class="op" id="5129611">%</span><span class="ident" id="5129612">v</span><span class="op" id="5129613">.</span><span class="ident" id="5129614">align</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129623">pt</span>&nbsp;<span class="op" id="5129626">+=</span>&nbsp;<span class="ident" id="5129629">v</span><span class="op" id="5129630">.</span><span class="ident" id="5129631">prePad</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5129640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129644">if</span>&nbsp;<span class="ident" id="5129647">v</span><span class="op" id="5129648">.</span><span class="ident" id="5129649">align</span>&nbsp;<span class="op" id="5129655">&gt;</span>&nbsp;<span class="num" id="5129657">1</span>&nbsp;<span class="op" id="5129659">&amp;&amp;</span>&nbsp;<span class="ident" id="5129662">pt</span><span class="op" id="5129664">%</span><span class="ident" id="5129665">v</span><span class="op" id="5129666">.</span><span class="ident" id="5129667">align</span>&nbsp;<span class="op" id="5129673">!=</span>&nbsp;<span class="num" id="5129676">0</span>&nbsp;<span class="op" id="5129678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5129683">panic</span><span class="op" id="5129688">(</span><span class="string" id="5129689">&#34;bug&#34;</span><span class="op" id="5129694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5129698">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129703">v</span><span class="op" id="5129704">.</span><span class="ident" id="5129705">addr</span>&nbsp;<span class="op" id="5129710">=</span>&nbsp;<span class="ident" id="5129712">pt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129717">size</span>&nbsp;<span class="op" id="5129722">:=</span>&nbsp;<span class="ident" id="5129725">v</span><span class="op" id="5129726">.</span><span class="ident" id="5129727">Size</span><span class="op" id="5129731">(</span><span class="op" id="5129732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129736">if</span>&nbsp;<span class="ident" id="5129739">size</span>&nbsp;<span class="op" id="5129744">&gt;</span>&nbsp;<span class="ident" id="5129746">dataMax</span><span class="op" id="5129753">-</span><span class="ident" id="5129754">pt</span>&nbsp;<span class="op" id="5129757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129762">return</span>&nbsp;<span class="ident" id="5129769">nil</span><span class="op" id="5129772">,</span>&nbsp;<span class="ident" id="5129774">nil</span><span class="op" id="5129777">,</span>&nbsp;<span class="ident" id="5129779">fmt</span><span class="op" id="5129782">.</span><span class="ident" id="5129783">Errorf</span><span class="op" id="5129789">(</span><span class="string" id="5129790">&#34;binary&nbsp;too&nbsp;large&#34;</span><span class="op" id="5129808">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5129812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5129817">pt</span>&nbsp;<span class="op" id="5129820">+=</span>&nbsp;<span class="ident" id="5129823">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5129829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5129833">return</span><br>
<span class="lineno"></span><span class="op" id="5129840">}</span>
</div>
</body>
</html>
