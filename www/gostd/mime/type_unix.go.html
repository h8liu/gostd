<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime</h2>
<ul>
<li><a href="/gostd/mime/grammar.go.html">grammar.go</a></li>
<li><a href="/gostd/mime/mediatype.go.html">mediatype.go</a></li>
<li><a href="/gostd/mime/mediatype_test.go.html">mediatype_test.go</a></li>
<li><a href="/gostd/mime/type.go.html">type.go</a></li>
<li><a href="/gostd/mime/type_test.go.html">type_test.go</a></li>
<li><a href="/gostd/mime/type_unix.go.html" class="current">type_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3659897">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3659952">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3660006">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3660057">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3660127">package</span>&nbsp;<span class="ident" id="3660135">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3660141">import</span>&nbsp;<span class="op" id="3660148">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3660151">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3660160">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3660166">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="3660176">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3660179">var</span>&nbsp;<span class="ident" id="3660183">typeFiles</span>&nbsp;<span class="op" id="3660193">=</span>&nbsp;<span class="op" id="3660195">[</span><span class="op" id="3660196">]</span><span class="builtintype" id="3660197">string</span><span class="op" id="3660203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3660206">&#34;/etc/mime.types&#34;</span><span class="op" id="3660223">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3660226">&#34;/etc/apache2/mime.types&#34;</span><span class="op" id="3660251">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3660254">&#34;/etc/apache/mime.types&#34;</span><span class="op" id="3660278">,</span><br>
<span class="lineno"></span><span class="op" id="3660280">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="3660283">func</span>&nbsp;<span class="ident" id="3660288">loadMimeFile</span><span class="op" id="3660300">(</span><span class="ident" id="3660301">filename</span>&nbsp;<span class="builtintype" id="3660310">string</span><span class="op" id="3660316">)</span>&nbsp;<span class="op" id="3660318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3660321">f</span><span class="op" id="3660322">,</span>&nbsp;<span class="ident" id="3660324">err</span>&nbsp;<span class="op" id="3660328">:=</span>&nbsp;<span class="ident" id="3660331">os</span><span class="op" id="3660333">.</span><span class="ident" id="3660334">Open</span><span class="op" id="3660338">(</span><span class="ident" id="3660339">filename</span><span class="op" id="3660347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3660350">if</span>&nbsp;<span class="ident" id="3660353">err</span>&nbsp;<span class="op" id="3660357">!=</span>&nbsp;<span class="ident" id="3660360">nil</span>&nbsp;<span class="op" id="3660364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3660368">return</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3660376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3660379">defer</span>&nbsp;<span class="ident" id="3660385">f</span><span class="op" id="3660386">.</span><span class="ident" id="3660387">Close</span><span class="op" id="3660392">(</span><span class="op" id="3660393">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3660397">scanner</span>&nbsp;<span class="op" id="3660405">:=</span>&nbsp;<span class="ident" id="3660408">bufio</span><span class="op" id="3660413">.</span><span class="ident" id="3660414">NewScanner</span><span class="op" id="3660424">(</span><span class="ident" id="3660425">f</span><span class="op" id="3660426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3660429">for</span>&nbsp;<span class="ident" id="3660433">scanner</span><span class="op" id="3660440">.</span><span class="ident" id="3660441">Scan</span><span class="op" id="3660445">(</span><span class="op" id="3660446">)</span>&nbsp;<span class="op" id="3660448">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3660452">fields</span>&nbsp;<span class="op" id="3660459">:=</span>&nbsp;<span class="ident" id="3660462">strings</span><span class="op" id="3660469">.</span><span class="ident" id="3660470">Fields</span><span class="op" id="3660476">(</span><span class="ident" id="3660477">scanner</span><span class="op" id="3660484">.</span><span class="ident" id="3660485">Text</span><span class="op" id="3660489">(</span><span class="op" id="3660490">)</span><span class="op" id="3660491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3660495">if</span>&nbsp;<span class="builtinfunc" id="3660498">len</span><span class="op" id="3660501">(</span><span class="ident" id="3660502">fields</span><span class="op" id="3660508">)</span>&nbsp;<span class="op" id="3660510">&lt;=</span>&nbsp;<span class="num" id="3660513">1</span>&nbsp;<span class="op" id="3660515">||</span>&nbsp;<span class="ident" id="3660518">fields</span><span class="op" id="3660524">[</span><span class="num" id="3660525">0</span><span class="op" id="3660526">]</span><span class="op" id="3660527">[</span><span class="num" id="3660528">0</span><span class="op" id="3660529">]</span>&nbsp;<span class="op" id="3660531">==</span>&nbsp;<span class="string" id="3660534">&#39;#&#39;</span>&nbsp;<span class="op" id="3660538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3660543">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3660554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3660558">mimeType</span>&nbsp;<span class="op" id="3660567">:=</span>&nbsp;<span class="ident" id="3660570">fields</span><span class="op" id="3660576">[</span><span class="num" id="3660577">0</span><span class="op" id="3660578">]</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3660582">for</span>&nbsp;<span class="ident" id="3660586">_</span><span class="op" id="3660587">,</span>&nbsp;<span class="ident" id="3660589">ext</span>&nbsp;<span class="op" id="3660593">:=</span>&nbsp;<span class="keyword" id="3660596">range</span>&nbsp;<span class="ident" id="3660602">fields</span><span class="op" id="3660608">[</span><span class="num" id="3660609">1</span><span class="op" id="3660610">:</span><span class="op" id="3660611">]</span>&nbsp;<span class="op" id="3660613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3660618">if</span>&nbsp;<span class="ident" id="3660621">ext</span><span class="op" id="3660624">[</span><span class="num" id="3660625">0</span><span class="op" id="3660626">]</span>&nbsp;<span class="op" id="3660628">==</span>&nbsp;<span class="string" id="3660631">&#39;#&#39;</span>&nbsp;<span class="op" id="3660635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3660641">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3660650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3660655">setExtensionType</span><span class="op" id="3660671">(</span><span class="string" id="3660672">&#34;.&#34;</span><span class="op" id="3660675">+</span><span class="ident" id="3660676">ext</span><span class="op" id="3660679">,</span>&nbsp;<span class="ident" id="3660681">mimeType</span><span class="op" id="3660689">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3660693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3660696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3660699">if</span>&nbsp;<span class="ident" id="3660702">err</span>&nbsp;<span class="op" id="3660706">:=</span>&nbsp;<span class="ident" id="3660709">scanner</span><span class="op" id="3660716">.</span><span class="ident" id="3660717">Err</span><span class="op" id="3660720">(</span><span class="op" id="3660721">)</span><span class="op" id="3660722">;</span>&nbsp;<span class="ident" id="3660724">err</span>&nbsp;<span class="op" id="3660728">!=</span>&nbsp;<span class="ident" id="3660731">nil</span>&nbsp;<span class="op" id="3660735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3660739">panic</span><span class="op" id="3660744">(</span><span class="ident" id="3660745">err</span><span class="op" id="3660748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3660751">}</span><br>
<span class="lineno">45</span><span class="op" id="3660753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3660756">func</span>&nbsp;<span class="ident" id="3660761">initMime</span><span class="op" id="3660769">(</span><span class="op" id="3660770">)</span>&nbsp;<span class="op" id="3660772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3660775">for</span>&nbsp;<span class="ident" id="3660779">_</span><span class="op" id="3660780">,</span>&nbsp;<span class="ident" id="3660782">filename</span>&nbsp;<span class="op" id="3660791">:=</span>&nbsp;<span class="keyword" id="3660794">range</span>&nbsp;<span class="ident" id="3660800">typeFiles</span>&nbsp;<span class="op" id="3660810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3660814">loadMimeFile</span><span class="op" id="3660826">(</span><span class="ident" id="3660827">filename</span><span class="op" id="3660835">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3660838">}</span><br>
<span class="lineno"></span><span class="op" id="3660840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3660843">func</span>&nbsp;<span class="ident" id="3660848">initMimeForTests</span><span class="op" id="3660864">(</span><span class="op" id="3660865">)</span>&nbsp;<span class="keyword" id="3660867">map</span><span class="op" id="3660870">[</span><span class="builtintype" id="3660871">string</span><span class="op" id="3660877">]</span><span class="builtintype" id="3660878">string</span>&nbsp;<span class="op" id="3660885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3660888">typeFiles</span>&nbsp;<span class="op" id="3660898">=</span>&nbsp;<span class="op" id="3660900">[</span><span class="op" id="3660901">]</span><span class="builtintype" id="3660902">string</span><span class="op" id="3660908">{</span><span class="string" id="3660909">&#34;testdata/test.types&#34;</span><span class="op" id="3660930">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3660933">return</span>&nbsp;<span class="keyword" id="3660940">map</span><span class="op" id="3660943">[</span><span class="builtintype" id="3660944">string</span><span class="op" id="3660950">]</span><span class="builtintype" id="3660951">string</span><span class="op" id="3660957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3660961">&#34;.T1&#34;</span><span class="op" id="3660966">:</span>&nbsp;&nbsp;<span class="string" id="3660969">&#34;application/test&#34;</span><span class="op" id="3660987">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3660991">&#34;.t2&#34;</span><span class="op" id="3660996">:</span>&nbsp;&nbsp;<span class="string" id="3660999">&#34;text/test;&nbsp;charset=utf-8&#34;</span><span class="op" id="3661025">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3661029">&#34;.png&#34;</span><span class="op" id="3661035">:</span>&nbsp;<span class="string" id="3661037">&#34;image/png&#34;</span><span class="op" id="3661048">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3661051">}</span><br>
<span class="lineno">60</span><span class="op" id="3661053">}</span>
</div>
</body>
</html>
