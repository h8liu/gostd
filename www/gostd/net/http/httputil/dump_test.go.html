<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http/httputil</h2>
<ul>
<li><a href="/gostd/net/http/httputil/dump.go.html">dump.go</a></li>
<li><a href="/gostd/net/http/httputil/dump_test.go.html">dump_test.go</a></li>
<li><a href="/gostd/net/http/httputil/httputil.go.html">httputil.go</a></li>
<li><a href="/gostd/net/http/httputil/persist.go.html">persist.go</a></li>
<li><a href="/gostd/net/http/httputil/reverseproxy.go.html">reverseproxy.go</a></li>
<li><a href="/gostd/net/http/httputil/reverseproxy_test.go.html">reverseproxy_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7184428">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7184483">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7184537">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7184588">package</span>&nbsp;<span class="ident" id="7184596">httputil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7184606">import</span>&nbsp;<span class="op" id="7184613">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7184616">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7184625">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7184632">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7184638">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7184651">&#34;net/http&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7184663">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7184674">&#34;runtime&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7184685">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7184696">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7184706">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7184709">type</span>&nbsp;<span class="ident" id="7184714">dumpTest</span>&nbsp;<span class="keyword" id="7184723">struct</span>&nbsp;<span class="op" id="7184730">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7184733">Req</span>&nbsp;&nbsp;<span class="ident" id="7184738">http</span><span class="op" id="7184742">.</span><span class="ident" id="7184743">Request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7184752">Body</span>&nbsp;<span class="keyword" id="7184757">interface</span><span class="op" id="7184766">{</span><span class="op" id="7184767">}</span>&nbsp;<span class="comment" id="7184769">//&nbsp;optional&nbsp;[]byte&nbsp;or&nbsp;func()&nbsp;io.ReadCloser&nbsp;to&nbsp;populate&nbsp;Req.Body</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7184835">WantDump</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7184847">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7184855">WantDumpOut</span>&nbsp;<span class="builtintype" id="7184867">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7184875">NoBody</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7184887">bool</span>&nbsp;<span class="comment" id="7184892">//&nbsp;if&nbsp;true,&nbsp;set&nbsp;DumpRequest{,Out}&nbsp;body&nbsp;to&nbsp;false</span><br>
<span class="lineno"></span><span class="op" id="7184940">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7184943">var</span>&nbsp;<span class="ident" id="7184947">dumpTests</span>&nbsp;<span class="op" id="7184957">=</span>&nbsp;<span class="op" id="7184959">[</span><span class="op" id="7184960">]</span><span class="ident" id="7184961">dumpTest</span><span class="op" id="7184969">{</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7184973">//&nbsp;HTTP/1.1&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;body;&nbsp;empty&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7185025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185029">Req</span><span class="op" id="7185032">:</span>&nbsp;<span class="ident" id="7185034">http</span><span class="op" id="7185038">.</span><span class="ident" id="7185039">Request</span><span class="op" id="7185046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185051">Method</span><span class="op" id="7185057">:</span>&nbsp;<span class="string" id="7185059">&#34;GET&#34;</span><span class="op" id="7185064">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185069">URL</span><span class="op" id="7185072">:</span>&nbsp;<span class="op" id="7185074">&amp;</span><span class="ident" id="7185075">url</span><span class="op" id="7185078">.</span><span class="ident" id="7185079">URL</span><span class="op" id="7185082">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185088">Scheme</span><span class="op" id="7185094">:</span>&nbsp;<span class="string" id="7185096">&#34;http&#34;</span><span class="op" id="7185102">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185108">Host</span><span class="op" id="7185112">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7185116">&#34;www.google.com&#34;</span><span class="op" id="7185132">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185138">Path</span><span class="op" id="7185142">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7185146">&#34;/search&#34;</span><span class="op" id="7185155">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7185160">}</span><span class="op" id="7185161">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185166">ProtoMajor</span><span class="op" id="7185176">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7185184">1</span><span class="op" id="7185185">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185190">ProtoMinor</span><span class="op" id="7185200">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7185208">1</span><span class="op" id="7185209">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185214">TransferEncoding</span><span class="op" id="7185230">:</span>&nbsp;<span class="op" id="7185232">[</span><span class="op" id="7185233">]</span><span class="builtintype" id="7185234">string</span><span class="op" id="7185240">{</span><span class="string" id="7185241">&#34;chunked&#34;</span><span class="op" id="7185250">}</span><span class="op" id="7185251">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7185255">}</span><span class="op" id="7185256">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185261">Body</span><span class="op" id="7185265">:</span>&nbsp;<span class="op" id="7185267">[</span><span class="op" id="7185268">]</span><span class="builtintype" id="7185269">byte</span><span class="op" id="7185273">(</span><span class="string" id="7185274">&#34;abcdef&#34;</span><span class="op" id="7185282">)</span><span class="op" id="7185283">,</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185288">WantDump</span><span class="op" id="7185296">:</span>&nbsp;<span class="string" id="7185298">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7185325">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7185330">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7185357">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7185362">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7185399">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185404">chunk</span><span class="op" id="7185409">(</span><span class="string" id="7185410">&#34;abcdef&#34;</span><span class="op" id="7185418">)</span>&nbsp;<span class="op" id="7185420">+</span>&nbsp;<span class="ident" id="7185422">chunk</span><span class="op" id="7185427">(</span><span class="string" id="7185428">&#34;&#34;</span><span class="op" id="7185430">)</span><span class="op" id="7185431">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7185434">}</span><span class="op" id="7185435">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7185439">//&nbsp;Verify&nbsp;that&nbsp;DumpRequest&nbsp;preserves&nbsp;the&nbsp;HTTP&nbsp;version&nbsp;number,&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;Host,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7185522">//&nbsp;and&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;User-Agent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7185556">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185560">Req</span><span class="op" id="7185563">:</span>&nbsp;<span class="ident" id="7185565">http</span><span class="op" id="7185569">.</span><span class="ident" id="7185570">Request</span><span class="op" id="7185577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185582">Method</span><span class="op" id="7185588">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7185594">&#34;GET&#34;</span><span class="op" id="7185599">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185604">URL</span><span class="op" id="7185607">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7185616">mustParseURL</span><span class="op" id="7185628">(</span><span class="string" id="7185629">&#34;/foo&#34;</span><span class="op" id="7185635">)</span><span class="op" id="7185636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185641">ProtoMajor</span><span class="op" id="7185651">:</span>&nbsp;<span class="num" id="7185653">1</span><span class="op" id="7185654">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185659">ProtoMinor</span><span class="op" id="7185669">:</span>&nbsp;<span class="num" id="7185671">0</span><span class="op" id="7185672">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185677">Header</span><span class="op" id="7185683">:</span>&nbsp;<span class="ident" id="7185685">http</span><span class="op" id="7185689">.</span><span class="ident" id="7185690">Header</span><span class="op" id="7185696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7185702">&#34;X-Foo&#34;</span><span class="op" id="7185709">:</span>&nbsp;<span class="op" id="7185711">[</span><span class="op" id="7185712">]</span><span class="builtintype" id="7185713">string</span><span class="op" id="7185719">{</span><span class="string" id="7185720">&#34;X-Bar&#34;</span><span class="op" id="7185727">}</span><span class="op" id="7185728">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7185733">}</span><span class="op" id="7185734">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7185738">}</span><span class="op" id="7185739">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185744">WantDump</span><span class="op" id="7185752">:</span>&nbsp;<span class="string" id="7185754">&#34;GET&nbsp;/foo&nbsp;HTTP/1.0\r\n&#34;</span>&nbsp;<span class="op" id="7185778">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7185783">&#34;X-Foo:&nbsp;X-Bar\r\n\r\n&#34;</span><span class="op" id="7185805">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7185808">}</span><span class="op" id="7185809">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7185813">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185817">Req</span><span class="op" id="7185820">:</span>&nbsp;<span class="op" id="7185822">*</span><span class="ident" id="7185823">mustNewRequest</span><span class="op" id="7185837">(</span><span class="string" id="7185838">&#34;GET&#34;</span><span class="op" id="7185843">,</span>&nbsp;<span class="string" id="7185845">&#34;http://example.com/foo&#34;</span><span class="op" id="7185869">,</span>&nbsp;<span class="ident" id="7185871">nil</span><span class="op" id="7185874">)</span><span class="op" id="7185875">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7185880">WantDumpOut</span><span class="op" id="7185891">:</span>&nbsp;<span class="string" id="7185893">&#34;GET&nbsp;/foo&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7185917">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7185922">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7185946">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7185951">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7185989">+</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7185994">&#34;Accept-Encoding:&nbsp;gzip\r\n\r\n&#34;</span><span class="op" id="7186025">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7186028">}</span><span class="op" id="7186029">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7186033">//&nbsp;Test&nbsp;that&nbsp;an&nbsp;https&nbsp;URL&nbsp;doesn&#39;t&nbsp;try&nbsp;to&nbsp;do&nbsp;an&nbsp;SSL&nbsp;negotiation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7186097">//&nbsp;with&nbsp;a&nbsp;bytes.Buffer&nbsp;and&nbsp;hang&nbsp;with&nbsp;all&nbsp;goroutines&nbsp;not</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7186154">//&nbsp;runnable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7186168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186172">Req</span><span class="op" id="7186175">:</span>&nbsp;<span class="op" id="7186177">*</span><span class="ident" id="7186178">mustNewRequest</span><span class="op" id="7186192">(</span><span class="string" id="7186193">&#34;GET&#34;</span><span class="op" id="7186198">,</span>&nbsp;<span class="string" id="7186200">&#34;https://example.com/foo&#34;</span><span class="op" id="7186225">,</span>&nbsp;<span class="ident" id="7186227">nil</span><span class="op" id="7186230">)</span><span class="op" id="7186231">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186236">WantDumpOut</span><span class="op" id="7186247">:</span>&nbsp;<span class="string" id="7186249">&#34;GET&nbsp;/foo&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7186273">+</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7186278">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7186302">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7186307">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7186345">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7186350">&#34;Accept-Encoding:&nbsp;gzip\r\n\r\n&#34;</span><span class="op" id="7186381">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7186384">}</span><span class="op" id="7186385">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7186389">//&nbsp;Request&nbsp;with&nbsp;Body,&nbsp;but&nbsp;Dump&nbsp;requested&nbsp;without&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7186443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186447">Req</span><span class="op" id="7186450">:</span>&nbsp;<span class="ident" id="7186452">http</span><span class="op" id="7186456">.</span><span class="ident" id="7186457">Request</span><span class="op" id="7186464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186469">Method</span><span class="op" id="7186475">:</span>&nbsp;<span class="string" id="7186477">&#34;POST&#34;</span><span class="op" id="7186483">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186488">URL</span><span class="op" id="7186491">:</span>&nbsp;<span class="op" id="7186493">&amp;</span><span class="ident" id="7186494">url</span><span class="op" id="7186497">.</span><span class="ident" id="7186498">URL</span><span class="op" id="7186501">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186507">Scheme</span><span class="op" id="7186513">:</span>&nbsp;<span class="string" id="7186515">&#34;http&#34;</span><span class="op" id="7186521">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186527">Host</span><span class="op" id="7186531">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7186535">&#34;post.tld&#34;</span><span class="op" id="7186545">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186551">Path</span><span class="op" id="7186555">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7186559">&#34;/&#34;</span><span class="op" id="7186562">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7186567">}</span><span class="op" id="7186568">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186573">ContentLength</span><span class="op" id="7186586">:</span>&nbsp;<span class="num" id="7186588">6</span><span class="op" id="7186589">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186594">ProtoMajor</span><span class="op" id="7186604">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7186609">1</span><span class="op" id="7186610">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186615">ProtoMinor</span><span class="op" id="7186625">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7186630">1</span><span class="op" id="7186631">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7186635">}</span><span class="op" id="7186636">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186641">Body</span><span class="op" id="7186645">:</span>&nbsp;<span class="op" id="7186647">[</span><span class="op" id="7186648">]</span><span class="builtintype" id="7186649">byte</span><span class="op" id="7186653">(</span><span class="string" id="7186654">&#34;abcdef&#34;</span><span class="op" id="7186662">)</span><span class="op" id="7186663">,</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186668">WantDumpOut</span><span class="op" id="7186679">:</span>&nbsp;<span class="string" id="7186681">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7186703">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7186708">&#34;Host:&nbsp;post.tld\r\n&#34;</span>&nbsp;<span class="op" id="7186729">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7186734">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7186772">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7186777">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="7186801">+</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7186806">&#34;Accept-Encoding:&nbsp;gzip\r\n\r\n&#34;</span><span class="op" id="7186837">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186842">NoBody</span><span class="op" id="7186848">:</span>&nbsp;<span class="builtintype" id="7186850">true</span><span class="op" id="7186854">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7186857">}</span><span class="op" id="7186858">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7186862">//&nbsp;Request&nbsp;with&nbsp;Body&nbsp;&gt;&nbsp;8196&nbsp;(default&nbsp;buffer&nbsp;size)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7186913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186917">Req</span><span class="op" id="7186920">:</span>&nbsp;<span class="ident" id="7186922">http</span><span class="op" id="7186926">.</span><span class="ident" id="7186927">Request</span><span class="op" id="7186934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186939">Method</span><span class="op" id="7186945">:</span>&nbsp;<span class="string" id="7186947">&#34;POST&#34;</span><span class="op" id="7186953">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186958">URL</span><span class="op" id="7186961">:</span>&nbsp;<span class="op" id="7186963">&amp;</span><span class="ident" id="7186964">url</span><span class="op" id="7186967">.</span><span class="ident" id="7186968">URL</span><span class="op" id="7186971">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186977">Scheme</span><span class="op" id="7186983">:</span>&nbsp;<span class="string" id="7186985">&#34;http&#34;</span><span class="op" id="7186991">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7186997">Host</span><span class="op" id="7187001">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7187005">&#34;post.tld&#34;</span><span class="op" id="7187015">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187021">Path</span><span class="op" id="7187025">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7187029">&#34;/&#34;</span><span class="op" id="7187032">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7187037">}</span><span class="op" id="7187038">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187043">ContentLength</span><span class="op" id="7187056">:</span>&nbsp;<span class="num" id="7187058">8193</span><span class="op" id="7187062">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187067">ProtoMajor</span><span class="op" id="7187077">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7187082">1</span><span class="op" id="7187083">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187088">ProtoMinor</span><span class="op" id="7187098">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7187103">1</span><span class="op" id="7187104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7187108">}</span><span class="op" id="7187109">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187114">Body</span><span class="op" id="7187118">:</span>&nbsp;<span class="ident" id="7187120">bytes</span><span class="op" id="7187125">.</span><span class="ident" id="7187126">Repeat</span><span class="op" id="7187132">(</span><span class="op" id="7187133">[</span><span class="op" id="7187134">]</span><span class="builtintype" id="7187135">byte</span><span class="op" id="7187139">(</span><span class="string" id="7187140">&#34;a&#34;</span><span class="op" id="7187143">)</span><span class="op" id="7187144">,</span>&nbsp;<span class="num" id="7187146">8193</span><span class="op" id="7187150">)</span><span class="op" id="7187151">,</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187156">WantDumpOut</span><span class="op" id="7187167">:</span>&nbsp;<span class="string" id="7187169">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7187191">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7187196">&#34;Host:&nbsp;post.tld\r\n&#34;</span>&nbsp;<span class="op" id="7187217">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7187222">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7187260">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7187265">&#34;Content-Length:&nbsp;8193\r\n&#34;</span>&nbsp;<span class="op" id="7187292">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7187297">&#34;Accept-Encoding:&nbsp;gzip\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7187329">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187334">strings</span><span class="op" id="7187341">.</span><span class="ident" id="7187342">Repeat</span><span class="op" id="7187348">(</span><span class="string" id="7187349">&#34;a&#34;</span><span class="op" id="7187352">,</span>&nbsp;<span class="num" id="7187354">8193</span><span class="op" id="7187358">)</span><span class="op" id="7187359">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7187362">}</span><span class="op" id="7187363">,</span><br>
<span class="lineno"></span><span class="op" id="7187365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="keyword" id="7187368">func</span>&nbsp;<span class="ident" id="7187373">TestDumpRequest</span><span class="op" id="7187388">(</span><span class="ident" id="7187389">t</span>&nbsp;<span class="op" id="7187391">*</span><span class="ident" id="7187392">testing</span><span class="op" id="7187399">.</span><span class="ident" id="7187400">T</span><span class="op" id="7187401">)</span>&nbsp;<span class="op" id="7187403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187406">numg0</span>&nbsp;<span class="op" id="7187412">:=</span>&nbsp;<span class="ident" id="7187415">runtime</span><span class="op" id="7187422">.</span><span class="ident" id="7187423">NumGoroutine</span><span class="op" id="7187435">(</span><span class="op" id="7187436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7187439">for</span>&nbsp;<span class="ident" id="7187443">i</span><span class="op" id="7187444">,</span>&nbsp;<span class="ident" id="7187446">tt</span>&nbsp;<span class="op" id="7187449">:=</span>&nbsp;<span class="keyword" id="7187452">range</span>&nbsp;<span class="ident" id="7187458">dumpTests</span>&nbsp;<span class="op" id="7187468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187472">setBody</span>&nbsp;<span class="op" id="7187480">:=</span>&nbsp;<span class="keyword" id="7187483">func</span><span class="op" id="7187487">(</span><span class="op" id="7187488">)</span>&nbsp;<span class="op" id="7187490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7187495">if</span>&nbsp;<span class="ident" id="7187498">tt</span><span class="op" id="7187500">.</span><span class="ident" id="7187501">Body</span>&nbsp;<span class="op" id="7187506">==</span>&nbsp;<span class="ident" id="7187509">nil</span>&nbsp;<span class="op" id="7187513">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7187519">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7187529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7187534">switch</span>&nbsp;<span class="ident" id="7187541">b</span>&nbsp;<span class="op" id="7187543">:=</span>&nbsp;<span class="ident" id="7187546">tt</span><span class="op" id="7187548">.</span><span class="ident" id="7187549">Body</span><span class="op" id="7187553">.</span><span class="op" id="7187554">(</span><span class="keyword" id="7187555">type</span><span class="op" id="7187559">)</span>&nbsp;<span class="op" id="7187561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7187566">case</span>&nbsp;<span class="op" id="7187571">[</span><span class="op" id="7187572">]</span><span class="builtintype" id="7187573">byte</span><span class="op" id="7187577">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187583">tt</span><span class="op" id="7187585">.</span><span class="ident" id="7187586">Req</span><span class="op" id="7187589">.</span><span class="ident" id="7187590">Body</span>&nbsp;<span class="op" id="7187595">=</span>&nbsp;<span class="ident" id="7187597">ioutil</span><span class="op" id="7187603">.</span><span class="ident" id="7187604">NopCloser</span><span class="op" id="7187613">(</span><span class="ident" id="7187614">bytes</span><span class="op" id="7187619">.</span><span class="ident" id="7187620">NewReader</span><span class="op" id="7187629">(</span><span class="ident" id="7187630">b</span><span class="op" id="7187631">)</span><span class="op" id="7187632">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7187637">case</span>&nbsp;<span class="keyword" id="7187642">func</span><span class="op" id="7187646">(</span><span class="op" id="7187647">)</span>&nbsp;<span class="ident" id="7187649">io</span><span class="op" id="7187651">.</span><span class="ident" id="7187652">ReadCloser</span><span class="op" id="7187662">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187668">tt</span><span class="op" id="7187670">.</span><span class="ident" id="7187671">Req</span><span class="op" id="7187674">.</span><span class="ident" id="7187675">Body</span>&nbsp;<span class="op" id="7187680">=</span>&nbsp;<span class="ident" id="7187682">b</span><span class="op" id="7187683">(</span><span class="op" id="7187684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7187689">default</span><span class="op" id="7187696">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187702">t</span><span class="op" id="7187703">.</span><span class="ident" id="7187704">Fatalf</span><span class="op" id="7187710">(</span><span class="string" id="7187711">&#34;Test&nbsp;%d:&nbsp;unsupported&nbsp;Body&nbsp;of&nbsp;%T&#34;</span><span class="op" id="7187744">,</span>&nbsp;<span class="ident" id="7187746">i</span><span class="op" id="7187747">,</span>&nbsp;<span class="ident" id="7187749">tt</span><span class="op" id="7187751">.</span><span class="ident" id="7187752">Body</span><span class="op" id="7187756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7187761">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7187765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187769">setBody</span><span class="op" id="7187776">(</span><span class="op" id="7187777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7187781">if</span>&nbsp;<span class="ident" id="7187784">tt</span><span class="op" id="7187786">.</span><span class="ident" id="7187787">Req</span><span class="op" id="7187790">.</span><span class="ident" id="7187791">Header</span>&nbsp;<span class="op" id="7187798">==</span>&nbsp;<span class="ident" id="7187801">nil</span>&nbsp;<span class="op" id="7187805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187810">tt</span><span class="op" id="7187812">.</span><span class="ident" id="7187813">Req</span><span class="op" id="7187816">.</span><span class="ident" id="7187817">Header</span>&nbsp;<span class="op" id="7187824">=</span>&nbsp;<span class="builtinfunc" id="7187826">make</span><span class="op" id="7187830">(</span><span class="ident" id="7187831">http</span><span class="op" id="7187835">.</span><span class="ident" id="7187836">Header</span><span class="op" id="7187842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7187846">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7187851">if</span>&nbsp;<span class="ident" id="7187854">tt</span><span class="op" id="7187856">.</span><span class="ident" id="7187857">WantDump</span>&nbsp;<span class="op" id="7187866">!=</span>&nbsp;<span class="string" id="7187869">&#34;&#34;</span>&nbsp;<span class="op" id="7187872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187877">setBody</span><span class="op" id="7187884">(</span><span class="op" id="7187885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187890">dump</span><span class="op" id="7187894">,</span>&nbsp;<span class="ident" id="7187896">err</span>&nbsp;<span class="op" id="7187900">:=</span>&nbsp;<span class="ident" id="7187903">DumpRequest</span><span class="op" id="7187914">(</span><span class="op" id="7187915">&amp;</span><span class="ident" id="7187916">tt</span><span class="op" id="7187918">.</span><span class="ident" id="7187919">Req</span><span class="op" id="7187922">,</span>&nbsp;<span class="op" id="7187924">!</span><span class="ident" id="7187925">tt</span><span class="op" id="7187927">.</span><span class="ident" id="7187928">NoBody</span><span class="op" id="7187934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7187939">if</span>&nbsp;<span class="ident" id="7187942">err</span>&nbsp;<span class="op" id="7187946">!=</span>&nbsp;<span class="ident" id="7187949">nil</span>&nbsp;<span class="op" id="7187953">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7187959">t</span><span class="op" id="7187960">.</span><span class="ident" id="7187961">Errorf</span><span class="op" id="7187967">(</span><span class="string" id="7187968">&#34;DumpRequest&nbsp;#%d:&nbsp;%s&#34;</span><span class="op" id="7187989">,</span>&nbsp;<span class="ident" id="7187991">i</span><span class="op" id="7187992">,</span>&nbsp;<span class="ident" id="7187994">err</span><span class="op" id="7187997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7188003">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7188015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7188020">if</span>&nbsp;<span class="builtintype" id="7188023">string</span><span class="op" id="7188029">(</span><span class="ident" id="7188030">dump</span><span class="op" id="7188034">)</span>&nbsp;<span class="op" id="7188036">!=</span>&nbsp;<span class="ident" id="7188039">tt</span><span class="op" id="7188041">.</span><span class="ident" id="7188042">WantDump</span>&nbsp;<span class="op" id="7188051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7188057">t</span><span class="op" id="7188058">.</span><span class="ident" id="7188059">Errorf</span><span class="op" id="7188065">(</span><span class="string" id="7188066">&#34;DumpRequest&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="7188110">,</span>&nbsp;<span class="ident" id="7188112">i</span><span class="op" id="7188113">,</span>&nbsp;<span class="ident" id="7188115">tt</span><span class="op" id="7188117">.</span><span class="ident" id="7188118">WantDump</span><span class="op" id="7188126">,</span>&nbsp;<span class="builtintype" id="7188128">string</span><span class="op" id="7188134">(</span><span class="ident" id="7188135">dump</span><span class="op" id="7188139">)</span><span class="op" id="7188140">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7188146">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7188158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7188162">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7188167">if</span>&nbsp;<span class="ident" id="7188170">tt</span><span class="op" id="7188172">.</span><span class="ident" id="7188173">WantDumpOut</span>&nbsp;<span class="op" id="7188185">!=</span>&nbsp;<span class="string" id="7188188">&#34;&#34;</span>&nbsp;<span class="op" id="7188191">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7188196">setBody</span><span class="op" id="7188203">(</span><span class="op" id="7188204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7188209">dump</span><span class="op" id="7188213">,</span>&nbsp;<span class="ident" id="7188215">err</span>&nbsp;<span class="op" id="7188219">:=</span>&nbsp;<span class="ident" id="7188222">DumpRequestOut</span><span class="op" id="7188236">(</span><span class="op" id="7188237">&amp;</span><span class="ident" id="7188238">tt</span><span class="op" id="7188240">.</span><span class="ident" id="7188241">Req</span><span class="op" id="7188244">,</span>&nbsp;<span class="op" id="7188246">!</span><span class="ident" id="7188247">tt</span><span class="op" id="7188249">.</span><span class="ident" id="7188250">NoBody</span><span class="op" id="7188256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7188261">if</span>&nbsp;<span class="ident" id="7188264">err</span>&nbsp;<span class="op" id="7188268">!=</span>&nbsp;<span class="ident" id="7188271">nil</span>&nbsp;<span class="op" id="7188275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7188281">t</span><span class="op" id="7188282">.</span><span class="ident" id="7188283">Errorf</span><span class="op" id="7188289">(</span><span class="string" id="7188290">&#34;DumpRequestOut&nbsp;#%d:&nbsp;%s&#34;</span><span class="op" id="7188314">,</span>&nbsp;<span class="ident" id="7188316">i</span><span class="op" id="7188317">,</span>&nbsp;<span class="ident" id="7188319">err</span><span class="op" id="7188322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7188328">continue</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7188340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7188345">if</span>&nbsp;<span class="builtintype" id="7188348">string</span><span class="op" id="7188354">(</span><span class="ident" id="7188355">dump</span><span class="op" id="7188359">)</span>&nbsp;<span class="op" id="7188361">!=</span>&nbsp;<span class="ident" id="7188364">tt</span><span class="op" id="7188366">.</span><span class="ident" id="7188367">WantDumpOut</span>&nbsp;<span class="op" id="7188379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7188385">t</span><span class="op" id="7188386">.</span><span class="ident" id="7188387">Errorf</span><span class="op" id="7188393">(</span><span class="string" id="7188394">&#34;DumpRequestOut&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="7188441">,</span>&nbsp;<span class="ident" id="7188443">i</span><span class="op" id="7188444">,</span>&nbsp;<span class="ident" id="7188446">tt</span><span class="op" id="7188448">.</span><span class="ident" id="7188449">WantDumpOut</span><span class="op" id="7188460">,</span>&nbsp;<span class="builtintype" id="7188462">string</span><span class="op" id="7188468">(</span><span class="ident" id="7188469">dump</span><span class="op" id="7188473">)</span><span class="op" id="7188474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7188480">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7188492">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7188496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7188499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7188502">if</span>&nbsp;<span class="ident" id="7188505">dg</span>&nbsp;<span class="op" id="7188508">:=</span>&nbsp;<span class="ident" id="7188511">runtime</span><span class="op" id="7188518">.</span><span class="ident" id="7188519">NumGoroutine</span><span class="op" id="7188531">(</span><span class="op" id="7188532">)</span>&nbsp;<span class="op" id="7188534">-</span>&nbsp;<span class="ident" id="7188536">numg0</span><span class="op" id="7188541">;</span>&nbsp;<span class="ident" id="7188543">dg</span>&nbsp;<span class="op" id="7188546">&gt;</span>&nbsp;<span class="num" id="7188548">4</span>&nbsp;<span class="op" id="7188550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7188554">buf</span>&nbsp;<span class="op" id="7188558">:=</span>&nbsp;<span class="builtinfunc" id="7188561">make</span><span class="op" id="7188565">(</span><span class="op" id="7188566">[</span><span class="op" id="7188567">]</span><span class="builtintype" id="7188568">byte</span><span class="op" id="7188572">,</span>&nbsp;<span class="num" id="7188574">4096</span><span class="op" id="7188578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7188582">buf</span>&nbsp;<span class="op" id="7188586">=</span>&nbsp;<span class="ident" id="7188588">buf</span><span class="op" id="7188591">[</span><span class="op" id="7188592">:</span><span class="ident" id="7188593">runtime</span><span class="op" id="7188600">.</span><span class="ident" id="7188601">Stack</span><span class="op" id="7188606">(</span><span class="ident" id="7188607">buf</span><span class="op" id="7188610">,</span>&nbsp;<span class="builtintype" id="7188612">true</span><span class="op" id="7188616">)</span><span class="op" id="7188617">]</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7188621">t</span><span class="op" id="7188622">.</span><span class="ident" id="7188623">Errorf</span><span class="op" id="7188629">(</span><span class="string" id="7188630">&#34;Unexpectedly&nbsp;large&nbsp;number&nbsp;of&nbsp;new&nbsp;goroutines:&nbsp;%d&nbsp;new:&nbsp;%s&#34;</span><span class="op" id="7188687">,</span>&nbsp;<span class="ident" id="7188689">dg</span><span class="op" id="7188691">,</span>&nbsp;<span class="ident" id="7188693">buf</span><span class="op" id="7188696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7188699">}</span><br>
<span class="lineno"></span><span class="op" id="7188701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7188704">func</span>&nbsp;<span class="ident" id="7188709">chunk</span><span class="op" id="7188714">(</span><span class="ident" id="7188715">s</span>&nbsp;<span class="builtintype" id="7188717">string</span><span class="op" id="7188723">)</span>&nbsp;<span class="builtintype" id="7188725">string</span>&nbsp;<span class="op" id="7188732">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7188735">return</span>&nbsp;<span class="ident" id="7188742">fmt</span><span class="op" id="7188745">.</span><span class="ident" id="7188746">Sprintf</span><span class="op" id="7188753">(</span><span class="string" id="7188754">&#34;%x\r\n%s\r\n&#34;</span><span class="op" id="7188768">,</span>&nbsp;<span class="builtinfunc" id="7188770">len</span><span class="op" id="7188773">(</span><span class="ident" id="7188774">s</span><span class="op" id="7188775">)</span><span class="op" id="7188776">,</span>&nbsp;<span class="ident" id="7188778">s</span><span class="op" id="7188779">)</span><br>
<span class="lineno"></span><span class="op" id="7188781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7188784">func</span>&nbsp;<span class="ident" id="7188789">mustParseURL</span><span class="op" id="7188801">(</span><span class="ident" id="7188802">s</span>&nbsp;<span class="builtintype" id="7188804">string</span><span class="op" id="7188810">)</span>&nbsp;<span class="op" id="7188812">*</span><span class="ident" id="7188813">url</span><span class="op" id="7188816">.</span><span class="ident" id="7188817">URL</span>&nbsp;<span class="op" id="7188821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7188824">u</span><span class="op" id="7188825">,</span>&nbsp;<span class="ident" id="7188827">err</span>&nbsp;<span class="op" id="7188831">:=</span>&nbsp;<span class="ident" id="7188834">url</span><span class="op" id="7188837">.</span><span class="ident" id="7188838">Parse</span><span class="op" id="7188843">(</span><span class="ident" id="7188844">s</span><span class="op" id="7188845">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7188848">if</span>&nbsp;<span class="ident" id="7188851">err</span>&nbsp;<span class="op" id="7188855">!=</span>&nbsp;<span class="ident" id="7188858">nil</span>&nbsp;<span class="op" id="7188862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7188866">panic</span><span class="op" id="7188871">(</span><span class="ident" id="7188872">fmt</span><span class="op" id="7188875">.</span><span class="ident" id="7188876">Sprintf</span><span class="op" id="7188883">(</span><span class="string" id="7188884">&#34;Error&nbsp;parsing&nbsp;URL&nbsp;%q:&nbsp;%v&#34;</span><span class="op" id="7188910">,</span>&nbsp;<span class="ident" id="7188912">s</span><span class="op" id="7188913">,</span>&nbsp;<span class="ident" id="7188915">err</span><span class="op" id="7188918">)</span><span class="op" id="7188919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7188922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7188925">return</span>&nbsp;<span class="ident" id="7188932">u</span><br>
<span class="lineno"></span><span class="op" id="7188934">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="7188937">func</span>&nbsp;<span class="ident" id="7188942">mustNewRequest</span><span class="op" id="7188956">(</span><span class="ident" id="7188957">method</span><span class="op" id="7188963">,</span>&nbsp;<span class="ident" id="7188965">url</span>&nbsp;<span class="builtintype" id="7188969">string</span><span class="op" id="7188975">,</span>&nbsp;<span class="ident" id="7188977">body</span>&nbsp;<span class="ident" id="7188982">io</span><span class="op" id="7188984">.</span><span class="ident" id="7188985">Reader</span><span class="op" id="7188991">)</span>&nbsp;<span class="op" id="7188993">*</span><span class="ident" id="7188994">http</span><span class="op" id="7188998">.</span><span class="ident" id="7188999">Request</span>&nbsp;<span class="op" id="7189007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189010">req</span><span class="op" id="7189013">,</span>&nbsp;<span class="ident" id="7189015">err</span>&nbsp;<span class="op" id="7189019">:=</span>&nbsp;<span class="ident" id="7189022">http</span><span class="op" id="7189026">.</span><span class="ident" id="7189027">NewRequest</span><span class="op" id="7189037">(</span><span class="ident" id="7189038">method</span><span class="op" id="7189044">,</span>&nbsp;<span class="ident" id="7189046">url</span><span class="op" id="7189049">,</span>&nbsp;<span class="ident" id="7189051">body</span><span class="op" id="7189055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7189058">if</span>&nbsp;<span class="ident" id="7189061">err</span>&nbsp;<span class="op" id="7189065">!=</span>&nbsp;<span class="ident" id="7189068">nil</span>&nbsp;<span class="op" id="7189072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7189076">panic</span><span class="op" id="7189081">(</span><span class="ident" id="7189082">fmt</span><span class="op" id="7189085">.</span><span class="ident" id="7189086">Sprintf</span><span class="op" id="7189093">(</span><span class="string" id="7189094">&#34;NewRequest(%q,&nbsp;%q,&nbsp;%p)&nbsp;err&nbsp;=&nbsp;%v&#34;</span><span class="op" id="7189127">,</span>&nbsp;<span class="ident" id="7189129">method</span><span class="op" id="7189135">,</span>&nbsp;<span class="ident" id="7189137">url</span><span class="op" id="7189140">,</span>&nbsp;<span class="ident" id="7189142">body</span><span class="op" id="7189146">,</span>&nbsp;<span class="ident" id="7189148">err</span><span class="op" id="7189151">)</span><span class="op" id="7189152">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7189155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7189158">return</span>&nbsp;<span class="ident" id="7189165">req</span><br>
<span class="lineno"></span><span class="op" id="7189169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7189172">var</span>&nbsp;<span class="ident" id="7189176">dumpResTests</span>&nbsp;<span class="op" id="7189189">=</span>&nbsp;<span class="op" id="7189191">[</span><span class="op" id="7189192">]</span><span class="keyword" id="7189193">struct</span>&nbsp;<span class="op" id="7189200">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189203">res</span>&nbsp;&nbsp;<span class="op" id="7189208">*</span><span class="ident" id="7189209">http</span><span class="op" id="7189213">.</span><span class="ident" id="7189214">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189224">body</span>&nbsp;<span class="builtintype" id="7189229">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189235">want</span>&nbsp;<span class="builtintype" id="7189240">string</span><br>
<span class="lineno"></span><span class="op" id="7189247">}</span><span class="op" id="7189248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7189251">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189255">res</span><span class="op" id="7189258">:</span>&nbsp;<span class="op" id="7189260">&amp;</span><span class="ident" id="7189261">http</span><span class="op" id="7189265">.</span><span class="ident" id="7189266">Response</span><span class="op" id="7189274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189279">Status</span><span class="op" id="7189285">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7189294">&#34;200&nbsp;OK&#34;</span><span class="op" id="7189302">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189307">StatusCode</span><span class="op" id="7189317">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7189322">200</span><span class="op" id="7189325">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189330">Proto</span><span class="op" id="7189335">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7189345">&#34;HTTP/1.1&#34;</span><span class="op" id="7189355">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189360">ProtoMajor</span><span class="op" id="7189370">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7189375">1</span><span class="op" id="7189376">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189381">ProtoMinor</span><span class="op" id="7189391">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7189396">1</span><span class="op" id="7189397">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189402">ContentLength</span><span class="op" id="7189415">:</span>&nbsp;<span class="num" id="7189417">50</span><span class="op" id="7189419">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189424">Header</span><span class="op" id="7189430">:</span>&nbsp;<span class="ident" id="7189432">http</span><span class="op" id="7189436">.</span><span class="ident" id="7189437">Header</span><span class="op" id="7189443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7189449">&#34;Foo&#34;</span><span class="op" id="7189454">:</span>&nbsp;<span class="op" id="7189456">[</span><span class="op" id="7189457">]</span><span class="builtintype" id="7189458">string</span><span class="op" id="7189464">{</span><span class="string" id="7189465">&#34;Bar&#34;</span><span class="op" id="7189470">}</span><span class="op" id="7189471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7189476">}</span><span class="op" id="7189477">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189482">Body</span><span class="op" id="7189486">:</span>&nbsp;<span class="ident" id="7189488">ioutil</span><span class="op" id="7189494">.</span><span class="ident" id="7189495">NopCloser</span><span class="op" id="7189504">(</span><span class="ident" id="7189505">strings</span><span class="op" id="7189512">.</span><span class="ident" id="7189513">NewReader</span><span class="op" id="7189522">(</span><span class="string" id="7189523">&#34;foo&#34;</span><span class="op" id="7189528">)</span><span class="op" id="7189529">)</span><span class="op" id="7189530">,</span>&nbsp;<span class="comment" id="7189532">//&nbsp;shouldn&#39;t&nbsp;be&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7189555">}</span><span class="op" id="7189556">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189560">body</span><span class="op" id="7189564">:</span>&nbsp;<span class="builtintype" id="7189566">false</span><span class="op" id="7189571">,</span>&nbsp;<span class="comment" id="7189573">//&nbsp;to&nbsp;verify&nbsp;we&nbsp;see&nbsp;50,&nbsp;not&nbsp;empty&nbsp;or&nbsp;3.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189615">want</span><span class="op" id="7189619">:</span>&nbsp;<span class="string" id="7189621">`HTTP/1.1&nbsp;200&nbsp;OK<br>
<span class="lineno"></span>Content-Length:&nbsp;50<br>
<span class="lineno">235</span>Foo:&nbsp;Bar`</span><span class="op" id="7189666">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7189669">}</span><span class="op" id="7189670">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7189674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189678">res</span><span class="op" id="7189681">:</span>&nbsp;<span class="op" id="7189683">&amp;</span><span class="ident" id="7189684">http</span><span class="op" id="7189688">.</span><span class="ident" id="7189689">Response</span><span class="op" id="7189697">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189702">Status</span><span class="op" id="7189708">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7189717">&#34;200&nbsp;OK&#34;</span><span class="op" id="7189725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189730">StatusCode</span><span class="op" id="7189740">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7189745">200</span><span class="op" id="7189748">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189753">Proto</span><span class="op" id="7189758">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7189768">&#34;HTTP/1.1&#34;</span><span class="op" id="7189778">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189783">ProtoMajor</span><span class="op" id="7189793">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7189798">1</span><span class="op" id="7189799">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189804">ProtoMinor</span><span class="op" id="7189814">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7189819">1</span><span class="op" id="7189820">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189825">ContentLength</span><span class="op" id="7189838">:</span>&nbsp;<span class="num" id="7189840">3</span><span class="op" id="7189841">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189846">Body</span><span class="op" id="7189850">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7189861">ioutil</span><span class="op" id="7189867">.</span><span class="ident" id="7189868">NopCloser</span><span class="op" id="7189877">(</span><span class="ident" id="7189878">strings</span><span class="op" id="7189885">.</span><span class="ident" id="7189886">NewReader</span><span class="op" id="7189895">(</span><span class="string" id="7189896">&#34;foo&#34;</span><span class="op" id="7189901">)</span><span class="op" id="7189902">)</span><span class="op" id="7189903">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7189907">}</span><span class="op" id="7189908">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189912">body</span><span class="op" id="7189916">:</span>&nbsp;<span class="builtintype" id="7189918">true</span><span class="op" id="7189922">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189926">want</span><span class="op" id="7189930">:</span>&nbsp;<span class="string" id="7189932">`HTTP/1.1&nbsp;200&nbsp;OK<br>
<span class="lineno">250</span>Content-Length:&nbsp;3<br>
<span class="lineno"></span><br>
<span class="lineno"></span>foo`</span><span class="op" id="7189972">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7189975">}</span><span class="op" id="7189976">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7189980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7189984">res</span><span class="op" id="7189987">:</span>&nbsp;<span class="op" id="7189989">&amp;</span><span class="ident" id="7189990">http</span><span class="op" id="7189994">.</span><span class="ident" id="7189995">Response</span><span class="op" id="7190003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7190008">Status</span><span class="op" id="7190014">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7190026">&#34;200&nbsp;OK&#34;</span><span class="op" id="7190034">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7190039">StatusCode</span><span class="op" id="7190049">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7190057">200</span><span class="op" id="7190060">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7190065">Proto</span><span class="op" id="7190070">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7190083">&#34;HTTP/1.1&#34;</span><span class="op" id="7190093">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7190098">ProtoMajor</span><span class="op" id="7190108">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7190116">1</span><span class="op" id="7190117">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7190122">ProtoMinor</span><span class="op" id="7190132">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7190140">1</span><span class="op" id="7190141">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7190146">ContentLength</span><span class="op" id="7190159">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7190164">-</span><span class="num" id="7190165">1</span><span class="op" id="7190166">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7190171">Body</span><span class="op" id="7190175">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7190189">ioutil</span><span class="op" id="7190195">.</span><span class="ident" id="7190196">NopCloser</span><span class="op" id="7190205">(</span><span class="ident" id="7190206">strings</span><span class="op" id="7190213">.</span><span class="ident" id="7190214">NewReader</span><span class="op" id="7190223">(</span><span class="string" id="7190224">&#34;foo&#34;</span><span class="op" id="7190229">)</span><span class="op" id="7190230">)</span><span class="op" id="7190231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7190236">TransferEncoding</span><span class="op" id="7190252">:</span>&nbsp;<span class="op" id="7190254">[</span><span class="op" id="7190255">]</span><span class="builtintype" id="7190256">string</span><span class="op" id="7190262">{</span><span class="string" id="7190263">&#34;chunked&#34;</span><span class="op" id="7190272">}</span><span class="op" id="7190273">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7190277">}</span><span class="op" id="7190278">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7190282">body</span><span class="op" id="7190286">:</span>&nbsp;<span class="builtintype" id="7190288">true</span><span class="op" id="7190292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7190296">want</span><span class="op" id="7190300">:</span>&nbsp;<span class="string" id="7190302">`HTTP/1.1&nbsp;200&nbsp;OK<br>
<span class="lineno"></span>Transfer-Encoding:&nbsp;chunked<br>
<span class="lineno"></span><br>
<span class="lineno">270</span>3<br>
<span class="lineno"></span>foo<br>
<span class="lineno"></span>0`</span><span class="op" id="7190355">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7190358">}</span><span class="op" id="7190359">,</span><br>
<span class="lineno"></span><span class="op" id="7190361">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="keyword" id="7190364">func</span>&nbsp;<span class="ident" id="7190369">TestDumpResponse</span><span class="op" id="7190385">(</span><span class="ident" id="7190386">t</span>&nbsp;<span class="op" id="7190388">*</span><span class="ident" id="7190389">testing</span><span class="op" id="7190396">.</span><span class="ident" id="7190397">T</span><span class="op" id="7190398">)</span>&nbsp;<span class="op" id="7190400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7190403">for</span>&nbsp;<span class="ident" id="7190407">i</span><span class="op" id="7190408">,</span>&nbsp;<span class="ident" id="7190410">tt</span>&nbsp;<span class="op" id="7190413">:=</span>&nbsp;<span class="keyword" id="7190416">range</span>&nbsp;<span class="ident" id="7190422">dumpResTests</span>&nbsp;<span class="op" id="7190435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7190439">gotb</span><span class="op" id="7190443">,</span>&nbsp;<span class="ident" id="7190445">err</span>&nbsp;<span class="op" id="7190449">:=</span>&nbsp;<span class="ident" id="7190452">DumpResponse</span><span class="op" id="7190464">(</span><span class="ident" id="7190465">tt</span><span class="op" id="7190467">.</span><span class="ident" id="7190468">res</span><span class="op" id="7190471">,</span>&nbsp;<span class="ident" id="7190473">tt</span><span class="op" id="7190475">.</span><span class="ident" id="7190476">body</span><span class="op" id="7190480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7190484">if</span>&nbsp;<span class="ident" id="7190487">err</span>&nbsp;<span class="op" id="7190491">!=</span>&nbsp;<span class="ident" id="7190494">nil</span>&nbsp;<span class="op" id="7190498">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7190503">t</span><span class="op" id="7190504">.</span><span class="ident" id="7190505">Errorf</span><span class="op" id="7190511">(</span><span class="string" id="7190512">&#34;%d.&nbsp;DumpResponse&nbsp;=&nbsp;%v&#34;</span><span class="op" id="7190535">,</span>&nbsp;<span class="ident" id="7190537">i</span><span class="op" id="7190538">,</span>&nbsp;<span class="ident" id="7190540">err</span><span class="op" id="7190543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7190548">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7190559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7190563">got</span>&nbsp;<span class="op" id="7190567">:=</span>&nbsp;<span class="builtintype" id="7190570">string</span><span class="op" id="7190576">(</span><span class="ident" id="7190577">gotb</span><span class="op" id="7190581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7190585">got</span>&nbsp;<span class="op" id="7190589">=</span>&nbsp;<span class="ident" id="7190591">strings</span><span class="op" id="7190598">.</span><span class="ident" id="7190599">TrimSpace</span><span class="op" id="7190608">(</span><span class="ident" id="7190609">got</span><span class="op" id="7190612">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7190616">got</span>&nbsp;<span class="op" id="7190620">=</span>&nbsp;<span class="ident" id="7190622">strings</span><span class="op" id="7190629">.</span><span class="ident" id="7190630">Replace</span><span class="op" id="7190637">(</span><span class="ident" id="7190638">got</span><span class="op" id="7190641">,</span>&nbsp;<span class="string" id="7190643">&#34;\r&#34;</span><span class="op" id="7190647">,</span>&nbsp;<span class="string" id="7190649">&#34;&#34;</span><span class="op" id="7190651">,</span>&nbsp;<span class="op" id="7190653">-</span><span class="num" id="7190654">1</span><span class="op" id="7190655">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7190660">if</span>&nbsp;<span class="ident" id="7190663">got</span>&nbsp;<span class="op" id="7190667">!=</span>&nbsp;<span class="ident" id="7190670">tt</span><span class="op" id="7190672">.</span><span class="ident" id="7190673">want</span>&nbsp;<span class="op" id="7190678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7190683">t</span><span class="op" id="7190684">.</span><span class="ident" id="7190685">Errorf</span><span class="op" id="7190691">(</span><span class="string" id="7190692">&#34;%d.\nDumpResponse&nbsp;got:\n%s\n\nWant:\n%s\n&#34;</span><span class="op" id="7190735">,</span>&nbsp;<span class="ident" id="7190737">i</span><span class="op" id="7190738">,</span>&nbsp;<span class="ident" id="7190740">got</span><span class="op" id="7190743">,</span>&nbsp;<span class="ident" id="7190745">tt</span><span class="op" id="7190747">.</span><span class="ident" id="7190748">want</span><span class="op" id="7190752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7190756">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7190759">}</span><br>
<span class="lineno"></span><span class="op" id="7190761">}</span>
</div>
</body>
</html>
