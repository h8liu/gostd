<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>bufio</h2>
<ul>
<li><a href="/gostd/bufio/bufio.go.html">bufio.go</a></li>
<li><a href="/gostd/bufio/bufio_test.go.html">bufio_test.go</a></li>
<li><a href="/gostd/bufio/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/bufio/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/bufio/scan.go.html" class="current">scan.go</a></li>
<li><a href="/gostd/bufio/scan_test.go.html">scan_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3444658">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3444713">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3444767">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3444818">package</span>&nbsp;<span class="ident" id="3444826">bufio</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3444833">import</span>&nbsp;<span class="op" id="3444840">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3444843">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3444852">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3444862">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3444868">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3444883">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3444886">//&nbsp;Scanner&nbsp;provides&nbsp;a&nbsp;convenient&nbsp;interface&nbsp;for&nbsp;reading&nbsp;data&nbsp;such&nbsp;as</span><br>
<span class="lineno">15</span><span class="comment" id="3444954">//&nbsp;a&nbsp;file&nbsp;of&nbsp;newline-delimited&nbsp;lines&nbsp;of&nbsp;text.&nbsp;Successive&nbsp;calls&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3445020">//&nbsp;the&nbsp;Scan&nbsp;method&nbsp;will&nbsp;step&nbsp;through&nbsp;the&nbsp;&#39;tokens&#39;&nbsp;of&nbsp;a&nbsp;file,&nbsp;skipping</span><br>
<span class="lineno"></span><span class="comment" id="3445090">//&nbsp;the&nbsp;bytes&nbsp;between&nbsp;the&nbsp;tokens.&nbsp;The&nbsp;specification&nbsp;of&nbsp;a&nbsp;token&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3445155">//&nbsp;defined&nbsp;by&nbsp;a&nbsp;split&nbsp;function&nbsp;of&nbsp;type&nbsp;SplitFunc;&nbsp;the&nbsp;default&nbsp;split</span><br>
<span class="lineno"></span><span class="comment" id="3445223">//&nbsp;function&nbsp;breaks&nbsp;the&nbsp;input&nbsp;into&nbsp;lines&nbsp;with&nbsp;line&nbsp;termination&nbsp;stripped.&nbsp;Split</span><br>
<span class="lineno">20</span><span class="comment" id="3445301">//&nbsp;functions&nbsp;are&nbsp;defined&nbsp;in&nbsp;this&nbsp;package&nbsp;for&nbsp;scanning&nbsp;a&nbsp;file&nbsp;into</span><br>
<span class="lineno"></span><span class="comment" id="3445367">//&nbsp;lines,&nbsp;bytes,&nbsp;UTF-8-encoded&nbsp;runes,&nbsp;and&nbsp;space-delimited&nbsp;words.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="3445436">//&nbsp;client&nbsp;may&nbsp;instead&nbsp;provide&nbsp;a&nbsp;custom&nbsp;split&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="3445491">//</span><br>
<span class="lineno"></span><span class="comment" id="3445494">//&nbsp;Scanning&nbsp;stops&nbsp;unrecoverably&nbsp;at&nbsp;EOF,&nbsp;the&nbsp;first&nbsp;I/O&nbsp;error,&nbsp;or&nbsp;a&nbsp;token&nbsp;too</span><br>
<span class="lineno">25</span><span class="comment" id="3445570">//&nbsp;large&nbsp;to&nbsp;fit&nbsp;in&nbsp;the&nbsp;buffer.&nbsp;When&nbsp;a&nbsp;scan&nbsp;stops,&nbsp;the&nbsp;reader&nbsp;may&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="3445640">//&nbsp;advanced&nbsp;arbitrarily&nbsp;far&nbsp;past&nbsp;the&nbsp;last&nbsp;token.&nbsp;Programs&nbsp;that&nbsp;need&nbsp;more</span><br>
<span class="lineno"></span><span class="comment" id="3445713">//&nbsp;control&nbsp;over&nbsp;error&nbsp;handling&nbsp;or&nbsp;large&nbsp;tokens,&nbsp;or&nbsp;must&nbsp;run&nbsp;sequential&nbsp;scans</span><br>
<span class="lineno"></span><span class="comment" id="3445790">//&nbsp;on&nbsp;a&nbsp;reader,&nbsp;should&nbsp;use&nbsp;bufio.Reader&nbsp;instead.</span><br>
<span class="lineno"></span><span class="comment" id="3445839">//</span><br>
<span class="lineno">30</span><span class="keyword" id="3445842">type</span>&nbsp;<span class="ident" id="3445847">Scanner</span>&nbsp;<span class="keyword" id="3445855">struct</span>&nbsp;<span class="op" id="3445862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3445865">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3445878">io</span><span class="op" id="3445880">.</span><span class="ident" id="3445881">Reader</span>&nbsp;<span class="comment" id="3445888">//&nbsp;The&nbsp;reader&nbsp;provided&nbsp;by&nbsp;the&nbsp;client.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3445927">split</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3445940">SplitFunc</span>&nbsp;<span class="comment" id="3445950">//&nbsp;The&nbsp;function&nbsp;to&nbsp;split&nbsp;the&nbsp;tokens.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3445988">maxTokenSize</span>&nbsp;<span class="builtintype" id="3446001">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3446011">//&nbsp;Maximum&nbsp;size&nbsp;of&nbsp;a&nbsp;token;&nbsp;modified&nbsp;by&nbsp;tests.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3446059">token</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3446072">[</span><span class="op" id="3446073">]</span><span class="builtintype" id="3446074">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3446082">//&nbsp;Last&nbsp;token&nbsp;returned&nbsp;by&nbsp;split.</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3446116">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3446129">[</span><span class="op" id="3446130">]</span><span class="builtintype" id="3446131">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3446139">//&nbsp;Buffer&nbsp;used&nbsp;as&nbsp;argument&nbsp;to&nbsp;split.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3446177">start</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3446190">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3446200">//&nbsp;First&nbsp;non-processed&nbsp;byte&nbsp;in&nbsp;buf.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3446237">end</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3446250">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3446260">//&nbsp;End&nbsp;of&nbsp;data&nbsp;in&nbsp;buf.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3446284">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3446297">error</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3446307">//&nbsp;Sticky&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3446325">empties</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3446338">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3446348">//&nbsp;Count&nbsp;of&nbsp;successive&nbsp;empty&nbsp;tokens.</span><br>
<span class="lineno">40</span><span class="op" id="3446385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3446388">//&nbsp;SplitFunc&nbsp;is&nbsp;the&nbsp;signature&nbsp;of&nbsp;the&nbsp;split&nbsp;function&nbsp;used&nbsp;to&nbsp;tokenize&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3446461">//&nbsp;input.&nbsp;The&nbsp;arguments&nbsp;are&nbsp;an&nbsp;initial&nbsp;substring&nbsp;of&nbsp;the&nbsp;remaining&nbsp;unprocessed</span><br>
<span class="lineno"></span><span class="comment" id="3446539">//&nbsp;data&nbsp;and&nbsp;a&nbsp;flag,&nbsp;atEOF,&nbsp;that&nbsp;reports&nbsp;whether&nbsp;the&nbsp;Reader&nbsp;has&nbsp;no&nbsp;more&nbsp;data</span><br>
<span class="lineno">45</span><span class="comment" id="3446615">//&nbsp;to&nbsp;give.&nbsp;The&nbsp;return&nbsp;values&nbsp;are&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;to&nbsp;advance&nbsp;the&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="3446690">//&nbsp;and&nbsp;the&nbsp;next&nbsp;token&nbsp;to&nbsp;return&nbsp;to&nbsp;the&nbsp;user,&nbsp;plus&nbsp;an&nbsp;error,&nbsp;if&nbsp;any.&nbsp;If&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3446765">//&nbsp;data&nbsp;does&nbsp;not&nbsp;yet&nbsp;hold&nbsp;a&nbsp;complete&nbsp;token,&nbsp;for&nbsp;instance&nbsp;if&nbsp;it&nbsp;has&nbsp;no&nbsp;newline</span><br>
<span class="lineno"></span><span class="comment" id="3446843">//&nbsp;while&nbsp;scanning&nbsp;lines,&nbsp;SplitFunc&nbsp;can&nbsp;return&nbsp;(0,&nbsp;nil,&nbsp;nil)&nbsp;to&nbsp;signal&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3446917">//&nbsp;Scanner&nbsp;to&nbsp;read&nbsp;more&nbsp;data&nbsp;into&nbsp;the&nbsp;slice&nbsp;and&nbsp;try&nbsp;again&nbsp;with&nbsp;a&nbsp;longer&nbsp;slice</span><br>
<span class="lineno">50</span><span class="comment" id="3446995">//&nbsp;starting&nbsp;at&nbsp;the&nbsp;same&nbsp;point&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="3447039">//</span><br>
<span class="lineno"></span><span class="comment" id="3447042">//&nbsp;If&nbsp;the&nbsp;returned&nbsp;error&nbsp;is&nbsp;non-nil,&nbsp;scanning&nbsp;stops&nbsp;and&nbsp;the&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="3447108">//&nbsp;is&nbsp;returned&nbsp;to&nbsp;the&nbsp;client.</span><br>
<span class="lineno"></span><span class="comment" id="3447138">//</span><br>
<span class="lineno">55</span><span class="comment" id="3447141">//&nbsp;The&nbsp;function&nbsp;is&nbsp;never&nbsp;called&nbsp;with&nbsp;an&nbsp;empty&nbsp;data&nbsp;slice&nbsp;unless&nbsp;atEOF</span><br>
<span class="lineno"></span><span class="comment" id="3447211">//&nbsp;is&nbsp;true.&nbsp;If&nbsp;atEOF&nbsp;is&nbsp;true,&nbsp;however,&nbsp;data&nbsp;may&nbsp;be&nbsp;non-empty&nbsp;and,</span><br>
<span class="lineno"></span><span class="comment" id="3447277">//&nbsp;as&nbsp;always,&nbsp;holds&nbsp;unprocessed&nbsp;text.</span><br>
<span class="lineno"></span><span class="keyword" id="3447315">type</span>&nbsp;<span class="ident" id="3447320">SplitFunc</span>&nbsp;<span class="keyword" id="3447330">func</span><span class="op" id="3447334">(</span><span class="ident" id="3447335">data</span>&nbsp;<span class="op" id="3447340">[</span><span class="op" id="3447341">]</span><span class="builtintype" id="3447342">byte</span><span class="op" id="3447346">,</span>&nbsp;<span class="ident" id="3447348">atEOF</span>&nbsp;<span class="builtintype" id="3447354">bool</span><span class="op" id="3447358">)</span>&nbsp;<span class="op" id="3447360">(</span><span class="ident" id="3447361">advance</span>&nbsp;<span class="builtintype" id="3447369">int</span><span class="op" id="3447372">,</span>&nbsp;<span class="ident" id="3447374">token</span>&nbsp;<span class="op" id="3447380">[</span><span class="op" id="3447381">]</span><span class="builtintype" id="3447382">byte</span><span class="op" id="3447386">,</span>&nbsp;<span class="ident" id="3447388">err</span>&nbsp;<span class="builtintype" id="3447392">error</span><span class="op" id="3447397">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="3447400">//&nbsp;Errors&nbsp;returned&nbsp;by&nbsp;Scanner.</span><br>
<span class="lineno"></span><span class="keyword" id="3447431">var</span>&nbsp;<span class="op" id="3447435">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3447438">ErrTooLong</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3447457">=</span>&nbsp;<span class="ident" id="3447459">errors</span><span class="op" id="3447465">.</span><span class="ident" id="3447466">New</span><span class="op" id="3447469">(</span><span class="string" id="3447470">&#34;bufio.Scanner:&nbsp;token&nbsp;too&nbsp;long&#34;</span><span class="op" id="3447501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3447504">ErrNegativeAdvance</span>&nbsp;<span class="op" id="3447523">=</span>&nbsp;<span class="ident" id="3447525">errors</span><span class="op" id="3447531">.</span><span class="ident" id="3447532">New</span><span class="op" id="3447535">(</span><span class="string" id="3447536">&#34;bufio.Scanner:&nbsp;SplitFunc&nbsp;returns&nbsp;negative&nbsp;advance&nbsp;count&#34;</span><span class="op" id="3447593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3447596">ErrAdvanceTooFar</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3447615">=</span>&nbsp;<span class="ident" id="3447617">errors</span><span class="op" id="3447623">.</span><span class="ident" id="3447624">New</span><span class="op" id="3447627">(</span><span class="string" id="3447628">&#34;bufio.Scanner:&nbsp;SplitFunc&nbsp;returns&nbsp;advance&nbsp;count&nbsp;beyond&nbsp;input&#34;</span><span class="op" id="3447689">)</span><br>
<span class="lineno">65</span><span class="op" id="3447691">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3447694">const</span>&nbsp;<span class="op" id="3447700">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3447703">//&nbsp;MaxScanTokenSize&nbsp;is&nbsp;the&nbsp;maximum&nbsp;size&nbsp;used&nbsp;to&nbsp;buffer&nbsp;a&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3447768">//&nbsp;The&nbsp;actual&nbsp;maximum&nbsp;token&nbsp;size&nbsp;may&nbsp;be&nbsp;smaller&nbsp;as&nbsp;the&nbsp;buffer</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3447831">//&nbsp;may&nbsp;need&nbsp;to&nbsp;include,&nbsp;for&nbsp;instance,&nbsp;a&nbsp;newline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3447881">MaxScanTokenSize</span>&nbsp;<span class="op" id="3447898">=</span>&nbsp;<span class="num" id="3447900">64</span>&nbsp;<span class="op" id="3447903">*</span>&nbsp;<span class="num" id="3447905">1024</span><br>
<span class="lineno"></span><span class="op" id="3447910">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3447913">//&nbsp;NewScanner&nbsp;returns&nbsp;a&nbsp;new&nbsp;Scanner&nbsp;to&nbsp;read&nbsp;from&nbsp;r.</span><br>
<span class="lineno">75</span><span class="comment" id="3447965">//&nbsp;The&nbsp;split&nbsp;function&nbsp;defaults&nbsp;to&nbsp;ScanLines.</span><br>
<span class="lineno"></span><span class="keyword" id="3448010">func</span>&nbsp;<span class="ident" id="3448015">NewScanner</span><span class="op" id="3448025">(</span><span class="ident" id="3448026">r</span>&nbsp;<span class="ident" id="3448028">io</span><span class="op" id="3448030">.</span><span class="ident" id="3448031">Reader</span><span class="op" id="3448037">)</span>&nbsp;<span class="op" id="3448039">*</span><span class="ident" id="3448040">Scanner</span>&nbsp;<span class="op" id="3448048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3448051">return</span>&nbsp;<span class="op" id="3448058">&amp;</span><span class="ident" id="3448059">Scanner</span><span class="op" id="3448066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3448070">r</span><span class="op" id="3448071">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3448084">r</span><span class="op" id="3448085">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3448089">split</span><span class="op" id="3448094">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3448103">ScanLines</span><span class="op" id="3448112">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3448116">maxTokenSize</span><span class="op" id="3448128">:</span>&nbsp;<span class="ident" id="3448130">MaxScanTokenSize</span><span class="op" id="3448146">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3448150">buf</span><span class="op" id="3448153">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3448164">make</span><span class="op" id="3448168">(</span><span class="op" id="3448169">[</span><span class="op" id="3448170">]</span><span class="builtintype" id="3448171">byte</span><span class="op" id="3448175">,</span>&nbsp;<span class="num" id="3448177">4096</span><span class="op" id="3448181">)</span><span class="op" id="3448182">,</span>&nbsp;<span class="comment" id="3448184">//&nbsp;Plausible&nbsp;starting&nbsp;size;&nbsp;needn&#39;t&nbsp;be&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3448231">}</span><br>
<span class="lineno"></span><span class="op" id="3448233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="3448236">//&nbsp;Err&nbsp;returns&nbsp;the&nbsp;first&nbsp;non-EOF&nbsp;error&nbsp;that&nbsp;was&nbsp;encountered&nbsp;by&nbsp;the&nbsp;Scanner.</span><br>
<span class="lineno"></span><span class="keyword" id="3448312">func</span>&nbsp;<span class="op" id="3448317">(</span><span class="ident" id="3448318">s</span>&nbsp;<span class="op" id="3448320">*</span><span class="ident" id="3448321">Scanner</span><span class="op" id="3448328">)</span>&nbsp;<span class="ident" id="3448330">Err</span><span class="op" id="3448333">(</span><span class="op" id="3448334">)</span>&nbsp;<span class="builtintype" id="3448336">error</span>&nbsp;<span class="op" id="3448342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3448345">if</span>&nbsp;<span class="ident" id="3448348">s</span><span class="op" id="3448349">.</span><span class="ident" id="3448350">err</span>&nbsp;<span class="op" id="3448354">==</span>&nbsp;<span class="ident" id="3448357">io</span><span class="op" id="3448359">.</span><span class="ident" id="3448360">EOF</span>&nbsp;<span class="op" id="3448364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3448368">return</span>&nbsp;<span class="ident" id="3448375">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3448380">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3448383">return</span>&nbsp;<span class="ident" id="3448390">s</span><span class="op" id="3448391">.</span><span class="ident" id="3448392">err</span><br>
<span class="lineno"></span><span class="op" id="3448396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3448399">//&nbsp;Bytes&nbsp;returns&nbsp;the&nbsp;most&nbsp;recent&nbsp;token&nbsp;generated&nbsp;by&nbsp;a&nbsp;call&nbsp;to&nbsp;Scan.</span><br>
<span class="lineno"></span><span class="comment" id="3448467">//&nbsp;The&nbsp;underlying&nbsp;array&nbsp;may&nbsp;point&nbsp;to&nbsp;data&nbsp;that&nbsp;will&nbsp;be&nbsp;overwritten</span><br>
<span class="lineno">95</span><span class="comment" id="3448534">//&nbsp;by&nbsp;a&nbsp;subsequent&nbsp;call&nbsp;to&nbsp;Scan.&nbsp;It&nbsp;does&nbsp;no&nbsp;allocation.</span><br>
<span class="lineno"></span><span class="keyword" id="3448590">func</span>&nbsp;<span class="op" id="3448595">(</span><span class="ident" id="3448596">s</span>&nbsp;<span class="op" id="3448598">*</span><span class="ident" id="3448599">Scanner</span><span class="op" id="3448606">)</span>&nbsp;<span class="ident" id="3448608">Bytes</span><span class="op" id="3448613">(</span><span class="op" id="3448614">)</span>&nbsp;<span class="op" id="3448616">[</span><span class="op" id="3448617">]</span><span class="builtintype" id="3448618">byte</span>&nbsp;<span class="op" id="3448623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3448626">return</span>&nbsp;<span class="ident" id="3448633">s</span><span class="op" id="3448634">.</span><span class="ident" id="3448635">token</span><br>
<span class="lineno"></span><span class="op" id="3448641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="3448644">//&nbsp;Text&nbsp;returns&nbsp;the&nbsp;most&nbsp;recent&nbsp;token&nbsp;generated&nbsp;by&nbsp;a&nbsp;call&nbsp;to&nbsp;Scan</span><br>
<span class="lineno"></span><span class="comment" id="3448710">//&nbsp;as&nbsp;a&nbsp;newly&nbsp;allocated&nbsp;string&nbsp;holding&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="3448760">func</span>&nbsp;<span class="op" id="3448765">(</span><span class="ident" id="3448766">s</span>&nbsp;<span class="op" id="3448768">*</span><span class="ident" id="3448769">Scanner</span><span class="op" id="3448776">)</span>&nbsp;<span class="ident" id="3448778">Text</span><span class="op" id="3448782">(</span><span class="op" id="3448783">)</span>&nbsp;<span class="builtintype" id="3448785">string</span>&nbsp;<span class="op" id="3448792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3448795">return</span>&nbsp;<span class="builtintype" id="3448802">string</span><span class="op" id="3448808">(</span><span class="ident" id="3448809">s</span><span class="op" id="3448810">.</span><span class="ident" id="3448811">token</span><span class="op" id="3448816">)</span><br>
<span class="lineno"></span><span class="op" id="3448818">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="3448821">//&nbsp;Scan&nbsp;advances&nbsp;the&nbsp;Scanner&nbsp;to&nbsp;the&nbsp;next&nbsp;token,&nbsp;which&nbsp;will&nbsp;then&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="3448888">//&nbsp;available&nbsp;through&nbsp;the&nbsp;Bytes&nbsp;or&nbsp;Text&nbsp;method.&nbsp;It&nbsp;returns&nbsp;false&nbsp;when&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3448961">//&nbsp;scan&nbsp;stops,&nbsp;either&nbsp;by&nbsp;reaching&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;input&nbsp;or&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3449029">//&nbsp;After&nbsp;Scan&nbsp;returns&nbsp;false,&nbsp;the&nbsp;Err&nbsp;method&nbsp;will&nbsp;return&nbsp;any&nbsp;error&nbsp;that</span><br>
<span class="lineno">110</span><span class="comment" id="3449100">//&nbsp;occurred&nbsp;during&nbsp;scanning,&nbsp;except&nbsp;that&nbsp;if&nbsp;it&nbsp;was&nbsp;io.EOF,&nbsp;Err</span><br>
<span class="lineno"></span><span class="comment" id="3449163">//&nbsp;will&nbsp;return&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="3449183">//&nbsp;Split&nbsp;panics&nbsp;if&nbsp;the&nbsp;split&nbsp;function&nbsp;returns&nbsp;100&nbsp;empty&nbsp;tokens&nbsp;without</span><br>
<span class="lineno"></span><span class="comment" id="3449254">//&nbsp;advancing&nbsp;the&nbsp;input.&nbsp;This&nbsp;is&nbsp;a&nbsp;common&nbsp;error&nbsp;mode&nbsp;for&nbsp;scanners.</span><br>
<span class="lineno"></span><span class="keyword" id="3449320">func</span>&nbsp;<span class="op" id="3449325">(</span><span class="ident" id="3449326">s</span>&nbsp;<span class="op" id="3449328">*</span><span class="ident" id="3449329">Scanner</span><span class="op" id="3449336">)</span>&nbsp;<span class="ident" id="3449338">Scan</span><span class="op" id="3449342">(</span><span class="op" id="3449343">)</span>&nbsp;<span class="builtintype" id="3449345">bool</span>&nbsp;<span class="op" id="3449350">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3449353">//&nbsp;Loop&nbsp;until&nbsp;we&nbsp;have&nbsp;a&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3449385">for</span>&nbsp;<span class="op" id="3449389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3449393">//&nbsp;See&nbsp;if&nbsp;we&nbsp;can&nbsp;get&nbsp;a&nbsp;token&nbsp;with&nbsp;what&nbsp;we&nbsp;already&nbsp;have.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3449451">//&nbsp;If&nbsp;we&#39;ve&nbsp;run&nbsp;out&nbsp;of&nbsp;data&nbsp;but&nbsp;have&nbsp;an&nbsp;error,&nbsp;give&nbsp;the&nbsp;split&nbsp;function</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3449524">//&nbsp;a&nbsp;chance&nbsp;to&nbsp;recover&nbsp;any&nbsp;remaining,&nbsp;possibly&nbsp;empty&nbsp;token.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3449586">if</span>&nbsp;<span class="ident" id="3449589">s</span><span class="op" id="3449590">.</span><span class="ident" id="3449591">end</span>&nbsp;<span class="op" id="3449595">&gt;</span>&nbsp;<span class="ident" id="3449597">s</span><span class="op" id="3449598">.</span><span class="ident" id="3449599">start</span>&nbsp;<span class="op" id="3449605">||</span>&nbsp;<span class="ident" id="3449608">s</span><span class="op" id="3449609">.</span><span class="ident" id="3449610">err</span>&nbsp;<span class="op" id="3449614">!=</span>&nbsp;<span class="ident" id="3449617">nil</span>&nbsp;<span class="op" id="3449621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3449626">advance</span><span class="op" id="3449633">,</span>&nbsp;<span class="ident" id="3449635">token</span><span class="op" id="3449640">,</span>&nbsp;<span class="ident" id="3449642">err</span>&nbsp;<span class="op" id="3449646">:=</span>&nbsp;<span class="ident" id="3449649">s</span><span class="op" id="3449650">.</span><span class="ident" id="3449651">split</span><span class="op" id="3449656">(</span><span class="ident" id="3449657">s</span><span class="op" id="3449658">.</span><span class="ident" id="3449659">buf</span><span class="op" id="3449662">[</span><span class="ident" id="3449663">s</span><span class="op" id="3449664">.</span><span class="ident" id="3449665">start</span><span class="op" id="3449670">:</span><span class="ident" id="3449671">s</span><span class="op" id="3449672">.</span><span class="ident" id="3449673">end</span><span class="op" id="3449676">]</span><span class="op" id="3449677">,</span>&nbsp;<span class="ident" id="3449679">s</span><span class="op" id="3449680">.</span><span class="ident" id="3449681">err</span>&nbsp;<span class="op" id="3449685">!=</span>&nbsp;<span class="ident" id="3449688">nil</span><span class="op" id="3449691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3449696">if</span>&nbsp;<span class="ident" id="3449699">err</span>&nbsp;<span class="op" id="3449703">!=</span>&nbsp;<span class="ident" id="3449706">nil</span>&nbsp;<span class="op" id="3449710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3449716">s</span><span class="op" id="3449717">.</span><span class="ident" id="3449718">setErr</span><span class="op" id="3449724">(</span><span class="ident" id="3449725">err</span><span class="op" id="3449728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3449734">return</span>&nbsp;<span class="builtintype" id="3449741">false</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3449750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3449755">if</span>&nbsp;<span class="op" id="3449758">!</span><span class="ident" id="3449759">s</span><span class="op" id="3449760">.</span><span class="ident" id="3449761">advance</span><span class="op" id="3449768">(</span><span class="ident" id="3449769">advance</span><span class="op" id="3449776">)</span>&nbsp;<span class="op" id="3449778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3449784">return</span>&nbsp;<span class="builtintype" id="3449791">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3449800">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3449805">s</span><span class="op" id="3449806">.</span><span class="ident" id="3449807">token</span>&nbsp;<span class="op" id="3449813">=</span>&nbsp;<span class="ident" id="3449815">token</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3449824">if</span>&nbsp;<span class="ident" id="3449827">token</span>&nbsp;<span class="op" id="3449833">!=</span>&nbsp;<span class="ident" id="3449836">nil</span>&nbsp;<span class="op" id="3449840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3449846">if</span>&nbsp;<span class="ident" id="3449849">s</span><span class="op" id="3449850">.</span><span class="ident" id="3449851">err</span>&nbsp;<span class="op" id="3449855">==</span>&nbsp;<span class="ident" id="3449858">nil</span>&nbsp;<span class="op" id="3449862">||</span>&nbsp;<span class="ident" id="3449865">advance</span>&nbsp;<span class="op" id="3449873">&gt;</span>&nbsp;<span class="num" id="3449875">0</span>&nbsp;<span class="op" id="3449877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3449884">s</span><span class="op" id="3449885">.</span><span class="ident" id="3449886">empties</span>&nbsp;<span class="op" id="3449894">=</span>&nbsp;<span class="num" id="3449896">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3449902">}</span>&nbsp;<span class="keyword" id="3449904">else</span>&nbsp;<span class="op" id="3449909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3449916">//&nbsp;Returning&nbsp;tokens&nbsp;not&nbsp;advancing&nbsp;input&nbsp;at&nbsp;EOF.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3449969">s</span><span class="op" id="3449970">.</span><span class="ident" id="3449971">empties</span><span class="op" id="3449978">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3449986">if</span>&nbsp;<span class="ident" id="3449989">s</span><span class="op" id="3449990">.</span><span class="ident" id="3449991">empties</span>&nbsp;<span class="op" id="3449999">&gt;</span>&nbsp;<span class="num" id="3450001">100</span>&nbsp;<span class="op" id="3450005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3450013">panic</span><span class="op" id="3450018">(</span><span class="string" id="3450019">&#34;bufio.Scan:&nbsp;100&nbsp;empty&nbsp;tokens&nbsp;without&nbsp;progressing&#34;</span><span class="op" id="3450069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3450076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3450082">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3450088">return</span>&nbsp;<span class="builtintype" id="3450095">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3450103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3450107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3450111">//&nbsp;We&nbsp;cannot&nbsp;generate&nbsp;a&nbsp;token&nbsp;with&nbsp;what&nbsp;we&nbsp;are&nbsp;holding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3450169">//&nbsp;If&nbsp;we&#39;ve&nbsp;already&nbsp;hit&nbsp;EOF&nbsp;or&nbsp;an&nbsp;I/O&nbsp;error,&nbsp;we&nbsp;are&nbsp;done.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3450229">if</span>&nbsp;<span class="ident" id="3450232">s</span><span class="op" id="3450233">.</span><span class="ident" id="3450234">err</span>&nbsp;<span class="op" id="3450238">!=</span>&nbsp;<span class="ident" id="3450241">nil</span>&nbsp;<span class="op" id="3450245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3450250">//&nbsp;Shut&nbsp;it&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3450270">s</span><span class="op" id="3450271">.</span><span class="ident" id="3450272">start</span>&nbsp;<span class="op" id="3450278">=</span>&nbsp;<span class="num" id="3450280">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3450285">s</span><span class="op" id="3450286">.</span><span class="ident" id="3450287">end</span>&nbsp;<span class="op" id="3450291">=</span>&nbsp;<span class="num" id="3450293">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3450298">return</span>&nbsp;<span class="builtintype" id="3450305">false</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3450313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3450317">//&nbsp;Must&nbsp;read&nbsp;more&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3450343">//&nbsp;First,&nbsp;shift&nbsp;data&nbsp;to&nbsp;beginning&nbsp;of&nbsp;buffer&nbsp;if&nbsp;there&#39;s&nbsp;lots&nbsp;of&nbsp;empty&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3450420">//&nbsp;or&nbsp;space&nbsp;is&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3450445">if</span>&nbsp;<span class="ident" id="3450448">s</span><span class="op" id="3450449">.</span><span class="ident" id="3450450">start</span>&nbsp;<span class="op" id="3450456">&gt;</span>&nbsp;<span class="num" id="3450458">0</span>&nbsp;<span class="op" id="3450460">&amp;&amp;</span>&nbsp;<span class="op" id="3450463">(</span><span class="ident" id="3450464">s</span><span class="op" id="3450465">.</span><span class="ident" id="3450466">end</span>&nbsp;<span class="op" id="3450470">==</span>&nbsp;<span class="builtinfunc" id="3450473">len</span><span class="op" id="3450476">(</span><span class="ident" id="3450477">s</span><span class="op" id="3450478">.</span><span class="ident" id="3450479">buf</span><span class="op" id="3450482">)</span>&nbsp;<span class="op" id="3450484">||</span>&nbsp;<span class="ident" id="3450487">s</span><span class="op" id="3450488">.</span><span class="ident" id="3450489">start</span>&nbsp;<span class="op" id="3450495">&gt;</span>&nbsp;<span class="builtinfunc" id="3450497">len</span><span class="op" id="3450500">(</span><span class="ident" id="3450501">s</span><span class="op" id="3450502">.</span><span class="ident" id="3450503">buf</span><span class="op" id="3450506">)</span><span class="op" id="3450507">/</span><span class="num" id="3450508">2</span><span class="op" id="3450509">)</span>&nbsp;<span class="op" id="3450511">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3450516">copy</span><span class="op" id="3450520">(</span><span class="ident" id="3450521">s</span><span class="op" id="3450522">.</span><span class="ident" id="3450523">buf</span><span class="op" id="3450526">,</span>&nbsp;<span class="ident" id="3450528">s</span><span class="op" id="3450529">.</span><span class="ident" id="3450530">buf</span><span class="op" id="3450533">[</span><span class="ident" id="3450534">s</span><span class="op" id="3450535">.</span><span class="ident" id="3450536">start</span><span class="op" id="3450541">:</span><span class="ident" id="3450542">s</span><span class="op" id="3450543">.</span><span class="ident" id="3450544">end</span><span class="op" id="3450547">]</span><span class="op" id="3450548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3450553">s</span><span class="op" id="3450554">.</span><span class="ident" id="3450555">end</span>&nbsp;<span class="op" id="3450559">-=</span>&nbsp;<span class="ident" id="3450562">s</span><span class="op" id="3450563">.</span><span class="ident" id="3450564">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3450573">s</span><span class="op" id="3450574">.</span><span class="ident" id="3450575">start</span>&nbsp;<span class="op" id="3450581">=</span>&nbsp;<span class="num" id="3450583">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3450587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3450591">//&nbsp;Is&nbsp;the&nbsp;buffer&nbsp;full?&nbsp;If&nbsp;so,&nbsp;resize.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3450631">if</span>&nbsp;<span class="ident" id="3450634">s</span><span class="op" id="3450635">.</span><span class="ident" id="3450636">end</span>&nbsp;<span class="op" id="3450640">==</span>&nbsp;<span class="builtinfunc" id="3450643">len</span><span class="op" id="3450646">(</span><span class="ident" id="3450647">s</span><span class="op" id="3450648">.</span><span class="ident" id="3450649">buf</span><span class="op" id="3450652">)</span>&nbsp;<span class="op" id="3450654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3450659">if</span>&nbsp;<span class="builtinfunc" id="3450662">len</span><span class="op" id="3450665">(</span><span class="ident" id="3450666">s</span><span class="op" id="3450667">.</span><span class="ident" id="3450668">buf</span><span class="op" id="3450671">)</span>&nbsp;<span class="op" id="3450673">&gt;=</span>&nbsp;<span class="ident" id="3450676">s</span><span class="op" id="3450677">.</span><span class="ident" id="3450678">maxTokenSize</span>&nbsp;<span class="op" id="3450691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3450697">s</span><span class="op" id="3450698">.</span><span class="ident" id="3450699">setErr</span><span class="op" id="3450705">(</span><span class="ident" id="3450706">ErrTooLong</span><span class="op" id="3450716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3450722">return</span>&nbsp;<span class="builtintype" id="3450729">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3450738">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3450743">newSize</span>&nbsp;<span class="op" id="3450751">:=</span>&nbsp;<span class="builtinfunc" id="3450754">len</span><span class="op" id="3450757">(</span><span class="ident" id="3450758">s</span><span class="op" id="3450759">.</span><span class="ident" id="3450760">buf</span><span class="op" id="3450763">)</span>&nbsp;<span class="op" id="3450765">*</span>&nbsp;<span class="num" id="3450767">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3450772">if</span>&nbsp;<span class="ident" id="3450775">newSize</span>&nbsp;<span class="op" id="3450783">&gt;</span>&nbsp;<span class="ident" id="3450785">s</span><span class="op" id="3450786">.</span><span class="ident" id="3450787">maxTokenSize</span>&nbsp;<span class="op" id="3450800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3450806">newSize</span>&nbsp;<span class="op" id="3450814">=</span>&nbsp;<span class="ident" id="3450816">s</span><span class="op" id="3450817">.</span><span class="ident" id="3450818">maxTokenSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3450834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3450839">newBuf</span>&nbsp;<span class="op" id="3450846">:=</span>&nbsp;<span class="builtinfunc" id="3450849">make</span><span class="op" id="3450853">(</span><span class="op" id="3450854">[</span><span class="op" id="3450855">]</span><span class="builtintype" id="3450856">byte</span><span class="op" id="3450860">,</span>&nbsp;<span class="ident" id="3450862">newSize</span><span class="op" id="3450869">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3450874">copy</span><span class="op" id="3450878">(</span><span class="ident" id="3450879">newBuf</span><span class="op" id="3450885">,</span>&nbsp;<span class="ident" id="3450887">s</span><span class="op" id="3450888">.</span><span class="ident" id="3450889">buf</span><span class="op" id="3450892">[</span><span class="ident" id="3450893">s</span><span class="op" id="3450894">.</span><span class="ident" id="3450895">start</span><span class="op" id="3450900">:</span><span class="ident" id="3450901">s</span><span class="op" id="3450902">.</span><span class="ident" id="3450903">end</span><span class="op" id="3450906">]</span><span class="op" id="3450907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3450912">s</span><span class="op" id="3450913">.</span><span class="ident" id="3450914">buf</span>&nbsp;<span class="op" id="3450918">=</span>&nbsp;<span class="ident" id="3450920">newBuf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3450930">s</span><span class="op" id="3450931">.</span><span class="ident" id="3450932">end</span>&nbsp;<span class="op" id="3450936">-=</span>&nbsp;<span class="ident" id="3450939">s</span><span class="op" id="3450940">.</span><span class="ident" id="3450941">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3450950">s</span><span class="op" id="3450951">.</span><span class="ident" id="3450952">start</span>&nbsp;<span class="op" id="3450958">=</span>&nbsp;<span class="num" id="3450960">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3450965">continue</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3450976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3450980">//&nbsp;Finally&nbsp;we&nbsp;can&nbsp;read&nbsp;some&nbsp;input.&nbsp;Make&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;get&nbsp;stuck&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3451051">//&nbsp;a&nbsp;misbehaving&nbsp;Reader.&nbsp;Officially&nbsp;we&nbsp;don&#39;t&nbsp;need&nbsp;to&nbsp;do&nbsp;this,&nbsp;but&nbsp;let&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3451125">//&nbsp;be&nbsp;extra&nbsp;careful:&nbsp;Scanner&nbsp;is&nbsp;for&nbsp;safe,&nbsp;simple&nbsp;jobs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3451182">for</span>&nbsp;<span class="ident" id="3451186">loop</span>&nbsp;<span class="op" id="3451191">:=</span>&nbsp;<span class="num" id="3451194">0</span><span class="op" id="3451195">;</span>&nbsp;<span class="op" id="3451197">;</span>&nbsp;<span class="op" id="3451199">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3451204">n</span><span class="op" id="3451205">,</span>&nbsp;<span class="ident" id="3451207">err</span>&nbsp;<span class="op" id="3451211">:=</span>&nbsp;<span class="ident" id="3451214">s</span><span class="op" id="3451215">.</span><span class="ident" id="3451216">r</span><span class="op" id="3451217">.</span><span class="ident" id="3451218">Read</span><span class="op" id="3451222">(</span><span class="ident" id="3451223">s</span><span class="op" id="3451224">.</span><span class="ident" id="3451225">buf</span><span class="op" id="3451228">[</span><span class="ident" id="3451229">s</span><span class="op" id="3451230">.</span><span class="ident" id="3451231">end</span><span class="op" id="3451234">:</span><span class="builtinfunc" id="3451235">len</span><span class="op" id="3451238">(</span><span class="ident" id="3451239">s</span><span class="op" id="3451240">.</span><span class="ident" id="3451241">buf</span><span class="op" id="3451244">)</span><span class="op" id="3451245">]</span><span class="op" id="3451246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3451251">s</span><span class="op" id="3451252">.</span><span class="ident" id="3451253">end</span>&nbsp;<span class="op" id="3451257">+=</span>&nbsp;<span class="ident" id="3451260">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3451265">if</span>&nbsp;<span class="ident" id="3451268">err</span>&nbsp;<span class="op" id="3451272">!=</span>&nbsp;<span class="ident" id="3451275">nil</span>&nbsp;<span class="op" id="3451279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3451285">s</span><span class="op" id="3451286">.</span><span class="ident" id="3451287">setErr</span><span class="op" id="3451293">(</span><span class="ident" id="3451294">err</span><span class="op" id="3451297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3451303">break</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3451312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3451317">if</span>&nbsp;<span class="ident" id="3451320">n</span>&nbsp;<span class="op" id="3451322">&gt;</span>&nbsp;<span class="num" id="3451324">0</span>&nbsp;<span class="op" id="3451326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3451332">s</span><span class="op" id="3451333">.</span><span class="ident" id="3451334">empties</span>&nbsp;<span class="op" id="3451342">=</span>&nbsp;<span class="num" id="3451344">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3451350">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3451359">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3451364">loop</span><span class="op" id="3451368">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3451374">if</span>&nbsp;<span class="ident" id="3451377">loop</span>&nbsp;<span class="op" id="3451382">&gt;</span>&nbsp;<span class="ident" id="3451384">maxConsecutiveEmptyReads</span>&nbsp;<span class="op" id="3451409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3451415">s</span><span class="op" id="3451416">.</span><span class="ident" id="3451417">setErr</span><span class="op" id="3451423">(</span><span class="ident" id="3451424">io</span><span class="op" id="3451426">.</span><span class="ident" id="3451427">ErrNoProgress</span><span class="op" id="3451440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3451446">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3451455">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3451459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3451462">}</span><br>
<span class="lineno"></span><span class="op" id="3451464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3451467">//&nbsp;advance&nbsp;consumes&nbsp;n&nbsp;bytes&nbsp;of&nbsp;the&nbsp;buffer.&nbsp;It&nbsp;reports&nbsp;whether&nbsp;the&nbsp;advance&nbsp;was&nbsp;legal.</span><br>
<span class="lineno">200</span><span class="keyword" id="3451552">func</span>&nbsp;<span class="op" id="3451557">(</span><span class="ident" id="3451558">s</span>&nbsp;<span class="op" id="3451560">*</span><span class="ident" id="3451561">Scanner</span><span class="op" id="3451568">)</span>&nbsp;<span class="ident" id="3451570">advance</span><span class="op" id="3451577">(</span><span class="ident" id="3451578">n</span>&nbsp;<span class="builtintype" id="3451580">int</span><span class="op" id="3451583">)</span>&nbsp;<span class="builtintype" id="3451585">bool</span>&nbsp;<span class="op" id="3451590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3451593">if</span>&nbsp;<span class="ident" id="3451596">n</span>&nbsp;<span class="op" id="3451598">&lt;</span>&nbsp;<span class="num" id="3451600">0</span>&nbsp;<span class="op" id="3451602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3451606">s</span><span class="op" id="3451607">.</span><span class="ident" id="3451608">setErr</span><span class="op" id="3451614">(</span><span class="ident" id="3451615">ErrNegativeAdvance</span><span class="op" id="3451633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3451637">return</span>&nbsp;<span class="builtintype" id="3451644">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3451651">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3451654">if</span>&nbsp;<span class="ident" id="3451657">n</span>&nbsp;<span class="op" id="3451659">&gt;</span>&nbsp;<span class="ident" id="3451661">s</span><span class="op" id="3451662">.</span><span class="ident" id="3451663">end</span><span class="op" id="3451666">-</span><span class="ident" id="3451667">s</span><span class="op" id="3451668">.</span><span class="ident" id="3451669">start</span>&nbsp;<span class="op" id="3451675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3451679">s</span><span class="op" id="3451680">.</span><span class="ident" id="3451681">setErr</span><span class="op" id="3451687">(</span><span class="ident" id="3451688">ErrAdvanceTooFar</span><span class="op" id="3451704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3451708">return</span>&nbsp;<span class="builtintype" id="3451715">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3451722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3451725">s</span><span class="op" id="3451726">.</span><span class="ident" id="3451727">start</span>&nbsp;<span class="op" id="3451733">+=</span>&nbsp;<span class="ident" id="3451736">n</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3451739">return</span>&nbsp;<span class="builtintype" id="3451746">true</span><br>
<span class="lineno"></span><span class="op" id="3451751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3451754">//&nbsp;setErr&nbsp;records&nbsp;the&nbsp;first&nbsp;error&nbsp;encountered.</span><br>
<span class="lineno"></span><span class="keyword" id="3451801">func</span>&nbsp;<span class="op" id="3451806">(</span><span class="ident" id="3451807">s</span>&nbsp;<span class="op" id="3451809">*</span><span class="ident" id="3451810">Scanner</span><span class="op" id="3451817">)</span>&nbsp;<span class="ident" id="3451819">setErr</span><span class="op" id="3451825">(</span><span class="ident" id="3451826">err</span>&nbsp;<span class="builtintype" id="3451830">error</span><span class="op" id="3451835">)</span>&nbsp;<span class="op" id="3451837">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3451840">if</span>&nbsp;<span class="ident" id="3451843">s</span><span class="op" id="3451844">.</span><span class="ident" id="3451845">err</span>&nbsp;<span class="op" id="3451849">==</span>&nbsp;<span class="ident" id="3451852">nil</span>&nbsp;<span class="op" id="3451856">||</span>&nbsp;<span class="ident" id="3451859">s</span><span class="op" id="3451860">.</span><span class="ident" id="3451861">err</span>&nbsp;<span class="op" id="3451865">==</span>&nbsp;<span class="ident" id="3451868">io</span><span class="op" id="3451870">.</span><span class="ident" id="3451871">EOF</span>&nbsp;<span class="op" id="3451875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3451879">s</span><span class="op" id="3451880">.</span><span class="ident" id="3451881">err</span>&nbsp;<span class="op" id="3451885">=</span>&nbsp;<span class="ident" id="3451887">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3451892">}</span><br>
<span class="lineno"></span><span class="op" id="3451894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="3451897">//&nbsp;Split&nbsp;sets&nbsp;the&nbsp;split&nbsp;function&nbsp;for&nbsp;the&nbsp;Scanner.&nbsp;If&nbsp;called,&nbsp;it&nbsp;must&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="3451969">//&nbsp;called&nbsp;before&nbsp;Scan.&nbsp;The&nbsp;default&nbsp;split&nbsp;function&nbsp;is&nbsp;ScanLines.</span><br>
<span class="lineno"></span><span class="keyword" id="3452033">func</span>&nbsp;<span class="op" id="3452038">(</span><span class="ident" id="3452039">s</span>&nbsp;<span class="op" id="3452041">*</span><span class="ident" id="3452042">Scanner</span><span class="op" id="3452049">)</span>&nbsp;<span class="ident" id="3452051">Split</span><span class="op" id="3452056">(</span><span class="ident" id="3452057">split</span>&nbsp;<span class="ident" id="3452063">SplitFunc</span><span class="op" id="3452072">)</span>&nbsp;<span class="op" id="3452074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3452077">s</span><span class="op" id="3452078">.</span><span class="ident" id="3452079">split</span>&nbsp;<span class="op" id="3452085">=</span>&nbsp;<span class="ident" id="3452087">split</span><br>
<span class="lineno"></span><span class="op" id="3452093">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="3452096">//&nbsp;Split&nbsp;functions</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3452116">//&nbsp;ScanBytes&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each&nbsp;byte&nbsp;as&nbsp;a&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="3452198">func</span>&nbsp;<span class="ident" id="3452203">ScanBytes</span><span class="op" id="3452212">(</span><span class="ident" id="3452213">data</span>&nbsp;<span class="op" id="3452218">[</span><span class="op" id="3452219">]</span><span class="builtintype" id="3452220">byte</span><span class="op" id="3452224">,</span>&nbsp;<span class="ident" id="3452226">atEOF</span>&nbsp;<span class="builtintype" id="3452232">bool</span><span class="op" id="3452236">)</span>&nbsp;<span class="op" id="3452238">(</span><span class="ident" id="3452239">advance</span>&nbsp;<span class="builtintype" id="3452247">int</span><span class="op" id="3452250">,</span>&nbsp;<span class="ident" id="3452252">token</span>&nbsp;<span class="op" id="3452258">[</span><span class="op" id="3452259">]</span><span class="builtintype" id="3452260">byte</span><span class="op" id="3452264">,</span>&nbsp;<span class="ident" id="3452266">err</span>&nbsp;<span class="builtintype" id="3452270">error</span><span class="op" id="3452275">)</span>&nbsp;<span class="op" id="3452277">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3452280">if</span>&nbsp;<span class="ident" id="3452283">atEOF</span>&nbsp;<span class="op" id="3452289">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3452292">len</span><span class="op" id="3452295">(</span><span class="ident" id="3452296">data</span><span class="op" id="3452300">)</span>&nbsp;<span class="op" id="3452302">==</span>&nbsp;<span class="num" id="3452305">0</span>&nbsp;<span class="op" id="3452307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3452311">return</span>&nbsp;<span class="num" id="3452318">0</span><span class="op" id="3452319">,</span>&nbsp;<span class="ident" id="3452321">nil</span><span class="op" id="3452324">,</span>&nbsp;<span class="ident" id="3452326">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3452331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3452334">return</span>&nbsp;<span class="num" id="3452341">1</span><span class="op" id="3452342">,</span>&nbsp;<span class="ident" id="3452344">data</span><span class="op" id="3452348">[</span><span class="num" id="3452349">0</span><span class="op" id="3452350">:</span><span class="num" id="3452351">1</span><span class="op" id="3452352">]</span><span class="op" id="3452353">,</span>&nbsp;<span class="ident" id="3452355">nil</span><br>
<span class="lineno"></span><span class="op" id="3452359">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="3452362">var</span>&nbsp;<span class="ident" id="3452366">errorRune</span>&nbsp;<span class="op" id="3452376">=</span>&nbsp;<span class="op" id="3452378">[</span><span class="op" id="3452379">]</span><span class="builtintype" id="3452380">byte</span><span class="op" id="3452384">(</span><span class="builtintype" id="3452385">string</span><span class="op" id="3452391">(</span><span class="ident" id="3452392">utf8</span><span class="op" id="3452396">.</span><span class="ident" id="3452397">RuneError</span><span class="op" id="3452406">)</span><span class="op" id="3452407">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3452410">//&nbsp;ScanRunes&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each</span><br>
<span class="lineno"></span><span class="comment" id="3452475">//&nbsp;UTF-8-encoded&nbsp;rune&nbsp;as&nbsp;a&nbsp;token.&nbsp;The&nbsp;sequence&nbsp;of&nbsp;runes&nbsp;returned&nbsp;is</span><br>
<span class="lineno">240</span><span class="comment" id="3452543">//&nbsp;equivalent&nbsp;to&nbsp;that&nbsp;from&nbsp;a&nbsp;range&nbsp;loop&nbsp;over&nbsp;the&nbsp;input&nbsp;as&nbsp;a&nbsp;string,&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="3452617">//&nbsp;means&nbsp;that&nbsp;erroneous&nbsp;UTF-8&nbsp;encodings&nbsp;translate&nbsp;to&nbsp;U+FFFD&nbsp;=&nbsp;&#34;\xef\xbf\xbd&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3452695">//&nbsp;Because&nbsp;of&nbsp;the&nbsp;Scan&nbsp;interface,&nbsp;this&nbsp;makes&nbsp;it&nbsp;impossible&nbsp;for&nbsp;the&nbsp;client&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3452772">//&nbsp;distinguish&nbsp;correctly&nbsp;encoded&nbsp;replacement&nbsp;runes&nbsp;from&nbsp;encoding&nbsp;errors.</span><br>
<span class="lineno"></span><span class="keyword" id="3452845">func</span>&nbsp;<span class="ident" id="3452850">ScanRunes</span><span class="op" id="3452859">(</span><span class="ident" id="3452860">data</span>&nbsp;<span class="op" id="3452865">[</span><span class="op" id="3452866">]</span><span class="builtintype" id="3452867">byte</span><span class="op" id="3452871">,</span>&nbsp;<span class="ident" id="3452873">atEOF</span>&nbsp;<span class="builtintype" id="3452879">bool</span><span class="op" id="3452883">)</span>&nbsp;<span class="op" id="3452885">(</span><span class="ident" id="3452886">advance</span>&nbsp;<span class="builtintype" id="3452894">int</span><span class="op" id="3452897">,</span>&nbsp;<span class="ident" id="3452899">token</span>&nbsp;<span class="op" id="3452905">[</span><span class="op" id="3452906">]</span><span class="builtintype" id="3452907">byte</span><span class="op" id="3452911">,</span>&nbsp;<span class="ident" id="3452913">err</span>&nbsp;<span class="builtintype" id="3452917">error</span><span class="op" id="3452922">)</span>&nbsp;<span class="op" id="3452924">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3452927">if</span>&nbsp;<span class="ident" id="3452930">atEOF</span>&nbsp;<span class="op" id="3452936">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3452939">len</span><span class="op" id="3452942">(</span><span class="ident" id="3452943">data</span><span class="op" id="3452947">)</span>&nbsp;<span class="op" id="3452949">==</span>&nbsp;<span class="num" id="3452952">0</span>&nbsp;<span class="op" id="3452954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3452958">return</span>&nbsp;<span class="num" id="3452965">0</span><span class="op" id="3452966">,</span>&nbsp;<span class="ident" id="3452968">nil</span><span class="op" id="3452971">,</span>&nbsp;<span class="ident" id="3452973">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3452978">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3452982">//&nbsp;Fast&nbsp;path&nbsp;1:&nbsp;ASCII.</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3453006">if</span>&nbsp;<span class="ident" id="3453009">data</span><span class="op" id="3453013">[</span><span class="num" id="3453014">0</span><span class="op" id="3453015">]</span>&nbsp;<span class="op" id="3453017">&lt;</span>&nbsp;<span class="ident" id="3453019">utf8</span><span class="op" id="3453023">.</span><span class="ident" id="3453024">RuneSelf</span>&nbsp;<span class="op" id="3453033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3453037">return</span>&nbsp;<span class="num" id="3453044">1</span><span class="op" id="3453045">,</span>&nbsp;<span class="ident" id="3453047">data</span><span class="op" id="3453051">[</span><span class="num" id="3453052">0</span><span class="op" id="3453053">:</span><span class="num" id="3453054">1</span><span class="op" id="3453055">]</span><span class="op" id="3453056">,</span>&nbsp;<span class="ident" id="3453058">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3453063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3453067">//&nbsp;Fast&nbsp;path&nbsp;2:&nbsp;Correct&nbsp;UTF-8&nbsp;decode&nbsp;without&nbsp;error.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3453120">_</span><span class="op" id="3453121">,</span>&nbsp;<span class="ident" id="3453123">width</span>&nbsp;<span class="op" id="3453129">:=</span>&nbsp;<span class="ident" id="3453132">utf8</span><span class="op" id="3453136">.</span><span class="ident" id="3453137">DecodeRune</span><span class="op" id="3453147">(</span><span class="ident" id="3453148">data</span><span class="op" id="3453152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3453155">if</span>&nbsp;<span class="ident" id="3453158">width</span>&nbsp;<span class="op" id="3453164">&gt;</span>&nbsp;<span class="num" id="3453166">1</span>&nbsp;<span class="op" id="3453168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3453172">//&nbsp;It&#39;s&nbsp;a&nbsp;valid&nbsp;encoding.&nbsp;Width&nbsp;cannot&nbsp;be&nbsp;one&nbsp;for&nbsp;a&nbsp;correctly&nbsp;encoded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3453244">//&nbsp;non-ASCII&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3453265">return</span>&nbsp;<span class="ident" id="3453272">width</span><span class="op" id="3453277">,</span>&nbsp;<span class="ident" id="3453279">data</span><span class="op" id="3453283">[</span><span class="num" id="3453284">0</span><span class="op" id="3453285">:</span><span class="ident" id="3453286">width</span><span class="op" id="3453291">]</span><span class="op" id="3453292">,</span>&nbsp;<span class="ident" id="3453294">nil</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3453299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3453303">//&nbsp;We&nbsp;know&nbsp;it&#39;s&nbsp;an&nbsp;error:&nbsp;we&nbsp;have&nbsp;width==1&nbsp;and&nbsp;implicitly&nbsp;r==utf8.RuneError.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3453381">//&nbsp;Is&nbsp;the&nbsp;error&nbsp;because&nbsp;there&nbsp;wasn&#39;t&nbsp;a&nbsp;full&nbsp;rune&nbsp;to&nbsp;be&nbsp;decoded?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3453446">//&nbsp;FullRune&nbsp;distinguishes&nbsp;correctly&nbsp;between&nbsp;erroneous&nbsp;and&nbsp;incomplete&nbsp;encodings.</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3453527">if</span>&nbsp;<span class="op" id="3453530">!</span><span class="ident" id="3453531">atEOF</span>&nbsp;<span class="op" id="3453537">&amp;&amp;</span>&nbsp;<span class="op" id="3453540">!</span><span class="ident" id="3453541">utf8</span><span class="op" id="3453545">.</span><span class="ident" id="3453546">FullRune</span><span class="op" id="3453554">(</span><span class="ident" id="3453555">data</span><span class="op" id="3453559">)</span>&nbsp;<span class="op" id="3453561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3453565">//&nbsp;Incomplete;&nbsp;get&nbsp;more&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3453598">return</span>&nbsp;<span class="num" id="3453605">0</span><span class="op" id="3453606">,</span>&nbsp;<span class="ident" id="3453608">nil</span><span class="op" id="3453611">,</span>&nbsp;<span class="ident" id="3453613">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3453618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3453622">//&nbsp;We&nbsp;have&nbsp;a&nbsp;real&nbsp;UTF-8&nbsp;encoding&nbsp;error.&nbsp;Return&nbsp;a&nbsp;properly&nbsp;encoded&nbsp;error&nbsp;rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3453700">//&nbsp;but&nbsp;advance&nbsp;only&nbsp;one&nbsp;byte.&nbsp;This&nbsp;matches&nbsp;the&nbsp;behavior&nbsp;of&nbsp;a&nbsp;range&nbsp;loop&nbsp;over</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3453778">//&nbsp;an&nbsp;incorrectly&nbsp;encoded&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3453813">return</span>&nbsp;<span class="num" id="3453820">1</span><span class="op" id="3453821">,</span>&nbsp;<span class="ident" id="3453823">errorRune</span><span class="op" id="3453832">,</span>&nbsp;<span class="ident" id="3453834">nil</span><br>
<span class="lineno"></span><span class="op" id="3453838">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="comment" id="3453841">//&nbsp;dropCR&nbsp;drops&nbsp;a&nbsp;terminal&nbsp;\r&nbsp;from&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3453886">func</span>&nbsp;<span class="ident" id="3453891">dropCR</span><span class="op" id="3453897">(</span><span class="ident" id="3453898">data</span>&nbsp;<span class="op" id="3453903">[</span><span class="op" id="3453904">]</span><span class="builtintype" id="3453905">byte</span><span class="op" id="3453909">)</span>&nbsp;<span class="op" id="3453911">[</span><span class="op" id="3453912">]</span><span class="builtintype" id="3453913">byte</span>&nbsp;<span class="op" id="3453918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3453921">if</span>&nbsp;<span class="builtinfunc" id="3453924">len</span><span class="op" id="3453927">(</span><span class="ident" id="3453928">data</span><span class="op" id="3453932">)</span>&nbsp;<span class="op" id="3453934">&gt;</span>&nbsp;<span class="num" id="3453936">0</span>&nbsp;<span class="op" id="3453938">&amp;&amp;</span>&nbsp;<span class="ident" id="3453941">data</span><span class="op" id="3453945">[</span><span class="builtinfunc" id="3453946">len</span><span class="op" id="3453949">(</span><span class="ident" id="3453950">data</span><span class="op" id="3453954">)</span><span class="op" id="3453955">-</span><span class="num" id="3453956">1</span><span class="op" id="3453957">]</span>&nbsp;<span class="op" id="3453959">==</span>&nbsp;<span class="string" id="3453962">&#39;\r&#39;</span>&nbsp;<span class="op" id="3453967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3453971">return</span>&nbsp;<span class="ident" id="3453978">data</span><span class="op" id="3453982">[</span><span class="num" id="3453983">0</span>&nbsp;<span class="op" id="3453985">:</span>&nbsp;<span class="builtinfunc" id="3453987">len</span><span class="op" id="3453990">(</span><span class="ident" id="3453991">data</span><span class="op" id="3453995">)</span><span class="op" id="3453996">-</span><span class="num" id="3453997">1</span><span class="op" id="3453998">]</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3454001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3454004">return</span>&nbsp;<span class="ident" id="3454011">data</span><br>
<span class="lineno"></span><span class="op" id="3454016">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3454019">//&nbsp;ScanLines&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each&nbsp;line&nbsp;of</span><br>
<span class="lineno">285</span><span class="comment" id="3454092">//&nbsp;text,&nbsp;stripped&nbsp;of&nbsp;any&nbsp;trailing&nbsp;end-of-line&nbsp;marker.&nbsp;The&nbsp;returned&nbsp;line&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="3454168">//&nbsp;be&nbsp;empty.&nbsp;The&nbsp;end-of-line&nbsp;marker&nbsp;is&nbsp;one&nbsp;optional&nbsp;carriage&nbsp;return&nbsp;followed</span><br>
<span class="lineno"></span><span class="comment" id="3454245">//&nbsp;by&nbsp;one&nbsp;mandatory&nbsp;newline.&nbsp;In&nbsp;regular&nbsp;expression&nbsp;notation,&nbsp;it&nbsp;is&nbsp;`\r?\n`.</span><br>
<span class="lineno"></span><span class="comment" id="3454321">//&nbsp;The&nbsp;last&nbsp;non-empty&nbsp;line&nbsp;of&nbsp;input&nbsp;will&nbsp;be&nbsp;returned&nbsp;even&nbsp;if&nbsp;it&nbsp;has&nbsp;no</span><br>
<span class="lineno"></span><span class="comment" id="3454392">//&nbsp;newline.</span><br>
<span class="lineno">290</span><span class="keyword" id="3454404">func</span>&nbsp;<span class="ident" id="3454409">ScanLines</span><span class="op" id="3454418">(</span><span class="ident" id="3454419">data</span>&nbsp;<span class="op" id="3454424">[</span><span class="op" id="3454425">]</span><span class="builtintype" id="3454426">byte</span><span class="op" id="3454430">,</span>&nbsp;<span class="ident" id="3454432">atEOF</span>&nbsp;<span class="builtintype" id="3454438">bool</span><span class="op" id="3454442">)</span>&nbsp;<span class="op" id="3454444">(</span><span class="ident" id="3454445">advance</span>&nbsp;<span class="builtintype" id="3454453">int</span><span class="op" id="3454456">,</span>&nbsp;<span class="ident" id="3454458">token</span>&nbsp;<span class="op" id="3454464">[</span><span class="op" id="3454465">]</span><span class="builtintype" id="3454466">byte</span><span class="op" id="3454470">,</span>&nbsp;<span class="ident" id="3454472">err</span>&nbsp;<span class="builtintype" id="3454476">error</span><span class="op" id="3454481">)</span>&nbsp;<span class="op" id="3454483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3454486">if</span>&nbsp;<span class="ident" id="3454489">atEOF</span>&nbsp;<span class="op" id="3454495">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3454498">len</span><span class="op" id="3454501">(</span><span class="ident" id="3454502">data</span><span class="op" id="3454506">)</span>&nbsp;<span class="op" id="3454508">==</span>&nbsp;<span class="num" id="3454511">0</span>&nbsp;<span class="op" id="3454513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3454517">return</span>&nbsp;<span class="num" id="3454524">0</span><span class="op" id="3454525">,</span>&nbsp;<span class="ident" id="3454527">nil</span><span class="op" id="3454530">,</span>&nbsp;<span class="ident" id="3454532">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3454537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3454540">if</span>&nbsp;<span class="ident" id="3454543">i</span>&nbsp;<span class="op" id="3454545">:=</span>&nbsp;<span class="ident" id="3454548">bytes</span><span class="op" id="3454553">.</span><span class="ident" id="3454554">IndexByte</span><span class="op" id="3454563">(</span><span class="ident" id="3454564">data</span><span class="op" id="3454568">,</span>&nbsp;<span class="string" id="3454570">&#39;\n&#39;</span><span class="op" id="3454574">)</span><span class="op" id="3454575">;</span>&nbsp;<span class="ident" id="3454577">i</span>&nbsp;<span class="op" id="3454579">&gt;=</span>&nbsp;<span class="num" id="3454582">0</span>&nbsp;<span class="op" id="3454584">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3454588">//&nbsp;We&nbsp;have&nbsp;a&nbsp;full&nbsp;newline-terminated&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3454633">return</span>&nbsp;<span class="ident" id="3454640">i</span>&nbsp;<span class="op" id="3454642">+</span>&nbsp;<span class="num" id="3454644">1</span><span class="op" id="3454645">,</span>&nbsp;<span class="ident" id="3454647">dropCR</span><span class="op" id="3454653">(</span><span class="ident" id="3454654">data</span><span class="op" id="3454658">[</span><span class="num" id="3454659">0</span><span class="op" id="3454660">:</span><span class="ident" id="3454661">i</span><span class="op" id="3454662">]</span><span class="op" id="3454663">)</span><span class="op" id="3454664">,</span>&nbsp;<span class="ident" id="3454666">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3454671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3454674">//&nbsp;If&nbsp;we&#39;re&nbsp;at&nbsp;EOF,&nbsp;we&nbsp;have&nbsp;a&nbsp;final,&nbsp;non-terminated&nbsp;line.&nbsp;Return&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3454744">if</span>&nbsp;<span class="ident" id="3454747">atEOF</span>&nbsp;<span class="op" id="3454753">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3454757">return</span>&nbsp;<span class="builtinfunc" id="3454764">len</span><span class="op" id="3454767">(</span><span class="ident" id="3454768">data</span><span class="op" id="3454772">)</span><span class="op" id="3454773">,</span>&nbsp;<span class="ident" id="3454775">dropCR</span><span class="op" id="3454781">(</span><span class="ident" id="3454782">data</span><span class="op" id="3454786">)</span><span class="op" id="3454787">,</span>&nbsp;<span class="ident" id="3454789">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3454794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3454797">//&nbsp;Request&nbsp;more&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3454820">return</span>&nbsp;<span class="num" id="3454827">0</span><span class="op" id="3454828">,</span>&nbsp;<span class="ident" id="3454830">nil</span><span class="op" id="3454833">,</span>&nbsp;<span class="ident" id="3454835">nil</span><br>
<span class="lineno"></span><span class="op" id="3454839">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span><span class="comment" id="3454842">//&nbsp;isSpace&nbsp;reports&nbsp;whether&nbsp;the&nbsp;character&nbsp;is&nbsp;a&nbsp;Unicode&nbsp;white&nbsp;space&nbsp;character.</span><br>
<span class="lineno"></span><span class="comment" id="3454919">//&nbsp;We&nbsp;avoid&nbsp;dependency&nbsp;on&nbsp;the&nbsp;unicode&nbsp;package,&nbsp;but&nbsp;check&nbsp;validity&nbsp;of&nbsp;the&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="3455007">//&nbsp;in&nbsp;the&nbsp;tests.</span><br>
<span class="lineno"></span><span class="keyword" id="3455024">func</span>&nbsp;<span class="ident" id="3455029">isSpace</span><span class="op" id="3455036">(</span><span class="ident" id="3455037">r</span>&nbsp;<span class="builtintype" id="3455039">rune</span><span class="op" id="3455043">)</span>&nbsp;<span class="builtintype" id="3455045">bool</span>&nbsp;<span class="op" id="3455050">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3455053">if</span>&nbsp;<span class="ident" id="3455056">r</span>&nbsp;<span class="op" id="3455058">&lt;=</span>&nbsp;<span class="string" id="3455061">&#39;\u00FF&#39;</span>&nbsp;<span class="op" id="3455070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3455074">//&nbsp;Obvious&nbsp;ASCII&nbsp;ones:&nbsp;\t&nbsp;through&nbsp;\r&nbsp;plus&nbsp;space.&nbsp;Plus&nbsp;two&nbsp;Latin-1&nbsp;oddballs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3455152">switch</span>&nbsp;<span class="ident" id="3455159">r</span>&nbsp;<span class="op" id="3455161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3455165">case</span>&nbsp;<span class="string" id="3455170">&#39;&nbsp;&#39;</span><span class="op" id="3455173">,</span>&nbsp;<span class="string" id="3455175">&#39;\t&#39;</span><span class="op" id="3455179">,</span>&nbsp;<span class="string" id="3455181">&#39;\n&#39;</span><span class="op" id="3455185">,</span>&nbsp;<span class="string" id="3455187">&#39;\v&#39;</span><span class="op" id="3455191">,</span>&nbsp;<span class="string" id="3455193">&#39;\f&#39;</span><span class="op" id="3455197">,</span>&nbsp;<span class="string" id="3455199">&#39;\r&#39;</span><span class="op" id="3455203">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3455208">return</span>&nbsp;<span class="builtintype" id="3455215">true</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3455222">case</span>&nbsp;<span class="string" id="3455227">&#39;\u0085&#39;</span><span class="op" id="3455235">,</span>&nbsp;<span class="string" id="3455237">&#39;\u00A0&#39;</span><span class="op" id="3455245">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3455250">return</span>&nbsp;<span class="builtintype" id="3455257">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3455264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3455268">return</span>&nbsp;<span class="builtintype" id="3455275">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3455282">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3455285">//&nbsp;High-valued&nbsp;ones.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3455307">if</span>&nbsp;<span class="string" id="3455310">&#39;\u2000&#39;</span>&nbsp;<span class="op" id="3455319">&lt;=</span>&nbsp;<span class="ident" id="3455322">r</span>&nbsp;<span class="op" id="3455324">&amp;&amp;</span>&nbsp;<span class="ident" id="3455327">r</span>&nbsp;<span class="op" id="3455329">&lt;=</span>&nbsp;<span class="string" id="3455332">&#39;\u200a&#39;</span>&nbsp;<span class="op" id="3455341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3455345">return</span>&nbsp;<span class="builtintype" id="3455352">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3455358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3455361">switch</span>&nbsp;<span class="ident" id="3455368">r</span>&nbsp;<span class="op" id="3455370">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3455373">case</span>&nbsp;<span class="string" id="3455378">&#39;\u1680&#39;</span><span class="op" id="3455386">,</span>&nbsp;<span class="string" id="3455388">&#39;\u2028&#39;</span><span class="op" id="3455396">,</span>&nbsp;<span class="string" id="3455398">&#39;\u2029&#39;</span><span class="op" id="3455406">,</span>&nbsp;<span class="string" id="3455408">&#39;\u202f&#39;</span><span class="op" id="3455416">,</span>&nbsp;<span class="string" id="3455418">&#39;\u205f&#39;</span><span class="op" id="3455426">,</span>&nbsp;<span class="string" id="3455428">&#39;\u3000&#39;</span><span class="op" id="3455436">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3455440">return</span>&nbsp;<span class="builtintype" id="3455447">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3455453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3455456">return</span>&nbsp;<span class="builtintype" id="3455463">false</span><br>
<span class="lineno"></span><span class="op" id="3455469">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="comment" id="3455472">//&nbsp;ScanWords&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each</span><br>
<span class="lineno"></span><span class="comment" id="3455537">//&nbsp;space-separated&nbsp;word&nbsp;of&nbsp;text,&nbsp;with&nbsp;surrounding&nbsp;spaces&nbsp;deleted.&nbsp;It&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="3455611">//&nbsp;never&nbsp;return&nbsp;an&nbsp;empty&nbsp;string.&nbsp;The&nbsp;definition&nbsp;of&nbsp;space&nbsp;is&nbsp;set&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3455678">//&nbsp;unicode.IsSpace.</span><br>
<span class="lineno">335</span><span class="keyword" id="3455698">func</span>&nbsp;<span class="ident" id="3455703">ScanWords</span><span class="op" id="3455712">(</span><span class="ident" id="3455713">data</span>&nbsp;<span class="op" id="3455718">[</span><span class="op" id="3455719">]</span><span class="builtintype" id="3455720">byte</span><span class="op" id="3455724">,</span>&nbsp;<span class="ident" id="3455726">atEOF</span>&nbsp;<span class="builtintype" id="3455732">bool</span><span class="op" id="3455736">)</span>&nbsp;<span class="op" id="3455738">(</span><span class="ident" id="3455739">advance</span>&nbsp;<span class="builtintype" id="3455747">int</span><span class="op" id="3455750">,</span>&nbsp;<span class="ident" id="3455752">token</span>&nbsp;<span class="op" id="3455758">[</span><span class="op" id="3455759">]</span><span class="builtintype" id="3455760">byte</span><span class="op" id="3455764">,</span>&nbsp;<span class="ident" id="3455766">err</span>&nbsp;<span class="builtintype" id="3455770">error</span><span class="op" id="3455775">)</span>&nbsp;<span class="op" id="3455777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3455780">//&nbsp;Skip&nbsp;leading&nbsp;spaces.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3455805">start</span>&nbsp;<span class="op" id="3455811">:=</span>&nbsp;<span class="num" id="3455814">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3455817">for</span>&nbsp;<span class="ident" id="3455821">width</span>&nbsp;<span class="op" id="3455827">:=</span>&nbsp;<span class="num" id="3455830">0</span><span class="op" id="3455831">;</span>&nbsp;<span class="ident" id="3455833">start</span>&nbsp;<span class="op" id="3455839">&lt;</span>&nbsp;<span class="builtinfunc" id="3455841">len</span><span class="op" id="3455844">(</span><span class="ident" id="3455845">data</span><span class="op" id="3455849">)</span><span class="op" id="3455850">;</span>&nbsp;<span class="ident" id="3455852">start</span>&nbsp;<span class="op" id="3455858">+=</span>&nbsp;<span class="ident" id="3455861">width</span>&nbsp;<span class="op" id="3455867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3455871">var</span>&nbsp;<span class="ident" id="3455875">r</span>&nbsp;<span class="builtintype" id="3455877">rune</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3455884">r</span><span class="op" id="3455885">,</span>&nbsp;<span class="ident" id="3455887">width</span>&nbsp;<span class="op" id="3455893">=</span>&nbsp;<span class="ident" id="3455895">utf8</span><span class="op" id="3455899">.</span><span class="ident" id="3455900">DecodeRune</span><span class="op" id="3455910">(</span><span class="ident" id="3455911">data</span><span class="op" id="3455915">[</span><span class="ident" id="3455916">start</span><span class="op" id="3455921">:</span><span class="op" id="3455922">]</span><span class="op" id="3455923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3455927">if</span>&nbsp;<span class="op" id="3455930">!</span><span class="ident" id="3455931">isSpace</span><span class="op" id="3455938">(</span><span class="ident" id="3455939">r</span><span class="op" id="3455940">)</span>&nbsp;<span class="op" id="3455942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3455947">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3455955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3455958">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3455961">//&nbsp;Scan&nbsp;until&nbsp;space,&nbsp;marking&nbsp;end&nbsp;of&nbsp;word.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3456004">for</span>&nbsp;<span class="ident" id="3456008">width</span><span class="op" id="3456013">,</span>&nbsp;<span class="ident" id="3456015">i</span>&nbsp;<span class="op" id="3456017">:=</span>&nbsp;<span class="num" id="3456020">0</span><span class="op" id="3456021">,</span>&nbsp;<span class="ident" id="3456023">start</span><span class="op" id="3456028">;</span>&nbsp;<span class="ident" id="3456030">i</span>&nbsp;<span class="op" id="3456032">&lt;</span>&nbsp;<span class="builtinfunc" id="3456034">len</span><span class="op" id="3456037">(</span><span class="ident" id="3456038">data</span><span class="op" id="3456042">)</span><span class="op" id="3456043">;</span>&nbsp;<span class="ident" id="3456045">i</span>&nbsp;<span class="op" id="3456047">+=</span>&nbsp;<span class="ident" id="3456050">width</span>&nbsp;<span class="op" id="3456056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3456060">var</span>&nbsp;<span class="ident" id="3456064">r</span>&nbsp;<span class="builtintype" id="3456066">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3456073">r</span><span class="op" id="3456074">,</span>&nbsp;<span class="ident" id="3456076">width</span>&nbsp;<span class="op" id="3456082">=</span>&nbsp;<span class="ident" id="3456084">utf8</span><span class="op" id="3456088">.</span><span class="ident" id="3456089">DecodeRune</span><span class="op" id="3456099">(</span><span class="ident" id="3456100">data</span><span class="op" id="3456104">[</span><span class="ident" id="3456105">i</span><span class="op" id="3456106">:</span><span class="op" id="3456107">]</span><span class="op" id="3456108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3456112">if</span>&nbsp;<span class="ident" id="3456115">isSpace</span><span class="op" id="3456122">(</span><span class="ident" id="3456123">r</span><span class="op" id="3456124">)</span>&nbsp;<span class="op" id="3456126">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3456131">return</span>&nbsp;<span class="ident" id="3456138">i</span>&nbsp;<span class="op" id="3456140">+</span>&nbsp;<span class="ident" id="3456142">width</span><span class="op" id="3456147">,</span>&nbsp;<span class="ident" id="3456149">data</span><span class="op" id="3456153">[</span><span class="ident" id="3456154">start</span><span class="op" id="3456159">:</span><span class="ident" id="3456160">i</span><span class="op" id="3456161">]</span><span class="op" id="3456162">,</span>&nbsp;<span class="ident" id="3456164">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3456170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3456173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3456176">//&nbsp;If&nbsp;we&#39;re&nbsp;at&nbsp;EOF,&nbsp;we&nbsp;have&nbsp;a&nbsp;final,&nbsp;non-empty,&nbsp;non-terminated&nbsp;word.&nbsp;Return&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3456257">if</span>&nbsp;<span class="ident" id="3456260">atEOF</span>&nbsp;<span class="op" id="3456266">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3456269">len</span><span class="op" id="3456272">(</span><span class="ident" id="3456273">data</span><span class="op" id="3456277">)</span>&nbsp;<span class="op" id="3456279">&gt;</span>&nbsp;<span class="ident" id="3456281">start</span>&nbsp;<span class="op" id="3456287">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3456291">return</span>&nbsp;<span class="builtinfunc" id="3456298">len</span><span class="op" id="3456301">(</span><span class="ident" id="3456302">data</span><span class="op" id="3456306">)</span><span class="op" id="3456307">,</span>&nbsp;<span class="ident" id="3456309">data</span><span class="op" id="3456313">[</span><span class="ident" id="3456314">start</span><span class="op" id="3456319">:</span><span class="op" id="3456320">]</span><span class="op" id="3456321">,</span>&nbsp;<span class="ident" id="3456323">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3456328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3456331">//&nbsp;Request&nbsp;more&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3456354">return</span>&nbsp;<span class="ident" id="3456361">start</span><span class="op" id="3456366">,</span>&nbsp;<span class="ident" id="3456368">nil</span><span class="op" id="3456371">,</span>&nbsp;<span class="ident" id="3456373">nil</span><br>
<span class="lineno"></span><span class="op" id="3456377">}</span>
</div>
</body>
</html>
