<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4150050">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4150106">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4150160">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4150211">package</span>&nbsp;<span class="ident" id="4150219">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4150229">//&nbsp;This&nbsp;is&nbsp;a&nbsp;constant-time,&nbsp;32-bit&nbsp;implementation&nbsp;of&nbsp;P224.&nbsp;See&nbsp;FIPS&nbsp;186-3,</span><br>
<span class="lineno"></span><span class="comment" id="4150304">//&nbsp;section&nbsp;D.2.2.</span><br>
<span class="lineno"></span><span class="comment" id="4150322">//</span><br>
<span class="lineno">10</span><span class="comment" id="4150325">//&nbsp;See&nbsp;http://www.imperialviolet.org/2010/12/04/ecc.html&nbsp;([1])&nbsp;for&nbsp;background.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4150405">import</span>&nbsp;<span class="op" id="4150412">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4150415">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4150426">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4150429">var</span>&nbsp;<span class="ident" id="4150433">p224</span>&nbsp;<span class="ident" id="4150438">p224Curve</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4150449">type</span>&nbsp;<span class="ident" id="4150454">p224Curve</span>&nbsp;<span class="keyword" id="4150464">struct</span>&nbsp;<span class="op" id="4150471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4150474">*</span><span class="ident" id="4150475">CurveParams</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150488">gx</span><span class="op" id="4150490">,</span>&nbsp;<span class="ident" id="4150492">gy</span><span class="op" id="4150494">,</span>&nbsp;<span class="ident" id="4150496">b</span>&nbsp;<span class="ident" id="4150498">p224FieldElement</span><br>
<span class="lineno"></span><span class="op" id="4150515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4150518">func</span>&nbsp;<span class="ident" id="4150523">initP224</span><span class="op" id="4150531">(</span><span class="op" id="4150532">)</span>&nbsp;<span class="op" id="4150534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4150537">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150571">p224</span><span class="op" id="4150575">.</span><span class="ident" id="4150576">CurveParams</span>&nbsp;<span class="op" id="4150588">=</span>&nbsp;<span class="builtinfunc" id="4150590">new</span><span class="op" id="4150593">(</span><span class="ident" id="4150594">CurveParams</span><span class="op" id="4150605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150608">p224</span><span class="op" id="4150612">.</span><span class="ident" id="4150613">P</span><span class="op" id="4150614">,</span>&nbsp;<span class="ident" id="4150616">_</span>&nbsp;<span class="op" id="4150618">=</span>&nbsp;<span class="builtinfunc" id="4150620">new</span><span class="op" id="4150623">(</span><span class="ident" id="4150624">big</span><span class="op" id="4150627">.</span><span class="ident" id="4150628">Int</span><span class="op" id="4150631">)</span><span class="op" id="4150632">.</span><span class="ident" id="4150633">SetString</span><span class="op" id="4150642">(</span><span class="string" id="4150643">&#34;26959946667150639794667015087019630673557916260026308143510066298881&#34;</span><span class="op" id="4150713">,</span>&nbsp;<span class="num" id="4150715">10</span><span class="op" id="4150717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150720">p224</span><span class="op" id="4150724">.</span><span class="ident" id="4150725">N</span><span class="op" id="4150726">,</span>&nbsp;<span class="ident" id="4150728">_</span>&nbsp;<span class="op" id="4150730">=</span>&nbsp;<span class="builtinfunc" id="4150732">new</span><span class="op" id="4150735">(</span><span class="ident" id="4150736">big</span><span class="op" id="4150739">.</span><span class="ident" id="4150740">Int</span><span class="op" id="4150743">)</span><span class="op" id="4150744">.</span><span class="ident" id="4150745">SetString</span><span class="op" id="4150754">(</span><span class="string" id="4150755">&#34;26959946667150639794667015087019625940457807714424391721682722368061&#34;</span><span class="op" id="4150825">,</span>&nbsp;<span class="num" id="4150827">10</span><span class="op" id="4150829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150832">p224</span><span class="op" id="4150836">.</span><span class="ident" id="4150837">B</span><span class="op" id="4150838">,</span>&nbsp;<span class="ident" id="4150840">_</span>&nbsp;<span class="op" id="4150842">=</span>&nbsp;<span class="builtinfunc" id="4150844">new</span><span class="op" id="4150847">(</span><span class="ident" id="4150848">big</span><span class="op" id="4150851">.</span><span class="ident" id="4150852">Int</span><span class="op" id="4150855">)</span><span class="op" id="4150856">.</span><span class="ident" id="4150857">SetString</span><span class="op" id="4150866">(</span><span class="string" id="4150867">&#34;b4050a850c04b3abf54132565044b0b7d7bfd8ba270b39432355ffb4&#34;</span><span class="op" id="4150925">,</span>&nbsp;<span class="num" id="4150927">16</span><span class="op" id="4150929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150932">p224</span><span class="op" id="4150936">.</span><span class="ident" id="4150937">Gx</span><span class="op" id="4150939">,</span>&nbsp;<span class="ident" id="4150941">_</span>&nbsp;<span class="op" id="4150943">=</span>&nbsp;<span class="builtinfunc" id="4150945">new</span><span class="op" id="4150948">(</span><span class="ident" id="4150949">big</span><span class="op" id="4150952">.</span><span class="ident" id="4150953">Int</span><span class="op" id="4150956">)</span><span class="op" id="4150957">.</span><span class="ident" id="4150958">SetString</span><span class="op" id="4150967">(</span><span class="string" id="4150968">&#34;b70e0cbd6bb4bf7f321390b94a03c1d356c21122343280d6115c1d21&#34;</span><span class="op" id="4151026">,</span>&nbsp;<span class="num" id="4151028">16</span><span class="op" id="4151030">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151033">p224</span><span class="op" id="4151037">.</span><span class="ident" id="4151038">Gy</span><span class="op" id="4151040">,</span>&nbsp;<span class="ident" id="4151042">_</span>&nbsp;<span class="op" id="4151044">=</span>&nbsp;<span class="builtinfunc" id="4151046">new</span><span class="op" id="4151049">(</span><span class="ident" id="4151050">big</span><span class="op" id="4151053">.</span><span class="ident" id="4151054">Int</span><span class="op" id="4151057">)</span><span class="op" id="4151058">.</span><span class="ident" id="4151059">SetString</span><span class="op" id="4151068">(</span><span class="string" id="4151069">&#34;bd376388b5f723fb4c22dfe6cd4375a05a07476444d5819985007e34&#34;</span><span class="op" id="4151127">,</span>&nbsp;<span class="num" id="4151129">16</span><span class="op" id="4151131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151134">p224</span><span class="op" id="4151138">.</span><span class="ident" id="4151139">BitSize</span>&nbsp;<span class="op" id="4151147">=</span>&nbsp;<span class="num" id="4151149">224</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151155">p224FromBig</span><span class="op" id="4151166">(</span><span class="op" id="4151167">&amp;</span><span class="ident" id="4151168">p224</span><span class="op" id="4151172">.</span><span class="ident" id="4151173">gx</span><span class="op" id="4151175">,</span>&nbsp;<span class="ident" id="4151177">p224</span><span class="op" id="4151181">.</span><span class="ident" id="4151182">Gx</span><span class="op" id="4151184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151187">p224FromBig</span><span class="op" id="4151198">(</span><span class="op" id="4151199">&amp;</span><span class="ident" id="4151200">p224</span><span class="op" id="4151204">.</span><span class="ident" id="4151205">gy</span><span class="op" id="4151207">,</span>&nbsp;<span class="ident" id="4151209">p224</span><span class="op" id="4151213">.</span><span class="ident" id="4151214">Gy</span><span class="op" id="4151216">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151219">p224FromBig</span><span class="op" id="4151230">(</span><span class="op" id="4151231">&amp;</span><span class="ident" id="4151232">p224</span><span class="op" id="4151236">.</span><span class="ident" id="4151237">b</span><span class="op" id="4151238">,</span>&nbsp;<span class="ident" id="4151240">p224</span><span class="op" id="4151244">.</span><span class="ident" id="4151245">B</span><span class="op" id="4151246">)</span><br>
<span class="lineno"></span><span class="op" id="4151248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4151251">//&nbsp;P224&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-224&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2)</span><br>
<span class="lineno"></span><span class="keyword" id="4151330">func</span>&nbsp;<span class="ident" id="4151335">P224</span><span class="op" id="4151339">(</span><span class="op" id="4151340">)</span>&nbsp;<span class="ident" id="4151342">Curve</span>&nbsp;<span class="op" id="4151348">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151351">initonce</span><span class="op" id="4151359">.</span><span class="ident" id="4151360">Do</span><span class="op" id="4151362">(</span><span class="ident" id="4151363">initAll</span><span class="op" id="4151370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151373">return</span>&nbsp;<span class="ident" id="4151380">p224</span><br>
<span class="lineno"></span><span class="op" id="4151385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4151388">func</span>&nbsp;<span class="op" id="4151393">(</span><span class="ident" id="4151394">curve</span>&nbsp;<span class="ident" id="4151400">p224Curve</span><span class="op" id="4151409">)</span>&nbsp;<span class="ident" id="4151411">Params</span><span class="op" id="4151417">(</span><span class="op" id="4151418">)</span>&nbsp;<span class="op" id="4151420">*</span><span class="ident" id="4151421">CurveParams</span>&nbsp;<span class="op" id="4151433">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151436">return</span>&nbsp;<span class="ident" id="4151443">curve</span><span class="op" id="4151448">.</span><span class="ident" id="4151449">CurveParams</span><br>
<span class="lineno"></span><span class="op" id="4151461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4151464">func</span>&nbsp;<span class="op" id="4151469">(</span><span class="ident" id="4151470">curve</span>&nbsp;<span class="ident" id="4151476">p224Curve</span><span class="op" id="4151485">)</span>&nbsp;<span class="ident" id="4151487">IsOnCurve</span><span class="op" id="4151496">(</span><span class="ident" id="4151497">bigX</span><span class="op" id="4151501">,</span>&nbsp;<span class="ident" id="4151503">bigY</span>&nbsp;<span class="op" id="4151508">*</span><span class="ident" id="4151509">big</span><span class="op" id="4151512">.</span><span class="ident" id="4151513">Int</span><span class="op" id="4151516">)</span>&nbsp;<span class="builtintype" id="4151518">bool</span>&nbsp;<span class="op" id="4151523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151526">var</span>&nbsp;<span class="ident" id="4151530">x</span><span class="op" id="4151531">,</span>&nbsp;<span class="ident" id="4151533">y</span>&nbsp;<span class="ident" id="4151535">p224FieldElement</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151553">p224FromBig</span><span class="op" id="4151564">(</span><span class="op" id="4151565">&amp;</span><span class="ident" id="4151566">x</span><span class="op" id="4151567">,</span>&nbsp;<span class="ident" id="4151569">bigX</span><span class="op" id="4151573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151576">p224FromBig</span><span class="op" id="4151587">(</span><span class="op" id="4151588">&amp;</span><span class="ident" id="4151589">y</span><span class="op" id="4151590">,</span>&nbsp;<span class="ident" id="4151592">bigY</span><span class="op" id="4151596">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4151600">//&nbsp;y²&nbsp;=&nbsp;x³&nbsp;-&nbsp;3x&nbsp;+&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151623">var</span>&nbsp;<span class="ident" id="4151627">tmp</span>&nbsp;<span class="ident" id="4151631">p224LargeFieldElement</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151654">var</span>&nbsp;<span class="ident" id="4151658">x3</span>&nbsp;<span class="ident" id="4151661">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151679">p224Square</span><span class="op" id="4151689">(</span><span class="op" id="4151690">&amp;</span><span class="ident" id="4151691">x3</span><span class="op" id="4151693">,</span>&nbsp;<span class="op" id="4151695">&amp;</span><span class="ident" id="4151696">x</span><span class="op" id="4151697">,</span>&nbsp;<span class="op" id="4151699">&amp;</span><span class="ident" id="4151700">tmp</span><span class="op" id="4151703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151706">p224Mul</span><span class="op" id="4151713">(</span><span class="op" id="4151714">&amp;</span><span class="ident" id="4151715">x3</span><span class="op" id="4151717">,</span>&nbsp;<span class="op" id="4151719">&amp;</span><span class="ident" id="4151720">x3</span><span class="op" id="4151722">,</span>&nbsp;<span class="op" id="4151724">&amp;</span><span class="ident" id="4151725">x</span><span class="op" id="4151726">,</span>&nbsp;<span class="op" id="4151728">&amp;</span><span class="ident" id="4151729">tmp</span><span class="op" id="4151732">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151736">for</span>&nbsp;<span class="ident" id="4151740">i</span>&nbsp;<span class="op" id="4151742">:=</span>&nbsp;<span class="num" id="4151745">0</span><span class="op" id="4151746">;</span>&nbsp;<span class="ident" id="4151748">i</span>&nbsp;<span class="op" id="4151750">&lt;</span>&nbsp;<span class="num" id="4151752">8</span><span class="op" id="4151753">;</span>&nbsp;<span class="ident" id="4151755">i</span><span class="op" id="4151756">++</span>&nbsp;<span class="op" id="4151759">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151763">x</span><span class="op" id="4151764">[</span><span class="ident" id="4151765">i</span><span class="op" id="4151766">]</span>&nbsp;<span class="op" id="4151768">*=</span>&nbsp;<span class="num" id="4151771">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4151774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151777">p224Sub</span><span class="op" id="4151784">(</span><span class="op" id="4151785">&amp;</span><span class="ident" id="4151786">x3</span><span class="op" id="4151788">,</span>&nbsp;<span class="op" id="4151790">&amp;</span><span class="ident" id="4151791">x3</span><span class="op" id="4151793">,</span>&nbsp;<span class="op" id="4151795">&amp;</span><span class="ident" id="4151796">x</span><span class="op" id="4151797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151800">p224Reduce</span><span class="op" id="4151810">(</span><span class="op" id="4151811">&amp;</span><span class="ident" id="4151812">x3</span><span class="op" id="4151814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151817">p224Add</span><span class="op" id="4151824">(</span><span class="op" id="4151825">&amp;</span><span class="ident" id="4151826">x3</span><span class="op" id="4151828">,</span>&nbsp;<span class="op" id="4151830">&amp;</span><span class="ident" id="4151831">x3</span><span class="op" id="4151833">,</span>&nbsp;<span class="op" id="4151835">&amp;</span><span class="ident" id="4151836">curve</span><span class="op" id="4151841">.</span><span class="ident" id="4151842">b</span><span class="op" id="4151843">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151846">p224Contract</span><span class="op" id="4151858">(</span><span class="op" id="4151859">&amp;</span><span class="ident" id="4151860">x3</span><span class="op" id="4151862">,</span>&nbsp;<span class="op" id="4151864">&amp;</span><span class="ident" id="4151865">x3</span><span class="op" id="4151867">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151871">p224Square</span><span class="op" id="4151881">(</span><span class="op" id="4151882">&amp;</span><span class="ident" id="4151883">y</span><span class="op" id="4151884">,</span>&nbsp;<span class="op" id="4151886">&amp;</span><span class="ident" id="4151887">y</span><span class="op" id="4151888">,</span>&nbsp;<span class="op" id="4151890">&amp;</span><span class="ident" id="4151891">tmp</span><span class="op" id="4151894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151897">p224Contract</span><span class="op" id="4151909">(</span><span class="op" id="4151910">&amp;</span><span class="ident" id="4151911">y</span><span class="op" id="4151912">,</span>&nbsp;<span class="op" id="4151914">&amp;</span><span class="ident" id="4151915">y</span><span class="op" id="4151916">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151920">for</span>&nbsp;<span class="ident" id="4151924">i</span>&nbsp;<span class="op" id="4151926">:=</span>&nbsp;<span class="num" id="4151929">0</span><span class="op" id="4151930">;</span>&nbsp;<span class="ident" id="4151932">i</span>&nbsp;<span class="op" id="4151934">&lt;</span>&nbsp;<span class="num" id="4151936">8</span><span class="op" id="4151937">;</span>&nbsp;<span class="ident" id="4151939">i</span><span class="op" id="4151940">++</span>&nbsp;<span class="op" id="4151943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151947">if</span>&nbsp;<span class="ident" id="4151950">y</span><span class="op" id="4151951">[</span><span class="ident" id="4151952">i</span><span class="op" id="4151953">]</span>&nbsp;<span class="op" id="4151955">!=</span>&nbsp;<span class="ident" id="4151958">x3</span><span class="op" id="4151960">[</span><span class="ident" id="4151961">i</span><span class="op" id="4151962">]</span>&nbsp;<span class="op" id="4151964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151969">return</span>&nbsp;<span class="builtintype" id="4151976">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4151984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4151987">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151990">return</span>&nbsp;<span class="builtintype" id="4151997">true</span><br>
<span class="lineno"></span><span class="op" id="4152002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4152005">func</span>&nbsp;<span class="op" id="4152010">(</span><span class="ident" id="4152011">p224Curve</span><span class="op" id="4152020">)</span>&nbsp;<span class="ident" id="4152022">Add</span><span class="op" id="4152025">(</span><span class="ident" id="4152026">bigX1</span><span class="op" id="4152031">,</span>&nbsp;<span class="ident" id="4152033">bigY1</span><span class="op" id="4152038">,</span>&nbsp;<span class="ident" id="4152040">bigX2</span><span class="op" id="4152045">,</span>&nbsp;<span class="ident" id="4152047">bigY2</span>&nbsp;<span class="op" id="4152053">*</span><span class="ident" id="4152054">big</span><span class="op" id="4152057">.</span><span class="ident" id="4152058">Int</span><span class="op" id="4152061">)</span>&nbsp;<span class="op" id="4152063">(</span><span class="ident" id="4152064">x</span><span class="op" id="4152065">,</span>&nbsp;<span class="ident" id="4152067">y</span>&nbsp;<span class="op" id="4152069">*</span><span class="ident" id="4152070">big</span><span class="op" id="4152073">.</span><span class="ident" id="4152074">Int</span><span class="op" id="4152077">)</span>&nbsp;<span class="op" id="4152079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4152082">var</span>&nbsp;<span class="ident" id="4152086">x1</span><span class="op" id="4152088">,</span>&nbsp;<span class="ident" id="4152090">y1</span><span class="op" id="4152092">,</span>&nbsp;<span class="ident" id="4152094">z1</span><span class="op" id="4152096">,</span>&nbsp;<span class="ident" id="4152098">x2</span><span class="op" id="4152100">,</span>&nbsp;<span class="ident" id="4152102">y2</span><span class="op" id="4152104">,</span>&nbsp;<span class="ident" id="4152106">z2</span><span class="op" id="4152108">,</span>&nbsp;<span class="ident" id="4152110">x3</span><span class="op" id="4152112">,</span>&nbsp;<span class="ident" id="4152114">y3</span><span class="op" id="4152116">,</span>&nbsp;<span class="ident" id="4152118">z3</span>&nbsp;<span class="ident" id="4152121">p224FieldElement</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152140">p224FromBig</span><span class="op" id="4152151">(</span><span class="op" id="4152152">&amp;</span><span class="ident" id="4152153">x1</span><span class="op" id="4152155">,</span>&nbsp;<span class="ident" id="4152157">bigX1</span><span class="op" id="4152162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152165">p224FromBig</span><span class="op" id="4152176">(</span><span class="op" id="4152177">&amp;</span><span class="ident" id="4152178">y1</span><span class="op" id="4152180">,</span>&nbsp;<span class="ident" id="4152182">bigY1</span><span class="op" id="4152187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4152190">if</span>&nbsp;<span class="ident" id="4152193">bigX1</span><span class="op" id="4152198">.</span><span class="ident" id="4152199">Sign</span><span class="op" id="4152203">(</span><span class="op" id="4152204">)</span>&nbsp;<span class="op" id="4152206">!=</span>&nbsp;<span class="num" id="4152209">0</span>&nbsp;<span class="op" id="4152211">||</span>&nbsp;<span class="ident" id="4152214">bigY1</span><span class="op" id="4152219">.</span><span class="ident" id="4152220">Sign</span><span class="op" id="4152224">(</span><span class="op" id="4152225">)</span>&nbsp;<span class="op" id="4152227">!=</span>&nbsp;<span class="num" id="4152230">0</span>&nbsp;<span class="op" id="4152232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152236">z1</span><span class="op" id="4152238">[</span><span class="num" id="4152239">0</span><span class="op" id="4152240">]</span>&nbsp;<span class="op" id="4152242">=</span>&nbsp;<span class="num" id="4152244">1</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4152247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152250">p224FromBig</span><span class="op" id="4152261">(</span><span class="op" id="4152262">&amp;</span><span class="ident" id="4152263">x2</span><span class="op" id="4152265">,</span>&nbsp;<span class="ident" id="4152267">bigX2</span><span class="op" id="4152272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152275">p224FromBig</span><span class="op" id="4152286">(</span><span class="op" id="4152287">&amp;</span><span class="ident" id="4152288">y2</span><span class="op" id="4152290">,</span>&nbsp;<span class="ident" id="4152292">bigY2</span><span class="op" id="4152297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4152300">if</span>&nbsp;<span class="ident" id="4152303">bigX2</span><span class="op" id="4152308">.</span><span class="ident" id="4152309">Sign</span><span class="op" id="4152313">(</span><span class="op" id="4152314">)</span>&nbsp;<span class="op" id="4152316">!=</span>&nbsp;<span class="num" id="4152319">0</span>&nbsp;<span class="op" id="4152321">||</span>&nbsp;<span class="ident" id="4152324">bigY2</span><span class="op" id="4152329">.</span><span class="ident" id="4152330">Sign</span><span class="op" id="4152334">(</span><span class="op" id="4152335">)</span>&nbsp;<span class="op" id="4152337">!=</span>&nbsp;<span class="num" id="4152340">0</span>&nbsp;<span class="op" id="4152342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152346">z2</span><span class="op" id="4152348">[</span><span class="num" id="4152349">0</span><span class="op" id="4152350">]</span>&nbsp;<span class="op" id="4152352">=</span>&nbsp;<span class="num" id="4152354">1</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4152357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152361">p224AddJacobian</span><span class="op" id="4152376">(</span><span class="op" id="4152377">&amp;</span><span class="ident" id="4152378">x3</span><span class="op" id="4152380">,</span>&nbsp;<span class="op" id="4152382">&amp;</span><span class="ident" id="4152383">y3</span><span class="op" id="4152385">,</span>&nbsp;<span class="op" id="4152387">&amp;</span><span class="ident" id="4152388">z3</span><span class="op" id="4152390">,</span>&nbsp;<span class="op" id="4152392">&amp;</span><span class="ident" id="4152393">x1</span><span class="op" id="4152395">,</span>&nbsp;<span class="op" id="4152397">&amp;</span><span class="ident" id="4152398">y1</span><span class="op" id="4152400">,</span>&nbsp;<span class="op" id="4152402">&amp;</span><span class="ident" id="4152403">z1</span><span class="op" id="4152405">,</span>&nbsp;<span class="op" id="4152407">&amp;</span><span class="ident" id="4152408">x2</span><span class="op" id="4152410">,</span>&nbsp;<span class="op" id="4152412">&amp;</span><span class="ident" id="4152413">y2</span><span class="op" id="4152415">,</span>&nbsp;<span class="op" id="4152417">&amp;</span><span class="ident" id="4152418">z2</span><span class="op" id="4152420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4152423">return</span>&nbsp;<span class="ident" id="4152430">p224ToAffine</span><span class="op" id="4152442">(</span><span class="op" id="4152443">&amp;</span><span class="ident" id="4152444">x3</span><span class="op" id="4152446">,</span>&nbsp;<span class="op" id="4152448">&amp;</span><span class="ident" id="4152449">y3</span><span class="op" id="4152451">,</span>&nbsp;<span class="op" id="4152453">&amp;</span><span class="ident" id="4152454">z3</span><span class="op" id="4152456">)</span><br>
<span class="lineno"></span><span class="op" id="4152458">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4152461">func</span>&nbsp;<span class="op" id="4152466">(</span><span class="ident" id="4152467">p224Curve</span><span class="op" id="4152476">)</span>&nbsp;<span class="ident" id="4152478">Double</span><span class="op" id="4152484">(</span><span class="ident" id="4152485">bigX1</span><span class="op" id="4152490">,</span>&nbsp;<span class="ident" id="4152492">bigY1</span>&nbsp;<span class="op" id="4152498">*</span><span class="ident" id="4152499">big</span><span class="op" id="4152502">.</span><span class="ident" id="4152503">Int</span><span class="op" id="4152506">)</span>&nbsp;<span class="op" id="4152508">(</span><span class="ident" id="4152509">x</span><span class="op" id="4152510">,</span>&nbsp;<span class="ident" id="4152512">y</span>&nbsp;<span class="op" id="4152514">*</span><span class="ident" id="4152515">big</span><span class="op" id="4152518">.</span><span class="ident" id="4152519">Int</span><span class="op" id="4152522">)</span>&nbsp;<span class="op" id="4152524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4152527">var</span>&nbsp;<span class="ident" id="4152531">x1</span><span class="op" id="4152533">,</span>&nbsp;<span class="ident" id="4152535">y1</span><span class="op" id="4152537">,</span>&nbsp;<span class="ident" id="4152539">z1</span><span class="op" id="4152541">,</span>&nbsp;<span class="ident" id="4152543">x2</span><span class="op" id="4152545">,</span>&nbsp;<span class="ident" id="4152547">y2</span><span class="op" id="4152549">,</span>&nbsp;<span class="ident" id="4152551">z2</span>&nbsp;<span class="ident" id="4152554">p224FieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152573">p224FromBig</span><span class="op" id="4152584">(</span><span class="op" id="4152585">&amp;</span><span class="ident" id="4152586">x1</span><span class="op" id="4152588">,</span>&nbsp;<span class="ident" id="4152590">bigX1</span><span class="op" id="4152595">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152598">p224FromBig</span><span class="op" id="4152609">(</span><span class="op" id="4152610">&amp;</span><span class="ident" id="4152611">y1</span><span class="op" id="4152613">,</span>&nbsp;<span class="ident" id="4152615">bigY1</span><span class="op" id="4152620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152623">z1</span><span class="op" id="4152625">[</span><span class="num" id="4152626">0</span><span class="op" id="4152627">]</span>&nbsp;<span class="op" id="4152629">=</span>&nbsp;<span class="num" id="4152631">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152635">p224DoubleJacobian</span><span class="op" id="4152653">(</span><span class="op" id="4152654">&amp;</span><span class="ident" id="4152655">x2</span><span class="op" id="4152657">,</span>&nbsp;<span class="op" id="4152659">&amp;</span><span class="ident" id="4152660">y2</span><span class="op" id="4152662">,</span>&nbsp;<span class="op" id="4152664">&amp;</span><span class="ident" id="4152665">z2</span><span class="op" id="4152667">,</span>&nbsp;<span class="op" id="4152669">&amp;</span><span class="ident" id="4152670">x1</span><span class="op" id="4152672">,</span>&nbsp;<span class="op" id="4152674">&amp;</span><span class="ident" id="4152675">y1</span><span class="op" id="4152677">,</span>&nbsp;<span class="op" id="4152679">&amp;</span><span class="ident" id="4152680">z1</span><span class="op" id="4152682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4152685">return</span>&nbsp;<span class="ident" id="4152692">p224ToAffine</span><span class="op" id="4152704">(</span><span class="op" id="4152705">&amp;</span><span class="ident" id="4152706">x2</span><span class="op" id="4152708">,</span>&nbsp;<span class="op" id="4152710">&amp;</span><span class="ident" id="4152711">y2</span><span class="op" id="4152713">,</span>&nbsp;<span class="op" id="4152715">&amp;</span><span class="ident" id="4152716">z2</span><span class="op" id="4152718">)</span><br>
<span class="lineno">105</span><span class="op" id="4152720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4152723">func</span>&nbsp;<span class="op" id="4152728">(</span><span class="ident" id="4152729">p224Curve</span><span class="op" id="4152738">)</span>&nbsp;<span class="ident" id="4152740">ScalarMult</span><span class="op" id="4152750">(</span><span class="ident" id="4152751">bigX1</span><span class="op" id="4152756">,</span>&nbsp;<span class="ident" id="4152758">bigY1</span>&nbsp;<span class="op" id="4152764">*</span><span class="ident" id="4152765">big</span><span class="op" id="4152768">.</span><span class="ident" id="4152769">Int</span><span class="op" id="4152772">,</span>&nbsp;<span class="ident" id="4152774">scalar</span>&nbsp;<span class="op" id="4152781">[</span><span class="op" id="4152782">]</span><span class="builtintype" id="4152783">byte</span><span class="op" id="4152787">)</span>&nbsp;<span class="op" id="4152789">(</span><span class="ident" id="4152790">x</span><span class="op" id="4152791">,</span>&nbsp;<span class="ident" id="4152793">y</span>&nbsp;<span class="op" id="4152795">*</span><span class="ident" id="4152796">big</span><span class="op" id="4152799">.</span><span class="ident" id="4152800">Int</span><span class="op" id="4152803">)</span>&nbsp;<span class="op" id="4152805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4152808">var</span>&nbsp;<span class="ident" id="4152812">x1</span><span class="op" id="4152814">,</span>&nbsp;<span class="ident" id="4152816">y1</span><span class="op" id="4152818">,</span>&nbsp;<span class="ident" id="4152820">z1</span><span class="op" id="4152822">,</span>&nbsp;<span class="ident" id="4152824">x2</span><span class="op" id="4152826">,</span>&nbsp;<span class="ident" id="4152828">y2</span><span class="op" id="4152830">,</span>&nbsp;<span class="ident" id="4152832">z2</span>&nbsp;<span class="ident" id="4152835">p224FieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152854">p224FromBig</span><span class="op" id="4152865">(</span><span class="op" id="4152866">&amp;</span><span class="ident" id="4152867">x1</span><span class="op" id="4152869">,</span>&nbsp;<span class="ident" id="4152871">bigX1</span><span class="op" id="4152876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152879">p224FromBig</span><span class="op" id="4152890">(</span><span class="op" id="4152891">&amp;</span><span class="ident" id="4152892">y1</span><span class="op" id="4152894">,</span>&nbsp;<span class="ident" id="4152896">bigY1</span><span class="op" id="4152901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152904">z1</span><span class="op" id="4152906">[</span><span class="num" id="4152907">0</span><span class="op" id="4152908">]</span>&nbsp;<span class="op" id="4152910">=</span>&nbsp;<span class="num" id="4152912">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152916">p224ScalarMult</span><span class="op" id="4152930">(</span><span class="op" id="4152931">&amp;</span><span class="ident" id="4152932">x2</span><span class="op" id="4152934">,</span>&nbsp;<span class="op" id="4152936">&amp;</span><span class="ident" id="4152937">y2</span><span class="op" id="4152939">,</span>&nbsp;<span class="op" id="4152941">&amp;</span><span class="ident" id="4152942">z2</span><span class="op" id="4152944">,</span>&nbsp;<span class="op" id="4152946">&amp;</span><span class="ident" id="4152947">x1</span><span class="op" id="4152949">,</span>&nbsp;<span class="op" id="4152951">&amp;</span><span class="ident" id="4152952">y1</span><span class="op" id="4152954">,</span>&nbsp;<span class="op" id="4152956">&amp;</span><span class="ident" id="4152957">z1</span><span class="op" id="4152959">,</span>&nbsp;<span class="ident" id="4152961">scalar</span><span class="op" id="4152967">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4152970">return</span>&nbsp;<span class="ident" id="4152977">p224ToAffine</span><span class="op" id="4152989">(</span><span class="op" id="4152990">&amp;</span><span class="ident" id="4152991">x2</span><span class="op" id="4152993">,</span>&nbsp;<span class="op" id="4152995">&amp;</span><span class="ident" id="4152996">y2</span><span class="op" id="4152998">,</span>&nbsp;<span class="op" id="4153000">&amp;</span><span class="ident" id="4153001">z2</span><span class="op" id="4153003">)</span><br>
<span class="lineno"></span><span class="op" id="4153005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4153008">func</span>&nbsp;<span class="op" id="4153013">(</span><span class="ident" id="4153014">curve</span>&nbsp;<span class="ident" id="4153020">p224Curve</span><span class="op" id="4153029">)</span>&nbsp;<span class="ident" id="4153031">ScalarBaseMult</span><span class="op" id="4153045">(</span><span class="ident" id="4153046">scalar</span>&nbsp;<span class="op" id="4153053">[</span><span class="op" id="4153054">]</span><span class="builtintype" id="4153055">byte</span><span class="op" id="4153059">)</span>&nbsp;<span class="op" id="4153061">(</span><span class="ident" id="4153062">x</span><span class="op" id="4153063">,</span>&nbsp;<span class="ident" id="4153065">y</span>&nbsp;<span class="op" id="4153067">*</span><span class="ident" id="4153068">big</span><span class="op" id="4153071">.</span><span class="ident" id="4153072">Int</span><span class="op" id="4153075">)</span>&nbsp;<span class="op" id="4153077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4153080">var</span>&nbsp;<span class="ident" id="4153084">z1</span><span class="op" id="4153086">,</span>&nbsp;<span class="ident" id="4153088">x2</span><span class="op" id="4153090">,</span>&nbsp;<span class="ident" id="4153092">y2</span><span class="op" id="4153094">,</span>&nbsp;<span class="ident" id="4153096">z2</span>&nbsp;<span class="ident" id="4153099">p224FieldElement</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153118">z1</span><span class="op" id="4153120">[</span><span class="num" id="4153121">0</span><span class="op" id="4153122">]</span>&nbsp;<span class="op" id="4153124">=</span>&nbsp;<span class="num" id="4153126">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153129">p224ScalarMult</span><span class="op" id="4153143">(</span><span class="op" id="4153144">&amp;</span><span class="ident" id="4153145">x2</span><span class="op" id="4153147">,</span>&nbsp;<span class="op" id="4153149">&amp;</span><span class="ident" id="4153150">y2</span><span class="op" id="4153152">,</span>&nbsp;<span class="op" id="4153154">&amp;</span><span class="ident" id="4153155">z2</span><span class="op" id="4153157">,</span>&nbsp;<span class="op" id="4153159">&amp;</span><span class="ident" id="4153160">curve</span><span class="op" id="4153165">.</span><span class="ident" id="4153166">gx</span><span class="op" id="4153168">,</span>&nbsp;<span class="op" id="4153170">&amp;</span><span class="ident" id="4153171">curve</span><span class="op" id="4153176">.</span><span class="ident" id="4153177">gy</span><span class="op" id="4153179">,</span>&nbsp;<span class="op" id="4153181">&amp;</span><span class="ident" id="4153182">z1</span><span class="op" id="4153184">,</span>&nbsp;<span class="ident" id="4153186">scalar</span><span class="op" id="4153192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4153195">return</span>&nbsp;<span class="ident" id="4153202">p224ToAffine</span><span class="op" id="4153214">(</span><span class="op" id="4153215">&amp;</span><span class="ident" id="4153216">x2</span><span class="op" id="4153218">,</span>&nbsp;<span class="op" id="4153220">&amp;</span><span class="ident" id="4153221">y2</span><span class="op" id="4153223">,</span>&nbsp;<span class="op" id="4153225">&amp;</span><span class="ident" id="4153226">z2</span><span class="op" id="4153228">)</span><br>
<span class="lineno"></span><span class="op" id="4153230">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="4153233">//&nbsp;Field&nbsp;element&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="4153261">//</span><br>
<span class="lineno"></span><span class="comment" id="4153264">//&nbsp;The&nbsp;field&nbsp;that&nbsp;we&#39;re&nbsp;dealing&nbsp;with&nbsp;is&nbsp;ℤ/pℤ&nbsp;where&nbsp;p&nbsp;=&nbsp;2**224&nbsp;-&nbsp;2**96&nbsp;+&nbsp;1.</span><br>
<span class="lineno"></span><span class="comment" id="4153343">//</span><br>
<span class="lineno">130</span><span class="comment" id="4153346">//&nbsp;Field&nbsp;elements&nbsp;are&nbsp;represented&nbsp;by&nbsp;a&nbsp;FieldElement,&nbsp;which&nbsp;is&nbsp;a&nbsp;typedef&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4153424">//&nbsp;array&nbsp;of&nbsp;8&nbsp;uint32&#39;s.&nbsp;The&nbsp;value&nbsp;of&nbsp;a&nbsp;FieldElement,&nbsp;a,&nbsp;is:</span><br>
<span class="lineno"></span><span class="comment" id="4153484">//&nbsp;&nbsp;&nbsp;a[0]&nbsp;+&nbsp;2**28·a[1]&nbsp;+&nbsp;2**56·a[1]&nbsp;+&nbsp;...&nbsp;+&nbsp;2**196·a[7]</span><br>
<span class="lineno"></span><span class="comment" id="4153543">//</span><br>
<span class="lineno"></span><span class="comment" id="4153546">//&nbsp;Using&nbsp;28-bit&nbsp;limbs&nbsp;means&nbsp;that&nbsp;there&#39;s&nbsp;only&nbsp;4&nbsp;bits&nbsp;of&nbsp;headroom,&nbsp;which&nbsp;is&nbsp;less</span><br>
<span class="lineno">135</span><span class="comment" id="4153626">//&nbsp;than&nbsp;we&nbsp;would&nbsp;really&nbsp;like.&nbsp;But&nbsp;it&nbsp;has&nbsp;the&nbsp;useful&nbsp;feature&nbsp;that&nbsp;we&nbsp;hit&nbsp;2**224</span><br>
<span class="lineno"></span><span class="comment" id="4153705">//&nbsp;exactly,&nbsp;making&nbsp;the&nbsp;reflections&nbsp;during&nbsp;a&nbsp;reduce&nbsp;much&nbsp;nicer.</span><br>
<span class="lineno"></span><span class="keyword" id="4153768">type</span>&nbsp;<span class="ident" id="4153773">p224FieldElement</span>&nbsp;<span class="op" id="4153790">[</span><span class="num" id="4153791">8</span><span class="op" id="4153792">]</span><span class="builtintype" id="4153793">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4153801">//&nbsp;p224P&nbsp;is&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;field,&nbsp;represented&nbsp;as&nbsp;a&nbsp;p224FieldElement.</span><br>
<span class="lineno">140</span><span class="keyword" id="4153872">var</span>&nbsp;<span class="ident" id="4153876">p224P</span>&nbsp;<span class="op" id="4153882">=</span>&nbsp;<span class="op" id="4153884">[</span><span class="num" id="4153885">8</span><span class="op" id="4153886">]</span><span class="builtintype" id="4153887">uint32</span><span class="op" id="4153893">{</span><span class="num" id="4153894">1</span><span class="op" id="4153895">,</span>&nbsp;<span class="num" id="4153897">0</span><span class="op" id="4153898">,</span>&nbsp;<span class="num" id="4153900">0</span><span class="op" id="4153901">,</span>&nbsp;<span class="num" id="4153903">0xffff000</span><span class="op" id="4153912">,</span>&nbsp;<span class="num" id="4153914">0xfffffff</span><span class="op" id="4153923">,</span>&nbsp;<span class="num" id="4153925">0xfffffff</span><span class="op" id="4153934">,</span>&nbsp;<span class="num" id="4153936">0xfffffff</span><span class="op" id="4153945">,</span>&nbsp;<span class="num" id="4153947">0xfffffff</span><span class="op" id="4153956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4153959">//&nbsp;p224IsZero&nbsp;returns&nbsp;1&nbsp;if&nbsp;a&nbsp;==&nbsp;0&nbsp;mod&nbsp;p&nbsp;and&nbsp;0&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="4154016">//</span><br>
<span class="lineno"></span><span class="comment" id="4154019">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">145</span><span class="keyword" id="4154035">func</span>&nbsp;<span class="ident" id="4154040">p224IsZero</span><span class="op" id="4154050">(</span><span class="ident" id="4154051">a</span>&nbsp;<span class="op" id="4154053">*</span><span class="ident" id="4154054">p224FieldElement</span><span class="op" id="4154070">)</span>&nbsp;<span class="builtintype" id="4154072">uint32</span>&nbsp;<span class="op" id="4154079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4154082">//&nbsp;Since&nbsp;a&nbsp;p224FieldElement&nbsp;contains&nbsp;224&nbsp;bits&nbsp;there&nbsp;are&nbsp;two&nbsp;possible</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4154152">//&nbsp;representations&nbsp;of&nbsp;0:&nbsp;0&nbsp;and&nbsp;p.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4154187">var</span>&nbsp;<span class="ident" id="4154191">minimal</span>&nbsp;<span class="ident" id="4154199">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154217">p224Contract</span><span class="op" id="4154229">(</span><span class="op" id="4154230">&amp;</span><span class="ident" id="4154231">minimal</span><span class="op" id="4154238">,</span>&nbsp;<span class="ident" id="4154240">a</span><span class="op" id="4154241">)</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4154245">var</span>&nbsp;<span class="ident" id="4154249">isZero</span><span class="op" id="4154255">,</span>&nbsp;<span class="ident" id="4154257">isP</span>&nbsp;<span class="builtintype" id="4154261">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4154269">for</span>&nbsp;<span class="ident" id="4154273">i</span><span class="op" id="4154274">,</span>&nbsp;<span class="ident" id="4154276">v</span>&nbsp;<span class="op" id="4154278">:=</span>&nbsp;<span class="keyword" id="4154281">range</span>&nbsp;<span class="ident" id="4154287">minimal</span>&nbsp;<span class="op" id="4154295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154299">isZero</span>&nbsp;<span class="op" id="4154306">|=</span>&nbsp;<span class="ident" id="4154309">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154313">isP</span>&nbsp;<span class="op" id="4154317">|=</span>&nbsp;<span class="ident" id="4154320">v</span>&nbsp;<span class="op" id="4154322">-</span>&nbsp;<span class="ident" id="4154324">p224P</span><span class="op" id="4154329">[</span><span class="ident" id="4154330">i</span><span class="op" id="4154331">]</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4154334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4154338">//&nbsp;If&nbsp;either&nbsp;isZero&nbsp;or&nbsp;isP&nbsp;is&nbsp;0,&nbsp;then&nbsp;we&nbsp;should&nbsp;return&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154397">isZero</span>&nbsp;<span class="op" id="4154404">|=</span>&nbsp;<span class="ident" id="4154407">isZero</span>&nbsp;<span class="op" id="4154414">&gt;&gt;</span>&nbsp;<span class="num" id="4154417">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154421">isZero</span>&nbsp;<span class="op" id="4154428">|=</span>&nbsp;<span class="ident" id="4154431">isZero</span>&nbsp;<span class="op" id="4154438">&gt;&gt;</span>&nbsp;<span class="num" id="4154441">8</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154444">isZero</span>&nbsp;<span class="op" id="4154451">|=</span>&nbsp;<span class="ident" id="4154454">isZero</span>&nbsp;<span class="op" id="4154461">&gt;&gt;</span>&nbsp;<span class="num" id="4154464">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154467">isZero</span>&nbsp;<span class="op" id="4154474">|=</span>&nbsp;<span class="ident" id="4154477">isZero</span>&nbsp;<span class="op" id="4154484">&gt;&gt;</span>&nbsp;<span class="num" id="4154487">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154490">isZero</span>&nbsp;<span class="op" id="4154497">|=</span>&nbsp;<span class="ident" id="4154500">isZero</span>&nbsp;<span class="op" id="4154507">&gt;&gt;</span>&nbsp;<span class="num" id="4154510">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154514">isP</span>&nbsp;<span class="op" id="4154518">|=</span>&nbsp;<span class="ident" id="4154521">isP</span>&nbsp;<span class="op" id="4154525">&gt;&gt;</span>&nbsp;<span class="num" id="4154528">16</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154532">isP</span>&nbsp;<span class="op" id="4154536">|=</span>&nbsp;<span class="ident" id="4154539">isP</span>&nbsp;<span class="op" id="4154543">&gt;&gt;</span>&nbsp;<span class="num" id="4154546">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154549">isP</span>&nbsp;<span class="op" id="4154553">|=</span>&nbsp;<span class="ident" id="4154556">isP</span>&nbsp;<span class="op" id="4154560">&gt;&gt;</span>&nbsp;<span class="num" id="4154563">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154566">isP</span>&nbsp;<span class="op" id="4154570">|=</span>&nbsp;<span class="ident" id="4154573">isP</span>&nbsp;<span class="op" id="4154577">&gt;&gt;</span>&nbsp;<span class="num" id="4154580">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154583">isP</span>&nbsp;<span class="op" id="4154587">|=</span>&nbsp;<span class="ident" id="4154590">isP</span>&nbsp;<span class="op" id="4154594">&gt;&gt;</span>&nbsp;<span class="num" id="4154597">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4154601">//&nbsp;For&nbsp;isZero&nbsp;and&nbsp;isP,&nbsp;the&nbsp;LSB&nbsp;is&nbsp;0&nbsp;iff&nbsp;all&nbsp;the&nbsp;bits&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154665">result</span>&nbsp;<span class="op" id="4154672">:=</span>&nbsp;<span class="ident" id="4154675">isZero</span>&nbsp;<span class="op" id="4154682">&amp;</span>&nbsp;<span class="ident" id="4154684">isP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154689">result</span>&nbsp;<span class="op" id="4154696">=</span>&nbsp;<span class="op" id="4154698">(</span><span class="op" id="4154699">^</span><span class="ident" id="4154700">result</span><span class="op" id="4154706">)</span>&nbsp;<span class="op" id="4154708">&amp;</span>&nbsp;<span class="num" id="4154710">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4154714">return</span>&nbsp;<span class="ident" id="4154721">result</span><br>
<span class="lineno">175</span><span class="op" id="4154728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4154731">//&nbsp;p224Add&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+b</span><br>
<span class="lineno"></span><span class="comment" id="4154762">//</span><br>
<span class="lineno"></span><span class="comment" id="4154765">//&nbsp;a[i]&nbsp;+&nbsp;b[i]&nbsp;&lt;&nbsp;2**32</span><br>
<span class="lineno">180</span><span class="keyword" id="4154788">func</span>&nbsp;<span class="ident" id="4154793">p224Add</span><span class="op" id="4154800">(</span><span class="ident" id="4154801">out</span><span class="op" id="4154804">,</span>&nbsp;<span class="ident" id="4154806">a</span><span class="op" id="4154807">,</span>&nbsp;<span class="ident" id="4154809">b</span>&nbsp;<span class="op" id="4154811">*</span><span class="ident" id="4154812">p224FieldElement</span><span class="op" id="4154828">)</span>&nbsp;<span class="op" id="4154830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4154833">for</span>&nbsp;<span class="ident" id="4154837">i</span>&nbsp;<span class="op" id="4154839">:=</span>&nbsp;<span class="num" id="4154842">0</span><span class="op" id="4154843">;</span>&nbsp;<span class="ident" id="4154845">i</span>&nbsp;<span class="op" id="4154847">&lt;</span>&nbsp;<span class="num" id="4154849">8</span><span class="op" id="4154850">;</span>&nbsp;<span class="ident" id="4154852">i</span><span class="op" id="4154853">++</span>&nbsp;<span class="op" id="4154856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154860">out</span><span class="op" id="4154863">[</span><span class="ident" id="4154864">i</span><span class="op" id="4154865">]</span>&nbsp;<span class="op" id="4154867">=</span>&nbsp;<span class="ident" id="4154869">a</span><span class="op" id="4154870">[</span><span class="ident" id="4154871">i</span><span class="op" id="4154872">]</span>&nbsp;<span class="op" id="4154874">+</span>&nbsp;<span class="ident" id="4154876">b</span><span class="op" id="4154877">[</span><span class="ident" id="4154878">i</span><span class="op" id="4154879">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4154882">}</span><br>
<span class="lineno"></span><span class="op" id="4154884">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="4154887">const</span>&nbsp;<span class="ident" id="4154893">two31p3</span>&nbsp;<span class="op" id="4154901">=</span>&nbsp;<span class="num" id="4154903">1</span><span class="op" id="4154904">&lt;&lt;</span><span class="num" id="4154906">31</span>&nbsp;<span class="op" id="4154909">+</span>&nbsp;<span class="num" id="4154911">1</span><span class="op" id="4154912">&lt;&lt;</span><span class="num" id="4154914">3</span><br>
<span class="lineno"></span><span class="keyword" id="4154916">const</span>&nbsp;<span class="ident" id="4154922">two31m3</span>&nbsp;<span class="op" id="4154930">=</span>&nbsp;<span class="num" id="4154932">1</span><span class="op" id="4154933">&lt;&lt;</span><span class="num" id="4154935">31</span>&nbsp;<span class="op" id="4154938">-</span>&nbsp;<span class="num" id="4154940">1</span><span class="op" id="4154941">&lt;&lt;</span><span class="num" id="4154943">3</span><br>
<span class="lineno"></span><span class="keyword" id="4154945">const</span>&nbsp;<span class="ident" id="4154951">two31m15m3</span>&nbsp;<span class="op" id="4154962">=</span>&nbsp;<span class="num" id="4154964">1</span><span class="op" id="4154965">&lt;&lt;</span><span class="num" id="4154967">31</span>&nbsp;<span class="op" id="4154970">-</span>&nbsp;<span class="num" id="4154972">1</span><span class="op" id="4154973">&lt;&lt;</span><span class="num" id="4154975">15</span>&nbsp;<span class="op" id="4154978">-</span>&nbsp;<span class="num" id="4154980">1</span><span class="op" id="4154981">&lt;&lt;</span><span class="num" id="4154983">3</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="4154986">//&nbsp;p224ZeroModP31&nbsp;is&nbsp;0&nbsp;mod&nbsp;p&nbsp;where&nbsp;bit&nbsp;31&nbsp;is&nbsp;set&nbsp;in&nbsp;all&nbsp;limbs&nbsp;so&nbsp;that&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span><span class="comment" id="4155063">//&nbsp;subtract&nbsp;smaller&nbsp;amounts&nbsp;without&nbsp;underflow.&nbsp;See&nbsp;the&nbsp;section&nbsp;&#34;Subtraction&#34;&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4155143">//&nbsp;[1]&nbsp;for&nbsp;reasoning.</span><br>
<span class="lineno"></span><span class="keyword" id="4155165">var</span>&nbsp;<span class="ident" id="4155169">p224ZeroModP31</span>&nbsp;<span class="op" id="4155184">=</span>&nbsp;<span class="op" id="4155186">[</span><span class="op" id="4155187">]</span><span class="builtintype" id="4155188">uint32</span><span class="op" id="4155194">{</span><span class="ident" id="4155195">two31p3</span><span class="op" id="4155202">,</span>&nbsp;<span class="ident" id="4155204">two31m3</span><span class="op" id="4155211">,</span>&nbsp;<span class="ident" id="4155213">two31m3</span><span class="op" id="4155220">,</span>&nbsp;<span class="ident" id="4155222">two31m15m3</span><span class="op" id="4155232">,</span>&nbsp;<span class="ident" id="4155234">two31m3</span><span class="op" id="4155241">,</span>&nbsp;<span class="ident" id="4155243">two31m3</span><span class="op" id="4155250">,</span>&nbsp;<span class="ident" id="4155252">two31m3</span><span class="op" id="4155259">,</span>&nbsp;<span class="ident" id="4155261">two31m3</span><span class="op" id="4155268">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="4155271">//&nbsp;p224Sub&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a-b</span><br>
<span class="lineno"></span><span class="comment" id="4155302">//</span><br>
<span class="lineno"></span><span class="comment" id="4155305">//&nbsp;a[i],&nbsp;b[i]&nbsp;&lt;&nbsp;2**30</span><br>
<span class="lineno"></span><span class="comment" id="4155327">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**32</span><br>
<span class="lineno"></span><span class="keyword" id="4155345">func</span>&nbsp;<span class="ident" id="4155350">p224Sub</span><span class="op" id="4155357">(</span><span class="ident" id="4155358">out</span><span class="op" id="4155361">,</span>&nbsp;<span class="ident" id="4155363">a</span><span class="op" id="4155364">,</span>&nbsp;<span class="ident" id="4155366">b</span>&nbsp;<span class="op" id="4155368">*</span><span class="ident" id="4155369">p224FieldElement</span><span class="op" id="4155385">)</span>&nbsp;<span class="op" id="4155387">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4155390">for</span>&nbsp;<span class="ident" id="4155394">i</span>&nbsp;<span class="op" id="4155396">:=</span>&nbsp;<span class="num" id="4155399">0</span><span class="op" id="4155400">;</span>&nbsp;<span class="ident" id="4155402">i</span>&nbsp;<span class="op" id="4155404">&lt;</span>&nbsp;<span class="num" id="4155406">8</span><span class="op" id="4155407">;</span>&nbsp;<span class="ident" id="4155409">i</span><span class="op" id="4155410">++</span>&nbsp;<span class="op" id="4155413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155417">out</span><span class="op" id="4155420">[</span><span class="ident" id="4155421">i</span><span class="op" id="4155422">]</span>&nbsp;<span class="op" id="4155424">=</span>&nbsp;<span class="ident" id="4155426">a</span><span class="op" id="4155427">[</span><span class="ident" id="4155428">i</span><span class="op" id="4155429">]</span>&nbsp;<span class="op" id="4155431">+</span>&nbsp;<span class="ident" id="4155433">p224ZeroModP31</span><span class="op" id="4155447">[</span><span class="ident" id="4155448">i</span><span class="op" id="4155449">]</span>&nbsp;<span class="op" id="4155451">-</span>&nbsp;<span class="ident" id="4155453">b</span><span class="op" id="4155454">[</span><span class="ident" id="4155455">i</span><span class="op" id="4155456">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4155459">}</span><br>
<span class="lineno"></span><span class="op" id="4155461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="4155464">//&nbsp;LargeFieldElement&nbsp;also&nbsp;represents&nbsp;an&nbsp;element&nbsp;of&nbsp;the&nbsp;field.&nbsp;The&nbsp;limbs&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4155540">//&nbsp;still&nbsp;spaced&nbsp;28-bits&nbsp;apart&nbsp;and&nbsp;in&nbsp;little-endian&nbsp;order.&nbsp;So&nbsp;the&nbsp;limbs&nbsp;are&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="4155618">//&nbsp;0,&nbsp;28,&nbsp;56,&nbsp;...,&nbsp;392&nbsp;bits,&nbsp;each&nbsp;64-bits&nbsp;wide.</span><br>
<span class="lineno"></span><span class="keyword" id="4155666">type</span>&nbsp;<span class="ident" id="4155671">p224LargeFieldElement</span>&nbsp;<span class="op" id="4155693">[</span><span class="num" id="4155694">15</span><span class="op" id="4155696">]</span><span class="ident" id="4155697">uint64</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span><span class="keyword" id="4155705">const</span>&nbsp;<span class="ident" id="4155711">two63p35</span>&nbsp;<span class="op" id="4155720">=</span>&nbsp;<span class="num" id="4155722">1</span><span class="op" id="4155723">&lt;&lt;</span><span class="num" id="4155725">63</span>&nbsp;<span class="op" id="4155728">+</span>&nbsp;<span class="num" id="4155730">1</span><span class="op" id="4155731">&lt;&lt;</span><span class="num" id="4155733">35</span><br>
<span class="lineno"></span><span class="keyword" id="4155736">const</span>&nbsp;<span class="ident" id="4155742">two63m35</span>&nbsp;<span class="op" id="4155751">=</span>&nbsp;<span class="num" id="4155753">1</span><span class="op" id="4155754">&lt;&lt;</span><span class="num" id="4155756">63</span>&nbsp;<span class="op" id="4155759">-</span>&nbsp;<span class="num" id="4155761">1</span><span class="op" id="4155762">&lt;&lt;</span><span class="num" id="4155764">35</span><br>
<span class="lineno"></span><span class="keyword" id="4155767">const</span>&nbsp;<span class="ident" id="4155773">two63m35m19</span>&nbsp;<span class="op" id="4155785">=</span>&nbsp;<span class="num" id="4155787">1</span><span class="op" id="4155788">&lt;&lt;</span><span class="num" id="4155790">63</span>&nbsp;<span class="op" id="4155793">-</span>&nbsp;<span class="num" id="4155795">1</span><span class="op" id="4155796">&lt;&lt;</span><span class="num" id="4155798">35</span>&nbsp;<span class="op" id="4155801">-</span>&nbsp;<span class="num" id="4155803">1</span><span class="op" id="4155804">&lt;&lt;</span><span class="num" id="4155806">19</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4155810">//&nbsp;p224ZeroModP63&nbsp;is&nbsp;0&nbsp;mod&nbsp;p&nbsp;where&nbsp;bit&nbsp;63&nbsp;is&nbsp;set&nbsp;in&nbsp;all&nbsp;limbs.&nbsp;See&nbsp;the&nbsp;section</span><br>
<span class="lineno">215</span><span class="comment" id="4155889">//&nbsp;&#34;Subtraction&#34;&nbsp;in&nbsp;[1]&nbsp;for&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="4155922">var</span>&nbsp;<span class="ident" id="4155926">p224ZeroModP63</span>&nbsp;<span class="op" id="4155941">=</span>&nbsp;<span class="op" id="4155943">[</span><span class="num" id="4155944">8</span><span class="op" id="4155945">]</span><span class="ident" id="4155946">uint64</span><span class="op" id="4155952">{</span><span class="ident" id="4155953">two63p35</span><span class="op" id="4155961">,</span>&nbsp;<span class="ident" id="4155963">two63m35</span><span class="op" id="4155971">,</span>&nbsp;<span class="ident" id="4155973">two63m35</span><span class="op" id="4155981">,</span>&nbsp;<span class="ident" id="4155983">two63m35</span><span class="op" id="4155991">,</span>&nbsp;<span class="ident" id="4155993">two63m35m19</span><span class="op" id="4156004">,</span>&nbsp;<span class="ident" id="4156006">two63m35</span><span class="op" id="4156014">,</span>&nbsp;<span class="ident" id="4156016">two63m35</span><span class="op" id="4156024">,</span>&nbsp;<span class="ident" id="4156026">two63m35</span><span class="op" id="4156034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4156037">const</span>&nbsp;<span class="ident" id="4156043">bottom12Bits</span>&nbsp;<span class="op" id="4156056">=</span>&nbsp;<span class="num" id="4156058">0xfff</span><br>
<span class="lineno"></span><span class="keyword" id="4156064">const</span>&nbsp;<span class="ident" id="4156070">bottom28Bits</span>&nbsp;<span class="op" id="4156083">=</span>&nbsp;<span class="num" id="4156085">0xfffffff</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="4156096">//&nbsp;p224Mul&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a*b</span><br>
<span class="lineno"></span><span class="comment" id="4156127">//</span><br>
<span class="lineno"></span><span class="comment" id="4156130">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29,&nbsp;b[i]&nbsp;&lt;&nbsp;2**30&nbsp;(or&nbsp;vice&nbsp;versa)</span><br>
<span class="lineno"></span><span class="comment" id="4156176">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">225</span><span class="keyword" id="4156194">func</span>&nbsp;<span class="ident" id="4156199">p224Mul</span><span class="op" id="4156206">(</span><span class="ident" id="4156207">out</span><span class="op" id="4156210">,</span>&nbsp;<span class="ident" id="4156212">a</span><span class="op" id="4156213">,</span>&nbsp;<span class="ident" id="4156215">b</span>&nbsp;<span class="op" id="4156217">*</span><span class="ident" id="4156218">p224FieldElement</span><span class="op" id="4156234">,</span>&nbsp;<span class="ident" id="4156236">tmp</span>&nbsp;<span class="op" id="4156240">*</span><span class="ident" id="4156241">p224LargeFieldElement</span><span class="op" id="4156262">)</span>&nbsp;<span class="op" id="4156264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4156267">for</span>&nbsp;<span class="ident" id="4156271">i</span>&nbsp;<span class="op" id="4156273">:=</span>&nbsp;<span class="num" id="4156276">0</span><span class="op" id="4156277">;</span>&nbsp;<span class="ident" id="4156279">i</span>&nbsp;<span class="op" id="4156281">&lt;</span>&nbsp;<span class="num" id="4156283">15</span><span class="op" id="4156285">;</span>&nbsp;<span class="ident" id="4156287">i</span><span class="op" id="4156288">++</span>&nbsp;<span class="op" id="4156291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156295">tmp</span><span class="op" id="4156298">[</span><span class="ident" id="4156299">i</span><span class="op" id="4156300">]</span>&nbsp;<span class="op" id="4156302">=</span>&nbsp;<span class="num" id="4156304">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4156307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4156311">for</span>&nbsp;<span class="ident" id="4156315">i</span>&nbsp;<span class="op" id="4156317">:=</span>&nbsp;<span class="num" id="4156320">0</span><span class="op" id="4156321">;</span>&nbsp;<span class="ident" id="4156323">i</span>&nbsp;<span class="op" id="4156325">&lt;</span>&nbsp;<span class="num" id="4156327">8</span><span class="op" id="4156328">;</span>&nbsp;<span class="ident" id="4156330">i</span><span class="op" id="4156331">++</span>&nbsp;<span class="op" id="4156334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4156338">for</span>&nbsp;<span class="ident" id="4156342">j</span>&nbsp;<span class="op" id="4156344">:=</span>&nbsp;<span class="num" id="4156347">0</span><span class="op" id="4156348">;</span>&nbsp;<span class="ident" id="4156350">j</span>&nbsp;<span class="op" id="4156352">&lt;</span>&nbsp;<span class="num" id="4156354">8</span><span class="op" id="4156355">;</span>&nbsp;<span class="ident" id="4156357">j</span><span class="op" id="4156358">++</span>&nbsp;<span class="op" id="4156361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156366">tmp</span><span class="op" id="4156369">[</span><span class="ident" id="4156370">i</span><span class="op" id="4156371">+</span><span class="ident" id="4156372">j</span><span class="op" id="4156373">]</span>&nbsp;<span class="op" id="4156375">+=</span>&nbsp;<span class="ident" id="4156378">uint64</span><span class="op" id="4156384">(</span><span class="ident" id="4156385">a</span><span class="op" id="4156386">[</span><span class="ident" id="4156387">i</span><span class="op" id="4156388">]</span><span class="op" id="4156389">)</span>&nbsp;<span class="op" id="4156391">*</span>&nbsp;<span class="ident" id="4156393">uint64</span><span class="op" id="4156399">(</span><span class="ident" id="4156400">b</span><span class="op" id="4156401">[</span><span class="ident" id="4156402">j</span><span class="op" id="4156403">]</span><span class="op" id="4156404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4156408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4156411">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156415">p224ReduceLarge</span><span class="op" id="4156430">(</span><span class="ident" id="4156431">out</span><span class="op" id="4156434">,</span>&nbsp;<span class="ident" id="4156436">tmp</span><span class="op" id="4156439">)</span><br>
<span class="lineno"></span><span class="op" id="4156441">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4156444">//&nbsp;Square&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a*a</span><br>
<span class="lineno">240</span><span class="comment" id="4156474">//</span><br>
<span class="lineno"></span><span class="comment" id="4156477">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="comment" id="4156493">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="keyword" id="4156511">func</span>&nbsp;<span class="ident" id="4156516">p224Square</span><span class="op" id="4156526">(</span><span class="ident" id="4156527">out</span><span class="op" id="4156530">,</span>&nbsp;<span class="ident" id="4156532">a</span>&nbsp;<span class="op" id="4156534">*</span><span class="ident" id="4156535">p224FieldElement</span><span class="op" id="4156551">,</span>&nbsp;<span class="ident" id="4156553">tmp</span>&nbsp;<span class="op" id="4156557">*</span><span class="ident" id="4156558">p224LargeFieldElement</span><span class="op" id="4156579">)</span>&nbsp;<span class="op" id="4156581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4156584">for</span>&nbsp;<span class="ident" id="4156588">i</span>&nbsp;<span class="op" id="4156590">:=</span>&nbsp;<span class="num" id="4156593">0</span><span class="op" id="4156594">;</span>&nbsp;<span class="ident" id="4156596">i</span>&nbsp;<span class="op" id="4156598">&lt;</span>&nbsp;<span class="num" id="4156600">15</span><span class="op" id="4156602">;</span>&nbsp;<span class="ident" id="4156604">i</span><span class="op" id="4156605">++</span>&nbsp;<span class="op" id="4156608">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156612">tmp</span><span class="op" id="4156615">[</span><span class="ident" id="4156616">i</span><span class="op" id="4156617">]</span>&nbsp;<span class="op" id="4156619">=</span>&nbsp;<span class="num" id="4156621">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4156624">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4156628">for</span>&nbsp;<span class="ident" id="4156632">i</span>&nbsp;<span class="op" id="4156634">:=</span>&nbsp;<span class="num" id="4156637">0</span><span class="op" id="4156638">;</span>&nbsp;<span class="ident" id="4156640">i</span>&nbsp;<span class="op" id="4156642">&lt;</span>&nbsp;<span class="num" id="4156644">8</span><span class="op" id="4156645">;</span>&nbsp;<span class="ident" id="4156647">i</span><span class="op" id="4156648">++</span>&nbsp;<span class="op" id="4156651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4156655">for</span>&nbsp;<span class="ident" id="4156659">j</span>&nbsp;<span class="op" id="4156661">:=</span>&nbsp;<span class="num" id="4156664">0</span><span class="op" id="4156665">;</span>&nbsp;<span class="ident" id="4156667">j</span>&nbsp;<span class="op" id="4156669">&lt;=</span>&nbsp;<span class="ident" id="4156672">i</span><span class="op" id="4156673">;</span>&nbsp;<span class="ident" id="4156675">j</span><span class="op" id="4156676">++</span>&nbsp;<span class="op" id="4156679">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156684">r</span>&nbsp;<span class="op" id="4156686">:=</span>&nbsp;<span class="ident" id="4156689">uint64</span><span class="op" id="4156695">(</span><span class="ident" id="4156696">a</span><span class="op" id="4156697">[</span><span class="ident" id="4156698">i</span><span class="op" id="4156699">]</span><span class="op" id="4156700">)</span>&nbsp;<span class="op" id="4156702">*</span>&nbsp;<span class="ident" id="4156704">uint64</span><span class="op" id="4156710">(</span><span class="ident" id="4156711">a</span><span class="op" id="4156712">[</span><span class="ident" id="4156713">j</span><span class="op" id="4156714">]</span><span class="op" id="4156715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4156720">if</span>&nbsp;<span class="ident" id="4156723">i</span>&nbsp;<span class="op" id="4156725">==</span>&nbsp;<span class="ident" id="4156728">j</span>&nbsp;<span class="op" id="4156730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156736">tmp</span><span class="op" id="4156739">[</span><span class="ident" id="4156740">i</span><span class="op" id="4156741">+</span><span class="ident" id="4156742">j</span><span class="op" id="4156743">]</span>&nbsp;<span class="op" id="4156745">+=</span>&nbsp;<span class="ident" id="4156748">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4156753">}</span>&nbsp;<span class="keyword" id="4156755">else</span>&nbsp;<span class="op" id="4156760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156766">tmp</span><span class="op" id="4156769">[</span><span class="ident" id="4156770">i</span><span class="op" id="4156771">+</span><span class="ident" id="4156772">j</span><span class="op" id="4156773">]</span>&nbsp;<span class="op" id="4156775">+=</span>&nbsp;<span class="ident" id="4156778">r</span>&nbsp;<span class="op" id="4156780">&lt;&lt;</span>&nbsp;<span class="num" id="4156783">1</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4156788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4156792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4156795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156799">p224ReduceLarge</span><span class="op" id="4156814">(</span><span class="ident" id="4156815">out</span><span class="op" id="4156818">,</span>&nbsp;<span class="ident" id="4156820">tmp</span><span class="op" id="4156823">)</span><br>
<span class="lineno">260</span><span class="op" id="4156825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4156828">//&nbsp;ReduceLarge&nbsp;converts&nbsp;a&nbsp;p224LargeFieldElement&nbsp;to&nbsp;a&nbsp;p224FieldElement.</span><br>
<span class="lineno"></span><span class="comment" id="4156899">//</span><br>
<span class="lineno"></span><span class="comment" id="4156902">//&nbsp;in[i]&nbsp;&lt;&nbsp;2**62</span><br>
<span class="lineno">265</span><span class="keyword" id="4156919">func</span>&nbsp;<span class="ident" id="4156924">p224ReduceLarge</span><span class="op" id="4156939">(</span><span class="ident" id="4156940">out</span>&nbsp;<span class="op" id="4156944">*</span><span class="ident" id="4156945">p224FieldElement</span><span class="op" id="4156961">,</span>&nbsp;<span class="ident" id="4156963">in</span>&nbsp;<span class="op" id="4156966">*</span><span class="ident" id="4156967">p224LargeFieldElement</span><span class="op" id="4156988">)</span>&nbsp;<span class="op" id="4156990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4156993">for</span>&nbsp;<span class="ident" id="4156997">i</span>&nbsp;<span class="op" id="4156999">:=</span>&nbsp;<span class="num" id="4157002">0</span><span class="op" id="4157003">;</span>&nbsp;<span class="ident" id="4157005">i</span>&nbsp;<span class="op" id="4157007">&lt;</span>&nbsp;<span class="num" id="4157009">8</span><span class="op" id="4157010">;</span>&nbsp;<span class="ident" id="4157012">i</span><span class="op" id="4157013">++</span>&nbsp;<span class="op" id="4157016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157020">in</span><span class="op" id="4157022">[</span><span class="ident" id="4157023">i</span><span class="op" id="4157024">]</span>&nbsp;<span class="op" id="4157026">+=</span>&nbsp;<span class="ident" id="4157029">p224ZeroModP63</span><span class="op" id="4157043">[</span><span class="ident" id="4157044">i</span><span class="op" id="4157045">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4157048">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4157052">//&nbsp;Eliminate&nbsp;the&nbsp;coefficients&nbsp;at&nbsp;2**224&nbsp;and&nbsp;greater.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157106">for</span>&nbsp;<span class="ident" id="4157110">i</span>&nbsp;<span class="op" id="4157112">:=</span>&nbsp;<span class="num" id="4157115">14</span><span class="op" id="4157117">;</span>&nbsp;<span class="ident" id="4157119">i</span>&nbsp;<span class="op" id="4157121">&gt;=</span>&nbsp;<span class="num" id="4157124">8</span><span class="op" id="4157125">;</span>&nbsp;<span class="ident" id="4157127">i</span><span class="op" id="4157128">--</span>&nbsp;<span class="op" id="4157131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157135">in</span><span class="op" id="4157137">[</span><span class="ident" id="4157138">i</span><span class="op" id="4157139">-</span><span class="num" id="4157140">8</span><span class="op" id="4157141">]</span>&nbsp;<span class="op" id="4157143">-=</span>&nbsp;<span class="ident" id="4157146">in</span><span class="op" id="4157148">[</span><span class="ident" id="4157149">i</span><span class="op" id="4157150">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157154">in</span><span class="op" id="4157156">[</span><span class="ident" id="4157157">i</span><span class="op" id="4157158">-</span><span class="num" id="4157159">5</span><span class="op" id="4157160">]</span>&nbsp;<span class="op" id="4157162">+=</span>&nbsp;<span class="op" id="4157165">(</span><span class="ident" id="4157166">in</span><span class="op" id="4157168">[</span><span class="ident" id="4157169">i</span><span class="op" id="4157170">]</span>&nbsp;<span class="op" id="4157172">&amp;</span>&nbsp;<span class="num" id="4157174">0xffff</span><span class="op" id="4157180">)</span>&nbsp;<span class="op" id="4157182">&lt;&lt;</span>&nbsp;<span class="num" id="4157185">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157190">in</span><span class="op" id="4157192">[</span><span class="ident" id="4157193">i</span><span class="op" id="4157194">-</span><span class="num" id="4157195">4</span><span class="op" id="4157196">]</span>&nbsp;<span class="op" id="4157198">+=</span>&nbsp;<span class="ident" id="4157201">in</span><span class="op" id="4157203">[</span><span class="ident" id="4157204">i</span><span class="op" id="4157205">]</span>&nbsp;<span class="op" id="4157207">&gt;&gt;</span>&nbsp;<span class="num" id="4157210">16</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4157214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157217">in</span><span class="op" id="4157219">[</span><span class="num" id="4157220">8</span><span class="op" id="4157221">]</span>&nbsp;<span class="op" id="4157223">=</span>&nbsp;<span class="num" id="4157225">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4157228">//&nbsp;in[0..8]&nbsp;&lt;&nbsp;2**64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4157250">//&nbsp;As&nbsp;the&nbsp;values&nbsp;become&nbsp;small&nbsp;enough,&nbsp;we&nbsp;start&nbsp;to&nbsp;store&nbsp;them&nbsp;in&nbsp;|out|</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4157321">//&nbsp;and&nbsp;use&nbsp;32-bit&nbsp;operations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157352">for</span>&nbsp;<span class="ident" id="4157356">i</span>&nbsp;<span class="op" id="4157358">:=</span>&nbsp;<span class="num" id="4157361">1</span><span class="op" id="4157362">;</span>&nbsp;<span class="ident" id="4157364">i</span>&nbsp;<span class="op" id="4157366">&lt;</span>&nbsp;<span class="num" id="4157368">8</span><span class="op" id="4157369">;</span>&nbsp;<span class="ident" id="4157371">i</span><span class="op" id="4157372">++</span>&nbsp;<span class="op" id="4157375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157379">in</span><span class="op" id="4157381">[</span><span class="ident" id="4157382">i</span><span class="op" id="4157383">+</span><span class="num" id="4157384">1</span><span class="op" id="4157385">]</span>&nbsp;<span class="op" id="4157387">+=</span>&nbsp;<span class="ident" id="4157390">in</span><span class="op" id="4157392">[</span><span class="ident" id="4157393">i</span><span class="op" id="4157394">]</span>&nbsp;<span class="op" id="4157396">&gt;&gt;</span>&nbsp;<span class="num" id="4157399">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157404">out</span><span class="op" id="4157407">[</span><span class="ident" id="4157408">i</span><span class="op" id="4157409">]</span>&nbsp;<span class="op" id="4157411">=</span>&nbsp;<span class="builtintype" id="4157413">uint32</span><span class="op" id="4157419">(</span><span class="ident" id="4157420">in</span><span class="op" id="4157422">[</span><span class="ident" id="4157423">i</span><span class="op" id="4157424">]</span>&nbsp;<span class="op" id="4157426">&amp;</span>&nbsp;<span class="ident" id="4157428">bottom28Bits</span><span class="op" id="4157440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4157443">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157446">in</span><span class="op" id="4157448">[</span><span class="num" id="4157449">0</span><span class="op" id="4157450">]</span>&nbsp;<span class="op" id="4157452">-=</span>&nbsp;<span class="ident" id="4157455">in</span><span class="op" id="4157457">[</span><span class="num" id="4157458">8</span><span class="op" id="4157459">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157462">out</span><span class="op" id="4157465">[</span><span class="num" id="4157466">3</span><span class="op" id="4157467">]</span>&nbsp;<span class="op" id="4157469">+=</span>&nbsp;<span class="builtintype" id="4157472">uint32</span><span class="op" id="4157478">(</span><span class="ident" id="4157479">in</span><span class="op" id="4157481">[</span><span class="num" id="4157482">8</span><span class="op" id="4157483">]</span><span class="op" id="4157484">&amp;</span><span class="num" id="4157485">0xffff</span><span class="op" id="4157491">)</span>&nbsp;<span class="op" id="4157493">&lt;&lt;</span>&nbsp;<span class="num" id="4157496">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157500">out</span><span class="op" id="4157503">[</span><span class="num" id="4157504">4</span><span class="op" id="4157505">]</span>&nbsp;<span class="op" id="4157507">+=</span>&nbsp;<span class="builtintype" id="4157510">uint32</span><span class="op" id="4157516">(</span><span class="ident" id="4157517">in</span><span class="op" id="4157519">[</span><span class="num" id="4157520">8</span><span class="op" id="4157521">]</span>&nbsp;<span class="op" id="4157523">&gt;&gt;</span>&nbsp;<span class="num" id="4157526">16</span><span class="op" id="4157528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4157531">//&nbsp;in[0]&nbsp;&lt;&nbsp;2**64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4157549">//&nbsp;out[3]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4157568">//&nbsp;out[4]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4157587">//&nbsp;out[1,2,5..7]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157614">out</span><span class="op" id="4157617">[</span><span class="num" id="4157618">0</span><span class="op" id="4157619">]</span>&nbsp;<span class="op" id="4157621">=</span>&nbsp;<span class="builtintype" id="4157623">uint32</span><span class="op" id="4157629">(</span><span class="ident" id="4157630">in</span><span class="op" id="4157632">[</span><span class="num" id="4157633">0</span><span class="op" id="4157634">]</span>&nbsp;<span class="op" id="4157636">&amp;</span>&nbsp;<span class="ident" id="4157638">bottom28Bits</span><span class="op" id="4157650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157653">out</span><span class="op" id="4157656">[</span><span class="num" id="4157657">1</span><span class="op" id="4157658">]</span>&nbsp;<span class="op" id="4157660">+=</span>&nbsp;<span class="builtintype" id="4157663">uint32</span><span class="op" id="4157669">(</span><span class="op" id="4157670">(</span><span class="ident" id="4157671">in</span><span class="op" id="4157673">[</span><span class="num" id="4157674">0</span><span class="op" id="4157675">]</span>&nbsp;<span class="op" id="4157677">&gt;&gt;</span>&nbsp;<span class="num" id="4157680">28</span><span class="op" id="4157682">)</span>&nbsp;<span class="op" id="4157684">&amp;</span>&nbsp;<span class="ident" id="4157686">bottom28Bits</span><span class="op" id="4157698">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157701">out</span><span class="op" id="4157704">[</span><span class="num" id="4157705">2</span><span class="op" id="4157706">]</span>&nbsp;<span class="op" id="4157708">+=</span>&nbsp;<span class="builtintype" id="4157711">uint32</span><span class="op" id="4157717">(</span><span class="ident" id="4157718">in</span><span class="op" id="4157720">[</span><span class="num" id="4157721">0</span><span class="op" id="4157722">]</span>&nbsp;<span class="op" id="4157724">&gt;&gt;</span>&nbsp;<span class="num" id="4157727">56</span><span class="op" id="4157729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4157732">//&nbsp;out[0]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4157751">//&nbsp;out[1..4]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4157773">//&nbsp;out[5..7]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><span class="op" id="4157794">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="4157797">//&nbsp;Reduce&nbsp;reduces&nbsp;the&nbsp;coefficients&nbsp;of&nbsp;a&nbsp;to&nbsp;smaller&nbsp;bounds.</span><br>
<span class="lineno"></span><span class="comment" id="4157856">//</span><br>
<span class="lineno"></span><span class="comment" id="4157859">//&nbsp;On&nbsp;entry:&nbsp;a[i]&nbsp;&lt;&nbsp;2**31&nbsp;+&nbsp;2**30</span><br>
<span class="lineno"></span><span class="comment" id="4157893">//&nbsp;On&nbsp;exit:&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">305</span><span class="keyword" id="4157918">func</span>&nbsp;<span class="ident" id="4157923">p224Reduce</span><span class="op" id="4157933">(</span><span class="ident" id="4157934">a</span>&nbsp;<span class="op" id="4157936">*</span><span class="ident" id="4157937">p224FieldElement</span><span class="op" id="4157953">)</span>&nbsp;<span class="op" id="4157955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157958">for</span>&nbsp;<span class="ident" id="4157962">i</span>&nbsp;<span class="op" id="4157964">:=</span>&nbsp;<span class="num" id="4157967">0</span><span class="op" id="4157968">;</span>&nbsp;<span class="ident" id="4157970">i</span>&nbsp;<span class="op" id="4157972">&lt;</span>&nbsp;<span class="num" id="4157974">7</span><span class="op" id="4157975">;</span>&nbsp;<span class="ident" id="4157977">i</span><span class="op" id="4157978">++</span>&nbsp;<span class="op" id="4157981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157985">a</span><span class="op" id="4157986">[</span><span class="ident" id="4157987">i</span><span class="op" id="4157988">+</span><span class="num" id="4157989">1</span><span class="op" id="4157990">]</span>&nbsp;<span class="op" id="4157992">+=</span>&nbsp;<span class="ident" id="4157995">a</span><span class="op" id="4157996">[</span><span class="ident" id="4157997">i</span><span class="op" id="4157998">]</span>&nbsp;<span class="op" id="4158000">&gt;&gt;</span>&nbsp;<span class="num" id="4158003">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158008">a</span><span class="op" id="4158009">[</span><span class="ident" id="4158010">i</span><span class="op" id="4158011">]</span>&nbsp;<span class="op" id="4158013">&amp;=</span>&nbsp;<span class="ident" id="4158016">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4158030">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158033">top</span>&nbsp;<span class="op" id="4158037">:=</span>&nbsp;<span class="ident" id="4158040">a</span><span class="op" id="4158041">[</span><span class="num" id="4158042">7</span><span class="op" id="4158043">]</span>&nbsp;<span class="op" id="4158045">&gt;&gt;</span>&nbsp;<span class="num" id="4158048">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158052">a</span><span class="op" id="4158053">[</span><span class="num" id="4158054">7</span><span class="op" id="4158055">]</span>&nbsp;<span class="op" id="4158057">&amp;=</span>&nbsp;<span class="ident" id="4158060">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4158075">//&nbsp;top&nbsp;&lt;&nbsp;2**4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158090">mask</span>&nbsp;<span class="op" id="4158095">:=</span>&nbsp;<span class="ident" id="4158098">top</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158103">mask</span>&nbsp;<span class="op" id="4158108">|=</span>&nbsp;<span class="ident" id="4158111">mask</span>&nbsp;<span class="op" id="4158116">&gt;&gt;</span>&nbsp;<span class="num" id="4158119">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158122">mask</span>&nbsp;<span class="op" id="4158127">|=</span>&nbsp;<span class="ident" id="4158130">mask</span>&nbsp;<span class="op" id="4158135">&gt;&gt;</span>&nbsp;<span class="num" id="4158138">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158141">mask</span>&nbsp;<span class="op" id="4158146">&lt;&lt;=</span>&nbsp;<span class="num" id="4158150">31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158154">mask</span>&nbsp;<span class="op" id="4158159">=</span>&nbsp;<span class="builtintype" id="4158161">uint32</span><span class="op" id="4158167">(</span><span class="builtintype" id="4158168">int32</span><span class="op" id="4158173">(</span><span class="ident" id="4158174">mask</span><span class="op" id="4158178">)</span>&nbsp;<span class="op" id="4158180">&gt;&gt;</span>&nbsp;<span class="num" id="4158183">31</span><span class="op" id="4158185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4158188">//&nbsp;Mask&nbsp;is&nbsp;all&nbsp;ones&nbsp;if&nbsp;top&nbsp;!=&nbsp;0,&nbsp;all&nbsp;zero&nbsp;otherwise</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158242">a</span><span class="op" id="4158243">[</span><span class="num" id="4158244">0</span><span class="op" id="4158245">]</span>&nbsp;<span class="op" id="4158247">-=</span>&nbsp;<span class="ident" id="4158250">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158255">a</span><span class="op" id="4158256">[</span><span class="num" id="4158257">3</span><span class="op" id="4158258">]</span>&nbsp;<span class="op" id="4158260">+=</span>&nbsp;<span class="ident" id="4158263">top</span>&nbsp;<span class="op" id="4158267">&lt;&lt;</span>&nbsp;<span class="num" id="4158270">12</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4158275">//&nbsp;We&nbsp;may&nbsp;have&nbsp;just&nbsp;made&nbsp;a[0]&nbsp;negative&nbsp;but,&nbsp;if&nbsp;we&nbsp;did,&nbsp;then&nbsp;we&nbsp;must</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4158344">//&nbsp;have&nbsp;added&nbsp;something&nbsp;to&nbsp;a[3],&nbsp;this&nbsp;it&#39;s&nbsp;&gt;&nbsp;2**12.&nbsp;Therefore&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4158414">//&nbsp;carry&nbsp;down&nbsp;to&nbsp;a[0].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158438">a</span><span class="op" id="4158439">[</span><span class="num" id="4158440">3</span><span class="op" id="4158441">]</span>&nbsp;<span class="op" id="4158443">-=</span>&nbsp;<span class="num" id="4158446">1</span>&nbsp;<span class="op" id="4158448">&amp;</span>&nbsp;<span class="ident" id="4158450">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158456">a</span><span class="op" id="4158457">[</span><span class="num" id="4158458">2</span><span class="op" id="4158459">]</span>&nbsp;<span class="op" id="4158461">+=</span>&nbsp;<span class="ident" id="4158464">mask</span>&nbsp;<span class="op" id="4158469">&amp;</span>&nbsp;<span class="op" id="4158471">(</span><span class="num" id="4158472">1</span><span class="op" id="4158473">&lt;&lt;</span><span class="num" id="4158475">28</span>&nbsp;<span class="op" id="4158478">-</span>&nbsp;<span class="num" id="4158480">1</span><span class="op" id="4158481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158484">a</span><span class="op" id="4158485">[</span><span class="num" id="4158486">1</span><span class="op" id="4158487">]</span>&nbsp;<span class="op" id="4158489">+=</span>&nbsp;<span class="ident" id="4158492">mask</span>&nbsp;<span class="op" id="4158497">&amp;</span>&nbsp;<span class="op" id="4158499">(</span><span class="num" id="4158500">1</span><span class="op" id="4158501">&lt;&lt;</span><span class="num" id="4158503">28</span>&nbsp;<span class="op" id="4158506">-</span>&nbsp;<span class="num" id="4158508">1</span><span class="op" id="4158509">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158512">a</span><span class="op" id="4158513">[</span><span class="num" id="4158514">0</span><span class="op" id="4158515">]</span>&nbsp;<span class="op" id="4158517">+=</span>&nbsp;<span class="ident" id="4158520">mask</span>&nbsp;<span class="op" id="4158525">&amp;</span>&nbsp;<span class="op" id="4158527">(</span><span class="num" id="4158528">1</span>&nbsp;<span class="op" id="4158530">&lt;&lt;</span>&nbsp;<span class="num" id="4158533">28</span><span class="op" id="4158535">)</span><br>
<span class="lineno"></span><span class="op" id="4158537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4158540">//&nbsp;p224Invert&nbsp;calculates&nbsp;*out&nbsp;=&nbsp;in**-1&nbsp;by&nbsp;computing&nbsp;in**(2**224&nbsp;-&nbsp;2**96&nbsp;-&nbsp;1),</span><br>
<span class="lineno"></span><span class="comment" id="4158618">//&nbsp;i.e.&nbsp;Fermat&#39;s&nbsp;little&nbsp;theorem.</span><br>
<span class="lineno">335</span><span class="keyword" id="4158651">func</span>&nbsp;<span class="ident" id="4158656">p224Invert</span><span class="op" id="4158666">(</span><span class="ident" id="4158667">out</span><span class="op" id="4158670">,</span>&nbsp;<span class="ident" id="4158672">in</span>&nbsp;<span class="op" id="4158675">*</span><span class="ident" id="4158676">p224FieldElement</span><span class="op" id="4158692">)</span>&nbsp;<span class="op" id="4158694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4158697">var</span>&nbsp;<span class="ident" id="4158701">f1</span><span class="op" id="4158703">,</span>&nbsp;<span class="ident" id="4158705">f2</span><span class="op" id="4158707">,</span>&nbsp;<span class="ident" id="4158709">f3</span><span class="op" id="4158711">,</span>&nbsp;<span class="ident" id="4158713">f4</span>&nbsp;<span class="ident" id="4158716">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4158734">var</span>&nbsp;<span class="ident" id="4158738">c</span>&nbsp;<span class="ident" id="4158740">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158764">p224Square</span><span class="op" id="4158774">(</span><span class="op" id="4158775">&amp;</span><span class="ident" id="4158776">f1</span><span class="op" id="4158778">,</span>&nbsp;<span class="ident" id="4158780">in</span><span class="op" id="4158782">,</span>&nbsp;<span class="op" id="4158784">&amp;</span><span class="ident" id="4158785">c</span><span class="op" id="4158786">)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4158791">//&nbsp;2</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158797">p224Mul</span><span class="op" id="4158804">(</span><span class="op" id="4158805">&amp;</span><span class="ident" id="4158806">f1</span><span class="op" id="4158808">,</span>&nbsp;<span class="op" id="4158810">&amp;</span><span class="ident" id="4158811">f1</span><span class="op" id="4158813">,</span>&nbsp;<span class="ident" id="4158815">in</span><span class="op" id="4158817">,</span>&nbsp;<span class="op" id="4158819">&amp;</span><span class="ident" id="4158820">c</span><span class="op" id="4158821">)</span>&nbsp;&nbsp;<span class="comment" id="4158824">//&nbsp;2**2&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158837">p224Square</span><span class="op" id="4158847">(</span><span class="op" id="4158848">&amp;</span><span class="ident" id="4158849">f1</span><span class="op" id="4158851">,</span>&nbsp;<span class="op" id="4158853">&amp;</span><span class="ident" id="4158854">f1</span><span class="op" id="4158856">,</span>&nbsp;<span class="op" id="4158858">&amp;</span><span class="ident" id="4158859">c</span><span class="op" id="4158860">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4158864">//&nbsp;2**3&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158877">p224Mul</span><span class="op" id="4158884">(</span><span class="op" id="4158885">&amp;</span><span class="ident" id="4158886">f1</span><span class="op" id="4158888">,</span>&nbsp;<span class="op" id="4158890">&amp;</span><span class="ident" id="4158891">f1</span><span class="op" id="4158893">,</span>&nbsp;<span class="ident" id="4158895">in</span><span class="op" id="4158897">,</span>&nbsp;<span class="op" id="4158899">&amp;</span><span class="ident" id="4158900">c</span><span class="op" id="4158901">)</span>&nbsp;&nbsp;<span class="comment" id="4158904">//&nbsp;2**3&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158917">p224Square</span><span class="op" id="4158927">(</span><span class="op" id="4158928">&amp;</span><span class="ident" id="4158929">f2</span><span class="op" id="4158931">,</span>&nbsp;<span class="op" id="4158933">&amp;</span><span class="ident" id="4158934">f1</span><span class="op" id="4158936">,</span>&nbsp;<span class="op" id="4158938">&amp;</span><span class="ident" id="4158939">c</span><span class="op" id="4158940">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4158944">//&nbsp;2**4&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158957">p224Square</span><span class="op" id="4158967">(</span><span class="op" id="4158968">&amp;</span><span class="ident" id="4158969">f2</span><span class="op" id="4158971">,</span>&nbsp;<span class="op" id="4158973">&amp;</span><span class="ident" id="4158974">f2</span><span class="op" id="4158976">,</span>&nbsp;<span class="op" id="4158978">&amp;</span><span class="ident" id="4158979">c</span><span class="op" id="4158980">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4158984">//&nbsp;2**5&nbsp;-&nbsp;4</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158997">p224Square</span><span class="op" id="4159007">(</span><span class="op" id="4159008">&amp;</span><span class="ident" id="4159009">f2</span><span class="op" id="4159011">,</span>&nbsp;<span class="op" id="4159013">&amp;</span><span class="ident" id="4159014">f2</span><span class="op" id="4159016">,</span>&nbsp;<span class="op" id="4159018">&amp;</span><span class="ident" id="4159019">c</span><span class="op" id="4159020">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4159024">//&nbsp;2**6&nbsp;-&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159037">p224Mul</span><span class="op" id="4159044">(</span><span class="op" id="4159045">&amp;</span><span class="ident" id="4159046">f1</span><span class="op" id="4159048">,</span>&nbsp;<span class="op" id="4159050">&amp;</span><span class="ident" id="4159051">f1</span><span class="op" id="4159053">,</span>&nbsp;<span class="op" id="4159055">&amp;</span><span class="ident" id="4159056">f2</span><span class="op" id="4159058">,</span>&nbsp;<span class="op" id="4159060">&amp;</span><span class="ident" id="4159061">c</span><span class="op" id="4159062">)</span>&nbsp;<span class="comment" id="4159064">//&nbsp;2**6&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159077">p224Square</span><span class="op" id="4159087">(</span><span class="op" id="4159088">&amp;</span><span class="ident" id="4159089">f2</span><span class="op" id="4159091">,</span>&nbsp;<span class="op" id="4159093">&amp;</span><span class="ident" id="4159094">f1</span><span class="op" id="4159096">,</span>&nbsp;<span class="op" id="4159098">&amp;</span><span class="ident" id="4159099">c</span><span class="op" id="4159100">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4159104">//&nbsp;2**7&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159117">for</span>&nbsp;<span class="ident" id="4159121">i</span>&nbsp;<span class="op" id="4159123">:=</span>&nbsp;<span class="num" id="4159126">0</span><span class="op" id="4159127">;</span>&nbsp;<span class="ident" id="4159129">i</span>&nbsp;<span class="op" id="4159131">&lt;</span>&nbsp;<span class="num" id="4159133">5</span><span class="op" id="4159134">;</span>&nbsp;<span class="ident" id="4159136">i</span><span class="op" id="4159137">++</span>&nbsp;<span class="op" id="4159140">{</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4159144">//&nbsp;2**12&nbsp;-&nbsp;2**6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159162">p224Square</span><span class="op" id="4159172">(</span><span class="op" id="4159173">&amp;</span><span class="ident" id="4159174">f2</span><span class="op" id="4159176">,</span>&nbsp;<span class="op" id="4159178">&amp;</span><span class="ident" id="4159179">f2</span><span class="op" id="4159181">,</span>&nbsp;<span class="op" id="4159183">&amp;</span><span class="ident" id="4159184">c</span><span class="op" id="4159185">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4159188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159191">p224Mul</span><span class="op" id="4159198">(</span><span class="op" id="4159199">&amp;</span><span class="ident" id="4159200">f2</span><span class="op" id="4159202">,</span>&nbsp;<span class="op" id="4159204">&amp;</span><span class="ident" id="4159205">f2</span><span class="op" id="4159207">,</span>&nbsp;<span class="op" id="4159209">&amp;</span><span class="ident" id="4159210">f1</span><span class="op" id="4159212">,</span>&nbsp;<span class="op" id="4159214">&amp;</span><span class="ident" id="4159215">c</span><span class="op" id="4159216">)</span>&nbsp;<span class="comment" id="4159218">//&nbsp;2**12&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159232">p224Square</span><span class="op" id="4159242">(</span><span class="op" id="4159243">&amp;</span><span class="ident" id="4159244">f3</span><span class="op" id="4159246">,</span>&nbsp;<span class="op" id="4159248">&amp;</span><span class="ident" id="4159249">f2</span><span class="op" id="4159251">,</span>&nbsp;<span class="op" id="4159253">&amp;</span><span class="ident" id="4159254">c</span><span class="op" id="4159255">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4159259">//&nbsp;2**13&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159273">for</span>&nbsp;<span class="ident" id="4159277">i</span>&nbsp;<span class="op" id="4159279">:=</span>&nbsp;<span class="num" id="4159282">0</span><span class="op" id="4159283">;</span>&nbsp;<span class="ident" id="4159285">i</span>&nbsp;<span class="op" id="4159287">&lt;</span>&nbsp;<span class="num" id="4159289">11</span><span class="op" id="4159291">;</span>&nbsp;<span class="ident" id="4159293">i</span><span class="op" id="4159294">++</span>&nbsp;<span class="op" id="4159297">{</span>&nbsp;&nbsp;<span class="comment" id="4159300">//&nbsp;2**24&nbsp;-&nbsp;2**12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159319">p224Square</span><span class="op" id="4159329">(</span><span class="op" id="4159330">&amp;</span><span class="ident" id="4159331">f3</span><span class="op" id="4159333">,</span>&nbsp;<span class="op" id="4159335">&amp;</span><span class="ident" id="4159336">f3</span><span class="op" id="4159338">,</span>&nbsp;<span class="op" id="4159340">&amp;</span><span class="ident" id="4159341">c</span><span class="op" id="4159342">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4159345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159348">p224Mul</span><span class="op" id="4159355">(</span><span class="op" id="4159356">&amp;</span><span class="ident" id="4159357">f2</span><span class="op" id="4159359">,</span>&nbsp;<span class="op" id="4159361">&amp;</span><span class="ident" id="4159362">f3</span><span class="op" id="4159364">,</span>&nbsp;<span class="op" id="4159366">&amp;</span><span class="ident" id="4159367">f2</span><span class="op" id="4159369">,</span>&nbsp;<span class="op" id="4159371">&amp;</span><span class="ident" id="4159372">c</span><span class="op" id="4159373">)</span>&nbsp;<span class="comment" id="4159375">//&nbsp;2**24&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159389">p224Square</span><span class="op" id="4159399">(</span><span class="op" id="4159400">&amp;</span><span class="ident" id="4159401">f3</span><span class="op" id="4159403">,</span>&nbsp;<span class="op" id="4159405">&amp;</span><span class="ident" id="4159406">f2</span><span class="op" id="4159408">,</span>&nbsp;<span class="op" id="4159410">&amp;</span><span class="ident" id="4159411">c</span><span class="op" id="4159412">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4159416">//&nbsp;2**25&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159430">for</span>&nbsp;<span class="ident" id="4159434">i</span>&nbsp;<span class="op" id="4159436">:=</span>&nbsp;<span class="num" id="4159439">0</span><span class="op" id="4159440">;</span>&nbsp;<span class="ident" id="4159442">i</span>&nbsp;<span class="op" id="4159444">&lt;</span>&nbsp;<span class="num" id="4159446">23</span><span class="op" id="4159448">;</span>&nbsp;<span class="ident" id="4159450">i</span><span class="op" id="4159451">++</span>&nbsp;<span class="op" id="4159454">{</span>&nbsp;&nbsp;<span class="comment" id="4159457">//&nbsp;2**48&nbsp;-&nbsp;2**24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159476">p224Square</span><span class="op" id="4159486">(</span><span class="op" id="4159487">&amp;</span><span class="ident" id="4159488">f3</span><span class="op" id="4159490">,</span>&nbsp;<span class="op" id="4159492">&amp;</span><span class="ident" id="4159493">f3</span><span class="op" id="4159495">,</span>&nbsp;<span class="op" id="4159497">&amp;</span><span class="ident" id="4159498">c</span><span class="op" id="4159499">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4159502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159505">p224Mul</span><span class="op" id="4159512">(</span><span class="op" id="4159513">&amp;</span><span class="ident" id="4159514">f3</span><span class="op" id="4159516">,</span>&nbsp;<span class="op" id="4159518">&amp;</span><span class="ident" id="4159519">f3</span><span class="op" id="4159521">,</span>&nbsp;<span class="op" id="4159523">&amp;</span><span class="ident" id="4159524">f2</span><span class="op" id="4159526">,</span>&nbsp;<span class="op" id="4159528">&amp;</span><span class="ident" id="4159529">c</span><span class="op" id="4159530">)</span>&nbsp;<span class="comment" id="4159532">//&nbsp;2**48&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159546">p224Square</span><span class="op" id="4159556">(</span><span class="op" id="4159557">&amp;</span><span class="ident" id="4159558">f4</span><span class="op" id="4159560">,</span>&nbsp;<span class="op" id="4159562">&amp;</span><span class="ident" id="4159563">f3</span><span class="op" id="4159565">,</span>&nbsp;<span class="op" id="4159567">&amp;</span><span class="ident" id="4159568">c</span><span class="op" id="4159569">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4159573">//&nbsp;2**49&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159587">for</span>&nbsp;<span class="ident" id="4159591">i</span>&nbsp;<span class="op" id="4159593">:=</span>&nbsp;<span class="num" id="4159596">0</span><span class="op" id="4159597">;</span>&nbsp;<span class="ident" id="4159599">i</span>&nbsp;<span class="op" id="4159601">&lt;</span>&nbsp;<span class="num" id="4159603">47</span><span class="op" id="4159605">;</span>&nbsp;<span class="ident" id="4159607">i</span><span class="op" id="4159608">++</span>&nbsp;<span class="op" id="4159611">{</span>&nbsp;&nbsp;<span class="comment" id="4159614">//&nbsp;2**96&nbsp;-&nbsp;2**48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159633">p224Square</span><span class="op" id="4159643">(</span><span class="op" id="4159644">&amp;</span><span class="ident" id="4159645">f4</span><span class="op" id="4159647">,</span>&nbsp;<span class="op" id="4159649">&amp;</span><span class="ident" id="4159650">f4</span><span class="op" id="4159652">,</span>&nbsp;<span class="op" id="4159654">&amp;</span><span class="ident" id="4159655">c</span><span class="op" id="4159656">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4159659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159662">p224Mul</span><span class="op" id="4159669">(</span><span class="op" id="4159670">&amp;</span><span class="ident" id="4159671">f3</span><span class="op" id="4159673">,</span>&nbsp;<span class="op" id="4159675">&amp;</span><span class="ident" id="4159676">f3</span><span class="op" id="4159678">,</span>&nbsp;<span class="op" id="4159680">&amp;</span><span class="ident" id="4159681">f4</span><span class="op" id="4159683">,</span>&nbsp;<span class="op" id="4159685">&amp;</span><span class="ident" id="4159686">c</span><span class="op" id="4159687">)</span>&nbsp;<span class="comment" id="4159689">//&nbsp;2**96&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159703">p224Square</span><span class="op" id="4159713">(</span><span class="op" id="4159714">&amp;</span><span class="ident" id="4159715">f4</span><span class="op" id="4159717">,</span>&nbsp;<span class="op" id="4159719">&amp;</span><span class="ident" id="4159720">f3</span><span class="op" id="4159722">,</span>&nbsp;<span class="op" id="4159724">&amp;</span><span class="ident" id="4159725">c</span><span class="op" id="4159726">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4159730">//&nbsp;2**97&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159744">for</span>&nbsp;<span class="ident" id="4159748">i</span>&nbsp;<span class="op" id="4159750">:=</span>&nbsp;<span class="num" id="4159753">0</span><span class="op" id="4159754">;</span>&nbsp;<span class="ident" id="4159756">i</span>&nbsp;<span class="op" id="4159758">&lt;</span>&nbsp;<span class="num" id="4159760">23</span><span class="op" id="4159762">;</span>&nbsp;<span class="ident" id="4159764">i</span><span class="op" id="4159765">++</span>&nbsp;<span class="op" id="4159768">{</span>&nbsp;&nbsp;<span class="comment" id="4159771">//&nbsp;2**120&nbsp;-&nbsp;2**24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159791">p224Square</span><span class="op" id="4159801">(</span><span class="op" id="4159802">&amp;</span><span class="ident" id="4159803">f4</span><span class="op" id="4159805">,</span>&nbsp;<span class="op" id="4159807">&amp;</span><span class="ident" id="4159808">f4</span><span class="op" id="4159810">,</span>&nbsp;<span class="op" id="4159812">&amp;</span><span class="ident" id="4159813">c</span><span class="op" id="4159814">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4159817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159820">p224Mul</span><span class="op" id="4159827">(</span><span class="op" id="4159828">&amp;</span><span class="ident" id="4159829">f2</span><span class="op" id="4159831">,</span>&nbsp;<span class="op" id="4159833">&amp;</span><span class="ident" id="4159834">f4</span><span class="op" id="4159836">,</span>&nbsp;<span class="op" id="4159838">&amp;</span><span class="ident" id="4159839">f2</span><span class="op" id="4159841">,</span>&nbsp;<span class="op" id="4159843">&amp;</span><span class="ident" id="4159844">c</span><span class="op" id="4159845">)</span>&nbsp;<span class="comment" id="4159847">//&nbsp;2**120&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159862">for</span>&nbsp;<span class="ident" id="4159866">i</span>&nbsp;<span class="op" id="4159868">:=</span>&nbsp;<span class="num" id="4159871">0</span><span class="op" id="4159872">;</span>&nbsp;<span class="ident" id="4159874">i</span>&nbsp;<span class="op" id="4159876">&lt;</span>&nbsp;<span class="num" id="4159878">6</span><span class="op" id="4159879">;</span>&nbsp;<span class="ident" id="4159881">i</span><span class="op" id="4159882">++</span>&nbsp;<span class="op" id="4159885">{</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4159889">//&nbsp;2**126&nbsp;-&nbsp;2**6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159908">p224Square</span><span class="op" id="4159918">(</span><span class="op" id="4159919">&amp;</span><span class="ident" id="4159920">f2</span><span class="op" id="4159922">,</span>&nbsp;<span class="op" id="4159924">&amp;</span><span class="ident" id="4159925">f2</span><span class="op" id="4159927">,</span>&nbsp;<span class="op" id="4159929">&amp;</span><span class="ident" id="4159930">c</span><span class="op" id="4159931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4159934">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159937">p224Mul</span><span class="op" id="4159944">(</span><span class="op" id="4159945">&amp;</span><span class="ident" id="4159946">f1</span><span class="op" id="4159948">,</span>&nbsp;<span class="op" id="4159950">&amp;</span><span class="ident" id="4159951">f1</span><span class="op" id="4159953">,</span>&nbsp;<span class="op" id="4159955">&amp;</span><span class="ident" id="4159956">f2</span><span class="op" id="4159958">,</span>&nbsp;<span class="op" id="4159960">&amp;</span><span class="ident" id="4159961">c</span><span class="op" id="4159962">)</span>&nbsp;<span class="comment" id="4159964">//&nbsp;2**126&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159979">p224Square</span><span class="op" id="4159989">(</span><span class="op" id="4159990">&amp;</span><span class="ident" id="4159991">f1</span><span class="op" id="4159993">,</span>&nbsp;<span class="op" id="4159995">&amp;</span><span class="ident" id="4159996">f1</span><span class="op" id="4159998">,</span>&nbsp;<span class="op" id="4160000">&amp;</span><span class="ident" id="4160001">c</span><span class="op" id="4160002">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4160006">//&nbsp;2**127&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160021">p224Mul</span><span class="op" id="4160028">(</span><span class="op" id="4160029">&amp;</span><span class="ident" id="4160030">f1</span><span class="op" id="4160032">,</span>&nbsp;<span class="op" id="4160034">&amp;</span><span class="ident" id="4160035">f1</span><span class="op" id="4160037">,</span>&nbsp;<span class="ident" id="4160039">in</span><span class="op" id="4160041">,</span>&nbsp;<span class="op" id="4160043">&amp;</span><span class="ident" id="4160044">c</span><span class="op" id="4160045">)</span>&nbsp;&nbsp;<span class="comment" id="4160048">//&nbsp;2**127&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160063">for</span>&nbsp;<span class="ident" id="4160067">i</span>&nbsp;<span class="op" id="4160069">:=</span>&nbsp;<span class="num" id="4160072">0</span><span class="op" id="4160073">;</span>&nbsp;<span class="ident" id="4160075">i</span>&nbsp;<span class="op" id="4160077">&lt;</span>&nbsp;<span class="num" id="4160079">97</span><span class="op" id="4160081">;</span>&nbsp;<span class="ident" id="4160083">i</span><span class="op" id="4160084">++</span>&nbsp;<span class="op" id="4160087">{</span>&nbsp;&nbsp;<span class="comment" id="4160090">//&nbsp;2**224&nbsp;-&nbsp;2**97</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160110">p224Square</span><span class="op" id="4160120">(</span><span class="op" id="4160121">&amp;</span><span class="ident" id="4160122">f1</span><span class="op" id="4160124">,</span>&nbsp;<span class="op" id="4160126">&amp;</span><span class="ident" id="4160127">f1</span><span class="op" id="4160129">,</span>&nbsp;<span class="op" id="4160131">&amp;</span><span class="ident" id="4160132">c</span><span class="op" id="4160133">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160139">p224Mul</span><span class="op" id="4160146">(</span><span class="ident" id="4160147">out</span><span class="op" id="4160150">,</span>&nbsp;<span class="op" id="4160152">&amp;</span><span class="ident" id="4160153">f1</span><span class="op" id="4160155">,</span>&nbsp;<span class="op" id="4160157">&amp;</span><span class="ident" id="4160158">f3</span><span class="op" id="4160160">,</span>&nbsp;<span class="op" id="4160162">&amp;</span><span class="ident" id="4160163">c</span><span class="op" id="4160164">)</span>&nbsp;<span class="comment" id="4160166">//&nbsp;2**224&nbsp;-&nbsp;2**96&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span><span class="op" id="4160188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4160191">//&nbsp;p224Contract&nbsp;converts&nbsp;a&nbsp;FieldElement&nbsp;to&nbsp;its&nbsp;unique,&nbsp;minimal&nbsp;form.</span><br>
<span class="lineno">385</span><span class="comment" id="4160260">//</span><br>
<span class="lineno"></span><span class="comment" id="4160263">//&nbsp;On&nbsp;entry,&nbsp;in[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="comment" id="4160290">//&nbsp;On&nbsp;exit,&nbsp;in[i]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><span class="keyword" id="4160316">func</span>&nbsp;<span class="ident" id="4160321">p224Contract</span><span class="op" id="4160333">(</span><span class="ident" id="4160334">out</span><span class="op" id="4160337">,</span>&nbsp;<span class="ident" id="4160339">in</span>&nbsp;<span class="op" id="4160342">*</span><span class="ident" id="4160343">p224FieldElement</span><span class="op" id="4160359">)</span>&nbsp;<span class="op" id="4160361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4160364">copy</span><span class="op" id="4160368">(</span><span class="ident" id="4160369">out</span><span class="op" id="4160372">[</span><span class="op" id="4160373">:</span><span class="op" id="4160374">]</span><span class="op" id="4160375">,</span>&nbsp;<span class="ident" id="4160377">in</span><span class="op" id="4160379">[</span><span class="op" id="4160380">:</span><span class="op" id="4160381">]</span><span class="op" id="4160382">)</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160386">for</span>&nbsp;<span class="ident" id="4160390">i</span>&nbsp;<span class="op" id="4160392">:=</span>&nbsp;<span class="num" id="4160395">0</span><span class="op" id="4160396">;</span>&nbsp;<span class="ident" id="4160398">i</span>&nbsp;<span class="op" id="4160400">&lt;</span>&nbsp;<span class="num" id="4160402">7</span><span class="op" id="4160403">;</span>&nbsp;<span class="ident" id="4160405">i</span><span class="op" id="4160406">++</span>&nbsp;<span class="op" id="4160409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160413">out</span><span class="op" id="4160416">[</span><span class="ident" id="4160417">i</span><span class="op" id="4160418">+</span><span class="num" id="4160419">1</span><span class="op" id="4160420">]</span>&nbsp;<span class="op" id="4160422">+=</span>&nbsp;<span class="ident" id="4160425">out</span><span class="op" id="4160428">[</span><span class="ident" id="4160429">i</span><span class="op" id="4160430">]</span>&nbsp;<span class="op" id="4160432">&gt;&gt;</span>&nbsp;<span class="num" id="4160435">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160440">out</span><span class="op" id="4160443">[</span><span class="ident" id="4160444">i</span><span class="op" id="4160445">]</span>&nbsp;<span class="op" id="4160447">&amp;=</span>&nbsp;<span class="ident" id="4160450">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160464">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160467">top</span>&nbsp;<span class="op" id="4160471">:=</span>&nbsp;<span class="ident" id="4160474">out</span><span class="op" id="4160477">[</span><span class="num" id="4160478">7</span><span class="op" id="4160479">]</span>&nbsp;<span class="op" id="4160481">&gt;&gt;</span>&nbsp;<span class="num" id="4160484">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160488">out</span><span class="op" id="4160491">[</span><span class="num" id="4160492">7</span><span class="op" id="4160493">]</span>&nbsp;<span class="op" id="4160495">&amp;=</span>&nbsp;<span class="ident" id="4160498">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160513">out</span><span class="op" id="4160516">[</span><span class="num" id="4160517">0</span><span class="op" id="4160518">]</span>&nbsp;<span class="op" id="4160520">-=</span>&nbsp;<span class="ident" id="4160523">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160528">out</span><span class="op" id="4160531">[</span><span class="num" id="4160532">3</span><span class="op" id="4160533">]</span>&nbsp;<span class="op" id="4160535">+=</span>&nbsp;<span class="ident" id="4160538">top</span>&nbsp;<span class="op" id="4160542">&lt;&lt;</span>&nbsp;<span class="num" id="4160545">12</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4160550">//&nbsp;We&nbsp;may&nbsp;just&nbsp;have&nbsp;made&nbsp;out[i]&nbsp;negative.&nbsp;So&nbsp;we&nbsp;carry&nbsp;down.&nbsp;If&nbsp;we&nbsp;made</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4160622">//&nbsp;out[0]&nbsp;negative&nbsp;then&nbsp;we&nbsp;know&nbsp;that&nbsp;out[3]&nbsp;is&nbsp;sufficiently&nbsp;positive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4160692">//&nbsp;because&nbsp;we&nbsp;just&nbsp;added&nbsp;to&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160725">for</span>&nbsp;<span class="ident" id="4160729">i</span>&nbsp;<span class="op" id="4160731">:=</span>&nbsp;<span class="num" id="4160734">0</span><span class="op" id="4160735">;</span>&nbsp;<span class="ident" id="4160737">i</span>&nbsp;<span class="op" id="4160739">&lt;</span>&nbsp;<span class="num" id="4160741">3</span><span class="op" id="4160742">;</span>&nbsp;<span class="ident" id="4160744">i</span><span class="op" id="4160745">++</span>&nbsp;<span class="op" id="4160748">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160752">mask</span>&nbsp;<span class="op" id="4160757">:=</span>&nbsp;<span class="builtintype" id="4160760">uint32</span><span class="op" id="4160766">(</span><span class="builtintype" id="4160767">int32</span><span class="op" id="4160772">(</span><span class="ident" id="4160773">out</span><span class="op" id="4160776">[</span><span class="ident" id="4160777">i</span><span class="op" id="4160778">]</span><span class="op" id="4160779">)</span>&nbsp;<span class="op" id="4160781">&gt;&gt;</span>&nbsp;<span class="num" id="4160784">31</span><span class="op" id="4160786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160790">out</span><span class="op" id="4160793">[</span><span class="ident" id="4160794">i</span><span class="op" id="4160795">]</span>&nbsp;<span class="op" id="4160797">+=</span>&nbsp;<span class="op" id="4160800">(</span><span class="num" id="4160801">1</span>&nbsp;<span class="op" id="4160803">&lt;&lt;</span>&nbsp;<span class="num" id="4160806">28</span><span class="op" id="4160808">)</span>&nbsp;<span class="op" id="4160810">&amp;</span>&nbsp;<span class="ident" id="4160812">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160819">out</span><span class="op" id="4160822">[</span><span class="ident" id="4160823">i</span><span class="op" id="4160824">+</span><span class="num" id="4160825">1</span><span class="op" id="4160826">]</span>&nbsp;<span class="op" id="4160828">-=</span>&nbsp;<span class="num" id="4160831">1</span>&nbsp;<span class="op" id="4160833">&amp;</span>&nbsp;<span class="ident" id="4160835">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4160845">//&nbsp;We&nbsp;might&nbsp;have&nbsp;pushed&nbsp;out[3]&nbsp;over&nbsp;2**28&nbsp;so&nbsp;we&nbsp;perform&nbsp;another,&nbsp;partial,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4160920">//&nbsp;carry&nbsp;chain.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160937">for</span>&nbsp;<span class="ident" id="4160941">i</span>&nbsp;<span class="op" id="4160943">:=</span>&nbsp;<span class="num" id="4160946">3</span><span class="op" id="4160947">;</span>&nbsp;<span class="ident" id="4160949">i</span>&nbsp;<span class="op" id="4160951">&lt;</span>&nbsp;<span class="num" id="4160953">7</span><span class="op" id="4160954">;</span>&nbsp;<span class="ident" id="4160956">i</span><span class="op" id="4160957">++</span>&nbsp;<span class="op" id="4160960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160964">out</span><span class="op" id="4160967">[</span><span class="ident" id="4160968">i</span><span class="op" id="4160969">+</span><span class="num" id="4160970">1</span><span class="op" id="4160971">]</span>&nbsp;<span class="op" id="4160973">+=</span>&nbsp;<span class="ident" id="4160976">out</span><span class="op" id="4160979">[</span><span class="ident" id="4160980">i</span><span class="op" id="4160981">]</span>&nbsp;<span class="op" id="4160983">&gt;&gt;</span>&nbsp;<span class="num" id="4160986">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160991">out</span><span class="op" id="4160994">[</span><span class="ident" id="4160995">i</span><span class="op" id="4160996">]</span>&nbsp;<span class="op" id="4160998">&amp;=</span>&nbsp;<span class="ident" id="4161001">bottom28Bits</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4161015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161018">top</span>&nbsp;<span class="op" id="4161022">=</span>&nbsp;<span class="ident" id="4161024">out</span><span class="op" id="4161027">[</span><span class="num" id="4161028">7</span><span class="op" id="4161029">]</span>&nbsp;<span class="op" id="4161031">&gt;&gt;</span>&nbsp;<span class="num" id="4161034">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161038">out</span><span class="op" id="4161041">[</span><span class="num" id="4161042">7</span><span class="op" id="4161043">]</span>&nbsp;<span class="op" id="4161045">&amp;=</span>&nbsp;<span class="ident" id="4161048">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4161063">//&nbsp;Eliminate&nbsp;top&nbsp;while&nbsp;maintaining&nbsp;the&nbsp;same&nbsp;value&nbsp;mod&nbsp;p.</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161121">out</span><span class="op" id="4161124">[</span><span class="num" id="4161125">0</span><span class="op" id="4161126">]</span>&nbsp;<span class="op" id="4161128">-=</span>&nbsp;<span class="ident" id="4161131">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161136">out</span><span class="op" id="4161139">[</span><span class="num" id="4161140">3</span><span class="op" id="4161141">]</span>&nbsp;<span class="op" id="4161143">+=</span>&nbsp;<span class="ident" id="4161146">top</span>&nbsp;<span class="op" id="4161150">&lt;&lt;</span>&nbsp;<span class="num" id="4161153">12</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4161158">//&nbsp;There&nbsp;are&nbsp;two&nbsp;cases&nbsp;to&nbsp;consider&nbsp;for&nbsp;out[3]:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4161206">//&nbsp;&nbsp;&nbsp;1)&nbsp;The&nbsp;first&nbsp;time&nbsp;that&nbsp;we&nbsp;eliminated&nbsp;top,&nbsp;we&nbsp;didn&#39;t&nbsp;push&nbsp;out[3]&nbsp;over</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4161281">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2**28.&nbsp;In&nbsp;this&nbsp;case,&nbsp;the&nbsp;partial&nbsp;carry&nbsp;chain&nbsp;didn&#39;t&nbsp;change&nbsp;any&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4161360">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;top&nbsp;is&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4161386">//&nbsp;&nbsp;&nbsp;2)&nbsp;We&nbsp;did&nbsp;push&nbsp;out[3]&nbsp;over&nbsp;2**28&nbsp;the&nbsp;first&nbsp;time&nbsp;that&nbsp;we&nbsp;eliminated&nbsp;top.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4161464">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;first&nbsp;value&nbsp;of&nbsp;top&nbsp;was&nbsp;in&nbsp;[0..16),&nbsp;therefore,&nbsp;prior&nbsp;to&nbsp;eliminating</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4161544">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;first&nbsp;top,&nbsp;0xfff1000&nbsp;&lt;=&nbsp;out[3]&nbsp;&lt;=&nbsp;0xfffffff.&nbsp;Therefore,&nbsp;after</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4161619">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overflowing&nbsp;and&nbsp;being&nbsp;reduced&nbsp;by&nbsp;the&nbsp;second&nbsp;carry&nbsp;chain,&nbsp;out[3]&nbsp;&lt;=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4161695">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xf000.&nbsp;Thus&nbsp;it&nbsp;cannot&nbsp;have&nbsp;overflowed&nbsp;when&nbsp;we&nbsp;eliminated&nbsp;top&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4161774">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4161797">//&nbsp;Again,&nbsp;we&nbsp;may&nbsp;just&nbsp;have&nbsp;made&nbsp;out[0]&nbsp;negative,&nbsp;so&nbsp;do&nbsp;the&nbsp;same&nbsp;carry&nbsp;down.</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4161874">//&nbsp;As&nbsp;before,&nbsp;if&nbsp;we&nbsp;made&nbsp;out[0]&nbsp;negative&nbsp;then&nbsp;we&nbsp;know&nbsp;that&nbsp;out[3]&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4161944">//&nbsp;sufficiently&nbsp;positive.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161971">for</span>&nbsp;<span class="ident" id="4161975">i</span>&nbsp;<span class="op" id="4161977">:=</span>&nbsp;<span class="num" id="4161980">0</span><span class="op" id="4161981">;</span>&nbsp;<span class="ident" id="4161983">i</span>&nbsp;<span class="op" id="4161985">&lt;</span>&nbsp;<span class="num" id="4161987">3</span><span class="op" id="4161988">;</span>&nbsp;<span class="ident" id="4161990">i</span><span class="op" id="4161991">++</span>&nbsp;<span class="op" id="4161994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161998">mask</span>&nbsp;<span class="op" id="4162003">:=</span>&nbsp;<span class="builtintype" id="4162006">uint32</span><span class="op" id="4162012">(</span><span class="builtintype" id="4162013">int32</span><span class="op" id="4162018">(</span><span class="ident" id="4162019">out</span><span class="op" id="4162022">[</span><span class="ident" id="4162023">i</span><span class="op" id="4162024">]</span><span class="op" id="4162025">)</span>&nbsp;<span class="op" id="4162027">&gt;&gt;</span>&nbsp;<span class="num" id="4162030">31</span><span class="op" id="4162032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162036">out</span><span class="op" id="4162039">[</span><span class="ident" id="4162040">i</span><span class="op" id="4162041">]</span>&nbsp;<span class="op" id="4162043">+=</span>&nbsp;<span class="op" id="4162046">(</span><span class="num" id="4162047">1</span>&nbsp;<span class="op" id="4162049">&lt;&lt;</span>&nbsp;<span class="num" id="4162052">28</span><span class="op" id="4162054">)</span>&nbsp;<span class="op" id="4162056">&amp;</span>&nbsp;<span class="ident" id="4162058">mask</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162065">out</span><span class="op" id="4162068">[</span><span class="ident" id="4162069">i</span><span class="op" id="4162070">+</span><span class="num" id="4162071">1</span><span class="op" id="4162072">]</span>&nbsp;<span class="op" id="4162074">-=</span>&nbsp;<span class="num" id="4162077">1</span>&nbsp;<span class="op" id="4162079">&amp;</span>&nbsp;<span class="ident" id="4162081">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4162087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4162091">//&nbsp;Now&nbsp;we&nbsp;see&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p&nbsp;and,&nbsp;if&nbsp;so,&nbsp;subtract&nbsp;p.</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4162152">//&nbsp;First&nbsp;we&nbsp;build&nbsp;a&nbsp;mask&nbsp;from&nbsp;the&nbsp;top&nbsp;four&nbsp;limbs,&nbsp;which&nbsp;must&nbsp;all&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4162221">//&nbsp;equal&nbsp;to&nbsp;bottom28Bits&nbsp;if&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p.&nbsp;If&nbsp;top4AllOnes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4162290">//&nbsp;ends&nbsp;up&nbsp;with&nbsp;any&nbsp;zero&nbsp;bits&nbsp;in&nbsp;the&nbsp;bottom&nbsp;28&nbsp;bits,&nbsp;then&nbsp;this&nbsp;wasn&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4162361">//&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162371">top4AllOnes</span>&nbsp;<span class="op" id="4162383">:=</span>&nbsp;<span class="builtintype" id="4162386">uint32</span><span class="op" id="4162392">(</span><span class="num" id="4162393">0xffffffff</span><span class="op" id="4162403">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162406">for</span>&nbsp;<span class="ident" id="4162410">i</span>&nbsp;<span class="op" id="4162412">:=</span>&nbsp;<span class="num" id="4162415">4</span><span class="op" id="4162416">;</span>&nbsp;<span class="ident" id="4162418">i</span>&nbsp;<span class="op" id="4162420">&lt;</span>&nbsp;<span class="num" id="4162422">8</span><span class="op" id="4162423">;</span>&nbsp;<span class="ident" id="4162425">i</span><span class="op" id="4162426">++</span>&nbsp;<span class="op" id="4162429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162433">top4AllOnes</span>&nbsp;<span class="op" id="4162445">&amp;=</span>&nbsp;<span class="ident" id="4162448">out</span><span class="op" id="4162451">[</span><span class="ident" id="4162452">i</span><span class="op" id="4162453">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4162456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162459">top4AllOnes</span>&nbsp;<span class="op" id="4162471">|=</span>&nbsp;<span class="num" id="4162474">0xf0000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4162486">//&nbsp;Now&nbsp;we&nbsp;replicate&nbsp;any&nbsp;zero&nbsp;bits&nbsp;to&nbsp;all&nbsp;the&nbsp;bits&nbsp;in&nbsp;top4AllOnes.</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162553">top4AllOnes</span>&nbsp;<span class="op" id="4162565">&amp;=</span>&nbsp;<span class="ident" id="4162568">top4AllOnes</span>&nbsp;<span class="op" id="4162580">&gt;&gt;</span>&nbsp;<span class="num" id="4162583">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162587">top4AllOnes</span>&nbsp;<span class="op" id="4162599">&amp;=</span>&nbsp;<span class="ident" id="4162602">top4AllOnes</span>&nbsp;<span class="op" id="4162614">&gt;&gt;</span>&nbsp;<span class="num" id="4162617">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162620">top4AllOnes</span>&nbsp;<span class="op" id="4162632">&amp;=</span>&nbsp;<span class="ident" id="4162635">top4AllOnes</span>&nbsp;<span class="op" id="4162647">&gt;&gt;</span>&nbsp;<span class="num" id="4162650">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162653">top4AllOnes</span>&nbsp;<span class="op" id="4162665">&amp;=</span>&nbsp;<span class="ident" id="4162668">top4AllOnes</span>&nbsp;<span class="op" id="4162680">&gt;&gt;</span>&nbsp;<span class="num" id="4162683">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162686">top4AllOnes</span>&nbsp;<span class="op" id="4162698">&amp;=</span>&nbsp;<span class="ident" id="4162701">top4AllOnes</span>&nbsp;<span class="op" id="4162713">&gt;&gt;</span>&nbsp;<span class="num" id="4162716">1</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162719">top4AllOnes</span>&nbsp;<span class="op" id="4162731">=</span>&nbsp;<span class="builtintype" id="4162733">uint32</span><span class="op" id="4162739">(</span><span class="builtintype" id="4162740">int32</span><span class="op" id="4162745">(</span><span class="ident" id="4162746">top4AllOnes</span><span class="op" id="4162757">&lt;&lt;</span><span class="num" id="4162759">31</span><span class="op" id="4162761">)</span>&nbsp;<span class="op" id="4162763">&gt;&gt;</span>&nbsp;<span class="num" id="4162766">31</span><span class="op" id="4162768">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4162772">//&nbsp;Now&nbsp;we&nbsp;test&nbsp;whether&nbsp;the&nbsp;bottom&nbsp;three&nbsp;limbs&nbsp;are&nbsp;non-zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162833">bottom3NonZero</span>&nbsp;<span class="op" id="4162848">:=</span>&nbsp;<span class="ident" id="4162851">out</span><span class="op" id="4162854">[</span><span class="num" id="4162855">0</span><span class="op" id="4162856">]</span>&nbsp;<span class="op" id="4162858">|</span>&nbsp;<span class="ident" id="4162860">out</span><span class="op" id="4162863">[</span><span class="num" id="4162864">1</span><span class="op" id="4162865">]</span>&nbsp;<span class="op" id="4162867">|</span>&nbsp;<span class="ident" id="4162869">out</span><span class="op" id="4162872">[</span><span class="num" id="4162873">2</span><span class="op" id="4162874">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162877">bottom3NonZero</span>&nbsp;<span class="op" id="4162892">|=</span>&nbsp;<span class="ident" id="4162895">bottom3NonZero</span>&nbsp;<span class="op" id="4162910">&gt;&gt;</span>&nbsp;<span class="num" id="4162913">16</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162917">bottom3NonZero</span>&nbsp;<span class="op" id="4162932">|=</span>&nbsp;<span class="ident" id="4162935">bottom3NonZero</span>&nbsp;<span class="op" id="4162950">&gt;&gt;</span>&nbsp;<span class="num" id="4162953">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162956">bottom3NonZero</span>&nbsp;<span class="op" id="4162971">|=</span>&nbsp;<span class="ident" id="4162974">bottom3NonZero</span>&nbsp;<span class="op" id="4162989">&gt;&gt;</span>&nbsp;<span class="num" id="4162992">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162995">bottom3NonZero</span>&nbsp;<span class="op" id="4163010">|=</span>&nbsp;<span class="ident" id="4163013">bottom3NonZero</span>&nbsp;<span class="op" id="4163028">&gt;&gt;</span>&nbsp;<span class="num" id="4163031">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163034">bottom3NonZero</span>&nbsp;<span class="op" id="4163049">|=</span>&nbsp;<span class="ident" id="4163052">bottom3NonZero</span>&nbsp;<span class="op" id="4163067">&gt;&gt;</span>&nbsp;<span class="num" id="4163070">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163073">bottom3NonZero</span>&nbsp;<span class="op" id="4163088">=</span>&nbsp;<span class="builtintype" id="4163090">uint32</span><span class="op" id="4163096">(</span><span class="builtintype" id="4163097">int32</span><span class="op" id="4163102">(</span><span class="ident" id="4163103">bottom3NonZero</span><span class="op" id="4163117">&lt;&lt;</span><span class="num" id="4163119">31</span><span class="op" id="4163121">)</span>&nbsp;<span class="op" id="4163123">&gt;&gt;</span>&nbsp;<span class="num" id="4163126">31</span><span class="op" id="4163128">)</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4163132">//&nbsp;Everything&nbsp;depends&nbsp;on&nbsp;the&nbsp;value&nbsp;of&nbsp;out[3].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4163179">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;&gt;&nbsp;0xffff000&nbsp;and&nbsp;top4AllOnes&nbsp;!=&nbsp;0&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4163256">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;=&nbsp;0xffff000&nbsp;and&nbsp;top4AllOnes&nbsp;!=&nbsp;0&nbsp;and&nbsp;bottom3NonZero&nbsp;!=&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4163329">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4163367">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;&lt;&nbsp;0xffff000,&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&lt;&nbsp;p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163423">n</span>&nbsp;<span class="op" id="4163425">:=</span>&nbsp;<span class="ident" id="4163428">out</span><span class="op" id="4163431">[</span><span class="num" id="4163432">3</span><span class="op" id="4163433">]</span>&nbsp;<span class="op" id="4163435">-</span>&nbsp;<span class="num" id="4163437">0xffff000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163448">out3Equal</span>&nbsp;<span class="op" id="4163458">:=</span>&nbsp;<span class="ident" id="4163461">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163464">out3Equal</span>&nbsp;<span class="op" id="4163474">|=</span>&nbsp;<span class="ident" id="4163477">out3Equal</span>&nbsp;<span class="op" id="4163487">&gt;&gt;</span>&nbsp;<span class="num" id="4163490">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163494">out3Equal</span>&nbsp;<span class="op" id="4163504">|=</span>&nbsp;<span class="ident" id="4163507">out3Equal</span>&nbsp;<span class="op" id="4163517">&gt;&gt;</span>&nbsp;<span class="num" id="4163520">8</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163523">out3Equal</span>&nbsp;<span class="op" id="4163533">|=</span>&nbsp;<span class="ident" id="4163536">out3Equal</span>&nbsp;<span class="op" id="4163546">&gt;&gt;</span>&nbsp;<span class="num" id="4163549">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163552">out3Equal</span>&nbsp;<span class="op" id="4163562">|=</span>&nbsp;<span class="ident" id="4163565">out3Equal</span>&nbsp;<span class="op" id="4163575">&gt;&gt;</span>&nbsp;<span class="num" id="4163578">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163581">out3Equal</span>&nbsp;<span class="op" id="4163591">|=</span>&nbsp;<span class="ident" id="4163594">out3Equal</span>&nbsp;<span class="op" id="4163604">&gt;&gt;</span>&nbsp;<span class="num" id="4163607">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163610">out3Equal</span>&nbsp;<span class="op" id="4163620">=</span>&nbsp;<span class="op" id="4163622">^</span><span class="builtintype" id="4163623">uint32</span><span class="op" id="4163629">(</span><span class="builtintype" id="4163630">int32</span><span class="op" id="4163635">(</span><span class="ident" id="4163636">out3Equal</span><span class="op" id="4163645">&lt;&lt;</span><span class="num" id="4163647">31</span><span class="op" id="4163649">)</span>&nbsp;<span class="op" id="4163651">&gt;&gt;</span>&nbsp;<span class="num" id="4163654">31</span><span class="op" id="4163656">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4163660">//&nbsp;If&nbsp;out[3]&nbsp;&gt;&nbsp;0xffff000&nbsp;then&nbsp;n&#39;s&nbsp;MSB&nbsp;will&nbsp;be&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163713">out3GT</span>&nbsp;<span class="op" id="4163720">:=</span>&nbsp;<span class="op" id="4163723">^</span><span class="builtintype" id="4163724">uint32</span><span class="op" id="4163730">(</span><span class="builtintype" id="4163731">int32</span><span class="op" id="4163736">(</span><span class="ident" id="4163737">n</span><span class="op" id="4163738">)</span>&nbsp;<span class="op" id="4163740">&gt;&gt;</span>&nbsp;<span class="num" id="4163743">31</span><span class="op" id="4163745">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163749">mask</span>&nbsp;<span class="op" id="4163754">:=</span>&nbsp;<span class="ident" id="4163757">top4AllOnes</span>&nbsp;<span class="op" id="4163769">&amp;</span>&nbsp;<span class="op" id="4163771">(</span><span class="op" id="4163772">(</span><span class="ident" id="4163773">out3Equal</span>&nbsp;<span class="op" id="4163783">&amp;</span>&nbsp;<span class="ident" id="4163785">bottom3NonZero</span><span class="op" id="4163799">)</span>&nbsp;<span class="op" id="4163801">|</span>&nbsp;<span class="ident" id="4163803">out3GT</span><span class="op" id="4163809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163812">out</span><span class="op" id="4163815">[</span><span class="num" id="4163816">0</span><span class="op" id="4163817">]</span>&nbsp;<span class="op" id="4163819">-=</span>&nbsp;<span class="num" id="4163822">1</span>&nbsp;<span class="op" id="4163824">&amp;</span>&nbsp;<span class="ident" id="4163826">mask</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163832">out</span><span class="op" id="4163835">[</span><span class="num" id="4163836">3</span><span class="op" id="4163837">]</span>&nbsp;<span class="op" id="4163839">-=</span>&nbsp;<span class="num" id="4163842">0xffff000</span>&nbsp;<span class="op" id="4163852">&amp;</span>&nbsp;<span class="ident" id="4163854">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163860">out</span><span class="op" id="4163863">[</span><span class="num" id="4163864">4</span><span class="op" id="4163865">]</span>&nbsp;<span class="op" id="4163867">-=</span>&nbsp;<span class="num" id="4163870">0xfffffff</span>&nbsp;<span class="op" id="4163880">&amp;</span>&nbsp;<span class="ident" id="4163882">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163888">out</span><span class="op" id="4163891">[</span><span class="num" id="4163892">5</span><span class="op" id="4163893">]</span>&nbsp;<span class="op" id="4163895">-=</span>&nbsp;<span class="num" id="4163898">0xfffffff</span>&nbsp;<span class="op" id="4163908">&amp;</span>&nbsp;<span class="ident" id="4163910">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163916">out</span><span class="op" id="4163919">[</span><span class="num" id="4163920">6</span><span class="op" id="4163921">]</span>&nbsp;<span class="op" id="4163923">-=</span>&nbsp;<span class="num" id="4163926">0xfffffff</span>&nbsp;<span class="op" id="4163936">&amp;</span>&nbsp;<span class="ident" id="4163938">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163944">out</span><span class="op" id="4163947">[</span><span class="num" id="4163948">7</span><span class="op" id="4163949">]</span>&nbsp;<span class="op" id="4163951">-=</span>&nbsp;<span class="num" id="4163954">0xfffffff</span>&nbsp;<span class="op" id="4163964">&amp;</span>&nbsp;<span class="ident" id="4163966">mask</span><br>
<span class="lineno">495</span><span class="op" id="4163971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4163974">//&nbsp;Group&nbsp;element&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="4164002">//</span><br>
<span class="lineno"></span><span class="comment" id="4164005">//&nbsp;These&nbsp;functions&nbsp;deal&nbsp;with&nbsp;group&nbsp;elements.&nbsp;The&nbsp;group&nbsp;is&nbsp;an&nbsp;elliptic&nbsp;curve</span><br>
<span class="lineno">500</span><span class="comment" id="4164081">//&nbsp;group&nbsp;with&nbsp;a&nbsp;=&nbsp;-3&nbsp;defined&nbsp;in&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4164141">//&nbsp;p224AddJacobian&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+b&nbsp;where&nbsp;a&nbsp;!=&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="4164194">func</span>&nbsp;<span class="ident" id="4164199">p224AddJacobian</span><span class="op" id="4164214">(</span><span class="ident" id="4164215">x3</span><span class="op" id="4164217">,</span>&nbsp;<span class="ident" id="4164219">y3</span><span class="op" id="4164221">,</span>&nbsp;<span class="ident" id="4164223">z3</span><span class="op" id="4164225">,</span>&nbsp;<span class="ident" id="4164227">x1</span><span class="op" id="4164229">,</span>&nbsp;<span class="ident" id="4164231">y1</span><span class="op" id="4164233">,</span>&nbsp;<span class="ident" id="4164235">z1</span><span class="op" id="4164237">,</span>&nbsp;<span class="ident" id="4164239">x2</span><span class="op" id="4164241">,</span>&nbsp;<span class="ident" id="4164243">y2</span><span class="op" id="4164245">,</span>&nbsp;<span class="ident" id="4164247">z2</span>&nbsp;<span class="op" id="4164250">*</span><span class="ident" id="4164251">p224FieldElement</span><span class="op" id="4164267">)</span>&nbsp;<span class="op" id="4164269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4164272">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#addition-p224Add-2007-bl</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4164366">var</span>&nbsp;<span class="ident" id="4164370">z1z1</span><span class="op" id="4164374">,</span>&nbsp;<span class="ident" id="4164376">z2z2</span><span class="op" id="4164380">,</span>&nbsp;<span class="ident" id="4164382">u1</span><span class="op" id="4164384">,</span>&nbsp;<span class="ident" id="4164386">u2</span><span class="op" id="4164388">,</span>&nbsp;<span class="ident" id="4164390">s1</span><span class="op" id="4164392">,</span>&nbsp;<span class="ident" id="4164394">s2</span><span class="op" id="4164396">,</span>&nbsp;<span class="ident" id="4164398">h</span><span class="op" id="4164399">,</span>&nbsp;<span class="ident" id="4164401">i</span><span class="op" id="4164402">,</span>&nbsp;<span class="ident" id="4164404">j</span><span class="op" id="4164405">,</span>&nbsp;<span class="ident" id="4164407">r</span><span class="op" id="4164408">,</span>&nbsp;<span class="ident" id="4164410">v</span>&nbsp;<span class="ident" id="4164412">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4164430">var</span>&nbsp;<span class="ident" id="4164434">c</span>&nbsp;<span class="ident" id="4164436">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164460">z1IsZero</span>&nbsp;<span class="op" id="4164469">:=</span>&nbsp;<span class="ident" id="4164472">p224IsZero</span><span class="op" id="4164482">(</span><span class="ident" id="4164483">z1</span><span class="op" id="4164485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164488">z2IsZero</span>&nbsp;<span class="op" id="4164497">:=</span>&nbsp;<span class="ident" id="4164500">p224IsZero</span><span class="op" id="4164510">(</span><span class="ident" id="4164511">z2</span><span class="op" id="4164513">)</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4164517">//&nbsp;Z1Z1&nbsp;=&nbsp;Z1²</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164533">p224Square</span><span class="op" id="4164543">(</span><span class="op" id="4164544">&amp;</span><span class="ident" id="4164545">z1z1</span><span class="op" id="4164549">,</span>&nbsp;<span class="ident" id="4164551">z1</span><span class="op" id="4164553">,</span>&nbsp;<span class="op" id="4164555">&amp;</span><span class="ident" id="4164556">c</span><span class="op" id="4164557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4164560">//&nbsp;Z2Z2&nbsp;=&nbsp;Z2²</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164576">p224Square</span><span class="op" id="4164586">(</span><span class="op" id="4164587">&amp;</span><span class="ident" id="4164588">z2z2</span><span class="op" id="4164592">,</span>&nbsp;<span class="ident" id="4164594">z2</span><span class="op" id="4164596">,</span>&nbsp;<span class="op" id="4164598">&amp;</span><span class="ident" id="4164599">c</span><span class="op" id="4164600">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4164603">//&nbsp;U1&nbsp;=&nbsp;X1*Z2Z2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164620">p224Mul</span><span class="op" id="4164627">(</span><span class="op" id="4164628">&amp;</span><span class="ident" id="4164629">u1</span><span class="op" id="4164631">,</span>&nbsp;<span class="ident" id="4164633">x1</span><span class="op" id="4164635">,</span>&nbsp;<span class="op" id="4164637">&amp;</span><span class="ident" id="4164638">z2z2</span><span class="op" id="4164642">,</span>&nbsp;<span class="op" id="4164644">&amp;</span><span class="ident" id="4164645">c</span><span class="op" id="4164646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4164649">//&nbsp;U2&nbsp;=&nbsp;X2*Z1Z1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164666">p224Mul</span><span class="op" id="4164673">(</span><span class="op" id="4164674">&amp;</span><span class="ident" id="4164675">u2</span><span class="op" id="4164677">,</span>&nbsp;<span class="ident" id="4164679">x2</span><span class="op" id="4164681">,</span>&nbsp;<span class="op" id="4164683">&amp;</span><span class="ident" id="4164684">z1z1</span><span class="op" id="4164688">,</span>&nbsp;<span class="op" id="4164690">&amp;</span><span class="ident" id="4164691">c</span><span class="op" id="4164692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4164695">//&nbsp;S1&nbsp;=&nbsp;Y1*Z2*Z2Z2</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164715">p224Mul</span><span class="op" id="4164722">(</span><span class="op" id="4164723">&amp;</span><span class="ident" id="4164724">s1</span><span class="op" id="4164726">,</span>&nbsp;<span class="ident" id="4164728">z2</span><span class="op" id="4164730">,</span>&nbsp;<span class="op" id="4164732">&amp;</span><span class="ident" id="4164733">z2z2</span><span class="op" id="4164737">,</span>&nbsp;<span class="op" id="4164739">&amp;</span><span class="ident" id="4164740">c</span><span class="op" id="4164741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164744">p224Mul</span><span class="op" id="4164751">(</span><span class="op" id="4164752">&amp;</span><span class="ident" id="4164753">s1</span><span class="op" id="4164755">,</span>&nbsp;<span class="ident" id="4164757">y1</span><span class="op" id="4164759">,</span>&nbsp;<span class="op" id="4164761">&amp;</span><span class="ident" id="4164762">s1</span><span class="op" id="4164764">,</span>&nbsp;<span class="op" id="4164766">&amp;</span><span class="ident" id="4164767">c</span><span class="op" id="4164768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4164771">//&nbsp;S2&nbsp;=&nbsp;Y2*Z1*Z1Z1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164791">p224Mul</span><span class="op" id="4164798">(</span><span class="op" id="4164799">&amp;</span><span class="ident" id="4164800">s2</span><span class="op" id="4164802">,</span>&nbsp;<span class="ident" id="4164804">z1</span><span class="op" id="4164806">,</span>&nbsp;<span class="op" id="4164808">&amp;</span><span class="ident" id="4164809">z1z1</span><span class="op" id="4164813">,</span>&nbsp;<span class="op" id="4164815">&amp;</span><span class="ident" id="4164816">c</span><span class="op" id="4164817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164820">p224Mul</span><span class="op" id="4164827">(</span><span class="op" id="4164828">&amp;</span><span class="ident" id="4164829">s2</span><span class="op" id="4164831">,</span>&nbsp;<span class="ident" id="4164833">y2</span><span class="op" id="4164835">,</span>&nbsp;<span class="op" id="4164837">&amp;</span><span class="ident" id="4164838">s2</span><span class="op" id="4164840">,</span>&nbsp;<span class="op" id="4164842">&amp;</span><span class="ident" id="4164843">c</span><span class="op" id="4164844">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4164847">//&nbsp;H&nbsp;=&nbsp;U2-U1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164861">p224Sub</span><span class="op" id="4164868">(</span><span class="op" id="4164869">&amp;</span><span class="ident" id="4164870">h</span><span class="op" id="4164871">,</span>&nbsp;<span class="op" id="4164873">&amp;</span><span class="ident" id="4164874">u2</span><span class="op" id="4164876">,</span>&nbsp;<span class="op" id="4164878">&amp;</span><span class="ident" id="4164879">u1</span><span class="op" id="4164881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164884">p224Reduce</span><span class="op" id="4164894">(</span><span class="op" id="4164895">&amp;</span><span class="ident" id="4164896">h</span><span class="op" id="4164897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164900">xEqual</span>&nbsp;<span class="op" id="4164907">:=</span>&nbsp;<span class="ident" id="4164910">p224IsZero</span><span class="op" id="4164920">(</span><span class="op" id="4164921">&amp;</span><span class="ident" id="4164922">h</span><span class="op" id="4164923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4164926">//&nbsp;I&nbsp;=&nbsp;(2*H)²</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4164942">for</span>&nbsp;<span class="ident" id="4164946">j</span>&nbsp;<span class="op" id="4164948">:=</span>&nbsp;<span class="num" id="4164951">0</span><span class="op" id="4164952">;</span>&nbsp;<span class="ident" id="4164954">j</span>&nbsp;<span class="op" id="4164956">&lt;</span>&nbsp;<span class="num" id="4164958">8</span><span class="op" id="4164959">;</span>&nbsp;<span class="ident" id="4164961">j</span><span class="op" id="4164962">++</span>&nbsp;<span class="op" id="4164965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164969">i</span><span class="op" id="4164970">[</span><span class="ident" id="4164971">j</span><span class="op" id="4164972">]</span>&nbsp;<span class="op" id="4164974">=</span>&nbsp;<span class="ident" id="4164976">h</span><span class="op" id="4164977">[</span><span class="ident" id="4164978">j</span><span class="op" id="4164979">]</span>&nbsp;<span class="op" id="4164981">&lt;&lt;</span>&nbsp;<span class="num" id="4164984">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4164987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164990">p224Reduce</span><span class="op" id="4165000">(</span><span class="op" id="4165001">&amp;</span><span class="ident" id="4165002">i</span><span class="op" id="4165003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165006">p224Square</span><span class="op" id="4165016">(</span><span class="op" id="4165017">&amp;</span><span class="ident" id="4165018">i</span><span class="op" id="4165019">,</span>&nbsp;<span class="op" id="4165021">&amp;</span><span class="ident" id="4165022">i</span><span class="op" id="4165023">,</span>&nbsp;<span class="op" id="4165025">&amp;</span><span class="ident" id="4165026">c</span><span class="op" id="4165027">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4165030">//&nbsp;J&nbsp;=&nbsp;H*I</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165042">p224Mul</span><span class="op" id="4165049">(</span><span class="op" id="4165050">&amp;</span><span class="ident" id="4165051">j</span><span class="op" id="4165052">,</span>&nbsp;<span class="op" id="4165054">&amp;</span><span class="ident" id="4165055">h</span><span class="op" id="4165056">,</span>&nbsp;<span class="op" id="4165058">&amp;</span><span class="ident" id="4165059">i</span><span class="op" id="4165060">,</span>&nbsp;<span class="op" id="4165062">&amp;</span><span class="ident" id="4165063">c</span><span class="op" id="4165064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4165067">//&nbsp;r&nbsp;=&nbsp;2*(S2-S1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165085">p224Sub</span><span class="op" id="4165092">(</span><span class="op" id="4165093">&amp;</span><span class="ident" id="4165094">r</span><span class="op" id="4165095">,</span>&nbsp;<span class="op" id="4165097">&amp;</span><span class="ident" id="4165098">s2</span><span class="op" id="4165100">,</span>&nbsp;<span class="op" id="4165102">&amp;</span><span class="ident" id="4165103">s1</span><span class="op" id="4165105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165108">p224Reduce</span><span class="op" id="4165118">(</span><span class="op" id="4165119">&amp;</span><span class="ident" id="4165120">r</span><span class="op" id="4165121">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165124">yEqual</span>&nbsp;<span class="op" id="4165131">:=</span>&nbsp;<span class="ident" id="4165134">p224IsZero</span><span class="op" id="4165144">(</span><span class="op" id="4165145">&amp;</span><span class="ident" id="4165146">r</span><span class="op" id="4165147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165150">if</span>&nbsp;<span class="ident" id="4165153">xEqual</span>&nbsp;<span class="op" id="4165160">==</span>&nbsp;<span class="num" id="4165163">1</span>&nbsp;<span class="op" id="4165165">&amp;&amp;</span>&nbsp;<span class="ident" id="4165168">yEqual</span>&nbsp;<span class="op" id="4165175">==</span>&nbsp;<span class="num" id="4165178">1</span>&nbsp;<span class="op" id="4165180">&amp;&amp;</span>&nbsp;<span class="ident" id="4165183">z1IsZero</span>&nbsp;<span class="op" id="4165192">==</span>&nbsp;<span class="num" id="4165195">0</span>&nbsp;<span class="op" id="4165197">&amp;&amp;</span>&nbsp;<span class="ident" id="4165200">z2IsZero</span>&nbsp;<span class="op" id="4165209">==</span>&nbsp;<span class="num" id="4165212">0</span>&nbsp;<span class="op" id="4165214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165218">p224DoubleJacobian</span><span class="op" id="4165236">(</span><span class="ident" id="4165237">x3</span><span class="op" id="4165239">,</span>&nbsp;<span class="ident" id="4165241">y3</span><span class="op" id="4165243">,</span>&nbsp;<span class="ident" id="4165245">z3</span><span class="op" id="4165247">,</span>&nbsp;<span class="ident" id="4165249">x1</span><span class="op" id="4165251">,</span>&nbsp;<span class="ident" id="4165253">y1</span><span class="op" id="4165255">,</span>&nbsp;<span class="ident" id="4165257">z1</span><span class="op" id="4165259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165263">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4165271">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165274">for</span>&nbsp;<span class="ident" id="4165278">i</span>&nbsp;<span class="op" id="4165280">:=</span>&nbsp;<span class="num" id="4165283">0</span><span class="op" id="4165284">;</span>&nbsp;<span class="ident" id="4165286">i</span>&nbsp;<span class="op" id="4165288">&lt;</span>&nbsp;<span class="num" id="4165290">8</span><span class="op" id="4165291">;</span>&nbsp;<span class="ident" id="4165293">i</span><span class="op" id="4165294">++</span>&nbsp;<span class="op" id="4165297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165301">r</span><span class="op" id="4165302">[</span><span class="ident" id="4165303">i</span><span class="op" id="4165304">]</span>&nbsp;<span class="op" id="4165306">&lt;&lt;=</span>&nbsp;<span class="num" id="4165310">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4165313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165316">p224Reduce</span><span class="op" id="4165326">(</span><span class="op" id="4165327">&amp;</span><span class="ident" id="4165328">r</span><span class="op" id="4165329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4165332">//&nbsp;V&nbsp;=&nbsp;U1*I</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165345">p224Mul</span><span class="op" id="4165352">(</span><span class="op" id="4165353">&amp;</span><span class="ident" id="4165354">v</span><span class="op" id="4165355">,</span>&nbsp;<span class="op" id="4165357">&amp;</span><span class="ident" id="4165358">u1</span><span class="op" id="4165360">,</span>&nbsp;<span class="op" id="4165362">&amp;</span><span class="ident" id="4165363">i</span><span class="op" id="4165364">,</span>&nbsp;<span class="op" id="4165366">&amp;</span><span class="ident" id="4165367">c</span><span class="op" id="4165368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4165371">//&nbsp;Z3&nbsp;=&nbsp;((Z1+Z2)²-Z1Z1-Z2Z2)*H</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165404">p224Add</span><span class="op" id="4165411">(</span><span class="op" id="4165412">&amp;</span><span class="ident" id="4165413">z1z1</span><span class="op" id="4165417">,</span>&nbsp;<span class="op" id="4165419">&amp;</span><span class="ident" id="4165420">z1z1</span><span class="op" id="4165424">,</span>&nbsp;<span class="op" id="4165426">&amp;</span><span class="ident" id="4165427">z2z2</span><span class="op" id="4165431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165434">p224Add</span><span class="op" id="4165441">(</span><span class="op" id="4165442">&amp;</span><span class="ident" id="4165443">z2z2</span><span class="op" id="4165447">,</span>&nbsp;<span class="ident" id="4165449">z1</span><span class="op" id="4165451">,</span>&nbsp;<span class="ident" id="4165453">z2</span><span class="op" id="4165455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165458">p224Reduce</span><span class="op" id="4165468">(</span><span class="op" id="4165469">&amp;</span><span class="ident" id="4165470">z2z2</span><span class="op" id="4165474">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165477">p224Square</span><span class="op" id="4165487">(</span><span class="op" id="4165488">&amp;</span><span class="ident" id="4165489">z2z2</span><span class="op" id="4165493">,</span>&nbsp;<span class="op" id="4165495">&amp;</span><span class="ident" id="4165496">z2z2</span><span class="op" id="4165500">,</span>&nbsp;<span class="op" id="4165502">&amp;</span><span class="ident" id="4165503">c</span><span class="op" id="4165504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165507">p224Sub</span><span class="op" id="4165514">(</span><span class="ident" id="4165515">z3</span><span class="op" id="4165517">,</span>&nbsp;<span class="op" id="4165519">&amp;</span><span class="ident" id="4165520">z2z2</span><span class="op" id="4165524">,</span>&nbsp;<span class="op" id="4165526">&amp;</span><span class="ident" id="4165527">z1z1</span><span class="op" id="4165531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165534">p224Reduce</span><span class="op" id="4165544">(</span><span class="ident" id="4165545">z3</span><span class="op" id="4165547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165550">p224Mul</span><span class="op" id="4165557">(</span><span class="ident" id="4165558">z3</span><span class="op" id="4165560">,</span>&nbsp;<span class="ident" id="4165562">z3</span><span class="op" id="4165564">,</span>&nbsp;<span class="op" id="4165566">&amp;</span><span class="ident" id="4165567">h</span><span class="op" id="4165568">,</span>&nbsp;<span class="op" id="4165570">&amp;</span><span class="ident" id="4165571">c</span><span class="op" id="4165572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4165575">//&nbsp;X3&nbsp;=&nbsp;r²-J-2*V</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165594">for</span>&nbsp;<span class="ident" id="4165598">i</span>&nbsp;<span class="op" id="4165600">:=</span>&nbsp;<span class="num" id="4165603">0</span><span class="op" id="4165604">;</span>&nbsp;<span class="ident" id="4165606">i</span>&nbsp;<span class="op" id="4165608">&lt;</span>&nbsp;<span class="num" id="4165610">8</span><span class="op" id="4165611">;</span>&nbsp;<span class="ident" id="4165613">i</span><span class="op" id="4165614">++</span>&nbsp;<span class="op" id="4165617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165621">z1z1</span><span class="op" id="4165625">[</span><span class="ident" id="4165626">i</span><span class="op" id="4165627">]</span>&nbsp;<span class="op" id="4165629">=</span>&nbsp;<span class="ident" id="4165631">v</span><span class="op" id="4165632">[</span><span class="ident" id="4165633">i</span><span class="op" id="4165634">]</span>&nbsp;<span class="op" id="4165636">&lt;&lt;</span>&nbsp;<span class="num" id="4165639">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4165642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165645">p224Add</span><span class="op" id="4165652">(</span><span class="op" id="4165653">&amp;</span><span class="ident" id="4165654">z1z1</span><span class="op" id="4165658">,</span>&nbsp;<span class="op" id="4165660">&amp;</span><span class="ident" id="4165661">j</span><span class="op" id="4165662">,</span>&nbsp;<span class="op" id="4165664">&amp;</span><span class="ident" id="4165665">z1z1</span><span class="op" id="4165669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165672">p224Reduce</span><span class="op" id="4165682">(</span><span class="op" id="4165683">&amp;</span><span class="ident" id="4165684">z1z1</span><span class="op" id="4165688">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165691">p224Square</span><span class="op" id="4165701">(</span><span class="ident" id="4165702">x3</span><span class="op" id="4165704">,</span>&nbsp;<span class="op" id="4165706">&amp;</span><span class="ident" id="4165707">r</span><span class="op" id="4165708">,</span>&nbsp;<span class="op" id="4165710">&amp;</span><span class="ident" id="4165711">c</span><span class="op" id="4165712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165715">p224Sub</span><span class="op" id="4165722">(</span><span class="ident" id="4165723">x3</span><span class="op" id="4165725">,</span>&nbsp;<span class="ident" id="4165727">x3</span><span class="op" id="4165729">,</span>&nbsp;<span class="op" id="4165731">&amp;</span><span class="ident" id="4165732">z1z1</span><span class="op" id="4165736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165739">p224Reduce</span><span class="op" id="4165749">(</span><span class="ident" id="4165750">x3</span><span class="op" id="4165752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4165755">//&nbsp;Y3&nbsp;=&nbsp;r*(V-X3)-2*S1*J</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165780">for</span>&nbsp;<span class="ident" id="4165784">i</span>&nbsp;<span class="op" id="4165786">:=</span>&nbsp;<span class="num" id="4165789">0</span><span class="op" id="4165790">;</span>&nbsp;<span class="ident" id="4165792">i</span>&nbsp;<span class="op" id="4165794">&lt;</span>&nbsp;<span class="num" id="4165796">8</span><span class="op" id="4165797">;</span>&nbsp;<span class="ident" id="4165799">i</span><span class="op" id="4165800">++</span>&nbsp;<span class="op" id="4165803">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165807">s1</span><span class="op" id="4165809">[</span><span class="ident" id="4165810">i</span><span class="op" id="4165811">]</span>&nbsp;<span class="op" id="4165813">&lt;&lt;=</span>&nbsp;<span class="num" id="4165817">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4165820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165823">p224Mul</span><span class="op" id="4165830">(</span><span class="op" id="4165831">&amp;</span><span class="ident" id="4165832">s1</span><span class="op" id="4165834">,</span>&nbsp;<span class="op" id="4165836">&amp;</span><span class="ident" id="4165837">s1</span><span class="op" id="4165839">,</span>&nbsp;<span class="op" id="4165841">&amp;</span><span class="ident" id="4165842">j</span><span class="op" id="4165843">,</span>&nbsp;<span class="op" id="4165845">&amp;</span><span class="ident" id="4165846">c</span><span class="op" id="4165847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165850">p224Sub</span><span class="op" id="4165857">(</span><span class="op" id="4165858">&amp;</span><span class="ident" id="4165859">z1z1</span><span class="op" id="4165863">,</span>&nbsp;<span class="op" id="4165865">&amp;</span><span class="ident" id="4165866">v</span><span class="op" id="4165867">,</span>&nbsp;<span class="ident" id="4165869">x3</span><span class="op" id="4165871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165874">p224Reduce</span><span class="op" id="4165884">(</span><span class="op" id="4165885">&amp;</span><span class="ident" id="4165886">z1z1</span><span class="op" id="4165890">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165893">p224Mul</span><span class="op" id="4165900">(</span><span class="op" id="4165901">&amp;</span><span class="ident" id="4165902">z1z1</span><span class="op" id="4165906">,</span>&nbsp;<span class="op" id="4165908">&amp;</span><span class="ident" id="4165909">z1z1</span><span class="op" id="4165913">,</span>&nbsp;<span class="op" id="4165915">&amp;</span><span class="ident" id="4165916">r</span><span class="op" id="4165917">,</span>&nbsp;<span class="op" id="4165919">&amp;</span><span class="ident" id="4165920">c</span><span class="op" id="4165921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165924">p224Sub</span><span class="op" id="4165931">(</span><span class="ident" id="4165932">y3</span><span class="op" id="4165934">,</span>&nbsp;<span class="op" id="4165936">&amp;</span><span class="ident" id="4165937">z1z1</span><span class="op" id="4165941">,</span>&nbsp;<span class="op" id="4165943">&amp;</span><span class="ident" id="4165944">s1</span><span class="op" id="4165946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165949">p224Reduce</span><span class="op" id="4165959">(</span><span class="ident" id="4165960">y3</span><span class="op" id="4165962">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165966">p224CopyConditional</span><span class="op" id="4165985">(</span><span class="ident" id="4165986">x3</span><span class="op" id="4165988">,</span>&nbsp;<span class="ident" id="4165990">x2</span><span class="op" id="4165992">,</span>&nbsp;<span class="ident" id="4165994">z1IsZero</span><span class="op" id="4166002">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166005">p224CopyConditional</span><span class="op" id="4166024">(</span><span class="ident" id="4166025">x3</span><span class="op" id="4166027">,</span>&nbsp;<span class="ident" id="4166029">x1</span><span class="op" id="4166031">,</span>&nbsp;<span class="ident" id="4166033">z2IsZero</span><span class="op" id="4166041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166044">p224CopyConditional</span><span class="op" id="4166063">(</span><span class="ident" id="4166064">y3</span><span class="op" id="4166066">,</span>&nbsp;<span class="ident" id="4166068">y2</span><span class="op" id="4166070">,</span>&nbsp;<span class="ident" id="4166072">z1IsZero</span><span class="op" id="4166080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166083">p224CopyConditional</span><span class="op" id="4166102">(</span><span class="ident" id="4166103">y3</span><span class="op" id="4166105">,</span>&nbsp;<span class="ident" id="4166107">y1</span><span class="op" id="4166109">,</span>&nbsp;<span class="ident" id="4166111">z2IsZero</span><span class="op" id="4166119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166122">p224CopyConditional</span><span class="op" id="4166141">(</span><span class="ident" id="4166142">z3</span><span class="op" id="4166144">,</span>&nbsp;<span class="ident" id="4166146">z2</span><span class="op" id="4166148">,</span>&nbsp;<span class="ident" id="4166150">z1IsZero</span><span class="op" id="4166158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166161">p224CopyConditional</span><span class="op" id="4166180">(</span><span class="ident" id="4166181">z3</span><span class="op" id="4166183">,</span>&nbsp;<span class="ident" id="4166185">z1</span><span class="op" id="4166187">,</span>&nbsp;<span class="ident" id="4166189">z2IsZero</span><span class="op" id="4166197">)</span><br>
<span class="lineno">585</span><span class="op" id="4166199">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4166202">//&nbsp;p224DoubleJacobian&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+a.</span><br>
<span class="lineno"></span><span class="keyword" id="4166245">func</span>&nbsp;<span class="ident" id="4166250">p224DoubleJacobian</span><span class="op" id="4166268">(</span><span class="ident" id="4166269">x3</span><span class="op" id="4166271">,</span>&nbsp;<span class="ident" id="4166273">y3</span><span class="op" id="4166275">,</span>&nbsp;<span class="ident" id="4166277">z3</span><span class="op" id="4166279">,</span>&nbsp;<span class="ident" id="4166281">x1</span><span class="op" id="4166283">,</span>&nbsp;<span class="ident" id="4166285">y1</span><span class="op" id="4166287">,</span>&nbsp;<span class="ident" id="4166289">z1</span>&nbsp;<span class="op" id="4166292">*</span><span class="ident" id="4166293">p224FieldElement</span><span class="op" id="4166309">)</span>&nbsp;<span class="op" id="4166311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4166314">var</span>&nbsp;<span class="ident" id="4166318">delta</span><span class="op" id="4166323">,</span>&nbsp;<span class="ident" id="4166325">gamma</span><span class="op" id="4166330">,</span>&nbsp;<span class="ident" id="4166332">beta</span><span class="op" id="4166336">,</span>&nbsp;<span class="ident" id="4166338">alpha</span><span class="op" id="4166343">,</span>&nbsp;<span class="ident" id="4166345">t</span>&nbsp;<span class="ident" id="4166347">p224FieldElement</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4166365">var</span>&nbsp;<span class="ident" id="4166369">c</span>&nbsp;<span class="ident" id="4166371">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166395">p224Square</span><span class="op" id="4166405">(</span><span class="op" id="4166406">&amp;</span><span class="ident" id="4166407">delta</span><span class="op" id="4166412">,</span>&nbsp;<span class="ident" id="4166414">z1</span><span class="op" id="4166416">,</span>&nbsp;<span class="op" id="4166418">&amp;</span><span class="ident" id="4166419">c</span><span class="op" id="4166420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166423">p224Square</span><span class="op" id="4166433">(</span><span class="op" id="4166434">&amp;</span><span class="ident" id="4166435">gamma</span><span class="op" id="4166440">,</span>&nbsp;<span class="ident" id="4166442">y1</span><span class="op" id="4166444">,</span>&nbsp;<span class="op" id="4166446">&amp;</span><span class="ident" id="4166447">c</span><span class="op" id="4166448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166451">p224Mul</span><span class="op" id="4166458">(</span><span class="op" id="4166459">&amp;</span><span class="ident" id="4166460">beta</span><span class="op" id="4166464">,</span>&nbsp;<span class="ident" id="4166466">x1</span><span class="op" id="4166468">,</span>&nbsp;<span class="op" id="4166470">&amp;</span><span class="ident" id="4166471">gamma</span><span class="op" id="4166476">,</span>&nbsp;<span class="op" id="4166478">&amp;</span><span class="ident" id="4166479">c</span><span class="op" id="4166480">)</span><br>
<span class="lineno">595</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4166484">//&nbsp;alpha&nbsp;=&nbsp;3*(X1-delta)*(X1+delta)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166520">p224Add</span><span class="op" id="4166527">(</span><span class="op" id="4166528">&amp;</span><span class="ident" id="4166529">t</span><span class="op" id="4166530">,</span>&nbsp;<span class="ident" id="4166532">x1</span><span class="op" id="4166534">,</span>&nbsp;<span class="op" id="4166536">&amp;</span><span class="ident" id="4166537">delta</span><span class="op" id="4166542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4166545">for</span>&nbsp;<span class="ident" id="4166549">i</span>&nbsp;<span class="op" id="4166551">:=</span>&nbsp;<span class="num" id="4166554">0</span><span class="op" id="4166555">;</span>&nbsp;<span class="ident" id="4166557">i</span>&nbsp;<span class="op" id="4166559">&lt;</span>&nbsp;<span class="num" id="4166561">8</span><span class="op" id="4166562">;</span>&nbsp;<span class="ident" id="4166564">i</span><span class="op" id="4166565">++</span>&nbsp;<span class="op" id="4166568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166572">t</span><span class="op" id="4166573">[</span><span class="ident" id="4166574">i</span><span class="op" id="4166575">]</span>&nbsp;<span class="op" id="4166577">+=</span>&nbsp;<span class="ident" id="4166580">t</span><span class="op" id="4166581">[</span><span class="ident" id="4166582">i</span><span class="op" id="4166583">]</span>&nbsp;<span class="op" id="4166585">&lt;&lt;</span>&nbsp;<span class="num" id="4166588">1</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4166591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166594">p224Reduce</span><span class="op" id="4166604">(</span><span class="op" id="4166605">&amp;</span><span class="ident" id="4166606">t</span><span class="op" id="4166607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166610">p224Sub</span><span class="op" id="4166617">(</span><span class="op" id="4166618">&amp;</span><span class="ident" id="4166619">alpha</span><span class="op" id="4166624">,</span>&nbsp;<span class="ident" id="4166626">x1</span><span class="op" id="4166628">,</span>&nbsp;<span class="op" id="4166630">&amp;</span><span class="ident" id="4166631">delta</span><span class="op" id="4166636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166639">p224Reduce</span><span class="op" id="4166649">(</span><span class="op" id="4166650">&amp;</span><span class="ident" id="4166651">alpha</span><span class="op" id="4166656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166659">p224Mul</span><span class="op" id="4166666">(</span><span class="op" id="4166667">&amp;</span><span class="ident" id="4166668">alpha</span><span class="op" id="4166673">,</span>&nbsp;<span class="op" id="4166675">&amp;</span><span class="ident" id="4166676">alpha</span><span class="op" id="4166681">,</span>&nbsp;<span class="op" id="4166683">&amp;</span><span class="ident" id="4166684">t</span><span class="op" id="4166685">,</span>&nbsp;<span class="op" id="4166687">&amp;</span><span class="ident" id="4166688">c</span><span class="op" id="4166689">)</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4166693">//&nbsp;Z3&nbsp;=&nbsp;(Y1+Z1)²-gamma-delta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166724">p224Add</span><span class="op" id="4166731">(</span><span class="ident" id="4166732">z3</span><span class="op" id="4166734">,</span>&nbsp;<span class="ident" id="4166736">y1</span><span class="op" id="4166738">,</span>&nbsp;<span class="ident" id="4166740">z1</span><span class="op" id="4166742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166745">p224Reduce</span><span class="op" id="4166755">(</span><span class="ident" id="4166756">z3</span><span class="op" id="4166758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166761">p224Square</span><span class="op" id="4166771">(</span><span class="ident" id="4166772">z3</span><span class="op" id="4166774">,</span>&nbsp;<span class="ident" id="4166776">z3</span><span class="op" id="4166778">,</span>&nbsp;<span class="op" id="4166780">&amp;</span><span class="ident" id="4166781">c</span><span class="op" id="4166782">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166785">p224Sub</span><span class="op" id="4166792">(</span><span class="ident" id="4166793">z3</span><span class="op" id="4166795">,</span>&nbsp;<span class="ident" id="4166797">z3</span><span class="op" id="4166799">,</span>&nbsp;<span class="op" id="4166801">&amp;</span><span class="ident" id="4166802">gamma</span><span class="op" id="4166807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166810">p224Reduce</span><span class="op" id="4166820">(</span><span class="ident" id="4166821">z3</span><span class="op" id="4166823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166826">p224Sub</span><span class="op" id="4166833">(</span><span class="ident" id="4166834">z3</span><span class="op" id="4166836">,</span>&nbsp;<span class="ident" id="4166838">z3</span><span class="op" id="4166840">,</span>&nbsp;<span class="op" id="4166842">&amp;</span><span class="ident" id="4166843">delta</span><span class="op" id="4166848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166851">p224Reduce</span><span class="op" id="4166861">(</span><span class="ident" id="4166862">z3</span><span class="op" id="4166864">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4166868">//&nbsp;X3&nbsp;=&nbsp;alpha²-8*beta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4166892">for</span>&nbsp;<span class="ident" id="4166896">i</span>&nbsp;<span class="op" id="4166898">:=</span>&nbsp;<span class="num" id="4166901">0</span><span class="op" id="4166902">;</span>&nbsp;<span class="ident" id="4166904">i</span>&nbsp;<span class="op" id="4166906">&lt;</span>&nbsp;<span class="num" id="4166908">8</span><span class="op" id="4166909">;</span>&nbsp;<span class="ident" id="4166911">i</span><span class="op" id="4166912">++</span>&nbsp;<span class="op" id="4166915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166919">delta</span><span class="op" id="4166924">[</span><span class="ident" id="4166925">i</span><span class="op" id="4166926">]</span>&nbsp;<span class="op" id="4166928">=</span>&nbsp;<span class="ident" id="4166930">beta</span><span class="op" id="4166934">[</span><span class="ident" id="4166935">i</span><span class="op" id="4166936">]</span>&nbsp;<span class="op" id="4166938">&lt;&lt;</span>&nbsp;<span class="num" id="4166941">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4166944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166947">p224Reduce</span><span class="op" id="4166957">(</span><span class="op" id="4166958">&amp;</span><span class="ident" id="4166959">delta</span><span class="op" id="4166964">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166967">p224Square</span><span class="op" id="4166977">(</span><span class="ident" id="4166978">x3</span><span class="op" id="4166980">,</span>&nbsp;<span class="op" id="4166982">&amp;</span><span class="ident" id="4166983">alpha</span><span class="op" id="4166988">,</span>&nbsp;<span class="op" id="4166990">&amp;</span><span class="ident" id="4166991">c</span><span class="op" id="4166992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166995">p224Sub</span><span class="op" id="4167002">(</span><span class="ident" id="4167003">x3</span><span class="op" id="4167005">,</span>&nbsp;<span class="ident" id="4167007">x3</span><span class="op" id="4167009">,</span>&nbsp;<span class="op" id="4167011">&amp;</span><span class="ident" id="4167012">delta</span><span class="op" id="4167017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4167020">p224Reduce</span><span class="op" id="4167030">(</span><span class="ident" id="4167031">x3</span><span class="op" id="4167033">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4167037">//&nbsp;Y3&nbsp;=&nbsp;alpha*(4*beta-X3)-8*gamma²</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4167074">for</span>&nbsp;<span class="ident" id="4167078">i</span>&nbsp;<span class="op" id="4167080">:=</span>&nbsp;<span class="num" id="4167083">0</span><span class="op" id="4167084">;</span>&nbsp;<span class="ident" id="4167086">i</span>&nbsp;<span class="op" id="4167088">&lt;</span>&nbsp;<span class="num" id="4167090">8</span><span class="op" id="4167091">;</span>&nbsp;<span class="ident" id="4167093">i</span><span class="op" id="4167094">++</span>&nbsp;<span class="op" id="4167097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4167101">beta</span><span class="op" id="4167105">[</span><span class="ident" id="4167106">i</span><span class="op" id="4167107">]</span>&nbsp;<span class="op" id="4167109">&lt;&lt;=</span>&nbsp;<span class="num" id="4167113">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4167116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4167119">p224Sub</span><span class="op" id="4167126">(</span><span class="op" id="4167127">&amp;</span><span class="ident" id="4167128">beta</span><span class="op" id="4167132">,</span>&nbsp;<span class="op" id="4167134">&amp;</span><span class="ident" id="4167135">beta</span><span class="op" id="4167139">,</span>&nbsp;<span class="ident" id="4167141">x3</span><span class="op" id="4167143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4167146">p224Reduce</span><span class="op" id="4167156">(</span><span class="op" id="4167157">&amp;</span><span class="ident" id="4167158">beta</span><span class="op" id="4167162">)</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4167165">p224Square</span><span class="op" id="4167175">(</span><span class="op" id="4167176">&amp;</span><span class="ident" id="4167177">gamma</span><span class="op" id="4167182">,</span>&nbsp;<span class="op" id="4167184">&amp;</span><span class="ident" id="4167185">gamma</span><span class="op" id="4167190">,</span>&nbsp;<span class="op" id="4167192">&amp;</span><span class="ident" id="4167193">c</span><span class="op" id="4167194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4167197">for</span>&nbsp;<span class="ident" id="4167201">i</span>&nbsp;<span class="op" id="4167203">:=</span>&nbsp;<span class="num" id="4167206">0</span><span class="op" id="4167207">;</span>&nbsp;<span class="ident" id="4167209">i</span>&nbsp;<span class="op" id="4167211">&lt;</span>&nbsp;<span class="num" id="4167213">8</span><span class="op" id="4167214">;</span>&nbsp;<span class="ident" id="4167216">i</span><span class="op" id="4167217">++</span>&nbsp;<span class="op" id="4167220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4167224">gamma</span><span class="op" id="4167229">[</span><span class="ident" id="4167230">i</span><span class="op" id="4167231">]</span>&nbsp;<span class="op" id="4167233">&lt;&lt;=</span>&nbsp;<span class="num" id="4167237">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4167240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4167243">p224Reduce</span><span class="op" id="4167253">(</span><span class="op" id="4167254">&amp;</span><span class="ident" id="4167255">gamma</span><span class="op" id="4167260">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4167263">p224Mul</span><span class="op" id="4167270">(</span><span class="ident" id="4167271">y3</span><span class="op" id="4167273">,</span>&nbsp;<span class="op" id="4167275">&amp;</span><span class="ident" id="4167276">alpha</span><span class="op" id="4167281">,</span>&nbsp;<span class="op" id="4167283">&amp;</span><span class="ident" id="4167284">beta</span><span class="op" id="4167288">,</span>&nbsp;<span class="op" id="4167290">&amp;</span><span class="ident" id="4167291">c</span><span class="op" id="4167292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4167295">p224Sub</span><span class="op" id="4167302">(</span><span class="ident" id="4167303">y3</span><span class="op" id="4167305">,</span>&nbsp;<span class="ident" id="4167307">y3</span><span class="op" id="4167309">,</span>&nbsp;<span class="op" id="4167311">&amp;</span><span class="ident" id="4167312">gamma</span><span class="op" id="4167317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4167320">p224Reduce</span><span class="op" id="4167330">(</span><span class="ident" id="4167331">y3</span><span class="op" id="4167333">)</span><br>
<span class="lineno"></span><span class="op" id="4167335">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">640</span><span class="comment" id="4167338">//&nbsp;p224CopyConditional&nbsp;sets&nbsp;*out&nbsp;=&nbsp;*in&nbsp;iff&nbsp;the&nbsp;least-significant-bit&nbsp;of&nbsp;control</span><br>
<span class="lineno"></span><span class="comment" id="4167418">//&nbsp;is&nbsp;true,&nbsp;and&nbsp;it&nbsp;runs&nbsp;in&nbsp;constant&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="4167460">func</span>&nbsp;<span class="ident" id="4167465">p224CopyConditional</span><span class="op" id="4167484">(</span><span class="ident" id="4167485">out</span><span class="op" id="4167488">,</span>&nbsp;<span class="ident" id="4167490">in</span>&nbsp;<span class="op" id="4167493">*</span><span class="ident" id="4167494">p224FieldElement</span><span class="op" id="4167510">,</span>&nbsp;<span class="ident" id="4167512">control</span>&nbsp;<span class="builtintype" id="4167520">uint32</span><span class="op" id="4167526">)</span>&nbsp;<span class="op" id="4167528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4167531">control</span>&nbsp;<span class="op" id="4167539">&lt;&lt;=</span>&nbsp;<span class="num" id="4167543">31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4167547">control</span>&nbsp;<span class="op" id="4167555">=</span>&nbsp;<span class="builtintype" id="4167557">uint32</span><span class="op" id="4167563">(</span><span class="builtintype" id="4167564">int32</span><span class="op" id="4167569">(</span><span class="ident" id="4167570">control</span><span class="op" id="4167577">)</span>&nbsp;<span class="op" id="4167579">&gt;&gt;</span>&nbsp;<span class="num" id="4167582">31</span><span class="op" id="4167584">)</span><br>
<span class="lineno">645</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4167588">for</span>&nbsp;<span class="ident" id="4167592">i</span>&nbsp;<span class="op" id="4167594">:=</span>&nbsp;<span class="num" id="4167597">0</span><span class="op" id="4167598">;</span>&nbsp;<span class="ident" id="4167600">i</span>&nbsp;<span class="op" id="4167602">&lt;</span>&nbsp;<span class="num" id="4167604">8</span><span class="op" id="4167605">;</span>&nbsp;<span class="ident" id="4167607">i</span><span class="op" id="4167608">++</span>&nbsp;<span class="op" id="4167611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4167615">out</span><span class="op" id="4167618">[</span><span class="ident" id="4167619">i</span><span class="op" id="4167620">]</span>&nbsp;<span class="op" id="4167622">^=</span>&nbsp;<span class="op" id="4167625">(</span><span class="ident" id="4167626">out</span><span class="op" id="4167629">[</span><span class="ident" id="4167630">i</span><span class="op" id="4167631">]</span>&nbsp;<span class="op" id="4167633">^</span>&nbsp;<span class="ident" id="4167635">in</span><span class="op" id="4167637">[</span><span class="ident" id="4167638">i</span><span class="op" id="4167639">]</span><span class="op" id="4167640">)</span>&nbsp;<span class="op" id="4167642">&amp;</span>&nbsp;<span class="ident" id="4167644">control</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4167653">}</span><br>
<span class="lineno"></span><span class="op" id="4167655">}</span><br>
<span class="lineno">650</span><br>
<span class="lineno"></span><span class="keyword" id="4167658">func</span>&nbsp;<span class="ident" id="4167663">p224ScalarMult</span><span class="op" id="4167677">(</span><span class="ident" id="4167678">outX</span><span class="op" id="4167682">,</span>&nbsp;<span class="ident" id="4167684">outY</span><span class="op" id="4167688">,</span>&nbsp;<span class="ident" id="4167690">outZ</span><span class="op" id="4167694">,</span>&nbsp;<span class="ident" id="4167696">inX</span><span class="op" id="4167699">,</span>&nbsp;<span class="ident" id="4167701">inY</span><span class="op" id="4167704">,</span>&nbsp;<span class="ident" id="4167706">inZ</span>&nbsp;<span class="op" id="4167710">*</span><span class="ident" id="4167711">p224FieldElement</span><span class="op" id="4167727">,</span>&nbsp;<span class="ident" id="4167729">scalar</span>&nbsp;<span class="op" id="4167736">[</span><span class="op" id="4167737">]</span><span class="builtintype" id="4167738">byte</span><span class="op" id="4167742">)</span>&nbsp;<span class="op" id="4167744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4167747">var</span>&nbsp;<span class="ident" id="4167751">xx</span><span class="op" id="4167753">,</span>&nbsp;<span class="ident" id="4167755">yy</span><span class="op" id="4167757">,</span>&nbsp;<span class="ident" id="4167759">zz</span>&nbsp;<span class="ident" id="4167762">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4167780">for</span>&nbsp;<span class="ident" id="4167784">i</span>&nbsp;<span class="op" id="4167786">:=</span>&nbsp;<span class="num" id="4167789">0</span><span class="op" id="4167790">;</span>&nbsp;<span class="ident" id="4167792">i</span>&nbsp;<span class="op" id="4167794">&lt;</span>&nbsp;<span class="num" id="4167796">8</span><span class="op" id="4167797">;</span>&nbsp;<span class="ident" id="4167799">i</span><span class="op" id="4167800">++</span>&nbsp;<span class="op" id="4167803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4167807">outX</span><span class="op" id="4167811">[</span><span class="ident" id="4167812">i</span><span class="op" id="4167813">]</span>&nbsp;<span class="op" id="4167815">=</span>&nbsp;<span class="num" id="4167817">0</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4167821">outY</span><span class="op" id="4167825">[</span><span class="ident" id="4167826">i</span><span class="op" id="4167827">]</span>&nbsp;<span class="op" id="4167829">=</span>&nbsp;<span class="num" id="4167831">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4167835">outZ</span><span class="op" id="4167839">[</span><span class="ident" id="4167840">i</span><span class="op" id="4167841">]</span>&nbsp;<span class="op" id="4167843">=</span>&nbsp;<span class="num" id="4167845">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4167848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4167852">for</span>&nbsp;<span class="ident" id="4167856">_</span><span class="op" id="4167857">,</span>&nbsp;<span class="builtintype" id="4167859">byte</span>&nbsp;<span class="op" id="4167864">:=</span>&nbsp;<span class="keyword" id="4167867">range</span>&nbsp;<span class="ident" id="4167873">scalar</span>&nbsp;<span class="op" id="4167880">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4167884">for</span>&nbsp;<span class="ident" id="4167888">bitNum</span>&nbsp;<span class="op" id="4167895">:=</span>&nbsp;<span class="builtintype" id="4167898">uint</span><span class="op" id="4167902">(</span><span class="num" id="4167903">0</span><span class="op" id="4167904">)</span><span class="op" id="4167905">;</span>&nbsp;<span class="ident" id="4167907">bitNum</span>&nbsp;<span class="op" id="4167914">&lt;</span>&nbsp;<span class="num" id="4167916">8</span><span class="op" id="4167917">;</span>&nbsp;<span class="ident" id="4167919">bitNum</span><span class="op" id="4167925">++</span>&nbsp;<span class="op" id="4167928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4167933">p224DoubleJacobian</span><span class="op" id="4167951">(</span><span class="ident" id="4167952">outX</span><span class="op" id="4167956">,</span>&nbsp;<span class="ident" id="4167958">outY</span><span class="op" id="4167962">,</span>&nbsp;<span class="ident" id="4167964">outZ</span><span class="op" id="4167968">,</span>&nbsp;<span class="ident" id="4167970">outX</span><span class="op" id="4167974">,</span>&nbsp;<span class="ident" id="4167976">outY</span><span class="op" id="4167980">,</span>&nbsp;<span class="ident" id="4167982">outZ</span><span class="op" id="4167986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4167991">bit</span>&nbsp;<span class="op" id="4167995">:=</span>&nbsp;<span class="builtintype" id="4167998">uint32</span><span class="op" id="4168004">(</span><span class="op" id="4168005">(</span><span class="builtintype" id="4168006">byte</span>&nbsp;<span class="op" id="4168011">&gt;&gt;</span>&nbsp;<span class="op" id="4168014">(</span><span class="num" id="4168015">7</span>&nbsp;<span class="op" id="4168017">-</span>&nbsp;<span class="ident" id="4168019">bitNum</span><span class="op" id="4168025">)</span><span class="op" id="4168026">)</span>&nbsp;<span class="op" id="4168028">&amp;</span>&nbsp;<span class="num" id="4168030">1</span><span class="op" id="4168031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168036">p224AddJacobian</span><span class="op" id="4168051">(</span><span class="op" id="4168052">&amp;</span><span class="ident" id="4168053">xx</span><span class="op" id="4168055">,</span>&nbsp;<span class="op" id="4168057">&amp;</span><span class="ident" id="4168058">yy</span><span class="op" id="4168060">,</span>&nbsp;<span class="op" id="4168062">&amp;</span><span class="ident" id="4168063">zz</span><span class="op" id="4168065">,</span>&nbsp;<span class="ident" id="4168067">inX</span><span class="op" id="4168070">,</span>&nbsp;<span class="ident" id="4168072">inY</span><span class="op" id="4168075">,</span>&nbsp;<span class="ident" id="4168077">inZ</span><span class="op" id="4168080">,</span>&nbsp;<span class="ident" id="4168082">outX</span><span class="op" id="4168086">,</span>&nbsp;<span class="ident" id="4168088">outY</span><span class="op" id="4168092">,</span>&nbsp;<span class="ident" id="4168094">outZ</span><span class="op" id="4168098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168103">p224CopyConditional</span><span class="op" id="4168122">(</span><span class="ident" id="4168123">outX</span><span class="op" id="4168127">,</span>&nbsp;<span class="op" id="4168129">&amp;</span><span class="ident" id="4168130">xx</span><span class="op" id="4168132">,</span>&nbsp;<span class="ident" id="4168134">bit</span><span class="op" id="4168137">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168142">p224CopyConditional</span><span class="op" id="4168161">(</span><span class="ident" id="4168162">outY</span><span class="op" id="4168166">,</span>&nbsp;<span class="op" id="4168168">&amp;</span><span class="ident" id="4168169">yy</span><span class="op" id="4168171">,</span>&nbsp;<span class="ident" id="4168173">bit</span><span class="op" id="4168176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168181">p224CopyConditional</span><span class="op" id="4168200">(</span><span class="ident" id="4168201">outZ</span><span class="op" id="4168205">,</span>&nbsp;<span class="op" id="4168207">&amp;</span><span class="ident" id="4168208">zz</span><span class="op" id="4168210">,</span>&nbsp;<span class="ident" id="4168212">bit</span><span class="op" id="4168215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4168219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4168222">}</span><br>
<span class="lineno"></span><span class="op" id="4168224">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="comment" id="4168227">//&nbsp;p224ToAffine&nbsp;converts&nbsp;from&nbsp;Jacobian&nbsp;to&nbsp;affine&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4168282">func</span>&nbsp;<span class="ident" id="4168287">p224ToAffine</span><span class="op" id="4168299">(</span><span class="ident" id="4168300">x</span><span class="op" id="4168301">,</span>&nbsp;<span class="ident" id="4168303">y</span><span class="op" id="4168304">,</span>&nbsp;<span class="ident" id="4168306">z</span>&nbsp;<span class="op" id="4168308">*</span><span class="ident" id="4168309">p224FieldElement</span><span class="op" id="4168325">)</span>&nbsp;<span class="op" id="4168327">(</span><span class="op" id="4168328">*</span><span class="ident" id="4168329">big</span><span class="op" id="4168332">.</span><span class="ident" id="4168333">Int</span><span class="op" id="4168336">,</span>&nbsp;<span class="op" id="4168338">*</span><span class="ident" id="4168339">big</span><span class="op" id="4168342">.</span><span class="ident" id="4168343">Int</span><span class="op" id="4168346">)</span>&nbsp;<span class="op" id="4168348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4168351">var</span>&nbsp;<span class="ident" id="4168355">zinv</span><span class="op" id="4168359">,</span>&nbsp;<span class="ident" id="4168361">zinvsq</span><span class="op" id="4168367">,</span>&nbsp;<span class="ident" id="4168369">outx</span><span class="op" id="4168373">,</span>&nbsp;<span class="ident" id="4168375">outy</span>&nbsp;<span class="ident" id="4168380">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4168398">var</span>&nbsp;<span class="ident" id="4168402">tmp</span>&nbsp;<span class="ident" id="4168406">p224LargeFieldElement</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4168430">if</span>&nbsp;<span class="ident" id="4168433">isPointAtInfinity</span>&nbsp;<span class="op" id="4168451">:=</span>&nbsp;<span class="ident" id="4168454">p224IsZero</span><span class="op" id="4168464">(</span><span class="ident" id="4168465">z</span><span class="op" id="4168466">)</span><span class="op" id="4168467">;</span>&nbsp;<span class="ident" id="4168469">isPointAtInfinity</span>&nbsp;<span class="op" id="4168487">==</span>&nbsp;<span class="num" id="4168490">1</span>&nbsp;<span class="op" id="4168492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4168496">return</span>&nbsp;<span class="builtinfunc" id="4168503">new</span><span class="op" id="4168506">(</span><span class="ident" id="4168507">big</span><span class="op" id="4168510">.</span><span class="ident" id="4168511">Int</span><span class="op" id="4168514">)</span><span class="op" id="4168515">,</span>&nbsp;<span class="builtinfunc" id="4168517">new</span><span class="op" id="4168520">(</span><span class="ident" id="4168521">big</span><span class="op" id="4168524">.</span><span class="ident" id="4168525">Int</span><span class="op" id="4168528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4168531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168535">p224Invert</span><span class="op" id="4168545">(</span><span class="op" id="4168546">&amp;</span><span class="ident" id="4168547">zinv</span><span class="op" id="4168551">,</span>&nbsp;<span class="ident" id="4168553">z</span><span class="op" id="4168554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168557">p224Square</span><span class="op" id="4168567">(</span><span class="op" id="4168568">&amp;</span><span class="ident" id="4168569">zinvsq</span><span class="op" id="4168575">,</span>&nbsp;<span class="op" id="4168577">&amp;</span><span class="ident" id="4168578">zinv</span><span class="op" id="4168582">,</span>&nbsp;<span class="op" id="4168584">&amp;</span><span class="ident" id="4168585">tmp</span><span class="op" id="4168588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168591">p224Mul</span><span class="op" id="4168598">(</span><span class="ident" id="4168599">x</span><span class="op" id="4168600">,</span>&nbsp;<span class="ident" id="4168602">x</span><span class="op" id="4168603">,</span>&nbsp;<span class="op" id="4168605">&amp;</span><span class="ident" id="4168606">zinvsq</span><span class="op" id="4168612">,</span>&nbsp;<span class="op" id="4168614">&amp;</span><span class="ident" id="4168615">tmp</span><span class="op" id="4168618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168621">p224Mul</span><span class="op" id="4168628">(</span><span class="op" id="4168629">&amp;</span><span class="ident" id="4168630">zinvsq</span><span class="op" id="4168636">,</span>&nbsp;<span class="op" id="4168638">&amp;</span><span class="ident" id="4168639">zinvsq</span><span class="op" id="4168645">,</span>&nbsp;<span class="op" id="4168647">&amp;</span><span class="ident" id="4168648">zinv</span><span class="op" id="4168652">,</span>&nbsp;<span class="op" id="4168654">&amp;</span><span class="ident" id="4168655">tmp</span><span class="op" id="4168658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168661">p224Mul</span><span class="op" id="4168668">(</span><span class="ident" id="4168669">y</span><span class="op" id="4168670">,</span>&nbsp;<span class="ident" id="4168672">y</span><span class="op" id="4168673">,</span>&nbsp;<span class="op" id="4168675">&amp;</span><span class="ident" id="4168676">zinvsq</span><span class="op" id="4168682">,</span>&nbsp;<span class="op" id="4168684">&amp;</span><span class="ident" id="4168685">tmp</span><span class="op" id="4168688">)</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168692">p224Contract</span><span class="op" id="4168704">(</span><span class="op" id="4168705">&amp;</span><span class="ident" id="4168706">outx</span><span class="op" id="4168710">,</span>&nbsp;<span class="ident" id="4168712">x</span><span class="op" id="4168713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168716">p224Contract</span><span class="op" id="4168728">(</span><span class="op" id="4168729">&amp;</span><span class="ident" id="4168730">outy</span><span class="op" id="4168734">,</span>&nbsp;<span class="ident" id="4168736">y</span><span class="op" id="4168737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4168740">return</span>&nbsp;<span class="ident" id="4168747">p224ToBig</span><span class="op" id="4168756">(</span><span class="op" id="4168757">&amp;</span><span class="ident" id="4168758">outx</span><span class="op" id="4168762">)</span><span class="op" id="4168763">,</span>&nbsp;<span class="ident" id="4168765">p224ToBig</span><span class="op" id="4168774">(</span><span class="op" id="4168775">&amp;</span><span class="ident" id="4168776">outy</span><span class="op" id="4168780">)</span><br>
<span class="lineno"></span><span class="op" id="4168782">}</span><br>
<span class="lineno">690</span><br>
<span class="lineno"></span><span class="comment" id="4168785">//&nbsp;get28BitsFromEnd&nbsp;returns&nbsp;the&nbsp;least-significant&nbsp;28&nbsp;bits&nbsp;from&nbsp;buf&gt;&gt;shift,</span><br>
<span class="lineno"></span><span class="comment" id="4168860">//&nbsp;where&nbsp;buf&nbsp;is&nbsp;interpreted&nbsp;as&nbsp;a&nbsp;big-endian&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="4168912">func</span>&nbsp;<span class="ident" id="4168917">get28BitsFromEnd</span><span class="op" id="4168933">(</span><span class="ident" id="4168934">buf</span>&nbsp;<span class="op" id="4168938">[</span><span class="op" id="4168939">]</span><span class="builtintype" id="4168940">byte</span><span class="op" id="4168944">,</span>&nbsp;<span class="ident" id="4168946">shift</span>&nbsp;<span class="builtintype" id="4168952">uint</span><span class="op" id="4168956">)</span>&nbsp;<span class="op" id="4168958">(</span><span class="builtintype" id="4168959">uint32</span><span class="op" id="4168965">,</span>&nbsp;<span class="op" id="4168967">[</span><span class="op" id="4168968">]</span><span class="builtintype" id="4168969">byte</span><span class="op" id="4168973">)</span>&nbsp;<span class="op" id="4168975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4168978">var</span>&nbsp;<span class="ident" id="4168982">ret</span>&nbsp;<span class="builtintype" id="4168986">uint32</span><br>
<span class="lineno">695</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4168995">for</span>&nbsp;<span class="ident" id="4168999">i</span>&nbsp;<span class="op" id="4169001">:=</span>&nbsp;<span class="builtintype" id="4169004">uint</span><span class="op" id="4169008">(</span><span class="num" id="4169009">0</span><span class="op" id="4169010">)</span><span class="op" id="4169011">;</span>&nbsp;<span class="ident" id="4169013">i</span>&nbsp;<span class="op" id="4169015">&lt;</span>&nbsp;<span class="num" id="4169017">4</span><span class="op" id="4169018">;</span>&nbsp;<span class="ident" id="4169020">i</span><span class="op" id="4169021">++</span>&nbsp;<span class="op" id="4169024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4169028">var</span>&nbsp;<span class="ident" id="4169032">b</span>&nbsp;<span class="builtintype" id="4169034">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4169041">if</span>&nbsp;<span class="ident" id="4169044">l</span>&nbsp;<span class="op" id="4169046">:=</span>&nbsp;<span class="builtinfunc" id="4169049">len</span><span class="op" id="4169052">(</span><span class="ident" id="4169053">buf</span><span class="op" id="4169056">)</span><span class="op" id="4169057">;</span>&nbsp;<span class="ident" id="4169059">l</span>&nbsp;<span class="op" id="4169061">&gt;</span>&nbsp;<span class="num" id="4169063">0</span>&nbsp;<span class="op" id="4169065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169070">b</span>&nbsp;<span class="op" id="4169072">=</span>&nbsp;<span class="ident" id="4169074">buf</span><span class="op" id="4169077">[</span><span class="ident" id="4169078">l</span><span class="op" id="4169079">-</span><span class="num" id="4169080">1</span><span class="op" id="4169081">]</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4169086">//&nbsp;We&nbsp;don&#39;t&nbsp;remove&nbsp;the&nbsp;byte&nbsp;if&nbsp;we&#39;re&nbsp;about&nbsp;to&nbsp;return&nbsp;and&nbsp;we&#39;re&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4169156">//&nbsp;reading&nbsp;all&nbsp;of&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4169181">if</span>&nbsp;<span class="ident" id="4169184">i</span>&nbsp;<span class="op" id="4169186">!=</span>&nbsp;<span class="num" id="4169189">3</span>&nbsp;<span class="op" id="4169191">||</span>&nbsp;<span class="ident" id="4169194">shift</span>&nbsp;<span class="op" id="4169200">==</span>&nbsp;<span class="num" id="4169203">4</span>&nbsp;<span class="op" id="4169205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169211">buf</span>&nbsp;<span class="op" id="4169215">=</span>&nbsp;<span class="ident" id="4169217">buf</span><span class="op" id="4169220">[</span><span class="op" id="4169221">:</span><span class="ident" id="4169222">l</span><span class="op" id="4169223">-</span><span class="num" id="4169224">1</span><span class="op" id="4169225">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4169230">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4169234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169238">ret</span>&nbsp;<span class="op" id="4169242">|=</span>&nbsp;<span class="builtintype" id="4169245">uint32</span><span class="op" id="4169251">(</span><span class="ident" id="4169252">b</span><span class="op" id="4169253">)</span>&nbsp;<span class="op" id="4169255">&lt;&lt;</span>&nbsp;<span class="op" id="4169258">(</span><span class="num" id="4169259">8</span>&nbsp;<span class="op" id="4169261">*</span>&nbsp;<span class="ident" id="4169263">i</span><span class="op" id="4169264">)</span>&nbsp;<span class="op" id="4169266">&gt;&gt;</span>&nbsp;<span class="ident" id="4169269">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4169276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169279">ret</span>&nbsp;<span class="op" id="4169283">&amp;=</span>&nbsp;<span class="ident" id="4169286">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4169300">return</span>&nbsp;<span class="ident" id="4169307">ret</span><span class="op" id="4169310">,</span>&nbsp;<span class="ident" id="4169312">buf</span><br>
<span class="lineno">710</span><span class="op" id="4169316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4169319">//&nbsp;p224FromBig&nbsp;sets&nbsp;*out&nbsp;=&nbsp;*in.</span><br>
<span class="lineno"></span><span class="keyword" id="4169351">func</span>&nbsp;<span class="ident" id="4169356">p224FromBig</span><span class="op" id="4169367">(</span><span class="ident" id="4169368">out</span>&nbsp;<span class="op" id="4169372">*</span><span class="ident" id="4169373">p224FieldElement</span><span class="op" id="4169389">,</span>&nbsp;<span class="ident" id="4169391">in</span>&nbsp;<span class="op" id="4169394">*</span><span class="ident" id="4169395">big</span><span class="op" id="4169398">.</span><span class="ident" id="4169399">Int</span><span class="op" id="4169402">)</span>&nbsp;<span class="op" id="4169404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169407">bytes</span>&nbsp;<span class="op" id="4169413">:=</span>&nbsp;<span class="ident" id="4169416">in</span><span class="op" id="4169418">.</span><span class="ident" id="4169419">Bytes</span><span class="op" id="4169424">(</span><span class="op" id="4169425">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169428">out</span><span class="op" id="4169431">[</span><span class="num" id="4169432">0</span><span class="op" id="4169433">]</span><span class="op" id="4169434">,</span>&nbsp;<span class="ident" id="4169436">bytes</span>&nbsp;<span class="op" id="4169442">=</span>&nbsp;<span class="ident" id="4169444">get28BitsFromEnd</span><span class="op" id="4169460">(</span><span class="ident" id="4169461">bytes</span><span class="op" id="4169466">,</span>&nbsp;<span class="num" id="4169468">0</span><span class="op" id="4169469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169472">out</span><span class="op" id="4169475">[</span><span class="num" id="4169476">1</span><span class="op" id="4169477">]</span><span class="op" id="4169478">,</span>&nbsp;<span class="ident" id="4169480">bytes</span>&nbsp;<span class="op" id="4169486">=</span>&nbsp;<span class="ident" id="4169488">get28BitsFromEnd</span><span class="op" id="4169504">(</span><span class="ident" id="4169505">bytes</span><span class="op" id="4169510">,</span>&nbsp;<span class="num" id="4169512">4</span><span class="op" id="4169513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169516">out</span><span class="op" id="4169519">[</span><span class="num" id="4169520">2</span><span class="op" id="4169521">]</span><span class="op" id="4169522">,</span>&nbsp;<span class="ident" id="4169524">bytes</span>&nbsp;<span class="op" id="4169530">=</span>&nbsp;<span class="ident" id="4169532">get28BitsFromEnd</span><span class="op" id="4169548">(</span><span class="ident" id="4169549">bytes</span><span class="op" id="4169554">,</span>&nbsp;<span class="num" id="4169556">0</span><span class="op" id="4169557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169560">out</span><span class="op" id="4169563">[</span><span class="num" id="4169564">3</span><span class="op" id="4169565">]</span><span class="op" id="4169566">,</span>&nbsp;<span class="ident" id="4169568">bytes</span>&nbsp;<span class="op" id="4169574">=</span>&nbsp;<span class="ident" id="4169576">get28BitsFromEnd</span><span class="op" id="4169592">(</span><span class="ident" id="4169593">bytes</span><span class="op" id="4169598">,</span>&nbsp;<span class="num" id="4169600">4</span><span class="op" id="4169601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169604">out</span><span class="op" id="4169607">[</span><span class="num" id="4169608">4</span><span class="op" id="4169609">]</span><span class="op" id="4169610">,</span>&nbsp;<span class="ident" id="4169612">bytes</span>&nbsp;<span class="op" id="4169618">=</span>&nbsp;<span class="ident" id="4169620">get28BitsFromEnd</span><span class="op" id="4169636">(</span><span class="ident" id="4169637">bytes</span><span class="op" id="4169642">,</span>&nbsp;<span class="num" id="4169644">0</span><span class="op" id="4169645">)</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169648">out</span><span class="op" id="4169651">[</span><span class="num" id="4169652">5</span><span class="op" id="4169653">]</span><span class="op" id="4169654">,</span>&nbsp;<span class="ident" id="4169656">bytes</span>&nbsp;<span class="op" id="4169662">=</span>&nbsp;<span class="ident" id="4169664">get28BitsFromEnd</span><span class="op" id="4169680">(</span><span class="ident" id="4169681">bytes</span><span class="op" id="4169686">,</span>&nbsp;<span class="num" id="4169688">4</span><span class="op" id="4169689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169692">out</span><span class="op" id="4169695">[</span><span class="num" id="4169696">6</span><span class="op" id="4169697">]</span><span class="op" id="4169698">,</span>&nbsp;<span class="ident" id="4169700">bytes</span>&nbsp;<span class="op" id="4169706">=</span>&nbsp;<span class="ident" id="4169708">get28BitsFromEnd</span><span class="op" id="4169724">(</span><span class="ident" id="4169725">bytes</span><span class="op" id="4169730">,</span>&nbsp;<span class="num" id="4169732">0</span><span class="op" id="4169733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169736">out</span><span class="op" id="4169739">[</span><span class="num" id="4169740">7</span><span class="op" id="4169741">]</span><span class="op" id="4169742">,</span>&nbsp;<span class="ident" id="4169744">bytes</span>&nbsp;<span class="op" id="4169750">=</span>&nbsp;<span class="ident" id="4169752">get28BitsFromEnd</span><span class="op" id="4169768">(</span><span class="ident" id="4169769">bytes</span><span class="op" id="4169774">,</span>&nbsp;<span class="num" id="4169776">4</span><span class="op" id="4169777">)</span><br>
<span class="lineno"></span><span class="op" id="4169779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span><span class="comment" id="4169782">//&nbsp;p224ToBig&nbsp;returns&nbsp;in&nbsp;as&nbsp;a&nbsp;big.Int.</span><br>
<span class="lineno"></span><span class="keyword" id="4169820">func</span>&nbsp;<span class="ident" id="4169825">p224ToBig</span><span class="op" id="4169834">(</span><span class="ident" id="4169835">in</span>&nbsp;<span class="op" id="4169838">*</span><span class="ident" id="4169839">p224FieldElement</span><span class="op" id="4169855">)</span>&nbsp;<span class="op" id="4169857">*</span><span class="ident" id="4169858">big</span><span class="op" id="4169861">.</span><span class="ident" id="4169862">Int</span>&nbsp;<span class="op" id="4169866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4169869">var</span>&nbsp;<span class="ident" id="4169873">buf</span>&nbsp;<span class="op" id="4169877">[</span><span class="num" id="4169878">28</span><span class="op" id="4169880">]</span><span class="builtintype" id="4169881">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169887">buf</span><span class="op" id="4169890">[</span><span class="num" id="4169891">27</span><span class="op" id="4169893">]</span>&nbsp;<span class="op" id="4169895">=</span>&nbsp;<span class="builtintype" id="4169897">byte</span><span class="op" id="4169901">(</span><span class="ident" id="4169902">in</span><span class="op" id="4169904">[</span><span class="num" id="4169905">0</span><span class="op" id="4169906">]</span><span class="op" id="4169907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169910">buf</span><span class="op" id="4169913">[</span><span class="num" id="4169914">26</span><span class="op" id="4169916">]</span>&nbsp;<span class="op" id="4169918">=</span>&nbsp;<span class="builtintype" id="4169920">byte</span><span class="op" id="4169924">(</span><span class="ident" id="4169925">in</span><span class="op" id="4169927">[</span><span class="num" id="4169928">0</span><span class="op" id="4169929">]</span>&nbsp;<span class="op" id="4169931">&gt;&gt;</span>&nbsp;<span class="num" id="4169934">8</span><span class="op" id="4169935">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169938">buf</span><span class="op" id="4169941">[</span><span class="num" id="4169942">25</span><span class="op" id="4169944">]</span>&nbsp;<span class="op" id="4169946">=</span>&nbsp;<span class="builtintype" id="4169948">byte</span><span class="op" id="4169952">(</span><span class="ident" id="4169953">in</span><span class="op" id="4169955">[</span><span class="num" id="4169956">0</span><span class="op" id="4169957">]</span>&nbsp;<span class="op" id="4169959">&gt;&gt;</span>&nbsp;<span class="num" id="4169962">16</span><span class="op" id="4169964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169967">buf</span><span class="op" id="4169970">[</span><span class="num" id="4169971">24</span><span class="op" id="4169973">]</span>&nbsp;<span class="op" id="4169975">=</span>&nbsp;<span class="builtintype" id="4169977">byte</span><span class="op" id="4169981">(</span><span class="op" id="4169982">(</span><span class="op" id="4169983">(</span><span class="ident" id="4169984">in</span><span class="op" id="4169986">[</span><span class="num" id="4169987">0</span><span class="op" id="4169988">]</span>&nbsp;<span class="op" id="4169990">&gt;&gt;</span>&nbsp;<span class="num" id="4169993">24</span><span class="op" id="4169995">)</span>&nbsp;<span class="op" id="4169997">&amp;</span>&nbsp;<span class="num" id="4169999">0x0f</span><span class="op" id="4170003">)</span>&nbsp;<span class="op" id="4170005">|</span>&nbsp;<span class="op" id="4170007">(</span><span class="ident" id="4170008">in</span><span class="op" id="4170010">[</span><span class="num" id="4170011">1</span><span class="op" id="4170012">]</span><span class="op" id="4170013">&lt;&lt;</span><span class="num" id="4170015">4</span><span class="op" id="4170016">)</span><span class="op" id="4170017">&amp;</span><span class="num" id="4170018">0xf0</span><span class="op" id="4170022">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170026">buf</span><span class="op" id="4170029">[</span><span class="num" id="4170030">23</span><span class="op" id="4170032">]</span>&nbsp;<span class="op" id="4170034">=</span>&nbsp;<span class="builtintype" id="4170036">byte</span><span class="op" id="4170040">(</span><span class="ident" id="4170041">in</span><span class="op" id="4170043">[</span><span class="num" id="4170044">1</span><span class="op" id="4170045">]</span>&nbsp;<span class="op" id="4170047">&gt;&gt;</span>&nbsp;<span class="num" id="4170050">4</span><span class="op" id="4170051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170054">buf</span><span class="op" id="4170057">[</span><span class="num" id="4170058">22</span><span class="op" id="4170060">]</span>&nbsp;<span class="op" id="4170062">=</span>&nbsp;<span class="builtintype" id="4170064">byte</span><span class="op" id="4170068">(</span><span class="ident" id="4170069">in</span><span class="op" id="4170071">[</span><span class="num" id="4170072">1</span><span class="op" id="4170073">]</span>&nbsp;<span class="op" id="4170075">&gt;&gt;</span>&nbsp;<span class="num" id="4170078">12</span><span class="op" id="4170080">)</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170083">buf</span><span class="op" id="4170086">[</span><span class="num" id="4170087">21</span><span class="op" id="4170089">]</span>&nbsp;<span class="op" id="4170091">=</span>&nbsp;<span class="builtintype" id="4170093">byte</span><span class="op" id="4170097">(</span><span class="ident" id="4170098">in</span><span class="op" id="4170100">[</span><span class="num" id="4170101">1</span><span class="op" id="4170102">]</span>&nbsp;<span class="op" id="4170104">&gt;&gt;</span>&nbsp;<span class="num" id="4170107">20</span><span class="op" id="4170109">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170113">buf</span><span class="op" id="4170116">[</span><span class="num" id="4170117">20</span><span class="op" id="4170119">]</span>&nbsp;<span class="op" id="4170121">=</span>&nbsp;<span class="builtintype" id="4170123">byte</span><span class="op" id="4170127">(</span><span class="ident" id="4170128">in</span><span class="op" id="4170130">[</span><span class="num" id="4170131">2</span><span class="op" id="4170132">]</span><span class="op" id="4170133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170136">buf</span><span class="op" id="4170139">[</span><span class="num" id="4170140">19</span><span class="op" id="4170142">]</span>&nbsp;<span class="op" id="4170144">=</span>&nbsp;<span class="builtintype" id="4170146">byte</span><span class="op" id="4170150">(</span><span class="ident" id="4170151">in</span><span class="op" id="4170153">[</span><span class="num" id="4170154">2</span><span class="op" id="4170155">]</span>&nbsp;<span class="op" id="4170157">&gt;&gt;</span>&nbsp;<span class="num" id="4170160">8</span><span class="op" id="4170161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170164">buf</span><span class="op" id="4170167">[</span><span class="num" id="4170168">18</span><span class="op" id="4170170">]</span>&nbsp;<span class="op" id="4170172">=</span>&nbsp;<span class="builtintype" id="4170174">byte</span><span class="op" id="4170178">(</span><span class="ident" id="4170179">in</span><span class="op" id="4170181">[</span><span class="num" id="4170182">2</span><span class="op" id="4170183">]</span>&nbsp;<span class="op" id="4170185">&gt;&gt;</span>&nbsp;<span class="num" id="4170188">16</span><span class="op" id="4170190">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170193">buf</span><span class="op" id="4170196">[</span><span class="num" id="4170197">17</span><span class="op" id="4170199">]</span>&nbsp;<span class="op" id="4170201">=</span>&nbsp;<span class="builtintype" id="4170203">byte</span><span class="op" id="4170207">(</span><span class="op" id="4170208">(</span><span class="op" id="4170209">(</span><span class="ident" id="4170210">in</span><span class="op" id="4170212">[</span><span class="num" id="4170213">2</span><span class="op" id="4170214">]</span>&nbsp;<span class="op" id="4170216">&gt;&gt;</span>&nbsp;<span class="num" id="4170219">24</span><span class="op" id="4170221">)</span>&nbsp;<span class="op" id="4170223">&amp;</span>&nbsp;<span class="num" id="4170225">0x0f</span><span class="op" id="4170229">)</span>&nbsp;<span class="op" id="4170231">|</span>&nbsp;<span class="op" id="4170233">(</span><span class="ident" id="4170234">in</span><span class="op" id="4170236">[</span><span class="num" id="4170237">3</span><span class="op" id="4170238">]</span><span class="op" id="4170239">&lt;&lt;</span><span class="num" id="4170241">4</span><span class="op" id="4170242">)</span><span class="op" id="4170243">&amp;</span><span class="num" id="4170244">0xf0</span><span class="op" id="4170248">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170252">buf</span><span class="op" id="4170255">[</span><span class="num" id="4170256">16</span><span class="op" id="4170258">]</span>&nbsp;<span class="op" id="4170260">=</span>&nbsp;<span class="builtintype" id="4170262">byte</span><span class="op" id="4170266">(</span><span class="ident" id="4170267">in</span><span class="op" id="4170269">[</span><span class="num" id="4170270">3</span><span class="op" id="4170271">]</span>&nbsp;<span class="op" id="4170273">&gt;&gt;</span>&nbsp;<span class="num" id="4170276">4</span><span class="op" id="4170277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170280">buf</span><span class="op" id="4170283">[</span><span class="num" id="4170284">15</span><span class="op" id="4170286">]</span>&nbsp;<span class="op" id="4170288">=</span>&nbsp;<span class="builtintype" id="4170290">byte</span><span class="op" id="4170294">(</span><span class="ident" id="4170295">in</span><span class="op" id="4170297">[</span><span class="num" id="4170298">3</span><span class="op" id="4170299">]</span>&nbsp;<span class="op" id="4170301">&gt;&gt;</span>&nbsp;<span class="num" id="4170304">12</span><span class="op" id="4170306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170309">buf</span><span class="op" id="4170312">[</span><span class="num" id="4170313">14</span><span class="op" id="4170315">]</span>&nbsp;<span class="op" id="4170317">=</span>&nbsp;<span class="builtintype" id="4170319">byte</span><span class="op" id="4170323">(</span><span class="ident" id="4170324">in</span><span class="op" id="4170326">[</span><span class="num" id="4170327">3</span><span class="op" id="4170328">]</span>&nbsp;<span class="op" id="4170330">&gt;&gt;</span>&nbsp;<span class="num" id="4170333">20</span><span class="op" id="4170335">)</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170339">buf</span><span class="op" id="4170342">[</span><span class="num" id="4170343">13</span><span class="op" id="4170345">]</span>&nbsp;<span class="op" id="4170347">=</span>&nbsp;<span class="builtintype" id="4170349">byte</span><span class="op" id="4170353">(</span><span class="ident" id="4170354">in</span><span class="op" id="4170356">[</span><span class="num" id="4170357">4</span><span class="op" id="4170358">]</span><span class="op" id="4170359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170362">buf</span><span class="op" id="4170365">[</span><span class="num" id="4170366">12</span><span class="op" id="4170368">]</span>&nbsp;<span class="op" id="4170370">=</span>&nbsp;<span class="builtintype" id="4170372">byte</span><span class="op" id="4170376">(</span><span class="ident" id="4170377">in</span><span class="op" id="4170379">[</span><span class="num" id="4170380">4</span><span class="op" id="4170381">]</span>&nbsp;<span class="op" id="4170383">&gt;&gt;</span>&nbsp;<span class="num" id="4170386">8</span><span class="op" id="4170387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170390">buf</span><span class="op" id="4170393">[</span><span class="num" id="4170394">11</span><span class="op" id="4170396">]</span>&nbsp;<span class="op" id="4170398">=</span>&nbsp;<span class="builtintype" id="4170400">byte</span><span class="op" id="4170404">(</span><span class="ident" id="4170405">in</span><span class="op" id="4170407">[</span><span class="num" id="4170408">4</span><span class="op" id="4170409">]</span>&nbsp;<span class="op" id="4170411">&gt;&gt;</span>&nbsp;<span class="num" id="4170414">16</span><span class="op" id="4170416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170419">buf</span><span class="op" id="4170422">[</span><span class="num" id="4170423">10</span><span class="op" id="4170425">]</span>&nbsp;<span class="op" id="4170427">=</span>&nbsp;<span class="builtintype" id="4170429">byte</span><span class="op" id="4170433">(</span><span class="op" id="4170434">(</span><span class="op" id="4170435">(</span><span class="ident" id="4170436">in</span><span class="op" id="4170438">[</span><span class="num" id="4170439">4</span><span class="op" id="4170440">]</span>&nbsp;<span class="op" id="4170442">&gt;&gt;</span>&nbsp;<span class="num" id="4170445">24</span><span class="op" id="4170447">)</span>&nbsp;<span class="op" id="4170449">&amp;</span>&nbsp;<span class="num" id="4170451">0x0f</span><span class="op" id="4170455">)</span>&nbsp;<span class="op" id="4170457">|</span>&nbsp;<span class="op" id="4170459">(</span><span class="ident" id="4170460">in</span><span class="op" id="4170462">[</span><span class="num" id="4170463">5</span><span class="op" id="4170464">]</span><span class="op" id="4170465">&lt;&lt;</span><span class="num" id="4170467">4</span><span class="op" id="4170468">)</span><span class="op" id="4170469">&amp;</span><span class="num" id="4170470">0xf0</span><span class="op" id="4170474">)</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170478">buf</span><span class="op" id="4170481">[</span><span class="num" id="4170482">9</span><span class="op" id="4170483">]</span>&nbsp;<span class="op" id="4170485">=</span>&nbsp;<span class="builtintype" id="4170487">byte</span><span class="op" id="4170491">(</span><span class="ident" id="4170492">in</span><span class="op" id="4170494">[</span><span class="num" id="4170495">5</span><span class="op" id="4170496">]</span>&nbsp;<span class="op" id="4170498">&gt;&gt;</span>&nbsp;<span class="num" id="4170501">4</span><span class="op" id="4170502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170505">buf</span><span class="op" id="4170508">[</span><span class="num" id="4170509">8</span><span class="op" id="4170510">]</span>&nbsp;<span class="op" id="4170512">=</span>&nbsp;<span class="builtintype" id="4170514">byte</span><span class="op" id="4170518">(</span><span class="ident" id="4170519">in</span><span class="op" id="4170521">[</span><span class="num" id="4170522">5</span><span class="op" id="4170523">]</span>&nbsp;<span class="op" id="4170525">&gt;&gt;</span>&nbsp;<span class="num" id="4170528">12</span><span class="op" id="4170530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170533">buf</span><span class="op" id="4170536">[</span><span class="num" id="4170537">7</span><span class="op" id="4170538">]</span>&nbsp;<span class="op" id="4170540">=</span>&nbsp;<span class="builtintype" id="4170542">byte</span><span class="op" id="4170546">(</span><span class="ident" id="4170547">in</span><span class="op" id="4170549">[</span><span class="num" id="4170550">5</span><span class="op" id="4170551">]</span>&nbsp;<span class="op" id="4170553">&gt;&gt;</span>&nbsp;<span class="num" id="4170556">20</span><span class="op" id="4170558">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170562">buf</span><span class="op" id="4170565">[</span><span class="num" id="4170566">6</span><span class="op" id="4170567">]</span>&nbsp;<span class="op" id="4170569">=</span>&nbsp;<span class="builtintype" id="4170571">byte</span><span class="op" id="4170575">(</span><span class="ident" id="4170576">in</span><span class="op" id="4170578">[</span><span class="num" id="4170579">6</span><span class="op" id="4170580">]</span><span class="op" id="4170581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170584">buf</span><span class="op" id="4170587">[</span><span class="num" id="4170588">5</span><span class="op" id="4170589">]</span>&nbsp;<span class="op" id="4170591">=</span>&nbsp;<span class="builtintype" id="4170593">byte</span><span class="op" id="4170597">(</span><span class="ident" id="4170598">in</span><span class="op" id="4170600">[</span><span class="num" id="4170601">6</span><span class="op" id="4170602">]</span>&nbsp;<span class="op" id="4170604">&gt;&gt;</span>&nbsp;<span class="num" id="4170607">8</span><span class="op" id="4170608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170611">buf</span><span class="op" id="4170614">[</span><span class="num" id="4170615">4</span><span class="op" id="4170616">]</span>&nbsp;<span class="op" id="4170618">=</span>&nbsp;<span class="builtintype" id="4170620">byte</span><span class="op" id="4170624">(</span><span class="ident" id="4170625">in</span><span class="op" id="4170627">[</span><span class="num" id="4170628">6</span><span class="op" id="4170629">]</span>&nbsp;<span class="op" id="4170631">&gt;&gt;</span>&nbsp;<span class="num" id="4170634">16</span><span class="op" id="4170636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170639">buf</span><span class="op" id="4170642">[</span><span class="num" id="4170643">3</span><span class="op" id="4170644">]</span>&nbsp;<span class="op" id="4170646">=</span>&nbsp;<span class="builtintype" id="4170648">byte</span><span class="op" id="4170652">(</span><span class="op" id="4170653">(</span><span class="op" id="4170654">(</span><span class="ident" id="4170655">in</span><span class="op" id="4170657">[</span><span class="num" id="4170658">6</span><span class="op" id="4170659">]</span>&nbsp;<span class="op" id="4170661">&gt;&gt;</span>&nbsp;<span class="num" id="4170664">24</span><span class="op" id="4170666">)</span>&nbsp;<span class="op" id="4170668">&amp;</span>&nbsp;<span class="num" id="4170670">0x0f</span><span class="op" id="4170674">)</span>&nbsp;<span class="op" id="4170676">|</span>&nbsp;<span class="op" id="4170678">(</span><span class="ident" id="4170679">in</span><span class="op" id="4170681">[</span><span class="num" id="4170682">7</span><span class="op" id="4170683">]</span><span class="op" id="4170684">&lt;&lt;</span><span class="num" id="4170686">4</span><span class="op" id="4170687">)</span><span class="op" id="4170688">&amp;</span><span class="num" id="4170689">0xf0</span><span class="op" id="4170693">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170697">buf</span><span class="op" id="4170700">[</span><span class="num" id="4170701">2</span><span class="op" id="4170702">]</span>&nbsp;<span class="op" id="4170704">=</span>&nbsp;<span class="builtintype" id="4170706">byte</span><span class="op" id="4170710">(</span><span class="ident" id="4170711">in</span><span class="op" id="4170713">[</span><span class="num" id="4170714">7</span><span class="op" id="4170715">]</span>&nbsp;<span class="op" id="4170717">&gt;&gt;</span>&nbsp;<span class="num" id="4170720">4</span><span class="op" id="4170721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170724">buf</span><span class="op" id="4170727">[</span><span class="num" id="4170728">1</span><span class="op" id="4170729">]</span>&nbsp;<span class="op" id="4170731">=</span>&nbsp;<span class="builtintype" id="4170733">byte</span><span class="op" id="4170737">(</span><span class="ident" id="4170738">in</span><span class="op" id="4170740">[</span><span class="num" id="4170741">7</span><span class="op" id="4170742">]</span>&nbsp;<span class="op" id="4170744">&gt;&gt;</span>&nbsp;<span class="num" id="4170747">12</span><span class="op" id="4170749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170752">buf</span><span class="op" id="4170755">[</span><span class="num" id="4170756">0</span><span class="op" id="4170757">]</span>&nbsp;<span class="op" id="4170759">=</span>&nbsp;<span class="builtintype" id="4170761">byte</span><span class="op" id="4170765">(</span><span class="ident" id="4170766">in</span><span class="op" id="4170768">[</span><span class="num" id="4170769">7</span><span class="op" id="4170770">]</span>&nbsp;<span class="op" id="4170772">&gt;&gt;</span>&nbsp;<span class="num" id="4170775">20</span><span class="op" id="4170777">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4170781">return</span>&nbsp;<span class="builtinfunc" id="4170788">new</span><span class="op" id="4170791">(</span><span class="ident" id="4170792">big</span><span class="op" id="4170795">.</span><span class="ident" id="4170796">Int</span><span class="op" id="4170799">)</span><span class="op" id="4170800">.</span><span class="ident" id="4170801">SetBytes</span><span class="op" id="4170809">(</span><span class="ident" id="4170810">buf</span><span class="op" id="4170813">[</span><span class="op" id="4170814">:</span><span class="op" id="4170815">]</span><span class="op" id="4170816">)</span><br>
<span class="lineno">765</span><span class="op" id="4170818">}</span>
</div>
</body>
</html>
