<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/json</h2>
<ul>
<li><a href="/gostd/encoding/json/bench_test.go.html">bench_test.go</a></li>
<li><a href="/gostd/encoding/json/decode.go.html">decode.go</a></li>
<li><a href="/gostd/encoding/json/decode_test.go.html">decode_test.go</a></li>
<li><a href="/gostd/encoding/json/encode.go.html">encode.go</a></li>
<li><a href="/gostd/encoding/json/encode_test.go.html">encode_test.go</a></li>
<li><a href="/gostd/encoding/json/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/json/fold.go.html">fold.go</a></li>
<li><a href="/gostd/encoding/json/fold_test.go.html">fold_test.go</a></li>
<li><a href="/gostd/encoding/json/indent.go.html">indent.go</a></li>
<li><a href="/gostd/encoding/json/scanner.go.html" class="current">scanner.go</a></li>
<li><a href="/gostd/encoding/json/scanner_test.go.html">scanner_test.go</a></li>
<li><a href="/gostd/encoding/json/stream.go.html">stream.go</a></li>
<li><a href="/gostd/encoding/json/stream_test.go.html">stream_test.go</a></li>
<li><a href="/gostd/encoding/json/tagkey_test.go.html">tagkey_test.go</a></li>
<li><a href="/gostd/encoding/json/tags.go.html">tags.go</a></li>
<li><a href="/gostd/encoding/json/tags_test.go.html">tags_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2030160">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2030216">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2030270">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2030321">package</span>&nbsp;<span class="ident" id="2030329">json</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2030335">//&nbsp;JSON&nbsp;value&nbsp;parser&nbsp;state&nbsp;machine.</span><br>
<span class="lineno"></span><span class="comment" id="2030371">//&nbsp;Just&nbsp;about&nbsp;at&nbsp;the&nbsp;limit&nbsp;of&nbsp;what&nbsp;is&nbsp;reasonable&nbsp;to&nbsp;write&nbsp;by&nbsp;hand.</span><br>
<span class="lineno"></span><span class="comment" id="2030438">//&nbsp;Some&nbsp;parts&nbsp;are&nbsp;a&nbsp;bit&nbsp;tedious,&nbsp;but&nbsp;overall&nbsp;it&nbsp;nicely&nbsp;factors&nbsp;out&nbsp;the</span><br>
<span class="lineno">10</span><span class="comment" id="2030509">//&nbsp;otherwise&nbsp;common&nbsp;code&nbsp;from&nbsp;the&nbsp;multiple&nbsp;scanning&nbsp;functions</span><br>
<span class="lineno"></span><span class="comment" id="2030571">//&nbsp;in&nbsp;this&nbsp;package&nbsp;(Compact,&nbsp;Indent,&nbsp;checkValid,&nbsp;nextValue,&nbsp;etc).</span><br>
<span class="lineno"></span><span class="comment" id="2030637">//</span><br>
<span class="lineno"></span><span class="comment" id="2030640">//&nbsp;This&nbsp;file&nbsp;starts&nbsp;with&nbsp;two&nbsp;simple&nbsp;examples&nbsp;using&nbsp;the&nbsp;scanner</span><br>
<span class="lineno"></span><span class="comment" id="2030703">//&nbsp;before&nbsp;diving&nbsp;into&nbsp;the&nbsp;scanner&nbsp;itself.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="2030746">import</span>&nbsp;<span class="string" id="2030753">&#34;strconv&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2030764">//&nbsp;checkValid&nbsp;verifies&nbsp;that&nbsp;data&nbsp;is&nbsp;valid&nbsp;JSON-encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="2030825">//&nbsp;scan&nbsp;is&nbsp;passed&nbsp;in&nbsp;for&nbsp;use&nbsp;by&nbsp;checkValid&nbsp;to&nbsp;avoid&nbsp;an&nbsp;allocation.</span><br>
<span class="lineno">20</span><span class="keyword" id="2030892">func</span>&nbsp;<span class="ident" id="2030897">checkValid</span><span class="op" id="2030907">(</span><span class="ident" id="2030908">data</span>&nbsp;<span class="op" id="2030913">[</span><span class="op" id="2030914">]</span><span class="builtintype" id="2030915">byte</span><span class="op" id="2030919">,</span>&nbsp;<span class="ident" id="2030921">scan</span>&nbsp;<span class="op" id="2030926">*</span><span class="ident" id="2030927">scanner</span><span class="op" id="2030934">)</span>&nbsp;<span class="builtintype" id="2030936">error</span>&nbsp;<span class="op" id="2030942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2030945">scan</span><span class="op" id="2030949">.</span><span class="ident" id="2030950">reset</span><span class="op" id="2030955">(</span><span class="op" id="2030956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2030959">for</span>&nbsp;<span class="ident" id="2030963">_</span><span class="op" id="2030964">,</span>&nbsp;<span class="ident" id="2030966">c</span>&nbsp;<span class="op" id="2030968">:=</span>&nbsp;<span class="keyword" id="2030971">range</span>&nbsp;<span class="ident" id="2030977">data</span>&nbsp;<span class="op" id="2030982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2030986">scan</span><span class="op" id="2030990">.</span><span class="ident" id="2030991">bytes</span><span class="op" id="2030996">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2031001">if</span>&nbsp;<span class="ident" id="2031004">scan</span><span class="op" id="2031008">.</span><span class="ident" id="2031009">step</span><span class="op" id="2031013">(</span><span class="ident" id="2031014">scan</span><span class="op" id="2031018">,</span>&nbsp;<span class="builtintype" id="2031020">int</span><span class="op" id="2031023">(</span><span class="ident" id="2031024">c</span><span class="op" id="2031025">)</span><span class="op" id="2031026">)</span>&nbsp;<span class="op" id="2031028">==</span>&nbsp;<span class="ident" id="2031031">scanError</span>&nbsp;<span class="op" id="2031041">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2031046">return</span>&nbsp;<span class="ident" id="2031053">scan</span><span class="op" id="2031057">.</span><span class="ident" id="2031058">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2031064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2031067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2031070">if</span>&nbsp;<span class="ident" id="2031073">scan</span><span class="op" id="2031077">.</span><span class="ident" id="2031078">eof</span><span class="op" id="2031081">(</span><span class="op" id="2031082">)</span>&nbsp;<span class="op" id="2031084">==</span>&nbsp;<span class="ident" id="2031087">scanError</span>&nbsp;<span class="op" id="2031097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2031101">return</span>&nbsp;<span class="ident" id="2031108">scan</span><span class="op" id="2031112">.</span><span class="ident" id="2031113">err</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2031118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2031121">return</span>&nbsp;<span class="builtintype" id="2031128">nil</span><br>
<span class="lineno"></span><span class="op" id="2031132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2031135">//&nbsp;nextValue&nbsp;splits&nbsp;data&nbsp;after&nbsp;the&nbsp;next&nbsp;whole&nbsp;JSON&nbsp;value,</span><br>
<span class="lineno">35</span><span class="comment" id="2031193">//&nbsp;returning&nbsp;that&nbsp;value&nbsp;and&nbsp;the&nbsp;bytes&nbsp;that&nbsp;follow&nbsp;it&nbsp;as&nbsp;separate&nbsp;slices.</span><br>
<span class="lineno"></span><span class="comment" id="2031266">//&nbsp;scan&nbsp;is&nbsp;passed&nbsp;in&nbsp;for&nbsp;use&nbsp;by&nbsp;nextValue&nbsp;to&nbsp;avoid&nbsp;an&nbsp;allocation.</span><br>
<span class="lineno"></span><span class="keyword" id="2031332">func</span>&nbsp;<span class="ident" id="2031337">nextValue</span><span class="op" id="2031346">(</span><span class="ident" id="2031347">data</span>&nbsp;<span class="op" id="2031352">[</span><span class="op" id="2031353">]</span><span class="builtintype" id="2031354">byte</span><span class="op" id="2031358">,</span>&nbsp;<span class="ident" id="2031360">scan</span>&nbsp;<span class="op" id="2031365">*</span><span class="ident" id="2031366">scanner</span><span class="op" id="2031373">)</span>&nbsp;<span class="op" id="2031375">(</span><span class="ident" id="2031376">value</span><span class="op" id="2031381">,</span>&nbsp;<span class="ident" id="2031383">rest</span>&nbsp;<span class="op" id="2031388">[</span><span class="op" id="2031389">]</span><span class="builtintype" id="2031390">byte</span><span class="op" id="2031394">,</span>&nbsp;<span class="ident" id="2031396">err</span>&nbsp;<span class="builtintype" id="2031400">error</span><span class="op" id="2031405">)</span>&nbsp;<span class="op" id="2031407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2031410">scan</span><span class="op" id="2031414">.</span><span class="ident" id="2031415">reset</span><span class="op" id="2031420">(</span><span class="op" id="2031421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2031424">for</span>&nbsp;<span class="ident" id="2031428">i</span><span class="op" id="2031429">,</span>&nbsp;<span class="ident" id="2031431">c</span>&nbsp;<span class="op" id="2031433">:=</span>&nbsp;<span class="keyword" id="2031436">range</span>&nbsp;<span class="ident" id="2031442">data</span>&nbsp;<span class="op" id="2031447">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2031451">v</span>&nbsp;<span class="op" id="2031453">:=</span>&nbsp;<span class="ident" id="2031456">scan</span><span class="op" id="2031460">.</span><span class="ident" id="2031461">step</span><span class="op" id="2031465">(</span><span class="ident" id="2031466">scan</span><span class="op" id="2031470">,</span>&nbsp;<span class="builtintype" id="2031472">int</span><span class="op" id="2031475">(</span><span class="ident" id="2031476">c</span><span class="op" id="2031477">)</span><span class="op" id="2031478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2031482">if</span>&nbsp;<span class="ident" id="2031485">v</span>&nbsp;<span class="op" id="2031487">&gt;=</span>&nbsp;<span class="ident" id="2031490">scanEnd</span>&nbsp;<span class="op" id="2031498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2031503">switch</span>&nbsp;<span class="ident" id="2031510">v</span>&nbsp;<span class="op" id="2031512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2031517">case</span>&nbsp;<span class="ident" id="2031522">scanError</span><span class="op" id="2031531">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2031537">return</span>&nbsp;<span class="builtintype" id="2031544">nil</span><span class="op" id="2031547">,</span>&nbsp;<span class="builtintype" id="2031549">nil</span><span class="op" id="2031552">,</span>&nbsp;<span class="ident" id="2031554">scan</span><span class="op" id="2031558">.</span><span class="ident" id="2031559">err</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2031566">case</span>&nbsp;<span class="ident" id="2031571">scanEnd</span><span class="op" id="2031578">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2031584">return</span>&nbsp;<span class="ident" id="2031591">data</span><span class="op" id="2031595">[</span><span class="num" id="2031596">0</span><span class="op" id="2031597">:</span><span class="ident" id="2031598">i</span><span class="op" id="2031599">]</span><span class="op" id="2031600">,</span>&nbsp;<span class="ident" id="2031602">data</span><span class="op" id="2031606">[</span><span class="ident" id="2031607">i</span><span class="op" id="2031608">:</span><span class="op" id="2031609">]</span><span class="op" id="2031610">,</span>&nbsp;<span class="builtintype" id="2031612">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2031619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2031623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2031626">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2031629">if</span>&nbsp;<span class="ident" id="2031632">scan</span><span class="op" id="2031636">.</span><span class="ident" id="2031637">eof</span><span class="op" id="2031640">(</span><span class="op" id="2031641">)</span>&nbsp;<span class="op" id="2031643">==</span>&nbsp;<span class="ident" id="2031646">scanError</span>&nbsp;<span class="op" id="2031656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2031660">return</span>&nbsp;<span class="builtintype" id="2031667">nil</span><span class="op" id="2031670">,</span>&nbsp;<span class="builtintype" id="2031672">nil</span><span class="op" id="2031675">,</span>&nbsp;<span class="ident" id="2031677">scan</span><span class="op" id="2031681">.</span><span class="ident" id="2031682">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2031687">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2031690">return</span>&nbsp;<span class="ident" id="2031697">data</span><span class="op" id="2031701">,</span>&nbsp;<span class="builtintype" id="2031703">nil</span><span class="op" id="2031706">,</span>&nbsp;<span class="builtintype" id="2031708">nil</span><br>
<span class="lineno"></span><span class="op" id="2031712">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="2031715">//&nbsp;A&nbsp;SyntaxError&nbsp;is&nbsp;a&nbsp;description&nbsp;of&nbsp;a&nbsp;JSON&nbsp;syntax&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="2031773">type</span>&nbsp;<span class="ident" id="2031778">SyntaxError</span>&nbsp;<span class="keyword" id="2031790">struct</span>&nbsp;<span class="op" id="2031797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2031800">msg</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2031807">string</span>&nbsp;<span class="comment" id="2031814">//&nbsp;description&nbsp;of&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2031839">Offset</span>&nbsp;<span class="ident" id="2031846">int64</span>&nbsp;&nbsp;<span class="comment" id="2031853">//&nbsp;error&nbsp;occurred&nbsp;after&nbsp;reading&nbsp;Offset&nbsp;bytes</span><br>
<span class="lineno">60</span><span class="op" id="2031898">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2031901">func</span>&nbsp;<span class="op" id="2031906">(</span><span class="ident" id="2031907">e</span>&nbsp;<span class="op" id="2031909">*</span><span class="ident" id="2031910">SyntaxError</span><span class="op" id="2031921">)</span>&nbsp;<span class="ident" id="2031923">Error</span><span class="op" id="2031928">(</span><span class="op" id="2031929">)</span>&nbsp;<span class="builtintype" id="2031931">string</span>&nbsp;<span class="op" id="2031938">{</span>&nbsp;<span class="keyword" id="2031940">return</span>&nbsp;<span class="ident" id="2031947">e</span><span class="op" id="2031948">.</span><span class="ident" id="2031949">msg</span>&nbsp;<span class="op" id="2031953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2031956">//&nbsp;A&nbsp;scanner&nbsp;is&nbsp;a&nbsp;JSON&nbsp;scanning&nbsp;state&nbsp;machine.</span><br>
<span class="lineno">65</span><span class="comment" id="2032003">//&nbsp;Callers&nbsp;call&nbsp;scan.reset()&nbsp;and&nbsp;then&nbsp;pass&nbsp;bytes&nbsp;in&nbsp;one&nbsp;at&nbsp;a&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2032069">//&nbsp;by&nbsp;calling&nbsp;scan.step(&amp;scan,&nbsp;c)&nbsp;for&nbsp;each&nbsp;byte.</span><br>
<span class="lineno"></span><span class="comment" id="2032118">//&nbsp;The&nbsp;return&nbsp;value,&nbsp;referred&nbsp;to&nbsp;as&nbsp;an&nbsp;opcode,&nbsp;tells&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2032175">//&nbsp;caller&nbsp;about&nbsp;significant&nbsp;parsing&nbsp;events&nbsp;like&nbsp;beginning</span><br>
<span class="lineno"></span><span class="comment" id="2032233">//&nbsp;and&nbsp;ending&nbsp;literals,&nbsp;objects,&nbsp;and&nbsp;arrays,&nbsp;so&nbsp;that&nbsp;the</span><br>
<span class="lineno">70</span><span class="comment" id="2032290">//&nbsp;caller&nbsp;can&nbsp;follow&nbsp;along&nbsp;if&nbsp;it&nbsp;wishes.</span><br>
<span class="lineno"></span><span class="comment" id="2032331">//&nbsp;The&nbsp;return&nbsp;value&nbsp;scanEnd&nbsp;indicates&nbsp;that&nbsp;a&nbsp;single&nbsp;top-level</span><br>
<span class="lineno"></span><span class="comment" id="2032393">//&nbsp;JSON&nbsp;value&nbsp;has&nbsp;been&nbsp;completed,&nbsp;*before*&nbsp;the&nbsp;byte&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2032450">//&nbsp;just&nbsp;got&nbsp;passed&nbsp;in.&nbsp;&nbsp;(The&nbsp;indication&nbsp;must&nbsp;be&nbsp;delayed&nbsp;in&nbsp;order</span><br>
<span class="lineno"></span><span class="comment" id="2032515">//&nbsp;to&nbsp;recognize&nbsp;the&nbsp;end&nbsp;of&nbsp;numbers:&nbsp;is&nbsp;123&nbsp;a&nbsp;whole&nbsp;value&nbsp;or</span><br>
<span class="lineno">75</span><span class="comment" id="2032575">//&nbsp;the&nbsp;beginning&nbsp;of&nbsp;12345e+6?).</span><br>
<span class="lineno"></span><span class="keyword" id="2032607">type</span>&nbsp;<span class="ident" id="2032612">scanner</span>&nbsp;<span class="keyword" id="2032620">struct</span>&nbsp;<span class="op" id="2032627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2032630">//&nbsp;The&nbsp;step&nbsp;is&nbsp;a&nbsp;func&nbsp;to&nbsp;be&nbsp;called&nbsp;to&nbsp;execute&nbsp;the&nbsp;next&nbsp;transition.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2032698">//&nbsp;Also&nbsp;tried&nbsp;using&nbsp;an&nbsp;integer&nbsp;constant&nbsp;and&nbsp;a&nbsp;single&nbsp;func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2032757">//&nbsp;with&nbsp;a&nbsp;switch,&nbsp;but&nbsp;using&nbsp;the&nbsp;func&nbsp;directly&nbsp;was&nbsp;10%&nbsp;faster</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2032819">//&nbsp;on&nbsp;a&nbsp;64-bit&nbsp;Mac&nbsp;Mini,&nbsp;and&nbsp;it&#39;s&nbsp;nicer&nbsp;to&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2032869">step</span>&nbsp;<span class="keyword" id="2032874">func</span><span class="op" id="2032878">(</span><span class="op" id="2032879">*</span><span class="ident" id="2032880">scanner</span><span class="op" id="2032887">,</span>&nbsp;<span class="builtintype" id="2032889">int</span><span class="op" id="2032892">)</span>&nbsp;<span class="builtintype" id="2032894">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2032900">//&nbsp;Reached&nbsp;end&nbsp;of&nbsp;top-level&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2032936">endTop</span>&nbsp;<span class="builtintype" id="2032943">bool</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2032950">//&nbsp;Stack&nbsp;of&nbsp;what&nbsp;we&#39;re&nbsp;in&nbsp;the&nbsp;middle&nbsp;of&nbsp;-&nbsp;array&nbsp;values,&nbsp;object&nbsp;keys,&nbsp;object&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2033035">parseState</span>&nbsp;<span class="op" id="2033046">[</span><span class="op" id="2033047">]</span><span class="builtintype" id="2033048">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2033054">//&nbsp;Error&nbsp;that&nbsp;happened,&nbsp;if&nbsp;any.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2033087">err</span>&nbsp;<span class="builtintype" id="2033091">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2033099">//&nbsp;1-byte&nbsp;redo&nbsp;(see&nbsp;undo&nbsp;method)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2033133">redo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2033143">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2033149">redoCode</span>&nbsp;&nbsp;<span class="builtintype" id="2033159">int</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2033164">redoState</span>&nbsp;<span class="keyword" id="2033174">func</span><span class="op" id="2033178">(</span><span class="op" id="2033179">*</span><span class="ident" id="2033180">scanner</span><span class="op" id="2033187">,</span>&nbsp;<span class="builtintype" id="2033189">int</span><span class="op" id="2033192">)</span>&nbsp;<span class="builtintype" id="2033194">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2033200">//&nbsp;total&nbsp;bytes&nbsp;consumed,&nbsp;updated&nbsp;by&nbsp;decoder.Decode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2033252">bytes</span>&nbsp;<span class="ident" id="2033258">int64</span><br>
<span class="lineno"></span><span class="op" id="2033264">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="2033267">//&nbsp;These&nbsp;values&nbsp;are&nbsp;returned&nbsp;by&nbsp;the&nbsp;state&nbsp;transition&nbsp;functions</span><br>
<span class="lineno"></span><span class="comment" id="2033330">//&nbsp;assigned&nbsp;to&nbsp;scanner.state&nbsp;and&nbsp;the&nbsp;method&nbsp;scanner.eof.</span><br>
<span class="lineno"></span><span class="comment" id="2033387">//&nbsp;They&nbsp;give&nbsp;details&nbsp;about&nbsp;the&nbsp;current&nbsp;state&nbsp;of&nbsp;the&nbsp;scan&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2033449">//&nbsp;callers&nbsp;might&nbsp;be&nbsp;interested&nbsp;to&nbsp;know&nbsp;about.</span><br>
<span class="lineno">105</span><span class="comment" id="2033495">//&nbsp;It&nbsp;is&nbsp;okay&nbsp;to&nbsp;ignore&nbsp;the&nbsp;return&nbsp;value&nbsp;of&nbsp;any&nbsp;particular</span><br>
<span class="lineno"></span><span class="comment" id="2033554">//&nbsp;call&nbsp;to&nbsp;scanner.state:&nbsp;if&nbsp;one&nbsp;call&nbsp;returns&nbsp;scanError,</span><br>
<span class="lineno"></span><span class="comment" id="2033611">//&nbsp;every&nbsp;subsequent&nbsp;call&nbsp;will&nbsp;return&nbsp;scanError&nbsp;too.</span><br>
<span class="lineno"></span><span class="keyword" id="2033663">const</span>&nbsp;<span class="op" id="2033669">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2033672">//&nbsp;Continue.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2033686">scanContinue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2033703">=</span>&nbsp;<span class="ident" id="2033705">iota</span>&nbsp;<span class="comment" id="2033710">//&nbsp;uninteresting&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2033733">scanBeginLiteral</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2033757">//&nbsp;end&nbsp;implied&nbsp;by&nbsp;next&nbsp;result&nbsp;!=&nbsp;scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2033804">scanBeginObject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2033828">//&nbsp;begin&nbsp;object</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2033845">scanObjectKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2033869">//&nbsp;just&nbsp;finished&nbsp;object&nbsp;key&nbsp;(string)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2033907">scanObjectValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2033931">//&nbsp;just&nbsp;finished&nbsp;non-last&nbsp;object&nbsp;value</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2033971">scanEndObject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2033995">//&nbsp;end&nbsp;object&nbsp;(implies&nbsp;scanObjectValue&nbsp;if&nbsp;possible)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2034048">scanBeginArray</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2034072">//&nbsp;begin&nbsp;array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2034088">scanArrayValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2034112">//&nbsp;just&nbsp;finished&nbsp;array&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2034142">scanEndArray</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2034166">//&nbsp;end&nbsp;array&nbsp;(implies&nbsp;scanArrayValue&nbsp;if&nbsp;possible)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2034217">scanSkipSpace</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2034241">//&nbsp;space&nbsp;byte;&nbsp;can&nbsp;skip;&nbsp;known&nbsp;to&nbsp;be&nbsp;last&nbsp;&#34;continue&#34;&nbsp;result</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2034303">//&nbsp;Stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2034313">scanEnd</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2034323">//&nbsp;top-level&nbsp;value&nbsp;ended&nbsp;*before*&nbsp;this&nbsp;byte;&nbsp;known&nbsp;to&nbsp;be&nbsp;first&nbsp;&#34;stop&#34;&nbsp;result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2034401">scanError</span>&nbsp;<span class="comment" id="2034411">//&nbsp;hit&nbsp;an&nbsp;error,&nbsp;scanner.err.</span><br>
<span class="lineno"></span><span class="op" id="2034441">)</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="2034444">//&nbsp;These&nbsp;values&nbsp;are&nbsp;stored&nbsp;in&nbsp;the&nbsp;parseState&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="2034496">//&nbsp;They&nbsp;give&nbsp;the&nbsp;current&nbsp;state&nbsp;of&nbsp;a&nbsp;composite&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2034548">//&nbsp;being&nbsp;scanned.&nbsp;&nbsp;If&nbsp;the&nbsp;parser&nbsp;is&nbsp;inside&nbsp;a&nbsp;nested&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2034606">//&nbsp;the&nbsp;parseState&nbsp;describes&nbsp;the&nbsp;nested&nbsp;state,&nbsp;outermost&nbsp;at&nbsp;entry&nbsp;0.</span><br>
<span class="lineno">130</span><span class="keyword" id="2034674">const</span>&nbsp;<span class="op" id="2034680">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2034683">parseObjectKey</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2034700">=</span>&nbsp;<span class="ident" id="2034702">iota</span>&nbsp;<span class="comment" id="2034707">//&nbsp;parsing&nbsp;object&nbsp;key&nbsp;(before&nbsp;colon)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2034745">parseObjectValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2034769">//&nbsp;parsing&nbsp;object&nbsp;value&nbsp;(after&nbsp;colon)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2034808">parseArrayValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2034832">//&nbsp;parsing&nbsp;array&nbsp;value</span><br>
<span class="lineno"></span><span class="op" id="2034855">)</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="comment" id="2034858">//&nbsp;reset&nbsp;prepares&nbsp;the&nbsp;scanner&nbsp;for&nbsp;use.</span><br>
<span class="lineno"></span><span class="comment" id="2034897">//&nbsp;It&nbsp;must&nbsp;be&nbsp;called&nbsp;before&nbsp;calling&nbsp;s.step.</span><br>
<span class="lineno"></span><span class="keyword" id="2034941">func</span>&nbsp;<span class="op" id="2034946">(</span><span class="ident" id="2034947">s</span>&nbsp;<span class="op" id="2034949">*</span><span class="ident" id="2034950">scanner</span><span class="op" id="2034957">)</span>&nbsp;<span class="ident" id="2034959">reset</span><span class="op" id="2034964">(</span><span class="op" id="2034965">)</span>&nbsp;<span class="op" id="2034967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2034970">s</span><span class="op" id="2034971">.</span><span class="ident" id="2034972">step</span>&nbsp;<span class="op" id="2034977">=</span>&nbsp;<span class="ident" id="2034979">stateBeginValue</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2034996">s</span><span class="op" id="2034997">.</span><span class="ident" id="2034998">parseState</span>&nbsp;<span class="op" id="2035009">=</span>&nbsp;<span class="ident" id="2035011">s</span><span class="op" id="2035012">.</span><span class="ident" id="2035013">parseState</span><span class="op" id="2035023">[</span><span class="num" id="2035024">0</span><span class="op" id="2035025">:</span><span class="num" id="2035026">0</span><span class="op" id="2035027">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2035030">s</span><span class="op" id="2035031">.</span><span class="ident" id="2035032">err</span>&nbsp;<span class="op" id="2035036">=</span>&nbsp;<span class="builtintype" id="2035038">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2035043">s</span><span class="op" id="2035044">.</span><span class="ident" id="2035045">redo</span>&nbsp;<span class="op" id="2035050">=</span>&nbsp;<span class="builtintype" id="2035052">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2035059">s</span><span class="op" id="2035060">.</span><span class="ident" id="2035061">endTop</span>&nbsp;<span class="op" id="2035068">=</span>&nbsp;<span class="builtintype" id="2035070">false</span><br>
<span class="lineno"></span><span class="op" id="2035076">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="2035079">//&nbsp;eof&nbsp;tells&nbsp;the&nbsp;scanner&nbsp;that&nbsp;the&nbsp;end&nbsp;of&nbsp;input&nbsp;has&nbsp;been&nbsp;reached.</span><br>
<span class="lineno"></span><span class="comment" id="2035144">//&nbsp;It&nbsp;returns&nbsp;a&nbsp;scan&nbsp;status&nbsp;just&nbsp;as&nbsp;s.step&nbsp;does.</span><br>
<span class="lineno"></span><span class="keyword" id="2035193">func</span>&nbsp;<span class="op" id="2035198">(</span><span class="ident" id="2035199">s</span>&nbsp;<span class="op" id="2035201">*</span><span class="ident" id="2035202">scanner</span><span class="op" id="2035209">)</span>&nbsp;<span class="ident" id="2035211">eof</span><span class="op" id="2035214">(</span><span class="op" id="2035215">)</span>&nbsp;<span class="builtintype" id="2035217">int</span>&nbsp;<span class="op" id="2035221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2035224">if</span>&nbsp;<span class="ident" id="2035227">s</span><span class="op" id="2035228">.</span><span class="ident" id="2035229">err</span>&nbsp;<span class="op" id="2035233">!=</span>&nbsp;<span class="builtintype" id="2035236">nil</span>&nbsp;<span class="op" id="2035240">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2035244">return</span>&nbsp;<span class="ident" id="2035251">scanError</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2035262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2035265">if</span>&nbsp;<span class="ident" id="2035268">s</span><span class="op" id="2035269">.</span><span class="ident" id="2035270">endTop</span>&nbsp;<span class="op" id="2035277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2035281">return</span>&nbsp;<span class="ident" id="2035288">scanEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2035297">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2035300">s</span><span class="op" id="2035301">.</span><span class="ident" id="2035302">step</span><span class="op" id="2035306">(</span><span class="ident" id="2035307">s</span><span class="op" id="2035308">,</span>&nbsp;<span class="string" id="2035310">&#39;&nbsp;&#39;</span><span class="op" id="2035313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2035316">if</span>&nbsp;<span class="ident" id="2035319">s</span><span class="op" id="2035320">.</span><span class="ident" id="2035321">endTop</span>&nbsp;<span class="op" id="2035328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2035332">return</span>&nbsp;<span class="ident" id="2035339">scanEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2035348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2035351">if</span>&nbsp;<span class="ident" id="2035354">s</span><span class="op" id="2035355">.</span><span class="ident" id="2035356">err</span>&nbsp;<span class="op" id="2035360">==</span>&nbsp;<span class="builtintype" id="2035363">nil</span>&nbsp;<span class="op" id="2035367">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2035371">s</span><span class="op" id="2035372">.</span><span class="ident" id="2035373">err</span>&nbsp;<span class="op" id="2035377">=</span>&nbsp;<span class="op" id="2035379">&amp;</span><span class="ident" id="2035380">SyntaxError</span><span class="op" id="2035391">{</span><span class="string" id="2035392">&#34;unexpected&nbsp;end&nbsp;of&nbsp;JSON&nbsp;input&#34;</span><span class="op" id="2035422">,</span>&nbsp;<span class="ident" id="2035424">s</span><span class="op" id="2035425">.</span><span class="ident" id="2035426">bytes</span><span class="op" id="2035431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2035434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2035437">return</span>&nbsp;<span class="ident" id="2035444">scanError</span><br>
<span class="lineno"></span><span class="op" id="2035454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="2035457">//&nbsp;pushParseState&nbsp;pushes&nbsp;a&nbsp;new&nbsp;parse&nbsp;state&nbsp;p&nbsp;onto&nbsp;the&nbsp;parse&nbsp;stack.</span><br>
<span class="lineno"></span><span class="keyword" id="2035524">func</span>&nbsp;<span class="op" id="2035529">(</span><span class="ident" id="2035530">s</span>&nbsp;<span class="op" id="2035532">*</span><span class="ident" id="2035533">scanner</span><span class="op" id="2035540">)</span>&nbsp;<span class="ident" id="2035542">pushParseState</span><span class="op" id="2035556">(</span><span class="ident" id="2035557">p</span>&nbsp;<span class="builtintype" id="2035559">int</span><span class="op" id="2035562">)</span>&nbsp;<span class="op" id="2035564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2035567">s</span><span class="op" id="2035568">.</span><span class="ident" id="2035569">parseState</span>&nbsp;<span class="op" id="2035580">=</span>&nbsp;<span class="builtinfunc" id="2035582">append</span><span class="op" id="2035588">(</span><span class="ident" id="2035589">s</span><span class="op" id="2035590">.</span><span class="ident" id="2035591">parseState</span><span class="op" id="2035601">,</span>&nbsp;<span class="ident" id="2035603">p</span><span class="op" id="2035604">)</span><br>
<span class="lineno"></span><span class="op" id="2035606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="comment" id="2035609">//&nbsp;popParseState&nbsp;pops&nbsp;a&nbsp;parse&nbsp;state&nbsp;(already&nbsp;obtained)&nbsp;off&nbsp;the&nbsp;stack</span><br>
<span class="lineno"></span><span class="comment" id="2035678">//&nbsp;and&nbsp;updates&nbsp;s.step&nbsp;accordingly.</span><br>
<span class="lineno"></span><span class="keyword" id="2035713">func</span>&nbsp;<span class="op" id="2035718">(</span><span class="ident" id="2035719">s</span>&nbsp;<span class="op" id="2035721">*</span><span class="ident" id="2035722">scanner</span><span class="op" id="2035729">)</span>&nbsp;<span class="ident" id="2035731">popParseState</span><span class="op" id="2035744">(</span><span class="op" id="2035745">)</span>&nbsp;<span class="op" id="2035747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2035750">n</span>&nbsp;<span class="op" id="2035752">:=</span>&nbsp;<span class="builtinfunc" id="2035755">len</span><span class="op" id="2035758">(</span><span class="ident" id="2035759">s</span><span class="op" id="2035760">.</span><span class="ident" id="2035761">parseState</span><span class="op" id="2035771">)</span>&nbsp;<span class="op" id="2035773">-</span>&nbsp;<span class="num" id="2035775">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2035778">s</span><span class="op" id="2035779">.</span><span class="ident" id="2035780">parseState</span>&nbsp;<span class="op" id="2035791">=</span>&nbsp;<span class="ident" id="2035793">s</span><span class="op" id="2035794">.</span><span class="ident" id="2035795">parseState</span><span class="op" id="2035805">[</span><span class="num" id="2035806">0</span><span class="op" id="2035807">:</span><span class="ident" id="2035808">n</span><span class="op" id="2035809">]</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2035812">s</span><span class="op" id="2035813">.</span><span class="ident" id="2035814">redo</span>&nbsp;<span class="op" id="2035819">=</span>&nbsp;<span class="builtintype" id="2035821">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2035828">if</span>&nbsp;<span class="ident" id="2035831">n</span>&nbsp;<span class="op" id="2035833">==</span>&nbsp;<span class="num" id="2035836">0</span>&nbsp;<span class="op" id="2035838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2035842">s</span><span class="op" id="2035843">.</span><span class="ident" id="2035844">step</span>&nbsp;<span class="op" id="2035849">=</span>&nbsp;<span class="ident" id="2035851">stateEndTop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2035865">s</span><span class="op" id="2035866">.</span><span class="ident" id="2035867">endTop</span>&nbsp;<span class="op" id="2035874">=</span>&nbsp;<span class="builtintype" id="2035876">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2035882">}</span>&nbsp;<span class="keyword" id="2035884">else</span>&nbsp;<span class="op" id="2035889">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2035893">s</span><span class="op" id="2035894">.</span><span class="ident" id="2035895">step</span>&nbsp;<span class="op" id="2035900">=</span>&nbsp;<span class="ident" id="2035902">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2035917">}</span><br>
<span class="lineno"></span><span class="op" id="2035919">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2035922">func</span>&nbsp;<span class="ident" id="2035927">isSpace</span><span class="op" id="2035934">(</span><span class="ident" id="2035935">c</span>&nbsp;<span class="builtintype" id="2035937">rune</span><span class="op" id="2035941">)</span>&nbsp;<span class="builtintype" id="2035943">bool</span>&nbsp;<span class="op" id="2035948">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2035951">return</span>&nbsp;<span class="ident" id="2035958">c</span>&nbsp;<span class="op" id="2035960">==</span>&nbsp;<span class="string" id="2035963">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2035967">||</span>&nbsp;<span class="ident" id="2035970">c</span>&nbsp;<span class="op" id="2035972">==</span>&nbsp;<span class="string" id="2035975">&#39;\t&#39;</span>&nbsp;<span class="op" id="2035980">||</span>&nbsp;<span class="ident" id="2035983">c</span>&nbsp;<span class="op" id="2035985">==</span>&nbsp;<span class="string" id="2035988">&#39;\r&#39;</span>&nbsp;<span class="op" id="2035993">||</span>&nbsp;<span class="ident" id="2035996">c</span>&nbsp;<span class="op" id="2035998">==</span>&nbsp;<span class="string" id="2036001">&#39;\n&#39;</span><br>
<span class="lineno"></span><span class="op" id="2036006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2036009">//&nbsp;stateBeginValueOrEmpty&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`[`.</span><br>
<span class="lineno"></span><span class="keyword" id="2036067">func</span>&nbsp;<span class="ident" id="2036072">stateBeginValueOrEmpty</span><span class="op" id="2036094">(</span><span class="ident" id="2036095">s</span>&nbsp;<span class="op" id="2036097">*</span><span class="ident" id="2036098">scanner</span><span class="op" id="2036105">,</span>&nbsp;<span class="ident" id="2036107">c</span>&nbsp;<span class="builtintype" id="2036109">int</span><span class="op" id="2036112">)</span>&nbsp;<span class="builtintype" id="2036114">int</span>&nbsp;<span class="op" id="2036118">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2036121">if</span>&nbsp;<span class="ident" id="2036124">c</span>&nbsp;<span class="op" id="2036126">&lt;=</span>&nbsp;<span class="string" id="2036129">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2036133">&amp;&amp;</span>&nbsp;<span class="ident" id="2036136">isSpace</span><span class="op" id="2036143">(</span><span class="builtintype" id="2036144">rune</span><span class="op" id="2036148">(</span><span class="ident" id="2036149">c</span><span class="op" id="2036150">)</span><span class="op" id="2036151">)</span>&nbsp;<span class="op" id="2036153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2036157">return</span>&nbsp;<span class="ident" id="2036164">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2036179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2036182">if</span>&nbsp;<span class="ident" id="2036185">c</span>&nbsp;<span class="op" id="2036187">==</span>&nbsp;<span class="string" id="2036190">&#39;]&#39;</span>&nbsp;<span class="op" id="2036194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2036198">return</span>&nbsp;<span class="ident" id="2036205">stateEndValue</span><span class="op" id="2036218">(</span><span class="ident" id="2036219">s</span><span class="op" id="2036220">,</span>&nbsp;<span class="ident" id="2036222">c</span><span class="op" id="2036223">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2036226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2036229">return</span>&nbsp;<span class="ident" id="2036236">stateBeginValue</span><span class="op" id="2036251">(</span><span class="ident" id="2036252">s</span><span class="op" id="2036253">,</span>&nbsp;<span class="ident" id="2036255">c</span><span class="op" id="2036256">)</span><br>
<span class="lineno"></span><span class="op" id="2036258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2036261">//&nbsp;stateBeginValue&nbsp;is&nbsp;the&nbsp;state&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;input.</span><br>
<span class="lineno">200</span><span class="keyword" id="2036324">func</span>&nbsp;<span class="ident" id="2036329">stateBeginValue</span><span class="op" id="2036344">(</span><span class="ident" id="2036345">s</span>&nbsp;<span class="op" id="2036347">*</span><span class="ident" id="2036348">scanner</span><span class="op" id="2036355">,</span>&nbsp;<span class="ident" id="2036357">c</span>&nbsp;<span class="builtintype" id="2036359">int</span><span class="op" id="2036362">)</span>&nbsp;<span class="builtintype" id="2036364">int</span>&nbsp;<span class="op" id="2036368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2036371">if</span>&nbsp;<span class="ident" id="2036374">c</span>&nbsp;<span class="op" id="2036376">&lt;=</span>&nbsp;<span class="string" id="2036379">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2036383">&amp;&amp;</span>&nbsp;<span class="ident" id="2036386">isSpace</span><span class="op" id="2036393">(</span><span class="builtintype" id="2036394">rune</span><span class="op" id="2036398">(</span><span class="ident" id="2036399">c</span><span class="op" id="2036400">)</span><span class="op" id="2036401">)</span>&nbsp;<span class="op" id="2036403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2036407">return</span>&nbsp;<span class="ident" id="2036414">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2036429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2036432">switch</span>&nbsp;<span class="ident" id="2036439">c</span>&nbsp;<span class="op" id="2036441">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2036444">case</span>&nbsp;<span class="string" id="2036449">&#39;{&#39;</span><span class="op" id="2036452">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2036456">s</span><span class="op" id="2036457">.</span><span class="ident" id="2036458">step</span>&nbsp;<span class="op" id="2036463">=</span>&nbsp;<span class="ident" id="2036465">stateBeginStringOrEmpty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2036491">s</span><span class="op" id="2036492">.</span><span class="ident" id="2036493">pushParseState</span><span class="op" id="2036507">(</span><span class="ident" id="2036508">parseObjectKey</span><span class="op" id="2036522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2036526">return</span>&nbsp;<span class="ident" id="2036533">scanBeginObject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2036550">case</span>&nbsp;<span class="string" id="2036555">&#39;[&#39;</span><span class="op" id="2036558">:</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2036562">s</span><span class="op" id="2036563">.</span><span class="ident" id="2036564">step</span>&nbsp;<span class="op" id="2036569">=</span>&nbsp;<span class="ident" id="2036571">stateBeginValueOrEmpty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2036596">s</span><span class="op" id="2036597">.</span><span class="ident" id="2036598">pushParseState</span><span class="op" id="2036612">(</span><span class="ident" id="2036613">parseArrayValue</span><span class="op" id="2036628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2036632">return</span>&nbsp;<span class="ident" id="2036639">scanBeginArray</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2036655">case</span>&nbsp;<span class="string" id="2036660">&#39;&#34;&#39;</span><span class="op" id="2036663">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2036667">s</span><span class="op" id="2036668">.</span><span class="ident" id="2036669">step</span>&nbsp;<span class="op" id="2036674">=</span>&nbsp;<span class="ident" id="2036676">stateInString</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2036692">return</span>&nbsp;<span class="ident" id="2036699">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2036717">case</span>&nbsp;<span class="string" id="2036722">&#39;-&#39;</span><span class="op" id="2036725">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2036729">s</span><span class="op" id="2036730">.</span><span class="ident" id="2036731">step</span>&nbsp;<span class="op" id="2036736">=</span>&nbsp;<span class="ident" id="2036738">stateNeg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2036749">return</span>&nbsp;<span class="ident" id="2036756">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2036774">case</span>&nbsp;<span class="string" id="2036779">&#39;0&#39;</span><span class="op" id="2036782">:</span>&nbsp;<span class="comment" id="2036784">//&nbsp;beginning&nbsp;of&nbsp;0.123</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2036808">s</span><span class="op" id="2036809">.</span><span class="ident" id="2036810">step</span>&nbsp;<span class="op" id="2036815">=</span>&nbsp;<span class="ident" id="2036817">state0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2036826">return</span>&nbsp;<span class="ident" id="2036833">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2036851">case</span>&nbsp;<span class="string" id="2036856">&#39;t&#39;</span><span class="op" id="2036859">:</span>&nbsp;<span class="comment" id="2036861">//&nbsp;beginning&nbsp;of&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2036884">s</span><span class="op" id="2036885">.</span><span class="ident" id="2036886">step</span>&nbsp;<span class="op" id="2036891">=</span>&nbsp;<span class="ident" id="2036893">stateT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2036902">return</span>&nbsp;<span class="ident" id="2036909">scanBeginLiteral</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2036927">case</span>&nbsp;<span class="string" id="2036932">&#39;f&#39;</span><span class="op" id="2036935">:</span>&nbsp;<span class="comment" id="2036937">//&nbsp;beginning&nbsp;of&nbsp;false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2036961">s</span><span class="op" id="2036962">.</span><span class="ident" id="2036963">step</span>&nbsp;<span class="op" id="2036968">=</span>&nbsp;<span class="ident" id="2036970">stateF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2036979">return</span>&nbsp;<span class="ident" id="2036986">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2037004">case</span>&nbsp;<span class="string" id="2037009">&#39;n&#39;</span><span class="op" id="2037012">:</span>&nbsp;<span class="comment" id="2037014">//&nbsp;beginning&nbsp;of&nbsp;null</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2037037">s</span><span class="op" id="2037038">.</span><span class="ident" id="2037039">step</span>&nbsp;<span class="op" id="2037044">=</span>&nbsp;<span class="ident" id="2037046">stateN</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2037055">return</span>&nbsp;<span class="ident" id="2037062">scanBeginLiteral</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2037080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2037083">if</span>&nbsp;<span class="string" id="2037086">&#39;1&#39;</span>&nbsp;<span class="op" id="2037090">&lt;=</span>&nbsp;<span class="ident" id="2037093">c</span>&nbsp;<span class="op" id="2037095">&amp;&amp;</span>&nbsp;<span class="ident" id="2037098">c</span>&nbsp;<span class="op" id="2037100">&lt;=</span>&nbsp;<span class="string" id="2037103">&#39;9&#39;</span>&nbsp;<span class="op" id="2037107">{</span>&nbsp;<span class="comment" id="2037109">//&nbsp;beginning&nbsp;of&nbsp;1234.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2037134">s</span><span class="op" id="2037135">.</span><span class="ident" id="2037136">step</span>&nbsp;<span class="op" id="2037141">=</span>&nbsp;<span class="ident" id="2037143">state1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2037152">return</span>&nbsp;<span class="ident" id="2037159">scanBeginLiteral</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2037177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2037180">return</span>&nbsp;<span class="ident" id="2037187">s</span><span class="op" id="2037188">.</span><span class="builtintype" id="2037189">error</span><span class="op" id="2037194">(</span><span class="ident" id="2037195">c</span><span class="op" id="2037196">,</span>&nbsp;<span class="string" id="2037198">&#34;looking&nbsp;for&nbsp;beginning&nbsp;of&nbsp;value&#34;</span><span class="op" id="2037230">)</span><br>
<span class="lineno"></span><span class="op" id="2037232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2037235">//&nbsp;stateBeginStringOrEmpty&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`{`.</span><br>
<span class="lineno">240</span><span class="keyword" id="2037294">func</span>&nbsp;<span class="ident" id="2037299">stateBeginStringOrEmpty</span><span class="op" id="2037322">(</span><span class="ident" id="2037323">s</span>&nbsp;<span class="op" id="2037325">*</span><span class="ident" id="2037326">scanner</span><span class="op" id="2037333">,</span>&nbsp;<span class="ident" id="2037335">c</span>&nbsp;<span class="builtintype" id="2037337">int</span><span class="op" id="2037340">)</span>&nbsp;<span class="builtintype" id="2037342">int</span>&nbsp;<span class="op" id="2037346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2037349">if</span>&nbsp;<span class="ident" id="2037352">c</span>&nbsp;<span class="op" id="2037354">&lt;=</span>&nbsp;<span class="string" id="2037357">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2037361">&amp;&amp;</span>&nbsp;<span class="ident" id="2037364">isSpace</span><span class="op" id="2037371">(</span><span class="builtintype" id="2037372">rune</span><span class="op" id="2037376">(</span><span class="ident" id="2037377">c</span><span class="op" id="2037378">)</span><span class="op" id="2037379">)</span>&nbsp;<span class="op" id="2037381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2037385">return</span>&nbsp;<span class="ident" id="2037392">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2037407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2037410">if</span>&nbsp;<span class="ident" id="2037413">c</span>&nbsp;<span class="op" id="2037415">==</span>&nbsp;<span class="string" id="2037418">&#39;}&#39;</span>&nbsp;<span class="op" id="2037422">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2037426">n</span>&nbsp;<span class="op" id="2037428">:=</span>&nbsp;<span class="builtinfunc" id="2037431">len</span><span class="op" id="2037434">(</span><span class="ident" id="2037435">s</span><span class="op" id="2037436">.</span><span class="ident" id="2037437">parseState</span><span class="op" id="2037447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2037451">s</span><span class="op" id="2037452">.</span><span class="ident" id="2037453">parseState</span><span class="op" id="2037463">[</span><span class="ident" id="2037464">n</span><span class="op" id="2037465">-</span><span class="num" id="2037466">1</span><span class="op" id="2037467">]</span>&nbsp;<span class="op" id="2037469">=</span>&nbsp;<span class="ident" id="2037471">parseObjectValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2037490">return</span>&nbsp;<span class="ident" id="2037497">stateEndValue</span><span class="op" id="2037510">(</span><span class="ident" id="2037511">s</span><span class="op" id="2037512">,</span>&nbsp;<span class="ident" id="2037514">c</span><span class="op" id="2037515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2037518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2037521">return</span>&nbsp;<span class="ident" id="2037528">stateBeginString</span><span class="op" id="2037544">(</span><span class="ident" id="2037545">s</span><span class="op" id="2037546">,</span>&nbsp;<span class="ident" id="2037548">c</span><span class="op" id="2037549">)</span><br>
<span class="lineno">250</span><span class="op" id="2037551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2037554">//&nbsp;stateBeginString&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`{&#34;key&#34;:&nbsp;value,`.</span><br>
<span class="lineno"></span><span class="keyword" id="2037619">func</span>&nbsp;<span class="ident" id="2037624">stateBeginString</span><span class="op" id="2037640">(</span><span class="ident" id="2037641">s</span>&nbsp;<span class="op" id="2037643">*</span><span class="ident" id="2037644">scanner</span><span class="op" id="2037651">,</span>&nbsp;<span class="ident" id="2037653">c</span>&nbsp;<span class="builtintype" id="2037655">int</span><span class="op" id="2037658">)</span>&nbsp;<span class="builtintype" id="2037660">int</span>&nbsp;<span class="op" id="2037664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2037667">if</span>&nbsp;<span class="ident" id="2037670">c</span>&nbsp;<span class="op" id="2037672">&lt;=</span>&nbsp;<span class="string" id="2037675">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2037679">&amp;&amp;</span>&nbsp;<span class="ident" id="2037682">isSpace</span><span class="op" id="2037689">(</span><span class="builtintype" id="2037690">rune</span><span class="op" id="2037694">(</span><span class="ident" id="2037695">c</span><span class="op" id="2037696">)</span><span class="op" id="2037697">)</span>&nbsp;<span class="op" id="2037699">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2037703">return</span>&nbsp;<span class="ident" id="2037710">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2037725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2037728">if</span>&nbsp;<span class="ident" id="2037731">c</span>&nbsp;<span class="op" id="2037733">==</span>&nbsp;<span class="string" id="2037736">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2037740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2037744">s</span><span class="op" id="2037745">.</span><span class="ident" id="2037746">step</span>&nbsp;<span class="op" id="2037751">=</span>&nbsp;<span class="ident" id="2037753">stateInString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2037769">return</span>&nbsp;<span class="ident" id="2037776">scanBeginLiteral</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2037794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2037797">return</span>&nbsp;<span class="ident" id="2037804">s</span><span class="op" id="2037805">.</span><span class="builtintype" id="2037806">error</span><span class="op" id="2037811">(</span><span class="ident" id="2037812">c</span><span class="op" id="2037813">,</span>&nbsp;<span class="string" id="2037815">&#34;looking&nbsp;for&nbsp;beginning&nbsp;of&nbsp;object&nbsp;key&nbsp;string&#34;</span><span class="op" id="2037859">)</span><br>
<span class="lineno"></span><span class="op" id="2037861">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2037864">//&nbsp;stateEndValue&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;completing&nbsp;a&nbsp;value,</span><br>
<span class="lineno">265</span><span class="comment" id="2037920">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`{}`&nbsp;or&nbsp;`true`&nbsp;or&nbsp;`[&#34;x&#34;`.</span><br>
<span class="lineno"></span><span class="keyword" id="2037971">func</span>&nbsp;<span class="ident" id="2037976">stateEndValue</span><span class="op" id="2037989">(</span><span class="ident" id="2037990">s</span>&nbsp;<span class="op" id="2037992">*</span><span class="ident" id="2037993">scanner</span><span class="op" id="2038000">,</span>&nbsp;<span class="ident" id="2038002">c</span>&nbsp;<span class="builtintype" id="2038004">int</span><span class="op" id="2038007">)</span>&nbsp;<span class="builtintype" id="2038009">int</span>&nbsp;<span class="op" id="2038013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2038016">n</span>&nbsp;<span class="op" id="2038018">:=</span>&nbsp;<span class="builtinfunc" id="2038021">len</span><span class="op" id="2038024">(</span><span class="ident" id="2038025">s</span><span class="op" id="2038026">.</span><span class="ident" id="2038027">parseState</span><span class="op" id="2038037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2038040">if</span>&nbsp;<span class="ident" id="2038043">n</span>&nbsp;<span class="op" id="2038045">==</span>&nbsp;<span class="num" id="2038048">0</span>&nbsp;<span class="op" id="2038050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2038054">//&nbsp;Completed&nbsp;top-level&nbsp;before&nbsp;the&nbsp;current&nbsp;byte.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2038104">s</span><span class="op" id="2038105">.</span><span class="ident" id="2038106">step</span>&nbsp;<span class="op" id="2038111">=</span>&nbsp;<span class="ident" id="2038113">stateEndTop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2038127">s</span><span class="op" id="2038128">.</span><span class="ident" id="2038129">endTop</span>&nbsp;<span class="op" id="2038136">=</span>&nbsp;<span class="builtintype" id="2038138">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2038145">return</span>&nbsp;<span class="ident" id="2038152">stateEndTop</span><span class="op" id="2038163">(</span><span class="ident" id="2038164">s</span><span class="op" id="2038165">,</span>&nbsp;<span class="ident" id="2038167">c</span><span class="op" id="2038168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2038171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2038174">if</span>&nbsp;<span class="ident" id="2038177">c</span>&nbsp;<span class="op" id="2038179">&lt;=</span>&nbsp;<span class="string" id="2038182">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2038186">&amp;&amp;</span>&nbsp;<span class="ident" id="2038189">isSpace</span><span class="op" id="2038196">(</span><span class="builtintype" id="2038197">rune</span><span class="op" id="2038201">(</span><span class="ident" id="2038202">c</span><span class="op" id="2038203">)</span><span class="op" id="2038204">)</span>&nbsp;<span class="op" id="2038206">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2038210">s</span><span class="op" id="2038211">.</span><span class="ident" id="2038212">step</span>&nbsp;<span class="op" id="2038217">=</span>&nbsp;<span class="ident" id="2038219">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2038235">return</span>&nbsp;<span class="ident" id="2038242">scanSkipSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2038257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2038260">ps</span>&nbsp;<span class="op" id="2038263">:=</span>&nbsp;<span class="ident" id="2038266">s</span><span class="op" id="2038267">.</span><span class="ident" id="2038268">parseState</span><span class="op" id="2038278">[</span><span class="ident" id="2038279">n</span><span class="op" id="2038280">-</span><span class="num" id="2038281">1</span><span class="op" id="2038282">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2038285">switch</span>&nbsp;<span class="ident" id="2038292">ps</span>&nbsp;<span class="op" id="2038295">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2038298">case</span>&nbsp;<span class="ident" id="2038303">parseObjectKey</span><span class="op" id="2038317">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2038321">if</span>&nbsp;<span class="ident" id="2038324">c</span>&nbsp;<span class="op" id="2038326">==</span>&nbsp;<span class="string" id="2038329">&#39;:&#39;</span>&nbsp;<span class="op" id="2038333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2038338">s</span><span class="op" id="2038339">.</span><span class="ident" id="2038340">parseState</span><span class="op" id="2038350">[</span><span class="ident" id="2038351">n</span><span class="op" id="2038352">-</span><span class="num" id="2038353">1</span><span class="op" id="2038354">]</span>&nbsp;<span class="op" id="2038356">=</span>&nbsp;<span class="ident" id="2038358">parseObjectValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2038378">s</span><span class="op" id="2038379">.</span><span class="ident" id="2038380">step</span>&nbsp;<span class="op" id="2038385">=</span>&nbsp;<span class="ident" id="2038387">stateBeginValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2038406">return</span>&nbsp;<span class="ident" id="2038413">scanObjectKey</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2038429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2038433">return</span>&nbsp;<span class="ident" id="2038440">s</span><span class="op" id="2038441">.</span><span class="builtintype" id="2038442">error</span><span class="op" id="2038447">(</span><span class="ident" id="2038448">c</span><span class="op" id="2038449">,</span>&nbsp;<span class="string" id="2038451">&#34;after&nbsp;object&nbsp;key&#34;</span><span class="op" id="2038469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2038472">case</span>&nbsp;<span class="ident" id="2038477">parseObjectValue</span><span class="op" id="2038493">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2038497">if</span>&nbsp;<span class="ident" id="2038500">c</span>&nbsp;<span class="op" id="2038502">==</span>&nbsp;<span class="string" id="2038505">&#39;,&#39;</span>&nbsp;<span class="op" id="2038509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2038514">s</span><span class="op" id="2038515">.</span><span class="ident" id="2038516">parseState</span><span class="op" id="2038526">[</span><span class="ident" id="2038527">n</span><span class="op" id="2038528">-</span><span class="num" id="2038529">1</span><span class="op" id="2038530">]</span>&nbsp;<span class="op" id="2038532">=</span>&nbsp;<span class="ident" id="2038534">parseObjectKey</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2038552">s</span><span class="op" id="2038553">.</span><span class="ident" id="2038554">step</span>&nbsp;<span class="op" id="2038559">=</span>&nbsp;<span class="ident" id="2038561">stateBeginString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2038581">return</span>&nbsp;<span class="ident" id="2038588">scanObjectValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2038606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2038610">if</span>&nbsp;<span class="ident" id="2038613">c</span>&nbsp;<span class="op" id="2038615">==</span>&nbsp;<span class="string" id="2038618">&#39;}&#39;</span>&nbsp;<span class="op" id="2038622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2038627">s</span><span class="op" id="2038628">.</span><span class="ident" id="2038629">popParseState</span><span class="op" id="2038642">(</span><span class="op" id="2038643">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2038648">return</span>&nbsp;<span class="ident" id="2038655">scanEndObject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2038671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2038675">return</span>&nbsp;<span class="ident" id="2038682">s</span><span class="op" id="2038683">.</span><span class="builtintype" id="2038684">error</span><span class="op" id="2038689">(</span><span class="ident" id="2038690">c</span><span class="op" id="2038691">,</span>&nbsp;<span class="string" id="2038693">&#34;after&nbsp;object&nbsp;key:value&nbsp;pair&#34;</span><span class="op" id="2038722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2038725">case</span>&nbsp;<span class="ident" id="2038730">parseArrayValue</span><span class="op" id="2038745">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2038749">if</span>&nbsp;<span class="ident" id="2038752">c</span>&nbsp;<span class="op" id="2038754">==</span>&nbsp;<span class="string" id="2038757">&#39;,&#39;</span>&nbsp;<span class="op" id="2038761">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2038766">s</span><span class="op" id="2038767">.</span><span class="ident" id="2038768">step</span>&nbsp;<span class="op" id="2038773">=</span>&nbsp;<span class="ident" id="2038775">stateBeginValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2038794">return</span>&nbsp;<span class="ident" id="2038801">scanArrayValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2038818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2038822">if</span>&nbsp;<span class="ident" id="2038825">c</span>&nbsp;<span class="op" id="2038827">==</span>&nbsp;<span class="string" id="2038830">&#39;]&#39;</span>&nbsp;<span class="op" id="2038834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2038839">s</span><span class="op" id="2038840">.</span><span class="ident" id="2038841">popParseState</span><span class="op" id="2038854">(</span><span class="op" id="2038855">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2038860">return</span>&nbsp;<span class="ident" id="2038867">scanEndArray</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2038882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2038886">return</span>&nbsp;<span class="ident" id="2038893">s</span><span class="op" id="2038894">.</span><span class="builtintype" id="2038895">error</span><span class="op" id="2038900">(</span><span class="ident" id="2038901">c</span><span class="op" id="2038902">,</span>&nbsp;<span class="string" id="2038904">&#34;after&nbsp;array&nbsp;element&#34;</span><span class="op" id="2038925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2038928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2038931">return</span>&nbsp;<span class="ident" id="2038938">s</span><span class="op" id="2038939">.</span><span class="builtintype" id="2038940">error</span><span class="op" id="2038945">(</span><span class="ident" id="2038946">c</span><span class="op" id="2038947">,</span>&nbsp;<span class="string" id="2038949">&#34;&#34;</span><span class="op" id="2038951">)</span><br>
<span class="lineno">310</span><span class="op" id="2038953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2038956">//&nbsp;stateEndTop&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;finishing&nbsp;the&nbsp;top-level&nbsp;value,</span><br>
<span class="lineno"></span><span class="comment" id="2039021">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`{}`&nbsp;or&nbsp;`[1,2,3]`.</span><br>
<span class="lineno"></span><span class="comment" id="2039065">//&nbsp;Only&nbsp;space&nbsp;characters&nbsp;should&nbsp;be&nbsp;seen&nbsp;now.</span><br>
<span class="lineno">315</span><span class="keyword" id="2039110">func</span>&nbsp;<span class="ident" id="2039115">stateEndTop</span><span class="op" id="2039126">(</span><span class="ident" id="2039127">s</span>&nbsp;<span class="op" id="2039129">*</span><span class="ident" id="2039130">scanner</span><span class="op" id="2039137">,</span>&nbsp;<span class="ident" id="2039139">c</span>&nbsp;<span class="builtintype" id="2039141">int</span><span class="op" id="2039144">)</span>&nbsp;<span class="builtintype" id="2039146">int</span>&nbsp;<span class="op" id="2039150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2039153">if</span>&nbsp;<span class="ident" id="2039156">c</span>&nbsp;<span class="op" id="2039158">!=</span>&nbsp;<span class="string" id="2039161">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2039165">&amp;&amp;</span>&nbsp;<span class="ident" id="2039168">c</span>&nbsp;<span class="op" id="2039170">!=</span>&nbsp;<span class="string" id="2039173">&#39;\t&#39;</span>&nbsp;<span class="op" id="2039178">&amp;&amp;</span>&nbsp;<span class="ident" id="2039181">c</span>&nbsp;<span class="op" id="2039183">!=</span>&nbsp;<span class="string" id="2039186">&#39;\r&#39;</span>&nbsp;<span class="op" id="2039191">&amp;&amp;</span>&nbsp;<span class="ident" id="2039194">c</span>&nbsp;<span class="op" id="2039196">!=</span>&nbsp;<span class="string" id="2039199">&#39;\n&#39;</span>&nbsp;<span class="op" id="2039204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2039208">//&nbsp;Complain&nbsp;about&nbsp;non-space&nbsp;byte&nbsp;on&nbsp;next&nbsp;call.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2039257">s</span><span class="op" id="2039258">.</span><span class="builtintype" id="2039259">error</span><span class="op" id="2039264">(</span><span class="ident" id="2039265">c</span><span class="op" id="2039266">,</span>&nbsp;<span class="string" id="2039268">&#34;after&nbsp;top-level&nbsp;value&#34;</span><span class="op" id="2039291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2039294">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2039297">return</span>&nbsp;<span class="ident" id="2039304">scanEnd</span><br>
<span class="lineno"></span><span class="op" id="2039312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2039315">//&nbsp;stateInString&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;`.</span><br>
<span class="lineno"></span><span class="keyword" id="2039364">func</span>&nbsp;<span class="ident" id="2039369">stateInString</span><span class="op" id="2039382">(</span><span class="ident" id="2039383">s</span>&nbsp;<span class="op" id="2039385">*</span><span class="ident" id="2039386">scanner</span><span class="op" id="2039393">,</span>&nbsp;<span class="ident" id="2039395">c</span>&nbsp;<span class="builtintype" id="2039397">int</span><span class="op" id="2039400">)</span>&nbsp;<span class="builtintype" id="2039402">int</span>&nbsp;<span class="op" id="2039406">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2039409">if</span>&nbsp;<span class="ident" id="2039412">c</span>&nbsp;<span class="op" id="2039414">==</span>&nbsp;<span class="string" id="2039417">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2039421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2039425">s</span><span class="op" id="2039426">.</span><span class="ident" id="2039427">step</span>&nbsp;<span class="op" id="2039432">=</span>&nbsp;<span class="ident" id="2039434">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2039450">return</span>&nbsp;<span class="ident" id="2039457">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2039471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2039474">if</span>&nbsp;<span class="ident" id="2039477">c</span>&nbsp;<span class="op" id="2039479">==</span>&nbsp;<span class="string" id="2039482">&#39;\\&#39;</span>&nbsp;<span class="op" id="2039487">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2039491">s</span><span class="op" id="2039492">.</span><span class="ident" id="2039493">step</span>&nbsp;<span class="op" id="2039498">=</span>&nbsp;<span class="ident" id="2039500">stateInStringEsc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2039519">return</span>&nbsp;<span class="ident" id="2039526">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2039540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2039543">if</span>&nbsp;<span class="ident" id="2039546">c</span>&nbsp;<span class="op" id="2039548">&lt;</span>&nbsp;<span class="num" id="2039550">0x20</span>&nbsp;<span class="op" id="2039555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2039559">return</span>&nbsp;<span class="ident" id="2039566">s</span><span class="op" id="2039567">.</span><span class="builtintype" id="2039568">error</span><span class="op" id="2039573">(</span><span class="ident" id="2039574">c</span><span class="op" id="2039575">,</span>&nbsp;<span class="string" id="2039577">&#34;in&nbsp;string&nbsp;literal&#34;</span><span class="op" id="2039596">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2039599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2039602">return</span>&nbsp;<span class="ident" id="2039609">scanContinue</span><br>
<span class="lineno"></span><span class="op" id="2039622">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2039625">//&nbsp;stateInStringEsc&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">340</span><span class="keyword" id="2039701">func</span>&nbsp;<span class="ident" id="2039706">stateInStringEsc</span><span class="op" id="2039722">(</span><span class="ident" id="2039723">s</span>&nbsp;<span class="op" id="2039725">*</span><span class="ident" id="2039726">scanner</span><span class="op" id="2039733">,</span>&nbsp;<span class="ident" id="2039735">c</span>&nbsp;<span class="builtintype" id="2039737">int</span><span class="op" id="2039740">)</span>&nbsp;<span class="builtintype" id="2039742">int</span>&nbsp;<span class="op" id="2039746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2039749">switch</span>&nbsp;<span class="ident" id="2039756">c</span>&nbsp;<span class="op" id="2039758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2039761">case</span>&nbsp;<span class="string" id="2039766">&#39;b&#39;</span><span class="op" id="2039769">,</span>&nbsp;<span class="string" id="2039771">&#39;f&#39;</span><span class="op" id="2039774">,</span>&nbsp;<span class="string" id="2039776">&#39;n&#39;</span><span class="op" id="2039779">,</span>&nbsp;<span class="string" id="2039781">&#39;r&#39;</span><span class="op" id="2039784">,</span>&nbsp;<span class="string" id="2039786">&#39;t&#39;</span><span class="op" id="2039789">,</span>&nbsp;<span class="string" id="2039791">&#39;\\&#39;</span><span class="op" id="2039795">,</span>&nbsp;<span class="string" id="2039797">&#39;/&#39;</span><span class="op" id="2039800">,</span>&nbsp;<span class="string" id="2039802">&#39;&#34;&#39;</span><span class="op" id="2039805">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2039809">s</span><span class="op" id="2039810">.</span><span class="ident" id="2039811">step</span>&nbsp;<span class="op" id="2039816">=</span>&nbsp;<span class="ident" id="2039818">stateInString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2039834">return</span>&nbsp;<span class="ident" id="2039841">scanContinue</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2039855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2039858">if</span>&nbsp;<span class="ident" id="2039861">c</span>&nbsp;<span class="op" id="2039863">==</span>&nbsp;<span class="string" id="2039866">&#39;u&#39;</span>&nbsp;<span class="op" id="2039870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2039874">s</span><span class="op" id="2039875">.</span><span class="ident" id="2039876">step</span>&nbsp;<span class="op" id="2039881">=</span>&nbsp;<span class="ident" id="2039883">stateInStringEscU</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2039903">return</span>&nbsp;<span class="ident" id="2039910">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2039924">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2039927">return</span>&nbsp;<span class="ident" id="2039934">s</span><span class="op" id="2039935">.</span><span class="builtintype" id="2039936">error</span><span class="op" id="2039941">(</span><span class="ident" id="2039942">c</span><span class="op" id="2039943">,</span>&nbsp;<span class="string" id="2039945">&#34;in&nbsp;string&nbsp;escape&nbsp;code&#34;</span><span class="op" id="2039968">)</span><br>
<span class="lineno"></span><span class="op" id="2039970">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2039973">//&nbsp;stateInStringEscU&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2040051">func</span>&nbsp;<span class="ident" id="2040056">stateInStringEscU</span><span class="op" id="2040073">(</span><span class="ident" id="2040074">s</span>&nbsp;<span class="op" id="2040076">*</span><span class="ident" id="2040077">scanner</span><span class="op" id="2040084">,</span>&nbsp;<span class="ident" id="2040086">c</span>&nbsp;<span class="builtintype" id="2040088">int</span><span class="op" id="2040091">)</span>&nbsp;<span class="builtintype" id="2040093">int</span>&nbsp;<span class="op" id="2040097">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2040100">if</span>&nbsp;<span class="string" id="2040103">&#39;0&#39;</span>&nbsp;<span class="op" id="2040107">&lt;=</span>&nbsp;<span class="ident" id="2040110">c</span>&nbsp;<span class="op" id="2040112">&amp;&amp;</span>&nbsp;<span class="ident" id="2040115">c</span>&nbsp;<span class="op" id="2040117">&lt;=</span>&nbsp;<span class="string" id="2040120">&#39;9&#39;</span>&nbsp;<span class="op" id="2040124">||</span>&nbsp;<span class="string" id="2040127">&#39;a&#39;</span>&nbsp;<span class="op" id="2040131">&lt;=</span>&nbsp;<span class="ident" id="2040134">c</span>&nbsp;<span class="op" id="2040136">&amp;&amp;</span>&nbsp;<span class="ident" id="2040139">c</span>&nbsp;<span class="op" id="2040141">&lt;=</span>&nbsp;<span class="string" id="2040144">&#39;f&#39;</span>&nbsp;<span class="op" id="2040148">||</span>&nbsp;<span class="string" id="2040151">&#39;A&#39;</span>&nbsp;<span class="op" id="2040155">&lt;=</span>&nbsp;<span class="ident" id="2040158">c</span>&nbsp;<span class="op" id="2040160">&amp;&amp;</span>&nbsp;<span class="ident" id="2040163">c</span>&nbsp;<span class="op" id="2040165">&lt;=</span>&nbsp;<span class="string" id="2040168">&#39;F&#39;</span>&nbsp;<span class="op" id="2040172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2040176">s</span><span class="op" id="2040177">.</span><span class="ident" id="2040178">step</span>&nbsp;<span class="op" id="2040183">=</span>&nbsp;<span class="ident" id="2040185">stateInStringEscU1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2040206">return</span>&nbsp;<span class="ident" id="2040213">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2040227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2040230">//&nbsp;numbers</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2040242">return</span>&nbsp;<span class="ident" id="2040249">s</span><span class="op" id="2040250">.</span><span class="builtintype" id="2040251">error</span><span class="op" id="2040256">(</span><span class="ident" id="2040257">c</span><span class="op" id="2040258">,</span>&nbsp;<span class="string" id="2040260">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="2040297">)</span><br>
<span class="lineno"></span><span class="op" id="2040299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2040302">//&nbsp;stateInStringEscU1&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u1`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2040382">func</span>&nbsp;<span class="ident" id="2040387">stateInStringEscU1</span><span class="op" id="2040405">(</span><span class="ident" id="2040406">s</span>&nbsp;<span class="op" id="2040408">*</span><span class="ident" id="2040409">scanner</span><span class="op" id="2040416">,</span>&nbsp;<span class="ident" id="2040418">c</span>&nbsp;<span class="builtintype" id="2040420">int</span><span class="op" id="2040423">)</span>&nbsp;<span class="builtintype" id="2040425">int</span>&nbsp;<span class="op" id="2040429">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2040432">if</span>&nbsp;<span class="string" id="2040435">&#39;0&#39;</span>&nbsp;<span class="op" id="2040439">&lt;=</span>&nbsp;<span class="ident" id="2040442">c</span>&nbsp;<span class="op" id="2040444">&amp;&amp;</span>&nbsp;<span class="ident" id="2040447">c</span>&nbsp;<span class="op" id="2040449">&lt;=</span>&nbsp;<span class="string" id="2040452">&#39;9&#39;</span>&nbsp;<span class="op" id="2040456">||</span>&nbsp;<span class="string" id="2040459">&#39;a&#39;</span>&nbsp;<span class="op" id="2040463">&lt;=</span>&nbsp;<span class="ident" id="2040466">c</span>&nbsp;<span class="op" id="2040468">&amp;&amp;</span>&nbsp;<span class="ident" id="2040471">c</span>&nbsp;<span class="op" id="2040473">&lt;=</span>&nbsp;<span class="string" id="2040476">&#39;f&#39;</span>&nbsp;<span class="op" id="2040480">||</span>&nbsp;<span class="string" id="2040483">&#39;A&#39;</span>&nbsp;<span class="op" id="2040487">&lt;=</span>&nbsp;<span class="ident" id="2040490">c</span>&nbsp;<span class="op" id="2040492">&amp;&amp;</span>&nbsp;<span class="ident" id="2040495">c</span>&nbsp;<span class="op" id="2040497">&lt;=</span>&nbsp;<span class="string" id="2040500">&#39;F&#39;</span>&nbsp;<span class="op" id="2040504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2040508">s</span><span class="op" id="2040509">.</span><span class="ident" id="2040510">step</span>&nbsp;<span class="op" id="2040515">=</span>&nbsp;<span class="ident" id="2040517">stateInStringEscU12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2040539">return</span>&nbsp;<span class="ident" id="2040546">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2040560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2040563">//&nbsp;numbers</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2040575">return</span>&nbsp;<span class="ident" id="2040582">s</span><span class="op" id="2040583">.</span><span class="builtintype" id="2040584">error</span><span class="op" id="2040589">(</span><span class="ident" id="2040590">c</span><span class="op" id="2040591">,</span>&nbsp;<span class="string" id="2040593">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="2040630">)</span><br>
<span class="lineno"></span><span class="op" id="2040632">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2040635">//&nbsp;stateInStringEscU12&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u12`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2040717">func</span>&nbsp;<span class="ident" id="2040722">stateInStringEscU12</span><span class="op" id="2040741">(</span><span class="ident" id="2040742">s</span>&nbsp;<span class="op" id="2040744">*</span><span class="ident" id="2040745">scanner</span><span class="op" id="2040752">,</span>&nbsp;<span class="ident" id="2040754">c</span>&nbsp;<span class="builtintype" id="2040756">int</span><span class="op" id="2040759">)</span>&nbsp;<span class="builtintype" id="2040761">int</span>&nbsp;<span class="op" id="2040765">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2040768">if</span>&nbsp;<span class="string" id="2040771">&#39;0&#39;</span>&nbsp;<span class="op" id="2040775">&lt;=</span>&nbsp;<span class="ident" id="2040778">c</span>&nbsp;<span class="op" id="2040780">&amp;&amp;</span>&nbsp;<span class="ident" id="2040783">c</span>&nbsp;<span class="op" id="2040785">&lt;=</span>&nbsp;<span class="string" id="2040788">&#39;9&#39;</span>&nbsp;<span class="op" id="2040792">||</span>&nbsp;<span class="string" id="2040795">&#39;a&#39;</span>&nbsp;<span class="op" id="2040799">&lt;=</span>&nbsp;<span class="ident" id="2040802">c</span>&nbsp;<span class="op" id="2040804">&amp;&amp;</span>&nbsp;<span class="ident" id="2040807">c</span>&nbsp;<span class="op" id="2040809">&lt;=</span>&nbsp;<span class="string" id="2040812">&#39;f&#39;</span>&nbsp;<span class="op" id="2040816">||</span>&nbsp;<span class="string" id="2040819">&#39;A&#39;</span>&nbsp;<span class="op" id="2040823">&lt;=</span>&nbsp;<span class="ident" id="2040826">c</span>&nbsp;<span class="op" id="2040828">&amp;&amp;</span>&nbsp;<span class="ident" id="2040831">c</span>&nbsp;<span class="op" id="2040833">&lt;=</span>&nbsp;<span class="string" id="2040836">&#39;F&#39;</span>&nbsp;<span class="op" id="2040840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2040844">s</span><span class="op" id="2040845">.</span><span class="ident" id="2040846">step</span>&nbsp;<span class="op" id="2040851">=</span>&nbsp;<span class="ident" id="2040853">stateInStringEscU123</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2040876">return</span>&nbsp;<span class="ident" id="2040883">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2040897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2040900">//&nbsp;numbers</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2040912">return</span>&nbsp;<span class="ident" id="2040919">s</span><span class="op" id="2040920">.</span><span class="builtintype" id="2040921">error</span><span class="op" id="2040926">(</span><span class="ident" id="2040927">c</span><span class="op" id="2040928">,</span>&nbsp;<span class="string" id="2040930">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="2040967">)</span><br>
<span class="lineno"></span><span class="op" id="2040969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2040972">//&nbsp;stateInStringEscU123&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`&#34;\u123`&nbsp;during&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2041056">func</span>&nbsp;<span class="ident" id="2041061">stateInStringEscU123</span><span class="op" id="2041081">(</span><span class="ident" id="2041082">s</span>&nbsp;<span class="op" id="2041084">*</span><span class="ident" id="2041085">scanner</span><span class="op" id="2041092">,</span>&nbsp;<span class="ident" id="2041094">c</span>&nbsp;<span class="builtintype" id="2041096">int</span><span class="op" id="2041099">)</span>&nbsp;<span class="builtintype" id="2041101">int</span>&nbsp;<span class="op" id="2041105">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2041108">if</span>&nbsp;<span class="string" id="2041111">&#39;0&#39;</span>&nbsp;<span class="op" id="2041115">&lt;=</span>&nbsp;<span class="ident" id="2041118">c</span>&nbsp;<span class="op" id="2041120">&amp;&amp;</span>&nbsp;<span class="ident" id="2041123">c</span>&nbsp;<span class="op" id="2041125">&lt;=</span>&nbsp;<span class="string" id="2041128">&#39;9&#39;</span>&nbsp;<span class="op" id="2041132">||</span>&nbsp;<span class="string" id="2041135">&#39;a&#39;</span>&nbsp;<span class="op" id="2041139">&lt;=</span>&nbsp;<span class="ident" id="2041142">c</span>&nbsp;<span class="op" id="2041144">&amp;&amp;</span>&nbsp;<span class="ident" id="2041147">c</span>&nbsp;<span class="op" id="2041149">&lt;=</span>&nbsp;<span class="string" id="2041152">&#39;f&#39;</span>&nbsp;<span class="op" id="2041156">||</span>&nbsp;<span class="string" id="2041159">&#39;A&#39;</span>&nbsp;<span class="op" id="2041163">&lt;=</span>&nbsp;<span class="ident" id="2041166">c</span>&nbsp;<span class="op" id="2041168">&amp;&amp;</span>&nbsp;<span class="ident" id="2041171">c</span>&nbsp;<span class="op" id="2041173">&lt;=</span>&nbsp;<span class="string" id="2041176">&#39;F&#39;</span>&nbsp;<span class="op" id="2041180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2041184">s</span><span class="op" id="2041185">.</span><span class="ident" id="2041186">step</span>&nbsp;<span class="op" id="2041191">=</span>&nbsp;<span class="ident" id="2041193">stateInString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2041209">return</span>&nbsp;<span class="ident" id="2041216">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2041230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2041233">//&nbsp;numbers</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2041245">return</span>&nbsp;<span class="ident" id="2041252">s</span><span class="op" id="2041253">.</span><span class="builtintype" id="2041254">error</span><span class="op" id="2041259">(</span><span class="ident" id="2041260">c</span><span class="op" id="2041261">,</span>&nbsp;<span class="string" id="2041263">&#34;in&nbsp;\\u&nbsp;hexadecimal&nbsp;character&nbsp;escape&#34;</span><span class="op" id="2041300">)</span><br>
<span class="lineno"></span><span class="op" id="2041302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2041305">//&nbsp;stateNeg&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`-`&nbsp;during&nbsp;a&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="2041365">func</span>&nbsp;<span class="ident" id="2041370">stateNeg</span><span class="op" id="2041378">(</span><span class="ident" id="2041379">s</span>&nbsp;<span class="op" id="2041381">*</span><span class="ident" id="2041382">scanner</span><span class="op" id="2041389">,</span>&nbsp;<span class="ident" id="2041391">c</span>&nbsp;<span class="builtintype" id="2041393">int</span><span class="op" id="2041396">)</span>&nbsp;<span class="builtintype" id="2041398">int</span>&nbsp;<span class="op" id="2041402">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2041405">if</span>&nbsp;<span class="ident" id="2041408">c</span>&nbsp;<span class="op" id="2041410">==</span>&nbsp;<span class="string" id="2041413">&#39;0&#39;</span>&nbsp;<span class="op" id="2041417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2041421">s</span><span class="op" id="2041422">.</span><span class="ident" id="2041423">step</span>&nbsp;<span class="op" id="2041428">=</span>&nbsp;<span class="ident" id="2041430">state0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2041439">return</span>&nbsp;<span class="ident" id="2041446">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2041460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2041463">if</span>&nbsp;<span class="string" id="2041466">&#39;1&#39;</span>&nbsp;<span class="op" id="2041470">&lt;=</span>&nbsp;<span class="ident" id="2041473">c</span>&nbsp;<span class="op" id="2041475">&amp;&amp;</span>&nbsp;<span class="ident" id="2041478">c</span>&nbsp;<span class="op" id="2041480">&lt;=</span>&nbsp;<span class="string" id="2041483">&#39;9&#39;</span>&nbsp;<span class="op" id="2041487">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2041491">s</span><span class="op" id="2041492">.</span><span class="ident" id="2041493">step</span>&nbsp;<span class="op" id="2041498">=</span>&nbsp;<span class="ident" id="2041500">state1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2041509">return</span>&nbsp;<span class="ident" id="2041516">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2041530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2041533">return</span>&nbsp;<span class="ident" id="2041540">s</span><span class="op" id="2041541">.</span><span class="builtintype" id="2041542">error</span><span class="op" id="2041547">(</span><span class="ident" id="2041548">c</span><span class="op" id="2041549">,</span>&nbsp;<span class="string" id="2041551">&#34;in&nbsp;numeric&nbsp;literal&#34;</span><span class="op" id="2041571">)</span><br>
<span class="lineno"></span><span class="op" id="2041573">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="comment" id="2041576">//&nbsp;state1&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;a&nbsp;non-zero&nbsp;integer&nbsp;during&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="2041649">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`1`&nbsp;or&nbsp;`100`&nbsp;but&nbsp;not&nbsp;`0`.</span><br>
<span class="lineno"></span><span class="keyword" id="2041700">func</span>&nbsp;<span class="ident" id="2041705">state1</span><span class="op" id="2041711">(</span><span class="ident" id="2041712">s</span>&nbsp;<span class="op" id="2041714">*</span><span class="ident" id="2041715">scanner</span><span class="op" id="2041722">,</span>&nbsp;<span class="ident" id="2041724">c</span>&nbsp;<span class="builtintype" id="2041726">int</span><span class="op" id="2041729">)</span>&nbsp;<span class="builtintype" id="2041731">int</span>&nbsp;<span class="op" id="2041735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2041738">if</span>&nbsp;<span class="string" id="2041741">&#39;0&#39;</span>&nbsp;<span class="op" id="2041745">&lt;=</span>&nbsp;<span class="ident" id="2041748">c</span>&nbsp;<span class="op" id="2041750">&amp;&amp;</span>&nbsp;<span class="ident" id="2041753">c</span>&nbsp;<span class="op" id="2041755">&lt;=</span>&nbsp;<span class="string" id="2041758">&#39;9&#39;</span>&nbsp;<span class="op" id="2041762">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2041766">s</span><span class="op" id="2041767">.</span><span class="ident" id="2041768">step</span>&nbsp;<span class="op" id="2041773">=</span>&nbsp;<span class="ident" id="2041775">state1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2041784">return</span>&nbsp;<span class="ident" id="2041791">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2041805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2041808">return</span>&nbsp;<span class="ident" id="2041815">state0</span><span class="op" id="2041821">(</span><span class="ident" id="2041822">s</span><span class="op" id="2041823">,</span>&nbsp;<span class="ident" id="2041825">c</span><span class="op" id="2041826">)</span><br>
<span class="lineno"></span><span class="op" id="2041828">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span><span class="comment" id="2041831">//&nbsp;state0&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`0`&nbsp;during&nbsp;a&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="2041889">func</span>&nbsp;<span class="ident" id="2041894">state0</span><span class="op" id="2041900">(</span><span class="ident" id="2041901">s</span>&nbsp;<span class="op" id="2041903">*</span><span class="ident" id="2041904">scanner</span><span class="op" id="2041911">,</span>&nbsp;<span class="ident" id="2041913">c</span>&nbsp;<span class="builtintype" id="2041915">int</span><span class="op" id="2041918">)</span>&nbsp;<span class="builtintype" id="2041920">int</span>&nbsp;<span class="op" id="2041924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2041927">if</span>&nbsp;<span class="ident" id="2041930">c</span>&nbsp;<span class="op" id="2041932">==</span>&nbsp;<span class="string" id="2041935">&#39;.&#39;</span>&nbsp;<span class="op" id="2041939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2041943">s</span><span class="op" id="2041944">.</span><span class="ident" id="2041945">step</span>&nbsp;<span class="op" id="2041950">=</span>&nbsp;<span class="ident" id="2041952">stateDot</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2041963">return</span>&nbsp;<span class="ident" id="2041970">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2041984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2041987">if</span>&nbsp;<span class="ident" id="2041990">c</span>&nbsp;<span class="op" id="2041992">==</span>&nbsp;<span class="string" id="2041995">&#39;e&#39;</span>&nbsp;<span class="op" id="2041999">||</span>&nbsp;<span class="ident" id="2042002">c</span>&nbsp;<span class="op" id="2042004">==</span>&nbsp;<span class="string" id="2042007">&#39;E&#39;</span>&nbsp;<span class="op" id="2042011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2042015">s</span><span class="op" id="2042016">.</span><span class="ident" id="2042017">step</span>&nbsp;<span class="op" id="2042022">=</span>&nbsp;<span class="ident" id="2042024">stateE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2042033">return</span>&nbsp;<span class="ident" id="2042040">scanContinue</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2042054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2042057">return</span>&nbsp;<span class="ident" id="2042064">stateEndValue</span><span class="op" id="2042077">(</span><span class="ident" id="2042078">s</span><span class="op" id="2042079">,</span>&nbsp;<span class="ident" id="2042081">c</span><span class="op" id="2042082">)</span><br>
<span class="lineno"></span><span class="op" id="2042084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2042087">//&nbsp;stateDot&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;integer&nbsp;and&nbsp;decimal&nbsp;point&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno">430</span><span class="comment" id="2042169">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`1.`.</span><br>
<span class="lineno"></span><span class="keyword" id="2042200">func</span>&nbsp;<span class="ident" id="2042205">stateDot</span><span class="op" id="2042213">(</span><span class="ident" id="2042214">s</span>&nbsp;<span class="op" id="2042216">*</span><span class="ident" id="2042217">scanner</span><span class="op" id="2042224">,</span>&nbsp;<span class="ident" id="2042226">c</span>&nbsp;<span class="builtintype" id="2042228">int</span><span class="op" id="2042231">)</span>&nbsp;<span class="builtintype" id="2042233">int</span>&nbsp;<span class="op" id="2042237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2042240">if</span>&nbsp;<span class="string" id="2042243">&#39;0&#39;</span>&nbsp;<span class="op" id="2042247">&lt;=</span>&nbsp;<span class="ident" id="2042250">c</span>&nbsp;<span class="op" id="2042252">&amp;&amp;</span>&nbsp;<span class="ident" id="2042255">c</span>&nbsp;<span class="op" id="2042257">&lt;=</span>&nbsp;<span class="string" id="2042260">&#39;9&#39;</span>&nbsp;<span class="op" id="2042264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2042268">s</span><span class="op" id="2042269">.</span><span class="ident" id="2042270">step</span>&nbsp;<span class="op" id="2042275">=</span>&nbsp;<span class="ident" id="2042277">stateDot0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2042289">return</span>&nbsp;<span class="ident" id="2042296">scanContinue</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2042310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2042313">return</span>&nbsp;<span class="ident" id="2042320">s</span><span class="op" id="2042321">.</span><span class="builtintype" id="2042322">error</span><span class="op" id="2042327">(</span><span class="ident" id="2042328">c</span><span class="op" id="2042329">,</span>&nbsp;<span class="string" id="2042331">&#34;after&nbsp;decimal&nbsp;point&nbsp;in&nbsp;numeric&nbsp;literal&#34;</span><span class="op" id="2042371">)</span><br>
<span class="lineno"></span><span class="op" id="2042373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2042376">//&nbsp;stateDot0&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;integer,&nbsp;decimal&nbsp;point,&nbsp;and&nbsp;subsequent</span><br>
<span class="lineno">440</span><span class="comment" id="2042459">//&nbsp;digits&nbsp;of&nbsp;a&nbsp;number,&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`3.14`.</span><br>
<span class="lineno"></span><span class="keyword" id="2042512">func</span>&nbsp;<span class="ident" id="2042517">stateDot0</span><span class="op" id="2042526">(</span><span class="ident" id="2042527">s</span>&nbsp;<span class="op" id="2042529">*</span><span class="ident" id="2042530">scanner</span><span class="op" id="2042537">,</span>&nbsp;<span class="ident" id="2042539">c</span>&nbsp;<span class="builtintype" id="2042541">int</span><span class="op" id="2042544">)</span>&nbsp;<span class="builtintype" id="2042546">int</span>&nbsp;<span class="op" id="2042550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2042553">if</span>&nbsp;<span class="string" id="2042556">&#39;0&#39;</span>&nbsp;<span class="op" id="2042560">&lt;=</span>&nbsp;<span class="ident" id="2042563">c</span>&nbsp;<span class="op" id="2042565">&amp;&amp;</span>&nbsp;<span class="ident" id="2042568">c</span>&nbsp;<span class="op" id="2042570">&lt;=</span>&nbsp;<span class="string" id="2042573">&#39;9&#39;</span>&nbsp;<span class="op" id="2042577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2042581">s</span><span class="op" id="2042582">.</span><span class="ident" id="2042583">step</span>&nbsp;<span class="op" id="2042588">=</span>&nbsp;<span class="ident" id="2042590">stateDot0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2042602">return</span>&nbsp;<span class="ident" id="2042609">scanContinue</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2042623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2042626">if</span>&nbsp;<span class="ident" id="2042629">c</span>&nbsp;<span class="op" id="2042631">==</span>&nbsp;<span class="string" id="2042634">&#39;e&#39;</span>&nbsp;<span class="op" id="2042638">||</span>&nbsp;<span class="ident" id="2042641">c</span>&nbsp;<span class="op" id="2042643">==</span>&nbsp;<span class="string" id="2042646">&#39;E&#39;</span>&nbsp;<span class="op" id="2042650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2042654">s</span><span class="op" id="2042655">.</span><span class="ident" id="2042656">step</span>&nbsp;<span class="op" id="2042661">=</span>&nbsp;<span class="ident" id="2042663">stateE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2042672">return</span>&nbsp;<span class="ident" id="2042679">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2042693">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2042696">return</span>&nbsp;<span class="ident" id="2042703">stateEndValue</span><span class="op" id="2042716">(</span><span class="ident" id="2042717">s</span><span class="op" id="2042718">,</span>&nbsp;<span class="ident" id="2042720">c</span><span class="op" id="2042721">)</span><br>
<span class="lineno"></span><span class="op" id="2042723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2042726">//&nbsp;stateE&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;mantissa&nbsp;and&nbsp;e&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="2042795">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`314e`&nbsp;or&nbsp;`0.314e`.</span><br>
<span class="lineno">455</span><span class="keyword" id="2042840">func</span>&nbsp;<span class="ident" id="2042845">stateE</span><span class="op" id="2042851">(</span><span class="ident" id="2042852">s</span>&nbsp;<span class="op" id="2042854">*</span><span class="ident" id="2042855">scanner</span><span class="op" id="2042862">,</span>&nbsp;<span class="ident" id="2042864">c</span>&nbsp;<span class="builtintype" id="2042866">int</span><span class="op" id="2042869">)</span>&nbsp;<span class="builtintype" id="2042871">int</span>&nbsp;<span class="op" id="2042875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2042878">if</span>&nbsp;<span class="ident" id="2042881">c</span>&nbsp;<span class="op" id="2042883">==</span>&nbsp;<span class="string" id="2042886">&#39;+&#39;</span>&nbsp;<span class="op" id="2042890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2042894">s</span><span class="op" id="2042895">.</span><span class="ident" id="2042896">step</span>&nbsp;<span class="op" id="2042901">=</span>&nbsp;<span class="ident" id="2042903">stateESign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2042916">return</span>&nbsp;<span class="ident" id="2042923">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2042937">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2042940">if</span>&nbsp;<span class="ident" id="2042943">c</span>&nbsp;<span class="op" id="2042945">==</span>&nbsp;<span class="string" id="2042948">&#39;-&#39;</span>&nbsp;<span class="op" id="2042952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2042956">s</span><span class="op" id="2042957">.</span><span class="ident" id="2042958">step</span>&nbsp;<span class="op" id="2042963">=</span>&nbsp;<span class="ident" id="2042965">stateESign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2042978">return</span>&nbsp;<span class="ident" id="2042985">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2042999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2043002">return</span>&nbsp;<span class="ident" id="2043009">stateESign</span><span class="op" id="2043019">(</span><span class="ident" id="2043020">s</span><span class="op" id="2043021">,</span>&nbsp;<span class="ident" id="2043023">c</span><span class="op" id="2043024">)</span><br>
<span class="lineno">465</span><span class="op" id="2043026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2043029">//&nbsp;stateESign&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;mantissa,&nbsp;e,&nbsp;and&nbsp;sign&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="2043109">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`314e-`&nbsp;or&nbsp;`0.314e+`.</span><br>
<span class="lineno"></span><span class="keyword" id="2043156">func</span>&nbsp;<span class="ident" id="2043161">stateESign</span><span class="op" id="2043171">(</span><span class="ident" id="2043172">s</span>&nbsp;<span class="op" id="2043174">*</span><span class="ident" id="2043175">scanner</span><span class="op" id="2043182">,</span>&nbsp;<span class="ident" id="2043184">c</span>&nbsp;<span class="builtintype" id="2043186">int</span><span class="op" id="2043189">)</span>&nbsp;<span class="builtintype" id="2043191">int</span>&nbsp;<span class="op" id="2043195">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2043198">if</span>&nbsp;<span class="string" id="2043201">&#39;0&#39;</span>&nbsp;<span class="op" id="2043205">&lt;=</span>&nbsp;<span class="ident" id="2043208">c</span>&nbsp;<span class="op" id="2043210">&amp;&amp;</span>&nbsp;<span class="ident" id="2043213">c</span>&nbsp;<span class="op" id="2043215">&lt;=</span>&nbsp;<span class="string" id="2043218">&#39;9&#39;</span>&nbsp;<span class="op" id="2043222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2043226">s</span><span class="op" id="2043227">.</span><span class="ident" id="2043228">step</span>&nbsp;<span class="op" id="2043233">=</span>&nbsp;<span class="ident" id="2043235">stateE0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2043245">return</span>&nbsp;<span class="ident" id="2043252">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2043266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2043269">return</span>&nbsp;<span class="ident" id="2043276">s</span><span class="op" id="2043277">.</span><span class="builtintype" id="2043278">error</span><span class="op" id="2043283">(</span><span class="ident" id="2043284">c</span><span class="op" id="2043285">,</span>&nbsp;<span class="string" id="2043287">&#34;in&nbsp;exponent&nbsp;of&nbsp;numeric&nbsp;literal&#34;</span><span class="op" id="2043319">)</span><br>
<span class="lineno">475</span><span class="op" id="2043321">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2043324">//&nbsp;stateE0&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;the&nbsp;mantissa,&nbsp;e,&nbsp;optional&nbsp;sign,</span><br>
<span class="lineno"></span><span class="comment" id="2043394">//&nbsp;and&nbsp;at&nbsp;least&nbsp;one&nbsp;digit&nbsp;of&nbsp;the&nbsp;exponent&nbsp;in&nbsp;a&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="2043449">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`314e-2`&nbsp;or&nbsp;`0.314e+1`&nbsp;or&nbsp;`3.14e0`.</span><br>
<span class="lineno">480</span><span class="keyword" id="2043510">func</span>&nbsp;<span class="ident" id="2043515">stateE0</span><span class="op" id="2043522">(</span><span class="ident" id="2043523">s</span>&nbsp;<span class="op" id="2043525">*</span><span class="ident" id="2043526">scanner</span><span class="op" id="2043533">,</span>&nbsp;<span class="ident" id="2043535">c</span>&nbsp;<span class="builtintype" id="2043537">int</span><span class="op" id="2043540">)</span>&nbsp;<span class="builtintype" id="2043542">int</span>&nbsp;<span class="op" id="2043546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2043549">if</span>&nbsp;<span class="string" id="2043552">&#39;0&#39;</span>&nbsp;<span class="op" id="2043556">&lt;=</span>&nbsp;<span class="ident" id="2043559">c</span>&nbsp;<span class="op" id="2043561">&amp;&amp;</span>&nbsp;<span class="ident" id="2043564">c</span>&nbsp;<span class="op" id="2043566">&lt;=</span>&nbsp;<span class="string" id="2043569">&#39;9&#39;</span>&nbsp;<span class="op" id="2043573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2043577">s</span><span class="op" id="2043578">.</span><span class="ident" id="2043579">step</span>&nbsp;<span class="op" id="2043584">=</span>&nbsp;<span class="ident" id="2043586">stateE0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2043596">return</span>&nbsp;<span class="ident" id="2043603">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2043617">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2043620">return</span>&nbsp;<span class="ident" id="2043627">stateEndValue</span><span class="op" id="2043640">(</span><span class="ident" id="2043641">s</span><span class="op" id="2043642">,</span>&nbsp;<span class="ident" id="2043644">c</span><span class="op" id="2043645">)</span><br>
<span class="lineno"></span><span class="op" id="2043647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2043650">//&nbsp;stateT&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`t`.</span><br>
<span class="lineno"></span><span class="keyword" id="2043692">func</span>&nbsp;<span class="ident" id="2043697">stateT</span><span class="op" id="2043703">(</span><span class="ident" id="2043704">s</span>&nbsp;<span class="op" id="2043706">*</span><span class="ident" id="2043707">scanner</span><span class="op" id="2043714">,</span>&nbsp;<span class="ident" id="2043716">c</span>&nbsp;<span class="builtintype" id="2043718">int</span><span class="op" id="2043721">)</span>&nbsp;<span class="builtintype" id="2043723">int</span>&nbsp;<span class="op" id="2043727">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2043730">if</span>&nbsp;<span class="ident" id="2043733">c</span>&nbsp;<span class="op" id="2043735">==</span>&nbsp;<span class="string" id="2043738">&#39;r&#39;</span>&nbsp;<span class="op" id="2043742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2043746">s</span><span class="op" id="2043747">.</span><span class="ident" id="2043748">step</span>&nbsp;<span class="op" id="2043753">=</span>&nbsp;<span class="ident" id="2043755">stateTr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2043765">return</span>&nbsp;<span class="ident" id="2043772">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2043786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2043789">return</span>&nbsp;<span class="ident" id="2043796">s</span><span class="op" id="2043797">.</span><span class="builtintype" id="2043798">error</span><span class="op" id="2043803">(</span><span class="ident" id="2043804">c</span><span class="op" id="2043805">,</span>&nbsp;<span class="string" id="2043807">&#34;in&nbsp;literal&nbsp;true&nbsp;(expecting&nbsp;&#39;r&#39;)&#34;</span><span class="op" id="2043840">)</span><br>
<span class="lineno">495</span><span class="op" id="2043842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2043845">//&nbsp;stateTr&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`tr`.</span><br>
<span class="lineno"></span><span class="keyword" id="2043889">func</span>&nbsp;<span class="ident" id="2043894">stateTr</span><span class="op" id="2043901">(</span><span class="ident" id="2043902">s</span>&nbsp;<span class="op" id="2043904">*</span><span class="ident" id="2043905">scanner</span><span class="op" id="2043912">,</span>&nbsp;<span class="ident" id="2043914">c</span>&nbsp;<span class="builtintype" id="2043916">int</span><span class="op" id="2043919">)</span>&nbsp;<span class="builtintype" id="2043921">int</span>&nbsp;<span class="op" id="2043925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2043928">if</span>&nbsp;<span class="ident" id="2043931">c</span>&nbsp;<span class="op" id="2043933">==</span>&nbsp;<span class="string" id="2043936">&#39;u&#39;</span>&nbsp;<span class="op" id="2043940">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2043944">s</span><span class="op" id="2043945">.</span><span class="ident" id="2043946">step</span>&nbsp;<span class="op" id="2043951">=</span>&nbsp;<span class="ident" id="2043953">stateTru</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2043964">return</span>&nbsp;<span class="ident" id="2043971">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2043985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2043988">return</span>&nbsp;<span class="ident" id="2043995">s</span><span class="op" id="2043996">.</span><span class="builtintype" id="2043997">error</span><span class="op" id="2044002">(</span><span class="ident" id="2044003">c</span><span class="op" id="2044004">,</span>&nbsp;<span class="string" id="2044006">&#34;in&nbsp;literal&nbsp;true&nbsp;(expecting&nbsp;&#39;u&#39;)&#34;</span><span class="op" id="2044039">)</span><br>
<span class="lineno"></span><span class="op" id="2044041">}</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="comment" id="2044044">//&nbsp;stateTru&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`tru`.</span><br>
<span class="lineno"></span><span class="keyword" id="2044090">func</span>&nbsp;<span class="ident" id="2044095">stateTru</span><span class="op" id="2044103">(</span><span class="ident" id="2044104">s</span>&nbsp;<span class="op" id="2044106">*</span><span class="ident" id="2044107">scanner</span><span class="op" id="2044114">,</span>&nbsp;<span class="ident" id="2044116">c</span>&nbsp;<span class="builtintype" id="2044118">int</span><span class="op" id="2044121">)</span>&nbsp;<span class="builtintype" id="2044123">int</span>&nbsp;<span class="op" id="2044127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2044130">if</span>&nbsp;<span class="ident" id="2044133">c</span>&nbsp;<span class="op" id="2044135">==</span>&nbsp;<span class="string" id="2044138">&#39;e&#39;</span>&nbsp;<span class="op" id="2044142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2044146">s</span><span class="op" id="2044147">.</span><span class="ident" id="2044148">step</span>&nbsp;<span class="op" id="2044153">=</span>&nbsp;<span class="ident" id="2044155">stateEndValue</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2044171">return</span>&nbsp;<span class="ident" id="2044178">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2044192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2044195">return</span>&nbsp;<span class="ident" id="2044202">s</span><span class="op" id="2044203">.</span><span class="builtintype" id="2044204">error</span><span class="op" id="2044209">(</span><span class="ident" id="2044210">c</span><span class="op" id="2044211">,</span>&nbsp;<span class="string" id="2044213">&#34;in&nbsp;literal&nbsp;true&nbsp;(expecting&nbsp;&#39;e&#39;)&#34;</span><span class="op" id="2044246">)</span><br>
<span class="lineno"></span><span class="op" id="2044248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="comment" id="2044251">//&nbsp;stateF&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`f`.</span><br>
<span class="lineno"></span><span class="keyword" id="2044293">func</span>&nbsp;<span class="ident" id="2044298">stateF</span><span class="op" id="2044304">(</span><span class="ident" id="2044305">s</span>&nbsp;<span class="op" id="2044307">*</span><span class="ident" id="2044308">scanner</span><span class="op" id="2044315">,</span>&nbsp;<span class="ident" id="2044317">c</span>&nbsp;<span class="builtintype" id="2044319">int</span><span class="op" id="2044322">)</span>&nbsp;<span class="builtintype" id="2044324">int</span>&nbsp;<span class="op" id="2044328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2044331">if</span>&nbsp;<span class="ident" id="2044334">c</span>&nbsp;<span class="op" id="2044336">==</span>&nbsp;<span class="string" id="2044339">&#39;a&#39;</span>&nbsp;<span class="op" id="2044343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2044347">s</span><span class="op" id="2044348">.</span><span class="ident" id="2044349">step</span>&nbsp;<span class="op" id="2044354">=</span>&nbsp;<span class="ident" id="2044356">stateFa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2044366">return</span>&nbsp;<span class="ident" id="2044373">scanContinue</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2044387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2044390">return</span>&nbsp;<span class="ident" id="2044397">s</span><span class="op" id="2044398">.</span><span class="builtintype" id="2044399">error</span><span class="op" id="2044404">(</span><span class="ident" id="2044405">c</span><span class="op" id="2044406">,</span>&nbsp;<span class="string" id="2044408">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;a&#39;)&#34;</span><span class="op" id="2044442">)</span><br>
<span class="lineno"></span><span class="op" id="2044444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2044447">//&nbsp;stateFa&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`fa`.</span><br>
<span class="lineno">525</span><span class="keyword" id="2044491">func</span>&nbsp;<span class="ident" id="2044496">stateFa</span><span class="op" id="2044503">(</span><span class="ident" id="2044504">s</span>&nbsp;<span class="op" id="2044506">*</span><span class="ident" id="2044507">scanner</span><span class="op" id="2044514">,</span>&nbsp;<span class="ident" id="2044516">c</span>&nbsp;<span class="builtintype" id="2044518">int</span><span class="op" id="2044521">)</span>&nbsp;<span class="builtintype" id="2044523">int</span>&nbsp;<span class="op" id="2044527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2044530">if</span>&nbsp;<span class="ident" id="2044533">c</span>&nbsp;<span class="op" id="2044535">==</span>&nbsp;<span class="string" id="2044538">&#39;l&#39;</span>&nbsp;<span class="op" id="2044542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2044546">s</span><span class="op" id="2044547">.</span><span class="ident" id="2044548">step</span>&nbsp;<span class="op" id="2044553">=</span>&nbsp;<span class="ident" id="2044555">stateFal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2044566">return</span>&nbsp;<span class="ident" id="2044573">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2044587">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2044590">return</span>&nbsp;<span class="ident" id="2044597">s</span><span class="op" id="2044598">.</span><span class="builtintype" id="2044599">error</span><span class="op" id="2044604">(</span><span class="ident" id="2044605">c</span><span class="op" id="2044606">,</span>&nbsp;<span class="string" id="2044608">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;l&#39;)&#34;</span><span class="op" id="2044642">)</span><br>
<span class="lineno"></span><span class="op" id="2044644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2044647">//&nbsp;stateFal&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`fal`.</span><br>
<span class="lineno"></span><span class="keyword" id="2044693">func</span>&nbsp;<span class="ident" id="2044698">stateFal</span><span class="op" id="2044706">(</span><span class="ident" id="2044707">s</span>&nbsp;<span class="op" id="2044709">*</span><span class="ident" id="2044710">scanner</span><span class="op" id="2044717">,</span>&nbsp;<span class="ident" id="2044719">c</span>&nbsp;<span class="builtintype" id="2044721">int</span><span class="op" id="2044724">)</span>&nbsp;<span class="builtintype" id="2044726">int</span>&nbsp;<span class="op" id="2044730">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2044733">if</span>&nbsp;<span class="ident" id="2044736">c</span>&nbsp;<span class="op" id="2044738">==</span>&nbsp;<span class="string" id="2044741">&#39;s&#39;</span>&nbsp;<span class="op" id="2044745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2044749">s</span><span class="op" id="2044750">.</span><span class="ident" id="2044751">step</span>&nbsp;<span class="op" id="2044756">=</span>&nbsp;<span class="ident" id="2044758">stateFals</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2044770">return</span>&nbsp;<span class="ident" id="2044777">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2044791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2044794">return</span>&nbsp;<span class="ident" id="2044801">s</span><span class="op" id="2044802">.</span><span class="builtintype" id="2044803">error</span><span class="op" id="2044808">(</span><span class="ident" id="2044809">c</span><span class="op" id="2044810">,</span>&nbsp;<span class="string" id="2044812">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;s&#39;)&#34;</span><span class="op" id="2044846">)</span><br>
<span class="lineno">540</span><span class="op" id="2044848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2044851">//&nbsp;stateFals&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`fals`.</span><br>
<span class="lineno"></span><span class="keyword" id="2044899">func</span>&nbsp;<span class="ident" id="2044904">stateFals</span><span class="op" id="2044913">(</span><span class="ident" id="2044914">s</span>&nbsp;<span class="op" id="2044916">*</span><span class="ident" id="2044917">scanner</span><span class="op" id="2044924">,</span>&nbsp;<span class="ident" id="2044926">c</span>&nbsp;<span class="builtintype" id="2044928">int</span><span class="op" id="2044931">)</span>&nbsp;<span class="builtintype" id="2044933">int</span>&nbsp;<span class="op" id="2044937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2044940">if</span>&nbsp;<span class="ident" id="2044943">c</span>&nbsp;<span class="op" id="2044945">==</span>&nbsp;<span class="string" id="2044948">&#39;e&#39;</span>&nbsp;<span class="op" id="2044952">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2044956">s</span><span class="op" id="2044957">.</span><span class="ident" id="2044958">step</span>&nbsp;<span class="op" id="2044963">=</span>&nbsp;<span class="ident" id="2044965">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2044981">return</span>&nbsp;<span class="ident" id="2044988">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2045002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2045005">return</span>&nbsp;<span class="ident" id="2045012">s</span><span class="op" id="2045013">.</span><span class="builtintype" id="2045014">error</span><span class="op" id="2045019">(</span><span class="ident" id="2045020">c</span><span class="op" id="2045021">,</span>&nbsp;<span class="string" id="2045023">&#34;in&nbsp;literal&nbsp;false&nbsp;(expecting&nbsp;&#39;e&#39;)&#34;</span><span class="op" id="2045057">)</span><br>
<span class="lineno"></span><span class="op" id="2045059">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span><span class="comment" id="2045062">//&nbsp;stateN&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`n`.</span><br>
<span class="lineno"></span><span class="keyword" id="2045104">func</span>&nbsp;<span class="ident" id="2045109">stateN</span><span class="op" id="2045115">(</span><span class="ident" id="2045116">s</span>&nbsp;<span class="op" id="2045118">*</span><span class="ident" id="2045119">scanner</span><span class="op" id="2045126">,</span>&nbsp;<span class="ident" id="2045128">c</span>&nbsp;<span class="builtintype" id="2045130">int</span><span class="op" id="2045133">)</span>&nbsp;<span class="builtintype" id="2045135">int</span>&nbsp;<span class="op" id="2045139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2045142">if</span>&nbsp;<span class="ident" id="2045145">c</span>&nbsp;<span class="op" id="2045147">==</span>&nbsp;<span class="string" id="2045150">&#39;u&#39;</span>&nbsp;<span class="op" id="2045154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2045158">s</span><span class="op" id="2045159">.</span><span class="ident" id="2045160">step</span>&nbsp;<span class="op" id="2045165">=</span>&nbsp;<span class="ident" id="2045167">stateNu</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2045177">return</span>&nbsp;<span class="ident" id="2045184">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2045198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2045201">return</span>&nbsp;<span class="ident" id="2045208">s</span><span class="op" id="2045209">.</span><span class="builtintype" id="2045210">error</span><span class="op" id="2045215">(</span><span class="ident" id="2045216">c</span><span class="op" id="2045217">,</span>&nbsp;<span class="string" id="2045219">&#34;in&nbsp;literal&nbsp;null&nbsp;(expecting&nbsp;&#39;u&#39;)&#34;</span><span class="op" id="2045252">)</span><br>
<span class="lineno"></span><span class="op" id="2045254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span><span class="comment" id="2045257">//&nbsp;stateNu&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`nu`.</span><br>
<span class="lineno"></span><span class="keyword" id="2045301">func</span>&nbsp;<span class="ident" id="2045306">stateNu</span><span class="op" id="2045313">(</span><span class="ident" id="2045314">s</span>&nbsp;<span class="op" id="2045316">*</span><span class="ident" id="2045317">scanner</span><span class="op" id="2045324">,</span>&nbsp;<span class="ident" id="2045326">c</span>&nbsp;<span class="builtintype" id="2045328">int</span><span class="op" id="2045331">)</span>&nbsp;<span class="builtintype" id="2045333">int</span>&nbsp;<span class="op" id="2045337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2045340">if</span>&nbsp;<span class="ident" id="2045343">c</span>&nbsp;<span class="op" id="2045345">==</span>&nbsp;<span class="string" id="2045348">&#39;l&#39;</span>&nbsp;<span class="op" id="2045352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2045356">s</span><span class="op" id="2045357">.</span><span class="ident" id="2045358">step</span>&nbsp;<span class="op" id="2045363">=</span>&nbsp;<span class="ident" id="2045365">stateNul</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2045376">return</span>&nbsp;<span class="ident" id="2045383">scanContinue</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2045397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2045400">return</span>&nbsp;<span class="ident" id="2045407">s</span><span class="op" id="2045408">.</span><span class="builtintype" id="2045409">error</span><span class="op" id="2045414">(</span><span class="ident" id="2045415">c</span><span class="op" id="2045416">,</span>&nbsp;<span class="string" id="2045418">&#34;in&nbsp;literal&nbsp;null&nbsp;(expecting&nbsp;&#39;l&#39;)&#34;</span><span class="op" id="2045451">)</span><br>
<span class="lineno"></span><span class="op" id="2045453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2045456">//&nbsp;stateNul&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reading&nbsp;`nul`.</span><br>
<span class="lineno">570</span><span class="keyword" id="2045502">func</span>&nbsp;<span class="ident" id="2045507">stateNul</span><span class="op" id="2045515">(</span><span class="ident" id="2045516">s</span>&nbsp;<span class="op" id="2045518">*</span><span class="ident" id="2045519">scanner</span><span class="op" id="2045526">,</span>&nbsp;<span class="ident" id="2045528">c</span>&nbsp;<span class="builtintype" id="2045530">int</span><span class="op" id="2045533">)</span>&nbsp;<span class="builtintype" id="2045535">int</span>&nbsp;<span class="op" id="2045539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2045542">if</span>&nbsp;<span class="ident" id="2045545">c</span>&nbsp;<span class="op" id="2045547">==</span>&nbsp;<span class="string" id="2045550">&#39;l&#39;</span>&nbsp;<span class="op" id="2045554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2045558">s</span><span class="op" id="2045559">.</span><span class="ident" id="2045560">step</span>&nbsp;<span class="op" id="2045565">=</span>&nbsp;<span class="ident" id="2045567">stateEndValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2045583">return</span>&nbsp;<span class="ident" id="2045590">scanContinue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2045604">}</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2045607">return</span>&nbsp;<span class="ident" id="2045614">s</span><span class="op" id="2045615">.</span><span class="builtintype" id="2045616">error</span><span class="op" id="2045621">(</span><span class="ident" id="2045622">c</span><span class="op" id="2045623">,</span>&nbsp;<span class="string" id="2045625">&#34;in&nbsp;literal&nbsp;null&nbsp;(expecting&nbsp;&#39;l&#39;)&#34;</span><span class="op" id="2045658">)</span><br>
<span class="lineno"></span><span class="op" id="2045660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2045663">//&nbsp;stateError&nbsp;is&nbsp;the&nbsp;state&nbsp;after&nbsp;reaching&nbsp;a&nbsp;syntax&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="2045721">//&nbsp;such&nbsp;as&nbsp;after&nbsp;reading&nbsp;`[1}`&nbsp;or&nbsp;`5.1.2`.</span><br>
<span class="lineno">580</span><span class="keyword" id="2045764">func</span>&nbsp;<span class="ident" id="2045769">stateError</span><span class="op" id="2045779">(</span><span class="ident" id="2045780">s</span>&nbsp;<span class="op" id="2045782">*</span><span class="ident" id="2045783">scanner</span><span class="op" id="2045790">,</span>&nbsp;<span class="ident" id="2045792">c</span>&nbsp;<span class="builtintype" id="2045794">int</span><span class="op" id="2045797">)</span>&nbsp;<span class="builtintype" id="2045799">int</span>&nbsp;<span class="op" id="2045803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2045806">return</span>&nbsp;<span class="ident" id="2045813">scanError</span><br>
<span class="lineno"></span><span class="op" id="2045823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2045826">//&nbsp;error&nbsp;records&nbsp;an&nbsp;error&nbsp;and&nbsp;switches&nbsp;to&nbsp;the&nbsp;error&nbsp;state.</span><br>
<span class="lineno">585</span><span class="keyword" id="2045885">func</span>&nbsp;<span class="op" id="2045890">(</span><span class="ident" id="2045891">s</span>&nbsp;<span class="op" id="2045893">*</span><span class="ident" id="2045894">scanner</span><span class="op" id="2045901">)</span>&nbsp;<span class="builtintype" id="2045903">error</span><span class="op" id="2045908">(</span><span class="ident" id="2045909">c</span>&nbsp;<span class="builtintype" id="2045911">int</span><span class="op" id="2045914">,</span>&nbsp;<span class="ident" id="2045916">context</span>&nbsp;<span class="builtintype" id="2045924">string</span><span class="op" id="2045930">)</span>&nbsp;<span class="builtintype" id="2045932">int</span>&nbsp;<span class="op" id="2045936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2045939">s</span><span class="op" id="2045940">.</span><span class="ident" id="2045941">step</span>&nbsp;<span class="op" id="2045946">=</span>&nbsp;<span class="ident" id="2045948">stateError</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2045960">s</span><span class="op" id="2045961">.</span><span class="ident" id="2045962">err</span>&nbsp;<span class="op" id="2045966">=</span>&nbsp;<span class="op" id="2045968">&amp;</span><span class="ident" id="2045969">SyntaxError</span><span class="op" id="2045980">{</span><span class="string" id="2045981">&#34;invalid&nbsp;character&nbsp;&#34;</span>&nbsp;<span class="op" id="2046002">+</span>&nbsp;<span class="ident" id="2046004">quoteChar</span><span class="op" id="2046013">(</span><span class="ident" id="2046014">c</span><span class="op" id="2046015">)</span>&nbsp;<span class="op" id="2046017">+</span>&nbsp;<span class="string" id="2046019">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="2046023">+</span>&nbsp;<span class="ident" id="2046025">context</span><span class="op" id="2046032">,</span>&nbsp;<span class="ident" id="2046034">s</span><span class="op" id="2046035">.</span><span class="ident" id="2046036">bytes</span><span class="op" id="2046041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2046044">return</span>&nbsp;<span class="ident" id="2046051">scanError</span><br>
<span class="lineno"></span><span class="op" id="2046061">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="2046064">//&nbsp;quoteChar&nbsp;formats&nbsp;c&nbsp;as&nbsp;a&nbsp;quoted&nbsp;character&nbsp;literal</span><br>
<span class="lineno"></span><span class="keyword" id="2046117">func</span>&nbsp;<span class="ident" id="2046122">quoteChar</span><span class="op" id="2046131">(</span><span class="ident" id="2046132">c</span>&nbsp;<span class="builtintype" id="2046134">int</span><span class="op" id="2046137">)</span>&nbsp;<span class="builtintype" id="2046139">string</span>&nbsp;<span class="op" id="2046146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2046149">//&nbsp;special&nbsp;cases&nbsp;-&nbsp;different&nbsp;from&nbsp;quoted&nbsp;strings</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2046199">if</span>&nbsp;<span class="ident" id="2046202">c</span>&nbsp;<span class="op" id="2046204">==</span>&nbsp;<span class="string" id="2046207">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="2046212">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2046216">return</span>&nbsp;<span class="string" id="2046223">`&#39;\&#39;&#39;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2046231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2046234">if</span>&nbsp;<span class="ident" id="2046237">c</span>&nbsp;<span class="op" id="2046239">==</span>&nbsp;<span class="string" id="2046242">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2046246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2046250">return</span>&nbsp;<span class="string" id="2046257">`&#39;&#34;&#39;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2046264">}</span><br>
<span class="lineno">600</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2046268">//&nbsp;use&nbsp;quoted&nbsp;string&nbsp;with&nbsp;different&nbsp;quotation&nbsp;marks</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2046321">s</span>&nbsp;<span class="op" id="2046323">:=</span>&nbsp;<span class="ident" id="2046326">strconv</span><span class="op" id="2046333">.</span><span class="ident" id="2046334">Quote</span><span class="op" id="2046339">(</span><span class="builtintype" id="2046340">string</span><span class="op" id="2046346">(</span><span class="ident" id="2046347">c</span><span class="op" id="2046348">)</span><span class="op" id="2046349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2046352">return</span>&nbsp;<span class="string" id="2046359">&#34;&#39;&#34;</span>&nbsp;<span class="op" id="2046363">+</span>&nbsp;<span class="ident" id="2046365">s</span><span class="op" id="2046366">[</span><span class="num" id="2046367">1</span><span class="op" id="2046368">:</span><span class="builtinfunc" id="2046369">len</span><span class="op" id="2046372">(</span><span class="ident" id="2046373">s</span><span class="op" id="2046374">)</span><span class="op" id="2046375">-</span><span class="num" id="2046376">1</span><span class="op" id="2046377">]</span>&nbsp;<span class="op" id="2046379">+</span>&nbsp;<span class="string" id="2046381">&#34;&#39;&#34;</span><br>
<span class="lineno"></span><span class="op" id="2046385">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span><span class="comment" id="2046388">//&nbsp;undo&nbsp;causes&nbsp;the&nbsp;scanner&nbsp;to&nbsp;return&nbsp;scanCode&nbsp;from&nbsp;the&nbsp;next&nbsp;state&nbsp;transition.</span><br>
<span class="lineno"></span><span class="comment" id="2046466">//&nbsp;This&nbsp;gives&nbsp;callers&nbsp;a&nbsp;simple&nbsp;1-byte&nbsp;undo&nbsp;mechanism.</span><br>
<span class="lineno"></span><span class="keyword" id="2046520">func</span>&nbsp;<span class="op" id="2046525">(</span><span class="ident" id="2046526">s</span>&nbsp;<span class="op" id="2046528">*</span><span class="ident" id="2046529">scanner</span><span class="op" id="2046536">)</span>&nbsp;<span class="ident" id="2046538">undo</span><span class="op" id="2046542">(</span><span class="ident" id="2046543">scanCode</span>&nbsp;<span class="builtintype" id="2046552">int</span><span class="op" id="2046555">)</span>&nbsp;<span class="op" id="2046557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2046560">if</span>&nbsp;<span class="ident" id="2046563">s</span><span class="op" id="2046564">.</span><span class="ident" id="2046565">redo</span>&nbsp;<span class="op" id="2046570">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2046574">panic</span><span class="op" id="2046579">(</span><span class="string" id="2046580">&#34;json:&nbsp;invalid&nbsp;use&nbsp;of&nbsp;scanner&#34;</span><span class="op" id="2046610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2046613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2046616">s</span><span class="op" id="2046617">.</span><span class="ident" id="2046618">redoCode</span>&nbsp;<span class="op" id="2046627">=</span>&nbsp;<span class="ident" id="2046629">scanCode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2046639">s</span><span class="op" id="2046640">.</span><span class="ident" id="2046641">redoState</span>&nbsp;<span class="op" id="2046651">=</span>&nbsp;<span class="ident" id="2046653">s</span><span class="op" id="2046654">.</span><span class="ident" id="2046655">step</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2046661">s</span><span class="op" id="2046662">.</span><span class="ident" id="2046663">step</span>&nbsp;<span class="op" id="2046668">=</span>&nbsp;<span class="ident" id="2046670">stateRedo</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2046681">s</span><span class="op" id="2046682">.</span><span class="ident" id="2046683">redo</span>&nbsp;<span class="op" id="2046688">=</span>&nbsp;<span class="builtintype" id="2046690">true</span><br>
<span class="lineno"></span><span class="op" id="2046695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2046698">//&nbsp;stateRedo&nbsp;helps&nbsp;implement&nbsp;the&nbsp;scanner&#39;s&nbsp;1-byte&nbsp;undo.</span><br>
<span class="lineno"></span><span class="keyword" id="2046754">func</span>&nbsp;<span class="ident" id="2046759">stateRedo</span><span class="op" id="2046768">(</span><span class="ident" id="2046769">s</span>&nbsp;<span class="op" id="2046771">*</span><span class="ident" id="2046772">scanner</span><span class="op" id="2046779">,</span>&nbsp;<span class="ident" id="2046781">c</span>&nbsp;<span class="builtintype" id="2046783">int</span><span class="op" id="2046786">)</span>&nbsp;<span class="builtintype" id="2046788">int</span>&nbsp;<span class="op" id="2046792">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2046795">s</span><span class="op" id="2046796">.</span><span class="ident" id="2046797">redo</span>&nbsp;<span class="op" id="2046802">=</span>&nbsp;<span class="builtintype" id="2046804">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2046811">s</span><span class="op" id="2046812">.</span><span class="ident" id="2046813">step</span>&nbsp;<span class="op" id="2046818">=</span>&nbsp;<span class="ident" id="2046820">s</span><span class="op" id="2046821">.</span><span class="ident" id="2046822">redoState</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2046833">return</span>&nbsp;<span class="ident" id="2046840">s</span><span class="op" id="2046841">.</span><span class="ident" id="2046842">redoCode</span><br>
<span class="lineno"></span><span class="op" id="2046851">}</span>
</div>
</body>
</html>
