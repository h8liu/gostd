<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>archive/zip</h2>
<ul>
<li><a href="/gostd/archive/zip/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/archive/zip/reader.go.html" class="current">reader.go</a></li>
<li><a href="/gostd/archive/zip/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/archive/zip/register.go.html">register.go</a></li>
<li><a href="/gostd/archive/zip/struct.go.html">struct.go</a></li>
<li><a href="/gostd/archive/zip/writer.go.html">writer.go</a></li>
<li><a href="/gostd/archive/zip/writer_test.go.html">writer_test.go</a></li>
<li><a href="/gostd/archive/zip/zip_test.go.html">zip_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5653044">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5653099">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5653153">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5653204">package</span>&nbsp;<span class="ident" id="5653212">zip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5653217">import</span>&nbsp;<span class="op" id="5653224">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5653227">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5653236">&#34;encoding/binary&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5653255">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5653265">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5653273">&#34;hash/crc32&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5653287">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5653293">&#34;os&#34;</span><br>
<span class="lineno">15</span><span class="op" id="5653298">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5653301">var</span>&nbsp;<span class="op" id="5653305">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5653308">ErrFormat</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5653321">=</span>&nbsp;<span class="ident" id="5653323"><a href="/gostd/archive/zip/reader.go.html#5653255">errors</a></span><span class="op" id="5653329">.</span><span class="ident" id="5653330"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="5653333">(</span><span class="string" id="5653334">&#34;zip:&nbsp;not&nbsp;a&nbsp;valid&nbsp;zip&nbsp;file&#34;</span><span class="op" id="5653361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5653364">ErrAlgorithm</span>&nbsp;<span class="op" id="5653377">=</span>&nbsp;<span class="ident" id="5653379"><a href="/gostd/archive/zip/reader.go.html#5653255">errors</a></span><span class="op" id="5653385">.</span><span class="ident" id="5653386"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="5653389">(</span><span class="string" id="5653390">&#34;zip:&nbsp;unsupported&nbsp;compression&nbsp;algorithm&#34;</span><span class="op" id="5653430">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5653433">ErrChecksum</span>&nbsp;&nbsp;<span class="op" id="5653446">=</span>&nbsp;<span class="ident" id="5653448"><a href="/gostd/archive/zip/reader.go.html#5653255">errors</a></span><span class="op" id="5653454">.</span><span class="ident" id="5653455"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="5653458">(</span><span class="string" id="5653459">&#34;zip:&nbsp;checksum&nbsp;error&#34;</span><span class="op" id="5653480">)</span><br>
<span class="lineno"></span><span class="op" id="5653482">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5653485">type</span>&nbsp;<span class="ident" id="5653490">Reader</span>&nbsp;<span class="keyword" id="5653497">struct</span>&nbsp;<span class="op" id="5653504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5653507">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5653515"><a href="/gostd/archive/zip/reader.go.html#5653287">io</a></span><span class="op" id="5653517">.</span><span class="ident" id="5653518"><a href="/gostd/io/io.go.html#1425985">ReaderAt</a></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5653528">File</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5653536">[</span><span class="op" id="5653537">]</span><span class="op" id="5653538">*</span><span class="ident" id="5653539"><a href="/gostd/archive/zip/reader.go.html#5653616">File</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5653545">Comment</span>&nbsp;<span class="builtintype" id="5653553">string</span><br>
<span class="lineno"></span><span class="op" id="5653560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5653563">type</span>&nbsp;<span class="ident" id="5653568">ReadCloser</span>&nbsp;<span class="keyword" id="5653579">struct</span>&nbsp;<span class="op" id="5653586">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5653589">f</span>&nbsp;<span class="op" id="5653591">*</span><span class="ident" id="5653592"><a href="/gostd/archive/zip/reader.go.html#5653293">os</a></span><span class="op" id="5653594">.</span><span class="ident" id="5653595"><a href="/gostd/os/file_unix.go.html#2452288">File</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5653601"><a href="/gostd/archive/zip/reader.go.html#5653490">Reader</a></span><br>
<span class="lineno"></span><span class="op" id="5653608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5653611">type</span>&nbsp;<span class="ident" id="5653616">File</span>&nbsp;<span class="keyword" id="5653621">struct</span>&nbsp;<span class="op" id="5653628">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5653631"><a href="/gostd/archive/zip/struct.go.html#5670169">FileHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5653643">zipr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5653656"><a href="/gostd/archive/zip/reader.go.html#5653287">io</a></span><span class="op" id="5653658">.</span><span class="ident" id="5653659"><a href="/gostd/io/io.go.html#1425985">ReaderAt</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5653669">zipsize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5653682">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5653689">headerOffset</span>&nbsp;<span class="builtintype" id="5653702">int64</span><br>
<span class="lineno"></span><span class="op" id="5653708">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="5653711">func</span>&nbsp;<span class="op" id="5653716">(</span><span class="ident" id="5653717">f</span>&nbsp;<span class="op" id="5653719">*</span><span class="ident" id="5653720"><a href="/gostd/archive/zip/reader.go.html#5653616">File</a></span><span class="op" id="5653724">)</span>&nbsp;<span class="ident" id="5653726">hasDataDescriptor</span><span class="op" id="5653743">(</span><span class="op" id="5653744">)</span>&nbsp;<span class="builtintype" id="5653746">bool</span>&nbsp;<span class="op" id="5653751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5653754">return</span>&nbsp;<span class="ident" id="5653761"><a href="/gostd/archive/zip/reader.go.html#5653717">f</a></span><span class="op" id="5653762">.</span><span class="ident" id="5653763"><a href="/gostd/archive/zip/struct.go.html#5670436">Flags</a></span><span class="op" id="5653768">&amp;</span><span class="num" id="5653769">0x8</span>&nbsp;<span class="op" id="5653773">!=</span>&nbsp;<span class="num" id="5653776">0</span><br>
<span class="lineno"></span><span class="op" id="5653778">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="5653781">//&nbsp;OpenReader&nbsp;will&nbsp;open&nbsp;the&nbsp;Zip&nbsp;file&nbsp;specified&nbsp;by&nbsp;name&nbsp;and&nbsp;return&nbsp;a&nbsp;ReadCloser.</span><br>
<span class="lineno"></span><span class="keyword" id="5653861">func</span>&nbsp;<span class="ident" id="5653866">OpenReader</span><span class="op" id="5653876">(</span><span class="ident" id="5653877">name</span>&nbsp;<span class="builtintype" id="5653882">string</span><span class="op" id="5653888">)</span>&nbsp;<span class="op" id="5653890">(</span><span class="op" id="5653891">*</span><span class="ident" id="5653892"><a href="/gostd/archive/zip/reader.go.html#5653568">ReadCloser</a></span><span class="op" id="5653902">,</span>&nbsp;<span class="builtintype" id="5653904">error</span><span class="op" id="5653909">)</span>&nbsp;<span class="op" id="5653911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5653914">f</span><span class="op" id="5653915">,</span>&nbsp;<span class="ident" id="5653917">err</span>&nbsp;<span class="op" id="5653921">:=</span>&nbsp;<span class="ident" id="5653924"><a href="/gostd/archive/zip/reader.go.html#5653293">os</a></span><span class="op" id="5653926">.</span><span class="ident" id="5653927"><a href="/gostd/os/file.go.html#2446863">Open</a></span><span class="op" id="5653931">(</span><span class="ident" id="5653932"><a href="/gostd/archive/zip/reader.go.html#5653877">name</a></span><span class="op" id="5653936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5653939">if</span>&nbsp;<span class="ident" id="5653942"><a href="/gostd/archive/zip/reader.go.html#5653917">err</a></span>&nbsp;<span class="op" id="5653946">!=</span>&nbsp;<span class="builtintype" id="5653949">nil</span>&nbsp;<span class="op" id="5653953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5653957">return</span>&nbsp;<span class="builtintype" id="5653964">nil</span><span class="op" id="5653967">,</span>&nbsp;<span class="ident" id="5653969"><a href="/gostd/archive/zip/reader.go.html#5653917">err</a></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5653974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5653977">fi</span><span class="op" id="5653979">,</span>&nbsp;<span class="ident" id="5653981"><a href="/gostd/archive/zip/reader.go.html#5653917">err</a></span>&nbsp;<span class="op" id="5653985">:=</span>&nbsp;<span class="ident" id="5653988"><a href="/gostd/archive/zip/reader.go.html#5653914">f</a></span><span class="op" id="5653989">.</span><span class="ident" id="5653990"><a href="/gostd/os/file_unix.go.html#2455146">Stat</a></span><span class="op" id="5653994">(</span><span class="op" id="5653995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5653998">if</span>&nbsp;<span class="ident" id="5654001"><a href="/gostd/archive/zip/reader.go.html#5653917">err</a></span>&nbsp;<span class="op" id="5654005">!=</span>&nbsp;<span class="builtintype" id="5654008">nil</span>&nbsp;<span class="op" id="5654012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5654016"><a href="/gostd/archive/zip/reader.go.html#5653914">f</a></span><span class="op" id="5654017">.</span><span class="ident" id="5654018"><a href="/gostd/os/file_unix.go.html#2454611">Close</a></span><span class="op" id="5654023">(</span><span class="op" id="5654024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5654028">return</span>&nbsp;<span class="builtintype" id="5654035">nil</span><span class="op" id="5654038">,</span>&nbsp;<span class="ident" id="5654040"><a href="/gostd/archive/zip/reader.go.html#5653917">err</a></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5654045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5654048">r</span>&nbsp;<span class="op" id="5654050">:=</span>&nbsp;<span class="builtinfunc" id="5654053">new</span><span class="op" id="5654056">(</span><span class="ident" id="5654057"><a href="/gostd/archive/zip/reader.go.html#5653568">ReadCloser</a></span><span class="op" id="5654067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5654070">if</span>&nbsp;<span class="ident" id="5654073">err</span>&nbsp;<span class="op" id="5654077">:=</span>&nbsp;<span class="ident" id="5654080"><a href="/gostd/archive/zip/reader.go.html#5654048">r</a></span><span class="op" id="5654081">.</span><span class="ident" id="5654082"><a href="/gostd/archive/zip/reader.go.html#5654457">init</a></span><span class="op" id="5654086">(</span><span class="ident" id="5654087"><a href="/gostd/archive/zip/reader.go.html#5653914">f</a></span><span class="op" id="5654088">,</span>&nbsp;<span class="ident" id="5654090"><a href="/gostd/archive/zip/reader.go.html#5653977">fi</a></span><span class="op" id="5654092">.</span><span class="ident" id="5654093"><a href="/gostd/os/types.go.html#2472528">Size</a></span><span class="op" id="5654097">(</span><span class="op" id="5654098">)</span><span class="op" id="5654099">)</span><span class="op" id="5654100">;</span>&nbsp;<span class="ident" id="5654102"><a href="/gostd/archive/zip/reader.go.html#5654073">err</a></span>&nbsp;<span class="op" id="5654106">!=</span>&nbsp;<span class="builtintype" id="5654109">nil</span>&nbsp;<span class="op" id="5654113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5654117"><a href="/gostd/archive/zip/reader.go.html#5653914">f</a></span><span class="op" id="5654118">.</span><span class="ident" id="5654119"><a href="/gostd/os/file_unix.go.html#2454611">Close</a></span><span class="op" id="5654124">(</span><span class="op" id="5654125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5654129">return</span>&nbsp;<span class="builtintype" id="5654136">nil</span><span class="op" id="5654139">,</span>&nbsp;<span class="ident" id="5654141"><a href="/gostd/archive/zip/reader.go.html#5654073">err</a></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5654146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5654149"><a href="/gostd/archive/zip/reader.go.html#5654048">r</a></span><span class="op" id="5654150">.</span><span class="ident" id="5654151"><a href="/gostd/archive/zip/reader.go.html#5653589">f</a></span>&nbsp;<span class="op" id="5654153">=</span>&nbsp;<span class="ident" id="5654155"><a href="/gostd/archive/zip/reader.go.html#5653914">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5654158">return</span>&nbsp;<span class="ident" id="5654165"><a href="/gostd/archive/zip/reader.go.html#5654048">r</a></span><span class="op" id="5654166">,</span>&nbsp;<span class="builtintype" id="5654168">nil</span><br>
<span class="lineno"></span><span class="op" id="5654172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="comment" id="5654175">//&nbsp;NewReader&nbsp;returns&nbsp;a&nbsp;new&nbsp;Reader&nbsp;reading&nbsp;from&nbsp;r,&nbsp;which&nbsp;is&nbsp;assumed&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5654245">//&nbsp;have&nbsp;the&nbsp;given&nbsp;size&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="5654278">func</span>&nbsp;<span class="ident" id="5654283">NewReader</span><span class="op" id="5654292">(</span><span class="ident" id="5654293">r</span>&nbsp;<span class="ident" id="5654295"><a href="/gostd/archive/zip/reader.go.html#5653287">io</a></span><span class="op" id="5654297">.</span><span class="ident" id="5654298"><a href="/gostd/io/io.go.html#1425985">ReaderAt</a></span><span class="op" id="5654306">,</span>&nbsp;<span class="ident" id="5654308">size</span>&nbsp;<span class="builtintype" id="5654313">int64</span><span class="op" id="5654318">)</span>&nbsp;<span class="op" id="5654320">(</span><span class="op" id="5654321">*</span><span class="ident" id="5654322"><a href="/gostd/archive/zip/reader.go.html#5653490">Reader</a></span><span class="op" id="5654328">,</span>&nbsp;<span class="builtintype" id="5654330">error</span><span class="op" id="5654335">)</span>&nbsp;<span class="op" id="5654337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5654340">zr</span>&nbsp;<span class="op" id="5654343">:=</span>&nbsp;<span class="builtinfunc" id="5654346">new</span><span class="op" id="5654349">(</span><span class="ident" id="5654350"><a href="/gostd/archive/zip/reader.go.html#5653490">Reader</a></span><span class="op" id="5654356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5654359">if</span>&nbsp;<span class="ident" id="5654362">err</span>&nbsp;<span class="op" id="5654366">:=</span>&nbsp;<span class="ident" id="5654369"><a href="/gostd/archive/zip/reader.go.html#5654340">zr</a></span><span class="op" id="5654371">.</span><span class="ident" id="5654372"><a href="/gostd/archive/zip/reader.go.html#5654457">init</a></span><span class="op" id="5654376">(</span><span class="ident" id="5654377"><a href="/gostd/archive/zip/reader.go.html#5654293">r</a></span><span class="op" id="5654378">,</span>&nbsp;<span class="ident" id="5654380"><a href="/gostd/archive/zip/reader.go.html#5654308">size</a></span><span class="op" id="5654384">)</span><span class="op" id="5654385">;</span>&nbsp;<span class="ident" id="5654387"><a href="/gostd/archive/zip/reader.go.html#5654362">err</a></span>&nbsp;<span class="op" id="5654391">!=</span>&nbsp;<span class="builtintype" id="5654394">nil</span>&nbsp;<span class="op" id="5654398">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5654402">return</span>&nbsp;<span class="builtintype" id="5654409">nil</span><span class="op" id="5654412">,</span>&nbsp;<span class="ident" id="5654414"><a href="/gostd/archive/zip/reader.go.html#5654362">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5654419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5654422">return</span>&nbsp;<span class="ident" id="5654429"><a href="/gostd/archive/zip/reader.go.html#5654340">zr</a></span><span class="op" id="5654431">,</span>&nbsp;<span class="builtintype" id="5654433">nil</span><br>
<span class="lineno"></span><span class="op" id="5654437">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="5654440">func</span>&nbsp;<span class="op" id="5654445">(</span><span class="ident" id="5654446">z</span>&nbsp;<span class="op" id="5654448">*</span><span class="ident" id="5654449"><a href="/gostd/archive/zip/reader.go.html#5653490">Reader</a></span><span class="op" id="5654455">)</span>&nbsp;<span class="ident" id="5654457">init</span><span class="op" id="5654461">(</span><span class="ident" id="5654462">r</span>&nbsp;<span class="ident" id="5654464"><a href="/gostd/archive/zip/reader.go.html#5653287">io</a></span><span class="op" id="5654466">.</span><span class="ident" id="5654467"><a href="/gostd/io/io.go.html#1425985">ReaderAt</a></span><span class="op" id="5654475">,</span>&nbsp;<span class="ident" id="5654477">size</span>&nbsp;<span class="builtintype" id="5654482">int64</span><span class="op" id="5654487">)</span>&nbsp;<span class="builtintype" id="5654489">error</span>&nbsp;<span class="op" id="5654495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5654498">end</span><span class="op" id="5654501">,</span>&nbsp;<span class="ident" id="5654503">err</span>&nbsp;<span class="op" id="5654507">:=</span>&nbsp;<span class="ident" id="5654510"><a href="/gostd/archive/zip/reader.go.html#5661462">readDirectoryEnd</a></span><span class="op" id="5654526">(</span><span class="ident" id="5654527"><a href="/gostd/archive/zip/reader.go.html#5654462">r</a></span><span class="op" id="5654528">,</span>&nbsp;<span class="ident" id="5654530"><a href="/gostd/archive/zip/reader.go.html#5654477">size</a></span><span class="op" id="5654534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5654537">if</span>&nbsp;<span class="ident" id="5654540"><a href="/gostd/archive/zip/reader.go.html#5654503">err</a></span>&nbsp;<span class="op" id="5654544">!=</span>&nbsp;<span class="builtintype" id="5654547">nil</span>&nbsp;<span class="op" id="5654551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5654555">return</span>&nbsp;<span class="ident" id="5654562"><a href="/gostd/archive/zip/reader.go.html#5654503">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5654567">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5654570"><a href="/gostd/archive/zip/reader.go.html#5654446">z</a></span><span class="op" id="5654571">.</span><span class="ident" id="5654572"><a href="/gostd/archive/zip/reader.go.html#5653507">r</a></span>&nbsp;<span class="op" id="5654574">=</span>&nbsp;<span class="ident" id="5654576"><a href="/gostd/archive/zip/reader.go.html#5654462">r</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5654579"><a href="/gostd/archive/zip/reader.go.html#5654446">z</a></span><span class="op" id="5654580">.</span><span class="ident" id="5654581"><a href="/gostd/archive/zip/reader.go.html#5653528">File</a></span>&nbsp;<span class="op" id="5654586">=</span>&nbsp;<span class="builtinfunc" id="5654588">make</span><span class="op" id="5654592">(</span><span class="op" id="5654593">[</span><span class="op" id="5654594">]</span><span class="op" id="5654595">*</span><span class="ident" id="5654596"><a href="/gostd/archive/zip/reader.go.html#5653616">File</a></span><span class="op" id="5654600">,</span>&nbsp;<span class="num" id="5654602">0</span><span class="op" id="5654603">,</span>&nbsp;<span class="ident" id="5654605"><a href="/gostd/archive/zip/reader.go.html#5654498">end</a></span><span class="op" id="5654608">.</span><span class="ident" id="5654609"><a href="/gostd/archive/zip/struct.go.html#5672443">directoryRecords</a></span><span class="op" id="5654625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5654628"><a href="/gostd/archive/zip/reader.go.html#5654446">z</a></span><span class="op" id="5654629">.</span><span class="ident" id="5654630"><a href="/gostd/archive/zip/reader.go.html#5653545">Comment</a></span>&nbsp;<span class="op" id="5654638">=</span>&nbsp;<span class="ident" id="5654640"><a href="/gostd/archive/zip/reader.go.html#5654498">end</a></span><span class="op" id="5654643">.</span><span class="ident" id="5654644"><a href="/gostd/archive/zip/struct.go.html#5672571">comment</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5654653">rs</span>&nbsp;<span class="op" id="5654656">:=</span>&nbsp;<span class="ident" id="5654659"><a href="/gostd/archive/zip/reader.go.html#5653287">io</a></span><span class="op" id="5654661">.</span><span class="ident" id="5654662"><a href="/gostd/io/io.go.html#1432455">NewSectionReader</a></span><span class="op" id="5654678">(</span><span class="ident" id="5654679"><a href="/gostd/archive/zip/reader.go.html#5654462">r</a></span><span class="op" id="5654680">,</span>&nbsp;<span class="num" id="5654682">0</span><span class="op" id="5654683">,</span>&nbsp;<span class="ident" id="5654685"><a href="/gostd/archive/zip/reader.go.html#5654477">size</a></span><span class="op" id="5654689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5654692">if</span>&nbsp;<span class="ident" id="5654695">_</span><span class="op" id="5654696">,</span>&nbsp;<span class="ident" id="5654698"><a href="/gostd/archive/zip/reader.go.html#5654503">err</a></span>&nbsp;<span class="op" id="5654702">=</span>&nbsp;<span class="ident" id="5654704"><a href="/gostd/archive/zip/reader.go.html#5654653">rs</a></span><span class="op" id="5654706">.</span><span class="ident" id="5654707"><a href="/gostd/io/io.go.html#1433107">Seek</a></span><span class="op" id="5654711">(</span><span class="builtintype" id="5654712">int64</span><span class="op" id="5654717">(</span><span class="ident" id="5654718"><a href="/gostd/archive/zip/reader.go.html#5654498">end</a></span><span class="op" id="5654721">.</span><span class="ident" id="5654722"><a href="/gostd/archive/zip/struct.go.html#5672497">directoryOffset</a></span><span class="op" id="5654737">)</span><span class="op" id="5654738">,</span>&nbsp;<span class="ident" id="5654740"><a href="/gostd/archive/zip/reader.go.html#5653293">os</a></span><span class="op" id="5654742">.</span><span class="ident" id="5654743"><a href="/gostd/os/file.go.html#2442631">SEEK_SET</a></span><span class="op" id="5654751">)</span><span class="op" id="5654752">;</span>&nbsp;<span class="ident" id="5654754"><a href="/gostd/archive/zip/reader.go.html#5654503">err</a></span>&nbsp;<span class="op" id="5654758">!=</span>&nbsp;<span class="builtintype" id="5654761">nil</span>&nbsp;<span class="op" id="5654765">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5654769">return</span>&nbsp;<span class="ident" id="5654776"><a href="/gostd/archive/zip/reader.go.html#5654503">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5654781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5654784">buf</span>&nbsp;<span class="op" id="5654788">:=</span>&nbsp;<span class="ident" id="5654791"><a href="/gostd/archive/zip/reader.go.html#5653227">bufio</a></span><span class="op" id="5654796">.</span><span class="ident" id="5654797"><a href="/gostd/bufio/bufio.go.html#1355792">NewReader</a></span><span class="op" id="5654806">(</span><span class="ident" id="5654807"><a href="/gostd/archive/zip/reader.go.html#5654653">rs</a></span><span class="op" id="5654809">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5654813">//&nbsp;The&nbsp;count&nbsp;of&nbsp;files&nbsp;inside&nbsp;a&nbsp;zip&nbsp;is&nbsp;truncated&nbsp;to&nbsp;fit&nbsp;in&nbsp;a&nbsp;uint16.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5654882">//&nbsp;Gloss&nbsp;over&nbsp;this&nbsp;by&nbsp;reading&nbsp;headers&nbsp;until&nbsp;we&nbsp;encounter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5654940">//&nbsp;a&nbsp;bad&nbsp;one,&nbsp;and&nbsp;then&nbsp;only&nbsp;report&nbsp;a&nbsp;ErrFormat&nbsp;or&nbsp;UnexpectedEOF&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5655008">//&nbsp;the&nbsp;file&nbsp;count&nbsp;modulo&nbsp;65536&nbsp;is&nbsp;incorrect.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5655054">for</span>&nbsp;<span class="op" id="5655058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5655062">f</span>&nbsp;<span class="op" id="5655064">:=</span>&nbsp;<span class="op" id="5655067">&amp;</span><span class="ident" id="5655068"><a href="/gostd/archive/zip/reader.go.html#5653616">File</a></span><span class="op" id="5655072">{</span><span class="ident" id="5655073"><a href="/gostd/archive/zip/reader.go.html#5653643">zipr</a></span><span class="op" id="5655077">:</span>&nbsp;<span class="ident" id="5655079"><a href="/gostd/archive/zip/reader.go.html#5654462">r</a></span><span class="op" id="5655080">,</span>&nbsp;<span class="ident" id="5655082"><a href="/gostd/archive/zip/reader.go.html#5653669">zipsize</a></span><span class="op" id="5655089">:</span>&nbsp;<span class="ident" id="5655091"><a href="/gostd/archive/zip/reader.go.html#5654477">size</a></span><span class="op" id="5655095">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5655099"><a href="/gostd/archive/zip/reader.go.html#5654503">err</a></span>&nbsp;<span class="op" id="5655103">=</span>&nbsp;<span class="ident" id="5655105"><a href="/gostd/archive/zip/reader.go.html#5658288">readDirectoryHeader</a></span><span class="op" id="5655124">(</span><span class="ident" id="5655125"><a href="/gostd/archive/zip/reader.go.html#5655062">f</a></span><span class="op" id="5655126">,</span>&nbsp;<span class="ident" id="5655128"><a href="/gostd/archive/zip/reader.go.html#5654784">buf</a></span><span class="op" id="5655131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5655135">if</span>&nbsp;<span class="ident" id="5655138"><a href="/gostd/archive/zip/reader.go.html#5654503">err</a></span>&nbsp;<span class="op" id="5655142">==</span>&nbsp;<span class="ident" id="5655145"><a href="/gostd/archive/zip/reader.go.html#5653308">ErrFormat</a></span>&nbsp;<span class="op" id="5655155">||</span>&nbsp;<span class="ident" id="5655158"><a href="/gostd/archive/zip/reader.go.html#5654503">err</a></span>&nbsp;<span class="op" id="5655162">==</span>&nbsp;<span class="ident" id="5655165"><a href="/gostd/archive/zip/reader.go.html#5653287">io</a></span><span class="op" id="5655167">.</span><span class="ident" id="5655168"><a href="/gostd/io/io.go.html#1420096">ErrUnexpectedEOF</a></span>&nbsp;<span class="op" id="5655185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5655190">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5655198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5655202">if</span>&nbsp;<span class="ident" id="5655205"><a href="/gostd/archive/zip/reader.go.html#5654503">err</a></span>&nbsp;<span class="op" id="5655209">!=</span>&nbsp;<span class="builtintype" id="5655212">nil</span>&nbsp;<span class="op" id="5655216">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5655221">return</span>&nbsp;<span class="ident" id="5655228"><a href="/gostd/archive/zip/reader.go.html#5654503">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5655234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5655238"><a href="/gostd/archive/zip/reader.go.html#5654446">z</a></span><span class="op" id="5655239">.</span><span class="ident" id="5655240"><a href="/gostd/archive/zip/reader.go.html#5653528">File</a></span>&nbsp;<span class="op" id="5655245">=</span>&nbsp;<span class="builtinfunc" id="5655247">append</span><span class="op" id="5655253">(</span><span class="ident" id="5655254"><a href="/gostd/archive/zip/reader.go.html#5654446">z</a></span><span class="op" id="5655255">.</span><span class="ident" id="5655256"><a href="/gostd/archive/zip/reader.go.html#5653528">File</a></span><span class="op" id="5655260">,</span>&nbsp;<span class="ident" id="5655262"><a href="/gostd/archive/zip/reader.go.html#5655062">f</a></span><span class="op" id="5655263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5655266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5655269">if</span>&nbsp;<span class="builtintype" id="5655272">uint16</span><span class="op" id="5655278">(</span><span class="builtinfunc" id="5655279">len</span><span class="op" id="5655282">(</span><span class="ident" id="5655283"><a href="/gostd/archive/zip/reader.go.html#5654446">z</a></span><span class="op" id="5655284">.</span><span class="ident" id="5655285"><a href="/gostd/archive/zip/reader.go.html#5653528">File</a></span><span class="op" id="5655289">)</span><span class="op" id="5655290">)</span>&nbsp;<span class="op" id="5655292">!=</span>&nbsp;<span class="builtintype" id="5655295">uint16</span><span class="op" id="5655301">(</span><span class="ident" id="5655302"><a href="/gostd/archive/zip/reader.go.html#5654498">end</a></span><span class="op" id="5655305">.</span><span class="ident" id="5655306"><a href="/gostd/archive/zip/struct.go.html#5672443">directoryRecords</a></span><span class="op" id="5655322">)</span>&nbsp;<span class="op" id="5655324">{</span>&nbsp;<span class="comment" id="5655326">//&nbsp;only&nbsp;compare&nbsp;16&nbsp;bits&nbsp;here</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5655357">//&nbsp;Return&nbsp;the&nbsp;readDirectoryHeader&nbsp;error&nbsp;if&nbsp;we&nbsp;read</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5655410">//&nbsp;the&nbsp;wrong&nbsp;number&nbsp;of&nbsp;directory&nbsp;entries.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5655454">return</span>&nbsp;<span class="ident" id="5655461"><a href="/gostd/archive/zip/reader.go.html#5654503">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5655466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5655469">return</span>&nbsp;<span class="builtintype" id="5655476">nil</span><br>
<span class="lineno">110</span><span class="op" id="5655480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5655483">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;Zip&nbsp;file,&nbsp;rendering&nbsp;it&nbsp;unusable&nbsp;for&nbsp;I/O.</span><br>
<span class="lineno"></span><span class="keyword" id="5655544">func</span>&nbsp;<span class="op" id="5655549">(</span><span class="ident" id="5655550">rc</span>&nbsp;<span class="op" id="5655553">*</span><span class="ident" id="5655554"><a href="/gostd/archive/zip/reader.go.html#5653568">ReadCloser</a></span><span class="op" id="5655564">)</span>&nbsp;<span class="ident" id="5655566">Close</span><span class="op" id="5655571">(</span><span class="op" id="5655572">)</span>&nbsp;<span class="builtintype" id="5655574">error</span>&nbsp;<span class="op" id="5655580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5655583">return</span>&nbsp;<span class="ident" id="5655590"><a href="/gostd/archive/zip/reader.go.html#5655550">rc</a></span><span class="op" id="5655592">.</span><span class="ident" id="5655593"><a href="/gostd/archive/zip/reader.go.html#5653589">f</a></span><span class="op" id="5655594">.</span><span class="ident" id="5655595"><a href="/gostd/os/file_unix.go.html#2454611">Close</a></span><span class="op" id="5655600">(</span><span class="op" id="5655601">)</span><br>
<span class="lineno">115</span><span class="op" id="5655603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5655606">//&nbsp;DataOffset&nbsp;returns&nbsp;the&nbsp;offset&nbsp;of&nbsp;the&nbsp;file&#39;s&nbsp;possibly-compressed</span><br>
<span class="lineno"></span><span class="comment" id="5655673">//&nbsp;data,&nbsp;relative&nbsp;to&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;zip&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="5655725">//</span><br>
<span class="lineno">120</span><span class="comment" id="5655728">//&nbsp;Most&nbsp;callers&nbsp;should&nbsp;instead&nbsp;use&nbsp;Open,&nbsp;which&nbsp;transparently</span><br>
<span class="lineno"></span><span class="comment" id="5655789">//&nbsp;decompresses&nbsp;data&nbsp;and&nbsp;verifies&nbsp;checksums.</span><br>
<span class="lineno"></span><span class="keyword" id="5655834">func</span>&nbsp;<span class="op" id="5655839">(</span><span class="ident" id="5655840">f</span>&nbsp;<span class="op" id="5655842">*</span><span class="ident" id="5655843"><a href="/gostd/archive/zip/reader.go.html#5653616">File</a></span><span class="op" id="5655847">)</span>&nbsp;<span class="ident" id="5655849">DataOffset</span><span class="op" id="5655859">(</span><span class="op" id="5655860">)</span>&nbsp;<span class="op" id="5655862">(</span><span class="ident" id="5655863">offset</span>&nbsp;<span class="builtintype" id="5655870">int64</span><span class="op" id="5655875">,</span>&nbsp;<span class="ident" id="5655877">err</span>&nbsp;<span class="builtintype" id="5655881">error</span><span class="op" id="5655886">)</span>&nbsp;<span class="op" id="5655888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5655891">bodyOffset</span><span class="op" id="5655901">,</span>&nbsp;<span class="ident" id="5655903"><a href="/gostd/archive/zip/reader.go.html#5655877">err</a></span>&nbsp;<span class="op" id="5655907">:=</span>&nbsp;<span class="ident" id="5655910"><a href="/gostd/archive/zip/reader.go.html#5655840">f</a></span><span class="op" id="5655911">.</span><span class="ident" id="5655912"><a href="/gostd/archive/zip/reader.go.html#5657669">findBodyOffset</a></span><span class="op" id="5655926">(</span><span class="op" id="5655927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5655930">if</span>&nbsp;<span class="ident" id="5655933"><a href="/gostd/archive/zip/reader.go.html#5655877">err</a></span>&nbsp;<span class="op" id="5655937">!=</span>&nbsp;<span class="builtintype" id="5655940">nil</span>&nbsp;<span class="op" id="5655944">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5655948">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5655956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5655959">return</span>&nbsp;<span class="ident" id="5655966"><a href="/gostd/archive/zip/reader.go.html#5655840">f</a></span><span class="op" id="5655967">.</span><span class="ident" id="5655968"><a href="/gostd/archive/zip/reader.go.html#5653689">headerOffset</a></span>&nbsp;<span class="op" id="5655981">+</span>&nbsp;<span class="ident" id="5655983"><a href="/gostd/archive/zip/reader.go.html#5655891">bodyOffset</a></span><span class="op" id="5655993">,</span>&nbsp;<span class="builtintype" id="5655995">nil</span><br>
<span class="lineno"></span><span class="op" id="5655999">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="comment" id="5656002">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;ReadCloser&nbsp;that&nbsp;provides&nbsp;access&nbsp;to&nbsp;the&nbsp;File&#39;s&nbsp;contents.</span><br>
<span class="lineno"></span><span class="comment" id="5656076">//&nbsp;Multiple&nbsp;files&nbsp;may&nbsp;be&nbsp;read&nbsp;concurrently.</span><br>
<span class="lineno"></span><span class="keyword" id="5656120">func</span>&nbsp;<span class="op" id="5656125">(</span><span class="ident" id="5656126">f</span>&nbsp;<span class="op" id="5656128">*</span><span class="ident" id="5656129"><a href="/gostd/archive/zip/reader.go.html#5653616">File</a></span><span class="op" id="5656133">)</span>&nbsp;<span class="ident" id="5656135">Open</span><span class="op" id="5656139">(</span><span class="op" id="5656140">)</span>&nbsp;<span class="op" id="5656142">(</span><span class="ident" id="5656143">rc</span>&nbsp;<span class="ident" id="5656146"><a href="/gostd/archive/zip/reader.go.html#5653287">io</a></span><span class="op" id="5656148">.</span><span class="ident" id="5656149"><a href="/gostd/io/io.go.html#1423414">ReadCloser</a></span><span class="op" id="5656159">,</span>&nbsp;<span class="ident" id="5656161">err</span>&nbsp;<span class="builtintype" id="5656165">error</span><span class="op" id="5656170">)</span>&nbsp;<span class="op" id="5656172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5656175">bodyOffset</span><span class="op" id="5656185">,</span>&nbsp;<span class="ident" id="5656187"><a href="/gostd/archive/zip/reader.go.html#5656161">err</a></span>&nbsp;<span class="op" id="5656191">:=</span>&nbsp;<span class="ident" id="5656194"><a href="/gostd/archive/zip/reader.go.html#5656126">f</a></span><span class="op" id="5656195">.</span><span class="ident" id="5656196"><a href="/gostd/archive/zip/reader.go.html#5657669">findBodyOffset</a></span><span class="op" id="5656210">(</span><span class="op" id="5656211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5656214">if</span>&nbsp;<span class="ident" id="5656217"><a href="/gostd/archive/zip/reader.go.html#5656161">err</a></span>&nbsp;<span class="op" id="5656221">!=</span>&nbsp;<span class="builtintype" id="5656224">nil</span>&nbsp;<span class="op" id="5656228">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5656232">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5656240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5656243">size</span>&nbsp;<span class="op" id="5656248">:=</span>&nbsp;<span class="builtintype" id="5656251">int64</span><span class="op" id="5656256">(</span><span class="ident" id="5656257"><a href="/gostd/archive/zip/reader.go.html#5656126">f</a></span><span class="op" id="5656258">.</span><span class="ident" id="5656259"><a href="/gostd/archive/zip/struct.go.html#5670729">CompressedSize64</a></span><span class="op" id="5656275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5656278">r</span>&nbsp;<span class="op" id="5656280">:=</span>&nbsp;<span class="ident" id="5656283"><a href="/gostd/archive/zip/reader.go.html#5653287">io</a></span><span class="op" id="5656285">.</span><span class="ident" id="5656286"><a href="/gostd/io/io.go.html#1432455">NewSectionReader</a></span><span class="op" id="5656302">(</span><span class="ident" id="5656303"><a href="/gostd/archive/zip/reader.go.html#5656126">f</a></span><span class="op" id="5656304">.</span><span class="ident" id="5656305"><a href="/gostd/archive/zip/reader.go.html#5653643">zipr</a></span><span class="op" id="5656309">,</span>&nbsp;<span class="ident" id="5656311"><a href="/gostd/archive/zip/reader.go.html#5656126">f</a></span><span class="op" id="5656312">.</span><span class="ident" id="5656313"><a href="/gostd/archive/zip/reader.go.html#5653689">headerOffset</a></span><span class="op" id="5656325">+</span><span class="ident" id="5656326"><a href="/gostd/archive/zip/reader.go.html#5656175">bodyOffset</a></span><span class="op" id="5656336">,</span>&nbsp;<span class="ident" id="5656338"><a href="/gostd/archive/zip/reader.go.html#5656243">size</a></span><span class="op" id="5656342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5656345">dcomp</span>&nbsp;<span class="op" id="5656351">:=</span>&nbsp;<span class="ident" id="5656354"><a href="/gostd/archive/zip/register.go.html#5668007">decompressor</a></span><span class="op" id="5656366">(</span><span class="ident" id="5656367"><a href="/gostd/archive/zip/reader.go.html#5656126">f</a></span><span class="op" id="5656368">.</span><span class="ident" id="5656369"><a href="/gostd/archive/zip/struct.go.html#5670463">Method</a></span><span class="op" id="5656375">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5656378">if</span>&nbsp;<span class="ident" id="5656381"><a href="/gostd/archive/zip/reader.go.html#5656345">dcomp</a></span>&nbsp;<span class="op" id="5656387">==</span>&nbsp;<span class="builtintype" id="5656390">nil</span>&nbsp;<span class="op" id="5656394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5656398"><a href="/gostd/archive/zip/reader.go.html#5656161">err</a></span>&nbsp;<span class="op" id="5656402">=</span>&nbsp;<span class="ident" id="5656404"><a href="/gostd/archive/zip/reader.go.html#5653364">ErrAlgorithm</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5656419">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5656427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5656430"><a href="/gostd/archive/zip/reader.go.html#5656143">rc</a></span>&nbsp;<span class="op" id="5656433">=</span>&nbsp;<span class="ident" id="5656435"><a href="/gostd/archive/zip/reader.go.html#5656345">dcomp</a></span><span class="op" id="5656440">(</span><span class="ident" id="5656441"><a href="/gostd/archive/zip/reader.go.html#5656278">r</a></span><span class="op" id="5656442">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5656445">var</span>&nbsp;<span class="ident" id="5656449">desr</span>&nbsp;<span class="ident" id="5656454"><a href="/gostd/archive/zip/reader.go.html#5653287">io</a></span><span class="op" id="5656456">.</span><span class="ident" id="5656457"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5656465">if</span>&nbsp;<span class="ident" id="5656468"><a href="/gostd/archive/zip/reader.go.html#5656126">f</a></span><span class="op" id="5656469">.</span><span class="ident" id="5656470"><a href="/gostd/archive/zip/reader.go.html#5653726">hasDataDescriptor</a></span><span class="op" id="5656487">(</span><span class="op" id="5656488">)</span>&nbsp;<span class="op" id="5656490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5656494"><a href="/gostd/archive/zip/reader.go.html#5656449">desr</a></span>&nbsp;<span class="op" id="5656499">=</span>&nbsp;<span class="ident" id="5656501"><a href="/gostd/archive/zip/reader.go.html#5653287">io</a></span><span class="op" id="5656503">.</span><span class="ident" id="5656504"><a href="/gostd/io/io.go.html#1432455">NewSectionReader</a></span><span class="op" id="5656520">(</span><span class="ident" id="5656521"><a href="/gostd/archive/zip/reader.go.html#5656126">f</a></span><span class="op" id="5656522">.</span><span class="ident" id="5656523"><a href="/gostd/archive/zip/reader.go.html#5653643">zipr</a></span><span class="op" id="5656527">,</span>&nbsp;<span class="ident" id="5656529"><a href="/gostd/archive/zip/reader.go.html#5656126">f</a></span><span class="op" id="5656530">.</span><span class="ident" id="5656531"><a href="/gostd/archive/zip/reader.go.html#5653689">headerOffset</a></span><span class="op" id="5656543">+</span><span class="ident" id="5656544"><a href="/gostd/archive/zip/reader.go.html#5656175">bodyOffset</a></span><span class="op" id="5656554">+</span><span class="ident" id="5656555"><a href="/gostd/archive/zip/reader.go.html#5656243">size</a></span><span class="op" id="5656559">,</span>&nbsp;<span class="ident" id="5656561"><a href="/gostd/archive/zip/struct.go.html#5669379">dataDescriptorLen</a></span><span class="op" id="5656578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5656581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5656584"><a href="/gostd/archive/zip/reader.go.html#5656143">rc</a></span>&nbsp;<span class="op" id="5656587">=</span>&nbsp;<span class="op" id="5656589">&amp;</span><span class="ident" id="5656590"><a href="/gostd/archive/zip/reader.go.html#5656656">checksumReader</a></span><span class="op" id="5656604">{</span><span class="ident" id="5656605"><a href="/gostd/archive/zip/reader.go.html#5656143">rc</a></span><span class="op" id="5656607">,</span>&nbsp;<span class="ident" id="5656609"><a href="/gostd/archive/zip/reader.go.html#5653273">crc32</a></span><span class="op" id="5656614">.</span><span class="ident" id="5656615"><a href="/gostd/hash/crc32/crc32.go.html#4859679">NewIEEE</a></span><span class="op" id="5656622">(</span><span class="op" id="5656623">)</span><span class="op" id="5656624">,</span>&nbsp;<span class="ident" id="5656626"><a href="/gostd/archive/zip/reader.go.html#5656126">f</a></span><span class="op" id="5656627">,</span>&nbsp;<span class="ident" id="5656629"><a href="/gostd/archive/zip/reader.go.html#5656449">desr</a></span><span class="op" id="5656633">,</span>&nbsp;<span class="builtintype" id="5656635">nil</span><span class="op" id="5656638">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5656641">return</span><br>
<span class="lineno"></span><span class="op" id="5656648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5656651">type</span>&nbsp;<span class="ident" id="5656656">checksumReader</span>&nbsp;<span class="keyword" id="5656671">struct</span>&nbsp;<span class="op" id="5656678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5656681">rc</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5656686"><a href="/gostd/archive/zip/reader.go.html#5653287">io</a></span><span class="op" id="5656688">.</span><span class="ident" id="5656689"><a href="/gostd/io/io.go.html#1423414">ReadCloser</a></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5656701">hash</span>&nbsp;<span class="ident" id="5656706"><a href="/gostd/archive/zip/reader.go.html#5653265">hash</a></span><span class="op" id="5656710">.</span><span class="ident" id="5656711"><a href="/gostd/hash/hash.go.html#3014832">Hash32</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5656719">f</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5656724">*</span><span class="ident" id="5656725"><a href="/gostd/archive/zip/reader.go.html#5653616">File</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5656731">desr</span>&nbsp;<span class="ident" id="5656736"><a href="/gostd/archive/zip/reader.go.html#5653287">io</a></span><span class="op" id="5656738">.</span><span class="ident" id="5656739"><a href="/gostd/io/io.go.html#1421823">Reader</a></span>&nbsp;<span class="comment" id="5656746">//&nbsp;if&nbsp;non-nil,&nbsp;where&nbsp;to&nbsp;read&nbsp;the&nbsp;data&nbsp;descriptor</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5656796">err</span>&nbsp;&nbsp;<span class="builtintype" id="5656801">error</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5656811">//&nbsp;sticky&nbsp;error</span><br>
<span class="lineno"></span><span class="op" id="5656827">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="keyword" id="5656830">func</span>&nbsp;<span class="op" id="5656835">(</span><span class="ident" id="5656836">r</span>&nbsp;<span class="op" id="5656838">*</span><span class="ident" id="5656839"><a href="/gostd/archive/zip/reader.go.html#5656656">checksumReader</a></span><span class="op" id="5656853">)</span>&nbsp;<span class="ident" id="5656855">Read</span><span class="op" id="5656859">(</span><span class="ident" id="5656860">b</span>&nbsp;<span class="op" id="5656862">[</span><span class="op" id="5656863">]</span><span class="builtintype" id="5656864">byte</span><span class="op" id="5656868">)</span>&nbsp;<span class="op" id="5656870">(</span><span class="ident" id="5656871">n</span>&nbsp;<span class="builtintype" id="5656873">int</span><span class="op" id="5656876">,</span>&nbsp;<span class="ident" id="5656878">err</span>&nbsp;<span class="builtintype" id="5656882">error</span><span class="op" id="5656887">)</span>&nbsp;<span class="op" id="5656889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5656892">if</span>&nbsp;<span class="ident" id="5656895"><a href="/gostd/archive/zip/reader.go.html#5656836">r</a></span><span class="op" id="5656896">.</span><span class="ident" id="5656897"><a href="/gostd/archive/zip/reader.go.html#5656796">err</a></span>&nbsp;<span class="op" id="5656901">!=</span>&nbsp;<span class="builtintype" id="5656904">nil</span>&nbsp;<span class="op" id="5656908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5656912">return</span>&nbsp;<span class="num" id="5656919">0</span><span class="op" id="5656920">,</span>&nbsp;<span class="ident" id="5656922"><a href="/gostd/archive/zip/reader.go.html#5656836">r</a></span><span class="op" id="5656923">.</span><span class="ident" id="5656924"><a href="/gostd/archive/zip/reader.go.html#5656796">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5656929">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5656932"><a href="/gostd/archive/zip/reader.go.html#5656871">n</a></span><span class="op" id="5656933">,</span>&nbsp;<span class="ident" id="5656935"><a href="/gostd/archive/zip/reader.go.html#5656878">err</a></span>&nbsp;<span class="op" id="5656939">=</span>&nbsp;<span class="ident" id="5656941"><a href="/gostd/archive/zip/reader.go.html#5656836">r</a></span><span class="op" id="5656942">.</span><span class="ident" id="5656943"><a href="/gostd/archive/zip/reader.go.html#5656681">rc</a></span><span class="op" id="5656945">.</span><span class="ident" id="5656946"><a href="/gostd/io/io.go.html#1421843">Read</a></span><span class="op" id="5656950">(</span><span class="ident" id="5656951"><a href="/gostd/archive/zip/reader.go.html#5656860">b</a></span><span class="op" id="5656952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5656955"><a href="/gostd/archive/zip/reader.go.html#5656836">r</a></span><span class="op" id="5656956">.</span><span class="ident" id="5656957"><a href="/gostd/archive/zip/reader.go.html#5656701">hash</a></span><span class="op" id="5656961">.</span><span class="ident" id="5656962"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="5656967">(</span><span class="ident" id="5656968"><a href="/gostd/archive/zip/reader.go.html#5656860">b</a></span><span class="op" id="5656969">[</span><span class="op" id="5656970">:</span><span class="ident" id="5656971"><a href="/gostd/archive/zip/reader.go.html#5656871">n</a></span><span class="op" id="5656972">]</span><span class="op" id="5656973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5656976">if</span>&nbsp;<span class="ident" id="5656979"><a href="/gostd/archive/zip/reader.go.html#5656878">err</a></span>&nbsp;<span class="op" id="5656983">==</span>&nbsp;<span class="builtintype" id="5656986">nil</span>&nbsp;<span class="op" id="5656990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5656994">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5657002">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5657005">if</span>&nbsp;<span class="ident" id="5657008"><a href="/gostd/archive/zip/reader.go.html#5656878">err</a></span>&nbsp;<span class="op" id="5657012">==</span>&nbsp;<span class="ident" id="5657015"><a href="/gostd/archive/zip/reader.go.html#5653287">io</a></span><span class="op" id="5657017">.</span><span class="ident" id="5657018"><a href="/gostd/io/io.go.html#1419950">EOF</a></span>&nbsp;<span class="op" id="5657022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5657026">if</span>&nbsp;<span class="ident" id="5657029"><a href="/gostd/archive/zip/reader.go.html#5656836">r</a></span><span class="op" id="5657030">.</span><span class="ident" id="5657031"><a href="/gostd/archive/zip/reader.go.html#5656731">desr</a></span>&nbsp;<span class="op" id="5657036">!=</span>&nbsp;<span class="builtintype" id="5657039">nil</span>&nbsp;<span class="op" id="5657043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5657048">if</span>&nbsp;<span class="ident" id="5657051">err1</span>&nbsp;<span class="op" id="5657056">:=</span>&nbsp;<span class="ident" id="5657059"><a href="/gostd/archive/zip/reader.go.html#5660184">readDataDescriptor</a></span><span class="op" id="5657077">(</span><span class="ident" id="5657078"><a href="/gostd/archive/zip/reader.go.html#5656836">r</a></span><span class="op" id="5657079">.</span><span class="ident" id="5657080"><a href="/gostd/archive/zip/reader.go.html#5656731">desr</a></span><span class="op" id="5657084">,</span>&nbsp;<span class="ident" id="5657086"><a href="/gostd/archive/zip/reader.go.html#5656836">r</a></span><span class="op" id="5657087">.</span><span class="ident" id="5657088"><a href="/gostd/archive/zip/reader.go.html#5656719">f</a></span><span class="op" id="5657089">)</span><span class="op" id="5657090">;</span>&nbsp;<span class="ident" id="5657092"><a href="/gostd/archive/zip/reader.go.html#5657051">err1</a></span>&nbsp;<span class="op" id="5657097">!=</span>&nbsp;<span class="builtintype" id="5657100">nil</span>&nbsp;<span class="op" id="5657104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5657110"><a href="/gostd/archive/zip/reader.go.html#5656878">err</a></span>&nbsp;<span class="op" id="5657114">=</span>&nbsp;<span class="ident" id="5657116"><a href="/gostd/archive/zip/reader.go.html#5657051">err1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5657124">}</span>&nbsp;<span class="keyword" id="5657126">else</span>&nbsp;<span class="keyword" id="5657131">if</span>&nbsp;<span class="ident" id="5657134"><a href="/gostd/archive/zip/reader.go.html#5656836">r</a></span><span class="op" id="5657135">.</span><span class="ident" id="5657136"><a href="/gostd/archive/zip/reader.go.html#5656701">hash</a></span><span class="op" id="5657140">.</span><span class="ident" id="5657141"><a href="/gostd/hash/hash.go.html#3014858">Sum32</a></span><span class="op" id="5657146">(</span><span class="op" id="5657147">)</span>&nbsp;<span class="op" id="5657149">!=</span>&nbsp;<span class="ident" id="5657152"><a href="/gostd/archive/zip/reader.go.html#5656836">r</a></span><span class="op" id="5657153">.</span><span class="ident" id="5657154"><a href="/gostd/archive/zip/reader.go.html#5656719">f</a></span><span class="op" id="5657155">.</span><span class="ident" id="5657156"><a href="/gostd/archive/zip/struct.go.html#5670574">CRC32</a></span>&nbsp;<span class="op" id="5657162">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5657168"><a href="/gostd/archive/zip/reader.go.html#5656878">err</a></span>&nbsp;<span class="op" id="5657172">=</span>&nbsp;<span class="ident" id="5657174"><a href="/gostd/archive/zip/reader.go.html#5653433">ErrChecksum</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5657189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5657193">}</span>&nbsp;<span class="keyword" id="5657195">else</span>&nbsp;<span class="op" id="5657200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5657205">//&nbsp;If&nbsp;there&#39;s&nbsp;not&nbsp;a&nbsp;data&nbsp;descriptor,&nbsp;we&nbsp;still&nbsp;compare</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5657262">//&nbsp;the&nbsp;CRC32&nbsp;of&nbsp;what&nbsp;we&#39;ve&nbsp;read&nbsp;against&nbsp;the&nbsp;file&nbsp;header</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5657321">//&nbsp;or&nbsp;TOC&#39;s&nbsp;CRC32,&nbsp;if&nbsp;it&nbsp;seems&nbsp;like&nbsp;it&nbsp;was&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5657372">if</span>&nbsp;<span class="ident" id="5657375"><a href="/gostd/archive/zip/reader.go.html#5656836">r</a></span><span class="op" id="5657376">.</span><span class="ident" id="5657377"><a href="/gostd/archive/zip/reader.go.html#5656719">f</a></span><span class="op" id="5657378">.</span><span class="ident" id="5657379"><a href="/gostd/archive/zip/struct.go.html#5670574">CRC32</a></span>&nbsp;<span class="op" id="5657385">!=</span>&nbsp;<span class="num" id="5657388">0</span>&nbsp;<span class="op" id="5657390">&amp;&amp;</span>&nbsp;<span class="ident" id="5657393"><a href="/gostd/archive/zip/reader.go.html#5656836">r</a></span><span class="op" id="5657394">.</span><span class="ident" id="5657395"><a href="/gostd/archive/zip/reader.go.html#5656701">hash</a></span><span class="op" id="5657399">.</span><span class="ident" id="5657400"><a href="/gostd/hash/hash.go.html#3014858">Sum32</a></span><span class="op" id="5657405">(</span><span class="op" id="5657406">)</span>&nbsp;<span class="op" id="5657408">!=</span>&nbsp;<span class="ident" id="5657411"><a href="/gostd/archive/zip/reader.go.html#5656836">r</a></span><span class="op" id="5657412">.</span><span class="ident" id="5657413"><a href="/gostd/archive/zip/reader.go.html#5656719">f</a></span><span class="op" id="5657414">.</span><span class="ident" id="5657415"><a href="/gostd/archive/zip/struct.go.html#5670574">CRC32</a></span>&nbsp;<span class="op" id="5657421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5657427"><a href="/gostd/archive/zip/reader.go.html#5656878">err</a></span>&nbsp;<span class="op" id="5657431">=</span>&nbsp;<span class="ident" id="5657433"><a href="/gostd/archive/zip/reader.go.html#5653433">ErrChecksum</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5657448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5657452">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5657455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5657458"><a href="/gostd/archive/zip/reader.go.html#5656836">r</a></span><span class="op" id="5657459">.</span><span class="ident" id="5657460"><a href="/gostd/archive/zip/reader.go.html#5656796">err</a></span>&nbsp;<span class="op" id="5657464">=</span>&nbsp;<span class="ident" id="5657466"><a href="/gostd/archive/zip/reader.go.html#5656878">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5657471">return</span><br>
<span class="lineno"></span><span class="op" id="5657478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="5657481">func</span>&nbsp;<span class="op" id="5657486">(</span><span class="ident" id="5657487">r</span>&nbsp;<span class="op" id="5657489">*</span><span class="ident" id="5657490"><a href="/gostd/archive/zip/reader.go.html#5656656">checksumReader</a></span><span class="op" id="5657504">)</span>&nbsp;<span class="ident" id="5657506">Close</span><span class="op" id="5657511">(</span><span class="op" id="5657512">)</span>&nbsp;<span class="builtintype" id="5657514">error</span>&nbsp;<span class="op" id="5657520">{</span>&nbsp;<span class="keyword" id="5657522">return</span>&nbsp;<span class="ident" id="5657529"><a href="/gostd/archive/zip/reader.go.html#5657487">r</a></span><span class="op" id="5657530">.</span><span class="ident" id="5657531"><a href="/gostd/archive/zip/reader.go.html#5656681">rc</a></span><span class="op" id="5657533">.</span><span class="ident" id="5657534"><a href="/gostd/io/io.go.html#1422583">Close</a></span><span class="op" id="5657539">(</span><span class="op" id="5657540">)</span>&nbsp;<span class="op" id="5657542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5657545">//&nbsp;findBodyOffset&nbsp;does&nbsp;the&nbsp;minimum&nbsp;work&nbsp;to&nbsp;verify&nbsp;the&nbsp;file&nbsp;has&nbsp;a&nbsp;header</span><br>
<span class="lineno"></span><span class="comment" id="5657617">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;file&nbsp;body&nbsp;offset.</span><br>
<span class="lineno"></span><span class="keyword" id="5657654">func</span>&nbsp;<span class="op" id="5657659">(</span><span class="ident" id="5657660">f</span>&nbsp;<span class="op" id="5657662">*</span><span class="ident" id="5657663"><a href="/gostd/archive/zip/reader.go.html#5653616">File</a></span><span class="op" id="5657667">)</span>&nbsp;<span class="ident" id="5657669">findBodyOffset</span><span class="op" id="5657683">(</span><span class="op" id="5657684">)</span>&nbsp;<span class="op" id="5657686">(</span><span class="builtintype" id="5657687">int64</span><span class="op" id="5657692">,</span>&nbsp;<span class="builtintype" id="5657694">error</span><span class="op" id="5657699">)</span>&nbsp;<span class="op" id="5657701">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5657704">var</span>&nbsp;<span class="ident" id="5657708">buf</span>&nbsp;<span class="op" id="5657712">[</span><span class="ident" id="5657713"><a href="/gostd/archive/zip/struct.go.html#5669195">fileHeaderLen</a></span><span class="op" id="5657726">]</span><span class="builtintype" id="5657727">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5657733">if</span>&nbsp;<span class="ident" id="5657736">_</span><span class="op" id="5657737">,</span>&nbsp;<span class="ident" id="5657739">err</span>&nbsp;<span class="op" id="5657743">:=</span>&nbsp;<span class="ident" id="5657746"><a href="/gostd/archive/zip/reader.go.html#5657660">f</a></span><span class="op" id="5657747">.</span><span class="ident" id="5657748"><a href="/gostd/archive/zip/reader.go.html#5653643">zipr</a></span><span class="op" id="5657752">.</span><span class="ident" id="5657753"><a href="/gostd/io/io.go.html#1426007">ReadAt</a></span><span class="op" id="5657759">(</span><span class="ident" id="5657760"><a href="/gostd/archive/zip/reader.go.html#5657708">buf</a></span><span class="op" id="5657763">[</span><span class="op" id="5657764">:</span><span class="op" id="5657765">]</span><span class="op" id="5657766">,</span>&nbsp;<span class="ident" id="5657768"><a href="/gostd/archive/zip/reader.go.html#5657660">f</a></span><span class="op" id="5657769">.</span><span class="ident" id="5657770"><a href="/gostd/archive/zip/reader.go.html#5653689">headerOffset</a></span><span class="op" id="5657782">)</span><span class="op" id="5657783">;</span>&nbsp;<span class="ident" id="5657785"><a href="/gostd/archive/zip/reader.go.html#5657739">err</a></span>&nbsp;<span class="op" id="5657789">!=</span>&nbsp;<span class="builtintype" id="5657792">nil</span>&nbsp;<span class="op" id="5657796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5657800">return</span>&nbsp;<span class="num" id="5657807">0</span><span class="op" id="5657808">,</span>&nbsp;<span class="ident" id="5657810"><a href="/gostd/archive/zip/reader.go.html#5657739">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5657815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5657818">b</span>&nbsp;<span class="op" id="5657820">:=</span>&nbsp;<span class="ident" id="5657823"><a href="/gostd/archive/zip/reader.go.html#5665121">readBuf</a></span><span class="op" id="5657830">(</span><span class="ident" id="5657831"><a href="/gostd/archive/zip/reader.go.html#5657708">buf</a></span><span class="op" id="5657834">[</span><span class="op" id="5657835">:</span><span class="op" id="5657836">]</span><span class="op" id="5657837">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5657840">if</span>&nbsp;<span class="ident" id="5657843">sig</span>&nbsp;<span class="op" id="5657847">:=</span>&nbsp;<span class="ident" id="5657850"><a href="/gostd/archive/zip/reader.go.html#5657818">b</a></span><span class="op" id="5657851">.</span><span class="builtintype" id="5657852"><a href="/gostd/archive/zip/reader.go.html#5665256">uint32</a></span><span class="op" id="5657858">(</span><span class="op" id="5657859">)</span><span class="op" id="5657860">;</span>&nbsp;<span class="ident" id="5657862"><a href="/gostd/archive/zip/reader.go.html#5657843">sig</a></span>&nbsp;<span class="op" id="5657866">!=</span>&nbsp;<span class="ident" id="5657869"><a href="/gostd/archive/zip/struct.go.html#5668915">fileHeaderSignature</a></span>&nbsp;<span class="op" id="5657889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5657893">return</span>&nbsp;<span class="num" id="5657900">0</span><span class="op" id="5657901">,</span>&nbsp;<span class="ident" id="5657903"><a href="/gostd/archive/zip/reader.go.html#5653308">ErrFormat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5657914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5657917"><a href="/gostd/archive/zip/reader.go.html#5657818">b</a></span>&nbsp;<span class="op" id="5657919">=</span>&nbsp;<span class="ident" id="5657921"><a href="/gostd/archive/zip/reader.go.html#5657818">b</a></span><span class="op" id="5657922">[</span><span class="num" id="5657923">22</span><span class="op" id="5657925">:</span><span class="op" id="5657926">]</span>&nbsp;<span class="comment" id="5657928">//&nbsp;skip&nbsp;over&nbsp;most&nbsp;of&nbsp;the&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5657961">filenameLen</span>&nbsp;<span class="op" id="5657973">:=</span>&nbsp;<span class="builtintype" id="5657976">int</span><span class="op" id="5657979">(</span><span class="ident" id="5657980"><a href="/gostd/archive/zip/reader.go.html#5657818">b</a></span><span class="op" id="5657981">.</span><span class="builtintype" id="5657982"><a href="/gostd/archive/zip/reader.go.html#5665155">uint16</a></span><span class="op" id="5657988">(</span><span class="op" id="5657989">)</span><span class="op" id="5657990">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5657993">extraLen</span>&nbsp;<span class="op" id="5658002">:=</span>&nbsp;<span class="builtintype" id="5658005">int</span><span class="op" id="5658008">(</span><span class="ident" id="5658009"><a href="/gostd/archive/zip/reader.go.html#5657818">b</a></span><span class="op" id="5658010">.</span><span class="builtintype" id="5658011"><a href="/gostd/archive/zip/reader.go.html#5665155">uint16</a></span><span class="op" id="5658017">(</span><span class="op" id="5658018">)</span><span class="op" id="5658019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5658022">return</span>&nbsp;<span class="builtintype" id="5658029">int64</span><span class="op" id="5658034">(</span><span class="ident" id="5658035"><a href="/gostd/archive/zip/struct.go.html#5669195">fileHeaderLen</a></span>&nbsp;<span class="op" id="5658049">+</span>&nbsp;<span class="ident" id="5658051"><a href="/gostd/archive/zip/reader.go.html#5657961">filenameLen</a></span>&nbsp;<span class="op" id="5658063">+</span>&nbsp;<span class="ident" id="5658065"><a href="/gostd/archive/zip/reader.go.html#5657993">extraLen</a></span><span class="op" id="5658073">)</span><span class="op" id="5658074">,</span>&nbsp;<span class="builtintype" id="5658076">nil</span><br>
<span class="lineno"></span><span class="op" id="5658080">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5658083">//&nbsp;readDirectoryHeader&nbsp;attempts&nbsp;to&nbsp;read&nbsp;a&nbsp;directory&nbsp;header&nbsp;from&nbsp;r.</span><br>
<span class="lineno">210</span><span class="comment" id="5658150">//&nbsp;It&nbsp;returns&nbsp;io.ErrUnexpectedEOF&nbsp;if&nbsp;it&nbsp;cannot&nbsp;read&nbsp;a&nbsp;complete&nbsp;header,</span><br>
<span class="lineno"></span><span class="comment" id="5658221">//&nbsp;and&nbsp;ErrFormat&nbsp;if&nbsp;it&nbsp;doesn&#39;t&nbsp;find&nbsp;a&nbsp;valid&nbsp;header&nbsp;signature.</span><br>
<span class="lineno"></span><span class="keyword" id="5658283">func</span>&nbsp;<span class="ident" id="5658288">readDirectoryHeader</span><span class="op" id="5658307">(</span><span class="ident" id="5658308">f</span>&nbsp;<span class="op" id="5658310">*</span><span class="ident" id="5658311"><a href="/gostd/archive/zip/reader.go.html#5653616">File</a></span><span class="op" id="5658315">,</span>&nbsp;<span class="ident" id="5658317">r</span>&nbsp;<span class="ident" id="5658319"><a href="/gostd/archive/zip/reader.go.html#5653287">io</a></span><span class="op" id="5658321">.</span><span class="ident" id="5658322"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="5658328">)</span>&nbsp;<span class="builtintype" id="5658330">error</span>&nbsp;<span class="op" id="5658336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5658339">var</span>&nbsp;<span class="ident" id="5658343">buf</span>&nbsp;<span class="op" id="5658347">[</span><span class="ident" id="5658348"><a href="/gostd/archive/zip/struct.go.html#5669256">directoryHeaderLen</a></span><span class="op" id="5658366">]</span><span class="builtintype" id="5658367">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5658373">if</span>&nbsp;<span class="ident" id="5658376">_</span><span class="op" id="5658377">,</span>&nbsp;<span class="ident" id="5658379">err</span>&nbsp;<span class="op" id="5658383">:=</span>&nbsp;<span class="ident" id="5658386"><a href="/gostd/archive/zip/reader.go.html#5653287">io</a></span><span class="op" id="5658388">.</span><span class="ident" id="5658389"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="5658397">(</span><span class="ident" id="5658398"><a href="/gostd/archive/zip/reader.go.html#5658317">r</a></span><span class="op" id="5658399">,</span>&nbsp;<span class="ident" id="5658401"><a href="/gostd/archive/zip/reader.go.html#5658343">buf</a></span><span class="op" id="5658404">[</span><span class="op" id="5658405">:</span><span class="op" id="5658406">]</span><span class="op" id="5658407">)</span><span class="op" id="5658408">;</span>&nbsp;<span class="ident" id="5658410"><a href="/gostd/archive/zip/reader.go.html#5658379">err</a></span>&nbsp;<span class="op" id="5658414">!=</span>&nbsp;<span class="builtintype" id="5658417">nil</span>&nbsp;<span class="op" id="5658421">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5658425">return</span>&nbsp;<span class="ident" id="5658432"><a href="/gostd/archive/zip/reader.go.html#5658379">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5658437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5658440">b</span>&nbsp;<span class="op" id="5658442">:=</span>&nbsp;<span class="ident" id="5658445"><a href="/gostd/archive/zip/reader.go.html#5665121">readBuf</a></span><span class="op" id="5658452">(</span><span class="ident" id="5658453"><a href="/gostd/archive/zip/reader.go.html#5658343">buf</a></span><span class="op" id="5658456">[</span><span class="op" id="5658457">:</span><span class="op" id="5658458">]</span><span class="op" id="5658459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5658462">if</span>&nbsp;<span class="ident" id="5658465">sig</span>&nbsp;<span class="op" id="5658469">:=</span>&nbsp;<span class="ident" id="5658472"><a href="/gostd/archive/zip/reader.go.html#5658440">b</a></span><span class="op" id="5658473">.</span><span class="builtintype" id="5658474"><a href="/gostd/archive/zip/reader.go.html#5665256">uint32</a></span><span class="op" id="5658480">(</span><span class="op" id="5658481">)</span><span class="op" id="5658482">;</span>&nbsp;<span class="ident" id="5658484"><a href="/gostd/archive/zip/reader.go.html#5658465">sig</a></span>&nbsp;<span class="op" id="5658488">!=</span>&nbsp;<span class="ident" id="5658491"><a href="/gostd/archive/zip/struct.go.html#5668954">directoryHeaderSignature</a></span>&nbsp;<span class="op" id="5658516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5658520">return</span>&nbsp;<span class="ident" id="5658527"><a href="/gostd/archive/zip/reader.go.html#5653308">ErrFormat</a></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5658538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5658541"><a href="/gostd/archive/zip/reader.go.html#5658308">f</a></span><span class="op" id="5658542">.</span><span class="ident" id="5658543"><a href="/gostd/archive/zip/struct.go.html#5670382">CreatorVersion</a></span>&nbsp;<span class="op" id="5658558">=</span>&nbsp;<span class="ident" id="5658560"><a href="/gostd/archive/zip/reader.go.html#5658440">b</a></span><span class="op" id="5658561">.</span><span class="builtintype" id="5658562"><a href="/gostd/archive/zip/reader.go.html#5665155">uint16</a></span><span class="op" id="5658568">(</span><span class="op" id="5658569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5658572"><a href="/gostd/archive/zip/reader.go.html#5658308">f</a></span><span class="op" id="5658573">.</span><span class="ident" id="5658574"><a href="/gostd/archive/zip/struct.go.html#5670409">ReaderVersion</a></span>&nbsp;<span class="op" id="5658588">=</span>&nbsp;<span class="ident" id="5658590"><a href="/gostd/archive/zip/reader.go.html#5658440">b</a></span><span class="op" id="5658591">.</span><span class="builtintype" id="5658592"><a href="/gostd/archive/zip/reader.go.html#5665155">uint16</a></span><span class="op" id="5658598">(</span><span class="op" id="5658599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5658602"><a href="/gostd/archive/zip/reader.go.html#5658308">f</a></span><span class="op" id="5658603">.</span><span class="ident" id="5658604"><a href="/gostd/archive/zip/struct.go.html#5670436">Flags</a></span>&nbsp;<span class="op" id="5658610">=</span>&nbsp;<span class="ident" id="5658612"><a href="/gostd/archive/zip/reader.go.html#5658440">b</a></span><span class="op" id="5658613">.</span><span class="builtintype" id="5658614"><a href="/gostd/archive/zip/reader.go.html#5665155">uint16</a></span><span class="op" id="5658620">(</span><span class="op" id="5658621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5658624"><a href="/gostd/archive/zip/reader.go.html#5658308">f</a></span><span class="op" id="5658625">.</span><span class="ident" id="5658626"><a href="/gostd/archive/zip/struct.go.html#5670463">Method</a></span>&nbsp;<span class="op" id="5658633">=</span>&nbsp;<span class="ident" id="5658635"><a href="/gostd/archive/zip/reader.go.html#5658440">b</a></span><span class="op" id="5658636">.</span><span class="builtintype" id="5658637"><a href="/gostd/archive/zip/reader.go.html#5665155">uint16</a></span><span class="op" id="5658643">(</span><span class="op" id="5658644">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5658647"><a href="/gostd/archive/zip/reader.go.html#5658308">f</a></span><span class="op" id="5658648">.</span><span class="ident" id="5658649"><a href="/gostd/archive/zip/struct.go.html#5670490">ModifiedTime</a></span>&nbsp;<span class="op" id="5658662">=</span>&nbsp;<span class="ident" id="5658664"><a href="/gostd/archive/zip/reader.go.html#5658440">b</a></span><span class="op" id="5658665">.</span><span class="builtintype" id="5658666"><a href="/gostd/archive/zip/reader.go.html#5665155">uint16</a></span><span class="op" id="5658672">(</span><span class="op" id="5658673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5658676"><a href="/gostd/archive/zip/reader.go.html#5658308">f</a></span><span class="op" id="5658677">.</span><span class="ident" id="5658678"><a href="/gostd/archive/zip/struct.go.html#5670532">ModifiedDate</a></span>&nbsp;<span class="op" id="5658691">=</span>&nbsp;<span class="ident" id="5658693"><a href="/gostd/archive/zip/reader.go.html#5658440">b</a></span><span class="op" id="5658694">.</span><span class="builtintype" id="5658695"><a href="/gostd/archive/zip/reader.go.html#5665155">uint16</a></span><span class="op" id="5658701">(</span><span class="op" id="5658702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5658705"><a href="/gostd/archive/zip/reader.go.html#5658308">f</a></span><span class="op" id="5658706">.</span><span class="ident" id="5658707"><a href="/gostd/archive/zip/struct.go.html#5670574">CRC32</a></span>&nbsp;<span class="op" id="5658713">=</span>&nbsp;<span class="ident" id="5658715"><a href="/gostd/archive/zip/reader.go.html#5658440">b</a></span><span class="op" id="5658716">.</span><span class="builtintype" id="5658717"><a href="/gostd/archive/zip/reader.go.html#5665256">uint32</a></span><span class="op" id="5658723">(</span><span class="op" id="5658724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5658727"><a href="/gostd/archive/zip/reader.go.html#5658308">f</a></span><span class="op" id="5658728">.</span><span class="ident" id="5658729"><a href="/gostd/archive/zip/struct.go.html#5670601">CompressedSize</a></span>&nbsp;<span class="op" id="5658744">=</span>&nbsp;<span class="ident" id="5658746"><a href="/gostd/archive/zip/reader.go.html#5658440">b</a></span><span class="op" id="5658747">.</span><span class="builtintype" id="5658748"><a href="/gostd/archive/zip/reader.go.html#5665256">uint32</a></span><span class="op" id="5658754">(</span><span class="op" id="5658755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5658758"><a href="/gostd/archive/zip/reader.go.html#5658308">f</a></span><span class="op" id="5658759">.</span><span class="ident" id="5658760"><a href="/gostd/archive/zip/struct.go.html#5670664">UncompressedSize</a></span>&nbsp;<span class="op" id="5658777">=</span>&nbsp;<span class="ident" id="5658779"><a href="/gostd/archive/zip/reader.go.html#5658440">b</a></span><span class="op" id="5658780">.</span><span class="builtintype" id="5658781"><a href="/gostd/archive/zip/reader.go.html#5665256">uint32</a></span><span class="op" id="5658787">(</span><span class="op" id="5658788">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5658791"><a href="/gostd/archive/zip/reader.go.html#5658308">f</a></span><span class="op" id="5658792">.</span><span class="ident" id="5658793"><a href="/gostd/archive/zip/struct.go.html#5670729">CompressedSize64</a></span>&nbsp;<span class="op" id="5658810">=</span>&nbsp;<span class="builtintype" id="5658812">uint64</span><span class="op" id="5658818">(</span><span class="ident" id="5658819"><a href="/gostd/archive/zip/reader.go.html#5658308">f</a></span><span class="op" id="5658820">.</span><span class="ident" id="5658821"><a href="/gostd/archive/zip/struct.go.html#5670601">CompressedSize</a></span><span class="op" id="5658835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5658838"><a href="/gostd/archive/zip/reader.go.html#5658308">f</a></span><span class="op" id="5658839">.</span><span class="ident" id="5658840"><a href="/gostd/archive/zip/struct.go.html#5670756">UncompressedSize64</a></span>&nbsp;<span class="op" id="5658859">=</span>&nbsp;<span class="builtintype" id="5658861">uint64</span><span class="op" id="5658867">(</span><span class="ident" id="5658868"><a href="/gostd/archive/zip/reader.go.html#5658308">f</a></span><span class="op" id="5658869">.</span><span class="ident" id="5658870"><a href="/gostd/archive/zip/struct.go.html#5670664">UncompressedSize</a></span><span class="op" id="5658886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5658889">filenameLen</span>&nbsp;<span class="op" id="5658901">:=</span>&nbsp;<span class="builtintype" id="5658904">int</span><span class="op" id="5658907">(</span><span class="ident" id="5658908"><a href="/gostd/archive/zip/reader.go.html#5658440">b</a></span><span class="op" id="5658909">.</span><span class="builtintype" id="5658910"><a href="/gostd/archive/zip/reader.go.html#5665155">uint16</a></span><span class="op" id="5658916">(</span><span class="op" id="5658917">)</span><span class="op" id="5658918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5658921">extraLen</span>&nbsp;<span class="op" id="5658930">:=</span>&nbsp;<span class="builtintype" id="5658933">int</span><span class="op" id="5658936">(</span><span class="ident" id="5658937"><a href="/gostd/archive/zip/reader.go.html#5658440">b</a></span><span class="op" id="5658938">.</span><span class="builtintype" id="5658939"><a href="/gostd/archive/zip/reader.go.html#5665155">uint16</a></span><span class="op" id="5658945">(</span><span class="op" id="5658946">)</span><span class="op" id="5658947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5658950">commentLen</span>&nbsp;<span class="op" id="5658961">:=</span>&nbsp;<span class="builtintype" id="5658964">int</span><span class="op" id="5658967">(</span><span class="ident" id="5658968"><a href="/gostd/archive/zip/reader.go.html#5658440">b</a></span><span class="op" id="5658969">.</span><span class="builtintype" id="5658970"><a href="/gostd/archive/zip/reader.go.html#5665155">uint16</a></span><span class="op" id="5658976">(</span><span class="op" id="5658977">)</span><span class="op" id="5658978">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5658981"><a href="/gostd/archive/zip/reader.go.html#5658440">b</a></span>&nbsp;<span class="op" id="5658983">=</span>&nbsp;<span class="ident" id="5658985"><a href="/gostd/archive/zip/reader.go.html#5658440">b</a></span><span class="op" id="5658986">[</span><span class="num" id="5658987">4</span><span class="op" id="5658988">:</span><span class="op" id="5658989">]</span>&nbsp;<span class="comment" id="5658991">//&nbsp;skipped&nbsp;start&nbsp;disk&nbsp;number&nbsp;and&nbsp;internal&nbsp;attributes&nbsp;(2x&nbsp;uint16)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5659057"><a href="/gostd/archive/zip/reader.go.html#5658308">f</a></span><span class="op" id="5659058">.</span><span class="ident" id="5659059"><a href="/gostd/archive/zip/struct.go.html#5670810">ExternalAttrs</a></span>&nbsp;<span class="op" id="5659073">=</span>&nbsp;<span class="ident" id="5659075"><a href="/gostd/archive/zip/reader.go.html#5658440">b</a></span><span class="op" id="5659076">.</span><span class="builtintype" id="5659077"><a href="/gostd/archive/zip/reader.go.html#5665256">uint32</a></span><span class="op" id="5659083">(</span><span class="op" id="5659084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5659087"><a href="/gostd/archive/zip/reader.go.html#5658308">f</a></span><span class="op" id="5659088">.</span><span class="ident" id="5659089"><a href="/gostd/archive/zip/reader.go.html#5653689">headerOffset</a></span>&nbsp;<span class="op" id="5659102">=</span>&nbsp;<span class="builtintype" id="5659104">int64</span><span class="op" id="5659109">(</span><span class="ident" id="5659110"><a href="/gostd/archive/zip/reader.go.html#5658440">b</a></span><span class="op" id="5659111">.</span><span class="builtintype" id="5659112"><a href="/gostd/archive/zip/reader.go.html#5665256">uint32</a></span><span class="op" id="5659118">(</span><span class="op" id="5659119">)</span><span class="op" id="5659120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5659123">d</span>&nbsp;<span class="op" id="5659125">:=</span>&nbsp;<span class="builtinfunc" id="5659128">make</span><span class="op" id="5659132">(</span><span class="op" id="5659133">[</span><span class="op" id="5659134">]</span><span class="builtintype" id="5659135">byte</span><span class="op" id="5659139">,</span>&nbsp;<span class="ident" id="5659141"><a href="/gostd/archive/zip/reader.go.html#5658889">filenameLen</a></span><span class="op" id="5659152">+</span><span class="ident" id="5659153"><a href="/gostd/archive/zip/reader.go.html#5658921">extraLen</a></span><span class="op" id="5659161">+</span><span class="ident" id="5659162"><a href="/gostd/archive/zip/reader.go.html#5658950">commentLen</a></span><span class="op" id="5659172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5659175">if</span>&nbsp;<span class="ident" id="5659178">_</span><span class="op" id="5659179">,</span>&nbsp;<span class="ident" id="5659181">err</span>&nbsp;<span class="op" id="5659185">:=</span>&nbsp;<span class="ident" id="5659188"><a href="/gostd/archive/zip/reader.go.html#5653287">io</a></span><span class="op" id="5659190">.</span><span class="ident" id="5659191"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="5659199">(</span><span class="ident" id="5659200"><a href="/gostd/archive/zip/reader.go.html#5658317">r</a></span><span class="op" id="5659201">,</span>&nbsp;<span class="ident" id="5659203"><a href="/gostd/archive/zip/reader.go.html#5659123">d</a></span><span class="op" id="5659204">)</span><span class="op" id="5659205">;</span>&nbsp;<span class="ident" id="5659207"><a href="/gostd/archive/zip/reader.go.html#5659181">err</a></span>&nbsp;<span class="op" id="5659211">!=</span>&nbsp;<span class="builtintype" id="5659214">nil</span>&nbsp;<span class="op" id="5659218">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5659222">return</span>&nbsp;<span class="ident" id="5659229"><a href="/gostd/archive/zip/reader.go.html#5659181">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5659234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5659237"><a href="/gostd/archive/zip/reader.go.html#5658308">f</a></span><span class="op" id="5659238">.</span><span class="ident" id="5659239"><a href="/gostd/archive/zip/struct.go.html#5670368">Name</a></span>&nbsp;<span class="op" id="5659244">=</span>&nbsp;<span class="builtintype" id="5659246">string</span><span class="op" id="5659252">(</span><span class="ident" id="5659253"><a href="/gostd/archive/zip/reader.go.html#5659123">d</a></span><span class="op" id="5659254">[</span><span class="op" id="5659255">:</span><span class="ident" id="5659256"><a href="/gostd/archive/zip/reader.go.html#5658889">filenameLen</a></span><span class="op" id="5659267">]</span><span class="op" id="5659268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5659271"><a href="/gostd/archive/zip/reader.go.html#5658308">f</a></span><span class="op" id="5659272">.</span><span class="ident" id="5659273"><a href="/gostd/archive/zip/struct.go.html#5670783">Extra</a></span>&nbsp;<span class="op" id="5659279">=</span>&nbsp;<span class="ident" id="5659281"><a href="/gostd/archive/zip/reader.go.html#5659123">d</a></span><span class="op" id="5659282">[</span><span class="ident" id="5659283"><a href="/gostd/archive/zip/reader.go.html#5658889">filenameLen</a></span>&nbsp;<span class="op" id="5659295">:</span>&nbsp;<span class="ident" id="5659297"><a href="/gostd/archive/zip/reader.go.html#5658889">filenameLen</a></span><span class="op" id="5659308">+</span><span class="ident" id="5659309"><a href="/gostd/archive/zip/reader.go.html#5658921">extraLen</a></span><span class="op" id="5659317">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5659320"><a href="/gostd/archive/zip/reader.go.html#5658308">f</a></span><span class="op" id="5659321">.</span><span class="ident" id="5659322"><a href="/gostd/archive/zip/struct.go.html#5670874">Comment</a></span>&nbsp;<span class="op" id="5659330">=</span>&nbsp;<span class="builtintype" id="5659332">string</span><span class="op" id="5659338">(</span><span class="ident" id="5659339"><a href="/gostd/archive/zip/reader.go.html#5659123">d</a></span><span class="op" id="5659340">[</span><span class="ident" id="5659341"><a href="/gostd/archive/zip/reader.go.html#5658889">filenameLen</a></span><span class="op" id="5659352">+</span><span class="ident" id="5659353"><a href="/gostd/archive/zip/reader.go.html#5658921">extraLen</a></span><span class="op" id="5659361">:</span><span class="op" id="5659362">]</span><span class="op" id="5659363">)</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5659367">if</span>&nbsp;<span class="builtinfunc" id="5659370">len</span><span class="op" id="5659373">(</span><span class="ident" id="5659374"><a href="/gostd/archive/zip/reader.go.html#5658308">f</a></span><span class="op" id="5659375">.</span><span class="ident" id="5659376"><a href="/gostd/archive/zip/struct.go.html#5670783">Extra</a></span><span class="op" id="5659381">)</span>&nbsp;<span class="op" id="5659383">&gt;</span>&nbsp;<span class="num" id="5659385">0</span>&nbsp;<span class="op" id="5659387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5659391">b</span>&nbsp;<span class="op" id="5659393">:=</span>&nbsp;<span class="ident" id="5659396"><a href="/gostd/archive/zip/reader.go.html#5665121">readBuf</a></span><span class="op" id="5659403">(</span><span class="ident" id="5659404"><a href="/gostd/archive/zip/reader.go.html#5658308">f</a></span><span class="op" id="5659405">.</span><span class="ident" id="5659406"><a href="/gostd/archive/zip/struct.go.html#5670783">Extra</a></span><span class="op" id="5659411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5659415">for</span>&nbsp;<span class="builtinfunc" id="5659419">len</span><span class="op" id="5659422">(</span><span class="ident" id="5659423"><a href="/gostd/archive/zip/reader.go.html#5659391">b</a></span><span class="op" id="5659424">)</span>&nbsp;<span class="op" id="5659426">&gt;=</span>&nbsp;<span class="num" id="5659429">4</span>&nbsp;<span class="op" id="5659431">{</span>&nbsp;<span class="comment" id="5659433">//&nbsp;need&nbsp;at&nbsp;least&nbsp;tag&nbsp;and&nbsp;size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5659466">tag</span>&nbsp;<span class="op" id="5659470">:=</span>&nbsp;<span class="ident" id="5659473"><a href="/gostd/archive/zip/reader.go.html#5659391">b</a></span><span class="op" id="5659474">.</span><span class="builtintype" id="5659475"><a href="/gostd/archive/zip/reader.go.html#5665155">uint16</a></span><span class="op" id="5659481">(</span><span class="op" id="5659482">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5659487">size</span>&nbsp;<span class="op" id="5659492">:=</span>&nbsp;<span class="ident" id="5659495"><a href="/gostd/archive/zip/reader.go.html#5659391">b</a></span><span class="op" id="5659496">.</span><span class="builtintype" id="5659497"><a href="/gostd/archive/zip/reader.go.html#5665155">uint16</a></span><span class="op" id="5659503">(</span><span class="op" id="5659504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5659509">if</span>&nbsp;<span class="builtintype" id="5659512">int</span><span class="op" id="5659515">(</span><span class="ident" id="5659516"><a href="/gostd/archive/zip/reader.go.html#5659487">size</a></span><span class="op" id="5659520">)</span>&nbsp;<span class="op" id="5659522">&gt;</span>&nbsp;<span class="builtinfunc" id="5659524">len</span><span class="op" id="5659527">(</span><span class="ident" id="5659528"><a href="/gostd/archive/zip/reader.go.html#5659391">b</a></span><span class="op" id="5659529">)</span>&nbsp;<span class="op" id="5659531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5659537">return</span>&nbsp;<span class="ident" id="5659544"><a href="/gostd/archive/zip/reader.go.html#5653308">ErrFormat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5659557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5659562">if</span>&nbsp;<span class="ident" id="5659565"><a href="/gostd/archive/zip/reader.go.html#5659466">tag</a></span>&nbsp;<span class="op" id="5659569">==</span>&nbsp;<span class="ident" id="5659572"><a href="/gostd/archive/zip/struct.go.html#5670014">zip64ExtraId</a></span>&nbsp;<span class="op" id="5659585">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5659591">//&nbsp;update&nbsp;directory&nbsp;values&nbsp;from&nbsp;the&nbsp;zip64&nbsp;extra&nbsp;block</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5659649">eb</span>&nbsp;<span class="op" id="5659652">:=</span>&nbsp;<span class="ident" id="5659655"><a href="/gostd/archive/zip/reader.go.html#5665121">readBuf</a></span><span class="op" id="5659662">(</span><span class="ident" id="5659663"><a href="/gostd/archive/zip/reader.go.html#5659391">b</a></span><span class="op" id="5659664">[</span><span class="op" id="5659665">:</span><span class="ident" id="5659666"><a href="/gostd/archive/zip/reader.go.html#5659487">size</a></span><span class="op" id="5659670">]</span><span class="op" id="5659671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5659677">if</span>&nbsp;<span class="builtinfunc" id="5659680">len</span><span class="op" id="5659683">(</span><span class="ident" id="5659684"><a href="/gostd/archive/zip/reader.go.html#5659649">eb</a></span><span class="op" id="5659686">)</span>&nbsp;<span class="op" id="5659688">&gt;=</span>&nbsp;<span class="num" id="5659691">8</span>&nbsp;<span class="op" id="5659693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5659700"><a href="/gostd/archive/zip/reader.go.html#5658308">f</a></span><span class="op" id="5659701">.</span><span class="ident" id="5659702"><a href="/gostd/archive/zip/struct.go.html#5670756">UncompressedSize64</a></span>&nbsp;<span class="op" id="5659721">=</span>&nbsp;<span class="ident" id="5659723"><a href="/gostd/archive/zip/reader.go.html#5659649">eb</a></span><span class="op" id="5659725">.</span><span class="builtintype" id="5659726"><a href="/gostd/archive/zip/reader.go.html#5665357">uint64</a></span><span class="op" id="5659732">(</span><span class="op" id="5659733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5659739">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5659745">if</span>&nbsp;<span class="builtinfunc" id="5659748">len</span><span class="op" id="5659751">(</span><span class="ident" id="5659752"><a href="/gostd/archive/zip/reader.go.html#5659649">eb</a></span><span class="op" id="5659754">)</span>&nbsp;<span class="op" id="5659756">&gt;=</span>&nbsp;<span class="num" id="5659759">8</span>&nbsp;<span class="op" id="5659761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5659768"><a href="/gostd/archive/zip/reader.go.html#5658308">f</a></span><span class="op" id="5659769">.</span><span class="ident" id="5659770"><a href="/gostd/archive/zip/struct.go.html#5670729">CompressedSize64</a></span>&nbsp;<span class="op" id="5659787">=</span>&nbsp;<span class="ident" id="5659789"><a href="/gostd/archive/zip/reader.go.html#5659649">eb</a></span><span class="op" id="5659791">.</span><span class="builtintype" id="5659792"><a href="/gostd/archive/zip/reader.go.html#5665357">uint64</a></span><span class="op" id="5659798">(</span><span class="op" id="5659799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5659805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5659811">if</span>&nbsp;<span class="builtinfunc" id="5659814">len</span><span class="op" id="5659817">(</span><span class="ident" id="5659818"><a href="/gostd/archive/zip/reader.go.html#5659649">eb</a></span><span class="op" id="5659820">)</span>&nbsp;<span class="op" id="5659822">&gt;=</span>&nbsp;<span class="num" id="5659825">8</span>&nbsp;<span class="op" id="5659827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5659834"><a href="/gostd/archive/zip/reader.go.html#5658308">f</a></span><span class="op" id="5659835">.</span><span class="ident" id="5659836"><a href="/gostd/archive/zip/reader.go.html#5653689">headerOffset</a></span>&nbsp;<span class="op" id="5659849">=</span>&nbsp;<span class="builtintype" id="5659851">int64</span><span class="op" id="5659856">(</span><span class="ident" id="5659857"><a href="/gostd/archive/zip/reader.go.html#5659649">eb</a></span><span class="op" id="5659859">.</span><span class="builtintype" id="5659860"><a href="/gostd/archive/zip/reader.go.html#5665357">uint64</a></span><span class="op" id="5659866">(</span><span class="op" id="5659867">)</span><span class="op" id="5659868">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5659874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5659879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5659884"><a href="/gostd/archive/zip/reader.go.html#5659391">b</a></span>&nbsp;<span class="op" id="5659886">=</span>&nbsp;<span class="ident" id="5659888"><a href="/gostd/archive/zip/reader.go.html#5659391">b</a></span><span class="op" id="5659889">[</span><span class="ident" id="5659890"><a href="/gostd/archive/zip/reader.go.html#5659487">size</a></span><span class="op" id="5659894">:</span><span class="op" id="5659895">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5659899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5659903">//&nbsp;Should&nbsp;have&nbsp;consumed&nbsp;the&nbsp;whole&nbsp;header.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5659947">//&nbsp;But&nbsp;popular&nbsp;zip&nbsp;&amp;&nbsp;JAR&nbsp;creation&nbsp;tools&nbsp;are&nbsp;broken&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5660004">//&nbsp;may&nbsp;pad&nbsp;extra&nbsp;zeros&nbsp;at&nbsp;the&nbsp;end,&nbsp;so&nbsp;accept&nbsp;those</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5660057">//&nbsp;too.&nbsp;See&nbsp;golang.org/issue/8186.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5660094">for</span>&nbsp;<span class="ident" id="5660098">_</span><span class="op" id="5660099">,</span>&nbsp;<span class="ident" id="5660101">v</span>&nbsp;<span class="op" id="5660103">:=</span>&nbsp;<span class="keyword" id="5660106">range</span>&nbsp;<span class="ident" id="5660112"><a href="/gostd/archive/zip/reader.go.html#5659391">b</a></span>&nbsp;<span class="op" id="5660114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5660119">if</span>&nbsp;<span class="ident" id="5660122"><a href="/gostd/archive/zip/reader.go.html#5660101">v</a></span>&nbsp;<span class="op" id="5660124">!=</span>&nbsp;<span class="num" id="5660127">0</span>&nbsp;<span class="op" id="5660129">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5660135">return</span>&nbsp;<span class="ident" id="5660142"><a href="/gostd/archive/zip/reader.go.html#5653308">ErrFormat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5660155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5660159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5660162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5660165">return</span>&nbsp;<span class="builtintype" id="5660172">nil</span><br>
<span class="lineno">280</span><span class="op" id="5660176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5660179">func</span>&nbsp;<span class="ident" id="5660184">readDataDescriptor</span><span class="op" id="5660202">(</span><span class="ident" id="5660203">r</span>&nbsp;<span class="ident" id="5660205"><a href="/gostd/archive/zip/reader.go.html#5653287">io</a></span><span class="op" id="5660207">.</span><span class="ident" id="5660208"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="5660214">,</span>&nbsp;<span class="ident" id="5660216">f</span>&nbsp;<span class="op" id="5660218">*</span><span class="ident" id="5660219"><a href="/gostd/archive/zip/reader.go.html#5653616">File</a></span><span class="op" id="5660223">)</span>&nbsp;<span class="builtintype" id="5660225">error</span>&nbsp;<span class="op" id="5660231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5660234">var</span>&nbsp;<span class="ident" id="5660238">buf</span>&nbsp;<span class="op" id="5660242">[</span><span class="ident" id="5660243"><a href="/gostd/archive/zip/struct.go.html#5669379">dataDescriptorLen</a></span><span class="op" id="5660260">]</span><span class="builtintype" id="5660261">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5660268">//&nbsp;The&nbsp;spec&nbsp;says:&nbsp;&#34;Although&nbsp;not&nbsp;originally&nbsp;assigned&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5660323">//&nbsp;signature,&nbsp;the&nbsp;value&nbsp;0x08074b50&nbsp;has&nbsp;commonly&nbsp;been&nbsp;adopted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5660385">//&nbsp;as&nbsp;a&nbsp;signature&nbsp;value&nbsp;for&nbsp;the&nbsp;data&nbsp;descriptor&nbsp;record.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5660442">//&nbsp;Implementers&nbsp;should&nbsp;be&nbsp;aware&nbsp;that&nbsp;ZIP&nbsp;files&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5660497">//&nbsp;encountered&nbsp;with&nbsp;or&nbsp;without&nbsp;this&nbsp;signature&nbsp;marking&nbsp;data</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5660557">//&nbsp;descriptors&nbsp;and&nbsp;should&nbsp;account&nbsp;for&nbsp;either&nbsp;case&nbsp;when&nbsp;reading</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5660621">//&nbsp;ZIP&nbsp;files&nbsp;to&nbsp;ensure&nbsp;compatibility.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5660661">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5660665">//&nbsp;dataDescriptorLen&nbsp;includes&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;signature&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5660726">//&nbsp;first&nbsp;read&nbsp;just&nbsp;those&nbsp;4&nbsp;bytes&nbsp;to&nbsp;see&nbsp;if&nbsp;it&nbsp;exists.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5660781">if</span>&nbsp;<span class="ident" id="5660784">_</span><span class="op" id="5660785">,</span>&nbsp;<span class="ident" id="5660787">err</span>&nbsp;<span class="op" id="5660791">:=</span>&nbsp;<span class="ident" id="5660794"><a href="/gostd/archive/zip/reader.go.html#5653287">io</a></span><span class="op" id="5660796">.</span><span class="ident" id="5660797"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="5660805">(</span><span class="ident" id="5660806"><a href="/gostd/archive/zip/reader.go.html#5660203">r</a></span><span class="op" id="5660807">,</span>&nbsp;<span class="ident" id="5660809"><a href="/gostd/archive/zip/reader.go.html#5660238">buf</a></span><span class="op" id="5660812">[</span><span class="op" id="5660813">:</span><span class="num" id="5660814">4</span><span class="op" id="5660815">]</span><span class="op" id="5660816">)</span><span class="op" id="5660817">;</span>&nbsp;<span class="ident" id="5660819"><a href="/gostd/archive/zip/reader.go.html#5660787">err</a></span>&nbsp;<span class="op" id="5660823">!=</span>&nbsp;<span class="builtintype" id="5660826">nil</span>&nbsp;<span class="op" id="5660830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5660834">return</span>&nbsp;<span class="ident" id="5660841"><a href="/gostd/archive/zip/reader.go.html#5660787">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5660846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5660849">off</span>&nbsp;<span class="op" id="5660853">:=</span>&nbsp;<span class="num" id="5660856">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5660859">maybeSig</span>&nbsp;<span class="op" id="5660868">:=</span>&nbsp;<span class="ident" id="5660871"><a href="/gostd/archive/zip/reader.go.html#5665121">readBuf</a></span><span class="op" id="5660878">(</span><span class="ident" id="5660879"><a href="/gostd/archive/zip/reader.go.html#5660238">buf</a></span><span class="op" id="5660882">[</span><span class="op" id="5660883">:</span><span class="num" id="5660884">4</span><span class="op" id="5660885">]</span><span class="op" id="5660886">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5660889">if</span>&nbsp;<span class="ident" id="5660892"><a href="/gostd/archive/zip/reader.go.html#5660859">maybeSig</a></span><span class="op" id="5660900">.</span><span class="builtintype" id="5660901"><a href="/gostd/archive/zip/reader.go.html#5665256">uint32</a></span><span class="op" id="5660907">(</span><span class="op" id="5660908">)</span>&nbsp;<span class="op" id="5660910">!=</span>&nbsp;<span class="ident" id="5660913"><a href="/gostd/archive/zip/struct.go.html#5669110">dataDescriptorSignature</a></span>&nbsp;<span class="op" id="5660937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5660941">//&nbsp;No&nbsp;data&nbsp;descriptor&nbsp;signature.&nbsp;Keep&nbsp;these&nbsp;four</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5660992">//&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5661004"><a href="/gostd/archive/zip/reader.go.html#5660849">off</a></span>&nbsp;<span class="op" id="5661008">+=</span>&nbsp;<span class="num" id="5661011">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5661014">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5661017">if</span>&nbsp;<span class="ident" id="5661020">_</span><span class="op" id="5661021">,</span>&nbsp;<span class="ident" id="5661023">err</span>&nbsp;<span class="op" id="5661027">:=</span>&nbsp;<span class="ident" id="5661030"><a href="/gostd/archive/zip/reader.go.html#5653287">io</a></span><span class="op" id="5661032">.</span><span class="ident" id="5661033"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="5661041">(</span><span class="ident" id="5661042"><a href="/gostd/archive/zip/reader.go.html#5660203">r</a></span><span class="op" id="5661043">,</span>&nbsp;<span class="ident" id="5661045"><a href="/gostd/archive/zip/reader.go.html#5660238">buf</a></span><span class="op" id="5661048">[</span><span class="ident" id="5661049"><a href="/gostd/archive/zip/reader.go.html#5660849">off</a></span><span class="op" id="5661052">:</span><span class="num" id="5661053">12</span><span class="op" id="5661055">]</span><span class="op" id="5661056">)</span><span class="op" id="5661057">;</span>&nbsp;<span class="ident" id="5661059"><a href="/gostd/archive/zip/reader.go.html#5661023">err</a></span>&nbsp;<span class="op" id="5661063">!=</span>&nbsp;<span class="builtintype" id="5661066">nil</span>&nbsp;<span class="op" id="5661070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5661074">return</span>&nbsp;<span class="ident" id="5661081"><a href="/gostd/archive/zip/reader.go.html#5661023">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5661086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5661089">b</span>&nbsp;<span class="op" id="5661091">:=</span>&nbsp;<span class="ident" id="5661094"><a href="/gostd/archive/zip/reader.go.html#5665121">readBuf</a></span><span class="op" id="5661101">(</span><span class="ident" id="5661102"><a href="/gostd/archive/zip/reader.go.html#5660238">buf</a></span><span class="op" id="5661105">[</span><span class="op" id="5661106">:</span><span class="num" id="5661107">12</span><span class="op" id="5661109">]</span><span class="op" id="5661110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5661113">if</span>&nbsp;<span class="ident" id="5661116"><a href="/gostd/archive/zip/reader.go.html#5661089">b</a></span><span class="op" id="5661117">.</span><span class="builtintype" id="5661118"><a href="/gostd/archive/zip/reader.go.html#5665256">uint32</a></span><span class="op" id="5661124">(</span><span class="op" id="5661125">)</span>&nbsp;<span class="op" id="5661127">!=</span>&nbsp;<span class="ident" id="5661130"><a href="/gostd/archive/zip/reader.go.html#5660216">f</a></span><span class="op" id="5661131">.</span><span class="ident" id="5661132"><a href="/gostd/archive/zip/struct.go.html#5670574">CRC32</a></span>&nbsp;<span class="op" id="5661138">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5661142">return</span>&nbsp;<span class="ident" id="5661149"><a href="/gostd/archive/zip/reader.go.html#5653433">ErrChecksum</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5661162">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5661166">//&nbsp;The&nbsp;two&nbsp;sizes&nbsp;that&nbsp;follow&nbsp;here&nbsp;can&nbsp;be&nbsp;either&nbsp;32&nbsp;bits&nbsp;or&nbsp;64&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5661234">//&nbsp;but&nbsp;the&nbsp;spec&nbsp;is&nbsp;not&nbsp;very&nbsp;clear&nbsp;on&nbsp;this&nbsp;and&nbsp;different</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5661291">//&nbsp;interpretations&nbsp;has&nbsp;been&nbsp;made&nbsp;causing&nbsp;incompatibilities.&nbsp;We</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5661355">//&nbsp;already&nbsp;have&nbsp;the&nbsp;sizes&nbsp;from&nbsp;the&nbsp;central&nbsp;directory&nbsp;so&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5661419">//&nbsp;just&nbsp;ignore&nbsp;these.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5661443">return</span>&nbsp;<span class="builtintype" id="5661450">nil</span><br>
<span class="lineno">320</span><span class="op" id="5661454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5661457">func</span>&nbsp;<span class="ident" id="5661462">readDirectoryEnd</span><span class="op" id="5661478">(</span><span class="ident" id="5661479">r</span>&nbsp;<span class="ident" id="5661481"><a href="/gostd/archive/zip/reader.go.html#5653287">io</a></span><span class="op" id="5661483">.</span><span class="ident" id="5661484"><a href="/gostd/io/io.go.html#1425985">ReaderAt</a></span><span class="op" id="5661492">,</span>&nbsp;<span class="ident" id="5661494">size</span>&nbsp;<span class="builtintype" id="5661499">int64</span><span class="op" id="5661504">)</span>&nbsp;<span class="op" id="5661506">(</span><span class="ident" id="5661507">dir</span>&nbsp;<span class="op" id="5661511">*</span><span class="ident" id="5661512"><a href="/gostd/archive/zip/struct.go.html#5672309">directoryEnd</a></span><span class="op" id="5661524">,</span>&nbsp;<span class="ident" id="5661526">err</span>&nbsp;<span class="builtintype" id="5661530">error</span><span class="op" id="5661535">)</span>&nbsp;<span class="op" id="5661537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5661540">//&nbsp;look&nbsp;for&nbsp;directoryEndSignature&nbsp;in&nbsp;the&nbsp;last&nbsp;1k,&nbsp;then&nbsp;in&nbsp;the&nbsp;last&nbsp;65k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5661612">var</span>&nbsp;<span class="ident" id="5661616">buf</span>&nbsp;<span class="op" id="5661620">[</span><span class="op" id="5661621">]</span><span class="builtintype" id="5661622">byte</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5661628">var</span>&nbsp;<span class="ident" id="5661632">directoryEndOffset</span>&nbsp;<span class="builtintype" id="5661651">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5661658">for</span>&nbsp;<span class="ident" id="5661662">i</span><span class="op" id="5661663">,</span>&nbsp;<span class="ident" id="5661665">bLen</span>&nbsp;<span class="op" id="5661670">:=</span>&nbsp;<span class="keyword" id="5661673">range</span>&nbsp;<span class="op" id="5661679">[</span><span class="op" id="5661680">]</span><span class="builtintype" id="5661681">int64</span><span class="op" id="5661686">{</span><span class="num" id="5661687">1024</span><span class="op" id="5661691">,</span>&nbsp;<span class="num" id="5661693">65</span>&nbsp;<span class="op" id="5661696">*</span>&nbsp;<span class="num" id="5661698">1024</span><span class="op" id="5661702">}</span>&nbsp;<span class="op" id="5661704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5661708">if</span>&nbsp;<span class="ident" id="5661711"><a href="/gostd/archive/zip/reader.go.html#5661665">bLen</a></span>&nbsp;<span class="op" id="5661716">&gt;</span>&nbsp;<span class="ident" id="5661718"><a href="/gostd/archive/zip/reader.go.html#5661494">size</a></span>&nbsp;<span class="op" id="5661723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5661728"><a href="/gostd/archive/zip/reader.go.html#5661665">bLen</a></span>&nbsp;<span class="op" id="5661733">=</span>&nbsp;<span class="ident" id="5661735"><a href="/gostd/archive/zip/reader.go.html#5661494">size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5661742">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5661746"><a href="/gostd/archive/zip/reader.go.html#5661616">buf</a></span>&nbsp;<span class="op" id="5661750">=</span>&nbsp;<span class="builtinfunc" id="5661752">make</span><span class="op" id="5661756">(</span><span class="op" id="5661757">[</span><span class="op" id="5661758">]</span><span class="builtintype" id="5661759">byte</span><span class="op" id="5661763">,</span>&nbsp;<span class="builtintype" id="5661765">int</span><span class="op" id="5661768">(</span><span class="ident" id="5661769"><a href="/gostd/archive/zip/reader.go.html#5661665">bLen</a></span><span class="op" id="5661773">)</span><span class="op" id="5661774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5661778">if</span>&nbsp;<span class="ident" id="5661781">_</span><span class="op" id="5661782">,</span>&nbsp;<span class="ident" id="5661784">err</span>&nbsp;<span class="op" id="5661788">:=</span>&nbsp;<span class="ident" id="5661791"><a href="/gostd/archive/zip/reader.go.html#5661479">r</a></span><span class="op" id="5661792">.</span><span class="ident" id="5661793"><a href="/gostd/io/io.go.html#1426007">ReadAt</a></span><span class="op" id="5661799">(</span><span class="ident" id="5661800"><a href="/gostd/archive/zip/reader.go.html#5661616">buf</a></span><span class="op" id="5661803">,</span>&nbsp;<span class="ident" id="5661805"><a href="/gostd/archive/zip/reader.go.html#5661494">size</a></span><span class="op" id="5661809">-</span><span class="ident" id="5661810"><a href="/gostd/archive/zip/reader.go.html#5661665">bLen</a></span><span class="op" id="5661814">)</span><span class="op" id="5661815">;</span>&nbsp;<span class="ident" id="5661817"><a href="/gostd/archive/zip/reader.go.html#5661784">err</a></span>&nbsp;<span class="op" id="5661821">!=</span>&nbsp;<span class="builtintype" id="5661824">nil</span>&nbsp;<span class="op" id="5661828">&amp;&amp;</span>&nbsp;<span class="ident" id="5661831"><a href="/gostd/archive/zip/reader.go.html#5661784">err</a></span>&nbsp;<span class="op" id="5661835">!=</span>&nbsp;<span class="ident" id="5661838"><a href="/gostd/archive/zip/reader.go.html#5653287">io</a></span><span class="op" id="5661840">.</span><span class="ident" id="5661841"><a href="/gostd/io/io.go.html#1419950">EOF</a></span>&nbsp;<span class="op" id="5661845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5661850">return</span>&nbsp;<span class="builtintype" id="5661857">nil</span><span class="op" id="5661860">,</span>&nbsp;<span class="ident" id="5661862"><a href="/gostd/archive/zip/reader.go.html#5661784">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5661868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5661872">if</span>&nbsp;<span class="ident" id="5661875">p</span>&nbsp;<span class="op" id="5661877">:=</span>&nbsp;<span class="ident" id="5661880"><a href="/gostd/archive/zip/reader.go.html#5664729">findSignatureInBlock</a></span><span class="op" id="5661900">(</span><span class="ident" id="5661901"><a href="/gostd/archive/zip/reader.go.html#5661616">buf</a></span><span class="op" id="5661904">)</span><span class="op" id="5661905">;</span>&nbsp;<span class="ident" id="5661907"><a href="/gostd/archive/zip/reader.go.html#5661875">p</a></span>&nbsp;<span class="op" id="5661909">&gt;=</span>&nbsp;<span class="num" id="5661912">0</span>&nbsp;<span class="op" id="5661914">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5661919"><a href="/gostd/archive/zip/reader.go.html#5661616">buf</a></span>&nbsp;<span class="op" id="5661923">=</span>&nbsp;<span class="ident" id="5661925"><a href="/gostd/archive/zip/reader.go.html#5661616">buf</a></span><span class="op" id="5661928">[</span><span class="ident" id="5661929"><a href="/gostd/archive/zip/reader.go.html#5661875">p</a></span><span class="op" id="5661930">:</span><span class="op" id="5661931">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5661936"><a href="/gostd/archive/zip/reader.go.html#5661632">directoryEndOffset</a></span>&nbsp;<span class="op" id="5661955">=</span>&nbsp;<span class="ident" id="5661957"><a href="/gostd/archive/zip/reader.go.html#5661494">size</a></span>&nbsp;<span class="op" id="5661962">-</span>&nbsp;<span class="ident" id="5661964"><a href="/gostd/archive/zip/reader.go.html#5661665">bLen</a></span>&nbsp;<span class="op" id="5661969">+</span>&nbsp;<span class="builtintype" id="5661971">int64</span><span class="op" id="5661976">(</span><span class="ident" id="5661977"><a href="/gostd/archive/zip/reader.go.html#5661875">p</a></span><span class="op" id="5661978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5661983">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5661991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5661995">if</span>&nbsp;<span class="ident" id="5661998"><a href="/gostd/archive/zip/reader.go.html#5661662">i</a></span>&nbsp;<span class="op" id="5662000">==</span>&nbsp;<span class="num" id="5662003">1</span>&nbsp;<span class="op" id="5662005">||</span>&nbsp;<span class="ident" id="5662008"><a href="/gostd/archive/zip/reader.go.html#5661665">bLen</a></span>&nbsp;<span class="op" id="5662013">==</span>&nbsp;<span class="ident" id="5662016"><a href="/gostd/archive/zip/reader.go.html#5661494">size</a></span>&nbsp;<span class="op" id="5662021">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5662026">return</span>&nbsp;<span class="builtintype" id="5662033">nil</span><span class="op" id="5662036">,</span>&nbsp;<span class="ident" id="5662038"><a href="/gostd/archive/zip/reader.go.html#5653308">ErrFormat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5662050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5662053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5662057">//&nbsp;read&nbsp;header&nbsp;into&nbsp;struct</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5662085">b</span>&nbsp;<span class="op" id="5662087">:=</span>&nbsp;<span class="ident" id="5662090"><a href="/gostd/archive/zip/reader.go.html#5665121">readBuf</a></span><span class="op" id="5662097">(</span><span class="ident" id="5662098"><a href="/gostd/archive/zip/reader.go.html#5661616">buf</a></span><span class="op" id="5662101">[</span><span class="num" id="5662102">4</span><span class="op" id="5662103">:</span><span class="op" id="5662104">]</span><span class="op" id="5662105">)</span>&nbsp;<span class="comment" id="5662107">//&nbsp;skip&nbsp;signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5662126">d</span>&nbsp;<span class="op" id="5662128">:=</span>&nbsp;<span class="op" id="5662131">&amp;</span><span class="ident" id="5662132"><a href="/gostd/archive/zip/struct.go.html#5672309">directoryEnd</a></span><span class="op" id="5662144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5662148"><a href="/gostd/archive/zip/struct.go.html#5672332">diskNbr</a></span><span class="op" id="5662155">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5662168">uint32</span><span class="op" id="5662174">(</span><span class="ident" id="5662175"><a href="/gostd/archive/zip/reader.go.html#5662085">b</a></span><span class="op" id="5662176">.</span><span class="builtintype" id="5662177"><a href="/gostd/archive/zip/reader.go.html#5665155">uint16</a></span><span class="op" id="5662183">(</span><span class="op" id="5662184">)</span><span class="op" id="5662185">)</span><span class="op" id="5662186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5662190"><a href="/gostd/archive/zip/struct.go.html#5672369">dirDiskNbr</a></span><span class="op" id="5662200">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5662210">uint32</span><span class="op" id="5662216">(</span><span class="ident" id="5662217"><a href="/gostd/archive/zip/reader.go.html#5662085">b</a></span><span class="op" id="5662218">.</span><span class="builtintype" id="5662219"><a href="/gostd/archive/zip/reader.go.html#5665155">uint16</a></span><span class="op" id="5662225">(</span><span class="op" id="5662226">)</span><span class="op" id="5662227">)</span><span class="op" id="5662228">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5662232"><a href="/gostd/archive/zip/struct.go.html#5672406">dirRecordsThisDisk</a></span><span class="op" id="5662250">:</span>&nbsp;<span class="builtintype" id="5662252">uint64</span><span class="op" id="5662258">(</span><span class="ident" id="5662259"><a href="/gostd/archive/zip/reader.go.html#5662085">b</a></span><span class="op" id="5662260">.</span><span class="builtintype" id="5662261"><a href="/gostd/archive/zip/reader.go.html#5665155">uint16</a></span><span class="op" id="5662267">(</span><span class="op" id="5662268">)</span><span class="op" id="5662269">)</span><span class="op" id="5662270">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5662274"><a href="/gostd/archive/zip/struct.go.html#5672443">directoryRecords</a></span><span class="op" id="5662290">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5662294">uint64</span><span class="op" id="5662300">(</span><span class="ident" id="5662301"><a href="/gostd/archive/zip/reader.go.html#5662085">b</a></span><span class="op" id="5662302">.</span><span class="builtintype" id="5662303"><a href="/gostd/archive/zip/reader.go.html#5665155">uint16</a></span><span class="op" id="5662309">(</span><span class="op" id="5662310">)</span><span class="op" id="5662311">)</span><span class="op" id="5662312">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5662316"><a href="/gostd/archive/zip/struct.go.html#5672470">directorySize</a></span><span class="op" id="5662329">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5662336">uint64</span><span class="op" id="5662342">(</span><span class="ident" id="5662343"><a href="/gostd/archive/zip/reader.go.html#5662085">b</a></span><span class="op" id="5662344">.</span><span class="builtintype" id="5662345"><a href="/gostd/archive/zip/reader.go.html#5665256">uint32</a></span><span class="op" id="5662351">(</span><span class="op" id="5662352">)</span><span class="op" id="5662353">)</span><span class="op" id="5662354">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5662358"><a href="/gostd/archive/zip/struct.go.html#5672497">directoryOffset</a></span><span class="op" id="5662373">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5662378">uint64</span><span class="op" id="5662384">(</span><span class="ident" id="5662385"><a href="/gostd/archive/zip/reader.go.html#5662085">b</a></span><span class="op" id="5662386">.</span><span class="builtintype" id="5662387"><a href="/gostd/archive/zip/reader.go.html#5665256">uint32</a></span><span class="op" id="5662393">(</span><span class="op" id="5662394">)</span><span class="op" id="5662395">)</span><span class="op" id="5662396">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5662400"><a href="/gostd/archive/zip/struct.go.html#5672544">commentLen</a></span><span class="op" id="5662410">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5662420"><a href="/gostd/archive/zip/reader.go.html#5662085">b</a></span><span class="op" id="5662421">.</span><span class="builtintype" id="5662422"><a href="/gostd/archive/zip/reader.go.html#5665155">uint16</a></span><span class="op" id="5662428">(</span><span class="op" id="5662429">)</span><span class="op" id="5662430">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5662433">}</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5662436">l</span>&nbsp;<span class="op" id="5662438">:=</span>&nbsp;<span class="builtintype" id="5662441">int</span><span class="op" id="5662444">(</span><span class="ident" id="5662445"><a href="/gostd/archive/zip/reader.go.html#5662126">d</a></span><span class="op" id="5662446">.</span><span class="ident" id="5662447"><a href="/gostd/archive/zip/struct.go.html#5672544">commentLen</a></span><span class="op" id="5662457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5662460">if</span>&nbsp;<span class="ident" id="5662463"><a href="/gostd/archive/zip/reader.go.html#5662436">l</a></span>&nbsp;<span class="op" id="5662465">&gt;</span>&nbsp;<span class="builtinfunc" id="5662467">len</span><span class="op" id="5662470">(</span><span class="ident" id="5662471"><a href="/gostd/archive/zip/reader.go.html#5662085">b</a></span><span class="op" id="5662472">)</span>&nbsp;<span class="op" id="5662474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5662478">return</span>&nbsp;<span class="builtintype" id="5662485">nil</span><span class="op" id="5662488">,</span>&nbsp;<span class="ident" id="5662490"><a href="/gostd/archive/zip/reader.go.html#5653255">errors</a></span><span class="op" id="5662496">.</span><span class="ident" id="5662497"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="5662500">(</span><span class="string" id="5662501">&#34;zip:&nbsp;invalid&nbsp;comment&nbsp;length&#34;</span><span class="op" id="5662530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5662533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5662536"><a href="/gostd/archive/zip/reader.go.html#5662126">d</a></span><span class="op" id="5662537">.</span><span class="ident" id="5662538"><a href="/gostd/archive/zip/struct.go.html#5672571">comment</a></span>&nbsp;<span class="op" id="5662546">=</span>&nbsp;<span class="builtintype" id="5662548">string</span><span class="op" id="5662554">(</span><span class="ident" id="5662555"><a href="/gostd/archive/zip/reader.go.html#5662085">b</a></span><span class="op" id="5662556">[</span><span class="op" id="5662557">:</span><span class="ident" id="5662558"><a href="/gostd/archive/zip/reader.go.html#5662436">l</a></span><span class="op" id="5662559">]</span><span class="op" id="5662560">)</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5662564">p</span><span class="op" id="5662565">,</span>&nbsp;<span class="ident" id="5662567"><a href="/gostd/archive/zip/reader.go.html#5661526">err</a></span>&nbsp;<span class="op" id="5662571">:=</span>&nbsp;<span class="ident" id="5662574"><a href="/gostd/archive/zip/reader.go.html#5663040">findDirectory64End</a></span><span class="op" id="5662592">(</span><span class="ident" id="5662593"><a href="/gostd/archive/zip/reader.go.html#5661479">r</a></span><span class="op" id="5662594">,</span>&nbsp;<span class="ident" id="5662596"><a href="/gostd/archive/zip/reader.go.html#5661632">directoryEndOffset</a></span><span class="op" id="5662614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5662617">if</span>&nbsp;<span class="ident" id="5662620"><a href="/gostd/archive/zip/reader.go.html#5661526">err</a></span>&nbsp;<span class="op" id="5662624">==</span>&nbsp;<span class="builtintype" id="5662627">nil</span>&nbsp;<span class="op" id="5662631">&amp;&amp;</span>&nbsp;<span class="ident" id="5662634"><a href="/gostd/archive/zip/reader.go.html#5662564">p</a></span>&nbsp;<span class="op" id="5662636">&gt;=</span>&nbsp;<span class="num" id="5662639">0</span>&nbsp;<span class="op" id="5662641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5662645"><a href="/gostd/archive/zip/reader.go.html#5661526">err</a></span>&nbsp;<span class="op" id="5662649">=</span>&nbsp;<span class="ident" id="5662651"><a href="/gostd/archive/zip/reader.go.html#5663797">readDirectory64End</a></span><span class="op" id="5662669">(</span><span class="ident" id="5662670"><a href="/gostd/archive/zip/reader.go.html#5661479">r</a></span><span class="op" id="5662671">,</span>&nbsp;<span class="ident" id="5662673"><a href="/gostd/archive/zip/reader.go.html#5662564">p</a></span><span class="op" id="5662674">,</span>&nbsp;<span class="ident" id="5662676"><a href="/gostd/archive/zip/reader.go.html#5662126">d</a></span><span class="op" id="5662677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5662680">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5662683">if</span>&nbsp;<span class="ident" id="5662686"><a href="/gostd/archive/zip/reader.go.html#5661526">err</a></span>&nbsp;<span class="op" id="5662690">!=</span>&nbsp;<span class="builtintype" id="5662693">nil</span>&nbsp;<span class="op" id="5662697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5662701">return</span>&nbsp;<span class="builtintype" id="5662708">nil</span><span class="op" id="5662711">,</span>&nbsp;<span class="ident" id="5662713"><a href="/gostd/archive/zip/reader.go.html#5661526">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5662718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5662722">//&nbsp;Make&nbsp;sure&nbsp;directoryOffset&nbsp;points&nbsp;to&nbsp;somewhere&nbsp;in&nbsp;our&nbsp;file.</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5662785">if</span>&nbsp;<span class="ident" id="5662788">o</span>&nbsp;<span class="op" id="5662790">:=</span>&nbsp;<span class="builtintype" id="5662793">int64</span><span class="op" id="5662798">(</span><span class="ident" id="5662799"><a href="/gostd/archive/zip/reader.go.html#5662126">d</a></span><span class="op" id="5662800">.</span><span class="ident" id="5662801"><a href="/gostd/archive/zip/struct.go.html#5672497">directoryOffset</a></span><span class="op" id="5662816">)</span><span class="op" id="5662817">;</span>&nbsp;<span class="ident" id="5662819"><a href="/gostd/archive/zip/reader.go.html#5662788">o</a></span>&nbsp;<span class="op" id="5662821">&lt;</span>&nbsp;<span class="num" id="5662823">0</span>&nbsp;<span class="op" id="5662825">||</span>&nbsp;<span class="ident" id="5662828"><a href="/gostd/archive/zip/reader.go.html#5662788">o</a></span>&nbsp;<span class="op" id="5662830">&gt;=</span>&nbsp;<span class="ident" id="5662833"><a href="/gostd/archive/zip/reader.go.html#5661494">size</a></span>&nbsp;<span class="op" id="5662838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5662842">return</span>&nbsp;<span class="builtintype" id="5662849">nil</span><span class="op" id="5662852">,</span>&nbsp;<span class="ident" id="5662854"><a href="/gostd/archive/zip/reader.go.html#5653308">ErrFormat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5662865">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5662868">return</span>&nbsp;<span class="ident" id="5662875"><a href="/gostd/archive/zip/reader.go.html#5662126">d</a></span><span class="op" id="5662876">,</span>&nbsp;<span class="builtintype" id="5662878">nil</span><br>
<span class="lineno"></span><span class="op" id="5662882">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span><span class="comment" id="5662885">//&nbsp;findDirectory64End&nbsp;tries&nbsp;to&nbsp;read&nbsp;the&nbsp;zip64&nbsp;locator&nbsp;just&nbsp;before&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5662955">//&nbsp;directory&nbsp;end&nbsp;and&nbsp;returns&nbsp;the&nbsp;offset&nbsp;of&nbsp;the&nbsp;zip64&nbsp;directory&nbsp;end&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="5663025">//&nbsp;found.</span><br>
<span class="lineno"></span><span class="keyword" id="5663035">func</span>&nbsp;<span class="ident" id="5663040">findDirectory64End</span><span class="op" id="5663058">(</span><span class="ident" id="5663059">r</span>&nbsp;<span class="ident" id="5663061"><a href="/gostd/archive/zip/reader.go.html#5653287">io</a></span><span class="op" id="5663063">.</span><span class="ident" id="5663064"><a href="/gostd/io/io.go.html#1425985">ReaderAt</a></span><span class="op" id="5663072">,</span>&nbsp;<span class="ident" id="5663074">directoryEndOffset</span>&nbsp;<span class="builtintype" id="5663093">int64</span><span class="op" id="5663098">)</span>&nbsp;<span class="op" id="5663100">(</span><span class="builtintype" id="5663101">int64</span><span class="op" id="5663106">,</span>&nbsp;<span class="builtintype" id="5663108">error</span><span class="op" id="5663113">)</span>&nbsp;<span class="op" id="5663115">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5663118">locOffset</span>&nbsp;<span class="op" id="5663128">:=</span>&nbsp;<span class="ident" id="5663131"><a href="/gostd/archive/zip/reader.go.html#5663074">directoryEndOffset</a></span>&nbsp;<span class="op" id="5663150">-</span>&nbsp;<span class="ident" id="5663152"><a href="/gostd/archive/zip/struct.go.html#5669556">directory64LocLen</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5663171">if</span>&nbsp;<span class="ident" id="5663174"><a href="/gostd/archive/zip/reader.go.html#5663118">locOffset</a></span>&nbsp;<span class="op" id="5663184">&lt;</span>&nbsp;<span class="num" id="5663186">0</span>&nbsp;<span class="op" id="5663188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5663192">return</span>&nbsp;<span class="op" id="5663199">-</span><span class="num" id="5663200">1</span><span class="op" id="5663201">,</span>&nbsp;<span class="builtintype" id="5663203">nil</span>&nbsp;<span class="comment" id="5663207">//&nbsp;no&nbsp;need&nbsp;to&nbsp;look&nbsp;for&nbsp;a&nbsp;header&nbsp;outside&nbsp;the&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5663257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5663260">buf</span>&nbsp;<span class="op" id="5663264">:=</span>&nbsp;<span class="builtinfunc" id="5663267">make</span><span class="op" id="5663271">(</span><span class="op" id="5663272">[</span><span class="op" id="5663273">]</span><span class="builtintype" id="5663274">byte</span><span class="op" id="5663278">,</span>&nbsp;<span class="ident" id="5663280"><a href="/gostd/archive/zip/struct.go.html#5669556">directory64LocLen</a></span><span class="op" id="5663297">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5663300">if</span>&nbsp;<span class="ident" id="5663303">_</span><span class="op" id="5663304">,</span>&nbsp;<span class="ident" id="5663306">err</span>&nbsp;<span class="op" id="5663310">:=</span>&nbsp;<span class="ident" id="5663313"><a href="/gostd/archive/zip/reader.go.html#5663059">r</a></span><span class="op" id="5663314">.</span><span class="ident" id="5663315"><a href="/gostd/io/io.go.html#1426007">ReadAt</a></span><span class="op" id="5663321">(</span><span class="ident" id="5663322"><a href="/gostd/archive/zip/reader.go.html#5663260">buf</a></span><span class="op" id="5663325">,</span>&nbsp;<span class="ident" id="5663327"><a href="/gostd/archive/zip/reader.go.html#5663118">locOffset</a></span><span class="op" id="5663336">)</span><span class="op" id="5663337">;</span>&nbsp;<span class="ident" id="5663339"><a href="/gostd/archive/zip/reader.go.html#5663306">err</a></span>&nbsp;<span class="op" id="5663343">!=</span>&nbsp;<span class="builtintype" id="5663346">nil</span>&nbsp;<span class="op" id="5663350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5663354">return</span>&nbsp;<span class="op" id="5663361">-</span><span class="num" id="5663362">1</span><span class="op" id="5663363">,</span>&nbsp;<span class="ident" id="5663365"><a href="/gostd/archive/zip/reader.go.html#5663306">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5663370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5663373">b</span>&nbsp;<span class="op" id="5663375">:=</span>&nbsp;<span class="ident" id="5663378"><a href="/gostd/archive/zip/reader.go.html#5665121">readBuf</a></span><span class="op" id="5663385">(</span><span class="ident" id="5663386"><a href="/gostd/archive/zip/reader.go.html#5663260">buf</a></span><span class="op" id="5663389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5663392">if</span>&nbsp;<span class="ident" id="5663395">sig</span>&nbsp;<span class="op" id="5663399">:=</span>&nbsp;<span class="ident" id="5663402"><a href="/gostd/archive/zip/reader.go.html#5663373">b</a></span><span class="op" id="5663403">.</span><span class="builtintype" id="5663404"><a href="/gostd/archive/zip/reader.go.html#5665256">uint32</a></span><span class="op" id="5663410">(</span><span class="op" id="5663411">)</span><span class="op" id="5663412">;</span>&nbsp;<span class="ident" id="5663414"><a href="/gostd/archive/zip/reader.go.html#5663395">sig</a></span>&nbsp;<span class="op" id="5663418">!=</span>&nbsp;<span class="ident" id="5663421"><a href="/gostd/archive/zip/struct.go.html#5669032">directory64LocSignature</a></span>&nbsp;<span class="op" id="5663445">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5663449">return</span>&nbsp;<span class="op" id="5663456">-</span><span class="num" id="5663457">1</span><span class="op" id="5663458">,</span>&nbsp;<span class="builtintype" id="5663460">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5663465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5663468"><a href="/gostd/archive/zip/reader.go.html#5663373">b</a></span>&nbsp;<span class="op" id="5663470">=</span>&nbsp;<span class="ident" id="5663472"><a href="/gostd/archive/zip/reader.go.html#5663373">b</a></span><span class="op" id="5663473">[</span><span class="num" id="5663474">4</span><span class="op" id="5663475">:</span><span class="op" id="5663476">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5663484">//&nbsp;skip&nbsp;number&nbsp;of&nbsp;the&nbsp;disk&nbsp;with&nbsp;the&nbsp;start&nbsp;of&nbsp;the&nbsp;zip64&nbsp;end&nbsp;of&nbsp;central&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5663565">p</span>&nbsp;<span class="op" id="5663567">:=</span>&nbsp;<span class="ident" id="5663570"><a href="/gostd/archive/zip/reader.go.html#5663373">b</a></span><span class="op" id="5663571">.</span><span class="builtintype" id="5663572"><a href="/gostd/archive/zip/reader.go.html#5665357">uint64</a></span><span class="op" id="5663578">(</span><span class="op" id="5663579">)</span>&nbsp;<span class="comment" id="5663581">//&nbsp;relative&nbsp;offset&nbsp;of&nbsp;the&nbsp;zip64&nbsp;end&nbsp;of&nbsp;central&nbsp;directory&nbsp;record</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5663646">return</span>&nbsp;<span class="builtintype" id="5663653">int64</span><span class="op" id="5663658">(</span><span class="ident" id="5663659"><a href="/gostd/archive/zip/reader.go.html#5663565">p</a></span><span class="op" id="5663660">)</span><span class="op" id="5663661">,</span>&nbsp;<span class="builtintype" id="5663663">nil</span><br>
<span class="lineno">395</span><span class="op" id="5663667">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5663670">//&nbsp;readDirectory64End&nbsp;reads&nbsp;the&nbsp;zip64&nbsp;directory&nbsp;end&nbsp;and&nbsp;updates&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5663738">//&nbsp;directory&nbsp;end&nbsp;with&nbsp;the&nbsp;zip64&nbsp;directory&nbsp;end&nbsp;values.</span><br>
<span class="lineno"></span><span class="keyword" id="5663792">func</span>&nbsp;<span class="ident" id="5663797">readDirectory64End</span><span class="op" id="5663815">(</span><span class="ident" id="5663816">r</span>&nbsp;<span class="ident" id="5663818"><a href="/gostd/archive/zip/reader.go.html#5653287">io</a></span><span class="op" id="5663820">.</span><span class="ident" id="5663821"><a href="/gostd/io/io.go.html#1425985">ReaderAt</a></span><span class="op" id="5663829">,</span>&nbsp;<span class="ident" id="5663831">offset</span>&nbsp;<span class="builtintype" id="5663838">int64</span><span class="op" id="5663843">,</span>&nbsp;<span class="ident" id="5663845">d</span>&nbsp;<span class="op" id="5663847">*</span><span class="ident" id="5663848"><a href="/gostd/archive/zip/struct.go.html#5672309">directoryEnd</a></span><span class="op" id="5663860">)</span>&nbsp;<span class="op" id="5663862">(</span><span class="ident" id="5663863">err</span>&nbsp;<span class="builtintype" id="5663867">error</span><span class="op" id="5663872">)</span>&nbsp;<span class="op" id="5663874">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5663877">buf</span>&nbsp;<span class="op" id="5663881">:=</span>&nbsp;<span class="builtinfunc" id="5663884">make</span><span class="op" id="5663888">(</span><span class="op" id="5663889">[</span><span class="op" id="5663890">]</span><span class="builtintype" id="5663891">byte</span><span class="op" id="5663895">,</span>&nbsp;<span class="ident" id="5663897"><a href="/gostd/archive/zip/struct.go.html#5669598">directory64EndLen</a></span><span class="op" id="5663914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5663917">if</span>&nbsp;<span class="ident" id="5663920">_</span><span class="op" id="5663921">,</span>&nbsp;<span class="ident" id="5663923">err</span>&nbsp;<span class="op" id="5663927">:=</span>&nbsp;<span class="ident" id="5663930"><a href="/gostd/archive/zip/reader.go.html#5663816">r</a></span><span class="op" id="5663931">.</span><span class="ident" id="5663932"><a href="/gostd/io/io.go.html#1426007">ReadAt</a></span><span class="op" id="5663938">(</span><span class="ident" id="5663939"><a href="/gostd/archive/zip/reader.go.html#5663877">buf</a></span><span class="op" id="5663942">,</span>&nbsp;<span class="ident" id="5663944"><a href="/gostd/archive/zip/reader.go.html#5663831">offset</a></span><span class="op" id="5663950">)</span><span class="op" id="5663951">;</span>&nbsp;<span class="ident" id="5663953"><a href="/gostd/archive/zip/reader.go.html#5663923">err</a></span>&nbsp;<span class="op" id="5663957">!=</span>&nbsp;<span class="builtintype" id="5663960">nil</span>&nbsp;<span class="op" id="5663964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5663968">return</span>&nbsp;<span class="ident" id="5663975"><a href="/gostd/archive/zip/reader.go.html#5663923">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5663980">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5663984">b</span>&nbsp;<span class="op" id="5663986">:=</span>&nbsp;<span class="ident" id="5663989"><a href="/gostd/archive/zip/reader.go.html#5665121">readBuf</a></span><span class="op" id="5663996">(</span><span class="ident" id="5663997"><a href="/gostd/archive/zip/reader.go.html#5663877">buf</a></span><span class="op" id="5664000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5664003">if</span>&nbsp;<span class="ident" id="5664006">sig</span>&nbsp;<span class="op" id="5664010">:=</span>&nbsp;<span class="ident" id="5664013"><a href="/gostd/archive/zip/reader.go.html#5663984">b</a></span><span class="op" id="5664014">.</span><span class="builtintype" id="5664015"><a href="/gostd/archive/zip/reader.go.html#5665256">uint32</a></span><span class="op" id="5664021">(</span><span class="op" id="5664022">)</span><span class="op" id="5664023">;</span>&nbsp;<span class="ident" id="5664025"><a href="/gostd/archive/zip/reader.go.html#5664006">sig</a></span>&nbsp;<span class="op" id="5664029">!=</span>&nbsp;<span class="ident" id="5664032"><a href="/gostd/archive/zip/struct.go.html#5669071">directory64EndSignature</a></span>&nbsp;<span class="op" id="5664056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5664060">return</span>&nbsp;<span class="ident" id="5664067"><a href="/gostd/archive/zip/reader.go.html#5653308">ErrFormat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5664078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5664082"><a href="/gostd/archive/zip/reader.go.html#5663984">b</a></span>&nbsp;<span class="op" id="5664084">=</span>&nbsp;<span class="ident" id="5664086"><a href="/gostd/archive/zip/reader.go.html#5663984">b</a></span><span class="op" id="5664087">[</span><span class="num" id="5664088">12</span><span class="op" id="5664090">:</span><span class="op" id="5664091">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5664116">//&nbsp;skip&nbsp;dir&nbsp;size,&nbsp;version&nbsp;and&nbsp;version&nbsp;needed&nbsp;(uint64&nbsp;+&nbsp;2x&nbsp;uint16)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5664183"><a href="/gostd/archive/zip/reader.go.html#5663845">d</a></span><span class="op" id="5664184">.</span><span class="ident" id="5664185"><a href="/gostd/archive/zip/struct.go.html#5672332">diskNbr</a></span>&nbsp;<span class="op" id="5664193">=</span>&nbsp;<span class="ident" id="5664195"><a href="/gostd/archive/zip/reader.go.html#5663984">b</a></span><span class="op" id="5664196">.</span><span class="builtintype" id="5664197"><a href="/gostd/archive/zip/reader.go.html#5665256">uint32</a></span><span class="op" id="5664203">(</span><span class="op" id="5664204">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5664217">//&nbsp;number&nbsp;of&nbsp;this&nbsp;disk</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5664241"><a href="/gostd/archive/zip/reader.go.html#5663845">d</a></span><span class="op" id="5664242">.</span><span class="ident" id="5664243"><a href="/gostd/archive/zip/struct.go.html#5672369">dirDiskNbr</a></span>&nbsp;<span class="op" id="5664254">=</span>&nbsp;<span class="ident" id="5664256"><a href="/gostd/archive/zip/reader.go.html#5663984">b</a></span><span class="op" id="5664257">.</span><span class="builtintype" id="5664258"><a href="/gostd/archive/zip/reader.go.html#5665256">uint32</a></span><span class="op" id="5664264">(</span><span class="op" id="5664265">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5664275">//&nbsp;number&nbsp;of&nbsp;the&nbsp;disk&nbsp;with&nbsp;the&nbsp;start&nbsp;of&nbsp;the&nbsp;central&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5664338"><a href="/gostd/archive/zip/reader.go.html#5663845">d</a></span><span class="op" id="5664339">.</span><span class="ident" id="5664340"><a href="/gostd/archive/zip/struct.go.html#5672406">dirRecordsThisDisk</a></span>&nbsp;<span class="op" id="5664359">=</span>&nbsp;<span class="ident" id="5664361"><a href="/gostd/archive/zip/reader.go.html#5663984">b</a></span><span class="op" id="5664362">.</span><span class="builtintype" id="5664363"><a href="/gostd/archive/zip/reader.go.html#5665357">uint64</a></span><span class="op" id="5664369">(</span><span class="op" id="5664370">)</span>&nbsp;<span class="comment" id="5664372">//&nbsp;total&nbsp;number&nbsp;of&nbsp;entries&nbsp;in&nbsp;the&nbsp;central&nbsp;directory&nbsp;on&nbsp;this&nbsp;disk</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5664438"><a href="/gostd/archive/zip/reader.go.html#5663845">d</a></span><span class="op" id="5664439">.</span><span class="ident" id="5664440"><a href="/gostd/archive/zip/struct.go.html#5672443">directoryRecords</a></span>&nbsp;<span class="op" id="5664457">=</span>&nbsp;<span class="ident" id="5664459"><a href="/gostd/archive/zip/reader.go.html#5663984">b</a></span><span class="op" id="5664460">.</span><span class="builtintype" id="5664461"><a href="/gostd/archive/zip/reader.go.html#5665357">uint64</a></span><span class="op" id="5664467">(</span><span class="op" id="5664468">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5664472">//&nbsp;total&nbsp;number&nbsp;of&nbsp;entries&nbsp;in&nbsp;the&nbsp;central&nbsp;directory</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5664525"><a href="/gostd/archive/zip/reader.go.html#5663845">d</a></span><span class="op" id="5664526">.</span><span class="ident" id="5664527"><a href="/gostd/archive/zip/struct.go.html#5672470">directorySize</a></span>&nbsp;<span class="op" id="5664541">=</span>&nbsp;<span class="ident" id="5664543"><a href="/gostd/archive/zip/reader.go.html#5663984">b</a></span><span class="op" id="5664544">.</span><span class="builtintype" id="5664545"><a href="/gostd/archive/zip/reader.go.html#5665357">uint64</a></span><span class="op" id="5664551">(</span><span class="op" id="5664552">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5664559">//&nbsp;size&nbsp;of&nbsp;the&nbsp;central&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5664593"><a href="/gostd/archive/zip/reader.go.html#5663845">d</a></span><span class="op" id="5664594">.</span><span class="ident" id="5664595"><a href="/gostd/archive/zip/struct.go.html#5672497">directoryOffset</a></span>&nbsp;<span class="op" id="5664611">=</span>&nbsp;<span class="ident" id="5664613"><a href="/gostd/archive/zip/reader.go.html#5663984">b</a></span><span class="op" id="5664614">.</span><span class="builtintype" id="5664615"><a href="/gostd/archive/zip/reader.go.html#5665357">uint64</a></span><span class="op" id="5664621">(</span><span class="op" id="5664622">)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5664627">//&nbsp;offset&nbsp;of&nbsp;start&nbsp;of&nbsp;central&nbsp;directory&nbsp;with&nbsp;respect&nbsp;to&nbsp;the&nbsp;starting&nbsp;disk&nbsp;number</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5664710">return</span>&nbsp;<span class="builtintype" id="5664717">nil</span><br>
<span class="lineno"></span><span class="op" id="5664721">}</span><br>
<span class="lineno">420</span><br>
<span class="lineno"></span><span class="keyword" id="5664724">func</span>&nbsp;<span class="ident" id="5664729">findSignatureInBlock</span><span class="op" id="5664749">(</span><span class="ident" id="5664750">b</span>&nbsp;<span class="op" id="5664752">[</span><span class="op" id="5664753">]</span><span class="builtintype" id="5664754">byte</span><span class="op" id="5664758">)</span>&nbsp;<span class="builtintype" id="5664760">int</span>&nbsp;<span class="op" id="5664764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5664767">for</span>&nbsp;<span class="ident" id="5664771">i</span>&nbsp;<span class="op" id="5664773">:=</span>&nbsp;<span class="builtinfunc" id="5664776">len</span><span class="op" id="5664779">(</span><span class="ident" id="5664780"><a href="/gostd/archive/zip/reader.go.html#5664750">b</a></span><span class="op" id="5664781">)</span>&nbsp;<span class="op" id="5664783">-</span>&nbsp;<span class="ident" id="5664785"><a href="/gostd/archive/zip/struct.go.html#5669327">directoryEndLen</a></span><span class="op" id="5664800">;</span>&nbsp;<span class="ident" id="5664802"><a href="/gostd/archive/zip/reader.go.html#5664771">i</a></span>&nbsp;<span class="op" id="5664804">&gt;=</span>&nbsp;<span class="num" id="5664807">0</span><span class="op" id="5664808">;</span>&nbsp;<span class="ident" id="5664810"><a href="/gostd/archive/zip/reader.go.html#5664771">i</a></span><span class="op" id="5664811">--</span>&nbsp;<span class="op" id="5664814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5664818">//&nbsp;defined&nbsp;from&nbsp;directoryEndSignature&nbsp;in&nbsp;struct.go</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5664871">if</span>&nbsp;<span class="ident" id="5664874"><a href="/gostd/archive/zip/reader.go.html#5664750">b</a></span><span class="op" id="5664875">[</span><span class="ident" id="5664876"><a href="/gostd/archive/zip/reader.go.html#5664771">i</a></span><span class="op" id="5664877">]</span>&nbsp;<span class="op" id="5664879">==</span>&nbsp;<span class="string" id="5664882">&#39;P&#39;</span>&nbsp;<span class="op" id="5664886">&amp;&amp;</span>&nbsp;<span class="ident" id="5664889"><a href="/gostd/archive/zip/reader.go.html#5664750">b</a></span><span class="op" id="5664890">[</span><span class="ident" id="5664891"><a href="/gostd/archive/zip/reader.go.html#5664771">i</a></span><span class="op" id="5664892">+</span><span class="num" id="5664893">1</span><span class="op" id="5664894">]</span>&nbsp;<span class="op" id="5664896">==</span>&nbsp;<span class="string" id="5664899">&#39;K&#39;</span>&nbsp;<span class="op" id="5664903">&amp;&amp;</span>&nbsp;<span class="ident" id="5664906"><a href="/gostd/archive/zip/reader.go.html#5664750">b</a></span><span class="op" id="5664907">[</span><span class="ident" id="5664908"><a href="/gostd/archive/zip/reader.go.html#5664771">i</a></span><span class="op" id="5664909">+</span><span class="num" id="5664910">2</span><span class="op" id="5664911">]</span>&nbsp;<span class="op" id="5664913">==</span>&nbsp;<span class="num" id="5664916">0x05</span>&nbsp;<span class="op" id="5664921">&amp;&amp;</span>&nbsp;<span class="ident" id="5664924"><a href="/gostd/archive/zip/reader.go.html#5664750">b</a></span><span class="op" id="5664925">[</span><span class="ident" id="5664926"><a href="/gostd/archive/zip/reader.go.html#5664771">i</a></span><span class="op" id="5664927">+</span><span class="num" id="5664928">3</span><span class="op" id="5664929">]</span>&nbsp;<span class="op" id="5664931">==</span>&nbsp;<span class="num" id="5664934">0x06</span>&nbsp;<span class="op" id="5664939">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5664944">//&nbsp;n&nbsp;is&nbsp;length&nbsp;of&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5664973">n</span>&nbsp;<span class="op" id="5664975">:=</span>&nbsp;<span class="builtintype" id="5664978">int</span><span class="op" id="5664981">(</span><span class="ident" id="5664982"><a href="/gostd/archive/zip/reader.go.html#5664750">b</a></span><span class="op" id="5664983">[</span><span class="ident" id="5664984"><a href="/gostd/archive/zip/reader.go.html#5664771">i</a></span><span class="op" id="5664985">+</span><span class="ident" id="5664986"><a href="/gostd/archive/zip/struct.go.html#5669327">directoryEndLen</a></span><span class="op" id="5665001">-</span><span class="num" id="5665002">2</span><span class="op" id="5665003">]</span><span class="op" id="5665004">)</span>&nbsp;<span class="op" id="5665006">|</span>&nbsp;<span class="builtintype" id="5665008">int</span><span class="op" id="5665011">(</span><span class="ident" id="5665012"><a href="/gostd/archive/zip/reader.go.html#5664750">b</a></span><span class="op" id="5665013">[</span><span class="ident" id="5665014"><a href="/gostd/archive/zip/reader.go.html#5664771">i</a></span><span class="op" id="5665015">+</span><span class="ident" id="5665016"><a href="/gostd/archive/zip/struct.go.html#5669327">directoryEndLen</a></span><span class="op" id="5665031">-</span><span class="num" id="5665032">1</span><span class="op" id="5665033">]</span><span class="op" id="5665034">)</span><span class="op" id="5665035">&lt;&lt;</span><span class="num" id="5665037">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5665042">if</span>&nbsp;<span class="ident" id="5665045"><a href="/gostd/archive/zip/reader.go.html#5664973">n</a></span><span class="op" id="5665046">+</span><span class="ident" id="5665047"><a href="/gostd/archive/zip/struct.go.html#5669327">directoryEndLen</a></span><span class="op" id="5665062">+</span><span class="ident" id="5665063"><a href="/gostd/archive/zip/reader.go.html#5664771">i</a></span>&nbsp;<span class="op" id="5665065">&lt;=</span>&nbsp;<span class="builtinfunc" id="5665068">len</span><span class="op" id="5665071">(</span><span class="ident" id="5665072"><a href="/gostd/archive/zip/reader.go.html#5664750">b</a></span><span class="op" id="5665073">)</span>&nbsp;<span class="op" id="5665075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5665081">return</span>&nbsp;<span class="ident" id="5665088"><a href="/gostd/archive/zip/reader.go.html#5664771">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5665093">}</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5665097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5665100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5665103">return</span>&nbsp;<span class="op" id="5665110">-</span><span class="num" id="5665111">1</span><br>
<span class="lineno"></span><span class="op" id="5665113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span><span class="keyword" id="5665116">type</span>&nbsp;<span class="ident" id="5665121">readBuf</span>&nbsp;<span class="op" id="5665129">[</span><span class="op" id="5665130">]</span><span class="builtintype" id="5665131">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5665137">func</span>&nbsp;<span class="op" id="5665142">(</span><span class="ident" id="5665143">b</span>&nbsp;<span class="op" id="5665145">*</span><span class="ident" id="5665146"><a href="/gostd/archive/zip/reader.go.html#5665121">readBuf</a></span><span class="op" id="5665153">)</span>&nbsp;<span class="builtintype" id="5665155">uint16</span><span class="op" id="5665161">(</span><span class="op" id="5665162">)</span>&nbsp;<span class="builtintype" id="5665164">uint16</span>&nbsp;<span class="op" id="5665171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5665174">v</span>&nbsp;<span class="op" id="5665176">:=</span>&nbsp;<span class="ident" id="5665179"><a href="/gostd/archive/zip/reader.go.html#5653236">binary</a></span><span class="op" id="5665185">.</span><span class="ident" id="5665186"><a href="/gostd/encoding/binary/binary.go.html#2987055">LittleEndian</a></span><span class="op" id="5665198">.</span><span class="ident" id="5665199"><a href="/gostd/encoding/binary/binary.go.html#2987215">Uint16</a></span><span class="op" id="5665205">(</span><span class="op" id="5665206">*</span><span class="ident" id="5665207"><a href="/gostd/archive/zip/reader.go.html#5665143">b</a></span><span class="op" id="5665208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5665211">*</span><span class="ident" id="5665212"><a href="/gostd/archive/zip/reader.go.html#5665143">b</a></span>&nbsp;<span class="op" id="5665214">=</span>&nbsp;<span class="op" id="5665216">(</span><span class="op" id="5665217">*</span><span class="ident" id="5665218"><a href="/gostd/archive/zip/reader.go.html#5665143">b</a></span><span class="op" id="5665219">)</span><span class="op" id="5665220">[</span><span class="num" id="5665221">2</span><span class="op" id="5665222">:</span><span class="op" id="5665223">]</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5665226">return</span>&nbsp;<span class="ident" id="5665233"><a href="/gostd/archive/zip/reader.go.html#5665174">v</a></span><br>
<span class="lineno"></span><span class="op" id="5665235">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5665238">func</span>&nbsp;<span class="op" id="5665243">(</span><span class="ident" id="5665244">b</span>&nbsp;<span class="op" id="5665246">*</span><span class="ident" id="5665247"><a href="/gostd/archive/zip/reader.go.html#5665121">readBuf</a></span><span class="op" id="5665254">)</span>&nbsp;<span class="builtintype" id="5665256">uint32</span><span class="op" id="5665262">(</span><span class="op" id="5665263">)</span>&nbsp;<span class="builtintype" id="5665265">uint32</span>&nbsp;<span class="op" id="5665272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5665275">v</span>&nbsp;<span class="op" id="5665277">:=</span>&nbsp;<span class="ident" id="5665280"><a href="/gostd/archive/zip/reader.go.html#5653236">binary</a></span><span class="op" id="5665286">.</span><span class="ident" id="5665287"><a href="/gostd/encoding/binary/binary.go.html#2987055">LittleEndian</a></span><span class="op" id="5665299">.</span><span class="ident" id="5665300"><a href="/gostd/encoding/binary/binary.go.html#2987394">Uint32</a></span><span class="op" id="5665306">(</span><span class="op" id="5665307">*</span><span class="ident" id="5665308"><a href="/gostd/archive/zip/reader.go.html#5665244">b</a></span><span class="op" id="5665309">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5665312">*</span><span class="ident" id="5665313"><a href="/gostd/archive/zip/reader.go.html#5665244">b</a></span>&nbsp;<span class="op" id="5665315">=</span>&nbsp;<span class="op" id="5665317">(</span><span class="op" id="5665318">*</span><span class="ident" id="5665319"><a href="/gostd/archive/zip/reader.go.html#5665244">b</a></span><span class="op" id="5665320">)</span><span class="op" id="5665321">[</span><span class="num" id="5665322">4</span><span class="op" id="5665323">:</span><span class="op" id="5665324">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5665327">return</span>&nbsp;<span class="ident" id="5665334"><a href="/gostd/archive/zip/reader.go.html#5665275">v</a></span><br>
<span class="lineno"></span><span class="op" id="5665336">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5665339">func</span>&nbsp;<span class="op" id="5665344">(</span><span class="ident" id="5665345">b</span>&nbsp;<span class="op" id="5665347">*</span><span class="ident" id="5665348"><a href="/gostd/archive/zip/reader.go.html#5665121">readBuf</a></span><span class="op" id="5665355">)</span>&nbsp;<span class="builtintype" id="5665357">uint64</span><span class="op" id="5665363">(</span><span class="op" id="5665364">)</span>&nbsp;<span class="builtintype" id="5665366">uint64</span>&nbsp;<span class="op" id="5665373">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5665376">v</span>&nbsp;<span class="op" id="5665378">:=</span>&nbsp;<span class="ident" id="5665381"><a href="/gostd/archive/zip/reader.go.html#5653236">binary</a></span><span class="op" id="5665387">.</span><span class="ident" id="5665388"><a href="/gostd/encoding/binary/binary.go.html#2987055">LittleEndian</a></span><span class="op" id="5665400">.</span><span class="ident" id="5665401"><a href="/gostd/encoding/binary/binary.go.html#2987656">Uint64</a></span><span class="op" id="5665407">(</span><span class="op" id="5665408">*</span><span class="ident" id="5665409"><a href="/gostd/archive/zip/reader.go.html#5665345">b</a></span><span class="op" id="5665410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5665413">*</span><span class="ident" id="5665414"><a href="/gostd/archive/zip/reader.go.html#5665345">b</a></span>&nbsp;<span class="op" id="5665416">=</span>&nbsp;<span class="op" id="5665418">(</span><span class="op" id="5665419">*</span><span class="ident" id="5665420"><a href="/gostd/archive/zip/reader.go.html#5665345">b</a></span><span class="op" id="5665421">)</span><span class="op" id="5665422">[</span><span class="num" id="5665423">8</span><span class="op" id="5665424">:</span><span class="op" id="5665425">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5665428">return</span>&nbsp;<span class="ident" id="5665435"><a href="/gostd/archive/zip/reader.go.html#5665376">v</a></span><br>
<span class="lineno"></span><span class="op" id="5665437">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
