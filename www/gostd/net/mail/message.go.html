<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/mail</h2>
<ul>
<li><a href="/gostd/net/mail/message.go.html" class="current">message.go</a></li>
<li><a href="/gostd/net/mail/message_test.go.html">message_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6068567">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6068622">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6068676">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6068727">/*<br>
<span class="lineno"></span>Package&nbsp;mail&nbsp;implements&nbsp;parsing&nbsp;of&nbsp;mail&nbsp;messages.<br>
<span class="lineno"></span><br>
<span class="lineno"></span>For&nbsp;the&nbsp;most&nbsp;part,&nbsp;this&nbsp;package&nbsp;follows&nbsp;the&nbsp;syntax&nbsp;as&nbsp;specified&nbsp;by&nbsp;RFC&nbsp;5322.<br>
<span class="lineno"></span>Notable&nbsp;divergences:<br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Obsolete&nbsp;address&nbsp;formats&nbsp;are&nbsp;not&nbsp;parsed,&nbsp;including&nbsp;addresses&nbsp;with<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;embedded&nbsp;route&nbsp;information.<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Group&nbsp;addresses&nbsp;are&nbsp;not&nbsp;parsed.<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;full&nbsp;range&nbsp;of&nbsp;spacing&nbsp;(the&nbsp;CFWS&nbsp;syntax&nbsp;element)&nbsp;is&nbsp;not&nbsp;supported,<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;such&nbsp;as&nbsp;breaking&nbsp;addresses&nbsp;across&nbsp;lines.<br>
<span class="lineno">15</span>*/</span><br>
<span class="lineno"></span><span class="keyword" id="6069134">package</span>&nbsp;<span class="ident" id="6069142">mail</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6069148">import</span>&nbsp;<span class="op" id="6069155">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6069158">&#34;bufio&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6069167">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6069176">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6069195">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6069205">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6069212">&#34;io&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6069218">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6069231">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6069238">&#34;net/textproto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6069255">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6069266">&#34;strings&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6069277">&#34;time&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6069285">&#34;unicode&#34;</span><br>
<span class="lineno"></span><span class="op" id="6069295">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6069298">var</span>&nbsp;<span class="ident" id="6069302">debug</span>&nbsp;<span class="op" id="6069308">=</span>&nbsp;<span class="ident" id="6069310"><a href="/gostd/net/mail/message.go.html#6069330">debugT</a></span><span class="op" id="6069316">(</span><span class="builtintype" id="6069317">false</span><span class="op" id="6069322">)</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="6069325">type</span>&nbsp;<span class="ident" id="6069330">debugT</span>&nbsp;<span class="builtintype" id="6069337">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6069343">func</span>&nbsp;<span class="op" id="6069348">(</span><span class="ident" id="6069349">d</span>&nbsp;<span class="ident" id="6069351"><a href="/gostd/net/mail/message.go.html#6069330">debugT</a></span><span class="op" id="6069357">)</span>&nbsp;<span class="ident" id="6069359">Printf</span><span class="op" id="6069365">(</span><span class="ident" id="6069366">format</span>&nbsp;<span class="builtintype" id="6069373">string</span><span class="op" id="6069379">,</span>&nbsp;<span class="ident" id="6069381">args</span>&nbsp;<span class="op" id="6069386">...</span><span class="keyword" id="6069389">interface</span><span class="op" id="6069398">{</span><span class="op" id="6069399">}</span><span class="op" id="6069400">)</span>&nbsp;<span class="op" id="6069402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6069405">if</span>&nbsp;<span class="ident" id="6069408"><a href="/gostd/net/mail/message.go.html#6069349">d</a></span>&nbsp;<span class="op" id="6069410">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6069414"><a href="/gostd/net/mail/message.go.html#6069231">log</a></span><span class="op" id="6069417">.</span><span class="ident" id="6069418"><a href="/gostd/log/log.go.html#4078664">Printf</a></span><span class="op" id="6069424">(</span><span class="ident" id="6069425"><a href="/gostd/net/mail/message.go.html#6069366">format</a></span><span class="op" id="6069431">,</span>&nbsp;<span class="ident" id="6069433"><a href="/gostd/net/mail/message.go.html#6069381">args</a></span><span class="op" id="6069437">...</span><span class="op" id="6069440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6069443">}</span><br>
<span class="lineno"></span><span class="op" id="6069445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6069448">//&nbsp;A&nbsp;Message&nbsp;represents&nbsp;a&nbsp;parsed&nbsp;mail&nbsp;message.</span><br>
<span class="lineno">45</span><span class="keyword" id="6069495">type</span>&nbsp;<span class="ident" id="6069500">Message</span>&nbsp;<span class="keyword" id="6069508">struct</span>&nbsp;<span class="op" id="6069515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6069518">Header</span>&nbsp;<span class="ident" id="6069525"><a href="/gostd/net/mail/message.go.html#6071084">Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6069533">Body</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6069540"><a href="/gostd/net/mail/message.go.html#6069212">io</a></span><span class="op" id="6069542">.</span><span class="ident" id="6069543"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><br>
<span class="lineno"></span><span class="op" id="6069550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="6069553">//&nbsp;ReadMessage&nbsp;reads&nbsp;a&nbsp;message&nbsp;from&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="6069592">//&nbsp;The&nbsp;headers&nbsp;are&nbsp;parsed,&nbsp;and&nbsp;the&nbsp;body&nbsp;of&nbsp;the&nbsp;message&nbsp;will&nbsp;be&nbsp;available</span><br>
<span class="lineno"></span><span class="comment" id="6069665">//&nbsp;for&nbsp;reading&nbsp;from&nbsp;r.</span><br>
<span class="lineno"></span><span class="keyword" id="6069688">func</span>&nbsp;<span class="ident" id="6069693">ReadMessage</span><span class="op" id="6069704">(</span><span class="ident" id="6069705">r</span>&nbsp;<span class="ident" id="6069707"><a href="/gostd/net/mail/message.go.html#6069212">io</a></span><span class="op" id="6069709">.</span><span class="ident" id="6069710"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="6069716">)</span>&nbsp;<span class="op" id="6069718">(</span><span class="ident" id="6069719">msg</span>&nbsp;<span class="op" id="6069723">*</span><span class="ident" id="6069724"><a href="/gostd/net/mail/message.go.html#6069500">Message</a></span><span class="op" id="6069731">,</span>&nbsp;<span class="ident" id="6069733">err</span>&nbsp;<span class="builtintype" id="6069737">error</span><span class="op" id="6069742">)</span>&nbsp;<span class="op" id="6069744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6069747">tp</span>&nbsp;<span class="op" id="6069750">:=</span>&nbsp;<span class="ident" id="6069753"><a href="/gostd/net/mail/message.go.html#6069238">textproto</a></span><span class="op" id="6069762">.</span><span class="ident" id="6069763"><a href="/gostd/net/textproto/reader.go.html#4333349">NewReader</a></span><span class="op" id="6069772">(</span><span class="ident" id="6069773"><a href="/gostd/net/mail/message.go.html#6069158">bufio</a></span><span class="op" id="6069778">.</span><span class="ident" id="6069779"><a href="/gostd/bufio/bufio.go.html#1355792">NewReader</a></span><span class="op" id="6069788">(</span><span class="ident" id="6069789"><a href="/gostd/net/mail/message.go.html#6069705">r</a></span><span class="op" id="6069790">)</span><span class="op" id="6069791">)</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6069795">hdr</span><span class="op" id="6069798">,</span>&nbsp;<span class="ident" id="6069800"><a href="/gostd/net/mail/message.go.html#6069733">err</a></span>&nbsp;<span class="op" id="6069804">:=</span>&nbsp;<span class="ident" id="6069807"><a href="/gostd/net/mail/message.go.html#6069747">tp</a></span><span class="op" id="6069809">.</span><span class="ident" id="6069810"><a href="/gostd/net/textproto/reader.go.html#4344573">ReadMIMEHeader</a></span><span class="op" id="6069824">(</span><span class="op" id="6069825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6069828">if</span>&nbsp;<span class="ident" id="6069831"><a href="/gostd/net/mail/message.go.html#6069733">err</a></span>&nbsp;<span class="op" id="6069835">!=</span>&nbsp;<span class="builtintype" id="6069838">nil</span>&nbsp;<span class="op" id="6069842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6069846">return</span>&nbsp;<span class="builtintype" id="6069853">nil</span><span class="op" id="6069856">,</span>&nbsp;<span class="ident" id="6069858"><a href="/gostd/net/mail/message.go.html#6069733">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6069863">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6069867">return</span>&nbsp;<span class="op" id="6069874">&amp;</span><span class="ident" id="6069875"><a href="/gostd/net/mail/message.go.html#6069500">Message</a></span><span class="op" id="6069882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6069886"><a href="/gostd/net/mail/message.go.html#6069518">Header</a></span><span class="op" id="6069892">:</span>&nbsp;<span class="ident" id="6069894"><a href="/gostd/net/mail/message.go.html#6071084">Header</a></span><span class="op" id="6069900">(</span><span class="ident" id="6069901"><a href="/gostd/net/mail/message.go.html#6069795">hdr</a></span><span class="op" id="6069904">)</span><span class="op" id="6069905">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6069909"><a href="/gostd/net/mail/message.go.html#6069533">Body</a></span><span class="op" id="6069913">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6069917"><a href="/gostd/net/mail/message.go.html#6069747">tp</a></span><span class="op" id="6069919">.</span><span class="ident" id="6069920"><a href="/gostd/net/textproto/reader.go.html#4333196">R</a></span><span class="op" id="6069921">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6069924">}</span><span class="op" id="6069925">,</span>&nbsp;<span class="builtintype" id="6069927">nil</span><br>
<span class="lineno">65</span><span class="op" id="6069931">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6069934">//&nbsp;Layouts&nbsp;suitable&nbsp;for&nbsp;passing&nbsp;to&nbsp;time.Parse.</span><br>
<span class="lineno"></span><span class="comment" id="6069981">//&nbsp;These&nbsp;are&nbsp;tried&nbsp;in&nbsp;order.</span><br>
<span class="lineno"></span><span class="keyword" id="6070010">var</span>&nbsp;<span class="ident" id="6070014">dateLayouts</span>&nbsp;<span class="op" id="6070026">[</span><span class="op" id="6070027">]</span><span class="builtintype" id="6070028">string</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="6070036">func</span>&nbsp;<span class="ident" id="6070041">init</span><span class="op" id="6070045">(</span><span class="op" id="6070046">)</span>&nbsp;<span class="op" id="6070048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6070051">//&nbsp;Generate&nbsp;layouts&nbsp;based&nbsp;on&nbsp;RFC&nbsp;5322,&nbsp;section&nbsp;3.3.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6070105">dows</span>&nbsp;<span class="op" id="6070110">:=</span>&nbsp;<span class="op" id="6070113">[</span><span class="op" id="6070114">...</span><span class="op" id="6070117">]</span><span class="builtintype" id="6070118">string</span><span class="op" id="6070124">{</span><span class="string" id="6070125">&#34;&#34;</span><span class="op" id="6070127">,</span>&nbsp;<span class="string" id="6070129">&#34;Mon,&nbsp;&#34;</span><span class="op" id="6070136">}</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6070140">//&nbsp;day-of-week</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6070156">days</span>&nbsp;<span class="op" id="6070161">:=</span>&nbsp;<span class="op" id="6070164">[</span><span class="op" id="6070165">...</span><span class="op" id="6070168">]</span><span class="builtintype" id="6070169">string</span><span class="op" id="6070175">{</span><span class="string" id="6070176">&#34;2&#34;</span><span class="op" id="6070179">,</span>&nbsp;<span class="string" id="6070181">&#34;02&#34;</span><span class="op" id="6070185">}</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6070191">//&nbsp;day&nbsp;=&nbsp;1*2DIGIT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6070210">years</span>&nbsp;<span class="op" id="6070216">:=</span>&nbsp;<span class="op" id="6070219">[</span><span class="op" id="6070220">...</span><span class="op" id="6070223">]</span><span class="builtintype" id="6070224">string</span><span class="op" id="6070230">{</span><span class="string" id="6070231">&#34;2006&#34;</span><span class="op" id="6070237">,</span>&nbsp;<span class="string" id="6070239">&#34;06&#34;</span><span class="op" id="6070243">}</span>&nbsp;<span class="comment" id="6070245">//&nbsp;year&nbsp;=&nbsp;4*DIGIT&nbsp;/&nbsp;2*DIGIT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6070274">seconds</span>&nbsp;<span class="op" id="6070282">:=</span>&nbsp;<span class="op" id="6070285">[</span><span class="op" id="6070286">...</span><span class="op" id="6070289">]</span><span class="builtintype" id="6070290">string</span><span class="op" id="6070296">{</span><span class="string" id="6070297">&#34;:05&#34;</span><span class="op" id="6070302">,</span>&nbsp;<span class="string" id="6070304">&#34;&#34;</span><span class="op" id="6070306">}</span>&nbsp;&nbsp;<span class="comment" id="6070309">//&nbsp;second</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6070320">//&nbsp;&#34;-0700&nbsp;(MST)&#34;&nbsp;is&nbsp;not&nbsp;in&nbsp;RFC&nbsp;5322,&nbsp;but&nbsp;is&nbsp;common.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6070373">zones</span>&nbsp;<span class="op" id="6070379">:=</span>&nbsp;<span class="op" id="6070382">[</span><span class="op" id="6070383">...</span><span class="op" id="6070386">]</span><span class="builtintype" id="6070387">string</span><span class="op" id="6070393">{</span><span class="string" id="6070394">&#34;-0700&#34;</span><span class="op" id="6070401">,</span>&nbsp;<span class="string" id="6070403">&#34;MST&#34;</span><span class="op" id="6070408">,</span>&nbsp;<span class="string" id="6070410">&#34;-0700&nbsp;(MST)&#34;</span><span class="op" id="6070423">}</span>&nbsp;<span class="comment" id="6070425">//&nbsp;zone&nbsp;=&nbsp;((&#34;+&#34;&nbsp;/&nbsp;&#34;-&#34;)&nbsp;4DIGIT)&nbsp;/&nbsp;&#34;GMT&#34;&nbsp;/&nbsp;...</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6070472">for</span>&nbsp;<span class="ident" id="6070476">_</span><span class="op" id="6070477">,</span>&nbsp;<span class="ident" id="6070479">dow</span>&nbsp;<span class="op" id="6070483">:=</span>&nbsp;<span class="keyword" id="6070486">range</span>&nbsp;<span class="ident" id="6070492"><a href="/gostd/net/mail/message.go.html#6070105">dows</a></span>&nbsp;<span class="op" id="6070497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6070501">for</span>&nbsp;<span class="ident" id="6070505">_</span><span class="op" id="6070506">,</span>&nbsp;<span class="ident" id="6070508">day</span>&nbsp;<span class="op" id="6070512">:=</span>&nbsp;<span class="keyword" id="6070515">range</span>&nbsp;<span class="ident" id="6070521"><a href="/gostd/net/mail/message.go.html#6070156">days</a></span>&nbsp;<span class="op" id="6070526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6070531">for</span>&nbsp;<span class="ident" id="6070535">_</span><span class="op" id="6070536">,</span>&nbsp;<span class="ident" id="6070538">year</span>&nbsp;<span class="op" id="6070543">:=</span>&nbsp;<span class="keyword" id="6070546">range</span>&nbsp;<span class="ident" id="6070552"><a href="/gostd/net/mail/message.go.html#6070210">years</a></span>&nbsp;<span class="op" id="6070558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6070564">for</span>&nbsp;<span class="ident" id="6070568">_</span><span class="op" id="6070569">,</span>&nbsp;<span class="ident" id="6070571">second</span>&nbsp;<span class="op" id="6070578">:=</span>&nbsp;<span class="keyword" id="6070581">range</span>&nbsp;<span class="ident" id="6070587"><a href="/gostd/net/mail/message.go.html#6070274">seconds</a></span>&nbsp;<span class="op" id="6070595">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6070602">for</span>&nbsp;<span class="ident" id="6070606">_</span><span class="op" id="6070607">,</span>&nbsp;<span class="ident" id="6070609">zone</span>&nbsp;<span class="op" id="6070614">:=</span>&nbsp;<span class="keyword" id="6070617">range</span>&nbsp;<span class="ident" id="6070623"><a href="/gostd/net/mail/message.go.html#6070373">zones</a></span>&nbsp;<span class="op" id="6070629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6070637">s</span>&nbsp;<span class="op" id="6070639">:=</span>&nbsp;<span class="ident" id="6070642"><a href="/gostd/net/mail/message.go.html#6070479">dow</a></span>&nbsp;<span class="op" id="6070646">+</span>&nbsp;<span class="ident" id="6070648"><a href="/gostd/net/mail/message.go.html#6070508">day</a></span>&nbsp;<span class="op" id="6070652">+</span>&nbsp;<span class="string" id="6070654">&#34;&nbsp;Jan&nbsp;&#34;</span>&nbsp;<span class="op" id="6070662">+</span>&nbsp;<span class="ident" id="6070664"><a href="/gostd/net/mail/message.go.html#6070538">year</a></span>&nbsp;<span class="op" id="6070669">+</span>&nbsp;<span class="string" id="6070671">&#34;&nbsp;15:04&#34;</span>&nbsp;<span class="op" id="6070680">+</span>&nbsp;<span class="ident" id="6070682"><a href="/gostd/net/mail/message.go.html#6070571">second</a></span>&nbsp;<span class="op" id="6070689">+</span>&nbsp;<span class="string" id="6070691">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="6070695">+</span>&nbsp;<span class="ident" id="6070697"><a href="/gostd/net/mail/message.go.html#6070609">zone</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6070708"><a href="/gostd/net/mail/message.go.html#6070014">dateLayouts</a></span>&nbsp;<span class="op" id="6070720">=</span>&nbsp;<span class="builtinfunc" id="6070722">append</span><span class="op" id="6070728">(</span><span class="ident" id="6070729"><a href="/gostd/net/mail/message.go.html#6070014">dateLayouts</a></span><span class="op" id="6070740">,</span>&nbsp;<span class="ident" id="6070742"><a href="/gostd/net/mail/message.go.html#6070637">s</a></span><span class="op" id="6070743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6070750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6070756">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6070761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6070765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6070768">}</span><br>
<span class="lineno"></span><span class="op" id="6070770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="6070773">func</span>&nbsp;<span class="ident" id="6070778">parseDate</span><span class="op" id="6070787">(</span><span class="ident" id="6070788">date</span>&nbsp;<span class="builtintype" id="6070793">string</span><span class="op" id="6070799">)</span>&nbsp;<span class="op" id="6070801">(</span><span class="ident" id="6070802"><a href="/gostd/net/mail/message.go.html#6069277">time</a></span><span class="op" id="6070806">.</span><span class="ident" id="6070807"><a href="/gostd/time/time.go.html#2722087">Time</a></span><span class="op" id="6070811">,</span>&nbsp;<span class="builtintype" id="6070813">error</span><span class="op" id="6070818">)</span>&nbsp;<span class="op" id="6070820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6070823">for</span>&nbsp;<span class="ident" id="6070827">_</span><span class="op" id="6070828">,</span>&nbsp;<span class="ident" id="6070830">layout</span>&nbsp;<span class="op" id="6070837">:=</span>&nbsp;<span class="keyword" id="6070840">range</span>&nbsp;<span class="ident" id="6070846"><a href="/gostd/net/mail/message.go.html#6070014">dateLayouts</a></span>&nbsp;<span class="op" id="6070858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6070862">t</span><span class="op" id="6070863">,</span>&nbsp;<span class="ident" id="6070865">err</span>&nbsp;<span class="op" id="6070869">:=</span>&nbsp;<span class="ident" id="6070872"><a href="/gostd/net/mail/message.go.html#6069277">time</a></span><span class="op" id="6070876">.</span><span class="ident" id="6070877"><a href="/gostd/time/format.go.html#2699353">Parse</a></span><span class="op" id="6070882">(</span><span class="ident" id="6070883"><a href="/gostd/net/mail/message.go.html#6070830">layout</a></span><span class="op" id="6070889">,</span>&nbsp;<span class="ident" id="6070891"><a href="/gostd/net/mail/message.go.html#6070788">date</a></span><span class="op" id="6070895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6070899">if</span>&nbsp;<span class="ident" id="6070902"><a href="/gostd/net/mail/message.go.html#6070865">err</a></span>&nbsp;<span class="op" id="6070906">==</span>&nbsp;<span class="builtintype" id="6070909">nil</span>&nbsp;<span class="op" id="6070913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6070918">return</span>&nbsp;<span class="ident" id="6070925"><a href="/gostd/net/mail/message.go.html#6070862">t</a></span><span class="op" id="6070926">,</span>&nbsp;<span class="builtintype" id="6070928">nil</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6070934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6070937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6070940">return</span>&nbsp;<span class="ident" id="6070947"><a href="/gostd/net/mail/message.go.html#6069277">time</a></span><span class="op" id="6070951">.</span><span class="ident" id="6070952"><a href="/gostd/time/time.go.html#2722087">Time</a></span><span class="op" id="6070956">{</span><span class="op" id="6070957">}</span><span class="op" id="6070958">,</span>&nbsp;<span class="ident" id="6070960"><a href="/gostd/net/mail/message.go.html#6069195">errors</a></span><span class="op" id="6070966">.</span><span class="ident" id="6070967"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="6070970">(</span><span class="string" id="6070971">&#34;mail:&nbsp;header&nbsp;could&nbsp;not&nbsp;be&nbsp;parsed&#34;</span><span class="op" id="6071005">)</span><br>
<span class="lineno"></span><span class="op" id="6071007">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="6071010">//&nbsp;A&nbsp;Header&nbsp;represents&nbsp;the&nbsp;key-value&nbsp;pairs&nbsp;in&nbsp;a&nbsp;mail&nbsp;message&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="6071079">type</span>&nbsp;<span class="ident" id="6071084">Header</span>&nbsp;<span class="keyword" id="6071091">map</span><span class="op" id="6071094">[</span><span class="builtintype" id="6071095">string</span><span class="op" id="6071101">]</span><span class="op" id="6071102">[</span><span class="op" id="6071103">]</span><span class="builtintype" id="6071104">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6071112">//&nbsp;Get&nbsp;gets&nbsp;the&nbsp;first&nbsp;value&nbsp;associated&nbsp;with&nbsp;the&nbsp;given&nbsp;key.</span><br>
<span class="lineno"></span><span class="comment" id="6071171">//&nbsp;If&nbsp;there&nbsp;are&nbsp;no&nbsp;values&nbsp;associated&nbsp;with&nbsp;the&nbsp;key,&nbsp;Get&nbsp;returns&nbsp;&#34;&#34;.</span><br>
<span class="lineno">110</span><span class="keyword" id="6071238">func</span>&nbsp;<span class="op" id="6071243">(</span><span class="ident" id="6071244">h</span>&nbsp;<span class="ident" id="6071246"><a href="/gostd/net/mail/message.go.html#6071084">Header</a></span><span class="op" id="6071252">)</span>&nbsp;<span class="ident" id="6071254">Get</span><span class="op" id="6071257">(</span><span class="ident" id="6071258">key</span>&nbsp;<span class="builtintype" id="6071262">string</span><span class="op" id="6071268">)</span>&nbsp;<span class="builtintype" id="6071270">string</span>&nbsp;<span class="op" id="6071277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6071280">return</span>&nbsp;<span class="ident" id="6071287"><a href="/gostd/net/mail/message.go.html#6069238">textproto</a></span><span class="op" id="6071296">.</span><span class="ident" id="6071297"><a href="/gostd/net/textproto/header.go.html#4328626">MIMEHeader</a></span><span class="op" id="6071307">(</span><span class="ident" id="6071308"><a href="/gostd/net/mail/message.go.html#6071244">h</a></span><span class="op" id="6071309">)</span><span class="op" id="6071310">.</span><span class="ident" id="6071311"><a href="/gostd/net/textproto/header.go.html#4329349">Get</a></span><span class="op" id="6071314">(</span><span class="ident" id="6071315"><a href="/gostd/net/mail/message.go.html#6071258">key</a></span><span class="op" id="6071318">)</span><br>
<span class="lineno"></span><span class="op" id="6071320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6071323">var</span>&nbsp;<span class="ident" id="6071327">ErrHeaderNotPresent</span>&nbsp;<span class="op" id="6071347">=</span>&nbsp;<span class="ident" id="6071349"><a href="/gostd/net/mail/message.go.html#6069195">errors</a></span><span class="op" id="6071355">.</span><span class="ident" id="6071356"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="6071359">(</span><span class="string" id="6071360">&#34;mail:&nbsp;header&nbsp;not&nbsp;in&nbsp;message&#34;</span><span class="op" id="6071389">)</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="6071392">//&nbsp;Date&nbsp;parses&nbsp;the&nbsp;Date&nbsp;header&nbsp;field.</span><br>
<span class="lineno"></span><span class="keyword" id="6071430">func</span>&nbsp;<span class="op" id="6071435">(</span><span class="ident" id="6071436">h</span>&nbsp;<span class="ident" id="6071438"><a href="/gostd/net/mail/message.go.html#6071084">Header</a></span><span class="op" id="6071444">)</span>&nbsp;<span class="ident" id="6071446">Date</span><span class="op" id="6071450">(</span><span class="op" id="6071451">)</span>&nbsp;<span class="op" id="6071453">(</span><span class="ident" id="6071454"><a href="/gostd/net/mail/message.go.html#6069277">time</a></span><span class="op" id="6071458">.</span><span class="ident" id="6071459"><a href="/gostd/time/time.go.html#2722087">Time</a></span><span class="op" id="6071463">,</span>&nbsp;<span class="builtintype" id="6071465">error</span><span class="op" id="6071470">)</span>&nbsp;<span class="op" id="6071472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6071475">hdr</span>&nbsp;<span class="op" id="6071479">:=</span>&nbsp;<span class="ident" id="6071482"><a href="/gostd/net/mail/message.go.html#6071436">h</a></span><span class="op" id="6071483">.</span><span class="ident" id="6071484"><a href="/gostd/net/mail/message.go.html#6071254">Get</a></span><span class="op" id="6071487">(</span><span class="string" id="6071488">&#34;Date&#34;</span><span class="op" id="6071494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6071497">if</span>&nbsp;<span class="ident" id="6071500"><a href="/gostd/net/mail/message.go.html#6071475">hdr</a></span>&nbsp;<span class="op" id="6071504">==</span>&nbsp;<span class="string" id="6071507">&#34;&#34;</span>&nbsp;<span class="op" id="6071510">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6071514">return</span>&nbsp;<span class="ident" id="6071521"><a href="/gostd/net/mail/message.go.html#6069277">time</a></span><span class="op" id="6071525">.</span><span class="ident" id="6071526"><a href="/gostd/time/time.go.html#2722087">Time</a></span><span class="op" id="6071530">{</span><span class="op" id="6071531">}</span><span class="op" id="6071532">,</span>&nbsp;<span class="ident" id="6071534"><a href="/gostd/net/mail/message.go.html#6071327">ErrHeaderNotPresent</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6071555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6071558">return</span>&nbsp;<span class="ident" id="6071565"><a href="/gostd/net/mail/message.go.html#6070778">parseDate</a></span><span class="op" id="6071574">(</span><span class="ident" id="6071575"><a href="/gostd/net/mail/message.go.html#6071475">hdr</a></span><span class="op" id="6071578">)</span><br>
<span class="lineno"></span><span class="op" id="6071580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="6071583">//&nbsp;AddressList&nbsp;parses&nbsp;the&nbsp;named&nbsp;header&nbsp;field&nbsp;as&nbsp;a&nbsp;list&nbsp;of&nbsp;addresses.</span><br>
<span class="lineno"></span><span class="keyword" id="6071652">func</span>&nbsp;<span class="op" id="6071657">(</span><span class="ident" id="6071658">h</span>&nbsp;<span class="ident" id="6071660"><a href="/gostd/net/mail/message.go.html#6071084">Header</a></span><span class="op" id="6071666">)</span>&nbsp;<span class="ident" id="6071668">AddressList</span><span class="op" id="6071679">(</span><span class="ident" id="6071680">key</span>&nbsp;<span class="builtintype" id="6071684">string</span><span class="op" id="6071690">)</span>&nbsp;<span class="op" id="6071692">(</span><span class="op" id="6071693">[</span><span class="op" id="6071694">]</span><span class="op" id="6071695">*</span><span class="ident" id="6071696"><a href="/gostd/net/mail/message.go.html#6072000">Address</a></span><span class="op" id="6071703">,</span>&nbsp;<span class="builtintype" id="6071705">error</span><span class="op" id="6071710">)</span>&nbsp;<span class="op" id="6071712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6071715">hdr</span>&nbsp;<span class="op" id="6071719">:=</span>&nbsp;<span class="ident" id="6071722"><a href="/gostd/net/mail/message.go.html#6071658">h</a></span><span class="op" id="6071723">.</span><span class="ident" id="6071724"><a href="/gostd/net/mail/message.go.html#6071254">Get</a></span><span class="op" id="6071727">(</span><span class="ident" id="6071728"><a href="/gostd/net/mail/message.go.html#6071680">key</a></span><span class="op" id="6071731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6071734">if</span>&nbsp;<span class="ident" id="6071737"><a href="/gostd/net/mail/message.go.html#6071715">hdr</a></span>&nbsp;<span class="op" id="6071741">==</span>&nbsp;<span class="string" id="6071744">&#34;&#34;</span>&nbsp;<span class="op" id="6071747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6071751">return</span>&nbsp;<span class="builtintype" id="6071758">nil</span><span class="op" id="6071761">,</span>&nbsp;<span class="ident" id="6071763"><a href="/gostd/net/mail/message.go.html#6071327">ErrHeaderNotPresent</a></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6071784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6071787">return</span>&nbsp;<span class="ident" id="6071794"><a href="/gostd/net/mail/message.go.html#6072346">ParseAddressList</a></span><span class="op" id="6071810">(</span><span class="ident" id="6071811"><a href="/gostd/net/mail/message.go.html#6071715">hdr</a></span><span class="op" id="6071814">)</span><br>
<span class="lineno"></span><span class="op" id="6071816">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6071819">//&nbsp;Address&nbsp;represents&nbsp;a&nbsp;single&nbsp;mail&nbsp;address.</span><br>
<span class="lineno">135</span><span class="comment" id="6071864">//&nbsp;An&nbsp;address&nbsp;such&nbsp;as&nbsp;&#34;Barry&nbsp;Gibbs&nbsp;&lt;bg@example.com&gt;&#34;&nbsp;is&nbsp;represented</span><br>
<span class="lineno"></span><span class="comment" id="6071932">//&nbsp;as&nbsp;Address{Name:&nbsp;&#34;Barry&nbsp;Gibbs&#34;,&nbsp;Address:&nbsp;&#34;bg@example.com&#34;}.</span><br>
<span class="lineno"></span><span class="keyword" id="6071995">type</span>&nbsp;<span class="ident" id="6072000">Address</span>&nbsp;<span class="keyword" id="6072008">struct</span>&nbsp;<span class="op" id="6072015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6072018">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6072026">string</span>&nbsp;<span class="comment" id="6072033">//&nbsp;Proper&nbsp;name;&nbsp;may&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6072064">Address</span>&nbsp;<span class="builtintype" id="6072072">string</span>&nbsp;<span class="comment" id="6072079">//&nbsp;user@domain</span><br>
<span class="lineno">140</span><span class="op" id="6072094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6072097">//&nbsp;Parses&nbsp;a&nbsp;single&nbsp;RFC&nbsp;5322&nbsp;address,&nbsp;e.g.&nbsp;&#34;Barry&nbsp;Gibbs&nbsp;&lt;bg@example.com&gt;&#34;</span><br>
<span class="lineno"></span><span class="keyword" id="6072170">func</span>&nbsp;<span class="ident" id="6072175">ParseAddress</span><span class="op" id="6072187">(</span><span class="ident" id="6072188">address</span>&nbsp;<span class="builtintype" id="6072196">string</span><span class="op" id="6072202">)</span>&nbsp;<span class="op" id="6072204">(</span><span class="op" id="6072205">*</span><span class="ident" id="6072206"><a href="/gostd/net/mail/message.go.html#6072000">Address</a></span><span class="op" id="6072213">,</span>&nbsp;<span class="builtintype" id="6072215">error</span><span class="op" id="6072220">)</span>&nbsp;<span class="op" id="6072222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6072225">return</span>&nbsp;<span class="ident" id="6072232"><a href="/gostd/net/mail/message.go.html#6073638">newAddrParser</a></span><span class="op" id="6072245">(</span><span class="ident" id="6072246"><a href="/gostd/net/mail/message.go.html#6072188">address</a></span><span class="op" id="6072253">)</span><span class="op" id="6072254">.</span><span class="ident" id="6072255"><a href="/gostd/net/mail/message.go.html#6074154">parseAddress</a></span><span class="op" id="6072267">(</span><span class="op" id="6072268">)</span><br>
<span class="lineno">145</span><span class="op" id="6072270">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6072273">//&nbsp;ParseAddressList&nbsp;parses&nbsp;the&nbsp;given&nbsp;string&nbsp;as&nbsp;a&nbsp;list&nbsp;of&nbsp;addresses.</span><br>
<span class="lineno"></span><span class="keyword" id="6072341">func</span>&nbsp;<span class="ident" id="6072346">ParseAddressList</span><span class="op" id="6072362">(</span><span class="ident" id="6072363">list</span>&nbsp;<span class="builtintype" id="6072368">string</span><span class="op" id="6072374">)</span>&nbsp;<span class="op" id="6072376">(</span><span class="op" id="6072377">[</span><span class="op" id="6072378">]</span><span class="op" id="6072379">*</span><span class="ident" id="6072380"><a href="/gostd/net/mail/message.go.html#6072000">Address</a></span><span class="op" id="6072387">,</span>&nbsp;<span class="builtintype" id="6072389">error</span><span class="op" id="6072394">)</span>&nbsp;<span class="op" id="6072396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6072399">return</span>&nbsp;<span class="ident" id="6072406"><a href="/gostd/net/mail/message.go.html#6073638">newAddrParser</a></span><span class="op" id="6072419">(</span><span class="ident" id="6072420"><a href="/gostd/net/mail/message.go.html#6072363">list</a></span><span class="op" id="6072424">)</span><span class="op" id="6072425">.</span><span class="ident" id="6072426"><a href="/gostd/net/mail/message.go.html#6073731">parseAddressList</a></span><span class="op" id="6072442">(</span><span class="op" id="6072443">)</span><br>
<span class="lineno">150</span><span class="op" id="6072445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6072448">//&nbsp;String&nbsp;formats&nbsp;the&nbsp;address&nbsp;as&nbsp;a&nbsp;valid&nbsp;RFC&nbsp;5322&nbsp;address.</span><br>
<span class="lineno"></span><span class="comment" id="6072507">//&nbsp;If&nbsp;the&nbsp;address&#39;s&nbsp;name&nbsp;contains&nbsp;non-ASCII&nbsp;characters</span><br>
<span class="lineno"></span><span class="comment" id="6072562">//&nbsp;the&nbsp;name&nbsp;will&nbsp;be&nbsp;rendered&nbsp;according&nbsp;to&nbsp;RFC&nbsp;2047.</span><br>
<span class="lineno">155</span><span class="keyword" id="6072614">func</span>&nbsp;<span class="op" id="6072619">(</span><span class="ident" id="6072620">a</span>&nbsp;<span class="op" id="6072622">*</span><span class="ident" id="6072623"><a href="/gostd/net/mail/message.go.html#6072000">Address</a></span><span class="op" id="6072630">)</span>&nbsp;<span class="ident" id="6072632">String</span><span class="op" id="6072638">(</span><span class="op" id="6072639">)</span>&nbsp;<span class="builtintype" id="6072641">string</span>&nbsp;<span class="op" id="6072648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6072651">s</span>&nbsp;<span class="op" id="6072653">:=</span>&nbsp;<span class="string" id="6072656">&#34;&lt;&#34;</span>&nbsp;<span class="op" id="6072660">+</span>&nbsp;<span class="ident" id="6072662"><a href="/gostd/net/mail/message.go.html#6072620">a</a></span><span class="op" id="6072663">.</span><span class="ident" id="6072664"><a href="/gostd/net/mail/message.go.html#6072064">Address</a></span>&nbsp;<span class="op" id="6072672">+</span>&nbsp;<span class="string" id="6072674">&#34;&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6072679">if</span>&nbsp;<span class="ident" id="6072682"><a href="/gostd/net/mail/message.go.html#6072620">a</a></span><span class="op" id="6072683">.</span><span class="ident" id="6072684"><a href="/gostd/net/mail/message.go.html#6072018">Name</a></span>&nbsp;<span class="op" id="6072689">==</span>&nbsp;<span class="string" id="6072692">&#34;&#34;</span>&nbsp;<span class="op" id="6072695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6072699">return</span>&nbsp;<span class="ident" id="6072706"><a href="/gostd/net/mail/message.go.html#6072651">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6072709">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6072712">//&nbsp;If&nbsp;every&nbsp;character&nbsp;is&nbsp;printable&nbsp;ASCII,&nbsp;quoting&nbsp;is&nbsp;simple.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6072774">allPrintable</span>&nbsp;<span class="op" id="6072787">:=</span>&nbsp;<span class="builtintype" id="6072790">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6072796">for</span>&nbsp;<span class="ident" id="6072800">i</span>&nbsp;<span class="op" id="6072802">:=</span>&nbsp;<span class="num" id="6072805">0</span><span class="op" id="6072806">;</span>&nbsp;<span class="ident" id="6072808"><a href="/gostd/net/mail/message.go.html#6072800">i</a></span>&nbsp;<span class="op" id="6072810">&lt;</span>&nbsp;<span class="builtinfunc" id="6072812">len</span><span class="op" id="6072815">(</span><span class="ident" id="6072816"><a href="/gostd/net/mail/message.go.html#6072620">a</a></span><span class="op" id="6072817">.</span><span class="ident" id="6072818"><a href="/gostd/net/mail/message.go.html#6072018">Name</a></span><span class="op" id="6072822">)</span><span class="op" id="6072823">;</span>&nbsp;<span class="ident" id="6072825"><a href="/gostd/net/mail/message.go.html#6072800">i</a></span><span class="op" id="6072826">++</span>&nbsp;<span class="op" id="6072829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6072833">//&nbsp;isWSP&nbsp;here&nbsp;should&nbsp;actually&nbsp;be&nbsp;isFWS,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6072875">//&nbsp;but&nbsp;we&nbsp;don&#39;t&nbsp;support&nbsp;folding&nbsp;yet.</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6072914">if</span>&nbsp;<span class="op" id="6072917">!</span><span class="ident" id="6072918"><a href="/gostd/net/mail/message.go.html#6081766">isVchar</a></span><span class="op" id="6072925">(</span><span class="ident" id="6072926"><a href="/gostd/net/mail/message.go.html#6072620">a</a></span><span class="op" id="6072927">.</span><span class="ident" id="6072928"><a href="/gostd/net/mail/message.go.html#6072018">Name</a></span><span class="op" id="6072932">[</span><span class="ident" id="6072933"><a href="/gostd/net/mail/message.go.html#6072800">i</a></span><span class="op" id="6072934">]</span><span class="op" id="6072935">)</span>&nbsp;<span class="op" id="6072937">&amp;&amp;</span>&nbsp;<span class="op" id="6072940">!</span><span class="ident" id="6072941"><a href="/gostd/net/mail/message.go.html#6081970">isWSP</a></span><span class="op" id="6072946">(</span><span class="ident" id="6072947"><a href="/gostd/net/mail/message.go.html#6072620">a</a></span><span class="op" id="6072948">.</span><span class="ident" id="6072949"><a href="/gostd/net/mail/message.go.html#6072018">Name</a></span><span class="op" id="6072953">[</span><span class="ident" id="6072954"><a href="/gostd/net/mail/message.go.html#6072800">i</a></span><span class="op" id="6072955">]</span><span class="op" id="6072956">)</span>&nbsp;<span class="op" id="6072958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6072963"><a href="/gostd/net/mail/message.go.html#6072774">allPrintable</a></span>&nbsp;<span class="op" id="6072976">=</span>&nbsp;<span class="builtintype" id="6072978">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6072987">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6072995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6072998">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6073001">if</span>&nbsp;<span class="ident" id="6073004"><a href="/gostd/net/mail/message.go.html#6072774">allPrintable</a></span>&nbsp;<span class="op" id="6073017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6073021">b</span>&nbsp;<span class="op" id="6073023">:=</span>&nbsp;<span class="ident" id="6073026"><a href="/gostd/net/mail/message.go.html#6069167">bytes</a></span><span class="op" id="6073031">.</span><span class="ident" id="6073032"><a href="/gostd/bytes/buffer.go.html#1395915">NewBufferString</a></span><span class="op" id="6073047">(</span><span class="string" id="6073048">`&#34;`</span><span class="op" id="6073051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6073055">for</span>&nbsp;<span class="ident" id="6073059">i</span>&nbsp;<span class="op" id="6073061">:=</span>&nbsp;<span class="num" id="6073064">0</span><span class="op" id="6073065">;</span>&nbsp;<span class="ident" id="6073067"><a href="/gostd/net/mail/message.go.html#6073059">i</a></span>&nbsp;<span class="op" id="6073069">&lt;</span>&nbsp;<span class="builtinfunc" id="6073071">len</span><span class="op" id="6073074">(</span><span class="ident" id="6073075"><a href="/gostd/net/mail/message.go.html#6072620">a</a></span><span class="op" id="6073076">.</span><span class="ident" id="6073077"><a href="/gostd/net/mail/message.go.html#6072018">Name</a></span><span class="op" id="6073081">)</span><span class="op" id="6073082">;</span>&nbsp;<span class="ident" id="6073084"><a href="/gostd/net/mail/message.go.html#6073059">i</a></span><span class="op" id="6073085">++</span>&nbsp;<span class="op" id="6073088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6073093">if</span>&nbsp;<span class="op" id="6073096">!</span><span class="ident" id="6073097"><a href="/gostd/net/mail/message.go.html#6081545">isQtext</a></span><span class="op" id="6073104">(</span><span class="ident" id="6073105"><a href="/gostd/net/mail/message.go.html#6072620">a</a></span><span class="op" id="6073106">.</span><span class="ident" id="6073107"><a href="/gostd/net/mail/message.go.html#6072018">Name</a></span><span class="op" id="6073111">[</span><span class="ident" id="6073112"><a href="/gostd/net/mail/message.go.html#6073059">i</a></span><span class="op" id="6073113">]</span><span class="op" id="6073114">)</span>&nbsp;<span class="op" id="6073116">&amp;&amp;</span>&nbsp;<span class="op" id="6073119">!</span><span class="ident" id="6073120"><a href="/gostd/net/mail/message.go.html#6081970">isWSP</a></span><span class="op" id="6073125">(</span><span class="ident" id="6073126"><a href="/gostd/net/mail/message.go.html#6072620">a</a></span><span class="op" id="6073127">.</span><span class="ident" id="6073128"><a href="/gostd/net/mail/message.go.html#6072018">Name</a></span><span class="op" id="6073132">[</span><span class="ident" id="6073133"><a href="/gostd/net/mail/message.go.html#6073059">i</a></span><span class="op" id="6073134">]</span><span class="op" id="6073135">)</span>&nbsp;<span class="op" id="6073137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6073143"><a href="/gostd/net/mail/message.go.html#6073021">b</a></span><span class="op" id="6073144">.</span><span class="ident" id="6073145"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="6073154">(</span><span class="string" id="6073155">&#39;\\&#39;</span><span class="op" id="6073159">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6073164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6073169"><a href="/gostd/net/mail/message.go.html#6073021">b</a></span><span class="op" id="6073170">.</span><span class="ident" id="6073171"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="6073180">(</span><span class="ident" id="6073181"><a href="/gostd/net/mail/message.go.html#6072620">a</a></span><span class="op" id="6073182">.</span><span class="ident" id="6073183"><a href="/gostd/net/mail/message.go.html#6072018">Name</a></span><span class="op" id="6073187">[</span><span class="ident" id="6073188"><a href="/gostd/net/mail/message.go.html#6073059">i</a></span><span class="op" id="6073189">]</span><span class="op" id="6073190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6073194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6073198"><a href="/gostd/net/mail/message.go.html#6073021">b</a></span><span class="op" id="6073199">.</span><span class="ident" id="6073200"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="6073211">(</span><span class="string" id="6073212">`&#34;&nbsp;`</span><span class="op" id="6073216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6073220"><a href="/gostd/net/mail/message.go.html#6073021">b</a></span><span class="op" id="6073221">.</span><span class="ident" id="6073222"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="6073233">(</span><span class="ident" id="6073234"><a href="/gostd/net/mail/message.go.html#6072651">s</a></span><span class="op" id="6073235">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6073239">return</span>&nbsp;<span class="ident" id="6073246"><a href="/gostd/net/mail/message.go.html#6073021">b</a></span><span class="op" id="6073247">.</span><span class="ident" id="6073248"><a href="/gostd/bytes/buffer.go.html#1384648">String</a></span><span class="op" id="6073254">(</span><span class="op" id="6073255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6073258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6073262">//&nbsp;UTF-8&nbsp;&#34;Q&#34;&nbsp;encoding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6073285">b</span>&nbsp;<span class="op" id="6073287">:=</span>&nbsp;<span class="ident" id="6073290"><a href="/gostd/net/mail/message.go.html#6069167">bytes</a></span><span class="op" id="6073295">.</span><span class="ident" id="6073296"><a href="/gostd/bytes/buffer.go.html#1395915">NewBufferString</a></span><span class="op" id="6073311">(</span><span class="string" id="6073312">&#34;=?utf-8?q?&#34;</span><span class="op" id="6073324">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6073327">for</span>&nbsp;<span class="ident" id="6073331">i</span>&nbsp;<span class="op" id="6073333">:=</span>&nbsp;<span class="num" id="6073336">0</span><span class="op" id="6073337">;</span>&nbsp;<span class="ident" id="6073339"><a href="/gostd/net/mail/message.go.html#6073331">i</a></span>&nbsp;<span class="op" id="6073341">&lt;</span>&nbsp;<span class="builtinfunc" id="6073343">len</span><span class="op" id="6073346">(</span><span class="ident" id="6073347"><a href="/gostd/net/mail/message.go.html#6072620">a</a></span><span class="op" id="6073348">.</span><span class="ident" id="6073349"><a href="/gostd/net/mail/message.go.html#6072018">Name</a></span><span class="op" id="6073353">)</span><span class="op" id="6073354">;</span>&nbsp;<span class="ident" id="6073356"><a href="/gostd/net/mail/message.go.html#6073331">i</a></span><span class="op" id="6073357">++</span>&nbsp;<span class="op" id="6073360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6073364">switch</span>&nbsp;<span class="ident" id="6073371">c</span>&nbsp;<span class="op" id="6073373">:=</span>&nbsp;<span class="ident" id="6073376"><a href="/gostd/net/mail/message.go.html#6072620">a</a></span><span class="op" id="6073377">.</span><span class="ident" id="6073378"><a href="/gostd/net/mail/message.go.html#6072018">Name</a></span><span class="op" id="6073382">[</span><span class="ident" id="6073383"><a href="/gostd/net/mail/message.go.html#6073331">i</a></span><span class="op" id="6073384">]</span><span class="op" id="6073385">;</span>&nbsp;<span class="op" id="6073387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6073391">case</span>&nbsp;<span class="ident" id="6073396"><a href="/gostd/net/mail/message.go.html#6073371">c</a></span>&nbsp;<span class="op" id="6073398">==</span>&nbsp;<span class="string" id="6073401">&#39;&nbsp;&#39;</span><span class="op" id="6073404">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6073409"><a href="/gostd/net/mail/message.go.html#6073285">b</a></span><span class="op" id="6073410">.</span><span class="ident" id="6073411"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="6073420">(</span><span class="string" id="6073421">&#39;_&#39;</span><span class="op" id="6073424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6073428">case</span>&nbsp;<span class="ident" id="6073433"><a href="/gostd/net/mail/message.go.html#6081766">isVchar</a></span><span class="op" id="6073440">(</span><span class="ident" id="6073441"><a href="/gostd/net/mail/message.go.html#6073371">c</a></span><span class="op" id="6073442">)</span>&nbsp;<span class="op" id="6073444">&amp;&amp;</span>&nbsp;<span class="ident" id="6073447"><a href="/gostd/net/mail/message.go.html#6073371">c</a></span>&nbsp;<span class="op" id="6073449">!=</span>&nbsp;<span class="string" id="6073452">&#39;=&#39;</span>&nbsp;<span class="op" id="6073456">&amp;&amp;</span>&nbsp;<span class="ident" id="6073459"><a href="/gostd/net/mail/message.go.html#6073371">c</a></span>&nbsp;<span class="op" id="6073461">!=</span>&nbsp;<span class="string" id="6073464">&#39;?&#39;</span>&nbsp;<span class="op" id="6073468">&amp;&amp;</span>&nbsp;<span class="ident" id="6073471"><a href="/gostd/net/mail/message.go.html#6073371">c</a></span>&nbsp;<span class="op" id="6073473">!=</span>&nbsp;<span class="string" id="6073476">&#39;_&#39;</span><span class="op" id="6073479">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6073484"><a href="/gostd/net/mail/message.go.html#6073285">b</a></span><span class="op" id="6073485">.</span><span class="ident" id="6073486"><a href="/gostd/bytes/buffer.go.html#1390121">WriteByte</a></span><span class="op" id="6073495">(</span><span class="ident" id="6073496"><a href="/gostd/net/mail/message.go.html#6073371">c</a></span><span class="op" id="6073497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6073501">default</span><span class="op" id="6073508">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6073513"><a href="/gostd/net/mail/message.go.html#6069205">fmt</a></span><span class="op" id="6073516">.</span><span class="ident" id="6073517"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="6073524">(</span><span class="ident" id="6073525"><a href="/gostd/net/mail/message.go.html#6073285">b</a></span><span class="op" id="6073526">,</span>&nbsp;<span class="string" id="6073528">&#34;=%02X&#34;</span><span class="op" id="6073535">,</span>&nbsp;<span class="ident" id="6073537"><a href="/gostd/net/mail/message.go.html#6073371">c</a></span><span class="op" id="6073538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6073542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6073545">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6073548"><a href="/gostd/net/mail/message.go.html#6073285">b</a></span><span class="op" id="6073549">.</span><span class="ident" id="6073550"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="6073561">(</span><span class="string" id="6073562">&#34;?=&nbsp;&#34;</span><span class="op" id="6073567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6073570"><a href="/gostd/net/mail/message.go.html#6073285">b</a></span><span class="op" id="6073571">.</span><span class="ident" id="6073572"><a href="/gostd/bytes/buffer.go.html#1387374">WriteString</a></span><span class="op" id="6073583">(</span><span class="ident" id="6073584"><a href="/gostd/net/mail/message.go.html#6072651">s</a></span><span class="op" id="6073585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6073588">return</span>&nbsp;<span class="ident" id="6073595"><a href="/gostd/net/mail/message.go.html#6073285">b</a></span><span class="op" id="6073596">.</span><span class="ident" id="6073597"><a href="/gostd/bytes/buffer.go.html#1384648">String</a></span><span class="op" id="6073603">(</span><span class="op" id="6073604">)</span><br>
<span class="lineno"></span><span class="op" id="6073606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="6073609">type</span>&nbsp;<span class="ident" id="6073614">addrParser</span>&nbsp;<span class="op" id="6073625">[</span><span class="op" id="6073626">]</span><span class="builtintype" id="6073627">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6073633">func</span>&nbsp;<span class="ident" id="6073638">newAddrParser</span><span class="op" id="6073651">(</span><span class="ident" id="6073652">s</span>&nbsp;<span class="builtintype" id="6073654">string</span><span class="op" id="6073660">)</span>&nbsp;<span class="op" id="6073662">*</span><span class="ident" id="6073663"><a href="/gostd/net/mail/message.go.html#6073614">addrParser</a></span>&nbsp;<span class="op" id="6073674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6073677">p</span>&nbsp;<span class="op" id="6073679">:=</span>&nbsp;<span class="ident" id="6073682"><a href="/gostd/net/mail/message.go.html#6073614">addrParser</a></span><span class="op" id="6073692">(</span><span class="ident" id="6073693"><a href="/gostd/net/mail/message.go.html#6073652">s</a></span><span class="op" id="6073694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6073697">return</span>&nbsp;<span class="op" id="6073704">&amp;</span><span class="ident" id="6073705"><a href="/gostd/net/mail/message.go.html#6073677">p</a></span><br>
<span class="lineno">205</span><span class="op" id="6073707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6073710">func</span>&nbsp;<span class="op" id="6073715">(</span><span class="ident" id="6073716">p</span>&nbsp;<span class="op" id="6073718">*</span><span class="ident" id="6073719"><a href="/gostd/net/mail/message.go.html#6073614">addrParser</a></span><span class="op" id="6073729">)</span>&nbsp;<span class="ident" id="6073731">parseAddressList</span><span class="op" id="6073747">(</span><span class="op" id="6073748">)</span>&nbsp;<span class="op" id="6073750">(</span><span class="op" id="6073751">[</span><span class="op" id="6073752">]</span><span class="op" id="6073753">*</span><span class="ident" id="6073754"><a href="/gostd/net/mail/message.go.html#6072000">Address</a></span><span class="op" id="6073761">,</span>&nbsp;<span class="builtintype" id="6073763">error</span><span class="op" id="6073768">)</span>&nbsp;<span class="op" id="6073770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6073773">var</span>&nbsp;<span class="ident" id="6073777">list</span>&nbsp;<span class="op" id="6073782">[</span><span class="op" id="6073783">]</span><span class="op" id="6073784">*</span><span class="ident" id="6073785"><a href="/gostd/net/mail/message.go.html#6072000">Address</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6073794">for</span>&nbsp;<span class="op" id="6073798">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6073802"><a href="/gostd/net/mail/message.go.html#6073716">p</a></span><span class="op" id="6073803">.</span><span class="ident" id="6073804"><a href="/gostd/net/mail/message.go.html#6079112">skipSpace</a></span><span class="op" id="6073813">(</span><span class="op" id="6073814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6073818">addr</span><span class="op" id="6073822">,</span>&nbsp;<span class="ident" id="6073824">err</span>&nbsp;<span class="op" id="6073828">:=</span>&nbsp;<span class="ident" id="6073831"><a href="/gostd/net/mail/message.go.html#6073716">p</a></span><span class="op" id="6073832">.</span><span class="ident" id="6073833"><a href="/gostd/net/mail/message.go.html#6074154">parseAddress</a></span><span class="op" id="6073845">(</span><span class="op" id="6073846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6073850">if</span>&nbsp;<span class="ident" id="6073853"><a href="/gostd/net/mail/message.go.html#6073824">err</a></span>&nbsp;<span class="op" id="6073857">!=</span>&nbsp;<span class="builtintype" id="6073860">nil</span>&nbsp;<span class="op" id="6073864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6073869">return</span>&nbsp;<span class="builtintype" id="6073876">nil</span><span class="op" id="6073879">,</span>&nbsp;<span class="ident" id="6073881"><a href="/gostd/net/mail/message.go.html#6073824">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6073887">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6073891"><a href="/gostd/net/mail/message.go.html#6073777">list</a></span>&nbsp;<span class="op" id="6073896">=</span>&nbsp;<span class="builtinfunc" id="6073898">append</span><span class="op" id="6073904">(</span><span class="ident" id="6073905"><a href="/gostd/net/mail/message.go.html#6073777">list</a></span><span class="op" id="6073909">,</span>&nbsp;<span class="ident" id="6073911"><a href="/gostd/net/mail/message.go.html#6073818">addr</a></span><span class="op" id="6073915">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6073920"><a href="/gostd/net/mail/message.go.html#6073716">p</a></span><span class="op" id="6073921">.</span><span class="ident" id="6073922"><a href="/gostd/net/mail/message.go.html#6079112">skipSpace</a></span><span class="op" id="6073931">(</span><span class="op" id="6073932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6073936">if</span>&nbsp;<span class="ident" id="6073939"><a href="/gostd/net/mail/message.go.html#6073716">p</a></span><span class="op" id="6073940">.</span><span class="ident" id="6073941"><a href="/gostd/net/mail/message.go.html#6079236">empty</a></span><span class="op" id="6073946">(</span><span class="op" id="6073947">)</span>&nbsp;<span class="op" id="6073949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6073954">break</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6073962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6073966">if</span>&nbsp;<span class="op" id="6073969">!</span><span class="ident" id="6073970"><a href="/gostd/net/mail/message.go.html#6073716">p</a></span><span class="op" id="6073971">.</span><span class="ident" id="6073972"><a href="/gostd/net/mail/message.go.html#6078929">consume</a></span><span class="op" id="6073979">(</span><span class="string" id="6073980">&#39;,&#39;</span><span class="op" id="6073983">)</span>&nbsp;<span class="op" id="6073985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6073990">return</span>&nbsp;<span class="builtintype" id="6073997">nil</span><span class="op" id="6074000">,</span>&nbsp;<span class="ident" id="6074002"><a href="/gostd/net/mail/message.go.html#6069195">errors</a></span><span class="op" id="6074008">.</span><span class="ident" id="6074009"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="6074012">(</span><span class="string" id="6074013">&#34;mail:&nbsp;expected&nbsp;comma&#34;</span><span class="op" id="6074035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6074039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6074042">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6074045">return</span>&nbsp;<span class="ident" id="6074052"><a href="/gostd/net/mail/message.go.html#6073777">list</a></span><span class="op" id="6074056">,</span>&nbsp;<span class="builtintype" id="6074058">nil</span><br>
<span class="lineno"></span><span class="op" id="6074062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6074065">//&nbsp;parseAddress&nbsp;parses&nbsp;a&nbsp;single&nbsp;RFC&nbsp;5322&nbsp;address&nbsp;at&nbsp;the&nbsp;start&nbsp;of&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="6074133">func</span>&nbsp;<span class="op" id="6074138">(</span><span class="ident" id="6074139">p</span>&nbsp;<span class="op" id="6074141">*</span><span class="ident" id="6074142"><a href="/gostd/net/mail/message.go.html#6073614">addrParser</a></span><span class="op" id="6074152">)</span>&nbsp;<span class="ident" id="6074154">parseAddress</span><span class="op" id="6074166">(</span><span class="op" id="6074167">)</span>&nbsp;<span class="op" id="6074169">(</span><span class="ident" id="6074170">addr</span>&nbsp;<span class="op" id="6074175">*</span><span class="ident" id="6074176"><a href="/gostd/net/mail/message.go.html#6072000">Address</a></span><span class="op" id="6074183">,</span>&nbsp;<span class="ident" id="6074185">err</span>&nbsp;<span class="builtintype" id="6074189">error</span><span class="op" id="6074194">)</span>&nbsp;<span class="op" id="6074196">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6074199"><a href="/gostd/net/mail/message.go.html#6069302">debug</a></span><span class="op" id="6074204">.</span><span class="ident" id="6074205"><a href="/gostd/net/mail/message.go.html#6069359">Printf</a></span><span class="op" id="6074211">(</span><span class="string" id="6074212">&#34;parseAddress:&nbsp;%q&#34;</span><span class="op" id="6074230">,</span>&nbsp;<span class="op" id="6074232">*</span><span class="ident" id="6074233"><a href="/gostd/net/mail/message.go.html#6074139">p</a></span><span class="op" id="6074234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6074237"><a href="/gostd/net/mail/message.go.html#6074139">p</a></span><span class="op" id="6074238">.</span><span class="ident" id="6074239"><a href="/gostd/net/mail/message.go.html#6079112">skipSpace</a></span><span class="op" id="6074248">(</span><span class="op" id="6074249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6074252">if</span>&nbsp;<span class="ident" id="6074255"><a href="/gostd/net/mail/message.go.html#6074139">p</a></span><span class="op" id="6074256">.</span><span class="ident" id="6074257"><a href="/gostd/net/mail/message.go.html#6079236">empty</a></span><span class="op" id="6074262">(</span><span class="op" id="6074263">)</span>&nbsp;<span class="op" id="6074265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6074269">return</span>&nbsp;<span class="builtintype" id="6074276">nil</span><span class="op" id="6074279">,</span>&nbsp;<span class="ident" id="6074281"><a href="/gostd/net/mail/message.go.html#6069195">errors</a></span><span class="op" id="6074287">.</span><span class="ident" id="6074288"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="6074291">(</span><span class="string" id="6074292">&#34;mail:&nbsp;no&nbsp;address&#34;</span><span class="op" id="6074310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6074313">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6074317">//&nbsp;address&nbsp;=&nbsp;name-addr&nbsp;/&nbsp;addr-spec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6074353">//&nbsp;TODO(dsymonds):&nbsp;Support&nbsp;parsing&nbsp;group&nbsp;address.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6074405">//&nbsp;addr-spec&nbsp;has&nbsp;a&nbsp;more&nbsp;restricted&nbsp;grammar&nbsp;than&nbsp;name-addr,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6074465">//&nbsp;so&nbsp;try&nbsp;parsing&nbsp;it&nbsp;first,&nbsp;and&nbsp;fallback&nbsp;to&nbsp;name-addr.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6074521">//&nbsp;TODO(dsymonds):&nbsp;Is&nbsp;this&nbsp;really&nbsp;correct?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6074565">spec</span><span class="op" id="6074569">,</span>&nbsp;<span class="ident" id="6074571"><a href="/gostd/net/mail/message.go.html#6074185">err</a></span>&nbsp;<span class="op" id="6074575">:=</span>&nbsp;<span class="ident" id="6074578"><a href="/gostd/net/mail/message.go.html#6074139">p</a></span><span class="op" id="6074579">.</span><span class="ident" id="6074580"><a href="/gostd/net/mail/message.go.html#6075462">consumeAddrSpec</a></span><span class="op" id="6074595">(</span><span class="op" id="6074596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6074599">if</span>&nbsp;<span class="ident" id="6074602"><a href="/gostd/net/mail/message.go.html#6074185">err</a></span>&nbsp;<span class="op" id="6074606">==</span>&nbsp;<span class="builtintype" id="6074609">nil</span>&nbsp;<span class="op" id="6074613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6074617">return</span>&nbsp;<span class="op" id="6074624">&amp;</span><span class="ident" id="6074625"><a href="/gostd/net/mail/message.go.html#6072000">Address</a></span><span class="op" id="6074632">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6074637"><a href="/gostd/net/mail/message.go.html#6072064">Address</a></span><span class="op" id="6074644">:</span>&nbsp;<span class="ident" id="6074646"><a href="/gostd/net/mail/message.go.html#6074565">spec</a></span><span class="op" id="6074650">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6074654">}</span><span class="op" id="6074655">,</span>&nbsp;<span class="ident" id="6074657"><a href="/gostd/net/mail/message.go.html#6074185">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6074662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6074665"><a href="/gostd/net/mail/message.go.html#6069302">debug</a></span><span class="op" id="6074670">.</span><span class="ident" id="6074671"><a href="/gostd/net/mail/message.go.html#6069359">Printf</a></span><span class="op" id="6074677">(</span><span class="string" id="6074678">&#34;parseAddress:&nbsp;not&nbsp;an&nbsp;addr-spec:&nbsp;%v&#34;</span><span class="op" id="6074714">,</span>&nbsp;<span class="ident" id="6074716"><a href="/gostd/net/mail/message.go.html#6074185">err</a></span><span class="op" id="6074719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6074722"><a href="/gostd/net/mail/message.go.html#6069302">debug</a></span><span class="op" id="6074727">.</span><span class="ident" id="6074728"><a href="/gostd/net/mail/message.go.html#6069359">Printf</a></span><span class="op" id="6074734">(</span><span class="string" id="6074735">&#34;parseAddress:&nbsp;state&nbsp;is&nbsp;now&nbsp;%q&#34;</span><span class="op" id="6074766">,</span>&nbsp;<span class="op" id="6074768">*</span><span class="ident" id="6074769"><a href="/gostd/net/mail/message.go.html#6074139">p</a></span><span class="op" id="6074770">)</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6074774">//&nbsp;display-name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6074791">var</span>&nbsp;<span class="ident" id="6074795">displayName</span>&nbsp;<span class="builtintype" id="6074807">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6074815">if</span>&nbsp;<span class="ident" id="6074818"><a href="/gostd/net/mail/message.go.html#6074139">p</a></span><span class="op" id="6074819">.</span><span class="ident" id="6074820"><a href="/gostd/net/mail/message.go.html#6079182">peek</a></span><span class="op" id="6074824">(</span><span class="op" id="6074825">)</span>&nbsp;<span class="op" id="6074827">!=</span>&nbsp;<span class="string" id="6074830">&#39;&lt;&#39;</span>&nbsp;<span class="op" id="6074834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6074838"><a href="/gostd/net/mail/message.go.html#6074795">displayName</a></span><span class="op" id="6074849">,</span>&nbsp;<span class="ident" id="6074851"><a href="/gostd/net/mail/message.go.html#6074185">err</a></span>&nbsp;<span class="op" id="6074855">=</span>&nbsp;<span class="ident" id="6074857"><a href="/gostd/net/mail/message.go.html#6074139">p</a></span><span class="op" id="6074858">.</span><span class="ident" id="6074859"><a href="/gostd/net/mail/message.go.html#6076580">consumePhrase</a></span><span class="op" id="6074872">(</span><span class="op" id="6074873">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6074877">if</span>&nbsp;<span class="ident" id="6074880"><a href="/gostd/net/mail/message.go.html#6074185">err</a></span>&nbsp;<span class="op" id="6074884">!=</span>&nbsp;<span class="builtintype" id="6074887">nil</span>&nbsp;<span class="op" id="6074891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6074896">return</span>&nbsp;<span class="builtintype" id="6074903">nil</span><span class="op" id="6074906">,</span>&nbsp;<span class="ident" id="6074908"><a href="/gostd/net/mail/message.go.html#6074185">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6074914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6074917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6074920"><a href="/gostd/net/mail/message.go.html#6069302">debug</a></span><span class="op" id="6074925">.</span><span class="ident" id="6074926"><a href="/gostd/net/mail/message.go.html#6069359">Printf</a></span><span class="op" id="6074932">(</span><span class="string" id="6074933">&#34;parseAddress:&nbsp;displayName=%q&#34;</span><span class="op" id="6074963">,</span>&nbsp;<span class="ident" id="6074965"><a href="/gostd/net/mail/message.go.html#6074795">displayName</a></span><span class="op" id="6074976">)</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6074980">//&nbsp;angle-addr&nbsp;=&nbsp;&#34;&lt;&#34;&nbsp;addr-spec&nbsp;&#34;&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6075015"><a href="/gostd/net/mail/message.go.html#6074139">p</a></span><span class="op" id="6075016">.</span><span class="ident" id="6075017"><a href="/gostd/net/mail/message.go.html#6079112">skipSpace</a></span><span class="op" id="6075026">(</span><span class="op" id="6075027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6075030">if</span>&nbsp;<span class="op" id="6075033">!</span><span class="ident" id="6075034"><a href="/gostd/net/mail/message.go.html#6074139">p</a></span><span class="op" id="6075035">.</span><span class="ident" id="6075036"><a href="/gostd/net/mail/message.go.html#6078929">consume</a></span><span class="op" id="6075043">(</span><span class="string" id="6075044">&#39;&lt;&#39;</span><span class="op" id="6075047">)</span>&nbsp;<span class="op" id="6075049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6075053">return</span>&nbsp;<span class="builtintype" id="6075060">nil</span><span class="op" id="6075063">,</span>&nbsp;<span class="ident" id="6075065"><a href="/gostd/net/mail/message.go.html#6069195">errors</a></span><span class="op" id="6075071">.</span><span class="ident" id="6075072"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="6075075">(</span><span class="string" id="6075076">&#34;mail:&nbsp;no&nbsp;angle-addr&#34;</span><span class="op" id="6075097">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6075100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6075103"><a href="/gostd/net/mail/message.go.html#6074565">spec</a></span><span class="op" id="6075107">,</span>&nbsp;<span class="ident" id="6075109"><a href="/gostd/net/mail/message.go.html#6074185">err</a></span>&nbsp;<span class="op" id="6075113">=</span>&nbsp;<span class="ident" id="6075115"><a href="/gostd/net/mail/message.go.html#6074139">p</a></span><span class="op" id="6075116">.</span><span class="ident" id="6075117"><a href="/gostd/net/mail/message.go.html#6075462">consumeAddrSpec</a></span><span class="op" id="6075132">(</span><span class="op" id="6075133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6075136">if</span>&nbsp;<span class="ident" id="6075139"><a href="/gostd/net/mail/message.go.html#6074185">err</a></span>&nbsp;<span class="op" id="6075143">!=</span>&nbsp;<span class="builtintype" id="6075146">nil</span>&nbsp;<span class="op" id="6075150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6075154">return</span>&nbsp;<span class="builtintype" id="6075161">nil</span><span class="op" id="6075164">,</span>&nbsp;<span class="ident" id="6075166"><a href="/gostd/net/mail/message.go.html#6074185">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6075171">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6075174">if</span>&nbsp;<span class="op" id="6075177">!</span><span class="ident" id="6075178"><a href="/gostd/net/mail/message.go.html#6074139">p</a></span><span class="op" id="6075179">.</span><span class="ident" id="6075180"><a href="/gostd/net/mail/message.go.html#6078929">consume</a></span><span class="op" id="6075187">(</span><span class="string" id="6075188">&#39;&gt;&#39;</span><span class="op" id="6075191">)</span>&nbsp;<span class="op" id="6075193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6075197">return</span>&nbsp;<span class="builtintype" id="6075204">nil</span><span class="op" id="6075207">,</span>&nbsp;<span class="ident" id="6075209"><a href="/gostd/net/mail/message.go.html#6069195">errors</a></span><span class="op" id="6075215">.</span><span class="ident" id="6075216"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="6075219">(</span><span class="string" id="6075220">&#34;mail:&nbsp;unclosed&nbsp;angle-addr&#34;</span><span class="op" id="6075247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6075250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6075253"><a href="/gostd/net/mail/message.go.html#6069302">debug</a></span><span class="op" id="6075258">.</span><span class="ident" id="6075259"><a href="/gostd/net/mail/message.go.html#6069359">Printf</a></span><span class="op" id="6075265">(</span><span class="string" id="6075266">&#34;parseAddress:&nbsp;spec=%q&#34;</span><span class="op" id="6075289">,</span>&nbsp;<span class="ident" id="6075291"><a href="/gostd/net/mail/message.go.html#6074565">spec</a></span><span class="op" id="6075295">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6075299">return</span>&nbsp;<span class="op" id="6075306">&amp;</span><span class="ident" id="6075307"><a href="/gostd/net/mail/message.go.html#6072000">Address</a></span><span class="op" id="6075314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6075318"><a href="/gostd/net/mail/message.go.html#6072018">Name</a></span><span class="op" id="6075322">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6075327"><a href="/gostd/net/mail/message.go.html#6074795">displayName</a></span><span class="op" id="6075338">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6075342"><a href="/gostd/net/mail/message.go.html#6072064">Address</a></span><span class="op" id="6075349">:</span>&nbsp;<span class="ident" id="6075351"><a href="/gostd/net/mail/message.go.html#6074565">spec</a></span><span class="op" id="6075355">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6075358">}</span><span class="op" id="6075359">,</span>&nbsp;<span class="builtintype" id="6075361">nil</span><br>
<span class="lineno"></span><span class="op" id="6075365">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="comment" id="6075368">//&nbsp;consumeAddrSpec&nbsp;parses&nbsp;a&nbsp;single&nbsp;RFC&nbsp;5322&nbsp;addr-spec&nbsp;at&nbsp;the&nbsp;start&nbsp;of&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="6075441">func</span>&nbsp;<span class="op" id="6075446">(</span><span class="ident" id="6075447">p</span>&nbsp;<span class="op" id="6075449">*</span><span class="ident" id="6075450"><a href="/gostd/net/mail/message.go.html#6073614">addrParser</a></span><span class="op" id="6075460">)</span>&nbsp;<span class="ident" id="6075462">consumeAddrSpec</span><span class="op" id="6075477">(</span><span class="op" id="6075478">)</span>&nbsp;<span class="op" id="6075480">(</span><span class="ident" id="6075481">spec</span>&nbsp;<span class="builtintype" id="6075486">string</span><span class="op" id="6075492">,</span>&nbsp;<span class="ident" id="6075494">err</span>&nbsp;<span class="builtintype" id="6075498">error</span><span class="op" id="6075503">)</span>&nbsp;<span class="op" id="6075505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6075508"><a href="/gostd/net/mail/message.go.html#6069302">debug</a></span><span class="op" id="6075513">.</span><span class="ident" id="6075514"><a href="/gostd/net/mail/message.go.html#6069359">Printf</a></span><span class="op" id="6075520">(</span><span class="string" id="6075521">&#34;consumeAddrSpec:&nbsp;%q&#34;</span><span class="op" id="6075542">,</span>&nbsp;<span class="op" id="6075544">*</span><span class="ident" id="6075545"><a href="/gostd/net/mail/message.go.html#6075447">p</a></span><span class="op" id="6075546">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6075550">orig</span>&nbsp;<span class="op" id="6075555">:=</span>&nbsp;<span class="op" id="6075558">*</span><span class="ident" id="6075559"><a href="/gostd/net/mail/message.go.html#6075447">p</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6075562">defer</span>&nbsp;<span class="keyword" id="6075568">func</span><span class="op" id="6075572">(</span><span class="op" id="6075573">)</span>&nbsp;<span class="op" id="6075575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6075579">if</span>&nbsp;<span class="ident" id="6075582"><a href="/gostd/net/mail/message.go.html#6075494">err</a></span>&nbsp;<span class="op" id="6075586">!=</span>&nbsp;<span class="builtintype" id="6075589">nil</span>&nbsp;<span class="op" id="6075593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6075598">*</span><span class="ident" id="6075599"><a href="/gostd/net/mail/message.go.html#6075447">p</a></span>&nbsp;<span class="op" id="6075601">=</span>&nbsp;<span class="ident" id="6075603"><a href="/gostd/net/mail/message.go.html#6075550">orig</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6075610">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6075613">}</span><span class="op" id="6075614">(</span><span class="op" id="6075615">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6075619">//&nbsp;local-part&nbsp;=&nbsp;dot-atom&nbsp;/&nbsp;quoted-string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6075661">var</span>&nbsp;<span class="ident" id="6075665">localPart</span>&nbsp;<span class="builtintype" id="6075675">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6075683"><a href="/gostd/net/mail/message.go.html#6075447">p</a></span><span class="op" id="6075684">.</span><span class="ident" id="6075685"><a href="/gostd/net/mail/message.go.html#6079112">skipSpace</a></span><span class="op" id="6075694">(</span><span class="op" id="6075695">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6075698">if</span>&nbsp;<span class="ident" id="6075701"><a href="/gostd/net/mail/message.go.html#6075447">p</a></span><span class="op" id="6075702">.</span><span class="ident" id="6075703"><a href="/gostd/net/mail/message.go.html#6079236">empty</a></span><span class="op" id="6075708">(</span><span class="op" id="6075709">)</span>&nbsp;<span class="op" id="6075711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6075715">return</span>&nbsp;<span class="string" id="6075722">&#34;&#34;</span><span class="op" id="6075724">,</span>&nbsp;<span class="ident" id="6075726"><a href="/gostd/net/mail/message.go.html#6069195">errors</a></span><span class="op" id="6075732">.</span><span class="ident" id="6075733"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="6075736">(</span><span class="string" id="6075737">&#34;mail:&nbsp;no&nbsp;addr-spec&#34;</span><span class="op" id="6075757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6075760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6075763">if</span>&nbsp;<span class="ident" id="6075766"><a href="/gostd/net/mail/message.go.html#6075447">p</a></span><span class="op" id="6075767">.</span><span class="ident" id="6075768"><a href="/gostd/net/mail/message.go.html#6079182">peek</a></span><span class="op" id="6075772">(</span><span class="op" id="6075773">)</span>&nbsp;<span class="op" id="6075775">==</span>&nbsp;<span class="string" id="6075778">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="6075782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6075786">//&nbsp;quoted-string</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6075805"><a href="/gostd/net/mail/message.go.html#6069302">debug</a></span><span class="op" id="6075810">.</span><span class="ident" id="6075811"><a href="/gostd/net/mail/message.go.html#6069359">Printf</a></span><span class="op" id="6075817">(</span><span class="string" id="6075818">&#34;consumeAddrSpec:&nbsp;parsing&nbsp;quoted-string&#34;</span><span class="op" id="6075858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6075862"><a href="/gostd/net/mail/message.go.html#6075665">localPart</a></span><span class="op" id="6075871">,</span>&nbsp;<span class="ident" id="6075873"><a href="/gostd/net/mail/message.go.html#6075494">err</a></span>&nbsp;<span class="op" id="6075877">=</span>&nbsp;<span class="ident" id="6075879"><a href="/gostd/net/mail/message.go.html#6075447">p</a></span><span class="op" id="6075880">.</span><span class="ident" id="6075881"><a href="/gostd/net/mail/message.go.html#6077795">consumeQuotedString</a></span><span class="op" id="6075900">(</span><span class="op" id="6075901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6075904">}</span>&nbsp;<span class="keyword" id="6075906">else</span>&nbsp;<span class="op" id="6075911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6075915">//&nbsp;dot-atom</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6075929"><a href="/gostd/net/mail/message.go.html#6069302">debug</a></span><span class="op" id="6075934">.</span><span class="ident" id="6075935"><a href="/gostd/net/mail/message.go.html#6069359">Printf</a></span><span class="op" id="6075941">(</span><span class="string" id="6075942">&#34;consumeAddrSpec:&nbsp;parsing&nbsp;dot-atom&#34;</span><span class="op" id="6075977">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6075981"><a href="/gostd/net/mail/message.go.html#6075665">localPart</a></span><span class="op" id="6075990">,</span>&nbsp;<span class="ident" id="6075992"><a href="/gostd/net/mail/message.go.html#6075494">err</a></span>&nbsp;<span class="op" id="6075996">=</span>&nbsp;<span class="ident" id="6075998"><a href="/gostd/net/mail/message.go.html#6075447">p</a></span><span class="op" id="6075999">.</span><span class="ident" id="6076000"><a href="/gostd/net/mail/message.go.html#6078654">consumeAtom</a></span><span class="op" id="6076011">(</span><span class="builtintype" id="6076012">true</span><span class="op" id="6076016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6076019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6076022">if</span>&nbsp;<span class="ident" id="6076025"><a href="/gostd/net/mail/message.go.html#6075494">err</a></span>&nbsp;<span class="op" id="6076029">!=</span>&nbsp;<span class="builtintype" id="6076032">nil</span>&nbsp;<span class="op" id="6076036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6076040"><a href="/gostd/net/mail/message.go.html#6069302">debug</a></span><span class="op" id="6076045">.</span><span class="ident" id="6076046"><a href="/gostd/net/mail/message.go.html#6069359">Printf</a></span><span class="op" id="6076052">(</span><span class="string" id="6076053">&#34;consumeAddrSpec:&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6076082">,</span>&nbsp;<span class="ident" id="6076084"><a href="/gostd/net/mail/message.go.html#6075494">err</a></span><span class="op" id="6076087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6076091">return</span>&nbsp;<span class="string" id="6076098">&#34;&#34;</span><span class="op" id="6076100">,</span>&nbsp;<span class="ident" id="6076102"><a href="/gostd/net/mail/message.go.html#6075494">err</a></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6076107">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6076111">if</span>&nbsp;<span class="op" id="6076114">!</span><span class="ident" id="6076115"><a href="/gostd/net/mail/message.go.html#6075447">p</a></span><span class="op" id="6076116">.</span><span class="ident" id="6076117"><a href="/gostd/net/mail/message.go.html#6078929">consume</a></span><span class="op" id="6076124">(</span><span class="string" id="6076125">&#39;@&#39;</span><span class="op" id="6076128">)</span>&nbsp;<span class="op" id="6076130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6076134">return</span>&nbsp;<span class="string" id="6076141">&#34;&#34;</span><span class="op" id="6076143">,</span>&nbsp;<span class="ident" id="6076145"><a href="/gostd/net/mail/message.go.html#6069195">errors</a></span><span class="op" id="6076151">.</span><span class="ident" id="6076152"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="6076155">(</span><span class="string" id="6076156">&#34;mail:&nbsp;missing&nbsp;@&nbsp;in&nbsp;addr-spec&#34;</span><span class="op" id="6076186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6076189">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6076193">//&nbsp;domain&nbsp;=&nbsp;dot-atom&nbsp;/&nbsp;domain-literal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6076232">var</span>&nbsp;<span class="ident" id="6076236">domain</span>&nbsp;<span class="builtintype" id="6076243">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6076251"><a href="/gostd/net/mail/message.go.html#6075447">p</a></span><span class="op" id="6076252">.</span><span class="ident" id="6076253"><a href="/gostd/net/mail/message.go.html#6079112">skipSpace</a></span><span class="op" id="6076262">(</span><span class="op" id="6076263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6076266">if</span>&nbsp;<span class="ident" id="6076269"><a href="/gostd/net/mail/message.go.html#6075447">p</a></span><span class="op" id="6076270">.</span><span class="ident" id="6076271"><a href="/gostd/net/mail/message.go.html#6079236">empty</a></span><span class="op" id="6076276">(</span><span class="op" id="6076277">)</span>&nbsp;<span class="op" id="6076279">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6076283">return</span>&nbsp;<span class="string" id="6076290">&#34;&#34;</span><span class="op" id="6076292">,</span>&nbsp;<span class="ident" id="6076294"><a href="/gostd/net/mail/message.go.html#6069195">errors</a></span><span class="op" id="6076300">.</span><span class="ident" id="6076301"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="6076304">(</span><span class="string" id="6076305">&#34;mail:&nbsp;no&nbsp;domain&nbsp;in&nbsp;addr-spec&#34;</span><span class="op" id="6076335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6076338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6076341">//&nbsp;TODO(dsymonds):&nbsp;Handle&nbsp;domain-literal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6076383"><a href="/gostd/net/mail/message.go.html#6076236">domain</a></span><span class="op" id="6076389">,</span>&nbsp;<span class="ident" id="6076391"><a href="/gostd/net/mail/message.go.html#6075494">err</a></span>&nbsp;<span class="op" id="6076395">=</span>&nbsp;<span class="ident" id="6076397"><a href="/gostd/net/mail/message.go.html#6075447">p</a></span><span class="op" id="6076398">.</span><span class="ident" id="6076399"><a href="/gostd/net/mail/message.go.html#6078654">consumeAtom</a></span><span class="op" id="6076410">(</span><span class="builtintype" id="6076411">true</span><span class="op" id="6076415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6076418">if</span>&nbsp;<span class="ident" id="6076421"><a href="/gostd/net/mail/message.go.html#6075494">err</a></span>&nbsp;<span class="op" id="6076425">!=</span>&nbsp;<span class="builtintype" id="6076428">nil</span>&nbsp;<span class="op" id="6076432">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6076436">return</span>&nbsp;<span class="string" id="6076443">&#34;&#34;</span><span class="op" id="6076445">,</span>&nbsp;<span class="ident" id="6076447"><a href="/gostd/net/mail/message.go.html#6075494">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6076452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6076456">return</span>&nbsp;<span class="ident" id="6076463"><a href="/gostd/net/mail/message.go.html#6075665">localPart</a></span>&nbsp;<span class="op" id="6076473">+</span>&nbsp;<span class="string" id="6076475">&#34;@&#34;</span>&nbsp;<span class="op" id="6076479">+</span>&nbsp;<span class="ident" id="6076481"><a href="/gostd/net/mail/message.go.html#6076236">domain</a></span><span class="op" id="6076487">,</span>&nbsp;<span class="builtintype" id="6076489">nil</span><br>
<span class="lineno"></span><span class="op" id="6076493">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="comment" id="6076496">//&nbsp;consumePhrase&nbsp;parses&nbsp;the&nbsp;RFC&nbsp;5322&nbsp;phrase&nbsp;at&nbsp;the&nbsp;start&nbsp;of&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="6076559">func</span>&nbsp;<span class="op" id="6076564">(</span><span class="ident" id="6076565">p</span>&nbsp;<span class="op" id="6076567">*</span><span class="ident" id="6076568"><a href="/gostd/net/mail/message.go.html#6073614">addrParser</a></span><span class="op" id="6076578">)</span>&nbsp;<span class="ident" id="6076580">consumePhrase</span><span class="op" id="6076593">(</span><span class="op" id="6076594">)</span>&nbsp;<span class="op" id="6076596">(</span><span class="ident" id="6076597">phrase</span>&nbsp;<span class="builtintype" id="6076604">string</span><span class="op" id="6076610">,</span>&nbsp;<span class="ident" id="6076612">err</span>&nbsp;<span class="builtintype" id="6076616">error</span><span class="op" id="6076621">)</span>&nbsp;<span class="op" id="6076623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6076626"><a href="/gostd/net/mail/message.go.html#6069302">debug</a></span><span class="op" id="6076631">.</span><span class="ident" id="6076632"><a href="/gostd/net/mail/message.go.html#6069359">Printf</a></span><span class="op" id="6076638">(</span><span class="string" id="6076639">&#34;consumePhrase:&nbsp;[%s]&#34;</span><span class="op" id="6076660">,</span>&nbsp;<span class="op" id="6076662">*</span><span class="ident" id="6076663"><a href="/gostd/net/mail/message.go.html#6076565">p</a></span><span class="op" id="6076664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6076667">//&nbsp;phrase&nbsp;=&nbsp;1*word</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6076687">var</span>&nbsp;<span class="ident" id="6076691">words</span>&nbsp;<span class="op" id="6076697">[</span><span class="op" id="6076698">]</span><span class="builtintype" id="6076699">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6076707">for</span>&nbsp;<span class="op" id="6076711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6076715">//&nbsp;word&nbsp;=&nbsp;atom&nbsp;/&nbsp;quoted-string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6076748">var</span>&nbsp;<span class="ident" id="6076752">word</span>&nbsp;<span class="builtintype" id="6076757">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6076766"><a href="/gostd/net/mail/message.go.html#6076565">p</a></span><span class="op" id="6076767">.</span><span class="ident" id="6076768"><a href="/gostd/net/mail/message.go.html#6079112">skipSpace</a></span><span class="op" id="6076777">(</span><span class="op" id="6076778">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6076782">if</span>&nbsp;<span class="ident" id="6076785"><a href="/gostd/net/mail/message.go.html#6076565">p</a></span><span class="op" id="6076786">.</span><span class="ident" id="6076787"><a href="/gostd/net/mail/message.go.html#6079236">empty</a></span><span class="op" id="6076792">(</span><span class="op" id="6076793">)</span>&nbsp;<span class="op" id="6076795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6076800">return</span>&nbsp;<span class="string" id="6076807">&#34;&#34;</span><span class="op" id="6076809">,</span>&nbsp;<span class="ident" id="6076811"><a href="/gostd/net/mail/message.go.html#6069195">errors</a></span><span class="op" id="6076817">.</span><span class="ident" id="6076818"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="6076821">(</span><span class="string" id="6076822">&#34;mail:&nbsp;missing&nbsp;phrase&#34;</span><span class="op" id="6076844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6076848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6076852">if</span>&nbsp;<span class="ident" id="6076855"><a href="/gostd/net/mail/message.go.html#6076565">p</a></span><span class="op" id="6076856">.</span><span class="ident" id="6076857"><a href="/gostd/net/mail/message.go.html#6079182">peek</a></span><span class="op" id="6076861">(</span><span class="op" id="6076862">)</span>&nbsp;<span class="op" id="6076864">==</span>&nbsp;<span class="string" id="6076867">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="6076871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6076876">//&nbsp;quoted-string</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6076896"><a href="/gostd/net/mail/message.go.html#6076752">word</a></span><span class="op" id="6076900">,</span>&nbsp;<span class="ident" id="6076902"><a href="/gostd/net/mail/message.go.html#6076612">err</a></span>&nbsp;<span class="op" id="6076906">=</span>&nbsp;<span class="ident" id="6076908"><a href="/gostd/net/mail/message.go.html#6076565">p</a></span><span class="op" id="6076909">.</span><span class="ident" id="6076910"><a href="/gostd/net/mail/message.go.html#6077795">consumeQuotedString</a></span><span class="op" id="6076929">(</span><span class="op" id="6076930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6076934">}</span>&nbsp;<span class="keyword" id="6076936">else</span>&nbsp;<span class="op" id="6076941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6076946">//&nbsp;atom</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6076957">//&nbsp;We&nbsp;actually&nbsp;parse&nbsp;dot-atom&nbsp;here&nbsp;to&nbsp;be&nbsp;more&nbsp;permissive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6077017">//&nbsp;than&nbsp;what&nbsp;RFC&nbsp;5322&nbsp;specifies.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6077053"><a href="/gostd/net/mail/message.go.html#6076752">word</a></span><span class="op" id="6077057">,</span>&nbsp;<span class="ident" id="6077059"><a href="/gostd/net/mail/message.go.html#6076612">err</a></span>&nbsp;<span class="op" id="6077063">=</span>&nbsp;<span class="ident" id="6077065"><a href="/gostd/net/mail/message.go.html#6076565">p</a></span><span class="op" id="6077066">.</span><span class="ident" id="6077067"><a href="/gostd/net/mail/message.go.html#6078654">consumeAtom</a></span><span class="op" id="6077078">(</span><span class="builtintype" id="6077079">true</span><span class="op" id="6077083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6077087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6077092">//&nbsp;RFC&nbsp;2047&nbsp;encoded-word&nbsp;starts&nbsp;with&nbsp;=?,&nbsp;ends&nbsp;with&nbsp;?=,&nbsp;and&nbsp;has&nbsp;two&nbsp;other&nbsp;?s.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6077171">if</span>&nbsp;<span class="ident" id="6077174"><a href="/gostd/net/mail/message.go.html#6076612">err</a></span>&nbsp;<span class="op" id="6077178">==</span>&nbsp;<span class="builtintype" id="6077181">nil</span>&nbsp;<span class="op" id="6077185">&amp;&amp;</span>&nbsp;<span class="ident" id="6077188"><a href="/gostd/net/mail/message.go.html#6069266">strings</a></span><span class="op" id="6077195">.</span><span class="ident" id="6077196"><a href="/gostd/strings/strings.go.html#2975366">HasPrefix</a></span><span class="op" id="6077205">(</span><span class="ident" id="6077206"><a href="/gostd/net/mail/message.go.html#6076752">word</a></span><span class="op" id="6077210">,</span>&nbsp;<span class="string" id="6077212">&#34;=?&#34;</span><span class="op" id="6077216">)</span>&nbsp;<span class="op" id="6077218">&amp;&amp;</span>&nbsp;<span class="ident" id="6077221"><a href="/gostd/net/mail/message.go.html#6069266">strings</a></span><span class="op" id="6077228">.</span><span class="ident" id="6077229"><a href="/gostd/strings/strings.go.html#2975527">HasSuffix</a></span><span class="op" id="6077238">(</span><span class="ident" id="6077239"><a href="/gostd/net/mail/message.go.html#6076752">word</a></span><span class="op" id="6077243">,</span>&nbsp;<span class="string" id="6077245">&#34;?=&#34;</span><span class="op" id="6077249">)</span>&nbsp;<span class="op" id="6077251">&amp;&amp;</span>&nbsp;<span class="ident" id="6077254"><a href="/gostd/net/mail/message.go.html#6069266">strings</a></span><span class="op" id="6077261">.</span><span class="ident" id="6077262"><a href="/gostd/strings/strings.go.html#2967531">Count</a></span><span class="op" id="6077267">(</span><span class="ident" id="6077268"><a href="/gostd/net/mail/message.go.html#6076752">word</a></span><span class="op" id="6077272">,</span>&nbsp;<span class="string" id="6077274">&#34;?&#34;</span><span class="op" id="6077277">)</span>&nbsp;<span class="op" id="6077279">==</span>&nbsp;<span class="num" id="6077282">4</span>&nbsp;<span class="op" id="6077284">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6077289"><a href="/gostd/net/mail/message.go.html#6076752">word</a></span><span class="op" id="6077293">,</span>&nbsp;<span class="ident" id="6077295"><a href="/gostd/net/mail/message.go.html#6076612">err</a></span>&nbsp;<span class="op" id="6077299">=</span>&nbsp;<span class="ident" id="6077301"><a href="/gostd/net/mail/message.go.html#6079332">decodeRFC2047Word</a></span><span class="op" id="6077318">(</span><span class="ident" id="6077319"><a href="/gostd/net/mail/message.go.html#6076752">word</a></span><span class="op" id="6077323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6077327">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6077332">if</span>&nbsp;<span class="ident" id="6077335"><a href="/gostd/net/mail/message.go.html#6076612">err</a></span>&nbsp;<span class="op" id="6077339">!=</span>&nbsp;<span class="builtintype" id="6077342">nil</span>&nbsp;<span class="op" id="6077346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6077351">break</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6077359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6077363"><a href="/gostd/net/mail/message.go.html#6069302">debug</a></span><span class="op" id="6077368">.</span><span class="ident" id="6077369"><a href="/gostd/net/mail/message.go.html#6069359">Printf</a></span><span class="op" id="6077375">(</span><span class="string" id="6077376">&#34;consumePhrase:&nbsp;consumed&nbsp;%q&#34;</span><span class="op" id="6077404">,</span>&nbsp;<span class="ident" id="6077406"><a href="/gostd/net/mail/message.go.html#6076752">word</a></span><span class="op" id="6077410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6077414"><a href="/gostd/net/mail/message.go.html#6076691">words</a></span>&nbsp;<span class="op" id="6077420">=</span>&nbsp;<span class="builtinfunc" id="6077422">append</span><span class="op" id="6077428">(</span><span class="ident" id="6077429"><a href="/gostd/net/mail/message.go.html#6076691">words</a></span><span class="op" id="6077434">,</span>&nbsp;<span class="ident" id="6077436"><a href="/gostd/net/mail/message.go.html#6076752">word</a></span><span class="op" id="6077440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6077443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6077446">//&nbsp;Ignore&nbsp;any&nbsp;error&nbsp;if&nbsp;we&nbsp;got&nbsp;at&nbsp;least&nbsp;one&nbsp;word.</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6077496">if</span>&nbsp;<span class="ident" id="6077499"><a href="/gostd/net/mail/message.go.html#6076612">err</a></span>&nbsp;<span class="op" id="6077503">!=</span>&nbsp;<span class="builtintype" id="6077506">nil</span>&nbsp;<span class="op" id="6077510">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="6077513">len</span><span class="op" id="6077516">(</span><span class="ident" id="6077517"><a href="/gostd/net/mail/message.go.html#6076691">words</a></span><span class="op" id="6077522">)</span>&nbsp;<span class="op" id="6077524">==</span>&nbsp;<span class="num" id="6077527">0</span>&nbsp;<span class="op" id="6077529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6077533"><a href="/gostd/net/mail/message.go.html#6069302">debug</a></span><span class="op" id="6077538">.</span><span class="ident" id="6077539"><a href="/gostd/net/mail/message.go.html#6069359">Printf</a></span><span class="op" id="6077545">(</span><span class="string" id="6077546">&#34;consumePhrase:&nbsp;hit&nbsp;err:&nbsp;%v&#34;</span><span class="op" id="6077574">,</span>&nbsp;<span class="ident" id="6077576"><a href="/gostd/net/mail/message.go.html#6076612">err</a></span><span class="op" id="6077579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6077583">return</span>&nbsp;<span class="string" id="6077590">&#34;&#34;</span><span class="op" id="6077592">,</span>&nbsp;<span class="ident" id="6077594"><a href="/gostd/net/mail/message.go.html#6069205">fmt</a></span><span class="op" id="6077597">.</span><span class="ident" id="6077598"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="6077604">(</span><span class="string" id="6077605">&#34;mail:&nbsp;missing&nbsp;word&nbsp;in&nbsp;phrase:&nbsp;%v&#34;</span><span class="op" id="6077639">,</span>&nbsp;<span class="ident" id="6077641"><a href="/gostd/net/mail/message.go.html#6076612">err</a></span><span class="op" id="6077644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6077647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6077650"><a href="/gostd/net/mail/message.go.html#6076597">phrase</a></span>&nbsp;<span class="op" id="6077657">=</span>&nbsp;<span class="ident" id="6077659"><a href="/gostd/net/mail/message.go.html#6069266">strings</a></span><span class="op" id="6077666">.</span><span class="ident" id="6077667"><a href="/gostd/strings/strings.go.html#2974969">Join</a></span><span class="op" id="6077671">(</span><span class="ident" id="6077672"><a href="/gostd/net/mail/message.go.html#6076691">words</a></span><span class="op" id="6077677">,</span>&nbsp;<span class="string" id="6077679">&#34;&nbsp;&#34;</span><span class="op" id="6077682">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6077685">return</span>&nbsp;<span class="ident" id="6077692"><a href="/gostd/net/mail/message.go.html#6076597">phrase</a></span><span class="op" id="6077698">,</span>&nbsp;<span class="builtintype" id="6077700">nil</span><br>
<span class="lineno"></span><span class="op" id="6077704">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6077707">//&nbsp;consumeQuotedString&nbsp;parses&nbsp;the&nbsp;quoted&nbsp;string&nbsp;at&nbsp;the&nbsp;start&nbsp;of&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="6077774">func</span>&nbsp;<span class="op" id="6077779">(</span><span class="ident" id="6077780">p</span>&nbsp;<span class="op" id="6077782">*</span><span class="ident" id="6077783"><a href="/gostd/net/mail/message.go.html#6073614">addrParser</a></span><span class="op" id="6077793">)</span>&nbsp;<span class="ident" id="6077795">consumeQuotedString</span><span class="op" id="6077814">(</span><span class="op" id="6077815">)</span>&nbsp;<span class="op" id="6077817">(</span><span class="ident" id="6077818">qs</span>&nbsp;<span class="builtintype" id="6077821">string</span><span class="op" id="6077827">,</span>&nbsp;<span class="ident" id="6077829">err</span>&nbsp;<span class="builtintype" id="6077833">error</span><span class="op" id="6077838">)</span>&nbsp;<span class="op" id="6077840">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6077843">//&nbsp;Assume&nbsp;first&nbsp;byte&nbsp;is&nbsp;&#39;&#34;&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6077873">i</span>&nbsp;<span class="op" id="6077875">:=</span>&nbsp;<span class="num" id="6077878">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6077881">qsb</span>&nbsp;<span class="op" id="6077885">:=</span>&nbsp;<span class="builtinfunc" id="6077888">make</span><span class="op" id="6077892">(</span><span class="op" id="6077893">[</span><span class="op" id="6077894">]</span><span class="builtintype" id="6077895">byte</span><span class="op" id="6077899">,</span>&nbsp;<span class="num" id="6077901">0</span><span class="op" id="6077902">,</span>&nbsp;<span class="num" id="6077904">10</span><span class="op" id="6077906">)</span><br>
<span class="lineno"></span><span class="ident" id="6077908">Loop</span><span class="op" id="6077912">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6077915">for</span>&nbsp;<span class="op" id="6077919">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6077923">if</span>&nbsp;<span class="ident" id="6077926"><a href="/gostd/net/mail/message.go.html#6077873">i</a></span>&nbsp;<span class="op" id="6077928">&gt;=</span>&nbsp;<span class="ident" id="6077931"><a href="/gostd/net/mail/message.go.html#6077780">p</a></span><span class="op" id="6077932">.</span><span class="builtinfunc" id="6077933"><a href="/gostd/net/mail/message.go.html#6079296">len</a></span><span class="op" id="6077936">(</span><span class="op" id="6077937">)</span>&nbsp;<span class="op" id="6077939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6077944">return</span>&nbsp;<span class="string" id="6077951">&#34;&#34;</span><span class="op" id="6077953">,</span>&nbsp;<span class="ident" id="6077955"><a href="/gostd/net/mail/message.go.html#6069195">errors</a></span><span class="op" id="6077961">.</span><span class="ident" id="6077962"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="6077965">(</span><span class="string" id="6077966">&#34;mail:&nbsp;unclosed&nbsp;quoted-string&#34;</span><span class="op" id="6077996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6078000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6078004">switch</span>&nbsp;<span class="ident" id="6078011">c</span>&nbsp;<span class="op" id="6078013">:=</span>&nbsp;<span class="op" id="6078016">(</span><span class="op" id="6078017">*</span><span class="ident" id="6078018"><a href="/gostd/net/mail/message.go.html#6077780">p</a></span><span class="op" id="6078019">)</span><span class="op" id="6078020">[</span><span class="ident" id="6078021"><a href="/gostd/net/mail/message.go.html#6077873">i</a></span><span class="op" id="6078022">]</span><span class="op" id="6078023">;</span>&nbsp;<span class="op" id="6078025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6078029">case</span>&nbsp;<span class="ident" id="6078034"><a href="/gostd/net/mail/message.go.html#6078011">c</a></span>&nbsp;<span class="op" id="6078036">==</span>&nbsp;<span class="string" id="6078039">&#39;&#34;&#39;</span><span class="op" id="6078042">:</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6078047">break</span>&nbsp;<span class="ident" id="6078053"><a href="/gostd/net/mail/message.go.html#6077908">Loop</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6078060">case</span>&nbsp;<span class="ident" id="6078065"><a href="/gostd/net/mail/message.go.html#6078011">c</a></span>&nbsp;<span class="op" id="6078067">==</span>&nbsp;<span class="string" id="6078070">&#39;\\&#39;</span><span class="op" id="6078074">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6078079">if</span>&nbsp;<span class="ident" id="6078082"><a href="/gostd/net/mail/message.go.html#6077873">i</a></span><span class="op" id="6078083">+</span><span class="num" id="6078084">1</span>&nbsp;<span class="op" id="6078086">==</span>&nbsp;<span class="ident" id="6078089"><a href="/gostd/net/mail/message.go.html#6077780">p</a></span><span class="op" id="6078090">.</span><span class="builtinfunc" id="6078091"><a href="/gostd/net/mail/message.go.html#6079296">len</a></span><span class="op" id="6078094">(</span><span class="op" id="6078095">)</span>&nbsp;<span class="op" id="6078097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6078103">return</span>&nbsp;<span class="string" id="6078110">&#34;&#34;</span><span class="op" id="6078112">,</span>&nbsp;<span class="ident" id="6078114"><a href="/gostd/net/mail/message.go.html#6069195">errors</a></span><span class="op" id="6078120">.</span><span class="ident" id="6078121"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="6078124">(</span><span class="string" id="6078125">&#34;mail:&nbsp;unclosed&nbsp;quoted-string&#34;</span><span class="op" id="6078155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6078160">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6078165"><a href="/gostd/net/mail/message.go.html#6077881">qsb</a></span>&nbsp;<span class="op" id="6078169">=</span>&nbsp;<span class="builtinfunc" id="6078171">append</span><span class="op" id="6078177">(</span><span class="ident" id="6078178"><a href="/gostd/net/mail/message.go.html#6077881">qsb</a></span><span class="op" id="6078181">,</span>&nbsp;<span class="op" id="6078183">(</span><span class="op" id="6078184">*</span><span class="ident" id="6078185"><a href="/gostd/net/mail/message.go.html#6077780">p</a></span><span class="op" id="6078186">)</span><span class="op" id="6078187">[</span><span class="ident" id="6078188"><a href="/gostd/net/mail/message.go.html#6077873">i</a></span><span class="op" id="6078189">+</span><span class="num" id="6078190">1</span><span class="op" id="6078191">]</span><span class="op" id="6078192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6078197"><a href="/gostd/net/mail/message.go.html#6077873">i</a></span>&nbsp;<span class="op" id="6078199">+=</span>&nbsp;<span class="num" id="6078202">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6078206">case</span>&nbsp;<span class="ident" id="6078211"><a href="/gostd/net/mail/message.go.html#6081545">isQtext</a></span><span class="op" id="6078218">(</span><span class="ident" id="6078219"><a href="/gostd/net/mail/message.go.html#6078011">c</a></span><span class="op" id="6078220">)</span><span class="op" id="6078221">,</span>&nbsp;<span class="ident" id="6078223"><a href="/gostd/net/mail/message.go.html#6078011">c</a></span>&nbsp;<span class="op" id="6078225">==</span>&nbsp;<span class="string" id="6078228">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="6078232">||</span>&nbsp;<span class="ident" id="6078235"><a href="/gostd/net/mail/message.go.html#6078011">c</a></span>&nbsp;<span class="op" id="6078237">==</span>&nbsp;<span class="string" id="6078240">&#39;\t&#39;</span><span class="op" id="6078244">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6078249">//&nbsp;qtext&nbsp;(printable&nbsp;US-ASCII&nbsp;excluding&nbsp;&#34;&nbsp;and&nbsp;\),&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6078304">//&nbsp;FWS&nbsp;(almost;&nbsp;we&#39;re&nbsp;ignoring&nbsp;CRLF)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6078344"><a href="/gostd/net/mail/message.go.html#6077881">qsb</a></span>&nbsp;<span class="op" id="6078348">=</span>&nbsp;<span class="builtinfunc" id="6078350">append</span><span class="op" id="6078356">(</span><span class="ident" id="6078357"><a href="/gostd/net/mail/message.go.html#6077881">qsb</a></span><span class="op" id="6078360">,</span>&nbsp;<span class="ident" id="6078362"><a href="/gostd/net/mail/message.go.html#6078011">c</a></span><span class="op" id="6078363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6078368"><a href="/gostd/net/mail/message.go.html#6077873">i</a></span><span class="op" id="6078369">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6078374">default</span><span class="op" id="6078381">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6078386">return</span>&nbsp;<span class="string" id="6078393">&#34;&#34;</span><span class="op" id="6078395">,</span>&nbsp;<span class="ident" id="6078397"><a href="/gostd/net/mail/message.go.html#6069205">fmt</a></span><span class="op" id="6078400">.</span><span class="ident" id="6078401"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="6078407">(</span><span class="string" id="6078408">&#34;mail:&nbsp;bad&nbsp;character&nbsp;in&nbsp;quoted-string:&nbsp;%q&#34;</span><span class="op" id="6078450">,</span>&nbsp;<span class="ident" id="6078452"><a href="/gostd/net/mail/message.go.html#6078011">c</a></span><span class="op" id="6078453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6078457">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6078460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6078463">*</span><span class="ident" id="6078464"><a href="/gostd/net/mail/message.go.html#6077780">p</a></span>&nbsp;<span class="op" id="6078466">=</span>&nbsp;<span class="op" id="6078468">(</span><span class="op" id="6078469">*</span><span class="ident" id="6078470"><a href="/gostd/net/mail/message.go.html#6077780">p</a></span><span class="op" id="6078471">)</span><span class="op" id="6078472">[</span><span class="ident" id="6078473"><a href="/gostd/net/mail/message.go.html#6077873">i</a></span><span class="op" id="6078474">+</span><span class="num" id="6078475">1</span><span class="op" id="6078476">:</span><span class="op" id="6078477">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6078480">return</span>&nbsp;<span class="builtintype" id="6078487">string</span><span class="op" id="6078493">(</span><span class="ident" id="6078494"><a href="/gostd/net/mail/message.go.html#6077881">qsb</a></span><span class="op" id="6078497">)</span><span class="op" id="6078498">,</span>&nbsp;<span class="builtintype" id="6078500">nil</span><br>
<span class="lineno"></span><span class="op" id="6078504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="comment" id="6078507">//&nbsp;consumeAtom&nbsp;parses&nbsp;an&nbsp;RFC&nbsp;5322&nbsp;atom&nbsp;at&nbsp;the&nbsp;start&nbsp;of&nbsp;p.</span><br>
<span class="lineno"></span><span class="comment" id="6078565">//&nbsp;If&nbsp;dot&nbsp;is&nbsp;true,&nbsp;consumeAtom&nbsp;parses&nbsp;an&nbsp;RFC&nbsp;5322&nbsp;dot-atom&nbsp;instead.</span><br>
<span class="lineno"></span><span class="keyword" id="6078633">func</span>&nbsp;<span class="op" id="6078638">(</span><span class="ident" id="6078639">p</span>&nbsp;<span class="op" id="6078641">*</span><span class="ident" id="6078642"><a href="/gostd/net/mail/message.go.html#6073614">addrParser</a></span><span class="op" id="6078652">)</span>&nbsp;<span class="ident" id="6078654">consumeAtom</span><span class="op" id="6078665">(</span><span class="ident" id="6078666">dot</span>&nbsp;<span class="builtintype" id="6078670">bool</span><span class="op" id="6078674">)</span>&nbsp;<span class="op" id="6078676">(</span><span class="ident" id="6078677">atom</span>&nbsp;<span class="builtintype" id="6078682">string</span><span class="op" id="6078688">,</span>&nbsp;<span class="ident" id="6078690">err</span>&nbsp;<span class="builtintype" id="6078694">error</span><span class="op" id="6078699">)</span>&nbsp;<span class="op" id="6078701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6078704">if</span>&nbsp;<span class="op" id="6078707">!</span><span class="ident" id="6078708"><a href="/gostd/net/mail/message.go.html#6081360">isAtext</a></span><span class="op" id="6078715">(</span><span class="ident" id="6078716"><a href="/gostd/net/mail/message.go.html#6078639">p</a></span><span class="op" id="6078717">.</span><span class="ident" id="6078718"><a href="/gostd/net/mail/message.go.html#6079182">peek</a></span><span class="op" id="6078722">(</span><span class="op" id="6078723">)</span><span class="op" id="6078724">,</span>&nbsp;<span class="builtintype" id="6078726">false</span><span class="op" id="6078731">)</span>&nbsp;<span class="op" id="6078733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6078737">return</span>&nbsp;<span class="string" id="6078744">&#34;&#34;</span><span class="op" id="6078746">,</span>&nbsp;<span class="ident" id="6078748"><a href="/gostd/net/mail/message.go.html#6069195">errors</a></span><span class="op" id="6078754">.</span><span class="ident" id="6078755"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="6078758">(</span><span class="string" id="6078759">&#34;mail:&nbsp;invalid&nbsp;string&#34;</span><span class="op" id="6078781">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6078784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6078787">i</span>&nbsp;<span class="op" id="6078789">:=</span>&nbsp;<span class="num" id="6078792">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6078795">for</span>&nbsp;<span class="op" id="6078799">;</span>&nbsp;<span class="ident" id="6078801"><a href="/gostd/net/mail/message.go.html#6078787">i</a></span>&nbsp;<span class="op" id="6078803">&lt;</span>&nbsp;<span class="ident" id="6078805"><a href="/gostd/net/mail/message.go.html#6078639">p</a></span><span class="op" id="6078806">.</span><span class="builtinfunc" id="6078807"><a href="/gostd/net/mail/message.go.html#6079296">len</a></span><span class="op" id="6078810">(</span><span class="op" id="6078811">)</span>&nbsp;<span class="op" id="6078813">&amp;&amp;</span>&nbsp;<span class="ident" id="6078816"><a href="/gostd/net/mail/message.go.html#6081360">isAtext</a></span><span class="op" id="6078823">(</span><span class="op" id="6078824">(</span><span class="op" id="6078825">*</span><span class="ident" id="6078826"><a href="/gostd/net/mail/message.go.html#6078639">p</a></span><span class="op" id="6078827">)</span><span class="op" id="6078828">[</span><span class="ident" id="6078829"><a href="/gostd/net/mail/message.go.html#6078787">i</a></span><span class="op" id="6078830">]</span><span class="op" id="6078831">,</span>&nbsp;<span class="ident" id="6078833"><a href="/gostd/net/mail/message.go.html#6078666">dot</a></span><span class="op" id="6078836">)</span><span class="op" id="6078837">;</span>&nbsp;<span class="ident" id="6078839"><a href="/gostd/net/mail/message.go.html#6078787">i</a></span><span class="op" id="6078840">++</span>&nbsp;<span class="op" id="6078843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6078846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6078849"><a href="/gostd/net/mail/message.go.html#6078677">atom</a></span><span class="op" id="6078853">,</span>&nbsp;<span class="op" id="6078855">*</span><span class="ident" id="6078856"><a href="/gostd/net/mail/message.go.html#6078639">p</a></span>&nbsp;<span class="op" id="6078858">=</span>&nbsp;<span class="builtintype" id="6078860">string</span><span class="op" id="6078866">(</span><span class="op" id="6078867">(</span><span class="op" id="6078868">*</span><span class="ident" id="6078869"><a href="/gostd/net/mail/message.go.html#6078639">p</a></span><span class="op" id="6078870">)</span><span class="op" id="6078871">[</span><span class="op" id="6078872">:</span><span class="ident" id="6078873"><a href="/gostd/net/mail/message.go.html#6078787">i</a></span><span class="op" id="6078874">]</span><span class="op" id="6078875">)</span><span class="op" id="6078876">,</span>&nbsp;<span class="op" id="6078878">(</span><span class="op" id="6078879">*</span><span class="ident" id="6078880"><a href="/gostd/net/mail/message.go.html#6078639">p</a></span><span class="op" id="6078881">)</span><span class="op" id="6078882">[</span><span class="ident" id="6078883"><a href="/gostd/net/mail/message.go.html#6078787">i</a></span><span class="op" id="6078884">:</span><span class="op" id="6078885">]</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6078888">return</span>&nbsp;<span class="ident" id="6078895"><a href="/gostd/net/mail/message.go.html#6078677">atom</a></span><span class="op" id="6078899">,</span>&nbsp;<span class="builtintype" id="6078901">nil</span><br>
<span class="lineno"></span><span class="op" id="6078905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6078908">func</span>&nbsp;<span class="op" id="6078913">(</span><span class="ident" id="6078914">p</span>&nbsp;<span class="op" id="6078916">*</span><span class="ident" id="6078917"><a href="/gostd/net/mail/message.go.html#6073614">addrParser</a></span><span class="op" id="6078927">)</span>&nbsp;<span class="ident" id="6078929">consume</span><span class="op" id="6078936">(</span><span class="ident" id="6078937">c</span>&nbsp;<span class="builtintype" id="6078939">byte</span><span class="op" id="6078943">)</span>&nbsp;<span class="builtintype" id="6078945">bool</span>&nbsp;<span class="op" id="6078950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6078953">if</span>&nbsp;<span class="ident" id="6078956"><a href="/gostd/net/mail/message.go.html#6078914">p</a></span><span class="op" id="6078957">.</span><span class="ident" id="6078958"><a href="/gostd/net/mail/message.go.html#6079236">empty</a></span><span class="op" id="6078963">(</span><span class="op" id="6078964">)</span>&nbsp;<span class="op" id="6078966">||</span>&nbsp;<span class="ident" id="6078969"><a href="/gostd/net/mail/message.go.html#6078914">p</a></span><span class="op" id="6078970">.</span><span class="ident" id="6078971"><a href="/gostd/net/mail/message.go.html#6079182">peek</a></span><span class="op" id="6078975">(</span><span class="op" id="6078976">)</span>&nbsp;<span class="op" id="6078978">!=</span>&nbsp;<span class="ident" id="6078981"><a href="/gostd/net/mail/message.go.html#6078937">c</a></span>&nbsp;<span class="op" id="6078983">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6078987">return</span>&nbsp;<span class="builtintype" id="6078994">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6079001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6079004">*</span><span class="ident" id="6079005"><a href="/gostd/net/mail/message.go.html#6078914">p</a></span>&nbsp;<span class="op" id="6079007">=</span>&nbsp;<span class="op" id="6079009">(</span><span class="op" id="6079010">*</span><span class="ident" id="6079011"><a href="/gostd/net/mail/message.go.html#6078914">p</a></span><span class="op" id="6079012">)</span><span class="op" id="6079013">[</span><span class="num" id="6079014">1</span><span class="op" id="6079015">:</span><span class="op" id="6079016">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6079019">return</span>&nbsp;<span class="builtintype" id="6079026">true</span><br>
<span class="lineno"></span><span class="op" id="6079031">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span><span class="comment" id="6079034">//&nbsp;skipSpace&nbsp;skips&nbsp;the&nbsp;leading&nbsp;space&nbsp;and&nbsp;tab&nbsp;characters.</span><br>
<span class="lineno"></span><span class="keyword" id="6079091">func</span>&nbsp;<span class="op" id="6079096">(</span><span class="ident" id="6079097">p</span>&nbsp;<span class="op" id="6079099">*</span><span class="ident" id="6079100"><a href="/gostd/net/mail/message.go.html#6073614">addrParser</a></span><span class="op" id="6079110">)</span>&nbsp;<span class="ident" id="6079112">skipSpace</span><span class="op" id="6079121">(</span><span class="op" id="6079122">)</span>&nbsp;<span class="op" id="6079124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6079127">*</span><span class="ident" id="6079128"><a href="/gostd/net/mail/message.go.html#6079097">p</a></span>&nbsp;<span class="op" id="6079130">=</span>&nbsp;<span class="ident" id="6079132"><a href="/gostd/net/mail/message.go.html#6069167">bytes</a></span><span class="op" id="6079137">.</span><span class="ident" id="6079138"><a href="/gostd/bytes/bytes.go.html#1411359">TrimLeft</a></span><span class="op" id="6079146">(</span><span class="op" id="6079147">*</span><span class="ident" id="6079148"><a href="/gostd/net/mail/message.go.html#6079097">p</a></span><span class="op" id="6079149">,</span>&nbsp;<span class="string" id="6079151">&#34;&nbsp;\t&#34;</span><span class="op" id="6079156">)</span><br>
<span class="lineno"></span><span class="op" id="6079158">}</span><br>
<span class="lineno">430</span><br>
<span class="lineno"></span><span class="keyword" id="6079161">func</span>&nbsp;<span class="op" id="6079166">(</span><span class="ident" id="6079167">p</span>&nbsp;<span class="op" id="6079169">*</span><span class="ident" id="6079170"><a href="/gostd/net/mail/message.go.html#6073614">addrParser</a></span><span class="op" id="6079180">)</span>&nbsp;<span class="ident" id="6079182">peek</span><span class="op" id="6079186">(</span><span class="op" id="6079187">)</span>&nbsp;<span class="builtintype" id="6079189">byte</span>&nbsp;<span class="op" id="6079194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6079197">return</span>&nbsp;<span class="op" id="6079204">(</span><span class="op" id="6079205">*</span><span class="ident" id="6079206"><a href="/gostd/net/mail/message.go.html#6079167">p</a></span><span class="op" id="6079207">)</span><span class="op" id="6079208">[</span><span class="num" id="6079209">0</span><span class="op" id="6079210">]</span><br>
<span class="lineno"></span><span class="op" id="6079212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span><span class="keyword" id="6079215">func</span>&nbsp;<span class="op" id="6079220">(</span><span class="ident" id="6079221">p</span>&nbsp;<span class="op" id="6079223">*</span><span class="ident" id="6079224"><a href="/gostd/net/mail/message.go.html#6073614">addrParser</a></span><span class="op" id="6079234">)</span>&nbsp;<span class="ident" id="6079236">empty</span><span class="op" id="6079241">(</span><span class="op" id="6079242">)</span>&nbsp;<span class="builtintype" id="6079244">bool</span>&nbsp;<span class="op" id="6079249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6079252">return</span>&nbsp;<span class="ident" id="6079259"><a href="/gostd/net/mail/message.go.html#6079221">p</a></span><span class="op" id="6079260">.</span><span class="builtinfunc" id="6079261"><a href="/gostd/net/mail/message.go.html#6079296">len</a></span><span class="op" id="6079264">(</span><span class="op" id="6079265">)</span>&nbsp;<span class="op" id="6079267">==</span>&nbsp;<span class="num" id="6079270">0</span><br>
<span class="lineno"></span><span class="op" id="6079272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6079275">func</span>&nbsp;<span class="op" id="6079280">(</span><span class="ident" id="6079281">p</span>&nbsp;<span class="op" id="6079283">*</span><span class="ident" id="6079284"><a href="/gostd/net/mail/message.go.html#6073614">addrParser</a></span><span class="op" id="6079294">)</span>&nbsp;<span class="builtinfunc" id="6079296">len</span><span class="op" id="6079299">(</span><span class="op" id="6079300">)</span>&nbsp;<span class="builtintype" id="6079302">int</span>&nbsp;<span class="op" id="6079306">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6079309">return</span>&nbsp;<span class="builtinfunc" id="6079316">len</span><span class="op" id="6079319">(</span><span class="op" id="6079320">*</span><span class="ident" id="6079321"><a href="/gostd/net/mail/message.go.html#6079281">p</a></span><span class="op" id="6079322">)</span><br>
<span class="lineno"></span><span class="op" id="6079324">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6079327">func</span>&nbsp;<span class="ident" id="6079332">decodeRFC2047Word</span><span class="op" id="6079349">(</span><span class="ident" id="6079350">s</span>&nbsp;<span class="builtintype" id="6079352">string</span><span class="op" id="6079358">)</span>&nbsp;<span class="op" id="6079360">(</span><span class="builtintype" id="6079361">string</span><span class="op" id="6079367">,</span>&nbsp;<span class="builtintype" id="6079369">error</span><span class="op" id="6079374">)</span>&nbsp;<span class="op" id="6079376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6079379">fields</span>&nbsp;<span class="op" id="6079386">:=</span>&nbsp;<span class="ident" id="6079389"><a href="/gostd/net/mail/message.go.html#6069266">strings</a></span><span class="op" id="6079396">.</span><span class="ident" id="6079397"><a href="/gostd/strings/strings.go.html#2973136">Split</a></span><span class="op" id="6079402">(</span><span class="ident" id="6079403"><a href="/gostd/net/mail/message.go.html#6079350">s</a></span><span class="op" id="6079404">,</span>&nbsp;<span class="string" id="6079406">&#34;?&#34;</span><span class="op" id="6079409">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6079412">if</span>&nbsp;<span class="builtinfunc" id="6079415">len</span><span class="op" id="6079418">(</span><span class="ident" id="6079419"><a href="/gostd/net/mail/message.go.html#6079379">fields</a></span><span class="op" id="6079425">)</span>&nbsp;<span class="op" id="6079427">!=</span>&nbsp;<span class="num" id="6079430">5</span>&nbsp;<span class="op" id="6079432">||</span>&nbsp;<span class="ident" id="6079435"><a href="/gostd/net/mail/message.go.html#6079379">fields</a></span><span class="op" id="6079441">[</span><span class="num" id="6079442">0</span><span class="op" id="6079443">]</span>&nbsp;<span class="op" id="6079445">!=</span>&nbsp;<span class="string" id="6079448">&#34;=&#34;</span>&nbsp;<span class="op" id="6079452">||</span>&nbsp;<span class="ident" id="6079455"><a href="/gostd/net/mail/message.go.html#6079379">fields</a></span><span class="op" id="6079461">[</span><span class="num" id="6079462">4</span><span class="op" id="6079463">]</span>&nbsp;<span class="op" id="6079465">!=</span>&nbsp;<span class="string" id="6079468">&#34;=&#34;</span>&nbsp;<span class="op" id="6079472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6079476">return</span>&nbsp;<span class="string" id="6079483">&#34;&#34;</span><span class="op" id="6079485">,</span>&nbsp;<span class="ident" id="6079487"><a href="/gostd/net/mail/message.go.html#6069195">errors</a></span><span class="op" id="6079493">.</span><span class="ident" id="6079494"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="6079497">(</span><span class="string" id="6079498">&#34;address&nbsp;not&nbsp;RFC&nbsp;2047&nbsp;encoded&#34;</span><span class="op" id="6079528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6079531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6079534">charset</span><span class="op" id="6079541">,</span>&nbsp;<span class="ident" id="6079543">enc</span>&nbsp;<span class="op" id="6079547">:=</span>&nbsp;<span class="ident" id="6079550"><a href="/gostd/net/mail/message.go.html#6069266">strings</a></span><span class="op" id="6079557">.</span><span class="ident" id="6079558"><a href="/gostd/strings/strings.go.html#2977307">ToLower</a></span><span class="op" id="6079565">(</span><span class="ident" id="6079566"><a href="/gostd/net/mail/message.go.html#6079379">fields</a></span><span class="op" id="6079572">[</span><span class="num" id="6079573">1</span><span class="op" id="6079574">]</span><span class="op" id="6079575">)</span><span class="op" id="6079576">,</span>&nbsp;<span class="ident" id="6079578"><a href="/gostd/net/mail/message.go.html#6069266">strings</a></span><span class="op" id="6079585">.</span><span class="ident" id="6079586"><a href="/gostd/strings/strings.go.html#2977307">ToLower</a></span><span class="op" id="6079593">(</span><span class="ident" id="6079594"><a href="/gostd/net/mail/message.go.html#6079379">fields</a></span><span class="op" id="6079600">[</span><span class="num" id="6079601">2</span><span class="op" id="6079602">]</span><span class="op" id="6079603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6079606">if</span>&nbsp;<span class="ident" id="6079609"><a href="/gostd/net/mail/message.go.html#6079534">charset</a></span>&nbsp;<span class="op" id="6079617">!=</span>&nbsp;<span class="string" id="6079620">&#34;us-ascii&#34;</span>&nbsp;<span class="op" id="6079631">&amp;&amp;</span>&nbsp;<span class="ident" id="6079634"><a href="/gostd/net/mail/message.go.html#6079534">charset</a></span>&nbsp;<span class="op" id="6079642">!=</span>&nbsp;<span class="string" id="6079645">&#34;iso-8859-1&#34;</span>&nbsp;<span class="op" id="6079658">&amp;&amp;</span>&nbsp;<span class="ident" id="6079661"><a href="/gostd/net/mail/message.go.html#6079534">charset</a></span>&nbsp;<span class="op" id="6079669">!=</span>&nbsp;<span class="string" id="6079672">&#34;utf-8&#34;</span>&nbsp;<span class="op" id="6079680">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6079684">return</span>&nbsp;<span class="string" id="6079691">&#34;&#34;</span><span class="op" id="6079693">,</span>&nbsp;<span class="ident" id="6079695"><a href="/gostd/net/mail/message.go.html#6069205">fmt</a></span><span class="op" id="6079698">.</span><span class="ident" id="6079699"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="6079705">(</span><span class="string" id="6079706">&#34;charset&nbsp;not&nbsp;supported:&nbsp;%q&#34;</span><span class="op" id="6079733">,</span>&nbsp;<span class="ident" id="6079735"><a href="/gostd/net/mail/message.go.html#6079534">charset</a></span><span class="op" id="6079742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6079745">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6079749">in</span>&nbsp;<span class="op" id="6079752">:=</span>&nbsp;<span class="ident" id="6079755"><a href="/gostd/net/mail/message.go.html#6069167">bytes</a></span><span class="op" id="6079760">.</span><span class="ident" id="6079761"><a href="/gostd/bytes/buffer.go.html#1395915">NewBufferString</a></span><span class="op" id="6079776">(</span><span class="ident" id="6079777"><a href="/gostd/net/mail/message.go.html#6079379">fields</a></span><span class="op" id="6079783">[</span><span class="num" id="6079784">3</span><span class="op" id="6079785">]</span><span class="op" id="6079786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6079789">var</span>&nbsp;<span class="ident" id="6079793">r</span>&nbsp;<span class="ident" id="6079795"><a href="/gostd/net/mail/message.go.html#6069212">io</a></span><span class="op" id="6079797">.</span><span class="ident" id="6079798"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6079806">switch</span>&nbsp;<span class="ident" id="6079813"><a href="/gostd/net/mail/message.go.html#6079543">enc</a></span>&nbsp;<span class="op" id="6079817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6079820">case</span>&nbsp;<span class="string" id="6079825">&#34;b&#34;</span><span class="op" id="6079828">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6079832"><a href="/gostd/net/mail/message.go.html#6079793">r</a></span>&nbsp;<span class="op" id="6079834">=</span>&nbsp;<span class="ident" id="6079836"><a href="/gostd/net/mail/message.go.html#6069176">base64</a></span><span class="op" id="6079842">.</span><span class="ident" id="6079843"><a href="/gostd/encoding/base64/base64.go.html#4060792">NewDecoder</a></span><span class="op" id="6079853">(</span><span class="ident" id="6079854"><a href="/gostd/net/mail/message.go.html#6069176">base64</a></span><span class="op" id="6079860">.</span><span class="ident" id="6079861"><a href="/gostd/encoding/base64/base64.go.html#4053069">StdEncoding</a></span><span class="op" id="6079872">,</span>&nbsp;<span class="ident" id="6079874"><a href="/gostd/net/mail/message.go.html#6079749">in</a></span><span class="op" id="6079876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6079879">case</span>&nbsp;<span class="string" id="6079884">&#34;q&#34;</span><span class="op" id="6079887">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6079891"><a href="/gostd/net/mail/message.go.html#6079793">r</a></span>&nbsp;<span class="op" id="6079893">=</span>&nbsp;<span class="ident" id="6079895"><a href="/gostd/net/mail/message.go.html#6080477">qDecoder</a></span><span class="op" id="6079903">{</span><span class="ident" id="6079904"><a href="/gostd/net/mail/message.go.html#6080496">r</a></span><span class="op" id="6079905">:</span>&nbsp;<span class="ident" id="6079907"><a href="/gostd/net/mail/message.go.html#6079749">in</a></span><span class="op" id="6079909">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6079912">default</span><span class="op" id="6079919">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6079923">return</span>&nbsp;<span class="string" id="6079930">&#34;&#34;</span><span class="op" id="6079932">,</span>&nbsp;<span class="ident" id="6079934"><a href="/gostd/net/mail/message.go.html#6069205">fmt</a></span><span class="op" id="6079937">.</span><span class="ident" id="6079938"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="6079944">(</span><span class="string" id="6079945">&#34;RFC&nbsp;2047&nbsp;encoding&nbsp;not&nbsp;supported:&nbsp;%q&#34;</span><span class="op" id="6079982">,</span>&nbsp;<span class="ident" id="6079984"><a href="/gostd/net/mail/message.go.html#6079543">enc</a></span><span class="op" id="6079987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6079990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6079994">dec</span><span class="op" id="6079997">,</span>&nbsp;<span class="ident" id="6079999">err</span>&nbsp;<span class="op" id="6080003">:=</span>&nbsp;<span class="ident" id="6080006"><a href="/gostd/net/mail/message.go.html#6069218">ioutil</a></span><span class="op" id="6080012">.</span><span class="ident" id="6080013"><a href="/gostd/io/ioutil/ioutil.go.html#3765117">ReadAll</a></span><span class="op" id="6080020">(</span><span class="ident" id="6080021"><a href="/gostd/net/mail/message.go.html#6079793">r</a></span><span class="op" id="6080022">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6080025">if</span>&nbsp;<span class="ident" id="6080028"><a href="/gostd/net/mail/message.go.html#6079999">err</a></span>&nbsp;<span class="op" id="6080032">!=</span>&nbsp;<span class="builtintype" id="6080035">nil</span>&nbsp;<span class="op" id="6080039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6080043">return</span>&nbsp;<span class="string" id="6080050">&#34;&#34;</span><span class="op" id="6080052">,</span>&nbsp;<span class="ident" id="6080054"><a href="/gostd/net/mail/message.go.html#6079999">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6080059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6080063">switch</span>&nbsp;<span class="ident" id="6080070"><a href="/gostd/net/mail/message.go.html#6079534">charset</a></span>&nbsp;<span class="op" id="6080078">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6080081">case</span>&nbsp;<span class="string" id="6080086">&#34;us-ascii&#34;</span><span class="op" id="6080096">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6080100">b</span>&nbsp;<span class="op" id="6080102">:=</span>&nbsp;<span class="builtinfunc" id="6080105">new</span><span class="op" id="6080108">(</span><span class="ident" id="6080109"><a href="/gostd/net/mail/message.go.html#6069167">bytes</a></span><span class="op" id="6080114">.</span><span class="ident" id="6080115"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="6080121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6080125">for</span>&nbsp;<span class="ident" id="6080129">_</span><span class="op" id="6080130">,</span>&nbsp;<span class="ident" id="6080132">c</span>&nbsp;<span class="op" id="6080134">:=</span>&nbsp;<span class="keyword" id="6080137">range</span>&nbsp;<span class="ident" id="6080143"><a href="/gostd/net/mail/message.go.html#6079994">dec</a></span>&nbsp;<span class="op" id="6080147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6080152">if</span>&nbsp;<span class="ident" id="6080155"><a href="/gostd/net/mail/message.go.html#6080132">c</a></span>&nbsp;<span class="op" id="6080157">&gt;=</span>&nbsp;<span class="num" id="6080160">0x80</span>&nbsp;<span class="op" id="6080165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6080171"><a href="/gostd/net/mail/message.go.html#6080100">b</a></span><span class="op" id="6080172">.</span><span class="ident" id="6080173"><a href="/gostd/bytes/buffer.go.html#1390522">WriteRune</a></span><span class="op" id="6080182">(</span><span class="ident" id="6080183"><a href="/gostd/net/mail/message.go.html#6069285">unicode</a></span><span class="op" id="6080190">.</span><span class="ident" id="6080191"><a href="/gostd/unicode/letter.go.html#1821605">ReplacementChar</a></span><span class="op" id="6080206">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6080211">}</span>&nbsp;<span class="keyword" id="6080213">else</span>&nbsp;<span class="op" id="6080218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6080224"><a href="/gostd/net/mail/message.go.html#6080100">b</a></span><span class="op" id="6080225">.</span><span class="ident" id="6080226"><a href="/gostd/bytes/buffer.go.html#1390522">WriteRune</a></span><span class="op" id="6080235">(</span><span class="builtintype" id="6080236">rune</span><span class="op" id="6080240">(</span><span class="ident" id="6080241"><a href="/gostd/net/mail/message.go.html#6080132">c</a></span><span class="op" id="6080242">)</span><span class="op" id="6080243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6080248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6080252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6080256">return</span>&nbsp;<span class="ident" id="6080263"><a href="/gostd/net/mail/message.go.html#6080100">b</a></span><span class="op" id="6080264">.</span><span class="ident" id="6080265"><a href="/gostd/bytes/buffer.go.html#1384648">String</a></span><span class="op" id="6080271">(</span><span class="op" id="6080272">)</span><span class="op" id="6080273">,</span>&nbsp;<span class="builtintype" id="6080275">nil</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6080280">case</span>&nbsp;<span class="string" id="6080285">&#34;iso-8859-1&#34;</span><span class="op" id="6080297">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6080301">b</span>&nbsp;<span class="op" id="6080303">:=</span>&nbsp;<span class="builtinfunc" id="6080306">new</span><span class="op" id="6080309">(</span><span class="ident" id="6080310"><a href="/gostd/net/mail/message.go.html#6069167">bytes</a></span><span class="op" id="6080315">.</span><span class="ident" id="6080316"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="6080322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6080326">for</span>&nbsp;<span class="ident" id="6080330">_</span><span class="op" id="6080331">,</span>&nbsp;<span class="ident" id="6080333">c</span>&nbsp;<span class="op" id="6080335">:=</span>&nbsp;<span class="keyword" id="6080338">range</span>&nbsp;<span class="ident" id="6080344"><a href="/gostd/net/mail/message.go.html#6079994">dec</a></span>&nbsp;<span class="op" id="6080348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6080353"><a href="/gostd/net/mail/message.go.html#6080301">b</a></span><span class="op" id="6080354">.</span><span class="ident" id="6080355"><a href="/gostd/bytes/buffer.go.html#1390522">WriteRune</a></span><span class="op" id="6080364">(</span><span class="builtintype" id="6080365">rune</span><span class="op" id="6080369">(</span><span class="ident" id="6080370"><a href="/gostd/net/mail/message.go.html#6080333">c</a></span><span class="op" id="6080371">)</span><span class="op" id="6080372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6080376">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6080380">return</span>&nbsp;<span class="ident" id="6080387"><a href="/gostd/net/mail/message.go.html#6080301">b</a></span><span class="op" id="6080388">.</span><span class="ident" id="6080389"><a href="/gostd/bytes/buffer.go.html#1384648">String</a></span><span class="op" id="6080395">(</span><span class="op" id="6080396">)</span><span class="op" id="6080397">,</span>&nbsp;<span class="builtintype" id="6080399">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6080404">case</span>&nbsp;<span class="string" id="6080409">&#34;utf-8&#34;</span><span class="op" id="6080416">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6080420">return</span>&nbsp;<span class="builtintype" id="6080427">string</span><span class="op" id="6080433">(</span><span class="ident" id="6080434"><a href="/gostd/net/mail/message.go.html#6079994">dec</a></span><span class="op" id="6080437">)</span><span class="op" id="6080438">,</span>&nbsp;<span class="builtintype" id="6080440">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6080445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6080448">panic</span><span class="op" id="6080453">(</span><span class="string" id="6080454">&#34;unreachable&#34;</span><span class="op" id="6080467">)</span><br>
<span class="lineno">490</span><span class="op" id="6080469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6080472">type</span>&nbsp;<span class="ident" id="6080477">qDecoder</span>&nbsp;<span class="keyword" id="6080486">struct</span>&nbsp;<span class="op" id="6080493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6080496">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6080504"><a href="/gostd/net/mail/message.go.html#6069212">io</a></span><span class="op" id="6080506">.</span><span class="ident" id="6080507"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6080515">scratch</span>&nbsp;<span class="op" id="6080523">[</span><span class="num" id="6080524">2</span><span class="op" id="6080525">]</span><span class="builtintype" id="6080526">byte</span><br>
<span class="lineno">495</span><span class="op" id="6080531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6080534">func</span>&nbsp;<span class="op" id="6080539">(</span><span class="ident" id="6080540">qd</span>&nbsp;<span class="ident" id="6080543"><a href="/gostd/net/mail/message.go.html#6080477">qDecoder</a></span><span class="op" id="6080551">)</span>&nbsp;<span class="ident" id="6080553">Read</span><span class="op" id="6080557">(</span><span class="ident" id="6080558">p</span>&nbsp;<span class="op" id="6080560">[</span><span class="op" id="6080561">]</span><span class="builtintype" id="6080562">byte</span><span class="op" id="6080566">)</span>&nbsp;<span class="op" id="6080568">(</span><span class="ident" id="6080569">n</span>&nbsp;<span class="builtintype" id="6080571">int</span><span class="op" id="6080574">,</span>&nbsp;<span class="ident" id="6080576">err</span>&nbsp;<span class="builtintype" id="6080580">error</span><span class="op" id="6080585">)</span>&nbsp;<span class="op" id="6080587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6080590">//&nbsp;This&nbsp;method&nbsp;writes&nbsp;at&nbsp;most&nbsp;one&nbsp;byte&nbsp;into&nbsp;p.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6080638">if</span>&nbsp;<span class="builtinfunc" id="6080641">len</span><span class="op" id="6080644">(</span><span class="ident" id="6080645"><a href="/gostd/net/mail/message.go.html#6080558">p</a></span><span class="op" id="6080646">)</span>&nbsp;<span class="op" id="6080648">==</span>&nbsp;<span class="num" id="6080651">0</span>&nbsp;<span class="op" id="6080653">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6080657">return</span>&nbsp;<span class="num" id="6080664">0</span><span class="op" id="6080665">,</span>&nbsp;<span class="builtintype" id="6080667">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6080672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6080675">if</span>&nbsp;<span class="ident" id="6080678">_</span><span class="op" id="6080679">,</span>&nbsp;<span class="ident" id="6080681">err</span>&nbsp;<span class="op" id="6080685">:=</span>&nbsp;<span class="ident" id="6080688"><a href="/gostd/net/mail/message.go.html#6080540">qd</a></span><span class="op" id="6080690">.</span><span class="ident" id="6080691"><a href="/gostd/net/mail/message.go.html#6080496">r</a></span><span class="op" id="6080692">.</span><span class="ident" id="6080693"><a href="/gostd/io/io.go.html#1421843">Read</a></span><span class="op" id="6080697">(</span><span class="ident" id="6080698"><a href="/gostd/net/mail/message.go.html#6080540">qd</a></span><span class="op" id="6080700">.</span><span class="ident" id="6080701"><a href="/gostd/net/mail/message.go.html#6080515">scratch</a></span><span class="op" id="6080708">[</span><span class="op" id="6080709">:</span><span class="num" id="6080710">1</span><span class="op" id="6080711">]</span><span class="op" id="6080712">)</span><span class="op" id="6080713">;</span>&nbsp;<span class="ident" id="6080715"><a href="/gostd/net/mail/message.go.html#6080681">err</a></span>&nbsp;<span class="op" id="6080719">!=</span>&nbsp;<span class="builtintype" id="6080722">nil</span>&nbsp;<span class="op" id="6080726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6080730">return</span>&nbsp;<span class="num" id="6080737">0</span><span class="op" id="6080738">,</span>&nbsp;<span class="ident" id="6080740"><a href="/gostd/net/mail/message.go.html#6080681">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6080745">}</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6080748">switch</span>&nbsp;<span class="ident" id="6080755">c</span>&nbsp;<span class="op" id="6080757">:=</span>&nbsp;<span class="ident" id="6080760"><a href="/gostd/net/mail/message.go.html#6080540">qd</a></span><span class="op" id="6080762">.</span><span class="ident" id="6080763"><a href="/gostd/net/mail/message.go.html#6080515">scratch</a></span><span class="op" id="6080770">[</span><span class="num" id="6080771">0</span><span class="op" id="6080772">]</span><span class="op" id="6080773">;</span>&nbsp;<span class="op" id="6080775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6080778">case</span>&nbsp;<span class="ident" id="6080783"><a href="/gostd/net/mail/message.go.html#6080755">c</a></span>&nbsp;<span class="op" id="6080785">==</span>&nbsp;<span class="string" id="6080788">&#39;=&#39;</span><span class="op" id="6080791">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6080795">if</span>&nbsp;<span class="ident" id="6080798">_</span><span class="op" id="6080799">,</span>&nbsp;<span class="ident" id="6080801">err</span>&nbsp;<span class="op" id="6080805">:=</span>&nbsp;<span class="ident" id="6080808"><a href="/gostd/net/mail/message.go.html#6069212">io</a></span><span class="op" id="6080810">.</span><span class="ident" id="6080811"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="6080819">(</span><span class="ident" id="6080820"><a href="/gostd/net/mail/message.go.html#6080540">qd</a></span><span class="op" id="6080822">.</span><span class="ident" id="6080823"><a href="/gostd/net/mail/message.go.html#6080496">r</a></span><span class="op" id="6080824">,</span>&nbsp;<span class="ident" id="6080826"><a href="/gostd/net/mail/message.go.html#6080540">qd</a></span><span class="op" id="6080828">.</span><span class="ident" id="6080829"><a href="/gostd/net/mail/message.go.html#6080515">scratch</a></span><span class="op" id="6080836">[</span><span class="op" id="6080837">:</span><span class="num" id="6080838">2</span><span class="op" id="6080839">]</span><span class="op" id="6080840">)</span><span class="op" id="6080841">;</span>&nbsp;<span class="ident" id="6080843"><a href="/gostd/net/mail/message.go.html#6080801">err</a></span>&nbsp;<span class="op" id="6080847">!=</span>&nbsp;<span class="builtintype" id="6080850">nil</span>&nbsp;<span class="op" id="6080854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6080859">return</span>&nbsp;<span class="num" id="6080866">0</span><span class="op" id="6080867">,</span>&nbsp;<span class="ident" id="6080869"><a href="/gostd/net/mail/message.go.html#6080801">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6080875">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6080879">x</span><span class="op" id="6080880">,</span>&nbsp;<span class="ident" id="6080882">err</span>&nbsp;<span class="op" id="6080886">:=</span>&nbsp;<span class="ident" id="6080889"><a href="/gostd/net/mail/message.go.html#6069255">strconv</a></span><span class="op" id="6080896">.</span><span class="ident" id="6080897"><a href="/gostd/strconv/atoi.go.html#2356133">ParseInt</a></span><span class="op" id="6080905">(</span><span class="builtintype" id="6080906">string</span><span class="op" id="6080912">(</span><span class="ident" id="6080913"><a href="/gostd/net/mail/message.go.html#6080540">qd</a></span><span class="op" id="6080915">.</span><span class="ident" id="6080916"><a href="/gostd/net/mail/message.go.html#6080515">scratch</a></span><span class="op" id="6080923">[</span><span class="op" id="6080924">:</span><span class="num" id="6080925">2</span><span class="op" id="6080926">]</span><span class="op" id="6080927">)</span><span class="op" id="6080928">,</span>&nbsp;<span class="num" id="6080930">16</span><span class="op" id="6080932">,</span>&nbsp;<span class="num" id="6080934">64</span><span class="op" id="6080936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6080940">if</span>&nbsp;<span class="ident" id="6080943"><a href="/gostd/net/mail/message.go.html#6080882">err</a></span>&nbsp;<span class="op" id="6080947">!=</span>&nbsp;<span class="builtintype" id="6080950">nil</span>&nbsp;<span class="op" id="6080954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6080959">return</span>&nbsp;<span class="num" id="6080966">0</span><span class="op" id="6080967">,</span>&nbsp;<span class="ident" id="6080969"><a href="/gostd/net/mail/message.go.html#6069205">fmt</a></span><span class="op" id="6080972">.</span><span class="ident" id="6080973"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="6080979">(</span><span class="string" id="6080980">&#34;mail:&nbsp;invalid&nbsp;RFC&nbsp;2047&nbsp;encoding:&nbsp;%q&#34;</span><span class="op" id="6081017">,</span>&nbsp;<span class="ident" id="6081019"><a href="/gostd/net/mail/message.go.html#6080540">qd</a></span><span class="op" id="6081021">.</span><span class="ident" id="6081022"><a href="/gostd/net/mail/message.go.html#6080515">scratch</a></span><span class="op" id="6081029">[</span><span class="op" id="6081030">:</span><span class="num" id="6081031">2</span><span class="op" id="6081032">]</span><span class="op" id="6081033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6081037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6081041"><a href="/gostd/net/mail/message.go.html#6080558">p</a></span><span class="op" id="6081042">[</span><span class="num" id="6081043">0</span><span class="op" id="6081044">]</span>&nbsp;<span class="op" id="6081046">=</span>&nbsp;<span class="builtintype" id="6081048">byte</span><span class="op" id="6081052">(</span><span class="ident" id="6081053"><a href="/gostd/net/mail/message.go.html#6080879">x</a></span><span class="op" id="6081054">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6081057">case</span>&nbsp;<span class="ident" id="6081062"><a href="/gostd/net/mail/message.go.html#6080755">c</a></span>&nbsp;<span class="op" id="6081064">==</span>&nbsp;<span class="string" id="6081067">&#39;_&#39;</span><span class="op" id="6081070">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6081074"><a href="/gostd/net/mail/message.go.html#6080558">p</a></span><span class="op" id="6081075">[</span><span class="num" id="6081076">0</span><span class="op" id="6081077">]</span>&nbsp;<span class="op" id="6081079">=</span>&nbsp;<span class="string" id="6081081">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6081086">default</span><span class="op" id="6081093">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6081097"><a href="/gostd/net/mail/message.go.html#6080558">p</a></span><span class="op" id="6081098">[</span><span class="num" id="6081099">0</span><span class="op" id="6081100">]</span>&nbsp;<span class="op" id="6081102">=</span>&nbsp;<span class="ident" id="6081104"><a href="/gostd/net/mail/message.go.html#6080755">c</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6081107">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6081110">return</span>&nbsp;<span class="num" id="6081117">1</span><span class="op" id="6081118">,</span>&nbsp;<span class="builtintype" id="6081120">nil</span><br>
<span class="lineno"></span><span class="op" id="6081124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6081127">var</span>&nbsp;<span class="ident" id="6081131">atextChars</span>&nbsp;<span class="op" id="6081142">=</span>&nbsp;<span class="op" id="6081144">[</span><span class="op" id="6081145">]</span><span class="builtintype" id="6081146">byte</span><span class="op" id="6081150">(</span><span class="string" id="6081151">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#34;</span>&nbsp;<span class="op" id="6081180">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6081183">&#34;abcdefghijklmnopqrstuvwxyz&#34;</span>&nbsp;<span class="op" id="6081212">+</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6081215">&#34;0123456789&#34;</span>&nbsp;<span class="op" id="6081228">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6081231">&#34;!#$%&amp;&#39;*+-/=?^_`{|}~&#34;</span><span class="op" id="6081252">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6081255">//&nbsp;isAtext&nbsp;returns&nbsp;true&nbsp;if&nbsp;c&nbsp;is&nbsp;an&nbsp;RFC&nbsp;5322&nbsp;atext&nbsp;character.</span><br>
<span class="lineno"></span><span class="comment" id="6081316">//&nbsp;If&nbsp;dot&nbsp;is&nbsp;true,&nbsp;period&nbsp;is&nbsp;included.</span><br>
<span class="lineno">530</span><span class="keyword" id="6081355">func</span>&nbsp;<span class="ident" id="6081360">isAtext</span><span class="op" id="6081367">(</span><span class="ident" id="6081368">c</span>&nbsp;<span class="builtintype" id="6081370">byte</span><span class="op" id="6081374">,</span>&nbsp;<span class="ident" id="6081376">dot</span>&nbsp;<span class="builtintype" id="6081380">bool</span><span class="op" id="6081384">)</span>&nbsp;<span class="builtintype" id="6081386">bool</span>&nbsp;<span class="op" id="6081391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6081394">if</span>&nbsp;<span class="ident" id="6081397"><a href="/gostd/net/mail/message.go.html#6081376">dot</a></span>&nbsp;<span class="op" id="6081401">&amp;&amp;</span>&nbsp;<span class="ident" id="6081404"><a href="/gostd/net/mail/message.go.html#6081368">c</a></span>&nbsp;<span class="op" id="6081406">==</span>&nbsp;<span class="string" id="6081409">&#39;.&#39;</span>&nbsp;<span class="op" id="6081413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6081417">return</span>&nbsp;<span class="builtintype" id="6081424">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6081430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6081433">return</span>&nbsp;<span class="ident" id="6081440"><a href="/gostd/net/mail/message.go.html#6069167">bytes</a></span><span class="op" id="6081445">.</span><span class="ident" id="6081446"><a href="/gostd/bytes/bytes_decl.go.html#1414570">IndexByte</a></span><span class="op" id="6081455">(</span><span class="ident" id="6081456"><a href="/gostd/net/mail/message.go.html#6081131">atextChars</a></span><span class="op" id="6081466">,</span>&nbsp;<span class="ident" id="6081468"><a href="/gostd/net/mail/message.go.html#6081368">c</a></span><span class="op" id="6081469">)</span>&nbsp;<span class="op" id="6081471">&gt;=</span>&nbsp;<span class="num" id="6081474">0</span><br>
<span class="lineno">535</span><span class="op" id="6081476">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6081479">//&nbsp;isQtext&nbsp;returns&nbsp;true&nbsp;if&nbsp;c&nbsp;is&nbsp;an&nbsp;RFC&nbsp;5322&nbsp;qtext&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="6081540">func</span>&nbsp;<span class="ident" id="6081545">isQtext</span><span class="op" id="6081552">(</span><span class="ident" id="6081553">c</span>&nbsp;<span class="builtintype" id="6081555">byte</span><span class="op" id="6081559">)</span>&nbsp;<span class="builtintype" id="6081561">bool</span>&nbsp;<span class="op" id="6081566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6081569">//&nbsp;Printable&nbsp;US-ASCII,&nbsp;excluding&nbsp;backslash&nbsp;or&nbsp;quote.</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6081623">if</span>&nbsp;<span class="ident" id="6081626"><a href="/gostd/net/mail/message.go.html#6081553">c</a></span>&nbsp;<span class="op" id="6081628">==</span>&nbsp;<span class="string" id="6081631">&#39;\\&#39;</span>&nbsp;<span class="op" id="6081636">||</span>&nbsp;<span class="ident" id="6081639"><a href="/gostd/net/mail/message.go.html#6081553">c</a></span>&nbsp;<span class="op" id="6081641">==</span>&nbsp;<span class="string" id="6081644">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="6081648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6081652">return</span>&nbsp;<span class="builtintype" id="6081659">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6081666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6081669">return</span>&nbsp;<span class="string" id="6081676">&#39;!&#39;</span>&nbsp;<span class="op" id="6081680">&lt;=</span>&nbsp;<span class="ident" id="6081683"><a href="/gostd/net/mail/message.go.html#6081553">c</a></span>&nbsp;<span class="op" id="6081685">&amp;&amp;</span>&nbsp;<span class="ident" id="6081688"><a href="/gostd/net/mail/message.go.html#6081553">c</a></span>&nbsp;<span class="op" id="6081690">&lt;=</span>&nbsp;<span class="string" id="6081693">&#39;~&#39;</span><br>
<span class="lineno"></span><span class="op" id="6081697">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="comment" id="6081700">//&nbsp;isVchar&nbsp;returns&nbsp;true&nbsp;if&nbsp;c&nbsp;is&nbsp;an&nbsp;RFC&nbsp;5322&nbsp;VCHAR&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="6081761">func</span>&nbsp;<span class="ident" id="6081766">isVchar</span><span class="op" id="6081773">(</span><span class="ident" id="6081774">c</span>&nbsp;<span class="builtintype" id="6081776">byte</span><span class="op" id="6081780">)</span>&nbsp;<span class="builtintype" id="6081782">bool</span>&nbsp;<span class="op" id="6081787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6081790">//&nbsp;Visible&nbsp;(printing)&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6081825">return</span>&nbsp;<span class="string" id="6081832">&#39;!&#39;</span>&nbsp;<span class="op" id="6081836">&lt;=</span>&nbsp;<span class="ident" id="6081839"><a href="/gostd/net/mail/message.go.html#6081774">c</a></span>&nbsp;<span class="op" id="6081841">&amp;&amp;</span>&nbsp;<span class="ident" id="6081844"><a href="/gostd/net/mail/message.go.html#6081774">c</a></span>&nbsp;<span class="op" id="6081846">&lt;=</span>&nbsp;<span class="string" id="6081849">&#39;~&#39;</span><br>
<span class="lineno">550</span><span class="op" id="6081853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6081856">//&nbsp;isWSP&nbsp;returns&nbsp;true&nbsp;if&nbsp;c&nbsp;is&nbsp;a&nbsp;WSP&nbsp;(white&nbsp;space).</span><br>
<span class="lineno"></span><span class="comment" id="6081907">//&nbsp;WSP&nbsp;is&nbsp;a&nbsp;space&nbsp;or&nbsp;horizontal&nbsp;tab&nbsp;(RFC5234&nbsp;Appendix&nbsp;B).</span><br>
<span class="lineno"></span><span class="keyword" id="6081965">func</span>&nbsp;<span class="ident" id="6081970">isWSP</span><span class="op" id="6081975">(</span><span class="ident" id="6081976">c</span>&nbsp;<span class="builtintype" id="6081978">byte</span><span class="op" id="6081982">)</span>&nbsp;<span class="builtintype" id="6081984">bool</span>&nbsp;<span class="op" id="6081989">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6081992">return</span>&nbsp;<span class="ident" id="6081999"><a href="/gostd/net/mail/message.go.html#6081976">c</a></span>&nbsp;<span class="op" id="6082001">==</span>&nbsp;<span class="string" id="6082004">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="6082008">||</span>&nbsp;<span class="ident" id="6082011"><a href="/gostd/net/mail/message.go.html#6081976">c</a></span>&nbsp;<span class="op" id="6082013">==</span>&nbsp;<span class="string" id="6082016">&#39;\t&#39;</span><br>
<span class="lineno"></span><span class="op" id="6082021">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
