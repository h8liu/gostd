<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>lonnie.io/e8vm/arch8</h2>
<ul>
<li><a href="/gostd/lonnie.io/e8vm/arch8/console.go.html">console.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/cpu.go.html">cpu.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/cpu_test.go.html">cpu_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/device.go.html">device.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/exception.go.html">exception.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_all.go.html">inst_all.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_br.go.html">inst_br.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_br_test.go.html">inst_br_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_imm.go.html">inst_imm.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_imm_test.go.html">inst_imm_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_jmp.go.html">inst_jmp.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_reg.go.html">inst_reg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_reg_test.go.html">inst_reg_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_sys.go.html">inst_sys.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/int_bus.go.html">int_bus.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/interrupt.go.html">interrupt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/interrupt_test.go.html">interrupt_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/machine.go.html">machine.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/multi_core.go.html">multi_core.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/page.go.html">page.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/page_table.go.html">page_table.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/page_table_test.go.html">page_table_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/page_test.go.html">page_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/phy_memory.go.html">phy_memory.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/phy_memory_test.go.html">phy_memory_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/regs.go.html">regs.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/regs_test.go.html">regs_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/run_image.go.html">run_image.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/serial.go.html">serial.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/ticker.go.html">ticker.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/virt_memory.go.html">virt_memory.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/virt_memory_test.go.html">virt_memory_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="keyword" id="4793042">package</span>&nbsp;<span class="ident" id="4793050">arch8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4793057">import</span>&nbsp;<span class="op" id="4793064">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4793067">&#34;io&#34;</span><br>
<span class="lineno">5</span><span class="op" id="4793072">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4793075">//&nbsp;Machine&nbsp;is&nbsp;a&nbsp;multicore&nbsp;shared&nbsp;memory&nbsp;simulated&nbsp;arch8&nbsp;machine.</span><br>
<span class="lineno"></span><span class="keyword" id="4793140">type</span>&nbsp;<span class="ident" id="4793145">Machine</span>&nbsp;<span class="keyword" id="4793153">struct</span>&nbsp;<span class="op" id="4793160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4793163">phyMem</span>&nbsp;&nbsp;<span class="op" id="4793171">*</span><span class="ident" id="4793172">phyMemory</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4793183">inst</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4793191">inst</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4793197">cores</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4793205">*</span><span class="ident" id="4793206">multiCore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4793217">serial</span>&nbsp;&nbsp;<span class="op" id="4793225">*</span><span class="ident" id="4793226">serial</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4793234">console</span>&nbsp;<span class="op" id="4793242">*</span><span class="ident" id="4793243">console</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4793253">devices</span>&nbsp;<span class="op" id="4793261">[</span><span class="op" id="4793262">]</span><span class="ident" id="4793263">device</span><br>
<span class="lineno"></span><span class="op" id="4793270">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4793273">//&nbsp;NewMachine&nbsp;creates&nbsp;a&nbsp;machine&nbsp;with&nbsp;memory&nbsp;and&nbsp;cores.</span><br>
<span class="lineno"></span><span class="keyword" id="4793328">func</span>&nbsp;<span class="ident" id="4793333">NewMachine</span><span class="op" id="4793343">(</span><span class="ident" id="4793344">memSize</span>&nbsp;<span class="builtintype" id="4793352">uint32</span><span class="op" id="4793358">,</span>&nbsp;<span class="ident" id="4793360">ncore</span>&nbsp;<span class="builtintype" id="4793366">int</span><span class="op" id="4793369">)</span>&nbsp;<span class="op" id="4793371">*</span><span class="ident" id="4793372">Machine</span>&nbsp;<span class="op" id="4793380">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4793383">ret</span>&nbsp;<span class="op" id="4793387">:=</span>&nbsp;<span class="builtinfunc" id="4793390">new</span><span class="op" id="4793393">(</span><span class="ident" id="4793394">Machine</span><span class="op" id="4793401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4793404">ret</span><span class="op" id="4793407">.</span><span class="ident" id="4793408">phyMem</span>&nbsp;<span class="op" id="4793415">=</span>&nbsp;<span class="ident" id="4793417">newPhyMemory</span><span class="op" id="4793429">(</span><span class="ident" id="4793430">memSize</span><span class="op" id="4793437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4793440">ret</span><span class="op" id="4793443">.</span><span class="ident" id="4793444">inst</span>&nbsp;<span class="op" id="4793449">=</span>&nbsp;<span class="builtinfunc" id="4793451">new</span><span class="op" id="4793454">(</span><span class="ident" id="4793455">instArch8</span><span class="op" id="4793464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4793467">ret</span><span class="op" id="4793470">.</span><span class="ident" id="4793471">cores</span>&nbsp;<span class="op" id="4793477">=</span>&nbsp;<span class="ident" id="4793479">newMultiCore</span><span class="op" id="4793491">(</span><span class="ident" id="4793492">ncore</span><span class="op" id="4793497">,</span>&nbsp;<span class="ident" id="4793499">ret</span><span class="op" id="4793502">.</span><span class="ident" id="4793503">phyMem</span><span class="op" id="4793509">,</span>&nbsp;<span class="ident" id="4793511">ret</span><span class="op" id="4793514">.</span><span class="ident" id="4793515">inst</span><span class="op" id="4793519">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4793523">//&nbsp;hook-up&nbsp;devices</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4793543">p</span>&nbsp;<span class="op" id="4793545">:=</span>&nbsp;<span class="ident" id="4793548">ret</span><span class="op" id="4793551">.</span><span class="ident" id="4793552">phyMem</span><span class="op" id="4793558">.</span><span class="ident" id="4793559">Page</span><span class="op" id="4793563">(</span><span class="ident" id="4793564">pageBasicIO</span><span class="op" id="4793575">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4793579">ret</span><span class="op" id="4793582">.</span><span class="ident" id="4793583">serial</span>&nbsp;<span class="op" id="4793590">=</span>&nbsp;<span class="ident" id="4793592">newSerial</span><span class="op" id="4793601">(</span><span class="ident" id="4793602">p</span><span class="op" id="4793603">,</span>&nbsp;<span class="ident" id="4793605">ret</span><span class="op" id="4793608">.</span><span class="ident" id="4793609">cores</span><span class="op" id="4793614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4793617">ret</span><span class="op" id="4793620">.</span><span class="ident" id="4793621">console</span>&nbsp;<span class="op" id="4793629">=</span>&nbsp;<span class="ident" id="4793631">newConsole</span><span class="op" id="4793641">(</span><span class="ident" id="4793642">p</span><span class="op" id="4793643">,</span>&nbsp;<span class="ident" id="4793645">ret</span><span class="op" id="4793648">.</span><span class="ident" id="4793649">cores</span><span class="op" id="4793654">)</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4793658">ret</span><span class="op" id="4793661">.</span><span class="ident" id="4793662">addDevice</span><span class="op" id="4793671">(</span><span class="ident" id="4793672">newTicker</span><span class="op" id="4793681">(</span><span class="ident" id="4793682">ret</span><span class="op" id="4793685">.</span><span class="ident" id="4793686">cores</span><span class="op" id="4793691">)</span><span class="op" id="4793692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4793695">ret</span><span class="op" id="4793698">.</span><span class="ident" id="4793699">addDevice</span><span class="op" id="4793708">(</span><span class="ident" id="4793709">ret</span><span class="op" id="4793712">.</span><span class="ident" id="4793713">serial</span><span class="op" id="4793719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4793722">ret</span><span class="op" id="4793725">.</span><span class="ident" id="4793726">addDevice</span><span class="op" id="4793735">(</span><span class="ident" id="4793736">ret</span><span class="op" id="4793739">.</span><span class="ident" id="4793740">console</span><span class="op" id="4793747">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4793751">return</span>&nbsp;<span class="ident" id="4793758">ret</span><br>
<span class="lineno"></span><span class="op" id="4793762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4793765">//&nbsp;SetOutput&nbsp;sets&nbsp;the&nbsp;output&nbsp;writer&nbsp;of&nbsp;the&nbsp;machine&#39;s&nbsp;serial</span><br>
<span class="lineno"></span><span class="comment" id="4793825">//&nbsp;console.</span><br>
<span class="lineno">40</span><span class="keyword" id="4793837">func</span>&nbsp;<span class="op" id="4793842">(</span><span class="ident" id="4793843">m</span>&nbsp;<span class="op" id="4793845">*</span><span class="ident" id="4793846">Machine</span><span class="op" id="4793853">)</span>&nbsp;<span class="ident" id="4793855">SetOutput</span><span class="op" id="4793864">(</span><span class="ident" id="4793865">w</span>&nbsp;<span class="ident" id="4793867">io</span><span class="op" id="4793869">.</span><span class="ident" id="4793870">Writer</span><span class="op" id="4793876">)</span>&nbsp;<span class="op" id="4793878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4793881">m</span><span class="op" id="4793882">.</span><span class="ident" id="4793883">serial</span><span class="op" id="4793889">.</span><span class="ident" id="4793890">Output</span>&nbsp;<span class="op" id="4793897">=</span>&nbsp;<span class="ident" id="4793899">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4793902">m</span><span class="op" id="4793903">.</span><span class="ident" id="4793904">console</span><span class="op" id="4793911">.</span><span class="ident" id="4793912">Output</span>&nbsp;<span class="op" id="4793919">=</span>&nbsp;<span class="ident" id="4793921">w</span><br>
<span class="lineno"></span><span class="op" id="4793923">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="4793926">//&nbsp;AddDevice&nbsp;adds&nbsp;a&nbsp;devices&nbsp;to&nbsp;the&nbsp;machine.</span><br>
<span class="lineno"></span><span class="keyword" id="4793970">func</span>&nbsp;<span class="op" id="4793975">(</span><span class="ident" id="4793976">m</span>&nbsp;<span class="op" id="4793978">*</span><span class="ident" id="4793979">Machine</span><span class="op" id="4793986">)</span>&nbsp;<span class="ident" id="4793988">addDevice</span><span class="op" id="4793997">(</span><span class="ident" id="4793998">d</span>&nbsp;<span class="ident" id="4794000">device</span><span class="op" id="4794006">)</span>&nbsp;<span class="op" id="4794008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4794011">m</span><span class="op" id="4794012">.</span><span class="ident" id="4794013">devices</span>&nbsp;<span class="op" id="4794021">=</span>&nbsp;<span class="builtinfunc" id="4794023">append</span><span class="op" id="4794029">(</span><span class="ident" id="4794030">m</span><span class="op" id="4794031">.</span><span class="ident" id="4794032">devices</span><span class="op" id="4794039">,</span>&nbsp;<span class="ident" id="4794041">d</span><span class="op" id="4794042">)</span><br>
<span class="lineno"></span><span class="op" id="4794044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="4794047">//&nbsp;Tick&nbsp;proceeds&nbsp;the&nbsp;simulation&nbsp;by&nbsp;one&nbsp;tick.</span><br>
<span class="lineno"></span><span class="keyword" id="4794092">func</span>&nbsp;<span class="op" id="4794097">(</span><span class="ident" id="4794098">m</span>&nbsp;<span class="op" id="4794100">*</span><span class="ident" id="4794101">Machine</span><span class="op" id="4794108">)</span>&nbsp;<span class="ident" id="4794110">Tick</span><span class="op" id="4794114">(</span><span class="op" id="4794115">)</span>&nbsp;<span class="op" id="4794117">*</span><span class="ident" id="4794118">CoreExcep</span>&nbsp;<span class="op" id="4794128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4794131">for</span>&nbsp;<span class="ident" id="4794135">_</span><span class="op" id="4794136">,</span>&nbsp;<span class="ident" id="4794138">d</span>&nbsp;<span class="op" id="4794140">:=</span>&nbsp;<span class="keyword" id="4794143">range</span>&nbsp;<span class="ident" id="4794149">m</span><span class="op" id="4794150">.</span><span class="ident" id="4794151">devices</span>&nbsp;<span class="op" id="4794159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4794163">d</span><span class="op" id="4794164">.</span><span class="ident" id="4794165">Tick</span><span class="op" id="4794169">(</span><span class="op" id="4794170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4794173">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4794177">return</span>&nbsp;<span class="ident" id="4794184">m</span><span class="op" id="4794185">.</span><span class="ident" id="4794186">cores</span><span class="op" id="4794191">.</span><span class="ident" id="4794192">Tick</span><span class="op" id="4794196">(</span><span class="op" id="4794197">)</span><br>
<span class="lineno"></span><span class="op" id="4794199">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4794202">//&nbsp;Run&nbsp;simulates&nbsp;nticks.&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;ticks</span><br>
<span class="lineno">60</span><span class="comment" id="4794258">//&nbsp;simulated&nbsp;without&nbsp;error,&nbsp;and&nbsp;the&nbsp;first&nbsp;met&nbsp;error&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span><span class="keyword" id="4794318">func</span>&nbsp;<span class="op" id="4794323">(</span><span class="ident" id="4794324">m</span>&nbsp;<span class="op" id="4794326">*</span><span class="ident" id="4794327">Machine</span><span class="op" id="4794334">)</span>&nbsp;<span class="ident" id="4794336">Run</span><span class="op" id="4794339">(</span><span class="ident" id="4794340">nticks</span>&nbsp;<span class="builtintype" id="4794347">int</span><span class="op" id="4794350">)</span>&nbsp;<span class="op" id="4794352">(</span><span class="builtintype" id="4794353">int</span><span class="op" id="4794356">,</span>&nbsp;<span class="op" id="4794358">*</span><span class="ident" id="4794359">CoreExcep</span><span class="op" id="4794368">)</span>&nbsp;<span class="op" id="4794370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4794373">n</span>&nbsp;<span class="op" id="4794375">:=</span>&nbsp;<span class="num" id="4794378">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4794381">for</span>&nbsp;<span class="ident" id="4794385">i</span>&nbsp;<span class="op" id="4794387">:=</span>&nbsp;<span class="num" id="4794390">0</span><span class="op" id="4794391">;</span>&nbsp;<span class="ident" id="4794393">nticks</span>&nbsp;<span class="op" id="4794400">==</span>&nbsp;<span class="num" id="4794403">0</span>&nbsp;<span class="op" id="4794405">||</span>&nbsp;<span class="ident" id="4794408">i</span>&nbsp;<span class="op" id="4794410">&lt;</span>&nbsp;<span class="ident" id="4794412">nticks</span><span class="op" id="4794418">;</span>&nbsp;<span class="ident" id="4794420">i</span><span class="op" id="4794421">++</span>&nbsp;<span class="op" id="4794424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4794428">e</span>&nbsp;<span class="op" id="4794430">:=</span>&nbsp;<span class="ident" id="4794433">m</span><span class="op" id="4794434">.</span><span class="ident" id="4794435">Tick</span><span class="op" id="4794439">(</span><span class="op" id="4794440">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4794444">n</span><span class="op" id="4794445">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4794450">if</span>&nbsp;<span class="ident" id="4794453">e</span>&nbsp;<span class="op" id="4794455">!=</span>&nbsp;<span class="ident" id="4794458">nil</span>&nbsp;<span class="op" id="4794462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4794467">return</span>&nbsp;<span class="ident" id="4794474">n</span><span class="op" id="4794475">,</span>&nbsp;<span class="ident" id="4794477">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4794481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4794484">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4794488">return</span>&nbsp;<span class="ident" id="4794495">n</span><span class="op" id="4794496">,</span>&nbsp;<span class="ident" id="4794498">nil</span><br>
<span class="lineno"></span><span class="op" id="4794502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4794505">//&nbsp;LoadImage&nbsp;loads&nbsp;an&nbsp;booting&nbsp;image&nbsp;from&nbsp;a&nbsp;reader&nbsp;and&nbsp;put&nbsp;it</span><br>
<span class="lineno">75</span><span class="comment" id="4794566">//&nbsp;at&nbsp;a&nbsp;particular&nbsp;offset&nbsp;in&nbsp;the&nbsp;physical&nbsp;memory.</span><br>
<span class="lineno"></span><span class="keyword" id="4794616">func</span>&nbsp;<span class="op" id="4794621">(</span><span class="ident" id="4794622">m</span>&nbsp;<span class="op" id="4794624">*</span><span class="ident" id="4794625">Machine</span><span class="op" id="4794632">)</span>&nbsp;<span class="ident" id="4794634">LoadImage</span><span class="op" id="4794643">(</span><span class="ident" id="4794644">r</span>&nbsp;<span class="ident" id="4794646">io</span><span class="op" id="4794648">.</span><span class="ident" id="4794649">Reader</span><span class="op" id="4794655">,</span>&nbsp;<span class="ident" id="4794657">offset</span>&nbsp;<span class="builtintype" id="4794664">uint32</span><span class="op" id="4794670">)</span>&nbsp;<span class="builtintype" id="4794672">error</span>&nbsp;<span class="op" id="4794678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4794681">if</span>&nbsp;<span class="ident" id="4794684">offset</span><span class="op" id="4794690">%</span><span class="ident" id="4794691">PageSize</span>&nbsp;<span class="op" id="4794700">!=</span>&nbsp;<span class="num" id="4794703">0</span>&nbsp;<span class="op" id="4794705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4794709">panic</span><span class="op" id="4794714">(</span><span class="string" id="4794715">&#34;boot&nbsp;image&nbsp;not&nbsp;page&nbsp;aligned&#34;</span><span class="op" id="4794744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4794747">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4794751">pn</span>&nbsp;<span class="op" id="4794754">:=</span>&nbsp;<span class="ident" id="4794757">offset</span>&nbsp;<span class="op" id="4794764">/</span>&nbsp;<span class="ident" id="4794766">PageSize</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4794777">for</span>&nbsp;<span class="op" id="4794781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4794785">p</span>&nbsp;<span class="op" id="4794787">:=</span>&nbsp;<span class="ident" id="4794790">m</span><span class="op" id="4794791">.</span><span class="ident" id="4794792">phyMem</span><span class="op" id="4794798">.</span><span class="ident" id="4794799">Page</span><span class="op" id="4794803">(</span><span class="ident" id="4794804">pn</span><span class="op" id="4794806">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4794810">if</span>&nbsp;<span class="ident" id="4794813">p</span>&nbsp;<span class="op" id="4794815">==</span>&nbsp;<span class="ident" id="4794818">nil</span>&nbsp;<span class="op" id="4794822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4794827">return</span>&nbsp;<span class="ident" id="4794834">errOutOfRange</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4794850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4794854">_</span><span class="op" id="4794855">,</span>&nbsp;<span class="ident" id="4794857">e</span>&nbsp;<span class="op" id="4794859">:=</span>&nbsp;<span class="ident" id="4794862">r</span><span class="op" id="4794863">.</span><span class="ident" id="4794864">Read</span><span class="op" id="4794868">(</span><span class="ident" id="4794869">p</span><span class="op" id="4794870">.</span><span class="ident" id="4794871">Bytes</span><span class="op" id="4794876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4794880">if</span>&nbsp;<span class="ident" id="4794883">e</span>&nbsp;<span class="op" id="4794885">==</span>&nbsp;<span class="ident" id="4794888">io</span><span class="op" id="4794890">.</span><span class="ident" id="4794891">EOF</span>&nbsp;<span class="op" id="4794895">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4794900">return</span>&nbsp;<span class="ident" id="4794907">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4794913">}</span>&nbsp;<span class="keyword" id="4794915">else</span>&nbsp;<span class="keyword" id="4794920">if</span>&nbsp;<span class="ident" id="4794923">e</span>&nbsp;<span class="op" id="4794925">!=</span>&nbsp;<span class="ident" id="4794928">nil</span>&nbsp;<span class="op" id="4794932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4794937">return</span>&nbsp;<span class="ident" id="4794944">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4794948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4794953">pn</span><span class="op" id="4794955">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4794959">}</span><br>
<span class="lineno"></span><span class="op" id="4794961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4794964">//&nbsp;PrintCoreStatus&nbsp;prints&nbsp;the&nbsp;cpu&nbsp;statuses.</span><br>
<span class="lineno">100</span><span class="keyword" id="4795008">func</span>&nbsp;<span class="op" id="4795013">(</span><span class="ident" id="4795014">m</span>&nbsp;<span class="op" id="4795016">*</span><span class="ident" id="4795017">Machine</span><span class="op" id="4795024">)</span>&nbsp;<span class="ident" id="4795026">PrintCoreStatus</span><span class="op" id="4795041">(</span><span class="op" id="4795042">)</span>&nbsp;<span class="op" id="4795044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4795047">m</span><span class="op" id="4795048">.</span><span class="ident" id="4795049">cores</span><span class="op" id="4795054">.</span><span class="ident" id="4795055">PrintStatus</span><span class="op" id="4795066">(</span><span class="op" id="4795067">)</span><br>
<span class="lineno"></span><span class="op" id="4795069">}</span>
</div>
</body>
</html>
