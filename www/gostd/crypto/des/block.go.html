<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/des</h2>
<ul>
<li><a href="/gostd/crypto/des/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/des/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/des/const.go.html">const.go</a></li>
<li><a href="/gostd/crypto/des/des_test.go.html">des_test.go</a></li>
<li><a href="/gostd/crypto/des/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3546892">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3546947">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3547001">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3547052">package</span>&nbsp;<span class="ident" id="3547060">des</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3547065">import</span>&nbsp;<span class="op" id="3547072">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3547075">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span><span class="op" id="3547093">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="3547096">func</span>&nbsp;<span class="ident" id="3547101">cryptBlock</span><span class="op" id="3547111">(</span><span class="ident" id="3547112">subkeys</span>&nbsp;<span class="op" id="3547120">[</span><span class="op" id="3547121">]</span><span class="ident" id="3547122">uint64</span><span class="op" id="3547128">,</span>&nbsp;<span class="ident" id="3547130">dst</span><span class="op" id="3547133">,</span>&nbsp;<span class="ident" id="3547135">src</span>&nbsp;<span class="op" id="3547139">[</span><span class="op" id="3547140">]</span><span class="builtintype" id="3547141">byte</span><span class="op" id="3547145">,</span>&nbsp;<span class="ident" id="3547147">decrypt</span>&nbsp;<span class="builtintype" id="3547155">bool</span><span class="op" id="3547159">)</span>&nbsp;<span class="op" id="3547161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3547164">b</span>&nbsp;<span class="op" id="3547166">:=</span>&nbsp;<span class="ident" id="3547169">binary</span><span class="op" id="3547175">.</span><span class="ident" id="3547176">BigEndian</span><span class="op" id="3547185">.</span><span class="ident" id="3547186">Uint64</span><span class="op" id="3547192">(</span><span class="ident" id="3547193">src</span><span class="op" id="3547196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3547199">b</span>&nbsp;<span class="op" id="3547201">=</span>&nbsp;<span class="ident" id="3547203">permuteInitialBlock</span><span class="op" id="3547222">(</span><span class="ident" id="3547223">b</span><span class="op" id="3547224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3547227">left</span><span class="op" id="3547231">,</span>&nbsp;<span class="ident" id="3547233">right</span>&nbsp;<span class="op" id="3547239">:=</span>&nbsp;<span class="builtintype" id="3547242">uint32</span><span class="op" id="3547248">(</span><span class="ident" id="3547249">b</span><span class="op" id="3547250">&gt;&gt;</span><span class="num" id="3547252">32</span><span class="op" id="3547254">)</span><span class="op" id="3547255">,</span>&nbsp;<span class="builtintype" id="3547257">uint32</span><span class="op" id="3547263">(</span><span class="ident" id="3547264">b</span><span class="op" id="3547265">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3547269">var</span>&nbsp;<span class="ident" id="3547273">subkey</span>&nbsp;<span class="ident" id="3547280">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3547288">for</span>&nbsp;<span class="ident" id="3547292">i</span>&nbsp;<span class="op" id="3547294">:=</span>&nbsp;<span class="num" id="3547297">0</span><span class="op" id="3547298">;</span>&nbsp;<span class="ident" id="3547300">i</span>&nbsp;<span class="op" id="3547302">&lt;</span>&nbsp;<span class="num" id="3547304">16</span><span class="op" id="3547306">;</span>&nbsp;<span class="ident" id="3547308">i</span><span class="op" id="3547309">++</span>&nbsp;<span class="op" id="3547312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3547316">if</span>&nbsp;<span class="ident" id="3547319">decrypt</span>&nbsp;<span class="op" id="3547327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3547332">subkey</span>&nbsp;<span class="op" id="3547339">=</span>&nbsp;<span class="ident" id="3547341">subkeys</span><span class="op" id="3547348">[</span><span class="num" id="3547349">15</span><span class="op" id="3547351">-</span><span class="ident" id="3547352">i</span><span class="op" id="3547353">]</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3547357">}</span>&nbsp;<span class="keyword" id="3547359">else</span>&nbsp;<span class="op" id="3547364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3547369">subkey</span>&nbsp;<span class="op" id="3547376">=</span>&nbsp;<span class="ident" id="3547378">subkeys</span><span class="op" id="3547385">[</span><span class="ident" id="3547386">i</span><span class="op" id="3547387">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3547391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3547396">left</span><span class="op" id="3547400">,</span>&nbsp;<span class="ident" id="3547402">right</span>&nbsp;<span class="op" id="3547408">=</span>&nbsp;<span class="ident" id="3547410">right</span><span class="op" id="3547415">,</span>&nbsp;<span class="ident" id="3547417">left</span><span class="op" id="3547421">^</span><span class="ident" id="3547422">feistel</span><span class="op" id="3547429">(</span><span class="ident" id="3547430">right</span><span class="op" id="3547435">,</span>&nbsp;<span class="ident" id="3547437">subkey</span><span class="op" id="3547443">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3547446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3547449">//&nbsp;switch&nbsp;left&nbsp;&amp;&nbsp;right&nbsp;and&nbsp;perform&nbsp;final&nbsp;permutation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3547503">preOutput</span>&nbsp;<span class="op" id="3547513">:=</span>&nbsp;<span class="op" id="3547516">(</span><span class="ident" id="3547517">uint64</span><span class="op" id="3547523">(</span><span class="ident" id="3547524">right</span><span class="op" id="3547529">)</span>&nbsp;<span class="op" id="3547531">&lt;&lt;</span>&nbsp;<span class="num" id="3547534">32</span><span class="op" id="3547536">)</span>&nbsp;<span class="op" id="3547538">|</span>&nbsp;<span class="ident" id="3547540">uint64</span><span class="op" id="3547546">(</span><span class="ident" id="3547547">left</span><span class="op" id="3547551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3547554">binary</span><span class="op" id="3547560">.</span><span class="ident" id="3547561">BigEndian</span><span class="op" id="3547570">.</span><span class="ident" id="3547571">PutUint64</span><span class="op" id="3547580">(</span><span class="ident" id="3547581">dst</span><span class="op" id="3547584">,</span>&nbsp;<span class="ident" id="3547586">permuteFinalBlock</span><span class="op" id="3547603">(</span><span class="ident" id="3547604">preOutput</span><span class="op" id="3547613">)</span><span class="op" id="3547614">)</span><br>
<span class="lineno"></span><span class="op" id="3547616">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="3547619">//&nbsp;Encrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;subkeys.</span><br>
<span class="lineno"></span><span class="keyword" id="3547678">func</span>&nbsp;<span class="ident" id="3547683">encryptBlock</span><span class="op" id="3547695">(</span><span class="ident" id="3547696">subkeys</span>&nbsp;<span class="op" id="3547704">[</span><span class="op" id="3547705">]</span><span class="ident" id="3547706">uint64</span><span class="op" id="3547712">,</span>&nbsp;<span class="ident" id="3547714">dst</span><span class="op" id="3547717">,</span>&nbsp;<span class="ident" id="3547719">src</span>&nbsp;<span class="op" id="3547723">[</span><span class="op" id="3547724">]</span><span class="builtintype" id="3547725">byte</span><span class="op" id="3547729">)</span>&nbsp;<span class="op" id="3547731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3547734">cryptBlock</span><span class="op" id="3547744">(</span><span class="ident" id="3547745">subkeys</span><span class="op" id="3547752">,</span>&nbsp;<span class="ident" id="3547754">dst</span><span class="op" id="3547757">,</span>&nbsp;<span class="ident" id="3547759">src</span><span class="op" id="3547762">,</span>&nbsp;<span class="builtintype" id="3547764">false</span><span class="op" id="3547769">)</span><br>
<span class="lineno"></span><span class="op" id="3547771">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="3547774">//&nbsp;Decrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;subkeys.</span><br>
<span class="lineno"></span><span class="keyword" id="3547833">func</span>&nbsp;<span class="ident" id="3547838">decryptBlock</span><span class="op" id="3547850">(</span><span class="ident" id="3547851">subkeys</span>&nbsp;<span class="op" id="3547859">[</span><span class="op" id="3547860">]</span><span class="ident" id="3547861">uint64</span><span class="op" id="3547867">,</span>&nbsp;<span class="ident" id="3547869">dst</span><span class="op" id="3547872">,</span>&nbsp;<span class="ident" id="3547874">src</span>&nbsp;<span class="op" id="3547878">[</span><span class="op" id="3547879">]</span><span class="builtintype" id="3547880">byte</span><span class="op" id="3547884">)</span>&nbsp;<span class="op" id="3547886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3547889">cryptBlock</span><span class="op" id="3547899">(</span><span class="ident" id="3547900">subkeys</span><span class="op" id="3547907">,</span>&nbsp;<span class="ident" id="3547909">dst</span><span class="op" id="3547912">,</span>&nbsp;<span class="ident" id="3547914">src</span><span class="op" id="3547917">,</span>&nbsp;<span class="builtintype" id="3547919">true</span><span class="op" id="3547923">)</span><br>
<span class="lineno"></span><span class="op" id="3547925">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="3547928">//&nbsp;DES&nbsp;Feistel&nbsp;function</span><br>
<span class="lineno"></span><span class="keyword" id="3547952">func</span>&nbsp;<span class="ident" id="3547957">feistel</span><span class="op" id="3547964">(</span><span class="ident" id="3547965">right</span>&nbsp;<span class="builtintype" id="3547971">uint32</span><span class="op" id="3547977">,</span>&nbsp;<span class="ident" id="3547979">key</span>&nbsp;<span class="ident" id="3547983">uint64</span><span class="op" id="3547989">)</span>&nbsp;<span class="op" id="3547991">(</span><span class="ident" id="3547992">result</span>&nbsp;<span class="builtintype" id="3547999">uint32</span><span class="op" id="3548005">)</span>&nbsp;<span class="op" id="3548007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3548010">sBoxLocations</span>&nbsp;<span class="op" id="3548024">:=</span>&nbsp;<span class="ident" id="3548027">key</span>&nbsp;<span class="op" id="3548031">^</span>&nbsp;<span class="ident" id="3548033">expandBlock</span><span class="op" id="3548044">(</span><span class="ident" id="3548045">right</span><span class="op" id="3548050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3548053">var</span>&nbsp;<span class="ident" id="3548057">sBoxResult</span>&nbsp;<span class="builtintype" id="3548068">uint32</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3548076">for</span>&nbsp;<span class="ident" id="3548080">i</span>&nbsp;<span class="op" id="3548082">:=</span>&nbsp;<span class="builtintype" id="3548085">uint8</span><span class="op" id="3548090">(</span><span class="num" id="3548091">0</span><span class="op" id="3548092">)</span><span class="op" id="3548093">;</span>&nbsp;<span class="ident" id="3548095">i</span>&nbsp;<span class="op" id="3548097">&lt;</span>&nbsp;<span class="num" id="3548099">8</span><span class="op" id="3548100">;</span>&nbsp;<span class="ident" id="3548102">i</span><span class="op" id="3548103">++</span>&nbsp;<span class="op" id="3548106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3548110">sBoxLocation</span>&nbsp;<span class="op" id="3548123">:=</span>&nbsp;<span class="builtintype" id="3548126">uint8</span><span class="op" id="3548131">(</span><span class="ident" id="3548132">sBoxLocations</span><span class="op" id="3548145">&gt;&gt;</span><span class="num" id="3548147">42</span><span class="op" id="3548149">)</span>&nbsp;<span class="op" id="3548151">&amp;</span>&nbsp;<span class="num" id="3548153">0x3f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3548160">sBoxLocations</span>&nbsp;<span class="op" id="3548174">&lt;&lt;=</span>&nbsp;<span class="num" id="3548178">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3548182">//&nbsp;row&nbsp;determined&nbsp;by&nbsp;1st&nbsp;and&nbsp;6th&nbsp;bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3548221">//&nbsp;column&nbsp;is&nbsp;middle&nbsp;four&nbsp;bits</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3548253">row</span>&nbsp;<span class="op" id="3548257">:=</span>&nbsp;<span class="op" id="3548260">(</span><span class="ident" id="3548261">sBoxLocation</span>&nbsp;<span class="op" id="3548274">&amp;</span>&nbsp;<span class="num" id="3548276">0x1</span><span class="op" id="3548279">)</span>&nbsp;<span class="op" id="3548281">|</span>&nbsp;<span class="op" id="3548283">(</span><span class="op" id="3548284">(</span><span class="ident" id="3548285">sBoxLocation</span>&nbsp;<span class="op" id="3548298">&amp;</span>&nbsp;<span class="num" id="3548300">0x20</span><span class="op" id="3548304">)</span>&nbsp;<span class="op" id="3548306">&gt;&gt;</span>&nbsp;<span class="num" id="3548309">4</span><span class="op" id="3548310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3548314">column</span>&nbsp;<span class="op" id="3548321">:=</span>&nbsp;<span class="op" id="3548324">(</span><span class="ident" id="3548325">sBoxLocation</span>&nbsp;<span class="op" id="3548338">&gt;&gt;</span>&nbsp;<span class="num" id="3548341">1</span><span class="op" id="3548342">)</span>&nbsp;<span class="op" id="3548344">&amp;</span>&nbsp;<span class="num" id="3548346">0xf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3548352">sBoxResult</span>&nbsp;<span class="op" id="3548363">^=</span>&nbsp;<span class="ident" id="3548366">feistelBox</span><span class="op" id="3548376">[</span><span class="ident" id="3548377">i</span><span class="op" id="3548378">]</span><span class="op" id="3548379">[</span><span class="num" id="3548380">16</span><span class="op" id="3548382">*</span><span class="ident" id="3548383">row</span><span class="op" id="3548386">+</span><span class="ident" id="3548387">column</span><span class="op" id="3548393">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3548396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3548399">return</span>&nbsp;<span class="ident" id="3548406">sBoxResult</span><br>
<span class="lineno">55</span><span class="op" id="3548417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3548420">//&nbsp;feistelBox[s][16*i+j]&nbsp;contains&nbsp;the&nbsp;output&nbsp;of&nbsp;permutationFunction</span><br>
<span class="lineno"></span><span class="comment" id="3548488">//&nbsp;for&nbsp;sBoxes[s][i][j]&nbsp;&lt;&lt;&nbsp;4*(7-s)</span><br>
<span class="lineno"></span><span class="keyword" id="3548522">var</span>&nbsp;<span class="ident" id="3548526">feistelBox</span>&nbsp;<span class="op" id="3548537">[</span><span class="num" id="3548538">8</span><span class="op" id="3548539">]</span><span class="op" id="3548540">[</span><span class="num" id="3548541">64</span><span class="op" id="3548543">]</span><span class="builtintype" id="3548544">uint32</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="3548552">//&nbsp;general&nbsp;purpose&nbsp;function&nbsp;to&nbsp;perform&nbsp;DES&nbsp;block&nbsp;permutations</span><br>
<span class="lineno"></span><span class="keyword" id="3548614">func</span>&nbsp;<span class="ident" id="3548619">permuteBlock</span><span class="op" id="3548631">(</span><span class="ident" id="3548632">src</span>&nbsp;<span class="ident" id="3548636">uint64</span><span class="op" id="3548642">,</span>&nbsp;<span class="ident" id="3548644">permutation</span>&nbsp;<span class="op" id="3548656">[</span><span class="op" id="3548657">]</span><span class="builtintype" id="3548658">uint8</span><span class="op" id="3548663">)</span>&nbsp;<span class="op" id="3548665">(</span><span class="ident" id="3548666">block</span>&nbsp;<span class="ident" id="3548672">uint64</span><span class="op" id="3548678">)</span>&nbsp;<span class="op" id="3548680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3548683">for</span>&nbsp;<span class="ident" id="3548687">position</span><span class="op" id="3548695">,</span>&nbsp;<span class="ident" id="3548697">n</span>&nbsp;<span class="op" id="3548699">:=</span>&nbsp;<span class="keyword" id="3548702">range</span>&nbsp;<span class="ident" id="3548708">permutation</span>&nbsp;<span class="op" id="3548720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3548724">bit</span>&nbsp;<span class="op" id="3548728">:=</span>&nbsp;<span class="op" id="3548731">(</span><span class="ident" id="3548732">src</span>&nbsp;<span class="op" id="3548736">&gt;&gt;</span>&nbsp;<span class="ident" id="3548739">n</span><span class="op" id="3548740">)</span>&nbsp;<span class="op" id="3548742">&amp;</span>&nbsp;<span class="num" id="3548744">1</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3548748">block</span>&nbsp;<span class="op" id="3548754">|=</span>&nbsp;<span class="ident" id="3548757">bit</span>&nbsp;<span class="op" id="3548761">&lt;&lt;</span>&nbsp;<span class="builtintype" id="3548764">uint</span><span class="op" id="3548768">(</span><span class="op" id="3548769">(</span><span class="builtinfunc" id="3548770">len</span><span class="op" id="3548773">(</span><span class="ident" id="3548774">permutation</span><span class="op" id="3548785">)</span><span class="op" id="3548786">-</span><span class="num" id="3548787">1</span><span class="op" id="3548788">)</span><span class="op" id="3548789">-</span><span class="ident" id="3548790">position</span><span class="op" id="3548798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3548801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3548804">return</span><br>
<span class="lineno"></span><span class="op" id="3548811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="3548814">func</span>&nbsp;<span class="ident" id="3548819">init</span><span class="op" id="3548823">(</span><span class="op" id="3548824">)</span>&nbsp;<span class="op" id="3548826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3548829">for</span>&nbsp;<span class="ident" id="3548833">s</span>&nbsp;<span class="op" id="3548835">:=</span>&nbsp;<span class="keyword" id="3548838">range</span>&nbsp;<span class="ident" id="3548844">sBoxes</span>&nbsp;<span class="op" id="3548851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3548855">for</span>&nbsp;<span class="ident" id="3548859">i</span>&nbsp;<span class="op" id="3548861">:=</span>&nbsp;<span class="num" id="3548864">0</span><span class="op" id="3548865">;</span>&nbsp;<span class="ident" id="3548867">i</span>&nbsp;<span class="op" id="3548869">&lt;</span>&nbsp;<span class="num" id="3548871">4</span><span class="op" id="3548872">;</span>&nbsp;<span class="ident" id="3548874">i</span><span class="op" id="3548875">++</span>&nbsp;<span class="op" id="3548878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3548883">for</span>&nbsp;<span class="ident" id="3548887">j</span>&nbsp;<span class="op" id="3548889">:=</span>&nbsp;<span class="num" id="3548892">0</span><span class="op" id="3548893">;</span>&nbsp;<span class="ident" id="3548895">j</span>&nbsp;<span class="op" id="3548897">&lt;</span>&nbsp;<span class="num" id="3548899">16</span><span class="op" id="3548901">;</span>&nbsp;<span class="ident" id="3548903">j</span><span class="op" id="3548904">++</span>&nbsp;<span class="op" id="3548907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3548913">f</span>&nbsp;<span class="op" id="3548915">:=</span>&nbsp;<span class="ident" id="3548918">uint64</span><span class="op" id="3548924">(</span><span class="ident" id="3548925">sBoxes</span><span class="op" id="3548931">[</span><span class="ident" id="3548932">s</span><span class="op" id="3548933">]</span><span class="op" id="3548934">[</span><span class="ident" id="3548935">i</span><span class="op" id="3548936">]</span><span class="op" id="3548937">[</span><span class="ident" id="3548938">j</span><span class="op" id="3548939">]</span><span class="op" id="3548940">)</span>&nbsp;<span class="op" id="3548942">&lt;&lt;</span>&nbsp;<span class="op" id="3548945">(</span><span class="num" id="3548946">4</span>&nbsp;<span class="op" id="3548948">*</span>&nbsp;<span class="op" id="3548950">(</span><span class="num" id="3548951">7</span>&nbsp;<span class="op" id="3548953">-</span>&nbsp;<span class="builtintype" id="3548955">uint</span><span class="op" id="3548959">(</span><span class="ident" id="3548960">s</span><span class="op" id="3548961">)</span><span class="op" id="3548962">)</span><span class="op" id="3548963">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3548969">f</span>&nbsp;<span class="op" id="3548971">=</span>&nbsp;<span class="ident" id="3548973">permuteBlock</span><span class="op" id="3548985">(</span><span class="ident" id="3548986">uint64</span><span class="op" id="3548992">(</span><span class="ident" id="3548993">f</span><span class="op" id="3548994">)</span><span class="op" id="3548995">,</span>&nbsp;<span class="ident" id="3548997">permutationFunction</span><span class="op" id="3549016">[</span><span class="op" id="3549017">:</span><span class="op" id="3549018">]</span><span class="op" id="3549019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3549025">feistelBox</span><span class="op" id="3549035">[</span><span class="ident" id="3549036">s</span><span class="op" id="3549037">]</span><span class="op" id="3549038">[</span><span class="num" id="3549039">16</span><span class="op" id="3549041">*</span><span class="ident" id="3549042">i</span><span class="op" id="3549043">+</span><span class="ident" id="3549044">j</span><span class="op" id="3549045">]</span>&nbsp;<span class="op" id="3549047">=</span>&nbsp;<span class="builtintype" id="3549049">uint32</span><span class="op" id="3549055">(</span><span class="ident" id="3549056">f</span><span class="op" id="3549057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3549062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3549066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3549069">}</span><br>
<span class="lineno">80</span><span class="op" id="3549071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3549074">//&nbsp;expandBlock&nbsp;expands&nbsp;an&nbsp;input&nbsp;block&nbsp;of&nbsp;32&nbsp;bits,</span><br>
<span class="lineno"></span><span class="comment" id="3549124">//&nbsp;producing&nbsp;an&nbsp;output&nbsp;block&nbsp;of&nbsp;48&nbsp;bits.</span><br>
<span class="lineno"></span><span class="keyword" id="3549165">func</span>&nbsp;<span class="ident" id="3549170">expandBlock</span><span class="op" id="3549181">(</span><span class="ident" id="3549182">src</span>&nbsp;<span class="builtintype" id="3549186">uint32</span><span class="op" id="3549192">)</span>&nbsp;<span class="op" id="3549194">(</span><span class="ident" id="3549195">block</span>&nbsp;<span class="ident" id="3549201">uint64</span><span class="op" id="3549207">)</span>&nbsp;<span class="op" id="3549209">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3549212">//&nbsp;rotate&nbsp;the&nbsp;5&nbsp;highest&nbsp;bits&nbsp;to&nbsp;the&nbsp;right.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3549256">src</span>&nbsp;<span class="op" id="3549260">=</span>&nbsp;<span class="op" id="3549262">(</span><span class="ident" id="3549263">src</span>&nbsp;<span class="op" id="3549267">&lt;&lt;</span>&nbsp;<span class="num" id="3549270">5</span><span class="op" id="3549271">)</span>&nbsp;<span class="op" id="3549273">|</span>&nbsp;<span class="op" id="3549275">(</span><span class="ident" id="3549276">src</span>&nbsp;<span class="op" id="3549280">&gt;&gt;</span>&nbsp;<span class="num" id="3549283">27</span><span class="op" id="3549285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3549288">for</span>&nbsp;<span class="ident" id="3549292">i</span>&nbsp;<span class="op" id="3549294">:=</span>&nbsp;<span class="num" id="3549297">0</span><span class="op" id="3549298">;</span>&nbsp;<span class="ident" id="3549300">i</span>&nbsp;<span class="op" id="3549302">&lt;</span>&nbsp;<span class="num" id="3549304">8</span><span class="op" id="3549305">;</span>&nbsp;<span class="ident" id="3549307">i</span><span class="op" id="3549308">++</span>&nbsp;<span class="op" id="3549311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3549315">block</span>&nbsp;<span class="op" id="3549321">&lt;&lt;=</span>&nbsp;<span class="num" id="3549325">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3549329">//&nbsp;take&nbsp;the&nbsp;6&nbsp;bits&nbsp;on&nbsp;the&nbsp;right</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3549363">block</span>&nbsp;<span class="op" id="3549369">|=</span>&nbsp;<span class="ident" id="3549372">uint64</span><span class="op" id="3549378">(</span><span class="ident" id="3549379">src</span><span class="op" id="3549382">)</span>&nbsp;<span class="op" id="3549384">&amp;</span>&nbsp;<span class="op" id="3549386">(</span><span class="num" id="3549387">1</span><span class="op" id="3549388">&lt;&lt;</span><span class="num" id="3549390">6</span>&nbsp;<span class="op" id="3549392">-</span>&nbsp;<span class="num" id="3549394">1</span><span class="op" id="3549395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3549399">//&nbsp;advance&nbsp;by&nbsp;4&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3549423">src</span>&nbsp;<span class="op" id="3549427">=</span>&nbsp;<span class="op" id="3549429">(</span><span class="ident" id="3549430">src</span>&nbsp;<span class="op" id="3549434">&lt;&lt;</span>&nbsp;<span class="num" id="3549437">4</span><span class="op" id="3549438">)</span>&nbsp;<span class="op" id="3549440">|</span>&nbsp;<span class="op" id="3549442">(</span><span class="ident" id="3549443">src</span>&nbsp;<span class="op" id="3549447">&gt;&gt;</span>&nbsp;<span class="num" id="3549450">28</span><span class="op" id="3549452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3549455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3549458">return</span><br>
<span class="lineno">95</span><span class="op" id="3549465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3549468">//&nbsp;permuteInitialBlock&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;the&nbsp;permutation&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="3549532">//&nbsp;by&nbsp;initialPermutation.</span><br>
<span class="lineno"></span><span class="keyword" id="3549558">func</span>&nbsp;<span class="ident" id="3549563">permuteInitialBlock</span><span class="op" id="3549582">(</span><span class="ident" id="3549583">block</span>&nbsp;<span class="ident" id="3549589">uint64</span><span class="op" id="3549595">)</span>&nbsp;<span class="ident" id="3549597">uint64</span>&nbsp;<span class="op" id="3549604">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3549607">//&nbsp;block&nbsp;=&nbsp;b7&nbsp;b6&nbsp;b5&nbsp;b4&nbsp;b3&nbsp;b2&nbsp;b1&nbsp;b0&nbsp;(8&nbsp;bytes)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3549653">b1</span>&nbsp;<span class="op" id="3549656">:=</span>&nbsp;<span class="ident" id="3549659">block</span>&nbsp;<span class="op" id="3549665">&gt;&gt;</span>&nbsp;<span class="num" id="3549668">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3549672">b2</span>&nbsp;<span class="op" id="3549675">:=</span>&nbsp;<span class="ident" id="3549678">block</span>&nbsp;<span class="op" id="3549684">&lt;&lt;</span>&nbsp;<span class="num" id="3549687">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3549691">block</span>&nbsp;<span class="op" id="3549697">^=</span>&nbsp;<span class="ident" id="3549700">b1</span>&nbsp;<span class="op" id="3549703">^</span>&nbsp;<span class="ident" id="3549705">b2</span>&nbsp;<span class="op" id="3549708">^</span>&nbsp;<span class="ident" id="3549710">b1</span><span class="op" id="3549712">&lt;&lt;</span><span class="num" id="3549714">48</span>&nbsp;<span class="op" id="3549717">^</span>&nbsp;<span class="ident" id="3549719">b2</span><span class="op" id="3549721">&gt;&gt;</span><span class="num" id="3549723">48</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3549728">//&nbsp;block&nbsp;=&nbsp;b1&nbsp;b0&nbsp;b5&nbsp;b4&nbsp;b3&nbsp;b2&nbsp;b7&nbsp;b6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3549764">b1</span>&nbsp;<span class="op" id="3549767">=</span>&nbsp;<span class="ident" id="3549769">block</span>&nbsp;<span class="op" id="3549775">&gt;&gt;</span>&nbsp;<span class="num" id="3549778">32</span>&nbsp;<span class="op" id="3549781">&amp;</span>&nbsp;<span class="num" id="3549783">0xff00ff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3549793">b2</span>&nbsp;<span class="op" id="3549796">=</span>&nbsp;<span class="op" id="3549798">(</span><span class="ident" id="3549799">block</span>&nbsp;<span class="op" id="3549805">&amp;</span>&nbsp;<span class="num" id="3549807">0xff00ff00</span><span class="op" id="3549817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3549820">block</span>&nbsp;<span class="op" id="3549826">^=</span>&nbsp;<span class="ident" id="3549829">b1</span><span class="op" id="3549831">&lt;&lt;</span><span class="num" id="3549833">32</span>&nbsp;<span class="op" id="3549836">^</span>&nbsp;<span class="ident" id="3549838">b2</span>&nbsp;<span class="op" id="3549841">^</span>&nbsp;<span class="ident" id="3549843">b1</span><span class="op" id="3549845">&lt;&lt;</span><span class="num" id="3549847">8</span>&nbsp;<span class="op" id="3549849">^</span>&nbsp;<span class="ident" id="3549851">b2</span><span class="op" id="3549853">&lt;&lt;</span><span class="num" id="3549855">24</span>&nbsp;<span class="comment" id="3549858">//&nbsp;exchange&nbsp;b0&nbsp;b4&nbsp;with&nbsp;b3&nbsp;b7</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3549889">//&nbsp;block&nbsp;is&nbsp;now&nbsp;b1&nbsp;b3&nbsp;b5&nbsp;b7&nbsp;b0&nbsp;b2&nbsp;b4&nbsp;b7,&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3549948">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3549976">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550004">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550032">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;56</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550060">//&nbsp;&nbsp;7&nbsp;&nbsp;6&nbsp;&nbsp;5&nbsp;&nbsp;4&nbsp;&nbsp;3&nbsp;&nbsp;2&nbsp;&nbsp;1&nbsp;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550088">//&nbsp;23&nbsp;22&nbsp;21&nbsp;20&nbsp;19&nbsp;18&nbsp;17&nbsp;16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550116">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550144">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;48</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550173">//&nbsp;exchange&nbsp;4,5,6,7&nbsp;with&nbsp;32,33,34,35&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3550216">b1</span>&nbsp;<span class="op" id="3550219">=</span>&nbsp;<span class="ident" id="3550221">block</span>&nbsp;<span class="op" id="3550227">&amp;</span>&nbsp;<span class="num" id="3550229">0x0f0f00000f0f0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3550249">b2</span>&nbsp;<span class="op" id="3550252">=</span>&nbsp;<span class="ident" id="3550254">block</span>&nbsp;<span class="op" id="3550260">&amp;</span>&nbsp;<span class="num" id="3550262">0x0000f0f00000f0f0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3550282">block</span>&nbsp;<span class="op" id="3550288">^=</span>&nbsp;<span class="ident" id="3550291">b1</span>&nbsp;<span class="op" id="3550294">^</span>&nbsp;<span class="ident" id="3550296">b2</span>&nbsp;<span class="op" id="3550299">^</span>&nbsp;<span class="ident" id="3550301">b1</span><span class="op" id="3550303">&gt;&gt;</span><span class="num" id="3550305">12</span>&nbsp;<span class="op" id="3550308">^</span>&nbsp;<span class="ident" id="3550310">b2</span><span class="op" id="3550312">&lt;&lt;</span><span class="num" id="3550314">12</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550319">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550349">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550353">//&nbsp;&nbsp;&nbsp;[+8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[+40]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550378">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550382">//&nbsp;&nbsp;7&nbsp;&nbsp;6&nbsp;&nbsp;5&nbsp;&nbsp;4</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550398">//&nbsp;23&nbsp;22&nbsp;21&nbsp;20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550414">//&nbsp;&nbsp;3&nbsp;&nbsp;2&nbsp;&nbsp;1&nbsp;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550430">//&nbsp;19&nbsp;18&nbsp;17&nbsp;16&nbsp;&nbsp;&nbsp;&nbsp;[+32]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550456">//&nbsp;exchange&nbsp;0,1,4,5&nbsp;with&nbsp;18,19,22,23</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3550494">b1</span>&nbsp;<span class="op" id="3550497">=</span>&nbsp;<span class="ident" id="3550499">block</span>&nbsp;<span class="op" id="3550505">&amp;</span>&nbsp;<span class="num" id="3550507">0x3300330033003300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3550527">b2</span>&nbsp;<span class="op" id="3550530">=</span>&nbsp;<span class="ident" id="3550532">block</span>&nbsp;<span class="op" id="3550538">&amp;</span>&nbsp;<span class="num" id="3550540">0x00cc00cc00cc00cc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3550560">block</span>&nbsp;<span class="op" id="3550566">^=</span>&nbsp;<span class="ident" id="3550569">b1</span>&nbsp;<span class="op" id="3550572">^</span>&nbsp;<span class="ident" id="3550574">b2</span>&nbsp;<span class="op" id="3550577">^</span>&nbsp;<span class="ident" id="3550579">b1</span><span class="op" id="3550581">&gt;&gt;</span><span class="num" id="3550583">6</span>&nbsp;<span class="op" id="3550585">^</span>&nbsp;<span class="ident" id="3550587">b2</span><span class="op" id="3550589">&lt;&lt;</span><span class="num" id="3550591">6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550595">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550625">//&nbsp;15&nbsp;14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550635">//&nbsp;13&nbsp;12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550645">//&nbsp;11&nbsp;10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550655">//&nbsp;&nbsp;9&nbsp;&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550665">//&nbsp;&nbsp;7&nbsp;&nbsp;6</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550675">//&nbsp;&nbsp;5&nbsp;&nbsp;4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550685">//&nbsp;&nbsp;3&nbsp;&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550695">//&nbsp;&nbsp;1&nbsp;&nbsp;0&nbsp;[+16]&nbsp;[+32]&nbsp;[+64]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550724">//&nbsp;exchange&nbsp;0,2,4,6&nbsp;with&nbsp;9,11,13,15:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3550762">b1</span>&nbsp;<span class="op" id="3550765">=</span>&nbsp;<span class="ident" id="3550767">block</span>&nbsp;<span class="op" id="3550773">&amp;</span>&nbsp;<span class="num" id="3550775">0xaaaaaaaa55555555</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3550795">block</span>&nbsp;<span class="op" id="3550801">^=</span>&nbsp;<span class="ident" id="3550804">b1</span>&nbsp;<span class="op" id="3550807">^</span>&nbsp;<span class="ident" id="3550809">b1</span><span class="op" id="3550811">&gt;&gt;</span><span class="num" id="3550813">33</span>&nbsp;<span class="op" id="3550816">^</span>&nbsp;<span class="ident" id="3550818">b1</span><span class="op" id="3550820">&lt;&lt;</span><span class="num" id="3550822">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550827">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550857">//&nbsp;6&nbsp;14&nbsp;22&nbsp;30&nbsp;38&nbsp;46&nbsp;54&nbsp;62</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550884">//&nbsp;4&nbsp;12&nbsp;20&nbsp;28&nbsp;36&nbsp;44&nbsp;52&nbsp;60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550911">//&nbsp;2&nbsp;10&nbsp;18&nbsp;26&nbsp;34&nbsp;42&nbsp;50&nbsp;58</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550938">//&nbsp;0&nbsp;&nbsp;8&nbsp;16&nbsp;24&nbsp;32&nbsp;40&nbsp;48&nbsp;56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550965">//&nbsp;7&nbsp;15&nbsp;23&nbsp;31&nbsp;39&nbsp;47&nbsp;55&nbsp;63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3550992">//&nbsp;5&nbsp;13&nbsp;21&nbsp;29&nbsp;37&nbsp;45&nbsp;53&nbsp;61</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3551019">//&nbsp;3&nbsp;11&nbsp;19&nbsp;27&nbsp;35&nbsp;43&nbsp;51&nbsp;59</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3551046">//&nbsp;1&nbsp;&nbsp;9&nbsp;17&nbsp;25&nbsp;33&nbsp;41&nbsp;49&nbsp;57</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3551073">return</span>&nbsp;<span class="ident" id="3551080">block</span><br>
<span class="lineno"></span><span class="op" id="3551086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="3551089">//&nbsp;permuteInitialBlock&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;the&nbsp;permutation&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="3551153">//&nbsp;by&nbsp;finalPermutation.</span><br>
<span class="lineno"></span><span class="keyword" id="3551177">func</span>&nbsp;<span class="ident" id="3551182">permuteFinalBlock</span><span class="op" id="3551199">(</span><span class="ident" id="3551200">block</span>&nbsp;<span class="ident" id="3551206">uint64</span><span class="op" id="3551212">)</span>&nbsp;<span class="ident" id="3551214">uint64</span>&nbsp;<span class="op" id="3551221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3551224">//&nbsp;Perform&nbsp;the&nbsp;same&nbsp;bit&nbsp;exchanges&nbsp;as&nbsp;permuteInitialBlock</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3551282">//&nbsp;but&nbsp;in&nbsp;reverse&nbsp;order.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3551308">b1</span>&nbsp;<span class="op" id="3551311">:=</span>&nbsp;<span class="ident" id="3551314">block</span>&nbsp;<span class="op" id="3551320">&amp;</span>&nbsp;<span class="num" id="3551322">0xaaaaaaaa55555555</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3551342">block</span>&nbsp;<span class="op" id="3551348">^=</span>&nbsp;<span class="ident" id="3551351">b1</span>&nbsp;<span class="op" id="3551354">^</span>&nbsp;<span class="ident" id="3551356">b1</span><span class="op" id="3551358">&gt;&gt;</span><span class="num" id="3551360">33</span>&nbsp;<span class="op" id="3551363">^</span>&nbsp;<span class="ident" id="3551365">b1</span><span class="op" id="3551367">&lt;&lt;</span><span class="num" id="3551369">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3551374">b1</span>&nbsp;<span class="op" id="3551377">=</span>&nbsp;<span class="ident" id="3551379">block</span>&nbsp;<span class="op" id="3551385">&amp;</span>&nbsp;<span class="num" id="3551387">0x3300330033003300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3551407">b2</span>&nbsp;<span class="op" id="3551410">:=</span>&nbsp;<span class="ident" id="3551413">block</span>&nbsp;<span class="op" id="3551419">&amp;</span>&nbsp;<span class="num" id="3551421">0x00cc00cc00cc00cc</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3551441">block</span>&nbsp;<span class="op" id="3551447">^=</span>&nbsp;<span class="ident" id="3551450">b1</span>&nbsp;<span class="op" id="3551453">^</span>&nbsp;<span class="ident" id="3551455">b2</span>&nbsp;<span class="op" id="3551458">^</span>&nbsp;<span class="ident" id="3551460">b1</span><span class="op" id="3551462">&gt;&gt;</span><span class="num" id="3551464">6</span>&nbsp;<span class="op" id="3551466">^</span>&nbsp;<span class="ident" id="3551468">b2</span><span class="op" id="3551470">&lt;&lt;</span><span class="num" id="3551472">6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3551476">b1</span>&nbsp;<span class="op" id="3551479">=</span>&nbsp;<span class="ident" id="3551481">block</span>&nbsp;<span class="op" id="3551487">&amp;</span>&nbsp;<span class="num" id="3551489">0x0f0f00000f0f0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3551509">b2</span>&nbsp;<span class="op" id="3551512">=</span>&nbsp;<span class="ident" id="3551514">block</span>&nbsp;<span class="op" id="3551520">&amp;</span>&nbsp;<span class="num" id="3551522">0x0000f0f00000f0f0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3551542">block</span>&nbsp;<span class="op" id="3551548">^=</span>&nbsp;<span class="ident" id="3551551">b1</span>&nbsp;<span class="op" id="3551554">^</span>&nbsp;<span class="ident" id="3551556">b2</span>&nbsp;<span class="op" id="3551559">^</span>&nbsp;<span class="ident" id="3551561">b1</span><span class="op" id="3551563">&gt;&gt;</span><span class="num" id="3551565">12</span>&nbsp;<span class="op" id="3551568">^</span>&nbsp;<span class="ident" id="3551570">b2</span><span class="op" id="3551572">&lt;&lt;</span><span class="num" id="3551574">12</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3551579">b1</span>&nbsp;<span class="op" id="3551582">=</span>&nbsp;<span class="ident" id="3551584">block</span>&nbsp;<span class="op" id="3551590">&gt;&gt;</span>&nbsp;<span class="num" id="3551593">32</span>&nbsp;<span class="op" id="3551596">&amp;</span>&nbsp;<span class="num" id="3551598">0xff00ff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3551608">b2</span>&nbsp;<span class="op" id="3551611">=</span>&nbsp;<span class="op" id="3551613">(</span><span class="ident" id="3551614">block</span>&nbsp;<span class="op" id="3551620">&amp;</span>&nbsp;<span class="num" id="3551622">0xff00ff00</span><span class="op" id="3551632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3551635">block</span>&nbsp;<span class="op" id="3551641">^=</span>&nbsp;<span class="ident" id="3551644">b1</span><span class="op" id="3551646">&lt;&lt;</span><span class="num" id="3551648">32</span>&nbsp;<span class="op" id="3551651">^</span>&nbsp;<span class="ident" id="3551653">b2</span>&nbsp;<span class="op" id="3551656">^</span>&nbsp;<span class="ident" id="3551658">b1</span><span class="op" id="3551660">&lt;&lt;</span><span class="num" id="3551662">8</span>&nbsp;<span class="op" id="3551664">^</span>&nbsp;<span class="ident" id="3551666">b2</span><span class="op" id="3551668">&lt;&lt;</span><span class="num" id="3551670">24</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3551675">b1</span>&nbsp;<span class="op" id="3551678">=</span>&nbsp;<span class="ident" id="3551680">block</span>&nbsp;<span class="op" id="3551686">&gt;&gt;</span>&nbsp;<span class="num" id="3551689">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3551693">b2</span>&nbsp;<span class="op" id="3551696">=</span>&nbsp;<span class="ident" id="3551698">block</span>&nbsp;<span class="op" id="3551704">&lt;&lt;</span>&nbsp;<span class="num" id="3551707">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3551711">block</span>&nbsp;<span class="op" id="3551717">^=</span>&nbsp;<span class="ident" id="3551720">b1</span>&nbsp;<span class="op" id="3551723">^</span>&nbsp;<span class="ident" id="3551725">b2</span>&nbsp;<span class="op" id="3551728">^</span>&nbsp;<span class="ident" id="3551730">b1</span><span class="op" id="3551732">&lt;&lt;</span><span class="num" id="3551734">48</span>&nbsp;<span class="op" id="3551737">^</span>&nbsp;<span class="ident" id="3551739">b2</span><span class="op" id="3551741">&gt;&gt;</span><span class="num" id="3551743">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3551747">return</span>&nbsp;<span class="ident" id="3551754">block</span><br>
<span class="lineno"></span><span class="op" id="3551760">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="3551763">//&nbsp;creates&nbsp;16&nbsp;28-bit&nbsp;blocks&nbsp;rotated&nbsp;according</span><br>
<span class="lineno"></span><span class="comment" id="3551809">//&nbsp;to&nbsp;the&nbsp;rotation&nbsp;schedule</span><br>
<span class="lineno"></span><span class="keyword" id="3551837">func</span>&nbsp;<span class="ident" id="3551842">ksRotate</span><span class="op" id="3551850">(</span><span class="ident" id="3551851">in</span>&nbsp;<span class="builtintype" id="3551854">uint32</span><span class="op" id="3551860">)</span>&nbsp;<span class="op" id="3551862">(</span><span class="ident" id="3551863">out</span>&nbsp;<span class="op" id="3551867">[</span><span class="op" id="3551868">]</span><span class="builtintype" id="3551869">uint32</span><span class="op" id="3551875">)</span>&nbsp;<span class="op" id="3551877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3551880">out</span>&nbsp;<span class="op" id="3551884">=</span>&nbsp;<span class="builtinfunc" id="3551886">make</span><span class="op" id="3551890">(</span><span class="op" id="3551891">[</span><span class="op" id="3551892">]</span><span class="builtintype" id="3551893">uint32</span><span class="op" id="3551899">,</span>&nbsp;<span class="num" id="3551901">16</span><span class="op" id="3551903">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3551906">last</span>&nbsp;<span class="op" id="3551911">:=</span>&nbsp;<span class="ident" id="3551914">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3551918">for</span>&nbsp;<span class="ident" id="3551922">i</span>&nbsp;<span class="op" id="3551924">:=</span>&nbsp;<span class="num" id="3551927">0</span><span class="op" id="3551928">;</span>&nbsp;<span class="ident" id="3551930">i</span>&nbsp;<span class="op" id="3551932">&lt;</span>&nbsp;<span class="num" id="3551934">16</span><span class="op" id="3551936">;</span>&nbsp;<span class="ident" id="3551938">i</span><span class="op" id="3551939">++</span>&nbsp;<span class="op" id="3551942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3551946">//&nbsp;28-bit&nbsp;circular&nbsp;left&nbsp;shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3551978">left</span>&nbsp;<span class="op" id="3551983">:=</span>&nbsp;<span class="op" id="3551986">(</span><span class="ident" id="3551987">last</span>&nbsp;<span class="op" id="3551992">&lt;&lt;</span>&nbsp;<span class="op" id="3551995">(</span><span class="num" id="3551996">4</span>&nbsp;<span class="op" id="3551998">+</span>&nbsp;<span class="ident" id="3552000">ksRotations</span><span class="op" id="3552011">[</span><span class="ident" id="3552012">i</span><span class="op" id="3552013">]</span><span class="op" id="3552014">)</span><span class="op" id="3552015">)</span>&nbsp;<span class="op" id="3552017">&gt;&gt;</span>&nbsp;<span class="num" id="3552020">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3552024">right</span>&nbsp;<span class="op" id="3552030">:=</span>&nbsp;<span class="op" id="3552033">(</span><span class="ident" id="3552034">last</span>&nbsp;<span class="op" id="3552039">&lt;&lt;</span>&nbsp;<span class="num" id="3552042">4</span><span class="op" id="3552043">)</span>&nbsp;<span class="op" id="3552045">&gt;&gt;</span>&nbsp;<span class="op" id="3552048">(</span><span class="num" id="3552049">32</span>&nbsp;<span class="op" id="3552052">-</span>&nbsp;<span class="ident" id="3552054">ksRotations</span><span class="op" id="3552065">[</span><span class="ident" id="3552066">i</span><span class="op" id="3552067">]</span><span class="op" id="3552068">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3552072">out</span><span class="op" id="3552075">[</span><span class="ident" id="3552076">i</span><span class="op" id="3552077">]</span>&nbsp;<span class="op" id="3552079">=</span>&nbsp;<span class="ident" id="3552081">left</span>&nbsp;<span class="op" id="3552086">|</span>&nbsp;<span class="ident" id="3552088">right</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3552096">last</span>&nbsp;<span class="op" id="3552101">=</span>&nbsp;<span class="ident" id="3552103">out</span><span class="op" id="3552106">[</span><span class="ident" id="3552107">i</span><span class="op" id="3552108">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3552111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3552114">return</span><br>
<span class="lineno"></span><span class="op" id="3552121">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="comment" id="3552124">//&nbsp;creates&nbsp;16&nbsp;56-bit&nbsp;subkeys&nbsp;from&nbsp;the&nbsp;original&nbsp;key</span><br>
<span class="lineno"></span><span class="keyword" id="3552175">func</span>&nbsp;<span class="op" id="3552180">(</span><span class="ident" id="3552181">c</span>&nbsp;<span class="op" id="3552183">*</span><span class="ident" id="3552184">desCipher</span><span class="op" id="3552193">)</span>&nbsp;<span class="ident" id="3552195">generateSubkeys</span><span class="op" id="3552210">(</span><span class="ident" id="3552211">keyBytes</span>&nbsp;<span class="op" id="3552220">[</span><span class="op" id="3552221">]</span><span class="builtintype" id="3552222">byte</span><span class="op" id="3552226">)</span>&nbsp;<span class="op" id="3552228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3552231">//&nbsp;apply&nbsp;PC1&nbsp;permutation&nbsp;to&nbsp;key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3552264">key</span>&nbsp;<span class="op" id="3552268">:=</span>&nbsp;<span class="ident" id="3552271">binary</span><span class="op" id="3552277">.</span><span class="ident" id="3552278">BigEndian</span><span class="op" id="3552287">.</span><span class="ident" id="3552288">Uint64</span><span class="op" id="3552294">(</span><span class="ident" id="3552295">keyBytes</span><span class="op" id="3552303">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3552306">permutedKey</span>&nbsp;<span class="op" id="3552318">:=</span>&nbsp;<span class="ident" id="3552321">permuteBlock</span><span class="op" id="3552333">(</span><span class="ident" id="3552334">key</span><span class="op" id="3552337">,</span>&nbsp;<span class="ident" id="3552339">permutedChoice1</span><span class="op" id="3552354">[</span><span class="op" id="3552355">:</span><span class="op" id="3552356">]</span><span class="op" id="3552357">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3552361">//&nbsp;rotate&nbsp;halves&nbsp;of&nbsp;permuted&nbsp;key&nbsp;according&nbsp;to&nbsp;the&nbsp;rotation&nbsp;schedule</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3552430">leftRotations</span>&nbsp;<span class="op" id="3552444">:=</span>&nbsp;<span class="ident" id="3552447">ksRotate</span><span class="op" id="3552455">(</span><span class="builtintype" id="3552456">uint32</span><span class="op" id="3552462">(</span><span class="ident" id="3552463">permutedKey</span>&nbsp;<span class="op" id="3552475">&gt;&gt;</span>&nbsp;<span class="num" id="3552478">28</span><span class="op" id="3552480">)</span><span class="op" id="3552481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3552484">rightRotations</span>&nbsp;<span class="op" id="3552499">:=</span>&nbsp;<span class="ident" id="3552502">ksRotate</span><span class="op" id="3552510">(</span><span class="builtintype" id="3552511">uint32</span><span class="op" id="3552517">(</span><span class="ident" id="3552518">permutedKey</span><span class="op" id="3552529">&lt;&lt;</span><span class="num" id="3552531">4</span><span class="op" id="3552532">)</span>&nbsp;<span class="op" id="3552534">&gt;&gt;</span>&nbsp;<span class="num" id="3552537">4</span><span class="op" id="3552538">)</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3552542">//&nbsp;generate&nbsp;subkeys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3552563">for</span>&nbsp;<span class="ident" id="3552567">i</span>&nbsp;<span class="op" id="3552569">:=</span>&nbsp;<span class="num" id="3552572">0</span><span class="op" id="3552573">;</span>&nbsp;<span class="ident" id="3552575">i</span>&nbsp;<span class="op" id="3552577">&lt;</span>&nbsp;<span class="num" id="3552579">16</span><span class="op" id="3552581">;</span>&nbsp;<span class="ident" id="3552583">i</span><span class="op" id="3552584">++</span>&nbsp;<span class="op" id="3552587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3552591">//&nbsp;combine&nbsp;halves&nbsp;to&nbsp;form&nbsp;56-bit&nbsp;input&nbsp;to&nbsp;PC2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3552639">pc2Input</span>&nbsp;<span class="op" id="3552648">:=</span>&nbsp;<span class="ident" id="3552651">uint64</span><span class="op" id="3552657">(</span><span class="ident" id="3552658">leftRotations</span><span class="op" id="3552671">[</span><span class="ident" id="3552672">i</span><span class="op" id="3552673">]</span><span class="op" id="3552674">)</span><span class="op" id="3552675">&lt;&lt;</span><span class="num" id="3552677">28</span>&nbsp;<span class="op" id="3552680">|</span>&nbsp;<span class="ident" id="3552682">uint64</span><span class="op" id="3552688">(</span><span class="ident" id="3552689">rightRotations</span><span class="op" id="3552703">[</span><span class="ident" id="3552704">i</span><span class="op" id="3552705">]</span><span class="op" id="3552706">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3552710">//&nbsp;apply&nbsp;PC2&nbsp;permutation&nbsp;to&nbsp;7&nbsp;byte&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3552753">c</span><span class="op" id="3552754">.</span><span class="ident" id="3552755">subkeys</span><span class="op" id="3552762">[</span><span class="ident" id="3552763">i</span><span class="op" id="3552764">]</span>&nbsp;<span class="op" id="3552766">=</span>&nbsp;<span class="ident" id="3552768">permuteBlock</span><span class="op" id="3552780">(</span><span class="ident" id="3552781">pc2Input</span><span class="op" id="3552789">,</span>&nbsp;<span class="ident" id="3552791">permutedChoice2</span><span class="op" id="3552806">[</span><span class="op" id="3552807">:</span><span class="op" id="3552808">]</span><span class="op" id="3552809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3552812">}</span><br>
<span class="lineno"></span><span class="op" id="3552814">}</span>
</div>
</body>
</html>
