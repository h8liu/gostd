<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6719377">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6719432">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6719486">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6719537">package</span>&nbsp;<span class="ident" id="6719545">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6719550">import</span>&nbsp;<span class="op" id="6719557">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6719560">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6719576">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="6719586">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6719589">type</span>&nbsp;<span class="ident" id="6719594">testSplitPreMasterSecretTest</span>&nbsp;<span class="keyword" id="6719623">struct</span>&nbsp;<span class="op" id="6719630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6719633">in</span><span class="op" id="6719635">,</span>&nbsp;<span class="ident" id="6719637">out1</span><span class="op" id="6719641">,</span>&nbsp;<span class="ident" id="6719643">out2</span>&nbsp;<span class="builtintype" id="6719648">string</span><br>
<span class="lineno"></span><span class="op" id="6719655">}</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="6719658">var</span>&nbsp;<span class="ident" id="6719662">testSplitPreMasterSecretTests</span>&nbsp;<span class="op" id="6719692">=</span>&nbsp;<span class="op" id="6719694">[</span><span class="op" id="6719695">]</span><span class="ident" id="6719696">testSplitPreMasterSecretTest</span><span class="op" id="6719724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6719727">{</span><span class="string" id="6719728">&#34;&#34;</span><span class="op" id="6719730">,</span>&nbsp;<span class="string" id="6719732">&#34;&#34;</span><span class="op" id="6719734">,</span>&nbsp;<span class="string" id="6719736">&#34;&#34;</span><span class="op" id="6719738">}</span><span class="op" id="6719739">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6719742">{</span><span class="string" id="6719743">&#34;00&#34;</span><span class="op" id="6719747">,</span>&nbsp;<span class="string" id="6719749">&#34;00&#34;</span><span class="op" id="6719753">,</span>&nbsp;<span class="string" id="6719755">&#34;00&#34;</span><span class="op" id="6719759">}</span><span class="op" id="6719760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6719763">{</span><span class="string" id="6719764">&#34;0011&#34;</span><span class="op" id="6719770">,</span>&nbsp;<span class="string" id="6719772">&#34;00&#34;</span><span class="op" id="6719776">,</span>&nbsp;<span class="string" id="6719778">&#34;11&#34;</span><span class="op" id="6719782">}</span><span class="op" id="6719783">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6719786">{</span><span class="string" id="6719787">&#34;001122&#34;</span><span class="op" id="6719795">,</span>&nbsp;<span class="string" id="6719797">&#34;0011&#34;</span><span class="op" id="6719803">,</span>&nbsp;<span class="string" id="6719805">&#34;1122&#34;</span><span class="op" id="6719811">}</span><span class="op" id="6719812">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6719815">{</span><span class="string" id="6719816">&#34;00112233&#34;</span><span class="op" id="6719826">,</span>&nbsp;<span class="string" id="6719828">&#34;0011&#34;</span><span class="op" id="6719834">,</span>&nbsp;<span class="string" id="6719836">&#34;2233&#34;</span><span class="op" id="6719842">}</span><span class="op" id="6719843">,</span><br>
<span class="lineno"></span><span class="op" id="6719845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6719848">func</span>&nbsp;<span class="ident" id="6719853">TestSplitPreMasterSecret</span><span class="op" id="6719877">(</span><span class="ident" id="6719878">t</span>&nbsp;<span class="op" id="6719880">*</span><span class="ident" id="6719881">testing</span><span class="op" id="6719888">.</span><span class="ident" id="6719889">T</span><span class="op" id="6719890">)</span>&nbsp;<span class="op" id="6719892">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6719895">for</span>&nbsp;<span class="ident" id="6719899">i</span><span class="op" id="6719900">,</span>&nbsp;<span class="ident" id="6719902">test</span>&nbsp;<span class="op" id="6719907">:=</span>&nbsp;<span class="keyword" id="6719910">range</span>&nbsp;<span class="ident" id="6719916">testSplitPreMasterSecretTests</span>&nbsp;<span class="op" id="6719946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6719950">in</span><span class="op" id="6719952">,</span>&nbsp;<span class="ident" id="6719954">_</span>&nbsp;<span class="op" id="6719956">:=</span>&nbsp;<span class="ident" id="6719959">hex</span><span class="op" id="6719962">.</span><span class="ident" id="6719963">DecodeString</span><span class="op" id="6719975">(</span><span class="ident" id="6719976">test</span><span class="op" id="6719980">.</span><span class="ident" id="6719981">in</span><span class="op" id="6719983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6719987">out1</span><span class="op" id="6719991">,</span>&nbsp;<span class="ident" id="6719993">out2</span>&nbsp;<span class="op" id="6719998">:=</span>&nbsp;<span class="ident" id="6720001">splitPreMasterSecret</span><span class="op" id="6720021">(</span><span class="ident" id="6720022">in</span><span class="op" id="6720024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6720028">s1</span>&nbsp;<span class="op" id="6720031">:=</span>&nbsp;<span class="ident" id="6720034">hex</span><span class="op" id="6720037">.</span><span class="ident" id="6720038">EncodeToString</span><span class="op" id="6720052">(</span><span class="ident" id="6720053">out1</span><span class="op" id="6720057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6720061">s2</span>&nbsp;<span class="op" id="6720064">:=</span>&nbsp;<span class="ident" id="6720067">hex</span><span class="op" id="6720070">.</span><span class="ident" id="6720071">EncodeToString</span><span class="op" id="6720085">(</span><span class="ident" id="6720086">out2</span><span class="op" id="6720090">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6720094">if</span>&nbsp;<span class="ident" id="6720097">s1</span>&nbsp;<span class="op" id="6720100">!=</span>&nbsp;<span class="ident" id="6720103">test</span><span class="op" id="6720107">.</span><span class="ident" id="6720108">out1</span>&nbsp;<span class="op" id="6720113">||</span>&nbsp;<span class="ident" id="6720116">s2</span>&nbsp;<span class="op" id="6720119">!=</span>&nbsp;<span class="ident" id="6720122">test</span><span class="op" id="6720126">.</span><span class="ident" id="6720127">out2</span>&nbsp;<span class="op" id="6720132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6720137">t</span><span class="op" id="6720138">.</span><span class="ident" id="6720139">Errorf</span><span class="op" id="6720145">(</span><span class="string" id="6720146">&#34;#%d:&nbsp;got:&nbsp;(%s,&nbsp;%s)&nbsp;want:&nbsp;(%s,&nbsp;%s)&#34;</span><span class="op" id="6720181">,</span>&nbsp;<span class="ident" id="6720183">i</span><span class="op" id="6720184">,</span>&nbsp;<span class="ident" id="6720186">s1</span><span class="op" id="6720188">,</span>&nbsp;<span class="ident" id="6720190">s2</span><span class="op" id="6720192">,</span>&nbsp;<span class="ident" id="6720194">test</span><span class="op" id="6720198">.</span><span class="ident" id="6720199">out1</span><span class="op" id="6720203">,</span>&nbsp;<span class="ident" id="6720205">test</span><span class="op" id="6720209">.</span><span class="ident" id="6720210">out2</span><span class="op" id="6720214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6720218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6720221">}</span><br>
<span class="lineno"></span><span class="op" id="6720223">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="6720226">type</span>&nbsp;<span class="ident" id="6720231">testKeysFromTest</span>&nbsp;<span class="keyword" id="6720248">struct</span>&nbsp;<span class="op" id="6720255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6720258">version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6720285">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6720293">preMasterSecret</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6720320">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6720328">clientRandom</span><span class="op" id="6720340">,</span>&nbsp;<span class="ident" id="6720342">serverRandom</span>&nbsp;<span class="builtintype" id="6720355">string</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6720363">masterSecret</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6720390">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6720398">clientMAC</span><span class="op" id="6720407">,</span>&nbsp;<span class="ident" id="6720409">serverMAC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6720425">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6720433">clientKey</span><span class="op" id="6720442">,</span>&nbsp;<span class="ident" id="6720444">serverKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6720460">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6720468">macLen</span><span class="op" id="6720474">,</span>&nbsp;<span class="ident" id="6720476">keyLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6720495">int</span><br>
<span class="lineno"></span><span class="op" id="6720499">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="6720502">func</span>&nbsp;<span class="ident" id="6720507">TestKeysFromPreMasterSecret</span><span class="op" id="6720534">(</span><span class="ident" id="6720535">t</span>&nbsp;<span class="op" id="6720537">*</span><span class="ident" id="6720538">testing</span><span class="op" id="6720545">.</span><span class="ident" id="6720546">T</span><span class="op" id="6720547">)</span>&nbsp;<span class="op" id="6720549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6720552">for</span>&nbsp;<span class="ident" id="6720556">i</span><span class="op" id="6720557">,</span>&nbsp;<span class="ident" id="6720559">test</span>&nbsp;<span class="op" id="6720564">:=</span>&nbsp;<span class="keyword" id="6720567">range</span>&nbsp;<span class="ident" id="6720573">testKeysFromTests</span>&nbsp;<span class="op" id="6720591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6720595">in</span><span class="op" id="6720597">,</span>&nbsp;<span class="ident" id="6720599">_</span>&nbsp;<span class="op" id="6720601">:=</span>&nbsp;<span class="ident" id="6720604">hex</span><span class="op" id="6720607">.</span><span class="ident" id="6720608">DecodeString</span><span class="op" id="6720620">(</span><span class="ident" id="6720621">test</span><span class="op" id="6720625">.</span><span class="ident" id="6720626">preMasterSecret</span><span class="op" id="6720641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6720645">clientRandom</span><span class="op" id="6720657">,</span>&nbsp;<span class="ident" id="6720659">_</span>&nbsp;<span class="op" id="6720661">:=</span>&nbsp;<span class="ident" id="6720664">hex</span><span class="op" id="6720667">.</span><span class="ident" id="6720668">DecodeString</span><span class="op" id="6720680">(</span><span class="ident" id="6720681">test</span><span class="op" id="6720685">.</span><span class="ident" id="6720686">clientRandom</span><span class="op" id="6720698">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6720702">serverRandom</span><span class="op" id="6720714">,</span>&nbsp;<span class="ident" id="6720716">_</span>&nbsp;<span class="op" id="6720718">:=</span>&nbsp;<span class="ident" id="6720721">hex</span><span class="op" id="6720724">.</span><span class="ident" id="6720725">DecodeString</span><span class="op" id="6720737">(</span><span class="ident" id="6720738">test</span><span class="op" id="6720742">.</span><span class="ident" id="6720743">serverRandom</span><span class="op" id="6720755">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6720760">masterSecret</span>&nbsp;<span class="op" id="6720773">:=</span>&nbsp;<span class="ident" id="6720776">masterFromPreMasterSecret</span><span class="op" id="6720801">(</span><span class="ident" id="6720802">test</span><span class="op" id="6720806">.</span><span class="ident" id="6720807">version</span><span class="op" id="6720814">,</span>&nbsp;<span class="ident" id="6720816">in</span><span class="op" id="6720818">,</span>&nbsp;<span class="ident" id="6720820">clientRandom</span><span class="op" id="6720832">,</span>&nbsp;<span class="ident" id="6720834">serverRandom</span><span class="op" id="6720846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6720850">if</span>&nbsp;<span class="ident" id="6720853">s</span>&nbsp;<span class="op" id="6720855">:=</span>&nbsp;<span class="ident" id="6720858">hex</span><span class="op" id="6720861">.</span><span class="ident" id="6720862">EncodeToString</span><span class="op" id="6720876">(</span><span class="ident" id="6720877">masterSecret</span><span class="op" id="6720889">)</span><span class="op" id="6720890">;</span>&nbsp;<span class="ident" id="6720892">s</span>&nbsp;<span class="op" id="6720894">!=</span>&nbsp;<span class="ident" id="6720897">test</span><span class="op" id="6720901">.</span><span class="ident" id="6720902">masterSecret</span>&nbsp;<span class="op" id="6720915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6720920">t</span><span class="op" id="6720921">.</span><span class="ident" id="6720922">Errorf</span><span class="op" id="6720928">(</span><span class="string" id="6720929">&#34;#%d:&nbsp;bad&nbsp;master&nbsp;secret&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="6720965">,</span>&nbsp;<span class="ident" id="6720967">i</span><span class="op" id="6720968">,</span>&nbsp;<span class="ident" id="6720970">s</span><span class="op" id="6720971">,</span>&nbsp;<span class="ident" id="6720973">test</span><span class="op" id="6720977">.</span><span class="ident" id="6720978">masterSecret</span><span class="op" id="6720990">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6720995">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6721006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6721011">clientMAC</span><span class="op" id="6721020">,</span>&nbsp;<span class="ident" id="6721022">serverMAC</span><span class="op" id="6721031">,</span>&nbsp;<span class="ident" id="6721033">clientKey</span><span class="op" id="6721042">,</span>&nbsp;<span class="ident" id="6721044">serverKey</span><span class="op" id="6721053">,</span>&nbsp;<span class="ident" id="6721055">_</span><span class="op" id="6721056">,</span>&nbsp;<span class="ident" id="6721058">_</span>&nbsp;<span class="op" id="6721060">:=</span>&nbsp;<span class="ident" id="6721063">keysFromMasterSecret</span><span class="op" id="6721083">(</span><span class="ident" id="6721084">test</span><span class="op" id="6721088">.</span><span class="ident" id="6721089">version</span><span class="op" id="6721096">,</span>&nbsp;<span class="ident" id="6721098">masterSecret</span><span class="op" id="6721110">,</span>&nbsp;<span class="ident" id="6721112">clientRandom</span><span class="op" id="6721124">,</span>&nbsp;<span class="ident" id="6721126">serverRandom</span><span class="op" id="6721138">,</span>&nbsp;<span class="ident" id="6721140">test</span><span class="op" id="6721144">.</span><span class="ident" id="6721145">macLen</span><span class="op" id="6721151">,</span>&nbsp;<span class="ident" id="6721153">test</span><span class="op" id="6721157">.</span><span class="ident" id="6721158">keyLen</span><span class="op" id="6721164">,</span>&nbsp;<span class="num" id="6721166">0</span><span class="op" id="6721167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6721171">clientMACString</span>&nbsp;<span class="op" id="6721187">:=</span>&nbsp;<span class="ident" id="6721190">hex</span><span class="op" id="6721193">.</span><span class="ident" id="6721194">EncodeToString</span><span class="op" id="6721208">(</span><span class="ident" id="6721209">clientMAC</span><span class="op" id="6721218">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6721222">serverMACString</span>&nbsp;<span class="op" id="6721238">:=</span>&nbsp;<span class="ident" id="6721241">hex</span><span class="op" id="6721244">.</span><span class="ident" id="6721245">EncodeToString</span><span class="op" id="6721259">(</span><span class="ident" id="6721260">serverMAC</span><span class="op" id="6721269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6721273">clientKeyString</span>&nbsp;<span class="op" id="6721289">:=</span>&nbsp;<span class="ident" id="6721292">hex</span><span class="op" id="6721295">.</span><span class="ident" id="6721296">EncodeToString</span><span class="op" id="6721310">(</span><span class="ident" id="6721311">clientKey</span><span class="op" id="6721320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6721324">serverKeyString</span>&nbsp;<span class="op" id="6721340">:=</span>&nbsp;<span class="ident" id="6721343">hex</span><span class="op" id="6721346">.</span><span class="ident" id="6721347">EncodeToString</span><span class="op" id="6721361">(</span><span class="ident" id="6721362">serverKey</span><span class="op" id="6721371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6721375">if</span>&nbsp;<span class="ident" id="6721378">clientMACString</span>&nbsp;<span class="op" id="6721394">!=</span>&nbsp;<span class="ident" id="6721397">test</span><span class="op" id="6721401">.</span><span class="ident" id="6721402">clientMAC</span>&nbsp;<span class="op" id="6721412">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6721418">serverMACString</span>&nbsp;<span class="op" id="6721434">!=</span>&nbsp;<span class="ident" id="6721437">test</span><span class="op" id="6721441">.</span><span class="ident" id="6721442">serverMAC</span>&nbsp;<span class="op" id="6721452">||</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6721458">clientKeyString</span>&nbsp;<span class="op" id="6721474">!=</span>&nbsp;<span class="ident" id="6721477">test</span><span class="op" id="6721481">.</span><span class="ident" id="6721482">clientKey</span>&nbsp;<span class="op" id="6721492">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6721498">serverKeyString</span>&nbsp;<span class="op" id="6721514">!=</span>&nbsp;<span class="ident" id="6721517">test</span><span class="op" id="6721521">.</span><span class="ident" id="6721522">serverKey</span>&nbsp;<span class="op" id="6721532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6721537">t</span><span class="op" id="6721538">.</span><span class="ident" id="6721539">Errorf</span><span class="op" id="6721545">(</span><span class="string" id="6721546">&#34;#%d:&nbsp;got:&nbsp;(%s,&nbsp;%s,&nbsp;%s,&nbsp;%s)&nbsp;want:&nbsp;(%s,&nbsp;%s,&nbsp;%s,&nbsp;%s)&#34;</span><span class="op" id="6721597">,</span>&nbsp;<span class="ident" id="6721599">i</span><span class="op" id="6721600">,</span>&nbsp;<span class="ident" id="6721602">clientMACString</span><span class="op" id="6721617">,</span>&nbsp;<span class="ident" id="6721619">serverMACString</span><span class="op" id="6721634">,</span>&nbsp;<span class="ident" id="6721636">clientKeyString</span><span class="op" id="6721651">,</span>&nbsp;<span class="ident" id="6721653">serverKeyString</span><span class="op" id="6721668">,</span>&nbsp;<span class="ident" id="6721670">test</span><span class="op" id="6721674">.</span><span class="ident" id="6721675">clientMAC</span><span class="op" id="6721684">,</span>&nbsp;<span class="ident" id="6721686">test</span><span class="op" id="6721690">.</span><span class="ident" id="6721691">serverMAC</span><span class="op" id="6721700">,</span>&nbsp;<span class="ident" id="6721702">test</span><span class="op" id="6721706">.</span><span class="ident" id="6721707">clientKey</span><span class="op" id="6721716">,</span>&nbsp;<span class="ident" id="6721718">test</span><span class="op" id="6721722">.</span><span class="ident" id="6721723">serverKey</span><span class="op" id="6721732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6721736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6721739">}</span><br>
<span class="lineno">70</span><span class="op" id="6721741">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6721744">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;from&nbsp;GnuTLS&nbsp;using&nbsp;`gnutls-cli&nbsp;--insecure&nbsp;-d&nbsp;9&nbsp;`</span><br>
<span class="lineno"></span><span class="keyword" id="6721829">var</span>&nbsp;<span class="ident" id="6721833">testKeysFromTests</span>&nbsp;<span class="op" id="6721851">=</span>&nbsp;<span class="op" id="6721853">[</span><span class="op" id="6721854">]</span><span class="ident" id="6721855">testKeysFromTest</span><span class="op" id="6721871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6721874">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6721878">VersionTLS10</span><span class="op" id="6721890">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6721894">&#34;0302cac83ad4b1db3b9ab49ad05957de2a504a634a386fc600889321e1a971f57479466830ac3e6f468e87f5385fa0c5&#34;</span><span class="op" id="6721992">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6721996">&#34;4ae66303755184a3917fcb44880605fcc53baa01912b22ed94473fc69cebd558&#34;</span><span class="op" id="6722062">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6722066">&#34;4ae663020ec16e6bb5130be918cfcafd4d765979a3136a5d50c593446e4e44db&#34;</span><span class="op" id="6722132">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6722136">&#34;3d851bab6e5556e959a16bc36d66cfae32f672bfa9ecdef6096cbb1b23472df1da63dbbd9827606413221d149ed08ceb&#34;</span><span class="op" id="6722234">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6722238">&#34;805aaa19b3d2c0a0759a4b6c9959890e08480119&#34;</span><span class="op" id="6722280">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6722284">&#34;2d22f9fe519c075c16448305ceee209fc24ad109&#34;</span><span class="op" id="6722326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6722330">&#34;d50b5771244f850cd8117a9ccafe2cf1&#34;</span><span class="op" id="6722364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6722368">&#34;e076e33206b30507a85c32855acd0919&#34;</span><span class="op" id="6722402">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6722406">20</span><span class="op" id="6722408">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6722412">16</span><span class="op" id="6722414">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6722417">}</span><span class="op" id="6722418">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6722421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6722425">VersionTLS10</span><span class="op" id="6722437">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6722441">&#34;03023f7527316bc12cbcd69e4b9e8275d62c028f27e65c745cfcddc7ce01bd3570a111378b63848127f1c36e5f9e4890&#34;</span><span class="op" id="6722539">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6722543">&#34;4ae66364b5ea56b20ce4e25555aed2d7e67f42788dd03f3fee4adae0459ab106&#34;</span><span class="op" id="6722609">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6722613">&#34;4ae66363ab815cbf6a248b87d6b556184e945e9b97fbdf247858b0bdafacfa1c&#34;</span><span class="op" id="6722679">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6722683">&#34;7d64be7c80c59b740200b4b9c26d0baaa1c5ae56705acbcf2307fe62beb4728c19392c83f20483801cce022c77645460&#34;</span><span class="op" id="6722781">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6722785">&#34;97742ed60a0554ca13f04f97ee193177b971e3b0&#34;</span><span class="op" id="6722827">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6722831">&#34;37068751700400e03a8477a5c7eec0813ab9e0dc&#34;</span><span class="op" id="6722873">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6722877">&#34;207cddbc600d2a200abac6502053ee5c&#34;</span><span class="op" id="6722911">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6722915">&#34;df3f94f6e1eacc753b815fe16055cd43&#34;</span><span class="op" id="6722949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6722953">20</span><span class="op" id="6722955">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6722959">16</span><span class="op" id="6722961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6722964">}</span><span class="op" id="6722965">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6722968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6722972">VersionTLS10</span><span class="op" id="6722984">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6722988">&#34;832d515f1d61eebb2be56ba0ef79879efb9b527504abb386fb4310ed5d0e3b1f220d3bb6b455033a2773e6d8bdf951d278a187482b400d45deb88a5d5a6bb7d6a7a1decc04eb9ef0642876cd4a82d374d3b6ff35f0351dc5d411104de431375355addc39bfb1f6329fb163b0bc298d658338930d07d313cd980a7e3d9196cac1&#34;</span><span class="op" id="6723246">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6723250">&#34;4ae663b2ee389c0de147c509d8f18f5052afc4aaf9699efe8cb05ece883d3a5e&#34;</span><span class="op" id="6723316">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6723320">&#34;4ae664d503fd4cff50cfc1fb8fc606580f87b0fcdac9554ba0e01d785bdf278e&#34;</span><span class="op" id="6723386">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6723390">&#34;1aff2e7a2c4279d0126f57a65a77a8d9d0087cf2733366699bec27eb53d5740705a8574bb1acc2abbe90e44f0dd28d6c&#34;</span><span class="op" id="6723488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6723492">&#34;3c7647c93c1379a31a609542aa44e7f117a70085&#34;</span><span class="op" id="6723534">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6723538">&#34;0d73102994be74a575a3ead8532590ca32a526d4&#34;</span><span class="op" id="6723580">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6723584">&#34;ac7581b0b6c10d85bbd905ffbf36c65e&#34;</span><span class="op" id="6723618">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6723622">&#34;ff07edde49682b45466bd2e39464b306&#34;</span><span class="op" id="6723656">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6723660">20</span><span class="op" id="6723662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6723666">16</span><span class="op" id="6723668">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6723671">}</span><span class="op" id="6723672">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6723675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6723679">VersionSSL30</span><span class="op" id="6723691">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6723695">&#34;832d515f1d61eebb2be56ba0ef79879efb9b527504abb386fb4310ed5d0e3b1f220d3bb6b455033a2773e6d8bdf951d278a187482b400d45deb88a5d5a6bb7d6a7a1decc04eb9ef0642876cd4a82d374d3b6ff35f0351dc5d411104de431375355addc39bfb1f6329fb163b0bc298d658338930d07d313cd980a7e3d9196cac1&#34;</span><span class="op" id="6723953">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6723957">&#34;4ae663b2ee389c0de147c509d8f18f5052afc4aaf9699efe8cb05ece883d3a5e&#34;</span><span class="op" id="6724023">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6724027">&#34;4ae664d503fd4cff50cfc1fb8fc606580f87b0fcdac9554ba0e01d785bdf278e&#34;</span><span class="op" id="6724093">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6724097">&#34;a614863e56299dcffeea2938f22c2ba023768dbe4b3f6877bc9c346c6ae529b51d9cb87ff9695ea4d01f2205584405b2&#34;</span><span class="op" id="6724195">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6724199">&#34;2c450d5b6f6e2013ac6bea6a0b32200d4e1ffb94&#34;</span><span class="op" id="6724241">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6724245">&#34;7a7a7438769536f2fb1ae49a61f0703b79b2dc53&#34;</span><span class="op" id="6724287">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6724291">&#34;f8f6b26c10f12855c9aafb1e0e839ccf&#34;</span><span class="op" id="6724325">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6724329">&#34;2b9d4b4a60cb7f396780ebff50650419&#34;</span><span class="op" id="6724363">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6724367">20</span><span class="op" id="6724369">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6724373">16</span><span class="op" id="6724375">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6724378">}</span><span class="op" id="6724379">,</span><br>
<span class="lineno"></span><span class="op" id="6724381">}</span>
</div>
</body>
</html>
