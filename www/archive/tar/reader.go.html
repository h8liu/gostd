<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6193438">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6193493">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6193547">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6193598">package</span>&nbsp;<span class="ident" id="6193606">tar</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6193611">//&nbsp;TODO(dsymonds):</span><br>
<span class="lineno"></span><span class="comment" id="6193630">//&nbsp;&nbsp;&nbsp;-&nbsp;pax&nbsp;extensions</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="6193653">import</span>&nbsp;<span class="op" id="6193660">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6193663">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6193672">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6193682">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6193688">&#34;io/ioutil&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6193701">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6193707">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6193718">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6193729">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6193736">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="6193739">var</span>&nbsp;<span class="op" id="6193743">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6193746">ErrHeader</span>&nbsp;<span class="op" id="6193756">=</span>&nbsp;<span class="ident" id="6193758"><a href="/archive/tar/reader.go.html#6193672">errors</a></span><span class="op" id="6193764">.</span><span class="ident" id="6193765">New</span><span class="op" id="6193768">(</span><span class="string" id="6193769">&#34;archive/tar:&nbsp;invalid&nbsp;tar&nbsp;header&#34;</span><span class="op" id="6193802">)</span><br>
<span class="lineno"></span><span class="op" id="6193804">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="6193807">const</span>&nbsp;<span class="ident" id="6193813">maxNanoSecondIntSize</span>&nbsp;<span class="op" id="6193834">=</span>&nbsp;<span class="num" id="6193836">9</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6193839">//&nbsp;A&nbsp;Reader&nbsp;provides&nbsp;sequential&nbsp;access&nbsp;to&nbsp;the&nbsp;contents&nbsp;of&nbsp;a&nbsp;tar&nbsp;archive.</span><br>
<span class="lineno"></span><span class="comment" id="6193912">//&nbsp;A&nbsp;tar&nbsp;archive&nbsp;consists&nbsp;of&nbsp;a&nbsp;sequence&nbsp;of&nbsp;files.</span><br>
<span class="lineno"></span><span class="comment" id="6193962">//&nbsp;The&nbsp;Next&nbsp;method&nbsp;advances&nbsp;to&nbsp;the&nbsp;next&nbsp;file&nbsp;in&nbsp;the&nbsp;archive&nbsp;(including&nbsp;the&nbsp;first),</span><br>
<span class="lineno">30</span><span class="comment" id="6194045">//&nbsp;and&nbsp;then&nbsp;it&nbsp;can&nbsp;be&nbsp;treated&nbsp;as&nbsp;an&nbsp;io.Reader&nbsp;to&nbsp;access&nbsp;the&nbsp;file&#39;s&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="6194118">type</span>&nbsp;<span class="ident" id="6194123">Reader</span>&nbsp;<span class="keyword" id="6194130">struct</span>&nbsp;<span class="op" id="6194137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6194140">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6194148"><a href="/archive/tar/reader.go.html#6193682">io</a></span><span class="op" id="6194150">.</span><span class="ident" id="6194151">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6194159">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6194167">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6194174">pad</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6194182">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6194198">//&nbsp;amount&nbsp;of&nbsp;padding&nbsp;(ignored)&nbsp;after&nbsp;current&nbsp;file&nbsp;entry</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6194255">curr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6194263"><a href="/archive/tar/reader.go.html#6194511">numBytesReader</a></span>&nbsp;&nbsp;<span class="comment" id="6194279">//&nbsp;reader&nbsp;for&nbsp;current&nbsp;file&nbsp;entry</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6194313">hdrBuff</span>&nbsp;<span class="op" id="6194321">[</span><span class="ident" id="6194322"><a href="/archive/tar/common.go.html#6186250">blockSize</a></span><span class="op" id="6194331">]</span><span class="builtintype" id="6194332">byte</span>&nbsp;<span class="comment" id="6194337">//&nbsp;buffer&nbsp;to&nbsp;use&nbsp;in&nbsp;readHeader</span><br>
<span class="lineno"></span><span class="op" id="6194368">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6194371">//&nbsp;A&nbsp;numBytesReader&nbsp;is&nbsp;an&nbsp;io.Reader&nbsp;with&nbsp;a&nbsp;numBytes&nbsp;method,&nbsp;returning&nbsp;the&nbsp;number</span><br>
<span class="lineno">40</span><span class="comment" id="6194452">//&nbsp;of&nbsp;bytes&nbsp;remaining&nbsp;in&nbsp;the&nbsp;underlying&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="6194506">type</span>&nbsp;<span class="ident" id="6194511">numBytesReader</span>&nbsp;<span class="keyword" id="6194526">interface</span>&nbsp;<span class="op" id="6194536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6194539"><a href="/archive/tar/reader.go.html#6193682">io</a></span><span class="op" id="6194541">.</span><span class="ident" id="6194542">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6194550">numBytes</span><span class="op" id="6194558">(</span><span class="op" id="6194559">)</span>&nbsp;<span class="ident" id="6194561">int64</span><br>
<span class="lineno"></span><span class="op" id="6194567">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="6194570">//&nbsp;A&nbsp;regFileReader&nbsp;is&nbsp;a&nbsp;numBytesReader&nbsp;for&nbsp;reading&nbsp;file&nbsp;data&nbsp;from&nbsp;a&nbsp;tar&nbsp;archive.</span><br>
<span class="lineno"></span><span class="keyword" id="6194651">type</span>&nbsp;<span class="ident" id="6194656">regFileReader</span>&nbsp;<span class="keyword" id="6194670">struct</span>&nbsp;<span class="op" id="6194677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6194680">r</span>&nbsp;&nbsp;<span class="ident" id="6194683"><a href="/archive/tar/reader.go.html#6193682">io</a></span><span class="op" id="6194685">.</span><span class="ident" id="6194686">Reader</span>&nbsp;<span class="comment" id="6194693">//&nbsp;underlying&nbsp;reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6194715">nb</span>&nbsp;<span class="ident" id="6194718">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6194728">//&nbsp;number&nbsp;of&nbsp;unread&nbsp;bytes&nbsp;for&nbsp;current&nbsp;file&nbsp;entry</span><br>
<span class="lineno">50</span><span class="op" id="6194777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6194780">//&nbsp;A&nbsp;sparseFileReader&nbsp;is&nbsp;a&nbsp;numBytesReader&nbsp;for&nbsp;reading&nbsp;sparse&nbsp;file&nbsp;data&nbsp;from&nbsp;a&nbsp;tar&nbsp;archive.</span><br>
<span class="lineno"></span><span class="keyword" id="6194871">type</span>&nbsp;<span class="ident" id="6194876">sparseFileReader</span>&nbsp;<span class="keyword" id="6194893">struct</span>&nbsp;<span class="op" id="6194900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6194903">rfr</span>&nbsp;<span class="op" id="6194907">*</span><span class="ident" id="6194908"><a href="/archive/tar/reader.go.html#6194656">regFileReader</a></span>&nbsp;<span class="comment" id="6194922">//&nbsp;reads&nbsp;the&nbsp;sparse-encoded&nbsp;file&nbsp;data</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6194961">sp</span>&nbsp;&nbsp;<span class="op" id="6194965">[</span><span class="op" id="6194966">]</span><span class="ident" id="6194967"><a href="/archive/tar/reader.go.html#6208128">sparseEntry</a></span>&nbsp;&nbsp;<span class="comment" id="6194980">//&nbsp;the&nbsp;sparse&nbsp;map&nbsp;for&nbsp;the&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195012">pos</span>&nbsp;<span class="ident" id="6195016">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6195031">//&nbsp;keeps&nbsp;track&nbsp;of&nbsp;file&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195064">tot</span>&nbsp;<span class="ident" id="6195068">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6195083">//&nbsp;total&nbsp;size&nbsp;of&nbsp;the&nbsp;file</span><br>
<span class="lineno"></span><span class="op" id="6195109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="6195112">//&nbsp;Keywords&nbsp;for&nbsp;GNU&nbsp;sparse&nbsp;files&nbsp;in&nbsp;a&nbsp;PAX&nbsp;extended&nbsp;header</span><br>
<span class="lineno"></span><span class="keyword" id="6195170">const</span>&nbsp;<span class="op" id="6195176">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195179">paxGNUSparseNumBlocks</span>&nbsp;<span class="op" id="6195201">=</span>&nbsp;<span class="string" id="6195203">&#34;GNU.sparse.numblocks&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195227">paxGNUSparseOffset</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6195249">=</span>&nbsp;<span class="string" id="6195251">&#34;GNU.sparse.offset&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195272">paxGNUSparseNumBytes</span>&nbsp;&nbsp;<span class="op" id="6195294">=</span>&nbsp;<span class="string" id="6195296">&#34;GNU.sparse.numbytes&#34;</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195319">paxGNUSparseMap</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6195341">=</span>&nbsp;<span class="string" id="6195343">&#34;GNU.sparse.map&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195361">paxGNUSparseName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6195383">=</span>&nbsp;<span class="string" id="6195385">&#34;GNU.sparse.name&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195404">paxGNUSparseMajor</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6195426">=</span>&nbsp;<span class="string" id="6195428">&#34;GNU.sparse.major&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195448">paxGNUSparseMinor</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6195470">=</span>&nbsp;<span class="string" id="6195472">&#34;GNU.sparse.minor&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195492">paxGNUSparseSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6195514">=</span>&nbsp;<span class="string" id="6195516">&#34;GNU.sparse.size&#34;</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195535">paxGNUSparseRealSize</span>&nbsp;&nbsp;<span class="op" id="6195557">=</span>&nbsp;<span class="string" id="6195559">&#34;GNU.sparse.realsize&#34;</span><br>
<span class="lineno"></span><span class="op" id="6195581">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6195584">//&nbsp;Keywords&nbsp;for&nbsp;old&nbsp;GNU&nbsp;sparse&nbsp;headers</span><br>
<span class="lineno"></span><span class="keyword" id="6195623">const</span>&nbsp;<span class="op" id="6195629">(</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195632">oldGNUSparseMainHeaderOffset</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6195675">=</span>&nbsp;<span class="num" id="6195677">386</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195682">oldGNUSparseMainHeaderIsExtendedOffset</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6195725">=</span>&nbsp;<span class="num" id="6195727">482</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195732">oldGNUSparseMainHeaderNumEntries</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6195775">=</span>&nbsp;<span class="num" id="6195777">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195780">oldGNUSparseExtendedHeaderIsExtendedOffset</span>&nbsp;<span class="op" id="6195823">=</span>&nbsp;<span class="num" id="6195825">504</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195830">oldGNUSparseExtendedHeaderNumEntries</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6195873">=</span>&nbsp;<span class="num" id="6195875">21</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195879">oldGNUSparseOffsetSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6195922">=</span>&nbsp;<span class="num" id="6195924">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6195928">oldGNUSparseNumBytesSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6195971">=</span>&nbsp;<span class="num" id="6195973">12</span><br>
<span class="lineno"></span><span class="op" id="6195976">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6195979">//&nbsp;NewReader&nbsp;creates&nbsp;a&nbsp;new&nbsp;Reader&nbsp;reading&nbsp;from&nbsp;r.</span><br>
<span class="lineno">85</span><span class="keyword" id="6196029">func</span>&nbsp;<span class="ident" id="6196034">NewReader</span><span class="op" id="6196043">(</span><span class="ident" id="6196044">r</span>&nbsp;<span class="ident" id="6196046"><a href="/archive/tar/reader.go.html#6193682">io</a></span><span class="op" id="6196048">.</span><span class="ident" id="6196049">Reader</span><span class="op" id="6196055">)</span>&nbsp;<span class="op" id="6196057">*</span><span class="ident" id="6196058"><a href="/archive/tar/reader.go.html#6194123">Reader</a></span>&nbsp;<span class="op" id="6196065">{</span>&nbsp;<span class="keyword" id="6196067">return</span>&nbsp;<span class="op" id="6196074">&amp;</span><span class="ident" id="6196075"><a href="/archive/tar/reader.go.html#6194123">Reader</a></span><span class="op" id="6196081">{</span><span class="ident" id="6196082">r</span><span class="op" id="6196083">:</span>&nbsp;<span class="ident" id="6196085"><a href="/archive/tar/reader.go.html#6196044">r</a></span><span class="op" id="6196086">}</span>&nbsp;<span class="op" id="6196088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6196091">//&nbsp;Next&nbsp;advances&nbsp;to&nbsp;the&nbsp;next&nbsp;entry&nbsp;in&nbsp;the&nbsp;tar&nbsp;archive.</span><br>
<span class="lineno"></span><span class="keyword" id="6196146">func</span>&nbsp;<span class="op" id="6196151">(</span><span class="ident" id="6196152">tr</span>&nbsp;<span class="op" id="6196155">*</span><span class="ident" id="6196156"><a href="/archive/tar/reader.go.html#6194123">Reader</a></span><span class="op" id="6196162">)</span>&nbsp;<span class="ident" id="6196164">Next</span><span class="op" id="6196168">(</span><span class="op" id="6196169">)</span>&nbsp;<span class="op" id="6196171">(</span><span class="op" id="6196172">*</span><span class="ident" id="6196173"><a href="/archive/tar/common.go.html#6187053">Header</a></span><span class="op" id="6196179">,</span>&nbsp;<span class="builtintype" id="6196181">error</span><span class="op" id="6196186">)</span>&nbsp;<span class="op" id="6196188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196191">var</span>&nbsp;<span class="ident" id="6196195">hdr</span>&nbsp;<span class="op" id="6196199">*</span><span class="ident" id="6196200"><a href="/archive/tar/common.go.html#6187053">Header</a></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196208">if</span>&nbsp;<span class="ident" id="6196211"><a href="/archive/tar/reader.go.html#6196152">tr</a></span><span class="op" id="6196213">.</span><span class="ident" id="6196214">err</span>&nbsp;<span class="op" id="6196218">==</span>&nbsp;<span class="ident" id="6196221">nil</span>&nbsp;<span class="op" id="6196225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196229"><a href="/archive/tar/reader.go.html#6196152">tr</a></span><span class="op" id="6196231">.</span><span class="ident" id="6196232">skipUnread</span><span class="op" id="6196242">(</span><span class="op" id="6196243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6196246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196249">if</span>&nbsp;<span class="ident" id="6196252"><a href="/archive/tar/reader.go.html#6196152">tr</a></span><span class="op" id="6196254">.</span><span class="ident" id="6196255">err</span>&nbsp;<span class="op" id="6196259">!=</span>&nbsp;<span class="ident" id="6196262">nil</span>&nbsp;<span class="op" id="6196266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196270">return</span>&nbsp;<span class="ident" id="6196277"><a href="/archive/tar/reader.go.html#6196195">hdr</a></span><span class="op" id="6196280">,</span>&nbsp;<span class="ident" id="6196282"><a href="/archive/tar/reader.go.html#6196152">tr</a></span><span class="op" id="6196284">.</span><span class="ident" id="6196285">err</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6196290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196293"><a href="/archive/tar/reader.go.html#6196195">hdr</a></span>&nbsp;<span class="op" id="6196297">=</span>&nbsp;<span class="ident" id="6196299"><a href="/archive/tar/reader.go.html#6196152">tr</a></span><span class="op" id="6196301">.</span><span class="ident" id="6196302">readHeader</span><span class="op" id="6196312">(</span><span class="op" id="6196313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196316">if</span>&nbsp;<span class="ident" id="6196319"><a href="/archive/tar/reader.go.html#6196195">hdr</a></span>&nbsp;<span class="op" id="6196323">==</span>&nbsp;<span class="ident" id="6196326">nil</span>&nbsp;<span class="op" id="6196330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196334">return</span>&nbsp;<span class="ident" id="6196341"><a href="/archive/tar/reader.go.html#6196195">hdr</a></span><span class="op" id="6196344">,</span>&nbsp;<span class="ident" id="6196346"><a href="/archive/tar/reader.go.html#6196152">tr</a></span><span class="op" id="6196348">.</span><span class="ident" id="6196349">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6196354">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6196357">//&nbsp;Check&nbsp;for&nbsp;PAX/GNU&nbsp;header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196387">switch</span>&nbsp;<span class="ident" id="6196394"><a href="/archive/tar/reader.go.html#6196195">hdr</a></span><span class="op" id="6196397">.</span><span class="ident" id="6196398">Typeflag</span>&nbsp;<span class="op" id="6196407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196410">case</span>&nbsp;<span class="ident" id="6196415"><a href="/archive/tar/common.go.html#6186676">TypeXHeader</a></span><span class="op" id="6196426">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6196430">//&nbsp;&nbsp;PAX&nbsp;extended&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196456">headers</span><span class="op" id="6196463">,</span>&nbsp;<span class="ident" id="6196465">err</span>&nbsp;<span class="op" id="6196469">:=</span>&nbsp;<span class="ident" id="6196472"><a href="/archive/tar/reader.go.html#6201949">parsePAX</a></span><span class="op" id="6196480">(</span><span class="ident" id="6196481"><a href="/archive/tar/reader.go.html#6196152">tr</a></span><span class="op" id="6196483">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196487">if</span>&nbsp;<span class="ident" id="6196490"><a href="/archive/tar/reader.go.html#6196465">err</a></span>&nbsp;<span class="op" id="6196494">!=</span>&nbsp;<span class="ident" id="6196497">nil</span>&nbsp;<span class="op" id="6196501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196506">return</span>&nbsp;<span class="ident" id="6196513">nil</span><span class="op" id="6196516">,</span>&nbsp;<span class="ident" id="6196518"><a href="/archive/tar/reader.go.html#6196465">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6196524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6196528">//&nbsp;We&nbsp;actually&nbsp;read&nbsp;the&nbsp;whole&nbsp;file,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6196566">//&nbsp;but&nbsp;this&nbsp;skips&nbsp;alignment&nbsp;padding</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196604"><a href="/archive/tar/reader.go.html#6196152">tr</a></span><span class="op" id="6196606">.</span><span class="ident" id="6196607">skipUnread</span><span class="op" id="6196617">(</span><span class="op" id="6196618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196622"><a href="/archive/tar/reader.go.html#6196195">hdr</a></span>&nbsp;<span class="op" id="6196626">=</span>&nbsp;<span class="ident" id="6196628"><a href="/archive/tar/reader.go.html#6196152">tr</a></span><span class="op" id="6196630">.</span><span class="ident" id="6196631">readHeader</span><span class="op" id="6196641">(</span><span class="op" id="6196642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196646"><a href="/archive/tar/reader.go.html#6199697">mergePAX</a></span><span class="op" id="6196654">(</span><span class="ident" id="6196655"><a href="/archive/tar/reader.go.html#6196195">hdr</a></span><span class="op" id="6196658">,</span>&nbsp;<span class="ident" id="6196660"><a href="/archive/tar/reader.go.html#6196456">headers</a></span><span class="op" id="6196667">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6196672">//&nbsp;Check&nbsp;for&nbsp;a&nbsp;PAX&nbsp;format&nbsp;sparse&nbsp;file</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196712">sp</span><span class="op" id="6196714">,</span>&nbsp;<span class="ident" id="6196716"><a href="/archive/tar/reader.go.html#6196465">err</a></span>&nbsp;<span class="op" id="6196720">:=</span>&nbsp;<span class="ident" id="6196723"><a href="/archive/tar/reader.go.html#6196152">tr</a></span><span class="op" id="6196725">.</span><span class="ident" id="6196726">checkForGNUSparsePAXHeaders</span><span class="op" id="6196753">(</span><span class="ident" id="6196754"><a href="/archive/tar/reader.go.html#6196195">hdr</a></span><span class="op" id="6196757">,</span>&nbsp;<span class="ident" id="6196759"><a href="/archive/tar/reader.go.html#6196456">headers</a></span><span class="op" id="6196766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196770">if</span>&nbsp;<span class="ident" id="6196773"><a href="/archive/tar/reader.go.html#6196465">err</a></span>&nbsp;<span class="op" id="6196777">!=</span>&nbsp;<span class="ident" id="6196780">nil</span>&nbsp;<span class="op" id="6196784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196789"><a href="/archive/tar/reader.go.html#6196152">tr</a></span><span class="op" id="6196791">.</span><span class="ident" id="6196792">err</span>&nbsp;<span class="op" id="6196796">=</span>&nbsp;<span class="ident" id="6196798"><a href="/archive/tar/reader.go.html#6196465">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196805">return</span>&nbsp;<span class="ident" id="6196812">nil</span><span class="op" id="6196815">,</span>&nbsp;<span class="ident" id="6196817"><a href="/archive/tar/reader.go.html#6196465">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6196823">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6196827">if</span>&nbsp;<span class="ident" id="6196830"><a href="/archive/tar/reader.go.html#6196712">sp</a></span>&nbsp;<span class="op" id="6196833">!=</span>&nbsp;<span class="ident" id="6196836">nil</span>&nbsp;<span class="op" id="6196840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6196845">//&nbsp;Current&nbsp;file&nbsp;is&nbsp;a&nbsp;PAX&nbsp;format&nbsp;GNU&nbsp;sparse&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6196897">//&nbsp;Set&nbsp;the&nbsp;current&nbsp;file&nbsp;reader&nbsp;to&nbsp;a&nbsp;sparse&nbsp;file&nbsp;reader.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6196956"><a href="/archive/tar/reader.go.html#6196152">tr</a></span><span class="op" id="6196958">.</span><span class="ident" id="6196959">curr</span>&nbsp;<span class="op" id="6196964">=</span>&nbsp;<span class="op" id="6196966">&amp;</span><span class="ident" id="6196967"><a href="/archive/tar/reader.go.html#6194876">sparseFileReader</a></span><span class="op" id="6196983">{</span><span class="ident" id="6196984">rfr</span><span class="op" id="6196987">:</span>&nbsp;<span class="ident" id="6196989"><a href="/archive/tar/reader.go.html#6196152">tr</a></span><span class="op" id="6196991">.</span><span class="ident" id="6196992">curr</span><span class="op" id="6196996">.</span><span class="op" id="6196997">(</span><span class="op" id="6196998">*</span><span class="ident" id="6196999"><a href="/archive/tar/reader.go.html#6194656">regFileReader</a></span><span class="op" id="6197012">)</span><span class="op" id="6197013">,</span>&nbsp;<span class="ident" id="6197015">sp</span><span class="op" id="6197017">:</span>&nbsp;<span class="ident" id="6197019"><a href="/archive/tar/reader.go.html#6196712">sp</a></span><span class="op" id="6197021">,</span>&nbsp;<span class="ident" id="6197023">tot</span><span class="op" id="6197026">:</span>&nbsp;<span class="ident" id="6197028"><a href="/archive/tar/reader.go.html#6196195">hdr</a></span><span class="op" id="6197031">.</span><span class="ident" id="6197032">Size</span><span class="op" id="6197036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6197040">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197044">return</span>&nbsp;<span class="ident" id="6197051"><a href="/archive/tar/reader.go.html#6196195">hdr</a></span><span class="op" id="6197054">,</span>&nbsp;<span class="ident" id="6197056">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197061">case</span>&nbsp;<span class="ident" id="6197066"><a href="/archive/tar/common.go.html#6186777">TypeGNULongName</a></span><span class="op" id="6197081">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6197085">//&nbsp;We&nbsp;have&nbsp;a&nbsp;GNU&nbsp;long&nbsp;name&nbsp;header.&nbsp;Its&nbsp;contents&nbsp;are&nbsp;the&nbsp;real&nbsp;file&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197159">realname</span><span class="op" id="6197167">,</span>&nbsp;<span class="ident" id="6197169">err</span>&nbsp;<span class="op" id="6197173">:=</span>&nbsp;<span class="ident" id="6197176"><a href="/archive/tar/reader.go.html#6193688">ioutil</a></span><span class="op" id="6197182">.</span><span class="ident" id="6197183">ReadAll</span><span class="op" id="6197190">(</span><span class="ident" id="6197191"><a href="/archive/tar/reader.go.html#6196152">tr</a></span><span class="op" id="6197193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197197">if</span>&nbsp;<span class="ident" id="6197200"><a href="/archive/tar/reader.go.html#6197169">err</a></span>&nbsp;<span class="op" id="6197204">!=</span>&nbsp;<span class="ident" id="6197207">nil</span>&nbsp;<span class="op" id="6197211">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197216">return</span>&nbsp;<span class="ident" id="6197223">nil</span><span class="op" id="6197226">,</span>&nbsp;<span class="ident" id="6197228"><a href="/archive/tar/reader.go.html#6197169">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6197234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197238">hdr</span><span class="op" id="6197241">,</span>&nbsp;<span class="ident" id="6197243"><a href="/archive/tar/reader.go.html#6197169">err</a></span>&nbsp;<span class="op" id="6197247">:=</span>&nbsp;<span class="ident" id="6197250"><a href="/archive/tar/reader.go.html#6196152">tr</a></span><span class="op" id="6197252">.</span><span class="ident" id="6197253">Next</span><span class="op" id="6197257">(</span><span class="op" id="6197258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197262"><a href="/archive/tar/reader.go.html#6197238">hdr</a></span><span class="op" id="6197265">.</span><span class="ident" id="6197266">Name</span>&nbsp;<span class="op" id="6197271">=</span>&nbsp;<span class="ident" id="6197273"><a href="/archive/tar/reader.go.html#6203806">cString</a></span><span class="op" id="6197280">(</span><span class="ident" id="6197281"><a href="/archive/tar/reader.go.html#6197159">realname</a></span><span class="op" id="6197289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197293">return</span>&nbsp;<span class="ident" id="6197300"><a href="/archive/tar/reader.go.html#6197238">hdr</a></span><span class="op" id="6197303">,</span>&nbsp;<span class="ident" id="6197305"><a href="/archive/tar/reader.go.html#6197169">err</a></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197310">case</span>&nbsp;<span class="ident" id="6197315"><a href="/archive/tar/common.go.html#6186834">TypeGNULongLink</a></span><span class="op" id="6197330">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6197334">//&nbsp;We&nbsp;have&nbsp;a&nbsp;GNU&nbsp;long&nbsp;link&nbsp;header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197371">realname</span><span class="op" id="6197379">,</span>&nbsp;<span class="ident" id="6197381">err</span>&nbsp;<span class="op" id="6197385">:=</span>&nbsp;<span class="ident" id="6197388"><a href="/archive/tar/reader.go.html#6193688">ioutil</a></span><span class="op" id="6197394">.</span><span class="ident" id="6197395">ReadAll</span><span class="op" id="6197402">(</span><span class="ident" id="6197403"><a href="/archive/tar/reader.go.html#6196152">tr</a></span><span class="op" id="6197405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197409">if</span>&nbsp;<span class="ident" id="6197412"><a href="/archive/tar/reader.go.html#6197381">err</a></span>&nbsp;<span class="op" id="6197416">!=</span>&nbsp;<span class="ident" id="6197419">nil</span>&nbsp;<span class="op" id="6197423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197428">return</span>&nbsp;<span class="ident" id="6197435">nil</span><span class="op" id="6197438">,</span>&nbsp;<span class="ident" id="6197440"><a href="/archive/tar/reader.go.html#6197381">err</a></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6197446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197450">hdr</span><span class="op" id="6197453">,</span>&nbsp;<span class="ident" id="6197455"><a href="/archive/tar/reader.go.html#6197381">err</a></span>&nbsp;<span class="op" id="6197459">:=</span>&nbsp;<span class="ident" id="6197462"><a href="/archive/tar/reader.go.html#6196152">tr</a></span><span class="op" id="6197464">.</span><span class="ident" id="6197465">Next</span><span class="op" id="6197469">(</span><span class="op" id="6197470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197474"><a href="/archive/tar/reader.go.html#6197450">hdr</a></span><span class="op" id="6197477">.</span><span class="ident" id="6197478">Linkname</span>&nbsp;<span class="op" id="6197487">=</span>&nbsp;<span class="ident" id="6197489"><a href="/archive/tar/reader.go.html#6203806">cString</a></span><span class="op" id="6197496">(</span><span class="ident" id="6197497"><a href="/archive/tar/reader.go.html#6197371">realname</a></span><span class="op" id="6197505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197509">return</span>&nbsp;<span class="ident" id="6197516"><a href="/archive/tar/reader.go.html#6197450">hdr</a></span><span class="op" id="6197519">,</span>&nbsp;<span class="ident" id="6197521"><a href="/archive/tar/reader.go.html#6197381">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6197526">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197529">return</span>&nbsp;<span class="ident" id="6197536"><a href="/archive/tar/reader.go.html#6196195">hdr</a></span><span class="op" id="6197539">,</span>&nbsp;<span class="ident" id="6197541"><a href="/archive/tar/reader.go.html#6196152">tr</a></span><span class="op" id="6197543">.</span><span class="ident" id="6197544">err</span><br>
<span class="lineno"></span><span class="op" id="6197548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6197551">//&nbsp;checkForGNUSparsePAXHeaders&nbsp;checks&nbsp;the&nbsp;PAX&nbsp;headers&nbsp;for&nbsp;GNU&nbsp;sparse&nbsp;headers.&nbsp;If&nbsp;they&nbsp;are&nbsp;found,&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="6197653">//&nbsp;this&nbsp;function&nbsp;reads&nbsp;the&nbsp;sparse&nbsp;map&nbsp;and&nbsp;returns&nbsp;it.&nbsp;Unknown&nbsp;sparse&nbsp;formats&nbsp;are&nbsp;ignored,&nbsp;causing&nbsp;the&nbsp;file&nbsp;to</span><br>
<span class="lineno">150</span><span class="comment" id="6197763">//&nbsp;be&nbsp;treated&nbsp;as&nbsp;a&nbsp;regular&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6197796">func</span>&nbsp;<span class="op" id="6197801">(</span><span class="ident" id="6197802">tr</span>&nbsp;<span class="op" id="6197805">*</span><span class="ident" id="6197806"><a href="/archive/tar/reader.go.html#6194123">Reader</a></span><span class="op" id="6197812">)</span>&nbsp;<span class="ident" id="6197814">checkForGNUSparsePAXHeaders</span><span class="op" id="6197841">(</span><span class="ident" id="6197842">hdr</span>&nbsp;<span class="op" id="6197846">*</span><span class="ident" id="6197847"><a href="/archive/tar/common.go.html#6187053">Header</a></span><span class="op" id="6197853">,</span>&nbsp;<span class="ident" id="6197855">headers</span>&nbsp;<span class="keyword" id="6197863">map</span><span class="op" id="6197866">[</span><span class="builtintype" id="6197867">string</span><span class="op" id="6197873">]</span><span class="builtintype" id="6197874">string</span><span class="op" id="6197880">)</span>&nbsp;<span class="op" id="6197882">(</span><span class="op" id="6197883">[</span><span class="op" id="6197884">]</span><span class="ident" id="6197885"><a href="/archive/tar/reader.go.html#6208128">sparseEntry</a></span><span class="op" id="6197896">,</span>&nbsp;<span class="builtintype" id="6197898">error</span><span class="op" id="6197903">)</span>&nbsp;<span class="op" id="6197905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6197908">var</span>&nbsp;<span class="ident" id="6197912">sparseFormat</span>&nbsp;<span class="builtintype" id="6197925">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6197934">//&nbsp;Check&nbsp;for&nbsp;sparse&nbsp;format&nbsp;indicators</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6197973">major</span><span class="op" id="6197978">,</span>&nbsp;<span class="ident" id="6197980">majorOk</span>&nbsp;<span class="op" id="6197988">:=</span>&nbsp;<span class="ident" id="6197991"><a href="/archive/tar/reader.go.html#6197855">headers</a></span><span class="op" id="6197998">[</span><span class="ident" id="6197999"><a href="/archive/tar/reader.go.html#6195404">paxGNUSparseMajor</a></span><span class="op" id="6198016">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6198019">minor</span><span class="op" id="6198024">,</span>&nbsp;<span class="ident" id="6198026">minorOk</span>&nbsp;<span class="op" id="6198034">:=</span>&nbsp;<span class="ident" id="6198037"><a href="/archive/tar/reader.go.html#6197855">headers</a></span><span class="op" id="6198044">[</span><span class="ident" id="6198045"><a href="/archive/tar/reader.go.html#6195448">paxGNUSparseMinor</a></span><span class="op" id="6198062">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6198065">sparseName</span><span class="op" id="6198075">,</span>&nbsp;<span class="ident" id="6198077">sparseNameOk</span>&nbsp;<span class="op" id="6198090">:=</span>&nbsp;<span class="ident" id="6198093"><a href="/archive/tar/reader.go.html#6197855">headers</a></span><span class="op" id="6198100">[</span><span class="ident" id="6198101"><a href="/archive/tar/reader.go.html#6195361">paxGNUSparseName</a></span><span class="op" id="6198117">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6198120">_</span><span class="op" id="6198121">,</span>&nbsp;<span class="ident" id="6198123">sparseMapOk</span>&nbsp;<span class="op" id="6198135">:=</span>&nbsp;<span class="ident" id="6198138"><a href="/archive/tar/reader.go.html#6197855">headers</a></span><span class="op" id="6198145">[</span><span class="ident" id="6198146"><a href="/archive/tar/reader.go.html#6195319">paxGNUSparseMap</a></span><span class="op" id="6198161">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6198164">sparseSize</span><span class="op" id="6198174">,</span>&nbsp;<span class="ident" id="6198176">sparseSizeOk</span>&nbsp;<span class="op" id="6198189">:=</span>&nbsp;<span class="ident" id="6198192"><a href="/archive/tar/reader.go.html#6197855">headers</a></span><span class="op" id="6198199">[</span><span class="ident" id="6198200"><a href="/archive/tar/reader.go.html#6195492">paxGNUSparseSize</a></span><span class="op" id="6198216">]</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6198219">sparseRealSize</span><span class="op" id="6198233">,</span>&nbsp;<span class="ident" id="6198235">sparseRealSizeOk</span>&nbsp;<span class="op" id="6198252">:=</span>&nbsp;<span class="ident" id="6198255"><a href="/archive/tar/reader.go.html#6197855">headers</a></span><span class="op" id="6198262">[</span><span class="ident" id="6198263"><a href="/archive/tar/reader.go.html#6195535">paxGNUSparseRealSize</a></span><span class="op" id="6198283">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6198287">//&nbsp;Identify&nbsp;which,&nbsp;if&nbsp;any,&nbsp;sparse&nbsp;format&nbsp;applies&nbsp;from&nbsp;which&nbsp;PAX&nbsp;headers&nbsp;are&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6198368">if</span>&nbsp;<span class="ident" id="6198371"><a href="/archive/tar/reader.go.html#6197980">majorOk</a></span>&nbsp;<span class="op" id="6198379">&amp;&amp;</span>&nbsp;<span class="ident" id="6198382"><a href="/archive/tar/reader.go.html#6198026">minorOk</a></span>&nbsp;<span class="op" id="6198390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6198394"><a href="/archive/tar/reader.go.html#6197912">sparseFormat</a></span>&nbsp;<span class="op" id="6198407">=</span>&nbsp;<span class="ident" id="6198409"><a href="/archive/tar/reader.go.html#6197973">major</a></span>&nbsp;<span class="op" id="6198415">+</span>&nbsp;<span class="string" id="6198417">&#34;.&#34;</span>&nbsp;<span class="op" id="6198421">+</span>&nbsp;<span class="ident" id="6198423"><a href="/archive/tar/reader.go.html#6198019">minor</a></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6198430">}</span>&nbsp;<span class="keyword" id="6198432">else</span>&nbsp;<span class="keyword" id="6198437">if</span>&nbsp;<span class="ident" id="6198440"><a href="/archive/tar/reader.go.html#6198077">sparseNameOk</a></span>&nbsp;<span class="op" id="6198453">&amp;&amp;</span>&nbsp;<span class="ident" id="6198456"><a href="/archive/tar/reader.go.html#6198123">sparseMapOk</a></span>&nbsp;<span class="op" id="6198468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6198472"><a href="/archive/tar/reader.go.html#6197912">sparseFormat</a></span>&nbsp;<span class="op" id="6198485">=</span>&nbsp;<span class="string" id="6198487">&#34;0.1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6198494">}</span>&nbsp;<span class="keyword" id="6198496">else</span>&nbsp;<span class="keyword" id="6198501">if</span>&nbsp;<span class="ident" id="6198504"><a href="/archive/tar/reader.go.html#6198176">sparseSizeOk</a></span>&nbsp;<span class="op" id="6198517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6198521"><a href="/archive/tar/reader.go.html#6197912">sparseFormat</a></span>&nbsp;<span class="op" id="6198534">=</span>&nbsp;<span class="string" id="6198536">&#34;0.0&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6198543">}</span>&nbsp;<span class="keyword" id="6198545">else</span>&nbsp;<span class="op" id="6198550">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6198554">//&nbsp;Not&nbsp;a&nbsp;PAX&nbsp;format&nbsp;GNU&nbsp;sparse&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6198593">return</span>&nbsp;<span class="ident" id="6198600">nil</span><span class="op" id="6198603">,</span>&nbsp;<span class="ident" id="6198605">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6198610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6198614">//&nbsp;Check&nbsp;for&nbsp;unknown&nbsp;sparse&nbsp;format</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6198650">if</span>&nbsp;<span class="ident" id="6198653"><a href="/archive/tar/reader.go.html#6197912">sparseFormat</a></span>&nbsp;<span class="op" id="6198666">!=</span>&nbsp;<span class="string" id="6198669">&#34;0.0&#34;</span>&nbsp;<span class="op" id="6198675">&amp;&amp;</span>&nbsp;<span class="ident" id="6198678"><a href="/archive/tar/reader.go.html#6197912">sparseFormat</a></span>&nbsp;<span class="op" id="6198691">!=</span>&nbsp;<span class="string" id="6198694">&#34;0.1&#34;</span>&nbsp;<span class="op" id="6198700">&amp;&amp;</span>&nbsp;<span class="ident" id="6198703"><a href="/archive/tar/reader.go.html#6197912">sparseFormat</a></span>&nbsp;<span class="op" id="6198716">!=</span>&nbsp;<span class="string" id="6198719">&#34;1.0&#34;</span>&nbsp;<span class="op" id="6198725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6198729">return</span>&nbsp;<span class="ident" id="6198736">nil</span><span class="op" id="6198739">,</span>&nbsp;<span class="ident" id="6198741">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6198746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6198750">//&nbsp;Update&nbsp;hdr&nbsp;from&nbsp;GNU&nbsp;sparse&nbsp;PAX&nbsp;headers</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6198793">if</span>&nbsp;<span class="ident" id="6198796"><a href="/archive/tar/reader.go.html#6198077">sparseNameOk</a></span>&nbsp;<span class="op" id="6198809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6198813"><a href="/archive/tar/reader.go.html#6197842">hdr</a></span><span class="op" id="6198816">.</span><span class="ident" id="6198817">Name</span>&nbsp;<span class="op" id="6198822">=</span>&nbsp;<span class="ident" id="6198824"><a href="/archive/tar/reader.go.html#6198065">sparseName</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6198836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6198839">if</span>&nbsp;<span class="ident" id="6198842"><a href="/archive/tar/reader.go.html#6198176">sparseSizeOk</a></span>&nbsp;<span class="op" id="6198855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6198859">realSize</span><span class="op" id="6198867">,</span>&nbsp;<span class="ident" id="6198869">err</span>&nbsp;<span class="op" id="6198873">:=</span>&nbsp;<span class="ident" id="6198876"><a href="/archive/tar/reader.go.html#6193707">strconv</a></span><span class="op" id="6198883">.</span><span class="ident" id="6198884">ParseInt</span><span class="op" id="6198892">(</span><span class="ident" id="6198893"><a href="/archive/tar/reader.go.html#6198164">sparseSize</a></span><span class="op" id="6198903">,</span>&nbsp;<span class="num" id="6198905">10</span><span class="op" id="6198907">,</span>&nbsp;<span class="num" id="6198909">0</span><span class="op" id="6198910">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6198914">if</span>&nbsp;<span class="ident" id="6198917"><a href="/archive/tar/reader.go.html#6198869">err</a></span>&nbsp;<span class="op" id="6198921">!=</span>&nbsp;<span class="ident" id="6198924">nil</span>&nbsp;<span class="op" id="6198928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6198933">return</span>&nbsp;<span class="ident" id="6198940">nil</span><span class="op" id="6198943">,</span>&nbsp;<span class="ident" id="6198945"><a href="/archive/tar/reader.go.html#6193746">ErrHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6198957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6198961"><a href="/archive/tar/reader.go.html#6197842">hdr</a></span><span class="op" id="6198964">.</span><span class="ident" id="6198965">Size</span>&nbsp;<span class="op" id="6198970">=</span>&nbsp;<span class="ident" id="6198972"><a href="/archive/tar/reader.go.html#6198859">realSize</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6198982">}</span>&nbsp;<span class="keyword" id="6198984">else</span>&nbsp;<span class="keyword" id="6198989">if</span>&nbsp;<span class="ident" id="6198992"><a href="/archive/tar/reader.go.html#6198235">sparseRealSizeOk</a></span>&nbsp;<span class="op" id="6199009">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6199013">realSize</span><span class="op" id="6199021">,</span>&nbsp;<span class="ident" id="6199023">err</span>&nbsp;<span class="op" id="6199027">:=</span>&nbsp;<span class="ident" id="6199030"><a href="/archive/tar/reader.go.html#6193707">strconv</a></span><span class="op" id="6199037">.</span><span class="ident" id="6199038">ParseInt</span><span class="op" id="6199046">(</span><span class="ident" id="6199047"><a href="/archive/tar/reader.go.html#6198219">sparseRealSize</a></span><span class="op" id="6199061">,</span>&nbsp;<span class="num" id="6199063">10</span><span class="op" id="6199065">,</span>&nbsp;<span class="num" id="6199067">0</span><span class="op" id="6199068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199072">if</span>&nbsp;<span class="ident" id="6199075"><a href="/archive/tar/reader.go.html#6199023">err</a></span>&nbsp;<span class="op" id="6199079">!=</span>&nbsp;<span class="ident" id="6199082">nil</span>&nbsp;<span class="op" id="6199086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199091">return</span>&nbsp;<span class="ident" id="6199098">nil</span><span class="op" id="6199101">,</span>&nbsp;<span class="ident" id="6199103"><a href="/archive/tar/reader.go.html#6193746">ErrHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6199115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6199119"><a href="/archive/tar/reader.go.html#6197842">hdr</a></span><span class="op" id="6199122">.</span><span class="ident" id="6199123">Size</span>&nbsp;<span class="op" id="6199128">=</span>&nbsp;<span class="ident" id="6199130"><a href="/archive/tar/reader.go.html#6199013">realSize</a></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6199140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6199144">//&nbsp;Set&nbsp;up&nbsp;the&nbsp;sparse&nbsp;map,&nbsp;according&nbsp;to&nbsp;the&nbsp;particular&nbsp;sparse&nbsp;format&nbsp;in&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199220">var</span>&nbsp;<span class="ident" id="6199224">sp</span>&nbsp;<span class="op" id="6199227">[</span><span class="op" id="6199228">]</span><span class="ident" id="6199229"><a href="/archive/tar/reader.go.html#6208128">sparseEntry</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199242">var</span>&nbsp;<span class="ident" id="6199246">err</span>&nbsp;<span class="builtintype" id="6199250">error</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199257">switch</span>&nbsp;<span class="ident" id="6199264"><a href="/archive/tar/reader.go.html#6197912">sparseFormat</a></span>&nbsp;<span class="op" id="6199277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199280">case</span>&nbsp;<span class="string" id="6199285">&#34;0.0&#34;</span><span class="op" id="6199290">,</span>&nbsp;<span class="string" id="6199292">&#34;0.1&#34;</span><span class="op" id="6199297">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6199301"><a href="/archive/tar/reader.go.html#6199224">sp</a></span><span class="op" id="6199303">,</span>&nbsp;<span class="ident" id="6199305"><a href="/archive/tar/reader.go.html#6199246">err</a></span>&nbsp;<span class="op" id="6199309">=</span>&nbsp;<span class="ident" id="6199311"><a href="/archive/tar/reader.go.html#6212347">readGNUSparseMap0x1</a></span><span class="op" id="6199330">(</span><span class="ident" id="6199331"><a href="/archive/tar/reader.go.html#6197855">headers</a></span><span class="op" id="6199338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199341">case</span>&nbsp;<span class="string" id="6199346">&#34;1.0&#34;</span><span class="op" id="6199351">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6199355"><a href="/archive/tar/reader.go.html#6199224">sp</a></span><span class="op" id="6199357">,</span>&nbsp;<span class="ident" id="6199359"><a href="/archive/tar/reader.go.html#6199246">err</a></span>&nbsp;<span class="op" id="6199363">=</span>&nbsp;<span class="ident" id="6199365"><a href="/archive/tar/reader.go.html#6210094">readGNUSparseMap1x0</a></span><span class="op" id="6199384">(</span><span class="ident" id="6199385"><a href="/archive/tar/reader.go.html#6197802">tr</a></span><span class="op" id="6199387">.</span><span class="ident" id="6199388">curr</span><span class="op" id="6199392">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6199395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199398">return</span>&nbsp;<span class="ident" id="6199405"><a href="/archive/tar/reader.go.html#6199224">sp</a></span><span class="op" id="6199407">,</span>&nbsp;<span class="ident" id="6199409"><a href="/archive/tar/reader.go.html#6199246">err</a></span><br>
<span class="lineno"></span><span class="op" id="6199413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6199416">//&nbsp;mergePAX&nbsp;merges&nbsp;well&nbsp;known&nbsp;headers&nbsp;according&nbsp;to&nbsp;PAX&nbsp;standard.</span><br>
<span class="lineno">210</span><span class="comment" id="6199481">//&nbsp;In&nbsp;general&nbsp;headers&nbsp;with&nbsp;the&nbsp;same&nbsp;name&nbsp;as&nbsp;those&nbsp;found</span><br>
<span class="lineno"></span><span class="comment" id="6199537">//&nbsp;in&nbsp;the&nbsp;header&nbsp;struct&nbsp;overwrite&nbsp;those&nbsp;found&nbsp;in&nbsp;the&nbsp;header</span><br>
<span class="lineno"></span><span class="comment" id="6199597">//&nbsp;struct&nbsp;with&nbsp;higher&nbsp;precision&nbsp;or&nbsp;longer&nbsp;values.&nbsp;Esp.&nbsp;useful</span><br>
<span class="lineno"></span><span class="comment" id="6199659">//&nbsp;for&nbsp;name&nbsp;and&nbsp;linkname&nbsp;fields.</span><br>
<span class="lineno"></span><span class="keyword" id="6199692">func</span>&nbsp;<span class="ident" id="6199697">mergePAX</span><span class="op" id="6199705">(</span><span class="ident" id="6199706">hdr</span>&nbsp;<span class="op" id="6199710">*</span><span class="ident" id="6199711"><a href="/archive/tar/common.go.html#6187053">Header</a></span><span class="op" id="6199717">,</span>&nbsp;<span class="ident" id="6199719">headers</span>&nbsp;<span class="keyword" id="6199727">map</span><span class="op" id="6199730">[</span><span class="builtintype" id="6199731">string</span><span class="op" id="6199737">]</span><span class="builtintype" id="6199738">string</span><span class="op" id="6199744">)</span>&nbsp;<span class="builtintype" id="6199746">error</span>&nbsp;<span class="op" id="6199752">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199755">for</span>&nbsp;<span class="ident" id="6199759">k</span><span class="op" id="6199760">,</span>&nbsp;<span class="ident" id="6199762">v</span>&nbsp;<span class="op" id="6199764">:=</span>&nbsp;<span class="keyword" id="6199767">range</span>&nbsp;<span class="ident" id="6199773"><a href="/archive/tar/reader.go.html#6199719">headers</a></span>&nbsp;<span class="op" id="6199781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199785">switch</span>&nbsp;<span class="ident" id="6199792"><a href="/archive/tar/reader.go.html#6199759">k</a></span>&nbsp;<span class="op" id="6199794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199798">case</span>&nbsp;<span class="ident" id="6199803"><a href="/archive/tar/common.go.html#6190816">paxPath</a></span><span class="op" id="6199810">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6199815"><a href="/archive/tar/reader.go.html#6199706">hdr</a></span><span class="op" id="6199818">.</span><span class="ident" id="6199819">Name</span>&nbsp;<span class="op" id="6199824">=</span>&nbsp;<span class="ident" id="6199826"><a href="/archive/tar/reader.go.html#6199762">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199830">case</span>&nbsp;<span class="ident" id="6199835"><a href="/archive/tar/common.go.html#6190767">paxLinkpath</a></span><span class="op" id="6199846">:</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6199851"><a href="/archive/tar/reader.go.html#6199706">hdr</a></span><span class="op" id="6199854">.</span><span class="ident" id="6199855">Linkname</span>&nbsp;<span class="op" id="6199864">=</span>&nbsp;<span class="ident" id="6199866"><a href="/archive/tar/reader.go.html#6199762">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199870">case</span>&nbsp;<span class="ident" id="6199875"><a href="/archive/tar/common.go.html#6190744">paxGname</a></span><span class="op" id="6199883">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6199888"><a href="/archive/tar/reader.go.html#6199706">hdr</a></span><span class="op" id="6199891">.</span><span class="ident" id="6199892">Gname</span>&nbsp;<span class="op" id="6199898">=</span>&nbsp;<span class="ident" id="6199900"><a href="/archive/tar/reader.go.html#6199762">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199904">case</span>&nbsp;<span class="ident" id="6199909"><a href="/archive/tar/common.go.html#6190881">paxUname</a></span><span class="op" id="6199917">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6199922"><a href="/archive/tar/reader.go.html#6199706">hdr</a></span><span class="op" id="6199925">.</span><span class="ident" id="6199926">Uname</span>&nbsp;<span class="op" id="6199932">=</span>&nbsp;<span class="ident" id="6199934"><a href="/archive/tar/reader.go.html#6199762">v</a></span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199938">case</span>&nbsp;<span class="ident" id="6199943"><a href="/archive/tar/common.go.html#6190860">paxUid</a></span><span class="op" id="6199949">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6199954">uid</span><span class="op" id="6199957">,</span>&nbsp;<span class="ident" id="6199959">err</span>&nbsp;<span class="op" id="6199963">:=</span>&nbsp;<span class="ident" id="6199966"><a href="/archive/tar/reader.go.html#6193707">strconv</a></span><span class="op" id="6199973">.</span><span class="ident" id="6199974">ParseInt</span><span class="op" id="6199982">(</span><span class="ident" id="6199983"><a href="/archive/tar/reader.go.html#6199762">v</a></span><span class="op" id="6199984">,</span>&nbsp;<span class="num" id="6199986">10</span><span class="op" id="6199988">,</span>&nbsp;<span class="num" id="6199990">0</span><span class="op" id="6199991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6199996">if</span>&nbsp;<span class="ident" id="6199999"><a href="/archive/tar/reader.go.html#6199959">err</a></span>&nbsp;<span class="op" id="6200003">!=</span>&nbsp;<span class="ident" id="6200006">nil</span>&nbsp;<span class="op" id="6200010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200016">return</span>&nbsp;<span class="ident" id="6200023"><a href="/archive/tar/reader.go.html#6199959">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6200030">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200035"><a href="/archive/tar/reader.go.html#6199706">hdr</a></span><span class="op" id="6200038">.</span><span class="ident" id="6200039">Uid</span>&nbsp;<span class="op" id="6200043">=</span>&nbsp;<span class="builtintype" id="6200045">int</span><span class="op" id="6200048">(</span><span class="ident" id="6200049"><a href="/archive/tar/reader.go.html#6199954">uid</a></span><span class="op" id="6200052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200056">case</span>&nbsp;<span class="ident" id="6200061"><a href="/archive/tar/common.go.html#6190723">paxGid</a></span><span class="op" id="6200067">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200072">gid</span><span class="op" id="6200075">,</span>&nbsp;<span class="ident" id="6200077">err</span>&nbsp;<span class="op" id="6200081">:=</span>&nbsp;<span class="ident" id="6200084"><a href="/archive/tar/reader.go.html#6193707">strconv</a></span><span class="op" id="6200091">.</span><span class="ident" id="6200092">ParseInt</span><span class="op" id="6200100">(</span><span class="ident" id="6200101"><a href="/archive/tar/reader.go.html#6199762">v</a></span><span class="op" id="6200102">,</span>&nbsp;<span class="num" id="6200104">10</span><span class="op" id="6200106">,</span>&nbsp;<span class="num" id="6200108">0</span><span class="op" id="6200109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200114">if</span>&nbsp;<span class="ident" id="6200117"><a href="/archive/tar/reader.go.html#6200077">err</a></span>&nbsp;<span class="op" id="6200121">!=</span>&nbsp;<span class="ident" id="6200124">nil</span>&nbsp;<span class="op" id="6200128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200134">return</span>&nbsp;<span class="ident" id="6200141"><a href="/archive/tar/reader.go.html#6200077">err</a></span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6200148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200153"><a href="/archive/tar/reader.go.html#6199706">hdr</a></span><span class="op" id="6200156">.</span><span class="ident" id="6200157">Gid</span>&nbsp;<span class="op" id="6200161">=</span>&nbsp;<span class="builtintype" id="6200163">int</span><span class="op" id="6200166">(</span><span class="ident" id="6200167"><a href="/archive/tar/reader.go.html#6200072">gid</a></span><span class="op" id="6200170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200174">case</span>&nbsp;<span class="ident" id="6200179"><a href="/archive/tar/common.go.html#6190574">paxAtime</a></span><span class="op" id="6200187">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200192">t</span><span class="op" id="6200193">,</span>&nbsp;<span class="ident" id="6200195">err</span>&nbsp;<span class="op" id="6200199">:=</span>&nbsp;<span class="ident" id="6200202"><a href="/archive/tar/reader.go.html#6200900">parsePAXTime</a></span><span class="op" id="6200214">(</span><span class="ident" id="6200215"><a href="/archive/tar/reader.go.html#6199762">v</a></span><span class="op" id="6200216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200221">if</span>&nbsp;<span class="ident" id="6200224"><a href="/archive/tar/reader.go.html#6200195">err</a></span>&nbsp;<span class="op" id="6200228">!=</span>&nbsp;<span class="ident" id="6200231">nil</span>&nbsp;<span class="op" id="6200235">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200241">return</span>&nbsp;<span class="ident" id="6200248"><a href="/archive/tar/reader.go.html#6200195">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6200255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200260"><a href="/archive/tar/reader.go.html#6199706">hdr</a></span><span class="op" id="6200263">.</span><span class="ident" id="6200264">AccessTime</span>&nbsp;<span class="op" id="6200275">=</span>&nbsp;<span class="ident" id="6200277"><a href="/archive/tar/reader.go.html#6200192">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200281">case</span>&nbsp;<span class="ident" id="6200286"><a href="/archive/tar/common.go.html#6190793">paxMtime</a></span><span class="op" id="6200294">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200299">t</span><span class="op" id="6200300">,</span>&nbsp;<span class="ident" id="6200302">err</span>&nbsp;<span class="op" id="6200306">:=</span>&nbsp;<span class="ident" id="6200309"><a href="/archive/tar/reader.go.html#6200900">parsePAXTime</a></span><span class="op" id="6200321">(</span><span class="ident" id="6200322"><a href="/archive/tar/reader.go.html#6199762">v</a></span><span class="op" id="6200323">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200328">if</span>&nbsp;<span class="ident" id="6200331"><a href="/archive/tar/reader.go.html#6200302">err</a></span>&nbsp;<span class="op" id="6200335">!=</span>&nbsp;<span class="ident" id="6200338">nil</span>&nbsp;<span class="op" id="6200342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200348">return</span>&nbsp;<span class="ident" id="6200355"><a href="/archive/tar/reader.go.html#6200302">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6200362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200367"><a href="/archive/tar/reader.go.html#6199706">hdr</a></span><span class="op" id="6200370">.</span><span class="ident" id="6200371">ModTime</span>&nbsp;<span class="op" id="6200379">=</span>&nbsp;<span class="ident" id="6200381"><a href="/archive/tar/reader.go.html#6200299">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200385">case</span>&nbsp;<span class="ident" id="6200390"><a href="/archive/tar/common.go.html#6190647">paxCtime</a></span><span class="op" id="6200398">:</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200403">t</span><span class="op" id="6200404">,</span>&nbsp;<span class="ident" id="6200406">err</span>&nbsp;<span class="op" id="6200410">:=</span>&nbsp;<span class="ident" id="6200413"><a href="/archive/tar/reader.go.html#6200900">parsePAXTime</a></span><span class="op" id="6200425">(</span><span class="ident" id="6200426"><a href="/archive/tar/reader.go.html#6199762">v</a></span><span class="op" id="6200427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200432">if</span>&nbsp;<span class="ident" id="6200435"><a href="/archive/tar/reader.go.html#6200406">err</a></span>&nbsp;<span class="op" id="6200439">!=</span>&nbsp;<span class="ident" id="6200442">nil</span>&nbsp;<span class="op" id="6200446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200452">return</span>&nbsp;<span class="ident" id="6200459"><a href="/archive/tar/reader.go.html#6200406">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6200466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200471"><a href="/archive/tar/reader.go.html#6199706">hdr</a></span><span class="op" id="6200474">.</span><span class="ident" id="6200475">ChangeTime</span>&nbsp;<span class="op" id="6200486">=</span>&nbsp;<span class="ident" id="6200488"><a href="/archive/tar/reader.go.html#6200403">t</a></span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200492">case</span>&nbsp;<span class="ident" id="6200497"><a href="/archive/tar/common.go.html#6190838">paxSize</a></span><span class="op" id="6200504">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200509">size</span><span class="op" id="6200513">,</span>&nbsp;<span class="ident" id="6200515">err</span>&nbsp;<span class="op" id="6200519">:=</span>&nbsp;<span class="ident" id="6200522"><a href="/archive/tar/reader.go.html#6193707">strconv</a></span><span class="op" id="6200529">.</span><span class="ident" id="6200530">ParseInt</span><span class="op" id="6200538">(</span><span class="ident" id="6200539"><a href="/archive/tar/reader.go.html#6199762">v</a></span><span class="op" id="6200540">,</span>&nbsp;<span class="num" id="6200542">10</span><span class="op" id="6200544">,</span>&nbsp;<span class="num" id="6200546">0</span><span class="op" id="6200547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200552">if</span>&nbsp;<span class="ident" id="6200555"><a href="/archive/tar/reader.go.html#6200515">err</a></span>&nbsp;<span class="op" id="6200559">!=</span>&nbsp;<span class="ident" id="6200562">nil</span>&nbsp;<span class="op" id="6200566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200572">return</span>&nbsp;<span class="ident" id="6200579"><a href="/archive/tar/reader.go.html#6200515">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6200586">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200591"><a href="/archive/tar/reader.go.html#6199706">hdr</a></span><span class="op" id="6200594">.</span><span class="ident" id="6200595">Size</span>&nbsp;<span class="op" id="6200600">=</span>&nbsp;<span class="ident" id="6200602">int64</span><span class="op" id="6200607">(</span><span class="ident" id="6200608"><a href="/archive/tar/reader.go.html#6200509">size</a></span><span class="op" id="6200612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200616">default</span><span class="op" id="6200623">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200628">if</span>&nbsp;<span class="ident" id="6200631"><a href="/archive/tar/reader.go.html#6193718">strings</a></span><span class="op" id="6200638">.</span><span class="ident" id="6200639">HasPrefix</span><span class="op" id="6200648">(</span><span class="ident" id="6200649"><a href="/archive/tar/reader.go.html#6199759">k</a></span><span class="op" id="6200650">,</span>&nbsp;<span class="ident" id="6200652"><a href="/archive/tar/common.go.html#6190904">paxXattr</a></span><span class="op" id="6200660">)</span>&nbsp;<span class="op" id="6200662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200668">if</span>&nbsp;<span class="ident" id="6200671"><a href="/archive/tar/reader.go.html#6199706">hdr</a></span><span class="op" id="6200674">.</span><span class="ident" id="6200675">Xattrs</span>&nbsp;<span class="op" id="6200682">==</span>&nbsp;<span class="ident" id="6200685">nil</span>&nbsp;<span class="op" id="6200689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200696"><a href="/archive/tar/reader.go.html#6199706">hdr</a></span><span class="op" id="6200699">.</span><span class="ident" id="6200700">Xattrs</span>&nbsp;<span class="op" id="6200707">=</span>&nbsp;<span class="builtinfunc" id="6200709">make</span><span class="op" id="6200713">(</span><span class="keyword" id="6200714">map</span><span class="op" id="6200717">[</span><span class="builtintype" id="6200718">string</span><span class="op" id="6200724">]</span><span class="builtintype" id="6200725">string</span><span class="op" id="6200731">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6200737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200743"><a href="/archive/tar/reader.go.html#6199706">hdr</a></span><span class="op" id="6200746">.</span><span class="ident" id="6200747">Xattrs</span><span class="op" id="6200753">[</span><span class="ident" id="6200754"><a href="/archive/tar/reader.go.html#6199759">k</a></span><span class="op" id="6200755">[</span><span class="builtinfunc" id="6200756">len</span><span class="op" id="6200759">(</span><span class="ident" id="6200760"><a href="/archive/tar/common.go.html#6190904">paxXattr</a></span><span class="op" id="6200768">)</span><span class="op" id="6200769">:</span><span class="op" id="6200770">]</span><span class="op" id="6200771">]</span>&nbsp;<span class="op" id="6200773">=</span>&nbsp;<span class="ident" id="6200775"><a href="/archive/tar/reader.go.html#6199762">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6200780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6200784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6200787">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200790">return</span>&nbsp;<span class="ident" id="6200797">nil</span><br>
<span class="lineno"></span><span class="op" id="6200801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6200804">//&nbsp;parsePAXTime&nbsp;takes&nbsp;a&nbsp;string&nbsp;of&nbsp;the&nbsp;form&nbsp;%d.%d&nbsp;as&nbsp;described&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="6200869">//&nbsp;the&nbsp;PAX&nbsp;specification.</span><br>
<span class="lineno">275</span><span class="keyword" id="6200895">func</span>&nbsp;<span class="ident" id="6200900">parsePAXTime</span><span class="op" id="6200912">(</span><span class="ident" id="6200913">t</span>&nbsp;<span class="builtintype" id="6200915">string</span><span class="op" id="6200921">)</span>&nbsp;<span class="op" id="6200923">(</span><span class="ident" id="6200924"><a href="/archive/tar/reader.go.html#6193729">time</a></span><span class="op" id="6200928">.</span><span class="ident" id="6200929">Time</span><span class="op" id="6200933">,</span>&nbsp;<span class="builtintype" id="6200935">error</span><span class="op" id="6200940">)</span>&nbsp;<span class="op" id="6200942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200945">buf</span>&nbsp;<span class="op" id="6200949">:=</span>&nbsp;<span class="op" id="6200952">[</span><span class="op" id="6200953">]</span><span class="builtintype" id="6200954">byte</span><span class="op" id="6200958">(</span><span class="ident" id="6200959"><a href="/archive/tar/reader.go.html#6200913">t</a></span><span class="op" id="6200960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6200963">pos</span>&nbsp;<span class="op" id="6200967">:=</span>&nbsp;<span class="ident" id="6200970"><a href="/archive/tar/reader.go.html#6193663">bytes</a></span><span class="op" id="6200975">.</span><span class="ident" id="6200976">IndexByte</span><span class="op" id="6200985">(</span><span class="ident" id="6200986"><a href="/archive/tar/reader.go.html#6200945">buf</a></span><span class="op" id="6200989">,</span>&nbsp;<span class="string" id="6200991">&#39;.&#39;</span><span class="op" id="6200994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6200997">var</span>&nbsp;<span class="ident" id="6201001">seconds</span><span class="op" id="6201008">,</span>&nbsp;<span class="ident" id="6201010">nanoseconds</span>&nbsp;<span class="ident" id="6201022">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6201029">var</span>&nbsp;<span class="ident" id="6201033">err</span>&nbsp;<span class="builtintype" id="6201037">error</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6201044">if</span>&nbsp;<span class="ident" id="6201047"><a href="/archive/tar/reader.go.html#6200963">pos</a></span>&nbsp;<span class="op" id="6201051">==</span>&nbsp;<span class="op" id="6201054">-</span><span class="num" id="6201055">1</span>&nbsp;<span class="op" id="6201057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6201061"><a href="/archive/tar/reader.go.html#6201001">seconds</a></span><span class="op" id="6201068">,</span>&nbsp;<span class="ident" id="6201070"><a href="/archive/tar/reader.go.html#6201033">err</a></span>&nbsp;<span class="op" id="6201074">=</span>&nbsp;<span class="ident" id="6201076"><a href="/archive/tar/reader.go.html#6193707">strconv</a></span><span class="op" id="6201083">.</span><span class="ident" id="6201084">ParseInt</span><span class="op" id="6201092">(</span><span class="ident" id="6201093"><a href="/archive/tar/reader.go.html#6200913">t</a></span><span class="op" id="6201094">,</span>&nbsp;<span class="num" id="6201096">10</span><span class="op" id="6201098">,</span>&nbsp;<span class="num" id="6201100">0</span><span class="op" id="6201101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6201105">if</span>&nbsp;<span class="ident" id="6201108"><a href="/archive/tar/reader.go.html#6201033">err</a></span>&nbsp;<span class="op" id="6201112">!=</span>&nbsp;<span class="ident" id="6201115">nil</span>&nbsp;<span class="op" id="6201119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6201124">return</span>&nbsp;<span class="ident" id="6201131"><a href="/archive/tar/reader.go.html#6193729">time</a></span><span class="op" id="6201135">.</span><span class="ident" id="6201136">Time</span><span class="op" id="6201140">{</span><span class="op" id="6201141">}</span><span class="op" id="6201142">,</span>&nbsp;<span class="ident" id="6201144"><a href="/archive/tar/reader.go.html#6201033">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6201150">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6201153">}</span>&nbsp;<span class="keyword" id="6201155">else</span>&nbsp;<span class="op" id="6201160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6201164"><a href="/archive/tar/reader.go.html#6201001">seconds</a></span><span class="op" id="6201171">,</span>&nbsp;<span class="ident" id="6201173"><a href="/archive/tar/reader.go.html#6201033">err</a></span>&nbsp;<span class="op" id="6201177">=</span>&nbsp;<span class="ident" id="6201179"><a href="/archive/tar/reader.go.html#6193707">strconv</a></span><span class="op" id="6201186">.</span><span class="ident" id="6201187">ParseInt</span><span class="op" id="6201195">(</span><span class="builtintype" id="6201196">string</span><span class="op" id="6201202">(</span><span class="ident" id="6201203"><a href="/archive/tar/reader.go.html#6200945">buf</a></span><span class="op" id="6201206">[</span><span class="op" id="6201207">:</span><span class="ident" id="6201208"><a href="/archive/tar/reader.go.html#6200963">pos</a></span><span class="op" id="6201211">]</span><span class="op" id="6201212">)</span><span class="op" id="6201213">,</span>&nbsp;<span class="num" id="6201215">10</span><span class="op" id="6201217">,</span>&nbsp;<span class="num" id="6201219">0</span><span class="op" id="6201220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6201224">if</span>&nbsp;<span class="ident" id="6201227"><a href="/archive/tar/reader.go.html#6201033">err</a></span>&nbsp;<span class="op" id="6201231">!=</span>&nbsp;<span class="ident" id="6201234">nil</span>&nbsp;<span class="op" id="6201238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6201243">return</span>&nbsp;<span class="ident" id="6201250"><a href="/archive/tar/reader.go.html#6193729">time</a></span><span class="op" id="6201254">.</span><span class="ident" id="6201255">Time</span><span class="op" id="6201259">{</span><span class="op" id="6201260">}</span><span class="op" id="6201261">,</span>&nbsp;<span class="ident" id="6201263"><a href="/archive/tar/reader.go.html#6201033">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6201269">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6201273">nano_buf</span>&nbsp;<span class="op" id="6201282">:=</span>&nbsp;<span class="builtintype" id="6201285">string</span><span class="op" id="6201291">(</span><span class="ident" id="6201292"><a href="/archive/tar/reader.go.html#6200945">buf</a></span><span class="op" id="6201295">[</span><span class="ident" id="6201296"><a href="/archive/tar/reader.go.html#6200963">pos</a></span><span class="op" id="6201299">+</span><span class="num" id="6201300">1</span><span class="op" id="6201301">:</span><span class="op" id="6201302">]</span><span class="op" id="6201303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6201307">//&nbsp;Pad&nbsp;as&nbsp;needed&nbsp;before&nbsp;converting&nbsp;to&nbsp;a&nbsp;decimal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6201358">//&nbsp;For&nbsp;example&nbsp;.030&nbsp;-&gt;&nbsp;.030000000&nbsp;-&gt;&nbsp;30000000&nbsp;nanoseconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6201418">if</span>&nbsp;<span class="builtinfunc" id="6201421">len</span><span class="op" id="6201424">(</span><span class="ident" id="6201425"><a href="/archive/tar/reader.go.html#6201273">nano_buf</a></span><span class="op" id="6201433">)</span>&nbsp;<span class="op" id="6201435">&lt;</span>&nbsp;<span class="ident" id="6201437"><a href="/archive/tar/reader.go.html#6193813">maxNanoSecondIntSize</a></span>&nbsp;<span class="op" id="6201458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6201463">//&nbsp;Right&nbsp;pad</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6201479"><a href="/archive/tar/reader.go.html#6201273">nano_buf</a></span>&nbsp;<span class="op" id="6201488">+=</span>&nbsp;<span class="ident" id="6201491"><a href="/archive/tar/reader.go.html#6193718">strings</a></span><span class="op" id="6201498">.</span><span class="ident" id="6201499">Repeat</span><span class="op" id="6201505">(</span><span class="string" id="6201506">&#34;0&#34;</span><span class="op" id="6201509">,</span>&nbsp;<span class="ident" id="6201511"><a href="/archive/tar/reader.go.html#6193813">maxNanoSecondIntSize</a></span><span class="op" id="6201531">-</span><span class="builtinfunc" id="6201532">len</span><span class="op" id="6201535">(</span><span class="ident" id="6201536"><a href="/archive/tar/reader.go.html#6201273">nano_buf</a></span><span class="op" id="6201544">)</span><span class="op" id="6201545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6201549">}</span>&nbsp;<span class="keyword" id="6201551">else</span>&nbsp;<span class="keyword" id="6201556">if</span>&nbsp;<span class="builtinfunc" id="6201559">len</span><span class="op" id="6201562">(</span><span class="ident" id="6201563"><a href="/archive/tar/reader.go.html#6201273">nano_buf</a></span><span class="op" id="6201571">)</span>&nbsp;<span class="op" id="6201573">&gt;</span>&nbsp;<span class="ident" id="6201575"><a href="/archive/tar/reader.go.html#6193813">maxNanoSecondIntSize</a></span>&nbsp;<span class="op" id="6201596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6201601">//&nbsp;Right&nbsp;truncate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6201622"><a href="/archive/tar/reader.go.html#6201273">nano_buf</a></span>&nbsp;<span class="op" id="6201631">=</span>&nbsp;<span class="ident" id="6201633"><a href="/archive/tar/reader.go.html#6201273">nano_buf</a></span><span class="op" id="6201641">[</span><span class="op" id="6201642">:</span><span class="ident" id="6201643"><a href="/archive/tar/reader.go.html#6193813">maxNanoSecondIntSize</a></span><span class="op" id="6201663">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6201667">}</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6201671"><a href="/archive/tar/reader.go.html#6201010">nanoseconds</a></span><span class="op" id="6201682">,</span>&nbsp;<span class="ident" id="6201684"><a href="/archive/tar/reader.go.html#6201033">err</a></span>&nbsp;<span class="op" id="6201688">=</span>&nbsp;<span class="ident" id="6201690"><a href="/archive/tar/reader.go.html#6193707">strconv</a></span><span class="op" id="6201697">.</span><span class="ident" id="6201698">ParseInt</span><span class="op" id="6201706">(</span><span class="builtintype" id="6201707">string</span><span class="op" id="6201713">(</span><span class="ident" id="6201714"><a href="/archive/tar/reader.go.html#6201273">nano_buf</a></span><span class="op" id="6201722">)</span><span class="op" id="6201723">,</span>&nbsp;<span class="num" id="6201725">10</span><span class="op" id="6201727">,</span>&nbsp;<span class="num" id="6201729">0</span><span class="op" id="6201730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6201734">if</span>&nbsp;<span class="ident" id="6201737"><a href="/archive/tar/reader.go.html#6201033">err</a></span>&nbsp;<span class="op" id="6201741">!=</span>&nbsp;<span class="ident" id="6201744">nil</span>&nbsp;<span class="op" id="6201748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6201753">return</span>&nbsp;<span class="ident" id="6201760"><a href="/archive/tar/reader.go.html#6193729">time</a></span><span class="op" id="6201764">.</span><span class="ident" id="6201765">Time</span><span class="op" id="6201769">{</span><span class="op" id="6201770">}</span><span class="op" id="6201771">,</span>&nbsp;<span class="ident" id="6201773"><a href="/archive/tar/reader.go.html#6201033">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6201779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6201782">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6201785">ts</span>&nbsp;<span class="op" id="6201788">:=</span>&nbsp;<span class="ident" id="6201791"><a href="/archive/tar/reader.go.html#6193729">time</a></span><span class="op" id="6201795">.</span><span class="ident" id="6201796">Unix</span><span class="op" id="6201800">(</span><span class="ident" id="6201801"><a href="/archive/tar/reader.go.html#6201001">seconds</a></span><span class="op" id="6201808">,</span>&nbsp;<span class="ident" id="6201810"><a href="/archive/tar/reader.go.html#6201010">nanoseconds</a></span><span class="op" id="6201821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6201824">return</span>&nbsp;<span class="ident" id="6201831"><a href="/archive/tar/reader.go.html#6201785">ts</a></span><span class="op" id="6201833">,</span>&nbsp;<span class="ident" id="6201835">nil</span><br>
<span class="lineno"></span><span class="op" id="6201839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6201842">//&nbsp;parsePAX&nbsp;parses&nbsp;PAX&nbsp;headers.</span><br>
<span class="lineno">310</span><span class="comment" id="6201874">//&nbsp;If&nbsp;an&nbsp;extended&nbsp;header&nbsp;(type&nbsp;&#39;x&#39;)&nbsp;is&nbsp;invalid,&nbsp;ErrHeader&nbsp;is&nbsp;returned</span><br>
<span class="lineno"></span><span class="keyword" id="6201944">func</span>&nbsp;<span class="ident" id="6201949">parsePAX</span><span class="op" id="6201957">(</span><span class="ident" id="6201958">r</span>&nbsp;<span class="ident" id="6201960"><a href="/archive/tar/reader.go.html#6193682">io</a></span><span class="op" id="6201962">.</span><span class="ident" id="6201963">Reader</span><span class="op" id="6201969">)</span>&nbsp;<span class="op" id="6201971">(</span><span class="keyword" id="6201972">map</span><span class="op" id="6201975">[</span><span class="builtintype" id="6201976">string</span><span class="op" id="6201982">]</span><span class="builtintype" id="6201983">string</span><span class="op" id="6201989">,</span>&nbsp;<span class="builtintype" id="6201991">error</span><span class="op" id="6201996">)</span>&nbsp;<span class="op" id="6201998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202001">buf</span><span class="op" id="6202004">,</span>&nbsp;<span class="ident" id="6202006">err</span>&nbsp;<span class="op" id="6202010">:=</span>&nbsp;<span class="ident" id="6202013"><a href="/archive/tar/reader.go.html#6193688">ioutil</a></span><span class="op" id="6202019">.</span><span class="ident" id="6202020">ReadAll</span><span class="op" id="6202027">(</span><span class="ident" id="6202028"><a href="/archive/tar/reader.go.html#6201958">r</a></span><span class="op" id="6202029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6202032">if</span>&nbsp;<span class="ident" id="6202035"><a href="/archive/tar/reader.go.html#6202006">err</a></span>&nbsp;<span class="op" id="6202039">!=</span>&nbsp;<span class="ident" id="6202042">nil</span>&nbsp;<span class="op" id="6202046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6202050">return</span>&nbsp;<span class="ident" id="6202057">nil</span><span class="op" id="6202060">,</span>&nbsp;<span class="ident" id="6202062"><a href="/archive/tar/reader.go.html#6202006">err</a></span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6202067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6202071">//&nbsp;For&nbsp;GNU&nbsp;PAX&nbsp;sparse&nbsp;format&nbsp;0.0&nbsp;support.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6202114">//&nbsp;This&nbsp;function&nbsp;transforms&nbsp;the&nbsp;sparse&nbsp;format&nbsp;0.0&nbsp;headers&nbsp;into&nbsp;sparse&nbsp;format&nbsp;0.1&nbsp;headers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6202205">var</span>&nbsp;<span class="ident" id="6202209">sparseMap</span>&nbsp;<span class="ident" id="6202219"><a href="/archive/tar/reader.go.html#6193663">bytes</a></span><span class="op" id="6202224">.</span><span class="ident" id="6202225">Buffer</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202234">headers</span>&nbsp;<span class="op" id="6202242">:=</span>&nbsp;<span class="builtinfunc" id="6202245">make</span><span class="op" id="6202249">(</span><span class="keyword" id="6202250">map</span><span class="op" id="6202253">[</span><span class="builtintype" id="6202254">string</span><span class="op" id="6202260">]</span><span class="builtintype" id="6202261">string</span><span class="op" id="6202267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6202270">//&nbsp;Each&nbsp;record&nbsp;is&nbsp;constructed&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6202304">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;%d&nbsp;%s=%s\n&#34;,&nbsp;length,&nbsp;keyword,&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6202349">for</span>&nbsp;<span class="builtinfunc" id="6202353">len</span><span class="op" id="6202356">(</span><span class="ident" id="6202357"><a href="/archive/tar/reader.go.html#6202001">buf</a></span><span class="op" id="6202360">)</span>&nbsp;<span class="op" id="6202362">&gt;</span>&nbsp;<span class="num" id="6202364">0</span>&nbsp;<span class="op" id="6202366">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6202370">//&nbsp;or&nbsp;the&nbsp;header&nbsp;was&nbsp;empty&nbsp;to&nbsp;start&nbsp;with.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6202414">var</span>&nbsp;<span class="ident" id="6202418">sp</span>&nbsp;<span class="builtintype" id="6202421">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6202427">//&nbsp;The&nbsp;size&nbsp;field&nbsp;ends&nbsp;at&nbsp;the&nbsp;first&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202472"><a href="/archive/tar/reader.go.html#6202418">sp</a></span>&nbsp;<span class="op" id="6202475">=</span>&nbsp;<span class="ident" id="6202477"><a href="/archive/tar/reader.go.html#6193663">bytes</a></span><span class="op" id="6202482">.</span><span class="ident" id="6202483">IndexByte</span><span class="op" id="6202492">(</span><span class="ident" id="6202493"><a href="/archive/tar/reader.go.html#6202001">buf</a></span><span class="op" id="6202496">,</span>&nbsp;<span class="string" id="6202498">&#39;&nbsp;&#39;</span><span class="op" id="6202501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6202505">if</span>&nbsp;<span class="ident" id="6202508"><a href="/archive/tar/reader.go.html#6202418">sp</a></span>&nbsp;<span class="op" id="6202511">==</span>&nbsp;<span class="op" id="6202514">-</span><span class="num" id="6202515">1</span>&nbsp;<span class="op" id="6202517">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6202522">return</span>&nbsp;<span class="ident" id="6202529">nil</span><span class="op" id="6202532">,</span>&nbsp;<span class="ident" id="6202534"><a href="/archive/tar/reader.go.html#6193746">ErrHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6202546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6202550">//&nbsp;Parse&nbsp;the&nbsp;first&nbsp;token&nbsp;as&nbsp;a&nbsp;decimal&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202599">n</span><span class="op" id="6202600">,</span>&nbsp;<span class="ident" id="6202602">err</span>&nbsp;<span class="op" id="6202606">:=</span>&nbsp;<span class="ident" id="6202609"><a href="/archive/tar/reader.go.html#6193707">strconv</a></span><span class="op" id="6202616">.</span><span class="ident" id="6202617">ParseInt</span><span class="op" id="6202625">(</span><span class="builtintype" id="6202626">string</span><span class="op" id="6202632">(</span><span class="ident" id="6202633"><a href="/archive/tar/reader.go.html#6202001">buf</a></span><span class="op" id="6202636">[</span><span class="op" id="6202637">:</span><span class="ident" id="6202638"><a href="/archive/tar/reader.go.html#6202418">sp</a></span><span class="op" id="6202640">]</span><span class="op" id="6202641">)</span><span class="op" id="6202642">,</span>&nbsp;<span class="num" id="6202644">10</span><span class="op" id="6202646">,</span>&nbsp;<span class="num" id="6202648">0</span><span class="op" id="6202649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6202653">if</span>&nbsp;<span class="ident" id="6202656"><a href="/archive/tar/reader.go.html#6202602">err</a></span>&nbsp;<span class="op" id="6202660">!=</span>&nbsp;<span class="ident" id="6202663">nil</span>&nbsp;<span class="op" id="6202667">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6202672">return</span>&nbsp;<span class="ident" id="6202679">nil</span><span class="op" id="6202682">,</span>&nbsp;<span class="ident" id="6202684"><a href="/archive/tar/reader.go.html#6193746">ErrHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6202696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6202700">//&nbsp;Extract&nbsp;everything&nbsp;between&nbsp;the&nbsp;decimal&nbsp;and&nbsp;the&nbsp;n&nbsp;-1&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6202764">//&nbsp;beginning&nbsp;to&nbsp;eat&nbsp;the&nbsp;&#39;&nbsp;&#39;,&nbsp;-1&nbsp;on&nbsp;the&nbsp;end&nbsp;to&nbsp;skip&nbsp;the&nbsp;newline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6202830">var</span>&nbsp;<span class="ident" id="6202834">record</span>&nbsp;<span class="op" id="6202841">[</span><span class="op" id="6202842">]</span><span class="builtintype" id="6202843">byte</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202850"><a href="/archive/tar/reader.go.html#6202834">record</a></span><span class="op" id="6202856">,</span>&nbsp;<span class="ident" id="6202858"><a href="/archive/tar/reader.go.html#6202001">buf</a></span>&nbsp;<span class="op" id="6202862">=</span>&nbsp;<span class="ident" id="6202864"><a href="/archive/tar/reader.go.html#6202001">buf</a></span><span class="op" id="6202867">[</span><span class="ident" id="6202868"><a href="/archive/tar/reader.go.html#6202418">sp</a></span><span class="op" id="6202870">+</span><span class="num" id="6202871">1</span><span class="op" id="6202872">:</span><span class="ident" id="6202873"><a href="/archive/tar/reader.go.html#6202599">n</a></span><span class="op" id="6202874">-</span><span class="num" id="6202875">1</span><span class="op" id="6202876">]</span><span class="op" id="6202877">,</span>&nbsp;<span class="ident" id="6202879"><a href="/archive/tar/reader.go.html#6202001">buf</a></span><span class="op" id="6202882">[</span><span class="ident" id="6202883"><a href="/archive/tar/reader.go.html#6202599">n</a></span><span class="op" id="6202884">:</span><span class="op" id="6202885">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6202889">//&nbsp;The&nbsp;first&nbsp;equals&nbsp;is&nbsp;guaranteed&nbsp;to&nbsp;mark&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6202953">//&nbsp;Everything&nbsp;else&nbsp;is&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6202984">eq</span>&nbsp;<span class="op" id="6202987">:=</span>&nbsp;<span class="ident" id="6202990"><a href="/archive/tar/reader.go.html#6193663">bytes</a></span><span class="op" id="6202995">.</span><span class="ident" id="6202996">IndexByte</span><span class="op" id="6203005">(</span><span class="ident" id="6203006"><a href="/archive/tar/reader.go.html#6202834">record</a></span><span class="op" id="6203012">,</span>&nbsp;<span class="string" id="6203014">&#39;=&#39;</span><span class="op" id="6203017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203021">if</span>&nbsp;<span class="ident" id="6203024"><a href="/archive/tar/reader.go.html#6202984">eq</a></span>&nbsp;<span class="op" id="6203027">==</span>&nbsp;<span class="op" id="6203030">-</span><span class="num" id="6203031">1</span>&nbsp;<span class="op" id="6203033">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203038">return</span>&nbsp;<span class="ident" id="6203045">nil</span><span class="op" id="6203048">,</span>&nbsp;<span class="ident" id="6203050"><a href="/archive/tar/reader.go.html#6193746">ErrHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6203062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203066">key</span><span class="op" id="6203069">,</span>&nbsp;<span class="ident" id="6203071">value</span>&nbsp;<span class="op" id="6203077">:=</span>&nbsp;<span class="ident" id="6203080"><a href="/archive/tar/reader.go.html#6202834">record</a></span><span class="op" id="6203086">[</span><span class="op" id="6203087">:</span><span class="ident" id="6203088"><a href="/archive/tar/reader.go.html#6202984">eq</a></span><span class="op" id="6203090">]</span><span class="op" id="6203091">,</span>&nbsp;<span class="ident" id="6203093"><a href="/archive/tar/reader.go.html#6202834">record</a></span><span class="op" id="6203099">[</span><span class="ident" id="6203100"><a href="/archive/tar/reader.go.html#6202984">eq</a></span><span class="op" id="6203102">+</span><span class="num" id="6203103">1</span><span class="op" id="6203104">:</span><span class="op" id="6203105">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203110">keyStr</span>&nbsp;<span class="op" id="6203117">:=</span>&nbsp;<span class="builtintype" id="6203120">string</span><span class="op" id="6203126">(</span><span class="ident" id="6203127"><a href="/archive/tar/reader.go.html#6203066">key</a></span><span class="op" id="6203130">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203134">if</span>&nbsp;<span class="ident" id="6203137"><a href="/archive/tar/reader.go.html#6203110">keyStr</a></span>&nbsp;<span class="op" id="6203144">==</span>&nbsp;<span class="ident" id="6203147"><a href="/archive/tar/reader.go.html#6195227">paxGNUSparseOffset</a></span>&nbsp;<span class="op" id="6203166">||</span>&nbsp;<span class="ident" id="6203169"><a href="/archive/tar/reader.go.html#6203110">keyStr</a></span>&nbsp;<span class="op" id="6203176">==</span>&nbsp;<span class="ident" id="6203179"><a href="/archive/tar/reader.go.html#6195272">paxGNUSparseNumBytes</a></span>&nbsp;<span class="op" id="6203200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6203205">//&nbsp;GNU&nbsp;sparse&nbsp;format&nbsp;0.0&nbsp;special&nbsp;key.&nbsp;Write&nbsp;to&nbsp;sparseMap&nbsp;instead&nbsp;of&nbsp;using&nbsp;the&nbsp;headers&nbsp;map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203299"><a href="/archive/tar/reader.go.html#6202209">sparseMap</a></span><span class="op" id="6203308">.</span><span class="ident" id="6203309">Write</span><span class="op" id="6203314">(</span><span class="ident" id="6203315"><a href="/archive/tar/reader.go.html#6203071">value</a></span><span class="op" id="6203320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203325"><a href="/archive/tar/reader.go.html#6202209">sparseMap</a></span><span class="op" id="6203334">.</span><span class="ident" id="6203335">Write</span><span class="op" id="6203340">(</span><span class="op" id="6203341">[</span><span class="op" id="6203342">]</span><span class="builtintype" id="6203343">byte</span><span class="op" id="6203347">{</span><span class="string" id="6203348">&#39;,&#39;</span><span class="op" id="6203351">}</span><span class="op" id="6203352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6203356">}</span>&nbsp;<span class="keyword" id="6203358">else</span>&nbsp;<span class="op" id="6203363">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6203368">//&nbsp;Normal&nbsp;key.&nbsp;Set&nbsp;the&nbsp;value&nbsp;in&nbsp;the&nbsp;headers&nbsp;map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203420"><a href="/archive/tar/reader.go.html#6202234">headers</a></span><span class="op" id="6203427">[</span><span class="ident" id="6203428"><a href="/archive/tar/reader.go.html#6203110">keyStr</a></span><span class="op" id="6203434">]</span>&nbsp;<span class="op" id="6203436">=</span>&nbsp;<span class="builtintype" id="6203438">string</span><span class="op" id="6203444">(</span><span class="ident" id="6203445"><a href="/archive/tar/reader.go.html#6203071">value</a></span><span class="op" id="6203450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6203454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6203457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203460">if</span>&nbsp;<span class="ident" id="6203463"><a href="/archive/tar/reader.go.html#6202209">sparseMap</a></span><span class="op" id="6203472">.</span><span class="ident" id="6203473">Len</span><span class="op" id="6203476">(</span><span class="op" id="6203477">)</span>&nbsp;<span class="op" id="6203479">!=</span>&nbsp;<span class="num" id="6203482">0</span>&nbsp;<span class="op" id="6203484">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6203488">//&nbsp;Add&nbsp;sparse&nbsp;info&nbsp;to&nbsp;headers,&nbsp;chopping&nbsp;off&nbsp;the&nbsp;extra&nbsp;comma</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203550"><a href="/archive/tar/reader.go.html#6202209">sparseMap</a></span><span class="op" id="6203559">.</span><span class="ident" id="6203560">Truncate</span><span class="op" id="6203568">(</span><span class="ident" id="6203569"><a href="/archive/tar/reader.go.html#6202209">sparseMap</a></span><span class="op" id="6203578">.</span><span class="ident" id="6203579">Len</span><span class="op" id="6203582">(</span><span class="op" id="6203583">)</span>&nbsp;<span class="op" id="6203585">-</span>&nbsp;<span class="num" id="6203587">1</span><span class="op" id="6203588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203592"><a href="/archive/tar/reader.go.html#6202234">headers</a></span><span class="op" id="6203599">[</span><span class="ident" id="6203600"><a href="/archive/tar/reader.go.html#6195319">paxGNUSparseMap</a></span><span class="op" id="6203615">]</span>&nbsp;<span class="op" id="6203617">=</span>&nbsp;<span class="ident" id="6203619"><a href="/archive/tar/reader.go.html#6202209">sparseMap</a></span><span class="op" id="6203628">.</span><span class="ident" id="6203629">String</span><span class="op" id="6203635">(</span><span class="op" id="6203636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6203639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203642">return</span>&nbsp;<span class="ident" id="6203649"><a href="/archive/tar/reader.go.html#6202234">headers</a></span><span class="op" id="6203656">,</span>&nbsp;<span class="ident" id="6203658">nil</span><br>
<span class="lineno">365</span><span class="op" id="6203662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6203665">//&nbsp;cString&nbsp;parses&nbsp;bytes&nbsp;as&nbsp;a&nbsp;NUL-terminated&nbsp;C-style&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="6203725">//&nbsp;If&nbsp;a&nbsp;NUL&nbsp;byte&nbsp;is&nbsp;not&nbsp;found&nbsp;then&nbsp;the&nbsp;whole&nbsp;slice&nbsp;is&nbsp;returned&nbsp;as&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="6203801">func</span>&nbsp;<span class="ident" id="6203806">cString</span><span class="op" id="6203813">(</span><span class="ident" id="6203814">b</span>&nbsp;<span class="op" id="6203816">[</span><span class="op" id="6203817">]</span><span class="builtintype" id="6203818">byte</span><span class="op" id="6203822">)</span>&nbsp;<span class="builtintype" id="6203824">string</span>&nbsp;<span class="op" id="6203831">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203834">n</span>&nbsp;<span class="op" id="6203836">:=</span>&nbsp;<span class="num" id="6203839">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203842">for</span>&nbsp;<span class="ident" id="6203846"><a href="/archive/tar/reader.go.html#6203834">n</a></span>&nbsp;<span class="op" id="6203848">&lt;</span>&nbsp;<span class="builtinfunc" id="6203850">len</span><span class="op" id="6203853">(</span><span class="ident" id="6203854"><a href="/archive/tar/reader.go.html#6203814">b</a></span><span class="op" id="6203855">)</span>&nbsp;<span class="op" id="6203857">&amp;&amp;</span>&nbsp;<span class="ident" id="6203860"><a href="/archive/tar/reader.go.html#6203814">b</a></span><span class="op" id="6203861">[</span><span class="ident" id="6203862"><a href="/archive/tar/reader.go.html#6203834">n</a></span><span class="op" id="6203863">]</span>&nbsp;<span class="op" id="6203865">!=</span>&nbsp;<span class="num" id="6203868">0</span>&nbsp;<span class="op" id="6203870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6203874"><a href="/archive/tar/reader.go.html#6203834">n</a></span><span class="op" id="6203875">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6203879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203882">return</span>&nbsp;<span class="builtintype" id="6203889">string</span><span class="op" id="6203895">(</span><span class="ident" id="6203896"><a href="/archive/tar/reader.go.html#6203814">b</a></span><span class="op" id="6203897">[</span><span class="num" id="6203898">0</span><span class="op" id="6203899">:</span><span class="ident" id="6203900"><a href="/archive/tar/reader.go.html#6203834">n</a></span><span class="op" id="6203901">]</span><span class="op" id="6203902">)</span><br>
<span class="lineno">375</span><span class="op" id="6203904">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6203907">func</span>&nbsp;<span class="op" id="6203912">(</span><span class="ident" id="6203913">tr</span>&nbsp;<span class="op" id="6203916">*</span><span class="ident" id="6203917"><a href="/archive/tar/reader.go.html#6194123">Reader</a></span><span class="op" id="6203923">)</span>&nbsp;<span class="ident" id="6203925">octal</span><span class="op" id="6203930">(</span><span class="ident" id="6203931">b</span>&nbsp;<span class="op" id="6203933">[</span><span class="op" id="6203934">]</span><span class="builtintype" id="6203935">byte</span><span class="op" id="6203939">)</span>&nbsp;<span class="ident" id="6203941">int64</span>&nbsp;<span class="op" id="6203947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6203950">//&nbsp;Check&nbsp;for&nbsp;binary&nbsp;format&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6203985">if</span>&nbsp;<span class="builtinfunc" id="6203988">len</span><span class="op" id="6203991">(</span><span class="ident" id="6203992"><a href="/archive/tar/reader.go.html#6203931">b</a></span><span class="op" id="6203993">)</span>&nbsp;<span class="op" id="6203995">&gt;</span>&nbsp;<span class="num" id="6203997">0</span>&nbsp;<span class="op" id="6203999">&amp;&amp;</span>&nbsp;<span class="ident" id="6204002"><a href="/archive/tar/reader.go.html#6203931">b</a></span><span class="op" id="6204003">[</span><span class="num" id="6204004">0</span><span class="op" id="6204005">]</span><span class="op" id="6204006">&amp;</span><span class="num" id="6204007">0x80</span>&nbsp;<span class="op" id="6204012">!=</span>&nbsp;<span class="num" id="6204015">0</span>&nbsp;<span class="op" id="6204017">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204021">var</span>&nbsp;<span class="ident" id="6204025">x</span>&nbsp;<span class="ident" id="6204027">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204035">for</span>&nbsp;<span class="ident" id="6204039">i</span><span class="op" id="6204040">,</span>&nbsp;<span class="ident" id="6204042">c</span>&nbsp;<span class="op" id="6204044">:=</span>&nbsp;<span class="keyword" id="6204047">range</span>&nbsp;<span class="ident" id="6204053"><a href="/archive/tar/reader.go.html#6203931">b</a></span>&nbsp;<span class="op" id="6204055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204060">if</span>&nbsp;<span class="ident" id="6204063"><a href="/archive/tar/reader.go.html#6204039">i</a></span>&nbsp;<span class="op" id="6204065">==</span>&nbsp;<span class="num" id="6204068">0</span>&nbsp;<span class="op" id="6204070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6204076"><a href="/archive/tar/reader.go.html#6204042">c</a></span>&nbsp;<span class="op" id="6204078">&amp;=</span>&nbsp;<span class="num" id="6204081">0x7f</span>&nbsp;<span class="comment" id="6204086">//&nbsp;ignore&nbsp;signal&nbsp;bit&nbsp;in&nbsp;first&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6204124">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6204129"><a href="/archive/tar/reader.go.html#6204025">x</a></span>&nbsp;<span class="op" id="6204131">=</span>&nbsp;<span class="ident" id="6204133"><a href="/archive/tar/reader.go.html#6204025">x</a></span><span class="op" id="6204134">&lt;&lt;</span><span class="num" id="6204136">8</span>&nbsp;<span class="op" id="6204138">|</span>&nbsp;<span class="ident" id="6204140">int64</span><span class="op" id="6204145">(</span><span class="ident" id="6204146"><a href="/archive/tar/reader.go.html#6204042">c</a></span><span class="op" id="6204147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6204151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204155">return</span>&nbsp;<span class="ident" id="6204162"><a href="/archive/tar/reader.go.html#6204025">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6204165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6204169">//&nbsp;Because&nbsp;unused&nbsp;fields&nbsp;are&nbsp;filled&nbsp;with&nbsp;NULs,&nbsp;we&nbsp;need</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6204225">//&nbsp;to&nbsp;skip&nbsp;leading&nbsp;NULs.&nbsp;Fields&nbsp;may&nbsp;also&nbsp;be&nbsp;padded&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6204282">//&nbsp;spaces&nbsp;or&nbsp;NULs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6204302">//&nbsp;So&nbsp;we&nbsp;remove&nbsp;leading&nbsp;and&nbsp;trailing&nbsp;NULs&nbsp;and&nbsp;spaces&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6204359">//&nbsp;be&nbsp;sure.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6204372"><a href="/archive/tar/reader.go.html#6203931">b</a></span>&nbsp;<span class="op" id="6204374">=</span>&nbsp;<span class="ident" id="6204376"><a href="/archive/tar/reader.go.html#6193663">bytes</a></span><span class="op" id="6204381">.</span><span class="ident" id="6204382">Trim</span><span class="op" id="6204386">(</span><span class="ident" id="6204387"><a href="/archive/tar/reader.go.html#6203931">b</a></span><span class="op" id="6204388">,</span>&nbsp;<span class="string" id="6204390">&#34;&nbsp;\x00&#34;</span><span class="op" id="6204397">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204401">if</span>&nbsp;<span class="builtinfunc" id="6204404">len</span><span class="op" id="6204407">(</span><span class="ident" id="6204408"><a href="/archive/tar/reader.go.html#6203931">b</a></span><span class="op" id="6204409">)</span>&nbsp;<span class="op" id="6204411">==</span>&nbsp;<span class="num" id="6204414">0</span>&nbsp;<span class="op" id="6204416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204420">return</span>&nbsp;<span class="num" id="6204427">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6204430">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6204433">x</span><span class="op" id="6204434">,</span>&nbsp;<span class="ident" id="6204436">err</span>&nbsp;<span class="op" id="6204440">:=</span>&nbsp;<span class="ident" id="6204443"><a href="/archive/tar/reader.go.html#6193707">strconv</a></span><span class="op" id="6204450">.</span><span class="ident" id="6204451">ParseUint</span><span class="op" id="6204460">(</span><span class="ident" id="6204461"><a href="/archive/tar/reader.go.html#6203806">cString</a></span><span class="op" id="6204468">(</span><span class="ident" id="6204469"><a href="/archive/tar/reader.go.html#6203931">b</a></span><span class="op" id="6204470">)</span><span class="op" id="6204471">,</span>&nbsp;<span class="num" id="6204473">8</span><span class="op" id="6204474">,</span>&nbsp;<span class="num" id="6204476">64</span><span class="op" id="6204478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204481">if</span>&nbsp;<span class="ident" id="6204484"><a href="/archive/tar/reader.go.html#6204436">err</a></span>&nbsp;<span class="op" id="6204488">!=</span>&nbsp;<span class="ident" id="6204491">nil</span>&nbsp;<span class="op" id="6204495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6204499"><a href="/archive/tar/reader.go.html#6203913">tr</a></span><span class="op" id="6204501">.</span><span class="ident" id="6204502">err</span>&nbsp;<span class="op" id="6204506">=</span>&nbsp;<span class="ident" id="6204508"><a href="/archive/tar/reader.go.html#6204436">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6204513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204516">return</span>&nbsp;<span class="ident" id="6204523">int64</span><span class="op" id="6204528">(</span><span class="ident" id="6204529"><a href="/archive/tar/reader.go.html#6204433">x</a></span><span class="op" id="6204530">)</span><br>
<span class="lineno">405</span><span class="op" id="6204532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6204535">//&nbsp;skipUnread&nbsp;skips&nbsp;any&nbsp;unread&nbsp;bytes&nbsp;in&nbsp;the&nbsp;existing&nbsp;file&nbsp;entry,&nbsp;as&nbsp;well&nbsp;as&nbsp;any&nbsp;alignment&nbsp;padding.</span><br>
<span class="lineno"></span><span class="keyword" id="6204634">func</span>&nbsp;<span class="op" id="6204639">(</span><span class="ident" id="6204640">tr</span>&nbsp;<span class="op" id="6204643">*</span><span class="ident" id="6204644"><a href="/archive/tar/reader.go.html#6194123">Reader</a></span><span class="op" id="6204650">)</span>&nbsp;<span class="ident" id="6204652">skipUnread</span><span class="op" id="6204662">(</span><span class="op" id="6204663">)</span>&nbsp;<span class="op" id="6204665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6204668">nr</span>&nbsp;<span class="op" id="6204671">:=</span>&nbsp;<span class="ident" id="6204674"><a href="/archive/tar/reader.go.html#6204640">tr</a></span><span class="op" id="6204676">.</span><span class="ident" id="6204677">numBytes</span><span class="op" id="6204685">(</span><span class="op" id="6204686">)</span>&nbsp;<span class="op" id="6204688">+</span>&nbsp;<span class="ident" id="6204690"><a href="/archive/tar/reader.go.html#6204640">tr</a></span><span class="op" id="6204692">.</span><span class="ident" id="6204693">pad</span>&nbsp;<span class="comment" id="6204697">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;to&nbsp;skip</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6204725"><a href="/archive/tar/reader.go.html#6204640">tr</a></span><span class="op" id="6204727">.</span><span class="ident" id="6204728">curr</span><span class="op" id="6204732">,</span>&nbsp;<span class="ident" id="6204734"><a href="/archive/tar/reader.go.html#6204640">tr</a></span><span class="op" id="6204736">.</span><span class="ident" id="6204737">pad</span>&nbsp;<span class="op" id="6204741">=</span>&nbsp;<span class="ident" id="6204743">nil</span><span class="op" id="6204746">,</span>&nbsp;<span class="num" id="6204748">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204751">if</span>&nbsp;<span class="ident" id="6204754">sr</span><span class="op" id="6204756">,</span>&nbsp;<span class="ident" id="6204758">ok</span>&nbsp;<span class="op" id="6204761">:=</span>&nbsp;<span class="ident" id="6204764"><a href="/archive/tar/reader.go.html#6204640">tr</a></span><span class="op" id="6204766">.</span><span class="ident" id="6204767">r</span><span class="op" id="6204768">.</span><span class="op" id="6204769">(</span><span class="ident" id="6204770"><a href="/archive/tar/reader.go.html#6193682">io</a></span><span class="op" id="6204772">.</span><span class="ident" id="6204773">Seeker</span><span class="op" id="6204779">)</span><span class="op" id="6204780">;</span>&nbsp;<span class="ident" id="6204782"><a href="/archive/tar/reader.go.html#6204758">ok</a></span>&nbsp;<span class="op" id="6204785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204789">if</span>&nbsp;<span class="ident" id="6204792">_</span><span class="op" id="6204793">,</span>&nbsp;<span class="ident" id="6204795">err</span>&nbsp;<span class="op" id="6204799">:=</span>&nbsp;<span class="ident" id="6204802"><a href="/archive/tar/reader.go.html#6204754">sr</a></span><span class="op" id="6204804">.</span><span class="ident" id="6204805">Seek</span><span class="op" id="6204809">(</span><span class="ident" id="6204810"><a href="/archive/tar/reader.go.html#6204668">nr</a></span><span class="op" id="6204812">,</span>&nbsp;<span class="ident" id="6204814"><a href="/archive/tar/reader.go.html#6193701">os</a></span><span class="op" id="6204816">.</span><span class="ident" id="6204817">SEEK_CUR</span><span class="op" id="6204825">)</span><span class="op" id="6204826">;</span>&nbsp;<span class="ident" id="6204828"><a href="/archive/tar/reader.go.html#6204795">err</a></span>&nbsp;<span class="op" id="6204832">==</span>&nbsp;<span class="ident" id="6204835">nil</span>&nbsp;<span class="op" id="6204839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204844">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6204853">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6204856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6204859">_</span><span class="op" id="6204860">,</span>&nbsp;<span class="ident" id="6204862"><a href="/archive/tar/reader.go.html#6204640">tr</a></span><span class="op" id="6204864">.</span><span class="ident" id="6204865">err</span>&nbsp;<span class="op" id="6204869">=</span>&nbsp;<span class="ident" id="6204871"><a href="/archive/tar/reader.go.html#6193682">io</a></span><span class="op" id="6204873">.</span><span class="ident" id="6204874">CopyN</span><span class="op" id="6204879">(</span><span class="ident" id="6204880"><a href="/archive/tar/reader.go.html#6193688">ioutil</a></span><span class="op" id="6204886">.</span><span class="ident" id="6204887">Discard</span><span class="op" id="6204894">,</span>&nbsp;<span class="ident" id="6204896"><a href="/archive/tar/reader.go.html#6204640">tr</a></span><span class="op" id="6204898">.</span><span class="ident" id="6204899">r</span><span class="op" id="6204900">,</span>&nbsp;<span class="ident" id="6204902"><a href="/archive/tar/reader.go.html#6204668">nr</a></span><span class="op" id="6204904">)</span><br>
<span class="lineno"></span><span class="op" id="6204906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6204909">func</span>&nbsp;<span class="op" id="6204914">(</span><span class="ident" id="6204915">tr</span>&nbsp;<span class="op" id="6204918">*</span><span class="ident" id="6204919"><a href="/archive/tar/reader.go.html#6194123">Reader</a></span><span class="op" id="6204925">)</span>&nbsp;<span class="ident" id="6204927">verifyChecksum</span><span class="op" id="6204941">(</span><span class="ident" id="6204942">header</span>&nbsp;<span class="op" id="6204949">[</span><span class="op" id="6204950">]</span><span class="builtintype" id="6204951">byte</span><span class="op" id="6204955">)</span>&nbsp;<span class="builtintype" id="6204957">bool</span>&nbsp;<span class="op" id="6204962">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204965">if</span>&nbsp;<span class="ident" id="6204968"><a href="/archive/tar/reader.go.html#6204915">tr</a></span><span class="op" id="6204970">.</span><span class="ident" id="6204971">err</span>&nbsp;<span class="op" id="6204975">!=</span>&nbsp;<span class="ident" id="6204978">nil</span>&nbsp;<span class="op" id="6204982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6204986">return</span>&nbsp;<span class="builtintype" id="6204993">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6205000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205004">given</span>&nbsp;<span class="op" id="6205010">:=</span>&nbsp;<span class="ident" id="6205013"><a href="/archive/tar/reader.go.html#6204915">tr</a></span><span class="op" id="6205015">.</span><span class="ident" id="6205016">octal</span><span class="op" id="6205021">(</span><span class="ident" id="6205022"><a href="/archive/tar/reader.go.html#6204942">header</a></span><span class="op" id="6205028">[</span><span class="num" id="6205029">148</span><span class="op" id="6205032">:</span><span class="num" id="6205033">156</span><span class="op" id="6205036">]</span><span class="op" id="6205037">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205040">unsigned</span><span class="op" id="6205048">,</span>&nbsp;<span class="ident" id="6205050">signed</span>&nbsp;<span class="op" id="6205057">:=</span>&nbsp;<span class="ident" id="6205060"><a href="/archive/tar/common.go.html#6192691">checksum</a></span><span class="op" id="6205068">(</span><span class="ident" id="6205069"><a href="/archive/tar/reader.go.html#6204942">header</a></span><span class="op" id="6205075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205078">return</span>&nbsp;<span class="ident" id="6205085"><a href="/archive/tar/reader.go.html#6205004">given</a></span>&nbsp;<span class="op" id="6205091">==</span>&nbsp;<span class="ident" id="6205094"><a href="/archive/tar/reader.go.html#6205040">unsigned</a></span>&nbsp;<span class="op" id="6205103">||</span>&nbsp;<span class="ident" id="6205106"><a href="/archive/tar/reader.go.html#6205004">given</a></span>&nbsp;<span class="op" id="6205112">==</span>&nbsp;<span class="ident" id="6205115"><a href="/archive/tar/reader.go.html#6205050">signed</a></span><br>
<span class="lineno"></span><span class="op" id="6205122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6205125">func</span>&nbsp;<span class="op" id="6205130">(</span><span class="ident" id="6205131">tr</span>&nbsp;<span class="op" id="6205134">*</span><span class="ident" id="6205135"><a href="/archive/tar/reader.go.html#6194123">Reader</a></span><span class="op" id="6205141">)</span>&nbsp;<span class="ident" id="6205143">readHeader</span><span class="op" id="6205153">(</span><span class="op" id="6205154">)</span>&nbsp;<span class="op" id="6205156">*</span><span class="ident" id="6205157"><a href="/archive/tar/common.go.html#6187053">Header</a></span>&nbsp;<span class="op" id="6205164">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205167">header</span>&nbsp;<span class="op" id="6205174">:=</span>&nbsp;<span class="ident" id="6205177"><a href="/archive/tar/reader.go.html#6205131">tr</a></span><span class="op" id="6205179">.</span><span class="ident" id="6205180">hdrBuff</span><span class="op" id="6205187">[</span><span class="op" id="6205188">:</span><span class="op" id="6205189">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6205192">copy</span><span class="op" id="6205196">(</span><span class="ident" id="6205197"><a href="/archive/tar/reader.go.html#6205167">header</a></span><span class="op" id="6205203">,</span>&nbsp;<span class="ident" id="6205205"><a href="/archive/tar/common.go.html#6192523">zeroBlock</a></span><span class="op" id="6205214">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205218">if</span>&nbsp;<span class="ident" id="6205221">_</span><span class="op" id="6205222">,</span>&nbsp;<span class="ident" id="6205224"><a href="/archive/tar/reader.go.html#6205131">tr</a></span><span class="op" id="6205226">.</span><span class="ident" id="6205227">err</span>&nbsp;<span class="op" id="6205231">=</span>&nbsp;<span class="ident" id="6205233"><a href="/archive/tar/reader.go.html#6193682">io</a></span><span class="op" id="6205235">.</span><span class="ident" id="6205236">ReadFull</span><span class="op" id="6205244">(</span><span class="ident" id="6205245"><a href="/archive/tar/reader.go.html#6205131">tr</a></span><span class="op" id="6205247">.</span><span class="ident" id="6205248">r</span><span class="op" id="6205249">,</span>&nbsp;<span class="ident" id="6205251"><a href="/archive/tar/reader.go.html#6205167">header</a></span><span class="op" id="6205257">)</span><span class="op" id="6205258">;</span>&nbsp;<span class="ident" id="6205260"><a href="/archive/tar/reader.go.html#6205131">tr</a></span><span class="op" id="6205262">.</span><span class="ident" id="6205263">err</span>&nbsp;<span class="op" id="6205267">!=</span>&nbsp;<span class="ident" id="6205270">nil</span>&nbsp;<span class="op" id="6205274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205278">return</span>&nbsp;<span class="ident" id="6205285">nil</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6205290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6205294">//&nbsp;Two&nbsp;blocks&nbsp;of&nbsp;zero&nbsp;bytes&nbsp;marks&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;archive.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205353">if</span>&nbsp;<span class="ident" id="6205356"><a href="/archive/tar/reader.go.html#6193663">bytes</a></span><span class="op" id="6205361">.</span><span class="ident" id="6205362">Equal</span><span class="op" id="6205367">(</span><span class="ident" id="6205368"><a href="/archive/tar/reader.go.html#6205167">header</a></span><span class="op" id="6205374">,</span>&nbsp;<span class="ident" id="6205376"><a href="/archive/tar/common.go.html#6192523">zeroBlock</a></span><span class="op" id="6205385">[</span><span class="num" id="6205386">0</span><span class="op" id="6205387">:</span><span class="ident" id="6205388"><a href="/archive/tar/common.go.html#6186250">blockSize</a></span><span class="op" id="6205397">]</span><span class="op" id="6205398">)</span>&nbsp;<span class="op" id="6205400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205404">if</span>&nbsp;<span class="ident" id="6205407">_</span><span class="op" id="6205408">,</span>&nbsp;<span class="ident" id="6205410"><a href="/archive/tar/reader.go.html#6205131">tr</a></span><span class="op" id="6205412">.</span><span class="ident" id="6205413">err</span>&nbsp;<span class="op" id="6205417">=</span>&nbsp;<span class="ident" id="6205419"><a href="/archive/tar/reader.go.html#6193682">io</a></span><span class="op" id="6205421">.</span><span class="ident" id="6205422">ReadFull</span><span class="op" id="6205430">(</span><span class="ident" id="6205431"><a href="/archive/tar/reader.go.html#6205131">tr</a></span><span class="op" id="6205433">.</span><span class="ident" id="6205434">r</span><span class="op" id="6205435">,</span>&nbsp;<span class="ident" id="6205437"><a href="/archive/tar/reader.go.html#6205167">header</a></span><span class="op" id="6205443">)</span><span class="op" id="6205444">;</span>&nbsp;<span class="ident" id="6205446"><a href="/archive/tar/reader.go.html#6205131">tr</a></span><span class="op" id="6205448">.</span><span class="ident" id="6205449">err</span>&nbsp;<span class="op" id="6205453">!=</span>&nbsp;<span class="ident" id="6205456">nil</span>&nbsp;<span class="op" id="6205460">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205465">return</span>&nbsp;<span class="ident" id="6205472">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6205478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205482">if</span>&nbsp;<span class="ident" id="6205485"><a href="/archive/tar/reader.go.html#6193663">bytes</a></span><span class="op" id="6205490">.</span><span class="ident" id="6205491">Equal</span><span class="op" id="6205496">(</span><span class="ident" id="6205497"><a href="/archive/tar/reader.go.html#6205167">header</a></span><span class="op" id="6205503">,</span>&nbsp;<span class="ident" id="6205505"><a href="/archive/tar/common.go.html#6192523">zeroBlock</a></span><span class="op" id="6205514">[</span><span class="num" id="6205515">0</span><span class="op" id="6205516">:</span><span class="ident" id="6205517"><a href="/archive/tar/common.go.html#6186250">blockSize</a></span><span class="op" id="6205526">]</span><span class="op" id="6205527">)</span>&nbsp;<span class="op" id="6205529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205534"><a href="/archive/tar/reader.go.html#6205131">tr</a></span><span class="op" id="6205536">.</span><span class="ident" id="6205537">err</span>&nbsp;<span class="op" id="6205541">=</span>&nbsp;<span class="ident" id="6205543"><a href="/archive/tar/reader.go.html#6193682">io</a></span><span class="op" id="6205545">.</span><span class="ident" id="6205546">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6205552">}</span>&nbsp;<span class="keyword" id="6205554">else</span>&nbsp;<span class="op" id="6205559">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205564"><a href="/archive/tar/reader.go.html#6205131">tr</a></span><span class="op" id="6205566">.</span><span class="ident" id="6205567">err</span>&nbsp;<span class="op" id="6205571">=</span>&nbsp;<span class="ident" id="6205573"><a href="/archive/tar/reader.go.html#6193746">ErrHeader</a></span>&nbsp;<span class="comment" id="6205583">//&nbsp;zero&nbsp;block&nbsp;and&nbsp;then&nbsp;non-zero&nbsp;block</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6205623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205627">return</span>&nbsp;<span class="ident" id="6205634">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6205639">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205643">if</span>&nbsp;<span class="op" id="6205646">!</span><span class="ident" id="6205647"><a href="/archive/tar/reader.go.html#6205131">tr</a></span><span class="op" id="6205649">.</span><span class="ident" id="6205650">verifyChecksum</span><span class="op" id="6205664">(</span><span class="ident" id="6205665"><a href="/archive/tar/reader.go.html#6205167">header</a></span><span class="op" id="6205671">)</span>&nbsp;<span class="op" id="6205673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205677"><a href="/archive/tar/reader.go.html#6205131">tr</a></span><span class="op" id="6205679">.</span><span class="ident" id="6205680">err</span>&nbsp;<span class="op" id="6205684">=</span>&nbsp;<span class="ident" id="6205686"><a href="/archive/tar/reader.go.html#6193746">ErrHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6205698">return</span>&nbsp;<span class="ident" id="6205705">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6205710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6205714">//&nbsp;Unpack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205725">hdr</span>&nbsp;<span class="op" id="6205729">:=</span>&nbsp;<span class="builtinfunc" id="6205732">new</span><span class="op" id="6205735">(</span><span class="ident" id="6205736"><a href="/archive/tar/common.go.html#6187053">Header</a></span><span class="op" id="6205742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205745">s</span>&nbsp;<span class="op" id="6205747">:=</span>&nbsp;<span class="ident" id="6205750"><a href="/archive/tar/common.go.html#6193045">slicer</a></span><span class="op" id="6205756">(</span><span class="ident" id="6205757"><a href="/archive/tar/reader.go.html#6205167">header</a></span><span class="op" id="6205763">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205767"><a href="/archive/tar/reader.go.html#6205725">hdr</a></span><span class="op" id="6205770">.</span><span class="ident" id="6205771">Name</span>&nbsp;<span class="op" id="6205776">=</span>&nbsp;<span class="ident" id="6205778"><a href="/archive/tar/reader.go.html#6203806">cString</a></span><span class="op" id="6205785">(</span><span class="ident" id="6205786"><a href="/archive/tar/reader.go.html#6205745">s</a></span><span class="op" id="6205787">.</span><span class="ident" id="6205788">next</span><span class="op" id="6205792">(</span><span class="num" id="6205793">100</span><span class="op" id="6205796">)</span><span class="op" id="6205797">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205800"><a href="/archive/tar/reader.go.html#6205725">hdr</a></span><span class="op" id="6205803">.</span><span class="ident" id="6205804">Mode</span>&nbsp;<span class="op" id="6205809">=</span>&nbsp;<span class="ident" id="6205811"><a href="/archive/tar/reader.go.html#6205131">tr</a></span><span class="op" id="6205813">.</span><span class="ident" id="6205814">octal</span><span class="op" id="6205819">(</span><span class="ident" id="6205820"><a href="/archive/tar/reader.go.html#6205745">s</a></span><span class="op" id="6205821">.</span><span class="ident" id="6205822">next</span><span class="op" id="6205826">(</span><span class="num" id="6205827">8</span><span class="op" id="6205828">)</span><span class="op" id="6205829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205832"><a href="/archive/tar/reader.go.html#6205725">hdr</a></span><span class="op" id="6205835">.</span><span class="ident" id="6205836">Uid</span>&nbsp;<span class="op" id="6205840">=</span>&nbsp;<span class="builtintype" id="6205842">int</span><span class="op" id="6205845">(</span><span class="ident" id="6205846"><a href="/archive/tar/reader.go.html#6205131">tr</a></span><span class="op" id="6205848">.</span><span class="ident" id="6205849">octal</span><span class="op" id="6205854">(</span><span class="ident" id="6205855"><a href="/archive/tar/reader.go.html#6205745">s</a></span><span class="op" id="6205856">.</span><span class="ident" id="6205857">next</span><span class="op" id="6205861">(</span><span class="num" id="6205862">8</span><span class="op" id="6205863">)</span><span class="op" id="6205864">)</span><span class="op" id="6205865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205868"><a href="/archive/tar/reader.go.html#6205725">hdr</a></span><span class="op" id="6205871">.</span><span class="ident" id="6205872">Gid</span>&nbsp;<span class="op" id="6205876">=</span>&nbsp;<span class="builtintype" id="6205878">int</span><span class="op" id="6205881">(</span><span class="ident" id="6205882"><a href="/archive/tar/reader.go.html#6205131">tr</a></span><span class="op" id="6205884">.</span><span class="ident" id="6205885">octal</span><span class="op" id="6205890">(</span><span class="ident" id="6205891"><a href="/archive/tar/reader.go.html#6205745">s</a></span><span class="op" id="6205892">.</span><span class="ident" id="6205893">next</span><span class="op" id="6205897">(</span><span class="num" id="6205898">8</span><span class="op" id="6205899">)</span><span class="op" id="6205900">)</span><span class="op" id="6205901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205904"><a href="/archive/tar/reader.go.html#6205725">hdr</a></span><span class="op" id="6205907">.</span><span class="ident" id="6205908">Size</span>&nbsp;<span class="op" id="6205913">=</span>&nbsp;<span class="ident" id="6205915"><a href="/archive/tar/reader.go.html#6205131">tr</a></span><span class="op" id="6205917">.</span><span class="ident" id="6205918">octal</span><span class="op" id="6205923">(</span><span class="ident" id="6205924"><a href="/archive/tar/reader.go.html#6205745">s</a></span><span class="op" id="6205925">.</span><span class="ident" id="6205926">next</span><span class="op" id="6205930">(</span><span class="num" id="6205931">12</span><span class="op" id="6205933">)</span><span class="op" id="6205934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205937"><a href="/archive/tar/reader.go.html#6205725">hdr</a></span><span class="op" id="6205940">.</span><span class="ident" id="6205941">ModTime</span>&nbsp;<span class="op" id="6205949">=</span>&nbsp;<span class="ident" id="6205951"><a href="/archive/tar/reader.go.html#6193729">time</a></span><span class="op" id="6205955">.</span><span class="ident" id="6205956">Unix</span><span class="op" id="6205960">(</span><span class="ident" id="6205961"><a href="/archive/tar/reader.go.html#6205131">tr</a></span><span class="op" id="6205963">.</span><span class="ident" id="6205964">octal</span><span class="op" id="6205969">(</span><span class="ident" id="6205970"><a href="/archive/tar/reader.go.html#6205745">s</a></span><span class="op" id="6205971">.</span><span class="ident" id="6205972">next</span><span class="op" id="6205976">(</span><span class="num" id="6205977">12</span><span class="op" id="6205979">)</span><span class="op" id="6205980">)</span><span class="op" id="6205981">,</span>&nbsp;<span class="num" id="6205983">0</span><span class="op" id="6205984">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6205987"><a href="/archive/tar/reader.go.html#6205745">s</a></span><span class="op" id="6205988">.</span><span class="ident" id="6205989">next</span><span class="op" id="6205993">(</span><span class="num" id="6205994">8</span><span class="op" id="6205995">)</span>&nbsp;<span class="comment" id="6205997">//&nbsp;chksum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206008"><a href="/archive/tar/reader.go.html#6205725">hdr</a></span><span class="op" id="6206011">.</span><span class="ident" id="6206012">Typeflag</span>&nbsp;<span class="op" id="6206021">=</span>&nbsp;<span class="ident" id="6206023"><a href="/archive/tar/reader.go.html#6205745">s</a></span><span class="op" id="6206024">.</span><span class="ident" id="6206025">next</span><span class="op" id="6206029">(</span><span class="num" id="6206030">1</span><span class="op" id="6206031">)</span><span class="op" id="6206032">[</span><span class="num" id="6206033">0</span><span class="op" id="6206034">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206037"><a href="/archive/tar/reader.go.html#6205725">hdr</a></span><span class="op" id="6206040">.</span><span class="ident" id="6206041">Linkname</span>&nbsp;<span class="op" id="6206050">=</span>&nbsp;<span class="ident" id="6206052"><a href="/archive/tar/reader.go.html#6203806">cString</a></span><span class="op" id="6206059">(</span><span class="ident" id="6206060"><a href="/archive/tar/reader.go.html#6205745">s</a></span><span class="op" id="6206061">.</span><span class="ident" id="6206062">next</span><span class="op" id="6206066">(</span><span class="num" id="6206067">100</span><span class="op" id="6206070">)</span><span class="op" id="6206071">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6206075">//&nbsp;The&nbsp;remainder&nbsp;of&nbsp;the&nbsp;header&nbsp;depends&nbsp;on&nbsp;the&nbsp;value&nbsp;of&nbsp;magic.</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6206138">//&nbsp;The&nbsp;original&nbsp;(v7)&nbsp;version&nbsp;of&nbsp;tar&nbsp;had&nbsp;no&nbsp;explicit&nbsp;magic&nbsp;field,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6206204">//&nbsp;so&nbsp;its&nbsp;magic&nbsp;bytes,&nbsp;like&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;block,&nbsp;are&nbsp;NULs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206266">magic</span>&nbsp;<span class="op" id="6206272">:=</span>&nbsp;<span class="builtintype" id="6206275">string</span><span class="op" id="6206281">(</span><span class="ident" id="6206282"><a href="/archive/tar/reader.go.html#6205745">s</a></span><span class="op" id="6206283">.</span><span class="ident" id="6206284">next</span><span class="op" id="6206288">(</span><span class="num" id="6206289">8</span><span class="op" id="6206290">)</span><span class="op" id="6206291">)</span>&nbsp;<span class="comment" id="6206293">//&nbsp;contains&nbsp;version&nbsp;field&nbsp;as&nbsp;well.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206329">var</span>&nbsp;<span class="ident" id="6206333">format</span>&nbsp;<span class="builtintype" id="6206340">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206348">switch</span>&nbsp;<span class="op" id="6206355">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206358">case</span>&nbsp;<span class="ident" id="6206363"><a href="/archive/tar/reader.go.html#6206266">magic</a></span><span class="op" id="6206368">[</span><span class="op" id="6206369">:</span><span class="num" id="6206370">6</span><span class="op" id="6206371">]</span>&nbsp;<span class="op" id="6206373">==</span>&nbsp;<span class="string" id="6206376">&#34;ustar\x00&#34;</span><span class="op" id="6206387">:</span>&nbsp;<span class="comment" id="6206389">//&nbsp;POSIX&nbsp;tar&nbsp;(1003.1-1988)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206418">if</span>&nbsp;<span class="builtintype" id="6206421">string</span><span class="op" id="6206427">(</span><span class="ident" id="6206428"><a href="/archive/tar/reader.go.html#6205167">header</a></span><span class="op" id="6206434">[</span><span class="num" id="6206435">508</span><span class="op" id="6206438">:</span><span class="num" id="6206439">512</span><span class="op" id="6206442">]</span><span class="op" id="6206443">)</span>&nbsp;<span class="op" id="6206445">==</span>&nbsp;<span class="string" id="6206448">&#34;tar\x00&#34;</span>&nbsp;<span class="op" id="6206458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206463"><a href="/archive/tar/reader.go.html#6206333">format</a></span>&nbsp;<span class="op" id="6206470">=</span>&nbsp;<span class="string" id="6206472">&#34;star&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6206481">}</span>&nbsp;<span class="keyword" id="6206483">else</span>&nbsp;<span class="op" id="6206488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206493"><a href="/archive/tar/reader.go.html#6206333">format</a></span>&nbsp;<span class="op" id="6206500">=</span>&nbsp;<span class="string" id="6206502">&#34;posix&#34;</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6206512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206515">case</span>&nbsp;<span class="ident" id="6206520"><a href="/archive/tar/reader.go.html#6206266">magic</a></span>&nbsp;<span class="op" id="6206526">==</span>&nbsp;<span class="string" id="6206529">&#34;ustar&nbsp;&nbsp;\x00&#34;</span><span class="op" id="6206542">:</span>&nbsp;<span class="comment" id="6206544">//&nbsp;old&nbsp;GNU&nbsp;tar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206561"><a href="/archive/tar/reader.go.html#6206333">format</a></span>&nbsp;<span class="op" id="6206568">=</span>&nbsp;<span class="string" id="6206570">&#34;gnu&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6206577">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206581">switch</span>&nbsp;<span class="ident" id="6206588"><a href="/archive/tar/reader.go.html#6206333">format</a></span>&nbsp;<span class="op" id="6206595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206598">case</span>&nbsp;<span class="string" id="6206603">&#34;posix&#34;</span><span class="op" id="6206610">,</span>&nbsp;<span class="string" id="6206612">&#34;gnu&#34;</span><span class="op" id="6206617">,</span>&nbsp;<span class="string" id="6206619">&#34;star&#34;</span><span class="op" id="6206625">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206629"><a href="/archive/tar/reader.go.html#6205725">hdr</a></span><span class="op" id="6206632">.</span><span class="ident" id="6206633">Uname</span>&nbsp;<span class="op" id="6206639">=</span>&nbsp;<span class="ident" id="6206641"><a href="/archive/tar/reader.go.html#6203806">cString</a></span><span class="op" id="6206648">(</span><span class="ident" id="6206649"><a href="/archive/tar/reader.go.html#6205745">s</a></span><span class="op" id="6206650">.</span><span class="ident" id="6206651">next</span><span class="op" id="6206655">(</span><span class="num" id="6206656">32</span><span class="op" id="6206658">)</span><span class="op" id="6206659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206663"><a href="/archive/tar/reader.go.html#6205725">hdr</a></span><span class="op" id="6206666">.</span><span class="ident" id="6206667">Gname</span>&nbsp;<span class="op" id="6206673">=</span>&nbsp;<span class="ident" id="6206675"><a href="/archive/tar/reader.go.html#6203806">cString</a></span><span class="op" id="6206682">(</span><span class="ident" id="6206683"><a href="/archive/tar/reader.go.html#6205745">s</a></span><span class="op" id="6206684">.</span><span class="ident" id="6206685">next</span><span class="op" id="6206689">(</span><span class="num" id="6206690">32</span><span class="op" id="6206692">)</span><span class="op" id="6206693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206697">devmajor</span>&nbsp;<span class="op" id="6206706">:=</span>&nbsp;<span class="ident" id="6206709"><a href="/archive/tar/reader.go.html#6205745">s</a></span><span class="op" id="6206710">.</span><span class="ident" id="6206711">next</span><span class="op" id="6206715">(</span><span class="num" id="6206716">8</span><span class="op" id="6206717">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206721">devminor</span>&nbsp;<span class="op" id="6206730">:=</span>&nbsp;<span class="ident" id="6206733"><a href="/archive/tar/reader.go.html#6205745">s</a></span><span class="op" id="6206734">.</span><span class="ident" id="6206735">next</span><span class="op" id="6206739">(</span><span class="num" id="6206740">8</span><span class="op" id="6206741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206745">if</span>&nbsp;<span class="ident" id="6206748"><a href="/archive/tar/reader.go.html#6205725">hdr</a></span><span class="op" id="6206751">.</span><span class="ident" id="6206752">Typeflag</span>&nbsp;<span class="op" id="6206761">==</span>&nbsp;<span class="ident" id="6206764"><a href="/archive/tar/common.go.html#6186452">TypeChar</a></span>&nbsp;<span class="op" id="6206773">||</span>&nbsp;<span class="ident" id="6206776"><a href="/archive/tar/reader.go.html#6205725">hdr</a></span><span class="op" id="6206779">.</span><span class="ident" id="6206780">Typeflag</span>&nbsp;<span class="op" id="6206789">==</span>&nbsp;<span class="ident" id="6206792"><a href="/archive/tar/common.go.html#6186505">TypeBlock</a></span>&nbsp;<span class="op" id="6206802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206807"><a href="/archive/tar/reader.go.html#6205725">hdr</a></span><span class="op" id="6206810">.</span><span class="ident" id="6206811">Devmajor</span>&nbsp;<span class="op" id="6206820">=</span>&nbsp;<span class="ident" id="6206822"><a href="/archive/tar/reader.go.html#6205131">tr</a></span><span class="op" id="6206824">.</span><span class="ident" id="6206825">octal</span><span class="op" id="6206830">(</span><span class="ident" id="6206831"><a href="/archive/tar/reader.go.html#6206697">devmajor</a></span><span class="op" id="6206839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206844"><a href="/archive/tar/reader.go.html#6205725">hdr</a></span><span class="op" id="6206847">.</span><span class="ident" id="6206848">Devminor</span>&nbsp;<span class="op" id="6206857">=</span>&nbsp;<span class="ident" id="6206859"><a href="/archive/tar/reader.go.html#6205131">tr</a></span><span class="op" id="6206861">.</span><span class="ident" id="6206862">octal</span><span class="op" id="6206867">(</span><span class="ident" id="6206868"><a href="/archive/tar/reader.go.html#6206721">devminor</a></span><span class="op" id="6206876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6206880">}</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206884">var</span>&nbsp;<span class="ident" id="6206888">prefix</span>&nbsp;<span class="builtintype" id="6206895">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206904">switch</span>&nbsp;<span class="ident" id="6206911"><a href="/archive/tar/reader.go.html#6206333">format</a></span>&nbsp;<span class="op" id="6206918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206922">case</span>&nbsp;<span class="string" id="6206927">&#34;posix&#34;</span><span class="op" id="6206934">,</span>&nbsp;<span class="string" id="6206936">&#34;gnu&#34;</span><span class="op" id="6206941">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206946"><a href="/archive/tar/reader.go.html#6206888">prefix</a></span>&nbsp;<span class="op" id="6206953">=</span>&nbsp;<span class="ident" id="6206955"><a href="/archive/tar/reader.go.html#6203806">cString</a></span><span class="op" id="6206962">(</span><span class="ident" id="6206963"><a href="/archive/tar/reader.go.html#6205745">s</a></span><span class="op" id="6206964">.</span><span class="ident" id="6206965">next</span><span class="op" id="6206969">(</span><span class="num" id="6206970">155</span><span class="op" id="6206973">)</span><span class="op" id="6206974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6206978">case</span>&nbsp;<span class="string" id="6206983">&#34;star&#34;</span><span class="op" id="6206989">:</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6206994"><a href="/archive/tar/reader.go.html#6206888">prefix</a></span>&nbsp;<span class="op" id="6207001">=</span>&nbsp;<span class="ident" id="6207003"><a href="/archive/tar/reader.go.html#6203806">cString</a></span><span class="op" id="6207010">(</span><span class="ident" id="6207011"><a href="/archive/tar/reader.go.html#6205745">s</a></span><span class="op" id="6207012">.</span><span class="ident" id="6207013">next</span><span class="op" id="6207017">(</span><span class="num" id="6207018">131</span><span class="op" id="6207021">)</span><span class="op" id="6207022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207027"><a href="/archive/tar/reader.go.html#6205725">hdr</a></span><span class="op" id="6207030">.</span><span class="ident" id="6207031">AccessTime</span>&nbsp;<span class="op" id="6207042">=</span>&nbsp;<span class="ident" id="6207044"><a href="/archive/tar/reader.go.html#6193729">time</a></span><span class="op" id="6207048">.</span><span class="ident" id="6207049">Unix</span><span class="op" id="6207053">(</span><span class="ident" id="6207054"><a href="/archive/tar/reader.go.html#6205131">tr</a></span><span class="op" id="6207056">.</span><span class="ident" id="6207057">octal</span><span class="op" id="6207062">(</span><span class="ident" id="6207063"><a href="/archive/tar/reader.go.html#6205745">s</a></span><span class="op" id="6207064">.</span><span class="ident" id="6207065">next</span><span class="op" id="6207069">(</span><span class="num" id="6207070">12</span><span class="op" id="6207072">)</span><span class="op" id="6207073">)</span><span class="op" id="6207074">,</span>&nbsp;<span class="num" id="6207076">0</span><span class="op" id="6207077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207082"><a href="/archive/tar/reader.go.html#6205725">hdr</a></span><span class="op" id="6207085">.</span><span class="ident" id="6207086">ChangeTime</span>&nbsp;<span class="op" id="6207097">=</span>&nbsp;<span class="ident" id="6207099"><a href="/archive/tar/reader.go.html#6193729">time</a></span><span class="op" id="6207103">.</span><span class="ident" id="6207104">Unix</span><span class="op" id="6207108">(</span><span class="ident" id="6207109"><a href="/archive/tar/reader.go.html#6205131">tr</a></span><span class="op" id="6207111">.</span><span class="ident" id="6207112">octal</span><span class="op" id="6207117">(</span><span class="ident" id="6207118"><a href="/archive/tar/reader.go.html#6205745">s</a></span><span class="op" id="6207119">.</span><span class="ident" id="6207120">next</span><span class="op" id="6207124">(</span><span class="num" id="6207125">12</span><span class="op" id="6207127">)</span><span class="op" id="6207128">)</span><span class="op" id="6207129">,</span>&nbsp;<span class="num" id="6207131">0</span><span class="op" id="6207132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6207136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207140">if</span>&nbsp;<span class="builtinfunc" id="6207143">len</span><span class="op" id="6207146">(</span><span class="ident" id="6207147"><a href="/archive/tar/reader.go.html#6206888">prefix</a></span><span class="op" id="6207153">)</span>&nbsp;<span class="op" id="6207155">&gt;</span>&nbsp;<span class="num" id="6207157">0</span>&nbsp;<span class="op" id="6207159">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207164"><a href="/archive/tar/reader.go.html#6205725">hdr</a></span><span class="op" id="6207167">.</span><span class="ident" id="6207168">Name</span>&nbsp;<span class="op" id="6207173">=</span>&nbsp;<span class="ident" id="6207175"><a href="/archive/tar/reader.go.html#6206888">prefix</a></span>&nbsp;<span class="op" id="6207182">+</span>&nbsp;<span class="string" id="6207184">&#34;/&#34;</span>&nbsp;<span class="op" id="6207188">+</span>&nbsp;<span class="ident" id="6207190"><a href="/archive/tar/reader.go.html#6205725">hdr</a></span><span class="op" id="6207193">.</span><span class="ident" id="6207194">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6207201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6207204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207208">if</span>&nbsp;<span class="ident" id="6207211"><a href="/archive/tar/reader.go.html#6205131">tr</a></span><span class="op" id="6207213">.</span><span class="ident" id="6207214">err</span>&nbsp;<span class="op" id="6207218">!=</span>&nbsp;<span class="ident" id="6207221">nil</span>&nbsp;<span class="op" id="6207225">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207229"><a href="/archive/tar/reader.go.html#6205131">tr</a></span><span class="op" id="6207231">.</span><span class="ident" id="6207232">err</span>&nbsp;<span class="op" id="6207236">=</span>&nbsp;<span class="ident" id="6207238"><a href="/archive/tar/reader.go.html#6193746">ErrHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207250">return</span>&nbsp;<span class="ident" id="6207257">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6207262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6207266">//&nbsp;Maximum&nbsp;value&nbsp;of&nbsp;hdr.Size&nbsp;is&nbsp;64&nbsp;GB&nbsp;(12&nbsp;octal&nbsp;digits),</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6207324">//&nbsp;so&nbsp;there&#39;s&nbsp;no&nbsp;risk&nbsp;of&nbsp;int64&nbsp;overflowing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207369">nb</span>&nbsp;<span class="op" id="6207372">:=</span>&nbsp;<span class="ident" id="6207375">int64</span><span class="op" id="6207380">(</span><span class="ident" id="6207381"><a href="/archive/tar/reader.go.html#6205725">hdr</a></span><span class="op" id="6207384">.</span><span class="ident" id="6207385">Size</span><span class="op" id="6207389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207392"><a href="/archive/tar/reader.go.html#6205131">tr</a></span><span class="op" id="6207394">.</span><span class="ident" id="6207395">pad</span>&nbsp;<span class="op" id="6207399">=</span>&nbsp;<span class="op" id="6207401">-</span><span class="ident" id="6207402"><a href="/archive/tar/reader.go.html#6207369">nb</a></span>&nbsp;<span class="op" id="6207405">&amp;</span>&nbsp;<span class="op" id="6207407">(</span><span class="ident" id="6207408"><a href="/archive/tar/common.go.html#6186250">blockSize</a></span>&nbsp;<span class="op" id="6207418">-</span>&nbsp;<span class="num" id="6207420">1</span><span class="op" id="6207421">)</span>&nbsp;<span class="comment" id="6207423">//&nbsp;blockSize&nbsp;is&nbsp;a&nbsp;power&nbsp;of&nbsp;two</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6207456">//&nbsp;Set&nbsp;the&nbsp;current&nbsp;file&nbsp;reader.</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207489"><a href="/archive/tar/reader.go.html#6205131">tr</a></span><span class="op" id="6207491">.</span><span class="ident" id="6207492">curr</span>&nbsp;<span class="op" id="6207497">=</span>&nbsp;<span class="op" id="6207499">&amp;</span><span class="ident" id="6207500"><a href="/archive/tar/reader.go.html#6194656">regFileReader</a></span><span class="op" id="6207513">{</span><span class="ident" id="6207514">r</span><span class="op" id="6207515">:</span>&nbsp;<span class="ident" id="6207517"><a href="/archive/tar/reader.go.html#6205131">tr</a></span><span class="op" id="6207519">.</span><span class="ident" id="6207520">r</span><span class="op" id="6207521">,</span>&nbsp;<span class="ident" id="6207523">nb</span><span class="op" id="6207525">:</span>&nbsp;<span class="ident" id="6207527"><a href="/archive/tar/reader.go.html#6207369">nb</a></span><span class="op" id="6207529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6207533">//&nbsp;Check&nbsp;for&nbsp;old&nbsp;GNU&nbsp;sparse&nbsp;format&nbsp;entry.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207576">if</span>&nbsp;<span class="ident" id="6207579"><a href="/archive/tar/reader.go.html#6205725">hdr</a></span><span class="op" id="6207582">.</span><span class="ident" id="6207583">Typeflag</span>&nbsp;<span class="op" id="6207592">==</span>&nbsp;<span class="ident" id="6207595"><a href="/archive/tar/common.go.html#6186909">TypeGNUSparse</a></span>&nbsp;<span class="op" id="6207609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6207613">//&nbsp;Get&nbsp;the&nbsp;real&nbsp;size&nbsp;of&nbsp;the&nbsp;file.</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207649"><a href="/archive/tar/reader.go.html#6205725">hdr</a></span><span class="op" id="6207652">.</span><span class="ident" id="6207653">Size</span>&nbsp;<span class="op" id="6207658">=</span>&nbsp;<span class="ident" id="6207660"><a href="/archive/tar/reader.go.html#6205131">tr</a></span><span class="op" id="6207662">.</span><span class="ident" id="6207663">octal</span><span class="op" id="6207668">(</span><span class="ident" id="6207669"><a href="/archive/tar/reader.go.html#6205167">header</a></span><span class="op" id="6207675">[</span><span class="num" id="6207676">483</span><span class="op" id="6207679">:</span><span class="num" id="6207680">495</span><span class="op" id="6207683">]</span><span class="op" id="6207684">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6207689">//&nbsp;Read&nbsp;the&nbsp;sparse&nbsp;map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207715">sp</span>&nbsp;<span class="op" id="6207718">:=</span>&nbsp;<span class="ident" id="6207721"><a href="/archive/tar/reader.go.html#6205131">tr</a></span><span class="op" id="6207723">.</span><span class="ident" id="6207724">readOldGNUSparseMap</span><span class="op" id="6207743">(</span><span class="ident" id="6207744"><a href="/archive/tar/reader.go.html#6205167">header</a></span><span class="op" id="6207750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207754">if</span>&nbsp;<span class="ident" id="6207757"><a href="/archive/tar/reader.go.html#6205131">tr</a></span><span class="op" id="6207759">.</span><span class="ident" id="6207760">err</span>&nbsp;<span class="op" id="6207764">!=</span>&nbsp;<span class="ident" id="6207767">nil</span>&nbsp;<span class="op" id="6207771">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207776">return</span>&nbsp;<span class="ident" id="6207783">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6207789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6207793">//&nbsp;Current&nbsp;file&nbsp;is&nbsp;a&nbsp;GNU&nbsp;sparse&nbsp;file.&nbsp;Update&nbsp;the&nbsp;current&nbsp;file&nbsp;reader.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6207865"><a href="/archive/tar/reader.go.html#6205131">tr</a></span><span class="op" id="6207867">.</span><span class="ident" id="6207868">curr</span>&nbsp;<span class="op" id="6207873">=</span>&nbsp;<span class="op" id="6207875">&amp;</span><span class="ident" id="6207876"><a href="/archive/tar/reader.go.html#6194876">sparseFileReader</a></span><span class="op" id="6207892">{</span><span class="ident" id="6207893">rfr</span><span class="op" id="6207896">:</span>&nbsp;<span class="ident" id="6207898"><a href="/archive/tar/reader.go.html#6205131">tr</a></span><span class="op" id="6207900">.</span><span class="ident" id="6207901">curr</span><span class="op" id="6207905">.</span><span class="op" id="6207906">(</span><span class="op" id="6207907">*</span><span class="ident" id="6207908"><a href="/archive/tar/reader.go.html#6194656">regFileReader</a></span><span class="op" id="6207921">)</span><span class="op" id="6207922">,</span>&nbsp;<span class="ident" id="6207924">sp</span><span class="op" id="6207926">:</span>&nbsp;<span class="ident" id="6207928"><a href="/archive/tar/reader.go.html#6207715">sp</a></span><span class="op" id="6207930">,</span>&nbsp;<span class="ident" id="6207932">tot</span><span class="op" id="6207935">:</span>&nbsp;<span class="ident" id="6207937"><a href="/archive/tar/reader.go.html#6205725">hdr</a></span><span class="op" id="6207940">.</span><span class="ident" id="6207941">Size</span><span class="op" id="6207945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6207948">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6207952">return</span>&nbsp;<span class="ident" id="6207959"><a href="/archive/tar/reader.go.html#6205725">hdr</a></span><br>
<span class="lineno"></span><span class="op" id="6207963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6207966">//&nbsp;A&nbsp;sparseEntry&nbsp;holds&nbsp;a&nbsp;single&nbsp;entry&nbsp;in&nbsp;a&nbsp;sparse&nbsp;file&#39;s&nbsp;sparse&nbsp;map.</span><br>
<span class="lineno">540</span><span class="comment" id="6208035">//&nbsp;A&nbsp;sparse&nbsp;entry&nbsp;indicates&nbsp;the&nbsp;offset&nbsp;and&nbsp;size&nbsp;in&nbsp;a&nbsp;sparse&nbsp;file&nbsp;of&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="6208105">//&nbsp;block&nbsp;of&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="6208123">type</span>&nbsp;<span class="ident" id="6208128">sparseEntry</span>&nbsp;<span class="keyword" id="6208140">struct</span>&nbsp;<span class="op" id="6208147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6208150">offset</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6208159">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6208166">numBytes</span>&nbsp;<span class="ident" id="6208175">int64</span><br>
<span class="lineno">545</span><span class="op" id="6208181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6208184">//&nbsp;readOldGNUSparseMap&nbsp;reads&nbsp;the&nbsp;sparse&nbsp;map&nbsp;as&nbsp;stored&nbsp;in&nbsp;the&nbsp;old&nbsp;GNU&nbsp;sparse&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="6208268">//&nbsp;The&nbsp;sparse&nbsp;map&nbsp;is&nbsp;stored&nbsp;in&nbsp;the&nbsp;tar&nbsp;header&nbsp;if&nbsp;it&#39;s&nbsp;small&nbsp;enough.&nbsp;If&nbsp;it&#39;s&nbsp;larger&nbsp;than&nbsp;four&nbsp;entries,</span><br>
<span class="lineno"></span><span class="comment" id="6208370">//&nbsp;then&nbsp;one&nbsp;or&nbsp;more&nbsp;extension&nbsp;headers&nbsp;are&nbsp;used&nbsp;to&nbsp;store&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;sparse&nbsp;map.</span><br>
<span class="lineno">550</span><span class="keyword" id="6208454">func</span>&nbsp;<span class="op" id="6208459">(</span><span class="ident" id="6208460">tr</span>&nbsp;<span class="op" id="6208463">*</span><span class="ident" id="6208464"><a href="/archive/tar/reader.go.html#6194123">Reader</a></span><span class="op" id="6208470">)</span>&nbsp;<span class="ident" id="6208472">readOldGNUSparseMap</span><span class="op" id="6208491">(</span><span class="ident" id="6208492">header</span>&nbsp;<span class="op" id="6208499">[</span><span class="op" id="6208500">]</span><span class="builtintype" id="6208501">byte</span><span class="op" id="6208505">)</span>&nbsp;<span class="op" id="6208507">[</span><span class="op" id="6208508">]</span><span class="ident" id="6208509"><a href="/archive/tar/reader.go.html#6208128">sparseEntry</a></span>&nbsp;<span class="op" id="6208521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6208524">isExtended</span>&nbsp;<span class="op" id="6208535">:=</span>&nbsp;<span class="ident" id="6208538"><a href="/archive/tar/reader.go.html#6208492">header</a></span><span class="op" id="6208544">[</span><span class="ident" id="6208545"><a href="/archive/tar/reader.go.html#6195682">oldGNUSparseMainHeaderIsExtendedOffset</a></span><span class="op" id="6208583">]</span>&nbsp;<span class="op" id="6208585">!=</span>&nbsp;<span class="num" id="6208588">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6208591">spCap</span>&nbsp;<span class="op" id="6208597">:=</span>&nbsp;<span class="ident" id="6208600"><a href="/archive/tar/reader.go.html#6195732">oldGNUSparseMainHeaderNumEntries</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6208634">if</span>&nbsp;<span class="ident" id="6208637"><a href="/archive/tar/reader.go.html#6208524">isExtended</a></span>&nbsp;<span class="op" id="6208648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6208652"><a href="/archive/tar/reader.go.html#6208591">spCap</a></span>&nbsp;<span class="op" id="6208658">+=</span>&nbsp;<span class="ident" id="6208661"><a href="/archive/tar/reader.go.html#6195830">oldGNUSparseExtendedHeaderNumEntries</a></span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6208699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6208702">sp</span>&nbsp;<span class="op" id="6208705">:=</span>&nbsp;<span class="builtinfunc" id="6208708">make</span><span class="op" id="6208712">(</span><span class="op" id="6208713">[</span><span class="op" id="6208714">]</span><span class="ident" id="6208715"><a href="/archive/tar/reader.go.html#6208128">sparseEntry</a></span><span class="op" id="6208726">,</span>&nbsp;<span class="num" id="6208728">0</span><span class="op" id="6208729">,</span>&nbsp;<span class="ident" id="6208731"><a href="/archive/tar/reader.go.html#6208591">spCap</a></span><span class="op" id="6208736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6208739">s</span>&nbsp;<span class="op" id="6208741">:=</span>&nbsp;<span class="ident" id="6208744"><a href="/archive/tar/common.go.html#6193045">slicer</a></span><span class="op" id="6208750">(</span><span class="ident" id="6208751"><a href="/archive/tar/reader.go.html#6208492">header</a></span><span class="op" id="6208757">[</span><span class="ident" id="6208758"><a href="/archive/tar/reader.go.html#6195632">oldGNUSparseMainHeaderOffset</a></span><span class="op" id="6208786">:</span><span class="op" id="6208787">]</span><span class="op" id="6208788">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6208792">//&nbsp;Read&nbsp;the&nbsp;four&nbsp;entries&nbsp;from&nbsp;the&nbsp;main&nbsp;tar&nbsp;header</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6208843">for</span>&nbsp;<span class="ident" id="6208847">i</span>&nbsp;<span class="op" id="6208849">:=</span>&nbsp;<span class="num" id="6208852">0</span><span class="op" id="6208853">;</span>&nbsp;<span class="ident" id="6208855"><a href="/archive/tar/reader.go.html#6208847">i</a></span>&nbsp;<span class="op" id="6208857">&lt;</span>&nbsp;<span class="ident" id="6208859"><a href="/archive/tar/reader.go.html#6195732">oldGNUSparseMainHeaderNumEntries</a></span><span class="op" id="6208891">;</span>&nbsp;<span class="ident" id="6208893"><a href="/archive/tar/reader.go.html#6208847">i</a></span><span class="op" id="6208894">++</span>&nbsp;<span class="op" id="6208897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6208901">offset</span>&nbsp;<span class="op" id="6208908">:=</span>&nbsp;<span class="ident" id="6208911"><a href="/archive/tar/reader.go.html#6208460">tr</a></span><span class="op" id="6208913">.</span><span class="ident" id="6208914">octal</span><span class="op" id="6208919">(</span><span class="ident" id="6208920"><a href="/archive/tar/reader.go.html#6208739">s</a></span><span class="op" id="6208921">.</span><span class="ident" id="6208922">next</span><span class="op" id="6208926">(</span><span class="ident" id="6208927"><a href="/archive/tar/reader.go.html#6195879">oldGNUSparseOffsetSize</a></span><span class="op" id="6208949">)</span><span class="op" id="6208950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6208954">numBytes</span>&nbsp;<span class="op" id="6208963">:=</span>&nbsp;<span class="ident" id="6208966"><a href="/archive/tar/reader.go.html#6208460">tr</a></span><span class="op" id="6208968">.</span><span class="ident" id="6208969">octal</span><span class="op" id="6208974">(</span><span class="ident" id="6208975"><a href="/archive/tar/reader.go.html#6208739">s</a></span><span class="op" id="6208976">.</span><span class="ident" id="6208977">next</span><span class="op" id="6208981">(</span><span class="ident" id="6208982"><a href="/archive/tar/reader.go.html#6195928">oldGNUSparseNumBytesSize</a></span><span class="op" id="6209006">)</span><span class="op" id="6209007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209011">if</span>&nbsp;<span class="ident" id="6209014"><a href="/archive/tar/reader.go.html#6208460">tr</a></span><span class="op" id="6209016">.</span><span class="ident" id="6209017">err</span>&nbsp;<span class="op" id="6209021">!=</span>&nbsp;<span class="ident" id="6209024">nil</span>&nbsp;<span class="op" id="6209028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209033"><a href="/archive/tar/reader.go.html#6208460">tr</a></span><span class="op" id="6209035">.</span><span class="ident" id="6209036">err</span>&nbsp;<span class="op" id="6209040">=</span>&nbsp;<span class="ident" id="6209042"><a href="/archive/tar/reader.go.html#6193746">ErrHeader</a></span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209055">return</span>&nbsp;<span class="ident" id="6209062">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6209068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209072">if</span>&nbsp;<span class="ident" id="6209075"><a href="/archive/tar/reader.go.html#6208901">offset</a></span>&nbsp;<span class="op" id="6209082">==</span>&nbsp;<span class="num" id="6209085">0</span>&nbsp;<span class="op" id="6209087">&amp;&amp;</span>&nbsp;<span class="ident" id="6209090"><a href="/archive/tar/reader.go.html#6208954">numBytes</a></span>&nbsp;<span class="op" id="6209099">==</span>&nbsp;<span class="num" id="6209102">0</span>&nbsp;<span class="op" id="6209104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209109">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6209117">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209121"><a href="/archive/tar/reader.go.html#6208702">sp</a></span>&nbsp;<span class="op" id="6209124">=</span>&nbsp;<span class="builtinfunc" id="6209126">append</span><span class="op" id="6209132">(</span><span class="ident" id="6209133"><a href="/archive/tar/reader.go.html#6208702">sp</a></span><span class="op" id="6209135">,</span>&nbsp;<span class="ident" id="6209137"><a href="/archive/tar/reader.go.html#6208128">sparseEntry</a></span><span class="op" id="6209148">{</span><span class="ident" id="6209149">offset</span><span class="op" id="6209155">:</span>&nbsp;<span class="ident" id="6209157"><a href="/archive/tar/reader.go.html#6208901">offset</a></span><span class="op" id="6209163">,</span>&nbsp;<span class="ident" id="6209165">numBytes</span><span class="op" id="6209173">:</span>&nbsp;<span class="ident" id="6209175"><a href="/archive/tar/reader.go.html#6208954">numBytes</a></span><span class="op" id="6209183">}</span><span class="op" id="6209184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6209187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209191">for</span>&nbsp;<span class="ident" id="6209195"><a href="/archive/tar/reader.go.html#6208524">isExtended</a></span>&nbsp;<span class="op" id="6209206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6209210">//&nbsp;There&nbsp;are&nbsp;more&nbsp;entries.&nbsp;Read&nbsp;an&nbsp;extension&nbsp;header&nbsp;and&nbsp;parse&nbsp;its&nbsp;entries.</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209287">sparseHeader</span>&nbsp;<span class="op" id="6209300">:=</span>&nbsp;<span class="builtinfunc" id="6209303">make</span><span class="op" id="6209307">(</span><span class="op" id="6209308">[</span><span class="op" id="6209309">]</span><span class="builtintype" id="6209310">byte</span><span class="op" id="6209314">,</span>&nbsp;<span class="ident" id="6209316"><a href="/archive/tar/common.go.html#6186250">blockSize</a></span><span class="op" id="6209325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209329">if</span>&nbsp;<span class="ident" id="6209332">_</span><span class="op" id="6209333">,</span>&nbsp;<span class="ident" id="6209335"><a href="/archive/tar/reader.go.html#6208460">tr</a></span><span class="op" id="6209337">.</span><span class="ident" id="6209338">err</span>&nbsp;<span class="op" id="6209342">=</span>&nbsp;<span class="ident" id="6209344"><a href="/archive/tar/reader.go.html#6193682">io</a></span><span class="op" id="6209346">.</span><span class="ident" id="6209347">ReadFull</span><span class="op" id="6209355">(</span><span class="ident" id="6209356"><a href="/archive/tar/reader.go.html#6208460">tr</a></span><span class="op" id="6209358">.</span><span class="ident" id="6209359">r</span><span class="op" id="6209360">,</span>&nbsp;<span class="ident" id="6209362"><a href="/archive/tar/reader.go.html#6209287">sparseHeader</a></span><span class="op" id="6209374">)</span><span class="op" id="6209375">;</span>&nbsp;<span class="ident" id="6209377"><a href="/archive/tar/reader.go.html#6208460">tr</a></span><span class="op" id="6209379">.</span><span class="ident" id="6209380">err</span>&nbsp;<span class="op" id="6209384">!=</span>&nbsp;<span class="ident" id="6209387">nil</span>&nbsp;<span class="op" id="6209391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209396">return</span>&nbsp;<span class="ident" id="6209403">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6209409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209413"><a href="/archive/tar/reader.go.html#6208524">isExtended</a></span>&nbsp;<span class="op" id="6209424">=</span>&nbsp;<span class="ident" id="6209426"><a href="/archive/tar/reader.go.html#6209287">sparseHeader</a></span><span class="op" id="6209438">[</span><span class="ident" id="6209439"><a href="/archive/tar/reader.go.html#6195780">oldGNUSparseExtendedHeaderIsExtendedOffset</a></span><span class="op" id="6209481">]</span>&nbsp;<span class="op" id="6209483">!=</span>&nbsp;<span class="num" id="6209486">0</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209490"><a href="/archive/tar/reader.go.html#6208739">s</a></span>&nbsp;<span class="op" id="6209492">=</span>&nbsp;<span class="ident" id="6209494"><a href="/archive/tar/common.go.html#6193045">slicer</a></span><span class="op" id="6209500">(</span><span class="ident" id="6209501"><a href="/archive/tar/reader.go.html#6209287">sparseHeader</a></span><span class="op" id="6209513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209517">for</span>&nbsp;<span class="ident" id="6209521">i</span>&nbsp;<span class="op" id="6209523">:=</span>&nbsp;<span class="num" id="6209526">0</span><span class="op" id="6209527">;</span>&nbsp;<span class="ident" id="6209529"><a href="/archive/tar/reader.go.html#6209521">i</a></span>&nbsp;<span class="op" id="6209531">&lt;</span>&nbsp;<span class="ident" id="6209533"><a href="/archive/tar/reader.go.html#6195830">oldGNUSparseExtendedHeaderNumEntries</a></span><span class="op" id="6209569">;</span>&nbsp;<span class="ident" id="6209571"><a href="/archive/tar/reader.go.html#6209521">i</a></span><span class="op" id="6209572">++</span>&nbsp;<span class="op" id="6209575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209580">offset</span>&nbsp;<span class="op" id="6209587">:=</span>&nbsp;<span class="ident" id="6209590"><a href="/archive/tar/reader.go.html#6208460">tr</a></span><span class="op" id="6209592">.</span><span class="ident" id="6209593">octal</span><span class="op" id="6209598">(</span><span class="ident" id="6209599"><a href="/archive/tar/reader.go.html#6208739">s</a></span><span class="op" id="6209600">.</span><span class="ident" id="6209601">next</span><span class="op" id="6209605">(</span><span class="ident" id="6209606"><a href="/archive/tar/reader.go.html#6195879">oldGNUSparseOffsetSize</a></span><span class="op" id="6209628">)</span><span class="op" id="6209629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209634">numBytes</span>&nbsp;<span class="op" id="6209643">:=</span>&nbsp;<span class="ident" id="6209646"><a href="/archive/tar/reader.go.html#6208460">tr</a></span><span class="op" id="6209648">.</span><span class="ident" id="6209649">octal</span><span class="op" id="6209654">(</span><span class="ident" id="6209655"><a href="/archive/tar/reader.go.html#6208739">s</a></span><span class="op" id="6209656">.</span><span class="ident" id="6209657">next</span><span class="op" id="6209661">(</span><span class="ident" id="6209662"><a href="/archive/tar/reader.go.html#6195928">oldGNUSparseNumBytesSize</a></span><span class="op" id="6209686">)</span><span class="op" id="6209687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209692">if</span>&nbsp;<span class="ident" id="6209695"><a href="/archive/tar/reader.go.html#6208460">tr</a></span><span class="op" id="6209697">.</span><span class="ident" id="6209698">err</span>&nbsp;<span class="op" id="6209702">!=</span>&nbsp;<span class="ident" id="6209705">nil</span>&nbsp;<span class="op" id="6209709">{</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209715"><a href="/archive/tar/reader.go.html#6208460">tr</a></span><span class="op" id="6209717">.</span><span class="ident" id="6209718">err</span>&nbsp;<span class="op" id="6209722">=</span>&nbsp;<span class="ident" id="6209724"><a href="/archive/tar/reader.go.html#6193746">ErrHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209738">return</span>&nbsp;<span class="ident" id="6209745">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6209752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209757">if</span>&nbsp;<span class="ident" id="6209760"><a href="/archive/tar/reader.go.html#6209580">offset</a></span>&nbsp;<span class="op" id="6209767">==</span>&nbsp;<span class="num" id="6209770">0</span>&nbsp;<span class="op" id="6209772">&amp;&amp;</span>&nbsp;<span class="ident" id="6209775"><a href="/archive/tar/reader.go.html#6209634">numBytes</a></span>&nbsp;<span class="op" id="6209784">==</span>&nbsp;<span class="num" id="6209787">0</span>&nbsp;<span class="op" id="6209789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209795">break</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6209804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6209809"><a href="/archive/tar/reader.go.html#6208702">sp</a></span>&nbsp;<span class="op" id="6209812">=</span>&nbsp;<span class="builtinfunc" id="6209814">append</span><span class="op" id="6209820">(</span><span class="ident" id="6209821"><a href="/archive/tar/reader.go.html#6208702">sp</a></span><span class="op" id="6209823">,</span>&nbsp;<span class="ident" id="6209825"><a href="/archive/tar/reader.go.html#6208128">sparseEntry</a></span><span class="op" id="6209836">{</span><span class="ident" id="6209837">offset</span><span class="op" id="6209843">:</span>&nbsp;<span class="ident" id="6209845"><a href="/archive/tar/reader.go.html#6209580">offset</a></span><span class="op" id="6209851">,</span>&nbsp;<span class="ident" id="6209853">numBytes</span><span class="op" id="6209861">:</span>&nbsp;<span class="ident" id="6209863"><a href="/archive/tar/reader.go.html#6209634">numBytes</a></span><span class="op" id="6209871">}</span><span class="op" id="6209872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6209876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6209879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6209882">return</span>&nbsp;<span class="ident" id="6209889"><a href="/archive/tar/reader.go.html#6208702">sp</a></span><br>
<span class="lineno">595</span><span class="op" id="6209892">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6209895">//&nbsp;readGNUSparseMap1x0&nbsp;reads&nbsp;the&nbsp;sparse&nbsp;map&nbsp;as&nbsp;stored&nbsp;in&nbsp;GNU&#39;s&nbsp;PAX&nbsp;sparse&nbsp;format&nbsp;version&nbsp;1.0.</span><br>
<span class="lineno"></span><span class="comment" id="6209989">//&nbsp;The&nbsp;sparse&nbsp;map&nbsp;is&nbsp;stored&nbsp;just&nbsp;before&nbsp;the&nbsp;file&nbsp;data&nbsp;and&nbsp;padded&nbsp;out&nbsp;to&nbsp;the&nbsp;nearest&nbsp;block&nbsp;boundary.</span><br>
<span class="lineno"></span><span class="keyword" id="6210089">func</span>&nbsp;<span class="ident" id="6210094">readGNUSparseMap1x0</span><span class="op" id="6210113">(</span><span class="ident" id="6210114">r</span>&nbsp;<span class="ident" id="6210116"><a href="/archive/tar/reader.go.html#6193682">io</a></span><span class="op" id="6210118">.</span><span class="ident" id="6210119">Reader</span><span class="op" id="6210125">)</span>&nbsp;<span class="op" id="6210127">(</span><span class="op" id="6210128">[</span><span class="op" id="6210129">]</span><span class="ident" id="6210130"><a href="/archive/tar/reader.go.html#6208128">sparseEntry</a></span><span class="op" id="6210141">,</span>&nbsp;<span class="builtintype" id="6210143">error</span><span class="op" id="6210148">)</span>&nbsp;<span class="op" id="6210150">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6210153">buf</span>&nbsp;<span class="op" id="6210157">:=</span>&nbsp;<span class="builtinfunc" id="6210160">make</span><span class="op" id="6210164">(</span><span class="op" id="6210165">[</span><span class="op" id="6210166">]</span><span class="builtintype" id="6210167">byte</span><span class="op" id="6210171">,</span>&nbsp;<span class="num" id="6210173">2</span><span class="op" id="6210174">*</span><span class="ident" id="6210175"><a href="/archive/tar/common.go.html#6186250">blockSize</a></span><span class="op" id="6210184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6210187">sparseHeader</span>&nbsp;<span class="op" id="6210200">:=</span>&nbsp;<span class="ident" id="6210203"><a href="/archive/tar/reader.go.html#6210153">buf</a></span><span class="op" id="6210206">[</span><span class="op" id="6210207">:</span><span class="ident" id="6210208"><a href="/archive/tar/common.go.html#6186250">blockSize</a></span><span class="op" id="6210217">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6210221">//&nbsp;readDecimal&nbsp;is&nbsp;a&nbsp;helper&nbsp;function&nbsp;to&nbsp;read&nbsp;a&nbsp;decimal&nbsp;integer&nbsp;from&nbsp;the&nbsp;sparse&nbsp;map</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6210304">//&nbsp;while&nbsp;making&nbsp;sure&nbsp;to&nbsp;read&nbsp;from&nbsp;the&nbsp;file&nbsp;in&nbsp;blocks&nbsp;of&nbsp;size&nbsp;blockSize</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6210376">readDecimal</span>&nbsp;<span class="op" id="6210388">:=</span>&nbsp;<span class="keyword" id="6210391">func</span><span class="op" id="6210395">(</span><span class="op" id="6210396">)</span>&nbsp;<span class="op" id="6210398">(</span><span class="ident" id="6210399">int64</span><span class="op" id="6210404">,</span>&nbsp;<span class="builtintype" id="6210406">error</span><span class="op" id="6210411">)</span>&nbsp;<span class="op" id="6210413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6210417">//&nbsp;Look&nbsp;for&nbsp;newline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6210439">nl</span>&nbsp;<span class="op" id="6210442">:=</span>&nbsp;<span class="ident" id="6210445"><a href="/archive/tar/reader.go.html#6193663">bytes</a></span><span class="op" id="6210450">.</span><span class="ident" id="6210451">IndexByte</span><span class="op" id="6210460">(</span><span class="ident" id="6210461"><a href="/archive/tar/reader.go.html#6210187">sparseHeader</a></span><span class="op" id="6210473">,</span>&nbsp;<span class="string" id="6210475">&#39;\n&#39;</span><span class="op" id="6210479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6210483">if</span>&nbsp;<span class="ident" id="6210486"><a href="/archive/tar/reader.go.html#6210439">nl</a></span>&nbsp;<span class="op" id="6210489">==</span>&nbsp;<span class="op" id="6210492">-</span><span class="num" id="6210493">1</span>&nbsp;<span class="op" id="6210495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6210500">if</span>&nbsp;<span class="builtinfunc" id="6210503">len</span><span class="op" id="6210506">(</span><span class="ident" id="6210507"><a href="/archive/tar/reader.go.html#6210187">sparseHeader</a></span><span class="op" id="6210519">)</span>&nbsp;<span class="op" id="6210521">&gt;=</span>&nbsp;<span class="ident" id="6210524"><a href="/archive/tar/common.go.html#6186250">blockSize</a></span>&nbsp;<span class="op" id="6210534">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6210540">//&nbsp;This&nbsp;is&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6210564">return</span>&nbsp;<span class="num" id="6210571">0</span><span class="op" id="6210572">,</span>&nbsp;<span class="ident" id="6210574"><a href="/archive/tar/reader.go.html#6193746">ErrHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6210587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6210592">oldLen</span>&nbsp;<span class="op" id="6210599">:=</span>&nbsp;<span class="builtinfunc" id="6210602">len</span><span class="op" id="6210605">(</span><span class="ident" id="6210606"><a href="/archive/tar/reader.go.html#6210187">sparseHeader</a></span><span class="op" id="6210618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6210623">newLen</span>&nbsp;<span class="op" id="6210630">:=</span>&nbsp;<span class="ident" id="6210633"><a href="/archive/tar/reader.go.html#6210592">oldLen</a></span>&nbsp;<span class="op" id="6210640">+</span>&nbsp;<span class="ident" id="6210642"><a href="/archive/tar/common.go.html#6186250">blockSize</a></span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6210655">if</span>&nbsp;<span class="builtinfunc" id="6210658">cap</span><span class="op" id="6210661">(</span><span class="ident" id="6210662"><a href="/archive/tar/reader.go.html#6210187">sparseHeader</a></span><span class="op" id="6210674">)</span>&nbsp;<span class="op" id="6210676">&lt;</span>&nbsp;<span class="ident" id="6210678"><a href="/archive/tar/reader.go.html#6210623">newLen</a></span>&nbsp;<span class="op" id="6210685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6210691">//&nbsp;There&#39;s&nbsp;more&nbsp;header,&nbsp;but&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;room&nbsp;for&nbsp;the&nbsp;next&nbsp;block</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6210763">copy</span><span class="op" id="6210767">(</span><span class="ident" id="6210768"><a href="/archive/tar/reader.go.html#6210153">buf</a></span><span class="op" id="6210771">,</span>&nbsp;<span class="ident" id="6210773"><a href="/archive/tar/reader.go.html#6210187">sparseHeader</a></span><span class="op" id="6210785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6210791"><a href="/archive/tar/reader.go.html#6210187">sparseHeader</a></span>&nbsp;<span class="op" id="6210804">=</span>&nbsp;<span class="ident" id="6210806"><a href="/archive/tar/reader.go.html#6210153">buf</a></span><span class="op" id="6210809">[</span><span class="op" id="6210810">:</span><span class="ident" id="6210811"><a href="/archive/tar/reader.go.html#6210623">newLen</a></span><span class="op" id="6210817">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6210822">}</span>&nbsp;<span class="keyword" id="6210824">else</span>&nbsp;<span class="op" id="6210829">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6210835">//&nbsp;There&#39;s&nbsp;more&nbsp;header,&nbsp;and&nbsp;we&nbsp;can&nbsp;just&nbsp;reslice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6210887"><a href="/archive/tar/reader.go.html#6210187">sparseHeader</a></span>&nbsp;<span class="op" id="6210900">=</span>&nbsp;<span class="ident" id="6210902"><a href="/archive/tar/reader.go.html#6210187">sparseHeader</a></span><span class="op" id="6210914">[</span><span class="op" id="6210915">:</span><span class="ident" id="6210916"><a href="/archive/tar/reader.go.html#6210623">newLen</a></span><span class="op" id="6210922">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6210927">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6210933">//&nbsp;Now&nbsp;that&nbsp;sparseHeader&nbsp;is&nbsp;large&nbsp;enough,&nbsp;read&nbsp;next&nbsp;block</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6210994">if</span>&nbsp;<span class="ident" id="6210997">_</span><span class="op" id="6210998">,</span>&nbsp;<span class="ident" id="6211000">err</span>&nbsp;<span class="op" id="6211004">:=</span>&nbsp;<span class="ident" id="6211007"><a href="/archive/tar/reader.go.html#6193682">io</a></span><span class="op" id="6211009">.</span><span class="ident" id="6211010">ReadFull</span><span class="op" id="6211018">(</span><span class="ident" id="6211019"><a href="/archive/tar/reader.go.html#6210114">r</a></span><span class="op" id="6211020">,</span>&nbsp;<span class="ident" id="6211022"><a href="/archive/tar/reader.go.html#6210187">sparseHeader</a></span><span class="op" id="6211034">[</span><span class="ident" id="6211035"><a href="/archive/tar/reader.go.html#6210592">oldLen</a></span><span class="op" id="6211041">:</span><span class="ident" id="6211042"><a href="/archive/tar/reader.go.html#6210623">newLen</a></span><span class="op" id="6211048">]</span><span class="op" id="6211049">)</span><span class="op" id="6211050">;</span>&nbsp;<span class="ident" id="6211052"><a href="/archive/tar/reader.go.html#6211000">err</a></span>&nbsp;<span class="op" id="6211056">!=</span>&nbsp;<span class="ident" id="6211059">nil</span>&nbsp;<span class="op" id="6211063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211069">return</span>&nbsp;<span class="num" id="6211076">0</span><span class="op" id="6211077">,</span>&nbsp;<span class="ident" id="6211079"><a href="/archive/tar/reader.go.html#6211000">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6211086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6211092">//&nbsp;Look&nbsp;for&nbsp;a&nbsp;newline&nbsp;in&nbsp;the&nbsp;new&nbsp;data</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6211133"><a href="/archive/tar/reader.go.html#6210439">nl</a></span>&nbsp;<span class="op" id="6211136">=</span>&nbsp;<span class="ident" id="6211138"><a href="/archive/tar/reader.go.html#6193663">bytes</a></span><span class="op" id="6211143">.</span><span class="ident" id="6211144">IndexByte</span><span class="op" id="6211153">(</span><span class="ident" id="6211154"><a href="/archive/tar/reader.go.html#6210187">sparseHeader</a></span><span class="op" id="6211166">[</span><span class="ident" id="6211167"><a href="/archive/tar/reader.go.html#6210592">oldLen</a></span><span class="op" id="6211173">:</span><span class="ident" id="6211174"><a href="/archive/tar/reader.go.html#6210623">newLen</a></span><span class="op" id="6211180">]</span><span class="op" id="6211181">,</span>&nbsp;<span class="string" id="6211183">&#39;\n&#39;</span><span class="op" id="6211187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211192">if</span>&nbsp;<span class="ident" id="6211195"><a href="/archive/tar/reader.go.html#6210439">nl</a></span>&nbsp;<span class="op" id="6211198">==</span>&nbsp;<span class="op" id="6211201">-</span><span class="num" id="6211202">1</span>&nbsp;<span class="op" id="6211204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6211210">//&nbsp;This&nbsp;is&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211234">return</span>&nbsp;<span class="num" id="6211241">0</span><span class="op" id="6211242">,</span>&nbsp;<span class="ident" id="6211244"><a href="/archive/tar/reader.go.html#6193746">ErrHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6211257">}</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6211262"><a href="/archive/tar/reader.go.html#6210439">nl</a></span>&nbsp;<span class="op" id="6211265">+=</span>&nbsp;<span class="ident" id="6211268"><a href="/archive/tar/reader.go.html#6210592">oldLen</a></span>&nbsp;<span class="comment" id="6211275">//&nbsp;We&nbsp;want&nbsp;the&nbsp;position&nbsp;from&nbsp;the&nbsp;beginning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6211320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6211324">//&nbsp;Now&nbsp;that&nbsp;we&#39;ve&nbsp;found&nbsp;a&nbsp;newline,&nbsp;read&nbsp;a&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6211375">n</span><span class="op" id="6211376">,</span>&nbsp;<span class="ident" id="6211378">err</span>&nbsp;<span class="op" id="6211382">:=</span>&nbsp;<span class="ident" id="6211385"><a href="/archive/tar/reader.go.html#6193707">strconv</a></span><span class="op" id="6211392">.</span><span class="ident" id="6211393">ParseInt</span><span class="op" id="6211401">(</span><span class="builtintype" id="6211402">string</span><span class="op" id="6211408">(</span><span class="ident" id="6211409"><a href="/archive/tar/reader.go.html#6210187">sparseHeader</a></span><span class="op" id="6211421">[</span><span class="op" id="6211422">:</span><span class="ident" id="6211423"><a href="/archive/tar/reader.go.html#6210439">nl</a></span><span class="op" id="6211425">]</span><span class="op" id="6211426">)</span><span class="op" id="6211427">,</span>&nbsp;<span class="num" id="6211429">10</span><span class="op" id="6211431">,</span>&nbsp;<span class="num" id="6211433">0</span><span class="op" id="6211434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211438">if</span>&nbsp;<span class="ident" id="6211441"><a href="/archive/tar/reader.go.html#6211378">err</a></span>&nbsp;<span class="op" id="6211445">!=</span>&nbsp;<span class="ident" id="6211448">nil</span>&nbsp;<span class="op" id="6211452">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211457">return</span>&nbsp;<span class="num" id="6211464">0</span><span class="op" id="6211465">,</span>&nbsp;<span class="ident" id="6211467"><a href="/archive/tar/reader.go.html#6193746">ErrHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6211479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6211484">//&nbsp;Update&nbsp;sparseHeader&nbsp;to&nbsp;consume&nbsp;this&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6211532"><a href="/archive/tar/reader.go.html#6210187">sparseHeader</a></span>&nbsp;<span class="op" id="6211545">=</span>&nbsp;<span class="ident" id="6211547"><a href="/archive/tar/reader.go.html#6210187">sparseHeader</a></span><span class="op" id="6211559">[</span><span class="ident" id="6211560"><a href="/archive/tar/reader.go.html#6210439">nl</a></span><span class="op" id="6211562">+</span><span class="num" id="6211563">1</span><span class="op" id="6211564">:</span><span class="op" id="6211565">]</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211569">return</span>&nbsp;<span class="ident" id="6211576"><a href="/archive/tar/reader.go.html#6211375">n</a></span><span class="op" id="6211577">,</span>&nbsp;<span class="ident" id="6211579">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6211584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6211588">//&nbsp;Read&nbsp;the&nbsp;first&nbsp;block</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211613">if</span>&nbsp;<span class="ident" id="6211616">_</span><span class="op" id="6211617">,</span>&nbsp;<span class="ident" id="6211619">err</span>&nbsp;<span class="op" id="6211623">:=</span>&nbsp;<span class="ident" id="6211626"><a href="/archive/tar/reader.go.html#6193682">io</a></span><span class="op" id="6211628">.</span><span class="ident" id="6211629">ReadFull</span><span class="op" id="6211637">(</span><span class="ident" id="6211638"><a href="/archive/tar/reader.go.html#6210114">r</a></span><span class="op" id="6211639">,</span>&nbsp;<span class="ident" id="6211641"><a href="/archive/tar/reader.go.html#6210187">sparseHeader</a></span><span class="op" id="6211653">)</span><span class="op" id="6211654">;</span>&nbsp;<span class="ident" id="6211656"><a href="/archive/tar/reader.go.html#6211619">err</a></span>&nbsp;<span class="op" id="6211660">!=</span>&nbsp;<span class="ident" id="6211663">nil</span>&nbsp;<span class="op" id="6211667">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211671">return</span>&nbsp;<span class="ident" id="6211678">nil</span><span class="op" id="6211681">,</span>&nbsp;<span class="ident" id="6211683"><a href="/archive/tar/reader.go.html#6211619">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6211688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6211692">//&nbsp;The&nbsp;first&nbsp;line&nbsp;contains&nbsp;the&nbsp;number&nbsp;of&nbsp;entries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6211742">numEntries</span><span class="op" id="6211752">,</span>&nbsp;<span class="ident" id="6211754">err</span>&nbsp;<span class="op" id="6211758">:=</span>&nbsp;<span class="ident" id="6211761"><a href="/archive/tar/reader.go.html#6210376">readDecimal</a></span><span class="op" id="6211772">(</span><span class="op" id="6211773">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211776">if</span>&nbsp;<span class="ident" id="6211779"><a href="/archive/tar/reader.go.html#6211754">err</a></span>&nbsp;<span class="op" id="6211783">!=</span>&nbsp;<span class="ident" id="6211786">nil</span>&nbsp;<span class="op" id="6211790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211794">return</span>&nbsp;<span class="ident" id="6211801">nil</span><span class="op" id="6211804">,</span>&nbsp;<span class="ident" id="6211806"><a href="/archive/tar/reader.go.html#6211754">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6211811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6211815">//&nbsp;Read&nbsp;all&nbsp;the&nbsp;entries</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6211840">sp</span>&nbsp;<span class="op" id="6211843">:=</span>&nbsp;<span class="builtinfunc" id="6211846">make</span><span class="op" id="6211850">(</span><span class="op" id="6211851">[</span><span class="op" id="6211852">]</span><span class="ident" id="6211853"><a href="/archive/tar/reader.go.html#6208128">sparseEntry</a></span><span class="op" id="6211864">,</span>&nbsp;<span class="num" id="6211866">0</span><span class="op" id="6211867">,</span>&nbsp;<span class="ident" id="6211869"><a href="/archive/tar/reader.go.html#6211742">numEntries</a></span><span class="op" id="6211879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211882">for</span>&nbsp;<span class="ident" id="6211886">i</span>&nbsp;<span class="op" id="6211888">:=</span>&nbsp;<span class="ident" id="6211891">int64</span><span class="op" id="6211896">(</span><span class="num" id="6211897">0</span><span class="op" id="6211898">)</span><span class="op" id="6211899">;</span>&nbsp;<span class="ident" id="6211901"><a href="/archive/tar/reader.go.html#6211886">i</a></span>&nbsp;<span class="op" id="6211903">&lt;</span>&nbsp;<span class="ident" id="6211905"><a href="/archive/tar/reader.go.html#6211742">numEntries</a></span><span class="op" id="6211915">;</span>&nbsp;<span class="ident" id="6211917"><a href="/archive/tar/reader.go.html#6211886">i</a></span><span class="op" id="6211918">++</span>&nbsp;<span class="op" id="6211921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6211925">//&nbsp;Read&nbsp;the&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6211946">offset</span><span class="op" id="6211952">,</span>&nbsp;<span class="ident" id="6211954">err</span>&nbsp;<span class="op" id="6211958">:=</span>&nbsp;<span class="ident" id="6211961"><a href="/archive/tar/reader.go.html#6210376">readDecimal</a></span><span class="op" id="6211972">(</span><span class="op" id="6211973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211977">if</span>&nbsp;<span class="ident" id="6211980"><a href="/archive/tar/reader.go.html#6211954">err</a></span>&nbsp;<span class="op" id="6211984">!=</span>&nbsp;<span class="ident" id="6211987">nil</span>&nbsp;<span class="op" id="6211991">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6211996">return</span>&nbsp;<span class="ident" id="6212003">nil</span><span class="op" id="6212006">,</span>&nbsp;<span class="ident" id="6212008"><a href="/archive/tar/reader.go.html#6211954">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6212014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6212018">//&nbsp;Read&nbsp;numBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6212037">numBytes</span><span class="op" id="6212045">,</span>&nbsp;<span class="ident" id="6212047"><a href="/archive/tar/reader.go.html#6211954">err</a></span>&nbsp;<span class="op" id="6212051">:=</span>&nbsp;<span class="ident" id="6212054"><a href="/archive/tar/reader.go.html#6210376">readDecimal</a></span><span class="op" id="6212065">(</span><span class="op" id="6212066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6212070">if</span>&nbsp;<span class="ident" id="6212073"><a href="/archive/tar/reader.go.html#6211954">err</a></span>&nbsp;<span class="op" id="6212077">!=</span>&nbsp;<span class="ident" id="6212080">nil</span>&nbsp;<span class="op" id="6212084">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6212089">return</span>&nbsp;<span class="ident" id="6212096">nil</span><span class="op" id="6212099">,</span>&nbsp;<span class="ident" id="6212101"><a href="/archive/tar/reader.go.html#6211954">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6212107">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6212112"><a href="/archive/tar/reader.go.html#6211840">sp</a></span>&nbsp;<span class="op" id="6212115">=</span>&nbsp;<span class="builtinfunc" id="6212117">append</span><span class="op" id="6212123">(</span><span class="ident" id="6212124"><a href="/archive/tar/reader.go.html#6211840">sp</a></span><span class="op" id="6212126">,</span>&nbsp;<span class="ident" id="6212128"><a href="/archive/tar/reader.go.html#6208128">sparseEntry</a></span><span class="op" id="6212139">{</span><span class="ident" id="6212140">offset</span><span class="op" id="6212146">:</span>&nbsp;<span class="ident" id="6212148"><a href="/archive/tar/reader.go.html#6211946">offset</a></span><span class="op" id="6212154">,</span>&nbsp;<span class="ident" id="6212156">numBytes</span><span class="op" id="6212164">:</span>&nbsp;<span class="ident" id="6212166"><a href="/archive/tar/reader.go.html#6212037">numBytes</a></span><span class="op" id="6212174">}</span><span class="op" id="6212175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6212178">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6212182">return</span>&nbsp;<span class="ident" id="6212189"><a href="/archive/tar/reader.go.html#6211840">sp</a></span><span class="op" id="6212191">,</span>&nbsp;<span class="ident" id="6212193">nil</span><br>
<span class="lineno"></span><span class="op" id="6212197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6212200">//&nbsp;readGNUSparseMap0x1&nbsp;reads&nbsp;the&nbsp;sparse&nbsp;map&nbsp;as&nbsp;stored&nbsp;in&nbsp;GNU&#39;s&nbsp;PAX&nbsp;sparse&nbsp;format&nbsp;version&nbsp;0.1.</span><br>
<span class="lineno">680</span><span class="comment" id="6212294">//&nbsp;The&nbsp;sparse&nbsp;map&nbsp;is&nbsp;stored&nbsp;in&nbsp;the&nbsp;PAX&nbsp;headers.</span><br>
<span class="lineno"></span><span class="keyword" id="6212342">func</span>&nbsp;<span class="ident" id="6212347">readGNUSparseMap0x1</span><span class="op" id="6212366">(</span><span class="ident" id="6212367">headers</span>&nbsp;<span class="keyword" id="6212375">map</span><span class="op" id="6212378">[</span><span class="builtintype" id="6212379">string</span><span class="op" id="6212385">]</span><span class="builtintype" id="6212386">string</span><span class="op" id="6212392">)</span>&nbsp;<span class="op" id="6212394">(</span><span class="op" id="6212395">[</span><span class="op" id="6212396">]</span><span class="ident" id="6212397"><a href="/archive/tar/reader.go.html#6208128">sparseEntry</a></span><span class="op" id="6212408">,</span>&nbsp;<span class="builtintype" id="6212410">error</span><span class="op" id="6212415">)</span>&nbsp;<span class="op" id="6212417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6212420">//&nbsp;Get&nbsp;number&nbsp;of&nbsp;entries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6212446">numEntriesStr</span><span class="op" id="6212459">,</span>&nbsp;<span class="ident" id="6212461">ok</span>&nbsp;<span class="op" id="6212464">:=</span>&nbsp;<span class="ident" id="6212467"><a href="/archive/tar/reader.go.html#6212367">headers</a></span><span class="op" id="6212474">[</span><span class="ident" id="6212475"><a href="/archive/tar/reader.go.html#6195179">paxGNUSparseNumBlocks</a></span><span class="op" id="6212496">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6212499">if</span>&nbsp;<span class="op" id="6212502">!</span><span class="ident" id="6212503"><a href="/archive/tar/reader.go.html#6212461">ok</a></span>&nbsp;<span class="op" id="6212506">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6212510">return</span>&nbsp;<span class="ident" id="6212517">nil</span><span class="op" id="6212520">,</span>&nbsp;<span class="ident" id="6212522"><a href="/archive/tar/reader.go.html#6193746">ErrHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6212533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6212536">numEntries</span><span class="op" id="6212546">,</span>&nbsp;<span class="ident" id="6212548">err</span>&nbsp;<span class="op" id="6212552">:=</span>&nbsp;<span class="ident" id="6212555"><a href="/archive/tar/reader.go.html#6193707">strconv</a></span><span class="op" id="6212562">.</span><span class="ident" id="6212563">ParseInt</span><span class="op" id="6212571">(</span><span class="ident" id="6212572"><a href="/archive/tar/reader.go.html#6212446">numEntriesStr</a></span><span class="op" id="6212585">,</span>&nbsp;<span class="num" id="6212587">10</span><span class="op" id="6212589">,</span>&nbsp;<span class="num" id="6212591">0</span><span class="op" id="6212592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6212595">if</span>&nbsp;<span class="ident" id="6212598"><a href="/archive/tar/reader.go.html#6212548">err</a></span>&nbsp;<span class="op" id="6212602">!=</span>&nbsp;<span class="ident" id="6212605">nil</span>&nbsp;<span class="op" id="6212609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6212613">return</span>&nbsp;<span class="ident" id="6212620">nil</span><span class="op" id="6212623">,</span>&nbsp;<span class="ident" id="6212625"><a href="/archive/tar/reader.go.html#6193746">ErrHeader</a></span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6212636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6212640">sparseMap</span>&nbsp;<span class="op" id="6212650">:=</span>&nbsp;<span class="ident" id="6212653"><a href="/archive/tar/reader.go.html#6193718">strings</a></span><span class="op" id="6212660">.</span><span class="ident" id="6212661">Split</span><span class="op" id="6212666">(</span><span class="ident" id="6212667"><a href="/archive/tar/reader.go.html#6212367">headers</a></span><span class="op" id="6212674">[</span><span class="ident" id="6212675"><a href="/archive/tar/reader.go.html#6195319">paxGNUSparseMap</a></span><span class="op" id="6212690">]</span><span class="op" id="6212691">,</span>&nbsp;<span class="string" id="6212693">&#34;,&#34;</span><span class="op" id="6212696">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6212700">//&nbsp;There&nbsp;should&nbsp;be&nbsp;two&nbsp;numbers&nbsp;in&nbsp;sparseMap&nbsp;for&nbsp;each&nbsp;entry</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6212760">if</span>&nbsp;<span class="ident" id="6212763">int64</span><span class="op" id="6212768">(</span><span class="builtinfunc" id="6212769">len</span><span class="op" id="6212772">(</span><span class="ident" id="6212773"><a href="/archive/tar/reader.go.html#6212640">sparseMap</a></span><span class="op" id="6212782">)</span><span class="op" id="6212783">)</span>&nbsp;<span class="op" id="6212785">!=</span>&nbsp;<span class="num" id="6212788">2</span><span class="op" id="6212789">*</span><span class="ident" id="6212790"><a href="/archive/tar/reader.go.html#6212536">numEntries</a></span>&nbsp;<span class="op" id="6212801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6212805">return</span>&nbsp;<span class="ident" id="6212812">nil</span><span class="op" id="6212815">,</span>&nbsp;<span class="ident" id="6212817"><a href="/archive/tar/reader.go.html#6193746">ErrHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6212828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6212832">//&nbsp;Loop&nbsp;through&nbsp;the&nbsp;entries&nbsp;in&nbsp;the&nbsp;sparse&nbsp;map</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6212879">sp</span>&nbsp;<span class="op" id="6212882">:=</span>&nbsp;<span class="builtinfunc" id="6212885">make</span><span class="op" id="6212889">(</span><span class="op" id="6212890">[</span><span class="op" id="6212891">]</span><span class="ident" id="6212892"><a href="/archive/tar/reader.go.html#6208128">sparseEntry</a></span><span class="op" id="6212903">,</span>&nbsp;<span class="num" id="6212905">0</span><span class="op" id="6212906">,</span>&nbsp;<span class="ident" id="6212908"><a href="/archive/tar/reader.go.html#6212536">numEntries</a></span><span class="op" id="6212918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6212921">for</span>&nbsp;<span class="ident" id="6212925">i</span>&nbsp;<span class="op" id="6212927">:=</span>&nbsp;<span class="ident" id="6212930">int64</span><span class="op" id="6212935">(</span><span class="num" id="6212936">0</span><span class="op" id="6212937">)</span><span class="op" id="6212938">;</span>&nbsp;<span class="ident" id="6212940"><a href="/archive/tar/reader.go.html#6212925">i</a></span>&nbsp;<span class="op" id="6212942">&lt;</span>&nbsp;<span class="ident" id="6212944"><a href="/archive/tar/reader.go.html#6212536">numEntries</a></span><span class="op" id="6212954">;</span>&nbsp;<span class="ident" id="6212956"><a href="/archive/tar/reader.go.html#6212925">i</a></span><span class="op" id="6212957">++</span>&nbsp;<span class="op" id="6212960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6212964">offset</span><span class="op" id="6212970">,</span>&nbsp;<span class="ident" id="6212972">err</span>&nbsp;<span class="op" id="6212976">:=</span>&nbsp;<span class="ident" id="6212979"><a href="/archive/tar/reader.go.html#6193707">strconv</a></span><span class="op" id="6212986">.</span><span class="ident" id="6212987">ParseInt</span><span class="op" id="6212995">(</span><span class="ident" id="6212996"><a href="/archive/tar/reader.go.html#6212640">sparseMap</a></span><span class="op" id="6213005">[</span><span class="num" id="6213006">2</span><span class="op" id="6213007">*</span><span class="ident" id="6213008"><a href="/archive/tar/reader.go.html#6212925">i</a></span><span class="op" id="6213009">]</span><span class="op" id="6213010">,</span>&nbsp;<span class="num" id="6213012">10</span><span class="op" id="6213014">,</span>&nbsp;<span class="num" id="6213016">0</span><span class="op" id="6213017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213021">if</span>&nbsp;<span class="ident" id="6213024"><a href="/archive/tar/reader.go.html#6212972">err</a></span>&nbsp;<span class="op" id="6213028">!=</span>&nbsp;<span class="ident" id="6213031">nil</span>&nbsp;<span class="op" id="6213035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213040">return</span>&nbsp;<span class="ident" id="6213047">nil</span><span class="op" id="6213050">,</span>&nbsp;<span class="ident" id="6213052"><a href="/archive/tar/reader.go.html#6193746">ErrHeader</a></span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6213064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6213068">numBytes</span><span class="op" id="6213076">,</span>&nbsp;<span class="ident" id="6213078"><a href="/archive/tar/reader.go.html#6212972">err</a></span>&nbsp;<span class="op" id="6213082">:=</span>&nbsp;<span class="ident" id="6213085"><a href="/archive/tar/reader.go.html#6193707">strconv</a></span><span class="op" id="6213092">.</span><span class="ident" id="6213093">ParseInt</span><span class="op" id="6213101">(</span><span class="ident" id="6213102"><a href="/archive/tar/reader.go.html#6212640">sparseMap</a></span><span class="op" id="6213111">[</span><span class="num" id="6213112">2</span><span class="op" id="6213113">*</span><span class="ident" id="6213114"><a href="/archive/tar/reader.go.html#6212925">i</a></span><span class="op" id="6213115">+</span><span class="num" id="6213116">1</span><span class="op" id="6213117">]</span><span class="op" id="6213118">,</span>&nbsp;<span class="num" id="6213120">10</span><span class="op" id="6213122">,</span>&nbsp;<span class="num" id="6213124">0</span><span class="op" id="6213125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213129">if</span>&nbsp;<span class="ident" id="6213132"><a href="/archive/tar/reader.go.html#6212972">err</a></span>&nbsp;<span class="op" id="6213136">!=</span>&nbsp;<span class="ident" id="6213139">nil</span>&nbsp;<span class="op" id="6213143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213148">return</span>&nbsp;<span class="ident" id="6213155">nil</span><span class="op" id="6213158">,</span>&nbsp;<span class="ident" id="6213160"><a href="/archive/tar/reader.go.html#6193746">ErrHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6213172">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6213176"><a href="/archive/tar/reader.go.html#6212879">sp</a></span>&nbsp;<span class="op" id="6213179">=</span>&nbsp;<span class="builtinfunc" id="6213181">append</span><span class="op" id="6213187">(</span><span class="ident" id="6213188"><a href="/archive/tar/reader.go.html#6212879">sp</a></span><span class="op" id="6213190">,</span>&nbsp;<span class="ident" id="6213192"><a href="/archive/tar/reader.go.html#6208128">sparseEntry</a></span><span class="op" id="6213203">{</span><span class="ident" id="6213204">offset</span><span class="op" id="6213210">:</span>&nbsp;<span class="ident" id="6213212"><a href="/archive/tar/reader.go.html#6212964">offset</a></span><span class="op" id="6213218">,</span>&nbsp;<span class="ident" id="6213220">numBytes</span><span class="op" id="6213228">:</span>&nbsp;<span class="ident" id="6213230"><a href="/archive/tar/reader.go.html#6213068">numBytes</a></span><span class="op" id="6213238">}</span><span class="op" id="6213239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6213242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213246">return</span>&nbsp;<span class="ident" id="6213253"><a href="/archive/tar/reader.go.html#6212879">sp</a></span><span class="op" id="6213255">,</span>&nbsp;<span class="ident" id="6213257">nil</span><br>
<span class="lineno"></span><span class="op" id="6213261">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="comment" id="6213264">//&nbsp;numBytes&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;left&nbsp;to&nbsp;read&nbsp;in&nbsp;the&nbsp;current&nbsp;file&#39;s&nbsp;entry</span><br>
<span class="lineno"></span><span class="comment" id="6213345">//&nbsp;in&nbsp;the&nbsp;tar&nbsp;archive,&nbsp;or&nbsp;0&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;current&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6213402">func</span>&nbsp;<span class="op" id="6213407">(</span><span class="ident" id="6213408">tr</span>&nbsp;<span class="op" id="6213411">*</span><span class="ident" id="6213412"><a href="/archive/tar/reader.go.html#6194123">Reader</a></span><span class="op" id="6213418">)</span>&nbsp;<span class="ident" id="6213420">numBytes</span><span class="op" id="6213428">(</span><span class="op" id="6213429">)</span>&nbsp;<span class="ident" id="6213431">int64</span>&nbsp;<span class="op" id="6213437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213440">if</span>&nbsp;<span class="ident" id="6213443"><a href="/archive/tar/reader.go.html#6213408">tr</a></span><span class="op" id="6213445">.</span><span class="ident" id="6213446">curr</span>&nbsp;<span class="op" id="6213451">==</span>&nbsp;<span class="ident" id="6213454">nil</span>&nbsp;<span class="op" id="6213458">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6213462">//&nbsp;No&nbsp;current&nbsp;file,&nbsp;so&nbsp;no&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213496">return</span>&nbsp;<span class="num" id="6213503">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6213506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213509">return</span>&nbsp;<span class="ident" id="6213516"><a href="/archive/tar/reader.go.html#6213408">tr</a></span><span class="op" id="6213518">.</span><span class="ident" id="6213519">curr</span><span class="op" id="6213523">.</span><span class="ident" id="6213524">numBytes</span><span class="op" id="6213532">(</span><span class="op" id="6213533">)</span><br>
<span class="lineno"></span><span class="op" id="6213535">}</span><br>
<span class="lineno">725</span><br>
<span class="lineno"></span><span class="comment" id="6213538">//&nbsp;Read&nbsp;reads&nbsp;from&nbsp;the&nbsp;current&nbsp;entry&nbsp;in&nbsp;the&nbsp;tar&nbsp;archive.</span><br>
<span class="lineno"></span><span class="comment" id="6213595">//&nbsp;It&nbsp;returns&nbsp;0,&nbsp;io.EOF&nbsp;when&nbsp;it&nbsp;reaches&nbsp;the&nbsp;end&nbsp;of&nbsp;that&nbsp;entry,</span><br>
<span class="lineno"></span><span class="comment" id="6213658">//&nbsp;until&nbsp;Next&nbsp;is&nbsp;called&nbsp;to&nbsp;advance&nbsp;to&nbsp;the&nbsp;next&nbsp;entry.</span><br>
<span class="lineno"></span><span class="keyword" id="6213712">func</span>&nbsp;<span class="op" id="6213717">(</span><span class="ident" id="6213718">tr</span>&nbsp;<span class="op" id="6213721">*</span><span class="ident" id="6213722"><a href="/archive/tar/reader.go.html#6194123">Reader</a></span><span class="op" id="6213728">)</span>&nbsp;<span class="ident" id="6213730">Read</span><span class="op" id="6213734">(</span><span class="ident" id="6213735">b</span>&nbsp;<span class="op" id="6213737">[</span><span class="op" id="6213738">]</span><span class="builtintype" id="6213739">byte</span><span class="op" id="6213743">)</span>&nbsp;<span class="op" id="6213745">(</span><span class="ident" id="6213746">n</span>&nbsp;<span class="builtintype" id="6213748">int</span><span class="op" id="6213751">,</span>&nbsp;<span class="ident" id="6213753">err</span>&nbsp;<span class="builtintype" id="6213757">error</span><span class="op" id="6213762">)</span>&nbsp;<span class="op" id="6213764">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213767">if</span>&nbsp;<span class="ident" id="6213770"><a href="/archive/tar/reader.go.html#6213718">tr</a></span><span class="op" id="6213772">.</span><span class="ident" id="6213773">curr</span>&nbsp;<span class="op" id="6213778">==</span>&nbsp;<span class="ident" id="6213781">nil</span>&nbsp;<span class="op" id="6213785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213789">return</span>&nbsp;<span class="num" id="6213796">0</span><span class="op" id="6213797">,</span>&nbsp;<span class="ident" id="6213799"><a href="/archive/tar/reader.go.html#6193682">io</a></span><span class="op" id="6213801">.</span><span class="ident" id="6213802">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6213807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6213810"><a href="/archive/tar/reader.go.html#6213746">n</a></span><span class="op" id="6213811">,</span>&nbsp;<span class="ident" id="6213813"><a href="/archive/tar/reader.go.html#6213753">err</a></span>&nbsp;<span class="op" id="6213817">=</span>&nbsp;<span class="ident" id="6213819"><a href="/archive/tar/reader.go.html#6213718">tr</a></span><span class="op" id="6213821">.</span><span class="ident" id="6213822">curr</span><span class="op" id="6213826">.</span><span class="ident" id="6213827">Read</span><span class="op" id="6213831">(</span><span class="ident" id="6213832"><a href="/archive/tar/reader.go.html#6213735">b</a></span><span class="op" id="6213833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213836">if</span>&nbsp;<span class="ident" id="6213839"><a href="/archive/tar/reader.go.html#6213753">err</a></span>&nbsp;<span class="op" id="6213843">!=</span>&nbsp;<span class="ident" id="6213846">nil</span>&nbsp;<span class="op" id="6213850">&amp;&amp;</span>&nbsp;<span class="ident" id="6213853"><a href="/archive/tar/reader.go.html#6213753">err</a></span>&nbsp;<span class="op" id="6213857">!=</span>&nbsp;<span class="ident" id="6213860"><a href="/archive/tar/reader.go.html#6193682">io</a></span><span class="op" id="6213862">.</span><span class="ident" id="6213863">EOF</span>&nbsp;<span class="op" id="6213867">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6213871"><a href="/archive/tar/reader.go.html#6213718">tr</a></span><span class="op" id="6213873">.</span><span class="ident" id="6213874">err</span>&nbsp;<span class="op" id="6213878">=</span>&nbsp;<span class="ident" id="6213880"><a href="/archive/tar/reader.go.html#6213753">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6213885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213888">return</span><br>
<span class="lineno"></span><span class="op" id="6213895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">740</span><span class="keyword" id="6213898">func</span>&nbsp;<span class="op" id="6213903">(</span><span class="ident" id="6213904">rfr</span>&nbsp;<span class="op" id="6213908">*</span><span class="ident" id="6213909"><a href="/archive/tar/reader.go.html#6194656">regFileReader</a></span><span class="op" id="6213922">)</span>&nbsp;<span class="ident" id="6213924">Read</span><span class="op" id="6213928">(</span><span class="ident" id="6213929">b</span>&nbsp;<span class="op" id="6213931">[</span><span class="op" id="6213932">]</span><span class="builtintype" id="6213933">byte</span><span class="op" id="6213937">)</span>&nbsp;<span class="op" id="6213939">(</span><span class="ident" id="6213940">n</span>&nbsp;<span class="builtintype" id="6213942">int</span><span class="op" id="6213945">,</span>&nbsp;<span class="ident" id="6213947">err</span>&nbsp;<span class="builtintype" id="6213951">error</span><span class="op" id="6213956">)</span>&nbsp;<span class="op" id="6213958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213961">if</span>&nbsp;<span class="ident" id="6213964"><a href="/archive/tar/reader.go.html#6213904">rfr</a></span><span class="op" id="6213967">.</span><span class="ident" id="6213968">nb</span>&nbsp;<span class="op" id="6213971">==</span>&nbsp;<span class="num" id="6213974">0</span>&nbsp;<span class="op" id="6213976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6213980">//&nbsp;file&nbsp;consumed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6213999">return</span>&nbsp;<span class="num" id="6214006">0</span><span class="op" id="6214007">,</span>&nbsp;<span class="ident" id="6214009"><a href="/archive/tar/reader.go.html#6193682">io</a></span><span class="op" id="6214011">.</span><span class="ident" id="6214012">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6214017">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6214020">if</span>&nbsp;<span class="ident" id="6214023">int64</span><span class="op" id="6214028">(</span><span class="builtinfunc" id="6214029">len</span><span class="op" id="6214032">(</span><span class="ident" id="6214033"><a href="/archive/tar/reader.go.html#6213929">b</a></span><span class="op" id="6214034">)</span><span class="op" id="6214035">)</span>&nbsp;<span class="op" id="6214037">&gt;</span>&nbsp;<span class="ident" id="6214039"><a href="/archive/tar/reader.go.html#6213904">rfr</a></span><span class="op" id="6214042">.</span><span class="ident" id="6214043">nb</span>&nbsp;<span class="op" id="6214046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6214050"><a href="/archive/tar/reader.go.html#6213929">b</a></span>&nbsp;<span class="op" id="6214052">=</span>&nbsp;<span class="ident" id="6214054"><a href="/archive/tar/reader.go.html#6213929">b</a></span><span class="op" id="6214055">[</span><span class="num" id="6214056">0</span><span class="op" id="6214057">:</span><span class="ident" id="6214058"><a href="/archive/tar/reader.go.html#6213904">rfr</a></span><span class="op" id="6214061">.</span><span class="ident" id="6214062">nb</span><span class="op" id="6214064">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6214067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6214070"><a href="/archive/tar/reader.go.html#6213940">n</a></span><span class="op" id="6214071">,</span>&nbsp;<span class="ident" id="6214073"><a href="/archive/tar/reader.go.html#6213947">err</a></span>&nbsp;<span class="op" id="6214077">=</span>&nbsp;<span class="ident" id="6214079"><a href="/archive/tar/reader.go.html#6213904">rfr</a></span><span class="op" id="6214082">.</span><span class="ident" id="6214083">r</span><span class="op" id="6214084">.</span><span class="ident" id="6214085">Read</span><span class="op" id="6214089">(</span><span class="ident" id="6214090"><a href="/archive/tar/reader.go.html#6213929">b</a></span><span class="op" id="6214091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6214094"><a href="/archive/tar/reader.go.html#6213904">rfr</a></span><span class="op" id="6214097">.</span><span class="ident" id="6214098">nb</span>&nbsp;<span class="op" id="6214101">-=</span>&nbsp;<span class="ident" id="6214104">int64</span><span class="op" id="6214109">(</span><span class="ident" id="6214110"><a href="/archive/tar/reader.go.html#6213940">n</a></span><span class="op" id="6214111">)</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6214115">if</span>&nbsp;<span class="ident" id="6214118"><a href="/archive/tar/reader.go.html#6213947">err</a></span>&nbsp;<span class="op" id="6214122">==</span>&nbsp;<span class="ident" id="6214125"><a href="/archive/tar/reader.go.html#6193682">io</a></span><span class="op" id="6214127">.</span><span class="ident" id="6214128">EOF</span>&nbsp;<span class="op" id="6214132">&amp;&amp;</span>&nbsp;<span class="ident" id="6214135"><a href="/archive/tar/reader.go.html#6213904">rfr</a></span><span class="op" id="6214138">.</span><span class="ident" id="6214139">nb</span>&nbsp;<span class="op" id="6214142">&gt;</span>&nbsp;<span class="num" id="6214144">0</span>&nbsp;<span class="op" id="6214146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6214150"><a href="/archive/tar/reader.go.html#6213947">err</a></span>&nbsp;<span class="op" id="6214154">=</span>&nbsp;<span class="ident" id="6214156"><a href="/archive/tar/reader.go.html#6193682">io</a></span><span class="op" id="6214158">.</span><span class="ident" id="6214159">ErrUnexpectedEOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6214177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6214180">return</span><br>
<span class="lineno">755</span><span class="op" id="6214187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6214190">//&nbsp;numBytes&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;left&nbsp;to&nbsp;read&nbsp;in&nbsp;the&nbsp;file&#39;s&nbsp;data&nbsp;in&nbsp;the&nbsp;tar&nbsp;archive.</span><br>
<span class="lineno"></span><span class="keyword" id="6214282">func</span>&nbsp;<span class="op" id="6214287">(</span><span class="ident" id="6214288">rfr</span>&nbsp;<span class="op" id="6214292">*</span><span class="ident" id="6214293"><a href="/archive/tar/reader.go.html#6194656">regFileReader</a></span><span class="op" id="6214306">)</span>&nbsp;<span class="ident" id="6214308">numBytes</span><span class="op" id="6214316">(</span><span class="op" id="6214317">)</span>&nbsp;<span class="ident" id="6214319">int64</span>&nbsp;<span class="op" id="6214325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6214328">return</span>&nbsp;<span class="ident" id="6214335"><a href="/archive/tar/reader.go.html#6214288">rfr</a></span><span class="op" id="6214338">.</span><span class="ident" id="6214339">nb</span><br>
<span class="lineno">760</span><span class="op" id="6214342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6214345">//&nbsp;readHole&nbsp;reads&nbsp;a&nbsp;sparse&nbsp;file&nbsp;hole&nbsp;ending&nbsp;at&nbsp;offset&nbsp;toOffset</span><br>
<span class="lineno"></span><span class="keyword" id="6214408">func</span>&nbsp;<span class="op" id="6214413">(</span><span class="ident" id="6214414">sfr</span>&nbsp;<span class="op" id="6214418">*</span><span class="ident" id="6214419"><a href="/archive/tar/reader.go.html#6194876">sparseFileReader</a></span><span class="op" id="6214435">)</span>&nbsp;<span class="ident" id="6214437">readHole</span><span class="op" id="6214445">(</span><span class="ident" id="6214446">b</span>&nbsp;<span class="op" id="6214448">[</span><span class="op" id="6214449">]</span><span class="builtintype" id="6214450">byte</span><span class="op" id="6214454">,</span>&nbsp;<span class="ident" id="6214456">toOffset</span>&nbsp;<span class="ident" id="6214465">int64</span><span class="op" id="6214470">)</span>&nbsp;<span class="builtintype" id="6214472">int</span>&nbsp;<span class="op" id="6214476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6214479">n64</span>&nbsp;<span class="op" id="6214483">:=</span>&nbsp;<span class="ident" id="6214486"><a href="/archive/tar/reader.go.html#6214456">toOffset</a></span>&nbsp;<span class="op" id="6214495">-</span>&nbsp;<span class="ident" id="6214497"><a href="/archive/tar/reader.go.html#6214414">sfr</a></span><span class="op" id="6214500">.</span><span class="ident" id="6214501">pos</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6214506">if</span>&nbsp;<span class="ident" id="6214509"><a href="/archive/tar/reader.go.html#6214479">n64</a></span>&nbsp;<span class="op" id="6214513">&gt;</span>&nbsp;<span class="ident" id="6214515">int64</span><span class="op" id="6214520">(</span><span class="builtinfunc" id="6214521">len</span><span class="op" id="6214524">(</span><span class="ident" id="6214525"><a href="/archive/tar/reader.go.html#6214446">b</a></span><span class="op" id="6214526">)</span><span class="op" id="6214527">)</span>&nbsp;<span class="op" id="6214529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6214533"><a href="/archive/tar/reader.go.html#6214479">n64</a></span>&nbsp;<span class="op" id="6214537">=</span>&nbsp;<span class="ident" id="6214539">int64</span><span class="op" id="6214544">(</span><span class="builtinfunc" id="6214545">len</span><span class="op" id="6214548">(</span><span class="ident" id="6214549"><a href="/archive/tar/reader.go.html#6214446">b</a></span><span class="op" id="6214550">)</span><span class="op" id="6214551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6214554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6214557">n</span>&nbsp;<span class="op" id="6214559">:=</span>&nbsp;<span class="builtintype" id="6214562">int</span><span class="op" id="6214565">(</span><span class="ident" id="6214566"><a href="/archive/tar/reader.go.html#6214479">n64</a></span><span class="op" id="6214569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6214572">for</span>&nbsp;<span class="ident" id="6214576">i</span>&nbsp;<span class="op" id="6214578">:=</span>&nbsp;<span class="num" id="6214581">0</span><span class="op" id="6214582">;</span>&nbsp;<span class="ident" id="6214584"><a href="/archive/tar/reader.go.html#6214576">i</a></span>&nbsp;<span class="op" id="6214586">&lt;</span>&nbsp;<span class="ident" id="6214588"><a href="/archive/tar/reader.go.html#6214557">n</a></span><span class="op" id="6214589">;</span>&nbsp;<span class="ident" id="6214591"><a href="/archive/tar/reader.go.html#6214576">i</a></span><span class="op" id="6214592">++</span>&nbsp;<span class="op" id="6214595">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6214599"><a href="/archive/tar/reader.go.html#6214446">b</a></span><span class="op" id="6214600">[</span><span class="ident" id="6214601"><a href="/archive/tar/reader.go.html#6214576">i</a></span><span class="op" id="6214602">]</span>&nbsp;<span class="op" id="6214604">=</span>&nbsp;<span class="num" id="6214606">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6214609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6214612"><a href="/archive/tar/reader.go.html#6214414">sfr</a></span><span class="op" id="6214615">.</span><span class="ident" id="6214616">pos</span>&nbsp;<span class="op" id="6214620">+=</span>&nbsp;<span class="ident" id="6214623"><a href="/archive/tar/reader.go.html#6214479">n64</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6214628">return</span>&nbsp;<span class="ident" id="6214635"><a href="/archive/tar/reader.go.html#6214557">n</a></span><br>
<span class="lineno"></span><span class="op" id="6214637">}</span><br>
<span class="lineno">775</span><br>
<span class="lineno"></span><span class="comment" id="6214640">//&nbsp;Read&nbsp;reads&nbsp;the&nbsp;sparse&nbsp;file&nbsp;data&nbsp;in&nbsp;expanded&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="6214693">func</span>&nbsp;<span class="op" id="6214698">(</span><span class="ident" id="6214699">sfr</span>&nbsp;<span class="op" id="6214703">*</span><span class="ident" id="6214704"><a href="/archive/tar/reader.go.html#6194876">sparseFileReader</a></span><span class="op" id="6214720">)</span>&nbsp;<span class="ident" id="6214722">Read</span><span class="op" id="6214726">(</span><span class="ident" id="6214727">b</span>&nbsp;<span class="op" id="6214729">[</span><span class="op" id="6214730">]</span><span class="builtintype" id="6214731">byte</span><span class="op" id="6214735">)</span>&nbsp;<span class="op" id="6214737">(</span><span class="ident" id="6214738">n</span>&nbsp;<span class="builtintype" id="6214740">int</span><span class="op" id="6214743">,</span>&nbsp;<span class="ident" id="6214745">err</span>&nbsp;<span class="builtintype" id="6214749">error</span><span class="op" id="6214754">)</span>&nbsp;<span class="op" id="6214756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6214759">if</span>&nbsp;<span class="builtinfunc" id="6214762">len</span><span class="op" id="6214765">(</span><span class="ident" id="6214766"><a href="/archive/tar/reader.go.html#6214699">sfr</a></span><span class="op" id="6214769">.</span><span class="ident" id="6214770">sp</span><span class="op" id="6214772">)</span>&nbsp;<span class="op" id="6214774">==</span>&nbsp;<span class="num" id="6214777">0</span>&nbsp;<span class="op" id="6214779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6214783">//&nbsp;No&nbsp;more&nbsp;data&nbsp;fragments&nbsp;to&nbsp;read&nbsp;from.</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6214825">if</span>&nbsp;<span class="ident" id="6214828"><a href="/archive/tar/reader.go.html#6214699">sfr</a></span><span class="op" id="6214831">.</span><span class="ident" id="6214832">pos</span>&nbsp;<span class="op" id="6214836">&lt;</span>&nbsp;<span class="ident" id="6214838"><a href="/archive/tar/reader.go.html#6214699">sfr</a></span><span class="op" id="6214841">.</span><span class="ident" id="6214842">tot</span>&nbsp;<span class="op" id="6214846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6214851">//&nbsp;We&#39;re&nbsp;in&nbsp;the&nbsp;last&nbsp;hole</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6214880"><a href="/archive/tar/reader.go.html#6214738">n</a></span>&nbsp;<span class="op" id="6214882">=</span>&nbsp;<span class="ident" id="6214884"><a href="/archive/tar/reader.go.html#6214699">sfr</a></span><span class="op" id="6214887">.</span><span class="ident" id="6214888">readHole</span><span class="op" id="6214896">(</span><span class="ident" id="6214897"><a href="/archive/tar/reader.go.html#6214727">b</a></span><span class="op" id="6214898">,</span>&nbsp;<span class="ident" id="6214900"><a href="/archive/tar/reader.go.html#6214699">sfr</a></span><span class="op" id="6214903">.</span><span class="ident" id="6214904">tot</span><span class="op" id="6214907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6214912">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6214921">}</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6214925">//&nbsp;Otherwise,&nbsp;we&#39;re&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6214970">return</span>&nbsp;<span class="num" id="6214977">0</span><span class="op" id="6214978">,</span>&nbsp;<span class="ident" id="6214980"><a href="/archive/tar/reader.go.html#6193682">io</a></span><span class="op" id="6214982">.</span><span class="ident" id="6214983">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6214988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6214991">if</span>&nbsp;<span class="ident" id="6214994"><a href="/archive/tar/reader.go.html#6214699">sfr</a></span><span class="op" id="6214997">.</span><span class="ident" id="6214998">pos</span>&nbsp;<span class="op" id="6215002">&lt;</span>&nbsp;<span class="ident" id="6215004"><a href="/archive/tar/reader.go.html#6214699">sfr</a></span><span class="op" id="6215007">.</span><span class="ident" id="6215008">sp</span><span class="op" id="6215010">[</span><span class="num" id="6215011">0</span><span class="op" id="6215012">]</span><span class="op" id="6215013">.</span><span class="ident" id="6215014">offset</span>&nbsp;<span class="op" id="6215021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6215025">//&nbsp;We&#39;re&nbsp;in&nbsp;a&nbsp;hole</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6215046"><a href="/archive/tar/reader.go.html#6214738">n</a></span>&nbsp;<span class="op" id="6215048">=</span>&nbsp;<span class="ident" id="6215050"><a href="/archive/tar/reader.go.html#6214699">sfr</a></span><span class="op" id="6215053">.</span><span class="ident" id="6215054">readHole</span><span class="op" id="6215062">(</span><span class="ident" id="6215063"><a href="/archive/tar/reader.go.html#6214727">b</a></span><span class="op" id="6215064">,</span>&nbsp;<span class="ident" id="6215066"><a href="/archive/tar/reader.go.html#6214699">sfr</a></span><span class="op" id="6215069">.</span><span class="ident" id="6215070">sp</span><span class="op" id="6215072">[</span><span class="num" id="6215073">0</span><span class="op" id="6215074">]</span><span class="op" id="6215075">.</span><span class="ident" id="6215076">offset</span><span class="op" id="6215082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6215086">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6215094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6215098">//&nbsp;We&#39;re&nbsp;not&nbsp;in&nbsp;a&nbsp;hole,&nbsp;so&nbsp;we&#39;ll&nbsp;read&nbsp;from&nbsp;the&nbsp;next&nbsp;data&nbsp;fragment</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6215165">posInFragment</span>&nbsp;<span class="op" id="6215179">:=</span>&nbsp;<span class="ident" id="6215182"><a href="/archive/tar/reader.go.html#6214699">sfr</a></span><span class="op" id="6215185">.</span><span class="ident" id="6215186">pos</span>&nbsp;<span class="op" id="6215190">-</span>&nbsp;<span class="ident" id="6215192"><a href="/archive/tar/reader.go.html#6214699">sfr</a></span><span class="op" id="6215195">.</span><span class="ident" id="6215196">sp</span><span class="op" id="6215198">[</span><span class="num" id="6215199">0</span><span class="op" id="6215200">]</span><span class="op" id="6215201">.</span><span class="ident" id="6215202">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6215210">bytesLeft</span>&nbsp;<span class="op" id="6215220">:=</span>&nbsp;<span class="ident" id="6215223"><a href="/archive/tar/reader.go.html#6214699">sfr</a></span><span class="op" id="6215226">.</span><span class="ident" id="6215227">sp</span><span class="op" id="6215229">[</span><span class="num" id="6215230">0</span><span class="op" id="6215231">]</span><span class="op" id="6215232">.</span><span class="ident" id="6215233">numBytes</span>&nbsp;<span class="op" id="6215242">-</span>&nbsp;<span class="ident" id="6215244"><a href="/archive/tar/reader.go.html#6215165">posInFragment</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6215259">if</span>&nbsp;<span class="ident" id="6215262">int64</span><span class="op" id="6215267">(</span><span class="builtinfunc" id="6215268">len</span><span class="op" id="6215271">(</span><span class="ident" id="6215272"><a href="/archive/tar/reader.go.html#6214727">b</a></span><span class="op" id="6215273">)</span><span class="op" id="6215274">)</span>&nbsp;<span class="op" id="6215276">&gt;</span>&nbsp;<span class="ident" id="6215278"><a href="/archive/tar/reader.go.html#6215210">bytesLeft</a></span>&nbsp;<span class="op" id="6215288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6215292"><a href="/archive/tar/reader.go.html#6214727">b</a></span>&nbsp;<span class="op" id="6215294">=</span>&nbsp;<span class="ident" id="6215296"><a href="/archive/tar/reader.go.html#6214727">b</a></span><span class="op" id="6215297">[</span><span class="num" id="6215298">0</span><span class="op" id="6215299">:</span><span class="ident" id="6215300"><a href="/archive/tar/reader.go.html#6215210">bytesLeft</a></span><span class="op" id="6215309">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6215312">}</span><br>
<span class="lineno">800</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6215316"><a href="/archive/tar/reader.go.html#6214738">n</a></span><span class="op" id="6215317">,</span>&nbsp;<span class="ident" id="6215319"><a href="/archive/tar/reader.go.html#6214745">err</a></span>&nbsp;<span class="op" id="6215323">=</span>&nbsp;<span class="ident" id="6215325"><a href="/archive/tar/reader.go.html#6214699">sfr</a></span><span class="op" id="6215328">.</span><span class="ident" id="6215329">rfr</span><span class="op" id="6215332">.</span><span class="ident" id="6215333">Read</span><span class="op" id="6215337">(</span><span class="ident" id="6215338"><a href="/archive/tar/reader.go.html#6214727">b</a></span><span class="op" id="6215339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6215342"><a href="/archive/tar/reader.go.html#6214699">sfr</a></span><span class="op" id="6215345">.</span><span class="ident" id="6215346">pos</span>&nbsp;<span class="op" id="6215350">+=</span>&nbsp;<span class="ident" id="6215353">int64</span><span class="op" id="6215358">(</span><span class="ident" id="6215359"><a href="/archive/tar/reader.go.html#6214738">n</a></span><span class="op" id="6215360">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6215364">if</span>&nbsp;<span class="ident" id="6215367">int64</span><span class="op" id="6215372">(</span><span class="ident" id="6215373"><a href="/archive/tar/reader.go.html#6214738">n</a></span><span class="op" id="6215374">)</span>&nbsp;<span class="op" id="6215376">==</span>&nbsp;<span class="ident" id="6215379"><a href="/archive/tar/reader.go.html#6215210">bytesLeft</a></span>&nbsp;<span class="op" id="6215389">{</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6215393">//&nbsp;We&#39;re&nbsp;done&nbsp;with&nbsp;this&nbsp;fragment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6215428"><a href="/archive/tar/reader.go.html#6214699">sfr</a></span><span class="op" id="6215431">.</span><span class="ident" id="6215432">sp</span>&nbsp;<span class="op" id="6215435">=</span>&nbsp;<span class="ident" id="6215437"><a href="/archive/tar/reader.go.html#6214699">sfr</a></span><span class="op" id="6215440">.</span><span class="ident" id="6215441">sp</span><span class="op" id="6215443">[</span><span class="num" id="6215444">1</span><span class="op" id="6215445">:</span><span class="op" id="6215446">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6215449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6215453">if</span>&nbsp;<span class="ident" id="6215456"><a href="/archive/tar/reader.go.html#6214745">err</a></span>&nbsp;<span class="op" id="6215460">==</span>&nbsp;<span class="ident" id="6215463"><a href="/archive/tar/reader.go.html#6193682">io</a></span><span class="op" id="6215465">.</span><span class="ident" id="6215466">EOF</span>&nbsp;<span class="op" id="6215470">&amp;&amp;</span>&nbsp;<span class="ident" id="6215473"><a href="/archive/tar/reader.go.html#6214699">sfr</a></span><span class="op" id="6215476">.</span><span class="ident" id="6215477">pos</span>&nbsp;<span class="op" id="6215481">&lt;</span>&nbsp;<span class="ident" id="6215483"><a href="/archive/tar/reader.go.html#6214699">sfr</a></span><span class="op" id="6215486">.</span><span class="ident" id="6215487">tot</span>&nbsp;<span class="op" id="6215491">{</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6215495">//&nbsp;We&nbsp;reached&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;last&nbsp;fragment&#39;s&nbsp;data,&nbsp;but&nbsp;there&#39;s&nbsp;a&nbsp;final&nbsp;hole</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6215573"><a href="/archive/tar/reader.go.html#6214745">err</a></span>&nbsp;<span class="op" id="6215577">=</span>&nbsp;<span class="ident" id="6215579">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6215584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6215587">return</span><br>
<span class="lineno"></span><span class="op" id="6215594">}</span><br>
<span class="lineno">815</span><br>
<span class="lineno"></span><span class="comment" id="6215597">//&nbsp;numBytes&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;left&nbsp;to&nbsp;read&nbsp;in&nbsp;the&nbsp;sparse&nbsp;file&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="6215671">//&nbsp;sparse-encoded&nbsp;data&nbsp;in&nbsp;the&nbsp;tar&nbsp;archive.</span><br>
<span class="lineno"></span><span class="keyword" id="6215714">func</span>&nbsp;<span class="op" id="6215719">(</span><span class="ident" id="6215720">sfr</span>&nbsp;<span class="op" id="6215724">*</span><span class="ident" id="6215725"><a href="/archive/tar/reader.go.html#6194876">sparseFileReader</a></span><span class="op" id="6215741">)</span>&nbsp;<span class="ident" id="6215743">numBytes</span><span class="op" id="6215751">(</span><span class="op" id="6215752">)</span>&nbsp;<span class="ident" id="6215754">int64</span>&nbsp;<span class="op" id="6215760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6215763">return</span>&nbsp;<span class="ident" id="6215770"><a href="/archive/tar/reader.go.html#6215720">sfr</a></span><span class="op" id="6215773">.</span><span class="ident" id="6215774">rfr</span><span class="op" id="6215777">.</span><span class="ident" id="6215778">nb</span><br>
<span class="lineno">820</span><span class="op" id="6215781">}</span>
</div>
</body>
</html>
