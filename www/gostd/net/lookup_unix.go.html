<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html" class="current">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4130599">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4130655">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4130709">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4130760">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4130825">package</span>&nbsp;<span class="ident" id="4130833">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4130838">import</span>&nbsp;<span class="op" id="4130845">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4130848">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4130858">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="4130865">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4130868">var</span>&nbsp;<span class="ident" id="4130872">onceReadProtocols</span>&nbsp;<span class="ident" id="4130890">sync</span><span class="op" id="4130894">.</span><span class="ident" id="4130895">Once</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="4130901">//&nbsp;readProtocols&nbsp;loads&nbsp;contents&nbsp;of&nbsp;/etc/protocols&nbsp;into&nbsp;protocols&nbsp;map</span><br>
<span class="lineno"></span><span class="comment" id="4130970">//&nbsp;for&nbsp;quick&nbsp;access.</span><br>
<span class="lineno"></span><span class="keyword" id="4130991">func</span>&nbsp;<span class="ident" id="4130996">readProtocols</span><span class="op" id="4131009">(</span><span class="op" id="4131010">)</span>&nbsp;<span class="op" id="4131012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131015">if</span>&nbsp;<span class="ident" id="4131018">file</span><span class="op" id="4131022">,</span>&nbsp;<span class="ident" id="4131024">err</span>&nbsp;<span class="op" id="4131028">:=</span>&nbsp;<span class="ident" id="4131031">open</span><span class="op" id="4131035">(</span><span class="string" id="4131036">&#34;/etc/protocols&#34;</span><span class="op" id="4131052">)</span><span class="op" id="4131053">;</span>&nbsp;<span class="ident" id="4131055">err</span>&nbsp;<span class="op" id="4131059">==</span>&nbsp;<span class="ident" id="4131062">nil</span>&nbsp;<span class="op" id="4131066">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131070">for</span>&nbsp;<span class="ident" id="4131074">line</span><span class="op" id="4131078">,</span>&nbsp;<span class="ident" id="4131080">ok</span>&nbsp;<span class="op" id="4131083">:=</span>&nbsp;<span class="ident" id="4131086">file</span><span class="op" id="4131090">.</span><span class="ident" id="4131091">readLine</span><span class="op" id="4131099">(</span><span class="op" id="4131100">)</span><span class="op" id="4131101">;</span>&nbsp;<span class="ident" id="4131103">ok</span><span class="op" id="4131105">;</span>&nbsp;<span class="ident" id="4131107">line</span><span class="op" id="4131111">,</span>&nbsp;<span class="ident" id="4131113">ok</span>&nbsp;<span class="op" id="4131116">=</span>&nbsp;<span class="ident" id="4131118">file</span><span class="op" id="4131122">.</span><span class="ident" id="4131123">readLine</span><span class="op" id="4131131">(</span><span class="op" id="4131132">)</span>&nbsp;<span class="op" id="4131134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4131139">//&nbsp;tcp&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;TCP&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;transmission&nbsp;control&nbsp;protocol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131195">if</span>&nbsp;<span class="ident" id="4131198">i</span>&nbsp;<span class="op" id="4131200">:=</span>&nbsp;<span class="ident" id="4131203">byteIndex</span><span class="op" id="4131212">(</span><span class="ident" id="4131213">line</span><span class="op" id="4131217">,</span>&nbsp;<span class="string" id="4131219">&#39;#&#39;</span><span class="op" id="4131222">)</span><span class="op" id="4131223">;</span>&nbsp;<span class="ident" id="4131225">i</span>&nbsp;<span class="op" id="4131227">&gt;=</span>&nbsp;<span class="num" id="4131230">0</span>&nbsp;<span class="op" id="4131232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131238">line</span>&nbsp;<span class="op" id="4131243">=</span>&nbsp;<span class="ident" id="4131245">line</span><span class="op" id="4131249">[</span><span class="num" id="4131250">0</span><span class="op" id="4131251">:</span><span class="ident" id="4131252">i</span><span class="op" id="4131253">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4131258">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131263">f</span>&nbsp;<span class="op" id="4131265">:=</span>&nbsp;<span class="ident" id="4131268">getFields</span><span class="op" id="4131277">(</span><span class="ident" id="4131278">line</span><span class="op" id="4131282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131287">if</span>&nbsp;<span class="builtinfunc" id="4131290">len</span><span class="op" id="4131293">(</span><span class="ident" id="4131294">f</span><span class="op" id="4131295">)</span>&nbsp;<span class="op" id="4131297">&lt;</span>&nbsp;<span class="num" id="4131299">2</span>&nbsp;<span class="op" id="4131301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131307">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4131319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131324">if</span>&nbsp;<span class="ident" id="4131327">proto</span><span class="op" id="4131332">,</span>&nbsp;<span class="ident" id="4131334">_</span><span class="op" id="4131335">,</span>&nbsp;<span class="ident" id="4131337">ok</span>&nbsp;<span class="op" id="4131340">:=</span>&nbsp;<span class="ident" id="4131343">dtoi</span><span class="op" id="4131347">(</span><span class="ident" id="4131348">f</span><span class="op" id="4131349">[</span><span class="num" id="4131350">1</span><span class="op" id="4131351">]</span><span class="op" id="4131352">,</span>&nbsp;<span class="num" id="4131354">0</span><span class="op" id="4131355">)</span><span class="op" id="4131356">;</span>&nbsp;<span class="ident" id="4131358">ok</span>&nbsp;<span class="op" id="4131361">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131367">if</span>&nbsp;<span class="ident" id="4131370">_</span><span class="op" id="4131371">,</span>&nbsp;<span class="ident" id="4131373">ok</span>&nbsp;<span class="op" id="4131376">:=</span>&nbsp;<span class="ident" id="4131379">protocols</span><span class="op" id="4131388">[</span><span class="ident" id="4131389">f</span><span class="op" id="4131390">[</span><span class="num" id="4131391">0</span><span class="op" id="4131392">]</span><span class="op" id="4131393">]</span><span class="op" id="4131394">;</span>&nbsp;<span class="op" id="4131396">!</span><span class="ident" id="4131397">ok</span>&nbsp;<span class="op" id="4131400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131407">protocols</span><span class="op" id="4131416">[</span><span class="ident" id="4131417">f</span><span class="op" id="4131418">[</span><span class="num" id="4131419">0</span><span class="op" id="4131420">]</span><span class="op" id="4131421">]</span>&nbsp;<span class="op" id="4131423">=</span>&nbsp;<span class="ident" id="4131425">proto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4131435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131441">for</span>&nbsp;<span class="ident" id="4131445">_</span><span class="op" id="4131446">,</span>&nbsp;<span class="ident" id="4131448">alias</span>&nbsp;<span class="op" id="4131454">:=</span>&nbsp;<span class="keyword" id="4131457">range</span>&nbsp;<span class="ident" id="4131463">f</span><span class="op" id="4131464">[</span><span class="num" id="4131465">2</span><span class="op" id="4131466">:</span><span class="op" id="4131467">]</span>&nbsp;<span class="op" id="4131469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131476">if</span>&nbsp;<span class="ident" id="4131479">_</span><span class="op" id="4131480">,</span>&nbsp;<span class="ident" id="4131482">ok</span>&nbsp;<span class="op" id="4131485">:=</span>&nbsp;<span class="ident" id="4131488">protocols</span><span class="op" id="4131497">[</span><span class="ident" id="4131498">alias</span><span class="op" id="4131503">]</span><span class="op" id="4131504">;</span>&nbsp;<span class="op" id="4131506">!</span><span class="ident" id="4131507">ok</span>&nbsp;<span class="op" id="4131510">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131518">protocols</span><span class="op" id="4131527">[</span><span class="ident" id="4131528">alias</span><span class="op" id="4131533">]</span>&nbsp;<span class="op" id="4131535">=</span>&nbsp;<span class="ident" id="4131537">proto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4131548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4131554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4131559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4131563">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131567">file</span><span class="op" id="4131571">.</span><span class="builtinfunc" id="4131572">close</span><span class="op" id="4131577">(</span><span class="op" id="4131578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4131581">}</span><br>
<span class="lineno"></span><span class="op" id="4131583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4131586">//&nbsp;lookupProtocol&nbsp;looks&nbsp;up&nbsp;IP&nbsp;protocol&nbsp;name&nbsp;in&nbsp;/etc/protocols&nbsp;and</span><br>
<span class="lineno">45</span><span class="comment" id="4131652">//&nbsp;returns&nbsp;correspondent&nbsp;protocol&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="4131694">func</span>&nbsp;<span class="ident" id="4131699">lookupProtocol</span><span class="op" id="4131713">(</span><span class="ident" id="4131714">name</span>&nbsp;<span class="builtintype" id="4131719">string</span><span class="op" id="4131725">)</span>&nbsp;<span class="op" id="4131727">(</span><span class="ident" id="4131728">proto</span>&nbsp;<span class="builtintype" id="4131734">int</span><span class="op" id="4131737">,</span>&nbsp;<span class="ident" id="4131739">err</span>&nbsp;<span class="builtintype" id="4131743">error</span><span class="op" id="4131748">)</span>&nbsp;<span class="op" id="4131750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131753">onceReadProtocols</span><span class="op" id="4131770">.</span><span class="ident" id="4131771">Do</span><span class="op" id="4131773">(</span><span class="ident" id="4131774">readProtocols</span><span class="op" id="4131787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131790">proto</span><span class="op" id="4131795">,</span>&nbsp;<span class="ident" id="4131797">found</span>&nbsp;<span class="op" id="4131803">:=</span>&nbsp;<span class="ident" id="4131806">protocols</span><span class="op" id="4131815">[</span><span class="ident" id="4131816">name</span><span class="op" id="4131820">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131823">if</span>&nbsp;<span class="op" id="4131826">!</span><span class="ident" id="4131827">found</span>&nbsp;<span class="op" id="4131833">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131837">return</span>&nbsp;<span class="num" id="4131844">0</span><span class="op" id="4131845">,</span>&nbsp;<span class="ident" id="4131847">errors</span><span class="op" id="4131853">.</span><span class="ident" id="4131854">New</span><span class="op" id="4131857">(</span><span class="string" id="4131858">&#34;unknown&nbsp;IP&nbsp;protocol&nbsp;specified:&nbsp;&#34;</span>&nbsp;<span class="op" id="4131892">+</span>&nbsp;<span class="ident" id="4131894">name</span><span class="op" id="4131898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4131901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131904">return</span><br>
<span class="lineno"></span><span class="op" id="4131911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="4131914">func</span>&nbsp;<span class="ident" id="4131919">lookupHost</span><span class="op" id="4131929">(</span><span class="ident" id="4131930">host</span>&nbsp;<span class="builtintype" id="4131935">string</span><span class="op" id="4131941">)</span>&nbsp;<span class="op" id="4131943">(</span><span class="ident" id="4131944">addrs</span>&nbsp;<span class="op" id="4131950">[</span><span class="op" id="4131951">]</span><span class="builtintype" id="4131952">string</span><span class="op" id="4131958">,</span>&nbsp;<span class="ident" id="4131960">err</span>&nbsp;<span class="builtintype" id="4131964">error</span><span class="op" id="4131969">)</span>&nbsp;<span class="op" id="4131971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131974">addrs</span><span class="op" id="4131979">,</span>&nbsp;<span class="ident" id="4131981">err</span><span class="op" id="4131984">,</span>&nbsp;<span class="ident" id="4131986">ok</span>&nbsp;<span class="op" id="4131989">:=</span>&nbsp;<span class="ident" id="4131992">cgoLookupHost</span><span class="op" id="4132005">(</span><span class="ident" id="4132006">host</span><span class="op" id="4132010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4132013">if</span>&nbsp;<span class="op" id="4132016">!</span><span class="ident" id="4132017">ok</span>&nbsp;<span class="op" id="4132020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132024">addrs</span><span class="op" id="4132029">,</span>&nbsp;<span class="ident" id="4132031">err</span>&nbsp;<span class="op" id="4132035">=</span>&nbsp;<span class="ident" id="4132037">goLookupHost</span><span class="op" id="4132049">(</span><span class="ident" id="4132050">host</span><span class="op" id="4132054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4132057">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4132060">return</span><br>
<span class="lineno"></span><span class="op" id="4132067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4132070">func</span>&nbsp;<span class="ident" id="4132075">lookupIP</span><span class="op" id="4132083">(</span><span class="ident" id="4132084">host</span>&nbsp;<span class="builtintype" id="4132089">string</span><span class="op" id="4132095">)</span>&nbsp;<span class="op" id="4132097">(</span><span class="ident" id="4132098">addrs</span>&nbsp;<span class="op" id="4132104">[</span><span class="op" id="4132105">]</span><span class="ident" id="4132106">IP</span><span class="op" id="4132108">,</span>&nbsp;<span class="ident" id="4132110">err</span>&nbsp;<span class="builtintype" id="4132114">error</span><span class="op" id="4132119">)</span>&nbsp;<span class="op" id="4132121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132124">addrs</span><span class="op" id="4132129">,</span>&nbsp;<span class="ident" id="4132131">err</span><span class="op" id="4132134">,</span>&nbsp;<span class="ident" id="4132136">ok</span>&nbsp;<span class="op" id="4132139">:=</span>&nbsp;<span class="ident" id="4132142">cgoLookupIP</span><span class="op" id="4132153">(</span><span class="ident" id="4132154">host</span><span class="op" id="4132158">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4132161">if</span>&nbsp;<span class="op" id="4132164">!</span><span class="ident" id="4132165">ok</span>&nbsp;<span class="op" id="4132168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132172">addrs</span><span class="op" id="4132177">,</span>&nbsp;<span class="ident" id="4132179">err</span>&nbsp;<span class="op" id="4132183">=</span>&nbsp;<span class="ident" id="4132185">goLookupIP</span><span class="op" id="4132195">(</span><span class="ident" id="4132196">host</span><span class="op" id="4132200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4132203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4132206">return</span><br>
<span class="lineno"></span><span class="op" id="4132213">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="4132216">func</span>&nbsp;<span class="ident" id="4132221">lookupPort</span><span class="op" id="4132231">(</span><span class="ident" id="4132232">network</span><span class="op" id="4132239">,</span>&nbsp;<span class="ident" id="4132241">service</span>&nbsp;<span class="builtintype" id="4132249">string</span><span class="op" id="4132255">)</span>&nbsp;<span class="op" id="4132257">(</span><span class="ident" id="4132258">port</span>&nbsp;<span class="builtintype" id="4132263">int</span><span class="op" id="4132266">,</span>&nbsp;<span class="ident" id="4132268">err</span>&nbsp;<span class="builtintype" id="4132272">error</span><span class="op" id="4132277">)</span>&nbsp;<span class="op" id="4132279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132282">port</span><span class="op" id="4132286">,</span>&nbsp;<span class="ident" id="4132288">err</span><span class="op" id="4132291">,</span>&nbsp;<span class="ident" id="4132293">ok</span>&nbsp;<span class="op" id="4132296">:=</span>&nbsp;<span class="ident" id="4132299">cgoLookupPort</span><span class="op" id="4132312">(</span><span class="ident" id="4132313">network</span><span class="op" id="4132320">,</span>&nbsp;<span class="ident" id="4132322">service</span><span class="op" id="4132329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4132332">if</span>&nbsp;<span class="op" id="4132335">!</span><span class="ident" id="4132336">ok</span>&nbsp;<span class="op" id="4132339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132343">port</span><span class="op" id="4132347">,</span>&nbsp;<span class="ident" id="4132349">err</span>&nbsp;<span class="op" id="4132353">=</span>&nbsp;<span class="ident" id="4132355">goLookupPort</span><span class="op" id="4132367">(</span><span class="ident" id="4132368">network</span><span class="op" id="4132375">,</span>&nbsp;<span class="ident" id="4132377">service</span><span class="op" id="4132384">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4132387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4132390">return</span><br>
<span class="lineno"></span><span class="op" id="4132397">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4132400">func</span>&nbsp;<span class="ident" id="4132405">lookupCNAME</span><span class="op" id="4132416">(</span><span class="ident" id="4132417">name</span>&nbsp;<span class="builtintype" id="4132422">string</span><span class="op" id="4132428">)</span>&nbsp;<span class="op" id="4132430">(</span><span class="ident" id="4132431">cname</span>&nbsp;<span class="builtintype" id="4132437">string</span><span class="op" id="4132443">,</span>&nbsp;<span class="ident" id="4132445">err</span>&nbsp;<span class="builtintype" id="4132449">error</span><span class="op" id="4132454">)</span>&nbsp;<span class="op" id="4132456">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132459">cname</span><span class="op" id="4132464">,</span>&nbsp;<span class="ident" id="4132466">err</span><span class="op" id="4132469">,</span>&nbsp;<span class="ident" id="4132471">ok</span>&nbsp;<span class="op" id="4132474">:=</span>&nbsp;<span class="ident" id="4132477">cgoLookupCNAME</span><span class="op" id="4132491">(</span><span class="ident" id="4132492">name</span><span class="op" id="4132496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4132499">if</span>&nbsp;<span class="op" id="4132502">!</span><span class="ident" id="4132503">ok</span>&nbsp;<span class="op" id="4132506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132510">cname</span><span class="op" id="4132515">,</span>&nbsp;<span class="ident" id="4132517">err</span>&nbsp;<span class="op" id="4132521">=</span>&nbsp;<span class="ident" id="4132523">goLookupCNAME</span><span class="op" id="4132536">(</span><span class="ident" id="4132537">name</span><span class="op" id="4132541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4132544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4132547">return</span><br>
<span class="lineno">85</span><span class="op" id="4132554">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4132557">func</span>&nbsp;<span class="ident" id="4132562">lookupSRV</span><span class="op" id="4132571">(</span><span class="ident" id="4132572">service</span><span class="op" id="4132579">,</span>&nbsp;<span class="ident" id="4132581">proto</span><span class="op" id="4132586">,</span>&nbsp;<span class="ident" id="4132588">name</span>&nbsp;<span class="builtintype" id="4132593">string</span><span class="op" id="4132599">)</span>&nbsp;<span class="op" id="4132601">(</span><span class="ident" id="4132602">cname</span>&nbsp;<span class="builtintype" id="4132608">string</span><span class="op" id="4132614">,</span>&nbsp;<span class="ident" id="4132616">addrs</span>&nbsp;<span class="op" id="4132622">[</span><span class="op" id="4132623">]</span><span class="op" id="4132624">*</span><span class="ident" id="4132625">SRV</span><span class="op" id="4132628">,</span>&nbsp;<span class="ident" id="4132630">err</span>&nbsp;<span class="builtintype" id="4132634">error</span><span class="op" id="4132639">)</span>&nbsp;<span class="op" id="4132641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4132644">var</span>&nbsp;<span class="ident" id="4132648">target</span>&nbsp;<span class="builtintype" id="4132655">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4132663">if</span>&nbsp;<span class="ident" id="4132666">service</span>&nbsp;<span class="op" id="4132674">==</span>&nbsp;<span class="string" id="4132677">&#34;&#34;</span>&nbsp;<span class="op" id="4132680">&amp;&amp;</span>&nbsp;<span class="ident" id="4132683">proto</span>&nbsp;<span class="op" id="4132689">==</span>&nbsp;<span class="string" id="4132692">&#34;&#34;</span>&nbsp;<span class="op" id="4132695">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132699">target</span>&nbsp;<span class="op" id="4132706">=</span>&nbsp;<span class="ident" id="4132708">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4132714">}</span>&nbsp;<span class="keyword" id="4132716">else</span>&nbsp;<span class="op" id="4132721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132725">target</span>&nbsp;<span class="op" id="4132732">=</span>&nbsp;<span class="string" id="4132734">&#34;_&#34;</span>&nbsp;<span class="op" id="4132738">+</span>&nbsp;<span class="ident" id="4132740">service</span>&nbsp;<span class="op" id="4132748">+</span>&nbsp;<span class="string" id="4132750">&#34;._&#34;</span>&nbsp;<span class="op" id="4132755">+</span>&nbsp;<span class="ident" id="4132757">proto</span>&nbsp;<span class="op" id="4132763">+</span>&nbsp;<span class="string" id="4132765">&#34;.&#34;</span>&nbsp;<span class="op" id="4132769">+</span>&nbsp;<span class="ident" id="4132771">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4132777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4132780">var</span>&nbsp;<span class="ident" id="4132784">records</span>&nbsp;<span class="op" id="4132792">[</span><span class="op" id="4132793">]</span><span class="ident" id="4132794">dnsRR</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132801">cname</span><span class="op" id="4132806">,</span>&nbsp;<span class="ident" id="4132808">records</span><span class="op" id="4132815">,</span>&nbsp;<span class="ident" id="4132817">err</span>&nbsp;<span class="op" id="4132821">=</span>&nbsp;<span class="ident" id="4132823">lookup</span><span class="op" id="4132829">(</span><span class="ident" id="4132830">target</span><span class="op" id="4132836">,</span>&nbsp;<span class="ident" id="4132838">dnsTypeSRV</span><span class="op" id="4132848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4132851">if</span>&nbsp;<span class="ident" id="4132854">err</span>&nbsp;<span class="op" id="4132858">!=</span>&nbsp;<span class="ident" id="4132861">nil</span>&nbsp;<span class="op" id="4132865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4132869">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4132877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132880">addrs</span>&nbsp;<span class="op" id="4132886">=</span>&nbsp;<span class="builtinfunc" id="4132888">make</span><span class="op" id="4132892">(</span><span class="op" id="4132893">[</span><span class="op" id="4132894">]</span><span class="op" id="4132895">*</span><span class="ident" id="4132896">SRV</span><span class="op" id="4132899">,</span>&nbsp;<span class="builtinfunc" id="4132901">len</span><span class="op" id="4132904">(</span><span class="ident" id="4132905">records</span><span class="op" id="4132912">)</span><span class="op" id="4132913">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4132916">for</span>&nbsp;<span class="ident" id="4132920">i</span><span class="op" id="4132921">,</span>&nbsp;<span class="ident" id="4132923">rr</span>&nbsp;<span class="op" id="4132926">:=</span>&nbsp;<span class="keyword" id="4132929">range</span>&nbsp;<span class="ident" id="4132935">records</span>&nbsp;<span class="op" id="4132943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132947">r</span>&nbsp;<span class="op" id="4132949">:=</span>&nbsp;<span class="ident" id="4132952">rr</span><span class="op" id="4132954">.</span><span class="op" id="4132955">(</span><span class="op" id="4132956">*</span><span class="ident" id="4132957">dnsRR_SRV</span><span class="op" id="4132966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132970">addrs</span><span class="op" id="4132975">[</span><span class="ident" id="4132976">i</span><span class="op" id="4132977">]</span>&nbsp;<span class="op" id="4132979">=</span>&nbsp;<span class="op" id="4132981">&amp;</span><span class="ident" id="4132982">SRV</span><span class="op" id="4132985">{</span><span class="ident" id="4132986">r</span><span class="op" id="4132987">.</span><span class="ident" id="4132988">Target</span><span class="op" id="4132994">,</span>&nbsp;<span class="ident" id="4132996">r</span><span class="op" id="4132997">.</span><span class="ident" id="4132998">Port</span><span class="op" id="4133002">,</span>&nbsp;<span class="ident" id="4133004">r</span><span class="op" id="4133005">.</span><span class="ident" id="4133006">Priority</span><span class="op" id="4133014">,</span>&nbsp;<span class="ident" id="4133016">r</span><span class="op" id="4133017">.</span><span class="ident" id="4133018">Weight</span><span class="op" id="4133024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4133027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133030">byPriorityWeight</span><span class="op" id="4133046">(</span><span class="ident" id="4133047">addrs</span><span class="op" id="4133052">)</span><span class="op" id="4133053">.</span><span class="ident" id="4133054">sort</span><span class="op" id="4133058">(</span><span class="op" id="4133059">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133062">return</span><br>
<span class="lineno"></span><span class="op" id="4133069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4133072">func</span>&nbsp;<span class="ident" id="4133077">lookupMX</span><span class="op" id="4133085">(</span><span class="ident" id="4133086">name</span>&nbsp;<span class="builtintype" id="4133091">string</span><span class="op" id="4133097">)</span>&nbsp;<span class="op" id="4133099">(</span><span class="ident" id="4133100">mx</span>&nbsp;<span class="op" id="4133103">[</span><span class="op" id="4133104">]</span><span class="op" id="4133105">*</span><span class="ident" id="4133106">MX</span><span class="op" id="4133108">,</span>&nbsp;<span class="ident" id="4133110">err</span>&nbsp;<span class="builtintype" id="4133114">error</span><span class="op" id="4133119">)</span>&nbsp;<span class="op" id="4133121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133124">_</span><span class="op" id="4133125">,</span>&nbsp;<span class="ident" id="4133127">records</span><span class="op" id="4133134">,</span>&nbsp;<span class="ident" id="4133136">err</span>&nbsp;<span class="op" id="4133140">:=</span>&nbsp;<span class="ident" id="4133143">lookup</span><span class="op" id="4133149">(</span><span class="ident" id="4133150">name</span><span class="op" id="4133154">,</span>&nbsp;<span class="ident" id="4133156">dnsTypeMX</span><span class="op" id="4133165">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133168">if</span>&nbsp;<span class="ident" id="4133171">err</span>&nbsp;<span class="op" id="4133175">!=</span>&nbsp;<span class="ident" id="4133178">nil</span>&nbsp;<span class="op" id="4133182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133186">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4133194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133197">mx</span>&nbsp;<span class="op" id="4133200">=</span>&nbsp;<span class="builtinfunc" id="4133202">make</span><span class="op" id="4133206">(</span><span class="op" id="4133207">[</span><span class="op" id="4133208">]</span><span class="op" id="4133209">*</span><span class="ident" id="4133210">MX</span><span class="op" id="4133212">,</span>&nbsp;<span class="builtinfunc" id="4133214">len</span><span class="op" id="4133217">(</span><span class="ident" id="4133218">records</span><span class="op" id="4133225">)</span><span class="op" id="4133226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133229">for</span>&nbsp;<span class="ident" id="4133233">i</span><span class="op" id="4133234">,</span>&nbsp;<span class="ident" id="4133236">rr</span>&nbsp;<span class="op" id="4133239">:=</span>&nbsp;<span class="keyword" id="4133242">range</span>&nbsp;<span class="ident" id="4133248">records</span>&nbsp;<span class="op" id="4133256">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133260">r</span>&nbsp;<span class="op" id="4133262">:=</span>&nbsp;<span class="ident" id="4133265">rr</span><span class="op" id="4133267">.</span><span class="op" id="4133268">(</span><span class="op" id="4133269">*</span><span class="ident" id="4133270">dnsRR_MX</span><span class="op" id="4133278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133282">mx</span><span class="op" id="4133284">[</span><span class="ident" id="4133285">i</span><span class="op" id="4133286">]</span>&nbsp;<span class="op" id="4133288">=</span>&nbsp;<span class="op" id="4133290">&amp;</span><span class="ident" id="4133291">MX</span><span class="op" id="4133293">{</span><span class="ident" id="4133294">r</span><span class="op" id="4133295">.</span><span class="ident" id="4133296">Mx</span><span class="op" id="4133298">,</span>&nbsp;<span class="ident" id="4133300">r</span><span class="op" id="4133301">.</span><span class="ident" id="4133302">Pref</span><span class="op" id="4133306">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4133309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133312">byPref</span><span class="op" id="4133318">(</span><span class="ident" id="4133319">mx</span><span class="op" id="4133321">)</span><span class="op" id="4133322">.</span><span class="ident" id="4133323">sort</span><span class="op" id="4133327">(</span><span class="op" id="4133328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133331">return</span><br>
<span class="lineno">120</span><span class="op" id="4133338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4133341">func</span>&nbsp;<span class="ident" id="4133346">lookupNS</span><span class="op" id="4133354">(</span><span class="ident" id="4133355">name</span>&nbsp;<span class="builtintype" id="4133360">string</span><span class="op" id="4133366">)</span>&nbsp;<span class="op" id="4133368">(</span><span class="ident" id="4133369">ns</span>&nbsp;<span class="op" id="4133372">[</span><span class="op" id="4133373">]</span><span class="op" id="4133374">*</span><span class="ident" id="4133375">NS</span><span class="op" id="4133377">,</span>&nbsp;<span class="ident" id="4133379">err</span>&nbsp;<span class="builtintype" id="4133383">error</span><span class="op" id="4133388">)</span>&nbsp;<span class="op" id="4133390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133393">_</span><span class="op" id="4133394">,</span>&nbsp;<span class="ident" id="4133396">records</span><span class="op" id="4133403">,</span>&nbsp;<span class="ident" id="4133405">err</span>&nbsp;<span class="op" id="4133409">:=</span>&nbsp;<span class="ident" id="4133412">lookup</span><span class="op" id="4133418">(</span><span class="ident" id="4133419">name</span><span class="op" id="4133423">,</span>&nbsp;<span class="ident" id="4133425">dnsTypeNS</span><span class="op" id="4133434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133437">if</span>&nbsp;<span class="ident" id="4133440">err</span>&nbsp;<span class="op" id="4133444">!=</span>&nbsp;<span class="ident" id="4133447">nil</span>&nbsp;<span class="op" id="4133451">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133455">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4133463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133466">ns</span>&nbsp;<span class="op" id="4133469">=</span>&nbsp;<span class="builtinfunc" id="4133471">make</span><span class="op" id="4133475">(</span><span class="op" id="4133476">[</span><span class="op" id="4133477">]</span><span class="op" id="4133478">*</span><span class="ident" id="4133479">NS</span><span class="op" id="4133481">,</span>&nbsp;<span class="builtinfunc" id="4133483">len</span><span class="op" id="4133486">(</span><span class="ident" id="4133487">records</span><span class="op" id="4133494">)</span><span class="op" id="4133495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133498">for</span>&nbsp;<span class="ident" id="4133502">i</span><span class="op" id="4133503">,</span>&nbsp;<span class="ident" id="4133505">r</span>&nbsp;<span class="op" id="4133507">:=</span>&nbsp;<span class="keyword" id="4133510">range</span>&nbsp;<span class="ident" id="4133516">records</span>&nbsp;<span class="op" id="4133524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133528">r</span>&nbsp;<span class="op" id="4133530">:=</span>&nbsp;<span class="ident" id="4133533">r</span><span class="op" id="4133534">.</span><span class="op" id="4133535">(</span><span class="op" id="4133536">*</span><span class="ident" id="4133537">dnsRR_NS</span><span class="op" id="4133545">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133549">ns</span><span class="op" id="4133551">[</span><span class="ident" id="4133552">i</span><span class="op" id="4133553">]</span>&nbsp;<span class="op" id="4133555">=</span>&nbsp;<span class="op" id="4133557">&amp;</span><span class="ident" id="4133558">NS</span><span class="op" id="4133560">{</span><span class="ident" id="4133561">r</span><span class="op" id="4133562">.</span><span class="ident" id="4133563">Ns</span><span class="op" id="4133565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4133568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133571">return</span><br>
<span class="lineno"></span><span class="op" id="4133578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="4133581">func</span>&nbsp;<span class="ident" id="4133586">lookupTXT</span><span class="op" id="4133595">(</span><span class="ident" id="4133596">name</span>&nbsp;<span class="builtintype" id="4133601">string</span><span class="op" id="4133607">)</span>&nbsp;<span class="op" id="4133609">(</span><span class="ident" id="4133610">txt</span>&nbsp;<span class="op" id="4133614">[</span><span class="op" id="4133615">]</span><span class="builtintype" id="4133616">string</span><span class="op" id="4133622">,</span>&nbsp;<span class="ident" id="4133624">err</span>&nbsp;<span class="builtintype" id="4133628">error</span><span class="op" id="4133633">)</span>&nbsp;<span class="op" id="4133635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133638">_</span><span class="op" id="4133639">,</span>&nbsp;<span class="ident" id="4133641">records</span><span class="op" id="4133648">,</span>&nbsp;<span class="ident" id="4133650">err</span>&nbsp;<span class="op" id="4133654">:=</span>&nbsp;<span class="ident" id="4133657">lookup</span><span class="op" id="4133663">(</span><span class="ident" id="4133664">name</span><span class="op" id="4133668">,</span>&nbsp;<span class="ident" id="4133670">dnsTypeTXT</span><span class="op" id="4133680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133683">if</span>&nbsp;<span class="ident" id="4133686">err</span>&nbsp;<span class="op" id="4133690">!=</span>&nbsp;<span class="ident" id="4133693">nil</span>&nbsp;<span class="op" id="4133697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133701">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4133709">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133712">txt</span>&nbsp;<span class="op" id="4133716">=</span>&nbsp;<span class="builtinfunc" id="4133718">make</span><span class="op" id="4133722">(</span><span class="op" id="4133723">[</span><span class="op" id="4133724">]</span><span class="builtintype" id="4133725">string</span><span class="op" id="4133731">,</span>&nbsp;<span class="builtinfunc" id="4133733">len</span><span class="op" id="4133736">(</span><span class="ident" id="4133737">records</span><span class="op" id="4133744">)</span><span class="op" id="4133745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133748">for</span>&nbsp;<span class="ident" id="4133752">i</span><span class="op" id="4133753">,</span>&nbsp;<span class="ident" id="4133755">r</span>&nbsp;<span class="op" id="4133757">:=</span>&nbsp;<span class="keyword" id="4133760">range</span>&nbsp;<span class="ident" id="4133766">records</span>&nbsp;<span class="op" id="4133774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133778">txt</span><span class="op" id="4133781">[</span><span class="ident" id="4133782">i</span><span class="op" id="4133783">]</span>&nbsp;<span class="op" id="4133785">=</span>&nbsp;<span class="ident" id="4133787">r</span><span class="op" id="4133788">.</span><span class="op" id="4133789">(</span><span class="op" id="4133790">*</span><span class="ident" id="4133791">dnsRR_TXT</span><span class="op" id="4133800">)</span><span class="op" id="4133801">.</span><span class="ident" id="4133802">Txt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4133807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133810">return</span><br>
<span class="lineno">145</span><span class="op" id="4133817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4133820">func</span>&nbsp;<span class="ident" id="4133825">lookupAddr</span><span class="op" id="4133835">(</span><span class="ident" id="4133836">addr</span>&nbsp;<span class="builtintype" id="4133841">string</span><span class="op" id="4133847">)</span>&nbsp;<span class="op" id="4133849">(</span><span class="ident" id="4133850">name</span>&nbsp;<span class="op" id="4133855">[</span><span class="op" id="4133856">]</span><span class="builtintype" id="4133857">string</span><span class="op" id="4133863">,</span>&nbsp;<span class="ident" id="4133865">err</span>&nbsp;<span class="builtintype" id="4133869">error</span><span class="op" id="4133874">)</span>&nbsp;<span class="op" id="4133876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133879">name</span>&nbsp;<span class="op" id="4133884">=</span>&nbsp;<span class="ident" id="4133886">lookupStaticAddr</span><span class="op" id="4133902">(</span><span class="ident" id="4133903">addr</span><span class="op" id="4133907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133910">if</span>&nbsp;<span class="builtinfunc" id="4133913">len</span><span class="op" id="4133916">(</span><span class="ident" id="4133917">name</span><span class="op" id="4133921">)</span>&nbsp;<span class="op" id="4133923">&gt;</span>&nbsp;<span class="num" id="4133925">0</span>&nbsp;<span class="op" id="4133927">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133931">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4133939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133942">var</span>&nbsp;<span class="ident" id="4133946">arpa</span>&nbsp;<span class="builtintype" id="4133951">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133959">arpa</span><span class="op" id="4133963">,</span>&nbsp;<span class="ident" id="4133965">err</span>&nbsp;<span class="op" id="4133969">=</span>&nbsp;<span class="ident" id="4133971">reverseaddr</span><span class="op" id="4133982">(</span><span class="ident" id="4133983">addr</span><span class="op" id="4133987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133990">if</span>&nbsp;<span class="ident" id="4133993">err</span>&nbsp;<span class="op" id="4133997">!=</span>&nbsp;<span class="ident" id="4134000">nil</span>&nbsp;<span class="op" id="4134004">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4134008">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4134016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4134019">var</span>&nbsp;<span class="ident" id="4134023">records</span>&nbsp;<span class="op" id="4134031">[</span><span class="op" id="4134032">]</span><span class="ident" id="4134033">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4134040">_</span><span class="op" id="4134041">,</span>&nbsp;<span class="ident" id="4134043">records</span><span class="op" id="4134050">,</span>&nbsp;<span class="ident" id="4134052">err</span>&nbsp;<span class="op" id="4134056">=</span>&nbsp;<span class="ident" id="4134058">lookup</span><span class="op" id="4134064">(</span><span class="ident" id="4134065">arpa</span><span class="op" id="4134069">,</span>&nbsp;<span class="ident" id="4134071">dnsTypePTR</span><span class="op" id="4134081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4134084">if</span>&nbsp;<span class="ident" id="4134087">err</span>&nbsp;<span class="op" id="4134091">!=</span>&nbsp;<span class="ident" id="4134094">nil</span>&nbsp;<span class="op" id="4134098">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4134102">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4134110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4134113">name</span>&nbsp;<span class="op" id="4134118">=</span>&nbsp;<span class="builtinfunc" id="4134120">make</span><span class="op" id="4134124">(</span><span class="op" id="4134125">[</span><span class="op" id="4134126">]</span><span class="builtintype" id="4134127">string</span><span class="op" id="4134133">,</span>&nbsp;<span class="builtinfunc" id="4134135">len</span><span class="op" id="4134138">(</span><span class="ident" id="4134139">records</span><span class="op" id="4134146">)</span><span class="op" id="4134147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4134150">for</span>&nbsp;<span class="ident" id="4134154">i</span>&nbsp;<span class="op" id="4134156">:=</span>&nbsp;<span class="keyword" id="4134159">range</span>&nbsp;<span class="ident" id="4134165">records</span>&nbsp;<span class="op" id="4134173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4134177">r</span>&nbsp;<span class="op" id="4134179">:=</span>&nbsp;<span class="ident" id="4134182">records</span><span class="op" id="4134189">[</span><span class="ident" id="4134190">i</span><span class="op" id="4134191">]</span><span class="op" id="4134192">.</span><span class="op" id="4134193">(</span><span class="op" id="4134194">*</span><span class="ident" id="4134195">dnsRR_PTR</span><span class="op" id="4134204">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4134208">name</span><span class="op" id="4134212">[</span><span class="ident" id="4134213">i</span><span class="op" id="4134214">]</span>&nbsp;<span class="op" id="4134216">=</span>&nbsp;<span class="ident" id="4134218">r</span><span class="op" id="4134219">.</span><span class="ident" id="4134220">Ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4134225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4134228">return</span><br>
<span class="lineno"></span><span class="op" id="4134235">}</span>
</div>
</body>
</html>
