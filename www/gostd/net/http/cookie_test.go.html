<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html" class="current">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8220785">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8220841">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8220895">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8220946">package</span>&nbsp;<span class="ident" id="8220954">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8220960">import</span>&nbsp;<span class="op" id="8220967">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8220970">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8220979">&#34;encoding/json&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8220996">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8221003">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8221010">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8221016">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8221027">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8221038">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8221049">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="8221056">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8221059">var</span>&nbsp;<span class="ident" id="8221063">writeSetCookiesTests</span>&nbsp;<span class="op" id="8221084">=</span>&nbsp;<span class="op" id="8221086">[</span><span class="op" id="8221087">]</span><span class="keyword" id="8221088">struct</span>&nbsp;<span class="op" id="8221095">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8221098">Cookie</span>&nbsp;<span class="op" id="8221105">*</span><span class="ident" id="8221106">Cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8221114">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8221121">string</span><br>
<span class="lineno"></span><span class="op" id="8221128">}</span><span class="op" id="8221129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221136">&amp;</span><span class="ident" id="8221137">Cookie</span><span class="op" id="8221143">{</span><span class="ident" id="8221144">Name</span><span class="op" id="8221148">:</span>&nbsp;<span class="string" id="8221150">&#34;cookie-1&#34;</span><span class="op" id="8221160">,</span>&nbsp;<span class="ident" id="8221162">Value</span><span class="op" id="8221167">:</span>&nbsp;<span class="string" id="8221169">&#34;v$1&#34;</span><span class="op" id="8221174">}</span><span class="op" id="8221175">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8221179">&#34;cookie-1=v$1&#34;</span><span class="op" id="8221193">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221196">}</span><span class="op" id="8221197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221204">&amp;</span><span class="ident" id="8221205">Cookie</span><span class="op" id="8221211">{</span><span class="ident" id="8221212">Name</span><span class="op" id="8221216">:</span>&nbsp;<span class="string" id="8221218">&#34;cookie-2&#34;</span><span class="op" id="8221228">,</span>&nbsp;<span class="ident" id="8221230">Value</span><span class="op" id="8221235">:</span>&nbsp;<span class="string" id="8221237">&#34;two&#34;</span><span class="op" id="8221242">,</span>&nbsp;<span class="ident" id="8221244">MaxAge</span><span class="op" id="8221250">:</span>&nbsp;<span class="num" id="8221252">3600</span><span class="op" id="8221256">}</span><span class="op" id="8221257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8221261">&#34;cookie-2=two;&nbsp;Max-Age=3600&#34;</span><span class="op" id="8221289">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221292">}</span><span class="op" id="8221293">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221300">&amp;</span><span class="ident" id="8221301">Cookie</span><span class="op" id="8221307">{</span><span class="ident" id="8221308">Name</span><span class="op" id="8221312">:</span>&nbsp;<span class="string" id="8221314">&#34;cookie-3&#34;</span><span class="op" id="8221324">,</span>&nbsp;<span class="ident" id="8221326">Value</span><span class="op" id="8221331">:</span>&nbsp;<span class="string" id="8221333">&#34;three&#34;</span><span class="op" id="8221340">,</span>&nbsp;<span class="ident" id="8221342">Domain</span><span class="op" id="8221348">:</span>&nbsp;<span class="string" id="8221350">&#34;.example.com&#34;</span><span class="op" id="8221364">}</span><span class="op" id="8221365">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8221369">&#34;cookie-3=three;&nbsp;Domain=example.com&#34;</span><span class="op" id="8221405">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221408">}</span><span class="op" id="8221409">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221416">&amp;</span><span class="ident" id="8221417">Cookie</span><span class="op" id="8221423">{</span><span class="ident" id="8221424">Name</span><span class="op" id="8221428">:</span>&nbsp;<span class="string" id="8221430">&#34;cookie-4&#34;</span><span class="op" id="8221440">,</span>&nbsp;<span class="ident" id="8221442">Value</span><span class="op" id="8221447">:</span>&nbsp;<span class="string" id="8221449">&#34;four&#34;</span><span class="op" id="8221455">,</span>&nbsp;<span class="ident" id="8221457">Path</span><span class="op" id="8221461">:</span>&nbsp;<span class="string" id="8221463">&#34;/restricted/&#34;</span><span class="op" id="8221477">}</span><span class="op" id="8221478">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8221482">&#34;cookie-4=four;&nbsp;Path=/restricted/&#34;</span><span class="op" id="8221516">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221519">}</span><span class="op" id="8221520">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221523">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221527">&amp;</span><span class="ident" id="8221528">Cookie</span><span class="op" id="8221534">{</span><span class="ident" id="8221535">Name</span><span class="op" id="8221539">:</span>&nbsp;<span class="string" id="8221541">&#34;cookie-5&#34;</span><span class="op" id="8221551">,</span>&nbsp;<span class="ident" id="8221553">Value</span><span class="op" id="8221558">:</span>&nbsp;<span class="string" id="8221560">&#34;five&#34;</span><span class="op" id="8221566">,</span>&nbsp;<span class="ident" id="8221568">Domain</span><span class="op" id="8221574">:</span>&nbsp;<span class="string" id="8221576">&#34;wrong;bad.abc&#34;</span><span class="op" id="8221591">}</span><span class="op" id="8221592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8221596">&#34;cookie-5=five&#34;</span><span class="op" id="8221611">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221614">}</span><span class="op" id="8221615">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221622">&amp;</span><span class="ident" id="8221623">Cookie</span><span class="op" id="8221629">{</span><span class="ident" id="8221630">Name</span><span class="op" id="8221634">:</span>&nbsp;<span class="string" id="8221636">&#34;cookie-6&#34;</span><span class="op" id="8221646">,</span>&nbsp;<span class="ident" id="8221648">Value</span><span class="op" id="8221653">:</span>&nbsp;<span class="string" id="8221655">&#34;six&#34;</span><span class="op" id="8221660">,</span>&nbsp;<span class="ident" id="8221662">Domain</span><span class="op" id="8221668">:</span>&nbsp;<span class="string" id="8221670">&#34;bad-.abc&#34;</span><span class="op" id="8221680">}</span><span class="op" id="8221681">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8221685">&#34;cookie-6=six&#34;</span><span class="op" id="8221699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221702">}</span><span class="op" id="8221703">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221710">&amp;</span><span class="ident" id="8221711">Cookie</span><span class="op" id="8221717">{</span><span class="ident" id="8221718">Name</span><span class="op" id="8221722">:</span>&nbsp;<span class="string" id="8221724">&#34;cookie-7&#34;</span><span class="op" id="8221734">,</span>&nbsp;<span class="ident" id="8221736">Value</span><span class="op" id="8221741">:</span>&nbsp;<span class="string" id="8221743">&#34;seven&#34;</span><span class="op" id="8221750">,</span>&nbsp;<span class="ident" id="8221752">Domain</span><span class="op" id="8221758">:</span>&nbsp;<span class="string" id="8221760">&#34;127.0.0.1&#34;</span><span class="op" id="8221771">}</span><span class="op" id="8221772">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8221776">&#34;cookie-7=seven;&nbsp;Domain=127.0.0.1&#34;</span><span class="op" id="8221810">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221813">}</span><span class="op" id="8221814">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221821">&amp;</span><span class="ident" id="8221822">Cookie</span><span class="op" id="8221828">{</span><span class="ident" id="8221829">Name</span><span class="op" id="8221833">:</span>&nbsp;<span class="string" id="8221835">&#34;cookie-8&#34;</span><span class="op" id="8221845">,</span>&nbsp;<span class="ident" id="8221847">Value</span><span class="op" id="8221852">:</span>&nbsp;<span class="string" id="8221854">&#34;eight&#34;</span><span class="op" id="8221861">,</span>&nbsp;<span class="ident" id="8221863">Domain</span><span class="op" id="8221869">:</span>&nbsp;<span class="string" id="8221871">&#34;::1&#34;</span><span class="op" id="8221876">}</span><span class="op" id="8221877">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8221881">&#34;cookie-8=eight&#34;</span><span class="op" id="8221897">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221900">}</span><span class="op" id="8221901">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8221904">//&nbsp;The&nbsp;&#34;special&#34;&nbsp;cookies&nbsp;have&nbsp;values&nbsp;containing&nbsp;commas&nbsp;or&nbsp;spaces&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8221976">//&nbsp;are&nbsp;disallowed&nbsp;by&nbsp;RFC&nbsp;6265&nbsp;but&nbsp;are&nbsp;common&nbsp;in&nbsp;the&nbsp;wild.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222039">&amp;</span><span class="ident" id="8222040">Cookie</span><span class="op" id="8222046">{</span><span class="ident" id="8222047">Name</span><span class="op" id="8222051">:</span>&nbsp;<span class="string" id="8222053">&#34;special-1&#34;</span><span class="op" id="8222064">,</span>&nbsp;<span class="ident" id="8222066">Value</span><span class="op" id="8222071">:</span>&nbsp;<span class="string" id="8222073">&#34;a&nbsp;z&#34;</span><span class="op" id="8222078">}</span><span class="op" id="8222079">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8222083">`special-1=a&nbsp;z`</span><span class="op" id="8222098">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222101">}</span><span class="op" id="8222102">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222109">&amp;</span><span class="ident" id="8222110">Cookie</span><span class="op" id="8222116">{</span><span class="ident" id="8222117">Name</span><span class="op" id="8222121">:</span>&nbsp;<span class="string" id="8222123">&#34;special-2&#34;</span><span class="op" id="8222134">,</span>&nbsp;<span class="ident" id="8222136">Value</span><span class="op" id="8222141">:</span>&nbsp;<span class="string" id="8222143">&#34;&nbsp;z&#34;</span><span class="op" id="8222147">}</span><span class="op" id="8222148">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8222152">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="8222168">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222171">}</span><span class="op" id="8222172">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222179">&amp;</span><span class="ident" id="8222180">Cookie</span><span class="op" id="8222186">{</span><span class="ident" id="8222187">Name</span><span class="op" id="8222191">:</span>&nbsp;<span class="string" id="8222193">&#34;special-3&#34;</span><span class="op" id="8222204">,</span>&nbsp;<span class="ident" id="8222206">Value</span><span class="op" id="8222211">:</span>&nbsp;<span class="string" id="8222213">&#34;a&nbsp;&#34;</span><span class="op" id="8222217">}</span><span class="op" id="8222218">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8222222">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="8222238">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222241">}</span><span class="op" id="8222242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222245">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222249">&amp;</span><span class="ident" id="8222250">Cookie</span><span class="op" id="8222256">{</span><span class="ident" id="8222257">Name</span><span class="op" id="8222261">:</span>&nbsp;<span class="string" id="8222263">&#34;special-4&#34;</span><span class="op" id="8222274">,</span>&nbsp;<span class="ident" id="8222276">Value</span><span class="op" id="8222281">:</span>&nbsp;<span class="string" id="8222283">&#34;&nbsp;&#34;</span><span class="op" id="8222286">}</span><span class="op" id="8222287">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8222291">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="8222306">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222309">}</span><span class="op" id="8222310">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222317">&amp;</span><span class="ident" id="8222318">Cookie</span><span class="op" id="8222324">{</span><span class="ident" id="8222325">Name</span><span class="op" id="8222329">:</span>&nbsp;<span class="string" id="8222331">&#34;special-5&#34;</span><span class="op" id="8222342">,</span>&nbsp;<span class="ident" id="8222344">Value</span><span class="op" id="8222349">:</span>&nbsp;<span class="string" id="8222351">&#34;a,z&#34;</span><span class="op" id="8222356">}</span><span class="op" id="8222357">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8222361">`special-5=a,z`</span><span class="op" id="8222376">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222379">}</span><span class="op" id="8222380">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222387">&amp;</span><span class="ident" id="8222388">Cookie</span><span class="op" id="8222394">{</span><span class="ident" id="8222395">Name</span><span class="op" id="8222399">:</span>&nbsp;<span class="string" id="8222401">&#34;special-6&#34;</span><span class="op" id="8222412">,</span>&nbsp;<span class="ident" id="8222414">Value</span><span class="op" id="8222419">:</span>&nbsp;<span class="string" id="8222421">&#34;,z&#34;</span><span class="op" id="8222425">}</span><span class="op" id="8222426">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8222430">`special-6=&#34;,z&#34;`</span><span class="op" id="8222446">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222449">}</span><span class="op" id="8222450">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222457">&amp;</span><span class="ident" id="8222458">Cookie</span><span class="op" id="8222464">{</span><span class="ident" id="8222465">Name</span><span class="op" id="8222469">:</span>&nbsp;<span class="string" id="8222471">&#34;special-7&#34;</span><span class="op" id="8222482">,</span>&nbsp;<span class="ident" id="8222484">Value</span><span class="op" id="8222489">:</span>&nbsp;<span class="string" id="8222491">&#34;a,&#34;</span><span class="op" id="8222495">}</span><span class="op" id="8222496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8222500">`special-7=&#34;a,&#34;`</span><span class="op" id="8222516">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222519">}</span><span class="op" id="8222520">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222527">&amp;</span><span class="ident" id="8222528">Cookie</span><span class="op" id="8222534">{</span><span class="ident" id="8222535">Name</span><span class="op" id="8222539">:</span>&nbsp;<span class="string" id="8222541">&#34;special-8&#34;</span><span class="op" id="8222552">,</span>&nbsp;<span class="ident" id="8222554">Value</span><span class="op" id="8222559">:</span>&nbsp;<span class="string" id="8222561">&#34;,&#34;</span><span class="op" id="8222564">}</span><span class="op" id="8222565">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8222569">`special-8=&#34;,&#34;`</span><span class="op" id="8222584">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222587">}</span><span class="op" id="8222588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222591">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222595">&amp;</span><span class="ident" id="8222596">Cookie</span><span class="op" id="8222602">{</span><span class="ident" id="8222603">Name</span><span class="op" id="8222607">:</span>&nbsp;<span class="string" id="8222609">&#34;empty-value&#34;</span><span class="op" id="8222622">,</span>&nbsp;<span class="ident" id="8222624">Value</span><span class="op" id="8222629">:</span>&nbsp;<span class="string" id="8222631">&#34;&#34;</span><span class="op" id="8222633">}</span><span class="op" id="8222634">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8222638">`empty-value=`</span><span class="op" id="8222652">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222655">}</span><span class="op" id="8222656">,</span><br>
<span class="lineno"></span><span class="op" id="8222658">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="8222661">func</span>&nbsp;<span class="ident" id="8222666">TestWriteSetCookies</span><span class="op" id="8222685">(</span><span class="ident" id="8222686">t</span>&nbsp;<span class="op" id="8222688">*</span><span class="ident" id="8222689">testing</span><span class="op" id="8222696">.</span><span class="ident" id="8222697">T</span><span class="op" id="8222698">)</span>&nbsp;<span class="op" id="8222700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8222703">defer</span>&nbsp;<span class="ident" id="8222709">log</span><span class="op" id="8222712">.</span><span class="ident" id="8222713">SetOutput</span><span class="op" id="8222722">(</span><span class="ident" id="8222723">os</span><span class="op" id="8222725">.</span><span class="ident" id="8222726">Stderr</span><span class="op" id="8222732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8222735">var</span>&nbsp;<span class="ident" id="8222739">logbuf</span>&nbsp;<span class="ident" id="8222746">bytes</span><span class="op" id="8222751">.</span><span class="ident" id="8222752">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8222760">log</span><span class="op" id="8222763">.</span><span class="ident" id="8222764">SetOutput</span><span class="op" id="8222773">(</span><span class="op" id="8222774">&amp;</span><span class="ident" id="8222775">logbuf</span><span class="op" id="8222781">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8222785">for</span>&nbsp;<span class="ident" id="8222789">i</span><span class="op" id="8222790">,</span>&nbsp;<span class="ident" id="8222792">tt</span>&nbsp;<span class="op" id="8222795">:=</span>&nbsp;<span class="keyword" id="8222798">range</span>&nbsp;<span class="ident" id="8222804">writeSetCookiesTests</span>&nbsp;<span class="op" id="8222825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8222829">if</span>&nbsp;<span class="ident" id="8222832">g</span><span class="op" id="8222833">,</span>&nbsp;<span class="ident" id="8222835">e</span>&nbsp;<span class="op" id="8222837">:=</span>&nbsp;<span class="ident" id="8222840">tt</span><span class="op" id="8222842">.</span><span class="ident" id="8222843">Cookie</span><span class="op" id="8222849">.</span><span class="ident" id="8222850">String</span><span class="op" id="8222856">(</span><span class="op" id="8222857">)</span><span class="op" id="8222858">,</span>&nbsp;<span class="ident" id="8222860">tt</span><span class="op" id="8222862">.</span><span class="ident" id="8222863">Raw</span><span class="op" id="8222866">;</span>&nbsp;<span class="ident" id="8222868">g</span>&nbsp;<span class="op" id="8222870">!=</span>&nbsp;<span class="ident" id="8222873">e</span>&nbsp;<span class="op" id="8222875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8222880">t</span><span class="op" id="8222881">.</span><span class="ident" id="8222882">Errorf</span><span class="op" id="8222888">(</span><span class="string" id="8222889">&#34;Test&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="8222926">,</span>&nbsp;<span class="ident" id="8222928">i</span><span class="op" id="8222929">,</span>&nbsp;<span class="ident" id="8222931">e</span><span class="op" id="8222932">,</span>&nbsp;<span class="ident" id="8222934">g</span><span class="op" id="8222935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8222940">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222951">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222954">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8222958">if</span>&nbsp;<span class="ident" id="8222961">got</span><span class="op" id="8222964">,</span>&nbsp;<span class="ident" id="8222966">sub</span>&nbsp;<span class="op" id="8222970">:=</span>&nbsp;<span class="ident" id="8222973">logbuf</span><span class="op" id="8222979">.</span><span class="ident" id="8222980">String</span><span class="op" id="8222986">(</span><span class="op" id="8222987">)</span><span class="op" id="8222988">,</span>&nbsp;<span class="string" id="8222990">&#34;dropping&nbsp;domain&nbsp;attribute&#34;</span><span class="op" id="8223017">;</span>&nbsp;<span class="op" id="8223019">!</span><span class="ident" id="8223020">strings</span><span class="op" id="8223027">.</span><span class="ident" id="8223028">Contains</span><span class="op" id="8223036">(</span><span class="ident" id="8223037">got</span><span class="op" id="8223040">,</span>&nbsp;<span class="ident" id="8223042">sub</span><span class="op" id="8223045">)</span>&nbsp;<span class="op" id="8223047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223051">t</span><span class="op" id="8223052">.</span><span class="ident" id="8223053">Errorf</span><span class="op" id="8223059">(</span><span class="string" id="8223060">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="8223107">,</span>&nbsp;<span class="ident" id="8223109">sub</span><span class="op" id="8223112">,</span>&nbsp;<span class="ident" id="8223114">got</span><span class="op" id="8223117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8223120">}</span><br>
<span class="lineno">110</span><span class="op" id="8223122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8223125">type</span>&nbsp;<span class="ident" id="8223130">headerOnlyResponseWriter</span>&nbsp;<span class="ident" id="8223155">Header</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8223163">func</span>&nbsp;<span class="op" id="8223168">(</span><span class="ident" id="8223169">ho</span>&nbsp;<span class="ident" id="8223172">headerOnlyResponseWriter</span><span class="op" id="8223196">)</span>&nbsp;<span class="ident" id="8223198">Header</span><span class="op" id="8223204">(</span><span class="op" id="8223205">)</span>&nbsp;<span class="ident" id="8223207">Header</span>&nbsp;<span class="op" id="8223214">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8223217">return</span>&nbsp;<span class="ident" id="8223224">Header</span><span class="op" id="8223230">(</span><span class="ident" id="8223231">ho</span><span class="op" id="8223233">)</span><br>
<span class="lineno"></span><span class="op" id="8223235">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8223238">func</span>&nbsp;<span class="op" id="8223243">(</span><span class="ident" id="8223244">ho</span>&nbsp;<span class="ident" id="8223247">headerOnlyResponseWriter</span><span class="op" id="8223271">)</span>&nbsp;<span class="ident" id="8223273">Write</span><span class="op" id="8223278">(</span><span class="op" id="8223279">[</span><span class="op" id="8223280">]</span><span class="builtintype" id="8223281">byte</span><span class="op" id="8223285">)</span>&nbsp;<span class="op" id="8223287">(</span><span class="builtintype" id="8223288">int</span><span class="op" id="8223291">,</span>&nbsp;<span class="builtintype" id="8223293">error</span><span class="op" id="8223298">)</span>&nbsp;<span class="op" id="8223300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8223303">panic</span><span class="op" id="8223308">(</span><span class="string" id="8223309">&#34;NOIMPL&#34;</span><span class="op" id="8223317">)</span><br>
<span class="lineno">120</span><span class="op" id="8223319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8223322">func</span>&nbsp;<span class="op" id="8223327">(</span><span class="ident" id="8223328">ho</span>&nbsp;<span class="ident" id="8223331">headerOnlyResponseWriter</span><span class="op" id="8223355">)</span>&nbsp;<span class="ident" id="8223357">WriteHeader</span><span class="op" id="8223368">(</span><span class="builtintype" id="8223369">int</span><span class="op" id="8223372">)</span>&nbsp;<span class="op" id="8223374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8223377">panic</span><span class="op" id="8223382">(</span><span class="string" id="8223383">&#34;NOIMPL&#34;</span><span class="op" id="8223391">)</span><br>
<span class="lineno"></span><span class="op" id="8223393">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="8223396">func</span>&nbsp;<span class="ident" id="8223401">TestSetCookie</span><span class="op" id="8223414">(</span><span class="ident" id="8223415">t</span>&nbsp;<span class="op" id="8223417">*</span><span class="ident" id="8223418">testing</span><span class="op" id="8223425">.</span><span class="ident" id="8223426">T</span><span class="op" id="8223427">)</span>&nbsp;<span class="op" id="8223429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223432">m</span>&nbsp;<span class="op" id="8223434">:=</span>&nbsp;<span class="builtinfunc" id="8223437">make</span><span class="op" id="8223441">(</span><span class="ident" id="8223442">Header</span><span class="op" id="8223448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223451">SetCookie</span><span class="op" id="8223460">(</span><span class="ident" id="8223461">headerOnlyResponseWriter</span><span class="op" id="8223485">(</span><span class="ident" id="8223486">m</span><span class="op" id="8223487">)</span><span class="op" id="8223488">,</span>&nbsp;<span class="op" id="8223490">&amp;</span><span class="ident" id="8223491">Cookie</span><span class="op" id="8223497">{</span><span class="ident" id="8223498">Name</span><span class="op" id="8223502">:</span>&nbsp;<span class="string" id="8223504">&#34;cookie-1&#34;</span><span class="op" id="8223514">,</span>&nbsp;<span class="ident" id="8223516">Value</span><span class="op" id="8223521">:</span>&nbsp;<span class="string" id="8223523">&#34;one&#34;</span><span class="op" id="8223528">,</span>&nbsp;<span class="ident" id="8223530">Path</span><span class="op" id="8223534">:</span>&nbsp;<span class="string" id="8223536">&#34;/restricted/&#34;</span><span class="op" id="8223550">}</span><span class="op" id="8223551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223554">SetCookie</span><span class="op" id="8223563">(</span><span class="ident" id="8223564">headerOnlyResponseWriter</span><span class="op" id="8223588">(</span><span class="ident" id="8223589">m</span><span class="op" id="8223590">)</span><span class="op" id="8223591">,</span>&nbsp;<span class="op" id="8223593">&amp;</span><span class="ident" id="8223594">Cookie</span><span class="op" id="8223600">{</span><span class="ident" id="8223601">Name</span><span class="op" id="8223605">:</span>&nbsp;<span class="string" id="8223607">&#34;cookie-2&#34;</span><span class="op" id="8223617">,</span>&nbsp;<span class="ident" id="8223619">Value</span><span class="op" id="8223624">:</span>&nbsp;<span class="string" id="8223626">&#34;two&#34;</span><span class="op" id="8223631">,</span>&nbsp;<span class="ident" id="8223633">MaxAge</span><span class="op" id="8223639">:</span>&nbsp;<span class="num" id="8223641">3600</span><span class="op" id="8223645">}</span><span class="op" id="8223646">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8223649">if</span>&nbsp;<span class="ident" id="8223652">l</span>&nbsp;<span class="op" id="8223654">:=</span>&nbsp;<span class="builtinfunc" id="8223657">len</span><span class="op" id="8223660">(</span><span class="ident" id="8223661">m</span><span class="op" id="8223662">[</span><span class="string" id="8223663">&#34;Set-Cookie&#34;</span><span class="op" id="8223675">]</span><span class="op" id="8223676">)</span><span class="op" id="8223677">;</span>&nbsp;<span class="ident" id="8223679">l</span>&nbsp;<span class="op" id="8223681">!=</span>&nbsp;<span class="num" id="8223684">2</span>&nbsp;<span class="op" id="8223686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223690">t</span><span class="op" id="8223691">.</span><span class="ident" id="8223692">Fatalf</span><span class="op" id="8223698">(</span><span class="string" id="8223699">&#34;expected&nbsp;%d&nbsp;cookies,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8223728">,</span>&nbsp;<span class="num" id="8223730">2</span><span class="op" id="8223731">,</span>&nbsp;<span class="ident" id="8223733">l</span><span class="op" id="8223734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8223737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8223740">if</span>&nbsp;<span class="ident" id="8223743">g</span><span class="op" id="8223744">,</span>&nbsp;<span class="ident" id="8223746">e</span>&nbsp;<span class="op" id="8223748">:=</span>&nbsp;<span class="ident" id="8223751">m</span><span class="op" id="8223752">[</span><span class="string" id="8223753">&#34;Set-Cookie&#34;</span><span class="op" id="8223765">]</span><span class="op" id="8223766">[</span><span class="num" id="8223767">0</span><span class="op" id="8223768">]</span><span class="op" id="8223769">,</span>&nbsp;<span class="string" id="8223771">&#34;cookie-1=one;&nbsp;Path=/restricted/&#34;</span><span class="op" id="8223804">;</span>&nbsp;<span class="ident" id="8223806">g</span>&nbsp;<span class="op" id="8223808">!=</span>&nbsp;<span class="ident" id="8223811">e</span>&nbsp;<span class="op" id="8223813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223817">t</span><span class="op" id="8223818">.</span><span class="ident" id="8223819">Errorf</span><span class="op" id="8223825">(</span><span class="string" id="8223826">&#34;cookie&nbsp;#1:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8223854">,</span>&nbsp;<span class="ident" id="8223856">e</span><span class="op" id="8223857">,</span>&nbsp;<span class="ident" id="8223859">g</span><span class="op" id="8223860">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8223863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8223866">if</span>&nbsp;<span class="ident" id="8223869">g</span><span class="op" id="8223870">,</span>&nbsp;<span class="ident" id="8223872">e</span>&nbsp;<span class="op" id="8223874">:=</span>&nbsp;<span class="ident" id="8223877">m</span><span class="op" id="8223878">[</span><span class="string" id="8223879">&#34;Set-Cookie&#34;</span><span class="op" id="8223891">]</span><span class="op" id="8223892">[</span><span class="num" id="8223893">1</span><span class="op" id="8223894">]</span><span class="op" id="8223895">,</span>&nbsp;<span class="string" id="8223897">&#34;cookie-2=two;&nbsp;Max-Age=3600&#34;</span><span class="op" id="8223925">;</span>&nbsp;<span class="ident" id="8223927">g</span>&nbsp;<span class="op" id="8223929">!=</span>&nbsp;<span class="ident" id="8223932">e</span>&nbsp;<span class="op" id="8223934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223938">t</span><span class="op" id="8223939">.</span><span class="ident" id="8223940">Errorf</span><span class="op" id="8223946">(</span><span class="string" id="8223947">&#34;cookie&nbsp;#2:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8223975">,</span>&nbsp;<span class="ident" id="8223977">e</span><span class="op" id="8223978">,</span>&nbsp;<span class="ident" id="8223980">g</span><span class="op" id="8223981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8223984">}</span><br>
<span class="lineno"></span><span class="op" id="8223986">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="8223989">var</span>&nbsp;<span class="ident" id="8223993">addCookieTests</span>&nbsp;<span class="op" id="8224008">=</span>&nbsp;<span class="op" id="8224010">[</span><span class="op" id="8224011">]</span><span class="keyword" id="8224012">struct</span>&nbsp;<span class="op" id="8224019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224022">Cookies</span>&nbsp;<span class="op" id="8224030">[</span><span class="op" id="8224031">]</span><span class="op" id="8224032">*</span><span class="ident" id="8224033">Cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224041">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8224049">string</span><br>
<span class="lineno"></span><span class="op" id="8224056">}</span><span class="op" id="8224057">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8224060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8224064">[</span><span class="op" id="8224065">]</span><span class="op" id="8224066">*</span><span class="ident" id="8224067">Cookie</span><span class="op" id="8224073">{</span><span class="op" id="8224074">}</span><span class="op" id="8224075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8224079">&#34;&#34;</span><span class="op" id="8224081">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8224084">}</span><span class="op" id="8224085">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8224088">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8224092">[</span><span class="op" id="8224093">]</span><span class="op" id="8224094">*</span><span class="ident" id="8224095">Cookie</span><span class="op" id="8224101">{</span><span class="op" id="8224102">{</span><span class="ident" id="8224103">Name</span><span class="op" id="8224107">:</span>&nbsp;<span class="string" id="8224109">&#34;cookie-1&#34;</span><span class="op" id="8224119">,</span>&nbsp;<span class="ident" id="8224121">Value</span><span class="op" id="8224126">:</span>&nbsp;<span class="string" id="8224128">&#34;v$1&#34;</span><span class="op" id="8224133">}</span><span class="op" id="8224134">}</span><span class="op" id="8224135">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8224139">&#34;cookie-1=v$1&#34;</span><span class="op" id="8224153">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8224156">}</span><span class="op" id="8224157">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8224160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8224164">[</span><span class="op" id="8224165">]</span><span class="op" id="8224166">*</span><span class="ident" id="8224167">Cookie</span><span class="op" id="8224173">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8224178">{</span><span class="ident" id="8224179">Name</span><span class="op" id="8224183">:</span>&nbsp;<span class="string" id="8224185">&#34;cookie-1&#34;</span><span class="op" id="8224195">,</span>&nbsp;<span class="ident" id="8224197">Value</span><span class="op" id="8224202">:</span>&nbsp;<span class="string" id="8224204">&#34;v$1&#34;</span><span class="op" id="8224209">}</span><span class="op" id="8224210">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8224215">{</span><span class="ident" id="8224216">Name</span><span class="op" id="8224220">:</span>&nbsp;<span class="string" id="8224222">&#34;cookie-2&#34;</span><span class="op" id="8224232">,</span>&nbsp;<span class="ident" id="8224234">Value</span><span class="op" id="8224239">:</span>&nbsp;<span class="string" id="8224241">&#34;v$2&#34;</span><span class="op" id="8224246">}</span><span class="op" id="8224247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8224252">{</span><span class="ident" id="8224253">Name</span><span class="op" id="8224257">:</span>&nbsp;<span class="string" id="8224259">&#34;cookie-3&#34;</span><span class="op" id="8224269">,</span>&nbsp;<span class="ident" id="8224271">Value</span><span class="op" id="8224276">:</span>&nbsp;<span class="string" id="8224278">&#34;v$3&#34;</span><span class="op" id="8224283">}</span><span class="op" id="8224284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8224288">}</span><span class="op" id="8224289">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8224293">&#34;cookie-1=v$1;&nbsp;cookie-2=v$2;&nbsp;cookie-3=v$3&#34;</span><span class="op" id="8224335">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8224338">}</span><span class="op" id="8224339">,</span><br>
<span class="lineno"></span><span class="op" id="8224341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8224344">func</span>&nbsp;<span class="ident" id="8224349">TestAddCookie</span><span class="op" id="8224362">(</span><span class="ident" id="8224363">t</span>&nbsp;<span class="op" id="8224365">*</span><span class="ident" id="8224366">testing</span><span class="op" id="8224373">.</span><span class="ident" id="8224374">T</span><span class="op" id="8224375">)</span>&nbsp;<span class="op" id="8224377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8224380">for</span>&nbsp;<span class="ident" id="8224384">i</span><span class="op" id="8224385">,</span>&nbsp;<span class="ident" id="8224387">tt</span>&nbsp;<span class="op" id="8224390">:=</span>&nbsp;<span class="keyword" id="8224393">range</span>&nbsp;<span class="ident" id="8224399">addCookieTests</span>&nbsp;<span class="op" id="8224414">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224418">req</span><span class="op" id="8224421">,</span>&nbsp;<span class="ident" id="8224423">_</span>&nbsp;<span class="op" id="8224425">:=</span>&nbsp;<span class="ident" id="8224428">NewRequest</span><span class="op" id="8224438">(</span><span class="string" id="8224439">&#34;GET&#34;</span><span class="op" id="8224444">,</span>&nbsp;<span class="string" id="8224446">&#34;http://example.com/&#34;</span><span class="op" id="8224467">,</span>&nbsp;<span class="ident" id="8224469">nil</span><span class="op" id="8224472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8224476">for</span>&nbsp;<span class="ident" id="8224480">_</span><span class="op" id="8224481">,</span>&nbsp;<span class="ident" id="8224483">c</span>&nbsp;<span class="op" id="8224485">:=</span>&nbsp;<span class="keyword" id="8224488">range</span>&nbsp;<span class="ident" id="8224494">tt</span><span class="op" id="8224496">.</span><span class="ident" id="8224497">Cookies</span>&nbsp;<span class="op" id="8224505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224510">req</span><span class="op" id="8224513">.</span><span class="ident" id="8224514">AddCookie</span><span class="op" id="8224523">(</span><span class="ident" id="8224524">c</span><span class="op" id="8224525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8224529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8224533">if</span>&nbsp;<span class="ident" id="8224536">g</span>&nbsp;<span class="op" id="8224538">:=</span>&nbsp;<span class="ident" id="8224541">req</span><span class="op" id="8224544">.</span><span class="ident" id="8224545">Header</span><span class="op" id="8224551">.</span><span class="ident" id="8224552">Get</span><span class="op" id="8224555">(</span><span class="string" id="8224556">&#34;Cookie&#34;</span><span class="op" id="8224564">)</span><span class="op" id="8224565">;</span>&nbsp;<span class="ident" id="8224567">g</span>&nbsp;<span class="op" id="8224569">!=</span>&nbsp;<span class="ident" id="8224572">tt</span><span class="op" id="8224574">.</span><span class="ident" id="8224575">Raw</span>&nbsp;<span class="op" id="8224579">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224584">t</span><span class="op" id="8224585">.</span><span class="ident" id="8224586">Errorf</span><span class="op" id="8224592">(</span><span class="string" id="8224593">&#34;Test&nbsp;%d:\nwant:&nbsp;%s\n&nbsp;got:&nbsp;%s\n&#34;</span><span class="op" id="8224625">,</span>&nbsp;<span class="ident" id="8224627">i</span><span class="op" id="8224628">,</span>&nbsp;<span class="ident" id="8224630">tt</span><span class="op" id="8224632">.</span><span class="ident" id="8224633">Raw</span><span class="op" id="8224636">,</span>&nbsp;<span class="ident" id="8224638">g</span><span class="op" id="8224639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8224644">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8224655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8224658">}</span><br>
<span class="lineno"></span><span class="op" id="8224660">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="8224663">var</span>&nbsp;<span class="ident" id="8224667">readSetCookiesTests</span>&nbsp;<span class="op" id="8224687">=</span>&nbsp;<span class="op" id="8224689">[</span><span class="op" id="8224690">]</span><span class="keyword" id="8224691">struct</span>&nbsp;<span class="op" id="8224698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224701">Header</span>&nbsp;&nbsp;<span class="ident" id="8224709">Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224717">Cookies</span>&nbsp;<span class="op" id="8224725">[</span><span class="op" id="8224726">]</span><span class="op" id="8224727">*</span><span class="ident" id="8224728">Cookie</span><br>
<span class="lineno"></span><span class="op" id="8224735">}</span><span class="op" id="8224736">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8224739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224743">Header</span><span class="op" id="8224749">{</span><span class="string" id="8224750">&#34;Set-Cookie&#34;</span><span class="op" id="8224762">:</span>&nbsp;<span class="op" id="8224764">{</span><span class="string" id="8224765">&#34;Cookie-1=v$1&#34;</span><span class="op" id="8224779">}</span><span class="op" id="8224780">}</span><span class="op" id="8224781">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8224785">[</span><span class="op" id="8224786">]</span><span class="op" id="8224787">*</span><span class="ident" id="8224788">Cookie</span><span class="op" id="8224794">{</span><span class="op" id="8224795">{</span><span class="ident" id="8224796">Name</span><span class="op" id="8224800">:</span>&nbsp;<span class="string" id="8224802">&#34;Cookie-1&#34;</span><span class="op" id="8224812">,</span>&nbsp;<span class="ident" id="8224814">Value</span><span class="op" id="8224819">:</span>&nbsp;<span class="string" id="8224821">&#34;v$1&#34;</span><span class="op" id="8224826">,</span>&nbsp;<span class="ident" id="8224828">Raw</span><span class="op" id="8224831">:</span>&nbsp;<span class="string" id="8224833">&#34;Cookie-1=v$1&#34;</span><span class="op" id="8224847">}</span><span class="op" id="8224848">}</span><span class="op" id="8224849">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8224852">}</span><span class="op" id="8224853">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8224856">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224860">Header</span><span class="op" id="8224866">{</span><span class="string" id="8224867">&#34;Set-Cookie&#34;</span><span class="op" id="8224879">:</span>&nbsp;<span class="op" id="8224881">{</span><span class="string" id="8224882">&#34;NID=99=YsDT5i3E-CXax-;&nbsp;expires=Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT;&nbsp;path=/;&nbsp;domain=.google.ch;&nbsp;HttpOnly&#34;</span><span class="op" id="8224981">}</span><span class="op" id="8224982">}</span><span class="op" id="8224983">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8224987">[</span><span class="op" id="8224988">]</span><span class="op" id="8224989">*</span><span class="ident" id="8224990">Cookie</span><span class="op" id="8224996">{</span><span class="op" id="8224997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225002">Name</span><span class="op" id="8225006">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8225014">&#34;NID&#34;</span><span class="op" id="8225019">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225024">Value</span><span class="op" id="8225029">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8225036">&#34;99=YsDT5i3E-CXax-&#34;</span><span class="op" id="8225055">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225060">Path</span><span class="op" id="8225064">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8225072">&#34;/&#34;</span><span class="op" id="8225075">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225080">Domain</span><span class="op" id="8225086">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8225092">&#34;.google.ch&#34;</span><span class="op" id="8225104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225109">HttpOnly</span><span class="op" id="8225117">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8225121">true</span><span class="op" id="8225125">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225130">Expires</span><span class="op" id="8225137">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225142">time</span><span class="op" id="8225146">.</span><span class="ident" id="8225147">Date</span><span class="op" id="8225151">(</span><span class="num" id="8225152">2011</span><span class="op" id="8225156">,</span>&nbsp;<span class="num" id="8225158">11</span><span class="op" id="8225160">,</span>&nbsp;<span class="num" id="8225162">23</span><span class="op" id="8225164">,</span>&nbsp;<span class="num" id="8225166">1</span><span class="op" id="8225167">,</span>&nbsp;<span class="num" id="8225169">5</span><span class="op" id="8225170">,</span>&nbsp;<span class="num" id="8225172">3</span><span class="op" id="8225173">,</span>&nbsp;<span class="num" id="8225175">0</span><span class="op" id="8225176">,</span>&nbsp;<span class="ident" id="8225178">time</span><span class="op" id="8225182">.</span><span class="ident" id="8225183">UTC</span><span class="op" id="8225186">)</span><span class="op" id="8225187">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225192">RawExpires</span><span class="op" id="8225202">:</span>&nbsp;<span class="string" id="8225204">&#34;Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT&#34;</span><span class="op" id="8225235">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225240">Raw</span><span class="op" id="8225243">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8225252">&#34;NID=99=YsDT5i3E-CXax-;&nbsp;expires=Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT;&nbsp;path=/;&nbsp;domain=.google.ch;&nbsp;HttpOnly&#34;</span><span class="op" id="8225351">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8225355">}</span><span class="op" id="8225356">}</span><span class="op" id="8225357">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8225360">}</span><span class="op" id="8225361">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8225364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225368">Header</span><span class="op" id="8225374">{</span><span class="string" id="8225375">&#34;Set-Cookie&#34;</span><span class="op" id="8225387">:</span>&nbsp;<span class="op" id="8225389">{</span><span class="string" id="8225390">&#34;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="8225464">}</span><span class="op" id="8225465">}</span><span class="op" id="8225466">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8225470">[</span><span class="op" id="8225471">]</span><span class="op" id="8225472">*</span><span class="ident" id="8225473">Cookie</span><span class="op" id="8225479">{</span><span class="op" id="8225480">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225485">Name</span><span class="op" id="8225489">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8225497">&#34;.ASPXAUTH&#34;</span><span class="op" id="8225508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225513">Value</span><span class="op" id="8225518">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8225525">&#34;7E3AA&#34;</span><span class="op" id="8225532">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225537">Path</span><span class="op" id="8225541">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8225549">&#34;/&#34;</span><span class="op" id="8225552">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225557">Expires</span><span class="op" id="8225564">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225569">time</span><span class="op" id="8225573">.</span><span class="ident" id="8225574">Date</span><span class="op" id="8225578">(</span><span class="num" id="8225579">2012</span><span class="op" id="8225583">,</span>&nbsp;<span class="num" id="8225585">3</span><span class="op" id="8225586">,</span>&nbsp;<span class="num" id="8225588">7</span><span class="op" id="8225589">,</span>&nbsp;<span class="num" id="8225591">14</span><span class="op" id="8225593">,</span>&nbsp;<span class="num" id="8225595">25</span><span class="op" id="8225597">,</span>&nbsp;<span class="num" id="8225599">6</span><span class="op" id="8225600">,</span>&nbsp;<span class="num" id="8225602">0</span><span class="op" id="8225603">,</span>&nbsp;<span class="ident" id="8225605">time</span><span class="op" id="8225609">.</span><span class="ident" id="8225610">UTC</span><span class="op" id="8225613">)</span><span class="op" id="8225614">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225619">RawExpires</span><span class="op" id="8225629">:</span>&nbsp;<span class="string" id="8225631">&#34;Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT&#34;</span><span class="op" id="8225662">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225667">HttpOnly</span><span class="op" id="8225675">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8225679">true</span><span class="op" id="8225683">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225688">Raw</span><span class="op" id="8225691">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8225700">&#34;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="8225774">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8225778">}</span><span class="op" id="8225779">}</span><span class="op" id="8225780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8225783">}</span><span class="op" id="8225784">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8225787">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225791">Header</span><span class="op" id="8225797">{</span><span class="string" id="8225798">&#34;Set-Cookie&#34;</span><span class="op" id="8225810">:</span>&nbsp;<span class="op" id="8225812">{</span><span class="string" id="8225813">&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="8225854">}</span><span class="op" id="8225855">}</span><span class="op" id="8225856">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8225860">[</span><span class="op" id="8225861">]</span><span class="op" id="8225862">*</span><span class="ident" id="8225863">Cookie</span><span class="op" id="8225869">{</span><span class="op" id="8225870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225875">Name</span><span class="op" id="8225879">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8225885">&#34;ASP.NET_SessionId&#34;</span><span class="op" id="8225904">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225909">Value</span><span class="op" id="8225914">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8225919">&#34;foo&#34;</span><span class="op" id="8225924">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225929">Path</span><span class="op" id="8225933">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8225939">&#34;/&#34;</span><span class="op" id="8225942">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225947">HttpOnly</span><span class="op" id="8225955">:</span>&nbsp;<span class="builtintype" id="8225957">true</span><span class="op" id="8225961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225966">Raw</span><span class="op" id="8225969">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8225976">&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="8226017">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8226021">}</span><span class="op" id="8226022">}</span><span class="op" id="8226023">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8226026">}</span><span class="op" id="8226027">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8226030">//&nbsp;Make&nbsp;sure&nbsp;we&nbsp;can&nbsp;properly&nbsp;read&nbsp;back&nbsp;the&nbsp;Set-Cookie&nbsp;headers&nbsp;we&nbsp;create</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8226103">//&nbsp;for&nbsp;values&nbsp;containing&nbsp;spaces&nbsp;or&nbsp;commas:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8226147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8226151">Header</span><span class="op" id="8226157">{</span><span class="string" id="8226158">&#34;Set-Cookie&#34;</span><span class="op" id="8226170">:</span>&nbsp;<span class="op" id="8226172">{</span><span class="string" id="8226173">`special-1=a&nbsp;z`</span><span class="op" id="8226188">}</span><span class="op" id="8226189">}</span><span class="op" id="8226190">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8226194">[</span><span class="op" id="8226195">]</span><span class="op" id="8226196">*</span><span class="ident" id="8226197">Cookie</span><span class="op" id="8226203">{</span><span class="op" id="8226204">{</span><span class="ident" id="8226205">Name</span><span class="op" id="8226209">:</span>&nbsp;<span class="string" id="8226211">&#34;special-1&#34;</span><span class="op" id="8226222">,</span>&nbsp;<span class="ident" id="8226224">Value</span><span class="op" id="8226229">:</span>&nbsp;<span class="string" id="8226231">&#34;a&nbsp;z&#34;</span><span class="op" id="8226236">,</span>&nbsp;<span class="ident" id="8226238">Raw</span><span class="op" id="8226241">:</span>&nbsp;<span class="string" id="8226243">`special-1=a&nbsp;z`</span><span class="op" id="8226258">}</span><span class="op" id="8226259">}</span><span class="op" id="8226260">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8226263">}</span><span class="op" id="8226264">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8226267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8226271">Header</span><span class="op" id="8226277">{</span><span class="string" id="8226278">&#34;Set-Cookie&#34;</span><span class="op" id="8226290">:</span>&nbsp;<span class="op" id="8226292">{</span><span class="string" id="8226293">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="8226309">}</span><span class="op" id="8226310">}</span><span class="op" id="8226311">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8226315">[</span><span class="op" id="8226316">]</span><span class="op" id="8226317">*</span><span class="ident" id="8226318">Cookie</span><span class="op" id="8226324">{</span><span class="op" id="8226325">{</span><span class="ident" id="8226326">Name</span><span class="op" id="8226330">:</span>&nbsp;<span class="string" id="8226332">&#34;special-2&#34;</span><span class="op" id="8226343">,</span>&nbsp;<span class="ident" id="8226345">Value</span><span class="op" id="8226350">:</span>&nbsp;<span class="string" id="8226352">&#34;&nbsp;z&#34;</span><span class="op" id="8226356">,</span>&nbsp;<span class="ident" id="8226358">Raw</span><span class="op" id="8226361">:</span>&nbsp;<span class="string" id="8226363">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="8226379">}</span><span class="op" id="8226380">}</span><span class="op" id="8226381">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8226384">}</span><span class="op" id="8226385">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8226388">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8226392">Header</span><span class="op" id="8226398">{</span><span class="string" id="8226399">&#34;Set-Cookie&#34;</span><span class="op" id="8226411">:</span>&nbsp;<span class="op" id="8226413">{</span><span class="string" id="8226414">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="8226430">}</span><span class="op" id="8226431">}</span><span class="op" id="8226432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8226436">[</span><span class="op" id="8226437">]</span><span class="op" id="8226438">*</span><span class="ident" id="8226439">Cookie</span><span class="op" id="8226445">{</span><span class="op" id="8226446">{</span><span class="ident" id="8226447">Name</span><span class="op" id="8226451">:</span>&nbsp;<span class="string" id="8226453">&#34;special-3&#34;</span><span class="op" id="8226464">,</span>&nbsp;<span class="ident" id="8226466">Value</span><span class="op" id="8226471">:</span>&nbsp;<span class="string" id="8226473">&#34;a&nbsp;&#34;</span><span class="op" id="8226477">,</span>&nbsp;<span class="ident" id="8226479">Raw</span><span class="op" id="8226482">:</span>&nbsp;<span class="string" id="8226484">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="8226500">}</span><span class="op" id="8226501">}</span><span class="op" id="8226502">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8226505">}</span><span class="op" id="8226506">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8226509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8226513">Header</span><span class="op" id="8226519">{</span><span class="string" id="8226520">&#34;Set-Cookie&#34;</span><span class="op" id="8226532">:</span>&nbsp;<span class="op" id="8226534">{</span><span class="string" id="8226535">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="8226550">}</span><span class="op" id="8226551">}</span><span class="op" id="8226552">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8226556">[</span><span class="op" id="8226557">]</span><span class="op" id="8226558">*</span><span class="ident" id="8226559">Cookie</span><span class="op" id="8226565">{</span><span class="op" id="8226566">{</span><span class="ident" id="8226567">Name</span><span class="op" id="8226571">:</span>&nbsp;<span class="string" id="8226573">&#34;special-4&#34;</span><span class="op" id="8226584">,</span>&nbsp;<span class="ident" id="8226586">Value</span><span class="op" id="8226591">:</span>&nbsp;<span class="string" id="8226593">&#34;&nbsp;&#34;</span><span class="op" id="8226596">,</span>&nbsp;<span class="ident" id="8226598">Raw</span><span class="op" id="8226601">:</span>&nbsp;<span class="string" id="8226603">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="8226618">}</span><span class="op" id="8226619">}</span><span class="op" id="8226620">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8226623">}</span><span class="op" id="8226624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8226627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8226631">Header</span><span class="op" id="8226637">{</span><span class="string" id="8226638">&#34;Set-Cookie&#34;</span><span class="op" id="8226650">:</span>&nbsp;<span class="op" id="8226652">{</span><span class="string" id="8226653">`special-5=a,z`</span><span class="op" id="8226668">}</span><span class="op" id="8226669">}</span><span class="op" id="8226670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8226674">[</span><span class="op" id="8226675">]</span><span class="op" id="8226676">*</span><span class="ident" id="8226677">Cookie</span><span class="op" id="8226683">{</span><span class="op" id="8226684">{</span><span class="ident" id="8226685">Name</span><span class="op" id="8226689">:</span>&nbsp;<span class="string" id="8226691">&#34;special-5&#34;</span><span class="op" id="8226702">,</span>&nbsp;<span class="ident" id="8226704">Value</span><span class="op" id="8226709">:</span>&nbsp;<span class="string" id="8226711">&#34;a,z&#34;</span><span class="op" id="8226716">,</span>&nbsp;<span class="ident" id="8226718">Raw</span><span class="op" id="8226721">:</span>&nbsp;<span class="string" id="8226723">`special-5=a,z`</span><span class="op" id="8226738">}</span><span class="op" id="8226739">}</span><span class="op" id="8226740">,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8226743">}</span><span class="op" id="8226744">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8226747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8226751">Header</span><span class="op" id="8226757">{</span><span class="string" id="8226758">&#34;Set-Cookie&#34;</span><span class="op" id="8226770">:</span>&nbsp;<span class="op" id="8226772">{</span><span class="string" id="8226773">`special-6=&#34;,z&#34;`</span><span class="op" id="8226789">}</span><span class="op" id="8226790">}</span><span class="op" id="8226791">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8226795">[</span><span class="op" id="8226796">]</span><span class="op" id="8226797">*</span><span class="ident" id="8226798">Cookie</span><span class="op" id="8226804">{</span><span class="op" id="8226805">{</span><span class="ident" id="8226806">Name</span><span class="op" id="8226810">:</span>&nbsp;<span class="string" id="8226812">&#34;special-6&#34;</span><span class="op" id="8226823">,</span>&nbsp;<span class="ident" id="8226825">Value</span><span class="op" id="8226830">:</span>&nbsp;<span class="string" id="8226832">&#34;,z&#34;</span><span class="op" id="8226836">,</span>&nbsp;<span class="ident" id="8226838">Raw</span><span class="op" id="8226841">:</span>&nbsp;<span class="string" id="8226843">`special-6=&#34;,z&#34;`</span><span class="op" id="8226859">}</span><span class="op" id="8226860">}</span><span class="op" id="8226861">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8226864">}</span><span class="op" id="8226865">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8226868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8226872">Header</span><span class="op" id="8226878">{</span><span class="string" id="8226879">&#34;Set-Cookie&#34;</span><span class="op" id="8226891">:</span>&nbsp;<span class="op" id="8226893">{</span><span class="string" id="8226894">`special-7=a,`</span><span class="op" id="8226908">}</span><span class="op" id="8226909">}</span><span class="op" id="8226910">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8226914">[</span><span class="op" id="8226915">]</span><span class="op" id="8226916">*</span><span class="ident" id="8226917">Cookie</span><span class="op" id="8226923">{</span><span class="op" id="8226924">{</span><span class="ident" id="8226925">Name</span><span class="op" id="8226929">:</span>&nbsp;<span class="string" id="8226931">&#34;special-7&#34;</span><span class="op" id="8226942">,</span>&nbsp;<span class="ident" id="8226944">Value</span><span class="op" id="8226949">:</span>&nbsp;<span class="string" id="8226951">&#34;a,&#34;</span><span class="op" id="8226955">,</span>&nbsp;<span class="ident" id="8226957">Raw</span><span class="op" id="8226960">:</span>&nbsp;<span class="string" id="8226962">`special-7=a,`</span><span class="op" id="8226976">}</span><span class="op" id="8226977">}</span><span class="op" id="8226978">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8226981">}</span><span class="op" id="8226982">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8226985">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8226989">Header</span><span class="op" id="8226995">{</span><span class="string" id="8226996">&#34;Set-Cookie&#34;</span><span class="op" id="8227008">:</span>&nbsp;<span class="op" id="8227010">{</span><span class="string" id="8227011">`special-8=&#34;,&#34;`</span><span class="op" id="8227026">}</span><span class="op" id="8227027">}</span><span class="op" id="8227028">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8227032">[</span><span class="op" id="8227033">]</span><span class="op" id="8227034">*</span><span class="ident" id="8227035">Cookie</span><span class="op" id="8227041">{</span><span class="op" id="8227042">{</span><span class="ident" id="8227043">Name</span><span class="op" id="8227047">:</span>&nbsp;<span class="string" id="8227049">&#34;special-8&#34;</span><span class="op" id="8227060">,</span>&nbsp;<span class="ident" id="8227062">Value</span><span class="op" id="8227067">:</span>&nbsp;<span class="string" id="8227069">&#34;,&#34;</span><span class="op" id="8227072">,</span>&nbsp;<span class="ident" id="8227074">Raw</span><span class="op" id="8227077">:</span>&nbsp;<span class="string" id="8227079">`special-8=&#34;,&#34;`</span><span class="op" id="8227094">}</span><span class="op" id="8227095">}</span><span class="op" id="8227096">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8227099">}</span><span class="op" id="8227100">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8227104">//&nbsp;TODO(bradfitz):&nbsp;users&nbsp;have&nbsp;reported&nbsp;seeing&nbsp;this&nbsp;in&nbsp;the</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8227163">//&nbsp;wild,&nbsp;but&nbsp;do&nbsp;browsers&nbsp;handle&nbsp;it?&nbsp;RFC&nbsp;6265&nbsp;just&nbsp;says&nbsp;&#34;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8227226">//&nbsp;do&nbsp;that&#34;&nbsp;(section&nbsp;3)&nbsp;and&nbsp;then&nbsp;never&nbsp;mentions&nbsp;header&nbsp;folding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8227290">//&nbsp;again.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8227301">//&nbsp;Header{&#34;Set-Cookie&#34;:&nbsp;{&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly,&nbsp;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;}},</span><br>
<span class="lineno"></span><span class="op" id="8227445">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="8227448">func</span>&nbsp;<span class="ident" id="8227453">toJSON</span><span class="op" id="8227459">(</span><span class="ident" id="8227460">v</span>&nbsp;<span class="keyword" id="8227462">interface</span><span class="op" id="8227471">{</span><span class="op" id="8227472">}</span><span class="op" id="8227473">)</span>&nbsp;<span class="builtintype" id="8227475">string</span>&nbsp;<span class="op" id="8227482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8227485">b</span><span class="op" id="8227486">,</span>&nbsp;<span class="ident" id="8227488">err</span>&nbsp;<span class="op" id="8227492">:=</span>&nbsp;<span class="ident" id="8227495">json</span><span class="op" id="8227499">.</span><span class="ident" id="8227500">Marshal</span><span class="op" id="8227507">(</span><span class="ident" id="8227508">v</span><span class="op" id="8227509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8227512">if</span>&nbsp;<span class="ident" id="8227515">err</span>&nbsp;<span class="op" id="8227519">!=</span>&nbsp;<span class="ident" id="8227522">nil</span>&nbsp;<span class="op" id="8227526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8227530">return</span>&nbsp;<span class="ident" id="8227537">fmt</span><span class="op" id="8227540">.</span><span class="ident" id="8227541">Sprintf</span><span class="op" id="8227548">(</span><span class="string" id="8227549">&#34;%#v&#34;</span><span class="op" id="8227554">,</span>&nbsp;<span class="ident" id="8227556">v</span><span class="op" id="8227557">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8227560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8227563">return</span>&nbsp;<span class="builtintype" id="8227570">string</span><span class="op" id="8227576">(</span><span class="ident" id="8227577">b</span><span class="op" id="8227578">)</span><br>
<span class="lineno"></span><span class="op" id="8227580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8227583">func</span>&nbsp;<span class="ident" id="8227588">TestReadSetCookies</span><span class="op" id="8227606">(</span><span class="ident" id="8227607">t</span>&nbsp;<span class="op" id="8227609">*</span><span class="ident" id="8227610">testing</span><span class="op" id="8227617">.</span><span class="ident" id="8227618">T</span><span class="op" id="8227619">)</span>&nbsp;<span class="op" id="8227621">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8227624">for</span>&nbsp;<span class="ident" id="8227628">i</span><span class="op" id="8227629">,</span>&nbsp;<span class="ident" id="8227631">tt</span>&nbsp;<span class="op" id="8227634">:=</span>&nbsp;<span class="keyword" id="8227637">range</span>&nbsp;<span class="ident" id="8227643">readSetCookiesTests</span>&nbsp;<span class="op" id="8227663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8227667">for</span>&nbsp;<span class="ident" id="8227671">n</span>&nbsp;<span class="op" id="8227673">:=</span>&nbsp;<span class="num" id="8227676">0</span><span class="op" id="8227677">;</span>&nbsp;<span class="ident" id="8227679">n</span>&nbsp;<span class="op" id="8227681">&lt;</span>&nbsp;<span class="num" id="8227683">2</span><span class="op" id="8227684">;</span>&nbsp;<span class="ident" id="8227686">n</span><span class="op" id="8227687">++</span>&nbsp;<span class="op" id="8227690">{</span>&nbsp;<span class="comment" id="8227692">//&nbsp;to&nbsp;verify&nbsp;readSetCookies&nbsp;doesn&#39;t&nbsp;mutate&nbsp;its&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8227748">c</span>&nbsp;<span class="op" id="8227750">:=</span>&nbsp;<span class="ident" id="8227753">readSetCookies</span><span class="op" id="8227767">(</span><span class="ident" id="8227768">tt</span><span class="op" id="8227770">.</span><span class="ident" id="8227771">Header</span><span class="op" id="8227777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8227782">if</span>&nbsp;<span class="op" id="8227785">!</span><span class="ident" id="8227786">reflect</span><span class="op" id="8227793">.</span><span class="ident" id="8227794">DeepEqual</span><span class="op" id="8227803">(</span><span class="ident" id="8227804">c</span><span class="op" id="8227805">,</span>&nbsp;<span class="ident" id="8227807">tt</span><span class="op" id="8227809">.</span><span class="ident" id="8227810">Cookies</span><span class="op" id="8227817">)</span>&nbsp;<span class="op" id="8227819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8227825">t</span><span class="op" id="8227826">.</span><span class="ident" id="8227827">Errorf</span><span class="op" id="8227833">(</span><span class="string" id="8227834">&#34;#%d&nbsp;readSetCookies:&nbsp;have\n%s\nwant\n%s\n&#34;</span><span class="op" id="8227876">,</span>&nbsp;<span class="ident" id="8227878">i</span><span class="op" id="8227879">,</span>&nbsp;<span class="ident" id="8227881">toJSON</span><span class="op" id="8227887">(</span><span class="ident" id="8227888">c</span><span class="op" id="8227889">)</span><span class="op" id="8227890">,</span>&nbsp;<span class="ident" id="8227892">toJSON</span><span class="op" id="8227898">(</span><span class="ident" id="8227899">tt</span><span class="op" id="8227901">.</span><span class="ident" id="8227902">Cookies</span><span class="op" id="8227909">)</span><span class="op" id="8227910">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8227916">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8227928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8227932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8227935">}</span><br>
<span class="lineno"></span><span class="op" id="8227937">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="keyword" id="8227940">var</span>&nbsp;<span class="ident" id="8227944">readCookiesTests</span>&nbsp;<span class="op" id="8227961">=</span>&nbsp;<span class="op" id="8227963">[</span><span class="op" id="8227964">]</span><span class="keyword" id="8227965">struct</span>&nbsp;<span class="op" id="8227972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8227975">Header</span>&nbsp;&nbsp;<span class="ident" id="8227983">Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8227991">Filter</span>&nbsp;&nbsp;<span class="builtintype" id="8227999">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8228007">Cookies</span>&nbsp;<span class="op" id="8228015">[</span><span class="op" id="8228016">]</span><span class="op" id="8228017">*</span><span class="ident" id="8228018">Cookie</span><br>
<span class="lineno">285</span><span class="op" id="8228025">}</span><span class="op" id="8228026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8228029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8228033">Header</span><span class="op" id="8228039">{</span><span class="string" id="8228040">&#34;Cookie&#34;</span><span class="op" id="8228048">:</span>&nbsp;<span class="op" id="8228050">{</span><span class="string" id="8228051">&#34;Cookie-1=v$1&#34;</span><span class="op" id="8228065">,</span>&nbsp;<span class="string" id="8228067">&#34;c2=v2&#34;</span><span class="op" id="8228074">}</span><span class="op" id="8228075">}</span><span class="op" id="8228076">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8228080">&#34;&#34;</span><span class="op" id="8228082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8228086">[</span><span class="op" id="8228087">]</span><span class="op" id="8228088">*</span><span class="ident" id="8228089">Cookie</span><span class="op" id="8228095">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8228100">{</span><span class="ident" id="8228101">Name</span><span class="op" id="8228105">:</span>&nbsp;<span class="string" id="8228107">&#34;Cookie-1&#34;</span><span class="op" id="8228117">,</span>&nbsp;<span class="ident" id="8228119">Value</span><span class="op" id="8228124">:</span>&nbsp;<span class="string" id="8228126">&#34;v$1&#34;</span><span class="op" id="8228131">}</span><span class="op" id="8228132">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8228137">{</span><span class="ident" id="8228138">Name</span><span class="op" id="8228142">:</span>&nbsp;<span class="string" id="8228144">&#34;c2&#34;</span><span class="op" id="8228148">,</span>&nbsp;<span class="ident" id="8228150">Value</span><span class="op" id="8228155">:</span>&nbsp;<span class="string" id="8228157">&#34;v2&#34;</span><span class="op" id="8228161">}</span><span class="op" id="8228162">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8228166">}</span><span class="op" id="8228167">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8228170">}</span><span class="op" id="8228171">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8228174">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8228178">Header</span><span class="op" id="8228184">{</span><span class="string" id="8228185">&#34;Cookie&#34;</span><span class="op" id="8228193">:</span>&nbsp;<span class="op" id="8228195">{</span><span class="string" id="8228196">&#34;Cookie-1=v$1&#34;</span><span class="op" id="8228210">,</span>&nbsp;<span class="string" id="8228212">&#34;c2=v2&#34;</span><span class="op" id="8228219">}</span><span class="op" id="8228220">}</span><span class="op" id="8228221">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8228225">&#34;c2&#34;</span><span class="op" id="8228229">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8228233">[</span><span class="op" id="8228234">]</span><span class="op" id="8228235">*</span><span class="ident" id="8228236">Cookie</span><span class="op" id="8228242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8228247">{</span><span class="ident" id="8228248">Name</span><span class="op" id="8228252">:</span>&nbsp;<span class="string" id="8228254">&#34;c2&#34;</span><span class="op" id="8228258">,</span>&nbsp;<span class="ident" id="8228260">Value</span><span class="op" id="8228265">:</span>&nbsp;<span class="string" id="8228267">&#34;v2&#34;</span><span class="op" id="8228271">}</span><span class="op" id="8228272">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8228276">}</span><span class="op" id="8228277">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8228280">}</span><span class="op" id="8228281">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8228284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8228288">Header</span><span class="op" id="8228294">{</span><span class="string" id="8228295">&#34;Cookie&#34;</span><span class="op" id="8228303">:</span>&nbsp;<span class="op" id="8228305">{</span><span class="string" id="8228306">&#34;Cookie-1=v$1;&nbsp;c2=v2&#34;</span><span class="op" id="8228327">}</span><span class="op" id="8228328">}</span><span class="op" id="8228329">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8228333">&#34;&#34;</span><span class="op" id="8228335">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8228339">[</span><span class="op" id="8228340">]</span><span class="op" id="8228341">*</span><span class="ident" id="8228342">Cookie</span><span class="op" id="8228348">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8228353">{</span><span class="ident" id="8228354">Name</span><span class="op" id="8228358">:</span>&nbsp;<span class="string" id="8228360">&#34;Cookie-1&#34;</span><span class="op" id="8228370">,</span>&nbsp;<span class="ident" id="8228372">Value</span><span class="op" id="8228377">:</span>&nbsp;<span class="string" id="8228379">&#34;v$1&#34;</span><span class="op" id="8228384">}</span><span class="op" id="8228385">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8228390">{</span><span class="ident" id="8228391">Name</span><span class="op" id="8228395">:</span>&nbsp;<span class="string" id="8228397">&#34;c2&#34;</span><span class="op" id="8228401">,</span>&nbsp;<span class="ident" id="8228403">Value</span><span class="op" id="8228408">:</span>&nbsp;<span class="string" id="8228410">&#34;v2&#34;</span><span class="op" id="8228414">}</span><span class="op" id="8228415">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8228419">}</span><span class="op" id="8228420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8228423">}</span><span class="op" id="8228424">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8228427">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8228431">Header</span><span class="op" id="8228437">{</span><span class="string" id="8228438">&#34;Cookie&#34;</span><span class="op" id="8228446">:</span>&nbsp;<span class="op" id="8228448">{</span><span class="string" id="8228449">&#34;Cookie-1=v$1;&nbsp;c2=v2&#34;</span><span class="op" id="8228470">}</span><span class="op" id="8228471">}</span><span class="op" id="8228472">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8228476">&#34;c2&#34;</span><span class="op" id="8228480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8228484">[</span><span class="op" id="8228485">]</span><span class="op" id="8228486">*</span><span class="ident" id="8228487">Cookie</span><span class="op" id="8228493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8228498">{</span><span class="ident" id="8228499">Name</span><span class="op" id="8228503">:</span>&nbsp;<span class="string" id="8228505">&#34;c2&#34;</span><span class="op" id="8228509">,</span>&nbsp;<span class="ident" id="8228511">Value</span><span class="op" id="8228516">:</span>&nbsp;<span class="string" id="8228518">&#34;v2&#34;</span><span class="op" id="8228522">}</span><span class="op" id="8228523">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8228527">}</span><span class="op" id="8228528">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8228531">}</span><span class="op" id="8228532">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8228535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8228539">Header</span><span class="op" id="8228545">{</span><span class="string" id="8228546">&#34;Cookie&#34;</span><span class="op" id="8228554">:</span>&nbsp;<span class="op" id="8228556">{</span><span class="string" id="8228557">`Cookie-1=&#34;v$1&#34;;&nbsp;c2=&#34;v2&#34;`</span><span class="op" id="8228582">}</span><span class="op" id="8228583">}</span><span class="op" id="8228584">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8228588">&#34;&#34;</span><span class="op" id="8228590">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8228594">[</span><span class="op" id="8228595">]</span><span class="op" id="8228596">*</span><span class="ident" id="8228597">Cookie</span><span class="op" id="8228603">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8228608">{</span><span class="ident" id="8228609">Name</span><span class="op" id="8228613">:</span>&nbsp;<span class="string" id="8228615">&#34;Cookie-1&#34;</span><span class="op" id="8228625">,</span>&nbsp;<span class="ident" id="8228627">Value</span><span class="op" id="8228632">:</span>&nbsp;<span class="string" id="8228634">&#34;v$1&#34;</span><span class="op" id="8228639">}</span><span class="op" id="8228640">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8228645">{</span><span class="ident" id="8228646">Name</span><span class="op" id="8228650">:</span>&nbsp;<span class="string" id="8228652">&#34;c2&#34;</span><span class="op" id="8228656">,</span>&nbsp;<span class="ident" id="8228658">Value</span><span class="op" id="8228663">:</span>&nbsp;<span class="string" id="8228665">&#34;v2&#34;</span><span class="op" id="8228669">}</span><span class="op" id="8228670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8228674">}</span><span class="op" id="8228675">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8228678">}</span><span class="op" id="8228679">,</span><br>
<span class="lineno"></span><span class="op" id="8228681">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="8228684">func</span>&nbsp;<span class="ident" id="8228689">TestReadCookies</span><span class="op" id="8228704">(</span><span class="ident" id="8228705">t</span>&nbsp;<span class="op" id="8228707">*</span><span class="ident" id="8228708">testing</span><span class="op" id="8228715">.</span><span class="ident" id="8228716">T</span><span class="op" id="8228717">)</span>&nbsp;<span class="op" id="8228719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8228722">for</span>&nbsp;<span class="ident" id="8228726">i</span><span class="op" id="8228727">,</span>&nbsp;<span class="ident" id="8228729">tt</span>&nbsp;<span class="op" id="8228732">:=</span>&nbsp;<span class="keyword" id="8228735">range</span>&nbsp;<span class="ident" id="8228741">readCookiesTests</span>&nbsp;<span class="op" id="8228758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8228762">for</span>&nbsp;<span class="ident" id="8228766">n</span>&nbsp;<span class="op" id="8228768">:=</span>&nbsp;<span class="num" id="8228771">0</span><span class="op" id="8228772">;</span>&nbsp;<span class="ident" id="8228774">n</span>&nbsp;<span class="op" id="8228776">&lt;</span>&nbsp;<span class="num" id="8228778">2</span><span class="op" id="8228779">;</span>&nbsp;<span class="ident" id="8228781">n</span><span class="op" id="8228782">++</span>&nbsp;<span class="op" id="8228785">{</span>&nbsp;<span class="comment" id="8228787">//&nbsp;to&nbsp;verify&nbsp;readCookies&nbsp;doesn&#39;t&nbsp;mutate&nbsp;its&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8228840">c</span>&nbsp;<span class="op" id="8228842">:=</span>&nbsp;<span class="ident" id="8228845">readCookies</span><span class="op" id="8228856">(</span><span class="ident" id="8228857">tt</span><span class="op" id="8228859">.</span><span class="ident" id="8228860">Header</span><span class="op" id="8228866">,</span>&nbsp;<span class="ident" id="8228868">tt</span><span class="op" id="8228870">.</span><span class="ident" id="8228871">Filter</span><span class="op" id="8228877">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8228882">if</span>&nbsp;<span class="op" id="8228885">!</span><span class="ident" id="8228886">reflect</span><span class="op" id="8228893">.</span><span class="ident" id="8228894">DeepEqual</span><span class="op" id="8228903">(</span><span class="ident" id="8228904">c</span><span class="op" id="8228905">,</span>&nbsp;<span class="ident" id="8228907">tt</span><span class="op" id="8228909">.</span><span class="ident" id="8228910">Cookies</span><span class="op" id="8228917">)</span>&nbsp;<span class="op" id="8228919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8228925">t</span><span class="op" id="8228926">.</span><span class="ident" id="8228927">Errorf</span><span class="op" id="8228933">(</span><span class="string" id="8228934">&#34;#%d&nbsp;readCookies:\nhave:&nbsp;%s\nwant:&nbsp;%s\n&#34;</span><span class="op" id="8228974">,</span>&nbsp;<span class="ident" id="8228976">i</span><span class="op" id="8228977">,</span>&nbsp;<span class="ident" id="8228979">toJSON</span><span class="op" id="8228985">(</span><span class="ident" id="8228986">c</span><span class="op" id="8228987">)</span><span class="op" id="8228988">,</span>&nbsp;<span class="ident" id="8228990">toJSON</span><span class="op" id="8228996">(</span><span class="ident" id="8228997">tt</span><span class="op" id="8228999">.</span><span class="ident" id="8229000">Cookies</span><span class="op" id="8229007">)</span><span class="op" id="8229008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8229014">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8229026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8229030">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8229033">}</span><br>
<span class="lineno"></span><span class="op" id="8229035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8229038">func</span>&nbsp;<span class="ident" id="8229043">TestSetCookieDoubleQuotes</span><span class="op" id="8229068">(</span><span class="ident" id="8229069">t</span>&nbsp;<span class="op" id="8229071">*</span><span class="ident" id="8229072">testing</span><span class="op" id="8229079">.</span><span class="ident" id="8229080">T</span><span class="op" id="8229081">)</span>&nbsp;<span class="op" id="8229083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8229086">res</span>&nbsp;<span class="op" id="8229090">:=</span>&nbsp;<span class="op" id="8229093">&amp;</span><span class="ident" id="8229094">Response</span><span class="op" id="8229102">{</span><span class="ident" id="8229103">Header</span><span class="op" id="8229109">:</span>&nbsp;<span class="ident" id="8229111">Header</span><span class="op" id="8229117">{</span><span class="op" id="8229118">}</span><span class="op" id="8229119">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8229122">res</span><span class="op" id="8229125">.</span><span class="ident" id="8229126">Header</span><span class="op" id="8229132">.</span><span class="ident" id="8229133">Add</span><span class="op" id="8229136">(</span><span class="string" id="8229137">&#34;Set-Cookie&#34;</span><span class="op" id="8229149">,</span>&nbsp;<span class="string" id="8229151">`quoted0=none;&nbsp;max-age=30`</span><span class="op" id="8229177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8229180">res</span><span class="op" id="8229183">.</span><span class="ident" id="8229184">Header</span><span class="op" id="8229190">.</span><span class="ident" id="8229191">Add</span><span class="op" id="8229194">(</span><span class="string" id="8229195">&#34;Set-Cookie&#34;</span><span class="op" id="8229207">,</span>&nbsp;<span class="string" id="8229209">`quoted1=&#34;cookieValue&#34;;&nbsp;max-age=31`</span><span class="op" id="8229244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8229247">res</span><span class="op" id="8229250">.</span><span class="ident" id="8229251">Header</span><span class="op" id="8229257">.</span><span class="ident" id="8229258">Add</span><span class="op" id="8229261">(</span><span class="string" id="8229262">&#34;Set-Cookie&#34;</span><span class="op" id="8229274">,</span>&nbsp;<span class="string" id="8229276">`quoted2=cookieAV;&nbsp;max-age=&#34;32&#34;`</span><span class="op" id="8229308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8229311">res</span><span class="op" id="8229314">.</span><span class="ident" id="8229315">Header</span><span class="op" id="8229321">.</span><span class="ident" id="8229322">Add</span><span class="op" id="8229325">(</span><span class="string" id="8229326">&#34;Set-Cookie&#34;</span><span class="op" id="8229338">,</span>&nbsp;<span class="string" id="8229340">`quoted3=&#34;both&#34;;&nbsp;max-age=&#34;33&#34;`</span><span class="op" id="8229370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8229373">got</span>&nbsp;<span class="op" id="8229377">:=</span>&nbsp;<span class="ident" id="8229380">res</span><span class="op" id="8229383">.</span><span class="ident" id="8229384">Cookies</span><span class="op" id="8229391">(</span><span class="op" id="8229392">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8229395">want</span>&nbsp;<span class="op" id="8229400">:=</span>&nbsp;<span class="op" id="8229403">[</span><span class="op" id="8229404">]</span><span class="op" id="8229405">*</span><span class="ident" id="8229406">Cookie</span><span class="op" id="8229412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8229416">{</span><span class="ident" id="8229417">Name</span><span class="op" id="8229421">:</span>&nbsp;<span class="string" id="8229423">&#34;quoted0&#34;</span><span class="op" id="8229432">,</span>&nbsp;<span class="ident" id="8229434">Value</span><span class="op" id="8229439">:</span>&nbsp;<span class="string" id="8229441">&#34;none&#34;</span><span class="op" id="8229447">,</span>&nbsp;<span class="ident" id="8229449">MaxAge</span><span class="op" id="8229455">:</span>&nbsp;<span class="num" id="8229457">30</span><span class="op" id="8229459">}</span><span class="op" id="8229460">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8229464">{</span><span class="ident" id="8229465">Name</span><span class="op" id="8229469">:</span>&nbsp;<span class="string" id="8229471">&#34;quoted1&#34;</span><span class="op" id="8229480">,</span>&nbsp;<span class="ident" id="8229482">Value</span><span class="op" id="8229487">:</span>&nbsp;<span class="string" id="8229489">&#34;cookieValue&#34;</span><span class="op" id="8229502">,</span>&nbsp;<span class="ident" id="8229504">MaxAge</span><span class="op" id="8229510">:</span>&nbsp;<span class="num" id="8229512">31</span><span class="op" id="8229514">}</span><span class="op" id="8229515">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8229519">{</span><span class="ident" id="8229520">Name</span><span class="op" id="8229524">:</span>&nbsp;<span class="string" id="8229526">&#34;quoted2&#34;</span><span class="op" id="8229535">,</span>&nbsp;<span class="ident" id="8229537">Value</span><span class="op" id="8229542">:</span>&nbsp;<span class="string" id="8229544">&#34;cookieAV&#34;</span><span class="op" id="8229554">}</span><span class="op" id="8229555">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8229559">{</span><span class="ident" id="8229560">Name</span><span class="op" id="8229564">:</span>&nbsp;<span class="string" id="8229566">&#34;quoted3&#34;</span><span class="op" id="8229575">,</span>&nbsp;<span class="ident" id="8229577">Value</span><span class="op" id="8229582">:</span>&nbsp;<span class="string" id="8229584">&#34;both&#34;</span><span class="op" id="8229590">}</span><span class="op" id="8229591">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8229594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8229597">if</span>&nbsp;<span class="builtinfunc" id="8229600">len</span><span class="op" id="8229603">(</span><span class="ident" id="8229604">got</span><span class="op" id="8229607">)</span>&nbsp;<span class="op" id="8229609">!=</span>&nbsp;<span class="builtinfunc" id="8229612">len</span><span class="op" id="8229615">(</span><span class="ident" id="8229616">want</span><span class="op" id="8229620">)</span>&nbsp;<span class="op" id="8229622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8229626">t</span><span class="op" id="8229627">.</span><span class="ident" id="8229628">Fatal</span><span class="op" id="8229633">(</span><span class="string" id="8229634">&#34;got&nbsp;%d&nbsp;cookies,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8229659">,</span>&nbsp;<span class="builtinfunc" id="8229661">len</span><span class="op" id="8229664">(</span><span class="ident" id="8229665">got</span><span class="op" id="8229668">)</span><span class="op" id="8229669">,</span>&nbsp;<span class="builtinfunc" id="8229671">len</span><span class="op" id="8229674">(</span><span class="ident" id="8229675">want</span><span class="op" id="8229679">)</span><span class="op" id="8229680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8229683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8229686">for</span>&nbsp;<span class="ident" id="8229690">i</span><span class="op" id="8229691">,</span>&nbsp;<span class="ident" id="8229693">w</span>&nbsp;<span class="op" id="8229695">:=</span>&nbsp;<span class="keyword" id="8229698">range</span>&nbsp;<span class="ident" id="8229704">want</span>&nbsp;<span class="op" id="8229709">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8229713">g</span>&nbsp;<span class="op" id="8229715">:=</span>&nbsp;<span class="ident" id="8229718">got</span><span class="op" id="8229721">[</span><span class="ident" id="8229722">i</span><span class="op" id="8229723">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8229727">if</span>&nbsp;<span class="ident" id="8229730">g</span><span class="op" id="8229731">.</span><span class="ident" id="8229732">Name</span>&nbsp;<span class="op" id="8229737">!=</span>&nbsp;<span class="ident" id="8229740">w</span><span class="op" id="8229741">.</span><span class="ident" id="8229742">Name</span>&nbsp;<span class="op" id="8229747">||</span>&nbsp;<span class="ident" id="8229750">g</span><span class="op" id="8229751">.</span><span class="ident" id="8229752">Value</span>&nbsp;<span class="op" id="8229758">!=</span>&nbsp;<span class="ident" id="8229761">w</span><span class="op" id="8229762">.</span><span class="ident" id="8229763">Value</span>&nbsp;<span class="op" id="8229769">||</span>&nbsp;<span class="ident" id="8229772">g</span><span class="op" id="8229773">.</span><span class="ident" id="8229774">MaxAge</span>&nbsp;<span class="op" id="8229781">!=</span>&nbsp;<span class="ident" id="8229784">w</span><span class="op" id="8229785">.</span><span class="ident" id="8229786">MaxAge</span>&nbsp;<span class="op" id="8229793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8229798">t</span><span class="op" id="8229799">.</span><span class="ident" id="8229800">Errorf</span><span class="op" id="8229806">(</span><span class="string" id="8229807">&#34;cookie&nbsp;#%d:\ngot&nbsp;&nbsp;%v\nwant&nbsp;%v&#34;</span><span class="op" id="8229838">,</span>&nbsp;<span class="ident" id="8229840">i</span><span class="op" id="8229841">,</span>&nbsp;<span class="ident" id="8229843">g</span><span class="op" id="8229844">,</span>&nbsp;<span class="ident" id="8229846">w</span><span class="op" id="8229847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8229851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8229854">}</span><br>
<span class="lineno">360</span><span class="op" id="8229856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8229859">func</span>&nbsp;<span class="ident" id="8229864">TestCookieSanitizeValue</span><span class="op" id="8229887">(</span><span class="ident" id="8229888">t</span>&nbsp;<span class="op" id="8229890">*</span><span class="ident" id="8229891">testing</span><span class="op" id="8229898">.</span><span class="ident" id="8229899">T</span><span class="op" id="8229900">)</span>&nbsp;<span class="op" id="8229902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8229905">defer</span>&nbsp;<span class="ident" id="8229911">log</span><span class="op" id="8229914">.</span><span class="ident" id="8229915">SetOutput</span><span class="op" id="8229924">(</span><span class="ident" id="8229925">os</span><span class="op" id="8229927">.</span><span class="ident" id="8229928">Stderr</span><span class="op" id="8229934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8229937">var</span>&nbsp;<span class="ident" id="8229941">logbuf</span>&nbsp;<span class="ident" id="8229948">bytes</span><span class="op" id="8229953">.</span><span class="ident" id="8229954">Buffer</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8229962">log</span><span class="op" id="8229965">.</span><span class="ident" id="8229966">SetOutput</span><span class="op" id="8229975">(</span><span class="op" id="8229976">&amp;</span><span class="ident" id="8229977">logbuf</span><span class="op" id="8229983">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8229987">tests</span>&nbsp;<span class="op" id="8229993">:=</span>&nbsp;<span class="op" id="8229996">[</span><span class="op" id="8229997">]</span><span class="keyword" id="8229998">struct</span>&nbsp;<span class="op" id="8230005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8230009">in</span><span class="op" id="8230011">,</span>&nbsp;<span class="ident" id="8230013">want</span>&nbsp;<span class="builtintype" id="8230018">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8230026">}</span><span class="op" id="8230027">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8230031">{</span><span class="string" id="8230032">&#34;foo&#34;</span><span class="op" id="8230037">,</span>&nbsp;<span class="string" id="8230039">&#34;foo&#34;</span><span class="op" id="8230044">}</span><span class="op" id="8230045">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8230049">{</span><span class="string" id="8230050">&#34;foo;bar&#34;</span><span class="op" id="8230059">,</span>&nbsp;<span class="string" id="8230061">&#34;foobar&#34;</span><span class="op" id="8230069">}</span><span class="op" id="8230070">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8230074">{</span><span class="string" id="8230075">&#34;foo\\bar&#34;</span><span class="op" id="8230085">,</span>&nbsp;<span class="string" id="8230087">&#34;foobar&#34;</span><span class="op" id="8230095">}</span><span class="op" id="8230096">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8230100">{</span><span class="string" id="8230101">&#34;foo\&#34;bar&#34;</span><span class="op" id="8230111">,</span>&nbsp;<span class="string" id="8230113">&#34;foobar&#34;</span><span class="op" id="8230121">}</span><span class="op" id="8230122">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8230126">{</span><span class="string" id="8230127">&#34;\x00\x7e\x7f\x80&#34;</span><span class="op" id="8230145">,</span>&nbsp;<span class="string" id="8230147">&#34;\x7e&#34;</span><span class="op" id="8230153">}</span><span class="op" id="8230154">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8230158">{</span><span class="string" id="8230159">`&#34;withquotes&#34;`</span><span class="op" id="8230173">,</span>&nbsp;<span class="string" id="8230175">&#34;withquotes&#34;</span><span class="op" id="8230187">}</span><span class="op" id="8230188">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8230192">{</span><span class="string" id="8230193">&#34;a&nbsp;z&#34;</span><span class="op" id="8230198">,</span>&nbsp;<span class="string" id="8230200">&#34;a&nbsp;z&#34;</span><span class="op" id="8230205">}</span><span class="op" id="8230206">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8230210">{</span><span class="string" id="8230211">&#34;&nbsp;z&#34;</span><span class="op" id="8230215">,</span>&nbsp;<span class="string" id="8230217">`&#34;&nbsp;z&#34;`</span><span class="op" id="8230223">}</span><span class="op" id="8230224">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8230228">{</span><span class="string" id="8230229">&#34;a&nbsp;&#34;</span><span class="op" id="8230233">,</span>&nbsp;<span class="string" id="8230235">`&#34;a&nbsp;&#34;`</span><span class="op" id="8230241">}</span><span class="op" id="8230242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8230245">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8230248">for</span>&nbsp;<span class="ident" id="8230252">_</span><span class="op" id="8230253">,</span>&nbsp;<span class="ident" id="8230255">tt</span>&nbsp;<span class="op" id="8230258">:=</span>&nbsp;<span class="keyword" id="8230261">range</span>&nbsp;<span class="ident" id="8230267">tests</span>&nbsp;<span class="op" id="8230273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8230277">if</span>&nbsp;<span class="ident" id="8230280">got</span>&nbsp;<span class="op" id="8230284">:=</span>&nbsp;<span class="ident" id="8230287">sanitizeCookieValue</span><span class="op" id="8230306">(</span><span class="ident" id="8230307">tt</span><span class="op" id="8230309">.</span><span class="ident" id="8230310">in</span><span class="op" id="8230312">)</span><span class="op" id="8230313">;</span>&nbsp;<span class="ident" id="8230315">got</span>&nbsp;<span class="op" id="8230319">!=</span>&nbsp;<span class="ident" id="8230322">tt</span><span class="op" id="8230324">.</span><span class="ident" id="8230325">want</span>&nbsp;<span class="op" id="8230330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8230335">t</span><span class="op" id="8230336">.</span><span class="ident" id="8230337">Errorf</span><span class="op" id="8230343">(</span><span class="string" id="8230344">&#34;sanitizeCookieValue(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8230383">,</span>&nbsp;<span class="ident" id="8230385">tt</span><span class="op" id="8230387">.</span><span class="ident" id="8230388">in</span><span class="op" id="8230390">,</span>&nbsp;<span class="ident" id="8230392">got</span><span class="op" id="8230395">,</span>&nbsp;<span class="ident" id="8230397">tt</span><span class="op" id="8230399">.</span><span class="ident" id="8230400">want</span><span class="op" id="8230404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8230408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8230411">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8230415">if</span>&nbsp;<span class="ident" id="8230418">got</span><span class="op" id="8230421">,</span>&nbsp;<span class="ident" id="8230423">sub</span>&nbsp;<span class="op" id="8230427">:=</span>&nbsp;<span class="ident" id="8230430">logbuf</span><span class="op" id="8230436">.</span><span class="ident" id="8230437">String</span><span class="op" id="8230443">(</span><span class="op" id="8230444">)</span><span class="op" id="8230445">,</span>&nbsp;<span class="string" id="8230447">&#34;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="8230471">;</span>&nbsp;<span class="op" id="8230473">!</span><span class="ident" id="8230474">strings</span><span class="op" id="8230481">.</span><span class="ident" id="8230482">Contains</span><span class="op" id="8230490">(</span><span class="ident" id="8230491">got</span><span class="op" id="8230494">,</span>&nbsp;<span class="ident" id="8230496">sub</span><span class="op" id="8230499">)</span>&nbsp;<span class="op" id="8230501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8230505">t</span><span class="op" id="8230506">.</span><span class="ident" id="8230507">Errorf</span><span class="op" id="8230513">(</span><span class="string" id="8230514">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="8230561">,</span>&nbsp;<span class="ident" id="8230563">sub</span><span class="op" id="8230566">,</span>&nbsp;<span class="ident" id="8230568">got</span><span class="op" id="8230571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8230574">}</span><br>
<span class="lineno"></span><span class="op" id="8230576">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span><span class="keyword" id="8230579">func</span>&nbsp;<span class="ident" id="8230584">TestCookieSanitizePath</span><span class="op" id="8230606">(</span><span class="ident" id="8230607">t</span>&nbsp;<span class="op" id="8230609">*</span><span class="ident" id="8230610">testing</span><span class="op" id="8230617">.</span><span class="ident" id="8230618">T</span><span class="op" id="8230619">)</span>&nbsp;<span class="op" id="8230621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8230624">defer</span>&nbsp;<span class="ident" id="8230630">log</span><span class="op" id="8230633">.</span><span class="ident" id="8230634">SetOutput</span><span class="op" id="8230643">(</span><span class="ident" id="8230644">os</span><span class="op" id="8230646">.</span><span class="ident" id="8230647">Stderr</span><span class="op" id="8230653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8230656">var</span>&nbsp;<span class="ident" id="8230660">logbuf</span>&nbsp;<span class="ident" id="8230667">bytes</span><span class="op" id="8230672">.</span><span class="ident" id="8230673">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8230681">log</span><span class="op" id="8230684">.</span><span class="ident" id="8230685">SetOutput</span><span class="op" id="8230694">(</span><span class="op" id="8230695">&amp;</span><span class="ident" id="8230696">logbuf</span><span class="op" id="8230702">)</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8230706">tests</span>&nbsp;<span class="op" id="8230712">:=</span>&nbsp;<span class="op" id="8230715">[</span><span class="op" id="8230716">]</span><span class="keyword" id="8230717">struct</span>&nbsp;<span class="op" id="8230724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8230728">in</span><span class="op" id="8230730">,</span>&nbsp;<span class="ident" id="8230732">want</span>&nbsp;<span class="builtintype" id="8230737">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8230745">}</span><span class="op" id="8230746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8230750">{</span><span class="string" id="8230751">&#34;/path&#34;</span><span class="op" id="8230758">,</span>&nbsp;<span class="string" id="8230760">&#34;/path&#34;</span><span class="op" id="8230767">}</span><span class="op" id="8230768">,</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8230772">{</span><span class="string" id="8230773">&#34;/path&nbsp;with&nbsp;space/&#34;</span><span class="op" id="8230792">,</span>&nbsp;<span class="string" id="8230794">&#34;/path&nbsp;with&nbsp;space/&#34;</span><span class="op" id="8230813">}</span><span class="op" id="8230814">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8230818">{</span><span class="string" id="8230819">&#34;/just;no;semicolon\x00orstuff/&#34;</span><span class="op" id="8230851">,</span>&nbsp;<span class="string" id="8230853">&#34;/justnosemicolonorstuff/&#34;</span><span class="op" id="8230879">}</span><span class="op" id="8230880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8230883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8230886">for</span>&nbsp;<span class="ident" id="8230890">_</span><span class="op" id="8230891">,</span>&nbsp;<span class="ident" id="8230893">tt</span>&nbsp;<span class="op" id="8230896">:=</span>&nbsp;<span class="keyword" id="8230899">range</span>&nbsp;<span class="ident" id="8230905">tests</span>&nbsp;<span class="op" id="8230911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8230915">if</span>&nbsp;<span class="ident" id="8230918">got</span>&nbsp;<span class="op" id="8230922">:=</span>&nbsp;<span class="ident" id="8230925">sanitizeCookiePath</span><span class="op" id="8230943">(</span><span class="ident" id="8230944">tt</span><span class="op" id="8230946">.</span><span class="ident" id="8230947">in</span><span class="op" id="8230949">)</span><span class="op" id="8230950">;</span>&nbsp;<span class="ident" id="8230952">got</span>&nbsp;<span class="op" id="8230956">!=</span>&nbsp;<span class="ident" id="8230959">tt</span><span class="op" id="8230961">.</span><span class="ident" id="8230962">want</span>&nbsp;<span class="op" id="8230967">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8230972">t</span><span class="op" id="8230973">.</span><span class="ident" id="8230974">Errorf</span><span class="op" id="8230980">(</span><span class="string" id="8230981">&#34;sanitizeCookiePath(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8231019">,</span>&nbsp;<span class="ident" id="8231021">tt</span><span class="op" id="8231023">.</span><span class="ident" id="8231024">in</span><span class="op" id="8231026">,</span>&nbsp;<span class="ident" id="8231028">got</span><span class="op" id="8231031">,</span>&nbsp;<span class="ident" id="8231033">tt</span><span class="op" id="8231035">.</span><span class="ident" id="8231036">want</span><span class="op" id="8231040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8231044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8231047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8231051">if</span>&nbsp;<span class="ident" id="8231054">got</span><span class="op" id="8231057">,</span>&nbsp;<span class="ident" id="8231059">sub</span>&nbsp;<span class="op" id="8231063">:=</span>&nbsp;<span class="ident" id="8231066">logbuf</span><span class="op" id="8231072">.</span><span class="ident" id="8231073">String</span><span class="op" id="8231079">(</span><span class="op" id="8231080">)</span><span class="op" id="8231081">,</span>&nbsp;<span class="string" id="8231083">&#34;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="8231107">;</span>&nbsp;<span class="op" id="8231109">!</span><span class="ident" id="8231110">strings</span><span class="op" id="8231117">.</span><span class="ident" id="8231118">Contains</span><span class="op" id="8231126">(</span><span class="ident" id="8231127">got</span><span class="op" id="8231130">,</span>&nbsp;<span class="ident" id="8231132">sub</span><span class="op" id="8231135">)</span>&nbsp;<span class="op" id="8231137">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8231141">t</span><span class="op" id="8231142">.</span><span class="ident" id="8231143">Errorf</span><span class="op" id="8231149">(</span><span class="string" id="8231150">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="8231197">,</span>&nbsp;<span class="ident" id="8231199">sub</span><span class="op" id="8231202">,</span>&nbsp;<span class="ident" id="8231204">got</span><span class="op" id="8231207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8231210">}</span><br>
<span class="lineno"></span><span class="op" id="8231212">}</span>
</div>
</body>
</html>
