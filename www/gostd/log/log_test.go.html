<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>log</h2>
<ul>
<li><a href="/gostd/log/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/log/log.go.html">log.go</a></li>
<li><a href="/gostd/log/log_test.go.html" class="current">log_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6699320">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6699375">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6699429">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6699480">package</span>&nbsp;<span class="ident" id="6699488">log</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6699493">//&nbsp;These&nbsp;tests&nbsp;are&nbsp;too&nbsp;simple.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6699525">import</span>&nbsp;<span class="op" id="6699532">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6699535">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6699544">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6699550">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6699560">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6699570">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="6699573">const</span>&nbsp;<span class="op" id="6699579">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6699582">Rdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6699596">=</span>&nbsp;<span class="string" id="6699598">`[0-9][0-9][0-9][0-9]/[0-9][0-9]/[0-9][0-9]`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6699644">Rtime</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6699658">=</span>&nbsp;<span class="string" id="6699660">`[0-9][0-9]:[0-9][0-9]:[0-9][0-9]`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6699696">Rmicroseconds</span>&nbsp;<span class="op" id="6699710">=</span>&nbsp;<span class="string" id="6699712">`\.[0-9][0-9][0-9][0-9][0-9][0-9]`</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6699748">Rline</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6699762">=</span>&nbsp;<span class="string" id="6699764">`(54|56):`</span>&nbsp;<span class="comment" id="6699775">//&nbsp;must&nbsp;update&nbsp;if&nbsp;the&nbsp;calls&nbsp;to&nbsp;l.Printf&nbsp;/&nbsp;l.Print&nbsp;below&nbsp;move</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6699837">Rlongfile</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6699851">=</span>&nbsp;<span class="string" id="6699853">`.*/[A-Za-z0-9_\-]+\.go:`</span>&nbsp;<span class="op" id="6699879">+</span>&nbsp;<span class="ident" id="6699881">Rline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6699888">Rshortfile</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6699902">=</span>&nbsp;<span class="string" id="6699904">`[A-Za-z0-9_\-]+\.go:`</span>&nbsp;<span class="op" id="6699927">+</span>&nbsp;<span class="ident" id="6699929">Rline</span><br>
<span class="lineno"></span><span class="op" id="6699935">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="6699938">type</span>&nbsp;<span class="ident" id="6699943">tester</span>&nbsp;<span class="keyword" id="6699950">struct</span>&nbsp;<span class="op" id="6699957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6699960">flag</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6699968">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6699973">prefix</span>&nbsp;&nbsp;<span class="builtintype" id="6699981">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6699989">pattern</span>&nbsp;<span class="builtintype" id="6699997">string</span>&nbsp;<span class="comment" id="6700004">//&nbsp;regexp&nbsp;that&nbsp;log&nbsp;output&nbsp;must&nbsp;match;&nbsp;we&nbsp;add&nbsp;^&nbsp;and&nbsp;expected_text$&nbsp;always</span><br>
<span class="lineno"></span><span class="op" id="6700077">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="6700080">var</span>&nbsp;<span class="ident" id="6700084">tests</span>&nbsp;<span class="op" id="6700090">=</span>&nbsp;<span class="op" id="6700092">[</span><span class="op" id="6700093">]</span><span class="ident" id="6700094">tester</span><span class="op" id="6700100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6700103">//&nbsp;individual&nbsp;pieces:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6700126">{</span><span class="num" id="6700127">0</span><span class="op" id="6700128">,</span>&nbsp;<span class="string" id="6700130">&#34;&#34;</span><span class="op" id="6700132">,</span>&nbsp;<span class="string" id="6700134">&#34;&#34;</span><span class="op" id="6700136">}</span><span class="op" id="6700137">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6700140">{</span><span class="num" id="6700141">0</span><span class="op" id="6700142">,</span>&nbsp;<span class="string" id="6700144">&#34;XXX&#34;</span><span class="op" id="6700149">,</span>&nbsp;<span class="string" id="6700151">&#34;XXX&#34;</span><span class="op" id="6700156">}</span><span class="op" id="6700157">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6700160">{</span><span class="ident" id="6700161">Ldate</span><span class="op" id="6700166">,</span>&nbsp;<span class="string" id="6700168">&#34;&#34;</span><span class="op" id="6700170">,</span>&nbsp;<span class="ident" id="6700172">Rdate</span>&nbsp;<span class="op" id="6700178">+</span>&nbsp;<span class="string" id="6700180">&#34;&nbsp;&#34;</span><span class="op" id="6700183">}</span><span class="op" id="6700184">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6700187">{</span><span class="ident" id="6700188">Ltime</span><span class="op" id="6700193">,</span>&nbsp;<span class="string" id="6700195">&#34;&#34;</span><span class="op" id="6700197">,</span>&nbsp;<span class="ident" id="6700199">Rtime</span>&nbsp;<span class="op" id="6700205">+</span>&nbsp;<span class="string" id="6700207">&#34;&nbsp;&#34;</span><span class="op" id="6700210">}</span><span class="op" id="6700211">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6700214">{</span><span class="ident" id="6700215">Ltime</span>&nbsp;<span class="op" id="6700221">|</span>&nbsp;<span class="ident" id="6700223">Lmicroseconds</span><span class="op" id="6700236">,</span>&nbsp;<span class="string" id="6700238">&#34;&#34;</span><span class="op" id="6700240">,</span>&nbsp;<span class="ident" id="6700242">Rtime</span>&nbsp;<span class="op" id="6700248">+</span>&nbsp;<span class="ident" id="6700250">Rmicroseconds</span>&nbsp;<span class="op" id="6700264">+</span>&nbsp;<span class="string" id="6700266">&#34;&nbsp;&#34;</span><span class="op" id="6700269">}</span><span class="op" id="6700270">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6700273">{</span><span class="ident" id="6700274">Lmicroseconds</span><span class="op" id="6700287">,</span>&nbsp;<span class="string" id="6700289">&#34;&#34;</span><span class="op" id="6700291">,</span>&nbsp;<span class="ident" id="6700293">Rtime</span>&nbsp;<span class="op" id="6700299">+</span>&nbsp;<span class="ident" id="6700301">Rmicroseconds</span>&nbsp;<span class="op" id="6700315">+</span>&nbsp;<span class="string" id="6700317">&#34;&nbsp;&#34;</span><span class="op" id="6700320">}</span><span class="op" id="6700321">,</span>&nbsp;<span class="comment" id="6700323">//&nbsp;microsec&nbsp;implies&nbsp;time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6700349">{</span><span class="ident" id="6700350">Llongfile</span><span class="op" id="6700359">,</span>&nbsp;<span class="string" id="6700361">&#34;&#34;</span><span class="op" id="6700363">,</span>&nbsp;<span class="ident" id="6700365">Rlongfile</span>&nbsp;<span class="op" id="6700375">+</span>&nbsp;<span class="string" id="6700377">&#34;&nbsp;&#34;</span><span class="op" id="6700380">}</span><span class="op" id="6700381">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6700384">{</span><span class="ident" id="6700385">Lshortfile</span><span class="op" id="6700395">,</span>&nbsp;<span class="string" id="6700397">&#34;&#34;</span><span class="op" id="6700399">,</span>&nbsp;<span class="ident" id="6700401">Rshortfile</span>&nbsp;<span class="op" id="6700412">+</span>&nbsp;<span class="string" id="6700414">&#34;&nbsp;&#34;</span><span class="op" id="6700417">}</span><span class="op" id="6700418">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6700421">{</span><span class="ident" id="6700422">Llongfile</span>&nbsp;<span class="op" id="6700432">|</span>&nbsp;<span class="ident" id="6700434">Lshortfile</span><span class="op" id="6700444">,</span>&nbsp;<span class="string" id="6700446">&#34;&#34;</span><span class="op" id="6700448">,</span>&nbsp;<span class="ident" id="6700450">Rshortfile</span>&nbsp;<span class="op" id="6700461">+</span>&nbsp;<span class="string" id="6700463">&#34;&nbsp;&#34;</span><span class="op" id="6700466">}</span><span class="op" id="6700467">,</span>&nbsp;<span class="comment" id="6700469">//&nbsp;shortfile&nbsp;overrides&nbsp;longfile</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6700502">//&nbsp;everything&nbsp;at&nbsp;once:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6700526">{</span><span class="ident" id="6700527">Ldate</span>&nbsp;<span class="op" id="6700533">|</span>&nbsp;<span class="ident" id="6700535">Ltime</span>&nbsp;<span class="op" id="6700541">|</span>&nbsp;<span class="ident" id="6700543">Lmicroseconds</span>&nbsp;<span class="op" id="6700557">|</span>&nbsp;<span class="ident" id="6700559">Llongfile</span><span class="op" id="6700568">,</span>&nbsp;<span class="string" id="6700570">&#34;XXX&#34;</span><span class="op" id="6700575">,</span>&nbsp;<span class="string" id="6700577">&#34;XXX&#34;</span>&nbsp;<span class="op" id="6700583">+</span>&nbsp;<span class="ident" id="6700585">Rdate</span>&nbsp;<span class="op" id="6700591">+</span>&nbsp;<span class="string" id="6700593">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="6700597">+</span>&nbsp;<span class="ident" id="6700599">Rtime</span>&nbsp;<span class="op" id="6700605">+</span>&nbsp;<span class="ident" id="6700607">Rmicroseconds</span>&nbsp;<span class="op" id="6700621">+</span>&nbsp;<span class="string" id="6700623">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="6700627">+</span>&nbsp;<span class="ident" id="6700629">Rlongfile</span>&nbsp;<span class="op" id="6700639">+</span>&nbsp;<span class="string" id="6700641">&#34;&nbsp;&#34;</span><span class="op" id="6700644">}</span><span class="op" id="6700645">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6700648">{</span><span class="ident" id="6700649">Ldate</span>&nbsp;<span class="op" id="6700655">|</span>&nbsp;<span class="ident" id="6700657">Ltime</span>&nbsp;<span class="op" id="6700663">|</span>&nbsp;<span class="ident" id="6700665">Lmicroseconds</span>&nbsp;<span class="op" id="6700679">|</span>&nbsp;<span class="ident" id="6700681">Lshortfile</span><span class="op" id="6700691">,</span>&nbsp;<span class="string" id="6700693">&#34;XXX&#34;</span><span class="op" id="6700698">,</span>&nbsp;<span class="string" id="6700700">&#34;XXX&#34;</span>&nbsp;<span class="op" id="6700706">+</span>&nbsp;<span class="ident" id="6700708">Rdate</span>&nbsp;<span class="op" id="6700714">+</span>&nbsp;<span class="string" id="6700716">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="6700720">+</span>&nbsp;<span class="ident" id="6700722">Rtime</span>&nbsp;<span class="op" id="6700728">+</span>&nbsp;<span class="ident" id="6700730">Rmicroseconds</span>&nbsp;<span class="op" id="6700744">+</span>&nbsp;<span class="string" id="6700746">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="6700750">+</span>&nbsp;<span class="ident" id="6700752">Rshortfile</span>&nbsp;<span class="op" id="6700763">+</span>&nbsp;<span class="string" id="6700765">&#34;&nbsp;&#34;</span><span class="op" id="6700768">}</span><span class="op" id="6700769">,</span><br>
<span class="lineno">45</span><span class="op" id="6700771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6700774">//&nbsp;Test&nbsp;using&nbsp;Println(&#34;hello&#34;,&nbsp;23,&nbsp;&#34;world&#34;)&nbsp;or&nbsp;using&nbsp;Printf(&#34;hello&nbsp;%d&nbsp;world&#34;,&nbsp;23)</span><br>
<span class="lineno"></span><span class="keyword" id="6700856">func</span>&nbsp;<span class="ident" id="6700861">testPrint</span><span class="op" id="6700870">(</span><span class="ident" id="6700871">t</span>&nbsp;<span class="op" id="6700873">*</span><span class="ident" id="6700874">testing</span><span class="op" id="6700881">.</span><span class="ident" id="6700882">T</span><span class="op" id="6700883">,</span>&nbsp;<span class="ident" id="6700885">flag</span>&nbsp;<span class="builtintype" id="6700890">int</span><span class="op" id="6700893">,</span>&nbsp;<span class="ident" id="6700895">prefix</span>&nbsp;<span class="builtintype" id="6700902">string</span><span class="op" id="6700908">,</span>&nbsp;<span class="ident" id="6700910">pattern</span>&nbsp;<span class="builtintype" id="6700918">string</span><span class="op" id="6700924">,</span>&nbsp;<span class="ident" id="6700926">useFormat</span>&nbsp;<span class="builtintype" id="6700936">bool</span><span class="op" id="6700940">)</span>&nbsp;<span class="op" id="6700942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6700945">buf</span>&nbsp;<span class="op" id="6700949">:=</span>&nbsp;<span class="builtinfunc" id="6700952">new</span><span class="op" id="6700955">(</span><span class="ident" id="6700956">bytes</span><span class="op" id="6700961">.</span><span class="ident" id="6700962">Buffer</span><span class="op" id="6700968">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6700971">SetOutput</span><span class="op" id="6700980">(</span><span class="ident" id="6700981">buf</span><span class="op" id="6700984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6700987">SetFlags</span><span class="op" id="6700995">(</span><span class="ident" id="6700996">flag</span><span class="op" id="6701000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6701003">SetPrefix</span><span class="op" id="6701012">(</span><span class="ident" id="6701013">prefix</span><span class="op" id="6701019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6701022">if</span>&nbsp;<span class="ident" id="6701025">useFormat</span>&nbsp;<span class="op" id="6701035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6701039">Printf</span><span class="op" id="6701045">(</span><span class="string" id="6701046">&#34;hello&nbsp;%d&nbsp;world&#34;</span><span class="op" id="6701062">,</span>&nbsp;<span class="num" id="6701064">23</span><span class="op" id="6701066">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6701069">}</span>&nbsp;<span class="keyword" id="6701071">else</span>&nbsp;<span class="op" id="6701076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6701080">Println</span><span class="op" id="6701087">(</span><span class="string" id="6701088">&#34;hello&#34;</span><span class="op" id="6701095">,</span>&nbsp;<span class="num" id="6701097">23</span><span class="op" id="6701099">,</span>&nbsp;<span class="string" id="6701101">&#34;world&#34;</span><span class="op" id="6701108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6701111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6701114">line</span>&nbsp;<span class="op" id="6701119">:=</span>&nbsp;<span class="ident" id="6701122">buf</span><span class="op" id="6701125">.</span><span class="ident" id="6701126">String</span><span class="op" id="6701132">(</span><span class="op" id="6701133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6701136">line</span>&nbsp;<span class="op" id="6701141">=</span>&nbsp;<span class="ident" id="6701143">line</span><span class="op" id="6701147">[</span><span class="num" id="6701148">0</span>&nbsp;<span class="op" id="6701150">:</span>&nbsp;<span class="builtinfunc" id="6701152">len</span><span class="op" id="6701155">(</span><span class="ident" id="6701156">line</span><span class="op" id="6701160">)</span><span class="op" id="6701161">-</span><span class="num" id="6701162">1</span><span class="op" id="6701163">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6701166">pattern</span>&nbsp;<span class="op" id="6701174">=</span>&nbsp;<span class="string" id="6701176">&#34;^&#34;</span>&nbsp;<span class="op" id="6701180">+</span>&nbsp;<span class="ident" id="6701182">pattern</span>&nbsp;<span class="op" id="6701190">+</span>&nbsp;<span class="string" id="6701192">&#34;hello&nbsp;23&nbsp;world$&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6701211">matched</span><span class="op" id="6701218">,</span>&nbsp;<span class="ident" id="6701220">err4</span>&nbsp;<span class="op" id="6701225">:=</span>&nbsp;<span class="ident" id="6701228">regexp</span><span class="op" id="6701234">.</span><span class="ident" id="6701235">MatchString</span><span class="op" id="6701246">(</span><span class="ident" id="6701247">pattern</span><span class="op" id="6701254">,</span>&nbsp;<span class="ident" id="6701256">line</span><span class="op" id="6701260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6701263">if</span>&nbsp;<span class="ident" id="6701266">err4</span>&nbsp;<span class="op" id="6701271">!=</span>&nbsp;<span class="ident" id="6701274">nil</span>&nbsp;<span class="op" id="6701278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6701282">t</span><span class="op" id="6701283">.</span><span class="ident" id="6701284">Fatal</span><span class="op" id="6701289">(</span><span class="string" id="6701290">&#34;pattern&nbsp;did&nbsp;not&nbsp;compile:&#34;</span><span class="op" id="6701316">,</span>&nbsp;<span class="ident" id="6701318">err4</span><span class="op" id="6701322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6701325">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6701328">if</span>&nbsp;<span class="op" id="6701331">!</span><span class="ident" id="6701332">matched</span>&nbsp;<span class="op" id="6701340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6701344">t</span><span class="op" id="6701345">.</span><span class="ident" id="6701346">Errorf</span><span class="op" id="6701352">(</span><span class="string" id="6701353">&#34;log&nbsp;output&nbsp;should&nbsp;match&nbsp;%q&nbsp;is&nbsp;%q&#34;</span><span class="op" id="6701387">,</span>&nbsp;<span class="ident" id="6701389">pattern</span><span class="op" id="6701396">,</span>&nbsp;<span class="ident" id="6701398">line</span><span class="op" id="6701402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6701405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6701408">SetOutput</span><span class="op" id="6701417">(</span><span class="ident" id="6701418">os</span><span class="op" id="6701420">.</span><span class="ident" id="6701421">Stderr</span><span class="op" id="6701427">)</span><br>
<span class="lineno"></span><span class="op" id="6701429">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="6701432">func</span>&nbsp;<span class="ident" id="6701437">TestAll</span><span class="op" id="6701444">(</span><span class="ident" id="6701445">t</span>&nbsp;<span class="op" id="6701447">*</span><span class="ident" id="6701448">testing</span><span class="op" id="6701455">.</span><span class="ident" id="6701456">T</span><span class="op" id="6701457">)</span>&nbsp;<span class="op" id="6701459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6701462">for</span>&nbsp;<span class="ident" id="6701466">_</span><span class="op" id="6701467">,</span>&nbsp;<span class="ident" id="6701469">testcase</span>&nbsp;<span class="op" id="6701478">:=</span>&nbsp;<span class="keyword" id="6701481">range</span>&nbsp;<span class="ident" id="6701487">tests</span>&nbsp;<span class="op" id="6701493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6701497">testPrint</span><span class="op" id="6701506">(</span><span class="ident" id="6701507">t</span><span class="op" id="6701508">,</span>&nbsp;<span class="ident" id="6701510">testcase</span><span class="op" id="6701518">.</span><span class="ident" id="6701519">flag</span><span class="op" id="6701523">,</span>&nbsp;<span class="ident" id="6701525">testcase</span><span class="op" id="6701533">.</span><span class="ident" id="6701534">prefix</span><span class="op" id="6701540">,</span>&nbsp;<span class="ident" id="6701542">testcase</span><span class="op" id="6701550">.</span><span class="ident" id="6701551">pattern</span><span class="op" id="6701558">,</span>&nbsp;<span class="builtintype" id="6701560">false</span><span class="op" id="6701565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6701569">testPrint</span><span class="op" id="6701578">(</span><span class="ident" id="6701579">t</span><span class="op" id="6701580">,</span>&nbsp;<span class="ident" id="6701582">testcase</span><span class="op" id="6701590">.</span><span class="ident" id="6701591">flag</span><span class="op" id="6701595">,</span>&nbsp;<span class="ident" id="6701597">testcase</span><span class="op" id="6701605">.</span><span class="ident" id="6701606">prefix</span><span class="op" id="6701612">,</span>&nbsp;<span class="ident" id="6701614">testcase</span><span class="op" id="6701622">.</span><span class="ident" id="6701623">pattern</span><span class="op" id="6701630">,</span>&nbsp;<span class="builtintype" id="6701632">true</span><span class="op" id="6701636">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6701639">}</span><br>
<span class="lineno"></span><span class="op" id="6701641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6701644">func</span>&nbsp;<span class="ident" id="6701649">TestOutput</span><span class="op" id="6701659">(</span><span class="ident" id="6701660">t</span>&nbsp;<span class="op" id="6701662">*</span><span class="ident" id="6701663">testing</span><span class="op" id="6701670">.</span><span class="ident" id="6701671">T</span><span class="op" id="6701672">)</span>&nbsp;<span class="op" id="6701674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6701677">const</span>&nbsp;<span class="ident" id="6701683">testString</span>&nbsp;<span class="op" id="6701694">=</span>&nbsp;<span class="string" id="6701696">&#34;test&#34;</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6701704">var</span>&nbsp;<span class="ident" id="6701708">b</span>&nbsp;<span class="ident" id="6701710">bytes</span><span class="op" id="6701715">.</span><span class="ident" id="6701716">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6701724">l</span>&nbsp;<span class="op" id="6701726">:=</span>&nbsp;<span class="ident" id="6701729">New</span><span class="op" id="6701732">(</span><span class="op" id="6701733">&amp;</span><span class="ident" id="6701734">b</span><span class="op" id="6701735">,</span>&nbsp;<span class="string" id="6701737">&#34;&#34;</span><span class="op" id="6701739">,</span>&nbsp;<span class="num" id="6701741">0</span><span class="op" id="6701742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6701745">l</span><span class="op" id="6701746">.</span><span class="ident" id="6701747">Println</span><span class="op" id="6701754">(</span><span class="ident" id="6701755">testString</span><span class="op" id="6701765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6701768">if</span>&nbsp;<span class="ident" id="6701771">expect</span>&nbsp;<span class="op" id="6701778">:=</span>&nbsp;<span class="ident" id="6701781">testString</span>&nbsp;<span class="op" id="6701792">+</span>&nbsp;<span class="string" id="6701794">&#34;\n&#34;</span><span class="op" id="6701798">;</span>&nbsp;<span class="ident" id="6701800">b</span><span class="op" id="6701801">.</span><span class="ident" id="6701802">String</span><span class="op" id="6701808">(</span><span class="op" id="6701809">)</span>&nbsp;<span class="op" id="6701811">!=</span>&nbsp;<span class="ident" id="6701814">expect</span>&nbsp;<span class="op" id="6701821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6701825">t</span><span class="op" id="6701826">.</span><span class="ident" id="6701827">Errorf</span><span class="op" id="6701833">(</span><span class="string" id="6701834">&#34;log&nbsp;output&nbsp;should&nbsp;match&nbsp;%q&nbsp;is&nbsp;%q&#34;</span><span class="op" id="6701868">,</span>&nbsp;<span class="ident" id="6701870">expect</span><span class="op" id="6701876">,</span>&nbsp;<span class="ident" id="6701878">b</span><span class="op" id="6701879">.</span><span class="ident" id="6701880">String</span><span class="op" id="6701886">(</span><span class="op" id="6701887">)</span><span class="op" id="6701888">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6701891">}</span><br>
<span class="lineno"></span><span class="op" id="6701893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6701896">func</span>&nbsp;<span class="ident" id="6701901">TestFlagAndPrefixSetting</span><span class="op" id="6701925">(</span><span class="ident" id="6701926">t</span>&nbsp;<span class="op" id="6701928">*</span><span class="ident" id="6701929">testing</span><span class="op" id="6701936">.</span><span class="ident" id="6701937">T</span><span class="op" id="6701938">)</span>&nbsp;<span class="op" id="6701940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6701943">var</span>&nbsp;<span class="ident" id="6701947">b</span>&nbsp;<span class="ident" id="6701949">bytes</span><span class="op" id="6701954">.</span><span class="ident" id="6701955">Buffer</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6701963">l</span>&nbsp;<span class="op" id="6701965">:=</span>&nbsp;<span class="ident" id="6701968">New</span><span class="op" id="6701971">(</span><span class="op" id="6701972">&amp;</span><span class="ident" id="6701973">b</span><span class="op" id="6701974">,</span>&nbsp;<span class="string" id="6701976">&#34;Test:&#34;</span><span class="op" id="6701983">,</span>&nbsp;<span class="ident" id="6701985">LstdFlags</span><span class="op" id="6701994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6701997">f</span>&nbsp;<span class="op" id="6701999">:=</span>&nbsp;<span class="ident" id="6702002">l</span><span class="op" id="6702003">.</span><span class="ident" id="6702004">Flags</span><span class="op" id="6702009">(</span><span class="op" id="6702010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6702013">if</span>&nbsp;<span class="ident" id="6702016">f</span>&nbsp;<span class="op" id="6702018">!=</span>&nbsp;<span class="ident" id="6702021">LstdFlags</span>&nbsp;<span class="op" id="6702031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702035">t</span><span class="op" id="6702036">.</span><span class="ident" id="6702037">Errorf</span><span class="op" id="6702043">(</span><span class="string" id="6702044">&#34;Flags&nbsp;1:&nbsp;expected&nbsp;%x&nbsp;got&nbsp;%x&#34;</span><span class="op" id="6702073">,</span>&nbsp;<span class="ident" id="6702075">LstdFlags</span><span class="op" id="6702084">,</span>&nbsp;<span class="ident" id="6702086">f</span><span class="op" id="6702087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6702090">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702093">l</span><span class="op" id="6702094">.</span><span class="ident" id="6702095">SetFlags</span><span class="op" id="6702103">(</span><span class="ident" id="6702104">f</span>&nbsp;<span class="op" id="6702106">|</span>&nbsp;<span class="ident" id="6702108">Lmicroseconds</span><span class="op" id="6702121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702124">f</span>&nbsp;<span class="op" id="6702126">=</span>&nbsp;<span class="ident" id="6702128">l</span><span class="op" id="6702129">.</span><span class="ident" id="6702130">Flags</span><span class="op" id="6702135">(</span><span class="op" id="6702136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6702139">if</span>&nbsp;<span class="ident" id="6702142">f</span>&nbsp;<span class="op" id="6702144">!=</span>&nbsp;<span class="ident" id="6702147">LstdFlags</span><span class="op" id="6702156">|</span><span class="ident" id="6702157">Lmicroseconds</span>&nbsp;<span class="op" id="6702171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702175">t</span><span class="op" id="6702176">.</span><span class="ident" id="6702177">Errorf</span><span class="op" id="6702183">(</span><span class="string" id="6702184">&#34;Flags&nbsp;2:&nbsp;expected&nbsp;%x&nbsp;got&nbsp;%x&#34;</span><span class="op" id="6702213">,</span>&nbsp;<span class="ident" id="6702215">LstdFlags</span><span class="op" id="6702224">|</span><span class="ident" id="6702225">Lmicroseconds</span><span class="op" id="6702238">,</span>&nbsp;<span class="ident" id="6702240">f</span><span class="op" id="6702241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6702244">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702247">p</span>&nbsp;<span class="op" id="6702249">:=</span>&nbsp;<span class="ident" id="6702252">l</span><span class="op" id="6702253">.</span><span class="ident" id="6702254">Prefix</span><span class="op" id="6702260">(</span><span class="op" id="6702261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6702264">if</span>&nbsp;<span class="ident" id="6702267">p</span>&nbsp;<span class="op" id="6702269">!=</span>&nbsp;<span class="string" id="6702272">&#34;Test:&#34;</span>&nbsp;<span class="op" id="6702280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702284">t</span><span class="op" id="6702285">.</span><span class="ident" id="6702286">Errorf</span><span class="op" id="6702292">(</span><span class="string" id="6702293">`Prefix:&nbsp;expected&nbsp;&#34;Test:&#34;&nbsp;got&nbsp;%q`</span><span class="op" id="6702326">,</span>&nbsp;<span class="ident" id="6702328">p</span><span class="op" id="6702329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6702332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702335">l</span><span class="op" id="6702336">.</span><span class="ident" id="6702337">SetPrefix</span><span class="op" id="6702346">(</span><span class="string" id="6702347">&#34;Reality:&#34;</span><span class="op" id="6702357">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702360">p</span>&nbsp;<span class="op" id="6702362">=</span>&nbsp;<span class="ident" id="6702364">l</span><span class="op" id="6702365">.</span><span class="ident" id="6702366">Prefix</span><span class="op" id="6702372">(</span><span class="op" id="6702373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6702376">if</span>&nbsp;<span class="ident" id="6702379">p</span>&nbsp;<span class="op" id="6702381">!=</span>&nbsp;<span class="string" id="6702384">&#34;Reality:&#34;</span>&nbsp;<span class="op" id="6702395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702399">t</span><span class="op" id="6702400">.</span><span class="ident" id="6702401">Errorf</span><span class="op" id="6702407">(</span><span class="string" id="6702408">`Prefix:&nbsp;expected&nbsp;&#34;Reality:&#34;&nbsp;got&nbsp;%q`</span><span class="op" id="6702444">,</span>&nbsp;<span class="ident" id="6702446">p</span><span class="op" id="6702447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6702450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6702453">//&nbsp;Verify&nbsp;a&nbsp;log&nbsp;message&nbsp;looks&nbsp;right,&nbsp;with&nbsp;our&nbsp;prefix&nbsp;and&nbsp;microseconds&nbsp;present.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702533">l</span><span class="op" id="6702534">.</span><span class="ident" id="6702535">Print</span><span class="op" id="6702540">(</span><span class="string" id="6702541">&#34;hello&#34;</span><span class="op" id="6702548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702551">pattern</span>&nbsp;<span class="op" id="6702559">:=</span>&nbsp;<span class="string" id="6702562">&#34;^Reality:&#34;</span>&nbsp;<span class="op" id="6702574">+</span>&nbsp;<span class="ident" id="6702576">Rdate</span>&nbsp;<span class="op" id="6702582">+</span>&nbsp;<span class="string" id="6702584">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="6702588">+</span>&nbsp;<span class="ident" id="6702590">Rtime</span>&nbsp;<span class="op" id="6702596">+</span>&nbsp;<span class="ident" id="6702598">Rmicroseconds</span>&nbsp;<span class="op" id="6702612">+</span>&nbsp;<span class="string" id="6702614">&#34;&nbsp;hello\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702626">matched</span><span class="op" id="6702633">,</span>&nbsp;<span class="ident" id="6702635">err</span>&nbsp;<span class="op" id="6702639">:=</span>&nbsp;<span class="ident" id="6702642">regexp</span><span class="op" id="6702648">.</span><span class="ident" id="6702649">Match</span><span class="op" id="6702654">(</span><span class="ident" id="6702655">pattern</span><span class="op" id="6702662">,</span>&nbsp;<span class="ident" id="6702664">b</span><span class="op" id="6702665">.</span><span class="ident" id="6702666">Bytes</span><span class="op" id="6702671">(</span><span class="op" id="6702672">)</span><span class="op" id="6702673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6702676">if</span>&nbsp;<span class="ident" id="6702679">err</span>&nbsp;<span class="op" id="6702683">!=</span>&nbsp;<span class="ident" id="6702686">nil</span>&nbsp;<span class="op" id="6702690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702694">t</span><span class="op" id="6702695">.</span><span class="ident" id="6702696">Fatalf</span><span class="op" id="6702702">(</span><span class="string" id="6702703">&#34;pattern&nbsp;%q&nbsp;did&nbsp;not&nbsp;compile:&nbsp;%s&#34;</span><span class="op" id="6702735">,</span>&nbsp;<span class="ident" id="6702737">pattern</span><span class="op" id="6702744">,</span>&nbsp;<span class="ident" id="6702746">err</span><span class="op" id="6702749">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6702752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6702755">if</span>&nbsp;<span class="op" id="6702758">!</span><span class="ident" id="6702759">matched</span>&nbsp;<span class="op" id="6702767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702771">t</span><span class="op" id="6702772">.</span><span class="ident" id="6702773">Error</span><span class="op" id="6702778">(</span><span class="string" id="6702779">&#34;message&nbsp;did&nbsp;not&nbsp;match&nbsp;pattern&#34;</span><span class="op" id="6702810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6702813">}</span><br>
<span class="lineno"></span><span class="op" id="6702815">}</span>
</div>
</body>
</html>
