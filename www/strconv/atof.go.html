<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2102744">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2102799">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2102853">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2102904">//&nbsp;Package&nbsp;strconv&nbsp;implements&nbsp;conversions&nbsp;to&nbsp;and&nbsp;from&nbsp;string&nbsp;representations</span><br>
<span class="lineno"></span><span class="comment" id="2102981">//&nbsp;of&nbsp;basic&nbsp;data&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="2103005">package</span>&nbsp;<span class="ident" id="2103013">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2103022">//&nbsp;decimal&nbsp;to&nbsp;binary&nbsp;floating&nbsp;point&nbsp;conversion.</span><br>
<span class="lineno">10</span><span class="comment" id="2103070">//&nbsp;Algorithm:</span><br>
<span class="lineno"></span><span class="comment" id="2103084">//&nbsp;&nbsp;&nbsp;1)&nbsp;Store&nbsp;input&nbsp;in&nbsp;multiprecision&nbsp;decimal.</span><br>
<span class="lineno"></span><span class="comment" id="2103131">//&nbsp;&nbsp;&nbsp;2)&nbsp;Multiply/divide&nbsp;decimal&nbsp;by&nbsp;powers&nbsp;of&nbsp;two&nbsp;until&nbsp;in&nbsp;range&nbsp;[0.5,&nbsp;1)</span><br>
<span class="lineno"></span><span class="comment" id="2103204">//&nbsp;&nbsp;&nbsp;3)&nbsp;Multiply&nbsp;by&nbsp;2^precision&nbsp;and&nbsp;round&nbsp;to&nbsp;get&nbsp;mantissa.</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="2103264">import</span>&nbsp;<span class="string" id="2103271">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2103279">var</span>&nbsp;<span class="ident" id="2103283">optimize</span>&nbsp;<span class="op" id="2103292">=</span>&nbsp;<span class="ident" id="2103294">true</span>&nbsp;<span class="comment" id="2103299">//&nbsp;can&nbsp;change&nbsp;for&nbsp;testing</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2103326">func</span>&nbsp;<span class="ident" id="2103331">equalIgnoreCase</span><span class="op" id="2103346">(</span><span class="ident" id="2103347">s1</span><span class="op" id="2103349">,</span>&nbsp;<span class="ident" id="2103351">s2</span>&nbsp;<span class="builtintype" id="2103354">string</span><span class="op" id="2103360">)</span>&nbsp;<span class="builtintype" id="2103362">bool</span>&nbsp;<span class="op" id="2103367">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2103370">if</span>&nbsp;<span class="builtinfunc" id="2103373">len</span><span class="op" id="2103376">(</span><span class="ident" id="2103377">s1</span><span class="op" id="2103379">)</span>&nbsp;<span class="op" id="2103381">!=</span>&nbsp;<span class="builtinfunc" id="2103384">len</span><span class="op" id="2103387">(</span><span class="ident" id="2103388">s2</span><span class="op" id="2103390">)</span>&nbsp;<span class="op" id="2103392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2103396">return</span>&nbsp;<span class="ident" id="2103403">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2103410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2103413">for</span>&nbsp;<span class="ident" id="2103417">i</span>&nbsp;<span class="op" id="2103419">:=</span>&nbsp;<span class="num" id="2103422">0</span><span class="op" id="2103423">;</span>&nbsp;<span class="ident" id="2103425">i</span>&nbsp;<span class="op" id="2103427">&lt;</span>&nbsp;<span class="builtinfunc" id="2103429">len</span><span class="op" id="2103432">(</span><span class="ident" id="2103433">s1</span><span class="op" id="2103435">)</span><span class="op" id="2103436">;</span>&nbsp;<span class="ident" id="2103438">i</span><span class="op" id="2103439">++</span>&nbsp;<span class="op" id="2103442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2103446">c1</span>&nbsp;<span class="op" id="2103449">:=</span>&nbsp;<span class="ident" id="2103452">s1</span><span class="op" id="2103454">[</span><span class="ident" id="2103455">i</span><span class="op" id="2103456">]</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2103460">if</span>&nbsp;<span class="string" id="2103463">&#39;A&#39;</span>&nbsp;<span class="op" id="2103467">&lt;=</span>&nbsp;<span class="ident" id="2103470">c1</span>&nbsp;<span class="op" id="2103473">&amp;&amp;</span>&nbsp;<span class="ident" id="2103476">c1</span>&nbsp;<span class="op" id="2103479">&lt;=</span>&nbsp;<span class="string" id="2103482">&#39;Z&#39;</span>&nbsp;<span class="op" id="2103486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2103491">c1</span>&nbsp;<span class="op" id="2103494">+=</span>&nbsp;<span class="string" id="2103497">&#39;a&#39;</span>&nbsp;<span class="op" id="2103501">-</span>&nbsp;<span class="string" id="2103503">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2103509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2103513">c2</span>&nbsp;<span class="op" id="2103516">:=</span>&nbsp;<span class="ident" id="2103519">s2</span><span class="op" id="2103521">[</span><span class="ident" id="2103522">i</span><span class="op" id="2103523">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2103527">if</span>&nbsp;<span class="string" id="2103530">&#39;A&#39;</span>&nbsp;<span class="op" id="2103534">&lt;=</span>&nbsp;<span class="ident" id="2103537">c2</span>&nbsp;<span class="op" id="2103540">&amp;&amp;</span>&nbsp;<span class="ident" id="2103543">c2</span>&nbsp;<span class="op" id="2103546">&lt;=</span>&nbsp;<span class="string" id="2103549">&#39;Z&#39;</span>&nbsp;<span class="op" id="2103553">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2103558">c2</span>&nbsp;<span class="op" id="2103561">+=</span>&nbsp;<span class="string" id="2103564">&#39;a&#39;</span>&nbsp;<span class="op" id="2103568">-</span>&nbsp;<span class="string" id="2103570">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2103576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2103580">if</span>&nbsp;<span class="ident" id="2103583">c1</span>&nbsp;<span class="op" id="2103586">!=</span>&nbsp;<span class="ident" id="2103589">c2</span>&nbsp;<span class="op" id="2103592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2103597">return</span>&nbsp;<span class="ident" id="2103604">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2103612">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2103615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2103618">return</span>&nbsp;<span class="ident" id="2103625">true</span><br>
<span class="lineno"></span><span class="op" id="2103630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2103633">func</span>&nbsp;<span class="ident" id="2103638">special</span><span class="op" id="2103645">(</span><span class="ident" id="2103646">s</span>&nbsp;<span class="builtintype" id="2103648">string</span><span class="op" id="2103654">)</span>&nbsp;<span class="op" id="2103656">(</span><span class="ident" id="2103657">f</span>&nbsp;<span class="builtintype" id="2103659">float64</span><span class="op" id="2103666">,</span>&nbsp;<span class="ident" id="2103668">ok</span>&nbsp;<span class="builtintype" id="2103671">bool</span><span class="op" id="2103675">)</span>&nbsp;<span class="op" id="2103677">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2103680">if</span>&nbsp;<span class="builtinfunc" id="2103683">len</span><span class="op" id="2103686">(</span><span class="ident" id="2103687">s</span><span class="op" id="2103688">)</span>&nbsp;<span class="op" id="2103690">==</span>&nbsp;<span class="num" id="2103693">0</span>&nbsp;<span class="op" id="2103695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2103699">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2103707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2103710">switch</span>&nbsp;<span class="ident" id="2103717">s</span><span class="op" id="2103718">[</span><span class="num" id="2103719">0</span><span class="op" id="2103720">]</span>&nbsp;<span class="op" id="2103722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2103725">default</span><span class="op" id="2103732">:</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2103736">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2103744">case</span>&nbsp;<span class="string" id="2103749">&#39;+&#39;</span><span class="op" id="2103752">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2103756">if</span>&nbsp;<span class="ident" id="2103759">equalIgnoreCase</span><span class="op" id="2103774">(</span><span class="ident" id="2103775">s</span><span class="op" id="2103776">,</span>&nbsp;<span class="string" id="2103778">&#34;+inf&#34;</span><span class="op" id="2103784">)</span>&nbsp;<span class="op" id="2103786">||</span>&nbsp;<span class="ident" id="2103789">equalIgnoreCase</span><span class="op" id="2103804">(</span><span class="ident" id="2103805">s</span><span class="op" id="2103806">,</span>&nbsp;<span class="string" id="2103808">&#34;+infinity&#34;</span><span class="op" id="2103819">)</span>&nbsp;<span class="op" id="2103821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2103826">return</span>&nbsp;<span class="ident" id="2103833">math</span><span class="op" id="2103837">.</span><span class="ident" id="2103838">Inf</span><span class="op" id="2103841">(</span><span class="num" id="2103842">1</span><span class="op" id="2103843">)</span><span class="op" id="2103844">,</span>&nbsp;<span class="ident" id="2103846">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2103853">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2103856">case</span>&nbsp;<span class="string" id="2103861">&#39;-&#39;</span><span class="op" id="2103864">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2103868">if</span>&nbsp;<span class="ident" id="2103871">equalIgnoreCase</span><span class="op" id="2103886">(</span><span class="ident" id="2103887">s</span><span class="op" id="2103888">,</span>&nbsp;<span class="string" id="2103890">&#34;-inf&#34;</span><span class="op" id="2103896">)</span>&nbsp;<span class="op" id="2103898">||</span>&nbsp;<span class="ident" id="2103901">equalIgnoreCase</span><span class="op" id="2103916">(</span><span class="ident" id="2103917">s</span><span class="op" id="2103918">,</span>&nbsp;<span class="string" id="2103920">&#34;-infinity&#34;</span><span class="op" id="2103931">)</span>&nbsp;<span class="op" id="2103933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2103938">return</span>&nbsp;<span class="ident" id="2103945">math</span><span class="op" id="2103949">.</span><span class="ident" id="2103950">Inf</span><span class="op" id="2103953">(</span><span class="op" id="2103954">-</span><span class="num" id="2103955">1</span><span class="op" id="2103956">)</span><span class="op" id="2103957">,</span>&nbsp;<span class="ident" id="2103959">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2103966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2103969">case</span>&nbsp;<span class="string" id="2103974">&#39;n&#39;</span><span class="op" id="2103977">,</span>&nbsp;<span class="string" id="2103979">&#39;N&#39;</span><span class="op" id="2103982">:</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2103986">if</span>&nbsp;<span class="ident" id="2103989">equalIgnoreCase</span><span class="op" id="2104004">(</span><span class="ident" id="2104005">s</span><span class="op" id="2104006">,</span>&nbsp;<span class="string" id="2104008">&#34;nan&#34;</span><span class="op" id="2104013">)</span>&nbsp;<span class="op" id="2104015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2104020">return</span>&nbsp;<span class="ident" id="2104027">math</span><span class="op" id="2104031">.</span><span class="ident" id="2104032">NaN</span><span class="op" id="2104035">(</span><span class="op" id="2104036">)</span><span class="op" id="2104037">,</span>&nbsp;<span class="ident" id="2104039">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2104046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2104049">case</span>&nbsp;<span class="string" id="2104054">&#39;i&#39;</span><span class="op" id="2104057">,</span>&nbsp;<span class="string" id="2104059">&#39;I&#39;</span><span class="op" id="2104062">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2104066">if</span>&nbsp;<span class="ident" id="2104069">equalIgnoreCase</span><span class="op" id="2104084">(</span><span class="ident" id="2104085">s</span><span class="op" id="2104086">,</span>&nbsp;<span class="string" id="2104088">&#34;inf&#34;</span><span class="op" id="2104093">)</span>&nbsp;<span class="op" id="2104095">||</span>&nbsp;<span class="ident" id="2104098">equalIgnoreCase</span><span class="op" id="2104113">(</span><span class="ident" id="2104114">s</span><span class="op" id="2104115">,</span>&nbsp;<span class="string" id="2104117">&#34;infinity&#34;</span><span class="op" id="2104127">)</span>&nbsp;<span class="op" id="2104129">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2104134">return</span>&nbsp;<span class="ident" id="2104141">math</span><span class="op" id="2104145">.</span><span class="ident" id="2104146">Inf</span><span class="op" id="2104149">(</span><span class="num" id="2104150">1</span><span class="op" id="2104151">)</span><span class="op" id="2104152">,</span>&nbsp;<span class="ident" id="2104154">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2104161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2104164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2104167">return</span><br>
<span class="lineno"></span><span class="op" id="2104174">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="2104177">func</span>&nbsp;<span class="op" id="2104182">(</span><span class="ident" id="2104183">b</span>&nbsp;<span class="op" id="2104185">*</span><span class="ident" id="2104186">decimal</span><span class="op" id="2104193">)</span>&nbsp;<span class="ident" id="2104195">set</span><span class="op" id="2104198">(</span><span class="ident" id="2104199">s</span>&nbsp;<span class="builtintype" id="2104201">string</span><span class="op" id="2104207">)</span>&nbsp;<span class="op" id="2104209">(</span><span class="ident" id="2104210">ok</span>&nbsp;<span class="builtintype" id="2104213">bool</span><span class="op" id="2104217">)</span>&nbsp;<span class="op" id="2104219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2104222">i</span>&nbsp;<span class="op" id="2104224">:=</span>&nbsp;<span class="num" id="2104227">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2104230">b</span><span class="op" id="2104231">.</span><span class="ident" id="2104232">neg</span>&nbsp;<span class="op" id="2104236">=</span>&nbsp;<span class="ident" id="2104238">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2104245">b</span><span class="op" id="2104246">.</span><span class="ident" id="2104247">trunc</span>&nbsp;<span class="op" id="2104253">=</span>&nbsp;<span class="ident" id="2104255">false</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2104263">//&nbsp;optional&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2104281">if</span>&nbsp;<span class="ident" id="2104284">i</span>&nbsp;<span class="op" id="2104286">&gt;=</span>&nbsp;<span class="builtinfunc" id="2104289">len</span><span class="op" id="2104292">(</span><span class="ident" id="2104293">s</span><span class="op" id="2104294">)</span>&nbsp;<span class="op" id="2104296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2104300">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2104308">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2104311">switch</span>&nbsp;<span class="op" id="2104318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2104321">case</span>&nbsp;<span class="ident" id="2104326">s</span><span class="op" id="2104327">[</span><span class="ident" id="2104328">i</span><span class="op" id="2104329">]</span>&nbsp;<span class="op" id="2104331">==</span>&nbsp;<span class="string" id="2104334">&#39;+&#39;</span><span class="op" id="2104337">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2104341">i</span><span class="op" id="2104342">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2104346">case</span>&nbsp;<span class="ident" id="2104351">s</span><span class="op" id="2104352">[</span><span class="ident" id="2104353">i</span><span class="op" id="2104354">]</span>&nbsp;<span class="op" id="2104356">==</span>&nbsp;<span class="string" id="2104359">&#39;-&#39;</span><span class="op" id="2104362">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2104366">b</span><span class="op" id="2104367">.</span><span class="ident" id="2104368">neg</span>&nbsp;<span class="op" id="2104372">=</span>&nbsp;<span class="ident" id="2104374">true</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2104381">i</span><span class="op" id="2104382">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2104386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2104390">//&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2104401">sawdot</span>&nbsp;<span class="op" id="2104408">:=</span>&nbsp;<span class="ident" id="2104411">false</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2104418">sawdigits</span>&nbsp;<span class="op" id="2104428">:=</span>&nbsp;<span class="ident" id="2104431">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2104438">for</span>&nbsp;<span class="op" id="2104442">;</span>&nbsp;<span class="ident" id="2104444">i</span>&nbsp;<span class="op" id="2104446">&lt;</span>&nbsp;<span class="builtinfunc" id="2104448">len</span><span class="op" id="2104451">(</span><span class="ident" id="2104452">s</span><span class="op" id="2104453">)</span><span class="op" id="2104454">;</span>&nbsp;<span class="ident" id="2104456">i</span><span class="op" id="2104457">++</span>&nbsp;<span class="op" id="2104460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2104464">switch</span>&nbsp;<span class="op" id="2104471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2104475">case</span>&nbsp;<span class="ident" id="2104480">s</span><span class="op" id="2104481">[</span><span class="ident" id="2104482">i</span><span class="op" id="2104483">]</span>&nbsp;<span class="op" id="2104485">==</span>&nbsp;<span class="string" id="2104488">&#39;.&#39;</span><span class="op" id="2104491">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2104496">if</span>&nbsp;<span class="ident" id="2104499">sawdot</span>&nbsp;<span class="op" id="2104506">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2104512">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2104522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2104527">sawdot</span>&nbsp;<span class="op" id="2104534">=</span>&nbsp;<span class="ident" id="2104536">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2104544">b</span><span class="op" id="2104545">.</span><span class="ident" id="2104546">dp</span>&nbsp;<span class="op" id="2104549">=</span>&nbsp;<span class="ident" id="2104551">b</span><span class="op" id="2104552">.</span><span class="ident" id="2104553">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2104559">continue</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2104571">case</span>&nbsp;<span class="string" id="2104576">&#39;0&#39;</span>&nbsp;<span class="op" id="2104580">&lt;=</span>&nbsp;<span class="ident" id="2104583">s</span><span class="op" id="2104584">[</span><span class="ident" id="2104585">i</span><span class="op" id="2104586">]</span>&nbsp;<span class="op" id="2104588">&amp;&amp;</span>&nbsp;<span class="ident" id="2104591">s</span><span class="op" id="2104592">[</span><span class="ident" id="2104593">i</span><span class="op" id="2104594">]</span>&nbsp;<span class="op" id="2104596">&lt;=</span>&nbsp;<span class="string" id="2104599">&#39;9&#39;</span><span class="op" id="2104602">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2104607">sawdigits</span>&nbsp;<span class="op" id="2104617">=</span>&nbsp;<span class="ident" id="2104619">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2104627">if</span>&nbsp;<span class="ident" id="2104630">s</span><span class="op" id="2104631">[</span><span class="ident" id="2104632">i</span><span class="op" id="2104633">]</span>&nbsp;<span class="op" id="2104635">==</span>&nbsp;<span class="string" id="2104638">&#39;0&#39;</span>&nbsp;<span class="op" id="2104642">&amp;&amp;</span>&nbsp;<span class="ident" id="2104645">b</span><span class="op" id="2104646">.</span><span class="ident" id="2104647">nd</span>&nbsp;<span class="op" id="2104650">==</span>&nbsp;<span class="num" id="2104653">0</span>&nbsp;<span class="op" id="2104655">{</span>&nbsp;<span class="comment" id="2104657">//&nbsp;ignore&nbsp;leading&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2104685">b</span><span class="op" id="2104686">.</span><span class="ident" id="2104687">dp</span><span class="op" id="2104689">--</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2104696">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2104708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2104713">if</span>&nbsp;<span class="ident" id="2104716">b</span><span class="op" id="2104717">.</span><span class="ident" id="2104718">nd</span>&nbsp;<span class="op" id="2104721">&lt;</span>&nbsp;<span class="builtinfunc" id="2104723">len</span><span class="op" id="2104726">(</span><span class="ident" id="2104727">b</span><span class="op" id="2104728">.</span><span class="ident" id="2104729">d</span><span class="op" id="2104730">)</span>&nbsp;<span class="op" id="2104732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2104738">b</span><span class="op" id="2104739">.</span><span class="ident" id="2104740">d</span><span class="op" id="2104741">[</span><span class="ident" id="2104742">b</span><span class="op" id="2104743">.</span><span class="ident" id="2104744">nd</span><span class="op" id="2104746">]</span>&nbsp;<span class="op" id="2104748">=</span>&nbsp;<span class="ident" id="2104750">s</span><span class="op" id="2104751">[</span><span class="ident" id="2104752">i</span><span class="op" id="2104753">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2104759">b</span><span class="op" id="2104760">.</span><span class="ident" id="2104761">nd</span><span class="op" id="2104763">++</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2104769">}</span>&nbsp;<span class="keyword" id="2104771">else</span>&nbsp;<span class="keyword" id="2104776">if</span>&nbsp;<span class="ident" id="2104779">s</span><span class="op" id="2104780">[</span><span class="ident" id="2104781">i</span><span class="op" id="2104782">]</span>&nbsp;<span class="op" id="2104784">!=</span>&nbsp;<span class="string" id="2104787">&#39;0&#39;</span>&nbsp;<span class="op" id="2104791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2104797">b</span><span class="op" id="2104798">.</span><span class="ident" id="2104799">trunc</span>&nbsp;<span class="op" id="2104805">=</span>&nbsp;<span class="ident" id="2104807">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2104815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2104820">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2104831">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2104835">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2104842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2104845">if</span>&nbsp;<span class="op" id="2104848">!</span><span class="ident" id="2104849">sawdigits</span>&nbsp;<span class="op" id="2104859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2104863">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2104871">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2104874">if</span>&nbsp;<span class="op" id="2104877">!</span><span class="ident" id="2104878">sawdot</span>&nbsp;<span class="op" id="2104885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2104889">b</span><span class="op" id="2104890">.</span><span class="ident" id="2104891">dp</span>&nbsp;<span class="op" id="2104894">=</span>&nbsp;<span class="ident" id="2104896">b</span><span class="op" id="2104897">.</span><span class="ident" id="2104898">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2104902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2104906">//&nbsp;optional&nbsp;exponent&nbsp;moves&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2104949">//&nbsp;if&nbsp;we&nbsp;read&nbsp;a&nbsp;very&nbsp;large,&nbsp;very&nbsp;long&nbsp;number,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2104996">//&nbsp;just&nbsp;be&nbsp;sure&nbsp;to&nbsp;move&nbsp;the&nbsp;decimal&nbsp;point&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2105042">//&nbsp;a&nbsp;lot&nbsp;(say,&nbsp;100000).&nbsp;&nbsp;it&nbsp;doesn&#39;t&nbsp;matter&nbsp;if&nbsp;it&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2105094">//&nbsp;not&nbsp;the&nbsp;exact&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2105120">if</span>&nbsp;<span class="ident" id="2105123">i</span>&nbsp;<span class="op" id="2105125">&lt;</span>&nbsp;<span class="builtinfunc" id="2105127">len</span><span class="op" id="2105130">(</span><span class="ident" id="2105131">s</span><span class="op" id="2105132">)</span>&nbsp;<span class="op" id="2105134">&amp;&amp;</span>&nbsp;<span class="op" id="2105137">(</span><span class="ident" id="2105138">s</span><span class="op" id="2105139">[</span><span class="ident" id="2105140">i</span><span class="op" id="2105141">]</span>&nbsp;<span class="op" id="2105143">==</span>&nbsp;<span class="string" id="2105146">&#39;e&#39;</span>&nbsp;<span class="op" id="2105150">||</span>&nbsp;<span class="ident" id="2105153">s</span><span class="op" id="2105154">[</span><span class="ident" id="2105155">i</span><span class="op" id="2105156">]</span>&nbsp;<span class="op" id="2105158">==</span>&nbsp;<span class="string" id="2105161">&#39;E&#39;</span><span class="op" id="2105164">)</span>&nbsp;<span class="op" id="2105166">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2105170">i</span><span class="op" id="2105171">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2105176">if</span>&nbsp;<span class="ident" id="2105179">i</span>&nbsp;<span class="op" id="2105181">&gt;=</span>&nbsp;<span class="builtinfunc" id="2105184">len</span><span class="op" id="2105187">(</span><span class="ident" id="2105188">s</span><span class="op" id="2105189">)</span>&nbsp;<span class="op" id="2105191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2105196">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2105205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2105209">esign</span>&nbsp;<span class="op" id="2105215">:=</span>&nbsp;<span class="num" id="2105218">1</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2105222">if</span>&nbsp;<span class="ident" id="2105225">s</span><span class="op" id="2105226">[</span><span class="ident" id="2105227">i</span><span class="op" id="2105228">]</span>&nbsp;<span class="op" id="2105230">==</span>&nbsp;<span class="string" id="2105233">&#39;+&#39;</span>&nbsp;<span class="op" id="2105237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2105242">i</span><span class="op" id="2105243">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2105248">}</span>&nbsp;<span class="keyword" id="2105250">else</span>&nbsp;<span class="keyword" id="2105255">if</span>&nbsp;<span class="ident" id="2105258">s</span><span class="op" id="2105259">[</span><span class="ident" id="2105260">i</span><span class="op" id="2105261">]</span>&nbsp;<span class="op" id="2105263">==</span>&nbsp;<span class="string" id="2105266">&#39;-&#39;</span>&nbsp;<span class="op" id="2105270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2105275">i</span><span class="op" id="2105276">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2105282">esign</span>&nbsp;<span class="op" id="2105288">=</span>&nbsp;<span class="op" id="2105290">-</span><span class="num" id="2105291">1</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2105295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2105299">if</span>&nbsp;<span class="ident" id="2105302">i</span>&nbsp;<span class="op" id="2105304">&gt;=</span>&nbsp;<span class="builtinfunc" id="2105307">len</span><span class="op" id="2105310">(</span><span class="ident" id="2105311">s</span><span class="op" id="2105312">)</span>&nbsp;<span class="op" id="2105314">||</span>&nbsp;<span class="ident" id="2105317">s</span><span class="op" id="2105318">[</span><span class="ident" id="2105319">i</span><span class="op" id="2105320">]</span>&nbsp;<span class="op" id="2105322">&lt;</span>&nbsp;<span class="string" id="2105324">&#39;0&#39;</span>&nbsp;<span class="op" id="2105328">||</span>&nbsp;<span class="ident" id="2105331">s</span><span class="op" id="2105332">[</span><span class="ident" id="2105333">i</span><span class="op" id="2105334">]</span>&nbsp;<span class="op" id="2105336">&gt;</span>&nbsp;<span class="string" id="2105338">&#39;9&#39;</span>&nbsp;<span class="op" id="2105342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2105347">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2105356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2105360">e</span>&nbsp;<span class="op" id="2105362">:=</span>&nbsp;<span class="num" id="2105365">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2105369">for</span>&nbsp;<span class="op" id="2105373">;</span>&nbsp;<span class="ident" id="2105375">i</span>&nbsp;<span class="op" id="2105377">&lt;</span>&nbsp;<span class="builtinfunc" id="2105379">len</span><span class="op" id="2105382">(</span><span class="ident" id="2105383">s</span><span class="op" id="2105384">)</span>&nbsp;<span class="op" id="2105386">&amp;&amp;</span>&nbsp;<span class="string" id="2105389">&#39;0&#39;</span>&nbsp;<span class="op" id="2105393">&lt;=</span>&nbsp;<span class="ident" id="2105396">s</span><span class="op" id="2105397">[</span><span class="ident" id="2105398">i</span><span class="op" id="2105399">]</span>&nbsp;<span class="op" id="2105401">&amp;&amp;</span>&nbsp;<span class="ident" id="2105404">s</span><span class="op" id="2105405">[</span><span class="ident" id="2105406">i</span><span class="op" id="2105407">]</span>&nbsp;<span class="op" id="2105409">&lt;=</span>&nbsp;<span class="string" id="2105412">&#39;9&#39;</span><span class="op" id="2105415">;</span>&nbsp;<span class="ident" id="2105417">i</span><span class="op" id="2105418">++</span>&nbsp;<span class="op" id="2105421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2105426">if</span>&nbsp;<span class="ident" id="2105429">e</span>&nbsp;<span class="op" id="2105431">&lt;</span>&nbsp;<span class="num" id="2105433">10000</span>&nbsp;<span class="op" id="2105439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2105445">e</span>&nbsp;<span class="op" id="2105447">=</span>&nbsp;<span class="ident" id="2105449">e</span><span class="op" id="2105450">*</span><span class="num" id="2105451">10</span>&nbsp;<span class="op" id="2105454">+</span>&nbsp;<span class="builtintype" id="2105456">int</span><span class="op" id="2105459">(</span><span class="ident" id="2105460">s</span><span class="op" id="2105461">[</span><span class="ident" id="2105462">i</span><span class="op" id="2105463">]</span><span class="op" id="2105464">)</span>&nbsp;<span class="op" id="2105466">-</span>&nbsp;<span class="string" id="2105468">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2105475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2105479">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2105483">b</span><span class="op" id="2105484">.</span><span class="ident" id="2105485">dp</span>&nbsp;<span class="op" id="2105488">+=</span>&nbsp;<span class="ident" id="2105491">e</span>&nbsp;<span class="op" id="2105493">*</span>&nbsp;<span class="ident" id="2105495">esign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2105502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2105506">if</span>&nbsp;<span class="ident" id="2105509">i</span>&nbsp;<span class="op" id="2105511">!=</span>&nbsp;<span class="builtinfunc" id="2105514">len</span><span class="op" id="2105517">(</span><span class="ident" id="2105518">s</span><span class="op" id="2105519">)</span>&nbsp;<span class="op" id="2105521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2105525">return</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2105533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2105537">ok</span>&nbsp;<span class="op" id="2105540">=</span>&nbsp;<span class="ident" id="2105542">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2105548">return</span><br>
<span class="lineno"></span><span class="op" id="2105555">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="2105558">//&nbsp;readFloat&nbsp;reads&nbsp;a&nbsp;decimal&nbsp;mantissa&nbsp;and&nbsp;exponent&nbsp;from&nbsp;a&nbsp;float</span><br>
<span class="lineno"></span><span class="comment" id="2105622">//&nbsp;string&nbsp;representation.&nbsp;It&nbsp;sets&nbsp;ok&nbsp;to&nbsp;false&nbsp;if&nbsp;the&nbsp;number&nbsp;could</span><br>
<span class="lineno"></span><span class="comment" id="2105688">//&nbsp;not&nbsp;fit&nbsp;return&nbsp;types&nbsp;or&nbsp;is&nbsp;invalid.</span><br>
<span class="lineno"></span><span class="keyword" id="2105727">func</span>&nbsp;<span class="ident" id="2105732">readFloat</span><span class="op" id="2105741">(</span><span class="ident" id="2105742">s</span>&nbsp;<span class="builtintype" id="2105744">string</span><span class="op" id="2105750">)</span>&nbsp;<span class="op" id="2105752">(</span><span class="ident" id="2105753">mantissa</span>&nbsp;<span class="ident" id="2105762">uint64</span><span class="op" id="2105768">,</span>&nbsp;<span class="ident" id="2105770">exp</span>&nbsp;<span class="builtintype" id="2105774">int</span><span class="op" id="2105777">,</span>&nbsp;<span class="ident" id="2105779">neg</span><span class="op" id="2105782">,</span>&nbsp;<span class="ident" id="2105784">trunc</span><span class="op" id="2105789">,</span>&nbsp;<span class="ident" id="2105791">ok</span>&nbsp;<span class="builtintype" id="2105794">bool</span><span class="op" id="2105798">)</span>&nbsp;<span class="op" id="2105800">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2105803">const</span>&nbsp;<span class="ident" id="2105809">uint64digits</span>&nbsp;<span class="op" id="2105822">=</span>&nbsp;<span class="num" id="2105824">19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2105828">i</span>&nbsp;<span class="op" id="2105830">:=</span>&nbsp;<span class="num" id="2105833">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2105837">//&nbsp;optional&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2105855">if</span>&nbsp;<span class="ident" id="2105858">i</span>&nbsp;<span class="op" id="2105860">&gt;=</span>&nbsp;<span class="builtinfunc" id="2105863">len</span><span class="op" id="2105866">(</span><span class="ident" id="2105867">s</span><span class="op" id="2105868">)</span>&nbsp;<span class="op" id="2105870">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2105874">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2105882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2105885">switch</span>&nbsp;<span class="op" id="2105892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2105895">case</span>&nbsp;<span class="ident" id="2105900">s</span><span class="op" id="2105901">[</span><span class="ident" id="2105902">i</span><span class="op" id="2105903">]</span>&nbsp;<span class="op" id="2105905">==</span>&nbsp;<span class="string" id="2105908">&#39;+&#39;</span><span class="op" id="2105911">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2105915">i</span><span class="op" id="2105916">++</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2105920">case</span>&nbsp;<span class="ident" id="2105925">s</span><span class="op" id="2105926">[</span><span class="ident" id="2105927">i</span><span class="op" id="2105928">]</span>&nbsp;<span class="op" id="2105930">==</span>&nbsp;<span class="string" id="2105933">&#39;-&#39;</span><span class="op" id="2105936">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2105940">neg</span>&nbsp;<span class="op" id="2105944">=</span>&nbsp;<span class="ident" id="2105946">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2105953">i</span><span class="op" id="2105954">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2105958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2105962">//&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2105973">sawdot</span>&nbsp;<span class="op" id="2105980">:=</span>&nbsp;<span class="ident" id="2105983">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2105990">sawdigits</span>&nbsp;<span class="op" id="2106000">:=</span>&nbsp;<span class="ident" id="2106003">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106010">nd</span>&nbsp;<span class="op" id="2106013">:=</span>&nbsp;<span class="num" id="2106016">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106019">ndMant</span>&nbsp;<span class="op" id="2106026">:=</span>&nbsp;<span class="num" id="2106029">0</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106032">dp</span>&nbsp;<span class="op" id="2106035">:=</span>&nbsp;<span class="num" id="2106038">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2106041">for</span>&nbsp;<span class="op" id="2106045">;</span>&nbsp;<span class="ident" id="2106047">i</span>&nbsp;<span class="op" id="2106049">&lt;</span>&nbsp;<span class="builtinfunc" id="2106051">len</span><span class="op" id="2106054">(</span><span class="ident" id="2106055">s</span><span class="op" id="2106056">)</span><span class="op" id="2106057">;</span>&nbsp;<span class="ident" id="2106059">i</span><span class="op" id="2106060">++</span>&nbsp;<span class="op" id="2106063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2106067">switch</span>&nbsp;<span class="ident" id="2106074">c</span>&nbsp;<span class="op" id="2106076">:=</span>&nbsp;<span class="ident" id="2106079">s</span><span class="op" id="2106080">[</span><span class="ident" id="2106081">i</span><span class="op" id="2106082">]</span><span class="op" id="2106083">;</span>&nbsp;<span class="ident" id="2106085">true</span>&nbsp;<span class="op" id="2106090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2106094">case</span>&nbsp;<span class="ident" id="2106099">c</span>&nbsp;<span class="op" id="2106101">==</span>&nbsp;<span class="string" id="2106104">&#39;.&#39;</span><span class="op" id="2106107">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2106112">if</span>&nbsp;<span class="ident" id="2106115">sawdot</span>&nbsp;<span class="op" id="2106122">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2106128">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2106138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106143">sawdot</span>&nbsp;<span class="op" id="2106150">=</span>&nbsp;<span class="ident" id="2106152">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106160">dp</span>&nbsp;<span class="op" id="2106163">=</span>&nbsp;<span class="ident" id="2106165">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2106171">continue</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2106183">case</span>&nbsp;<span class="string" id="2106188">&#39;0&#39;</span>&nbsp;<span class="op" id="2106192">&lt;=</span>&nbsp;<span class="ident" id="2106195">c</span>&nbsp;<span class="op" id="2106197">&amp;&amp;</span>&nbsp;<span class="ident" id="2106200">c</span>&nbsp;<span class="op" id="2106202">&lt;=</span>&nbsp;<span class="string" id="2106205">&#39;9&#39;</span><span class="op" id="2106208">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106213">sawdigits</span>&nbsp;<span class="op" id="2106223">=</span>&nbsp;<span class="ident" id="2106225">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2106233">if</span>&nbsp;<span class="ident" id="2106236">c</span>&nbsp;<span class="op" id="2106238">==</span>&nbsp;<span class="string" id="2106241">&#39;0&#39;</span>&nbsp;<span class="op" id="2106245">&amp;&amp;</span>&nbsp;<span class="ident" id="2106248">nd</span>&nbsp;<span class="op" id="2106251">==</span>&nbsp;<span class="num" id="2106254">0</span>&nbsp;<span class="op" id="2106256">{</span>&nbsp;<span class="comment" id="2106258">//&nbsp;ignore&nbsp;leading&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106286">dp</span><span class="op" id="2106288">--</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2106295">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2106307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106312">nd</span><span class="op" id="2106314">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2106320">if</span>&nbsp;<span class="ident" id="2106323">ndMant</span>&nbsp;<span class="op" id="2106330">&lt;</span>&nbsp;<span class="ident" id="2106332">uint64digits</span>&nbsp;<span class="op" id="2106345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106351">mantissa</span>&nbsp;<span class="op" id="2106360">*=</span>&nbsp;<span class="num" id="2106363">10</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106370">mantissa</span>&nbsp;<span class="op" id="2106379">+=</span>&nbsp;<span class="ident" id="2106382">uint64</span><span class="op" id="2106388">(</span><span class="ident" id="2106389">c</span>&nbsp;<span class="op" id="2106391">-</span>&nbsp;<span class="string" id="2106393">&#39;0&#39;</span><span class="op" id="2106396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106402">ndMant</span><span class="op" id="2106408">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2106414">}</span>&nbsp;<span class="keyword" id="2106416">else</span>&nbsp;<span class="keyword" id="2106421">if</span>&nbsp;<span class="ident" id="2106424">s</span><span class="op" id="2106425">[</span><span class="ident" id="2106426">i</span><span class="op" id="2106427">]</span>&nbsp;<span class="op" id="2106429">!=</span>&nbsp;<span class="string" id="2106432">&#39;0&#39;</span>&nbsp;<span class="op" id="2106436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106442">trunc</span>&nbsp;<span class="op" id="2106448">=</span>&nbsp;<span class="ident" id="2106450">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2106458">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2106463">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2106474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2106478">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2106485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2106488">if</span>&nbsp;<span class="op" id="2106491">!</span><span class="ident" id="2106492">sawdigits</span>&nbsp;<span class="op" id="2106502">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2106506">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2106514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2106517">if</span>&nbsp;<span class="op" id="2106520">!</span><span class="ident" id="2106521">sawdot</span>&nbsp;<span class="op" id="2106528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106532">dp</span>&nbsp;<span class="op" id="2106535">=</span>&nbsp;<span class="ident" id="2106537">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2106541">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2106545">//&nbsp;optional&nbsp;exponent&nbsp;moves&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2106588">//&nbsp;if&nbsp;we&nbsp;read&nbsp;a&nbsp;very&nbsp;large,&nbsp;very&nbsp;long&nbsp;number,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2106635">//&nbsp;just&nbsp;be&nbsp;sure&nbsp;to&nbsp;move&nbsp;the&nbsp;decimal&nbsp;point&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2106681">//&nbsp;a&nbsp;lot&nbsp;(say,&nbsp;100000).&nbsp;&nbsp;it&nbsp;doesn&#39;t&nbsp;matter&nbsp;if&nbsp;it&#39;s</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2106733">//&nbsp;not&nbsp;the&nbsp;exact&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2106759">if</span>&nbsp;<span class="ident" id="2106762">i</span>&nbsp;<span class="op" id="2106764">&lt;</span>&nbsp;<span class="builtinfunc" id="2106766">len</span><span class="op" id="2106769">(</span><span class="ident" id="2106770">s</span><span class="op" id="2106771">)</span>&nbsp;<span class="op" id="2106773">&amp;&amp;</span>&nbsp;<span class="op" id="2106776">(</span><span class="ident" id="2106777">s</span><span class="op" id="2106778">[</span><span class="ident" id="2106779">i</span><span class="op" id="2106780">]</span>&nbsp;<span class="op" id="2106782">==</span>&nbsp;<span class="string" id="2106785">&#39;e&#39;</span>&nbsp;<span class="op" id="2106789">||</span>&nbsp;<span class="ident" id="2106792">s</span><span class="op" id="2106793">[</span><span class="ident" id="2106794">i</span><span class="op" id="2106795">]</span>&nbsp;<span class="op" id="2106797">==</span>&nbsp;<span class="string" id="2106800">&#39;E&#39;</span><span class="op" id="2106803">)</span>&nbsp;<span class="op" id="2106805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106809">i</span><span class="op" id="2106810">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2106815">if</span>&nbsp;<span class="ident" id="2106818">i</span>&nbsp;<span class="op" id="2106820">&gt;=</span>&nbsp;<span class="builtinfunc" id="2106823">len</span><span class="op" id="2106826">(</span><span class="ident" id="2106827">s</span><span class="op" id="2106828">)</span>&nbsp;<span class="op" id="2106830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2106835">return</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2106844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106848">esign</span>&nbsp;<span class="op" id="2106854">:=</span>&nbsp;<span class="num" id="2106857">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2106861">if</span>&nbsp;<span class="ident" id="2106864">s</span><span class="op" id="2106865">[</span><span class="ident" id="2106866">i</span><span class="op" id="2106867">]</span>&nbsp;<span class="op" id="2106869">==</span>&nbsp;<span class="string" id="2106872">&#39;+&#39;</span>&nbsp;<span class="op" id="2106876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106881">i</span><span class="op" id="2106882">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2106887">}</span>&nbsp;<span class="keyword" id="2106889">else</span>&nbsp;<span class="keyword" id="2106894">if</span>&nbsp;<span class="ident" id="2106897">s</span><span class="op" id="2106898">[</span><span class="ident" id="2106899">i</span><span class="op" id="2106900">]</span>&nbsp;<span class="op" id="2106902">==</span>&nbsp;<span class="string" id="2106905">&#39;-&#39;</span>&nbsp;<span class="op" id="2106909">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106914">i</span><span class="op" id="2106915">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106921">esign</span>&nbsp;<span class="op" id="2106927">=</span>&nbsp;<span class="op" id="2106929">-</span><span class="num" id="2106930">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2106934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2106938">if</span>&nbsp;<span class="ident" id="2106941">i</span>&nbsp;<span class="op" id="2106943">&gt;=</span>&nbsp;<span class="builtinfunc" id="2106946">len</span><span class="op" id="2106949">(</span><span class="ident" id="2106950">s</span><span class="op" id="2106951">)</span>&nbsp;<span class="op" id="2106953">||</span>&nbsp;<span class="ident" id="2106956">s</span><span class="op" id="2106957">[</span><span class="ident" id="2106958">i</span><span class="op" id="2106959">]</span>&nbsp;<span class="op" id="2106961">&lt;</span>&nbsp;<span class="string" id="2106963">&#39;0&#39;</span>&nbsp;<span class="op" id="2106967">||</span>&nbsp;<span class="ident" id="2106970">s</span><span class="op" id="2106971">[</span><span class="ident" id="2106972">i</span><span class="op" id="2106973">]</span>&nbsp;<span class="op" id="2106975">&gt;</span>&nbsp;<span class="string" id="2106977">&#39;9&#39;</span>&nbsp;<span class="op" id="2106981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2106986">return</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2106995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2106999">e</span>&nbsp;<span class="op" id="2107001">:=</span>&nbsp;<span class="num" id="2107004">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2107008">for</span>&nbsp;<span class="op" id="2107012">;</span>&nbsp;<span class="ident" id="2107014">i</span>&nbsp;<span class="op" id="2107016">&lt;</span>&nbsp;<span class="builtinfunc" id="2107018">len</span><span class="op" id="2107021">(</span><span class="ident" id="2107022">s</span><span class="op" id="2107023">)</span>&nbsp;<span class="op" id="2107025">&amp;&amp;</span>&nbsp;<span class="string" id="2107028">&#39;0&#39;</span>&nbsp;<span class="op" id="2107032">&lt;=</span>&nbsp;<span class="ident" id="2107035">s</span><span class="op" id="2107036">[</span><span class="ident" id="2107037">i</span><span class="op" id="2107038">]</span>&nbsp;<span class="op" id="2107040">&amp;&amp;</span>&nbsp;<span class="ident" id="2107043">s</span><span class="op" id="2107044">[</span><span class="ident" id="2107045">i</span><span class="op" id="2107046">]</span>&nbsp;<span class="op" id="2107048">&lt;=</span>&nbsp;<span class="string" id="2107051">&#39;9&#39;</span><span class="op" id="2107054">;</span>&nbsp;<span class="ident" id="2107056">i</span><span class="op" id="2107057">++</span>&nbsp;<span class="op" id="2107060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2107065">if</span>&nbsp;<span class="ident" id="2107068">e</span>&nbsp;<span class="op" id="2107070">&lt;</span>&nbsp;<span class="num" id="2107072">10000</span>&nbsp;<span class="op" id="2107078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2107084">e</span>&nbsp;<span class="op" id="2107086">=</span>&nbsp;<span class="ident" id="2107088">e</span><span class="op" id="2107089">*</span><span class="num" id="2107090">10</span>&nbsp;<span class="op" id="2107093">+</span>&nbsp;<span class="builtintype" id="2107095">int</span><span class="op" id="2107098">(</span><span class="ident" id="2107099">s</span><span class="op" id="2107100">[</span><span class="ident" id="2107101">i</span><span class="op" id="2107102">]</span><span class="op" id="2107103">)</span>&nbsp;<span class="op" id="2107105">-</span>&nbsp;<span class="string" id="2107107">&#39;0&#39;</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2107114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2107118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2107122">dp</span>&nbsp;<span class="op" id="2107125">+=</span>&nbsp;<span class="ident" id="2107128">e</span>&nbsp;<span class="op" id="2107130">*</span>&nbsp;<span class="ident" id="2107132">esign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2107139">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2107143">if</span>&nbsp;<span class="ident" id="2107146">i</span>&nbsp;<span class="op" id="2107148">!=</span>&nbsp;<span class="builtinfunc" id="2107151">len</span><span class="op" id="2107154">(</span><span class="ident" id="2107155">s</span><span class="op" id="2107156">)</span>&nbsp;<span class="op" id="2107158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2107162">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2107170">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2107174">exp</span>&nbsp;<span class="op" id="2107178">=</span>&nbsp;<span class="ident" id="2107180">dp</span>&nbsp;<span class="op" id="2107183">-</span>&nbsp;<span class="ident" id="2107185">ndMant</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2107193">ok</span>&nbsp;<span class="op" id="2107196">=</span>&nbsp;<span class="ident" id="2107198">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2107204">return</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="2107212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="2107215">//&nbsp;decimal&nbsp;power&nbsp;of&nbsp;ten&nbsp;to&nbsp;binary&nbsp;power&nbsp;of&nbsp;two.</span><br>
<span class="lineno"></span><span class="keyword" id="2107263">var</span>&nbsp;<span class="ident" id="2107267">powtab</span>&nbsp;<span class="op" id="2107274">=</span>&nbsp;<span class="op" id="2107276">[</span><span class="op" id="2107277">]</span><span class="builtintype" id="2107278">int</span><span class="op" id="2107281">{</span><span class="num" id="2107282">1</span><span class="op" id="2107283">,</span>&nbsp;<span class="num" id="2107285">3</span><span class="op" id="2107286">,</span>&nbsp;<span class="num" id="2107288">6</span><span class="op" id="2107289">,</span>&nbsp;<span class="num" id="2107291">9</span><span class="op" id="2107292">,</span>&nbsp;<span class="num" id="2107294">13</span><span class="op" id="2107296">,</span>&nbsp;<span class="num" id="2107298">16</span><span class="op" id="2107300">,</span>&nbsp;<span class="num" id="2107302">19</span><span class="op" id="2107304">,</span>&nbsp;<span class="num" id="2107306">23</span><span class="op" id="2107308">,</span>&nbsp;<span class="num" id="2107310">26</span><span class="op" id="2107312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2107315">func</span>&nbsp;<span class="op" id="2107320">(</span><span class="ident" id="2107321">d</span>&nbsp;<span class="op" id="2107323">*</span><span class="ident" id="2107324">decimal</span><span class="op" id="2107331">)</span>&nbsp;<span class="ident" id="2107333">floatBits</span><span class="op" id="2107342">(</span><span class="ident" id="2107343">flt</span>&nbsp;<span class="op" id="2107347">*</span><span class="ident" id="2107348">floatInfo</span><span class="op" id="2107357">)</span>&nbsp;<span class="op" id="2107359">(</span><span class="ident" id="2107360">b</span>&nbsp;<span class="ident" id="2107362">uint64</span><span class="op" id="2107368">,</span>&nbsp;<span class="ident" id="2107370">overflow</span>&nbsp;<span class="builtintype" id="2107379">bool</span><span class="op" id="2107383">)</span>&nbsp;<span class="op" id="2107385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2107388">var</span>&nbsp;<span class="ident" id="2107392">exp</span>&nbsp;<span class="builtintype" id="2107396">int</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2107401">var</span>&nbsp;<span class="ident" id="2107405">mant</span>&nbsp;<span class="ident" id="2107410">uint64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2107419">//&nbsp;Zero&nbsp;is&nbsp;always&nbsp;a&nbsp;special&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2107454">if</span>&nbsp;<span class="ident" id="2107457">d</span><span class="op" id="2107458">.</span><span class="ident" id="2107459">nd</span>&nbsp;<span class="op" id="2107462">==</span>&nbsp;<span class="num" id="2107465">0</span>&nbsp;<span class="op" id="2107467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2107471">mant</span>&nbsp;<span class="op" id="2107476">=</span>&nbsp;<span class="num" id="2107478">0</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2107482">exp</span>&nbsp;<span class="op" id="2107486">=</span>&nbsp;<span class="ident" id="2107488">flt</span><span class="op" id="2107491">.</span><span class="ident" id="2107492">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2107499">goto</span>&nbsp;<span class="ident" id="2107504">out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2107509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2107513">//&nbsp;Obvious&nbsp;overflow/underflow.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2107545">//&nbsp;These&nbsp;bounds&nbsp;are&nbsp;for&nbsp;64-bit&nbsp;floats.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2107585">//&nbsp;Will&nbsp;have&nbsp;to&nbsp;change&nbsp;if&nbsp;we&nbsp;want&nbsp;to&nbsp;support&nbsp;80-bit&nbsp;floats&nbsp;in&nbsp;the&nbsp;future.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2107660">if</span>&nbsp;<span class="ident" id="2107663">d</span><span class="op" id="2107664">.</span><span class="ident" id="2107665">dp</span>&nbsp;<span class="op" id="2107668">&gt;</span>&nbsp;<span class="num" id="2107670">310</span>&nbsp;<span class="op" id="2107674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2107678">goto</span>&nbsp;<span class="ident" id="2107683">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2107693">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2107696">if</span>&nbsp;<span class="ident" id="2107699">d</span><span class="op" id="2107700">.</span><span class="ident" id="2107701">dp</span>&nbsp;<span class="op" id="2107704">&lt;</span>&nbsp;<span class="op" id="2107706">-</span><span class="num" id="2107707">330</span>&nbsp;<span class="op" id="2107711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2107715">//&nbsp;zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2107725">mant</span>&nbsp;<span class="op" id="2107730">=</span>&nbsp;<span class="num" id="2107732">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2107736">exp</span>&nbsp;<span class="op" id="2107740">=</span>&nbsp;<span class="ident" id="2107742">flt</span><span class="op" id="2107745">.</span><span class="ident" id="2107746">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2107753">goto</span>&nbsp;<span class="ident" id="2107758">out</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2107763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2107767">//&nbsp;Scale&nbsp;by&nbsp;powers&nbsp;of&nbsp;two&nbsp;until&nbsp;in&nbsp;range&nbsp;[0.5,&nbsp;1.0)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2107820">exp</span>&nbsp;<span class="op" id="2107824">=</span>&nbsp;<span class="num" id="2107826">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2107829">for</span>&nbsp;<span class="ident" id="2107833">d</span><span class="op" id="2107834">.</span><span class="ident" id="2107835">dp</span>&nbsp;<span class="op" id="2107838">&gt;</span>&nbsp;<span class="num" id="2107840">0</span>&nbsp;<span class="op" id="2107842">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2107846">var</span>&nbsp;<span class="ident" id="2107850">n</span>&nbsp;<span class="builtintype" id="2107852">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2107858">if</span>&nbsp;<span class="ident" id="2107861">d</span><span class="op" id="2107862">.</span><span class="ident" id="2107863">dp</span>&nbsp;<span class="op" id="2107866">&gt;=</span>&nbsp;<span class="builtinfunc" id="2107869">len</span><span class="op" id="2107872">(</span><span class="ident" id="2107873">powtab</span><span class="op" id="2107879">)</span>&nbsp;<span class="op" id="2107881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2107886">n</span>&nbsp;<span class="op" id="2107888">=</span>&nbsp;<span class="num" id="2107890">27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2107895">}</span>&nbsp;<span class="keyword" id="2107897">else</span>&nbsp;<span class="op" id="2107902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2107907">n</span>&nbsp;<span class="op" id="2107909">=</span>&nbsp;<span class="ident" id="2107911">powtab</span><span class="op" id="2107917">[</span><span class="ident" id="2107918">d</span><span class="op" id="2107919">.</span><span class="ident" id="2107920">dp</span><span class="op" id="2107922">]</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2107926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2107930">d</span><span class="op" id="2107931">.</span><span class="ident" id="2107932">Shift</span><span class="op" id="2107937">(</span><span class="op" id="2107938">-</span><span class="ident" id="2107939">n</span><span class="op" id="2107940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2107944">exp</span>&nbsp;<span class="op" id="2107948">+=</span>&nbsp;<span class="ident" id="2107951">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2107954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2107957">for</span>&nbsp;<span class="ident" id="2107961">d</span><span class="op" id="2107962">.</span><span class="ident" id="2107963">dp</span>&nbsp;<span class="op" id="2107966">&lt;</span>&nbsp;<span class="num" id="2107968">0</span>&nbsp;<span class="op" id="2107970">||</span>&nbsp;<span class="ident" id="2107973">d</span><span class="op" id="2107974">.</span><span class="ident" id="2107975">dp</span>&nbsp;<span class="op" id="2107978">==</span>&nbsp;<span class="num" id="2107981">0</span>&nbsp;<span class="op" id="2107983">&amp;&amp;</span>&nbsp;<span class="ident" id="2107986">d</span><span class="op" id="2107987">.</span><span class="ident" id="2107988">d</span><span class="op" id="2107989">[</span><span class="num" id="2107990">0</span><span class="op" id="2107991">]</span>&nbsp;<span class="op" id="2107993">&lt;</span>&nbsp;<span class="string" id="2107995">&#39;5&#39;</span>&nbsp;<span class="op" id="2107999">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2108003">var</span>&nbsp;<span class="ident" id="2108007">n</span>&nbsp;<span class="builtintype" id="2108009">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2108015">if</span>&nbsp;<span class="op" id="2108018">-</span><span class="ident" id="2108019">d</span><span class="op" id="2108020">.</span><span class="ident" id="2108021">dp</span>&nbsp;<span class="op" id="2108024">&gt;=</span>&nbsp;<span class="builtinfunc" id="2108027">len</span><span class="op" id="2108030">(</span><span class="ident" id="2108031">powtab</span><span class="op" id="2108037">)</span>&nbsp;<span class="op" id="2108039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108044">n</span>&nbsp;<span class="op" id="2108046">=</span>&nbsp;<span class="num" id="2108048">27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2108053">}</span>&nbsp;<span class="keyword" id="2108055">else</span>&nbsp;<span class="op" id="2108060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108065">n</span>&nbsp;<span class="op" id="2108067">=</span>&nbsp;<span class="ident" id="2108069">powtab</span><span class="op" id="2108075">[</span><span class="op" id="2108076">-</span><span class="ident" id="2108077">d</span><span class="op" id="2108078">.</span><span class="ident" id="2108079">dp</span><span class="op" id="2108081">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2108085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108089">d</span><span class="op" id="2108090">.</span><span class="ident" id="2108091">Shift</span><span class="op" id="2108096">(</span><span class="ident" id="2108097">n</span><span class="op" id="2108098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108102">exp</span>&nbsp;<span class="op" id="2108106">-=</span>&nbsp;<span class="ident" id="2108109">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2108112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2108116">//&nbsp;Our&nbsp;range&nbsp;is&nbsp;[0.5,1)&nbsp;but&nbsp;floating&nbsp;point&nbsp;range&nbsp;is&nbsp;[1,2).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108176">exp</span><span class="op" id="2108179">--</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2108184">//&nbsp;Minimum&nbsp;representable&nbsp;exponent&nbsp;is&nbsp;flt.bias+1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2108234">//&nbsp;If&nbsp;the&nbsp;exponent&nbsp;is&nbsp;smaller,&nbsp;move&nbsp;it&nbsp;up&nbsp;and</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2108281">//&nbsp;adjust&nbsp;d&nbsp;accordingly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2108307">if</span>&nbsp;<span class="ident" id="2108310">exp</span>&nbsp;<span class="op" id="2108314">&lt;</span>&nbsp;<span class="ident" id="2108316">flt</span><span class="op" id="2108319">.</span><span class="ident" id="2108320">bias</span><span class="op" id="2108324">+</span><span class="num" id="2108325">1</span>&nbsp;<span class="op" id="2108327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108331">n</span>&nbsp;<span class="op" id="2108333">:=</span>&nbsp;<span class="ident" id="2108336">flt</span><span class="op" id="2108339">.</span><span class="ident" id="2108340">bias</span>&nbsp;<span class="op" id="2108345">+</span>&nbsp;<span class="num" id="2108347">1</span>&nbsp;<span class="op" id="2108349">-</span>&nbsp;<span class="ident" id="2108351">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108357">d</span><span class="op" id="2108358">.</span><span class="ident" id="2108359">Shift</span><span class="op" id="2108364">(</span><span class="op" id="2108365">-</span><span class="ident" id="2108366">n</span><span class="op" id="2108367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108371">exp</span>&nbsp;<span class="op" id="2108375">+=</span>&nbsp;<span class="ident" id="2108378">n</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2108381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2108385">if</span>&nbsp;<span class="ident" id="2108388">exp</span><span class="op" id="2108391">-</span><span class="ident" id="2108392">flt</span><span class="op" id="2108395">.</span><span class="ident" id="2108396">bias</span>&nbsp;<span class="op" id="2108401">&gt;=</span>&nbsp;<span class="num" id="2108404">1</span><span class="op" id="2108405">&lt;&lt;</span><span class="ident" id="2108407">flt</span><span class="op" id="2108410">.</span><span class="ident" id="2108411">expbits</span><span class="op" id="2108418">-</span><span class="num" id="2108419">1</span>&nbsp;<span class="op" id="2108421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2108425">goto</span>&nbsp;<span class="ident" id="2108430">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2108440">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2108444">//&nbsp;Extract&nbsp;1+flt.mantbits&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108477">d</span><span class="op" id="2108478">.</span><span class="ident" id="2108479">Shift</span><span class="op" id="2108484">(</span><span class="builtintype" id="2108485">int</span><span class="op" id="2108488">(</span><span class="num" id="2108489">1</span>&nbsp;<span class="op" id="2108491">+</span>&nbsp;<span class="ident" id="2108493">flt</span><span class="op" id="2108496">.</span><span class="ident" id="2108497">mantbits</span><span class="op" id="2108505">)</span><span class="op" id="2108506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108509">mant</span>&nbsp;<span class="op" id="2108514">=</span>&nbsp;<span class="ident" id="2108516">d</span><span class="op" id="2108517">.</span><span class="ident" id="2108518">RoundedInteger</span><span class="op" id="2108532">(</span><span class="op" id="2108533">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2108537">//&nbsp;Rounding&nbsp;might&nbsp;have&nbsp;added&nbsp;a&nbsp;bit;&nbsp;shift&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2108586">if</span>&nbsp;<span class="ident" id="2108589">mant</span>&nbsp;<span class="op" id="2108594">==</span>&nbsp;<span class="num" id="2108597">2</span><span class="op" id="2108598">&lt;&lt;</span><span class="ident" id="2108600">flt</span><span class="op" id="2108603">.</span><span class="ident" id="2108604">mantbits</span>&nbsp;<span class="op" id="2108613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108617">mant</span>&nbsp;<span class="op" id="2108622">&gt;&gt;=</span>&nbsp;<span class="num" id="2108626">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108630">exp</span><span class="op" id="2108633">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2108638">if</span>&nbsp;<span class="ident" id="2108641">exp</span><span class="op" id="2108644">-</span><span class="ident" id="2108645">flt</span><span class="op" id="2108648">.</span><span class="ident" id="2108649">bias</span>&nbsp;<span class="op" id="2108654">&gt;=</span>&nbsp;<span class="num" id="2108657">1</span><span class="op" id="2108658">&lt;&lt;</span><span class="ident" id="2108660">flt</span><span class="op" id="2108663">.</span><span class="ident" id="2108664">expbits</span><span class="op" id="2108671">-</span><span class="num" id="2108672">1</span>&nbsp;<span class="op" id="2108674">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2108679">goto</span>&nbsp;<span class="ident" id="2108684">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2108695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2108698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2108702">//&nbsp;Denormalized?</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2108720">if</span>&nbsp;<span class="ident" id="2108723">mant</span><span class="op" id="2108727">&amp;</span><span class="op" id="2108728">(</span><span class="num" id="2108729">1</span><span class="op" id="2108730">&lt;&lt;</span><span class="ident" id="2108732">flt</span><span class="op" id="2108735">.</span><span class="ident" id="2108736">mantbits</span><span class="op" id="2108744">)</span>&nbsp;<span class="op" id="2108746">==</span>&nbsp;<span class="num" id="2108749">0</span>&nbsp;<span class="op" id="2108751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108755">exp</span>&nbsp;<span class="op" id="2108759">=</span>&nbsp;<span class="ident" id="2108761">flt</span><span class="op" id="2108764">.</span><span class="ident" id="2108765">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2108771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2108774">goto</span>&nbsp;<span class="ident" id="2108779">out</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="ident" id="2108784">overflow</span><span class="op" id="2108792">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2108795">//&nbsp;±Inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108805">mant</span>&nbsp;<span class="op" id="2108810">=</span>&nbsp;<span class="num" id="2108812">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108815">exp</span>&nbsp;<span class="op" id="2108819">=</span>&nbsp;<span class="num" id="2108821">1</span><span class="op" id="2108822">&lt;&lt;</span><span class="ident" id="2108824">flt</span><span class="op" id="2108827">.</span><span class="ident" id="2108828">expbits</span>&nbsp;<span class="op" id="2108836">-</span>&nbsp;<span class="num" id="2108838">1</span>&nbsp;<span class="op" id="2108840">+</span>&nbsp;<span class="ident" id="2108842">flt</span><span class="op" id="2108845">.</span><span class="ident" id="2108846">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108852">overflow</span>&nbsp;<span class="op" id="2108861">=</span>&nbsp;<span class="ident" id="2108863">true</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="ident" id="2108869">out</span><span class="op" id="2108872">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2108875">//&nbsp;Assemble&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108894">bits</span>&nbsp;<span class="op" id="2108899">:=</span>&nbsp;<span class="ident" id="2108902">mant</span>&nbsp;<span class="op" id="2108907">&amp;</span>&nbsp;<span class="op" id="2108909">(</span><span class="ident" id="2108910">uint64</span><span class="op" id="2108916">(</span><span class="num" id="2108917">1</span><span class="op" id="2108918">)</span><span class="op" id="2108919">&lt;&lt;</span><span class="ident" id="2108921">flt</span><span class="op" id="2108924">.</span><span class="ident" id="2108925">mantbits</span>&nbsp;<span class="op" id="2108934">-</span>&nbsp;<span class="num" id="2108936">1</span><span class="op" id="2108937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2108940">bits</span>&nbsp;<span class="op" id="2108945">|=</span>&nbsp;<span class="ident" id="2108948">uint64</span><span class="op" id="2108954">(</span><span class="op" id="2108955">(</span><span class="ident" id="2108956">exp</span><span class="op" id="2108959">-</span><span class="ident" id="2108960">flt</span><span class="op" id="2108963">.</span><span class="ident" id="2108964">bias</span><span class="op" id="2108968">)</span><span class="op" id="2108969">&amp;</span><span class="op" id="2108970">(</span><span class="num" id="2108971">1</span><span class="op" id="2108972">&lt;&lt;</span><span class="ident" id="2108974">flt</span><span class="op" id="2108977">.</span><span class="ident" id="2108978">expbits</span><span class="op" id="2108985">-</span><span class="num" id="2108986">1</span><span class="op" id="2108987">)</span><span class="op" id="2108988">)</span>&nbsp;<span class="op" id="2108990">&lt;&lt;</span>&nbsp;<span class="ident" id="2108993">flt</span><span class="op" id="2108996">.</span><span class="ident" id="2108997">mantbits</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2109007">if</span>&nbsp;<span class="ident" id="2109010">d</span><span class="op" id="2109011">.</span><span class="ident" id="2109012">neg</span>&nbsp;<span class="op" id="2109016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2109020">bits</span>&nbsp;<span class="op" id="2109025">|=</span>&nbsp;<span class="num" id="2109028">1</span>&nbsp;<span class="op" id="2109030">&lt;&lt;</span>&nbsp;<span class="ident" id="2109033">flt</span><span class="op" id="2109036">.</span><span class="ident" id="2109037">mantbits</span>&nbsp;<span class="op" id="2109046">&lt;&lt;</span>&nbsp;<span class="ident" id="2109049">flt</span><span class="op" id="2109052">.</span><span class="ident" id="2109053">expbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2109062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2109065">return</span>&nbsp;<span class="ident" id="2109072">bits</span><span class="op" id="2109076">,</span>&nbsp;<span class="ident" id="2109078">overflow</span><br>
<span class="lineno"></span><span class="op" id="2109087">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span><span class="comment" id="2109090">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;10.</span><br>
<span class="lineno"></span><span class="keyword" id="2109113">var</span>&nbsp;<span class="ident" id="2109117">float64pow10</span>&nbsp;<span class="op" id="2109130">=</span>&nbsp;<span class="op" id="2109132">[</span><span class="op" id="2109133">]</span><span class="builtintype" id="2109134">float64</span><span class="op" id="2109141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2109144">1e0</span><span class="op" id="2109147">,</span>&nbsp;<span class="num" id="2109149">1e1</span><span class="op" id="2109152">,</span>&nbsp;<span class="num" id="2109154">1e2</span><span class="op" id="2109157">,</span>&nbsp;<span class="num" id="2109159">1e3</span><span class="op" id="2109162">,</span>&nbsp;<span class="num" id="2109164">1e4</span><span class="op" id="2109167">,</span>&nbsp;<span class="num" id="2109169">1e5</span><span class="op" id="2109172">,</span>&nbsp;<span class="num" id="2109174">1e6</span><span class="op" id="2109177">,</span>&nbsp;<span class="num" id="2109179">1e7</span><span class="op" id="2109182">,</span>&nbsp;<span class="num" id="2109184">1e8</span><span class="op" id="2109187">,</span>&nbsp;<span class="num" id="2109189">1e9</span><span class="op" id="2109192">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2109195">1e10</span><span class="op" id="2109199">,</span>&nbsp;<span class="num" id="2109201">1e11</span><span class="op" id="2109205">,</span>&nbsp;<span class="num" id="2109207">1e12</span><span class="op" id="2109211">,</span>&nbsp;<span class="num" id="2109213">1e13</span><span class="op" id="2109217">,</span>&nbsp;<span class="num" id="2109219">1e14</span><span class="op" id="2109223">,</span>&nbsp;<span class="num" id="2109225">1e15</span><span class="op" id="2109229">,</span>&nbsp;<span class="num" id="2109231">1e16</span><span class="op" id="2109235">,</span>&nbsp;<span class="num" id="2109237">1e17</span><span class="op" id="2109241">,</span>&nbsp;<span class="num" id="2109243">1e18</span><span class="op" id="2109247">,</span>&nbsp;<span class="num" id="2109249">1e19</span><span class="op" id="2109253">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2109256">1e20</span><span class="op" id="2109260">,</span>&nbsp;<span class="num" id="2109262">1e21</span><span class="op" id="2109266">,</span>&nbsp;<span class="num" id="2109268">1e22</span><span class="op" id="2109272">,</span><br>
<span class="lineno"></span><span class="op" id="2109274">}</span><br>
<span class="lineno"></span><span class="keyword" id="2109276">var</span>&nbsp;<span class="ident" id="2109280">float32pow10</span>&nbsp;<span class="op" id="2109293">=</span>&nbsp;<span class="op" id="2109295">[</span><span class="op" id="2109296">]</span><span class="builtintype" id="2109297">float32</span><span class="op" id="2109304">{</span><span class="num" id="2109305">1e0</span><span class="op" id="2109308">,</span>&nbsp;<span class="num" id="2109310">1e1</span><span class="op" id="2109313">,</span>&nbsp;<span class="num" id="2109315">1e2</span><span class="op" id="2109318">,</span>&nbsp;<span class="num" id="2109320">1e3</span><span class="op" id="2109323">,</span>&nbsp;<span class="num" id="2109325">1e4</span><span class="op" id="2109328">,</span>&nbsp;<span class="num" id="2109330">1e5</span><span class="op" id="2109333">,</span>&nbsp;<span class="num" id="2109335">1e6</span><span class="op" id="2109338">,</span>&nbsp;<span class="num" id="2109340">1e7</span><span class="op" id="2109343">,</span>&nbsp;<span class="num" id="2109345">1e8</span><span class="op" id="2109348">,</span>&nbsp;<span class="num" id="2109350">1e9</span><span class="op" id="2109353">,</span>&nbsp;<span class="num" id="2109355">1e10</span><span class="op" id="2109359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2109362">//&nbsp;If&nbsp;possible&nbsp;to&nbsp;convert&nbsp;decimal&nbsp;representation&nbsp;to&nbsp;64-bit&nbsp;float&nbsp;f&nbsp;exactly,</span><br>
<span class="lineno">365</span><span class="comment" id="2109438">//&nbsp;entirely&nbsp;in&nbsp;floating-point&nbsp;math,&nbsp;do&nbsp;so,&nbsp;avoiding&nbsp;the&nbsp;expense&nbsp;of&nbsp;decimalToFloatBits.</span><br>
<span class="lineno"></span><span class="comment" id="2109525">//&nbsp;Three&nbsp;common&nbsp;cases:</span><br>
<span class="lineno"></span><span class="comment" id="2109548">//&nbsp;&nbsp;&nbsp;&nbspvalue&nbsp;is&nbsp;exact&nbsp;integer</span><br>
<span class="lineno"></span><span class="comment" id="2109574">//&nbsp;&nbsp;&nbsp;&nbspvalue&nbsp;is&nbsp;exact&nbsp;integer&nbsp;*&nbsp;exact&nbsp;power&nbsp;of&nbsp;ten</span><br>
<span class="lineno"></span><span class="comment" id="2109621">//&nbsp;&nbsp;&nbsp;&nbspvalue&nbsp;is&nbsp;exact&nbsp;integer&nbsp;/&nbsp;exact&nbsp;power&nbsp;of&nbsp;ten</span><br>
<span class="lineno">370</span><span class="comment" id="2109668">//&nbsp;These&nbsp;all&nbsp;produce&nbsp;potentially&nbsp;inexact&nbsp;but&nbsp;correctly&nbsp;rounded&nbsp;answers.</span><br>
<span class="lineno"></span><span class="keyword" id="2109740">func</span>&nbsp;<span class="ident" id="2109745">atof64exact</span><span class="op" id="2109756">(</span><span class="ident" id="2109757">mantissa</span>&nbsp;<span class="ident" id="2109766">uint64</span><span class="op" id="2109772">,</span>&nbsp;<span class="ident" id="2109774">exp</span>&nbsp;<span class="builtintype" id="2109778">int</span><span class="op" id="2109781">,</span>&nbsp;<span class="ident" id="2109783">neg</span>&nbsp;<span class="builtintype" id="2109787">bool</span><span class="op" id="2109791">)</span>&nbsp;<span class="op" id="2109793">(</span><span class="ident" id="2109794">f</span>&nbsp;<span class="builtintype" id="2109796">float64</span><span class="op" id="2109803">,</span>&nbsp;<span class="ident" id="2109805">ok</span>&nbsp;<span class="builtintype" id="2109808">bool</span><span class="op" id="2109812">)</span>&nbsp;<span class="op" id="2109814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2109817">if</span>&nbsp;<span class="ident" id="2109820">mantissa</span><span class="op" id="2109828">&gt;&gt;</span><span class="ident" id="2109830">float64info</span><span class="op" id="2109841">.</span><span class="ident" id="2109842">mantbits</span>&nbsp;<span class="op" id="2109851">!=</span>&nbsp;<span class="num" id="2109854">0</span>&nbsp;<span class="op" id="2109856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2109860">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2109868">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2109871">f</span>&nbsp;<span class="op" id="2109873">=</span>&nbsp;<span class="builtintype" id="2109875">float64</span><span class="op" id="2109882">(</span><span class="ident" id="2109883">mantissa</span><span class="op" id="2109891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2109894">if</span>&nbsp;<span class="ident" id="2109897">neg</span>&nbsp;<span class="op" id="2109901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2109905">f</span>&nbsp;<span class="op" id="2109907">=</span>&nbsp;<span class="op" id="2109909">-</span><span class="ident" id="2109910">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2109913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2109916">switch</span>&nbsp;<span class="op" id="2109923">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2109926">case</span>&nbsp;<span class="ident" id="2109931">exp</span>&nbsp;<span class="op" id="2109935">==</span>&nbsp;<span class="num" id="2109938">0</span><span class="op" id="2109939">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2109943">//&nbsp;an&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2109960">return</span>&nbsp;<span class="ident" id="2109967">f</span><span class="op" id="2109968">,</span>&nbsp;<span class="ident" id="2109970">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2109976">//&nbsp;Exact&nbsp;integers&nbsp;are&nbsp;&lt;=&nbsp;10^15.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2110009">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;ten&nbsp;are&nbsp;&lt;=&nbsp;10^22.</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110047">case</span>&nbsp;<span class="ident" id="2110052">exp</span>&nbsp;<span class="op" id="2110056">&gt;</span>&nbsp;<span class="num" id="2110058">0</span>&nbsp;<span class="op" id="2110060">&amp;&amp;</span>&nbsp;<span class="ident" id="2110063">exp</span>&nbsp;<span class="op" id="2110067">&lt;=</span>&nbsp;<span class="num" id="2110070">15</span><span class="op" id="2110072">+</span><span class="num" id="2110073">22</span><span class="op" id="2110075">:</span>&nbsp;<span class="comment" id="2110077">//&nbsp;int&nbsp;*&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2110093">//&nbsp;If&nbsp;exponent&nbsp;is&nbsp;big&nbsp;but&nbsp;number&nbsp;of&nbsp;digits&nbsp;is&nbsp;not,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2110146">//&nbsp;can&nbsp;move&nbsp;a&nbsp;few&nbsp;zeros&nbsp;into&nbsp;the&nbsp;integer&nbsp;part.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110195">if</span>&nbsp;<span class="ident" id="2110198">exp</span>&nbsp;<span class="op" id="2110202">&gt;</span>&nbsp;<span class="num" id="2110204">22</span>&nbsp;<span class="op" id="2110207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2110212">f</span>&nbsp;<span class="op" id="2110214">*=</span>&nbsp;<span class="ident" id="2110217">float64pow10</span><span class="op" id="2110229">[</span><span class="ident" id="2110230">exp</span><span class="op" id="2110233">-</span><span class="num" id="2110234">22</span><span class="op" id="2110236">]</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2110241">exp</span>&nbsp;<span class="op" id="2110245">=</span>&nbsp;<span class="num" id="2110247">22</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2110252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110256">if</span>&nbsp;<span class="ident" id="2110259">f</span>&nbsp;<span class="op" id="2110261">&gt;</span>&nbsp;<span class="num" id="2110263">1e15</span>&nbsp;<span class="op" id="2110268">||</span>&nbsp;<span class="ident" id="2110271">f</span>&nbsp;<span class="op" id="2110273">&lt;</span>&nbsp;<span class="op" id="2110275">-</span><span class="num" id="2110276">1e15</span>&nbsp;<span class="op" id="2110281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2110286">//&nbsp;the&nbsp;exponent&nbsp;was&nbsp;really&nbsp;too&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110327">return</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2110336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110340">return</span>&nbsp;<span class="ident" id="2110347">f</span>&nbsp;<span class="op" id="2110349">*</span>&nbsp;<span class="ident" id="2110351">float64pow10</span><span class="op" id="2110363">[</span><span class="ident" id="2110364">exp</span><span class="op" id="2110367">]</span><span class="op" id="2110368">,</span>&nbsp;<span class="ident" id="2110370">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110376">case</span>&nbsp;<span class="ident" id="2110381">exp</span>&nbsp;<span class="op" id="2110385">&lt;</span>&nbsp;<span class="num" id="2110387">0</span>&nbsp;<span class="op" id="2110389">&amp;&amp;</span>&nbsp;<span class="ident" id="2110392">exp</span>&nbsp;<span class="op" id="2110396">&gt;=</span>&nbsp;<span class="op" id="2110399">-</span><span class="num" id="2110400">22</span><span class="op" id="2110402">:</span>&nbsp;<span class="comment" id="2110404">//&nbsp;int&nbsp;/&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110420">return</span>&nbsp;<span class="ident" id="2110427">f</span>&nbsp;<span class="op" id="2110429">/</span>&nbsp;<span class="ident" id="2110431">float64pow10</span><span class="op" id="2110443">[</span><span class="op" id="2110444">-</span><span class="ident" id="2110445">exp</span><span class="op" id="2110448">]</span><span class="op" id="2110449">,</span>&nbsp;<span class="ident" id="2110451">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2110457">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110460">return</span><br>
<span class="lineno"></span><span class="op" id="2110467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2110470">//&nbsp;If&nbsp;possible&nbsp;to&nbsp;compute&nbsp;mantissa*10^exp&nbsp;to&nbsp;32-bit&nbsp;float&nbsp;f&nbsp;exactly,</span><br>
<span class="lineno"></span><span class="comment" id="2110539">//&nbsp;entirely&nbsp;in&nbsp;floating-point&nbsp;math,&nbsp;do&nbsp;so,&nbsp;avoiding&nbsp;the&nbsp;machinery&nbsp;above.</span><br>
<span class="lineno">405</span><span class="keyword" id="2110612">func</span>&nbsp;<span class="ident" id="2110617">atof32exact</span><span class="op" id="2110628">(</span><span class="ident" id="2110629">mantissa</span>&nbsp;<span class="ident" id="2110638">uint64</span><span class="op" id="2110644">,</span>&nbsp;<span class="ident" id="2110646">exp</span>&nbsp;<span class="builtintype" id="2110650">int</span><span class="op" id="2110653">,</span>&nbsp;<span class="ident" id="2110655">neg</span>&nbsp;<span class="builtintype" id="2110659">bool</span><span class="op" id="2110663">)</span>&nbsp;<span class="op" id="2110665">(</span><span class="ident" id="2110666">f</span>&nbsp;<span class="builtintype" id="2110668">float32</span><span class="op" id="2110675">,</span>&nbsp;<span class="ident" id="2110677">ok</span>&nbsp;<span class="builtintype" id="2110680">bool</span><span class="op" id="2110684">)</span>&nbsp;<span class="op" id="2110686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110689">if</span>&nbsp;<span class="ident" id="2110692">mantissa</span><span class="op" id="2110700">&gt;&gt;</span><span class="ident" id="2110702">float32info</span><span class="op" id="2110713">.</span><span class="ident" id="2110714">mantbits</span>&nbsp;<span class="op" id="2110723">!=</span>&nbsp;<span class="num" id="2110726">0</span>&nbsp;<span class="op" id="2110728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110732">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2110740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2110743">f</span>&nbsp;<span class="op" id="2110745">=</span>&nbsp;<span class="builtintype" id="2110747">float32</span><span class="op" id="2110754">(</span><span class="ident" id="2110755">mantissa</span><span class="op" id="2110763">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110766">if</span>&nbsp;<span class="ident" id="2110769">neg</span>&nbsp;<span class="op" id="2110773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2110777">f</span>&nbsp;<span class="op" id="2110779">=</span>&nbsp;<span class="op" id="2110781">-</span><span class="ident" id="2110782">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2110785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110788">switch</span>&nbsp;<span class="op" id="2110795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110798">case</span>&nbsp;<span class="ident" id="2110803">exp</span>&nbsp;<span class="op" id="2110807">==</span>&nbsp;<span class="num" id="2110810">0</span><span class="op" id="2110811">:</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110815">return</span>&nbsp;<span class="ident" id="2110822">f</span><span class="op" id="2110823">,</span>&nbsp;<span class="ident" id="2110825">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2110831">//&nbsp;Exact&nbsp;integers&nbsp;are&nbsp;&lt;=&nbsp;10^7.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2110863">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;ten&nbsp;are&nbsp;&lt;=&nbsp;10^10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2110901">case</span>&nbsp;<span class="ident" id="2110906">exp</span>&nbsp;<span class="op" id="2110910">&gt;</span>&nbsp;<span class="num" id="2110912">0</span>&nbsp;<span class="op" id="2110914">&amp;&amp;</span>&nbsp;<span class="ident" id="2110917">exp</span>&nbsp;<span class="op" id="2110921">&lt;=</span>&nbsp;<span class="num" id="2110924">7</span><span class="op" id="2110925">+</span><span class="num" id="2110926">10</span><span class="op" id="2110928">:</span>&nbsp;<span class="comment" id="2110930">//&nbsp;int&nbsp;*&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2110946">//&nbsp;If&nbsp;exponent&nbsp;is&nbsp;big&nbsp;but&nbsp;number&nbsp;of&nbsp;digits&nbsp;is&nbsp;not,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2110999">//&nbsp;can&nbsp;move&nbsp;a&nbsp;few&nbsp;zeros&nbsp;into&nbsp;the&nbsp;integer&nbsp;part.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111048">if</span>&nbsp;<span class="ident" id="2111051">exp</span>&nbsp;<span class="op" id="2111055">&gt;</span>&nbsp;<span class="num" id="2111057">10</span>&nbsp;<span class="op" id="2111060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111065">f</span>&nbsp;<span class="op" id="2111067">*=</span>&nbsp;<span class="ident" id="2111070">float32pow10</span><span class="op" id="2111082">[</span><span class="ident" id="2111083">exp</span><span class="op" id="2111086">-</span><span class="num" id="2111087">10</span><span class="op" id="2111089">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111094">exp</span>&nbsp;<span class="op" id="2111098">=</span>&nbsp;<span class="num" id="2111100">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2111105">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111109">if</span>&nbsp;<span class="ident" id="2111112">f</span>&nbsp;<span class="op" id="2111114">&gt;</span>&nbsp;<span class="num" id="2111116">1e7</span>&nbsp;<span class="op" id="2111120">||</span>&nbsp;<span class="ident" id="2111123">f</span>&nbsp;<span class="op" id="2111125">&lt;</span>&nbsp;<span class="op" id="2111127">-</span><span class="num" id="2111128">1e7</span>&nbsp;<span class="op" id="2111132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2111137">//&nbsp;the&nbsp;exponent&nbsp;was&nbsp;really&nbsp;too&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111178">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2111187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111191">return</span>&nbsp;<span class="ident" id="2111198">f</span>&nbsp;<span class="op" id="2111200">*</span>&nbsp;<span class="ident" id="2111202">float32pow10</span><span class="op" id="2111214">[</span><span class="ident" id="2111215">exp</span><span class="op" id="2111218">]</span><span class="op" id="2111219">,</span>&nbsp;<span class="ident" id="2111221">true</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111227">case</span>&nbsp;<span class="ident" id="2111232">exp</span>&nbsp;<span class="op" id="2111236">&lt;</span>&nbsp;<span class="num" id="2111238">0</span>&nbsp;<span class="op" id="2111240">&amp;&amp;</span>&nbsp;<span class="ident" id="2111243">exp</span>&nbsp;<span class="op" id="2111247">&gt;=</span>&nbsp;<span class="op" id="2111250">-</span><span class="num" id="2111251">10</span><span class="op" id="2111253">:</span>&nbsp;<span class="comment" id="2111255">//&nbsp;int&nbsp;/&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111271">return</span>&nbsp;<span class="ident" id="2111278">f</span>&nbsp;<span class="op" id="2111280">/</span>&nbsp;<span class="ident" id="2111282">float32pow10</span><span class="op" id="2111294">[</span><span class="op" id="2111295">-</span><span class="ident" id="2111296">exp</span><span class="op" id="2111299">]</span><span class="op" id="2111300">,</span>&nbsp;<span class="ident" id="2111302">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2111308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111311">return</span><br>
<span class="lineno"></span><span class="op" id="2111318">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="2111321">const</span>&nbsp;<span class="ident" id="2111327">fnParseFloat</span>&nbsp;<span class="op" id="2111340">=</span>&nbsp;<span class="string" id="2111342">&#34;ParseFloat&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2111356">func</span>&nbsp;<span class="ident" id="2111361">atof32</span><span class="op" id="2111367">(</span><span class="ident" id="2111368">s</span>&nbsp;<span class="builtintype" id="2111370">string</span><span class="op" id="2111376">)</span>&nbsp;<span class="op" id="2111378">(</span><span class="ident" id="2111379">f</span>&nbsp;<span class="builtintype" id="2111381">float32</span><span class="op" id="2111388">,</span>&nbsp;<span class="ident" id="2111390">err</span>&nbsp;<span class="builtintype" id="2111394">error</span><span class="op" id="2111399">)</span>&nbsp;<span class="op" id="2111401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111404">if</span>&nbsp;<span class="ident" id="2111407">val</span><span class="op" id="2111410">,</span>&nbsp;<span class="ident" id="2111412">ok</span>&nbsp;<span class="op" id="2111415">:=</span>&nbsp;<span class="ident" id="2111418">special</span><span class="op" id="2111425">(</span><span class="ident" id="2111426">s</span><span class="op" id="2111427">)</span><span class="op" id="2111428">;</span>&nbsp;<span class="ident" id="2111430">ok</span>&nbsp;<span class="op" id="2111433">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111437">return</span>&nbsp;<span class="builtintype" id="2111444">float32</span><span class="op" id="2111451">(</span><span class="ident" id="2111452">val</span><span class="op" id="2111455">)</span><span class="op" id="2111456">,</span>&nbsp;<span class="ident" id="2111458">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2111463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111467">if</span>&nbsp;<span class="ident" id="2111470">optimize</span>&nbsp;<span class="op" id="2111479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2111483">//&nbsp;Parse&nbsp;mantissa&nbsp;and&nbsp;exponent.</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111517">mantissa</span><span class="op" id="2111525">,</span>&nbsp;<span class="ident" id="2111527">exp</span><span class="op" id="2111530">,</span>&nbsp;<span class="ident" id="2111532">neg</span><span class="op" id="2111535">,</span>&nbsp;<span class="ident" id="2111537">trunc</span><span class="op" id="2111542">,</span>&nbsp;<span class="ident" id="2111544">ok</span>&nbsp;<span class="op" id="2111547">:=</span>&nbsp;<span class="ident" id="2111550">readFloat</span><span class="op" id="2111559">(</span><span class="ident" id="2111560">s</span><span class="op" id="2111561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111565">if</span>&nbsp;<span class="ident" id="2111568">ok</span>&nbsp;<span class="op" id="2111571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2111576">//&nbsp;Try&nbsp;pure&nbsp;floating-point&nbsp;arithmetic&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111629">if</span>&nbsp;<span class="op" id="2111632">!</span><span class="ident" id="2111633">trunc</span>&nbsp;<span class="op" id="2111639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111645">if</span>&nbsp;<span class="ident" id="2111648">f</span><span class="op" id="2111649">,</span>&nbsp;<span class="ident" id="2111651">ok</span>&nbsp;<span class="op" id="2111654">:=</span>&nbsp;<span class="ident" id="2111657">atof32exact</span><span class="op" id="2111668">(</span><span class="ident" id="2111669">mantissa</span><span class="op" id="2111677">,</span>&nbsp;<span class="ident" id="2111679">exp</span><span class="op" id="2111682">,</span>&nbsp;<span class="ident" id="2111684">neg</span><span class="op" id="2111687">)</span><span class="op" id="2111688">;</span>&nbsp;<span class="ident" id="2111690">ok</span>&nbsp;<span class="op" id="2111693">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111700">return</span>&nbsp;<span class="ident" id="2111707">f</span><span class="op" id="2111708">,</span>&nbsp;<span class="ident" id="2111710">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2111718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2111723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2111728">//&nbsp;Try&nbsp;another&nbsp;fast&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111757">ext</span>&nbsp;<span class="op" id="2111761">:=</span>&nbsp;<span class="builtinfunc" id="2111764">new</span><span class="op" id="2111767">(</span><span class="ident" id="2111768">extFloat</span><span class="op" id="2111776">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111781">if</span>&nbsp;<span class="ident" id="2111784">ok</span>&nbsp;<span class="op" id="2111787">:=</span>&nbsp;<span class="ident" id="2111790">ext</span><span class="op" id="2111793">.</span><span class="ident" id="2111794">AssignDecimal</span><span class="op" id="2111807">(</span><span class="ident" id="2111808">mantissa</span><span class="op" id="2111816">,</span>&nbsp;<span class="ident" id="2111818">exp</span><span class="op" id="2111821">,</span>&nbsp;<span class="ident" id="2111823">neg</span><span class="op" id="2111826">,</span>&nbsp;<span class="ident" id="2111828">trunc</span><span class="op" id="2111833">,</span>&nbsp;<span class="op" id="2111835">&amp;</span><span class="ident" id="2111836">float32info</span><span class="op" id="2111847">)</span><span class="op" id="2111848">;</span>&nbsp;<span class="ident" id="2111850">ok</span>&nbsp;<span class="op" id="2111853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111859">b</span><span class="op" id="2111860">,</span>&nbsp;<span class="ident" id="2111862">ovf</span>&nbsp;<span class="op" id="2111866">:=</span>&nbsp;<span class="ident" id="2111869">ext</span><span class="op" id="2111872">.</span><span class="ident" id="2111873">floatBits</span><span class="op" id="2111882">(</span><span class="op" id="2111883">&amp;</span><span class="ident" id="2111884">float32info</span><span class="op" id="2111895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111901">f</span>&nbsp;<span class="op" id="2111903">=</span>&nbsp;<span class="ident" id="2111905">math</span><span class="op" id="2111909">.</span><span class="ident" id="2111910">Float32frombits</span><span class="op" id="2111925">(</span><span class="builtintype" id="2111926">uint32</span><span class="op" id="2111932">(</span><span class="ident" id="2111933">b</span><span class="op" id="2111934">)</span><span class="op" id="2111935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111941">if</span>&nbsp;<span class="ident" id="2111944">ovf</span>&nbsp;<span class="op" id="2111948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2111955">err</span>&nbsp;<span class="op" id="2111959">=</span>&nbsp;<span class="ident" id="2111961">rangeError</span><span class="op" id="2111971">(</span><span class="ident" id="2111972">fnParseFloat</span><span class="op" id="2111984">,</span>&nbsp;<span class="ident" id="2111986">s</span><span class="op" id="2111987">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2111993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2111999">return</span>&nbsp;<span class="ident" id="2112006">f</span><span class="op" id="2112007">,</span>&nbsp;<span class="ident" id="2112009">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2112016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2112020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2112023">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2112026">var</span>&nbsp;<span class="ident" id="2112030">d</span>&nbsp;<span class="ident" id="2112032">decimal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2112041">if</span>&nbsp;<span class="op" id="2112044">!</span><span class="ident" id="2112045">d</span><span class="op" id="2112046">.</span><span class="ident" id="2112047">set</span><span class="op" id="2112050">(</span><span class="ident" id="2112051">s</span><span class="op" id="2112052">)</span>&nbsp;<span class="op" id="2112054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2112058">return</span>&nbsp;<span class="num" id="2112065">0</span><span class="op" id="2112066">,</span>&nbsp;<span class="ident" id="2112068">syntaxError</span><span class="op" id="2112079">(</span><span class="ident" id="2112080">fnParseFloat</span><span class="op" id="2112092">,</span>&nbsp;<span class="ident" id="2112094">s</span><span class="op" id="2112095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2112098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2112101">b</span><span class="op" id="2112102">,</span>&nbsp;<span class="ident" id="2112104">ovf</span>&nbsp;<span class="op" id="2112108">:=</span>&nbsp;<span class="ident" id="2112111">d</span><span class="op" id="2112112">.</span><span class="ident" id="2112113">floatBits</span><span class="op" id="2112122">(</span><span class="op" id="2112123">&amp;</span><span class="ident" id="2112124">float32info</span><span class="op" id="2112135">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2112138">f</span>&nbsp;<span class="op" id="2112140">=</span>&nbsp;<span class="ident" id="2112142">math</span><span class="op" id="2112146">.</span><span class="ident" id="2112147">Float32frombits</span><span class="op" id="2112162">(</span><span class="builtintype" id="2112163">uint32</span><span class="op" id="2112169">(</span><span class="ident" id="2112170">b</span><span class="op" id="2112171">)</span><span class="op" id="2112172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2112175">if</span>&nbsp;<span class="ident" id="2112178">ovf</span>&nbsp;<span class="op" id="2112182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2112186">err</span>&nbsp;<span class="op" id="2112190">=</span>&nbsp;<span class="ident" id="2112192">rangeError</span><span class="op" id="2112202">(</span><span class="ident" id="2112203">fnParseFloat</span><span class="op" id="2112215">,</span>&nbsp;<span class="ident" id="2112217">s</span><span class="op" id="2112218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2112221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2112224">return</span>&nbsp;<span class="ident" id="2112231">f</span><span class="op" id="2112232">,</span>&nbsp;<span class="ident" id="2112234">err</span><br>
<span class="lineno">475</span><span class="op" id="2112238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2112241">func</span>&nbsp;<span class="ident" id="2112246">atof64</span><span class="op" id="2112252">(</span><span class="ident" id="2112253">s</span>&nbsp;<span class="builtintype" id="2112255">string</span><span class="op" id="2112261">)</span>&nbsp;<span class="op" id="2112263">(</span><span class="ident" id="2112264">f</span>&nbsp;<span class="builtintype" id="2112266">float64</span><span class="op" id="2112273">,</span>&nbsp;<span class="ident" id="2112275">err</span>&nbsp;<span class="builtintype" id="2112279">error</span><span class="op" id="2112284">)</span>&nbsp;<span class="op" id="2112286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2112289">if</span>&nbsp;<span class="ident" id="2112292">val</span><span class="op" id="2112295">,</span>&nbsp;<span class="ident" id="2112297">ok</span>&nbsp;<span class="op" id="2112300">:=</span>&nbsp;<span class="ident" id="2112303">special</span><span class="op" id="2112310">(</span><span class="ident" id="2112311">s</span><span class="op" id="2112312">)</span><span class="op" id="2112313">;</span>&nbsp;<span class="ident" id="2112315">ok</span>&nbsp;<span class="op" id="2112318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2112322">return</span>&nbsp;<span class="ident" id="2112329">val</span><span class="op" id="2112332">,</span>&nbsp;<span class="ident" id="2112334">nil</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2112339">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2112343">if</span>&nbsp;<span class="ident" id="2112346">optimize</span>&nbsp;<span class="op" id="2112355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2112359">//&nbsp;Parse&nbsp;mantissa&nbsp;and&nbsp;exponent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2112393">mantissa</span><span class="op" id="2112401">,</span>&nbsp;<span class="ident" id="2112403">exp</span><span class="op" id="2112406">,</span>&nbsp;<span class="ident" id="2112408">neg</span><span class="op" id="2112411">,</span>&nbsp;<span class="ident" id="2112413">trunc</span><span class="op" id="2112418">,</span>&nbsp;<span class="ident" id="2112420">ok</span>&nbsp;<span class="op" id="2112423">:=</span>&nbsp;<span class="ident" id="2112426">readFloat</span><span class="op" id="2112435">(</span><span class="ident" id="2112436">s</span><span class="op" id="2112437">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2112441">if</span>&nbsp;<span class="ident" id="2112444">ok</span>&nbsp;<span class="op" id="2112447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2112452">//&nbsp;Try&nbsp;pure&nbsp;floating-point&nbsp;arithmetic&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2112505">if</span>&nbsp;<span class="op" id="2112508">!</span><span class="ident" id="2112509">trunc</span>&nbsp;<span class="op" id="2112515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2112521">if</span>&nbsp;<span class="ident" id="2112524">f</span><span class="op" id="2112525">,</span>&nbsp;<span class="ident" id="2112527">ok</span>&nbsp;<span class="op" id="2112530">:=</span>&nbsp;<span class="ident" id="2112533">atof64exact</span><span class="op" id="2112544">(</span><span class="ident" id="2112545">mantissa</span><span class="op" id="2112553">,</span>&nbsp;<span class="ident" id="2112555">exp</span><span class="op" id="2112558">,</span>&nbsp;<span class="ident" id="2112560">neg</span><span class="op" id="2112563">)</span><span class="op" id="2112564">;</span>&nbsp;<span class="ident" id="2112566">ok</span>&nbsp;<span class="op" id="2112569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2112576">return</span>&nbsp;<span class="ident" id="2112583">f</span><span class="op" id="2112584">,</span>&nbsp;<span class="ident" id="2112586">nil</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2112594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2112599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2112604">//&nbsp;Try&nbsp;another&nbsp;fast&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2112633">ext</span>&nbsp;<span class="op" id="2112637">:=</span>&nbsp;<span class="builtinfunc" id="2112640">new</span><span class="op" id="2112643">(</span><span class="ident" id="2112644">extFloat</span><span class="op" id="2112652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2112657">if</span>&nbsp;<span class="ident" id="2112660">ok</span>&nbsp;<span class="op" id="2112663">:=</span>&nbsp;<span class="ident" id="2112666">ext</span><span class="op" id="2112669">.</span><span class="ident" id="2112670">AssignDecimal</span><span class="op" id="2112683">(</span><span class="ident" id="2112684">mantissa</span><span class="op" id="2112692">,</span>&nbsp;<span class="ident" id="2112694">exp</span><span class="op" id="2112697">,</span>&nbsp;<span class="ident" id="2112699">neg</span><span class="op" id="2112702">,</span>&nbsp;<span class="ident" id="2112704">trunc</span><span class="op" id="2112709">,</span>&nbsp;<span class="op" id="2112711">&amp;</span><span class="ident" id="2112712">float64info</span><span class="op" id="2112723">)</span><span class="op" id="2112724">;</span>&nbsp;<span class="ident" id="2112726">ok</span>&nbsp;<span class="op" id="2112729">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2112735">b</span><span class="op" id="2112736">,</span>&nbsp;<span class="ident" id="2112738">ovf</span>&nbsp;<span class="op" id="2112742">:=</span>&nbsp;<span class="ident" id="2112745">ext</span><span class="op" id="2112748">.</span><span class="ident" id="2112749">floatBits</span><span class="op" id="2112758">(</span><span class="op" id="2112759">&amp;</span><span class="ident" id="2112760">float64info</span><span class="op" id="2112771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2112777">f</span>&nbsp;<span class="op" id="2112779">=</span>&nbsp;<span class="ident" id="2112781">math</span><span class="op" id="2112785">.</span><span class="ident" id="2112786">Float64frombits</span><span class="op" id="2112801">(</span><span class="ident" id="2112802">b</span><span class="op" id="2112803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2112809">if</span>&nbsp;<span class="ident" id="2112812">ovf</span>&nbsp;<span class="op" id="2112816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2112823">err</span>&nbsp;<span class="op" id="2112827">=</span>&nbsp;<span class="ident" id="2112829">rangeError</span><span class="op" id="2112839">(</span><span class="ident" id="2112840">fnParseFloat</span><span class="op" id="2112852">,</span>&nbsp;<span class="ident" id="2112854">s</span><span class="op" id="2112855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2112861">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2112867">return</span>&nbsp;<span class="ident" id="2112874">f</span><span class="op" id="2112875">,</span>&nbsp;<span class="ident" id="2112877">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2112884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2112888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2112891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2112894">var</span>&nbsp;<span class="ident" id="2112898">d</span>&nbsp;<span class="ident" id="2112900">decimal</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2112909">if</span>&nbsp;<span class="op" id="2112912">!</span><span class="ident" id="2112913">d</span><span class="op" id="2112914">.</span><span class="ident" id="2112915">set</span><span class="op" id="2112918">(</span><span class="ident" id="2112919">s</span><span class="op" id="2112920">)</span>&nbsp;<span class="op" id="2112922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2112926">return</span>&nbsp;<span class="num" id="2112933">0</span><span class="op" id="2112934">,</span>&nbsp;<span class="ident" id="2112936">syntaxError</span><span class="op" id="2112947">(</span><span class="ident" id="2112948">fnParseFloat</span><span class="op" id="2112960">,</span>&nbsp;<span class="ident" id="2112962">s</span><span class="op" id="2112963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2112966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2112969">b</span><span class="op" id="2112970">,</span>&nbsp;<span class="ident" id="2112972">ovf</span>&nbsp;<span class="op" id="2112976">:=</span>&nbsp;<span class="ident" id="2112979">d</span><span class="op" id="2112980">.</span><span class="ident" id="2112981">floatBits</span><span class="op" id="2112990">(</span><span class="op" id="2112991">&amp;</span><span class="ident" id="2112992">float64info</span><span class="op" id="2113003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2113006">f</span>&nbsp;<span class="op" id="2113008">=</span>&nbsp;<span class="ident" id="2113010">math</span><span class="op" id="2113014">.</span><span class="ident" id="2113015">Float64frombits</span><span class="op" id="2113030">(</span><span class="ident" id="2113031">b</span><span class="op" id="2113032">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2113035">if</span>&nbsp;<span class="ident" id="2113038">ovf</span>&nbsp;<span class="op" id="2113042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2113046">err</span>&nbsp;<span class="op" id="2113050">=</span>&nbsp;<span class="ident" id="2113052">rangeError</span><span class="op" id="2113062">(</span><span class="ident" id="2113063">fnParseFloat</span><span class="op" id="2113075">,</span>&nbsp;<span class="ident" id="2113077">s</span><span class="op" id="2113078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2113081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2113084">return</span>&nbsp;<span class="ident" id="2113091">f</span><span class="op" id="2113092">,</span>&nbsp;<span class="ident" id="2113094">err</span><br>
<span class="lineno"></span><span class="op" id="2113098">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span><span class="comment" id="2113101">//&nbsp;ParseFloat&nbsp;converts&nbsp;the&nbsp;string&nbsp;s&nbsp;to&nbsp;a&nbsp;floating-point&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="2113164">//&nbsp;with&nbsp;the&nbsp;precision&nbsp;specified&nbsp;by&nbsp;bitSize:&nbsp;32&nbsp;for&nbsp;float32,&nbsp;or&nbsp;64&nbsp;for&nbsp;float64.</span><br>
<span class="lineno"></span><span class="comment" id="2113243">//&nbsp;When&nbsp;bitSize=32,&nbsp;the&nbsp;result&nbsp;still&nbsp;has&nbsp;type&nbsp;float64,&nbsp;but&nbsp;it&nbsp;will&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2113313">//&nbsp;convertible&nbsp;to&nbsp;float32&nbsp;without&nbsp;changing&nbsp;its&nbsp;value.</span><br>
<span class="lineno">520</span><span class="comment" id="2113367">//</span><br>
<span class="lineno"></span><span class="comment" id="2113370">//&nbsp;If&nbsp;s&nbsp;is&nbsp;well-formed&nbsp;and&nbsp;near&nbsp;a&nbsp;valid&nbsp;floating&nbsp;point&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="2113433">//&nbsp;ParseFloat&nbsp;returns&nbsp;the&nbsp;nearest&nbsp;floating&nbsp;point&nbsp;number&nbsp;rounded</span><br>
<span class="lineno"></span><span class="comment" id="2113497">//&nbsp;using&nbsp;IEEE754&nbsp;unbiased&nbsp;rounding.</span><br>
<span class="lineno"></span><span class="comment" id="2113533">//</span><br>
<span class="lineno">525</span><span class="comment" id="2113536">//&nbsp;The&nbsp;errors&nbsp;that&nbsp;ParseFloat&nbsp;returns&nbsp;have&nbsp;concrete&nbsp;type&nbsp;*NumError</span><br>
<span class="lineno"></span><span class="comment" id="2113603">//&nbsp;and&nbsp;include&nbsp;err.Num&nbsp;=&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="2113631">//</span><br>
<span class="lineno"></span><span class="comment" id="2113634">//&nbsp;If&nbsp;s&nbsp;is&nbsp;not&nbsp;syntactically&nbsp;well-formed,&nbsp;ParseFloat&nbsp;returns&nbsp;err.Err&nbsp;=&nbsp;ErrSyntax.</span><br>
<span class="lineno"></span><span class="comment" id="2113716">//</span><br>
<span class="lineno">530</span><span class="comment" id="2113719">//&nbsp;If&nbsp;s&nbsp;is&nbsp;syntactically&nbsp;well-formed&nbsp;but&nbsp;is&nbsp;more&nbsp;than&nbsp;1/2&nbsp;ULP</span><br>
<span class="lineno"></span><span class="comment" id="2113781">//&nbsp;away&nbsp;from&nbsp;the&nbsp;largest&nbsp;floating&nbsp;point&nbsp;number&nbsp;of&nbsp;the&nbsp;given&nbsp;size,</span><br>
<span class="lineno"></span><span class="comment" id="2113847">//&nbsp;ParseFloat&nbsp;returns&nbsp;f&nbsp;=&nbsp;±Inf,&nbsp;err.Err&nbsp;=&nbsp;ErrRange.</span><br>
<span class="lineno"></span><span class="keyword" id="2113900">func</span>&nbsp;<span class="ident" id="2113905">ParseFloat</span><span class="op" id="2113915">(</span><span class="ident" id="2113916">s</span>&nbsp;<span class="builtintype" id="2113918">string</span><span class="op" id="2113924">,</span>&nbsp;<span class="ident" id="2113926">bitSize</span>&nbsp;<span class="builtintype" id="2113934">int</span><span class="op" id="2113937">)</span>&nbsp;<span class="op" id="2113939">(</span><span class="ident" id="2113940">f</span>&nbsp;<span class="builtintype" id="2113942">float64</span><span class="op" id="2113949">,</span>&nbsp;<span class="ident" id="2113951">err</span>&nbsp;<span class="builtintype" id="2113955">error</span><span class="op" id="2113960">)</span>&nbsp;<span class="op" id="2113962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2113965">if</span>&nbsp;<span class="ident" id="2113968">bitSize</span>&nbsp;<span class="op" id="2113976">==</span>&nbsp;<span class="num" id="2113979">32</span>&nbsp;<span class="op" id="2113982">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2113986">f1</span><span class="op" id="2113988">,</span>&nbsp;<span class="ident" id="2113990">err1</span>&nbsp;<span class="op" id="2113995">:=</span>&nbsp;<span class="ident" id="2113998">atof32</span><span class="op" id="2114004">(</span><span class="ident" id="2114005">s</span><span class="op" id="2114006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2114010">return</span>&nbsp;<span class="builtintype" id="2114017">float64</span><span class="op" id="2114024">(</span><span class="ident" id="2114025">f1</span><span class="op" id="2114027">)</span><span class="op" id="2114028">,</span>&nbsp;<span class="ident" id="2114030">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2114036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2114039">f1</span><span class="op" id="2114041">,</span>&nbsp;<span class="ident" id="2114043">err1</span>&nbsp;<span class="op" id="2114048">:=</span>&nbsp;<span class="ident" id="2114051">atof64</span><span class="op" id="2114057">(</span><span class="ident" id="2114058">s</span><span class="op" id="2114059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2114062">return</span>&nbsp;<span class="ident" id="2114069">f1</span><span class="op" id="2114071">,</span>&nbsp;<span class="ident" id="2114073">err1</span><br>
<span class="lineno">540</span><span class="op" id="2114078">}</span>
</div>
</body>
</html>
