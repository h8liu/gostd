<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html" class="current">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3215140">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3215195">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3215249">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3215300">//&nbsp;DNS&nbsp;packet&nbsp;assembly.&nbsp;&nbsp;See&nbsp;RFC&nbsp;1035.</span><br>
<span class="lineno"></span><span class="comment" id="3215339">//</span><br>
<span class="lineno"></span><span class="comment" id="3215342">//&nbsp;This&nbsp;is&nbsp;intended&nbsp;to&nbsp;support&nbsp;name&nbsp;resolution&nbsp;during&nbsp;Dial.</span><br>
<span class="lineno"></span><span class="comment" id="3215402">//&nbsp;It&nbsp;doesn&#39;t&nbsp;have&nbsp;to&nbsp;be&nbsp;blazing&nbsp;fast.</span><br>
<span class="lineno"></span><span class="comment" id="3215441">//</span><br>
<span class="lineno">10</span><span class="comment" id="3215444">//&nbsp;Each&nbsp;message&nbsp;structure&nbsp;has&nbsp;a&nbsp;Walk&nbsp;method&nbsp;that&nbsp;is&nbsp;used&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3215504">//&nbsp;a&nbsp;generic&nbsp;pack/unpack&nbsp;routine.&nbsp;Thus,&nbsp;if&nbsp;in&nbsp;the&nbsp;future&nbsp;we&nbsp;need</span><br>
<span class="lineno"></span><span class="comment" id="3215569">//&nbsp;to&nbsp;define&nbsp;new&nbsp;message&nbsp;structs,&nbsp;no&nbsp;new&nbsp;pack/unpack/printing&nbsp;code</span><br>
<span class="lineno"></span><span class="comment" id="3215636">//&nbsp;needs&nbsp;to&nbsp;be&nbsp;written.</span><br>
<span class="lineno"></span><span class="comment" id="3215660">//</span><br>
<span class="lineno">15</span><span class="comment" id="3215663">//&nbsp;The&nbsp;first&nbsp;half&nbsp;of&nbsp;this&nbsp;file&nbsp;defines&nbsp;the&nbsp;DNS&nbsp;message&nbsp;formats.</span><br>
<span class="lineno"></span><span class="comment" id="3215727">//&nbsp;The&nbsp;second&nbsp;half&nbsp;implements&nbsp;the&nbsp;conversion&nbsp;to&nbsp;and&nbsp;from&nbsp;wire&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="3215797">//&nbsp;A&nbsp;few&nbsp;of&nbsp;the&nbsp;structure&nbsp;elements&nbsp;have&nbsp;string&nbsp;tags&nbsp;to&nbsp;aid&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3215860">//&nbsp;generic&nbsp;pack/unpack&nbsp;routines.</span><br>
<span class="lineno"></span><span class="comment" id="3215893">//</span><br>
<span class="lineno">20</span><span class="comment" id="3215896">//&nbsp;TODO(rsc):&nbsp;&nbsp;There&nbsp;are&nbsp;enough&nbsp;names&nbsp;defined&nbsp;in&nbsp;this&nbsp;file&nbsp;that&nbsp;they&#39;re&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3215972">//&nbsp;prefixed&nbsp;with&nbsp;dns.&nbsp;&nbsp;Perhaps&nbsp;put&nbsp;this&nbsp;in&nbsp;its&nbsp;own&nbsp;package&nbsp;later.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3216039">package</span>&nbsp;<span class="ident" id="3216047">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="3216052">//&nbsp;Packet&nbsp;formats</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3216071">//&nbsp;Wire&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="3216090">const</span>&nbsp;<span class="op" id="3216096">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3216099">//&nbsp;valid&nbsp;dnsRR_Header.Rrtype&nbsp;and&nbsp;dnsQuestion.qtype</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216151">dnsTypeA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3216164">=</span>&nbsp;<span class="num" id="3216166">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216169">dnsTypeNS</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3216182">=</span>&nbsp;<span class="num" id="3216184">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216187">dnsTypeMD</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3216200">=</span>&nbsp;<span class="num" id="3216202">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216205">dnsTypeMF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3216218">=</span>&nbsp;<span class="num" id="3216220">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216223">dnsTypeCNAME</span>&nbsp;<span class="op" id="3216236">=</span>&nbsp;<span class="num" id="3216238">5</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216241">dnsTypeSOA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3216254">=</span>&nbsp;<span class="num" id="3216256">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216259">dnsTypeMB</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3216272">=</span>&nbsp;<span class="num" id="3216274">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216277">dnsTypeMG</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3216290">=</span>&nbsp;<span class="num" id="3216292">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216295">dnsTypeMR</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3216308">=</span>&nbsp;<span class="num" id="3216310">9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216313">dnsTypeNULL</span>&nbsp;&nbsp;<span class="op" id="3216326">=</span>&nbsp;<span class="num" id="3216328">10</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216332">dnsTypeWKS</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3216345">=</span>&nbsp;<span class="num" id="3216347">11</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216351">dnsTypePTR</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3216364">=</span>&nbsp;<span class="num" id="3216366">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216370">dnsTypeHINFO</span>&nbsp;<span class="op" id="3216383">=</span>&nbsp;<span class="num" id="3216385">13</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216389">dnsTypeMINFO</span>&nbsp;<span class="op" id="3216402">=</span>&nbsp;<span class="num" id="3216404">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216408">dnsTypeMX</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3216421">=</span>&nbsp;<span class="num" id="3216423">15</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216427">dnsTypeTXT</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3216440">=</span>&nbsp;<span class="num" id="3216442">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216446">dnsTypeAAAA</span>&nbsp;&nbsp;<span class="op" id="3216459">=</span>&nbsp;<span class="num" id="3216461">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216465">dnsTypeSRV</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3216478">=</span>&nbsp;<span class="num" id="3216480">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3216485">//&nbsp;valid&nbsp;dnsQuestion.qtype&nbsp;only</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216518">dnsTypeAXFR</span>&nbsp;&nbsp;<span class="op" id="3216531">=</span>&nbsp;<span class="num" id="3216533">252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216538">dnsTypeMAILB</span>&nbsp;<span class="op" id="3216551">=</span>&nbsp;<span class="num" id="3216553">253</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216558">dnsTypeMAILA</span>&nbsp;<span class="op" id="3216571">=</span>&nbsp;<span class="num" id="3216573">254</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216578">dnsTypeALL</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3216591">=</span>&nbsp;<span class="num" id="3216593">255</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3216599">//&nbsp;valid&nbsp;dnsQuestion.qclass</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216628">dnsClassINET</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3216643">=</span>&nbsp;<span class="num" id="3216645">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216648">dnsClassCSNET</span>&nbsp;&nbsp;<span class="op" id="3216663">=</span>&nbsp;<span class="num" id="3216665">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216668">dnsClassCHAOS</span>&nbsp;&nbsp;<span class="op" id="3216683">=</span>&nbsp;<span class="num" id="3216685">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216688">dnsClassHESIOD</span>&nbsp;<span class="op" id="3216703">=</span>&nbsp;<span class="num" id="3216705">4</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216708">dnsClassANY</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3216723">=</span>&nbsp;<span class="num" id="3216725">255</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3216731">//&nbsp;dnsMsg.rcode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216748">dnsRcodeSuccess</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3216771">=</span>&nbsp;<span class="num" id="3216773">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216776">dnsRcodeFormatError</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3216799">=</span>&nbsp;<span class="num" id="3216801">1</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216804">dnsRcodeServerFailure</span>&nbsp;&nbsp;<span class="op" id="3216827">=</span>&nbsp;<span class="num" id="3216829">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216832">dnsRcodeNameError</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3216855">=</span>&nbsp;<span class="num" id="3216857">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216860">dnsRcodeNotImplemented</span>&nbsp;<span class="op" id="3216883">=</span>&nbsp;<span class="num" id="3216885">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3216888">dnsRcodeRefused</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3216911">=</span>&nbsp;<span class="num" id="3216913">5</span><br>
<span class="lineno"></span><span class="op" id="3216915">)</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="3216918">//&nbsp;A&nbsp;dnsStruct&nbsp;describes&nbsp;how&nbsp;to&nbsp;iterate&nbsp;over&nbsp;its&nbsp;fields&nbsp;to&nbsp;emulate</span><br>
<span class="lineno"></span><span class="comment" id="3216985">//&nbsp;reflective&nbsp;marshalling.</span><br>
<span class="lineno"></span><span class="keyword" id="3217012">type</span>&nbsp;<span class="ident" id="3217017">dnsStruct</span>&nbsp;<span class="keyword" id="3217027">interface</span>&nbsp;<span class="op" id="3217037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3217040">//&nbsp;Walk&nbsp;iterates&nbsp;over&nbsp;fields&nbsp;of&nbsp;a&nbsp;structure&nbsp;and&nbsp;calls&nbsp;f</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3217097">//&nbsp;with&nbsp;a&nbsp;reference&nbsp;to&nbsp;that&nbsp;field,&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3217155">//&nbsp;and&nbsp;a&nbsp;tag&nbsp;(&#34;&#34;,&nbsp;&#34;domain&#34;,&nbsp;&#34;ipv4&#34;,&nbsp;&#34;ipv6&#34;)&nbsp;specifying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3217211">//&nbsp;particular&nbsp;encodings.&nbsp;Possible&nbsp;concrete&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3217261">//&nbsp;for&nbsp;v&nbsp;are&nbsp;*uint16,&nbsp;*uint32,&nbsp;*string,&nbsp;or&nbsp;[]byte,&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3217317">//&nbsp;*int,&nbsp;*bool&nbsp;in&nbsp;the&nbsp;case&nbsp;of&nbsp;dnsMsgHdr.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3217359">//&nbsp;Whenever&nbsp;f&nbsp;returns&nbsp;false,&nbsp;Walk&nbsp;must&nbsp;stop&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3217415">//&nbsp;false,&nbsp;and&nbsp;otherwise&nbsp;return&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3217453">Walk</span><span class="op" id="3217457">(</span><span class="ident" id="3217458">f</span>&nbsp;<span class="keyword" id="3217460">func</span><span class="op" id="3217464">(</span><span class="ident" id="3217465">v</span>&nbsp;<span class="keyword" id="3217467">interface</span><span class="op" id="3217476">{</span><span class="op" id="3217477">}</span><span class="op" id="3217478">,</span>&nbsp;<span class="ident" id="3217480">name</span><span class="op" id="3217484">,</span>&nbsp;<span class="ident" id="3217486">tag</span>&nbsp;<span class="builtintype" id="3217490">string</span><span class="op" id="3217496">)</span>&nbsp;<span class="op" id="3217498">(</span><span class="ident" id="3217499">ok</span>&nbsp;<span class="builtintype" id="3217502">bool</span><span class="op" id="3217506">)</span><span class="op" id="3217507">)</span>&nbsp;<span class="op" id="3217509">(</span><span class="ident" id="3217510">ok</span>&nbsp;<span class="builtintype" id="3217513">bool</span><span class="op" id="3217517">)</span><br>
<span class="lineno"></span><span class="op" id="3217519">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="3217522">//&nbsp;The&nbsp;wire&nbsp;format&nbsp;for&nbsp;the&nbsp;DNS&nbsp;packet&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="3217568">type</span>&nbsp;<span class="ident" id="3217573">dnsHeader</span>&nbsp;<span class="keyword" id="3217583">struct</span>&nbsp;<span class="op" id="3217590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3217593">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3217628">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3217636">Bits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3217671">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3217679">Qdcount</span><span class="op" id="3217686">,</span>&nbsp;<span class="ident" id="3217688">Ancount</span><span class="op" id="3217695">,</span>&nbsp;<span class="ident" id="3217697">Nscount</span><span class="op" id="3217704">,</span>&nbsp;<span class="ident" id="3217706">Arcount</span>&nbsp;<span class="builtintype" id="3217714">uint16</span><br>
<span class="lineno">90</span><span class="op" id="3217721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3217724">func</span>&nbsp;<span class="op" id="3217729">(</span><span class="ident" id="3217730">h</span>&nbsp;<span class="op" id="3217732">*</span><span class="ident" id="3217733">dnsHeader</span><span class="op" id="3217742">)</span>&nbsp;<span class="ident" id="3217744">Walk</span><span class="op" id="3217748">(</span><span class="ident" id="3217749">f</span>&nbsp;<span class="keyword" id="3217751">func</span><span class="op" id="3217755">(</span><span class="ident" id="3217756">v</span>&nbsp;<span class="keyword" id="3217758">interface</span><span class="op" id="3217767">{</span><span class="op" id="3217768">}</span><span class="op" id="3217769">,</span>&nbsp;<span class="ident" id="3217771">name</span><span class="op" id="3217775">,</span>&nbsp;<span class="ident" id="3217777">tag</span>&nbsp;<span class="builtintype" id="3217781">string</span><span class="op" id="3217787">)</span>&nbsp;<span class="builtintype" id="3217789">bool</span><span class="op" id="3217793">)</span>&nbsp;<span class="builtintype" id="3217795">bool</span>&nbsp;<span class="op" id="3217800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3217803">return</span>&nbsp;<span class="ident" id="3217810">f</span><span class="op" id="3217811">(</span><span class="op" id="3217812">&amp;</span><span class="ident" id="3217813">h</span><span class="op" id="3217814">.</span><span class="ident" id="3217815">Id</span><span class="op" id="3217817">,</span>&nbsp;<span class="string" id="3217819">&#34;Id&#34;</span><span class="op" id="3217823">,</span>&nbsp;<span class="string" id="3217825">&#34;&#34;</span><span class="op" id="3217827">)</span>&nbsp;<span class="op" id="3217829">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3217834">f</span><span class="op" id="3217835">(</span><span class="op" id="3217836">&amp;</span><span class="ident" id="3217837">h</span><span class="op" id="3217838">.</span><span class="ident" id="3217839">Bits</span><span class="op" id="3217843">,</span>&nbsp;<span class="string" id="3217845">&#34;Bits&#34;</span><span class="op" id="3217851">,</span>&nbsp;<span class="string" id="3217853">&#34;&#34;</span><span class="op" id="3217855">)</span>&nbsp;<span class="op" id="3217857">&amp;&amp;</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3217862">f</span><span class="op" id="3217863">(</span><span class="op" id="3217864">&amp;</span><span class="ident" id="3217865">h</span><span class="op" id="3217866">.</span><span class="ident" id="3217867">Qdcount</span><span class="op" id="3217874">,</span>&nbsp;<span class="string" id="3217876">&#34;Qdcount&#34;</span><span class="op" id="3217885">,</span>&nbsp;<span class="string" id="3217887">&#34;&#34;</span><span class="op" id="3217889">)</span>&nbsp;<span class="op" id="3217891">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3217896">f</span><span class="op" id="3217897">(</span><span class="op" id="3217898">&amp;</span><span class="ident" id="3217899">h</span><span class="op" id="3217900">.</span><span class="ident" id="3217901">Ancount</span><span class="op" id="3217908">,</span>&nbsp;<span class="string" id="3217910">&#34;Ancount&#34;</span><span class="op" id="3217919">,</span>&nbsp;<span class="string" id="3217921">&#34;&#34;</span><span class="op" id="3217923">)</span>&nbsp;<span class="op" id="3217925">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3217930">f</span><span class="op" id="3217931">(</span><span class="op" id="3217932">&amp;</span><span class="ident" id="3217933">h</span><span class="op" id="3217934">.</span><span class="ident" id="3217935">Nscount</span><span class="op" id="3217942">,</span>&nbsp;<span class="string" id="3217944">&#34;Nscount&#34;</span><span class="op" id="3217953">,</span>&nbsp;<span class="string" id="3217955">&#34;&#34;</span><span class="op" id="3217957">)</span>&nbsp;<span class="op" id="3217959">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3217964">f</span><span class="op" id="3217965">(</span><span class="op" id="3217966">&amp;</span><span class="ident" id="3217967">h</span><span class="op" id="3217968">.</span><span class="ident" id="3217969">Arcount</span><span class="op" id="3217976">,</span>&nbsp;<span class="string" id="3217978">&#34;Arcount&#34;</span><span class="op" id="3217987">,</span>&nbsp;<span class="string" id="3217989">&#34;&#34;</span><span class="op" id="3217991">)</span><br>
<span class="lineno"></span><span class="op" id="3217993">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="3217996">const</span>&nbsp;<span class="op" id="3218002">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3218005">//&nbsp;dnsHeader.Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3218024">_QR</span>&nbsp;<span class="op" id="3218028">=</span>&nbsp;<span class="num" id="3218030">1</span>&nbsp;<span class="op" id="3218032">&lt;&lt;</span>&nbsp;<span class="num" id="3218035">15</span>&nbsp;<span class="comment" id="3218038">//&nbsp;query/response&nbsp;(response=1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3218070">_AA</span>&nbsp;<span class="op" id="3218074">=</span>&nbsp;<span class="num" id="3218076">1</span>&nbsp;<span class="op" id="3218078">&lt;&lt;</span>&nbsp;<span class="num" id="3218081">10</span>&nbsp;<span class="comment" id="3218084">//&nbsp;authoritative</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3218102">_TC</span>&nbsp;<span class="op" id="3218106">=</span>&nbsp;<span class="num" id="3218108">1</span>&nbsp;<span class="op" id="3218110">&lt;&lt;</span>&nbsp;<span class="num" id="3218113">9</span>&nbsp;&nbsp;<span class="comment" id="3218116">//&nbsp;truncated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3218130">_RD</span>&nbsp;<span class="op" id="3218134">=</span>&nbsp;<span class="num" id="3218136">1</span>&nbsp;<span class="op" id="3218138">&lt;&lt;</span>&nbsp;<span class="num" id="3218141">8</span>&nbsp;&nbsp;<span class="comment" id="3218144">//&nbsp;recursion&nbsp;desired</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3218166">_RA</span>&nbsp;<span class="op" id="3218170">=</span>&nbsp;<span class="num" id="3218172">1</span>&nbsp;<span class="op" id="3218174">&lt;&lt;</span>&nbsp;<span class="num" id="3218177">7</span>&nbsp;&nbsp;<span class="comment" id="3218180">//&nbsp;recursion&nbsp;available</span><br>
<span class="lineno"></span><span class="op" id="3218203">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="3218206">//&nbsp;DNS&nbsp;queries.</span><br>
<span class="lineno"></span><span class="keyword" id="3218222">type</span>&nbsp;<span class="ident" id="3218227">dnsQuestion</span>&nbsp;<span class="keyword" id="3218239">struct</span>&nbsp;<span class="op" id="3218246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3218249">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3218256">string</span>&nbsp;<span class="string" id="3218263">`net:&#34;domain-name&#34;`</span>&nbsp;<span class="comment" id="3218283">//&nbsp;`net:&#34;domain-name&#34;`&nbsp;specifies&nbsp;encoding;&nbsp;see&nbsp;packers&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3218345">Qtype</span>&nbsp;&nbsp;<span class="builtintype" id="3218352">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3218360">Qclass</span>&nbsp;<span class="builtintype" id="3218367">uint16</span><br>
<span class="lineno">115</span><span class="op" id="3218374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3218377">func</span>&nbsp;<span class="op" id="3218382">(</span><span class="ident" id="3218383">q</span>&nbsp;<span class="op" id="3218385">*</span><span class="ident" id="3218386">dnsQuestion</span><span class="op" id="3218397">)</span>&nbsp;<span class="ident" id="3218399">Walk</span><span class="op" id="3218403">(</span><span class="ident" id="3218404">f</span>&nbsp;<span class="keyword" id="3218406">func</span><span class="op" id="3218410">(</span><span class="ident" id="3218411">v</span>&nbsp;<span class="keyword" id="3218413">interface</span><span class="op" id="3218422">{</span><span class="op" id="3218423">}</span><span class="op" id="3218424">,</span>&nbsp;<span class="ident" id="3218426">name</span><span class="op" id="3218430">,</span>&nbsp;<span class="ident" id="3218432">tag</span>&nbsp;<span class="builtintype" id="3218436">string</span><span class="op" id="3218442">)</span>&nbsp;<span class="builtintype" id="3218444">bool</span><span class="op" id="3218448">)</span>&nbsp;<span class="builtintype" id="3218450">bool</span>&nbsp;<span class="op" id="3218455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3218458">return</span>&nbsp;<span class="ident" id="3218465">f</span><span class="op" id="3218466">(</span><span class="op" id="3218467">&amp;</span><span class="ident" id="3218468">q</span><span class="op" id="3218469">.</span><span class="ident" id="3218470">Name</span><span class="op" id="3218474">,</span>&nbsp;<span class="string" id="3218476">&#34;Name&#34;</span><span class="op" id="3218482">,</span>&nbsp;<span class="string" id="3218484">&#34;domain&#34;</span><span class="op" id="3218492">)</span>&nbsp;<span class="op" id="3218494">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3218499">f</span><span class="op" id="3218500">(</span><span class="op" id="3218501">&amp;</span><span class="ident" id="3218502">q</span><span class="op" id="3218503">.</span><span class="ident" id="3218504">Qtype</span><span class="op" id="3218509">,</span>&nbsp;<span class="string" id="3218511">&#34;Qtype&#34;</span><span class="op" id="3218518">,</span>&nbsp;<span class="string" id="3218520">&#34;&#34;</span><span class="op" id="3218522">)</span>&nbsp;<span class="op" id="3218524">&amp;&amp;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3218529">f</span><span class="op" id="3218530">(</span><span class="op" id="3218531">&amp;</span><span class="ident" id="3218532">q</span><span class="op" id="3218533">.</span><span class="ident" id="3218534">Qclass</span><span class="op" id="3218540">,</span>&nbsp;<span class="string" id="3218542">&#34;Qclass&#34;</span><span class="op" id="3218550">,</span>&nbsp;<span class="string" id="3218552">&#34;&#34;</span><span class="op" id="3218554">)</span><br>
<span class="lineno"></span><span class="op" id="3218556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3218559">//&nbsp;DNS&nbsp;responses&nbsp;(resource&nbsp;records).</span><br>
<span class="lineno"></span><span class="comment" id="3218596">//&nbsp;There&nbsp;are&nbsp;many&nbsp;types&nbsp;of&nbsp;messages,</span><br>
<span class="lineno">125</span><span class="comment" id="3218633">//&nbsp;but&nbsp;they&nbsp;all&nbsp;share&nbsp;the&nbsp;same&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="3218672">type</span>&nbsp;<span class="ident" id="3218677">dnsRR_Header</span>&nbsp;<span class="keyword" id="3218690">struct</span>&nbsp;<span class="op" id="3218697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3218700">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3218709">string</span>&nbsp;<span class="string" id="3218716">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3218737">Rrtype</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3218746">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3218754">Class</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3218763">uint16</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3218771">Ttl</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3218780">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3218788">Rdlength</span>&nbsp;<span class="builtintype" id="3218797">uint16</span>&nbsp;<span class="comment" id="3218804">//&nbsp;length&nbsp;of&nbsp;data&nbsp;after&nbsp;header</span><br>
<span class="lineno"></span><span class="op" id="3218835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3218838">func</span>&nbsp;<span class="op" id="3218843">(</span><span class="ident" id="3218844">h</span>&nbsp;<span class="op" id="3218846">*</span><span class="ident" id="3218847">dnsRR_Header</span><span class="op" id="3218859">)</span>&nbsp;<span class="ident" id="3218861">Header</span><span class="op" id="3218867">(</span><span class="op" id="3218868">)</span>&nbsp;<span class="op" id="3218870">*</span><span class="ident" id="3218871">dnsRR_Header</span>&nbsp;<span class="op" id="3218884">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3218887">return</span>&nbsp;<span class="ident" id="3218894">h</span><br>
<span class="lineno"></span><span class="op" id="3218896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3218899">func</span>&nbsp;<span class="op" id="3218904">(</span><span class="ident" id="3218905">h</span>&nbsp;<span class="op" id="3218907">*</span><span class="ident" id="3218908">dnsRR_Header</span><span class="op" id="3218920">)</span>&nbsp;<span class="ident" id="3218922">Walk</span><span class="op" id="3218926">(</span><span class="ident" id="3218927">f</span>&nbsp;<span class="keyword" id="3218929">func</span><span class="op" id="3218933">(</span><span class="ident" id="3218934">v</span>&nbsp;<span class="keyword" id="3218936">interface</span><span class="op" id="3218945">{</span><span class="op" id="3218946">}</span><span class="op" id="3218947">,</span>&nbsp;<span class="ident" id="3218949">name</span><span class="op" id="3218953">,</span>&nbsp;<span class="ident" id="3218955">tag</span>&nbsp;<span class="builtintype" id="3218959">string</span><span class="op" id="3218965">)</span>&nbsp;<span class="builtintype" id="3218967">bool</span><span class="op" id="3218971">)</span>&nbsp;<span class="builtintype" id="3218973">bool</span>&nbsp;<span class="op" id="3218978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3218981">return</span>&nbsp;<span class="ident" id="3218988">f</span><span class="op" id="3218989">(</span><span class="op" id="3218990">&amp;</span><span class="ident" id="3218991">h</span><span class="op" id="3218992">.</span><span class="ident" id="3218993">Name</span><span class="op" id="3218997">,</span>&nbsp;<span class="string" id="3218999">&#34;Name&#34;</span><span class="op" id="3219005">,</span>&nbsp;<span class="string" id="3219007">&#34;domain&#34;</span><span class="op" id="3219015">)</span>&nbsp;<span class="op" id="3219017">&amp;&amp;</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3219022">f</span><span class="op" id="3219023">(</span><span class="op" id="3219024">&amp;</span><span class="ident" id="3219025">h</span><span class="op" id="3219026">.</span><span class="ident" id="3219027">Rrtype</span><span class="op" id="3219033">,</span>&nbsp;<span class="string" id="3219035">&#34;Rrtype&#34;</span><span class="op" id="3219043">,</span>&nbsp;<span class="string" id="3219045">&#34;&#34;</span><span class="op" id="3219047">)</span>&nbsp;<span class="op" id="3219049">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3219054">f</span><span class="op" id="3219055">(</span><span class="op" id="3219056">&amp;</span><span class="ident" id="3219057">h</span><span class="op" id="3219058">.</span><span class="ident" id="3219059">Class</span><span class="op" id="3219064">,</span>&nbsp;<span class="string" id="3219066">&#34;Class&#34;</span><span class="op" id="3219073">,</span>&nbsp;<span class="string" id="3219075">&#34;&#34;</span><span class="op" id="3219077">)</span>&nbsp;<span class="op" id="3219079">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3219084">f</span><span class="op" id="3219085">(</span><span class="op" id="3219086">&amp;</span><span class="ident" id="3219087">h</span><span class="op" id="3219088">.</span><span class="ident" id="3219089">Ttl</span><span class="op" id="3219092">,</span>&nbsp;<span class="string" id="3219094">&#34;Ttl&#34;</span><span class="op" id="3219099">,</span>&nbsp;<span class="string" id="3219101">&#34;&#34;</span><span class="op" id="3219103">)</span>&nbsp;<span class="op" id="3219105">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3219110">f</span><span class="op" id="3219111">(</span><span class="op" id="3219112">&amp;</span><span class="ident" id="3219113">h</span><span class="op" id="3219114">.</span><span class="ident" id="3219115">Rdlength</span><span class="op" id="3219123">,</span>&nbsp;<span class="string" id="3219125">&#34;Rdlength&#34;</span><span class="op" id="3219135">,</span>&nbsp;<span class="string" id="3219137">&#34;&#34;</span><span class="op" id="3219139">)</span><br>
<span class="lineno"></span><span class="op" id="3219141">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="keyword" id="3219144">type</span>&nbsp;<span class="ident" id="3219149">dnsRR</span>&nbsp;<span class="keyword" id="3219155">interface</span>&nbsp;<span class="op" id="3219165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3219168">dnsStruct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3219179">Header</span><span class="op" id="3219185">(</span><span class="op" id="3219186">)</span>&nbsp;<span class="op" id="3219188">*</span><span class="ident" id="3219189">dnsRR_Header</span><br>
<span class="lineno"></span><span class="op" id="3219202">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="comment" id="3219205">//&nbsp;Specific&nbsp;DNS&nbsp;RR&nbsp;formats&nbsp;for&nbsp;each&nbsp;query&nbsp;type.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3219254">type</span>&nbsp;<span class="ident" id="3219259">dnsRR_CNAME</span>&nbsp;<span class="keyword" id="3219271">struct</span>&nbsp;<span class="op" id="3219278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3219281">Hdr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3219287">dnsRR_Header</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3219301">Cname</span>&nbsp;<span class="builtintype" id="3219307">string</span>&nbsp;<span class="string" id="3219314">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3219334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3219337">func</span>&nbsp;<span class="op" id="3219342">(</span><span class="ident" id="3219343">rr</span>&nbsp;<span class="op" id="3219346">*</span><span class="ident" id="3219347">dnsRR_CNAME</span><span class="op" id="3219358">)</span>&nbsp;<span class="ident" id="3219360">Header</span><span class="op" id="3219366">(</span><span class="op" id="3219367">)</span>&nbsp;<span class="op" id="3219369">*</span><span class="ident" id="3219370">dnsRR_Header</span>&nbsp;<span class="op" id="3219383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3219386">return</span>&nbsp;<span class="op" id="3219393">&amp;</span><span class="ident" id="3219394">rr</span><span class="op" id="3219396">.</span><span class="ident" id="3219397">Hdr</span><br>
<span class="lineno">160</span><span class="op" id="3219401">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3219404">func</span>&nbsp;<span class="op" id="3219409">(</span><span class="ident" id="3219410">rr</span>&nbsp;<span class="op" id="3219413">*</span><span class="ident" id="3219414">dnsRR_CNAME</span><span class="op" id="3219425">)</span>&nbsp;<span class="ident" id="3219427">Walk</span><span class="op" id="3219431">(</span><span class="ident" id="3219432">f</span>&nbsp;<span class="keyword" id="3219434">func</span><span class="op" id="3219438">(</span><span class="ident" id="3219439">v</span>&nbsp;<span class="keyword" id="3219441">interface</span><span class="op" id="3219450">{</span><span class="op" id="3219451">}</span><span class="op" id="3219452">,</span>&nbsp;<span class="ident" id="3219454">name</span><span class="op" id="3219458">,</span>&nbsp;<span class="ident" id="3219460">tag</span>&nbsp;<span class="builtintype" id="3219464">string</span><span class="op" id="3219470">)</span>&nbsp;<span class="builtintype" id="3219472">bool</span><span class="op" id="3219476">)</span>&nbsp;<span class="builtintype" id="3219478">bool</span>&nbsp;<span class="op" id="3219483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3219486">return</span>&nbsp;<span class="ident" id="3219493">rr</span><span class="op" id="3219495">.</span><span class="ident" id="3219496">Hdr</span><span class="op" id="3219499">.</span><span class="ident" id="3219500">Walk</span><span class="op" id="3219504">(</span><span class="ident" id="3219505">f</span><span class="op" id="3219506">)</span>&nbsp;<span class="op" id="3219508">&amp;&amp;</span>&nbsp;<span class="ident" id="3219511">f</span><span class="op" id="3219512">(</span><span class="op" id="3219513">&amp;</span><span class="ident" id="3219514">rr</span><span class="op" id="3219516">.</span><span class="ident" id="3219517">Cname</span><span class="op" id="3219522">,</span>&nbsp;<span class="string" id="3219524">&#34;Cname&#34;</span><span class="op" id="3219531">,</span>&nbsp;<span class="string" id="3219533">&#34;domain&#34;</span><span class="op" id="3219541">)</span><br>
<span class="lineno"></span><span class="op" id="3219543">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="3219546">type</span>&nbsp;<span class="ident" id="3219551">dnsRR_HINFO</span>&nbsp;<span class="keyword" id="3219563">struct</span>&nbsp;<span class="op" id="3219570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3219573">Hdr</span>&nbsp;<span class="ident" id="3219577">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3219591">Cpu</span>&nbsp;<span class="builtintype" id="3219595">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3219603">Os</span>&nbsp;&nbsp;<span class="builtintype" id="3219607">string</span><br>
<span class="lineno">170</span><span class="op" id="3219614">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3219617">func</span>&nbsp;<span class="op" id="3219622">(</span><span class="ident" id="3219623">rr</span>&nbsp;<span class="op" id="3219626">*</span><span class="ident" id="3219627">dnsRR_HINFO</span><span class="op" id="3219638">)</span>&nbsp;<span class="ident" id="3219640">Header</span><span class="op" id="3219646">(</span><span class="op" id="3219647">)</span>&nbsp;<span class="op" id="3219649">*</span><span class="ident" id="3219650">dnsRR_Header</span>&nbsp;<span class="op" id="3219663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3219666">return</span>&nbsp;<span class="op" id="3219673">&amp;</span><span class="ident" id="3219674">rr</span><span class="op" id="3219676">.</span><span class="ident" id="3219677">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3219681">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="3219684">func</span>&nbsp;<span class="op" id="3219689">(</span><span class="ident" id="3219690">rr</span>&nbsp;<span class="op" id="3219693">*</span><span class="ident" id="3219694">dnsRR_HINFO</span><span class="op" id="3219705">)</span>&nbsp;<span class="ident" id="3219707">Walk</span><span class="op" id="3219711">(</span><span class="ident" id="3219712">f</span>&nbsp;<span class="keyword" id="3219714">func</span><span class="op" id="3219718">(</span><span class="ident" id="3219719">v</span>&nbsp;<span class="keyword" id="3219721">interface</span><span class="op" id="3219730">{</span><span class="op" id="3219731">}</span><span class="op" id="3219732">,</span>&nbsp;<span class="ident" id="3219734">name</span><span class="op" id="3219738">,</span>&nbsp;<span class="ident" id="3219740">tag</span>&nbsp;<span class="builtintype" id="3219744">string</span><span class="op" id="3219750">)</span>&nbsp;<span class="builtintype" id="3219752">bool</span><span class="op" id="3219756">)</span>&nbsp;<span class="builtintype" id="3219758">bool</span>&nbsp;<span class="op" id="3219763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3219766">return</span>&nbsp;<span class="ident" id="3219773">rr</span><span class="op" id="3219775">.</span><span class="ident" id="3219776">Hdr</span><span class="op" id="3219779">.</span><span class="ident" id="3219780">Walk</span><span class="op" id="3219784">(</span><span class="ident" id="3219785">f</span><span class="op" id="3219786">)</span>&nbsp;<span class="op" id="3219788">&amp;&amp;</span>&nbsp;<span class="ident" id="3219791">f</span><span class="op" id="3219792">(</span><span class="op" id="3219793">&amp;</span><span class="ident" id="3219794">rr</span><span class="op" id="3219796">.</span><span class="ident" id="3219797">Cpu</span><span class="op" id="3219800">,</span>&nbsp;<span class="string" id="3219802">&#34;Cpu&#34;</span><span class="op" id="3219807">,</span>&nbsp;<span class="string" id="3219809">&#34;&#34;</span><span class="op" id="3219811">)</span>&nbsp;<span class="op" id="3219813">&amp;&amp;</span>&nbsp;<span class="ident" id="3219816">f</span><span class="op" id="3219817">(</span><span class="op" id="3219818">&amp;</span><span class="ident" id="3219819">rr</span><span class="op" id="3219821">.</span><span class="ident" id="3219822">Os</span><span class="op" id="3219824">,</span>&nbsp;<span class="string" id="3219826">&#34;Os&#34;</span><span class="op" id="3219830">,</span>&nbsp;<span class="string" id="3219832">&#34;&#34;</span><span class="op" id="3219834">)</span><br>
<span class="lineno"></span><span class="op" id="3219836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="3219839">type</span>&nbsp;<span class="ident" id="3219844">dnsRR_MB</span>&nbsp;<span class="keyword" id="3219853">struct</span>&nbsp;<span class="op" id="3219860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3219863">Hdr</span>&nbsp;<span class="ident" id="3219867">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3219881">Mb</span>&nbsp;&nbsp;<span class="builtintype" id="3219885">string</span>&nbsp;<span class="string" id="3219892">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3219912">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="3219915">func</span>&nbsp;<span class="op" id="3219920">(</span><span class="ident" id="3219921">rr</span>&nbsp;<span class="op" id="3219924">*</span><span class="ident" id="3219925">dnsRR_MB</span><span class="op" id="3219933">)</span>&nbsp;<span class="ident" id="3219935">Header</span><span class="op" id="3219941">(</span><span class="op" id="3219942">)</span>&nbsp;<span class="op" id="3219944">*</span><span class="ident" id="3219945">dnsRR_Header</span>&nbsp;<span class="op" id="3219958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3219961">return</span>&nbsp;<span class="op" id="3219968">&amp;</span><span class="ident" id="3219969">rr</span><span class="op" id="3219971">.</span><span class="ident" id="3219972">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3219976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3219979">func</span>&nbsp;<span class="op" id="3219984">(</span><span class="ident" id="3219985">rr</span>&nbsp;<span class="op" id="3219988">*</span><span class="ident" id="3219989">dnsRR_MB</span><span class="op" id="3219997">)</span>&nbsp;<span class="ident" id="3219999">Walk</span><span class="op" id="3220003">(</span><span class="ident" id="3220004">f</span>&nbsp;<span class="keyword" id="3220006">func</span><span class="op" id="3220010">(</span><span class="ident" id="3220011">v</span>&nbsp;<span class="keyword" id="3220013">interface</span><span class="op" id="3220022">{</span><span class="op" id="3220023">}</span><span class="op" id="3220024">,</span>&nbsp;<span class="ident" id="3220026">name</span><span class="op" id="3220030">,</span>&nbsp;<span class="ident" id="3220032">tag</span>&nbsp;<span class="builtintype" id="3220036">string</span><span class="op" id="3220042">)</span>&nbsp;<span class="builtintype" id="3220044">bool</span><span class="op" id="3220048">)</span>&nbsp;<span class="builtintype" id="3220050">bool</span>&nbsp;<span class="op" id="3220055">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3220058">return</span>&nbsp;<span class="ident" id="3220065">rr</span><span class="op" id="3220067">.</span><span class="ident" id="3220068">Hdr</span><span class="op" id="3220071">.</span><span class="ident" id="3220072">Walk</span><span class="op" id="3220076">(</span><span class="ident" id="3220077">f</span><span class="op" id="3220078">)</span>&nbsp;<span class="op" id="3220080">&amp;&amp;</span>&nbsp;<span class="ident" id="3220083">f</span><span class="op" id="3220084">(</span><span class="op" id="3220085">&amp;</span><span class="ident" id="3220086">rr</span><span class="op" id="3220088">.</span><span class="ident" id="3220089">Mb</span><span class="op" id="3220091">,</span>&nbsp;<span class="string" id="3220093">&#34;Mb&#34;</span><span class="op" id="3220097">,</span>&nbsp;<span class="string" id="3220099">&#34;domain&#34;</span><span class="op" id="3220107">)</span><br>
<span class="lineno"></span><span class="op" id="3220109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3220112">type</span>&nbsp;<span class="ident" id="3220117">dnsRR_MG</span>&nbsp;<span class="keyword" id="3220126">struct</span>&nbsp;<span class="op" id="3220133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3220136">Hdr</span>&nbsp;<span class="ident" id="3220140">dnsRR_Header</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3220154">Mg</span>&nbsp;&nbsp;<span class="builtintype" id="3220158">string</span>&nbsp;<span class="string" id="3220165">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3220185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3220188">func</span>&nbsp;<span class="op" id="3220193">(</span><span class="ident" id="3220194">rr</span>&nbsp;<span class="op" id="3220197">*</span><span class="ident" id="3220198">dnsRR_MG</span><span class="op" id="3220206">)</span>&nbsp;<span class="ident" id="3220208">Header</span><span class="op" id="3220214">(</span><span class="op" id="3220215">)</span>&nbsp;<span class="op" id="3220217">*</span><span class="ident" id="3220218">dnsRR_Header</span>&nbsp;<span class="op" id="3220231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3220234">return</span>&nbsp;<span class="op" id="3220241">&amp;</span><span class="ident" id="3220242">rr</span><span class="op" id="3220244">.</span><span class="ident" id="3220245">Hdr</span><br>
<span class="lineno">200</span><span class="op" id="3220249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3220252">func</span>&nbsp;<span class="op" id="3220257">(</span><span class="ident" id="3220258">rr</span>&nbsp;<span class="op" id="3220261">*</span><span class="ident" id="3220262">dnsRR_MG</span><span class="op" id="3220270">)</span>&nbsp;<span class="ident" id="3220272">Walk</span><span class="op" id="3220276">(</span><span class="ident" id="3220277">f</span>&nbsp;<span class="keyword" id="3220279">func</span><span class="op" id="3220283">(</span><span class="ident" id="3220284">v</span>&nbsp;<span class="keyword" id="3220286">interface</span><span class="op" id="3220295">{</span><span class="op" id="3220296">}</span><span class="op" id="3220297">,</span>&nbsp;<span class="ident" id="3220299">name</span><span class="op" id="3220303">,</span>&nbsp;<span class="ident" id="3220305">tag</span>&nbsp;<span class="builtintype" id="3220309">string</span><span class="op" id="3220315">)</span>&nbsp;<span class="builtintype" id="3220317">bool</span><span class="op" id="3220321">)</span>&nbsp;<span class="builtintype" id="3220323">bool</span>&nbsp;<span class="op" id="3220328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3220331">return</span>&nbsp;<span class="ident" id="3220338">rr</span><span class="op" id="3220340">.</span><span class="ident" id="3220341">Hdr</span><span class="op" id="3220344">.</span><span class="ident" id="3220345">Walk</span><span class="op" id="3220349">(</span><span class="ident" id="3220350">f</span><span class="op" id="3220351">)</span>&nbsp;<span class="op" id="3220353">&amp;&amp;</span>&nbsp;<span class="ident" id="3220356">f</span><span class="op" id="3220357">(</span><span class="op" id="3220358">&amp;</span><span class="ident" id="3220359">rr</span><span class="op" id="3220361">.</span><span class="ident" id="3220362">Mg</span><span class="op" id="3220364">,</span>&nbsp;<span class="string" id="3220366">&#34;Mg&#34;</span><span class="op" id="3220370">,</span>&nbsp;<span class="string" id="3220372">&#34;domain&#34;</span><span class="op" id="3220380">)</span><br>
<span class="lineno"></span><span class="op" id="3220382">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="3220385">type</span>&nbsp;<span class="ident" id="3220390">dnsRR_MINFO</span>&nbsp;<span class="keyword" id="3220402">struct</span>&nbsp;<span class="op" id="3220409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3220412">Hdr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3220418">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3220432">Rmail</span>&nbsp;<span class="builtintype" id="3220438">string</span>&nbsp;<span class="string" id="3220445">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3220466">Email</span>&nbsp;<span class="builtintype" id="3220472">string</span>&nbsp;<span class="string" id="3220479">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno">210</span><span class="op" id="3220499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3220502">func</span>&nbsp;<span class="op" id="3220507">(</span><span class="ident" id="3220508">rr</span>&nbsp;<span class="op" id="3220511">*</span><span class="ident" id="3220512">dnsRR_MINFO</span><span class="op" id="3220523">)</span>&nbsp;<span class="ident" id="3220525">Header</span><span class="op" id="3220531">(</span><span class="op" id="3220532">)</span>&nbsp;<span class="op" id="3220534">*</span><span class="ident" id="3220535">dnsRR_Header</span>&nbsp;<span class="op" id="3220548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3220551">return</span>&nbsp;<span class="op" id="3220558">&amp;</span><span class="ident" id="3220559">rr</span><span class="op" id="3220561">.</span><span class="ident" id="3220562">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3220566">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="3220569">func</span>&nbsp;<span class="op" id="3220574">(</span><span class="ident" id="3220575">rr</span>&nbsp;<span class="op" id="3220578">*</span><span class="ident" id="3220579">dnsRR_MINFO</span><span class="op" id="3220590">)</span>&nbsp;<span class="ident" id="3220592">Walk</span><span class="op" id="3220596">(</span><span class="ident" id="3220597">f</span>&nbsp;<span class="keyword" id="3220599">func</span><span class="op" id="3220603">(</span><span class="ident" id="3220604">v</span>&nbsp;<span class="keyword" id="3220606">interface</span><span class="op" id="3220615">{</span><span class="op" id="3220616">}</span><span class="op" id="3220617">,</span>&nbsp;<span class="ident" id="3220619">name</span><span class="op" id="3220623">,</span>&nbsp;<span class="ident" id="3220625">tag</span>&nbsp;<span class="builtintype" id="3220629">string</span><span class="op" id="3220635">)</span>&nbsp;<span class="builtintype" id="3220637">bool</span><span class="op" id="3220641">)</span>&nbsp;<span class="builtintype" id="3220643">bool</span>&nbsp;<span class="op" id="3220648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3220651">return</span>&nbsp;<span class="ident" id="3220658">rr</span><span class="op" id="3220660">.</span><span class="ident" id="3220661">Hdr</span><span class="op" id="3220664">.</span><span class="ident" id="3220665">Walk</span><span class="op" id="3220669">(</span><span class="ident" id="3220670">f</span><span class="op" id="3220671">)</span>&nbsp;<span class="op" id="3220673">&amp;&amp;</span>&nbsp;<span class="ident" id="3220676">f</span><span class="op" id="3220677">(</span><span class="op" id="3220678">&amp;</span><span class="ident" id="3220679">rr</span><span class="op" id="3220681">.</span><span class="ident" id="3220682">Rmail</span><span class="op" id="3220687">,</span>&nbsp;<span class="string" id="3220689">&#34;Rmail&#34;</span><span class="op" id="3220696">,</span>&nbsp;<span class="string" id="3220698">&#34;domain&#34;</span><span class="op" id="3220706">)</span>&nbsp;<span class="op" id="3220708">&amp;&amp;</span>&nbsp;<span class="ident" id="3220711">f</span><span class="op" id="3220712">(</span><span class="op" id="3220713">&amp;</span><span class="ident" id="3220714">rr</span><span class="op" id="3220716">.</span><span class="ident" id="3220717">Email</span><span class="op" id="3220722">,</span>&nbsp;<span class="string" id="3220724">&#34;Email&#34;</span><span class="op" id="3220731">,</span>&nbsp;<span class="string" id="3220733">&#34;domain&#34;</span><span class="op" id="3220741">)</span><br>
<span class="lineno"></span><span class="op" id="3220743">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="3220746">type</span>&nbsp;<span class="ident" id="3220751">dnsRR_MR</span>&nbsp;<span class="keyword" id="3220760">struct</span>&nbsp;<span class="op" id="3220767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3220770">Hdr</span>&nbsp;<span class="ident" id="3220774">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3220788">Mr</span>&nbsp;&nbsp;<span class="builtintype" id="3220792">string</span>&nbsp;<span class="string" id="3220799">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3220819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="3220822">func</span>&nbsp;<span class="op" id="3220827">(</span><span class="ident" id="3220828">rr</span>&nbsp;<span class="op" id="3220831">*</span><span class="ident" id="3220832">dnsRR_MR</span><span class="op" id="3220840">)</span>&nbsp;<span class="ident" id="3220842">Header</span><span class="op" id="3220848">(</span><span class="op" id="3220849">)</span>&nbsp;<span class="op" id="3220851">*</span><span class="ident" id="3220852">dnsRR_Header</span>&nbsp;<span class="op" id="3220865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3220868">return</span>&nbsp;<span class="op" id="3220875">&amp;</span><span class="ident" id="3220876">rr</span><span class="op" id="3220878">.</span><span class="ident" id="3220879">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3220883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3220886">func</span>&nbsp;<span class="op" id="3220891">(</span><span class="ident" id="3220892">rr</span>&nbsp;<span class="op" id="3220895">*</span><span class="ident" id="3220896">dnsRR_MR</span><span class="op" id="3220904">)</span>&nbsp;<span class="ident" id="3220906">Walk</span><span class="op" id="3220910">(</span><span class="ident" id="3220911">f</span>&nbsp;<span class="keyword" id="3220913">func</span><span class="op" id="3220917">(</span><span class="ident" id="3220918">v</span>&nbsp;<span class="keyword" id="3220920">interface</span><span class="op" id="3220929">{</span><span class="op" id="3220930">}</span><span class="op" id="3220931">,</span>&nbsp;<span class="ident" id="3220933">name</span><span class="op" id="3220937">,</span>&nbsp;<span class="ident" id="3220939">tag</span>&nbsp;<span class="builtintype" id="3220943">string</span><span class="op" id="3220949">)</span>&nbsp;<span class="builtintype" id="3220951">bool</span><span class="op" id="3220955">)</span>&nbsp;<span class="builtintype" id="3220957">bool</span>&nbsp;<span class="op" id="3220962">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3220965">return</span>&nbsp;<span class="ident" id="3220972">rr</span><span class="op" id="3220974">.</span><span class="ident" id="3220975">Hdr</span><span class="op" id="3220978">.</span><span class="ident" id="3220979">Walk</span><span class="op" id="3220983">(</span><span class="ident" id="3220984">f</span><span class="op" id="3220985">)</span>&nbsp;<span class="op" id="3220987">&amp;&amp;</span>&nbsp;<span class="ident" id="3220990">f</span><span class="op" id="3220991">(</span><span class="op" id="3220992">&amp;</span><span class="ident" id="3220993">rr</span><span class="op" id="3220995">.</span><span class="ident" id="3220996">Mr</span><span class="op" id="3220998">,</span>&nbsp;<span class="string" id="3221000">&#34;Mr&#34;</span><span class="op" id="3221004">,</span>&nbsp;<span class="string" id="3221006">&#34;domain&#34;</span><span class="op" id="3221014">)</span><br>
<span class="lineno"></span><span class="op" id="3221016">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3221019">type</span>&nbsp;<span class="ident" id="3221024">dnsRR_MX</span>&nbsp;<span class="keyword" id="3221033">struct</span>&nbsp;<span class="op" id="3221040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3221043">Hdr</span>&nbsp;&nbsp;<span class="ident" id="3221048">dnsRR_Header</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3221062">Pref</span>&nbsp;<span class="builtintype" id="3221067">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3221075">Mx</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3221080">string</span>&nbsp;<span class="string" id="3221087">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3221107">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3221110">func</span>&nbsp;<span class="op" id="3221115">(</span><span class="ident" id="3221116">rr</span>&nbsp;<span class="op" id="3221119">*</span><span class="ident" id="3221120">dnsRR_MX</span><span class="op" id="3221128">)</span>&nbsp;<span class="ident" id="3221130">Header</span><span class="op" id="3221136">(</span><span class="op" id="3221137">)</span>&nbsp;<span class="op" id="3221139">*</span><span class="ident" id="3221140">dnsRR_Header</span>&nbsp;<span class="op" id="3221153">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3221156">return</span>&nbsp;<span class="op" id="3221163">&amp;</span><span class="ident" id="3221164">rr</span><span class="op" id="3221166">.</span><span class="ident" id="3221167">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3221171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3221174">func</span>&nbsp;<span class="op" id="3221179">(</span><span class="ident" id="3221180">rr</span>&nbsp;<span class="op" id="3221183">*</span><span class="ident" id="3221184">dnsRR_MX</span><span class="op" id="3221192">)</span>&nbsp;<span class="ident" id="3221194">Walk</span><span class="op" id="3221198">(</span><span class="ident" id="3221199">f</span>&nbsp;<span class="keyword" id="3221201">func</span><span class="op" id="3221205">(</span><span class="ident" id="3221206">v</span>&nbsp;<span class="keyword" id="3221208">interface</span><span class="op" id="3221217">{</span><span class="op" id="3221218">}</span><span class="op" id="3221219">,</span>&nbsp;<span class="ident" id="3221221">name</span><span class="op" id="3221225">,</span>&nbsp;<span class="ident" id="3221227">tag</span>&nbsp;<span class="builtintype" id="3221231">string</span><span class="op" id="3221237">)</span>&nbsp;<span class="builtintype" id="3221239">bool</span><span class="op" id="3221243">)</span>&nbsp;<span class="builtintype" id="3221245">bool</span>&nbsp;<span class="op" id="3221250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3221253">return</span>&nbsp;<span class="ident" id="3221260">rr</span><span class="op" id="3221262">.</span><span class="ident" id="3221263">Hdr</span><span class="op" id="3221266">.</span><span class="ident" id="3221267">Walk</span><span class="op" id="3221271">(</span><span class="ident" id="3221272">f</span><span class="op" id="3221273">)</span>&nbsp;<span class="op" id="3221275">&amp;&amp;</span>&nbsp;<span class="ident" id="3221278">f</span><span class="op" id="3221279">(</span><span class="op" id="3221280">&amp;</span><span class="ident" id="3221281">rr</span><span class="op" id="3221283">.</span><span class="ident" id="3221284">Pref</span><span class="op" id="3221288">,</span>&nbsp;<span class="string" id="3221290">&#34;Pref&#34;</span><span class="op" id="3221296">,</span>&nbsp;<span class="string" id="3221298">&#34;&#34;</span><span class="op" id="3221300">)</span>&nbsp;<span class="op" id="3221302">&amp;&amp;</span>&nbsp;<span class="ident" id="3221305">f</span><span class="op" id="3221306">(</span><span class="op" id="3221307">&amp;</span><span class="ident" id="3221308">rr</span><span class="op" id="3221310">.</span><span class="ident" id="3221311">Mx</span><span class="op" id="3221313">,</span>&nbsp;<span class="string" id="3221315">&#34;Mx&#34;</span><span class="op" id="3221319">,</span>&nbsp;<span class="string" id="3221321">&#34;domain&#34;</span><span class="op" id="3221329">)</span><br>
<span class="lineno">245</span><span class="op" id="3221331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3221334">type</span>&nbsp;<span class="ident" id="3221339">dnsRR_NS</span>&nbsp;<span class="keyword" id="3221348">struct</span>&nbsp;<span class="op" id="3221355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3221358">Hdr</span>&nbsp;<span class="ident" id="3221362">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3221376">Ns</span>&nbsp;&nbsp;<span class="builtintype" id="3221380">string</span>&nbsp;<span class="string" id="3221387">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno">250</span><span class="op" id="3221407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3221410">func</span>&nbsp;<span class="op" id="3221415">(</span><span class="ident" id="3221416">rr</span>&nbsp;<span class="op" id="3221419">*</span><span class="ident" id="3221420">dnsRR_NS</span><span class="op" id="3221428">)</span>&nbsp;<span class="ident" id="3221430">Header</span><span class="op" id="3221436">(</span><span class="op" id="3221437">)</span>&nbsp;<span class="op" id="3221439">*</span><span class="ident" id="3221440">dnsRR_Header</span>&nbsp;<span class="op" id="3221453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3221456">return</span>&nbsp;<span class="op" id="3221463">&amp;</span><span class="ident" id="3221464">rr</span><span class="op" id="3221466">.</span><span class="ident" id="3221467">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3221471">}</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span><span class="keyword" id="3221474">func</span>&nbsp;<span class="op" id="3221479">(</span><span class="ident" id="3221480">rr</span>&nbsp;<span class="op" id="3221483">*</span><span class="ident" id="3221484">dnsRR_NS</span><span class="op" id="3221492">)</span>&nbsp;<span class="ident" id="3221494">Walk</span><span class="op" id="3221498">(</span><span class="ident" id="3221499">f</span>&nbsp;<span class="keyword" id="3221501">func</span><span class="op" id="3221505">(</span><span class="ident" id="3221506">v</span>&nbsp;<span class="keyword" id="3221508">interface</span><span class="op" id="3221517">{</span><span class="op" id="3221518">}</span><span class="op" id="3221519">,</span>&nbsp;<span class="ident" id="3221521">name</span><span class="op" id="3221525">,</span>&nbsp;<span class="ident" id="3221527">tag</span>&nbsp;<span class="builtintype" id="3221531">string</span><span class="op" id="3221537">)</span>&nbsp;<span class="builtintype" id="3221539">bool</span><span class="op" id="3221543">)</span>&nbsp;<span class="builtintype" id="3221545">bool</span>&nbsp;<span class="op" id="3221550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3221553">return</span>&nbsp;<span class="ident" id="3221560">rr</span><span class="op" id="3221562">.</span><span class="ident" id="3221563">Hdr</span><span class="op" id="3221566">.</span><span class="ident" id="3221567">Walk</span><span class="op" id="3221571">(</span><span class="ident" id="3221572">f</span><span class="op" id="3221573">)</span>&nbsp;<span class="op" id="3221575">&amp;&amp;</span>&nbsp;<span class="ident" id="3221578">f</span><span class="op" id="3221579">(</span><span class="op" id="3221580">&amp;</span><span class="ident" id="3221581">rr</span><span class="op" id="3221583">.</span><span class="ident" id="3221584">Ns</span><span class="op" id="3221586">,</span>&nbsp;<span class="string" id="3221588">&#34;Ns&#34;</span><span class="op" id="3221592">,</span>&nbsp;<span class="string" id="3221594">&#34;domain&#34;</span><span class="op" id="3221602">)</span><br>
<span class="lineno"></span><span class="op" id="3221604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="3221607">type</span>&nbsp;<span class="ident" id="3221612">dnsRR_PTR</span>&nbsp;<span class="keyword" id="3221622">struct</span>&nbsp;<span class="op" id="3221629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3221632">Hdr</span>&nbsp;<span class="ident" id="3221636">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3221650">Ptr</span>&nbsp;<span class="builtintype" id="3221654">string</span>&nbsp;<span class="string" id="3221661">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3221681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="3221684">func</span>&nbsp;<span class="op" id="3221689">(</span><span class="ident" id="3221690">rr</span>&nbsp;<span class="op" id="3221693">*</span><span class="ident" id="3221694">dnsRR_PTR</span><span class="op" id="3221703">)</span>&nbsp;<span class="ident" id="3221705">Header</span><span class="op" id="3221711">(</span><span class="op" id="3221712">)</span>&nbsp;<span class="op" id="3221714">*</span><span class="ident" id="3221715">dnsRR_Header</span>&nbsp;<span class="op" id="3221728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3221731">return</span>&nbsp;<span class="op" id="3221738">&amp;</span><span class="ident" id="3221739">rr</span><span class="op" id="3221741">.</span><span class="ident" id="3221742">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3221746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3221749">func</span>&nbsp;<span class="op" id="3221754">(</span><span class="ident" id="3221755">rr</span>&nbsp;<span class="op" id="3221758">*</span><span class="ident" id="3221759">dnsRR_PTR</span><span class="op" id="3221768">)</span>&nbsp;<span class="ident" id="3221770">Walk</span><span class="op" id="3221774">(</span><span class="ident" id="3221775">f</span>&nbsp;<span class="keyword" id="3221777">func</span><span class="op" id="3221781">(</span><span class="ident" id="3221782">v</span>&nbsp;<span class="keyword" id="3221784">interface</span><span class="op" id="3221793">{</span><span class="op" id="3221794">}</span><span class="op" id="3221795">,</span>&nbsp;<span class="ident" id="3221797">name</span><span class="op" id="3221801">,</span>&nbsp;<span class="ident" id="3221803">tag</span>&nbsp;<span class="builtintype" id="3221807">string</span><span class="op" id="3221813">)</span>&nbsp;<span class="builtintype" id="3221815">bool</span><span class="op" id="3221819">)</span>&nbsp;<span class="builtintype" id="3221821">bool</span>&nbsp;<span class="op" id="3221826">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3221829">return</span>&nbsp;<span class="ident" id="3221836">rr</span><span class="op" id="3221838">.</span><span class="ident" id="3221839">Hdr</span><span class="op" id="3221842">.</span><span class="ident" id="3221843">Walk</span><span class="op" id="3221847">(</span><span class="ident" id="3221848">f</span><span class="op" id="3221849">)</span>&nbsp;<span class="op" id="3221851">&amp;&amp;</span>&nbsp;<span class="ident" id="3221854">f</span><span class="op" id="3221855">(</span><span class="op" id="3221856">&amp;</span><span class="ident" id="3221857">rr</span><span class="op" id="3221859">.</span><span class="ident" id="3221860">Ptr</span><span class="op" id="3221863">,</span>&nbsp;<span class="string" id="3221865">&#34;Ptr&#34;</span><span class="op" id="3221870">,</span>&nbsp;<span class="string" id="3221872">&#34;domain&#34;</span><span class="op" id="3221880">)</span><br>
<span class="lineno"></span><span class="op" id="3221882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3221885">type</span>&nbsp;<span class="ident" id="3221890">dnsRR_SOA</span>&nbsp;<span class="keyword" id="3221900">struct</span>&nbsp;<span class="op" id="3221907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3221910">Hdr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3221918">dnsRR_Header</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3221932">Ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3221940">string</span>&nbsp;<span class="string" id="3221947">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3221968">Mbox</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3221976">string</span>&nbsp;<span class="string" id="3221983">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3222004">Serial</span>&nbsp;&nbsp;<span class="builtintype" id="3222012">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3222020">Refresh</span>&nbsp;<span class="builtintype" id="3222028">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3222036">Retry</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3222044">uint32</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3222052">Expire</span>&nbsp;&nbsp;<span class="builtintype" id="3222060">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3222068">Minttl</span>&nbsp;&nbsp;<span class="builtintype" id="3222076">uint32</span><br>
<span class="lineno"></span><span class="op" id="3222083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3222086">func</span>&nbsp;<span class="op" id="3222091">(</span><span class="ident" id="3222092">rr</span>&nbsp;<span class="op" id="3222095">*</span><span class="ident" id="3222096">dnsRR_SOA</span><span class="op" id="3222105">)</span>&nbsp;<span class="ident" id="3222107">Header</span><span class="op" id="3222113">(</span><span class="op" id="3222114">)</span>&nbsp;<span class="op" id="3222116">*</span><span class="ident" id="3222117">dnsRR_Header</span>&nbsp;<span class="op" id="3222130">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3222133">return</span>&nbsp;<span class="op" id="3222140">&amp;</span><span class="ident" id="3222141">rr</span><span class="op" id="3222143">.</span><span class="ident" id="3222144">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3222148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3222151">func</span>&nbsp;<span class="op" id="3222156">(</span><span class="ident" id="3222157">rr</span>&nbsp;<span class="op" id="3222160">*</span><span class="ident" id="3222161">dnsRR_SOA</span><span class="op" id="3222170">)</span>&nbsp;<span class="ident" id="3222172">Walk</span><span class="op" id="3222176">(</span><span class="ident" id="3222177">f</span>&nbsp;<span class="keyword" id="3222179">func</span><span class="op" id="3222183">(</span><span class="ident" id="3222184">v</span>&nbsp;<span class="keyword" id="3222186">interface</span><span class="op" id="3222195">{</span><span class="op" id="3222196">}</span><span class="op" id="3222197">,</span>&nbsp;<span class="ident" id="3222199">name</span><span class="op" id="3222203">,</span>&nbsp;<span class="ident" id="3222205">tag</span>&nbsp;<span class="builtintype" id="3222209">string</span><span class="op" id="3222215">)</span>&nbsp;<span class="builtintype" id="3222217">bool</span><span class="op" id="3222221">)</span>&nbsp;<span class="builtintype" id="3222223">bool</span>&nbsp;<span class="op" id="3222228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3222231">return</span>&nbsp;<span class="ident" id="3222238">rr</span><span class="op" id="3222240">.</span><span class="ident" id="3222241">Hdr</span><span class="op" id="3222244">.</span><span class="ident" id="3222245">Walk</span><span class="op" id="3222249">(</span><span class="ident" id="3222250">f</span><span class="op" id="3222251">)</span>&nbsp;<span class="op" id="3222253">&amp;&amp;</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3222258">f</span><span class="op" id="3222259">(</span><span class="op" id="3222260">&amp;</span><span class="ident" id="3222261">rr</span><span class="op" id="3222263">.</span><span class="ident" id="3222264">Ns</span><span class="op" id="3222266">,</span>&nbsp;<span class="string" id="3222268">&#34;Ns&#34;</span><span class="op" id="3222272">,</span>&nbsp;<span class="string" id="3222274">&#34;domain&#34;</span><span class="op" id="3222282">)</span>&nbsp;<span class="op" id="3222284">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3222289">f</span><span class="op" id="3222290">(</span><span class="op" id="3222291">&amp;</span><span class="ident" id="3222292">rr</span><span class="op" id="3222294">.</span><span class="ident" id="3222295">Mbox</span><span class="op" id="3222299">,</span>&nbsp;<span class="string" id="3222301">&#34;Mbox&#34;</span><span class="op" id="3222307">,</span>&nbsp;<span class="string" id="3222309">&#34;domain&#34;</span><span class="op" id="3222317">)</span>&nbsp;<span class="op" id="3222319">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3222324">f</span><span class="op" id="3222325">(</span><span class="op" id="3222326">&amp;</span><span class="ident" id="3222327">rr</span><span class="op" id="3222329">.</span><span class="ident" id="3222330">Serial</span><span class="op" id="3222336">,</span>&nbsp;<span class="string" id="3222338">&#34;Serial&#34;</span><span class="op" id="3222346">,</span>&nbsp;<span class="string" id="3222348">&#34;&#34;</span><span class="op" id="3222350">)</span>&nbsp;<span class="op" id="3222352">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3222357">f</span><span class="op" id="3222358">(</span><span class="op" id="3222359">&amp;</span><span class="ident" id="3222360">rr</span><span class="op" id="3222362">.</span><span class="ident" id="3222363">Refresh</span><span class="op" id="3222370">,</span>&nbsp;<span class="string" id="3222372">&#34;Refresh&#34;</span><span class="op" id="3222381">,</span>&nbsp;<span class="string" id="3222383">&#34;&#34;</span><span class="op" id="3222385">)</span>&nbsp;<span class="op" id="3222387">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3222392">f</span><span class="op" id="3222393">(</span><span class="op" id="3222394">&amp;</span><span class="ident" id="3222395">rr</span><span class="op" id="3222397">.</span><span class="ident" id="3222398">Retry</span><span class="op" id="3222403">,</span>&nbsp;<span class="string" id="3222405">&#34;Retry&#34;</span><span class="op" id="3222412">,</span>&nbsp;<span class="string" id="3222414">&#34;&#34;</span><span class="op" id="3222416">)</span>&nbsp;<span class="op" id="3222418">&amp;&amp;</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3222423">f</span><span class="op" id="3222424">(</span><span class="op" id="3222425">&amp;</span><span class="ident" id="3222426">rr</span><span class="op" id="3222428">.</span><span class="ident" id="3222429">Expire</span><span class="op" id="3222435">,</span>&nbsp;<span class="string" id="3222437">&#34;Expire&#34;</span><span class="op" id="3222445">,</span>&nbsp;<span class="string" id="3222447">&#34;&#34;</span><span class="op" id="3222449">)</span>&nbsp;<span class="op" id="3222451">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3222456">f</span><span class="op" id="3222457">(</span><span class="op" id="3222458">&amp;</span><span class="ident" id="3222459">rr</span><span class="op" id="3222461">.</span><span class="ident" id="3222462">Minttl</span><span class="op" id="3222468">,</span>&nbsp;<span class="string" id="3222470">&#34;Minttl&#34;</span><span class="op" id="3222478">,</span>&nbsp;<span class="string" id="3222480">&#34;&#34;</span><span class="op" id="3222482">)</span><br>
<span class="lineno"></span><span class="op" id="3222484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3222487">type</span>&nbsp;<span class="ident" id="3222492">dnsRR_TXT</span>&nbsp;<span class="keyword" id="3222502">struct</span>&nbsp;<span class="op" id="3222509">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3222512">Hdr</span>&nbsp;<span class="ident" id="3222516">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3222530">Txt</span>&nbsp;<span class="builtintype" id="3222534">string</span>&nbsp;<span class="comment" id="3222541">//&nbsp;not&nbsp;domain&nbsp;name</span><br>
<span class="lineno"></span><span class="op" id="3222560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3222563">func</span>&nbsp;<span class="op" id="3222568">(</span><span class="ident" id="3222569">rr</span>&nbsp;<span class="op" id="3222572">*</span><span class="ident" id="3222573">dnsRR_TXT</span><span class="op" id="3222582">)</span>&nbsp;<span class="ident" id="3222584">Header</span><span class="op" id="3222590">(</span><span class="op" id="3222591">)</span>&nbsp;<span class="op" id="3222593">*</span><span class="ident" id="3222594">dnsRR_Header</span>&nbsp;<span class="op" id="3222607">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3222610">return</span>&nbsp;<span class="op" id="3222617">&amp;</span><span class="ident" id="3222618">rr</span><span class="op" id="3222620">.</span><span class="ident" id="3222621">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3222625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3222628">func</span>&nbsp;<span class="op" id="3222633">(</span><span class="ident" id="3222634">rr</span>&nbsp;<span class="op" id="3222637">*</span><span class="ident" id="3222638">dnsRR_TXT</span><span class="op" id="3222647">)</span>&nbsp;<span class="ident" id="3222649">Walk</span><span class="op" id="3222653">(</span><span class="ident" id="3222654">f</span>&nbsp;<span class="keyword" id="3222656">func</span><span class="op" id="3222660">(</span><span class="ident" id="3222661">v</span>&nbsp;<span class="keyword" id="3222663">interface</span><span class="op" id="3222672">{</span><span class="op" id="3222673">}</span><span class="op" id="3222674">,</span>&nbsp;<span class="ident" id="3222676">name</span><span class="op" id="3222680">,</span>&nbsp;<span class="ident" id="3222682">tag</span>&nbsp;<span class="builtintype" id="3222686">string</span><span class="op" id="3222692">)</span>&nbsp;<span class="builtintype" id="3222694">bool</span><span class="op" id="3222698">)</span>&nbsp;<span class="builtintype" id="3222700">bool</span>&nbsp;<span class="op" id="3222705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3222708">return</span>&nbsp;<span class="ident" id="3222715">rr</span><span class="op" id="3222717">.</span><span class="ident" id="3222718">Hdr</span><span class="op" id="3222721">.</span><span class="ident" id="3222722">Walk</span><span class="op" id="3222726">(</span><span class="ident" id="3222727">f</span><span class="op" id="3222728">)</span>&nbsp;<span class="op" id="3222730">&amp;&amp;</span>&nbsp;<span class="ident" id="3222733">f</span><span class="op" id="3222734">(</span><span class="op" id="3222735">&amp;</span><span class="ident" id="3222736">rr</span><span class="op" id="3222738">.</span><span class="ident" id="3222739">Txt</span><span class="op" id="3222742">,</span>&nbsp;<span class="string" id="3222744">&#34;Txt&#34;</span><span class="op" id="3222749">,</span>&nbsp;<span class="string" id="3222751">&#34;&#34;</span><span class="op" id="3222753">)</span><br>
<span class="lineno">310</span><span class="op" id="3222755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3222758">type</span>&nbsp;<span class="ident" id="3222763">dnsRR_SRV</span>&nbsp;<span class="keyword" id="3222773">struct</span>&nbsp;<span class="op" id="3222780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3222783">Hdr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3222792">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3222806">Priority</span>&nbsp;<span class="builtintype" id="3222815">uint16</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3222823">Weight</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3222832">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3222840">Port</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3222849">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3222857">Target</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3222866">string</span>&nbsp;<span class="string" id="3222873">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3222893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="keyword" id="3222896">func</span>&nbsp;<span class="op" id="3222901">(</span><span class="ident" id="3222902">rr</span>&nbsp;<span class="op" id="3222905">*</span><span class="ident" id="3222906">dnsRR_SRV</span><span class="op" id="3222915">)</span>&nbsp;<span class="ident" id="3222917">Header</span><span class="op" id="3222923">(</span><span class="op" id="3222924">)</span>&nbsp;<span class="op" id="3222926">*</span><span class="ident" id="3222927">dnsRR_Header</span>&nbsp;<span class="op" id="3222940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3222943">return</span>&nbsp;<span class="op" id="3222950">&amp;</span><span class="ident" id="3222951">rr</span><span class="op" id="3222953">.</span><span class="ident" id="3222954">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3222958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3222961">func</span>&nbsp;<span class="op" id="3222966">(</span><span class="ident" id="3222967">rr</span>&nbsp;<span class="op" id="3222970">*</span><span class="ident" id="3222971">dnsRR_SRV</span><span class="op" id="3222980">)</span>&nbsp;<span class="ident" id="3222982">Walk</span><span class="op" id="3222986">(</span><span class="ident" id="3222987">f</span>&nbsp;<span class="keyword" id="3222989">func</span><span class="op" id="3222993">(</span><span class="ident" id="3222994">v</span>&nbsp;<span class="keyword" id="3222996">interface</span><span class="op" id="3223005">{</span><span class="op" id="3223006">}</span><span class="op" id="3223007">,</span>&nbsp;<span class="ident" id="3223009">name</span><span class="op" id="3223013">,</span>&nbsp;<span class="ident" id="3223015">tag</span>&nbsp;<span class="builtintype" id="3223019">string</span><span class="op" id="3223025">)</span>&nbsp;<span class="builtintype" id="3223027">bool</span><span class="op" id="3223031">)</span>&nbsp;<span class="builtintype" id="3223033">bool</span>&nbsp;<span class="op" id="3223038">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3223041">return</span>&nbsp;<span class="ident" id="3223048">rr</span><span class="op" id="3223050">.</span><span class="ident" id="3223051">Hdr</span><span class="op" id="3223054">.</span><span class="ident" id="3223055">Walk</span><span class="op" id="3223059">(</span><span class="ident" id="3223060">f</span><span class="op" id="3223061">)</span>&nbsp;<span class="op" id="3223063">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3223068">f</span><span class="op" id="3223069">(</span><span class="op" id="3223070">&amp;</span><span class="ident" id="3223071">rr</span><span class="op" id="3223073">.</span><span class="ident" id="3223074">Priority</span><span class="op" id="3223082">,</span>&nbsp;<span class="string" id="3223084">&#34;Priority&#34;</span><span class="op" id="3223094">,</span>&nbsp;<span class="string" id="3223096">&#34;&#34;</span><span class="op" id="3223098">)</span>&nbsp;<span class="op" id="3223100">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3223105">f</span><span class="op" id="3223106">(</span><span class="op" id="3223107">&amp;</span><span class="ident" id="3223108">rr</span><span class="op" id="3223110">.</span><span class="ident" id="3223111">Weight</span><span class="op" id="3223117">,</span>&nbsp;<span class="string" id="3223119">&#34;Weight&#34;</span><span class="op" id="3223127">,</span>&nbsp;<span class="string" id="3223129">&#34;&#34;</span><span class="op" id="3223131">)</span>&nbsp;<span class="op" id="3223133">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3223138">f</span><span class="op" id="3223139">(</span><span class="op" id="3223140">&amp;</span><span class="ident" id="3223141">rr</span><span class="op" id="3223143">.</span><span class="ident" id="3223144">Port</span><span class="op" id="3223148">,</span>&nbsp;<span class="string" id="3223150">&#34;Port&#34;</span><span class="op" id="3223156">,</span>&nbsp;<span class="string" id="3223158">&#34;&#34;</span><span class="op" id="3223160">)</span>&nbsp;<span class="op" id="3223162">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3223167">f</span><span class="op" id="3223168">(</span><span class="op" id="3223169">&amp;</span><span class="ident" id="3223170">rr</span><span class="op" id="3223172">.</span><span class="ident" id="3223173">Target</span><span class="op" id="3223179">,</span>&nbsp;<span class="string" id="3223181">&#34;Target&#34;</span><span class="op" id="3223189">,</span>&nbsp;<span class="string" id="3223191">&#34;domain&#34;</span><span class="op" id="3223199">)</span><br>
<span class="lineno">330</span><span class="op" id="3223201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3223204">type</span>&nbsp;<span class="ident" id="3223209">dnsRR_A</span>&nbsp;<span class="keyword" id="3223217">struct</span>&nbsp;<span class="op" id="3223224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3223227">Hdr</span>&nbsp;<span class="ident" id="3223231">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3223245">A</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3223249">uint32</span>&nbsp;<span class="string" id="3223256">`net:&#34;ipv4&#34;`</span><br>
<span class="lineno">335</span><span class="op" id="3223269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3223272">func</span>&nbsp;<span class="op" id="3223277">(</span><span class="ident" id="3223278">rr</span>&nbsp;<span class="op" id="3223281">*</span><span class="ident" id="3223282">dnsRR_A</span><span class="op" id="3223289">)</span>&nbsp;<span class="ident" id="3223291">Header</span><span class="op" id="3223297">(</span><span class="op" id="3223298">)</span>&nbsp;<span class="op" id="3223300">*</span><span class="ident" id="3223301">dnsRR_Header</span>&nbsp;<span class="op" id="3223314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3223317">return</span>&nbsp;<span class="op" id="3223324">&amp;</span><span class="ident" id="3223325">rr</span><span class="op" id="3223327">.</span><span class="ident" id="3223328">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3223332">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="keyword" id="3223335">func</span>&nbsp;<span class="op" id="3223340">(</span><span class="ident" id="3223341">rr</span>&nbsp;<span class="op" id="3223344">*</span><span class="ident" id="3223345">dnsRR_A</span><span class="op" id="3223352">)</span>&nbsp;<span class="ident" id="3223354">Walk</span><span class="op" id="3223358">(</span><span class="ident" id="3223359">f</span>&nbsp;<span class="keyword" id="3223361">func</span><span class="op" id="3223365">(</span><span class="ident" id="3223366">v</span>&nbsp;<span class="keyword" id="3223368">interface</span><span class="op" id="3223377">{</span><span class="op" id="3223378">}</span><span class="op" id="3223379">,</span>&nbsp;<span class="ident" id="3223381">name</span><span class="op" id="3223385">,</span>&nbsp;<span class="ident" id="3223387">tag</span>&nbsp;<span class="builtintype" id="3223391">string</span><span class="op" id="3223397">)</span>&nbsp;<span class="builtintype" id="3223399">bool</span><span class="op" id="3223403">)</span>&nbsp;<span class="builtintype" id="3223405">bool</span>&nbsp;<span class="op" id="3223410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3223413">return</span>&nbsp;<span class="ident" id="3223420">rr</span><span class="op" id="3223422">.</span><span class="ident" id="3223423">Hdr</span><span class="op" id="3223426">.</span><span class="ident" id="3223427">Walk</span><span class="op" id="3223431">(</span><span class="ident" id="3223432">f</span><span class="op" id="3223433">)</span>&nbsp;<span class="op" id="3223435">&amp;&amp;</span>&nbsp;<span class="ident" id="3223438">f</span><span class="op" id="3223439">(</span><span class="op" id="3223440">&amp;</span><span class="ident" id="3223441">rr</span><span class="op" id="3223443">.</span><span class="ident" id="3223444">A</span><span class="op" id="3223445">,</span>&nbsp;<span class="string" id="3223447">&#34;A&#34;</span><span class="op" id="3223450">,</span>&nbsp;<span class="string" id="3223452">&#34;ipv4&#34;</span><span class="op" id="3223458">)</span><br>
<span class="lineno"></span><span class="op" id="3223460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="keyword" id="3223463">type</span>&nbsp;<span class="ident" id="3223468">dnsRR_AAAA</span>&nbsp;<span class="keyword" id="3223479">struct</span>&nbsp;<span class="op" id="3223486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3223489">Hdr</span>&nbsp;&nbsp;<span class="ident" id="3223494">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3223508">AAAA</span>&nbsp;<span class="op" id="3223513">[</span><span class="num" id="3223514">16</span><span class="op" id="3223516">]</span><span class="builtintype" id="3223517">byte</span>&nbsp;<span class="string" id="3223522">`net:&#34;ipv6&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3223535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="3223538">func</span>&nbsp;<span class="op" id="3223543">(</span><span class="ident" id="3223544">rr</span>&nbsp;<span class="op" id="3223547">*</span><span class="ident" id="3223548">dnsRR_AAAA</span><span class="op" id="3223558">)</span>&nbsp;<span class="ident" id="3223560">Header</span><span class="op" id="3223566">(</span><span class="op" id="3223567">)</span>&nbsp;<span class="op" id="3223569">*</span><span class="ident" id="3223570">dnsRR_Header</span>&nbsp;<span class="op" id="3223583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3223586">return</span>&nbsp;<span class="op" id="3223593">&amp;</span><span class="ident" id="3223594">rr</span><span class="op" id="3223596">.</span><span class="ident" id="3223597">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3223601">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3223604">func</span>&nbsp;<span class="op" id="3223609">(</span><span class="ident" id="3223610">rr</span>&nbsp;<span class="op" id="3223613">*</span><span class="ident" id="3223614">dnsRR_AAAA</span><span class="op" id="3223624">)</span>&nbsp;<span class="ident" id="3223626">Walk</span><span class="op" id="3223630">(</span><span class="ident" id="3223631">f</span>&nbsp;<span class="keyword" id="3223633">func</span><span class="op" id="3223637">(</span><span class="ident" id="3223638">v</span>&nbsp;<span class="keyword" id="3223640">interface</span><span class="op" id="3223649">{</span><span class="op" id="3223650">}</span><span class="op" id="3223651">,</span>&nbsp;<span class="ident" id="3223653">name</span><span class="op" id="3223657">,</span>&nbsp;<span class="ident" id="3223659">tag</span>&nbsp;<span class="builtintype" id="3223663">string</span><span class="op" id="3223669">)</span>&nbsp;<span class="builtintype" id="3223671">bool</span><span class="op" id="3223675">)</span>&nbsp;<span class="builtintype" id="3223677">bool</span>&nbsp;<span class="op" id="3223682">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3223685">return</span>&nbsp;<span class="ident" id="3223692">rr</span><span class="op" id="3223694">.</span><span class="ident" id="3223695">Hdr</span><span class="op" id="3223698">.</span><span class="ident" id="3223699">Walk</span><span class="op" id="3223703">(</span><span class="ident" id="3223704">f</span><span class="op" id="3223705">)</span>&nbsp;<span class="op" id="3223707">&amp;&amp;</span>&nbsp;<span class="ident" id="3223710">f</span><span class="op" id="3223711">(</span><span class="ident" id="3223712">rr</span><span class="op" id="3223714">.</span><span class="ident" id="3223715">AAAA</span><span class="op" id="3223719">[</span><span class="op" id="3223720">:</span><span class="op" id="3223721">]</span><span class="op" id="3223722">,</span>&nbsp;<span class="string" id="3223724">&#34;AAAA&#34;</span><span class="op" id="3223730">,</span>&nbsp;<span class="string" id="3223732">&#34;ipv6&#34;</span><span class="op" id="3223738">)</span><br>
<span class="lineno"></span><span class="op" id="3223740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3223743">//&nbsp;Packing&nbsp;and&nbsp;unpacking.</span><br>
<span class="lineno"></span><span class="comment" id="3223769">//</span><br>
<span class="lineno">360</span><span class="comment" id="3223772">//&nbsp;All&nbsp;the&nbsp;packers&nbsp;and&nbsp;unpackers&nbsp;take&nbsp;a&nbsp;(msg&nbsp;[]byte,&nbsp;off&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="3223834">//&nbsp;and&nbsp;return&nbsp;(off1&nbsp;int,&nbsp;ok&nbsp;bool).&nbsp;&nbsp;If&nbsp;they&nbsp;return&nbsp;ok==false,&nbsp;they</span><br>
<span class="lineno"></span><span class="comment" id="3223901">//&nbsp;also&nbsp;return&nbsp;off1==len(msg),&nbsp;so&nbsp;that&nbsp;the&nbsp;next&nbsp;unpacker&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="3223963">//&nbsp;also&nbsp;fail.&nbsp;&nbsp;This&nbsp;lets&nbsp;us&nbsp;avoid&nbsp;checks&nbsp;of&nbsp;ok&nbsp;until&nbsp;the&nbsp;end&nbsp;of&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3224029">//&nbsp;packing&nbsp;sequence.</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="comment" id="3224051">//&nbsp;Map&nbsp;of&nbsp;constructors&nbsp;for&nbsp;each&nbsp;RR&nbsp;wire&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="3224097">var</span>&nbsp;<span class="ident" id="3224101">rr_mk</span>&nbsp;<span class="op" id="3224107">=</span>&nbsp;<span class="keyword" id="3224109">map</span><span class="op" id="3224112">[</span><span class="builtintype" id="3224113">int</span><span class="op" id="3224116">]</span><span class="keyword" id="3224117">func</span><span class="op" id="3224121">(</span><span class="op" id="3224122">)</span>&nbsp;<span class="ident" id="3224124">dnsRR</span><span class="op" id="3224129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3224132">dnsTypeCNAME</span><span class="op" id="3224144">:</span>&nbsp;<span class="keyword" id="3224146">func</span><span class="op" id="3224150">(</span><span class="op" id="3224151">)</span>&nbsp;<span class="ident" id="3224153">dnsRR</span>&nbsp;<span class="op" id="3224159">{</span>&nbsp;<span class="keyword" id="3224161">return</span>&nbsp;<span class="builtinfunc" id="3224168">new</span><span class="op" id="3224171">(</span><span class="ident" id="3224172">dnsRR_CNAME</span><span class="op" id="3224183">)</span>&nbsp;<span class="op" id="3224185">}</span><span class="op" id="3224186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3224189">dnsTypeHINFO</span><span class="op" id="3224201">:</span>&nbsp;<span class="keyword" id="3224203">func</span><span class="op" id="3224207">(</span><span class="op" id="3224208">)</span>&nbsp;<span class="ident" id="3224210">dnsRR</span>&nbsp;<span class="op" id="3224216">{</span>&nbsp;<span class="keyword" id="3224218">return</span>&nbsp;<span class="builtinfunc" id="3224225">new</span><span class="op" id="3224228">(</span><span class="ident" id="3224229">dnsRR_HINFO</span><span class="op" id="3224240">)</span>&nbsp;<span class="op" id="3224242">}</span><span class="op" id="3224243">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3224246">dnsTypeMB</span><span class="op" id="3224255">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3224260">func</span><span class="op" id="3224264">(</span><span class="op" id="3224265">)</span>&nbsp;<span class="ident" id="3224267">dnsRR</span>&nbsp;<span class="op" id="3224273">{</span>&nbsp;<span class="keyword" id="3224275">return</span>&nbsp;<span class="builtinfunc" id="3224282">new</span><span class="op" id="3224285">(</span><span class="ident" id="3224286">dnsRR_MB</span><span class="op" id="3224294">)</span>&nbsp;<span class="op" id="3224296">}</span><span class="op" id="3224297">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3224300">dnsTypeMG</span><span class="op" id="3224309">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3224314">func</span><span class="op" id="3224318">(</span><span class="op" id="3224319">)</span>&nbsp;<span class="ident" id="3224321">dnsRR</span>&nbsp;<span class="op" id="3224327">{</span>&nbsp;<span class="keyword" id="3224329">return</span>&nbsp;<span class="builtinfunc" id="3224336">new</span><span class="op" id="3224339">(</span><span class="ident" id="3224340">dnsRR_MG</span><span class="op" id="3224348">)</span>&nbsp;<span class="op" id="3224350">}</span><span class="op" id="3224351">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3224354">dnsTypeMINFO</span><span class="op" id="3224366">:</span>&nbsp;<span class="keyword" id="3224368">func</span><span class="op" id="3224372">(</span><span class="op" id="3224373">)</span>&nbsp;<span class="ident" id="3224375">dnsRR</span>&nbsp;<span class="op" id="3224381">{</span>&nbsp;<span class="keyword" id="3224383">return</span>&nbsp;<span class="builtinfunc" id="3224390">new</span><span class="op" id="3224393">(</span><span class="ident" id="3224394">dnsRR_MINFO</span><span class="op" id="3224405">)</span>&nbsp;<span class="op" id="3224407">}</span><span class="op" id="3224408">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3224411">dnsTypeMR</span><span class="op" id="3224420">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3224425">func</span><span class="op" id="3224429">(</span><span class="op" id="3224430">)</span>&nbsp;<span class="ident" id="3224432">dnsRR</span>&nbsp;<span class="op" id="3224438">{</span>&nbsp;<span class="keyword" id="3224440">return</span>&nbsp;<span class="builtinfunc" id="3224447">new</span><span class="op" id="3224450">(</span><span class="ident" id="3224451">dnsRR_MR</span><span class="op" id="3224459">)</span>&nbsp;<span class="op" id="3224461">}</span><span class="op" id="3224462">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3224465">dnsTypeMX</span><span class="op" id="3224474">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3224479">func</span><span class="op" id="3224483">(</span><span class="op" id="3224484">)</span>&nbsp;<span class="ident" id="3224486">dnsRR</span>&nbsp;<span class="op" id="3224492">{</span>&nbsp;<span class="keyword" id="3224494">return</span>&nbsp;<span class="builtinfunc" id="3224501">new</span><span class="op" id="3224504">(</span><span class="ident" id="3224505">dnsRR_MX</span><span class="op" id="3224513">)</span>&nbsp;<span class="op" id="3224515">}</span><span class="op" id="3224516">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3224519">dnsTypeNS</span><span class="op" id="3224528">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3224533">func</span><span class="op" id="3224537">(</span><span class="op" id="3224538">)</span>&nbsp;<span class="ident" id="3224540">dnsRR</span>&nbsp;<span class="op" id="3224546">{</span>&nbsp;<span class="keyword" id="3224548">return</span>&nbsp;<span class="builtinfunc" id="3224555">new</span><span class="op" id="3224558">(</span><span class="ident" id="3224559">dnsRR_NS</span><span class="op" id="3224567">)</span>&nbsp;<span class="op" id="3224569">}</span><span class="op" id="3224570">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3224573">dnsTypePTR</span><span class="op" id="3224583">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3224587">func</span><span class="op" id="3224591">(</span><span class="op" id="3224592">)</span>&nbsp;<span class="ident" id="3224594">dnsRR</span>&nbsp;<span class="op" id="3224600">{</span>&nbsp;<span class="keyword" id="3224602">return</span>&nbsp;<span class="builtinfunc" id="3224609">new</span><span class="op" id="3224612">(</span><span class="ident" id="3224613">dnsRR_PTR</span><span class="op" id="3224622">)</span>&nbsp;<span class="op" id="3224624">}</span><span class="op" id="3224625">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3224628">dnsTypeSOA</span><span class="op" id="3224638">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3224642">func</span><span class="op" id="3224646">(</span><span class="op" id="3224647">)</span>&nbsp;<span class="ident" id="3224649">dnsRR</span>&nbsp;<span class="op" id="3224655">{</span>&nbsp;<span class="keyword" id="3224657">return</span>&nbsp;<span class="builtinfunc" id="3224664">new</span><span class="op" id="3224667">(</span><span class="ident" id="3224668">dnsRR_SOA</span><span class="op" id="3224677">)</span>&nbsp;<span class="op" id="3224679">}</span><span class="op" id="3224680">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3224683">dnsTypeTXT</span><span class="op" id="3224693">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3224697">func</span><span class="op" id="3224701">(</span><span class="op" id="3224702">)</span>&nbsp;<span class="ident" id="3224704">dnsRR</span>&nbsp;<span class="op" id="3224710">{</span>&nbsp;<span class="keyword" id="3224712">return</span>&nbsp;<span class="builtinfunc" id="3224719">new</span><span class="op" id="3224722">(</span><span class="ident" id="3224723">dnsRR_TXT</span><span class="op" id="3224732">)</span>&nbsp;<span class="op" id="3224734">}</span><span class="op" id="3224735">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3224738">dnsTypeSRV</span><span class="op" id="3224748">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3224752">func</span><span class="op" id="3224756">(</span><span class="op" id="3224757">)</span>&nbsp;<span class="ident" id="3224759">dnsRR</span>&nbsp;<span class="op" id="3224765">{</span>&nbsp;<span class="keyword" id="3224767">return</span>&nbsp;<span class="builtinfunc" id="3224774">new</span><span class="op" id="3224777">(</span><span class="ident" id="3224778">dnsRR_SRV</span><span class="op" id="3224787">)</span>&nbsp;<span class="op" id="3224789">}</span><span class="op" id="3224790">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3224793">dnsTypeA</span><span class="op" id="3224801">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3224807">func</span><span class="op" id="3224811">(</span><span class="op" id="3224812">)</span>&nbsp;<span class="ident" id="3224814">dnsRR</span>&nbsp;<span class="op" id="3224820">{</span>&nbsp;<span class="keyword" id="3224822">return</span>&nbsp;<span class="builtinfunc" id="3224829">new</span><span class="op" id="3224832">(</span><span class="ident" id="3224833">dnsRR_A</span><span class="op" id="3224840">)</span>&nbsp;<span class="op" id="3224842">}</span><span class="op" id="3224843">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3224846">dnsTypeAAAA</span><span class="op" id="3224857">:</span>&nbsp;&nbsp;<span class="keyword" id="3224860">func</span><span class="op" id="3224864">(</span><span class="op" id="3224865">)</span>&nbsp;<span class="ident" id="3224867">dnsRR</span>&nbsp;<span class="op" id="3224873">{</span>&nbsp;<span class="keyword" id="3224875">return</span>&nbsp;<span class="builtinfunc" id="3224882">new</span><span class="op" id="3224885">(</span><span class="ident" id="3224886">dnsRR_AAAA</span><span class="op" id="3224896">)</span>&nbsp;<span class="op" id="3224898">}</span><span class="op" id="3224899">,</span><br>
<span class="lineno"></span><span class="op" id="3224901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3224904">//&nbsp;Pack&nbsp;a&nbsp;domain&nbsp;name&nbsp;s&nbsp;into&nbsp;msg[off:].</span><br>
<span class="lineno">385</span><span class="comment" id="3224944">//&nbsp;Domain&nbsp;names&nbsp;are&nbsp;a&nbsp;sequence&nbsp;of&nbsp;counted&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="3224994">//&nbsp;split&nbsp;at&nbsp;the&nbsp;dots.&nbsp;&nbsp;They&nbsp;end&nbsp;with&nbsp;a&nbsp;zero-length&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3225053">func</span>&nbsp;<span class="ident" id="3225058">packDomainName</span><span class="op" id="3225072">(</span><span class="ident" id="3225073">s</span>&nbsp;<span class="builtintype" id="3225075">string</span><span class="op" id="3225081">,</span>&nbsp;<span class="ident" id="3225083">msg</span>&nbsp;<span class="op" id="3225087">[</span><span class="op" id="3225088">]</span><span class="builtintype" id="3225089">byte</span><span class="op" id="3225093">,</span>&nbsp;<span class="ident" id="3225095">off</span>&nbsp;<span class="builtintype" id="3225099">int</span><span class="op" id="3225102">)</span>&nbsp;<span class="op" id="3225104">(</span><span class="ident" id="3225105">off1</span>&nbsp;<span class="builtintype" id="3225110">int</span><span class="op" id="3225113">,</span>&nbsp;<span class="ident" id="3225115">ok</span>&nbsp;<span class="builtintype" id="3225118">bool</span><span class="op" id="3225122">)</span>&nbsp;<span class="op" id="3225124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3225127">//&nbsp;Add&nbsp;trailing&nbsp;dot&nbsp;to&nbsp;canonicalize&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3225170">if</span>&nbsp;<span class="ident" id="3225173">n</span>&nbsp;<span class="op" id="3225175">:=</span>&nbsp;<span class="builtinfunc" id="3225178">len</span><span class="op" id="3225181">(</span><span class="ident" id="3225182">s</span><span class="op" id="3225183">)</span><span class="op" id="3225184">;</span>&nbsp;<span class="ident" id="3225186">n</span>&nbsp;<span class="op" id="3225188">==</span>&nbsp;<span class="num" id="3225191">0</span>&nbsp;<span class="op" id="3225193">||</span>&nbsp;<span class="ident" id="3225196">s</span><span class="op" id="3225197">[</span><span class="ident" id="3225198">n</span><span class="op" id="3225199">-</span><span class="num" id="3225200">1</span><span class="op" id="3225201">]</span>&nbsp;<span class="op" id="3225203">!=</span>&nbsp;<span class="string" id="3225206">&#39;.&#39;</span>&nbsp;<span class="op" id="3225210">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3225214">s</span>&nbsp;<span class="op" id="3225216">+=</span>&nbsp;<span class="string" id="3225219">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3225224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3225228">//&nbsp;Each&nbsp;dot&nbsp;ends&nbsp;a&nbsp;segment&nbsp;of&nbsp;the&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3225269">//&nbsp;We&nbsp;trade&nbsp;each&nbsp;dot&nbsp;byte&nbsp;for&nbsp;a&nbsp;length&nbsp;byte.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3225315">//&nbsp;There&nbsp;is&nbsp;also&nbsp;a&nbsp;trailing&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3225350">//&nbsp;Check&nbsp;that&nbsp;we&nbsp;have&nbsp;all&nbsp;the&nbsp;space&nbsp;we&nbsp;need.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3225396">tot</span>&nbsp;<span class="op" id="3225400">:=</span>&nbsp;<span class="builtinfunc" id="3225403">len</span><span class="op" id="3225406">(</span><span class="ident" id="3225407">s</span><span class="op" id="3225408">)</span>&nbsp;<span class="op" id="3225410">+</span>&nbsp;<span class="num" id="3225412">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3225415">if</span>&nbsp;<span class="ident" id="3225418">off</span><span class="op" id="3225421">+</span><span class="ident" id="3225422">tot</span>&nbsp;<span class="op" id="3225426">&gt;</span>&nbsp;<span class="builtinfunc" id="3225428">len</span><span class="op" id="3225431">(</span><span class="ident" id="3225432">msg</span><span class="op" id="3225435">)</span>&nbsp;<span class="op" id="3225437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3225441">return</span>&nbsp;<span class="builtinfunc" id="3225448">len</span><span class="op" id="3225451">(</span><span class="ident" id="3225452">msg</span><span class="op" id="3225455">)</span><span class="op" id="3225456">,</span>&nbsp;<span class="builtintype" id="3225458">false</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3225465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3225469">//&nbsp;Emit&nbsp;sequence&nbsp;of&nbsp;counted&nbsp;strings,&nbsp;chopping&nbsp;at&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3225525">begin</span>&nbsp;<span class="op" id="3225531">:=</span>&nbsp;<span class="num" id="3225534">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3225537">for</span>&nbsp;<span class="ident" id="3225541">i</span>&nbsp;<span class="op" id="3225543">:=</span>&nbsp;<span class="num" id="3225546">0</span><span class="op" id="3225547">;</span>&nbsp;<span class="ident" id="3225549">i</span>&nbsp;<span class="op" id="3225551">&lt;</span>&nbsp;<span class="builtinfunc" id="3225553">len</span><span class="op" id="3225556">(</span><span class="ident" id="3225557">s</span><span class="op" id="3225558">)</span><span class="op" id="3225559">;</span>&nbsp;<span class="ident" id="3225561">i</span><span class="op" id="3225562">++</span>&nbsp;<span class="op" id="3225565">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3225569">if</span>&nbsp;<span class="ident" id="3225572">s</span><span class="op" id="3225573">[</span><span class="ident" id="3225574">i</span><span class="op" id="3225575">]</span>&nbsp;<span class="op" id="3225577">==</span>&nbsp;<span class="string" id="3225580">&#39;.&#39;</span>&nbsp;<span class="op" id="3225584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3225589">if</span>&nbsp;<span class="ident" id="3225592">i</span><span class="op" id="3225593">-</span><span class="ident" id="3225594">begin</span>&nbsp;<span class="op" id="3225600">&gt;=</span>&nbsp;<span class="num" id="3225603">1</span><span class="op" id="3225604">&lt;&lt;</span><span class="num" id="3225606">6</span>&nbsp;<span class="op" id="3225608">{</span>&nbsp;<span class="comment" id="3225610">//&nbsp;top&nbsp;two&nbsp;bits&nbsp;of&nbsp;length&nbsp;must&nbsp;be&nbsp;clear</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3225654">return</span>&nbsp;<span class="builtinfunc" id="3225661">len</span><span class="op" id="3225664">(</span><span class="ident" id="3225665">msg</span><span class="op" id="3225668">)</span><span class="op" id="3225669">,</span>&nbsp;<span class="builtintype" id="3225671">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3225680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3225685">msg</span><span class="op" id="3225688">[</span><span class="ident" id="3225689">off</span><span class="op" id="3225692">]</span>&nbsp;<span class="op" id="3225694">=</span>&nbsp;<span class="builtintype" id="3225696">byte</span><span class="op" id="3225700">(</span><span class="ident" id="3225701">i</span>&nbsp;<span class="op" id="3225703">-</span>&nbsp;<span class="ident" id="3225705">begin</span><span class="op" id="3225710">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3225715">off</span><span class="op" id="3225718">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3225724">for</span>&nbsp;<span class="ident" id="3225728">j</span>&nbsp;<span class="op" id="3225730">:=</span>&nbsp;<span class="ident" id="3225733">begin</span><span class="op" id="3225738">;</span>&nbsp;<span class="ident" id="3225740">j</span>&nbsp;<span class="op" id="3225742">&lt;</span>&nbsp;<span class="ident" id="3225744">i</span><span class="op" id="3225745">;</span>&nbsp;<span class="ident" id="3225747">j</span><span class="op" id="3225748">++</span>&nbsp;<span class="op" id="3225751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3225757">msg</span><span class="op" id="3225760">[</span><span class="ident" id="3225761">off</span><span class="op" id="3225764">]</span>&nbsp;<span class="op" id="3225766">=</span>&nbsp;<span class="ident" id="3225768">s</span><span class="op" id="3225769">[</span><span class="ident" id="3225770">j</span><span class="op" id="3225771">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3225777">off</span><span class="op" id="3225780">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3225786">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3225791">begin</span>&nbsp;<span class="op" id="3225797">=</span>&nbsp;<span class="ident" id="3225799">i</span>&nbsp;<span class="op" id="3225801">+</span>&nbsp;<span class="num" id="3225803">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3225807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3225810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3225813">msg</span><span class="op" id="3225816">[</span><span class="ident" id="3225817">off</span><span class="op" id="3225820">]</span>&nbsp;<span class="op" id="3225822">=</span>&nbsp;<span class="num" id="3225824">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3225827">off</span><span class="op" id="3225830">++</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3225834">return</span>&nbsp;<span class="ident" id="3225841">off</span><span class="op" id="3225844">,</span>&nbsp;<span class="builtintype" id="3225846">true</span><br>
<span class="lineno"></span><span class="op" id="3225851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3225854">//&nbsp;Unpack&nbsp;a&nbsp;domain&nbsp;name.</span><br>
<span class="lineno"></span><span class="comment" id="3225879">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;simple&nbsp;sequences&nbsp;of&nbsp;counted&nbsp;strings&nbsp;above,</span><br>
<span class="lineno">425</span><span class="comment" id="3225944">//&nbsp;domain&nbsp;names&nbsp;are&nbsp;allowed&nbsp;to&nbsp;refer&nbsp;to&nbsp;strings&nbsp;elsewhere&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3226009">//&nbsp;packet,&nbsp;to&nbsp;avoid&nbsp;repeating&nbsp;common&nbsp;suffixes&nbsp;when&nbsp;returning</span><br>
<span class="lineno"></span><span class="comment" id="3226070">//&nbsp;many&nbsp;entries&nbsp;in&nbsp;a&nbsp;single&nbsp;domain.&nbsp;&nbsp;The&nbsp;pointers&nbsp;are&nbsp;marked</span><br>
<span class="lineno"></span><span class="comment" id="3226131">//&nbsp;by&nbsp;a&nbsp;length&nbsp;byte&nbsp;with&nbsp;the&nbsp;top&nbsp;two&nbsp;bits&nbsp;set.&nbsp;&nbsp;Ignoring&nbsp;those</span><br>
<span class="lineno"></span><span class="comment" id="3226194">//&nbsp;two&nbsp;bits,&nbsp;that&nbsp;byte&nbsp;and&nbsp;the&nbsp;next&nbsp;give&nbsp;a&nbsp;14&nbsp;bit&nbsp;offset&nbsp;from&nbsp;msg[0]</span><br>
<span class="lineno">430</span><span class="comment" id="3226263">//&nbsp;where&nbsp;we&nbsp;should&nbsp;pick&nbsp;up&nbsp;the&nbsp;trail.</span><br>
<span class="lineno"></span><span class="comment" id="3226301">//&nbsp;Note&nbsp;that&nbsp;if&nbsp;we&nbsp;jump&nbsp;elsewhere&nbsp;in&nbsp;the&nbsp;packet,</span><br>
<span class="lineno"></span><span class="comment" id="3226350">//&nbsp;we&nbsp;return&nbsp;off1&nbsp;==&nbsp;the&nbsp;offset&nbsp;after&nbsp;the&nbsp;first&nbsp;pointer&nbsp;we&nbsp;found,</span><br>
<span class="lineno"></span><span class="comment" id="3226416">//&nbsp;which&nbsp;is&nbsp;where&nbsp;the&nbsp;next&nbsp;record&nbsp;will&nbsp;start.</span><br>
<span class="lineno"></span><span class="comment" id="3226462">//&nbsp;In&nbsp;theory,&nbsp;the&nbsp;pointers&nbsp;are&nbsp;only&nbsp;allowed&nbsp;to&nbsp;jump&nbsp;backward.</span><br>
<span class="lineno">435</span><span class="comment" id="3226524">//&nbsp;We&nbsp;let&nbsp;them&nbsp;jump&nbsp;anywhere&nbsp;and&nbsp;stop&nbsp;jumping&nbsp;after&nbsp;a&nbsp;while.</span><br>
<span class="lineno"></span><span class="keyword" id="3226585">func</span>&nbsp;<span class="ident" id="3226590">unpackDomainName</span><span class="op" id="3226606">(</span><span class="ident" id="3226607">msg</span>&nbsp;<span class="op" id="3226611">[</span><span class="op" id="3226612">]</span><span class="builtintype" id="3226613">byte</span><span class="op" id="3226617">,</span>&nbsp;<span class="ident" id="3226619">off</span>&nbsp;<span class="builtintype" id="3226623">int</span><span class="op" id="3226626">)</span>&nbsp;<span class="op" id="3226628">(</span><span class="ident" id="3226629">s</span>&nbsp;<span class="builtintype" id="3226631">string</span><span class="op" id="3226637">,</span>&nbsp;<span class="ident" id="3226639">off1</span>&nbsp;<span class="builtintype" id="3226644">int</span><span class="op" id="3226647">,</span>&nbsp;<span class="ident" id="3226649">ok</span>&nbsp;<span class="builtintype" id="3226652">bool</span><span class="op" id="3226656">)</span>&nbsp;<span class="op" id="3226658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3226661">s</span>&nbsp;<span class="op" id="3226663">=</span>&nbsp;<span class="string" id="3226665">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3226669">ptr</span>&nbsp;<span class="op" id="3226673">:=</span>&nbsp;<span class="num" id="3226676">0</span>&nbsp;<span class="comment" id="3226678">//&nbsp;number&nbsp;of&nbsp;pointers&nbsp;followed</span><br>
<span class="lineno"></span><span class="ident" id="3226709">Loop</span><span class="op" id="3226713">:</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3226716">for</span>&nbsp;<span class="op" id="3226720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3226724">if</span>&nbsp;<span class="ident" id="3226727">off</span>&nbsp;<span class="op" id="3226731">&gt;=</span>&nbsp;<span class="builtinfunc" id="3226734">len</span><span class="op" id="3226737">(</span><span class="ident" id="3226738">msg</span><span class="op" id="3226741">)</span>&nbsp;<span class="op" id="3226743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3226748">return</span>&nbsp;<span class="string" id="3226755">&#34;&#34;</span><span class="op" id="3226757">,</span>&nbsp;<span class="builtinfunc" id="3226759">len</span><span class="op" id="3226762">(</span><span class="ident" id="3226763">msg</span><span class="op" id="3226766">)</span><span class="op" id="3226767">,</span>&nbsp;<span class="builtintype" id="3226769">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3226777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3226781">c</span>&nbsp;<span class="op" id="3226783">:=</span>&nbsp;<span class="builtintype" id="3226786">int</span><span class="op" id="3226789">(</span><span class="ident" id="3226790">msg</span><span class="op" id="3226793">[</span><span class="ident" id="3226794">off</span><span class="op" id="3226797">]</span><span class="op" id="3226798">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3226802">off</span><span class="op" id="3226805">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3226810">switch</span>&nbsp;<span class="ident" id="3226817">c</span>&nbsp;<span class="op" id="3226819">&amp;</span>&nbsp;<span class="num" id="3226821">0xC0</span>&nbsp;<span class="op" id="3226826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3226830">case</span>&nbsp;<span class="num" id="3226835">0x00</span><span class="op" id="3226839">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3226844">if</span>&nbsp;<span class="ident" id="3226847">c</span>&nbsp;<span class="op" id="3226849">==</span>&nbsp;<span class="num" id="3226852">0x00</span>&nbsp;<span class="op" id="3226857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3226863">//&nbsp;end&nbsp;of&nbsp;name</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3226882">break</span>&nbsp;<span class="ident" id="3226888">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3226896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3226901">//&nbsp;literal&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3226922">if</span>&nbsp;<span class="ident" id="3226925">off</span><span class="op" id="3226928">+</span><span class="ident" id="3226929">c</span>&nbsp;<span class="op" id="3226931">&gt;</span>&nbsp;<span class="builtinfunc" id="3226933">len</span><span class="op" id="3226936">(</span><span class="ident" id="3226937">msg</span><span class="op" id="3226940">)</span>&nbsp;<span class="op" id="3226942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3226948">return</span>&nbsp;<span class="string" id="3226955">&#34;&#34;</span><span class="op" id="3226957">,</span>&nbsp;<span class="builtinfunc" id="3226959">len</span><span class="op" id="3226962">(</span><span class="ident" id="3226963">msg</span><span class="op" id="3226966">)</span><span class="op" id="3226967">,</span>&nbsp;<span class="builtintype" id="3226969">false</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3226978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3226983">s</span>&nbsp;<span class="op" id="3226985">+=</span>&nbsp;<span class="builtintype" id="3226988">string</span><span class="op" id="3226994">(</span><span class="ident" id="3226995">msg</span><span class="op" id="3226998">[</span><span class="ident" id="3226999">off</span><span class="op" id="3227002">:</span><span class="ident" id="3227003">off</span><span class="op" id="3227006">+</span><span class="ident" id="3227007">c</span><span class="op" id="3227008">]</span><span class="op" id="3227009">)</span>&nbsp;<span class="op" id="3227011">+</span>&nbsp;<span class="string" id="3227013">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3227020">off</span>&nbsp;<span class="op" id="3227024">+=</span>&nbsp;<span class="ident" id="3227027">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3227031">case</span>&nbsp;<span class="num" id="3227036">0xC0</span><span class="op" id="3227040">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3227045">//&nbsp;pointer&nbsp;to&nbsp;somewhere&nbsp;else&nbsp;in&nbsp;msg.</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3227085">//&nbsp;remember&nbsp;location&nbsp;after&nbsp;first&nbsp;ptr,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3227126">//&nbsp;since&nbsp;that&#39;s&nbsp;how&nbsp;many&nbsp;bytes&nbsp;we&nbsp;consumed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3227173">//&nbsp;also,&nbsp;don&#39;t&nbsp;follow&nbsp;too&nbsp;many&nbsp;pointers&nbsp;--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3227219">//&nbsp;maybe&nbsp;there&#39;s&nbsp;a&nbsp;loop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3227247">if</span>&nbsp;<span class="ident" id="3227250">off</span>&nbsp;<span class="op" id="3227254">&gt;=</span>&nbsp;<span class="builtinfunc" id="3227257">len</span><span class="op" id="3227260">(</span><span class="ident" id="3227261">msg</span><span class="op" id="3227264">)</span>&nbsp;<span class="op" id="3227266">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3227272">return</span>&nbsp;<span class="string" id="3227279">&#34;&#34;</span><span class="op" id="3227281">,</span>&nbsp;<span class="builtinfunc" id="3227283">len</span><span class="op" id="3227286">(</span><span class="ident" id="3227287">msg</span><span class="op" id="3227290">)</span><span class="op" id="3227291">,</span>&nbsp;<span class="builtintype" id="3227293">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3227302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3227307">c1</span>&nbsp;<span class="op" id="3227310">:=</span>&nbsp;<span class="ident" id="3227313">msg</span><span class="op" id="3227316">[</span><span class="ident" id="3227317">off</span><span class="op" id="3227320">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3227325">off</span><span class="op" id="3227328">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3227334">if</span>&nbsp;<span class="ident" id="3227337">ptr</span>&nbsp;<span class="op" id="3227341">==</span>&nbsp;<span class="num" id="3227344">0</span>&nbsp;<span class="op" id="3227346">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3227352">off1</span>&nbsp;<span class="op" id="3227357">=</span>&nbsp;<span class="ident" id="3227359">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3227366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3227371">if</span>&nbsp;<span class="ident" id="3227374">ptr</span><span class="op" id="3227377">++</span><span class="op" id="3227379">;</span>&nbsp;<span class="ident" id="3227381">ptr</span>&nbsp;<span class="op" id="3227385">&gt;</span>&nbsp;<span class="num" id="3227387">10</span>&nbsp;<span class="op" id="3227390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3227396">return</span>&nbsp;<span class="string" id="3227403">&#34;&#34;</span><span class="op" id="3227405">,</span>&nbsp;<span class="builtinfunc" id="3227407">len</span><span class="op" id="3227410">(</span><span class="ident" id="3227411">msg</span><span class="op" id="3227414">)</span><span class="op" id="3227415">,</span>&nbsp;<span class="builtintype" id="3227417">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3227426">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3227431">off</span>&nbsp;<span class="op" id="3227435">=</span>&nbsp;<span class="op" id="3227437">(</span><span class="ident" id="3227438">c</span><span class="op" id="3227439">^</span><span class="num" id="3227440">0xC0</span><span class="op" id="3227444">)</span><span class="op" id="3227445">&lt;&lt;</span><span class="num" id="3227447">8</span>&nbsp;<span class="op" id="3227449">|</span>&nbsp;<span class="builtintype" id="3227451">int</span><span class="op" id="3227454">(</span><span class="ident" id="3227455">c1</span><span class="op" id="3227457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3227461">default</span><span class="op" id="3227468">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3227473">//&nbsp;0x80&nbsp;and&nbsp;0x40&nbsp;are&nbsp;reserved</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3227506">return</span>&nbsp;<span class="string" id="3227513">&#34;&#34;</span><span class="op" id="3227515">,</span>&nbsp;<span class="builtinfunc" id="3227517">len</span><span class="op" id="3227520">(</span><span class="ident" id="3227521">msg</span><span class="op" id="3227524">)</span><span class="op" id="3227525">,</span>&nbsp;<span class="builtintype" id="3227527">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3227535">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3227538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3227541">if</span>&nbsp;<span class="ident" id="3227544">ptr</span>&nbsp;<span class="op" id="3227548">==</span>&nbsp;<span class="num" id="3227551">0</span>&nbsp;<span class="op" id="3227553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3227557">off1</span>&nbsp;<span class="op" id="3227562">=</span>&nbsp;<span class="ident" id="3227564">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3227569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3227572">return</span>&nbsp;<span class="ident" id="3227579">s</span><span class="op" id="3227580">,</span>&nbsp;<span class="ident" id="3227582">off1</span><span class="op" id="3227586">,</span>&nbsp;<span class="builtintype" id="3227588">true</span><br>
<span class="lineno">485</span><span class="op" id="3227593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3227596">//&nbsp;packStruct&nbsp;packs&nbsp;a&nbsp;structure&nbsp;into&nbsp;msg&nbsp;at&nbsp;specified&nbsp;offset&nbsp;off,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3227666">//&nbsp;returns&nbsp;off1&nbsp;such&nbsp;that&nbsp;msg[off:off1]&nbsp;is&nbsp;the&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3227727">func</span>&nbsp;<span class="ident" id="3227732">packStruct</span><span class="op" id="3227742">(</span><span class="ident" id="3227743">any</span>&nbsp;<span class="ident" id="3227747">dnsStruct</span><span class="op" id="3227756">,</span>&nbsp;<span class="ident" id="3227758">msg</span>&nbsp;<span class="op" id="3227762">[</span><span class="op" id="3227763">]</span><span class="builtintype" id="3227764">byte</span><span class="op" id="3227768">,</span>&nbsp;<span class="ident" id="3227770">off</span>&nbsp;<span class="builtintype" id="3227774">int</span><span class="op" id="3227777">)</span>&nbsp;<span class="op" id="3227779">(</span><span class="ident" id="3227780">off1</span>&nbsp;<span class="builtintype" id="3227785">int</span><span class="op" id="3227788">,</span>&nbsp;<span class="ident" id="3227790">ok</span>&nbsp;<span class="builtintype" id="3227793">bool</span><span class="op" id="3227797">)</span>&nbsp;<span class="op" id="3227799">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3227802">ok</span>&nbsp;<span class="op" id="3227805">=</span>&nbsp;<span class="ident" id="3227807">any</span><span class="op" id="3227810">.</span><span class="ident" id="3227811">Walk</span><span class="op" id="3227815">(</span><span class="keyword" id="3227816">func</span><span class="op" id="3227820">(</span><span class="ident" id="3227821">field</span>&nbsp;<span class="keyword" id="3227827">interface</span><span class="op" id="3227836">{</span><span class="op" id="3227837">}</span><span class="op" id="3227838">,</span>&nbsp;<span class="ident" id="3227840">name</span><span class="op" id="3227844">,</span>&nbsp;<span class="ident" id="3227846">tag</span>&nbsp;<span class="builtintype" id="3227850">string</span><span class="op" id="3227856">)</span>&nbsp;<span class="builtintype" id="3227858">bool</span>&nbsp;<span class="op" id="3227863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3227867">switch</span>&nbsp;<span class="ident" id="3227874">fv</span>&nbsp;<span class="op" id="3227877">:=</span>&nbsp;<span class="ident" id="3227880">field</span><span class="op" id="3227885">.</span><span class="op" id="3227886">(</span><span class="keyword" id="3227887">type</span><span class="op" id="3227891">)</span>&nbsp;<span class="op" id="3227893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3227897">default</span><span class="op" id="3227904">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3227909">println</span><span class="op" id="3227916">(</span><span class="string" id="3227917">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;packing&nbsp;type&#34;</span><span class="op" id="3227949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3227954">return</span>&nbsp;<span class="builtintype" id="3227961">false</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3227969">case</span>&nbsp;<span class="op" id="3227974">*</span><span class="builtintype" id="3227975">uint16</span><span class="op" id="3227981">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3227986">i</span>&nbsp;<span class="op" id="3227988">:=</span>&nbsp;<span class="op" id="3227991">*</span><span class="ident" id="3227992">fv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3227998">if</span>&nbsp;<span class="ident" id="3228001">off</span><span class="op" id="3228004">+</span><span class="num" id="3228005">2</span>&nbsp;<span class="op" id="3228007">&gt;</span>&nbsp;<span class="builtinfunc" id="3228009">len</span><span class="op" id="3228012">(</span><span class="ident" id="3228013">msg</span><span class="op" id="3228016">)</span>&nbsp;<span class="op" id="3228018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3228024">return</span>&nbsp;<span class="builtintype" id="3228031">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3228040">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3228045">msg</span><span class="op" id="3228048">[</span><span class="ident" id="3228049">off</span><span class="op" id="3228052">]</span>&nbsp;<span class="op" id="3228054">=</span>&nbsp;<span class="builtintype" id="3228056">byte</span><span class="op" id="3228060">(</span><span class="ident" id="3228061">i</span>&nbsp;<span class="op" id="3228063">&gt;&gt;</span>&nbsp;<span class="num" id="3228066">8</span><span class="op" id="3228067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3228072">msg</span><span class="op" id="3228075">[</span><span class="ident" id="3228076">off</span><span class="op" id="3228079">+</span><span class="num" id="3228080">1</span><span class="op" id="3228081">]</span>&nbsp;<span class="op" id="3228083">=</span>&nbsp;<span class="builtintype" id="3228085">byte</span><span class="op" id="3228089">(</span><span class="ident" id="3228090">i</span><span class="op" id="3228091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3228096">off</span>&nbsp;<span class="op" id="3228100">+=</span>&nbsp;<span class="num" id="3228103">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3228107">case</span>&nbsp;<span class="op" id="3228112">*</span><span class="builtintype" id="3228113">uint32</span><span class="op" id="3228119">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3228124">i</span>&nbsp;<span class="op" id="3228126">:=</span>&nbsp;<span class="op" id="3228129">*</span><span class="ident" id="3228130">fv</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3228136">msg</span><span class="op" id="3228139">[</span><span class="ident" id="3228140">off</span><span class="op" id="3228143">]</span>&nbsp;<span class="op" id="3228145">=</span>&nbsp;<span class="builtintype" id="3228147">byte</span><span class="op" id="3228151">(</span><span class="ident" id="3228152">i</span>&nbsp;<span class="op" id="3228154">&gt;&gt;</span>&nbsp;<span class="num" id="3228157">24</span><span class="op" id="3228159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3228164">msg</span><span class="op" id="3228167">[</span><span class="ident" id="3228168">off</span><span class="op" id="3228171">+</span><span class="num" id="3228172">1</span><span class="op" id="3228173">]</span>&nbsp;<span class="op" id="3228175">=</span>&nbsp;<span class="builtintype" id="3228177">byte</span><span class="op" id="3228181">(</span><span class="ident" id="3228182">i</span>&nbsp;<span class="op" id="3228184">&gt;&gt;</span>&nbsp;<span class="num" id="3228187">16</span><span class="op" id="3228189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3228194">msg</span><span class="op" id="3228197">[</span><span class="ident" id="3228198">off</span><span class="op" id="3228201">+</span><span class="num" id="3228202">2</span><span class="op" id="3228203">]</span>&nbsp;<span class="op" id="3228205">=</span>&nbsp;<span class="builtintype" id="3228207">byte</span><span class="op" id="3228211">(</span><span class="ident" id="3228212">i</span>&nbsp;<span class="op" id="3228214">&gt;&gt;</span>&nbsp;<span class="num" id="3228217">8</span><span class="op" id="3228218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3228223">msg</span><span class="op" id="3228226">[</span><span class="ident" id="3228227">off</span><span class="op" id="3228230">+</span><span class="num" id="3228231">3</span><span class="op" id="3228232">]</span>&nbsp;<span class="op" id="3228234">=</span>&nbsp;<span class="builtintype" id="3228236">byte</span><span class="op" id="3228240">(</span><span class="ident" id="3228241">i</span><span class="op" id="3228242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3228247">off</span>&nbsp;<span class="op" id="3228251">+=</span>&nbsp;<span class="num" id="3228254">4</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3228258">case</span>&nbsp;<span class="op" id="3228263">[</span><span class="op" id="3228264">]</span><span class="builtintype" id="3228265">byte</span><span class="op" id="3228269">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3228274">n</span>&nbsp;<span class="op" id="3228276">:=</span>&nbsp;<span class="builtinfunc" id="3228279">len</span><span class="op" id="3228282">(</span><span class="ident" id="3228283">fv</span><span class="op" id="3228285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3228290">if</span>&nbsp;<span class="ident" id="3228293">off</span><span class="op" id="3228296">+</span><span class="ident" id="3228297">n</span>&nbsp;<span class="op" id="3228299">&gt;</span>&nbsp;<span class="builtinfunc" id="3228301">len</span><span class="op" id="3228304">(</span><span class="ident" id="3228305">msg</span><span class="op" id="3228308">)</span>&nbsp;<span class="op" id="3228310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3228316">return</span>&nbsp;<span class="builtintype" id="3228323">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3228332">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3228337">copy</span><span class="op" id="3228341">(</span><span class="ident" id="3228342">msg</span><span class="op" id="3228345">[</span><span class="ident" id="3228346">off</span><span class="op" id="3228349">:</span><span class="ident" id="3228350">off</span><span class="op" id="3228353">+</span><span class="ident" id="3228354">n</span><span class="op" id="3228355">]</span><span class="op" id="3228356">,</span>&nbsp;<span class="ident" id="3228358">fv</span><span class="op" id="3228360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3228365">off</span>&nbsp;<span class="op" id="3228369">+=</span>&nbsp;<span class="ident" id="3228372">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3228376">case</span>&nbsp;<span class="op" id="3228381">*</span><span class="builtintype" id="3228382">string</span><span class="op" id="3228388">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3228393">s</span>&nbsp;<span class="op" id="3228395">:=</span>&nbsp;<span class="op" id="3228398">*</span><span class="ident" id="3228399">fv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3228405">switch</span>&nbsp;<span class="ident" id="3228412">tag</span>&nbsp;<span class="op" id="3228416">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3228421">default</span><span class="op" id="3228428">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3228434">println</span><span class="op" id="3228441">(</span><span class="string" id="3228442">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;string&nbsp;tag&#34;</span><span class="op" id="3228472">,</span>&nbsp;<span class="ident" id="3228474">tag</span><span class="op" id="3228477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3228483">return</span>&nbsp;<span class="builtintype" id="3228490">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3228499">case</span>&nbsp;<span class="string" id="3228504">&#34;domain&#34;</span><span class="op" id="3228512">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3228518">off</span><span class="op" id="3228521">,</span>&nbsp;<span class="ident" id="3228523">ok</span>&nbsp;<span class="op" id="3228526">=</span>&nbsp;<span class="ident" id="3228528">packDomainName</span><span class="op" id="3228542">(</span><span class="ident" id="3228543">s</span><span class="op" id="3228544">,</span>&nbsp;<span class="ident" id="3228546">msg</span><span class="op" id="3228549">,</span>&nbsp;<span class="ident" id="3228551">off</span><span class="op" id="3228554">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3228560">if</span>&nbsp;<span class="op" id="3228563">!</span><span class="ident" id="3228564">ok</span>&nbsp;<span class="op" id="3228567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3228574">return</span>&nbsp;<span class="builtintype" id="3228581">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3228591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3228596">case</span>&nbsp;<span class="string" id="3228601">&#34;&#34;</span><span class="op" id="3228603">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3228609">//&nbsp;Counted&nbsp;string:&nbsp;1&nbsp;byte&nbsp;length.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3228647">if</span>&nbsp;<span class="builtinfunc" id="3228650">len</span><span class="op" id="3228653">(</span><span class="ident" id="3228654">s</span><span class="op" id="3228655">)</span>&nbsp;<span class="op" id="3228657">&gt;</span>&nbsp;<span class="num" id="3228659">255</span>&nbsp;<span class="op" id="3228663">||</span>&nbsp;<span class="ident" id="3228666">off</span><span class="op" id="3228669">+</span><span class="num" id="3228670">1</span><span class="op" id="3228671">+</span><span class="builtinfunc" id="3228672">len</span><span class="op" id="3228675">(</span><span class="ident" id="3228676">s</span><span class="op" id="3228677">)</span>&nbsp;<span class="op" id="3228679">&gt;</span>&nbsp;<span class="builtinfunc" id="3228681">len</span><span class="op" id="3228684">(</span><span class="ident" id="3228685">msg</span><span class="op" id="3228688">)</span>&nbsp;<span class="op" id="3228690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3228697">return</span>&nbsp;<span class="builtintype" id="3228704">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3228714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3228720">msg</span><span class="op" id="3228723">[</span><span class="ident" id="3228724">off</span><span class="op" id="3228727">]</span>&nbsp;<span class="op" id="3228729">=</span>&nbsp;<span class="builtintype" id="3228731">byte</span><span class="op" id="3228735">(</span><span class="builtinfunc" id="3228736">len</span><span class="op" id="3228739">(</span><span class="ident" id="3228740">s</span><span class="op" id="3228741">)</span><span class="op" id="3228742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3228748">off</span><span class="op" id="3228751">++</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3228758">off</span>&nbsp;<span class="op" id="3228762">+=</span>&nbsp;<span class="builtinfunc" id="3228765">copy</span><span class="op" id="3228769">(</span><span class="ident" id="3228770">msg</span><span class="op" id="3228773">[</span><span class="ident" id="3228774">off</span><span class="op" id="3228777">:</span><span class="op" id="3228778">]</span><span class="op" id="3228779">,</span>&nbsp;<span class="ident" id="3228781">s</span><span class="op" id="3228782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3228787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3228791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3228795">return</span>&nbsp;<span class="builtintype" id="3228802">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3228808">}</span><span class="op" id="3228809">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3228812">if</span>&nbsp;<span class="op" id="3228815">!</span><span class="ident" id="3228816">ok</span>&nbsp;<span class="op" id="3228819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3228823">return</span>&nbsp;<span class="builtinfunc" id="3228830">len</span><span class="op" id="3228833">(</span><span class="ident" id="3228834">msg</span><span class="op" id="3228837">)</span><span class="op" id="3228838">,</span>&nbsp;<span class="builtintype" id="3228840">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3228847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3228850">return</span>&nbsp;<span class="ident" id="3228857">off</span><span class="op" id="3228860">,</span>&nbsp;<span class="builtintype" id="3228862">true</span><br>
<span class="lineno"></span><span class="op" id="3228867">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="comment" id="3228870">//&nbsp;unpackStruct&nbsp;decodes&nbsp;msg[off:] into&nbsp;the&nbsp;given&nbsp;structure,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3228935">//&nbsp;returns&nbsp;off1&nbsp;such&nbsp;that&nbsp;msg[off:off1]&nbsp;is&nbsp;the&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3228996">func</span>&nbsp;<span class="ident" id="3229001">unpackStruct</span><span class="op" id="3229013">(</span><span class="ident" id="3229014">any</span>&nbsp;<span class="ident" id="3229018">dnsStruct</span><span class="op" id="3229027">,</span>&nbsp;<span class="ident" id="3229029">msg</span>&nbsp;<span class="op" id="3229033">[</span><span class="op" id="3229034">]</span><span class="builtintype" id="3229035">byte</span><span class="op" id="3229039">,</span>&nbsp;<span class="ident" id="3229041">off</span>&nbsp;<span class="builtintype" id="3229045">int</span><span class="op" id="3229048">)</span>&nbsp;<span class="op" id="3229050">(</span><span class="ident" id="3229051">off1</span>&nbsp;<span class="builtintype" id="3229056">int</span><span class="op" id="3229059">,</span>&nbsp;<span class="ident" id="3229061">ok</span>&nbsp;<span class="builtintype" id="3229064">bool</span><span class="op" id="3229068">)</span>&nbsp;<span class="op" id="3229070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3229073">ok</span>&nbsp;<span class="op" id="3229076">=</span>&nbsp;<span class="ident" id="3229078">any</span><span class="op" id="3229081">.</span><span class="ident" id="3229082">Walk</span><span class="op" id="3229086">(</span><span class="keyword" id="3229087">func</span><span class="op" id="3229091">(</span><span class="ident" id="3229092">field</span>&nbsp;<span class="keyword" id="3229098">interface</span><span class="op" id="3229107">{</span><span class="op" id="3229108">}</span><span class="op" id="3229109">,</span>&nbsp;<span class="ident" id="3229111">name</span><span class="op" id="3229115">,</span>&nbsp;<span class="ident" id="3229117">tag</span>&nbsp;<span class="builtintype" id="3229121">string</span><span class="op" id="3229127">)</span>&nbsp;<span class="builtintype" id="3229129">bool</span>&nbsp;<span class="op" id="3229134">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3229138">switch</span>&nbsp;<span class="ident" id="3229145">fv</span>&nbsp;<span class="op" id="3229148">:=</span>&nbsp;<span class="ident" id="3229151">field</span><span class="op" id="3229156">.</span><span class="op" id="3229157">(</span><span class="keyword" id="3229158">type</span><span class="op" id="3229162">)</span>&nbsp;<span class="op" id="3229164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3229168">default</span><span class="op" id="3229175">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3229180">println</span><span class="op" id="3229187">(</span><span class="string" id="3229188">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;packing&nbsp;type&#34;</span><span class="op" id="3229220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3229225">return</span>&nbsp;<span class="builtintype" id="3229232">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3229240">case</span>&nbsp;<span class="op" id="3229245">*</span><span class="builtintype" id="3229246">uint16</span><span class="op" id="3229252">:</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3229257">if</span>&nbsp;<span class="ident" id="3229260">off</span><span class="op" id="3229263">+</span><span class="num" id="3229264">2</span>&nbsp;<span class="op" id="3229266">&gt;</span>&nbsp;<span class="builtinfunc" id="3229268">len</span><span class="op" id="3229271">(</span><span class="ident" id="3229272">msg</span><span class="op" id="3229275">)</span>&nbsp;<span class="op" id="3229277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3229283">return</span>&nbsp;<span class="builtintype" id="3229290">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3229299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3229304">*</span><span class="ident" id="3229305">fv</span>&nbsp;<span class="op" id="3229308">=</span>&nbsp;<span class="builtintype" id="3229310">uint16</span><span class="op" id="3229316">(</span><span class="ident" id="3229317">msg</span><span class="op" id="3229320">[</span><span class="ident" id="3229321">off</span><span class="op" id="3229324">]</span><span class="op" id="3229325">)</span><span class="op" id="3229326">&lt;&lt;</span><span class="num" id="3229328">8</span>&nbsp;<span class="op" id="3229330">|</span>&nbsp;<span class="builtintype" id="3229332">uint16</span><span class="op" id="3229338">(</span><span class="ident" id="3229339">msg</span><span class="op" id="3229342">[</span><span class="ident" id="3229343">off</span><span class="op" id="3229346">+</span><span class="num" id="3229347">1</span><span class="op" id="3229348">]</span><span class="op" id="3229349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3229354">off</span>&nbsp;<span class="op" id="3229358">+=</span>&nbsp;<span class="num" id="3229361">2</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3229365">case</span>&nbsp;<span class="op" id="3229370">*</span><span class="builtintype" id="3229371">uint32</span><span class="op" id="3229377">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3229382">if</span>&nbsp;<span class="ident" id="3229385">off</span><span class="op" id="3229388">+</span><span class="num" id="3229389">4</span>&nbsp;<span class="op" id="3229391">&gt;</span>&nbsp;<span class="builtinfunc" id="3229393">len</span><span class="op" id="3229396">(</span><span class="ident" id="3229397">msg</span><span class="op" id="3229400">)</span>&nbsp;<span class="op" id="3229402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3229408">return</span>&nbsp;<span class="builtintype" id="3229415">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3229424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3229429">*</span><span class="ident" id="3229430">fv</span>&nbsp;<span class="op" id="3229433">=</span>&nbsp;<span class="builtintype" id="3229435">uint32</span><span class="op" id="3229441">(</span><span class="ident" id="3229442">msg</span><span class="op" id="3229445">[</span><span class="ident" id="3229446">off</span><span class="op" id="3229449">]</span><span class="op" id="3229450">)</span><span class="op" id="3229451">&lt;&lt;</span><span class="num" id="3229453">24</span>&nbsp;<span class="op" id="3229456">|</span>&nbsp;<span class="builtintype" id="3229458">uint32</span><span class="op" id="3229464">(</span><span class="ident" id="3229465">msg</span><span class="op" id="3229468">[</span><span class="ident" id="3229469">off</span><span class="op" id="3229472">+</span><span class="num" id="3229473">1</span><span class="op" id="3229474">]</span><span class="op" id="3229475">)</span><span class="op" id="3229476">&lt;&lt;</span><span class="num" id="3229478">16</span>&nbsp;<span class="op" id="3229481">|</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3229487">uint32</span><span class="op" id="3229493">(</span><span class="ident" id="3229494">msg</span><span class="op" id="3229497">[</span><span class="ident" id="3229498">off</span><span class="op" id="3229501">+</span><span class="num" id="3229502">2</span><span class="op" id="3229503">]</span><span class="op" id="3229504">)</span><span class="op" id="3229505">&lt;&lt;</span><span class="num" id="3229507">8</span>&nbsp;<span class="op" id="3229509">|</span>&nbsp;<span class="builtintype" id="3229511">uint32</span><span class="op" id="3229517">(</span><span class="ident" id="3229518">msg</span><span class="op" id="3229521">[</span><span class="ident" id="3229522">off</span><span class="op" id="3229525">+</span><span class="num" id="3229526">3</span><span class="op" id="3229527">]</span><span class="op" id="3229528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3229533">off</span>&nbsp;<span class="op" id="3229537">+=</span>&nbsp;<span class="num" id="3229540">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3229544">case</span>&nbsp;<span class="op" id="3229549">[</span><span class="op" id="3229550">]</span><span class="builtintype" id="3229551">byte</span><span class="op" id="3229555">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3229560">n</span>&nbsp;<span class="op" id="3229562">:=</span>&nbsp;<span class="builtinfunc" id="3229565">len</span><span class="op" id="3229568">(</span><span class="ident" id="3229569">fv</span><span class="op" id="3229571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3229576">if</span>&nbsp;<span class="ident" id="3229579">off</span><span class="op" id="3229582">+</span><span class="ident" id="3229583">n</span>&nbsp;<span class="op" id="3229585">&gt;</span>&nbsp;<span class="builtinfunc" id="3229587">len</span><span class="op" id="3229590">(</span><span class="ident" id="3229591">msg</span><span class="op" id="3229594">)</span>&nbsp;<span class="op" id="3229596">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3229602">return</span>&nbsp;<span class="builtintype" id="3229609">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3229618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3229623">copy</span><span class="op" id="3229627">(</span><span class="ident" id="3229628">fv</span><span class="op" id="3229630">,</span>&nbsp;<span class="ident" id="3229632">msg</span><span class="op" id="3229635">[</span><span class="ident" id="3229636">off</span><span class="op" id="3229639">:</span><span class="ident" id="3229640">off</span><span class="op" id="3229643">+</span><span class="ident" id="3229644">n</span><span class="op" id="3229645">]</span><span class="op" id="3229646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3229651">off</span>&nbsp;<span class="op" id="3229655">+=</span>&nbsp;<span class="ident" id="3229658">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3229662">case</span>&nbsp;<span class="op" id="3229667">*</span><span class="builtintype" id="3229668">string</span><span class="op" id="3229674">:</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3229679">var</span>&nbsp;<span class="ident" id="3229683">s</span>&nbsp;<span class="builtintype" id="3229685">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3229695">switch</span>&nbsp;<span class="ident" id="3229702">tag</span>&nbsp;<span class="op" id="3229706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3229711">default</span><span class="op" id="3229718">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3229724">println</span><span class="op" id="3229731">(</span><span class="string" id="3229732">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;string&nbsp;tag&#34;</span><span class="op" id="3229762">,</span>&nbsp;<span class="ident" id="3229764">tag</span><span class="op" id="3229767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3229773">return</span>&nbsp;<span class="builtintype" id="3229780">false</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3229789">case</span>&nbsp;<span class="string" id="3229794">&#34;domain&#34;</span><span class="op" id="3229802">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3229808">s</span><span class="op" id="3229809">,</span>&nbsp;<span class="ident" id="3229811">off</span><span class="op" id="3229814">,</span>&nbsp;<span class="ident" id="3229816">ok</span>&nbsp;<span class="op" id="3229819">=</span>&nbsp;<span class="ident" id="3229821">unpackDomainName</span><span class="op" id="3229837">(</span><span class="ident" id="3229838">msg</span><span class="op" id="3229841">,</span>&nbsp;<span class="ident" id="3229843">off</span><span class="op" id="3229846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3229852">if</span>&nbsp;<span class="op" id="3229855">!</span><span class="ident" id="3229856">ok</span>&nbsp;<span class="op" id="3229859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3229866">return</span>&nbsp;<span class="builtintype" id="3229873">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3229883">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3229888">case</span>&nbsp;<span class="string" id="3229893">&#34;&#34;</span><span class="op" id="3229895">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3229901">if</span>&nbsp;<span class="ident" id="3229904">off</span>&nbsp;<span class="op" id="3229908">&gt;=</span>&nbsp;<span class="builtinfunc" id="3229911">len</span><span class="op" id="3229914">(</span><span class="ident" id="3229915">msg</span><span class="op" id="3229918">)</span>&nbsp;<span class="op" id="3229920">||</span>&nbsp;<span class="ident" id="3229923">off</span><span class="op" id="3229926">+</span><span class="num" id="3229927">1</span><span class="op" id="3229928">+</span><span class="builtintype" id="3229929">int</span><span class="op" id="3229932">(</span><span class="ident" id="3229933">msg</span><span class="op" id="3229936">[</span><span class="ident" id="3229937">off</span><span class="op" id="3229940">]</span><span class="op" id="3229941">)</span>&nbsp;<span class="op" id="3229943">&gt;</span>&nbsp;<span class="builtinfunc" id="3229945">len</span><span class="op" id="3229948">(</span><span class="ident" id="3229949">msg</span><span class="op" id="3229952">)</span>&nbsp;<span class="op" id="3229954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3229961">return</span>&nbsp;<span class="builtintype" id="3229968">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3229978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3229984">n</span>&nbsp;<span class="op" id="3229986">:=</span>&nbsp;<span class="builtintype" id="3229989">int</span><span class="op" id="3229992">(</span><span class="ident" id="3229993">msg</span><span class="op" id="3229996">[</span><span class="ident" id="3229997">off</span><span class="op" id="3230000">]</span><span class="op" id="3230001">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230007">off</span><span class="op" id="3230010">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230017">b</span>&nbsp;<span class="op" id="3230019">:=</span>&nbsp;<span class="builtinfunc" id="3230022">make</span><span class="op" id="3230026">(</span><span class="op" id="3230027">[</span><span class="op" id="3230028">]</span><span class="builtintype" id="3230029">byte</span><span class="op" id="3230033">,</span>&nbsp;<span class="ident" id="3230035">n</span><span class="op" id="3230036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3230042">for</span>&nbsp;<span class="ident" id="3230046">i</span>&nbsp;<span class="op" id="3230048">:=</span>&nbsp;<span class="num" id="3230051">0</span><span class="op" id="3230052">;</span>&nbsp;<span class="ident" id="3230054">i</span>&nbsp;<span class="op" id="3230056">&lt;</span>&nbsp;<span class="ident" id="3230058">n</span><span class="op" id="3230059">;</span>&nbsp;<span class="ident" id="3230061">i</span><span class="op" id="3230062">++</span>&nbsp;<span class="op" id="3230065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230072">b</span><span class="op" id="3230073">[</span><span class="ident" id="3230074">i</span><span class="op" id="3230075">]</span>&nbsp;<span class="op" id="3230077">=</span>&nbsp;<span class="ident" id="3230079">msg</span><span class="op" id="3230082">[</span><span class="ident" id="3230083">off</span><span class="op" id="3230086">+</span><span class="ident" id="3230087">i</span><span class="op" id="3230088">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3230094">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230100">off</span>&nbsp;<span class="op" id="3230104">+=</span>&nbsp;<span class="ident" id="3230107">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230113">s</span>&nbsp;<span class="op" id="3230115">=</span>&nbsp;<span class="builtintype" id="3230117">string</span><span class="op" id="3230123">(</span><span class="ident" id="3230124">b</span><span class="op" id="3230125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3230130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3230135">*</span><span class="ident" id="3230136">fv</span>&nbsp;<span class="op" id="3230139">=</span>&nbsp;<span class="ident" id="3230141">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3230145">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3230149">return</span>&nbsp;<span class="builtintype" id="3230156">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3230162">}</span><span class="op" id="3230163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3230166">if</span>&nbsp;<span class="op" id="3230169">!</span><span class="ident" id="3230170">ok</span>&nbsp;<span class="op" id="3230173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3230177">return</span>&nbsp;<span class="builtinfunc" id="3230184">len</span><span class="op" id="3230187">(</span><span class="ident" id="3230188">msg</span><span class="op" id="3230191">)</span><span class="op" id="3230192">,</span>&nbsp;<span class="builtintype" id="3230194">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3230201">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3230204">return</span>&nbsp;<span class="ident" id="3230211">off</span><span class="op" id="3230214">,</span>&nbsp;<span class="builtintype" id="3230216">true</span><br>
<span class="lineno"></span><span class="op" id="3230221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3230224">//&nbsp;Generic&nbsp;struct&nbsp;printer.&nbsp;Prints&nbsp;fields&nbsp;with&nbsp;tag&nbsp;&#34;ipv4&#34;&nbsp;or&nbsp;&#34;ipv6&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3230291">//&nbsp;as&nbsp;IP&nbsp;addresses.</span><br>
<span class="lineno">610</span><span class="keyword" id="3230311">func</span>&nbsp;<span class="ident" id="3230316">printStruct</span><span class="op" id="3230327">(</span><span class="ident" id="3230328">any</span>&nbsp;<span class="ident" id="3230332">dnsStruct</span><span class="op" id="3230341">)</span>&nbsp;<span class="builtintype" id="3230343">string</span>&nbsp;<span class="op" id="3230350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230353">s</span>&nbsp;<span class="op" id="3230355">:=</span>&nbsp;<span class="string" id="3230358">&#34;{&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230363">i</span>&nbsp;<span class="op" id="3230365">:=</span>&nbsp;<span class="num" id="3230368">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230371">any</span><span class="op" id="3230374">.</span><span class="ident" id="3230375">Walk</span><span class="op" id="3230379">(</span><span class="keyword" id="3230380">func</span><span class="op" id="3230384">(</span><span class="ident" id="3230385">val</span>&nbsp;<span class="keyword" id="3230389">interface</span><span class="op" id="3230398">{</span><span class="op" id="3230399">}</span><span class="op" id="3230400">,</span>&nbsp;<span class="ident" id="3230402">name</span><span class="op" id="3230406">,</span>&nbsp;<span class="ident" id="3230408">tag</span>&nbsp;<span class="builtintype" id="3230412">string</span><span class="op" id="3230418">)</span>&nbsp;<span class="builtintype" id="3230420">bool</span>&nbsp;<span class="op" id="3230425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230429">i</span><span class="op" id="3230430">++</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3230435">if</span>&nbsp;<span class="ident" id="3230438">i</span>&nbsp;<span class="op" id="3230440">&gt;</span>&nbsp;<span class="num" id="3230442">1</span>&nbsp;<span class="op" id="3230444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230449">s</span>&nbsp;<span class="op" id="3230451">+=</span>&nbsp;<span class="string" id="3230454">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3230461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230465">s</span>&nbsp;<span class="op" id="3230467">+=</span>&nbsp;<span class="ident" id="3230470">name</span>&nbsp;<span class="op" id="3230475">+</span>&nbsp;<span class="string" id="3230477">&#34;=&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3230483">switch</span>&nbsp;<span class="ident" id="3230490">tag</span>&nbsp;<span class="op" id="3230494">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3230498">case</span>&nbsp;<span class="string" id="3230503">&#34;ipv4&#34;</span><span class="op" id="3230509">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230514">i</span>&nbsp;<span class="op" id="3230516">:=</span>&nbsp;<span class="op" id="3230519">*</span><span class="ident" id="3230520">val</span><span class="op" id="3230523">.</span><span class="op" id="3230524">(</span><span class="op" id="3230525">*</span><span class="builtintype" id="3230526">uint32</span><span class="op" id="3230532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230537">s</span>&nbsp;<span class="op" id="3230539">+=</span>&nbsp;<span class="ident" id="3230542">IPv4</span><span class="op" id="3230546">(</span><span class="builtintype" id="3230547">byte</span><span class="op" id="3230551">(</span><span class="ident" id="3230552">i</span><span class="op" id="3230553">&gt;&gt;</span><span class="num" id="3230555">24</span><span class="op" id="3230557">)</span><span class="op" id="3230558">,</span>&nbsp;<span class="builtintype" id="3230560">byte</span><span class="op" id="3230564">(</span><span class="ident" id="3230565">i</span><span class="op" id="3230566">&gt;&gt;</span><span class="num" id="3230568">16</span><span class="op" id="3230570">)</span><span class="op" id="3230571">,</span>&nbsp;<span class="builtintype" id="3230573">byte</span><span class="op" id="3230577">(</span><span class="ident" id="3230578">i</span><span class="op" id="3230579">&gt;&gt;</span><span class="num" id="3230581">8</span><span class="op" id="3230582">)</span><span class="op" id="3230583">,</span>&nbsp;<span class="builtintype" id="3230585">byte</span><span class="op" id="3230589">(</span><span class="ident" id="3230590">i</span><span class="op" id="3230591">)</span><span class="op" id="3230592">)</span><span class="op" id="3230593">.</span><span class="ident" id="3230594">String</span><span class="op" id="3230600">(</span><span class="op" id="3230601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3230605">case</span>&nbsp;<span class="string" id="3230610">&#34;ipv6&#34;</span><span class="op" id="3230616">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230621">i</span>&nbsp;<span class="op" id="3230623">:=</span>&nbsp;<span class="ident" id="3230626">val</span><span class="op" id="3230629">.</span><span class="op" id="3230630">(</span><span class="op" id="3230631">[</span><span class="op" id="3230632">]</span><span class="builtintype" id="3230633">byte</span><span class="op" id="3230637">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230642">s</span>&nbsp;<span class="op" id="3230644">+=</span>&nbsp;<span class="ident" id="3230647">IP</span><span class="op" id="3230649">(</span><span class="ident" id="3230650">i</span><span class="op" id="3230651">)</span><span class="op" id="3230652">.</span><span class="ident" id="3230653">String</span><span class="op" id="3230659">(</span><span class="op" id="3230660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3230664">default</span><span class="op" id="3230671">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3230676">var</span>&nbsp;<span class="ident" id="3230680">i</span>&nbsp;<span class="ident" id="3230682">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3230691">switch</span>&nbsp;<span class="ident" id="3230698">v</span>&nbsp;<span class="op" id="3230700">:=</span>&nbsp;<span class="ident" id="3230703">val</span><span class="op" id="3230706">.</span><span class="op" id="3230707">(</span><span class="keyword" id="3230708">type</span><span class="op" id="3230712">)</span>&nbsp;<span class="op" id="3230714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3230719">default</span><span class="op" id="3230726">:</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3230732">//&nbsp;can&#39;t&nbsp;really&nbsp;happen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230760">s</span>&nbsp;<span class="op" id="3230762">+=</span>&nbsp;<span class="string" id="3230765">&#34;&lt;unknown&nbsp;type&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3230786">return</span>&nbsp;<span class="builtintype" id="3230793">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3230801">case</span>&nbsp;<span class="op" id="3230806">*</span><span class="builtintype" id="3230807">string</span><span class="op" id="3230813">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230819">s</span>&nbsp;<span class="op" id="3230821">+=</span>&nbsp;<span class="op" id="3230824">*</span><span class="ident" id="3230825">v</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3230831">return</span>&nbsp;<span class="builtintype" id="3230838">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3230846">case</span>&nbsp;<span class="op" id="3230851">[</span><span class="op" id="3230852">]</span><span class="builtintype" id="3230853">byte</span><span class="op" id="3230857">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230863">s</span>&nbsp;<span class="op" id="3230865">+=</span>&nbsp;<span class="builtintype" id="3230868">string</span><span class="op" id="3230874">(</span><span class="ident" id="3230875">v</span><span class="op" id="3230876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3230882">return</span>&nbsp;<span class="builtintype" id="3230889">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3230897">case</span>&nbsp;<span class="op" id="3230902">*</span><span class="builtintype" id="3230903">bool</span><span class="op" id="3230907">:</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3230913">if</span>&nbsp;<span class="op" id="3230916">*</span><span class="ident" id="3230917">v</span>&nbsp;<span class="op" id="3230919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230926">s</span>&nbsp;<span class="op" id="3230928">+=</span>&nbsp;<span class="string" id="3230931">&#34;true&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3230942">}</span>&nbsp;<span class="keyword" id="3230944">else</span>&nbsp;<span class="op" id="3230949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3230956">s</span>&nbsp;<span class="op" id="3230958">+=</span>&nbsp;<span class="string" id="3230961">&#34;false&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3230973">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3230979">return</span>&nbsp;<span class="builtintype" id="3230986">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3230994">case</span>&nbsp;<span class="op" id="3230999">*</span><span class="builtintype" id="3231000">int</span><span class="op" id="3231003">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3231009">i</span>&nbsp;<span class="op" id="3231011">=</span>&nbsp;<span class="ident" id="3231013">int64</span><span class="op" id="3231018">(</span><span class="op" id="3231019">*</span><span class="ident" id="3231020">v</span><span class="op" id="3231021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3231026">case</span>&nbsp;<span class="op" id="3231031">*</span><span class="builtintype" id="3231032">uint</span><span class="op" id="3231036">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3231042">i</span>&nbsp;<span class="op" id="3231044">=</span>&nbsp;<span class="ident" id="3231046">int64</span><span class="op" id="3231051">(</span><span class="op" id="3231052">*</span><span class="ident" id="3231053">v</span><span class="op" id="3231054">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3231059">case</span>&nbsp;<span class="op" id="3231064">*</span><span class="builtintype" id="3231065">uint8</span><span class="op" id="3231070">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3231076">i</span>&nbsp;<span class="op" id="3231078">=</span>&nbsp;<span class="ident" id="3231080">int64</span><span class="op" id="3231085">(</span><span class="op" id="3231086">*</span><span class="ident" id="3231087">v</span><span class="op" id="3231088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3231093">case</span>&nbsp;<span class="op" id="3231098">*</span><span class="builtintype" id="3231099">uint16</span><span class="op" id="3231105">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3231111">i</span>&nbsp;<span class="op" id="3231113">=</span>&nbsp;<span class="ident" id="3231115">int64</span><span class="op" id="3231120">(</span><span class="op" id="3231121">*</span><span class="ident" id="3231122">v</span><span class="op" id="3231123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3231128">case</span>&nbsp;<span class="op" id="3231133">*</span><span class="builtintype" id="3231134">uint32</span><span class="op" id="3231140">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3231146">i</span>&nbsp;<span class="op" id="3231148">=</span>&nbsp;<span class="ident" id="3231150">int64</span><span class="op" id="3231155">(</span><span class="op" id="3231156">*</span><span class="ident" id="3231157">v</span><span class="op" id="3231158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3231163">case</span>&nbsp;<span class="op" id="3231168">*</span><span class="ident" id="3231169">uint64</span><span class="op" id="3231175">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3231181">i</span>&nbsp;<span class="op" id="3231183">=</span>&nbsp;<span class="ident" id="3231185">int64</span><span class="op" id="3231190">(</span><span class="op" id="3231191">*</span><span class="ident" id="3231192">v</span><span class="op" id="3231193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3231198">case</span>&nbsp;<span class="op" id="3231203">*</span><span class="builtintype" id="3231204">uintptr</span><span class="op" id="3231211">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3231217">i</span>&nbsp;<span class="op" id="3231219">=</span>&nbsp;<span class="ident" id="3231221">int64</span><span class="op" id="3231226">(</span><span class="op" id="3231227">*</span><span class="ident" id="3231228">v</span><span class="op" id="3231229">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3231234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3231239">s</span>&nbsp;<span class="op" id="3231241">+=</span>&nbsp;<span class="ident" id="3231244">itoa</span><span class="op" id="3231248">(</span><span class="builtintype" id="3231249">int</span><span class="op" id="3231252">(</span><span class="ident" id="3231253">i</span><span class="op" id="3231254">)</span><span class="op" id="3231255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3231259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3231263">return</span>&nbsp;<span class="builtintype" id="3231270">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3231276">}</span><span class="op" id="3231277">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3231280">s</span>&nbsp;<span class="op" id="3231282">+=</span>&nbsp;<span class="string" id="3231285">&#34;}&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3231290">return</span>&nbsp;<span class="ident" id="3231297">s</span><br>
<span class="lineno"></span><span class="op" id="3231299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3231302">//&nbsp;Resource&nbsp;record&nbsp;packer.</span><br>
<span class="lineno">670</span><span class="keyword" id="3231329">func</span>&nbsp;<span class="ident" id="3231334">packRR</span><span class="op" id="3231340">(</span><span class="ident" id="3231341">rr</span>&nbsp;<span class="ident" id="3231344">dnsRR</span><span class="op" id="3231349">,</span>&nbsp;<span class="ident" id="3231351">msg</span>&nbsp;<span class="op" id="3231355">[</span><span class="op" id="3231356">]</span><span class="builtintype" id="3231357">byte</span><span class="op" id="3231361">,</span>&nbsp;<span class="ident" id="3231363">off</span>&nbsp;<span class="builtintype" id="3231367">int</span><span class="op" id="3231370">)</span>&nbsp;<span class="op" id="3231372">(</span><span class="ident" id="3231373">off2</span>&nbsp;<span class="builtintype" id="3231378">int</span><span class="op" id="3231381">,</span>&nbsp;<span class="ident" id="3231383">ok</span>&nbsp;<span class="builtintype" id="3231386">bool</span><span class="op" id="3231390">)</span>&nbsp;<span class="op" id="3231392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3231395">var</span>&nbsp;<span class="ident" id="3231399">off1</span>&nbsp;<span class="builtintype" id="3231404">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3231409">//&nbsp;pack&nbsp;twice,&nbsp;once&nbsp;to&nbsp;find&nbsp;end&nbsp;of&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3231452">//&nbsp;and&nbsp;again&nbsp;to&nbsp;find&nbsp;end&nbsp;of&nbsp;packet.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3231489">//&nbsp;a&nbsp;bit&nbsp;inefficient&nbsp;but&nbsp;this&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;fast.</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3231545">//&nbsp;off1&nbsp;is&nbsp;end&nbsp;of&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3231571">//&nbsp;off2&nbsp;is&nbsp;end&nbsp;of&nbsp;rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3231593">off1</span><span class="op" id="3231597">,</span>&nbsp;<span class="ident" id="3231599">ok</span>&nbsp;<span class="op" id="3231602">=</span>&nbsp;<span class="ident" id="3231604">packStruct</span><span class="op" id="3231614">(</span><span class="ident" id="3231615">rr</span><span class="op" id="3231617">.</span><span class="ident" id="3231618">Header</span><span class="op" id="3231624">(</span><span class="op" id="3231625">)</span><span class="op" id="3231626">,</span>&nbsp;<span class="ident" id="3231628">msg</span><span class="op" id="3231631">,</span>&nbsp;<span class="ident" id="3231633">off</span><span class="op" id="3231636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3231639">off2</span><span class="op" id="3231643">,</span>&nbsp;<span class="ident" id="3231645">ok</span>&nbsp;<span class="op" id="3231648">=</span>&nbsp;<span class="ident" id="3231650">packStruct</span><span class="op" id="3231660">(</span><span class="ident" id="3231661">rr</span><span class="op" id="3231663">,</span>&nbsp;<span class="ident" id="3231665">msg</span><span class="op" id="3231668">,</span>&nbsp;<span class="ident" id="3231670">off</span><span class="op" id="3231673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3231676">if</span>&nbsp;<span class="op" id="3231679">!</span><span class="ident" id="3231680">ok</span>&nbsp;<span class="op" id="3231683">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3231687">return</span>&nbsp;<span class="builtinfunc" id="3231694">len</span><span class="op" id="3231697">(</span><span class="ident" id="3231698">msg</span><span class="op" id="3231701">)</span><span class="op" id="3231702">,</span>&nbsp;<span class="builtintype" id="3231704">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3231711">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3231714">//&nbsp;pack&nbsp;a&nbsp;third&nbsp;time;&nbsp;redo&nbsp;header&nbsp;with&nbsp;correct&nbsp;data&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3231774">rr</span><span class="op" id="3231776">.</span><span class="ident" id="3231777">Header</span><span class="op" id="3231783">(</span><span class="op" id="3231784">)</span><span class="op" id="3231785">.</span><span class="ident" id="3231786">Rdlength</span>&nbsp;<span class="op" id="3231795">=</span>&nbsp;<span class="builtintype" id="3231797">uint16</span><span class="op" id="3231803">(</span><span class="ident" id="3231804">off2</span>&nbsp;<span class="op" id="3231809">-</span>&nbsp;<span class="ident" id="3231811">off1</span><span class="op" id="3231815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3231818">packStruct</span><span class="op" id="3231828">(</span><span class="ident" id="3231829">rr</span><span class="op" id="3231831">.</span><span class="ident" id="3231832">Header</span><span class="op" id="3231838">(</span><span class="op" id="3231839">)</span><span class="op" id="3231840">,</span>&nbsp;<span class="ident" id="3231842">msg</span><span class="op" id="3231845">,</span>&nbsp;<span class="ident" id="3231847">off</span><span class="op" id="3231850">)</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3231853">return</span>&nbsp;<span class="ident" id="3231860">off2</span><span class="op" id="3231864">,</span>&nbsp;<span class="builtintype" id="3231866">true</span><br>
<span class="lineno"></span><span class="op" id="3231871">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3231874">//&nbsp;Resource&nbsp;record&nbsp;unpacker.</span><br>
<span class="lineno"></span><span class="keyword" id="3231903">func</span>&nbsp;<span class="ident" id="3231908">unpackRR</span><span class="op" id="3231916">(</span><span class="ident" id="3231917">msg</span>&nbsp;<span class="op" id="3231921">[</span><span class="op" id="3231922">]</span><span class="builtintype" id="3231923">byte</span><span class="op" id="3231927">,</span>&nbsp;<span class="ident" id="3231929">off</span>&nbsp;<span class="builtintype" id="3231933">int</span><span class="op" id="3231936">)</span>&nbsp;<span class="op" id="3231938">(</span><span class="ident" id="3231939">rr</span>&nbsp;<span class="ident" id="3231942">dnsRR</span><span class="op" id="3231947">,</span>&nbsp;<span class="ident" id="3231949">off1</span>&nbsp;<span class="builtintype" id="3231954">int</span><span class="op" id="3231957">,</span>&nbsp;<span class="ident" id="3231959">ok</span>&nbsp;<span class="builtintype" id="3231962">bool</span><span class="op" id="3231966">)</span>&nbsp;<span class="op" id="3231968">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3231971">//&nbsp;unpack&nbsp;just&nbsp;the&nbsp;header,&nbsp;to&nbsp;find&nbsp;the&nbsp;rr&nbsp;type&nbsp;and&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3232030">var</span>&nbsp;<span class="ident" id="3232034">h</span>&nbsp;<span class="ident" id="3232036">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3232050">off0</span>&nbsp;<span class="op" id="3232055">:=</span>&nbsp;<span class="ident" id="3232058">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3232063">if</span>&nbsp;<span class="ident" id="3232066">off</span><span class="op" id="3232069">,</span>&nbsp;<span class="ident" id="3232071">ok</span>&nbsp;<span class="op" id="3232074">=</span>&nbsp;<span class="ident" id="3232076">unpackStruct</span><span class="op" id="3232088">(</span><span class="op" id="3232089">&amp;</span><span class="ident" id="3232090">h</span><span class="op" id="3232091">,</span>&nbsp;<span class="ident" id="3232093">msg</span><span class="op" id="3232096">,</span>&nbsp;<span class="ident" id="3232098">off</span><span class="op" id="3232101">)</span><span class="op" id="3232102">;</span>&nbsp;<span class="op" id="3232104">!</span><span class="ident" id="3232105">ok</span>&nbsp;<span class="op" id="3232108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3232112">return</span>&nbsp;<span class="builtintype" id="3232119">nil</span><span class="op" id="3232122">,</span>&nbsp;<span class="builtinfunc" id="3232124">len</span><span class="op" id="3232127">(</span><span class="ident" id="3232128">msg</span><span class="op" id="3232131">)</span><span class="op" id="3232132">,</span>&nbsp;<span class="builtintype" id="3232134">false</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3232141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3232144">end</span>&nbsp;<span class="op" id="3232148">:=</span>&nbsp;<span class="ident" id="3232151">off</span>&nbsp;<span class="op" id="3232155">+</span>&nbsp;<span class="builtintype" id="3232157">int</span><span class="op" id="3232160">(</span><span class="ident" id="3232161">h</span><span class="op" id="3232162">.</span><span class="ident" id="3232163">Rdlength</span><span class="op" id="3232171">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3232175">//&nbsp;make&nbsp;an&nbsp;rr&nbsp;of&nbsp;that&nbsp;type&nbsp;and&nbsp;re-unpack.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3232218">//&nbsp;again&nbsp;inefficient&nbsp;but&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;fast.</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3232269">mk</span><span class="op" id="3232271">,</span>&nbsp;<span class="ident" id="3232273">known</span>&nbsp;<span class="op" id="3232279">:=</span>&nbsp;<span class="ident" id="3232282">rr_mk</span><span class="op" id="3232287">[</span><span class="builtintype" id="3232288">int</span><span class="op" id="3232291">(</span><span class="ident" id="3232292">h</span><span class="op" id="3232293">.</span><span class="ident" id="3232294">Rrtype</span><span class="op" id="3232300">)</span><span class="op" id="3232301">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3232304">if</span>&nbsp;<span class="op" id="3232307">!</span><span class="ident" id="3232308">known</span>&nbsp;<span class="op" id="3232314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3232318">return</span>&nbsp;<span class="op" id="3232325">&amp;</span><span class="ident" id="3232326">h</span><span class="op" id="3232327">,</span>&nbsp;<span class="ident" id="3232329">end</span><span class="op" id="3232332">,</span>&nbsp;<span class="builtintype" id="3232334">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3232340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3232343">rr</span>&nbsp;<span class="op" id="3232346">=</span>&nbsp;<span class="ident" id="3232348">mk</span><span class="op" id="3232350">(</span><span class="op" id="3232351">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3232354">off</span><span class="op" id="3232357">,</span>&nbsp;<span class="ident" id="3232359">ok</span>&nbsp;<span class="op" id="3232362">=</span>&nbsp;<span class="ident" id="3232364">unpackStruct</span><span class="op" id="3232376">(</span><span class="ident" id="3232377">rr</span><span class="op" id="3232379">,</span>&nbsp;<span class="ident" id="3232381">msg</span><span class="op" id="3232384">,</span>&nbsp;<span class="ident" id="3232386">off0</span><span class="op" id="3232390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3232393">if</span>&nbsp;<span class="ident" id="3232396">off</span>&nbsp;<span class="op" id="3232400">!=</span>&nbsp;<span class="ident" id="3232403">end</span>&nbsp;<span class="op" id="3232407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3232411">return</span>&nbsp;<span class="op" id="3232418">&amp;</span><span class="ident" id="3232419">h</span><span class="op" id="3232420">,</span>&nbsp;<span class="ident" id="3232422">end</span><span class="op" id="3232425">,</span>&nbsp;<span class="builtintype" id="3232427">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3232433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3232436">return</span>&nbsp;<span class="ident" id="3232443">rr</span><span class="op" id="3232445">,</span>&nbsp;<span class="ident" id="3232447">off</span><span class="op" id="3232450">,</span>&nbsp;<span class="ident" id="3232452">ok</span><br>
<span class="lineno">710</span><span class="op" id="3232455">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3232458">//&nbsp;Usable&nbsp;representation&nbsp;of&nbsp;a&nbsp;DNS&nbsp;packet.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3232501">//&nbsp;A&nbsp;manually-unpacked&nbsp;version&nbsp;of&nbsp;(id,&nbsp;bits).</span><br>
<span class="lineno">715</span><span class="comment" id="3232547">//&nbsp;This&nbsp;is&nbsp;in&nbsp;its&nbsp;own&nbsp;struct&nbsp;for&nbsp;easy&nbsp;printing.</span><br>
<span class="lineno"></span><span class="keyword" id="3232595">type</span>&nbsp;<span class="ident" id="3232600">dnsMsgHdr</span>&nbsp;<span class="keyword" id="3232610">struct</span>&nbsp;<span class="op" id="3232617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3232620">id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3232640">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3232648">response</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3232668">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3232674">opcode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3232694">int</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3232699">authoritative</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3232719">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3232725">truncated</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3232745">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3232751">recursion_desired</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3232771">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3232777">recursion_available</span>&nbsp;<span class="builtintype" id="3232797">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3232803">rcode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3232823">int</span><br>
<span class="lineno">725</span><span class="op" id="3232827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3232830">func</span>&nbsp;<span class="op" id="3232835">(</span><span class="ident" id="3232836">h</span>&nbsp;<span class="op" id="3232838">*</span><span class="ident" id="3232839">dnsMsgHdr</span><span class="op" id="3232848">)</span>&nbsp;<span class="ident" id="3232850">Walk</span><span class="op" id="3232854">(</span><span class="ident" id="3232855">f</span>&nbsp;<span class="keyword" id="3232857">func</span><span class="op" id="3232861">(</span><span class="ident" id="3232862">v</span>&nbsp;<span class="keyword" id="3232864">interface</span><span class="op" id="3232873">{</span><span class="op" id="3232874">}</span><span class="op" id="3232875">,</span>&nbsp;<span class="ident" id="3232877">name</span><span class="op" id="3232881">,</span>&nbsp;<span class="ident" id="3232883">tag</span>&nbsp;<span class="builtintype" id="3232887">string</span><span class="op" id="3232893">)</span>&nbsp;<span class="builtintype" id="3232895">bool</span><span class="op" id="3232899">)</span>&nbsp;<span class="builtintype" id="3232901">bool</span>&nbsp;<span class="op" id="3232906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3232909">return</span>&nbsp;<span class="ident" id="3232916">f</span><span class="op" id="3232917">(</span><span class="op" id="3232918">&amp;</span><span class="ident" id="3232919">h</span><span class="op" id="3232920">.</span><span class="ident" id="3232921">id</span><span class="op" id="3232923">,</span>&nbsp;<span class="string" id="3232925">&#34;id&#34;</span><span class="op" id="3232929">,</span>&nbsp;<span class="string" id="3232931">&#34;&#34;</span><span class="op" id="3232933">)</span>&nbsp;<span class="op" id="3232935">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3232940">f</span><span class="op" id="3232941">(</span><span class="op" id="3232942">&amp;</span><span class="ident" id="3232943">h</span><span class="op" id="3232944">.</span><span class="ident" id="3232945">response</span><span class="op" id="3232953">,</span>&nbsp;<span class="string" id="3232955">&#34;response&#34;</span><span class="op" id="3232965">,</span>&nbsp;<span class="string" id="3232967">&#34;&#34;</span><span class="op" id="3232969">)</span>&nbsp;<span class="op" id="3232971">&amp;&amp;</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3232976">f</span><span class="op" id="3232977">(</span><span class="op" id="3232978">&amp;</span><span class="ident" id="3232979">h</span><span class="op" id="3232980">.</span><span class="ident" id="3232981">opcode</span><span class="op" id="3232987">,</span>&nbsp;<span class="string" id="3232989">&#34;opcode&#34;</span><span class="op" id="3232997">,</span>&nbsp;<span class="string" id="3232999">&#34;&#34;</span><span class="op" id="3233001">)</span>&nbsp;<span class="op" id="3233003">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233008">f</span><span class="op" id="3233009">(</span><span class="op" id="3233010">&amp;</span><span class="ident" id="3233011">h</span><span class="op" id="3233012">.</span><span class="ident" id="3233013">authoritative</span><span class="op" id="3233026">,</span>&nbsp;<span class="string" id="3233028">&#34;authoritative&#34;</span><span class="op" id="3233043">,</span>&nbsp;<span class="string" id="3233045">&#34;&#34;</span><span class="op" id="3233047">)</span>&nbsp;<span class="op" id="3233049">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233054">f</span><span class="op" id="3233055">(</span><span class="op" id="3233056">&amp;</span><span class="ident" id="3233057">h</span><span class="op" id="3233058">.</span><span class="ident" id="3233059">truncated</span><span class="op" id="3233068">,</span>&nbsp;<span class="string" id="3233070">&#34;truncated&#34;</span><span class="op" id="3233081">,</span>&nbsp;<span class="string" id="3233083">&#34;&#34;</span><span class="op" id="3233085">)</span>&nbsp;<span class="op" id="3233087">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233092">f</span><span class="op" id="3233093">(</span><span class="op" id="3233094">&amp;</span><span class="ident" id="3233095">h</span><span class="op" id="3233096">.</span><span class="ident" id="3233097">recursion_desired</span><span class="op" id="3233114">,</span>&nbsp;<span class="string" id="3233116">&#34;recursion_desired&#34;</span><span class="op" id="3233135">,</span>&nbsp;<span class="string" id="3233137">&#34;&#34;</span><span class="op" id="3233139">)</span>&nbsp;<span class="op" id="3233141">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233146">f</span><span class="op" id="3233147">(</span><span class="op" id="3233148">&amp;</span><span class="ident" id="3233149">h</span><span class="op" id="3233150">.</span><span class="ident" id="3233151">recursion_available</span><span class="op" id="3233170">,</span>&nbsp;<span class="string" id="3233172">&#34;recursion_available&#34;</span><span class="op" id="3233193">,</span>&nbsp;<span class="string" id="3233195">&#34;&#34;</span><span class="op" id="3233197">)</span>&nbsp;<span class="op" id="3233199">&amp;&amp;</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233204">f</span><span class="op" id="3233205">(</span><span class="op" id="3233206">&amp;</span><span class="ident" id="3233207">h</span><span class="op" id="3233208">.</span><span class="ident" id="3233209">rcode</span><span class="op" id="3233214">,</span>&nbsp;<span class="string" id="3233216">&#34;rcode&#34;</span><span class="op" id="3233223">,</span>&nbsp;<span class="string" id="3233225">&#34;&#34;</span><span class="op" id="3233227">)</span><br>
<span class="lineno"></span><span class="op" id="3233229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3233232">type</span>&nbsp;<span class="ident" id="3233237">dnsMsg</span>&nbsp;<span class="keyword" id="3233244">struct</span>&nbsp;<span class="op" id="3233251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233254">dnsMsgHdr</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233265">question</span>&nbsp;<span class="op" id="3233274">[</span><span class="op" id="3233275">]</span><span class="ident" id="3233276">dnsQuestion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233289">answer</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3233298">[</span><span class="op" id="3233299">]</span><span class="ident" id="3233300">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233307">ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3233316">[</span><span class="op" id="3233317">]</span><span class="ident" id="3233318">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233325">extra</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3233334">[</span><span class="op" id="3233335">]</span><span class="ident" id="3233336">dnsRR</span><br>
<span class="lineno"></span><span class="op" id="3233342">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span><span class="keyword" id="3233345">func</span>&nbsp;<span class="op" id="3233350">(</span><span class="ident" id="3233351">dns</span>&nbsp;<span class="op" id="3233355">*</span><span class="ident" id="3233356">dnsMsg</span><span class="op" id="3233362">)</span>&nbsp;<span class="ident" id="3233364">Pack</span><span class="op" id="3233368">(</span><span class="op" id="3233369">)</span>&nbsp;<span class="op" id="3233371">(</span><span class="ident" id="3233372">msg</span>&nbsp;<span class="op" id="3233376">[</span><span class="op" id="3233377">]</span><span class="builtintype" id="3233378">byte</span><span class="op" id="3233382">,</span>&nbsp;<span class="ident" id="3233384">ok</span>&nbsp;<span class="builtintype" id="3233387">bool</span><span class="op" id="3233391">)</span>&nbsp;<span class="op" id="3233393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3233396">var</span>&nbsp;<span class="ident" id="3233400">dh</span>&nbsp;<span class="ident" id="3233403">dnsHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3233415">//&nbsp;Convert&nbsp;convenient&nbsp;dnsMsg&nbsp;into&nbsp;wire-like&nbsp;dnsHeader.</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233471">dh</span><span class="op" id="3233473">.</span><span class="ident" id="3233474">Id</span>&nbsp;<span class="op" id="3233477">=</span>&nbsp;<span class="ident" id="3233479">dns</span><span class="op" id="3233482">.</span><span class="ident" id="3233483">id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233487">dh</span><span class="op" id="3233489">.</span><span class="ident" id="3233490">Bits</span>&nbsp;<span class="op" id="3233495">=</span>&nbsp;<span class="builtintype" id="3233497">uint16</span><span class="op" id="3233503">(</span><span class="ident" id="3233504">dns</span><span class="op" id="3233507">.</span><span class="ident" id="3233508">opcode</span><span class="op" id="3233514">)</span><span class="op" id="3233515">&lt;&lt;</span><span class="num" id="3233517">11</span>&nbsp;<span class="op" id="3233520">|</span>&nbsp;<span class="builtintype" id="3233522">uint16</span><span class="op" id="3233528">(</span><span class="ident" id="3233529">dns</span><span class="op" id="3233532">.</span><span class="ident" id="3233533">rcode</span><span class="op" id="3233538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3233541">if</span>&nbsp;<span class="ident" id="3233544">dns</span><span class="op" id="3233547">.</span><span class="ident" id="3233548">recursion_available</span>&nbsp;<span class="op" id="3233568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233572">dh</span><span class="op" id="3233574">.</span><span class="ident" id="3233575">Bits</span>&nbsp;<span class="op" id="3233580">|=</span>&nbsp;<span class="ident" id="3233583">_RA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3233588">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3233591">if</span>&nbsp;<span class="ident" id="3233594">dns</span><span class="op" id="3233597">.</span><span class="ident" id="3233598">recursion_desired</span>&nbsp;<span class="op" id="3233616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233620">dh</span><span class="op" id="3233622">.</span><span class="ident" id="3233623">Bits</span>&nbsp;<span class="op" id="3233628">|=</span>&nbsp;<span class="ident" id="3233631">_RD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3233636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3233639">if</span>&nbsp;<span class="ident" id="3233642">dns</span><span class="op" id="3233645">.</span><span class="ident" id="3233646">truncated</span>&nbsp;<span class="op" id="3233656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233660">dh</span><span class="op" id="3233662">.</span><span class="ident" id="3233663">Bits</span>&nbsp;<span class="op" id="3233668">|=</span>&nbsp;<span class="ident" id="3233671">_TC</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3233676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3233679">if</span>&nbsp;<span class="ident" id="3233682">dns</span><span class="op" id="3233685">.</span><span class="ident" id="3233686">authoritative</span>&nbsp;<span class="op" id="3233700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233704">dh</span><span class="op" id="3233706">.</span><span class="ident" id="3233707">Bits</span>&nbsp;<span class="op" id="3233712">|=</span>&nbsp;<span class="ident" id="3233715">_AA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3233720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3233723">if</span>&nbsp;<span class="ident" id="3233726">dns</span><span class="op" id="3233729">.</span><span class="ident" id="3233730">response</span>&nbsp;<span class="op" id="3233739">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233743">dh</span><span class="op" id="3233745">.</span><span class="ident" id="3233746">Bits</span>&nbsp;<span class="op" id="3233751">|=</span>&nbsp;<span class="ident" id="3233754">_QR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3233759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3233763">//&nbsp;Prepare&nbsp;variable&nbsp;sized&nbsp;arrays.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233798">question</span>&nbsp;<span class="op" id="3233807">:=</span>&nbsp;<span class="ident" id="3233810">dns</span><span class="op" id="3233813">.</span><span class="ident" id="3233814">question</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233824">answer</span>&nbsp;<span class="op" id="3233831">:=</span>&nbsp;<span class="ident" id="3233834">dns</span><span class="op" id="3233837">.</span><span class="ident" id="3233838">answer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233846">ns</span>&nbsp;<span class="op" id="3233849">:=</span>&nbsp;<span class="ident" id="3233852">dns</span><span class="op" id="3233855">.</span><span class="ident" id="3233856">ns</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233860">extra</span>&nbsp;<span class="op" id="3233866">:=</span>&nbsp;<span class="ident" id="3233869">dns</span><span class="op" id="3233872">.</span><span class="ident" id="3233873">extra</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233881">dh</span><span class="op" id="3233883">.</span><span class="ident" id="3233884">Qdcount</span>&nbsp;<span class="op" id="3233892">=</span>&nbsp;<span class="builtintype" id="3233894">uint16</span><span class="op" id="3233900">(</span><span class="builtinfunc" id="3233901">len</span><span class="op" id="3233904">(</span><span class="ident" id="3233905">question</span><span class="op" id="3233913">)</span><span class="op" id="3233914">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233917">dh</span><span class="op" id="3233919">.</span><span class="ident" id="3233920">Ancount</span>&nbsp;<span class="op" id="3233928">=</span>&nbsp;<span class="builtintype" id="3233930">uint16</span><span class="op" id="3233936">(</span><span class="builtinfunc" id="3233937">len</span><span class="op" id="3233940">(</span><span class="ident" id="3233941">answer</span><span class="op" id="3233947">)</span><span class="op" id="3233948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233951">dh</span><span class="op" id="3233953">.</span><span class="ident" id="3233954">Nscount</span>&nbsp;<span class="op" id="3233962">=</span>&nbsp;<span class="builtintype" id="3233964">uint16</span><span class="op" id="3233970">(</span><span class="builtinfunc" id="3233971">len</span><span class="op" id="3233974">(</span><span class="ident" id="3233975">ns</span><span class="op" id="3233977">)</span><span class="op" id="3233978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3233981">dh</span><span class="op" id="3233983">.</span><span class="ident" id="3233984">Arcount</span>&nbsp;<span class="op" id="3233992">=</span>&nbsp;<span class="builtintype" id="3233994">uint16</span><span class="op" id="3234000">(</span><span class="builtinfunc" id="3234001">len</span><span class="op" id="3234004">(</span><span class="ident" id="3234005">extra</span><span class="op" id="3234010">)</span><span class="op" id="3234011">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3234015">//&nbsp;Could&nbsp;work&nbsp;harder&nbsp;to&nbsp;calculate&nbsp;message&nbsp;size,</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3234064">//&nbsp;but&nbsp;this&nbsp;is&nbsp;far&nbsp;more&nbsp;than&nbsp;we&nbsp;need&nbsp;and&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3234110">//&nbsp;big&nbsp;enough&nbsp;to&nbsp;hurt&nbsp;the&nbsp;allocator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3234148">msg</span>&nbsp;<span class="op" id="3234152">=</span>&nbsp;<span class="builtinfunc" id="3234154">make</span><span class="op" id="3234158">(</span><span class="op" id="3234159">[</span><span class="op" id="3234160">]</span><span class="builtintype" id="3234161">byte</span><span class="op" id="3234165">,</span>&nbsp;<span class="num" id="3234167">2000</span><span class="op" id="3234171">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3234175">//&nbsp;Pack&nbsp;it&nbsp;in:&nbsp;header&nbsp;and&nbsp;then&nbsp;the&nbsp;pieces.</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3234219">off</span>&nbsp;<span class="op" id="3234223">:=</span>&nbsp;<span class="num" id="3234226">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3234229">off</span><span class="op" id="3234232">,</span>&nbsp;<span class="ident" id="3234234">ok</span>&nbsp;<span class="op" id="3234237">=</span>&nbsp;<span class="ident" id="3234239">packStruct</span><span class="op" id="3234249">(</span><span class="op" id="3234250">&amp;</span><span class="ident" id="3234251">dh</span><span class="op" id="3234253">,</span>&nbsp;<span class="ident" id="3234255">msg</span><span class="op" id="3234258">,</span>&nbsp;<span class="ident" id="3234260">off</span><span class="op" id="3234263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3234266">for</span>&nbsp;<span class="ident" id="3234270">i</span>&nbsp;<span class="op" id="3234272">:=</span>&nbsp;<span class="num" id="3234275">0</span><span class="op" id="3234276">;</span>&nbsp;<span class="ident" id="3234278">i</span>&nbsp;<span class="op" id="3234280">&lt;</span>&nbsp;<span class="builtinfunc" id="3234282">len</span><span class="op" id="3234285">(</span><span class="ident" id="3234286">question</span><span class="op" id="3234294">)</span><span class="op" id="3234295">;</span>&nbsp;<span class="ident" id="3234297">i</span><span class="op" id="3234298">++</span>&nbsp;<span class="op" id="3234301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3234305">off</span><span class="op" id="3234308">,</span>&nbsp;<span class="ident" id="3234310">ok</span>&nbsp;<span class="op" id="3234313">=</span>&nbsp;<span class="ident" id="3234315">packStruct</span><span class="op" id="3234325">(</span><span class="op" id="3234326">&amp;</span><span class="ident" id="3234327">question</span><span class="op" id="3234335">[</span><span class="ident" id="3234336">i</span><span class="op" id="3234337">]</span><span class="op" id="3234338">,</span>&nbsp;<span class="ident" id="3234340">msg</span><span class="op" id="3234343">,</span>&nbsp;<span class="ident" id="3234345">off</span><span class="op" id="3234348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3234351">}</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3234354">for</span>&nbsp;<span class="ident" id="3234358">i</span>&nbsp;<span class="op" id="3234360">:=</span>&nbsp;<span class="num" id="3234363">0</span><span class="op" id="3234364">;</span>&nbsp;<span class="ident" id="3234366">i</span>&nbsp;<span class="op" id="3234368">&lt;</span>&nbsp;<span class="builtinfunc" id="3234370">len</span><span class="op" id="3234373">(</span><span class="ident" id="3234374">answer</span><span class="op" id="3234380">)</span><span class="op" id="3234381">;</span>&nbsp;<span class="ident" id="3234383">i</span><span class="op" id="3234384">++</span>&nbsp;<span class="op" id="3234387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3234391">off</span><span class="op" id="3234394">,</span>&nbsp;<span class="ident" id="3234396">ok</span>&nbsp;<span class="op" id="3234399">=</span>&nbsp;<span class="ident" id="3234401">packRR</span><span class="op" id="3234407">(</span><span class="ident" id="3234408">answer</span><span class="op" id="3234414">[</span><span class="ident" id="3234415">i</span><span class="op" id="3234416">]</span><span class="op" id="3234417">,</span>&nbsp;<span class="ident" id="3234419">msg</span><span class="op" id="3234422">,</span>&nbsp;<span class="ident" id="3234424">off</span><span class="op" id="3234427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3234430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3234433">for</span>&nbsp;<span class="ident" id="3234437">i</span>&nbsp;<span class="op" id="3234439">:=</span>&nbsp;<span class="num" id="3234442">0</span><span class="op" id="3234443">;</span>&nbsp;<span class="ident" id="3234445">i</span>&nbsp;<span class="op" id="3234447">&lt;</span>&nbsp;<span class="builtinfunc" id="3234449">len</span><span class="op" id="3234452">(</span><span class="ident" id="3234453">ns</span><span class="op" id="3234455">)</span><span class="op" id="3234456">;</span>&nbsp;<span class="ident" id="3234458">i</span><span class="op" id="3234459">++</span>&nbsp;<span class="op" id="3234462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3234466">off</span><span class="op" id="3234469">,</span>&nbsp;<span class="ident" id="3234471">ok</span>&nbsp;<span class="op" id="3234474">=</span>&nbsp;<span class="ident" id="3234476">packRR</span><span class="op" id="3234482">(</span><span class="ident" id="3234483">ns</span><span class="op" id="3234485">[</span><span class="ident" id="3234486">i</span><span class="op" id="3234487">]</span><span class="op" id="3234488">,</span>&nbsp;<span class="ident" id="3234490">msg</span><span class="op" id="3234493">,</span>&nbsp;<span class="ident" id="3234495">off</span><span class="op" id="3234498">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3234501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3234504">for</span>&nbsp;<span class="ident" id="3234508">i</span>&nbsp;<span class="op" id="3234510">:=</span>&nbsp;<span class="num" id="3234513">0</span><span class="op" id="3234514">;</span>&nbsp;<span class="ident" id="3234516">i</span>&nbsp;<span class="op" id="3234518">&lt;</span>&nbsp;<span class="builtinfunc" id="3234520">len</span><span class="op" id="3234523">(</span><span class="ident" id="3234524">extra</span><span class="op" id="3234529">)</span><span class="op" id="3234530">;</span>&nbsp;<span class="ident" id="3234532">i</span><span class="op" id="3234533">++</span>&nbsp;<span class="op" id="3234536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3234540">off</span><span class="op" id="3234543">,</span>&nbsp;<span class="ident" id="3234545">ok</span>&nbsp;<span class="op" id="3234548">=</span>&nbsp;<span class="ident" id="3234550">packRR</span><span class="op" id="3234556">(</span><span class="ident" id="3234557">extra</span><span class="op" id="3234562">[</span><span class="ident" id="3234563">i</span><span class="op" id="3234564">]</span><span class="op" id="3234565">,</span>&nbsp;<span class="ident" id="3234567">msg</span><span class="op" id="3234570">,</span>&nbsp;<span class="ident" id="3234572">off</span><span class="op" id="3234575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3234578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3234581">if</span>&nbsp;<span class="op" id="3234584">!</span><span class="ident" id="3234585">ok</span>&nbsp;<span class="op" id="3234588">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3234592">return</span>&nbsp;<span class="builtintype" id="3234599">nil</span><span class="op" id="3234602">,</span>&nbsp;<span class="builtintype" id="3234604">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3234611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3234614">return</span>&nbsp;<span class="ident" id="3234621">msg</span><span class="op" id="3234624">[</span><span class="num" id="3234625">0</span><span class="op" id="3234626">:</span><span class="ident" id="3234627">off</span><span class="op" id="3234630">]</span><span class="op" id="3234631">,</span>&nbsp;<span class="builtintype" id="3234633">true</span><br>
<span class="lineno"></span><span class="op" id="3234638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">805</span><span class="keyword" id="3234641">func</span>&nbsp;<span class="op" id="3234646">(</span><span class="ident" id="3234647">dns</span>&nbsp;<span class="op" id="3234651">*</span><span class="ident" id="3234652">dnsMsg</span><span class="op" id="3234658">)</span>&nbsp;<span class="ident" id="3234660">Unpack</span><span class="op" id="3234666">(</span><span class="ident" id="3234667">msg</span>&nbsp;<span class="op" id="3234671">[</span><span class="op" id="3234672">]</span><span class="builtintype" id="3234673">byte</span><span class="op" id="3234677">)</span>&nbsp;<span class="builtintype" id="3234679">bool</span>&nbsp;<span class="op" id="3234684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3234687">//&nbsp;Header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3234699">var</span>&nbsp;<span class="ident" id="3234703">dh</span>&nbsp;<span class="ident" id="3234706">dnsHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3234717">off</span>&nbsp;<span class="op" id="3234721">:=</span>&nbsp;<span class="num" id="3234724">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3234727">var</span>&nbsp;<span class="ident" id="3234731">ok</span>&nbsp;<span class="builtintype" id="3234734">bool</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3234740">if</span>&nbsp;<span class="ident" id="3234743">off</span><span class="op" id="3234746">,</span>&nbsp;<span class="ident" id="3234748">ok</span>&nbsp;<span class="op" id="3234751">=</span>&nbsp;<span class="ident" id="3234753">unpackStruct</span><span class="op" id="3234765">(</span><span class="op" id="3234766">&amp;</span><span class="ident" id="3234767">dh</span><span class="op" id="3234769">,</span>&nbsp;<span class="ident" id="3234771">msg</span><span class="op" id="3234774">,</span>&nbsp;<span class="ident" id="3234776">off</span><span class="op" id="3234779">)</span><span class="op" id="3234780">;</span>&nbsp;<span class="op" id="3234782">!</span><span class="ident" id="3234783">ok</span>&nbsp;<span class="op" id="3234786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3234790">return</span>&nbsp;<span class="builtintype" id="3234797">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3234804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3234807">dns</span><span class="op" id="3234810">.</span><span class="ident" id="3234811">id</span>&nbsp;<span class="op" id="3234814">=</span>&nbsp;<span class="ident" id="3234816">dh</span><span class="op" id="3234818">.</span><span class="ident" id="3234819">Id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3234823">dns</span><span class="op" id="3234826">.</span><span class="ident" id="3234827">response</span>&nbsp;<span class="op" id="3234836">=</span>&nbsp;<span class="op" id="3234838">(</span><span class="ident" id="3234839">dh</span><span class="op" id="3234841">.</span><span class="ident" id="3234842">Bits</span>&nbsp;<span class="op" id="3234847">&amp;</span>&nbsp;<span class="ident" id="3234849">_QR</span><span class="op" id="3234852">)</span>&nbsp;<span class="op" id="3234854">!=</span>&nbsp;<span class="num" id="3234857">0</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3234860">dns</span><span class="op" id="3234863">.</span><span class="ident" id="3234864">opcode</span>&nbsp;<span class="op" id="3234871">=</span>&nbsp;<span class="builtintype" id="3234873">int</span><span class="op" id="3234876">(</span><span class="ident" id="3234877">dh</span><span class="op" id="3234879">.</span><span class="ident" id="3234880">Bits</span><span class="op" id="3234884">&gt;&gt;</span><span class="num" id="3234886">11</span><span class="op" id="3234888">)</span>&nbsp;<span class="op" id="3234890">&amp;</span>&nbsp;<span class="num" id="3234892">0xF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3234897">dns</span><span class="op" id="3234900">.</span><span class="ident" id="3234901">authoritative</span>&nbsp;<span class="op" id="3234915">=</span>&nbsp;<span class="op" id="3234917">(</span><span class="ident" id="3234918">dh</span><span class="op" id="3234920">.</span><span class="ident" id="3234921">Bits</span>&nbsp;<span class="op" id="3234926">&amp;</span>&nbsp;<span class="ident" id="3234928">_AA</span><span class="op" id="3234931">)</span>&nbsp;<span class="op" id="3234933">!=</span>&nbsp;<span class="num" id="3234936">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3234939">dns</span><span class="op" id="3234942">.</span><span class="ident" id="3234943">truncated</span>&nbsp;<span class="op" id="3234953">=</span>&nbsp;<span class="op" id="3234955">(</span><span class="ident" id="3234956">dh</span><span class="op" id="3234958">.</span><span class="ident" id="3234959">Bits</span>&nbsp;<span class="op" id="3234964">&amp;</span>&nbsp;<span class="ident" id="3234966">_TC</span><span class="op" id="3234969">)</span>&nbsp;<span class="op" id="3234971">!=</span>&nbsp;<span class="num" id="3234974">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3234977">dns</span><span class="op" id="3234980">.</span><span class="ident" id="3234981">recursion_desired</span>&nbsp;<span class="op" id="3234999">=</span>&nbsp;<span class="op" id="3235001">(</span><span class="ident" id="3235002">dh</span><span class="op" id="3235004">.</span><span class="ident" id="3235005">Bits</span>&nbsp;<span class="op" id="3235010">&amp;</span>&nbsp;<span class="ident" id="3235012">_RD</span><span class="op" id="3235015">)</span>&nbsp;<span class="op" id="3235017">!=</span>&nbsp;<span class="num" id="3235020">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235023">dns</span><span class="op" id="3235026">.</span><span class="ident" id="3235027">recursion_available</span>&nbsp;<span class="op" id="3235047">=</span>&nbsp;<span class="op" id="3235049">(</span><span class="ident" id="3235050">dh</span><span class="op" id="3235052">.</span><span class="ident" id="3235053">Bits</span>&nbsp;<span class="op" id="3235058">&amp;</span>&nbsp;<span class="ident" id="3235060">_RA</span><span class="op" id="3235063">)</span>&nbsp;<span class="op" id="3235065">!=</span>&nbsp;<span class="num" id="3235068">0</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235071">dns</span><span class="op" id="3235074">.</span><span class="ident" id="3235075">rcode</span>&nbsp;<span class="op" id="3235081">=</span>&nbsp;<span class="builtintype" id="3235083">int</span><span class="op" id="3235086">(</span><span class="ident" id="3235087">dh</span><span class="op" id="3235089">.</span><span class="ident" id="3235090">Bits</span>&nbsp;<span class="op" id="3235095">&amp;</span>&nbsp;<span class="num" id="3235097">0xF</span><span class="op" id="3235100">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3235104">//&nbsp;Arrays.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235116">dns</span><span class="op" id="3235119">.</span><span class="ident" id="3235120">question</span>&nbsp;<span class="op" id="3235129">=</span>&nbsp;<span class="builtinfunc" id="3235131">make</span><span class="op" id="3235135">(</span><span class="op" id="3235136">[</span><span class="op" id="3235137">]</span><span class="ident" id="3235138">dnsQuestion</span><span class="op" id="3235149">,</span>&nbsp;<span class="ident" id="3235151">dh</span><span class="op" id="3235153">.</span><span class="ident" id="3235154">Qdcount</span><span class="op" id="3235161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235164">dns</span><span class="op" id="3235167">.</span><span class="ident" id="3235168">answer</span>&nbsp;<span class="op" id="3235175">=</span>&nbsp;<span class="builtinfunc" id="3235177">make</span><span class="op" id="3235181">(</span><span class="op" id="3235182">[</span><span class="op" id="3235183">]</span><span class="ident" id="3235184">dnsRR</span><span class="op" id="3235189">,</span>&nbsp;<span class="num" id="3235191">0</span><span class="op" id="3235192">,</span>&nbsp;<span class="ident" id="3235194">dh</span><span class="op" id="3235196">.</span><span class="ident" id="3235197">Ancount</span><span class="op" id="3235204">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235207">dns</span><span class="op" id="3235210">.</span><span class="ident" id="3235211">ns</span>&nbsp;<span class="op" id="3235214">=</span>&nbsp;<span class="builtinfunc" id="3235216">make</span><span class="op" id="3235220">(</span><span class="op" id="3235221">[</span><span class="op" id="3235222">]</span><span class="ident" id="3235223">dnsRR</span><span class="op" id="3235228">,</span>&nbsp;<span class="num" id="3235230">0</span><span class="op" id="3235231">,</span>&nbsp;<span class="ident" id="3235233">dh</span><span class="op" id="3235235">.</span><span class="ident" id="3235236">Nscount</span><span class="op" id="3235243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235246">dns</span><span class="op" id="3235249">.</span><span class="ident" id="3235250">extra</span>&nbsp;<span class="op" id="3235256">=</span>&nbsp;<span class="builtinfunc" id="3235258">make</span><span class="op" id="3235262">(</span><span class="op" id="3235263">[</span><span class="op" id="3235264">]</span><span class="ident" id="3235265">dnsRR</span><span class="op" id="3235270">,</span>&nbsp;<span class="num" id="3235272">0</span><span class="op" id="3235273">,</span>&nbsp;<span class="ident" id="3235275">dh</span><span class="op" id="3235277">.</span><span class="ident" id="3235278">Arcount</span><span class="op" id="3235285">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3235289">var</span>&nbsp;<span class="ident" id="3235293">rec</span>&nbsp;<span class="ident" id="3235297">dnsRR</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3235305">for</span>&nbsp;<span class="ident" id="3235309">i</span>&nbsp;<span class="op" id="3235311">:=</span>&nbsp;<span class="num" id="3235314">0</span><span class="op" id="3235315">;</span>&nbsp;<span class="ident" id="3235317">i</span>&nbsp;<span class="op" id="3235319">&lt;</span>&nbsp;<span class="builtinfunc" id="3235321">len</span><span class="op" id="3235324">(</span><span class="ident" id="3235325">dns</span><span class="op" id="3235328">.</span><span class="ident" id="3235329">question</span><span class="op" id="3235337">)</span><span class="op" id="3235338">;</span>&nbsp;<span class="ident" id="3235340">i</span><span class="op" id="3235341">++</span>&nbsp;<span class="op" id="3235344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235348">off</span><span class="op" id="3235351">,</span>&nbsp;<span class="ident" id="3235353">ok</span>&nbsp;<span class="op" id="3235356">=</span>&nbsp;<span class="ident" id="3235358">unpackStruct</span><span class="op" id="3235370">(</span><span class="op" id="3235371">&amp;</span><span class="ident" id="3235372">dns</span><span class="op" id="3235375">.</span><span class="ident" id="3235376">question</span><span class="op" id="3235384">[</span><span class="ident" id="3235385">i</span><span class="op" id="3235386">]</span><span class="op" id="3235387">,</span>&nbsp;<span class="ident" id="3235389">msg</span><span class="op" id="3235392">,</span>&nbsp;<span class="ident" id="3235394">off</span><span class="op" id="3235397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3235400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3235403">for</span>&nbsp;<span class="ident" id="3235407">i</span>&nbsp;<span class="op" id="3235409">:=</span>&nbsp;<span class="num" id="3235412">0</span><span class="op" id="3235413">;</span>&nbsp;<span class="ident" id="3235415">i</span>&nbsp;<span class="op" id="3235417">&lt;</span>&nbsp;<span class="builtintype" id="3235419">int</span><span class="op" id="3235422">(</span><span class="ident" id="3235423">dh</span><span class="op" id="3235425">.</span><span class="ident" id="3235426">Ancount</span><span class="op" id="3235433">)</span><span class="op" id="3235434">;</span>&nbsp;<span class="ident" id="3235436">i</span><span class="op" id="3235437">++</span>&nbsp;<span class="op" id="3235440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235444">rec</span><span class="op" id="3235447">,</span>&nbsp;<span class="ident" id="3235449">off</span><span class="op" id="3235452">,</span>&nbsp;<span class="ident" id="3235454">ok</span>&nbsp;<span class="op" id="3235457">=</span>&nbsp;<span class="ident" id="3235459">unpackRR</span><span class="op" id="3235467">(</span><span class="ident" id="3235468">msg</span><span class="op" id="3235471">,</span>&nbsp;<span class="ident" id="3235473">off</span><span class="op" id="3235476">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3235480">if</span>&nbsp;<span class="op" id="3235483">!</span><span class="ident" id="3235484">ok</span>&nbsp;<span class="op" id="3235487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3235492">return</span>&nbsp;<span class="builtintype" id="3235499">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3235507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235511">dns</span><span class="op" id="3235514">.</span><span class="ident" id="3235515">answer</span>&nbsp;<span class="op" id="3235522">=</span>&nbsp;<span class="builtinfunc" id="3235524">append</span><span class="op" id="3235530">(</span><span class="ident" id="3235531">dns</span><span class="op" id="3235534">.</span><span class="ident" id="3235535">answer</span><span class="op" id="3235541">,</span>&nbsp;<span class="ident" id="3235543">rec</span><span class="op" id="3235546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3235549">}</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3235552">for</span>&nbsp;<span class="ident" id="3235556">i</span>&nbsp;<span class="op" id="3235558">:=</span>&nbsp;<span class="num" id="3235561">0</span><span class="op" id="3235562">;</span>&nbsp;<span class="ident" id="3235564">i</span>&nbsp;<span class="op" id="3235566">&lt;</span>&nbsp;<span class="builtintype" id="3235568">int</span><span class="op" id="3235571">(</span><span class="ident" id="3235572">dh</span><span class="op" id="3235574">.</span><span class="ident" id="3235575">Nscount</span><span class="op" id="3235582">)</span><span class="op" id="3235583">;</span>&nbsp;<span class="ident" id="3235585">i</span><span class="op" id="3235586">++</span>&nbsp;<span class="op" id="3235589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235593">rec</span><span class="op" id="3235596">,</span>&nbsp;<span class="ident" id="3235598">off</span><span class="op" id="3235601">,</span>&nbsp;<span class="ident" id="3235603">ok</span>&nbsp;<span class="op" id="3235606">=</span>&nbsp;<span class="ident" id="3235608">unpackRR</span><span class="op" id="3235616">(</span><span class="ident" id="3235617">msg</span><span class="op" id="3235620">,</span>&nbsp;<span class="ident" id="3235622">off</span><span class="op" id="3235625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3235629">if</span>&nbsp;<span class="op" id="3235632">!</span><span class="ident" id="3235633">ok</span>&nbsp;<span class="op" id="3235636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3235641">return</span>&nbsp;<span class="builtintype" id="3235648">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3235656">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235660">dns</span><span class="op" id="3235663">.</span><span class="ident" id="3235664">ns</span>&nbsp;<span class="op" id="3235667">=</span>&nbsp;<span class="builtinfunc" id="3235669">append</span><span class="op" id="3235675">(</span><span class="ident" id="3235676">dns</span><span class="op" id="3235679">.</span><span class="ident" id="3235680">ns</span><span class="op" id="3235682">,</span>&nbsp;<span class="ident" id="3235684">rec</span><span class="op" id="3235687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3235690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3235693">for</span>&nbsp;<span class="ident" id="3235697">i</span>&nbsp;<span class="op" id="3235699">:=</span>&nbsp;<span class="num" id="3235702">0</span><span class="op" id="3235703">;</span>&nbsp;<span class="ident" id="3235705">i</span>&nbsp;<span class="op" id="3235707">&lt;</span>&nbsp;<span class="builtintype" id="3235709">int</span><span class="op" id="3235712">(</span><span class="ident" id="3235713">dh</span><span class="op" id="3235715">.</span><span class="ident" id="3235716">Arcount</span><span class="op" id="3235723">)</span><span class="op" id="3235724">;</span>&nbsp;<span class="ident" id="3235726">i</span><span class="op" id="3235727">++</span>&nbsp;<span class="op" id="3235730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235734">rec</span><span class="op" id="3235737">,</span>&nbsp;<span class="ident" id="3235739">off</span><span class="op" id="3235742">,</span>&nbsp;<span class="ident" id="3235744">ok</span>&nbsp;<span class="op" id="3235747">=</span>&nbsp;<span class="ident" id="3235749">unpackRR</span><span class="op" id="3235757">(</span><span class="ident" id="3235758">msg</span><span class="op" id="3235761">,</span>&nbsp;<span class="ident" id="3235763">off</span><span class="op" id="3235766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3235770">if</span>&nbsp;<span class="op" id="3235773">!</span><span class="ident" id="3235774">ok</span>&nbsp;<span class="op" id="3235777">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3235782">return</span>&nbsp;<span class="builtintype" id="3235789">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3235797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235801">dns</span><span class="op" id="3235804">.</span><span class="ident" id="3235805">extra</span>&nbsp;<span class="op" id="3235811">=</span>&nbsp;<span class="builtinfunc" id="3235813">append</span><span class="op" id="3235819">(</span><span class="ident" id="3235820">dns</span><span class="op" id="3235823">.</span><span class="ident" id="3235824">extra</span><span class="op" id="3235829">,</span>&nbsp;<span class="ident" id="3235831">rec</span><span class="op" id="3235834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3235837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3235840">//&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;off&nbsp;!=&nbsp;len(msg)&nbsp;{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3235865">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;println(&#34;extra&nbsp;bytes&nbsp;in&nbsp;dns&nbsp;packet&#34;,&nbsp;off,&nbsp;&#34;&lt;&#34;,&nbsp;len(msg));</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3235928">//&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3235934">return</span>&nbsp;<span class="builtintype" id="3235941">true</span><br>
<span class="lineno"></span><span class="op" id="3235946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="keyword" id="3235949">func</span>&nbsp;<span class="op" id="3235954">(</span><span class="ident" id="3235955">dns</span>&nbsp;<span class="op" id="3235959">*</span><span class="ident" id="3235960">dnsMsg</span><span class="op" id="3235966">)</span>&nbsp;<span class="ident" id="3235968">String</span><span class="op" id="3235974">(</span><span class="op" id="3235975">)</span>&nbsp;<span class="builtintype" id="3235977">string</span>&nbsp;<span class="op" id="3235984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3235987">s</span>&nbsp;<span class="op" id="3235989">:=</span>&nbsp;<span class="string" id="3235992">&#34;DNS:&nbsp;&#34;</span>&nbsp;<span class="op" id="3236000">+</span>&nbsp;<span class="ident" id="3236002">printStruct</span><span class="op" id="3236013">(</span><span class="op" id="3236014">&amp;</span><span class="ident" id="3236015">dns</span><span class="op" id="3236018">.</span><span class="ident" id="3236019">dnsMsgHdr</span><span class="op" id="3236028">)</span>&nbsp;<span class="op" id="3236030">+</span>&nbsp;<span class="string" id="3236032">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3236038">if</span>&nbsp;<span class="builtinfunc" id="3236041">len</span><span class="op" id="3236044">(</span><span class="ident" id="3236045">dns</span><span class="op" id="3236048">.</span><span class="ident" id="3236049">question</span><span class="op" id="3236057">)</span>&nbsp;<span class="op" id="3236059">&gt;</span>&nbsp;<span class="num" id="3236061">0</span>&nbsp;<span class="op" id="3236063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3236067">s</span>&nbsp;<span class="op" id="3236069">+=</span>&nbsp;<span class="string" id="3236072">&#34;--&nbsp;Questions\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3236091">for</span>&nbsp;<span class="ident" id="3236095">i</span>&nbsp;<span class="op" id="3236097">:=</span>&nbsp;<span class="num" id="3236100">0</span><span class="op" id="3236101">;</span>&nbsp;<span class="ident" id="3236103">i</span>&nbsp;<span class="op" id="3236105">&lt;</span>&nbsp;<span class="builtinfunc" id="3236107">len</span><span class="op" id="3236110">(</span><span class="ident" id="3236111">dns</span><span class="op" id="3236114">.</span><span class="ident" id="3236115">question</span><span class="op" id="3236123">)</span><span class="op" id="3236124">;</span>&nbsp;<span class="ident" id="3236126">i</span><span class="op" id="3236127">++</span>&nbsp;<span class="op" id="3236130">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3236135">s</span>&nbsp;<span class="op" id="3236137">+=</span>&nbsp;<span class="ident" id="3236140">printStruct</span><span class="op" id="3236151">(</span><span class="op" id="3236152">&amp;</span><span class="ident" id="3236153">dns</span><span class="op" id="3236156">.</span><span class="ident" id="3236157">question</span><span class="op" id="3236165">[</span><span class="ident" id="3236166">i</span><span class="op" id="3236167">]</span><span class="op" id="3236168">)</span>&nbsp;<span class="op" id="3236170">+</span>&nbsp;<span class="string" id="3236172">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3236179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3236182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3236185">if</span>&nbsp;<span class="builtinfunc" id="3236188">len</span><span class="op" id="3236191">(</span><span class="ident" id="3236192">dns</span><span class="op" id="3236195">.</span><span class="ident" id="3236196">answer</span><span class="op" id="3236202">)</span>&nbsp;<span class="op" id="3236204">&gt;</span>&nbsp;<span class="num" id="3236206">0</span>&nbsp;<span class="op" id="3236208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3236212">s</span>&nbsp;<span class="op" id="3236214">+=</span>&nbsp;<span class="string" id="3236217">&#34;--&nbsp;Answers\n&#34;</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3236234">for</span>&nbsp;<span class="ident" id="3236238">i</span>&nbsp;<span class="op" id="3236240">:=</span>&nbsp;<span class="num" id="3236243">0</span><span class="op" id="3236244">;</span>&nbsp;<span class="ident" id="3236246">i</span>&nbsp;<span class="op" id="3236248">&lt;</span>&nbsp;<span class="builtinfunc" id="3236250">len</span><span class="op" id="3236253">(</span><span class="ident" id="3236254">dns</span><span class="op" id="3236257">.</span><span class="ident" id="3236258">answer</span><span class="op" id="3236264">)</span><span class="op" id="3236265">;</span>&nbsp;<span class="ident" id="3236267">i</span><span class="op" id="3236268">++</span>&nbsp;<span class="op" id="3236271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3236276">s</span>&nbsp;<span class="op" id="3236278">+=</span>&nbsp;<span class="ident" id="3236281">printStruct</span><span class="op" id="3236292">(</span><span class="ident" id="3236293">dns</span><span class="op" id="3236296">.</span><span class="ident" id="3236297">answer</span><span class="op" id="3236303">[</span><span class="ident" id="3236304">i</span><span class="op" id="3236305">]</span><span class="op" id="3236306">)</span>&nbsp;<span class="op" id="3236308">+</span>&nbsp;<span class="string" id="3236310">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3236317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3236320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3236323">if</span>&nbsp;<span class="builtinfunc" id="3236326">len</span><span class="op" id="3236329">(</span><span class="ident" id="3236330">dns</span><span class="op" id="3236333">.</span><span class="ident" id="3236334">ns</span><span class="op" id="3236336">)</span>&nbsp;<span class="op" id="3236338">&gt;</span>&nbsp;<span class="num" id="3236340">0</span>&nbsp;<span class="op" id="3236342">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3236346">s</span>&nbsp;<span class="op" id="3236348">+=</span>&nbsp;<span class="string" id="3236351">&#34;--&nbsp;Name&nbsp;servers\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3236373">for</span>&nbsp;<span class="ident" id="3236377">i</span>&nbsp;<span class="op" id="3236379">:=</span>&nbsp;<span class="num" id="3236382">0</span><span class="op" id="3236383">;</span>&nbsp;<span class="ident" id="3236385">i</span>&nbsp;<span class="op" id="3236387">&lt;</span>&nbsp;<span class="builtinfunc" id="3236389">len</span><span class="op" id="3236392">(</span><span class="ident" id="3236393">dns</span><span class="op" id="3236396">.</span><span class="ident" id="3236397">ns</span><span class="op" id="3236399">)</span><span class="op" id="3236400">;</span>&nbsp;<span class="ident" id="3236402">i</span><span class="op" id="3236403">++</span>&nbsp;<span class="op" id="3236406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3236411">s</span>&nbsp;<span class="op" id="3236413">+=</span>&nbsp;<span class="ident" id="3236416">printStruct</span><span class="op" id="3236427">(</span><span class="ident" id="3236428">dns</span><span class="op" id="3236431">.</span><span class="ident" id="3236432">ns</span><span class="op" id="3236434">[</span><span class="ident" id="3236435">i</span><span class="op" id="3236436">]</span><span class="op" id="3236437">)</span>&nbsp;<span class="op" id="3236439">+</span>&nbsp;<span class="string" id="3236441">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3236448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3236451">}</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3236454">if</span>&nbsp;<span class="builtinfunc" id="3236457">len</span><span class="op" id="3236460">(</span><span class="ident" id="3236461">dns</span><span class="op" id="3236464">.</span><span class="ident" id="3236465">extra</span><span class="op" id="3236470">)</span>&nbsp;<span class="op" id="3236472">&gt;</span>&nbsp;<span class="num" id="3236474">0</span>&nbsp;<span class="op" id="3236476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3236480">s</span>&nbsp;<span class="op" id="3236482">+=</span>&nbsp;<span class="string" id="3236485">&#34;--&nbsp;Extra\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3236500">for</span>&nbsp;<span class="ident" id="3236504">i</span>&nbsp;<span class="op" id="3236506">:=</span>&nbsp;<span class="num" id="3236509">0</span><span class="op" id="3236510">;</span>&nbsp;<span class="ident" id="3236512">i</span>&nbsp;<span class="op" id="3236514">&lt;</span>&nbsp;<span class="builtinfunc" id="3236516">len</span><span class="op" id="3236519">(</span><span class="ident" id="3236520">dns</span><span class="op" id="3236523">.</span><span class="ident" id="3236524">extra</span><span class="op" id="3236529">)</span><span class="op" id="3236530">;</span>&nbsp;<span class="ident" id="3236532">i</span><span class="op" id="3236533">++</span>&nbsp;<span class="op" id="3236536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3236541">s</span>&nbsp;<span class="op" id="3236543">+=</span>&nbsp;<span class="ident" id="3236546">printStruct</span><span class="op" id="3236557">(</span><span class="ident" id="3236558">dns</span><span class="op" id="3236561">.</span><span class="ident" id="3236562">extra</span><span class="op" id="3236567">[</span><span class="ident" id="3236568">i</span><span class="op" id="3236569">]</span><span class="op" id="3236570">)</span>&nbsp;<span class="op" id="3236572">+</span>&nbsp;<span class="string" id="3236574">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3236581">}</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3236584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3236587">return</span>&nbsp;<span class="ident" id="3236594">s</span><br>
<span class="lineno"></span><span class="op" id="3236596">}</span>
</div>
</body>
</html>
