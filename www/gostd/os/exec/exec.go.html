<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os/exec</h2>
<ul>
<li><a href="/gostd/os/exec/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/os/exec/exec.go.html" class="current">exec.go</a></li>
<li><a href="/gostd/os/exec/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/os/exec/lp_test.go.html">lp_test.go</a></li>
<li><a href="/gostd/os/exec/lp_unix.go.html">lp_unix.go</a></li>
<li><a href="/gostd/os/exec/lp_unix_test.go.html">lp_unix_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5646024">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5646079">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5646133">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5646184">//&nbsp;Package&nbsp;exec&nbsp;runs&nbsp;external&nbsp;commands.&nbsp;It&nbsp;wraps&nbsp;os.StartProcess&nbsp;to&nbsp;make&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="5646260">//&nbsp;easier&nbsp;to&nbsp;remap&nbsp;stdin&nbsp;and&nbsp;stdout,&nbsp;connect&nbsp;I/O&nbsp;with&nbsp;pipes,&nbsp;and&nbsp;do&nbsp;other</span><br>
<span class="lineno"></span><span class="comment" id="5646334">//&nbsp;adjustments.</span><br>
<span class="lineno"></span><span class="keyword" id="5646350">package</span>&nbsp;<span class="ident" id="5646358">exec</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="5646364">import</span>&nbsp;<span class="op" id="5646371">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5646374">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5646383">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5646393">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5646399">&#34;os&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5646405">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5646422">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5646433">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5646444">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5646455">&#34;sync&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5646463">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="5646473">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5646476">//&nbsp;Error&nbsp;records&nbsp;the&nbsp;name&nbsp;of&nbsp;a&nbsp;binary&nbsp;that&nbsp;failed&nbsp;to&nbsp;be&nbsp;executed</span><br>
<span class="lineno"></span><span class="comment" id="5646541">//&nbsp;and&nbsp;the&nbsp;reason&nbsp;it&nbsp;failed.</span><br>
<span class="lineno">25</span><span class="keyword" id="5646570">type</span>&nbsp;<span class="ident" id="5646575">Error</span>&nbsp;<span class="keyword" id="5646581">struct</span>&nbsp;<span class="op" id="5646588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5646591">Name</span>&nbsp;<span class="builtintype" id="5646596">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5646604">Err</span>&nbsp;&nbsp;<span class="builtintype" id="5646609">error</span><br>
<span class="lineno"></span><span class="op" id="5646615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="5646618">func</span>&nbsp;<span class="op" id="5646623">(</span><span class="ident" id="5646624">e</span>&nbsp;<span class="op" id="5646626">*</span><span class="ident" id="5646627">Error</span><span class="op" id="5646632">)</span>&nbsp;<span class="ident" id="5646634">Error</span><span class="op" id="5646639">(</span><span class="op" id="5646640">)</span>&nbsp;<span class="builtintype" id="5646642">string</span>&nbsp;<span class="op" id="5646649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5646652">return</span>&nbsp;<span class="string" id="5646659">&#34;exec:&nbsp;&#34;</span>&nbsp;<span class="op" id="5646668">+</span>&nbsp;<span class="ident" id="5646670">strconv</span><span class="op" id="5646677">.</span><span class="ident" id="5646678">Quote</span><span class="op" id="5646683">(</span><span class="ident" id="5646684">e</span><span class="op" id="5646685">.</span><span class="ident" id="5646686">Name</span><span class="op" id="5646690">)</span>&nbsp;<span class="op" id="5646692">+</span>&nbsp;<span class="string" id="5646694">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="5646699">+</span>&nbsp;<span class="ident" id="5646701">e</span><span class="op" id="5646702">.</span><span class="ident" id="5646703">Err</span><span class="op" id="5646706">.</span><span class="ident" id="5646707">Error</span><span class="op" id="5646712">(</span><span class="op" id="5646713">)</span><br>
<span class="lineno"></span><span class="op" id="5646715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5646718">//&nbsp;Cmd&nbsp;represents&nbsp;an&nbsp;external&nbsp;command&nbsp;being&nbsp;prepared&nbsp;or&nbsp;run.</span><br>
<span class="lineno">35</span><span class="keyword" id="5646779">type</span>&nbsp;<span class="ident" id="5646784">Cmd</span>&nbsp;<span class="keyword" id="5646788">struct</span>&nbsp;<span class="op" id="5646795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5646798">//&nbsp;Path&nbsp;is&nbsp;the&nbsp;path&nbsp;of&nbsp;the&nbsp;command&nbsp;to&nbsp;run.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5646842">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5646846">//&nbsp;This&nbsp;is&nbsp;the&nbsp;only&nbsp;field&nbsp;that&nbsp;must&nbsp;be&nbsp;set&nbsp;to&nbsp;a&nbsp;non-zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5646904">//&nbsp;value.&nbsp;If&nbsp;Path&nbsp;is&nbsp;relative,&nbsp;it&nbsp;is&nbsp;evaluated&nbsp;relative</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5646961">//&nbsp;to&nbsp;Dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5646973">Path</span>&nbsp;<span class="builtintype" id="5646978">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5646987">//&nbsp;Args&nbsp;holds&nbsp;command&nbsp;line&nbsp;arguments,&nbsp;including&nbsp;the&nbsp;command&nbsp;as&nbsp;Args[0].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5647060">//&nbsp;If&nbsp;the&nbsp;Args&nbsp;field&nbsp;is&nbsp;empty&nbsp;or&nbsp;nil,&nbsp;Run&nbsp;uses&nbsp;{Path}.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5647116">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5647120">//&nbsp;In&nbsp;typical&nbsp;use,&nbsp;both&nbsp;Path&nbsp;and&nbsp;Args&nbsp;are&nbsp;set&nbsp;by&nbsp;calling&nbsp;Command.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5647187">Args</span>&nbsp;<span class="op" id="5647192">[</span><span class="op" id="5647193">]</span><span class="builtintype" id="5647194">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5647203">//&nbsp;Env&nbsp;specifies&nbsp;the&nbsp;environment&nbsp;of&nbsp;the&nbsp;process.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5647253">//&nbsp;If&nbsp;Env&nbsp;is&nbsp;nil,&nbsp;Run&nbsp;uses&nbsp;the&nbsp;current&nbsp;process&#39;s&nbsp;environment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5647316">Env</span>&nbsp;<span class="op" id="5647320">[</span><span class="op" id="5647321">]</span><span class="builtintype" id="5647322">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5647331">//&nbsp;Dir&nbsp;specifies&nbsp;the&nbsp;working&nbsp;directory&nbsp;of&nbsp;the&nbsp;command.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5647387">//&nbsp;If&nbsp;Dir&nbsp;is&nbsp;the&nbsp;empty&nbsp;string,&nbsp;Run&nbsp;runs&nbsp;the&nbsp;command&nbsp;in&nbsp;the</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5647447">//&nbsp;calling&nbsp;process&#39;s&nbsp;current&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5647488">Dir</span>&nbsp;<span class="builtintype" id="5647492">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5647501">//&nbsp;Stdin&nbsp;specifies&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5647551">//&nbsp;If&nbsp;Stdin&nbsp;is&nbsp;nil,&nbsp;the&nbsp;process&nbsp;reads&nbsp;from&nbsp;the&nbsp;null&nbsp;device&nbsp;(os.DevNull).</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5647625">//&nbsp;If&nbsp;Stdin&nbsp;is&nbsp;an&nbsp;*os.File,&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;input&nbsp;is&nbsp;connected</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5647696">//&nbsp;directly&nbsp;to&nbsp;that&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5647723">//&nbsp;Otherwise,&nbsp;during&nbsp;the&nbsp;execution&nbsp;of&nbsp;the&nbsp;command&nbsp;a&nbsp;separate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5647785">//&nbsp;goroutine&nbsp;reads&nbsp;from&nbsp;Stdin&nbsp;and&nbsp;delivers&nbsp;that&nbsp;data&nbsp;to&nbsp;the&nbsp;command</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5647854">//&nbsp;over&nbsp;a&nbsp;pipe.&nbsp;In&nbsp;this&nbsp;case,&nbsp;Wait&nbsp;does&nbsp;not&nbsp;complete&nbsp;until&nbsp;the&nbsp;goroutine</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5647928">//&nbsp;stops&nbsp;copying,&nbsp;either&nbsp;because&nbsp;it&nbsp;has&nbsp;reached&nbsp;the&nbsp;end&nbsp;of&nbsp;Stdin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5647994">//&nbsp;(EOF&nbsp;or&nbsp;a&nbsp;read&nbsp;error)&nbsp;or&nbsp;because&nbsp;writing&nbsp;to&nbsp;the&nbsp;pipe&nbsp;returned&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5648070">Stdin</span>&nbsp;<span class="ident" id="5648076">io</span><span class="op" id="5648078">.</span><span class="ident" id="5648079">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5648088">//&nbsp;Stdout&nbsp;and&nbsp;Stderr&nbsp;specify&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;output&nbsp;and&nbsp;error.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5648159">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5648163">//&nbsp;If&nbsp;either&nbsp;is&nbsp;nil,&nbsp;Run&nbsp;connects&nbsp;the&nbsp;corresponding&nbsp;file&nbsp;descriptor</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5648232">//&nbsp;to&nbsp;the&nbsp;null&nbsp;device&nbsp;(os.DevNull).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5648269">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5648273">//&nbsp;If&nbsp;Stdout&nbsp;and&nbsp;Stderr&nbsp;are&nbsp;the&nbsp;same&nbsp;writer,&nbsp;at&nbsp;most&nbsp;one</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5648331">//&nbsp;goroutine&nbsp;at&nbsp;a&nbsp;time&nbsp;will&nbsp;call&nbsp;Write.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5648372">Stdout</span>&nbsp;<span class="ident" id="5648379">io</span><span class="op" id="5648381">.</span><span class="ident" id="5648382">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5648390">Stderr</span>&nbsp;<span class="ident" id="5648397">io</span><span class="op" id="5648399">.</span><span class="ident" id="5648400">Writer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5648409">//&nbsp;ExtraFiles&nbsp;specifies&nbsp;additional&nbsp;open&nbsp;files&nbsp;to&nbsp;be&nbsp;inherited&nbsp;by&nbsp;the</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5648479">//&nbsp;new&nbsp;process.&nbsp;It&nbsp;does&nbsp;not&nbsp;include&nbsp;standard&nbsp;input,&nbsp;standard&nbsp;output,&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5648552">//&nbsp;standard&nbsp;error.&nbsp;If&nbsp;non-nil,&nbsp;entry&nbsp;i&nbsp;becomes&nbsp;file&nbsp;descriptor&nbsp;3+i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5648621">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5648625">//&nbsp;BUG:&nbsp;on&nbsp;OS&nbsp;X&nbsp;10.6,&nbsp;child&nbsp;processes&nbsp;may&nbsp;sometimes&nbsp;inherit&nbsp;unwanted&nbsp;fds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5648700">//&nbsp;http://golang.org/issue/2603</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5648733">ExtraFiles</span>&nbsp;<span class="op" id="5648744">[</span><span class="op" id="5648745">]</span><span class="op" id="5648746">*</span><span class="ident" id="5648747">os</span><span class="op" id="5648749">.</span><span class="ident" id="5648750">File</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5648757">//&nbsp;SysProcAttr&nbsp;holds&nbsp;optional,&nbsp;operating&nbsp;system-specific&nbsp;attributes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5648827">//&nbsp;Run&nbsp;passes&nbsp;it&nbsp;to&nbsp;os.StartProcess&nbsp;as&nbsp;the&nbsp;os.ProcAttr&#39;s&nbsp;Sys&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5648896">SysProcAttr</span>&nbsp;<span class="op" id="5648908">*</span><span class="ident" id="5648909">syscall</span><span class="op" id="5648916">.</span><span class="ident" id="5648917">SysProcAttr</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5648931">//&nbsp;Process&nbsp;is&nbsp;the&nbsp;underlying&nbsp;process,&nbsp;once&nbsp;started.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5648984">Process</span>&nbsp;<span class="op" id="5648992">*</span><span class="ident" id="5648993">os</span><span class="op" id="5648995">.</span><span class="ident" id="5648996">Process</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5649006">//&nbsp;ProcessState&nbsp;contains&nbsp;information&nbsp;about&nbsp;an&nbsp;exited&nbsp;process,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5649069">//&nbsp;available&nbsp;after&nbsp;a&nbsp;call&nbsp;to&nbsp;Wait&nbsp;or&nbsp;Run.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5649112">ProcessState</span>&nbsp;<span class="op" id="5649125">*</span><span class="ident" id="5649126">os</span><span class="op" id="5649128">.</span><span class="ident" id="5649129">ProcessState</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5649144">lookPathErr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5649160">error</span>&nbsp;<span class="comment" id="5649166">//&nbsp;LookPath&nbsp;error,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5649194">finished</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5649210">bool</span>&nbsp;&nbsp;<span class="comment" id="5649216">//&nbsp;when&nbsp;Wait&nbsp;was&nbsp;called</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5649241">childFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5649257">[</span><span class="op" id="5649258">]</span><span class="op" id="5649259">*</span><span class="ident" id="5649260">os</span><span class="op" id="5649262">.</span><span class="ident" id="5649263">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5649269">closeAfterStart</span>&nbsp;<span class="op" id="5649285">[</span><span class="op" id="5649286">]</span><span class="ident" id="5649287">io</span><span class="op" id="5649289">.</span><span class="ident" id="5649290">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5649298">closeAfterWait</span>&nbsp;&nbsp;<span class="op" id="5649314">[</span><span class="op" id="5649315">]</span><span class="ident" id="5649316">io</span><span class="op" id="5649318">.</span><span class="ident" id="5649319">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5649327">goroutine</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5649343">[</span><span class="op" id="5649344">]</span><span class="keyword" id="5649345">func</span><span class="op" id="5649349">(</span><span class="op" id="5649350">)</span>&nbsp;<span class="builtintype" id="5649352">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5649359">errch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5649375">chan</span>&nbsp;<span class="builtintype" id="5649380">error</span>&nbsp;<span class="comment" id="5649386">//&nbsp;one&nbsp;send&nbsp;per&nbsp;goroutine</span><br>
<span class="lineno">105</span><span class="op" id="5649412">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5649415">//&nbsp;Command&nbsp;returns&nbsp;the&nbsp;Cmd&nbsp;struct&nbsp;to&nbsp;execute&nbsp;the&nbsp;named&nbsp;program&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="5649483">//&nbsp;the&nbsp;given&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="comment" id="5649507">//</span><br>
<span class="lineno">110</span><span class="comment" id="5649510">//&nbsp;It&nbsp;sets&nbsp;only&nbsp;the&nbsp;Path&nbsp;and&nbsp;Args&nbsp;in&nbsp;the&nbsp;returned&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="5649571">//</span><br>
<span class="lineno"></span><span class="comment" id="5649574">//&nbsp;If&nbsp;name&nbsp;contains&nbsp;no&nbsp;path&nbsp;separators,&nbsp;Command&nbsp;uses&nbsp;LookPath&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5649639">//&nbsp;resolve&nbsp;the&nbsp;path&nbsp;to&nbsp;a&nbsp;complete&nbsp;name&nbsp;if&nbsp;possible.&nbsp;Otherwise&nbsp;it&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="5649709">//&nbsp;name&nbsp;directly.</span><br>
<span class="lineno">115</span><span class="comment" id="5649727">//</span><br>
<span class="lineno"></span><span class="comment" id="5649730">//&nbsp;The&nbsp;returned&nbsp;Cmd&#39;s&nbsp;Args&nbsp;field&nbsp;is&nbsp;constructed&nbsp;from&nbsp;the&nbsp;command&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="5649800">//&nbsp;followed&nbsp;by&nbsp;the&nbsp;elements&nbsp;of&nbsp;arg,&nbsp;so&nbsp;arg&nbsp;should&nbsp;not&nbsp;include&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5649866">//&nbsp;command&nbsp;name&nbsp;itself.&nbsp;For&nbsp;example,&nbsp;Command(&#34;echo&#34;,&nbsp;&#34;hello&#34;)</span><br>
<span class="lineno"></span><span class="keyword" id="5649928">func</span>&nbsp;<span class="ident" id="5649933">Command</span><span class="op" id="5649940">(</span><span class="ident" id="5649941">name</span>&nbsp;<span class="builtintype" id="5649946">string</span><span class="op" id="5649952">,</span>&nbsp;<span class="ident" id="5649954">arg</span>&nbsp;<span class="op" id="5649958">...</span><span class="builtintype" id="5649961">string</span><span class="op" id="5649967">)</span>&nbsp;<span class="op" id="5649969">*</span><span class="ident" id="5649970">Cmd</span>&nbsp;<span class="op" id="5649974">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5649977">cmd</span>&nbsp;<span class="op" id="5649981">:=</span>&nbsp;<span class="op" id="5649984">&amp;</span><span class="ident" id="5649985">Cmd</span><span class="op" id="5649988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5649992">Path</span><span class="op" id="5649996">:</span>&nbsp;<span class="ident" id="5649998">name</span><span class="op" id="5650002">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5650006">Args</span><span class="op" id="5650010">:</span>&nbsp;<span class="builtinfunc" id="5650012">append</span><span class="op" id="5650018">(</span><span class="op" id="5650019">[</span><span class="op" id="5650020">]</span><span class="builtintype" id="5650021">string</span><span class="op" id="5650027">{</span><span class="ident" id="5650028">name</span><span class="op" id="5650032">}</span><span class="op" id="5650033">,</span>&nbsp;<span class="ident" id="5650035">arg</span><span class="op" id="5650038">...</span><span class="op" id="5650041">)</span><span class="op" id="5650042">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5650045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5650048">if</span>&nbsp;<span class="ident" id="5650051">filepath</span><span class="op" id="5650059">.</span><span class="ident" id="5650060">Base</span><span class="op" id="5650064">(</span><span class="ident" id="5650065">name</span><span class="op" id="5650069">)</span>&nbsp;<span class="op" id="5650071">==</span>&nbsp;<span class="ident" id="5650074">name</span>&nbsp;<span class="op" id="5650079">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5650083">if</span>&nbsp;<span class="ident" id="5650086">lp</span><span class="op" id="5650088">,</span>&nbsp;<span class="ident" id="5650090">err</span>&nbsp;<span class="op" id="5650094">:=</span>&nbsp;<span class="ident" id="5650097">LookPath</span><span class="op" id="5650105">(</span><span class="ident" id="5650106">name</span><span class="op" id="5650110">)</span><span class="op" id="5650111">;</span>&nbsp;<span class="ident" id="5650113">err</span>&nbsp;<span class="op" id="5650117">!=</span>&nbsp;<span class="ident" id="5650120">nil</span>&nbsp;<span class="op" id="5650124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5650129">cmd</span><span class="op" id="5650132">.</span><span class="ident" id="5650133">lookPathErr</span>&nbsp;<span class="op" id="5650145">=</span>&nbsp;<span class="ident" id="5650147">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5650153">}</span>&nbsp;<span class="keyword" id="5650155">else</span>&nbsp;<span class="op" id="5650160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5650165">cmd</span><span class="op" id="5650168">.</span><span class="ident" id="5650169">Path</span>&nbsp;<span class="op" id="5650174">=</span>&nbsp;<span class="ident" id="5650176">lp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5650181">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5650184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5650187">return</span>&nbsp;<span class="ident" id="5650194">cmd</span><br>
<span class="lineno"></span><span class="op" id="5650198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5650201">//&nbsp;interfaceEqual&nbsp;protects&nbsp;against&nbsp;panics&nbsp;from&nbsp;doing&nbsp;equality&nbsp;tests&nbsp;on</span><br>
<span class="lineno">135</span><span class="comment" id="5650272">//&nbsp;two&nbsp;interfaces&nbsp;with&nbsp;non-comparable&nbsp;underlying&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="5650328">func</span>&nbsp;<span class="ident" id="5650333">interfaceEqual</span><span class="op" id="5650347">(</span><span class="ident" id="5650348">a</span><span class="op" id="5650349">,</span>&nbsp;<span class="ident" id="5650351">b</span>&nbsp;<span class="keyword" id="5650353">interface</span><span class="op" id="5650362">{</span><span class="op" id="5650363">}</span><span class="op" id="5650364">)</span>&nbsp;<span class="builtintype" id="5650366">bool</span>&nbsp;<span class="op" id="5650371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5650374">defer</span>&nbsp;<span class="keyword" id="5650380">func</span><span class="op" id="5650384">(</span><span class="op" id="5650385">)</span>&nbsp;<span class="op" id="5650387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5650391">recover</span><span class="op" id="5650398">(</span><span class="op" id="5650399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5650402">}</span><span class="op" id="5650403">(</span><span class="op" id="5650404">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5650407">return</span>&nbsp;<span class="ident" id="5650414">a</span>&nbsp;<span class="op" id="5650416">==</span>&nbsp;<span class="ident" id="5650419">b</span><br>
<span class="lineno"></span><span class="op" id="5650421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5650424">func</span>&nbsp;<span class="op" id="5650429">(</span><span class="ident" id="5650430">c</span>&nbsp;<span class="op" id="5650432">*</span><span class="ident" id="5650433">Cmd</span><span class="op" id="5650436">)</span>&nbsp;<span class="ident" id="5650438">envv</span><span class="op" id="5650442">(</span><span class="op" id="5650443">)</span>&nbsp;<span class="op" id="5650445">[</span><span class="op" id="5650446">]</span><span class="builtintype" id="5650447">string</span>&nbsp;<span class="op" id="5650454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5650457">if</span>&nbsp;<span class="ident" id="5650460">c</span><span class="op" id="5650461">.</span><span class="ident" id="5650462">Env</span>&nbsp;<span class="op" id="5650466">!=</span>&nbsp;<span class="ident" id="5650469">nil</span>&nbsp;<span class="op" id="5650473">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5650477">return</span>&nbsp;<span class="ident" id="5650484">c</span><span class="op" id="5650485">.</span><span class="ident" id="5650486">Env</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5650491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5650494">return</span>&nbsp;<span class="ident" id="5650501">os</span><span class="op" id="5650503">.</span><span class="ident" id="5650504">Environ</span><span class="op" id="5650511">(</span><span class="op" id="5650512">)</span><br>
<span class="lineno"></span><span class="op" id="5650514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="5650517">func</span>&nbsp;<span class="op" id="5650522">(</span><span class="ident" id="5650523">c</span>&nbsp;<span class="op" id="5650525">*</span><span class="ident" id="5650526">Cmd</span><span class="op" id="5650529">)</span>&nbsp;<span class="ident" id="5650531">argv</span><span class="op" id="5650535">(</span><span class="op" id="5650536">)</span>&nbsp;<span class="op" id="5650538">[</span><span class="op" id="5650539">]</span><span class="builtintype" id="5650540">string</span>&nbsp;<span class="op" id="5650547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5650550">if</span>&nbsp;<span class="builtinfunc" id="5650553">len</span><span class="op" id="5650556">(</span><span class="ident" id="5650557">c</span><span class="op" id="5650558">.</span><span class="ident" id="5650559">Args</span><span class="op" id="5650563">)</span>&nbsp;<span class="op" id="5650565">&gt;</span>&nbsp;<span class="num" id="5650567">0</span>&nbsp;<span class="op" id="5650569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5650573">return</span>&nbsp;<span class="ident" id="5650580">c</span><span class="op" id="5650581">.</span><span class="ident" id="5650582">Args</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5650588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5650591">return</span>&nbsp;<span class="op" id="5650598">[</span><span class="op" id="5650599">]</span><span class="builtintype" id="5650600">string</span><span class="op" id="5650606">{</span><span class="ident" id="5650607">c</span><span class="op" id="5650608">.</span><span class="ident" id="5650609">Path</span><span class="op" id="5650613">}</span><br>
<span class="lineno">155</span><span class="op" id="5650615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5650618">func</span>&nbsp;<span class="op" id="5650623">(</span><span class="ident" id="5650624">c</span>&nbsp;<span class="op" id="5650626">*</span><span class="ident" id="5650627">Cmd</span><span class="op" id="5650630">)</span>&nbsp;<span class="ident" id="5650632">stdin</span><span class="op" id="5650637">(</span><span class="op" id="5650638">)</span>&nbsp;<span class="op" id="5650640">(</span><span class="ident" id="5650641">f</span>&nbsp;<span class="op" id="5650643">*</span><span class="ident" id="5650644">os</span><span class="op" id="5650646">.</span><span class="ident" id="5650647">File</span><span class="op" id="5650651">,</span>&nbsp;<span class="ident" id="5650653">err</span>&nbsp;<span class="builtintype" id="5650657">error</span><span class="op" id="5650662">)</span>&nbsp;<span class="op" id="5650664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5650667">if</span>&nbsp;<span class="ident" id="5650670">c</span><span class="op" id="5650671">.</span><span class="ident" id="5650672">Stdin</span>&nbsp;<span class="op" id="5650678">==</span>&nbsp;<span class="ident" id="5650681">nil</span>&nbsp;<span class="op" id="5650685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5650689">f</span><span class="op" id="5650690">,</span>&nbsp;<span class="ident" id="5650692">err</span>&nbsp;<span class="op" id="5650696">=</span>&nbsp;<span class="ident" id="5650698">os</span><span class="op" id="5650700">.</span><span class="ident" id="5650701">Open</span><span class="op" id="5650705">(</span><span class="ident" id="5650706">os</span><span class="op" id="5650708">.</span><span class="ident" id="5650709">DevNull</span><span class="op" id="5650716">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5650720">if</span>&nbsp;<span class="ident" id="5650723">err</span>&nbsp;<span class="op" id="5650727">!=</span>&nbsp;<span class="ident" id="5650730">nil</span>&nbsp;<span class="op" id="5650734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5650739">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5650748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5650752">c</span><span class="op" id="5650753">.</span><span class="ident" id="5650754">closeAfterStart</span>&nbsp;<span class="op" id="5650770">=</span>&nbsp;<span class="builtinfunc" id="5650772">append</span><span class="op" id="5650778">(</span><span class="ident" id="5650779">c</span><span class="op" id="5650780">.</span><span class="ident" id="5650781">closeAfterStart</span><span class="op" id="5650796">,</span>&nbsp;<span class="ident" id="5650798">f</span><span class="op" id="5650799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5650803">return</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5650811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5650815">if</span>&nbsp;<span class="ident" id="5650818">f</span><span class="op" id="5650819">,</span>&nbsp;<span class="ident" id="5650821">ok</span>&nbsp;<span class="op" id="5650824">:=</span>&nbsp;<span class="ident" id="5650827">c</span><span class="op" id="5650828">.</span><span class="ident" id="5650829">Stdin</span><span class="op" id="5650834">.</span><span class="op" id="5650835">(</span><span class="op" id="5650836">*</span><span class="ident" id="5650837">os</span><span class="op" id="5650839">.</span><span class="ident" id="5650840">File</span><span class="op" id="5650844">)</span><span class="op" id="5650845">;</span>&nbsp;<span class="ident" id="5650847">ok</span>&nbsp;<span class="op" id="5650850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5650854">return</span>&nbsp;<span class="ident" id="5650861">f</span><span class="op" id="5650862">,</span>&nbsp;<span class="ident" id="5650864">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5650869">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5650873">pr</span><span class="op" id="5650875">,</span>&nbsp;<span class="ident" id="5650877">pw</span><span class="op" id="5650879">,</span>&nbsp;<span class="ident" id="5650881">err</span>&nbsp;<span class="op" id="5650885">:=</span>&nbsp;<span class="ident" id="5650888">os</span><span class="op" id="5650890">.</span><span class="ident" id="5650891">Pipe</span><span class="op" id="5650895">(</span><span class="op" id="5650896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5650899">if</span>&nbsp;<span class="ident" id="5650902">err</span>&nbsp;<span class="op" id="5650906">!=</span>&nbsp;<span class="ident" id="5650909">nil</span>&nbsp;<span class="op" id="5650913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5650917">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5650925">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5650929">c</span><span class="op" id="5650930">.</span><span class="ident" id="5650931">closeAfterStart</span>&nbsp;<span class="op" id="5650947">=</span>&nbsp;<span class="builtinfunc" id="5650949">append</span><span class="op" id="5650955">(</span><span class="ident" id="5650956">c</span><span class="op" id="5650957">.</span><span class="ident" id="5650958">closeAfterStart</span><span class="op" id="5650973">,</span>&nbsp;<span class="ident" id="5650975">pr</span><span class="op" id="5650977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5650980">c</span><span class="op" id="5650981">.</span><span class="ident" id="5650982">closeAfterWait</span>&nbsp;<span class="op" id="5650997">=</span>&nbsp;<span class="builtinfunc" id="5650999">append</span><span class="op" id="5651005">(</span><span class="ident" id="5651006">c</span><span class="op" id="5651007">.</span><span class="ident" id="5651008">closeAfterWait</span><span class="op" id="5651022">,</span>&nbsp;<span class="ident" id="5651024">pw</span><span class="op" id="5651026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5651029">c</span><span class="op" id="5651030">.</span><span class="ident" id="5651031">goroutine</span>&nbsp;<span class="op" id="5651041">=</span>&nbsp;<span class="builtinfunc" id="5651043">append</span><span class="op" id="5651049">(</span><span class="ident" id="5651050">c</span><span class="op" id="5651051">.</span><span class="ident" id="5651052">goroutine</span><span class="op" id="5651061">,</span>&nbsp;<span class="keyword" id="5651063">func</span><span class="op" id="5651067">(</span><span class="op" id="5651068">)</span>&nbsp;<span class="builtintype" id="5651070">error</span>&nbsp;<span class="op" id="5651076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5651080">_</span><span class="op" id="5651081">,</span>&nbsp;<span class="ident" id="5651083">err</span>&nbsp;<span class="op" id="5651087">:=</span>&nbsp;<span class="ident" id="5651090">io</span><span class="op" id="5651092">.</span><span class="ident" id="5651093">Copy</span><span class="op" id="5651097">(</span><span class="ident" id="5651098">pw</span><span class="op" id="5651100">,</span>&nbsp;<span class="ident" id="5651102">c</span><span class="op" id="5651103">.</span><span class="ident" id="5651104">Stdin</span><span class="op" id="5651109">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5651113">if</span>&nbsp;<span class="ident" id="5651116">err1</span>&nbsp;<span class="op" id="5651121">:=</span>&nbsp;<span class="ident" id="5651124">pw</span><span class="op" id="5651126">.</span><span class="ident" id="5651127">Close</span><span class="op" id="5651132">(</span><span class="op" id="5651133">)</span><span class="op" id="5651134">;</span>&nbsp;<span class="ident" id="5651136">err</span>&nbsp;<span class="op" id="5651140">==</span>&nbsp;<span class="ident" id="5651143">nil</span>&nbsp;<span class="op" id="5651147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5651152">err</span>&nbsp;<span class="op" id="5651156">=</span>&nbsp;<span class="ident" id="5651158">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5651165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5651169">return</span>&nbsp;<span class="ident" id="5651176">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5651181">}</span><span class="op" id="5651182">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5651185">return</span>&nbsp;<span class="ident" id="5651192">pr</span><span class="op" id="5651194">,</span>&nbsp;<span class="ident" id="5651196">nil</span><br>
<span class="lineno"></span><span class="op" id="5651200">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5651203">func</span>&nbsp;<span class="op" id="5651208">(</span><span class="ident" id="5651209">c</span>&nbsp;<span class="op" id="5651211">*</span><span class="ident" id="5651212">Cmd</span><span class="op" id="5651215">)</span>&nbsp;<span class="ident" id="5651217">stdout</span><span class="op" id="5651223">(</span><span class="op" id="5651224">)</span>&nbsp;<span class="op" id="5651226">(</span><span class="ident" id="5651227">f</span>&nbsp;<span class="op" id="5651229">*</span><span class="ident" id="5651230">os</span><span class="op" id="5651232">.</span><span class="ident" id="5651233">File</span><span class="op" id="5651237">,</span>&nbsp;<span class="ident" id="5651239">err</span>&nbsp;<span class="builtintype" id="5651243">error</span><span class="op" id="5651248">)</span>&nbsp;<span class="op" id="5651250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5651253">return</span>&nbsp;<span class="ident" id="5651260">c</span><span class="op" id="5651261">.</span><span class="ident" id="5651262">writerDescriptor</span><span class="op" id="5651278">(</span><span class="ident" id="5651279">c</span><span class="op" id="5651280">.</span><span class="ident" id="5651281">Stdout</span><span class="op" id="5651287">)</span><br>
<span class="lineno">190</span><span class="op" id="5651289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5651292">func</span>&nbsp;<span class="op" id="5651297">(</span><span class="ident" id="5651298">c</span>&nbsp;<span class="op" id="5651300">*</span><span class="ident" id="5651301">Cmd</span><span class="op" id="5651304">)</span>&nbsp;<span class="ident" id="5651306">stderr</span><span class="op" id="5651312">(</span><span class="op" id="5651313">)</span>&nbsp;<span class="op" id="5651315">(</span><span class="ident" id="5651316">f</span>&nbsp;<span class="op" id="5651318">*</span><span class="ident" id="5651319">os</span><span class="op" id="5651321">.</span><span class="ident" id="5651322">File</span><span class="op" id="5651326">,</span>&nbsp;<span class="ident" id="5651328">err</span>&nbsp;<span class="builtintype" id="5651332">error</span><span class="op" id="5651337">)</span>&nbsp;<span class="op" id="5651339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5651342">if</span>&nbsp;<span class="ident" id="5651345">c</span><span class="op" id="5651346">.</span><span class="ident" id="5651347">Stderr</span>&nbsp;<span class="op" id="5651354">!=</span>&nbsp;<span class="ident" id="5651357">nil</span>&nbsp;<span class="op" id="5651361">&amp;&amp;</span>&nbsp;<span class="ident" id="5651364">interfaceEqual</span><span class="op" id="5651378">(</span><span class="ident" id="5651379">c</span><span class="op" id="5651380">.</span><span class="ident" id="5651381">Stderr</span><span class="op" id="5651387">,</span>&nbsp;<span class="ident" id="5651389">c</span><span class="op" id="5651390">.</span><span class="ident" id="5651391">Stdout</span><span class="op" id="5651397">)</span>&nbsp;<span class="op" id="5651399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5651403">return</span>&nbsp;<span class="ident" id="5651410">c</span><span class="op" id="5651411">.</span><span class="ident" id="5651412">childFiles</span><span class="op" id="5651422">[</span><span class="num" id="5651423">1</span><span class="op" id="5651424">]</span><span class="op" id="5651425">,</span>&nbsp;<span class="ident" id="5651427">nil</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5651432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5651435">return</span>&nbsp;<span class="ident" id="5651442">c</span><span class="op" id="5651443">.</span><span class="ident" id="5651444">writerDescriptor</span><span class="op" id="5651460">(</span><span class="ident" id="5651461">c</span><span class="op" id="5651462">.</span><span class="ident" id="5651463">Stderr</span><span class="op" id="5651469">)</span><br>
<span class="lineno"></span><span class="op" id="5651471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5651474">func</span>&nbsp;<span class="op" id="5651479">(</span><span class="ident" id="5651480">c</span>&nbsp;<span class="op" id="5651482">*</span><span class="ident" id="5651483">Cmd</span><span class="op" id="5651486">)</span>&nbsp;<span class="ident" id="5651488">writerDescriptor</span><span class="op" id="5651504">(</span><span class="ident" id="5651505">w</span>&nbsp;<span class="ident" id="5651507">io</span><span class="op" id="5651509">.</span><span class="ident" id="5651510">Writer</span><span class="op" id="5651516">)</span>&nbsp;<span class="op" id="5651518">(</span><span class="ident" id="5651519">f</span>&nbsp;<span class="op" id="5651521">*</span><span class="ident" id="5651522">os</span><span class="op" id="5651524">.</span><span class="ident" id="5651525">File</span><span class="op" id="5651529">,</span>&nbsp;<span class="ident" id="5651531">err</span>&nbsp;<span class="builtintype" id="5651535">error</span><span class="op" id="5651540">)</span>&nbsp;<span class="op" id="5651542">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5651545">if</span>&nbsp;<span class="ident" id="5651548">w</span>&nbsp;<span class="op" id="5651550">==</span>&nbsp;<span class="ident" id="5651553">nil</span>&nbsp;<span class="op" id="5651557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5651561">f</span><span class="op" id="5651562">,</span>&nbsp;<span class="ident" id="5651564">err</span>&nbsp;<span class="op" id="5651568">=</span>&nbsp;<span class="ident" id="5651570">os</span><span class="op" id="5651572">.</span><span class="ident" id="5651573">OpenFile</span><span class="op" id="5651581">(</span><span class="ident" id="5651582">os</span><span class="op" id="5651584">.</span><span class="ident" id="5651585">DevNull</span><span class="op" id="5651592">,</span>&nbsp;<span class="ident" id="5651594">os</span><span class="op" id="5651596">.</span><span class="ident" id="5651597">O_WRONLY</span><span class="op" id="5651605">,</span>&nbsp;<span class="num" id="5651607">0</span><span class="op" id="5651608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5651612">if</span>&nbsp;<span class="ident" id="5651615">err</span>&nbsp;<span class="op" id="5651619">!=</span>&nbsp;<span class="ident" id="5651622">nil</span>&nbsp;<span class="op" id="5651626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5651631">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5651640">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5651644">c</span><span class="op" id="5651645">.</span><span class="ident" id="5651646">closeAfterStart</span>&nbsp;<span class="op" id="5651662">=</span>&nbsp;<span class="builtinfunc" id="5651664">append</span><span class="op" id="5651670">(</span><span class="ident" id="5651671">c</span><span class="op" id="5651672">.</span><span class="ident" id="5651673">closeAfterStart</span><span class="op" id="5651688">,</span>&nbsp;<span class="ident" id="5651690">f</span><span class="op" id="5651691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5651695">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5651703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5651707">if</span>&nbsp;<span class="ident" id="5651710">f</span><span class="op" id="5651711">,</span>&nbsp;<span class="ident" id="5651713">ok</span>&nbsp;<span class="op" id="5651716">:=</span>&nbsp;<span class="ident" id="5651719">w</span><span class="op" id="5651720">.</span><span class="op" id="5651721">(</span><span class="op" id="5651722">*</span><span class="ident" id="5651723">os</span><span class="op" id="5651725">.</span><span class="ident" id="5651726">File</span><span class="op" id="5651730">)</span><span class="op" id="5651731">;</span>&nbsp;<span class="ident" id="5651733">ok</span>&nbsp;<span class="op" id="5651736">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5651740">return</span>&nbsp;<span class="ident" id="5651747">f</span><span class="op" id="5651748">,</span>&nbsp;<span class="ident" id="5651750">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5651755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5651759">pr</span><span class="op" id="5651761">,</span>&nbsp;<span class="ident" id="5651763">pw</span><span class="op" id="5651765">,</span>&nbsp;<span class="ident" id="5651767">err</span>&nbsp;<span class="op" id="5651771">:=</span>&nbsp;<span class="ident" id="5651774">os</span><span class="op" id="5651776">.</span><span class="ident" id="5651777">Pipe</span><span class="op" id="5651781">(</span><span class="op" id="5651782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5651785">if</span>&nbsp;<span class="ident" id="5651788">err</span>&nbsp;<span class="op" id="5651792">!=</span>&nbsp;<span class="ident" id="5651795">nil</span>&nbsp;<span class="op" id="5651799">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5651803">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5651811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5651815">c</span><span class="op" id="5651816">.</span><span class="ident" id="5651817">closeAfterStart</span>&nbsp;<span class="op" id="5651833">=</span>&nbsp;<span class="builtinfunc" id="5651835">append</span><span class="op" id="5651841">(</span><span class="ident" id="5651842">c</span><span class="op" id="5651843">.</span><span class="ident" id="5651844">closeAfterStart</span><span class="op" id="5651859">,</span>&nbsp;<span class="ident" id="5651861">pw</span><span class="op" id="5651863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5651866">c</span><span class="op" id="5651867">.</span><span class="ident" id="5651868">closeAfterWait</span>&nbsp;<span class="op" id="5651883">=</span>&nbsp;<span class="builtinfunc" id="5651885">append</span><span class="op" id="5651891">(</span><span class="ident" id="5651892">c</span><span class="op" id="5651893">.</span><span class="ident" id="5651894">closeAfterWait</span><span class="op" id="5651908">,</span>&nbsp;<span class="ident" id="5651910">pr</span><span class="op" id="5651912">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5651915">c</span><span class="op" id="5651916">.</span><span class="ident" id="5651917">goroutine</span>&nbsp;<span class="op" id="5651927">=</span>&nbsp;<span class="builtinfunc" id="5651929">append</span><span class="op" id="5651935">(</span><span class="ident" id="5651936">c</span><span class="op" id="5651937">.</span><span class="ident" id="5651938">goroutine</span><span class="op" id="5651947">,</span>&nbsp;<span class="keyword" id="5651949">func</span><span class="op" id="5651953">(</span><span class="op" id="5651954">)</span>&nbsp;<span class="builtintype" id="5651956">error</span>&nbsp;<span class="op" id="5651962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5651966">_</span><span class="op" id="5651967">,</span>&nbsp;<span class="ident" id="5651969">err</span>&nbsp;<span class="op" id="5651973">:=</span>&nbsp;<span class="ident" id="5651976">io</span><span class="op" id="5651978">.</span><span class="ident" id="5651979">Copy</span><span class="op" id="5651983">(</span><span class="ident" id="5651984">w</span><span class="op" id="5651985">,</span>&nbsp;<span class="ident" id="5651987">pr</span><span class="op" id="5651989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5651993">return</span>&nbsp;<span class="ident" id="5652000">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5652005">}</span><span class="op" id="5652006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5652009">return</span>&nbsp;<span class="ident" id="5652016">pw</span><span class="op" id="5652018">,</span>&nbsp;<span class="ident" id="5652020">nil</span><br>
<span class="lineno">225</span><span class="op" id="5652024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5652027">func</span>&nbsp;<span class="op" id="5652032">(</span><span class="ident" id="5652033">c</span>&nbsp;<span class="op" id="5652035">*</span><span class="ident" id="5652036">Cmd</span><span class="op" id="5652039">)</span>&nbsp;<span class="ident" id="5652041">closeDescriptors</span><span class="op" id="5652057">(</span><span class="ident" id="5652058">closers</span>&nbsp;<span class="op" id="5652066">[</span><span class="op" id="5652067">]</span><span class="ident" id="5652068">io</span><span class="op" id="5652070">.</span><span class="ident" id="5652071">Closer</span><span class="op" id="5652077">)</span>&nbsp;<span class="op" id="5652079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5652082">for</span>&nbsp;<span class="ident" id="5652086">_</span><span class="op" id="5652087">,</span>&nbsp;<span class="ident" id="5652089">fd</span>&nbsp;<span class="op" id="5652092">:=</span>&nbsp;<span class="keyword" id="5652095">range</span>&nbsp;<span class="ident" id="5652101">closers</span>&nbsp;<span class="op" id="5652109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5652113">fd</span><span class="op" id="5652115">.</span><span class="ident" id="5652116">Close</span><span class="op" id="5652121">(</span><span class="op" id="5652122">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5652125">}</span><br>
<span class="lineno"></span><span class="op" id="5652127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5652130">//&nbsp;Run&nbsp;starts&nbsp;the&nbsp;specified&nbsp;command&nbsp;and&nbsp;waits&nbsp;for&nbsp;it&nbsp;to&nbsp;complete.</span><br>
<span class="lineno"></span><span class="comment" id="5652196">//</span><br>
<span class="lineno">235</span><span class="comment" id="5652199">//&nbsp;The&nbsp;returned&nbsp;error&nbsp;is&nbsp;nil&nbsp;if&nbsp;the&nbsp;command&nbsp;runs,&nbsp;has&nbsp;no&nbsp;problems</span><br>
<span class="lineno"></span><span class="comment" id="5652265">//&nbsp;copying&nbsp;stdin,&nbsp;stdout,&nbsp;and&nbsp;stderr,&nbsp;and&nbsp;exits&nbsp;with&nbsp;a&nbsp;zero&nbsp;exit</span><br>
<span class="lineno"></span><span class="comment" id="5652330">//&nbsp;status.</span><br>
<span class="lineno"></span><span class="comment" id="5652341">//</span><br>
<span class="lineno"></span><span class="comment" id="5652344">//&nbsp;If&nbsp;the&nbsp;command&nbsp;fails&nbsp;to&nbsp;run&nbsp;or&nbsp;doesn&#39;t&nbsp;complete&nbsp;successfully,&nbsp;the</span><br>
<span class="lineno">240</span><span class="comment" id="5652413">//&nbsp;error&nbsp;is&nbsp;of&nbsp;type&nbsp;*ExitError.&nbsp;Other&nbsp;error&nbsp;types&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5652470">//&nbsp;returned&nbsp;for&nbsp;I/O&nbsp;problems.</span><br>
<span class="lineno"></span><span class="keyword" id="5652500">func</span>&nbsp;<span class="op" id="5652505">(</span><span class="ident" id="5652506">c</span>&nbsp;<span class="op" id="5652508">*</span><span class="ident" id="5652509">Cmd</span><span class="op" id="5652512">)</span>&nbsp;<span class="ident" id="5652514">Run</span><span class="op" id="5652517">(</span><span class="op" id="5652518">)</span>&nbsp;<span class="builtintype" id="5652520">error</span>&nbsp;<span class="op" id="5652526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5652529">if</span>&nbsp;<span class="ident" id="5652532">err</span>&nbsp;<span class="op" id="5652536">:=</span>&nbsp;<span class="ident" id="5652539">c</span><span class="op" id="5652540">.</span><span class="ident" id="5652541">Start</span><span class="op" id="5652546">(</span><span class="op" id="5652547">)</span><span class="op" id="5652548">;</span>&nbsp;<span class="ident" id="5652550">err</span>&nbsp;<span class="op" id="5652554">!=</span>&nbsp;<span class="ident" id="5652557">nil</span>&nbsp;<span class="op" id="5652561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5652565">return</span>&nbsp;<span class="ident" id="5652572">err</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5652577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5652580">return</span>&nbsp;<span class="ident" id="5652587">c</span><span class="op" id="5652588">.</span><span class="ident" id="5652589">Wait</span><span class="op" id="5652593">(</span><span class="op" id="5652594">)</span><br>
<span class="lineno"></span><span class="op" id="5652596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5652599">//&nbsp;lookExtensions&nbsp;finds&nbsp;windows&nbsp;executable&nbsp;by&nbsp;its&nbsp;dir&nbsp;and&nbsp;path.</span><br>
<span class="lineno">250</span><span class="comment" id="5652663">//&nbsp;It&nbsp;uses&nbsp;LookPath&nbsp;to&nbsp;try&nbsp;appropriate&nbsp;extensions.</span><br>
<span class="lineno"></span><span class="comment" id="5652714">//&nbsp;lookExtensions&nbsp;does&nbsp;not&nbsp;search&nbsp;PATH,&nbsp;instead&nbsp;it&nbsp;converts&nbsp;`prog`&nbsp;into&nbsp;`.\prog`.</span><br>
<span class="lineno"></span><span class="keyword" id="5652796">func</span>&nbsp;<span class="ident" id="5652801">lookExtensions</span><span class="op" id="5652815">(</span><span class="ident" id="5652816">path</span><span class="op" id="5652820">,</span>&nbsp;<span class="ident" id="5652822">dir</span>&nbsp;<span class="builtintype" id="5652826">string</span><span class="op" id="5652832">)</span>&nbsp;<span class="op" id="5652834">(</span><span class="builtintype" id="5652835">string</span><span class="op" id="5652841">,</span>&nbsp;<span class="builtintype" id="5652843">error</span><span class="op" id="5652848">)</span>&nbsp;<span class="op" id="5652850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5652853">if</span>&nbsp;<span class="ident" id="5652856">filepath</span><span class="op" id="5652864">.</span><span class="ident" id="5652865">Base</span><span class="op" id="5652869">(</span><span class="ident" id="5652870">path</span><span class="op" id="5652874">)</span>&nbsp;<span class="op" id="5652876">==</span>&nbsp;<span class="ident" id="5652879">path</span>&nbsp;<span class="op" id="5652884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5652888">path</span>&nbsp;<span class="op" id="5652893">=</span>&nbsp;<span class="ident" id="5652895">filepath</span><span class="op" id="5652903">.</span><span class="ident" id="5652904">Join</span><span class="op" id="5652908">(</span><span class="string" id="5652909">&#34;.&#34;</span><span class="op" id="5652912">,</span>&nbsp;<span class="ident" id="5652914">path</span><span class="op" id="5652918">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5652921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5652924">if</span>&nbsp;<span class="ident" id="5652927">dir</span>&nbsp;<span class="op" id="5652931">==</span>&nbsp;<span class="string" id="5652934">&#34;&#34;</span>&nbsp;<span class="op" id="5652937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5652941">return</span>&nbsp;<span class="ident" id="5652948">LookPath</span><span class="op" id="5652956">(</span><span class="ident" id="5652957">path</span><span class="op" id="5652961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5652964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5652967">if</span>&nbsp;<span class="ident" id="5652970">filepath</span><span class="op" id="5652978">.</span><span class="ident" id="5652979">VolumeName</span><span class="op" id="5652989">(</span><span class="ident" id="5652990">path</span><span class="op" id="5652994">)</span>&nbsp;<span class="op" id="5652996">!=</span>&nbsp;<span class="string" id="5652999">&#34;&#34;</span>&nbsp;<span class="op" id="5653002">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5653006">return</span>&nbsp;<span class="ident" id="5653013">LookPath</span><span class="op" id="5653021">(</span><span class="ident" id="5653022">path</span><span class="op" id="5653026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5653029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5653032">if</span>&nbsp;<span class="builtinfunc" id="5653035">len</span><span class="op" id="5653038">(</span><span class="ident" id="5653039">path</span><span class="op" id="5653043">)</span>&nbsp;<span class="op" id="5653045">&gt;</span>&nbsp;<span class="num" id="5653047">1</span>&nbsp;<span class="op" id="5653049">&amp;&amp;</span>&nbsp;<span class="ident" id="5653052">os</span><span class="op" id="5653054">.</span><span class="ident" id="5653055">IsPathSeparator</span><span class="op" id="5653070">(</span><span class="ident" id="5653071">path</span><span class="op" id="5653075">[</span><span class="num" id="5653076">0</span><span class="op" id="5653077">]</span><span class="op" id="5653078">)</span>&nbsp;<span class="op" id="5653080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5653084">return</span>&nbsp;<span class="ident" id="5653091">LookPath</span><span class="op" id="5653099">(</span><span class="ident" id="5653100">path</span><span class="op" id="5653104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5653107">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5653110">dirandpath</span>&nbsp;<span class="op" id="5653121">:=</span>&nbsp;<span class="ident" id="5653124">filepath</span><span class="op" id="5653132">.</span><span class="ident" id="5653133">Join</span><span class="op" id="5653137">(</span><span class="ident" id="5653138">dir</span><span class="op" id="5653141">,</span>&nbsp;<span class="ident" id="5653143">path</span><span class="op" id="5653147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5653150">//&nbsp;We&nbsp;assume&nbsp;that&nbsp;LookPath&nbsp;will&nbsp;only&nbsp;add&nbsp;file&nbsp;extension.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5653208">lp</span><span class="op" id="5653210">,</span>&nbsp;<span class="ident" id="5653212">err</span>&nbsp;<span class="op" id="5653216">:=</span>&nbsp;<span class="ident" id="5653219">LookPath</span><span class="op" id="5653227">(</span><span class="ident" id="5653228">dirandpath</span><span class="op" id="5653238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5653241">if</span>&nbsp;<span class="ident" id="5653244">err</span>&nbsp;<span class="op" id="5653248">!=</span>&nbsp;<span class="ident" id="5653251">nil</span>&nbsp;<span class="op" id="5653255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5653259">return</span>&nbsp;<span class="string" id="5653266">&#34;&#34;</span><span class="op" id="5653268">,</span>&nbsp;<span class="ident" id="5653270">err</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5653275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5653278">ext</span>&nbsp;<span class="op" id="5653282">:=</span>&nbsp;<span class="ident" id="5653285">strings</span><span class="op" id="5653292">.</span><span class="ident" id="5653293">TrimPrefix</span><span class="op" id="5653303">(</span><span class="ident" id="5653304">lp</span><span class="op" id="5653306">,</span>&nbsp;<span class="ident" id="5653308">dirandpath</span><span class="op" id="5653318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5653321">return</span>&nbsp;<span class="ident" id="5653328">path</span>&nbsp;<span class="op" id="5653333">+</span>&nbsp;<span class="ident" id="5653335">ext</span><span class="op" id="5653338">,</span>&nbsp;<span class="ident" id="5653340">nil</span><br>
<span class="lineno"></span><span class="op" id="5653344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="comment" id="5653347">//&nbsp;Start&nbsp;starts&nbsp;the&nbsp;specified&nbsp;command&nbsp;but&nbsp;does&nbsp;not&nbsp;wait&nbsp;for&nbsp;it&nbsp;to&nbsp;complete.</span><br>
<span class="lineno"></span><span class="comment" id="5653423">//</span><br>
<span class="lineno"></span><span class="comment" id="5653426">//&nbsp;The&nbsp;Wait&nbsp;method&nbsp;will&nbsp;return&nbsp;the&nbsp;exit&nbsp;code&nbsp;and&nbsp;release&nbsp;associated&nbsp;resources</span><br>
<span class="lineno"></span><span class="comment" id="5653504">//&nbsp;once&nbsp;the&nbsp;command&nbsp;exits.</span><br>
<span class="lineno"></span><span class="keyword" id="5653531">func</span>&nbsp;<span class="op" id="5653536">(</span><span class="ident" id="5653537">c</span>&nbsp;<span class="op" id="5653539">*</span><span class="ident" id="5653540">Cmd</span><span class="op" id="5653543">)</span>&nbsp;<span class="ident" id="5653545">Start</span><span class="op" id="5653550">(</span><span class="op" id="5653551">)</span>&nbsp;<span class="builtintype" id="5653553">error</span>&nbsp;<span class="op" id="5653559">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5653562">if</span>&nbsp;<span class="ident" id="5653565">c</span><span class="op" id="5653566">.</span><span class="ident" id="5653567">lookPathErr</span>&nbsp;<span class="op" id="5653579">!=</span>&nbsp;<span class="ident" id="5653582">nil</span>&nbsp;<span class="op" id="5653586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5653590">c</span><span class="op" id="5653591">.</span><span class="ident" id="5653592">closeDescriptors</span><span class="op" id="5653608">(</span><span class="ident" id="5653609">c</span><span class="op" id="5653610">.</span><span class="ident" id="5653611">closeAfterStart</span><span class="op" id="5653626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5653630">c</span><span class="op" id="5653631">.</span><span class="ident" id="5653632">closeDescriptors</span><span class="op" id="5653648">(</span><span class="ident" id="5653649">c</span><span class="op" id="5653650">.</span><span class="ident" id="5653651">closeAfterWait</span><span class="op" id="5653665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5653669">return</span>&nbsp;<span class="ident" id="5653676">c</span><span class="op" id="5653677">.</span><span class="ident" id="5653678">lookPathErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5653691">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5653694">if</span>&nbsp;<span class="ident" id="5653697">runtime</span><span class="op" id="5653704">.</span><span class="ident" id="5653705">GOOS</span>&nbsp;<span class="op" id="5653710">==</span>&nbsp;<span class="string" id="5653713">&#34;windows&#34;</span>&nbsp;<span class="op" id="5653723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5653727">lp</span><span class="op" id="5653729">,</span>&nbsp;<span class="ident" id="5653731">err</span>&nbsp;<span class="op" id="5653735">:=</span>&nbsp;<span class="ident" id="5653738">lookExtensions</span><span class="op" id="5653752">(</span><span class="ident" id="5653753">c</span><span class="op" id="5653754">.</span><span class="ident" id="5653755">Path</span><span class="op" id="5653759">,</span>&nbsp;<span class="ident" id="5653761">c</span><span class="op" id="5653762">.</span><span class="ident" id="5653763">Dir</span><span class="op" id="5653766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5653770">if</span>&nbsp;<span class="ident" id="5653773">err</span>&nbsp;<span class="op" id="5653777">!=</span>&nbsp;<span class="ident" id="5653780">nil</span>&nbsp;<span class="op" id="5653784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5653789">c</span><span class="op" id="5653790">.</span><span class="ident" id="5653791">closeDescriptors</span><span class="op" id="5653807">(</span><span class="ident" id="5653808">c</span><span class="op" id="5653809">.</span><span class="ident" id="5653810">closeAfterStart</span><span class="op" id="5653825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5653830">c</span><span class="op" id="5653831">.</span><span class="ident" id="5653832">closeDescriptors</span><span class="op" id="5653848">(</span><span class="ident" id="5653849">c</span><span class="op" id="5653850">.</span><span class="ident" id="5653851">closeAfterWait</span><span class="op" id="5653865">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5653870">return</span>&nbsp;<span class="ident" id="5653877">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5653883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5653887">c</span><span class="op" id="5653888">.</span><span class="ident" id="5653889">Path</span>&nbsp;<span class="op" id="5653894">=</span>&nbsp;<span class="ident" id="5653896">lp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5653900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5653903">if</span>&nbsp;<span class="ident" id="5653906">c</span><span class="op" id="5653907">.</span><span class="ident" id="5653908">Process</span>&nbsp;<span class="op" id="5653916">!=</span>&nbsp;<span class="ident" id="5653919">nil</span>&nbsp;<span class="op" id="5653923">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5653927">return</span>&nbsp;<span class="ident" id="5653934">errors</span><span class="op" id="5653940">.</span><span class="ident" id="5653941">New</span><span class="op" id="5653944">(</span><span class="string" id="5653945">&#34;exec:&nbsp;already&nbsp;started&#34;</span><span class="op" id="5653968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5653971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5653975">type</span>&nbsp;<span class="ident" id="5653980">F</span>&nbsp;<span class="keyword" id="5653982">func</span><span class="op" id="5653986">(</span><span class="op" id="5653987">*</span><span class="ident" id="5653988">Cmd</span><span class="op" id="5653991">)</span>&nbsp;<span class="op" id="5653993">(</span><span class="op" id="5653994">*</span><span class="ident" id="5653995">os</span><span class="op" id="5653997">.</span><span class="ident" id="5653998">File</span><span class="op" id="5654002">,</span>&nbsp;<span class="builtintype" id="5654004">error</span><span class="op" id="5654009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5654012">for</span>&nbsp;<span class="ident" id="5654016">_</span><span class="op" id="5654017">,</span>&nbsp;<span class="ident" id="5654019">setupFd</span>&nbsp;<span class="op" id="5654027">:=</span>&nbsp;<span class="keyword" id="5654030">range</span>&nbsp;<span class="op" id="5654036">[</span><span class="op" id="5654037">]</span><span class="ident" id="5654038">F</span><span class="op" id="5654039">{</span><span class="op" id="5654040">(</span><span class="op" id="5654041">*</span><span class="ident" id="5654042">Cmd</span><span class="op" id="5654045">)</span><span class="op" id="5654046">.</span><span class="ident" id="5654047">stdin</span><span class="op" id="5654052">,</span>&nbsp;<span class="op" id="5654054">(</span><span class="op" id="5654055">*</span><span class="ident" id="5654056">Cmd</span><span class="op" id="5654059">)</span><span class="op" id="5654060">.</span><span class="ident" id="5654061">stdout</span><span class="op" id="5654067">,</span>&nbsp;<span class="op" id="5654069">(</span><span class="op" id="5654070">*</span><span class="ident" id="5654071">Cmd</span><span class="op" id="5654074">)</span><span class="op" id="5654075">.</span><span class="ident" id="5654076">stderr</span><span class="op" id="5654082">}</span>&nbsp;<span class="op" id="5654084">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5654088">fd</span><span class="op" id="5654090">,</span>&nbsp;<span class="ident" id="5654092">err</span>&nbsp;<span class="op" id="5654096">:=</span>&nbsp;<span class="ident" id="5654099">setupFd</span><span class="op" id="5654106">(</span><span class="ident" id="5654107">c</span><span class="op" id="5654108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5654112">if</span>&nbsp;<span class="ident" id="5654115">err</span>&nbsp;<span class="op" id="5654119">!=</span>&nbsp;<span class="ident" id="5654122">nil</span>&nbsp;<span class="op" id="5654126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5654131">c</span><span class="op" id="5654132">.</span><span class="ident" id="5654133">closeDescriptors</span><span class="op" id="5654149">(</span><span class="ident" id="5654150">c</span><span class="op" id="5654151">.</span><span class="ident" id="5654152">closeAfterStart</span><span class="op" id="5654167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5654172">c</span><span class="op" id="5654173">.</span><span class="ident" id="5654174">closeDescriptors</span><span class="op" id="5654190">(</span><span class="ident" id="5654191">c</span><span class="op" id="5654192">.</span><span class="ident" id="5654193">closeAfterWait</span><span class="op" id="5654207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5654212">return</span>&nbsp;<span class="ident" id="5654219">err</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5654225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5654229">c</span><span class="op" id="5654230">.</span><span class="ident" id="5654231">childFiles</span>&nbsp;<span class="op" id="5654242">=</span>&nbsp;<span class="builtinfunc" id="5654244">append</span><span class="op" id="5654250">(</span><span class="ident" id="5654251">c</span><span class="op" id="5654252">.</span><span class="ident" id="5654253">childFiles</span><span class="op" id="5654263">,</span>&nbsp;<span class="ident" id="5654265">fd</span><span class="op" id="5654267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5654270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5654273">c</span><span class="op" id="5654274">.</span><span class="ident" id="5654275">childFiles</span>&nbsp;<span class="op" id="5654286">=</span>&nbsp;<span class="builtinfunc" id="5654288">append</span><span class="op" id="5654294">(</span><span class="ident" id="5654295">c</span><span class="op" id="5654296">.</span><span class="ident" id="5654297">childFiles</span><span class="op" id="5654307">,</span>&nbsp;<span class="ident" id="5654309">c</span><span class="op" id="5654310">.</span><span class="ident" id="5654311">ExtraFiles</span><span class="op" id="5654321">...</span><span class="op" id="5654324">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5654328">var</span>&nbsp;<span class="ident" id="5654332">err</span>&nbsp;<span class="builtintype" id="5654336">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5654343">c</span><span class="op" id="5654344">.</span><span class="ident" id="5654345">Process</span><span class="op" id="5654352">,</span>&nbsp;<span class="ident" id="5654354">err</span>&nbsp;<span class="op" id="5654358">=</span>&nbsp;<span class="ident" id="5654360">os</span><span class="op" id="5654362">.</span><span class="ident" id="5654363">StartProcess</span><span class="op" id="5654375">(</span><span class="ident" id="5654376">c</span><span class="op" id="5654377">.</span><span class="ident" id="5654378">Path</span><span class="op" id="5654382">,</span>&nbsp;<span class="ident" id="5654384">c</span><span class="op" id="5654385">.</span><span class="ident" id="5654386">argv</span><span class="op" id="5654390">(</span><span class="op" id="5654391">)</span><span class="op" id="5654392">,</span>&nbsp;<span class="op" id="5654394">&amp;</span><span class="ident" id="5654395">os</span><span class="op" id="5654397">.</span><span class="ident" id="5654398">ProcAttr</span><span class="op" id="5654406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5654410">Dir</span><span class="op" id="5654413">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5654417">c</span><span class="op" id="5654418">.</span><span class="ident" id="5654419">Dir</span><span class="op" id="5654422">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5654426">Files</span><span class="op" id="5654431">:</span>&nbsp;<span class="ident" id="5654433">c</span><span class="op" id="5654434">.</span><span class="ident" id="5654435">childFiles</span><span class="op" id="5654445">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5654449">Env</span><span class="op" id="5654452">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5654456">c</span><span class="op" id="5654457">.</span><span class="ident" id="5654458">envv</span><span class="op" id="5654462">(</span><span class="op" id="5654463">)</span><span class="op" id="5654464">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5654468">Sys</span><span class="op" id="5654471">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5654475">c</span><span class="op" id="5654476">.</span><span class="ident" id="5654477">SysProcAttr</span><span class="op" id="5654488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5654491">}</span><span class="op" id="5654492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5654495">if</span>&nbsp;<span class="ident" id="5654498">err</span>&nbsp;<span class="op" id="5654502">!=</span>&nbsp;<span class="ident" id="5654505">nil</span>&nbsp;<span class="op" id="5654509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5654513">c</span><span class="op" id="5654514">.</span><span class="ident" id="5654515">closeDescriptors</span><span class="op" id="5654531">(</span><span class="ident" id="5654532">c</span><span class="op" id="5654533">.</span><span class="ident" id="5654534">closeAfterStart</span><span class="op" id="5654549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5654553">c</span><span class="op" id="5654554">.</span><span class="ident" id="5654555">closeDescriptors</span><span class="op" id="5654571">(</span><span class="ident" id="5654572">c</span><span class="op" id="5654573">.</span><span class="ident" id="5654574">closeAfterWait</span><span class="op" id="5654588">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5654592">return</span>&nbsp;<span class="ident" id="5654599">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5654604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5654608">c</span><span class="op" id="5654609">.</span><span class="ident" id="5654610">closeDescriptors</span><span class="op" id="5654626">(</span><span class="ident" id="5654627">c</span><span class="op" id="5654628">.</span><span class="ident" id="5654629">closeAfterStart</span><span class="op" id="5654644">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5654648">c</span><span class="op" id="5654649">.</span><span class="ident" id="5654650">errch</span>&nbsp;<span class="op" id="5654656">=</span>&nbsp;<span class="builtinfunc" id="5654658">make</span><span class="op" id="5654662">(</span><span class="keyword" id="5654663">chan</span>&nbsp;<span class="builtintype" id="5654668">error</span><span class="op" id="5654673">,</span>&nbsp;<span class="builtinfunc" id="5654675">len</span><span class="op" id="5654678">(</span><span class="ident" id="5654679">c</span><span class="op" id="5654680">.</span><span class="ident" id="5654681">goroutine</span><span class="op" id="5654690">)</span><span class="op" id="5654691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5654694">for</span>&nbsp;<span class="ident" id="5654698">_</span><span class="op" id="5654699">,</span>&nbsp;<span class="ident" id="5654701">fn</span>&nbsp;<span class="op" id="5654704">:=</span>&nbsp;<span class="keyword" id="5654707">range</span>&nbsp;<span class="ident" id="5654713">c</span><span class="op" id="5654714">.</span><span class="ident" id="5654715">goroutine</span>&nbsp;<span class="op" id="5654725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5654729">go</span>&nbsp;<span class="keyword" id="5654732">func</span><span class="op" id="5654736">(</span><span class="ident" id="5654737">fn</span>&nbsp;<span class="keyword" id="5654740">func</span><span class="op" id="5654744">(</span><span class="op" id="5654745">)</span>&nbsp;<span class="builtintype" id="5654747">error</span><span class="op" id="5654752">)</span>&nbsp;<span class="op" id="5654754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5654759">c</span><span class="op" id="5654760">.</span><span class="ident" id="5654761">errch</span>&nbsp;<span class="op" id="5654767">&lt;-</span>&nbsp;<span class="ident" id="5654770">fn</span><span class="op" id="5654772">(</span><span class="op" id="5654773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5654777">}</span><span class="op" id="5654778">(</span><span class="ident" id="5654779">fn</span><span class="op" id="5654781">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5654784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5654788">return</span>&nbsp;<span class="ident" id="5654795">nil</span><br>
<span class="lineno"></span><span class="op" id="5654799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="comment" id="5654802">//&nbsp;An&nbsp;ExitError&nbsp;reports&nbsp;an&nbsp;unsuccessful&nbsp;exit&nbsp;by&nbsp;a&nbsp;command.</span><br>
<span class="lineno"></span><span class="keyword" id="5654861">type</span>&nbsp;<span class="ident" id="5654866">ExitError</span>&nbsp;<span class="keyword" id="5654876">struct</span>&nbsp;<span class="op" id="5654883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5654886">*</span><span class="ident" id="5654887">os</span><span class="op" id="5654889">.</span><span class="ident" id="5654890">ProcessState</span><br>
<span class="lineno"></span><span class="op" id="5654903">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="keyword" id="5654906">func</span>&nbsp;<span class="op" id="5654911">(</span><span class="ident" id="5654912">e</span>&nbsp;<span class="op" id="5654914">*</span><span class="ident" id="5654915">ExitError</span><span class="op" id="5654924">)</span>&nbsp;<span class="ident" id="5654926">Error</span><span class="op" id="5654931">(</span><span class="op" id="5654932">)</span>&nbsp;<span class="builtintype" id="5654934">string</span>&nbsp;<span class="op" id="5654941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5654944">return</span>&nbsp;<span class="ident" id="5654951">e</span><span class="op" id="5654952">.</span><span class="ident" id="5654953">ProcessState</span><span class="op" id="5654965">.</span><span class="ident" id="5654966">String</span><span class="op" id="5654972">(</span><span class="op" id="5654973">)</span><br>
<span class="lineno"></span><span class="op" id="5654975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5654978">//&nbsp;Wait&nbsp;waits&nbsp;for&nbsp;the&nbsp;command&nbsp;to&nbsp;exit.</span><br>
<span class="lineno">345</span><span class="comment" id="5655017">//&nbsp;It&nbsp;must&nbsp;have&nbsp;been&nbsp;started&nbsp;by&nbsp;Start.</span><br>
<span class="lineno"></span><span class="comment" id="5655056">//</span><br>
<span class="lineno"></span><span class="comment" id="5655059">//&nbsp;The&nbsp;returned&nbsp;error&nbsp;is&nbsp;nil&nbsp;if&nbsp;the&nbsp;command&nbsp;runs,&nbsp;has&nbsp;no&nbsp;problems</span><br>
<span class="lineno"></span><span class="comment" id="5655125">//&nbsp;copying&nbsp;stdin,&nbsp;stdout,&nbsp;and&nbsp;stderr,&nbsp;and&nbsp;exits&nbsp;with&nbsp;a&nbsp;zero&nbsp;exit</span><br>
<span class="lineno"></span><span class="comment" id="5655190">//&nbsp;status.</span><br>
<span class="lineno">350</span><span class="comment" id="5655201">//</span><br>
<span class="lineno"></span><span class="comment" id="5655204">//&nbsp;If&nbsp;the&nbsp;command&nbsp;fails&nbsp;to&nbsp;run&nbsp;or&nbsp;doesn&#39;t&nbsp;complete&nbsp;successfully,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5655273">//&nbsp;error&nbsp;is&nbsp;of&nbsp;type&nbsp;*ExitError.&nbsp;Other&nbsp;error&nbsp;types&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5655330">//&nbsp;returned&nbsp;for&nbsp;I/O&nbsp;problems.</span><br>
<span class="lineno"></span><span class="comment" id="5655360">//</span><br>
<span class="lineno">355</span><span class="comment" id="5655363">//&nbsp;Wait&nbsp;releases&nbsp;any&nbsp;resources&nbsp;associated&nbsp;with&nbsp;the&nbsp;Cmd.</span><br>
<span class="lineno"></span><span class="keyword" id="5655419">func</span>&nbsp;<span class="op" id="5655424">(</span><span class="ident" id="5655425">c</span>&nbsp;<span class="op" id="5655427">*</span><span class="ident" id="5655428">Cmd</span><span class="op" id="5655431">)</span>&nbsp;<span class="ident" id="5655433">Wait</span><span class="op" id="5655437">(</span><span class="op" id="5655438">)</span>&nbsp;<span class="builtintype" id="5655440">error</span>&nbsp;<span class="op" id="5655446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5655449">if</span>&nbsp;<span class="ident" id="5655452">c</span><span class="op" id="5655453">.</span><span class="ident" id="5655454">Process</span>&nbsp;<span class="op" id="5655462">==</span>&nbsp;<span class="ident" id="5655465">nil</span>&nbsp;<span class="op" id="5655469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5655473">return</span>&nbsp;<span class="ident" id="5655480">errors</span><span class="op" id="5655486">.</span><span class="ident" id="5655487">New</span><span class="op" id="5655490">(</span><span class="string" id="5655491">&#34;exec:&nbsp;not&nbsp;started&#34;</span><span class="op" id="5655510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5655513">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5655516">if</span>&nbsp;<span class="ident" id="5655519">c</span><span class="op" id="5655520">.</span><span class="ident" id="5655521">finished</span>&nbsp;<span class="op" id="5655530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5655534">return</span>&nbsp;<span class="ident" id="5655541">errors</span><span class="op" id="5655547">.</span><span class="ident" id="5655548">New</span><span class="op" id="5655551">(</span><span class="string" id="5655552">&#34;exec:&nbsp;Wait&nbsp;was&nbsp;already&nbsp;called&#34;</span><span class="op" id="5655583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5655586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5655589">c</span><span class="op" id="5655590">.</span><span class="ident" id="5655591">finished</span>&nbsp;<span class="op" id="5655600">=</span>&nbsp;<span class="builtintype" id="5655602">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5655608">state</span><span class="op" id="5655613">,</span>&nbsp;<span class="ident" id="5655615">err</span>&nbsp;<span class="op" id="5655619">:=</span>&nbsp;<span class="ident" id="5655622">c</span><span class="op" id="5655623">.</span><span class="ident" id="5655624">Process</span><span class="op" id="5655631">.</span><span class="ident" id="5655632">Wait</span><span class="op" id="5655636">(</span><span class="op" id="5655637">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5655640">c</span><span class="op" id="5655641">.</span><span class="ident" id="5655642">ProcessState</span>&nbsp;<span class="op" id="5655655">=</span>&nbsp;<span class="ident" id="5655657">state</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5655665">var</span>&nbsp;<span class="ident" id="5655669">copyError</span>&nbsp;<span class="builtintype" id="5655679">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5655686">for</span>&nbsp;<span class="keyword" id="5655690">range</span>&nbsp;<span class="ident" id="5655696">c</span><span class="op" id="5655697">.</span><span class="ident" id="5655698">goroutine</span>&nbsp;<span class="op" id="5655708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5655712">if</span>&nbsp;<span class="ident" id="5655715">err</span>&nbsp;<span class="op" id="5655719">:=</span>&nbsp;<span class="op" id="5655722">&lt;-</span><span class="ident" id="5655724">c</span><span class="op" id="5655725">.</span><span class="ident" id="5655726">errch</span><span class="op" id="5655731">;</span>&nbsp;<span class="ident" id="5655733">err</span>&nbsp;<span class="op" id="5655737">!=</span>&nbsp;<span class="ident" id="5655740">nil</span>&nbsp;<span class="op" id="5655744">&amp;&amp;</span>&nbsp;<span class="ident" id="5655747">copyError</span>&nbsp;<span class="op" id="5655757">==</span>&nbsp;<span class="ident" id="5655760">nil</span>&nbsp;<span class="op" id="5655764">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5655769">copyError</span>&nbsp;<span class="op" id="5655779">=</span>&nbsp;<span class="ident" id="5655781">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5655787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5655790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5655794">c</span><span class="op" id="5655795">.</span><span class="ident" id="5655796">closeDescriptors</span><span class="op" id="5655812">(</span><span class="ident" id="5655813">c</span><span class="op" id="5655814">.</span><span class="ident" id="5655815">closeAfterWait</span><span class="op" id="5655829">)</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5655833">if</span>&nbsp;<span class="ident" id="5655836">err</span>&nbsp;<span class="op" id="5655840">!=</span>&nbsp;<span class="ident" id="5655843">nil</span>&nbsp;<span class="op" id="5655847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5655851">return</span>&nbsp;<span class="ident" id="5655858">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5655863">}</span>&nbsp;<span class="keyword" id="5655865">else</span>&nbsp;<span class="keyword" id="5655870">if</span>&nbsp;<span class="op" id="5655873">!</span><span class="ident" id="5655874">state</span><span class="op" id="5655879">.</span><span class="ident" id="5655880">Success</span><span class="op" id="5655887">(</span><span class="op" id="5655888">)</span>&nbsp;<span class="op" id="5655890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5655894">return</span>&nbsp;<span class="op" id="5655901">&amp;</span><span class="ident" id="5655902">ExitError</span><span class="op" id="5655911">{</span><span class="ident" id="5655912">state</span><span class="op" id="5655917">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5655920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5655924">return</span>&nbsp;<span class="ident" id="5655931">copyError</span><br>
<span class="lineno"></span><span class="op" id="5655941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="5655944">//&nbsp;Output&nbsp;runs&nbsp;the&nbsp;command&nbsp;and&nbsp;returns&nbsp;its&nbsp;standard&nbsp;output.</span><br>
<span class="lineno"></span><span class="keyword" id="5656004">func</span>&nbsp;<span class="op" id="5656009">(</span><span class="ident" id="5656010">c</span>&nbsp;<span class="op" id="5656012">*</span><span class="ident" id="5656013">Cmd</span><span class="op" id="5656016">)</span>&nbsp;<span class="ident" id="5656018">Output</span><span class="op" id="5656024">(</span><span class="op" id="5656025">)</span>&nbsp;<span class="op" id="5656027">(</span><span class="op" id="5656028">[</span><span class="op" id="5656029">]</span><span class="builtintype" id="5656030">byte</span><span class="op" id="5656034">,</span>&nbsp;<span class="builtintype" id="5656036">error</span><span class="op" id="5656041">)</span>&nbsp;<span class="op" id="5656043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5656046">if</span>&nbsp;<span class="ident" id="5656049">c</span><span class="op" id="5656050">.</span><span class="ident" id="5656051">Stdout</span>&nbsp;<span class="op" id="5656058">!=</span>&nbsp;<span class="ident" id="5656061">nil</span>&nbsp;<span class="op" id="5656065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5656069">return</span>&nbsp;<span class="ident" id="5656076">nil</span><span class="op" id="5656079">,</span>&nbsp;<span class="ident" id="5656081">errors</span><span class="op" id="5656087">.</span><span class="ident" id="5656088">New</span><span class="op" id="5656091">(</span><span class="string" id="5656092">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="5656118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5656121">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5656124">var</span>&nbsp;<span class="ident" id="5656128">b</span>&nbsp;<span class="ident" id="5656130">bytes</span><span class="op" id="5656135">.</span><span class="ident" id="5656136">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5656144">c</span><span class="op" id="5656145">.</span><span class="ident" id="5656146">Stdout</span>&nbsp;<span class="op" id="5656153">=</span>&nbsp;<span class="op" id="5656155">&amp;</span><span class="ident" id="5656156">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5656159">err</span>&nbsp;<span class="op" id="5656163">:=</span>&nbsp;<span class="ident" id="5656166">c</span><span class="op" id="5656167">.</span><span class="ident" id="5656168">Run</span><span class="op" id="5656171">(</span><span class="op" id="5656172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5656175">return</span>&nbsp;<span class="ident" id="5656182">b</span><span class="op" id="5656183">.</span><span class="ident" id="5656184">Bytes</span><span class="op" id="5656189">(</span><span class="op" id="5656190">)</span><span class="op" id="5656191">,</span>&nbsp;<span class="ident" id="5656193">err</span><br>
<span class="lineno"></span><span class="op" id="5656197">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="5656200">//&nbsp;CombinedOutput&nbsp;runs&nbsp;the&nbsp;command&nbsp;and&nbsp;returns&nbsp;its&nbsp;combined&nbsp;standard</span><br>
<span class="lineno"></span><span class="comment" id="5656269">//&nbsp;output&nbsp;and&nbsp;standard&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="5656299">func</span>&nbsp;<span class="op" id="5656304">(</span><span class="ident" id="5656305">c</span>&nbsp;<span class="op" id="5656307">*</span><span class="ident" id="5656308">Cmd</span><span class="op" id="5656311">)</span>&nbsp;<span class="ident" id="5656313">CombinedOutput</span><span class="op" id="5656327">(</span><span class="op" id="5656328">)</span>&nbsp;<span class="op" id="5656330">(</span><span class="op" id="5656331">[</span><span class="op" id="5656332">]</span><span class="builtintype" id="5656333">byte</span><span class="op" id="5656337">,</span>&nbsp;<span class="builtintype" id="5656339">error</span><span class="op" id="5656344">)</span>&nbsp;<span class="op" id="5656346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5656349">if</span>&nbsp;<span class="ident" id="5656352">c</span><span class="op" id="5656353">.</span><span class="ident" id="5656354">Stdout</span>&nbsp;<span class="op" id="5656361">!=</span>&nbsp;<span class="ident" id="5656364">nil</span>&nbsp;<span class="op" id="5656368">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5656372">return</span>&nbsp;<span class="ident" id="5656379">nil</span><span class="op" id="5656382">,</span>&nbsp;<span class="ident" id="5656384">errors</span><span class="op" id="5656390">.</span><span class="ident" id="5656391">New</span><span class="op" id="5656394">(</span><span class="string" id="5656395">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="5656421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5656424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5656427">if</span>&nbsp;<span class="ident" id="5656430">c</span><span class="op" id="5656431">.</span><span class="ident" id="5656432">Stderr</span>&nbsp;<span class="op" id="5656439">!=</span>&nbsp;<span class="ident" id="5656442">nil</span>&nbsp;<span class="op" id="5656446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5656450">return</span>&nbsp;<span class="ident" id="5656457">nil</span><span class="op" id="5656460">,</span>&nbsp;<span class="ident" id="5656462">errors</span><span class="op" id="5656468">.</span><span class="ident" id="5656469">New</span><span class="op" id="5656472">(</span><span class="string" id="5656473">&#34;exec:&nbsp;Stderr&nbsp;already&nbsp;set&#34;</span><span class="op" id="5656499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5656502">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5656505">var</span>&nbsp;<span class="ident" id="5656509">b</span>&nbsp;<span class="ident" id="5656511">bytes</span><span class="op" id="5656516">.</span><span class="ident" id="5656517">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5656525">c</span><span class="op" id="5656526">.</span><span class="ident" id="5656527">Stdout</span>&nbsp;<span class="op" id="5656534">=</span>&nbsp;<span class="op" id="5656536">&amp;</span><span class="ident" id="5656537">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5656540">c</span><span class="op" id="5656541">.</span><span class="ident" id="5656542">Stderr</span>&nbsp;<span class="op" id="5656549">=</span>&nbsp;<span class="op" id="5656551">&amp;</span><span class="ident" id="5656552">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5656555">err</span>&nbsp;<span class="op" id="5656559">:=</span>&nbsp;<span class="ident" id="5656562">c</span><span class="op" id="5656563">.</span><span class="ident" id="5656564">Run</span><span class="op" id="5656567">(</span><span class="op" id="5656568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5656571">return</span>&nbsp;<span class="ident" id="5656578">b</span><span class="op" id="5656579">.</span><span class="ident" id="5656580">Bytes</span><span class="op" id="5656585">(</span><span class="op" id="5656586">)</span><span class="op" id="5656587">,</span>&nbsp;<span class="ident" id="5656589">err</span><br>
<span class="lineno">410</span><span class="op" id="5656593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5656596">//&nbsp;StdinPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="5656664">//&nbsp;standard&nbsp;input&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="5656707">//&nbsp;The&nbsp;pipe&nbsp;will&nbsp;be&nbsp;closed&nbsp;automatically&nbsp;after&nbsp;Wait&nbsp;sees&nbsp;the&nbsp;command&nbsp;exit.</span><br>
<span class="lineno">415</span><span class="comment" id="5656782">//&nbsp;A&nbsp;caller&nbsp;need&nbsp;only&nbsp;call&nbsp;Close&nbsp;to&nbsp;force&nbsp;the&nbsp;pipe&nbsp;to&nbsp;close&nbsp;sooner.</span><br>
<span class="lineno"></span><span class="comment" id="5656850">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;the&nbsp;command&nbsp;being&nbsp;run&nbsp;will&nbsp;not&nbsp;exit&nbsp;until&nbsp;standard&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="5656926">//&nbsp;is&nbsp;closed,&nbsp;the&nbsp;caller&nbsp;must&nbsp;close&nbsp;the&nbsp;pipe.</span><br>
<span class="lineno"></span><span class="keyword" id="5656972">func</span>&nbsp;<span class="op" id="5656977">(</span><span class="ident" id="5656978">c</span>&nbsp;<span class="op" id="5656980">*</span><span class="ident" id="5656981">Cmd</span><span class="op" id="5656984">)</span>&nbsp;<span class="ident" id="5656986">StdinPipe</span><span class="op" id="5656995">(</span><span class="op" id="5656996">)</span>&nbsp;<span class="op" id="5656998">(</span><span class="ident" id="5656999">io</span><span class="op" id="5657001">.</span><span class="ident" id="5657002">WriteCloser</span><span class="op" id="5657013">,</span>&nbsp;<span class="builtintype" id="5657015">error</span><span class="op" id="5657020">)</span>&nbsp;<span class="op" id="5657022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5657025">if</span>&nbsp;<span class="ident" id="5657028">c</span><span class="op" id="5657029">.</span><span class="ident" id="5657030">Stdin</span>&nbsp;<span class="op" id="5657036">!=</span>&nbsp;<span class="ident" id="5657039">nil</span>&nbsp;<span class="op" id="5657043">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5657047">return</span>&nbsp;<span class="ident" id="5657054">nil</span><span class="op" id="5657057">,</span>&nbsp;<span class="ident" id="5657059">errors</span><span class="op" id="5657065">.</span><span class="ident" id="5657066">New</span><span class="op" id="5657069">(</span><span class="string" id="5657070">&#34;exec:&nbsp;Stdin&nbsp;already&nbsp;set&#34;</span><span class="op" id="5657095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5657098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5657101">if</span>&nbsp;<span class="ident" id="5657104">c</span><span class="op" id="5657105">.</span><span class="ident" id="5657106">Process</span>&nbsp;<span class="op" id="5657114">!=</span>&nbsp;<span class="ident" id="5657117">nil</span>&nbsp;<span class="op" id="5657121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5657125">return</span>&nbsp;<span class="ident" id="5657132">nil</span><span class="op" id="5657135">,</span>&nbsp;<span class="ident" id="5657137">errors</span><span class="op" id="5657143">.</span><span class="ident" id="5657144">New</span><span class="op" id="5657147">(</span><span class="string" id="5657148">&#34;exec:&nbsp;StdinPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="5657187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5657190">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5657193">pr</span><span class="op" id="5657195">,</span>&nbsp;<span class="ident" id="5657197">pw</span><span class="op" id="5657199">,</span>&nbsp;<span class="ident" id="5657201">err</span>&nbsp;<span class="op" id="5657205">:=</span>&nbsp;<span class="ident" id="5657208">os</span><span class="op" id="5657210">.</span><span class="ident" id="5657211">Pipe</span><span class="op" id="5657215">(</span><span class="op" id="5657216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5657219">if</span>&nbsp;<span class="ident" id="5657222">err</span>&nbsp;<span class="op" id="5657226">!=</span>&nbsp;<span class="ident" id="5657229">nil</span>&nbsp;<span class="op" id="5657233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5657237">return</span>&nbsp;<span class="ident" id="5657244">nil</span><span class="op" id="5657247">,</span>&nbsp;<span class="ident" id="5657249">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5657254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5657257">c</span><span class="op" id="5657258">.</span><span class="ident" id="5657259">Stdin</span>&nbsp;<span class="op" id="5657265">=</span>&nbsp;<span class="ident" id="5657267">pr</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5657271">c</span><span class="op" id="5657272">.</span><span class="ident" id="5657273">closeAfterStart</span>&nbsp;<span class="op" id="5657289">=</span>&nbsp;<span class="builtinfunc" id="5657291">append</span><span class="op" id="5657297">(</span><span class="ident" id="5657298">c</span><span class="op" id="5657299">.</span><span class="ident" id="5657300">closeAfterStart</span><span class="op" id="5657315">,</span>&nbsp;<span class="ident" id="5657317">pr</span><span class="op" id="5657319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5657322">wc</span>&nbsp;<span class="op" id="5657325">:=</span>&nbsp;<span class="op" id="5657328">&amp;</span><span class="ident" id="5657329">closeOnce</span><span class="op" id="5657338">{</span><span class="ident" id="5657339">File</span><span class="op" id="5657343">:</span>&nbsp;<span class="ident" id="5657345">pw</span><span class="op" id="5657347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5657350">c</span><span class="op" id="5657351">.</span><span class="ident" id="5657352">closeAfterWait</span>&nbsp;<span class="op" id="5657367">=</span>&nbsp;<span class="builtinfunc" id="5657369">append</span><span class="op" id="5657375">(</span><span class="ident" id="5657376">c</span><span class="op" id="5657377">.</span><span class="ident" id="5657378">closeAfterWait</span><span class="op" id="5657392">,</span>&nbsp;<span class="ident" id="5657394">wc</span><span class="op" id="5657396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5657399">return</span>&nbsp;<span class="ident" id="5657406">wc</span><span class="op" id="5657408">,</span>&nbsp;<span class="ident" id="5657410">nil</span><br>
<span class="lineno"></span><span class="op" id="5657414">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="5657417">type</span>&nbsp;<span class="ident" id="5657422">closeOnce</span>&nbsp;<span class="keyword" id="5657432">struct</span>&nbsp;<span class="op" id="5657439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5657442">*</span><span class="ident" id="5657443">os</span><span class="op" id="5657445">.</span><span class="ident" id="5657446">File</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5657453">once</span>&nbsp;<span class="ident" id="5657458">sync</span><span class="op" id="5657462">.</span><span class="ident" id="5657463">Once</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5657469">err</span>&nbsp;&nbsp;<span class="builtintype" id="5657474">error</span><br>
<span class="lineno"></span><span class="op" id="5657480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5657483">func</span>&nbsp;<span class="op" id="5657488">(</span><span class="ident" id="5657489">c</span>&nbsp;<span class="op" id="5657491">*</span><span class="ident" id="5657492">closeOnce</span><span class="op" id="5657501">)</span>&nbsp;<span class="ident" id="5657503">Close</span><span class="op" id="5657508">(</span><span class="op" id="5657509">)</span>&nbsp;<span class="builtintype" id="5657511">error</span>&nbsp;<span class="op" id="5657517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5657520">c</span><span class="op" id="5657521">.</span><span class="ident" id="5657522">once</span><span class="op" id="5657526">.</span><span class="ident" id="5657527">Do</span><span class="op" id="5657529">(</span><span class="ident" id="5657530">c</span><span class="op" id="5657531">.</span><span class="builtinfunc" id="5657532">close</span><span class="op" id="5657537">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5657540">return</span>&nbsp;<span class="ident" id="5657547">c</span><span class="op" id="5657548">.</span><span class="ident" id="5657549">err</span><br>
<span class="lineno"></span><span class="op" id="5657553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5657556">func</span>&nbsp;<span class="op" id="5657561">(</span><span class="ident" id="5657562">c</span>&nbsp;<span class="op" id="5657564">*</span><span class="ident" id="5657565">closeOnce</span><span class="op" id="5657574">)</span>&nbsp;<span class="builtinfunc" id="5657576">close</span><span class="op" id="5657581">(</span><span class="op" id="5657582">)</span>&nbsp;<span class="op" id="5657584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5657587">c</span><span class="op" id="5657588">.</span><span class="ident" id="5657589">err</span>&nbsp;<span class="op" id="5657593">=</span>&nbsp;<span class="ident" id="5657595">c</span><span class="op" id="5657596">.</span><span class="ident" id="5657597">File</span><span class="op" id="5657601">.</span><span class="ident" id="5657602">Close</span><span class="op" id="5657607">(</span><span class="op" id="5657608">)</span><br>
<span class="lineno">450</span><span class="op" id="5657610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5657613">//&nbsp;StdoutPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="5657682">//&nbsp;standard&nbsp;output&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="5657726">//</span><br>
<span class="lineno">455</span><span class="comment" id="5657729">//&nbsp;Wait&nbsp;will&nbsp;close&nbsp;the&nbsp;pipe&nbsp;after&nbsp;seeing&nbsp;the&nbsp;command&nbsp;exit,&nbsp;so&nbsp;most&nbsp;callers</span><br>
<span class="lineno"></span><span class="comment" id="5657804">//&nbsp;need&nbsp;not&nbsp;close&nbsp;the&nbsp;pipe&nbsp;themselves;&nbsp;however,&nbsp;an&nbsp;implication&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5657875">//&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Wait&nbsp;before&nbsp;all&nbsp;reads&nbsp;from&nbsp;the&nbsp;pipe&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="comment" id="5657954">//&nbsp;For&nbsp;the&nbsp;same&nbsp;reason,&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Run&nbsp;when&nbsp;using&nbsp;StdoutPipe.</span><br>
<span class="lineno"></span><span class="comment" id="5658029">//&nbsp;See&nbsp;the&nbsp;example&nbsp;for&nbsp;idiomatic&nbsp;usage.</span><br>
<span class="lineno">460</span><span class="keyword" id="5658069">func</span>&nbsp;<span class="op" id="5658074">(</span><span class="ident" id="5658075">c</span>&nbsp;<span class="op" id="5658077">*</span><span class="ident" id="5658078">Cmd</span><span class="op" id="5658081">)</span>&nbsp;<span class="ident" id="5658083">StdoutPipe</span><span class="op" id="5658093">(</span><span class="op" id="5658094">)</span>&nbsp;<span class="op" id="5658096">(</span><span class="ident" id="5658097">io</span><span class="op" id="5658099">.</span><span class="ident" id="5658100">ReadCloser</span><span class="op" id="5658110">,</span>&nbsp;<span class="builtintype" id="5658112">error</span><span class="op" id="5658117">)</span>&nbsp;<span class="op" id="5658119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5658122">if</span>&nbsp;<span class="ident" id="5658125">c</span><span class="op" id="5658126">.</span><span class="ident" id="5658127">Stdout</span>&nbsp;<span class="op" id="5658134">!=</span>&nbsp;<span class="ident" id="5658137">nil</span>&nbsp;<span class="op" id="5658141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5658145">return</span>&nbsp;<span class="ident" id="5658152">nil</span><span class="op" id="5658155">,</span>&nbsp;<span class="ident" id="5658157">errors</span><span class="op" id="5658163">.</span><span class="ident" id="5658164">New</span><span class="op" id="5658167">(</span><span class="string" id="5658168">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="5658194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5658197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5658200">if</span>&nbsp;<span class="ident" id="5658203">c</span><span class="op" id="5658204">.</span><span class="ident" id="5658205">Process</span>&nbsp;<span class="op" id="5658213">!=</span>&nbsp;<span class="ident" id="5658216">nil</span>&nbsp;<span class="op" id="5658220">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5658224">return</span>&nbsp;<span class="ident" id="5658231">nil</span><span class="op" id="5658234">,</span>&nbsp;<span class="ident" id="5658236">errors</span><span class="op" id="5658242">.</span><span class="ident" id="5658243">New</span><span class="op" id="5658246">(</span><span class="string" id="5658247">&#34;exec:&nbsp;StdoutPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="5658287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5658290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5658293">pr</span><span class="op" id="5658295">,</span>&nbsp;<span class="ident" id="5658297">pw</span><span class="op" id="5658299">,</span>&nbsp;<span class="ident" id="5658301">err</span>&nbsp;<span class="op" id="5658305">:=</span>&nbsp;<span class="ident" id="5658308">os</span><span class="op" id="5658310">.</span><span class="ident" id="5658311">Pipe</span><span class="op" id="5658315">(</span><span class="op" id="5658316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5658319">if</span>&nbsp;<span class="ident" id="5658322">err</span>&nbsp;<span class="op" id="5658326">!=</span>&nbsp;<span class="ident" id="5658329">nil</span>&nbsp;<span class="op" id="5658333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5658337">return</span>&nbsp;<span class="ident" id="5658344">nil</span><span class="op" id="5658347">,</span>&nbsp;<span class="ident" id="5658349">err</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5658354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5658357">c</span><span class="op" id="5658358">.</span><span class="ident" id="5658359">Stdout</span>&nbsp;<span class="op" id="5658366">=</span>&nbsp;<span class="ident" id="5658368">pw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5658372">c</span><span class="op" id="5658373">.</span><span class="ident" id="5658374">closeAfterStart</span>&nbsp;<span class="op" id="5658390">=</span>&nbsp;<span class="builtinfunc" id="5658392">append</span><span class="op" id="5658398">(</span><span class="ident" id="5658399">c</span><span class="op" id="5658400">.</span><span class="ident" id="5658401">closeAfterStart</span><span class="op" id="5658416">,</span>&nbsp;<span class="ident" id="5658418">pw</span><span class="op" id="5658420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5658423">c</span><span class="op" id="5658424">.</span><span class="ident" id="5658425">closeAfterWait</span>&nbsp;<span class="op" id="5658440">=</span>&nbsp;<span class="builtinfunc" id="5658442">append</span><span class="op" id="5658448">(</span><span class="ident" id="5658449">c</span><span class="op" id="5658450">.</span><span class="ident" id="5658451">closeAfterWait</span><span class="op" id="5658465">,</span>&nbsp;<span class="ident" id="5658467">pr</span><span class="op" id="5658469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5658472">return</span>&nbsp;<span class="ident" id="5658479">pr</span><span class="op" id="5658481">,</span>&nbsp;<span class="ident" id="5658483">nil</span><br>
<span class="lineno">475</span><span class="op" id="5658487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5658490">//&nbsp;StderrPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="5658559">//&nbsp;standard&nbsp;error&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="5658602">//</span><br>
<span class="lineno">480</span><span class="comment" id="5658605">//&nbsp;Wait&nbsp;will&nbsp;close&nbsp;the&nbsp;pipe&nbsp;after&nbsp;seeing&nbsp;the&nbsp;command&nbsp;exit,&nbsp;so&nbsp;most&nbsp;callers</span><br>
<span class="lineno"></span><span class="comment" id="5658680">//&nbsp;need&nbsp;not&nbsp;close&nbsp;the&nbsp;pipe&nbsp;themselves;&nbsp;however,&nbsp;an&nbsp;implication&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5658751">//&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Wait&nbsp;before&nbsp;all&nbsp;reads&nbsp;from&nbsp;the&nbsp;pipe&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="comment" id="5658830">//&nbsp;For&nbsp;the&nbsp;same&nbsp;reason,&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;use&nbsp;Run&nbsp;when&nbsp;using&nbsp;StderrPipe.</span><br>
<span class="lineno"></span><span class="comment" id="5658904">//&nbsp;See&nbsp;the&nbsp;StdoutPipe&nbsp;example&nbsp;for&nbsp;idiomatic&nbsp;usage.</span><br>
<span class="lineno">485</span><span class="keyword" id="5658955">func</span>&nbsp;<span class="op" id="5658960">(</span><span class="ident" id="5658961">c</span>&nbsp;<span class="op" id="5658963">*</span><span class="ident" id="5658964">Cmd</span><span class="op" id="5658967">)</span>&nbsp;<span class="ident" id="5658969">StderrPipe</span><span class="op" id="5658979">(</span><span class="op" id="5658980">)</span>&nbsp;<span class="op" id="5658982">(</span><span class="ident" id="5658983">io</span><span class="op" id="5658985">.</span><span class="ident" id="5658986">ReadCloser</span><span class="op" id="5658996">,</span>&nbsp;<span class="builtintype" id="5658998">error</span><span class="op" id="5659003">)</span>&nbsp;<span class="op" id="5659005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5659008">if</span>&nbsp;<span class="ident" id="5659011">c</span><span class="op" id="5659012">.</span><span class="ident" id="5659013">Stderr</span>&nbsp;<span class="op" id="5659020">!=</span>&nbsp;<span class="ident" id="5659023">nil</span>&nbsp;<span class="op" id="5659027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5659031">return</span>&nbsp;<span class="ident" id="5659038">nil</span><span class="op" id="5659041">,</span>&nbsp;<span class="ident" id="5659043">errors</span><span class="op" id="5659049">.</span><span class="ident" id="5659050">New</span><span class="op" id="5659053">(</span><span class="string" id="5659054">&#34;exec:&nbsp;Stderr&nbsp;already&nbsp;set&#34;</span><span class="op" id="5659080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5659083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5659086">if</span>&nbsp;<span class="ident" id="5659089">c</span><span class="op" id="5659090">.</span><span class="ident" id="5659091">Process</span>&nbsp;<span class="op" id="5659099">!=</span>&nbsp;<span class="ident" id="5659102">nil</span>&nbsp;<span class="op" id="5659106">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5659110">return</span>&nbsp;<span class="ident" id="5659117">nil</span><span class="op" id="5659120">,</span>&nbsp;<span class="ident" id="5659122">errors</span><span class="op" id="5659128">.</span><span class="ident" id="5659129">New</span><span class="op" id="5659132">(</span><span class="string" id="5659133">&#34;exec:&nbsp;StderrPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="5659173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5659176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5659179">pr</span><span class="op" id="5659181">,</span>&nbsp;<span class="ident" id="5659183">pw</span><span class="op" id="5659185">,</span>&nbsp;<span class="ident" id="5659187">err</span>&nbsp;<span class="op" id="5659191">:=</span>&nbsp;<span class="ident" id="5659194">os</span><span class="op" id="5659196">.</span><span class="ident" id="5659197">Pipe</span><span class="op" id="5659201">(</span><span class="op" id="5659202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5659205">if</span>&nbsp;<span class="ident" id="5659208">err</span>&nbsp;<span class="op" id="5659212">!=</span>&nbsp;<span class="ident" id="5659215">nil</span>&nbsp;<span class="op" id="5659219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5659223">return</span>&nbsp;<span class="ident" id="5659230">nil</span><span class="op" id="5659233">,</span>&nbsp;<span class="ident" id="5659235">err</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5659240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5659243">c</span><span class="op" id="5659244">.</span><span class="ident" id="5659245">Stderr</span>&nbsp;<span class="op" id="5659252">=</span>&nbsp;<span class="ident" id="5659254">pw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5659258">c</span><span class="op" id="5659259">.</span><span class="ident" id="5659260">closeAfterStart</span>&nbsp;<span class="op" id="5659276">=</span>&nbsp;<span class="builtinfunc" id="5659278">append</span><span class="op" id="5659284">(</span><span class="ident" id="5659285">c</span><span class="op" id="5659286">.</span><span class="ident" id="5659287">closeAfterStart</span><span class="op" id="5659302">,</span>&nbsp;<span class="ident" id="5659304">pw</span><span class="op" id="5659306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5659309">c</span><span class="op" id="5659310">.</span><span class="ident" id="5659311">closeAfterWait</span>&nbsp;<span class="op" id="5659326">=</span>&nbsp;<span class="builtinfunc" id="5659328">append</span><span class="op" id="5659334">(</span><span class="ident" id="5659335">c</span><span class="op" id="5659336">.</span><span class="ident" id="5659337">closeAfterWait</span><span class="op" id="5659351">,</span>&nbsp;<span class="ident" id="5659353">pr</span><span class="op" id="5659355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5659358">return</span>&nbsp;<span class="ident" id="5659365">pr</span><span class="op" id="5659367">,</span>&nbsp;<span class="ident" id="5659369">nil</span><br>
<span class="lineno">500</span><span class="op" id="5659373">}</span>
</div>
</body>
</html>
