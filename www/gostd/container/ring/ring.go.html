<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>container/ring</h2>
<ul>
<li><a href="/gostd/container/ring/ring.go.html">ring.go</a></li>
<li><a href="/gostd/container/ring/ring_test.go.html">ring_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6344699">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6344754">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6344808">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6344859">//&nbsp;Package&nbsp;ring&nbsp;implements&nbsp;operations&nbsp;on&nbsp;circular&nbsp;lists.</span><br>
<span class="lineno"></span><span class="keyword" id="6344916">package</span>&nbsp;<span class="ident" id="6344924">ring</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6344930">//&nbsp;A&nbsp;Ring&nbsp;is&nbsp;an&nbsp;element&nbsp;of&nbsp;a&nbsp;circular&nbsp;list,&nbsp;or&nbsp;ring.</span><br>
<span class="lineno"></span><span class="comment" id="6344983">//&nbsp;Rings&nbsp;do&nbsp;not&nbsp;have&nbsp;a&nbsp;beginning&nbsp;or&nbsp;end;&nbsp;a&nbsp;pointer&nbsp;to&nbsp;any&nbsp;ring&nbsp;element</span><br>
<span class="lineno">10</span><span class="comment" id="6345054">//&nbsp;serves&nbsp;as&nbsp;reference&nbsp;to&nbsp;the&nbsp;entire&nbsp;ring.&nbsp;Empty&nbsp;rings&nbsp;are&nbsp;represented</span><br>
<span class="lineno"></span><span class="comment" id="6345125">//&nbsp;as&nbsp;nil&nbsp;Ring&nbsp;pointers.&nbsp;The&nbsp;zero&nbsp;value&nbsp;for&nbsp;a&nbsp;Ring&nbsp;is&nbsp;a&nbsp;one-element</span><br>
<span class="lineno"></span><span class="comment" id="6345193">//&nbsp;ring&nbsp;with&nbsp;a&nbsp;nil&nbsp;Value.</span><br>
<span class="lineno"></span><span class="comment" id="6345219">//</span><br>
<span class="lineno"></span><span class="keyword" id="6345222">type</span>&nbsp;<span class="ident" id="6345227">Ring</span>&nbsp;<span class="keyword" id="6345232">struct</span>&nbsp;<span class="op" id="6345239">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345242">next</span><span class="op" id="6345246">,</span>&nbsp;<span class="ident" id="6345248">prev</span>&nbsp;<span class="op" id="6345253">*</span><span class="ident" id="6345254">Ring</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345260">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6345271">interface</span><span class="op" id="6345280">{</span><span class="op" id="6345281">}</span>&nbsp;<span class="comment" id="6345283">//&nbsp;for&nbsp;use&nbsp;by&nbsp;client;&nbsp;untouched&nbsp;by&nbsp;this&nbsp;library</span><br>
<span class="lineno"></span><span class="op" id="6345331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6345334">func</span>&nbsp;<span class="op" id="6345339">(</span><span class="ident" id="6345340">r</span>&nbsp;<span class="op" id="6345342">*</span><span class="ident" id="6345343">Ring</span><span class="op" id="6345347">)</span>&nbsp;<span class="ident" id="6345349">init</span><span class="op" id="6345353">(</span><span class="op" id="6345354">)</span>&nbsp;<span class="op" id="6345356">*</span><span class="ident" id="6345357">Ring</span>&nbsp;<span class="op" id="6345362">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345365">r</span><span class="op" id="6345366">.</span><span class="ident" id="6345367">next</span>&nbsp;<span class="op" id="6345372">=</span>&nbsp;<span class="ident" id="6345374">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345377">r</span><span class="op" id="6345378">.</span><span class="ident" id="6345379">prev</span>&nbsp;<span class="op" id="6345384">=</span>&nbsp;<span class="ident" id="6345386">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345389">return</span>&nbsp;<span class="ident" id="6345396">r</span><br>
<span class="lineno"></span><span class="op" id="6345398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="6345401">//&nbsp;Next&nbsp;returns&nbsp;the&nbsp;next&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="keyword" id="6345461">func</span>&nbsp;<span class="op" id="6345466">(</span><span class="ident" id="6345467">r</span>&nbsp;<span class="op" id="6345469">*</span><span class="ident" id="6345470">Ring</span><span class="op" id="6345474">)</span>&nbsp;<span class="ident" id="6345476">Next</span><span class="op" id="6345480">(</span><span class="op" id="6345481">)</span>&nbsp;<span class="op" id="6345483">*</span><span class="ident" id="6345484">Ring</span>&nbsp;<span class="op" id="6345489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345492">if</span>&nbsp;<span class="ident" id="6345495">r</span><span class="op" id="6345496">.</span><span class="ident" id="6345497">next</span>&nbsp;<span class="op" id="6345502">==</span>&nbsp;<span class="ident" id="6345505">nil</span>&nbsp;<span class="op" id="6345509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345513">return</span>&nbsp;<span class="ident" id="6345520">r</span><span class="op" id="6345521">.</span><span class="ident" id="6345522">init</span><span class="op" id="6345526">(</span><span class="op" id="6345527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6345530">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345533">return</span>&nbsp;<span class="ident" id="6345540">r</span><span class="op" id="6345541">.</span><span class="ident" id="6345542">next</span><br>
<span class="lineno"></span><span class="op" id="6345547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6345550">//&nbsp;Prev&nbsp;returns&nbsp;the&nbsp;previous&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="keyword" id="6345614">func</span>&nbsp;<span class="op" id="6345619">(</span><span class="ident" id="6345620">r</span>&nbsp;<span class="op" id="6345622">*</span><span class="ident" id="6345623">Ring</span><span class="op" id="6345627">)</span>&nbsp;<span class="ident" id="6345629">Prev</span><span class="op" id="6345633">(</span><span class="op" id="6345634">)</span>&nbsp;<span class="op" id="6345636">*</span><span class="ident" id="6345637">Ring</span>&nbsp;<span class="op" id="6345642">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345645">if</span>&nbsp;<span class="ident" id="6345648">r</span><span class="op" id="6345649">.</span><span class="ident" id="6345650">next</span>&nbsp;<span class="op" id="6345655">==</span>&nbsp;<span class="ident" id="6345658">nil</span>&nbsp;<span class="op" id="6345662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345666">return</span>&nbsp;<span class="ident" id="6345673">r</span><span class="op" id="6345674">.</span><span class="ident" id="6345675">init</span><span class="op" id="6345679">(</span><span class="op" id="6345680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6345683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345686">return</span>&nbsp;<span class="ident" id="6345693">r</span><span class="op" id="6345694">.</span><span class="ident" id="6345695">prev</span><br>
<span class="lineno"></span><span class="op" id="6345700">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="6345703">//&nbsp;Move&nbsp;moves&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;elements&nbsp;backward&nbsp;(n&nbsp;&lt;&nbsp;0)&nbsp;or&nbsp;forward&nbsp;(n&nbsp;&gt;=&nbsp;0)</span><br>
<span class="lineno"></span><span class="comment" id="6345775">//&nbsp;in&nbsp;the&nbsp;ring&nbsp;and&nbsp;returns&nbsp;that&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="comment" id="6345842">//</span><br>
<span class="lineno"></span><span class="keyword" id="6345845">func</span>&nbsp;<span class="op" id="6345850">(</span><span class="ident" id="6345851">r</span>&nbsp;<span class="op" id="6345853">*</span><span class="ident" id="6345854">Ring</span><span class="op" id="6345858">)</span>&nbsp;<span class="ident" id="6345860">Move</span><span class="op" id="6345864">(</span><span class="ident" id="6345865">n</span>&nbsp;<span class="builtintype" id="6345867">int</span><span class="op" id="6345870">)</span>&nbsp;<span class="op" id="6345872">*</span><span class="ident" id="6345873">Ring</span>&nbsp;<span class="op" id="6345878">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345881">if</span>&nbsp;<span class="ident" id="6345884">r</span><span class="op" id="6345885">.</span><span class="ident" id="6345886">next</span>&nbsp;<span class="op" id="6345891">==</span>&nbsp;<span class="ident" id="6345894">nil</span>&nbsp;<span class="op" id="6345898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345902">return</span>&nbsp;<span class="ident" id="6345909">r</span><span class="op" id="6345910">.</span><span class="ident" id="6345911">init</span><span class="op" id="6345915">(</span><span class="op" id="6345916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6345919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345922">switch</span>&nbsp;<span class="op" id="6345929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345932">case</span>&nbsp;<span class="ident" id="6345937">n</span>&nbsp;<span class="op" id="6345939">&lt;</span>&nbsp;<span class="num" id="6345941">0</span><span class="op" id="6345942">:</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345946">for</span>&nbsp;<span class="op" id="6345950">;</span>&nbsp;<span class="ident" id="6345952">n</span>&nbsp;<span class="op" id="6345954">&lt;</span>&nbsp;<span class="num" id="6345956">0</span><span class="op" id="6345957">;</span>&nbsp;<span class="ident" id="6345959">n</span><span class="op" id="6345960">++</span>&nbsp;<span class="op" id="6345963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6345968">r</span>&nbsp;<span class="op" id="6345970">=</span>&nbsp;<span class="ident" id="6345972">r</span><span class="op" id="6345973">.</span><span class="ident" id="6345974">prev</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6345981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345984">case</span>&nbsp;<span class="ident" id="6345989">n</span>&nbsp;<span class="op" id="6345991">&gt;</span>&nbsp;<span class="num" id="6345993">0</span><span class="op" id="6345994">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6345998">for</span>&nbsp;<span class="op" id="6346002">;</span>&nbsp;<span class="ident" id="6346004">n</span>&nbsp;<span class="op" id="6346006">&gt;</span>&nbsp;<span class="num" id="6346008">0</span><span class="op" id="6346009">;</span>&nbsp;<span class="ident" id="6346011">n</span><span class="op" id="6346012">--</span>&nbsp;<span class="op" id="6346015">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346020">r</span>&nbsp;<span class="op" id="6346022">=</span>&nbsp;<span class="ident" id="6346024">r</span><span class="op" id="6346025">.</span><span class="ident" id="6346026">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6346033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6346036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346039">return</span>&nbsp;<span class="ident" id="6346046">r</span><br>
<span class="lineno"></span><span class="op" id="6346048">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="6346051">//&nbsp;New&nbsp;creates&nbsp;a&nbsp;ring&nbsp;of&nbsp;n&nbsp;elements.</span><br>
<span class="lineno"></span><span class="keyword" id="6346088">func</span>&nbsp;<span class="ident" id="6346093">New</span><span class="op" id="6346096">(</span><span class="ident" id="6346097">n</span>&nbsp;<span class="builtintype" id="6346099">int</span><span class="op" id="6346102">)</span>&nbsp;<span class="op" id="6346104">*</span><span class="ident" id="6346105">Ring</span>&nbsp;<span class="op" id="6346110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346113">if</span>&nbsp;<span class="ident" id="6346116">n</span>&nbsp;<span class="op" id="6346118">&lt;=</span>&nbsp;<span class="num" id="6346121">0</span>&nbsp;<span class="op" id="6346123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346127">return</span>&nbsp;<span class="ident" id="6346134">nil</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6346139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346142">r</span>&nbsp;<span class="op" id="6346144">:=</span>&nbsp;<span class="builtinfunc" id="6346147">new</span><span class="op" id="6346150">(</span><span class="ident" id="6346151">Ring</span><span class="op" id="6346155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346158">p</span>&nbsp;<span class="op" id="6346160">:=</span>&nbsp;<span class="ident" id="6346163">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346166">for</span>&nbsp;<span class="ident" id="6346170">i</span>&nbsp;<span class="op" id="6346172">:=</span>&nbsp;<span class="num" id="6346175">1</span><span class="op" id="6346176">;</span>&nbsp;<span class="ident" id="6346178">i</span>&nbsp;<span class="op" id="6346180">&lt;</span>&nbsp;<span class="ident" id="6346182">n</span><span class="op" id="6346183">;</span>&nbsp;<span class="ident" id="6346185">i</span><span class="op" id="6346186">++</span>&nbsp;<span class="op" id="6346189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346193">p</span><span class="op" id="6346194">.</span><span class="ident" id="6346195">next</span>&nbsp;<span class="op" id="6346200">=</span>&nbsp;<span class="op" id="6346202">&amp;</span><span class="ident" id="6346203">Ring</span><span class="op" id="6346207">{</span><span class="ident" id="6346208">prev</span><span class="op" id="6346212">:</span>&nbsp;<span class="ident" id="6346214">p</span><span class="op" id="6346215">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346219">p</span>&nbsp;<span class="op" id="6346221">=</span>&nbsp;<span class="ident" id="6346223">p</span><span class="op" id="6346224">.</span><span class="ident" id="6346225">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6346231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346234">p</span><span class="op" id="6346235">.</span><span class="ident" id="6346236">next</span>&nbsp;<span class="op" id="6346241">=</span>&nbsp;<span class="ident" id="6346243">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346246">r</span><span class="op" id="6346247">.</span><span class="ident" id="6346248">prev</span>&nbsp;<span class="op" id="6346253">=</span>&nbsp;<span class="ident" id="6346255">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346258">return</span>&nbsp;<span class="ident" id="6346265">r</span><br>
<span class="lineno">75</span><span class="op" id="6346267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6346270">//&nbsp;Link&nbsp;connects&nbsp;ring&nbsp;r&nbsp;with&nbsp;ring&nbsp;s&nbsp;such&nbsp;that&nbsp;r.Next()</span><br>
<span class="lineno"></span><span class="comment" id="6346325">//&nbsp;becomes&nbsp;s&nbsp;and&nbsp;returns&nbsp;the&nbsp;original&nbsp;value&nbsp;for&nbsp;r.Next().</span><br>
<span class="lineno"></span><span class="comment" id="6346383">//&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno">80</span><span class="comment" id="6346407">//</span><br>
<span class="lineno"></span><span class="comment" id="6346410">//&nbsp;If&nbsp;r&nbsp;and&nbsp;s&nbsp;point&nbsp;to&nbsp;the&nbsp;same&nbsp;ring,&nbsp;linking</span><br>
<span class="lineno"></span><span class="comment" id="6346456">//&nbsp;them&nbsp;removes&nbsp;the&nbsp;elements&nbsp;between&nbsp;r&nbsp;and&nbsp;s&nbsp;from&nbsp;the&nbsp;ring.</span><br>
<span class="lineno"></span><span class="comment" id="6346516">//&nbsp;The&nbsp;removed&nbsp;elements&nbsp;form&nbsp;a&nbsp;subring&nbsp;and&nbsp;the&nbsp;result&nbsp;is&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="6346575">//&nbsp;reference&nbsp;to&nbsp;that&nbsp;subring&nbsp;(if&nbsp;no&nbsp;elements&nbsp;were&nbsp;removed,</span><br>
<span class="lineno">85</span><span class="comment" id="6346634">//&nbsp;the&nbsp;result&nbsp;is&nbsp;still&nbsp;the&nbsp;original&nbsp;value&nbsp;for&nbsp;r.Next(),</span><br>
<span class="lineno"></span><span class="comment" id="6346690">//&nbsp;and&nbsp;not&nbsp;nil).</span><br>
<span class="lineno"></span><span class="comment" id="6346707">//</span><br>
<span class="lineno"></span><span class="comment" id="6346710">//&nbsp;If&nbsp;r&nbsp;and&nbsp;s&nbsp;point&nbsp;to&nbsp;different&nbsp;rings,&nbsp;linking</span><br>
<span class="lineno"></span><span class="comment" id="6346758">//&nbsp;them&nbsp;creates&nbsp;a&nbsp;single&nbsp;ring&nbsp;with&nbsp;the&nbsp;elements&nbsp;of&nbsp;s&nbsp;inserted</span><br>
<span class="lineno">90</span><span class="comment" id="6346820">//&nbsp;after&nbsp;r.&nbsp;The&nbsp;result&nbsp;points&nbsp;to&nbsp;the&nbsp;element&nbsp;following&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6346879">//&nbsp;last&nbsp;element&nbsp;of&nbsp;s&nbsp;after&nbsp;insertion.</span><br>
<span class="lineno"></span><span class="comment" id="6346917">//</span><br>
<span class="lineno"></span><span class="keyword" id="6346920">func</span>&nbsp;<span class="op" id="6346925">(</span><span class="ident" id="6346926">r</span>&nbsp;<span class="op" id="6346928">*</span><span class="ident" id="6346929">Ring</span><span class="op" id="6346933">)</span>&nbsp;<span class="ident" id="6346935">Link</span><span class="op" id="6346939">(</span><span class="ident" id="6346940">s</span>&nbsp;<span class="op" id="6346942">*</span><span class="ident" id="6346943">Ring</span><span class="op" id="6346947">)</span>&nbsp;<span class="op" id="6346949">*</span><span class="ident" id="6346950">Ring</span>&nbsp;<span class="op" id="6346955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346958">n</span>&nbsp;<span class="op" id="6346960">:=</span>&nbsp;<span class="ident" id="6346963">r</span><span class="op" id="6346964">.</span><span class="ident" id="6346965">Next</span><span class="op" id="6346969">(</span><span class="op" id="6346970">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6346973">if</span>&nbsp;<span class="ident" id="6346976">s</span>&nbsp;<span class="op" id="6346978">!=</span>&nbsp;<span class="ident" id="6346981">nil</span>&nbsp;<span class="op" id="6346985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346989">p</span>&nbsp;<span class="op" id="6346991">:=</span>&nbsp;<span class="ident" id="6346994">s</span><span class="op" id="6346995">.</span><span class="ident" id="6346996">Prev</span><span class="op" id="6347000">(</span><span class="op" id="6347001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6347005">//&nbsp;Note:&nbsp;Cannot&nbsp;use&nbsp;multiple&nbsp;assignment&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6347055">//&nbsp;evaluation&nbsp;order&nbsp;of&nbsp;LHS&nbsp;is&nbsp;not&nbsp;specified.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347102">r</span><span class="op" id="6347103">.</span><span class="ident" id="6347104">next</span>&nbsp;<span class="op" id="6347109">=</span>&nbsp;<span class="ident" id="6347111">s</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347115">s</span><span class="op" id="6347116">.</span><span class="ident" id="6347117">prev</span>&nbsp;<span class="op" id="6347122">=</span>&nbsp;<span class="ident" id="6347124">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347128">n</span><span class="op" id="6347129">.</span><span class="ident" id="6347130">prev</span>&nbsp;<span class="op" id="6347135">=</span>&nbsp;<span class="ident" id="6347137">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347141">p</span><span class="op" id="6347142">.</span><span class="ident" id="6347143">next</span>&nbsp;<span class="op" id="6347148">=</span>&nbsp;<span class="ident" id="6347150">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6347153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347156">return</span>&nbsp;<span class="ident" id="6347163">n</span><br>
<span class="lineno">105</span><span class="op" id="6347165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6347168">//&nbsp;Unlink&nbsp;removes&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;elements&nbsp;from&nbsp;the&nbsp;ring&nbsp;r,&nbsp;starting</span><br>
<span class="lineno"></span><span class="comment" id="6347233">//&nbsp;at&nbsp;r.Next().&nbsp;If&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;==&nbsp;0,&nbsp;r&nbsp;remains&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="comment" id="6347291">//&nbsp;The&nbsp;result&nbsp;is&nbsp;the&nbsp;removed&nbsp;subring.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno">110</span><span class="comment" id="6347350">//</span><br>
<span class="lineno"></span><span class="keyword" id="6347353">func</span>&nbsp;<span class="op" id="6347358">(</span><span class="ident" id="6347359">r</span>&nbsp;<span class="op" id="6347361">*</span><span class="ident" id="6347362">Ring</span><span class="op" id="6347366">)</span>&nbsp;<span class="ident" id="6347368">Unlink</span><span class="op" id="6347374">(</span><span class="ident" id="6347375">n</span>&nbsp;<span class="builtintype" id="6347377">int</span><span class="op" id="6347380">)</span>&nbsp;<span class="op" id="6347382">*</span><span class="ident" id="6347383">Ring</span>&nbsp;<span class="op" id="6347388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347391">if</span>&nbsp;<span class="ident" id="6347394">n</span>&nbsp;<span class="op" id="6347396">&lt;=</span>&nbsp;<span class="num" id="6347399">0</span>&nbsp;<span class="op" id="6347401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347405">return</span>&nbsp;<span class="ident" id="6347412">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6347417">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347420">return</span>&nbsp;<span class="ident" id="6347427">r</span><span class="op" id="6347428">.</span><span class="ident" id="6347429">Link</span><span class="op" id="6347433">(</span><span class="ident" id="6347434">r</span><span class="op" id="6347435">.</span><span class="ident" id="6347436">Move</span><span class="op" id="6347440">(</span><span class="ident" id="6347441">n</span>&nbsp;<span class="op" id="6347443">+</span>&nbsp;<span class="num" id="6347445">1</span><span class="op" id="6347446">)</span><span class="op" id="6347447">)</span><br>
<span class="lineno"></span><span class="op" id="6347449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6347452">//&nbsp;Len&nbsp;computes&nbsp;the&nbsp;number&nbsp;of&nbsp;elements&nbsp;in&nbsp;ring&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="6347502">//&nbsp;It&nbsp;executes&nbsp;in&nbsp;time&nbsp;proportional&nbsp;to&nbsp;the&nbsp;number&nbsp;of&nbsp;elements.</span><br>
<span class="lineno">120</span><span class="comment" id="6347565">//</span><br>
<span class="lineno"></span><span class="keyword" id="6347568">func</span>&nbsp;<span class="op" id="6347573">(</span><span class="ident" id="6347574">r</span>&nbsp;<span class="op" id="6347576">*</span><span class="ident" id="6347577">Ring</span><span class="op" id="6347581">)</span>&nbsp;<span class="ident" id="6347583">Len</span><span class="op" id="6347586">(</span><span class="op" id="6347587">)</span>&nbsp;<span class="builtintype" id="6347589">int</span>&nbsp;<span class="op" id="6347593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347596">n</span>&nbsp;<span class="op" id="6347598">:=</span>&nbsp;<span class="num" id="6347601">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347604">if</span>&nbsp;<span class="ident" id="6347607">r</span>&nbsp;<span class="op" id="6347609">!=</span>&nbsp;<span class="ident" id="6347612">nil</span>&nbsp;<span class="op" id="6347616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347620">n</span>&nbsp;<span class="op" id="6347622">=</span>&nbsp;<span class="num" id="6347624">1</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347628">for</span>&nbsp;<span class="ident" id="6347632">p</span>&nbsp;<span class="op" id="6347634">:=</span>&nbsp;<span class="ident" id="6347637">r</span><span class="op" id="6347638">.</span><span class="ident" id="6347639">Next</span><span class="op" id="6347643">(</span><span class="op" id="6347644">)</span><span class="op" id="6347645">;</span>&nbsp;<span class="ident" id="6347647">p</span>&nbsp;<span class="op" id="6347649">!=</span>&nbsp;<span class="ident" id="6347652">r</span><span class="op" id="6347653">;</span>&nbsp;<span class="ident" id="6347655">p</span>&nbsp;<span class="op" id="6347657">=</span>&nbsp;<span class="ident" id="6347659">p</span><span class="op" id="6347660">.</span><span class="ident" id="6347661">next</span>&nbsp;<span class="op" id="6347666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347671">n</span><span class="op" id="6347672">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6347677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6347680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347683">return</span>&nbsp;<span class="ident" id="6347690">n</span><br>
<span class="lineno">130</span><span class="op" id="6347692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6347695">//&nbsp;Do&nbsp;calls&nbsp;function&nbsp;f&nbsp;on&nbsp;each&nbsp;element&nbsp;of&nbsp;the&nbsp;ring,&nbsp;in&nbsp;forward&nbsp;order.</span><br>
<span class="lineno"></span><span class="comment" id="6347765">//&nbsp;The&nbsp;behavior&nbsp;of&nbsp;Do&nbsp;is&nbsp;undefined&nbsp;if&nbsp;f&nbsp;changes&nbsp;*r.</span><br>
<span class="lineno"></span><span class="keyword" id="6347817">func</span>&nbsp;<span class="op" id="6347822">(</span><span class="ident" id="6347823">r</span>&nbsp;<span class="op" id="6347825">*</span><span class="ident" id="6347826">Ring</span><span class="op" id="6347830">)</span>&nbsp;<span class="ident" id="6347832">Do</span><span class="op" id="6347834">(</span><span class="ident" id="6347835">f</span>&nbsp;<span class="keyword" id="6347837">func</span><span class="op" id="6347841">(</span><span class="keyword" id="6347842">interface</span><span class="op" id="6347851">{</span><span class="op" id="6347852">}</span><span class="op" id="6347853">)</span><span class="op" id="6347854">)</span>&nbsp;<span class="op" id="6347856">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347859">if</span>&nbsp;<span class="ident" id="6347862">r</span>&nbsp;<span class="op" id="6347864">!=</span>&nbsp;<span class="ident" id="6347867">nil</span>&nbsp;<span class="op" id="6347871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347875">f</span><span class="op" id="6347876">(</span><span class="ident" id="6347877">r</span><span class="op" id="6347878">.</span><span class="ident" id="6347879">Value</span><span class="op" id="6347884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347888">for</span>&nbsp;<span class="ident" id="6347892">p</span>&nbsp;<span class="op" id="6347894">:=</span>&nbsp;<span class="ident" id="6347897">r</span><span class="op" id="6347898">.</span><span class="ident" id="6347899">Next</span><span class="op" id="6347903">(</span><span class="op" id="6347904">)</span><span class="op" id="6347905">;</span>&nbsp;<span class="ident" id="6347907">p</span>&nbsp;<span class="op" id="6347909">!=</span>&nbsp;<span class="ident" id="6347912">r</span><span class="op" id="6347913">;</span>&nbsp;<span class="ident" id="6347915">p</span>&nbsp;<span class="op" id="6347917">=</span>&nbsp;<span class="ident" id="6347919">p</span><span class="op" id="6347920">.</span><span class="ident" id="6347921">next</span>&nbsp;<span class="op" id="6347926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347931">f</span><span class="op" id="6347932">(</span><span class="ident" id="6347933">p</span><span class="op" id="6347934">.</span><span class="ident" id="6347935">Value</span><span class="op" id="6347940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6347944">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6347947">}</span><br>
<span class="lineno"></span><span class="op" id="6347949">}</span>
</div>
</body>
</html>
