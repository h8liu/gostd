<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1887267">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1887322">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1887376">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1887427">package</span>&nbsp;<span class="ident" id="1887435">fmt</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1887440">import</span>&nbsp;<span class="op" id="1887447">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1887450">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1887458">&#34;strconv&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1887469">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="1887484">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1887487">const</span>&nbsp;<span class="op" id="1887493">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1887496">//&nbsp;%b&nbsp;of&nbsp;an&nbsp;int64,&nbsp;plus&nbsp;a&nbsp;sign.</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1887529">//&nbsp;Hex&nbsp;can&nbsp;add&nbsp;0x&nbsp;and&nbsp;we&nbsp;handle&nbsp;it&nbsp;specially.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1887576">nByte</span>&nbsp;<span class="op" id="1887582">=</span>&nbsp;<span class="num" id="1887584">65</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1887589">ldigits</span>&nbsp;<span class="op" id="1887597">=</span>&nbsp;<span class="string" id="1887599">&#34;0123456789abcdef&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1887619">udigits</span>&nbsp;<span class="op" id="1887627">=</span>&nbsp;<span class="string" id="1887629">&#34;0123456789ABCDEF&#34;</span><br>
<span class="lineno">20</span><span class="op" id="1887648">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1887651">const</span>&nbsp;<span class="op" id="1887657">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1887660">signed</span>&nbsp;&nbsp;&nbsp;<span class="op" id="1887669">=</span>&nbsp;<span class="ident" id="1887671">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1887677">unsigned</span>&nbsp;<span class="op" id="1887686">=</span>&nbsp;<span class="ident" id="1887688">false</span><br>
<span class="lineno">25</span><span class="op" id="1887694">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1887697">var</span>&nbsp;<span class="ident" id="1887701">padZeroBytes</span>&nbsp;<span class="op" id="1887714">=</span>&nbsp;<span class="builtinfunc" id="1887716">make</span><span class="op" id="1887720">(</span><span class="op" id="1887721">[</span><span class="op" id="1887722">]</span><span class="builtintype" id="1887723">byte</span><span class="op" id="1887727">,</span>&nbsp;<span class="ident" id="1887729">nByte</span><span class="op" id="1887734">)</span><br>
<span class="lineno"></span><span class="keyword" id="1887736">var</span>&nbsp;<span class="ident" id="1887740">padSpaceBytes</span>&nbsp;<span class="op" id="1887754">=</span>&nbsp;<span class="builtinfunc" id="1887756">make</span><span class="op" id="1887760">(</span><span class="op" id="1887761">[</span><span class="op" id="1887762">]</span><span class="builtintype" id="1887763">byte</span><span class="op" id="1887767">,</span>&nbsp;<span class="ident" id="1887769">nByte</span><span class="op" id="1887774">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="1887777">func</span>&nbsp;<span class="ident" id="1887782">init</span><span class="op" id="1887786">(</span><span class="op" id="1887787">)</span>&nbsp;<span class="op" id="1887789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1887792">for</span>&nbsp;<span class="ident" id="1887796">i</span>&nbsp;<span class="op" id="1887798">:=</span>&nbsp;<span class="num" id="1887801">0</span><span class="op" id="1887802">;</span>&nbsp;<span class="ident" id="1887804">i</span>&nbsp;<span class="op" id="1887806">&lt;</span>&nbsp;<span class="ident" id="1887808">nByte</span><span class="op" id="1887813">;</span>&nbsp;<span class="ident" id="1887815">i</span><span class="op" id="1887816">++</span>&nbsp;<span class="op" id="1887819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1887823">padZeroBytes</span><span class="op" id="1887835">[</span><span class="ident" id="1887836">i</span><span class="op" id="1887837">]</span>&nbsp;<span class="op" id="1887839">=</span>&nbsp;<span class="string" id="1887841">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1887847">padSpaceBytes</span><span class="op" id="1887860">[</span><span class="ident" id="1887861">i</span><span class="op" id="1887862">]</span>&nbsp;<span class="op" id="1887864">=</span>&nbsp;<span class="string" id="1887866">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1887871">}</span><br>
<span class="lineno">35</span><span class="op" id="1887873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1887876">//&nbsp;flags&nbsp;placed&nbsp;in&nbsp;a&nbsp;separate&nbsp;struct&nbsp;for&nbsp;easy&nbsp;clearing.</span><br>
<span class="lineno"></span><span class="keyword" id="1887932">type</span>&nbsp;<span class="ident" id="1887937">fmtFlags</span>&nbsp;<span class="keyword" id="1887946">struct</span>&nbsp;<span class="op" id="1887953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1887956">widPresent</span>&nbsp;&nbsp;<span class="builtintype" id="1887968">bool</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1887974">precPresent</span>&nbsp;<span class="builtintype" id="1887986">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1887992">minus</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1888004">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888010">plus</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1888022">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888028">sharp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1888040">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888046">space</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1888058">bool</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888064">unicode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1888076">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888082">uniQuote</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1888094">bool</span>&nbsp;<span class="comment" id="1888099">//&nbsp;Use&nbsp;&#39;x&#39;=&nbsp;prefix&nbsp;for&nbsp;%U&nbsp;if&nbsp;printable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888140">zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1888152">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1888159">//&nbsp;For&nbsp;the&nbsp;formats&nbsp;%+v&nbsp;%#v,&nbsp;we&nbsp;set&nbsp;the&nbsp;plusV/sharpV&nbsp;flags</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1888218">//&nbsp;and&nbsp;clear&nbsp;the&nbsp;plus/sharp&nbsp;flags&nbsp;since&nbsp;%+v&nbsp;and&nbsp;%#v&nbsp;are&nbsp;in&nbsp;effect</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1888285">//&nbsp;different,&nbsp;flagless&nbsp;formats&nbsp;set&nbsp;at&nbsp;the&nbsp;top&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888339">plusV</span>&nbsp;&nbsp;<span class="builtintype" id="1888346">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888352">sharpV</span>&nbsp;<span class="builtintype" id="1888359">bool</span><br>
<span class="lineno"></span><span class="op" id="1888364">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="1888367">//&nbsp;A&nbsp;fmt&nbsp;is&nbsp;the&nbsp;raw&nbsp;formatter&nbsp;used&nbsp;by&nbsp;Printf&nbsp;etc.</span><br>
<span class="lineno"></span><span class="comment" id="1888417">//&nbsp;It&nbsp;prints&nbsp;into&nbsp;a&nbsp;buffer&nbsp;that&nbsp;must&nbsp;be&nbsp;set&nbsp;up&nbsp;separately.</span><br>
<span class="lineno"></span><span class="keyword" id="1888476">type</span>&nbsp;<span class="ident" id="1888481">fmt</span>&nbsp;<span class="keyword" id="1888485">struct</span>&nbsp;<span class="op" id="1888492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888495">intbuf</span>&nbsp;<span class="op" id="1888502">[</span><span class="ident" id="1888503">nByte</span><span class="op" id="1888508">]</span><span class="builtintype" id="1888509">byte</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888515">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1888522">*</span><span class="ident" id="1888523">buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1888531">//&nbsp;width,&nbsp;precision</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888552">wid</span>&nbsp;&nbsp;<span class="builtintype" id="1888557">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888562">prec</span>&nbsp;<span class="builtintype" id="1888567">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888572">fmtFlags</span><br>
<span class="lineno">65</span><span class="op" id="1888581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1888584">func</span>&nbsp;<span class="op" id="1888589">(</span><span class="ident" id="1888590">f</span>&nbsp;<span class="op" id="1888592">*</span><span class="ident" id="1888593">fmt</span><span class="op" id="1888596">)</span>&nbsp;<span class="ident" id="1888598">clearflags</span><span class="op" id="1888608">(</span><span class="op" id="1888609">)</span>&nbsp;<span class="op" id="1888611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888614">f</span><span class="op" id="1888615">.</span><span class="ident" id="1888616">fmtFlags</span>&nbsp;<span class="op" id="1888625">=</span>&nbsp;<span class="ident" id="1888627">fmtFlags</span><span class="op" id="1888635">{</span><span class="op" id="1888636">}</span><br>
<span class="lineno"></span><span class="op" id="1888638">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="1888641">func</span>&nbsp;<span class="op" id="1888646">(</span><span class="ident" id="1888647">f</span>&nbsp;<span class="op" id="1888649">*</span><span class="ident" id="1888650">fmt</span><span class="op" id="1888653">)</span>&nbsp;<span class="ident" id="1888655">init</span><span class="op" id="1888659">(</span><span class="ident" id="1888660">buf</span>&nbsp;<span class="op" id="1888664">*</span><span class="ident" id="1888665">buffer</span><span class="op" id="1888671">)</span>&nbsp;<span class="op" id="1888673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888676">f</span><span class="op" id="1888677">.</span><span class="ident" id="1888678">buf</span>&nbsp;<span class="op" id="1888682">=</span>&nbsp;<span class="ident" id="1888684">buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888689">f</span><span class="op" id="1888690">.</span><span class="ident" id="1888691">clearflags</span><span class="op" id="1888701">(</span><span class="op" id="1888702">)</span><br>
<span class="lineno"></span><span class="op" id="1888704">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="1888707">//&nbsp;computePadding&nbsp;computes&nbsp;left&nbsp;and&nbsp;right&nbsp;padding&nbsp;widths&nbsp;(only&nbsp;one&nbsp;will&nbsp;be&nbsp;non-zero).</span><br>
<span class="lineno"></span><span class="keyword" id="1888793">func</span>&nbsp;<span class="op" id="1888798">(</span><span class="ident" id="1888799">f</span>&nbsp;<span class="op" id="1888801">*</span><span class="ident" id="1888802">fmt</span><span class="op" id="1888805">)</span>&nbsp;<span class="ident" id="1888807">computePadding</span><span class="op" id="1888821">(</span><span class="ident" id="1888822">width</span>&nbsp;<span class="builtintype" id="1888828">int</span><span class="op" id="1888831">)</span>&nbsp;<span class="op" id="1888833">(</span><span class="ident" id="1888834">padding</span>&nbsp;<span class="op" id="1888842">[</span><span class="op" id="1888843">]</span><span class="builtintype" id="1888844">byte</span><span class="op" id="1888848">,</span>&nbsp;<span class="ident" id="1888850">leftWidth</span><span class="op" id="1888859">,</span>&nbsp;<span class="ident" id="1888861">rightWidth</span>&nbsp;<span class="builtintype" id="1888872">int</span><span class="op" id="1888875">)</span>&nbsp;<span class="op" id="1888877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888880">left</span>&nbsp;<span class="op" id="1888885">:=</span>&nbsp;<span class="op" id="1888888">!</span><span class="ident" id="1888889">f</span><span class="op" id="1888890">.</span><span class="ident" id="1888891">minus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888898">w</span>&nbsp;<span class="op" id="1888900">:=</span>&nbsp;<span class="ident" id="1888903">f</span><span class="op" id="1888904">.</span><span class="ident" id="1888905">wid</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1888910">if</span>&nbsp;<span class="ident" id="1888913">w</span>&nbsp;<span class="op" id="1888915">&lt;</span>&nbsp;<span class="num" id="1888917">0</span>&nbsp;<span class="op" id="1888919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888923">left</span>&nbsp;<span class="op" id="1888928">=</span>&nbsp;<span class="ident" id="1888930">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888938">w</span>&nbsp;<span class="op" id="1888940">=</span>&nbsp;<span class="op" id="1888942">-</span><span class="ident" id="1888943">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1888946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1888949">w</span>&nbsp;<span class="op" id="1888951">-=</span>&nbsp;<span class="ident" id="1888954">width</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1888961">if</span>&nbsp;<span class="ident" id="1888964">w</span>&nbsp;<span class="op" id="1888966">&gt;</span>&nbsp;<span class="num" id="1888968">0</span>&nbsp;<span class="op" id="1888970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1888974">if</span>&nbsp;<span class="ident" id="1888977">left</span>&nbsp;<span class="op" id="1888982">&amp;&amp;</span>&nbsp;<span class="ident" id="1888985">f</span><span class="op" id="1888986">.</span><span class="ident" id="1888987">zero</span>&nbsp;<span class="op" id="1888992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1888997">return</span>&nbsp;<span class="ident" id="1889004">padZeroBytes</span><span class="op" id="1889016">,</span>&nbsp;<span class="ident" id="1889018">w</span><span class="op" id="1889019">,</span>&nbsp;<span class="num" id="1889021">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1889025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1889029">if</span>&nbsp;<span class="ident" id="1889032">left</span>&nbsp;<span class="op" id="1889037">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1889042">return</span>&nbsp;<span class="ident" id="1889049">padSpaceBytes</span><span class="op" id="1889062">,</span>&nbsp;<span class="ident" id="1889064">w</span><span class="op" id="1889065">,</span>&nbsp;<span class="num" id="1889067">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1889071">}</span>&nbsp;<span class="keyword" id="1889073">else</span>&nbsp;<span class="op" id="1889078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1889083">//&nbsp;can&#39;t&nbsp;be&nbsp;zero&nbsp;padding&nbsp;on&nbsp;the&nbsp;right</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1889124">return</span>&nbsp;<span class="ident" id="1889131">padSpaceBytes</span><span class="op" id="1889144">,</span>&nbsp;<span class="num" id="1889146">0</span><span class="op" id="1889147">,</span>&nbsp;<span class="ident" id="1889149">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1889153">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1889156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1889159">return</span><br>
<span class="lineno"></span><span class="op" id="1889166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1889169">//&nbsp;writePadding&nbsp;generates&nbsp;n&nbsp;bytes&nbsp;of&nbsp;padding.</span><br>
<span class="lineno">100</span><span class="keyword" id="1889215">func</span>&nbsp;<span class="op" id="1889220">(</span><span class="ident" id="1889221">f</span>&nbsp;<span class="op" id="1889223">*</span><span class="ident" id="1889224">fmt</span><span class="op" id="1889227">)</span>&nbsp;<span class="ident" id="1889229">writePadding</span><span class="op" id="1889241">(</span><span class="ident" id="1889242">n</span>&nbsp;<span class="builtintype" id="1889244">int</span><span class="op" id="1889247">,</span>&nbsp;<span class="ident" id="1889249">padding</span>&nbsp;<span class="op" id="1889257">[</span><span class="op" id="1889258">]</span><span class="builtintype" id="1889259">byte</span><span class="op" id="1889263">)</span>&nbsp;<span class="op" id="1889265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1889268">for</span>&nbsp;<span class="ident" id="1889272">n</span>&nbsp;<span class="op" id="1889274">&gt;</span>&nbsp;<span class="num" id="1889276">0</span>&nbsp;<span class="op" id="1889278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889282">m</span>&nbsp;<span class="op" id="1889284">:=</span>&nbsp;<span class="ident" id="1889287">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1889291">if</span>&nbsp;<span class="ident" id="1889294">m</span>&nbsp;<span class="op" id="1889296">&gt;</span>&nbsp;<span class="ident" id="1889298">nByte</span>&nbsp;<span class="op" id="1889304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889309">m</span>&nbsp;<span class="op" id="1889311">=</span>&nbsp;<span class="ident" id="1889313">nByte</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1889321">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889325">f</span><span class="op" id="1889326">.</span><span class="ident" id="1889327">buf</span><span class="op" id="1889330">.</span><span class="ident" id="1889331">Write</span><span class="op" id="1889336">(</span><span class="ident" id="1889337">padding</span><span class="op" id="1889344">[</span><span class="num" id="1889345">0</span><span class="op" id="1889346">:</span><span class="ident" id="1889347">m</span><span class="op" id="1889348">]</span><span class="op" id="1889349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889353">n</span>&nbsp;<span class="op" id="1889355">-=</span>&nbsp;<span class="ident" id="1889358">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1889361">}</span><br>
<span class="lineno"></span><span class="op" id="1889363">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="1889366">//&nbsp;pad&nbsp;appends&nbsp;b&nbsp;to&nbsp;f.buf,&nbsp;padded&nbsp;on&nbsp;left&nbsp;(w&nbsp;&gt;&nbsp;0)&nbsp;or&nbsp;right&nbsp;(w&nbsp;&lt;&nbsp;0&nbsp;or&nbsp;f.minus).</span><br>
<span class="lineno"></span><span class="keyword" id="1889445">func</span>&nbsp;<span class="op" id="1889450">(</span><span class="ident" id="1889451">f</span>&nbsp;<span class="op" id="1889453">*</span><span class="ident" id="1889454">fmt</span><span class="op" id="1889457">)</span>&nbsp;<span class="ident" id="1889459">pad</span><span class="op" id="1889462">(</span><span class="ident" id="1889463">b</span>&nbsp;<span class="op" id="1889465">[</span><span class="op" id="1889466">]</span><span class="builtintype" id="1889467">byte</span><span class="op" id="1889471">)</span>&nbsp;<span class="op" id="1889473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1889476">if</span>&nbsp;<span class="op" id="1889479">!</span><span class="ident" id="1889480">f</span><span class="op" id="1889481">.</span><span class="ident" id="1889482">widPresent</span>&nbsp;<span class="op" id="1889493">||</span>&nbsp;<span class="ident" id="1889496">f</span><span class="op" id="1889497">.</span><span class="ident" id="1889498">wid</span>&nbsp;<span class="op" id="1889502">==</span>&nbsp;<span class="num" id="1889505">0</span>&nbsp;<span class="op" id="1889507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889511">f</span><span class="op" id="1889512">.</span><span class="ident" id="1889513">buf</span><span class="op" id="1889516">.</span><span class="ident" id="1889517">Write</span><span class="op" id="1889522">(</span><span class="ident" id="1889523">b</span><span class="op" id="1889524">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1889528">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1889536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889539">padding</span><span class="op" id="1889546">,</span>&nbsp;<span class="ident" id="1889548">left</span><span class="op" id="1889552">,</span>&nbsp;<span class="ident" id="1889554">right</span>&nbsp;<span class="op" id="1889560">:=</span>&nbsp;<span class="ident" id="1889563">f</span><span class="op" id="1889564">.</span><span class="ident" id="1889565">computePadding</span><span class="op" id="1889579">(</span><span class="ident" id="1889580">utf8</span><span class="op" id="1889584">.</span><span class="ident" id="1889585">RuneCount</span><span class="op" id="1889594">(</span><span class="ident" id="1889595">b</span><span class="op" id="1889596">)</span><span class="op" id="1889597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1889600">if</span>&nbsp;<span class="ident" id="1889603">left</span>&nbsp;<span class="op" id="1889608">&gt;</span>&nbsp;<span class="num" id="1889610">0</span>&nbsp;<span class="op" id="1889612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889616">f</span><span class="op" id="1889617">.</span><span class="ident" id="1889618">writePadding</span><span class="op" id="1889630">(</span><span class="ident" id="1889631">left</span><span class="op" id="1889635">,</span>&nbsp;<span class="ident" id="1889637">padding</span><span class="op" id="1889644">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1889647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889650">f</span><span class="op" id="1889651">.</span><span class="ident" id="1889652">buf</span><span class="op" id="1889655">.</span><span class="ident" id="1889656">Write</span><span class="op" id="1889661">(</span><span class="ident" id="1889662">b</span><span class="op" id="1889663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1889666">if</span>&nbsp;<span class="ident" id="1889669">right</span>&nbsp;<span class="op" id="1889675">&gt;</span>&nbsp;<span class="num" id="1889677">0</span>&nbsp;<span class="op" id="1889679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889683">f</span><span class="op" id="1889684">.</span><span class="ident" id="1889685">writePadding</span><span class="op" id="1889697">(</span><span class="ident" id="1889698">right</span><span class="op" id="1889703">,</span>&nbsp;<span class="ident" id="1889705">padding</span><span class="op" id="1889712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1889715">}</span><br>
<span class="lineno">125</span><span class="op" id="1889717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1889720">//&nbsp;padString&nbsp;appends&nbsp;s&nbsp;to&nbsp;buf,&nbsp;padded&nbsp;on&nbsp;left&nbsp;(w&nbsp;&gt;&nbsp;0)&nbsp;or&nbsp;right&nbsp;(w&nbsp;&lt;&nbsp;0&nbsp;or&nbsp;f.minus).</span><br>
<span class="lineno"></span><span class="keyword" id="1889803">func</span>&nbsp;<span class="op" id="1889808">(</span><span class="ident" id="1889809">f</span>&nbsp;<span class="op" id="1889811">*</span><span class="ident" id="1889812">fmt</span><span class="op" id="1889815">)</span>&nbsp;<span class="ident" id="1889817">padString</span><span class="op" id="1889826">(</span><span class="ident" id="1889827">s</span>&nbsp;<span class="builtintype" id="1889829">string</span><span class="op" id="1889835">)</span>&nbsp;<span class="op" id="1889837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1889840">if</span>&nbsp;<span class="op" id="1889843">!</span><span class="ident" id="1889844">f</span><span class="op" id="1889845">.</span><span class="ident" id="1889846">widPresent</span>&nbsp;<span class="op" id="1889857">||</span>&nbsp;<span class="ident" id="1889860">f</span><span class="op" id="1889861">.</span><span class="ident" id="1889862">wid</span>&nbsp;<span class="op" id="1889866">==</span>&nbsp;<span class="num" id="1889869">0</span>&nbsp;<span class="op" id="1889871">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889875">f</span><span class="op" id="1889876">.</span><span class="ident" id="1889877">buf</span><span class="op" id="1889880">.</span><span class="ident" id="1889881">WriteString</span><span class="op" id="1889892">(</span><span class="ident" id="1889893">s</span><span class="op" id="1889894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1889898">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1889906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889909">padding</span><span class="op" id="1889916">,</span>&nbsp;<span class="ident" id="1889918">left</span><span class="op" id="1889922">,</span>&nbsp;<span class="ident" id="1889924">right</span>&nbsp;<span class="op" id="1889930">:=</span>&nbsp;<span class="ident" id="1889933">f</span><span class="op" id="1889934">.</span><span class="ident" id="1889935">computePadding</span><span class="op" id="1889949">(</span><span class="ident" id="1889950">utf8</span><span class="op" id="1889954">.</span><span class="ident" id="1889955">RuneCountInString</span><span class="op" id="1889972">(</span><span class="ident" id="1889973">s</span><span class="op" id="1889974">)</span><span class="op" id="1889975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1889978">if</span>&nbsp;<span class="ident" id="1889981">left</span>&nbsp;<span class="op" id="1889986">&gt;</span>&nbsp;<span class="num" id="1889988">0</span>&nbsp;<span class="op" id="1889990">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1889994">f</span><span class="op" id="1889995">.</span><span class="ident" id="1889996">writePadding</span><span class="op" id="1890008">(</span><span class="ident" id="1890009">left</span><span class="op" id="1890013">,</span>&nbsp;<span class="ident" id="1890015">padding</span><span class="op" id="1890022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1890025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890028">f</span><span class="op" id="1890029">.</span><span class="ident" id="1890030">buf</span><span class="op" id="1890033">.</span><span class="ident" id="1890034">WriteString</span><span class="op" id="1890045">(</span><span class="ident" id="1890046">s</span><span class="op" id="1890047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1890050">if</span>&nbsp;<span class="ident" id="1890053">right</span>&nbsp;<span class="op" id="1890059">&gt;</span>&nbsp;<span class="num" id="1890061">0</span>&nbsp;<span class="op" id="1890063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890067">f</span><span class="op" id="1890068">.</span><span class="ident" id="1890069">writePadding</span><span class="op" id="1890081">(</span><span class="ident" id="1890082">right</span><span class="op" id="1890087">,</span>&nbsp;<span class="ident" id="1890089">padding</span><span class="op" id="1890096">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1890099">}</span><br>
<span class="lineno"></span><span class="op" id="1890101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1890104">var</span>&nbsp;<span class="op" id="1890108">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890111">trueBytes</span>&nbsp;&nbsp;<span class="op" id="1890122">=</span>&nbsp;<span class="op" id="1890124">[</span><span class="op" id="1890125">]</span><span class="builtintype" id="1890126">byte</span><span class="op" id="1890130">(</span><span class="string" id="1890131">&#34;true&#34;</span><span class="op" id="1890137">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890140">falseBytes</span>&nbsp;<span class="op" id="1890151">=</span>&nbsp;<span class="op" id="1890153">[</span><span class="op" id="1890154">]</span><span class="builtintype" id="1890155">byte</span><span class="op" id="1890159">(</span><span class="string" id="1890160">&#34;false&#34;</span><span class="op" id="1890167">)</span><br>
<span class="lineno"></span><span class="op" id="1890169">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1890172">//&nbsp;fmt_boolean&nbsp;formats&nbsp;a&nbsp;boolean.</span><br>
<span class="lineno"></span><span class="keyword" id="1890206">func</span>&nbsp;<span class="op" id="1890211">(</span><span class="ident" id="1890212">f</span>&nbsp;<span class="op" id="1890214">*</span><span class="ident" id="1890215">fmt</span><span class="op" id="1890218">)</span>&nbsp;<span class="ident" id="1890220">fmt_boolean</span><span class="op" id="1890231">(</span><span class="ident" id="1890232">v</span>&nbsp;<span class="builtintype" id="1890234">bool</span><span class="op" id="1890238">)</span>&nbsp;<span class="op" id="1890240">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1890243">if</span>&nbsp;<span class="ident" id="1890246">v</span>&nbsp;<span class="op" id="1890248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890252">f</span><span class="op" id="1890253">.</span><span class="ident" id="1890254">pad</span><span class="op" id="1890257">(</span><span class="ident" id="1890258">trueBytes</span><span class="op" id="1890267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1890270">}</span>&nbsp;<span class="keyword" id="1890272">else</span>&nbsp;<span class="op" id="1890277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890281">f</span><span class="op" id="1890282">.</span><span class="ident" id="1890283">pad</span><span class="op" id="1890286">(</span><span class="ident" id="1890287">falseBytes</span><span class="op" id="1890297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1890300">}</span><br>
<span class="lineno">155</span><span class="op" id="1890302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1890305">//&nbsp;integer;&nbsp;interprets&nbsp;prec&nbsp;but&nbsp;not&nbsp;wid.&nbsp;&nbsp;Once&nbsp;formatted,&nbsp;result&nbsp;is&nbsp;sent&nbsp;to&nbsp;pad()</span><br>
<span class="lineno"></span><span class="comment" id="1890387">//&nbsp;and&nbsp;then&nbsp;flags&nbsp;are&nbsp;cleared.</span><br>
<span class="lineno"></span><span class="keyword" id="1890418">func</span>&nbsp;<span class="op" id="1890423">(</span><span class="ident" id="1890424">f</span>&nbsp;<span class="op" id="1890426">*</span><span class="ident" id="1890427">fmt</span><span class="op" id="1890430">)</span>&nbsp;<span class="ident" id="1890432">integer</span><span class="op" id="1890439">(</span><span class="ident" id="1890440">a</span>&nbsp;<span class="ident" id="1890442">int64</span><span class="op" id="1890447">,</span>&nbsp;<span class="ident" id="1890449">base</span>&nbsp;<span class="ident" id="1890454">uint64</span><span class="op" id="1890460">,</span>&nbsp;<span class="ident" id="1890462">signedness</span>&nbsp;<span class="builtintype" id="1890473">bool</span><span class="op" id="1890477">,</span>&nbsp;<span class="ident" id="1890479">digits</span>&nbsp;<span class="builtintype" id="1890486">string</span><span class="op" id="1890492">)</span>&nbsp;<span class="op" id="1890494">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1890497">//&nbsp;precision&nbsp;of&nbsp;0&nbsp;and&nbsp;value&nbsp;of&nbsp;0&nbsp;means&nbsp;&#34;print&nbsp;nothing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1890553">if</span>&nbsp;<span class="ident" id="1890556">f</span><span class="op" id="1890557">.</span><span class="ident" id="1890558">precPresent</span>&nbsp;<span class="op" id="1890570">&amp;&amp;</span>&nbsp;<span class="ident" id="1890573">f</span><span class="op" id="1890574">.</span><span class="ident" id="1890575">prec</span>&nbsp;<span class="op" id="1890580">==</span>&nbsp;<span class="num" id="1890583">0</span>&nbsp;<span class="op" id="1890585">&amp;&amp;</span>&nbsp;<span class="ident" id="1890588">a</span>&nbsp;<span class="op" id="1890590">==</span>&nbsp;<span class="num" id="1890593">0</span>&nbsp;<span class="op" id="1890595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1890599">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1890607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1890611">var</span>&nbsp;<span class="ident" id="1890615">buf</span>&nbsp;<span class="op" id="1890619">[</span><span class="op" id="1890620">]</span><span class="builtintype" id="1890621">byte</span>&nbsp;<span class="op" id="1890626">=</span>&nbsp;<span class="ident" id="1890628">f</span><span class="op" id="1890629">.</span><span class="ident" id="1890630">intbuf</span><span class="op" id="1890636">[</span><span class="num" id="1890637">0</span><span class="op" id="1890638">:</span><span class="op" id="1890639">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1890642">if</span>&nbsp;<span class="ident" id="1890645">f</span><span class="op" id="1890646">.</span><span class="ident" id="1890647">widPresent</span>&nbsp;<span class="op" id="1890658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890662">width</span>&nbsp;<span class="op" id="1890668">:=</span>&nbsp;<span class="ident" id="1890671">f</span><span class="op" id="1890672">.</span><span class="ident" id="1890673">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1890679">if</span>&nbsp;<span class="ident" id="1890682">base</span>&nbsp;<span class="op" id="1890687">==</span>&nbsp;<span class="num" id="1890690">16</span>&nbsp;<span class="op" id="1890693">&amp;&amp;</span>&nbsp;<span class="ident" id="1890696">f</span><span class="op" id="1890697">.</span><span class="ident" id="1890698">sharp</span>&nbsp;<span class="op" id="1890704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1890709">//&nbsp;Also&nbsp;adds&nbsp;&#34;0x&#34;.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890731">width</span>&nbsp;<span class="op" id="1890737">+=</span>&nbsp;<span class="num" id="1890740">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1890744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1890748">if</span>&nbsp;<span class="ident" id="1890751">width</span>&nbsp;<span class="op" id="1890757">&gt;</span>&nbsp;<span class="ident" id="1890759">nByte</span>&nbsp;<span class="op" id="1890765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1890770">//&nbsp;We&#39;re&nbsp;going&nbsp;to&nbsp;need&nbsp;a&nbsp;bigger&nbsp;boat.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890811">buf</span>&nbsp;<span class="op" id="1890815">=</span>&nbsp;<span class="builtinfunc" id="1890817">make</span><span class="op" id="1890821">(</span><span class="op" id="1890822">[</span><span class="op" id="1890823">]</span><span class="builtintype" id="1890824">byte</span><span class="op" id="1890828">,</span>&nbsp;<span class="ident" id="1890830">width</span><span class="op" id="1890835">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1890839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1890842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890846">negative</span>&nbsp;<span class="op" id="1890855">:=</span>&nbsp;<span class="ident" id="1890858">signedness</span>&nbsp;<span class="op" id="1890869">==</span>&nbsp;<span class="ident" id="1890872">signed</span>&nbsp;<span class="op" id="1890879">&amp;&amp;</span>&nbsp;<span class="ident" id="1890882">a</span>&nbsp;<span class="op" id="1890884">&lt;</span>&nbsp;<span class="num" id="1890886">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1890889">if</span>&nbsp;<span class="ident" id="1890892">negative</span>&nbsp;<span class="op" id="1890901">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1890905">a</span>&nbsp;<span class="op" id="1890907">=</span>&nbsp;<span class="op" id="1890909">-</span><span class="ident" id="1890910">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1890913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1890917">//&nbsp;two&nbsp;ways&nbsp;to&nbsp;ask&nbsp;for&nbsp;extra&nbsp;leading&nbsp;zero&nbsp;digits:&nbsp;%.3d&nbsp;or&nbsp;%03d.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1890982">//&nbsp;apparently&nbsp;the&nbsp;first&nbsp;cancels&nbsp;the&nbsp;second.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891027">prec</span>&nbsp;<span class="op" id="1891032">:=</span>&nbsp;<span class="num" id="1891035">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1891038">if</span>&nbsp;<span class="ident" id="1891041">f</span><span class="op" id="1891042">.</span><span class="ident" id="1891043">precPresent</span>&nbsp;<span class="op" id="1891055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891059">prec</span>&nbsp;<span class="op" id="1891064">=</span>&nbsp;<span class="ident" id="1891066">f</span><span class="op" id="1891067">.</span><span class="ident" id="1891068">prec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891075">f</span><span class="op" id="1891076">.</span><span class="ident" id="1891077">zero</span>&nbsp;<span class="op" id="1891082">=</span>&nbsp;<span class="ident" id="1891084">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1891091">}</span>&nbsp;<span class="keyword" id="1891093">else</span>&nbsp;<span class="keyword" id="1891098">if</span>&nbsp;<span class="ident" id="1891101">f</span><span class="op" id="1891102">.</span><span class="ident" id="1891103">zero</span>&nbsp;<span class="op" id="1891108">&amp;&amp;</span>&nbsp;<span class="ident" id="1891111">f</span><span class="op" id="1891112">.</span><span class="ident" id="1891113">widPresent</span>&nbsp;<span class="op" id="1891124">&amp;&amp;</span>&nbsp;<span class="op" id="1891127">!</span><span class="ident" id="1891128">f</span><span class="op" id="1891129">.</span><span class="ident" id="1891130">minus</span>&nbsp;<span class="op" id="1891136">&amp;&amp;</span>&nbsp;<span class="ident" id="1891139">f</span><span class="op" id="1891140">.</span><span class="ident" id="1891141">wid</span>&nbsp;<span class="op" id="1891145">&gt;</span>&nbsp;<span class="num" id="1891147">0</span>&nbsp;<span class="op" id="1891149">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891153">prec</span>&nbsp;<span class="op" id="1891158">=</span>&nbsp;<span class="ident" id="1891160">f</span><span class="op" id="1891161">.</span><span class="ident" id="1891162">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1891168">if</span>&nbsp;<span class="ident" id="1891171">negative</span>&nbsp;<span class="op" id="1891180">||</span>&nbsp;<span class="ident" id="1891183">f</span><span class="op" id="1891184">.</span><span class="ident" id="1891185">plus</span>&nbsp;<span class="op" id="1891190">||</span>&nbsp;<span class="ident" id="1891193">f</span><span class="op" id="1891194">.</span><span class="ident" id="1891195">space</span>&nbsp;<span class="op" id="1891201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891206">prec</span><span class="op" id="1891210">--</span>&nbsp;<span class="comment" id="1891213">//&nbsp;leave&nbsp;room&nbsp;for&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1891238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1891241">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1891245">//&nbsp;format&nbsp;a&nbsp;into&nbsp;buf,&nbsp;ending&nbsp;at&nbsp;buf[i].&nbsp;&nbsp;(printing&nbsp;is&nbsp;easier&nbsp;right-to-left.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1891323">//&nbsp;a&nbsp;is&nbsp;made&nbsp;into&nbsp;unsigned&nbsp;ua.&nbsp;&nbsp;we&nbsp;could&nbsp;make&nbsp;things</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1891377">//&nbsp;marginally&nbsp;faster&nbsp;by&nbsp;splitting&nbsp;the&nbsp;32-bit&nbsp;case&nbsp;out&nbsp;into&nbsp;a&nbsp;separate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1891448">//&nbsp;block&nbsp;but&nbsp;it&#39;s&nbsp;not&nbsp;worth&nbsp;the&nbsp;duplication,&nbsp;so&nbsp;ua&nbsp;has&nbsp;64&nbsp;bits.</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891513">i</span>&nbsp;<span class="op" id="1891515">:=</span>&nbsp;<span class="builtinfunc" id="1891518">len</span><span class="op" id="1891521">(</span><span class="ident" id="1891522">buf</span><span class="op" id="1891525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891528">ua</span>&nbsp;<span class="op" id="1891531">:=</span>&nbsp;<span class="ident" id="1891534">uint64</span><span class="op" id="1891540">(</span><span class="ident" id="1891541">a</span><span class="op" id="1891542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1891545">//&nbsp;use&nbsp;constants&nbsp;for&nbsp;the&nbsp;division&nbsp;and&nbsp;modulo&nbsp;for&nbsp;more&nbsp;efficient&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1891616">//&nbsp;switch&nbsp;cases&nbsp;ordered&nbsp;by&nbsp;popularity.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1891656">switch</span>&nbsp;<span class="ident" id="1891663">base</span>&nbsp;<span class="op" id="1891668">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1891671">case</span>&nbsp;<span class="num" id="1891676">10</span><span class="op" id="1891678">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1891682">for</span>&nbsp;<span class="ident" id="1891686">ua</span>&nbsp;<span class="op" id="1891689">&gt;=</span>&nbsp;<span class="num" id="1891692">10</span>&nbsp;<span class="op" id="1891695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891700">i</span><span class="op" id="1891701">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891707">next</span>&nbsp;<span class="op" id="1891712">:=</span>&nbsp;<span class="ident" id="1891715">ua</span>&nbsp;<span class="op" id="1891718">/</span>&nbsp;<span class="num" id="1891720">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891726">buf</span><span class="op" id="1891729">[</span><span class="ident" id="1891730">i</span><span class="op" id="1891731">]</span>&nbsp;<span class="op" id="1891733">=</span>&nbsp;<span class="builtintype" id="1891735">byte</span><span class="op" id="1891739">(</span><span class="string" id="1891740">&#39;0&#39;</span>&nbsp;<span class="op" id="1891744">+</span>&nbsp;<span class="ident" id="1891746">ua</span>&nbsp;<span class="op" id="1891749">-</span>&nbsp;<span class="ident" id="1891751">next</span><span class="op" id="1891755">*</span><span class="num" id="1891756">10</span><span class="op" id="1891758">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891763">ua</span>&nbsp;<span class="op" id="1891766">=</span>&nbsp;<span class="ident" id="1891768">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1891775">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1891778">case</span>&nbsp;<span class="num" id="1891783">16</span><span class="op" id="1891785">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1891789">for</span>&nbsp;<span class="ident" id="1891793">ua</span>&nbsp;<span class="op" id="1891796">&gt;=</span>&nbsp;<span class="num" id="1891799">16</span>&nbsp;<span class="op" id="1891802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891807">i</span><span class="op" id="1891808">--</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891814">buf</span><span class="op" id="1891817">[</span><span class="ident" id="1891818">i</span><span class="op" id="1891819">]</span>&nbsp;<span class="op" id="1891821">=</span>&nbsp;<span class="ident" id="1891823">digits</span><span class="op" id="1891829">[</span><span class="ident" id="1891830">ua</span><span class="op" id="1891832">&amp;</span><span class="num" id="1891833">0xF</span><span class="op" id="1891836">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891841">ua</span>&nbsp;<span class="op" id="1891844">&gt;&gt;=</span>&nbsp;<span class="num" id="1891848">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1891852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1891855">case</span>&nbsp;<span class="num" id="1891860">8</span><span class="op" id="1891861">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1891865">for</span>&nbsp;<span class="ident" id="1891869">ua</span>&nbsp;<span class="op" id="1891872">&gt;=</span>&nbsp;<span class="num" id="1891875">8</span>&nbsp;<span class="op" id="1891877">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891882">i</span><span class="op" id="1891883">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891889">buf</span><span class="op" id="1891892">[</span><span class="ident" id="1891893">i</span><span class="op" id="1891894">]</span>&nbsp;<span class="op" id="1891896">=</span>&nbsp;<span class="builtintype" id="1891898">byte</span><span class="op" id="1891902">(</span><span class="string" id="1891903">&#39;0&#39;</span>&nbsp;<span class="op" id="1891907">+</span>&nbsp;<span class="ident" id="1891909">ua</span><span class="op" id="1891911">&amp;</span><span class="num" id="1891912">7</span><span class="op" id="1891913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891918">ua</span>&nbsp;<span class="op" id="1891921">&gt;&gt;=</span>&nbsp;<span class="num" id="1891925">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1891929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1891932">case</span>&nbsp;<span class="num" id="1891937">2</span><span class="op" id="1891938">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1891942">for</span>&nbsp;<span class="ident" id="1891946">ua</span>&nbsp;<span class="op" id="1891949">&gt;=</span>&nbsp;<span class="num" id="1891952">2</span>&nbsp;<span class="op" id="1891954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891959">i</span><span class="op" id="1891960">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891966">buf</span><span class="op" id="1891969">[</span><span class="ident" id="1891970">i</span><span class="op" id="1891971">]</span>&nbsp;<span class="op" id="1891973">=</span>&nbsp;<span class="builtintype" id="1891975">byte</span><span class="op" id="1891979">(</span><span class="string" id="1891980">&#39;0&#39;</span>&nbsp;<span class="op" id="1891984">+</span>&nbsp;<span class="ident" id="1891986">ua</span><span class="op" id="1891988">&amp;</span><span class="num" id="1891989">1</span><span class="op" id="1891990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1891995">ua</span>&nbsp;<span class="op" id="1891998">&gt;&gt;=</span>&nbsp;<span class="num" id="1892002">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1892006">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892009">default</span><span class="op" id="1892016">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1892020">panic</span><span class="op" id="1892025">(</span><span class="string" id="1892026">&#34;fmt:&nbsp;unknown&nbsp;base;&nbsp;can&#39;t&nbsp;happen&#34;</span><span class="op" id="1892059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1892062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892065">i</span><span class="op" id="1892066">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892070">buf</span><span class="op" id="1892073">[</span><span class="ident" id="1892074">i</span><span class="op" id="1892075">]</span>&nbsp;<span class="op" id="1892077">=</span>&nbsp;<span class="ident" id="1892079">digits</span><span class="op" id="1892085">[</span><span class="ident" id="1892086">ua</span><span class="op" id="1892088">]</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892091">for</span>&nbsp;<span class="ident" id="1892095">i</span>&nbsp;<span class="op" id="1892097">&gt;</span>&nbsp;<span class="num" id="1892099">0</span>&nbsp;<span class="op" id="1892101">&amp;&amp;</span>&nbsp;<span class="ident" id="1892104">prec</span>&nbsp;<span class="op" id="1892109">&gt;</span>&nbsp;<span class="builtinfunc" id="1892111">len</span><span class="op" id="1892114">(</span><span class="ident" id="1892115">buf</span><span class="op" id="1892118">)</span><span class="op" id="1892119">-</span><span class="ident" id="1892120">i</span>&nbsp;<span class="op" id="1892122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892126">i</span><span class="op" id="1892127">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892132">buf</span><span class="op" id="1892135">[</span><span class="ident" id="1892136">i</span><span class="op" id="1892137">]</span>&nbsp;<span class="op" id="1892139">=</span>&nbsp;<span class="string" id="1892141">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1892146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1892150">//&nbsp;Various&nbsp;prefixes:&nbsp;0x,&nbsp;-,&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892184">if</span>&nbsp;<span class="ident" id="1892187">f</span><span class="op" id="1892188">.</span><span class="ident" id="1892189">sharp</span>&nbsp;<span class="op" id="1892195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892199">switch</span>&nbsp;<span class="ident" id="1892206">base</span>&nbsp;<span class="op" id="1892211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892215">case</span>&nbsp;<span class="num" id="1892220">8</span><span class="op" id="1892221">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892226">if</span>&nbsp;<span class="ident" id="1892229">buf</span><span class="op" id="1892232">[</span><span class="ident" id="1892233">i</span><span class="op" id="1892234">]</span>&nbsp;<span class="op" id="1892236">!=</span>&nbsp;<span class="string" id="1892239">&#39;0&#39;</span>&nbsp;<span class="op" id="1892243">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892249">i</span><span class="op" id="1892250">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892257">buf</span><span class="op" id="1892260">[</span><span class="ident" id="1892261">i</span><span class="op" id="1892262">]</span>&nbsp;<span class="op" id="1892264">=</span>&nbsp;<span class="string" id="1892266">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1892273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892277">case</span>&nbsp;<span class="num" id="1892282">16</span><span class="op" id="1892284">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892289">i</span><span class="op" id="1892290">--</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892296">buf</span><span class="op" id="1892299">[</span><span class="ident" id="1892300">i</span><span class="op" id="1892301">]</span>&nbsp;<span class="op" id="1892303">=</span>&nbsp;<span class="string" id="1892305">&#39;x&#39;</span>&nbsp;<span class="op" id="1892309">+</span>&nbsp;<span class="ident" id="1892311">digits</span><span class="op" id="1892317">[</span><span class="num" id="1892318">10</span><span class="op" id="1892320">]</span>&nbsp;<span class="op" id="1892322">-</span>&nbsp;<span class="string" id="1892324">&#39;a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892331">i</span><span class="op" id="1892332">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892338">buf</span><span class="op" id="1892341">[</span><span class="ident" id="1892342">i</span><span class="op" id="1892343">]</span>&nbsp;<span class="op" id="1892345">=</span>&nbsp;<span class="string" id="1892347">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1892353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1892356">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892359">if</span>&nbsp;<span class="ident" id="1892362">f</span><span class="op" id="1892363">.</span><span class="ident" id="1892364">unicode</span>&nbsp;<span class="op" id="1892372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892376">i</span><span class="op" id="1892377">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892382">buf</span><span class="op" id="1892385">[</span><span class="ident" id="1892386">i</span><span class="op" id="1892387">]</span>&nbsp;<span class="op" id="1892389">=</span>&nbsp;<span class="string" id="1892391">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892397">i</span><span class="op" id="1892398">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892403">buf</span><span class="op" id="1892406">[</span><span class="ident" id="1892407">i</span><span class="op" id="1892408">]</span>&nbsp;<span class="op" id="1892410">=</span>&nbsp;<span class="string" id="1892412">&#39;U&#39;</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1892417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892421">if</span>&nbsp;<span class="ident" id="1892424">negative</span>&nbsp;<span class="op" id="1892433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892437">i</span><span class="op" id="1892438">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892443">buf</span><span class="op" id="1892446">[</span><span class="ident" id="1892447">i</span><span class="op" id="1892448">]</span>&nbsp;<span class="op" id="1892450">=</span>&nbsp;<span class="string" id="1892452">&#39;-&#39;</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1892457">}</span>&nbsp;<span class="keyword" id="1892459">else</span>&nbsp;<span class="keyword" id="1892464">if</span>&nbsp;<span class="ident" id="1892467">f</span><span class="op" id="1892468">.</span><span class="ident" id="1892469">plus</span>&nbsp;<span class="op" id="1892474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892478">i</span><span class="op" id="1892479">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892484">buf</span><span class="op" id="1892487">[</span><span class="ident" id="1892488">i</span><span class="op" id="1892489">]</span>&nbsp;<span class="op" id="1892491">=</span>&nbsp;<span class="string" id="1892493">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1892498">}</span>&nbsp;<span class="keyword" id="1892500">else</span>&nbsp;<span class="keyword" id="1892505">if</span>&nbsp;<span class="ident" id="1892508">f</span><span class="op" id="1892509">.</span><span class="ident" id="1892510">space</span>&nbsp;<span class="op" id="1892516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892520">i</span><span class="op" id="1892521">--</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892526">buf</span><span class="op" id="1892529">[</span><span class="ident" id="1892530">i</span><span class="op" id="1892531">]</span>&nbsp;<span class="op" id="1892533">=</span>&nbsp;<span class="string" id="1892535">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1892540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1892544">//&nbsp;If&nbsp;we&nbsp;want&nbsp;a&nbsp;quoted&nbsp;char&nbsp;for&nbsp;%#U,&nbsp;move&nbsp;the&nbsp;data&nbsp;up&nbsp;to&nbsp;make&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1892613">if</span>&nbsp;<span class="ident" id="1892616">f</span><span class="op" id="1892617">.</span><span class="ident" id="1892618">unicode</span>&nbsp;<span class="op" id="1892626">&amp;&amp;</span>&nbsp;<span class="ident" id="1892629">f</span><span class="op" id="1892630">.</span><span class="ident" id="1892631">uniQuote</span>&nbsp;<span class="op" id="1892640">&amp;&amp;</span>&nbsp;<span class="ident" id="1892643">a</span>&nbsp;<span class="op" id="1892645">&gt;=</span>&nbsp;<span class="num" id="1892648">0</span>&nbsp;<span class="op" id="1892650">&amp;&amp;</span>&nbsp;<span class="ident" id="1892653">a</span>&nbsp;<span class="op" id="1892655">&lt;=</span>&nbsp;<span class="ident" id="1892658">utf8</span><span class="op" id="1892662">.</span><span class="ident" id="1892663">MaxRune</span>&nbsp;<span class="op" id="1892671">&amp;&amp;</span>&nbsp;<span class="ident" id="1892674">strconv</span><span class="op" id="1892681">.</span><span class="ident" id="1892682">IsPrint</span><span class="op" id="1892689">(</span><span class="builtintype" id="1892690">rune</span><span class="op" id="1892694">(</span><span class="ident" id="1892695">a</span><span class="op" id="1892696">)</span><span class="op" id="1892697">)</span>&nbsp;<span class="op" id="1892699">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892703">runeWidth</span>&nbsp;<span class="op" id="1892713">:=</span>&nbsp;<span class="ident" id="1892716">utf8</span><span class="op" id="1892720">.</span><span class="ident" id="1892721">RuneLen</span><span class="op" id="1892728">(</span><span class="builtintype" id="1892729">rune</span><span class="op" id="1892733">(</span><span class="ident" id="1892734">a</span><span class="op" id="1892735">)</span><span class="op" id="1892736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892740">width</span>&nbsp;<span class="op" id="1892746">:=</span>&nbsp;<span class="num" id="1892749">1</span>&nbsp;<span class="op" id="1892751">+</span>&nbsp;<span class="num" id="1892753">1</span>&nbsp;<span class="op" id="1892755">+</span>&nbsp;<span class="ident" id="1892757">runeWidth</span>&nbsp;<span class="op" id="1892767">+</span>&nbsp;<span class="num" id="1892769">1</span>&nbsp;<span class="comment" id="1892771">//&nbsp;space,&nbsp;quote,&nbsp;rune,&nbsp;quote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1892802">copy</span><span class="op" id="1892806">(</span><span class="ident" id="1892807">buf</span><span class="op" id="1892810">[</span><span class="ident" id="1892811">i</span><span class="op" id="1892812">-</span><span class="ident" id="1892813">width</span><span class="op" id="1892818">:</span><span class="op" id="1892819">]</span><span class="op" id="1892820">,</span>&nbsp;<span class="ident" id="1892822">buf</span><span class="op" id="1892825">[</span><span class="ident" id="1892826">i</span><span class="op" id="1892827">:</span><span class="op" id="1892828">]</span><span class="op" id="1892829">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1892833">//&nbsp;guaranteed&nbsp;to&nbsp;have&nbsp;enough&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892870">i</span>&nbsp;<span class="op" id="1892872">-=</span>&nbsp;<span class="ident" id="1892875">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1892883">//&nbsp;Now&nbsp;put&nbsp;&#34;&nbsp;&#39;x&#39;&#34;&nbsp;at&nbsp;the&nbsp;end.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892915">j</span>&nbsp;<span class="op" id="1892917">:=</span>&nbsp;<span class="builtinfunc" id="1892920">len</span><span class="op" id="1892923">(</span><span class="ident" id="1892924">buf</span><span class="op" id="1892927">)</span>&nbsp;<span class="op" id="1892929">-</span>&nbsp;<span class="ident" id="1892931">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892939">buf</span><span class="op" id="1892942">[</span><span class="ident" id="1892943">j</span><span class="op" id="1892944">]</span>&nbsp;<span class="op" id="1892946">=</span>&nbsp;<span class="string" id="1892948">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892954">j</span><span class="op" id="1892955">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892960">buf</span><span class="op" id="1892963">[</span><span class="ident" id="1892964">j</span><span class="op" id="1892965">]</span>&nbsp;<span class="op" id="1892967">=</span>&nbsp;<span class="string" id="1892969">&#39;\&#39;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892976">j</span><span class="op" id="1892977">++</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1892982">utf8</span><span class="op" id="1892986">.</span><span class="ident" id="1892987">EncodeRune</span><span class="op" id="1892997">(</span><span class="ident" id="1892998">buf</span><span class="op" id="1893001">[</span><span class="ident" id="1893002">j</span><span class="op" id="1893003">:</span><span class="op" id="1893004">]</span><span class="op" id="1893005">,</span>&nbsp;<span class="builtintype" id="1893007">rune</span><span class="op" id="1893011">(</span><span class="ident" id="1893012">a</span><span class="op" id="1893013">)</span><span class="op" id="1893014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893018">j</span>&nbsp;<span class="op" id="1893020">+=</span>&nbsp;<span class="ident" id="1893023">runeWidth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893035">buf</span><span class="op" id="1893038">[</span><span class="ident" id="1893039">j</span><span class="op" id="1893040">]</span>&nbsp;<span class="op" id="1893042">=</span>&nbsp;<span class="string" id="1893044">&#39;\&#39;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1893050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893054">f</span><span class="op" id="1893055">.</span><span class="ident" id="1893056">pad</span><span class="op" id="1893059">(</span><span class="ident" id="1893060">buf</span><span class="op" id="1893063">[</span><span class="ident" id="1893064">i</span><span class="op" id="1893065">:</span><span class="op" id="1893066">]</span><span class="op" id="1893067">)</span><br>
<span class="lineno"></span><span class="op" id="1893069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1893072">//&nbsp;truncate&nbsp;truncates&nbsp;the&nbsp;string&nbsp;to&nbsp;the&nbsp;specified&nbsp;precision,&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="1893145">func</span>&nbsp;<span class="op" id="1893150">(</span><span class="ident" id="1893151">f</span>&nbsp;<span class="op" id="1893153">*</span><span class="ident" id="1893154">fmt</span><span class="op" id="1893157">)</span>&nbsp;<span class="ident" id="1893159">truncate</span><span class="op" id="1893167">(</span><span class="ident" id="1893168">s</span>&nbsp;<span class="builtintype" id="1893170">string</span><span class="op" id="1893176">)</span>&nbsp;<span class="builtintype" id="1893178">string</span>&nbsp;<span class="op" id="1893185">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893188">if</span>&nbsp;<span class="ident" id="1893191">f</span><span class="op" id="1893192">.</span><span class="ident" id="1893193">precPresent</span>&nbsp;<span class="op" id="1893205">&amp;&amp;</span>&nbsp;<span class="ident" id="1893208">f</span><span class="op" id="1893209">.</span><span class="ident" id="1893210">prec</span>&nbsp;<span class="op" id="1893215">&lt;</span>&nbsp;<span class="ident" id="1893217">utf8</span><span class="op" id="1893221">.</span><span class="ident" id="1893222">RuneCountInString</span><span class="op" id="1893239">(</span><span class="ident" id="1893240">s</span><span class="op" id="1893241">)</span>&nbsp;<span class="op" id="1893243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893247">n</span>&nbsp;<span class="op" id="1893249">:=</span>&nbsp;<span class="ident" id="1893252">f</span><span class="op" id="1893253">.</span><span class="ident" id="1893254">prec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893261">for</span>&nbsp;<span class="ident" id="1893265">i</span>&nbsp;<span class="op" id="1893267">:=</span>&nbsp;<span class="keyword" id="1893270">range</span>&nbsp;<span class="ident" id="1893276">s</span>&nbsp;<span class="op" id="1893278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893283">if</span>&nbsp;<span class="ident" id="1893286">n</span>&nbsp;<span class="op" id="1893288">==</span>&nbsp;<span class="num" id="1893291">0</span>&nbsp;<span class="op" id="1893293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893299">s</span>&nbsp;<span class="op" id="1893301">=</span>&nbsp;<span class="ident" id="1893303">s</span><span class="op" id="1893304">[</span><span class="op" id="1893305">:</span><span class="ident" id="1893306">i</span><span class="op" id="1893307">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893313">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1893322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893327">n</span><span class="op" id="1893328">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1893333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1893336">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893339">return</span>&nbsp;<span class="ident" id="1893346">s</span><br>
<span class="lineno"></span><span class="op" id="1893348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1893351">//&nbsp;fmt_s&nbsp;formats&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="1893378">func</span>&nbsp;<span class="op" id="1893383">(</span><span class="ident" id="1893384">f</span>&nbsp;<span class="op" id="1893386">*</span><span class="ident" id="1893387">fmt</span><span class="op" id="1893390">)</span>&nbsp;<span class="ident" id="1893392">fmt_s</span><span class="op" id="1893397">(</span><span class="ident" id="1893398">s</span>&nbsp;<span class="builtintype" id="1893400">string</span><span class="op" id="1893406">)</span>&nbsp;<span class="op" id="1893408">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893411">s</span>&nbsp;<span class="op" id="1893413">=</span>&nbsp;<span class="ident" id="1893415">f</span><span class="op" id="1893416">.</span><span class="ident" id="1893417">truncate</span><span class="op" id="1893425">(</span><span class="ident" id="1893426">s</span><span class="op" id="1893427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893430">f</span><span class="op" id="1893431">.</span><span class="ident" id="1893432">padString</span><span class="op" id="1893441">(</span><span class="ident" id="1893442">s</span><span class="op" id="1893443">)</span><br>
<span class="lineno"></span><span class="op" id="1893445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1893448">//&nbsp;fmt_sbx&nbsp;formats&nbsp;a&nbsp;string&nbsp;or&nbsp;byte&nbsp;slice&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno">315</span><span class="keyword" id="1893530">func</span>&nbsp;<span class="op" id="1893535">(</span><span class="ident" id="1893536">f</span>&nbsp;<span class="op" id="1893538">*</span><span class="ident" id="1893539">fmt</span><span class="op" id="1893542">)</span>&nbsp;<span class="ident" id="1893544">fmt_sbx</span><span class="op" id="1893551">(</span><span class="ident" id="1893552">s</span>&nbsp;<span class="builtintype" id="1893554">string</span><span class="op" id="1893560">,</span>&nbsp;<span class="ident" id="1893562">b</span>&nbsp;<span class="op" id="1893564">[</span><span class="op" id="1893565">]</span><span class="builtintype" id="1893566">byte</span><span class="op" id="1893570">,</span>&nbsp;<span class="ident" id="1893572">digits</span>&nbsp;<span class="builtintype" id="1893579">string</span><span class="op" id="1893585">)</span>&nbsp;<span class="op" id="1893587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893590">n</span>&nbsp;<span class="op" id="1893592">:=</span>&nbsp;<span class="builtinfunc" id="1893595">len</span><span class="op" id="1893598">(</span><span class="ident" id="1893599">b</span><span class="op" id="1893600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893603">if</span>&nbsp;<span class="ident" id="1893606">b</span>&nbsp;<span class="op" id="1893608">==</span>&nbsp;<span class="ident" id="1893611">nil</span>&nbsp;<span class="op" id="1893615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893619">n</span>&nbsp;<span class="op" id="1893621">=</span>&nbsp;<span class="builtinfunc" id="1893623">len</span><span class="op" id="1893626">(</span><span class="ident" id="1893627">s</span><span class="op" id="1893628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1893631">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893634">x</span>&nbsp;<span class="op" id="1893636">:=</span>&nbsp;<span class="ident" id="1893639">digits</span><span class="op" id="1893645">[</span><span class="num" id="1893646">10</span><span class="op" id="1893648">]</span>&nbsp;<span class="op" id="1893650">-</span>&nbsp;<span class="string" id="1893652">&#39;a&#39;</span>&nbsp;<span class="op" id="1893656">+</span>&nbsp;<span class="string" id="1893658">&#39;x&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1893663">//&nbsp;TODO:&nbsp;Avoid&nbsp;buffer&nbsp;by&nbsp;pre-padding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893702">var</span>&nbsp;<span class="ident" id="1893706">buf</span>&nbsp;<span class="op" id="1893710">[</span><span class="op" id="1893711">]</span><span class="builtintype" id="1893712">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893718">for</span>&nbsp;<span class="ident" id="1893722">i</span>&nbsp;<span class="op" id="1893724">:=</span>&nbsp;<span class="num" id="1893727">0</span><span class="op" id="1893728">;</span>&nbsp;<span class="ident" id="1893730">i</span>&nbsp;<span class="op" id="1893732">&lt;</span>&nbsp;<span class="ident" id="1893734">n</span><span class="op" id="1893735">;</span>&nbsp;<span class="ident" id="1893737">i</span><span class="op" id="1893738">++</span>&nbsp;<span class="op" id="1893741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893745">if</span>&nbsp;<span class="ident" id="1893748">i</span>&nbsp;<span class="op" id="1893750">&gt;</span>&nbsp;<span class="num" id="1893752">0</span>&nbsp;<span class="op" id="1893754">&amp;&amp;</span>&nbsp;<span class="ident" id="1893757">f</span><span class="op" id="1893758">.</span><span class="ident" id="1893759">space</span>&nbsp;<span class="op" id="1893765">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893770">buf</span>&nbsp;<span class="op" id="1893774">=</span>&nbsp;<span class="builtinfunc" id="1893776">append</span><span class="op" id="1893782">(</span><span class="ident" id="1893783">buf</span><span class="op" id="1893786">,</span>&nbsp;<span class="string" id="1893788">&#39;&nbsp;&#39;</span><span class="op" id="1893791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1893795">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893799">if</span>&nbsp;<span class="ident" id="1893802">f</span><span class="op" id="1893803">.</span><span class="ident" id="1893804">sharp</span>&nbsp;<span class="op" id="1893810">&amp;&amp;</span>&nbsp;<span class="op" id="1893813">(</span><span class="ident" id="1893814">f</span><span class="op" id="1893815">.</span><span class="ident" id="1893816">space</span>&nbsp;<span class="op" id="1893822">||</span>&nbsp;<span class="ident" id="1893825">i</span>&nbsp;<span class="op" id="1893827">==</span>&nbsp;<span class="num" id="1893830">0</span><span class="op" id="1893831">)</span>&nbsp;<span class="op" id="1893833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893838">buf</span>&nbsp;<span class="op" id="1893842">=</span>&nbsp;<span class="builtinfunc" id="1893844">append</span><span class="op" id="1893850">(</span><span class="ident" id="1893851">buf</span><span class="op" id="1893854">,</span>&nbsp;<span class="string" id="1893856">&#39;0&#39;</span><span class="op" id="1893859">,</span>&nbsp;<span class="ident" id="1893861">x</span><span class="op" id="1893862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1893866">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893870">var</span>&nbsp;<span class="ident" id="1893874">c</span>&nbsp;<span class="builtintype" id="1893876">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1893883">if</span>&nbsp;<span class="ident" id="1893886">b</span>&nbsp;<span class="op" id="1893888">==</span>&nbsp;<span class="ident" id="1893891">nil</span>&nbsp;<span class="op" id="1893895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893900">c</span>&nbsp;<span class="op" id="1893902">=</span>&nbsp;<span class="ident" id="1893904">s</span><span class="op" id="1893905">[</span><span class="ident" id="1893906">i</span><span class="op" id="1893907">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1893911">}</span>&nbsp;<span class="keyword" id="1893913">else</span>&nbsp;<span class="op" id="1893918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893923">c</span>&nbsp;<span class="op" id="1893925">=</span>&nbsp;<span class="ident" id="1893927">b</span><span class="op" id="1893928">[</span><span class="ident" id="1893929">i</span><span class="op" id="1893930">]</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1893934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893938">buf</span>&nbsp;<span class="op" id="1893942">=</span>&nbsp;<span class="builtinfunc" id="1893944">append</span><span class="op" id="1893950">(</span><span class="ident" id="1893951">buf</span><span class="op" id="1893954">,</span>&nbsp;<span class="ident" id="1893956">digits</span><span class="op" id="1893962">[</span><span class="ident" id="1893963">c</span><span class="op" id="1893964">&gt;&gt;</span><span class="num" id="1893966">4</span><span class="op" id="1893967">]</span><span class="op" id="1893968">,</span>&nbsp;<span class="ident" id="1893970">digits</span><span class="op" id="1893976">[</span><span class="ident" id="1893977">c</span><span class="op" id="1893978">&amp;</span><span class="num" id="1893979">0xF</span><span class="op" id="1893982">]</span><span class="op" id="1893983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1893986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1893989">f</span><span class="op" id="1893990">.</span><span class="ident" id="1893991">pad</span><span class="op" id="1893994">(</span><span class="ident" id="1893995">buf</span><span class="op" id="1893998">)</span><br>
<span class="lineno"></span><span class="op" id="1894000">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="comment" id="1894003">//&nbsp;fmt_sx&nbsp;formats&nbsp;a&nbsp;string&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="1894070">func</span>&nbsp;<span class="op" id="1894075">(</span><span class="ident" id="1894076">f</span>&nbsp;<span class="op" id="1894078">*</span><span class="ident" id="1894079">fmt</span><span class="op" id="1894082">)</span>&nbsp;<span class="ident" id="1894084">fmt_sx</span><span class="op" id="1894090">(</span><span class="ident" id="1894091">s</span><span class="op" id="1894092">,</span>&nbsp;<span class="ident" id="1894094">digits</span>&nbsp;<span class="builtintype" id="1894101">string</span><span class="op" id="1894107">)</span>&nbsp;<span class="op" id="1894109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1894112">if</span>&nbsp;<span class="ident" id="1894115">f</span><span class="op" id="1894116">.</span><span class="ident" id="1894117">precPresent</span>&nbsp;<span class="op" id="1894129">&amp;&amp;</span>&nbsp;<span class="ident" id="1894132">f</span><span class="op" id="1894133">.</span><span class="ident" id="1894134">prec</span>&nbsp;<span class="op" id="1894139">&lt;</span>&nbsp;<span class="builtinfunc" id="1894141">len</span><span class="op" id="1894144">(</span><span class="ident" id="1894145">s</span><span class="op" id="1894146">)</span>&nbsp;<span class="op" id="1894148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1894152">s</span>&nbsp;<span class="op" id="1894154">=</span>&nbsp;<span class="ident" id="1894156">s</span><span class="op" id="1894157">[</span><span class="op" id="1894158">:</span><span class="ident" id="1894159">f</span><span class="op" id="1894160">.</span><span class="ident" id="1894161">prec</span><span class="op" id="1894165">]</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1894168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1894171">f</span><span class="op" id="1894172">.</span><span class="ident" id="1894173">fmt_sbx</span><span class="op" id="1894180">(</span><span class="ident" id="1894181">s</span><span class="op" id="1894182">,</span>&nbsp;<span class="ident" id="1894184">nil</span><span class="op" id="1894187">,</span>&nbsp;<span class="ident" id="1894189">digits</span><span class="op" id="1894195">)</span><br>
<span class="lineno"></span><span class="op" id="1894197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1894200">//&nbsp;fmt_bx&nbsp;formats&nbsp;a&nbsp;byte&nbsp;slice&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno">350</span><span class="keyword" id="1894271">func</span>&nbsp;<span class="op" id="1894276">(</span><span class="ident" id="1894277">f</span>&nbsp;<span class="op" id="1894279">*</span><span class="ident" id="1894280">fmt</span><span class="op" id="1894283">)</span>&nbsp;<span class="ident" id="1894285">fmt_bx</span><span class="op" id="1894291">(</span><span class="ident" id="1894292">b</span>&nbsp;<span class="op" id="1894294">[</span><span class="op" id="1894295">]</span><span class="builtintype" id="1894296">byte</span><span class="op" id="1894300">,</span>&nbsp;<span class="ident" id="1894302">digits</span>&nbsp;<span class="builtintype" id="1894309">string</span><span class="op" id="1894315">)</span>&nbsp;<span class="op" id="1894317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1894320">if</span>&nbsp;<span class="ident" id="1894323">f</span><span class="op" id="1894324">.</span><span class="ident" id="1894325">precPresent</span>&nbsp;<span class="op" id="1894337">&amp;&amp;</span>&nbsp;<span class="ident" id="1894340">f</span><span class="op" id="1894341">.</span><span class="ident" id="1894342">prec</span>&nbsp;<span class="op" id="1894347">&lt;</span>&nbsp;<span class="builtinfunc" id="1894349">len</span><span class="op" id="1894352">(</span><span class="ident" id="1894353">b</span><span class="op" id="1894354">)</span>&nbsp;<span class="op" id="1894356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1894360">b</span>&nbsp;<span class="op" id="1894362">=</span>&nbsp;<span class="ident" id="1894364">b</span><span class="op" id="1894365">[</span><span class="op" id="1894366">:</span><span class="ident" id="1894367">f</span><span class="op" id="1894368">.</span><span class="ident" id="1894369">prec</span><span class="op" id="1894373">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1894376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1894379">f</span><span class="op" id="1894380">.</span><span class="ident" id="1894381">fmt_sbx</span><span class="op" id="1894388">(</span><span class="string" id="1894389">&#34;&#34;</span><span class="op" id="1894391">,</span>&nbsp;<span class="ident" id="1894393">b</span><span class="op" id="1894394">,</span>&nbsp;<span class="ident" id="1894396">digits</span><span class="op" id="1894402">)</span><br>
<span class="lineno">355</span><span class="op" id="1894404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1894407">//&nbsp;fmt_q&nbsp;formats&nbsp;a&nbsp;string&nbsp;as&nbsp;a&nbsp;double-quoted,&nbsp;escaped&nbsp;Go&nbsp;string&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="1894481">func</span>&nbsp;<span class="op" id="1894486">(</span><span class="ident" id="1894487">f</span>&nbsp;<span class="op" id="1894489">*</span><span class="ident" id="1894490">fmt</span><span class="op" id="1894493">)</span>&nbsp;<span class="ident" id="1894495">fmt_q</span><span class="op" id="1894500">(</span><span class="ident" id="1894501">s</span>&nbsp;<span class="builtintype" id="1894503">string</span><span class="op" id="1894509">)</span>&nbsp;<span class="op" id="1894511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1894514">s</span>&nbsp;<span class="op" id="1894516">=</span>&nbsp;<span class="ident" id="1894518">f</span><span class="op" id="1894519">.</span><span class="ident" id="1894520">truncate</span><span class="op" id="1894528">(</span><span class="ident" id="1894529">s</span><span class="op" id="1894530">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1894533">var</span>&nbsp;<span class="ident" id="1894537">quoted</span>&nbsp;<span class="builtintype" id="1894544">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1894552">if</span>&nbsp;<span class="ident" id="1894555">f</span><span class="op" id="1894556">.</span><span class="ident" id="1894557">sharp</span>&nbsp;<span class="op" id="1894563">&amp;&amp;</span>&nbsp;<span class="ident" id="1894566">strconv</span><span class="op" id="1894573">.</span><span class="ident" id="1894574">CanBackquote</span><span class="op" id="1894586">(</span><span class="ident" id="1894587">s</span><span class="op" id="1894588">)</span>&nbsp;<span class="op" id="1894590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1894594">quoted</span>&nbsp;<span class="op" id="1894601">=</span>&nbsp;<span class="string" id="1894603">&#34;`&#34;</span>&nbsp;<span class="op" id="1894607">+</span>&nbsp;<span class="ident" id="1894609">s</span>&nbsp;<span class="op" id="1894611">+</span>&nbsp;<span class="string" id="1894613">&#34;`&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1894618">}</span>&nbsp;<span class="keyword" id="1894620">else</span>&nbsp;<span class="op" id="1894625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1894629">if</span>&nbsp;<span class="ident" id="1894632">f</span><span class="op" id="1894633">.</span><span class="ident" id="1894634">plus</span>&nbsp;<span class="op" id="1894639">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1894644">quoted</span>&nbsp;<span class="op" id="1894651">=</span>&nbsp;<span class="ident" id="1894653">strconv</span><span class="op" id="1894660">.</span><span class="ident" id="1894661">QuoteToASCII</span><span class="op" id="1894673">(</span><span class="ident" id="1894674">s</span><span class="op" id="1894675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1894679">}</span>&nbsp;<span class="keyword" id="1894681">else</span>&nbsp;<span class="op" id="1894686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1894691">quoted</span>&nbsp;<span class="op" id="1894698">=</span>&nbsp;<span class="ident" id="1894700">strconv</span><span class="op" id="1894707">.</span><span class="ident" id="1894708">Quote</span><span class="op" id="1894713">(</span><span class="ident" id="1894714">s</span><span class="op" id="1894715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1894719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1894722">}</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1894725">f</span><span class="op" id="1894726">.</span><span class="ident" id="1894727">padString</span><span class="op" id="1894736">(</span><span class="ident" id="1894737">quoted</span><span class="op" id="1894743">)</span><br>
<span class="lineno"></span><span class="op" id="1894745">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1894748">//&nbsp;fmt_qc&nbsp;formats&nbsp;the&nbsp;integer&nbsp;as&nbsp;a&nbsp;single-quoted,&nbsp;escaped&nbsp;Go&nbsp;character&nbsp;constant.</span><br>
<span class="lineno"></span><span class="comment" id="1894829">//&nbsp;If&nbsp;the&nbsp;character&nbsp;is&nbsp;not&nbsp;valid&nbsp;Unicode,&nbsp;it&nbsp;will&nbsp;print&nbsp;&#39;\ufffd&#39;.</span><br>
<span class="lineno">375</span><span class="keyword" id="1894895">func</span>&nbsp;<span class="op" id="1894900">(</span><span class="ident" id="1894901">f</span>&nbsp;<span class="op" id="1894903">*</span><span class="ident" id="1894904">fmt</span><span class="op" id="1894907">)</span>&nbsp;<span class="ident" id="1894909">fmt_qc</span><span class="op" id="1894915">(</span><span class="ident" id="1894916">c</span>&nbsp;<span class="ident" id="1894918">int64</span><span class="op" id="1894923">)</span>&nbsp;<span class="op" id="1894925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1894928">var</span>&nbsp;<span class="ident" id="1894932">quoted</span>&nbsp;<span class="op" id="1894939">[</span><span class="op" id="1894940">]</span><span class="builtintype" id="1894941">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1894947">if</span>&nbsp;<span class="ident" id="1894950">f</span><span class="op" id="1894951">.</span><span class="ident" id="1894952">plus</span>&nbsp;<span class="op" id="1894957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1894961">quoted</span>&nbsp;<span class="op" id="1894968">=</span>&nbsp;<span class="ident" id="1894970">strconv</span><span class="op" id="1894977">.</span><span class="ident" id="1894978">AppendQuoteRuneToASCII</span><span class="op" id="1895000">(</span><span class="ident" id="1895001">f</span><span class="op" id="1895002">.</span><span class="ident" id="1895003">intbuf</span><span class="op" id="1895009">[</span><span class="num" id="1895010">0</span><span class="op" id="1895011">:</span><span class="num" id="1895012">0</span><span class="op" id="1895013">]</span><span class="op" id="1895014">,</span>&nbsp;<span class="builtintype" id="1895016">rune</span><span class="op" id="1895020">(</span><span class="ident" id="1895021">c</span><span class="op" id="1895022">)</span><span class="op" id="1895023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1895026">}</span>&nbsp;<span class="keyword" id="1895028">else</span>&nbsp;<span class="op" id="1895033">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1895037">quoted</span>&nbsp;<span class="op" id="1895044">=</span>&nbsp;<span class="ident" id="1895046">strconv</span><span class="op" id="1895053">.</span><span class="ident" id="1895054">AppendQuoteRune</span><span class="op" id="1895069">(</span><span class="ident" id="1895070">f</span><span class="op" id="1895071">.</span><span class="ident" id="1895072">intbuf</span><span class="op" id="1895078">[</span><span class="num" id="1895079">0</span><span class="op" id="1895080">:</span><span class="num" id="1895081">0</span><span class="op" id="1895082">]</span><span class="op" id="1895083">,</span>&nbsp;<span class="builtintype" id="1895085">rune</span><span class="op" id="1895089">(</span><span class="ident" id="1895090">c</span><span class="op" id="1895091">)</span><span class="op" id="1895092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1895095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1895098">f</span><span class="op" id="1895099">.</span><span class="ident" id="1895100">pad</span><span class="op" id="1895103">(</span><span class="ident" id="1895104">quoted</span><span class="op" id="1895110">)</span><br>
<span class="lineno"></span><span class="op" id="1895112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="1895115">//&nbsp;floating-point</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1895134">func</span>&nbsp;<span class="ident" id="1895139">doPrec</span><span class="op" id="1895145">(</span><span class="ident" id="1895146">f</span>&nbsp;<span class="op" id="1895148">*</span><span class="ident" id="1895149">fmt</span><span class="op" id="1895152">,</span>&nbsp;<span class="ident" id="1895154">def</span>&nbsp;<span class="builtintype" id="1895158">int</span><span class="op" id="1895161">)</span>&nbsp;<span class="builtintype" id="1895163">int</span>&nbsp;<span class="op" id="1895167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1895170">if</span>&nbsp;<span class="ident" id="1895173">f</span><span class="op" id="1895174">.</span><span class="ident" id="1895175">precPresent</span>&nbsp;<span class="op" id="1895187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1895191">return</span>&nbsp;<span class="ident" id="1895198">f</span><span class="op" id="1895199">.</span><span class="ident" id="1895200">prec</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1895206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1895209">return</span>&nbsp;<span class="ident" id="1895216">def</span><br>
<span class="lineno"></span><span class="op" id="1895220">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1895223">//&nbsp;formatFloat&nbsp;formats&nbsp;a&nbsp;float64;&nbsp;it&nbsp;is&nbsp;an&nbsp;efficient&nbsp;equivalent&nbsp;to&nbsp;&nbsp;f.pad(strconv.FormatFloat()...).</span><br>
<span class="lineno">395</span><span class="keyword" id="1895324">func</span>&nbsp;<span class="op" id="1895329">(</span><span class="ident" id="1895330">f</span>&nbsp;<span class="op" id="1895332">*</span><span class="ident" id="1895333">fmt</span><span class="op" id="1895336">)</span>&nbsp;<span class="ident" id="1895338">formatFloat</span><span class="op" id="1895349">(</span><span class="ident" id="1895350">v</span>&nbsp;<span class="builtintype" id="1895352">float64</span><span class="op" id="1895359">,</span>&nbsp;<span class="ident" id="1895361">verb</span>&nbsp;<span class="builtintype" id="1895366">byte</span><span class="op" id="1895370">,</span>&nbsp;<span class="ident" id="1895372">prec</span><span class="op" id="1895376">,</span>&nbsp;<span class="ident" id="1895378">n</span>&nbsp;<span class="builtintype" id="1895380">int</span><span class="op" id="1895383">)</span>&nbsp;<span class="op" id="1895385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1895388">//&nbsp;Format&nbsp;number,&nbsp;reserving&nbsp;space&nbsp;for&nbsp;leading&nbsp;+&nbsp;sign&nbsp;if&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1895453">num</span>&nbsp;<span class="op" id="1895457">:=</span>&nbsp;<span class="ident" id="1895460">strconv</span><span class="op" id="1895467">.</span><span class="ident" id="1895468">AppendFloat</span><span class="op" id="1895479">(</span><span class="ident" id="1895480">f</span><span class="op" id="1895481">.</span><span class="ident" id="1895482">intbuf</span><span class="op" id="1895488">[</span><span class="num" id="1895489">0</span><span class="op" id="1895490">:</span><span class="num" id="1895491">1</span><span class="op" id="1895492">]</span><span class="op" id="1895493">,</span>&nbsp;<span class="ident" id="1895495">v</span><span class="op" id="1895496">,</span>&nbsp;<span class="ident" id="1895498">verb</span><span class="op" id="1895502">,</span>&nbsp;<span class="ident" id="1895504">prec</span><span class="op" id="1895508">,</span>&nbsp;<span class="ident" id="1895510">n</span><span class="op" id="1895511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1895514">if</span>&nbsp;<span class="ident" id="1895517">num</span><span class="op" id="1895520">[</span><span class="num" id="1895521">1</span><span class="op" id="1895522">]</span>&nbsp;<span class="op" id="1895524">==</span>&nbsp;<span class="string" id="1895527">&#39;-&#39;</span>&nbsp;<span class="op" id="1895531">||</span>&nbsp;<span class="ident" id="1895534">num</span><span class="op" id="1895537">[</span><span class="num" id="1895538">1</span><span class="op" id="1895539">]</span>&nbsp;<span class="op" id="1895541">==</span>&nbsp;<span class="string" id="1895544">&#39;+&#39;</span>&nbsp;<span class="op" id="1895548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1895552">num</span>&nbsp;<span class="op" id="1895556">=</span>&nbsp;<span class="ident" id="1895558">num</span><span class="op" id="1895561">[</span><span class="num" id="1895562">1</span><span class="op" id="1895563">:</span><span class="op" id="1895564">]</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1895567">}</span>&nbsp;<span class="keyword" id="1895569">else</span>&nbsp;<span class="op" id="1895574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1895578">num</span><span class="op" id="1895581">[</span><span class="num" id="1895582">0</span><span class="op" id="1895583">]</span>&nbsp;<span class="op" id="1895585">=</span>&nbsp;<span class="string" id="1895587">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1895592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1895595">//&nbsp;Special&nbsp;handling&nbsp;for&nbsp;infinity,&nbsp;which&nbsp;doesn&#39;t&nbsp;look&nbsp;like&nbsp;a&nbsp;number&nbsp;so&nbsp;shouldn&#39;t&nbsp;be&nbsp;padded&nbsp;with&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1895698">if</span>&nbsp;<span class="ident" id="1895701">math</span><span class="op" id="1895705">.</span><span class="ident" id="1895706">IsInf</span><span class="op" id="1895711">(</span><span class="ident" id="1895712">v</span><span class="op" id="1895713">,</span>&nbsp;<span class="num" id="1895715">0</span><span class="op" id="1895716">)</span>&nbsp;<span class="op" id="1895718">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1895722">if</span>&nbsp;<span class="ident" id="1895725">f</span><span class="op" id="1895726">.</span><span class="ident" id="1895727">zero</span>&nbsp;<span class="op" id="1895732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1895737">defer</span>&nbsp;<span class="keyword" id="1895743">func</span><span class="op" id="1895747">(</span><span class="op" id="1895748">)</span>&nbsp;<span class="op" id="1895750">{</span>&nbsp;<span class="ident" id="1895752">f</span><span class="op" id="1895753">.</span><span class="ident" id="1895754">zero</span>&nbsp;<span class="op" id="1895759">=</span>&nbsp;<span class="ident" id="1895761">true</span>&nbsp;<span class="op" id="1895766">}</span><span class="op" id="1895767">(</span><span class="op" id="1895768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1895773">f</span><span class="op" id="1895774">.</span><span class="ident" id="1895775">zero</span>&nbsp;<span class="op" id="1895780">=</span>&nbsp;<span class="ident" id="1895782">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1895790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1895793">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1895796">//&nbsp;num&nbsp;is&nbsp;now&nbsp;a&nbsp;signed&nbsp;version&nbsp;of&nbsp;the&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1895843">//&nbsp;If&nbsp;we&#39;re&nbsp;zero&nbsp;padding,&nbsp;want&nbsp;the&nbsp;sign&nbsp;before&nbsp;the&nbsp;leading&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1895910">//&nbsp;Achieve&nbsp;this&nbsp;by&nbsp;writing&nbsp;the&nbsp;sign&nbsp;out&nbsp;and&nbsp;then&nbsp;padding&nbsp;the&nbsp;unsigned&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1895989">if</span>&nbsp;<span class="ident" id="1895992">f</span><span class="op" id="1895993">.</span><span class="ident" id="1895994">zero</span>&nbsp;<span class="op" id="1895999">&amp;&amp;</span>&nbsp;<span class="ident" id="1896002">f</span><span class="op" id="1896003">.</span><span class="ident" id="1896004">widPresent</span>&nbsp;<span class="op" id="1896015">&amp;&amp;</span>&nbsp;<span class="ident" id="1896018">f</span><span class="op" id="1896019">.</span><span class="ident" id="1896020">wid</span>&nbsp;<span class="op" id="1896024">&gt;</span>&nbsp;<span class="builtinfunc" id="1896026">len</span><span class="op" id="1896029">(</span><span class="ident" id="1896030">num</span><span class="op" id="1896033">)</span>&nbsp;<span class="op" id="1896035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1896039">if</span>&nbsp;<span class="ident" id="1896042">f</span><span class="op" id="1896043">.</span><span class="ident" id="1896044">space</span>&nbsp;<span class="op" id="1896050">&amp;&amp;</span>&nbsp;<span class="ident" id="1896053">v</span>&nbsp;<span class="op" id="1896055">&gt;=</span>&nbsp;<span class="num" id="1896058">0</span>&nbsp;<span class="op" id="1896060">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1896065">f</span><span class="op" id="1896066">.</span><span class="ident" id="1896067">buf</span><span class="op" id="1896070">.</span><span class="ident" id="1896071">WriteByte</span><span class="op" id="1896080">(</span><span class="string" id="1896081">&#39;&nbsp;&#39;</span><span class="op" id="1896084">)</span>&nbsp;<span class="comment" id="1896086">//&nbsp;This&nbsp;is&nbsp;what&nbsp;C&nbsp;does:&nbsp;even&nbsp;with&nbsp;zero,&nbsp;f.space&nbsp;means&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1896150">f</span><span class="op" id="1896151">.</span><span class="ident" id="1896152">wid</span><span class="op" id="1896155">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1896160">}</span>&nbsp;<span class="keyword" id="1896162">else</span>&nbsp;<span class="keyword" id="1896167">if</span>&nbsp;<span class="ident" id="1896170">f</span><span class="op" id="1896171">.</span><span class="ident" id="1896172">plus</span>&nbsp;<span class="op" id="1896177">||</span>&nbsp;<span class="ident" id="1896180">v</span>&nbsp;<span class="op" id="1896182">&lt;</span>&nbsp;<span class="num" id="1896184">0</span>&nbsp;<span class="op" id="1896186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1896191">f</span><span class="op" id="1896192">.</span><span class="ident" id="1896193">buf</span><span class="op" id="1896196">.</span><span class="ident" id="1896197">WriteByte</span><span class="op" id="1896206">(</span><span class="ident" id="1896207">num</span><span class="op" id="1896210">[</span><span class="num" id="1896211">0</span><span class="op" id="1896212">]</span><span class="op" id="1896213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1896218">f</span><span class="op" id="1896219">.</span><span class="ident" id="1896220">wid</span><span class="op" id="1896223">--</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1896228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1896232">f</span><span class="op" id="1896233">.</span><span class="ident" id="1896234">pad</span><span class="op" id="1896237">(</span><span class="ident" id="1896238">num</span><span class="op" id="1896241">[</span><span class="num" id="1896242">1</span><span class="op" id="1896243">:</span><span class="op" id="1896244">]</span><span class="op" id="1896245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1896249">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1896257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1896260">//&nbsp;f.space&nbsp;says&nbsp;to&nbsp;replace&nbsp;a&nbsp;leading&nbsp;+&nbsp;with&nbsp;a&nbsp;space.</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1896314">if</span>&nbsp;<span class="ident" id="1896317">f</span><span class="op" id="1896318">.</span><span class="ident" id="1896319">space</span>&nbsp;<span class="op" id="1896325">&amp;&amp;</span>&nbsp;<span class="ident" id="1896328">num</span><span class="op" id="1896331">[</span><span class="num" id="1896332">0</span><span class="op" id="1896333">]</span>&nbsp;<span class="op" id="1896335">==</span>&nbsp;<span class="string" id="1896338">&#39;+&#39;</span>&nbsp;<span class="op" id="1896342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1896346">num</span><span class="op" id="1896349">[</span><span class="num" id="1896350">0</span><span class="op" id="1896351">]</span>&nbsp;<span class="op" id="1896353">=</span>&nbsp;<span class="string" id="1896355">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1896361">f</span><span class="op" id="1896362">.</span><span class="ident" id="1896363">pad</span><span class="op" id="1896366">(</span><span class="ident" id="1896367">num</span><span class="op" id="1896370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1896374">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1896382">}</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1896385">//&nbsp;Now&nbsp;we&nbsp;know&nbsp;the&nbsp;sign&nbsp;is&nbsp;attached&nbsp;directly&nbsp;to&nbsp;the&nbsp;number,&nbsp;if&nbsp;present&nbsp;at&nbsp;all.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1896465">//&nbsp;We&nbsp;want&nbsp;a&nbsp;sign&nbsp;if&nbsp;asked&nbsp;for,&nbsp;if&nbsp;it&#39;s&nbsp;negative,&nbsp;or&nbsp;if&nbsp;it&#39;s&nbsp;infinity&nbsp;(+Inf&nbsp;vs.&nbsp;-Inf).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1896553">if</span>&nbsp;<span class="ident" id="1896556">f</span><span class="op" id="1896557">.</span><span class="ident" id="1896558">plus</span>&nbsp;<span class="op" id="1896563">||</span>&nbsp;<span class="ident" id="1896566">num</span><span class="op" id="1896569">[</span><span class="num" id="1896570">0</span><span class="op" id="1896571">]</span>&nbsp;<span class="op" id="1896573">==</span>&nbsp;<span class="string" id="1896576">&#39;-&#39;</span>&nbsp;<span class="op" id="1896580">||</span>&nbsp;<span class="ident" id="1896583">math</span><span class="op" id="1896587">.</span><span class="ident" id="1896588">IsInf</span><span class="op" id="1896593">(</span><span class="ident" id="1896594">v</span><span class="op" id="1896595">,</span>&nbsp;<span class="num" id="1896597">0</span><span class="op" id="1896598">)</span>&nbsp;<span class="op" id="1896600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1896604">f</span><span class="op" id="1896605">.</span><span class="ident" id="1896606">pad</span><span class="op" id="1896609">(</span><span class="ident" id="1896610">num</span><span class="op" id="1896613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1896617">return</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1896625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1896628">//&nbsp;No&nbsp;sign&nbsp;to&nbsp;show&nbsp;and&nbsp;the&nbsp;number&nbsp;is&nbsp;positive;&nbsp;just&nbsp;print&nbsp;the&nbsp;unsigned&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1896708">f</span><span class="op" id="1896709">.</span><span class="ident" id="1896710">pad</span><span class="op" id="1896713">(</span><span class="ident" id="1896714">num</span><span class="op" id="1896717">[</span><span class="num" id="1896718">1</span><span class="op" id="1896719">:</span><span class="op" id="1896720">]</span><span class="op" id="1896721">)</span><br>
<span class="lineno"></span><span class="op" id="1896723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="comment" id="1896726">//&nbsp;fmt_e64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23e+12.</span><br>
<span class="lineno"></span><span class="keyword" id="1896778">func</span>&nbsp;<span class="op" id="1896783">(</span><span class="ident" id="1896784">f</span>&nbsp;<span class="op" id="1896786">*</span><span class="ident" id="1896787">fmt</span><span class="op" id="1896790">)</span>&nbsp;<span class="ident" id="1896792">fmt_e64</span><span class="op" id="1896799">(</span><span class="ident" id="1896800">v</span>&nbsp;<span class="builtintype" id="1896802">float64</span><span class="op" id="1896809">)</span>&nbsp;<span class="op" id="1896811">{</span>&nbsp;<span class="ident" id="1896813">f</span><span class="op" id="1896814">.</span><span class="ident" id="1896815">formatFloat</span><span class="op" id="1896826">(</span><span class="ident" id="1896827">v</span><span class="op" id="1896828">,</span>&nbsp;<span class="string" id="1896830">&#39;e&#39;</span><span class="op" id="1896833">,</span>&nbsp;<span class="ident" id="1896835">doPrec</span><span class="op" id="1896841">(</span><span class="ident" id="1896842">f</span><span class="op" id="1896843">,</span>&nbsp;<span class="num" id="1896845">6</span><span class="op" id="1896846">)</span><span class="op" id="1896847">,</span>&nbsp;<span class="num" id="1896849">64</span><span class="op" id="1896851">)</span>&nbsp;<span class="op" id="1896853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1896856">//&nbsp;fmt_E64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23E+12.</span><br>
<span class="lineno"></span><span class="keyword" id="1896908">func</span>&nbsp;<span class="op" id="1896913">(</span><span class="ident" id="1896914">f</span>&nbsp;<span class="op" id="1896916">*</span><span class="ident" id="1896917">fmt</span><span class="op" id="1896920">)</span>&nbsp;<span class="ident" id="1896922">fmt_E64</span><span class="op" id="1896929">(</span><span class="ident" id="1896930">v</span>&nbsp;<span class="builtintype" id="1896932">float64</span><span class="op" id="1896939">)</span>&nbsp;<span class="op" id="1896941">{</span>&nbsp;<span class="ident" id="1896943">f</span><span class="op" id="1896944">.</span><span class="ident" id="1896945">formatFloat</span><span class="op" id="1896956">(</span><span class="ident" id="1896957">v</span><span class="op" id="1896958">,</span>&nbsp;<span class="string" id="1896960">&#39;E&#39;</span><span class="op" id="1896963">,</span>&nbsp;<span class="ident" id="1896965">doPrec</span><span class="op" id="1896971">(</span><span class="ident" id="1896972">f</span><span class="op" id="1896973">,</span>&nbsp;<span class="num" id="1896975">6</span><span class="op" id="1896976">)</span><span class="op" id="1896977">,</span>&nbsp;<span class="num" id="1896979">64</span><span class="op" id="1896981">)</span>&nbsp;<span class="op" id="1896983">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="comment" id="1896986">//&nbsp;fmt_f64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23.</span><br>
<span class="lineno"></span><span class="keyword" id="1897034">func</span>&nbsp;<span class="op" id="1897039">(</span><span class="ident" id="1897040">f</span>&nbsp;<span class="op" id="1897042">*</span><span class="ident" id="1897043">fmt</span><span class="op" id="1897046">)</span>&nbsp;<span class="ident" id="1897048">fmt_f64</span><span class="op" id="1897055">(</span><span class="ident" id="1897056">v</span>&nbsp;<span class="builtintype" id="1897058">float64</span><span class="op" id="1897065">)</span>&nbsp;<span class="op" id="1897067">{</span>&nbsp;<span class="ident" id="1897069">f</span><span class="op" id="1897070">.</span><span class="ident" id="1897071">formatFloat</span><span class="op" id="1897082">(</span><span class="ident" id="1897083">v</span><span class="op" id="1897084">,</span>&nbsp;<span class="string" id="1897086">&#39;f&#39;</span><span class="op" id="1897089">,</span>&nbsp;<span class="ident" id="1897091">doPrec</span><span class="op" id="1897097">(</span><span class="ident" id="1897098">f</span><span class="op" id="1897099">,</span>&nbsp;<span class="num" id="1897101">6</span><span class="op" id="1897102">)</span><span class="op" id="1897103">,</span>&nbsp;<span class="num" id="1897105">64</span><span class="op" id="1897107">)</span>&nbsp;<span class="op" id="1897109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1897112">//&nbsp;fmt_g64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;e&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno">450</span><span class="keyword" id="1897183">func</span>&nbsp;<span class="op" id="1897188">(</span><span class="ident" id="1897189">f</span>&nbsp;<span class="op" id="1897191">*</span><span class="ident" id="1897192">fmt</span><span class="op" id="1897195">)</span>&nbsp;<span class="ident" id="1897197">fmt_g64</span><span class="op" id="1897204">(</span><span class="ident" id="1897205">v</span>&nbsp;<span class="builtintype" id="1897207">float64</span><span class="op" id="1897214">)</span>&nbsp;<span class="op" id="1897216">{</span>&nbsp;<span class="ident" id="1897218">f</span><span class="op" id="1897219">.</span><span class="ident" id="1897220">formatFloat</span><span class="op" id="1897231">(</span><span class="ident" id="1897232">v</span><span class="op" id="1897233">,</span>&nbsp;<span class="string" id="1897235">&#39;g&#39;</span><span class="op" id="1897238">,</span>&nbsp;<span class="ident" id="1897240">doPrec</span><span class="op" id="1897246">(</span><span class="ident" id="1897247">f</span><span class="op" id="1897248">,</span>&nbsp;<span class="op" id="1897250">-</span><span class="num" id="1897251">1</span><span class="op" id="1897252">)</span><span class="op" id="1897253">,</span>&nbsp;<span class="num" id="1897255">64</span><span class="op" id="1897257">)</span>&nbsp;<span class="op" id="1897259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1897262">//&nbsp;fmt_G64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;E&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="1897333">func</span>&nbsp;<span class="op" id="1897338">(</span><span class="ident" id="1897339">f</span>&nbsp;<span class="op" id="1897341">*</span><span class="ident" id="1897342">fmt</span><span class="op" id="1897345">)</span>&nbsp;<span class="ident" id="1897347">fmt_G64</span><span class="op" id="1897354">(</span><span class="ident" id="1897355">v</span>&nbsp;<span class="builtintype" id="1897357">float64</span><span class="op" id="1897364">)</span>&nbsp;<span class="op" id="1897366">{</span>&nbsp;<span class="ident" id="1897368">f</span><span class="op" id="1897369">.</span><span class="ident" id="1897370">formatFloat</span><span class="op" id="1897381">(</span><span class="ident" id="1897382">v</span><span class="op" id="1897383">,</span>&nbsp;<span class="string" id="1897385">&#39;G&#39;</span><span class="op" id="1897388">,</span>&nbsp;<span class="ident" id="1897390">doPrec</span><span class="op" id="1897396">(</span><span class="ident" id="1897397">f</span><span class="op" id="1897398">,</span>&nbsp;<span class="op" id="1897400">-</span><span class="num" id="1897401">1</span><span class="op" id="1897402">)</span><span class="op" id="1897403">,</span>&nbsp;<span class="num" id="1897405">64</span><span class="op" id="1897407">)</span>&nbsp;<span class="op" id="1897409">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="comment" id="1897412">//&nbsp;fmt_fb64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-123p3&nbsp;(exponent&nbsp;is&nbsp;power&nbsp;of&nbsp;2).</span><br>
<span class="lineno"></span><span class="keyword" id="1897487">func</span>&nbsp;<span class="op" id="1897492">(</span><span class="ident" id="1897493">f</span>&nbsp;<span class="op" id="1897495">*</span><span class="ident" id="1897496">fmt</span><span class="op" id="1897499">)</span>&nbsp;<span class="ident" id="1897501">fmt_fb64</span><span class="op" id="1897509">(</span><span class="ident" id="1897510">v</span>&nbsp;<span class="builtintype" id="1897512">float64</span><span class="op" id="1897519">)</span>&nbsp;<span class="op" id="1897521">{</span>&nbsp;<span class="ident" id="1897523">f</span><span class="op" id="1897524">.</span><span class="ident" id="1897525">formatFloat</span><span class="op" id="1897536">(</span><span class="ident" id="1897537">v</span><span class="op" id="1897538">,</span>&nbsp;<span class="string" id="1897540">&#39;b&#39;</span><span class="op" id="1897543">,</span>&nbsp;<span class="num" id="1897545">0</span><span class="op" id="1897546">,</span>&nbsp;<span class="num" id="1897548">64</span><span class="op" id="1897550">)</span>&nbsp;<span class="op" id="1897552">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1897555">//&nbsp;float32</span><br>
<span class="lineno"></span><span class="comment" id="1897566">//&nbsp;cannot&nbsp;defer&nbsp;to&nbsp;float64&nbsp;versions</span><br>
<span class="lineno">460</span><span class="comment" id="1897602">//&nbsp;because&nbsp;it&nbsp;will&nbsp;get&nbsp;rounding&nbsp;wrong&nbsp;in&nbsp;corner&nbsp;cases.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1897658">//&nbsp;fmt_e32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23e+12.</span><br>
<span class="lineno"></span><span class="keyword" id="1897710">func</span>&nbsp;<span class="op" id="1897715">(</span><span class="ident" id="1897716">f</span>&nbsp;<span class="op" id="1897718">*</span><span class="ident" id="1897719">fmt</span><span class="op" id="1897722">)</span>&nbsp;<span class="ident" id="1897724">fmt_e32</span><span class="op" id="1897731">(</span><span class="ident" id="1897732">v</span>&nbsp;<span class="builtintype" id="1897734">float32</span><span class="op" id="1897741">)</span>&nbsp;<span class="op" id="1897743">{</span>&nbsp;<span class="ident" id="1897745">f</span><span class="op" id="1897746">.</span><span class="ident" id="1897747">formatFloat</span><span class="op" id="1897758">(</span><span class="builtintype" id="1897759">float64</span><span class="op" id="1897766">(</span><span class="ident" id="1897767">v</span><span class="op" id="1897768">)</span><span class="op" id="1897769">,</span>&nbsp;<span class="string" id="1897771">&#39;e&#39;</span><span class="op" id="1897774">,</span>&nbsp;<span class="ident" id="1897776">doPrec</span><span class="op" id="1897782">(</span><span class="ident" id="1897783">f</span><span class="op" id="1897784">,</span>&nbsp;<span class="num" id="1897786">6</span><span class="op" id="1897787">)</span><span class="op" id="1897788">,</span>&nbsp;<span class="num" id="1897790">32</span><span class="op" id="1897792">)</span>&nbsp;<span class="op" id="1897794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span><span class="comment" id="1897797">//&nbsp;fmt_E32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23E+12.</span><br>
<span class="lineno"></span><span class="keyword" id="1897849">func</span>&nbsp;<span class="op" id="1897854">(</span><span class="ident" id="1897855">f</span>&nbsp;<span class="op" id="1897857">*</span><span class="ident" id="1897858">fmt</span><span class="op" id="1897861">)</span>&nbsp;<span class="ident" id="1897863">fmt_E32</span><span class="op" id="1897870">(</span><span class="ident" id="1897871">v</span>&nbsp;<span class="builtintype" id="1897873">float32</span><span class="op" id="1897880">)</span>&nbsp;<span class="op" id="1897882">{</span>&nbsp;<span class="ident" id="1897884">f</span><span class="op" id="1897885">.</span><span class="ident" id="1897886">formatFloat</span><span class="op" id="1897897">(</span><span class="builtintype" id="1897898">float64</span><span class="op" id="1897905">(</span><span class="ident" id="1897906">v</span><span class="op" id="1897907">)</span><span class="op" id="1897908">,</span>&nbsp;<span class="string" id="1897910">&#39;E&#39;</span><span class="op" id="1897913">,</span>&nbsp;<span class="ident" id="1897915">doPrec</span><span class="op" id="1897921">(</span><span class="ident" id="1897922">f</span><span class="op" id="1897923">,</span>&nbsp;<span class="num" id="1897925">6</span><span class="op" id="1897926">)</span><span class="op" id="1897927">,</span>&nbsp;<span class="num" id="1897929">32</span><span class="op" id="1897931">)</span>&nbsp;<span class="op" id="1897933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1897936">//&nbsp;fmt_f32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23.</span><br>
<span class="lineno"></span><span class="keyword" id="1897984">func</span>&nbsp;<span class="op" id="1897989">(</span><span class="ident" id="1897990">f</span>&nbsp;<span class="op" id="1897992">*</span><span class="ident" id="1897993">fmt</span><span class="op" id="1897996">)</span>&nbsp;<span class="ident" id="1897998">fmt_f32</span><span class="op" id="1898005">(</span><span class="ident" id="1898006">v</span>&nbsp;<span class="builtintype" id="1898008">float32</span><span class="op" id="1898015">)</span>&nbsp;<span class="op" id="1898017">{</span>&nbsp;<span class="ident" id="1898019">f</span><span class="op" id="1898020">.</span><span class="ident" id="1898021">formatFloat</span><span class="op" id="1898032">(</span><span class="builtintype" id="1898033">float64</span><span class="op" id="1898040">(</span><span class="ident" id="1898041">v</span><span class="op" id="1898042">)</span><span class="op" id="1898043">,</span>&nbsp;<span class="string" id="1898045">&#39;f&#39;</span><span class="op" id="1898048">,</span>&nbsp;<span class="ident" id="1898050">doPrec</span><span class="op" id="1898056">(</span><span class="ident" id="1898057">f</span><span class="op" id="1898058">,</span>&nbsp;<span class="num" id="1898060">6</span><span class="op" id="1898061">)</span><span class="op" id="1898062">,</span>&nbsp;<span class="num" id="1898064">32</span><span class="op" id="1898066">)</span>&nbsp;<span class="op" id="1898068">}</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span><span class="comment" id="1898071">//&nbsp;fmt_g32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;e&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="1898142">func</span>&nbsp;<span class="op" id="1898147">(</span><span class="ident" id="1898148">f</span>&nbsp;<span class="op" id="1898150">*</span><span class="ident" id="1898151">fmt</span><span class="op" id="1898154">)</span>&nbsp;<span class="ident" id="1898156">fmt_g32</span><span class="op" id="1898163">(</span><span class="ident" id="1898164">v</span>&nbsp;<span class="builtintype" id="1898166">float32</span><span class="op" id="1898173">)</span>&nbsp;<span class="op" id="1898175">{</span>&nbsp;<span class="ident" id="1898177">f</span><span class="op" id="1898178">.</span><span class="ident" id="1898179">formatFloat</span><span class="op" id="1898190">(</span><span class="builtintype" id="1898191">float64</span><span class="op" id="1898198">(</span><span class="ident" id="1898199">v</span><span class="op" id="1898200">)</span><span class="op" id="1898201">,</span>&nbsp;<span class="string" id="1898203">&#39;g&#39;</span><span class="op" id="1898206">,</span>&nbsp;<span class="ident" id="1898208">doPrec</span><span class="op" id="1898214">(</span><span class="ident" id="1898215">f</span><span class="op" id="1898216">,</span>&nbsp;<span class="op" id="1898218">-</span><span class="num" id="1898219">1</span><span class="op" id="1898220">)</span><span class="op" id="1898221">,</span>&nbsp;<span class="num" id="1898223">32</span><span class="op" id="1898225">)</span>&nbsp;<span class="op" id="1898227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1898230">//&nbsp;fmt_G32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;E&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno">475</span><span class="keyword" id="1898301">func</span>&nbsp;<span class="op" id="1898306">(</span><span class="ident" id="1898307">f</span>&nbsp;<span class="op" id="1898309">*</span><span class="ident" id="1898310">fmt</span><span class="op" id="1898313">)</span>&nbsp;<span class="ident" id="1898315">fmt_G32</span><span class="op" id="1898322">(</span><span class="ident" id="1898323">v</span>&nbsp;<span class="builtintype" id="1898325">float32</span><span class="op" id="1898332">)</span>&nbsp;<span class="op" id="1898334">{</span>&nbsp;<span class="ident" id="1898336">f</span><span class="op" id="1898337">.</span><span class="ident" id="1898338">formatFloat</span><span class="op" id="1898349">(</span><span class="builtintype" id="1898350">float64</span><span class="op" id="1898357">(</span><span class="ident" id="1898358">v</span><span class="op" id="1898359">)</span><span class="op" id="1898360">,</span>&nbsp;<span class="string" id="1898362">&#39;G&#39;</span><span class="op" id="1898365">,</span>&nbsp;<span class="ident" id="1898367">doPrec</span><span class="op" id="1898373">(</span><span class="ident" id="1898374">f</span><span class="op" id="1898375">,</span>&nbsp;<span class="op" id="1898377">-</span><span class="num" id="1898378">1</span><span class="op" id="1898379">)</span><span class="op" id="1898380">,</span>&nbsp;<span class="num" id="1898382">32</span><span class="op" id="1898384">)</span>&nbsp;<span class="op" id="1898386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1898389">//&nbsp;fmt_fb32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-123p3&nbsp;(exponent&nbsp;is&nbsp;power&nbsp;of&nbsp;2).</span><br>
<span class="lineno"></span><span class="keyword" id="1898464">func</span>&nbsp;<span class="op" id="1898469">(</span><span class="ident" id="1898470">f</span>&nbsp;<span class="op" id="1898472">*</span><span class="ident" id="1898473">fmt</span><span class="op" id="1898476">)</span>&nbsp;<span class="ident" id="1898478">fmt_fb32</span><span class="op" id="1898486">(</span><span class="ident" id="1898487">v</span>&nbsp;<span class="builtintype" id="1898489">float32</span><span class="op" id="1898496">)</span>&nbsp;<span class="op" id="1898498">{</span>&nbsp;<span class="ident" id="1898500">f</span><span class="op" id="1898501">.</span><span class="ident" id="1898502">formatFloat</span><span class="op" id="1898513">(</span><span class="builtintype" id="1898514">float64</span><span class="op" id="1898521">(</span><span class="ident" id="1898522">v</span><span class="op" id="1898523">)</span><span class="op" id="1898524">,</span>&nbsp;<span class="string" id="1898526">&#39;b&#39;</span><span class="op" id="1898529">,</span>&nbsp;<span class="num" id="1898531">0</span><span class="op" id="1898532">,</span>&nbsp;<span class="num" id="1898534">32</span><span class="op" id="1898536">)</span>&nbsp;<span class="op" id="1898538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="comment" id="1898541">//&nbsp;fmt_c64&nbsp;formats&nbsp;a&nbsp;complex64&nbsp;according&nbsp;to&nbsp;the&nbsp;verb.</span><br>
<span class="lineno"></span><span class="keyword" id="1898595">func</span>&nbsp;<span class="op" id="1898600">(</span><span class="ident" id="1898601">f</span>&nbsp;<span class="op" id="1898603">*</span><span class="ident" id="1898604">fmt</span><span class="op" id="1898607">)</span>&nbsp;<span class="ident" id="1898609">fmt_c64</span><span class="op" id="1898616">(</span><span class="ident" id="1898617">v</span>&nbsp;<span class="builtintype" id="1898619">complex64</span><span class="op" id="1898628">,</span>&nbsp;<span class="ident" id="1898630">verb</span>&nbsp;<span class="builtintype" id="1898635">rune</span><span class="op" id="1898639">)</span>&nbsp;<span class="op" id="1898641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1898644">f</span><span class="op" id="1898645">.</span><span class="ident" id="1898646">fmt_complex</span><span class="op" id="1898657">(</span><span class="builtintype" id="1898658">float64</span><span class="op" id="1898665">(</span><span class="builtinfunc" id="1898666">real</span><span class="op" id="1898670">(</span><span class="ident" id="1898671">v</span><span class="op" id="1898672">)</span><span class="op" id="1898673">)</span><span class="op" id="1898674">,</span>&nbsp;<span class="builtintype" id="1898676">float64</span><span class="op" id="1898683">(</span><span class="builtinfunc" id="1898684">imag</span><span class="op" id="1898688">(</span><span class="ident" id="1898689">v</span><span class="op" id="1898690">)</span><span class="op" id="1898691">)</span><span class="op" id="1898692">,</span>&nbsp;<span class="num" id="1898694">32</span><span class="op" id="1898696">,</span>&nbsp;<span class="ident" id="1898698">verb</span><span class="op" id="1898702">)</span><br>
<span class="lineno"></span><span class="op" id="1898704">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="comment" id="1898707">//&nbsp;fmt_c128&nbsp;formats&nbsp;a&nbsp;complex128&nbsp;according&nbsp;to&nbsp;the&nbsp;verb.</span><br>
<span class="lineno"></span><span class="keyword" id="1898763">func</span>&nbsp;<span class="op" id="1898768">(</span><span class="ident" id="1898769">f</span>&nbsp;<span class="op" id="1898771">*</span><span class="ident" id="1898772">fmt</span><span class="op" id="1898775">)</span>&nbsp;<span class="ident" id="1898777">fmt_c128</span><span class="op" id="1898785">(</span><span class="ident" id="1898786">v</span>&nbsp;<span class="builtintype" id="1898788">complex128</span><span class="op" id="1898798">,</span>&nbsp;<span class="ident" id="1898800">verb</span>&nbsp;<span class="builtintype" id="1898805">rune</span><span class="op" id="1898809">)</span>&nbsp;<span class="op" id="1898811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1898814">f</span><span class="op" id="1898815">.</span><span class="ident" id="1898816">fmt_complex</span><span class="op" id="1898827">(</span><span class="builtinfunc" id="1898828">real</span><span class="op" id="1898832">(</span><span class="ident" id="1898833">v</span><span class="op" id="1898834">)</span><span class="op" id="1898835">,</span>&nbsp;<span class="builtinfunc" id="1898837">imag</span><span class="op" id="1898841">(</span><span class="ident" id="1898842">v</span><span class="op" id="1898843">)</span><span class="op" id="1898844">,</span>&nbsp;<span class="num" id="1898846">64</span><span class="op" id="1898848">,</span>&nbsp;<span class="ident" id="1898850">verb</span><span class="op" id="1898854">)</span><br>
<span class="lineno"></span><span class="op" id="1898856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">490</span><span class="comment" id="1898859">//&nbsp;fmt_complex&nbsp;formats&nbsp;a&nbsp;complex&nbsp;number&nbsp;as&nbsp;(r+ji).</span><br>
<span class="lineno"></span><span class="keyword" id="1898910">func</span>&nbsp;<span class="op" id="1898915">(</span><span class="ident" id="1898916">f</span>&nbsp;<span class="op" id="1898918">*</span><span class="ident" id="1898919">fmt</span><span class="op" id="1898922">)</span>&nbsp;<span class="ident" id="1898924">fmt_complex</span><span class="op" id="1898935">(</span><span class="ident" id="1898936">r</span><span class="op" id="1898937">,</span>&nbsp;<span class="ident" id="1898939">j</span>&nbsp;<span class="builtintype" id="1898941">float64</span><span class="op" id="1898948">,</span>&nbsp;<span class="ident" id="1898950">size</span>&nbsp;<span class="builtintype" id="1898955">int</span><span class="op" id="1898958">,</span>&nbsp;<span class="ident" id="1898960">verb</span>&nbsp;<span class="builtintype" id="1898965">rune</span><span class="op" id="1898969">)</span>&nbsp;<span class="op" id="1898971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1898974">f</span><span class="op" id="1898975">.</span><span class="ident" id="1898976">buf</span><span class="op" id="1898979">.</span><span class="ident" id="1898980">WriteByte</span><span class="op" id="1898989">(</span><span class="string" id="1898990">&#39;(&#39;</span><span class="op" id="1898993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1898996">oldPlus</span>&nbsp;<span class="op" id="1899004">:=</span>&nbsp;<span class="ident" id="1899007">f</span><span class="op" id="1899008">.</span><span class="ident" id="1899009">plus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1899015">oldSpace</span>&nbsp;<span class="op" id="1899024">:=</span>&nbsp;<span class="ident" id="1899027">f</span><span class="op" id="1899028">.</span><span class="ident" id="1899029">space</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1899036">oldWid</span>&nbsp;<span class="op" id="1899043">:=</span>&nbsp;<span class="ident" id="1899046">f</span><span class="op" id="1899047">.</span><span class="ident" id="1899048">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1899053">for</span>&nbsp;<span class="ident" id="1899057">i</span>&nbsp;<span class="op" id="1899059">:=</span>&nbsp;<span class="num" id="1899062">0</span><span class="op" id="1899063">;</span>&nbsp;<span class="op" id="1899065">;</span>&nbsp;<span class="ident" id="1899067">i</span><span class="op" id="1899068">++</span>&nbsp;<span class="op" id="1899071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1899075">switch</span>&nbsp;<span class="ident" id="1899082">verb</span>&nbsp;<span class="op" id="1899087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1899091">case</span>&nbsp;<span class="string" id="1899096">&#39;b&#39;</span><span class="op" id="1899099">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1899104">f</span><span class="op" id="1899105">.</span><span class="ident" id="1899106">formatFloat</span><span class="op" id="1899117">(</span><span class="ident" id="1899118">r</span><span class="op" id="1899119">,</span>&nbsp;<span class="string" id="1899121">&#39;b&#39;</span><span class="op" id="1899124">,</span>&nbsp;<span class="num" id="1899126">0</span><span class="op" id="1899127">,</span>&nbsp;<span class="ident" id="1899129">size</span><span class="op" id="1899133">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1899137">case</span>&nbsp;<span class="string" id="1899142">&#39;e&#39;</span><span class="op" id="1899145">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1899150">f</span><span class="op" id="1899151">.</span><span class="ident" id="1899152">formatFloat</span><span class="op" id="1899163">(</span><span class="ident" id="1899164">r</span><span class="op" id="1899165">,</span>&nbsp;<span class="string" id="1899167">&#39;e&#39;</span><span class="op" id="1899170">,</span>&nbsp;<span class="ident" id="1899172">doPrec</span><span class="op" id="1899178">(</span><span class="ident" id="1899179">f</span><span class="op" id="1899180">,</span>&nbsp;<span class="num" id="1899182">6</span><span class="op" id="1899183">)</span><span class="op" id="1899184">,</span>&nbsp;<span class="ident" id="1899186">size</span><span class="op" id="1899190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1899194">case</span>&nbsp;<span class="string" id="1899199">&#39;E&#39;</span><span class="op" id="1899202">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1899207">f</span><span class="op" id="1899208">.</span><span class="ident" id="1899209">formatFloat</span><span class="op" id="1899220">(</span><span class="ident" id="1899221">r</span><span class="op" id="1899222">,</span>&nbsp;<span class="string" id="1899224">&#39;E&#39;</span><span class="op" id="1899227">,</span>&nbsp;<span class="ident" id="1899229">doPrec</span><span class="op" id="1899235">(</span><span class="ident" id="1899236">f</span><span class="op" id="1899237">,</span>&nbsp;<span class="num" id="1899239">6</span><span class="op" id="1899240">)</span><span class="op" id="1899241">,</span>&nbsp;<span class="ident" id="1899243">size</span><span class="op" id="1899247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1899251">case</span>&nbsp;<span class="string" id="1899256">&#39;f&#39;</span><span class="op" id="1899259">,</span>&nbsp;<span class="string" id="1899261">&#39;F&#39;</span><span class="op" id="1899264">:</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1899269">f</span><span class="op" id="1899270">.</span><span class="ident" id="1899271">formatFloat</span><span class="op" id="1899282">(</span><span class="ident" id="1899283">r</span><span class="op" id="1899284">,</span>&nbsp;<span class="string" id="1899286">&#39;f&#39;</span><span class="op" id="1899289">,</span>&nbsp;<span class="ident" id="1899291">doPrec</span><span class="op" id="1899297">(</span><span class="ident" id="1899298">f</span><span class="op" id="1899299">,</span>&nbsp;<span class="num" id="1899301">6</span><span class="op" id="1899302">)</span><span class="op" id="1899303">,</span>&nbsp;<span class="ident" id="1899305">size</span><span class="op" id="1899309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1899313">case</span>&nbsp;<span class="string" id="1899318">&#39;g&#39;</span><span class="op" id="1899321">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1899326">f</span><span class="op" id="1899327">.</span><span class="ident" id="1899328">formatFloat</span><span class="op" id="1899339">(</span><span class="ident" id="1899340">r</span><span class="op" id="1899341">,</span>&nbsp;<span class="string" id="1899343">&#39;g&#39;</span><span class="op" id="1899346">,</span>&nbsp;<span class="ident" id="1899348">doPrec</span><span class="op" id="1899354">(</span><span class="ident" id="1899355">f</span><span class="op" id="1899356">,</span>&nbsp;<span class="op" id="1899358">-</span><span class="num" id="1899359">1</span><span class="op" id="1899360">)</span><span class="op" id="1899361">,</span>&nbsp;<span class="ident" id="1899363">size</span><span class="op" id="1899367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1899371">case</span>&nbsp;<span class="string" id="1899376">&#39;G&#39;</span><span class="op" id="1899379">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1899384">f</span><span class="op" id="1899385">.</span><span class="ident" id="1899386">formatFloat</span><span class="op" id="1899397">(</span><span class="ident" id="1899398">r</span><span class="op" id="1899399">,</span>&nbsp;<span class="string" id="1899401">&#39;G&#39;</span><span class="op" id="1899404">,</span>&nbsp;<span class="ident" id="1899406">doPrec</span><span class="op" id="1899412">(</span><span class="ident" id="1899413">f</span><span class="op" id="1899414">,</span>&nbsp;<span class="op" id="1899416">-</span><span class="num" id="1899417">1</span><span class="op" id="1899418">)</span><span class="op" id="1899419">,</span>&nbsp;<span class="ident" id="1899421">size</span><span class="op" id="1899425">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1899429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1899433">if</span>&nbsp;<span class="ident" id="1899436">i</span>&nbsp;<span class="op" id="1899438">!=</span>&nbsp;<span class="num" id="1899441">0</span>&nbsp;<span class="op" id="1899443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1899448">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1899456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1899460">//&nbsp;Imaginary&nbsp;part&nbsp;always&nbsp;has&nbsp;a&nbsp;sign.</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1899499">f</span><span class="op" id="1899500">.</span><span class="ident" id="1899501">plus</span>&nbsp;<span class="op" id="1899506">=</span>&nbsp;<span class="ident" id="1899508">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1899515">f</span><span class="op" id="1899516">.</span><span class="ident" id="1899517">space</span>&nbsp;<span class="op" id="1899523">=</span>&nbsp;<span class="ident" id="1899525">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1899533">f</span><span class="op" id="1899534">.</span><span class="ident" id="1899535">wid</span>&nbsp;<span class="op" id="1899539">=</span>&nbsp;<span class="ident" id="1899541">oldWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1899550">r</span>&nbsp;<span class="op" id="1899552">=</span>&nbsp;<span class="ident" id="1899554">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1899557">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1899560">f</span><span class="op" id="1899561">.</span><span class="ident" id="1899562">space</span>&nbsp;<span class="op" id="1899568">=</span>&nbsp;<span class="ident" id="1899570">oldSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1899580">f</span><span class="op" id="1899581">.</span><span class="ident" id="1899582">plus</span>&nbsp;<span class="op" id="1899587">=</span>&nbsp;<span class="ident" id="1899589">oldPlus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1899598">f</span><span class="op" id="1899599">.</span><span class="ident" id="1899600">wid</span>&nbsp;<span class="op" id="1899604">=</span>&nbsp;<span class="ident" id="1899606">oldWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1899614">f</span><span class="op" id="1899615">.</span><span class="ident" id="1899616">buf</span><span class="op" id="1899619">.</span><span class="ident" id="1899620">Write</span><span class="op" id="1899625">(</span><span class="ident" id="1899626">irparenBytes</span><span class="op" id="1899638">)</span><br>
<span class="lineno"></span><span class="op" id="1899640">}</span>
</div>
</body>
</html>
