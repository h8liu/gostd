<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template</h2>
<ul>
<li><a href="/gostd/text/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/text/template/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/text/template/examplefiles_test.go.html">examplefiles_test.go</a></li>
<li><a href="/gostd/text/template/examplefunc_test.go.html">examplefunc_test.go</a></li>
<li><a href="/gostd/text/template/exec.go.html" class="current">exec.go</a></li>
<li><a href="/gostd/text/template/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/text/template/funcs.go.html">funcs.go</a></li>
<li><a href="/gostd/text/template/helper.go.html">helper.go</a></li>
<li><a href="/gostd/text/template/multi_test.go.html">multi_test.go</a></li>
<li><a href="/gostd/text/template/template.go.html">template.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3210486">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3210541">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3210595">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3210646">package</span>&nbsp;<span class="ident" id="3210654">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3210664">import</span>&nbsp;<span class="op" id="3210671">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3210674">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3210683">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3210690">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3210696">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3210707">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3210718">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3210726">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3210737">&#34;text/template/parse&#34;</span><br>
<span class="lineno"></span><span class="op" id="3210759">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3210762">//&nbsp;state&nbsp;represents&nbsp;the&nbsp;state&nbsp;of&nbsp;an&nbsp;execution.&nbsp;It&#39;s&nbsp;not&nbsp;part&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3210830">//&nbsp;template&nbsp;so&nbsp;that&nbsp;multiple&nbsp;executions&nbsp;of&nbsp;the&nbsp;same&nbsp;template</span><br>
<span class="lineno">20</span><span class="comment" id="3210891">//&nbsp;can&nbsp;execute&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="3210919">type</span>&nbsp;<span class="ident" id="3210924">state</span>&nbsp;<span class="keyword" id="3210930">struct</span>&nbsp;<span class="op" id="3210937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3210940">tmpl</span>&nbsp;<span class="op" id="3210945">*</span><span class="ident" id="3210946">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3210956">wr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3210961">io</span><span class="op" id="3210963">.</span><span class="ident" id="3210964">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3210972">node</span>&nbsp;<span class="ident" id="3210977">parse</span><span class="op" id="3210982">.</span><span class="ident" id="3210983">Node</span>&nbsp;<span class="comment" id="3210988">//&nbsp;current&nbsp;node,&nbsp;for&nbsp;errors</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3211017">vars</span>&nbsp;<span class="op" id="3211022">[</span><span class="op" id="3211023">]</span><span class="ident" id="3211024">variable</span>&nbsp;<span class="comment" id="3211033">//&nbsp;push-down&nbsp;stack&nbsp;of&nbsp;variable&nbsp;values.</span><br>
<span class="lineno"></span><span class="op" id="3211072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3211075">//&nbsp;variable&nbsp;holds&nbsp;the&nbsp;dynamic&nbsp;value&nbsp;of&nbsp;a&nbsp;variable&nbsp;such&nbsp;as&nbsp;$,&nbsp;$x&nbsp;etc.</span><br>
<span class="lineno"></span><span class="keyword" id="3211144">type</span>&nbsp;<span class="ident" id="3211149">variable</span>&nbsp;<span class="keyword" id="3211158">struct</span>&nbsp;<span class="op" id="3211165">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3211168">name</span>&nbsp;&nbsp;<span class="builtintype" id="3211174">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3211182">value</span>&nbsp;<span class="ident" id="3211188">reflect</span><span class="op" id="3211195">.</span><span class="ident" id="3211196">Value</span><br>
<span class="lineno"></span><span class="op" id="3211202">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3211205">//&nbsp;push&nbsp;pushes&nbsp;a&nbsp;new&nbsp;variable&nbsp;on&nbsp;the&nbsp;stack.</span><br>
<span class="lineno">35</span><span class="keyword" id="3211249">func</span>&nbsp;<span class="op" id="3211254">(</span><span class="ident" id="3211255">s</span>&nbsp;<span class="op" id="3211257">*</span><span class="ident" id="3211258">state</span><span class="op" id="3211263">)</span>&nbsp;<span class="ident" id="3211265">push</span><span class="op" id="3211269">(</span><span class="ident" id="3211270">name</span>&nbsp;<span class="builtintype" id="3211275">string</span><span class="op" id="3211281">,</span>&nbsp;<span class="ident" id="3211283">value</span>&nbsp;<span class="ident" id="3211289">reflect</span><span class="op" id="3211296">.</span><span class="ident" id="3211297">Value</span><span class="op" id="3211302">)</span>&nbsp;<span class="op" id="3211304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3211307">s</span><span class="op" id="3211308">.</span><span class="ident" id="3211309">vars</span>&nbsp;<span class="op" id="3211314">=</span>&nbsp;<span class="builtinfunc" id="3211316">append</span><span class="op" id="3211322">(</span><span class="ident" id="3211323">s</span><span class="op" id="3211324">.</span><span class="ident" id="3211325">vars</span><span class="op" id="3211329">,</span>&nbsp;<span class="ident" id="3211331">variable</span><span class="op" id="3211339">{</span><span class="ident" id="3211340">name</span><span class="op" id="3211344">,</span>&nbsp;<span class="ident" id="3211346">value</span><span class="op" id="3211351">}</span><span class="op" id="3211352">)</span><br>
<span class="lineno"></span><span class="op" id="3211354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3211357">//&nbsp;mark&nbsp;returns&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;variable&nbsp;stack.</span><br>
<span class="lineno">40</span><span class="keyword" id="3211407">func</span>&nbsp;<span class="op" id="3211412">(</span><span class="ident" id="3211413">s</span>&nbsp;<span class="op" id="3211415">*</span><span class="ident" id="3211416">state</span><span class="op" id="3211421">)</span>&nbsp;<span class="ident" id="3211423">mark</span><span class="op" id="3211427">(</span><span class="op" id="3211428">)</span>&nbsp;<span class="builtintype" id="3211430">int</span>&nbsp;<span class="op" id="3211434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211437">return</span>&nbsp;<span class="builtinfunc" id="3211444">len</span><span class="op" id="3211447">(</span><span class="ident" id="3211448">s</span><span class="op" id="3211449">.</span><span class="ident" id="3211450">vars</span><span class="op" id="3211454">)</span><br>
<span class="lineno"></span><span class="op" id="3211456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3211459">//&nbsp;pop&nbsp;pops&nbsp;the&nbsp;variable&nbsp;stack&nbsp;up&nbsp;to&nbsp;the&nbsp;mark.</span><br>
<span class="lineno">45</span><span class="keyword" id="3211506">func</span>&nbsp;<span class="op" id="3211511">(</span><span class="ident" id="3211512">s</span>&nbsp;<span class="op" id="3211514">*</span><span class="ident" id="3211515">state</span><span class="op" id="3211520">)</span>&nbsp;<span class="ident" id="3211522">pop</span><span class="op" id="3211525">(</span><span class="ident" id="3211526">mark</span>&nbsp;<span class="builtintype" id="3211531">int</span><span class="op" id="3211534">)</span>&nbsp;<span class="op" id="3211536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3211539">s</span><span class="op" id="3211540">.</span><span class="ident" id="3211541">vars</span>&nbsp;<span class="op" id="3211546">=</span>&nbsp;<span class="ident" id="3211548">s</span><span class="op" id="3211549">.</span><span class="ident" id="3211550">vars</span><span class="op" id="3211554">[</span><span class="num" id="3211555">0</span><span class="op" id="3211556">:</span><span class="ident" id="3211557">mark</span><span class="op" id="3211561">]</span><br>
<span class="lineno"></span><span class="op" id="3211563">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3211566">//&nbsp;setVar&nbsp;overwrites&nbsp;the&nbsp;top-nth&nbsp;variable&nbsp;on&nbsp;the&nbsp;stack.&nbsp;Used&nbsp;by&nbsp;range&nbsp;iterations.</span><br>
<span class="lineno">50</span><span class="keyword" id="3211648">func</span>&nbsp;<span class="op" id="3211653">(</span><span class="ident" id="3211654">s</span>&nbsp;<span class="op" id="3211656">*</span><span class="ident" id="3211657">state</span><span class="op" id="3211662">)</span>&nbsp;<span class="ident" id="3211664">setVar</span><span class="op" id="3211670">(</span><span class="ident" id="3211671">n</span>&nbsp;<span class="builtintype" id="3211673">int</span><span class="op" id="3211676">,</span>&nbsp;<span class="ident" id="3211678">value</span>&nbsp;<span class="ident" id="3211684">reflect</span><span class="op" id="3211691">.</span><span class="ident" id="3211692">Value</span><span class="op" id="3211697">)</span>&nbsp;<span class="op" id="3211699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3211702">s</span><span class="op" id="3211703">.</span><span class="ident" id="3211704">vars</span><span class="op" id="3211708">[</span><span class="builtinfunc" id="3211709">len</span><span class="op" id="3211712">(</span><span class="ident" id="3211713">s</span><span class="op" id="3211714">.</span><span class="ident" id="3211715">vars</span><span class="op" id="3211719">)</span><span class="op" id="3211720">-</span><span class="ident" id="3211721">n</span><span class="op" id="3211722">]</span><span class="op" id="3211723">.</span><span class="ident" id="3211724">value</span>&nbsp;<span class="op" id="3211730">=</span>&nbsp;<span class="ident" id="3211732">value</span><br>
<span class="lineno"></span><span class="op" id="3211738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3211741">//&nbsp;varValue&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;named&nbsp;variable.</span><br>
<span class="lineno">55</span><span class="keyword" id="3211794">func</span>&nbsp;<span class="op" id="3211799">(</span><span class="ident" id="3211800">s</span>&nbsp;<span class="op" id="3211802">*</span><span class="ident" id="3211803">state</span><span class="op" id="3211808">)</span>&nbsp;<span class="ident" id="3211810">varValue</span><span class="op" id="3211818">(</span><span class="ident" id="3211819">name</span>&nbsp;<span class="builtintype" id="3211824">string</span><span class="op" id="3211830">)</span>&nbsp;<span class="ident" id="3211832">reflect</span><span class="op" id="3211839">.</span><span class="ident" id="3211840">Value</span>&nbsp;<span class="op" id="3211846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211849">for</span>&nbsp;<span class="ident" id="3211853">i</span>&nbsp;<span class="op" id="3211855">:=</span>&nbsp;<span class="ident" id="3211858">s</span><span class="op" id="3211859">.</span><span class="ident" id="3211860">mark</span><span class="op" id="3211864">(</span><span class="op" id="3211865">)</span>&nbsp;<span class="op" id="3211867">-</span>&nbsp;<span class="num" id="3211869">1</span><span class="op" id="3211870">;</span>&nbsp;<span class="ident" id="3211872">i</span>&nbsp;<span class="op" id="3211874">&gt;=</span>&nbsp;<span class="num" id="3211877">0</span><span class="op" id="3211878">;</span>&nbsp;<span class="ident" id="3211880">i</span><span class="op" id="3211881">--</span>&nbsp;<span class="op" id="3211884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211888">if</span>&nbsp;<span class="ident" id="3211891">s</span><span class="op" id="3211892">.</span><span class="ident" id="3211893">vars</span><span class="op" id="3211897">[</span><span class="ident" id="3211898">i</span><span class="op" id="3211899">]</span><span class="op" id="3211900">.</span><span class="ident" id="3211901">name</span>&nbsp;<span class="op" id="3211906">==</span>&nbsp;<span class="ident" id="3211909">name</span>&nbsp;<span class="op" id="3211914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211919">return</span>&nbsp;<span class="ident" id="3211926">s</span><span class="op" id="3211927">.</span><span class="ident" id="3211928">vars</span><span class="op" id="3211932">[</span><span class="ident" id="3211933">i</span><span class="op" id="3211934">]</span><span class="op" id="3211935">.</span><span class="ident" id="3211936">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3211944">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3211947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3211950">s</span><span class="op" id="3211951">.</span><span class="ident" id="3211952">errorf</span><span class="op" id="3211958">(</span><span class="string" id="3211959">&#34;undefined&nbsp;variable:&nbsp;%s&#34;</span><span class="op" id="3211983">,</span>&nbsp;<span class="ident" id="3211985">name</span><span class="op" id="3211989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3211992">return</span>&nbsp;<span class="ident" id="3211999">zero</span><br>
<span class="lineno"></span><span class="op" id="3212004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="3212007">var</span>&nbsp;<span class="ident" id="3212011">zero</span>&nbsp;<span class="ident" id="3212016">reflect</span><span class="op" id="3212023">.</span><span class="ident" id="3212024">Value</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3212031">//&nbsp;at&nbsp;marks&nbsp;the&nbsp;state&nbsp;to&nbsp;be&nbsp;on&nbsp;node&nbsp;n,&nbsp;for&nbsp;error&nbsp;reporting.</span><br>
<span class="lineno"></span><span class="keyword" id="3212091">func</span>&nbsp;<span class="op" id="3212096">(</span><span class="ident" id="3212097">s</span>&nbsp;<span class="op" id="3212099">*</span><span class="ident" id="3212100">state</span><span class="op" id="3212105">)</span>&nbsp;<span class="ident" id="3212107">at</span><span class="op" id="3212109">(</span><span class="ident" id="3212110">node</span>&nbsp;<span class="ident" id="3212115">parse</span><span class="op" id="3212120">.</span><span class="ident" id="3212121">Node</span><span class="op" id="3212125">)</span>&nbsp;<span class="op" id="3212127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3212130">s</span><span class="op" id="3212131">.</span><span class="ident" id="3212132">node</span>&nbsp;<span class="op" id="3212137">=</span>&nbsp;<span class="ident" id="3212139">node</span><br>
<span class="lineno">70</span><span class="op" id="3212144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3212147">//&nbsp;doublePercent&nbsp;returns&nbsp;the&nbsp;string&nbsp;with&nbsp;%&#39;s&nbsp;replaced&nbsp;by&nbsp;%%,&nbsp;if&nbsp;necessary,</span><br>
<span class="lineno"></span><span class="comment" id="3212222">//&nbsp;so&nbsp;it&nbsp;can&nbsp;be&nbsp;used&nbsp;safely&nbsp;inside&nbsp;a&nbsp;Printf&nbsp;format&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3212281">func</span>&nbsp;<span class="ident" id="3212286">doublePercent</span><span class="op" id="3212299">(</span><span class="ident" id="3212300">str</span>&nbsp;<span class="builtintype" id="3212304">string</span><span class="op" id="3212310">)</span>&nbsp;<span class="builtintype" id="3212312">string</span>&nbsp;<span class="op" id="3212319">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212322">if</span>&nbsp;<span class="ident" id="3212325">strings</span><span class="op" id="3212332">.</span><span class="ident" id="3212333">Contains</span><span class="op" id="3212341">(</span><span class="ident" id="3212342">str</span><span class="op" id="3212345">,</span>&nbsp;<span class="string" id="3212347">&#34;%&#34;</span><span class="op" id="3212350">)</span>&nbsp;<span class="op" id="3212352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3212356">str</span>&nbsp;<span class="op" id="3212360">=</span>&nbsp;<span class="ident" id="3212362">strings</span><span class="op" id="3212369">.</span><span class="ident" id="3212370">Replace</span><span class="op" id="3212377">(</span><span class="ident" id="3212378">str</span><span class="op" id="3212381">,</span>&nbsp;<span class="string" id="3212383">&#34;%&#34;</span><span class="op" id="3212386">,</span>&nbsp;<span class="string" id="3212388">&#34;%%&#34;</span><span class="op" id="3212392">,</span>&nbsp;<span class="op" id="3212394">-</span><span class="num" id="3212395">1</span><span class="op" id="3212396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3212399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212402">return</span>&nbsp;<span class="ident" id="3212409">str</span><br>
<span class="lineno"></span><span class="op" id="3212413">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="3212416">//&nbsp;errorf&nbsp;formats&nbsp;the&nbsp;error&nbsp;and&nbsp;terminates&nbsp;processing.</span><br>
<span class="lineno"></span><span class="keyword" id="3212471">func</span>&nbsp;<span class="op" id="3212476">(</span><span class="ident" id="3212477">s</span>&nbsp;<span class="op" id="3212479">*</span><span class="ident" id="3212480">state</span><span class="op" id="3212485">)</span>&nbsp;<span class="ident" id="3212487">errorf</span><span class="op" id="3212493">(</span><span class="ident" id="3212494">format</span>&nbsp;<span class="builtintype" id="3212501">string</span><span class="op" id="3212507">,</span>&nbsp;<span class="ident" id="3212509">args</span>&nbsp;<span class="op" id="3212514">...</span><span class="keyword" id="3212517">interface</span><span class="op" id="3212526">{</span><span class="op" id="3212527">}</span><span class="op" id="3212528">)</span>&nbsp;<span class="op" id="3212530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3212533">name</span>&nbsp;<span class="op" id="3212538">:=</span>&nbsp;<span class="ident" id="3212541">doublePercent</span><span class="op" id="3212554">(</span><span class="ident" id="3212555">s</span><span class="op" id="3212556">.</span><span class="ident" id="3212557">tmpl</span><span class="op" id="3212561">.</span><span class="ident" id="3212562">Name</span><span class="op" id="3212566">(</span><span class="op" id="3212567">)</span><span class="op" id="3212568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3212571">if</span>&nbsp;<span class="ident" id="3212574">s</span><span class="op" id="3212575">.</span><span class="ident" id="3212576">node</span>&nbsp;<span class="op" id="3212581">==</span>&nbsp;<span class="ident" id="3212584">nil</span>&nbsp;<span class="op" id="3212588">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3212592">format</span>&nbsp;<span class="op" id="3212599">=</span>&nbsp;<span class="ident" id="3212601">fmt</span><span class="op" id="3212604">.</span><span class="ident" id="3212605">Sprintf</span><span class="op" id="3212612">(</span><span class="string" id="3212613">&#34;template:&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="3212631">,</span>&nbsp;<span class="ident" id="3212633">name</span><span class="op" id="3212637">,</span>&nbsp;<span class="ident" id="3212639">format</span><span class="op" id="3212645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3212648">}</span>&nbsp;<span class="keyword" id="3212650">else</span>&nbsp;<span class="op" id="3212655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3212659">location</span><span class="op" id="3212667">,</span>&nbsp;<span class="ident" id="3212669">context</span>&nbsp;<span class="op" id="3212677">:=</span>&nbsp;<span class="ident" id="3212680">s</span><span class="op" id="3212681">.</span><span class="ident" id="3212682">tmpl</span><span class="op" id="3212686">.</span><span class="ident" id="3212687">ErrorContext</span><span class="op" id="3212699">(</span><span class="ident" id="3212700">s</span><span class="op" id="3212701">.</span><span class="ident" id="3212702">node</span><span class="op" id="3212706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3212710">format</span>&nbsp;<span class="op" id="3212717">=</span>&nbsp;<span class="ident" id="3212719">fmt</span><span class="op" id="3212722">.</span><span class="ident" id="3212723">Sprintf</span><span class="op" id="3212730">(</span><span class="string" id="3212731">&#34;template:&nbsp;%s:&nbsp;executing&nbsp;%q&nbsp;at&nbsp;&lt;%s&gt;:&nbsp;%s&#34;</span><span class="op" id="3212771">,</span>&nbsp;<span class="ident" id="3212773">location</span><span class="op" id="3212781">,</span>&nbsp;<span class="ident" id="3212783">name</span><span class="op" id="3212787">,</span>&nbsp;<span class="ident" id="3212789">doublePercent</span><span class="op" id="3212802">(</span><span class="ident" id="3212803">context</span><span class="op" id="3212810">)</span><span class="op" id="3212811">,</span>&nbsp;<span class="ident" id="3212813">format</span><span class="op" id="3212819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3212822">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3212825">panic</span><span class="op" id="3212830">(</span><span class="ident" id="3212831">fmt</span><span class="op" id="3212834">.</span><span class="ident" id="3212835">Errorf</span><span class="op" id="3212841">(</span><span class="ident" id="3212842">format</span><span class="op" id="3212848">,</span>&nbsp;<span class="ident" id="3212850">args</span><span class="op" id="3212854">...</span><span class="op" id="3212857">)</span><span class="op" id="3212858">)</span><br>
<span class="lineno"></span><span class="op" id="3212860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3212863">//&nbsp;errRecover&nbsp;is&nbsp;the&nbsp;handler&nbsp;that&nbsp;turns&nbsp;panics&nbsp;into&nbsp;returns&nbsp;from&nbsp;the&nbsp;top</span><br>
<span class="lineno"></span><span class="comment" id="3212936">//&nbsp;level&nbsp;of&nbsp;Parse.</span><br>
<span class="lineno">95</span><span class="keyword" id="3212955">func</span>&nbsp;<span class="ident" id="3212960">errRecover</span><span class="op" id="3212970">(</span><span class="ident" id="3212971">errp</span>&nbsp;<span class="op" id="3212976">*</span><span class="builtintype" id="3212977">error</span><span class="op" id="3212982">)</span>&nbsp;<span class="op" id="3212984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3212987">e</span>&nbsp;<span class="op" id="3212989">:=</span>&nbsp;<span class="builtinfunc" id="3212992">recover</span><span class="op" id="3212999">(</span><span class="op" id="3213000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213003">if</span>&nbsp;<span class="ident" id="3213006">e</span>&nbsp;<span class="op" id="3213008">!=</span>&nbsp;<span class="ident" id="3213011">nil</span>&nbsp;<span class="op" id="3213015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213019">switch</span>&nbsp;<span class="ident" id="3213026">err</span>&nbsp;<span class="op" id="3213030">:=</span>&nbsp;<span class="ident" id="3213033">e</span><span class="op" id="3213034">.</span><span class="op" id="3213035">(</span><span class="keyword" id="3213036">type</span><span class="op" id="3213040">)</span>&nbsp;<span class="op" id="3213042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213046">case</span>&nbsp;<span class="ident" id="3213051">runtime</span><span class="op" id="3213058">.</span><span class="ident" id="3213059">Error</span><span class="op" id="3213064">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3213069">panic</span><span class="op" id="3213074">(</span><span class="ident" id="3213075">e</span><span class="op" id="3213076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213080">case</span>&nbsp;<span class="builtintype" id="3213085">error</span><span class="op" id="3213090">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3213095">*</span><span class="ident" id="3213096">errp</span>&nbsp;<span class="op" id="3213101">=</span>&nbsp;<span class="ident" id="3213103">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213109">default</span><span class="op" id="3213116">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3213121">panic</span><span class="op" id="3213126">(</span><span class="ident" id="3213127">e</span><span class="op" id="3213128">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3213132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3213135">}</span><br>
<span class="lineno"></span><span class="op" id="3213137">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3213140">//&nbsp;ExecuteTemplate&nbsp;applies&nbsp;the&nbsp;template&nbsp;associated&nbsp;with&nbsp;t&nbsp;that&nbsp;has&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno">110</span><span class="comment" id="3213222">//&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno"></span><span class="comment" id="3213283">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="3213351">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3213424">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="3213446">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno">115</span><span class="keyword" id="3213496">func</span>&nbsp;<span class="op" id="3213501">(</span><span class="ident" id="3213502">t</span>&nbsp;<span class="op" id="3213504">*</span><span class="ident" id="3213505">Template</span><span class="op" id="3213513">)</span>&nbsp;<span class="ident" id="3213515">ExecuteTemplate</span><span class="op" id="3213530">(</span><span class="ident" id="3213531">wr</span>&nbsp;<span class="ident" id="3213534">io</span><span class="op" id="3213536">.</span><span class="ident" id="3213537">Writer</span><span class="op" id="3213543">,</span>&nbsp;<span class="ident" id="3213545">name</span>&nbsp;<span class="builtintype" id="3213550">string</span><span class="op" id="3213556">,</span>&nbsp;<span class="ident" id="3213558">data</span>&nbsp;<span class="keyword" id="3213563">interface</span><span class="op" id="3213572">{</span><span class="op" id="3213573">}</span><span class="op" id="3213574">)</span>&nbsp;<span class="builtintype" id="3213576">error</span>&nbsp;<span class="op" id="3213582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3213585">tmpl</span>&nbsp;<span class="op" id="3213590">:=</span>&nbsp;<span class="ident" id="3213593">t</span><span class="op" id="3213594">.</span><span class="ident" id="3213595">tmpl</span><span class="op" id="3213599">[</span><span class="ident" id="3213600">name</span><span class="op" id="3213604">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213607">if</span>&nbsp;<span class="ident" id="3213610">tmpl</span>&nbsp;<span class="op" id="3213615">==</span>&nbsp;<span class="ident" id="3213618">nil</span>&nbsp;<span class="op" id="3213622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213626">return</span>&nbsp;<span class="ident" id="3213633">fmt</span><span class="op" id="3213636">.</span><span class="ident" id="3213637">Errorf</span><span class="op" id="3213643">(</span><span class="string" id="3213644">&#34;template:&nbsp;no&nbsp;template&nbsp;%q&nbsp;associated&nbsp;with&nbsp;template&nbsp;%q&#34;</span><span class="op" id="3213698">,</span>&nbsp;<span class="ident" id="3213700">name</span><span class="op" id="3213704">,</span>&nbsp;<span class="ident" id="3213706">t</span><span class="op" id="3213707">.</span><span class="ident" id="3213708">name</span><span class="op" id="3213712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3213715">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3213718">return</span>&nbsp;<span class="ident" id="3213725">tmpl</span><span class="op" id="3213729">.</span><span class="ident" id="3213730">Execute</span><span class="op" id="3213737">(</span><span class="ident" id="3213738">wr</span><span class="op" id="3213740">,</span>&nbsp;<span class="ident" id="3213742">data</span><span class="op" id="3213746">)</span><br>
<span class="lineno"></span><span class="op" id="3213748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3213751">//&nbsp;Execute&nbsp;applies&nbsp;a&nbsp;parsed&nbsp;template&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object,</span><br>
<span class="lineno"></span><span class="comment" id="3213818">//&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno">125</span><span class="comment" id="3213850">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="3213918">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3213991">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="3214013">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="3214063">func</span>&nbsp;<span class="op" id="3214068">(</span><span class="ident" id="3214069">t</span>&nbsp;<span class="op" id="3214071">*</span><span class="ident" id="3214072">Template</span><span class="op" id="3214080">)</span>&nbsp;<span class="ident" id="3214082">Execute</span><span class="op" id="3214089">(</span><span class="ident" id="3214090">wr</span>&nbsp;<span class="ident" id="3214093">io</span><span class="op" id="3214095">.</span><span class="ident" id="3214096">Writer</span><span class="op" id="3214102">,</span>&nbsp;<span class="ident" id="3214104">data</span>&nbsp;<span class="keyword" id="3214109">interface</span><span class="op" id="3214118">{</span><span class="op" id="3214119">}</span><span class="op" id="3214120">)</span>&nbsp;<span class="op" id="3214122">(</span><span class="ident" id="3214123">err</span>&nbsp;<span class="builtintype" id="3214127">error</span><span class="op" id="3214132">)</span>&nbsp;<span class="op" id="3214134">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214137">defer</span>&nbsp;<span class="ident" id="3214143">errRecover</span><span class="op" id="3214153">(</span><span class="op" id="3214154">&amp;</span><span class="ident" id="3214155">err</span><span class="op" id="3214158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214161">value</span>&nbsp;<span class="op" id="3214167">:=</span>&nbsp;<span class="ident" id="3214170">reflect</span><span class="op" id="3214177">.</span><span class="ident" id="3214178">ValueOf</span><span class="op" id="3214185">(</span><span class="ident" id="3214186">data</span><span class="op" id="3214190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214193">state</span>&nbsp;<span class="op" id="3214199">:=</span>&nbsp;<span class="op" id="3214202">&amp;</span><span class="ident" id="3214203">state</span><span class="op" id="3214208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214212">tmpl</span><span class="op" id="3214216">:</span>&nbsp;<span class="ident" id="3214218">t</span><span class="op" id="3214219">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214223">wr</span><span class="op" id="3214225">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3214229">wr</span><span class="op" id="3214231">,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214235">vars</span><span class="op" id="3214239">:</span>&nbsp;<span class="op" id="3214241">[</span><span class="op" id="3214242">]</span><span class="ident" id="3214243">variable</span><span class="op" id="3214251">{</span><span class="op" id="3214252">{</span><span class="string" id="3214253">&#34;$&#34;</span><span class="op" id="3214256">,</span>&nbsp;<span class="ident" id="3214258">value</span><span class="op" id="3214263">}</span><span class="op" id="3214264">}</span><span class="op" id="3214265">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3214268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214271">t</span><span class="op" id="3214272">.</span><span class="ident" id="3214273">init</span><span class="op" id="3214277">(</span><span class="op" id="3214278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214281">if</span>&nbsp;<span class="ident" id="3214284">t</span><span class="op" id="3214285">.</span><span class="ident" id="3214286">Tree</span>&nbsp;<span class="op" id="3214291">==</span>&nbsp;<span class="ident" id="3214294">nil</span>&nbsp;<span class="op" id="3214298">||</span>&nbsp;<span class="ident" id="3214301">t</span><span class="op" id="3214302">.</span><span class="ident" id="3214303">Root</span>&nbsp;<span class="op" id="3214308">==</span>&nbsp;<span class="ident" id="3214311">nil</span>&nbsp;<span class="op" id="3214315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214319">var</span>&nbsp;<span class="ident" id="3214323">b</span>&nbsp;<span class="ident" id="3214325">bytes</span><span class="op" id="3214330">.</span><span class="ident" id="3214331">Buffer</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214340">for</span>&nbsp;<span class="ident" id="3214344">name</span><span class="op" id="3214348">,</span>&nbsp;<span class="ident" id="3214350">tmpl</span>&nbsp;<span class="op" id="3214355">:=</span>&nbsp;<span class="keyword" id="3214358">range</span>&nbsp;<span class="ident" id="3214364">t</span><span class="op" id="3214365">.</span><span class="ident" id="3214366">tmpl</span>&nbsp;<span class="op" id="3214371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214376">if</span>&nbsp;<span class="ident" id="3214379">tmpl</span><span class="op" id="3214383">.</span><span class="ident" id="3214384">Tree</span>&nbsp;<span class="op" id="3214389">==</span>&nbsp;<span class="ident" id="3214392">nil</span>&nbsp;<span class="op" id="3214396">||</span>&nbsp;<span class="ident" id="3214399">tmpl</span><span class="op" id="3214403">.</span><span class="ident" id="3214404">Root</span>&nbsp;<span class="op" id="3214409">==</span>&nbsp;<span class="ident" id="3214412">nil</span>&nbsp;<span class="op" id="3214416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214422">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3214434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214439">if</span>&nbsp;<span class="ident" id="3214442">b</span><span class="op" id="3214443">.</span><span class="ident" id="3214444">Len</span><span class="op" id="3214447">(</span><span class="op" id="3214448">)</span>&nbsp;<span class="op" id="3214450">&gt;</span>&nbsp;<span class="num" id="3214452">0</span>&nbsp;<span class="op" id="3214454">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214460">b</span><span class="op" id="3214461">.</span><span class="ident" id="3214462">WriteString</span><span class="op" id="3214473">(</span><span class="string" id="3214474">&#34;,&nbsp;&#34;</span><span class="op" id="3214478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3214483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214488">fmt</span><span class="op" id="3214491">.</span><span class="ident" id="3214492">Fprintf</span><span class="op" id="3214499">(</span><span class="op" id="3214500">&amp;</span><span class="ident" id="3214501">b</span><span class="op" id="3214502">,</span>&nbsp;<span class="string" id="3214504">&#34;%q&#34;</span><span class="op" id="3214508">,</span>&nbsp;<span class="ident" id="3214510">name</span><span class="op" id="3214514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3214518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214522">var</span>&nbsp;<span class="ident" id="3214526">s</span>&nbsp;<span class="builtintype" id="3214528">string</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214537">if</span>&nbsp;<span class="ident" id="3214540">b</span><span class="op" id="3214541">.</span><span class="ident" id="3214542">Len</span><span class="op" id="3214545">(</span><span class="op" id="3214546">)</span>&nbsp;<span class="op" id="3214548">&gt;</span>&nbsp;<span class="num" id="3214550">0</span>&nbsp;<span class="op" id="3214552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214557">s</span>&nbsp;<span class="op" id="3214559">=</span>&nbsp;<span class="string" id="3214561">&#34;;&nbsp;defined&nbsp;templates&nbsp;are:&nbsp;&#34;</span>&nbsp;<span class="op" id="3214589">+</span>&nbsp;<span class="ident" id="3214591">b</span><span class="op" id="3214592">.</span><span class="ident" id="3214593">String</span><span class="op" id="3214599">(</span><span class="op" id="3214600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3214604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214608">state</span><span class="op" id="3214613">.</span><span class="ident" id="3214614">errorf</span><span class="op" id="3214620">(</span><span class="string" id="3214621">&#34;%q&nbsp;is&nbsp;an&nbsp;incomplete&nbsp;or&nbsp;empty&nbsp;template%s&#34;</span><span class="op" id="3214662">,</span>&nbsp;<span class="ident" id="3214664">t</span><span class="op" id="3214665">.</span><span class="ident" id="3214666">Name</span><span class="op" id="3214670">(</span><span class="op" id="3214671">)</span><span class="op" id="3214672">,</span>&nbsp;<span class="ident" id="3214674">s</span><span class="op" id="3214675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3214678">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214681">state</span><span class="op" id="3214686">.</span><span class="ident" id="3214687">walk</span><span class="op" id="3214691">(</span><span class="ident" id="3214692">value</span><span class="op" id="3214697">,</span>&nbsp;<span class="ident" id="3214699">t</span><span class="op" id="3214700">.</span><span class="ident" id="3214701">Root</span><span class="op" id="3214705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214708">return</span><br>
<span class="lineno"></span><span class="op" id="3214715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3214718">//&nbsp;Walk&nbsp;functions&nbsp;step&nbsp;through&nbsp;the&nbsp;major&nbsp;pieces&nbsp;of&nbsp;the&nbsp;template&nbsp;structure,</span><br>
<span class="lineno">160</span><span class="comment" id="3214793">//&nbsp;generating&nbsp;output&nbsp;as&nbsp;they&nbsp;go.</span><br>
<span class="lineno"></span><span class="keyword" id="3214826">func</span>&nbsp;<span class="op" id="3214831">(</span><span class="ident" id="3214832">s</span>&nbsp;<span class="op" id="3214834">*</span><span class="ident" id="3214835">state</span><span class="op" id="3214840">)</span>&nbsp;<span class="ident" id="3214842">walk</span><span class="op" id="3214846">(</span><span class="ident" id="3214847">dot</span>&nbsp;<span class="ident" id="3214851">reflect</span><span class="op" id="3214858">.</span><span class="ident" id="3214859">Value</span><span class="op" id="3214864">,</span>&nbsp;<span class="ident" id="3214866">node</span>&nbsp;<span class="ident" id="3214871">parse</span><span class="op" id="3214876">.</span><span class="ident" id="3214877">Node</span><span class="op" id="3214881">)</span>&nbsp;<span class="op" id="3214883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3214886">s</span><span class="op" id="3214887">.</span><span class="ident" id="3214888">at</span><span class="op" id="3214890">(</span><span class="ident" id="3214891">node</span><span class="op" id="3214895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214898">switch</span>&nbsp;<span class="ident" id="3214905">node</span>&nbsp;<span class="op" id="3214910">:=</span>&nbsp;<span class="ident" id="3214913">node</span><span class="op" id="3214917">.</span><span class="op" id="3214918">(</span><span class="keyword" id="3214919">type</span><span class="op" id="3214923">)</span>&nbsp;<span class="op" id="3214925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3214928">case</span>&nbsp;<span class="op" id="3214933">*</span><span class="ident" id="3214934">parse</span><span class="op" id="3214939">.</span><span class="ident" id="3214940">ActionNode</span><span class="op" id="3214950">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3214954">//&nbsp;Do&nbsp;not&nbsp;pop&nbsp;variables&nbsp;so&nbsp;they&nbsp;persist&nbsp;until&nbsp;next&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3215012">//&nbsp;Also,&nbsp;if&nbsp;the&nbsp;action&nbsp;declares&nbsp;variables,&nbsp;don&#39;t&nbsp;print&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3215081">val</span>&nbsp;<span class="op" id="3215085">:=</span>&nbsp;<span class="ident" id="3215088">s</span><span class="op" id="3215089">.</span><span class="ident" id="3215090">evalPipeline</span><span class="op" id="3215102">(</span><span class="ident" id="3215103">dot</span><span class="op" id="3215106">,</span>&nbsp;<span class="ident" id="3215108">node</span><span class="op" id="3215112">.</span><span class="ident" id="3215113">Pipe</span><span class="op" id="3215117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215121">if</span>&nbsp;<span class="builtinfunc" id="3215124">len</span><span class="op" id="3215127">(</span><span class="ident" id="3215128">node</span><span class="op" id="3215132">.</span><span class="ident" id="3215133">Pipe</span><span class="op" id="3215137">.</span><span class="ident" id="3215138">Decl</span><span class="op" id="3215142">)</span>&nbsp;<span class="op" id="3215144">==</span>&nbsp;<span class="num" id="3215147">0</span>&nbsp;<span class="op" id="3215149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3215154">s</span><span class="op" id="3215155">.</span><span class="ident" id="3215156">printValue</span><span class="op" id="3215166">(</span><span class="ident" id="3215167">node</span><span class="op" id="3215171">,</span>&nbsp;<span class="ident" id="3215173">val</span><span class="op" id="3215176">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3215180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215183">case</span>&nbsp;<span class="op" id="3215188">*</span><span class="ident" id="3215189">parse</span><span class="op" id="3215194">.</span><span class="ident" id="3215195">IfNode</span><span class="op" id="3215201">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3215205">s</span><span class="op" id="3215206">.</span><span class="ident" id="3215207">walkIfOrWith</span><span class="op" id="3215219">(</span><span class="ident" id="3215220">parse</span><span class="op" id="3215225">.</span><span class="ident" id="3215226">NodeIf</span><span class="op" id="3215232">,</span>&nbsp;<span class="ident" id="3215234">dot</span><span class="op" id="3215237">,</span>&nbsp;<span class="ident" id="3215239">node</span><span class="op" id="3215243">.</span><span class="ident" id="3215244">Pipe</span><span class="op" id="3215248">,</span>&nbsp;<span class="ident" id="3215250">node</span><span class="op" id="3215254">.</span><span class="ident" id="3215255">List</span><span class="op" id="3215259">,</span>&nbsp;<span class="ident" id="3215261">node</span><span class="op" id="3215265">.</span><span class="ident" id="3215266">ElseList</span><span class="op" id="3215274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215277">case</span>&nbsp;<span class="op" id="3215282">*</span><span class="ident" id="3215283">parse</span><span class="op" id="3215288">.</span><span class="ident" id="3215289">ListNode</span><span class="op" id="3215297">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215301">for</span>&nbsp;<span class="ident" id="3215305">_</span><span class="op" id="3215306">,</span>&nbsp;<span class="ident" id="3215308">node</span>&nbsp;<span class="op" id="3215313">:=</span>&nbsp;<span class="keyword" id="3215316">range</span>&nbsp;<span class="ident" id="3215322">node</span><span class="op" id="3215326">.</span><span class="ident" id="3215327">Nodes</span>&nbsp;<span class="op" id="3215333">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3215338">s</span><span class="op" id="3215339">.</span><span class="ident" id="3215340">walk</span><span class="op" id="3215344">(</span><span class="ident" id="3215345">dot</span><span class="op" id="3215348">,</span>&nbsp;<span class="ident" id="3215350">node</span><span class="op" id="3215354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3215358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215361">case</span>&nbsp;<span class="op" id="3215366">*</span><span class="ident" id="3215367">parse</span><span class="op" id="3215372">.</span><span class="ident" id="3215373">RangeNode</span><span class="op" id="3215382">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3215386">s</span><span class="op" id="3215387">.</span><span class="ident" id="3215388">walkRange</span><span class="op" id="3215397">(</span><span class="ident" id="3215398">dot</span><span class="op" id="3215401">,</span>&nbsp;<span class="ident" id="3215403">node</span><span class="op" id="3215407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215410">case</span>&nbsp;<span class="op" id="3215415">*</span><span class="ident" id="3215416">parse</span><span class="op" id="3215421">.</span><span class="ident" id="3215422">TemplateNode</span><span class="op" id="3215434">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3215438">s</span><span class="op" id="3215439">.</span><span class="ident" id="3215440">walkTemplate</span><span class="op" id="3215452">(</span><span class="ident" id="3215453">dot</span><span class="op" id="3215456">,</span>&nbsp;<span class="ident" id="3215458">node</span><span class="op" id="3215462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215465">case</span>&nbsp;<span class="op" id="3215470">*</span><span class="ident" id="3215471">parse</span><span class="op" id="3215476">.</span><span class="ident" id="3215477">TextNode</span><span class="op" id="3215485">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215489">if</span>&nbsp;<span class="ident" id="3215492">_</span><span class="op" id="3215493">,</span>&nbsp;<span class="ident" id="3215495">err</span>&nbsp;<span class="op" id="3215499">:=</span>&nbsp;<span class="ident" id="3215502">s</span><span class="op" id="3215503">.</span><span class="ident" id="3215504">wr</span><span class="op" id="3215506">.</span><span class="ident" id="3215507">Write</span><span class="op" id="3215512">(</span><span class="ident" id="3215513">node</span><span class="op" id="3215517">.</span><span class="ident" id="3215518">Text</span><span class="op" id="3215522">)</span><span class="op" id="3215523">;</span>&nbsp;<span class="ident" id="3215525">err</span>&nbsp;<span class="op" id="3215529">!=</span>&nbsp;<span class="ident" id="3215532">nil</span>&nbsp;<span class="op" id="3215536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3215541">s</span><span class="op" id="3215542">.</span><span class="ident" id="3215543">errorf</span><span class="op" id="3215549">(</span><span class="string" id="3215550">&#34;%s&#34;</span><span class="op" id="3215554">,</span>&nbsp;<span class="ident" id="3215556">err</span><span class="op" id="3215559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3215563">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215566">case</span>&nbsp;<span class="op" id="3215571">*</span><span class="ident" id="3215572">parse</span><span class="op" id="3215577">.</span><span class="ident" id="3215578">WithNode</span><span class="op" id="3215586">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3215590">s</span><span class="op" id="3215591">.</span><span class="ident" id="3215592">walkIfOrWith</span><span class="op" id="3215604">(</span><span class="ident" id="3215605">parse</span><span class="op" id="3215610">.</span><span class="ident" id="3215611">NodeWith</span><span class="op" id="3215619">,</span>&nbsp;<span class="ident" id="3215621">dot</span><span class="op" id="3215624">,</span>&nbsp;<span class="ident" id="3215626">node</span><span class="op" id="3215630">.</span><span class="ident" id="3215631">Pipe</span><span class="op" id="3215635">,</span>&nbsp;<span class="ident" id="3215637">node</span><span class="op" id="3215641">.</span><span class="ident" id="3215642">List</span><span class="op" id="3215646">,</span>&nbsp;<span class="ident" id="3215648">node</span><span class="op" id="3215652">.</span><span class="ident" id="3215653">ElseList</span><span class="op" id="3215661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215664">default</span><span class="op" id="3215671">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3215675">s</span><span class="op" id="3215676">.</span><span class="ident" id="3215677">errorf</span><span class="op" id="3215683">(</span><span class="string" id="3215684">&#34;unknown&nbsp;node:&nbsp;%s&#34;</span><span class="op" id="3215702">,</span>&nbsp;<span class="ident" id="3215704">node</span><span class="op" id="3215708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3215711">}</span><br>
<span class="lineno">190</span><span class="op" id="3215713">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3215716">//&nbsp;walkIfOrWith&nbsp;walks&nbsp;an&nbsp;&#39;if&#39;&nbsp;or&nbsp;&#39;with&#39;&nbsp;node.&nbsp;The&nbsp;two&nbsp;control&nbsp;structures</span><br>
<span class="lineno"></span><span class="comment" id="3215789">//&nbsp;are&nbsp;identical&nbsp;in&nbsp;behavior&nbsp;except&nbsp;that&nbsp;&#39;with&#39;&nbsp;sets&nbsp;dot.</span><br>
<span class="lineno"></span><span class="keyword" id="3215847">func</span>&nbsp;<span class="op" id="3215852">(</span><span class="ident" id="3215853">s</span>&nbsp;<span class="op" id="3215855">*</span><span class="ident" id="3215856">state</span><span class="op" id="3215861">)</span>&nbsp;<span class="ident" id="3215863">walkIfOrWith</span><span class="op" id="3215875">(</span><span class="ident" id="3215876">typ</span>&nbsp;<span class="ident" id="3215880">parse</span><span class="op" id="3215885">.</span><span class="ident" id="3215886">NodeType</span><span class="op" id="3215894">,</span>&nbsp;<span class="ident" id="3215896">dot</span>&nbsp;<span class="ident" id="3215900">reflect</span><span class="op" id="3215907">.</span><span class="ident" id="3215908">Value</span><span class="op" id="3215913">,</span>&nbsp;<span class="ident" id="3215915">pipe</span>&nbsp;<span class="op" id="3215920">*</span><span class="ident" id="3215921">parse</span><span class="op" id="3215926">.</span><span class="ident" id="3215927">PipeNode</span><span class="op" id="3215935">,</span>&nbsp;<span class="ident" id="3215937">list</span><span class="op" id="3215941">,</span>&nbsp;<span class="ident" id="3215943">elseList</span>&nbsp;<span class="op" id="3215952">*</span><span class="ident" id="3215953">parse</span><span class="op" id="3215958">.</span><span class="ident" id="3215959">ListNode</span><span class="op" id="3215967">)</span>&nbsp;<span class="op" id="3215969">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3215972">defer</span>&nbsp;<span class="ident" id="3215978">s</span><span class="op" id="3215979">.</span><span class="ident" id="3215980">pop</span><span class="op" id="3215983">(</span><span class="ident" id="3215984">s</span><span class="op" id="3215985">.</span><span class="ident" id="3215986">mark</span><span class="op" id="3215990">(</span><span class="op" id="3215991">)</span><span class="op" id="3215992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3215995">val</span>&nbsp;<span class="op" id="3215999">:=</span>&nbsp;<span class="ident" id="3216002">s</span><span class="op" id="3216003">.</span><span class="ident" id="3216004">evalPipeline</span><span class="op" id="3216016">(</span><span class="ident" id="3216017">dot</span><span class="op" id="3216020">,</span>&nbsp;<span class="ident" id="3216022">pipe</span><span class="op" id="3216026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3216029">truth</span><span class="op" id="3216034">,</span>&nbsp;<span class="ident" id="3216036">ok</span>&nbsp;<span class="op" id="3216039">:=</span>&nbsp;<span class="ident" id="3216042">isTrue</span><span class="op" id="3216048">(</span><span class="ident" id="3216049">val</span><span class="op" id="3216052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3216055">if</span>&nbsp;<span class="op" id="3216058">!</span><span class="ident" id="3216059">ok</span>&nbsp;<span class="op" id="3216062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3216066">s</span><span class="op" id="3216067">.</span><span class="ident" id="3216068">errorf</span><span class="op" id="3216074">(</span><span class="string" id="3216075">&#34;if/with&nbsp;can&#39;t&nbsp;use&nbsp;%v&#34;</span><span class="op" id="3216097">,</span>&nbsp;<span class="ident" id="3216099">val</span><span class="op" id="3216102">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3216105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3216108">if</span>&nbsp;<span class="ident" id="3216111">truth</span>&nbsp;<span class="op" id="3216117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3216121">if</span>&nbsp;<span class="ident" id="3216124">typ</span>&nbsp;<span class="op" id="3216128">==</span>&nbsp;<span class="ident" id="3216131">parse</span><span class="op" id="3216136">.</span><span class="ident" id="3216137">NodeWith</span>&nbsp;<span class="op" id="3216146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3216151">s</span><span class="op" id="3216152">.</span><span class="ident" id="3216153">walk</span><span class="op" id="3216157">(</span><span class="ident" id="3216158">val</span><span class="op" id="3216161">,</span>&nbsp;<span class="ident" id="3216163">list</span><span class="op" id="3216167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3216171">}</span>&nbsp;<span class="keyword" id="3216173">else</span>&nbsp;<span class="op" id="3216178">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3216183">s</span><span class="op" id="3216184">.</span><span class="ident" id="3216185">walk</span><span class="op" id="3216189">(</span><span class="ident" id="3216190">dot</span><span class="op" id="3216193">,</span>&nbsp;<span class="ident" id="3216195">list</span><span class="op" id="3216199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3216203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3216206">}</span>&nbsp;<span class="keyword" id="3216208">else</span>&nbsp;<span class="keyword" id="3216213">if</span>&nbsp;<span class="ident" id="3216216">elseList</span>&nbsp;<span class="op" id="3216225">!=</span>&nbsp;<span class="ident" id="3216228">nil</span>&nbsp;<span class="op" id="3216232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3216236">s</span><span class="op" id="3216237">.</span><span class="ident" id="3216238">walk</span><span class="op" id="3216242">(</span><span class="ident" id="3216243">dot</span><span class="op" id="3216246">,</span>&nbsp;<span class="ident" id="3216248">elseList</span><span class="op" id="3216256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3216259">}</span><br>
<span class="lineno">210</span><span class="op" id="3216261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3216264">//&nbsp;isTrue&nbsp;reports&nbsp;whether&nbsp;the&nbsp;value&nbsp;is&nbsp;&#39;true&#39;,&nbsp;in&nbsp;the&nbsp;sense&nbsp;of&nbsp;not&nbsp;the&nbsp;zero&nbsp;of&nbsp;its&nbsp;type,</span><br>
<span class="lineno"></span><span class="comment" id="3216353">//&nbsp;and&nbsp;whether&nbsp;the&nbsp;value&nbsp;has&nbsp;a&nbsp;meaningful&nbsp;truth&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="3216408">func</span>&nbsp;<span class="ident" id="3216413">isTrue</span><span class="op" id="3216419">(</span><span class="ident" id="3216420">val</span>&nbsp;<span class="ident" id="3216424">reflect</span><span class="op" id="3216431">.</span><span class="ident" id="3216432">Value</span><span class="op" id="3216437">)</span>&nbsp;<span class="op" id="3216439">(</span><span class="ident" id="3216440">truth</span><span class="op" id="3216445">,</span>&nbsp;<span class="ident" id="3216447">ok</span>&nbsp;<span class="builtintype" id="3216450">bool</span><span class="op" id="3216454">)</span>&nbsp;<span class="op" id="3216456">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3216459">if</span>&nbsp;<span class="op" id="3216462">!</span><span class="ident" id="3216463">val</span><span class="op" id="3216466">.</span><span class="ident" id="3216467">IsValid</span><span class="op" id="3216474">(</span><span class="op" id="3216475">)</span>&nbsp;<span class="op" id="3216477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3216481">//&nbsp;Something&nbsp;like&nbsp;var&nbsp;x&nbsp;interface{},&nbsp;never&nbsp;set.&nbsp;It&#39;s&nbsp;a&nbsp;form&nbsp;of&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3216551">return</span>&nbsp;<span class="builtintype" id="3216558">false</span><span class="op" id="3216563">,</span>&nbsp;<span class="builtintype" id="3216565">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3216571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3216574">switch</span>&nbsp;<span class="ident" id="3216581">val</span><span class="op" id="3216584">.</span><span class="ident" id="3216585">Kind</span><span class="op" id="3216589">(</span><span class="op" id="3216590">)</span>&nbsp;<span class="op" id="3216592">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3216595">case</span>&nbsp;<span class="ident" id="3216600">reflect</span><span class="op" id="3216607">.</span><span class="ident" id="3216608">Array</span><span class="op" id="3216613">,</span>&nbsp;<span class="ident" id="3216615">reflect</span><span class="op" id="3216622">.</span><span class="ident" id="3216623">Map</span><span class="op" id="3216626">,</span>&nbsp;<span class="ident" id="3216628">reflect</span><span class="op" id="3216635">.</span><span class="ident" id="3216636">Slice</span><span class="op" id="3216641">,</span>&nbsp;<span class="ident" id="3216643">reflect</span><span class="op" id="3216650">.</span><span class="ident" id="3216651">String</span><span class="op" id="3216657">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3216661">truth</span>&nbsp;<span class="op" id="3216667">=</span>&nbsp;<span class="ident" id="3216669">val</span><span class="op" id="3216672">.</span><span class="ident" id="3216673">Len</span><span class="op" id="3216676">(</span><span class="op" id="3216677">)</span>&nbsp;<span class="op" id="3216679">&gt;</span>&nbsp;<span class="num" id="3216681">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3216684">case</span>&nbsp;<span class="ident" id="3216689">reflect</span><span class="op" id="3216696">.</span><span class="ident" id="3216697">Bool</span><span class="op" id="3216701">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3216705">truth</span>&nbsp;<span class="op" id="3216711">=</span>&nbsp;<span class="ident" id="3216713">val</span><span class="op" id="3216716">.</span><span class="ident" id="3216717">Bool</span><span class="op" id="3216721">(</span><span class="op" id="3216722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3216725">case</span>&nbsp;<span class="ident" id="3216730">reflect</span><span class="op" id="3216737">.</span><span class="ident" id="3216738">Complex64</span><span class="op" id="3216747">,</span>&nbsp;<span class="ident" id="3216749">reflect</span><span class="op" id="3216756">.</span><span class="ident" id="3216757">Complex128</span><span class="op" id="3216767">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3216771">truth</span>&nbsp;<span class="op" id="3216777">=</span>&nbsp;<span class="ident" id="3216779">val</span><span class="op" id="3216782">.</span><span class="ident" id="3216783">Complex</span><span class="op" id="3216790">(</span><span class="op" id="3216791">)</span>&nbsp;<span class="op" id="3216793">!=</span>&nbsp;<span class="num" id="3216796">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3216799">case</span>&nbsp;<span class="ident" id="3216804">reflect</span><span class="op" id="3216811">.</span><span class="ident" id="3216812">Chan</span><span class="op" id="3216816">,</span>&nbsp;<span class="ident" id="3216818">reflect</span><span class="op" id="3216825">.</span><span class="ident" id="3216826">Func</span><span class="op" id="3216830">,</span>&nbsp;<span class="ident" id="3216832">reflect</span><span class="op" id="3216839">.</span><span class="ident" id="3216840">Ptr</span><span class="op" id="3216843">,</span>&nbsp;<span class="ident" id="3216845">reflect</span><span class="op" id="3216852">.</span><span class="ident" id="3216853">Interface</span><span class="op" id="3216862">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3216866">truth</span>&nbsp;<span class="op" id="3216872">=</span>&nbsp;<span class="op" id="3216874">!</span><span class="ident" id="3216875">val</span><span class="op" id="3216878">.</span><span class="ident" id="3216879">IsNil</span><span class="op" id="3216884">(</span><span class="op" id="3216885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3216888">case</span>&nbsp;<span class="ident" id="3216893">reflect</span><span class="op" id="3216900">.</span><span class="ident" id="3216901">Int</span><span class="op" id="3216904">,</span>&nbsp;<span class="ident" id="3216906">reflect</span><span class="op" id="3216913">.</span><span class="ident" id="3216914">Int8</span><span class="op" id="3216918">,</span>&nbsp;<span class="ident" id="3216920">reflect</span><span class="op" id="3216927">.</span><span class="ident" id="3216928">Int16</span><span class="op" id="3216933">,</span>&nbsp;<span class="ident" id="3216935">reflect</span><span class="op" id="3216942">.</span><span class="ident" id="3216943">Int32</span><span class="op" id="3216948">,</span>&nbsp;<span class="ident" id="3216950">reflect</span><span class="op" id="3216957">.</span><span class="ident" id="3216958">Int64</span><span class="op" id="3216963">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3216967">truth</span>&nbsp;<span class="op" id="3216973">=</span>&nbsp;<span class="ident" id="3216975">val</span><span class="op" id="3216978">.</span><span class="ident" id="3216979">Int</span><span class="op" id="3216982">(</span><span class="op" id="3216983">)</span>&nbsp;<span class="op" id="3216985">!=</span>&nbsp;<span class="num" id="3216988">0</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3216991">case</span>&nbsp;<span class="ident" id="3216996">reflect</span><span class="op" id="3217003">.</span><span class="ident" id="3217004">Float32</span><span class="op" id="3217011">,</span>&nbsp;<span class="ident" id="3217013">reflect</span><span class="op" id="3217020">.</span><span class="ident" id="3217021">Float64</span><span class="op" id="3217028">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3217032">truth</span>&nbsp;<span class="op" id="3217038">=</span>&nbsp;<span class="ident" id="3217040">val</span><span class="op" id="3217043">.</span><span class="ident" id="3217044">Float</span><span class="op" id="3217049">(</span><span class="op" id="3217050">)</span>&nbsp;<span class="op" id="3217052">!=</span>&nbsp;<span class="num" id="3217055">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3217058">case</span>&nbsp;<span class="ident" id="3217063">reflect</span><span class="op" id="3217070">.</span><span class="ident" id="3217071">Uint</span><span class="op" id="3217075">,</span>&nbsp;<span class="ident" id="3217077">reflect</span><span class="op" id="3217084">.</span><span class="ident" id="3217085">Uint8</span><span class="op" id="3217090">,</span>&nbsp;<span class="ident" id="3217092">reflect</span><span class="op" id="3217099">.</span><span class="ident" id="3217100">Uint16</span><span class="op" id="3217106">,</span>&nbsp;<span class="ident" id="3217108">reflect</span><span class="op" id="3217115">.</span><span class="ident" id="3217116">Uint32</span><span class="op" id="3217122">,</span>&nbsp;<span class="ident" id="3217124">reflect</span><span class="op" id="3217131">.</span><span class="ident" id="3217132">Uint64</span><span class="op" id="3217138">,</span>&nbsp;<span class="ident" id="3217140">reflect</span><span class="op" id="3217147">.</span><span class="ident" id="3217148">Uintptr</span><span class="op" id="3217155">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3217159">truth</span>&nbsp;<span class="op" id="3217165">=</span>&nbsp;<span class="ident" id="3217167">val</span><span class="op" id="3217170">.</span><span class="ident" id="3217171">Uint</span><span class="op" id="3217175">(</span><span class="op" id="3217176">)</span>&nbsp;<span class="op" id="3217178">!=</span>&nbsp;<span class="num" id="3217181">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3217184">case</span>&nbsp;<span class="ident" id="3217189">reflect</span><span class="op" id="3217196">.</span><span class="ident" id="3217197">Struct</span><span class="op" id="3217203">:</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3217207">truth</span>&nbsp;<span class="op" id="3217213">=</span>&nbsp;<span class="builtintype" id="3217215">true</span>&nbsp;<span class="comment" id="3217220">//&nbsp;Struct&nbsp;values&nbsp;are&nbsp;always&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3217255">default</span><span class="op" id="3217262">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3217266">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3217274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3217277">return</span>&nbsp;<span class="ident" id="3217284">truth</span><span class="op" id="3217289">,</span>&nbsp;<span class="builtintype" id="3217291">true</span><br>
<span class="lineno">240</span><span class="op" id="3217296">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3217299">func</span>&nbsp;<span class="op" id="3217304">(</span><span class="ident" id="3217305">s</span>&nbsp;<span class="op" id="3217307">*</span><span class="ident" id="3217308">state</span><span class="op" id="3217313">)</span>&nbsp;<span class="ident" id="3217315">walkRange</span><span class="op" id="3217324">(</span><span class="ident" id="3217325">dot</span>&nbsp;<span class="ident" id="3217329">reflect</span><span class="op" id="3217336">.</span><span class="ident" id="3217337">Value</span><span class="op" id="3217342">,</span>&nbsp;<span class="ident" id="3217344">r</span>&nbsp;<span class="op" id="3217346">*</span><span class="ident" id="3217347">parse</span><span class="op" id="3217352">.</span><span class="ident" id="3217353">RangeNode</span><span class="op" id="3217362">)</span>&nbsp;<span class="op" id="3217364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3217367">s</span><span class="op" id="3217368">.</span><span class="ident" id="3217369">at</span><span class="op" id="3217371">(</span><span class="ident" id="3217372">r</span><span class="op" id="3217373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3217376">defer</span>&nbsp;<span class="ident" id="3217382">s</span><span class="op" id="3217383">.</span><span class="ident" id="3217384">pop</span><span class="op" id="3217387">(</span><span class="ident" id="3217388">s</span><span class="op" id="3217389">.</span><span class="ident" id="3217390">mark</span><span class="op" id="3217394">(</span><span class="op" id="3217395">)</span><span class="op" id="3217396">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3217399">val</span><span class="op" id="3217402">,</span>&nbsp;<span class="ident" id="3217404">_</span>&nbsp;<span class="op" id="3217406">:=</span>&nbsp;<span class="ident" id="3217409">indirect</span><span class="op" id="3217417">(</span><span class="ident" id="3217418">s</span><span class="op" id="3217419">.</span><span class="ident" id="3217420">evalPipeline</span><span class="op" id="3217432">(</span><span class="ident" id="3217433">dot</span><span class="op" id="3217436">,</span>&nbsp;<span class="ident" id="3217438">r</span><span class="op" id="3217439">.</span><span class="ident" id="3217440">Pipe</span><span class="op" id="3217444">)</span><span class="op" id="3217445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3217448">//&nbsp;mark&nbsp;top&nbsp;of&nbsp;stack&nbsp;before&nbsp;any&nbsp;variables&nbsp;in&nbsp;the&nbsp;body&nbsp;are&nbsp;pushed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3217515">mark</span>&nbsp;<span class="op" id="3217520">:=</span>&nbsp;<span class="ident" id="3217523">s</span><span class="op" id="3217524">.</span><span class="ident" id="3217525">mark</span><span class="op" id="3217529">(</span><span class="op" id="3217530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3217533">oneIteration</span>&nbsp;<span class="op" id="3217546">:=</span>&nbsp;<span class="keyword" id="3217549">func</span><span class="op" id="3217553">(</span><span class="ident" id="3217554">index</span><span class="op" id="3217559">,</span>&nbsp;<span class="ident" id="3217561">elem</span>&nbsp;<span class="ident" id="3217566">reflect</span><span class="op" id="3217573">.</span><span class="ident" id="3217574">Value</span><span class="op" id="3217579">)</span>&nbsp;<span class="op" id="3217581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3217585">//&nbsp;Set&nbsp;top&nbsp;var&nbsp;(lexically&nbsp;the&nbsp;second&nbsp;if&nbsp;there&nbsp;are&nbsp;two)&nbsp;to&nbsp;the&nbsp;element.</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3217658">if</span>&nbsp;<span class="builtinfunc" id="3217661">len</span><span class="op" id="3217664">(</span><span class="ident" id="3217665">r</span><span class="op" id="3217666">.</span><span class="ident" id="3217667">Pipe</span><span class="op" id="3217671">.</span><span class="ident" id="3217672">Decl</span><span class="op" id="3217676">)</span>&nbsp;<span class="op" id="3217678">&gt;</span>&nbsp;<span class="num" id="3217680">0</span>&nbsp;<span class="op" id="3217682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3217687">s</span><span class="op" id="3217688">.</span><span class="ident" id="3217689">setVar</span><span class="op" id="3217695">(</span><span class="num" id="3217696">1</span><span class="op" id="3217697">,</span>&nbsp;<span class="ident" id="3217699">elem</span><span class="op" id="3217703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3217707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3217711">//&nbsp;Set&nbsp;next&nbsp;var&nbsp;(lexically&nbsp;the&nbsp;first&nbsp;if&nbsp;there&nbsp;are&nbsp;two)&nbsp;to&nbsp;the&nbsp;index.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3217782">if</span>&nbsp;<span class="builtinfunc" id="3217785">len</span><span class="op" id="3217788">(</span><span class="ident" id="3217789">r</span><span class="op" id="3217790">.</span><span class="ident" id="3217791">Pipe</span><span class="op" id="3217795">.</span><span class="ident" id="3217796">Decl</span><span class="op" id="3217800">)</span>&nbsp;<span class="op" id="3217802">&gt;</span>&nbsp;<span class="num" id="3217804">1</span>&nbsp;<span class="op" id="3217806">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3217811">s</span><span class="op" id="3217812">.</span><span class="ident" id="3217813">setVar</span><span class="op" id="3217819">(</span><span class="num" id="3217820">2</span><span class="op" id="3217821">,</span>&nbsp;<span class="ident" id="3217823">index</span><span class="op" id="3217828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3217832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3217836">s</span><span class="op" id="3217837">.</span><span class="ident" id="3217838">walk</span><span class="op" id="3217842">(</span><span class="ident" id="3217843">elem</span><span class="op" id="3217847">,</span>&nbsp;<span class="ident" id="3217849">r</span><span class="op" id="3217850">.</span><span class="ident" id="3217851">List</span><span class="op" id="3217855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3217859">s</span><span class="op" id="3217860">.</span><span class="ident" id="3217861">pop</span><span class="op" id="3217864">(</span><span class="ident" id="3217865">mark</span><span class="op" id="3217869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3217872">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3217875">switch</span>&nbsp;<span class="ident" id="3217882">val</span><span class="op" id="3217885">.</span><span class="ident" id="3217886">Kind</span><span class="op" id="3217890">(</span><span class="op" id="3217891">)</span>&nbsp;<span class="op" id="3217893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3217896">case</span>&nbsp;<span class="ident" id="3217901">reflect</span><span class="op" id="3217908">.</span><span class="ident" id="3217909">Array</span><span class="op" id="3217914">,</span>&nbsp;<span class="ident" id="3217916">reflect</span><span class="op" id="3217923">.</span><span class="ident" id="3217924">Slice</span><span class="op" id="3217929">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3217933">if</span>&nbsp;<span class="ident" id="3217936">val</span><span class="op" id="3217939">.</span><span class="ident" id="3217940">Len</span><span class="op" id="3217943">(</span><span class="op" id="3217944">)</span>&nbsp;<span class="op" id="3217946">==</span>&nbsp;<span class="num" id="3217949">0</span>&nbsp;<span class="op" id="3217951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3217956">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3217964">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3217968">for</span>&nbsp;<span class="ident" id="3217972">i</span>&nbsp;<span class="op" id="3217974">:=</span>&nbsp;<span class="num" id="3217977">0</span><span class="op" id="3217978">;</span>&nbsp;<span class="ident" id="3217980">i</span>&nbsp;<span class="op" id="3217982">&lt;</span>&nbsp;<span class="ident" id="3217984">val</span><span class="op" id="3217987">.</span><span class="ident" id="3217988">Len</span><span class="op" id="3217991">(</span><span class="op" id="3217992">)</span><span class="op" id="3217993">;</span>&nbsp;<span class="ident" id="3217995">i</span><span class="op" id="3217996">++</span>&nbsp;<span class="op" id="3217999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3218004">oneIteration</span><span class="op" id="3218016">(</span><span class="ident" id="3218017">reflect</span><span class="op" id="3218024">.</span><span class="ident" id="3218025">ValueOf</span><span class="op" id="3218032">(</span><span class="ident" id="3218033">i</span><span class="op" id="3218034">)</span><span class="op" id="3218035">,</span>&nbsp;<span class="ident" id="3218037">val</span><span class="op" id="3218040">.</span><span class="ident" id="3218041">Index</span><span class="op" id="3218046">(</span><span class="ident" id="3218047">i</span><span class="op" id="3218048">)</span><span class="op" id="3218049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3218053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218057">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218065">case</span>&nbsp;<span class="ident" id="3218070">reflect</span><span class="op" id="3218077">.</span><span class="ident" id="3218078">Map</span><span class="op" id="3218081">:</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218085">if</span>&nbsp;<span class="ident" id="3218088">val</span><span class="op" id="3218091">.</span><span class="ident" id="3218092">Len</span><span class="op" id="3218095">(</span><span class="op" id="3218096">)</span>&nbsp;<span class="op" id="3218098">==</span>&nbsp;<span class="num" id="3218101">0</span>&nbsp;<span class="op" id="3218103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218108">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3218116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218120">for</span>&nbsp;<span class="ident" id="3218124">_</span><span class="op" id="3218125">,</span>&nbsp;<span class="ident" id="3218127">key</span>&nbsp;<span class="op" id="3218131">:=</span>&nbsp;<span class="keyword" id="3218134">range</span>&nbsp;<span class="ident" id="3218140">sortKeys</span><span class="op" id="3218148">(</span><span class="ident" id="3218149">val</span><span class="op" id="3218152">.</span><span class="ident" id="3218153">MapKeys</span><span class="op" id="3218160">(</span><span class="op" id="3218161">)</span><span class="op" id="3218162">)</span>&nbsp;<span class="op" id="3218164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3218169">oneIteration</span><span class="op" id="3218181">(</span><span class="ident" id="3218182">key</span><span class="op" id="3218185">,</span>&nbsp;<span class="ident" id="3218187">val</span><span class="op" id="3218190">.</span><span class="ident" id="3218191">MapIndex</span><span class="op" id="3218199">(</span><span class="ident" id="3218200">key</span><span class="op" id="3218203">)</span><span class="op" id="3218204">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3218208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218212">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218220">case</span>&nbsp;<span class="ident" id="3218225">reflect</span><span class="op" id="3218232">.</span><span class="ident" id="3218233">Chan</span><span class="op" id="3218237">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218241">if</span>&nbsp;<span class="ident" id="3218244">val</span><span class="op" id="3218247">.</span><span class="ident" id="3218248">IsNil</span><span class="op" id="3218253">(</span><span class="op" id="3218254">)</span>&nbsp;<span class="op" id="3218256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218261">break</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3218269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3218273">i</span>&nbsp;<span class="op" id="3218275">:=</span>&nbsp;<span class="num" id="3218278">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218282">for</span>&nbsp;<span class="op" id="3218286">;</span>&nbsp;<span class="op" id="3218288">;</span>&nbsp;<span class="ident" id="3218290">i</span><span class="op" id="3218291">++</span>&nbsp;<span class="op" id="3218294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3218299">elem</span><span class="op" id="3218303">,</span>&nbsp;<span class="ident" id="3218305">ok</span>&nbsp;<span class="op" id="3218308">:=</span>&nbsp;<span class="ident" id="3218311">val</span><span class="op" id="3218314">.</span><span class="ident" id="3218315">Recv</span><span class="op" id="3218319">(</span><span class="op" id="3218320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218325">if</span>&nbsp;<span class="op" id="3218328">!</span><span class="ident" id="3218329">ok</span>&nbsp;<span class="op" id="3218332">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218338">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3218347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3218352">oneIteration</span><span class="op" id="3218364">(</span><span class="ident" id="3218365">reflect</span><span class="op" id="3218372">.</span><span class="ident" id="3218373">ValueOf</span><span class="op" id="3218380">(</span><span class="ident" id="3218381">i</span><span class="op" id="3218382">)</span><span class="op" id="3218383">,</span>&nbsp;<span class="ident" id="3218385">elem</span><span class="op" id="3218389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3218393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218397">if</span>&nbsp;<span class="ident" id="3218400">i</span>&nbsp;<span class="op" id="3218402">==</span>&nbsp;<span class="num" id="3218405">0</span>&nbsp;<span class="op" id="3218407">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218412">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3218420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218424">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218432">case</span>&nbsp;<span class="ident" id="3218437">reflect</span><span class="op" id="3218444">.</span><span class="ident" id="3218445">Invalid</span><span class="op" id="3218452">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218456">break</span>&nbsp;<span class="comment" id="3218462">//&nbsp;An&nbsp;invalid&nbsp;value&nbsp;is&nbsp;likely&nbsp;a&nbsp;nil&nbsp;map,&nbsp;etc.&nbsp;and&nbsp;acts&nbsp;like&nbsp;an&nbsp;empty&nbsp;map.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218537">default</span><span class="op" id="3218544">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3218548">s</span><span class="op" id="3218549">.</span><span class="ident" id="3218550">errorf</span><span class="op" id="3218556">(</span><span class="string" id="3218557">&#34;range&nbsp;can&#39;t&nbsp;iterate&nbsp;over&nbsp;%v&#34;</span><span class="op" id="3218586">,</span>&nbsp;<span class="ident" id="3218588">val</span><span class="op" id="3218591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3218594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218597">if</span>&nbsp;<span class="ident" id="3218600">r</span><span class="op" id="3218601">.</span><span class="ident" id="3218602">ElseList</span>&nbsp;<span class="op" id="3218611">!=</span>&nbsp;<span class="ident" id="3218614">nil</span>&nbsp;<span class="op" id="3218618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3218622">s</span><span class="op" id="3218623">.</span><span class="ident" id="3218624">walk</span><span class="op" id="3218628">(</span><span class="ident" id="3218629">dot</span><span class="op" id="3218632">,</span>&nbsp;<span class="ident" id="3218634">r</span><span class="op" id="3218635">.</span><span class="ident" id="3218636">ElseList</span><span class="op" id="3218644">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3218647">}</span><br>
<span class="lineno"></span><span class="op" id="3218649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3218652">func</span>&nbsp;<span class="op" id="3218657">(</span><span class="ident" id="3218658">s</span>&nbsp;<span class="op" id="3218660">*</span><span class="ident" id="3218661">state</span><span class="op" id="3218666">)</span>&nbsp;<span class="ident" id="3218668">walkTemplate</span><span class="op" id="3218680">(</span><span class="ident" id="3218681">dot</span>&nbsp;<span class="ident" id="3218685">reflect</span><span class="op" id="3218692">.</span><span class="ident" id="3218693">Value</span><span class="op" id="3218698">,</span>&nbsp;<span class="ident" id="3218700">t</span>&nbsp;<span class="op" id="3218702">*</span><span class="ident" id="3218703">parse</span><span class="op" id="3218708">.</span><span class="ident" id="3218709">TemplateNode</span><span class="op" id="3218721">)</span>&nbsp;<span class="op" id="3218723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3218726">s</span><span class="op" id="3218727">.</span><span class="ident" id="3218728">at</span><span class="op" id="3218730">(</span><span class="ident" id="3218731">t</span><span class="op" id="3218732">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3218735">tmpl</span>&nbsp;<span class="op" id="3218740">:=</span>&nbsp;<span class="ident" id="3218743">s</span><span class="op" id="3218744">.</span><span class="ident" id="3218745">tmpl</span><span class="op" id="3218749">.</span><span class="ident" id="3218750">tmpl</span><span class="op" id="3218754">[</span><span class="ident" id="3218755">t</span><span class="op" id="3218756">.</span><span class="ident" id="3218757">Name</span><span class="op" id="3218761">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3218764">if</span>&nbsp;<span class="ident" id="3218767">tmpl</span>&nbsp;<span class="op" id="3218772">==</span>&nbsp;<span class="ident" id="3218775">nil</span>&nbsp;<span class="op" id="3218779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3218783">s</span><span class="op" id="3218784">.</span><span class="ident" id="3218785">errorf</span><span class="op" id="3218791">(</span><span class="string" id="3218792">&#34;template&nbsp;%q&nbsp;not&nbsp;defined&#34;</span><span class="op" id="3218817">,</span>&nbsp;<span class="ident" id="3218819">t</span><span class="op" id="3218820">.</span><span class="ident" id="3218821">Name</span><span class="op" id="3218825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3218828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3218831">//&nbsp;Variables&nbsp;declared&nbsp;by&nbsp;the&nbsp;pipeline&nbsp;persist.</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3218879">dot</span>&nbsp;<span class="op" id="3218883">=</span>&nbsp;<span class="ident" id="3218885">s</span><span class="op" id="3218886">.</span><span class="ident" id="3218887">evalPipeline</span><span class="op" id="3218899">(</span><span class="ident" id="3218900">dot</span><span class="op" id="3218903">,</span>&nbsp;<span class="ident" id="3218905">t</span><span class="op" id="3218906">.</span><span class="ident" id="3218907">Pipe</span><span class="op" id="3218911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3218914">newState</span>&nbsp;<span class="op" id="3218923">:=</span>&nbsp;<span class="op" id="3218926">*</span><span class="ident" id="3218927">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3218930">newState</span><span class="op" id="3218938">.</span><span class="ident" id="3218939">tmpl</span>&nbsp;<span class="op" id="3218944">=</span>&nbsp;<span class="ident" id="3218946">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3218952">//&nbsp;No&nbsp;dynamic&nbsp;scoping:&nbsp;template&nbsp;invocations&nbsp;inherit&nbsp;no&nbsp;variables.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3219019">newState</span><span class="op" id="3219027">.</span><span class="ident" id="3219028">vars</span>&nbsp;<span class="op" id="3219033">=</span>&nbsp;<span class="op" id="3219035">[</span><span class="op" id="3219036">]</span><span class="ident" id="3219037">variable</span><span class="op" id="3219045">{</span><span class="op" id="3219046">{</span><span class="string" id="3219047">&#34;$&#34;</span><span class="op" id="3219050">,</span>&nbsp;<span class="ident" id="3219052">dot</span><span class="op" id="3219055">}</span><span class="op" id="3219056">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3219059">newState</span><span class="op" id="3219067">.</span><span class="ident" id="3219068">walk</span><span class="op" id="3219072">(</span><span class="ident" id="3219073">dot</span><span class="op" id="3219076">,</span>&nbsp;<span class="ident" id="3219078">tmpl</span><span class="op" id="3219082">.</span><span class="ident" id="3219083">Root</span><span class="op" id="3219087">)</span><br>
<span class="lineno"></span><span class="op" id="3219089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3219092">//&nbsp;Eval&nbsp;functions&nbsp;evaluate&nbsp;pipelines,&nbsp;commands,&nbsp;and&nbsp;their&nbsp;elements&nbsp;and&nbsp;extract</span><br>
<span class="lineno"></span><span class="comment" id="3219171">//&nbsp;values&nbsp;from&nbsp;the&nbsp;data&nbsp;structure&nbsp;by&nbsp;examining&nbsp;fields,&nbsp;calling&nbsp;methods,&nbsp;and&nbsp;so&nbsp;on.</span><br>
<span class="lineno">320</span><span class="comment" id="3219254">//&nbsp;The&nbsp;printing&nbsp;of&nbsp;those&nbsp;values&nbsp;happens&nbsp;only&nbsp;through&nbsp;walk&nbsp;functions.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3219324">//&nbsp;evalPipeline&nbsp;returns&nbsp;the&nbsp;value&nbsp;acquired&nbsp;by&nbsp;evaluating&nbsp;a&nbsp;pipeline.&nbsp;If&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3219400">//&nbsp;pipeline&nbsp;has&nbsp;a&nbsp;variable&nbsp;declaration,&nbsp;the&nbsp;variable&nbsp;will&nbsp;be&nbsp;pushed&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3219475">//&nbsp;stack.&nbsp;Callers&nbsp;should&nbsp;therefore&nbsp;pop&nbsp;the&nbsp;stack&nbsp;after&nbsp;they&nbsp;are&nbsp;finished</span><br>
<span class="lineno">325</span><span class="comment" id="3219548">//&nbsp;executing&nbsp;commands&nbsp;depending&nbsp;on&nbsp;the&nbsp;pipeline&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="3219603">func</span>&nbsp;<span class="op" id="3219608">(</span><span class="ident" id="3219609">s</span>&nbsp;<span class="op" id="3219611">*</span><span class="ident" id="3219612">state</span><span class="op" id="3219617">)</span>&nbsp;<span class="ident" id="3219619">evalPipeline</span><span class="op" id="3219631">(</span><span class="ident" id="3219632">dot</span>&nbsp;<span class="ident" id="3219636">reflect</span><span class="op" id="3219643">.</span><span class="ident" id="3219644">Value</span><span class="op" id="3219649">,</span>&nbsp;<span class="ident" id="3219651">pipe</span>&nbsp;<span class="op" id="3219656">*</span><span class="ident" id="3219657">parse</span><span class="op" id="3219662">.</span><span class="ident" id="3219663">PipeNode</span><span class="op" id="3219671">)</span>&nbsp;<span class="op" id="3219673">(</span><span class="ident" id="3219674">value</span>&nbsp;<span class="ident" id="3219680">reflect</span><span class="op" id="3219687">.</span><span class="ident" id="3219688">Value</span><span class="op" id="3219693">)</span>&nbsp;<span class="op" id="3219695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219698">if</span>&nbsp;<span class="ident" id="3219701">pipe</span>&nbsp;<span class="op" id="3219706">==</span>&nbsp;<span class="ident" id="3219709">nil</span>&nbsp;<span class="op" id="3219713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219717">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3219725">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3219728">s</span><span class="op" id="3219729">.</span><span class="ident" id="3219730">at</span><span class="op" id="3219732">(</span><span class="ident" id="3219733">pipe</span><span class="op" id="3219737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219740">for</span>&nbsp;<span class="ident" id="3219744">_</span><span class="op" id="3219745">,</span>&nbsp;<span class="ident" id="3219747">cmd</span>&nbsp;<span class="op" id="3219751">:=</span>&nbsp;<span class="keyword" id="3219754">range</span>&nbsp;<span class="ident" id="3219760">pipe</span><span class="op" id="3219764">.</span><span class="ident" id="3219765">Cmds</span>&nbsp;<span class="op" id="3219770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3219774">value</span>&nbsp;<span class="op" id="3219780">=</span>&nbsp;<span class="ident" id="3219782">s</span><span class="op" id="3219783">.</span><span class="ident" id="3219784">evalCommand</span><span class="op" id="3219795">(</span><span class="ident" id="3219796">dot</span><span class="op" id="3219799">,</span>&nbsp;<span class="ident" id="3219801">cmd</span><span class="op" id="3219804">,</span>&nbsp;<span class="ident" id="3219806">value</span><span class="op" id="3219811">)</span>&nbsp;<span class="comment" id="3219813">//&nbsp;previous&nbsp;value&nbsp;is&nbsp;this&nbsp;one&#39;s&nbsp;final&nbsp;arg.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3219858">//&nbsp;If&nbsp;the&nbsp;object&nbsp;has&nbsp;type&nbsp;interface{},&nbsp;dig&nbsp;down&nbsp;one&nbsp;level&nbsp;to&nbsp;the&nbsp;thing&nbsp;inside.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3219939">if</span>&nbsp;<span class="ident" id="3219942">value</span><span class="op" id="3219947">.</span><span class="ident" id="3219948">Kind</span><span class="op" id="3219952">(</span><span class="op" id="3219953">)</span>&nbsp;<span class="op" id="3219955">==</span>&nbsp;<span class="ident" id="3219958">reflect</span><span class="op" id="3219965">.</span><span class="ident" id="3219966">Interface</span>&nbsp;<span class="op" id="3219976">&amp;&amp;</span>&nbsp;<span class="ident" id="3219979">value</span><span class="op" id="3219984">.</span><span class="ident" id="3219985">Type</span><span class="op" id="3219989">(</span><span class="op" id="3219990">)</span><span class="op" id="3219991">.</span><span class="ident" id="3219992">NumMethod</span><span class="op" id="3220001">(</span><span class="op" id="3220002">)</span>&nbsp;<span class="op" id="3220004">==</span>&nbsp;<span class="num" id="3220007">0</span>&nbsp;<span class="op" id="3220009">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3220014">value</span>&nbsp;<span class="op" id="3220020">=</span>&nbsp;<span class="ident" id="3220022">reflect</span><span class="op" id="3220029">.</span><span class="ident" id="3220030">ValueOf</span><span class="op" id="3220037">(</span><span class="ident" id="3220038">value</span><span class="op" id="3220043">.</span><span class="ident" id="3220044">Interface</span><span class="op" id="3220053">(</span><span class="op" id="3220054">)</span><span class="op" id="3220055">)</span>&nbsp;<span class="comment" id="3220057">//&nbsp;lovely!</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3220070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3220073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220076">for</span>&nbsp;<span class="ident" id="3220080">_</span><span class="op" id="3220081">,</span>&nbsp;<span class="ident" id="3220083">variable</span>&nbsp;<span class="op" id="3220092">:=</span>&nbsp;<span class="keyword" id="3220095">range</span>&nbsp;<span class="ident" id="3220101">pipe</span><span class="op" id="3220105">.</span><span class="ident" id="3220106">Decl</span>&nbsp;<span class="op" id="3220111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3220115">s</span><span class="op" id="3220116">.</span><span class="ident" id="3220117">push</span><span class="op" id="3220121">(</span><span class="ident" id="3220122">variable</span><span class="op" id="3220130">.</span><span class="ident" id="3220131">Ident</span><span class="op" id="3220136">[</span><span class="num" id="3220137">0</span><span class="op" id="3220138">]</span><span class="op" id="3220139">,</span>&nbsp;<span class="ident" id="3220141">value</span><span class="op" id="3220146">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3220149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220152">return</span>&nbsp;<span class="ident" id="3220159">value</span><br>
<span class="lineno"></span><span class="op" id="3220165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3220168">func</span>&nbsp;<span class="op" id="3220173">(</span><span class="ident" id="3220174">s</span>&nbsp;<span class="op" id="3220176">*</span><span class="ident" id="3220177">state</span><span class="op" id="3220182">)</span>&nbsp;<span class="ident" id="3220184">notAFunction</span><span class="op" id="3220196">(</span><span class="ident" id="3220197">args</span>&nbsp;<span class="op" id="3220202">[</span><span class="op" id="3220203">]</span><span class="ident" id="3220204">parse</span><span class="op" id="3220209">.</span><span class="ident" id="3220210">Node</span><span class="op" id="3220214">,</span>&nbsp;<span class="ident" id="3220216">final</span>&nbsp;<span class="ident" id="3220222">reflect</span><span class="op" id="3220229">.</span><span class="ident" id="3220230">Value</span><span class="op" id="3220235">)</span>&nbsp;<span class="op" id="3220237">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220240">if</span>&nbsp;<span class="builtinfunc" id="3220243">len</span><span class="op" id="3220246">(</span><span class="ident" id="3220247">args</span><span class="op" id="3220251">)</span>&nbsp;<span class="op" id="3220253">&gt;</span>&nbsp;<span class="num" id="3220255">1</span>&nbsp;<span class="op" id="3220257">||</span>&nbsp;<span class="ident" id="3220260">final</span><span class="op" id="3220265">.</span><span class="ident" id="3220266">IsValid</span><span class="op" id="3220273">(</span><span class="op" id="3220274">)</span>&nbsp;<span class="op" id="3220276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3220280">s</span><span class="op" id="3220281">.</span><span class="ident" id="3220282">errorf</span><span class="op" id="3220288">(</span><span class="string" id="3220289">&#34;can&#39;t&nbsp;give&nbsp;argument&nbsp;to&nbsp;non-function&nbsp;%s&#34;</span><span class="op" id="3220329">,</span>&nbsp;<span class="ident" id="3220331">args</span><span class="op" id="3220335">[</span><span class="num" id="3220336">0</span><span class="op" id="3220337">]</span><span class="op" id="3220338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3220341">}</span><br>
<span class="lineno"></span><span class="op" id="3220343">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="3220346">func</span>&nbsp;<span class="op" id="3220351">(</span><span class="ident" id="3220352">s</span>&nbsp;<span class="op" id="3220354">*</span><span class="ident" id="3220355">state</span><span class="op" id="3220360">)</span>&nbsp;<span class="ident" id="3220362">evalCommand</span><span class="op" id="3220373">(</span><span class="ident" id="3220374">dot</span>&nbsp;<span class="ident" id="3220378">reflect</span><span class="op" id="3220385">.</span><span class="ident" id="3220386">Value</span><span class="op" id="3220391">,</span>&nbsp;<span class="ident" id="3220393">cmd</span>&nbsp;<span class="op" id="3220397">*</span><span class="ident" id="3220398">parse</span><span class="op" id="3220403">.</span><span class="ident" id="3220404">CommandNode</span><span class="op" id="3220415">,</span>&nbsp;<span class="ident" id="3220417">final</span>&nbsp;<span class="ident" id="3220423">reflect</span><span class="op" id="3220430">.</span><span class="ident" id="3220431">Value</span><span class="op" id="3220436">)</span>&nbsp;<span class="ident" id="3220438">reflect</span><span class="op" id="3220445">.</span><span class="ident" id="3220446">Value</span>&nbsp;<span class="op" id="3220452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3220455">firstWord</span>&nbsp;<span class="op" id="3220465">:=</span>&nbsp;<span class="ident" id="3220468">cmd</span><span class="op" id="3220471">.</span><span class="ident" id="3220472">Args</span><span class="op" id="3220476">[</span><span class="num" id="3220477">0</span><span class="op" id="3220478">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220481">switch</span>&nbsp;<span class="ident" id="3220488">n</span>&nbsp;<span class="op" id="3220490">:=</span>&nbsp;<span class="ident" id="3220493">firstWord</span><span class="op" id="3220502">.</span><span class="op" id="3220503">(</span><span class="keyword" id="3220504">type</span><span class="op" id="3220508">)</span>&nbsp;<span class="op" id="3220510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220513">case</span>&nbsp;<span class="op" id="3220518">*</span><span class="ident" id="3220519">parse</span><span class="op" id="3220524">.</span><span class="ident" id="3220525">FieldNode</span><span class="op" id="3220534">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220538">return</span>&nbsp;<span class="ident" id="3220545">s</span><span class="op" id="3220546">.</span><span class="ident" id="3220547">evalFieldNode</span><span class="op" id="3220560">(</span><span class="ident" id="3220561">dot</span><span class="op" id="3220564">,</span>&nbsp;<span class="ident" id="3220566">n</span><span class="op" id="3220567">,</span>&nbsp;<span class="ident" id="3220569">cmd</span><span class="op" id="3220572">.</span><span class="ident" id="3220573">Args</span><span class="op" id="3220577">,</span>&nbsp;<span class="ident" id="3220579">final</span><span class="op" id="3220584">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220587">case</span>&nbsp;<span class="op" id="3220592">*</span><span class="ident" id="3220593">parse</span><span class="op" id="3220598">.</span><span class="ident" id="3220599">ChainNode</span><span class="op" id="3220608">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220612">return</span>&nbsp;<span class="ident" id="3220619">s</span><span class="op" id="3220620">.</span><span class="ident" id="3220621">evalChainNode</span><span class="op" id="3220634">(</span><span class="ident" id="3220635">dot</span><span class="op" id="3220638">,</span>&nbsp;<span class="ident" id="3220640">n</span><span class="op" id="3220641">,</span>&nbsp;<span class="ident" id="3220643">cmd</span><span class="op" id="3220646">.</span><span class="ident" id="3220647">Args</span><span class="op" id="3220651">,</span>&nbsp;<span class="ident" id="3220653">final</span><span class="op" id="3220658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220661">case</span>&nbsp;<span class="op" id="3220666">*</span><span class="ident" id="3220667">parse</span><span class="op" id="3220672">.</span><span class="ident" id="3220673">IdentifierNode</span><span class="op" id="3220687">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3220691">//&nbsp;Must&nbsp;be&nbsp;a&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220716">return</span>&nbsp;<span class="ident" id="3220723">s</span><span class="op" id="3220724">.</span><span class="ident" id="3220725">evalFunction</span><span class="op" id="3220737">(</span><span class="ident" id="3220738">dot</span><span class="op" id="3220741">,</span>&nbsp;<span class="ident" id="3220743">n</span><span class="op" id="3220744">,</span>&nbsp;<span class="ident" id="3220746">cmd</span><span class="op" id="3220749">,</span>&nbsp;<span class="ident" id="3220751">cmd</span><span class="op" id="3220754">.</span><span class="ident" id="3220755">Args</span><span class="op" id="3220759">,</span>&nbsp;<span class="ident" id="3220761">final</span><span class="op" id="3220766">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220769">case</span>&nbsp;<span class="op" id="3220774">*</span><span class="ident" id="3220775">parse</span><span class="op" id="3220780">.</span><span class="ident" id="3220781">PipeNode</span><span class="op" id="3220789">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3220793">//&nbsp;Parenthesized&nbsp;pipeline.&nbsp;The&nbsp;arguments&nbsp;are&nbsp;all&nbsp;inside&nbsp;the&nbsp;pipeline;&nbsp;final&nbsp;is&nbsp;ignored.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220883">return</span>&nbsp;<span class="ident" id="3220890">s</span><span class="op" id="3220891">.</span><span class="ident" id="3220892">evalPipeline</span><span class="op" id="3220904">(</span><span class="ident" id="3220905">dot</span><span class="op" id="3220908">,</span>&nbsp;<span class="ident" id="3220910">n</span><span class="op" id="3220911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220914">case</span>&nbsp;<span class="op" id="3220919">*</span><span class="ident" id="3220920">parse</span><span class="op" id="3220925">.</span><span class="ident" id="3220926">VariableNode</span><span class="op" id="3220938">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3220942">return</span>&nbsp;<span class="ident" id="3220949">s</span><span class="op" id="3220950">.</span><span class="ident" id="3220951">evalVariableNode</span><span class="op" id="3220967">(</span><span class="ident" id="3220968">dot</span><span class="op" id="3220971">,</span>&nbsp;<span class="ident" id="3220973">n</span><span class="op" id="3220974">,</span>&nbsp;<span class="ident" id="3220976">cmd</span><span class="op" id="3220979">.</span><span class="ident" id="3220980">Args</span><span class="op" id="3220984">,</span>&nbsp;<span class="ident" id="3220986">final</span><span class="op" id="3220991">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3220994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3220997">s</span><span class="op" id="3220998">.</span><span class="ident" id="3220999">at</span><span class="op" id="3221001">(</span><span class="ident" id="3221002">firstWord</span><span class="op" id="3221011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3221014">s</span><span class="op" id="3221015">.</span><span class="ident" id="3221016">notAFunction</span><span class="op" id="3221028">(</span><span class="ident" id="3221029">cmd</span><span class="op" id="3221032">.</span><span class="ident" id="3221033">Args</span><span class="op" id="3221037">,</span>&nbsp;<span class="ident" id="3221039">final</span><span class="op" id="3221044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3221047">switch</span>&nbsp;<span class="ident" id="3221054">word</span>&nbsp;<span class="op" id="3221059">:=</span>&nbsp;<span class="ident" id="3221062">firstWord</span><span class="op" id="3221071">.</span><span class="op" id="3221072">(</span><span class="keyword" id="3221073">type</span><span class="op" id="3221077">)</span>&nbsp;<span class="op" id="3221079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3221082">case</span>&nbsp;<span class="op" id="3221087">*</span><span class="ident" id="3221088">parse</span><span class="op" id="3221093">.</span><span class="ident" id="3221094">BoolNode</span><span class="op" id="3221102">:</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3221106">return</span>&nbsp;<span class="ident" id="3221113">reflect</span><span class="op" id="3221120">.</span><span class="ident" id="3221121">ValueOf</span><span class="op" id="3221128">(</span><span class="ident" id="3221129">word</span><span class="op" id="3221133">.</span><span class="ident" id="3221134">True</span><span class="op" id="3221138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3221141">case</span>&nbsp;<span class="op" id="3221146">*</span><span class="ident" id="3221147">parse</span><span class="op" id="3221152">.</span><span class="ident" id="3221153">DotNode</span><span class="op" id="3221160">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3221164">return</span>&nbsp;<span class="ident" id="3221171">dot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3221176">case</span>&nbsp;<span class="op" id="3221181">*</span><span class="ident" id="3221182">parse</span><span class="op" id="3221187">.</span><span class="ident" id="3221188">NilNode</span><span class="op" id="3221195">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3221199">s</span><span class="op" id="3221200">.</span><span class="ident" id="3221201">errorf</span><span class="op" id="3221207">(</span><span class="string" id="3221208">&#34;nil&nbsp;is&nbsp;not&nbsp;a&nbsp;command&#34;</span><span class="op" id="3221230">)</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3221233">case</span>&nbsp;<span class="op" id="3221238">*</span><span class="ident" id="3221239">parse</span><span class="op" id="3221244">.</span><span class="ident" id="3221245">NumberNode</span><span class="op" id="3221255">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3221259">return</span>&nbsp;<span class="ident" id="3221266">s</span><span class="op" id="3221267">.</span><span class="ident" id="3221268">idealConstant</span><span class="op" id="3221281">(</span><span class="ident" id="3221282">word</span><span class="op" id="3221286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3221289">case</span>&nbsp;<span class="op" id="3221294">*</span><span class="ident" id="3221295">parse</span><span class="op" id="3221300">.</span><span class="ident" id="3221301">StringNode</span><span class="op" id="3221311">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3221315">return</span>&nbsp;<span class="ident" id="3221322">reflect</span><span class="op" id="3221329">.</span><span class="ident" id="3221330">ValueOf</span><span class="op" id="3221337">(</span><span class="ident" id="3221338">word</span><span class="op" id="3221342">.</span><span class="ident" id="3221343">Text</span><span class="op" id="3221347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3221350">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3221353">s</span><span class="op" id="3221354">.</span><span class="ident" id="3221355">errorf</span><span class="op" id="3221361">(</span><span class="string" id="3221362">&#34;can&#39;t&nbsp;evaluate&nbsp;command&nbsp;%q&#34;</span><span class="op" id="3221389">,</span>&nbsp;<span class="ident" id="3221391">firstWord</span><span class="op" id="3221400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3221403">panic</span><span class="op" id="3221408">(</span><span class="string" id="3221409">&#34;not&nbsp;reached&#34;</span><span class="op" id="3221422">)</span><br>
<span class="lineno"></span><span class="op" id="3221424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3221427">//&nbsp;idealConstant&nbsp;is&nbsp;called&nbsp;to&nbsp;return&nbsp;the&nbsp;value&nbsp;of&nbsp;a&nbsp;number&nbsp;in&nbsp;a&nbsp;context&nbsp;where</span><br>
<span class="lineno">385</span><span class="comment" id="3221505">//&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;the&nbsp;type.&nbsp;In&nbsp;that&nbsp;case,&nbsp;the&nbsp;syntax&nbsp;of&nbsp;the&nbsp;number&nbsp;tells&nbsp;us</span><br>
<span class="lineno"></span><span class="comment" id="3221580">//&nbsp;its&nbsp;type,&nbsp;and&nbsp;we&nbsp;use&nbsp;Go&nbsp;rules&nbsp;to&nbsp;resolve.&nbsp;&nbsp;Note&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;thing&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="3221657">//&nbsp;a&nbsp;uint&nbsp;ideal&nbsp;constant&nbsp;in&nbsp;this&nbsp;situation&nbsp;-&nbsp;the&nbsp;value&nbsp;must&nbsp;be&nbsp;of&nbsp;int&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="3221733">func</span>&nbsp;<span class="op" id="3221738">(</span><span class="ident" id="3221739">s</span>&nbsp;<span class="op" id="3221741">*</span><span class="ident" id="3221742">state</span><span class="op" id="3221747">)</span>&nbsp;<span class="ident" id="3221749">idealConstant</span><span class="op" id="3221762">(</span><span class="ident" id="3221763">constant</span>&nbsp;<span class="op" id="3221772">*</span><span class="ident" id="3221773">parse</span><span class="op" id="3221778">.</span><span class="ident" id="3221779">NumberNode</span><span class="op" id="3221789">)</span>&nbsp;<span class="ident" id="3221791">reflect</span><span class="op" id="3221798">.</span><span class="ident" id="3221799">Value</span>&nbsp;<span class="op" id="3221805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3221808">//&nbsp;These&nbsp;are&nbsp;ideal&nbsp;constants&nbsp;but&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;the&nbsp;type</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3221865">//&nbsp;and&nbsp;we&nbsp;have&nbsp;no&nbsp;context.&nbsp;&nbsp;(If&nbsp;it&nbsp;was&nbsp;a&nbsp;method&nbsp;argument,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3221924">//&nbsp;we&#39;d&nbsp;know&nbsp;what&nbsp;we&nbsp;need.)&nbsp;The&nbsp;syntax&nbsp;guides&nbsp;us&nbsp;to&nbsp;some&nbsp;extent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3221990">s</span><span class="op" id="3221991">.</span><span class="ident" id="3221992">at</span><span class="op" id="3221994">(</span><span class="ident" id="3221995">constant</span><span class="op" id="3222003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3222006">switch</span>&nbsp;<span class="op" id="3222013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3222016">case</span>&nbsp;<span class="ident" id="3222021">constant</span><span class="op" id="3222029">.</span><span class="ident" id="3222030">IsComplex</span><span class="op" id="3222039">:</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3222043">return</span>&nbsp;<span class="ident" id="3222050">reflect</span><span class="op" id="3222057">.</span><span class="ident" id="3222058">ValueOf</span><span class="op" id="3222065">(</span><span class="ident" id="3222066">constant</span><span class="op" id="3222074">.</span><span class="ident" id="3222075">Complex128</span><span class="op" id="3222085">)</span>&nbsp;<span class="comment" id="3222087">//&nbsp;incontrovertible.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3222109">case</span>&nbsp;<span class="ident" id="3222114">constant</span><span class="op" id="3222122">.</span><span class="ident" id="3222123">IsFloat</span>&nbsp;<span class="op" id="3222131">&amp;&amp;</span>&nbsp;<span class="op" id="3222134">!</span><span class="ident" id="3222135">isHexConstant</span><span class="op" id="3222148">(</span><span class="ident" id="3222149">constant</span><span class="op" id="3222157">.</span><span class="ident" id="3222158">Text</span><span class="op" id="3222162">)</span>&nbsp;<span class="op" id="3222164">&amp;&amp;</span>&nbsp;<span class="ident" id="3222167">strings</span><span class="op" id="3222174">.</span><span class="ident" id="3222175">IndexAny</span><span class="op" id="3222183">(</span><span class="ident" id="3222184">constant</span><span class="op" id="3222192">.</span><span class="ident" id="3222193">Text</span><span class="op" id="3222197">,</span>&nbsp;<span class="string" id="3222199">&#34;.eE&#34;</span><span class="op" id="3222204">)</span>&nbsp;<span class="op" id="3222206">&gt;=</span>&nbsp;<span class="num" id="3222209">0</span><span class="op" id="3222210">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3222214">return</span>&nbsp;<span class="ident" id="3222221">reflect</span><span class="op" id="3222228">.</span><span class="ident" id="3222229">ValueOf</span><span class="op" id="3222236">(</span><span class="ident" id="3222237">constant</span><span class="op" id="3222245">.</span><span class="ident" id="3222246">Float64</span><span class="op" id="3222253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3222256">case</span>&nbsp;<span class="ident" id="3222261">constant</span><span class="op" id="3222269">.</span><span class="ident" id="3222270">IsInt</span><span class="op" id="3222275">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3222279">n</span>&nbsp;<span class="op" id="3222281">:=</span>&nbsp;<span class="builtintype" id="3222284">int</span><span class="op" id="3222287">(</span><span class="ident" id="3222288">constant</span><span class="op" id="3222296">.</span><span class="ident" id="3222297">Int64</span><span class="op" id="3222302">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3222306">if</span>&nbsp;<span class="ident" id="3222309">int64</span><span class="op" id="3222314">(</span><span class="ident" id="3222315">n</span><span class="op" id="3222316">)</span>&nbsp;<span class="op" id="3222318">!=</span>&nbsp;<span class="ident" id="3222321">constant</span><span class="op" id="3222329">.</span><span class="ident" id="3222330">Int64</span>&nbsp;<span class="op" id="3222336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3222341">s</span><span class="op" id="3222342">.</span><span class="ident" id="3222343">errorf</span><span class="op" id="3222349">(</span><span class="string" id="3222350">&#34;%s&nbsp;overflows&nbsp;int&#34;</span><span class="op" id="3222368">,</span>&nbsp;<span class="ident" id="3222370">constant</span><span class="op" id="3222378">.</span><span class="ident" id="3222379">Text</span><span class="op" id="3222383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3222387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3222391">return</span>&nbsp;<span class="ident" id="3222398">reflect</span><span class="op" id="3222405">.</span><span class="ident" id="3222406">ValueOf</span><span class="op" id="3222413">(</span><span class="ident" id="3222414">n</span><span class="op" id="3222415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3222418">case</span>&nbsp;<span class="ident" id="3222423">constant</span><span class="op" id="3222431">.</span><span class="ident" id="3222432">IsUint</span><span class="op" id="3222438">:</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3222442">s</span><span class="op" id="3222443">.</span><span class="ident" id="3222444">errorf</span><span class="op" id="3222450">(</span><span class="string" id="3222451">&#34;%s&nbsp;overflows&nbsp;int&#34;</span><span class="op" id="3222469">,</span>&nbsp;<span class="ident" id="3222471">constant</span><span class="op" id="3222479">.</span><span class="ident" id="3222480">Text</span><span class="op" id="3222484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3222487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3222490">return</span>&nbsp;<span class="ident" id="3222497">zero</span><br>
<span class="lineno"></span><span class="op" id="3222502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span><span class="keyword" id="3222505">func</span>&nbsp;<span class="ident" id="3222510">isHexConstant</span><span class="op" id="3222523">(</span><span class="ident" id="3222524">s</span>&nbsp;<span class="builtintype" id="3222526">string</span><span class="op" id="3222532">)</span>&nbsp;<span class="builtintype" id="3222534">bool</span>&nbsp;<span class="op" id="3222539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3222542">return</span>&nbsp;<span class="builtinfunc" id="3222549">len</span><span class="op" id="3222552">(</span><span class="ident" id="3222553">s</span><span class="op" id="3222554">)</span>&nbsp;<span class="op" id="3222556">&gt;</span>&nbsp;<span class="num" id="3222558">2</span>&nbsp;<span class="op" id="3222560">&amp;&amp;</span>&nbsp;<span class="ident" id="3222563">s</span><span class="op" id="3222564">[</span><span class="num" id="3222565">0</span><span class="op" id="3222566">]</span>&nbsp;<span class="op" id="3222568">==</span>&nbsp;<span class="string" id="3222571">&#39;0&#39;</span>&nbsp;<span class="op" id="3222575">&amp;&amp;</span>&nbsp;<span class="op" id="3222578">(</span><span class="ident" id="3222579">s</span><span class="op" id="3222580">[</span><span class="num" id="3222581">1</span><span class="op" id="3222582">]</span>&nbsp;<span class="op" id="3222584">==</span>&nbsp;<span class="string" id="3222587">&#39;x&#39;</span>&nbsp;<span class="op" id="3222591">||</span>&nbsp;<span class="ident" id="3222594">s</span><span class="op" id="3222595">[</span><span class="num" id="3222596">1</span><span class="op" id="3222597">]</span>&nbsp;<span class="op" id="3222599">==</span>&nbsp;<span class="string" id="3222602">&#39;X&#39;</span><span class="op" id="3222605">)</span><br>
<span class="lineno"></span><span class="op" id="3222607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3222610">func</span>&nbsp;<span class="op" id="3222615">(</span><span class="ident" id="3222616">s</span>&nbsp;<span class="op" id="3222618">*</span><span class="ident" id="3222619">state</span><span class="op" id="3222624">)</span>&nbsp;<span class="ident" id="3222626">evalFieldNode</span><span class="op" id="3222639">(</span><span class="ident" id="3222640">dot</span>&nbsp;<span class="ident" id="3222644">reflect</span><span class="op" id="3222651">.</span><span class="ident" id="3222652">Value</span><span class="op" id="3222657">,</span>&nbsp;<span class="ident" id="3222659">field</span>&nbsp;<span class="op" id="3222665">*</span><span class="ident" id="3222666">parse</span><span class="op" id="3222671">.</span><span class="ident" id="3222672">FieldNode</span><span class="op" id="3222681">,</span>&nbsp;<span class="ident" id="3222683">args</span>&nbsp;<span class="op" id="3222688">[</span><span class="op" id="3222689">]</span><span class="ident" id="3222690">parse</span><span class="op" id="3222695">.</span><span class="ident" id="3222696">Node</span><span class="op" id="3222700">,</span>&nbsp;<span class="ident" id="3222702">final</span>&nbsp;<span class="ident" id="3222708">reflect</span><span class="op" id="3222715">.</span><span class="ident" id="3222716">Value</span><span class="op" id="3222721">)</span>&nbsp;<span class="ident" id="3222723">reflect</span><span class="op" id="3222730">.</span><span class="ident" id="3222731">Value</span>&nbsp;<span class="op" id="3222737">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3222740">s</span><span class="op" id="3222741">.</span><span class="ident" id="3222742">at</span><span class="op" id="3222744">(</span><span class="ident" id="3222745">field</span><span class="op" id="3222750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3222753">return</span>&nbsp;<span class="ident" id="3222760">s</span><span class="op" id="3222761">.</span><span class="ident" id="3222762">evalFieldChain</span><span class="op" id="3222776">(</span><span class="ident" id="3222777">dot</span><span class="op" id="3222780">,</span>&nbsp;<span class="ident" id="3222782">dot</span><span class="op" id="3222785">,</span>&nbsp;<span class="ident" id="3222787">field</span><span class="op" id="3222792">,</span>&nbsp;<span class="ident" id="3222794">field</span><span class="op" id="3222799">.</span><span class="ident" id="3222800">Ident</span><span class="op" id="3222805">,</span>&nbsp;<span class="ident" id="3222807">args</span><span class="op" id="3222811">,</span>&nbsp;<span class="ident" id="3222813">final</span><span class="op" id="3222818">)</span><br>
<span class="lineno"></span><span class="op" id="3222820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3222823">func</span>&nbsp;<span class="op" id="3222828">(</span><span class="ident" id="3222829">s</span>&nbsp;<span class="op" id="3222831">*</span><span class="ident" id="3222832">state</span><span class="op" id="3222837">)</span>&nbsp;<span class="ident" id="3222839">evalChainNode</span><span class="op" id="3222852">(</span><span class="ident" id="3222853">dot</span>&nbsp;<span class="ident" id="3222857">reflect</span><span class="op" id="3222864">.</span><span class="ident" id="3222865">Value</span><span class="op" id="3222870">,</span>&nbsp;<span class="ident" id="3222872">chain</span>&nbsp;<span class="op" id="3222878">*</span><span class="ident" id="3222879">parse</span><span class="op" id="3222884">.</span><span class="ident" id="3222885">ChainNode</span><span class="op" id="3222894">,</span>&nbsp;<span class="ident" id="3222896">args</span>&nbsp;<span class="op" id="3222901">[</span><span class="op" id="3222902">]</span><span class="ident" id="3222903">parse</span><span class="op" id="3222908">.</span><span class="ident" id="3222909">Node</span><span class="op" id="3222913">,</span>&nbsp;<span class="ident" id="3222915">final</span>&nbsp;<span class="ident" id="3222921">reflect</span><span class="op" id="3222928">.</span><span class="ident" id="3222929">Value</span><span class="op" id="3222934">)</span>&nbsp;<span class="ident" id="3222936">reflect</span><span class="op" id="3222943">.</span><span class="ident" id="3222944">Value</span>&nbsp;<span class="op" id="3222950">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3222953">s</span><span class="op" id="3222954">.</span><span class="ident" id="3222955">at</span><span class="op" id="3222957">(</span><span class="ident" id="3222958">chain</span><span class="op" id="3222963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3222966">//&nbsp;(pipe).Field1.Field2&nbsp;has&nbsp;pipe&nbsp;as&nbsp;.Node,&nbsp;fields&nbsp;as&nbsp;.Field.&nbsp;Eval&nbsp;the&nbsp;pipeline,&nbsp;then&nbsp;the&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3223064">pipe</span>&nbsp;<span class="op" id="3223069">:=</span>&nbsp;<span class="ident" id="3223072">s</span><span class="op" id="3223073">.</span><span class="ident" id="3223074">evalArg</span><span class="op" id="3223081">(</span><span class="ident" id="3223082">dot</span><span class="op" id="3223085">,</span>&nbsp;<span class="ident" id="3223087">nil</span><span class="op" id="3223090">,</span>&nbsp;<span class="ident" id="3223092">chain</span><span class="op" id="3223097">.</span><span class="ident" id="3223098">Node</span><span class="op" id="3223102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3223105">if</span>&nbsp;<span class="builtinfunc" id="3223108">len</span><span class="op" id="3223111">(</span><span class="ident" id="3223112">chain</span><span class="op" id="3223117">.</span><span class="ident" id="3223118">Field</span><span class="op" id="3223123">)</span>&nbsp;<span class="op" id="3223125">==</span>&nbsp;<span class="num" id="3223128">0</span>&nbsp;<span class="op" id="3223130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3223134">s</span><span class="op" id="3223135">.</span><span class="ident" id="3223136">errorf</span><span class="op" id="3223142">(</span><span class="string" id="3223143">&#34;internal&nbsp;error:&nbsp;no&nbsp;fields&nbsp;in&nbsp;evalChainNode&#34;</span><span class="op" id="3223187">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3223190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3223193">return</span>&nbsp;<span class="ident" id="3223200">s</span><span class="op" id="3223201">.</span><span class="ident" id="3223202">evalFieldChain</span><span class="op" id="3223216">(</span><span class="ident" id="3223217">dot</span><span class="op" id="3223220">,</span>&nbsp;<span class="ident" id="3223222">pipe</span><span class="op" id="3223226">,</span>&nbsp;<span class="ident" id="3223228">chain</span><span class="op" id="3223233">,</span>&nbsp;<span class="ident" id="3223235">chain</span><span class="op" id="3223240">.</span><span class="ident" id="3223241">Field</span><span class="op" id="3223246">,</span>&nbsp;<span class="ident" id="3223248">args</span><span class="op" id="3223252">,</span>&nbsp;<span class="ident" id="3223254">final</span><span class="op" id="3223259">)</span><br>
<span class="lineno"></span><span class="op" id="3223261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3223264">func</span>&nbsp;<span class="op" id="3223269">(</span><span class="ident" id="3223270">s</span>&nbsp;<span class="op" id="3223272">*</span><span class="ident" id="3223273">state</span><span class="op" id="3223278">)</span>&nbsp;<span class="ident" id="3223280">evalVariableNode</span><span class="op" id="3223296">(</span><span class="ident" id="3223297">dot</span>&nbsp;<span class="ident" id="3223301">reflect</span><span class="op" id="3223308">.</span><span class="ident" id="3223309">Value</span><span class="op" id="3223314">,</span>&nbsp;<span class="ident" id="3223316">variable</span>&nbsp;<span class="op" id="3223325">*</span><span class="ident" id="3223326">parse</span><span class="op" id="3223331">.</span><span class="ident" id="3223332">VariableNode</span><span class="op" id="3223344">,</span>&nbsp;<span class="ident" id="3223346">args</span>&nbsp;<span class="op" id="3223351">[</span><span class="op" id="3223352">]</span><span class="ident" id="3223353">parse</span><span class="op" id="3223358">.</span><span class="ident" id="3223359">Node</span><span class="op" id="3223363">,</span>&nbsp;<span class="ident" id="3223365">final</span>&nbsp;<span class="ident" id="3223371">reflect</span><span class="op" id="3223378">.</span><span class="ident" id="3223379">Value</span><span class="op" id="3223384">)</span>&nbsp;<span class="ident" id="3223386">reflect</span><span class="op" id="3223393">.</span><span class="ident" id="3223394">Value</span>&nbsp;<span class="op" id="3223400">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3223403">//&nbsp;$x.Field&nbsp;has&nbsp;$x&nbsp;as&nbsp;the&nbsp;first&nbsp;ident,&nbsp;Field&nbsp;as&nbsp;the&nbsp;second.&nbsp;Eval&nbsp;the&nbsp;var,&nbsp;then&nbsp;the&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3223495">s</span><span class="op" id="3223496">.</span><span class="ident" id="3223497">at</span><span class="op" id="3223499">(</span><span class="ident" id="3223500">variable</span><span class="op" id="3223508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3223511">value</span>&nbsp;<span class="op" id="3223517">:=</span>&nbsp;<span class="ident" id="3223520">s</span><span class="op" id="3223521">.</span><span class="ident" id="3223522">varValue</span><span class="op" id="3223530">(</span><span class="ident" id="3223531">variable</span><span class="op" id="3223539">.</span><span class="ident" id="3223540">Ident</span><span class="op" id="3223545">[</span><span class="num" id="3223546">0</span><span class="op" id="3223547">]</span><span class="op" id="3223548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3223551">if</span>&nbsp;<span class="builtinfunc" id="3223554">len</span><span class="op" id="3223557">(</span><span class="ident" id="3223558">variable</span><span class="op" id="3223566">.</span><span class="ident" id="3223567">Ident</span><span class="op" id="3223572">)</span>&nbsp;<span class="op" id="3223574">==</span>&nbsp;<span class="num" id="3223577">1</span>&nbsp;<span class="op" id="3223579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3223583">s</span><span class="op" id="3223584">.</span><span class="ident" id="3223585">notAFunction</span><span class="op" id="3223597">(</span><span class="ident" id="3223598">args</span><span class="op" id="3223602">,</span>&nbsp;<span class="ident" id="3223604">final</span><span class="op" id="3223609">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3223613">return</span>&nbsp;<span class="ident" id="3223620">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3223627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3223630">return</span>&nbsp;<span class="ident" id="3223637">s</span><span class="op" id="3223638">.</span><span class="ident" id="3223639">evalFieldChain</span><span class="op" id="3223653">(</span><span class="ident" id="3223654">dot</span><span class="op" id="3223657">,</span>&nbsp;<span class="ident" id="3223659">value</span><span class="op" id="3223664">,</span>&nbsp;<span class="ident" id="3223666">variable</span><span class="op" id="3223674">,</span>&nbsp;<span class="ident" id="3223676">variable</span><span class="op" id="3223684">.</span><span class="ident" id="3223685">Ident</span><span class="op" id="3223690">[</span><span class="num" id="3223691">1</span><span class="op" id="3223692">:</span><span class="op" id="3223693">]</span><span class="op" id="3223694">,</span>&nbsp;<span class="ident" id="3223696">args</span><span class="op" id="3223700">,</span>&nbsp;<span class="ident" id="3223702">final</span><span class="op" id="3223707">)</span><br>
<span class="lineno"></span><span class="op" id="3223709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="comment" id="3223712">//&nbsp;evalFieldChain&nbsp;evaluates&nbsp;.X.Y.Z&nbsp;possibly&nbsp;followed&nbsp;by&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="comment" id="3223779">//&nbsp;dot&nbsp;is&nbsp;the&nbsp;environment&nbsp;in&nbsp;which&nbsp;to&nbsp;evaluate&nbsp;arguments,&nbsp;while</span><br>
<span class="lineno"></span><span class="comment" id="3223843">//&nbsp;receiver&nbsp;is&nbsp;the&nbsp;value&nbsp;being&nbsp;walked&nbsp;along&nbsp;the&nbsp;chain.</span><br>
<span class="lineno"></span><span class="keyword" id="3223898">func</span>&nbsp;<span class="op" id="3223903">(</span><span class="ident" id="3223904">s</span>&nbsp;<span class="op" id="3223906">*</span><span class="ident" id="3223907">state</span><span class="op" id="3223912">)</span>&nbsp;<span class="ident" id="3223914">evalFieldChain</span><span class="op" id="3223928">(</span><span class="ident" id="3223929">dot</span><span class="op" id="3223932">,</span>&nbsp;<span class="ident" id="3223934">receiver</span>&nbsp;<span class="ident" id="3223943">reflect</span><span class="op" id="3223950">.</span><span class="ident" id="3223951">Value</span><span class="op" id="3223956">,</span>&nbsp;<span class="ident" id="3223958">node</span>&nbsp;<span class="ident" id="3223963">parse</span><span class="op" id="3223968">.</span><span class="ident" id="3223969">Node</span><span class="op" id="3223973">,</span>&nbsp;<span class="ident" id="3223975">ident</span>&nbsp;<span class="op" id="3223981">[</span><span class="op" id="3223982">]</span><span class="builtintype" id="3223983">string</span><span class="op" id="3223989">,</span>&nbsp;<span class="ident" id="3223991">args</span>&nbsp;<span class="op" id="3223996">[</span><span class="op" id="3223997">]</span><span class="ident" id="3223998">parse</span><span class="op" id="3224003">.</span><span class="ident" id="3224004">Node</span><span class="op" id="3224008">,</span>&nbsp;<span class="ident" id="3224010">final</span>&nbsp;<span class="ident" id="3224016">reflect</span><span class="op" id="3224023">.</span><span class="ident" id="3224024">Value</span><span class="op" id="3224029">)</span>&nbsp;<span class="ident" id="3224031">reflect</span><span class="op" id="3224038">.</span><span class="ident" id="3224039">Value</span>&nbsp;<span class="op" id="3224045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3224048">n</span>&nbsp;<span class="op" id="3224050">:=</span>&nbsp;<span class="builtinfunc" id="3224053">len</span><span class="op" id="3224056">(</span><span class="ident" id="3224057">ident</span><span class="op" id="3224062">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3224065">for</span>&nbsp;<span class="ident" id="3224069">i</span>&nbsp;<span class="op" id="3224071">:=</span>&nbsp;<span class="num" id="3224074">0</span><span class="op" id="3224075">;</span>&nbsp;<span class="ident" id="3224077">i</span>&nbsp;<span class="op" id="3224079">&lt;</span>&nbsp;<span class="ident" id="3224081">n</span><span class="op" id="3224082">-</span><span class="num" id="3224083">1</span><span class="op" id="3224084">;</span>&nbsp;<span class="ident" id="3224086">i</span><span class="op" id="3224087">++</span>&nbsp;<span class="op" id="3224090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3224094">receiver</span>&nbsp;<span class="op" id="3224103">=</span>&nbsp;<span class="ident" id="3224105">s</span><span class="op" id="3224106">.</span><span class="ident" id="3224107">evalField</span><span class="op" id="3224116">(</span><span class="ident" id="3224117">dot</span><span class="op" id="3224120">,</span>&nbsp;<span class="ident" id="3224122">ident</span><span class="op" id="3224127">[</span><span class="ident" id="3224128">i</span><span class="op" id="3224129">]</span><span class="op" id="3224130">,</span>&nbsp;<span class="ident" id="3224132">node</span><span class="op" id="3224136">,</span>&nbsp;<span class="ident" id="3224138">nil</span><span class="op" id="3224141">,</span>&nbsp;<span class="ident" id="3224143">zero</span><span class="op" id="3224147">,</span>&nbsp;<span class="ident" id="3224149">receiver</span><span class="op" id="3224157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3224160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3224163">//&nbsp;Now&nbsp;if&nbsp;it&#39;s&nbsp;a&nbsp;method,&nbsp;it&nbsp;gets&nbsp;the&nbsp;arguments.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3224212">return</span>&nbsp;<span class="ident" id="3224219">s</span><span class="op" id="3224220">.</span><span class="ident" id="3224221">evalField</span><span class="op" id="3224230">(</span><span class="ident" id="3224231">dot</span><span class="op" id="3224234">,</span>&nbsp;<span class="ident" id="3224236">ident</span><span class="op" id="3224241">[</span><span class="ident" id="3224242">n</span><span class="op" id="3224243">-</span><span class="num" id="3224244">1</span><span class="op" id="3224245">]</span><span class="op" id="3224246">,</span>&nbsp;<span class="ident" id="3224248">node</span><span class="op" id="3224252">,</span>&nbsp;<span class="ident" id="3224254">args</span><span class="op" id="3224258">,</span>&nbsp;<span class="ident" id="3224260">final</span><span class="op" id="3224265">,</span>&nbsp;<span class="ident" id="3224267">receiver</span><span class="op" id="3224275">)</span><br>
<span class="lineno">450</span><span class="op" id="3224277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3224280">func</span>&nbsp;<span class="op" id="3224285">(</span><span class="ident" id="3224286">s</span>&nbsp;<span class="op" id="3224288">*</span><span class="ident" id="3224289">state</span><span class="op" id="3224294">)</span>&nbsp;<span class="ident" id="3224296">evalFunction</span><span class="op" id="3224308">(</span><span class="ident" id="3224309">dot</span>&nbsp;<span class="ident" id="3224313">reflect</span><span class="op" id="3224320">.</span><span class="ident" id="3224321">Value</span><span class="op" id="3224326">,</span>&nbsp;<span class="ident" id="3224328">node</span>&nbsp;<span class="op" id="3224333">*</span><span class="ident" id="3224334">parse</span><span class="op" id="3224339">.</span><span class="ident" id="3224340">IdentifierNode</span><span class="op" id="3224354">,</span>&nbsp;<span class="ident" id="3224356">cmd</span>&nbsp;<span class="ident" id="3224360">parse</span><span class="op" id="3224365">.</span><span class="ident" id="3224366">Node</span><span class="op" id="3224370">,</span>&nbsp;<span class="ident" id="3224372">args</span>&nbsp;<span class="op" id="3224377">[</span><span class="op" id="3224378">]</span><span class="ident" id="3224379">parse</span><span class="op" id="3224384">.</span><span class="ident" id="3224385">Node</span><span class="op" id="3224389">,</span>&nbsp;<span class="ident" id="3224391">final</span>&nbsp;<span class="ident" id="3224397">reflect</span><span class="op" id="3224404">.</span><span class="ident" id="3224405">Value</span><span class="op" id="3224410">)</span>&nbsp;<span class="ident" id="3224412">reflect</span><span class="op" id="3224419">.</span><span class="ident" id="3224420">Value</span>&nbsp;<span class="op" id="3224426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3224429">s</span><span class="op" id="3224430">.</span><span class="ident" id="3224431">at</span><span class="op" id="3224433">(</span><span class="ident" id="3224434">node</span><span class="op" id="3224438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3224441">name</span>&nbsp;<span class="op" id="3224446">:=</span>&nbsp;<span class="ident" id="3224449">node</span><span class="op" id="3224453">.</span><span class="ident" id="3224454">Ident</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3224461">function</span><span class="op" id="3224469">,</span>&nbsp;<span class="ident" id="3224471">ok</span>&nbsp;<span class="op" id="3224474">:=</span>&nbsp;<span class="ident" id="3224477">findFunction</span><span class="op" id="3224489">(</span><span class="ident" id="3224490">name</span><span class="op" id="3224494">,</span>&nbsp;<span class="ident" id="3224496">s</span><span class="op" id="3224497">.</span><span class="ident" id="3224498">tmpl</span><span class="op" id="3224502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3224505">if</span>&nbsp;<span class="op" id="3224508">!</span><span class="ident" id="3224509">ok</span>&nbsp;<span class="op" id="3224512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3224516">s</span><span class="op" id="3224517">.</span><span class="ident" id="3224518">errorf</span><span class="op" id="3224524">(</span><span class="string" id="3224525">&#34;%q&nbsp;is&nbsp;not&nbsp;a&nbsp;defined&nbsp;function&#34;</span><span class="op" id="3224555">,</span>&nbsp;<span class="ident" id="3224557">name</span><span class="op" id="3224561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3224564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3224567">return</span>&nbsp;<span class="ident" id="3224574">s</span><span class="op" id="3224575">.</span><span class="ident" id="3224576">evalCall</span><span class="op" id="3224584">(</span><span class="ident" id="3224585">dot</span><span class="op" id="3224588">,</span>&nbsp;<span class="ident" id="3224590">function</span><span class="op" id="3224598">,</span>&nbsp;<span class="ident" id="3224600">cmd</span><span class="op" id="3224603">,</span>&nbsp;<span class="ident" id="3224605">name</span><span class="op" id="3224609">,</span>&nbsp;<span class="ident" id="3224611">args</span><span class="op" id="3224615">,</span>&nbsp;<span class="ident" id="3224617">final</span><span class="op" id="3224622">)</span><br>
<span class="lineno">460</span><span class="op" id="3224624">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3224627">//&nbsp;evalField&nbsp;evaluates&nbsp;an&nbsp;expression&nbsp;like&nbsp;(.Field)&nbsp;or&nbsp;(.Field&nbsp;arg1&nbsp;arg2).</span><br>
<span class="lineno"></span><span class="comment" id="3224701">//&nbsp;The&nbsp;&#39;final&#39;&nbsp;argument&nbsp;represents&nbsp;the&nbsp;return&nbsp;value&nbsp;from&nbsp;the&nbsp;preceding</span><br>
<span class="lineno"></span><span class="comment" id="3224772">//&nbsp;value&nbsp;of&nbsp;the&nbsp;pipeline,&nbsp;if&nbsp;any.</span><br>
<span class="lineno">465</span><span class="keyword" id="3224806">func</span>&nbsp;<span class="op" id="3224811">(</span><span class="ident" id="3224812">s</span>&nbsp;<span class="op" id="3224814">*</span><span class="ident" id="3224815">state</span><span class="op" id="3224820">)</span>&nbsp;<span class="ident" id="3224822">evalField</span><span class="op" id="3224831">(</span><span class="ident" id="3224832">dot</span>&nbsp;<span class="ident" id="3224836">reflect</span><span class="op" id="3224843">.</span><span class="ident" id="3224844">Value</span><span class="op" id="3224849">,</span>&nbsp;<span class="ident" id="3224851">fieldName</span>&nbsp;<span class="builtintype" id="3224861">string</span><span class="op" id="3224867">,</span>&nbsp;<span class="ident" id="3224869">node</span>&nbsp;<span class="ident" id="3224874">parse</span><span class="op" id="3224879">.</span><span class="ident" id="3224880">Node</span><span class="op" id="3224884">,</span>&nbsp;<span class="ident" id="3224886">args</span>&nbsp;<span class="op" id="3224891">[</span><span class="op" id="3224892">]</span><span class="ident" id="3224893">parse</span><span class="op" id="3224898">.</span><span class="ident" id="3224899">Node</span><span class="op" id="3224903">,</span>&nbsp;<span class="ident" id="3224905">final</span><span class="op" id="3224910">,</span>&nbsp;<span class="ident" id="3224912">receiver</span>&nbsp;<span class="ident" id="3224921">reflect</span><span class="op" id="3224928">.</span><span class="ident" id="3224929">Value</span><span class="op" id="3224934">)</span>&nbsp;<span class="ident" id="3224936">reflect</span><span class="op" id="3224943">.</span><span class="ident" id="3224944">Value</span>&nbsp;<span class="op" id="3224950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3224953">if</span>&nbsp;<span class="op" id="3224956">!</span><span class="ident" id="3224957">receiver</span><span class="op" id="3224965">.</span><span class="ident" id="3224966">IsValid</span><span class="op" id="3224973">(</span><span class="op" id="3224974">)</span>&nbsp;<span class="op" id="3224976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3224980">return</span>&nbsp;<span class="ident" id="3224987">zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3224993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3224996">typ</span>&nbsp;<span class="op" id="3225000">:=</span>&nbsp;<span class="ident" id="3225003">receiver</span><span class="op" id="3225011">.</span><span class="ident" id="3225012">Type</span><span class="op" id="3225016">(</span><span class="op" id="3225017">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3225020">receiver</span><span class="op" id="3225028">,</span>&nbsp;<span class="ident" id="3225030">_</span>&nbsp;<span class="op" id="3225032">=</span>&nbsp;<span class="ident" id="3225034">indirect</span><span class="op" id="3225042">(</span><span class="ident" id="3225043">receiver</span><span class="op" id="3225051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3225054">//&nbsp;Unless&nbsp;it&#39;s&nbsp;an&nbsp;interface,&nbsp;need&nbsp;to&nbsp;get&nbsp;to&nbsp;a&nbsp;value&nbsp;of&nbsp;type&nbsp;*T&nbsp;to&nbsp;guarantee</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3225131">//&nbsp;we&nbsp;see&nbsp;all&nbsp;methods&nbsp;of&nbsp;T&nbsp;and&nbsp;*T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3225167">ptr</span>&nbsp;<span class="op" id="3225171">:=</span>&nbsp;<span class="ident" id="3225174">receiver</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3225184">if</span>&nbsp;<span class="ident" id="3225187">ptr</span><span class="op" id="3225190">.</span><span class="ident" id="3225191">Kind</span><span class="op" id="3225195">(</span><span class="op" id="3225196">)</span>&nbsp;<span class="op" id="3225198">!=</span>&nbsp;<span class="ident" id="3225201">reflect</span><span class="op" id="3225208">.</span><span class="ident" id="3225209">Interface</span>&nbsp;<span class="op" id="3225219">&amp;&amp;</span>&nbsp;<span class="ident" id="3225222">ptr</span><span class="op" id="3225225">.</span><span class="ident" id="3225226">CanAddr</span><span class="op" id="3225233">(</span><span class="op" id="3225234">)</span>&nbsp;<span class="op" id="3225236">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3225240">ptr</span>&nbsp;<span class="op" id="3225244">=</span>&nbsp;<span class="ident" id="3225246">ptr</span><span class="op" id="3225249">.</span><span class="ident" id="3225250">Addr</span><span class="op" id="3225254">(</span><span class="op" id="3225255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3225258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3225261">if</span>&nbsp;<span class="ident" id="3225264">method</span>&nbsp;<span class="op" id="3225271">:=</span>&nbsp;<span class="ident" id="3225274">ptr</span><span class="op" id="3225277">.</span><span class="ident" id="3225278">MethodByName</span><span class="op" id="3225290">(</span><span class="ident" id="3225291">fieldName</span><span class="op" id="3225300">)</span><span class="op" id="3225301">;</span>&nbsp;<span class="ident" id="3225303">method</span><span class="op" id="3225309">.</span><span class="ident" id="3225310">IsValid</span><span class="op" id="3225317">(</span><span class="op" id="3225318">)</span>&nbsp;<span class="op" id="3225320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3225324">return</span>&nbsp;<span class="ident" id="3225331">s</span><span class="op" id="3225332">.</span><span class="ident" id="3225333">evalCall</span><span class="op" id="3225341">(</span><span class="ident" id="3225342">dot</span><span class="op" id="3225345">,</span>&nbsp;<span class="ident" id="3225347">method</span><span class="op" id="3225353">,</span>&nbsp;<span class="ident" id="3225355">node</span><span class="op" id="3225359">,</span>&nbsp;<span class="ident" id="3225361">fieldName</span><span class="op" id="3225370">,</span>&nbsp;<span class="ident" id="3225372">args</span><span class="op" id="3225376">,</span>&nbsp;<span class="ident" id="3225378">final</span><span class="op" id="3225383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3225386">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3225389">hasArgs</span>&nbsp;<span class="op" id="3225397">:=</span>&nbsp;<span class="builtinfunc" id="3225400">len</span><span class="op" id="3225403">(</span><span class="ident" id="3225404">args</span><span class="op" id="3225408">)</span>&nbsp;<span class="op" id="3225410">&gt;</span>&nbsp;<span class="num" id="3225412">1</span>&nbsp;<span class="op" id="3225414">||</span>&nbsp;<span class="ident" id="3225417">final</span><span class="op" id="3225422">.</span><span class="ident" id="3225423">IsValid</span><span class="op" id="3225430">(</span><span class="op" id="3225431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3225434">//&nbsp;It&#39;s&nbsp;not&nbsp;a&nbsp;method;&nbsp;must&nbsp;be&nbsp;a&nbsp;field&nbsp;of&nbsp;a&nbsp;struct&nbsp;or&nbsp;an&nbsp;element&nbsp;of&nbsp;a&nbsp;map.&nbsp;The&nbsp;receiver&nbsp;must&nbsp;not&nbsp;be&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3225539">receiver</span><span class="op" id="3225547">,</span>&nbsp;<span class="ident" id="3225549">isNil</span>&nbsp;<span class="op" id="3225555">:=</span>&nbsp;<span class="ident" id="3225558">indirect</span><span class="op" id="3225566">(</span><span class="ident" id="3225567">receiver</span><span class="op" id="3225575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3225578">if</span>&nbsp;<span class="ident" id="3225581">isNil</span>&nbsp;<span class="op" id="3225587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3225591">s</span><span class="op" id="3225592">.</span><span class="ident" id="3225593">errorf</span><span class="op" id="3225599">(</span><span class="string" id="3225600">&#34;nil&nbsp;pointer&nbsp;evaluating&nbsp;%s.%s&#34;</span><span class="op" id="3225630">,</span>&nbsp;<span class="ident" id="3225632">typ</span><span class="op" id="3225635">,</span>&nbsp;<span class="ident" id="3225637">fieldName</span><span class="op" id="3225646">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3225649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3225652">switch</span>&nbsp;<span class="ident" id="3225659">receiver</span><span class="op" id="3225667">.</span><span class="ident" id="3225668">Kind</span><span class="op" id="3225672">(</span><span class="op" id="3225673">)</span>&nbsp;<span class="op" id="3225675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3225678">case</span>&nbsp;<span class="ident" id="3225683">reflect</span><span class="op" id="3225690">.</span><span class="ident" id="3225691">Struct</span><span class="op" id="3225697">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3225701">tField</span><span class="op" id="3225707">,</span>&nbsp;<span class="ident" id="3225709">ok</span>&nbsp;<span class="op" id="3225712">:=</span>&nbsp;<span class="ident" id="3225715">receiver</span><span class="op" id="3225723">.</span><span class="ident" id="3225724">Type</span><span class="op" id="3225728">(</span><span class="op" id="3225729">)</span><span class="op" id="3225730">.</span><span class="ident" id="3225731">FieldByName</span><span class="op" id="3225742">(</span><span class="ident" id="3225743">fieldName</span><span class="op" id="3225752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3225756">if</span>&nbsp;<span class="ident" id="3225759">ok</span>&nbsp;<span class="op" id="3225762">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3225767">field</span>&nbsp;<span class="op" id="3225773">:=</span>&nbsp;<span class="ident" id="3225776">receiver</span><span class="op" id="3225784">.</span><span class="ident" id="3225785">FieldByIndex</span><span class="op" id="3225797">(</span><span class="ident" id="3225798">tField</span><span class="op" id="3225804">.</span><span class="ident" id="3225805">Index</span><span class="op" id="3225810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3225815">if</span>&nbsp;<span class="ident" id="3225818">tField</span><span class="op" id="3225824">.</span><span class="ident" id="3225825">PkgPath</span>&nbsp;<span class="op" id="3225833">!=</span>&nbsp;<span class="string" id="3225836">&#34;&#34;</span>&nbsp;<span class="op" id="3225839">{</span>&nbsp;<span class="comment" id="3225841">//&nbsp;field&nbsp;is&nbsp;unexported</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3225868">s</span><span class="op" id="3225869">.</span><span class="ident" id="3225870">errorf</span><span class="op" id="3225876">(</span><span class="string" id="3225877">&#34;%s&nbsp;is&nbsp;an&nbsp;unexported&nbsp;field&nbsp;of&nbsp;struct&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3225922">,</span>&nbsp;<span class="ident" id="3225924">fieldName</span><span class="op" id="3225933">,</span>&nbsp;<span class="ident" id="3225935">typ</span><span class="op" id="3225938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3225943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3225948">//&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;function,&nbsp;we&nbsp;must&nbsp;call&nbsp;it.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3225991">if</span>&nbsp;<span class="ident" id="3225994">hasArgs</span>&nbsp;<span class="op" id="3226002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3226008">s</span><span class="op" id="3226009">.</span><span class="ident" id="3226010">errorf</span><span class="op" id="3226016">(</span><span class="string" id="3226017">&#34;%s&nbsp;has&nbsp;arguments&nbsp;but&nbsp;cannot&nbsp;be&nbsp;invoked&nbsp;as&nbsp;function&#34;</span><span class="op" id="3226069">,</span>&nbsp;<span class="ident" id="3226071">fieldName</span><span class="op" id="3226080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3226085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3226090">return</span>&nbsp;<span class="ident" id="3226097">field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3226105">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3226109">s</span><span class="op" id="3226110">.</span><span class="ident" id="3226111">errorf</span><span class="op" id="3226117">(</span><span class="string" id="3226118">&#34;%s&nbsp;is&nbsp;not&nbsp;a&nbsp;field&nbsp;of&nbsp;struct&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3226155">,</span>&nbsp;<span class="ident" id="3226157">fieldName</span><span class="op" id="3226166">,</span>&nbsp;<span class="ident" id="3226168">typ</span><span class="op" id="3226171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3226174">case</span>&nbsp;<span class="ident" id="3226179">reflect</span><span class="op" id="3226186">.</span><span class="ident" id="3226187">Map</span><span class="op" id="3226190">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3226194">//&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;map,&nbsp;attempt&nbsp;to&nbsp;use&nbsp;the&nbsp;field&nbsp;name&nbsp;as&nbsp;a&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3226254">nameVal</span>&nbsp;<span class="op" id="3226262">:=</span>&nbsp;<span class="ident" id="3226265">reflect</span><span class="op" id="3226272">.</span><span class="ident" id="3226273">ValueOf</span><span class="op" id="3226280">(</span><span class="ident" id="3226281">fieldName</span><span class="op" id="3226290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3226294">if</span>&nbsp;<span class="ident" id="3226297">nameVal</span><span class="op" id="3226304">.</span><span class="ident" id="3226305">Type</span><span class="op" id="3226309">(</span><span class="op" id="3226310">)</span><span class="op" id="3226311">.</span><span class="ident" id="3226312">AssignableTo</span><span class="op" id="3226324">(</span><span class="ident" id="3226325">receiver</span><span class="op" id="3226333">.</span><span class="ident" id="3226334">Type</span><span class="op" id="3226338">(</span><span class="op" id="3226339">)</span><span class="op" id="3226340">.</span><span class="ident" id="3226341">Key</span><span class="op" id="3226344">(</span><span class="op" id="3226345">)</span><span class="op" id="3226346">)</span>&nbsp;<span class="op" id="3226348">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3226353">if</span>&nbsp;<span class="ident" id="3226356">hasArgs</span>&nbsp;<span class="op" id="3226364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3226370">s</span><span class="op" id="3226371">.</span><span class="ident" id="3226372">errorf</span><span class="op" id="3226378">(</span><span class="string" id="3226379">&#34;%s&nbsp;is&nbsp;not&nbsp;a&nbsp;method&nbsp;but&nbsp;has&nbsp;arguments&#34;</span><span class="op" id="3226417">,</span>&nbsp;<span class="ident" id="3226419">fieldName</span><span class="op" id="3226428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3226433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3226438">return</span>&nbsp;<span class="ident" id="3226445">receiver</span><span class="op" id="3226453">.</span><span class="ident" id="3226454">MapIndex</span><span class="op" id="3226462">(</span><span class="ident" id="3226463">nameVal</span><span class="op" id="3226470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3226474">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3226477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3226480">s</span><span class="op" id="3226481">.</span><span class="ident" id="3226482">errorf</span><span class="op" id="3226488">(</span><span class="string" id="3226489">&#34;can&#39;t&nbsp;evaluate&nbsp;field&nbsp;%s&nbsp;in&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3226525">,</span>&nbsp;<span class="ident" id="3226527">fieldName</span><span class="op" id="3226536">,</span>&nbsp;<span class="ident" id="3226538">typ</span><span class="op" id="3226541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3226544">panic</span><span class="op" id="3226549">(</span><span class="string" id="3226550">&#34;not&nbsp;reached&#34;</span><span class="op" id="3226563">)</span><br>
<span class="lineno"></span><span class="op" id="3226565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="keyword" id="3226568">var</span>&nbsp;<span class="op" id="3226572">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3226575">errorType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3226591">=</span>&nbsp;<span class="ident" id="3226593">reflect</span><span class="op" id="3226600">.</span><span class="ident" id="3226601">TypeOf</span><span class="op" id="3226607">(</span><span class="op" id="3226608">(</span><span class="op" id="3226609">*</span><span class="builtintype" id="3226610">error</span><span class="op" id="3226615">)</span><span class="op" id="3226616">(</span><span class="ident" id="3226617">nil</span><span class="op" id="3226620">)</span><span class="op" id="3226621">)</span><span class="op" id="3226622">.</span><span class="ident" id="3226623">Elem</span><span class="op" id="3226627">(</span><span class="op" id="3226628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3226631">fmtStringerType</span>&nbsp;<span class="op" id="3226647">=</span>&nbsp;<span class="ident" id="3226649">reflect</span><span class="op" id="3226656">.</span><span class="ident" id="3226657">TypeOf</span><span class="op" id="3226663">(</span><span class="op" id="3226664">(</span><span class="op" id="3226665">*</span><span class="ident" id="3226666">fmt</span><span class="op" id="3226669">.</span><span class="ident" id="3226670">Stringer</span><span class="op" id="3226678">)</span><span class="op" id="3226679">(</span><span class="ident" id="3226680">nil</span><span class="op" id="3226683">)</span><span class="op" id="3226684">)</span><span class="op" id="3226685">.</span><span class="ident" id="3226686">Elem</span><span class="op" id="3226690">(</span><span class="op" id="3226691">)</span><br>
<span class="lineno"></span><span class="op" id="3226693">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">520</span><span class="comment" id="3226696">//&nbsp;evalCall&nbsp;executes&nbsp;a&nbsp;function&nbsp;or&nbsp;method&nbsp;call.&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;method,&nbsp;fun&nbsp;already&nbsp;has&nbsp;the&nbsp;receiver&nbsp;bound,&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="3226801">//&nbsp;it&nbsp;looks&nbsp;just&nbsp;like&nbsp;a&nbsp;function&nbsp;call.&nbsp;&nbsp;The&nbsp;arg&nbsp;list,&nbsp;if&nbsp;non-nil,&nbsp;includes&nbsp;(in&nbsp;the&nbsp;manner&nbsp;of&nbsp;the&nbsp;shell),&nbsp;arg[0]</span><br>
<span class="lineno"></span><span class="comment" id="3226913">//&nbsp;as&nbsp;the&nbsp;function&nbsp;itself.</span><br>
<span class="lineno"></span><span class="keyword" id="3226940">func</span>&nbsp;<span class="op" id="3226945">(</span><span class="ident" id="3226946">s</span>&nbsp;<span class="op" id="3226948">*</span><span class="ident" id="3226949">state</span><span class="op" id="3226954">)</span>&nbsp;<span class="ident" id="3226956">evalCall</span><span class="op" id="3226964">(</span><span class="ident" id="3226965">dot</span><span class="op" id="3226968">,</span>&nbsp;<span class="ident" id="3226970">fun</span>&nbsp;<span class="ident" id="3226974">reflect</span><span class="op" id="3226981">.</span><span class="ident" id="3226982">Value</span><span class="op" id="3226987">,</span>&nbsp;<span class="ident" id="3226989">node</span>&nbsp;<span class="ident" id="3226994">parse</span><span class="op" id="3226999">.</span><span class="ident" id="3227000">Node</span><span class="op" id="3227004">,</span>&nbsp;<span class="ident" id="3227006">name</span>&nbsp;<span class="builtintype" id="3227011">string</span><span class="op" id="3227017">,</span>&nbsp;<span class="ident" id="3227019">args</span>&nbsp;<span class="op" id="3227024">[</span><span class="op" id="3227025">]</span><span class="ident" id="3227026">parse</span><span class="op" id="3227031">.</span><span class="ident" id="3227032">Node</span><span class="op" id="3227036">,</span>&nbsp;<span class="ident" id="3227038">final</span>&nbsp;<span class="ident" id="3227044">reflect</span><span class="op" id="3227051">.</span><span class="ident" id="3227052">Value</span><span class="op" id="3227057">)</span>&nbsp;<span class="ident" id="3227059">reflect</span><span class="op" id="3227066">.</span><span class="ident" id="3227067">Value</span>&nbsp;<span class="op" id="3227073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3227076">if</span>&nbsp;<span class="ident" id="3227079">args</span>&nbsp;<span class="op" id="3227084">!=</span>&nbsp;<span class="ident" id="3227087">nil</span>&nbsp;<span class="op" id="3227091">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3227095">args</span>&nbsp;<span class="op" id="3227100">=</span>&nbsp;<span class="ident" id="3227102">args</span><span class="op" id="3227106">[</span><span class="num" id="3227107">1</span><span class="op" id="3227108">:</span><span class="op" id="3227109">]</span>&nbsp;<span class="comment" id="3227111">//&nbsp;Zeroth&nbsp;arg&nbsp;is&nbsp;function&nbsp;name/node;&nbsp;not&nbsp;passed&nbsp;to&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3227173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3227176">typ</span>&nbsp;<span class="op" id="3227180">:=</span>&nbsp;<span class="ident" id="3227183">fun</span><span class="op" id="3227186">.</span><span class="ident" id="3227187">Type</span><span class="op" id="3227191">(</span><span class="op" id="3227192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3227195">numIn</span>&nbsp;<span class="op" id="3227201">:=</span>&nbsp;<span class="builtinfunc" id="3227204">len</span><span class="op" id="3227207">(</span><span class="ident" id="3227208">args</span><span class="op" id="3227212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3227215">if</span>&nbsp;<span class="ident" id="3227218">final</span><span class="op" id="3227223">.</span><span class="ident" id="3227224">IsValid</span><span class="op" id="3227231">(</span><span class="op" id="3227232">)</span>&nbsp;<span class="op" id="3227234">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3227238">numIn</span><span class="op" id="3227243">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3227247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3227250">numFixed</span>&nbsp;<span class="op" id="3227259">:=</span>&nbsp;<span class="builtinfunc" id="3227262">len</span><span class="op" id="3227265">(</span><span class="ident" id="3227266">args</span><span class="op" id="3227270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3227273">if</span>&nbsp;<span class="ident" id="3227276">typ</span><span class="op" id="3227279">.</span><span class="ident" id="3227280">IsVariadic</span><span class="op" id="3227290">(</span><span class="op" id="3227291">)</span>&nbsp;<span class="op" id="3227293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3227297">numFixed</span>&nbsp;<span class="op" id="3227306">=</span>&nbsp;<span class="ident" id="3227308">typ</span><span class="op" id="3227311">.</span><span class="ident" id="3227312">NumIn</span><span class="op" id="3227317">(</span><span class="op" id="3227318">)</span>&nbsp;<span class="op" id="3227320">-</span>&nbsp;<span class="num" id="3227322">1</span>&nbsp;<span class="comment" id="3227324">//&nbsp;last&nbsp;arg&nbsp;is&nbsp;the&nbsp;variadic&nbsp;one.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3227359">if</span>&nbsp;<span class="ident" id="3227362">numIn</span>&nbsp;<span class="op" id="3227368">&lt;</span>&nbsp;<span class="ident" id="3227370">numFixed</span>&nbsp;<span class="op" id="3227379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3227384">s</span><span class="op" id="3227385">.</span><span class="ident" id="3227386">errorf</span><span class="op" id="3227392">(</span><span class="string" id="3227393">&#34;wrong&nbsp;number&nbsp;of&nbsp;args&nbsp;for&nbsp;%s:&nbsp;want&nbsp;at&nbsp;least&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="3227447">,</span>&nbsp;<span class="ident" id="3227449">name</span><span class="op" id="3227453">,</span>&nbsp;<span class="ident" id="3227455">typ</span><span class="op" id="3227458">.</span><span class="ident" id="3227459">NumIn</span><span class="op" id="3227464">(</span><span class="op" id="3227465">)</span><span class="op" id="3227466">-</span><span class="num" id="3227467">1</span><span class="op" id="3227468">,</span>&nbsp;<span class="builtinfunc" id="3227470">len</span><span class="op" id="3227473">(</span><span class="ident" id="3227474">args</span><span class="op" id="3227478">)</span><span class="op" id="3227479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3227483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3227486">}</span>&nbsp;<span class="keyword" id="3227488">else</span>&nbsp;<span class="keyword" id="3227493">if</span>&nbsp;<span class="ident" id="3227496">numIn</span>&nbsp;<span class="op" id="3227502">&lt;</span>&nbsp;<span class="ident" id="3227504">typ</span><span class="op" id="3227507">.</span><span class="ident" id="3227508">NumIn</span><span class="op" id="3227513">(</span><span class="op" id="3227514">)</span><span class="op" id="3227515">-</span><span class="num" id="3227516">1</span>&nbsp;<span class="op" id="3227518">||</span>&nbsp;<span class="op" id="3227521">!</span><span class="ident" id="3227522">typ</span><span class="op" id="3227525">.</span><span class="ident" id="3227526">IsVariadic</span><span class="op" id="3227536">(</span><span class="op" id="3227537">)</span>&nbsp;<span class="op" id="3227539">&amp;&amp;</span>&nbsp;<span class="ident" id="3227542">numIn</span>&nbsp;<span class="op" id="3227548">!=</span>&nbsp;<span class="ident" id="3227551">typ</span><span class="op" id="3227554">.</span><span class="ident" id="3227555">NumIn</span><span class="op" id="3227560">(</span><span class="op" id="3227561">)</span>&nbsp;<span class="op" id="3227563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3227567">s</span><span class="op" id="3227568">.</span><span class="ident" id="3227569">errorf</span><span class="op" id="3227575">(</span><span class="string" id="3227576">&#34;wrong&nbsp;number&nbsp;of&nbsp;args&nbsp;for&nbsp;%s:&nbsp;want&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="3227621">,</span>&nbsp;<span class="ident" id="3227623">name</span><span class="op" id="3227627">,</span>&nbsp;<span class="ident" id="3227629">typ</span><span class="op" id="3227632">.</span><span class="ident" id="3227633">NumIn</span><span class="op" id="3227638">(</span><span class="op" id="3227639">)</span><span class="op" id="3227640">,</span>&nbsp;<span class="builtinfunc" id="3227642">len</span><span class="op" id="3227645">(</span><span class="ident" id="3227646">args</span><span class="op" id="3227650">)</span><span class="op" id="3227651">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3227654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3227657">if</span>&nbsp;<span class="op" id="3227660">!</span><span class="ident" id="3227661">goodFunc</span><span class="op" id="3227669">(</span><span class="ident" id="3227670">typ</span><span class="op" id="3227673">)</span>&nbsp;<span class="op" id="3227675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3227679">//&nbsp;TODO:&nbsp;This&nbsp;could&nbsp;still&nbsp;be&nbsp;a&nbsp;confusing&nbsp;error;&nbsp;maybe&nbsp;goodFunc&nbsp;should&nbsp;provide&nbsp;info.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3227765">s</span><span class="op" id="3227766">.</span><span class="ident" id="3227767">errorf</span><span class="op" id="3227773">(</span><span class="string" id="3227774">&#34;can&#39;t&nbsp;call&nbsp;method/function&nbsp;%q&nbsp;with&nbsp;%d&nbsp;results&#34;</span><span class="op" id="3227821">,</span>&nbsp;<span class="ident" id="3227823">name</span><span class="op" id="3227827">,</span>&nbsp;<span class="ident" id="3227829">typ</span><span class="op" id="3227832">.</span><span class="ident" id="3227833">NumOut</span><span class="op" id="3227839">(</span><span class="op" id="3227840">)</span><span class="op" id="3227841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3227844">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3227847">//&nbsp;Build&nbsp;the&nbsp;arg&nbsp;list.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3227871">argv</span>&nbsp;<span class="op" id="3227876">:=</span>&nbsp;<span class="builtinfunc" id="3227879">make</span><span class="op" id="3227883">(</span><span class="op" id="3227884">[</span><span class="op" id="3227885">]</span><span class="ident" id="3227886">reflect</span><span class="op" id="3227893">.</span><span class="ident" id="3227894">Value</span><span class="op" id="3227899">,</span>&nbsp;<span class="ident" id="3227901">numIn</span><span class="op" id="3227906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3227909">//&nbsp;Args&nbsp;must&nbsp;be&nbsp;evaluated.&nbsp;Fixed&nbsp;args&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3227955">i</span>&nbsp;<span class="op" id="3227957">:=</span>&nbsp;<span class="num" id="3227960">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3227963">for</span>&nbsp;<span class="op" id="3227967">;</span>&nbsp;<span class="ident" id="3227969">i</span>&nbsp;<span class="op" id="3227971">&lt;</span>&nbsp;<span class="ident" id="3227973">numFixed</span>&nbsp;<span class="op" id="3227982">&amp;&amp;</span>&nbsp;<span class="ident" id="3227985">i</span>&nbsp;<span class="op" id="3227987">&lt;</span>&nbsp;<span class="builtinfunc" id="3227989">len</span><span class="op" id="3227992">(</span><span class="ident" id="3227993">args</span><span class="op" id="3227997">)</span><span class="op" id="3227998">;</span>&nbsp;<span class="ident" id="3228000">i</span><span class="op" id="3228001">++</span>&nbsp;<span class="op" id="3228004">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3228008">argv</span><span class="op" id="3228012">[</span><span class="ident" id="3228013">i</span><span class="op" id="3228014">]</span>&nbsp;<span class="op" id="3228016">=</span>&nbsp;<span class="ident" id="3228018">s</span><span class="op" id="3228019">.</span><span class="ident" id="3228020">evalArg</span><span class="op" id="3228027">(</span><span class="ident" id="3228028">dot</span><span class="op" id="3228031">,</span>&nbsp;<span class="ident" id="3228033">typ</span><span class="op" id="3228036">.</span><span class="ident" id="3228037">In</span><span class="op" id="3228039">(</span><span class="ident" id="3228040">i</span><span class="op" id="3228041">)</span><span class="op" id="3228042">,</span>&nbsp;<span class="ident" id="3228044">args</span><span class="op" id="3228048">[</span><span class="ident" id="3228049">i</span><span class="op" id="3228050">]</span><span class="op" id="3228051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3228054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3228057">//&nbsp;Now&nbsp;the&nbsp;...&nbsp;args.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3228079">if</span>&nbsp;<span class="ident" id="3228082">typ</span><span class="op" id="3228085">.</span><span class="ident" id="3228086">IsVariadic</span><span class="op" id="3228096">(</span><span class="op" id="3228097">)</span>&nbsp;<span class="op" id="3228099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3228103">argType</span>&nbsp;<span class="op" id="3228111">:=</span>&nbsp;<span class="ident" id="3228114">typ</span><span class="op" id="3228117">.</span><span class="ident" id="3228118">In</span><span class="op" id="3228120">(</span><span class="ident" id="3228121">typ</span><span class="op" id="3228124">.</span><span class="ident" id="3228125">NumIn</span><span class="op" id="3228130">(</span><span class="op" id="3228131">)</span>&nbsp;<span class="op" id="3228133">-</span>&nbsp;<span class="num" id="3228135">1</span><span class="op" id="3228136">)</span><span class="op" id="3228137">.</span><span class="ident" id="3228138">Elem</span><span class="op" id="3228142">(</span><span class="op" id="3228143">)</span>&nbsp;<span class="comment" id="3228145">//&nbsp;Argument&nbsp;is&nbsp;a&nbsp;slice.</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3228171">for</span>&nbsp;<span class="op" id="3228175">;</span>&nbsp;<span class="ident" id="3228177">i</span>&nbsp;<span class="op" id="3228179">&lt;</span>&nbsp;<span class="builtinfunc" id="3228181">len</span><span class="op" id="3228184">(</span><span class="ident" id="3228185">args</span><span class="op" id="3228189">)</span><span class="op" id="3228190">;</span>&nbsp;<span class="ident" id="3228192">i</span><span class="op" id="3228193">++</span>&nbsp;<span class="op" id="3228196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3228201">argv</span><span class="op" id="3228205">[</span><span class="ident" id="3228206">i</span><span class="op" id="3228207">]</span>&nbsp;<span class="op" id="3228209">=</span>&nbsp;<span class="ident" id="3228211">s</span><span class="op" id="3228212">.</span><span class="ident" id="3228213">evalArg</span><span class="op" id="3228220">(</span><span class="ident" id="3228221">dot</span><span class="op" id="3228224">,</span>&nbsp;<span class="ident" id="3228226">argType</span><span class="op" id="3228233">,</span>&nbsp;<span class="ident" id="3228235">args</span><span class="op" id="3228239">[</span><span class="ident" id="3228240">i</span><span class="op" id="3228241">]</span><span class="op" id="3228242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3228246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3228249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3228252">//&nbsp;Add&nbsp;final&nbsp;value&nbsp;if&nbsp;necessary.</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3228286">if</span>&nbsp;<span class="ident" id="3228289">final</span><span class="op" id="3228294">.</span><span class="ident" id="3228295">IsValid</span><span class="op" id="3228302">(</span><span class="op" id="3228303">)</span>&nbsp;<span class="op" id="3228305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3228309">t</span>&nbsp;<span class="op" id="3228311">:=</span>&nbsp;<span class="ident" id="3228314">typ</span><span class="op" id="3228317">.</span><span class="ident" id="3228318">In</span><span class="op" id="3228320">(</span><span class="ident" id="3228321">typ</span><span class="op" id="3228324">.</span><span class="ident" id="3228325">NumIn</span><span class="op" id="3228330">(</span><span class="op" id="3228331">)</span>&nbsp;<span class="op" id="3228333">-</span>&nbsp;<span class="num" id="3228335">1</span><span class="op" id="3228336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3228340">if</span>&nbsp;<span class="ident" id="3228343">typ</span><span class="op" id="3228346">.</span><span class="ident" id="3228347">IsVariadic</span><span class="op" id="3228357">(</span><span class="op" id="3228358">)</span>&nbsp;<span class="op" id="3228360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3228365">t</span>&nbsp;<span class="op" id="3228367">=</span>&nbsp;<span class="ident" id="3228369">t</span><span class="op" id="3228370">.</span><span class="ident" id="3228371">Elem</span><span class="op" id="3228375">(</span><span class="op" id="3228376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3228380">}</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3228384">argv</span><span class="op" id="3228388">[</span><span class="ident" id="3228389">i</span><span class="op" id="3228390">]</span>&nbsp;<span class="op" id="3228392">=</span>&nbsp;<span class="ident" id="3228394">s</span><span class="op" id="3228395">.</span><span class="ident" id="3228396">validateType</span><span class="op" id="3228408">(</span><span class="ident" id="3228409">final</span><span class="op" id="3228414">,</span>&nbsp;<span class="ident" id="3228416">t</span><span class="op" id="3228417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3228420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3228423">result</span>&nbsp;<span class="op" id="3228430">:=</span>&nbsp;<span class="ident" id="3228433">fun</span><span class="op" id="3228436">.</span><span class="ident" id="3228437">Call</span><span class="op" id="3228441">(</span><span class="ident" id="3228442">argv</span><span class="op" id="3228446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3228449">//&nbsp;If&nbsp;we&nbsp;have&nbsp;an&nbsp;error&nbsp;that&nbsp;is&nbsp;not&nbsp;nil,&nbsp;stop&nbsp;execution&nbsp;and&nbsp;return&nbsp;that&nbsp;error&nbsp;to&nbsp;the&nbsp;caller.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3228542">if</span>&nbsp;<span class="builtinfunc" id="3228545">len</span><span class="op" id="3228548">(</span><span class="ident" id="3228549">result</span><span class="op" id="3228555">)</span>&nbsp;<span class="op" id="3228557">==</span>&nbsp;<span class="num" id="3228560">2</span>&nbsp;<span class="op" id="3228562">&amp;&amp;</span>&nbsp;<span class="op" id="3228565">!</span><span class="ident" id="3228566">result</span><span class="op" id="3228572">[</span><span class="num" id="3228573">1</span><span class="op" id="3228574">]</span><span class="op" id="3228575">.</span><span class="ident" id="3228576">IsNil</span><span class="op" id="3228581">(</span><span class="op" id="3228582">)</span>&nbsp;<span class="op" id="3228584">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3228588">s</span><span class="op" id="3228589">.</span><span class="ident" id="3228590">at</span><span class="op" id="3228592">(</span><span class="ident" id="3228593">node</span><span class="op" id="3228597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3228601">s</span><span class="op" id="3228602">.</span><span class="ident" id="3228603">errorf</span><span class="op" id="3228609">(</span><span class="string" id="3228610">&#34;error&nbsp;calling&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="3228632">,</span>&nbsp;<span class="ident" id="3228634">name</span><span class="op" id="3228638">,</span>&nbsp;<span class="ident" id="3228640">result</span><span class="op" id="3228646">[</span><span class="num" id="3228647">1</span><span class="op" id="3228648">]</span><span class="op" id="3228649">.</span><span class="ident" id="3228650">Interface</span><span class="op" id="3228659">(</span><span class="op" id="3228660">)</span><span class="op" id="3228661">.</span><span class="op" id="3228662">(</span><span class="builtintype" id="3228663">error</span><span class="op" id="3228668">)</span><span class="op" id="3228669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3228672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3228675">return</span>&nbsp;<span class="ident" id="3228682">result</span><span class="op" id="3228688">[</span><span class="num" id="3228689">0</span><span class="op" id="3228690">]</span><br>
<span class="lineno"></span><span class="op" id="3228692">}</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span><span class="comment" id="3228695">//&nbsp;canBeNil&nbsp;reports&nbsp;whether&nbsp;an&nbsp;untyped&nbsp;nil&nbsp;can&nbsp;be&nbsp;assigned&nbsp;to&nbsp;the&nbsp;type.&nbsp;See&nbsp;reflect.Zero.</span><br>
<span class="lineno"></span><span class="keyword" id="3228785">func</span>&nbsp;<span class="ident" id="3228790">canBeNil</span><span class="op" id="3228798">(</span><span class="ident" id="3228799">typ</span>&nbsp;<span class="ident" id="3228803">reflect</span><span class="op" id="3228810">.</span><span class="ident" id="3228811">Type</span><span class="op" id="3228815">)</span>&nbsp;<span class="builtintype" id="3228817">bool</span>&nbsp;<span class="op" id="3228822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3228825">switch</span>&nbsp;<span class="ident" id="3228832">typ</span><span class="op" id="3228835">.</span><span class="ident" id="3228836">Kind</span><span class="op" id="3228840">(</span><span class="op" id="3228841">)</span>&nbsp;<span class="op" id="3228843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3228846">case</span>&nbsp;<span class="ident" id="3228851">reflect</span><span class="op" id="3228858">.</span><span class="ident" id="3228859">Chan</span><span class="op" id="3228863">,</span>&nbsp;<span class="ident" id="3228865">reflect</span><span class="op" id="3228872">.</span><span class="ident" id="3228873">Func</span><span class="op" id="3228877">,</span>&nbsp;<span class="ident" id="3228879">reflect</span><span class="op" id="3228886">.</span><span class="ident" id="3228887">Interface</span><span class="op" id="3228896">,</span>&nbsp;<span class="ident" id="3228898">reflect</span><span class="op" id="3228905">.</span><span class="ident" id="3228906">Map</span><span class="op" id="3228909">,</span>&nbsp;<span class="ident" id="3228911">reflect</span><span class="op" id="3228918">.</span><span class="ident" id="3228919">Ptr</span><span class="op" id="3228922">,</span>&nbsp;<span class="ident" id="3228924">reflect</span><span class="op" id="3228931">.</span><span class="ident" id="3228932">Slice</span><span class="op" id="3228937">:</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3228941">return</span>&nbsp;<span class="builtintype" id="3228948">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3228954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3228957">return</span>&nbsp;<span class="builtintype" id="3228964">false</span><br>
<span class="lineno"></span><span class="op" id="3228970">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span><span class="comment" id="3228973">//&nbsp;validateType&nbsp;guarantees&nbsp;that&nbsp;the&nbsp;value&nbsp;is&nbsp;valid&nbsp;and&nbsp;assignable&nbsp;to&nbsp;the&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="3229052">func</span>&nbsp;<span class="op" id="3229057">(</span><span class="ident" id="3229058">s</span>&nbsp;<span class="op" id="3229060">*</span><span class="ident" id="3229061">state</span><span class="op" id="3229066">)</span>&nbsp;<span class="ident" id="3229068">validateType</span><span class="op" id="3229080">(</span><span class="ident" id="3229081">value</span>&nbsp;<span class="ident" id="3229087">reflect</span><span class="op" id="3229094">.</span><span class="ident" id="3229095">Value</span><span class="op" id="3229100">,</span>&nbsp;<span class="ident" id="3229102">typ</span>&nbsp;<span class="ident" id="3229106">reflect</span><span class="op" id="3229113">.</span><span class="ident" id="3229114">Type</span><span class="op" id="3229118">)</span>&nbsp;<span class="ident" id="3229120">reflect</span><span class="op" id="3229127">.</span><span class="ident" id="3229128">Value</span>&nbsp;<span class="op" id="3229134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3229137">if</span>&nbsp;<span class="op" id="3229140">!</span><span class="ident" id="3229141">value</span><span class="op" id="3229146">.</span><span class="ident" id="3229147">IsValid</span><span class="op" id="3229154">(</span><span class="op" id="3229155">)</span>&nbsp;<span class="op" id="3229157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3229161">if</span>&nbsp;<span class="ident" id="3229164">typ</span>&nbsp;<span class="op" id="3229168">==</span>&nbsp;<span class="ident" id="3229171">nil</span>&nbsp;<span class="op" id="3229175">||</span>&nbsp;<span class="ident" id="3229178">canBeNil</span><span class="op" id="3229186">(</span><span class="ident" id="3229187">typ</span><span class="op" id="3229190">)</span>&nbsp;<span class="op" id="3229192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3229197">//&nbsp;An&nbsp;untyped&nbsp;nil&nbsp;interface{}.&nbsp;Accept&nbsp;as&nbsp;a&nbsp;proper&nbsp;nil&nbsp;value.</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3229261">return</span>&nbsp;<span class="ident" id="3229268">reflect</span><span class="op" id="3229275">.</span><span class="ident" id="3229276">Zero</span><span class="op" id="3229280">(</span><span class="ident" id="3229281">typ</span><span class="op" id="3229284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3229288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3229292">s</span><span class="op" id="3229293">.</span><span class="ident" id="3229294">errorf</span><span class="op" id="3229300">(</span><span class="string" id="3229301">&#34;invalid&nbsp;value;&nbsp;expected&nbsp;%s&#34;</span><span class="op" id="3229329">,</span>&nbsp;<span class="ident" id="3229331">typ</span><span class="op" id="3229334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3229337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3229340">if</span>&nbsp;<span class="ident" id="3229343">typ</span>&nbsp;<span class="op" id="3229347">!=</span>&nbsp;<span class="ident" id="3229350">nil</span>&nbsp;<span class="op" id="3229354">&amp;&amp;</span>&nbsp;<span class="op" id="3229357">!</span><span class="ident" id="3229358">value</span><span class="op" id="3229363">.</span><span class="ident" id="3229364">Type</span><span class="op" id="3229368">(</span><span class="op" id="3229369">)</span><span class="op" id="3229370">.</span><span class="ident" id="3229371">AssignableTo</span><span class="op" id="3229383">(</span><span class="ident" id="3229384">typ</span><span class="op" id="3229387">)</span>&nbsp;<span class="op" id="3229389">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3229393">if</span>&nbsp;<span class="ident" id="3229396">value</span><span class="op" id="3229401">.</span><span class="ident" id="3229402">Kind</span><span class="op" id="3229406">(</span><span class="op" id="3229407">)</span>&nbsp;<span class="op" id="3229409">==</span>&nbsp;<span class="ident" id="3229412">reflect</span><span class="op" id="3229419">.</span><span class="ident" id="3229420">Interface</span>&nbsp;<span class="op" id="3229430">&amp;&amp;</span>&nbsp;<span class="op" id="3229433">!</span><span class="ident" id="3229434">value</span><span class="op" id="3229439">.</span><span class="ident" id="3229440">IsNil</span><span class="op" id="3229445">(</span><span class="op" id="3229446">)</span>&nbsp;<span class="op" id="3229448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3229453">value</span>&nbsp;<span class="op" id="3229459">=</span>&nbsp;<span class="ident" id="3229461">value</span><span class="op" id="3229466">.</span><span class="ident" id="3229467">Elem</span><span class="op" id="3229471">(</span><span class="op" id="3229472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3229477">if</span>&nbsp;<span class="ident" id="3229480">value</span><span class="op" id="3229485">.</span><span class="ident" id="3229486">Type</span><span class="op" id="3229490">(</span><span class="op" id="3229491">)</span><span class="op" id="3229492">.</span><span class="ident" id="3229493">AssignableTo</span><span class="op" id="3229505">(</span><span class="ident" id="3229506">typ</span><span class="op" id="3229509">)</span>&nbsp;<span class="op" id="3229511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3229517">return</span>&nbsp;<span class="ident" id="3229524">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3229533">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3229538">//&nbsp;fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3229555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3229559">//&nbsp;Does&nbsp;one&nbsp;dereference&nbsp;or&nbsp;indirection&nbsp;work?&nbsp;We&nbsp;could&nbsp;do&nbsp;more,&nbsp;as&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3229630">//&nbsp;do&nbsp;with&nbsp;method&nbsp;receivers,&nbsp;but&nbsp;that&nbsp;gets&nbsp;messy&nbsp;and&nbsp;method&nbsp;receivers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3229702">//&nbsp;are&nbsp;much&nbsp;more&nbsp;constrained,&nbsp;so&nbsp;it&nbsp;makes&nbsp;more&nbsp;sense&nbsp;there&nbsp;than&nbsp;here.</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3229774">//&nbsp;Besides,&nbsp;one&nbsp;is&nbsp;almost&nbsp;always&nbsp;all&nbsp;you&nbsp;need.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3229823">switch</span>&nbsp;<span class="op" id="3229830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3229834">case</span>&nbsp;<span class="ident" id="3229839">value</span><span class="op" id="3229844">.</span><span class="ident" id="3229845">Kind</span><span class="op" id="3229849">(</span><span class="op" id="3229850">)</span>&nbsp;<span class="op" id="3229852">==</span>&nbsp;<span class="ident" id="3229855">reflect</span><span class="op" id="3229862">.</span><span class="ident" id="3229863">Ptr</span>&nbsp;<span class="op" id="3229867">&amp;&amp;</span>&nbsp;<span class="ident" id="3229870">value</span><span class="op" id="3229875">.</span><span class="ident" id="3229876">Type</span><span class="op" id="3229880">(</span><span class="op" id="3229881">)</span><span class="op" id="3229882">.</span><span class="ident" id="3229883">Elem</span><span class="op" id="3229887">(</span><span class="op" id="3229888">)</span><span class="op" id="3229889">.</span><span class="ident" id="3229890">AssignableTo</span><span class="op" id="3229902">(</span><span class="ident" id="3229903">typ</span><span class="op" id="3229906">)</span><span class="op" id="3229907">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3229912">value</span>&nbsp;<span class="op" id="3229918">=</span>&nbsp;<span class="ident" id="3229920">value</span><span class="op" id="3229925">.</span><span class="ident" id="3229926">Elem</span><span class="op" id="3229930">(</span><span class="op" id="3229931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3229936">if</span>&nbsp;<span class="op" id="3229939">!</span><span class="ident" id="3229940">value</span><span class="op" id="3229945">.</span><span class="ident" id="3229946">IsValid</span><span class="op" id="3229953">(</span><span class="op" id="3229954">)</span>&nbsp;<span class="op" id="3229956">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3229962">s</span><span class="op" id="3229963">.</span><span class="ident" id="3229964">errorf</span><span class="op" id="3229970">(</span><span class="string" id="3229971">&#34;dereference&nbsp;of&nbsp;nil&nbsp;pointer&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3230010">,</span>&nbsp;<span class="ident" id="3230012">typ</span><span class="op" id="3230015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3230020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230024">case</span>&nbsp;<span class="ident" id="3230029">reflect</span><span class="op" id="3230036">.</span><span class="ident" id="3230037">PtrTo</span><span class="op" id="3230042">(</span><span class="ident" id="3230043">value</span><span class="op" id="3230048">.</span><span class="ident" id="3230049">Type</span><span class="op" id="3230053">(</span><span class="op" id="3230054">)</span><span class="op" id="3230055">)</span><span class="op" id="3230056">.</span><span class="ident" id="3230057">AssignableTo</span><span class="op" id="3230069">(</span><span class="ident" id="3230070">typ</span><span class="op" id="3230073">)</span>&nbsp;<span class="op" id="3230075">&amp;&amp;</span>&nbsp;<span class="ident" id="3230078">value</span><span class="op" id="3230083">.</span><span class="ident" id="3230084">CanAddr</span><span class="op" id="3230091">(</span><span class="op" id="3230092">)</span><span class="op" id="3230093">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3230098">value</span>&nbsp;<span class="op" id="3230104">=</span>&nbsp;<span class="ident" id="3230106">value</span><span class="op" id="3230111">.</span><span class="ident" id="3230112">Addr</span><span class="op" id="3230116">(</span><span class="op" id="3230117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230121">default</span><span class="op" id="3230128">:</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3230133">s</span><span class="op" id="3230134">.</span><span class="ident" id="3230135">errorf</span><span class="op" id="3230141">(</span><span class="string" id="3230142">&#34;wrong&nbsp;type&nbsp;for&nbsp;value;&nbsp;expected&nbsp;%s;&nbsp;got&nbsp;%s&#34;</span><span class="op" id="3230185">,</span>&nbsp;<span class="ident" id="3230187">typ</span><span class="op" id="3230190">,</span>&nbsp;<span class="ident" id="3230192">value</span><span class="op" id="3230197">.</span><span class="ident" id="3230198">Type</span><span class="op" id="3230202">(</span><span class="op" id="3230203">)</span><span class="op" id="3230204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3230208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3230211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230214">return</span>&nbsp;<span class="ident" id="3230221">value</span><br>
<span class="lineno"></span><span class="op" id="3230227">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span><span class="keyword" id="3230230">func</span>&nbsp;<span class="op" id="3230235">(</span><span class="ident" id="3230236">s</span>&nbsp;<span class="op" id="3230238">*</span><span class="ident" id="3230239">state</span><span class="op" id="3230244">)</span>&nbsp;<span class="ident" id="3230246">evalArg</span><span class="op" id="3230253">(</span><span class="ident" id="3230254">dot</span>&nbsp;<span class="ident" id="3230258">reflect</span><span class="op" id="3230265">.</span><span class="ident" id="3230266">Value</span><span class="op" id="3230271">,</span>&nbsp;<span class="ident" id="3230273">typ</span>&nbsp;<span class="ident" id="3230277">reflect</span><span class="op" id="3230284">.</span><span class="ident" id="3230285">Type</span><span class="op" id="3230289">,</span>&nbsp;<span class="ident" id="3230291">n</span>&nbsp;<span class="ident" id="3230293">parse</span><span class="op" id="3230298">.</span><span class="ident" id="3230299">Node</span><span class="op" id="3230303">)</span>&nbsp;<span class="ident" id="3230305">reflect</span><span class="op" id="3230312">.</span><span class="ident" id="3230313">Value</span>&nbsp;<span class="op" id="3230319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3230322">s</span><span class="op" id="3230323">.</span><span class="ident" id="3230324">at</span><span class="op" id="3230326">(</span><span class="ident" id="3230327">n</span><span class="op" id="3230328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230331">switch</span>&nbsp;<span class="ident" id="3230338">arg</span>&nbsp;<span class="op" id="3230342">:=</span>&nbsp;<span class="ident" id="3230345">n</span><span class="op" id="3230346">.</span><span class="op" id="3230347">(</span><span class="keyword" id="3230348">type</span><span class="op" id="3230352">)</span>&nbsp;<span class="op" id="3230354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230357">case</span>&nbsp;<span class="op" id="3230362">*</span><span class="ident" id="3230363">parse</span><span class="op" id="3230368">.</span><span class="ident" id="3230369">DotNode</span><span class="op" id="3230376">:</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230380">return</span>&nbsp;<span class="ident" id="3230387">s</span><span class="op" id="3230388">.</span><span class="ident" id="3230389">validateType</span><span class="op" id="3230401">(</span><span class="ident" id="3230402">dot</span><span class="op" id="3230405">,</span>&nbsp;<span class="ident" id="3230407">typ</span><span class="op" id="3230410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230413">case</span>&nbsp;<span class="op" id="3230418">*</span><span class="ident" id="3230419">parse</span><span class="op" id="3230424">.</span><span class="ident" id="3230425">NilNode</span><span class="op" id="3230432">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230436">if</span>&nbsp;<span class="ident" id="3230439">canBeNil</span><span class="op" id="3230447">(</span><span class="ident" id="3230448">typ</span><span class="op" id="3230451">)</span>&nbsp;<span class="op" id="3230453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230458">return</span>&nbsp;<span class="ident" id="3230465">reflect</span><span class="op" id="3230472">.</span><span class="ident" id="3230473">Zero</span><span class="op" id="3230477">(</span><span class="ident" id="3230478">typ</span><span class="op" id="3230481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3230485">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3230489">s</span><span class="op" id="3230490">.</span><span class="ident" id="3230491">errorf</span><span class="op" id="3230497">(</span><span class="string" id="3230498">&#34;cannot&nbsp;assign&nbsp;nil&nbsp;to&nbsp;%s&#34;</span><span class="op" id="3230523">,</span>&nbsp;<span class="ident" id="3230525">typ</span><span class="op" id="3230528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230531">case</span>&nbsp;<span class="op" id="3230536">*</span><span class="ident" id="3230537">parse</span><span class="op" id="3230542">.</span><span class="ident" id="3230543">FieldNode</span><span class="op" id="3230552">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230556">return</span>&nbsp;<span class="ident" id="3230563">s</span><span class="op" id="3230564">.</span><span class="ident" id="3230565">validateType</span><span class="op" id="3230577">(</span><span class="ident" id="3230578">s</span><span class="op" id="3230579">.</span><span class="ident" id="3230580">evalFieldNode</span><span class="op" id="3230593">(</span><span class="ident" id="3230594">dot</span><span class="op" id="3230597">,</span>&nbsp;<span class="ident" id="3230599">arg</span><span class="op" id="3230602">,</span>&nbsp;<span class="op" id="3230604">[</span><span class="op" id="3230605">]</span><span class="ident" id="3230606">parse</span><span class="op" id="3230611">.</span><span class="ident" id="3230612">Node</span><span class="op" id="3230616">{</span><span class="ident" id="3230617">n</span><span class="op" id="3230618">}</span><span class="op" id="3230619">,</span>&nbsp;<span class="ident" id="3230621">zero</span><span class="op" id="3230625">)</span><span class="op" id="3230626">,</span>&nbsp;<span class="ident" id="3230628">typ</span><span class="op" id="3230631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230634">case</span>&nbsp;<span class="op" id="3230639">*</span><span class="ident" id="3230640">parse</span><span class="op" id="3230645">.</span><span class="ident" id="3230646">VariableNode</span><span class="op" id="3230658">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230662">return</span>&nbsp;<span class="ident" id="3230669">s</span><span class="op" id="3230670">.</span><span class="ident" id="3230671">validateType</span><span class="op" id="3230683">(</span><span class="ident" id="3230684">s</span><span class="op" id="3230685">.</span><span class="ident" id="3230686">evalVariableNode</span><span class="op" id="3230702">(</span><span class="ident" id="3230703">dot</span><span class="op" id="3230706">,</span>&nbsp;<span class="ident" id="3230708">arg</span><span class="op" id="3230711">,</span>&nbsp;<span class="ident" id="3230713">nil</span><span class="op" id="3230716">,</span>&nbsp;<span class="ident" id="3230718">zero</span><span class="op" id="3230722">)</span><span class="op" id="3230723">,</span>&nbsp;<span class="ident" id="3230725">typ</span><span class="op" id="3230728">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230731">case</span>&nbsp;<span class="op" id="3230736">*</span><span class="ident" id="3230737">parse</span><span class="op" id="3230742">.</span><span class="ident" id="3230743">PipeNode</span><span class="op" id="3230751">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230755">return</span>&nbsp;<span class="ident" id="3230762">s</span><span class="op" id="3230763">.</span><span class="ident" id="3230764">validateType</span><span class="op" id="3230776">(</span><span class="ident" id="3230777">s</span><span class="op" id="3230778">.</span><span class="ident" id="3230779">evalPipeline</span><span class="op" id="3230791">(</span><span class="ident" id="3230792">dot</span><span class="op" id="3230795">,</span>&nbsp;<span class="ident" id="3230797">arg</span><span class="op" id="3230800">)</span><span class="op" id="3230801">,</span>&nbsp;<span class="ident" id="3230803">typ</span><span class="op" id="3230806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230809">case</span>&nbsp;<span class="op" id="3230814">*</span><span class="ident" id="3230815">parse</span><span class="op" id="3230820">.</span><span class="ident" id="3230821">IdentifierNode</span><span class="op" id="3230835">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230839">return</span>&nbsp;<span class="ident" id="3230846">s</span><span class="op" id="3230847">.</span><span class="ident" id="3230848">evalFunction</span><span class="op" id="3230860">(</span><span class="ident" id="3230861">dot</span><span class="op" id="3230864">,</span>&nbsp;<span class="ident" id="3230866">arg</span><span class="op" id="3230869">,</span>&nbsp;<span class="ident" id="3230871">arg</span><span class="op" id="3230874">,</span>&nbsp;<span class="ident" id="3230876">nil</span><span class="op" id="3230879">,</span>&nbsp;<span class="ident" id="3230881">zero</span><span class="op" id="3230885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230888">case</span>&nbsp;<span class="op" id="3230893">*</span><span class="ident" id="3230894">parse</span><span class="op" id="3230899">.</span><span class="ident" id="3230900">ChainNode</span><span class="op" id="3230909">:</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230913">return</span>&nbsp;<span class="ident" id="3230920">s</span><span class="op" id="3230921">.</span><span class="ident" id="3230922">validateType</span><span class="op" id="3230934">(</span><span class="ident" id="3230935">s</span><span class="op" id="3230936">.</span><span class="ident" id="3230937">evalChainNode</span><span class="op" id="3230950">(</span><span class="ident" id="3230951">dot</span><span class="op" id="3230954">,</span>&nbsp;<span class="ident" id="3230956">arg</span><span class="op" id="3230959">,</span>&nbsp;<span class="ident" id="3230961">nil</span><span class="op" id="3230964">,</span>&nbsp;<span class="ident" id="3230966">zero</span><span class="op" id="3230970">)</span><span class="op" id="3230971">,</span>&nbsp;<span class="ident" id="3230973">typ</span><span class="op" id="3230976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3230979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3230982">switch</span>&nbsp;<span class="ident" id="3230989">typ</span><span class="op" id="3230992">.</span><span class="ident" id="3230993">Kind</span><span class="op" id="3230997">(</span><span class="op" id="3230998">)</span>&nbsp;<span class="op" id="3231000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3231003">case</span>&nbsp;<span class="ident" id="3231008">reflect</span><span class="op" id="3231015">.</span><span class="ident" id="3231016">Bool</span><span class="op" id="3231020">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3231024">return</span>&nbsp;<span class="ident" id="3231031">s</span><span class="op" id="3231032">.</span><span class="ident" id="3231033">evalBool</span><span class="op" id="3231041">(</span><span class="ident" id="3231042">typ</span><span class="op" id="3231045">,</span>&nbsp;<span class="ident" id="3231047">n</span><span class="op" id="3231048">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3231051">case</span>&nbsp;<span class="ident" id="3231056">reflect</span><span class="op" id="3231063">.</span><span class="ident" id="3231064">Complex64</span><span class="op" id="3231073">,</span>&nbsp;<span class="ident" id="3231075">reflect</span><span class="op" id="3231082">.</span><span class="ident" id="3231083">Complex128</span><span class="op" id="3231093">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3231097">return</span>&nbsp;<span class="ident" id="3231104">s</span><span class="op" id="3231105">.</span><span class="ident" id="3231106">evalComplex</span><span class="op" id="3231117">(</span><span class="ident" id="3231118">typ</span><span class="op" id="3231121">,</span>&nbsp;<span class="ident" id="3231123">n</span><span class="op" id="3231124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3231127">case</span>&nbsp;<span class="ident" id="3231132">reflect</span><span class="op" id="3231139">.</span><span class="ident" id="3231140">Float32</span><span class="op" id="3231147">,</span>&nbsp;<span class="ident" id="3231149">reflect</span><span class="op" id="3231156">.</span><span class="ident" id="3231157">Float64</span><span class="op" id="3231164">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3231168">return</span>&nbsp;<span class="ident" id="3231175">s</span><span class="op" id="3231176">.</span><span class="ident" id="3231177">evalFloat</span><span class="op" id="3231186">(</span><span class="ident" id="3231187">typ</span><span class="op" id="3231190">,</span>&nbsp;<span class="ident" id="3231192">n</span><span class="op" id="3231193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3231196">case</span>&nbsp;<span class="ident" id="3231201">reflect</span><span class="op" id="3231208">.</span><span class="ident" id="3231209">Int</span><span class="op" id="3231212">,</span>&nbsp;<span class="ident" id="3231214">reflect</span><span class="op" id="3231221">.</span><span class="ident" id="3231222">Int8</span><span class="op" id="3231226">,</span>&nbsp;<span class="ident" id="3231228">reflect</span><span class="op" id="3231235">.</span><span class="ident" id="3231236">Int16</span><span class="op" id="3231241">,</span>&nbsp;<span class="ident" id="3231243">reflect</span><span class="op" id="3231250">.</span><span class="ident" id="3231251">Int32</span><span class="op" id="3231256">,</span>&nbsp;<span class="ident" id="3231258">reflect</span><span class="op" id="3231265">.</span><span class="ident" id="3231266">Int64</span><span class="op" id="3231271">:</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3231275">return</span>&nbsp;<span class="ident" id="3231282">s</span><span class="op" id="3231283">.</span><span class="ident" id="3231284">evalInteger</span><span class="op" id="3231295">(</span><span class="ident" id="3231296">typ</span><span class="op" id="3231299">,</span>&nbsp;<span class="ident" id="3231301">n</span><span class="op" id="3231302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3231305">case</span>&nbsp;<span class="ident" id="3231310">reflect</span><span class="op" id="3231317">.</span><span class="ident" id="3231318">Interface</span><span class="op" id="3231327">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3231331">if</span>&nbsp;<span class="ident" id="3231334">typ</span><span class="op" id="3231337">.</span><span class="ident" id="3231338">NumMethod</span><span class="op" id="3231347">(</span><span class="op" id="3231348">)</span>&nbsp;<span class="op" id="3231350">==</span>&nbsp;<span class="num" id="3231353">0</span>&nbsp;<span class="op" id="3231355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3231360">return</span>&nbsp;<span class="ident" id="3231367">s</span><span class="op" id="3231368">.</span><span class="ident" id="3231369">evalEmptyInterface</span><span class="op" id="3231387">(</span><span class="ident" id="3231388">dot</span><span class="op" id="3231391">,</span>&nbsp;<span class="ident" id="3231393">n</span><span class="op" id="3231394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3231398">}</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3231401">case</span>&nbsp;<span class="ident" id="3231406">reflect</span><span class="op" id="3231413">.</span><span class="ident" id="3231414">String</span><span class="op" id="3231420">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3231424">return</span>&nbsp;<span class="ident" id="3231431">s</span><span class="op" id="3231432">.</span><span class="ident" id="3231433">evalString</span><span class="op" id="3231443">(</span><span class="ident" id="3231444">typ</span><span class="op" id="3231447">,</span>&nbsp;<span class="ident" id="3231449">n</span><span class="op" id="3231450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3231453">case</span>&nbsp;<span class="ident" id="3231458">reflect</span><span class="op" id="3231465">.</span><span class="ident" id="3231466">Uint</span><span class="op" id="3231470">,</span>&nbsp;<span class="ident" id="3231472">reflect</span><span class="op" id="3231479">.</span><span class="ident" id="3231480">Uint8</span><span class="op" id="3231485">,</span>&nbsp;<span class="ident" id="3231487">reflect</span><span class="op" id="3231494">.</span><span class="ident" id="3231495">Uint16</span><span class="op" id="3231501">,</span>&nbsp;<span class="ident" id="3231503">reflect</span><span class="op" id="3231510">.</span><span class="ident" id="3231511">Uint32</span><span class="op" id="3231517">,</span>&nbsp;<span class="ident" id="3231519">reflect</span><span class="op" id="3231526">.</span><span class="ident" id="3231527">Uint64</span><span class="op" id="3231533">,</span>&nbsp;<span class="ident" id="3231535">reflect</span><span class="op" id="3231542">.</span><span class="ident" id="3231543">Uintptr</span><span class="op" id="3231550">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3231554">return</span>&nbsp;<span class="ident" id="3231561">s</span><span class="op" id="3231562">.</span><span class="ident" id="3231563">evalUnsignedInteger</span><span class="op" id="3231582">(</span><span class="ident" id="3231583">typ</span><span class="op" id="3231586">,</span>&nbsp;<span class="ident" id="3231588">n</span><span class="op" id="3231589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3231592">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3231595">s</span><span class="op" id="3231596">.</span><span class="ident" id="3231597">errorf</span><span class="op" id="3231603">(</span><span class="string" id="3231604">&#34;can&#39;t&nbsp;handle&nbsp;%s&nbsp;for&nbsp;arg&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3231640">,</span>&nbsp;<span class="ident" id="3231642">n</span><span class="op" id="3231643">,</span>&nbsp;<span class="ident" id="3231645">typ</span><span class="op" id="3231648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3231651">panic</span><span class="op" id="3231656">(</span><span class="string" id="3231657">&#34;not&nbsp;reached&#34;</span><span class="op" id="3231670">)</span><br>
<span class="lineno"></span><span class="op" id="3231672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3231675">func</span>&nbsp;<span class="op" id="3231680">(</span><span class="ident" id="3231681">s</span>&nbsp;<span class="op" id="3231683">*</span><span class="ident" id="3231684">state</span><span class="op" id="3231689">)</span>&nbsp;<span class="ident" id="3231691">evalBool</span><span class="op" id="3231699">(</span><span class="ident" id="3231700">typ</span>&nbsp;<span class="ident" id="3231704">reflect</span><span class="op" id="3231711">.</span><span class="ident" id="3231712">Type</span><span class="op" id="3231716">,</span>&nbsp;<span class="ident" id="3231718">n</span>&nbsp;<span class="ident" id="3231720">parse</span><span class="op" id="3231725">.</span><span class="ident" id="3231726">Node</span><span class="op" id="3231730">)</span>&nbsp;<span class="ident" id="3231732">reflect</span><span class="op" id="3231739">.</span><span class="ident" id="3231740">Value</span>&nbsp;<span class="op" id="3231746">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3231749">s</span><span class="op" id="3231750">.</span><span class="ident" id="3231751">at</span><span class="op" id="3231753">(</span><span class="ident" id="3231754">n</span><span class="op" id="3231755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3231758">if</span>&nbsp;<span class="ident" id="3231761">n</span><span class="op" id="3231762">,</span>&nbsp;<span class="ident" id="3231764">ok</span>&nbsp;<span class="op" id="3231767">:=</span>&nbsp;<span class="ident" id="3231770">n</span><span class="op" id="3231771">.</span><span class="op" id="3231772">(</span><span class="op" id="3231773">*</span><span class="ident" id="3231774">parse</span><span class="op" id="3231779">.</span><span class="ident" id="3231780">BoolNode</span><span class="op" id="3231788">)</span><span class="op" id="3231789">;</span>&nbsp;<span class="ident" id="3231791">ok</span>&nbsp;<span class="op" id="3231794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3231798">value</span>&nbsp;<span class="op" id="3231804">:=</span>&nbsp;<span class="ident" id="3231807">reflect</span><span class="op" id="3231814">.</span><span class="ident" id="3231815">New</span><span class="op" id="3231818">(</span><span class="ident" id="3231819">typ</span><span class="op" id="3231822">)</span><span class="op" id="3231823">.</span><span class="ident" id="3231824">Elem</span><span class="op" id="3231828">(</span><span class="op" id="3231829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3231833">value</span><span class="op" id="3231838">.</span><span class="ident" id="3231839">SetBool</span><span class="op" id="3231846">(</span><span class="ident" id="3231847">n</span><span class="op" id="3231848">.</span><span class="ident" id="3231849">True</span><span class="op" id="3231853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3231857">return</span>&nbsp;<span class="ident" id="3231864">value</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3231871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3231874">s</span><span class="op" id="3231875">.</span><span class="ident" id="3231876">errorf</span><span class="op" id="3231882">(</span><span class="string" id="3231883">&#34;expected&nbsp;bool;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3231908">,</span>&nbsp;<span class="ident" id="3231910">n</span><span class="op" id="3231911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3231914">panic</span><span class="op" id="3231919">(</span><span class="string" id="3231920">&#34;not&nbsp;reached&#34;</span><span class="op" id="3231933">)</span><br>
<span class="lineno"></span><span class="op" id="3231935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span><span class="keyword" id="3231938">func</span>&nbsp;<span class="op" id="3231943">(</span><span class="ident" id="3231944">s</span>&nbsp;<span class="op" id="3231946">*</span><span class="ident" id="3231947">state</span><span class="op" id="3231952">)</span>&nbsp;<span class="ident" id="3231954">evalString</span><span class="op" id="3231964">(</span><span class="ident" id="3231965">typ</span>&nbsp;<span class="ident" id="3231969">reflect</span><span class="op" id="3231976">.</span><span class="ident" id="3231977">Type</span><span class="op" id="3231981">,</span>&nbsp;<span class="ident" id="3231983">n</span>&nbsp;<span class="ident" id="3231985">parse</span><span class="op" id="3231990">.</span><span class="ident" id="3231991">Node</span><span class="op" id="3231995">)</span>&nbsp;<span class="ident" id="3231997">reflect</span><span class="op" id="3232004">.</span><span class="ident" id="3232005">Value</span>&nbsp;<span class="op" id="3232011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3232014">s</span><span class="op" id="3232015">.</span><span class="ident" id="3232016">at</span><span class="op" id="3232018">(</span><span class="ident" id="3232019">n</span><span class="op" id="3232020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3232023">if</span>&nbsp;<span class="ident" id="3232026">n</span><span class="op" id="3232027">,</span>&nbsp;<span class="ident" id="3232029">ok</span>&nbsp;<span class="op" id="3232032">:=</span>&nbsp;<span class="ident" id="3232035">n</span><span class="op" id="3232036">.</span><span class="op" id="3232037">(</span><span class="op" id="3232038">*</span><span class="ident" id="3232039">parse</span><span class="op" id="3232044">.</span><span class="ident" id="3232045">StringNode</span><span class="op" id="3232055">)</span><span class="op" id="3232056">;</span>&nbsp;<span class="ident" id="3232058">ok</span>&nbsp;<span class="op" id="3232061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3232065">value</span>&nbsp;<span class="op" id="3232071">:=</span>&nbsp;<span class="ident" id="3232074">reflect</span><span class="op" id="3232081">.</span><span class="ident" id="3232082">New</span><span class="op" id="3232085">(</span><span class="ident" id="3232086">typ</span><span class="op" id="3232089">)</span><span class="op" id="3232090">.</span><span class="ident" id="3232091">Elem</span><span class="op" id="3232095">(</span><span class="op" id="3232096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3232100">value</span><span class="op" id="3232105">.</span><span class="ident" id="3232106">SetString</span><span class="op" id="3232115">(</span><span class="ident" id="3232116">n</span><span class="op" id="3232117">.</span><span class="ident" id="3232118">Text</span><span class="op" id="3232122">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3232126">return</span>&nbsp;<span class="ident" id="3232133">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3232140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3232143">s</span><span class="op" id="3232144">.</span><span class="ident" id="3232145">errorf</span><span class="op" id="3232151">(</span><span class="string" id="3232152">&#34;expected&nbsp;string;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3232179">,</span>&nbsp;<span class="ident" id="3232181">n</span><span class="op" id="3232182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3232185">panic</span><span class="op" id="3232190">(</span><span class="string" id="3232191">&#34;not&nbsp;reached&#34;</span><span class="op" id="3232204">)</span><br>
<span class="lineno"></span><span class="op" id="3232206">}</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span><span class="keyword" id="3232209">func</span>&nbsp;<span class="op" id="3232214">(</span><span class="ident" id="3232215">s</span>&nbsp;<span class="op" id="3232217">*</span><span class="ident" id="3232218">state</span><span class="op" id="3232223">)</span>&nbsp;<span class="ident" id="3232225">evalInteger</span><span class="op" id="3232236">(</span><span class="ident" id="3232237">typ</span>&nbsp;<span class="ident" id="3232241">reflect</span><span class="op" id="3232248">.</span><span class="ident" id="3232249">Type</span><span class="op" id="3232253">,</span>&nbsp;<span class="ident" id="3232255">n</span>&nbsp;<span class="ident" id="3232257">parse</span><span class="op" id="3232262">.</span><span class="ident" id="3232263">Node</span><span class="op" id="3232267">)</span>&nbsp;<span class="ident" id="3232269">reflect</span><span class="op" id="3232276">.</span><span class="ident" id="3232277">Value</span>&nbsp;<span class="op" id="3232283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3232286">s</span><span class="op" id="3232287">.</span><span class="ident" id="3232288">at</span><span class="op" id="3232290">(</span><span class="ident" id="3232291">n</span><span class="op" id="3232292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3232295">if</span>&nbsp;<span class="ident" id="3232298">n</span><span class="op" id="3232299">,</span>&nbsp;<span class="ident" id="3232301">ok</span>&nbsp;<span class="op" id="3232304">:=</span>&nbsp;<span class="ident" id="3232307">n</span><span class="op" id="3232308">.</span><span class="op" id="3232309">(</span><span class="op" id="3232310">*</span><span class="ident" id="3232311">parse</span><span class="op" id="3232316">.</span><span class="ident" id="3232317">NumberNode</span><span class="op" id="3232327">)</span><span class="op" id="3232328">;</span>&nbsp;<span class="ident" id="3232330">ok</span>&nbsp;<span class="op" id="3232333">&amp;&amp;</span>&nbsp;<span class="ident" id="3232336">n</span><span class="op" id="3232337">.</span><span class="ident" id="3232338">IsInt</span>&nbsp;<span class="op" id="3232344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3232348">value</span>&nbsp;<span class="op" id="3232354">:=</span>&nbsp;<span class="ident" id="3232357">reflect</span><span class="op" id="3232364">.</span><span class="ident" id="3232365">New</span><span class="op" id="3232368">(</span><span class="ident" id="3232369">typ</span><span class="op" id="3232372">)</span><span class="op" id="3232373">.</span><span class="ident" id="3232374">Elem</span><span class="op" id="3232378">(</span><span class="op" id="3232379">)</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3232383">value</span><span class="op" id="3232388">.</span><span class="ident" id="3232389">SetInt</span><span class="op" id="3232395">(</span><span class="ident" id="3232396">n</span><span class="op" id="3232397">.</span><span class="ident" id="3232398">Int64</span><span class="op" id="3232403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3232407">return</span>&nbsp;<span class="ident" id="3232414">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3232421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3232424">s</span><span class="op" id="3232425">.</span><span class="ident" id="3232426">errorf</span><span class="op" id="3232432">(</span><span class="string" id="3232433">&#34;expected&nbsp;integer;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3232461">,</span>&nbsp;<span class="ident" id="3232463">n</span><span class="op" id="3232464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3232467">panic</span><span class="op" id="3232472">(</span><span class="string" id="3232473">&#34;not&nbsp;reached&#34;</span><span class="op" id="3232486">)</span><br>
<span class="lineno">695</span><span class="op" id="3232488">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3232491">func</span>&nbsp;<span class="op" id="3232496">(</span><span class="ident" id="3232497">s</span>&nbsp;<span class="op" id="3232499">*</span><span class="ident" id="3232500">state</span><span class="op" id="3232505">)</span>&nbsp;<span class="ident" id="3232507">evalUnsignedInteger</span><span class="op" id="3232526">(</span><span class="ident" id="3232527">typ</span>&nbsp;<span class="ident" id="3232531">reflect</span><span class="op" id="3232538">.</span><span class="ident" id="3232539">Type</span><span class="op" id="3232543">,</span>&nbsp;<span class="ident" id="3232545">n</span>&nbsp;<span class="ident" id="3232547">parse</span><span class="op" id="3232552">.</span><span class="ident" id="3232553">Node</span><span class="op" id="3232557">)</span>&nbsp;<span class="ident" id="3232559">reflect</span><span class="op" id="3232566">.</span><span class="ident" id="3232567">Value</span>&nbsp;<span class="op" id="3232573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3232576">s</span><span class="op" id="3232577">.</span><span class="ident" id="3232578">at</span><span class="op" id="3232580">(</span><span class="ident" id="3232581">n</span><span class="op" id="3232582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3232585">if</span>&nbsp;<span class="ident" id="3232588">n</span><span class="op" id="3232589">,</span>&nbsp;<span class="ident" id="3232591">ok</span>&nbsp;<span class="op" id="3232594">:=</span>&nbsp;<span class="ident" id="3232597">n</span><span class="op" id="3232598">.</span><span class="op" id="3232599">(</span><span class="op" id="3232600">*</span><span class="ident" id="3232601">parse</span><span class="op" id="3232606">.</span><span class="ident" id="3232607">NumberNode</span><span class="op" id="3232617">)</span><span class="op" id="3232618">;</span>&nbsp;<span class="ident" id="3232620">ok</span>&nbsp;<span class="op" id="3232623">&amp;&amp;</span>&nbsp;<span class="ident" id="3232626">n</span><span class="op" id="3232627">.</span><span class="ident" id="3232628">IsUint</span>&nbsp;<span class="op" id="3232635">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3232639">value</span>&nbsp;<span class="op" id="3232645">:=</span>&nbsp;<span class="ident" id="3232648">reflect</span><span class="op" id="3232655">.</span><span class="ident" id="3232656">New</span><span class="op" id="3232659">(</span><span class="ident" id="3232660">typ</span><span class="op" id="3232663">)</span><span class="op" id="3232664">.</span><span class="ident" id="3232665">Elem</span><span class="op" id="3232669">(</span><span class="op" id="3232670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3232674">value</span><span class="op" id="3232679">.</span><span class="ident" id="3232680">SetUint</span><span class="op" id="3232687">(</span><span class="ident" id="3232688">n</span><span class="op" id="3232689">.</span><span class="ident" id="3232690">Uint64</span><span class="op" id="3232696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3232700">return</span>&nbsp;<span class="ident" id="3232707">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3232714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3232717">s</span><span class="op" id="3232718">.</span><span class="ident" id="3232719">errorf</span><span class="op" id="3232725">(</span><span class="string" id="3232726">&#34;expected&nbsp;unsigned&nbsp;integer;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3232763">,</span>&nbsp;<span class="ident" id="3232765">n</span><span class="op" id="3232766">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3232769">panic</span><span class="op" id="3232774">(</span><span class="string" id="3232775">&#34;not&nbsp;reached&#34;</span><span class="op" id="3232788">)</span><br>
<span class="lineno"></span><span class="op" id="3232790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3232793">func</span>&nbsp;<span class="op" id="3232798">(</span><span class="ident" id="3232799">s</span>&nbsp;<span class="op" id="3232801">*</span><span class="ident" id="3232802">state</span><span class="op" id="3232807">)</span>&nbsp;<span class="ident" id="3232809">evalFloat</span><span class="op" id="3232818">(</span><span class="ident" id="3232819">typ</span>&nbsp;<span class="ident" id="3232823">reflect</span><span class="op" id="3232830">.</span><span class="ident" id="3232831">Type</span><span class="op" id="3232835">,</span>&nbsp;<span class="ident" id="3232837">n</span>&nbsp;<span class="ident" id="3232839">parse</span><span class="op" id="3232844">.</span><span class="ident" id="3232845">Node</span><span class="op" id="3232849">)</span>&nbsp;<span class="ident" id="3232851">reflect</span><span class="op" id="3232858">.</span><span class="ident" id="3232859">Value</span>&nbsp;<span class="op" id="3232865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3232868">s</span><span class="op" id="3232869">.</span><span class="ident" id="3232870">at</span><span class="op" id="3232872">(</span><span class="ident" id="3232873">n</span><span class="op" id="3232874">)</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3232877">if</span>&nbsp;<span class="ident" id="3232880">n</span><span class="op" id="3232881">,</span>&nbsp;<span class="ident" id="3232883">ok</span>&nbsp;<span class="op" id="3232886">:=</span>&nbsp;<span class="ident" id="3232889">n</span><span class="op" id="3232890">.</span><span class="op" id="3232891">(</span><span class="op" id="3232892">*</span><span class="ident" id="3232893">parse</span><span class="op" id="3232898">.</span><span class="ident" id="3232899">NumberNode</span><span class="op" id="3232909">)</span><span class="op" id="3232910">;</span>&nbsp;<span class="ident" id="3232912">ok</span>&nbsp;<span class="op" id="3232915">&amp;&amp;</span>&nbsp;<span class="ident" id="3232918">n</span><span class="op" id="3232919">.</span><span class="ident" id="3232920">IsFloat</span>&nbsp;<span class="op" id="3232928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3232932">value</span>&nbsp;<span class="op" id="3232938">:=</span>&nbsp;<span class="ident" id="3232941">reflect</span><span class="op" id="3232948">.</span><span class="ident" id="3232949">New</span><span class="op" id="3232952">(</span><span class="ident" id="3232953">typ</span><span class="op" id="3232956">)</span><span class="op" id="3232957">.</span><span class="ident" id="3232958">Elem</span><span class="op" id="3232962">(</span><span class="op" id="3232963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3232967">value</span><span class="op" id="3232972">.</span><span class="ident" id="3232973">SetFloat</span><span class="op" id="3232981">(</span><span class="ident" id="3232982">n</span><span class="op" id="3232983">.</span><span class="ident" id="3232984">Float64</span><span class="op" id="3232991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3232995">return</span>&nbsp;<span class="ident" id="3233002">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3233009">}</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3233012">s</span><span class="op" id="3233013">.</span><span class="ident" id="3233014">errorf</span><span class="op" id="3233020">(</span><span class="string" id="3233021">&#34;expected&nbsp;float;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3233047">,</span>&nbsp;<span class="ident" id="3233049">n</span><span class="op" id="3233050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3233053">panic</span><span class="op" id="3233058">(</span><span class="string" id="3233059">&#34;not&nbsp;reached&#34;</span><span class="op" id="3233072">)</span><br>
<span class="lineno"></span><span class="op" id="3233074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3233077">func</span>&nbsp;<span class="op" id="3233082">(</span><span class="ident" id="3233083">s</span>&nbsp;<span class="op" id="3233085">*</span><span class="ident" id="3233086">state</span><span class="op" id="3233091">)</span>&nbsp;<span class="ident" id="3233093">evalComplex</span><span class="op" id="3233104">(</span><span class="ident" id="3233105">typ</span>&nbsp;<span class="ident" id="3233109">reflect</span><span class="op" id="3233116">.</span><span class="ident" id="3233117">Type</span><span class="op" id="3233121">,</span>&nbsp;<span class="ident" id="3233123">n</span>&nbsp;<span class="ident" id="3233125">parse</span><span class="op" id="3233130">.</span><span class="ident" id="3233131">Node</span><span class="op" id="3233135">)</span>&nbsp;<span class="ident" id="3233137">reflect</span><span class="op" id="3233144">.</span><span class="ident" id="3233145">Value</span>&nbsp;<span class="op" id="3233151">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233154">if</span>&nbsp;<span class="ident" id="3233157">n</span><span class="op" id="3233158">,</span>&nbsp;<span class="ident" id="3233160">ok</span>&nbsp;<span class="op" id="3233163">:=</span>&nbsp;<span class="ident" id="3233166">n</span><span class="op" id="3233167">.</span><span class="op" id="3233168">(</span><span class="op" id="3233169">*</span><span class="ident" id="3233170">parse</span><span class="op" id="3233175">.</span><span class="ident" id="3233176">NumberNode</span><span class="op" id="3233186">)</span><span class="op" id="3233187">;</span>&nbsp;<span class="ident" id="3233189">ok</span>&nbsp;<span class="op" id="3233192">&amp;&amp;</span>&nbsp;<span class="ident" id="3233195">n</span><span class="op" id="3233196">.</span><span class="ident" id="3233197">IsComplex</span>&nbsp;<span class="op" id="3233207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3233211">value</span>&nbsp;<span class="op" id="3233217">:=</span>&nbsp;<span class="ident" id="3233220">reflect</span><span class="op" id="3233227">.</span><span class="ident" id="3233228">New</span><span class="op" id="3233231">(</span><span class="ident" id="3233232">typ</span><span class="op" id="3233235">)</span><span class="op" id="3233236">.</span><span class="ident" id="3233237">Elem</span><span class="op" id="3233241">(</span><span class="op" id="3233242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3233246">value</span><span class="op" id="3233251">.</span><span class="ident" id="3233252">SetComplex</span><span class="op" id="3233262">(</span><span class="ident" id="3233263">n</span><span class="op" id="3233264">.</span><span class="ident" id="3233265">Complex128</span><span class="op" id="3233275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233279">return</span>&nbsp;<span class="ident" id="3233286">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3233293">}</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3233296">s</span><span class="op" id="3233297">.</span><span class="ident" id="3233298">errorf</span><span class="op" id="3233304">(</span><span class="string" id="3233305">&#34;expected&nbsp;complex;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3233333">,</span>&nbsp;<span class="ident" id="3233335">n</span><span class="op" id="3233336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3233339">panic</span><span class="op" id="3233344">(</span><span class="string" id="3233345">&#34;not&nbsp;reached&#34;</span><span class="op" id="3233358">)</span><br>
<span class="lineno"></span><span class="op" id="3233360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3233363">func</span>&nbsp;<span class="op" id="3233368">(</span><span class="ident" id="3233369">s</span>&nbsp;<span class="op" id="3233371">*</span><span class="ident" id="3233372">state</span><span class="op" id="3233377">)</span>&nbsp;<span class="ident" id="3233379">evalEmptyInterface</span><span class="op" id="3233397">(</span><span class="ident" id="3233398">dot</span>&nbsp;<span class="ident" id="3233402">reflect</span><span class="op" id="3233409">.</span><span class="ident" id="3233410">Value</span><span class="op" id="3233415">,</span>&nbsp;<span class="ident" id="3233417">n</span>&nbsp;<span class="ident" id="3233419">parse</span><span class="op" id="3233424">.</span><span class="ident" id="3233425">Node</span><span class="op" id="3233429">)</span>&nbsp;<span class="ident" id="3233431">reflect</span><span class="op" id="3233438">.</span><span class="ident" id="3233439">Value</span>&nbsp;<span class="op" id="3233445">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3233448">s</span><span class="op" id="3233449">.</span><span class="ident" id="3233450">at</span><span class="op" id="3233452">(</span><span class="ident" id="3233453">n</span><span class="op" id="3233454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233457">switch</span>&nbsp;<span class="ident" id="3233464">n</span>&nbsp;<span class="op" id="3233466">:=</span>&nbsp;<span class="ident" id="3233469">n</span><span class="op" id="3233470">.</span><span class="op" id="3233471">(</span><span class="keyword" id="3233472">type</span><span class="op" id="3233476">)</span>&nbsp;<span class="op" id="3233478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233481">case</span>&nbsp;<span class="op" id="3233486">*</span><span class="ident" id="3233487">parse</span><span class="op" id="3233492">.</span><span class="ident" id="3233493">BoolNode</span><span class="op" id="3233501">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233505">return</span>&nbsp;<span class="ident" id="3233512">reflect</span><span class="op" id="3233519">.</span><span class="ident" id="3233520">ValueOf</span><span class="op" id="3233527">(</span><span class="ident" id="3233528">n</span><span class="op" id="3233529">.</span><span class="ident" id="3233530">True</span><span class="op" id="3233534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233537">case</span>&nbsp;<span class="op" id="3233542">*</span><span class="ident" id="3233543">parse</span><span class="op" id="3233548">.</span><span class="ident" id="3233549">DotNode</span><span class="op" id="3233556">:</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233560">return</span>&nbsp;<span class="ident" id="3233567">dot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233572">case</span>&nbsp;<span class="op" id="3233577">*</span><span class="ident" id="3233578">parse</span><span class="op" id="3233583">.</span><span class="ident" id="3233584">FieldNode</span><span class="op" id="3233593">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233597">return</span>&nbsp;<span class="ident" id="3233604">s</span><span class="op" id="3233605">.</span><span class="ident" id="3233606">evalFieldNode</span><span class="op" id="3233619">(</span><span class="ident" id="3233620">dot</span><span class="op" id="3233623">,</span>&nbsp;<span class="ident" id="3233625">n</span><span class="op" id="3233626">,</span>&nbsp;<span class="ident" id="3233628">nil</span><span class="op" id="3233631">,</span>&nbsp;<span class="ident" id="3233633">zero</span><span class="op" id="3233637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233640">case</span>&nbsp;<span class="op" id="3233645">*</span><span class="ident" id="3233646">parse</span><span class="op" id="3233651">.</span><span class="ident" id="3233652">IdentifierNode</span><span class="op" id="3233666">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233670">return</span>&nbsp;<span class="ident" id="3233677">s</span><span class="op" id="3233678">.</span><span class="ident" id="3233679">evalFunction</span><span class="op" id="3233691">(</span><span class="ident" id="3233692">dot</span><span class="op" id="3233695">,</span>&nbsp;<span class="ident" id="3233697">n</span><span class="op" id="3233698">,</span>&nbsp;<span class="ident" id="3233700">n</span><span class="op" id="3233701">,</span>&nbsp;<span class="ident" id="3233703">nil</span><span class="op" id="3233706">,</span>&nbsp;<span class="ident" id="3233708">zero</span><span class="op" id="3233712">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233715">case</span>&nbsp;<span class="op" id="3233720">*</span><span class="ident" id="3233721">parse</span><span class="op" id="3233726">.</span><span class="ident" id="3233727">NilNode</span><span class="op" id="3233734">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3233738">//&nbsp;NilNode&nbsp;is&nbsp;handled&nbsp;in&nbsp;evalArg,&nbsp;the&nbsp;only&nbsp;place&nbsp;that&nbsp;calls&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3233806">s</span><span class="op" id="3233807">.</span><span class="ident" id="3233808">errorf</span><span class="op" id="3233814">(</span><span class="string" id="3233815">&#34;evalEmptyInterface:&nbsp;nil&nbsp;(can&#39;t&nbsp;happen)&#34;</span><span class="op" id="3233855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233858">case</span>&nbsp;<span class="op" id="3233863">*</span><span class="ident" id="3233864">parse</span><span class="op" id="3233869">.</span><span class="ident" id="3233870">NumberNode</span><span class="op" id="3233880">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233884">return</span>&nbsp;<span class="ident" id="3233891">s</span><span class="op" id="3233892">.</span><span class="ident" id="3233893">idealConstant</span><span class="op" id="3233906">(</span><span class="ident" id="3233907">n</span><span class="op" id="3233908">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233911">case</span>&nbsp;<span class="op" id="3233916">*</span><span class="ident" id="3233917">parse</span><span class="op" id="3233922">.</span><span class="ident" id="3233923">StringNode</span><span class="op" id="3233933">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233937">return</span>&nbsp;<span class="ident" id="3233944">reflect</span><span class="op" id="3233951">.</span><span class="ident" id="3233952">ValueOf</span><span class="op" id="3233959">(</span><span class="ident" id="3233960">n</span><span class="op" id="3233961">.</span><span class="ident" id="3233962">Text</span><span class="op" id="3233966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233969">case</span>&nbsp;<span class="op" id="3233974">*</span><span class="ident" id="3233975">parse</span><span class="op" id="3233980">.</span><span class="ident" id="3233981">VariableNode</span><span class="op" id="3233993">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3233997">return</span>&nbsp;<span class="ident" id="3234004">s</span><span class="op" id="3234005">.</span><span class="ident" id="3234006">evalVariableNode</span><span class="op" id="3234022">(</span><span class="ident" id="3234023">dot</span><span class="op" id="3234026">,</span>&nbsp;<span class="ident" id="3234028">n</span><span class="op" id="3234029">,</span>&nbsp;<span class="ident" id="3234031">nil</span><span class="op" id="3234034">,</span>&nbsp;<span class="ident" id="3234036">zero</span><span class="op" id="3234040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3234043">case</span>&nbsp;<span class="op" id="3234048">*</span><span class="ident" id="3234049">parse</span><span class="op" id="3234054">.</span><span class="ident" id="3234055">PipeNode</span><span class="op" id="3234063">:</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3234067">return</span>&nbsp;<span class="ident" id="3234074">s</span><span class="op" id="3234075">.</span><span class="ident" id="3234076">evalPipeline</span><span class="op" id="3234088">(</span><span class="ident" id="3234089">dot</span><span class="op" id="3234092">,</span>&nbsp;<span class="ident" id="3234094">n</span><span class="op" id="3234095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3234098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3234101">s</span><span class="op" id="3234102">.</span><span class="ident" id="3234103">errorf</span><span class="op" id="3234109">(</span><span class="string" id="3234110">&#34;can&#39;t&nbsp;handle&nbsp;assignment&nbsp;of&nbsp;%s&nbsp;to&nbsp;empty&nbsp;interface&nbsp;argument&#34;</span><span class="op" id="3234169">,</span>&nbsp;<span class="ident" id="3234171">n</span><span class="op" id="3234172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3234175">panic</span><span class="op" id="3234180">(</span><span class="string" id="3234181">&#34;not&nbsp;reached&#34;</span><span class="op" id="3234194">)</span><br>
<span class="lineno"></span><span class="op" id="3234196">}</span><br>
<span class="lineno">755</span><br>
<span class="lineno"></span><span class="comment" id="3234199">//&nbsp;indirect&nbsp;returns&nbsp;the&nbsp;item&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;indirection,&nbsp;and&nbsp;a&nbsp;bool&nbsp;to&nbsp;indicate&nbsp;if&nbsp;it&#39;s&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="3234291">//&nbsp;We&nbsp;indirect&nbsp;through&nbsp;pointers&nbsp;and&nbsp;empty&nbsp;interfaces&nbsp;(only)&nbsp;because</span><br>
<span class="lineno"></span><span class="comment" id="3234359">//&nbsp;non-empty&nbsp;interfaces&nbsp;have&nbsp;methods&nbsp;we&nbsp;might&nbsp;need.</span><br>
<span class="lineno"></span><span class="keyword" id="3234411">func</span>&nbsp;<span class="ident" id="3234416">indirect</span><span class="op" id="3234424">(</span><span class="ident" id="3234425">v</span>&nbsp;<span class="ident" id="3234427">reflect</span><span class="op" id="3234434">.</span><span class="ident" id="3234435">Value</span><span class="op" id="3234440">)</span>&nbsp;<span class="op" id="3234442">(</span><span class="ident" id="3234443">rv</span>&nbsp;<span class="ident" id="3234446">reflect</span><span class="op" id="3234453">.</span><span class="ident" id="3234454">Value</span><span class="op" id="3234459">,</span>&nbsp;<span class="ident" id="3234461">isNil</span>&nbsp;<span class="builtintype" id="3234467">bool</span><span class="op" id="3234471">)</span>&nbsp;<span class="op" id="3234473">{</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3234476">for</span>&nbsp;<span class="op" id="3234480">;</span>&nbsp;<span class="ident" id="3234482">v</span><span class="op" id="3234483">.</span><span class="ident" id="3234484">Kind</span><span class="op" id="3234488">(</span><span class="op" id="3234489">)</span>&nbsp;<span class="op" id="3234491">==</span>&nbsp;<span class="ident" id="3234494">reflect</span><span class="op" id="3234501">.</span><span class="ident" id="3234502">Ptr</span>&nbsp;<span class="op" id="3234506">||</span>&nbsp;<span class="ident" id="3234509">v</span><span class="op" id="3234510">.</span><span class="ident" id="3234511">Kind</span><span class="op" id="3234515">(</span><span class="op" id="3234516">)</span>&nbsp;<span class="op" id="3234518">==</span>&nbsp;<span class="ident" id="3234521">reflect</span><span class="op" id="3234528">.</span><span class="ident" id="3234529">Interface</span><span class="op" id="3234538">;</span>&nbsp;<span class="ident" id="3234540">v</span>&nbsp;<span class="op" id="3234542">=</span>&nbsp;<span class="ident" id="3234544">v</span><span class="op" id="3234545">.</span><span class="ident" id="3234546">Elem</span><span class="op" id="3234550">(</span><span class="op" id="3234551">)</span>&nbsp;<span class="op" id="3234553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3234557">if</span>&nbsp;<span class="ident" id="3234560">v</span><span class="op" id="3234561">.</span><span class="ident" id="3234562">IsNil</span><span class="op" id="3234567">(</span><span class="op" id="3234568">)</span>&nbsp;<span class="op" id="3234570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3234575">return</span>&nbsp;<span class="ident" id="3234582">v</span><span class="op" id="3234583">,</span>&nbsp;<span class="builtintype" id="3234585">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3234592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3234596">if</span>&nbsp;<span class="ident" id="3234599">v</span><span class="op" id="3234600">.</span><span class="ident" id="3234601">Kind</span><span class="op" id="3234605">(</span><span class="op" id="3234606">)</span>&nbsp;<span class="op" id="3234608">==</span>&nbsp;<span class="ident" id="3234611">reflect</span><span class="op" id="3234618">.</span><span class="ident" id="3234619">Interface</span>&nbsp;<span class="op" id="3234629">&amp;&amp;</span>&nbsp;<span class="ident" id="3234632">v</span><span class="op" id="3234633">.</span><span class="ident" id="3234634">NumMethod</span><span class="op" id="3234643">(</span><span class="op" id="3234644">)</span>&nbsp;<span class="op" id="3234646">&gt;</span>&nbsp;<span class="num" id="3234648">0</span>&nbsp;<span class="op" id="3234650">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3234655">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3234663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3234666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3234669">return</span>&nbsp;<span class="ident" id="3234676">v</span><span class="op" id="3234677">,</span>&nbsp;<span class="builtintype" id="3234679">false</span><br>
<span class="lineno"></span><span class="op" id="3234685">}</span><br>
<span class="lineno">770</span><br>
<span class="lineno"></span><span class="comment" id="3234688">//&nbsp;printValue&nbsp;writes&nbsp;the&nbsp;textual&nbsp;representation&nbsp;of&nbsp;the&nbsp;value&nbsp;to&nbsp;the&nbsp;output&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3234766">//&nbsp;the&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="3234783">func</span>&nbsp;<span class="op" id="3234788">(</span><span class="ident" id="3234789">s</span>&nbsp;<span class="op" id="3234791">*</span><span class="ident" id="3234792">state</span><span class="op" id="3234797">)</span>&nbsp;<span class="ident" id="3234799">printValue</span><span class="op" id="3234809">(</span><span class="ident" id="3234810">n</span>&nbsp;<span class="ident" id="3234812">parse</span><span class="op" id="3234817">.</span><span class="ident" id="3234818">Node</span><span class="op" id="3234822">,</span>&nbsp;<span class="ident" id="3234824">v</span>&nbsp;<span class="ident" id="3234826">reflect</span><span class="op" id="3234833">.</span><span class="ident" id="3234834">Value</span><span class="op" id="3234839">)</span>&nbsp;<span class="op" id="3234841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3234844">s</span><span class="op" id="3234845">.</span><span class="ident" id="3234846">at</span><span class="op" id="3234848">(</span><span class="ident" id="3234849">n</span><span class="op" id="3234850">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3234853">iface</span><span class="op" id="3234858">,</span>&nbsp;<span class="ident" id="3234860">ok</span>&nbsp;<span class="op" id="3234863">:=</span>&nbsp;<span class="ident" id="3234866">printableValue</span><span class="op" id="3234880">(</span><span class="ident" id="3234881">v</span><span class="op" id="3234882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3234885">if</span>&nbsp;<span class="op" id="3234888">!</span><span class="ident" id="3234889">ok</span>&nbsp;<span class="op" id="3234892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3234896">s</span><span class="op" id="3234897">.</span><span class="ident" id="3234898">errorf</span><span class="op" id="3234904">(</span><span class="string" id="3234905">&#34;can&#39;t&nbsp;print&nbsp;%s&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3234932">,</span>&nbsp;<span class="ident" id="3234934">n</span><span class="op" id="3234935">,</span>&nbsp;<span class="ident" id="3234937">v</span><span class="op" id="3234938">.</span><span class="ident" id="3234939">Type</span><span class="op" id="3234943">(</span><span class="op" id="3234944">)</span><span class="op" id="3234945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3234948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3234951">fmt</span><span class="op" id="3234954">.</span><span class="ident" id="3234955">Fprint</span><span class="op" id="3234961">(</span><span class="ident" id="3234962">s</span><span class="op" id="3234963">.</span><span class="ident" id="3234964">wr</span><span class="op" id="3234966">,</span>&nbsp;<span class="ident" id="3234968">iface</span><span class="op" id="3234973">)</span><br>
<span class="lineno">780</span><span class="op" id="3234975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3234978">//&nbsp;printableValue&nbsp;returns&nbsp;the,&nbsp;possibly&nbsp;indirected,&nbsp;interface&nbsp;value&nbsp;inside&nbsp;v&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3235060">//&nbsp;is&nbsp;best&nbsp;for&nbsp;a&nbsp;call&nbsp;to&nbsp;formatted&nbsp;printer.</span><br>
<span class="lineno"></span><span class="keyword" id="3235104">func</span>&nbsp;<span class="ident" id="3235109">printableValue</span><span class="op" id="3235123">(</span><span class="ident" id="3235124">v</span>&nbsp;<span class="ident" id="3235126">reflect</span><span class="op" id="3235133">.</span><span class="ident" id="3235134">Value</span><span class="op" id="3235139">)</span>&nbsp;<span class="op" id="3235141">(</span><span class="keyword" id="3235142">interface</span><span class="op" id="3235151">{</span><span class="op" id="3235152">}</span><span class="op" id="3235153">,</span>&nbsp;<span class="builtintype" id="3235155">bool</span><span class="op" id="3235159">)</span>&nbsp;<span class="op" id="3235161">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3235164">if</span>&nbsp;<span class="ident" id="3235167">v</span><span class="op" id="3235168">.</span><span class="ident" id="3235169">Kind</span><span class="op" id="3235173">(</span><span class="op" id="3235174">)</span>&nbsp;<span class="op" id="3235176">==</span>&nbsp;<span class="ident" id="3235179">reflect</span><span class="op" id="3235186">.</span><span class="ident" id="3235187">Ptr</span>&nbsp;<span class="op" id="3235191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3235195">v</span><span class="op" id="3235196">,</span>&nbsp;<span class="ident" id="3235198">_</span>&nbsp;<span class="op" id="3235200">=</span>&nbsp;<span class="ident" id="3235202">indirect</span><span class="op" id="3235210">(</span><span class="ident" id="3235211">v</span><span class="op" id="3235212">)</span>&nbsp;<span class="comment" id="3235214">//&nbsp;fmt.Fprint&nbsp;handles&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3235242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3235245">if</span>&nbsp;<span class="op" id="3235248">!</span><span class="ident" id="3235249">v</span><span class="op" id="3235250">.</span><span class="ident" id="3235251">IsValid</span><span class="op" id="3235258">(</span><span class="op" id="3235259">)</span>&nbsp;<span class="op" id="3235261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3235265">return</span>&nbsp;<span class="string" id="3235272">&#34;&lt;no&nbsp;value&gt;&#34;</span><span class="op" id="3235284">,</span>&nbsp;<span class="builtintype" id="3235286">true</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3235292">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3235296">if</span>&nbsp;<span class="op" id="3235299">!</span><span class="ident" id="3235300">v</span><span class="op" id="3235301">.</span><span class="ident" id="3235302">Type</span><span class="op" id="3235306">(</span><span class="op" id="3235307">)</span><span class="op" id="3235308">.</span><span class="ident" id="3235309">Implements</span><span class="op" id="3235319">(</span><span class="ident" id="3235320">errorType</span><span class="op" id="3235329">)</span>&nbsp;<span class="op" id="3235331">&amp;&amp;</span>&nbsp;<span class="op" id="3235334">!</span><span class="ident" id="3235335">v</span><span class="op" id="3235336">.</span><span class="ident" id="3235337">Type</span><span class="op" id="3235341">(</span><span class="op" id="3235342">)</span><span class="op" id="3235343">.</span><span class="ident" id="3235344">Implements</span><span class="op" id="3235354">(</span><span class="ident" id="3235355">fmtStringerType</span><span class="op" id="3235370">)</span>&nbsp;<span class="op" id="3235372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3235376">if</span>&nbsp;<span class="ident" id="3235379">v</span><span class="op" id="3235380">.</span><span class="ident" id="3235381">CanAddr</span><span class="op" id="3235388">(</span><span class="op" id="3235389">)</span>&nbsp;<span class="op" id="3235391">&amp;&amp;</span>&nbsp;<span class="op" id="3235394">(</span><span class="ident" id="3235395">reflect</span><span class="op" id="3235402">.</span><span class="ident" id="3235403">PtrTo</span><span class="op" id="3235408">(</span><span class="ident" id="3235409">v</span><span class="op" id="3235410">.</span><span class="ident" id="3235411">Type</span><span class="op" id="3235415">(</span><span class="op" id="3235416">)</span><span class="op" id="3235417">)</span><span class="op" id="3235418">.</span><span class="ident" id="3235419">Implements</span><span class="op" id="3235429">(</span><span class="ident" id="3235430">errorType</span><span class="op" id="3235439">)</span>&nbsp;<span class="op" id="3235441">||</span>&nbsp;<span class="ident" id="3235444">reflect</span><span class="op" id="3235451">.</span><span class="ident" id="3235452">PtrTo</span><span class="op" id="3235457">(</span><span class="ident" id="3235458">v</span><span class="op" id="3235459">.</span><span class="ident" id="3235460">Type</span><span class="op" id="3235464">(</span><span class="op" id="3235465">)</span><span class="op" id="3235466">)</span><span class="op" id="3235467">.</span><span class="ident" id="3235468">Implements</span><span class="op" id="3235478">(</span><span class="ident" id="3235479">fmtStringerType</span><span class="op" id="3235494">)</span><span class="op" id="3235495">)</span>&nbsp;<span class="op" id="3235497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3235502">v</span>&nbsp;<span class="op" id="3235504">=</span>&nbsp;<span class="ident" id="3235506">v</span><span class="op" id="3235507">.</span><span class="ident" id="3235508">Addr</span><span class="op" id="3235512">(</span><span class="op" id="3235513">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3235517">}</span>&nbsp;<span class="keyword" id="3235519">else</span>&nbsp;<span class="op" id="3235524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3235529">switch</span>&nbsp;<span class="ident" id="3235536">v</span><span class="op" id="3235537">.</span><span class="ident" id="3235538">Kind</span><span class="op" id="3235542">(</span><span class="op" id="3235543">)</span>&nbsp;<span class="op" id="3235545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3235550">case</span>&nbsp;<span class="ident" id="3235555">reflect</span><span class="op" id="3235562">.</span><span class="ident" id="3235563">Chan</span><span class="op" id="3235567">,</span>&nbsp;<span class="ident" id="3235569">reflect</span><span class="op" id="3235576">.</span><span class="ident" id="3235577">Func</span><span class="op" id="3235581">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3235587">return</span>&nbsp;<span class="ident" id="3235594">nil</span><span class="op" id="3235597">,</span>&nbsp;<span class="builtintype" id="3235599">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3235608">}</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3235612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3235615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3235618">return</span>&nbsp;<span class="ident" id="3235625">v</span><span class="op" id="3235626">.</span><span class="ident" id="3235627">Interface</span><span class="op" id="3235636">(</span><span class="op" id="3235637">)</span><span class="op" id="3235638">,</span>&nbsp;<span class="builtintype" id="3235640">true</span><br>
<span class="lineno"></span><span class="op" id="3235645">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">805</span><span class="comment" id="3235648">//&nbsp;Types&nbsp;to&nbsp;help&nbsp;sort&nbsp;the&nbsp;keys&nbsp;in&nbsp;a&nbsp;map&nbsp;for&nbsp;reproducible&nbsp;output.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3235714">type</span>&nbsp;<span class="ident" id="3235719">rvs</span>&nbsp;<span class="op" id="3235723">[</span><span class="op" id="3235724">]</span><span class="ident" id="3235725">reflect</span><span class="op" id="3235732">.</span><span class="ident" id="3235733">Value</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3235740">func</span>&nbsp;<span class="op" id="3235745">(</span><span class="ident" id="3235746">x</span>&nbsp;<span class="ident" id="3235748">rvs</span><span class="op" id="3235751">)</span>&nbsp;<span class="ident" id="3235753">Len</span><span class="op" id="3235756">(</span><span class="op" id="3235757">)</span>&nbsp;<span class="builtintype" id="3235759">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3235768">{</span>&nbsp;<span class="keyword" id="3235770">return</span>&nbsp;<span class="builtinfunc" id="3235777">len</span><span class="op" id="3235780">(</span><span class="ident" id="3235781">x</span><span class="op" id="3235782">)</span>&nbsp;<span class="op" id="3235784">}</span><br>
<span class="lineno">810</span><span class="keyword" id="3235786">func</span>&nbsp;<span class="op" id="3235791">(</span><span class="ident" id="3235792">x</span>&nbsp;<span class="ident" id="3235794">rvs</span><span class="op" id="3235797">)</span>&nbsp;<span class="ident" id="3235799">Swap</span><span class="op" id="3235803">(</span><span class="ident" id="3235804">i</span><span class="op" id="3235805">,</span>&nbsp;<span class="ident" id="3235807">j</span>&nbsp;<span class="builtintype" id="3235809">int</span><span class="op" id="3235812">)</span>&nbsp;<span class="op" id="3235814">{</span>&nbsp;<span class="ident" id="3235816">x</span><span class="op" id="3235817">[</span><span class="ident" id="3235818">i</span><span class="op" id="3235819">]</span><span class="op" id="3235820">,</span>&nbsp;<span class="ident" id="3235822">x</span><span class="op" id="3235823">[</span><span class="ident" id="3235824">j</span><span class="op" id="3235825">]</span>&nbsp;<span class="op" id="3235827">=</span>&nbsp;<span class="ident" id="3235829">x</span><span class="op" id="3235830">[</span><span class="ident" id="3235831">j</span><span class="op" id="3235832">]</span><span class="op" id="3235833">,</span>&nbsp;<span class="ident" id="3235835">x</span><span class="op" id="3235836">[</span><span class="ident" id="3235837">i</span><span class="op" id="3235838">]</span>&nbsp;<span class="op" id="3235840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3235843">type</span>&nbsp;<span class="ident" id="3235848">rvInts</span>&nbsp;<span class="keyword" id="3235855">struct</span><span class="op" id="3235861">{</span>&nbsp;<span class="ident" id="3235863">rvs</span>&nbsp;<span class="op" id="3235867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3235870">func</span>&nbsp;<span class="op" id="3235875">(</span><span class="ident" id="3235876">x</span>&nbsp;<span class="ident" id="3235878">rvInts</span><span class="op" id="3235884">)</span>&nbsp;<span class="ident" id="3235886">Less</span><span class="op" id="3235890">(</span><span class="ident" id="3235891">i</span><span class="op" id="3235892">,</span>&nbsp;<span class="ident" id="3235894">j</span>&nbsp;<span class="builtintype" id="3235896">int</span><span class="op" id="3235899">)</span>&nbsp;<span class="builtintype" id="3235901">bool</span>&nbsp;<span class="op" id="3235906">{</span>&nbsp;<span class="keyword" id="3235908">return</span>&nbsp;<span class="ident" id="3235915">x</span><span class="op" id="3235916">.</span><span class="ident" id="3235917">rvs</span><span class="op" id="3235920">[</span><span class="ident" id="3235921">i</span><span class="op" id="3235922">]</span><span class="op" id="3235923">.</span><span class="ident" id="3235924">Int</span><span class="op" id="3235927">(</span><span class="op" id="3235928">)</span>&nbsp;<span class="op" id="3235930">&lt;</span>&nbsp;<span class="ident" id="3235932">x</span><span class="op" id="3235933">.</span><span class="ident" id="3235934">rvs</span><span class="op" id="3235937">[</span><span class="ident" id="3235938">j</span><span class="op" id="3235939">]</span><span class="op" id="3235940">.</span><span class="ident" id="3235941">Int</span><span class="op" id="3235944">(</span><span class="op" id="3235945">)</span>&nbsp;<span class="op" id="3235947">}</span><br>
<span class="lineno">815</span><br>
<span class="lineno"></span><span class="keyword" id="3235950">type</span>&nbsp;<span class="ident" id="3235955">rvUints</span>&nbsp;<span class="keyword" id="3235963">struct</span><span class="op" id="3235969">{</span>&nbsp;<span class="ident" id="3235971">rvs</span>&nbsp;<span class="op" id="3235975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3235978">func</span>&nbsp;<span class="op" id="3235983">(</span><span class="ident" id="3235984">x</span>&nbsp;<span class="ident" id="3235986">rvUints</span><span class="op" id="3235993">)</span>&nbsp;<span class="ident" id="3235995">Less</span><span class="op" id="3235999">(</span><span class="ident" id="3236000">i</span><span class="op" id="3236001">,</span>&nbsp;<span class="ident" id="3236003">j</span>&nbsp;<span class="builtintype" id="3236005">int</span><span class="op" id="3236008">)</span>&nbsp;<span class="builtintype" id="3236010">bool</span>&nbsp;<span class="op" id="3236015">{</span>&nbsp;<span class="keyword" id="3236017">return</span>&nbsp;<span class="ident" id="3236024">x</span><span class="op" id="3236025">.</span><span class="ident" id="3236026">rvs</span><span class="op" id="3236029">[</span><span class="ident" id="3236030">i</span><span class="op" id="3236031">]</span><span class="op" id="3236032">.</span><span class="ident" id="3236033">Uint</span><span class="op" id="3236037">(</span><span class="op" id="3236038">)</span>&nbsp;<span class="op" id="3236040">&lt;</span>&nbsp;<span class="ident" id="3236042">x</span><span class="op" id="3236043">.</span><span class="ident" id="3236044">rvs</span><span class="op" id="3236047">[</span><span class="ident" id="3236048">j</span><span class="op" id="3236049">]</span><span class="op" id="3236050">.</span><span class="ident" id="3236051">Uint</span><span class="op" id="3236055">(</span><span class="op" id="3236056">)</span>&nbsp;<span class="op" id="3236058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">820</span><span class="keyword" id="3236061">type</span>&nbsp;<span class="ident" id="3236066">rvFloats</span>&nbsp;<span class="keyword" id="3236075">struct</span><span class="op" id="3236081">{</span>&nbsp;<span class="ident" id="3236083">rvs</span>&nbsp;<span class="op" id="3236087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3236090">func</span>&nbsp;<span class="op" id="3236095">(</span><span class="ident" id="3236096">x</span>&nbsp;<span class="ident" id="3236098">rvFloats</span><span class="op" id="3236106">)</span>&nbsp;<span class="ident" id="3236108">Less</span><span class="op" id="3236112">(</span><span class="ident" id="3236113">i</span><span class="op" id="3236114">,</span>&nbsp;<span class="ident" id="3236116">j</span>&nbsp;<span class="builtintype" id="3236118">int</span><span class="op" id="3236121">)</span>&nbsp;<span class="builtintype" id="3236123">bool</span>&nbsp;<span class="op" id="3236128">{</span>&nbsp;<span class="keyword" id="3236130">return</span>&nbsp;<span class="ident" id="3236137">x</span><span class="op" id="3236138">.</span><span class="ident" id="3236139">rvs</span><span class="op" id="3236142">[</span><span class="ident" id="3236143">i</span><span class="op" id="3236144">]</span><span class="op" id="3236145">.</span><span class="ident" id="3236146">Float</span><span class="op" id="3236151">(</span><span class="op" id="3236152">)</span>&nbsp;<span class="op" id="3236154">&lt;</span>&nbsp;<span class="ident" id="3236156">x</span><span class="op" id="3236157">.</span><span class="ident" id="3236158">rvs</span><span class="op" id="3236161">[</span><span class="ident" id="3236162">j</span><span class="op" id="3236163">]</span><span class="op" id="3236164">.</span><span class="ident" id="3236165">Float</span><span class="op" id="3236170">(</span><span class="op" id="3236171">)</span>&nbsp;<span class="op" id="3236173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3236176">type</span>&nbsp;<span class="ident" id="3236181">rvStrings</span>&nbsp;<span class="keyword" id="3236191">struct</span><span class="op" id="3236197">{</span>&nbsp;<span class="ident" id="3236199">rvs</span>&nbsp;<span class="op" id="3236203">}</span><br>
<span class="lineno">825</span><br>
<span class="lineno"></span><span class="keyword" id="3236206">func</span>&nbsp;<span class="op" id="3236211">(</span><span class="ident" id="3236212">x</span>&nbsp;<span class="ident" id="3236214">rvStrings</span><span class="op" id="3236223">)</span>&nbsp;<span class="ident" id="3236225">Less</span><span class="op" id="3236229">(</span><span class="ident" id="3236230">i</span><span class="op" id="3236231">,</span>&nbsp;<span class="ident" id="3236233">j</span>&nbsp;<span class="builtintype" id="3236235">int</span><span class="op" id="3236238">)</span>&nbsp;<span class="builtintype" id="3236240">bool</span>&nbsp;<span class="op" id="3236245">{</span>&nbsp;<span class="keyword" id="3236247">return</span>&nbsp;<span class="ident" id="3236254">x</span><span class="op" id="3236255">.</span><span class="ident" id="3236256">rvs</span><span class="op" id="3236259">[</span><span class="ident" id="3236260">i</span><span class="op" id="3236261">]</span><span class="op" id="3236262">.</span><span class="ident" id="3236263">String</span><span class="op" id="3236269">(</span><span class="op" id="3236270">)</span>&nbsp;<span class="op" id="3236272">&lt;</span>&nbsp;<span class="ident" id="3236274">x</span><span class="op" id="3236275">.</span><span class="ident" id="3236276">rvs</span><span class="op" id="3236279">[</span><span class="ident" id="3236280">j</span><span class="op" id="3236281">]</span><span class="op" id="3236282">.</span><span class="ident" id="3236283">String</span><span class="op" id="3236289">(</span><span class="op" id="3236290">)</span>&nbsp;<span class="op" id="3236292">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3236295">//&nbsp;sortKeys&nbsp;sorts&nbsp;(if&nbsp;it&nbsp;can)&nbsp;the&nbsp;slice&nbsp;of&nbsp;reflect.Values,&nbsp;which&nbsp;is&nbsp;a&nbsp;slice&nbsp;of&nbsp;map&nbsp;keys.</span><br>
<span class="lineno"></span><span class="keyword" id="3236384">func</span>&nbsp;<span class="ident" id="3236389">sortKeys</span><span class="op" id="3236397">(</span><span class="ident" id="3236398">v</span>&nbsp;<span class="op" id="3236400">[</span><span class="op" id="3236401">]</span><span class="ident" id="3236402">reflect</span><span class="op" id="3236409">.</span><span class="ident" id="3236410">Value</span><span class="op" id="3236415">)</span>&nbsp;<span class="op" id="3236417">[</span><span class="op" id="3236418">]</span><span class="ident" id="3236419">reflect</span><span class="op" id="3236426">.</span><span class="ident" id="3236427">Value</span>&nbsp;<span class="op" id="3236433">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3236436">if</span>&nbsp;<span class="builtinfunc" id="3236439">len</span><span class="op" id="3236442">(</span><span class="ident" id="3236443">v</span><span class="op" id="3236444">)</span>&nbsp;<span class="op" id="3236446">&lt;=</span>&nbsp;<span class="num" id="3236449">1</span>&nbsp;<span class="op" id="3236451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3236455">return</span>&nbsp;<span class="ident" id="3236462">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3236465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3236468">switch</span>&nbsp;<span class="ident" id="3236475">v</span><span class="op" id="3236476">[</span><span class="num" id="3236477">0</span><span class="op" id="3236478">]</span><span class="op" id="3236479">.</span><span class="ident" id="3236480">Kind</span><span class="op" id="3236484">(</span><span class="op" id="3236485">)</span>&nbsp;<span class="op" id="3236487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3236490">case</span>&nbsp;<span class="ident" id="3236495">reflect</span><span class="op" id="3236502">.</span><span class="ident" id="3236503">Float32</span><span class="op" id="3236510">,</span>&nbsp;<span class="ident" id="3236512">reflect</span><span class="op" id="3236519">.</span><span class="ident" id="3236520">Float64</span><span class="op" id="3236527">:</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3236531">sort</span><span class="op" id="3236535">.</span><span class="ident" id="3236536">Sort</span><span class="op" id="3236540">(</span><span class="ident" id="3236541">rvFloats</span><span class="op" id="3236549">{</span><span class="ident" id="3236550">v</span><span class="op" id="3236551">}</span><span class="op" id="3236552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3236555">case</span>&nbsp;<span class="ident" id="3236560">reflect</span><span class="op" id="3236567">.</span><span class="ident" id="3236568">Int</span><span class="op" id="3236571">,</span>&nbsp;<span class="ident" id="3236573">reflect</span><span class="op" id="3236580">.</span><span class="ident" id="3236581">Int8</span><span class="op" id="3236585">,</span>&nbsp;<span class="ident" id="3236587">reflect</span><span class="op" id="3236594">.</span><span class="ident" id="3236595">Int16</span><span class="op" id="3236600">,</span>&nbsp;<span class="ident" id="3236602">reflect</span><span class="op" id="3236609">.</span><span class="ident" id="3236610">Int32</span><span class="op" id="3236615">,</span>&nbsp;<span class="ident" id="3236617">reflect</span><span class="op" id="3236624">.</span><span class="ident" id="3236625">Int64</span><span class="op" id="3236630">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3236634">sort</span><span class="op" id="3236638">.</span><span class="ident" id="3236639">Sort</span><span class="op" id="3236643">(</span><span class="ident" id="3236644">rvInts</span><span class="op" id="3236650">{</span><span class="ident" id="3236651">v</span><span class="op" id="3236652">}</span><span class="op" id="3236653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3236656">case</span>&nbsp;<span class="ident" id="3236661">reflect</span><span class="op" id="3236668">.</span><span class="ident" id="3236669">String</span><span class="op" id="3236675">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3236679">sort</span><span class="op" id="3236683">.</span><span class="ident" id="3236684">Sort</span><span class="op" id="3236688">(</span><span class="ident" id="3236689">rvStrings</span><span class="op" id="3236698">{</span><span class="ident" id="3236699">v</span><span class="op" id="3236700">}</span><span class="op" id="3236701">)</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3236704">case</span>&nbsp;<span class="ident" id="3236709">reflect</span><span class="op" id="3236716">.</span><span class="ident" id="3236717">Uint</span><span class="op" id="3236721">,</span>&nbsp;<span class="ident" id="3236723">reflect</span><span class="op" id="3236730">.</span><span class="ident" id="3236731">Uint8</span><span class="op" id="3236736">,</span>&nbsp;<span class="ident" id="3236738">reflect</span><span class="op" id="3236745">.</span><span class="ident" id="3236746">Uint16</span><span class="op" id="3236752">,</span>&nbsp;<span class="ident" id="3236754">reflect</span><span class="op" id="3236761">.</span><span class="ident" id="3236762">Uint32</span><span class="op" id="3236768">,</span>&nbsp;<span class="ident" id="3236770">reflect</span><span class="op" id="3236777">.</span><span class="ident" id="3236778">Uint64</span><span class="op" id="3236784">,</span>&nbsp;<span class="ident" id="3236786">reflect</span><span class="op" id="3236793">.</span><span class="ident" id="3236794">Uintptr</span><span class="op" id="3236801">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3236805">sort</span><span class="op" id="3236809">.</span><span class="ident" id="3236810">Sort</span><span class="op" id="3236814">(</span><span class="ident" id="3236815">rvUints</span><span class="op" id="3236822">{</span><span class="ident" id="3236823">v</span><span class="op" id="3236824">}</span><span class="op" id="3236825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3236828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3236831">return</span>&nbsp;<span class="ident" id="3236838">v</span><br>
<span class="lineno"></span><span class="op" id="3236840">}</span>
</div>
</body>
</html>
