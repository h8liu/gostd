<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3297572">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3297627">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3297681">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3297732">//&nbsp;Read&nbsp;static&nbsp;host/IP&nbsp;entries&nbsp;from&nbsp;/etc/hosts.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3297781">package</span>&nbsp;<span class="ident" id="3297789">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3297794">import</span>&nbsp;<span class="op" id="3297801">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3297804">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3297812">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3297819">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3297822">const</span>&nbsp;<span class="ident" id="3297828">cacheMaxAge</span>&nbsp;<span class="op" id="3297840">=</span>&nbsp;<span class="num" id="3297842">5</span>&nbsp;<span class="op" id="3297844">*</span>&nbsp;<span class="ident" id="3297846">time</span><span class="op" id="3297850">.</span><span class="ident" id="3297851">Minute</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="3297859">//&nbsp;hostsPath&nbsp;points&nbsp;to&nbsp;the&nbsp;file&nbsp;with&nbsp;static&nbsp;IP/address&nbsp;entries.</span><br>
<span class="lineno"></span><span class="keyword" id="3297923">var</span>&nbsp;<span class="ident" id="3297927">hostsPath</span>&nbsp;<span class="op" id="3297937">=</span>&nbsp;<span class="string" id="3297939">&#34;/etc/hosts&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3297953">//&nbsp;Simple&nbsp;cache.</span><br>
<span class="lineno">20</span><span class="keyword" id="3297970">var</span>&nbsp;<span class="ident" id="3297974">hosts</span>&nbsp;<span class="keyword" id="3297980">struct</span>&nbsp;<span class="op" id="3297987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3297990">sync</span><span class="op" id="3297994">.</span><span class="ident" id="3297995">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3298002">byName</span>&nbsp;<span class="keyword" id="3298009">map</span><span class="op" id="3298012">[</span><span class="builtintype" id="3298013">string</span><span class="op" id="3298019">]</span><span class="op" id="3298020">[</span><span class="op" id="3298021">]</span><span class="builtintype" id="3298022">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3298030">byAddr</span>&nbsp;<span class="keyword" id="3298037">map</span><span class="op" id="3298040">[</span><span class="builtintype" id="3298041">string</span><span class="op" id="3298047">]</span><span class="op" id="3298048">[</span><span class="op" id="3298049">]</span><span class="builtintype" id="3298050">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3298058">expire</span>&nbsp;<span class="ident" id="3298065">time</span><span class="op" id="3298069">.</span><span class="ident" id="3298070">Time</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3298076">path</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3298083">string</span><br>
<span class="lineno"></span><span class="op" id="3298090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3298093">func</span>&nbsp;<span class="ident" id="3298098">readHosts</span><span class="op" id="3298107">(</span><span class="op" id="3298108">)</span>&nbsp;<span class="op" id="3298110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3298113">now</span>&nbsp;<span class="op" id="3298117">:=</span>&nbsp;<span class="ident" id="3298120">time</span><span class="op" id="3298124">.</span><span class="ident" id="3298125">Now</span><span class="op" id="3298128">(</span><span class="op" id="3298129">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3298132">hp</span>&nbsp;<span class="op" id="3298135">:=</span>&nbsp;<span class="ident" id="3298138">hostsPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3298149">if</span>&nbsp;<span class="builtinfunc" id="3298152">len</span><span class="op" id="3298155">(</span><span class="ident" id="3298156">hosts</span><span class="op" id="3298161">.</span><span class="ident" id="3298162">byName</span><span class="op" id="3298168">)</span>&nbsp;<span class="op" id="3298170">==</span>&nbsp;<span class="num" id="3298173">0</span>&nbsp;<span class="op" id="3298175">||</span>&nbsp;<span class="ident" id="3298178">now</span><span class="op" id="3298181">.</span><span class="ident" id="3298182">After</span><span class="op" id="3298187">(</span><span class="ident" id="3298188">hosts</span><span class="op" id="3298193">.</span><span class="ident" id="3298194">expire</span><span class="op" id="3298200">)</span>&nbsp;<span class="op" id="3298202">||</span>&nbsp;<span class="ident" id="3298205">hosts</span><span class="op" id="3298210">.</span><span class="ident" id="3298211">path</span>&nbsp;<span class="op" id="3298216">!=</span>&nbsp;<span class="ident" id="3298219">hp</span>&nbsp;<span class="op" id="3298222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3298226">hs</span>&nbsp;<span class="op" id="3298229">:=</span>&nbsp;<span class="builtinfunc" id="3298232">make</span><span class="op" id="3298236">(</span><span class="keyword" id="3298237">map</span><span class="op" id="3298240">[</span><span class="builtintype" id="3298241">string</span><span class="op" id="3298247">]</span><span class="op" id="3298248">[</span><span class="op" id="3298249">]</span><span class="builtintype" id="3298250">string</span><span class="op" id="3298256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3298260">is</span>&nbsp;<span class="op" id="3298263">:=</span>&nbsp;<span class="builtinfunc" id="3298266">make</span><span class="op" id="3298270">(</span><span class="keyword" id="3298271">map</span><span class="op" id="3298274">[</span><span class="builtintype" id="3298275">string</span><span class="op" id="3298281">]</span><span class="op" id="3298282">[</span><span class="op" id="3298283">]</span><span class="builtintype" id="3298284">string</span><span class="op" id="3298290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3298294">var</span>&nbsp;<span class="ident" id="3298298">file</span>&nbsp;<span class="op" id="3298303">*</span><span class="ident" id="3298304">file</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3298311">if</span>&nbsp;<span class="ident" id="3298314">file</span><span class="op" id="3298318">,</span>&nbsp;<span class="ident" id="3298320">_</span>&nbsp;<span class="op" id="3298322">=</span>&nbsp;<span class="ident" id="3298324">open</span><span class="op" id="3298328">(</span><span class="ident" id="3298329">hp</span><span class="op" id="3298331">)</span><span class="op" id="3298332">;</span>&nbsp;<span class="ident" id="3298334">file</span>&nbsp;<span class="op" id="3298339">==</span>&nbsp;<span class="ident" id="3298342">nil</span>&nbsp;<span class="op" id="3298346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3298351">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3298360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3298364">for</span>&nbsp;<span class="ident" id="3298368">line</span><span class="op" id="3298372">,</span>&nbsp;<span class="ident" id="3298374">ok</span>&nbsp;<span class="op" id="3298377">:=</span>&nbsp;<span class="ident" id="3298380">file</span><span class="op" id="3298384">.</span><span class="ident" id="3298385">readLine</span><span class="op" id="3298393">(</span><span class="op" id="3298394">)</span><span class="op" id="3298395">;</span>&nbsp;<span class="ident" id="3298397">ok</span><span class="op" id="3298399">;</span>&nbsp;<span class="ident" id="3298401">line</span><span class="op" id="3298405">,</span>&nbsp;<span class="ident" id="3298407">ok</span>&nbsp;<span class="op" id="3298410">=</span>&nbsp;<span class="ident" id="3298412">file</span><span class="op" id="3298416">.</span><span class="ident" id="3298417">readLine</span><span class="op" id="3298425">(</span><span class="op" id="3298426">)</span>&nbsp;<span class="op" id="3298428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3298433">if</span>&nbsp;<span class="ident" id="3298436">i</span>&nbsp;<span class="op" id="3298438">:=</span>&nbsp;<span class="ident" id="3298441">byteIndex</span><span class="op" id="3298450">(</span><span class="ident" id="3298451">line</span><span class="op" id="3298455">,</span>&nbsp;<span class="string" id="3298457">&#39;#&#39;</span><span class="op" id="3298460">)</span><span class="op" id="3298461">;</span>&nbsp;<span class="ident" id="3298463">i</span>&nbsp;<span class="op" id="3298465">&gt;=</span>&nbsp;<span class="num" id="3298468">0</span>&nbsp;<span class="op" id="3298470">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3298476">//&nbsp;Discard&nbsp;comments.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3298501">line</span>&nbsp;<span class="op" id="3298506">=</span>&nbsp;<span class="ident" id="3298508">line</span><span class="op" id="3298512">[</span><span class="num" id="3298513">0</span><span class="op" id="3298514">:</span><span class="ident" id="3298515">i</span><span class="op" id="3298516">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3298521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3298526">f</span>&nbsp;<span class="op" id="3298528">:=</span>&nbsp;<span class="ident" id="3298531">getFields</span><span class="op" id="3298540">(</span><span class="ident" id="3298541">line</span><span class="op" id="3298545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3298550">if</span>&nbsp;<span class="builtinfunc" id="3298553">len</span><span class="op" id="3298556">(</span><span class="ident" id="3298557">f</span><span class="op" id="3298558">)</span>&nbsp;<span class="op" id="3298560">&lt;</span>&nbsp;<span class="num" id="3298562">2</span>&nbsp;<span class="op" id="3298564">||</span>&nbsp;<span class="ident" id="3298567">ParseIP</span><span class="op" id="3298574">(</span><span class="ident" id="3298575">f</span><span class="op" id="3298576">[</span><span class="num" id="3298577">0</span><span class="op" id="3298578">]</span><span class="op" id="3298579">)</span>&nbsp;<span class="op" id="3298581">==</span>&nbsp;<span class="ident" id="3298584">nil</span>&nbsp;<span class="op" id="3298588">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3298594">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3298606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3298611">for</span>&nbsp;<span class="ident" id="3298615">i</span>&nbsp;<span class="op" id="3298617">:=</span>&nbsp;<span class="num" id="3298620">1</span><span class="op" id="3298621">;</span>&nbsp;<span class="ident" id="3298623">i</span>&nbsp;<span class="op" id="3298625">&lt;</span>&nbsp;<span class="builtinfunc" id="3298627">len</span><span class="op" id="3298630">(</span><span class="ident" id="3298631">f</span><span class="op" id="3298632">)</span><span class="op" id="3298633">;</span>&nbsp;<span class="ident" id="3298635">i</span><span class="op" id="3298636">++</span>&nbsp;<span class="op" id="3298639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3298645">h</span>&nbsp;<span class="op" id="3298647">:=</span>&nbsp;<span class="ident" id="3298650">f</span><span class="op" id="3298651">[</span><span class="ident" id="3298652">i</span><span class="op" id="3298653">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3298659">hs</span><span class="op" id="3298661">[</span><span class="ident" id="3298662">h</span><span class="op" id="3298663">]</span>&nbsp;<span class="op" id="3298665">=</span>&nbsp;<span class="builtinfunc" id="3298667">append</span><span class="op" id="3298673">(</span><span class="ident" id="3298674">hs</span><span class="op" id="3298676">[</span><span class="ident" id="3298677">h</span><span class="op" id="3298678">]</span><span class="op" id="3298679">,</span>&nbsp;<span class="ident" id="3298681">f</span><span class="op" id="3298682">[</span><span class="num" id="3298683">0</span><span class="op" id="3298684">]</span><span class="op" id="3298685">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3298691">is</span><span class="op" id="3298693">[</span><span class="ident" id="3298694">f</span><span class="op" id="3298695">[</span><span class="num" id="3298696">0</span><span class="op" id="3298697">]</span><span class="op" id="3298698">]</span>&nbsp;<span class="op" id="3298700">=</span>&nbsp;<span class="builtinfunc" id="3298702">append</span><span class="op" id="3298708">(</span><span class="ident" id="3298709">is</span><span class="op" id="3298711">[</span><span class="ident" id="3298712">f</span><span class="op" id="3298713">[</span><span class="num" id="3298714">0</span><span class="op" id="3298715">]</span><span class="op" id="3298716">]</span><span class="op" id="3298717">,</span>&nbsp;<span class="ident" id="3298719">h</span><span class="op" id="3298720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3298725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3298729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3298733">//&nbsp;Update&nbsp;the&nbsp;data&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3298761">hosts</span><span class="op" id="3298766">.</span><span class="ident" id="3298767">expire</span>&nbsp;<span class="op" id="3298774">=</span>&nbsp;<span class="ident" id="3298776">now</span><span class="op" id="3298779">.</span><span class="ident" id="3298780">Add</span><span class="op" id="3298783">(</span><span class="ident" id="3298784">cacheMaxAge</span><span class="op" id="3298795">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3298799">hosts</span><span class="op" id="3298804">.</span><span class="ident" id="3298805">path</span>&nbsp;<span class="op" id="3298810">=</span>&nbsp;<span class="ident" id="3298812">hp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3298817">hosts</span><span class="op" id="3298822">.</span><span class="ident" id="3298823">byName</span>&nbsp;<span class="op" id="3298830">=</span>&nbsp;<span class="ident" id="3298832">hs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3298837">hosts</span><span class="op" id="3298842">.</span><span class="ident" id="3298843">byAddr</span>&nbsp;<span class="op" id="3298850">=</span>&nbsp;<span class="ident" id="3298852">is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3298857">file</span><span class="op" id="3298861">.</span><span class="builtinfunc" id="3298862">close</span><span class="op" id="3298867">(</span><span class="op" id="3298868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3298871">}</span><br>
<span class="lineno">60</span><span class="op" id="3298873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3298876">//&nbsp;lookupStaticHost&nbsp;looks&nbsp;up&nbsp;the&nbsp;addresses&nbsp;for&nbsp;the&nbsp;given&nbsp;host&nbsp;from&nbsp;/etc/hosts.</span><br>
<span class="lineno"></span><span class="keyword" id="3298955">func</span>&nbsp;<span class="ident" id="3298960">lookupStaticHost</span><span class="op" id="3298976">(</span><span class="ident" id="3298977">host</span>&nbsp;<span class="builtintype" id="3298982">string</span><span class="op" id="3298988">)</span>&nbsp;<span class="op" id="3298990">[</span><span class="op" id="3298991">]</span><span class="builtintype" id="3298992">string</span>&nbsp;<span class="op" id="3298999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3299002">hosts</span><span class="op" id="3299007">.</span><span class="ident" id="3299008">Lock</span><span class="op" id="3299012">(</span><span class="op" id="3299013">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299016">defer</span>&nbsp;<span class="ident" id="3299022">hosts</span><span class="op" id="3299027">.</span><span class="ident" id="3299028">Unlock</span><span class="op" id="3299034">(</span><span class="op" id="3299035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3299038">readHosts</span><span class="op" id="3299047">(</span><span class="op" id="3299048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299051">if</span>&nbsp;<span class="builtinfunc" id="3299054">len</span><span class="op" id="3299057">(</span><span class="ident" id="3299058">hosts</span><span class="op" id="3299063">.</span><span class="ident" id="3299064">byName</span><span class="op" id="3299070">)</span>&nbsp;<span class="op" id="3299072">!=</span>&nbsp;<span class="num" id="3299075">0</span>&nbsp;<span class="op" id="3299077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299081">if</span>&nbsp;<span class="ident" id="3299084">ips</span><span class="op" id="3299087">,</span>&nbsp;<span class="ident" id="3299089">ok</span>&nbsp;<span class="op" id="3299092">:=</span>&nbsp;<span class="ident" id="3299095">hosts</span><span class="op" id="3299100">.</span><span class="ident" id="3299101">byName</span><span class="op" id="3299107">[</span><span class="ident" id="3299108">host</span><span class="op" id="3299112">]</span><span class="op" id="3299113">;</span>&nbsp;<span class="ident" id="3299115">ok</span>&nbsp;<span class="op" id="3299118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299123">return</span>&nbsp;<span class="ident" id="3299130">ips</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3299136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3299139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299142">return</span>&nbsp;<span class="ident" id="3299149">nil</span><br>
<span class="lineno"></span><span class="op" id="3299153">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="3299156">//&nbsp;lookupStaticAddr&nbsp;looks&nbsp;up&nbsp;the&nbsp;hosts&nbsp;for&nbsp;the&nbsp;given&nbsp;address&nbsp;from&nbsp;/etc/hosts.</span><br>
<span class="lineno"></span><span class="keyword" id="3299234">func</span>&nbsp;<span class="ident" id="3299239">lookupStaticAddr</span><span class="op" id="3299255">(</span><span class="ident" id="3299256">addr</span>&nbsp;<span class="builtintype" id="3299261">string</span><span class="op" id="3299267">)</span>&nbsp;<span class="op" id="3299269">[</span><span class="op" id="3299270">]</span><span class="builtintype" id="3299271">string</span>&nbsp;<span class="op" id="3299278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3299281">hosts</span><span class="op" id="3299286">.</span><span class="ident" id="3299287">Lock</span><span class="op" id="3299291">(</span><span class="op" id="3299292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299295">defer</span>&nbsp;<span class="ident" id="3299301">hosts</span><span class="op" id="3299306">.</span><span class="ident" id="3299307">Unlock</span><span class="op" id="3299313">(</span><span class="op" id="3299314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3299317">readHosts</span><span class="op" id="3299326">(</span><span class="op" id="3299327">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299330">if</span>&nbsp;<span class="builtinfunc" id="3299333">len</span><span class="op" id="3299336">(</span><span class="ident" id="3299337">hosts</span><span class="op" id="3299342">.</span><span class="ident" id="3299343">byAddr</span><span class="op" id="3299349">)</span>&nbsp;<span class="op" id="3299351">!=</span>&nbsp;<span class="num" id="3299354">0</span>&nbsp;<span class="op" id="3299356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299360">if</span>&nbsp;<span class="ident" id="3299363">hosts</span><span class="op" id="3299368">,</span>&nbsp;<span class="ident" id="3299370">ok</span>&nbsp;<span class="op" id="3299373">:=</span>&nbsp;<span class="ident" id="3299376">hosts</span><span class="op" id="3299381">.</span><span class="ident" id="3299382">byAddr</span><span class="op" id="3299388">[</span><span class="ident" id="3299389">addr</span><span class="op" id="3299393">]</span><span class="op" id="3299394">;</span>&nbsp;<span class="ident" id="3299396">ok</span>&nbsp;<span class="op" id="3299399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299404">return</span>&nbsp;<span class="ident" id="3299411">hosts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3299419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3299422">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3299425">return</span>&nbsp;<span class="ident" id="3299432">nil</span><br>
<span class="lineno"></span><span class="op" id="3299436">}</span>
</div>
</body>
</html>
