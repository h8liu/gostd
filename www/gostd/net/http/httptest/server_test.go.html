<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http/httptest</h2>
<ul>
<li><a href="/gostd/net/http/httptest/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/httptest/recorder.go.html">recorder.go</a></li>
<li><a href="/gostd/net/http/httptest/recorder_test.go.html">recorder_test.go</a></li>
<li><a href="/gostd/net/http/httptest/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/httptest/server_test.go.html" class="current">server_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7347823">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7347878">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7347932">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7347983">package</span>&nbsp;<span class="ident" id="7347991">httptest</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7348001">import</span>&nbsp;<span class="op" id="7348008">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7348011">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7348024">&#34;net/http&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7348036">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7348046">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7348049">func</span>&nbsp;<span class="ident" id="7348054">TestServer</span><span class="op" id="7348064">(</span><span class="ident" id="7348065">t</span>&nbsp;<span class="op" id="7348067">*</span><span class="ident" id="7348068">testing</span><span class="op" id="7348075">.</span><span class="ident" id="7348076">T</span><span class="op" id="7348077">)</span>&nbsp;<span class="op" id="7348079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7348082">ts</span>&nbsp;<span class="op" id="7348085">:=</span>&nbsp;<span class="ident" id="7348088">NewServer</span><span class="op" id="7348097">(</span><span class="ident" id="7348098">http</span><span class="op" id="7348102">.</span><span class="ident" id="7348103">HandlerFunc</span><span class="op" id="7348114">(</span><span class="keyword" id="7348115">func</span><span class="op" id="7348119">(</span><span class="ident" id="7348120">w</span>&nbsp;<span class="ident" id="7348122">http</span><span class="op" id="7348126">.</span><span class="ident" id="7348127">ResponseWriter</span><span class="op" id="7348141">,</span>&nbsp;<span class="ident" id="7348143">r</span>&nbsp;<span class="op" id="7348145">*</span><span class="ident" id="7348146">http</span><span class="op" id="7348150">.</span><span class="ident" id="7348151">Request</span><span class="op" id="7348158">)</span>&nbsp;<span class="op" id="7348160">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7348164">w</span><span class="op" id="7348165">.</span><span class="ident" id="7348166">Write</span><span class="op" id="7348171">(</span><span class="op" id="7348172">[</span><span class="op" id="7348173">]</span><span class="builtintype" id="7348174">byte</span><span class="op" id="7348178">(</span><span class="string" id="7348179">&#34;hello&#34;</span><span class="op" id="7348186">)</span><span class="op" id="7348187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7348190">}</span><span class="op" id="7348191">)</span><span class="op" id="7348192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7348195">defer</span>&nbsp;<span class="ident" id="7348201">ts</span><span class="op" id="7348203">.</span><span class="ident" id="7348204">Close</span><span class="op" id="7348209">(</span><span class="op" id="7348210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7348213">res</span><span class="op" id="7348216">,</span>&nbsp;<span class="ident" id="7348218">err</span>&nbsp;<span class="op" id="7348222">:=</span>&nbsp;<span class="ident" id="7348225">http</span><span class="op" id="7348229">.</span><span class="ident" id="7348230">Get</span><span class="op" id="7348233">(</span><span class="ident" id="7348234">ts</span><span class="op" id="7348236">.</span><span class="ident" id="7348237">URL</span><span class="op" id="7348240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7348243">if</span>&nbsp;<span class="ident" id="7348246">err</span>&nbsp;<span class="op" id="7348250">!=</span>&nbsp;<span class="ident" id="7348253">nil</span>&nbsp;<span class="op" id="7348257">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7348261">t</span><span class="op" id="7348262">.</span><span class="ident" id="7348263">Fatal</span><span class="op" id="7348268">(</span><span class="ident" id="7348269">err</span><span class="op" id="7348272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7348275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7348278">got</span><span class="op" id="7348281">,</span>&nbsp;<span class="ident" id="7348283">err</span>&nbsp;<span class="op" id="7348287">:=</span>&nbsp;<span class="ident" id="7348290">ioutil</span><span class="op" id="7348296">.</span><span class="ident" id="7348297">ReadAll</span><span class="op" id="7348304">(</span><span class="ident" id="7348305">res</span><span class="op" id="7348308">.</span><span class="ident" id="7348309">Body</span><span class="op" id="7348313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7348316">if</span>&nbsp;<span class="ident" id="7348319">err</span>&nbsp;<span class="op" id="7348323">!=</span>&nbsp;<span class="ident" id="7348326">nil</span>&nbsp;<span class="op" id="7348330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7348334">t</span><span class="op" id="7348335">.</span><span class="ident" id="7348336">Fatal</span><span class="op" id="7348341">(</span><span class="ident" id="7348342">err</span><span class="op" id="7348345">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7348348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7348351">if</span>&nbsp;<span class="builtintype" id="7348354">string</span><span class="op" id="7348360">(</span><span class="ident" id="7348361">got</span><span class="op" id="7348364">)</span>&nbsp;<span class="op" id="7348366">!=</span>&nbsp;<span class="string" id="7348369">&#34;hello&#34;</span>&nbsp;<span class="op" id="7348377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7348381">t</span><span class="op" id="7348382">.</span><span class="ident" id="7348383">Errorf</span><span class="op" id="7348389">(</span><span class="string" id="7348390">&#34;got&nbsp;%q,&nbsp;want&nbsp;hello&#34;</span><span class="op" id="7348410">,</span>&nbsp;<span class="builtintype" id="7348412">string</span><span class="op" id="7348418">(</span><span class="ident" id="7348419">got</span><span class="op" id="7348422">)</span><span class="op" id="7348423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7348426">}</span><br>
<span class="lineno"></span><span class="op" id="7348428">}</span>
</div>
</body>
</html>
