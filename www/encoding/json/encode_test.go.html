<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7997016">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7997071">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7997125">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7997176">package</span>&nbsp;<span class="ident" id="7997184">json</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7997190">import</span>&nbsp;<span class="op" id="7997197">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7997200">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7997209">&#34;math&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7997217">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7997228">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7997239">&#34;unicode&#34;</span><br>
<span class="lineno"></span><span class="op" id="7997249">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="7997252">type</span>&nbsp;<span class="ident" id="7997257">Optionals</span>&nbsp;<span class="keyword" id="7997267">struct</span>&nbsp;<span class="op" id="7997274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997277">Sr</span>&nbsp;<span class="builtintype" id="7997280">string</span>&nbsp;<span class="string" id="7997287">`json:&#34;sr&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997300">So</span>&nbsp;<span class="builtintype" id="7997303">string</span>&nbsp;<span class="string" id="7997310">`json:&#34;so,omitempty&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997333">Sw</span>&nbsp;<span class="builtintype" id="7997336">string</span>&nbsp;<span class="string" id="7997343">`json:&#34;-&#34;`</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997356">Ir</span>&nbsp;<span class="builtintype" id="7997359">int</span>&nbsp;<span class="string" id="7997363">`json:&#34;omitempty&#34;`</span>&nbsp;<span class="comment" id="7997382">//&nbsp;actually&nbsp;named&nbsp;omitempty,&nbsp;not&nbsp;an&nbsp;option</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997426">Io</span>&nbsp;<span class="builtintype" id="7997429">int</span>&nbsp;<span class="string" id="7997433">`json:&#34;io,omitempty&#34;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997457">Slr</span>&nbsp;<span class="op" id="7997461">[</span><span class="op" id="7997462">]</span><span class="builtintype" id="7997463">string</span>&nbsp;<span class="string" id="7997470">`json:&#34;slr,random&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997491">Slo</span>&nbsp;<span class="op" id="7997495">[</span><span class="op" id="7997496">]</span><span class="builtintype" id="7997497">string</span>&nbsp;<span class="string" id="7997504">`json:&#34;slo,omitempty&#34;`</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997529">Mr</span>&nbsp;<span class="keyword" id="7997532">map</span><span class="op" id="7997535">[</span><span class="builtintype" id="7997536">string</span><span class="op" id="7997542">]</span><span class="keyword" id="7997543">interface</span><span class="op" id="7997552">{</span><span class="op" id="7997553">}</span>&nbsp;<span class="string" id="7997555">`json:&#34;mr&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997568">Mo</span>&nbsp;<span class="keyword" id="7997571">map</span><span class="op" id="7997574">[</span><span class="builtintype" id="7997575">string</span><span class="op" id="7997581">]</span><span class="keyword" id="7997582">interface</span><span class="op" id="7997591">{</span><span class="op" id="7997592">}</span>&nbsp;<span class="string" id="7997594">`json:&#34;,omitempty&#34;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997616">Fr</span>&nbsp;<span class="builtintype" id="7997619">float64</span>&nbsp;<span class="string" id="7997627">`json:&#34;fr&#34;`</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997640">Fo</span>&nbsp;<span class="builtintype" id="7997643">float64</span>&nbsp;<span class="string" id="7997651">`json:&#34;fo,omitempty&#34;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997675">Br</span>&nbsp;<span class="builtintype" id="7997678">bool</span>&nbsp;<span class="string" id="7997683">`json:&#34;br&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997696">Bo</span>&nbsp;<span class="builtintype" id="7997699">bool</span>&nbsp;<span class="string" id="7997704">`json:&#34;bo,omitempty&#34;`</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997728">Ur</span>&nbsp;<span class="builtintype" id="7997731">uint</span>&nbsp;<span class="string" id="7997736">`json:&#34;ur&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997749">Uo</span>&nbsp;<span class="builtintype" id="7997752">uint</span>&nbsp;<span class="string" id="7997757">`json:&#34;uo,omitempty&#34;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997781">Str</span>&nbsp;<span class="keyword" id="7997785">struct</span><span class="op" id="7997791">{</span><span class="op" id="7997792">}</span>&nbsp;<span class="string" id="7997794">`json:&#34;str&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7997808">Sto</span>&nbsp;<span class="keyword" id="7997812">struct</span><span class="op" id="7997818">{</span><span class="op" id="7997819">}</span>&nbsp;<span class="string" id="7997821">`json:&#34;sto,omitempty&#34;`</span><br>
<span class="lineno">40</span><span class="op" id="7997844">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7997847">var</span>&nbsp;<span class="ident" id="7997851">optionalsExpected</span>&nbsp;<span class="op" id="7997869">=</span>&nbsp;<span class="string" id="7997871">`{<br>
<span class="lineno"></span>&nbsp;&#34;sr&#34;:&nbsp;&#34;&#34;,<br>
<span class="lineno"></span>&nbsp;&#34;omitempty&#34;:&nbsp;0,<br>
<span class="lineno">45</span>&nbsp;&#34;slr&#34;:&nbsp;null,<br>
<span class="lineno"></span>&nbsp;&#34;mr&#34;:&nbsp;{},<br>
<span class="lineno"></span>&nbsp;&#34;fr&#34;:&nbsp;0,<br>
<span class="lineno"></span>&nbsp;&#34;br&#34;:&nbsp;false,<br>
<span class="lineno"></span>&nbsp;&#34;ur&#34;:&nbsp;0,<br>
<span class="lineno">50</span>&nbsp;&#34;str&#34;:&nbsp;{},<br>
<span class="lineno"></span>&nbsp;&#34;sto&#34;:&nbsp;{}<br>
<span class="lineno"></span>}`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7997988">func</span>&nbsp;<span class="ident" id="7997993">TestOmitEmpty</span><span class="op" id="7998006">(</span><span class="ident" id="7998007">t</span>&nbsp;<span class="op" id="7998009">*</span><span class="ident" id="7998010"><a href="/encoding/json/encode_test.go.html#7997228">testing</a></span><span class="op" id="7998017">.</span><span class="ident" id="7998018">T</span><span class="op" id="7998019">)</span>&nbsp;<span class="op" id="7998021">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7998024">var</span>&nbsp;<span class="ident" id="7998028">o</span>&nbsp;<span class="ident" id="7998030"><a href="/encoding/json/encode_test.go.html#7997257">Optionals</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7998041"><a href="/encoding/json/encode_test.go.html#7998028">o</a></span><span class="op" id="7998042">.</span><span class="ident" id="7998043">Sw</span>&nbsp;<span class="op" id="7998046">=</span>&nbsp;<span class="string" id="7998048">&#34;something&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7998061"><a href="/encoding/json/encode_test.go.html#7998028">o</a></span><span class="op" id="7998062">.</span><span class="ident" id="7998063">Mr</span>&nbsp;<span class="op" id="7998066">=</span>&nbsp;<span class="keyword" id="7998068">map</span><span class="op" id="7998071">[</span><span class="builtintype" id="7998072">string</span><span class="op" id="7998078">]</span><span class="keyword" id="7998079">interface</span><span class="op" id="7998088">{</span><span class="op" id="7998089">}</span><span class="op" id="7998090">{</span><span class="op" id="7998091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7998094"><a href="/encoding/json/encode_test.go.html#7998028">o</a></span><span class="op" id="7998095">.</span><span class="ident" id="7998096">Mo</span>&nbsp;<span class="op" id="7998099">=</span>&nbsp;<span class="keyword" id="7998101">map</span><span class="op" id="7998104">[</span><span class="builtintype" id="7998105">string</span><span class="op" id="7998111">]</span><span class="keyword" id="7998112">interface</span><span class="op" id="7998121">{</span><span class="op" id="7998122">}</span><span class="op" id="7998123">{</span><span class="op" id="7998124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7998128">got</span><span class="op" id="7998131">,</span>&nbsp;<span class="ident" id="7998133">err</span>&nbsp;<span class="op" id="7998137">:=</span>&nbsp;<span class="ident" id="7998140"><a href="/encoding/json/encode.go.html#3666728">MarshalIndent</a></span><span class="op" id="7998153">(</span><span class="op" id="7998154">&amp;</span><span class="ident" id="7998155"><a href="/encoding/json/encode_test.go.html#7998028">o</a></span><span class="op" id="7998156">,</span>&nbsp;<span class="string" id="7998158">&#34;&#34;</span><span class="op" id="7998160">,</span>&nbsp;<span class="string" id="7998162">&#34;&nbsp;&#34;</span><span class="op" id="7998165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7998168">if</span>&nbsp;<span class="ident" id="7998171"><a href="/encoding/json/encode_test.go.html#7998133">err</a></span>&nbsp;<span class="op" id="7998175">!=</span>&nbsp;<span class="ident" id="7998178">nil</span>&nbsp;<span class="op" id="7998182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7998186"><a href="/encoding/json/encode_test.go.html#7998007">t</a></span><span class="op" id="7998187">.</span><span class="ident" id="7998188">Fatal</span><span class="op" id="7998193">(</span><span class="ident" id="7998194"><a href="/encoding/json/encode_test.go.html#7998133">err</a></span><span class="op" id="7998197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7998200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7998203">if</span>&nbsp;<span class="ident" id="7998206">got</span>&nbsp;<span class="op" id="7998210">:=</span>&nbsp;<span class="builtintype" id="7998213">string</span><span class="op" id="7998219">(</span><span class="ident" id="7998220"><a href="/encoding/json/encode_test.go.html#7998128">got</a></span><span class="op" id="7998223">)</span><span class="op" id="7998224">;</span>&nbsp;<span class="ident" id="7998226"><a href="/encoding/json/encode_test.go.html#7998206">got</a></span>&nbsp;<span class="op" id="7998230">!=</span>&nbsp;<span class="ident" id="7998233"><a href="/encoding/json/encode_test.go.html#7997851">optionalsExpected</a></span>&nbsp;<span class="op" id="7998251">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7998255"><a href="/encoding/json/encode_test.go.html#7998007">t</a></span><span class="op" id="7998256">.</span><span class="ident" id="7998257">Errorf</span><span class="op" id="7998263">(</span><span class="string" id="7998264">&#34;&nbsp;got:&nbsp;%s\nwant:&nbsp;%s\n&#34;</span><span class="op" id="7998286">,</span>&nbsp;<span class="ident" id="7998288"><a href="/encoding/json/encode_test.go.html#7998206">got</a></span><span class="op" id="7998291">,</span>&nbsp;<span class="ident" id="7998293"><a href="/encoding/json/encode_test.go.html#7997851">optionalsExpected</a></span><span class="op" id="7998310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7998313">}</span><br>
<span class="lineno"></span><span class="op" id="7998315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7998318">type</span>&nbsp;<span class="ident" id="7998323">StringTag</span>&nbsp;<span class="keyword" id="7998333">struct</span>&nbsp;<span class="op" id="7998340">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7998343">BoolStr</span>&nbsp;<span class="builtintype" id="7998351">bool</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7998358">`json:&#34;,string&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7998376">IntStr</span>&nbsp;&nbsp;<span class="ident" id="7998384">int64</span>&nbsp;&nbsp;<span class="string" id="7998391">`json:&#34;,string&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7998409">StrStr</span>&nbsp;&nbsp;<span class="builtintype" id="7998417">string</span>&nbsp;<span class="string" id="7998424">`json:&#34;,string&#34;`</span><br>
<span class="lineno"></span><span class="op" id="7998441">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="7998444">var</span>&nbsp;<span class="ident" id="7998448">stringTagExpected</span>&nbsp;<span class="op" id="7998466">=</span>&nbsp;<span class="string" id="7998468">`{<br>
<span class="lineno"></span>&nbsp;&#34;BoolStr&#34;:&nbsp;&#34;true&#34;,<br>
<span class="lineno"></span>&nbsp;&#34;IntStr&#34;:&nbsp;&#34;42&#34;,<br>
<span class="lineno"></span>&nbsp;&#34;StrStr&#34;:&nbsp;&#34;\&#34;xzbit\&#34;&#34;<br>
<span class="lineno"></span>}`</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="keyword" id="7998535">func</span>&nbsp;<span class="ident" id="7998540">TestStringTag</span><span class="op" id="7998553">(</span><span class="ident" id="7998554">t</span>&nbsp;<span class="op" id="7998556">*</span><span class="ident" id="7998557"><a href="/encoding/json/encode_test.go.html#7997228">testing</a></span><span class="op" id="7998564">.</span><span class="ident" id="7998565">T</span><span class="op" id="7998566">)</span>&nbsp;<span class="op" id="7998568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7998571">var</span>&nbsp;<span class="ident" id="7998575">s</span>&nbsp;<span class="ident" id="7998577"><a href="/encoding/json/encode_test.go.html#7998323">StringTag</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7998588"><a href="/encoding/json/encode_test.go.html#7998575">s</a></span><span class="op" id="7998589">.</span><span class="ident" id="7998590">BoolStr</span>&nbsp;<span class="op" id="7998598">=</span>&nbsp;<span class="ident" id="7998600">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7998606"><a href="/encoding/json/encode_test.go.html#7998575">s</a></span><span class="op" id="7998607">.</span><span class="ident" id="7998608">IntStr</span>&nbsp;<span class="op" id="7998615">=</span>&nbsp;<span class="num" id="7998617">42</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7998621"><a href="/encoding/json/encode_test.go.html#7998575">s</a></span><span class="op" id="7998622">.</span><span class="ident" id="7998623">StrStr</span>&nbsp;<span class="op" id="7998630">=</span>&nbsp;<span class="string" id="7998632">&#34;xzbit&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7998641">got</span><span class="op" id="7998644">,</span>&nbsp;<span class="ident" id="7998646">err</span>&nbsp;<span class="op" id="7998650">:=</span>&nbsp;<span class="ident" id="7998653"><a href="/encoding/json/encode.go.html#3666728">MarshalIndent</a></span><span class="op" id="7998666">(</span><span class="op" id="7998667">&amp;</span><span class="ident" id="7998668"><a href="/encoding/json/encode_test.go.html#7998575">s</a></span><span class="op" id="7998669">,</span>&nbsp;<span class="string" id="7998671">&#34;&#34;</span><span class="op" id="7998673">,</span>&nbsp;<span class="string" id="7998675">&#34;&nbsp;&#34;</span><span class="op" id="7998678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7998681">if</span>&nbsp;<span class="ident" id="7998684"><a href="/encoding/json/encode_test.go.html#7998646">err</a></span>&nbsp;<span class="op" id="7998688">!=</span>&nbsp;<span class="ident" id="7998691">nil</span>&nbsp;<span class="op" id="7998695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7998699"><a href="/encoding/json/encode_test.go.html#7998554">t</a></span><span class="op" id="7998700">.</span><span class="ident" id="7998701">Fatal</span><span class="op" id="7998706">(</span><span class="ident" id="7998707"><a href="/encoding/json/encode_test.go.html#7998646">err</a></span><span class="op" id="7998710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7998713">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7998716">if</span>&nbsp;<span class="ident" id="7998719">got</span>&nbsp;<span class="op" id="7998723">:=</span>&nbsp;<span class="builtintype" id="7998726">string</span><span class="op" id="7998732">(</span><span class="ident" id="7998733"><a href="/encoding/json/encode_test.go.html#7998641">got</a></span><span class="op" id="7998736">)</span><span class="op" id="7998737">;</span>&nbsp;<span class="ident" id="7998739"><a href="/encoding/json/encode_test.go.html#7998719">got</a></span>&nbsp;<span class="op" id="7998743">!=</span>&nbsp;<span class="ident" id="7998746"><a href="/encoding/json/encode_test.go.html#7998448">stringTagExpected</a></span>&nbsp;<span class="op" id="7998764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7998768"><a href="/encoding/json/encode_test.go.html#7998554">t</a></span><span class="op" id="7998769">.</span><span class="ident" id="7998770">Fatalf</span><span class="op" id="7998776">(</span><span class="string" id="7998777">&#34;&nbsp;got:&nbsp;%s\nwant:&nbsp;%s\n&#34;</span><span class="op" id="7998799">,</span>&nbsp;<span class="ident" id="7998801"><a href="/encoding/json/encode_test.go.html#7998719">got</a></span><span class="op" id="7998804">,</span>&nbsp;<span class="ident" id="7998806"><a href="/encoding/json/encode_test.go.html#7998448">stringTagExpected</a></span><span class="op" id="7998823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7998826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7998830">//&nbsp;Verify&nbsp;that&nbsp;it&nbsp;round-trips.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7998862">var</span>&nbsp;<span class="ident" id="7998866">s2</span>&nbsp;<span class="ident" id="7998869"><a href="/encoding/json/encode_test.go.html#7998323">StringTag</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7998880"><a href="/encoding/json/encode_test.go.html#7998646">err</a></span>&nbsp;<span class="op" id="7998884">=</span>&nbsp;<span class="ident" id="7998886"><a href="/encoding/json/stream.go.html#3715917">NewDecoder</a></span><span class="op" id="7998896">(</span><span class="ident" id="7998897"><a href="/encoding/json/encode_test.go.html#7997200">bytes</a></span><span class="op" id="7998902">.</span><span class="ident" id="7998903">NewReader</span><span class="op" id="7998912">(</span><span class="ident" id="7998913"><a href="/encoding/json/encode_test.go.html#7998641">got</a></span><span class="op" id="7998916">)</span><span class="op" id="7998917">)</span><span class="op" id="7998918">.</span><span class="ident" id="7998919">Decode</span><span class="op" id="7998925">(</span><span class="op" id="7998926">&amp;</span><span class="ident" id="7998927"><a href="/encoding/json/encode_test.go.html#7998866">s2</a></span><span class="op" id="7998929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7998932">if</span>&nbsp;<span class="ident" id="7998935"><a href="/encoding/json/encode_test.go.html#7998646">err</a></span>&nbsp;<span class="op" id="7998939">!=</span>&nbsp;<span class="ident" id="7998942">nil</span>&nbsp;<span class="op" id="7998946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7998950"><a href="/encoding/json/encode_test.go.html#7998554">t</a></span><span class="op" id="7998951">.</span><span class="ident" id="7998952">Fatalf</span><span class="op" id="7998958">(</span><span class="string" id="7998959">&#34;Decode:&nbsp;%v&#34;</span><span class="op" id="7998971">,</span>&nbsp;<span class="ident" id="7998973"><a href="/encoding/json/encode_test.go.html#7998646">err</a></span><span class="op" id="7998976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7998979">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7998982">if</span>&nbsp;<span class="op" id="7998985">!</span><span class="ident" id="7998986"><a href="/encoding/json/encode_test.go.html#7997217">reflect</a></span><span class="op" id="7998993">.</span><span class="ident" id="7998994">DeepEqual</span><span class="op" id="7999003">(</span><span class="ident" id="7999004"><a href="/encoding/json/encode_test.go.html#7998575">s</a></span><span class="op" id="7999005">,</span>&nbsp;<span class="ident" id="7999007"><a href="/encoding/json/encode_test.go.html#7998866">s2</a></span><span class="op" id="7999009">)</span>&nbsp;<span class="op" id="7999011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999015"><a href="/encoding/json/encode_test.go.html#7998554">t</a></span><span class="op" id="7999016">.</span><span class="ident" id="7999017">Fatalf</span><span class="op" id="7999023">(</span><span class="string" id="7999024">&#34;decode&nbsp;didn&#39;t&nbsp;match.\nsource:&nbsp;%#v\nEncoded&nbsp;as:\n%s\ndecode:&nbsp;%#v&#34;</span><span class="op" id="7999089">,</span>&nbsp;<span class="ident" id="7999091"><a href="/encoding/json/encode_test.go.html#7998575">s</a></span><span class="op" id="7999092">,</span>&nbsp;<span class="builtintype" id="7999094">string</span><span class="op" id="7999100">(</span><span class="ident" id="7999101"><a href="/encoding/json/encode_test.go.html#7998641">got</a></span><span class="op" id="7999104">)</span><span class="op" id="7999105">,</span>&nbsp;<span class="ident" id="7999107"><a href="/encoding/json/encode_test.go.html#7998866">s2</a></span><span class="op" id="7999109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7999112">}</span><br>
<span class="lineno"></span><span class="op" id="7999114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="7999117">//&nbsp;byte&nbsp;slices&nbsp;are&nbsp;special&nbsp;even&nbsp;if&nbsp;they&#39;re&nbsp;renamed&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="7999175">type</span>&nbsp;<span class="ident" id="7999180">renamedByte</span>&nbsp;<span class="builtintype" id="7999192">byte</span><br>
<span class="lineno"></span><span class="keyword" id="7999197">type</span>&nbsp;<span class="ident" id="7999202">renamedByteSlice</span>&nbsp;<span class="op" id="7999219">[</span><span class="op" id="7999220">]</span><span class="builtintype" id="7999221">byte</span><br>
<span class="lineno"></span><span class="keyword" id="7999226">type</span>&nbsp;<span class="ident" id="7999231">renamedRenamedByteSlice</span>&nbsp;<span class="op" id="7999255">[</span><span class="op" id="7999256">]</span><span class="ident" id="7999257"><a href="/encoding/json/encode_test.go.html#7999180">renamedByte</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="7999270">func</span>&nbsp;<span class="ident" id="7999275">TestEncodeRenamedByteSlice</span><span class="op" id="7999301">(</span><span class="ident" id="7999302">t</span>&nbsp;<span class="op" id="7999304">*</span><span class="ident" id="7999305"><a href="/encoding/json/encode_test.go.html#7997228">testing</a></span><span class="op" id="7999312">.</span><span class="ident" id="7999313">T</span><span class="op" id="7999314">)</span>&nbsp;<span class="op" id="7999316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999319">s</span>&nbsp;<span class="op" id="7999321">:=</span>&nbsp;<span class="ident" id="7999324"><a href="/encoding/json/encode_test.go.html#7999202">renamedByteSlice</a></span><span class="op" id="7999340">(</span><span class="string" id="7999341">&#34;abc&#34;</span><span class="op" id="7999346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999349">result</span><span class="op" id="7999355">,</span>&nbsp;<span class="ident" id="7999357">err</span>&nbsp;<span class="op" id="7999361">:=</span>&nbsp;<span class="ident" id="7999364"><a href="/encoding/json/encode.go.html#3666502">Marshal</a></span><span class="op" id="7999371">(</span><span class="ident" id="7999372"><a href="/encoding/json/encode_test.go.html#7999319">s</a></span><span class="op" id="7999373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7999376">if</span>&nbsp;<span class="ident" id="7999379"><a href="/encoding/json/encode_test.go.html#7999357">err</a></span>&nbsp;<span class="op" id="7999383">!=</span>&nbsp;<span class="ident" id="7999386">nil</span>&nbsp;<span class="op" id="7999390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999394"><a href="/encoding/json/encode_test.go.html#7999302">t</a></span><span class="op" id="7999395">.</span><span class="ident" id="7999396">Fatal</span><span class="op" id="7999401">(</span><span class="ident" id="7999402"><a href="/encoding/json/encode_test.go.html#7999357">err</a></span><span class="op" id="7999405">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7999408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999411">expect</span>&nbsp;<span class="op" id="7999418">:=</span>&nbsp;<span class="string" id="7999421">`&#34;YWJj&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7999431">if</span>&nbsp;<span class="builtintype" id="7999434">string</span><span class="op" id="7999440">(</span><span class="ident" id="7999441"><a href="/encoding/json/encode_test.go.html#7999349">result</a></span><span class="op" id="7999447">)</span>&nbsp;<span class="op" id="7999449">!=</span>&nbsp;<span class="ident" id="7999452"><a href="/encoding/json/encode_test.go.html#7999411">expect</a></span>&nbsp;<span class="op" id="7999459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999463"><a href="/encoding/json/encode_test.go.html#7999302">t</a></span><span class="op" id="7999464">.</span><span class="ident" id="7999465">Errorf</span><span class="op" id="7999471">(</span><span class="string" id="7999472">&#34;&nbsp;got&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7999489">,</span>&nbsp;<span class="ident" id="7999491"><a href="/encoding/json/encode_test.go.html#7999349">result</a></span><span class="op" id="7999497">,</span>&nbsp;<span class="ident" id="7999499"><a href="/encoding/json/encode_test.go.html#7999411">expect</a></span><span class="op" id="7999505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7999508">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999511">r</span>&nbsp;<span class="op" id="7999513">:=</span>&nbsp;<span class="ident" id="7999516"><a href="/encoding/json/encode_test.go.html#7999231">renamedRenamedByteSlice</a></span><span class="op" id="7999539">(</span><span class="string" id="7999540">&#34;abc&#34;</span><span class="op" id="7999545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999548"><a href="/encoding/json/encode_test.go.html#7999349">result</a></span><span class="op" id="7999554">,</span>&nbsp;<span class="ident" id="7999556"><a href="/encoding/json/encode_test.go.html#7999357">err</a></span>&nbsp;<span class="op" id="7999560">=</span>&nbsp;<span class="ident" id="7999562"><a href="/encoding/json/encode.go.html#3666502">Marshal</a></span><span class="op" id="7999569">(</span><span class="ident" id="7999570"><a href="/encoding/json/encode_test.go.html#7999511">r</a></span><span class="op" id="7999571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7999574">if</span>&nbsp;<span class="ident" id="7999577"><a href="/encoding/json/encode_test.go.html#7999357">err</a></span>&nbsp;<span class="op" id="7999581">!=</span>&nbsp;<span class="ident" id="7999584">nil</span>&nbsp;<span class="op" id="7999588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999592"><a href="/encoding/json/encode_test.go.html#7999302">t</a></span><span class="op" id="7999593">.</span><span class="ident" id="7999594">Fatal</span><span class="op" id="7999599">(</span><span class="ident" id="7999600"><a href="/encoding/json/encode_test.go.html#7999357">err</a></span><span class="op" id="7999603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7999606">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7999609">if</span>&nbsp;<span class="builtintype" id="7999612">string</span><span class="op" id="7999618">(</span><span class="ident" id="7999619"><a href="/encoding/json/encode_test.go.html#7999349">result</a></span><span class="op" id="7999625">)</span>&nbsp;<span class="op" id="7999627">!=</span>&nbsp;<span class="ident" id="7999630"><a href="/encoding/json/encode_test.go.html#7999411">expect</a></span>&nbsp;<span class="op" id="7999637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999641"><a href="/encoding/json/encode_test.go.html#7999302">t</a></span><span class="op" id="7999642">.</span><span class="ident" id="7999643">Errorf</span><span class="op" id="7999649">(</span><span class="string" id="7999650">&#34;&nbsp;got&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7999667">,</span>&nbsp;<span class="ident" id="7999669"><a href="/encoding/json/encode_test.go.html#7999349">result</a></span><span class="op" id="7999675">,</span>&nbsp;<span class="ident" id="7999677"><a href="/encoding/json/encode_test.go.html#7999411">expect</a></span><span class="op" id="7999683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7999686">}</span><br>
<span class="lineno"></span><span class="op" id="7999688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="7999691">var</span>&nbsp;<span class="ident" id="7999695">unsupportedValues</span>&nbsp;<span class="op" id="7999713">=</span>&nbsp;<span class="op" id="7999715">[</span><span class="op" id="7999716">]</span><span class="keyword" id="7999717">interface</span><span class="op" id="7999726">{</span><span class="op" id="7999727">}</span><span class="op" id="7999728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999731"><a href="/encoding/json/encode_test.go.html#7997209">math</a></span><span class="op" id="7999735">.</span><span class="ident" id="7999736">NaN</span><span class="op" id="7999739">(</span><span class="op" id="7999740">)</span><span class="op" id="7999741">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999744"><a href="/encoding/json/encode_test.go.html#7997209">math</a></span><span class="op" id="7999748">.</span><span class="ident" id="7999749">Inf</span><span class="op" id="7999752">(</span><span class="op" id="7999753">-</span><span class="num" id="7999754">1</span><span class="op" id="7999755">)</span><span class="op" id="7999756">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999759"><a href="/encoding/json/encode_test.go.html#7997209">math</a></span><span class="op" id="7999763">.</span><span class="ident" id="7999764">Inf</span><span class="op" id="7999767">(</span><span class="num" id="7999768">1</span><span class="op" id="7999769">)</span><span class="op" id="7999770">,</span><br>
<span class="lineno"></span><span class="op" id="7999772">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="keyword" id="7999775">func</span>&nbsp;<span class="ident" id="7999780">TestUnsupportedValues</span><span class="op" id="7999801">(</span><span class="ident" id="7999802">t</span>&nbsp;<span class="op" id="7999804">*</span><span class="ident" id="7999805"><a href="/encoding/json/encode_test.go.html#7997228">testing</a></span><span class="op" id="7999812">.</span><span class="ident" id="7999813">T</span><span class="op" id="7999814">)</span>&nbsp;<span class="op" id="7999816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7999819">for</span>&nbsp;<span class="ident" id="7999823">_</span><span class="op" id="7999824">,</span>&nbsp;<span class="ident" id="7999826">v</span>&nbsp;<span class="op" id="7999828">:=</span>&nbsp;<span class="keyword" id="7999831">range</span>&nbsp;<span class="ident" id="7999837"><a href="/encoding/json/encode_test.go.html#7999695">unsupportedValues</a></span>&nbsp;<span class="op" id="7999855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7999859">if</span>&nbsp;<span class="ident" id="7999862">_</span><span class="op" id="7999863">,</span>&nbsp;<span class="ident" id="7999865">err</span>&nbsp;<span class="op" id="7999869">:=</span>&nbsp;<span class="ident" id="7999872"><a href="/encoding/json/encode.go.html#3666502">Marshal</a></span><span class="op" id="7999879">(</span><span class="ident" id="7999880"><a href="/encoding/json/encode_test.go.html#7999826">v</a></span><span class="op" id="7999881">)</span><span class="op" id="7999882">;</span>&nbsp;<span class="ident" id="7999884"><a href="/encoding/json/encode_test.go.html#7999865">err</a></span>&nbsp;<span class="op" id="7999888">!=</span>&nbsp;<span class="ident" id="7999891">nil</span>&nbsp;<span class="op" id="7999895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7999900">if</span>&nbsp;<span class="ident" id="7999903">_</span><span class="op" id="7999904">,</span>&nbsp;<span class="ident" id="7999906">ok</span>&nbsp;<span class="op" id="7999909">:=</span>&nbsp;<span class="ident" id="7999912"><a href="/encoding/json/encode_test.go.html#7999865">err</a></span><span class="op" id="7999915">.</span><span class="op" id="7999916">(</span><span class="op" id="7999917">*</span><span class="ident" id="7999918"><a href="/encoding/json/encode.go.html#3668518">UnsupportedValueError</a></span><span class="op" id="7999939">)</span><span class="op" id="7999940">;</span>&nbsp;<span class="op" id="7999942">!</span><span class="ident" id="7999943"><a href="/encoding/json/encode_test.go.html#7999906">ok</a></span>&nbsp;<span class="op" id="7999946">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7999952"><a href="/encoding/json/encode_test.go.html#7999802">t</a></span><span class="op" id="7999953">.</span><span class="ident" id="7999954">Errorf</span><span class="op" id="7999960">(</span><span class="string" id="7999961">&#34;for&nbsp;%v,&nbsp;got&nbsp;%T&nbsp;want&nbsp;UnsupportedValueError&#34;</span><span class="op" id="8000004">,</span>&nbsp;<span class="ident" id="8000006"><a href="/encoding/json/encode_test.go.html#7999826">v</a></span><span class="op" id="8000007">,</span>&nbsp;<span class="ident" id="8000009"><a href="/encoding/json/encode_test.go.html#7999865">err</a></span><span class="op" id="8000012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8000017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8000021">}</span>&nbsp;<span class="keyword" id="8000023">else</span>&nbsp;<span class="op" id="8000028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8000033"><a href="/encoding/json/encode_test.go.html#7999802">t</a></span><span class="op" id="8000034">.</span><span class="ident" id="8000035">Errorf</span><span class="op" id="8000041">(</span><span class="string" id="8000042">&#34;for&nbsp;%v,&nbsp;expected&nbsp;error&#34;</span><span class="op" id="8000066">,</span>&nbsp;<span class="ident" id="8000068"><a href="/encoding/json/encode_test.go.html#7999826">v</a></span><span class="op" id="8000069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8000073">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8000076">}</span><br>
<span class="lineno"></span><span class="op" id="8000078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8000081">//&nbsp;Ref&nbsp;has&nbsp;Marshaler&nbsp;and&nbsp;Unmarshaler&nbsp;methods&nbsp;with&nbsp;pointer&nbsp;receiver.</span><br>
<span class="lineno"></span><span class="keyword" id="8000149">type</span>&nbsp;<span class="ident" id="8000154">Ref</span>&nbsp;<span class="builtintype" id="8000158">int</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="8000163">func</span>&nbsp;<span class="op" id="8000168">(</span><span class="op" id="8000169">*</span><span class="ident" id="8000170"><a href="/encoding/json/encode_test.go.html#8000154">Ref</a></span><span class="op" id="8000173">)</span>&nbsp;<span class="ident" id="8000175">MarshalJSON</span><span class="op" id="8000186">(</span><span class="op" id="8000187">)</span>&nbsp;<span class="op" id="8000189">(</span><span class="op" id="8000190">[</span><span class="op" id="8000191">]</span><span class="builtintype" id="8000192">byte</span><span class="op" id="8000196">,</span>&nbsp;<span class="builtintype" id="8000198">error</span><span class="op" id="8000203">)</span>&nbsp;<span class="op" id="8000205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8000208">return</span>&nbsp;<span class="op" id="8000215">[</span><span class="op" id="8000216">]</span><span class="builtintype" id="8000217">byte</span><span class="op" id="8000221">(</span><span class="string" id="8000222">`&#34;ref&#34;`</span><span class="op" id="8000229">)</span><span class="op" id="8000230">,</span>&nbsp;<span class="ident" id="8000232">nil</span><br>
<span class="lineno"></span><span class="op" id="8000236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="keyword" id="8000239">func</span>&nbsp;<span class="op" id="8000244">(</span><span class="ident" id="8000245">r</span>&nbsp;<span class="op" id="8000247">*</span><span class="ident" id="8000248"><a href="/encoding/json/encode_test.go.html#8000154">Ref</a></span><span class="op" id="8000251">)</span>&nbsp;<span class="ident" id="8000253">UnmarshalJSON</span><span class="op" id="8000266">(</span><span class="op" id="8000267">[</span><span class="op" id="8000268">]</span><span class="builtintype" id="8000269">byte</span><span class="op" id="8000273">)</span>&nbsp;<span class="builtintype" id="8000275">error</span>&nbsp;<span class="op" id="8000281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8000284">*</span><span class="ident" id="8000285"><a href="/encoding/json/encode_test.go.html#8000245">r</a></span>&nbsp;<span class="op" id="8000287">=</span>&nbsp;<span class="num" id="8000289">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8000293">return</span>&nbsp;<span class="ident" id="8000300">nil</span><br>
<span class="lineno"></span><span class="op" id="8000304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span><span class="comment" id="8000307">//&nbsp;Val&nbsp;has&nbsp;Marshaler&nbsp;methods&nbsp;with&nbsp;value&nbsp;receiver.</span><br>
<span class="lineno"></span><span class="keyword" id="8000357">type</span>&nbsp;<span class="ident" id="8000362">Val</span>&nbsp;<span class="builtintype" id="8000366">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8000371">func</span>&nbsp;<span class="op" id="8000376">(</span><span class="ident" id="8000377"><a href="/encoding/json/encode_test.go.html#8000362">Val</a></span><span class="op" id="8000380">)</span>&nbsp;<span class="ident" id="8000382">MarshalJSON</span><span class="op" id="8000393">(</span><span class="op" id="8000394">)</span>&nbsp;<span class="op" id="8000396">(</span><span class="op" id="8000397">[</span><span class="op" id="8000398">]</span><span class="builtintype" id="8000399">byte</span><span class="op" id="8000403">,</span>&nbsp;<span class="builtintype" id="8000405">error</span><span class="op" id="8000410">)</span>&nbsp;<span class="op" id="8000412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8000415">return</span>&nbsp;<span class="op" id="8000422">[</span><span class="op" id="8000423">]</span><span class="builtintype" id="8000424">byte</span><span class="op" id="8000428">(</span><span class="string" id="8000429">`&#34;val&#34;`</span><span class="op" id="8000436">)</span><span class="op" id="8000437">,</span>&nbsp;<span class="ident" id="8000439">nil</span><br>
<span class="lineno">165</span><span class="op" id="8000443">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8000446">//&nbsp;RefText&nbsp;has&nbsp;Marshaler&nbsp;and&nbsp;Unmarshaler&nbsp;methods&nbsp;with&nbsp;pointer&nbsp;receiver.</span><br>
<span class="lineno"></span><span class="keyword" id="8000518">type</span>&nbsp;<span class="ident" id="8000523">RefText</span>&nbsp;<span class="builtintype" id="8000531">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="8000536">func</span>&nbsp;<span class="op" id="8000541">(</span><span class="op" id="8000542">*</span><span class="ident" id="8000543"><a href="/encoding/json/encode_test.go.html#8000523">RefText</a></span><span class="op" id="8000550">)</span>&nbsp;<span class="ident" id="8000552">MarshalText</span><span class="op" id="8000563">(</span><span class="op" id="8000564">)</span>&nbsp;<span class="op" id="8000566">(</span><span class="op" id="8000567">[</span><span class="op" id="8000568">]</span><span class="builtintype" id="8000569">byte</span><span class="op" id="8000573">,</span>&nbsp;<span class="builtintype" id="8000575">error</span><span class="op" id="8000580">)</span>&nbsp;<span class="op" id="8000582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8000585">return</span>&nbsp;<span class="op" id="8000592">[</span><span class="op" id="8000593">]</span><span class="builtintype" id="8000594">byte</span><span class="op" id="8000598">(</span><span class="string" id="8000599">`&#34;ref&#34;`</span><span class="op" id="8000606">)</span><span class="op" id="8000607">,</span>&nbsp;<span class="ident" id="8000609">nil</span><br>
<span class="lineno"></span><span class="op" id="8000613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8000616">func</span>&nbsp;<span class="op" id="8000621">(</span><span class="ident" id="8000622">r</span>&nbsp;<span class="op" id="8000624">*</span><span class="ident" id="8000625"><a href="/encoding/json/encode_test.go.html#8000523">RefText</a></span><span class="op" id="8000632">)</span>&nbsp;<span class="ident" id="8000634">UnmarshalText</span><span class="op" id="8000647">(</span><span class="op" id="8000648">[</span><span class="op" id="8000649">]</span><span class="builtintype" id="8000650">byte</span><span class="op" id="8000654">)</span>&nbsp;<span class="builtintype" id="8000656">error</span>&nbsp;<span class="op" id="8000662">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8000665">*</span><span class="ident" id="8000666"><a href="/encoding/json/encode_test.go.html#8000622">r</a></span>&nbsp;<span class="op" id="8000668">=</span>&nbsp;<span class="num" id="8000670">13</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8000674">return</span>&nbsp;<span class="ident" id="8000681">nil</span><br>
<span class="lineno"></span><span class="op" id="8000685">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8000688">//&nbsp;ValText&nbsp;has&nbsp;Marshaler&nbsp;methods&nbsp;with&nbsp;value&nbsp;receiver.</span><br>
<span class="lineno">180</span><span class="keyword" id="8000742">type</span>&nbsp;<span class="ident" id="8000747">ValText</span>&nbsp;<span class="builtintype" id="8000755">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8000760">func</span>&nbsp;<span class="op" id="8000765">(</span><span class="ident" id="8000766"><a href="/encoding/json/encode_test.go.html#8000747">ValText</a></span><span class="op" id="8000773">)</span>&nbsp;<span class="ident" id="8000775">MarshalText</span><span class="op" id="8000786">(</span><span class="op" id="8000787">)</span>&nbsp;<span class="op" id="8000789">(</span><span class="op" id="8000790">[</span><span class="op" id="8000791">]</span><span class="builtintype" id="8000792">byte</span><span class="op" id="8000796">,</span>&nbsp;<span class="builtintype" id="8000798">error</span><span class="op" id="8000803">)</span>&nbsp;<span class="op" id="8000805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8000808">return</span>&nbsp;<span class="op" id="8000815">[</span><span class="op" id="8000816">]</span><span class="builtintype" id="8000817">byte</span><span class="op" id="8000821">(</span><span class="string" id="8000822">`&#34;val&#34;`</span><span class="op" id="8000829">)</span><span class="op" id="8000830">,</span>&nbsp;<span class="ident" id="8000832">nil</span><br>
<span class="lineno"></span><span class="op" id="8000836">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="8000839">func</span>&nbsp;<span class="ident" id="8000844">TestRefValMarshal</span><span class="op" id="8000861">(</span><span class="ident" id="8000862">t</span>&nbsp;<span class="op" id="8000864">*</span><span class="ident" id="8000865"><a href="/encoding/json/encode_test.go.html#7997228">testing</a></span><span class="op" id="8000872">.</span><span class="ident" id="8000873">T</span><span class="op" id="8000874">)</span>&nbsp;<span class="op" id="8000876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8000879">var</span>&nbsp;<span class="ident" id="8000883">s</span>&nbsp;<span class="op" id="8000885">=</span>&nbsp;<span class="keyword" id="8000887">struct</span>&nbsp;<span class="op" id="8000894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8000898">R0</span>&nbsp;<span class="ident" id="8000901"><a href="/encoding/json/encode_test.go.html#8000154">Ref</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8000907">R1</span>&nbsp;<span class="op" id="8000910">*</span><span class="ident" id="8000911"><a href="/encoding/json/encode_test.go.html#8000154">Ref</a></span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8000917">R2</span>&nbsp;<span class="ident" id="8000920"><a href="/encoding/json/encode_test.go.html#8000523">RefText</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8000930">R3</span>&nbsp;<span class="op" id="8000933">*</span><span class="ident" id="8000934"><a href="/encoding/json/encode_test.go.html#8000523">RefText</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8000944">V0</span>&nbsp;<span class="ident" id="8000947"><a href="/encoding/json/encode_test.go.html#8000362">Val</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8000953">V1</span>&nbsp;<span class="op" id="8000956">*</span><span class="ident" id="8000957"><a href="/encoding/json/encode_test.go.html#8000362">Val</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8000963">V2</span>&nbsp;<span class="ident" id="8000966"><a href="/encoding/json/encode_test.go.html#8000747">ValText</a></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8000976">V3</span>&nbsp;<span class="op" id="8000979">*</span><span class="ident" id="8000980"><a href="/encoding/json/encode_test.go.html#8000747">ValText</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8000989">}</span><span class="op" id="8000990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8000994">R0</span><span class="op" id="8000996">:</span>&nbsp;<span class="num" id="8000998">12</span><span class="op" id="8001000">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8001004">R1</span><span class="op" id="8001006">:</span>&nbsp;<span class="builtinfunc" id="8001008">new</span><span class="op" id="8001011">(</span><span class="ident" id="8001012"><a href="/encoding/json/encode_test.go.html#8000154">Ref</a></span><span class="op" id="8001015">)</span><span class="op" id="8001016">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8001020">R2</span><span class="op" id="8001022">:</span>&nbsp;<span class="num" id="8001024">14</span><span class="op" id="8001026">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8001030">R3</span><span class="op" id="8001032">:</span>&nbsp;<span class="builtinfunc" id="8001034">new</span><span class="op" id="8001037">(</span><span class="ident" id="8001038"><a href="/encoding/json/encode_test.go.html#8000523">RefText</a></span><span class="op" id="8001045">)</span><span class="op" id="8001046">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8001050">V0</span><span class="op" id="8001052">:</span>&nbsp;<span class="num" id="8001054">13</span><span class="op" id="8001056">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8001060">V1</span><span class="op" id="8001062">:</span>&nbsp;<span class="builtinfunc" id="8001064">new</span><span class="op" id="8001067">(</span><span class="ident" id="8001068"><a href="/encoding/json/encode_test.go.html#8000362">Val</a></span><span class="op" id="8001071">)</span><span class="op" id="8001072">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8001076">V2</span><span class="op" id="8001078">:</span>&nbsp;<span class="num" id="8001080">15</span><span class="op" id="8001082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8001086">V3</span><span class="op" id="8001088">:</span>&nbsp;<span class="builtinfunc" id="8001090">new</span><span class="op" id="8001093">(</span><span class="ident" id="8001094"><a href="/encoding/json/encode_test.go.html#8000747">ValText</a></span><span class="op" id="8001101">)</span><span class="op" id="8001102">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8001105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8001108">const</span>&nbsp;<span class="ident" id="8001114">want</span>&nbsp;<span class="op" id="8001119">=</span>&nbsp;<span class="string" id="8001121">`{&#34;R0&#34;:&#34;ref&#34;,&#34;R1&#34;:&#34;ref&#34;,&#34;R2&#34;:&#34;\&#34;ref\&#34;&#34;,&#34;R3&#34;:&#34;\&#34;ref\&#34;&#34;,&#34;V0&#34;:&#34;val&#34;,&#34;V1&#34;:&#34;val&#34;,&#34;V2&#34;:&#34;\&#34;val\&#34;&#34;,&#34;V3&#34;:&#34;\&#34;val\&#34;&#34;}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8001230">b</span><span class="op" id="8001231">,</span>&nbsp;<span class="ident" id="8001233">err</span>&nbsp;<span class="op" id="8001237">:=</span>&nbsp;<span class="ident" id="8001240"><a href="/encoding/json/encode.go.html#3666502">Marshal</a></span><span class="op" id="8001247">(</span><span class="op" id="8001248">&amp;</span><span class="ident" id="8001249"><a href="/encoding/json/encode_test.go.html#8000883">s</a></span><span class="op" id="8001250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8001253">if</span>&nbsp;<span class="ident" id="8001256"><a href="/encoding/json/encode_test.go.html#8001233">err</a></span>&nbsp;<span class="op" id="8001260">!=</span>&nbsp;<span class="ident" id="8001263">nil</span>&nbsp;<span class="op" id="8001267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8001271"><a href="/encoding/json/encode_test.go.html#8000862">t</a></span><span class="op" id="8001272">.</span><span class="ident" id="8001273">Fatalf</span><span class="op" id="8001279">(</span><span class="string" id="8001280">&#34;Marshal:&nbsp;%v&#34;</span><span class="op" id="8001293">,</span>&nbsp;<span class="ident" id="8001295"><a href="/encoding/json/encode_test.go.html#8001233">err</a></span><span class="op" id="8001298">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8001301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8001304">if</span>&nbsp;<span class="ident" id="8001307">got</span>&nbsp;<span class="op" id="8001311">:=</span>&nbsp;<span class="builtintype" id="8001314">string</span><span class="op" id="8001320">(</span><span class="ident" id="8001321"><a href="/encoding/json/encode_test.go.html#8001230">b</a></span><span class="op" id="8001322">)</span><span class="op" id="8001323">;</span>&nbsp;<span class="ident" id="8001325"><a href="/encoding/json/encode_test.go.html#8001307">got</a></span>&nbsp;<span class="op" id="8001329">!=</span>&nbsp;<span class="ident" id="8001332"><a href="/encoding/json/encode_test.go.html#8001114">want</a></span>&nbsp;<span class="op" id="8001337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8001341"><a href="/encoding/json/encode_test.go.html#8000862">t</a></span><span class="op" id="8001342">.</span><span class="ident" id="8001343">Errorf</span><span class="op" id="8001349">(</span><span class="string" id="8001350">&#34;got&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8001367">,</span>&nbsp;<span class="ident" id="8001369"><a href="/encoding/json/encode_test.go.html#8001307">got</a></span><span class="op" id="8001372">,</span>&nbsp;<span class="ident" id="8001374"><a href="/encoding/json/encode_test.go.html#8001114">want</a></span><span class="op" id="8001378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8001381">}</span><br>
<span class="lineno"></span><span class="op" id="8001383">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="comment" id="8001386">//&nbsp;C&nbsp;implements&nbsp;Marshaler&nbsp;and&nbsp;returns&nbsp;unescaped&nbsp;JSON.</span><br>
<span class="lineno"></span><span class="keyword" id="8001440">type</span>&nbsp;<span class="ident" id="8001445">C</span>&nbsp;<span class="builtintype" id="8001447">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8001452">func</span>&nbsp;<span class="op" id="8001457">(</span><span class="ident" id="8001458"><a href="/encoding/json/encode_test.go.html#8001445">C</a></span><span class="op" id="8001459">)</span>&nbsp;<span class="ident" id="8001461">MarshalJSON</span><span class="op" id="8001472">(</span><span class="op" id="8001473">)</span>&nbsp;<span class="op" id="8001475">(</span><span class="op" id="8001476">[</span><span class="op" id="8001477">]</span><span class="builtintype" id="8001478">byte</span><span class="op" id="8001482">,</span>&nbsp;<span class="builtintype" id="8001484">error</span><span class="op" id="8001489">)</span>&nbsp;<span class="op" id="8001491">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8001494">return</span>&nbsp;<span class="op" id="8001501">[</span><span class="op" id="8001502">]</span><span class="builtintype" id="8001503">byte</span><span class="op" id="8001507">(</span><span class="string" id="8001508">`&#34;&lt;&amp;&gt;&#34;`</span><span class="op" id="8001515">)</span><span class="op" id="8001516">,</span>&nbsp;<span class="ident" id="8001518">nil</span><br>
<span class="lineno"></span><span class="op" id="8001522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8001525">//&nbsp;CText&nbsp;implements&nbsp;Marshaler&nbsp;and&nbsp;returns&nbsp;unescaped&nbsp;text.</span><br>
<span class="lineno"></span><span class="keyword" id="8001583">type</span>&nbsp;<span class="ident" id="8001588">CText</span>&nbsp;<span class="builtintype" id="8001594">int</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="keyword" id="8001599">func</span>&nbsp;<span class="op" id="8001604">(</span><span class="ident" id="8001605"><a href="/encoding/json/encode_test.go.html#8001588">CText</a></span><span class="op" id="8001610">)</span>&nbsp;<span class="ident" id="8001612">MarshalText</span><span class="op" id="8001623">(</span><span class="op" id="8001624">)</span>&nbsp;<span class="op" id="8001626">(</span><span class="op" id="8001627">[</span><span class="op" id="8001628">]</span><span class="builtintype" id="8001629">byte</span><span class="op" id="8001633">,</span>&nbsp;<span class="builtintype" id="8001635">error</span><span class="op" id="8001640">)</span>&nbsp;<span class="op" id="8001642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8001645">return</span>&nbsp;<span class="op" id="8001652">[</span><span class="op" id="8001653">]</span><span class="builtintype" id="8001654">byte</span><span class="op" id="8001658">(</span><span class="string" id="8001659">`&#34;&lt;&amp;&gt;&#34;`</span><span class="op" id="8001666">)</span><span class="op" id="8001667">,</span>&nbsp;<span class="ident" id="8001669">nil</span><br>
<span class="lineno"></span><span class="op" id="8001673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="keyword" id="8001676">func</span>&nbsp;<span class="ident" id="8001681">TestMarshalerEscaping</span><span class="op" id="8001702">(</span><span class="ident" id="8001703">t</span>&nbsp;<span class="op" id="8001705">*</span><span class="ident" id="8001706"><a href="/encoding/json/encode_test.go.html#7997228">testing</a></span><span class="op" id="8001713">.</span><span class="ident" id="8001714">T</span><span class="op" id="8001715">)</span>&nbsp;<span class="op" id="8001717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8001720">var</span>&nbsp;<span class="ident" id="8001724">c</span>&nbsp;<span class="ident" id="8001726"><a href="/encoding/json/encode_test.go.html#8001445">C</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8001729">want</span>&nbsp;<span class="op" id="8001734">:=</span>&nbsp;<span class="string" id="8001737">`&#34;\u003c\u0026\u003e&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8001761">b</span><span class="op" id="8001762">,</span>&nbsp;<span class="ident" id="8001764">err</span>&nbsp;<span class="op" id="8001768">:=</span>&nbsp;<span class="ident" id="8001771"><a href="/encoding/json/encode.go.html#3666502">Marshal</a></span><span class="op" id="8001778">(</span><span class="ident" id="8001779"><a href="/encoding/json/encode_test.go.html#8001724">c</a></span><span class="op" id="8001780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8001783">if</span>&nbsp;<span class="ident" id="8001786"><a href="/encoding/json/encode_test.go.html#8001764">err</a></span>&nbsp;<span class="op" id="8001790">!=</span>&nbsp;<span class="ident" id="8001793">nil</span>&nbsp;<span class="op" id="8001797">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8001801"><a href="/encoding/json/encode_test.go.html#8001703">t</a></span><span class="op" id="8001802">.</span><span class="ident" id="8001803">Fatalf</span><span class="op" id="8001809">(</span><span class="string" id="8001810">&#34;Marshal(c):&nbsp;%v&#34;</span><span class="op" id="8001826">,</span>&nbsp;<span class="ident" id="8001828"><a href="/encoding/json/encode_test.go.html#8001764">err</a></span><span class="op" id="8001831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8001834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8001837">if</span>&nbsp;<span class="ident" id="8001840">got</span>&nbsp;<span class="op" id="8001844">:=</span>&nbsp;<span class="builtintype" id="8001847">string</span><span class="op" id="8001853">(</span><span class="ident" id="8001854"><a href="/encoding/json/encode_test.go.html#8001761">b</a></span><span class="op" id="8001855">)</span><span class="op" id="8001856">;</span>&nbsp;<span class="ident" id="8001858"><a href="/encoding/json/encode_test.go.html#8001840">got</a></span>&nbsp;<span class="op" id="8001862">!=</span>&nbsp;<span class="ident" id="8001865"><a href="/encoding/json/encode_test.go.html#8001729">want</a></span>&nbsp;<span class="op" id="8001870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8001874"><a href="/encoding/json/encode_test.go.html#8001703">t</a></span><span class="op" id="8001875">.</span><span class="ident" id="8001876">Errorf</span><span class="op" id="8001882">(</span><span class="string" id="8001883">&#34;Marshal(c)&nbsp;=&nbsp;%#q,&nbsp;want&nbsp;%#q&#34;</span><span class="op" id="8001911">,</span>&nbsp;<span class="ident" id="8001913"><a href="/encoding/json/encode_test.go.html#8001840">got</a></span><span class="op" id="8001916">,</span>&nbsp;<span class="ident" id="8001918"><a href="/encoding/json/encode_test.go.html#8001729">want</a></span><span class="op" id="8001922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8001925">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8001929">var</span>&nbsp;<span class="ident" id="8001933">ct</span>&nbsp;<span class="ident" id="8001936"><a href="/encoding/json/encode_test.go.html#8001588">CText</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8001943"><a href="/encoding/json/encode_test.go.html#8001729">want</a></span>&nbsp;<span class="op" id="8001948">=</span>&nbsp;<span class="string" id="8001950">`&#34;\&#34;\u003c\u0026\u003e\&#34;&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8001978"><a href="/encoding/json/encode_test.go.html#8001761">b</a></span><span class="op" id="8001979">,</span>&nbsp;<span class="ident" id="8001981"><a href="/encoding/json/encode_test.go.html#8001764">err</a></span>&nbsp;<span class="op" id="8001985">=</span>&nbsp;<span class="ident" id="8001987"><a href="/encoding/json/encode.go.html#3666502">Marshal</a></span><span class="op" id="8001994">(</span><span class="ident" id="8001995"><a href="/encoding/json/encode_test.go.html#8001933">ct</a></span><span class="op" id="8001997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8002000">if</span>&nbsp;<span class="ident" id="8002003"><a href="/encoding/json/encode_test.go.html#8001764">err</a></span>&nbsp;<span class="op" id="8002007">!=</span>&nbsp;<span class="ident" id="8002010">nil</span>&nbsp;<span class="op" id="8002014">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8002018"><a href="/encoding/json/encode_test.go.html#8001703">t</a></span><span class="op" id="8002019">.</span><span class="ident" id="8002020">Fatalf</span><span class="op" id="8002026">(</span><span class="string" id="8002027">&#34;Marshal(ct):&nbsp;%v&#34;</span><span class="op" id="8002044">,</span>&nbsp;<span class="ident" id="8002046"><a href="/encoding/json/encode_test.go.html#8001764">err</a></span><span class="op" id="8002049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8002052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8002055">if</span>&nbsp;<span class="ident" id="8002058">got</span>&nbsp;<span class="op" id="8002062">:=</span>&nbsp;<span class="builtintype" id="8002065">string</span><span class="op" id="8002071">(</span><span class="ident" id="8002072"><a href="/encoding/json/encode_test.go.html#8001761">b</a></span><span class="op" id="8002073">)</span><span class="op" id="8002074">;</span>&nbsp;<span class="ident" id="8002076"><a href="/encoding/json/encode_test.go.html#8002058">got</a></span>&nbsp;<span class="op" id="8002080">!=</span>&nbsp;<span class="ident" id="8002083"><a href="/encoding/json/encode_test.go.html#8001729">want</a></span>&nbsp;<span class="op" id="8002088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8002092"><a href="/encoding/json/encode_test.go.html#8001703">t</a></span><span class="op" id="8002093">.</span><span class="ident" id="8002094">Errorf</span><span class="op" id="8002100">(</span><span class="string" id="8002101">&#34;Marshal(ct)&nbsp;=&nbsp;%#q,&nbsp;want&nbsp;%#q&#34;</span><span class="op" id="8002130">,</span>&nbsp;<span class="ident" id="8002132"><a href="/encoding/json/encode_test.go.html#8002058">got</a></span><span class="op" id="8002135">,</span>&nbsp;<span class="ident" id="8002137"><a href="/encoding/json/encode_test.go.html#8001729">want</a></span><span class="op" id="8002141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8002144">}</span><br>
<span class="lineno">250</span><span class="op" id="8002146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8002149">type</span>&nbsp;<span class="ident" id="8002154">IntType</span>&nbsp;<span class="builtintype" id="8002162">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8002167">type</span>&nbsp;<span class="ident" id="8002172">MyStruct</span>&nbsp;<span class="keyword" id="8002181">struct</span>&nbsp;<span class="op" id="8002188">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8002191"><a href="/encoding/json/encode_test.go.html#8002154">IntType</a></span><br>
<span class="lineno"></span><span class="op" id="8002199">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8002202">func</span>&nbsp;<span class="ident" id="8002207">TestAnonymousNonstruct</span><span class="op" id="8002229">(</span><span class="ident" id="8002230">t</span>&nbsp;<span class="op" id="8002232">*</span><span class="ident" id="8002233"><a href="/encoding/json/encode_test.go.html#7997228">testing</a></span><span class="op" id="8002240">.</span><span class="ident" id="8002241">T</span><span class="op" id="8002242">)</span>&nbsp;<span class="op" id="8002244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8002247">var</span>&nbsp;<span class="ident" id="8002251">i</span>&nbsp;<span class="ident" id="8002253"><a href="/encoding/json/encode_test.go.html#8002154">IntType</a></span>&nbsp;<span class="op" id="8002261">=</span>&nbsp;<span class="num" id="8002263">11</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8002267">a</span>&nbsp;<span class="op" id="8002269">:=</span>&nbsp;<span class="ident" id="8002272"><a href="/encoding/json/encode_test.go.html#8002172">MyStruct</a></span><span class="op" id="8002280">{</span><span class="ident" id="8002281"><a href="/encoding/json/encode_test.go.html#8002251">i</a></span><span class="op" id="8002282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8002285">const</span>&nbsp;<span class="ident" id="8002291">want</span>&nbsp;<span class="op" id="8002296">=</span>&nbsp;<span class="string" id="8002298">`{&#34;IntType&#34;:11}`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8002317">b</span><span class="op" id="8002318">,</span>&nbsp;<span class="ident" id="8002320">err</span>&nbsp;<span class="op" id="8002324">:=</span>&nbsp;<span class="ident" id="8002327"><a href="/encoding/json/encode.go.html#3666502">Marshal</a></span><span class="op" id="8002334">(</span><span class="ident" id="8002335"><a href="/encoding/json/encode_test.go.html#8002267">a</a></span><span class="op" id="8002336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8002339">if</span>&nbsp;<span class="ident" id="8002342"><a href="/encoding/json/encode_test.go.html#8002320">err</a></span>&nbsp;<span class="op" id="8002346">!=</span>&nbsp;<span class="ident" id="8002349">nil</span>&nbsp;<span class="op" id="8002353">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8002357"><a href="/encoding/json/encode_test.go.html#8002230">t</a></span><span class="op" id="8002358">.</span><span class="ident" id="8002359">Fatalf</span><span class="op" id="8002365">(</span><span class="string" id="8002366">&#34;Marshal:&nbsp;%v&#34;</span><span class="op" id="8002379">,</span>&nbsp;<span class="ident" id="8002381"><a href="/encoding/json/encode_test.go.html#8002320">err</a></span><span class="op" id="8002384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8002387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8002390">if</span>&nbsp;<span class="ident" id="8002393">got</span>&nbsp;<span class="op" id="8002397">:=</span>&nbsp;<span class="builtintype" id="8002400">string</span><span class="op" id="8002406">(</span><span class="ident" id="8002407"><a href="/encoding/json/encode_test.go.html#8002317">b</a></span><span class="op" id="8002408">)</span><span class="op" id="8002409">;</span>&nbsp;<span class="ident" id="8002411"><a href="/encoding/json/encode_test.go.html#8002393">got</a></span>&nbsp;<span class="op" id="8002415">!=</span>&nbsp;<span class="ident" id="8002418"><a href="/encoding/json/encode_test.go.html#8002291">want</a></span>&nbsp;<span class="op" id="8002423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8002427"><a href="/encoding/json/encode_test.go.html#8002230">t</a></span><span class="op" id="8002428">.</span><span class="ident" id="8002429">Errorf</span><span class="op" id="8002435">(</span><span class="string" id="8002436">&#34;got&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8002453">,</span>&nbsp;<span class="ident" id="8002455"><a href="/encoding/json/encode_test.go.html#8002393">got</a></span><span class="op" id="8002458">,</span>&nbsp;<span class="ident" id="8002460"><a href="/encoding/json/encode_test.go.html#8002291">want</a></span><span class="op" id="8002464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8002467">}</span><br>
<span class="lineno">270</span><span class="op" id="8002469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8002472">type</span>&nbsp;<span class="ident" id="8002477">BugA</span>&nbsp;<span class="keyword" id="8002482">struct</span>&nbsp;<span class="op" id="8002489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8002492">S</span>&nbsp;<span class="builtintype" id="8002494">string</span><br>
<span class="lineno"></span><span class="op" id="8002501">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="keyword" id="8002504">type</span>&nbsp;<span class="ident" id="8002509">BugB</span>&nbsp;<span class="keyword" id="8002514">struct</span>&nbsp;<span class="op" id="8002521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8002524"><a href="/encoding/json/encode_test.go.html#8002477">BugA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8002530">S</span>&nbsp;<span class="builtintype" id="8002532">string</span><br>
<span class="lineno"></span><span class="op" id="8002539">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="keyword" id="8002542">type</span>&nbsp;<span class="ident" id="8002547">BugC</span>&nbsp;<span class="keyword" id="8002552">struct</span>&nbsp;<span class="op" id="8002559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8002562">S</span>&nbsp;<span class="builtintype" id="8002564">string</span><br>
<span class="lineno"></span><span class="op" id="8002571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="comment" id="8002574">//&nbsp;Legal&nbsp;Go:&nbsp;We&nbsp;never&nbsp;use&nbsp;the&nbsp;repeated&nbsp;embedded&nbsp;field&nbsp;(S).</span><br>
<span class="lineno"></span><span class="keyword" id="8002633">type</span>&nbsp;<span class="ident" id="8002638">BugX</span>&nbsp;<span class="keyword" id="8002643">struct</span>&nbsp;<span class="op" id="8002650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8002653">A</span>&nbsp;<span class="builtintype" id="8002655">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8002660"><a href="/encoding/json/encode_test.go.html#8002477">BugA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8002666"><a href="/encoding/json/encode_test.go.html#8002509">BugB</a></span><br>
<span class="lineno">290</span><span class="op" id="8002671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8002674">//&nbsp;Issue&nbsp;5245.</span><br>
<span class="lineno"></span><span class="keyword" id="8002689">func</span>&nbsp;<span class="ident" id="8002694">TestEmbeddedBug</span><span class="op" id="8002709">(</span><span class="ident" id="8002710">t</span>&nbsp;<span class="op" id="8002712">*</span><span class="ident" id="8002713"><a href="/encoding/json/encode_test.go.html#7997228">testing</a></span><span class="op" id="8002720">.</span><span class="ident" id="8002721">T</span><span class="op" id="8002722">)</span>&nbsp;<span class="op" id="8002724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8002727">v</span>&nbsp;<span class="op" id="8002729">:=</span>&nbsp;<span class="ident" id="8002732"><a href="/encoding/json/encode_test.go.html#8002509">BugB</a></span><span class="op" id="8002736">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8002740"><a href="/encoding/json/encode_test.go.html#8002477">BugA</a></span><span class="op" id="8002744">{</span><span class="string" id="8002745">&#34;A&#34;</span><span class="op" id="8002748">}</span><span class="op" id="8002749">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8002753">&#34;B&#34;</span><span class="op" id="8002756">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8002759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8002762">b</span><span class="op" id="8002763">,</span>&nbsp;<span class="ident" id="8002765">err</span>&nbsp;<span class="op" id="8002769">:=</span>&nbsp;<span class="ident" id="8002772"><a href="/encoding/json/encode.go.html#3666502">Marshal</a></span><span class="op" id="8002779">(</span><span class="ident" id="8002780"><a href="/encoding/json/encode_test.go.html#8002727">v</a></span><span class="op" id="8002781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8002784">if</span>&nbsp;<span class="ident" id="8002787"><a href="/encoding/json/encode_test.go.html#8002765">err</a></span>&nbsp;<span class="op" id="8002791">!=</span>&nbsp;<span class="ident" id="8002794">nil</span>&nbsp;<span class="op" id="8002798">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8002802"><a href="/encoding/json/encode_test.go.html#8002710">t</a></span><span class="op" id="8002803">.</span><span class="ident" id="8002804">Fatal</span><span class="op" id="8002809">(</span><span class="string" id="8002810">&#34;Marshal:&#34;</span><span class="op" id="8002820">,</span>&nbsp;<span class="ident" id="8002822"><a href="/encoding/json/encode_test.go.html#8002765">err</a></span><span class="op" id="8002825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8002828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8002831">want</span>&nbsp;<span class="op" id="8002836">:=</span>&nbsp;<span class="string" id="8002839">`{&#34;S&#34;:&#34;B&#34;}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8002852">got</span>&nbsp;<span class="op" id="8002856">:=</span>&nbsp;<span class="builtintype" id="8002859">string</span><span class="op" id="8002865">(</span><span class="ident" id="8002866"><a href="/encoding/json/encode_test.go.html#8002762">b</a></span><span class="op" id="8002867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8002870">if</span>&nbsp;<span class="ident" id="8002873"><a href="/encoding/json/encode_test.go.html#8002852">got</a></span>&nbsp;<span class="op" id="8002877">!=</span>&nbsp;<span class="ident" id="8002880"><a href="/encoding/json/encode_test.go.html#8002831">want</a></span>&nbsp;<span class="op" id="8002885">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8002889"><a href="/encoding/json/encode_test.go.html#8002710">t</a></span><span class="op" id="8002890">.</span><span class="ident" id="8002891">Fatalf</span><span class="op" id="8002897">(</span><span class="string" id="8002898">&#34;Marshal:&nbsp;got&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8002923">,</span>&nbsp;<span class="ident" id="8002925"><a href="/encoding/json/encode_test.go.html#8002852">got</a></span><span class="op" id="8002928">,</span>&nbsp;<span class="ident" id="8002930"><a href="/encoding/json/encode_test.go.html#8002831">want</a></span><span class="op" id="8002934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8002937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8002940">//&nbsp;Now&nbsp;check&nbsp;that&nbsp;the&nbsp;duplicate&nbsp;field,&nbsp;S,&nbsp;does&nbsp;not&nbsp;appear.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8003000">x</span>&nbsp;<span class="op" id="8003002">:=</span>&nbsp;<span class="ident" id="8003005"><a href="/encoding/json/encode_test.go.html#8002638">BugX</a></span><span class="op" id="8003009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8003013">A</span><span class="op" id="8003014">:</span>&nbsp;<span class="num" id="8003016">23</span><span class="op" id="8003018">,</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8003021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8003024"><a href="/encoding/json/encode_test.go.html#8002762">b</a></span><span class="op" id="8003025">,</span>&nbsp;<span class="ident" id="8003027"><a href="/encoding/json/encode_test.go.html#8002765">err</a></span>&nbsp;<span class="op" id="8003031">=</span>&nbsp;<span class="ident" id="8003033"><a href="/encoding/json/encode.go.html#3666502">Marshal</a></span><span class="op" id="8003040">(</span><span class="ident" id="8003041"><a href="/encoding/json/encode_test.go.html#8003000">x</a></span><span class="op" id="8003042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8003045">if</span>&nbsp;<span class="ident" id="8003048"><a href="/encoding/json/encode_test.go.html#8002765">err</a></span>&nbsp;<span class="op" id="8003052">!=</span>&nbsp;<span class="ident" id="8003055">nil</span>&nbsp;<span class="op" id="8003059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8003063"><a href="/encoding/json/encode_test.go.html#8002710">t</a></span><span class="op" id="8003064">.</span><span class="ident" id="8003065">Fatal</span><span class="op" id="8003070">(</span><span class="string" id="8003071">&#34;Marshal:&#34;</span><span class="op" id="8003081">,</span>&nbsp;<span class="ident" id="8003083"><a href="/encoding/json/encode_test.go.html#8002765">err</a></span><span class="op" id="8003086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8003089">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8003092"><a href="/encoding/json/encode_test.go.html#8002831">want</a></span>&nbsp;<span class="op" id="8003097">=</span>&nbsp;<span class="string" id="8003099">`{&#34;A&#34;:23}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8003111"><a href="/encoding/json/encode_test.go.html#8002852">got</a></span>&nbsp;<span class="op" id="8003115">=</span>&nbsp;<span class="builtintype" id="8003117">string</span><span class="op" id="8003123">(</span><span class="ident" id="8003124"><a href="/encoding/json/encode_test.go.html#8002762">b</a></span><span class="op" id="8003125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8003128">if</span>&nbsp;<span class="ident" id="8003131"><a href="/encoding/json/encode_test.go.html#8002852">got</a></span>&nbsp;<span class="op" id="8003135">!=</span>&nbsp;<span class="ident" id="8003138"><a href="/encoding/json/encode_test.go.html#8002831">want</a></span>&nbsp;<span class="op" id="8003143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8003147"><a href="/encoding/json/encode_test.go.html#8002710">t</a></span><span class="op" id="8003148">.</span><span class="ident" id="8003149">Fatalf</span><span class="op" id="8003155">(</span><span class="string" id="8003156">&#34;Marshal:&nbsp;got&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8003181">,</span>&nbsp;<span class="ident" id="8003183"><a href="/encoding/json/encode_test.go.html#8002852">got</a></span><span class="op" id="8003186">,</span>&nbsp;<span class="ident" id="8003188"><a href="/encoding/json/encode_test.go.html#8002831">want</a></span><span class="op" id="8003192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8003195">}</span><br>
<span class="lineno">320</span><span class="op" id="8003197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8003200">type</span>&nbsp;<span class="ident" id="8003205">BugD</span>&nbsp;<span class="keyword" id="8003210">struct</span>&nbsp;<span class="op" id="8003217">{</span>&nbsp;<span class="comment" id="8003219">//&nbsp;Same&nbsp;as&nbsp;BugA&nbsp;after&nbsp;tagging.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8003251">XXX</span>&nbsp;<span class="builtintype" id="8003255">string</span>&nbsp;<span class="string" id="8003262">`json:&#34;S&#34;`</span><br>
<span class="lineno"></span><span class="op" id="8003273">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="comment" id="8003276">//&nbsp;BugD&#39;s&nbsp;tagged&nbsp;S&nbsp;field&nbsp;should&nbsp;dominate&nbsp;BugA&#39;s.</span><br>
<span class="lineno"></span><span class="keyword" id="8003325">type</span>&nbsp;<span class="ident" id="8003330">BugY</span>&nbsp;<span class="keyword" id="8003335">struct</span>&nbsp;<span class="op" id="8003342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8003345"><a href="/encoding/json/encode_test.go.html#8002477">BugA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8003351"><a href="/encoding/json/encode_test.go.html#8003205">BugD</a></span><br>
<span class="lineno">330</span><span class="op" id="8003356">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8003359">//&nbsp;Test&nbsp;that&nbsp;a&nbsp;field&nbsp;with&nbsp;a&nbsp;tag&nbsp;dominates&nbsp;untagged&nbsp;fields.</span><br>
<span class="lineno"></span><span class="keyword" id="8003418">func</span>&nbsp;<span class="ident" id="8003423">TestTaggedFieldDominates</span><span class="op" id="8003447">(</span><span class="ident" id="8003448">t</span>&nbsp;<span class="op" id="8003450">*</span><span class="ident" id="8003451"><a href="/encoding/json/encode_test.go.html#7997228">testing</a></span><span class="op" id="8003458">.</span><span class="ident" id="8003459">T</span><span class="op" id="8003460">)</span>&nbsp;<span class="op" id="8003462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8003465">v</span>&nbsp;<span class="op" id="8003467">:=</span>&nbsp;<span class="ident" id="8003470"><a href="/encoding/json/encode_test.go.html#8003330">BugY</a></span><span class="op" id="8003474">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8003478"><a href="/encoding/json/encode_test.go.html#8002477">BugA</a></span><span class="op" id="8003482">{</span><span class="string" id="8003483">&#34;BugA&#34;</span><span class="op" id="8003489">}</span><span class="op" id="8003490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8003494"><a href="/encoding/json/encode_test.go.html#8003205">BugD</a></span><span class="op" id="8003498">{</span><span class="string" id="8003499">&#34;BugD&#34;</span><span class="op" id="8003505">}</span><span class="op" id="8003506">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8003509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8003512">b</span><span class="op" id="8003513">,</span>&nbsp;<span class="ident" id="8003515">err</span>&nbsp;<span class="op" id="8003519">:=</span>&nbsp;<span class="ident" id="8003522"><a href="/encoding/json/encode.go.html#3666502">Marshal</a></span><span class="op" id="8003529">(</span><span class="ident" id="8003530"><a href="/encoding/json/encode_test.go.html#8003465">v</a></span><span class="op" id="8003531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8003534">if</span>&nbsp;<span class="ident" id="8003537"><a href="/encoding/json/encode_test.go.html#8003515">err</a></span>&nbsp;<span class="op" id="8003541">!=</span>&nbsp;<span class="ident" id="8003544">nil</span>&nbsp;<span class="op" id="8003548">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8003552"><a href="/encoding/json/encode_test.go.html#8003448">t</a></span><span class="op" id="8003553">.</span><span class="ident" id="8003554">Fatal</span><span class="op" id="8003559">(</span><span class="string" id="8003560">&#34;Marshal:&#34;</span><span class="op" id="8003570">,</span>&nbsp;<span class="ident" id="8003572"><a href="/encoding/json/encode_test.go.html#8003515">err</a></span><span class="op" id="8003575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8003578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8003581">want</span>&nbsp;<span class="op" id="8003586">:=</span>&nbsp;<span class="string" id="8003589">`{&#34;S&#34;:&#34;BugD&#34;}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8003605">got</span>&nbsp;<span class="op" id="8003609">:=</span>&nbsp;<span class="builtintype" id="8003612">string</span><span class="op" id="8003618">(</span><span class="ident" id="8003619"><a href="/encoding/json/encode_test.go.html#8003512">b</a></span><span class="op" id="8003620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8003623">if</span>&nbsp;<span class="ident" id="8003626"><a href="/encoding/json/encode_test.go.html#8003605">got</a></span>&nbsp;<span class="op" id="8003630">!=</span>&nbsp;<span class="ident" id="8003633"><a href="/encoding/json/encode_test.go.html#8003581">want</a></span>&nbsp;<span class="op" id="8003638">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8003642"><a href="/encoding/json/encode_test.go.html#8003448">t</a></span><span class="op" id="8003643">.</span><span class="ident" id="8003644">Fatalf</span><span class="op" id="8003650">(</span><span class="string" id="8003651">&#34;Marshal:&nbsp;got&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8003676">,</span>&nbsp;<span class="ident" id="8003678"><a href="/encoding/json/encode_test.go.html#8003605">got</a></span><span class="op" id="8003681">,</span>&nbsp;<span class="ident" id="8003683"><a href="/encoding/json/encode_test.go.html#8003581">want</a></span><span class="op" id="8003687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8003690">}</span><br>
<span class="lineno"></span><span class="op" id="8003692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8003695">//&nbsp;There&nbsp;are&nbsp;no&nbsp;tags&nbsp;here,&nbsp;so&nbsp;S&nbsp;should&nbsp;not&nbsp;appear.</span><br>
<span class="lineno">350</span><span class="keyword" id="8003746">type</span>&nbsp;<span class="ident" id="8003751">BugZ</span>&nbsp;<span class="keyword" id="8003756">struct</span>&nbsp;<span class="op" id="8003763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8003766"><a href="/encoding/json/encode_test.go.html#8002477">BugA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8003772"><a href="/encoding/json/encode_test.go.html#8002547">BugC</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8003778"><a href="/encoding/json/encode_test.go.html#8003330">BugY</a></span>&nbsp;<span class="comment" id="8003783">//&nbsp;Contains&nbsp;a&nbsp;tagged&nbsp;S&nbsp;field&nbsp;through&nbsp;BugD;&nbsp;should&nbsp;not&nbsp;dominate.</span><br>
<span class="lineno"></span><span class="op" id="8003847">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span><span class="keyword" id="8003850">func</span>&nbsp;<span class="ident" id="8003855">TestDuplicatedFieldDisappears</span><span class="op" id="8003884">(</span><span class="ident" id="8003885">t</span>&nbsp;<span class="op" id="8003887">*</span><span class="ident" id="8003888"><a href="/encoding/json/encode_test.go.html#7997228">testing</a></span><span class="op" id="8003895">.</span><span class="ident" id="8003896">T</span><span class="op" id="8003897">)</span>&nbsp;<span class="op" id="8003899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8003902">v</span>&nbsp;<span class="op" id="8003904">:=</span>&nbsp;<span class="ident" id="8003907"><a href="/encoding/json/encode_test.go.html#8003751">BugZ</a></span><span class="op" id="8003911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8003915"><a href="/encoding/json/encode_test.go.html#8002477">BugA</a></span><span class="op" id="8003919">{</span><span class="string" id="8003920">&#34;BugA&#34;</span><span class="op" id="8003926">}</span><span class="op" id="8003927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8003931"><a href="/encoding/json/encode_test.go.html#8002547">BugC</a></span><span class="op" id="8003935">{</span><span class="string" id="8003936">&#34;BugC&#34;</span><span class="op" id="8003942">}</span><span class="op" id="8003943">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8003947"><a href="/encoding/json/encode_test.go.html#8003330">BugY</a></span><span class="op" id="8003951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8003956"><a href="/encoding/json/encode_test.go.html#8002477">BugA</a></span><span class="op" id="8003960">{</span><span class="string" id="8003961">&#34;nested&nbsp;BugA&#34;</span><span class="op" id="8003974">}</span><span class="op" id="8003975">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8003980"><a href="/encoding/json/encode_test.go.html#8003205">BugD</a></span><span class="op" id="8003984">{</span><span class="string" id="8003985">&#34;nested&nbsp;BugD&#34;</span><span class="op" id="8003998">}</span><span class="op" id="8003999">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8004003">}</span><span class="op" id="8004004">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8004007">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8004010">b</span><span class="op" id="8004011">,</span>&nbsp;<span class="ident" id="8004013">err</span>&nbsp;<span class="op" id="8004017">:=</span>&nbsp;<span class="ident" id="8004020"><a href="/encoding/json/encode.go.html#3666502">Marshal</a></span><span class="op" id="8004027">(</span><span class="ident" id="8004028"><a href="/encoding/json/encode_test.go.html#8003902">v</a></span><span class="op" id="8004029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8004032">if</span>&nbsp;<span class="ident" id="8004035"><a href="/encoding/json/encode_test.go.html#8004013">err</a></span>&nbsp;<span class="op" id="8004039">!=</span>&nbsp;<span class="ident" id="8004042">nil</span>&nbsp;<span class="op" id="8004046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8004050"><a href="/encoding/json/encode_test.go.html#8003885">t</a></span><span class="op" id="8004051">.</span><span class="ident" id="8004052">Fatal</span><span class="op" id="8004057">(</span><span class="string" id="8004058">&#34;Marshal:&#34;</span><span class="op" id="8004068">,</span>&nbsp;<span class="ident" id="8004070"><a href="/encoding/json/encode_test.go.html#8004013">err</a></span><span class="op" id="8004073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8004076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8004079">want</span>&nbsp;<span class="op" id="8004084">:=</span>&nbsp;<span class="string" id="8004087">`{}`</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8004093">got</span>&nbsp;<span class="op" id="8004097">:=</span>&nbsp;<span class="builtintype" id="8004100">string</span><span class="op" id="8004106">(</span><span class="ident" id="8004107"><a href="/encoding/json/encode_test.go.html#8004010">b</a></span><span class="op" id="8004108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8004111">if</span>&nbsp;<span class="ident" id="8004114"><a href="/encoding/json/encode_test.go.html#8004093">got</a></span>&nbsp;<span class="op" id="8004118">!=</span>&nbsp;<span class="ident" id="8004121"><a href="/encoding/json/encode_test.go.html#8004079">want</a></span>&nbsp;<span class="op" id="8004126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8004130"><a href="/encoding/json/encode_test.go.html#8003885">t</a></span><span class="op" id="8004131">.</span><span class="ident" id="8004132">Fatalf</span><span class="op" id="8004138">(</span><span class="string" id="8004139">&#34;Marshal:&nbsp;got&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8004164">,</span>&nbsp;<span class="ident" id="8004166"><a href="/encoding/json/encode_test.go.html#8004093">got</a></span><span class="op" id="8004169">,</span>&nbsp;<span class="ident" id="8004171"><a href="/encoding/json/encode_test.go.html#8004079">want</a></span><span class="op" id="8004175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8004178">}</span><br>
<span class="lineno"></span><span class="op" id="8004180">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span><span class="keyword" id="8004183">func</span>&nbsp;<span class="ident" id="8004188">TestStringBytes</span><span class="op" id="8004203">(</span><span class="ident" id="8004204">t</span>&nbsp;<span class="op" id="8004206">*</span><span class="ident" id="8004207"><a href="/encoding/json/encode_test.go.html#7997228">testing</a></span><span class="op" id="8004214">.</span><span class="ident" id="8004215">T</span><span class="op" id="8004216">)</span>&nbsp;<span class="op" id="8004218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8004221">//&nbsp;Test&nbsp;that&nbsp;encodeState.stringBytes&nbsp;and&nbsp;encodeState.string&nbsp;use&nbsp;the&nbsp;same&nbsp;encoding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8004305">es</span>&nbsp;<span class="op" id="8004308">:=</span>&nbsp;<span class="op" id="8004311">&amp;</span><span class="ident" id="8004312"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="8004323">{</span><span class="op" id="8004324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8004327">var</span>&nbsp;<span class="ident" id="8004331">r</span>&nbsp;<span class="op" id="8004333">[</span><span class="op" id="8004334">]</span><span class="builtintype" id="8004335">rune</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8004341">for</span>&nbsp;<span class="ident" id="8004345">i</span>&nbsp;<span class="op" id="8004347">:=</span>&nbsp;<span class="string" id="8004350">&#39;\u0000&#39;</span><span class="op" id="8004358">;</span>&nbsp;<span class="ident" id="8004360"><a href="/encoding/json/encode_test.go.html#8004345">i</a></span>&nbsp;<span class="op" id="8004362">&lt;=</span>&nbsp;<span class="ident" id="8004365"><a href="/encoding/json/encode_test.go.html#7997239">unicode</a></span><span class="op" id="8004372">.</span><span class="ident" id="8004373">MaxRune</span><span class="op" id="8004380">;</span>&nbsp;<span class="ident" id="8004382"><a href="/encoding/json/encode_test.go.html#8004345">i</a></span><span class="op" id="8004383">++</span>&nbsp;<span class="op" id="8004386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8004390"><a href="/encoding/json/encode_test.go.html#8004331">r</a></span>&nbsp;<span class="op" id="8004392">=</span>&nbsp;<span class="builtinfunc" id="8004394">append</span><span class="op" id="8004400">(</span><span class="ident" id="8004401"><a href="/encoding/json/encode_test.go.html#8004331">r</a></span><span class="op" id="8004402">,</span>&nbsp;<span class="ident" id="8004404"><a href="/encoding/json/encode_test.go.html#8004345">i</a></span><span class="op" id="8004405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8004408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8004411">s</span>&nbsp;<span class="op" id="8004413">:=</span>&nbsp;<span class="builtintype" id="8004416">string</span><span class="op" id="8004422">(</span><span class="ident" id="8004423"><a href="/encoding/json/encode_test.go.html#8004331">r</a></span><span class="op" id="8004424">)</span>&nbsp;<span class="op" id="8004426">+</span>&nbsp;<span class="string" id="8004428">&#34;\xff\xff\xffhello&#34;</span>&nbsp;<span class="comment" id="8004448">//&nbsp;some&nbsp;invalid&nbsp;UTF-8&nbsp;too</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8004475">_</span><span class="op" id="8004476">,</span>&nbsp;<span class="ident" id="8004478">err</span>&nbsp;<span class="op" id="8004482">:=</span>&nbsp;<span class="ident" id="8004485"><a href="/encoding/json/encode_test.go.html#8004305">es</a></span><span class="op" id="8004487">.</span><span class="builtintype" id="8004488">string</span><span class="op" id="8004494">(</span><span class="ident" id="8004495"><a href="/encoding/json/encode_test.go.html#8004411">s</a></span><span class="op" id="8004496">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8004499">if</span>&nbsp;<span class="ident" id="8004502"><a href="/encoding/json/encode_test.go.html#8004478">err</a></span>&nbsp;<span class="op" id="8004506">!=</span>&nbsp;<span class="ident" id="8004509">nil</span>&nbsp;<span class="op" id="8004513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8004517"><a href="/encoding/json/encode_test.go.html#8004204">t</a></span><span class="op" id="8004518">.</span><span class="ident" id="8004519">Fatal</span><span class="op" id="8004524">(</span><span class="ident" id="8004525"><a href="/encoding/json/encode_test.go.html#8004478">err</a></span><span class="op" id="8004528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8004531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8004535">esBytes</span>&nbsp;<span class="op" id="8004543">:=</span>&nbsp;<span class="op" id="8004546">&amp;</span><span class="ident" id="8004547"><a href="/encoding/json/encode.go.html#3669565">encodeState</a></span><span class="op" id="8004558">{</span><span class="op" id="8004559">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8004562">_</span><span class="op" id="8004563">,</span>&nbsp;<span class="ident" id="8004565"><a href="/encoding/json/encode_test.go.html#8004478">err</a></span>&nbsp;<span class="op" id="8004569">=</span>&nbsp;<span class="ident" id="8004571"><a href="/encoding/json/encode_test.go.html#8004535">esBytes</a></span><span class="op" id="8004578">.</span><span class="ident" id="8004579">stringBytes</span><span class="op" id="8004590">(</span><span class="op" id="8004591">[</span><span class="op" id="8004592">]</span><span class="builtintype" id="8004593">byte</span><span class="op" id="8004597">(</span><span class="ident" id="8004598"><a href="/encoding/json/encode_test.go.html#8004411">s</a></span><span class="op" id="8004599">)</span><span class="op" id="8004600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8004603">if</span>&nbsp;<span class="ident" id="8004606"><a href="/encoding/json/encode_test.go.html#8004478">err</a></span>&nbsp;<span class="op" id="8004610">!=</span>&nbsp;<span class="ident" id="8004613">nil</span>&nbsp;<span class="op" id="8004617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8004621"><a href="/encoding/json/encode_test.go.html#8004204">t</a></span><span class="op" id="8004622">.</span><span class="ident" id="8004623">Fatal</span><span class="op" id="8004628">(</span><span class="ident" id="8004629"><a href="/encoding/json/encode_test.go.html#8004478">err</a></span><span class="op" id="8004632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8004635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8004639">enc</span>&nbsp;<span class="op" id="8004643">:=</span>&nbsp;<span class="ident" id="8004646"><a href="/encoding/json/encode_test.go.html#8004305">es</a></span><span class="op" id="8004648">.</span><span class="ident" id="8004649">Buffer</span><span class="op" id="8004655">.</span><span class="ident" id="8004656">String</span><span class="op" id="8004662">(</span><span class="op" id="8004663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8004666">encBytes</span>&nbsp;<span class="op" id="8004675">:=</span>&nbsp;<span class="ident" id="8004678"><a href="/encoding/json/encode_test.go.html#8004535">esBytes</a></span><span class="op" id="8004685">.</span><span class="ident" id="8004686">Buffer</span><span class="op" id="8004692">.</span><span class="ident" id="8004693">String</span><span class="op" id="8004699">(</span><span class="op" id="8004700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8004703">if</span>&nbsp;<span class="ident" id="8004706"><a href="/encoding/json/encode_test.go.html#8004639">enc</a></span>&nbsp;<span class="op" id="8004710">!=</span>&nbsp;<span class="ident" id="8004713"><a href="/encoding/json/encode_test.go.html#8004666">encBytes</a></span>&nbsp;<span class="op" id="8004722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8004726">i</span>&nbsp;<span class="op" id="8004728">:=</span>&nbsp;<span class="num" id="8004731">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8004735">for</span>&nbsp;<span class="ident" id="8004739"><a href="/encoding/json/encode_test.go.html#8004726">i</a></span>&nbsp;<span class="op" id="8004741">&lt;</span>&nbsp;<span class="builtinfunc" id="8004743">len</span><span class="op" id="8004746">(</span><span class="ident" id="8004747"><a href="/encoding/json/encode_test.go.html#8004639">enc</a></span><span class="op" id="8004750">)</span>&nbsp;<span class="op" id="8004752">&amp;&amp;</span>&nbsp;<span class="ident" id="8004755"><a href="/encoding/json/encode_test.go.html#8004726">i</a></span>&nbsp;<span class="op" id="8004757">&lt;</span>&nbsp;<span class="builtinfunc" id="8004759">len</span><span class="op" id="8004762">(</span><span class="ident" id="8004763"><a href="/encoding/json/encode_test.go.html#8004666">encBytes</a></span><span class="op" id="8004771">)</span>&nbsp;<span class="op" id="8004773">&amp;&amp;</span>&nbsp;<span class="ident" id="8004776"><a href="/encoding/json/encode_test.go.html#8004639">enc</a></span><span class="op" id="8004779">[</span><span class="ident" id="8004780"><a href="/encoding/json/encode_test.go.html#8004726">i</a></span><span class="op" id="8004781">]</span>&nbsp;<span class="op" id="8004783">==</span>&nbsp;<span class="ident" id="8004786"><a href="/encoding/json/encode_test.go.html#8004666">encBytes</a></span><span class="op" id="8004794">[</span><span class="ident" id="8004795"><a href="/encoding/json/encode_test.go.html#8004726">i</a></span><span class="op" id="8004796">]</span>&nbsp;<span class="op" id="8004798">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8004803"><a href="/encoding/json/encode_test.go.html#8004726">i</a></span><span class="op" id="8004804">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8004809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8004813"><a href="/encoding/json/encode_test.go.html#8004639">enc</a></span>&nbsp;<span class="op" id="8004817">=</span>&nbsp;<span class="ident" id="8004819"><a href="/encoding/json/encode_test.go.html#8004639">enc</a></span><span class="op" id="8004822">[</span><span class="ident" id="8004823"><a href="/encoding/json/encode_test.go.html#8004726">i</a></span><span class="op" id="8004824">:</span><span class="op" id="8004825">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8004829"><a href="/encoding/json/encode_test.go.html#8004666">encBytes</a></span>&nbsp;<span class="op" id="8004838">=</span>&nbsp;<span class="ident" id="8004840"><a href="/encoding/json/encode_test.go.html#8004666">encBytes</a></span><span class="op" id="8004848">[</span><span class="ident" id="8004849"><a href="/encoding/json/encode_test.go.html#8004726">i</a></span><span class="op" id="8004850">:</span><span class="op" id="8004851">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8004855"><a href="/encoding/json/encode_test.go.html#8004726">i</a></span>&nbsp;<span class="op" id="8004857">=</span>&nbsp;<span class="num" id="8004859">0</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8004863">for</span>&nbsp;<span class="ident" id="8004867"><a href="/encoding/json/encode_test.go.html#8004726">i</a></span>&nbsp;<span class="op" id="8004869">&lt;</span>&nbsp;<span class="builtinfunc" id="8004871">len</span><span class="op" id="8004874">(</span><span class="ident" id="8004875"><a href="/encoding/json/encode_test.go.html#8004639">enc</a></span><span class="op" id="8004878">)</span>&nbsp;<span class="op" id="8004880">&amp;&amp;</span>&nbsp;<span class="ident" id="8004883"><a href="/encoding/json/encode_test.go.html#8004726">i</a></span>&nbsp;<span class="op" id="8004885">&lt;</span>&nbsp;<span class="builtinfunc" id="8004887">len</span><span class="op" id="8004890">(</span><span class="ident" id="8004891"><a href="/encoding/json/encode_test.go.html#8004666">encBytes</a></span><span class="op" id="8004899">)</span>&nbsp;<span class="op" id="8004901">&amp;&amp;</span>&nbsp;<span class="ident" id="8004904"><a href="/encoding/json/encode_test.go.html#8004639">enc</a></span><span class="op" id="8004907">[</span><span class="builtinfunc" id="8004908">len</span><span class="op" id="8004911">(</span><span class="ident" id="8004912"><a href="/encoding/json/encode_test.go.html#8004639">enc</a></span><span class="op" id="8004915">)</span><span class="op" id="8004916">-</span><span class="ident" id="8004917"><a href="/encoding/json/encode_test.go.html#8004726">i</a></span><span class="op" id="8004918">-</span><span class="num" id="8004919">1</span><span class="op" id="8004920">]</span>&nbsp;<span class="op" id="8004922">==</span>&nbsp;<span class="ident" id="8004925"><a href="/encoding/json/encode_test.go.html#8004666">encBytes</a></span><span class="op" id="8004933">[</span><span class="builtinfunc" id="8004934">len</span><span class="op" id="8004937">(</span><span class="ident" id="8004938"><a href="/encoding/json/encode_test.go.html#8004666">encBytes</a></span><span class="op" id="8004946">)</span><span class="op" id="8004947">-</span><span class="ident" id="8004948"><a href="/encoding/json/encode_test.go.html#8004726">i</a></span><span class="op" id="8004949">-</span><span class="num" id="8004950">1</span><span class="op" id="8004951">]</span>&nbsp;<span class="op" id="8004953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8004958"><a href="/encoding/json/encode_test.go.html#8004726">i</a></span><span class="op" id="8004959">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8004964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8004968"><a href="/encoding/json/encode_test.go.html#8004639">enc</a></span>&nbsp;<span class="op" id="8004972">=</span>&nbsp;<span class="ident" id="8004974"><a href="/encoding/json/encode_test.go.html#8004639">enc</a></span><span class="op" id="8004977">[</span><span class="op" id="8004978">:</span><span class="builtinfunc" id="8004979">len</span><span class="op" id="8004982">(</span><span class="ident" id="8004983"><a href="/encoding/json/encode_test.go.html#8004639">enc</a></span><span class="op" id="8004986">)</span><span class="op" id="8004987">-</span><span class="ident" id="8004988"><a href="/encoding/json/encode_test.go.html#8004726">i</a></span><span class="op" id="8004989">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8004993"><a href="/encoding/json/encode_test.go.html#8004666">encBytes</a></span>&nbsp;<span class="op" id="8005002">=</span>&nbsp;<span class="ident" id="8005004"><a href="/encoding/json/encode_test.go.html#8004666">encBytes</a></span><span class="op" id="8005012">[</span><span class="op" id="8005013">:</span><span class="builtinfunc" id="8005014">len</span><span class="op" id="8005017">(</span><span class="ident" id="8005018"><a href="/encoding/json/encode_test.go.html#8004666">encBytes</a></span><span class="op" id="8005026">)</span><span class="op" id="8005027">-</span><span class="ident" id="8005028"><a href="/encoding/json/encode_test.go.html#8004726">i</a></span><span class="op" id="8005029">]</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8005034">if</span>&nbsp;<span class="builtinfunc" id="8005037">len</span><span class="op" id="8005040">(</span><span class="ident" id="8005041"><a href="/encoding/json/encode_test.go.html#8004639">enc</a></span><span class="op" id="8005044">)</span>&nbsp;<span class="op" id="8005046">&gt;</span>&nbsp;<span class="num" id="8005048">20</span>&nbsp;<span class="op" id="8005051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8005056"><a href="/encoding/json/encode_test.go.html#8004639">enc</a></span>&nbsp;<span class="op" id="8005060">=</span>&nbsp;<span class="ident" id="8005062"><a href="/encoding/json/encode_test.go.html#8004639">enc</a></span><span class="op" id="8005065">[</span><span class="op" id="8005066">:</span><span class="num" id="8005067">20</span><span class="op" id="8005069">]</span>&nbsp;<span class="op" id="8005071">+</span>&nbsp;<span class="string" id="8005073">&#34;...&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8005081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8005085">if</span>&nbsp;<span class="builtinfunc" id="8005088">len</span><span class="op" id="8005091">(</span><span class="ident" id="8005092"><a href="/encoding/json/encode_test.go.html#8004666">encBytes</a></span><span class="op" id="8005100">)</span>&nbsp;<span class="op" id="8005102">&gt;</span>&nbsp;<span class="num" id="8005104">20</span>&nbsp;<span class="op" id="8005107">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8005112"><a href="/encoding/json/encode_test.go.html#8004666">encBytes</a></span>&nbsp;<span class="op" id="8005121">=</span>&nbsp;<span class="ident" id="8005123"><a href="/encoding/json/encode_test.go.html#8004666">encBytes</a></span><span class="op" id="8005131">[</span><span class="op" id="8005132">:</span><span class="num" id="8005133">20</span><span class="op" id="8005135">]</span>&nbsp;<span class="op" id="8005137">+</span>&nbsp;<span class="string" id="8005139">&#34;...&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8005147">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8005152"><a href="/encoding/json/encode_test.go.html#8004204">t</a></span><span class="op" id="8005153">.</span><span class="ident" id="8005154">Errorf</span><span class="op" id="8005160">(</span><span class="string" id="8005161">&#34;encodings&nbsp;differ&nbsp;at&nbsp;%#q&nbsp;vs&nbsp;%#q&#34;</span><span class="op" id="8005193">,</span>&nbsp;<span class="ident" id="8005195"><a href="/encoding/json/encode_test.go.html#8004639">enc</a></span><span class="op" id="8005198">,</span>&nbsp;<span class="ident" id="8005200"><a href="/encoding/json/encode_test.go.html#8004666">encBytes</a></span><span class="op" id="8005208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8005211">}</span><br>
<span class="lineno">420</span><span class="op" id="8005213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8005216">func</span>&nbsp;<span class="ident" id="8005221">TestIssue6458</span><span class="op" id="8005234">(</span><span class="ident" id="8005235">t</span>&nbsp;<span class="op" id="8005237">*</span><span class="ident" id="8005238"><a href="/encoding/json/encode_test.go.html#7997228">testing</a></span><span class="op" id="8005245">.</span><span class="ident" id="8005246">T</span><span class="op" id="8005247">)</span>&nbsp;<span class="op" id="8005249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8005252">type</span>&nbsp;<span class="ident" id="8005257">Foo</span>&nbsp;<span class="keyword" id="8005261">struct</span>&nbsp;<span class="op" id="8005268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8005272">M</span>&nbsp;<span class="ident" id="8005274"><a href="/encoding/json/stream.go.html#3719769">RawMessage</a></span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8005286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8005289">x</span>&nbsp;<span class="op" id="8005291">:=</span>&nbsp;<span class="ident" id="8005294"><a href="/encoding/json/encode_test.go.html#8005257">Foo</a></span><span class="op" id="8005297">{</span><span class="ident" id="8005298"><a href="/encoding/json/stream.go.html#3719769">RawMessage</a></span><span class="op" id="8005308">(</span><span class="string" id="8005309">`&#34;foo&#34;`</span><span class="op" id="8005316">)</span><span class="op" id="8005317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8005321">b</span><span class="op" id="8005322">,</span>&nbsp;<span class="ident" id="8005324">err</span>&nbsp;<span class="op" id="8005328">:=</span>&nbsp;<span class="ident" id="8005331"><a href="/encoding/json/encode.go.html#3666502">Marshal</a></span><span class="op" id="8005338">(</span><span class="op" id="8005339">&amp;</span><span class="ident" id="8005340"><a href="/encoding/json/encode_test.go.html#8005289">x</a></span><span class="op" id="8005341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8005344">if</span>&nbsp;<span class="ident" id="8005347"><a href="/encoding/json/encode_test.go.html#8005324">err</a></span>&nbsp;<span class="op" id="8005351">!=</span>&nbsp;<span class="ident" id="8005354">nil</span>&nbsp;<span class="op" id="8005358">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8005362"><a href="/encoding/json/encode_test.go.html#8005235">t</a></span><span class="op" id="8005363">.</span><span class="ident" id="8005364">Fatal</span><span class="op" id="8005369">(</span><span class="ident" id="8005370"><a href="/encoding/json/encode_test.go.html#8005324">err</a></span><span class="op" id="8005373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8005376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8005379">if</span>&nbsp;<span class="ident" id="8005382">want</span>&nbsp;<span class="op" id="8005387">:=</span>&nbsp;<span class="string" id="8005390">`{&#34;M&#34;:&#34;foo&#34;}`</span><span class="op" id="8005403">;</span>&nbsp;<span class="builtintype" id="8005405">string</span><span class="op" id="8005411">(</span><span class="ident" id="8005412"><a href="/encoding/json/encode_test.go.html#8005321">b</a></span><span class="op" id="8005413">)</span>&nbsp;<span class="op" id="8005415">!=</span>&nbsp;<span class="ident" id="8005418"><a href="/encoding/json/encode_test.go.html#8005382">want</a></span>&nbsp;<span class="op" id="8005423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8005427"><a href="/encoding/json/encode_test.go.html#8005235">t</a></span><span class="op" id="8005428">.</span><span class="ident" id="8005429">Errorf</span><span class="op" id="8005435">(</span><span class="string" id="8005436">&#34;Marshal(&amp;x)&nbsp;=&nbsp;%#q;&nbsp;want&nbsp;%#q&#34;</span><span class="op" id="8005465">,</span>&nbsp;<span class="ident" id="8005467"><a href="/encoding/json/encode_test.go.html#8005321">b</a></span><span class="op" id="8005468">,</span>&nbsp;<span class="ident" id="8005470"><a href="/encoding/json/encode_test.go.html#8005382">want</a></span><span class="op" id="8005474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8005477">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8005481"><a href="/encoding/json/encode_test.go.html#8005321">b</a></span><span class="op" id="8005482">,</span>&nbsp;<span class="ident" id="8005484"><a href="/encoding/json/encode_test.go.html#8005324">err</a></span>&nbsp;<span class="op" id="8005488">=</span>&nbsp;<span class="ident" id="8005490"><a href="/encoding/json/encode.go.html#3666502">Marshal</a></span><span class="op" id="8005497">(</span><span class="ident" id="8005498"><a href="/encoding/json/encode_test.go.html#8005289">x</a></span><span class="op" id="8005499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8005502">if</span>&nbsp;<span class="ident" id="8005505"><a href="/encoding/json/encode_test.go.html#8005324">err</a></span>&nbsp;<span class="op" id="8005509">!=</span>&nbsp;<span class="ident" id="8005512">nil</span>&nbsp;<span class="op" id="8005516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8005520"><a href="/encoding/json/encode_test.go.html#8005235">t</a></span><span class="op" id="8005521">.</span><span class="ident" id="8005522">Fatal</span><span class="op" id="8005527">(</span><span class="ident" id="8005528"><a href="/encoding/json/encode_test.go.html#8005324">err</a></span><span class="op" id="8005531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8005534">}</span><br>
<span class="lineno">440</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8005538">if</span>&nbsp;<span class="ident" id="8005541">want</span>&nbsp;<span class="op" id="8005546">:=</span>&nbsp;<span class="string" id="8005549">`{&#34;M&#34;:&#34;ImZvbyI=&#34;}`</span><span class="op" id="8005567">;</span>&nbsp;<span class="builtintype" id="8005569">string</span><span class="op" id="8005575">(</span><span class="ident" id="8005576"><a href="/encoding/json/encode_test.go.html#8005321">b</a></span><span class="op" id="8005577">)</span>&nbsp;<span class="op" id="8005579">!=</span>&nbsp;<span class="ident" id="8005582"><a href="/encoding/json/encode_test.go.html#8005541">want</a></span>&nbsp;<span class="op" id="8005587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8005591"><a href="/encoding/json/encode_test.go.html#8005235">t</a></span><span class="op" id="8005592">.</span><span class="ident" id="8005593">Errorf</span><span class="op" id="8005599">(</span><span class="string" id="8005600">&#34;Marshal(x)&nbsp;=&nbsp;%#q;&nbsp;want&nbsp;%#q&#34;</span><span class="op" id="8005628">,</span>&nbsp;<span class="ident" id="8005630"><a href="/encoding/json/encode_test.go.html#8005321">b</a></span><span class="op" id="8005631">,</span>&nbsp;<span class="ident" id="8005633"><a href="/encoding/json/encode_test.go.html#8005541">want</a></span><span class="op" id="8005637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8005640">}</span><br>
<span class="lineno"></span><span class="op" id="8005642">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="keyword" id="8005645">func</span>&nbsp;<span class="ident" id="8005650">TestHTMLEscape</span><span class="op" id="8005664">(</span><span class="ident" id="8005665">t</span>&nbsp;<span class="op" id="8005667">*</span><span class="ident" id="8005668"><a href="/encoding/json/encode_test.go.html#7997228">testing</a></span><span class="op" id="8005675">.</span><span class="ident" id="8005676">T</span><span class="op" id="8005677">)</span>&nbsp;<span class="op" id="8005679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8005682">var</span>&nbsp;<span class="ident" id="8005686">b</span><span class="op" id="8005687">,</span>&nbsp;<span class="ident" id="8005689">want</span>&nbsp;<span class="ident" id="8005694"><a href="/encoding/json/encode_test.go.html#7997200">bytes</a></span><span class="op" id="8005699">.</span><span class="ident" id="8005700">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8005708">m</span>&nbsp;<span class="op" id="8005710">:=</span>&nbsp;<span class="string" id="8005713">`{&#34;M&#34;:&#34;&lt;html&gt;foo&nbsp;&amp;`</span>&nbsp;<span class="op" id="8005733">+</span>&nbsp;<span class="string" id="8005735">&#34;\xe2\x80\xa8&nbsp;\xe2\x80\xa9&#34;</span>&nbsp;<span class="op" id="8005763">+</span>&nbsp;<span class="string" id="8005765">`&lt;/html&gt;&#34;}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8005778"><a href="/encoding/json/encode_test.go.html#8005689">want</a></span><span class="op" id="8005782">.</span><span class="ident" id="8005783">Write</span><span class="op" id="8005788">(</span><span class="op" id="8005789">[</span><span class="op" id="8005790">]</span><span class="builtintype" id="8005791">byte</span><span class="op" id="8005795">(</span><span class="string" id="8005796">`{&#34;M&#34;:&#34;\u003chtml\u003efoo&nbsp;\u0026\u2028&nbsp;\u2029\u003c/html\u003e&#34;}`</span><span class="op" id="8005862">)</span><span class="op" id="8005863">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8005866"><a href="/encoding/json/encode.go.html#3667377">HTMLEscape</a></span><span class="op" id="8005876">(</span><span class="op" id="8005877">&amp;</span><span class="ident" id="8005878"><a href="/encoding/json/encode_test.go.html#8005686">b</a></span><span class="op" id="8005879">,</span>&nbsp;<span class="op" id="8005881">[</span><span class="op" id="8005882">]</span><span class="builtintype" id="8005883">byte</span><span class="op" id="8005887">(</span><span class="ident" id="8005888"><a href="/encoding/json/encode_test.go.html#8005708">m</a></span><span class="op" id="8005889">)</span><span class="op" id="8005890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8005893">if</span>&nbsp;<span class="op" id="8005896">!</span><span class="ident" id="8005897"><a href="/encoding/json/encode_test.go.html#7997200">bytes</a></span><span class="op" id="8005902">.</span><span class="ident" id="8005903">Equal</span><span class="op" id="8005908">(</span><span class="ident" id="8005909"><a href="/encoding/json/encode_test.go.html#8005686">b</a></span><span class="op" id="8005910">.</span><span class="ident" id="8005911">Bytes</span><span class="op" id="8005916">(</span><span class="op" id="8005917">)</span><span class="op" id="8005918">,</span>&nbsp;<span class="ident" id="8005920"><a href="/encoding/json/encode_test.go.html#8005689">want</a></span><span class="op" id="8005924">.</span><span class="ident" id="8005925">Bytes</span><span class="op" id="8005930">(</span><span class="op" id="8005931">)</span><span class="op" id="8005932">)</span>&nbsp;<span class="op" id="8005934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8005938"><a href="/encoding/json/encode_test.go.html#8005665">t</a></span><span class="op" id="8005939">.</span><span class="ident" id="8005940">Errorf</span><span class="op" id="8005946">(</span><span class="string" id="8005947">&#34;HTMLEscape(&amp;b,&nbsp;[]byte(m))&nbsp;=&nbsp;%s;&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8005988">,</span>&nbsp;<span class="ident" id="8005990"><a href="/encoding/json/encode_test.go.html#8005686">b</a></span><span class="op" id="8005991">.</span><span class="ident" id="8005992">Bytes</span><span class="op" id="8005997">(</span><span class="op" id="8005998">)</span><span class="op" id="8005999">,</span>&nbsp;<span class="ident" id="8006001"><a href="/encoding/json/encode_test.go.html#8005689">want</a></span><span class="op" id="8006005">.</span><span class="ident" id="8006006">Bytes</span><span class="op" id="8006011">(</span><span class="op" id="8006012">)</span><span class="op" id="8006013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006016">}</span><br>
<span class="lineno"></span><span class="op" id="8006018">}</span><br>
<span class="lineno">455</span><br>
<span class="lineno"></span><span class="comment" id="8006021">//&nbsp;golang.org/issue/8582</span><br>
<span class="lineno"></span><span class="keyword" id="8006046">func</span>&nbsp;<span class="ident" id="8006051">TestEncodePointerString</span><span class="op" id="8006074">(</span><span class="ident" id="8006075">t</span>&nbsp;<span class="op" id="8006077">*</span><span class="ident" id="8006078"><a href="/encoding/json/encode_test.go.html#7997228">testing</a></span><span class="op" id="8006085">.</span><span class="ident" id="8006086">T</span><span class="op" id="8006087">)</span>&nbsp;<span class="op" id="8006089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8006092">type</span>&nbsp;<span class="ident" id="8006097">stringPointer</span>&nbsp;<span class="keyword" id="8006111">struct</span>&nbsp;<span class="op" id="8006118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006122">N</span>&nbsp;<span class="op" id="8006124">*</span><span class="ident" id="8006125">int64</span>&nbsp;<span class="string" id="8006131">`json:&#34;n,string&#34;`</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8006153">var</span>&nbsp;<span class="ident" id="8006157">n</span>&nbsp;<span class="ident" id="8006159">int64</span>&nbsp;<span class="op" id="8006165">=</span>&nbsp;<span class="num" id="8006167">42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006171">b</span><span class="op" id="8006172">,</span>&nbsp;<span class="ident" id="8006174">err</span>&nbsp;<span class="op" id="8006178">:=</span>&nbsp;<span class="ident" id="8006181"><a href="/encoding/json/encode.go.html#3666502">Marshal</a></span><span class="op" id="8006188">(</span><span class="ident" id="8006189"><a href="/encoding/json/encode_test.go.html#8006097">stringPointer</a></span><span class="op" id="8006202">{</span><span class="ident" id="8006203">N</span><span class="op" id="8006204">:</span>&nbsp;<span class="op" id="8006206">&amp;</span><span class="ident" id="8006207"><a href="/encoding/json/encode_test.go.html#8006157">n</a></span><span class="op" id="8006208">}</span><span class="op" id="8006209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8006212">if</span>&nbsp;<span class="ident" id="8006215"><a href="/encoding/json/encode_test.go.html#8006174">err</a></span>&nbsp;<span class="op" id="8006219">!=</span>&nbsp;<span class="ident" id="8006222">nil</span>&nbsp;<span class="op" id="8006226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006230"><a href="/encoding/json/encode_test.go.html#8006075">t</a></span><span class="op" id="8006231">.</span><span class="ident" id="8006232">Fatalf</span><span class="op" id="8006238">(</span><span class="string" id="8006239">&#34;Marshal:&nbsp;%v&#34;</span><span class="op" id="8006252">,</span>&nbsp;<span class="ident" id="8006254"><a href="/encoding/json/encode_test.go.html#8006174">err</a></span><span class="op" id="8006257">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8006263">if</span>&nbsp;<span class="ident" id="8006266">got</span><span class="op" id="8006269">,</span>&nbsp;<span class="ident" id="8006271">want</span>&nbsp;<span class="op" id="8006276">:=</span>&nbsp;<span class="builtintype" id="8006279">string</span><span class="op" id="8006285">(</span><span class="ident" id="8006286"><a href="/encoding/json/encode_test.go.html#8006171">b</a></span><span class="op" id="8006287">)</span><span class="op" id="8006288">,</span>&nbsp;<span class="string" id="8006290">`{&#34;n&#34;:&#34;42&#34;}`</span><span class="op" id="8006302">;</span>&nbsp;<span class="ident" id="8006304"><a href="/encoding/json/encode_test.go.html#8006266">got</a></span>&nbsp;<span class="op" id="8006308">!=</span>&nbsp;<span class="ident" id="8006311"><a href="/encoding/json/encode_test.go.html#8006271">want</a></span>&nbsp;<span class="op" id="8006316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006320"><a href="/encoding/json/encode_test.go.html#8006075">t</a></span><span class="op" id="8006321">.</span><span class="ident" id="8006322">Errorf</span><span class="op" id="8006328">(</span><span class="string" id="8006329">&#34;Marshal&nbsp;=&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8006352">,</span>&nbsp;<span class="ident" id="8006354"><a href="/encoding/json/encode_test.go.html#8006266">got</a></span><span class="op" id="8006357">,</span>&nbsp;<span class="ident" id="8006359"><a href="/encoding/json/encode_test.go.html#8006271">want</a></span><span class="op" id="8006363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8006369">var</span>&nbsp;<span class="ident" id="8006373">back</span>&nbsp;<span class="ident" id="8006378"><a href="/encoding/json/encode_test.go.html#8006097">stringPointer</a></span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006393"><a href="/encoding/json/encode_test.go.html#8006174">err</a></span>&nbsp;<span class="op" id="8006397">=</span>&nbsp;<span class="ident" id="8006399"><a href="/encoding/json/decode.go.html#3636951">Unmarshal</a></span><span class="op" id="8006408">(</span><span class="ident" id="8006409"><a href="/encoding/json/encode_test.go.html#8006171">b</a></span><span class="op" id="8006410">,</span>&nbsp;<span class="op" id="8006412">&amp;</span><span class="ident" id="8006413"><a href="/encoding/json/encode_test.go.html#8006373">back</a></span><span class="op" id="8006417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8006420">if</span>&nbsp;<span class="ident" id="8006423"><a href="/encoding/json/encode_test.go.html#8006174">err</a></span>&nbsp;<span class="op" id="8006427">!=</span>&nbsp;<span class="ident" id="8006430">nil</span>&nbsp;<span class="op" id="8006434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006438"><a href="/encoding/json/encode_test.go.html#8006075">t</a></span><span class="op" id="8006439">.</span><span class="ident" id="8006440">Fatalf</span><span class="op" id="8006446">(</span><span class="string" id="8006447">&#34;Unmarshal:&nbsp;%v&#34;</span><span class="op" id="8006462">,</span>&nbsp;<span class="ident" id="8006464"><a href="/encoding/json/encode_test.go.html#8006174">err</a></span><span class="op" id="8006467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8006473">if</span>&nbsp;<span class="ident" id="8006476"><a href="/encoding/json/encode_test.go.html#8006373">back</a></span><span class="op" id="8006480">.</span><span class="ident" id="8006481">N</span>&nbsp;<span class="op" id="8006483">==</span>&nbsp;<span class="ident" id="8006486">nil</span>&nbsp;<span class="op" id="8006490">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006494"><a href="/encoding/json/encode_test.go.html#8006075">t</a></span><span class="op" id="8006495">.</span><span class="ident" id="8006496">Fatalf</span><span class="op" id="8006502">(</span><span class="string" id="8006503">&#34;Unmarshalled&nbsp;nil&nbsp;N&nbsp;field&#34;</span><span class="op" id="8006529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8006535">if</span>&nbsp;<span class="op" id="8006538">*</span><span class="ident" id="8006539"><a href="/encoding/json/encode_test.go.html#8006373">back</a></span><span class="op" id="8006543">.</span><span class="ident" id="8006544">N</span>&nbsp;<span class="op" id="8006546">!=</span>&nbsp;<span class="num" id="8006549">42</span>&nbsp;<span class="op" id="8006552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006556"><a href="/encoding/json/encode_test.go.html#8006075">t</a></span><span class="op" id="8006557">.</span><span class="ident" id="8006558">Fatalf</span><span class="op" id="8006564">(</span><span class="string" id="8006565">&#34;*N&nbsp;=&nbsp;%d;&nbsp;want&nbsp;42&#34;</span><span class="op" id="8006583">,</span>&nbsp;<span class="op" id="8006585">*</span><span class="ident" id="8006586"><a href="/encoding/json/encode_test.go.html#8006373">back</a></span><span class="op" id="8006590">.</span><span class="ident" id="8006591">N</span><span class="op" id="8006592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006595">}</span><br>
<span class="lineno">480</span><span class="op" id="8006597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8006600">var</span>&nbsp;<span class="ident" id="8006604">encodeStringTests</span>&nbsp;<span class="op" id="8006622">=</span>&nbsp;<span class="op" id="8006624">[</span><span class="op" id="8006625">]</span><span class="keyword" id="8006626">struct</span>&nbsp;<span class="op" id="8006633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006636">in</span>&nbsp;&nbsp;<span class="builtintype" id="8006640">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8006648">out</span>&nbsp;<span class="builtintype" id="8006652">string</span><br>
<span class="lineno">485</span><span class="op" id="8006659">}</span><span class="op" id="8006660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006663">{</span><span class="string" id="8006664">&#34;\x00&#34;</span><span class="op" id="8006670">,</span>&nbsp;<span class="string" id="8006672">`&#34;\u0000&#34;`</span><span class="op" id="8006682">}</span><span class="op" id="8006683">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006686">{</span><span class="string" id="8006687">&#34;\x01&#34;</span><span class="op" id="8006693">,</span>&nbsp;<span class="string" id="8006695">`&#34;\u0001&#34;`</span><span class="op" id="8006705">}</span><span class="op" id="8006706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006709">{</span><span class="string" id="8006710">&#34;\x02&#34;</span><span class="op" id="8006716">,</span>&nbsp;<span class="string" id="8006718">`&#34;\u0002&#34;`</span><span class="op" id="8006728">}</span><span class="op" id="8006729">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006732">{</span><span class="string" id="8006733">&#34;\x03&#34;</span><span class="op" id="8006739">,</span>&nbsp;<span class="string" id="8006741">`&#34;\u0003&#34;`</span><span class="op" id="8006751">}</span><span class="op" id="8006752">,</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006755">{</span><span class="string" id="8006756">&#34;\x04&#34;</span><span class="op" id="8006762">,</span>&nbsp;<span class="string" id="8006764">`&#34;\u0004&#34;`</span><span class="op" id="8006774">}</span><span class="op" id="8006775">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006778">{</span><span class="string" id="8006779">&#34;\x05&#34;</span><span class="op" id="8006785">,</span>&nbsp;<span class="string" id="8006787">`&#34;\u0005&#34;`</span><span class="op" id="8006797">}</span><span class="op" id="8006798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006801">{</span><span class="string" id="8006802">&#34;\x06&#34;</span><span class="op" id="8006808">,</span>&nbsp;<span class="string" id="8006810">`&#34;\u0006&#34;`</span><span class="op" id="8006820">}</span><span class="op" id="8006821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006824">{</span><span class="string" id="8006825">&#34;\x07&#34;</span><span class="op" id="8006831">,</span>&nbsp;<span class="string" id="8006833">`&#34;\u0007&#34;`</span><span class="op" id="8006843">}</span><span class="op" id="8006844">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006847">{</span><span class="string" id="8006848">&#34;\x08&#34;</span><span class="op" id="8006854">,</span>&nbsp;<span class="string" id="8006856">`&#34;\u0008&#34;`</span><span class="op" id="8006866">}</span><span class="op" id="8006867">,</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006870">{</span><span class="string" id="8006871">&#34;\x09&#34;</span><span class="op" id="8006877">,</span>&nbsp;<span class="string" id="8006879">`&#34;\t&#34;`</span><span class="op" id="8006885">}</span><span class="op" id="8006886">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006889">{</span><span class="string" id="8006890">&#34;\x0a&#34;</span><span class="op" id="8006896">,</span>&nbsp;<span class="string" id="8006898">`&#34;\n&#34;`</span><span class="op" id="8006904">}</span><span class="op" id="8006905">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006908">{</span><span class="string" id="8006909">&#34;\x0b&#34;</span><span class="op" id="8006915">,</span>&nbsp;<span class="string" id="8006917">`&#34;\u000b&#34;`</span><span class="op" id="8006927">}</span><span class="op" id="8006928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006931">{</span><span class="string" id="8006932">&#34;\x0c&#34;</span><span class="op" id="8006938">,</span>&nbsp;<span class="string" id="8006940">`&#34;\u000c&#34;`</span><span class="op" id="8006950">}</span><span class="op" id="8006951">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006954">{</span><span class="string" id="8006955">&#34;\x0d&#34;</span><span class="op" id="8006961">,</span>&nbsp;<span class="string" id="8006963">`&#34;\r&#34;`</span><span class="op" id="8006969">}</span><span class="op" id="8006970">,</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006973">{</span><span class="string" id="8006974">&#34;\x0e&#34;</span><span class="op" id="8006980">,</span>&nbsp;<span class="string" id="8006982">`&#34;\u000e&#34;`</span><span class="op" id="8006992">}</span><span class="op" id="8006993">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8006996">{</span><span class="string" id="8006997">&#34;\x0f&#34;</span><span class="op" id="8007003">,</span>&nbsp;<span class="string" id="8007005">`&#34;\u000f&#34;`</span><span class="op" id="8007015">}</span><span class="op" id="8007016">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007019">{</span><span class="string" id="8007020">&#34;\x10&#34;</span><span class="op" id="8007026">,</span>&nbsp;<span class="string" id="8007028">`&#34;\u0010&#34;`</span><span class="op" id="8007038">}</span><span class="op" id="8007039">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007042">{</span><span class="string" id="8007043">&#34;\x11&#34;</span><span class="op" id="8007049">,</span>&nbsp;<span class="string" id="8007051">`&#34;\u0011&#34;`</span><span class="op" id="8007061">}</span><span class="op" id="8007062">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007065">{</span><span class="string" id="8007066">&#34;\x12&#34;</span><span class="op" id="8007072">,</span>&nbsp;<span class="string" id="8007074">`&#34;\u0012&#34;`</span><span class="op" id="8007084">}</span><span class="op" id="8007085">,</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007088">{</span><span class="string" id="8007089">&#34;\x13&#34;</span><span class="op" id="8007095">,</span>&nbsp;<span class="string" id="8007097">`&#34;\u0013&#34;`</span><span class="op" id="8007107">}</span><span class="op" id="8007108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007111">{</span><span class="string" id="8007112">&#34;\x14&#34;</span><span class="op" id="8007118">,</span>&nbsp;<span class="string" id="8007120">`&#34;\u0014&#34;`</span><span class="op" id="8007130">}</span><span class="op" id="8007131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007134">{</span><span class="string" id="8007135">&#34;\x15&#34;</span><span class="op" id="8007141">,</span>&nbsp;<span class="string" id="8007143">`&#34;\u0015&#34;`</span><span class="op" id="8007153">}</span><span class="op" id="8007154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007157">{</span><span class="string" id="8007158">&#34;\x16&#34;</span><span class="op" id="8007164">,</span>&nbsp;<span class="string" id="8007166">`&#34;\u0016&#34;`</span><span class="op" id="8007176">}</span><span class="op" id="8007177">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007180">{</span><span class="string" id="8007181">&#34;\x17&#34;</span><span class="op" id="8007187">,</span>&nbsp;<span class="string" id="8007189">`&#34;\u0017&#34;`</span><span class="op" id="8007199">}</span><span class="op" id="8007200">,</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007203">{</span><span class="string" id="8007204">&#34;\x18&#34;</span><span class="op" id="8007210">,</span>&nbsp;<span class="string" id="8007212">`&#34;\u0018&#34;`</span><span class="op" id="8007222">}</span><span class="op" id="8007223">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007226">{</span><span class="string" id="8007227">&#34;\x19&#34;</span><span class="op" id="8007233">,</span>&nbsp;<span class="string" id="8007235">`&#34;\u0019&#34;`</span><span class="op" id="8007245">}</span><span class="op" id="8007246">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007249">{</span><span class="string" id="8007250">&#34;\x1a&#34;</span><span class="op" id="8007256">,</span>&nbsp;<span class="string" id="8007258">`&#34;\u001a&#34;`</span><span class="op" id="8007268">}</span><span class="op" id="8007269">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007272">{</span><span class="string" id="8007273">&#34;\x1b&#34;</span><span class="op" id="8007279">,</span>&nbsp;<span class="string" id="8007281">`&#34;\u001b&#34;`</span><span class="op" id="8007291">}</span><span class="op" id="8007292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007295">{</span><span class="string" id="8007296">&#34;\x1c&#34;</span><span class="op" id="8007302">,</span>&nbsp;<span class="string" id="8007304">`&#34;\u001c&#34;`</span><span class="op" id="8007314">}</span><span class="op" id="8007315">,</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007318">{</span><span class="string" id="8007319">&#34;\x1d&#34;</span><span class="op" id="8007325">,</span>&nbsp;<span class="string" id="8007327">`&#34;\u001d&#34;`</span><span class="op" id="8007337">}</span><span class="op" id="8007338">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007341">{</span><span class="string" id="8007342">&#34;\x1e&#34;</span><span class="op" id="8007348">,</span>&nbsp;<span class="string" id="8007350">`&#34;\u001e&#34;`</span><span class="op" id="8007360">}</span><span class="op" id="8007361">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007364">{</span><span class="string" id="8007365">&#34;\x1f&#34;</span><span class="op" id="8007371">,</span>&nbsp;<span class="string" id="8007373">`&#34;\u001f&#34;`</span><span class="op" id="8007383">}</span><span class="op" id="8007384">,</span><br>
<span class="lineno"></span><span class="op" id="8007386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">520</span><span class="keyword" id="8007389">func</span>&nbsp;<span class="ident" id="8007394">TestEncodeString</span><span class="op" id="8007410">(</span><span class="ident" id="8007411">t</span>&nbsp;<span class="op" id="8007413">*</span><span class="ident" id="8007414"><a href="/encoding/json/encode_test.go.html#7997228">testing</a></span><span class="op" id="8007421">.</span><span class="ident" id="8007422">T</span><span class="op" id="8007423">)</span>&nbsp;<span class="op" id="8007425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8007428">for</span>&nbsp;<span class="ident" id="8007432">_</span><span class="op" id="8007433">,</span>&nbsp;<span class="ident" id="8007435">tt</span>&nbsp;<span class="op" id="8007438">:=</span>&nbsp;<span class="keyword" id="8007441">range</span>&nbsp;<span class="ident" id="8007447"><a href="/encoding/json/encode_test.go.html#8006604">encodeStringTests</a></span>&nbsp;<span class="op" id="8007465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007469">b</span><span class="op" id="8007470">,</span>&nbsp;<span class="ident" id="8007472">err</span>&nbsp;<span class="op" id="8007476">:=</span>&nbsp;<span class="ident" id="8007479"><a href="/encoding/json/encode.go.html#3666502">Marshal</a></span><span class="op" id="8007486">(</span><span class="ident" id="8007487"><a href="/encoding/json/encode_test.go.html#8007435">tt</a></span><span class="op" id="8007489">.</span><span class="ident" id="8007490">in</span><span class="op" id="8007492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8007496">if</span>&nbsp;<span class="ident" id="8007499"><a href="/encoding/json/encode_test.go.html#8007472">err</a></span>&nbsp;<span class="op" id="8007503">!=</span>&nbsp;<span class="ident" id="8007506">nil</span>&nbsp;<span class="op" id="8007510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007515"><a href="/encoding/json/encode_test.go.html#8007411">t</a></span><span class="op" id="8007516">.</span><span class="ident" id="8007517">Errorf</span><span class="op" id="8007523">(</span><span class="string" id="8007524">&#34;Marshal(%q):&nbsp;%v&#34;</span><span class="op" id="8007541">,</span>&nbsp;<span class="ident" id="8007543"><a href="/encoding/json/encode_test.go.html#8007435">tt</a></span><span class="op" id="8007545">.</span><span class="ident" id="8007546">in</span><span class="op" id="8007548">,</span>&nbsp;<span class="ident" id="8007550"><a href="/encoding/json/encode_test.go.html#8007472">err</a></span><span class="op" id="8007553">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8007558">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007573">out</span>&nbsp;<span class="op" id="8007577">:=</span>&nbsp;<span class="builtintype" id="8007580">string</span><span class="op" id="8007586">(</span><span class="ident" id="8007587"><a href="/encoding/json/encode_test.go.html#8007469">b</a></span><span class="op" id="8007588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8007592">if</span>&nbsp;<span class="ident" id="8007595"><a href="/encoding/json/encode_test.go.html#8007573">out</a></span>&nbsp;<span class="op" id="8007599">!=</span>&nbsp;<span class="ident" id="8007602"><a href="/encoding/json/encode_test.go.html#8007435">tt</a></span><span class="op" id="8007604">.</span><span class="ident" id="8007605">out</span>&nbsp;<span class="op" id="8007609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8007614"><a href="/encoding/json/encode_test.go.html#8007411">t</a></span><span class="op" id="8007615">.</span><span class="ident" id="8007616">Errorf</span><span class="op" id="8007622">(</span><span class="string" id="8007623">&#34;Marshal(%q)&nbsp;=&nbsp;%#q,&nbsp;want&nbsp;%#q&#34;</span><span class="op" id="8007652">,</span>&nbsp;<span class="ident" id="8007654"><a href="/encoding/json/encode_test.go.html#8007435">tt</a></span><span class="op" id="8007656">.</span><span class="ident" id="8007657">in</span><span class="op" id="8007659">,</span>&nbsp;<span class="ident" id="8007661"><a href="/encoding/json/encode_test.go.html#8007573">out</a></span><span class="op" id="8007664">,</span>&nbsp;<span class="ident" id="8007666"><a href="/encoding/json/encode_test.go.html#8007435">tt</a></span><span class="op" id="8007668">.</span><span class="ident" id="8007669">out</span><span class="op" id="8007672">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8007679">}</span><br>
<span class="lineno"></span><span class="op" id="8007681">}</span>
</div>
</body>
</html>
