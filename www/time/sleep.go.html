<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2485817">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2485872">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2485926">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2485977">package</span>&nbsp;<span class="ident" id="2485985">time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2485991">//&nbsp;Sleep&nbsp;pauses&nbsp;the&nbsp;current&nbsp;goroutine&nbsp;for&nbsp;at&nbsp;least&nbsp;the&nbsp;duration&nbsp;d.</span><br>
<span class="lineno"></span><span class="comment" id="2486058">//&nbsp;A&nbsp;negative&nbsp;or&nbsp;zero&nbsp;duration&nbsp;causes&nbsp;Sleep&nbsp;to&nbsp;return&nbsp;immediately.</span><br>
<span class="lineno"></span><span class="keyword" id="2486125">func</span>&nbsp;<span class="ident" id="2486130">Sleep</span><span class="op" id="2486135">(</span><span class="ident" id="2486136">d</span>&nbsp;<span class="ident" id="2486138">Duration</span><span class="op" id="2486146">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2486149">//&nbsp;runtimeNano&nbsp;returns&nbsp;the&nbsp;current&nbsp;value&nbsp;of&nbsp;the&nbsp;runtime&nbsp;clock&nbsp;in&nbsp;nanoseconds.</span><br>
<span class="lineno"></span><span class="keyword" id="2486227">func</span>&nbsp;<span class="ident" id="2486232">runtimeNano</span><span class="op" id="2486243">(</span><span class="op" id="2486244">)</span>&nbsp;<span class="ident" id="2486246">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2486253">//&nbsp;Interface&nbsp;to&nbsp;timers&nbsp;implemented&nbsp;in&nbsp;package&nbsp;runtime.</span><br>
<span class="lineno">15</span><span class="comment" id="2486308">//&nbsp;Must&nbsp;be&nbsp;in&nbsp;sync&nbsp;with&nbsp;../runtime/runtime.h:/^struct.Timer$</span><br>
<span class="lineno"></span><span class="keyword" id="2486369">type</span>&nbsp;<span class="ident" id="2486374">runtimeTimer</span>&nbsp;<span class="keyword" id="2486387">struct</span>&nbsp;<span class="op" id="2486394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2486397">i</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2486404">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2486409">when</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2486416">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2486423">period</span>&nbsp;<span class="ident" id="2486430">int64</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2486437">f</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2486444">func</span><span class="op" id="2486448">(</span><span class="keyword" id="2486449">interface</span><span class="op" id="2486458">{</span><span class="op" id="2486459">}</span><span class="op" id="2486460">,</span>&nbsp;<span class="builtintype" id="2486462">uintptr</span><span class="op" id="2486469">)</span>&nbsp;<span class="comment" id="2486471">//&nbsp;NOTE:&nbsp;must&nbsp;not&nbsp;be&nbsp;closure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2486501">arg</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2486508">interface</span><span class="op" id="2486517">{</span><span class="op" id="2486518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2486521">seq</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2486528">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2486536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="2486539">//&nbsp;when&nbsp;is&nbsp;a&nbsp;helper&nbsp;function&nbsp;for&nbsp;setting&nbsp;the&nbsp;&#39;when&#39;&nbsp;field&nbsp;of&nbsp;a&nbsp;runtimeTimer.</span><br>
<span class="lineno"></span><span class="comment" id="2486616">//&nbsp;It&nbsp;returns&nbsp;what&nbsp;the&nbsp;time&nbsp;will&nbsp;be,&nbsp;in&nbsp;nanoseconds,&nbsp;Duration&nbsp;d&nbsp;in&nbsp;the&nbsp;future.</span><br>
<span class="lineno"></span><span class="comment" id="2486695">//&nbsp;If&nbsp;d&nbsp;is&nbsp;negative,&nbsp;it&nbsp;is&nbsp;ignored.&nbsp;&nbsp;If&nbsp;the&nbsp;returned&nbsp;value&nbsp;would&nbsp;be&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="2486773">//&nbsp;zero&nbsp;because&nbsp;of&nbsp;an&nbsp;overflow,&nbsp;MaxInt64&nbsp;is&nbsp;returned.</span><br>
<span class="lineno"></span><span class="keyword" id="2486827">func</span>&nbsp;<span class="ident" id="2486832">when</span><span class="op" id="2486836">(</span><span class="ident" id="2486837">d</span>&nbsp;<span class="ident" id="2486839">Duration</span><span class="op" id="2486847">)</span>&nbsp;<span class="ident" id="2486849">int64</span>&nbsp;<span class="op" id="2486855">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2486858">if</span>&nbsp;<span class="ident" id="2486861">d</span>&nbsp;<span class="op" id="2486863">&lt;=</span>&nbsp;<span class="num" id="2486866">0</span>&nbsp;<span class="op" id="2486868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2486872">return</span>&nbsp;<span class="ident" id="2486879">runtimeNano</span><span class="op" id="2486890">(</span><span class="op" id="2486891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2486894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2486897">t</span>&nbsp;<span class="op" id="2486899">:=</span>&nbsp;<span class="ident" id="2486902">runtimeNano</span><span class="op" id="2486913">(</span><span class="op" id="2486914">)</span>&nbsp;<span class="op" id="2486916">+</span>&nbsp;<span class="ident" id="2486918">int64</span><span class="op" id="2486923">(</span><span class="ident" id="2486924">d</span><span class="op" id="2486925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2486928">if</span>&nbsp;<span class="ident" id="2486931">t</span>&nbsp;<span class="op" id="2486933">&lt;</span>&nbsp;<span class="num" id="2486935">0</span>&nbsp;<span class="op" id="2486937">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2486941">t</span>&nbsp;<span class="op" id="2486943">=</span>&nbsp;<span class="num" id="2486945">1</span><span class="op" id="2486946">&lt;&lt;</span><span class="num" id="2486948">63</span>&nbsp;<span class="op" id="2486951">-</span>&nbsp;<span class="num" id="2486953">1</span>&nbsp;<span class="comment" id="2486955">//&nbsp;math.MaxInt64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2486973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2486976">return</span>&nbsp;<span class="ident" id="2486983">t</span><br>
<span class="lineno"></span><span class="op" id="2486985">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="2486988">func</span>&nbsp;<span class="ident" id="2486993">startTimer</span><span class="op" id="2487003">(</span><span class="op" id="2487004">*</span><span class="ident" id="2487005">runtimeTimer</span><span class="op" id="2487017">)</span><br>
<span class="lineno"></span><span class="keyword" id="2487019">func</span>&nbsp;<span class="ident" id="2487024">stopTimer</span><span class="op" id="2487033">(</span><span class="op" id="2487034">*</span><span class="ident" id="2487035">runtimeTimer</span><span class="op" id="2487047">)</span>&nbsp;<span class="builtintype" id="2487049">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2487055">//&nbsp;The&nbsp;Timer&nbsp;type&nbsp;represents&nbsp;a&nbsp;single&nbsp;event.</span><br>
<span class="lineno"></span><span class="comment" id="2487100">//&nbsp;When&nbsp;the&nbsp;Timer&nbsp;expires,&nbsp;the&nbsp;current&nbsp;time&nbsp;will&nbsp;be&nbsp;sent&nbsp;on&nbsp;C,</span><br>
<span class="lineno">45</span><span class="comment" id="2487163">//&nbsp;unless&nbsp;the&nbsp;Timer&nbsp;was&nbsp;created&nbsp;by&nbsp;AfterFunc.</span><br>
<span class="lineno"></span><span class="comment" id="2487209">//&nbsp;A&nbsp;Timer&nbsp;must&nbsp;be&nbsp;created&nbsp;with&nbsp;NewTimer&nbsp;or&nbsp;AfterFunc.</span><br>
<span class="lineno"></span><span class="keyword" id="2487264">type</span>&nbsp;<span class="ident" id="2487269">Timer</span>&nbsp;<span class="keyword" id="2487275">struct</span>&nbsp;<span class="op" id="2487282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2487285">C</span>&nbsp;<span class="op" id="2487287">&lt;-</span><span class="keyword" id="2487289">chan</span>&nbsp;<span class="ident" id="2487294">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2487300">r</span>&nbsp;<span class="ident" id="2487302">runtimeTimer</span><br>
<span class="lineno">50</span><span class="op" id="2487315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2487318">//&nbsp;Stop&nbsp;prevents&nbsp;the&nbsp;Timer&nbsp;from&nbsp;firing.</span><br>
<span class="lineno"></span><span class="comment" id="2487358">//&nbsp;It&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;call&nbsp;stops&nbsp;the&nbsp;timer,&nbsp;false&nbsp;if&nbsp;the&nbsp;timer&nbsp;has&nbsp;already</span><br>
<span class="lineno"></span><span class="comment" id="2487437">//&nbsp;expired&nbsp;or&nbsp;been&nbsp;stopped.</span><br>
<span class="lineno">55</span><span class="comment" id="2487465">//&nbsp;Stop&nbsp;does&nbsp;not&nbsp;close&nbsp;the&nbsp;channel,&nbsp;to&nbsp;prevent&nbsp;a&nbsp;read&nbsp;from&nbsp;the&nbsp;channel&nbsp;succeeding</span><br>
<span class="lineno"></span><span class="comment" id="2487547">//&nbsp;incorrectly.</span><br>
<span class="lineno"></span><span class="keyword" id="2487563">func</span>&nbsp;<span class="op" id="2487568">(</span><span class="ident" id="2487569">t</span>&nbsp;<span class="op" id="2487571">*</span><span class="ident" id="2487572">Timer</span><span class="op" id="2487577">)</span>&nbsp;<span class="ident" id="2487579">Stop</span><span class="op" id="2487583">(</span><span class="op" id="2487584">)</span>&nbsp;<span class="builtintype" id="2487586">bool</span>&nbsp;<span class="op" id="2487591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2487594">if</span>&nbsp;<span class="ident" id="2487597">t</span><span class="op" id="2487598">.</span><span class="ident" id="2487599">r</span><span class="op" id="2487600">.</span><span class="ident" id="2487601">f</span>&nbsp;<span class="op" id="2487603">==</span>&nbsp;<span class="ident" id="2487606">nil</span>&nbsp;<span class="op" id="2487610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2487614">panic</span><span class="op" id="2487619">(</span><span class="string" id="2487620">&#34;time:&nbsp;Stop&nbsp;called&nbsp;on&nbsp;uninitialized&nbsp;Timer&#34;</span><span class="op" id="2487662">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2487665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2487668">return</span>&nbsp;<span class="ident" id="2487675">stopTimer</span><span class="op" id="2487684">(</span><span class="op" id="2487685">&amp;</span><span class="ident" id="2487686">t</span><span class="op" id="2487687">.</span><span class="ident" id="2487688">r</span><span class="op" id="2487689">)</span><br>
<span class="lineno"></span><span class="op" id="2487691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2487694">//&nbsp;NewTimer&nbsp;creates&nbsp;a&nbsp;new&nbsp;Timer&nbsp;that&nbsp;will&nbsp;send</span><br>
<span class="lineno">65</span><span class="comment" id="2487741">//&nbsp;the&nbsp;current&nbsp;time&nbsp;on&nbsp;its&nbsp;channel&nbsp;after&nbsp;at&nbsp;least&nbsp;duration&nbsp;d.</span><br>
<span class="lineno"></span><span class="keyword" id="2487803">func</span>&nbsp;<span class="ident" id="2487808">NewTimer</span><span class="op" id="2487816">(</span><span class="ident" id="2487817">d</span>&nbsp;<span class="ident" id="2487819">Duration</span><span class="op" id="2487827">)</span>&nbsp;<span class="op" id="2487829">*</span><span class="ident" id="2487830">Timer</span>&nbsp;<span class="op" id="2487836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2487839">c</span>&nbsp;<span class="op" id="2487841">:=</span>&nbsp;<span class="builtinfunc" id="2487844">make</span><span class="op" id="2487848">(</span><span class="keyword" id="2487849">chan</span>&nbsp;<span class="ident" id="2487854">Time</span><span class="op" id="2487858">,</span>&nbsp;<span class="num" id="2487860">1</span><span class="op" id="2487861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2487864">t</span>&nbsp;<span class="op" id="2487866">:=</span>&nbsp;<span class="op" id="2487869">&amp;</span><span class="ident" id="2487870">Timer</span><span class="op" id="2487875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2487879">C</span><span class="op" id="2487880">:</span>&nbsp;<span class="ident" id="2487882">c</span><span class="op" id="2487883">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2487887">r</span><span class="op" id="2487888">:</span>&nbsp;<span class="ident" id="2487890">runtimeTimer</span><span class="op" id="2487902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2487907">when</span><span class="op" id="2487911">:</span>&nbsp;<span class="ident" id="2487913">when</span><span class="op" id="2487917">(</span><span class="ident" id="2487918">d</span><span class="op" id="2487919">)</span><span class="op" id="2487920">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2487925">f</span><span class="op" id="2487926">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2487931">sendTime</span><span class="op" id="2487939">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2487944">arg</span><span class="op" id="2487947">:</span>&nbsp;&nbsp;<span class="ident" id="2487950">c</span><span class="op" id="2487951">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2487955">}</span><span class="op" id="2487956">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2487959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2487962">startTimer</span><span class="op" id="2487972">(</span><span class="op" id="2487973">&amp;</span><span class="ident" id="2487974">t</span><span class="op" id="2487975">.</span><span class="ident" id="2487976">r</span><span class="op" id="2487977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2487980">return</span>&nbsp;<span class="ident" id="2487987">t</span><br>
<span class="lineno"></span><span class="op" id="2487989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="2487992">//&nbsp;Reset&nbsp;changes&nbsp;the&nbsp;timer&nbsp;to&nbsp;expire&nbsp;after&nbsp;duration&nbsp;d.</span><br>
<span class="lineno"></span><span class="comment" id="2488047">//&nbsp;It&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;timer&nbsp;had&nbsp;been&nbsp;active,&nbsp;false&nbsp;if&nbsp;the&nbsp;timer&nbsp;had</span><br>
<span class="lineno"></span><span class="comment" id="2488119">//&nbsp;expired&nbsp;or&nbsp;been&nbsp;stopped.</span><br>
<span class="lineno"></span><span class="keyword" id="2488147">func</span>&nbsp;<span class="op" id="2488152">(</span><span class="ident" id="2488153">t</span>&nbsp;<span class="op" id="2488155">*</span><span class="ident" id="2488156">Timer</span><span class="op" id="2488161">)</span>&nbsp;<span class="ident" id="2488163">Reset</span><span class="op" id="2488168">(</span><span class="ident" id="2488169">d</span>&nbsp;<span class="ident" id="2488171">Duration</span><span class="op" id="2488179">)</span>&nbsp;<span class="builtintype" id="2488181">bool</span>&nbsp;<span class="op" id="2488186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2488189">if</span>&nbsp;<span class="ident" id="2488192">t</span><span class="op" id="2488193">.</span><span class="ident" id="2488194">r</span><span class="op" id="2488195">.</span><span class="ident" id="2488196">f</span>&nbsp;<span class="op" id="2488198">==</span>&nbsp;<span class="ident" id="2488201">nil</span>&nbsp;<span class="op" id="2488205">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2488209">panic</span><span class="op" id="2488214">(</span><span class="string" id="2488215">&#34;time:&nbsp;Reset&nbsp;called&nbsp;on&nbsp;uninitialized&nbsp;Timer&#34;</span><span class="op" id="2488258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2488261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2488264">w</span>&nbsp;<span class="op" id="2488266">:=</span>&nbsp;<span class="ident" id="2488269">when</span><span class="op" id="2488273">(</span><span class="ident" id="2488274">d</span><span class="op" id="2488275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2488278">active</span>&nbsp;<span class="op" id="2488285">:=</span>&nbsp;<span class="ident" id="2488288">stopTimer</span><span class="op" id="2488297">(</span><span class="op" id="2488298">&amp;</span><span class="ident" id="2488299">t</span><span class="op" id="2488300">.</span><span class="ident" id="2488301">r</span><span class="op" id="2488302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2488305">t</span><span class="op" id="2488306">.</span><span class="ident" id="2488307">r</span><span class="op" id="2488308">.</span><span class="ident" id="2488309">when</span>&nbsp;<span class="op" id="2488314">=</span>&nbsp;<span class="ident" id="2488316">w</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2488319">startTimer</span><span class="op" id="2488329">(</span><span class="op" id="2488330">&amp;</span><span class="ident" id="2488331">t</span><span class="op" id="2488332">.</span><span class="ident" id="2488333">r</span><span class="op" id="2488334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2488337">return</span>&nbsp;<span class="ident" id="2488344">active</span><br>
<span class="lineno"></span><span class="op" id="2488351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2488354">func</span>&nbsp;<span class="ident" id="2488359">sendTime</span><span class="op" id="2488367">(</span><span class="ident" id="2488368">c</span>&nbsp;<span class="keyword" id="2488370">interface</span><span class="op" id="2488379">{</span><span class="op" id="2488380">}</span><span class="op" id="2488381">,</span>&nbsp;<span class="ident" id="2488383">seq</span>&nbsp;<span class="builtintype" id="2488387">uintptr</span><span class="op" id="2488394">)</span>&nbsp;<span class="op" id="2488396">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2488399">//&nbsp;Non-blocking&nbsp;send&nbsp;of&nbsp;time&nbsp;on&nbsp;c.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2488435">//&nbsp;Used&nbsp;in&nbsp;NewTimer,&nbsp;it&nbsp;cannot&nbsp;block&nbsp;anyway&nbsp;(buffer).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2488490">//&nbsp;Used&nbsp;in&nbsp;NewTicker,&nbsp;dropping&nbsp;sends&nbsp;on&nbsp;the&nbsp;floor&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2488544">//&nbsp;the&nbsp;desired&nbsp;behavior&nbsp;when&nbsp;the&nbsp;reader&nbsp;gets&nbsp;behind,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2488598">//&nbsp;because&nbsp;the&nbsp;sends&nbsp;are&nbsp;periodic.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2488634">select</span>&nbsp;<span class="op" id="2488641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2488644">case</span>&nbsp;<span class="ident" id="2488649">c</span><span class="op" id="2488650">.</span><span class="op" id="2488651">(</span><span class="keyword" id="2488652">chan</span>&nbsp;<span class="ident" id="2488657">Time</span><span class="op" id="2488661">)</span>&nbsp;<span class="op" id="2488663">&lt;-</span>&nbsp;<span class="ident" id="2488666">Now</span><span class="op" id="2488669">(</span><span class="op" id="2488670">)</span><span class="op" id="2488671">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2488674">default</span><span class="op" id="2488681">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2488684">}</span><br>
<span class="lineno"></span><span class="op" id="2488686">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="2488689">//&nbsp;After&nbsp;waits&nbsp;for&nbsp;the&nbsp;duration&nbsp;to&nbsp;elapse&nbsp;and&nbsp;then&nbsp;sends&nbsp;the&nbsp;current&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2488763">//&nbsp;on&nbsp;the&nbsp;returned&nbsp;channel.</span><br>
<span class="lineno"></span><span class="comment" id="2488791">//&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;NewTimer(d).C.</span><br>
<span class="lineno"></span><span class="keyword" id="2488829">func</span>&nbsp;<span class="ident" id="2488834">After</span><span class="op" id="2488839">(</span><span class="ident" id="2488840">d</span>&nbsp;<span class="ident" id="2488842">Duration</span><span class="op" id="2488850">)</span>&nbsp;<span class="op" id="2488852">&lt;-</span><span class="keyword" id="2488854">chan</span>&nbsp;<span class="ident" id="2488859">Time</span>&nbsp;<span class="op" id="2488864">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2488867">return</span>&nbsp;<span class="ident" id="2488874">NewTimer</span><span class="op" id="2488882">(</span><span class="ident" id="2488883">d</span><span class="op" id="2488884">)</span><span class="op" id="2488885">.</span><span class="ident" id="2488886">C</span><br>
<span class="lineno"></span><span class="op" id="2488888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2488891">//&nbsp;AfterFunc&nbsp;waits&nbsp;for&nbsp;the&nbsp;duration&nbsp;to&nbsp;elapse&nbsp;and&nbsp;then&nbsp;calls&nbsp;f</span><br>
<span class="lineno"></span><span class="comment" id="2488954">//&nbsp;in&nbsp;its&nbsp;own&nbsp;goroutine.&nbsp;It&nbsp;returns&nbsp;a&nbsp;Timer&nbsp;that&nbsp;can</span><br>
<span class="lineno">115</span><span class="comment" id="2489007">//&nbsp;be&nbsp;used&nbsp;to&nbsp;cancel&nbsp;the&nbsp;call&nbsp;using&nbsp;its&nbsp;Stop&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="2489060">func</span>&nbsp;<span class="ident" id="2489065">AfterFunc</span><span class="op" id="2489074">(</span><span class="ident" id="2489075">d</span>&nbsp;<span class="ident" id="2489077">Duration</span><span class="op" id="2489085">,</span>&nbsp;<span class="ident" id="2489087">f</span>&nbsp;<span class="keyword" id="2489089">func</span><span class="op" id="2489093">(</span><span class="op" id="2489094">)</span><span class="op" id="2489095">)</span>&nbsp;<span class="op" id="2489097">*</span><span class="ident" id="2489098">Timer</span>&nbsp;<span class="op" id="2489104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2489107">t</span>&nbsp;<span class="op" id="2489109">:=</span>&nbsp;<span class="op" id="2489112">&amp;</span><span class="ident" id="2489113">Timer</span><span class="op" id="2489118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2489122">r</span><span class="op" id="2489123">:</span>&nbsp;<span class="ident" id="2489125">runtimeTimer</span><span class="op" id="2489137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2489142">when</span><span class="op" id="2489146">:</span>&nbsp;<span class="ident" id="2489148">when</span><span class="op" id="2489152">(</span><span class="ident" id="2489153">d</span><span class="op" id="2489154">)</span><span class="op" id="2489155">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2489160">f</span><span class="op" id="2489161">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2489166">goFunc</span><span class="op" id="2489172">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2489177">arg</span><span class="op" id="2489180">:</span>&nbsp;&nbsp;<span class="ident" id="2489183">f</span><span class="op" id="2489184">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2489188">}</span><span class="op" id="2489189">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2489192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2489195">startTimer</span><span class="op" id="2489205">(</span><span class="op" id="2489206">&amp;</span><span class="ident" id="2489207">t</span><span class="op" id="2489208">.</span><span class="ident" id="2489209">r</span><span class="op" id="2489210">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2489213">return</span>&nbsp;<span class="ident" id="2489220">t</span><br>
<span class="lineno"></span><span class="op" id="2489222">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2489225">func</span>&nbsp;<span class="ident" id="2489230">goFunc</span><span class="op" id="2489236">(</span><span class="ident" id="2489237">arg</span>&nbsp;<span class="keyword" id="2489241">interface</span><span class="op" id="2489250">{</span><span class="op" id="2489251">}</span><span class="op" id="2489252">,</span>&nbsp;<span class="ident" id="2489254">seq</span>&nbsp;<span class="builtintype" id="2489258">uintptr</span><span class="op" id="2489265">)</span>&nbsp;<span class="op" id="2489267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2489270">go</span>&nbsp;<span class="ident" id="2489273">arg</span><span class="op" id="2489276">.</span><span class="op" id="2489277">(</span><span class="keyword" id="2489278">func</span><span class="op" id="2489282">(</span><span class="op" id="2489283">)</span><span class="op" id="2489284">)</span><span class="op" id="2489285">(</span><span class="op" id="2489286">)</span><br>
<span class="lineno">130</span><span class="op" id="2489288">}</span>
</div>
</body>
</html>
