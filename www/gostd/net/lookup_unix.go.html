<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html" class="current">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3133731">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3133787">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3133841">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3133892">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3133957">package</span>&nbsp;<span class="ident" id="3133965">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3133970">import</span>&nbsp;<span class="op" id="3133977">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3133980">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3133990">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="3133997">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3134000">var</span>&nbsp;<span class="ident" id="3134004">onceReadProtocols</span>&nbsp;<span class="ident" id="3134022">sync</span><span class="op" id="3134026">.</span><span class="ident" id="3134027">Once</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="3134033">//&nbsp;readProtocols&nbsp;loads&nbsp;contents&nbsp;of&nbsp;/etc/protocols&nbsp;into&nbsp;protocols&nbsp;map</span><br>
<span class="lineno"></span><span class="comment" id="3134102">//&nbsp;for&nbsp;quick&nbsp;access.</span><br>
<span class="lineno"></span><span class="keyword" id="3134123">func</span>&nbsp;<span class="ident" id="3134128">readProtocols</span><span class="op" id="3134141">(</span><span class="op" id="3134142">)</span>&nbsp;<span class="op" id="3134144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3134147">if</span>&nbsp;<span class="ident" id="3134150">file</span><span class="op" id="3134154">,</span>&nbsp;<span class="ident" id="3134156">err</span>&nbsp;<span class="op" id="3134160">:=</span>&nbsp;<span class="ident" id="3134163">open</span><span class="op" id="3134167">(</span><span class="string" id="3134168">&#34;/etc/protocols&#34;</span><span class="op" id="3134184">)</span><span class="op" id="3134185">;</span>&nbsp;<span class="ident" id="3134187">err</span>&nbsp;<span class="op" id="3134191">==</span>&nbsp;<span class="ident" id="3134194">nil</span>&nbsp;<span class="op" id="3134198">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3134202">for</span>&nbsp;<span class="ident" id="3134206">line</span><span class="op" id="3134210">,</span>&nbsp;<span class="ident" id="3134212">ok</span>&nbsp;<span class="op" id="3134215">:=</span>&nbsp;<span class="ident" id="3134218">file</span><span class="op" id="3134222">.</span><span class="ident" id="3134223">readLine</span><span class="op" id="3134231">(</span><span class="op" id="3134232">)</span><span class="op" id="3134233">;</span>&nbsp;<span class="ident" id="3134235">ok</span><span class="op" id="3134237">;</span>&nbsp;<span class="ident" id="3134239">line</span><span class="op" id="3134243">,</span>&nbsp;<span class="ident" id="3134245">ok</span>&nbsp;<span class="op" id="3134248">=</span>&nbsp;<span class="ident" id="3134250">file</span><span class="op" id="3134254">.</span><span class="ident" id="3134255">readLine</span><span class="op" id="3134263">(</span><span class="op" id="3134264">)</span>&nbsp;<span class="op" id="3134266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3134271">//&nbsp;tcp&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;TCP&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;transmission&nbsp;control&nbsp;protocol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3134327">if</span>&nbsp;<span class="ident" id="3134330">i</span>&nbsp;<span class="op" id="3134332">:=</span>&nbsp;<span class="ident" id="3134335">byteIndex</span><span class="op" id="3134344">(</span><span class="ident" id="3134345">line</span><span class="op" id="3134349">,</span>&nbsp;<span class="string" id="3134351">&#39;#&#39;</span><span class="op" id="3134354">)</span><span class="op" id="3134355">;</span>&nbsp;<span class="ident" id="3134357">i</span>&nbsp;<span class="op" id="3134359">&gt;=</span>&nbsp;<span class="num" id="3134362">0</span>&nbsp;<span class="op" id="3134364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3134370">line</span>&nbsp;<span class="op" id="3134375">=</span>&nbsp;<span class="ident" id="3134377">line</span><span class="op" id="3134381">[</span><span class="num" id="3134382">0</span><span class="op" id="3134383">:</span><span class="ident" id="3134384">i</span><span class="op" id="3134385">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3134390">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3134395">f</span>&nbsp;<span class="op" id="3134397">:=</span>&nbsp;<span class="ident" id="3134400">getFields</span><span class="op" id="3134409">(</span><span class="ident" id="3134410">line</span><span class="op" id="3134414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3134419">if</span>&nbsp;<span class="builtinfunc" id="3134422">len</span><span class="op" id="3134425">(</span><span class="ident" id="3134426">f</span><span class="op" id="3134427">)</span>&nbsp;<span class="op" id="3134429">&lt;</span>&nbsp;<span class="num" id="3134431">2</span>&nbsp;<span class="op" id="3134433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3134439">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3134451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3134456">if</span>&nbsp;<span class="ident" id="3134459">proto</span><span class="op" id="3134464">,</span>&nbsp;<span class="ident" id="3134466">_</span><span class="op" id="3134467">,</span>&nbsp;<span class="ident" id="3134469">ok</span>&nbsp;<span class="op" id="3134472">:=</span>&nbsp;<span class="ident" id="3134475">dtoi</span><span class="op" id="3134479">(</span><span class="ident" id="3134480">f</span><span class="op" id="3134481">[</span><span class="num" id="3134482">1</span><span class="op" id="3134483">]</span><span class="op" id="3134484">,</span>&nbsp;<span class="num" id="3134486">0</span><span class="op" id="3134487">)</span><span class="op" id="3134488">;</span>&nbsp;<span class="ident" id="3134490">ok</span>&nbsp;<span class="op" id="3134493">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3134499">if</span>&nbsp;<span class="ident" id="3134502">_</span><span class="op" id="3134503">,</span>&nbsp;<span class="ident" id="3134505">ok</span>&nbsp;<span class="op" id="3134508">:=</span>&nbsp;<span class="ident" id="3134511">protocols</span><span class="op" id="3134520">[</span><span class="ident" id="3134521">f</span><span class="op" id="3134522">[</span><span class="num" id="3134523">0</span><span class="op" id="3134524">]</span><span class="op" id="3134525">]</span><span class="op" id="3134526">;</span>&nbsp;<span class="op" id="3134528">!</span><span class="ident" id="3134529">ok</span>&nbsp;<span class="op" id="3134532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3134539">protocols</span><span class="op" id="3134548">[</span><span class="ident" id="3134549">f</span><span class="op" id="3134550">[</span><span class="num" id="3134551">0</span><span class="op" id="3134552">]</span><span class="op" id="3134553">]</span>&nbsp;<span class="op" id="3134555">=</span>&nbsp;<span class="ident" id="3134557">proto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3134567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3134573">for</span>&nbsp;<span class="ident" id="3134577">_</span><span class="op" id="3134578">,</span>&nbsp;<span class="ident" id="3134580">alias</span>&nbsp;<span class="op" id="3134586">:=</span>&nbsp;<span class="keyword" id="3134589">range</span>&nbsp;<span class="ident" id="3134595">f</span><span class="op" id="3134596">[</span><span class="num" id="3134597">2</span><span class="op" id="3134598">:</span><span class="op" id="3134599">]</span>&nbsp;<span class="op" id="3134601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3134608">if</span>&nbsp;<span class="ident" id="3134611">_</span><span class="op" id="3134612">,</span>&nbsp;<span class="ident" id="3134614">ok</span>&nbsp;<span class="op" id="3134617">:=</span>&nbsp;<span class="ident" id="3134620">protocols</span><span class="op" id="3134629">[</span><span class="ident" id="3134630">alias</span><span class="op" id="3134635">]</span><span class="op" id="3134636">;</span>&nbsp;<span class="op" id="3134638">!</span><span class="ident" id="3134639">ok</span>&nbsp;<span class="op" id="3134642">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3134650">protocols</span><span class="op" id="3134659">[</span><span class="ident" id="3134660">alias</span><span class="op" id="3134665">]</span>&nbsp;<span class="op" id="3134667">=</span>&nbsp;<span class="ident" id="3134669">proto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3134680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3134686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3134691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3134695">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3134699">file</span><span class="op" id="3134703">.</span><span class="builtinfunc" id="3134704">close</span><span class="op" id="3134709">(</span><span class="op" id="3134710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3134713">}</span><br>
<span class="lineno"></span><span class="op" id="3134715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3134718">//&nbsp;lookupProtocol&nbsp;looks&nbsp;up&nbsp;IP&nbsp;protocol&nbsp;name&nbsp;in&nbsp;/etc/protocols&nbsp;and</span><br>
<span class="lineno">45</span><span class="comment" id="3134784">//&nbsp;returns&nbsp;correspondent&nbsp;protocol&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="3134826">func</span>&nbsp;<span class="ident" id="3134831">lookupProtocol</span><span class="op" id="3134845">(</span><span class="ident" id="3134846">name</span>&nbsp;<span class="builtintype" id="3134851">string</span><span class="op" id="3134857">)</span>&nbsp;<span class="op" id="3134859">(</span><span class="ident" id="3134860">proto</span>&nbsp;<span class="builtintype" id="3134866">int</span><span class="op" id="3134869">,</span>&nbsp;<span class="ident" id="3134871">err</span>&nbsp;<span class="builtintype" id="3134875">error</span><span class="op" id="3134880">)</span>&nbsp;<span class="op" id="3134882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3134885">onceReadProtocols</span><span class="op" id="3134902">.</span><span class="ident" id="3134903">Do</span><span class="op" id="3134905">(</span><span class="ident" id="3134906">readProtocols</span><span class="op" id="3134919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3134922">proto</span><span class="op" id="3134927">,</span>&nbsp;<span class="ident" id="3134929">found</span>&nbsp;<span class="op" id="3134935">:=</span>&nbsp;<span class="ident" id="3134938">protocols</span><span class="op" id="3134947">[</span><span class="ident" id="3134948">name</span><span class="op" id="3134952">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3134955">if</span>&nbsp;<span class="op" id="3134958">!</span><span class="ident" id="3134959">found</span>&nbsp;<span class="op" id="3134965">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3134969">return</span>&nbsp;<span class="num" id="3134976">0</span><span class="op" id="3134977">,</span>&nbsp;<span class="ident" id="3134979">errors</span><span class="op" id="3134985">.</span><span class="ident" id="3134986">New</span><span class="op" id="3134989">(</span><span class="string" id="3134990">&#34;unknown&nbsp;IP&nbsp;protocol&nbsp;specified:&nbsp;&#34;</span>&nbsp;<span class="op" id="3135024">+</span>&nbsp;<span class="ident" id="3135026">name</span><span class="op" id="3135030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3135033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3135036">return</span><br>
<span class="lineno"></span><span class="op" id="3135043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="3135046">func</span>&nbsp;<span class="ident" id="3135051">lookupHost</span><span class="op" id="3135061">(</span><span class="ident" id="3135062">host</span>&nbsp;<span class="builtintype" id="3135067">string</span><span class="op" id="3135073">)</span>&nbsp;<span class="op" id="3135075">(</span><span class="ident" id="3135076">addrs</span>&nbsp;<span class="op" id="3135082">[</span><span class="op" id="3135083">]</span><span class="builtintype" id="3135084">string</span><span class="op" id="3135090">,</span>&nbsp;<span class="ident" id="3135092">err</span>&nbsp;<span class="builtintype" id="3135096">error</span><span class="op" id="3135101">)</span>&nbsp;<span class="op" id="3135103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3135106">addrs</span><span class="op" id="3135111">,</span>&nbsp;<span class="ident" id="3135113">err</span><span class="op" id="3135116">,</span>&nbsp;<span class="ident" id="3135118">ok</span>&nbsp;<span class="op" id="3135121">:=</span>&nbsp;<span class="ident" id="3135124">cgoLookupHost</span><span class="op" id="3135137">(</span><span class="ident" id="3135138">host</span><span class="op" id="3135142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3135145">if</span>&nbsp;<span class="op" id="3135148">!</span><span class="ident" id="3135149">ok</span>&nbsp;<span class="op" id="3135152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3135156">addrs</span><span class="op" id="3135161">,</span>&nbsp;<span class="ident" id="3135163">err</span>&nbsp;<span class="op" id="3135167">=</span>&nbsp;<span class="ident" id="3135169">goLookupHost</span><span class="op" id="3135181">(</span><span class="ident" id="3135182">host</span><span class="op" id="3135186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3135189">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3135192">return</span><br>
<span class="lineno"></span><span class="op" id="3135199">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3135202">func</span>&nbsp;<span class="ident" id="3135207">lookupIP</span><span class="op" id="3135215">(</span><span class="ident" id="3135216">host</span>&nbsp;<span class="builtintype" id="3135221">string</span><span class="op" id="3135227">)</span>&nbsp;<span class="op" id="3135229">(</span><span class="ident" id="3135230">addrs</span>&nbsp;<span class="op" id="3135236">[</span><span class="op" id="3135237">]</span><span class="ident" id="3135238">IP</span><span class="op" id="3135240">,</span>&nbsp;<span class="ident" id="3135242">err</span>&nbsp;<span class="builtintype" id="3135246">error</span><span class="op" id="3135251">)</span>&nbsp;<span class="op" id="3135253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3135256">addrs</span><span class="op" id="3135261">,</span>&nbsp;<span class="ident" id="3135263">err</span><span class="op" id="3135266">,</span>&nbsp;<span class="ident" id="3135268">ok</span>&nbsp;<span class="op" id="3135271">:=</span>&nbsp;<span class="ident" id="3135274">cgoLookupIP</span><span class="op" id="3135285">(</span><span class="ident" id="3135286">host</span><span class="op" id="3135290">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3135293">if</span>&nbsp;<span class="op" id="3135296">!</span><span class="ident" id="3135297">ok</span>&nbsp;<span class="op" id="3135300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3135304">addrs</span><span class="op" id="3135309">,</span>&nbsp;<span class="ident" id="3135311">err</span>&nbsp;<span class="op" id="3135315">=</span>&nbsp;<span class="ident" id="3135317">goLookupIP</span><span class="op" id="3135327">(</span><span class="ident" id="3135328">host</span><span class="op" id="3135332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3135335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3135338">return</span><br>
<span class="lineno"></span><span class="op" id="3135345">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="3135348">func</span>&nbsp;<span class="ident" id="3135353">lookupPort</span><span class="op" id="3135363">(</span><span class="ident" id="3135364">network</span><span class="op" id="3135371">,</span>&nbsp;<span class="ident" id="3135373">service</span>&nbsp;<span class="builtintype" id="3135381">string</span><span class="op" id="3135387">)</span>&nbsp;<span class="op" id="3135389">(</span><span class="ident" id="3135390">port</span>&nbsp;<span class="builtintype" id="3135395">int</span><span class="op" id="3135398">,</span>&nbsp;<span class="ident" id="3135400">err</span>&nbsp;<span class="builtintype" id="3135404">error</span><span class="op" id="3135409">)</span>&nbsp;<span class="op" id="3135411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3135414">port</span><span class="op" id="3135418">,</span>&nbsp;<span class="ident" id="3135420">err</span><span class="op" id="3135423">,</span>&nbsp;<span class="ident" id="3135425">ok</span>&nbsp;<span class="op" id="3135428">:=</span>&nbsp;<span class="ident" id="3135431">cgoLookupPort</span><span class="op" id="3135444">(</span><span class="ident" id="3135445">network</span><span class="op" id="3135452">,</span>&nbsp;<span class="ident" id="3135454">service</span><span class="op" id="3135461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3135464">if</span>&nbsp;<span class="op" id="3135467">!</span><span class="ident" id="3135468">ok</span>&nbsp;<span class="op" id="3135471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3135475">port</span><span class="op" id="3135479">,</span>&nbsp;<span class="ident" id="3135481">err</span>&nbsp;<span class="op" id="3135485">=</span>&nbsp;<span class="ident" id="3135487">goLookupPort</span><span class="op" id="3135499">(</span><span class="ident" id="3135500">network</span><span class="op" id="3135507">,</span>&nbsp;<span class="ident" id="3135509">service</span><span class="op" id="3135516">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3135519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3135522">return</span><br>
<span class="lineno"></span><span class="op" id="3135529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3135532">func</span>&nbsp;<span class="ident" id="3135537">lookupCNAME</span><span class="op" id="3135548">(</span><span class="ident" id="3135549">name</span>&nbsp;<span class="builtintype" id="3135554">string</span><span class="op" id="3135560">)</span>&nbsp;<span class="op" id="3135562">(</span><span class="ident" id="3135563">cname</span>&nbsp;<span class="builtintype" id="3135569">string</span><span class="op" id="3135575">,</span>&nbsp;<span class="ident" id="3135577">err</span>&nbsp;<span class="builtintype" id="3135581">error</span><span class="op" id="3135586">)</span>&nbsp;<span class="op" id="3135588">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3135591">cname</span><span class="op" id="3135596">,</span>&nbsp;<span class="ident" id="3135598">err</span><span class="op" id="3135601">,</span>&nbsp;<span class="ident" id="3135603">ok</span>&nbsp;<span class="op" id="3135606">:=</span>&nbsp;<span class="ident" id="3135609">cgoLookupCNAME</span><span class="op" id="3135623">(</span><span class="ident" id="3135624">name</span><span class="op" id="3135628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3135631">if</span>&nbsp;<span class="op" id="3135634">!</span><span class="ident" id="3135635">ok</span>&nbsp;<span class="op" id="3135638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3135642">cname</span><span class="op" id="3135647">,</span>&nbsp;<span class="ident" id="3135649">err</span>&nbsp;<span class="op" id="3135653">=</span>&nbsp;<span class="ident" id="3135655">goLookupCNAME</span><span class="op" id="3135668">(</span><span class="ident" id="3135669">name</span><span class="op" id="3135673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3135676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3135679">return</span><br>
<span class="lineno">85</span><span class="op" id="3135686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3135689">func</span>&nbsp;<span class="ident" id="3135694">lookupSRV</span><span class="op" id="3135703">(</span><span class="ident" id="3135704">service</span><span class="op" id="3135711">,</span>&nbsp;<span class="ident" id="3135713">proto</span><span class="op" id="3135718">,</span>&nbsp;<span class="ident" id="3135720">name</span>&nbsp;<span class="builtintype" id="3135725">string</span><span class="op" id="3135731">)</span>&nbsp;<span class="op" id="3135733">(</span><span class="ident" id="3135734">cname</span>&nbsp;<span class="builtintype" id="3135740">string</span><span class="op" id="3135746">,</span>&nbsp;<span class="ident" id="3135748">addrs</span>&nbsp;<span class="op" id="3135754">[</span><span class="op" id="3135755">]</span><span class="op" id="3135756">*</span><span class="ident" id="3135757">SRV</span><span class="op" id="3135760">,</span>&nbsp;<span class="ident" id="3135762">err</span>&nbsp;<span class="builtintype" id="3135766">error</span><span class="op" id="3135771">)</span>&nbsp;<span class="op" id="3135773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3135776">var</span>&nbsp;<span class="ident" id="3135780">target</span>&nbsp;<span class="builtintype" id="3135787">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3135795">if</span>&nbsp;<span class="ident" id="3135798">service</span>&nbsp;<span class="op" id="3135806">==</span>&nbsp;<span class="string" id="3135809">&#34;&#34;</span>&nbsp;<span class="op" id="3135812">&amp;&amp;</span>&nbsp;<span class="ident" id="3135815">proto</span>&nbsp;<span class="op" id="3135821">==</span>&nbsp;<span class="string" id="3135824">&#34;&#34;</span>&nbsp;<span class="op" id="3135827">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3135831">target</span>&nbsp;<span class="op" id="3135838">=</span>&nbsp;<span class="ident" id="3135840">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3135846">}</span>&nbsp;<span class="keyword" id="3135848">else</span>&nbsp;<span class="op" id="3135853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3135857">target</span>&nbsp;<span class="op" id="3135864">=</span>&nbsp;<span class="string" id="3135866">&#34;_&#34;</span>&nbsp;<span class="op" id="3135870">+</span>&nbsp;<span class="ident" id="3135872">service</span>&nbsp;<span class="op" id="3135880">+</span>&nbsp;<span class="string" id="3135882">&#34;._&#34;</span>&nbsp;<span class="op" id="3135887">+</span>&nbsp;<span class="ident" id="3135889">proto</span>&nbsp;<span class="op" id="3135895">+</span>&nbsp;<span class="string" id="3135897">&#34;.&#34;</span>&nbsp;<span class="op" id="3135901">+</span>&nbsp;<span class="ident" id="3135903">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3135909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3135912">var</span>&nbsp;<span class="ident" id="3135916">records</span>&nbsp;<span class="op" id="3135924">[</span><span class="op" id="3135925">]</span><span class="ident" id="3135926">dnsRR</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3135933">cname</span><span class="op" id="3135938">,</span>&nbsp;<span class="ident" id="3135940">records</span><span class="op" id="3135947">,</span>&nbsp;<span class="ident" id="3135949">err</span>&nbsp;<span class="op" id="3135953">=</span>&nbsp;<span class="ident" id="3135955">lookup</span><span class="op" id="3135961">(</span><span class="ident" id="3135962">target</span><span class="op" id="3135968">,</span>&nbsp;<span class="ident" id="3135970">dnsTypeSRV</span><span class="op" id="3135980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3135983">if</span>&nbsp;<span class="ident" id="3135986">err</span>&nbsp;<span class="op" id="3135990">!=</span>&nbsp;<span class="ident" id="3135993">nil</span>&nbsp;<span class="op" id="3135997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3136001">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3136009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3136012">addrs</span>&nbsp;<span class="op" id="3136018">=</span>&nbsp;<span class="builtinfunc" id="3136020">make</span><span class="op" id="3136024">(</span><span class="op" id="3136025">[</span><span class="op" id="3136026">]</span><span class="op" id="3136027">*</span><span class="ident" id="3136028">SRV</span><span class="op" id="3136031">,</span>&nbsp;<span class="builtinfunc" id="3136033">len</span><span class="op" id="3136036">(</span><span class="ident" id="3136037">records</span><span class="op" id="3136044">)</span><span class="op" id="3136045">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3136048">for</span>&nbsp;<span class="ident" id="3136052">i</span><span class="op" id="3136053">,</span>&nbsp;<span class="ident" id="3136055">rr</span>&nbsp;<span class="op" id="3136058">:=</span>&nbsp;<span class="keyword" id="3136061">range</span>&nbsp;<span class="ident" id="3136067">records</span>&nbsp;<span class="op" id="3136075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3136079">r</span>&nbsp;<span class="op" id="3136081">:=</span>&nbsp;<span class="ident" id="3136084">rr</span><span class="op" id="3136086">.</span><span class="op" id="3136087">(</span><span class="op" id="3136088">*</span><span class="ident" id="3136089">dnsRR_SRV</span><span class="op" id="3136098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3136102">addrs</span><span class="op" id="3136107">[</span><span class="ident" id="3136108">i</span><span class="op" id="3136109">]</span>&nbsp;<span class="op" id="3136111">=</span>&nbsp;<span class="op" id="3136113">&amp;</span><span class="ident" id="3136114">SRV</span><span class="op" id="3136117">{</span><span class="ident" id="3136118">r</span><span class="op" id="3136119">.</span><span class="ident" id="3136120">Target</span><span class="op" id="3136126">,</span>&nbsp;<span class="ident" id="3136128">r</span><span class="op" id="3136129">.</span><span class="ident" id="3136130">Port</span><span class="op" id="3136134">,</span>&nbsp;<span class="ident" id="3136136">r</span><span class="op" id="3136137">.</span><span class="ident" id="3136138">Priority</span><span class="op" id="3136146">,</span>&nbsp;<span class="ident" id="3136148">r</span><span class="op" id="3136149">.</span><span class="ident" id="3136150">Weight</span><span class="op" id="3136156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3136159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3136162">byPriorityWeight</span><span class="op" id="3136178">(</span><span class="ident" id="3136179">addrs</span><span class="op" id="3136184">)</span><span class="op" id="3136185">.</span><span class="ident" id="3136186">sort</span><span class="op" id="3136190">(</span><span class="op" id="3136191">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3136194">return</span><br>
<span class="lineno"></span><span class="op" id="3136201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3136204">func</span>&nbsp;<span class="ident" id="3136209">lookupMX</span><span class="op" id="3136217">(</span><span class="ident" id="3136218">name</span>&nbsp;<span class="builtintype" id="3136223">string</span><span class="op" id="3136229">)</span>&nbsp;<span class="op" id="3136231">(</span><span class="ident" id="3136232">mx</span>&nbsp;<span class="op" id="3136235">[</span><span class="op" id="3136236">]</span><span class="op" id="3136237">*</span><span class="ident" id="3136238">MX</span><span class="op" id="3136240">,</span>&nbsp;<span class="ident" id="3136242">err</span>&nbsp;<span class="builtintype" id="3136246">error</span><span class="op" id="3136251">)</span>&nbsp;<span class="op" id="3136253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3136256">_</span><span class="op" id="3136257">,</span>&nbsp;<span class="ident" id="3136259">records</span><span class="op" id="3136266">,</span>&nbsp;<span class="ident" id="3136268">err</span>&nbsp;<span class="op" id="3136272">:=</span>&nbsp;<span class="ident" id="3136275">lookup</span><span class="op" id="3136281">(</span><span class="ident" id="3136282">name</span><span class="op" id="3136286">,</span>&nbsp;<span class="ident" id="3136288">dnsTypeMX</span><span class="op" id="3136297">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3136300">if</span>&nbsp;<span class="ident" id="3136303">err</span>&nbsp;<span class="op" id="3136307">!=</span>&nbsp;<span class="ident" id="3136310">nil</span>&nbsp;<span class="op" id="3136314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3136318">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3136326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3136329">mx</span>&nbsp;<span class="op" id="3136332">=</span>&nbsp;<span class="builtinfunc" id="3136334">make</span><span class="op" id="3136338">(</span><span class="op" id="3136339">[</span><span class="op" id="3136340">]</span><span class="op" id="3136341">*</span><span class="ident" id="3136342">MX</span><span class="op" id="3136344">,</span>&nbsp;<span class="builtinfunc" id="3136346">len</span><span class="op" id="3136349">(</span><span class="ident" id="3136350">records</span><span class="op" id="3136357">)</span><span class="op" id="3136358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3136361">for</span>&nbsp;<span class="ident" id="3136365">i</span><span class="op" id="3136366">,</span>&nbsp;<span class="ident" id="3136368">rr</span>&nbsp;<span class="op" id="3136371">:=</span>&nbsp;<span class="keyword" id="3136374">range</span>&nbsp;<span class="ident" id="3136380">records</span>&nbsp;<span class="op" id="3136388">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3136392">r</span>&nbsp;<span class="op" id="3136394">:=</span>&nbsp;<span class="ident" id="3136397">rr</span><span class="op" id="3136399">.</span><span class="op" id="3136400">(</span><span class="op" id="3136401">*</span><span class="ident" id="3136402">dnsRR_MX</span><span class="op" id="3136410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3136414">mx</span><span class="op" id="3136416">[</span><span class="ident" id="3136417">i</span><span class="op" id="3136418">]</span>&nbsp;<span class="op" id="3136420">=</span>&nbsp;<span class="op" id="3136422">&amp;</span><span class="ident" id="3136423">MX</span><span class="op" id="3136425">{</span><span class="ident" id="3136426">r</span><span class="op" id="3136427">.</span><span class="ident" id="3136428">Mx</span><span class="op" id="3136430">,</span>&nbsp;<span class="ident" id="3136432">r</span><span class="op" id="3136433">.</span><span class="ident" id="3136434">Pref</span><span class="op" id="3136438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3136441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3136444">byPref</span><span class="op" id="3136450">(</span><span class="ident" id="3136451">mx</span><span class="op" id="3136453">)</span><span class="op" id="3136454">.</span><span class="ident" id="3136455">sort</span><span class="op" id="3136459">(</span><span class="op" id="3136460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3136463">return</span><br>
<span class="lineno">120</span><span class="op" id="3136470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3136473">func</span>&nbsp;<span class="ident" id="3136478">lookupNS</span><span class="op" id="3136486">(</span><span class="ident" id="3136487">name</span>&nbsp;<span class="builtintype" id="3136492">string</span><span class="op" id="3136498">)</span>&nbsp;<span class="op" id="3136500">(</span><span class="ident" id="3136501">ns</span>&nbsp;<span class="op" id="3136504">[</span><span class="op" id="3136505">]</span><span class="op" id="3136506">*</span><span class="ident" id="3136507">NS</span><span class="op" id="3136509">,</span>&nbsp;<span class="ident" id="3136511">err</span>&nbsp;<span class="builtintype" id="3136515">error</span><span class="op" id="3136520">)</span>&nbsp;<span class="op" id="3136522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3136525">_</span><span class="op" id="3136526">,</span>&nbsp;<span class="ident" id="3136528">records</span><span class="op" id="3136535">,</span>&nbsp;<span class="ident" id="3136537">err</span>&nbsp;<span class="op" id="3136541">:=</span>&nbsp;<span class="ident" id="3136544">lookup</span><span class="op" id="3136550">(</span><span class="ident" id="3136551">name</span><span class="op" id="3136555">,</span>&nbsp;<span class="ident" id="3136557">dnsTypeNS</span><span class="op" id="3136566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3136569">if</span>&nbsp;<span class="ident" id="3136572">err</span>&nbsp;<span class="op" id="3136576">!=</span>&nbsp;<span class="ident" id="3136579">nil</span>&nbsp;<span class="op" id="3136583">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3136587">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3136595">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3136598">ns</span>&nbsp;<span class="op" id="3136601">=</span>&nbsp;<span class="builtinfunc" id="3136603">make</span><span class="op" id="3136607">(</span><span class="op" id="3136608">[</span><span class="op" id="3136609">]</span><span class="op" id="3136610">*</span><span class="ident" id="3136611">NS</span><span class="op" id="3136613">,</span>&nbsp;<span class="builtinfunc" id="3136615">len</span><span class="op" id="3136618">(</span><span class="ident" id="3136619">records</span><span class="op" id="3136626">)</span><span class="op" id="3136627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3136630">for</span>&nbsp;<span class="ident" id="3136634">i</span><span class="op" id="3136635">,</span>&nbsp;<span class="ident" id="3136637">r</span>&nbsp;<span class="op" id="3136639">:=</span>&nbsp;<span class="keyword" id="3136642">range</span>&nbsp;<span class="ident" id="3136648">records</span>&nbsp;<span class="op" id="3136656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3136660">r</span>&nbsp;<span class="op" id="3136662">:=</span>&nbsp;<span class="ident" id="3136665">r</span><span class="op" id="3136666">.</span><span class="op" id="3136667">(</span><span class="op" id="3136668">*</span><span class="ident" id="3136669">dnsRR_NS</span><span class="op" id="3136677">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3136681">ns</span><span class="op" id="3136683">[</span><span class="ident" id="3136684">i</span><span class="op" id="3136685">]</span>&nbsp;<span class="op" id="3136687">=</span>&nbsp;<span class="op" id="3136689">&amp;</span><span class="ident" id="3136690">NS</span><span class="op" id="3136692">{</span><span class="ident" id="3136693">r</span><span class="op" id="3136694">.</span><span class="ident" id="3136695">Ns</span><span class="op" id="3136697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3136700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3136703">return</span><br>
<span class="lineno"></span><span class="op" id="3136710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="3136713">func</span>&nbsp;<span class="ident" id="3136718">lookupTXT</span><span class="op" id="3136727">(</span><span class="ident" id="3136728">name</span>&nbsp;<span class="builtintype" id="3136733">string</span><span class="op" id="3136739">)</span>&nbsp;<span class="op" id="3136741">(</span><span class="ident" id="3136742">txt</span>&nbsp;<span class="op" id="3136746">[</span><span class="op" id="3136747">]</span><span class="builtintype" id="3136748">string</span><span class="op" id="3136754">,</span>&nbsp;<span class="ident" id="3136756">err</span>&nbsp;<span class="builtintype" id="3136760">error</span><span class="op" id="3136765">)</span>&nbsp;<span class="op" id="3136767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3136770">_</span><span class="op" id="3136771">,</span>&nbsp;<span class="ident" id="3136773">records</span><span class="op" id="3136780">,</span>&nbsp;<span class="ident" id="3136782">err</span>&nbsp;<span class="op" id="3136786">:=</span>&nbsp;<span class="ident" id="3136789">lookup</span><span class="op" id="3136795">(</span><span class="ident" id="3136796">name</span><span class="op" id="3136800">,</span>&nbsp;<span class="ident" id="3136802">dnsTypeTXT</span><span class="op" id="3136812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3136815">if</span>&nbsp;<span class="ident" id="3136818">err</span>&nbsp;<span class="op" id="3136822">!=</span>&nbsp;<span class="ident" id="3136825">nil</span>&nbsp;<span class="op" id="3136829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3136833">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3136841">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3136844">txt</span>&nbsp;<span class="op" id="3136848">=</span>&nbsp;<span class="builtinfunc" id="3136850">make</span><span class="op" id="3136854">(</span><span class="op" id="3136855">[</span><span class="op" id="3136856">]</span><span class="builtintype" id="3136857">string</span><span class="op" id="3136863">,</span>&nbsp;<span class="builtinfunc" id="3136865">len</span><span class="op" id="3136868">(</span><span class="ident" id="3136869">records</span><span class="op" id="3136876">)</span><span class="op" id="3136877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3136880">for</span>&nbsp;<span class="ident" id="3136884">i</span><span class="op" id="3136885">,</span>&nbsp;<span class="ident" id="3136887">r</span>&nbsp;<span class="op" id="3136889">:=</span>&nbsp;<span class="keyword" id="3136892">range</span>&nbsp;<span class="ident" id="3136898">records</span>&nbsp;<span class="op" id="3136906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3136910">txt</span><span class="op" id="3136913">[</span><span class="ident" id="3136914">i</span><span class="op" id="3136915">]</span>&nbsp;<span class="op" id="3136917">=</span>&nbsp;<span class="ident" id="3136919">r</span><span class="op" id="3136920">.</span><span class="op" id="3136921">(</span><span class="op" id="3136922">*</span><span class="ident" id="3136923">dnsRR_TXT</span><span class="op" id="3136932">)</span><span class="op" id="3136933">.</span><span class="ident" id="3136934">Txt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3136939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3136942">return</span><br>
<span class="lineno">145</span><span class="op" id="3136949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3136952">func</span>&nbsp;<span class="ident" id="3136957">lookupAddr</span><span class="op" id="3136967">(</span><span class="ident" id="3136968">addr</span>&nbsp;<span class="builtintype" id="3136973">string</span><span class="op" id="3136979">)</span>&nbsp;<span class="op" id="3136981">(</span><span class="ident" id="3136982">name</span>&nbsp;<span class="op" id="3136987">[</span><span class="op" id="3136988">]</span><span class="builtintype" id="3136989">string</span><span class="op" id="3136995">,</span>&nbsp;<span class="ident" id="3136997">err</span>&nbsp;<span class="builtintype" id="3137001">error</span><span class="op" id="3137006">)</span>&nbsp;<span class="op" id="3137008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3137011">name</span>&nbsp;<span class="op" id="3137016">=</span>&nbsp;<span class="ident" id="3137018">lookupStaticAddr</span><span class="op" id="3137034">(</span><span class="ident" id="3137035">addr</span><span class="op" id="3137039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3137042">if</span>&nbsp;<span class="builtinfunc" id="3137045">len</span><span class="op" id="3137048">(</span><span class="ident" id="3137049">name</span><span class="op" id="3137053">)</span>&nbsp;<span class="op" id="3137055">&gt;</span>&nbsp;<span class="num" id="3137057">0</span>&nbsp;<span class="op" id="3137059">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3137063">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3137071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3137074">var</span>&nbsp;<span class="ident" id="3137078">arpa</span>&nbsp;<span class="builtintype" id="3137083">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3137091">arpa</span><span class="op" id="3137095">,</span>&nbsp;<span class="ident" id="3137097">err</span>&nbsp;<span class="op" id="3137101">=</span>&nbsp;<span class="ident" id="3137103">reverseaddr</span><span class="op" id="3137114">(</span><span class="ident" id="3137115">addr</span><span class="op" id="3137119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3137122">if</span>&nbsp;<span class="ident" id="3137125">err</span>&nbsp;<span class="op" id="3137129">!=</span>&nbsp;<span class="ident" id="3137132">nil</span>&nbsp;<span class="op" id="3137136">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3137140">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3137148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3137151">var</span>&nbsp;<span class="ident" id="3137155">records</span>&nbsp;<span class="op" id="3137163">[</span><span class="op" id="3137164">]</span><span class="ident" id="3137165">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3137172">_</span><span class="op" id="3137173">,</span>&nbsp;<span class="ident" id="3137175">records</span><span class="op" id="3137182">,</span>&nbsp;<span class="ident" id="3137184">err</span>&nbsp;<span class="op" id="3137188">=</span>&nbsp;<span class="ident" id="3137190">lookup</span><span class="op" id="3137196">(</span><span class="ident" id="3137197">arpa</span><span class="op" id="3137201">,</span>&nbsp;<span class="ident" id="3137203">dnsTypePTR</span><span class="op" id="3137213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3137216">if</span>&nbsp;<span class="ident" id="3137219">err</span>&nbsp;<span class="op" id="3137223">!=</span>&nbsp;<span class="ident" id="3137226">nil</span>&nbsp;<span class="op" id="3137230">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3137234">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3137242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3137245">name</span>&nbsp;<span class="op" id="3137250">=</span>&nbsp;<span class="builtinfunc" id="3137252">make</span><span class="op" id="3137256">(</span><span class="op" id="3137257">[</span><span class="op" id="3137258">]</span><span class="builtintype" id="3137259">string</span><span class="op" id="3137265">,</span>&nbsp;<span class="builtinfunc" id="3137267">len</span><span class="op" id="3137270">(</span><span class="ident" id="3137271">records</span><span class="op" id="3137278">)</span><span class="op" id="3137279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3137282">for</span>&nbsp;<span class="ident" id="3137286">i</span>&nbsp;<span class="op" id="3137288">:=</span>&nbsp;<span class="keyword" id="3137291">range</span>&nbsp;<span class="ident" id="3137297">records</span>&nbsp;<span class="op" id="3137305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3137309">r</span>&nbsp;<span class="op" id="3137311">:=</span>&nbsp;<span class="ident" id="3137314">records</span><span class="op" id="3137321">[</span><span class="ident" id="3137322">i</span><span class="op" id="3137323">]</span><span class="op" id="3137324">.</span><span class="op" id="3137325">(</span><span class="op" id="3137326">*</span><span class="ident" id="3137327">dnsRR_PTR</span><span class="op" id="3137336">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3137340">name</span><span class="op" id="3137344">[</span><span class="ident" id="3137345">i</span><span class="op" id="3137346">]</span>&nbsp;<span class="op" id="3137348">=</span>&nbsp;<span class="ident" id="3137350">r</span><span class="op" id="3137351">.</span><span class="ident" id="3137352">Ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3137357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3137360">return</span><br>
<span class="lineno"></span><span class="op" id="3137367">}</span>
</div>
</body>
</html>
