<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1750326">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1750381">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1750435">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1750486">package</span>&nbsp;<span class="ident" id="1750494">runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1750503">import</span>&nbsp;<span class="string" id="1750510">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1750520">//&nbsp;Breakpoint&nbsp;executes&nbsp;a&nbsp;breakpoint&nbsp;trap.</span><br>
<span class="lineno">10</span><span class="keyword" id="1750562">func</span>&nbsp;<span class="ident" id="1750567">Breakpoint</span><span class="op" id="1750577">(</span><span class="op" id="1750578">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1750581">//&nbsp;LockOSThread&nbsp;wires&nbsp;the&nbsp;calling&nbsp;goroutine&nbsp;to&nbsp;its&nbsp;current&nbsp;operating&nbsp;system&nbsp;thread.</span><br>
<span class="lineno"></span><span class="comment" id="1750665">//&nbsp;Until&nbsp;the&nbsp;calling&nbsp;goroutine&nbsp;exits&nbsp;or&nbsp;calls&nbsp;UnlockOSThread,&nbsp;it&nbsp;will&nbsp;always</span><br>
<span class="lineno"></span><span class="comment" id="1750742">//&nbsp;execute&nbsp;in&nbsp;that&nbsp;thread,&nbsp;and&nbsp;no&nbsp;other&nbsp;goroutine&nbsp;can.</span><br>
<span class="lineno">15</span><span class="keyword" id="1750797">func</span>&nbsp;<span class="ident" id="1750802">LockOSThread</span><span class="op" id="1750814">(</span><span class="op" id="1750815">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1750818">//&nbsp;UnlockOSThread&nbsp;unwires&nbsp;the&nbsp;calling&nbsp;goroutine&nbsp;from&nbsp;its&nbsp;fixed&nbsp;operating&nbsp;system&nbsp;thread.</span><br>
<span class="lineno"></span><span class="comment" id="1750906">//&nbsp;If&nbsp;the&nbsp;calling&nbsp;goroutine&nbsp;has&nbsp;not&nbsp;called&nbsp;LockOSThread,&nbsp;UnlockOSThread&nbsp;is&nbsp;a&nbsp;no-op.</span><br>
<span class="lineno"></span><span class="keyword" id="1750990">func</span>&nbsp;<span class="ident" id="1750995">UnlockOSThread</span><span class="op" id="1751009">(</span><span class="op" id="1751010">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="1751013">//&nbsp;GOMAXPROCS&nbsp;sets&nbsp;the&nbsp;maximum&nbsp;number&nbsp;of&nbsp;CPUs&nbsp;that&nbsp;can&nbsp;be&nbsp;executing</span><br>
<span class="lineno"></span><span class="comment" id="1751081">//&nbsp;simultaneously&nbsp;and&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.&nbsp;&nbsp;If&nbsp;n&nbsp;&lt;&nbsp;1,&nbsp;it&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="1751156">//&nbsp;change&nbsp;the&nbsp;current&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="1751187">//&nbsp;The&nbsp;number&nbsp;of&nbsp;logical&nbsp;CPUs&nbsp;on&nbsp;the&nbsp;local&nbsp;machine&nbsp;can&nbsp;be&nbsp;queried&nbsp;with&nbsp;NumCPU.</span><br>
<span class="lineno">25</span><span class="comment" id="1751266">//&nbsp;This&nbsp;call&nbsp;will&nbsp;go&nbsp;away&nbsp;when&nbsp;the&nbsp;scheduler&nbsp;improves.</span><br>
<span class="lineno"></span><span class="keyword" id="1751321">func</span>&nbsp;<span class="ident" id="1751326">GOMAXPROCS</span><span class="op" id="1751336">(</span><span class="ident" id="1751337">n</span>&nbsp;<span class="builtintype" id="1751339">int</span><span class="op" id="1751342">)</span>&nbsp;<span class="builtintype" id="1751344">int</span>&nbsp;<span class="op" id="1751348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1751351">if</span>&nbsp;<span class="ident" id="1751354"><a href="/runtime/debug.go.html#1751337">n</a></span>&nbsp;<span class="op" id="1751356">&gt;</span>&nbsp;<span class="ident" id="1751358"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2018838">_MaxGomaxprocs</a></span>&nbsp;<span class="op" id="1751373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751377"><a href="/runtime/debug.go.html#1751337">n</a></span>&nbsp;<span class="op" id="1751379">=</span>&nbsp;<span class="ident" id="1751381"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2018838">_MaxGomaxprocs</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1751397">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751400"><a href="/runtime/lock_futex.go.html#1815304">lock</a></span><span class="op" id="1751404">(</span><span class="op" id="1751405">&amp;</span><span class="ident" id="1751406"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2021525">sched</a></span><span class="op" id="1751411">.</span><span class="ident" id="1751412">lock</span><span class="op" id="1751416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751419">ret</span>&nbsp;<span class="op" id="1751423">:=</span>&nbsp;<span class="builtintype" id="1751426">int</span><span class="op" id="1751429">(</span><span class="ident" id="1751430"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2021238">gomaxprocs</a></span><span class="op" id="1751440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751443"><a href="/runtime/lock_futex.go.html#1816596">unlock</a></span><span class="op" id="1751449">(</span><span class="op" id="1751450">&amp;</span><span class="ident" id="1751451"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2021525">sched</a></span><span class="op" id="1751456">.</span><span class="ident" id="1751457">lock</span><span class="op" id="1751461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1751464">if</span>&nbsp;<span class="ident" id="1751467"><a href="/runtime/debug.go.html#1751337">n</a></span>&nbsp;<span class="op" id="1751469">&lt;=</span>&nbsp;<span class="num" id="1751472">0</span>&nbsp;<span class="op" id="1751474">||</span>&nbsp;<span class="ident" id="1751477"><a href="/runtime/debug.go.html#1751337">n</a></span>&nbsp;<span class="op" id="1751479">==</span>&nbsp;<span class="ident" id="1751482"><a href="/runtime/debug.go.html#1751419">ret</a></span>&nbsp;<span class="op" id="1751486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1751490">return</span>&nbsp;<span class="ident" id="1751497"><a href="/runtime/debug.go.html#1751419">ret</a></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1751502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751506"><a href="/runtime/sema.go.html#1932865">semacquire</a></span><span class="op" id="1751516">(</span><span class="op" id="1751517">&amp;</span><span class="ident" id="1751518"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2021561">worldsema</a></span><span class="op" id="1751527">,</span>&nbsp;<span class="ident" id="1751529">false</span><span class="op" id="1751534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751537">gp</span>&nbsp;<span class="op" id="1751540">:=</span>&nbsp;<span class="ident" id="1751543"><a href="/runtime/stubs.go.html#1968886">getg</a></span><span class="op" id="1751547">(</span><span class="op" id="1751548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751551"><a href="/runtime/debug.go.html#1751537">gp</a></span><span class="op" id="1751553">.</span><span class="ident" id="1751554">m</span><span class="op" id="1751555">.</span><span class="ident" id="1751556">gcing</span>&nbsp;<span class="op" id="1751562">=</span>&nbsp;<span class="num" id="1751564">1</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751567"><a href="/runtime/stubs.go.html#1971002">onM</a></span><span class="op" id="1751570">(</span><span class="ident" id="1751571"><a href="/runtime/stubs.go.html#1972761">stoptheworld</a></span><span class="op" id="1751583">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1751587">//&nbsp;newprocs&nbsp;will&nbsp;be&nbsp;processed&nbsp;by&nbsp;starttheworld</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751635"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2021542">newprocs</a></span>&nbsp;<span class="op" id="1751644">=</span>&nbsp;<span class="builtintype" id="1751646">int32</span><span class="op" id="1751651">(</span><span class="ident" id="1751652"><a href="/runtime/debug.go.html#1751337">n</a></span><span class="op" id="1751653">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751657"><a href="/runtime/debug.go.html#1751537">gp</a></span><span class="op" id="1751659">.</span><span class="ident" id="1751660">m</span><span class="op" id="1751661">.</span><span class="ident" id="1751662">gcing</span>&nbsp;<span class="op" id="1751668">=</span>&nbsp;<span class="num" id="1751670">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751673"><a href="/runtime/sema.go.html#1933949">semrelease</a></span><span class="op" id="1751683">(</span><span class="op" id="1751684">&amp;</span><span class="ident" id="1751685"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2021561">worldsema</a></span><span class="op" id="1751694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1751697"><a href="/runtime/stubs.go.html#1971002">onM</a></span><span class="op" id="1751700">(</span><span class="ident" id="1751701"><a href="/runtime/stubs.go.html#1972740">starttheworld</a></span><span class="op" id="1751714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1751717">return</span>&nbsp;<span class="ident" id="1751724"><a href="/runtime/debug.go.html#1751419">ret</a></span><br>
<span class="lineno"></span><span class="op" id="1751728">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="1751731">//&nbsp;NumCPU&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;logical&nbsp;CPUs&nbsp;on&nbsp;the&nbsp;local&nbsp;machine.</span><br>
<span class="lineno"></span><span class="keyword" id="1751798">func</span>&nbsp;<span class="ident" id="1751803">NumCPU</span><span class="op" id="1751809">(</span><span class="op" id="1751810">)</span>&nbsp;<span class="builtintype" id="1751812">int</span>&nbsp;<span class="op" id="1751816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1751819">return</span>&nbsp;<span class="builtintype" id="1751826">int</span><span class="op" id="1751829">(</span><span class="ident" id="1751830"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2021317">ncpu</a></span><span class="op" id="1751834">)</span><br>
<span class="lineno"></span><span class="op" id="1751836">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="1751839">//&nbsp;NumCgoCall&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;cgo&nbsp;calls&nbsp;made&nbsp;by&nbsp;the&nbsp;current&nbsp;process.</span><br>
<span class="lineno"></span><span class="keyword" id="1751914">func</span>&nbsp;<span class="ident" id="1751919">NumCgoCall</span><span class="op" id="1751929">(</span><span class="op" id="1751930">)</span>&nbsp;<span class="ident" id="1751932">int64</span>&nbsp;<span class="op" id="1751938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1751941">var</span>&nbsp;<span class="ident" id="1751945">n</span>&nbsp;<span class="ident" id="1751947">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1751954">for</span>&nbsp;<span class="ident" id="1751958">mp</span>&nbsp;<span class="op" id="1751961">:=</span>&nbsp;<span class="op" id="1751964">(</span><span class="op" id="1751965">*</span><span class="ident" id="1751966"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2017777">m</a></span><span class="op" id="1751967">)</span><span class="op" id="1751968">(</span><span class="ident" id="1751969"><a href="/runtime/atomic.go.html#1711401">atomicloadp</a></span><span class="op" id="1751980">(</span><span class="ident" id="1751981"><a href="/runtime/debug.go.html#1750510">unsafe</a></span><span class="op" id="1751987">.</span><span class="ident" id="1751988">Pointer</span><span class="op" id="1751995">(</span><span class="op" id="1751996">&amp;</span><span class="ident" id="1751997"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2021209">allm</a></span><span class="op" id="1752001">)</span><span class="op" id="1752002">)</span><span class="op" id="1752003">)</span><span class="op" id="1752004">;</span>&nbsp;<span class="ident" id="1752006"><a href="/runtime/debug.go.html#1751958">mp</a></span>&nbsp;<span class="op" id="1752009">!=</span>&nbsp;<span class="ident" id="1752012">nil</span><span class="op" id="1752015">;</span>&nbsp;<span class="ident" id="1752017"><a href="/runtime/debug.go.html#1751958">mp</a></span>&nbsp;<span class="op" id="1752020">=</span>&nbsp;<span class="ident" id="1752022"><a href="/runtime/debug.go.html#1751958">mp</a></span><span class="op" id="1752024">.</span><span class="ident" id="1752025">alllink</span>&nbsp;<span class="op" id="1752033">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1752037"><a href="/runtime/debug.go.html#1751945">n</a></span>&nbsp;<span class="op" id="1752039">+=</span>&nbsp;<span class="ident" id="1752042">int64</span><span class="op" id="1752047">(</span><span class="ident" id="1752048"><a href="/runtime/debug.go.html#1751958">mp</a></span><span class="op" id="1752050">.</span><span class="ident" id="1752051">ncgocall</span><span class="op" id="1752059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1752062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1752065">return</span>&nbsp;<span class="ident" id="1752072"><a href="/runtime/debug.go.html#1751945">n</a></span><br>
<span class="lineno"></span><span class="op" id="1752074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="comment" id="1752077">//&nbsp;NumGoroutine&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;goroutines&nbsp;that&nbsp;currently&nbsp;exist.</span><br>
<span class="lineno"></span><span class="keyword" id="1752148">func</span>&nbsp;<span class="ident" id="1752153">NumGoroutine</span><span class="op" id="1752165">(</span><span class="op" id="1752166">)</span>&nbsp;<span class="builtintype" id="1752168">int</span>&nbsp;<span class="op" id="1752172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1752175">return</span>&nbsp;<span class="builtintype" id="1752182">int</span><span class="op" id="1752185">(</span><span class="ident" id="1752186"><a href="/runtime/debug.go.html#1752204">gcount</a></span><span class="op" id="1752192">(</span><span class="op" id="1752193">)</span><span class="op" id="1752194">)</span><br>
<span class="lineno"></span><span class="op" id="1752196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="1752199">func</span>&nbsp;<span class="ident" id="1752204">gcount</span><span class="op" id="1752210">(</span><span class="op" id="1752211">)</span>&nbsp;<span class="builtintype" id="1752213">int32</span>
</div>
</body>
</html>
