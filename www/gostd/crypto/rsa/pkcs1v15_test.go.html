<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rsa</h2>
<ul>
<li><a href="/gostd/crypto/rsa/pkcs1v15.go.html">pkcs1v15.go</a></li>
<li><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html">pkcs1v15_test.go</a></li>
<li><a href="/gostd/crypto/rsa/pss.go.html">pss.go</a></li>
<li><a href="/gostd/crypto/rsa/pss_test.go.html">pss_test.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa.go.html">rsa.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa_test.go.html">rsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7841566">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7841621">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7841675">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7841726">package</span>&nbsp;<span class="ident" id="7841734">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7841739">import</span>&nbsp;<span class="op" id="7841746">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7841749">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7841758">&#34;crypto&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7841768">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7841783">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7841798">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7841817">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7841833">&#34;io&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7841839">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7841851">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7841862">&#34;testing/quick&#34;</span><br>
<span class="lineno"></span><span class="op" id="7841878">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="7841881">func</span>&nbsp;<span class="ident" id="7841886">decodeBase64</span><span class="op" id="7841898">(</span><span class="ident" id="7841899">in</span>&nbsp;<span class="builtintype" id="7841902">string</span><span class="op" id="7841908">)</span>&nbsp;<span class="op" id="7841910">[</span><span class="op" id="7841911">]</span><span class="builtintype" id="7841912">byte</span>&nbsp;<span class="op" id="7841917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841920">out</span>&nbsp;<span class="op" id="7841924">:=</span>&nbsp;<span class="builtinfunc" id="7841927">make</span><span class="op" id="7841931">(</span><span class="op" id="7841932">[</span><span class="op" id="7841933">]</span><span class="builtintype" id="7841934">byte</span><span class="op" id="7841938">,</span>&nbsp;<span class="ident" id="7841940">base64</span><span class="op" id="7841946">.</span><span class="ident" id="7841947">StdEncoding</span><span class="op" id="7841958">.</span><span class="ident" id="7841959">DecodedLen</span><span class="op" id="7841969">(</span><span class="builtinfunc" id="7841970">len</span><span class="op" id="7841973">(</span><span class="ident" id="7841974">in</span><span class="op" id="7841976">)</span><span class="op" id="7841977">)</span><span class="op" id="7841978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7841981">n</span><span class="op" id="7841982">,</span>&nbsp;<span class="ident" id="7841984">err</span>&nbsp;<span class="op" id="7841988">:=</span>&nbsp;<span class="ident" id="7841991">base64</span><span class="op" id="7841997">.</span><span class="ident" id="7841998">StdEncoding</span><span class="op" id="7842009">.</span><span class="ident" id="7842010">Decode</span><span class="op" id="7842016">(</span><span class="ident" id="7842017">out</span><span class="op" id="7842020">,</span>&nbsp;<span class="op" id="7842022">[</span><span class="op" id="7842023">]</span><span class="builtintype" id="7842024">byte</span><span class="op" id="7842028">(</span><span class="ident" id="7842029">in</span><span class="op" id="7842031">)</span><span class="op" id="7842032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7842035">if</span>&nbsp;<span class="ident" id="7842038">err</span>&nbsp;<span class="op" id="7842042">!=</span>&nbsp;<span class="ident" id="7842045">nil</span>&nbsp;<span class="op" id="7842049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7842053">return</span>&nbsp;<span class="ident" id="7842060">nil</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7842065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7842068">return</span>&nbsp;<span class="ident" id="7842075">out</span><span class="op" id="7842078">[</span><span class="num" id="7842079">0</span><span class="op" id="7842080">:</span><span class="ident" id="7842081">n</span><span class="op" id="7842082">]</span><br>
<span class="lineno"></span><span class="op" id="7842084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7842087">type</span>&nbsp;<span class="ident" id="7842092">DecryptPKCS1v15Test</span>&nbsp;<span class="keyword" id="7842112">struct</span>&nbsp;<span class="op" id="7842119">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7842122">in</span><span class="op" id="7842124">,</span>&nbsp;<span class="ident" id="7842126">out</span>&nbsp;<span class="builtintype" id="7842130">string</span><br>
<span class="lineno"></span><span class="op" id="7842137">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7842140">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;with&nbsp;`openssl&nbsp;rsautl&nbsp;-pkcs&nbsp;-encrypt`</span><br>
<span class="lineno"></span><span class="keyword" id="7842214">var</span>&nbsp;<span class="ident" id="7842218">decryptPKCS1v15Tests</span>&nbsp;<span class="op" id="7842239">=</span>&nbsp;<span class="op" id="7842241">[</span><span class="op" id="7842242">]</span><span class="ident" id="7842243">DecryptPKCS1v15Test</span><span class="op" id="7842262">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7842265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7842269">&#34;gIcUIoVkD6ATMBk/u/nlCZCCWRKdkfjCgFdo35VpRXLduiKXhNz1XupLLzTXAybEq15juc+EgY5o0DHv/nt3yg==&#34;</span><span class="op" id="7842359">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7842363">&#34;x&#34;</span><span class="op" id="7842366">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7842369">}</span><span class="op" id="7842370">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7842373">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7842377">&#34;Y7TOCSqofGhkRb+jaVRLzK8xw2cSo1IVES19utzv6hwvx+M8kFsoWQm5DzBeJCZTCVDPkTpavUuEbgp8hnUGDw==&#34;</span><span class="op" id="7842467">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7842471">&#34;testing.&#34;</span><span class="op" id="7842481">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7842484">}</span><span class="op" id="7842485">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7842488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7842492">&#34;arReP9DJtEVyV2Dg3dDp4c/PSk1O6lxkoJ8HcFupoRorBZG+7+1fDAwT1olNddFnQMjmkb8vxwmNMoTAT/BFjQ==&#34;</span><span class="op" id="7842582">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7842586">&#34;testing.\n&#34;</span><span class="op" id="7842598">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7842601">}</span><span class="op" id="7842602">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7842605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7842609">&#34;WtaBXIoGC54+vH0NH0CHHE+dRDOsMc/6BrfFu2lEqcKL9+uDuWaf+Xj9mrbQCjjZcpQuX733zyok/jsnqe/Ftw==&#34;</span><span class="op" id="7842699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7842703">&#34;01234567890123456789012345678901234567890123456789012&#34;</span><span class="op" id="7842758">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7842761">}</span><span class="op" id="7842762">,</span><br>
<span class="lineno"></span><span class="op" id="7842764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7842767">func</span>&nbsp;<span class="ident" id="7842772">TestDecryptPKCS1v15</span><span class="op" id="7842791">(</span><span class="ident" id="7842792">t</span>&nbsp;<span class="op" id="7842794">*</span><span class="ident" id="7842795">testing</span><span class="op" id="7842802">.</span><span class="ident" id="7842803">T</span><span class="op" id="7842804">)</span>&nbsp;<span class="op" id="7842806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7842809">for</span>&nbsp;<span class="ident" id="7842813">i</span><span class="op" id="7842814">,</span>&nbsp;<span class="ident" id="7842816">test</span>&nbsp;<span class="op" id="7842821">:=</span>&nbsp;<span class="keyword" id="7842824">range</span>&nbsp;<span class="ident" id="7842830">decryptPKCS1v15Tests</span>&nbsp;<span class="op" id="7842851">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7842855">out</span><span class="op" id="7842858">,</span>&nbsp;<span class="ident" id="7842860">err</span>&nbsp;<span class="op" id="7842864">:=</span>&nbsp;<span class="ident" id="7842867">DecryptPKCS1v15</span><span class="op" id="7842882">(</span><span class="ident" id="7842883">nil</span><span class="op" id="7842886">,</span>&nbsp;<span class="ident" id="7842888">rsaPrivateKey</span><span class="op" id="7842901">,</span>&nbsp;<span class="ident" id="7842903">decodeBase64</span><span class="op" id="7842915">(</span><span class="ident" id="7842916">test</span><span class="op" id="7842920">.</span><span class="ident" id="7842921">in</span><span class="op" id="7842923">)</span><span class="op" id="7842924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7842928">if</span>&nbsp;<span class="ident" id="7842931">err</span>&nbsp;<span class="op" id="7842935">!=</span>&nbsp;<span class="ident" id="7842938">nil</span>&nbsp;<span class="op" id="7842942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7842947">t</span><span class="op" id="7842948">.</span><span class="ident" id="7842949">Errorf</span><span class="op" id="7842955">(</span><span class="string" id="7842956">&#34;#%d&nbsp;error&nbsp;decrypting&#34;</span><span class="op" id="7842978">,</span>&nbsp;<span class="ident" id="7842980">i</span><span class="op" id="7842981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7842985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7842989">want</span>&nbsp;<span class="op" id="7842994">:=</span>&nbsp;<span class="op" id="7842997">[</span><span class="op" id="7842998">]</span><span class="builtintype" id="7842999">byte</span><span class="op" id="7843003">(</span><span class="ident" id="7843004">test</span><span class="op" id="7843008">.</span><span class="ident" id="7843009">out</span><span class="op" id="7843012">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7843016">if</span>&nbsp;<span class="op" id="7843019">!</span><span class="ident" id="7843020">bytes</span><span class="op" id="7843025">.</span><span class="ident" id="7843026">Equal</span><span class="op" id="7843031">(</span><span class="ident" id="7843032">out</span><span class="op" id="7843035">,</span>&nbsp;<span class="ident" id="7843037">want</span><span class="op" id="7843041">)</span>&nbsp;<span class="op" id="7843043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7843048">t</span><span class="op" id="7843049">.</span><span class="ident" id="7843050">Errorf</span><span class="op" id="7843056">(</span><span class="string" id="7843057">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="7843079">,</span>&nbsp;<span class="ident" id="7843081">i</span><span class="op" id="7843082">,</span>&nbsp;<span class="ident" id="7843084">out</span><span class="op" id="7843087">,</span>&nbsp;<span class="ident" id="7843089">want</span><span class="op" id="7843093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7843097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7843100">}</span><br>
<span class="lineno"></span><span class="op" id="7843102">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="7843105">func</span>&nbsp;<span class="ident" id="7843110">TestEncryptPKCS1v15</span><span class="op" id="7843129">(</span><span class="ident" id="7843130">t</span>&nbsp;<span class="op" id="7843132">*</span><span class="ident" id="7843133">testing</span><span class="op" id="7843140">.</span><span class="ident" id="7843141">T</span><span class="op" id="7843142">)</span>&nbsp;<span class="op" id="7843144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7843147">random</span>&nbsp;<span class="op" id="7843154">:=</span>&nbsp;<span class="ident" id="7843157">rand</span><span class="op" id="7843161">.</span><span class="ident" id="7843162">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7843170">k</span>&nbsp;<span class="op" id="7843172">:=</span>&nbsp;<span class="op" id="7843175">(</span><span class="ident" id="7843176">rsaPrivateKey</span><span class="op" id="7843189">.</span><span class="ident" id="7843190">N</span><span class="op" id="7843191">.</span><span class="ident" id="7843192">BitLen</span><span class="op" id="7843198">(</span><span class="op" id="7843199">)</span>&nbsp;<span class="op" id="7843201">+</span>&nbsp;<span class="num" id="7843203">7</span><span class="op" id="7843204">)</span>&nbsp;<span class="op" id="7843206">/</span>&nbsp;<span class="num" id="7843208">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7843212">tryEncryptDecrypt</span>&nbsp;<span class="op" id="7843230">:=</span>&nbsp;<span class="keyword" id="7843233">func</span><span class="op" id="7843237">(</span><span class="ident" id="7843238">in</span>&nbsp;<span class="op" id="7843241">[</span><span class="op" id="7843242">]</span><span class="builtintype" id="7843243">byte</span><span class="op" id="7843247">,</span>&nbsp;<span class="ident" id="7843249">blind</span>&nbsp;<span class="builtintype" id="7843255">bool</span><span class="op" id="7843259">)</span>&nbsp;<span class="builtintype" id="7843261">bool</span>&nbsp;<span class="op" id="7843266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7843270">if</span>&nbsp;<span class="builtinfunc" id="7843273">len</span><span class="op" id="7843276">(</span><span class="ident" id="7843277">in</span><span class="op" id="7843279">)</span>&nbsp;<span class="op" id="7843281">&gt;</span>&nbsp;<span class="ident" id="7843283">k</span><span class="op" id="7843284">-</span><span class="num" id="7843285">11</span>&nbsp;<span class="op" id="7843288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7843293">in</span>&nbsp;<span class="op" id="7843296">=</span>&nbsp;<span class="ident" id="7843298">in</span><span class="op" id="7843300">[</span><span class="num" id="7843301">0</span>&nbsp;<span class="op" id="7843303">:</span>&nbsp;<span class="ident" id="7843305">k</span><span class="op" id="7843306">-</span><span class="num" id="7843307">11</span><span class="op" id="7843309">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7843313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7843318">ciphertext</span><span class="op" id="7843328">,</span>&nbsp;<span class="ident" id="7843330">err</span>&nbsp;<span class="op" id="7843334">:=</span>&nbsp;<span class="ident" id="7843337">EncryptPKCS1v15</span><span class="op" id="7843352">(</span><span class="ident" id="7843353">random</span><span class="op" id="7843359">,</span>&nbsp;<span class="op" id="7843361">&amp;</span><span class="ident" id="7843362">rsaPrivateKey</span><span class="op" id="7843375">.</span><span class="ident" id="7843376">PublicKey</span><span class="op" id="7843385">,</span>&nbsp;<span class="ident" id="7843387">in</span><span class="op" id="7843389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7843393">if</span>&nbsp;<span class="ident" id="7843396">err</span>&nbsp;<span class="op" id="7843400">!=</span>&nbsp;<span class="ident" id="7843403">nil</span>&nbsp;<span class="op" id="7843407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7843412">t</span><span class="op" id="7843413">.</span><span class="ident" id="7843414">Errorf</span><span class="op" id="7843420">(</span><span class="string" id="7843421">&#34;error&nbsp;encrypting:&nbsp;%s&#34;</span><span class="op" id="7843443">,</span>&nbsp;<span class="ident" id="7843445">err</span><span class="op" id="7843448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7843453">return</span>&nbsp;<span class="builtintype" id="7843460">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7843468">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7843473">var</span>&nbsp;<span class="ident" id="7843477">rand</span>&nbsp;<span class="ident" id="7843482">io</span><span class="op" id="7843484">.</span><span class="ident" id="7843485">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7843494">if</span>&nbsp;<span class="op" id="7843497">!</span><span class="ident" id="7843498">blind</span>&nbsp;<span class="op" id="7843504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7843509">rand</span>&nbsp;<span class="op" id="7843514">=</span>&nbsp;<span class="ident" id="7843516">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7843522">}</span>&nbsp;<span class="keyword" id="7843524">else</span>&nbsp;<span class="op" id="7843529">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7843534">rand</span>&nbsp;<span class="op" id="7843539">=</span>&nbsp;<span class="ident" id="7843541">random</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7843550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7843554">plaintext</span><span class="op" id="7843563">,</span>&nbsp;<span class="ident" id="7843565">err</span>&nbsp;<span class="op" id="7843569">:=</span>&nbsp;<span class="ident" id="7843572">DecryptPKCS1v15</span><span class="op" id="7843587">(</span><span class="ident" id="7843588">rand</span><span class="op" id="7843592">,</span>&nbsp;<span class="ident" id="7843594">rsaPrivateKey</span><span class="op" id="7843607">,</span>&nbsp;<span class="ident" id="7843609">ciphertext</span><span class="op" id="7843619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7843623">if</span>&nbsp;<span class="ident" id="7843626">err</span>&nbsp;<span class="op" id="7843630">!=</span>&nbsp;<span class="ident" id="7843633">nil</span>&nbsp;<span class="op" id="7843637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7843642">t</span><span class="op" id="7843643">.</span><span class="ident" id="7843644">Errorf</span><span class="op" id="7843650">(</span><span class="string" id="7843651">&#34;error&nbsp;decrypting:&nbsp;%s&#34;</span><span class="op" id="7843673">,</span>&nbsp;<span class="ident" id="7843675">err</span><span class="op" id="7843678">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7843683">return</span>&nbsp;<span class="builtintype" id="7843690">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7843698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7843703">if</span>&nbsp;<span class="op" id="7843706">!</span><span class="ident" id="7843707">bytes</span><span class="op" id="7843712">.</span><span class="ident" id="7843713">Equal</span><span class="op" id="7843718">(</span><span class="ident" id="7843719">plaintext</span><span class="op" id="7843728">,</span>&nbsp;<span class="ident" id="7843730">in</span><span class="op" id="7843732">)</span>&nbsp;<span class="op" id="7843734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7843739">t</span><span class="op" id="7843740">.</span><span class="ident" id="7843741">Errorf</span><span class="op" id="7843747">(</span><span class="string" id="7843748">&#34;output&nbsp;mismatch:&nbsp;%#v&nbsp;%#v&#34;</span><span class="op" id="7843774">,</span>&nbsp;<span class="ident" id="7843776">plaintext</span><span class="op" id="7843785">,</span>&nbsp;<span class="ident" id="7843787">in</span><span class="op" id="7843789">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7843794">return</span>&nbsp;<span class="builtintype" id="7843801">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7843809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7843813">return</span>&nbsp;<span class="builtintype" id="7843820">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7843826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7843830">config</span>&nbsp;<span class="op" id="7843837">:=</span>&nbsp;<span class="builtinfunc" id="7843840">new</span><span class="op" id="7843843">(</span><span class="ident" id="7843844">quick</span><span class="op" id="7843849">.</span><span class="ident" id="7843850">Config</span><span class="op" id="7843856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7843859">if</span>&nbsp;<span class="ident" id="7843862">testing</span><span class="op" id="7843869">.</span><span class="ident" id="7843870">Short</span><span class="op" id="7843875">(</span><span class="op" id="7843876">)</span>&nbsp;<span class="op" id="7843878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7843882">config</span><span class="op" id="7843888">.</span><span class="ident" id="7843889">MaxCount</span>&nbsp;<span class="op" id="7843898">=</span>&nbsp;<span class="num" id="7843900">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7843904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7843907">quick</span><span class="op" id="7843912">.</span><span class="ident" id="7843913">Check</span><span class="op" id="7843918">(</span><span class="ident" id="7843919">tryEncryptDecrypt</span><span class="op" id="7843936">,</span>&nbsp;<span class="ident" id="7843938">config</span><span class="op" id="7843944">)</span><br>
<span class="lineno">105</span><span class="op" id="7843946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7843949">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;with&nbsp;`openssl&nbsp;rsautl&nbsp;-pkcs&nbsp;-encrypt`</span><br>
<span class="lineno"></span><span class="keyword" id="7844023">var</span>&nbsp;<span class="ident" id="7844027">decryptPKCS1v15SessionKeyTests</span>&nbsp;<span class="op" id="7844058">=</span>&nbsp;<span class="op" id="7844060">[</span><span class="op" id="7844061">]</span><span class="ident" id="7844062">DecryptPKCS1v15Test</span><span class="op" id="7844081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7844084">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7844088">&#34;e6ukkae6Gykq0fKzYwULpZehX+UPXYzMoB5mHQUDEiclRbOTqas4Y0E6nwns1BBpdvEJcilhl5zsox/6DtGsYg==&#34;</span><span class="op" id="7844178">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7844182">&#34;1234&#34;</span><span class="op" id="7844188">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7844191">}</span><span class="op" id="7844192">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7844195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7844199">&#34;Dtis4uk/q/LQGGqGk97P59K03hkCIVFMEFZRgVWOAAhxgYpCRG0MX2adptt92l67IqMki6iVQyyt0TtX3IdtEw==&#34;</span><span class="op" id="7844289">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7844293">&#34;FAIL&#34;</span><span class="op" id="7844299">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7844302">}</span><span class="op" id="7844303">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7844306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7844310">&#34;LIyFyCYCptPxrvTxpol8F3M7ZivlMsf53zs0vHRAv+rDIh2YsHS69ePMoPMe3TkOMZ3NupiL3takPxIs1sK+dw==&#34;</span><span class="op" id="7844400">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7844404">&#34;abcd&#34;</span><span class="op" id="7844410">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7844413">}</span><span class="op" id="7844414">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7844417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7844421">&#34;bafnobel46bKy76JzqU/RIVOH0uAYvzUtauKmIidKgM0sMlvobYVAVQPeUQ/oTGjbIZ1v/6Gyi5AO4DtHruGdw==&#34;</span><span class="op" id="7844511">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7844515">&#34;FAIL&#34;</span><span class="op" id="7844521">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7844524">}</span><span class="op" id="7844525">,</span><br>
<span class="lineno">125</span><span class="op" id="7844527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7844530">func</span>&nbsp;<span class="ident" id="7844535">TestEncryptPKCS1v15SessionKey</span><span class="op" id="7844564">(</span><span class="ident" id="7844565">t</span>&nbsp;<span class="op" id="7844567">*</span><span class="ident" id="7844568">testing</span><span class="op" id="7844575">.</span><span class="ident" id="7844576">T</span><span class="op" id="7844577">)</span>&nbsp;<span class="op" id="7844579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7844582">for</span>&nbsp;<span class="ident" id="7844586">i</span><span class="op" id="7844587">,</span>&nbsp;<span class="ident" id="7844589">test</span>&nbsp;<span class="op" id="7844594">:=</span>&nbsp;<span class="keyword" id="7844597">range</span>&nbsp;<span class="ident" id="7844603">decryptPKCS1v15SessionKeyTests</span>&nbsp;<span class="op" id="7844634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7844638">key</span>&nbsp;<span class="op" id="7844642">:=</span>&nbsp;<span class="op" id="7844645">[</span><span class="op" id="7844646">]</span><span class="builtintype" id="7844647">byte</span><span class="op" id="7844651">(</span><span class="string" id="7844652">&#34;FAIL&#34;</span><span class="op" id="7844658">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7844662">err</span>&nbsp;<span class="op" id="7844666">:=</span>&nbsp;<span class="ident" id="7844669">DecryptPKCS1v15SessionKey</span><span class="op" id="7844694">(</span><span class="ident" id="7844695">nil</span><span class="op" id="7844698">,</span>&nbsp;<span class="ident" id="7844700">rsaPrivateKey</span><span class="op" id="7844713">,</span>&nbsp;<span class="ident" id="7844715">decodeBase64</span><span class="op" id="7844727">(</span><span class="ident" id="7844728">test</span><span class="op" id="7844732">.</span><span class="ident" id="7844733">in</span><span class="op" id="7844735">)</span><span class="op" id="7844736">,</span>&nbsp;<span class="ident" id="7844738">key</span><span class="op" id="7844741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7844745">if</span>&nbsp;<span class="ident" id="7844748">err</span>&nbsp;<span class="op" id="7844752">!=</span>&nbsp;<span class="ident" id="7844755">nil</span>&nbsp;<span class="op" id="7844759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7844764">t</span><span class="op" id="7844765">.</span><span class="ident" id="7844766">Errorf</span><span class="op" id="7844772">(</span><span class="string" id="7844773">&#34;#%d&nbsp;error&nbsp;decrypting&#34;</span><span class="op" id="7844795">,</span>&nbsp;<span class="ident" id="7844797">i</span><span class="op" id="7844798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7844802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7844806">want</span>&nbsp;<span class="op" id="7844811">:=</span>&nbsp;<span class="op" id="7844814">[</span><span class="op" id="7844815">]</span><span class="builtintype" id="7844816">byte</span><span class="op" id="7844820">(</span><span class="ident" id="7844821">test</span><span class="op" id="7844825">.</span><span class="ident" id="7844826">out</span><span class="op" id="7844829">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7844833">if</span>&nbsp;<span class="op" id="7844836">!</span><span class="ident" id="7844837">bytes</span><span class="op" id="7844842">.</span><span class="ident" id="7844843">Equal</span><span class="op" id="7844848">(</span><span class="ident" id="7844849">key</span><span class="op" id="7844852">,</span>&nbsp;<span class="ident" id="7844854">want</span><span class="op" id="7844858">)</span>&nbsp;<span class="op" id="7844860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7844865">t</span><span class="op" id="7844866">.</span><span class="ident" id="7844867">Errorf</span><span class="op" id="7844873">(</span><span class="string" id="7844874">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="7844896">,</span>&nbsp;<span class="ident" id="7844898">i</span><span class="op" id="7844899">,</span>&nbsp;<span class="ident" id="7844901">key</span><span class="op" id="7844904">,</span>&nbsp;<span class="ident" id="7844906">want</span><span class="op" id="7844910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7844914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7844917">}</span><br>
<span class="lineno"></span><span class="op" id="7844919">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="7844922">func</span>&nbsp;<span class="ident" id="7844927">TestNonZeroRandomBytes</span><span class="op" id="7844949">(</span><span class="ident" id="7844950">t</span>&nbsp;<span class="op" id="7844952">*</span><span class="ident" id="7844953">testing</span><span class="op" id="7844960">.</span><span class="ident" id="7844961">T</span><span class="op" id="7844962">)</span>&nbsp;<span class="op" id="7844964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7844967">random</span>&nbsp;<span class="op" id="7844974">:=</span>&nbsp;<span class="ident" id="7844977">rand</span><span class="op" id="7844981">.</span><span class="ident" id="7844982">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7844991">b</span>&nbsp;<span class="op" id="7844993">:=</span>&nbsp;<span class="builtinfunc" id="7844996">make</span><span class="op" id="7845000">(</span><span class="op" id="7845001">[</span><span class="op" id="7845002">]</span><span class="builtintype" id="7845003">byte</span><span class="op" id="7845007">,</span>&nbsp;<span class="num" id="7845009">512</span><span class="op" id="7845012">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7845015">err</span>&nbsp;<span class="op" id="7845019">:=</span>&nbsp;<span class="ident" id="7845022">nonZeroRandomBytes</span><span class="op" id="7845040">(</span><span class="ident" id="7845041">b</span><span class="op" id="7845042">,</span>&nbsp;<span class="ident" id="7845044">random</span><span class="op" id="7845050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7845053">if</span>&nbsp;<span class="ident" id="7845056">err</span>&nbsp;<span class="op" id="7845060">!=</span>&nbsp;<span class="ident" id="7845063">nil</span>&nbsp;<span class="op" id="7845067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7845071">t</span><span class="op" id="7845072">.</span><span class="ident" id="7845073">Errorf</span><span class="op" id="7845079">(</span><span class="string" id="7845080">&#34;returned&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7845100">,</span>&nbsp;<span class="ident" id="7845102">err</span><span class="op" id="7845105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7845108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7845111">for</span>&nbsp;<span class="ident" id="7845115">_</span><span class="op" id="7845116">,</span>&nbsp;<span class="ident" id="7845118">b</span>&nbsp;<span class="op" id="7845120">:=</span>&nbsp;<span class="keyword" id="7845123">range</span>&nbsp;<span class="ident" id="7845129">b</span>&nbsp;<span class="op" id="7845131">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7845135">if</span>&nbsp;<span class="ident" id="7845138">b</span>&nbsp;<span class="op" id="7845140">==</span>&nbsp;<span class="num" id="7845143">0</span>&nbsp;<span class="op" id="7845145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7845150">t</span><span class="op" id="7845151">.</span><span class="ident" id="7845152">Errorf</span><span class="op" id="7845158">(</span><span class="string" id="7845159">&#34;Zero&nbsp;octet&nbsp;found&#34;</span><span class="op" id="7845177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7845182">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7845191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7845194">}</span><br>
<span class="lineno">155</span><span class="op" id="7845196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7845199">type</span>&nbsp;<span class="ident" id="7845204">signPKCS1v15Test</span>&nbsp;<span class="keyword" id="7845221">struct</span>&nbsp;<span class="op" id="7845228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7845231">in</span><span class="op" id="7845233">,</span>&nbsp;<span class="ident" id="7845235">out</span>&nbsp;<span class="builtintype" id="7845239">string</span><br>
<span class="lineno"></span><span class="op" id="7845246">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="comment" id="7845249">//&nbsp;These&nbsp;vectors&nbsp;have&nbsp;been&nbsp;tested&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="7845288">//&nbsp;&nbsp;&nbsp;`openssl&nbsp;rsautl&nbsp;-verify&nbsp;-inkey&nbsp;pk&nbsp;-in&nbsp;signature&nbsp;|&nbsp;hexdump&nbsp;-C`</span><br>
<span class="lineno"></span><span class="keyword" id="7845355">var</span>&nbsp;<span class="ident" id="7845359">signPKCS1v15Tests</span>&nbsp;<span class="op" id="7845377">=</span>&nbsp;<span class="op" id="7845379">[</span><span class="op" id="7845380">]</span><span class="ident" id="7845381">signPKCS1v15Test</span><span class="op" id="7845397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7845400">{</span><span class="string" id="7845401">&#34;Test.\n&#34;</span><span class="op" id="7845410">,</span>&nbsp;<span class="string" id="7845412">&#34;a4f3fa6ea93bcdd0c57be020c1193ecbfd6f200a3d95c409769b029578fa0e336ad9a347600e40d3ae823b8c7e6bad88cc07c1d54c3a1523cbbb6d58efc362ae&#34;</span><span class="op" id="7845542">}</span><span class="op" id="7845543">,</span><br>
<span class="lineno">165</span><span class="op" id="7845545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7845548">func</span>&nbsp;<span class="ident" id="7845553">TestSignPKCS1v15</span><span class="op" id="7845569">(</span><span class="ident" id="7845570">t</span>&nbsp;<span class="op" id="7845572">*</span><span class="ident" id="7845573">testing</span><span class="op" id="7845580">.</span><span class="ident" id="7845581">T</span><span class="op" id="7845582">)</span>&nbsp;<span class="op" id="7845584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7845587">for</span>&nbsp;<span class="ident" id="7845591">i</span><span class="op" id="7845592">,</span>&nbsp;<span class="ident" id="7845594">test</span>&nbsp;<span class="op" id="7845599">:=</span>&nbsp;<span class="keyword" id="7845602">range</span>&nbsp;<span class="ident" id="7845608">signPKCS1v15Tests</span>&nbsp;<span class="op" id="7845626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7845630">h</span>&nbsp;<span class="op" id="7845632">:=</span>&nbsp;<span class="ident" id="7845635">sha1</span><span class="op" id="7845639">.</span><span class="ident" id="7845640">New</span><span class="op" id="7845643">(</span><span class="op" id="7845644">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7845648">h</span><span class="op" id="7845649">.</span><span class="ident" id="7845650">Write</span><span class="op" id="7845655">(</span><span class="op" id="7845656">[</span><span class="op" id="7845657">]</span><span class="builtintype" id="7845658">byte</span><span class="op" id="7845662">(</span><span class="ident" id="7845663">test</span><span class="op" id="7845667">.</span><span class="ident" id="7845668">in</span><span class="op" id="7845670">)</span><span class="op" id="7845671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7845675">digest</span>&nbsp;<span class="op" id="7845682">:=</span>&nbsp;<span class="ident" id="7845685">h</span><span class="op" id="7845686">.</span><span class="ident" id="7845687">Sum</span><span class="op" id="7845690">(</span><span class="ident" id="7845691">nil</span><span class="op" id="7845694">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7845699">s</span><span class="op" id="7845700">,</span>&nbsp;<span class="ident" id="7845702">err</span>&nbsp;<span class="op" id="7845706">:=</span>&nbsp;<span class="ident" id="7845709">SignPKCS1v15</span><span class="op" id="7845721">(</span><span class="ident" id="7845722">nil</span><span class="op" id="7845725">,</span>&nbsp;<span class="ident" id="7845727">rsaPrivateKey</span><span class="op" id="7845740">,</span>&nbsp;<span class="ident" id="7845742">crypto</span><span class="op" id="7845748">.</span><span class="ident" id="7845749">SHA1</span><span class="op" id="7845753">,</span>&nbsp;<span class="ident" id="7845755">digest</span><span class="op" id="7845761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7845765">if</span>&nbsp;<span class="ident" id="7845768">err</span>&nbsp;<span class="op" id="7845772">!=</span>&nbsp;<span class="ident" id="7845775">nil</span>&nbsp;<span class="op" id="7845779">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7845784">t</span><span class="op" id="7845785">.</span><span class="ident" id="7845786">Errorf</span><span class="op" id="7845792">(</span><span class="string" id="7845793">&#34;#%d&nbsp;%s&#34;</span><span class="op" id="7845801">,</span>&nbsp;<span class="ident" id="7845803">i</span><span class="op" id="7845804">,</span>&nbsp;<span class="ident" id="7845806">err</span><span class="op" id="7845809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7845813">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7845818">expected</span><span class="op" id="7845826">,</span>&nbsp;<span class="ident" id="7845828">_</span>&nbsp;<span class="op" id="7845830">:=</span>&nbsp;<span class="ident" id="7845833">hex</span><span class="op" id="7845836">.</span><span class="ident" id="7845837">DecodeString</span><span class="op" id="7845849">(</span><span class="ident" id="7845850">test</span><span class="op" id="7845854">.</span><span class="ident" id="7845855">out</span><span class="op" id="7845858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7845862">if</span>&nbsp;<span class="op" id="7845865">!</span><span class="ident" id="7845866">bytes</span><span class="op" id="7845871">.</span><span class="ident" id="7845872">Equal</span><span class="op" id="7845877">(</span><span class="ident" id="7845878">s</span><span class="op" id="7845879">,</span>&nbsp;<span class="ident" id="7845881">expected</span><span class="op" id="7845889">)</span>&nbsp;<span class="op" id="7845891">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7845896">t</span><span class="op" id="7845897">.</span><span class="ident" id="7845898">Errorf</span><span class="op" id="7845904">(</span><span class="string" id="7845905">&#34;#%d&nbsp;got:&nbsp;%x&nbsp;want:&nbsp;%x&#34;</span><span class="op" id="7845927">,</span>&nbsp;<span class="ident" id="7845929">i</span><span class="op" id="7845930">,</span>&nbsp;<span class="ident" id="7845932">s</span><span class="op" id="7845933">,</span>&nbsp;<span class="ident" id="7845935">expected</span><span class="op" id="7845943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7845947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7845950">}</span><br>
<span class="lineno"></span><span class="op" id="7845952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="7845955">func</span>&nbsp;<span class="ident" id="7845960">TestVerifyPKCS1v15</span><span class="op" id="7845978">(</span><span class="ident" id="7845979">t</span>&nbsp;<span class="op" id="7845981">*</span><span class="ident" id="7845982">testing</span><span class="op" id="7845989">.</span><span class="ident" id="7845990">T</span><span class="op" id="7845991">)</span>&nbsp;<span class="op" id="7845993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7845996">for</span>&nbsp;<span class="ident" id="7846000">i</span><span class="op" id="7846001">,</span>&nbsp;<span class="ident" id="7846003">test</span>&nbsp;<span class="op" id="7846008">:=</span>&nbsp;<span class="keyword" id="7846011">range</span>&nbsp;<span class="ident" id="7846017">signPKCS1v15Tests</span>&nbsp;<span class="op" id="7846035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7846039">h</span>&nbsp;<span class="op" id="7846041">:=</span>&nbsp;<span class="ident" id="7846044">sha1</span><span class="op" id="7846048">.</span><span class="ident" id="7846049">New</span><span class="op" id="7846052">(</span><span class="op" id="7846053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7846057">h</span><span class="op" id="7846058">.</span><span class="ident" id="7846059">Write</span><span class="op" id="7846064">(</span><span class="op" id="7846065">[</span><span class="op" id="7846066">]</span><span class="builtintype" id="7846067">byte</span><span class="op" id="7846071">(</span><span class="ident" id="7846072">test</span><span class="op" id="7846076">.</span><span class="ident" id="7846077">in</span><span class="op" id="7846079">)</span><span class="op" id="7846080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7846084">digest</span>&nbsp;<span class="op" id="7846091">:=</span>&nbsp;<span class="ident" id="7846094">h</span><span class="op" id="7846095">.</span><span class="ident" id="7846096">Sum</span><span class="op" id="7846099">(</span><span class="ident" id="7846100">nil</span><span class="op" id="7846103">)</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7846108">sig</span><span class="op" id="7846111">,</span>&nbsp;<span class="ident" id="7846113">_</span>&nbsp;<span class="op" id="7846115">:=</span>&nbsp;<span class="ident" id="7846118">hex</span><span class="op" id="7846121">.</span><span class="ident" id="7846122">DecodeString</span><span class="op" id="7846134">(</span><span class="ident" id="7846135">test</span><span class="op" id="7846139">.</span><span class="ident" id="7846140">out</span><span class="op" id="7846143">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7846148">err</span>&nbsp;<span class="op" id="7846152">:=</span>&nbsp;<span class="ident" id="7846155">VerifyPKCS1v15</span><span class="op" id="7846169">(</span><span class="op" id="7846170">&amp;</span><span class="ident" id="7846171">rsaPrivateKey</span><span class="op" id="7846184">.</span><span class="ident" id="7846185">PublicKey</span><span class="op" id="7846194">,</span>&nbsp;<span class="ident" id="7846196">crypto</span><span class="op" id="7846202">.</span><span class="ident" id="7846203">SHA1</span><span class="op" id="7846207">,</span>&nbsp;<span class="ident" id="7846209">digest</span><span class="op" id="7846215">,</span>&nbsp;<span class="ident" id="7846217">sig</span><span class="op" id="7846220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7846224">if</span>&nbsp;<span class="ident" id="7846227">err</span>&nbsp;<span class="op" id="7846231">!=</span>&nbsp;<span class="ident" id="7846234">nil</span>&nbsp;<span class="op" id="7846238">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7846243">t</span><span class="op" id="7846244">.</span><span class="ident" id="7846245">Errorf</span><span class="op" id="7846251">(</span><span class="string" id="7846252">&#34;#%d&nbsp;%s&#34;</span><span class="op" id="7846260">,</span>&nbsp;<span class="ident" id="7846262">i</span><span class="op" id="7846263">,</span>&nbsp;<span class="ident" id="7846265">err</span><span class="op" id="7846268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7846272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7846275">}</span><br>
<span class="lineno"></span><span class="op" id="7846277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="7846280">func</span>&nbsp;<span class="ident" id="7846285">TestOverlongMessagePKCS1v15</span><span class="op" id="7846312">(</span><span class="ident" id="7846313">t</span>&nbsp;<span class="op" id="7846315">*</span><span class="ident" id="7846316">testing</span><span class="op" id="7846323">.</span><span class="ident" id="7846324">T</span><span class="op" id="7846325">)</span>&nbsp;<span class="op" id="7846327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7846330">ciphertext</span>&nbsp;<span class="op" id="7846341">:=</span>&nbsp;<span class="ident" id="7846344">decodeBase64</span><span class="op" id="7846356">(</span><span class="string" id="7846357">&#34;fjOVdirUzFoLlukv80dBllMLjXythIf22feqPrNo0YoIjzyzyoMFiLjAc/Y4krkeZ11XFThIrEvw\nkRiZcCq5ng==&#34;</span><span class="op" id="7846449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7846452">_</span><span class="op" id="7846453">,</span>&nbsp;<span class="ident" id="7846455">err</span>&nbsp;<span class="op" id="7846459">:=</span>&nbsp;<span class="ident" id="7846462">DecryptPKCS1v15</span><span class="op" id="7846477">(</span><span class="ident" id="7846478">nil</span><span class="op" id="7846481">,</span>&nbsp;<span class="ident" id="7846483">rsaPrivateKey</span><span class="op" id="7846496">,</span>&nbsp;<span class="ident" id="7846498">ciphertext</span><span class="op" id="7846508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7846511">if</span>&nbsp;<span class="ident" id="7846514">err</span>&nbsp;<span class="op" id="7846518">==</span>&nbsp;<span class="ident" id="7846521">nil</span>&nbsp;<span class="op" id="7846525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7846529">t</span><span class="op" id="7846530">.</span><span class="ident" id="7846531">Error</span><span class="op" id="7846536">(</span><span class="string" id="7846537">&#34;RSA&nbsp;decrypted&nbsp;a&nbsp;message&nbsp;that&nbsp;was&nbsp;too&nbsp;long.&#34;</span><span class="op" id="7846581">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7846584">}</span><br>
<span class="lineno"></span><span class="op" id="7846586">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7846589">func</span>&nbsp;<span class="ident" id="7846594">TestUnpaddedSignature</span><span class="op" id="7846615">(</span><span class="ident" id="7846616">t</span>&nbsp;<span class="op" id="7846618">*</span><span class="ident" id="7846619">testing</span><span class="op" id="7846626">.</span><span class="ident" id="7846627">T</span><span class="op" id="7846628">)</span>&nbsp;<span class="op" id="7846630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7846633">msg</span>&nbsp;<span class="op" id="7846637">:=</span>&nbsp;<span class="op" id="7846640">[</span><span class="op" id="7846641">]</span><span class="builtintype" id="7846642">byte</span><span class="op" id="7846646">(</span><span class="string" id="7846647">&#34;Thu&nbsp;Dec&nbsp;19&nbsp;18:06:16&nbsp;EST&nbsp;2013\n&#34;</span><span class="op" id="7846679">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7846682">//&nbsp;This&nbsp;base64&nbsp;value&nbsp;was&nbsp;generated&nbsp;with:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7846724">//&nbsp;%&nbsp;echo&nbsp;Thu&nbsp;Dec&nbsp;19&nbsp;18:06:16&nbsp;EST&nbsp;2013&nbsp;&gt;&nbsp;/tmp/msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7846775">//&nbsp;%&nbsp;openssl&nbsp;rsautl&nbsp;-sign&nbsp;-inkey&nbsp;key&nbsp;-out&nbsp;/tmp/sig&nbsp;-in&nbsp;/tmp/msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7846840">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7846844">//&nbsp;Where&nbsp;&#34;key&#34;&nbsp;contains&nbsp;the&nbsp;RSA&nbsp;private&nbsp;key&nbsp;given&nbsp;at&nbsp;the&nbsp;bottom&nbsp;of&nbsp;this</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7846917">//&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7846927">expectedSig</span>&nbsp;<span class="op" id="7846939">:=</span>&nbsp;<span class="ident" id="7846942">decodeBase64</span><span class="op" id="7846954">(</span><span class="string" id="7846955">&#34;pX4DR8azytjdQ1rtUiC040FjkepuQut5q2ZFX1pTjBrOVKNjgsCDyiJDGZTCNoh9qpXYbhl7iEym30BWWwuiZg==&#34;</span><span class="op" id="7847045">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7847049">sig</span><span class="op" id="7847052">,</span>&nbsp;<span class="ident" id="7847054">err</span>&nbsp;<span class="op" id="7847058">:=</span>&nbsp;<span class="ident" id="7847061">SignPKCS1v15</span><span class="op" id="7847073">(</span><span class="ident" id="7847074">nil</span><span class="op" id="7847077">,</span>&nbsp;<span class="ident" id="7847079">rsaPrivateKey</span><span class="op" id="7847092">,</span>&nbsp;<span class="ident" id="7847094">crypto</span><span class="op" id="7847100">.</span><span class="ident" id="7847101">Hash</span><span class="op" id="7847105">(</span><span class="num" id="7847106">0</span><span class="op" id="7847107">)</span><span class="op" id="7847108">,</span>&nbsp;<span class="ident" id="7847110">msg</span><span class="op" id="7847113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7847116">if</span>&nbsp;<span class="ident" id="7847119">err</span>&nbsp;<span class="op" id="7847123">!=</span>&nbsp;<span class="ident" id="7847126">nil</span>&nbsp;<span class="op" id="7847130">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7847134">t</span><span class="op" id="7847135">.</span><span class="ident" id="7847136">Fatalf</span><span class="op" id="7847142">(</span><span class="string" id="7847143">&#34;SignPKCS1v15&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="7847168">,</span>&nbsp;<span class="ident" id="7847170">err</span><span class="op" id="7847173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7847176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7847179">if</span>&nbsp;<span class="op" id="7847182">!</span><span class="ident" id="7847183">bytes</span><span class="op" id="7847188">.</span><span class="ident" id="7847189">Equal</span><span class="op" id="7847194">(</span><span class="ident" id="7847195">sig</span><span class="op" id="7847198">,</span>&nbsp;<span class="ident" id="7847200">expectedSig</span><span class="op" id="7847211">)</span>&nbsp;<span class="op" id="7847213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7847217">t</span><span class="op" id="7847218">.</span><span class="ident" id="7847219">Fatalf</span><span class="op" id="7847225">(</span><span class="string" id="7847226">&#34;signature&nbsp;is&nbsp;not&nbsp;expected&nbsp;value:&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="7847276">,</span>&nbsp;<span class="ident" id="7847278">sig</span><span class="op" id="7847281">,</span>&nbsp;<span class="ident" id="7847283">expectedSig</span><span class="op" id="7847294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7847297">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7847300">if</span>&nbsp;<span class="ident" id="7847303">err</span>&nbsp;<span class="op" id="7847307">:=</span>&nbsp;<span class="ident" id="7847310">VerifyPKCS1v15</span><span class="op" id="7847324">(</span><span class="op" id="7847325">&amp;</span><span class="ident" id="7847326">rsaPrivateKey</span><span class="op" id="7847339">.</span><span class="ident" id="7847340">PublicKey</span><span class="op" id="7847349">,</span>&nbsp;<span class="ident" id="7847351">crypto</span><span class="op" id="7847357">.</span><span class="ident" id="7847358">Hash</span><span class="op" id="7847362">(</span><span class="num" id="7847363">0</span><span class="op" id="7847364">)</span><span class="op" id="7847365">,</span>&nbsp;<span class="ident" id="7847367">msg</span><span class="op" id="7847370">,</span>&nbsp;<span class="ident" id="7847372">sig</span><span class="op" id="7847375">)</span><span class="op" id="7847376">;</span>&nbsp;<span class="ident" id="7847378">err</span>&nbsp;<span class="op" id="7847382">!=</span>&nbsp;<span class="ident" id="7847385">nil</span>&nbsp;<span class="op" id="7847389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7847393">t</span><span class="op" id="7847394">.</span><span class="ident" id="7847395">Fatalf</span><span class="op" id="7847401">(</span><span class="string" id="7847402">&#34;signature&nbsp;failed&nbsp;to&nbsp;verify:&nbsp;%s&#34;</span><span class="op" id="7847434">,</span>&nbsp;<span class="ident" id="7847436">err</span><span class="op" id="7847439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7847442">}</span><br>
<span class="lineno"></span><span class="op" id="7847444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="keyword" id="7847447">func</span>&nbsp;<span class="ident" id="7847452">TestShortSessionKey</span><span class="op" id="7847471">(</span><span class="ident" id="7847472">t</span>&nbsp;<span class="op" id="7847474">*</span><span class="ident" id="7847475">testing</span><span class="op" id="7847482">.</span><span class="ident" id="7847483">T</span><span class="op" id="7847484">)</span>&nbsp;<span class="op" id="7847486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7847489">//&nbsp;This&nbsp;tests&nbsp;that&nbsp;attempting&nbsp;to&nbsp;decrypt&nbsp;a&nbsp;session&nbsp;key&nbsp;where&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7847555">//&nbsp;ciphertext&nbsp;is&nbsp;too&nbsp;small&nbsp;doesn&#39;t&nbsp;run&nbsp;outside&nbsp;the&nbsp;array&nbsp;bounds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7847621">ciphertext</span><span class="op" id="7847631">,</span>&nbsp;<span class="ident" id="7847633">err</span>&nbsp;<span class="op" id="7847637">:=</span>&nbsp;<span class="ident" id="7847640">EncryptPKCS1v15</span><span class="op" id="7847655">(</span><span class="ident" id="7847656">rand</span><span class="op" id="7847660">.</span><span class="ident" id="7847661">Reader</span><span class="op" id="7847667">,</span>&nbsp;<span class="op" id="7847669">&amp;</span><span class="ident" id="7847670">rsaPrivateKey</span><span class="op" id="7847683">.</span><span class="ident" id="7847684">PublicKey</span><span class="op" id="7847693">,</span>&nbsp;<span class="op" id="7847695">[</span><span class="op" id="7847696">]</span><span class="builtintype" id="7847697">byte</span><span class="op" id="7847701">{</span><span class="num" id="7847702">1</span><span class="op" id="7847703">}</span><span class="op" id="7847704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7847707">if</span>&nbsp;<span class="ident" id="7847710">err</span>&nbsp;<span class="op" id="7847714">!=</span>&nbsp;<span class="ident" id="7847717">nil</span>&nbsp;<span class="op" id="7847721">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7847725">t</span><span class="op" id="7847726">.</span><span class="ident" id="7847727">Fatalf</span><span class="op" id="7847733">(</span><span class="string" id="7847734">&#34;Failed&nbsp;to&nbsp;encrypt&nbsp;short&nbsp;message:&nbsp;%s&#34;</span><span class="op" id="7847771">,</span>&nbsp;<span class="ident" id="7847773">err</span><span class="op" id="7847776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7847779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7847783">var</span>&nbsp;<span class="ident" id="7847787">key</span>&nbsp;<span class="op" id="7847791">[</span><span class="num" id="7847792">32</span><span class="op" id="7847794">]</span><span class="builtintype" id="7847795">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7847801">if</span>&nbsp;<span class="ident" id="7847804">err</span>&nbsp;<span class="op" id="7847808">:=</span>&nbsp;<span class="ident" id="7847811">DecryptPKCS1v15SessionKey</span><span class="op" id="7847836">(</span><span class="ident" id="7847837">nil</span><span class="op" id="7847840">,</span>&nbsp;<span class="ident" id="7847842">rsaPrivateKey</span><span class="op" id="7847855">,</span>&nbsp;<span class="ident" id="7847857">ciphertext</span><span class="op" id="7847867">,</span>&nbsp;<span class="ident" id="7847869">key</span><span class="op" id="7847872">[</span><span class="op" id="7847873">:</span><span class="op" id="7847874">]</span><span class="op" id="7847875">)</span><span class="op" id="7847876">;</span>&nbsp;<span class="ident" id="7847878">err</span>&nbsp;<span class="op" id="7847882">!=</span>&nbsp;<span class="ident" id="7847885">nil</span>&nbsp;<span class="op" id="7847889">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7847893">t</span><span class="op" id="7847894">.</span><span class="ident" id="7847895">Fatalf</span><span class="op" id="7847901">(</span><span class="string" id="7847902">&#34;Failed&nbsp;to&nbsp;decrypt&nbsp;short&nbsp;message:&nbsp;%s&#34;</span><span class="op" id="7847939">,</span>&nbsp;<span class="ident" id="7847941">err</span><span class="op" id="7847944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7847947">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7847951">for</span>&nbsp;<span class="ident" id="7847955">_</span><span class="op" id="7847956">,</span>&nbsp;<span class="ident" id="7847958">v</span>&nbsp;<span class="op" id="7847960">:=</span>&nbsp;<span class="keyword" id="7847963">range</span>&nbsp;<span class="ident" id="7847969">key</span>&nbsp;<span class="op" id="7847973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7847977">if</span>&nbsp;<span class="ident" id="7847980">v</span>&nbsp;<span class="op" id="7847982">!=</span>&nbsp;<span class="num" id="7847985">0</span>&nbsp;<span class="op" id="7847987">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7847992">t</span><span class="op" id="7847993">.</span><span class="ident" id="7847994">Fatal</span><span class="op" id="7847999">(</span><span class="string" id="7848000">&#34;key&nbsp;was&nbsp;modified&nbsp;when&nbsp;ciphertext&nbsp;was&nbsp;invalid&#34;</span><span class="op" id="7848046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7848050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7848053">}</span><br>
<span class="lineno"></span><span class="op" id="7848055">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="7848058">//&nbsp;In&nbsp;order&nbsp;to&nbsp;generate&nbsp;new&nbsp;test&nbsp;vectors&nbsp;you&#39;ll&nbsp;need&nbsp;the&nbsp;PEM&nbsp;form&nbsp;of&nbsp;this&nbsp;key:</span><br>
<span class="lineno"></span><span class="comment" id="7848137">//&nbsp;-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----</span><br>
<span class="lineno"></span><span class="comment" id="7848172">//&nbsp;MIIBOgIBAAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0</span><br>
<span class="lineno"></span><span class="comment" id="7848240">//&nbsp;fd7Ai2KW5ToIwzFofvJcS/STa6HA5gQenRUCAwEAAQJBAIq9amn00aS0h/CrjXqu</span><br>
<span class="lineno"></span><span class="comment" id="7848308">//&nbsp;/ThglAXJmZhOMPVn4eiu7/ROixi9sex436MaVeMqSNf7Ex9a8fRNfWss7Sqd9eWu</span><br>
<span class="lineno">255</span><span class="comment" id="7848376">//&nbsp;RTUCIQDasvGASLqmjeffBNLTXV2A5g4t+kLVCpsEIZAycV5GswIhANEPLmax0ME/</span><br>
<span class="lineno"></span><span class="comment" id="7848444">//&nbsp;EO+ZJ79TJKN5yiGBRsv5yvx5UiHxajEXAiAhAol5N4EUyq6I9w1rYdhPMGpLfk7A</span><br>
<span class="lineno"></span><span class="comment" id="7848512">//&nbsp;IU2snfRJ6Nq2CQIgFrPsWRCkV+gOYcajD17rEqmuLrdIRexpg8N1DOSXoJ8CIGlS</span><br>
<span class="lineno"></span><span class="comment" id="7848580">//&nbsp;tAboUGBxTDq3ZroNism3DaMIbKPyYrAqhKov1h5V</span><br>
<span class="lineno"></span><span class="comment" id="7848624">//&nbsp;-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="7848658">var</span>&nbsp;<span class="ident" id="7848662">rsaPrivateKey</span>&nbsp;<span class="op" id="7848676">=</span>&nbsp;<span class="op" id="7848678">&amp;</span><span class="ident" id="7848679">PrivateKey</span><span class="op" id="7848689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7848692">PublicKey</span><span class="op" id="7848701">:</span>&nbsp;<span class="ident" id="7848703">PublicKey</span><span class="op" id="7848712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7848716">N</span><span class="op" id="7848717">:</span>&nbsp;<span class="ident" id="7848719">fromBase10</span><span class="op" id="7848729">(</span><span class="string" id="7848730">&#34;9353930466774385905609975137998169297361893554149986716853295022578535724979677252958524466350471210367835187480748268864277464700638583474144061408845077&#34;</span><span class="op" id="7848886">)</span><span class="op" id="7848887">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7848891">E</span><span class="op" id="7848892">:</span>&nbsp;<span class="num" id="7848894">65537</span><span class="op" id="7848899">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7848902">}</span><span class="op" id="7848903">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7848906">D</span><span class="op" id="7848907">:</span>&nbsp;<span class="ident" id="7848909">fromBase10</span><span class="op" id="7848919">(</span><span class="string" id="7848920">&#34;7266398431328116344057699379749222532279343923819063639497049039389899328538543087657733766554155839834519529439851673014800261285757759040931985506583861&#34;</span><span class="op" id="7849076">)</span><span class="op" id="7849077">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7849080">Primes</span><span class="op" id="7849086">:</span>&nbsp;<span class="op" id="7849088">[</span><span class="op" id="7849089">]</span><span class="op" id="7849090">*</span><span class="ident" id="7849091">big</span><span class="op" id="7849094">.</span><span class="ident" id="7849095">Int</span><span class="op" id="7849098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7849102">fromBase10</span><span class="op" id="7849112">(</span><span class="string" id="7849113">&#34;98920366548084643601728869055592650835572950932266967461790948584315647051443&#34;</span><span class="op" id="7849192">)</span><span class="op" id="7849193">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7849197">fromBase10</span><span class="op" id="7849207">(</span><span class="string" id="7849208">&#34;94560208308847015747498523884063394671606671904944666360068158221458669711639&#34;</span><span class="op" id="7849287">)</span><span class="op" id="7849288">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7849291">}</span><span class="op" id="7849292">,</span><br>
<span class="lineno"></span><span class="op" id="7849294">}</span>
</div>
</body>
</html>
