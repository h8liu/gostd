<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os</h2>
<ul>
<li><a href="/gostd/os/dir_unix.go.html">dir_unix.go</a></li>
<li><a href="/gostd/os/doc.go.html">doc.go</a></li>
<li><a href="/gostd/os/env.go.html">env.go</a></li>
<li><a href="/gostd/os/env_test.go.html">env_test.go</a></li>
<li><a href="/gostd/os/env_unix_test.go.html">env_unix_test.go</a></li>
<li><a href="/gostd/os/error.go.html">error.go</a></li>
<li><a href="/gostd/os/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/os/error_unix.go.html">error_unix.go</a></li>
<li><a href="/gostd/os/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec_posix.go.html">exec_posix.go</a></li>
<li><a href="/gostd/os/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/os/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/os/file.go.html">file.go</a></li>
<li><a href="/gostd/os/file_posix.go.html">file_posix.go</a></li>
<li><a href="/gostd/os/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/os/getwd.go.html">getwd.go</a></li>
<li><a href="/gostd/os/os_test.go.html">os_test.go</a></li>
<li><a href="/gostd/os/os_unix_test.go.html">os_unix_test.go</a></li>
<li><a href="/gostd/os/path.go.html">path.go</a></li>
<li><a href="/gostd/os/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/os/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/os/pipe_linux.go.html">pipe_linux.go</a></li>
<li><a href="/gostd/os/proc.go.html">proc.go</a></li>
<li><a href="/gostd/os/stat_linux.go.html">stat_linux.go</a></li>
<li><a href="/gostd/os/sys_linux.go.html">sys_linux.go</a></li>
<li><a href="/gostd/os/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/os/types.go.html">types.go</a></li>
<li><a href="/gostd/os/types_notwin.go.html">types_notwin.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2530764">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2530820">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2530874">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2530925">//&nbsp;General&nbsp;environment&nbsp;variables.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2530960">package</span>&nbsp;<span class="ident" id="2530968">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2530972">import</span>&nbsp;<span class="string" id="2530979">&#34;syscall&#34;</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2530990">//&nbsp;Expand&nbsp;replaces&nbsp;${var}&nbsp;or&nbsp;$var&nbsp;in&nbsp;the&nbsp;string&nbsp;based&nbsp;on&nbsp;the&nbsp;mapping&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="2531069">//&nbsp;For&nbsp;example,&nbsp;os.ExpandEnv(s)&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;os.Expand(s,&nbsp;os.Getenv).</span><br>
<span class="lineno"></span><span class="keyword" id="2531143">func</span>&nbsp;<span class="ident" id="2531148">Expand</span><span class="op" id="2531154">(</span><span class="ident" id="2531155">s</span>&nbsp;<span class="builtintype" id="2531157">string</span><span class="op" id="2531163">,</span>&nbsp;<span class="ident" id="2531165">mapping</span>&nbsp;<span class="keyword" id="2531173">func</span><span class="op" id="2531177">(</span><span class="builtintype" id="2531178">string</span><span class="op" id="2531184">)</span>&nbsp;<span class="builtintype" id="2531186">string</span><span class="op" id="2531192">)</span>&nbsp;<span class="builtintype" id="2531194">string</span>&nbsp;<span class="op" id="2531201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2531204">buf</span>&nbsp;<span class="op" id="2531208">:=</span>&nbsp;<span class="builtinfunc" id="2531211">make</span><span class="op" id="2531215">(</span><span class="op" id="2531216">[</span><span class="op" id="2531217">]</span><span class="builtintype" id="2531218">byte</span><span class="op" id="2531222">,</span>&nbsp;<span class="num" id="2531224">0</span><span class="op" id="2531225">,</span>&nbsp;<span class="num" id="2531227">2</span><span class="op" id="2531228">*</span><span class="builtinfunc" id="2531229">len</span><span class="op" id="2531232">(</span><span class="ident" id="2531233">s</span><span class="op" id="2531234">)</span><span class="op" id="2531235">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2531238">//&nbsp;${}&nbsp;is&nbsp;all&nbsp;ASCII,&nbsp;so&nbsp;bytes&nbsp;are&nbsp;fine&nbsp;for&nbsp;this&nbsp;operation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2531298">i</span>&nbsp;<span class="op" id="2531300">:=</span>&nbsp;<span class="num" id="2531303">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531306">for</span>&nbsp;<span class="ident" id="2531310">j</span>&nbsp;<span class="op" id="2531312">:=</span>&nbsp;<span class="num" id="2531315">0</span><span class="op" id="2531316">;</span>&nbsp;<span class="ident" id="2531318">j</span>&nbsp;<span class="op" id="2531320">&lt;</span>&nbsp;<span class="builtinfunc" id="2531322">len</span><span class="op" id="2531325">(</span><span class="ident" id="2531326">s</span><span class="op" id="2531327">)</span><span class="op" id="2531328">;</span>&nbsp;<span class="ident" id="2531330">j</span><span class="op" id="2531331">++</span>&nbsp;<span class="op" id="2531334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531338">if</span>&nbsp;<span class="ident" id="2531341">s</span><span class="op" id="2531342">[</span><span class="ident" id="2531343">j</span><span class="op" id="2531344">]</span>&nbsp;<span class="op" id="2531346">==</span>&nbsp;<span class="string" id="2531349">&#39;$&#39;</span>&nbsp;<span class="op" id="2531353">&amp;&amp;</span>&nbsp;<span class="ident" id="2531356">j</span><span class="op" id="2531357">+</span><span class="num" id="2531358">1</span>&nbsp;<span class="op" id="2531360">&lt;</span>&nbsp;<span class="builtinfunc" id="2531362">len</span><span class="op" id="2531365">(</span><span class="ident" id="2531366">s</span><span class="op" id="2531367">)</span>&nbsp;<span class="op" id="2531369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2531374">buf</span>&nbsp;<span class="op" id="2531378">=</span>&nbsp;<span class="builtinfunc" id="2531380">append</span><span class="op" id="2531386">(</span><span class="ident" id="2531387">buf</span><span class="op" id="2531390">,</span>&nbsp;<span class="ident" id="2531392">s</span><span class="op" id="2531393">[</span><span class="ident" id="2531394">i</span><span class="op" id="2531395">:</span><span class="ident" id="2531396">j</span><span class="op" id="2531397">]</span><span class="op" id="2531398">...</span><span class="op" id="2531401">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2531406">name</span><span class="op" id="2531410">,</span>&nbsp;<span class="ident" id="2531412">w</span>&nbsp;<span class="op" id="2531414">:=</span>&nbsp;<span class="ident" id="2531417">getShellName</span><span class="op" id="2531429">(</span><span class="ident" id="2531430">s</span><span class="op" id="2531431">[</span><span class="ident" id="2531432">j</span><span class="op" id="2531433">+</span><span class="num" id="2531434">1</span><span class="op" id="2531435">:</span><span class="op" id="2531436">]</span><span class="op" id="2531437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2531442">buf</span>&nbsp;<span class="op" id="2531446">=</span>&nbsp;<span class="builtinfunc" id="2531448">append</span><span class="op" id="2531454">(</span><span class="ident" id="2531455">buf</span><span class="op" id="2531458">,</span>&nbsp;<span class="ident" id="2531460">mapping</span><span class="op" id="2531467">(</span><span class="ident" id="2531468">name</span><span class="op" id="2531472">)</span><span class="op" id="2531473">...</span><span class="op" id="2531476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2531481">j</span>&nbsp;<span class="op" id="2531483">+=</span>&nbsp;<span class="ident" id="2531486">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2531491">i</span>&nbsp;<span class="op" id="2531493">=</span>&nbsp;<span class="ident" id="2531495">j</span>&nbsp;<span class="op" id="2531497">+</span>&nbsp;<span class="num" id="2531499">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2531503">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2531506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531509">return</span>&nbsp;<span class="builtintype" id="2531516">string</span><span class="op" id="2531522">(</span><span class="ident" id="2531523">buf</span><span class="op" id="2531526">)</span>&nbsp;<span class="op" id="2531528">+</span>&nbsp;<span class="ident" id="2531530">s</span><span class="op" id="2531531">[</span><span class="ident" id="2531532">i</span><span class="op" id="2531533">:</span><span class="op" id="2531534">]</span><br>
<span class="lineno"></span><span class="op" id="2531536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2531539">//&nbsp;ExpandEnv&nbsp;replaces&nbsp;${var}&nbsp;or&nbsp;$var&nbsp;in&nbsp;the&nbsp;string&nbsp;according&nbsp;to&nbsp;the&nbsp;values</span><br>
<span class="lineno">30</span><span class="comment" id="2531614">//&nbsp;of&nbsp;the&nbsp;current&nbsp;environment&nbsp;variables.&nbsp;&nbsp;References&nbsp;to&nbsp;undefined</span><br>
<span class="lineno"></span><span class="comment" id="2531680">//&nbsp;variables&nbsp;are&nbsp;replaced&nbsp;by&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2531727">func</span>&nbsp;<span class="ident" id="2531732">ExpandEnv</span><span class="op" id="2531741">(</span><span class="ident" id="2531742">s</span>&nbsp;<span class="builtintype" id="2531744">string</span><span class="op" id="2531750">)</span>&nbsp;<span class="builtintype" id="2531752">string</span>&nbsp;<span class="op" id="2531759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531762">return</span>&nbsp;<span class="ident" id="2531769">Expand</span><span class="op" id="2531775">(</span><span class="ident" id="2531776">s</span><span class="op" id="2531777">,</span>&nbsp;<span class="ident" id="2531779">Getenv</span><span class="op" id="2531785">)</span><br>
<span class="lineno"></span><span class="op" id="2531787">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="2531790">//&nbsp;isSpellSpecialVar&nbsp;reports&nbsp;whether&nbsp;the&nbsp;character&nbsp;identifies&nbsp;a&nbsp;special</span><br>
<span class="lineno"></span><span class="comment" id="2531862">//&nbsp;shell&nbsp;variable&nbsp;such&nbsp;as&nbsp;$*.</span><br>
<span class="lineno"></span><span class="keyword" id="2531892">func</span>&nbsp;<span class="ident" id="2531897">isShellSpecialVar</span><span class="op" id="2531914">(</span><span class="ident" id="2531915">c</span>&nbsp;<span class="builtintype" id="2531917">uint8</span><span class="op" id="2531922">)</span>&nbsp;<span class="builtintype" id="2531924">bool</span>&nbsp;<span class="op" id="2531929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531932">switch</span>&nbsp;<span class="ident" id="2531939">c</span>&nbsp;<span class="op" id="2531941">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531944">case</span>&nbsp;<span class="string" id="2531949">&#39;*&#39;</span><span class="op" id="2531952">,</span>&nbsp;<span class="string" id="2531954">&#39;#&#39;</span><span class="op" id="2531957">,</span>&nbsp;<span class="string" id="2531959">&#39;$&#39;</span><span class="op" id="2531962">,</span>&nbsp;<span class="string" id="2531964">&#39;@&#39;</span><span class="op" id="2531967">,</span>&nbsp;<span class="string" id="2531969">&#39;!&#39;</span><span class="op" id="2531972">,</span>&nbsp;<span class="string" id="2531974">&#39;?&#39;</span><span class="op" id="2531977">,</span>&nbsp;<span class="string" id="2531979">&#39;0&#39;</span><span class="op" id="2531982">,</span>&nbsp;<span class="string" id="2531984">&#39;1&#39;</span><span class="op" id="2531987">,</span>&nbsp;<span class="string" id="2531989">&#39;2&#39;</span><span class="op" id="2531992">,</span>&nbsp;<span class="string" id="2531994">&#39;3&#39;</span><span class="op" id="2531997">,</span>&nbsp;<span class="string" id="2531999">&#39;4&#39;</span><span class="op" id="2532002">,</span>&nbsp;<span class="string" id="2532004">&#39;5&#39;</span><span class="op" id="2532007">,</span>&nbsp;<span class="string" id="2532009">&#39;6&#39;</span><span class="op" id="2532012">,</span>&nbsp;<span class="string" id="2532014">&#39;7&#39;</span><span class="op" id="2532017">,</span>&nbsp;<span class="string" id="2532019">&#39;8&#39;</span><span class="op" id="2532022">,</span>&nbsp;<span class="string" id="2532024">&#39;9&#39;</span><span class="op" id="2532027">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532031">return</span>&nbsp;<span class="builtintype" id="2532038">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2532044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532047">return</span>&nbsp;<span class="builtintype" id="2532054">false</span><br>
<span class="lineno"></span><span class="op" id="2532060">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="2532063">//&nbsp;isAlphaNum&nbsp;reports&nbsp;whether&nbsp;the&nbsp;byte&nbsp;is&nbsp;an&nbsp;ASCII&nbsp;letter,&nbsp;number,&nbsp;or&nbsp;underscore</span><br>
<span class="lineno"></span><span class="keyword" id="2532144">func</span>&nbsp;<span class="ident" id="2532149">isAlphaNum</span><span class="op" id="2532159">(</span><span class="ident" id="2532160">c</span>&nbsp;<span class="builtintype" id="2532162">uint8</span><span class="op" id="2532167">)</span>&nbsp;<span class="builtintype" id="2532169">bool</span>&nbsp;<span class="op" id="2532174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532177">return</span>&nbsp;<span class="ident" id="2532184">c</span>&nbsp;<span class="op" id="2532186">==</span>&nbsp;<span class="string" id="2532189">&#39;_&#39;</span>&nbsp;<span class="op" id="2532193">||</span>&nbsp;<span class="string" id="2532196">&#39;0&#39;</span>&nbsp;<span class="op" id="2532200">&lt;=</span>&nbsp;<span class="ident" id="2532203">c</span>&nbsp;<span class="op" id="2532205">&amp;&amp;</span>&nbsp;<span class="ident" id="2532208">c</span>&nbsp;<span class="op" id="2532210">&lt;=</span>&nbsp;<span class="string" id="2532213">&#39;9&#39;</span>&nbsp;<span class="op" id="2532217">||</span>&nbsp;<span class="string" id="2532220">&#39;a&#39;</span>&nbsp;<span class="op" id="2532224">&lt;=</span>&nbsp;<span class="ident" id="2532227">c</span>&nbsp;<span class="op" id="2532229">&amp;&amp;</span>&nbsp;<span class="ident" id="2532232">c</span>&nbsp;<span class="op" id="2532234">&lt;=</span>&nbsp;<span class="string" id="2532237">&#39;z&#39;</span>&nbsp;<span class="op" id="2532241">||</span>&nbsp;<span class="string" id="2532244">&#39;A&#39;</span>&nbsp;<span class="op" id="2532248">&lt;=</span>&nbsp;<span class="ident" id="2532251">c</span>&nbsp;<span class="op" id="2532253">&amp;&amp;</span>&nbsp;<span class="ident" id="2532256">c</span>&nbsp;<span class="op" id="2532258">&lt;=</span>&nbsp;<span class="string" id="2532261">&#39;Z&#39;</span><br>
<span class="lineno"></span><span class="op" id="2532265">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="2532268">//&nbsp;getName&nbsp;returns&nbsp;the&nbsp;name&nbsp;that&nbsp;begins&nbsp;the&nbsp;string&nbsp;and&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno"></span><span class="comment" id="2532343">//&nbsp;consumed&nbsp;to&nbsp;extract&nbsp;it.&nbsp;&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;enclosed&nbsp;in&nbsp;{},&nbsp;it&#39;s&nbsp;part&nbsp;of&nbsp;a&nbsp;${}</span><br>
<span class="lineno"></span><span class="comment" id="2532421">//&nbsp;expansion&nbsp;and&nbsp;two&nbsp;more&nbsp;bytes&nbsp;are&nbsp;needed&nbsp;than&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="2532493">func</span>&nbsp;<span class="ident" id="2532498">getShellName</span><span class="op" id="2532510">(</span><span class="ident" id="2532511">s</span>&nbsp;<span class="builtintype" id="2532513">string</span><span class="op" id="2532519">)</span>&nbsp;<span class="op" id="2532521">(</span><span class="builtintype" id="2532522">string</span><span class="op" id="2532528">,</span>&nbsp;<span class="builtintype" id="2532530">int</span><span class="op" id="2532533">)</span>&nbsp;<span class="op" id="2532535">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532538">switch</span>&nbsp;<span class="op" id="2532545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532548">case</span>&nbsp;<span class="ident" id="2532553">s</span><span class="op" id="2532554">[</span><span class="num" id="2532555">0</span><span class="op" id="2532556">]</span>&nbsp;<span class="op" id="2532558">==</span>&nbsp;<span class="string" id="2532561">&#39;{&#39;</span><span class="op" id="2532564">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532568">if</span>&nbsp;<span class="builtinfunc" id="2532571">len</span><span class="op" id="2532574">(</span><span class="ident" id="2532575">s</span><span class="op" id="2532576">)</span>&nbsp;<span class="op" id="2532578">&gt;</span>&nbsp;<span class="num" id="2532580">2</span>&nbsp;<span class="op" id="2532582">&amp;&amp;</span>&nbsp;<span class="ident" id="2532585">isShellSpecialVar</span><span class="op" id="2532602">(</span><span class="ident" id="2532603">s</span><span class="op" id="2532604">[</span><span class="num" id="2532605">1</span><span class="op" id="2532606">]</span><span class="op" id="2532607">)</span>&nbsp;<span class="op" id="2532609">&amp;&amp;</span>&nbsp;<span class="ident" id="2532612">s</span><span class="op" id="2532613">[</span><span class="num" id="2532614">2</span><span class="op" id="2532615">]</span>&nbsp;<span class="op" id="2532617">==</span>&nbsp;<span class="string" id="2532620">&#39;}&#39;</span>&nbsp;<span class="op" id="2532624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532629">return</span>&nbsp;<span class="ident" id="2532636">s</span><span class="op" id="2532637">[</span><span class="num" id="2532638">1</span><span class="op" id="2532639">:</span><span class="num" id="2532640">2</span><span class="op" id="2532641">]</span><span class="op" id="2532642">,</span>&nbsp;<span class="num" id="2532644">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2532648">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2532652">//&nbsp;Scan&nbsp;to&nbsp;closing&nbsp;brace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532679">for</span>&nbsp;<span class="ident" id="2532683">i</span>&nbsp;<span class="op" id="2532685">:=</span>&nbsp;<span class="num" id="2532688">1</span><span class="op" id="2532689">;</span>&nbsp;<span class="ident" id="2532691">i</span>&nbsp;<span class="op" id="2532693">&lt;</span>&nbsp;<span class="builtinfunc" id="2532695">len</span><span class="op" id="2532698">(</span><span class="ident" id="2532699">s</span><span class="op" id="2532700">)</span><span class="op" id="2532701">;</span>&nbsp;<span class="ident" id="2532703">i</span><span class="op" id="2532704">++</span>&nbsp;<span class="op" id="2532707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532712">if</span>&nbsp;<span class="ident" id="2532715">s</span><span class="op" id="2532716">[</span><span class="ident" id="2532717">i</span><span class="op" id="2532718">]</span>&nbsp;<span class="op" id="2532720">==</span>&nbsp;<span class="string" id="2532723">&#39;}&#39;</span>&nbsp;<span class="op" id="2532727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532733">return</span>&nbsp;<span class="ident" id="2532740">s</span><span class="op" id="2532741">[</span><span class="num" id="2532742">1</span><span class="op" id="2532743">:</span><span class="ident" id="2532744">i</span><span class="op" id="2532745">]</span><span class="op" id="2532746">,</span>&nbsp;<span class="ident" id="2532748">i</span>&nbsp;<span class="op" id="2532750">+</span>&nbsp;<span class="num" id="2532752">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2532757">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2532761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532765">return</span>&nbsp;<span class="string" id="2532772">&#34;&#34;</span><span class="op" id="2532774">,</span>&nbsp;<span class="num" id="2532776">1</span>&nbsp;<span class="comment" id="2532778">//&nbsp;Bad&nbsp;syntax;&nbsp;just&nbsp;eat&nbsp;the&nbsp;brace.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532814">case</span>&nbsp;<span class="ident" id="2532819">isShellSpecialVar</span><span class="op" id="2532836">(</span><span class="ident" id="2532837">s</span><span class="op" id="2532838">[</span><span class="num" id="2532839">0</span><span class="op" id="2532840">]</span><span class="op" id="2532841">)</span><span class="op" id="2532842">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532846">return</span>&nbsp;<span class="ident" id="2532853">s</span><span class="op" id="2532854">[</span><span class="num" id="2532855">0</span><span class="op" id="2532856">:</span><span class="num" id="2532857">1</span><span class="op" id="2532858">]</span><span class="op" id="2532859">,</span>&nbsp;<span class="num" id="2532861">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2532864">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2532867">//&nbsp;Scan&nbsp;alphanumerics.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532891">var</span>&nbsp;<span class="ident" id="2532895">i</span>&nbsp;<span class="builtintype" id="2532897">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532902">for</span>&nbsp;<span class="ident" id="2532906">i</span>&nbsp;<span class="op" id="2532908">=</span>&nbsp;<span class="num" id="2532910">0</span><span class="op" id="2532911">;</span>&nbsp;<span class="ident" id="2532913">i</span>&nbsp;<span class="op" id="2532915">&lt;</span>&nbsp;<span class="builtinfunc" id="2532917">len</span><span class="op" id="2532920">(</span><span class="ident" id="2532921">s</span><span class="op" id="2532922">)</span>&nbsp;<span class="op" id="2532924">&amp;&amp;</span>&nbsp;<span class="ident" id="2532927">isAlphaNum</span><span class="op" id="2532937">(</span><span class="ident" id="2532938">s</span><span class="op" id="2532939">[</span><span class="ident" id="2532940">i</span><span class="op" id="2532941">]</span><span class="op" id="2532942">)</span><span class="op" id="2532943">;</span>&nbsp;<span class="ident" id="2532945">i</span><span class="op" id="2532946">++</span>&nbsp;<span class="op" id="2532949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2532952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532955">return</span>&nbsp;<span class="ident" id="2532962">s</span><span class="op" id="2532963">[</span><span class="op" id="2532964">:</span><span class="ident" id="2532965">i</span><span class="op" id="2532966">]</span><span class="op" id="2532967">,</span>&nbsp;<span class="ident" id="2532969">i</span><br>
<span class="lineno">75</span><span class="op" id="2532971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2532974">//&nbsp;Getenv&nbsp;retrieves&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;environment&nbsp;variable&nbsp;named&nbsp;by&nbsp;the&nbsp;key.</span><br>
<span class="lineno"></span><span class="comment" id="2533050">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;value,&nbsp;which&nbsp;will&nbsp;be&nbsp;empty&nbsp;if&nbsp;the&nbsp;variable&nbsp;is&nbsp;not&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="2533127">func</span>&nbsp;<span class="ident" id="2533132">Getenv</span><span class="op" id="2533138">(</span><span class="ident" id="2533139">key</span>&nbsp;<span class="builtintype" id="2533143">string</span><span class="op" id="2533149">)</span>&nbsp;<span class="builtintype" id="2533151">string</span>&nbsp;<span class="op" id="2533158">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2533161">v</span><span class="op" id="2533162">,</span>&nbsp;<span class="ident" id="2533164">_</span>&nbsp;<span class="op" id="2533166">:=</span>&nbsp;<span class="ident" id="2533169">syscall</span><span class="op" id="2533176">.</span><span class="ident" id="2533177">Getenv</span><span class="op" id="2533183">(</span><span class="ident" id="2533184">key</span><span class="op" id="2533187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2533190">return</span>&nbsp;<span class="ident" id="2533197">v</span><br>
<span class="lineno"></span><span class="op" id="2533199">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2533202">//&nbsp;Setenv&nbsp;sets&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;environment&nbsp;variable&nbsp;named&nbsp;by&nbsp;the&nbsp;key.</span><br>
<span class="lineno">85</span><span class="comment" id="2533273">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span><span class="keyword" id="2533305">func</span>&nbsp;<span class="ident" id="2533310">Setenv</span><span class="op" id="2533316">(</span><span class="ident" id="2533317">key</span><span class="op" id="2533320">,</span>&nbsp;<span class="ident" id="2533322">value</span>&nbsp;<span class="builtintype" id="2533328">string</span><span class="op" id="2533334">)</span>&nbsp;<span class="builtintype" id="2533336">error</span>&nbsp;<span class="op" id="2533342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2533345">err</span>&nbsp;<span class="op" id="2533349">:=</span>&nbsp;<span class="ident" id="2533352">syscall</span><span class="op" id="2533359">.</span><span class="ident" id="2533360">Setenv</span><span class="op" id="2533366">(</span><span class="ident" id="2533367">key</span><span class="op" id="2533370">,</span>&nbsp;<span class="ident" id="2533372">value</span><span class="op" id="2533377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2533380">if</span>&nbsp;<span class="ident" id="2533383">err</span>&nbsp;<span class="op" id="2533387">!=</span>&nbsp;<span class="ident" id="2533390">nil</span>&nbsp;<span class="op" id="2533394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2533398">return</span>&nbsp;<span class="ident" id="2533405">NewSyscallError</span><span class="op" id="2533420">(</span><span class="string" id="2533421">&#34;setenv&#34;</span><span class="op" id="2533429">,</span>&nbsp;<span class="ident" id="2533431">err</span><span class="op" id="2533434">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2533437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2533440">return</span>&nbsp;<span class="ident" id="2533447">nil</span><br>
<span class="lineno"></span><span class="op" id="2533451">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2533454">//&nbsp;Unsetenv&nbsp;unsets&nbsp;a&nbsp;single&nbsp;environment&nbsp;variable.</span><br>
<span class="lineno">95</span><span class="keyword" id="2533504">func</span>&nbsp;<span class="ident" id="2533509">Unsetenv</span><span class="op" id="2533517">(</span><span class="ident" id="2533518">key</span>&nbsp;<span class="builtintype" id="2533522">string</span><span class="op" id="2533528">)</span>&nbsp;<span class="builtintype" id="2533530">error</span>&nbsp;<span class="op" id="2533536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2533539">return</span>&nbsp;<span class="ident" id="2533546">syscall</span><span class="op" id="2533553">.</span><span class="ident" id="2533554">Unsetenv</span><span class="op" id="2533562">(</span><span class="ident" id="2533563">key</span><span class="op" id="2533566">)</span><br>
<span class="lineno"></span><span class="op" id="2533568">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2533571">//&nbsp;Clearenv&nbsp;deletes&nbsp;all&nbsp;environment&nbsp;variables.</span><br>
<span class="lineno">100</span><span class="keyword" id="2533618">func</span>&nbsp;<span class="ident" id="2533623">Clearenv</span><span class="op" id="2533631">(</span><span class="op" id="2533632">)</span>&nbsp;<span class="op" id="2533634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2533637">syscall</span><span class="op" id="2533644">.</span><span class="ident" id="2533645">Clearenv</span><span class="op" id="2533653">(</span><span class="op" id="2533654">)</span><br>
<span class="lineno"></span><span class="op" id="2533656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2533659">//&nbsp;Environ&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;strings&nbsp;representing&nbsp;the&nbsp;environment,</span><br>
<span class="lineno">105</span><span class="comment" id="2533726">//&nbsp;in&nbsp;the&nbsp;form&nbsp;&#34;key=value&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="2533754">func</span>&nbsp;<span class="ident" id="2533759">Environ</span><span class="op" id="2533766">(</span><span class="op" id="2533767">)</span>&nbsp;<span class="op" id="2533769">[</span><span class="op" id="2533770">]</span><span class="builtintype" id="2533771">string</span>&nbsp;<span class="op" id="2533778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2533781">return</span>&nbsp;<span class="ident" id="2533788">syscall</span><span class="op" id="2533795">.</span><span class="ident" id="2533796">Environ</span><span class="op" id="2533803">(</span><span class="op" id="2533804">)</span><br>
<span class="lineno"></span><span class="op" id="2533806">}</span>
</div>
</body>
</html>
