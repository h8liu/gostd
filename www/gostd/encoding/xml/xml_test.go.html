<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/xml</h2>
<ul>
<li><a href="/gostd/encoding/xml/atom_test.go.html">atom_test.go</a></li>
<li><a href="/gostd/encoding/xml/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/xml/marshal.go.html">marshal.go</a></li>
<li><a href="/gostd/encoding/xml/marshal_test.go.html">marshal_test.go</a></li>
<li><a href="/gostd/encoding/xml/read.go.html">read.go</a></li>
<li><a href="/gostd/encoding/xml/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/encoding/xml/typeinfo.go.html">typeinfo.go</a></li>
<li><a href="/gostd/encoding/xml/xml.go.html">xml.go</a></li>
<li><a href="/gostd/encoding/xml/xml_test.go.html" class="current">xml_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6769538">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6769594">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6769648">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6769699">package</span>&nbsp;<span class="ident" id="6769707">xml</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6769712">import</span>&nbsp;<span class="op" id="6769719">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6769722">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6769731">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6769738">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6769744">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6769755">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6769766">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6769777">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">15</span><span class="op" id="6769792">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6769795">const</span>&nbsp;<span class="ident" id="6769801">testInput</span>&nbsp;<span class="op" id="6769811">=</span>&nbsp;<span class="string" id="6769813">`<br>
<span class="lineno"></span>&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;?&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno">20</span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;&gt;<br>
<span class="lineno"></span>&lt;body&nbsp;xmlns:foo=&#34;ns1&#34;&nbsp;xmlns=&#34;ns2&#34;&nbsp;xmlns:tag=&#34;ns3&#34;&nbsp;`</span>&nbsp;<span class="op" id="6770030">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6770033">&#34;\r\n\t&#34;</span>&nbsp;<span class="op" id="6770042">+</span>&nbsp;<span class="string" id="6770044">`&nbsp;&nbsp;&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;hello&nbsp;lang=&#34;en&#34;&gt;World&nbsp;&amp;lt;&amp;gt;&amp;apos;&amp;quot;&nbsp;&amp;#x767d;&amp;#40300;翔&lt;/hello&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;query&gt;&amp;何;&nbsp;&amp;is-it;&lt;/query&gt;<br>
<span class="lineno">25</span>&nbsp;&nbsp;&lt;goodbye&nbsp;/&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;outer&nbsp;foo:attr=&#34;value&#34;&nbsp;xmlns:tag=&#34;ns4&#34;&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;inner/&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;/outer&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;tag:name&gt;<br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;![CDATA[Some&nbsp;text&nbsp;here.]]&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;/tag:name&gt;<br>
<span class="lineno"></span>&lt;/body&gt;&lt;!--&nbsp;missing&nbsp;final&nbsp;newline&nbsp;--&gt;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6770334">var</span>&nbsp;<span class="ident" id="6770338">testEntity</span>&nbsp;<span class="op" id="6770349">=</span>&nbsp;<span class="keyword" id="6770351">map</span><span class="op" id="6770354">[</span><span class="builtintype" id="6770355">string</span><span class="op" id="6770361">]</span><span class="builtintype" id="6770362">string</span><span class="op" id="6770368">{</span><span class="string" id="6770369">&#34;何&#34;</span><span class="op" id="6770374">:</span>&nbsp;<span class="string" id="6770376">&#34;What&#34;</span><span class="op" id="6770382">,</span>&nbsp;<span class="string" id="6770384">&#34;is-it&#34;</span><span class="op" id="6770391">:</span>&nbsp;<span class="string" id="6770393">&#34;is&nbsp;it?&#34;</span><span class="op" id="6770401">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="6770404">var</span>&nbsp;<span class="ident" id="6770408">rawTokens</span>&nbsp;<span class="op" id="6770418">=</span>&nbsp;<span class="op" id="6770420">[</span><span class="op" id="6770421">]</span><span class="ident" id="6770422">Token</span><span class="op" id="6770427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6770430">CharData</span><span class="op" id="6770438">(</span><span class="string" id="6770439">&#34;\n&#34;</span><span class="op" id="6770443">)</span><span class="op" id="6770444">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6770447">ProcInst</span><span class="op" id="6770455">{</span><span class="string" id="6770456">&#34;xml&#34;</span><span class="op" id="6770461">,</span>&nbsp;<span class="op" id="6770463">[</span><span class="op" id="6770464">]</span><span class="builtintype" id="6770465">byte</span><span class="op" id="6770469">(</span><span class="string" id="6770470">`version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;`</span><span class="op" id="6770502">)</span><span class="op" id="6770503">}</span><span class="op" id="6770504">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6770507">CharData</span><span class="op" id="6770515">(</span><span class="string" id="6770516">&#34;\n&#34;</span><span class="op" id="6770520">)</span><span class="op" id="6770521">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6770524">Directive</span><span class="op" id="6770533">(</span><span class="string" id="6770534">`DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno"></span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;`</span><span class="op" id="6770656">)</span><span class="op" id="6770657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6770660">CharData</span><span class="op" id="6770668">(</span><span class="string" id="6770669">&#34;\n&#34;</span><span class="op" id="6770673">)</span><span class="op" id="6770674">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6770677">StartElement</span><span class="op" id="6770689">{</span><span class="ident" id="6770690">Name</span><span class="op" id="6770694">{</span><span class="string" id="6770695">&#34;&#34;</span><span class="op" id="6770697">,</span>&nbsp;<span class="string" id="6770699">&#34;body&#34;</span><span class="op" id="6770705">}</span><span class="op" id="6770706">,</span>&nbsp;<span class="op" id="6770708">[</span><span class="op" id="6770709">]</span><span class="ident" id="6770710">Attr</span><span class="op" id="6770714">{</span><span class="op" id="6770715">{</span><span class="ident" id="6770716">Name</span><span class="op" id="6770720">{</span><span class="string" id="6770721">&#34;xmlns&#34;</span><span class="op" id="6770728">,</span>&nbsp;<span class="string" id="6770730">&#34;foo&#34;</span><span class="op" id="6770735">}</span><span class="op" id="6770736">,</span>&nbsp;<span class="string" id="6770738">&#34;ns1&#34;</span><span class="op" id="6770743">}</span><span class="op" id="6770744">,</span>&nbsp;<span class="op" id="6770746">{</span><span class="ident" id="6770747">Name</span><span class="op" id="6770751">{</span><span class="string" id="6770752">&#34;&#34;</span><span class="op" id="6770754">,</span>&nbsp;<span class="string" id="6770756">&#34;xmlns&#34;</span><span class="op" id="6770763">}</span><span class="op" id="6770764">,</span>&nbsp;<span class="string" id="6770766">&#34;ns2&#34;</span><span class="op" id="6770771">}</span><span class="op" id="6770772">,</span>&nbsp;<span class="op" id="6770774">{</span><span class="ident" id="6770775">Name</span><span class="op" id="6770779">{</span><span class="string" id="6770780">&#34;xmlns&#34;</span><span class="op" id="6770787">,</span>&nbsp;<span class="string" id="6770789">&#34;tag&#34;</span><span class="op" id="6770794">}</span><span class="op" id="6770795">,</span>&nbsp;<span class="string" id="6770797">&#34;ns3&#34;</span><span class="op" id="6770802">}</span><span class="op" id="6770803">}</span><span class="op" id="6770804">}</span><span class="op" id="6770805">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6770808">CharData</span><span class="op" id="6770816">(</span><span class="string" id="6770817">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6770823">)</span><span class="op" id="6770824">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6770827">StartElement</span><span class="op" id="6770839">{</span><span class="ident" id="6770840">Name</span><span class="op" id="6770844">{</span><span class="string" id="6770845">&#34;&#34;</span><span class="op" id="6770847">,</span>&nbsp;<span class="string" id="6770849">&#34;hello&#34;</span><span class="op" id="6770856">}</span><span class="op" id="6770857">,</span>&nbsp;<span class="op" id="6770859">[</span><span class="op" id="6770860">]</span><span class="ident" id="6770861">Attr</span><span class="op" id="6770865">{</span><span class="op" id="6770866">{</span><span class="ident" id="6770867">Name</span><span class="op" id="6770871">{</span><span class="string" id="6770872">&#34;&#34;</span><span class="op" id="6770874">,</span>&nbsp;<span class="string" id="6770876">&#34;lang&#34;</span><span class="op" id="6770882">}</span><span class="op" id="6770883">,</span>&nbsp;<span class="string" id="6770885">&#34;en&#34;</span><span class="op" id="6770889">}</span><span class="op" id="6770890">}</span><span class="op" id="6770891">}</span><span class="op" id="6770892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6770895">CharData</span><span class="op" id="6770903">(</span><span class="string" id="6770904">&#34;World&nbsp;&lt;&gt;&#39;\&#34;&nbsp;白鵬翔&#34;</span><span class="op" id="6770927">)</span><span class="op" id="6770928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6770931">EndElement</span><span class="op" id="6770941">{</span><span class="ident" id="6770942">Name</span><span class="op" id="6770946">{</span><span class="string" id="6770947">&#34;&#34;</span><span class="op" id="6770949">,</span>&nbsp;<span class="string" id="6770951">&#34;hello&#34;</span><span class="op" id="6770958">}</span><span class="op" id="6770959">}</span><span class="op" id="6770960">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6770963">CharData</span><span class="op" id="6770971">(</span><span class="string" id="6770972">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6770978">)</span><span class="op" id="6770979">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6770982">StartElement</span><span class="op" id="6770994">{</span><span class="ident" id="6770995">Name</span><span class="op" id="6770999">{</span><span class="string" id="6771000">&#34;&#34;</span><span class="op" id="6771002">,</span>&nbsp;<span class="string" id="6771004">&#34;query&#34;</span><span class="op" id="6771011">}</span><span class="op" id="6771012">,</span>&nbsp;<span class="op" id="6771014">[</span><span class="op" id="6771015">]</span><span class="ident" id="6771016">Attr</span><span class="op" id="6771020">{</span><span class="op" id="6771021">}</span><span class="op" id="6771022">}</span><span class="op" id="6771023">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6771026">CharData</span><span class="op" id="6771034">(</span><span class="string" id="6771035">&#34;What&nbsp;is&nbsp;it?&#34;</span><span class="op" id="6771048">)</span><span class="op" id="6771049">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6771052">EndElement</span><span class="op" id="6771062">{</span><span class="ident" id="6771063">Name</span><span class="op" id="6771067">{</span><span class="string" id="6771068">&#34;&#34;</span><span class="op" id="6771070">,</span>&nbsp;<span class="string" id="6771072">&#34;query&#34;</span><span class="op" id="6771079">}</span><span class="op" id="6771080">}</span><span class="op" id="6771081">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6771084">CharData</span><span class="op" id="6771092">(</span><span class="string" id="6771093">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6771099">)</span><span class="op" id="6771100">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6771103">StartElement</span><span class="op" id="6771115">{</span><span class="ident" id="6771116">Name</span><span class="op" id="6771120">{</span><span class="string" id="6771121">&#34;&#34;</span><span class="op" id="6771123">,</span>&nbsp;<span class="string" id="6771125">&#34;goodbye&#34;</span><span class="op" id="6771134">}</span><span class="op" id="6771135">,</span>&nbsp;<span class="op" id="6771137">[</span><span class="op" id="6771138">]</span><span class="ident" id="6771139">Attr</span><span class="op" id="6771143">{</span><span class="op" id="6771144">}</span><span class="op" id="6771145">}</span><span class="op" id="6771146">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6771149">EndElement</span><span class="op" id="6771159">{</span><span class="ident" id="6771160">Name</span><span class="op" id="6771164">{</span><span class="string" id="6771165">&#34;&#34;</span><span class="op" id="6771167">,</span>&nbsp;<span class="string" id="6771169">&#34;goodbye&#34;</span><span class="op" id="6771178">}</span><span class="op" id="6771179">}</span><span class="op" id="6771180">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6771183">CharData</span><span class="op" id="6771191">(</span><span class="string" id="6771192">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6771198">)</span><span class="op" id="6771199">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6771202">StartElement</span><span class="op" id="6771214">{</span><span class="ident" id="6771215">Name</span><span class="op" id="6771219">{</span><span class="string" id="6771220">&#34;&#34;</span><span class="op" id="6771222">,</span>&nbsp;<span class="string" id="6771224">&#34;outer&#34;</span><span class="op" id="6771231">}</span><span class="op" id="6771232">,</span>&nbsp;<span class="op" id="6771234">[</span><span class="op" id="6771235">]</span><span class="ident" id="6771236">Attr</span><span class="op" id="6771240">{</span><span class="op" id="6771241">{</span><span class="ident" id="6771242">Name</span><span class="op" id="6771246">{</span><span class="string" id="6771247">&#34;foo&#34;</span><span class="op" id="6771252">,</span>&nbsp;<span class="string" id="6771254">&#34;attr&#34;</span><span class="op" id="6771260">}</span><span class="op" id="6771261">,</span>&nbsp;<span class="string" id="6771263">&#34;value&#34;</span><span class="op" id="6771270">}</span><span class="op" id="6771271">,</span>&nbsp;<span class="op" id="6771273">{</span><span class="ident" id="6771274">Name</span><span class="op" id="6771278">{</span><span class="string" id="6771279">&#34;xmlns&#34;</span><span class="op" id="6771286">,</span>&nbsp;<span class="string" id="6771288">&#34;tag&#34;</span><span class="op" id="6771293">}</span><span class="op" id="6771294">,</span>&nbsp;<span class="string" id="6771296">&#34;ns4&#34;</span><span class="op" id="6771301">}</span><span class="op" id="6771302">}</span><span class="op" id="6771303">}</span><span class="op" id="6771304">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6771307">CharData</span><span class="op" id="6771315">(</span><span class="string" id="6771316">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="6771324">)</span><span class="op" id="6771325">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6771328">StartElement</span><span class="op" id="6771340">{</span><span class="ident" id="6771341">Name</span><span class="op" id="6771345">{</span><span class="string" id="6771346">&#34;&#34;</span><span class="op" id="6771348">,</span>&nbsp;<span class="string" id="6771350">&#34;inner&#34;</span><span class="op" id="6771357">}</span><span class="op" id="6771358">,</span>&nbsp;<span class="op" id="6771360">[</span><span class="op" id="6771361">]</span><span class="ident" id="6771362">Attr</span><span class="op" id="6771366">{</span><span class="op" id="6771367">}</span><span class="op" id="6771368">}</span><span class="op" id="6771369">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6771372">EndElement</span><span class="op" id="6771382">{</span><span class="ident" id="6771383">Name</span><span class="op" id="6771387">{</span><span class="string" id="6771388">&#34;&#34;</span><span class="op" id="6771390">,</span>&nbsp;<span class="string" id="6771392">&#34;inner&#34;</span><span class="op" id="6771399">}</span><span class="op" id="6771400">}</span><span class="op" id="6771401">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6771404">CharData</span><span class="op" id="6771412">(</span><span class="string" id="6771413">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6771419">)</span><span class="op" id="6771420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6771423">EndElement</span><span class="op" id="6771433">{</span><span class="ident" id="6771434">Name</span><span class="op" id="6771438">{</span><span class="string" id="6771439">&#34;&#34;</span><span class="op" id="6771441">,</span>&nbsp;<span class="string" id="6771443">&#34;outer&#34;</span><span class="op" id="6771450">}</span><span class="op" id="6771451">}</span><span class="op" id="6771452">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6771455">CharData</span><span class="op" id="6771463">(</span><span class="string" id="6771464">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6771470">)</span><span class="op" id="6771471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6771474">StartElement</span><span class="op" id="6771486">{</span><span class="ident" id="6771487">Name</span><span class="op" id="6771491">{</span><span class="string" id="6771492">&#34;tag&#34;</span><span class="op" id="6771497">,</span>&nbsp;<span class="string" id="6771499">&#34;name&#34;</span><span class="op" id="6771505">}</span><span class="op" id="6771506">,</span>&nbsp;<span class="op" id="6771508">[</span><span class="op" id="6771509">]</span><span class="ident" id="6771510">Attr</span><span class="op" id="6771514">{</span><span class="op" id="6771515">}</span><span class="op" id="6771516">}</span><span class="op" id="6771517">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6771520">CharData</span><span class="op" id="6771528">(</span><span class="string" id="6771529">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="6771537">)</span><span class="op" id="6771538">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6771541">CharData</span><span class="op" id="6771549">(</span><span class="string" id="6771550">&#34;Some&nbsp;text&nbsp;here.&#34;</span><span class="op" id="6771567">)</span><span class="op" id="6771568">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6771571">CharData</span><span class="op" id="6771579">(</span><span class="string" id="6771580">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6771586">)</span><span class="op" id="6771587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6771590">EndElement</span><span class="op" id="6771600">{</span><span class="ident" id="6771601">Name</span><span class="op" id="6771605">{</span><span class="string" id="6771606">&#34;tag&#34;</span><span class="op" id="6771611">,</span>&nbsp;<span class="string" id="6771613">&#34;name&#34;</span><span class="op" id="6771619">}</span><span class="op" id="6771620">}</span><span class="op" id="6771621">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6771624">CharData</span><span class="op" id="6771632">(</span><span class="string" id="6771633">&#34;\n&#34;</span><span class="op" id="6771637">)</span><span class="op" id="6771638">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6771641">EndElement</span><span class="op" id="6771651">{</span><span class="ident" id="6771652">Name</span><span class="op" id="6771656">{</span><span class="string" id="6771657">&#34;&#34;</span><span class="op" id="6771659">,</span>&nbsp;<span class="string" id="6771661">&#34;body&#34;</span><span class="op" id="6771667">}</span><span class="op" id="6771668">}</span><span class="op" id="6771669">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6771672">Comment</span><span class="op" id="6771679">(</span><span class="string" id="6771680">&#34;&nbsp;missing&nbsp;final&nbsp;newline&nbsp;&#34;</span><span class="op" id="6771705">)</span><span class="op" id="6771706">,</span><br>
<span class="lineno"></span><span class="op" id="6771708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6771711">var</span>&nbsp;<span class="ident" id="6771715">cookedTokens</span>&nbsp;<span class="op" id="6771728">=</span>&nbsp;<span class="op" id="6771730">[</span><span class="op" id="6771731">]</span><span class="ident" id="6771732">Token</span><span class="op" id="6771737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6771740">CharData</span><span class="op" id="6771748">(</span><span class="string" id="6771749">&#34;\n&#34;</span><span class="op" id="6771753">)</span><span class="op" id="6771754">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6771757">ProcInst</span><span class="op" id="6771765">{</span><span class="string" id="6771766">&#34;xml&#34;</span><span class="op" id="6771771">,</span>&nbsp;<span class="op" id="6771773">[</span><span class="op" id="6771774">]</span><span class="builtintype" id="6771775">byte</span><span class="op" id="6771779">(</span><span class="string" id="6771780">`version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;`</span><span class="op" id="6771812">)</span><span class="op" id="6771813">}</span><span class="op" id="6771814">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6771817">CharData</span><span class="op" id="6771825">(</span><span class="string" id="6771826">&#34;\n&#34;</span><span class="op" id="6771830">)</span><span class="op" id="6771831">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6771834">Directive</span><span class="op" id="6771843">(</span><span class="string" id="6771844">`DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno"></span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;`</span><span class="op" id="6771966">)</span><span class="op" id="6771967">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6771970">CharData</span><span class="op" id="6771978">(</span><span class="string" id="6771979">&#34;\n&#34;</span><span class="op" id="6771983">)</span><span class="op" id="6771984">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6771987">StartElement</span><span class="op" id="6771999">{</span><span class="ident" id="6772000">Name</span><span class="op" id="6772004">{</span><span class="string" id="6772005">&#34;ns2&#34;</span><span class="op" id="6772010">,</span>&nbsp;<span class="string" id="6772012">&#34;body&#34;</span><span class="op" id="6772018">}</span><span class="op" id="6772019">,</span>&nbsp;<span class="op" id="6772021">[</span><span class="op" id="6772022">]</span><span class="ident" id="6772023">Attr</span><span class="op" id="6772027">{</span><span class="op" id="6772028">{</span><span class="ident" id="6772029">Name</span><span class="op" id="6772033">{</span><span class="string" id="6772034">&#34;xmlns&#34;</span><span class="op" id="6772041">,</span>&nbsp;<span class="string" id="6772043">&#34;foo&#34;</span><span class="op" id="6772048">}</span><span class="op" id="6772049">,</span>&nbsp;<span class="string" id="6772051">&#34;ns1&#34;</span><span class="op" id="6772056">}</span><span class="op" id="6772057">,</span>&nbsp;<span class="op" id="6772059">{</span><span class="ident" id="6772060">Name</span><span class="op" id="6772064">{</span><span class="string" id="6772065">&#34;&#34;</span><span class="op" id="6772067">,</span>&nbsp;<span class="string" id="6772069">&#34;xmlns&#34;</span><span class="op" id="6772076">}</span><span class="op" id="6772077">,</span>&nbsp;<span class="string" id="6772079">&#34;ns2&#34;</span><span class="op" id="6772084">}</span><span class="op" id="6772085">,</span>&nbsp;<span class="op" id="6772087">{</span><span class="ident" id="6772088">Name</span><span class="op" id="6772092">{</span><span class="string" id="6772093">&#34;xmlns&#34;</span><span class="op" id="6772100">,</span>&nbsp;<span class="string" id="6772102">&#34;tag&#34;</span><span class="op" id="6772107">}</span><span class="op" id="6772108">,</span>&nbsp;<span class="string" id="6772110">&#34;ns3&#34;</span><span class="op" id="6772115">}</span><span class="op" id="6772116">}</span><span class="op" id="6772117">}</span><span class="op" id="6772118">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6772121">CharData</span><span class="op" id="6772129">(</span><span class="string" id="6772130">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6772136">)</span><span class="op" id="6772137">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6772140">StartElement</span><span class="op" id="6772152">{</span><span class="ident" id="6772153">Name</span><span class="op" id="6772157">{</span><span class="string" id="6772158">&#34;ns2&#34;</span><span class="op" id="6772163">,</span>&nbsp;<span class="string" id="6772165">&#34;hello&#34;</span><span class="op" id="6772172">}</span><span class="op" id="6772173">,</span>&nbsp;<span class="op" id="6772175">[</span><span class="op" id="6772176">]</span><span class="ident" id="6772177">Attr</span><span class="op" id="6772181">{</span><span class="op" id="6772182">{</span><span class="ident" id="6772183">Name</span><span class="op" id="6772187">{</span><span class="string" id="6772188">&#34;&#34;</span><span class="op" id="6772190">,</span>&nbsp;<span class="string" id="6772192">&#34;lang&#34;</span><span class="op" id="6772198">}</span><span class="op" id="6772199">,</span>&nbsp;<span class="string" id="6772201">&#34;en&#34;</span><span class="op" id="6772205">}</span><span class="op" id="6772206">}</span><span class="op" id="6772207">}</span><span class="op" id="6772208">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6772211">CharData</span><span class="op" id="6772219">(</span><span class="string" id="6772220">&#34;World&nbsp;&lt;&gt;&#39;\&#34;&nbsp;白鵬翔&#34;</span><span class="op" id="6772243">)</span><span class="op" id="6772244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6772247">EndElement</span><span class="op" id="6772257">{</span><span class="ident" id="6772258">Name</span><span class="op" id="6772262">{</span><span class="string" id="6772263">&#34;ns2&#34;</span><span class="op" id="6772268">,</span>&nbsp;<span class="string" id="6772270">&#34;hello&#34;</span><span class="op" id="6772277">}</span><span class="op" id="6772278">}</span><span class="op" id="6772279">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6772282">CharData</span><span class="op" id="6772290">(</span><span class="string" id="6772291">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6772297">)</span><span class="op" id="6772298">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6772301">StartElement</span><span class="op" id="6772313">{</span><span class="ident" id="6772314">Name</span><span class="op" id="6772318">{</span><span class="string" id="6772319">&#34;ns2&#34;</span><span class="op" id="6772324">,</span>&nbsp;<span class="string" id="6772326">&#34;query&#34;</span><span class="op" id="6772333">}</span><span class="op" id="6772334">,</span>&nbsp;<span class="op" id="6772336">[</span><span class="op" id="6772337">]</span><span class="ident" id="6772338">Attr</span><span class="op" id="6772342">{</span><span class="op" id="6772343">}</span><span class="op" id="6772344">}</span><span class="op" id="6772345">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6772348">CharData</span><span class="op" id="6772356">(</span><span class="string" id="6772357">&#34;What&nbsp;is&nbsp;it?&#34;</span><span class="op" id="6772370">)</span><span class="op" id="6772371">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6772374">EndElement</span><span class="op" id="6772384">{</span><span class="ident" id="6772385">Name</span><span class="op" id="6772389">{</span><span class="string" id="6772390">&#34;ns2&#34;</span><span class="op" id="6772395">,</span>&nbsp;<span class="string" id="6772397">&#34;query&#34;</span><span class="op" id="6772404">}</span><span class="op" id="6772405">}</span><span class="op" id="6772406">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6772409">CharData</span><span class="op" id="6772417">(</span><span class="string" id="6772418">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6772424">)</span><span class="op" id="6772425">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6772428">StartElement</span><span class="op" id="6772440">{</span><span class="ident" id="6772441">Name</span><span class="op" id="6772445">{</span><span class="string" id="6772446">&#34;ns2&#34;</span><span class="op" id="6772451">,</span>&nbsp;<span class="string" id="6772453">&#34;goodbye&#34;</span><span class="op" id="6772462">}</span><span class="op" id="6772463">,</span>&nbsp;<span class="op" id="6772465">[</span><span class="op" id="6772466">]</span><span class="ident" id="6772467">Attr</span><span class="op" id="6772471">{</span><span class="op" id="6772472">}</span><span class="op" id="6772473">}</span><span class="op" id="6772474">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6772477">EndElement</span><span class="op" id="6772487">{</span><span class="ident" id="6772488">Name</span><span class="op" id="6772492">{</span><span class="string" id="6772493">&#34;ns2&#34;</span><span class="op" id="6772498">,</span>&nbsp;<span class="string" id="6772500">&#34;goodbye&#34;</span><span class="op" id="6772509">}</span><span class="op" id="6772510">}</span><span class="op" id="6772511">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6772514">CharData</span><span class="op" id="6772522">(</span><span class="string" id="6772523">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6772529">)</span><span class="op" id="6772530">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6772533">StartElement</span><span class="op" id="6772545">{</span><span class="ident" id="6772546">Name</span><span class="op" id="6772550">{</span><span class="string" id="6772551">&#34;ns2&#34;</span><span class="op" id="6772556">,</span>&nbsp;<span class="string" id="6772558">&#34;outer&#34;</span><span class="op" id="6772565">}</span><span class="op" id="6772566">,</span>&nbsp;<span class="op" id="6772568">[</span><span class="op" id="6772569">]</span><span class="ident" id="6772570">Attr</span><span class="op" id="6772574">{</span><span class="op" id="6772575">{</span><span class="ident" id="6772576">Name</span><span class="op" id="6772580">{</span><span class="string" id="6772581">&#34;ns1&#34;</span><span class="op" id="6772586">,</span>&nbsp;<span class="string" id="6772588">&#34;attr&#34;</span><span class="op" id="6772594">}</span><span class="op" id="6772595">,</span>&nbsp;<span class="string" id="6772597">&#34;value&#34;</span><span class="op" id="6772604">}</span><span class="op" id="6772605">,</span>&nbsp;<span class="op" id="6772607">{</span><span class="ident" id="6772608">Name</span><span class="op" id="6772612">{</span><span class="string" id="6772613">&#34;xmlns&#34;</span><span class="op" id="6772620">,</span>&nbsp;<span class="string" id="6772622">&#34;tag&#34;</span><span class="op" id="6772627">}</span><span class="op" id="6772628">,</span>&nbsp;<span class="string" id="6772630">&#34;ns4&#34;</span><span class="op" id="6772635">}</span><span class="op" id="6772636">}</span><span class="op" id="6772637">}</span><span class="op" id="6772638">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6772641">CharData</span><span class="op" id="6772649">(</span><span class="string" id="6772650">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="6772658">)</span><span class="op" id="6772659">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6772662">StartElement</span><span class="op" id="6772674">{</span><span class="ident" id="6772675">Name</span><span class="op" id="6772679">{</span><span class="string" id="6772680">&#34;ns2&#34;</span><span class="op" id="6772685">,</span>&nbsp;<span class="string" id="6772687">&#34;inner&#34;</span><span class="op" id="6772694">}</span><span class="op" id="6772695">,</span>&nbsp;<span class="op" id="6772697">[</span><span class="op" id="6772698">]</span><span class="ident" id="6772699">Attr</span><span class="op" id="6772703">{</span><span class="op" id="6772704">}</span><span class="op" id="6772705">}</span><span class="op" id="6772706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6772709">EndElement</span><span class="op" id="6772719">{</span><span class="ident" id="6772720">Name</span><span class="op" id="6772724">{</span><span class="string" id="6772725">&#34;ns2&#34;</span><span class="op" id="6772730">,</span>&nbsp;<span class="string" id="6772732">&#34;inner&#34;</span><span class="op" id="6772739">}</span><span class="op" id="6772740">}</span><span class="op" id="6772741">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6772744">CharData</span><span class="op" id="6772752">(</span><span class="string" id="6772753">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6772759">)</span><span class="op" id="6772760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6772763">EndElement</span><span class="op" id="6772773">{</span><span class="ident" id="6772774">Name</span><span class="op" id="6772778">{</span><span class="string" id="6772779">&#34;ns2&#34;</span><span class="op" id="6772784">,</span>&nbsp;<span class="string" id="6772786">&#34;outer&#34;</span><span class="op" id="6772793">}</span><span class="op" id="6772794">}</span><span class="op" id="6772795">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6772798">CharData</span><span class="op" id="6772806">(</span><span class="string" id="6772807">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6772813">)</span><span class="op" id="6772814">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6772817">StartElement</span><span class="op" id="6772829">{</span><span class="ident" id="6772830">Name</span><span class="op" id="6772834">{</span><span class="string" id="6772835">&#34;ns3&#34;</span><span class="op" id="6772840">,</span>&nbsp;<span class="string" id="6772842">&#34;name&#34;</span><span class="op" id="6772848">}</span><span class="op" id="6772849">,</span>&nbsp;<span class="op" id="6772851">[</span><span class="op" id="6772852">]</span><span class="ident" id="6772853">Attr</span><span class="op" id="6772857">{</span><span class="op" id="6772858">}</span><span class="op" id="6772859">}</span><span class="op" id="6772860">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6772863">CharData</span><span class="op" id="6772871">(</span><span class="string" id="6772872">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="6772880">)</span><span class="op" id="6772881">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6772884">CharData</span><span class="op" id="6772892">(</span><span class="string" id="6772893">&#34;Some&nbsp;text&nbsp;here.&#34;</span><span class="op" id="6772910">)</span><span class="op" id="6772911">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6772914">CharData</span><span class="op" id="6772922">(</span><span class="string" id="6772923">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6772929">)</span><span class="op" id="6772930">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6772933">EndElement</span><span class="op" id="6772943">{</span><span class="ident" id="6772944">Name</span><span class="op" id="6772948">{</span><span class="string" id="6772949">&#34;ns3&#34;</span><span class="op" id="6772954">,</span>&nbsp;<span class="string" id="6772956">&#34;name&#34;</span><span class="op" id="6772962">}</span><span class="op" id="6772963">}</span><span class="op" id="6772964">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6772967">CharData</span><span class="op" id="6772975">(</span><span class="string" id="6772976">&#34;\n&#34;</span><span class="op" id="6772980">)</span><span class="op" id="6772981">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6772984">EndElement</span><span class="op" id="6772994">{</span><span class="ident" id="6772995">Name</span><span class="op" id="6772999">{</span><span class="string" id="6773000">&#34;ns2&#34;</span><span class="op" id="6773005">,</span>&nbsp;<span class="string" id="6773007">&#34;body&#34;</span><span class="op" id="6773013">}</span><span class="op" id="6773014">}</span><span class="op" id="6773015">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6773018">Comment</span><span class="op" id="6773025">(</span><span class="string" id="6773026">&#34;&nbsp;missing&nbsp;final&nbsp;newline&nbsp;&#34;</span><span class="op" id="6773051">)</span><span class="op" id="6773052">,</span><br>
<span class="lineno"></span><span class="op" id="6773054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="6773057">const</span>&nbsp;<span class="ident" id="6773063">testInputAltEncoding</span>&nbsp;<span class="op" id="6773084">=</span>&nbsp;<span class="string" id="6773086">`<br>
<span class="lineno"></span>&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;x-testing-uppercase&#34;?&gt;<br>
<span class="lineno"></span>&lt;TAG&gt;VALUE&lt;/TAG&gt;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6773160">var</span>&nbsp;<span class="ident" id="6773164">rawTokensAltEncoding</span>&nbsp;<span class="op" id="6773185">=</span>&nbsp;<span class="op" id="6773187">[</span><span class="op" id="6773188">]</span><span class="ident" id="6773189">Token</span><span class="op" id="6773194">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6773197">CharData</span><span class="op" id="6773205">(</span><span class="string" id="6773206">&#34;\n&#34;</span><span class="op" id="6773210">)</span><span class="op" id="6773211">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6773214">ProcInst</span><span class="op" id="6773222">{</span><span class="string" id="6773223">&#34;xml&#34;</span><span class="op" id="6773228">,</span>&nbsp;<span class="op" id="6773230">[</span><span class="op" id="6773231">]</span><span class="builtintype" id="6773232">byte</span><span class="op" id="6773236">(</span><span class="string" id="6773237">`version=&#34;1.0&#34;&nbsp;encoding=&#34;x-testing-uppercase&#34;`</span><span class="op" id="6773283">)</span><span class="op" id="6773284">}</span><span class="op" id="6773285">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6773288">CharData</span><span class="op" id="6773296">(</span><span class="string" id="6773297">&#34;\n&#34;</span><span class="op" id="6773301">)</span><span class="op" id="6773302">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6773305">StartElement</span><span class="op" id="6773317">{</span><span class="ident" id="6773318">Name</span><span class="op" id="6773322">{</span><span class="string" id="6773323">&#34;&#34;</span><span class="op" id="6773325">,</span>&nbsp;<span class="string" id="6773327">&#34;tag&#34;</span><span class="op" id="6773332">}</span><span class="op" id="6773333">,</span>&nbsp;<span class="op" id="6773335">[</span><span class="op" id="6773336">]</span><span class="ident" id="6773337">Attr</span><span class="op" id="6773341">{</span><span class="op" id="6773342">}</span><span class="op" id="6773343">}</span><span class="op" id="6773344">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6773347">CharData</span><span class="op" id="6773355">(</span><span class="string" id="6773356">&#34;value&#34;</span><span class="op" id="6773363">)</span><span class="op" id="6773364">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6773367">EndElement</span><span class="op" id="6773377">{</span><span class="ident" id="6773378">Name</span><span class="op" id="6773382">{</span><span class="string" id="6773383">&#34;&#34;</span><span class="op" id="6773385">,</span>&nbsp;<span class="string" id="6773387">&#34;tag&#34;</span><span class="op" id="6773392">}</span><span class="op" id="6773393">}</span><span class="op" id="6773394">,</span><br>
<span class="lineno"></span><span class="op" id="6773396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6773399">var</span>&nbsp;<span class="ident" id="6773403">xmlInput</span>&nbsp;<span class="op" id="6773412">=</span>&nbsp;<span class="op" id="6773414">[</span><span class="op" id="6773415">]</span><span class="builtintype" id="6773416">string</span><span class="op" id="6773422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6773425">//&nbsp;unexpected&nbsp;EOF&nbsp;cases</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773450">&#34;&lt;&#34;</span><span class="op" id="6773453">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773456">&#34;&lt;t&#34;</span><span class="op" id="6773460">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773463">&#34;&lt;t&nbsp;&#34;</span><span class="op" id="6773468">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773471">&#34;&lt;t/&#34;</span><span class="op" id="6773476">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773479">&#34;&lt;!&#34;</span><span class="op" id="6773483">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773486">&#34;&lt;!-&#34;</span><span class="op" id="6773491">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773494">&#34;&lt;!--&#34;</span><span class="op" id="6773500">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773503">&#34;&lt;!--c-&#34;</span><span class="op" id="6773511">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773514">&#34;&lt;!--c--&#34;</span><span class="op" id="6773523">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773526">&#34;&lt;!d&#34;</span><span class="op" id="6773531">,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773534">&#34;&lt;t&gt;&lt;/&#34;</span><span class="op" id="6773541">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773544">&#34;&lt;t&gt;&lt;/t&#34;</span><span class="op" id="6773552">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773555">&#34;&lt;?&#34;</span><span class="op" id="6773559">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773562">&#34;&lt;?p&#34;</span><span class="op" id="6773567">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773570">&#34;&lt;t&nbsp;a&#34;</span><span class="op" id="6773576">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773579">&#34;&lt;t&nbsp;a=&#34;</span><span class="op" id="6773586">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773589">&#34;&lt;t&nbsp;a=&#39;&#34;</span><span class="op" id="6773597">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773600">&#34;&lt;t&nbsp;a=&#39;&#39;&#34;</span><span class="op" id="6773609">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773612">&#34;&lt;t/&gt;&lt;![&#34;</span><span class="op" id="6773621">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773624">&#34;&lt;t/&gt;&lt;![C&#34;</span><span class="op" id="6773634">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773637">&#34;&lt;t/&gt;&lt;![CDATA[d&#34;</span><span class="op" id="6773653">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773656">&#34;&lt;t/&gt;&lt;![CDATA[d]&#34;</span><span class="op" id="6773673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773676">&#34;&lt;t/&gt;&lt;![CDATA[d]]&#34;</span><span class="op" id="6773694">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6773698">//&nbsp;other&nbsp;Syntax&nbsp;errors</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773722">&#34;&lt;&gt;&#34;</span><span class="op" id="6773726">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773729">&#34;&lt;t/a&#34;</span><span class="op" id="6773735">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773738">&#34;&lt;0&nbsp;/&gt;&#34;</span><span class="op" id="6773745">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773748">&#34;&lt;?0&nbsp;&gt;&#34;</span><span class="op" id="6773755">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6773758">//&nbsp;&nbsp;&nbsp;&nbsp&#34;&lt;!0&nbsp;&gt;&#34;,&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;let&nbsp;the&nbsp;Token()&nbsp;caller&nbsp;handle</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773804">&#34;&lt;/0&gt;&#34;</span><span class="op" id="6773810">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773813">&#34;&lt;t&nbsp;0=&#39;&#39;&gt;&#34;</span><span class="op" id="6773823">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773826">&#34;&lt;t&nbsp;a=&#39;&amp;&#39;&gt;&#34;</span><span class="op" id="6773837">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773840">&#34;&lt;t&nbsp;a=&#39;&lt;&#39;&gt;&#34;</span><span class="op" id="6773851">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773854">&#34;&lt;t&gt;&amp;nbspc;&lt;/t&gt;&#34;</span><span class="op" id="6773870">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773873">&#34;&lt;t&nbsp;a&gt;&#34;</span><span class="op" id="6773880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773883">&#34;&lt;t&nbsp;a=&gt;&#34;</span><span class="op" id="6773891">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773894">&#34;&lt;t&nbsp;a=v&gt;&#34;</span><span class="op" id="6773903">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6773906">//&nbsp;&nbsp;&nbsp;&nbsp&#34;&lt;![CDATA[d]]&gt;&#34;,&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;let&nbsp;the&nbsp;Token()&nbsp;caller&nbsp;handle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773960">&#34;&lt;t&gt;&lt;/e&gt;&#34;</span><span class="op" id="6773969">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773972">&#34;&lt;t&gt;&lt;/&gt;&#34;</span><span class="op" id="6773980">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773983">&#34;&lt;t&gt;&lt;/t!&#34;</span><span class="op" id="6773992">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6773995">&#34;&lt;t&gt;cdata]]&gt;&lt;/t&gt;&#34;</span><span class="op" id="6774012">,</span><br>
<span class="lineno"></span><span class="op" id="6774014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="6774017">func</span>&nbsp;<span class="ident" id="6774022">TestRawToken</span><span class="op" id="6774034">(</span><span class="ident" id="6774035">t</span>&nbsp;<span class="op" id="6774037">*</span><span class="ident" id="6774038">testing</span><span class="op" id="6774045">.</span><span class="ident" id="6774046">T</span><span class="op" id="6774047">)</span>&nbsp;<span class="op" id="6774049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6774052">d</span>&nbsp;<span class="op" id="6774054">:=</span>&nbsp;<span class="ident" id="6774057">NewDecoder</span><span class="op" id="6774067">(</span><span class="ident" id="6774068">strings</span><span class="op" id="6774075">.</span><span class="ident" id="6774076">NewReader</span><span class="op" id="6774085">(</span><span class="ident" id="6774086">testInput</span><span class="op" id="6774095">)</span><span class="op" id="6774096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6774099">d</span><span class="op" id="6774100">.</span><span class="ident" id="6774101">Entity</span>&nbsp;<span class="op" id="6774108">=</span>&nbsp;<span class="ident" id="6774110">testEntity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6774122">testRawToken</span><span class="op" id="6774134">(</span><span class="ident" id="6774135">t</span><span class="op" id="6774136">,</span>&nbsp;<span class="ident" id="6774138">d</span><span class="op" id="6774139">,</span>&nbsp;<span class="ident" id="6774141">testInput</span><span class="op" id="6774150">,</span>&nbsp;<span class="ident" id="6774152">rawTokens</span><span class="op" id="6774161">)</span><br>
<span class="lineno"></span><span class="op" id="6774163">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="6774166">const</span>&nbsp;<span class="ident" id="6774172">nonStrictInput</span>&nbsp;<span class="op" id="6774187">=</span>&nbsp;<span class="string" id="6774189">`<br>
<span class="lineno"></span>&lt;tag&gt;non&amp;entity&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;unknown;entity&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;#123&lt;/tag&gt;<br>
<span class="lineno">180</span>&lt;tag&gt;&amp;#zzz;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;なまえ3;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;lt-gt;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;0a;&lt;/tag&gt;<br>
<span class="lineno">185</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6774351">var</span>&nbsp;<span class="ident" id="6774355">nonStringEntity</span>&nbsp;<span class="op" id="6774371">=</span>&nbsp;<span class="keyword" id="6774373">map</span><span class="op" id="6774376">[</span><span class="builtintype" id="6774377">string</span><span class="op" id="6774383">]</span><span class="builtintype" id="6774384">string</span><span class="op" id="6774390">{</span><span class="string" id="6774391">&#34;&#34;</span><span class="op" id="6774393">:</span>&nbsp;<span class="string" id="6774395">&#34;oops!&#34;</span><span class="op" id="6774402">,</span>&nbsp;<span class="string" id="6774404">&#34;0a&#34;</span><span class="op" id="6774408">:</span>&nbsp;<span class="string" id="6774410">&#34;oops!&#34;</span><span class="op" id="6774417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6774420">var</span>&nbsp;<span class="ident" id="6774424">nonStrictTokens</span>&nbsp;<span class="op" id="6774440">=</span>&nbsp;<span class="op" id="6774442">[</span><span class="op" id="6774443">]</span><span class="ident" id="6774444">Token</span><span class="op" id="6774449">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6774452">CharData</span><span class="op" id="6774460">(</span><span class="string" id="6774461">&#34;\n&#34;</span><span class="op" id="6774465">)</span><span class="op" id="6774466">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6774469">StartElement</span><span class="op" id="6774481">{</span><span class="ident" id="6774482">Name</span><span class="op" id="6774486">{</span><span class="string" id="6774487">&#34;&#34;</span><span class="op" id="6774489">,</span>&nbsp;<span class="string" id="6774491">&#34;tag&#34;</span><span class="op" id="6774496">}</span><span class="op" id="6774497">,</span>&nbsp;<span class="op" id="6774499">[</span><span class="op" id="6774500">]</span><span class="ident" id="6774501">Attr</span><span class="op" id="6774505">{</span><span class="op" id="6774506">}</span><span class="op" id="6774507">}</span><span class="op" id="6774508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6774511">CharData</span><span class="op" id="6774519">(</span><span class="string" id="6774520">&#34;non&amp;entity&#34;</span><span class="op" id="6774532">)</span><span class="op" id="6774533">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6774536">EndElement</span><span class="op" id="6774546">{</span><span class="ident" id="6774547">Name</span><span class="op" id="6774551">{</span><span class="string" id="6774552">&#34;&#34;</span><span class="op" id="6774554">,</span>&nbsp;<span class="string" id="6774556">&#34;tag&#34;</span><span class="op" id="6774561">}</span><span class="op" id="6774562">}</span><span class="op" id="6774563">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6774566">CharData</span><span class="op" id="6774574">(</span><span class="string" id="6774575">&#34;\n&#34;</span><span class="op" id="6774579">)</span><span class="op" id="6774580">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6774583">StartElement</span><span class="op" id="6774595">{</span><span class="ident" id="6774596">Name</span><span class="op" id="6774600">{</span><span class="string" id="6774601">&#34;&#34;</span><span class="op" id="6774603">,</span>&nbsp;<span class="string" id="6774605">&#34;tag&#34;</span><span class="op" id="6774610">}</span><span class="op" id="6774611">,</span>&nbsp;<span class="op" id="6774613">[</span><span class="op" id="6774614">]</span><span class="ident" id="6774615">Attr</span><span class="op" id="6774619">{</span><span class="op" id="6774620">}</span><span class="op" id="6774621">}</span><span class="op" id="6774622">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6774625">CharData</span><span class="op" id="6774633">(</span><span class="string" id="6774634">&#34;&amp;unknown;entity&#34;</span><span class="op" id="6774651">)</span><span class="op" id="6774652">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6774655">EndElement</span><span class="op" id="6774665">{</span><span class="ident" id="6774666">Name</span><span class="op" id="6774670">{</span><span class="string" id="6774671">&#34;&#34;</span><span class="op" id="6774673">,</span>&nbsp;<span class="string" id="6774675">&#34;tag&#34;</span><span class="op" id="6774680">}</span><span class="op" id="6774681">}</span><span class="op" id="6774682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6774685">CharData</span><span class="op" id="6774693">(</span><span class="string" id="6774694">&#34;\n&#34;</span><span class="op" id="6774698">)</span><span class="op" id="6774699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6774702">StartElement</span><span class="op" id="6774714">{</span><span class="ident" id="6774715">Name</span><span class="op" id="6774719">{</span><span class="string" id="6774720">&#34;&#34;</span><span class="op" id="6774722">,</span>&nbsp;<span class="string" id="6774724">&#34;tag&#34;</span><span class="op" id="6774729">}</span><span class="op" id="6774730">,</span>&nbsp;<span class="op" id="6774732">[</span><span class="op" id="6774733">]</span><span class="ident" id="6774734">Attr</span><span class="op" id="6774738">{</span><span class="op" id="6774739">}</span><span class="op" id="6774740">}</span><span class="op" id="6774741">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6774744">CharData</span><span class="op" id="6774752">(</span><span class="string" id="6774753">&#34;&amp;#123&#34;</span><span class="op" id="6774760">)</span><span class="op" id="6774761">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6774764">EndElement</span><span class="op" id="6774774">{</span><span class="ident" id="6774775">Name</span><span class="op" id="6774779">{</span><span class="string" id="6774780">&#34;&#34;</span><span class="op" id="6774782">,</span>&nbsp;<span class="string" id="6774784">&#34;tag&#34;</span><span class="op" id="6774789">}</span><span class="op" id="6774790">}</span><span class="op" id="6774791">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6774794">CharData</span><span class="op" id="6774802">(</span><span class="string" id="6774803">&#34;\n&#34;</span><span class="op" id="6774807">)</span><span class="op" id="6774808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6774811">StartElement</span><span class="op" id="6774823">{</span><span class="ident" id="6774824">Name</span><span class="op" id="6774828">{</span><span class="string" id="6774829">&#34;&#34;</span><span class="op" id="6774831">,</span>&nbsp;<span class="string" id="6774833">&#34;tag&#34;</span><span class="op" id="6774838">}</span><span class="op" id="6774839">,</span>&nbsp;<span class="op" id="6774841">[</span><span class="op" id="6774842">]</span><span class="ident" id="6774843">Attr</span><span class="op" id="6774847">{</span><span class="op" id="6774848">}</span><span class="op" id="6774849">}</span><span class="op" id="6774850">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6774853">CharData</span><span class="op" id="6774861">(</span><span class="string" id="6774862">&#34;&amp;#zzz;&#34;</span><span class="op" id="6774870">)</span><span class="op" id="6774871">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6774874">EndElement</span><span class="op" id="6774884">{</span><span class="ident" id="6774885">Name</span><span class="op" id="6774889">{</span><span class="string" id="6774890">&#34;&#34;</span><span class="op" id="6774892">,</span>&nbsp;<span class="string" id="6774894">&#34;tag&#34;</span><span class="op" id="6774899">}</span><span class="op" id="6774900">}</span><span class="op" id="6774901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6774904">CharData</span><span class="op" id="6774912">(</span><span class="string" id="6774913">&#34;\n&#34;</span><span class="op" id="6774917">)</span><span class="op" id="6774918">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6774921">StartElement</span><span class="op" id="6774933">{</span><span class="ident" id="6774934">Name</span><span class="op" id="6774938">{</span><span class="string" id="6774939">&#34;&#34;</span><span class="op" id="6774941">,</span>&nbsp;<span class="string" id="6774943">&#34;tag&#34;</span><span class="op" id="6774948">}</span><span class="op" id="6774949">,</span>&nbsp;<span class="op" id="6774951">[</span><span class="op" id="6774952">]</span><span class="ident" id="6774953">Attr</span><span class="op" id="6774957">{</span><span class="op" id="6774958">}</span><span class="op" id="6774959">}</span><span class="op" id="6774960">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6774963">CharData</span><span class="op" id="6774971">(</span><span class="string" id="6774972">&#34;&amp;なまえ3;&#34;</span><span class="op" id="6774986">)</span><span class="op" id="6774987">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6774990">EndElement</span><span class="op" id="6775000">{</span><span class="ident" id="6775001">Name</span><span class="op" id="6775005">{</span><span class="string" id="6775006">&#34;&#34;</span><span class="op" id="6775008">,</span>&nbsp;<span class="string" id="6775010">&#34;tag&#34;</span><span class="op" id="6775015">}</span><span class="op" id="6775016">}</span><span class="op" id="6775017">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6775020">CharData</span><span class="op" id="6775028">(</span><span class="string" id="6775029">&#34;\n&#34;</span><span class="op" id="6775033">)</span><span class="op" id="6775034">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6775037">StartElement</span><span class="op" id="6775049">{</span><span class="ident" id="6775050">Name</span><span class="op" id="6775054">{</span><span class="string" id="6775055">&#34;&#34;</span><span class="op" id="6775057">,</span>&nbsp;<span class="string" id="6775059">&#34;tag&#34;</span><span class="op" id="6775064">}</span><span class="op" id="6775065">,</span>&nbsp;<span class="op" id="6775067">[</span><span class="op" id="6775068">]</span><span class="ident" id="6775069">Attr</span><span class="op" id="6775073">{</span><span class="op" id="6775074">}</span><span class="op" id="6775075">}</span><span class="op" id="6775076">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6775079">CharData</span><span class="op" id="6775087">(</span><span class="string" id="6775088">&#34;&amp;lt-gt;&#34;</span><span class="op" id="6775097">)</span><span class="op" id="6775098">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6775101">EndElement</span><span class="op" id="6775111">{</span><span class="ident" id="6775112">Name</span><span class="op" id="6775116">{</span><span class="string" id="6775117">&#34;&#34;</span><span class="op" id="6775119">,</span>&nbsp;<span class="string" id="6775121">&#34;tag&#34;</span><span class="op" id="6775126">}</span><span class="op" id="6775127">}</span><span class="op" id="6775128">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6775131">CharData</span><span class="op" id="6775139">(</span><span class="string" id="6775140">&#34;\n&#34;</span><span class="op" id="6775144">)</span><span class="op" id="6775145">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6775148">StartElement</span><span class="op" id="6775160">{</span><span class="ident" id="6775161">Name</span><span class="op" id="6775165">{</span><span class="string" id="6775166">&#34;&#34;</span><span class="op" id="6775168">,</span>&nbsp;<span class="string" id="6775170">&#34;tag&#34;</span><span class="op" id="6775175">}</span><span class="op" id="6775176">,</span>&nbsp;<span class="op" id="6775178">[</span><span class="op" id="6775179">]</span><span class="ident" id="6775180">Attr</span><span class="op" id="6775184">{</span><span class="op" id="6775185">}</span><span class="op" id="6775186">}</span><span class="op" id="6775187">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6775190">CharData</span><span class="op" id="6775198">(</span><span class="string" id="6775199">&#34;&amp;;&#34;</span><span class="op" id="6775203">)</span><span class="op" id="6775204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6775207">EndElement</span><span class="op" id="6775217">{</span><span class="ident" id="6775218">Name</span><span class="op" id="6775222">{</span><span class="string" id="6775223">&#34;&#34;</span><span class="op" id="6775225">,</span>&nbsp;<span class="string" id="6775227">&#34;tag&#34;</span><span class="op" id="6775232">}</span><span class="op" id="6775233">}</span><span class="op" id="6775234">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6775237">CharData</span><span class="op" id="6775245">(</span><span class="string" id="6775246">&#34;\n&#34;</span><span class="op" id="6775250">)</span><span class="op" id="6775251">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6775254">StartElement</span><span class="op" id="6775266">{</span><span class="ident" id="6775267">Name</span><span class="op" id="6775271">{</span><span class="string" id="6775272">&#34;&#34;</span><span class="op" id="6775274">,</span>&nbsp;<span class="string" id="6775276">&#34;tag&#34;</span><span class="op" id="6775281">}</span><span class="op" id="6775282">,</span>&nbsp;<span class="op" id="6775284">[</span><span class="op" id="6775285">]</span><span class="ident" id="6775286">Attr</span><span class="op" id="6775290">{</span><span class="op" id="6775291">}</span><span class="op" id="6775292">}</span><span class="op" id="6775293">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6775296">CharData</span><span class="op" id="6775304">(</span><span class="string" id="6775305">&#34;&amp;0a;&#34;</span><span class="op" id="6775311">)</span><span class="op" id="6775312">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6775315">EndElement</span><span class="op" id="6775325">{</span><span class="ident" id="6775326">Name</span><span class="op" id="6775330">{</span><span class="string" id="6775331">&#34;&#34;</span><span class="op" id="6775333">,</span>&nbsp;<span class="string" id="6775335">&#34;tag&#34;</span><span class="op" id="6775340">}</span><span class="op" id="6775341">}</span><span class="op" id="6775342">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6775345">CharData</span><span class="op" id="6775353">(</span><span class="string" id="6775354">&#34;\n&#34;</span><span class="op" id="6775358">)</span><span class="op" id="6775359">,</span><br>
<span class="lineno"></span><span class="op" id="6775361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="6775364">func</span>&nbsp;<span class="ident" id="6775369">TestNonStrictRawToken</span><span class="op" id="6775390">(</span><span class="ident" id="6775391">t</span>&nbsp;<span class="op" id="6775393">*</span><span class="ident" id="6775394">testing</span><span class="op" id="6775401">.</span><span class="ident" id="6775402">T</span><span class="op" id="6775403">)</span>&nbsp;<span class="op" id="6775405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6775408">d</span>&nbsp;<span class="op" id="6775410">:=</span>&nbsp;<span class="ident" id="6775413">NewDecoder</span><span class="op" id="6775423">(</span><span class="ident" id="6775424">strings</span><span class="op" id="6775431">.</span><span class="ident" id="6775432">NewReader</span><span class="op" id="6775441">(</span><span class="ident" id="6775442">nonStrictInput</span><span class="op" id="6775456">)</span><span class="op" id="6775457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6775460">d</span><span class="op" id="6775461">.</span><span class="ident" id="6775462">Strict</span>&nbsp;<span class="op" id="6775469">=</span>&nbsp;<span class="builtintype" id="6775471">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6775478">testRawToken</span><span class="op" id="6775490">(</span><span class="ident" id="6775491">t</span><span class="op" id="6775492">,</span>&nbsp;<span class="ident" id="6775494">d</span><span class="op" id="6775495">,</span>&nbsp;<span class="ident" id="6775497">nonStrictInput</span><span class="op" id="6775511">,</span>&nbsp;<span class="ident" id="6775513">nonStrictTokens</span><span class="op" id="6775528">)</span><br>
<span class="lineno"></span><span class="op" id="6775530">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="6775533">type</span>&nbsp;<span class="ident" id="6775538">downCaser</span>&nbsp;<span class="keyword" id="6775548">struct</span>&nbsp;<span class="op" id="6775555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6775558">t</span>&nbsp;<span class="op" id="6775560">*</span><span class="ident" id="6775561">testing</span><span class="op" id="6775568">.</span><span class="ident" id="6775569">T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6775572">r</span>&nbsp;<span class="ident" id="6775574">io</span><span class="op" id="6775576">.</span><span class="ident" id="6775577">ByteReader</span><br>
<span class="lineno"></span><span class="op" id="6775588">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="6775591">func</span>&nbsp;<span class="op" id="6775596">(</span><span class="ident" id="6775597">d</span>&nbsp;<span class="op" id="6775599">*</span><span class="ident" id="6775600">downCaser</span><span class="op" id="6775609">)</span>&nbsp;<span class="ident" id="6775611">ReadByte</span><span class="op" id="6775619">(</span><span class="op" id="6775620">)</span>&nbsp;<span class="op" id="6775622">(</span><span class="ident" id="6775623">c</span>&nbsp;<span class="builtintype" id="6775625">byte</span><span class="op" id="6775629">,</span>&nbsp;<span class="ident" id="6775631">err</span>&nbsp;<span class="builtintype" id="6775635">error</span><span class="op" id="6775640">)</span>&nbsp;<span class="op" id="6775642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6775645">c</span><span class="op" id="6775646">,</span>&nbsp;<span class="ident" id="6775648">err</span>&nbsp;<span class="op" id="6775652">=</span>&nbsp;<span class="ident" id="6775654">d</span><span class="op" id="6775655">.</span><span class="ident" id="6775656">r</span><span class="op" id="6775657">.</span><span class="ident" id="6775658">ReadByte</span><span class="op" id="6775666">(</span><span class="op" id="6775667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6775670">if</span>&nbsp;<span class="ident" id="6775673">c</span>&nbsp;<span class="op" id="6775675">&gt;=</span>&nbsp;<span class="string" id="6775678">&#39;A&#39;</span>&nbsp;<span class="op" id="6775682">&amp;&amp;</span>&nbsp;<span class="ident" id="6775685">c</span>&nbsp;<span class="op" id="6775687">&lt;=</span>&nbsp;<span class="string" id="6775690">&#39;Z&#39;</span>&nbsp;<span class="op" id="6775694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6775698">c</span>&nbsp;<span class="op" id="6775700">+=</span>&nbsp;<span class="string" id="6775703">&#39;a&#39;</span>&nbsp;<span class="op" id="6775707">-</span>&nbsp;<span class="string" id="6775709">&#39;A&#39;</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6775714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6775717">return</span><br>
<span class="lineno"></span><span class="op" id="6775724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6775727">func</span>&nbsp;<span class="op" id="6775732">(</span><span class="ident" id="6775733">d</span>&nbsp;<span class="op" id="6775735">*</span><span class="ident" id="6775736">downCaser</span><span class="op" id="6775745">)</span>&nbsp;<span class="ident" id="6775747">Read</span><span class="op" id="6775751">(</span><span class="ident" id="6775752">p</span>&nbsp;<span class="op" id="6775754">[</span><span class="op" id="6775755">]</span><span class="builtintype" id="6775756">byte</span><span class="op" id="6775760">)</span>&nbsp;<span class="op" id="6775762">(</span><span class="builtintype" id="6775763">int</span><span class="op" id="6775766">,</span>&nbsp;<span class="builtintype" id="6775768">error</span><span class="op" id="6775773">)</span>&nbsp;<span class="op" id="6775775">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6775778">d</span><span class="op" id="6775779">.</span><span class="ident" id="6775780">t</span><span class="op" id="6775781">.</span><span class="ident" id="6775782">Fatalf</span><span class="op" id="6775788">(</span><span class="string" id="6775789">&#34;unexpected&nbsp;Read&nbsp;call&nbsp;on&nbsp;downCaser&nbsp;reader&#34;</span><span class="op" id="6775831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6775834">panic</span><span class="op" id="6775839">(</span><span class="string" id="6775840">&#34;unreachable&#34;</span><span class="op" id="6775853">)</span><br>
<span class="lineno"></span><span class="op" id="6775855">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6775858">func</span>&nbsp;<span class="ident" id="6775863">TestRawTokenAltEncoding</span><span class="op" id="6775886">(</span><span class="ident" id="6775887">t</span>&nbsp;<span class="op" id="6775889">*</span><span class="ident" id="6775890">testing</span><span class="op" id="6775897">.</span><span class="ident" id="6775898">T</span><span class="op" id="6775899">)</span>&nbsp;<span class="op" id="6775901">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6775904">d</span>&nbsp;<span class="op" id="6775906">:=</span>&nbsp;<span class="ident" id="6775909">NewDecoder</span><span class="op" id="6775919">(</span><span class="ident" id="6775920">strings</span><span class="op" id="6775927">.</span><span class="ident" id="6775928">NewReader</span><span class="op" id="6775937">(</span><span class="ident" id="6775938">testInputAltEncoding</span><span class="op" id="6775958">)</span><span class="op" id="6775959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6775962">d</span><span class="op" id="6775963">.</span><span class="ident" id="6775964">CharsetReader</span>&nbsp;<span class="op" id="6775978">=</span>&nbsp;<span class="keyword" id="6775980">func</span><span class="op" id="6775984">(</span><span class="ident" id="6775985">charset</span>&nbsp;<span class="builtintype" id="6775993">string</span><span class="op" id="6775999">,</span>&nbsp;<span class="ident" id="6776001">input</span>&nbsp;<span class="ident" id="6776007">io</span><span class="op" id="6776009">.</span><span class="ident" id="6776010">Reader</span><span class="op" id="6776016">)</span>&nbsp;<span class="op" id="6776018">(</span><span class="ident" id="6776019">io</span><span class="op" id="6776021">.</span><span class="ident" id="6776022">Reader</span><span class="op" id="6776028">,</span>&nbsp;<span class="builtintype" id="6776030">error</span><span class="op" id="6776035">)</span>&nbsp;<span class="op" id="6776037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6776041">if</span>&nbsp;<span class="ident" id="6776044">charset</span>&nbsp;<span class="op" id="6776052">!=</span>&nbsp;<span class="string" id="6776055">&#34;x-testing-uppercase&#34;</span>&nbsp;<span class="op" id="6776077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6776082">t</span><span class="op" id="6776083">.</span><span class="ident" id="6776084">Fatalf</span><span class="op" id="6776090">(</span><span class="string" id="6776091">&#34;unexpected&nbsp;charset&nbsp;%q&#34;</span><span class="op" id="6776114">,</span>&nbsp;<span class="ident" id="6776116">charset</span><span class="op" id="6776123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6776127">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6776131">return</span>&nbsp;<span class="op" id="6776138">&amp;</span><span class="ident" id="6776139">downCaser</span><span class="op" id="6776148">{</span><span class="ident" id="6776149">t</span><span class="op" id="6776150">,</span>&nbsp;<span class="ident" id="6776152">input</span><span class="op" id="6776157">.</span><span class="op" id="6776158">(</span><span class="ident" id="6776159">io</span><span class="op" id="6776161">.</span><span class="ident" id="6776162">ByteReader</span><span class="op" id="6776172">)</span><span class="op" id="6776173">}</span><span class="op" id="6776174">,</span>&nbsp;<span class="ident" id="6776176">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6776181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6776184">testRawToken</span><span class="op" id="6776196">(</span><span class="ident" id="6776197">t</span><span class="op" id="6776198">,</span>&nbsp;<span class="ident" id="6776200">d</span><span class="op" id="6776201">,</span>&nbsp;<span class="ident" id="6776203">testInputAltEncoding</span><span class="op" id="6776223">,</span>&nbsp;<span class="ident" id="6776225">rawTokensAltEncoding</span><span class="op" id="6776245">)</span><br>
<span class="lineno"></span><span class="op" id="6776247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="6776250">func</span>&nbsp;<span class="ident" id="6776255">TestRawTokenAltEncodingNoConverter</span><span class="op" id="6776289">(</span><span class="ident" id="6776290">t</span>&nbsp;<span class="op" id="6776292">*</span><span class="ident" id="6776293">testing</span><span class="op" id="6776300">.</span><span class="ident" id="6776301">T</span><span class="op" id="6776302">)</span>&nbsp;<span class="op" id="6776304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6776307">d</span>&nbsp;<span class="op" id="6776309">:=</span>&nbsp;<span class="ident" id="6776312">NewDecoder</span><span class="op" id="6776322">(</span><span class="ident" id="6776323">strings</span><span class="op" id="6776330">.</span><span class="ident" id="6776331">NewReader</span><span class="op" id="6776340">(</span><span class="ident" id="6776341">testInputAltEncoding</span><span class="op" id="6776361">)</span><span class="op" id="6776362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6776365">token</span><span class="op" id="6776370">,</span>&nbsp;<span class="ident" id="6776372">err</span>&nbsp;<span class="op" id="6776376">:=</span>&nbsp;<span class="ident" id="6776379">d</span><span class="op" id="6776380">.</span><span class="ident" id="6776381">RawToken</span><span class="op" id="6776389">(</span><span class="op" id="6776390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6776393">if</span>&nbsp;<span class="ident" id="6776396">token</span>&nbsp;<span class="op" id="6776402">==</span>&nbsp;<span class="ident" id="6776405">nil</span>&nbsp;<span class="op" id="6776409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6776413">t</span><span class="op" id="6776414">.</span><span class="ident" id="6776415">Fatalf</span><span class="op" id="6776421">(</span><span class="string" id="6776422">&#34;expected&nbsp;a&nbsp;token&nbsp;on&nbsp;first&nbsp;RawToken&nbsp;call&#34;</span><span class="op" id="6776463">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6776466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6776469">if</span>&nbsp;<span class="ident" id="6776472">err</span>&nbsp;<span class="op" id="6776476">!=</span>&nbsp;<span class="ident" id="6776479">nil</span>&nbsp;<span class="op" id="6776483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6776487">t</span><span class="op" id="6776488">.</span><span class="ident" id="6776489">Fatal</span><span class="op" id="6776494">(</span><span class="ident" id="6776495">err</span><span class="op" id="6776498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6776501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6776504">token</span><span class="op" id="6776509">,</span>&nbsp;<span class="ident" id="6776511">err</span>&nbsp;<span class="op" id="6776515">=</span>&nbsp;<span class="ident" id="6776517">d</span><span class="op" id="6776518">.</span><span class="ident" id="6776519">RawToken</span><span class="op" id="6776527">(</span><span class="op" id="6776528">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6776531">if</span>&nbsp;<span class="ident" id="6776534">token</span>&nbsp;<span class="op" id="6776540">!=</span>&nbsp;<span class="ident" id="6776543">nil</span>&nbsp;<span class="op" id="6776547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6776551">t</span><span class="op" id="6776552">.</span><span class="ident" id="6776553">Errorf</span><span class="op" id="6776559">(</span><span class="string" id="6776560">&#34;expected&nbsp;a&nbsp;nil&nbsp;token;&nbsp;got&nbsp;%#v&#34;</span><span class="op" id="6776591">,</span>&nbsp;<span class="ident" id="6776593">token</span><span class="op" id="6776598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6776601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6776604">if</span>&nbsp;<span class="ident" id="6776607">err</span>&nbsp;<span class="op" id="6776611">==</span>&nbsp;<span class="ident" id="6776614">nil</span>&nbsp;<span class="op" id="6776618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6776622">t</span><span class="op" id="6776623">.</span><span class="ident" id="6776624">Fatalf</span><span class="op" id="6776630">(</span><span class="string" id="6776631">&#34;expected&nbsp;an&nbsp;error&nbsp;on&nbsp;second&nbsp;RawToken&nbsp;call&#34;</span><span class="op" id="6776674">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6776677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6776680">const</span>&nbsp;<span class="ident" id="6776686">encoding</span>&nbsp;<span class="op" id="6776695">=</span>&nbsp;<span class="string" id="6776697">&#34;x-testing-uppercase&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6776720">if</span>&nbsp;<span class="op" id="6776723">!</span><span class="ident" id="6776724">strings</span><span class="op" id="6776731">.</span><span class="ident" id="6776732">Contains</span><span class="op" id="6776740">(</span><span class="ident" id="6776741">err</span><span class="op" id="6776744">.</span><span class="ident" id="6776745">Error</span><span class="op" id="6776750">(</span><span class="op" id="6776751">)</span><span class="op" id="6776752">,</span>&nbsp;<span class="ident" id="6776754">encoding</span><span class="op" id="6776762">)</span>&nbsp;<span class="op" id="6776764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6776768">t</span><span class="op" id="6776769">.</span><span class="ident" id="6776770">Errorf</span><span class="op" id="6776776">(</span><span class="string" id="6776777">&#34;expected&nbsp;error&nbsp;to&nbsp;contain&nbsp;%q;&nbsp;got&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="6776822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6776827">encoding</span><span class="op" id="6776835">,</span>&nbsp;<span class="ident" id="6776837">err</span><span class="op" id="6776840">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6776843">}</span><br>
<span class="lineno"></span><span class="op" id="6776845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6776848">func</span>&nbsp;<span class="ident" id="6776853">testRawToken</span><span class="op" id="6776865">(</span><span class="ident" id="6776866">t</span>&nbsp;<span class="op" id="6776868">*</span><span class="ident" id="6776869">testing</span><span class="op" id="6776876">.</span><span class="ident" id="6776877">T</span><span class="op" id="6776878">,</span>&nbsp;<span class="ident" id="6776880">d</span>&nbsp;<span class="op" id="6776882">*</span><span class="ident" id="6776883">Decoder</span><span class="op" id="6776890">,</span>&nbsp;<span class="ident" id="6776892">raw</span>&nbsp;<span class="builtintype" id="6776896">string</span><span class="op" id="6776902">,</span>&nbsp;<span class="ident" id="6776904">rawTokens</span>&nbsp;<span class="op" id="6776914">[</span><span class="op" id="6776915">]</span><span class="ident" id="6776916">Token</span><span class="op" id="6776921">)</span>&nbsp;<span class="op" id="6776923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6776926">lastEnd</span>&nbsp;<span class="op" id="6776934">:=</span>&nbsp;<span class="ident" id="6776937">int64</span><span class="op" id="6776942">(</span><span class="num" id="6776943">0</span><span class="op" id="6776944">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6776947">for</span>&nbsp;<span class="ident" id="6776951">i</span><span class="op" id="6776952">,</span>&nbsp;<span class="ident" id="6776954">want</span>&nbsp;<span class="op" id="6776959">:=</span>&nbsp;<span class="keyword" id="6776962">range</span>&nbsp;<span class="ident" id="6776968">rawTokens</span>&nbsp;<span class="op" id="6776978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6776982">start</span>&nbsp;<span class="op" id="6776988">:=</span>&nbsp;<span class="ident" id="6776991">d</span><span class="op" id="6776992">.</span><span class="ident" id="6776993">InputOffset</span><span class="op" id="6777004">(</span><span class="op" id="6777005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6777009">have</span><span class="op" id="6777013">,</span>&nbsp;<span class="ident" id="6777015">err</span>&nbsp;<span class="op" id="6777019">:=</span>&nbsp;<span class="ident" id="6777022">d</span><span class="op" id="6777023">.</span><span class="ident" id="6777024">RawToken</span><span class="op" id="6777032">(</span><span class="op" id="6777033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6777037">end</span>&nbsp;<span class="op" id="6777041">:=</span>&nbsp;<span class="ident" id="6777044">d</span><span class="op" id="6777045">.</span><span class="ident" id="6777046">InputOffset</span><span class="op" id="6777057">(</span><span class="op" id="6777058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6777062">if</span>&nbsp;<span class="ident" id="6777065">err</span>&nbsp;<span class="op" id="6777069">!=</span>&nbsp;<span class="ident" id="6777072">nil</span>&nbsp;<span class="op" id="6777076">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6777081">t</span><span class="op" id="6777082">.</span><span class="ident" id="6777083">Fatalf</span><span class="op" id="6777089">(</span><span class="string" id="6777090">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="6777122">,</span>&nbsp;<span class="ident" id="6777124">i</span><span class="op" id="6777125">,</span>&nbsp;<span class="ident" id="6777127">err</span><span class="op" id="6777130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6777134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6777138">if</span>&nbsp;<span class="op" id="6777141">!</span><span class="ident" id="6777142">reflect</span><span class="op" id="6777149">.</span><span class="ident" id="6777150">DeepEqual</span><span class="op" id="6777159">(</span><span class="ident" id="6777160">have</span><span class="op" id="6777164">,</span>&nbsp;<span class="ident" id="6777166">want</span><span class="op" id="6777170">)</span>&nbsp;<span class="op" id="6777172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6777177">var</span>&nbsp;<span class="ident" id="6777181">shave</span><span class="op" id="6777186">,</span>&nbsp;<span class="ident" id="6777188">swant</span>&nbsp;<span class="builtintype" id="6777194">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6777204">if</span>&nbsp;<span class="ident" id="6777207">_</span><span class="op" id="6777208">,</span>&nbsp;<span class="ident" id="6777210">ok</span>&nbsp;<span class="op" id="6777213">:=</span>&nbsp;<span class="ident" id="6777216">have</span><span class="op" id="6777220">.</span><span class="op" id="6777221">(</span><span class="ident" id="6777222">CharData</span><span class="op" id="6777230">)</span><span class="op" id="6777231">;</span>&nbsp;<span class="ident" id="6777233">ok</span>&nbsp;<span class="op" id="6777236">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6777242">shave</span>&nbsp;<span class="op" id="6777248">=</span>&nbsp;<span class="ident" id="6777250">fmt</span><span class="op" id="6777253">.</span><span class="ident" id="6777254">Sprintf</span><span class="op" id="6777261">(</span><span class="string" id="6777262">&#34;CharData(%q)&#34;</span><span class="op" id="6777276">,</span>&nbsp;<span class="ident" id="6777278">have</span><span class="op" id="6777282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6777287">}</span>&nbsp;<span class="keyword" id="6777289">else</span>&nbsp;<span class="op" id="6777294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6777300">shave</span>&nbsp;<span class="op" id="6777306">=</span>&nbsp;<span class="ident" id="6777308">fmt</span><span class="op" id="6777311">.</span><span class="ident" id="6777312">Sprintf</span><span class="op" id="6777319">(</span><span class="string" id="6777320">&#34;%#v&#34;</span><span class="op" id="6777325">,</span>&nbsp;<span class="ident" id="6777327">have</span><span class="op" id="6777331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6777336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6777341">if</span>&nbsp;<span class="ident" id="6777344">_</span><span class="op" id="6777345">,</span>&nbsp;<span class="ident" id="6777347">ok</span>&nbsp;<span class="op" id="6777350">:=</span>&nbsp;<span class="ident" id="6777353">want</span><span class="op" id="6777357">.</span><span class="op" id="6777358">(</span><span class="ident" id="6777359">CharData</span><span class="op" id="6777367">)</span><span class="op" id="6777368">;</span>&nbsp;<span class="ident" id="6777370">ok</span>&nbsp;<span class="op" id="6777373">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6777379">swant</span>&nbsp;<span class="op" id="6777385">=</span>&nbsp;<span class="ident" id="6777387">fmt</span><span class="op" id="6777390">.</span><span class="ident" id="6777391">Sprintf</span><span class="op" id="6777398">(</span><span class="string" id="6777399">&#34;CharData(%q)&#34;</span><span class="op" id="6777413">,</span>&nbsp;<span class="ident" id="6777415">want</span><span class="op" id="6777419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6777424">}</span>&nbsp;<span class="keyword" id="6777426">else</span>&nbsp;<span class="op" id="6777431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6777437">swant</span>&nbsp;<span class="op" id="6777443">=</span>&nbsp;<span class="ident" id="6777445">fmt</span><span class="op" id="6777448">.</span><span class="ident" id="6777449">Sprintf</span><span class="op" id="6777456">(</span><span class="string" id="6777457">&#34;%#v&#34;</span><span class="op" id="6777462">,</span>&nbsp;<span class="ident" id="6777464">want</span><span class="op" id="6777468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6777473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6777478">t</span><span class="op" id="6777479">.</span><span class="ident" id="6777480">Errorf</span><span class="op" id="6777486">(</span><span class="string" id="6777487">&#34;token&nbsp;%d&nbsp;=&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="6777511">,</span>&nbsp;<span class="ident" id="6777513">i</span><span class="op" id="6777514">,</span>&nbsp;<span class="ident" id="6777516">shave</span><span class="op" id="6777521">,</span>&nbsp;<span class="ident" id="6777523">swant</span><span class="op" id="6777528">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6777532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6777537">//&nbsp;Check&nbsp;that&nbsp;InputOffset&nbsp;returned&nbsp;actual&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6777588">switch</span>&nbsp;<span class="op" id="6777595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6777599">case</span>&nbsp;<span class="ident" id="6777604">start</span>&nbsp;<span class="op" id="6777610">&lt;</span>&nbsp;<span class="ident" id="6777612">lastEnd</span><span class="op" id="6777619">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6777624">t</span><span class="op" id="6777625">.</span><span class="ident" id="6777626">Errorf</span><span class="op" id="6777632">(</span><span class="string" id="6777633">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;is&nbsp;before&nbsp;previous&nbsp;token&#34;</span><span class="op" id="6777693">,</span>&nbsp;<span class="ident" id="6777695">i</span><span class="op" id="6777696">,</span>&nbsp;<span class="ident" id="6777698">start</span><span class="op" id="6777703">,</span>&nbsp;<span class="ident" id="6777705">end</span><span class="op" id="6777708">,</span>&nbsp;<span class="ident" id="6777710">have</span><span class="op" id="6777714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6777718">case</span>&nbsp;<span class="ident" id="6777723">start</span>&nbsp;<span class="op" id="6777729">&gt;=</span>&nbsp;<span class="ident" id="6777732">end</span><span class="op" id="6777735">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6777740">//&nbsp;Special&nbsp;case:&nbsp;EndElement&nbsp;can&nbsp;be&nbsp;synthesized.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6777791">if</span>&nbsp;<span class="ident" id="6777794">start</span>&nbsp;<span class="op" id="6777800">==</span>&nbsp;<span class="ident" id="6777803">end</span>&nbsp;<span class="op" id="6777807">&amp;&amp;</span>&nbsp;<span class="ident" id="6777810">end</span>&nbsp;<span class="op" id="6777814">==</span>&nbsp;<span class="ident" id="6777817">lastEnd</span>&nbsp;<span class="op" id="6777825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6777831">break</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6777840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6777845">t</span><span class="op" id="6777846">.</span><span class="ident" id="6777847">Errorf</span><span class="op" id="6777853">(</span><span class="string" id="6777854">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;is&nbsp;empty&#34;</span><span class="op" id="6777898">,</span>&nbsp;<span class="ident" id="6777900">i</span><span class="op" id="6777901">,</span>&nbsp;<span class="ident" id="6777903">start</span><span class="op" id="6777908">,</span>&nbsp;<span class="ident" id="6777910">end</span><span class="op" id="6777913">,</span>&nbsp;<span class="ident" id="6777915">have</span><span class="op" id="6777919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6777923">case</span>&nbsp;<span class="ident" id="6777928">end</span>&nbsp;<span class="op" id="6777932">&gt;</span>&nbsp;<span class="ident" id="6777934">int64</span><span class="op" id="6777939">(</span><span class="builtinfunc" id="6777940">len</span><span class="op" id="6777943">(</span><span class="ident" id="6777944">raw</span><span class="op" id="6777947">)</span><span class="op" id="6777948">)</span><span class="op" id="6777949">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6777954">t</span><span class="op" id="6777955">.</span><span class="ident" id="6777956">Errorf</span><span class="op" id="6777962">(</span><span class="string" id="6777963">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;extends&nbsp;beyond&nbsp;input&#34;</span><span class="op" id="6778019">,</span>&nbsp;<span class="ident" id="6778021">i</span><span class="op" id="6778022">,</span>&nbsp;<span class="ident" id="6778024">start</span><span class="op" id="6778029">,</span>&nbsp;<span class="ident" id="6778031">end</span><span class="op" id="6778034">,</span>&nbsp;<span class="ident" id="6778036">have</span><span class="op" id="6778040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6778044">default</span><span class="op" id="6778051">:</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6778056">text</span>&nbsp;<span class="op" id="6778061">:=</span>&nbsp;<span class="ident" id="6778064">raw</span><span class="op" id="6778067">[</span><span class="ident" id="6778068">start</span><span class="op" id="6778073">:</span><span class="ident" id="6778074">end</span><span class="op" id="6778077">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6778082">if</span>&nbsp;<span class="ident" id="6778085">strings</span><span class="op" id="6778092">.</span><span class="ident" id="6778093">ContainsAny</span><span class="op" id="6778104">(</span><span class="ident" id="6778105">text</span><span class="op" id="6778109">,</span>&nbsp;<span class="string" id="6778111">&#34;&lt;&gt;&#34;</span><span class="op" id="6778115">)</span>&nbsp;<span class="op" id="6778117">&amp;&amp;</span>&nbsp;<span class="op" id="6778120">(</span><span class="op" id="6778121">!</span><span class="ident" id="6778122">strings</span><span class="op" id="6778129">.</span><span class="ident" id="6778130">HasPrefix</span><span class="op" id="6778139">(</span><span class="ident" id="6778140">text</span><span class="op" id="6778144">,</span>&nbsp;<span class="string" id="6778146">&#34;&lt;&#34;</span><span class="op" id="6778149">)</span>&nbsp;<span class="op" id="6778151">||</span>&nbsp;<span class="op" id="6778154">!</span><span class="ident" id="6778155">strings</span><span class="op" id="6778162">.</span><span class="ident" id="6778163">HasSuffix</span><span class="op" id="6778172">(</span><span class="ident" id="6778173">text</span><span class="op" id="6778177">,</span>&nbsp;<span class="string" id="6778179">&#34;&gt;&#34;</span><span class="op" id="6778182">)</span><span class="op" id="6778183">)</span>&nbsp;<span class="op" id="6778185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6778191">t</span><span class="op" id="6778192">.</span><span class="ident" id="6778193">Errorf</span><span class="op" id="6778199">(</span><span class="string" id="6778200">&#34;token&nbsp;%d:&nbsp;misaligned&nbsp;raw&nbsp;token&nbsp;%#q&nbsp;for&nbsp;%T&#34;</span><span class="op" id="6778243">,</span>&nbsp;<span class="ident" id="6778245">i</span><span class="op" id="6778246">,</span>&nbsp;<span class="ident" id="6778248">text</span><span class="op" id="6778252">,</span>&nbsp;<span class="ident" id="6778254">have</span><span class="op" id="6778258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6778263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6778267">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6778271">lastEnd</span>&nbsp;<span class="op" id="6778279">=</span>&nbsp;<span class="ident" id="6778281">end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6778286">}</span><br>
<span class="lineno"></span><span class="op" id="6778288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6778291">//&nbsp;Ensure&nbsp;that&nbsp;directives&nbsp;(specifically&nbsp;!DOCTYPE)&nbsp;include&nbsp;the&nbsp;complete</span><br>
<span class="lineno">330</span><span class="comment" id="6778362">//&nbsp;text&nbsp;of&nbsp;any&nbsp;nested&nbsp;directives,&nbsp;noting&nbsp;that&nbsp;&lt;&nbsp;and&nbsp;&gt;&nbsp;do&nbsp;not&nbsp;change</span><br>
<span class="lineno"></span><span class="comment" id="6778430">//&nbsp;nesting&nbsp;depth&nbsp;if&nbsp;they&nbsp;are&nbsp;in&nbsp;single&nbsp;or&nbsp;double&nbsp;quotes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6778488">var</span>&nbsp;<span class="ident" id="6778492">nestedDirectivesInput</span>&nbsp;<span class="op" id="6778514">=</span>&nbsp;<span class="string" id="6778516">`<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]&gt;<br>
<span class="lineno">335</span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&gt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&lt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&gt;&#39;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&lt;&#39;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&#34;&gt;&#39;&gt;]&gt;<br>
<span class="lineno">340</span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&#39;&lt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6778782">var</span>&nbsp;<span class="ident" id="6778786">nestedDirectivesTokens</span>&nbsp;<span class="op" id="6778809">=</span>&nbsp;<span class="op" id="6778811">[</span><span class="op" id="6778812">]</span><span class="ident" id="6778813">Token</span><span class="op" id="6778818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6778821">CharData</span><span class="op" id="6778829">(</span><span class="string" id="6778830">&#34;\n&#34;</span><span class="op" id="6778834">)</span><span class="op" id="6778835">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6778838">Directive</span><span class="op" id="6778847">(</span><span class="string" id="6778848">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]`</span><span class="op" id="6778919">)</span><span class="op" id="6778920">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6778923">CharData</span><span class="op" id="6778931">(</span><span class="string" id="6778932">&#34;\n&#34;</span><span class="op" id="6778936">)</span><span class="op" id="6778937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6778940">Directive</span><span class="op" id="6778949">(</span><span class="string" id="6778950">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&gt;&#34;&gt;]`</span><span class="op" id="6778979">)</span><span class="op" id="6778980">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6778983">CharData</span><span class="op" id="6778991">(</span><span class="string" id="6778992">&#34;\n&#34;</span><span class="op" id="6778996">)</span><span class="op" id="6778997">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6779000">Directive</span><span class="op" id="6779009">(</span><span class="string" id="6779010">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&lt;&#34;&gt;]`</span><span class="op" id="6779039">)</span><span class="op" id="6779040">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6779043">CharData</span><span class="op" id="6779051">(</span><span class="string" id="6779052">&#34;\n&#34;</span><span class="op" id="6779056">)</span><span class="op" id="6779057">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6779060">Directive</span><span class="op" id="6779069">(</span><span class="string" id="6779070">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&gt;&#39;&gt;]`</span><span class="op" id="6779099">)</span><span class="op" id="6779100">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6779103">CharData</span><span class="op" id="6779111">(</span><span class="string" id="6779112">&#34;\n&#34;</span><span class="op" id="6779116">)</span><span class="op" id="6779117">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6779120">Directive</span><span class="op" id="6779129">(</span><span class="string" id="6779130">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&lt;&#39;&gt;]`</span><span class="op" id="6779159">)</span><span class="op" id="6779160">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6779163">CharData</span><span class="op" id="6779171">(</span><span class="string" id="6779172">&#34;\n&#34;</span><span class="op" id="6779176">)</span><span class="op" id="6779177">,</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6779180">Directive</span><span class="op" id="6779189">(</span><span class="string" id="6779190">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&#34;&gt;&#39;&gt;]`</span><span class="op" id="6779220">)</span><span class="op" id="6779221">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6779224">CharData</span><span class="op" id="6779232">(</span><span class="string" id="6779233">&#34;\n&#34;</span><span class="op" id="6779237">)</span><span class="op" id="6779238">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6779241">Directive</span><span class="op" id="6779250">(</span><span class="string" id="6779251">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&#39;&lt;&#34;&gt;]`</span><span class="op" id="6779281">)</span><span class="op" id="6779282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6779285">CharData</span><span class="op" id="6779293">(</span><span class="string" id="6779294">&#34;\n&#34;</span><span class="op" id="6779298">)</span><span class="op" id="6779299">,</span><br>
<span class="lineno"></span><span class="op" id="6779301">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="keyword" id="6779304">func</span>&nbsp;<span class="ident" id="6779309">TestNestedDirectives</span><span class="op" id="6779329">(</span><span class="ident" id="6779330">t</span>&nbsp;<span class="op" id="6779332">*</span><span class="ident" id="6779333">testing</span><span class="op" id="6779340">.</span><span class="ident" id="6779341">T</span><span class="op" id="6779342">)</span>&nbsp;<span class="op" id="6779344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6779347">d</span>&nbsp;<span class="op" id="6779349">:=</span>&nbsp;<span class="ident" id="6779352">NewDecoder</span><span class="op" id="6779362">(</span><span class="ident" id="6779363">strings</span><span class="op" id="6779370">.</span><span class="ident" id="6779371">NewReader</span><span class="op" id="6779380">(</span><span class="ident" id="6779381">nestedDirectivesInput</span><span class="op" id="6779402">)</span><span class="op" id="6779403">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6779407">for</span>&nbsp;<span class="ident" id="6779411">i</span><span class="op" id="6779412">,</span>&nbsp;<span class="ident" id="6779414">want</span>&nbsp;<span class="op" id="6779419">:=</span>&nbsp;<span class="keyword" id="6779422">range</span>&nbsp;<span class="ident" id="6779428">nestedDirectivesTokens</span>&nbsp;<span class="op" id="6779451">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6779455">have</span><span class="op" id="6779459">,</span>&nbsp;<span class="ident" id="6779461">err</span>&nbsp;<span class="op" id="6779465">:=</span>&nbsp;<span class="ident" id="6779468">d</span><span class="op" id="6779469">.</span><span class="ident" id="6779470">Token</span><span class="op" id="6779475">(</span><span class="op" id="6779476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6779480">if</span>&nbsp;<span class="ident" id="6779483">err</span>&nbsp;<span class="op" id="6779487">!=</span>&nbsp;<span class="ident" id="6779490">nil</span>&nbsp;<span class="op" id="6779494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6779499">t</span><span class="op" id="6779500">.</span><span class="ident" id="6779501">Fatalf</span><span class="op" id="6779507">(</span><span class="string" id="6779508">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="6779540">,</span>&nbsp;<span class="ident" id="6779542">i</span><span class="op" id="6779543">,</span>&nbsp;<span class="ident" id="6779545">err</span><span class="op" id="6779548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6779552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6779556">if</span>&nbsp;<span class="op" id="6779559">!</span><span class="ident" id="6779560">reflect</span><span class="op" id="6779567">.</span><span class="ident" id="6779568">DeepEqual</span><span class="op" id="6779577">(</span><span class="ident" id="6779578">have</span><span class="op" id="6779582">,</span>&nbsp;<span class="ident" id="6779584">want</span><span class="op" id="6779588">)</span>&nbsp;<span class="op" id="6779590">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6779595">t</span><span class="op" id="6779596">.</span><span class="ident" id="6779597">Errorf</span><span class="op" id="6779603">(</span><span class="string" id="6779604">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="6779629">,</span>&nbsp;<span class="ident" id="6779631">i</span><span class="op" id="6779632">,</span>&nbsp;<span class="ident" id="6779634">have</span><span class="op" id="6779638">,</span>&nbsp;<span class="ident" id="6779640">want</span><span class="op" id="6779644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6779648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6779651">}</span><br>
<span class="lineno"></span><span class="op" id="6779653">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="keyword" id="6779656">func</span>&nbsp;<span class="ident" id="6779661">TestToken</span><span class="op" id="6779670">(</span><span class="ident" id="6779671">t</span>&nbsp;<span class="op" id="6779673">*</span><span class="ident" id="6779674">testing</span><span class="op" id="6779681">.</span><span class="ident" id="6779682">T</span><span class="op" id="6779683">)</span>&nbsp;<span class="op" id="6779685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6779688">d</span>&nbsp;<span class="op" id="6779690">:=</span>&nbsp;<span class="ident" id="6779693">NewDecoder</span><span class="op" id="6779703">(</span><span class="ident" id="6779704">strings</span><span class="op" id="6779711">.</span><span class="ident" id="6779712">NewReader</span><span class="op" id="6779721">(</span><span class="ident" id="6779722">testInput</span><span class="op" id="6779731">)</span><span class="op" id="6779732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6779735">d</span><span class="op" id="6779736">.</span><span class="ident" id="6779737">Entity</span>&nbsp;<span class="op" id="6779744">=</span>&nbsp;<span class="ident" id="6779746">testEntity</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6779759">for</span>&nbsp;<span class="ident" id="6779763">i</span><span class="op" id="6779764">,</span>&nbsp;<span class="ident" id="6779766">want</span>&nbsp;<span class="op" id="6779771">:=</span>&nbsp;<span class="keyword" id="6779774">range</span>&nbsp;<span class="ident" id="6779780">cookedTokens</span>&nbsp;<span class="op" id="6779793">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6779797">have</span><span class="op" id="6779801">,</span>&nbsp;<span class="ident" id="6779803">err</span>&nbsp;<span class="op" id="6779807">:=</span>&nbsp;<span class="ident" id="6779810">d</span><span class="op" id="6779811">.</span><span class="ident" id="6779812">Token</span><span class="op" id="6779817">(</span><span class="op" id="6779818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6779822">if</span>&nbsp;<span class="ident" id="6779825">err</span>&nbsp;<span class="op" id="6779829">!=</span>&nbsp;<span class="ident" id="6779832">nil</span>&nbsp;<span class="op" id="6779836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6779841">t</span><span class="op" id="6779842">.</span><span class="ident" id="6779843">Fatalf</span><span class="op" id="6779849">(</span><span class="string" id="6779850">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="6779882">,</span>&nbsp;<span class="ident" id="6779884">i</span><span class="op" id="6779885">,</span>&nbsp;<span class="ident" id="6779887">err</span><span class="op" id="6779890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6779894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6779898">if</span>&nbsp;<span class="op" id="6779901">!</span><span class="ident" id="6779902">reflect</span><span class="op" id="6779909">.</span><span class="ident" id="6779910">DeepEqual</span><span class="op" id="6779919">(</span><span class="ident" id="6779920">have</span><span class="op" id="6779924">,</span>&nbsp;<span class="ident" id="6779926">want</span><span class="op" id="6779930">)</span>&nbsp;<span class="op" id="6779932">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6779937">t</span><span class="op" id="6779938">.</span><span class="ident" id="6779939">Errorf</span><span class="op" id="6779945">(</span><span class="string" id="6779946">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="6779971">,</span>&nbsp;<span class="ident" id="6779973">i</span><span class="op" id="6779974">,</span>&nbsp;<span class="ident" id="6779976">have</span><span class="op" id="6779980">,</span>&nbsp;<span class="ident" id="6779982">want</span><span class="op" id="6779986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6779990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6779993">}</span><br>
<span class="lineno"></span><span class="op" id="6779995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="keyword" id="6779998">func</span>&nbsp;<span class="ident" id="6780003">TestSyntax</span><span class="op" id="6780013">(</span><span class="ident" id="6780014">t</span>&nbsp;<span class="op" id="6780016">*</span><span class="ident" id="6780017">testing</span><span class="op" id="6780024">.</span><span class="ident" id="6780025">T</span><span class="op" id="6780026">)</span>&nbsp;<span class="op" id="6780028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6780031">for</span>&nbsp;<span class="ident" id="6780035">i</span>&nbsp;<span class="op" id="6780037">:=</span>&nbsp;<span class="keyword" id="6780040">range</span>&nbsp;<span class="ident" id="6780046">xmlInput</span>&nbsp;<span class="op" id="6780055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780059">d</span>&nbsp;<span class="op" id="6780061">:=</span>&nbsp;<span class="ident" id="6780064">NewDecoder</span><span class="op" id="6780074">(</span><span class="ident" id="6780075">strings</span><span class="op" id="6780082">.</span><span class="ident" id="6780083">NewReader</span><span class="op" id="6780092">(</span><span class="ident" id="6780093">xmlInput</span><span class="op" id="6780101">[</span><span class="ident" id="6780102">i</span><span class="op" id="6780103">]</span><span class="op" id="6780104">)</span><span class="op" id="6780105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6780109">var</span>&nbsp;<span class="ident" id="6780113">err</span>&nbsp;<span class="builtintype" id="6780117">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6780125">for</span>&nbsp;<span class="ident" id="6780129">_</span><span class="op" id="6780130">,</span>&nbsp;<span class="ident" id="6780132">err</span>&nbsp;<span class="op" id="6780136">=</span>&nbsp;<span class="ident" id="6780138">d</span><span class="op" id="6780139">.</span><span class="ident" id="6780140">Token</span><span class="op" id="6780145">(</span><span class="op" id="6780146">)</span><span class="op" id="6780147">;</span>&nbsp;<span class="ident" id="6780149">err</span>&nbsp;<span class="op" id="6780153">==</span>&nbsp;<span class="ident" id="6780156">nil</span><span class="op" id="6780159">;</span>&nbsp;<span class="ident" id="6780161">_</span><span class="op" id="6780162">,</span>&nbsp;<span class="ident" id="6780164">err</span>&nbsp;<span class="op" id="6780168">=</span>&nbsp;<span class="ident" id="6780170">d</span><span class="op" id="6780171">.</span><span class="ident" id="6780172">Token</span><span class="op" id="6780177">(</span><span class="op" id="6780178">)</span>&nbsp;<span class="op" id="6780180">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6780184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6780188">if</span>&nbsp;<span class="ident" id="6780191">_</span><span class="op" id="6780192">,</span>&nbsp;<span class="ident" id="6780194">ok</span>&nbsp;<span class="op" id="6780197">:=</span>&nbsp;<span class="ident" id="6780200">err</span><span class="op" id="6780203">.</span><span class="op" id="6780204">(</span><span class="op" id="6780205">*</span><span class="ident" id="6780206">SyntaxError</span><span class="op" id="6780217">)</span><span class="op" id="6780218">;</span>&nbsp;<span class="op" id="6780220">!</span><span class="ident" id="6780221">ok</span>&nbsp;<span class="op" id="6780224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780229">t</span><span class="op" id="6780230">.</span><span class="ident" id="6780231">Fatalf</span><span class="op" id="6780237">(</span><span class="string" id="6780238">`xmlInput&nbsp;&#34;%s&#34;:&nbsp;expected&nbsp;SyntaxError&nbsp;not&nbsp;received`</span><span class="op" id="6780288">,</span>&nbsp;<span class="ident" id="6780290">xmlInput</span><span class="op" id="6780298">[</span><span class="ident" id="6780299">i</span><span class="op" id="6780300">]</span><span class="op" id="6780301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6780305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6780308">}</span><br>
<span class="lineno">400</span><span class="op" id="6780310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6780313">type</span>&nbsp;<span class="ident" id="6780318">allScalars</span>&nbsp;<span class="keyword" id="6780329">struct</span>&nbsp;<span class="op" id="6780336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780339">True1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6780349">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780355">True2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6780365">bool</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780371">False1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6780381">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780387">False2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6780397">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780403">Int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6780413">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780418">Int8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6780428">int8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780434">Int16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6780444">int16</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780451">Int32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6780461">int32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780468">Int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6780478">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780485">Uint</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6780495">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780500">Uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6780510">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780517">Uint16</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6780527">uint16</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780535">Uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6780545">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780553">Uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6780563">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780571">Uintptr</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6780581">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780590">Float32</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6780600">float32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780609">Float64</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6780619">float64</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780628">String</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6780638">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780646">PtrString</span>&nbsp;<span class="op" id="6780656">*</span><span class="builtintype" id="6780657">string</span><br>
<span class="lineno"></span><span class="op" id="6780664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6780667">var</span>&nbsp;<span class="ident" id="6780671">all</span>&nbsp;<span class="op" id="6780675">=</span>&nbsp;<span class="ident" id="6780677">allScalars</span><span class="op" id="6780687">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780690">True1</span><span class="op" id="6780695">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6780701">true</span><span class="op" id="6780705">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780708">True2</span><span class="op" id="6780713">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6780719">true</span><span class="op" id="6780723">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780726">False1</span><span class="op" id="6780732">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6780737">false</span><span class="op" id="6780742">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780745">False2</span><span class="op" id="6780751">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6780756">false</span><span class="op" id="6780761">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780764">Int</span><span class="op" id="6780767">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6780775">1</span><span class="op" id="6780776">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780779">Int8</span><span class="op" id="6780783">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6780790">-</span><span class="num" id="6780791">2</span><span class="op" id="6780792">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780795">Int16</span><span class="op" id="6780800">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6780806">3</span><span class="op" id="6780807">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780810">Int32</span><span class="op" id="6780815">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6780821">-</span><span class="num" id="6780822">4</span><span class="op" id="6780823">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780826">Int64</span><span class="op" id="6780831">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6780837">5</span><span class="op" id="6780838">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780841">Uint</span><span class="op" id="6780845">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6780852">6</span><span class="op" id="6780853">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780856">Uint8</span><span class="op" id="6780861">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6780867">7</span><span class="op" id="6780868">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780871">Uint16</span><span class="op" id="6780877">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6780882">8</span><span class="op" id="6780883">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780886">Uint32</span><span class="op" id="6780892">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6780897">9</span><span class="op" id="6780898">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780901">Uint64</span><span class="op" id="6780907">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6780912">10</span><span class="op" id="6780914">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780917">Uintptr</span><span class="op" id="6780924">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="6780928">11</span><span class="op" id="6780930">,</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780933">Float32</span><span class="op" id="6780940">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="6780944">13.0</span><span class="op" id="6780948">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780951">Float64</span><span class="op" id="6780958">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="6780962">14.0</span><span class="op" id="6780966">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780969">String</span><span class="op" id="6780975">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6780980">&#34;15&#34;</span><span class="op" id="6780984">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6780987">PtrString</span><span class="op" id="6780996">:</span>&nbsp;<span class="op" id="6780998">&amp;</span><span class="ident" id="6780999">sixteen</span><span class="op" id="6781006">,</span><br>
<span class="lineno"></span><span class="op" id="6781008">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="keyword" id="6781011">var</span>&nbsp;<span class="ident" id="6781015">sixteen</span>&nbsp;<span class="op" id="6781023">=</span>&nbsp;<span class="string" id="6781025">&#34;16&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6781031">const</span>&nbsp;<span class="ident" id="6781037">testScalarsInput</span>&nbsp;<span class="op" id="6781054">=</span>&nbsp;<span class="string" id="6781056">`&lt;allscalars&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;True1&gt;true&lt;/True1&gt;<br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;True2&gt;1&lt;/True2&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;False1&gt;false&lt;/False1&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;False2&gt;0&lt;/False2&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int&gt;1&lt;/Int&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int8&gt;-2&lt;/Int8&gt;<br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int16&gt;3&lt;/Int16&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int32&gt;-4&lt;/Int32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int64&gt;5&lt;/Int64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint&gt;6&lt;/Uint&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint8&gt;7&lt;/Uint8&gt;<br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint16&gt;8&lt;/Uint16&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint32&gt;9&lt;/Uint32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint64&gt;10&lt;/Uint64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uintptr&gt;11&lt;/Uintptr&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Float&gt;12.0&lt;/Float&gt;<br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Float32&gt;13.0&lt;/Float32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Float64&gt;14.0&lt;/Float64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;String&gt;15&lt;/String&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;PtrString&gt;16&lt;/PtrString&gt;<br>
<span class="lineno"></span>&lt;/allscalars&gt;`</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span><span class="keyword" id="6781492">func</span>&nbsp;<span class="ident" id="6781497">TestAllScalars</span><span class="op" id="6781511">(</span><span class="ident" id="6781512">t</span>&nbsp;<span class="op" id="6781514">*</span><span class="ident" id="6781515">testing</span><span class="op" id="6781522">.</span><span class="ident" id="6781523">T</span><span class="op" id="6781524">)</span>&nbsp;<span class="op" id="6781526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6781529">var</span>&nbsp;<span class="ident" id="6781533">a</span>&nbsp;<span class="ident" id="6781535">allScalars</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6781547">err</span>&nbsp;<span class="op" id="6781551">:=</span>&nbsp;<span class="ident" id="6781554">Unmarshal</span><span class="op" id="6781563">(</span><span class="op" id="6781564">[</span><span class="op" id="6781565">]</span><span class="builtintype" id="6781566">byte</span><span class="op" id="6781570">(</span><span class="ident" id="6781571">testScalarsInput</span><span class="op" id="6781587">)</span><span class="op" id="6781588">,</span>&nbsp;<span class="op" id="6781590">&amp;</span><span class="ident" id="6781591">a</span><span class="op" id="6781592">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6781596">if</span>&nbsp;<span class="ident" id="6781599">err</span>&nbsp;<span class="op" id="6781603">!=</span>&nbsp;<span class="ident" id="6781606">nil</span>&nbsp;<span class="op" id="6781610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6781614">t</span><span class="op" id="6781615">.</span><span class="ident" id="6781616">Fatal</span><span class="op" id="6781621">(</span><span class="ident" id="6781622">err</span><span class="op" id="6781625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6781628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6781631">if</span>&nbsp;<span class="op" id="6781634">!</span><span class="ident" id="6781635">reflect</span><span class="op" id="6781642">.</span><span class="ident" id="6781643">DeepEqual</span><span class="op" id="6781652">(</span><span class="ident" id="6781653">a</span><span class="op" id="6781654">,</span>&nbsp;<span class="ident" id="6781656">all</span><span class="op" id="6781659">)</span>&nbsp;<span class="op" id="6781661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6781665">t</span><span class="op" id="6781666">.</span><span class="ident" id="6781667">Errorf</span><span class="op" id="6781673">(</span><span class="string" id="6781674">&#34;have&nbsp;%+v&nbsp;want&nbsp;%+v&#34;</span><span class="op" id="6781693">,</span>&nbsp;<span class="ident" id="6781695">a</span><span class="op" id="6781696">,</span>&nbsp;<span class="ident" id="6781698">all</span><span class="op" id="6781701">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6781704">}</span><br>
<span class="lineno"></span><span class="op" id="6781706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6781709">type</span>&nbsp;<span class="ident" id="6781714">item</span>&nbsp;<span class="keyword" id="6781719">struct</span>&nbsp;<span class="op" id="6781726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6781729">Field_a</span>&nbsp;<span class="builtintype" id="6781737">string</span><br>
<span class="lineno">485</span><span class="op" id="6781744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6781747">func</span>&nbsp;<span class="ident" id="6781752">TestIssue569</span><span class="op" id="6781764">(</span><span class="ident" id="6781765">t</span>&nbsp;<span class="op" id="6781767">*</span><span class="ident" id="6781768">testing</span><span class="op" id="6781775">.</span><span class="ident" id="6781776">T</span><span class="op" id="6781777">)</span>&nbsp;<span class="op" id="6781779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6781782">data</span>&nbsp;<span class="op" id="6781787">:=</span>&nbsp;<span class="string" id="6781790">`&lt;item&gt;&lt;Field_a&gt;abcd&lt;/Field_a&gt;&lt;/item&gt;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6781830">var</span>&nbsp;<span class="ident" id="6781834">i</span>&nbsp;<span class="ident" id="6781836">item</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6781842">err</span>&nbsp;<span class="op" id="6781846">:=</span>&nbsp;<span class="ident" id="6781849">Unmarshal</span><span class="op" id="6781858">(</span><span class="op" id="6781859">[</span><span class="op" id="6781860">]</span><span class="builtintype" id="6781861">byte</span><span class="op" id="6781865">(</span><span class="ident" id="6781866">data</span><span class="op" id="6781870">)</span><span class="op" id="6781871">,</span>&nbsp;<span class="op" id="6781873">&amp;</span><span class="ident" id="6781874">i</span><span class="op" id="6781875">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6781879">if</span>&nbsp;<span class="ident" id="6781882">err</span>&nbsp;<span class="op" id="6781886">!=</span>&nbsp;<span class="ident" id="6781889">nil</span>&nbsp;<span class="op" id="6781893">||</span>&nbsp;<span class="ident" id="6781896">i</span><span class="op" id="6781897">.</span><span class="ident" id="6781898">Field_a</span>&nbsp;<span class="op" id="6781906">!=</span>&nbsp;<span class="string" id="6781909">&#34;abcd&#34;</span>&nbsp;<span class="op" id="6781916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6781920">t</span><span class="op" id="6781921">.</span><span class="ident" id="6781922">Fatal</span><span class="op" id="6781927">(</span><span class="string" id="6781928">&#34;Expecting&nbsp;abcd&#34;</span><span class="op" id="6781944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6781947">}</span><br>
<span class="lineno">495</span><span class="op" id="6781949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6781952">func</span>&nbsp;<span class="ident" id="6781957">TestUnquotedAttrs</span><span class="op" id="6781974">(</span><span class="ident" id="6781975">t</span>&nbsp;<span class="op" id="6781977">*</span><span class="ident" id="6781978">testing</span><span class="op" id="6781985">.</span><span class="ident" id="6781986">T</span><span class="op" id="6781987">)</span>&nbsp;<span class="op" id="6781989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6781992">data</span>&nbsp;<span class="op" id="6781997">:=</span>&nbsp;<span class="string" id="6782000">&#34;&lt;tag&nbsp;attr=azAZ09:-_\t&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6782026">d</span>&nbsp;<span class="op" id="6782028">:=</span>&nbsp;<span class="ident" id="6782031">NewDecoder</span><span class="op" id="6782041">(</span><span class="ident" id="6782042">strings</span><span class="op" id="6782049">.</span><span class="ident" id="6782050">NewReader</span><span class="op" id="6782059">(</span><span class="ident" id="6782060">data</span><span class="op" id="6782064">)</span><span class="op" id="6782065">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6782068">d</span><span class="op" id="6782069">.</span><span class="ident" id="6782070">Strict</span>&nbsp;<span class="op" id="6782077">=</span>&nbsp;<span class="builtintype" id="6782079">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6782086">token</span><span class="op" id="6782091">,</span>&nbsp;<span class="ident" id="6782093">err</span>&nbsp;<span class="op" id="6782097">:=</span>&nbsp;<span class="ident" id="6782100">d</span><span class="op" id="6782101">.</span><span class="ident" id="6782102">Token</span><span class="op" id="6782107">(</span><span class="op" id="6782108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6782111">if</span>&nbsp;<span class="ident" id="6782114">_</span><span class="op" id="6782115">,</span>&nbsp;<span class="ident" id="6782117">ok</span>&nbsp;<span class="op" id="6782120">:=</span>&nbsp;<span class="ident" id="6782123">err</span><span class="op" id="6782126">.</span><span class="op" id="6782127">(</span><span class="op" id="6782128">*</span><span class="ident" id="6782129">SyntaxError</span><span class="op" id="6782140">)</span><span class="op" id="6782141">;</span>&nbsp;<span class="ident" id="6782143">ok</span>&nbsp;<span class="op" id="6782146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6782150">t</span><span class="op" id="6782151">.</span><span class="ident" id="6782152">Errorf</span><span class="op" id="6782158">(</span><span class="string" id="6782159">&#34;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="6782181">,</span>&nbsp;<span class="ident" id="6782183">err</span><span class="op" id="6782186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6782189">}</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6782192">if</span>&nbsp;<span class="ident" id="6782195">token</span><span class="op" id="6782200">.</span><span class="op" id="6782201">(</span><span class="ident" id="6782202">StartElement</span><span class="op" id="6782214">)</span><span class="op" id="6782215">.</span><span class="ident" id="6782216">Name</span><span class="op" id="6782220">.</span><span class="ident" id="6782221">Local</span>&nbsp;<span class="op" id="6782227">!=</span>&nbsp;<span class="string" id="6782230">&#34;tag&#34;</span>&nbsp;<span class="op" id="6782236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6782240">t</span><span class="op" id="6782241">.</span><span class="ident" id="6782242">Errorf</span><span class="op" id="6782248">(</span><span class="string" id="6782249">&#34;Unexpected&nbsp;tag&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="6782274">,</span>&nbsp;<span class="ident" id="6782276">token</span><span class="op" id="6782281">.</span><span class="op" id="6782282">(</span><span class="ident" id="6782283">StartElement</span><span class="op" id="6782295">)</span><span class="op" id="6782296">.</span><span class="ident" id="6782297">Name</span><span class="op" id="6782301">.</span><span class="ident" id="6782302">Local</span><span class="op" id="6782307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6782310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6782313">attr</span>&nbsp;<span class="op" id="6782318">:=</span>&nbsp;<span class="ident" id="6782321">token</span><span class="op" id="6782326">.</span><span class="op" id="6782327">(</span><span class="ident" id="6782328">StartElement</span><span class="op" id="6782340">)</span><span class="op" id="6782341">.</span><span class="ident" id="6782342">Attr</span><span class="op" id="6782346">[</span><span class="num" id="6782347">0</span><span class="op" id="6782348">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6782351">if</span>&nbsp;<span class="ident" id="6782354">attr</span><span class="op" id="6782358">.</span><span class="ident" id="6782359">Value</span>&nbsp;<span class="op" id="6782365">!=</span>&nbsp;<span class="string" id="6782368">&#34;azAZ09:-_&#34;</span>&nbsp;<span class="op" id="6782380">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6782384">t</span><span class="op" id="6782385">.</span><span class="ident" id="6782386">Errorf</span><span class="op" id="6782392">(</span><span class="string" id="6782393">&#34;Unexpected&nbsp;attribute&nbsp;value:&nbsp;%v&#34;</span><span class="op" id="6782425">,</span>&nbsp;<span class="ident" id="6782427">attr</span><span class="op" id="6782431">.</span><span class="ident" id="6782432">Value</span><span class="op" id="6782437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6782440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6782443">if</span>&nbsp;<span class="ident" id="6782446">attr</span><span class="op" id="6782450">.</span><span class="ident" id="6782451">Name</span><span class="op" id="6782455">.</span><span class="ident" id="6782456">Local</span>&nbsp;<span class="op" id="6782462">!=</span>&nbsp;<span class="string" id="6782465">&#34;attr&#34;</span>&nbsp;<span class="op" id="6782472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6782476">t</span><span class="op" id="6782477">.</span><span class="ident" id="6782478">Errorf</span><span class="op" id="6782484">(</span><span class="string" id="6782485">&#34;Unexpected&nbsp;attribute&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="6782516">,</span>&nbsp;<span class="ident" id="6782518">attr</span><span class="op" id="6782522">.</span><span class="ident" id="6782523">Name</span><span class="op" id="6782527">.</span><span class="ident" id="6782528">Local</span><span class="op" id="6782533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6782536">}</span><br>
<span class="lineno">515</span><span class="op" id="6782538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6782541">func</span>&nbsp;<span class="ident" id="6782546">TestValuelessAttrs</span><span class="op" id="6782564">(</span><span class="ident" id="6782565">t</span>&nbsp;<span class="op" id="6782567">*</span><span class="ident" id="6782568">testing</span><span class="op" id="6782575">.</span><span class="ident" id="6782576">T</span><span class="op" id="6782577">)</span>&nbsp;<span class="op" id="6782579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6782582">tests</span>&nbsp;<span class="op" id="6782588">:=</span>&nbsp;<span class="op" id="6782591">[</span><span class="op" id="6782592">]</span><span class="op" id="6782593">[</span><span class="num" id="6782594">3</span><span class="op" id="6782595">]</span><span class="builtintype" id="6782596">string</span><span class="op" id="6782602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6782606">{</span><span class="string" id="6782607">&#34;&lt;p&nbsp;nowrap&gt;&#34;</span><span class="op" id="6782619">,</span>&nbsp;<span class="string" id="6782621">&#34;p&#34;</span><span class="op" id="6782624">,</span>&nbsp;<span class="string" id="6782626">&#34;nowrap&#34;</span><span class="op" id="6782634">}</span><span class="op" id="6782635">,</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6782639">{</span><span class="string" id="6782640">&#34;&lt;p&nbsp;nowrap&nbsp;&gt;&#34;</span><span class="op" id="6782653">,</span>&nbsp;<span class="string" id="6782655">&#34;p&#34;</span><span class="op" id="6782658">,</span>&nbsp;<span class="string" id="6782660">&#34;nowrap&#34;</span><span class="op" id="6782668">}</span><span class="op" id="6782669">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6782673">{</span><span class="string" id="6782674">&#34;&lt;input&nbsp;checked/&gt;&#34;</span><span class="op" id="6782692">,</span>&nbsp;<span class="string" id="6782694">&#34;input&#34;</span><span class="op" id="6782701">,</span>&nbsp;<span class="string" id="6782703">&#34;checked&#34;</span><span class="op" id="6782712">}</span><span class="op" id="6782713">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6782717">{</span><span class="string" id="6782718">&#34;&lt;input&nbsp;checked&nbsp;/&gt;&#34;</span><span class="op" id="6782737">,</span>&nbsp;<span class="string" id="6782739">&#34;input&#34;</span><span class="op" id="6782746">,</span>&nbsp;<span class="string" id="6782748">&#34;checked&#34;</span><span class="op" id="6782757">}</span><span class="op" id="6782758">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6782761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6782764">for</span>&nbsp;<span class="ident" id="6782768">_</span><span class="op" id="6782769">,</span>&nbsp;<span class="ident" id="6782771">test</span>&nbsp;<span class="op" id="6782776">:=</span>&nbsp;<span class="keyword" id="6782779">range</span>&nbsp;<span class="ident" id="6782785">tests</span>&nbsp;<span class="op" id="6782791">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6782795">d</span>&nbsp;<span class="op" id="6782797">:=</span>&nbsp;<span class="ident" id="6782800">NewDecoder</span><span class="op" id="6782810">(</span><span class="ident" id="6782811">strings</span><span class="op" id="6782818">.</span><span class="ident" id="6782819">NewReader</span><span class="op" id="6782828">(</span><span class="ident" id="6782829">test</span><span class="op" id="6782833">[</span><span class="num" id="6782834">0</span><span class="op" id="6782835">]</span><span class="op" id="6782836">)</span><span class="op" id="6782837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6782841">d</span><span class="op" id="6782842">.</span><span class="ident" id="6782843">Strict</span>&nbsp;<span class="op" id="6782850">=</span>&nbsp;<span class="builtintype" id="6782852">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6782860">token</span><span class="op" id="6782865">,</span>&nbsp;<span class="ident" id="6782867">err</span>&nbsp;<span class="op" id="6782871">:=</span>&nbsp;<span class="ident" id="6782874">d</span><span class="op" id="6782875">.</span><span class="ident" id="6782876">Token</span><span class="op" id="6782881">(</span><span class="op" id="6782882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6782886">if</span>&nbsp;<span class="ident" id="6782889">_</span><span class="op" id="6782890">,</span>&nbsp;<span class="ident" id="6782892">ok</span>&nbsp;<span class="op" id="6782895">:=</span>&nbsp;<span class="ident" id="6782898">err</span><span class="op" id="6782901">.</span><span class="op" id="6782902">(</span><span class="op" id="6782903">*</span><span class="ident" id="6782904">SyntaxError</span><span class="op" id="6782915">)</span><span class="op" id="6782916">;</span>&nbsp;<span class="ident" id="6782918">ok</span>&nbsp;<span class="op" id="6782921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6782926">t</span><span class="op" id="6782927">.</span><span class="ident" id="6782928">Errorf</span><span class="op" id="6782934">(</span><span class="string" id="6782935">&#34;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="6782957">,</span>&nbsp;<span class="ident" id="6782959">err</span><span class="op" id="6782962">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6782966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6782970">if</span>&nbsp;<span class="ident" id="6782973">token</span><span class="op" id="6782978">.</span><span class="op" id="6782979">(</span><span class="ident" id="6782980">StartElement</span><span class="op" id="6782992">)</span><span class="op" id="6782993">.</span><span class="ident" id="6782994">Name</span><span class="op" id="6782998">.</span><span class="ident" id="6782999">Local</span>&nbsp;<span class="op" id="6783005">!=</span>&nbsp;<span class="ident" id="6783008">test</span><span class="op" id="6783012">[</span><span class="num" id="6783013">1</span><span class="op" id="6783014">]</span>&nbsp;<span class="op" id="6783016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6783021">t</span><span class="op" id="6783022">.</span><span class="ident" id="6783023">Errorf</span><span class="op" id="6783029">(</span><span class="string" id="6783030">&#34;Unexpected&nbsp;tag&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="6783055">,</span>&nbsp;<span class="ident" id="6783057">token</span><span class="op" id="6783062">.</span><span class="op" id="6783063">(</span><span class="ident" id="6783064">StartElement</span><span class="op" id="6783076">)</span><span class="op" id="6783077">.</span><span class="ident" id="6783078">Name</span><span class="op" id="6783082">.</span><span class="ident" id="6783083">Local</span><span class="op" id="6783088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6783092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6783096">attr</span>&nbsp;<span class="op" id="6783101">:=</span>&nbsp;<span class="ident" id="6783104">token</span><span class="op" id="6783109">.</span><span class="op" id="6783110">(</span><span class="ident" id="6783111">StartElement</span><span class="op" id="6783123">)</span><span class="op" id="6783124">.</span><span class="ident" id="6783125">Attr</span><span class="op" id="6783129">[</span><span class="num" id="6783130">0</span><span class="op" id="6783131">]</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6783135">if</span>&nbsp;<span class="ident" id="6783138">attr</span><span class="op" id="6783142">.</span><span class="ident" id="6783143">Value</span>&nbsp;<span class="op" id="6783149">!=</span>&nbsp;<span class="ident" id="6783152">test</span><span class="op" id="6783156">[</span><span class="num" id="6783157">2</span><span class="op" id="6783158">]</span>&nbsp;<span class="op" id="6783160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6783165">t</span><span class="op" id="6783166">.</span><span class="ident" id="6783167">Errorf</span><span class="op" id="6783173">(</span><span class="string" id="6783174">&#34;Unexpected&nbsp;attribute&nbsp;value:&nbsp;%v&#34;</span><span class="op" id="6783206">,</span>&nbsp;<span class="ident" id="6783208">attr</span><span class="op" id="6783212">.</span><span class="ident" id="6783213">Value</span><span class="op" id="6783218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6783222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6783226">if</span>&nbsp;<span class="ident" id="6783229">attr</span><span class="op" id="6783233">.</span><span class="ident" id="6783234">Name</span><span class="op" id="6783238">.</span><span class="ident" id="6783239">Local</span>&nbsp;<span class="op" id="6783245">!=</span>&nbsp;<span class="ident" id="6783248">test</span><span class="op" id="6783252">[</span><span class="num" id="6783253">2</span><span class="op" id="6783254">]</span>&nbsp;<span class="op" id="6783256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6783261">t</span><span class="op" id="6783262">.</span><span class="ident" id="6783263">Errorf</span><span class="op" id="6783269">(</span><span class="string" id="6783270">&#34;Unexpected&nbsp;attribute&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="6783301">,</span>&nbsp;<span class="ident" id="6783303">attr</span><span class="op" id="6783307">.</span><span class="ident" id="6783308">Name</span><span class="op" id="6783312">.</span><span class="ident" id="6783313">Local</span><span class="op" id="6783318">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6783322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6783325">}</span><br>
<span class="lineno"></span><span class="op" id="6783327">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6783330">func</span>&nbsp;<span class="ident" id="6783335">TestCopyTokenCharData</span><span class="op" id="6783356">(</span><span class="ident" id="6783357">t</span>&nbsp;<span class="op" id="6783359">*</span><span class="ident" id="6783360">testing</span><span class="op" id="6783367">.</span><span class="ident" id="6783368">T</span><span class="op" id="6783369">)</span>&nbsp;<span class="op" id="6783371">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6783374">data</span>&nbsp;<span class="op" id="6783379">:=</span>&nbsp;<span class="op" id="6783382">[</span><span class="op" id="6783383">]</span><span class="builtintype" id="6783384">byte</span><span class="op" id="6783388">(</span><span class="string" id="6783389">&#34;same&nbsp;data&#34;</span><span class="op" id="6783400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6783403">var</span>&nbsp;<span class="ident" id="6783407">tok1</span>&nbsp;<span class="ident" id="6783412">Token</span>&nbsp;<span class="op" id="6783418">=</span>&nbsp;<span class="ident" id="6783420">CharData</span><span class="op" id="6783428">(</span><span class="ident" id="6783429">data</span><span class="op" id="6783433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6783436">tok2</span>&nbsp;<span class="op" id="6783441">:=</span>&nbsp;<span class="ident" id="6783444">CopyToken</span><span class="op" id="6783453">(</span><span class="ident" id="6783454">tok1</span><span class="op" id="6783458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6783461">if</span>&nbsp;<span class="op" id="6783464">!</span><span class="ident" id="6783465">reflect</span><span class="op" id="6783472">.</span><span class="ident" id="6783473">DeepEqual</span><span class="op" id="6783482">(</span><span class="ident" id="6783483">tok1</span><span class="op" id="6783487">,</span>&nbsp;<span class="ident" id="6783489">tok2</span><span class="op" id="6783493">)</span>&nbsp;<span class="op" id="6783495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6783499">t</span><span class="op" id="6783500">.</span><span class="ident" id="6783501">Error</span><span class="op" id="6783506">(</span><span class="string" id="6783507">&#34;CopyToken(CharData)&nbsp;!=&nbsp;CharData&#34;</span><span class="op" id="6783540">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6783543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6783546">data</span><span class="op" id="6783550">[</span><span class="num" id="6783551">1</span><span class="op" id="6783552">]</span>&nbsp;<span class="op" id="6783554">=</span>&nbsp;<span class="string" id="6783556">&#39;o&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6783561">if</span>&nbsp;<span class="ident" id="6783564">reflect</span><span class="op" id="6783571">.</span><span class="ident" id="6783572">DeepEqual</span><span class="op" id="6783581">(</span><span class="ident" id="6783582">tok1</span><span class="op" id="6783586">,</span>&nbsp;<span class="ident" id="6783588">tok2</span><span class="op" id="6783592">)</span>&nbsp;<span class="op" id="6783594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6783598">t</span><span class="op" id="6783599">.</span><span class="ident" id="6783600">Error</span><span class="op" id="6783605">(</span><span class="string" id="6783606">&#34;CopyToken(CharData)&nbsp;uses&nbsp;same&nbsp;buffer.&#34;</span><span class="op" id="6783645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6783648">}</span><br>
<span class="lineno">555</span><span class="op" id="6783650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6783653">func</span>&nbsp;<span class="ident" id="6783658">TestCopyTokenStartElement</span><span class="op" id="6783683">(</span><span class="ident" id="6783684">t</span>&nbsp;<span class="op" id="6783686">*</span><span class="ident" id="6783687">testing</span><span class="op" id="6783694">.</span><span class="ident" id="6783695">T</span><span class="op" id="6783696">)</span>&nbsp;<span class="op" id="6783698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6783701">elt</span>&nbsp;<span class="op" id="6783705">:=</span>&nbsp;<span class="ident" id="6783708">StartElement</span><span class="op" id="6783720">{</span><span class="ident" id="6783721">Name</span><span class="op" id="6783725">{</span><span class="string" id="6783726">&#34;&#34;</span><span class="op" id="6783728">,</span>&nbsp;<span class="string" id="6783730">&#34;hello&#34;</span><span class="op" id="6783737">}</span><span class="op" id="6783738">,</span>&nbsp;<span class="op" id="6783740">[</span><span class="op" id="6783741">]</span><span class="ident" id="6783742">Attr</span><span class="op" id="6783746">{</span><span class="op" id="6783747">{</span><span class="ident" id="6783748">Name</span><span class="op" id="6783752">{</span><span class="string" id="6783753">&#34;&#34;</span><span class="op" id="6783755">,</span>&nbsp;<span class="string" id="6783757">&#34;lang&#34;</span><span class="op" id="6783763">}</span><span class="op" id="6783764">,</span>&nbsp;<span class="string" id="6783766">&#34;en&#34;</span><span class="op" id="6783770">}</span><span class="op" id="6783771">}</span><span class="op" id="6783772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6783775">var</span>&nbsp;<span class="ident" id="6783779">tok1</span>&nbsp;<span class="ident" id="6783784">Token</span>&nbsp;<span class="op" id="6783790">=</span>&nbsp;<span class="ident" id="6783792">elt</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6783797">tok2</span>&nbsp;<span class="op" id="6783802">:=</span>&nbsp;<span class="ident" id="6783805">CopyToken</span><span class="op" id="6783814">(</span><span class="ident" id="6783815">tok1</span><span class="op" id="6783819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6783822">if</span>&nbsp;<span class="ident" id="6783825">tok1</span><span class="op" id="6783829">.</span><span class="op" id="6783830">(</span><span class="ident" id="6783831">StartElement</span><span class="op" id="6783843">)</span><span class="op" id="6783844">.</span><span class="ident" id="6783845">Attr</span><span class="op" id="6783849">[</span><span class="num" id="6783850">0</span><span class="op" id="6783851">]</span><span class="op" id="6783852">.</span><span class="ident" id="6783853">Value</span>&nbsp;<span class="op" id="6783859">!=</span>&nbsp;<span class="string" id="6783862">&#34;en&#34;</span>&nbsp;<span class="op" id="6783867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6783871">t</span><span class="op" id="6783872">.</span><span class="ident" id="6783873">Error</span><span class="op" id="6783878">(</span><span class="string" id="6783879">&#34;CopyToken&nbsp;overwrote&nbsp;Attr[0]&#34;</span><span class="op" id="6783908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6783911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6783914">if</span>&nbsp;<span class="op" id="6783917">!</span><span class="ident" id="6783918">reflect</span><span class="op" id="6783925">.</span><span class="ident" id="6783926">DeepEqual</span><span class="op" id="6783935">(</span><span class="ident" id="6783936">tok1</span><span class="op" id="6783940">,</span>&nbsp;<span class="ident" id="6783942">tok2</span><span class="op" id="6783946">)</span>&nbsp;<span class="op" id="6783948">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6783952">t</span><span class="op" id="6783953">.</span><span class="ident" id="6783954">Error</span><span class="op" id="6783959">(</span><span class="string" id="6783960">&#34;CopyToken(StartElement)&nbsp;!=&nbsp;StartElement&#34;</span><span class="op" id="6784001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6784004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6784007">tok1</span><span class="op" id="6784011">.</span><span class="op" id="6784012">(</span><span class="ident" id="6784013">StartElement</span><span class="op" id="6784025">)</span><span class="op" id="6784026">.</span><span class="ident" id="6784027">Attr</span><span class="op" id="6784031">[</span><span class="num" id="6784032">0</span><span class="op" id="6784033">]</span>&nbsp;<span class="op" id="6784035">=</span>&nbsp;<span class="ident" id="6784037">Attr</span><span class="op" id="6784041">{</span><span class="ident" id="6784042">Name</span><span class="op" id="6784046">{</span><span class="string" id="6784047">&#34;&#34;</span><span class="op" id="6784049">,</span>&nbsp;<span class="string" id="6784051">&#34;lang&#34;</span><span class="op" id="6784057">}</span><span class="op" id="6784058">,</span>&nbsp;<span class="string" id="6784060">&#34;de&#34;</span><span class="op" id="6784064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6784067">if</span>&nbsp;<span class="ident" id="6784070">reflect</span><span class="op" id="6784077">.</span><span class="ident" id="6784078">DeepEqual</span><span class="op" id="6784087">(</span><span class="ident" id="6784088">tok1</span><span class="op" id="6784092">,</span>&nbsp;<span class="ident" id="6784094">tok2</span><span class="op" id="6784098">)</span>&nbsp;<span class="op" id="6784100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6784104">t</span><span class="op" id="6784105">.</span><span class="ident" id="6784106">Error</span><span class="op" id="6784111">(</span><span class="string" id="6784112">&#34;CopyToken(CharData)&nbsp;uses&nbsp;same&nbsp;buffer.&#34;</span><span class="op" id="6784151">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6784154">}</span><br>
<span class="lineno"></span><span class="op" id="6784156">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6784159">func</span>&nbsp;<span class="ident" id="6784164">TestSyntaxErrorLineNum</span><span class="op" id="6784186">(</span><span class="ident" id="6784187">t</span>&nbsp;<span class="op" id="6784189">*</span><span class="ident" id="6784190">testing</span><span class="op" id="6784197">.</span><span class="ident" id="6784198">T</span><span class="op" id="6784199">)</span>&nbsp;<span class="op" id="6784201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6784204">testInput</span>&nbsp;<span class="op" id="6784214">:=</span>&nbsp;<span class="string" id="6784217">&#34;&lt;P&gt;Foo&lt;P&gt;\n\n&lt;P&gt;Bar&lt;/&gt;\n&#34;</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6784245">d</span>&nbsp;<span class="op" id="6784247">:=</span>&nbsp;<span class="ident" id="6784250">NewDecoder</span><span class="op" id="6784260">(</span><span class="ident" id="6784261">strings</span><span class="op" id="6784268">.</span><span class="ident" id="6784269">NewReader</span><span class="op" id="6784278">(</span><span class="ident" id="6784279">testInput</span><span class="op" id="6784288">)</span><span class="op" id="6784289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6784292">var</span>&nbsp;<span class="ident" id="6784296">err</span>&nbsp;<span class="builtintype" id="6784300">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6784307">for</span>&nbsp;<span class="ident" id="6784311">_</span><span class="op" id="6784312">,</span>&nbsp;<span class="ident" id="6784314">err</span>&nbsp;<span class="op" id="6784318">=</span>&nbsp;<span class="ident" id="6784320">d</span><span class="op" id="6784321">.</span><span class="ident" id="6784322">Token</span><span class="op" id="6784327">(</span><span class="op" id="6784328">)</span><span class="op" id="6784329">;</span>&nbsp;<span class="ident" id="6784331">err</span>&nbsp;<span class="op" id="6784335">==</span>&nbsp;<span class="ident" id="6784338">nil</span><span class="op" id="6784341">;</span>&nbsp;<span class="ident" id="6784343">_</span><span class="op" id="6784344">,</span>&nbsp;<span class="ident" id="6784346">err</span>&nbsp;<span class="op" id="6784350">=</span>&nbsp;<span class="ident" id="6784352">d</span><span class="op" id="6784353">.</span><span class="ident" id="6784354">Token</span><span class="op" id="6784359">(</span><span class="op" id="6784360">)</span>&nbsp;<span class="op" id="6784362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6784365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6784368">synerr</span><span class="op" id="6784374">,</span>&nbsp;<span class="ident" id="6784376">ok</span>&nbsp;<span class="op" id="6784379">:=</span>&nbsp;<span class="ident" id="6784382">err</span><span class="op" id="6784385">.</span><span class="op" id="6784386">(</span><span class="op" id="6784387">*</span><span class="ident" id="6784388">SyntaxError</span><span class="op" id="6784399">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6784402">if</span>&nbsp;<span class="op" id="6784405">!</span><span class="ident" id="6784406">ok</span>&nbsp;<span class="op" id="6784409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6784413">t</span><span class="op" id="6784414">.</span><span class="ident" id="6784415">Error</span><span class="op" id="6784420">(</span><span class="string" id="6784421">&#34;Expected&nbsp;SyntaxError.&#34;</span><span class="op" id="6784444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6784447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6784450">if</span>&nbsp;<span class="ident" id="6784453">synerr</span><span class="op" id="6784459">.</span><span class="ident" id="6784460">Line</span>&nbsp;<span class="op" id="6784465">!=</span>&nbsp;<span class="num" id="6784468">3</span>&nbsp;<span class="op" id="6784470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6784474">t</span><span class="op" id="6784475">.</span><span class="ident" id="6784476">Error</span><span class="op" id="6784481">(</span><span class="string" id="6784482">&#34;SyntaxError&nbsp;didn&#39;t&nbsp;have&nbsp;correct&nbsp;line&nbsp;number.&#34;</span><span class="op" id="6784528">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6784531">}</span><br>
<span class="lineno"></span><span class="op" id="6784533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6784536">func</span>&nbsp;<span class="ident" id="6784541">TestTrailingRawToken</span><span class="op" id="6784561">(</span><span class="ident" id="6784562">t</span>&nbsp;<span class="op" id="6784564">*</span><span class="ident" id="6784565">testing</span><span class="op" id="6784572">.</span><span class="ident" id="6784573">T</span><span class="op" id="6784574">)</span>&nbsp;<span class="op" id="6784576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6784579">input</span>&nbsp;<span class="op" id="6784585">:=</span>&nbsp;<span class="string" id="6784588">`&lt;FOO&gt;&lt;/FOO&gt;&nbsp;&nbsp;`</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6784605">d</span>&nbsp;<span class="op" id="6784607">:=</span>&nbsp;<span class="ident" id="6784610">NewDecoder</span><span class="op" id="6784620">(</span><span class="ident" id="6784621">strings</span><span class="op" id="6784628">.</span><span class="ident" id="6784629">NewReader</span><span class="op" id="6784638">(</span><span class="ident" id="6784639">input</span><span class="op" id="6784644">)</span><span class="op" id="6784645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6784648">var</span>&nbsp;<span class="ident" id="6784652">err</span>&nbsp;<span class="builtintype" id="6784656">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6784663">for</span>&nbsp;<span class="ident" id="6784667">_</span><span class="op" id="6784668">,</span>&nbsp;<span class="ident" id="6784670">err</span>&nbsp;<span class="op" id="6784674">=</span>&nbsp;<span class="ident" id="6784676">d</span><span class="op" id="6784677">.</span><span class="ident" id="6784678">RawToken</span><span class="op" id="6784686">(</span><span class="op" id="6784687">)</span><span class="op" id="6784688">;</span>&nbsp;<span class="ident" id="6784690">err</span>&nbsp;<span class="op" id="6784694">==</span>&nbsp;<span class="ident" id="6784697">nil</span><span class="op" id="6784700">;</span>&nbsp;<span class="ident" id="6784702">_</span><span class="op" id="6784703">,</span>&nbsp;<span class="ident" id="6784705">err</span>&nbsp;<span class="op" id="6784709">=</span>&nbsp;<span class="ident" id="6784711">d</span><span class="op" id="6784712">.</span><span class="ident" id="6784713">RawToken</span><span class="op" id="6784721">(</span><span class="op" id="6784722">)</span>&nbsp;<span class="op" id="6784724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6784727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6784730">if</span>&nbsp;<span class="ident" id="6784733">err</span>&nbsp;<span class="op" id="6784737">!=</span>&nbsp;<span class="ident" id="6784740">io</span><span class="op" id="6784742">.</span><span class="ident" id="6784743">EOF</span>&nbsp;<span class="op" id="6784747">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6784751">t</span><span class="op" id="6784752">.</span><span class="ident" id="6784753">Fatalf</span><span class="op" id="6784759">(</span><span class="string" id="6784760">&#34;d.RawToken()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="6784798">,</span>&nbsp;<span class="ident" id="6784800">err</span><span class="op" id="6784803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6784806">}</span><br>
<span class="lineno"></span><span class="op" id="6784808">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6784811">func</span>&nbsp;<span class="ident" id="6784816">TestTrailingToken</span><span class="op" id="6784833">(</span><span class="ident" id="6784834">t</span>&nbsp;<span class="op" id="6784836">*</span><span class="ident" id="6784837">testing</span><span class="op" id="6784844">.</span><span class="ident" id="6784845">T</span><span class="op" id="6784846">)</span>&nbsp;<span class="op" id="6784848">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6784851">input</span>&nbsp;<span class="op" id="6784857">:=</span>&nbsp;<span class="string" id="6784860">`&lt;FOO&gt;&lt;/FOO&gt;&nbsp;&nbsp;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6784877">d</span>&nbsp;<span class="op" id="6784879">:=</span>&nbsp;<span class="ident" id="6784882">NewDecoder</span><span class="op" id="6784892">(</span><span class="ident" id="6784893">strings</span><span class="op" id="6784900">.</span><span class="ident" id="6784901">NewReader</span><span class="op" id="6784910">(</span><span class="ident" id="6784911">input</span><span class="op" id="6784916">)</span><span class="op" id="6784917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6784920">var</span>&nbsp;<span class="ident" id="6784924">err</span>&nbsp;<span class="builtintype" id="6784928">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6784935">for</span>&nbsp;<span class="ident" id="6784939">_</span><span class="op" id="6784940">,</span>&nbsp;<span class="ident" id="6784942">err</span>&nbsp;<span class="op" id="6784946">=</span>&nbsp;<span class="ident" id="6784948">d</span><span class="op" id="6784949">.</span><span class="ident" id="6784950">Token</span><span class="op" id="6784955">(</span><span class="op" id="6784956">)</span><span class="op" id="6784957">;</span>&nbsp;<span class="ident" id="6784959">err</span>&nbsp;<span class="op" id="6784963">==</span>&nbsp;<span class="ident" id="6784966">nil</span><span class="op" id="6784969">;</span>&nbsp;<span class="ident" id="6784971">_</span><span class="op" id="6784972">,</span>&nbsp;<span class="ident" id="6784974">err</span>&nbsp;<span class="op" id="6784978">=</span>&nbsp;<span class="ident" id="6784980">d</span><span class="op" id="6784981">.</span><span class="ident" id="6784982">Token</span><span class="op" id="6784987">(</span><span class="op" id="6784988">)</span>&nbsp;<span class="op" id="6784990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6784993">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6784996">if</span>&nbsp;<span class="ident" id="6784999">err</span>&nbsp;<span class="op" id="6785003">!=</span>&nbsp;<span class="ident" id="6785006">io</span><span class="op" id="6785008">.</span><span class="ident" id="6785009">EOF</span>&nbsp;<span class="op" id="6785013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6785017">t</span><span class="op" id="6785018">.</span><span class="ident" id="6785019">Fatalf</span><span class="op" id="6785025">(</span><span class="string" id="6785026">&#34;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="6785061">,</span>&nbsp;<span class="ident" id="6785063">err</span><span class="op" id="6785066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6785069">}</span><br>
<span class="lineno"></span><span class="op" id="6785071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span><span class="keyword" id="6785074">func</span>&nbsp;<span class="ident" id="6785079">TestEntityInsideCDATA</span><span class="op" id="6785100">(</span><span class="ident" id="6785101">t</span>&nbsp;<span class="op" id="6785103">*</span><span class="ident" id="6785104">testing</span><span class="op" id="6785111">.</span><span class="ident" id="6785112">T</span><span class="op" id="6785113">)</span>&nbsp;<span class="op" id="6785115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6785118">input</span>&nbsp;<span class="op" id="6785124">:=</span>&nbsp;<span class="string" id="6785127">`&lt;test&gt;&lt;![CDATA[&nbsp;&amp;val=foo&nbsp;]]&gt;&lt;/test&gt;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6785166">d</span>&nbsp;<span class="op" id="6785168">:=</span>&nbsp;<span class="ident" id="6785171">NewDecoder</span><span class="op" id="6785181">(</span><span class="ident" id="6785182">strings</span><span class="op" id="6785189">.</span><span class="ident" id="6785190">NewReader</span><span class="op" id="6785199">(</span><span class="ident" id="6785200">input</span><span class="op" id="6785205">)</span><span class="op" id="6785206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6785209">var</span>&nbsp;<span class="ident" id="6785213">err</span>&nbsp;<span class="builtintype" id="6785217">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6785224">for</span>&nbsp;<span class="ident" id="6785228">_</span><span class="op" id="6785229">,</span>&nbsp;<span class="ident" id="6785231">err</span>&nbsp;<span class="op" id="6785235">=</span>&nbsp;<span class="ident" id="6785237">d</span><span class="op" id="6785238">.</span><span class="ident" id="6785239">Token</span><span class="op" id="6785244">(</span><span class="op" id="6785245">)</span><span class="op" id="6785246">;</span>&nbsp;<span class="ident" id="6785248">err</span>&nbsp;<span class="op" id="6785252">==</span>&nbsp;<span class="ident" id="6785255">nil</span><span class="op" id="6785258">;</span>&nbsp;<span class="ident" id="6785260">_</span><span class="op" id="6785261">,</span>&nbsp;<span class="ident" id="6785263">err</span>&nbsp;<span class="op" id="6785267">=</span>&nbsp;<span class="ident" id="6785269">d</span><span class="op" id="6785270">.</span><span class="ident" id="6785271">Token</span><span class="op" id="6785276">(</span><span class="op" id="6785277">)</span>&nbsp;<span class="op" id="6785279">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6785282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6785285">if</span>&nbsp;<span class="ident" id="6785288">err</span>&nbsp;<span class="op" id="6785292">!=</span>&nbsp;<span class="ident" id="6785295">io</span><span class="op" id="6785297">.</span><span class="ident" id="6785298">EOF</span>&nbsp;<span class="op" id="6785302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6785306">t</span><span class="op" id="6785307">.</span><span class="ident" id="6785308">Fatalf</span><span class="op" id="6785314">(</span><span class="string" id="6785315">&#34;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="6785350">,</span>&nbsp;<span class="ident" id="6785352">err</span><span class="op" id="6785355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6785358">}</span><br>
<span class="lineno"></span><span class="op" id="6785360">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span><span class="keyword" id="6785363">var</span>&nbsp;<span class="ident" id="6785367">characterTests</span>&nbsp;<span class="op" id="6785382">=</span>&nbsp;<span class="op" id="6785384">[</span><span class="op" id="6785385">]</span><span class="keyword" id="6785386">struct</span>&nbsp;<span class="op" id="6785393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6785396">in</span>&nbsp;&nbsp;<span class="builtintype" id="6785400">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6785408">err</span>&nbsp;<span class="builtintype" id="6785412">string</span><br>
<span class="lineno"></span><span class="op" id="6785419">}</span><span class="op" id="6785420">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6785423">{</span><span class="string" id="6785424">&#34;\x12&lt;doc/&gt;&#34;</span><span class="op" id="6785436">,</span>&nbsp;<span class="string" id="6785438">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+0012&#34;</span><span class="op" id="6785469">}</span><span class="op" id="6785470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6785473">{</span><span class="string" id="6785474">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;\x0b&lt;doc/&gt;&#34;</span><span class="op" id="6785509">,</span>&nbsp;<span class="string" id="6785511">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+000B&#34;</span><span class="op" id="6785542">}</span><span class="op" id="6785543">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6785546">{</span><span class="string" id="6785547">&#34;\xef\xbf\xbe&lt;doc/&gt;&#34;</span><span class="op" id="6785567">,</span>&nbsp;<span class="string" id="6785569">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+FFFE&#34;</span><span class="op" id="6785600">}</span><span class="op" id="6785601">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6785604">{</span><span class="string" id="6785605">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;&lt;doc&gt;\r\n&lt;hiya/&gt;\x07&lt;toots/&gt;&lt;/doc&gt;&#34;</span><span class="op" id="6785664">,</span>&nbsp;<span class="string" id="6785666">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+0007&#34;</span><span class="op" id="6785697">}</span><span class="op" id="6785698">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6785701">{</span><span class="string" id="6785702">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;&lt;doc&nbsp;\x12=&#39;value&#39;&gt;what&#39;s&nbsp;up&lt;/doc&gt;&#34;</span><span class="op" id="6785760">,</span>&nbsp;<span class="string" id="6785762">&#34;expected&nbsp;attribute&nbsp;name&nbsp;in&nbsp;element&#34;</span><span class="op" id="6785798">}</span><span class="op" id="6785799">,</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6785802">{</span><span class="string" id="6785803">&#34;&lt;doc&gt;&amp;abc\x01;&lt;/doc&gt;&#34;</span><span class="op" id="6785825">,</span>&nbsp;<span class="string" id="6785827">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;abc&nbsp;(no&nbsp;semicolon)&#34;</span><span class="op" id="6785873">}</span><span class="op" id="6785874">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6785877">{</span><span class="string" id="6785878">&#34;&lt;doc&gt;&amp;\x01;&lt;/doc&gt;&#34;</span><span class="op" id="6785897">,</span>&nbsp;<span class="string" id="6785899">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;&nbsp;(no&nbsp;semicolon)&#34;</span><span class="op" id="6785942">}</span><span class="op" id="6785943">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6785946">{</span><span class="string" id="6785947">&#34;&lt;doc&gt;&amp;\xef\xbf\xbe;&lt;/doc&gt;&#34;</span><span class="op" id="6785974">,</span>&nbsp;<span class="string" id="6785976">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;\uFFFE;&#34;</span><span class="op" id="6786011">}</span><span class="op" id="6786012">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6786015">{</span><span class="string" id="6786016">&#34;&lt;doc&gt;&amp;hello;&lt;/doc&gt;&#34;</span><span class="op" id="6786036">,</span>&nbsp;<span class="string" id="6786038">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;hello;&#34;</span><span class="op" id="6786072">}</span><span class="op" id="6786073">,</span><br>
<span class="lineno"></span><span class="op" id="6786075">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span><span class="keyword" id="6786078">func</span>&nbsp;<span class="ident" id="6786083">TestDisallowedCharacters</span><span class="op" id="6786107">(</span><span class="ident" id="6786108">t</span>&nbsp;<span class="op" id="6786110">*</span><span class="ident" id="6786111">testing</span><span class="op" id="6786118">.</span><span class="ident" id="6786119">T</span><span class="op" id="6786120">)</span>&nbsp;<span class="op" id="6786122">{</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6786126">for</span>&nbsp;<span class="ident" id="6786130">i</span><span class="op" id="6786131">,</span>&nbsp;<span class="ident" id="6786133">tt</span>&nbsp;<span class="op" id="6786136">:=</span>&nbsp;<span class="keyword" id="6786139">range</span>&nbsp;<span class="ident" id="6786145">characterTests</span>&nbsp;<span class="op" id="6786160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6786164">d</span>&nbsp;<span class="op" id="6786166">:=</span>&nbsp;<span class="ident" id="6786169">NewDecoder</span><span class="op" id="6786179">(</span><span class="ident" id="6786180">strings</span><span class="op" id="6786187">.</span><span class="ident" id="6786188">NewReader</span><span class="op" id="6786197">(</span><span class="ident" id="6786198">tt</span><span class="op" id="6786200">.</span><span class="ident" id="6786201">in</span><span class="op" id="6786203">)</span><span class="op" id="6786204">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6786208">var</span>&nbsp;<span class="ident" id="6786212">err</span>&nbsp;<span class="builtintype" id="6786216">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6786225">for</span>&nbsp;<span class="ident" id="6786229">err</span>&nbsp;<span class="op" id="6786233">==</span>&nbsp;<span class="ident" id="6786236">nil</span>&nbsp;<span class="op" id="6786240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6786245">_</span><span class="op" id="6786246">,</span>&nbsp;<span class="ident" id="6786248">err</span>&nbsp;<span class="op" id="6786252">=</span>&nbsp;<span class="ident" id="6786254">d</span><span class="op" id="6786255">.</span><span class="ident" id="6786256">Token</span><span class="op" id="6786261">(</span><span class="op" id="6786262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6786266">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6786270">synerr</span><span class="op" id="6786276">,</span>&nbsp;<span class="ident" id="6786278">ok</span>&nbsp;<span class="op" id="6786281">:=</span>&nbsp;<span class="ident" id="6786284">err</span><span class="op" id="6786287">.</span><span class="op" id="6786288">(</span><span class="op" id="6786289">*</span><span class="ident" id="6786290">SyntaxError</span><span class="op" id="6786301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6786305">if</span>&nbsp;<span class="op" id="6786308">!</span><span class="ident" id="6786309">ok</span>&nbsp;<span class="op" id="6786312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6786317">t</span><span class="op" id="6786318">.</span><span class="ident" id="6786319">Fatalf</span><span class="op" id="6786325">(</span><span class="string" id="6786326">&#34;input&nbsp;%d&nbsp;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;*SyntaxError&#34;</span><span class="op" id="6786376">,</span>&nbsp;<span class="ident" id="6786378">i</span><span class="op" id="6786379">,</span>&nbsp;<span class="ident" id="6786381">err</span><span class="op" id="6786384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6786388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6786392">if</span>&nbsp;<span class="ident" id="6786395">synerr</span><span class="op" id="6786401">.</span><span class="ident" id="6786402">Msg</span>&nbsp;<span class="op" id="6786406">!=</span>&nbsp;<span class="ident" id="6786409">tt</span><span class="op" id="6786411">.</span><span class="ident" id="6786412">err</span>&nbsp;<span class="op" id="6786416">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6786421">t</span><span class="op" id="6786422">.</span><span class="ident" id="6786423">Fatalf</span><span class="op" id="6786429">(</span><span class="string" id="6786430">&#34;input&nbsp;%d&nbsp;synerr.Msg&nbsp;wrong:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6786474">,</span>&nbsp;<span class="ident" id="6786476">i</span><span class="op" id="6786477">,</span>&nbsp;<span class="ident" id="6786479">tt</span><span class="op" id="6786481">.</span><span class="ident" id="6786482">err</span><span class="op" id="6786485">,</span>&nbsp;<span class="ident" id="6786487">synerr</span><span class="op" id="6786493">.</span><span class="ident" id="6786494">Msg</span><span class="op" id="6786497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6786501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6786504">}</span><br>
<span class="lineno"></span><span class="op" id="6786506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">655</span><span class="keyword" id="6786509">type</span>&nbsp;<span class="ident" id="6786514">procInstEncodingTest</span>&nbsp;<span class="keyword" id="6786535">struct</span>&nbsp;<span class="op" id="6786542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6786545">expect</span><span class="op" id="6786551">,</span>&nbsp;<span class="ident" id="6786553">got</span>&nbsp;<span class="builtintype" id="6786557">string</span><br>
<span class="lineno"></span><span class="op" id="6786564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6786567">var</span>&nbsp;<span class="ident" id="6786571">procInstTests</span>&nbsp;<span class="op" id="6786585">=</span>&nbsp;<span class="op" id="6786587">[</span><span class="op" id="6786588">]</span><span class="keyword" id="6786589">struct</span>&nbsp;<span class="op" id="6786596">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6786599">input</span><span class="op" id="6786604">,</span>&nbsp;<span class="ident" id="6786606">expect</span>&nbsp;<span class="builtintype" id="6786613">string</span><br>
<span class="lineno"></span><span class="op" id="6786620">}</span><span class="op" id="6786621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6786624">{</span><span class="string" id="6786625">`version=&#34;1.0&#34;&nbsp;encoding=&#34;utf-8&#34;`</span><span class="op" id="6786657">,</span>&nbsp;<span class="string" id="6786659">&#34;utf-8&#34;</span><span class="op" id="6786666">}</span><span class="op" id="6786667">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6786670">{</span><span class="string" id="6786671">`version=&#34;1.0&#34;&nbsp;encoding=&#39;utf-8&#39;`</span><span class="op" id="6786703">,</span>&nbsp;<span class="string" id="6786705">&#34;utf-8&#34;</span><span class="op" id="6786712">}</span><span class="op" id="6786713">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6786716">{</span><span class="string" id="6786717">`version=&#34;1.0&#34;&nbsp;encoding=&#39;utf-8&#39;&nbsp;`</span><span class="op" id="6786750">,</span>&nbsp;<span class="string" id="6786752">&#34;utf-8&#34;</span><span class="op" id="6786759">}</span><span class="op" id="6786760">,</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6786763">{</span><span class="string" id="6786764">`version=&#34;1.0&#34;&nbsp;encoding=utf-8`</span><span class="op" id="6786794">,</span>&nbsp;<span class="string" id="6786796">&#34;&#34;</span><span class="op" id="6786798">}</span><span class="op" id="6786799">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6786802">{</span><span class="string" id="6786803">`encoding=&#34;FOO&#34;&nbsp;`</span><span class="op" id="6786820">,</span>&nbsp;<span class="string" id="6786822">&#34;FOO&#34;</span><span class="op" id="6786827">}</span><span class="op" id="6786828">,</span><br>
<span class="lineno"></span><span class="op" id="6786830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6786833">func</span>&nbsp;<span class="ident" id="6786838">TestProcInstEncoding</span><span class="op" id="6786858">(</span><span class="ident" id="6786859">t</span>&nbsp;<span class="op" id="6786861">*</span><span class="ident" id="6786862">testing</span><span class="op" id="6786869">.</span><span class="ident" id="6786870">T</span><span class="op" id="6786871">)</span>&nbsp;<span class="op" id="6786873">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6786876">for</span>&nbsp;<span class="ident" id="6786880">_</span><span class="op" id="6786881">,</span>&nbsp;<span class="ident" id="6786883">test</span>&nbsp;<span class="op" id="6786888">:=</span>&nbsp;<span class="keyword" id="6786891">range</span>&nbsp;<span class="ident" id="6786897">procInstTests</span>&nbsp;<span class="op" id="6786911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6786915">got</span>&nbsp;<span class="op" id="6786919">:=</span>&nbsp;<span class="ident" id="6786922">procInstEncoding</span><span class="op" id="6786938">(</span><span class="ident" id="6786939">test</span><span class="op" id="6786943">.</span><span class="ident" id="6786944">input</span><span class="op" id="6786949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6786953">if</span>&nbsp;<span class="ident" id="6786956">got</span>&nbsp;<span class="op" id="6786960">!=</span>&nbsp;<span class="ident" id="6786963">test</span><span class="op" id="6786967">.</span><span class="ident" id="6786968">expect</span>&nbsp;<span class="op" id="6786975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6786980">t</span><span class="op" id="6786981">.</span><span class="ident" id="6786982">Errorf</span><span class="op" id="6786988">(</span><span class="string" id="6786989">&#34;procInstEncoding(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6787025">,</span>&nbsp;<span class="ident" id="6787027">test</span><span class="op" id="6787031">.</span><span class="ident" id="6787032">input</span><span class="op" id="6787037">,</span>&nbsp;<span class="ident" id="6787039">got</span><span class="op" id="6787042">,</span>&nbsp;<span class="ident" id="6787044">test</span><span class="op" id="6787048">.</span><span class="ident" id="6787049">expect</span><span class="op" id="6787055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6787059">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6787062">}</span><br>
<span class="lineno"></span><span class="op" id="6787064">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6787067">//&nbsp;Ensure&nbsp;that&nbsp;directives&nbsp;with&nbsp;comments&nbsp;include&nbsp;the&nbsp;complete</span><br>
<span class="lineno"></span><span class="comment" id="6787128">//&nbsp;text&nbsp;of&nbsp;any&nbsp;nested&nbsp;directives.</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="6787163">var</span>&nbsp;<span class="ident" id="6787167">directivesWithCommentsInput</span>&nbsp;<span class="op" id="6787195">=</span>&nbsp;<span class="string" id="6787197">`<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!--&nbsp;a&nbsp;comment&nbsp;--&gt;&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;&lt;!--&nbsp;a&nbsp;comment--&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;&lt;!-&gt;&nbsp;&lt;!&gt;&nbsp;&lt;!----&gt;&nbsp;&lt;!--&gt;--&gt;&nbsp;&lt;!---&gt;--&gt;&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;&lt;!--&nbsp;a&nbsp;comment--&gt;]&gt;<br>
<span class="lineno">685</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6787433">var</span>&nbsp;<span class="ident" id="6787437">directivesWithCommentsTokens</span>&nbsp;<span class="op" id="6787466">=</span>&nbsp;<span class="op" id="6787468">[</span><span class="op" id="6787469">]</span><span class="ident" id="6787470">Token</span><span class="op" id="6787475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6787478">CharData</span><span class="op" id="6787486">(</span><span class="string" id="6787487">&#34;\n&#34;</span><span class="op" id="6787491">)</span><span class="op" id="6787492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6787495">Directive</span><span class="op" id="6787504">(</span><span class="string" id="6787505">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]`</span><span class="op" id="6787576">)</span><span class="op" id="6787577">,</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6787580">CharData</span><span class="op" id="6787588">(</span><span class="string" id="6787589">&#34;\n&#34;</span><span class="op" id="6787593">)</span><span class="op" id="6787594">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6787597">Directive</span><span class="op" id="6787606">(</span><span class="string" id="6787607">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;]`</span><span class="op" id="6787640">)</span><span class="op" id="6787641">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6787644">CharData</span><span class="op" id="6787652">(</span><span class="string" id="6787653">&#34;\n&#34;</span><span class="op" id="6787657">)</span><span class="op" id="6787658">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6787661">Directive</span><span class="op" id="6787670">(</span><span class="string" id="6787671">`DOCTYPE&nbsp;&lt;!-&gt;&nbsp;&lt;!&gt;&nbsp;&nbsp;&nbsp;&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;]`</span><span class="op" id="6787716">)</span><span class="op" id="6787717">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6787720">CharData</span><span class="op" id="6787728">(</span><span class="string" id="6787729">&#34;\n&#34;</span><span class="op" id="6787733">)</span><span class="op" id="6787734">,</span><br>
<span class="lineno">695</span><span class="op" id="6787736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6787739">func</span>&nbsp;<span class="ident" id="6787744">TestDirectivesWithComments</span><span class="op" id="6787770">(</span><span class="ident" id="6787771">t</span>&nbsp;<span class="op" id="6787773">*</span><span class="ident" id="6787774">testing</span><span class="op" id="6787781">.</span><span class="ident" id="6787782">T</span><span class="op" id="6787783">)</span>&nbsp;<span class="op" id="6787785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6787788">d</span>&nbsp;<span class="op" id="6787790">:=</span>&nbsp;<span class="ident" id="6787793">NewDecoder</span><span class="op" id="6787803">(</span><span class="ident" id="6787804">strings</span><span class="op" id="6787811">.</span><span class="ident" id="6787812">NewReader</span><span class="op" id="6787821">(</span><span class="ident" id="6787822">directivesWithCommentsInput</span><span class="op" id="6787849">)</span><span class="op" id="6787850">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6787854">for</span>&nbsp;<span class="ident" id="6787858">i</span><span class="op" id="6787859">,</span>&nbsp;<span class="ident" id="6787861">want</span>&nbsp;<span class="op" id="6787866">:=</span>&nbsp;<span class="keyword" id="6787869">range</span>&nbsp;<span class="ident" id="6787875">directivesWithCommentsTokens</span>&nbsp;<span class="op" id="6787904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6787908">have</span><span class="op" id="6787912">,</span>&nbsp;<span class="ident" id="6787914">err</span>&nbsp;<span class="op" id="6787918">:=</span>&nbsp;<span class="ident" id="6787921">d</span><span class="op" id="6787922">.</span><span class="ident" id="6787923">Token</span><span class="op" id="6787928">(</span><span class="op" id="6787929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6787933">if</span>&nbsp;<span class="ident" id="6787936">err</span>&nbsp;<span class="op" id="6787940">!=</span>&nbsp;<span class="ident" id="6787943">nil</span>&nbsp;<span class="op" id="6787947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6787952">t</span><span class="op" id="6787953">.</span><span class="ident" id="6787954">Fatalf</span><span class="op" id="6787960">(</span><span class="string" id="6787961">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="6787993">,</span>&nbsp;<span class="ident" id="6787995">i</span><span class="op" id="6787996">,</span>&nbsp;<span class="ident" id="6787998">err</span><span class="op" id="6788001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6788005">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6788009">if</span>&nbsp;<span class="op" id="6788012">!</span><span class="ident" id="6788013">reflect</span><span class="op" id="6788020">.</span><span class="ident" id="6788021">DeepEqual</span><span class="op" id="6788030">(</span><span class="ident" id="6788031">have</span><span class="op" id="6788035">,</span>&nbsp;<span class="ident" id="6788037">want</span><span class="op" id="6788041">)</span>&nbsp;<span class="op" id="6788043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788048">t</span><span class="op" id="6788049">.</span><span class="ident" id="6788050">Errorf</span><span class="op" id="6788056">(</span><span class="string" id="6788057">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="6788082">,</span>&nbsp;<span class="ident" id="6788084">i</span><span class="op" id="6788085">,</span>&nbsp;<span class="ident" id="6788087">have</span><span class="op" id="6788091">,</span>&nbsp;<span class="ident" id="6788093">want</span><span class="op" id="6788097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6788101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6788104">}</span><br>
<span class="lineno"></span><span class="op" id="6788106">}</span><br>
<span class="lineno">710</span><br>
<span class="lineno"></span><span class="comment" id="6788109">//&nbsp;Writer&nbsp;whose&nbsp;Write&nbsp;method&nbsp;always&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="6788163">type</span>&nbsp;<span class="ident" id="6788168">errWriter</span>&nbsp;<span class="keyword" id="6788178">struct</span><span class="op" id="6788184">{</span><span class="op" id="6788185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6788188">func</span>&nbsp;<span class="op" id="6788193">(</span><span class="ident" id="6788194">errWriter</span><span class="op" id="6788203">)</span>&nbsp;<span class="ident" id="6788205">Write</span><span class="op" id="6788210">(</span><span class="ident" id="6788211">p</span>&nbsp;<span class="op" id="6788213">[</span><span class="op" id="6788214">]</span><span class="builtintype" id="6788215">byte</span><span class="op" id="6788219">)</span>&nbsp;<span class="op" id="6788221">(</span><span class="ident" id="6788222">n</span>&nbsp;<span class="builtintype" id="6788224">int</span><span class="op" id="6788227">,</span>&nbsp;<span class="ident" id="6788229">err</span>&nbsp;<span class="builtintype" id="6788233">error</span><span class="op" id="6788238">)</span>&nbsp;<span class="op" id="6788240">{</span>&nbsp;<span class="keyword" id="6788242">return</span>&nbsp;<span class="num" id="6788249">0</span><span class="op" id="6788250">,</span>&nbsp;<span class="ident" id="6788252">fmt</span><span class="op" id="6788255">.</span><span class="ident" id="6788256">Errorf</span><span class="op" id="6788262">(</span><span class="string" id="6788263">&#34;unwritable&#34;</span><span class="op" id="6788275">)</span>&nbsp;<span class="op" id="6788277">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="6788280">func</span>&nbsp;<span class="ident" id="6788285">TestEscapeTextIOErrors</span><span class="op" id="6788307">(</span><span class="ident" id="6788308">t</span>&nbsp;<span class="op" id="6788310">*</span><span class="ident" id="6788311">testing</span><span class="op" id="6788318">.</span><span class="ident" id="6788319">T</span><span class="op" id="6788320">)</span>&nbsp;<span class="op" id="6788322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788325">expectErr</span>&nbsp;<span class="op" id="6788335">:=</span>&nbsp;<span class="string" id="6788338">&#34;unwritable&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788352">err</span>&nbsp;<span class="op" id="6788356">:=</span>&nbsp;<span class="ident" id="6788359">EscapeText</span><span class="op" id="6788369">(</span><span class="ident" id="6788370">errWriter</span><span class="op" id="6788379">{</span><span class="op" id="6788380">}</span><span class="op" id="6788381">,</span>&nbsp;<span class="op" id="6788383">[</span><span class="op" id="6788384">]</span><span class="builtintype" id="6788385">byte</span><span class="op" id="6788389">{</span><span class="string" id="6788390">&#39;A&#39;</span><span class="op" id="6788393">}</span><span class="op" id="6788394">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6788398">if</span>&nbsp;<span class="ident" id="6788401">err</span>&nbsp;<span class="op" id="6788405">==</span>&nbsp;<span class="ident" id="6788408">nil</span>&nbsp;<span class="op" id="6788412">||</span>&nbsp;<span class="ident" id="6788415">err</span><span class="op" id="6788418">.</span><span class="ident" id="6788419">Error</span><span class="op" id="6788424">(</span><span class="op" id="6788425">)</span>&nbsp;<span class="op" id="6788427">!=</span>&nbsp;<span class="ident" id="6788430">expectErr</span>&nbsp;<span class="op" id="6788440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788444">t</span><span class="op" id="6788445">.</span><span class="ident" id="6788446">Errorf</span><span class="op" id="6788452">(</span><span class="string" id="6788453">&#34;have&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6788471">,</span>&nbsp;<span class="ident" id="6788473">err</span><span class="op" id="6788476">,</span>&nbsp;<span class="ident" id="6788478">expectErr</span><span class="op" id="6788487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6788490">}</span><br>
<span class="lineno"></span><span class="op" id="6788492">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span><span class="keyword" id="6788495">func</span>&nbsp;<span class="ident" id="6788500">TestEscapeTextInvalidChar</span><span class="op" id="6788525">(</span><span class="ident" id="6788526">t</span>&nbsp;<span class="op" id="6788528">*</span><span class="ident" id="6788529">testing</span><span class="op" id="6788536">.</span><span class="ident" id="6788537">T</span><span class="op" id="6788538">)</span>&nbsp;<span class="op" id="6788540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788543">input</span>&nbsp;<span class="op" id="6788549">:=</span>&nbsp;<span class="op" id="6788552">[</span><span class="op" id="6788553">]</span><span class="builtintype" id="6788554">byte</span><span class="op" id="6788558">(</span><span class="string" id="6788559">&#34;A&nbsp;\x00&nbsp;terminated&nbsp;string.&#34;</span><span class="op" id="6788586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788589">expected</span>&nbsp;<span class="op" id="6788598">:=</span>&nbsp;<span class="string" id="6788601">&#34;A&nbsp;\uFFFD&nbsp;terminated&nbsp;string.&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788633">buff</span>&nbsp;<span class="op" id="6788638">:=</span>&nbsp;<span class="builtinfunc" id="6788641">new</span><span class="op" id="6788644">(</span><span class="ident" id="6788645">bytes</span><span class="op" id="6788650">.</span><span class="ident" id="6788651">Buffer</span><span class="op" id="6788657">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6788660">if</span>&nbsp;<span class="ident" id="6788663">err</span>&nbsp;<span class="op" id="6788667">:=</span>&nbsp;<span class="ident" id="6788670">EscapeText</span><span class="op" id="6788680">(</span><span class="ident" id="6788681">buff</span><span class="op" id="6788685">,</span>&nbsp;<span class="ident" id="6788687">input</span><span class="op" id="6788692">)</span><span class="op" id="6788693">;</span>&nbsp;<span class="ident" id="6788695">err</span>&nbsp;<span class="op" id="6788699">!=</span>&nbsp;<span class="ident" id="6788702">nil</span>&nbsp;<span class="op" id="6788706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788710">t</span><span class="op" id="6788711">.</span><span class="ident" id="6788712">Fatalf</span><span class="op" id="6788718">(</span><span class="string" id="6788719">&#34;have&nbsp;%v,&nbsp;want&nbsp;nil&#34;</span><span class="op" id="6788738">,</span>&nbsp;<span class="ident" id="6788740">err</span><span class="op" id="6788743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6788746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788749">text</span>&nbsp;<span class="op" id="6788754">:=</span>&nbsp;<span class="ident" id="6788757">buff</span><span class="op" id="6788761">.</span><span class="ident" id="6788762">String</span><span class="op" id="6788768">(</span><span class="op" id="6788769">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6788773">if</span>&nbsp;<span class="ident" id="6788776">text</span>&nbsp;<span class="op" id="6788781">!=</span>&nbsp;<span class="ident" id="6788784">expected</span>&nbsp;<span class="op" id="6788793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788797">t</span><span class="op" id="6788798">.</span><span class="ident" id="6788799">Errorf</span><span class="op" id="6788805">(</span><span class="string" id="6788806">&#34;have&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6788824">,</span>&nbsp;<span class="ident" id="6788826">text</span><span class="op" id="6788830">,</span>&nbsp;<span class="ident" id="6788832">expected</span><span class="op" id="6788840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6788843">}</span><br>
<span class="lineno"></span><span class="op" id="6788845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">740</span><span class="keyword" id="6788848">func</span>&nbsp;<span class="ident" id="6788853">TestIssue5880</span><span class="op" id="6788866">(</span><span class="ident" id="6788867">t</span>&nbsp;<span class="op" id="6788869">*</span><span class="ident" id="6788870">testing</span><span class="op" id="6788877">.</span><span class="ident" id="6788878">T</span><span class="op" id="6788879">)</span>&nbsp;<span class="op" id="6788881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6788884">type</span>&nbsp;<span class="ident" id="6788889">T</span>&nbsp;<span class="op" id="6788891">[</span><span class="op" id="6788892">]</span><span class="builtintype" id="6788893">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788899">data</span><span class="op" id="6788903">,</span>&nbsp;<span class="ident" id="6788905">err</span>&nbsp;<span class="op" id="6788909">:=</span>&nbsp;<span class="ident" id="6788912">Marshal</span><span class="op" id="6788919">(</span><span class="ident" id="6788920">T</span><span class="op" id="6788921">{</span><span class="num" id="6788922">192</span><span class="op" id="6788925">,</span>&nbsp;<span class="num" id="6788927">168</span><span class="op" id="6788930">,</span>&nbsp;<span class="num" id="6788932">0</span><span class="op" id="6788933">,</span>&nbsp;<span class="num" id="6788935">1</span><span class="op" id="6788936">}</span><span class="op" id="6788937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6788940">if</span>&nbsp;<span class="ident" id="6788943">err</span>&nbsp;<span class="op" id="6788947">!=</span>&nbsp;<span class="ident" id="6788950">nil</span>&nbsp;<span class="op" id="6788954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6788958">t</span><span class="op" id="6788959">.</span><span class="ident" id="6788960">Errorf</span><span class="op" id="6788966">(</span><span class="string" id="6788967">&#34;Marshal&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="6788986">,</span>&nbsp;<span class="ident" id="6788988">err</span><span class="op" id="6788991">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6788994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6788997">if</span>&nbsp;<span class="op" id="6789000">!</span><span class="ident" id="6789001">utf8</span><span class="op" id="6789005">.</span><span class="ident" id="6789006">Valid</span><span class="op" id="6789011">(</span><span class="ident" id="6789012">data</span><span class="op" id="6789016">)</span>&nbsp;<span class="op" id="6789018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6789022">t</span><span class="op" id="6789023">.</span><span class="ident" id="6789024">Errorf</span><span class="op" id="6789030">(</span><span class="string" id="6789031">&#34;Marshal&nbsp;generated&nbsp;invalid&nbsp;UTF-8:&nbsp;%x&#34;</span><span class="op" id="6789068">,</span>&nbsp;<span class="ident" id="6789070">data</span><span class="op" id="6789074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6789077">}</span><br>
<span class="lineno"></span><span class="op" id="6789079">}</span>
</div>
</body>
</html>
