<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>bytes</h2>
<ul>
<li><a href="/gostd/bytes/buffer.go.html">buffer.go</a></li>
<li><a href="/gostd/bytes/buffer_test.go.html">buffer_test.go</a></li>
<li><a href="/gostd/bytes/bytes.go.html" class="current">bytes.go</a></li>
<li><a href="/gostd/bytes/bytes_decl.go.html">bytes_decl.go</a></li>
<li><a href="/gostd/bytes/bytes_test.go.html">bytes_test.go</a></li>
<li><a href="/gostd/bytes/compare_test.go.html">compare_test.go</a></li>
<li><a href="/gostd/bytes/equal_test.go.html">equal_test.go</a></li>
<li><a href="/gostd/bytes/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/bytes/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/bytes/reader.go.html">reader.go</a></li>
<li><a href="/gostd/bytes/reader_test.go.html">reader_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1861492">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1861547">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1861601">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1861652">//&nbsp;Package&nbsp;bytes&nbsp;implements&nbsp;functions&nbsp;for&nbsp;the&nbsp;manipulation&nbsp;of&nbsp;byte&nbsp;slices.</span><br>
<span class="lineno"></span><span class="comment" id="1861727">//&nbsp;It&nbsp;is&nbsp;analogous&nbsp;to&nbsp;the&nbsp;facilities&nbsp;of&nbsp;the&nbsp;strings&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="1861788">package</span>&nbsp;<span class="ident" id="1861796">bytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1861803">import</span>&nbsp;<span class="op" id="1861810">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="1861813">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="1861824">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="1861839">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1861842">func</span>&nbsp;<span class="ident" id="1861847">equalPortable</span><span class="op" id="1861860">(</span><span class="ident" id="1861861">a</span><span class="op" id="1861862">,</span>&nbsp;<span class="ident" id="1861864">b</span>&nbsp;<span class="op" id="1861866">[</span><span class="op" id="1861867">]</span><span class="builtintype" id="1861868">byte</span><span class="op" id="1861872">)</span>&nbsp;<span class="builtintype" id="1861874">bool</span>&nbsp;<span class="op" id="1861879">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1861882">if</span>&nbsp;<span class="builtinfunc" id="1861885">len</span><span class="op" id="1861888">(</span><span class="ident" id="1861889">a</span><span class="op" id="1861890">)</span>&nbsp;<span class="op" id="1861892">!=</span>&nbsp;<span class="builtinfunc" id="1861895">len</span><span class="op" id="1861898">(</span><span class="ident" id="1861899">b</span><span class="op" id="1861900">)</span>&nbsp;<span class="op" id="1861902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1861906">return</span>&nbsp;<span class="builtintype" id="1861913">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1861920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1861923">for</span>&nbsp;<span class="ident" id="1861927">i</span><span class="op" id="1861928">,</span>&nbsp;<span class="ident" id="1861930">c</span>&nbsp;<span class="op" id="1861932">:=</span>&nbsp;<span class="keyword" id="1861935">range</span>&nbsp;<span class="ident" id="1861941">a</span>&nbsp;<span class="op" id="1861943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1861947">if</span>&nbsp;<span class="ident" id="1861950">c</span>&nbsp;<span class="op" id="1861952">!=</span>&nbsp;<span class="ident" id="1861955">b</span><span class="op" id="1861956">[</span><span class="ident" id="1861957">i</span><span class="op" id="1861958">]</span>&nbsp;<span class="op" id="1861960">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1861965">return</span>&nbsp;<span class="builtintype" id="1861972">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1861980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1861983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1861986">return</span>&nbsp;<span class="builtintype" id="1861993">true</span><br>
<span class="lineno"></span><span class="op" id="1861998">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="1862001">//&nbsp;explode&nbsp;splits&nbsp;s&nbsp;into&nbsp;a&nbsp;slice&nbsp;of&nbsp;UTF-8&nbsp;sequences,&nbsp;one&nbsp;per&nbsp;Unicode&nbsp;character&nbsp;(still&nbsp;slices&nbsp;of&nbsp;bytes),</span><br>
<span class="lineno"></span><span class="comment" id="1862105">//&nbsp;up&nbsp;to&nbsp;a&nbsp;maximum&nbsp;of&nbsp;n&nbsp;byte&nbsp;slices.&nbsp;Invalid&nbsp;UTF-8&nbsp;sequences&nbsp;are&nbsp;chopped&nbsp;into&nbsp;individual&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="1862201">func</span>&nbsp;<span class="ident" id="1862206">explode</span><span class="op" id="1862213">(</span><span class="ident" id="1862214">s</span>&nbsp;<span class="op" id="1862216">[</span><span class="op" id="1862217">]</span><span class="builtintype" id="1862218">byte</span><span class="op" id="1862222">,</span>&nbsp;<span class="ident" id="1862224">n</span>&nbsp;<span class="builtintype" id="1862226">int</span><span class="op" id="1862229">)</span>&nbsp;<span class="op" id="1862231">[</span><span class="op" id="1862232">]</span><span class="op" id="1862233">[</span><span class="op" id="1862234">]</span><span class="builtintype" id="1862235">byte</span>&nbsp;<span class="op" id="1862240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1862243">if</span>&nbsp;<span class="ident" id="1862246">n</span>&nbsp;<span class="op" id="1862248">&lt;=</span>&nbsp;<span class="num" id="1862251">0</span>&nbsp;<span class="op" id="1862253">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1862257">n</span>&nbsp;<span class="op" id="1862259">=</span>&nbsp;<span class="builtinfunc" id="1862261">len</span><span class="op" id="1862264">(</span><span class="ident" id="1862265">s</span><span class="op" id="1862266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1862269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1862272">a</span>&nbsp;<span class="op" id="1862274">:=</span>&nbsp;<span class="builtinfunc" id="1862277">make</span><span class="op" id="1862281">(</span><span class="op" id="1862282">[</span><span class="op" id="1862283">]</span><span class="op" id="1862284">[</span><span class="op" id="1862285">]</span><span class="builtintype" id="1862286">byte</span><span class="op" id="1862290">,</span>&nbsp;<span class="ident" id="1862292">n</span><span class="op" id="1862293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1862296">var</span>&nbsp;<span class="ident" id="1862300">size</span>&nbsp;<span class="builtintype" id="1862305">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1862310">na</span>&nbsp;<span class="op" id="1862313">:=</span>&nbsp;<span class="num" id="1862316">0</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1862319">for</span>&nbsp;<span class="builtinfunc" id="1862323">len</span><span class="op" id="1862326">(</span><span class="ident" id="1862327">s</span><span class="op" id="1862328">)</span>&nbsp;<span class="op" id="1862330">&gt;</span>&nbsp;<span class="num" id="1862332">0</span>&nbsp;<span class="op" id="1862334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1862338">if</span>&nbsp;<span class="ident" id="1862341">na</span><span class="op" id="1862343">+</span><span class="num" id="1862344">1</span>&nbsp;<span class="op" id="1862346">&gt;=</span>&nbsp;<span class="ident" id="1862349">n</span>&nbsp;<span class="op" id="1862351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1862356">a</span><span class="op" id="1862357">[</span><span class="ident" id="1862358">na</span><span class="op" id="1862360">]</span>&nbsp;<span class="op" id="1862362">=</span>&nbsp;<span class="ident" id="1862364">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1862369">na</span><span class="op" id="1862371">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1862377">break</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1862385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1862389">_</span><span class="op" id="1862390">,</span>&nbsp;<span class="ident" id="1862392">size</span>&nbsp;<span class="op" id="1862397">=</span>&nbsp;<span class="ident" id="1862399">utf8</span><span class="op" id="1862403">.</span><span class="ident" id="1862404">DecodeRune</span><span class="op" id="1862414">(</span><span class="ident" id="1862415">s</span><span class="op" id="1862416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1862420">a</span><span class="op" id="1862421">[</span><span class="ident" id="1862422">na</span><span class="op" id="1862424">]</span>&nbsp;<span class="op" id="1862426">=</span>&nbsp;<span class="ident" id="1862428">s</span><span class="op" id="1862429">[</span><span class="num" id="1862430">0</span><span class="op" id="1862431">:</span><span class="ident" id="1862432">size</span><span class="op" id="1862436">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1862440">s</span>&nbsp;<span class="op" id="1862442">=</span>&nbsp;<span class="ident" id="1862444">s</span><span class="op" id="1862445">[</span><span class="ident" id="1862446">size</span><span class="op" id="1862450">:</span><span class="op" id="1862451">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1862455">na</span><span class="op" id="1862457">++</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1862461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1862464">return</span>&nbsp;<span class="ident" id="1862471">a</span><span class="op" id="1862472">[</span><span class="num" id="1862473">0</span><span class="op" id="1862474">:</span><span class="ident" id="1862475">na</span><span class="op" id="1862477">]</span><br>
<span class="lineno"></span><span class="op" id="1862479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1862482">//&nbsp;Count&nbsp;counts&nbsp;the&nbsp;number&nbsp;of&nbsp;non-overlapping&nbsp;instances&nbsp;of&nbsp;sep&nbsp;in&nbsp;s.</span><br>
<span class="lineno">50</span><span class="keyword" id="1862551">func</span>&nbsp;<span class="ident" id="1862556">Count</span><span class="op" id="1862561">(</span><span class="ident" id="1862562">s</span><span class="op" id="1862563">,</span>&nbsp;<span class="ident" id="1862565">sep</span>&nbsp;<span class="op" id="1862569">[</span><span class="op" id="1862570">]</span><span class="builtintype" id="1862571">byte</span><span class="op" id="1862575">)</span>&nbsp;<span class="builtintype" id="1862577">int</span>&nbsp;<span class="op" id="1862581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1862584">n</span>&nbsp;<span class="op" id="1862586">:=</span>&nbsp;<span class="builtinfunc" id="1862589">len</span><span class="op" id="1862592">(</span><span class="ident" id="1862593">sep</span><span class="op" id="1862596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1862599">if</span>&nbsp;<span class="ident" id="1862602">n</span>&nbsp;<span class="op" id="1862604">==</span>&nbsp;<span class="num" id="1862607">0</span>&nbsp;<span class="op" id="1862609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1862613">return</span>&nbsp;<span class="ident" id="1862620">utf8</span><span class="op" id="1862624">.</span><span class="ident" id="1862625">RuneCount</span><span class="op" id="1862634">(</span><span class="ident" id="1862635">s</span><span class="op" id="1862636">)</span>&nbsp;<span class="op" id="1862638">+</span>&nbsp;<span class="num" id="1862640">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1862643">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1862646">if</span>&nbsp;<span class="ident" id="1862649">n</span>&nbsp;<span class="op" id="1862651">&gt;</span>&nbsp;<span class="builtinfunc" id="1862653">len</span><span class="op" id="1862656">(</span><span class="ident" id="1862657">s</span><span class="op" id="1862658">)</span>&nbsp;<span class="op" id="1862660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1862664">return</span>&nbsp;<span class="num" id="1862671">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1862674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1862677">count</span>&nbsp;<span class="op" id="1862683">:=</span>&nbsp;<span class="num" id="1862686">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1862689">c</span>&nbsp;<span class="op" id="1862691">:=</span>&nbsp;<span class="ident" id="1862694">sep</span><span class="op" id="1862697">[</span><span class="num" id="1862698">0</span><span class="op" id="1862699">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1862702">i</span>&nbsp;<span class="op" id="1862704">:=</span>&nbsp;<span class="num" id="1862707">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1862710">t</span>&nbsp;<span class="op" id="1862712">:=</span>&nbsp;<span class="ident" id="1862715">s</span><span class="op" id="1862716">[</span><span class="op" id="1862717">:</span><span class="builtinfunc" id="1862718">len</span><span class="op" id="1862721">(</span><span class="ident" id="1862722">s</span><span class="op" id="1862723">)</span><span class="op" id="1862724">-</span><span class="ident" id="1862725">n</span><span class="op" id="1862726">+</span><span class="num" id="1862727">1</span><span class="op" id="1862728">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1862731">for</span>&nbsp;<span class="ident" id="1862735">i</span>&nbsp;<span class="op" id="1862737">&lt;</span>&nbsp;<span class="builtinfunc" id="1862739">len</span><span class="op" id="1862742">(</span><span class="ident" id="1862743">t</span><span class="op" id="1862744">)</span>&nbsp;<span class="op" id="1862746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1862750">if</span>&nbsp;<span class="ident" id="1862753">t</span><span class="op" id="1862754">[</span><span class="ident" id="1862755">i</span><span class="op" id="1862756">]</span>&nbsp;<span class="op" id="1862758">!=</span>&nbsp;<span class="ident" id="1862761">c</span>&nbsp;<span class="op" id="1862763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1862768">o</span>&nbsp;<span class="op" id="1862770">:=</span>&nbsp;<span class="ident" id="1862773">IndexByte</span><span class="op" id="1862782">(</span><span class="ident" id="1862783">t</span><span class="op" id="1862784">[</span><span class="ident" id="1862785">i</span><span class="op" id="1862786">:</span><span class="op" id="1862787">]</span><span class="op" id="1862788">,</span>&nbsp;<span class="ident" id="1862790">c</span><span class="op" id="1862791">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1862796">if</span>&nbsp;<span class="ident" id="1862799">o</span>&nbsp;<span class="op" id="1862801">&lt;</span>&nbsp;<span class="num" id="1862803">0</span>&nbsp;<span class="op" id="1862805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1862811">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1862820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1862825">i</span>&nbsp;<span class="op" id="1862827">+=</span>&nbsp;<span class="ident" id="1862830">o</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1862834">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1862838">if</span>&nbsp;<span class="ident" id="1862841">n</span>&nbsp;<span class="op" id="1862843">==</span>&nbsp;<span class="num" id="1862846">1</span>&nbsp;<span class="op" id="1862848">||</span>&nbsp;<span class="ident" id="1862851">Equal</span><span class="op" id="1862856">(</span><span class="ident" id="1862857">s</span><span class="op" id="1862858">[</span><span class="ident" id="1862859">i</span><span class="op" id="1862860">:</span><span class="ident" id="1862861">i</span><span class="op" id="1862862">+</span><span class="ident" id="1862863">n</span><span class="op" id="1862864">]</span><span class="op" id="1862865">,</span>&nbsp;<span class="ident" id="1862867">sep</span><span class="op" id="1862870">)</span>&nbsp;<span class="op" id="1862872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1862877">count</span><span class="op" id="1862882">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1862888">i</span>&nbsp;<span class="op" id="1862890">+=</span>&nbsp;<span class="ident" id="1862893">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1862898">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1862909">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1862913">i</span><span class="op" id="1862914">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1862918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1862921">return</span>&nbsp;<span class="ident" id="1862928">count</span><br>
<span class="lineno"></span><span class="op" id="1862934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="1862937">//&nbsp;Contains&nbsp;reports&nbsp;whether&nbsp;subslice&nbsp;is&nbsp;within&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="1862987">func</span>&nbsp;<span class="ident" id="1862992">Contains</span><span class="op" id="1863000">(</span><span class="ident" id="1863001">b</span><span class="op" id="1863002">,</span>&nbsp;<span class="ident" id="1863004">subslice</span>&nbsp;<span class="op" id="1863013">[</span><span class="op" id="1863014">]</span><span class="builtintype" id="1863015">byte</span><span class="op" id="1863019">)</span>&nbsp;<span class="builtintype" id="1863021">bool</span>&nbsp;<span class="op" id="1863026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1863029">return</span>&nbsp;<span class="ident" id="1863036">Index</span><span class="op" id="1863041">(</span><span class="ident" id="1863042">b</span><span class="op" id="1863043">,</span>&nbsp;<span class="ident" id="1863045">subslice</span><span class="op" id="1863053">)</span>&nbsp;<span class="op" id="1863055">!=</span>&nbsp;<span class="op" id="1863058">-</span><span class="num" id="1863059">1</span><br>
<span class="lineno"></span><span class="op" id="1863061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="1863064">//&nbsp;Index&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;instance&nbsp;of&nbsp;sep&nbsp;in&nbsp;s,&nbsp;or&nbsp;-1&nbsp;if&nbsp;sep&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="1863160">func</span>&nbsp;<span class="ident" id="1863165">Index</span><span class="op" id="1863170">(</span><span class="ident" id="1863171">s</span><span class="op" id="1863172">,</span>&nbsp;<span class="ident" id="1863174">sep</span>&nbsp;<span class="op" id="1863178">[</span><span class="op" id="1863179">]</span><span class="builtintype" id="1863180">byte</span><span class="op" id="1863184">)</span>&nbsp;<span class="builtintype" id="1863186">int</span>&nbsp;<span class="op" id="1863190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1863193">n</span>&nbsp;<span class="op" id="1863195">:=</span>&nbsp;<span class="builtinfunc" id="1863198">len</span><span class="op" id="1863201">(</span><span class="ident" id="1863202">sep</span><span class="op" id="1863205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1863208">if</span>&nbsp;<span class="ident" id="1863211">n</span>&nbsp;<span class="op" id="1863213">==</span>&nbsp;<span class="num" id="1863216">0</span>&nbsp;<span class="op" id="1863218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1863222">return</span>&nbsp;<span class="num" id="1863229">0</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1863232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1863235">if</span>&nbsp;<span class="ident" id="1863238">n</span>&nbsp;<span class="op" id="1863240">&gt;</span>&nbsp;<span class="builtinfunc" id="1863242">len</span><span class="op" id="1863245">(</span><span class="ident" id="1863246">s</span><span class="op" id="1863247">)</span>&nbsp;<span class="op" id="1863249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1863253">return</span>&nbsp;<span class="op" id="1863260">-</span><span class="num" id="1863261">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1863264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1863267">c</span>&nbsp;<span class="op" id="1863269">:=</span>&nbsp;<span class="ident" id="1863272">sep</span><span class="op" id="1863275">[</span><span class="num" id="1863276">0</span><span class="op" id="1863277">]</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1863280">if</span>&nbsp;<span class="ident" id="1863283">n</span>&nbsp;<span class="op" id="1863285">==</span>&nbsp;<span class="num" id="1863288">1</span>&nbsp;<span class="op" id="1863290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1863294">return</span>&nbsp;<span class="ident" id="1863301">IndexByte</span><span class="op" id="1863310">(</span><span class="ident" id="1863311">s</span><span class="op" id="1863312">,</span>&nbsp;<span class="ident" id="1863314">c</span><span class="op" id="1863315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1863318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1863321">i</span>&nbsp;<span class="op" id="1863323">:=</span>&nbsp;<span class="num" id="1863326">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1863329">t</span>&nbsp;<span class="op" id="1863331">:=</span>&nbsp;<span class="ident" id="1863334">s</span><span class="op" id="1863335">[</span><span class="op" id="1863336">:</span><span class="builtinfunc" id="1863337">len</span><span class="op" id="1863340">(</span><span class="ident" id="1863341">s</span><span class="op" id="1863342">)</span><span class="op" id="1863343">-</span><span class="ident" id="1863344">n</span><span class="op" id="1863345">+</span><span class="num" id="1863346">1</span><span class="op" id="1863347">]</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1863350">for</span>&nbsp;<span class="ident" id="1863354">i</span>&nbsp;<span class="op" id="1863356">&lt;</span>&nbsp;<span class="builtinfunc" id="1863358">len</span><span class="op" id="1863361">(</span><span class="ident" id="1863362">t</span><span class="op" id="1863363">)</span>&nbsp;<span class="op" id="1863365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1863369">if</span>&nbsp;<span class="ident" id="1863372">t</span><span class="op" id="1863373">[</span><span class="ident" id="1863374">i</span><span class="op" id="1863375">]</span>&nbsp;<span class="op" id="1863377">!=</span>&nbsp;<span class="ident" id="1863380">c</span>&nbsp;<span class="op" id="1863382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1863387">o</span>&nbsp;<span class="op" id="1863389">:=</span>&nbsp;<span class="ident" id="1863392">IndexByte</span><span class="op" id="1863401">(</span><span class="ident" id="1863402">t</span><span class="op" id="1863403">[</span><span class="ident" id="1863404">i</span><span class="op" id="1863405">:</span><span class="op" id="1863406">]</span><span class="op" id="1863407">,</span>&nbsp;<span class="ident" id="1863409">c</span><span class="op" id="1863410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1863415">if</span>&nbsp;<span class="ident" id="1863418">o</span>&nbsp;<span class="op" id="1863420">&lt;</span>&nbsp;<span class="num" id="1863422">0</span>&nbsp;<span class="op" id="1863424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1863430">break</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1863439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1863444">i</span>&nbsp;<span class="op" id="1863446">+=</span>&nbsp;<span class="ident" id="1863449">o</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1863453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1863457">if</span>&nbsp;<span class="ident" id="1863460">Equal</span><span class="op" id="1863465">(</span><span class="ident" id="1863466">s</span><span class="op" id="1863467">[</span><span class="ident" id="1863468">i</span><span class="op" id="1863469">:</span><span class="ident" id="1863470">i</span><span class="op" id="1863471">+</span><span class="ident" id="1863472">n</span><span class="op" id="1863473">]</span><span class="op" id="1863474">,</span>&nbsp;<span class="ident" id="1863476">sep</span><span class="op" id="1863479">)</span>&nbsp;<span class="op" id="1863481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1863486">return</span>&nbsp;<span class="ident" id="1863493">i</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1863497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1863501">i</span><span class="op" id="1863502">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1863506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1863509">return</span>&nbsp;<span class="op" id="1863516">-</span><span class="num" id="1863517">1</span><br>
<span class="lineno"></span><span class="op" id="1863519">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="keyword" id="1863522">func</span>&nbsp;<span class="ident" id="1863527">indexBytePortable</span><span class="op" id="1863544">(</span><span class="ident" id="1863545">s</span>&nbsp;<span class="op" id="1863547">[</span><span class="op" id="1863548">]</span><span class="builtintype" id="1863549">byte</span><span class="op" id="1863553">,</span>&nbsp;<span class="ident" id="1863555">c</span>&nbsp;<span class="builtintype" id="1863557">byte</span><span class="op" id="1863561">)</span>&nbsp;<span class="builtintype" id="1863563">int</span>&nbsp;<span class="op" id="1863567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1863570">for</span>&nbsp;<span class="ident" id="1863574">i</span><span class="op" id="1863575">,</span>&nbsp;<span class="ident" id="1863577">b</span>&nbsp;<span class="op" id="1863579">:=</span>&nbsp;<span class="keyword" id="1863582">range</span>&nbsp;<span class="ident" id="1863588">s</span>&nbsp;<span class="op" id="1863590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1863594">if</span>&nbsp;<span class="ident" id="1863597">b</span>&nbsp;<span class="op" id="1863599">==</span>&nbsp;<span class="ident" id="1863602">c</span>&nbsp;<span class="op" id="1863604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1863609">return</span>&nbsp;<span class="ident" id="1863616">i</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1863620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1863623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1863626">return</span>&nbsp;<span class="op" id="1863633">-</span><span class="num" id="1863634">1</span><br>
<span class="lineno"></span><span class="op" id="1863636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="1863639">//&nbsp;LastIndex&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;last&nbsp;instance&nbsp;of&nbsp;sep&nbsp;in&nbsp;s,&nbsp;or&nbsp;-1&nbsp;if&nbsp;sep&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="1863738">func</span>&nbsp;<span class="ident" id="1863743">LastIndex</span><span class="op" id="1863752">(</span><span class="ident" id="1863753">s</span><span class="op" id="1863754">,</span>&nbsp;<span class="ident" id="1863756">sep</span>&nbsp;<span class="op" id="1863760">[</span><span class="op" id="1863761">]</span><span class="builtintype" id="1863762">byte</span><span class="op" id="1863766">)</span>&nbsp;<span class="builtintype" id="1863768">int</span>&nbsp;<span class="op" id="1863772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1863775">n</span>&nbsp;<span class="op" id="1863777">:=</span>&nbsp;<span class="builtinfunc" id="1863780">len</span><span class="op" id="1863783">(</span><span class="ident" id="1863784">sep</span><span class="op" id="1863787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1863790">if</span>&nbsp;<span class="ident" id="1863793">n</span>&nbsp;<span class="op" id="1863795">==</span>&nbsp;<span class="num" id="1863798">0</span>&nbsp;<span class="op" id="1863800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1863804">return</span>&nbsp;<span class="builtinfunc" id="1863811">len</span><span class="op" id="1863814">(</span><span class="ident" id="1863815">s</span><span class="op" id="1863816">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1863819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1863822">c</span>&nbsp;<span class="op" id="1863824">:=</span>&nbsp;<span class="ident" id="1863827">sep</span><span class="op" id="1863830">[</span><span class="num" id="1863831">0</span><span class="op" id="1863832">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1863835">for</span>&nbsp;<span class="ident" id="1863839">i</span>&nbsp;<span class="op" id="1863841">:=</span>&nbsp;<span class="builtinfunc" id="1863844">len</span><span class="op" id="1863847">(</span><span class="ident" id="1863848">s</span><span class="op" id="1863849">)</span>&nbsp;<span class="op" id="1863851">-</span>&nbsp;<span class="ident" id="1863853">n</span><span class="op" id="1863854">;</span>&nbsp;<span class="ident" id="1863856">i</span>&nbsp;<span class="op" id="1863858">&gt;=</span>&nbsp;<span class="num" id="1863861">0</span><span class="op" id="1863862">;</span>&nbsp;<span class="ident" id="1863864">i</span><span class="op" id="1863865">--</span>&nbsp;<span class="op" id="1863868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1863872">if</span>&nbsp;<span class="ident" id="1863875">s</span><span class="op" id="1863876">[</span><span class="ident" id="1863877">i</span><span class="op" id="1863878">]</span>&nbsp;<span class="op" id="1863880">==</span>&nbsp;<span class="ident" id="1863883">c</span>&nbsp;<span class="op" id="1863885">&amp;&amp;</span>&nbsp;<span class="op" id="1863888">(</span><span class="ident" id="1863889">n</span>&nbsp;<span class="op" id="1863891">==</span>&nbsp;<span class="num" id="1863894">1</span>&nbsp;<span class="op" id="1863896">||</span>&nbsp;<span class="ident" id="1863899">Equal</span><span class="op" id="1863904">(</span><span class="ident" id="1863905">s</span><span class="op" id="1863906">[</span><span class="ident" id="1863907">i</span><span class="op" id="1863908">:</span><span class="ident" id="1863909">i</span><span class="op" id="1863910">+</span><span class="ident" id="1863911">n</span><span class="op" id="1863912">]</span><span class="op" id="1863913">,</span>&nbsp;<span class="ident" id="1863915">sep</span><span class="op" id="1863918">)</span><span class="op" id="1863919">)</span>&nbsp;<span class="op" id="1863921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1863926">return</span>&nbsp;<span class="ident" id="1863933">i</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1863937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1863940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1863943">return</span>&nbsp;<span class="op" id="1863950">-</span><span class="num" id="1863951">1</span><br>
<span class="lineno"></span><span class="op" id="1863953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="1863956">//&nbsp;IndexRune&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="1864034">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;occurrence&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;given&nbsp;rune.</span><br>
<span class="lineno"></span><span class="comment" id="1864111">//&nbsp;It&nbsp;returns&nbsp;-1&nbsp;if&nbsp;rune&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="1864157">func</span>&nbsp;<span class="ident" id="1864162">IndexRune</span><span class="op" id="1864171">(</span><span class="ident" id="1864172">s</span>&nbsp;<span class="op" id="1864174">[</span><span class="op" id="1864175">]</span><span class="builtintype" id="1864176">byte</span><span class="op" id="1864180">,</span>&nbsp;<span class="ident" id="1864182">r</span>&nbsp;<span class="builtintype" id="1864184">rune</span><span class="op" id="1864188">)</span>&nbsp;<span class="builtintype" id="1864190">int</span>&nbsp;<span class="op" id="1864194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1864197">for</span>&nbsp;<span class="ident" id="1864201">i</span>&nbsp;<span class="op" id="1864203">:=</span>&nbsp;<span class="num" id="1864206">0</span><span class="op" id="1864207">;</span>&nbsp;<span class="ident" id="1864209">i</span>&nbsp;<span class="op" id="1864211">&lt;</span>&nbsp;<span class="builtinfunc" id="1864213">len</span><span class="op" id="1864216">(</span><span class="ident" id="1864217">s</span><span class="op" id="1864218">)</span><span class="op" id="1864219">;</span>&nbsp;<span class="op" id="1864221">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1864225">r1</span><span class="op" id="1864227">,</span>&nbsp;<span class="ident" id="1864229">size</span>&nbsp;<span class="op" id="1864234">:=</span>&nbsp;<span class="ident" id="1864237">utf8</span><span class="op" id="1864241">.</span><span class="ident" id="1864242">DecodeRune</span><span class="op" id="1864252">(</span><span class="ident" id="1864253">s</span><span class="op" id="1864254">[</span><span class="ident" id="1864255">i</span><span class="op" id="1864256">:</span><span class="op" id="1864257">]</span><span class="op" id="1864258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1864262">if</span>&nbsp;<span class="ident" id="1864265">r</span>&nbsp;<span class="op" id="1864267">==</span>&nbsp;<span class="ident" id="1864270">r1</span>&nbsp;<span class="op" id="1864273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1864278">return</span>&nbsp;<span class="ident" id="1864285">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1864289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1864293">i</span>&nbsp;<span class="op" id="1864295">+=</span>&nbsp;<span class="ident" id="1864298">size</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1864304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1864307">return</span>&nbsp;<span class="op" id="1864314">-</span><span class="num" id="1864315">1</span><br>
<span class="lineno"></span><span class="op" id="1864317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1864320">//&nbsp;IndexAny&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno">155</span><span class="comment" id="1864397">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;occurrence&nbsp;in&nbsp;s&nbsp;of&nbsp;any&nbsp;of&nbsp;the&nbsp;Unicode</span><br>
<span class="lineno"></span><span class="comment" id="1864477">//&nbsp;code&nbsp;points&nbsp;in&nbsp;chars.&nbsp;&nbsp;It&nbsp;returns&nbsp;-1&nbsp;if&nbsp;chars&nbsp;is&nbsp;empty&nbsp;or&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;code</span><br>
<span class="lineno"></span><span class="comment" id="1864558">//&nbsp;point&nbsp;in&nbsp;common.</span><br>
<span class="lineno"></span><span class="keyword" id="1864578">func</span>&nbsp;<span class="ident" id="1864583">IndexAny</span><span class="op" id="1864591">(</span><span class="ident" id="1864592">s</span>&nbsp;<span class="op" id="1864594">[</span><span class="op" id="1864595">]</span><span class="builtintype" id="1864596">byte</span><span class="op" id="1864600">,</span>&nbsp;<span class="ident" id="1864602">chars</span>&nbsp;<span class="builtintype" id="1864608">string</span><span class="op" id="1864614">)</span>&nbsp;<span class="builtintype" id="1864616">int</span>&nbsp;<span class="op" id="1864620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1864623">if</span>&nbsp;<span class="builtinfunc" id="1864626">len</span><span class="op" id="1864629">(</span><span class="ident" id="1864630">chars</span><span class="op" id="1864635">)</span>&nbsp;<span class="op" id="1864637">&gt;</span>&nbsp;<span class="num" id="1864639">0</span>&nbsp;<span class="op" id="1864641">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1864645">var</span>&nbsp;<span class="ident" id="1864649">r</span>&nbsp;<span class="builtintype" id="1864651">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1864658">var</span>&nbsp;<span class="ident" id="1864662">width</span>&nbsp;<span class="builtintype" id="1864668">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1864674">for</span>&nbsp;<span class="ident" id="1864678">i</span>&nbsp;<span class="op" id="1864680">:=</span>&nbsp;<span class="num" id="1864683">0</span><span class="op" id="1864684">;</span>&nbsp;<span class="ident" id="1864686">i</span>&nbsp;<span class="op" id="1864688">&lt;</span>&nbsp;<span class="builtinfunc" id="1864690">len</span><span class="op" id="1864693">(</span><span class="ident" id="1864694">s</span><span class="op" id="1864695">)</span><span class="op" id="1864696">;</span>&nbsp;<span class="ident" id="1864698">i</span>&nbsp;<span class="op" id="1864700">+=</span>&nbsp;<span class="ident" id="1864703">width</span>&nbsp;<span class="op" id="1864709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1864714">r</span>&nbsp;<span class="op" id="1864716">=</span>&nbsp;<span class="builtintype" id="1864718">rune</span><span class="op" id="1864722">(</span><span class="ident" id="1864723">s</span><span class="op" id="1864724">[</span><span class="ident" id="1864725">i</span><span class="op" id="1864726">]</span><span class="op" id="1864727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1864732">if</span>&nbsp;<span class="ident" id="1864735">r</span>&nbsp;<span class="op" id="1864737">&lt;</span>&nbsp;<span class="ident" id="1864739">utf8</span><span class="op" id="1864743">.</span><span class="ident" id="1864744">RuneSelf</span>&nbsp;<span class="op" id="1864753">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1864759">width</span>&nbsp;<span class="op" id="1864765">=</span>&nbsp;<span class="num" id="1864767">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1864772">}</span>&nbsp;<span class="keyword" id="1864774">else</span>&nbsp;<span class="op" id="1864779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1864785">r</span><span class="op" id="1864786">,</span>&nbsp;<span class="ident" id="1864788">width</span>&nbsp;<span class="op" id="1864794">=</span>&nbsp;<span class="ident" id="1864796">utf8</span><span class="op" id="1864800">.</span><span class="ident" id="1864801">DecodeRune</span><span class="op" id="1864811">(</span><span class="ident" id="1864812">s</span><span class="op" id="1864813">[</span><span class="ident" id="1864814">i</span><span class="op" id="1864815">:</span><span class="op" id="1864816">]</span><span class="op" id="1864817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1864822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1864827">for</span>&nbsp;<span class="ident" id="1864831">_</span><span class="op" id="1864832">,</span>&nbsp;<span class="ident" id="1864834">ch</span>&nbsp;<span class="op" id="1864837">:=</span>&nbsp;<span class="keyword" id="1864840">range</span>&nbsp;<span class="ident" id="1864846">chars</span>&nbsp;<span class="op" id="1864852">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1864858">if</span>&nbsp;<span class="ident" id="1864861">r</span>&nbsp;<span class="op" id="1864863">==</span>&nbsp;<span class="ident" id="1864866">ch</span>&nbsp;<span class="op" id="1864869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1864876">return</span>&nbsp;<span class="ident" id="1864883">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1864889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1864894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1864898">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1864901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1864904">return</span>&nbsp;<span class="op" id="1864911">-</span><span class="num" id="1864912">1</span><br>
<span class="lineno"></span><span class="op" id="1864914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1864917">//&nbsp;LastIndexAny&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code</span><br>
<span class="lineno">180</span><span class="comment" id="1864990">//&nbsp;points.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;of&nbsp;the&nbsp;last&nbsp;occurrence&nbsp;in&nbsp;s&nbsp;of&nbsp;any&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1865066">//&nbsp;the&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;in&nbsp;chars.&nbsp;&nbsp;It&nbsp;returns&nbsp;-1&nbsp;if&nbsp;chars&nbsp;is&nbsp;empty&nbsp;or&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="1865142">//&nbsp;there&nbsp;is&nbsp;no&nbsp;code&nbsp;point&nbsp;in&nbsp;common.</span><br>
<span class="lineno"></span><span class="keyword" id="1865179">func</span>&nbsp;<span class="ident" id="1865184">LastIndexAny</span><span class="op" id="1865196">(</span><span class="ident" id="1865197">s</span>&nbsp;<span class="op" id="1865199">[</span><span class="op" id="1865200">]</span><span class="builtintype" id="1865201">byte</span><span class="op" id="1865205">,</span>&nbsp;<span class="ident" id="1865207">chars</span>&nbsp;<span class="builtintype" id="1865213">string</span><span class="op" id="1865219">)</span>&nbsp;<span class="builtintype" id="1865221">int</span>&nbsp;<span class="op" id="1865225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1865228">if</span>&nbsp;<span class="builtinfunc" id="1865231">len</span><span class="op" id="1865234">(</span><span class="ident" id="1865235">chars</span><span class="op" id="1865240">)</span>&nbsp;<span class="op" id="1865242">&gt;</span>&nbsp;<span class="num" id="1865244">0</span>&nbsp;<span class="op" id="1865246">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1865250">for</span>&nbsp;<span class="ident" id="1865254">i</span>&nbsp;<span class="op" id="1865256">:=</span>&nbsp;<span class="builtinfunc" id="1865259">len</span><span class="op" id="1865262">(</span><span class="ident" id="1865263">s</span><span class="op" id="1865264">)</span><span class="op" id="1865265">;</span>&nbsp;<span class="ident" id="1865267">i</span>&nbsp;<span class="op" id="1865269">&gt;</span>&nbsp;<span class="num" id="1865271">0</span><span class="op" id="1865272">;</span>&nbsp;<span class="op" id="1865274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1865279">r</span><span class="op" id="1865280">,</span>&nbsp;<span class="ident" id="1865282">size</span>&nbsp;<span class="op" id="1865287">:=</span>&nbsp;<span class="ident" id="1865290">utf8</span><span class="op" id="1865294">.</span><span class="ident" id="1865295">DecodeLastRune</span><span class="op" id="1865309">(</span><span class="ident" id="1865310">s</span><span class="op" id="1865311">[</span><span class="num" id="1865312">0</span><span class="op" id="1865313">:</span><span class="ident" id="1865314">i</span><span class="op" id="1865315">]</span><span class="op" id="1865316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1865321">i</span>&nbsp;<span class="op" id="1865323">-=</span>&nbsp;<span class="ident" id="1865326">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1865334">for</span>&nbsp;<span class="ident" id="1865338">_</span><span class="op" id="1865339">,</span>&nbsp;<span class="ident" id="1865341">ch</span>&nbsp;<span class="op" id="1865344">:=</span>&nbsp;<span class="keyword" id="1865347">range</span>&nbsp;<span class="ident" id="1865353">chars</span>&nbsp;<span class="op" id="1865359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1865365">if</span>&nbsp;<span class="ident" id="1865368">r</span>&nbsp;<span class="op" id="1865370">==</span>&nbsp;<span class="ident" id="1865373">ch</span>&nbsp;<span class="op" id="1865376">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1865383">return</span>&nbsp;<span class="ident" id="1865390">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1865396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1865401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1865405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1865408">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1865411">return</span>&nbsp;<span class="op" id="1865418">-</span><span class="num" id="1865419">1</span><br>
<span class="lineno"></span><span class="op" id="1865421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1865424">//&nbsp;Generic&nbsp;split:&nbsp;splits&nbsp;after&nbsp;each&nbsp;instance&nbsp;of&nbsp;sep,</span><br>
<span class="lineno"></span><span class="comment" id="1865477">//&nbsp;including&nbsp;sepSave&nbsp;bytes&nbsp;of&nbsp;sep&nbsp;in&nbsp;the&nbsp;subslices.</span><br>
<span class="lineno">200</span><span class="keyword" id="1865529">func</span>&nbsp;<span class="ident" id="1865534">genSplit</span><span class="op" id="1865542">(</span><span class="ident" id="1865543">s</span><span class="op" id="1865544">,</span>&nbsp;<span class="ident" id="1865546">sep</span>&nbsp;<span class="op" id="1865550">[</span><span class="op" id="1865551">]</span><span class="builtintype" id="1865552">byte</span><span class="op" id="1865556">,</span>&nbsp;<span class="ident" id="1865558">sepSave</span><span class="op" id="1865565">,</span>&nbsp;<span class="ident" id="1865567">n</span>&nbsp;<span class="builtintype" id="1865569">int</span><span class="op" id="1865572">)</span>&nbsp;<span class="op" id="1865574">[</span><span class="op" id="1865575">]</span><span class="op" id="1865576">[</span><span class="op" id="1865577">]</span><span class="builtintype" id="1865578">byte</span>&nbsp;<span class="op" id="1865583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1865586">if</span>&nbsp;<span class="ident" id="1865589">n</span>&nbsp;<span class="op" id="1865591">==</span>&nbsp;<span class="num" id="1865594">0</span>&nbsp;<span class="op" id="1865596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1865600">return</span>&nbsp;<span class="builtintype" id="1865607">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1865612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1865615">if</span>&nbsp;<span class="builtinfunc" id="1865618">len</span><span class="op" id="1865621">(</span><span class="ident" id="1865622">sep</span><span class="op" id="1865625">)</span>&nbsp;<span class="op" id="1865627">==</span>&nbsp;<span class="num" id="1865630">0</span>&nbsp;<span class="op" id="1865632">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1865636">return</span>&nbsp;<span class="ident" id="1865643">explode</span><span class="op" id="1865650">(</span><span class="ident" id="1865651">s</span><span class="op" id="1865652">,</span>&nbsp;<span class="ident" id="1865654">n</span><span class="op" id="1865655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1865658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1865661">if</span>&nbsp;<span class="ident" id="1865664">n</span>&nbsp;<span class="op" id="1865666">&lt;</span>&nbsp;<span class="num" id="1865668">0</span>&nbsp;<span class="op" id="1865670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1865674">n</span>&nbsp;<span class="op" id="1865676">=</span>&nbsp;<span class="ident" id="1865678">Count</span><span class="op" id="1865683">(</span><span class="ident" id="1865684">s</span><span class="op" id="1865685">,</span>&nbsp;<span class="ident" id="1865687">sep</span><span class="op" id="1865690">)</span>&nbsp;<span class="op" id="1865692">+</span>&nbsp;<span class="num" id="1865694">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1865697">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1865700">c</span>&nbsp;<span class="op" id="1865702">:=</span>&nbsp;<span class="ident" id="1865705">sep</span><span class="op" id="1865708">[</span><span class="num" id="1865709">0</span><span class="op" id="1865710">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1865713">start</span>&nbsp;<span class="op" id="1865719">:=</span>&nbsp;<span class="num" id="1865722">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1865725">a</span>&nbsp;<span class="op" id="1865727">:=</span>&nbsp;<span class="builtinfunc" id="1865730">make</span><span class="op" id="1865734">(</span><span class="op" id="1865735">[</span><span class="op" id="1865736">]</span><span class="op" id="1865737">[</span><span class="op" id="1865738">]</span><span class="builtintype" id="1865739">byte</span><span class="op" id="1865743">,</span>&nbsp;<span class="ident" id="1865745">n</span><span class="op" id="1865746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1865749">na</span>&nbsp;<span class="op" id="1865752">:=</span>&nbsp;<span class="num" id="1865755">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1865758">for</span>&nbsp;<span class="ident" id="1865762">i</span>&nbsp;<span class="op" id="1865764">:=</span>&nbsp;<span class="num" id="1865767">0</span><span class="op" id="1865768">;</span>&nbsp;<span class="ident" id="1865770">i</span><span class="op" id="1865771">+</span><span class="builtinfunc" id="1865772">len</span><span class="op" id="1865775">(</span><span class="ident" id="1865776">sep</span><span class="op" id="1865779">)</span>&nbsp;<span class="op" id="1865781">&lt;=</span>&nbsp;<span class="builtinfunc" id="1865784">len</span><span class="op" id="1865787">(</span><span class="ident" id="1865788">s</span><span class="op" id="1865789">)</span>&nbsp;<span class="op" id="1865791">&amp;&amp;</span>&nbsp;<span class="ident" id="1865794">na</span><span class="op" id="1865796">+</span><span class="num" id="1865797">1</span>&nbsp;<span class="op" id="1865799">&lt;</span>&nbsp;<span class="ident" id="1865801">n</span><span class="op" id="1865802">;</span>&nbsp;<span class="ident" id="1865804">i</span><span class="op" id="1865805">++</span>&nbsp;<span class="op" id="1865808">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1865812">if</span>&nbsp;<span class="ident" id="1865815">s</span><span class="op" id="1865816">[</span><span class="ident" id="1865817">i</span><span class="op" id="1865818">]</span>&nbsp;<span class="op" id="1865820">==</span>&nbsp;<span class="ident" id="1865823">c</span>&nbsp;<span class="op" id="1865825">&amp;&amp;</span>&nbsp;<span class="op" id="1865828">(</span><span class="builtinfunc" id="1865829">len</span><span class="op" id="1865832">(</span><span class="ident" id="1865833">sep</span><span class="op" id="1865836">)</span>&nbsp;<span class="op" id="1865838">==</span>&nbsp;<span class="num" id="1865841">1</span>&nbsp;<span class="op" id="1865843">||</span>&nbsp;<span class="ident" id="1865846">Equal</span><span class="op" id="1865851">(</span><span class="ident" id="1865852">s</span><span class="op" id="1865853">[</span><span class="ident" id="1865854">i</span><span class="op" id="1865855">:</span><span class="ident" id="1865856">i</span><span class="op" id="1865857">+</span><span class="builtinfunc" id="1865858">len</span><span class="op" id="1865861">(</span><span class="ident" id="1865862">sep</span><span class="op" id="1865865">)</span><span class="op" id="1865866">]</span><span class="op" id="1865867">,</span>&nbsp;<span class="ident" id="1865869">sep</span><span class="op" id="1865872">)</span><span class="op" id="1865873">)</span>&nbsp;<span class="op" id="1865875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1865880">a</span><span class="op" id="1865881">[</span><span class="ident" id="1865882">na</span><span class="op" id="1865884">]</span>&nbsp;<span class="op" id="1865886">=</span>&nbsp;<span class="ident" id="1865888">s</span><span class="op" id="1865889">[</span><span class="ident" id="1865890">start</span>&nbsp;<span class="op" id="1865896">:</span>&nbsp;<span class="ident" id="1865898">i</span><span class="op" id="1865899">+</span><span class="ident" id="1865900">sepSave</span><span class="op" id="1865907">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1865912">na</span><span class="op" id="1865914">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1865920">start</span>&nbsp;<span class="op" id="1865926">=</span>&nbsp;<span class="ident" id="1865928">i</span>&nbsp;<span class="op" id="1865930">+</span>&nbsp;<span class="builtinfunc" id="1865932">len</span><span class="op" id="1865935">(</span><span class="ident" id="1865936">sep</span><span class="op" id="1865939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1865944">i</span>&nbsp;<span class="op" id="1865946">+=</span>&nbsp;<span class="builtinfunc" id="1865949">len</span><span class="op" id="1865952">(</span><span class="ident" id="1865953">sep</span><span class="op" id="1865956">)</span>&nbsp;<span class="op" id="1865958">-</span>&nbsp;<span class="num" id="1865960">1</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1865964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1865967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1865970">a</span><span class="op" id="1865971">[</span><span class="ident" id="1865972">na</span><span class="op" id="1865974">]</span>&nbsp;<span class="op" id="1865976">=</span>&nbsp;<span class="ident" id="1865978">s</span><span class="op" id="1865979">[</span><span class="ident" id="1865980">start</span><span class="op" id="1865985">:</span><span class="op" id="1865986">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1865989">return</span>&nbsp;<span class="ident" id="1865996">a</span><span class="op" id="1865997">[</span><span class="num" id="1865998">0</span>&nbsp;<span class="op" id="1866000">:</span>&nbsp;<span class="ident" id="1866002">na</span><span class="op" id="1866004">+</span><span class="num" id="1866005">1</span><span class="op" id="1866006">]</span><br>
<span class="lineno"></span><span class="op" id="1866008">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="1866011">//&nbsp;SplitN&nbsp;slices&nbsp;s&nbsp;into&nbsp;subslices&nbsp;separated&nbsp;by&nbsp;sep&nbsp;and&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1866085">//&nbsp;the&nbsp;subslices&nbsp;between&nbsp;those&nbsp;separators.</span><br>
<span class="lineno"></span><span class="comment" id="1866128">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;SplitN&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="comment" id="1866189">//&nbsp;The&nbsp;count&nbsp;determines&nbsp;the&nbsp;number&nbsp;of&nbsp;subslices&nbsp;to&nbsp;return:</span><br>
<span class="lineno">230</span><span class="comment" id="1866248">//&nbsp;&nbsp;&nbsp;n&nbsp;&gt;&nbsp;0:&nbsp;at&nbsp;most&nbsp;n&nbsp;subslices;&nbsp;the&nbsp;last&nbsp;subslice&nbsp;will&nbsp;be&nbsp;the&nbsp;unsplit&nbsp;remainder.</span><br>
<span class="lineno"></span><span class="comment" id="1866330">//&nbsp;&nbsp;&nbsp;n&nbsp;==&nbsp;0:&nbsp;the&nbsp;result&nbsp;is&nbsp;nil&nbsp;(zero&nbsp;subslices)</span><br>
<span class="lineno"></span><span class="comment" id="1866378">//&nbsp;&nbsp;&nbsp;n&nbsp;&lt;&nbsp;0:&nbsp;all&nbsp;subslices</span><br>
<span class="lineno"></span><span class="keyword" id="1866404">func</span>&nbsp;<span class="ident" id="1866409">SplitN</span><span class="op" id="1866415">(</span><span class="ident" id="1866416">s</span><span class="op" id="1866417">,</span>&nbsp;<span class="ident" id="1866419">sep</span>&nbsp;<span class="op" id="1866423">[</span><span class="op" id="1866424">]</span><span class="builtintype" id="1866425">byte</span><span class="op" id="1866429">,</span>&nbsp;<span class="ident" id="1866431">n</span>&nbsp;<span class="builtintype" id="1866433">int</span><span class="op" id="1866436">)</span>&nbsp;<span class="op" id="1866438">[</span><span class="op" id="1866439">]</span><span class="op" id="1866440">[</span><span class="op" id="1866441">]</span><span class="builtintype" id="1866442">byte</span>&nbsp;<span class="op" id="1866447">{</span>&nbsp;<span class="keyword" id="1866449">return</span>&nbsp;<span class="ident" id="1866456">genSplit</span><span class="op" id="1866464">(</span><span class="ident" id="1866465">s</span><span class="op" id="1866466">,</span>&nbsp;<span class="ident" id="1866468">sep</span><span class="op" id="1866471">,</span>&nbsp;<span class="num" id="1866473">0</span><span class="op" id="1866474">,</span>&nbsp;<span class="ident" id="1866476">n</span><span class="op" id="1866477">)</span>&nbsp;<span class="op" id="1866479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="comment" id="1866482">//&nbsp;SplitAfterN&nbsp;slices&nbsp;s&nbsp;into&nbsp;subslices&nbsp;after&nbsp;each&nbsp;instance&nbsp;of&nbsp;sep&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1866552">//&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;those&nbsp;subslices.</span><br>
<span class="lineno"></span><span class="comment" id="1866591">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;SplitAfterN&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="comment" id="1866657">//&nbsp;The&nbsp;count&nbsp;determines&nbsp;the&nbsp;number&nbsp;of&nbsp;subslices&nbsp;to&nbsp;return:</span><br>
<span class="lineno"></span><span class="comment" id="1866716">//&nbsp;&nbsp;&nbsp;n&nbsp;&gt;&nbsp;0:&nbsp;at&nbsp;most&nbsp;n&nbsp;subslices;&nbsp;the&nbsp;last&nbsp;subslice&nbsp;will&nbsp;be&nbsp;the&nbsp;unsplit&nbsp;remainder.</span><br>
<span class="lineno">240</span><span class="comment" id="1866798">//&nbsp;&nbsp;&nbsp;n&nbsp;==&nbsp;0:&nbsp;the&nbsp;result&nbsp;is&nbsp;nil&nbsp;(zero&nbsp;subslices)</span><br>
<span class="lineno"></span><span class="comment" id="1866846">//&nbsp;&nbsp;&nbsp;n&nbsp;&lt;&nbsp;0:&nbsp;all&nbsp;subslices</span><br>
<span class="lineno"></span><span class="keyword" id="1866872">func</span>&nbsp;<span class="ident" id="1866877">SplitAfterN</span><span class="op" id="1866888">(</span><span class="ident" id="1866889">s</span><span class="op" id="1866890">,</span>&nbsp;<span class="ident" id="1866892">sep</span>&nbsp;<span class="op" id="1866896">[</span><span class="op" id="1866897">]</span><span class="builtintype" id="1866898">byte</span><span class="op" id="1866902">,</span>&nbsp;<span class="ident" id="1866904">n</span>&nbsp;<span class="builtintype" id="1866906">int</span><span class="op" id="1866909">)</span>&nbsp;<span class="op" id="1866911">[</span><span class="op" id="1866912">]</span><span class="op" id="1866913">[</span><span class="op" id="1866914">]</span><span class="builtintype" id="1866915">byte</span>&nbsp;<span class="op" id="1866920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1866923">return</span>&nbsp;<span class="ident" id="1866930">genSplit</span><span class="op" id="1866938">(</span><span class="ident" id="1866939">s</span><span class="op" id="1866940">,</span>&nbsp;<span class="ident" id="1866942">sep</span><span class="op" id="1866945">,</span>&nbsp;<span class="builtinfunc" id="1866947">len</span><span class="op" id="1866950">(</span><span class="ident" id="1866951">sep</span><span class="op" id="1866954">)</span><span class="op" id="1866955">,</span>&nbsp;<span class="ident" id="1866957">n</span><span class="op" id="1866958">)</span><br>
<span class="lineno"></span><span class="op" id="1866960">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="comment" id="1866963">//&nbsp;Split&nbsp;slices&nbsp;s&nbsp;into&nbsp;all&nbsp;subslices&nbsp;separated&nbsp;by&nbsp;sep&nbsp;and&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1867040">//&nbsp;the&nbsp;subslices&nbsp;between&nbsp;those&nbsp;separators.</span><br>
<span class="lineno"></span><span class="comment" id="1867083">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;Split&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="comment" id="1867143">//&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;SplitN&nbsp;with&nbsp;a&nbsp;count&nbsp;of&nbsp;-1.</span><br>
<span class="lineno">250</span><span class="keyword" id="1867193">func</span>&nbsp;<span class="ident" id="1867198">Split</span><span class="op" id="1867203">(</span><span class="ident" id="1867204">s</span><span class="op" id="1867205">,</span>&nbsp;<span class="ident" id="1867207">sep</span>&nbsp;<span class="op" id="1867211">[</span><span class="op" id="1867212">]</span><span class="builtintype" id="1867213">byte</span><span class="op" id="1867217">)</span>&nbsp;<span class="op" id="1867219">[</span><span class="op" id="1867220">]</span><span class="op" id="1867221">[</span><span class="op" id="1867222">]</span><span class="builtintype" id="1867223">byte</span>&nbsp;<span class="op" id="1867228">{</span>&nbsp;<span class="keyword" id="1867230">return</span>&nbsp;<span class="ident" id="1867237">genSplit</span><span class="op" id="1867245">(</span><span class="ident" id="1867246">s</span><span class="op" id="1867247">,</span>&nbsp;<span class="ident" id="1867249">sep</span><span class="op" id="1867252">,</span>&nbsp;<span class="num" id="1867254">0</span><span class="op" id="1867255">,</span>&nbsp;<span class="op" id="1867257">-</span><span class="num" id="1867258">1</span><span class="op" id="1867259">)</span>&nbsp;<span class="op" id="1867261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1867264">//&nbsp;SplitAfter&nbsp;slices&nbsp;s&nbsp;into&nbsp;all&nbsp;subslices&nbsp;after&nbsp;each&nbsp;instance&nbsp;of&nbsp;sep&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1867337">//&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;those&nbsp;subslices.</span><br>
<span class="lineno"></span><span class="comment" id="1867376">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;SplitAfter&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno">255</span><span class="comment" id="1867441">//&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;SplitAfterN&nbsp;with&nbsp;a&nbsp;count&nbsp;of&nbsp;-1.</span><br>
<span class="lineno"></span><span class="keyword" id="1867496">func</span>&nbsp;<span class="ident" id="1867501">SplitAfter</span><span class="op" id="1867511">(</span><span class="ident" id="1867512">s</span><span class="op" id="1867513">,</span>&nbsp;<span class="ident" id="1867515">sep</span>&nbsp;<span class="op" id="1867519">[</span><span class="op" id="1867520">]</span><span class="builtintype" id="1867521">byte</span><span class="op" id="1867525">)</span>&nbsp;<span class="op" id="1867527">[</span><span class="op" id="1867528">]</span><span class="op" id="1867529">[</span><span class="op" id="1867530">]</span><span class="builtintype" id="1867531">byte</span>&nbsp;<span class="op" id="1867536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1867539">return</span>&nbsp;<span class="ident" id="1867546">genSplit</span><span class="op" id="1867554">(</span><span class="ident" id="1867555">s</span><span class="op" id="1867556">,</span>&nbsp;<span class="ident" id="1867558">sep</span><span class="op" id="1867561">,</span>&nbsp;<span class="builtinfunc" id="1867563">len</span><span class="op" id="1867566">(</span><span class="ident" id="1867567">sep</span><span class="op" id="1867570">)</span><span class="op" id="1867571">,</span>&nbsp;<span class="op" id="1867573">-</span><span class="num" id="1867574">1</span><span class="op" id="1867575">)</span><br>
<span class="lineno"></span><span class="op" id="1867577">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="1867580">//&nbsp;Fields&nbsp;splits&nbsp;the&nbsp;slice&nbsp;s&nbsp;around&nbsp;each&nbsp;instance&nbsp;of&nbsp;one&nbsp;or&nbsp;more&nbsp;consecutive&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span><span class="comment" id="1867669">//&nbsp;characters,&nbsp;returning&nbsp;a&nbsp;slice&nbsp;of&nbsp;subslices&nbsp;of&nbsp;s&nbsp;or&nbsp;an&nbsp;empty&nbsp;list&nbsp;if&nbsp;s&nbsp;contains&nbsp;only&nbsp;white&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="1867769">func</span>&nbsp;<span class="ident" id="1867774">Fields</span><span class="op" id="1867780">(</span><span class="ident" id="1867781">s</span>&nbsp;<span class="op" id="1867783">[</span><span class="op" id="1867784">]</span><span class="builtintype" id="1867785">byte</span><span class="op" id="1867789">)</span>&nbsp;<span class="op" id="1867791">[</span><span class="op" id="1867792">]</span><span class="op" id="1867793">[</span><span class="op" id="1867794">]</span><span class="builtintype" id="1867795">byte</span>&nbsp;<span class="op" id="1867800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1867803">return</span>&nbsp;<span class="ident" id="1867810">FieldsFunc</span><span class="op" id="1867820">(</span><span class="ident" id="1867821">s</span><span class="op" id="1867822">,</span>&nbsp;<span class="ident" id="1867824">unicode</span><span class="op" id="1867831">.</span><span class="ident" id="1867832">IsSpace</span><span class="op" id="1867839">)</span><br>
<span class="lineno"></span><span class="op" id="1867841">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="comment" id="1867844">//&nbsp;FieldsFunc&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="1867923">//&nbsp;It&nbsp;splits&nbsp;the&nbsp;slice&nbsp;s&nbsp;at&nbsp;each&nbsp;run&nbsp;of&nbsp;code&nbsp;points&nbsp;c&nbsp;satisfying&nbsp;f(c)&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1867997">//&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;subslices&nbsp;of&nbsp;s.&nbsp;&nbsp;If&nbsp;all&nbsp;code&nbsp;points&nbsp;in&nbsp;s&nbsp;satisfy&nbsp;f(c),&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1868077">//&nbsp;len(s)&nbsp;==&nbsp;0,&nbsp;an&nbsp;empty&nbsp;slice&nbsp;is&nbsp;returned.</span><br>
<span class="lineno">270</span><span class="comment" id="1868121">//&nbsp;FieldsFunc&nbsp;makes&nbsp;no&nbsp;guarantees&nbsp;about&nbsp;the&nbsp;order&nbsp;in&nbsp;which&nbsp;it&nbsp;calls&nbsp;f(c).</span><br>
<span class="lineno"></span><span class="comment" id="1868195">//&nbsp;If&nbsp;f&nbsp;does&nbsp;not&nbsp;return&nbsp;consistent&nbsp;results&nbsp;for&nbsp;a&nbsp;given&nbsp;c,&nbsp;FieldsFunc&nbsp;may&nbsp;crash.</span><br>
<span class="lineno"></span><span class="keyword" id="1868275">func</span>&nbsp;<span class="ident" id="1868280">FieldsFunc</span><span class="op" id="1868290">(</span><span class="ident" id="1868291">s</span>&nbsp;<span class="op" id="1868293">[</span><span class="op" id="1868294">]</span><span class="builtintype" id="1868295">byte</span><span class="op" id="1868299">,</span>&nbsp;<span class="ident" id="1868301">f</span>&nbsp;<span class="keyword" id="1868303">func</span><span class="op" id="1868307">(</span><span class="builtintype" id="1868308">rune</span><span class="op" id="1868312">)</span>&nbsp;<span class="builtintype" id="1868314">bool</span><span class="op" id="1868318">)</span>&nbsp;<span class="op" id="1868320">[</span><span class="op" id="1868321">]</span><span class="op" id="1868322">[</span><span class="op" id="1868323">]</span><span class="builtintype" id="1868324">byte</span>&nbsp;<span class="op" id="1868329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1868332">n</span>&nbsp;<span class="op" id="1868334">:=</span>&nbsp;<span class="num" id="1868337">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1868340">inField</span>&nbsp;<span class="op" id="1868348">:=</span>&nbsp;<span class="builtintype" id="1868351">false</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1868358">for</span>&nbsp;<span class="ident" id="1868362">i</span>&nbsp;<span class="op" id="1868364">:=</span>&nbsp;<span class="num" id="1868367">0</span><span class="op" id="1868368">;</span>&nbsp;<span class="ident" id="1868370">i</span>&nbsp;<span class="op" id="1868372">&lt;</span>&nbsp;<span class="builtinfunc" id="1868374">len</span><span class="op" id="1868377">(</span><span class="ident" id="1868378">s</span><span class="op" id="1868379">)</span><span class="op" id="1868380">;</span>&nbsp;<span class="op" id="1868382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1868386">r</span><span class="op" id="1868387">,</span>&nbsp;<span class="ident" id="1868389">size</span>&nbsp;<span class="op" id="1868394">:=</span>&nbsp;<span class="ident" id="1868397">utf8</span><span class="op" id="1868401">.</span><span class="ident" id="1868402">DecodeRune</span><span class="op" id="1868412">(</span><span class="ident" id="1868413">s</span><span class="op" id="1868414">[</span><span class="ident" id="1868415">i</span><span class="op" id="1868416">:</span><span class="op" id="1868417">]</span><span class="op" id="1868418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1868422">wasInField</span>&nbsp;<span class="op" id="1868433">:=</span>&nbsp;<span class="ident" id="1868436">inField</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1868446">inField</span>&nbsp;<span class="op" id="1868454">=</span>&nbsp;<span class="op" id="1868456">!</span><span class="ident" id="1868457">f</span><span class="op" id="1868458">(</span><span class="ident" id="1868459">r</span><span class="op" id="1868460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1868464">if</span>&nbsp;<span class="ident" id="1868467">inField</span>&nbsp;<span class="op" id="1868475">&amp;&amp;</span>&nbsp;<span class="op" id="1868478">!</span><span class="ident" id="1868479">wasInField</span>&nbsp;<span class="op" id="1868490">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1868495">n</span><span class="op" id="1868496">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1868501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1868505">i</span>&nbsp;<span class="op" id="1868507">+=</span>&nbsp;<span class="ident" id="1868510">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1868516">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1868520">a</span>&nbsp;<span class="op" id="1868522">:=</span>&nbsp;<span class="builtinfunc" id="1868525">make</span><span class="op" id="1868529">(</span><span class="op" id="1868530">[</span><span class="op" id="1868531">]</span><span class="op" id="1868532">[</span><span class="op" id="1868533">]</span><span class="builtintype" id="1868534">byte</span><span class="op" id="1868538">,</span>&nbsp;<span class="ident" id="1868540">n</span><span class="op" id="1868541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1868544">na</span>&nbsp;<span class="op" id="1868547">:=</span>&nbsp;<span class="num" id="1868550">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1868553">fieldStart</span>&nbsp;<span class="op" id="1868564">:=</span>&nbsp;<span class="op" id="1868567">-</span><span class="num" id="1868568">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1868571">for</span>&nbsp;<span class="ident" id="1868575">i</span>&nbsp;<span class="op" id="1868577">:=</span>&nbsp;<span class="num" id="1868580">0</span><span class="op" id="1868581">;</span>&nbsp;<span class="ident" id="1868583">i</span>&nbsp;<span class="op" id="1868585">&lt;=</span>&nbsp;<span class="builtinfunc" id="1868588">len</span><span class="op" id="1868591">(</span><span class="ident" id="1868592">s</span><span class="op" id="1868593">)</span>&nbsp;<span class="op" id="1868595">&amp;&amp;</span>&nbsp;<span class="ident" id="1868598">na</span>&nbsp;<span class="op" id="1868601">&lt;</span>&nbsp;<span class="ident" id="1868603">n</span><span class="op" id="1868604">;</span>&nbsp;<span class="op" id="1868606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1868610">r</span><span class="op" id="1868611">,</span>&nbsp;<span class="ident" id="1868613">size</span>&nbsp;<span class="op" id="1868618">:=</span>&nbsp;<span class="ident" id="1868621">utf8</span><span class="op" id="1868625">.</span><span class="ident" id="1868626">DecodeRune</span><span class="op" id="1868636">(</span><span class="ident" id="1868637">s</span><span class="op" id="1868638">[</span><span class="ident" id="1868639">i</span><span class="op" id="1868640">:</span><span class="op" id="1868641">]</span><span class="op" id="1868642">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1868646">if</span>&nbsp;<span class="ident" id="1868649">fieldStart</span>&nbsp;<span class="op" id="1868660">&lt;</span>&nbsp;<span class="num" id="1868662">0</span>&nbsp;<span class="op" id="1868664">&amp;&amp;</span>&nbsp;<span class="ident" id="1868667">size</span>&nbsp;<span class="op" id="1868672">&gt;</span>&nbsp;<span class="num" id="1868674">0</span>&nbsp;<span class="op" id="1868676">&amp;&amp;</span>&nbsp;<span class="op" id="1868679">!</span><span class="ident" id="1868680">f</span><span class="op" id="1868681">(</span><span class="ident" id="1868682">r</span><span class="op" id="1868683">)</span>&nbsp;<span class="op" id="1868685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1868690">fieldStart</span>&nbsp;<span class="op" id="1868701">=</span>&nbsp;<span class="ident" id="1868703">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1868708">i</span>&nbsp;<span class="op" id="1868710">+=</span>&nbsp;<span class="ident" id="1868713">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1868721">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1868732">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1868736">if</span>&nbsp;<span class="ident" id="1868739">fieldStart</span>&nbsp;<span class="op" id="1868750">&gt;=</span>&nbsp;<span class="num" id="1868753">0</span>&nbsp;<span class="op" id="1868755">&amp;&amp;</span>&nbsp;<span class="op" id="1868758">(</span><span class="ident" id="1868759">size</span>&nbsp;<span class="op" id="1868764">==</span>&nbsp;<span class="num" id="1868767">0</span>&nbsp;<span class="op" id="1868769">||</span>&nbsp;<span class="ident" id="1868772">f</span><span class="op" id="1868773">(</span><span class="ident" id="1868774">r</span><span class="op" id="1868775">)</span><span class="op" id="1868776">)</span>&nbsp;<span class="op" id="1868778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1868783">a</span><span class="op" id="1868784">[</span><span class="ident" id="1868785">na</span><span class="op" id="1868787">]</span>&nbsp;<span class="op" id="1868789">=</span>&nbsp;<span class="ident" id="1868791">s</span><span class="op" id="1868792">[</span><span class="ident" id="1868793">fieldStart</span><span class="op" id="1868803">:</span><span class="ident" id="1868804">i</span><span class="op" id="1868805">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1868810">na</span><span class="op" id="1868812">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1868818">fieldStart</span>&nbsp;<span class="op" id="1868829">=</span>&nbsp;<span class="op" id="1868831">-</span><span class="num" id="1868832">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1868836">}</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1868840">if</span>&nbsp;<span class="ident" id="1868843">size</span>&nbsp;<span class="op" id="1868848">==</span>&nbsp;<span class="num" id="1868851">0</span>&nbsp;<span class="op" id="1868853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1868858">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1868866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1868870">i</span>&nbsp;<span class="op" id="1868872">+=</span>&nbsp;<span class="ident" id="1868875">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1868881">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1868884">return</span>&nbsp;<span class="ident" id="1868891">a</span><span class="op" id="1868892">[</span><span class="num" id="1868893">0</span><span class="op" id="1868894">:</span><span class="ident" id="1868895">na</span><span class="op" id="1868897">]</span><br>
<span class="lineno"></span><span class="op" id="1868899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1868902">//&nbsp;Join&nbsp;concatenates&nbsp;the&nbsp;elements&nbsp;of&nbsp;s&nbsp;to&nbsp;create&nbsp;a&nbsp;new&nbsp;byte&nbsp;slice.&nbsp;The&nbsp;separator</span><br>
<span class="lineno"></span><span class="comment" id="1868983">//&nbsp;sep&nbsp;is&nbsp;placed&nbsp;between&nbsp;elements&nbsp;in&nbsp;the&nbsp;resulting&nbsp;slice.</span><br>
<span class="lineno">310</span><span class="keyword" id="1869041">func</span>&nbsp;<span class="ident" id="1869046">Join</span><span class="op" id="1869050">(</span><span class="ident" id="1869051">s</span>&nbsp;<span class="op" id="1869053">[</span><span class="op" id="1869054">]</span><span class="op" id="1869055">[</span><span class="op" id="1869056">]</span><span class="builtintype" id="1869057">byte</span><span class="op" id="1869061">,</span>&nbsp;<span class="ident" id="1869063">sep</span>&nbsp;<span class="op" id="1869067">[</span><span class="op" id="1869068">]</span><span class="builtintype" id="1869069">byte</span><span class="op" id="1869073">)</span>&nbsp;<span class="op" id="1869075">[</span><span class="op" id="1869076">]</span><span class="builtintype" id="1869077">byte</span>&nbsp;<span class="op" id="1869082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1869085">if</span>&nbsp;<span class="builtinfunc" id="1869088">len</span><span class="op" id="1869091">(</span><span class="ident" id="1869092">s</span><span class="op" id="1869093">)</span>&nbsp;<span class="op" id="1869095">==</span>&nbsp;<span class="num" id="1869098">0</span>&nbsp;<span class="op" id="1869100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1869104">return</span>&nbsp;<span class="op" id="1869111">[</span><span class="op" id="1869112">]</span><span class="builtintype" id="1869113">byte</span><span class="op" id="1869117">{</span><span class="op" id="1869118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1869121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1869124">if</span>&nbsp;<span class="builtinfunc" id="1869127">len</span><span class="op" id="1869130">(</span><span class="ident" id="1869131">s</span><span class="op" id="1869132">)</span>&nbsp;<span class="op" id="1869134">==</span>&nbsp;<span class="num" id="1869137">1</span>&nbsp;<span class="op" id="1869139">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1869143">//&nbsp;Just&nbsp;return&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1869168">return</span>&nbsp;<span class="builtinfunc" id="1869175">append</span><span class="op" id="1869181">(</span><span class="op" id="1869182">[</span><span class="op" id="1869183">]</span><span class="builtintype" id="1869184">byte</span><span class="op" id="1869188">(</span><span class="builtintype" id="1869189">nil</span><span class="op" id="1869192">)</span><span class="op" id="1869193">,</span>&nbsp;<span class="ident" id="1869195">s</span><span class="op" id="1869196">[</span><span class="num" id="1869197">0</span><span class="op" id="1869198">]</span><span class="op" id="1869199">...</span><span class="op" id="1869202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1869205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1869208">n</span>&nbsp;<span class="op" id="1869210">:=</span>&nbsp;<span class="builtinfunc" id="1869213">len</span><span class="op" id="1869216">(</span><span class="ident" id="1869217">sep</span><span class="op" id="1869220">)</span>&nbsp;<span class="op" id="1869222">*</span>&nbsp;<span class="op" id="1869224">(</span><span class="builtinfunc" id="1869225">len</span><span class="op" id="1869228">(</span><span class="ident" id="1869229">s</span><span class="op" id="1869230">)</span>&nbsp;<span class="op" id="1869232">-</span>&nbsp;<span class="num" id="1869234">1</span><span class="op" id="1869235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1869238">for</span>&nbsp;<span class="ident" id="1869242">_</span><span class="op" id="1869243">,</span>&nbsp;<span class="ident" id="1869245">v</span>&nbsp;<span class="op" id="1869247">:=</span>&nbsp;<span class="keyword" id="1869250">range</span>&nbsp;<span class="ident" id="1869256">s</span>&nbsp;<span class="op" id="1869258">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1869262">n</span>&nbsp;<span class="op" id="1869264">+=</span>&nbsp;<span class="builtinfunc" id="1869267">len</span><span class="op" id="1869270">(</span><span class="ident" id="1869271">v</span><span class="op" id="1869272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1869275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1869279">b</span>&nbsp;<span class="op" id="1869281">:=</span>&nbsp;<span class="builtinfunc" id="1869284">make</span><span class="op" id="1869288">(</span><span class="op" id="1869289">[</span><span class="op" id="1869290">]</span><span class="builtintype" id="1869291">byte</span><span class="op" id="1869295">,</span>&nbsp;<span class="ident" id="1869297">n</span><span class="op" id="1869298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1869301">bp</span>&nbsp;<span class="op" id="1869304">:=</span>&nbsp;<span class="builtinfunc" id="1869307">copy</span><span class="op" id="1869311">(</span><span class="ident" id="1869312">b</span><span class="op" id="1869313">,</span>&nbsp;<span class="ident" id="1869315">s</span><span class="op" id="1869316">[</span><span class="num" id="1869317">0</span><span class="op" id="1869318">]</span><span class="op" id="1869319">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1869322">for</span>&nbsp;<span class="ident" id="1869326">_</span><span class="op" id="1869327">,</span>&nbsp;<span class="ident" id="1869329">v</span>&nbsp;<span class="op" id="1869331">:=</span>&nbsp;<span class="keyword" id="1869334">range</span>&nbsp;<span class="ident" id="1869340">s</span><span class="op" id="1869341">[</span><span class="num" id="1869342">1</span><span class="op" id="1869343">:</span><span class="op" id="1869344">]</span>&nbsp;<span class="op" id="1869346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1869350">bp</span>&nbsp;<span class="op" id="1869353">+=</span>&nbsp;<span class="builtinfunc" id="1869356">copy</span><span class="op" id="1869360">(</span><span class="ident" id="1869361">b</span><span class="op" id="1869362">[</span><span class="ident" id="1869363">bp</span><span class="op" id="1869365">:</span><span class="op" id="1869366">]</span><span class="op" id="1869367">,</span>&nbsp;<span class="ident" id="1869369">sep</span><span class="op" id="1869372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1869376">bp</span>&nbsp;<span class="op" id="1869379">+=</span>&nbsp;<span class="builtinfunc" id="1869382">copy</span><span class="op" id="1869386">(</span><span class="ident" id="1869387">b</span><span class="op" id="1869388">[</span><span class="ident" id="1869389">bp</span><span class="op" id="1869391">:</span><span class="op" id="1869392">]</span><span class="op" id="1869393">,</span>&nbsp;<span class="ident" id="1869395">v</span><span class="op" id="1869396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1869399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1869402">return</span>&nbsp;<span class="ident" id="1869409">b</span><br>
<span class="lineno">330</span><span class="op" id="1869411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1869414">//&nbsp;HasPrefix&nbsp;tests&nbsp;whether&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;begins&nbsp;with&nbsp;prefix.</span><br>
<span class="lineno"></span><span class="keyword" id="1869478">func</span>&nbsp;<span class="ident" id="1869483">HasPrefix</span><span class="op" id="1869492">(</span><span class="ident" id="1869493">s</span><span class="op" id="1869494">,</span>&nbsp;<span class="ident" id="1869496">prefix</span>&nbsp;<span class="op" id="1869503">[</span><span class="op" id="1869504">]</span><span class="builtintype" id="1869505">byte</span><span class="op" id="1869509">)</span>&nbsp;<span class="builtintype" id="1869511">bool</span>&nbsp;<span class="op" id="1869516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1869519">return</span>&nbsp;<span class="builtinfunc" id="1869526">len</span><span class="op" id="1869529">(</span><span class="ident" id="1869530">s</span><span class="op" id="1869531">)</span>&nbsp;<span class="op" id="1869533">&gt;=</span>&nbsp;<span class="builtinfunc" id="1869536">len</span><span class="op" id="1869539">(</span><span class="ident" id="1869540">prefix</span><span class="op" id="1869546">)</span>&nbsp;<span class="op" id="1869548">&amp;&amp;</span>&nbsp;<span class="ident" id="1869551">Equal</span><span class="op" id="1869556">(</span><span class="ident" id="1869557">s</span><span class="op" id="1869558">[</span><span class="num" id="1869559">0</span><span class="op" id="1869560">:</span><span class="builtinfunc" id="1869561">len</span><span class="op" id="1869564">(</span><span class="ident" id="1869565">prefix</span><span class="op" id="1869571">)</span><span class="op" id="1869572">]</span><span class="op" id="1869573">,</span>&nbsp;<span class="ident" id="1869575">prefix</span><span class="op" id="1869581">)</span><br>
<span class="lineno">335</span><span class="op" id="1869583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1869586">//&nbsp;HasSuffix&nbsp;tests&nbsp;whether&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;ends&nbsp;with&nbsp;suffix.</span><br>
<span class="lineno"></span><span class="keyword" id="1869648">func</span>&nbsp;<span class="ident" id="1869653">HasSuffix</span><span class="op" id="1869662">(</span><span class="ident" id="1869663">s</span><span class="op" id="1869664">,</span>&nbsp;<span class="ident" id="1869666">suffix</span>&nbsp;<span class="op" id="1869673">[</span><span class="op" id="1869674">]</span><span class="builtintype" id="1869675">byte</span><span class="op" id="1869679">)</span>&nbsp;<span class="builtintype" id="1869681">bool</span>&nbsp;<span class="op" id="1869686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1869689">return</span>&nbsp;<span class="builtinfunc" id="1869696">len</span><span class="op" id="1869699">(</span><span class="ident" id="1869700">s</span><span class="op" id="1869701">)</span>&nbsp;<span class="op" id="1869703">&gt;=</span>&nbsp;<span class="builtinfunc" id="1869706">len</span><span class="op" id="1869709">(</span><span class="ident" id="1869710">suffix</span><span class="op" id="1869716">)</span>&nbsp;<span class="op" id="1869718">&amp;&amp;</span>&nbsp;<span class="ident" id="1869721">Equal</span><span class="op" id="1869726">(</span><span class="ident" id="1869727">s</span><span class="op" id="1869728">[</span><span class="builtinfunc" id="1869729">len</span><span class="op" id="1869732">(</span><span class="ident" id="1869733">s</span><span class="op" id="1869734">)</span><span class="op" id="1869735">-</span><span class="builtinfunc" id="1869736">len</span><span class="op" id="1869739">(</span><span class="ident" id="1869740">suffix</span><span class="op" id="1869746">)</span><span class="op" id="1869747">:</span><span class="op" id="1869748">]</span><span class="op" id="1869749">,</span>&nbsp;<span class="ident" id="1869751">suffix</span><span class="op" id="1869757">)</span><br>
<span class="lineno">340</span><span class="op" id="1869759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1869762">//&nbsp;Map&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;its&nbsp;characters&nbsp;modified</span><br>
<span class="lineno"></span><span class="comment" id="1869837">//&nbsp;according&nbsp;to&nbsp;the&nbsp;mapping&nbsp;function.&nbsp;If&nbsp;mapping&nbsp;returns&nbsp;a&nbsp;negative&nbsp;value,&nbsp;the&nbsp;character&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1869929">//&nbsp;dropped&nbsp;from&nbsp;the&nbsp;string&nbsp;with&nbsp;no&nbsp;replacement.&nbsp;&nbsp;The&nbsp;characters&nbsp;in&nbsp;s&nbsp;and&nbsp;the</span><br>
<span class="lineno">345</span><span class="comment" id="1870006">//&nbsp;output&nbsp;are&nbsp;interpreted&nbsp;as&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="keyword" id="1870070">func</span>&nbsp;<span class="ident" id="1870075">Map</span><span class="op" id="1870078">(</span><span class="ident" id="1870079">mapping</span>&nbsp;<span class="keyword" id="1870087">func</span><span class="op" id="1870091">(</span><span class="ident" id="1870092">r</span>&nbsp;<span class="builtintype" id="1870094">rune</span><span class="op" id="1870098">)</span>&nbsp;<span class="builtintype" id="1870100">rune</span><span class="op" id="1870104">,</span>&nbsp;<span class="ident" id="1870106">s</span>&nbsp;<span class="op" id="1870108">[</span><span class="op" id="1870109">]</span><span class="builtintype" id="1870110">byte</span><span class="op" id="1870114">)</span>&nbsp;<span class="op" id="1870116">[</span><span class="op" id="1870117">]</span><span class="builtintype" id="1870118">byte</span>&nbsp;<span class="op" id="1870123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1870126">//&nbsp;In&nbsp;the&nbsp;worst&nbsp;case,&nbsp;the&nbsp;slice&nbsp;can&nbsp;grow&nbsp;when&nbsp;mapped,&nbsp;making</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1870188">//&nbsp;things&nbsp;unpleasant.&nbsp;&nbsp;But&nbsp;it&#39;s&nbsp;so&nbsp;rare&nbsp;we&nbsp;barge&nbsp;in&nbsp;assuming&nbsp;it&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1870255">//&nbsp;fine.&nbsp;&nbsp;It&nbsp;could&nbsp;also&nbsp;shrink&nbsp;but&nbsp;that&nbsp;falls&nbsp;out&nbsp;naturally.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1870317">maxbytes</span>&nbsp;<span class="op" id="1870326">:=</span>&nbsp;<span class="builtinfunc" id="1870329">len</span><span class="op" id="1870332">(</span><span class="ident" id="1870333">s</span><span class="op" id="1870334">)</span>&nbsp;<span class="comment" id="1870336">//&nbsp;length&nbsp;of&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1870352">nbytes</span>&nbsp;<span class="op" id="1870359">:=</span>&nbsp;<span class="num" id="1870362">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1870371">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;encoded&nbsp;in&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1870404">b</span>&nbsp;<span class="op" id="1870406">:=</span>&nbsp;<span class="builtinfunc" id="1870409">make</span><span class="op" id="1870413">(</span><span class="op" id="1870414">[</span><span class="op" id="1870415">]</span><span class="builtintype" id="1870416">byte</span><span class="op" id="1870420">,</span>&nbsp;<span class="ident" id="1870422">maxbytes</span><span class="op" id="1870430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1870433">for</span>&nbsp;<span class="ident" id="1870437">i</span>&nbsp;<span class="op" id="1870439">:=</span>&nbsp;<span class="num" id="1870442">0</span><span class="op" id="1870443">;</span>&nbsp;<span class="ident" id="1870445">i</span>&nbsp;<span class="op" id="1870447">&lt;</span>&nbsp;<span class="builtinfunc" id="1870449">len</span><span class="op" id="1870452">(</span><span class="ident" id="1870453">s</span><span class="op" id="1870454">)</span><span class="op" id="1870455">;</span>&nbsp;<span class="op" id="1870457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1870461">wid</span>&nbsp;<span class="op" id="1870465">:=</span>&nbsp;<span class="num" id="1870468">1</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1870472">r</span>&nbsp;<span class="op" id="1870474">:=</span>&nbsp;<span class="builtintype" id="1870477">rune</span><span class="op" id="1870481">(</span><span class="ident" id="1870482">s</span><span class="op" id="1870483">[</span><span class="ident" id="1870484">i</span><span class="op" id="1870485">]</span><span class="op" id="1870486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1870490">if</span>&nbsp;<span class="ident" id="1870493">r</span>&nbsp;<span class="op" id="1870495">&gt;=</span>&nbsp;<span class="ident" id="1870498">utf8</span><span class="op" id="1870502">.</span><span class="ident" id="1870503">RuneSelf</span>&nbsp;<span class="op" id="1870512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1870517">r</span><span class="op" id="1870518">,</span>&nbsp;<span class="ident" id="1870520">wid</span>&nbsp;<span class="op" id="1870524">=</span>&nbsp;<span class="ident" id="1870526">utf8</span><span class="op" id="1870530">.</span><span class="ident" id="1870531">DecodeRune</span><span class="op" id="1870541">(</span><span class="ident" id="1870542">s</span><span class="op" id="1870543">[</span><span class="ident" id="1870544">i</span><span class="op" id="1870545">:</span><span class="op" id="1870546">]</span><span class="op" id="1870547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1870551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1870555">r</span>&nbsp;<span class="op" id="1870557">=</span>&nbsp;<span class="ident" id="1870559">mapping</span><span class="op" id="1870566">(</span><span class="ident" id="1870567">r</span><span class="op" id="1870568">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1870572">if</span>&nbsp;<span class="ident" id="1870575">r</span>&nbsp;<span class="op" id="1870577">&gt;=</span>&nbsp;<span class="num" id="1870580">0</span>&nbsp;<span class="op" id="1870582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1870587">rl</span>&nbsp;<span class="op" id="1870590">:=</span>&nbsp;<span class="ident" id="1870593">utf8</span><span class="op" id="1870597">.</span><span class="ident" id="1870598">RuneLen</span><span class="op" id="1870605">(</span><span class="ident" id="1870606">r</span><span class="op" id="1870607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1870612">if</span>&nbsp;<span class="ident" id="1870615">rl</span>&nbsp;<span class="op" id="1870618">&lt;</span>&nbsp;<span class="num" id="1870620">0</span>&nbsp;<span class="op" id="1870622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1870628">rl</span>&nbsp;<span class="op" id="1870631">=</span>&nbsp;<span class="builtinfunc" id="1870633">len</span><span class="op" id="1870636">(</span><span class="builtintype" id="1870637">string</span><span class="op" id="1870643">(</span><span class="ident" id="1870644">utf8</span><span class="op" id="1870648">.</span><span class="ident" id="1870649">RuneError</span><span class="op" id="1870658">)</span><span class="op" id="1870659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1870664">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1870669">if</span>&nbsp;<span class="ident" id="1870672">nbytes</span><span class="op" id="1870678">+</span><span class="ident" id="1870679">rl</span>&nbsp;<span class="op" id="1870682">&gt;</span>&nbsp;<span class="ident" id="1870684">maxbytes</span>&nbsp;<span class="op" id="1870693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1870699">//&nbsp;Grow&nbsp;the&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1870723">maxbytes</span>&nbsp;<span class="op" id="1870732">=</span>&nbsp;<span class="ident" id="1870734">maxbytes</span><span class="op" id="1870742">*</span><span class="num" id="1870743">2</span>&nbsp;<span class="op" id="1870745">+</span>&nbsp;<span class="ident" id="1870747">utf8</span><span class="op" id="1870751">.</span><span class="ident" id="1870752">UTFMax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1870763">nb</span>&nbsp;<span class="op" id="1870766">:=</span>&nbsp;<span class="builtinfunc" id="1870769">make</span><span class="op" id="1870773">(</span><span class="op" id="1870774">[</span><span class="op" id="1870775">]</span><span class="builtintype" id="1870776">byte</span><span class="op" id="1870780">,</span>&nbsp;<span class="ident" id="1870782">maxbytes</span><span class="op" id="1870790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="1870796">copy</span><span class="op" id="1870800">(</span><span class="ident" id="1870801">nb</span><span class="op" id="1870803">,</span>&nbsp;<span class="ident" id="1870805">b</span><span class="op" id="1870806">[</span><span class="num" id="1870807">0</span><span class="op" id="1870808">:</span><span class="ident" id="1870809">nbytes</span><span class="op" id="1870815">]</span><span class="op" id="1870816">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1870822">b</span>&nbsp;<span class="op" id="1870824">=</span>&nbsp;<span class="ident" id="1870826">nb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1870832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1870837">nbytes</span>&nbsp;<span class="op" id="1870844">+=</span>&nbsp;<span class="ident" id="1870847">utf8</span><span class="op" id="1870851">.</span><span class="ident" id="1870852">EncodeRune</span><span class="op" id="1870862">(</span><span class="ident" id="1870863">b</span><span class="op" id="1870864">[</span><span class="ident" id="1870865">nbytes</span><span class="op" id="1870871">:</span><span class="ident" id="1870872">maxbytes</span><span class="op" id="1870880">]</span><span class="op" id="1870881">,</span>&nbsp;<span class="ident" id="1870883">r</span><span class="op" id="1870884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1870888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1870892">i</span>&nbsp;<span class="op" id="1870894">+=</span>&nbsp;<span class="ident" id="1870897">wid</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1870902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1870905">return</span>&nbsp;<span class="ident" id="1870912">b</span><span class="op" id="1870913">[</span><span class="num" id="1870914">0</span><span class="op" id="1870915">:</span><span class="ident" id="1870916">nbytes</span><span class="op" id="1870922">]</span><br>
<span class="lineno"></span><span class="op" id="1870924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1870927">//&nbsp;Repeat&nbsp;returns&nbsp;a&nbsp;new&nbsp;byte&nbsp;slice&nbsp;consisting&nbsp;of&nbsp;count&nbsp;copies&nbsp;of&nbsp;b.</span><br>
<span class="lineno">380</span><span class="keyword" id="1870995">func</span>&nbsp;<span class="ident" id="1871000">Repeat</span><span class="op" id="1871006">(</span><span class="ident" id="1871007">b</span>&nbsp;<span class="op" id="1871009">[</span><span class="op" id="1871010">]</span><span class="builtintype" id="1871011">byte</span><span class="op" id="1871015">,</span>&nbsp;<span class="ident" id="1871017">count</span>&nbsp;<span class="builtintype" id="1871023">int</span><span class="op" id="1871026">)</span>&nbsp;<span class="op" id="1871028">[</span><span class="op" id="1871029">]</span><span class="builtintype" id="1871030">byte</span>&nbsp;<span class="op" id="1871035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1871038">nb</span>&nbsp;<span class="op" id="1871041">:=</span>&nbsp;<span class="builtinfunc" id="1871044">make</span><span class="op" id="1871048">(</span><span class="op" id="1871049">[</span><span class="op" id="1871050">]</span><span class="builtintype" id="1871051">byte</span><span class="op" id="1871055">,</span>&nbsp;<span class="builtinfunc" id="1871057">len</span><span class="op" id="1871060">(</span><span class="ident" id="1871061">b</span><span class="op" id="1871062">)</span><span class="op" id="1871063">*</span><span class="ident" id="1871064">count</span><span class="op" id="1871069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1871072">bp</span>&nbsp;<span class="op" id="1871075">:=</span>&nbsp;<span class="builtinfunc" id="1871078">copy</span><span class="op" id="1871082">(</span><span class="ident" id="1871083">nb</span><span class="op" id="1871085">,</span>&nbsp;<span class="ident" id="1871087">b</span><span class="op" id="1871088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1871091">for</span>&nbsp;<span class="ident" id="1871095">bp</span>&nbsp;<span class="op" id="1871098">&lt;</span>&nbsp;<span class="builtinfunc" id="1871100">len</span><span class="op" id="1871103">(</span><span class="ident" id="1871104">nb</span><span class="op" id="1871106">)</span>&nbsp;<span class="op" id="1871108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="1871112">copy</span><span class="op" id="1871116">(</span><span class="ident" id="1871117">nb</span><span class="op" id="1871119">[</span><span class="ident" id="1871120">bp</span><span class="op" id="1871122">:</span><span class="op" id="1871123">]</span><span class="op" id="1871124">,</span>&nbsp;<span class="ident" id="1871126">nb</span><span class="op" id="1871128">[</span><span class="op" id="1871129">:</span><span class="ident" id="1871130">bp</span><span class="op" id="1871132">]</span><span class="op" id="1871133">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1871137">bp</span>&nbsp;<span class="op" id="1871140">*=</span>&nbsp;<span class="num" id="1871143">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1871146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1871149">return</span>&nbsp;<span class="ident" id="1871156">nb</span><br>
<span class="lineno"></span><span class="op" id="1871159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="comment" id="1871162">//&nbsp;ToUpper&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their&nbsp;upper&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1871261">func</span>&nbsp;<span class="ident" id="1871266">ToUpper</span><span class="op" id="1871273">(</span><span class="ident" id="1871274">s</span>&nbsp;<span class="op" id="1871276">[</span><span class="op" id="1871277">]</span><span class="builtintype" id="1871278">byte</span><span class="op" id="1871282">)</span>&nbsp;<span class="op" id="1871284">[</span><span class="op" id="1871285">]</span><span class="builtintype" id="1871286">byte</span>&nbsp;<span class="op" id="1871291">{</span>&nbsp;<span class="keyword" id="1871293">return</span>&nbsp;<span class="ident" id="1871300">Map</span><span class="op" id="1871303">(</span><span class="ident" id="1871304">unicode</span><span class="op" id="1871311">.</span><span class="ident" id="1871312">ToUpper</span><span class="op" id="1871319">,</span>&nbsp;<span class="ident" id="1871321">s</span><span class="op" id="1871322">)</span>&nbsp;<span class="op" id="1871324">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1871327">//&nbsp;ToLower&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their&nbsp;lower&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1871426">func</span>&nbsp;<span class="ident" id="1871431">ToLower</span><span class="op" id="1871438">(</span><span class="ident" id="1871439">s</span>&nbsp;<span class="op" id="1871441">[</span><span class="op" id="1871442">]</span><span class="builtintype" id="1871443">byte</span><span class="op" id="1871447">)</span>&nbsp;<span class="op" id="1871449">[</span><span class="op" id="1871450">]</span><span class="builtintype" id="1871451">byte</span>&nbsp;<span class="op" id="1871456">{</span>&nbsp;<span class="keyword" id="1871458">return</span>&nbsp;<span class="ident" id="1871465">Map</span><span class="op" id="1871468">(</span><span class="ident" id="1871469">unicode</span><span class="op" id="1871476">.</span><span class="ident" id="1871477">ToLower</span><span class="op" id="1871484">,</span>&nbsp;<span class="ident" id="1871486">s</span><span class="op" id="1871487">)</span>&nbsp;<span class="op" id="1871489">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="1871492">//&nbsp;ToTitle&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their&nbsp;title&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1871591">func</span>&nbsp;<span class="ident" id="1871596">ToTitle</span><span class="op" id="1871603">(</span><span class="ident" id="1871604">s</span>&nbsp;<span class="op" id="1871606">[</span><span class="op" id="1871607">]</span><span class="builtintype" id="1871608">byte</span><span class="op" id="1871612">)</span>&nbsp;<span class="op" id="1871614">[</span><span class="op" id="1871615">]</span><span class="builtintype" id="1871616">byte</span>&nbsp;<span class="op" id="1871621">{</span>&nbsp;<span class="keyword" id="1871623">return</span>&nbsp;<span class="ident" id="1871630">Map</span><span class="op" id="1871633">(</span><span class="ident" id="1871634">unicode</span><span class="op" id="1871641">.</span><span class="ident" id="1871642">ToTitle</span><span class="op" id="1871649">,</span>&nbsp;<span class="ident" id="1871651">s</span><span class="op" id="1871652">)</span>&nbsp;<span class="op" id="1871654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1871657">//&nbsp;ToUpperSpecial&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their</span><br>
<span class="lineno">400</span><span class="comment" id="1871751">//&nbsp;upper&nbsp;case,&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;casing&nbsp;rules.</span><br>
<span class="lineno"></span><span class="keyword" id="1871811">func</span>&nbsp;<span class="ident" id="1871816">ToUpperSpecial</span><span class="op" id="1871830">(</span><span class="ident" id="1871831">_case</span>&nbsp;<span class="ident" id="1871837">unicode</span><span class="op" id="1871844">.</span><span class="ident" id="1871845">SpecialCase</span><span class="op" id="1871856">,</span>&nbsp;<span class="ident" id="1871858">s</span>&nbsp;<span class="op" id="1871860">[</span><span class="op" id="1871861">]</span><span class="builtintype" id="1871862">byte</span><span class="op" id="1871866">)</span>&nbsp;<span class="op" id="1871868">[</span><span class="op" id="1871869">]</span><span class="builtintype" id="1871870">byte</span>&nbsp;<span class="op" id="1871875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1871878">return</span>&nbsp;<span class="ident" id="1871885">Map</span><span class="op" id="1871888">(</span><span class="keyword" id="1871889">func</span><span class="op" id="1871893">(</span><span class="ident" id="1871894">r</span>&nbsp;<span class="builtintype" id="1871896">rune</span><span class="op" id="1871900">)</span>&nbsp;<span class="builtintype" id="1871902">rune</span>&nbsp;<span class="op" id="1871907">{</span>&nbsp;<span class="keyword" id="1871909">return</span>&nbsp;<span class="ident" id="1871916">_case</span><span class="op" id="1871921">.</span><span class="ident" id="1871922">ToUpper</span><span class="op" id="1871929">(</span><span class="ident" id="1871930">r</span><span class="op" id="1871931">)</span>&nbsp;<span class="op" id="1871933">}</span><span class="op" id="1871934">,</span>&nbsp;<span class="ident" id="1871936">s</span><span class="op" id="1871937">)</span><br>
<span class="lineno"></span><span class="op" id="1871939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="comment" id="1871942">//&nbsp;ToLowerSpecial&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their</span><br>
<span class="lineno"></span><span class="comment" id="1872036">//&nbsp;lower&nbsp;case,&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;casing&nbsp;rules.</span><br>
<span class="lineno"></span><span class="keyword" id="1872096">func</span>&nbsp;<span class="ident" id="1872101">ToLowerSpecial</span><span class="op" id="1872115">(</span><span class="ident" id="1872116">_case</span>&nbsp;<span class="ident" id="1872122">unicode</span><span class="op" id="1872129">.</span><span class="ident" id="1872130">SpecialCase</span><span class="op" id="1872141">,</span>&nbsp;<span class="ident" id="1872143">s</span>&nbsp;<span class="op" id="1872145">[</span><span class="op" id="1872146">]</span><span class="builtintype" id="1872147">byte</span><span class="op" id="1872151">)</span>&nbsp;<span class="op" id="1872153">[</span><span class="op" id="1872154">]</span><span class="builtintype" id="1872155">byte</span>&nbsp;<span class="op" id="1872160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1872163">return</span>&nbsp;<span class="ident" id="1872170">Map</span><span class="op" id="1872173">(</span><span class="keyword" id="1872174">func</span><span class="op" id="1872178">(</span><span class="ident" id="1872179">r</span>&nbsp;<span class="builtintype" id="1872181">rune</span><span class="op" id="1872185">)</span>&nbsp;<span class="builtintype" id="1872187">rune</span>&nbsp;<span class="op" id="1872192">{</span>&nbsp;<span class="keyword" id="1872194">return</span>&nbsp;<span class="ident" id="1872201">_case</span><span class="op" id="1872206">.</span><span class="ident" id="1872207">ToLower</span><span class="op" id="1872214">(</span><span class="ident" id="1872215">r</span><span class="op" id="1872216">)</span>&nbsp;<span class="op" id="1872218">}</span><span class="op" id="1872219">,</span>&nbsp;<span class="ident" id="1872221">s</span><span class="op" id="1872222">)</span><br>
<span class="lineno"></span><span class="op" id="1872224">}</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span><span class="comment" id="1872227">//&nbsp;ToTitleSpecial&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their</span><br>
<span class="lineno"></span><span class="comment" id="1872321">//&nbsp;title&nbsp;case,&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;casing&nbsp;rules.</span><br>
<span class="lineno"></span><span class="keyword" id="1872381">func</span>&nbsp;<span class="ident" id="1872386">ToTitleSpecial</span><span class="op" id="1872400">(</span><span class="ident" id="1872401">_case</span>&nbsp;<span class="ident" id="1872407">unicode</span><span class="op" id="1872414">.</span><span class="ident" id="1872415">SpecialCase</span><span class="op" id="1872426">,</span>&nbsp;<span class="ident" id="1872428">s</span>&nbsp;<span class="op" id="1872430">[</span><span class="op" id="1872431">]</span><span class="builtintype" id="1872432">byte</span><span class="op" id="1872436">)</span>&nbsp;<span class="op" id="1872438">[</span><span class="op" id="1872439">]</span><span class="builtintype" id="1872440">byte</span>&nbsp;<span class="op" id="1872445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1872448">return</span>&nbsp;<span class="ident" id="1872455">Map</span><span class="op" id="1872458">(</span><span class="keyword" id="1872459">func</span><span class="op" id="1872463">(</span><span class="ident" id="1872464">r</span>&nbsp;<span class="builtintype" id="1872466">rune</span><span class="op" id="1872470">)</span>&nbsp;<span class="builtintype" id="1872472">rune</span>&nbsp;<span class="op" id="1872477">{</span>&nbsp;<span class="keyword" id="1872479">return</span>&nbsp;<span class="ident" id="1872486">_case</span><span class="op" id="1872491">.</span><span class="ident" id="1872492">ToTitle</span><span class="op" id="1872499">(</span><span class="ident" id="1872500">r</span><span class="op" id="1872501">)</span>&nbsp;<span class="op" id="1872503">}</span><span class="op" id="1872504">,</span>&nbsp;<span class="ident" id="1872506">s</span><span class="op" id="1872507">)</span><br>
<span class="lineno">415</span><span class="op" id="1872509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1872512">//&nbsp;isSeparator&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;could&nbsp;mark&nbsp;a&nbsp;word&nbsp;boundary.</span><br>
<span class="lineno"></span><span class="comment" id="1872580">//&nbsp;TODO:&nbsp;update&nbsp;when&nbsp;package&nbsp;unicode&nbsp;captures&nbsp;more&nbsp;of&nbsp;the&nbsp;properties.</span><br>
<span class="lineno"></span><span class="keyword" id="1872650">func</span>&nbsp;<span class="ident" id="1872655">isSeparator</span><span class="op" id="1872666">(</span><span class="ident" id="1872667">r</span>&nbsp;<span class="builtintype" id="1872669">rune</span><span class="op" id="1872673">)</span>&nbsp;<span class="builtintype" id="1872675">bool</span>&nbsp;<span class="op" id="1872680">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1872683">//&nbsp;ASCII&nbsp;alphanumerics&nbsp;and&nbsp;underscore&nbsp;are&nbsp;not&nbsp;separators</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1872741">if</span>&nbsp;<span class="ident" id="1872744">r</span>&nbsp;<span class="op" id="1872746">&lt;=</span>&nbsp;<span class="num" id="1872749">0x7F</span>&nbsp;<span class="op" id="1872754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1872758">switch</span>&nbsp;<span class="op" id="1872765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1872769">case</span>&nbsp;<span class="string" id="1872774">&#39;0&#39;</span>&nbsp;<span class="op" id="1872778">&lt;=</span>&nbsp;<span class="ident" id="1872781">r</span>&nbsp;<span class="op" id="1872783">&amp;&amp;</span>&nbsp;<span class="ident" id="1872786">r</span>&nbsp;<span class="op" id="1872788">&lt;=</span>&nbsp;<span class="string" id="1872791">&#39;9&#39;</span><span class="op" id="1872794">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1872799">return</span>&nbsp;<span class="builtintype" id="1872806">false</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1872814">case</span>&nbsp;<span class="string" id="1872819">&#39;a&#39;</span>&nbsp;<span class="op" id="1872823">&lt;=</span>&nbsp;<span class="ident" id="1872826">r</span>&nbsp;<span class="op" id="1872828">&amp;&amp;</span>&nbsp;<span class="ident" id="1872831">r</span>&nbsp;<span class="op" id="1872833">&lt;=</span>&nbsp;<span class="string" id="1872836">&#39;z&#39;</span><span class="op" id="1872839">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1872844">return</span>&nbsp;<span class="builtintype" id="1872851">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1872859">case</span>&nbsp;<span class="string" id="1872864">&#39;A&#39;</span>&nbsp;<span class="op" id="1872868">&lt;=</span>&nbsp;<span class="ident" id="1872871">r</span>&nbsp;<span class="op" id="1872873">&amp;&amp;</span>&nbsp;<span class="ident" id="1872876">r</span>&nbsp;<span class="op" id="1872878">&lt;=</span>&nbsp;<span class="string" id="1872881">&#39;Z&#39;</span><span class="op" id="1872884">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1872889">return</span>&nbsp;<span class="builtintype" id="1872896">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1872904">case</span>&nbsp;<span class="ident" id="1872909">r</span>&nbsp;<span class="op" id="1872911">==</span>&nbsp;<span class="string" id="1872914">&#39;_&#39;</span><span class="op" id="1872917">:</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1872922">return</span>&nbsp;<span class="builtintype" id="1872929">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1872937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1872941">return</span>&nbsp;<span class="builtintype" id="1872948">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1872954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1872957">//&nbsp;Letters&nbsp;and&nbsp;digits&nbsp;are&nbsp;not&nbsp;separators</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1872999">if</span>&nbsp;<span class="ident" id="1873002">unicode</span><span class="op" id="1873009">.</span><span class="ident" id="1873010">IsLetter</span><span class="op" id="1873018">(</span><span class="ident" id="1873019">r</span><span class="op" id="1873020">)</span>&nbsp;<span class="op" id="1873022">||</span>&nbsp;<span class="ident" id="1873025">unicode</span><span class="op" id="1873032">.</span><span class="ident" id="1873033">IsDigit</span><span class="op" id="1873040">(</span><span class="ident" id="1873041">r</span><span class="op" id="1873042">)</span>&nbsp;<span class="op" id="1873044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1873048">return</span>&nbsp;<span class="builtintype" id="1873055">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1873062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1873065">//&nbsp;Otherwise,&nbsp;all&nbsp;we&nbsp;can&nbsp;do&nbsp;for&nbsp;now&nbsp;is&nbsp;treat&nbsp;spaces&nbsp;as&nbsp;separators.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1873133">return</span>&nbsp;<span class="ident" id="1873140">unicode</span><span class="op" id="1873147">.</span><span class="ident" id="1873148">IsSpace</span><span class="op" id="1873155">(</span><span class="ident" id="1873156">r</span><span class="op" id="1873157">)</span><br>
<span class="lineno">440</span><span class="op" id="1873159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1873162">//&nbsp;Title&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;that&nbsp;begin&nbsp;words</span><br>
<span class="lineno"></span><span class="comment" id="1873233">//&nbsp;mapped&nbsp;to&nbsp;their&nbsp;title&nbsp;case.</span><br>
<span class="lineno"></span><span class="comment" id="1873264">//</span><br>
<span class="lineno">445</span><span class="comment" id="1873267">//&nbsp;BUG:&nbsp;The&nbsp;rule&nbsp;Title&nbsp;uses&nbsp;for&nbsp;word&nbsp;boundaries&nbsp;does&nbsp;not&nbsp;handle&nbsp;Unicode&nbsp;punctuation&nbsp;properly.</span><br>
<span class="lineno"></span><span class="keyword" id="1873361">func</span>&nbsp;<span class="ident" id="1873366">Title</span><span class="op" id="1873371">(</span><span class="ident" id="1873372">s</span>&nbsp;<span class="op" id="1873374">[</span><span class="op" id="1873375">]</span><span class="builtintype" id="1873376">byte</span><span class="op" id="1873380">)</span>&nbsp;<span class="op" id="1873382">[</span><span class="op" id="1873383">]</span><span class="builtintype" id="1873384">byte</span>&nbsp;<span class="op" id="1873389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1873392">//&nbsp;Use&nbsp;a&nbsp;closure&nbsp;here&nbsp;to&nbsp;remember&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1873434">//&nbsp;Hackish&nbsp;but&nbsp;effective.&nbsp;Depends&nbsp;on&nbsp;Map&nbsp;scanning&nbsp;in&nbsp;order&nbsp;and&nbsp;calling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1873506">//&nbsp;the&nbsp;closure&nbsp;once&nbsp;per&nbsp;rune.</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1873537">prev</span>&nbsp;<span class="op" id="1873542">:=</span>&nbsp;<span class="string" id="1873545">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1873550">return</span>&nbsp;<span class="ident" id="1873557">Map</span><span class="op" id="1873560">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1873564">func</span><span class="op" id="1873568">(</span><span class="ident" id="1873569">r</span>&nbsp;<span class="builtintype" id="1873571">rune</span><span class="op" id="1873575">)</span>&nbsp;<span class="builtintype" id="1873577">rune</span>&nbsp;<span class="op" id="1873582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1873587">if</span>&nbsp;<span class="ident" id="1873590">isSeparator</span><span class="op" id="1873601">(</span><span class="ident" id="1873602">prev</span><span class="op" id="1873606">)</span>&nbsp;<span class="op" id="1873608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1873614">prev</span>&nbsp;<span class="op" id="1873619">=</span>&nbsp;<span class="ident" id="1873621">r</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1873627">return</span>&nbsp;<span class="ident" id="1873634">unicode</span><span class="op" id="1873641">.</span><span class="ident" id="1873642">ToTitle</span><span class="op" id="1873649">(</span><span class="ident" id="1873650">r</span><span class="op" id="1873651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1873656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1873661">prev</span>&nbsp;<span class="op" id="1873666">=</span>&nbsp;<span class="ident" id="1873668">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1873673">return</span>&nbsp;<span class="ident" id="1873680">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1873684">}</span><span class="op" id="1873685">,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1873689">s</span><span class="op" id="1873690">)</span><br>
<span class="lineno"></span><span class="op" id="1873692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1873695">//&nbsp;TrimLeftFunc&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;UTF-8-encoded</span><br>
<span class="lineno"></span><span class="comment" id="1873776">//&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;that&nbsp;satisfy&nbsp;f(c).</span><br>
<span class="lineno">465</span><span class="keyword" id="1873820">func</span>&nbsp;<span class="ident" id="1873825">TrimLeftFunc</span><span class="op" id="1873837">(</span><span class="ident" id="1873838">s</span>&nbsp;<span class="op" id="1873840">[</span><span class="op" id="1873841">]</span><span class="builtintype" id="1873842">byte</span><span class="op" id="1873846">,</span>&nbsp;<span class="ident" id="1873848">f</span>&nbsp;<span class="keyword" id="1873850">func</span><span class="op" id="1873854">(</span><span class="ident" id="1873855">r</span>&nbsp;<span class="builtintype" id="1873857">rune</span><span class="op" id="1873861">)</span>&nbsp;<span class="builtintype" id="1873863">bool</span><span class="op" id="1873867">)</span>&nbsp;<span class="op" id="1873869">[</span><span class="op" id="1873870">]</span><span class="builtintype" id="1873871">byte</span>&nbsp;<span class="op" id="1873876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1873879">i</span>&nbsp;<span class="op" id="1873881">:=</span>&nbsp;<span class="ident" id="1873884">indexFunc</span><span class="op" id="1873893">(</span><span class="ident" id="1873894">s</span><span class="op" id="1873895">,</span>&nbsp;<span class="ident" id="1873897">f</span><span class="op" id="1873898">,</span>&nbsp;<span class="builtintype" id="1873900">false</span><span class="op" id="1873905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1873908">if</span>&nbsp;<span class="ident" id="1873911">i</span>&nbsp;<span class="op" id="1873913">==</span>&nbsp;<span class="op" id="1873916">-</span><span class="num" id="1873917">1</span>&nbsp;<span class="op" id="1873919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1873923">return</span>&nbsp;<span class="builtintype" id="1873930">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1873935">}</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1873938">return</span>&nbsp;<span class="ident" id="1873945">s</span><span class="op" id="1873946">[</span><span class="ident" id="1873947">i</span><span class="op" id="1873948">:</span><span class="op" id="1873949">]</span><br>
<span class="lineno"></span><span class="op" id="1873951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1873954">//&nbsp;TrimRightFunc&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;trailing&nbsp;UTF-8</span><br>
<span class="lineno"></span><span class="comment" id="1874029">//&nbsp;encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;that&nbsp;satisfy&nbsp;f(c).</span><br>
<span class="lineno">475</span><span class="keyword" id="1874081">func</span>&nbsp;<span class="ident" id="1874086">TrimRightFunc</span><span class="op" id="1874099">(</span><span class="ident" id="1874100">s</span>&nbsp;<span class="op" id="1874102">[</span><span class="op" id="1874103">]</span><span class="builtintype" id="1874104">byte</span><span class="op" id="1874108">,</span>&nbsp;<span class="ident" id="1874110">f</span>&nbsp;<span class="keyword" id="1874112">func</span><span class="op" id="1874116">(</span><span class="ident" id="1874117">r</span>&nbsp;<span class="builtintype" id="1874119">rune</span><span class="op" id="1874123">)</span>&nbsp;<span class="builtintype" id="1874125">bool</span><span class="op" id="1874129">)</span>&nbsp;<span class="op" id="1874131">[</span><span class="op" id="1874132">]</span><span class="builtintype" id="1874133">byte</span>&nbsp;<span class="op" id="1874138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1874141">i</span>&nbsp;<span class="op" id="1874143">:=</span>&nbsp;<span class="ident" id="1874146">lastIndexFunc</span><span class="op" id="1874159">(</span><span class="ident" id="1874160">s</span><span class="op" id="1874161">,</span>&nbsp;<span class="ident" id="1874163">f</span><span class="op" id="1874164">,</span>&nbsp;<span class="builtintype" id="1874166">false</span><span class="op" id="1874171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1874174">if</span>&nbsp;<span class="ident" id="1874177">i</span>&nbsp;<span class="op" id="1874179">&gt;=</span>&nbsp;<span class="num" id="1874182">0</span>&nbsp;<span class="op" id="1874184">&amp;&amp;</span>&nbsp;<span class="ident" id="1874187">s</span><span class="op" id="1874188">[</span><span class="ident" id="1874189">i</span><span class="op" id="1874190">]</span>&nbsp;<span class="op" id="1874192">&gt;=</span>&nbsp;<span class="ident" id="1874195">utf8</span><span class="op" id="1874199">.</span><span class="ident" id="1874200">RuneSelf</span>&nbsp;<span class="op" id="1874209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1874213">_</span><span class="op" id="1874214">,</span>&nbsp;<span class="ident" id="1874216">wid</span>&nbsp;<span class="op" id="1874220">:=</span>&nbsp;<span class="ident" id="1874223">utf8</span><span class="op" id="1874227">.</span><span class="ident" id="1874228">DecodeRune</span><span class="op" id="1874238">(</span><span class="ident" id="1874239">s</span><span class="op" id="1874240">[</span><span class="ident" id="1874241">i</span><span class="op" id="1874242">:</span><span class="op" id="1874243">]</span><span class="op" id="1874244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1874248">i</span>&nbsp;<span class="op" id="1874250">+=</span>&nbsp;<span class="ident" id="1874253">wid</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1874258">}</span>&nbsp;<span class="keyword" id="1874260">else</span>&nbsp;<span class="op" id="1874265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1874269">i</span><span class="op" id="1874270">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1874274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1874277">return</span>&nbsp;<span class="ident" id="1874284">s</span><span class="op" id="1874285">[</span><span class="num" id="1874286">0</span><span class="op" id="1874287">:</span><span class="ident" id="1874288">i</span><span class="op" id="1874289">]</span><br>
<span class="lineno"></span><span class="op" id="1874291">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span><span class="comment" id="1874294">//&nbsp;TrimFunc&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;and&nbsp;trailing</span><br>
<span class="lineno"></span><span class="comment" id="1874370">//&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;that&nbsp;satisfy&nbsp;f(c).</span><br>
<span class="lineno"></span><span class="keyword" id="1874428">func</span>&nbsp;<span class="ident" id="1874433">TrimFunc</span><span class="op" id="1874441">(</span><span class="ident" id="1874442">s</span>&nbsp;<span class="op" id="1874444">[</span><span class="op" id="1874445">]</span><span class="builtintype" id="1874446">byte</span><span class="op" id="1874450">,</span>&nbsp;<span class="ident" id="1874452">f</span>&nbsp;<span class="keyword" id="1874454">func</span><span class="op" id="1874458">(</span><span class="ident" id="1874459">r</span>&nbsp;<span class="builtintype" id="1874461">rune</span><span class="op" id="1874465">)</span>&nbsp;<span class="builtintype" id="1874467">bool</span><span class="op" id="1874471">)</span>&nbsp;<span class="op" id="1874473">[</span><span class="op" id="1874474">]</span><span class="builtintype" id="1874475">byte</span>&nbsp;<span class="op" id="1874480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1874483">return</span>&nbsp;<span class="ident" id="1874490">TrimRightFunc</span><span class="op" id="1874503">(</span><span class="ident" id="1874504">TrimLeftFunc</span><span class="op" id="1874516">(</span><span class="ident" id="1874517">s</span><span class="op" id="1874518">,</span>&nbsp;<span class="ident" id="1874520">f</span><span class="op" id="1874521">)</span><span class="op" id="1874522">,</span>&nbsp;<span class="ident" id="1874524">f</span><span class="op" id="1874525">)</span><br>
<span class="lineno">490</span><span class="op" id="1874527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1874530">//&nbsp;TrimPrefix&nbsp;returns&nbsp;s&nbsp;without&nbsp;the&nbsp;provided&nbsp;leading&nbsp;prefix&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="1874598">//&nbsp;If&nbsp;s&nbsp;doesn&#39;t&nbsp;start&nbsp;with&nbsp;prefix,&nbsp;s&nbsp;is&nbsp;returned&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="keyword" id="1874658">func</span>&nbsp;<span class="ident" id="1874663">TrimPrefix</span><span class="op" id="1874673">(</span><span class="ident" id="1874674">s</span><span class="op" id="1874675">,</span>&nbsp;<span class="ident" id="1874677">prefix</span>&nbsp;<span class="op" id="1874684">[</span><span class="op" id="1874685">]</span><span class="builtintype" id="1874686">byte</span><span class="op" id="1874690">)</span>&nbsp;<span class="op" id="1874692">[</span><span class="op" id="1874693">]</span><span class="builtintype" id="1874694">byte</span>&nbsp;<span class="op" id="1874699">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1874702">if</span>&nbsp;<span class="ident" id="1874705">HasPrefix</span><span class="op" id="1874714">(</span><span class="ident" id="1874715">s</span><span class="op" id="1874716">,</span>&nbsp;<span class="ident" id="1874718">prefix</span><span class="op" id="1874724">)</span>&nbsp;<span class="op" id="1874726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1874730">return</span>&nbsp;<span class="ident" id="1874737">s</span><span class="op" id="1874738">[</span><span class="builtinfunc" id="1874739">len</span><span class="op" id="1874742">(</span><span class="ident" id="1874743">prefix</span><span class="op" id="1874749">)</span><span class="op" id="1874750">:</span><span class="op" id="1874751">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1874754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1874757">return</span>&nbsp;<span class="ident" id="1874764">s</span><br>
<span class="lineno"></span><span class="op" id="1874766">}</span><br>
<span class="lineno">500</span><br>
<span class="lineno"></span><span class="comment" id="1874769">//&nbsp;TrimSuffix&nbsp;returns&nbsp;s&nbsp;without&nbsp;the&nbsp;provided&nbsp;trailing&nbsp;suffix&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="1874838">//&nbsp;If&nbsp;s&nbsp;doesn&#39;t&nbsp;end&nbsp;with&nbsp;suffix,&nbsp;s&nbsp;is&nbsp;returned&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="keyword" id="1874896">func</span>&nbsp;<span class="ident" id="1874901">TrimSuffix</span><span class="op" id="1874911">(</span><span class="ident" id="1874912">s</span><span class="op" id="1874913">,</span>&nbsp;<span class="ident" id="1874915">suffix</span>&nbsp;<span class="op" id="1874922">[</span><span class="op" id="1874923">]</span><span class="builtintype" id="1874924">byte</span><span class="op" id="1874928">)</span>&nbsp;<span class="op" id="1874930">[</span><span class="op" id="1874931">]</span><span class="builtintype" id="1874932">byte</span>&nbsp;<span class="op" id="1874937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1874940">if</span>&nbsp;<span class="ident" id="1874943">HasSuffix</span><span class="op" id="1874952">(</span><span class="ident" id="1874953">s</span><span class="op" id="1874954">,</span>&nbsp;<span class="ident" id="1874956">suffix</span><span class="op" id="1874962">)</span>&nbsp;<span class="op" id="1874964">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1874968">return</span>&nbsp;<span class="ident" id="1874975">s</span><span class="op" id="1874976">[</span><span class="op" id="1874977">:</span><span class="builtinfunc" id="1874978">len</span><span class="op" id="1874981">(</span><span class="ident" id="1874982">s</span><span class="op" id="1874983">)</span><span class="op" id="1874984">-</span><span class="builtinfunc" id="1874985">len</span><span class="op" id="1874988">(</span><span class="ident" id="1874989">suffix</span><span class="op" id="1874995">)</span><span class="op" id="1874996">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1874999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1875002">return</span>&nbsp;<span class="ident" id="1875009">s</span><br>
<span class="lineno"></span><span class="op" id="1875011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span><span class="comment" id="1875014">//&nbsp;IndexFunc&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="1875092">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;first&nbsp;Unicode</span><br>
<span class="lineno"></span><span class="comment" id="1875147">//&nbsp;code&nbsp;point&nbsp;satisfying&nbsp;f(c),&nbsp;or&nbsp;-1&nbsp;if&nbsp;none&nbsp;do.</span><br>
<span class="lineno"></span><span class="keyword" id="1875196">func</span>&nbsp;<span class="ident" id="1875201">IndexFunc</span><span class="op" id="1875210">(</span><span class="ident" id="1875211">s</span>&nbsp;<span class="op" id="1875213">[</span><span class="op" id="1875214">]</span><span class="builtintype" id="1875215">byte</span><span class="op" id="1875219">,</span>&nbsp;<span class="ident" id="1875221">f</span>&nbsp;<span class="keyword" id="1875223">func</span><span class="op" id="1875227">(</span><span class="ident" id="1875228">r</span>&nbsp;<span class="builtintype" id="1875230">rune</span><span class="op" id="1875234">)</span>&nbsp;<span class="builtintype" id="1875236">bool</span><span class="op" id="1875240">)</span>&nbsp;<span class="builtintype" id="1875242">int</span>&nbsp;<span class="op" id="1875246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1875249">return</span>&nbsp;<span class="ident" id="1875256">indexFunc</span><span class="op" id="1875265">(</span><span class="ident" id="1875266">s</span><span class="op" id="1875267">,</span>&nbsp;<span class="ident" id="1875269">f</span><span class="op" id="1875270">,</span>&nbsp;<span class="builtintype" id="1875272">true</span><span class="op" id="1875276">)</span><br>
<span class="lineno">515</span><span class="op" id="1875278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1875281">//&nbsp;LastIndexFunc&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="1875363">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;last&nbsp;Unicode</span><br>
<span class="lineno"></span><span class="comment" id="1875417">//&nbsp;code&nbsp;point&nbsp;satisfying&nbsp;f(c),&nbsp;or&nbsp;-1&nbsp;if&nbsp;none&nbsp;do.</span><br>
<span class="lineno">520</span><span class="keyword" id="1875466">func</span>&nbsp;<span class="ident" id="1875471">LastIndexFunc</span><span class="op" id="1875484">(</span><span class="ident" id="1875485">s</span>&nbsp;<span class="op" id="1875487">[</span><span class="op" id="1875488">]</span><span class="builtintype" id="1875489">byte</span><span class="op" id="1875493">,</span>&nbsp;<span class="ident" id="1875495">f</span>&nbsp;<span class="keyword" id="1875497">func</span><span class="op" id="1875501">(</span><span class="ident" id="1875502">r</span>&nbsp;<span class="builtintype" id="1875504">rune</span><span class="op" id="1875508">)</span>&nbsp;<span class="builtintype" id="1875510">bool</span><span class="op" id="1875514">)</span>&nbsp;<span class="builtintype" id="1875516">int</span>&nbsp;<span class="op" id="1875520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1875523">return</span>&nbsp;<span class="ident" id="1875530">lastIndexFunc</span><span class="op" id="1875543">(</span><span class="ident" id="1875544">s</span><span class="op" id="1875545">,</span>&nbsp;<span class="ident" id="1875547">f</span><span class="op" id="1875548">,</span>&nbsp;<span class="builtintype" id="1875550">true</span><span class="op" id="1875554">)</span><br>
<span class="lineno"></span><span class="op" id="1875556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1875559">//&nbsp;indexFunc&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;IndexFunc&nbsp;except&nbsp;that&nbsp;if</span><br>
<span class="lineno">525</span><span class="comment" id="1875612">//&nbsp;truth==false,&nbsp;the&nbsp;sense&nbsp;of&nbsp;the&nbsp;predicate&nbsp;function&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1875668">//&nbsp;inverted.</span><br>
<span class="lineno"></span><span class="keyword" id="1875681">func</span>&nbsp;<span class="ident" id="1875686">indexFunc</span><span class="op" id="1875695">(</span><span class="ident" id="1875696">s</span>&nbsp;<span class="op" id="1875698">[</span><span class="op" id="1875699">]</span><span class="builtintype" id="1875700">byte</span><span class="op" id="1875704">,</span>&nbsp;<span class="ident" id="1875706">f</span>&nbsp;<span class="keyword" id="1875708">func</span><span class="op" id="1875712">(</span><span class="ident" id="1875713">r</span>&nbsp;<span class="builtintype" id="1875715">rune</span><span class="op" id="1875719">)</span>&nbsp;<span class="builtintype" id="1875721">bool</span><span class="op" id="1875725">,</span>&nbsp;<span class="ident" id="1875727">truth</span>&nbsp;<span class="builtintype" id="1875733">bool</span><span class="op" id="1875737">)</span>&nbsp;<span class="builtintype" id="1875739">int</span>&nbsp;<span class="op" id="1875743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1875746">start</span>&nbsp;<span class="op" id="1875752">:=</span>&nbsp;<span class="num" id="1875755">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1875758">for</span>&nbsp;<span class="ident" id="1875762">start</span>&nbsp;<span class="op" id="1875768">&lt;</span>&nbsp;<span class="builtinfunc" id="1875770">len</span><span class="op" id="1875773">(</span><span class="ident" id="1875774">s</span><span class="op" id="1875775">)</span>&nbsp;<span class="op" id="1875777">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1875781">wid</span>&nbsp;<span class="op" id="1875785">:=</span>&nbsp;<span class="num" id="1875788">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1875792">r</span>&nbsp;<span class="op" id="1875794">:=</span>&nbsp;<span class="builtintype" id="1875797">rune</span><span class="op" id="1875801">(</span><span class="ident" id="1875802">s</span><span class="op" id="1875803">[</span><span class="ident" id="1875804">start</span><span class="op" id="1875809">]</span><span class="op" id="1875810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1875814">if</span>&nbsp;<span class="ident" id="1875817">r</span>&nbsp;<span class="op" id="1875819">&gt;=</span>&nbsp;<span class="ident" id="1875822">utf8</span><span class="op" id="1875826">.</span><span class="ident" id="1875827">RuneSelf</span>&nbsp;<span class="op" id="1875836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1875841">r</span><span class="op" id="1875842">,</span>&nbsp;<span class="ident" id="1875844">wid</span>&nbsp;<span class="op" id="1875848">=</span>&nbsp;<span class="ident" id="1875850">utf8</span><span class="op" id="1875854">.</span><span class="ident" id="1875855">DecodeRune</span><span class="op" id="1875865">(</span><span class="ident" id="1875866">s</span><span class="op" id="1875867">[</span><span class="ident" id="1875868">start</span><span class="op" id="1875873">:</span><span class="op" id="1875874">]</span><span class="op" id="1875875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1875879">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1875883">if</span>&nbsp;<span class="ident" id="1875886">f</span><span class="op" id="1875887">(</span><span class="ident" id="1875888">r</span><span class="op" id="1875889">)</span>&nbsp;<span class="op" id="1875891">==</span>&nbsp;<span class="ident" id="1875894">truth</span>&nbsp;<span class="op" id="1875900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1875905">return</span>&nbsp;<span class="ident" id="1875912">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1875920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1875924">start</span>&nbsp;<span class="op" id="1875930">+=</span>&nbsp;<span class="ident" id="1875933">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1875938">}</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1875941">return</span>&nbsp;<span class="op" id="1875948">-</span><span class="num" id="1875949">1</span><br>
<span class="lineno"></span><span class="op" id="1875951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1875954">//&nbsp;lastIndexFunc&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;LastIndexFunc&nbsp;except&nbsp;that&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="1876015">//&nbsp;truth==false,&nbsp;the&nbsp;sense&nbsp;of&nbsp;the&nbsp;predicate&nbsp;function&nbsp;is</span><br>
<span class="lineno">545</span><span class="comment" id="1876071">//&nbsp;inverted.</span><br>
<span class="lineno"></span><span class="keyword" id="1876084">func</span>&nbsp;<span class="ident" id="1876089">lastIndexFunc</span><span class="op" id="1876102">(</span><span class="ident" id="1876103">s</span>&nbsp;<span class="op" id="1876105">[</span><span class="op" id="1876106">]</span><span class="builtintype" id="1876107">byte</span><span class="op" id="1876111">,</span>&nbsp;<span class="ident" id="1876113">f</span>&nbsp;<span class="keyword" id="1876115">func</span><span class="op" id="1876119">(</span><span class="ident" id="1876120">r</span>&nbsp;<span class="builtintype" id="1876122">rune</span><span class="op" id="1876126">)</span>&nbsp;<span class="builtintype" id="1876128">bool</span><span class="op" id="1876132">,</span>&nbsp;<span class="ident" id="1876134">truth</span>&nbsp;<span class="builtintype" id="1876140">bool</span><span class="op" id="1876144">)</span>&nbsp;<span class="builtintype" id="1876146">int</span>&nbsp;<span class="op" id="1876150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1876153">for</span>&nbsp;<span class="ident" id="1876157">i</span>&nbsp;<span class="op" id="1876159">:=</span>&nbsp;<span class="builtinfunc" id="1876162">len</span><span class="op" id="1876165">(</span><span class="ident" id="1876166">s</span><span class="op" id="1876167">)</span><span class="op" id="1876168">;</span>&nbsp;<span class="ident" id="1876170">i</span>&nbsp;<span class="op" id="1876172">&gt;</span>&nbsp;<span class="num" id="1876174">0</span><span class="op" id="1876175">;</span>&nbsp;<span class="op" id="1876177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1876181">r</span><span class="op" id="1876182">,</span>&nbsp;<span class="ident" id="1876184">size</span>&nbsp;<span class="op" id="1876189">:=</span>&nbsp;<span class="builtintype" id="1876192">rune</span><span class="op" id="1876196">(</span><span class="ident" id="1876197">s</span><span class="op" id="1876198">[</span><span class="ident" id="1876199">i</span><span class="op" id="1876200">-</span><span class="num" id="1876201">1</span><span class="op" id="1876202">]</span><span class="op" id="1876203">)</span><span class="op" id="1876204">,</span>&nbsp;<span class="num" id="1876206">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1876210">if</span>&nbsp;<span class="ident" id="1876213">r</span>&nbsp;<span class="op" id="1876215">&gt;=</span>&nbsp;<span class="ident" id="1876218">utf8</span><span class="op" id="1876222">.</span><span class="ident" id="1876223">RuneSelf</span>&nbsp;<span class="op" id="1876232">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1876237">r</span><span class="op" id="1876238">,</span>&nbsp;<span class="ident" id="1876240">size</span>&nbsp;<span class="op" id="1876245">=</span>&nbsp;<span class="ident" id="1876247">utf8</span><span class="op" id="1876251">.</span><span class="ident" id="1876252">DecodeLastRune</span><span class="op" id="1876266">(</span><span class="ident" id="1876267">s</span><span class="op" id="1876268">[</span><span class="num" id="1876269">0</span><span class="op" id="1876270">:</span><span class="ident" id="1876271">i</span><span class="op" id="1876272">]</span><span class="op" id="1876273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1876277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1876281">i</span>&nbsp;<span class="op" id="1876283">-=</span>&nbsp;<span class="ident" id="1876286">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1876293">if</span>&nbsp;<span class="ident" id="1876296">f</span><span class="op" id="1876297">(</span><span class="ident" id="1876298">r</span><span class="op" id="1876299">)</span>&nbsp;<span class="op" id="1876301">==</span>&nbsp;<span class="ident" id="1876304">truth</span>&nbsp;<span class="op" id="1876310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1876315">return</span>&nbsp;<span class="ident" id="1876322">i</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1876326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1876329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1876332">return</span>&nbsp;<span class="op" id="1876339">-</span><span class="num" id="1876340">1</span><br>
<span class="lineno"></span><span class="op" id="1876342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span><span class="keyword" id="1876345">func</span>&nbsp;<span class="ident" id="1876350">makeCutsetFunc</span><span class="op" id="1876364">(</span><span class="ident" id="1876365">cutset</span>&nbsp;<span class="builtintype" id="1876372">string</span><span class="op" id="1876378">)</span>&nbsp;<span class="keyword" id="1876380">func</span><span class="op" id="1876384">(</span><span class="ident" id="1876385">r</span>&nbsp;<span class="builtintype" id="1876387">rune</span><span class="op" id="1876391">)</span>&nbsp;<span class="builtintype" id="1876393">bool</span>&nbsp;<span class="op" id="1876398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1876401">return</span>&nbsp;<span class="keyword" id="1876408">func</span><span class="op" id="1876412">(</span><span class="ident" id="1876413">r</span>&nbsp;<span class="builtintype" id="1876415">rune</span><span class="op" id="1876419">)</span>&nbsp;<span class="builtintype" id="1876421">bool</span>&nbsp;<span class="op" id="1876426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1876430">for</span>&nbsp;<span class="ident" id="1876434">_</span><span class="op" id="1876435">,</span>&nbsp;<span class="ident" id="1876437">c</span>&nbsp;<span class="op" id="1876439">:=</span>&nbsp;<span class="keyword" id="1876442">range</span>&nbsp;<span class="ident" id="1876448">cutset</span>&nbsp;<span class="op" id="1876455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1876460">if</span>&nbsp;<span class="ident" id="1876463">c</span>&nbsp;<span class="op" id="1876465">==</span>&nbsp;<span class="ident" id="1876468">r</span>&nbsp;<span class="op" id="1876470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1876476">return</span>&nbsp;<span class="builtintype" id="1876483">true</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1876491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1876495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1876499">return</span>&nbsp;<span class="builtintype" id="1876506">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1876513">}</span><br>
<span class="lineno"></span><span class="op" id="1876515">}</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span><span class="comment" id="1876518">//&nbsp;Trim&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1876581">//&nbsp;trailing&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;contained&nbsp;in&nbsp;cutset.</span><br>
<span class="lineno"></span><span class="keyword" id="1876648">func</span>&nbsp;<span class="ident" id="1876653">Trim</span><span class="op" id="1876657">(</span><span class="ident" id="1876658">s</span>&nbsp;<span class="op" id="1876660">[</span><span class="op" id="1876661">]</span><span class="builtintype" id="1876662">byte</span><span class="op" id="1876666">,</span>&nbsp;<span class="ident" id="1876668">cutset</span>&nbsp;<span class="builtintype" id="1876675">string</span><span class="op" id="1876681">)</span>&nbsp;<span class="op" id="1876683">[</span><span class="op" id="1876684">]</span><span class="builtintype" id="1876685">byte</span>&nbsp;<span class="op" id="1876690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1876693">return</span>&nbsp;<span class="ident" id="1876700">TrimFunc</span><span class="op" id="1876708">(</span><span class="ident" id="1876709">s</span><span class="op" id="1876710">,</span>&nbsp;<span class="ident" id="1876712">makeCutsetFunc</span><span class="op" id="1876726">(</span><span class="ident" id="1876727">cutset</span><span class="op" id="1876733">)</span><span class="op" id="1876734">)</span><br>
<span class="lineno">575</span><span class="op" id="1876736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1876739">//&nbsp;TrimLeft&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading</span><br>
<span class="lineno"></span><span class="comment" id="1876802">//&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;contained&nbsp;in&nbsp;cutset.</span><br>
<span class="lineno"></span><span class="keyword" id="1876860">func</span>&nbsp;<span class="ident" id="1876865">TrimLeft</span><span class="op" id="1876873">(</span><span class="ident" id="1876874">s</span>&nbsp;<span class="op" id="1876876">[</span><span class="op" id="1876877">]</span><span class="builtintype" id="1876878">byte</span><span class="op" id="1876882">,</span>&nbsp;<span class="ident" id="1876884">cutset</span>&nbsp;<span class="builtintype" id="1876891">string</span><span class="op" id="1876897">)</span>&nbsp;<span class="op" id="1876899">[</span><span class="op" id="1876900">]</span><span class="builtintype" id="1876901">byte</span>&nbsp;<span class="op" id="1876906">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1876909">return</span>&nbsp;<span class="ident" id="1876916">TrimLeftFunc</span><span class="op" id="1876928">(</span><span class="ident" id="1876929">s</span><span class="op" id="1876930">,</span>&nbsp;<span class="ident" id="1876932">makeCutsetFunc</span><span class="op" id="1876946">(</span><span class="ident" id="1876947">cutset</span><span class="op" id="1876953">)</span><span class="op" id="1876954">)</span><br>
<span class="lineno"></span><span class="op" id="1876956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1876959">//&nbsp;TrimRight&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;trailing</span><br>
<span class="lineno"></span><span class="comment" id="1877024">//&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;that&nbsp;are&nbsp;contained&nbsp;in&nbsp;cutset.</span><br>
<span class="lineno">585</span><span class="keyword" id="1877091">func</span>&nbsp;<span class="ident" id="1877096">TrimRight</span><span class="op" id="1877105">(</span><span class="ident" id="1877106">s</span>&nbsp;<span class="op" id="1877108">[</span><span class="op" id="1877109">]</span><span class="builtintype" id="1877110">byte</span><span class="op" id="1877114">,</span>&nbsp;<span class="ident" id="1877116">cutset</span>&nbsp;<span class="builtintype" id="1877123">string</span><span class="op" id="1877129">)</span>&nbsp;<span class="op" id="1877131">[</span><span class="op" id="1877132">]</span><span class="builtintype" id="1877133">byte</span>&nbsp;<span class="op" id="1877138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1877141">return</span>&nbsp;<span class="ident" id="1877148">TrimRightFunc</span><span class="op" id="1877161">(</span><span class="ident" id="1877162">s</span><span class="op" id="1877163">,</span>&nbsp;<span class="ident" id="1877165">makeCutsetFunc</span><span class="op" id="1877179">(</span><span class="ident" id="1877180">cutset</span><span class="op" id="1877186">)</span><span class="op" id="1877187">)</span><br>
<span class="lineno"></span><span class="op" id="1877189">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1877192">//&nbsp;TrimSpace&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;and</span><br>
<span class="lineno">590</span><span class="comment" id="1877260">//&nbsp;trailing&nbsp;white&nbsp;space,&nbsp;as&nbsp;defined&nbsp;by&nbsp;Unicode.</span><br>
<span class="lineno"></span><span class="keyword" id="1877308">func</span>&nbsp;<span class="ident" id="1877313">TrimSpace</span><span class="op" id="1877322">(</span><span class="ident" id="1877323">s</span>&nbsp;<span class="op" id="1877325">[</span><span class="op" id="1877326">]</span><span class="builtintype" id="1877327">byte</span><span class="op" id="1877331">)</span>&nbsp;<span class="op" id="1877333">[</span><span class="op" id="1877334">]</span><span class="builtintype" id="1877335">byte</span>&nbsp;<span class="op" id="1877340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1877343">return</span>&nbsp;<span class="ident" id="1877350">TrimFunc</span><span class="op" id="1877358">(</span><span class="ident" id="1877359">s</span><span class="op" id="1877360">,</span>&nbsp;<span class="ident" id="1877362">unicode</span><span class="op" id="1877369">.</span><span class="ident" id="1877370">IsSpace</span><span class="op" id="1877377">)</span><br>
<span class="lineno"></span><span class="op" id="1877379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="1877382">//&nbsp;Runes&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;runes&nbsp;(Unicode&nbsp;code&nbsp;points)&nbsp;equivalent&nbsp;to&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="1877455">func</span>&nbsp;<span class="ident" id="1877460">Runes</span><span class="op" id="1877465">(</span><span class="ident" id="1877466">s</span>&nbsp;<span class="op" id="1877468">[</span><span class="op" id="1877469">]</span><span class="builtintype" id="1877470">byte</span><span class="op" id="1877474">)</span>&nbsp;<span class="op" id="1877476">[</span><span class="op" id="1877477">]</span><span class="builtintype" id="1877478">rune</span>&nbsp;<span class="op" id="1877483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1877486">t</span>&nbsp;<span class="op" id="1877488">:=</span>&nbsp;<span class="builtinfunc" id="1877491">make</span><span class="op" id="1877495">(</span><span class="op" id="1877496">[</span><span class="op" id="1877497">]</span><span class="builtintype" id="1877498">rune</span><span class="op" id="1877502">,</span>&nbsp;<span class="ident" id="1877504">utf8</span><span class="op" id="1877508">.</span><span class="ident" id="1877509">RuneCount</span><span class="op" id="1877518">(</span><span class="ident" id="1877519">s</span><span class="op" id="1877520">)</span><span class="op" id="1877521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1877524">i</span>&nbsp;<span class="op" id="1877526">:=</span>&nbsp;<span class="num" id="1877529">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1877532">for</span>&nbsp;<span class="builtinfunc" id="1877536">len</span><span class="op" id="1877539">(</span><span class="ident" id="1877540">s</span><span class="op" id="1877541">)</span>&nbsp;<span class="op" id="1877543">&gt;</span>&nbsp;<span class="num" id="1877545">0</span>&nbsp;<span class="op" id="1877547">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1877551">r</span><span class="op" id="1877552">,</span>&nbsp;<span class="ident" id="1877554">l</span>&nbsp;<span class="op" id="1877556">:=</span>&nbsp;<span class="ident" id="1877559">utf8</span><span class="op" id="1877563">.</span><span class="ident" id="1877564">DecodeRune</span><span class="op" id="1877574">(</span><span class="ident" id="1877575">s</span><span class="op" id="1877576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1877580">t</span><span class="op" id="1877581">[</span><span class="ident" id="1877582">i</span><span class="op" id="1877583">]</span>&nbsp;<span class="op" id="1877585">=</span>&nbsp;<span class="ident" id="1877587">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1877591">i</span><span class="op" id="1877592">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1877597">s</span>&nbsp;<span class="op" id="1877599">=</span>&nbsp;<span class="ident" id="1877601">s</span><span class="op" id="1877602">[</span><span class="ident" id="1877603">l</span><span class="op" id="1877604">:</span><span class="op" id="1877605">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1877608">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1877611">return</span>&nbsp;<span class="ident" id="1877618">t</span><br>
<span class="lineno"></span><span class="op" id="1877620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1877623">//&nbsp;Replace&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;slice&nbsp;s&nbsp;with&nbsp;the&nbsp;first&nbsp;n</span><br>
<span class="lineno"></span><span class="comment" id="1877681">//&nbsp;non-overlapping&nbsp;instances&nbsp;of&nbsp;old&nbsp;replaced&nbsp;by&nbsp;new.</span><br>
<span class="lineno">610</span><span class="comment" id="1877734">//&nbsp;If&nbsp;old&nbsp;is&nbsp;empty,&nbsp;it&nbsp;matches&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="1877795">//&nbsp;and&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence,&nbsp;yielding&nbsp;up&nbsp;to&nbsp;k+1&nbsp;replacements</span><br>
<span class="lineno"></span><span class="comment" id="1877861">//&nbsp;for&nbsp;a&nbsp;k-rune&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="1877884">//&nbsp;If&nbsp;n&nbsp;&lt;&nbsp;0,&nbsp;there&nbsp;is&nbsp;no&nbsp;limit&nbsp;on&nbsp;the&nbsp;number&nbsp;of&nbsp;replacements.</span><br>
<span class="lineno"></span><span class="keyword" id="1877946">func</span>&nbsp;<span class="ident" id="1877951">Replace</span><span class="op" id="1877958">(</span><span class="ident" id="1877959">s</span><span class="op" id="1877960">,</span>&nbsp;<span class="ident" id="1877962">old</span><span class="op" id="1877965">,</span>&nbsp;<span class="builtinfunc" id="1877967">new</span>&nbsp;<span class="op" id="1877971">[</span><span class="op" id="1877972">]</span><span class="builtintype" id="1877973">byte</span><span class="op" id="1877977">,</span>&nbsp;<span class="ident" id="1877979">n</span>&nbsp;<span class="builtintype" id="1877981">int</span><span class="op" id="1877984">)</span>&nbsp;<span class="op" id="1877986">[</span><span class="op" id="1877987">]</span><span class="builtintype" id="1877988">byte</span>&nbsp;<span class="op" id="1877993">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1877996">m</span>&nbsp;<span class="op" id="1877998">:=</span>&nbsp;<span class="num" id="1878001">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1878004">if</span>&nbsp;<span class="ident" id="1878007">n</span>&nbsp;<span class="op" id="1878009">!=</span>&nbsp;<span class="num" id="1878012">0</span>&nbsp;<span class="op" id="1878014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1878018">//&nbsp;Compute&nbsp;number&nbsp;of&nbsp;replacements.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1878055">m</span>&nbsp;<span class="op" id="1878057">=</span>&nbsp;<span class="ident" id="1878059">Count</span><span class="op" id="1878064">(</span><span class="ident" id="1878065">s</span><span class="op" id="1878066">,</span>&nbsp;<span class="ident" id="1878068">old</span><span class="op" id="1878071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1878074">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1878077">if</span>&nbsp;<span class="ident" id="1878080">m</span>&nbsp;<span class="op" id="1878082">==</span>&nbsp;<span class="num" id="1878085">0</span>&nbsp;<span class="op" id="1878087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1878091">//&nbsp;Just&nbsp;return&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1878116">return</span>&nbsp;<span class="builtinfunc" id="1878123">append</span><span class="op" id="1878129">(</span><span class="op" id="1878130">[</span><span class="op" id="1878131">]</span><span class="builtintype" id="1878132">byte</span><span class="op" id="1878136">(</span><span class="builtintype" id="1878137">nil</span><span class="op" id="1878140">)</span><span class="op" id="1878141">,</span>&nbsp;<span class="ident" id="1878143">s</span><span class="op" id="1878144">...</span><span class="op" id="1878147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1878150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1878153">if</span>&nbsp;<span class="ident" id="1878156">n</span>&nbsp;<span class="op" id="1878158">&lt;</span>&nbsp;<span class="num" id="1878160">0</span>&nbsp;<span class="op" id="1878162">||</span>&nbsp;<span class="ident" id="1878165">m</span>&nbsp;<span class="op" id="1878167">&lt;</span>&nbsp;<span class="ident" id="1878169">n</span>&nbsp;<span class="op" id="1878171">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1878175">n</span>&nbsp;<span class="op" id="1878177">=</span>&nbsp;<span class="ident" id="1878179">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1878182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1878186">//&nbsp;Apply&nbsp;replacements&nbsp;to&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1878220">t</span>&nbsp;<span class="op" id="1878222">:=</span>&nbsp;<span class="builtinfunc" id="1878225">make</span><span class="op" id="1878229">(</span><span class="op" id="1878230">[</span><span class="op" id="1878231">]</span><span class="builtintype" id="1878232">byte</span><span class="op" id="1878236">,</span>&nbsp;<span class="builtinfunc" id="1878238">len</span><span class="op" id="1878241">(</span><span class="ident" id="1878242">s</span><span class="op" id="1878243">)</span><span class="op" id="1878244">+</span><span class="ident" id="1878245">n</span><span class="op" id="1878246">*</span><span class="op" id="1878247">(</span><span class="builtinfunc" id="1878248">len</span><span class="op" id="1878251">(</span><span class="builtinfunc" id="1878252">new</span><span class="op" id="1878255">)</span><span class="op" id="1878256">-</span><span class="builtinfunc" id="1878257">len</span><span class="op" id="1878260">(</span><span class="ident" id="1878261">old</span><span class="op" id="1878264">)</span><span class="op" id="1878265">)</span><span class="op" id="1878266">)</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1878269">w</span>&nbsp;<span class="op" id="1878271">:=</span>&nbsp;<span class="num" id="1878274">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1878277">start</span>&nbsp;<span class="op" id="1878283">:=</span>&nbsp;<span class="num" id="1878286">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1878289">for</span>&nbsp;<span class="ident" id="1878293">i</span>&nbsp;<span class="op" id="1878295">:=</span>&nbsp;<span class="num" id="1878298">0</span><span class="op" id="1878299">;</span>&nbsp;<span class="ident" id="1878301">i</span>&nbsp;<span class="op" id="1878303">&lt;</span>&nbsp;<span class="ident" id="1878305">n</span><span class="op" id="1878306">;</span>&nbsp;<span class="ident" id="1878308">i</span><span class="op" id="1878309">++</span>&nbsp;<span class="op" id="1878312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1878316">j</span>&nbsp;<span class="op" id="1878318">:=</span>&nbsp;<span class="ident" id="1878321">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1878329">if</span>&nbsp;<span class="builtinfunc" id="1878332">len</span><span class="op" id="1878335">(</span><span class="ident" id="1878336">old</span><span class="op" id="1878339">)</span>&nbsp;<span class="op" id="1878341">==</span>&nbsp;<span class="num" id="1878344">0</span>&nbsp;<span class="op" id="1878346">{</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1878351">if</span>&nbsp;<span class="ident" id="1878354">i</span>&nbsp;<span class="op" id="1878356">&gt;</span>&nbsp;<span class="num" id="1878358">0</span>&nbsp;<span class="op" id="1878360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1878366">_</span><span class="op" id="1878367">,</span>&nbsp;<span class="ident" id="1878369">wid</span>&nbsp;<span class="op" id="1878373">:=</span>&nbsp;<span class="ident" id="1878376">utf8</span><span class="op" id="1878380">.</span><span class="ident" id="1878381">DecodeRune</span><span class="op" id="1878391">(</span><span class="ident" id="1878392">s</span><span class="op" id="1878393">[</span><span class="ident" id="1878394">start</span><span class="op" id="1878399">:</span><span class="op" id="1878400">]</span><span class="op" id="1878401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1878407">j</span>&nbsp;<span class="op" id="1878409">+=</span>&nbsp;<span class="ident" id="1878412">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1878419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1878423">}</span>&nbsp;<span class="keyword" id="1878425">else</span>&nbsp;<span class="op" id="1878430">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1878435">j</span>&nbsp;<span class="op" id="1878437">+=</span>&nbsp;<span class="ident" id="1878440">Index</span><span class="op" id="1878445">(</span><span class="ident" id="1878446">s</span><span class="op" id="1878447">[</span><span class="ident" id="1878448">start</span><span class="op" id="1878453">:</span><span class="op" id="1878454">]</span><span class="op" id="1878455">,</span>&nbsp;<span class="ident" id="1878457">old</span><span class="op" id="1878460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1878464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1878468">w</span>&nbsp;<span class="op" id="1878470">+=</span>&nbsp;<span class="builtinfunc" id="1878473">copy</span><span class="op" id="1878477">(</span><span class="ident" id="1878478">t</span><span class="op" id="1878479">[</span><span class="ident" id="1878480">w</span><span class="op" id="1878481">:</span><span class="op" id="1878482">]</span><span class="op" id="1878483">,</span>&nbsp;<span class="ident" id="1878485">s</span><span class="op" id="1878486">[</span><span class="ident" id="1878487">start</span><span class="op" id="1878492">:</span><span class="ident" id="1878493">j</span><span class="op" id="1878494">]</span><span class="op" id="1878495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1878499">w</span>&nbsp;<span class="op" id="1878501">+=</span>&nbsp;<span class="builtinfunc" id="1878504">copy</span><span class="op" id="1878508">(</span><span class="ident" id="1878509">t</span><span class="op" id="1878510">[</span><span class="ident" id="1878511">w</span><span class="op" id="1878512">:</span><span class="op" id="1878513">]</span><span class="op" id="1878514">,</span>&nbsp;<span class="builtinfunc" id="1878516">new</span><span class="op" id="1878519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1878523">start</span>&nbsp;<span class="op" id="1878529">=</span>&nbsp;<span class="ident" id="1878531">j</span>&nbsp;<span class="op" id="1878533">+</span>&nbsp;<span class="builtinfunc" id="1878535">len</span><span class="op" id="1878538">(</span><span class="ident" id="1878539">old</span><span class="op" id="1878542">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1878545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1878548">w</span>&nbsp;<span class="op" id="1878550">+=</span>&nbsp;<span class="builtinfunc" id="1878553">copy</span><span class="op" id="1878557">(</span><span class="ident" id="1878558">t</span><span class="op" id="1878559">[</span><span class="ident" id="1878560">w</span><span class="op" id="1878561">:</span><span class="op" id="1878562">]</span><span class="op" id="1878563">,</span>&nbsp;<span class="ident" id="1878565">s</span><span class="op" id="1878566">[</span><span class="ident" id="1878567">start</span><span class="op" id="1878572">:</span><span class="op" id="1878573">]</span><span class="op" id="1878574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1878577">return</span>&nbsp;<span class="ident" id="1878584">t</span><span class="op" id="1878585">[</span><span class="num" id="1878586">0</span><span class="op" id="1878587">:</span><span class="ident" id="1878588">w</span><span class="op" id="1878589">]</span><br>
<span class="lineno"></span><span class="op" id="1878591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="comment" id="1878594">//&nbsp;EqualFold&nbsp;reports&nbsp;whether&nbsp;s&nbsp;and&nbsp;t,&nbsp;interpreted&nbsp;as&nbsp;UTF-8&nbsp;strings,</span><br>
<span class="lineno"></span><span class="comment" id="1878662">//&nbsp;are&nbsp;equal&nbsp;under&nbsp;Unicode&nbsp;case-folding.</span><br>
<span class="lineno"></span><span class="keyword" id="1878703">func</span>&nbsp;<span class="ident" id="1878708">EqualFold</span><span class="op" id="1878717">(</span><span class="ident" id="1878718">s</span><span class="op" id="1878719">,</span>&nbsp;<span class="ident" id="1878721">t</span>&nbsp;<span class="op" id="1878723">[</span><span class="op" id="1878724">]</span><span class="builtintype" id="1878725">byte</span><span class="op" id="1878729">)</span>&nbsp;<span class="builtintype" id="1878731">bool</span>&nbsp;<span class="op" id="1878736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1878739">for</span>&nbsp;<span class="builtinfunc" id="1878743">len</span><span class="op" id="1878746">(</span><span class="ident" id="1878747">s</span><span class="op" id="1878748">)</span>&nbsp;<span class="op" id="1878750">!=</span>&nbsp;<span class="num" id="1878753">0</span>&nbsp;<span class="op" id="1878755">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="1878758">len</span><span class="op" id="1878761">(</span><span class="ident" id="1878762">t</span><span class="op" id="1878763">)</span>&nbsp;<span class="op" id="1878765">!=</span>&nbsp;<span class="num" id="1878768">0</span>&nbsp;<span class="op" id="1878770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1878774">//&nbsp;Extract&nbsp;first&nbsp;rune&nbsp;from&nbsp;each.</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1878809">var</span>&nbsp;<span class="ident" id="1878813">sr</span><span class="op" id="1878815">,</span>&nbsp;<span class="ident" id="1878817">tr</span>&nbsp;<span class="builtintype" id="1878820">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1878827">if</span>&nbsp;<span class="ident" id="1878830">s</span><span class="op" id="1878831">[</span><span class="num" id="1878832">0</span><span class="op" id="1878833">]</span>&nbsp;<span class="op" id="1878835">&lt;</span>&nbsp;<span class="ident" id="1878837">utf8</span><span class="op" id="1878841">.</span><span class="ident" id="1878842">RuneSelf</span>&nbsp;<span class="op" id="1878851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1878856">sr</span><span class="op" id="1878858">,</span>&nbsp;<span class="ident" id="1878860">s</span>&nbsp;<span class="op" id="1878862">=</span>&nbsp;<span class="builtintype" id="1878864">rune</span><span class="op" id="1878868">(</span><span class="ident" id="1878869">s</span><span class="op" id="1878870">[</span><span class="num" id="1878871">0</span><span class="op" id="1878872">]</span><span class="op" id="1878873">)</span><span class="op" id="1878874">,</span>&nbsp;<span class="ident" id="1878876">s</span><span class="op" id="1878877">[</span><span class="num" id="1878878">1</span><span class="op" id="1878879">:</span><span class="op" id="1878880">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1878884">}</span>&nbsp;<span class="keyword" id="1878886">else</span>&nbsp;<span class="op" id="1878891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1878896">r</span><span class="op" id="1878897">,</span>&nbsp;<span class="ident" id="1878899">size</span>&nbsp;<span class="op" id="1878904">:=</span>&nbsp;<span class="ident" id="1878907">utf8</span><span class="op" id="1878911">.</span><span class="ident" id="1878912">DecodeRune</span><span class="op" id="1878922">(</span><span class="ident" id="1878923">s</span><span class="op" id="1878924">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1878929">sr</span><span class="op" id="1878931">,</span>&nbsp;<span class="ident" id="1878933">s</span>&nbsp;<span class="op" id="1878935">=</span>&nbsp;<span class="ident" id="1878937">r</span><span class="op" id="1878938">,</span>&nbsp;<span class="ident" id="1878940">s</span><span class="op" id="1878941">[</span><span class="ident" id="1878942">size</span><span class="op" id="1878946">:</span><span class="op" id="1878947">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1878951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1878955">if</span>&nbsp;<span class="ident" id="1878958">t</span><span class="op" id="1878959">[</span><span class="num" id="1878960">0</span><span class="op" id="1878961">]</span>&nbsp;<span class="op" id="1878963">&lt;</span>&nbsp;<span class="ident" id="1878965">utf8</span><span class="op" id="1878969">.</span><span class="ident" id="1878970">RuneSelf</span>&nbsp;<span class="op" id="1878979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1878984">tr</span><span class="op" id="1878986">,</span>&nbsp;<span class="ident" id="1878988">t</span>&nbsp;<span class="op" id="1878990">=</span>&nbsp;<span class="builtintype" id="1878992">rune</span><span class="op" id="1878996">(</span><span class="ident" id="1878997">t</span><span class="op" id="1878998">[</span><span class="num" id="1878999">0</span><span class="op" id="1879000">]</span><span class="op" id="1879001">)</span><span class="op" id="1879002">,</span>&nbsp;<span class="ident" id="1879004">t</span><span class="op" id="1879005">[</span><span class="num" id="1879006">1</span><span class="op" id="1879007">:</span><span class="op" id="1879008">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1879012">}</span>&nbsp;<span class="keyword" id="1879014">else</span>&nbsp;<span class="op" id="1879019">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1879024">r</span><span class="op" id="1879025">,</span>&nbsp;<span class="ident" id="1879027">size</span>&nbsp;<span class="op" id="1879032">:=</span>&nbsp;<span class="ident" id="1879035">utf8</span><span class="op" id="1879039">.</span><span class="ident" id="1879040">DecodeRune</span><span class="op" id="1879050">(</span><span class="ident" id="1879051">t</span><span class="op" id="1879052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1879057">tr</span><span class="op" id="1879059">,</span>&nbsp;<span class="ident" id="1879061">t</span>&nbsp;<span class="op" id="1879063">=</span>&nbsp;<span class="ident" id="1879065">r</span><span class="op" id="1879066">,</span>&nbsp;<span class="ident" id="1879068">t</span><span class="op" id="1879069">[</span><span class="ident" id="1879070">size</span><span class="op" id="1879074">:</span><span class="op" id="1879075">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1879079">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1879084">//&nbsp;If&nbsp;they&nbsp;match,&nbsp;keep&nbsp;going;&nbsp;if&nbsp;not,&nbsp;return&nbsp;false.</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1879139">//&nbsp;Easy&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1879155">if</span>&nbsp;<span class="ident" id="1879158">tr</span>&nbsp;<span class="op" id="1879161">==</span>&nbsp;<span class="ident" id="1879164">sr</span>&nbsp;<span class="op" id="1879167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1879172">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1879183">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1879188">//&nbsp;Make&nbsp;sr&nbsp;&lt;&nbsp;tr&nbsp;to&nbsp;simplify&nbsp;what&nbsp;follows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1879232">if</span>&nbsp;<span class="ident" id="1879235">tr</span>&nbsp;<span class="op" id="1879238">&lt;</span>&nbsp;<span class="ident" id="1879240">sr</span>&nbsp;<span class="op" id="1879243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1879248">tr</span><span class="op" id="1879250">,</span>&nbsp;<span class="ident" id="1879252">sr</span>&nbsp;<span class="op" id="1879255">=</span>&nbsp;<span class="ident" id="1879257">sr</span><span class="op" id="1879259">,</span>&nbsp;<span class="ident" id="1879261">tr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1879266">}</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1879270">//&nbsp;Fast&nbsp;check&nbsp;for&nbsp;ASCII.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1879297">if</span>&nbsp;<span class="ident" id="1879300">tr</span>&nbsp;<span class="op" id="1879303">&lt;</span>&nbsp;<span class="ident" id="1879305">utf8</span><span class="op" id="1879309">.</span><span class="ident" id="1879310">RuneSelf</span>&nbsp;<span class="op" id="1879319">&amp;&amp;</span>&nbsp;<span class="string" id="1879322">&#39;A&#39;</span>&nbsp;<span class="op" id="1879326">&lt;=</span>&nbsp;<span class="ident" id="1879329">sr</span>&nbsp;<span class="op" id="1879332">&amp;&amp;</span>&nbsp;<span class="ident" id="1879335">sr</span>&nbsp;<span class="op" id="1879338">&lt;=</span>&nbsp;<span class="string" id="1879341">&#39;Z&#39;</span>&nbsp;<span class="op" id="1879345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1879350">//&nbsp;ASCII,&nbsp;and&nbsp;sr&nbsp;is&nbsp;upper&nbsp;case.&nbsp;&nbsp;tr&nbsp;must&nbsp;be&nbsp;lower&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1879409">if</span>&nbsp;<span class="ident" id="1879412">tr</span>&nbsp;<span class="op" id="1879415">==</span>&nbsp;<span class="ident" id="1879418">sr</span><span class="op" id="1879420">+</span><span class="string" id="1879421">&#39;a&#39;</span><span class="op" id="1879424">-</span><span class="string" id="1879425">&#39;A&#39;</span>&nbsp;<span class="op" id="1879429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1879435">continue</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1879447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1879452">return</span>&nbsp;<span class="builtintype" id="1879459">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1879467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1879472">//&nbsp;General&nbsp;case.&nbsp;&nbsp;SimpleFold(x)&nbsp;returns&nbsp;the&nbsp;next&nbsp;equivalent&nbsp;rune&nbsp;&gt;&nbsp;x</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1879543">//&nbsp;or&nbsp;wraps&nbsp;around&nbsp;to&nbsp;smaller&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1879583">r</span>&nbsp;<span class="op" id="1879585">:=</span>&nbsp;<span class="ident" id="1879588">unicode</span><span class="op" id="1879595">.</span><span class="ident" id="1879596">SimpleFold</span><span class="op" id="1879606">(</span><span class="ident" id="1879607">sr</span><span class="op" id="1879609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1879613">for</span>&nbsp;<span class="ident" id="1879617">r</span>&nbsp;<span class="op" id="1879619">!=</span>&nbsp;<span class="ident" id="1879622">sr</span>&nbsp;<span class="op" id="1879625">&amp;&amp;</span>&nbsp;<span class="ident" id="1879628">r</span>&nbsp;<span class="op" id="1879630">&lt;</span>&nbsp;<span class="ident" id="1879632">tr</span>&nbsp;<span class="op" id="1879635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1879640">r</span>&nbsp;<span class="op" id="1879642">=</span>&nbsp;<span class="ident" id="1879644">unicode</span><span class="op" id="1879651">.</span><span class="ident" id="1879652">SimpleFold</span><span class="op" id="1879662">(</span><span class="ident" id="1879663">r</span><span class="op" id="1879664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1879668">}</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1879672">if</span>&nbsp;<span class="ident" id="1879675">r</span>&nbsp;<span class="op" id="1879677">==</span>&nbsp;<span class="ident" id="1879680">tr</span>&nbsp;<span class="op" id="1879683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1879688">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1879699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1879703">return</span>&nbsp;<span class="builtintype" id="1879710">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1879717">}</span><br>
<span class="lineno">700</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1879721">//&nbsp;One&nbsp;string&nbsp;is&nbsp;empty.&nbsp;&nbsp;Are&nbsp;both?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1879757">return</span>&nbsp;<span class="builtinfunc" id="1879764">len</span><span class="op" id="1879767">(</span><span class="ident" id="1879768">s</span><span class="op" id="1879769">)</span>&nbsp;<span class="op" id="1879771">==</span>&nbsp;<span class="builtinfunc" id="1879774">len</span><span class="op" id="1879777">(</span><span class="ident" id="1879778">t</span><span class="op" id="1879779">)</span><br>
<span class="lineno"></span><span class="op" id="1879781">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
