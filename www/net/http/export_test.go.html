<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7415404">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7415460">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7415514">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="7415565">//&nbsp;Bridge&nbsp;package&nbsp;to&nbsp;expose&nbsp;http&nbsp;internals&nbsp;to&nbsp;tests&nbsp;in&nbsp;the&nbsp;http_test</span><br>
<span class="lineno"></span><span class="comment" id="7415634">//&nbsp;package.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7415647">package</span>&nbsp;<span class="ident" id="7415655">http</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="7415661">import</span>&nbsp;<span class="op" id="7415668">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7415671">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7415678">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7415689">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7415696">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7415699">func</span>&nbsp;<span class="ident" id="7415704">NewLoggingConn</span><span class="op" id="7415718">(</span><span class="ident" id="7415719">baseName</span>&nbsp;<span class="builtintype" id="7415728">string</span><span class="op" id="7415734">,</span>&nbsp;<span class="ident" id="7415736">c</span>&nbsp;<span class="ident" id="7415738"><a href="/net/http/export_test.go.html#7415671">net</a></span><span class="op" id="7415741">.</span><span class="ident" id="7415742">Conn</span><span class="op" id="7415746">)</span>&nbsp;<span class="ident" id="7415748"><a href="/net/http/export_test.go.html#7415671">net</a></span><span class="op" id="7415751">.</span><span class="ident" id="7415752">Conn</span>&nbsp;<span class="op" id="7415757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7415760">return</span>&nbsp;<span class="ident" id="7415767"><a href="/net/http/server.go.html#3884816">newLoggingConn</a></span><span class="op" id="7415781">(</span><span class="ident" id="7415782"><a href="/net/http/export_test.go.html#7415719">baseName</a></span><span class="op" id="7415790">,</span>&nbsp;<span class="ident" id="7415792"><a href="/net/http/export_test.go.html#7415736">c</a></span><span class="op" id="7415793">)</span><br>
<span class="lineno"></span><span class="op" id="7415795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="7415798">var</span>&nbsp;<span class="ident" id="7415802">ExportAppendTime</span>&nbsp;<span class="op" id="7415819">=</span>&nbsp;<span class="ident" id="7415821"><a href="/net/http/server.go.html#3839848">appendTime</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7415833">func</span>&nbsp;<span class="op" id="7415838">(</span><span class="ident" id="7415839">t</span>&nbsp;<span class="op" id="7415841">*</span><span class="ident" id="7415842"><a href="/net/http/transport.go.html#3916265">Transport</a></span><span class="op" id="7415851">)</span>&nbsp;<span class="ident" id="7415853">NumPendingRequestsForTesting</span><span class="op" id="7415881">(</span><span class="op" id="7415882">)</span>&nbsp;<span class="builtintype" id="7415884">int</span>&nbsp;<span class="op" id="7415888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7415891"><a href="/net/http/export_test.go.html#7415839">t</a></span><span class="op" id="7415892">.</span><span class="ident" id="7415893">reqMu</span><span class="op" id="7415898">.</span><span class="ident" id="7415899">Lock</span><span class="op" id="7415903">(</span><span class="op" id="7415904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7415907">defer</span>&nbsp;<span class="ident" id="7415913"><a href="/net/http/export_test.go.html#7415839">t</a></span><span class="op" id="7415914">.</span><span class="ident" id="7415915">reqMu</span><span class="op" id="7415920">.</span><span class="ident" id="7415921">Unlock</span><span class="op" id="7415927">(</span><span class="op" id="7415928">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7415931">return</span>&nbsp;<span class="builtinfunc" id="7415938">len</span><span class="op" id="7415941">(</span><span class="ident" id="7415942"><a href="/net/http/export_test.go.html#7415839">t</a></span><span class="op" id="7415943">.</span><span class="ident" id="7415944">reqCanceler</span><span class="op" id="7415955">)</span><br>
<span class="lineno"></span><span class="op" id="7415957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7415960">func</span>&nbsp;<span class="op" id="7415965">(</span><span class="ident" id="7415966">t</span>&nbsp;<span class="op" id="7415968">*</span><span class="ident" id="7415969"><a href="/net/http/transport.go.html#3916265">Transport</a></span><span class="op" id="7415978">)</span>&nbsp;<span class="ident" id="7415980">IdleConnKeysForTesting</span><span class="op" id="7416002">(</span><span class="op" id="7416003">)</span>&nbsp;<span class="op" id="7416005">(</span><span class="ident" id="7416006">keys</span>&nbsp;<span class="op" id="7416011">[</span><span class="op" id="7416012">]</span><span class="builtintype" id="7416013">string</span><span class="op" id="7416019">)</span>&nbsp;<span class="op" id="7416021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7416024"><a href="/net/http/export_test.go.html#7416006">keys</a></span>&nbsp;<span class="op" id="7416029">=</span>&nbsp;<span class="builtinfunc" id="7416031">make</span><span class="op" id="7416035">(</span><span class="op" id="7416036">[</span><span class="op" id="7416037">]</span><span class="builtintype" id="7416038">string</span><span class="op" id="7416044">,</span>&nbsp;<span class="num" id="7416046">0</span><span class="op" id="7416047">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7416050"><a href="/net/http/export_test.go.html#7415966">t</a></span><span class="op" id="7416051">.</span><span class="ident" id="7416052">idleMu</span><span class="op" id="7416058">.</span><span class="ident" id="7416059">Lock</span><span class="op" id="7416063">(</span><span class="op" id="7416064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7416067">defer</span>&nbsp;<span class="ident" id="7416073"><a href="/net/http/export_test.go.html#7415966">t</a></span><span class="op" id="7416074">.</span><span class="ident" id="7416075">idleMu</span><span class="op" id="7416081">.</span><span class="ident" id="7416082">Unlock</span><span class="op" id="7416088">(</span><span class="op" id="7416089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7416092">if</span>&nbsp;<span class="ident" id="7416095"><a href="/net/http/export_test.go.html#7415966">t</a></span><span class="op" id="7416096">.</span><span class="ident" id="7416097">idleConn</span>&nbsp;<span class="op" id="7416106">==</span>&nbsp;<span class="ident" id="7416109">nil</span>&nbsp;<span class="op" id="7416113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7416117">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7416125">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7416128">for</span>&nbsp;<span class="ident" id="7416132">key</span>&nbsp;<span class="op" id="7416136">:=</span>&nbsp;<span class="keyword" id="7416139">range</span>&nbsp;<span class="ident" id="7416145"><a href="/net/http/export_test.go.html#7415966">t</a></span><span class="op" id="7416146">.</span><span class="ident" id="7416147">idleConn</span>&nbsp;<span class="op" id="7416156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7416160"><a href="/net/http/export_test.go.html#7416006">keys</a></span>&nbsp;<span class="op" id="7416165">=</span>&nbsp;<span class="builtinfunc" id="7416167">append</span><span class="op" id="7416173">(</span><span class="ident" id="7416174"><a href="/net/http/export_test.go.html#7416006">keys</a></span><span class="op" id="7416178">,</span>&nbsp;<span class="ident" id="7416180"><a href="/net/http/export_test.go.html#7416132">key</a></span><span class="op" id="7416183">.</span><span class="ident" id="7416184">String</span><span class="op" id="7416190">(</span><span class="op" id="7416191">)</span><span class="op" id="7416192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7416195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7416198">return</span><br>
<span class="lineno"></span><span class="op" id="7416205">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="7416208">func</span>&nbsp;<span class="op" id="7416213">(</span><span class="ident" id="7416214">t</span>&nbsp;<span class="op" id="7416216">*</span><span class="ident" id="7416217"><a href="/net/http/transport.go.html#3916265">Transport</a></span><span class="op" id="7416226">)</span>&nbsp;<span class="ident" id="7416228">IdleConnCountForTesting</span><span class="op" id="7416251">(</span><span class="ident" id="7416252">cacheKey</span>&nbsp;<span class="builtintype" id="7416261">string</span><span class="op" id="7416267">)</span>&nbsp;<span class="builtintype" id="7416269">int</span>&nbsp;<span class="op" id="7416273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7416276"><a href="/net/http/export_test.go.html#7416214">t</a></span><span class="op" id="7416277">.</span><span class="ident" id="7416278">idleMu</span><span class="op" id="7416284">.</span><span class="ident" id="7416285">Lock</span><span class="op" id="7416289">(</span><span class="op" id="7416290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7416293">defer</span>&nbsp;<span class="ident" id="7416299"><a href="/net/http/export_test.go.html#7416214">t</a></span><span class="op" id="7416300">.</span><span class="ident" id="7416301">idleMu</span><span class="op" id="7416307">.</span><span class="ident" id="7416308">Unlock</span><span class="op" id="7416314">(</span><span class="op" id="7416315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7416318">if</span>&nbsp;<span class="ident" id="7416321"><a href="/net/http/export_test.go.html#7416214">t</a></span><span class="op" id="7416322">.</span><span class="ident" id="7416323">idleConn</span>&nbsp;<span class="op" id="7416332">==</span>&nbsp;<span class="ident" id="7416335">nil</span>&nbsp;<span class="op" id="7416339">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7416343">return</span>&nbsp;<span class="num" id="7416350">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7416353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7416356">for</span>&nbsp;<span class="ident" id="7416360">k</span><span class="op" id="7416361">,</span>&nbsp;<span class="ident" id="7416363">conns</span>&nbsp;<span class="op" id="7416369">:=</span>&nbsp;<span class="keyword" id="7416372">range</span>&nbsp;<span class="ident" id="7416378"><a href="/net/http/export_test.go.html#7416214">t</a></span><span class="op" id="7416379">.</span><span class="ident" id="7416380">idleConn</span>&nbsp;<span class="op" id="7416389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7416393">if</span>&nbsp;<span class="ident" id="7416396"><a href="/net/http/export_test.go.html#7416360">k</a></span><span class="op" id="7416397">.</span><span class="ident" id="7416398">String</span><span class="op" id="7416404">(</span><span class="op" id="7416405">)</span>&nbsp;<span class="op" id="7416407">==</span>&nbsp;<span class="ident" id="7416410"><a href="/net/http/export_test.go.html#7416252">cacheKey</a></span>&nbsp;<span class="op" id="7416419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7416424">return</span>&nbsp;<span class="builtinfunc" id="7416431">len</span><span class="op" id="7416434">(</span><span class="ident" id="7416435"><a href="/net/http/export_test.go.html#7416363">conns</a></span><span class="op" id="7416440">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7416444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7416447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7416450">return</span>&nbsp;<span class="num" id="7416457">0</span><br>
<span class="lineno"></span><span class="op" id="7416459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="7416462">func</span>&nbsp;<span class="op" id="7416467">(</span><span class="ident" id="7416468">t</span>&nbsp;<span class="op" id="7416470">*</span><span class="ident" id="7416471"><a href="/net/http/transport.go.html#3916265">Transport</a></span><span class="op" id="7416480">)</span>&nbsp;<span class="ident" id="7416482">IdleConnChMapSizeForTesting</span><span class="op" id="7416509">(</span><span class="op" id="7416510">)</span>&nbsp;<span class="builtintype" id="7416512">int</span>&nbsp;<span class="op" id="7416516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7416519"><a href="/net/http/export_test.go.html#7416468">t</a></span><span class="op" id="7416520">.</span><span class="ident" id="7416521">idleMu</span><span class="op" id="7416527">.</span><span class="ident" id="7416528">Lock</span><span class="op" id="7416532">(</span><span class="op" id="7416533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7416536">defer</span>&nbsp;<span class="ident" id="7416542"><a href="/net/http/export_test.go.html#7416468">t</a></span><span class="op" id="7416543">.</span><span class="ident" id="7416544">idleMu</span><span class="op" id="7416550">.</span><span class="ident" id="7416551">Unlock</span><span class="op" id="7416557">(</span><span class="op" id="7416558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7416561">return</span>&nbsp;<span class="builtinfunc" id="7416568">len</span><span class="op" id="7416571">(</span><span class="ident" id="7416572"><a href="/net/http/export_test.go.html#7416468">t</a></span><span class="op" id="7416573">.</span><span class="ident" id="7416574">idleConnCh</span><span class="op" id="7416584">)</span><br>
<span class="lineno"></span><span class="op" id="7416586">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="7416589">func</span>&nbsp;<span class="op" id="7416594">(</span><span class="ident" id="7416595">t</span>&nbsp;<span class="op" id="7416597">*</span><span class="ident" id="7416598"><a href="/net/http/transport.go.html#3916265">Transport</a></span><span class="op" id="7416607">)</span>&nbsp;<span class="ident" id="7416609">IsIdleForTesting</span><span class="op" id="7416625">(</span><span class="op" id="7416626">)</span>&nbsp;<span class="builtintype" id="7416628">bool</span>&nbsp;<span class="op" id="7416633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7416636"><a href="/net/http/export_test.go.html#7416595">t</a></span><span class="op" id="7416637">.</span><span class="ident" id="7416638">idleMu</span><span class="op" id="7416644">.</span><span class="ident" id="7416645">Lock</span><span class="op" id="7416649">(</span><span class="op" id="7416650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7416653">defer</span>&nbsp;<span class="ident" id="7416659"><a href="/net/http/export_test.go.html#7416595">t</a></span><span class="op" id="7416660">.</span><span class="ident" id="7416661">idleMu</span><span class="op" id="7416667">.</span><span class="ident" id="7416668">Unlock</span><span class="op" id="7416674">(</span><span class="op" id="7416675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7416678">return</span>&nbsp;<span class="ident" id="7416685"><a href="/net/http/export_test.go.html#7416595">t</a></span><span class="op" id="7416686">.</span><span class="ident" id="7416687">wantIdle</span><br>
<span class="lineno">65</span><span class="op" id="7416696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7416699">func</span>&nbsp;<span class="op" id="7416704">(</span><span class="ident" id="7416705">t</span>&nbsp;<span class="op" id="7416707">*</span><span class="ident" id="7416708"><a href="/net/http/transport.go.html#3916265">Transport</a></span><span class="op" id="7416717">)</span>&nbsp;<span class="ident" id="7416719">RequestIdleConnChForTesting</span><span class="op" id="7416746">(</span><span class="op" id="7416747">)</span>&nbsp;<span class="op" id="7416749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7416752"><a href="/net/http/export_test.go.html#7416705">t</a></span><span class="op" id="7416753">.</span><span class="ident" id="7416754">getIdleConnCh</span><span class="op" id="7416767">(</span><span class="ident" id="7416768"><a href="/net/http/transport.go.html#3934637">connectMethod</a></span><span class="op" id="7416781">{</span><span class="ident" id="7416782">nil</span><span class="op" id="7416785">,</span>&nbsp;<span class="string" id="7416787">&#34;http&#34;</span><span class="op" id="7416793">,</span>&nbsp;<span class="string" id="7416795">&#34;example.com&#34;</span><span class="op" id="7416808">}</span><span class="op" id="7416809">)</span><br>
<span class="lineno"></span><span class="op" id="7416811">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="7416814">func</span>&nbsp;<span class="op" id="7416819">(</span><span class="ident" id="7416820">t</span>&nbsp;<span class="op" id="7416822">*</span><span class="ident" id="7416823"><a href="/net/http/transport.go.html#3916265">Transport</a></span><span class="op" id="7416832">)</span>&nbsp;<span class="ident" id="7416834">PutIdleTestConn</span><span class="op" id="7416849">(</span><span class="op" id="7416850">)</span>&nbsp;<span class="builtintype" id="7416852">bool</span>&nbsp;<span class="op" id="7416857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7416860">c</span><span class="op" id="7416861">,</span>&nbsp;<span class="ident" id="7416863">_</span>&nbsp;<span class="op" id="7416865">:=</span>&nbsp;<span class="ident" id="7416868"><a href="/net/http/export_test.go.html#7415671">net</a></span><span class="op" id="7416871">.</span><span class="ident" id="7416872">Pipe</span><span class="op" id="7416876">(</span><span class="op" id="7416877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7416880">return</span>&nbsp;<span class="ident" id="7416887"><a href="/net/http/export_test.go.html#7416820">t</a></span><span class="op" id="7416888">.</span><span class="ident" id="7416889">putIdleConn</span><span class="op" id="7416900">(</span><span class="op" id="7416901">&amp;</span><span class="ident" id="7416902"><a href="/net/http/transport.go.html#3936054">persistConn</a></span><span class="op" id="7416913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7416917">t</span><span class="op" id="7416918">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7416927"><a href="/net/http/export_test.go.html#7416820">t</a></span><span class="op" id="7416928">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7416932">conn</span><span class="op" id="7416936">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7416942"><a href="/net/http/export_test.go.html#7416860">c</a></span><span class="op" id="7416943">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7416963">//&nbsp;dummy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7416974">closech</span><span class="op" id="7416981">:</span>&nbsp;&nbsp;<span class="builtinfunc" id="7416984">make</span><span class="op" id="7416988">(</span><span class="keyword" id="7416989">chan</span>&nbsp;<span class="keyword" id="7416994">struct</span><span class="op" id="7417000">{</span><span class="op" id="7417001">}</span><span class="op" id="7417002">)</span><span class="op" id="7417003">,</span>&nbsp;<span class="comment" id="7417005">//&nbsp;so&nbsp;it&nbsp;can&nbsp;be&nbsp;closed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7417030">cacheKey</span><span class="op" id="7417038">:</span>&nbsp;<span class="ident" id="7417040"><a href="/net/http/transport.go.html#3935745">connectMethodKey</a></span><span class="op" id="7417056">{</span><span class="string" id="7417057">&#34;&#34;</span><span class="op" id="7417059">,</span>&nbsp;<span class="string" id="7417061">&#34;http&#34;</span><span class="op" id="7417067">,</span>&nbsp;<span class="string" id="7417069">&#34;example.com&#34;</span><span class="op" id="7417082">}</span><span class="op" id="7417083">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7417086">}</span><span class="op" id="7417087">)</span><br>
<span class="lineno"></span><span class="op" id="7417089">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="keyword" id="7417092">func</span>&nbsp;<span class="ident" id="7417097">NewTestTimeoutHandler</span><span class="op" id="7417118">(</span><span class="ident" id="7417119">handler</span>&nbsp;<span class="ident" id="7417127"><a href="/net/http/server.go.html#3825877">Handler</a></span><span class="op" id="7417134">,</span>&nbsp;<span class="ident" id="7417136">ch</span>&nbsp;<span class="op" id="7417139">&lt;-</span><span class="keyword" id="7417141">chan</span>&nbsp;<span class="ident" id="7417146"><a href="/net/http/export_test.go.html#7415689">time</a></span><span class="op" id="7417150">.</span><span class="ident" id="7417151">Time</span><span class="op" id="7417155">)</span>&nbsp;<span class="ident" id="7417157"><a href="/net/http/server.go.html#3825877">Handler</a></span>&nbsp;<span class="op" id="7417165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7417168">f</span>&nbsp;<span class="op" id="7417170">:=</span>&nbsp;<span class="keyword" id="7417173">func</span><span class="op" id="7417177">(</span><span class="op" id="7417178">)</span>&nbsp;<span class="op" id="7417180">&lt;-</span><span class="keyword" id="7417182">chan</span>&nbsp;<span class="ident" id="7417187"><a href="/net/http/export_test.go.html#7415689">time</a></span><span class="op" id="7417191">.</span><span class="ident" id="7417192">Time</span>&nbsp;<span class="op" id="7417197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7417201">return</span>&nbsp;<span class="ident" id="7417208"><a href="/net/http/export_test.go.html#7417136">ch</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7417212">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7417215">return</span>&nbsp;<span class="op" id="7417222">&amp;</span><span class="ident" id="7417223"><a href="/net/http/server.go.html#3881205">timeoutHandler</a></span><span class="op" id="7417237">{</span><span class="ident" id="7417238"><a href="/net/http/export_test.go.html#7417119">handler</a></span><span class="op" id="7417245">,</span>&nbsp;<span class="ident" id="7417247"><a href="/net/http/export_test.go.html#7417168">f</a></span><span class="op" id="7417248">,</span>&nbsp;<span class="string" id="7417250">&#34;&#34;</span><span class="op" id="7417252">}</span><br>
<span class="lineno"></span><span class="op" id="7417254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7417257">func</span>&nbsp;<span class="ident" id="7417262">ResetCachedEnvironment</span><span class="op" id="7417284">(</span><span class="op" id="7417285">)</span>&nbsp;<span class="op" id="7417287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7417290"><a href="/net/http/transport.go.html#3923959">httpProxyEnv</a></span><span class="op" id="7417302">.</span><span class="ident" id="7417303">reset</span><span class="op" id="7417308">(</span><span class="op" id="7417309">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7417312"><a href="/net/http/transport.go.html#3924035">httpsProxyEnv</a></span><span class="op" id="7417325">.</span><span class="ident" id="7417326">reset</span><span class="op" id="7417331">(</span><span class="op" id="7417332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7417335"><a href="/net/http/transport.go.html#3924114">noProxyEnv</a></span><span class="op" id="7417345">.</span><span class="ident" id="7417346">reset</span><span class="op" id="7417351">(</span><span class="op" id="7417352">)</span><br>
<span class="lineno"></span><span class="op" id="7417354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7417357">var</span>&nbsp;<span class="ident" id="7417361">DefaultUserAgent</span>&nbsp;<span class="op" id="7417378">=</span>&nbsp;<span class="ident" id="7417380"><a href="/net/http/request.go.html#3800982">defaultUserAgent</a></span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="7417398">func</span>&nbsp;<span class="ident" id="7417403">ExportRefererForURL</span><span class="op" id="7417422">(</span><span class="ident" id="7417423">lastReq</span><span class="op" id="7417430">,</span>&nbsp;<span class="ident" id="7417432">newReq</span>&nbsp;<span class="op" id="7417439">*</span><span class="ident" id="7417440"><a href="/net/http/export_test.go.html#7415678">url</a></span><span class="op" id="7417443">.</span><span class="ident" id="7417444">URL</span><span class="op" id="7417447">)</span>&nbsp;<span class="builtintype" id="7417449">string</span>&nbsp;<span class="op" id="7417456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7417459">return</span>&nbsp;<span class="ident" id="7417466"><a href="/net/http/client.go.html#3739229">refererForURL</a></span><span class="op" id="7417479">(</span><span class="ident" id="7417480"><a href="/net/http/export_test.go.html#7417423">lastReq</a></span><span class="op" id="7417487">,</span>&nbsp;<span class="ident" id="7417489"><a href="/net/http/export_test.go.html#7417432">newReq</a></span><span class="op" id="7417495">)</span><br>
<span class="lineno"></span><span class="op" id="7417497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="7417500">//&nbsp;SetPendingDialHooks&nbsp;sets&nbsp;the&nbsp;hooks&nbsp;that&nbsp;run&nbsp;before&nbsp;and&nbsp;after&nbsp;handling</span><br>
<span class="lineno"></span><span class="comment" id="7417573">//&nbsp;pending&nbsp;dials.</span><br>
<span class="lineno"></span><span class="keyword" id="7417591">func</span>&nbsp;<span class="ident" id="7417596">SetPendingDialHooks</span><span class="op" id="7417615">(</span><span class="ident" id="7417616">before</span><span class="op" id="7417622">,</span>&nbsp;<span class="ident" id="7417624">after</span>&nbsp;<span class="keyword" id="7417630">func</span><span class="op" id="7417634">(</span><span class="op" id="7417635">)</span><span class="op" id="7417636">)</span>&nbsp;<span class="op" id="7417638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7417641"><a href="/net/http/transport.go.html#3928331">prePendingDial</a></span><span class="op" id="7417655">,</span>&nbsp;<span class="ident" id="7417657"><a href="/net/http/transport.go.html#3928347">postPendingDial</a></span>&nbsp;<span class="op" id="7417673">=</span>&nbsp;<span class="ident" id="7417675"><a href="/net/http/export_test.go.html#7417616">before</a></span><span class="op" id="7417681">,</span>&nbsp;<span class="ident" id="7417683"><a href="/net/http/export_test.go.html#7417624">after</a></span><br>
<span class="lineno"></span><span class="op" id="7417689">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="keyword" id="7417692">var</span>&nbsp;<span class="ident" id="7417696">ExportServerNewConn</span>&nbsp;<span class="op" id="7417716">=</span>&nbsp;<span class="op" id="7417718">(</span><span class="op" id="7417719">*</span><span class="ident" id="7417720"><a href="/net/http/server.go.html#3872025">Server</a></span><span class="op" id="7417726">)</span><span class="op" id="7417727">.</span><span class="ident" id="7417728">newConn</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7417737">var</span>&nbsp;<span class="ident" id="7417741">ExportCloseWriteAndWait</span>&nbsp;<span class="op" id="7417765">=</span>&nbsp;<span class="op" id="7417767">(</span><span class="op" id="7417768">*</span><span class="ident" id="7417769"><a href="/net/http/server.go.html#3828256">conn</a></span><span class="op" id="7417773">)</span><span class="op" id="7417774">.</span><span class="ident" id="7417775">closeWriteAndWait</span>
</div>
</body>
</html>
