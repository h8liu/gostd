<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/macho</h2>
<ul>
<li><a href="/gostd/debug/macho/fat.go.html" class="current">fat.go</a></li>
<li><a href="/gostd/debug/macho/file.go.html">file.go</a></li>
<li><a href="/gostd/debug/macho/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/macho/macho.go.html">macho.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6154950">//&nbsp;Copyright&nbsp;2014&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6155006">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6155060">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6155111">package</span>&nbsp;<span class="ident" id="6155119">macho</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6155126">import</span>&nbsp;<span class="op" id="6155133">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6155136">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6155155">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6155162">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6155168">&#34;os&#34;</span><br>
<span class="lineno"></span><span class="op" id="6155173">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6155176">//&nbsp;A&nbsp;FatFile&nbsp;is&nbsp;a&nbsp;Mach-O&nbsp;universal&nbsp;binary&nbsp;that&nbsp;contains&nbsp;at&nbsp;least&nbsp;one&nbsp;architecture.</span><br>
<span class="lineno">15</span><span class="keyword" id="6155259">type</span>&nbsp;<span class="ident" id="6155264">FatFile</span>&nbsp;<span class="keyword" id="6155272">struct</span>&nbsp;<span class="op" id="6155279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155282">Magic</span>&nbsp;&nbsp;<span class="builtintype" id="6155289">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155297">Arches</span>&nbsp;<span class="op" id="6155304">[</span><span class="op" id="6155305">]</span><span class="ident" id="6155306">FatArch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155315">closer</span>&nbsp;<span class="ident" id="6155322">io</span><span class="op" id="6155324">.</span><span class="ident" id="6155325">Closer</span><br>
<span class="lineno"></span><span class="op" id="6155332">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="6155335">//&nbsp;A&nbsp;FatArchHeader&nbsp;represents&nbsp;a&nbsp;fat&nbsp;header&nbsp;for&nbsp;a&nbsp;specific&nbsp;image&nbsp;architecture.</span><br>
<span class="lineno"></span><span class="keyword" id="6155413">type</span>&nbsp;<span class="ident" id="6155418">FatArchHeader</span>&nbsp;<span class="keyword" id="6155432">struct</span>&nbsp;<span class="op" id="6155439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155442">Cpu</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155449">Cpu</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155454">SubCpu</span>&nbsp;<span class="builtintype" id="6155461">uint32</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155469">Offset</span>&nbsp;<span class="builtintype" id="6155476">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155484">Size</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6155491">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155499">Align</span>&nbsp;&nbsp;<span class="builtintype" id="6155506">uint32</span><br>
<span class="lineno"></span><span class="op" id="6155513">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="6155516">const</span>&nbsp;<span class="ident" id="6155522">fatArchHeaderSize</span>&nbsp;<span class="op" id="6155540">=</span>&nbsp;<span class="num" id="6155542">5</span>&nbsp;<span class="op" id="6155544">*</span>&nbsp;<span class="num" id="6155546">4</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6155549">//&nbsp;A&nbsp;FatArch&nbsp;is&nbsp;a&nbsp;Mach-O&nbsp;File&nbsp;inside&nbsp;a&nbsp;FatFile.</span><br>
<span class="lineno"></span><span class="keyword" id="6155597">type</span>&nbsp;<span class="ident" id="6155602">FatArch</span>&nbsp;<span class="keyword" id="6155610">struct</span>&nbsp;<span class="op" id="6155617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6155620">FatArchHeader</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6155635">*</span><span class="ident" id="6155636">File</span><br>
<span class="lineno"></span><span class="op" id="6155641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6155644">//&nbsp;ErrNotFat&nbsp;is&nbsp;returned&nbsp;from&nbsp;NewFatFile&nbsp;or&nbsp;OpenFat&nbsp;when&nbsp;the&nbsp;file&nbsp;is&nbsp;not&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="6155719">//&nbsp;universal&nbsp;binary&nbsp;but&nbsp;may&nbsp;be&nbsp;a&nbsp;thin&nbsp;binary,&nbsp;based&nbsp;on&nbsp;its&nbsp;magic&nbsp;number.</span><br>
<span class="lineno">40</span><span class="keyword" id="6155792">var</span>&nbsp;<span class="ident" id="6155796">ErrNotFat</span>&nbsp;<span class="op" id="6155806">=</span>&nbsp;<span class="op" id="6155808">&amp;</span><span class="ident" id="6155809">FormatError</span><span class="op" id="6155820">{</span><span class="num" id="6155821">0</span><span class="op" id="6155822">,</span>&nbsp;<span class="string" id="6155824">&#34;not&nbsp;a&nbsp;fat&nbsp;Mach-O&nbsp;file&#34;</span><span class="op" id="6155847">,</span>&nbsp;<span class="builtintype" id="6155849">nil</span><span class="op" id="6155852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6155855">//&nbsp;NewFatFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;FatFile&nbsp;for&nbsp;accessing&nbsp;all&nbsp;the&nbsp;Mach-O&nbsp;images&nbsp;in&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="6155932">//&nbsp;universal&nbsp;binary.&nbsp;The&nbsp;Mach-O&nbsp;binary&nbsp;is&nbsp;expected&nbsp;to&nbsp;start&nbsp;at&nbsp;position&nbsp;0&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="6156009">//&nbsp;the&nbsp;ReaderAt.</span><br>
<span class="lineno">45</span><span class="keyword" id="6156026">func</span>&nbsp;<span class="ident" id="6156031">NewFatFile</span><span class="op" id="6156041">(</span><span class="ident" id="6156042">r</span>&nbsp;<span class="ident" id="6156044">io</span><span class="op" id="6156046">.</span><span class="ident" id="6156047">ReaderAt</span><span class="op" id="6156055">)</span>&nbsp;<span class="op" id="6156057">(</span><span class="op" id="6156058">*</span><span class="ident" id="6156059">FatFile</span><span class="op" id="6156066">,</span>&nbsp;<span class="builtintype" id="6156068">error</span><span class="op" id="6156073">)</span>&nbsp;<span class="op" id="6156075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6156078">var</span>&nbsp;<span class="ident" id="6156082">ff</span>&nbsp;<span class="ident" id="6156085">FatFile</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6156094">sr</span>&nbsp;<span class="op" id="6156097">:=</span>&nbsp;<span class="ident" id="6156100">io</span><span class="op" id="6156102">.</span><span class="ident" id="6156103">NewSectionReader</span><span class="op" id="6156119">(</span><span class="ident" id="6156120">r</span><span class="op" id="6156121">,</span>&nbsp;<span class="num" id="6156123">0</span><span class="op" id="6156124">,</span>&nbsp;<span class="num" id="6156126">1</span><span class="op" id="6156127">&lt;&lt;</span><span class="num" id="6156129">63</span><span class="op" id="6156131">-</span><span class="num" id="6156132">1</span><span class="op" id="6156133">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6156137">//&nbsp;Read&nbsp;the&nbsp;fat_header&nbsp;struct,&nbsp;which&nbsp;is&nbsp;always&nbsp;in&nbsp;big&nbsp;endian.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6156200">//&nbsp;Start&nbsp;with&nbsp;the&nbsp;magic&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6156233">err</span>&nbsp;<span class="op" id="6156237">:=</span>&nbsp;<span class="ident" id="6156240">binary</span><span class="op" id="6156246">.</span><span class="ident" id="6156247">Read</span><span class="op" id="6156251">(</span><span class="ident" id="6156252">sr</span><span class="op" id="6156254">,</span>&nbsp;<span class="ident" id="6156256">binary</span><span class="op" id="6156262">.</span><span class="ident" id="6156263">BigEndian</span><span class="op" id="6156272">,</span>&nbsp;<span class="op" id="6156274">&amp;</span><span class="ident" id="6156275">ff</span><span class="op" id="6156277">.</span><span class="ident" id="6156278">Magic</span><span class="op" id="6156283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6156286">if</span>&nbsp;<span class="ident" id="6156289">err</span>&nbsp;<span class="op" id="6156293">!=</span>&nbsp;<span class="builtintype" id="6156296">nil</span>&nbsp;<span class="op" id="6156300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6156304">return</span>&nbsp;<span class="builtintype" id="6156311">nil</span><span class="op" id="6156314">,</span>&nbsp;<span class="op" id="6156316">&amp;</span><span class="ident" id="6156317">FormatError</span><span class="op" id="6156328">{</span><span class="num" id="6156329">0</span><span class="op" id="6156330">,</span>&nbsp;<span class="string" id="6156332">&#34;error&nbsp;reading&nbsp;magic&nbsp;number&#34;</span><span class="op" id="6156360">,</span>&nbsp;<span class="builtintype" id="6156362">nil</span><span class="op" id="6156365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6156368">}</span>&nbsp;<span class="keyword" id="6156370">else</span>&nbsp;<span class="keyword" id="6156375">if</span>&nbsp;<span class="ident" id="6156378">ff</span><span class="op" id="6156380">.</span><span class="ident" id="6156381">Magic</span>&nbsp;<span class="op" id="6156387">!=</span>&nbsp;<span class="ident" id="6156390">MagicFat</span>&nbsp;<span class="op" id="6156399">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6156403">//&nbsp;See&nbsp;if&nbsp;this&nbsp;is&nbsp;a&nbsp;Mach-O&nbsp;file&nbsp;via&nbsp;its&nbsp;magic&nbsp;number.&nbsp;The&nbsp;magic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6156469">//&nbsp;must&nbsp;be&nbsp;converted&nbsp;to&nbsp;little&nbsp;endian&nbsp;first&nbsp;though.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6156523">var</span>&nbsp;<span class="ident" id="6156527">buf</span>&nbsp;<span class="op" id="6156531">[</span><span class="num" id="6156532">4</span><span class="op" id="6156533">]</span><span class="builtintype" id="6156534">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6156541">binary</span><span class="op" id="6156547">.</span><span class="ident" id="6156548">BigEndian</span><span class="op" id="6156557">.</span><span class="ident" id="6156558">PutUint32</span><span class="op" id="6156567">(</span><span class="ident" id="6156568">buf</span><span class="op" id="6156571">[</span><span class="op" id="6156572">:</span><span class="op" id="6156573">]</span><span class="op" id="6156574">,</span>&nbsp;<span class="ident" id="6156576">ff</span><span class="op" id="6156578">.</span><span class="ident" id="6156579">Magic</span><span class="op" id="6156584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6156588">leMagic</span>&nbsp;<span class="op" id="6156596">:=</span>&nbsp;<span class="ident" id="6156599">binary</span><span class="op" id="6156605">.</span><span class="ident" id="6156606">LittleEndian</span><span class="op" id="6156618">.</span><span class="ident" id="6156619">Uint32</span><span class="op" id="6156625">(</span><span class="ident" id="6156626">buf</span><span class="op" id="6156629">[</span><span class="op" id="6156630">:</span><span class="op" id="6156631">]</span><span class="op" id="6156632">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6156636">if</span>&nbsp;<span class="ident" id="6156639">leMagic</span>&nbsp;<span class="op" id="6156647">==</span>&nbsp;<span class="ident" id="6156650">Magic32</span>&nbsp;<span class="op" id="6156658">||</span>&nbsp;<span class="ident" id="6156661">leMagic</span>&nbsp;<span class="op" id="6156669">==</span>&nbsp;<span class="ident" id="6156672">Magic64</span>&nbsp;<span class="op" id="6156680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6156685">return</span>&nbsp;<span class="builtintype" id="6156692">nil</span><span class="op" id="6156695">,</span>&nbsp;<span class="ident" id="6156697">ErrNotFat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6156709">}</span>&nbsp;<span class="keyword" id="6156711">else</span>&nbsp;<span class="op" id="6156716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6156721">return</span>&nbsp;<span class="builtintype" id="6156728">nil</span><span class="op" id="6156731">,</span>&nbsp;<span class="op" id="6156733">&amp;</span><span class="ident" id="6156734">FormatError</span><span class="op" id="6156745">{</span><span class="num" id="6156746">0</span><span class="op" id="6156747">,</span>&nbsp;<span class="string" id="6156749">&#34;invalid&nbsp;magic&nbsp;number&#34;</span><span class="op" id="6156771">,</span>&nbsp;<span class="builtintype" id="6156773">nil</span><span class="op" id="6156776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6156780">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6156783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6156786">offset</span>&nbsp;<span class="op" id="6156793">:=</span>&nbsp;<span class="ident" id="6156796">int64</span><span class="op" id="6156801">(</span><span class="num" id="6156802">4</span><span class="op" id="6156803">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6156807">//&nbsp;Read&nbsp;the&nbsp;number&nbsp;of&nbsp;FatArchHeaders&nbsp;that&nbsp;come&nbsp;after&nbsp;the&nbsp;fat_header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6156877">var</span>&nbsp;<span class="ident" id="6156881">narch</span>&nbsp;<span class="builtintype" id="6156887">uint32</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6156895">err</span>&nbsp;<span class="op" id="6156899">=</span>&nbsp;<span class="ident" id="6156901">binary</span><span class="op" id="6156907">.</span><span class="ident" id="6156908">Read</span><span class="op" id="6156912">(</span><span class="ident" id="6156913">sr</span><span class="op" id="6156915">,</span>&nbsp;<span class="ident" id="6156917">binary</span><span class="op" id="6156923">.</span><span class="ident" id="6156924">BigEndian</span><span class="op" id="6156933">,</span>&nbsp;<span class="op" id="6156935">&amp;</span><span class="ident" id="6156936">narch</span><span class="op" id="6156941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6156944">if</span>&nbsp;<span class="ident" id="6156947">err</span>&nbsp;<span class="op" id="6156951">!=</span>&nbsp;<span class="builtintype" id="6156954">nil</span>&nbsp;<span class="op" id="6156958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6156962">return</span>&nbsp;<span class="builtintype" id="6156969">nil</span><span class="op" id="6156972">,</span>&nbsp;<span class="op" id="6156974">&amp;</span><span class="ident" id="6156975">FormatError</span><span class="op" id="6156986">{</span><span class="ident" id="6156987">offset</span><span class="op" id="6156993">,</span>&nbsp;<span class="string" id="6156995">&#34;invalid&nbsp;fat_header&#34;</span><span class="op" id="6157015">,</span>&nbsp;<span class="builtintype" id="6157017">nil</span><span class="op" id="6157020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6157023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6157026">offset</span>&nbsp;<span class="op" id="6157033">+=</span>&nbsp;<span class="num" id="6157036">4</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6157040">if</span>&nbsp;<span class="ident" id="6157043">narch</span>&nbsp;<span class="op" id="6157049">&lt;</span>&nbsp;<span class="num" id="6157051">1</span>&nbsp;<span class="op" id="6157053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6157057">return</span>&nbsp;<span class="builtintype" id="6157064">nil</span><span class="op" id="6157067">,</span>&nbsp;<span class="op" id="6157069">&amp;</span><span class="ident" id="6157070">FormatError</span><span class="op" id="6157081">{</span><span class="ident" id="6157082">offset</span><span class="op" id="6157088">,</span>&nbsp;<span class="string" id="6157090">&#34;file&nbsp;contains&nbsp;no&nbsp;images&#34;</span><span class="op" id="6157115">,</span>&nbsp;<span class="builtintype" id="6157117">nil</span><span class="op" id="6157120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6157123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6157127">//&nbsp;Combine&nbsp;the&nbsp;Cpu&nbsp;and&nbsp;SubCpu&nbsp;(both&nbsp;uint32)&nbsp;into&nbsp;a&nbsp;uint64&nbsp;to&nbsp;make&nbsp;sure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6157199">//&nbsp;there&nbsp;are&nbsp;not&nbsp;duplicate&nbsp;architectures.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6157242">seenArches</span>&nbsp;<span class="op" id="6157253">:=</span>&nbsp;<span class="builtinfunc" id="6157256">make</span><span class="op" id="6157260">(</span><span class="keyword" id="6157261">map</span><span class="op" id="6157264">[</span><span class="ident" id="6157265">uint64</span><span class="op" id="6157271">]</span><span class="builtintype" id="6157272">bool</span><span class="op" id="6157276">,</span>&nbsp;<span class="ident" id="6157278">narch</span><span class="op" id="6157283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6157286">//&nbsp;Make&nbsp;sure&nbsp;that&nbsp;all&nbsp;images&nbsp;are&nbsp;for&nbsp;the&nbsp;same&nbsp;MH_&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6157343">var</span>&nbsp;<span class="ident" id="6157347">machoType</span>&nbsp;<span class="ident" id="6157357">Type</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6157364">//&nbsp;Following&nbsp;the&nbsp;fat_header&nbsp;comes&nbsp;narch&nbsp;fat_arch&nbsp;structs&nbsp;that&nbsp;index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6157433">//&nbsp;Mach-O&nbsp;images&nbsp;further&nbsp;in&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6157472">ff</span><span class="op" id="6157474">.</span><span class="ident" id="6157475">Arches</span>&nbsp;<span class="op" id="6157482">=</span>&nbsp;<span class="builtinfunc" id="6157484">make</span><span class="op" id="6157488">(</span><span class="op" id="6157489">[</span><span class="op" id="6157490">]</span><span class="ident" id="6157491">FatArch</span><span class="op" id="6157498">,</span>&nbsp;<span class="ident" id="6157500">narch</span><span class="op" id="6157505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6157508">for</span>&nbsp;<span class="ident" id="6157512">i</span>&nbsp;<span class="op" id="6157514">:=</span>&nbsp;<span class="builtintype" id="6157517">uint32</span><span class="op" id="6157523">(</span><span class="num" id="6157524">0</span><span class="op" id="6157525">)</span><span class="op" id="6157526">;</span>&nbsp;<span class="ident" id="6157528">i</span>&nbsp;<span class="op" id="6157530">&lt;</span>&nbsp;<span class="ident" id="6157532">narch</span><span class="op" id="6157537">;</span>&nbsp;<span class="ident" id="6157539">i</span><span class="op" id="6157540">++</span>&nbsp;<span class="op" id="6157543">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6157547">fa</span>&nbsp;<span class="op" id="6157550">:=</span>&nbsp;<span class="op" id="6157553">&amp;</span><span class="ident" id="6157554">ff</span><span class="op" id="6157556">.</span><span class="ident" id="6157557">Arches</span><span class="op" id="6157563">[</span><span class="ident" id="6157564">i</span><span class="op" id="6157565">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6157569">err</span>&nbsp;<span class="op" id="6157573">=</span>&nbsp;<span class="ident" id="6157575">binary</span><span class="op" id="6157581">.</span><span class="ident" id="6157582">Read</span><span class="op" id="6157586">(</span><span class="ident" id="6157587">sr</span><span class="op" id="6157589">,</span>&nbsp;<span class="ident" id="6157591">binary</span><span class="op" id="6157597">.</span><span class="ident" id="6157598">BigEndian</span><span class="op" id="6157607">,</span>&nbsp;<span class="op" id="6157609">&amp;</span><span class="ident" id="6157610">fa</span><span class="op" id="6157612">.</span><span class="ident" id="6157613">FatArchHeader</span><span class="op" id="6157626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6157630">if</span>&nbsp;<span class="ident" id="6157633">err</span>&nbsp;<span class="op" id="6157637">!=</span>&nbsp;<span class="builtintype" id="6157640">nil</span>&nbsp;<span class="op" id="6157644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6157649">return</span>&nbsp;<span class="builtintype" id="6157656">nil</span><span class="op" id="6157659">,</span>&nbsp;<span class="op" id="6157661">&amp;</span><span class="ident" id="6157662">FormatError</span><span class="op" id="6157673">{</span><span class="ident" id="6157674">offset</span><span class="op" id="6157680">,</span>&nbsp;<span class="string" id="6157682">&#34;invalid&nbsp;fat_arch&nbsp;header&#34;</span><span class="op" id="6157707">,</span>&nbsp;<span class="builtintype" id="6157709">nil</span><span class="op" id="6157712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6157716">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6157720">offset</span>&nbsp;<span class="op" id="6157727">+=</span>&nbsp;<span class="ident" id="6157730">fatArchHeaderSize</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6157751">fr</span>&nbsp;<span class="op" id="6157754">:=</span>&nbsp;<span class="ident" id="6157757">io</span><span class="op" id="6157759">.</span><span class="ident" id="6157760">NewSectionReader</span><span class="op" id="6157776">(</span><span class="ident" id="6157777">r</span><span class="op" id="6157778">,</span>&nbsp;<span class="ident" id="6157780">int64</span><span class="op" id="6157785">(</span><span class="ident" id="6157786">fa</span><span class="op" id="6157788">.</span><span class="ident" id="6157789">Offset</span><span class="op" id="6157795">)</span><span class="op" id="6157796">,</span>&nbsp;<span class="ident" id="6157798">int64</span><span class="op" id="6157803">(</span><span class="ident" id="6157804">fa</span><span class="op" id="6157806">.</span><span class="ident" id="6157807">Size</span><span class="op" id="6157811">)</span><span class="op" id="6157812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6157816">fa</span><span class="op" id="6157818">.</span><span class="ident" id="6157819">File</span><span class="op" id="6157823">,</span>&nbsp;<span class="ident" id="6157825">err</span>&nbsp;<span class="op" id="6157829">=</span>&nbsp;<span class="ident" id="6157831">NewFile</span><span class="op" id="6157838">(</span><span class="ident" id="6157839">fr</span><span class="op" id="6157841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6157845">if</span>&nbsp;<span class="ident" id="6157848">err</span>&nbsp;<span class="op" id="6157852">!=</span>&nbsp;<span class="builtintype" id="6157855">nil</span>&nbsp;<span class="op" id="6157859">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6157864">return</span>&nbsp;<span class="builtintype" id="6157871">nil</span><span class="op" id="6157874">,</span>&nbsp;<span class="ident" id="6157876">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6157882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6157887">//&nbsp;Make&nbsp;sure&nbsp;the&nbsp;architecture&nbsp;for&nbsp;this&nbsp;image&nbsp;is&nbsp;not&nbsp;duplicate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6157952">seenArch</span>&nbsp;<span class="op" id="6157961">:=</span>&nbsp;<span class="op" id="6157964">(</span><span class="ident" id="6157965">uint64</span><span class="op" id="6157971">(</span><span class="ident" id="6157972">fa</span><span class="op" id="6157974">.</span><span class="ident" id="6157975">Cpu</span><span class="op" id="6157978">)</span>&nbsp;<span class="op" id="6157980">&lt;&lt;</span>&nbsp;<span class="num" id="6157983">32</span><span class="op" id="6157985">)</span>&nbsp;<span class="op" id="6157987">|</span>&nbsp;<span class="ident" id="6157989">uint64</span><span class="op" id="6157995">(</span><span class="ident" id="6157996">fa</span><span class="op" id="6157998">.</span><span class="ident" id="6157999">SubCpu</span><span class="op" id="6158005">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6158009">if</span>&nbsp;<span class="ident" id="6158012">o</span><span class="op" id="6158013">,</span>&nbsp;<span class="ident" id="6158015">k</span>&nbsp;<span class="op" id="6158017">:=</span>&nbsp;<span class="ident" id="6158020">seenArches</span><span class="op" id="6158030">[</span><span class="ident" id="6158031">seenArch</span><span class="op" id="6158039">]</span><span class="op" id="6158040">;</span>&nbsp;<span class="ident" id="6158042">o</span>&nbsp;<span class="op" id="6158044">||</span>&nbsp;<span class="ident" id="6158047">k</span>&nbsp;<span class="op" id="6158049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6158054">return</span>&nbsp;<span class="builtintype" id="6158061">nil</span><span class="op" id="6158064">,</span>&nbsp;<span class="op" id="6158066">&amp;</span><span class="ident" id="6158067">FormatError</span><span class="op" id="6158078">{</span><span class="ident" id="6158079">offset</span><span class="op" id="6158085">,</span>&nbsp;<span class="ident" id="6158087">fmt</span><span class="op" id="6158090">.</span><span class="ident" id="6158091">Sprintf</span><span class="op" id="6158098">(</span><span class="string" id="6158099">&#34;duplicate&nbsp;architecture&nbsp;cpu=%v,&nbsp;subcpu=%#x&#34;</span><span class="op" id="6158142">,</span>&nbsp;<span class="ident" id="6158144">fa</span><span class="op" id="6158146">.</span><span class="ident" id="6158147">Cpu</span><span class="op" id="6158150">,</span>&nbsp;<span class="ident" id="6158152">fa</span><span class="op" id="6158154">.</span><span class="ident" id="6158155">SubCpu</span><span class="op" id="6158161">)</span><span class="op" id="6158162">,</span>&nbsp;<span class="builtintype" id="6158164">nil</span><span class="op" id="6158167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6158171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6158175">seenArches</span><span class="op" id="6158185">[</span><span class="ident" id="6158186">seenArch</span><span class="op" id="6158194">]</span>&nbsp;<span class="op" id="6158196">=</span>&nbsp;<span class="builtintype" id="6158198">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6158206">//&nbsp;Make&nbsp;sure&nbsp;the&nbsp;Mach-O&nbsp;type&nbsp;matches&nbsp;that&nbsp;of&nbsp;the&nbsp;first&nbsp;image.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6158270">if</span>&nbsp;<span class="ident" id="6158273">i</span>&nbsp;<span class="op" id="6158275">==</span>&nbsp;<span class="num" id="6158278">0</span>&nbsp;<span class="op" id="6158280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6158285">machoType</span>&nbsp;<span class="op" id="6158295">=</span>&nbsp;<span class="ident" id="6158297">fa</span><span class="op" id="6158299">.</span><span class="ident" id="6158300">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6158307">}</span>&nbsp;<span class="keyword" id="6158309">else</span>&nbsp;<span class="op" id="6158314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6158319">if</span>&nbsp;<span class="ident" id="6158322">fa</span><span class="op" id="6158324">.</span><span class="ident" id="6158325">Type</span>&nbsp;<span class="op" id="6158330">!=</span>&nbsp;<span class="ident" id="6158333">machoType</span>&nbsp;<span class="op" id="6158343">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6158349">return</span>&nbsp;<span class="builtintype" id="6158356">nil</span><span class="op" id="6158359">,</span>&nbsp;<span class="op" id="6158361">&amp;</span><span class="ident" id="6158362">FormatError</span><span class="op" id="6158373">{</span><span class="ident" id="6158374">offset</span><span class="op" id="6158380">,</span>&nbsp;<span class="ident" id="6158382">fmt</span><span class="op" id="6158385">.</span><span class="ident" id="6158386">Sprintf</span><span class="op" id="6158393">(</span><span class="string" id="6158394">&#34;Mach-O&nbsp;type&nbsp;for&nbsp;architecture&nbsp;#%d&nbsp;(type=%#x)&nbsp;does&nbsp;not&nbsp;match&nbsp;first&nbsp;(type=%#x)&#34;</span><span class="op" id="6158471">,</span>&nbsp;<span class="ident" id="6158473">i</span><span class="op" id="6158474">,</span>&nbsp;<span class="ident" id="6158476">fa</span><span class="op" id="6158478">.</span><span class="ident" id="6158479">Type</span><span class="op" id="6158483">,</span>&nbsp;<span class="ident" id="6158485">machoType</span><span class="op" id="6158494">)</span><span class="op" id="6158495">,</span>&nbsp;<span class="builtintype" id="6158497">nil</span><span class="op" id="6158500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6158505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6158509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6158512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6158516">return</span>&nbsp;<span class="op" id="6158523">&amp;</span><span class="ident" id="6158524">ff</span><span class="op" id="6158526">,</span>&nbsp;<span class="builtintype" id="6158528">nil</span><br>
<span class="lineno"></span><span class="op" id="6158532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6158535">//&nbsp;OpenFat&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;a&nbsp;Mach-O</span><br>
<span class="lineno"></span><span class="comment" id="6158617">//&nbsp;universal&nbsp;binary.</span><br>
<span class="lineno">125</span><span class="keyword" id="6158638">func</span>&nbsp;<span class="ident" id="6158643">OpenFat</span><span class="op" id="6158650">(</span><span class="ident" id="6158651">name</span>&nbsp;<span class="builtintype" id="6158656">string</span><span class="op" id="6158662">)</span>&nbsp;<span class="op" id="6158664">(</span><span class="ident" id="6158665">ff</span>&nbsp;<span class="op" id="6158668">*</span><span class="ident" id="6158669">FatFile</span><span class="op" id="6158676">,</span>&nbsp;<span class="ident" id="6158678">err</span>&nbsp;<span class="builtintype" id="6158682">error</span><span class="op" id="6158687">)</span>&nbsp;<span class="op" id="6158689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6158692">f</span><span class="op" id="6158693">,</span>&nbsp;<span class="ident" id="6158695">err</span>&nbsp;<span class="op" id="6158699">:=</span>&nbsp;<span class="ident" id="6158702">os</span><span class="op" id="6158704">.</span><span class="ident" id="6158705">Open</span><span class="op" id="6158709">(</span><span class="ident" id="6158710">name</span><span class="op" id="6158714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6158717">if</span>&nbsp;<span class="ident" id="6158720">err</span>&nbsp;<span class="op" id="6158724">!=</span>&nbsp;<span class="builtintype" id="6158727">nil</span>&nbsp;<span class="op" id="6158731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6158735">return</span>&nbsp;<span class="builtintype" id="6158742">nil</span><span class="op" id="6158745">,</span>&nbsp;<span class="ident" id="6158747">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6158752">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6158755">ff</span><span class="op" id="6158757">,</span>&nbsp;<span class="ident" id="6158759">err</span>&nbsp;<span class="op" id="6158763">=</span>&nbsp;<span class="ident" id="6158765">NewFatFile</span><span class="op" id="6158775">(</span><span class="ident" id="6158776">f</span><span class="op" id="6158777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6158780">if</span>&nbsp;<span class="ident" id="6158783">err</span>&nbsp;<span class="op" id="6158787">!=</span>&nbsp;<span class="builtintype" id="6158790">nil</span>&nbsp;<span class="op" id="6158794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6158798">f</span><span class="op" id="6158799">.</span><span class="ident" id="6158800">Close</span><span class="op" id="6158805">(</span><span class="op" id="6158806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6158810">return</span>&nbsp;<span class="builtintype" id="6158817">nil</span><span class="op" id="6158820">,</span>&nbsp;<span class="ident" id="6158822">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6158827">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6158830">ff</span><span class="op" id="6158832">.</span><span class="ident" id="6158833">closer</span>&nbsp;<span class="op" id="6158840">=</span>&nbsp;<span class="ident" id="6158842">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6158845">return</span><br>
<span class="lineno"></span><span class="op" id="6158852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6158855">func</span>&nbsp;<span class="op" id="6158860">(</span><span class="ident" id="6158861">ff</span>&nbsp;<span class="op" id="6158864">*</span><span class="ident" id="6158865">FatFile</span><span class="op" id="6158872">)</span>&nbsp;<span class="ident" id="6158874">Close</span><span class="op" id="6158879">(</span><span class="op" id="6158880">)</span>&nbsp;<span class="builtintype" id="6158882">error</span>&nbsp;<span class="op" id="6158888">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6158891">var</span>&nbsp;<span class="ident" id="6158895">err</span>&nbsp;<span class="builtintype" id="6158899">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6158906">if</span>&nbsp;<span class="ident" id="6158909">ff</span><span class="op" id="6158911">.</span><span class="ident" id="6158912">closer</span>&nbsp;<span class="op" id="6158919">!=</span>&nbsp;<span class="builtintype" id="6158922">nil</span>&nbsp;<span class="op" id="6158926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6158930">err</span>&nbsp;<span class="op" id="6158934">=</span>&nbsp;<span class="ident" id="6158936">ff</span><span class="op" id="6158938">.</span><span class="ident" id="6158939">closer</span><span class="op" id="6158945">.</span><span class="ident" id="6158946">Close</span><span class="op" id="6158951">(</span><span class="op" id="6158952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6158956">ff</span><span class="op" id="6158958">.</span><span class="ident" id="6158959">closer</span>&nbsp;<span class="op" id="6158966">=</span>&nbsp;<span class="builtintype" id="6158968">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6158973">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6158976">return</span>&nbsp;<span class="ident" id="6158983">err</span><br>
<span class="lineno"></span><span class="op" id="6158987">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
