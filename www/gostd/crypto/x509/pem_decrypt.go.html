<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html" class="current">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4615981">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4616036">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4616090">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4616141">package</span>&nbsp;<span class="ident" id="4616149">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4616155">//&nbsp;RFC&nbsp;1423&nbsp;describes&nbsp;the&nbsp;encryption&nbsp;of&nbsp;PEM&nbsp;blocks.&nbsp;The&nbsp;algorithm&nbsp;used&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4616229">//&nbsp;generate&nbsp;a&nbsp;key&nbsp;from&nbsp;the&nbsp;password&nbsp;was&nbsp;derived&nbsp;by&nbsp;looking&nbsp;at&nbsp;the&nbsp;OpenSSL</span><br>
<span class="lineno"></span><span class="comment" id="4616303">//&nbsp;implementation.</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="4616323">import</span>&nbsp;<span class="op" id="4616330">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4616333">&#34;crypto/aes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4616347">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4616364">&#34;crypto/des&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4616378">&#34;crypto/md5&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4616392">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4616408">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4616424">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4616434">&#34;io&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4616440">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="4616450">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4616453">type</span>&nbsp;<span class="ident" id="4616458">PEMCipher</span>&nbsp;<span class="builtintype" id="4616468">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4616473">//&nbsp;Possible&nbsp;values&nbsp;for&nbsp;the&nbsp;EncryptPEMBlock&nbsp;encryption&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="4616538">const</span>&nbsp;<span class="op" id="4616544">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4616547">_</span>&nbsp;<span class="ident" id="4616549"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616458">PEMCipher</a></span>&nbsp;<span class="op" id="4616559">=</span>&nbsp;<span class="ident" id="4616561">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4616567">PEMCipherDES</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4616581">PEMCipher3DES</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4616596">PEMCipherAES128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4616613">PEMCipherAES192</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4616630">PEMCipherAES256</span><br>
<span class="lineno"></span><span class="op" id="4616646">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="4616649">//&nbsp;rfc1423Algo&nbsp;holds&nbsp;a&nbsp;method&nbsp;for&nbsp;enciphering&nbsp;a&nbsp;PEM&nbsp;block.</span><br>
<span class="lineno"></span><span class="keyword" id="4616708">type</span>&nbsp;<span class="ident" id="4616713">rfc1423Algo</span>&nbsp;<span class="keyword" id="4616725">struct</span>&nbsp;<span class="op" id="4616732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4616735">cipher</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4616746"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616458">PEMCipher</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4616757">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4616768">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4616776">cipherFunc</span>&nbsp;<span class="keyword" id="4616787">func</span><span class="op" id="4616791">(</span><span class="ident" id="4616792">key</span>&nbsp;<span class="op" id="4616796">[</span><span class="op" id="4616797">]</span><span class="builtintype" id="4616798">byte</span><span class="op" id="4616802">)</span>&nbsp;<span class="op" id="4616804">(</span><span class="ident" id="4616805"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616347">cipher</a></span><span class="op" id="4616811">.</span><span class="ident" id="4616812"><a href="/gostd/crypto/cipher/cipher.go.html#4410698">Block</a></span><span class="op" id="4616817">,</span>&nbsp;<span class="builtintype" id="4616819">error</span><span class="op" id="4616824">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4616827">keySize</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4616838">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4616843">blockSize</span>&nbsp;&nbsp;<span class="builtintype" id="4616854">int</span><br>
<span class="lineno"></span><span class="op" id="4616858">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4616861">//&nbsp;rfc1423Algos&nbsp;holds&nbsp;a&nbsp;slice&nbsp;of&nbsp;the&nbsp;possible&nbsp;ways&nbsp;to&nbsp;encrypt&nbsp;a&nbsp;PEM</span><br>
<span class="lineno">45</span><span class="comment" id="4616929">//&nbsp;block.&nbsp;&nbsp;The&nbsp;ivSize&nbsp;numbers&nbsp;were&nbsp;taken&nbsp;from&nbsp;the&nbsp;OpenSSL&nbsp;source.</span><br>
<span class="lineno"></span><span class="keyword" id="4616995">var</span>&nbsp;<span class="ident" id="4616999">rfc1423Algos</span>&nbsp;<span class="op" id="4617012">=</span>&nbsp;<span class="op" id="4617014">[</span><span class="op" id="4617015">]</span><span class="ident" id="4617016"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616713">rfc1423Algo</a></span><span class="op" id="4617027">{</span><span class="op" id="4617028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617031"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616735">cipher</a></span><span class="op" id="4617037">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617043"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616567">PEMCipherDES</a></span><span class="op" id="4617055">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617058"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616757">name</a></span><span class="op" id="4617062">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4617070">&#34;DES-CBC&#34;</span><span class="op" id="4617079">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617082"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616776">cipherFunc</a></span><span class="op" id="4617092">:</span>&nbsp;<span class="ident" id="4617094"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616364">des</a></span><span class="op" id="4617097">.</span><span class="ident" id="4617098"><a href="/gostd/crypto/des/cipher.go.html#4597379">NewCipher</a></span><span class="op" id="4617107">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617110"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616827">keySize</a></span><span class="op" id="4617117">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4617122">8</span><span class="op" id="4617123">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617126"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616843">blockSize</a></span><span class="op" id="4617135">:</span>&nbsp;&nbsp;<span class="ident" id="4617138"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616364">des</a></span><span class="op" id="4617141">.</span><span class="ident" id="4617142"><a href="/gostd/crypto/des/cipher.go.html#4597084">BlockSize</a></span><span class="op" id="4617151">,</span><br>
<span class="lineno"></span><span class="op" id="4617153">}</span><span class="op" id="4617154">,</span>&nbsp;<span class="op" id="4617156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617159"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616735">cipher</a></span><span class="op" id="4617165">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617171"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616581">PEMCipher3DES</a></span><span class="op" id="4617184">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617187"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616757">name</a></span><span class="op" id="4617191">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4617199">&#34;DES-EDE3-CBC&#34;</span><span class="op" id="4617213">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617216"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616776">cipherFunc</a></span><span class="op" id="4617226">:</span>&nbsp;<span class="ident" id="4617228"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616364">des</a></span><span class="op" id="4617231">.</span><span class="ident" id="4617232"><a href="/gostd/crypto/des/cipher.go.html#4597979">NewTripleDESCipher</a></span><span class="op" id="4617250">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617253"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616827">keySize</a></span><span class="op" id="4617260">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4617265">24</span><span class="op" id="4617267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617270"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616843">blockSize</a></span><span class="op" id="4617279">:</span>&nbsp;&nbsp;<span class="ident" id="4617282"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616364">des</a></span><span class="op" id="4617285">.</span><span class="ident" id="4617286"><a href="/gostd/crypto/des/cipher.go.html#4597084">BlockSize</a></span><span class="op" id="4617295">,</span><br>
<span class="lineno"></span><span class="op" id="4617297">}</span><span class="op" id="4617298">,</span>&nbsp;<span class="op" id="4617300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617303"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616735">cipher</a></span><span class="op" id="4617309">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617315"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616596">PEMCipherAES128</a></span><span class="op" id="4617330">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617333"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616757">name</a></span><span class="op" id="4617337">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4617345">&#34;AES-128-CBC&#34;</span><span class="op" id="4617358">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617361"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616776">cipherFunc</a></span><span class="op" id="4617371">:</span>&nbsp;<span class="ident" id="4617373"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616333">aes</a></span><span class="op" id="4617376">.</span><span class="ident" id="4617377"><a href="/gostd/crypto/aes/cipher.go.html#4373344">NewCipher</a></span><span class="op" id="4617386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617389"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616827">keySize</a></span><span class="op" id="4617396">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4617401">16</span><span class="op" id="4617403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617406"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616843">blockSize</a></span><span class="op" id="4617415">:</span>&nbsp;&nbsp;<span class="ident" id="4617418"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616333">aes</a></span><span class="op" id="4617421">.</span><span class="ident" id="4617422"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="4617431">,</span><br>
<span class="lineno"></span><span class="op" id="4617433">}</span><span class="op" id="4617434">,</span>&nbsp;<span class="op" id="4617436">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617439"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616735">cipher</a></span><span class="op" id="4617445">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617451"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616613">PEMCipherAES192</a></span><span class="op" id="4617466">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617469"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616757">name</a></span><span class="op" id="4617473">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4617481">&#34;AES-192-CBC&#34;</span><span class="op" id="4617494">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617497"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616776">cipherFunc</a></span><span class="op" id="4617507">:</span>&nbsp;<span class="ident" id="4617509"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616333">aes</a></span><span class="op" id="4617512">.</span><span class="ident" id="4617513"><a href="/gostd/crypto/aes/cipher.go.html#4373344">NewCipher</a></span><span class="op" id="4617522">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617525"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616827">keySize</a></span><span class="op" id="4617532">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4617537">24</span><span class="op" id="4617539">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617542"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616843">blockSize</a></span><span class="op" id="4617551">:</span>&nbsp;&nbsp;<span class="ident" id="4617554"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616333">aes</a></span><span class="op" id="4617557">.</span><span class="ident" id="4617558"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="4617567">,</span><br>
<span class="lineno">70</span><span class="op" id="4617569">}</span><span class="op" id="4617570">,</span>&nbsp;<span class="op" id="4617572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617575"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616735">cipher</a></span><span class="op" id="4617581">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617587"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616630">PEMCipherAES256</a></span><span class="op" id="4617602">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617605"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616757">name</a></span><span class="op" id="4617609">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4617617">&#34;AES-256-CBC&#34;</span><span class="op" id="4617630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617633"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616776">cipherFunc</a></span><span class="op" id="4617643">:</span>&nbsp;<span class="ident" id="4617645"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616333">aes</a></span><span class="op" id="4617648">.</span><span class="ident" id="4617649"><a href="/gostd/crypto/aes/cipher.go.html#4373344">NewCipher</a></span><span class="op" id="4617658">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617661"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616827">keySize</a></span><span class="op" id="4617668">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4617673">32</span><span class="op" id="4617675">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617678"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616843">blockSize</a></span><span class="op" id="4617687">:</span>&nbsp;&nbsp;<span class="ident" id="4617690"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616333">aes</a></span><span class="op" id="4617693">.</span><span class="ident" id="4617694"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="4617703">,</span><br>
<span class="lineno"></span><span class="op" id="4617705">}</span><span class="op" id="4617706">,</span><br>
<span class="lineno"></span><span class="op" id="4617708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4617711">//&nbsp;deriveKey&nbsp;uses&nbsp;a&nbsp;key&nbsp;derivation&nbsp;function&nbsp;to&nbsp;stretch&nbsp;the&nbsp;password&nbsp;into&nbsp;a&nbsp;key</span><br>
<span class="lineno">80</span><span class="comment" id="4617790">//&nbsp;with&nbsp;the&nbsp;number&nbsp;of&nbsp;bits&nbsp;our&nbsp;cipher&nbsp;requires.&nbsp;This&nbsp;algorithm&nbsp;was&nbsp;derived&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="4617870">//&nbsp;the&nbsp;OpenSSL&nbsp;source.</span><br>
<span class="lineno"></span><span class="keyword" id="4617893">func</span>&nbsp;<span class="op" id="4617898">(</span><span class="ident" id="4617899">c</span>&nbsp;<span class="ident" id="4617901"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616713">rfc1423Algo</a></span><span class="op" id="4617912">)</span>&nbsp;<span class="ident" id="4617914">deriveKey</span><span class="op" id="4617923">(</span><span class="ident" id="4617924">password</span><span class="op" id="4617932">,</span>&nbsp;<span class="ident" id="4617934">salt</span>&nbsp;<span class="op" id="4617939">[</span><span class="op" id="4617940">]</span><span class="builtintype" id="4617941">byte</span><span class="op" id="4617945">)</span>&nbsp;<span class="op" id="4617947">[</span><span class="op" id="4617948">]</span><span class="builtintype" id="4617949">byte</span>&nbsp;<span class="op" id="4617954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617957">hash</span>&nbsp;<span class="op" id="4617962">:=</span>&nbsp;<span class="ident" id="4617965"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616378">md5</a></span><span class="op" id="4617968">.</span><span class="ident" id="4617969"><a href="/gostd/crypto/md5/md5.go.html#4710829">New</a></span><span class="op" id="4617972">(</span><span class="op" id="4617973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4617976">out</span>&nbsp;<span class="op" id="4617980">:=</span>&nbsp;<span class="builtinfunc" id="4617983">make</span><span class="op" id="4617987">(</span><span class="op" id="4617988">[</span><span class="op" id="4617989">]</span><span class="builtintype" id="4617990">byte</span><span class="op" id="4617994">,</span>&nbsp;<span class="ident" id="4617996"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4617899">c</a></span><span class="op" id="4617997">.</span><span class="ident" id="4617998"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616827">keySize</a></span><span class="op" id="4618005">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4618008">var</span>&nbsp;<span class="ident" id="4618012">digest</span>&nbsp;<span class="op" id="4618019">[</span><span class="op" id="4618020">]</span><span class="builtintype" id="4618021">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4618028">for</span>&nbsp;<span class="ident" id="4618032">i</span>&nbsp;<span class="op" id="4618034">:=</span>&nbsp;<span class="num" id="4618037">0</span><span class="op" id="4618038">;</span>&nbsp;<span class="ident" id="4618040"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4618032">i</a></span>&nbsp;<span class="op" id="4618042">&lt;</span>&nbsp;<span class="builtinfunc" id="4618044">len</span><span class="op" id="4618047">(</span><span class="ident" id="4618048"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4617976">out</a></span><span class="op" id="4618051">)</span><span class="op" id="4618052">;</span>&nbsp;<span class="ident" id="4618054"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4618032">i</a></span>&nbsp;<span class="op" id="4618056">+=</span>&nbsp;<span class="builtinfunc" id="4618059">len</span><span class="op" id="4618062">(</span><span class="ident" id="4618063"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4618012">digest</a></span><span class="op" id="4618069">)</span>&nbsp;<span class="op" id="4618071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4618075"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4617957">hash</a></span><span class="op" id="4618079">.</span><span class="ident" id="4618080"><a href="/gostd/hash/hash.go.html#3014443">Reset</a></span><span class="op" id="4618085">(</span><span class="op" id="4618086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4618090"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4617957">hash</a></span><span class="op" id="4618094">.</span><span class="ident" id="4618095"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4618100">(</span><span class="ident" id="4618101"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4618012">digest</a></span><span class="op" id="4618107">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4618111"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4617957">hash</a></span><span class="op" id="4618115">.</span><span class="ident" id="4618116"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4618121">(</span><span class="ident" id="4618122"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4617924">password</a></span><span class="op" id="4618130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4618134"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4617957">hash</a></span><span class="op" id="4618138">.</span><span class="ident" id="4618139"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4618144">(</span><span class="ident" id="4618145"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4617934">salt</a></span><span class="op" id="4618149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4618153"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4618012">digest</a></span>&nbsp;<span class="op" id="4618160">=</span>&nbsp;<span class="ident" id="4618162"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4617957">hash</a></span><span class="op" id="4618166">.</span><span class="ident" id="4618167"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4618170">(</span><span class="ident" id="4618171"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4618012">digest</a></span><span class="op" id="4618177">[</span><span class="op" id="4618178">:</span><span class="num" id="4618179">0</span><span class="op" id="4618180">]</span><span class="op" id="4618181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4618185">copy</span><span class="op" id="4618189">(</span><span class="ident" id="4618190"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4617976">out</a></span><span class="op" id="4618193">[</span><span class="ident" id="4618194"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4618032">i</a></span><span class="op" id="4618195">:</span><span class="op" id="4618196">]</span><span class="op" id="4618197">,</span>&nbsp;<span class="ident" id="4618199"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4618012">digest</a></span><span class="op" id="4618205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4618208">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4618211">return</span>&nbsp;<span class="ident" id="4618218"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4617976">out</a></span><br>
<span class="lineno"></span><span class="op" id="4618222">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4618225">//&nbsp;IsEncryptedPEMBlock&nbsp;returns&nbsp;if&nbsp;the&nbsp;PEM&nbsp;block&nbsp;is&nbsp;password&nbsp;encrypted.</span><br>
<span class="lineno"></span><span class="keyword" id="4618296">func</span>&nbsp;<span class="ident" id="4618301">IsEncryptedPEMBlock</span><span class="op" id="4618320">(</span><span class="ident" id="4618321">b</span>&nbsp;<span class="op" id="4618323">*</span><span class="ident" id="4618324"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616408">pem</a></span><span class="op" id="4618327">.</span><span class="ident" id="4618328"><a href="/gostd/encoding/pem/pem.go.html#4703705">Block</a></span><span class="op" id="4618333">)</span>&nbsp;<span class="builtintype" id="4618335">bool</span>&nbsp;<span class="op" id="4618340">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4618343">_</span><span class="op" id="4618344">,</span>&nbsp;<span class="ident" id="4618346">ok</span>&nbsp;<span class="op" id="4618349">:=</span>&nbsp;<span class="ident" id="4618352"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4618321">b</a></span><span class="op" id="4618353">.</span><span class="ident" id="4618354"><a href="/gostd/encoding/pem/pem.go.html#4703811">Headers</a></span><span class="op" id="4618361">[</span><span class="string" id="4618362">&#34;DEK-Info&#34;</span><span class="op" id="4618372">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4618375">return</span>&nbsp;<span class="ident" id="4618382"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4618346">ok</a></span><br>
<span class="lineno"></span><span class="op" id="4618385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4618388">//&nbsp;IncorrectPasswordError&nbsp;is&nbsp;returned&nbsp;when&nbsp;an&nbsp;incorrect&nbsp;password&nbsp;is&nbsp;detected.</span><br>
<span class="lineno">105</span><span class="keyword" id="4618466">var</span>&nbsp;<span class="ident" id="4618470">IncorrectPasswordError</span>&nbsp;<span class="op" id="4618493">=</span>&nbsp;<span class="ident" id="4618495"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616424">errors</a></span><span class="op" id="4618501">.</span><span class="ident" id="4618502"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4618505">(</span><span class="string" id="4618506">&#34;x509:&nbsp;decryption&nbsp;password&nbsp;incorrect&#34;</span><span class="op" id="4618543">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4618546">//&nbsp;DecryptPEMBlock&nbsp;takes&nbsp;a&nbsp;password&nbsp;encrypted&nbsp;PEM&nbsp;block&nbsp;and&nbsp;the&nbsp;password&nbsp;used&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4618627">//&nbsp;encrypt&nbsp;it&nbsp;and&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;decrypted&nbsp;DER&nbsp;encoded&nbsp;bytes.&nbsp;It&nbsp;inspects</span><br>
<span class="lineno"></span><span class="comment" id="4618705">//&nbsp;the&nbsp;DEK-Info&nbsp;header&nbsp;to&nbsp;determine&nbsp;the&nbsp;algorithm&nbsp;used&nbsp;for&nbsp;decryption.&nbsp;If&nbsp;no</span><br>
<span class="lineno">110</span><span class="comment" id="4618782">//&nbsp;DEK-Info&nbsp;header&nbsp;is&nbsp;present,&nbsp;an&nbsp;error&nbsp;is&nbsp;returned.&nbsp;If&nbsp;an&nbsp;incorrect&nbsp;password</span><br>
<span class="lineno"></span><span class="comment" id="4618860">//&nbsp;is&nbsp;detected&nbsp;an&nbsp;IncorrectPasswordError&nbsp;is&nbsp;returned.</span><br>
<span class="lineno"></span><span class="keyword" id="4618914">func</span>&nbsp;<span class="ident" id="4618919">DecryptPEMBlock</span><span class="op" id="4618934">(</span><span class="ident" id="4618935">b</span>&nbsp;<span class="op" id="4618937">*</span><span class="ident" id="4618938"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616408">pem</a></span><span class="op" id="4618941">.</span><span class="ident" id="4618942"><a href="/gostd/encoding/pem/pem.go.html#4703705">Block</a></span><span class="op" id="4618947">,</span>&nbsp;<span class="ident" id="4618949">password</span>&nbsp;<span class="op" id="4618958">[</span><span class="op" id="4618959">]</span><span class="builtintype" id="4618960">byte</span><span class="op" id="4618964">)</span>&nbsp;<span class="op" id="4618966">(</span><span class="op" id="4618967">[</span><span class="op" id="4618968">]</span><span class="builtintype" id="4618969">byte</span><span class="op" id="4618973">,</span>&nbsp;<span class="builtintype" id="4618975">error</span><span class="op" id="4618980">)</span>&nbsp;<span class="op" id="4618982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4618985">dek</span><span class="op" id="4618988">,</span>&nbsp;<span class="ident" id="4618990">ok</span>&nbsp;<span class="op" id="4618993">:=</span>&nbsp;<span class="ident" id="4618996"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4618935">b</a></span><span class="op" id="4618997">.</span><span class="ident" id="4618998"><a href="/gostd/encoding/pem/pem.go.html#4703811">Headers</a></span><span class="op" id="4619005">[</span><span class="string" id="4619006">&#34;DEK-Info&#34;</span><span class="op" id="4619016">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4619019">if</span>&nbsp;<span class="op" id="4619022">!</span><span class="ident" id="4619023"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4618990">ok</a></span>&nbsp;<span class="op" id="4619026">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4619030">return</span>&nbsp;<span class="builtintype" id="4619037">nil</span><span class="op" id="4619040">,</span>&nbsp;<span class="ident" id="4619042"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616424">errors</a></span><span class="op" id="4619048">.</span><span class="ident" id="4619049"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4619052">(</span><span class="string" id="4619053">&#34;x509:&nbsp;no&nbsp;DEK-Info&nbsp;header&nbsp;in&nbsp;block&#34;</span><span class="op" id="4619088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4619091">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4619095">idx</span>&nbsp;<span class="op" id="4619099">:=</span>&nbsp;<span class="ident" id="4619102"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616440">strings</a></span><span class="op" id="4619109">.</span><span class="ident" id="4619110"><a href="/gostd/strings/strings.go.html#2968883">Index</a></span><span class="op" id="4619115">(</span><span class="ident" id="4619116"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4618985">dek</a></span><span class="op" id="4619119">,</span>&nbsp;<span class="string" id="4619121">&#34;,&#34;</span><span class="op" id="4619124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4619127">if</span>&nbsp;<span class="ident" id="4619130"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4619095">idx</a></span>&nbsp;<span class="op" id="4619134">==</span>&nbsp;<span class="op" id="4619137">-</span><span class="num" id="4619138">1</span>&nbsp;<span class="op" id="4619140">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4619144">return</span>&nbsp;<span class="builtintype" id="4619151">nil</span><span class="op" id="4619154">,</span>&nbsp;<span class="ident" id="4619156"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616424">errors</a></span><span class="op" id="4619162">.</span><span class="ident" id="4619163"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4619166">(</span><span class="string" id="4619167">&#34;x509:&nbsp;malformed&nbsp;DEK-Info&nbsp;header&#34;</span><span class="op" id="4619200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4619203">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4619207">mode</span><span class="op" id="4619211">,</span>&nbsp;<span class="ident" id="4619213">hexIV</span>&nbsp;<span class="op" id="4619219">:=</span>&nbsp;<span class="ident" id="4619222"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4618985">dek</a></span><span class="op" id="4619225">[</span><span class="op" id="4619226">:</span><span class="ident" id="4619227"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4619095">idx</a></span><span class="op" id="4619230">]</span><span class="op" id="4619231">,</span>&nbsp;<span class="ident" id="4619233"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4618985">dek</a></span><span class="op" id="4619236">[</span><span class="ident" id="4619237"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4619095">idx</a></span><span class="op" id="4619240">+</span><span class="num" id="4619241">1</span><span class="op" id="4619242">:</span><span class="op" id="4619243">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4619246">ciph</span>&nbsp;<span class="op" id="4619251">:=</span>&nbsp;<span class="ident" id="4619254"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4621970">cipherByName</a></span><span class="op" id="4619266">(</span><span class="ident" id="4619267"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4619207">mode</a></span><span class="op" id="4619271">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4619274">if</span>&nbsp;<span class="ident" id="4619277"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4619246">ciph</a></span>&nbsp;<span class="op" id="4619282">==</span>&nbsp;<span class="builtintype" id="4619285">nil</span>&nbsp;<span class="op" id="4619289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4619293">return</span>&nbsp;<span class="builtintype" id="4619300">nil</span><span class="op" id="4619303">,</span>&nbsp;<span class="ident" id="4619305"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616424">errors</a></span><span class="op" id="4619311">.</span><span class="ident" id="4619312"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4619315">(</span><span class="string" id="4619316">&#34;x509:&nbsp;unknown&nbsp;encryption&nbsp;mode&#34;</span><span class="op" id="4619347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4619350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4619353">iv</span><span class="op" id="4619355">,</span>&nbsp;<span class="ident" id="4619357">err</span>&nbsp;<span class="op" id="4619361">:=</span>&nbsp;<span class="ident" id="4619364"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616392">hex</a></span><span class="op" id="4619367">.</span><span class="ident" id="4619368"><a href="/gostd/encoding/hex/hex.go.html#4721563">DecodeString</a></span><span class="op" id="4619380">(</span><span class="ident" id="4619381"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4619213">hexIV</a></span><span class="op" id="4619386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4619389">if</span>&nbsp;<span class="ident" id="4619392"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4619357">err</a></span>&nbsp;<span class="op" id="4619396">!=</span>&nbsp;<span class="builtintype" id="4619399">nil</span>&nbsp;<span class="op" id="4619403">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4619407">return</span>&nbsp;<span class="builtintype" id="4619414">nil</span><span class="op" id="4619417">,</span>&nbsp;<span class="ident" id="4619419"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4619357">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4619424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4619427">if</span>&nbsp;<span class="builtinfunc" id="4619430">len</span><span class="op" id="4619433">(</span><span class="ident" id="4619434"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4619353">iv</a></span><span class="op" id="4619436">)</span>&nbsp;<span class="op" id="4619438">!=</span>&nbsp;<span class="ident" id="4619441"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4619246">ciph</a></span><span class="op" id="4619445">.</span><span class="ident" id="4619446"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616843">blockSize</a></span>&nbsp;<span class="op" id="4619456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4619460">return</span>&nbsp;<span class="builtintype" id="4619467">nil</span><span class="op" id="4619470">,</span>&nbsp;<span class="ident" id="4619472"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616424">errors</a></span><span class="op" id="4619478">.</span><span class="ident" id="4619479"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4619482">(</span><span class="string" id="4619483">&#34;x509:&nbsp;incorrect&nbsp;IV&nbsp;size&#34;</span><span class="op" id="4619508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4619511">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4619515">//&nbsp;Based&nbsp;on&nbsp;the&nbsp;OpenSSL&nbsp;implementation.&nbsp;The&nbsp;salt&nbsp;is&nbsp;the&nbsp;first&nbsp;8&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4619586">//&nbsp;of&nbsp;the&nbsp;initialization&nbsp;vector.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4619620">key</span>&nbsp;<span class="op" id="4619624">:=</span>&nbsp;<span class="ident" id="4619627"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4619246">ciph</a></span><span class="op" id="4619631">.</span><span class="ident" id="4619632"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4617914">deriveKey</a></span><span class="op" id="4619641">(</span><span class="ident" id="4619642"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4618949">password</a></span><span class="op" id="4619650">,</span>&nbsp;<span class="ident" id="4619652"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4619353">iv</a></span><span class="op" id="4619654">[</span><span class="op" id="4619655">:</span><span class="num" id="4619656">8</span><span class="op" id="4619657">]</span><span class="op" id="4619658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4619661">block</span><span class="op" id="4619666">,</span>&nbsp;<span class="ident" id="4619668"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4619357">err</a></span>&nbsp;<span class="op" id="4619672">:=</span>&nbsp;<span class="ident" id="4619675"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4619246">ciph</a></span><span class="op" id="4619679">.</span><span class="ident" id="4619680"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616776">cipherFunc</a></span><span class="op" id="4619690">(</span><span class="ident" id="4619691"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4619620">key</a></span><span class="op" id="4619694">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4619697">if</span>&nbsp;<span class="ident" id="4619700"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4619357">err</a></span>&nbsp;<span class="op" id="4619704">!=</span>&nbsp;<span class="builtintype" id="4619707">nil</span>&nbsp;<span class="op" id="4619711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4619715">return</span>&nbsp;<span class="builtintype" id="4619722">nil</span><span class="op" id="4619725">,</span>&nbsp;<span class="ident" id="4619727"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4619357">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4619732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4619736">data</span>&nbsp;<span class="op" id="4619741">:=</span>&nbsp;<span class="builtinfunc" id="4619744">make</span><span class="op" id="4619748">(</span><span class="op" id="4619749">[</span><span class="op" id="4619750">]</span><span class="builtintype" id="4619751">byte</span><span class="op" id="4619755">,</span>&nbsp;<span class="builtinfunc" id="4619757">len</span><span class="op" id="4619760">(</span><span class="ident" id="4619761"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4618935">b</a></span><span class="op" id="4619762">.</span><span class="ident" id="4619763"><a href="/gostd/encoding/pem/pem.go.html#4703859">Bytes</a></span><span class="op" id="4619768">)</span><span class="op" id="4619769">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4619772">dec</span>&nbsp;<span class="op" id="4619776">:=</span>&nbsp;<span class="ident" id="4619779"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616347">cipher</a></span><span class="op" id="4619785">.</span><span class="ident" id="4619786"><a href="/gostd/crypto/cipher/cbc.go.html#4406839">NewCBCDecrypter</a></span><span class="op" id="4619801">(</span><span class="ident" id="4619802"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4619661">block</a></span><span class="op" id="4619807">,</span>&nbsp;<span class="ident" id="4619809"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4619353">iv</a></span><span class="op" id="4619811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4619814"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4619772">dec</a></span><span class="op" id="4619817">.</span><span class="ident" id="4619818"><a href="/gostd/crypto/cipher/cipher.go.html#4411618">CryptBlocks</a></span><span class="op" id="4619829">(</span><span class="ident" id="4619830"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4619736">data</a></span><span class="op" id="4619834">,</span>&nbsp;<span class="ident" id="4619836"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4618935">b</a></span><span class="op" id="4619837">.</span><span class="ident" id="4619838"><a href="/gostd/encoding/pem/pem.go.html#4703859">Bytes</a></span><span class="op" id="4619843">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4619847">//&nbsp;Blocks&nbsp;are&nbsp;padded&nbsp;using&nbsp;a&nbsp;scheme&nbsp;where&nbsp;the&nbsp;last&nbsp;n&nbsp;bytes&nbsp;of&nbsp;padding&nbsp;are&nbsp;all</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4619926">//&nbsp;equal&nbsp;to&nbsp;n.&nbsp;It&nbsp;can&nbsp;pad&nbsp;from&nbsp;1&nbsp;to&nbsp;blocksize&nbsp;bytes&nbsp;inclusive.&nbsp;See&nbsp;RFC&nbsp;1423.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4620004">//&nbsp;For&nbsp;example:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4620021">//&nbsp;&nbsp;&nbsp;&nbsp;[x&nbsp;y&nbsp;z&nbsp;2&nbsp;2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4620037">//&nbsp;&nbsp;&nbsp;&nbsp;[x&nbsp;y&nbsp;7&nbsp;7&nbsp;7&nbsp;7&nbsp;7&nbsp;7&nbsp;7]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4620061">//&nbsp;If&nbsp;we&nbsp;detect&nbsp;a&nbsp;bad&nbsp;padding,&nbsp;we&nbsp;assume&nbsp;it&nbsp;is&nbsp;an&nbsp;invalid&nbsp;password.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4620130">dlen</span>&nbsp;<span class="op" id="4620135">:=</span>&nbsp;<span class="builtinfunc" id="4620138">len</span><span class="op" id="4620141">(</span><span class="ident" id="4620142"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4619736">data</a></span><span class="op" id="4620146">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4620149">if</span>&nbsp;<span class="ident" id="4620152"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620130">dlen</a></span>&nbsp;<span class="op" id="4620157">==</span>&nbsp;<span class="num" id="4620160">0</span>&nbsp;<span class="op" id="4620162">||</span>&nbsp;<span class="ident" id="4620165"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620130">dlen</a></span><span class="op" id="4620169">%</span><span class="ident" id="4620170"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4619246">ciph</a></span><span class="op" id="4620174">.</span><span class="ident" id="4620175"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616843">blockSize</a></span>&nbsp;<span class="op" id="4620185">!=</span>&nbsp;<span class="num" id="4620188">0</span>&nbsp;<span class="op" id="4620190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4620194">return</span>&nbsp;<span class="builtintype" id="4620201">nil</span><span class="op" id="4620204">,</span>&nbsp;<span class="ident" id="4620206"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616424">errors</a></span><span class="op" id="4620212">.</span><span class="ident" id="4620213"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4620216">(</span><span class="string" id="4620217">&#34;x509:&nbsp;invalid&nbsp;padding&#34;</span><span class="op" id="4620240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4620243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4620246">last</span>&nbsp;<span class="op" id="4620251">:=</span>&nbsp;<span class="builtintype" id="4620254">int</span><span class="op" id="4620257">(</span><span class="ident" id="4620258"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4619736">data</a></span><span class="op" id="4620262">[</span><span class="ident" id="4620263"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620130">dlen</a></span><span class="op" id="4620267">-</span><span class="num" id="4620268">1</span><span class="op" id="4620269">]</span><span class="op" id="4620270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4620273">if</span>&nbsp;<span class="ident" id="4620276"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620130">dlen</a></span>&nbsp;<span class="op" id="4620281">&lt;</span>&nbsp;<span class="ident" id="4620283"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620246">last</a></span>&nbsp;<span class="op" id="4620288">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4620292">return</span>&nbsp;<span class="builtintype" id="4620299">nil</span><span class="op" id="4620302">,</span>&nbsp;<span class="ident" id="4620304"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4618470">IncorrectPasswordError</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4620328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4620331">if</span>&nbsp;<span class="ident" id="4620334"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620246">last</a></span>&nbsp;<span class="op" id="4620339">==</span>&nbsp;<span class="num" id="4620342">0</span>&nbsp;<span class="op" id="4620344">||</span>&nbsp;<span class="ident" id="4620347"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620246">last</a></span>&nbsp;<span class="op" id="4620352">&gt;</span>&nbsp;<span class="ident" id="4620354"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4619246">ciph</a></span><span class="op" id="4620358">.</span><span class="ident" id="4620359"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616843">blockSize</a></span>&nbsp;<span class="op" id="4620369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4620373">return</span>&nbsp;<span class="builtintype" id="4620380">nil</span><span class="op" id="4620383">,</span>&nbsp;<span class="ident" id="4620385"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4618470">IncorrectPasswordError</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4620409">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4620412">for</span>&nbsp;<span class="ident" id="4620416">_</span><span class="op" id="4620417">,</span>&nbsp;<span class="ident" id="4620419">val</span>&nbsp;<span class="op" id="4620423">:=</span>&nbsp;<span class="keyword" id="4620426">range</span>&nbsp;<span class="ident" id="4620432"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4619736">data</a></span><span class="op" id="4620436">[</span><span class="ident" id="4620437"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620130">dlen</a></span><span class="op" id="4620441">-</span><span class="ident" id="4620442"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620246">last</a></span><span class="op" id="4620446">:</span><span class="op" id="4620447">]</span>&nbsp;<span class="op" id="4620449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4620453">if</span>&nbsp;<span class="builtintype" id="4620456">int</span><span class="op" id="4620459">(</span><span class="ident" id="4620460"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620419">val</a></span><span class="op" id="4620463">)</span>&nbsp;<span class="op" id="4620465">!=</span>&nbsp;<span class="ident" id="4620468"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620246">last</a></span>&nbsp;<span class="op" id="4620473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4620478">return</span>&nbsp;<span class="builtintype" id="4620485">nil</span><span class="op" id="4620488">,</span>&nbsp;<span class="ident" id="4620490"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4618470">IncorrectPasswordError</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4620515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4620518">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4620521">return</span>&nbsp;<span class="ident" id="4620528"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4619736">data</a></span><span class="op" id="4620532">[</span><span class="op" id="4620533">:</span><span class="ident" id="4620534"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620130">dlen</a></span><span class="op" id="4620538">-</span><span class="ident" id="4620539"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620246">last</a></span><span class="op" id="4620543">]</span><span class="op" id="4620544">,</span>&nbsp;<span class="builtintype" id="4620546">nil</span><br>
<span class="lineno"></span><span class="op" id="4620550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4620553">//&nbsp;EncryptPEMBlock&nbsp;returns&nbsp;a&nbsp;PEM&nbsp;block&nbsp;of&nbsp;the&nbsp;specified&nbsp;type&nbsp;holding&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4620626">//&nbsp;given&nbsp;DER-encoded&nbsp;data&nbsp;encrypted&nbsp;with&nbsp;the&nbsp;specified&nbsp;algorithm&nbsp;and</span><br>
<span class="lineno">175</span><span class="comment" id="4620695">//&nbsp;password.</span><br>
<span class="lineno"></span><span class="keyword" id="4620708">func</span>&nbsp;<span class="ident" id="4620713">EncryptPEMBlock</span><span class="op" id="4620728">(</span><span class="ident" id="4620729">rand</span>&nbsp;<span class="ident" id="4620734"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616434">io</a></span><span class="op" id="4620736">.</span><span class="ident" id="4620737"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="4620743">,</span>&nbsp;<span class="ident" id="4620745">blockType</span>&nbsp;<span class="builtintype" id="4620755">string</span><span class="op" id="4620761">,</span>&nbsp;<span class="ident" id="4620763">data</span><span class="op" id="4620767">,</span>&nbsp;<span class="ident" id="4620769">password</span>&nbsp;<span class="op" id="4620778">[</span><span class="op" id="4620779">]</span><span class="builtintype" id="4620780">byte</span><span class="op" id="4620784">,</span>&nbsp;<span class="ident" id="4620786">alg</span>&nbsp;<span class="ident" id="4620790"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616458">PEMCipher</a></span><span class="op" id="4620799">)</span>&nbsp;<span class="op" id="4620801">(</span><span class="op" id="4620802">*</span><span class="ident" id="4620803"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616408">pem</a></span><span class="op" id="4620806">.</span><span class="ident" id="4620807"><a href="/gostd/encoding/pem/pem.go.html#4703705">Block</a></span><span class="op" id="4620812">,</span>&nbsp;<span class="builtintype" id="4620814">error</span><span class="op" id="4620819">)</span>&nbsp;<span class="op" id="4620821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4620824">ciph</span>&nbsp;<span class="op" id="4620829">:=</span>&nbsp;<span class="ident" id="4620832"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4622133">cipherByKey</a></span><span class="op" id="4620843">(</span><span class="ident" id="4620844"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620786">alg</a></span><span class="op" id="4620847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4620850">if</span>&nbsp;<span class="ident" id="4620853"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620824">ciph</a></span>&nbsp;<span class="op" id="4620858">==</span>&nbsp;<span class="builtintype" id="4620861">nil</span>&nbsp;<span class="op" id="4620865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4620869">return</span>&nbsp;<span class="builtintype" id="4620876">nil</span><span class="op" id="4620879">,</span>&nbsp;<span class="ident" id="4620881"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616424">errors</a></span><span class="op" id="4620887">.</span><span class="ident" id="4620888"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4620891">(</span><span class="string" id="4620892">&#34;x509:&nbsp;unknown&nbsp;encryption&nbsp;mode&#34;</span><span class="op" id="4620923">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4620926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4620929">iv</span>&nbsp;<span class="op" id="4620932">:=</span>&nbsp;<span class="builtinfunc" id="4620935">make</span><span class="op" id="4620939">(</span><span class="op" id="4620940">[</span><span class="op" id="4620941">]</span><span class="builtintype" id="4620942">byte</span><span class="op" id="4620946">,</span>&nbsp;<span class="ident" id="4620948"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620824">ciph</a></span><span class="op" id="4620952">.</span><span class="ident" id="4620953"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616843">blockSize</a></span><span class="op" id="4620962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4620965">if</span>&nbsp;<span class="ident" id="4620968">_</span><span class="op" id="4620969">,</span>&nbsp;<span class="ident" id="4620971">err</span>&nbsp;<span class="op" id="4620975">:=</span>&nbsp;<span class="ident" id="4620978"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616434">io</a></span><span class="op" id="4620980">.</span><span class="ident" id="4620981"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="4620989">(</span><span class="ident" id="4620990"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620729">rand</a></span><span class="op" id="4620994">,</span>&nbsp;<span class="ident" id="4620996"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620929">iv</a></span><span class="op" id="4620998">)</span><span class="op" id="4620999">;</span>&nbsp;<span class="ident" id="4621001"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620971">err</a></span>&nbsp;<span class="op" id="4621005">!=</span>&nbsp;<span class="builtintype" id="4621008">nil</span>&nbsp;<span class="op" id="4621012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4621016">return</span>&nbsp;<span class="builtintype" id="4621023">nil</span><span class="op" id="4621026">,</span>&nbsp;<span class="ident" id="4621028"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616424">errors</a></span><span class="op" id="4621034">.</span><span class="ident" id="4621035"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="4621038">(</span><span class="string" id="4621039">&#34;x509:&nbsp;cannot&nbsp;generate&nbsp;IV:&nbsp;&#34;</span>&nbsp;<span class="op" id="4621068">+</span>&nbsp;<span class="ident" id="4621070"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620971">err</a></span><span class="op" id="4621073">.</span><span class="ident" id="4621074">Error</span><span class="op" id="4621079">(</span><span class="op" id="4621080">)</span><span class="op" id="4621081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4621084">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4621087">//&nbsp;The&nbsp;salt&nbsp;is&nbsp;the&nbsp;first&nbsp;8&nbsp;bytes&nbsp;of&nbsp;the&nbsp;initialization&nbsp;vector,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4621151">//&nbsp;matching&nbsp;the&nbsp;key&nbsp;derivation&nbsp;in&nbsp;DecryptPEMBlock.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4621203">key</span>&nbsp;<span class="op" id="4621207">:=</span>&nbsp;<span class="ident" id="4621210"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620824">ciph</a></span><span class="op" id="4621214">.</span><span class="ident" id="4621215"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4617914">deriveKey</a></span><span class="op" id="4621224">(</span><span class="ident" id="4621225"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620769">password</a></span><span class="op" id="4621233">,</span>&nbsp;<span class="ident" id="4621235"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620929">iv</a></span><span class="op" id="4621237">[</span><span class="op" id="4621238">:</span><span class="num" id="4621239">8</span><span class="op" id="4621240">]</span><span class="op" id="4621241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4621244">block</span><span class="op" id="4621249">,</span>&nbsp;<span class="ident" id="4621251">err</span>&nbsp;<span class="op" id="4621255">:=</span>&nbsp;<span class="ident" id="4621258"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620824">ciph</a></span><span class="op" id="4621262">.</span><span class="ident" id="4621263"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616776">cipherFunc</a></span><span class="op" id="4621273">(</span><span class="ident" id="4621274"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4621203">key</a></span><span class="op" id="4621277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4621280">if</span>&nbsp;<span class="ident" id="4621283"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4621251">err</a></span>&nbsp;<span class="op" id="4621287">!=</span>&nbsp;<span class="builtintype" id="4621290">nil</span>&nbsp;<span class="op" id="4621294">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4621298">return</span>&nbsp;<span class="builtintype" id="4621305">nil</span><span class="op" id="4621308">,</span>&nbsp;<span class="ident" id="4621310"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4621251">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4621315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4621318">enc</span>&nbsp;<span class="op" id="4621322">:=</span>&nbsp;<span class="ident" id="4621325"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616347">cipher</a></span><span class="op" id="4621331">.</span><span class="ident" id="4621332"><a href="/gostd/crypto/cipher/cbc.go.html#4405590">NewCBCEncrypter</a></span><span class="op" id="4621347">(</span><span class="ident" id="4621348"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4621244">block</a></span><span class="op" id="4621353">,</span>&nbsp;<span class="ident" id="4621355"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620929">iv</a></span><span class="op" id="4621357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4621360">pad</span>&nbsp;<span class="op" id="4621364">:=</span>&nbsp;<span class="ident" id="4621367"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620824">ciph</a></span><span class="op" id="4621371">.</span><span class="ident" id="4621372"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616843">blockSize</a></span>&nbsp;<span class="op" id="4621382">-</span>&nbsp;<span class="builtinfunc" id="4621384">len</span><span class="op" id="4621387">(</span><span class="ident" id="4621388"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620763">data</a></span><span class="op" id="4621392">)</span><span class="op" id="4621393">%</span><span class="ident" id="4621394"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620824">ciph</a></span><span class="op" id="4621398">.</span><span class="ident" id="4621399"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616843">blockSize</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4621410">encrypted</span>&nbsp;<span class="op" id="4621420">:=</span>&nbsp;<span class="builtinfunc" id="4621423">make</span><span class="op" id="4621427">(</span><span class="op" id="4621428">[</span><span class="op" id="4621429">]</span><span class="builtintype" id="4621430">byte</span><span class="op" id="4621434">,</span>&nbsp;<span class="builtinfunc" id="4621436">len</span><span class="op" id="4621439">(</span><span class="ident" id="4621440"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620763">data</a></span><span class="op" id="4621444">)</span><span class="op" id="4621445">,</span>&nbsp;<span class="builtinfunc" id="4621447">len</span><span class="op" id="4621450">(</span><span class="ident" id="4621451"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620763">data</a></span><span class="op" id="4621455">)</span><span class="op" id="4621456">+</span><span class="ident" id="4621457"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4621360">pad</a></span><span class="op" id="4621460">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4621463">//&nbsp;We&nbsp;could&nbsp;save&nbsp;this&nbsp;copy&nbsp;by&nbsp;encrypting&nbsp;all&nbsp;the&nbsp;whole&nbsp;blocks&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4621529">//&nbsp;the&nbsp;data&nbsp;separately,&nbsp;but&nbsp;it&nbsp;doesn&#39;t&nbsp;seem&nbsp;worth&nbsp;the&nbsp;additional</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4621595">//&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4621605">copy</span><span class="op" id="4621609">(</span><span class="ident" id="4621610"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4621410">encrypted</a></span><span class="op" id="4621619">,</span>&nbsp;<span class="ident" id="4621621"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620763">data</a></span><span class="op" id="4621625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4621628">//&nbsp;See&nbsp;RFC&nbsp;1423,&nbsp;section&nbsp;1.1</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4621658">for</span>&nbsp;<span class="ident" id="4621662">i</span>&nbsp;<span class="op" id="4621664">:=</span>&nbsp;<span class="num" id="4621667">0</span><span class="op" id="4621668">;</span>&nbsp;<span class="ident" id="4621670"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4621662">i</a></span>&nbsp;<span class="op" id="4621672">&lt;</span>&nbsp;<span class="ident" id="4621674"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4621360">pad</a></span><span class="op" id="4621677">;</span>&nbsp;<span class="ident" id="4621679"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4621662">i</a></span><span class="op" id="4621680">++</span>&nbsp;<span class="op" id="4621683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4621687"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4621410">encrypted</a></span>&nbsp;<span class="op" id="4621697">=</span>&nbsp;<span class="builtinfunc" id="4621699">append</span><span class="op" id="4621705">(</span><span class="ident" id="4621706"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4621410">encrypted</a></span><span class="op" id="4621715">,</span>&nbsp;<span class="builtintype" id="4621717">byte</span><span class="op" id="4621721">(</span><span class="ident" id="4621722"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4621360">pad</a></span><span class="op" id="4621725">)</span><span class="op" id="4621726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4621729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4621732"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4621318">enc</a></span><span class="op" id="4621735">.</span><span class="ident" id="4621736"><a href="/gostd/crypto/cipher/cipher.go.html#4411618">CryptBlocks</a></span><span class="op" id="4621747">(</span><span class="ident" id="4621748"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4621410">encrypted</a></span><span class="op" id="4621757">,</span>&nbsp;<span class="ident" id="4621759"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4621410">encrypted</a></span><span class="op" id="4621768">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4621772">return</span>&nbsp;<span class="op" id="4621779">&amp;</span><span class="ident" id="4621780"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616408">pem</a></span><span class="op" id="4621783">.</span><span class="ident" id="4621784"><a href="/gostd/encoding/pem/pem.go.html#4703705">Block</a></span><span class="op" id="4621789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4621793"><a href="/gostd/encoding/pem/pem.go.html#4703721">Type</a></span><span class="op" id="4621797">:</span>&nbsp;<span class="ident" id="4621799"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620745">blockType</a></span><span class="op" id="4621808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4621812"><a href="/gostd/encoding/pem/pem.go.html#4703811">Headers</a></span><span class="op" id="4621819">:</span>&nbsp;<span class="keyword" id="4621821">map</span><span class="op" id="4621824">[</span><span class="builtintype" id="4621825">string</span><span class="op" id="4621831">]</span><span class="builtintype" id="4621832">string</span><span class="op" id="4621838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4621843">&#34;Proc-Type&#34;</span><span class="op" id="4621854">:</span>&nbsp;<span class="string" id="4621856">&#34;4,ENCRYPTED&#34;</span><span class="op" id="4621869">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4621874">&#34;DEK-Info&#34;</span><span class="op" id="4621884">:</span>&nbsp;&nbsp;<span class="ident" id="4621887"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620824">ciph</a></span><span class="op" id="4621891">.</span><span class="ident" id="4621892"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616757">name</a></span>&nbsp;<span class="op" id="4621897">+</span>&nbsp;<span class="string" id="4621899">&#34;,&#34;</span>&nbsp;<span class="op" id="4621903">+</span>&nbsp;<span class="ident" id="4621905"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616392">hex</a></span><span class="op" id="4621908">.</span><span class="ident" id="4621909"><a href="/gostd/encoding/hex/hex.go.html#4721363">EncodeToString</a></span><span class="op" id="4621923">(</span><span class="ident" id="4621924"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4620929">iv</a></span><span class="op" id="4621926">)</span><span class="op" id="4621927">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4621931">}</span><span class="op" id="4621932">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4621936"><a href="/gostd/encoding/pem/pem.go.html#4703859">Bytes</a></span><span class="op" id="4621941">:</span>&nbsp;<span class="ident" id="4621943"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4621410">encrypted</a></span><span class="op" id="4621952">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4621955">}</span><span class="op" id="4621956">,</span>&nbsp;<span class="builtintype" id="4621958">nil</span><br>
<span class="lineno"></span><span class="op" id="4621962">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="4621965">func</span>&nbsp;<span class="ident" id="4621970">cipherByName</span><span class="op" id="4621982">(</span><span class="ident" id="4621983">name</span>&nbsp;<span class="builtintype" id="4621988">string</span><span class="op" id="4621994">)</span>&nbsp;<span class="op" id="4621996">*</span><span class="ident" id="4621997"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616713">rfc1423Algo</a></span>&nbsp;<span class="op" id="4622009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4622012">for</span>&nbsp;<span class="ident" id="4622016">i</span>&nbsp;<span class="op" id="4622018">:=</span>&nbsp;<span class="keyword" id="4622021">range</span>&nbsp;<span class="ident" id="4622027"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616999">rfc1423Algos</a></span>&nbsp;<span class="op" id="4622040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4622044">alg</span>&nbsp;<span class="op" id="4622048">:=</span>&nbsp;<span class="op" id="4622051">&amp;</span><span class="ident" id="4622052"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616999">rfc1423Algos</a></span><span class="op" id="4622064">[</span><span class="ident" id="4622065"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4622016">i</a></span><span class="op" id="4622066">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4622070">if</span>&nbsp;<span class="ident" id="4622073"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4622044">alg</a></span><span class="op" id="4622076">.</span><span class="ident" id="4622077"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616757">name</a></span>&nbsp;<span class="op" id="4622082">==</span>&nbsp;<span class="ident" id="4622085"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4621983">name</a></span>&nbsp;<span class="op" id="4622090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4622095">return</span>&nbsp;<span class="ident" id="4622102"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4622044">alg</a></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4622108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4622111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4622114">return</span>&nbsp;<span class="builtintype" id="4622121">nil</span><br>
<span class="lineno"></span><span class="op" id="4622125">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="4622128">func</span>&nbsp;<span class="ident" id="4622133">cipherByKey</span><span class="op" id="4622144">(</span><span class="ident" id="4622145">key</span>&nbsp;<span class="ident" id="4622149"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616458">PEMCipher</a></span><span class="op" id="4622158">)</span>&nbsp;<span class="op" id="4622160">*</span><span class="ident" id="4622161"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616713">rfc1423Algo</a></span>&nbsp;<span class="op" id="4622173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4622176">for</span>&nbsp;<span class="ident" id="4622180">i</span>&nbsp;<span class="op" id="4622182">:=</span>&nbsp;<span class="keyword" id="4622185">range</span>&nbsp;<span class="ident" id="4622191"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616999">rfc1423Algos</a></span>&nbsp;<span class="op" id="4622204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4622208">alg</span>&nbsp;<span class="op" id="4622212">:=</span>&nbsp;<span class="op" id="4622215">&amp;</span><span class="ident" id="4622216"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616999">rfc1423Algos</a></span><span class="op" id="4622228">[</span><span class="ident" id="4622229"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4622180">i</a></span><span class="op" id="4622230">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4622234">if</span>&nbsp;<span class="ident" id="4622237"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4622208">alg</a></span><span class="op" id="4622240">.</span><span class="ident" id="4622241"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4616735">cipher</a></span>&nbsp;<span class="op" id="4622248">==</span>&nbsp;<span class="ident" id="4622251"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4622145">key</a></span>&nbsp;<span class="op" id="4622255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4622260">return</span>&nbsp;<span class="ident" id="4622267"><a href="/gostd/crypto/x509/pem_decrypt.go.html#4622208">alg</a></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4622273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4622276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4622279">return</span>&nbsp;<span class="builtintype" id="4622286">nil</span><br>
<span class="lineno"></span><span class="op" id="4622290">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
