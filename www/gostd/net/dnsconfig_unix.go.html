<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3141726">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3141781">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3141835">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3141886">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3141951">//&nbsp;Read&nbsp;system&nbsp;DNS&nbsp;config&nbsp;from&nbsp;/etc/resolv.conf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3142000">package</span>&nbsp;<span class="ident" id="3142008">net</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="3142013">type</span>&nbsp;<span class="ident" id="3142018">dnsConfig</span>&nbsp;<span class="keyword" id="3142028">struct</span>&nbsp;<span class="op" id="3142035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3142038">servers</span>&nbsp;&nbsp;<span class="op" id="3142047">[</span><span class="op" id="3142048">]</span><span class="builtintype" id="3142049">string</span>&nbsp;<span class="comment" id="3142056">//&nbsp;servers&nbsp;to&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3142075">search</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3142084">[</span><span class="op" id="3142085">]</span><span class="builtintype" id="3142086">string</span>&nbsp;<span class="comment" id="3142093">//&nbsp;suffixes&nbsp;to&nbsp;append&nbsp;to&nbsp;local&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3142130">ndots</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3142139">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3142148">//&nbsp;number&nbsp;of&nbsp;dots&nbsp;in&nbsp;name&nbsp;to&nbsp;trigger&nbsp;absolute&nbsp;lookup</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3142202">timeout</span>&nbsp;&nbsp;<span class="builtintype" id="3142211">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3142220">//&nbsp;seconds&nbsp;before&nbsp;giving&nbsp;up&nbsp;on&nbsp;packet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3142259">attempts</span>&nbsp;<span class="builtintype" id="3142268">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3142277">//&nbsp;lost&nbsp;packets&nbsp;before&nbsp;giving&nbsp;up&nbsp;on&nbsp;server</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3142321">rotate</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3142330">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3142339">//&nbsp;round&nbsp;robin&nbsp;among&nbsp;servers</span><br>
<span class="lineno"></span><span class="op" id="3142368">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="3142371">//&nbsp;See&nbsp;resolv.conf(5)&nbsp;on&nbsp;a&nbsp;Linux&nbsp;machine.</span><br>
<span class="lineno"></span><span class="comment" id="3142413">//&nbsp;TODO(rsc):&nbsp;Supposed&nbsp;to&nbsp;call&nbsp;uname()&nbsp;and&nbsp;chop&nbsp;the&nbsp;beginning</span><br>
<span class="lineno"></span><span class="comment" id="3142475">//&nbsp;of&nbsp;the&nbsp;host&nbsp;name&nbsp;to&nbsp;get&nbsp;the&nbsp;default&nbsp;search&nbsp;domain.</span><br>
<span class="lineno"></span><span class="keyword" id="3142529">func</span>&nbsp;<span class="ident" id="3142534">dnsReadConfig</span><span class="op" id="3142547">(</span><span class="ident" id="3142548">filename</span>&nbsp;<span class="builtintype" id="3142557">string</span><span class="op" id="3142563">)</span>&nbsp;<span class="op" id="3142565">(</span><span class="op" id="3142566">*</span><span class="ident" id="3142567">dnsConfig</span><span class="op" id="3142576">,</span>&nbsp;<span class="builtintype" id="3142578">error</span><span class="op" id="3142583">)</span>&nbsp;<span class="op" id="3142585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3142588">file</span><span class="op" id="3142592">,</span>&nbsp;<span class="ident" id="3142594">err</span>&nbsp;<span class="op" id="3142598">:=</span>&nbsp;<span class="ident" id="3142601">open</span><span class="op" id="3142605">(</span><span class="ident" id="3142606">filename</span><span class="op" id="3142614">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3142617">if</span>&nbsp;<span class="ident" id="3142620">err</span>&nbsp;<span class="op" id="3142624">!=</span>&nbsp;<span class="ident" id="3142627">nil</span>&nbsp;<span class="op" id="3142631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3142635">return</span>&nbsp;<span class="ident" id="3142642">nil</span><span class="op" id="3142645">,</span>&nbsp;<span class="op" id="3142647">&amp;</span><span class="ident" id="3142648">DNSConfigError</span><span class="op" id="3142662">{</span><span class="ident" id="3142663">err</span><span class="op" id="3142666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3142669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3142672">defer</span>&nbsp;<span class="ident" id="3142678">file</span><span class="op" id="3142682">.</span><span class="builtinfunc" id="3142683">close</span><span class="op" id="3142688">(</span><span class="op" id="3142689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3142692">conf</span>&nbsp;<span class="op" id="3142697">:=</span>&nbsp;<span class="op" id="3142700">&amp;</span><span class="ident" id="3142701">dnsConfig</span><span class="op" id="3142710">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3142714">ndots</span><span class="op" id="3142719">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3142724">1</span><span class="op" id="3142725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3142729">timeout</span><span class="op" id="3142736">:</span>&nbsp;&nbsp;<span class="num" id="3142739">5</span><span class="op" id="3142740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3142744">attempts</span><span class="op" id="3142752">:</span>&nbsp;<span class="num" id="3142754">2</span><span class="op" id="3142755">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3142758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3142761">for</span>&nbsp;<span class="ident" id="3142765">line</span><span class="op" id="3142769">,</span>&nbsp;<span class="ident" id="3142771">ok</span>&nbsp;<span class="op" id="3142774">:=</span>&nbsp;<span class="ident" id="3142777">file</span><span class="op" id="3142781">.</span><span class="ident" id="3142782">readLine</span><span class="op" id="3142790">(</span><span class="op" id="3142791">)</span><span class="op" id="3142792">;</span>&nbsp;<span class="ident" id="3142794">ok</span><span class="op" id="3142796">;</span>&nbsp;<span class="ident" id="3142798">line</span><span class="op" id="3142802">,</span>&nbsp;<span class="ident" id="3142804">ok</span>&nbsp;<span class="op" id="3142807">=</span>&nbsp;<span class="ident" id="3142809">file</span><span class="op" id="3142813">.</span><span class="ident" id="3142814">readLine</span><span class="op" id="3142822">(</span><span class="op" id="3142823">)</span>&nbsp;<span class="op" id="3142825">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3142829">f</span>&nbsp;<span class="op" id="3142831">:=</span>&nbsp;<span class="ident" id="3142834">getFields</span><span class="op" id="3142843">(</span><span class="ident" id="3142844">line</span><span class="op" id="3142848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3142852">if</span>&nbsp;<span class="builtinfunc" id="3142855">len</span><span class="op" id="3142858">(</span><span class="ident" id="3142859">f</span><span class="op" id="3142860">)</span>&nbsp;<span class="op" id="3142862">&lt;</span>&nbsp;<span class="num" id="3142864">1</span>&nbsp;<span class="op" id="3142866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3142871">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3142882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3142886">switch</span>&nbsp;<span class="ident" id="3142893">f</span><span class="op" id="3142894">[</span><span class="num" id="3142895">0</span><span class="op" id="3142896">]</span>&nbsp;<span class="op" id="3142898">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3142902">case</span>&nbsp;<span class="string" id="3142907">&#34;nameserver&#34;</span><span class="op" id="3142919">:</span>&nbsp;<span class="comment" id="3142921">//&nbsp;add&nbsp;one&nbsp;name&nbsp;server</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3142947">if</span>&nbsp;<span class="builtinfunc" id="3142950">len</span><span class="op" id="3142953">(</span><span class="ident" id="3142954">f</span><span class="op" id="3142955">)</span>&nbsp;<span class="op" id="3142957">&gt;</span>&nbsp;<span class="num" id="3142959">1</span>&nbsp;<span class="op" id="3142961">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3142964">len</span><span class="op" id="3142967">(</span><span class="ident" id="3142968">conf</span><span class="op" id="3142972">.</span><span class="ident" id="3142973">servers</span><span class="op" id="3142980">)</span>&nbsp;<span class="op" id="3142982">&lt;</span>&nbsp;<span class="num" id="3142984">3</span>&nbsp;<span class="op" id="3142986">{</span>&nbsp;<span class="comment" id="3142988">//&nbsp;small,&nbsp;but&nbsp;the&nbsp;standard&nbsp;limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3143025">//&nbsp;One&nbsp;more&nbsp;check:&nbsp;make&nbsp;sure&nbsp;server&nbsp;name&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3143073">//&nbsp;just&nbsp;an&nbsp;IP&nbsp;address.&nbsp;&nbsp;Otherwise&nbsp;we&nbsp;need&nbsp;DNS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3143123">//&nbsp;to&nbsp;look&nbsp;it&nbsp;up.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3143145">if</span>&nbsp;<span class="ident" id="3143148">parseIPv4</span><span class="op" id="3143157">(</span><span class="ident" id="3143158">f</span><span class="op" id="3143159">[</span><span class="num" id="3143160">1</span><span class="op" id="3143161">]</span><span class="op" id="3143162">)</span>&nbsp;<span class="op" id="3143164">!=</span>&nbsp;<span class="ident" id="3143167">nil</span>&nbsp;<span class="op" id="3143171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3143178">conf</span><span class="op" id="3143182">.</span><span class="ident" id="3143183">servers</span>&nbsp;<span class="op" id="3143191">=</span>&nbsp;<span class="builtinfunc" id="3143193">append</span><span class="op" id="3143199">(</span><span class="ident" id="3143200">conf</span><span class="op" id="3143204">.</span><span class="ident" id="3143205">servers</span><span class="op" id="3143212">,</span>&nbsp;<span class="ident" id="3143214">f</span><span class="op" id="3143215">[</span><span class="num" id="3143216">1</span><span class="op" id="3143217">]</span><span class="op" id="3143218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3143224">}</span>&nbsp;<span class="keyword" id="3143226">else</span>&nbsp;<span class="keyword" id="3143231">if</span>&nbsp;<span class="ident" id="3143234">ip</span><span class="op" id="3143236">,</span>&nbsp;<span class="ident" id="3143238">_</span>&nbsp;<span class="op" id="3143240">:=</span>&nbsp;<span class="ident" id="3143243">parseIPv6</span><span class="op" id="3143252">(</span><span class="ident" id="3143253">f</span><span class="op" id="3143254">[</span><span class="num" id="3143255">1</span><span class="op" id="3143256">]</span><span class="op" id="3143257">,</span>&nbsp;<span class="builtintype" id="3143259">true</span><span class="op" id="3143263">)</span><span class="op" id="3143264">;</span>&nbsp;<span class="ident" id="3143266">ip</span>&nbsp;<span class="op" id="3143269">!=</span>&nbsp;<span class="ident" id="3143272">nil</span>&nbsp;<span class="op" id="3143276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3143283">conf</span><span class="op" id="3143287">.</span><span class="ident" id="3143288">servers</span>&nbsp;<span class="op" id="3143296">=</span>&nbsp;<span class="builtinfunc" id="3143298">append</span><span class="op" id="3143304">(</span><span class="ident" id="3143305">conf</span><span class="op" id="3143309">.</span><span class="ident" id="3143310">servers</span><span class="op" id="3143317">,</span>&nbsp;<span class="ident" id="3143319">f</span><span class="op" id="3143320">[</span><span class="num" id="3143321">1</span><span class="op" id="3143322">]</span><span class="op" id="3143323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3143329">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3143334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3143339">case</span>&nbsp;<span class="string" id="3143344">&#34;domain&#34;</span><span class="op" id="3143352">:</span>&nbsp;<span class="comment" id="3143354">//&nbsp;set&nbsp;search&nbsp;path&nbsp;to&nbsp;just&nbsp;this&nbsp;domain</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3143396">if</span>&nbsp;<span class="builtinfunc" id="3143399">len</span><span class="op" id="3143402">(</span><span class="ident" id="3143403">f</span><span class="op" id="3143404">)</span>&nbsp;<span class="op" id="3143406">&gt;</span>&nbsp;<span class="num" id="3143408">1</span>&nbsp;<span class="op" id="3143410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3143416">conf</span><span class="op" id="3143420">.</span><span class="ident" id="3143421">search</span>&nbsp;<span class="op" id="3143428">=</span>&nbsp;<span class="op" id="3143430">[</span><span class="op" id="3143431">]</span><span class="builtintype" id="3143432">string</span><span class="op" id="3143438">{</span><span class="ident" id="3143439">f</span><span class="op" id="3143440">[</span><span class="num" id="3143441">1</span><span class="op" id="3143442">]</span><span class="op" id="3143443">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3143448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3143453">case</span>&nbsp;<span class="string" id="3143458">&#34;search&#34;</span><span class="op" id="3143466">:</span>&nbsp;<span class="comment" id="3143468">//&nbsp;set&nbsp;search&nbsp;path&nbsp;to&nbsp;given&nbsp;servers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3143507">conf</span><span class="op" id="3143511">.</span><span class="ident" id="3143512">search</span>&nbsp;<span class="op" id="3143519">=</span>&nbsp;<span class="builtinfunc" id="3143521">make</span><span class="op" id="3143525">(</span><span class="op" id="3143526">[</span><span class="op" id="3143527">]</span><span class="builtintype" id="3143528">string</span><span class="op" id="3143534">,</span>&nbsp;<span class="builtinfunc" id="3143536">len</span><span class="op" id="3143539">(</span><span class="ident" id="3143540">f</span><span class="op" id="3143541">)</span><span class="op" id="3143542">-</span><span class="num" id="3143543">1</span><span class="op" id="3143544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3143549">for</span>&nbsp;<span class="ident" id="3143553">i</span>&nbsp;<span class="op" id="3143555">:=</span>&nbsp;<span class="num" id="3143558">0</span><span class="op" id="3143559">;</span>&nbsp;<span class="ident" id="3143561">i</span>&nbsp;<span class="op" id="3143563">&lt;</span>&nbsp;<span class="builtinfunc" id="3143565">len</span><span class="op" id="3143568">(</span><span class="ident" id="3143569">conf</span><span class="op" id="3143573">.</span><span class="ident" id="3143574">search</span><span class="op" id="3143580">)</span><span class="op" id="3143581">;</span>&nbsp;<span class="ident" id="3143583">i</span><span class="op" id="3143584">++</span>&nbsp;<span class="op" id="3143587">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3143593">conf</span><span class="op" id="3143597">.</span><span class="ident" id="3143598">search</span><span class="op" id="3143604">[</span><span class="ident" id="3143605">i</span><span class="op" id="3143606">]</span>&nbsp;<span class="op" id="3143608">=</span>&nbsp;<span class="ident" id="3143610">f</span><span class="op" id="3143611">[</span><span class="ident" id="3143612">i</span><span class="op" id="3143613">+</span><span class="num" id="3143614">1</span><span class="op" id="3143615">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3143620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3143625">case</span>&nbsp;<span class="string" id="3143630">&#34;options&#34;</span><span class="op" id="3143639">:</span>&nbsp;<span class="comment" id="3143641">//&nbsp;magic&nbsp;options</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3143661">for</span>&nbsp;<span class="ident" id="3143665">i</span>&nbsp;<span class="op" id="3143667">:=</span>&nbsp;<span class="num" id="3143670">1</span><span class="op" id="3143671">;</span>&nbsp;<span class="ident" id="3143673">i</span>&nbsp;<span class="op" id="3143675">&lt;</span>&nbsp;<span class="builtinfunc" id="3143677">len</span><span class="op" id="3143680">(</span><span class="ident" id="3143681">f</span><span class="op" id="3143682">)</span><span class="op" id="3143683">;</span>&nbsp;<span class="ident" id="3143685">i</span><span class="op" id="3143686">++</span>&nbsp;<span class="op" id="3143689">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3143695">s</span>&nbsp;<span class="op" id="3143697">:=</span>&nbsp;<span class="ident" id="3143700">f</span><span class="op" id="3143701">[</span><span class="ident" id="3143702">i</span><span class="op" id="3143703">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3143709">switch</span>&nbsp;<span class="op" id="3143716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3143722">case</span>&nbsp;<span class="ident" id="3143727">hasPrefix</span><span class="op" id="3143736">(</span><span class="ident" id="3143737">s</span><span class="op" id="3143738">,</span>&nbsp;<span class="string" id="3143740">&#34;ndots:&#34;</span><span class="op" id="3143748">)</span><span class="op" id="3143749">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3143756">n</span><span class="op" id="3143757">,</span>&nbsp;<span class="ident" id="3143759">_</span><span class="op" id="3143760">,</span>&nbsp;<span class="ident" id="3143762">_</span>&nbsp;<span class="op" id="3143764">:=</span>&nbsp;<span class="ident" id="3143767">dtoi</span><span class="op" id="3143771">(</span><span class="ident" id="3143772">s</span><span class="op" id="3143773">,</span>&nbsp;<span class="num" id="3143775">6</span><span class="op" id="3143776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3143783">if</span>&nbsp;<span class="ident" id="3143786">n</span>&nbsp;<span class="op" id="3143788">&lt;</span>&nbsp;<span class="num" id="3143790">1</span>&nbsp;<span class="op" id="3143792">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3143800">n</span>&nbsp;<span class="op" id="3143802">=</span>&nbsp;<span class="num" id="3143804">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3143811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3143818">conf</span><span class="op" id="3143822">.</span><span class="ident" id="3143823">ndots</span>&nbsp;<span class="op" id="3143829">=</span>&nbsp;<span class="ident" id="3143831">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3143837">case</span>&nbsp;<span class="ident" id="3143842">hasPrefix</span><span class="op" id="3143851">(</span><span class="ident" id="3143852">s</span><span class="op" id="3143853">,</span>&nbsp;<span class="string" id="3143855">&#34;timeout:&#34;</span><span class="op" id="3143865">)</span><span class="op" id="3143866">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3143873">n</span><span class="op" id="3143874">,</span>&nbsp;<span class="ident" id="3143876">_</span><span class="op" id="3143877">,</span>&nbsp;<span class="ident" id="3143879">_</span>&nbsp;<span class="op" id="3143881">:=</span>&nbsp;<span class="ident" id="3143884">dtoi</span><span class="op" id="3143888">(</span><span class="ident" id="3143889">s</span><span class="op" id="3143890">,</span>&nbsp;<span class="num" id="3143892">8</span><span class="op" id="3143893">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3143900">if</span>&nbsp;<span class="ident" id="3143903">n</span>&nbsp;<span class="op" id="3143905">&lt;</span>&nbsp;<span class="num" id="3143907">1</span>&nbsp;<span class="op" id="3143909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3143917">n</span>&nbsp;<span class="op" id="3143919">=</span>&nbsp;<span class="num" id="3143921">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3143928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3143935">conf</span><span class="op" id="3143939">.</span><span class="ident" id="3143940">timeout</span>&nbsp;<span class="op" id="3143948">=</span>&nbsp;<span class="ident" id="3143950">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3143956">case</span>&nbsp;<span class="ident" id="3143961">hasPrefix</span><span class="op" id="3143970">(</span><span class="ident" id="3143971">s</span><span class="op" id="3143972">,</span>&nbsp;<span class="string" id="3143974">&#34;attempts:&#34;</span><span class="op" id="3143985">)</span><span class="op" id="3143986">:</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3143993">n</span><span class="op" id="3143994">,</span>&nbsp;<span class="ident" id="3143996">_</span><span class="op" id="3143997">,</span>&nbsp;<span class="ident" id="3143999">_</span>&nbsp;<span class="op" id="3144001">:=</span>&nbsp;<span class="ident" id="3144004">dtoi</span><span class="op" id="3144008">(</span><span class="ident" id="3144009">s</span><span class="op" id="3144010">,</span>&nbsp;<span class="num" id="3144012">9</span><span class="op" id="3144013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3144020">if</span>&nbsp;<span class="ident" id="3144023">n</span>&nbsp;<span class="op" id="3144025">&lt;</span>&nbsp;<span class="num" id="3144027">1</span>&nbsp;<span class="op" id="3144029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3144037">n</span>&nbsp;<span class="op" id="3144039">=</span>&nbsp;<span class="num" id="3144041">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3144048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3144055">conf</span><span class="op" id="3144059">.</span><span class="ident" id="3144060">attempts</span>&nbsp;<span class="op" id="3144069">=</span>&nbsp;<span class="ident" id="3144071">n</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3144077">case</span>&nbsp;<span class="ident" id="3144082">s</span>&nbsp;<span class="op" id="3144084">==</span>&nbsp;<span class="string" id="3144087">&#34;rotate&#34;</span><span class="op" id="3144095">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3144102">conf</span><span class="op" id="3144106">.</span><span class="ident" id="3144107">rotate</span>&nbsp;<span class="op" id="3144114">=</span>&nbsp;<span class="builtintype" id="3144116">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3144125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3144130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3144134">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3144137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3144140">return</span>&nbsp;<span class="ident" id="3144147">conf</span><span class="op" id="3144151">,</span>&nbsp;<span class="ident" id="3144153">nil</span><br>
<span class="lineno"></span><span class="op" id="3144157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3144160">func</span>&nbsp;<span class="ident" id="3144165">hasPrefix</span><span class="op" id="3144174">(</span><span class="ident" id="3144175">s</span><span class="op" id="3144176">,</span>&nbsp;<span class="ident" id="3144178">prefix</span>&nbsp;<span class="builtintype" id="3144185">string</span><span class="op" id="3144191">)</span>&nbsp;<span class="builtintype" id="3144193">bool</span>&nbsp;<span class="op" id="3144198">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3144201">return</span>&nbsp;<span class="builtinfunc" id="3144208">len</span><span class="op" id="3144211">(</span><span class="ident" id="3144212">s</span><span class="op" id="3144213">)</span>&nbsp;<span class="op" id="3144215">&gt;=</span>&nbsp;<span class="builtinfunc" id="3144218">len</span><span class="op" id="3144221">(</span><span class="ident" id="3144222">prefix</span><span class="op" id="3144228">)</span>&nbsp;<span class="op" id="3144230">&amp;&amp;</span>&nbsp;<span class="ident" id="3144233">s</span><span class="op" id="3144234">[</span><span class="op" id="3144235">:</span><span class="builtinfunc" id="3144236">len</span><span class="op" id="3144239">(</span><span class="ident" id="3144240">prefix</span><span class="op" id="3144246">)</span><span class="op" id="3144247">]</span>&nbsp;<span class="op" id="3144249">==</span>&nbsp;<span class="ident" id="3144252">prefix</span><br>
<span class="lineno"></span><span class="op" id="3144259">}</span>
</div>
</body>
</html>
