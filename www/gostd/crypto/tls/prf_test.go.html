<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html" class="current">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7115609">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7115664">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7115718">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7115769">package</span>&nbsp;<span class="ident" id="7115777">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7115782">import</span>&nbsp;<span class="op" id="7115789">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7115792">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7115808">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="7115818">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7115821">type</span>&nbsp;<span class="ident" id="7115826">testSplitPreMasterSecretTest</span>&nbsp;<span class="keyword" id="7115855">struct</span>&nbsp;<span class="op" id="7115862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7115865">in</span><span class="op" id="7115867">,</span>&nbsp;<span class="ident" id="7115869">out1</span><span class="op" id="7115873">,</span>&nbsp;<span class="ident" id="7115875">out2</span>&nbsp;<span class="builtintype" id="7115880">string</span><br>
<span class="lineno"></span><span class="op" id="7115887">}</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7115890">var</span>&nbsp;<span class="ident" id="7115894">testSplitPreMasterSecretTests</span>&nbsp;<span class="op" id="7115924">=</span>&nbsp;<span class="op" id="7115926">[</span><span class="op" id="7115927">]</span><span class="ident" id="7115928">testSplitPreMasterSecretTest</span><span class="op" id="7115956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7115959">{</span><span class="string" id="7115960">&#34;&#34;</span><span class="op" id="7115962">,</span>&nbsp;<span class="string" id="7115964">&#34;&#34;</span><span class="op" id="7115966">,</span>&nbsp;<span class="string" id="7115968">&#34;&#34;</span><span class="op" id="7115970">}</span><span class="op" id="7115971">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7115974">{</span><span class="string" id="7115975">&#34;00&#34;</span><span class="op" id="7115979">,</span>&nbsp;<span class="string" id="7115981">&#34;00&#34;</span><span class="op" id="7115985">,</span>&nbsp;<span class="string" id="7115987">&#34;00&#34;</span><span class="op" id="7115991">}</span><span class="op" id="7115992">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7115995">{</span><span class="string" id="7115996">&#34;0011&#34;</span><span class="op" id="7116002">,</span>&nbsp;<span class="string" id="7116004">&#34;00&#34;</span><span class="op" id="7116008">,</span>&nbsp;<span class="string" id="7116010">&#34;11&#34;</span><span class="op" id="7116014">}</span><span class="op" id="7116015">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7116018">{</span><span class="string" id="7116019">&#34;001122&#34;</span><span class="op" id="7116027">,</span>&nbsp;<span class="string" id="7116029">&#34;0011&#34;</span><span class="op" id="7116035">,</span>&nbsp;<span class="string" id="7116037">&#34;1122&#34;</span><span class="op" id="7116043">}</span><span class="op" id="7116044">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7116047">{</span><span class="string" id="7116048">&#34;00112233&#34;</span><span class="op" id="7116058">,</span>&nbsp;<span class="string" id="7116060">&#34;0011&#34;</span><span class="op" id="7116066">,</span>&nbsp;<span class="string" id="7116068">&#34;2233&#34;</span><span class="op" id="7116074">}</span><span class="op" id="7116075">,</span><br>
<span class="lineno"></span><span class="op" id="7116077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7116080">func</span>&nbsp;<span class="ident" id="7116085">TestSplitPreMasterSecret</span><span class="op" id="7116109">(</span><span class="ident" id="7116110">t</span>&nbsp;<span class="op" id="7116112">*</span><span class="ident" id="7116113">testing</span><span class="op" id="7116120">.</span><span class="ident" id="7116121">T</span><span class="op" id="7116122">)</span>&nbsp;<span class="op" id="7116124">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7116127">for</span>&nbsp;<span class="ident" id="7116131">i</span><span class="op" id="7116132">,</span>&nbsp;<span class="ident" id="7116134">test</span>&nbsp;<span class="op" id="7116139">:=</span>&nbsp;<span class="keyword" id="7116142">range</span>&nbsp;<span class="ident" id="7116148">testSplitPreMasterSecretTests</span>&nbsp;<span class="op" id="7116178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7116182">in</span><span class="op" id="7116184">,</span>&nbsp;<span class="ident" id="7116186">_</span>&nbsp;<span class="op" id="7116188">:=</span>&nbsp;<span class="ident" id="7116191">hex</span><span class="op" id="7116194">.</span><span class="ident" id="7116195">DecodeString</span><span class="op" id="7116207">(</span><span class="ident" id="7116208">test</span><span class="op" id="7116212">.</span><span class="ident" id="7116213">in</span><span class="op" id="7116215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7116219">out1</span><span class="op" id="7116223">,</span>&nbsp;<span class="ident" id="7116225">out2</span>&nbsp;<span class="op" id="7116230">:=</span>&nbsp;<span class="ident" id="7116233">splitPreMasterSecret</span><span class="op" id="7116253">(</span><span class="ident" id="7116254">in</span><span class="op" id="7116256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7116260">s1</span>&nbsp;<span class="op" id="7116263">:=</span>&nbsp;<span class="ident" id="7116266">hex</span><span class="op" id="7116269">.</span><span class="ident" id="7116270">EncodeToString</span><span class="op" id="7116284">(</span><span class="ident" id="7116285">out1</span><span class="op" id="7116289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7116293">s2</span>&nbsp;<span class="op" id="7116296">:=</span>&nbsp;<span class="ident" id="7116299">hex</span><span class="op" id="7116302">.</span><span class="ident" id="7116303">EncodeToString</span><span class="op" id="7116317">(</span><span class="ident" id="7116318">out2</span><span class="op" id="7116322">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7116326">if</span>&nbsp;<span class="ident" id="7116329">s1</span>&nbsp;<span class="op" id="7116332">!=</span>&nbsp;<span class="ident" id="7116335">test</span><span class="op" id="7116339">.</span><span class="ident" id="7116340">out1</span>&nbsp;<span class="op" id="7116345">||</span>&nbsp;<span class="ident" id="7116348">s2</span>&nbsp;<span class="op" id="7116351">!=</span>&nbsp;<span class="ident" id="7116354">test</span><span class="op" id="7116358">.</span><span class="ident" id="7116359">out2</span>&nbsp;<span class="op" id="7116364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7116369">t</span><span class="op" id="7116370">.</span><span class="ident" id="7116371">Errorf</span><span class="op" id="7116377">(</span><span class="string" id="7116378">&#34;#%d:&nbsp;got:&nbsp;(%s,&nbsp;%s)&nbsp;want:&nbsp;(%s,&nbsp;%s)&#34;</span><span class="op" id="7116413">,</span>&nbsp;<span class="ident" id="7116415">i</span><span class="op" id="7116416">,</span>&nbsp;<span class="ident" id="7116418">s1</span><span class="op" id="7116420">,</span>&nbsp;<span class="ident" id="7116422">s2</span><span class="op" id="7116424">,</span>&nbsp;<span class="ident" id="7116426">test</span><span class="op" id="7116430">.</span><span class="ident" id="7116431">out1</span><span class="op" id="7116435">,</span>&nbsp;<span class="ident" id="7116437">test</span><span class="op" id="7116441">.</span><span class="ident" id="7116442">out2</span><span class="op" id="7116446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7116450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7116453">}</span><br>
<span class="lineno"></span><span class="op" id="7116455">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="7116458">type</span>&nbsp;<span class="ident" id="7116463">testKeysFromTest</span>&nbsp;<span class="keyword" id="7116480">struct</span>&nbsp;<span class="op" id="7116487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7116490">version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7116517">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7116525">preMasterSecret</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7116552">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7116560">clientRandom</span><span class="op" id="7116572">,</span>&nbsp;<span class="ident" id="7116574">serverRandom</span>&nbsp;<span class="builtintype" id="7116587">string</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7116595">masterSecret</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7116622">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7116630">clientMAC</span><span class="op" id="7116639">,</span>&nbsp;<span class="ident" id="7116641">serverMAC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7116657">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7116665">clientKey</span><span class="op" id="7116674">,</span>&nbsp;<span class="ident" id="7116676">serverKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7116692">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7116700">macLen</span><span class="op" id="7116706">,</span>&nbsp;<span class="ident" id="7116708">keyLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7116727">int</span><br>
<span class="lineno"></span><span class="op" id="7116731">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="7116734">func</span>&nbsp;<span class="ident" id="7116739">TestKeysFromPreMasterSecret</span><span class="op" id="7116766">(</span><span class="ident" id="7116767">t</span>&nbsp;<span class="op" id="7116769">*</span><span class="ident" id="7116770">testing</span><span class="op" id="7116777">.</span><span class="ident" id="7116778">T</span><span class="op" id="7116779">)</span>&nbsp;<span class="op" id="7116781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7116784">for</span>&nbsp;<span class="ident" id="7116788">i</span><span class="op" id="7116789">,</span>&nbsp;<span class="ident" id="7116791">test</span>&nbsp;<span class="op" id="7116796">:=</span>&nbsp;<span class="keyword" id="7116799">range</span>&nbsp;<span class="ident" id="7116805">testKeysFromTests</span>&nbsp;<span class="op" id="7116823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7116827">in</span><span class="op" id="7116829">,</span>&nbsp;<span class="ident" id="7116831">_</span>&nbsp;<span class="op" id="7116833">:=</span>&nbsp;<span class="ident" id="7116836">hex</span><span class="op" id="7116839">.</span><span class="ident" id="7116840">DecodeString</span><span class="op" id="7116852">(</span><span class="ident" id="7116853">test</span><span class="op" id="7116857">.</span><span class="ident" id="7116858">preMasterSecret</span><span class="op" id="7116873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7116877">clientRandom</span><span class="op" id="7116889">,</span>&nbsp;<span class="ident" id="7116891">_</span>&nbsp;<span class="op" id="7116893">:=</span>&nbsp;<span class="ident" id="7116896">hex</span><span class="op" id="7116899">.</span><span class="ident" id="7116900">DecodeString</span><span class="op" id="7116912">(</span><span class="ident" id="7116913">test</span><span class="op" id="7116917">.</span><span class="ident" id="7116918">clientRandom</span><span class="op" id="7116930">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7116934">serverRandom</span><span class="op" id="7116946">,</span>&nbsp;<span class="ident" id="7116948">_</span>&nbsp;<span class="op" id="7116950">:=</span>&nbsp;<span class="ident" id="7116953">hex</span><span class="op" id="7116956">.</span><span class="ident" id="7116957">DecodeString</span><span class="op" id="7116969">(</span><span class="ident" id="7116970">test</span><span class="op" id="7116974">.</span><span class="ident" id="7116975">serverRandom</span><span class="op" id="7116987">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7116992">masterSecret</span>&nbsp;<span class="op" id="7117005">:=</span>&nbsp;<span class="ident" id="7117008">masterFromPreMasterSecret</span><span class="op" id="7117033">(</span><span class="ident" id="7117034">test</span><span class="op" id="7117038">.</span><span class="ident" id="7117039">version</span><span class="op" id="7117046">,</span>&nbsp;<span class="ident" id="7117048">in</span><span class="op" id="7117050">,</span>&nbsp;<span class="ident" id="7117052">clientRandom</span><span class="op" id="7117064">,</span>&nbsp;<span class="ident" id="7117066">serverRandom</span><span class="op" id="7117078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7117082">if</span>&nbsp;<span class="ident" id="7117085">s</span>&nbsp;<span class="op" id="7117087">:=</span>&nbsp;<span class="ident" id="7117090">hex</span><span class="op" id="7117093">.</span><span class="ident" id="7117094">EncodeToString</span><span class="op" id="7117108">(</span><span class="ident" id="7117109">masterSecret</span><span class="op" id="7117121">)</span><span class="op" id="7117122">;</span>&nbsp;<span class="ident" id="7117124">s</span>&nbsp;<span class="op" id="7117126">!=</span>&nbsp;<span class="ident" id="7117129">test</span><span class="op" id="7117133">.</span><span class="ident" id="7117134">masterSecret</span>&nbsp;<span class="op" id="7117147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7117152">t</span><span class="op" id="7117153">.</span><span class="ident" id="7117154">Errorf</span><span class="op" id="7117160">(</span><span class="string" id="7117161">&#34;#%d:&nbsp;bad&nbsp;master&nbsp;secret&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7117197">,</span>&nbsp;<span class="ident" id="7117199">i</span><span class="op" id="7117200">,</span>&nbsp;<span class="ident" id="7117202">s</span><span class="op" id="7117203">,</span>&nbsp;<span class="ident" id="7117205">test</span><span class="op" id="7117209">.</span><span class="ident" id="7117210">masterSecret</span><span class="op" id="7117222">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7117227">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7117238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7117243">clientMAC</span><span class="op" id="7117252">,</span>&nbsp;<span class="ident" id="7117254">serverMAC</span><span class="op" id="7117263">,</span>&nbsp;<span class="ident" id="7117265">clientKey</span><span class="op" id="7117274">,</span>&nbsp;<span class="ident" id="7117276">serverKey</span><span class="op" id="7117285">,</span>&nbsp;<span class="ident" id="7117287">_</span><span class="op" id="7117288">,</span>&nbsp;<span class="ident" id="7117290">_</span>&nbsp;<span class="op" id="7117292">:=</span>&nbsp;<span class="ident" id="7117295">keysFromMasterSecret</span><span class="op" id="7117315">(</span><span class="ident" id="7117316">test</span><span class="op" id="7117320">.</span><span class="ident" id="7117321">version</span><span class="op" id="7117328">,</span>&nbsp;<span class="ident" id="7117330">masterSecret</span><span class="op" id="7117342">,</span>&nbsp;<span class="ident" id="7117344">clientRandom</span><span class="op" id="7117356">,</span>&nbsp;<span class="ident" id="7117358">serverRandom</span><span class="op" id="7117370">,</span>&nbsp;<span class="ident" id="7117372">test</span><span class="op" id="7117376">.</span><span class="ident" id="7117377">macLen</span><span class="op" id="7117383">,</span>&nbsp;<span class="ident" id="7117385">test</span><span class="op" id="7117389">.</span><span class="ident" id="7117390">keyLen</span><span class="op" id="7117396">,</span>&nbsp;<span class="num" id="7117398">0</span><span class="op" id="7117399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7117403">clientMACString</span>&nbsp;<span class="op" id="7117419">:=</span>&nbsp;<span class="ident" id="7117422">hex</span><span class="op" id="7117425">.</span><span class="ident" id="7117426">EncodeToString</span><span class="op" id="7117440">(</span><span class="ident" id="7117441">clientMAC</span><span class="op" id="7117450">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7117454">serverMACString</span>&nbsp;<span class="op" id="7117470">:=</span>&nbsp;<span class="ident" id="7117473">hex</span><span class="op" id="7117476">.</span><span class="ident" id="7117477">EncodeToString</span><span class="op" id="7117491">(</span><span class="ident" id="7117492">serverMAC</span><span class="op" id="7117501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7117505">clientKeyString</span>&nbsp;<span class="op" id="7117521">:=</span>&nbsp;<span class="ident" id="7117524">hex</span><span class="op" id="7117527">.</span><span class="ident" id="7117528">EncodeToString</span><span class="op" id="7117542">(</span><span class="ident" id="7117543">clientKey</span><span class="op" id="7117552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7117556">serverKeyString</span>&nbsp;<span class="op" id="7117572">:=</span>&nbsp;<span class="ident" id="7117575">hex</span><span class="op" id="7117578">.</span><span class="ident" id="7117579">EncodeToString</span><span class="op" id="7117593">(</span><span class="ident" id="7117594">serverKey</span><span class="op" id="7117603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7117607">if</span>&nbsp;<span class="ident" id="7117610">clientMACString</span>&nbsp;<span class="op" id="7117626">!=</span>&nbsp;<span class="ident" id="7117629">test</span><span class="op" id="7117633">.</span><span class="ident" id="7117634">clientMAC</span>&nbsp;<span class="op" id="7117644">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7117650">serverMACString</span>&nbsp;<span class="op" id="7117666">!=</span>&nbsp;<span class="ident" id="7117669">test</span><span class="op" id="7117673">.</span><span class="ident" id="7117674">serverMAC</span>&nbsp;<span class="op" id="7117684">||</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7117690">clientKeyString</span>&nbsp;<span class="op" id="7117706">!=</span>&nbsp;<span class="ident" id="7117709">test</span><span class="op" id="7117713">.</span><span class="ident" id="7117714">clientKey</span>&nbsp;<span class="op" id="7117724">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7117730">serverKeyString</span>&nbsp;<span class="op" id="7117746">!=</span>&nbsp;<span class="ident" id="7117749">test</span><span class="op" id="7117753">.</span><span class="ident" id="7117754">serverKey</span>&nbsp;<span class="op" id="7117764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7117769">t</span><span class="op" id="7117770">.</span><span class="ident" id="7117771">Errorf</span><span class="op" id="7117777">(</span><span class="string" id="7117778">&#34;#%d:&nbsp;got:&nbsp;(%s,&nbsp;%s,&nbsp;%s,&nbsp;%s)&nbsp;want:&nbsp;(%s,&nbsp;%s,&nbsp;%s,&nbsp;%s)&#34;</span><span class="op" id="7117829">,</span>&nbsp;<span class="ident" id="7117831">i</span><span class="op" id="7117832">,</span>&nbsp;<span class="ident" id="7117834">clientMACString</span><span class="op" id="7117849">,</span>&nbsp;<span class="ident" id="7117851">serverMACString</span><span class="op" id="7117866">,</span>&nbsp;<span class="ident" id="7117868">clientKeyString</span><span class="op" id="7117883">,</span>&nbsp;<span class="ident" id="7117885">serverKeyString</span><span class="op" id="7117900">,</span>&nbsp;<span class="ident" id="7117902">test</span><span class="op" id="7117906">.</span><span class="ident" id="7117907">clientMAC</span><span class="op" id="7117916">,</span>&nbsp;<span class="ident" id="7117918">test</span><span class="op" id="7117922">.</span><span class="ident" id="7117923">serverMAC</span><span class="op" id="7117932">,</span>&nbsp;<span class="ident" id="7117934">test</span><span class="op" id="7117938">.</span><span class="ident" id="7117939">clientKey</span><span class="op" id="7117948">,</span>&nbsp;<span class="ident" id="7117950">test</span><span class="op" id="7117954">.</span><span class="ident" id="7117955">serverKey</span><span class="op" id="7117964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7117968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7117971">}</span><br>
<span class="lineno">70</span><span class="op" id="7117973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7117976">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;from&nbsp;GnuTLS&nbsp;using&nbsp;`gnutls-cli&nbsp;--insecure&nbsp;-d&nbsp;9&nbsp;`</span><br>
<span class="lineno"></span><span class="keyword" id="7118061">var</span>&nbsp;<span class="ident" id="7118065">testKeysFromTests</span>&nbsp;<span class="op" id="7118083">=</span>&nbsp;<span class="op" id="7118085">[</span><span class="op" id="7118086">]</span><span class="ident" id="7118087">testKeysFromTest</span><span class="op" id="7118103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7118106">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7118110">VersionTLS10</span><span class="op" id="7118122">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7118126">&#34;0302cac83ad4b1db3b9ab49ad05957de2a504a634a386fc600889321e1a971f57479466830ac3e6f468e87f5385fa0c5&#34;</span><span class="op" id="7118224">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7118228">&#34;4ae66303755184a3917fcb44880605fcc53baa01912b22ed94473fc69cebd558&#34;</span><span class="op" id="7118294">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7118298">&#34;4ae663020ec16e6bb5130be918cfcafd4d765979a3136a5d50c593446e4e44db&#34;</span><span class="op" id="7118364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7118368">&#34;3d851bab6e5556e959a16bc36d66cfae32f672bfa9ecdef6096cbb1b23472df1da63dbbd9827606413221d149ed08ceb&#34;</span><span class="op" id="7118466">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7118470">&#34;805aaa19b3d2c0a0759a4b6c9959890e08480119&#34;</span><span class="op" id="7118512">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7118516">&#34;2d22f9fe519c075c16448305ceee209fc24ad109&#34;</span><span class="op" id="7118558">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7118562">&#34;d50b5771244f850cd8117a9ccafe2cf1&#34;</span><span class="op" id="7118596">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7118600">&#34;e076e33206b30507a85c32855acd0919&#34;</span><span class="op" id="7118634">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7118638">20</span><span class="op" id="7118640">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7118644">16</span><span class="op" id="7118646">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7118649">}</span><span class="op" id="7118650">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7118653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7118657">VersionTLS10</span><span class="op" id="7118669">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7118673">&#34;03023f7527316bc12cbcd69e4b9e8275d62c028f27e65c745cfcddc7ce01bd3570a111378b63848127f1c36e5f9e4890&#34;</span><span class="op" id="7118771">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7118775">&#34;4ae66364b5ea56b20ce4e25555aed2d7e67f42788dd03f3fee4adae0459ab106&#34;</span><span class="op" id="7118841">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7118845">&#34;4ae66363ab815cbf6a248b87d6b556184e945e9b97fbdf247858b0bdafacfa1c&#34;</span><span class="op" id="7118911">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7118915">&#34;7d64be7c80c59b740200b4b9c26d0baaa1c5ae56705acbcf2307fe62beb4728c19392c83f20483801cce022c77645460&#34;</span><span class="op" id="7119013">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7119017">&#34;97742ed60a0554ca13f04f97ee193177b971e3b0&#34;</span><span class="op" id="7119059">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7119063">&#34;37068751700400e03a8477a5c7eec0813ab9e0dc&#34;</span><span class="op" id="7119105">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7119109">&#34;207cddbc600d2a200abac6502053ee5c&#34;</span><span class="op" id="7119143">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7119147">&#34;df3f94f6e1eacc753b815fe16055cd43&#34;</span><span class="op" id="7119181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7119185">20</span><span class="op" id="7119187">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7119191">16</span><span class="op" id="7119193">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7119196">}</span><span class="op" id="7119197">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7119200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7119204">VersionTLS10</span><span class="op" id="7119216">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7119220">&#34;832d515f1d61eebb2be56ba0ef79879efb9b527504abb386fb4310ed5d0e3b1f220d3bb6b455033a2773e6d8bdf951d278a187482b400d45deb88a5d5a6bb7d6a7a1decc04eb9ef0642876cd4a82d374d3b6ff35f0351dc5d411104de431375355addc39bfb1f6329fb163b0bc298d658338930d07d313cd980a7e3d9196cac1&#34;</span><span class="op" id="7119478">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7119482">&#34;4ae663b2ee389c0de147c509d8f18f5052afc4aaf9699efe8cb05ece883d3a5e&#34;</span><span class="op" id="7119548">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7119552">&#34;4ae664d503fd4cff50cfc1fb8fc606580f87b0fcdac9554ba0e01d785bdf278e&#34;</span><span class="op" id="7119618">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7119622">&#34;1aff2e7a2c4279d0126f57a65a77a8d9d0087cf2733366699bec27eb53d5740705a8574bb1acc2abbe90e44f0dd28d6c&#34;</span><span class="op" id="7119720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7119724">&#34;3c7647c93c1379a31a609542aa44e7f117a70085&#34;</span><span class="op" id="7119766">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7119770">&#34;0d73102994be74a575a3ead8532590ca32a526d4&#34;</span><span class="op" id="7119812">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7119816">&#34;ac7581b0b6c10d85bbd905ffbf36c65e&#34;</span><span class="op" id="7119850">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7119854">&#34;ff07edde49682b45466bd2e39464b306&#34;</span><span class="op" id="7119888">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7119892">20</span><span class="op" id="7119894">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7119898">16</span><span class="op" id="7119900">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7119903">}</span><span class="op" id="7119904">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7119907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7119911">VersionSSL30</span><span class="op" id="7119923">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7119927">&#34;832d515f1d61eebb2be56ba0ef79879efb9b527504abb386fb4310ed5d0e3b1f220d3bb6b455033a2773e6d8bdf951d278a187482b400d45deb88a5d5a6bb7d6a7a1decc04eb9ef0642876cd4a82d374d3b6ff35f0351dc5d411104de431375355addc39bfb1f6329fb163b0bc298d658338930d07d313cd980a7e3d9196cac1&#34;</span><span class="op" id="7120185">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7120189">&#34;4ae663b2ee389c0de147c509d8f18f5052afc4aaf9699efe8cb05ece883d3a5e&#34;</span><span class="op" id="7120255">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7120259">&#34;4ae664d503fd4cff50cfc1fb8fc606580f87b0fcdac9554ba0e01d785bdf278e&#34;</span><span class="op" id="7120325">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7120329">&#34;a614863e56299dcffeea2938f22c2ba023768dbe4b3f6877bc9c346c6ae529b51d9cb87ff9695ea4d01f2205584405b2&#34;</span><span class="op" id="7120427">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7120431">&#34;2c450d5b6f6e2013ac6bea6a0b32200d4e1ffb94&#34;</span><span class="op" id="7120473">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7120477">&#34;7a7a7438769536f2fb1ae49a61f0703b79b2dc53&#34;</span><span class="op" id="7120519">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7120523">&#34;f8f6b26c10f12855c9aafb1e0e839ccf&#34;</span><span class="op" id="7120557">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7120561">&#34;2b9d4b4a60cb7f396780ebff50650419&#34;</span><span class="op" id="7120595">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7120599">20</span><span class="op" id="7120601">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7120605">16</span><span class="op" id="7120607">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7120610">}</span><span class="op" id="7120611">,</span><br>
<span class="lineno"></span><span class="op" id="7120613">}</span>
</div>
</body>
</html>
