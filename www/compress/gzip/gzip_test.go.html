<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6795128">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6795183">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6795237">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6795288">package</span>&nbsp;<span class="ident" id="6795296">gzip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6795302">import</span>&nbsp;<span class="op" id="6795309">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6795312">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6795321">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6795330">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6795343">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6795354">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6795361">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="6795364">//&nbsp;TestEmpty&nbsp;tests&nbsp;that&nbsp;an&nbsp;empty&nbsp;payload&nbsp;still&nbsp;forms&nbsp;a&nbsp;valid&nbsp;GZIP&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="6795438">func</span>&nbsp;<span class="ident" id="6795443">TestEmpty</span><span class="op" id="6795452">(</span><span class="ident" id="6795453">t</span>&nbsp;<span class="op" id="6795455">*</span><span class="ident" id="6795456"><a href="/compress/gzip/gzip_test.go.html#6795343">testing</a></span><span class="op" id="6795463">.</span><span class="ident" id="6795464">T</span><span class="op" id="6795465">)</span>&nbsp;<span class="op" id="6795467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6795470">buf</span>&nbsp;<span class="op" id="6795474">:=</span>&nbsp;<span class="builtinfunc" id="6795477">new</span><span class="op" id="6795480">(</span><span class="ident" id="6795481"><a href="/compress/gzip/gzip_test.go.html#6795321">bytes</a></span><span class="op" id="6795486">.</span><span class="ident" id="6795487">Buffer</span><span class="op" id="6795493">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6795497">if</span>&nbsp;<span class="ident" id="6795500">err</span>&nbsp;<span class="op" id="6795504">:=</span>&nbsp;<span class="ident" id="6795507"><a href="/compress/gzip/gzip.go.html#4303916">NewWriter</a></span><span class="op" id="6795516">(</span><span class="ident" id="6795517"><a href="/compress/gzip/gzip_test.go.html#6795470">buf</a></span><span class="op" id="6795520">)</span><span class="op" id="6795521">.</span><span class="ident" id="6795522">Close</span><span class="op" id="6795527">(</span><span class="op" id="6795528">)</span><span class="op" id="6795529">;</span>&nbsp;<span class="ident" id="6795531"><a href="/compress/gzip/gzip_test.go.html#6795500">err</a></span>&nbsp;<span class="op" id="6795535">!=</span>&nbsp;<span class="ident" id="6795538">nil</span>&nbsp;<span class="op" id="6795542">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6795546"><a href="/compress/gzip/gzip_test.go.html#6795453">t</a></span><span class="op" id="6795547">.</span><span class="ident" id="6795548">Fatalf</span><span class="op" id="6795554">(</span><span class="string" id="6795555">&#34;Writer.Close:&nbsp;%v&#34;</span><span class="op" id="6795573">,</span>&nbsp;<span class="ident" id="6795575"><a href="/compress/gzip/gzip_test.go.html#6795500">err</a></span><span class="op" id="6795578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6795581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6795585">r</span><span class="op" id="6795586">,</span>&nbsp;<span class="ident" id="6795588">err</span>&nbsp;<span class="op" id="6795592">:=</span>&nbsp;<span class="ident" id="6795595"><a href="/compress/gzip/gunzip.go.html#4297686">NewReader</a></span><span class="op" id="6795604">(</span><span class="ident" id="6795605"><a href="/compress/gzip/gzip_test.go.html#6795470">buf</a></span><span class="op" id="6795608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6795611">if</span>&nbsp;<span class="ident" id="6795614"><a href="/compress/gzip/gzip_test.go.html#6795588">err</a></span>&nbsp;<span class="op" id="6795618">!=</span>&nbsp;<span class="ident" id="6795621">nil</span>&nbsp;<span class="op" id="6795625">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6795629"><a href="/compress/gzip/gzip_test.go.html#6795453">t</a></span><span class="op" id="6795630">.</span><span class="ident" id="6795631">Fatalf</span><span class="op" id="6795637">(</span><span class="string" id="6795638">&#34;NewReader:&nbsp;%v&#34;</span><span class="op" id="6795653">,</span>&nbsp;<span class="ident" id="6795655"><a href="/compress/gzip/gzip_test.go.html#6795588">err</a></span><span class="op" id="6795658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6795661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6795664">b</span><span class="op" id="6795665">,</span>&nbsp;<span class="ident" id="6795667"><a href="/compress/gzip/gzip_test.go.html#6795588">err</a></span>&nbsp;<span class="op" id="6795671">:=</span>&nbsp;<span class="ident" id="6795674"><a href="/compress/gzip/gzip_test.go.html#6795330">ioutil</a></span><span class="op" id="6795680">.</span><span class="ident" id="6795681">ReadAll</span><span class="op" id="6795688">(</span><span class="ident" id="6795689"><a href="/compress/gzip/gzip_test.go.html#6795585">r</a></span><span class="op" id="6795690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6795693">if</span>&nbsp;<span class="ident" id="6795696"><a href="/compress/gzip/gzip_test.go.html#6795588">err</a></span>&nbsp;<span class="op" id="6795700">!=</span>&nbsp;<span class="ident" id="6795703">nil</span>&nbsp;<span class="op" id="6795707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6795711"><a href="/compress/gzip/gzip_test.go.html#6795453">t</a></span><span class="op" id="6795712">.</span><span class="ident" id="6795713">Fatalf</span><span class="op" id="6795719">(</span><span class="string" id="6795720">&#34;ReadAll:&nbsp;%v&#34;</span><span class="op" id="6795733">,</span>&nbsp;<span class="ident" id="6795735"><a href="/compress/gzip/gzip_test.go.html#6795588">err</a></span><span class="op" id="6795738">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6795741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6795744">if</span>&nbsp;<span class="builtinfunc" id="6795747">len</span><span class="op" id="6795750">(</span><span class="ident" id="6795751"><a href="/compress/gzip/gzip_test.go.html#6795664">b</a></span><span class="op" id="6795752">)</span>&nbsp;<span class="op" id="6795754">!=</span>&nbsp;<span class="num" id="6795757">0</span>&nbsp;<span class="op" id="6795759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6795763"><a href="/compress/gzip/gzip_test.go.html#6795453">t</a></span><span class="op" id="6795764">.</span><span class="ident" id="6795765">Fatalf</span><span class="op" id="6795771">(</span><span class="string" id="6795772">&#34;got&nbsp;%d&nbsp;bytes,&nbsp;want&nbsp;0&#34;</span><span class="op" id="6795794">,</span>&nbsp;<span class="builtinfunc" id="6795796">len</span><span class="op" id="6795799">(</span><span class="ident" id="6795800"><a href="/compress/gzip/gzip_test.go.html#6795664">b</a></span><span class="op" id="6795801">)</span><span class="op" id="6795802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6795805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6795808">if</span>&nbsp;<span class="ident" id="6795811">err</span>&nbsp;<span class="op" id="6795815">:=</span>&nbsp;<span class="ident" id="6795818"><a href="/compress/gzip/gzip_test.go.html#6795585">r</a></span><span class="op" id="6795819">.</span><span class="ident" id="6795820">Close</span><span class="op" id="6795825">(</span><span class="op" id="6795826">)</span><span class="op" id="6795827">;</span>&nbsp;<span class="ident" id="6795829"><a href="/compress/gzip/gzip_test.go.html#6795811">err</a></span>&nbsp;<span class="op" id="6795833">!=</span>&nbsp;<span class="ident" id="6795836">nil</span>&nbsp;<span class="op" id="6795840">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6795844"><a href="/compress/gzip/gzip_test.go.html#6795453">t</a></span><span class="op" id="6795845">.</span><span class="ident" id="6795846">Fatalf</span><span class="op" id="6795852">(</span><span class="string" id="6795853">&#34;Reader.Close:&nbsp;%v&#34;</span><span class="op" id="6795871">,</span>&nbsp;<span class="ident" id="6795873"><a href="/compress/gzip/gzip_test.go.html#6795811">err</a></span><span class="op" id="6795876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6795879">}</span><br>
<span class="lineno"></span><span class="op" id="6795881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6795884">//&nbsp;TestRoundTrip&nbsp;tests&nbsp;that&nbsp;gzipping&nbsp;and&nbsp;then&nbsp;gunzipping&nbsp;is&nbsp;the&nbsp;identity</span><br>
<span class="lineno">40</span><span class="comment" id="6795957">//&nbsp;function.</span><br>
<span class="lineno"></span><span class="keyword" id="6795970">func</span>&nbsp;<span class="ident" id="6795975">TestRoundTrip</span><span class="op" id="6795988">(</span><span class="ident" id="6795989">t</span>&nbsp;<span class="op" id="6795991">*</span><span class="ident" id="6795992"><a href="/compress/gzip/gzip_test.go.html#6795343">testing</a></span><span class="op" id="6795999">.</span><span class="ident" id="6796000">T</span><span class="op" id="6796001">)</span>&nbsp;<span class="op" id="6796003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6796006">buf</span>&nbsp;<span class="op" id="6796010">:=</span>&nbsp;<span class="builtinfunc" id="6796013">new</span><span class="op" id="6796016">(</span><span class="ident" id="6796017"><a href="/compress/gzip/gzip_test.go.html#6795321">bytes</a></span><span class="op" id="6796022">.</span><span class="ident" id="6796023">Buffer</span><span class="op" id="6796029">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6796033">w</span>&nbsp;<span class="op" id="6796035">:=</span>&nbsp;<span class="ident" id="6796038"><a href="/compress/gzip/gzip.go.html#4303916">NewWriter</a></span><span class="op" id="6796047">(</span><span class="ident" id="6796048"><a href="/compress/gzip/gzip_test.go.html#6796006">buf</a></span><span class="op" id="6796051">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6796054"><a href="/compress/gzip/gzip_test.go.html#6796033">w</a></span><span class="op" id="6796055">.</span><span class="ident" id="6796056">Comment</span>&nbsp;<span class="op" id="6796064">=</span>&nbsp;<span class="string" id="6796066">&#34;comment&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6796077"><a href="/compress/gzip/gzip_test.go.html#6796033">w</a></span><span class="op" id="6796078">.</span><span class="ident" id="6796079">Extra</span>&nbsp;<span class="op" id="6796085">=</span>&nbsp;<span class="op" id="6796087">[</span><span class="op" id="6796088">]</span><span class="builtintype" id="6796089">byte</span><span class="op" id="6796093">(</span><span class="string" id="6796094">&#34;extra&#34;</span><span class="op" id="6796101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6796104"><a href="/compress/gzip/gzip_test.go.html#6796033">w</a></span><span class="op" id="6796105">.</span><span class="ident" id="6796106">ModTime</span>&nbsp;<span class="op" id="6796114">=</span>&nbsp;<span class="ident" id="6796116"><a href="/compress/gzip/gzip_test.go.html#6795354">time</a></span><span class="op" id="6796120">.</span><span class="ident" id="6796121">Unix</span><span class="op" id="6796125">(</span><span class="num" id="6796126">1e8</span><span class="op" id="6796129">,</span>&nbsp;<span class="num" id="6796131">0</span><span class="op" id="6796132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6796135"><a href="/compress/gzip/gzip_test.go.html#6796033">w</a></span><span class="op" id="6796136">.</span><span class="ident" id="6796137">Name</span>&nbsp;<span class="op" id="6796142">=</span>&nbsp;<span class="string" id="6796144">&#34;name&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6796152">if</span>&nbsp;<span class="ident" id="6796155">_</span><span class="op" id="6796156">,</span>&nbsp;<span class="ident" id="6796158">err</span>&nbsp;<span class="op" id="6796162">:=</span>&nbsp;<span class="ident" id="6796165"><a href="/compress/gzip/gzip_test.go.html#6796033">w</a></span><span class="op" id="6796166">.</span><span class="ident" id="6796167">Write</span><span class="op" id="6796172">(</span><span class="op" id="6796173">[</span><span class="op" id="6796174">]</span><span class="builtintype" id="6796175">byte</span><span class="op" id="6796179">(</span><span class="string" id="6796180">&#34;payload&#34;</span><span class="op" id="6796189">)</span><span class="op" id="6796190">)</span><span class="op" id="6796191">;</span>&nbsp;<span class="ident" id="6796193"><a href="/compress/gzip/gzip_test.go.html#6796158">err</a></span>&nbsp;<span class="op" id="6796197">!=</span>&nbsp;<span class="ident" id="6796200">nil</span>&nbsp;<span class="op" id="6796204">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6796208"><a href="/compress/gzip/gzip_test.go.html#6795989">t</a></span><span class="op" id="6796209">.</span><span class="ident" id="6796210">Fatalf</span><span class="op" id="6796216">(</span><span class="string" id="6796217">&#34;Write:&nbsp;%v&#34;</span><span class="op" id="6796228">,</span>&nbsp;<span class="ident" id="6796230"><a href="/compress/gzip/gzip_test.go.html#6796158">err</a></span><span class="op" id="6796233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6796236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6796239">if</span>&nbsp;<span class="ident" id="6796242">err</span>&nbsp;<span class="op" id="6796246">:=</span>&nbsp;<span class="ident" id="6796249"><a href="/compress/gzip/gzip_test.go.html#6796033">w</a></span><span class="op" id="6796250">.</span><span class="ident" id="6796251">Close</span><span class="op" id="6796256">(</span><span class="op" id="6796257">)</span><span class="op" id="6796258">;</span>&nbsp;<span class="ident" id="6796260"><a href="/compress/gzip/gzip_test.go.html#6796242">err</a></span>&nbsp;<span class="op" id="6796264">!=</span>&nbsp;<span class="ident" id="6796267">nil</span>&nbsp;<span class="op" id="6796271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6796275"><a href="/compress/gzip/gzip_test.go.html#6795989">t</a></span><span class="op" id="6796276">.</span><span class="ident" id="6796277">Fatalf</span><span class="op" id="6796283">(</span><span class="string" id="6796284">&#34;Writer.Close:&nbsp;%v&#34;</span><span class="op" id="6796302">,</span>&nbsp;<span class="ident" id="6796304"><a href="/compress/gzip/gzip_test.go.html#6796242">err</a></span><span class="op" id="6796307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6796310">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6796314">r</span><span class="op" id="6796315">,</span>&nbsp;<span class="ident" id="6796317">err</span>&nbsp;<span class="op" id="6796321">:=</span>&nbsp;<span class="ident" id="6796324"><a href="/compress/gzip/gunzip.go.html#4297686">NewReader</a></span><span class="op" id="6796333">(</span><span class="ident" id="6796334"><a href="/compress/gzip/gzip_test.go.html#6796006">buf</a></span><span class="op" id="6796337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6796340">if</span>&nbsp;<span class="ident" id="6796343"><a href="/compress/gzip/gzip_test.go.html#6796317">err</a></span>&nbsp;<span class="op" id="6796347">!=</span>&nbsp;<span class="ident" id="6796350">nil</span>&nbsp;<span class="op" id="6796354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6796358"><a href="/compress/gzip/gzip_test.go.html#6795989">t</a></span><span class="op" id="6796359">.</span><span class="ident" id="6796360">Fatalf</span><span class="op" id="6796366">(</span><span class="string" id="6796367">&#34;NewReader:&nbsp;%v&#34;</span><span class="op" id="6796382">,</span>&nbsp;<span class="ident" id="6796384"><a href="/compress/gzip/gzip_test.go.html#6796317">err</a></span><span class="op" id="6796387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6796390">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6796393">b</span><span class="op" id="6796394">,</span>&nbsp;<span class="ident" id="6796396"><a href="/compress/gzip/gzip_test.go.html#6796317">err</a></span>&nbsp;<span class="op" id="6796400">:=</span>&nbsp;<span class="ident" id="6796403"><a href="/compress/gzip/gzip_test.go.html#6795330">ioutil</a></span><span class="op" id="6796409">.</span><span class="ident" id="6796410">ReadAll</span><span class="op" id="6796417">(</span><span class="ident" id="6796418"><a href="/compress/gzip/gzip_test.go.html#6796314">r</a></span><span class="op" id="6796419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6796422">if</span>&nbsp;<span class="ident" id="6796425"><a href="/compress/gzip/gzip_test.go.html#6796317">err</a></span>&nbsp;<span class="op" id="6796429">!=</span>&nbsp;<span class="ident" id="6796432">nil</span>&nbsp;<span class="op" id="6796436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6796440"><a href="/compress/gzip/gzip_test.go.html#6795989">t</a></span><span class="op" id="6796441">.</span><span class="ident" id="6796442">Fatalf</span><span class="op" id="6796448">(</span><span class="string" id="6796449">&#34;ReadAll:&nbsp;%v&#34;</span><span class="op" id="6796462">,</span>&nbsp;<span class="ident" id="6796464"><a href="/compress/gzip/gzip_test.go.html#6796317">err</a></span><span class="op" id="6796467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6796470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6796473">if</span>&nbsp;<span class="builtintype" id="6796476">string</span><span class="op" id="6796482">(</span><span class="ident" id="6796483"><a href="/compress/gzip/gzip_test.go.html#6796393">b</a></span><span class="op" id="6796484">)</span>&nbsp;<span class="op" id="6796486">!=</span>&nbsp;<span class="string" id="6796489">&#34;payload&#34;</span>&nbsp;<span class="op" id="6796499">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6796503"><a href="/compress/gzip/gzip_test.go.html#6795989">t</a></span><span class="op" id="6796504">.</span><span class="ident" id="6796505">Fatalf</span><span class="op" id="6796511">(</span><span class="string" id="6796512">&#34;payload&nbsp;is&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6796536">,</span>&nbsp;<span class="builtintype" id="6796538">string</span><span class="op" id="6796544">(</span><span class="ident" id="6796545"><a href="/compress/gzip/gzip_test.go.html#6796393">b</a></span><span class="op" id="6796546">)</span><span class="op" id="6796547">,</span>&nbsp;<span class="string" id="6796549">&#34;payload&#34;</span><span class="op" id="6796558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6796561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6796564">if</span>&nbsp;<span class="ident" id="6796567"><a href="/compress/gzip/gzip_test.go.html#6796314">r</a></span><span class="op" id="6796568">.</span><span class="ident" id="6796569">Comment</span>&nbsp;<span class="op" id="6796577">!=</span>&nbsp;<span class="string" id="6796580">&#34;comment&#34;</span>&nbsp;<span class="op" id="6796590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6796594"><a href="/compress/gzip/gzip_test.go.html#6795989">t</a></span><span class="op" id="6796595">.</span><span class="ident" id="6796596">Fatalf</span><span class="op" id="6796602">(</span><span class="string" id="6796603">&#34;comment&nbsp;is&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6796627">,</span>&nbsp;<span class="ident" id="6796629"><a href="/compress/gzip/gzip_test.go.html#6796314">r</a></span><span class="op" id="6796630">.</span><span class="ident" id="6796631">Comment</span><span class="op" id="6796638">,</span>&nbsp;<span class="string" id="6796640">&#34;comment&#34;</span><span class="op" id="6796649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6796652">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6796655">if</span>&nbsp;<span class="builtintype" id="6796658">string</span><span class="op" id="6796664">(</span><span class="ident" id="6796665"><a href="/compress/gzip/gzip_test.go.html#6796314">r</a></span><span class="op" id="6796666">.</span><span class="ident" id="6796667">Extra</span><span class="op" id="6796672">)</span>&nbsp;<span class="op" id="6796674">!=</span>&nbsp;<span class="string" id="6796677">&#34;extra&#34;</span>&nbsp;<span class="op" id="6796685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6796689"><a href="/compress/gzip/gzip_test.go.html#6795989">t</a></span><span class="op" id="6796690">.</span><span class="ident" id="6796691">Fatalf</span><span class="op" id="6796697">(</span><span class="string" id="6796698">&#34;extra&nbsp;is&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6796720">,</span>&nbsp;<span class="ident" id="6796722"><a href="/compress/gzip/gzip_test.go.html#6796314">r</a></span><span class="op" id="6796723">.</span><span class="ident" id="6796724">Extra</span><span class="op" id="6796729">,</span>&nbsp;<span class="string" id="6796731">&#34;extra&#34;</span><span class="op" id="6796738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6796741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6796744">if</span>&nbsp;<span class="ident" id="6796747"><a href="/compress/gzip/gzip_test.go.html#6796314">r</a></span><span class="op" id="6796748">.</span><span class="ident" id="6796749">ModTime</span><span class="op" id="6796756">.</span><span class="ident" id="6796757">Unix</span><span class="op" id="6796761">(</span><span class="op" id="6796762">)</span>&nbsp;<span class="op" id="6796764">!=</span>&nbsp;<span class="num" id="6796767">1e8</span>&nbsp;<span class="op" id="6796771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6796775"><a href="/compress/gzip/gzip_test.go.html#6795989">t</a></span><span class="op" id="6796776">.</span><span class="ident" id="6796777">Fatalf</span><span class="op" id="6796783">(</span><span class="string" id="6796784">&#34;mtime&nbsp;is&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="6796806">,</span>&nbsp;<span class="ident" id="6796808"><a href="/compress/gzip/gzip_test.go.html#6796314">r</a></span><span class="op" id="6796809">.</span><span class="ident" id="6796810">ModTime</span><span class="op" id="6796817">.</span><span class="ident" id="6796818">Unix</span><span class="op" id="6796822">(</span><span class="op" id="6796823">)</span><span class="op" id="6796824">,</span>&nbsp;<span class="builtintype" id="6796826">uint32</span><span class="op" id="6796832">(</span><span class="num" id="6796833">1e8</span><span class="op" id="6796836">)</span><span class="op" id="6796837">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6796840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6796843">if</span>&nbsp;<span class="ident" id="6796846"><a href="/compress/gzip/gzip_test.go.html#6796314">r</a></span><span class="op" id="6796847">.</span><span class="ident" id="6796848">Name</span>&nbsp;<span class="op" id="6796853">!=</span>&nbsp;<span class="string" id="6796856">&#34;name&#34;</span>&nbsp;<span class="op" id="6796863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6796867"><a href="/compress/gzip/gzip_test.go.html#6795989">t</a></span><span class="op" id="6796868">.</span><span class="ident" id="6796869">Fatalf</span><span class="op" id="6796875">(</span><span class="string" id="6796876">&#34;name&nbsp;is&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6796897">,</span>&nbsp;<span class="ident" id="6796899"><a href="/compress/gzip/gzip_test.go.html#6796314">r</a></span><span class="op" id="6796900">.</span><span class="ident" id="6796901">Name</span><span class="op" id="6796905">,</span>&nbsp;<span class="string" id="6796907">&#34;name&#34;</span><span class="op" id="6796913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6796916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6796919">if</span>&nbsp;<span class="ident" id="6796922">err</span>&nbsp;<span class="op" id="6796926">:=</span>&nbsp;<span class="ident" id="6796929"><a href="/compress/gzip/gzip_test.go.html#6796314">r</a></span><span class="op" id="6796930">.</span><span class="ident" id="6796931">Close</span><span class="op" id="6796936">(</span><span class="op" id="6796937">)</span><span class="op" id="6796938">;</span>&nbsp;<span class="ident" id="6796940"><a href="/compress/gzip/gzip_test.go.html#6796922">err</a></span>&nbsp;<span class="op" id="6796944">!=</span>&nbsp;<span class="ident" id="6796947">nil</span>&nbsp;<span class="op" id="6796951">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6796955"><a href="/compress/gzip/gzip_test.go.html#6795989">t</a></span><span class="op" id="6796956">.</span><span class="ident" id="6796957">Fatalf</span><span class="op" id="6796963">(</span><span class="string" id="6796964">&#34;Reader.Close:&nbsp;%v&#34;</span><span class="op" id="6796982">,</span>&nbsp;<span class="ident" id="6796984"><a href="/compress/gzip/gzip_test.go.html#6796922">err</a></span><span class="op" id="6796987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6796990">}</span><br>
<span class="lineno"></span><span class="op" id="6796992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6796995">//&nbsp;TestLatin1&nbsp;tests&nbsp;the&nbsp;internal&nbsp;functions&nbsp;for&nbsp;converting&nbsp;to&nbsp;and&nbsp;from&nbsp;Latin-1.</span><br>
<span class="lineno">85</span><span class="keyword" id="6797074">func</span>&nbsp;<span class="ident" id="6797079">TestLatin1</span><span class="op" id="6797089">(</span><span class="ident" id="6797090">t</span>&nbsp;<span class="op" id="6797092">*</span><span class="ident" id="6797093"><a href="/compress/gzip/gzip_test.go.html#6795343">testing</a></span><span class="op" id="6797100">.</span><span class="ident" id="6797101">T</span><span class="op" id="6797102">)</span>&nbsp;<span class="op" id="6797104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6797107">latin1</span>&nbsp;<span class="op" id="6797114">:=</span>&nbsp;<span class="op" id="6797117">[</span><span class="op" id="6797118">]</span><span class="builtintype" id="6797119">byte</span><span class="op" id="6797123">{</span><span class="num" id="6797124">0xc4</span><span class="op" id="6797128">,</span>&nbsp;<span class="string" id="6797130">&#39;u&#39;</span><span class="op" id="6797133">,</span>&nbsp;<span class="num" id="6797135">0xdf</span><span class="op" id="6797139">,</span>&nbsp;<span class="string" id="6797141">&#39;e&#39;</span><span class="op" id="6797144">,</span>&nbsp;<span class="string" id="6797146">&#39;r&#39;</span><span class="op" id="6797149">,</span>&nbsp;<span class="string" id="6797151">&#39;u&#39;</span><span class="op" id="6797154">,</span>&nbsp;<span class="string" id="6797156">&#39;n&#39;</span><span class="op" id="6797159">,</span>&nbsp;<span class="string" id="6797161">&#39;g&#39;</span><span class="op" id="6797164">,</span>&nbsp;<span class="num" id="6797166">0</span><span class="op" id="6797167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6797170">utf8</span>&nbsp;<span class="op" id="6797175">:=</span>&nbsp;<span class="string" id="6797178">&#34;Äußerung&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6797192">z</span>&nbsp;<span class="op" id="6797194">:=</span>&nbsp;<span class="ident" id="6797197"><a href="/compress/gzip/gunzip.go.html#4297225">Reader</a></span><span class="op" id="6797203">{</span><span class="ident" id="6797204">r</span><span class="op" id="6797205">:</span>&nbsp;<span class="ident" id="6797207"><a href="/compress/gzip/gzip_test.go.html#6795312">bufio</a></span><span class="op" id="6797212">.</span><span class="ident" id="6797213">NewReader</span><span class="op" id="6797222">(</span><span class="ident" id="6797223"><a href="/compress/gzip/gzip_test.go.html#6795321">bytes</a></span><span class="op" id="6797228">.</span><span class="ident" id="6797229">NewReader</span><span class="op" id="6797238">(</span><span class="ident" id="6797239"><a href="/compress/gzip/gzip_test.go.html#6797107">latin1</a></span><span class="op" id="6797245">)</span><span class="op" id="6797246">)</span><span class="op" id="6797247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6797250">s</span><span class="op" id="6797251">,</span>&nbsp;<span class="ident" id="6797253">err</span>&nbsp;<span class="op" id="6797257">:=</span>&nbsp;<span class="ident" id="6797260"><a href="/compress/gzip/gzip_test.go.html#6797192">z</a></span><span class="op" id="6797261">.</span><span class="ident" id="6797262">readString</span><span class="op" id="6797272">(</span><span class="op" id="6797273">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6797276">if</span>&nbsp;<span class="ident" id="6797279"><a href="/compress/gzip/gzip_test.go.html#6797253">err</a></span>&nbsp;<span class="op" id="6797283">!=</span>&nbsp;<span class="ident" id="6797286">nil</span>&nbsp;<span class="op" id="6797290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6797294"><a href="/compress/gzip/gzip_test.go.html#6797090">t</a></span><span class="op" id="6797295">.</span><span class="ident" id="6797296">Fatalf</span><span class="op" id="6797302">(</span><span class="string" id="6797303">&#34;readString:&nbsp;%v&#34;</span><span class="op" id="6797319">,</span>&nbsp;<span class="ident" id="6797321"><a href="/compress/gzip/gzip_test.go.html#6797253">err</a></span><span class="op" id="6797324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6797327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6797330">if</span>&nbsp;<span class="ident" id="6797333"><a href="/compress/gzip/gzip_test.go.html#6797250">s</a></span>&nbsp;<span class="op" id="6797335">!=</span>&nbsp;<span class="ident" id="6797338"><a href="/compress/gzip/gzip_test.go.html#6797170">utf8</a></span>&nbsp;<span class="op" id="6797343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6797347"><a href="/compress/gzip/gzip_test.go.html#6797090">t</a></span><span class="op" id="6797348">.</span><span class="ident" id="6797349">Fatalf</span><span class="op" id="6797355">(</span><span class="string" id="6797356">&#34;read&nbsp;latin-1:&nbsp;got&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6797387">,</span>&nbsp;<span class="ident" id="6797389"><a href="/compress/gzip/gzip_test.go.html#6797250">s</a></span><span class="op" id="6797390">,</span>&nbsp;<span class="ident" id="6797392"><a href="/compress/gzip/gzip_test.go.html#6797170">utf8</a></span><span class="op" id="6797396">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6797399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6797403">buf</span>&nbsp;<span class="op" id="6797407">:=</span>&nbsp;<span class="ident" id="6797410"><a href="/compress/gzip/gzip_test.go.html#6795321">bytes</a></span><span class="op" id="6797415">.</span><span class="ident" id="6797416">NewBuffer</span><span class="op" id="6797425">(</span><span class="builtinfunc" id="6797426">make</span><span class="op" id="6797430">(</span><span class="op" id="6797431">[</span><span class="op" id="6797432">]</span><span class="builtintype" id="6797433">byte</span><span class="op" id="6797437">,</span>&nbsp;<span class="num" id="6797439">0</span><span class="op" id="6797440">,</span>&nbsp;<span class="builtinfunc" id="6797442">len</span><span class="op" id="6797445">(</span><span class="ident" id="6797446"><a href="/compress/gzip/gzip_test.go.html#6797107">latin1</a></span><span class="op" id="6797452">)</span><span class="op" id="6797453">)</span><span class="op" id="6797454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6797457">c</span>&nbsp;<span class="op" id="6797459">:=</span>&nbsp;<span class="ident" id="6797462"><a href="/compress/gzip/gzip.go.html#4303126">Writer</a></span><span class="op" id="6797468">{</span><span class="ident" id="6797469">w</span><span class="op" id="6797470">:</span>&nbsp;<span class="ident" id="6797472"><a href="/compress/gzip/gzip_test.go.html#6797403">buf</a></span><span class="op" id="6797475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6797478">if</span>&nbsp;<span class="ident" id="6797481"><a href="/compress/gzip/gzip_test.go.html#6797253">err</a></span>&nbsp;<span class="op" id="6797485">=</span>&nbsp;<span class="ident" id="6797487"><a href="/compress/gzip/gzip_test.go.html#6797457">c</a></span><span class="op" id="6797488">.</span><span class="ident" id="6797489">writeString</span><span class="op" id="6797500">(</span><span class="ident" id="6797501"><a href="/compress/gzip/gzip_test.go.html#6797170">utf8</a></span><span class="op" id="6797505">)</span><span class="op" id="6797506">;</span>&nbsp;<span class="ident" id="6797508"><a href="/compress/gzip/gzip_test.go.html#6797253">err</a></span>&nbsp;<span class="op" id="6797512">!=</span>&nbsp;<span class="ident" id="6797515">nil</span>&nbsp;<span class="op" id="6797519">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6797523"><a href="/compress/gzip/gzip_test.go.html#6797090">t</a></span><span class="op" id="6797524">.</span><span class="ident" id="6797525">Fatalf</span><span class="op" id="6797531">(</span><span class="string" id="6797532">&#34;writeString:&nbsp;%v&#34;</span><span class="op" id="6797549">,</span>&nbsp;<span class="ident" id="6797551"><a href="/compress/gzip/gzip_test.go.html#6797253">err</a></span><span class="op" id="6797554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6797557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6797560"><a href="/compress/gzip/gzip_test.go.html#6797250">s</a></span>&nbsp;<span class="op" id="6797562">=</span>&nbsp;<span class="ident" id="6797564"><a href="/compress/gzip/gzip_test.go.html#6797403">buf</a></span><span class="op" id="6797567">.</span><span class="ident" id="6797568">String</span><span class="op" id="6797574">(</span><span class="op" id="6797575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6797578">if</span>&nbsp;<span class="ident" id="6797581"><a href="/compress/gzip/gzip_test.go.html#6797250">s</a></span>&nbsp;<span class="op" id="6797583">!=</span>&nbsp;<span class="builtintype" id="6797586">string</span><span class="op" id="6797592">(</span><span class="ident" id="6797593"><a href="/compress/gzip/gzip_test.go.html#6797107">latin1</a></span><span class="op" id="6797599">)</span>&nbsp;<span class="op" id="6797601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6797605"><a href="/compress/gzip/gzip_test.go.html#6797090">t</a></span><span class="op" id="6797606">.</span><span class="ident" id="6797607">Fatalf</span><span class="op" id="6797613">(</span><span class="string" id="6797614">&#34;write&nbsp;utf-8:&nbsp;got&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6797644">,</span>&nbsp;<span class="ident" id="6797646"><a href="/compress/gzip/gzip_test.go.html#6797250">s</a></span><span class="op" id="6797647">,</span>&nbsp;<span class="builtintype" id="6797649">string</span><span class="op" id="6797655">(</span><span class="ident" id="6797656"><a href="/compress/gzip/gzip_test.go.html#6797107">latin1</a></span><span class="op" id="6797662">)</span><span class="op" id="6797663">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6797666">}</span><br>
<span class="lineno"></span><span class="op" id="6797668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6797671">//&nbsp;TestLatin1RoundTrip&nbsp;tests&nbsp;that&nbsp;metadata&nbsp;that&nbsp;is&nbsp;representable&nbsp;in&nbsp;Latin-1</span><br>
<span class="lineno"></span><span class="comment" id="6797747">//&nbsp;survives&nbsp;a&nbsp;round&nbsp;trip.</span><br>
<span class="lineno">110</span><span class="keyword" id="6797773">func</span>&nbsp;<span class="ident" id="6797778">TestLatin1RoundTrip</span><span class="op" id="6797797">(</span><span class="ident" id="6797798">t</span>&nbsp;<span class="op" id="6797800">*</span><span class="ident" id="6797801"><a href="/compress/gzip/gzip_test.go.html#6795343">testing</a></span><span class="op" id="6797808">.</span><span class="ident" id="6797809">T</span><span class="op" id="6797810">)</span>&nbsp;<span class="op" id="6797812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6797815">testCases</span>&nbsp;<span class="op" id="6797825">:=</span>&nbsp;<span class="op" id="6797828">[</span><span class="op" id="6797829">]</span><span class="keyword" id="6797830">struct</span>&nbsp;<span class="op" id="6797837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6797841">name</span>&nbsp;<span class="builtintype" id="6797846">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6797855">ok</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6797860">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6797866">}</span><span class="op" id="6797867">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6797871">{</span><span class="string" id="6797872">&#34;&#34;</span><span class="op" id="6797874">,</span>&nbsp;<span class="builtintype" id="6797876">true</span><span class="op" id="6797880">}</span><span class="op" id="6797881">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6797885">{</span><span class="string" id="6797886">&#34;ASCII&nbsp;is&nbsp;OK&#34;</span><span class="op" id="6797899">,</span>&nbsp;<span class="builtintype" id="6797901">true</span><span class="op" id="6797905">}</span><span class="op" id="6797906">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6797910">{</span><span class="string" id="6797911">&#34;unless&nbsp;it&nbsp;contains&nbsp;a&nbsp;NUL\x00&#34;</span><span class="op" id="6797941">,</span>&nbsp;<span class="builtintype" id="6797943">false</span><span class="op" id="6797948">}</span><span class="op" id="6797949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6797953">{</span><span class="string" id="6797954">&#34;no&nbsp;matter&nbsp;where&nbsp;\x00&nbsp;occurs&#34;</span><span class="op" id="6797983">,</span>&nbsp;<span class="builtintype" id="6797985">false</span><span class="op" id="6797990">}</span><span class="op" id="6797991">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6797995">{</span><span class="string" id="6797996">&#34;\x00\x00\x00&#34;</span><span class="op" id="6798010">,</span>&nbsp;<span class="builtintype" id="6798012">false</span><span class="op" id="6798017">}</span><span class="op" id="6798018">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6798022">{</span><span class="string" id="6798023">&#34;Látin-1&nbsp;also&nbsp;passes&nbsp;(U+00E1)&#34;</span><span class="op" id="6798054">,</span>&nbsp;<span class="builtintype" id="6798056">true</span><span class="op" id="6798060">}</span><span class="op" id="6798061">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6798065">{</span><span class="string" id="6798066">&#34;but&nbsp;LĀtin&nbsp;Extended-A&nbsp;(U+0100)&nbsp;does&nbsp;not&#34;</span><span class="op" id="6798107">,</span>&nbsp;<span class="builtintype" id="6798109">false</span><span class="op" id="6798114">}</span><span class="op" id="6798115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6798119">{</span><span class="string" id="6798120">&#34;neither&nbsp;does&nbsp;日本語&#34;</span><span class="op" id="6798144">,</span>&nbsp;<span class="builtintype" id="6798146">false</span><span class="op" id="6798151">}</span><span class="op" id="6798152">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6798156">{</span><span class="string" id="6798157">&#34;invalid&nbsp;UTF-8&nbsp;also&nbsp;\xffails&#34;</span><span class="op" id="6798186">,</span>&nbsp;<span class="builtintype" id="6798188">false</span><span class="op" id="6798193">}</span><span class="op" id="6798194">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6798198">{</span><span class="string" id="6798199">&#34;\x00&nbsp;as&nbsp;does&nbsp;Látin-1&nbsp;with&nbsp;NUL&#34;</span><span class="op" id="6798231">,</span>&nbsp;<span class="builtintype" id="6798233">false</span><span class="op" id="6798238">}</span><span class="op" id="6798239">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6798242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6798245">for</span>&nbsp;<span class="ident" id="6798249">_</span><span class="op" id="6798250">,</span>&nbsp;<span class="ident" id="6798252">tc</span>&nbsp;<span class="op" id="6798255">:=</span>&nbsp;<span class="keyword" id="6798258">range</span>&nbsp;<span class="ident" id="6798264"><a href="/compress/gzip/gzip_test.go.html#6797815">testCases</a></span>&nbsp;<span class="op" id="6798274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6798278">buf</span>&nbsp;<span class="op" id="6798282">:=</span>&nbsp;<span class="builtinfunc" id="6798285">new</span><span class="op" id="6798288">(</span><span class="ident" id="6798289"><a href="/compress/gzip/gzip_test.go.html#6795321">bytes</a></span><span class="op" id="6798294">.</span><span class="ident" id="6798295">Buffer</span><span class="op" id="6798301">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6798306">w</span>&nbsp;<span class="op" id="6798308">:=</span>&nbsp;<span class="ident" id="6798311"><a href="/compress/gzip/gzip.go.html#4303916">NewWriter</a></span><span class="op" id="6798320">(</span><span class="ident" id="6798321"><a href="/compress/gzip/gzip_test.go.html#6798278">buf</a></span><span class="op" id="6798324">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6798328"><a href="/compress/gzip/gzip_test.go.html#6798306">w</a></span><span class="op" id="6798329">.</span><span class="ident" id="6798330">Name</span>&nbsp;<span class="op" id="6798335">=</span>&nbsp;<span class="ident" id="6798337"><a href="/compress/gzip/gzip_test.go.html#6798252">tc</a></span><span class="op" id="6798339">.</span><span class="ident" id="6798340">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6798347">err</span>&nbsp;<span class="op" id="6798351">:=</span>&nbsp;<span class="ident" id="6798354"><a href="/compress/gzip/gzip_test.go.html#6798306">w</a></span><span class="op" id="6798355">.</span><span class="ident" id="6798356">Close</span><span class="op" id="6798361">(</span><span class="op" id="6798362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6798366">if</span>&nbsp;<span class="op" id="6798369">(</span><span class="ident" id="6798370"><a href="/compress/gzip/gzip_test.go.html#6798347">err</a></span>&nbsp;<span class="op" id="6798374">==</span>&nbsp;<span class="ident" id="6798377">nil</span><span class="op" id="6798380">)</span>&nbsp;<span class="op" id="6798382">!=</span>&nbsp;<span class="ident" id="6798385"><a href="/compress/gzip/gzip_test.go.html#6798252">tc</a></span><span class="op" id="6798387">.</span><span class="ident" id="6798388">ok</span>&nbsp;<span class="op" id="6798391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6798396"><a href="/compress/gzip/gzip_test.go.html#6797798">t</a></span><span class="op" id="6798397">.</span><span class="ident" id="6798398">Errorf</span><span class="op" id="6798404">(</span><span class="string" id="6798405">&#34;Writer.Close:&nbsp;name&nbsp;=&nbsp;%q,&nbsp;err&nbsp;=&nbsp;%v&#34;</span><span class="op" id="6798440">,</span>&nbsp;<span class="ident" id="6798442"><a href="/compress/gzip/gzip_test.go.html#6798252">tc</a></span><span class="op" id="6798444">.</span><span class="ident" id="6798445">name</span><span class="op" id="6798449">,</span>&nbsp;<span class="ident" id="6798451"><a href="/compress/gzip/gzip_test.go.html#6798347">err</a></span><span class="op" id="6798454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6798459">continue</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6798470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6798474">if</span>&nbsp;<span class="op" id="6798477">!</span><span class="ident" id="6798478"><a href="/compress/gzip/gzip_test.go.html#6798252">tc</a></span><span class="op" id="6798480">.</span><span class="ident" id="6798481">ok</span>&nbsp;<span class="op" id="6798484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6798489">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6798500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6798505">r</span><span class="op" id="6798506">,</span>&nbsp;<span class="ident" id="6798508"><a href="/compress/gzip/gzip_test.go.html#6798347">err</a></span>&nbsp;<span class="op" id="6798512">:=</span>&nbsp;<span class="ident" id="6798515"><a href="/compress/gzip/gunzip.go.html#4297686">NewReader</a></span><span class="op" id="6798524">(</span><span class="ident" id="6798525"><a href="/compress/gzip/gzip_test.go.html#6798278">buf</a></span><span class="op" id="6798528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6798532">if</span>&nbsp;<span class="ident" id="6798535"><a href="/compress/gzip/gzip_test.go.html#6798347">err</a></span>&nbsp;<span class="op" id="6798539">!=</span>&nbsp;<span class="ident" id="6798542">nil</span>&nbsp;<span class="op" id="6798546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6798551"><a href="/compress/gzip/gzip_test.go.html#6797798">t</a></span><span class="op" id="6798552">.</span><span class="ident" id="6798553">Errorf</span><span class="op" id="6798559">(</span><span class="string" id="6798560">&#34;NewReader:&nbsp;%v&#34;</span><span class="op" id="6798575">,</span>&nbsp;<span class="ident" id="6798577"><a href="/compress/gzip/gzip_test.go.html#6798347">err</a></span><span class="op" id="6798580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6798585">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6798596">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6798600">_</span><span class="op" id="6798601">,</span>&nbsp;<span class="ident" id="6798603"><a href="/compress/gzip/gzip_test.go.html#6798347">err</a></span>&nbsp;<span class="op" id="6798607">=</span>&nbsp;<span class="ident" id="6798609"><a href="/compress/gzip/gzip_test.go.html#6795330">ioutil</a></span><span class="op" id="6798615">.</span><span class="ident" id="6798616">ReadAll</span><span class="op" id="6798623">(</span><span class="ident" id="6798624"><a href="/compress/gzip/gzip_test.go.html#6798505">r</a></span><span class="op" id="6798625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6798629">if</span>&nbsp;<span class="ident" id="6798632"><a href="/compress/gzip/gzip_test.go.html#6798347">err</a></span>&nbsp;<span class="op" id="6798636">!=</span>&nbsp;<span class="ident" id="6798639">nil</span>&nbsp;<span class="op" id="6798643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6798648"><a href="/compress/gzip/gzip_test.go.html#6797798">t</a></span><span class="op" id="6798649">.</span><span class="ident" id="6798650">Errorf</span><span class="op" id="6798656">(</span><span class="string" id="6798657">&#34;ReadAll:&nbsp;%v&#34;</span><span class="op" id="6798670">,</span>&nbsp;<span class="ident" id="6798672"><a href="/compress/gzip/gzip_test.go.html#6798347">err</a></span><span class="op" id="6798675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6798680">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6798691">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6798695">if</span>&nbsp;<span class="ident" id="6798698"><a href="/compress/gzip/gzip_test.go.html#6798505">r</a></span><span class="op" id="6798699">.</span><span class="ident" id="6798700">Name</span>&nbsp;<span class="op" id="6798705">!=</span>&nbsp;<span class="ident" id="6798708"><a href="/compress/gzip/gzip_test.go.html#6798252">tc</a></span><span class="op" id="6798710">.</span><span class="ident" id="6798711">name</span>&nbsp;<span class="op" id="6798716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6798721"><a href="/compress/gzip/gzip_test.go.html#6797798">t</a></span><span class="op" id="6798722">.</span><span class="ident" id="6798723">Errorf</span><span class="op" id="6798729">(</span><span class="string" id="6798730">&#34;name&nbsp;is&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6798751">,</span>&nbsp;<span class="ident" id="6798753"><a href="/compress/gzip/gzip_test.go.html#6798505">r</a></span><span class="op" id="6798754">.</span><span class="ident" id="6798755">Name</span><span class="op" id="6798759">,</span>&nbsp;<span class="ident" id="6798761"><a href="/compress/gzip/gzip_test.go.html#6798252">tc</a></span><span class="op" id="6798763">.</span><span class="ident" id="6798764">name</span><span class="op" id="6798768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6798773">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6798784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6798788">if</span>&nbsp;<span class="ident" id="6798791">err</span>&nbsp;<span class="op" id="6798795">:=</span>&nbsp;<span class="ident" id="6798798"><a href="/compress/gzip/gzip_test.go.html#6798505">r</a></span><span class="op" id="6798799">.</span><span class="ident" id="6798800">Close</span><span class="op" id="6798805">(</span><span class="op" id="6798806">)</span><span class="op" id="6798807">;</span>&nbsp;<span class="ident" id="6798809"><a href="/compress/gzip/gzip_test.go.html#6798791">err</a></span>&nbsp;<span class="op" id="6798813">!=</span>&nbsp;<span class="ident" id="6798816">nil</span>&nbsp;<span class="op" id="6798820">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6798825"><a href="/compress/gzip/gzip_test.go.html#6797798">t</a></span><span class="op" id="6798826">.</span><span class="ident" id="6798827">Errorf</span><span class="op" id="6798833">(</span><span class="string" id="6798834">&#34;Reader.Close:&nbsp;%v&#34;</span><span class="op" id="6798852">,</span>&nbsp;<span class="ident" id="6798854"><a href="/compress/gzip/gzip_test.go.html#6798791">err</a></span><span class="op" id="6798857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6798862">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6798873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6798876">}</span><br>
<span class="lineno"></span><span class="op" id="6798878">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="keyword" id="6798881">func</span>&nbsp;<span class="ident" id="6798886">TestWriterFlush</span><span class="op" id="6798901">(</span><span class="ident" id="6798902">t</span>&nbsp;<span class="op" id="6798904">*</span><span class="ident" id="6798905"><a href="/compress/gzip/gzip_test.go.html#6795343">testing</a></span><span class="op" id="6798912">.</span><span class="ident" id="6798913">T</span><span class="op" id="6798914">)</span>&nbsp;<span class="op" id="6798916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6798919">buf</span>&nbsp;<span class="op" id="6798923">:=</span>&nbsp;<span class="builtinfunc" id="6798926">new</span><span class="op" id="6798929">(</span><span class="ident" id="6798930"><a href="/compress/gzip/gzip_test.go.html#6795321">bytes</a></span><span class="op" id="6798935">.</span><span class="ident" id="6798936">Buffer</span><span class="op" id="6798942">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6798946">w</span>&nbsp;<span class="op" id="6798948">:=</span>&nbsp;<span class="ident" id="6798951"><a href="/compress/gzip/gzip.go.html#4303916">NewWriter</a></span><span class="op" id="6798960">(</span><span class="ident" id="6798961"><a href="/compress/gzip/gzip_test.go.html#6798919">buf</a></span><span class="op" id="6798964">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6798967"><a href="/compress/gzip/gzip_test.go.html#6798946">w</a></span><span class="op" id="6798968">.</span><span class="ident" id="6798969">Comment</span>&nbsp;<span class="op" id="6798977">=</span>&nbsp;<span class="string" id="6798979">&#34;comment&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6798990"><a href="/compress/gzip/gzip_test.go.html#6798946">w</a></span><span class="op" id="6798991">.</span><span class="ident" id="6798992">Extra</span>&nbsp;<span class="op" id="6798998">=</span>&nbsp;<span class="op" id="6799000">[</span><span class="op" id="6799001">]</span><span class="builtintype" id="6799002">byte</span><span class="op" id="6799006">(</span><span class="string" id="6799007">&#34;extra&#34;</span><span class="op" id="6799014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6799017"><a href="/compress/gzip/gzip_test.go.html#6798946">w</a></span><span class="op" id="6799018">.</span><span class="ident" id="6799019">ModTime</span>&nbsp;<span class="op" id="6799027">=</span>&nbsp;<span class="ident" id="6799029"><a href="/compress/gzip/gzip_test.go.html#6795354">time</a></span><span class="op" id="6799033">.</span><span class="ident" id="6799034">Unix</span><span class="op" id="6799038">(</span><span class="num" id="6799039">1e8</span><span class="op" id="6799042">,</span>&nbsp;<span class="num" id="6799044">0</span><span class="op" id="6799045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6799048"><a href="/compress/gzip/gzip_test.go.html#6798946">w</a></span><span class="op" id="6799049">.</span><span class="ident" id="6799050">Name</span>&nbsp;<span class="op" id="6799055">=</span>&nbsp;<span class="string" id="6799057">&#34;name&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6799066">n0</span>&nbsp;<span class="op" id="6799069">:=</span>&nbsp;<span class="ident" id="6799072"><a href="/compress/gzip/gzip_test.go.html#6798919">buf</a></span><span class="op" id="6799075">.</span><span class="ident" id="6799076">Len</span><span class="op" id="6799079">(</span><span class="op" id="6799080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6799083">if</span>&nbsp;<span class="ident" id="6799086"><a href="/compress/gzip/gzip_test.go.html#6799066">n0</a></span>&nbsp;<span class="op" id="6799089">!=</span>&nbsp;<span class="num" id="6799092">0</span>&nbsp;<span class="op" id="6799094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6799098"><a href="/compress/gzip/gzip_test.go.html#6798902">t</a></span><span class="op" id="6799099">.</span><span class="ident" id="6799100">Fatalf</span><span class="op" id="6799106">(</span><span class="string" id="6799107">&#34;buffer&nbsp;size&nbsp;=&nbsp;%d&nbsp;before&nbsp;writes;&nbsp;want&nbsp;0&#34;</span><span class="op" id="6799147">,</span>&nbsp;<span class="ident" id="6799149"><a href="/compress/gzip/gzip_test.go.html#6799066">n0</a></span><span class="op" id="6799151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6799154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6799158">if</span>&nbsp;<span class="ident" id="6799161">err</span>&nbsp;<span class="op" id="6799165">:=</span>&nbsp;<span class="ident" id="6799168"><a href="/compress/gzip/gzip_test.go.html#6798946">w</a></span><span class="op" id="6799169">.</span><span class="ident" id="6799170">Flush</span><span class="op" id="6799175">(</span><span class="op" id="6799176">)</span><span class="op" id="6799177">;</span>&nbsp;<span class="ident" id="6799179"><a href="/compress/gzip/gzip_test.go.html#6799161">err</a></span>&nbsp;<span class="op" id="6799183">!=</span>&nbsp;<span class="ident" id="6799186">nil</span>&nbsp;<span class="op" id="6799190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6799194"><a href="/compress/gzip/gzip_test.go.html#6798902">t</a></span><span class="op" id="6799195">.</span><span class="ident" id="6799196">Fatal</span><span class="op" id="6799201">(</span><span class="ident" id="6799202"><a href="/compress/gzip/gzip_test.go.html#6799161">err</a></span><span class="op" id="6799205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6799208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6799212">n1</span>&nbsp;<span class="op" id="6799215">:=</span>&nbsp;<span class="ident" id="6799218"><a href="/compress/gzip/gzip_test.go.html#6798919">buf</a></span><span class="op" id="6799221">.</span><span class="ident" id="6799222">Len</span><span class="op" id="6799225">(</span><span class="op" id="6799226">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6799229">if</span>&nbsp;<span class="ident" id="6799232"><a href="/compress/gzip/gzip_test.go.html#6799212">n1</a></span>&nbsp;<span class="op" id="6799235">==</span>&nbsp;<span class="num" id="6799238">0</span>&nbsp;<span class="op" id="6799240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6799244"><a href="/compress/gzip/gzip_test.go.html#6798902">t</a></span><span class="op" id="6799245">.</span><span class="ident" id="6799246">Fatal</span><span class="op" id="6799251">(</span><span class="string" id="6799252">&#34;no&nbsp;data&nbsp;after&nbsp;first&nbsp;flush&#34;</span><span class="op" id="6799279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6799282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6799286"><a href="/compress/gzip/gzip_test.go.html#6798946">w</a></span><span class="op" id="6799287">.</span><span class="ident" id="6799288">Write</span><span class="op" id="6799293">(</span><span class="op" id="6799294">[</span><span class="op" id="6799295">]</span><span class="builtintype" id="6799296">byte</span><span class="op" id="6799300">(</span><span class="string" id="6799301">&#34;x&#34;</span><span class="op" id="6799304">)</span><span class="op" id="6799305">)</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6799309">n2</span>&nbsp;<span class="op" id="6799312">:=</span>&nbsp;<span class="ident" id="6799315"><a href="/compress/gzip/gzip_test.go.html#6798919">buf</a></span><span class="op" id="6799318">.</span><span class="ident" id="6799319">Len</span><span class="op" id="6799322">(</span><span class="op" id="6799323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6799326">if</span>&nbsp;<span class="ident" id="6799329"><a href="/compress/gzip/gzip_test.go.html#6799212">n1</a></span>&nbsp;<span class="op" id="6799332">!=</span>&nbsp;<span class="ident" id="6799335"><a href="/compress/gzip/gzip_test.go.html#6799309">n2</a></span>&nbsp;<span class="op" id="6799338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6799342"><a href="/compress/gzip/gzip_test.go.html#6798902">t</a></span><span class="op" id="6799343">.</span><span class="ident" id="6799344">Fatalf</span><span class="op" id="6799350">(</span><span class="string" id="6799351">&#34;after&nbsp;writing&nbsp;a&nbsp;single&nbsp;byte,&nbsp;size&nbsp;changed&nbsp;from&nbsp;%d&nbsp;to&nbsp;%d;&nbsp;want&nbsp;no&nbsp;change&#34;</span><span class="op" id="6799424">,</span>&nbsp;<span class="ident" id="6799426"><a href="/compress/gzip/gzip_test.go.html#6799212">n1</a></span><span class="op" id="6799428">,</span>&nbsp;<span class="ident" id="6799430"><a href="/compress/gzip/gzip_test.go.html#6799309">n2</a></span><span class="op" id="6799432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6799435">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6799439">if</span>&nbsp;<span class="ident" id="6799442">err</span>&nbsp;<span class="op" id="6799446">:=</span>&nbsp;<span class="ident" id="6799449"><a href="/compress/gzip/gzip_test.go.html#6798946">w</a></span><span class="op" id="6799450">.</span><span class="ident" id="6799451">Flush</span><span class="op" id="6799456">(</span><span class="op" id="6799457">)</span><span class="op" id="6799458">;</span>&nbsp;<span class="ident" id="6799460"><a href="/compress/gzip/gzip_test.go.html#6799442">err</a></span>&nbsp;<span class="op" id="6799464">!=</span>&nbsp;<span class="ident" id="6799467">nil</span>&nbsp;<span class="op" id="6799471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6799475"><a href="/compress/gzip/gzip_test.go.html#6798902">t</a></span><span class="op" id="6799476">.</span><span class="ident" id="6799477">Fatal</span><span class="op" id="6799482">(</span><span class="ident" id="6799483"><a href="/compress/gzip/gzip_test.go.html#6799442">err</a></span><span class="op" id="6799486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6799489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6799493">n3</span>&nbsp;<span class="op" id="6799496">:=</span>&nbsp;<span class="ident" id="6799499"><a href="/compress/gzip/gzip_test.go.html#6798919">buf</a></span><span class="op" id="6799502">.</span><span class="ident" id="6799503">Len</span><span class="op" id="6799506">(</span><span class="op" id="6799507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6799510">if</span>&nbsp;<span class="ident" id="6799513"><a href="/compress/gzip/gzip_test.go.html#6799309">n2</a></span>&nbsp;<span class="op" id="6799516">==</span>&nbsp;<span class="ident" id="6799519"><a href="/compress/gzip/gzip_test.go.html#6799493">n3</a></span>&nbsp;<span class="op" id="6799522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6799526"><a href="/compress/gzip/gzip_test.go.html#6798902">t</a></span><span class="op" id="6799527">.</span><span class="ident" id="6799528">Fatal</span><span class="op" id="6799533">(</span><span class="string" id="6799534">&#34;Flush&nbsp;didn&#39;t&nbsp;flush&nbsp;any&nbsp;data&#34;</span><span class="op" id="6799563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6799566">}</span><br>
<span class="lineno"></span><span class="op" id="6799568">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="comment" id="6799571">//&nbsp;Multiple&nbsp;gzip&nbsp;files&nbsp;concatenated&nbsp;form&nbsp;a&nbsp;valid&nbsp;gzip&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6799631">func</span>&nbsp;<span class="ident" id="6799636">TestConcat</span><span class="op" id="6799646">(</span><span class="ident" id="6799647">t</span>&nbsp;<span class="op" id="6799649">*</span><span class="ident" id="6799650"><a href="/compress/gzip/gzip_test.go.html#6795343">testing</a></span><span class="op" id="6799657">.</span><span class="ident" id="6799658">T</span><span class="op" id="6799659">)</span>&nbsp;<span class="op" id="6799661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6799664">var</span>&nbsp;<span class="ident" id="6799668">buf</span>&nbsp;<span class="ident" id="6799672"><a href="/compress/gzip/gzip_test.go.html#6795321">bytes</a></span><span class="op" id="6799677">.</span><span class="ident" id="6799678">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6799686">w</span>&nbsp;<span class="op" id="6799688">:=</span>&nbsp;<span class="ident" id="6799691"><a href="/compress/gzip/gzip.go.html#4303916">NewWriter</a></span><span class="op" id="6799700">(</span><span class="op" id="6799701">&amp;</span><span class="ident" id="6799702"><a href="/compress/gzip/gzip_test.go.html#6799668">buf</a></span><span class="op" id="6799705">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6799708"><a href="/compress/gzip/gzip_test.go.html#6799686">w</a></span><span class="op" id="6799709">.</span><span class="ident" id="6799710">Write</span><span class="op" id="6799715">(</span><span class="op" id="6799716">[</span><span class="op" id="6799717">]</span><span class="builtintype" id="6799718">byte</span><span class="op" id="6799722">(</span><span class="string" id="6799723">&#34;hello&nbsp;&#34;</span><span class="op" id="6799731">)</span><span class="op" id="6799732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6799735"><a href="/compress/gzip/gzip_test.go.html#6799686">w</a></span><span class="op" id="6799736">.</span><span class="ident" id="6799737">Close</span><span class="op" id="6799742">(</span><span class="op" id="6799743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6799746"><a href="/compress/gzip/gzip_test.go.html#6799686">w</a></span>&nbsp;<span class="op" id="6799748">=</span>&nbsp;<span class="ident" id="6799750"><a href="/compress/gzip/gzip.go.html#4303916">NewWriter</a></span><span class="op" id="6799759">(</span><span class="op" id="6799760">&amp;</span><span class="ident" id="6799761"><a href="/compress/gzip/gzip_test.go.html#6799668">buf</a></span><span class="op" id="6799764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6799767"><a href="/compress/gzip/gzip_test.go.html#6799686">w</a></span><span class="op" id="6799768">.</span><span class="ident" id="6799769">Write</span><span class="op" id="6799774">(</span><span class="op" id="6799775">[</span><span class="op" id="6799776">]</span><span class="builtintype" id="6799777">byte</span><span class="op" id="6799781">(</span><span class="string" id="6799782">&#34;world\n&#34;</span><span class="op" id="6799791">)</span><span class="op" id="6799792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6799795"><a href="/compress/gzip/gzip_test.go.html#6799686">w</a></span><span class="op" id="6799796">.</span><span class="ident" id="6799797">Close</span><span class="op" id="6799802">(</span><span class="op" id="6799803">)</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6799807">r</span><span class="op" id="6799808">,</span>&nbsp;<span class="ident" id="6799810">err</span>&nbsp;<span class="op" id="6799814">:=</span>&nbsp;<span class="ident" id="6799817"><a href="/compress/gzip/gunzip.go.html#4297686">NewReader</a></span><span class="op" id="6799826">(</span><span class="op" id="6799827">&amp;</span><span class="ident" id="6799828"><a href="/compress/gzip/gzip_test.go.html#6799668">buf</a></span><span class="op" id="6799831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6799834">data</span><span class="op" id="6799838">,</span>&nbsp;<span class="ident" id="6799840"><a href="/compress/gzip/gzip_test.go.html#6799810">err</a></span>&nbsp;<span class="op" id="6799844">:=</span>&nbsp;<span class="ident" id="6799847"><a href="/compress/gzip/gzip_test.go.html#6795330">ioutil</a></span><span class="op" id="6799853">.</span><span class="ident" id="6799854">ReadAll</span><span class="op" id="6799861">(</span><span class="ident" id="6799862"><a href="/compress/gzip/gzip_test.go.html#6799807">r</a></span><span class="op" id="6799863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6799866">if</span>&nbsp;<span class="builtintype" id="6799869">string</span><span class="op" id="6799875">(</span><span class="ident" id="6799876"><a href="/compress/gzip/gzip_test.go.html#6799834">data</a></span><span class="op" id="6799880">)</span>&nbsp;<span class="op" id="6799882">!=</span>&nbsp;<span class="string" id="6799885">&#34;hello&nbsp;world\n&#34;</span>&nbsp;<span class="op" id="6799901">||</span>&nbsp;<span class="ident" id="6799904"><a href="/compress/gzip/gzip_test.go.html#6799810">err</a></span>&nbsp;<span class="op" id="6799908">!=</span>&nbsp;<span class="ident" id="6799911">nil</span>&nbsp;<span class="op" id="6799915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6799919"><a href="/compress/gzip/gzip_test.go.html#6799647">t</a></span><span class="op" id="6799920">.</span><span class="ident" id="6799921">Fatalf</span><span class="op" id="6799927">(</span><span class="string" id="6799928">&#34;ReadAll&nbsp;=&nbsp;%q,&nbsp;%v,&nbsp;want&nbsp;%q,&nbsp;nil&#34;</span><span class="op" id="6799960">,</span>&nbsp;<span class="ident" id="6799962"><a href="/compress/gzip/gzip_test.go.html#6799834">data</a></span><span class="op" id="6799966">,</span>&nbsp;<span class="ident" id="6799968"><a href="/compress/gzip/gzip_test.go.html#6799810">err</a></span><span class="op" id="6799971">,</span>&nbsp;<span class="string" id="6799973">&#34;hello&nbsp;world&#34;</span><span class="op" id="6799986">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6799989">}</span><br>
<span class="lineno"></span><span class="op" id="6799991">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6799994">func</span>&nbsp;<span class="ident" id="6799999">TestWriterReset</span><span class="op" id="6800014">(</span><span class="ident" id="6800015">t</span>&nbsp;<span class="op" id="6800017">*</span><span class="ident" id="6800018"><a href="/compress/gzip/gzip_test.go.html#6795343">testing</a></span><span class="op" id="6800025">.</span><span class="ident" id="6800026">T</span><span class="op" id="6800027">)</span>&nbsp;<span class="op" id="6800029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6800032">buf</span>&nbsp;<span class="op" id="6800036">:=</span>&nbsp;<span class="builtinfunc" id="6800039">new</span><span class="op" id="6800042">(</span><span class="ident" id="6800043"><a href="/compress/gzip/gzip_test.go.html#6795321">bytes</a></span><span class="op" id="6800048">.</span><span class="ident" id="6800049">Buffer</span><span class="op" id="6800055">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6800058">buf2</span>&nbsp;<span class="op" id="6800063">:=</span>&nbsp;<span class="builtinfunc" id="6800066">new</span><span class="op" id="6800069">(</span><span class="ident" id="6800070"><a href="/compress/gzip/gzip_test.go.html#6795321">bytes</a></span><span class="op" id="6800075">.</span><span class="ident" id="6800076">Buffer</span><span class="op" id="6800082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6800085">z</span>&nbsp;<span class="op" id="6800087">:=</span>&nbsp;<span class="ident" id="6800090"><a href="/compress/gzip/gzip.go.html#4303916">NewWriter</a></span><span class="op" id="6800099">(</span><span class="ident" id="6800100"><a href="/compress/gzip/gzip_test.go.html#6800032">buf</a></span><span class="op" id="6800103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6800106">msg</span>&nbsp;<span class="op" id="6800110">:=</span>&nbsp;<span class="op" id="6800113">[</span><span class="op" id="6800114">]</span><span class="builtintype" id="6800115">byte</span><span class="op" id="6800119">(</span><span class="string" id="6800120">&#34;hello&nbsp;world&#34;</span><span class="op" id="6800133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6800136"><a href="/compress/gzip/gzip_test.go.html#6800085">z</a></span><span class="op" id="6800137">.</span><span class="ident" id="6800138">Write</span><span class="op" id="6800143">(</span><span class="ident" id="6800144"><a href="/compress/gzip/gzip_test.go.html#6800106">msg</a></span><span class="op" id="6800147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6800150"><a href="/compress/gzip/gzip_test.go.html#6800085">z</a></span><span class="op" id="6800151">.</span><span class="ident" id="6800152">Close</span><span class="op" id="6800157">(</span><span class="op" id="6800158">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6800161"><a href="/compress/gzip/gzip_test.go.html#6800085">z</a></span><span class="op" id="6800162">.</span><span class="ident" id="6800163">Reset</span><span class="op" id="6800168">(</span><span class="ident" id="6800169"><a href="/compress/gzip/gzip_test.go.html#6800058">buf2</a></span><span class="op" id="6800173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6800176"><a href="/compress/gzip/gzip_test.go.html#6800085">z</a></span><span class="op" id="6800177">.</span><span class="ident" id="6800178">Write</span><span class="op" id="6800183">(</span><span class="ident" id="6800184"><a href="/compress/gzip/gzip_test.go.html#6800106">msg</a></span><span class="op" id="6800187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6800190"><a href="/compress/gzip/gzip_test.go.html#6800085">z</a></span><span class="op" id="6800191">.</span><span class="ident" id="6800192">Close</span><span class="op" id="6800197">(</span><span class="op" id="6800198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6800201">if</span>&nbsp;<span class="ident" id="6800204"><a href="/compress/gzip/gzip_test.go.html#6800032">buf</a></span><span class="op" id="6800207">.</span><span class="ident" id="6800208">String</span><span class="op" id="6800214">(</span><span class="op" id="6800215">)</span>&nbsp;<span class="op" id="6800217">!=</span>&nbsp;<span class="ident" id="6800220"><a href="/compress/gzip/gzip_test.go.html#6800058">buf2</a></span><span class="op" id="6800224">.</span><span class="ident" id="6800225">String</span><span class="op" id="6800231">(</span><span class="op" id="6800232">)</span>&nbsp;<span class="op" id="6800234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6800238"><a href="/compress/gzip/gzip_test.go.html#6800015">t</a></span><span class="op" id="6800239">.</span><span class="ident" id="6800240">Errorf</span><span class="op" id="6800246">(</span><span class="string" id="6800247">&#34;buf2&nbsp;%q&nbsp;!=&nbsp;original&nbsp;buf&nbsp;of&nbsp;%q&#34;</span><span class="op" id="6800278">,</span>&nbsp;<span class="ident" id="6800280"><a href="/compress/gzip/gzip_test.go.html#6800058">buf2</a></span><span class="op" id="6800284">.</span><span class="ident" id="6800285">String</span><span class="op" id="6800291">(</span><span class="op" id="6800292">)</span><span class="op" id="6800293">,</span>&nbsp;<span class="ident" id="6800295"><a href="/compress/gzip/gzip_test.go.html#6800032">buf</a></span><span class="op" id="6800298">.</span><span class="ident" id="6800299">String</span><span class="op" id="6800305">(</span><span class="op" id="6800306">)</span><span class="op" id="6800307">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6800310">}</span><br>
<span class="lineno"></span><span class="op" id="6800312">}</span>
</div>
</body>
</html>
