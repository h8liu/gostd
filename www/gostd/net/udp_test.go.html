<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html" class="current">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7655155">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7655211">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7655265">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7655316">package</span>&nbsp;<span class="ident" id="7655324">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7655329">import</span>&nbsp;<span class="op" id="7655336">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7655339">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7655350">&#34;runtime&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7655361">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7655372">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7655383">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7655390">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="7655393">func</span>&nbsp;<span class="ident" id="7655398">TestResolveUDPAddr</span><span class="op" id="7655416">(</span><span class="ident" id="7655417">t</span>&nbsp;<span class="op" id="7655419">*</span><span class="ident" id="7655420">testing</span><span class="op" id="7655427">.</span><span class="ident" id="7655428">T</span><span class="op" id="7655429">)</span>&nbsp;<span class="op" id="7655431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7655434">for</span>&nbsp;<span class="ident" id="7655438">_</span><span class="op" id="7655439">,</span>&nbsp;<span class="ident" id="7655441">tt</span>&nbsp;<span class="op" id="7655444">:=</span>&nbsp;<span class="keyword" id="7655447">range</span>&nbsp;<span class="ident" id="7655453">resolveTCPAddrTests</span>&nbsp;<span class="op" id="7655473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7655477">net</span>&nbsp;<span class="op" id="7655481">:=</span>&nbsp;<span class="ident" id="7655484">strings</span><span class="op" id="7655491">.</span><span class="ident" id="7655492">Replace</span><span class="op" id="7655499">(</span><span class="ident" id="7655500">tt</span><span class="op" id="7655502">.</span><span class="ident" id="7655503">net</span><span class="op" id="7655506">,</span>&nbsp;<span class="string" id="7655508">&#34;tcp&#34;</span><span class="op" id="7655513">,</span>&nbsp;<span class="string" id="7655515">&#34;udp&#34;</span><span class="op" id="7655520">,</span>&nbsp;<span class="op" id="7655522">-</span><span class="num" id="7655523">1</span><span class="op" id="7655524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7655528">addr</span><span class="op" id="7655532">,</span>&nbsp;<span class="ident" id="7655534">err</span>&nbsp;<span class="op" id="7655538">:=</span>&nbsp;<span class="ident" id="7655541">ResolveUDPAddr</span><span class="op" id="7655555">(</span><span class="ident" id="7655556">net</span><span class="op" id="7655559">,</span>&nbsp;<span class="ident" id="7655561">tt</span><span class="op" id="7655563">.</span><span class="ident" id="7655564">litAddrOrName</span><span class="op" id="7655577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7655581">if</span>&nbsp;<span class="ident" id="7655584">err</span>&nbsp;<span class="op" id="7655588">!=</span>&nbsp;<span class="ident" id="7655591">tt</span><span class="op" id="7655593">.</span><span class="ident" id="7655594">err</span>&nbsp;<span class="op" id="7655598">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7655603">t</span><span class="op" id="7655604">.</span><span class="ident" id="7655605">Fatalf</span><span class="op" id="7655611">(</span><span class="string" id="7655612">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7655647">,</span>&nbsp;<span class="ident" id="7655649">net</span><span class="op" id="7655652">,</span>&nbsp;<span class="ident" id="7655654">tt</span><span class="op" id="7655656">.</span><span class="ident" id="7655657">litAddrOrName</span><span class="op" id="7655670">,</span>&nbsp;<span class="ident" id="7655672">err</span><span class="op" id="7655675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7655679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7655683">if</span>&nbsp;<span class="op" id="7655686">!</span><span class="ident" id="7655687">reflect</span><span class="op" id="7655694">.</span><span class="ident" id="7655695">DeepEqual</span><span class="op" id="7655704">(</span><span class="ident" id="7655705">addr</span><span class="op" id="7655709">,</span>&nbsp;<span class="op" id="7655711">(</span><span class="op" id="7655712">*</span><span class="ident" id="7655713">UDPAddr</span><span class="op" id="7655720">)</span><span class="op" id="7655721">(</span><span class="ident" id="7655722">tt</span><span class="op" id="7655724">.</span><span class="ident" id="7655725">addr</span><span class="op" id="7655729">)</span><span class="op" id="7655730">)</span>&nbsp;<span class="op" id="7655732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7655737">t</span><span class="op" id="7655738">.</span><span class="ident" id="7655739">Fatalf</span><span class="op" id="7655745">(</span><span class="string" id="7655746">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;=&nbsp;%#v,&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="7655786">,</span>&nbsp;<span class="ident" id="7655788">net</span><span class="op" id="7655791">,</span>&nbsp;<span class="ident" id="7655793">tt</span><span class="op" id="7655795">.</span><span class="ident" id="7655796">litAddrOrName</span><span class="op" id="7655809">,</span>&nbsp;<span class="ident" id="7655811">addr</span><span class="op" id="7655815">,</span>&nbsp;<span class="ident" id="7655817">tt</span><span class="op" id="7655819">.</span><span class="ident" id="7655820">addr</span><span class="op" id="7655824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7655828">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7655832">if</span>&nbsp;<span class="ident" id="7655835">err</span>&nbsp;<span class="op" id="7655839">==</span>&nbsp;<span class="ident" id="7655842">nil</span>&nbsp;<span class="op" id="7655846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7655851">str</span>&nbsp;<span class="op" id="7655855">:=</span>&nbsp;<span class="ident" id="7655858">addr</span><span class="op" id="7655862">.</span><span class="ident" id="7655863">String</span><span class="op" id="7655869">(</span><span class="op" id="7655870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7655875">addr1</span><span class="op" id="7655880">,</span>&nbsp;<span class="ident" id="7655882">err</span>&nbsp;<span class="op" id="7655886">:=</span>&nbsp;<span class="ident" id="7655889">ResolveUDPAddr</span><span class="op" id="7655903">(</span><span class="ident" id="7655904">net</span><span class="op" id="7655907">,</span>&nbsp;<span class="ident" id="7655909">str</span><span class="op" id="7655912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7655917">if</span>&nbsp;<span class="ident" id="7655920">err</span>&nbsp;<span class="op" id="7655924">!=</span>&nbsp;<span class="ident" id="7655927">nil</span>&nbsp;<span class="op" id="7655931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7655937">t</span><span class="op" id="7655938">.</span><span class="ident" id="7655939">Fatalf</span><span class="op" id="7655945">(</span><span class="string" id="7655946">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;[from&nbsp;%q]:&nbsp;%v&#34;</span><span class="op" id="7655984">,</span>&nbsp;<span class="ident" id="7655986">net</span><span class="op" id="7655989">,</span>&nbsp;<span class="ident" id="7655991">str</span><span class="op" id="7655994">,</span>&nbsp;<span class="ident" id="7655996">tt</span><span class="op" id="7655998">.</span><span class="ident" id="7655999">litAddrOrName</span><span class="op" id="7656012">,</span>&nbsp;<span class="ident" id="7656014">err</span><span class="op" id="7656017">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7656022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7656027">if</span>&nbsp;<span class="op" id="7656030">!</span><span class="ident" id="7656031">reflect</span><span class="op" id="7656038">.</span><span class="ident" id="7656039">DeepEqual</span><span class="op" id="7656048">(</span><span class="ident" id="7656049">addr1</span><span class="op" id="7656054">,</span>&nbsp;<span class="ident" id="7656056">addr</span><span class="op" id="7656060">)</span>&nbsp;<span class="op" id="7656062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7656068">t</span><span class="op" id="7656069">.</span><span class="ident" id="7656070">Fatalf</span><span class="op" id="7656076">(</span><span class="string" id="7656077">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;[from&nbsp;%q]&nbsp;=&nbsp;%#v,&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="7656127">,</span>&nbsp;<span class="ident" id="7656129">net</span><span class="op" id="7656132">,</span>&nbsp;<span class="ident" id="7656134">str</span><span class="op" id="7656137">,</span>&nbsp;<span class="ident" id="7656139">tt</span><span class="op" id="7656141">.</span><span class="ident" id="7656142">litAddrOrName</span><span class="op" id="7656155">,</span>&nbsp;<span class="ident" id="7656157">addr1</span><span class="op" id="7656162">,</span>&nbsp;<span class="ident" id="7656164">addr</span><span class="op" id="7656168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7656173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7656177">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7656180">}</span><br>
<span class="lineno"></span><span class="op" id="7656182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7656185">func</span>&nbsp;<span class="ident" id="7656190">TestReadFromUDP</span><span class="op" id="7656205">(</span><span class="ident" id="7656206">t</span>&nbsp;<span class="op" id="7656208">*</span><span class="ident" id="7656209">testing</span><span class="op" id="7656216">.</span><span class="ident" id="7656217">T</span><span class="op" id="7656218">)</span>&nbsp;<span class="op" id="7656220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7656223">switch</span>&nbsp;<span class="ident" id="7656230">runtime</span><span class="op" id="7656237">.</span><span class="ident" id="7656238">GOOS</span>&nbsp;<span class="op" id="7656243">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7656246">case</span>&nbsp;<span class="string" id="7656251">&#34;nacl&#34;</span><span class="op" id="7656257">,</span>&nbsp;<span class="string" id="7656259">&#34;plan9&#34;</span><span class="op" id="7656266">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7656270">t</span><span class="op" id="7656271">.</span><span class="ident" id="7656272">Skipf</span><span class="op" id="7656277">(</span><span class="string" id="7656278">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q,&nbsp;see&nbsp;issue&nbsp;8916&#34;</span><span class="op" id="7656315">,</span>&nbsp;<span class="ident" id="7656317">runtime</span><span class="op" id="7656324">.</span><span class="ident" id="7656325">GOOS</span><span class="op" id="7656329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7656332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7656336">ra</span><span class="op" id="7656338">,</span>&nbsp;<span class="ident" id="7656340">err</span>&nbsp;<span class="op" id="7656344">:=</span>&nbsp;<span class="ident" id="7656347">ResolveUDPAddr</span><span class="op" id="7656361">(</span><span class="string" id="7656362">&#34;udp&#34;</span><span class="op" id="7656367">,</span>&nbsp;<span class="string" id="7656369">&#34;127.0.0.1:7&#34;</span><span class="op" id="7656382">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7656385">if</span>&nbsp;<span class="ident" id="7656388">err</span>&nbsp;<span class="op" id="7656392">!=</span>&nbsp;<span class="ident" id="7656395">nil</span>&nbsp;<span class="op" id="7656399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7656403">t</span><span class="op" id="7656404">.</span><span class="ident" id="7656405">Fatal</span><span class="op" id="7656410">(</span><span class="ident" id="7656411">err</span><span class="op" id="7656414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7656417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7656421">la</span><span class="op" id="7656423">,</span>&nbsp;<span class="ident" id="7656425">err</span>&nbsp;<span class="op" id="7656429">:=</span>&nbsp;<span class="ident" id="7656432">ResolveUDPAddr</span><span class="op" id="7656446">(</span><span class="string" id="7656447">&#34;udp&#34;</span><span class="op" id="7656452">,</span>&nbsp;<span class="string" id="7656454">&#34;127.0.0.1:0&#34;</span><span class="op" id="7656467">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7656470">if</span>&nbsp;<span class="ident" id="7656473">err</span>&nbsp;<span class="op" id="7656477">!=</span>&nbsp;<span class="ident" id="7656480">nil</span>&nbsp;<span class="op" id="7656484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7656488">t</span><span class="op" id="7656489">.</span><span class="ident" id="7656490">Fatal</span><span class="op" id="7656495">(</span><span class="ident" id="7656496">err</span><span class="op" id="7656499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7656502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7656506">c</span><span class="op" id="7656507">,</span>&nbsp;<span class="ident" id="7656509">err</span>&nbsp;<span class="op" id="7656513">:=</span>&nbsp;<span class="ident" id="7656516">ListenUDP</span><span class="op" id="7656525">(</span><span class="string" id="7656526">&#34;udp&#34;</span><span class="op" id="7656531">,</span>&nbsp;<span class="ident" id="7656533">la</span><span class="op" id="7656535">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7656538">if</span>&nbsp;<span class="ident" id="7656541">err</span>&nbsp;<span class="op" id="7656545">!=</span>&nbsp;<span class="ident" id="7656548">nil</span>&nbsp;<span class="op" id="7656552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7656556">t</span><span class="op" id="7656557">.</span><span class="ident" id="7656558">Fatal</span><span class="op" id="7656563">(</span><span class="ident" id="7656564">err</span><span class="op" id="7656567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7656570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7656573">defer</span>&nbsp;<span class="ident" id="7656579">c</span><span class="op" id="7656580">.</span><span class="ident" id="7656581">Close</span><span class="op" id="7656586">(</span><span class="op" id="7656587">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7656591">_</span><span class="op" id="7656592">,</span>&nbsp;<span class="ident" id="7656594">err</span>&nbsp;<span class="op" id="7656598">=</span>&nbsp;<span class="ident" id="7656600">c</span><span class="op" id="7656601">.</span><span class="ident" id="7656602">WriteToUDP</span><span class="op" id="7656612">(</span><span class="op" id="7656613">[</span><span class="op" id="7656614">]</span><span class="builtintype" id="7656615">byte</span><span class="op" id="7656619">(</span><span class="string" id="7656620">&#34;a&#34;</span><span class="op" id="7656623">)</span><span class="op" id="7656624">,</span>&nbsp;<span class="ident" id="7656626">ra</span><span class="op" id="7656628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7656631">if</span>&nbsp;<span class="ident" id="7656634">err</span>&nbsp;<span class="op" id="7656638">!=</span>&nbsp;<span class="ident" id="7656641">nil</span>&nbsp;<span class="op" id="7656645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7656649">t</span><span class="op" id="7656650">.</span><span class="ident" id="7656651">Fatal</span><span class="op" id="7656656">(</span><span class="ident" id="7656657">err</span><span class="op" id="7656660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7656663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7656667">err</span>&nbsp;<span class="op" id="7656671">=</span>&nbsp;<span class="ident" id="7656673">c</span><span class="op" id="7656674">.</span><span class="ident" id="7656675">SetDeadline</span><span class="op" id="7656686">(</span><span class="ident" id="7656687">time</span><span class="op" id="7656691">.</span><span class="ident" id="7656692">Now</span><span class="op" id="7656695">(</span><span class="op" id="7656696">)</span><span class="op" id="7656697">.</span><span class="ident" id="7656698">Add</span><span class="op" id="7656701">(</span><span class="num" id="7656702">100</span>&nbsp;<span class="op" id="7656706">*</span>&nbsp;<span class="ident" id="7656708">time</span><span class="op" id="7656712">.</span><span class="ident" id="7656713">Millisecond</span><span class="op" id="7656724">)</span><span class="op" id="7656725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7656728">if</span>&nbsp;<span class="ident" id="7656731">err</span>&nbsp;<span class="op" id="7656735">!=</span>&nbsp;<span class="ident" id="7656738">nil</span>&nbsp;<span class="op" id="7656742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7656746">t</span><span class="op" id="7656747">.</span><span class="ident" id="7656748">Fatal</span><span class="op" id="7656753">(</span><span class="ident" id="7656754">err</span><span class="op" id="7656757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7656760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7656763">b</span>&nbsp;<span class="op" id="7656765">:=</span>&nbsp;<span class="builtinfunc" id="7656768">make</span><span class="op" id="7656772">(</span><span class="op" id="7656773">[</span><span class="op" id="7656774">]</span><span class="builtintype" id="7656775">byte</span><span class="op" id="7656779">,</span>&nbsp;<span class="num" id="7656781">1</span><span class="op" id="7656782">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7656785">_</span><span class="op" id="7656786">,</span>&nbsp;<span class="ident" id="7656788">_</span><span class="op" id="7656789">,</span>&nbsp;<span class="ident" id="7656791">err</span>&nbsp;<span class="op" id="7656795">=</span>&nbsp;<span class="ident" id="7656797">c</span><span class="op" id="7656798">.</span><span class="ident" id="7656799">ReadFromUDP</span><span class="op" id="7656810">(</span><span class="ident" id="7656811">b</span><span class="op" id="7656812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7656815">if</span>&nbsp;<span class="ident" id="7656818">err</span>&nbsp;<span class="op" id="7656822">==</span>&nbsp;<span class="ident" id="7656825">nil</span>&nbsp;<span class="op" id="7656829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7656833">t</span><span class="op" id="7656834">.</span><span class="ident" id="7656835">Fatal</span><span class="op" id="7656840">(</span><span class="string" id="7656841">&#34;ReadFromUDP&nbsp;should&nbsp;fail&#34;</span><span class="op" id="7656866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7656869">}</span>&nbsp;<span class="keyword" id="7656871">else</span>&nbsp;<span class="keyword" id="7656876">if</span>&nbsp;<span class="op" id="7656879">!</span><span class="ident" id="7656880">isTimeout</span><span class="op" id="7656889">(</span><span class="ident" id="7656890">err</span><span class="op" id="7656893">)</span>&nbsp;<span class="op" id="7656895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7656899">t</span><span class="op" id="7656900">.</span><span class="ident" id="7656901">Fatal</span><span class="op" id="7656906">(</span><span class="ident" id="7656907">err</span><span class="op" id="7656910">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7656913">}</span><br>
<span class="lineno"></span><span class="op" id="7656915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7656918">func</span>&nbsp;<span class="ident" id="7656923">TestWriteToUDP</span><span class="op" id="7656937">(</span><span class="ident" id="7656938">t</span>&nbsp;<span class="op" id="7656940">*</span><span class="ident" id="7656941">testing</span><span class="op" id="7656948">.</span><span class="ident" id="7656949">T</span><span class="op" id="7656950">)</span>&nbsp;<span class="op" id="7656952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7656955">switch</span>&nbsp;<span class="ident" id="7656962">runtime</span><span class="op" id="7656969">.</span><span class="ident" id="7656970">GOOS</span>&nbsp;<span class="op" id="7656975">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7656978">case</span>&nbsp;<span class="string" id="7656983">&#34;plan9&#34;</span><span class="op" id="7656990">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7656994">t</span><span class="op" id="7656995">.</span><span class="ident" id="7656996">Skipf</span><span class="op" id="7657001">(</span><span class="string" id="7657002">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7657023">,</span>&nbsp;<span class="ident" id="7657025">runtime</span><span class="op" id="7657032">.</span><span class="ident" id="7657033">GOOS</span><span class="op" id="7657037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7657040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7657044">l</span><span class="op" id="7657045">,</span>&nbsp;<span class="ident" id="7657047">err</span>&nbsp;<span class="op" id="7657051">:=</span>&nbsp;<span class="ident" id="7657054">ListenPacket</span><span class="op" id="7657066">(</span><span class="string" id="7657067">&#34;udp&#34;</span><span class="op" id="7657072">,</span>&nbsp;<span class="string" id="7657074">&#34;127.0.0.1:0&#34;</span><span class="op" id="7657087">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7657090">if</span>&nbsp;<span class="ident" id="7657093">err</span>&nbsp;<span class="op" id="7657097">!=</span>&nbsp;<span class="ident" id="7657100">nil</span>&nbsp;<span class="op" id="7657104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7657108">t</span><span class="op" id="7657109">.</span><span class="ident" id="7657110">Fatalf</span><span class="op" id="7657116">(</span><span class="string" id="7657117">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7657136">,</span>&nbsp;<span class="ident" id="7657138">err</span><span class="op" id="7657141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7657144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7657147">defer</span>&nbsp;<span class="ident" id="7657153">l</span><span class="op" id="7657154">.</span><span class="ident" id="7657155">Close</span><span class="op" id="7657160">(</span><span class="op" id="7657161">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7657165">testWriteToConn</span><span class="op" id="7657180">(</span><span class="ident" id="7657181">t</span><span class="op" id="7657182">,</span>&nbsp;<span class="ident" id="7657184">l</span><span class="op" id="7657185">.</span><span class="ident" id="7657186">LocalAddr</span><span class="op" id="7657195">(</span><span class="op" id="7657196">)</span><span class="op" id="7657197">.</span><span class="ident" id="7657198">String</span><span class="op" id="7657204">(</span><span class="op" id="7657205">)</span><span class="op" id="7657206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7657209">testWriteToPacketConn</span><span class="op" id="7657230">(</span><span class="ident" id="7657231">t</span><span class="op" id="7657232">,</span>&nbsp;<span class="ident" id="7657234">l</span><span class="op" id="7657235">.</span><span class="ident" id="7657236">LocalAddr</span><span class="op" id="7657245">(</span><span class="op" id="7657246">)</span><span class="op" id="7657247">.</span><span class="ident" id="7657248">String</span><span class="op" id="7657254">(</span><span class="op" id="7657255">)</span><span class="op" id="7657256">)</span><br>
<span class="lineno"></span><span class="op" id="7657258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7657261">func</span>&nbsp;<span class="ident" id="7657266">testWriteToConn</span><span class="op" id="7657281">(</span><span class="ident" id="7657282">t</span>&nbsp;<span class="op" id="7657284">*</span><span class="ident" id="7657285">testing</span><span class="op" id="7657292">.</span><span class="ident" id="7657293">T</span><span class="op" id="7657294">,</span>&nbsp;<span class="ident" id="7657296">raddr</span>&nbsp;<span class="builtintype" id="7657302">string</span><span class="op" id="7657308">)</span>&nbsp;<span class="op" id="7657310">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7657313">c</span><span class="op" id="7657314">,</span>&nbsp;<span class="ident" id="7657316">err</span>&nbsp;<span class="op" id="7657320">:=</span>&nbsp;<span class="ident" id="7657323">Dial</span><span class="op" id="7657327">(</span><span class="string" id="7657328">&#34;udp&#34;</span><span class="op" id="7657333">,</span>&nbsp;<span class="ident" id="7657335">raddr</span><span class="op" id="7657340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7657343">if</span>&nbsp;<span class="ident" id="7657346">err</span>&nbsp;<span class="op" id="7657350">!=</span>&nbsp;<span class="ident" id="7657353">nil</span>&nbsp;<span class="op" id="7657357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7657361">t</span><span class="op" id="7657362">.</span><span class="ident" id="7657363">Fatalf</span><span class="op" id="7657369">(</span><span class="string" id="7657370">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7657387">,</span>&nbsp;<span class="ident" id="7657389">err</span><span class="op" id="7657392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7657395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7657398">defer</span>&nbsp;<span class="ident" id="7657404">c</span><span class="op" id="7657405">.</span><span class="ident" id="7657406">Close</span><span class="op" id="7657411">(</span><span class="op" id="7657412">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7657416">ra</span><span class="op" id="7657418">,</span>&nbsp;<span class="ident" id="7657420">err</span>&nbsp;<span class="op" id="7657424">:=</span>&nbsp;<span class="ident" id="7657427">ResolveUDPAddr</span><span class="op" id="7657441">(</span><span class="string" id="7657442">&#34;udp&#34;</span><span class="op" id="7657447">,</span>&nbsp;<span class="ident" id="7657449">raddr</span><span class="op" id="7657454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7657457">if</span>&nbsp;<span class="ident" id="7657460">err</span>&nbsp;<span class="op" id="7657464">!=</span>&nbsp;<span class="ident" id="7657467">nil</span>&nbsp;<span class="op" id="7657471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7657475">t</span><span class="op" id="7657476">.</span><span class="ident" id="7657477">Fatalf</span><span class="op" id="7657483">(</span><span class="string" id="7657484">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7657511">,</span>&nbsp;<span class="ident" id="7657513">err</span><span class="op" id="7657516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7657519">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7657523">_</span><span class="op" id="7657524">,</span>&nbsp;<span class="ident" id="7657526">err</span>&nbsp;<span class="op" id="7657530">=</span>&nbsp;<span class="ident" id="7657532">c</span><span class="op" id="7657533">.</span><span class="op" id="7657534">(</span><span class="op" id="7657535">*</span><span class="ident" id="7657536">UDPConn</span><span class="op" id="7657543">)</span><span class="op" id="7657544">.</span><span class="ident" id="7657545">WriteToUDP</span><span class="op" id="7657555">(</span><span class="op" id="7657556">[</span><span class="op" id="7657557">]</span><span class="builtintype" id="7657558">byte</span><span class="op" id="7657562">(</span><span class="string" id="7657563">&#34;Connection-oriented&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="7657596">)</span><span class="op" id="7657597">,</span>&nbsp;<span class="ident" id="7657599">ra</span><span class="op" id="7657601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7657604">if</span>&nbsp;<span class="ident" id="7657607">err</span>&nbsp;<span class="op" id="7657611">==</span>&nbsp;<span class="ident" id="7657614">nil</span>&nbsp;<span class="op" id="7657618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7657622">t</span><span class="op" id="7657623">.</span><span class="ident" id="7657624">Fatal</span><span class="op" id="7657629">(</span><span class="string" id="7657630">&#34;WriteToUDP&nbsp;should&nbsp;fail&#34;</span><span class="op" id="7657654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7657657">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7657660">if</span>&nbsp;<span class="ident" id="7657663">err</span>&nbsp;<span class="op" id="7657667">!=</span>&nbsp;<span class="ident" id="7657670">nil</span>&nbsp;<span class="op" id="7657674">&amp;&amp;</span>&nbsp;<span class="ident" id="7657677">err</span><span class="op" id="7657680">.</span><span class="op" id="7657681">(</span><span class="op" id="7657682">*</span><span class="ident" id="7657683">OpError</span><span class="op" id="7657690">)</span><span class="op" id="7657691">.</span><span class="ident" id="7657692">Err</span>&nbsp;<span class="op" id="7657696">!=</span>&nbsp;<span class="ident" id="7657699">ErrWriteToConnected</span>&nbsp;<span class="op" id="7657719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7657723">t</span><span class="op" id="7657724">.</span><span class="ident" id="7657725">Fatalf</span><span class="op" id="7657731">(</span><span class="string" id="7657732">&#34;WriteToUDP&nbsp;should&nbsp;fail&nbsp;as&nbsp;ErrWriteToConnected:&nbsp;%v&#34;</span><span class="op" id="7657783">,</span>&nbsp;<span class="ident" id="7657785">err</span><span class="op" id="7657788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7657791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7657795">_</span><span class="op" id="7657796">,</span>&nbsp;<span class="ident" id="7657798">err</span>&nbsp;<span class="op" id="7657802">=</span>&nbsp;<span class="ident" id="7657804">c</span><span class="op" id="7657805">.</span><span class="op" id="7657806">(</span><span class="op" id="7657807">*</span><span class="ident" id="7657808">UDPConn</span><span class="op" id="7657815">)</span><span class="op" id="7657816">.</span><span class="ident" id="7657817">WriteTo</span><span class="op" id="7657824">(</span><span class="op" id="7657825">[</span><span class="op" id="7657826">]</span><span class="builtintype" id="7657827">byte</span><span class="op" id="7657831">(</span><span class="string" id="7657832">&#34;Connection-oriented&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="7657865">)</span><span class="op" id="7657866">,</span>&nbsp;<span class="ident" id="7657868">ra</span><span class="op" id="7657870">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7657873">if</span>&nbsp;<span class="ident" id="7657876">err</span>&nbsp;<span class="op" id="7657880">==</span>&nbsp;<span class="ident" id="7657883">nil</span>&nbsp;<span class="op" id="7657887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7657891">t</span><span class="op" id="7657892">.</span><span class="ident" id="7657893">Fatal</span><span class="op" id="7657898">(</span><span class="string" id="7657899">&#34;WriteTo&nbsp;should&nbsp;fail&#34;</span><span class="op" id="7657920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7657923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7657926">if</span>&nbsp;<span class="ident" id="7657929">err</span>&nbsp;<span class="op" id="7657933">!=</span>&nbsp;<span class="ident" id="7657936">nil</span>&nbsp;<span class="op" id="7657940">&amp;&amp;</span>&nbsp;<span class="ident" id="7657943">err</span><span class="op" id="7657946">.</span><span class="op" id="7657947">(</span><span class="op" id="7657948">*</span><span class="ident" id="7657949">OpError</span><span class="op" id="7657956">)</span><span class="op" id="7657957">.</span><span class="ident" id="7657958">Err</span>&nbsp;<span class="op" id="7657962">!=</span>&nbsp;<span class="ident" id="7657965">ErrWriteToConnected</span>&nbsp;<span class="op" id="7657985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7657989">t</span><span class="op" id="7657990">.</span><span class="ident" id="7657991">Fatalf</span><span class="op" id="7657997">(</span><span class="string" id="7657998">&#34;WriteTo&nbsp;should&nbsp;fail&nbsp;as&nbsp;ErrWriteToConnected:&nbsp;%v&#34;</span><span class="op" id="7658046">,</span>&nbsp;<span class="ident" id="7658048">err</span><span class="op" id="7658051">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7658054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7658058">_</span><span class="op" id="7658059">,</span>&nbsp;<span class="ident" id="7658061">err</span>&nbsp;<span class="op" id="7658065">=</span>&nbsp;<span class="ident" id="7658067">c</span><span class="op" id="7658068">.</span><span class="ident" id="7658069">Write</span><span class="op" id="7658074">(</span><span class="op" id="7658075">[</span><span class="op" id="7658076">]</span><span class="builtintype" id="7658077">byte</span><span class="op" id="7658081">(</span><span class="string" id="7658082">&#34;Connection-oriented&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="7658115">)</span><span class="op" id="7658116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7658119">if</span>&nbsp;<span class="ident" id="7658122">err</span>&nbsp;<span class="op" id="7658126">!=</span>&nbsp;<span class="ident" id="7658129">nil</span>&nbsp;<span class="op" id="7658133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7658137">t</span><span class="op" id="7658138">.</span><span class="ident" id="7658139">Fatalf</span><span class="op" id="7658145">(</span><span class="string" id="7658146">&#34;Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7658164">,</span>&nbsp;<span class="ident" id="7658166">err</span><span class="op" id="7658169">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7658172">}</span><br>
<span class="lineno"></span><span class="op" id="7658174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7658177">func</span>&nbsp;<span class="ident" id="7658182">testWriteToPacketConn</span><span class="op" id="7658203">(</span><span class="ident" id="7658204">t</span>&nbsp;<span class="op" id="7658206">*</span><span class="ident" id="7658207">testing</span><span class="op" id="7658214">.</span><span class="ident" id="7658215">T</span><span class="op" id="7658216">,</span>&nbsp;<span class="ident" id="7658218">raddr</span>&nbsp;<span class="builtintype" id="7658224">string</span><span class="op" id="7658230">)</span>&nbsp;<span class="op" id="7658232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7658235">c</span><span class="op" id="7658236">,</span>&nbsp;<span class="ident" id="7658238">err</span>&nbsp;<span class="op" id="7658242">:=</span>&nbsp;<span class="ident" id="7658245">ListenPacket</span><span class="op" id="7658257">(</span><span class="string" id="7658258">&#34;udp&#34;</span><span class="op" id="7658263">,</span>&nbsp;<span class="string" id="7658265">&#34;127.0.0.1:0&#34;</span><span class="op" id="7658278">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7658281">if</span>&nbsp;<span class="ident" id="7658284">err</span>&nbsp;<span class="op" id="7658288">!=</span>&nbsp;<span class="ident" id="7658291">nil</span>&nbsp;<span class="op" id="7658295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7658299">t</span><span class="op" id="7658300">.</span><span class="ident" id="7658301">Fatalf</span><span class="op" id="7658307">(</span><span class="string" id="7658308">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7658333">,</span>&nbsp;<span class="ident" id="7658335">err</span><span class="op" id="7658338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7658341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7658344">defer</span>&nbsp;<span class="ident" id="7658350">c</span><span class="op" id="7658351">.</span><span class="ident" id="7658352">Close</span><span class="op" id="7658357">(</span><span class="op" id="7658358">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7658362">ra</span><span class="op" id="7658364">,</span>&nbsp;<span class="ident" id="7658366">err</span>&nbsp;<span class="op" id="7658370">:=</span>&nbsp;<span class="ident" id="7658373">ResolveUDPAddr</span><span class="op" id="7658387">(</span><span class="string" id="7658388">&#34;udp&#34;</span><span class="op" id="7658393">,</span>&nbsp;<span class="ident" id="7658395">raddr</span><span class="op" id="7658400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7658403">if</span>&nbsp;<span class="ident" id="7658406">err</span>&nbsp;<span class="op" id="7658410">!=</span>&nbsp;<span class="ident" id="7658413">nil</span>&nbsp;<span class="op" id="7658417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7658421">t</span><span class="op" id="7658422">.</span><span class="ident" id="7658423">Fatalf</span><span class="op" id="7658429">(</span><span class="string" id="7658430">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7658457">,</span>&nbsp;<span class="ident" id="7658459">err</span><span class="op" id="7658462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7658465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7658469">_</span><span class="op" id="7658470">,</span>&nbsp;<span class="ident" id="7658472">err</span>&nbsp;<span class="op" id="7658476">=</span>&nbsp;<span class="ident" id="7658478">c</span><span class="op" id="7658479">.</span><span class="op" id="7658480">(</span><span class="op" id="7658481">*</span><span class="ident" id="7658482">UDPConn</span><span class="op" id="7658489">)</span><span class="op" id="7658490">.</span><span class="ident" id="7658491">WriteToUDP</span><span class="op" id="7658501">(</span><span class="op" id="7658502">[</span><span class="op" id="7658503">]</span><span class="builtintype" id="7658504">byte</span><span class="op" id="7658508">(</span><span class="string" id="7658509">&#34;Connection-less&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="7658538">)</span><span class="op" id="7658539">,</span>&nbsp;<span class="ident" id="7658541">ra</span><span class="op" id="7658543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7658546">if</span>&nbsp;<span class="ident" id="7658549">err</span>&nbsp;<span class="op" id="7658553">!=</span>&nbsp;<span class="ident" id="7658556">nil</span>&nbsp;<span class="op" id="7658560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7658564">t</span><span class="op" id="7658565">.</span><span class="ident" id="7658566">Fatalf</span><span class="op" id="7658572">(</span><span class="string" id="7658573">&#34;WriteToUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7658596">,</span>&nbsp;<span class="ident" id="7658598">err</span><span class="op" id="7658601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7658604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7658608">_</span><span class="op" id="7658609">,</span>&nbsp;<span class="ident" id="7658611">err</span>&nbsp;<span class="op" id="7658615">=</span>&nbsp;<span class="ident" id="7658617">c</span><span class="op" id="7658618">.</span><span class="ident" id="7658619">WriteTo</span><span class="op" id="7658626">(</span><span class="op" id="7658627">[</span><span class="op" id="7658628">]</span><span class="builtintype" id="7658629">byte</span><span class="op" id="7658633">(</span><span class="string" id="7658634">&#34;Connection-less&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="7658663">)</span><span class="op" id="7658664">,</span>&nbsp;<span class="ident" id="7658666">ra</span><span class="op" id="7658668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7658671">if</span>&nbsp;<span class="ident" id="7658674">err</span>&nbsp;<span class="op" id="7658678">!=</span>&nbsp;<span class="ident" id="7658681">nil</span>&nbsp;<span class="op" id="7658685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7658689">t</span><span class="op" id="7658690">.</span><span class="ident" id="7658691">Fatalf</span><span class="op" id="7658697">(</span><span class="string" id="7658698">&#34;WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7658718">,</span>&nbsp;<span class="ident" id="7658720">err</span><span class="op" id="7658723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7658726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7658730">_</span><span class="op" id="7658731">,</span>&nbsp;<span class="ident" id="7658733">err</span>&nbsp;<span class="op" id="7658737">=</span>&nbsp;<span class="ident" id="7658739">c</span><span class="op" id="7658740">.</span><span class="op" id="7658741">(</span><span class="op" id="7658742">*</span><span class="ident" id="7658743">UDPConn</span><span class="op" id="7658750">)</span><span class="op" id="7658751">.</span><span class="ident" id="7658752">Write</span><span class="op" id="7658757">(</span><span class="op" id="7658758">[</span><span class="op" id="7658759">]</span><span class="builtintype" id="7658760">byte</span><span class="op" id="7658764">(</span><span class="string" id="7658765">&#34;Connection-less&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="7658794">)</span><span class="op" id="7658795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7658798">if</span>&nbsp;<span class="ident" id="7658801">err</span>&nbsp;<span class="op" id="7658805">==</span>&nbsp;<span class="ident" id="7658808">nil</span>&nbsp;<span class="op" id="7658812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7658816">t</span><span class="op" id="7658817">.</span><span class="ident" id="7658818">Fatal</span><span class="op" id="7658823">(</span><span class="string" id="7658824">&#34;Write&nbsp;should&nbsp;fail&#34;</span><span class="op" id="7658843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7658846">}</span><br>
<span class="lineno"></span><span class="op" id="7658848">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="7658851">var</span>&nbsp;<span class="ident" id="7658855">udpConnLocalNameTests</span>&nbsp;<span class="op" id="7658877">=</span>&nbsp;<span class="op" id="7658879">[</span><span class="op" id="7658880">]</span><span class="keyword" id="7658881">struct</span>&nbsp;<span class="op" id="7658888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7658891">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7658897">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7658905">laddr</span>&nbsp;<span class="op" id="7658911">*</span><span class="ident" id="7658912">UDPAddr</span><br>
<span class="lineno"></span><span class="op" id="7658920">}</span><span class="op" id="7658921">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7658924">{</span><span class="string" id="7658925">&#34;udp4&#34;</span><span class="op" id="7658931">,</span>&nbsp;<span class="op" id="7658933">&amp;</span><span class="ident" id="7658934">UDPAddr</span><span class="op" id="7658941">{</span><span class="ident" id="7658942">IP</span><span class="op" id="7658944">:</span>&nbsp;<span class="ident" id="7658946">IPv4</span><span class="op" id="7658950">(</span><span class="num" id="7658951">127</span><span class="op" id="7658954">,</span>&nbsp;<span class="num" id="7658956">0</span><span class="op" id="7658957">,</span>&nbsp;<span class="num" id="7658959">0</span><span class="op" id="7658960">,</span>&nbsp;<span class="num" id="7658962">1</span><span class="op" id="7658963">)</span><span class="op" id="7658964">}</span><span class="op" id="7658965">}</span><span class="op" id="7658966">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7658969">{</span><span class="string" id="7658970">&#34;udp4&#34;</span><span class="op" id="7658976">,</span>&nbsp;<span class="op" id="7658978">&amp;</span><span class="ident" id="7658979">UDPAddr</span><span class="op" id="7658986">{</span><span class="op" id="7658987">}</span><span class="op" id="7658988">}</span><span class="op" id="7658989">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7658992">{</span><span class="string" id="7658993">&#34;udp4&#34;</span><span class="op" id="7658999">,</span>&nbsp;<span class="ident" id="7659001">nil</span><span class="op" id="7659004">}</span><span class="op" id="7659005">,</span><br>
<span class="lineno"></span><span class="op" id="7659007">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="7659010">func</span>&nbsp;<span class="ident" id="7659015">TestUDPConnLocalName</span><span class="op" id="7659035">(</span><span class="ident" id="7659036">t</span>&nbsp;<span class="op" id="7659038">*</span><span class="ident" id="7659039">testing</span><span class="op" id="7659046">.</span><span class="ident" id="7659047">T</span><span class="op" id="7659048">)</span>&nbsp;<span class="op" id="7659050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7659053">if</span>&nbsp;<span class="ident" id="7659056">testing</span><span class="op" id="7659063">.</span><span class="ident" id="7659064">Short</span><span class="op" id="7659069">(</span><span class="op" id="7659070">)</span>&nbsp;<span class="op" id="7659072">||</span>&nbsp;<span class="op" id="7659075">!</span><span class="op" id="7659076">*</span><span class="ident" id="7659077">testExternal</span>&nbsp;<span class="op" id="7659090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7659094">t</span><span class="op" id="7659095">.</span><span class="ident" id="7659096">Skip</span><span class="op" id="7659100">(</span><span class="string" id="7659101">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7659142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7659145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7659149">for</span>&nbsp;<span class="ident" id="7659153">_</span><span class="op" id="7659154">,</span>&nbsp;<span class="ident" id="7659156">tt</span>&nbsp;<span class="op" id="7659159">:=</span>&nbsp;<span class="keyword" id="7659162">range</span>&nbsp;<span class="ident" id="7659168">udpConnLocalNameTests</span>&nbsp;<span class="op" id="7659190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7659194">c</span><span class="op" id="7659195">,</span>&nbsp;<span class="ident" id="7659197">err</span>&nbsp;<span class="op" id="7659201">:=</span>&nbsp;<span class="ident" id="7659204">ListenUDP</span><span class="op" id="7659213">(</span><span class="ident" id="7659214">tt</span><span class="op" id="7659216">.</span><span class="ident" id="7659217">net</span><span class="op" id="7659220">,</span>&nbsp;<span class="ident" id="7659222">tt</span><span class="op" id="7659224">.</span><span class="ident" id="7659225">laddr</span><span class="op" id="7659230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7659234">if</span>&nbsp;<span class="ident" id="7659237">err</span>&nbsp;<span class="op" id="7659241">!=</span>&nbsp;<span class="ident" id="7659244">nil</span>&nbsp;<span class="op" id="7659248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7659253">t</span><span class="op" id="7659254">.</span><span class="ident" id="7659255">Fatalf</span><span class="op" id="7659261">(</span><span class="string" id="7659262">&#34;ListenUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7659284">,</span>&nbsp;<span class="ident" id="7659286">err</span><span class="op" id="7659289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7659293">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7659297">defer</span>&nbsp;<span class="ident" id="7659303">c</span><span class="op" id="7659304">.</span><span class="ident" id="7659305">Close</span><span class="op" id="7659310">(</span><span class="op" id="7659311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7659315">la</span>&nbsp;<span class="op" id="7659318">:=</span>&nbsp;<span class="ident" id="7659321">c</span><span class="op" id="7659322">.</span><span class="ident" id="7659323">LocalAddr</span><span class="op" id="7659332">(</span><span class="op" id="7659333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7659337">if</span>&nbsp;<span class="ident" id="7659340">a</span><span class="op" id="7659341">,</span>&nbsp;<span class="ident" id="7659343">ok</span>&nbsp;<span class="op" id="7659346">:=</span>&nbsp;<span class="ident" id="7659349">la</span><span class="op" id="7659351">.</span><span class="op" id="7659352">(</span><span class="op" id="7659353">*</span><span class="ident" id="7659354">UDPAddr</span><span class="op" id="7659361">)</span><span class="op" id="7659362">;</span>&nbsp;<span class="op" id="7659364">!</span><span class="ident" id="7659365">ok</span>&nbsp;<span class="op" id="7659368">||</span>&nbsp;<span class="ident" id="7659371">a</span><span class="op" id="7659372">.</span><span class="ident" id="7659373">Port</span>&nbsp;<span class="op" id="7659378">==</span>&nbsp;<span class="num" id="7659381">0</span>&nbsp;<span class="op" id="7659383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7659388">t</span><span class="op" id="7659389">.</span><span class="ident" id="7659390">Fatalf</span><span class="op" id="7659396">(</span><span class="string" id="7659397">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;non-zero&nbsp;port&nbsp;number&#34;</span><span class="op" id="7659458">,</span>&nbsp;<span class="ident" id="7659460">la</span><span class="op" id="7659462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7659466">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7659469">}</span><br>
<span class="lineno"></span><span class="op" id="7659471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7659474">func</span>&nbsp;<span class="ident" id="7659479">TestUDPConnLocalAndRemoteNames</span><span class="op" id="7659509">(</span><span class="ident" id="7659510">t</span>&nbsp;<span class="op" id="7659512">*</span><span class="ident" id="7659513">testing</span><span class="op" id="7659520">.</span><span class="ident" id="7659521">T</span><span class="op" id="7659522">)</span>&nbsp;<span class="op" id="7659524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7659527">for</span>&nbsp;<span class="ident" id="7659531">_</span><span class="op" id="7659532">,</span>&nbsp;<span class="ident" id="7659534">laddr</span>&nbsp;<span class="op" id="7659540">:=</span>&nbsp;<span class="keyword" id="7659543">range</span>&nbsp;<span class="op" id="7659549">[</span><span class="op" id="7659550">]</span><span class="builtintype" id="7659551">string</span><span class="op" id="7659557">{</span><span class="string" id="7659558">&#34;&#34;</span><span class="op" id="7659560">,</span>&nbsp;<span class="string" id="7659562">&#34;127.0.0.1:0&#34;</span><span class="op" id="7659575">}</span>&nbsp;<span class="op" id="7659577">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7659581">c1</span><span class="op" id="7659583">,</span>&nbsp;<span class="ident" id="7659585">err</span>&nbsp;<span class="op" id="7659589">:=</span>&nbsp;<span class="ident" id="7659592">ListenPacket</span><span class="op" id="7659604">(</span><span class="string" id="7659605">&#34;udp&#34;</span><span class="op" id="7659610">,</span>&nbsp;<span class="string" id="7659612">&#34;127.0.0.1:0&#34;</span><span class="op" id="7659625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7659629">if</span>&nbsp;<span class="ident" id="7659632">err</span>&nbsp;<span class="op" id="7659636">!=</span>&nbsp;<span class="ident" id="7659639">nil</span>&nbsp;<span class="op" id="7659643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7659648">t</span><span class="op" id="7659649">.</span><span class="ident" id="7659650">Fatalf</span><span class="op" id="7659656">(</span><span class="string" id="7659657">&#34;ListenUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7659679">,</span>&nbsp;<span class="ident" id="7659681">err</span><span class="op" id="7659684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7659688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7659692">defer</span>&nbsp;<span class="ident" id="7659698">c1</span><span class="op" id="7659700">.</span><span class="ident" id="7659701">Close</span><span class="op" id="7659706">(</span><span class="op" id="7659707">)</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7659712">var</span>&nbsp;<span class="ident" id="7659716">la</span>&nbsp;<span class="op" id="7659719">*</span><span class="ident" id="7659720">UDPAddr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7659730">if</span>&nbsp;<span class="ident" id="7659733">laddr</span>&nbsp;<span class="op" id="7659739">!=</span>&nbsp;<span class="string" id="7659742">&#34;&#34;</span>&nbsp;<span class="op" id="7659745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7659750">var</span>&nbsp;<span class="ident" id="7659754">err</span>&nbsp;<span class="builtintype" id="7659758">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7659767">if</span>&nbsp;<span class="ident" id="7659770">la</span><span class="op" id="7659772">,</span>&nbsp;<span class="ident" id="7659774">err</span>&nbsp;<span class="op" id="7659778">=</span>&nbsp;<span class="ident" id="7659780">ResolveUDPAddr</span><span class="op" id="7659794">(</span><span class="string" id="7659795">&#34;udp&#34;</span><span class="op" id="7659800">,</span>&nbsp;<span class="ident" id="7659802">laddr</span><span class="op" id="7659807">)</span><span class="op" id="7659808">;</span>&nbsp;<span class="ident" id="7659810">err</span>&nbsp;<span class="op" id="7659814">!=</span>&nbsp;<span class="ident" id="7659817">nil</span>&nbsp;<span class="op" id="7659821">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7659827">t</span><span class="op" id="7659828">.</span><span class="ident" id="7659829">Fatalf</span><span class="op" id="7659835">(</span><span class="string" id="7659836">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7659863">,</span>&nbsp;<span class="ident" id="7659865">err</span><span class="op" id="7659868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7659873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7659877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7659881">c2</span><span class="op" id="7659883">,</span>&nbsp;<span class="ident" id="7659885">err</span>&nbsp;<span class="op" id="7659889">:=</span>&nbsp;<span class="ident" id="7659892">DialUDP</span><span class="op" id="7659899">(</span><span class="string" id="7659900">&#34;udp&#34;</span><span class="op" id="7659905">,</span>&nbsp;<span class="ident" id="7659907">la</span><span class="op" id="7659909">,</span>&nbsp;<span class="ident" id="7659911">c1</span><span class="op" id="7659913">.</span><span class="ident" id="7659914">LocalAddr</span><span class="op" id="7659923">(</span><span class="op" id="7659924">)</span><span class="op" id="7659925">.</span><span class="op" id="7659926">(</span><span class="op" id="7659927">*</span><span class="ident" id="7659928">UDPAddr</span><span class="op" id="7659935">)</span><span class="op" id="7659936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7659940">if</span>&nbsp;<span class="ident" id="7659943">err</span>&nbsp;<span class="op" id="7659947">!=</span>&nbsp;<span class="ident" id="7659950">nil</span>&nbsp;<span class="op" id="7659954">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7659959">t</span><span class="op" id="7659960">.</span><span class="ident" id="7659961">Fatalf</span><span class="op" id="7659967">(</span><span class="string" id="7659968">&#34;DialUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7659988">,</span>&nbsp;<span class="ident" id="7659990">err</span><span class="op" id="7659993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7659997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7660001">defer</span>&nbsp;<span class="ident" id="7660007">c2</span><span class="op" id="7660009">.</span><span class="ident" id="7660010">Close</span><span class="op" id="7660015">(</span><span class="op" id="7660016">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7660021">var</span>&nbsp;<span class="ident" id="7660025">connAddrs</span>&nbsp;<span class="op" id="7660035">=</span>&nbsp;<span class="op" id="7660037">[</span><span class="num" id="7660038">4</span><span class="op" id="7660039">]</span><span class="keyword" id="7660040">struct</span>&nbsp;<span class="op" id="7660047">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7660052">got</span>&nbsp;<span class="ident" id="7660056">Addr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7660064">ok</span>&nbsp;&nbsp;<span class="builtintype" id="7660068">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7660075">}</span><span class="op" id="7660076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7660081">{</span><span class="ident" id="7660082">c1</span><span class="op" id="7660084">.</span><span class="ident" id="7660085">LocalAddr</span><span class="op" id="7660094">(</span><span class="op" id="7660095">)</span><span class="op" id="7660096">,</span>&nbsp;<span class="builtintype" id="7660098">true</span><span class="op" id="7660102">}</span><span class="op" id="7660103">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7660108">{</span><span class="ident" id="7660109">c1</span><span class="op" id="7660111">.</span><span class="op" id="7660112">(</span><span class="op" id="7660113">*</span><span class="ident" id="7660114">UDPConn</span><span class="op" id="7660121">)</span><span class="op" id="7660122">.</span><span class="ident" id="7660123">RemoteAddr</span><span class="op" id="7660133">(</span><span class="op" id="7660134">)</span><span class="op" id="7660135">,</span>&nbsp;<span class="builtintype" id="7660137">false</span><span class="op" id="7660142">}</span><span class="op" id="7660143">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7660148">{</span><span class="ident" id="7660149">c2</span><span class="op" id="7660151">.</span><span class="ident" id="7660152">LocalAddr</span><span class="op" id="7660161">(</span><span class="op" id="7660162">)</span><span class="op" id="7660163">,</span>&nbsp;<span class="builtintype" id="7660165">true</span><span class="op" id="7660169">}</span><span class="op" id="7660170">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7660175">{</span><span class="ident" id="7660176">c2</span><span class="op" id="7660178">.</span><span class="ident" id="7660179">RemoteAddr</span><span class="op" id="7660189">(</span><span class="op" id="7660190">)</span><span class="op" id="7660191">,</span>&nbsp;<span class="builtintype" id="7660193">true</span><span class="op" id="7660197">}</span><span class="op" id="7660198">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7660202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7660206">for</span>&nbsp;<span class="ident" id="7660210">_</span><span class="op" id="7660211">,</span>&nbsp;<span class="ident" id="7660213">ca</span>&nbsp;<span class="op" id="7660216">:=</span>&nbsp;<span class="keyword" id="7660219">range</span>&nbsp;<span class="ident" id="7660225">connAddrs</span>&nbsp;<span class="op" id="7660235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7660240">if</span>&nbsp;<span class="ident" id="7660243">a</span><span class="op" id="7660244">,</span>&nbsp;<span class="ident" id="7660246">ok</span>&nbsp;<span class="op" id="7660249">:=</span>&nbsp;<span class="ident" id="7660252">ca</span><span class="op" id="7660254">.</span><span class="ident" id="7660255">got</span><span class="op" id="7660258">.</span><span class="op" id="7660259">(</span><span class="op" id="7660260">*</span><span class="ident" id="7660261">UDPAddr</span><span class="op" id="7660268">)</span><span class="op" id="7660269">;</span>&nbsp;<span class="ident" id="7660271">ok</span>&nbsp;<span class="op" id="7660274">!=</span>&nbsp;<span class="ident" id="7660277">ca</span><span class="op" id="7660279">.</span><span class="ident" id="7660280">ok</span>&nbsp;<span class="op" id="7660283">||</span>&nbsp;<span class="ident" id="7660286">ok</span>&nbsp;<span class="op" id="7660289">&amp;&amp;</span>&nbsp;<span class="ident" id="7660292">a</span><span class="op" id="7660293">.</span><span class="ident" id="7660294">Port</span>&nbsp;<span class="op" id="7660299">==</span>&nbsp;<span class="num" id="7660302">0</span>&nbsp;<span class="op" id="7660304">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7660310">t</span><span class="op" id="7660311">.</span><span class="ident" id="7660312">Fatalf</span><span class="op" id="7660318">(</span><span class="string" id="7660319">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;non-zero&nbsp;port&nbsp;number&#34;</span><span class="op" id="7660380">,</span>&nbsp;<span class="ident" id="7660382">ca</span><span class="op" id="7660384">.</span><span class="ident" id="7660385">got</span><span class="op" id="7660388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7660393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7660397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7660400">}</span><br>
<span class="lineno"></span><span class="op" id="7660402">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="keyword" id="7660405">func</span>&nbsp;<span class="ident" id="7660410">TestIPv6LinkLocalUnicastUDP</span><span class="op" id="7660437">(</span><span class="ident" id="7660438">t</span>&nbsp;<span class="op" id="7660440">*</span><span class="ident" id="7660441">testing</span><span class="op" id="7660448">.</span><span class="ident" id="7660449">T</span><span class="op" id="7660450">)</span>&nbsp;<span class="op" id="7660452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7660455">if</span>&nbsp;<span class="ident" id="7660458">testing</span><span class="op" id="7660465">.</span><span class="ident" id="7660466">Short</span><span class="op" id="7660471">(</span><span class="op" id="7660472">)</span>&nbsp;<span class="op" id="7660474">||</span>&nbsp;<span class="op" id="7660477">!</span><span class="op" id="7660478">*</span><span class="ident" id="7660479">testExternal</span>&nbsp;<span class="op" id="7660492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7660496">t</span><span class="op" id="7660497">.</span><span class="ident" id="7660498">Skip</span><span class="op" id="7660502">(</span><span class="string" id="7660503">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7660544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7660547">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7660550">if</span>&nbsp;<span class="op" id="7660553">!</span><span class="ident" id="7660554">supportsIPv6</span>&nbsp;<span class="op" id="7660567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7660571">t</span><span class="op" id="7660572">.</span><span class="ident" id="7660573">Skip</span><span class="op" id="7660577">(</span><span class="string" id="7660578">&#34;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="7660601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7660604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7660607">ifi</span>&nbsp;<span class="op" id="7660611">:=</span>&nbsp;<span class="ident" id="7660614">loopbackInterface</span><span class="op" id="7660631">(</span><span class="op" id="7660632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7660635">if</span>&nbsp;<span class="ident" id="7660638">ifi</span>&nbsp;<span class="op" id="7660642">==</span>&nbsp;<span class="ident" id="7660645">nil</span>&nbsp;<span class="op" id="7660649">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7660653">t</span><span class="op" id="7660654">.</span><span class="ident" id="7660655">Skip</span><span class="op" id="7660659">(</span><span class="string" id="7660660">&#34;loopback&nbsp;interface&nbsp;not&nbsp;found&#34;</span><span class="op" id="7660690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7660693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7660696">laddr</span>&nbsp;<span class="op" id="7660702">:=</span>&nbsp;<span class="ident" id="7660705">ipv6LinkLocalUnicastAddr</span><span class="op" id="7660729">(</span><span class="ident" id="7660730">ifi</span><span class="op" id="7660733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7660736">if</span>&nbsp;<span class="ident" id="7660739">laddr</span>&nbsp;<span class="op" id="7660745">==</span>&nbsp;<span class="string" id="7660748">&#34;&#34;</span>&nbsp;<span class="op" id="7660751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7660755">t</span><span class="op" id="7660756">.</span><span class="ident" id="7660757">Skip</span><span class="op" id="7660761">(</span><span class="string" id="7660762">&#34;ipv6&nbsp;unicast&nbsp;address&nbsp;on&nbsp;loopback&nbsp;not&nbsp;found&#34;</span><span class="op" id="7660806">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7660809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7660813">type</span>&nbsp;<span class="ident" id="7660818">test</span>&nbsp;<span class="keyword" id="7660823">struct</span>&nbsp;<span class="op" id="7660830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7660834">net</span><span class="op" id="7660837">,</span>&nbsp;<span class="ident" id="7660839">addr</span>&nbsp;&nbsp;<span class="builtintype" id="7660845">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7660854">nameLookup</span>&nbsp;<span class="builtintype" id="7660865">bool</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7660871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7660874">var</span>&nbsp;<span class="ident" id="7660878">tests</span>&nbsp;<span class="op" id="7660884">=</span>&nbsp;<span class="op" id="7660886">[</span><span class="op" id="7660887">]</span><span class="ident" id="7660888">test</span><span class="op" id="7660892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7660896">{</span><span class="string" id="7660897">&#34;udp&#34;</span><span class="op" id="7660902">,</span>&nbsp;<span class="string" id="7660904">&#34;[&#34;</span>&nbsp;<span class="op" id="7660908">+</span>&nbsp;<span class="ident" id="7660910">laddr</span>&nbsp;<span class="op" id="7660916">+</span>&nbsp;<span class="string" id="7660918">&#34;%&#34;</span>&nbsp;<span class="op" id="7660922">+</span>&nbsp;<span class="ident" id="7660924">ifi</span><span class="op" id="7660927">.</span><span class="ident" id="7660928">Name</span>&nbsp;<span class="op" id="7660933">+</span>&nbsp;<span class="string" id="7660935">&#34;]:0&#34;</span><span class="op" id="7660940">,</span>&nbsp;<span class="builtintype" id="7660942">false</span><span class="op" id="7660947">}</span><span class="op" id="7660948">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7660952">{</span><span class="string" id="7660953">&#34;udp6&#34;</span><span class="op" id="7660959">,</span>&nbsp;<span class="string" id="7660961">&#34;[&#34;</span>&nbsp;<span class="op" id="7660965">+</span>&nbsp;<span class="ident" id="7660967">laddr</span>&nbsp;<span class="op" id="7660973">+</span>&nbsp;<span class="string" id="7660975">&#34;%&#34;</span>&nbsp;<span class="op" id="7660979">+</span>&nbsp;<span class="ident" id="7660981">ifi</span><span class="op" id="7660984">.</span><span class="ident" id="7660985">Name</span>&nbsp;<span class="op" id="7660990">+</span>&nbsp;<span class="string" id="7660992">&#34;]:0&#34;</span><span class="op" id="7660997">,</span>&nbsp;<span class="builtintype" id="7660999">false</span><span class="op" id="7661004">}</span><span class="op" id="7661005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7661008">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7661011">//&nbsp;The&nbsp;first&nbsp;udp&nbsp;test&nbsp;fails&nbsp;on&nbsp;DragonFly&nbsp;-&nbsp;see&nbsp;issue&nbsp;7473.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7661071">if</span>&nbsp;<span class="ident" id="7661074">runtime</span><span class="op" id="7661081">.</span><span class="ident" id="7661082">GOOS</span>&nbsp;<span class="op" id="7661087">==</span>&nbsp;<span class="string" id="7661090">&#34;dragonfly&#34;</span>&nbsp;<span class="op" id="7661102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7661106">tests</span>&nbsp;<span class="op" id="7661112">=</span>&nbsp;<span class="ident" id="7661114">tests</span><span class="op" id="7661119">[</span><span class="num" id="7661120">1</span><span class="op" id="7661121">:</span><span class="op" id="7661122">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7661125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7661128">switch</span>&nbsp;<span class="ident" id="7661135">runtime</span><span class="op" id="7661142">.</span><span class="ident" id="7661143">GOOS</span>&nbsp;<span class="op" id="7661148">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7661151">case</span>&nbsp;<span class="string" id="7661156">&#34;darwin&#34;</span><span class="op" id="7661164">,</span>&nbsp;<span class="string" id="7661166">&#34;dragonfly&#34;</span><span class="op" id="7661177">,</span>&nbsp;<span class="string" id="7661179">&#34;freebsd&#34;</span><span class="op" id="7661188">,</span>&nbsp;<span class="string" id="7661190">&#34;openbsd&#34;</span><span class="op" id="7661199">,</span>&nbsp;<span class="string" id="7661201">&#34;netbsd&#34;</span><span class="op" id="7661209">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7661213">tests</span>&nbsp;<span class="op" id="7661219">=</span>&nbsp;<span class="builtinfunc" id="7661221">append</span><span class="op" id="7661227">(</span><span class="ident" id="7661228">tests</span><span class="op" id="7661233">,</span>&nbsp;<span class="op" id="7661235">[</span><span class="op" id="7661236">]</span><span class="ident" id="7661237">test</span><span class="op" id="7661241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7661246">{</span><span class="string" id="7661247">&#34;udp&#34;</span><span class="op" id="7661252">,</span>&nbsp;<span class="string" id="7661254">&#34;[localhost%&#34;</span>&nbsp;<span class="op" id="7661268">+</span>&nbsp;<span class="ident" id="7661270">ifi</span><span class="op" id="7661273">.</span><span class="ident" id="7661274">Name</span>&nbsp;<span class="op" id="7661279">+</span>&nbsp;<span class="string" id="7661281">&#34;]:0&#34;</span><span class="op" id="7661286">,</span>&nbsp;<span class="builtintype" id="7661288">true</span><span class="op" id="7661292">}</span><span class="op" id="7661293">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7661298">{</span><span class="string" id="7661299">&#34;udp6&#34;</span><span class="op" id="7661305">,</span>&nbsp;<span class="string" id="7661307">&#34;[localhost%&#34;</span>&nbsp;<span class="op" id="7661321">+</span>&nbsp;<span class="ident" id="7661323">ifi</span><span class="op" id="7661326">.</span><span class="ident" id="7661327">Name</span>&nbsp;<span class="op" id="7661332">+</span>&nbsp;<span class="string" id="7661334">&#34;]:0&#34;</span><span class="op" id="7661339">,</span>&nbsp;<span class="builtintype" id="7661341">true</span><span class="op" id="7661345">}</span><span class="op" id="7661346">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7661350">}</span><span class="op" id="7661351">...</span><span class="op" id="7661354">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7661357">case</span>&nbsp;<span class="string" id="7661362">&#34;linux&#34;</span><span class="op" id="7661369">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7661373">tests</span>&nbsp;<span class="op" id="7661379">=</span>&nbsp;<span class="builtinfunc" id="7661381">append</span><span class="op" id="7661387">(</span><span class="ident" id="7661388">tests</span><span class="op" id="7661393">,</span>&nbsp;<span class="op" id="7661395">[</span><span class="op" id="7661396">]</span><span class="ident" id="7661397">test</span><span class="op" id="7661401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7661406">{</span><span class="string" id="7661407">&#34;udp&#34;</span><span class="op" id="7661412">,</span>&nbsp;<span class="string" id="7661414">&#34;[ip6-localhost%&#34;</span>&nbsp;<span class="op" id="7661432">+</span>&nbsp;<span class="ident" id="7661434">ifi</span><span class="op" id="7661437">.</span><span class="ident" id="7661438">Name</span>&nbsp;<span class="op" id="7661443">+</span>&nbsp;<span class="string" id="7661445">&#34;]:0&#34;</span><span class="op" id="7661450">,</span>&nbsp;<span class="builtintype" id="7661452">true</span><span class="op" id="7661456">}</span><span class="op" id="7661457">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7661462">{</span><span class="string" id="7661463">&#34;udp6&#34;</span><span class="op" id="7661469">,</span>&nbsp;<span class="string" id="7661471">&#34;[ip6-localhost%&#34;</span>&nbsp;<span class="op" id="7661489">+</span>&nbsp;<span class="ident" id="7661491">ifi</span><span class="op" id="7661494">.</span><span class="ident" id="7661495">Name</span>&nbsp;<span class="op" id="7661500">+</span>&nbsp;<span class="string" id="7661502">&#34;]:0&#34;</span><span class="op" id="7661507">,</span>&nbsp;<span class="builtintype" id="7661509">true</span><span class="op" id="7661513">}</span><span class="op" id="7661514">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7661518">}</span><span class="op" id="7661519">...</span><span class="op" id="7661522">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7661525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7661528">for</span>&nbsp;<span class="ident" id="7661532">_</span><span class="op" id="7661533">,</span>&nbsp;<span class="ident" id="7661535">tt</span>&nbsp;<span class="op" id="7661538">:=</span>&nbsp;<span class="keyword" id="7661541">range</span>&nbsp;<span class="ident" id="7661547">tests</span>&nbsp;<span class="op" id="7661553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7661557">c1</span><span class="op" id="7661559">,</span>&nbsp;<span class="ident" id="7661561">err</span>&nbsp;<span class="op" id="7661565">:=</span>&nbsp;<span class="ident" id="7661568">ListenPacket</span><span class="op" id="7661580">(</span><span class="ident" id="7661581">tt</span><span class="op" id="7661583">.</span><span class="ident" id="7661584">net</span><span class="op" id="7661587">,</span>&nbsp;<span class="ident" id="7661589">tt</span><span class="op" id="7661591">.</span><span class="ident" id="7661592">addr</span><span class="op" id="7661596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7661600">if</span>&nbsp;<span class="ident" id="7661603">err</span>&nbsp;<span class="op" id="7661607">!=</span>&nbsp;<span class="ident" id="7661610">nil</span>&nbsp;<span class="op" id="7661614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7661619">//&nbsp;It&nbsp;might&nbsp;return&nbsp;&#34;LookupHost&nbsp;returned&nbsp;no</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7661665">//&nbsp;suitable&nbsp;address&#34;&nbsp;error&nbsp;on&nbsp;some&nbsp;platforms.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7661714">t</span><span class="op" id="7661715">.</span><span class="ident" id="7661716">Logf</span><span class="op" id="7661720">(</span><span class="string" id="7661721">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7661746">,</span>&nbsp;<span class="ident" id="7661748">err</span><span class="op" id="7661751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7661756">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7661767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7661771">defer</span>&nbsp;<span class="ident" id="7661777">c1</span><span class="op" id="7661779">.</span><span class="ident" id="7661780">Close</span><span class="op" id="7661785">(</span><span class="op" id="7661786">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7661790">if</span>&nbsp;<span class="ident" id="7661793">la</span><span class="op" id="7661795">,</span>&nbsp;<span class="ident" id="7661797">ok</span>&nbsp;<span class="op" id="7661800">:=</span>&nbsp;<span class="ident" id="7661803">c1</span><span class="op" id="7661805">.</span><span class="ident" id="7661806">LocalAddr</span><span class="op" id="7661815">(</span><span class="op" id="7661816">)</span><span class="op" id="7661817">.</span><span class="op" id="7661818">(</span><span class="op" id="7661819">*</span><span class="ident" id="7661820">UDPAddr</span><span class="op" id="7661827">)</span><span class="op" id="7661828">;</span>&nbsp;<span class="op" id="7661830">!</span><span class="ident" id="7661831">ok</span>&nbsp;<span class="op" id="7661834">||</span>&nbsp;<span class="op" id="7661837">!</span><span class="ident" id="7661838">tt</span><span class="op" id="7661840">.</span><span class="ident" id="7661841">nameLookup</span>&nbsp;<span class="op" id="7661852">&amp;&amp;</span>&nbsp;<span class="ident" id="7661855">la</span><span class="op" id="7661857">.</span><span class="ident" id="7661858">Zone</span>&nbsp;<span class="op" id="7661863">==</span>&nbsp;<span class="string" id="7661866">&#34;&#34;</span>&nbsp;<span class="op" id="7661869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7661874">t</span><span class="op" id="7661875">.</span><span class="ident" id="7661876">Fatalf</span><span class="op" id="7661882">(</span><span class="string" id="7661883">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="7661939">,</span>&nbsp;<span class="ident" id="7661941">la</span><span class="op" id="7661943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7661947">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7661952">c2</span><span class="op" id="7661954">,</span>&nbsp;<span class="ident" id="7661956">err</span>&nbsp;<span class="op" id="7661960">:=</span>&nbsp;<span class="ident" id="7661963">Dial</span><span class="op" id="7661967">(</span><span class="ident" id="7661968">tt</span><span class="op" id="7661970">.</span><span class="ident" id="7661971">net</span><span class="op" id="7661974">,</span>&nbsp;<span class="ident" id="7661976">c1</span><span class="op" id="7661978">.</span><span class="ident" id="7661979">LocalAddr</span><span class="op" id="7661988">(</span><span class="op" id="7661989">)</span><span class="op" id="7661990">.</span><span class="ident" id="7661991">String</span><span class="op" id="7661997">(</span><span class="op" id="7661998">)</span><span class="op" id="7661999">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7662003">if</span>&nbsp;<span class="ident" id="7662006">err</span>&nbsp;<span class="op" id="7662010">!=</span>&nbsp;<span class="ident" id="7662013">nil</span>&nbsp;<span class="op" id="7662017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7662022">t</span><span class="op" id="7662023">.</span><span class="ident" id="7662024">Fatalf</span><span class="op" id="7662030">(</span><span class="string" id="7662031">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7662048">,</span>&nbsp;<span class="ident" id="7662050">err</span><span class="op" id="7662053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7662057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7662061">defer</span>&nbsp;<span class="ident" id="7662067">c2</span><span class="op" id="7662069">.</span><span class="ident" id="7662070">Close</span><span class="op" id="7662075">(</span><span class="op" id="7662076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7662080">if</span>&nbsp;<span class="ident" id="7662083">la</span><span class="op" id="7662085">,</span>&nbsp;<span class="ident" id="7662087">ok</span>&nbsp;<span class="op" id="7662090">:=</span>&nbsp;<span class="ident" id="7662093">c2</span><span class="op" id="7662095">.</span><span class="ident" id="7662096">LocalAddr</span><span class="op" id="7662105">(</span><span class="op" id="7662106">)</span><span class="op" id="7662107">.</span><span class="op" id="7662108">(</span><span class="op" id="7662109">*</span><span class="ident" id="7662110">UDPAddr</span><span class="op" id="7662117">)</span><span class="op" id="7662118">;</span>&nbsp;<span class="op" id="7662120">!</span><span class="ident" id="7662121">ok</span>&nbsp;<span class="op" id="7662124">||</span>&nbsp;<span class="op" id="7662127">!</span><span class="ident" id="7662128">tt</span><span class="op" id="7662130">.</span><span class="ident" id="7662131">nameLookup</span>&nbsp;<span class="op" id="7662142">&amp;&amp;</span>&nbsp;<span class="ident" id="7662145">la</span><span class="op" id="7662147">.</span><span class="ident" id="7662148">Zone</span>&nbsp;<span class="op" id="7662153">==</span>&nbsp;<span class="string" id="7662156">&#34;&#34;</span>&nbsp;<span class="op" id="7662159">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7662164">t</span><span class="op" id="7662165">.</span><span class="ident" id="7662166">Fatalf</span><span class="op" id="7662172">(</span><span class="string" id="7662173">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="7662229">,</span>&nbsp;<span class="ident" id="7662231">la</span><span class="op" id="7662233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7662237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7662241">if</span>&nbsp;<span class="ident" id="7662244">ra</span><span class="op" id="7662246">,</span>&nbsp;<span class="ident" id="7662248">ok</span>&nbsp;<span class="op" id="7662251">:=</span>&nbsp;<span class="ident" id="7662254">c2</span><span class="op" id="7662256">.</span><span class="ident" id="7662257">RemoteAddr</span><span class="op" id="7662267">(</span><span class="op" id="7662268">)</span><span class="op" id="7662269">.</span><span class="op" id="7662270">(</span><span class="op" id="7662271">*</span><span class="ident" id="7662272">UDPAddr</span><span class="op" id="7662279">)</span><span class="op" id="7662280">;</span>&nbsp;<span class="op" id="7662282">!</span><span class="ident" id="7662283">ok</span>&nbsp;<span class="op" id="7662286">||</span>&nbsp;<span class="op" id="7662289">!</span><span class="ident" id="7662290">tt</span><span class="op" id="7662292">.</span><span class="ident" id="7662293">nameLookup</span>&nbsp;<span class="op" id="7662304">&amp;&amp;</span>&nbsp;<span class="ident" id="7662307">ra</span><span class="op" id="7662309">.</span><span class="ident" id="7662310">Zone</span>&nbsp;<span class="op" id="7662315">==</span>&nbsp;<span class="string" id="7662318">&#34;&#34;</span>&nbsp;<span class="op" id="7662321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7662326">t</span><span class="op" id="7662327">.</span><span class="ident" id="7662328">Fatalf</span><span class="op" id="7662334">(</span><span class="string" id="7662335">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="7662391">,</span>&nbsp;<span class="ident" id="7662393">ra</span><span class="op" id="7662395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7662399">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7662404">if</span>&nbsp;<span class="ident" id="7662407">_</span><span class="op" id="7662408">,</span>&nbsp;<span class="ident" id="7662410">err</span>&nbsp;<span class="op" id="7662414">:=</span>&nbsp;<span class="ident" id="7662417">c2</span><span class="op" id="7662419">.</span><span class="ident" id="7662420">Write</span><span class="op" id="7662425">(</span><span class="op" id="7662426">[</span><span class="op" id="7662427">]</span><span class="builtintype" id="7662428">byte</span><span class="op" id="7662432">(</span><span class="string" id="7662433">&#34;UDP&nbsp;OVER&nbsp;IPV6&nbsp;LINKLOCAL&nbsp;TEST&#34;</span><span class="op" id="7662463">)</span><span class="op" id="7662464">)</span><span class="op" id="7662465">;</span>&nbsp;<span class="ident" id="7662467">err</span>&nbsp;<span class="op" id="7662471">!=</span>&nbsp;<span class="ident" id="7662474">nil</span>&nbsp;<span class="op" id="7662478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7662483">t</span><span class="op" id="7662484">.</span><span class="ident" id="7662485">Fatalf</span><span class="op" id="7662491">(</span><span class="string" id="7662492">&#34;Conn.Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7662515">,</span>&nbsp;<span class="ident" id="7662517">err</span><span class="op" id="7662520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7662524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7662528">b</span>&nbsp;<span class="op" id="7662530">:=</span>&nbsp;<span class="builtinfunc" id="7662533">make</span><span class="op" id="7662537">(</span><span class="op" id="7662538">[</span><span class="op" id="7662539">]</span><span class="builtintype" id="7662540">byte</span><span class="op" id="7662544">,</span>&nbsp;<span class="num" id="7662546">32</span><span class="op" id="7662548">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7662552">if</span>&nbsp;<span class="ident" id="7662555">_</span><span class="op" id="7662556">,</span>&nbsp;<span class="ident" id="7662558">from</span><span class="op" id="7662562">,</span>&nbsp;<span class="ident" id="7662564">err</span>&nbsp;<span class="op" id="7662568">:=</span>&nbsp;<span class="ident" id="7662571">c1</span><span class="op" id="7662573">.</span><span class="ident" id="7662574">ReadFrom</span><span class="op" id="7662582">(</span><span class="ident" id="7662583">b</span><span class="op" id="7662584">)</span><span class="op" id="7662585">;</span>&nbsp;<span class="ident" id="7662587">err</span>&nbsp;<span class="op" id="7662591">!=</span>&nbsp;<span class="ident" id="7662594">nil</span>&nbsp;<span class="op" id="7662598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7662603">t</span><span class="op" id="7662604">.</span><span class="ident" id="7662605">Fatalf</span><span class="op" id="7662611">(</span><span class="string" id="7662612">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7662644">,</span>&nbsp;<span class="ident" id="7662646">err</span><span class="op" id="7662649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7662653">}</span>&nbsp;<span class="keyword" id="7662655">else</span>&nbsp;<span class="op" id="7662660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7662665">if</span>&nbsp;<span class="ident" id="7662668">ra</span><span class="op" id="7662670">,</span>&nbsp;<span class="ident" id="7662672">ok</span>&nbsp;<span class="op" id="7662675">:=</span>&nbsp;<span class="ident" id="7662678">from</span><span class="op" id="7662682">.</span><span class="op" id="7662683">(</span><span class="op" id="7662684">*</span><span class="ident" id="7662685">UDPAddr</span><span class="op" id="7662692">)</span><span class="op" id="7662693">;</span>&nbsp;<span class="op" id="7662695">!</span><span class="ident" id="7662696">ok</span>&nbsp;<span class="op" id="7662699">||</span>&nbsp;<span class="op" id="7662702">!</span><span class="ident" id="7662703">tt</span><span class="op" id="7662705">.</span><span class="ident" id="7662706">nameLookup</span>&nbsp;<span class="op" id="7662717">&amp;&amp;</span>&nbsp;<span class="ident" id="7662720">ra</span><span class="op" id="7662722">.</span><span class="ident" id="7662723">Zone</span>&nbsp;<span class="op" id="7662728">==</span>&nbsp;<span class="string" id="7662731">&#34;&#34;</span>&nbsp;<span class="op" id="7662734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7662740">t</span><span class="op" id="7662741">.</span><span class="ident" id="7662742">Fatalf</span><span class="op" id="7662748">(</span><span class="string" id="7662749">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="7662805">,</span>&nbsp;<span class="ident" id="7662807">ra</span><span class="op" id="7662809">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7662814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7662818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7662821">}</span><br>
<span class="lineno"></span><span class="op" id="7662823">}</span>
</div>
</body>
</html>
